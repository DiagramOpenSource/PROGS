|FICHEROS;
     dsz00001 #0;

     agifa017 #17;
     agifa019 #19;
     dsm00004 #904;
     dsm00015 #915;
     dsm00016 #916;

     dsm00010 #910;

     dsw00002 #102;
     dsw00003 #103;
     dsw00004 #104;
     dsw00005 #105;
     dsw00021 #121;
|FIN;

|VARIABLES;
     &eAlfa = "";

     nNume  = 0;
     nPosi  = 0;
     nPasada = 0;
     nFichero = 0;

     aDescr   = "";
     aAlfa    = "";
     aAlfa1   = "";
     aAlfa2   = "";
     aAlfa3   = "";
     aAlfa4   = "";
     aAlfa5   = "";
     aAlf     = "";
     aAlf1    = "";
     aAlf2    = "";
     aAlf3    = "";
     aAlf4    = "";
     aAlf5    = "";
     aCodi1   = "";
     aCodi2   = "";
     aCodi3   = "";
     aCodi4   = "";
     aCodi5   = "";
     aRelleno = "";
     aVacio20 = "                    ";
     aLLeno20 = "zzzzzzzzzzzzzzzzzzzz";
|FIN;

|PROCESO CodigoBarra;
     |SI #910#33 = "S";
         eAlfa = #19#0;
         |SUB_EJECUTA_NP "dsz99990;B";
         #19#128 = eAlfa;
     |SINO;
         #19#128 = #19#0;
     |FINSI;
|FPRC;

|PROCESO AltaArticulo;
     #19#0 = aAlfa;
     |LEE 101#19=;
     |SI FSalida = 0;  |Y  #0#2 = "N";
         |LIBERA #19;
         |ACABA;
     |FINSI;

     |SI FSalida ! 0;
         |DDEFECTO #19;
         #19#0 = aAlfa;
         |GRABA 020#19b;
     |FINSI;

     #19#1   = aDescr;
     #19#18  = #916#5;
     #19#19  = #916#6;
     #19#20  = #916#7;
     #19#147 = #916#8;
     #19#148 = #916#9;
     #19#149 = #916#10;
     #19#165 = #915#3;
     #19#28  = #916#11;
     #19#163 = #916#12;
     #19#133 = #916#13;
     #19#164 = #916#14;
     #19#175 = "S";
     #19#176 = "S";
     #19#125 = #121#5;
     #19#2   = #121#6;
     #19#3   = #121#7;
     #19#126 = #121#8;
     #19#134 = #121#9;
     #19#27  = #121#10;
     #19#30  = #121#11;
     #19#130 = #121#12;
     #19#131 = #121#12;
     #19#132 = #121#12;
     #19#153 = #121#12;
     #19#154 = #121#12;
     #19#155 = #121#12;

     |HAZ CodigoBarra;

     |GRABA 020#19a;
     |LIBERA #19;
|FPRC;

|PROCESO AltaAlmacen;
     #17#0 = aAlfa;
     #17#1 = 1;
     |LEE 101#17=;
     |SI FSalida = 0;  |Y  #0#2 = "N";
         |LIBERA #17;
         |ACABA;
     |FINSI;

     |SI FSalida ! 0;
         |DDEFECTO #17;
         #17#0 = aAlfa;
         #17#1 = 1;
     |FINSI;

     #17#40  = aDescr;

     |SI FSalida = 0; |GRABA 020#17a;  |FINSI;
     |SI FSalida ! 0; |GRABA 020#17n;  |FINSI;
     |LIBERA #17;
|FPRC;

|PROCESO AltaComponente;
     #904#0 = aAlfa;
     #904#1 = 1;
     #904#2 = #916#3;
     |LEE 101#904=;
     |SI FSalida = 0;  |Y  #0#2 = "N";
         |LIBERA #904;
         |ACABA;
     |FINSI;

     |SI FSalida ! 0;
         |DDEFECTO #904;
         #904#0 = aAlfa;
         #904#1 = 1;
         #904#2 = #916#3;
     |FINSI;

     #904#3  = #916#4;
     #904#14 = #916#5;
     #904#15 = #916#6;
     #904#16 = #916#7;
     #904#17 = #916#8;
     #904#18 = #916#9;
     #904#19 = #916#10;
     #904#20 = #916#11;
     #904#21 = #916#12;
     #904#22 = #916#13;
     #904#23 = #916#14;

     |SI FSalida = 0; |GRABA 020#904a;  |FINSI;
     |SI FSalida ! 0; |GRABA 020#904n;  |FINSI;
     |LIBERA #904;
|FPRC;

|PROCESO GrabaLos;
     aAlfa5 = #916#3;  |QBF aAlfa5;
     |SI #910#21 ! 0;
         nPosi  = -(100 + #910#21);
         aRelleno = #910#23 * 6;
         aAlfa5   = (aRelleno + aAlfa5) % nPosi;
     |SINO;
         aAlfa5 = "";
     |FINSI;

     aAlfa = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4;

     #915#0 = #916#0;
     #915#1 = #916#1;
     #915#2 = #916#2;
     |LEE 040#915=;
     |SI FSalida ! 0;  |DDEFECTO #915;  |FINSI;

     |SI nPasada = 0;
         |HAZ AltaArticulo;
         |HAZ AltaAlmacen;
         nPasada = 1;
     |FINSI;
     |HAZ AltaComponente;
|FPRC;

|DEFBUCLE dsm00016;
     #916#1;
     ;
     aCodi1, aCodi2, aCodi3, aCodi4, "      ";
     aCodi1, aCodi2, aCodi3, aCodi4, "zzzzzz";
     ;
     NULL, GrabaLos;
|FIN;

|PROCESO Tratalos;
     |SI nFichero = 102;
         aAlfa1 = #102#0;  |QBF aAlfa1;
         aAlfa2 = "";
         aAlfa3 = "";
         aAlfa4 = "";
         aDescr = #102#2;
     |FINSI;

     |SI nFichero = 103;
         aAlfa1 = #103#0;  |QBF aAlfa1;
         aAlfa2 = #103#1;  |QBF aAlfa2;
         aAlfa3 = "";
         aAlfa4 = "";
         aDescr = #103#3;
     |FINSI;

     |SI nFichero = 104;
         aAlfa1 = #104#0;  |QBF aAlfa1;
         aAlfa2 = #104#1;  |QBF aAlfa2;
         aAlfa3 = #104#2;  |QBF aAlfa3;
         aAlfa4 = "";
         aDescr = #104#4;
     |FINSI;

     |SI nFichero = 105;
         aAlfa1 = #105#0;  |QBF aAlfa1;
         aAlfa2 = #105#1;  |QBF aAlfa2;
         aAlfa3 = #105#2;  |QBF aAlfa3;
         aAlfa4 = #105#3;  |QBF aAlfa4;
         aDescr = #105#5;
     |FINSI;

     |SI #910#4 ! 0;
         nPosi    = -(100 + #910#4);
         aRelleno = #910#6 * 20;
         aCodi1   = (aRelleno + aAlfa1) % nPosi;
         aAlfa1   = (aRelleno + aAlfa1) % nPosi;
     |SINO;
         aCodi1 = " " * 20;
         aAlfa1 = " ";
     |FINSI;

     |SI #910#8 ! 0;
         nPosi  = -(100 + #910#8);
         aRelleno = #910#10 * 20;
         aCodi2   = (aRelleno + aAlfa2) % nPosi;
         aAlfa2   = (aRelleno + aAlfa2) % nPosi;
     |SINO;
         aCodi1 = " " * 20;
         aAlfa2 = " ";
     |FINSI;

     |SI #910#12 ! 0;
         nPosi    = -(100 + #910#12);
         aRelleno = #910#14 * 20;
         aCodi3   = (aRelleno + aAlfa3) % nPosi;
         aAlfa3   = (aRelleno + aAlfa3) % nPosi;
     |SINO;
         aCodi3 = " " * 20;
         aAlfa3 = " ";
     |FINSI;

     |SI #910#16 ! 0;
         nPosi  = -(100 + #910#16);
         aRelleno = #910#18 * 20;
         aCodi4   = (aRelleno + aAlfa4) % nPosi;
         aAlfa4   = (aRelleno + aAlfa4) % nPosi;
     |SINO;
         aCodi4 = " " * 20;
         aAlfa4 = "";
     |FINSI;

     |SI #910#26 = 1;
         aCodi2 = " " * 20;
         aCodi3 = " " * 20;
         aCodi4 = " " * 20;
     |FINSI;

     |SI #910#26 = 2;
         aCodi3 = " " * 20;
         aCodi4 = " " * 20;
     |FINSI;

     |SI #910#26 = 3;
         aCodi4 = " " * 20;
     |FINSI;

     |ABRE #121;
     #121#0 = aAlfa1;
     #121#1 = aAlfa2;
     #121#2 = aAlfa3;
     #121#3 = aAlfa4;
     |LEE 040#121=;
     |SI FSalida ! 0;  |DDEFECTO #121; |FINSI;
     |CIERRA #121;

     nPasada = 0;
     |BUCLE dsm00016;
|FPRC;

|DEFBUCLE dsw00002;
     #102#1;
     ;
     #0#0;
     #0#0;
     ;
     NULL, Tratalos;
|FIN;

|DEFBUCLE dsw00003;
     #103#1;
     ;
     #0#0, aVacio20;
     #0#0, aLLeno20;
     ;
     NULL, Tratalos;
|FIN;

|DEFBUCLE dsw00004;
     #104#1;
     ;
     #0#0, aVacio20, aVacio20;
     #0#0, aLLeno20, aLLeno20;
     ;
     NULL, Tratalos;
|FIN;

|DEFBUCLE dsw00005;
     #105#1;
     ;
     #0#0, aVacio20, aVacio20, aVacio20;
     #0#0, aLLeno20, aLLeno20, aLLeno20;
     ;
     NULL, Tratalos;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #17;
     |ABRE #19;
     |ABRE #904;
     |ABRE #915;

     |SI #910#4 ! 0; |Y #910#8 = 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
         nFichero = 102;
         |BUCLE dsw00002;
     |FINSI;

     |SI #910#8 ! 0;  |Y #910#12 = 0;  |Y #910#16 = 0;
         nFichero = 103;
         |BUCLE dsw00003;
     |FINSI;

     |SI #910#12 ! 0;  |Y #910#16 = 0;
         nFichero = 104;
         |BUCLE dsw00004;
     |FINSI;

     |SI #910#16 ! 0;
         nFichero = 105;
         |BUCLE dsw00005;
     |FINSI;

     |CIERRA #17;
     |CIERRA #19;
     |CIERRA #904;
     |CIERRA #915;
|FPRC;

|PROGRAMA;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     nNume = #910#4;  aAlfa = "\" + #910#6 + "+#";
     |CAMPO_ANCHO  #0#0, 1, nNume;
     |CAMPO_MAXIMO #0#0, 1, aAlfa;

     |CLS;
     |CABEZA "Creacion del Articulo";
     |PINPA #0#0;
     |PINTA 1121, #910#3;
     |DDEFECTO #0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
