|FICHEROS;
     vigz0030 #0;
     vigm0001 #1;
     vigm0002 #2;
     vigm0003 #3;
     vigm0019 #19;
     vigm0020 #20;
     vigm0039 #39;
|FIN;

|VARIABLES;
     &enPreMezcla = 0;
     &enKgMezcla = 0;
     &enPorce = 0;
     &eaLote = "";
     &enNumEti = 0;
     nUni = 0;
     nResto = 0;
     nHayBas = 0;
     nKg = 0;
     i = 0;
     nSw = 0;
     nNume = 0;
|FIN;

|PROCESO LinFormula;
     |DDEFECTO #1;
     #1#0 = #3#2;
     |LEE 000#1=;

     |DDEFECTO #39;
     #39#0 = #3#2;
     |LEE 000#39=;

     |SI #3#6 ] #0#1; |Y #3#6 [ #0#2;
          enKgMezcla = #3#4 * enPorce / 100;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Formula;
     #2#2;
     ;
     #20#10;
     #20#10;
     ;
     NULL, NULL, LinFormula;
|FIN;

|PROCESO CheqBascula;
     |DDEFECTO #1;
     #1#0 = #3#2;
     |LEE 000#1=;
     |SI #3#6 ] #0#1; |Y #3#6 [ #0#2;
          nHayBas = 1;
     |FINSI;
|FPRC;

|DEFBUCLE CheqBascula;
     #2#2;
     ;
     #20#10;
     #20#10;
     ;
     NULL, NULL, CheqBascula;
|FIN;

|PROCESO vigm0020;
     nHayBas = 0;
     |BUCLE CheqBascula;
     |SI nHayBas ! 0;
          nUni = (#20#4 / 2000);
          nNume = nUni ! 0;
          |SI nNume ! nUni;
               |SI nNume < nUni;
                    nNume = nNume + 1;
               |FINSI;
               nUni = nNume;
          |FINSI;

          enPreMezcla = nUni;

          enPorce = #20#4 / 2000 * 100 / enPreMezcla;

          eaLote = (#0#0 % 102) + (#0#0 % 402);

          |SI nSw = 0;
               |BUCLE Formula;
          |SINO;
               |PARA i = 1; |SI i [ enPreMezcla; |HACIENDO i = i + 1;
                    enNumEti = i;
                    |BUCLE Formula;
                    |PIEINF;
               |SIGUE;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vigm0019;
     #19#2;
     ;
     #0#0, "     ", 000001;
     #0#0, "zzzzz", 999999;
     ;
     NULL, NULL, vigm0020;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     nSw = 0;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigz0030";
          |SI FSalida = 0;
               |ABRE #1;
               |ABRE #39;
               |BUCLE vigm0019;
               |CIERRA #39;
               |CIERRA #1;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vigz0030'";
          |FINSI;
          |FINIMP;
     |FINSI;
/**************************
     nSw = 1;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigz1030";
          |SI FSalida = 0;
               |ABRE #1;
               |ABRE #39;
               |BUCLE vigm0019;
               |CIERRA #1;
               |CIERRA #39;
               ||SISCO: A¤adido FININF para impresion Crystal: 3/10/2007
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vigz1030'";
          |FINSI;
          |FINIMP;
     |FINSI;
**********************/
|FPRC;
