|FICHEROS;
     guery003 #0;

     guerm008 #8;        ||Lecturas Contadores
     guerm033 #33;       ||Vehiculos
     guerm006 #6;        ||Surtidores
|FIN;

|VARIABLES;
     i = 0;
     nEntra = 0;
     nSale = 0;
     aMensaje = "";
     aTipo = "";
     aFecLec = "";
     aMes = "";
     nMes = 0;
     nCampo = 0;
     nCampoE = 0;
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI #guery003#5 = "SI";
               |ABRE #guerm033;
               |ABRE #guerm006;
               |HAZ Principal;
               |CIERRA #guerm006;
               |CIERRA #guerm033;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO guerm008;
     |SI #guerm008#14 = "S";  |Y #guerm008#15 = "N";
          |SI #guerm008#5 = "999999";
               aTipo = "ENT";
          |SINO;
               aTipo = "SAL";
          |FINSI;
          aFecLec = #guerm008#1;
          aMes = aFecLec % 402;
          nMes = aMes;
          |HAZ ActVeh;
          |HAZ ActSur;
          #guerm008#15 = "S";
          |GRABA 020#guerm008.a;
     |FINSI;
|FPRC;

|DEFBUCLE guerm008;
#guerm008#2;
;
#guery003#3, #guery003#1, "        ", 000000;
#guery003#4, #guery003#2, "zzzzzzzz", 999999;
;
NULL, guerm008;
|FIN;

|PROCESO Principal;
     |BUCLE guerm008;
|FPRC;

|PROCESO ActVeh;
     |DDEFECTO #guerm033;
     #guerm033#0 = #guerm008#9;
     |LEE 101#guerm033.=;
     |SI FSalida ! 0; |GRABA 020#guerm033.b; |FINSI;

     nCampo = 16 + nMes;      ||Enero = Campo 17 ... y idem resto
     #guerm033#nCampo# = #guerm033#nCampo# + #guerm008#10;
     #guerm033#29 = #guerm033#29 + #guerm008#10;  ||Totales Litros

     nCampo = 29 + nMes;
     #guerm033#nCampo# = #guerm033#nCampo# + #guerm008#12;
     #guerm033#42 = #guerm033#42 + #guerm008#12;  ||Totales Euros

     |GRABA 020#guerm033.a;
     |LIBERA #guerm033;
|FPRC;

|PROCESO ActSur;
     |DDEFECTO #guerm006;
     #guerm006#0 = #guerm008#3;
     |LEE 101#guerm006.=;
     |SI FSalida ! 0; |GRABA 020#guerm006.b; |FINSI;

     |SI aTipo = "ENT";
          nCampo = 1 + nMes;
          nCampoE = 40 + nMes;
     |SINO;
          nCampo = 14 + nMes;
          nCampoE = 53 + nMes;
     |FINSI;

     #guerm006#nCampo# = #guerm006#nCampo# + #guerm008#10;
     |SI aTipo = "ENT";
          #guerm006#14 = #guerm006#14 + #guerm008#10;
     |SINO;
          #guerm006#27 = #guerm006#27 + #guerm008#10;
     |FINSI;

     #guerm006#nCampoE# = #guerm006#nCampoE# + #guerm008#12;
     |SI aTipo = "ENT";
          #guerm006#53 = #guerm006#53 + #guerm008#12;
     |SINO;
          #guerm006#66 = #guerm006#66 + #guerm008#12;
     |FINSI;

     ||saldos
     |PARA i = 28; |SI i [ 40; |HACIENDO i = i + 1;
          nEntra = i - 26;
          nSale = i - 13;
          #guerm006#i# = #guerm006#nEntra# - #guerm006#nSale#;
     |SIGUE;

     |GRABA 020#guerm006.a;
     |LIBERA #guerm006;
|FPRC;
