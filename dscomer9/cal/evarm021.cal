|FICHEROS;
     evarm021 #0;
     evarm004 #4;
     agifa024 #24;
     agifa104 #104,MANTE;
     agifa073 #73,MANTE;
|FIN;

|VARIABLES;
     &eaCliente = "";
     nOk = 0;
     nSw = 0;
     i = 0;
     &Tempo = "";
     nPdte = 0;
     nTalla = 0;
     aAlfa = "";
|FIN;

|PROCESO PintaObse; |TIPO 7;
     |ABRE #4;
     #4#30 = #0#4;
     #4#31 = #0#5;
     #4#32 = #0#6;
     |LEE 000#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
     |CIERRA #4;
     |ATRI I;
     |PINTA 2016, #4#0;
     |PINTA 2116, #4#1;
     |PINTA 2216, #4#2;
     |ATRI 0;
|FPRC;

|PROCESO Imprimiendo;
     |PRINT;
|FPRC;

|DEFBUCLE Imprimiendo;
     #0#4;
     11;
     eaCliente, "N";
     eaCliente, "N";
     ;
     NULL, Imprimiendo;
|FIN;

|PROCESO Imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "eva00021";
          |SI FSalida = 0;
               |BUCLE Imprimiendo;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'eva00021'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;


|PROCESO PulsaTecla; |TIPO 11;
     |SI FSalida = 13; || Pedido
          |ABRE #104;
          #104#25 = #0#4;
          #104#0 = #0#5;
          |LEE 020#104=;
          |SI FSalida = 0;
               |PUSHV 0101 2380;
               |CLS;
               |PINPA #0#104;
               |PINDA #0#104;
               |ENDATOS #4#104;
               |POPV;
          |FINSI;
          |CIERRA #104;
          |ERROR;
     |FINSI;
     |SI FSalida = 14; || Imprimir
          nSw = 1;
          |PTEC 807;
     |FINSI;
     |SI FSalida = 15;
          |CONSULTA_CLAVE #2#0;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min;
     #0#10 = eaCliente;
     #0#9 = "31.12.9999";
     #0#11 = "N";
     #0#1 = " " * 20;
     #0#2 = " " * 8;
|FPRC;

|PROCESO Max;
     #0#10 = eaCliente;
     #0#9 = "01.01.0000";
     #0#11 = "N";
     #0#1 = "z" * 20;
     #0#2 = "z" * 8;
|FPRC;

|PROCESO LlenaRefe;
     aAlfa = #0#2; |QBF aAlfa;
     |SI aAlfa = "";
          #4#30 = #0#4;
          #4#31 = #0#5;
          #4#32 = #0#6;
          |LEE 000#4=;
          |SI FSalida = 0;
               #0#7 = #4#28;
               |GRABA 020#0a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE LlenaRefe;
     #0#4;
     ;
     eaCliente;
     eaCliente;
     be;
     NULL, LlenaRefe;
|FIN;

|PROCESO Lineal;
     |ABRE #4;
     |BUCLE LlenaRefe;
     |CIERRA #4;

     |ABRE #24;
     #24#0 = eaCliente;
     |LEE 000#24=;
     |CIERRA #24;
     |PINTA 535, #24#0;
     |PINTA 544, #24#1;

     |PARA nSw = 1; |SI nSw ! 0; |HACIENDO;
          nSw = 0;
          |ENTLINEAL #2#0, 4, 4, 17, 0, Min, Max;
          |SI nSw = 1;
               |HAZ Imprime;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #24;
     #24#0 = #0#10;
     |LEE 000#24];
     |CONSULTA_CLAVE #1#24;
     |SI FSalida = 0;
          #0#10 = #24#0;
          nOk = 1;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROGRAMA;
     |CLS;
     |SI eaCliente = "";
          |PINPA #0#0;
          |ENTLINEAL #2#0, 4, 7, 17, 0, Min, Max;
          |PINTA 544, #24#1;
          |C_V #0#10, 1, "S";
          |ENCAMPO #10#0;
          |SI FSalida = 0; |O nOk = 1;
               |C_V #0#10, 1, "N";
               eaCliente = #0#10;
               |HAZ Lineal;
          |FINSI;
     |SINO;
          |PINPA #0#0;
          |HAZ Lineal;
     |FINSI;
|FPRO;
