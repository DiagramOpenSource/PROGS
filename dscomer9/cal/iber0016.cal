|FICHEROS;
     iber0016 #0;
     agifa007 #1;
     iber0205 #2;
     iber0017 #5;
     iber0018 #6;
     iber0068 #7;
     iber0069 #8;
     iber0202 #9;
     iber0019 #10;
     iber0020 #11;
     iber0040 #12;
     iber0074 #13;
     iber0070 #14;
     iber0203 #15;
     agifa505 #16;
     iber0204 #17;
     iber0041 #18;
     iber0001 #19;
     iber0002 #20;
     iber0063 #21;
     iber0064 #22;
     agifa007 #23;
     iber0205 #24;
     iber0056 #25;
     iber0026 #26;
     agifa029 #29;
     iberz201 #30;
     agifa501 #40; ||Ticket....
     agifa502 #41;
     agifa077 #42;
     agifa080 #43;
     agifa065 #45;
     agifa142 #142;
|FIN;

|VARIABLES;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     &enAlta   = 0; || Llamada de iber0201
     wT        = 0;
     aDes      = "";
     aHas      = "";
     nCamp     = 0;
     nSal      = 0;
     nMod      = 0;
     aFec      = "";
     fFec      = @;
     aSer      = "";
     aCentro   = "";
     aAlfa     = "";
     aAlfa1    = "";
     bAlfa     = "";
     cAlfa     = "";
     nNume     = 0;
     cNume     = 0;
     nModo     = 0;
     nDes      = 0;
     nHas      = 0;
     &enCentro = 0;
|FIN;

|PROCESO Centro16_7; |TIPO 7;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |SI #142#164 = "D";
          |DFICE aCentro;
          aCentro = aCentro % -403;
          #0#0 = aCentro;
     |FINSI;
|FPRC;


|PROCESO agifa080b;
     |BORRA 020#43a;
     |LIBERA #43;
|FPRC;

|PROCESO agifa077b;
     |BORRA 020#42a;
     |LIBERA #42;
|FPRC;

|DEFBUCLE agifa077b;
     #42#1;
     ;
     aDes,     0;
     aHas,999999;
     be;
     NULL,NULL,agifa080b,agifa077b;
|FIN;

|PROCESO agifa502b;
     |BORRA 020#41a;
|FPRC;

|DEFBUCLE agifa502b;
     #agifa502#1;
     ;
     #agifa501#36, #agifa501#0, 001;
     #agifa501#36, #agifa501#0, 999;
     be;
     NULL, agifa502b;
|FIN;

|PROCESO agifa501b;
     |BUCLE agifa502b;
     |BORRA 020#40a;
|FPRC;

|DEFBUCLE agifa501b;
     #40#2;
     ;
     " ",aDes,     0;
     "z",aHas,999999;
     be;
     NULL,agifa501b;
|FIN;

|PROCESO agifa065c;
     |BORRA 020#45a;
     |LIBERA #45;
|FPRC;

|DEFBUCLE agifa065c;
     #45#1;
     ;
     "                    ","01.01.0000","  ",000000,00000,aDes;
     "zzzzzzzzzzzzzzzzzzzz","31.12.2300","zz",999999,99999,aHas;
     be;
     NULL,agifa065c;
|FIN;

|PROCESO agifa065b;
     wT = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE agifa065b;
     #45#1;
     ;
     "                    ","01.01.0000","  ",000000,00000,aDes;
     "zzzzzzzzzzzzzzzzzzzz","31.12.2300","zz",999999,99999,aHas;
     ;
     NULL,agifa065b;
|FIN;

|PROCESO iber0056b;
     |BORRA 020#25a;
     |LIBERA #25;
|FPRC;

|DEFBUCLE iber0056b;
     #25#1;
     ;
     #0#0, 1,"     ";
     #0#0,99,"zzzzz";
     be;
     NULL,iber0056b;
|FIN;

|PROCESO agifa007b;
     |BORRA 020#23a;
     |LIBERA #23;
|FPRC;

|DEFBUCLE agifa007b;
     #23#1;
     ;
     aDes;
     aHas;
     be;
     NULL,agifa007b;
|FIN;

|PROCESO iber0064b;
     |BORRA 020#22a;
     |LIBERA #22;
|FPRC;

|PROCESO iber0063b;
     |BORRA 020#21a;
     |LIBERA #21;
|FPRC;

|DEFBUCLE iber0063b;
     #21#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL,NULL,iber0064b,iber0063b;
|FIN;

|PROCESO iber0002b;
     |BORRA 020#20a;
     |LIBERA #20;
|FPRC;

|PROCESO iber0001b;
     |BORRA 020#19a;
     |LIBERA #19;
|FPRC;

|DEFBUCLE iber0001b;
     #19#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL,NULL,iber0002b,iber0001b;
|FIN;

|PROCESO iber0041b;
     |BORRA 020#18a;
     |LIBERA #18;
|FPRC;

|DEFBUCLE iber0041b;
     #18#1;
     ;
     #0#0, 0;
     #0#0,99;
     be;
     NULL,iber0041b;
|FIN;

|PROCESO iber0204b;
     |BORRA 020#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE iber0204b;
     #17#1;
     ;
     #0#0, 0;
     #0#0,99;
     be;
     NULL,iber0204b;
|FIN;

|PROCESO agifa505b;
     |BORRA 020#16a;
     |LIBERA #16;
|FPRC;

|DEFBUCLE agifa505b;
     #16#1;
     ;
     nDes;
     nHas;
     be;
     NULL,agifa505b;
|FIN;

|PROCESO iber0203b;
     |BORRA 020#15a;
     |LIBERA #15;
|FPRC;

|DEFBUCLE iber0203b;
     #15#1;
     ;
     #0#0, 0;
     #0#0,99;
     be;
     NULL,iber0203b;
|FIN;

|PROCESO iber0070b;
     |BORRA 020#14a;
     |LIBERA #14;
|FPRC;

|DEFBUCLE iber0070b;
     #14#1;
     ;
     #0#0,"     ", 0;
     #0#0,"zzzzz",99;
     be;
     NULL,iber0070b;
|FIN;

|PROCESO iber0074b;
     |BORRA 020#13a;
     |LIBERA #13;
|FPRC;

|DEFBUCLE iber0074b;
     #13#1;
     ;
     #0#0,01,01;
     #0#0,99,99;
     be;
     NULL,iber0074b;
|FIN;

|PROCESO iber0040b;
     |BORRA 020#12a;
     |LIBERA #12;
|FPRC;

|DEFBUCLE iber0040b;
     #12#1;
     ;
     #0#0,"        ";
     #0#0,"zzzzzzzz";
     be;
     NULL,iber0040b;
|FIN;

|PROCESO iber0020b;
     |BORRA 020#11a;
     |LIBERA #11;
|FPRC;

|PROCESO iber0019b;
     |BORRA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE iber0019b;
     #10#1;
     ;
     #0#0, 1;
     #0#0,99;
     be;
     NULL,NULL,iber0020b,iber0019b;
|FIN;

|PROCESO iber0202b;
     |BORRA 020#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE iber0202b;
     #9#1;
     ;
     #0#0, 1;
     #0#0,99;
     be;
     NULL,iber0202b;
|FIN;

|PROCESO iber0069b;
     |BORRA 020#8a;
     |LIBERA #8;
|FPRC;

|PROCESO iber0068b;
     |BORRA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE iber0068b;
     #7#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL,NULL,iber0069b,iber0068b;
|FIN;

|PROCESO iber0018b;
     |BORRA 020#6a;
     |LIBERA #6;
|FPRC;

|PROCESO iber0017b;
     |BORRA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE iber0017b;
     #5#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL,NULL,iber0018b,iber0017b;
|FIN;

|PROCESO iberz201b;
     |BORRA 020#30a;
     |LIBERA #30;
|FPRC;

|DEFBUCLE iberz201b;
     #30#1;
     ;
     nDes;
     nHas;
     be;
     NULL,iberz201b;
|FIN;

|PROCESO agifa029b;
     |BORRA 020#29a;
     |LIBERA #29;
|FPRC;

|DEFBUCLE agifa029b;
     #29#1;
     ;
     nDes;
     nHas;
     be;
     NULL,agifa029b;
|FIN;

|PROCESO BorraCalidad;
     |BORRA 020#26a;
     |LIBERA #26;
|FPRC;

|DEFBUCLE iber0026;
     #26#1;
     ;
     #0#0, "     ";
     #0#0, "zzzzz";
     be;
     NULL, BorraCalidad;
|FIN;


|PROCESO Tipo2; |TIPO 2;
     #0#6 = (("00" + #0#4) % -102) + (("000" + #0#5) % 105);

   nModo = (FEntrada / 100) ! 0;
|SI nModo = 3;
     wT = 0;
     |BUCLE agifa065b;
     |SI wT = 1;
          |CONFI "0000NEste Centro Tiene Movimientos Continuar Con la BAJA";
          |SI FSalida ! 0;
               |ERROR;
               |ACABA;
          |FINSI;
     |FINSI;
     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |BORRA 020#24a;
     |CIERRA #24;

     nDes = #0#0 * 100;
     nHas = #0#0 * 100;
     nHas = nHas + 99;
     aDes = nDes; |QBF aDes;  aDes = aDes % 103; aDes = aDes + "  ";
     aHas = nHas; |QBF aHas;  aHas = aHas % 103; aHas = aHas + "zz";
     |BUCLE iber0026;
     |BUCLE agifa029b;
     |BUCLE iberz201b;
     |BUCLE iber0017b;
     |BUCLE iber0068b;
     |BUCLE iber0202b;
     |BUCLE iber0019b;
     |BUCLE iber0040b;
     |BUCLE iber0074b;
     |BUCLE iber0070b;
     |BUCLE iber0203b;
     |BUCLE agifa505b;
     |BUCLE iber0204b;
     |BUCLE iber0041b;
     |BUCLE iber0001b;
     |BUCLE iber0063b;
     |BUCLE agifa007b;
     |BUCLE iber0056b;
||     |BUCLE agifa065c;
||     |BUCLE agifa501b;
||     |BUCLE agifa077b;
|FINSI;
|FPRC;

|PROCESO Tipo20m16;  |TIPO 20;
     aAlfa = FSalida;

     |SI aAlfa = "OPCION";
         FSalida = "C.Calidad";
         |ACABA;
     |FINSI;

     |LEE 040#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     enCentro = #0#0;
     |SUB_EJECUTA_NP "iber0026";
|FPRC;

|PROCESO altaser; |TIPO 7;
     nMod = (FEntrada / 100) ! 0;
     |SI nMod ! 1; |O enAlta ! 0; |ACABA; |FINSI;
     aSer = #0#0; |QBF aSer;
     aSer = ("000" + aSer) % -103;
     fFec = ~;
     aFec = fFec % -101;
     #0#11 = aSer + "C" + aFec;
     #0#12 = aSer + "I" + aFec;
     #0#13 = aSer + "P" + aFec;
     #0#16 = aSer + "F" + aFec;
     #0#21 = aSer + "S" + aFec;
     #0#27 = aSer + "D" + aFec;
     #0#14 = #0#0 * 100;
     #0#15 = #0#0 * 100;

     #0#25 = "SE"; |PINTA #0#25;
     #0#22 = "CE"; |PINTA #0#22;
     #0#23 = "IN"; |PINTA #0#23;
     #0#24 = "PR"; |PINTA #0#24;

     |ABRE #1;
     |ABRE #2;
     |DDEFECTO #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     aAlfa =  #0#11;  |HAZ al;
     aAlfa =  #0#12;  |HAZ al;
     aAlfa =  #0#13;  |HAZ al;
     aAlfa =  #0#16;  |HAZ al;
     aAlfa = aSer + "T" + aFec; |HAZ al;
     aAlfa = aSer + "V" + aFec; |HAZ al;
     |CIERRA #1;
     |CIERRA #2;
     |PINTA #0#11;
     |PINTA #0#12;
     |PINTA #0#13;
     |PINTA #0#16;
     |PINTA #0#14;
     |PINTA #0#15;
     |PINTA #0#21;
     |PINTA #0#27;
|FPRC;

|PROCESO al;
     |DDEFECTO #1;
     #1#26 = aAlfa;
     |LEE 101#1=;
     nSal = FSalida;
     #1#1  = "iber0081";
     #1#11 = "iber0084";

     aAlfa1 = #1#26; |QBF aAlfa1;
     aAlfa1 = (aAlfa1 % 103) + "00";
     #1#29 = aAlfa1; #1#31 = aAlfa1;

     |SI #2#2 = 1; #1#21= "tmesaoro";  |FINSI;
     |SI #2#2 = 2; #1#21= "tbodegon";  |FINSI;
     |SI #2#2 = 3; #1#21= "talacena";  |FINSI;
     |SI #2#2 = 4; #1#21= "tbocater";  |FINSI;
     |SI nSal = 0; |GRABA 020#1a; |FINSI;
     |SI nSal ! 0; |GRABA 020#1n; |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO verif; |TIPO 6;
     nCamp = Campo;
     |SI nCamp = 14; |O nCamp = 15;
          aAlfa = #0nCamp; |QBF aAlfa; aAlfa = ("00000" + aAlfa) % -105;
          aAlfa = aAlfa %  103;
          nNume = aAlfa;
          |SI nNume ! #0#0;
               |MENAV "0000Formato Almacen No Permitido";
               |ERROR;
          |FINSI;
     |SINO;
          aAlfa = #0nCamp %  103;
          bAlfa = #0nCamp %  401;
          cAlfa = #0nCamp % -101;
          nNume = aAlfa;
          cNume = cAlfa;
          |SI nNume ! #0#0;
               |MENAV "0000Formato Serie No Permitido";
               |ERROR;
          |SINO;
               |SI bAlfa ! "C";  |Y nCamp = 11;
                    |MENAV "0000Formato Serie No Permitido";
                    |ERROR;
               |SINO;
                    |SI bAlfa ! "I";  |Y nCamp = 12;
                         |MENAV "0000Formato Serie No Permitido";
                         |ERROR;
                    |SINO;
                         |SI bAlfa ! "P";  |Y nCamp = 13;
                              |MENAV "0000Formato Serie No Permitido";
                              |ERROR;
                         |SINO;
                              |SI bAlfa ! "F";  |Y nCamp = 16;
                                   |MENAV "0000Formato Serie No Permitido";
                                   |ERROR;
                              |SINO;
                                   |SI cNume = 0;
                                        |MENAV "0000Formato Serie No Permitido";
                                        |ERROR;
                                   |FINSI;
                              |FINSI;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO IVA016_66; |TIPO 66;
     enTiva = #0Campo;
     efFiva = ~;
     |HAZ ConsuIVA;
     |SI eaDiva = "";
          |ERROR;
     |SINO;
          #0Campo = enTiva; |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO IVA016_0; |TIPO 0;
     enTiva = #0Campo;
     efFiva = ~;
     |HAZ SacaIVA;
     |SI eaDiva = "";
          |MENAV "0000No existe tipo iva para esta fecha...";
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
