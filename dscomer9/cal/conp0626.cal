|FICHEROS;
conp0625 #0;
conp0626 #1;
con00627 #2;
con00628 #3,MANTE;
con00629 #4,MANTE;
con00630 #5,MANTE;
con00631 #6,MANTE;
agifa019 #11;
agifa065 #12;
agifa017 #9; || STOCK POR ALMACENES
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     nSwCanon = 0;
     nSeccion = 0;
     &enLinCanon = 0;

     nModo = 0;
     nForma = 0;
     &EURODB = 0;
     modo_ent = 0;
     mod = 0;
     serie_orig = "";
     parte_orig = "";
     linea_orig = 0;
     mes = 0;
     fmes = "  ";
     mes_margen = 0;
     mes_importe = 0;
     &opcion = 0;
|FIN;

|PROCESO m_obra;
|SI mod = -1;
|DDEFECTO #4;
#4#9 = #1#10;
|PUSHV 0501 2380;
     #4#0 = #1#2;
     #4#1 = #1#3;
     #4#2 = #1#4;
     #4#3 = #1#13;
     #4#4 = #1#5;
     #4#6 = #1#6;
     #4#7 = #1#7;
     #4#8 = #1#8;
     #4#9 = #1#10;
     #4#12 = #1#14;
     #4#13 = #1#21;
     #4#14 = #1#22;
     #4#15 = #1#23;
     #4#16 = 1;
     #4#17 = #1#0;
|PINPA #0#4;
|PINDA #0#4;
|ENDATOS #2#4;
|SI FSalida = 0;
     #1#2 = #4#0;
     #1#3 = #4#1;
     #1#4 = #4#2;
     #1#5 = #4#4;
     #1#6 = #4#6;
     #1#7 = #4#7;
     #1#8 = #4#8;
     #1#10 = #4#9;
     #1#9 = 1;
     #1#13 = #4#3;
     #1#14 = #4#12;
     #1#21 = #4#13;
     #1#22 = #4#14;
     #1#23 = #4#15;
|FINSI;
|POPV;
|FINSI;
|FPRC;


|PROCESO s_ext;
|SI mod = -1;
|DDEFECTO #3;
#3#7 = #1#10;
#3#0 = #1#2;

#3#1 = #1#3;
#3#2 = #1#4;
#3#3 = #1#5;
#3#4 = #1#6;
#3#5 = #1#7;
#3#6 = #1#8;
#3#7 = #1#10;
#3#11 = #1#14;
#3#12 = #1#16;
#3#13 = #1#18;
#3#14 = #1#22;
#3#15 = #1#23;
#3#16 = 3;
#3#17 = #1#0;
|PUSHV 0501 2380;
|PINPA #0#3;
|PINDA #0#3;
|ENDATOS #2#3;
|SI FSalida = 0;
       #1#2 = #3#0;
       #1#3 = #3#1;
       #1#4 = #3#2;
       #1#5 = #3#3;
       #1#6 = #3#4;
       #1#7 = #3#5;
       #1#8 = #3#6;
       #1#10 = #3#7;
       #1#14 = #3#11;
       #1#16 = #3#12;
       #1#18 = #3#13;
       #1#22 = #3#14;
       #1#23 = #3#15;
|FINSI;
|POPV;
|FINSI;
|FPRC;

|PROCESO artic;
|SI mod = -1;
|DDEFECTO #5;
#5#8 = #1#10;
#5#0 = #1#2;
#5#1 = #1#3;
#5#2 = #1#4;
#5#3 = #1#5;
#5#5 = #1#6;
#5#6 = #1#7;
#5#7 = #1#8;
#5#11 = #1#14;
#5#12 = #1#15;
#5#13 = #1#16;
#5#14 = #1#17;
#5#15 = #1#18;
#5#16 = #1#19;
#5#17 = #1#22;
#5#18 = #1#23;
#5#19 = 2;
#5#20 = #1#0;
|PUSHV 0501 2380;
|PINPA #0#5;
|PINDA #0#5;
|ENDATOS #2#5;
|SI FSalida = 0;
     #1#2 = #5#0;
     #1#3 = #5#1;
     #1#4 = #5#2;
     #1#5 = #5#3;
     #1#6 = #5#5;
     #1#7 = #5#6;
     #1#8 = #5#7;
     #1#10 = #5#8
     #1#14 = #5#11;
     #1#15 = #5#12;
     #1#16 = #5#13;
     #1#17 = #5#14;
     #1#18 = #5#15;
     #1#19 = #5#16;
     #1#22 = #5#17;
     #1#23 = #5#18;
     |HAZ ModiArti;
|FINSI;
|POPV;
|FINSI;

|FPRC;



|PROCESO lubri;
|SI mod = -1;
|DDEFECTO #6;
#6#8 = #1#10;

     #6#0 = #1#2;
     #6#1 = #1#3;
     #6#2 = #1#4;
     #6#3 = #1#5;
     #6#5 = #1#6;
     #6#6 = #1#7;
     #6#7 = #1#8;
     #6#8 = #1#10;
     #6#11 = #1#14;
     #6#12 = #1#15;
     #6#13 = #1#16;
     #6#14 = #1#17;
     #6#15 = #1#18;
     #6#16 = #1#19;
     #6#17 = #1#22;
     #6#18 = #1#23;
     #6#19 = 4;
     #6#20 = #1#0;
|PUSHV 0501 2380;
|PINPA #0#6;
|PINDA #0#6;
|ENDATOS #2#6;
|SI FSalida = 0;
     #1#2 = #6#0;
     #1#3 = #6#1;
     #1#4 = #6#2;
     #1#5 = #6#3;
     #1#6 = #6#5;
     #1#7 = #6#6;
     #1#8 = #6#7;
     #1#10 = #6#8;
     #1#14 = #6#11;
     #1#15 = #6#12;
     #1#16 = #6#13;
     #1#17 = #6#14;
     #1#18 = #6#15;
     #1#19 = #6#16;
     #1#22 = #6#17;
     #1#23 = #6#18;
     |HAZ ModiLubri;
|FINSI;
|POPV;
|FINSI;

|FPRC;


|PROCESO mod_lin;
|SI #1#11 ] 1; |Y #1#11 [ 999; |HAZ m_obra; |FINSI;
|SI #1#11 ] 1000; |Y #1#11 [ 1999; |HAZ artic; |FINSI;
|SI #1#11 ] 2000; |Y #1#11 [ 2999; |HAZ s_ext; |FINSI;
|SI #1#11 ] 3000; |Y #1#11 [ 3999; |HAZ lubri; |FINSI;

|FPRC;

|PROCESO tip_2; |TIPO 2;
     modo_ent = (FEntrada/100)!0;
     mod = 0 +. 1;
     |SI #1#27 = -1;
          |SI mod = -1;
               |MENAV "0000Linea canon de articulo, no se puede modificar";
          |FINSI;
          |ERROR; |ACABA;
     |FINSI;

     |SI modo_ent = 1; |ERROR; |FINSI;
     |SI modo_ent = 2;|HAZ mod_lin; |FINSI;
     |SI modo_ent = 3;
          |SI #1#27 ! 0;
               |HAZ BajaCanon;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ModiArti;
     |SALVA_FICHA #1;

     nSeccion = #1#23;

     |DDEFECTO #11;
     |ABRE #11;
     #11#0 = #1#2;
     |LEE 020#11=;
     |CIERRA #11;

     nSwCanon = 0;
     enLinCanon = 0;

     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#9 = 5;
     #1#11 = #1#27;
     |LEE 101#1=;
     |SI FSalida = 0;
          |SI #11#168 = 0;
               nSwCanon = 1;
               enLinCanon = 0;
               |BORRA 020#1a;
          |SINO;
               enLinCanon = #1#11;
               #1#2 = "xxxxx";
               #1#3 = "CANON " + #5#1;
               #1#4 = #5#2;
               #1#5 = #11#168;
               #1#6 = 0;
               #1#7 = 0;
               #1#8 = #1#4  * #1#5;
               #1#9 = 5;
               #1#10 = #5#8
               #1#14 = #5#11;
               #1#23 = nSeccion;
               #1#27 = -1;
               #1#28 = #11#30;
               |GRABA 020#1a;
          |FINSI;
     |SINO;
          |HAZ CanonArticulo;
     |FINSI;
     |SI nSwCanon = 1; |O enLinCanon ! 0;
          |PONCONTROL 23, "SI";
          |PTEC 808; |PTEC 809; |PTEC 808;
     |FINSI;
     |REPON_FICHA #1;
     #1#27 = enLinCanon;
|FPRC;

|PROCESO ModiLubri;
     |SALVA_FICHA #1;

     nSeccion = #1#23;

     |DDEFECTO #11;
     |ABRE #11;
     #11#0 = #1#2;
     |LEE 020#11=;
     |CIERRA #11;

     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#9 = 5;
     #1#11 = #1#27;
     |LEE 101#1=;
     |SI FSalida = 0;
          |SI #11#168 = 0;
               enLinCanon = 0;
               |BORRA 020#1a;
          |SINO;
               enLinCanon = #1#11;
               #1#2 = "xxxxx";
               #1#3 = "CANON " + #6#1;
               #1#4 = #6#2;
               #1#5 = #11#168;
               #1#6 = 0;
               #1#7 = 0;
               #1#8 = #1#4  * #1#5;
               #1#9 = 5;
               #1#10 = #6#8
               #1#14 = #6#11;
               #1#23 = nSeccion;
               #1#27 = -1;
               #1#28 = #11#30;
               |GRABA 020#1a;
          |FINSI;
     |SINO;
          |HAZ CanonLubri;
     |FINSI;
     |PONCONTROL 23, "SI";
     |PTEC 809; |PTEC 808;

     |REPON_FICHA #1;
     #1#27 = enLinCanon;
|FPRC;

|PROCESO BajaCanon;
     |SALVA_FICHA #1;

     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#9 = 5;
     #1#11 = #1#27;
     |LEE 101#1=;
     |SI FSalida = 0;
          |BORRA 020#1a;
          |PONCONTROL 23, "SI";
          |PTEC 809; |PTEC 808;
     |FINSI;

     |REPON_FICHA #1;
|FPRC,
