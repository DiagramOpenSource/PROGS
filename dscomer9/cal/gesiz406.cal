     Todos

|FICHEROS;
     gesiz006 #0;
     agifa010 #10;
     gesim005 #17;
     gesim006 #18;
     gesim013 #23;

     &referd1@;
     &referd2@;
     &referd3@;
|FIN;

|VARIABLES;
     &aDivisa = "";
     &aMoneda = "";
     &ser_alb = "";
     &num_alb = 0;
     &abono = "";
     &eaMenuImpre = "";
     &enPestana = 0;
     &eaCliDoc = "";
     &eaAuto = "";
     &eaClave = "";
     &eaProg = "";
     &enTipo = 0;
     &enModo = 0;
     &enError = 0;
     &eaMatricula = "";
     &eaSerAviso = "";
     &enNumAviso = 0;
     v0 = "000000";
     v1 = "                              ";
     v2 = 0;
     aPath = "";
     nPanta = 0;
     aAlfa = "";
     nRango = 0;
     nPos1 = 0;
     nPos2 = 0;

     nBtnSalir4 = 0;
     nBtnReabre4 = 0;
     nBtnImpre4 = 0;
     nBtnVerAlb4 = 0;
     nBtnVerFac4 = 0;
     nBtnHismaq4 = 0;
     nBtnAsgMaq4 = 0;
     nBtnImpPar4 = 0;
     nBtnHisMaqPar4 = 0;
     nBtnAsgMaqPar4 = 0;
     nBtnImpAlb4 = 0;
     nEvtFoco = 0;
     &enGridd1 = 0;
     &enGridd2 = 0;
     &enGridd3 = 0;
|FIN;

|PROCESO EventoFoco4;
     enPestana = 4;
|FPRC;

|PROCESO BtnImpPar4;
     |LEE 000#referd2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referd1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referd2@;
     |REPON_DATOS #18;
     |HAZ ImpreParte;
|FPRC;

|PROCESO BtnHisMaqPar4;
     |LEE 000#referd2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaMatricula = #referd2@#41;
     eaSerAviso = #referd2@#0;
     enNumAviso = #referd2@#1;
     |HAZ HistoMaquina;
|FPRC;

|PROCESO BtnImpAlb4;
     |ABRE #23;
     #23#0 = #referd1@#0;
     #23#1 = #referd1@#1;
     #23#4 = 999;
     |LEE 000#23];
     |SI FSalida = 0;
          |LEE 000#23a;
     |SINO;
          |LEE 000#23u;
     |FINSI;
     |SI FSalida = 0; |Y #23#0 = #referd1@#0; |Y #23#1 = #referd1@#1;
          |ABRE #10;
          #10#52 = #23#2;
          #10#0 = #23#3;
          |LEE 000#10=;
          |SI FSalida = 0;
               ser_alb = #10#52;
               num_alb = #10#0;
               abono = #10#43;
               eaMenuImpre = "N";
               |SUB_EJECUTA_NP "agifa014";
          |SINO;
               aAlfa = "0000No existe albar n:" + #10#52 + "/" + #10#0;
               |MENAV aAlfa;
          |FINSI;
     |SINO;
          |MENAV "0000No existe albar n en fichero relaci¢n";
     |FINSI;
     |CIERRA #23;
|FPRC;

|PROCESO BtnAsgMaqPar4;
     |LEE 000#referd2@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referd1@;
     |REPON_DATOS #17;
     |SALVA_DATOS #referd2@;
     |REPON_DATOS #18;
     |HAZ AsignaMatriPar;
     |SI enError = 0;
          |REFRESCACONTROL enGridd2;
          |REFRESCACONTROL enGridd1;
     |FINSI;
|FPRC;

|PROCESO AbreUlt18;
     |ABRE #18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = 999;
     |LEE 000#18];
     |SI FSalida = 0;
          |LEE 101#18a;
     |SINO;
          |LEE 101#18u;
     |FINSI;
     |SI FSalida = 0; |Y #18#0 = #17#0;  |Y #18#1 = #17#1;
          #18#3 = "A";
          |GRABA 020#18a;
     |FINSI;
     |CIERRA #18;
|FPRC;

|PROCESO BtnReabre4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #referd1@#63 = "S";
          aAlfa = "0000NReabrir entrega:" + #referd1@#0+"/"+(("000000"+#referd1@#1)%-106);
     |SINO;
          aAlfa = "0000NReabrir aviso:" + #referd1@#0+"/"+(("000000"+#referd1@#1)%-106);
     |FINSI;
     |CONFI aAlfa;
     |SI FSalida = 0;
          |ABRE #17;
          #17#0 = #referd1@#0;
          #17#1 = #referd1@#1;
          |LEE 121#17=;
          |HAZ BorraFactu;
          |SI enError = 0;
               ||enTipo = -1;
               ||HAZ CreaAlba;
               |SI enError = 0;
                    |SI #17#63 = "S";
                         #17#24 = "T";
                         |HAZ AbreUlt18;
                    |SINO;
                         #17#24 = "C";
                    |FINSI;
                    |GRABA 020#17a;
                    |HAZ Refresca2;
                    |HAZ Refresca4;
                    |HAZ Refresca3;
               |FINSI;
          |FINSI;
          |CIERRA #17;
     |FINSI;
|FPRC;

|PROCESO BtnImpre4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referd1@;
     |REPON_DATOS #17;
     |HAZ ImpreAviso;
|FPRC;

|PROCESO BtnVerAlb4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaProg = "*gesiz018;A" + #referd1@#0 + (("000000"+#referd1@#1)%-106);
     |SUB_EJECUTA eaProg;
|FPRC;

|PROCESO BtnVerFac4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaProg = "*gesiz018;F" + #referd1@#0 + (("000000"+#referd1@#1)%-106);
     |SUB_EJECUTA eaProg;
|FPRC;

|PROCESO BtnHismaq4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaMatricula = #referd1@#22;
     eaSerAviso = #referd1@#0;
     enNumAviso = #referd1@#1;
     |HAZ HistoMaquina;
|FPRC;

|PROCESO BtnAsgMaq4;
     |LEE 000#referd1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #referd1@;
     |REPON_DATOS #17;
     |HAZ AsignaMatri;
     |SI enError = 0; |HAZ Refresca4; |FINSI;
|FPRC;

|PROCESO PinTotaAlb;
     |ABRE #23;
     #23#0 = #referd1@#0;
     #23#1 = #referd1@#1;
     #23#4 = 999;
     |LEE 000#23];
     |SI FSalida = 0;
          |LEE 000#23a;
     |SINO;
          |LEE 000#23u;
     |FINSI;
     |SI FSalida ! 0; |O #23#0 ! #referd1@#0; |O #23#1 ! #referd1@#1;
          |DDEFECTO #23;
     |FINSI;
     |ABRE #10;
     #10#52 = #23#2;
     #10#0 = #23#3;
     |LEE 000#10=;
     |SI FSalida ! 0; |DDEFECTO #10; |FINSI;
     aDivisa = #10#68;
     aMoneda = #10#70;
     |HAZ Divisas010;
     |CIERRA #10;
     |CIERRA #23;
     |PINTA 3325, #10#67;
|FPRC;

|PROCESO Evento41;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referd1@.=;
          |SI FSalida = 0;
               eaCliDoc = #referd1@#5;
               #0#6 = #referd1@#7;
               #0#7 = #referd1@#8;
               #0#8 = #referd1@#9;
          |SINO;
               #0#6 = "";
               #0#7 = "";
               #0#8 = "";
          |FINSI;
          #0#9 = "";
          #0#10 = "";
          #0#11 = "";
          #0#12 = "";
          #0#13 = "N";
          #0#14 = "N";
          #0#15 = "";
          #0#16 = "";
          #0#17 = "";
          #0#18 = "";
          #0#19 = "N";
          #0#20 = "N";
          #0#21 = "";
          #0#22 = "";
          #0#23 = "";
          #0#24 = "";
          #0#25 = "N";
          #0#26 = "N";

          |HAZ PinCam4;
          |HAZ PinTotaAlb;
          #referd2@#1 = 0; |REFRESCACONTROL enGridd3;
          |REFRESCACONTROL enGridd2;
     |FINSI;
|FPRC;

|PROCESO Evento42;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referd2@.=;
          |SI FSalida = 0;
               #0#9 = #referd2@#44;
               #0#10 = #referd2@#45;
               #0#11 = #referd2@#46;
               #0#12 = #referd2@#47;
               #0#13 = #referd2@#48;
               #0#14 = #referd2@#49;
               #0#15 = #referd2@#50;
               #0#16 = #referd2@#51;
               #0#17 = #referd2@#52;
               #0#18 = #referd2@#53;
               #0#19 = #referd2@#54;
               #0#20 = #referd2@#55;
               #0#21 = #referd2@#56;
               #0#22 = #referd2@#57;
               #0#23 = #referd2@#58;
               #0#24 = #referd2@#59;
               #0#25 = #referd2@#60;
               #0#26 = #referd2@#61;
          |SINO;
               #0#9 = "";
               #0#10 = "";
               #0#11 = "";
               #0#12 = "";
               #0#13 = "";
               #0#14 = "";
               #0#15 = "";
               #0#16 = "";
               #0#17 = "";
               #0#18 = "";
               #0#19 = "";
               #0#20 = "";
               #0#21 = "";
               #0#22 = "";
               #0#23 = "";
               #0#24 = "";
               #0#25 = "";
               #0#26 = "";
          |FINSI;
          |HAZ PinCam4;
          |REFRESCACONTROL enGridd3;
     |FINSI;
|FPRC;

|PROCESO Evento43;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#referd3@.=;
     |FINSI;
|FPRC;

|PROCESO Min41;
     #referd1@#0 = "     ";
     #referd1@#1 = 000000;
     #referd1@#5 = #0#0;
     #referd1@#22 = #0#1;
     #referd1@#19 = #0#2;
     |SI #0#0 = "000000"; #referd1@#5# = "      "; |FINSI;
|FPRC;

|PROCESO Max41;
     #referd1@#0 = "zzzzz";
     #referd1@#1 = 999999;
     #referd1@#5 = #0#0;
     #referd1@#22 = #0#1;
     #referd1@#19 = #0#2;
     |SI #0#0 = "000000"; #referd1@#5# = "zzzzzz"; |FINSI;
     |SI #0#1 = "                              "; #referd1@#22# = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"; |FINSI;
     |SI #0#2 = 0; #referd1@#19# = 99999; |FINSI;
|FPRC;

|PROCESO Min42;
     #referd2@#0 = #referd1@#0;
     #referd2@#1 = #referd1@#1;
     #referd2@#2 = 1;
|FPRC;

|PROCESO Max42;
     #referd2@#0 = #referd1@#0;
     #referd2@#1 = #referd1@#1;
     #referd2@#2 = 999;
|FPRC;

|PROCESO Min43;
     #referd3@#0 = #referd2@#0;
     #referd3@#1 = #referd2@#1;
     #referd3@#2 = #referd2@#2;
     #referd3@#3 = 1;
|FPRC;

|PROCESO Max43;
     #referd3@#0 = #referd2@#0;
     #referd3@#1 = #referd2@#1;
     #referd3@#2 = #referd2@#2;
     #referd3@#3 = 999;
|FPRC;

|PROCESO Actualiza4;
     |DESTRUYECONTROL enGridd1;

     |PINPA #4#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1398;

     |SI #0#0 ! v0;
          |SI #0#1 ! v1;
               |LINEAL_SIMPLE #2#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
          |SINO;
               |LINEAL_SIMPLE #3#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
          |FINSI;
     |SINO;
          |SI #0#1 ! v1;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #4#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
               |SINO;
                    |LINEAL_SIMPLE #5#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
               |FINSI;
          |SINO;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #6#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
               |SINO;
                    |LINEAL_SIMPLE #7#referd1@, nRango, nPos1, nPos2, Min41, Max41, Evento41;
               |FINSI;
          |FINSI;
     |FINSI;
     enGridd1 = FSalida;
     #referd2@#1 = 0; |REFRESCACONTROL enGridd3;
     #referd1@#1 = 0; |REFRESCACONTROL enGridd2;
     |REFRESCACONTROL enGridd1;
|FPRC;

|PROCESO PinCam4;
     |PINPA #4#0;
     |PINTA 1409, #0#6;
     |PINTA 1509, #0#7;
     |PINTA 1609, #0#8;

     |PINTA 3025, #0#9;
     |PINTA 3047, #0#10;
     |PINTA 3059, #0#11;
     |PINTA 3071, #0#12;
     |PINTA 3084, #0#13;
     |PINTA 3093, #0#14;

     |PINTA 3125, #0#15;
     |PINTA 3147, #0#16;
     |PINTA 3159, #0#17;
     |PINTA 3171, #0#18;
     |PINTA 3184, #0#19;
     |PINTA 3193, #0#20;

     |PINTA 3225, #0#21;
     |PINTA 3247, #0#22;
     |PINTA 3259, #0#23;
     |PINTA 3271, #0#24;
     |PINTA 3284, #0#25;
     |PINTA 3293, #0#26;
|FPRC;

|PROCESO PintaPan4;
     |DDEF aPath;
     aAlfa = aPath + "gesim005"; |CARGA_DEF aAlfa, referd1@;
     aAlfa = aPath + "gesim006"; |CARGA_DEF aAlfa, referd2@;
     aAlfa = aPath + "gesim007"; |CARGA_DEF aAlfa, referd3@;
     |ABRET #referd1@;
     |ABRET #referd2@;
     |ABRET #referd3@;

     |PINPA #4#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2302;
     nPos2 = 2898;
     |LINEAL_SIMPLE #1#referd3@, nRango, nPos1, nPos2, Min43, Max43, Evento43;
     enGridd3 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 1802;
     nPos2 = 2298;
     |LINEAL_SIMPLE #1#referd2@, nRango, nPos1, nPos2, Min42, Max42, Evento42;
     enGridd2 = FSalida;
/*
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1398;
     |LINEAL_SIMPLE #1#referd1@, nRango, nPos1, nPos2, Max41, Min41, Evento41;
     enGridd1 = FSalida;
*/
     |CONTROL_SIMPLE nPanta, "EVENTOPAN", 0000, 0000, EventoFoco4;
     nEvtFoco = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Reabrir", 0501, 0513, BtnReabre4;
     nBtnReabre4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Imprimir", 0514, 0526, BtnImpre4;
     nBtnImpre4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Ver Albar n", 0527, 0539, BtnVerAlb4;
     nBtnVerAlb4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Ver Factura", 0540, 0552, BtnVerFac4;
     nBtnVerFac4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Hist. Maq.", 0553, 0565, BtnHismaq4;
     nBtnHismaq4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Asig. Maq.", 0566, 0578, BtnAsgMaq4;
     nBtnAsgMaq4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Imprimir Alb.", 0579, 0591, BtnImpAlb4;
     nBtnImpAlb4 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Imprimir", 1701, 1713, BtnImpPar4;
     nBtnImpPar4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Histo. Maq.", 1714, 1726, BtnHisMaqPar4;
     nBtnHisMaqPar4 = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Asig. Maq.", 1727, 1739, BtnAsgMaqPar4;
     nBtnAsgMaqPar4 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{207}} Salir", 3688, 3698, BtnSalir;
     nBtnSalir4 = FSalida;

     |HAZ PinCam4;
|FPRC;

|PROCESO DestruyePan4;
/*
     |DESTRUYECONTROL enGridd1;
     |DESTRUYECONTROL enGridd2;
     |DESTRUYECONTROL enGridd3;

     |FIN_CONTROL_WINDOWS nEvtFoco;
     |FIN_CONTROL_WINDOWS nBtnReabre4;
     |FIN_CONTROL_WINDOWS nBtnImpre4;
     |FIN_CONTROL_WINDOWS nBtnVerAlb4;
     |FIN_CONTROL_WINDOWS nBtnVerFac4;
     |FIN_CONTROL_WINDOWS nBtnHismaq4;
     |FIN_CONTROL_WINDOWS nBtnAsgMaq4;

     |FIN_CONTROL_WINDOWS nBtnImpPar4;
     |FIN_CONTROL_WINDOWS nBtnHisMaqPar4;
     |FIN_CONTROL_WINDOWS nBtnAsgMaqPar4;
     |FIN_CONTROL_WINDOWS nBtnImpAlb4;

     |FIN_CONTROL_WINDOWS nBtnSalir4;
*/

     |CIERRAT #referd3@;
     |CIERRAT #referd2@;
     |CIERRAT #referd1@;
     |DESCARGA_DEF #referd3@;
     |DESCARGA_DEF #referd2@;
     |DESCARGA_DEF #referd1@;
|FPRC;
