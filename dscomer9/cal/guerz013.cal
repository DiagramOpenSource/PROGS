|FICHEROS;
     guerz013 #0;
     goparame #1;
     goalbpa4 #4;
     goalbpa5 #5;
     goalbpa6 #6;   ||gopartida
     guerm017 #17; ||Parte
     guerm018 #18;
     guerm019 #19; ||Ele
     guerm020 #20; ||Ele
||     guerm028 #19; ||Tari
     guerm029 #29;   ||Tari
     goalbpa6@ #60;
|FIN;

|VARIABLES;
informe = "guerz013";
&swlin=0;
     aDef = "";
     a34 = "";
     a4 = "";
     a5 = "";
     a6 = "";
     a7 = "";
     aAlfa = "";
     nSuma = 0;
     nSwMaq = 0;
     nEncontra = 0;
     &cCodMonTrab = "";
     nTari = 0;
     nPreCos = 0;
     nPreVta = 0;
|FIN;

|PROCESO goalbpa6R;
     #60#13 = #60#10 * #60#11;
     #60#14 = #60#10 * #60#12;
     |GRABA 020#60a;
     |LIBERA #60;

     #4#5 = #4#5 + #60#13;
|FPRC;

|DEFBUCLE goalbpa6R;
     #60#4002;
     ;
     #4#0, #4#1;
     #4#0, #4#1;
     be;
     NULL, goalbpa6R;
|FIN;

|PROCESO ModiPre;
     |SI nSwMaq = 2; |Y #18#20 ! 0;
     |SINO;
          #6#11 = nPreVta;
          #6#12 = nPreCos;
          |GRABA 020#6a;

          |ABRE #5;
          #5#0 = #6#4;
          #5#1 = #6#5;
          #5#2 = #6#6;
          |LEE 111#5=;
          |SI FSalida = 0;
               #5#9 = nPreCos;
               #5#10 = #5#9 * #5#5;
               |GRABA 020#5a;
               |LIBERA #5;
          |SINO;
               swlin = 0;
               |PRINT;
               swlin = 1;
               |PRINT;
          |FINSI;
          |CIERRA #5;

          |ABRE #4;
          #4#0 = #5#0;
          #4#1 = #5#1;
          |LEE 111#4=;
          |SI FSalida = 0;
               #4#5 = 0;
               |BUCLE goalbpa6R;
               |GRABA 020#4a;
          |FINSI;
          |CIERRA #4;
     |FINSI;
|FPRC;

|PROCESO Tarifa;
     |ABRE #29; |SELECT #2#29;
     #29#1 = #18#17;
     #29#0 = #17#1;
     |LEE 000#29=;
     |SI FSalida ! 0;
          |LEE 000#29];
          |SI FSalida = 0;
               |LEE 000#29a;
          |SINO;
               |LEE 000#29u;
          |FINSI;
     |FINSI;
     |SI FSalida = 0; |Y #29#1 = #18#17;
          nPreVta = #29#3;
          nPreCos = #29#4;
          nTari = 1;
     |SINO;
          nTari = 0;
     |FINSI;
     |CIERRA #29;
|FPRC;

|PROCESO goalbpa6;
     nEncontra = 1;

     cCodMonTrab = #6#21;
     |HAZ MonBas;

     nSuma = 0;
     |SI nSwMaq = 2; |Y #18#20 ! 0;
          |SI #6#10 = #18#20; nSuma = nSuma + 1; |FINSI;
          |SI #6#11 = #18#21; nSuma = nSuma + 1; |FINSI;
          |SI #6#12 = #18#21; nSuma = nSuma + 1; |FINSI;
     |SINO;
          |SI #6#10 = #18#5;  nSuma = nSuma + 1; |FINSI;
          |SI #6#11 = #18#6;  nSuma = nSuma + 1; |FINSI;
          |SI #6#12 = #18#16; nSuma = nSuma + 1; |FINSI;
     |FINSI;

     |SI #6#20 = #18#17;       ||Toneladas
           nSuma = nSuma + 1;
     |FINSI;
     |SI #6#27 = "01.01.0000"; || F.Devo.
           nSuma = nSuma + 1;
     |FINSI;
     |SI #6#28 = #18#1;        || Fecha
           nSuma = nSuma + 1;
     |FINSI;
     |SI #6#29 = "M";          || Tipo Arti
           nSuma = nSuma + 1;
     |FINSI;
     |SI #6#34 = "A";
           nSuma = nSuma + 1;
     |FINSI;

     |SI #6#28 = #18#1;
           nSuma = nSuma + 1;
     |FINSI;

     |SI nSuma = 9; || CORRECTO
          |HAZ Tarifa;
          |SI nTari = 1;
               |HAZ ModiPre;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE goalbpa6;
     #6#3;
     20;
     #18#10, #18#11, #18#12, #18#13, #18#23, #18#14, #18#17;
     #18#10, #18#11, #18#12, #18#13, #18#23, #18#14, #18#17;
     be;
     NULL, goalbpa6;
|FIN;

|PROCESO guerm018;
     |SI #18#22 = "N";
          |ACABA;
     |FINSI;

     #20#0 = #18#0;
     #20#1 = #18#17;
     |LEE 000#20=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     #19#0 = #18#0;
     |LEE 000#19=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nEncontra = 0;
     nTari = 0;
     |SI #19#2 = "M";
          nSwMaq = 1;
          |SI #20#3 = #1#7;
               |BUCLE goalbpa6;
          |SINO;
               |ACABA;
          |FINSI;
     |SINO;
          nSwMaq = 2;
          |BUCLE goalbpa6;
     |FINSI;

     |SI nEncontra = 0;
          aAlfa = "0000No encontrado: "+&13+#18#0 +"-"+#18#1+"-"+#18#2+"-"+#18#3;
||          |MENAV aAlfa;
          swlin = 0;
          |SI #0#1 = "S";
              #18#22 = "N";
              |GRABA 101#18a;
          |FINSI;
          |PRINT;
     |FINSI;

     |HAZ Tarifa;
     |SI nTari = 1;
          #18#6 = nPreVta;
          #18#16 = nPreCos;
          |SI #19#2 = "T";
               |SI #guerm018#20 = 0;
                    #guerm018#7 = (#guerm018#5 * #guerm018#16);
               |SINO;
                    #guerm018#7 = (#guerm018#20 * #guerm018#21);
               |FINSI;
          |SINO;
               #guerm018#7 = (#guerm018#5 * #guerm018#16) + (#guerm018#20 * #guerm018#21);
          |FINSI;
          |GRABA 020#18a;
          |LIBERA #18;
     |FINSI;

     #guerm017#7 = #guerm017#7 +. #guerm018#7;
|FPRC;

|PROCESO guerm017;
     #guerm017#7 = 0;
|FPRC;

|PROCESO guerm017Fin;
     |GRABA 020#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE guerm017;
     #17#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, guerm017, guerm018, guerm017Fin;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "SI";
          |IMPRE 0;
          |SI FSalida ! 0;  |ACABA;  |FINSI;
          |INFOR informe;
          |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
          |ABRE #1; |LEE 000#1p; |CIERRA #1;

          |DDEF aDef;
          aDef = aDef + "goalbpa6";
          |CARGA_DEF aDef, goalbpa6@;
          |SI FSalida = 0;
               |ABRE #20;
               |ABRE #19;
               |ABRE #29;
               |BUCLE guerm017;
               |CIERRA #29;
               |CIERRA #19;
               |CIERRA #20;
               |DESCARGA_DEF #goalbpa6@;
          |FINSI;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRC
