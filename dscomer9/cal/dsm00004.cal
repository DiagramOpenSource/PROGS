|FICHEROS;
     agifa019 #119;
     agifa321 #321;
     agifa324 #324;

     dsm00004 #904;
     dsm00010 #910;
     dsm00014 #914;

     dsm00015 #15;
     dsm00016 #16;
     dsm00071 #71;
|FIN;

|VARIABLES;
     nModo = 0;
     &eArticulo     = "";
     &eAlmacen      = 0;
     &enModo        = 0;
     &nDeci_PreBase = 0;
     &nDeci_PreDiv  = 0;

      nNume     = 0;

      aAlfa     = "";
|FIN;

|PROCESO dsm00004;
     #914#0 = #904#2;
     |LEE 000#914=;
     |SI FSalida = 0; |Y #914#1 ! #904#3;
          #904#3 = #914#1;
          |GRABA 020#904a;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00004;
     #904#1;
     ;
     eArticulo, eAlmacen, "      ";
     eArticulo, eAlmacen, "zzzzzz";
     b;
     NULL, dsm00004;
|FIN;

|RUTINA ClaveBaja904;
     #904#0 = eArticulo;
     #904#1 = eAlmacen;
     #904#2 = "      ";
|FRUT;

|RUTINA ClaveAlta904;
     #904#0 = eArticulo;
     #904#1 = eAlmacen;
     #904#2 = "zzzzzz";
|FRUT;

|PROGRAMA;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |ABRE #324;

     |ABRE #321;
     |LEE 001#321p;
     #324#0 = #321#9;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;
     |CIERRA #321;

     nDeci_PreBase = #324#9;

     #324#0 = #119#165;
     |LEE 001#324=;
     |SI FSalida ! 0;  |DDEFECTO #324;  |FINSI;
     nDeci_PreDiv = #324#9;
     |CIERRA #324;

     nNume = #910#21;  aAlfa = "\" + #910#23 + "+#";
     |CAMPO_ANCHO  #904#2, 1, nNume;
     |CAMPO_MAXIMO #904#2, 1, aAlfa;


     |ABRE #914;
     |BUCLE dsm00004;      || Regraba las descripciones
     |CIERRA #914;


     |SI #910#49 = "S"; |Y enModo = 1;
          |HAZ AltaAuto;
     |SINO;
          |PINPA #0#904;
          |ATRI S;  |PINTA 0902, #910#20;  |ATRI s;
          |ENTCOLUMNA #1#904, 3, enModo, 3, 0, ClaveBaja904, ClaveAlta904;
     |FINSI;
|FPRO;

|PROCESO CheqTabla; |TIPO 6;
     nModo = (FEntrada / 100) ! 0;
     |SI #910#44 = "T"; |Y nModo = 1;
          |ABRE #119;
          #119#0 = #904#0;
          |LEE 000#119=;
          |CIERRA #119;

          aAlfa = #119#177;  |QBF aAlfa;
          aAlfa = aAlfa + ((" " * 20) % 120);

          |ABRE #16;
          #16#0 = aAlfa;
          #16#1 = "";
          #16#2 = "";
          #16#15 = "";
          #16#3 = #904#2;
          |LEE 000#16=;
          |SI FSalida ! 0;
               |MENAV "0000No existe elemento en la tabla";
               |ERROR;
          |FINSI;
          |CIERRA #16;
     |FINSI;
|FPRC;

|PROCESO dsm00014;
     |DDEFECTO #904;
     #904#0 = eArticulo;
     #904#1 = eAlmacen;
     #904#2 = #914#0;
     #904#3 = #914#1;
     |GRABA 040#904n;
|FPRC;

|DEFBUCLE dsm00014;
     #914#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00014;
|FIN;

|PROCESO AltaAuto;
     |ABRE #904;
     |BUCLE dsm00014;
     |CIERRA #904;

     |ABRE #119;
     #119#0 = eArticulo;
     |LEE 000#119=;
     |CIERRA #119;

     |ABRE #71;
     #71#0 = #119#0;
     #71#1 = #119#1;
     |GRABA 040#71n;
     |CIERRA #71;

     |DDEFECTO #15;
     |ABRE #15;
     #15#0 = #119#0;
     #15#3 = #119#165;
     #15#4 = #119#1;
     |GRABA 040#15n;
     |CIERRA #15;
|FPRC;
