|FICHEROS;
     iber0059 #0;
     iber0060 #5,MANTE;
     iber0061 #1,MANTE;
     iber0062 #2,MANTE;
     iber0018 #3;
     agifa049 #4;
     iber0025 #6;
     iber0016 #16;
     agifa065 #65;
     agifa048 #480;
     agifa017 #17;
     agifa019 #19;
     agifa090 #90;
     agifa074 #74;
     dsm00052 #52;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     &Tempo    = "";
     aTempo1   = "";
     aTempo2   = "";
     aTempo5   = "";
     aTempo6   = "";
     nSubLin   = 0;
     &enSwMenu = 0;
     swInf     = 0;
     swImp     = 0;
     aAc       = "";
     aAr       = "";
     aDe       = "";
     aPr       = "";
     nNe       = 0;
     nSal      = 0;
     swHay     = 0;
     swVic     = 0;
     nFin      = 0;
     aInforme  = "iber0059";
     nModo     = 0;
     &nCanti   = 0;
     &aEscanOri= "";
     nDias     = 0;
     aAlfa     = "";
 {-1}aMenu  = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "RIOC";
     aMenu5 = " Repasar ";
     aMenu6 = " Imprimir ";
     aMenu7 = " Orden ";
     aMenu8 = " Compra ";

     nSum   = 0;
     swIni  = 0;
     aCentro= "";
|FIN;

|INCLUYE i_escank;

|PROCESO Busca; |TIPO 66;
     |LEE 000#3p;
     |CONSULTA_CLAVE #3#3;
     |SI FSalida = 0;
          #5#0 = #3#1;
          |PINTA #5#0;
          |ERROR;
          |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO grabanec;
     |DDEFECTO #6;
     #6#0 = aAc;
     #6#1 = aAr;
     |LEE 101#6=;
     nSal = FSalida;
     #6#2 = aDe;
     #6#3 = aPr;
     #6#4 = #6#4 + nNe;
     |SI nSal = 0; |GRABA 020#6a; |FINSI;
     |SI nSal ! 0; |GRABA 020#6n; |FINSI;
     |LIBERA #6;
     swInf = 1;
|FPRC;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO LinKit;
     |DDEFECTO #19;
     #19#0 = aEscan;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     |DDEFECTO #17;
     #17#0 = aEscan;
     #17#1 = #4#9;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;

     #19#12 = #19#12 + nCantiEscan;
     #19#104 = #19#104 - nCantiEscan;

     #17#8 = #17#8 + nCantiEscan;
     #17#39 = #17#39 - nCantiEscan;

     |HAZ ValoraStock;
     |GRABA 020#17a;
     |GRABA 020#19a;
     |LIBERA #17;
     |LIBERA #19;

     nSubLin = nSubLin + 1;

     |DDEFECTO #52;
     #52#6 = #74#9;
     #52#0 = #74#0;
     #52#1 = #74#1;
     #52#2 = nSubLin;
     #52#3 = aEscan;
     #52#4 = nCantiEscan;
     #52#5 = #4#9;
     |GRABA 020#52n;
|FPRC;

|PROCESO iber00252;
     |SI swVic = 0;
          swVic = 1;
          |DDEFECTO #16;
          #16#0 = aCentro;
          |LEE 000#16=;
          enSwMenu = 1;
          #90#20 = #16#16;
          |HAZ ContaOF7;
          #90#1 = ~;
          |GRABA 101#90n;
          |LIBERA #90;
     |FINSI;
     #480#0 = #6#1;
     |LEE 000#480=;
     nSum = nSum + 1;
     #74#9 = #90#20;
     #74#0 = #90#0;
     #74#1 = nSum;
     #74#2 = #6#1;
     #74#3 = #480#1;
     #74#4 = #6#4;
     #74#7 = #480#10;
     |GRABA 020#74n;
     |LIBERA #74;
     |DDEFECTO #19;
     #19#0 = #74#2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     |DDEFECTO #17;
     #17#0 = #74#2;
     #17#1 = #74#7;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;

     #19#13 = #19#13 + #74#4;
     #17#9  = #17#9  + #74#4;
     |HAZ ValoraStock;
     |GRABA 020#17a;
     |GRABA 020#19a;
     |LIBERA #17;
     |LIBERA #19;

     |ABRE #52;
     aEscan = #74#2;
     nCantiEscan = #74#4;
     nSubLin = 0;
     nMaxNivel = 1;
     |HAZ DesglosaKit;
     |CIERRA #52;
|FPRC;

|DEFBUCLE iber00252;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, iber00252;
|FIN;

|PROCESO iber0025;
     swImp = 1;
     |PRINT;
|FPRC;

|DEFBUCLE iber0025;
     #6#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, iber0025;
|FIN;


|PROCESO FechaFin; |TIPO 0;
     nDias = #0#1 - #0#0;
     nDias = nDias + 1;
     #0#2 = nDias; |PINTA #0#2;
|FPRC;

|PROCESO Manual; |TIPO 0;
     aAlfa = "S";
     |SI #0#3 = "S"; aAlfa = "N"; |FINSI;
     |C_M #0#4, 1, aAlfa;
     |C_M #0#5, 1, aAlfa;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Porcien;
     #5#7 = #5#7 > #0#9;
     |GRABA 020#5a;
|FPRC;

|DEFBUCLE Porcien;
     #5#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Porcien;
|FIN;

|PROCESO Historico;
     |SI #65#2 ! "AV"; |Y #65#2 ! "FC"; |Y #65#2 ! "TI"; |ACABA; |FINSI;
     |SI #0#6 = "N"; |Y #65#2 = "TI"; |ACABA; |FINSI;
     |SI #0#7 = "N"; |Y #65#2 = "FC"; |ACABA; |FINSI;
     |SI #0#8 = "N"; |Y #65#2 = "AV"; |ACABA; |FINSI;

     #480#0 = #65#0;
     |LEE 000#480=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #65#0;
     |LEE 000#3=;
     |SI #3#7 ! "S";  |ACABA; |FINSI;

     |DDEFECTO #19;
     #19#0 = #65#0;
     |LEE 000#19=;

     |DDEFECTO #5;
     #5#0 = #65#0;
     |LEE 101#5=;
     |SI FSalida ! 0;
          |GRABA 020#5b;
     |FINSI;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #65#0;
     |LEE 000#3=;
     |SI #3#7 ! "S";
          #5#8 = #3#8;
          #5#9 = #3#9;
     |SINO;
          #5#8 = "F";
     |FINSI;
     #5#1 = #19#1;
     #5#2 = #19#16;
     #5#3 = #19#6;
     #5#4 = #5#2 + #5#3;
     #5#5 = #5#5 - #65#6;
     #5#6 = #5#5 - #5#4;
     #5#7 = #5#6;
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE Historico;
     #65#1;
     ;
     #0#4, #0#0, "  ", 000001, 00001, "     ";
     #0#5, #0#1, "zz", 999999, 99999, "zzzzz";
     ;
     NULL, Historico;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO agifa0493;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #4#2;
     |LEE 000#3=;
     |SI #3#7 ! "S"; |ACABA; |FINSI;
     swHay = 1;
     |DDEFECTO #1;
     #1#0 = #4#2;
     |LEE 101#1=;
     nSal = FSalida;
     |DDEFECTO #19;
     #19#0 = #4#2;
     |LEE 000#19=;
     #1#1 = #19#1;
     #1#2 = #19#16;
     #1#3 = #19#6;
     #1#4 = #1#2 + #1#3;
     #1#5 = #1#5 + (#4#4 * #5#7);
     #1#6 = #1#5 - #1#4;
     #1#7 = #1#6;
     |SI nSal = 0; |GRABA 020#1a; |FINSI;
     |SI nSal ! 0; |GRABA 020#1n; |FINSI;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agifa0493;
     #4#1;
     ;
     #5#0,  1;
     #5#0,999;
     ;
     NULL,agifa0493;
|FIN;

|PROCESO tercero;
     |SI #5#7 > 0;
          aAc = #5#8;
          aAr = #5#0;
          aDe = #5#1;
          aPr = #5#9;
          nNe = #5#7;
          |HAZ grabanec;
          |BUCLE agifa0493;
     |FINSI;
|FPRC;

|DEFBUCLE tercero;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, tercero;
|FIN;

|PROCESO agifa0492;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #4#2;
     |LEE 000#3=;
     |SI #3#7 ! "S"; |ACABA; |FINSI;
     swHay = 1;
     |DDEFECTO #1;
     #1#0 = #4#2;
     |LEE 101#1=;
     nSal = FSalida;
     |DDEFECTO #19;
     #19#0 = #4#2;
     |LEE 000#19=;
     #1#1 = #19#1;
     #1#2 = #19#16;
     #1#3 = #19#6;
     #1#4 = #1#2 + #1#3;
     #1#5 = #1#5 + (#4#4 * #2#7);
     #1#6 = #1#5 - #1#4;
     #1#7 = #1#6;
     |SI nSal = 0; |GRABA 020#1a; |FINSI;
     |SI nSal ! 0; |GRABA 020#1n; |FINSI;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agifa0492;
     #4#1;
     ;
     #2#0,  1;
     #2#0,999;
     ;
     NULL,agifa0492;
|FIN;

|PROCESO segundo;
     |SI #2#7 > 0;
          aAc = #2#8;
          aAr = #2#0;
          aDe = #2#1;
          aPr = #2#9;
          nNe = #2#7;
          |HAZ grabanec;
          |BUCLE agifa0492;
     |FINSI;
|FPRC;

|DEFBUCLE segundo;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, segundo;
|FIN;

|PROCESO agifa0491;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #4#2;
     |LEE 000#3=;
     |SI #3#7 ! "S"; |ACABA; |FINSI;
     swHay = 1;
     |DDEFECTO #2;
     #2#0 = #4#2;
     |LEE 101#2=;
     nSal = FSalida;
     |DDEFECTO #19;
     #19#0 = #4#2;
     |LEE 000#19=;
     #2#1 = #19#1;
     #2#2 = #19#16;
     #2#3 = #19#6;
     #2#4 = #2#2 + #2#3;
     #2#5 = #2#5 + (#4#4 * #1#7);
     #2#6 = #2#5 - #2#4;
     #2#7 = #2#6;
     |SI nSal = 0; |GRABA 020#2a; |FINSI;
     |SI nSal ! 0; |GRABA 020#2n; |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE agifa0491;
     #4#1;
     ;
     #1#0,  1;
     #1#0,999;
     ;
     NULL,agifa0491;
|FIN;

|PROCESO primero;
     |SI #1#7 > 0;
          aAc = #1#8;
          aAr = #1#0;
          aDe = #1#1;
          aPr = #1#9;
          nNe = #1#7;
          |HAZ grabanec;
          |BUCLE agifa0491;
     |FINSI;
|FPRC;

|DEFBUCLE primero;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, primero;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Tipo2; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENAV "0000Alta no permitida...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Descrip; |TIPO 0;
     nModo =  (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;
     |ABRE #3;
     |DDEFECTO #3;
     #3#0 = aCentro;
     #3#1 = #5#0;
     |LEE 000#3=;
     |SI #3#7 = "N"; |O FSalida ! 0;
          |ERROR;
          |ACABA;
          |CIERRA #3;
     |SINO;
          #5#8 = "F";
     |FINSI;
     |CIERRA #3;
     |ABRE #19;
     |DDEFECTO #19;
     #19#0 = #5#0;
     |LEE 000#19=;
     |CIERRA #19;
     #5#1 = #19#1;
     #5#2 = #19#16;
     #5#3 = #19#6;
     #5#4 = #5#2 + #5#3;
     #5#5 = 0;
     #5#6 = #5#5 - #5#4;
     |PINTA #5#1;
     |PINTA #5#2;
     |PINTA #5#3;
     |PINTA #5#4;
     |PINTA #5#5;
     |PINTA #5#6;
     |PINTA #5#7;
|FPRC;

|RUTINA Min1;
     #1#0 = " " * 20;
|FRUT;

|RUTINA Max1;
     #1#0 = "z" * 20;
|FRUT;

|RUTINA Min2;
     #2#0 = " " * 20;
|FRUT;

|RUTINA Max2;
     #2#0 = "z" * 20;
|FRUT;

|RUTINA Min3;
     #5#0 = " " * 20;
|FRUT;

|RUTINA Max3;
     #5#0 = "z" * 20;
|FRUT;

|PROCESO Tipo3; |TIPO 3;
     |DFICE aCentro;
     aCentro = aCentro % -403;

     |HAZ CreaTempo; aTempo1 = Tempo;
     |NOME_DAT #1 aTempo1; |DELINDEX #1;
     |HAZ CreaTempo; aTempo2 = Tempo;
     |NOME_DAT #2 aTempo2; |DELINDEX #2;
     |HAZ CreaTempo; aTempo5 = Tempo;
     |NOME_DAT #5 aTempo5; |DELINDEX #5;
     |HAZ CreaTempo; aTempo6 = Tempo;
     |NOME_DAT #6 aTempo6; |DELINDEX #6;

     |ABRE #19;
     |ABRE #6;
     |ABRE #3;
     |SI #0#3 = "N";
          |ABRE #5;
          |ABRE #480;
          |BUCLE Historico;
          |CIERRA #480;
          |CIERRA #5;
          |BUCLE Porcien;
     |FINSI;
     |CIERRA #19;
     |ENTLINEAL #1#5, -1, 1, 18, 1, Min3, Max3;
     |DELINDEX #1;
     |ABRE #19;
     |ABRE #1;
     swHay = 0;
     |BUCLE tercero;
     |CIERRA #1;
     |SI swHay ! 0;
          |PARA; |SI nFin = 0; |HACIENDO;
               |SI swVic = 0;
                    |ENTLINEAL #1#1, -1, 1, 18, 1, Min1, Max1;
                    swVic = 1;
                    |DELINDEX #2;
                    |ABRE #2;
                    swHay = 0;
                    |BUCLE primero;
                    |CIERRA #2;
                    |SI swHay = 0;
                         nFin = 1;
                    |FINSI;
               |SINO;
                    |ENTLINEAL #1#2, -1, 1, 18, 1, Min2, Max2;
                    swVic = 0;
                    |DELINDEX #1;
                    |ABRE #1;
                    swHay = 0;
                    |BUCLE segundo;
                    |CIERRA #1;
                    |SI swHay = 0;
                         nFin = 1;
                    |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;
     |CIERRA #3;
     |CIERRA #19;
     |CIERRA #6;

     |SI swInf = 1;
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme;
               |SI FSalida = 0;
                    |BUCLE iber0025;
                    |SI swImp = 1;
                         |PIEINF;
                    |FINSI;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;

          |CONFI "0000SGenerar Ordenes Fabricacion...";
          |SI FSalida = 0;
               |ABRE #480;
               |ABRE #16;
               |ABRE #19;
               |ABRE #17;
               |ABRE #74;
               |ABRE #90;
               swVic = 0;
               nSum = 0;
               |BUCLE iber00252;
               |CIERRA #16;
               |CIERRA #17;
               |CIERRA #19;
               |CIERRA #74;
               |CIERRA #90;
               |CIERRA #480;
          |FINSI;
     |FINSI;

     |DELINDEX #1;  Tempo = aTempo1; |HAZ BoraTempo;
     |DELINDEX #2;  Tempo = aTempo2; |HAZ BoraTempo;
     |DELINDEX #5;  Tempo = aTempo5; |HAZ BoraTempo;
     |DELINDEX #6;  Tempo = aTempo6; |HAZ BoraTempo;
|FPRC;

|PROCESO Llena059; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
