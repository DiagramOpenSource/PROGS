|FICHEROS;
   vigz0066  #0;
   vigw0038  #10;

   agifa024  #50;
   agifm001  #51;

   dscam003@ #100;
   dscam045@ #101;
|FIN;

|VARIABLES;
   &nSwLin = 0;
   &enSwContLin = 0;
   &enSwPie  = 0;
   nSwNumLin = 0;

   aAlfa = "";

   aDirBase = "";

   nEmpCartera = 0;
   nCalc       = 0;
   nCalc1      = 0;
   nCalc2      = 0;
   nCalc3      = 0;

   aAntRep = "XX";
   aAntZon = "XXXXX";
   aAntCli = "XXXXXX";

   nAjuste = 0;

   &eaFinDsLaser = "";

   &T74 = 0;
   &S75 = 0;
   &S76 = 0;
   &S77 = 0;
   &S78 = 0;
   &T79 = 0;
   &S80 = 0;
   &S81 = 0;
   &S82 = 0;
   &S83 = 0;
   &T84 = 0;
   &S85 = 0;
   &S86 = 0;
   &S87 = 0;
   &S88 = 0;
   &T89 = 0;
   &S90 = 0;
   &S91 = 0;
   &S92 = 0;
   &S93 = 0;
   &T94 = 0;
   &S95 = 0;
   &S96 = 0;
   &S97 = 0;
|FIN;

|PROCESO HazPrint;
   |PRINT; |ACABA;

   |SI nSwLin = 0;  nCalc = 1; nCalc2 = 1; |FINSI;
   |SI nSwLin = 1;  nCalc = 2; nCalc2 = 9; |FINSI;
   |SI nSwLin = 2;  nCalc = 2; nCalc2 = 7; |FINSI;
   |SI nSwLin = 3;  nCalc = 2; nCalc2 = 5; |FINSI;
   |SI nSwLin = 10; nCalc = 2; nCalc2 = 3; |FINSI;
   |SI nSwLin = 21; nCalc = 2; nCalc2 = 2; |FINSI;
   |SI nSwLin = 22; nCalc = 2; nCalc2 = 2; |FINSI;
   |SI nSwLin = 23; nCalc = 2; nCalc2 = 2; |FINSI;
   |SI nSwLin = 30; nCalc = 1; nCalc2 = 1; |FINSI;
   |SI nSwLin = 40; nCalc = 2; nCalc2 = 2; |FINSI;
   |SI nSwLin = 60; nCalc = 1; nCalc2 = 1; |FINSI;

   nCalc1 = enSwContLin + nCalc2;

   |SI nCalc1 > nSwNumLin;
      nCalc1 = nSwLin;
      |PARA; |SI enSwContLin < nSwNumLin; |HACIENDO;
         enSwContLin = enSwContLin + 1
         nSwLin = 30; |PRINT;
      |SIGUE;

      enSwContLin = 4;
      |SI nCalc1 ! 21; |Y nCalc1 ! 22; |Y nCalc1 ! 23;
         |SI nCalc1 ! 1;
            nSwLin = 1; |PRINT;
            enSwContLin = enSwContLin + 2;
         |FINSI;
         |SI nCalc1 ! 2;
            nSwLin = 2; |PRINT;
            enSwContLin = enSwContLin + 2;
         |FINSI;
         |SI nCalc1 ! 3;
            nSwLin = 3; |PRINT;
            enSwContLin = enSwContLin + 2;
         |FINSI;
         nSwLin = 10; |PRINT;
         enSwContLin = enSwContLin + 2;
      |FINSI;
      nSwLin = nCalc1;
   |FINSI;

   enSwContLin = enSwContLin + nCalc;
   |PRINT;
|FPRC;

|PROCESO dscam003;
   |SI #dscam003@#14 = "L"; |O #dscam003@#14 = "A"; |O #dscam003@#14 = "D";
       #dscam003@#14 = "R"; |O #dscam003@#14 = "T";
      |ACABA;
   |FINSI;

   #agifa024#0 = #dscam003@#32;
   |LEE 000#agifa024.=;
   |SI FSalida ! 0; |DDEFECTO #agifa024; |FINSI;

   #agifm001#0 = #dscam003@#39;
   |LEE 000#agifm001.=;
   |SI FSalida ! 0; |DDEFECTO #agifm001; |FINSI;

   |DDEFECTO #vigw0038;
   #vigw0038#0 = #dscam003@#33;
   #vigw0038#1 = #dscam003@#39;
   #vigw0038#2 = #dscam003@#35;
   #vigw0038#3 = #dscam003@#32;
   #vigw0038#4 = #dscam003@#4;
   #vigw0038#5 = #dscam003@#0;
   #vigw0038#6 = #dscam003@#1;
   #vigw0038#7 = #dscam003@#12;
   #vigw0038#8 = #dscam003@#3;
   #vigw0038#9 = #dscam003@#14;
   #vigw0038#10 = #agifa024#9;
   #vigw0038#11 = #dscam003@#22;
   #vigw0038#12 = #dscam003@#23;
   #vigw0038#13 = #dscam003@#25;
   #vigw0038#14 = #dscam003@#31;
   #vigw0038#15 = #dscam003@#87;
   #vigw0038#16 = #dscam003@#88;
   #vigw0038#17 = #dscam003@#40;
   #vigw0038#18 = #dscam003@#49;
   #vigw0038#19 = #dscam003@#34;
   #vigw0038#20 = #agifm001#1;
   #vigw0038#21 = #dscam003@#6;
   #vigw0038#22 = #dscam003@#36;
   |GRABA 020#vigw0038.n;
|FPRC;

|DEFBUCLE dscam003;
#dscam003@#1001;
33, 0, 12, 3, 32, 39;
000000001, #0#0,#0#1,#0#2,#0#3,#0#4, #0#5;
999999999, #0#6,#0#7,#0#8,#0#9,#0#10,#0#11;
;
NULL, dscam003;
|FIN;

|PROCESO Imprime;
   |SI aAntRep ! #vigw0038#0;
      |SI aAntRep ! "XX";
         nSwLin = 30; |HAZ HazPrint;
         nSwLin = 23; |HAZ HazPrint;
         nSwLin = 22; |HAZ HazPrint;
         nSwLin = 21; |HAZ HazPrint;
         |PIEINF;
      |FINSI;
      nSwLin = 1;  |HAZ HazPrint;
      nSwLin = 2;  |HAZ HazPrint;
      nSwLin = 3;  |HAZ HazPrint;
      nSwLin = 10; |HAZ HazPrint;
      aAntCli = #vigw0038#3;
      aAntZon = #vigw0038#1;
      aAntRep = #vigw0038#0;
   |FINSI;

   |SI aAntZon ! #vigw0038#1;
      |SI aAntZon ! "XXXXX";
         nSwLin = 30; |HAZ HazPrint;
         nSwLin = 23; |HAZ HazPrint;
         nSwLin = 22; |HAZ HazPrint;
      |FINSI;
      nSwLin = 2;  |HAZ HazPrint;
      nSwLin = 3;  |HAZ HazPrint;
      nSwLin = 10; |HAZ HazPrint;
      aAntCli = #vigw0038#3;
      aAntZon = #vigw0038#1;
   |FINSI;

   |SI aAntCli ! #vigw0038#3;
      |SI aAntCli ! "XXXXXX";
         nSwLin = 30; |HAZ HazPrint;
         nSwLin = 23; |HAZ HazPrint;
      |FINSI;
      nSwLin = 3;  |HAZ HazPrint;
      nSwLin = 10; |HAZ HazPrint;
      aAntCli = #vigw0038#3;
   |FINSI;

   nSwLin = 0;  |HAZ HazPrint;
|FPRC;

|DEFBUCLE Imprime;
#vigw0038#1;
;
INICIO;
FINAL;
;
NULL, Imprime;
|FIN;

|PROCESO ImprimeCrystal;
   |PRINT;
|FPRC;

|DEFBUCLE ImprimeCrystal;
#vigw0038#1;
;
INICIO;
FINAL;
;
NULL, ImprimeCrystal;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA "Informe recibos de venta por representante";

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |DBASS aDirBase; |QBF aDirBase;
      aAlfa = aDirBase + "dscarter/def/dscam045.mas";
      |CARGA_DEF aAlfa, dscam045@;
      |SI FSalida = 0;
         aAlfa = aDirBase + "dscarter/fich/";
         |PATH_DAT #dscam045@#aAlfa#;
         |ABRE #dscam045@;

         nEmpCartera = 0;
         #dscam045@#0 = #48#0;
         #dscam045@#1 = 1;
         |LEE 000#dscam045@.];
         |PARA; |SI FSalida = 0; |HACIENDO;
            |SI #dscam045@#2 = "V";
               nEmpCartera = #dscam045@#6; |SAL;
            |FINSI;
            |LEE 000#dscam045@.s;
         |SIGUE;

         |SI nEmpCartera ! 0;
            aAlfa = aDirBase + "dscarter/def/dscam003.mas";
            |CARGA_DEF aAlfa, dscam003@;
            |SI FSalida = 0;
               aAlfa = "tmp" + Usuario;
               |NOME_DAT #vigw0038#aAlfa#;
               |DELINDEX #vigw0038; |ABRE #vigw0038;
               |ABRE #agifa024; |ABRE #agifm001;

               aAlfa = aDirBase + "dscarter/fich/" + (("00000" + nEmpCartera) % -105) + "/";
               |PATH_DAT #dscam003@#aAlfa#;
               |ABRE #dscam003@;
               |BUCLE dscam003;
               |CIERRA #dscam003@; |DESCARGA_DEF #dscam003@;

               ||Impresora = "Crystal Reports";
               |IMPRE 0;
               |SI FSalida = 0;
                  |SI Impresora = "CrystalReport";
                     |INFOR "vigzc066";
                     |BUCLE ImprimeCrystal;
                     |PIEINF; |FININF;
                  |SINO;
                     |CIMPR 11; nSwNumLin = FSalida;
                     |INFOR "vigz0066";
                     |SI FSalida = 0;
                        enSwContLin = 4;
                        enSwPie = 0;
                        |BUCLE Imprime;
                        nSwLin = 30; |HAZ HazPrint;
                        nSwLin = 23; |HAZ HazPrint
                        nSwLin = 22; |HAZ HazPrint;
                        nSwLin = 21; |HAZ HazPrint;
                        |PIEINF;

                        enSwPie = 1;
                        nSwLin  = -1;
                        |PIEINF; |FININF;
                     |FINSI;
                  |FINSI;
                  |FINIMP;
               |FINSI;

               |CIERRA #agifa024;  |CIERRA #agifm001;
               |CIERRA #vigw0038;  |DELINDEX #vigw0038;
            |FINSI;
         |FINSI;
         |CIERRA #dscam045@; |DESCARGA_DEF #dscam045@;
      |FINSI;
   |FINSI;
|FPRO;
