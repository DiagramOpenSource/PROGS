|FICHEROS;
     dsz00055 #0;
     dsz00056 #1,MANTE;
     agifa023 #23; ||Cli/Art
     agifa039 #39; ||Cli/Fam
     agifa310 #310;||Cli/Fam/Sub
     agifa019 #19;
     agifa024 #24;
     agifa060 #60;
     agifa120 #120;
     agifa321;
     agifa324;
|FIN;

|VARIABLES;
     &enAlta = 0;
     &eaArticulo = "";
     &nDeci_PreVis  = 0;
     &precio_divisa  = 0;
     &precio_base    = 0;
     &decim_base     = 0;
     aAlfa = "";
     aAlf0 = "";
     aAlf1 = "";
     aAlf2 = "";
     nModo = 0;
     nForma = 0;
     aCampo0 = "";
     aCampo1 = "";
     aCampo2 = "";
     aCampo3 = "";
     nClave = 0;
 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = " ";
     aMenu4 = "RCS";
     aMenu5 = " Repasar ";
     aMenu6 = "  Copiar Cliente  ";
     aMenu7 = " Salir ";
     nPos1 = 0;
     nPos2 = 0;
     nSw = 0;
     aOrg = "";
     aDes = "";
|FIN;

|PROCESO dsz00055;
     |HAZ Tipo2;
|FPRC;

|DEFBUCLE dsz00055;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsz00055;
|FIN;

|PROCESO Borra310;
     |BORRA 020#310a;
|FPRC;

|PROCESO Borra39;
     |BORRA 020#39a;
|FPRC;

|PROCESO Borra23;
     |BORRA 020#23a;
|FPRC;

|DEFBUCLE Borra310;
     #310#1;
     ;
     aDes, "   ", "     ";
     aDes, "zzz", "zzzzz";
     be;
     NULL, Borra310;
|FIN;

|DEFBUCLE Borra39;
     #39#1;
     ;
     aDes, "   ";
     aDes, "zzz";
     be;
     NULL, Borra39;
|FIN;

|DEFBUCLE Borra23;
     #23#1;
     ;
     aDes, "                    ";
     aDes, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, Borra23;
|FIN;

|PROCESO CopiaCli;
     |BUCLE Borra23;
     |BUCLE Borra39;
     |BUCLE Borra310;
     |BUCLE dsz00055;
|FPRC;

|PROCESO LeeMon;
     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |CIERRA #24;

     |HAZ LeeMonBase;
     |ABRE #agifa324;
     #agifa324#0 = #24#192;
     |LEE 001#agifa324.=;          || Leo la divisa
     |CIERRA #agifa324;
     precio_divisa = #agifa324#9;  || Decimales en el precio de la divisa

     |SI #24#193 = "B";           || Si trabajo con la moneda base ...
          nDeci_PreVis   = precio_divisa;
     |SINO;                        || Si trabajo con la divisa ...
          nDeci_PreVis   = precio_base;
     |FINSI;
|FPRC;

|PROCESO LeeMonBase; ||Lee los parametros de la moneda base
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 010#agifa321.p;         ||Leo parametros de divisa
     #agifa324#0 = #agifa321#9;
     |LEE 010#agifa324.=;         ||Leo la ficha de la moneda base en Divisas
     decim_base = #agifa324#7;    ||Asigno los decimales de la moneda base
     precio_base = #agifa324#9;   ||Asigno los decimales del precio en la mon. base
     |CIERRA #agifa324;
     |CIERRA #agifa321;
|FPRC;

|PROCESO Mensa; |TIPO 7;
     |SI nClave ! 0;
          |MENSA "0000<F5> Cambia clave (modificacion)";
     |SINO;
          |BLIN 3;
     |FINSI;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 13;
          nClave = (nClave + 1) $ 2;
          aCampo0 = #1#0;
          aCampo1 = #1#1;
          aCampo2 = #1#2;
          aCampo3 = #1#3;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     |ABRE #19;
     #19#0 = #1#2;
     |LEE 000#19=;
     |CIERRA #19;

     |ABRE #60;
     #60#0 = #1#0;
     |LEE 000#60=;
     |CIERRA #60;

     |ABRE #120;
     #120#0 = #1#1;
     |LEE 000#120=;
     |CIERRA #120;

     |PINTA 2024, #19#1;
     |PINTA 2124, #60#1;
     |PINTA 2224, #120#1;
|FPRC;

|PROCESO PinDef; |TIPO 7;
     |HAZ Tipo13;
|FPRC;

|PROCESO Pinta; |TIPO 0;
     |HAZ Tipo13;
     |SI Campo = 2;
          |HAZ Articulo;
     |FINSI;
|FPRC;

|PROCESO Articulo;
     aAlfa = #1#2;
     |QBF aAlfa;
     |SI aAlfa ! "";
          |ABRE #19;
          #19#0 = #1#2;
          |LEE 020#19=;
          |CIERRA #19;

          #1#0 = #19#2; |PINTA #1#0;
          #1#1 = #19#3; |PINTA #1#1;
          #1#7 = #19#1; |PINTA #1#7;

          |C_M #1#8, 1, "S";
          |C_M #1#8, 1, "S";

     |SINO;
          |C_M #1#8, 1, "N";
          |C_M #19, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nForma = 0 +. 1;
     nModo = (FEntrada / 100) ! 0;

     |ABRE #19;
     #19#0 = #1#2;
     |LEE 000#19=;
     |CIERRA #19;

     aAlf0 = #1#0; |QBF aAlf0;
     aAlf1 = #1#1; |QBF aAlf1;
     aAlf2 = #1#2; |QBF aAlf2;

     |SI aAlf2 ! "";
          #1#3 = 23;
     |SINO;
          |SI aAlf1 = "";
               #1#3 = 39;
          |SINO;
               #1#3 = 310;
          |FINSI;
     |FINSI;

     |SI #1#3 = 23;
          |DDEFECTO #23;
          |ABRE #23;
          #23#0 = #0#0;
          #23#1 = #1#2;
          |SI nModo = 1; |O nModo = 2;
               |SI nForma = 1;
                    |LEE 101#23=;
                    |SI FSalida ! 0; |GRABA 020#23b; |FINSI;
                    #23#32 = #1#4; ||Dto
                    #23#28 = #1#5; ||FI
                    #23#29 = #1#6; ||FF
                    #23#35 = #19#1; ||Des
                    #23#2 =  #1#7; ||Pre
                    #23#34 = #1#8; ||Comi
                    #23#33 = #1#9;||Refe
                    |GRABA 020#23a;
               |FINSI;
          |SINO;
               |BORRA 000#23c;
          |FINSI;
          |CIERRA #23;
     |FINSI;
     |SI #1#3 = 39;
          |DDEFECTO #39;
          |ABRE #39;
          #39#0 = #0#0;
          #39#1 = #1#0;
          |SI nModo = 1; |O nModo = 2;
               |SI nForma = 1;
                    |LEE 101#39=;
                    |SI FSalida ! 0; |GRABA 020#39b; |FINSI;
                    #39#2 = #1#4; ||Dto
                    #39#3 = #1#5; ||Fi
                    #39#4 = #1#6; ||Ff
                    |GRABA 020#39a;
               |FINSI;
          |SINO;
               |BORRA 000#39c;
          |FINSI;
          |CIERRA #39;
     |FINSI;
     |SI #1#3 = 310;
          |DDEFECTO #310;
          |ABRE #310;
          #310#0 = #0#0;
          #310#1 = #1#0;
          #310#2 = #1#1
          |SI nModo = 1; |O nModo = 2;
               |SI nForma = 1;
                    |LEE 101#310=;
                    |SI FSalida ! 0; |GRABA 020#310b; |FINSI;
                    #310#3 = #1#4; ||Dto
                    #310#4 = #1#5; ||Fi
                    #310#5 = #1#6; ||Ff
                    |GRABA 020#310a;
               |FINSI;
          |SINO;
               |BORRA 000#310c;
          |FINSI;
          |CIERRA #310;
     |FINSI;
|FPRC;

|PROCESO agifa023;
     |DDEFECTO #19;
     #19#0 = #23#1;
     |LEE 000#19=;

     |DDEFECTO #1;
     #1#0 = #19#2;   ||Fam
     #1#1 = #19#3;   ||Sub
     #1#2 = #23#1;   ||Art
     #1#3 = 23;
     #1#4 = #23#32;  ||Dto
     #1#5 = #23#28;  ||D.Fecha
     #1#6 = #23#29;  ||H.Fecha
     #1#7 = #23#2;  ||Pre
     #1#8 = #23#34; ||Comi
     #1#9 = #23#33;||Refe
     |GRABA 020#1n;
|FPRC;

|PROCESO agifa039;
     |DDEFECTO #1;
     #1#0 = #39#1; ||Fam
     #1#1 = "";    ||Sub
     #1#2 = "";    ||Art
     #1#3 = 39;
     #1#4 = #39#2; ||Dto
     #1#5 = #39#3; ||D.Fecha
     #1#6 = #39#4; ||H.Fecha
     |GRABA 020#1n;
|FPRC;

|PROCESO agifa310;
     |DDEFECTO #1;
     #1#0 = #310#1; ||Fam
     #1#1 = #310#2; ||Sub
     #1#2 = "";     ||Art
     #1#3 = 310;
     #1#4 = #310#3; ||Dto
     #1#5 = #310#4; ||D.Fecha
     #1#6 = #310#5; ||H.Fecha
     |GRABA 020#1n;
|FPRC;

|DEFBUCLE agifa023;
     #23#1;
     ;
     #0#0, "                    ";
     #0#0, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, agifa023;
|FIN;

|DEFBUCLE agifa039;
     #39#1;
     ;
     #0#0, "   ";
     #0#0, "zzz";
     ;
     NULL, agifa039;
|FIN;

|DEFBUCLE agifa310;
     #310#1;
     ;
     #0#0, "   ", "     ";
     #0#0, "zzz", "zzzzz";
     ;
     NULL, agifa310;
|FIN;

|PROCESO Tipo12; |TIPO 12;
     |SI nSw = 1;
          aDes = #0#0;
          |SI aDes ! aOrg;
               |HAZ CopiaCli;
          |FINSI;
     |FINSI;
     |DELINDEX #1;
     |ABRE #1;
     |BUCLE agifa039; ||Cli/Fam
     |BUCLE agifa310; ||Cli/Fam/Sub
     |ABRE #19;
     |BUCLE agifa023; ||Cli/Art
     |CIERRA #19;

     |CIERRA #1;
|FPRC;

|PROCESO Min;
     #1#0 = " " * 3;
     #1#1 = " " * 5;
     #1#2 = " " * 20;
     #1#3 = 0;
     |SI FSalida = "POSICION";
          #1#0 = aCampo0;
          #1#1 = aCampo1;
          #1#2 = aCampo2;
          #1#3 = aCampo3;
     |FINSI;
|FPRC;

|PROCESO Max;
     #1#0 = "z" * 3;
     #1#1 = "z" * 5;
     #1#2 = "z" * 20;
     #1#3 = 999;
|FPRC;

|PROGRAMA;
     aAlfa = Usuario;
     |NOME_DAT #1 aAlfa;

     |CLS;
     |ENTLINEAL #1#1, 1, 7, 16, 1, Min, Max;
     |HAZ Tipo13;
 |ET Otro;
     nSw = 0;
     |ENDATOS #1#0;
     aOrg = #0#0;
     |PARA nClave = 0; |SI; |HACIENDO;
          |PARA aCampo0 = "."; |SI aCampo0 ! ""; |HACIENDO;
               aCampo0 = "";
               |SI nClave = 0;
                    |ENTLINEAL #1#1, 1, 2, 16, 0, Min, Max;
               |SINO;
                    |ENTLINEAL #2#1, 1, 4, 16, 0, Min, Max;
               |FINSI;
          |SIGUE;
          |MENU aMenu;
          aMenu2 = FSalida;
          |SI aMenu2 ! 1; |SAL; |FINSI;
     |SIGUE;
     |SI aMenu2 = 2;
          |PUSHV 0501 2380;
          |BLANCO 1117 1557;
          |CUADRO 1117 1557;
          |ATRI I; |PINTA 1318, " Cliente Destino :"; |ATRI 0;
          |C_P #0#0, 0, nPos1;
          |C_P #0#0, 1, 1340;
          nSw = 1;
          |ENDATOS #1#0;
          |C_P #0#0, 1, nPos1;
          |POPV;
          |PTEC 807;    || Lo saco al menu
          |PTEC 802;    || Lo meto en el lineal
          |VETE Otro;
     |FINSI;

     |DELINDEX #1;
|FPRO;

|PROCESO Llena056; |TIPO 6;
     eaArticulo = #1Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #1Campo = eaArticulo;
          |PINTA #1Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
