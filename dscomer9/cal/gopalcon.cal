|FICHEROS;
     gopalcon #0;
     gopalets #1;
     agifa321 #2;
     gomantho #3;
     goparame #100;
|FIN;
----------------------------------------------------------------------
|VARIABLES;
     &cCodMonDe     = "";
     &cCodMonA      = "";
     &nPrecioComp   = 0;
     &nPrecioVent   = 0;
     cUsuario       = "";
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";
     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;
     nModo          = 0;
     cAlfa          = "";
|FIN;
----------------------------------------------------------------------
----------------------------------------------------------------------
|PROCESO PintTota; |TIPO 7;
     cCodMonTrab = cCodMonBase;
     |HAZ MonBas;
     |PINTA 1813, #1#13;
     |PINTA 1820, #1#14;
     |PINTA 1827, #1#15;
     |PINTA 1848, #1#16;
     |PINTA 1860, #1#17;
     |ATRI P;
     |PINTA 1877, cCodMonBase;
     |ATRI 0;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Totales;
     |SI #0#15 = "C";
          #1#13 = #1#13 + #0#16;                  ||Cantidad Cargos;
     |FINSI;
     |SI #0#15 = "A";
          #1#14 = #1#14 - #0#16;                  ||Cantidad Abonos;
     |FINSI;
     |SI #0#15 = "D";
          #1#15 = #1#15 + #0#16;                  ||Cantidad Devoluciones;
     |FINSI;

     |DDEFECTO #3;
     #3#0 = #0#1;
     #3#1 = #0#2;
     |LEE 000#3=;
     cCodMonDe = #3#6;                    ||Moneda Expediente
     cCodMonA  = cCodMonBase;             ||Moneda Base
     nPrecioVent = #0#21;                 ||Ultimo Precio Venta
     |HAZ DemonAmon;

     #1#16 = #1#16 + nPrecioVent;         ||Total Venta Trabajo.

     cCodMonDe = #3#6;                    ||Moneda Expediente
     cCodMonA  = cCodMonBase;             ||Moneda Base
     nPrecioComp = #0#23;                 ||Ultimo Precio Compra
     |HAZ DemonAmon;

     #1#17 = #1#17 + nPrecioComp;         ||Total Coste Trabajo.
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE Totales;
     #0#1;
     ;                                          ||Campos Extras.
     1;
     9999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, Totales;
|FIN;
-------------------------------------------------------------------------------
|PROGRAMA;
     |CLS;
     |ABRE #2;
     #2#0 = "A";
     |LEE 000#2=;
     |SI FSalida = 0;
          cCodMonTrab = #2#9;
          |HAZ MonBas;
     |FINSI;
     |CIERRA #2;
     cUsuario = Usuario % 810;
     |ABRE #1;
     #1#18 = cUsuario;
     |LEE 101#1=;
     |SI FSalida ! 0;
          |GRABA 020#1c;
     |FINSI;
     |DDEFECTO #1;
     |ABRE #3;
     |BUCLE Totales;
     |PINPA #0#0;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |ATRI R; |PINTA 511, " O.T.       "; |ATRI 0;
          |PINTA 2051, "       O.E.:"; |ATRI 0;
     |FINSI;
     |ENTLINEAL #1#0,1,2,15,0,cMinPale,cMaxPale;
     |LIBERA #1;
     |CIERRA #1;
     |CIERRA #3;
|FPROG;
-------------------------------------------------------------------------------
|PROCESO cMinPale;
     #0#0 = 1;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO cMaxPale;
     #0#0 = 9999;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BajaPal; |TIPO 2;
     nModo = (FEntrada/100)!0;
     |SI nModo = 3; |Y #0#15 ! "D";
          |MENAV "0000BAJA NO PERMITIDA EN ESTE PROCESO";
          |ERROR;
     |FINSI;
     |SI nModo = 2; |Y #0#15 ! "D";
          |MENAV "0000MODIFICACION NO PERMITIDA EN ESTE PROCESO";
          |ERROR;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO NMSer; |TIPO 6;
     nModo = (FEntrada/100)!0;
     |SI Contenido ! #0#1; |Y nModo = 2;
          |MENAV "0000IMPOSIBLE CAMBIAR LA SERIE. NO MODIFICABLE"
          |ERROR10;
          #0#1 = Contenido;
          |ACABA;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO NMNum; |TIPO 6;
     nModo = (FEntrada/100)!0;
     |SI Contenido ! #0#2; |Y nModo = 2;
          |MENAV "0000IMPOSIBLE CAMBIAR EL NUMERO. NO MODIFICABLE"
          |ERROR10;
          #0#2 = Contenido;
          |PINTA #0#2;
          |ACABA;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO NMProv; |TIPO 6;
     nModo = (FEntrada/100)!0;
     |SI Contenido ! #0#7; |Y nModo = 2;
          |MENAV "0000IMPOSIBLE CAMBIAR EL PROVEEDOR. NO MODIFICABLE"
          |ERROR10;
          #0#7 = Contenido;
          |PINTA #0#7;
          |ACABA;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO NMArti; |TIPO 6;
     nModo = (FEntrada/100)!0;
     |SI Contenido ! #0#13; |Y nModo = 2;
          |MENAV "0000IMPOSIBLE CAMBIAR REFERENCIA. NO MODIFICABLE";
          |ERROR10;
          #0#13 = Contenido;
          |PINTA #0#13;
          |ACABA;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Unidades; |TIPO 0;
     |SI #0#16 [ 0;
          |MENAV "0000CANTIDAD NO PERMITIDA";
          |ERROR10;
          |ACABA;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO sacamonexp; |TIPO 14;
     #3#0 = #0#1;
     #3#1 = #0#2;
     |LEE 000#3=;
     |ATRI P;
     |PINTA 1777, #3#6;
     |ATRI 0;
     cCodMonTrab = #3#6;
     |HAZ MonBas;
|FPRC;
