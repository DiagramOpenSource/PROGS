|FICHEROS;
     dsz00010 #0;

     agifa104 #104;  || Pedidos Ventas Cabeceras
     agifa036 #36;   || Depositos Cabeceras
     agifa010 #10;   || Albaranes Ventas Cabeceras
     agifa084 #84;   || Facturas Contado  Cabeceras
     agifa146 #146;  || Facturas Preformas Cabeceras
     agifa081 #81;   || Pedidos Compras Cabeceras
     agifa077 #77;   || Albaranes Compras Cabeceras

     dsm00005 #905;

     vertical@ #100;
|FIN;

|VARIABLES;
     nCampo  = 0;
     nConta  = 0;

     aDefDes = "";
     aBase   = "";
     aAlfa   = "";

     aTipo   = "";
     aDSerie = "";
     aHSerie = "";
     nDDocu  = 0;
     nHDocu  = 0;
     fDFecha = @;
     fHFecha = @;
|FIN;

|PROCESO NoModifica;
     nConta = 0;
     aAlfa  = #0Campo;
     |PARA nCampo = Campo + 1;  |SI nConta [ 5;  |HACIENDO nCampo = nCampo + 1;
           nConta = nConta + 1;
           |C_M #0nCampo, 1, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO PasaDatos;
     aDefDes = "";

     |SI #905#0 = "PV";
         #104#25 = #905#1;
         #104#0  = #905#2;
         |LEE 040#104=;
         |SI FSalida ! 0;  |DDEFECTO #104;  |FINSI;

         |SI #104#1 ] fDFecha;  |Y #104#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00100";
         |FINSI;
     |FINSI;

     |SI #905#0 = "DP";
         #36#46 = #905#1;
         #36#0  = #905#2;
         |LEE 040#36=;
         |SI FSalida ! 0;  |DDEFECTO #36;  |FINSI;

         |SI #36#1 ] fDFecha;  |Y #36#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00101";
         |FINSI;
     |FINSI;

     |SI #905#0 = "AV";
         #10#52 = #905#1;
         #10#0  = #905#2;
         |LEE 040#10=;
         |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;

         |SI #10#1 ] fDFecha;  |Y #10#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00102";
         |FINSI;
     |FINSI;

     |SI #905#0 = "FC";
         #84#48 = #905#1;
         #84#0  = #905#2;
         |LEE 040#84=;
         |SI FSalida ! 0;  |DDEFECTO #84;  |FINSI;

         |SI #84#1 ] fDFecha;  |Y #84#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00103";
         |FINSI;
     |FINSI;

     |SI #905#0 = "FP";
         #146#48 = #905#1;
         #146#0  = #905#2;
         |LEE 040#146=;
         |SI FSalida ! 0;  |DDEFECTO #146;  |FINSI;

         |SI #146#1 ] fDFecha;  |Y #146#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00104";
         |FINSI;
     |FINSI;

     |SI #905#0 = "PC";
         #81#25 = #905#1;
         #81#0  = #905#2;
         |LEE 040#81=;
         |SI FSalida ! 0;  |DDEFECTO #81;  |FINSI;

         |SI #81#1 ] fDFecha;  |Y #81#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00105";
         |FINSI;
     |FINSI;

     |SI #905#0 = "AC";
         #77#50 = #905#1;
         #77#0  = #905#2;
         |LEE 040#77=;
         |SI FSalida ! 0;  |DDEFECTO #77;  |FINSI;

         |SI #77#1 ] fDFecha;  |Y #77#1 [ fHFecha;
             aDefDes = aBase + "def/" + "dsm00106";
         |FINSI;
     |FINSI;

     |SI aDefDes = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDefDes, vertical@;

     |ABRE #100;
     #100#0  = #905#0;
     #100#1  = #905#1;
     #100#2  = #905#2;
     #100#3  = #905#3;
     #100#4  = #905#4;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         #100#0  = #905#0;
         #100#1  = #905#1;
         #100#2  = #905#2;
         #100#3  = #905#3;
         #100#4  = #905#4;
         |GRABA 020#100b;
     |FINSI;

     |PARA nCampo = 5;  |SI nCampo [ 12;  |HACIENDO nCampo = nCampo + 1;
           #100nCampo = #905nCampo;
     |SIGUE;
     |GRABA 020#100a;
     |LIBERA #100;
     |CIERRA #100;

     |DESCARGA_DEF #vertical@;
|FPRC;

|DEFBUCLE dsm00005;
     #905#1005;
     ;
     aTipo, aDSerie, nDDocu, 000, "      ";
     aTipo, aHSerie, nHDocu, 999, "zzzzzz";
     ;
     NULL, PasaDatos;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aBase;  |QBF aBase;

     |SI #0#49 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 7;
               |SI #0nCampo = "S";
                   |SI nCampo = 0;   aDefDes = aBase + "def/" + "dsm00100";  |FINSI;
                   |SI nCampo = 7;   aDefDes = aBase + "def/" + "dsm00101";  |FINSI;
                   |SI nCampo = 14;  aDefDes = aBase + "def/" + "dsm00102";  |FINSI;
                   |SI nCampo = 21;  aDefDes = aBase + "def/" + "dsm00103";  |FINSI;
                   |SI nCampo = 28;  aDefDes = aBase + "def/" + "dsm00104";  |FINSI;
                   |SI nCampo = 35;  aDefDes = aBase + "def/" + "dsm00105";  |FINSI;
                   |SI nCampo = 42;  aDefDes = aBase + "def/" + "dsm00106";  |FINSI;

                   |CARGA_DEF aDefDes, vertical@;
                   |ABRE #100;  |CIERRA #100;  |DELINDEX #100;
                   |DESCARGA_DEF #vertical@;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #0#0  = "S";
         aTipo   = "PV";
         aDSerie = #0#1;
         aHSerie = #0#2;
         nDDocu  = #0#3;
         nHDocu  = #0#4;
         fDFecha = #0#5;
         fHFecha = #0#6;

         |ABRE #104;
         |BUCLE dsm00005;
         |CIERRA #104;
     |FINSI;

     |SI #0#7  = "S";
         aTipo   = "DP";
         aDSerie = #0#8;
         aHSerie = #0#9;
         nDDocu  = #0#10;
         nHDocu  = #0#11;
         fDFecha = #0#12;
         fHFecha = #0#13;

         |ABRE #36;
         |BUCLE dsm00005;
         |CIERRA #36;
     |FINSI;

     |SI #0#14 = "S";
         aTipo   = "AV";
         aDSerie = #0#15;
         aHSerie = #0#16;
         nDDocu  = #0#17;
         nHDocu  = #0#18;
         fDFecha = #0#19;
         fHFecha = #0#20;

         |ABRE #10;
         |BUCLE dsm00005;
         |CIERRA #10;
     |FINSI;

     |SI #0#21 = "S";
         aTipo   = "FC";
         aDSerie = #0#22;
         aHSerie = #0#23;
         nDDocu  = #0#24;
         nHDocu  = #0#25;
         fDFecha = #0#26;
         fHFecha = #0#27;

         |ABRE #84;
         |BUCLE dsm00005;
         |CIERRA #84;
     |FINSI;

     |SI #0#28 = "S";
         aTipo   = "FP";
         aDSerie = #0#29;
         aHSerie = #0#30;
         nDDocu  = #0#31;
         nHDocu  = #0#32;
         fDFecha = #0#33;
         fHFecha = #0#34;

         |ABRE #146;
         |BUCLE dsm00005;
         |CIERRA #146;
     |FINSI;

     |SI #0#35 = "S";
         aTipo   = "PC";
         aDSerie = #0#36;
         aHSerie = #0#37;
         nDDocu  = #0#38;
         nHDocu  = #0#39;
         fDFecha = #0#40;
         fHFecha = #0#41;

         |ABRE #81;
         |BUCLE dsm00005;
         |CIERRA #81;
     |FINSI;

     |SI #0#42 = "S";
         aTipo   = "AC";
         aDSerie = #0#43;
         aHSerie = #0#44;
         nDDocu  = #0#45;
         nHDocu  = #0#46;
         fDFecha = #0#47;
         fHFecha = #0#48;

         |ABRE #77;
         |BUCLE dsm00005;
         |CIERRA #77;
     |FINSI;
|FPRC;
