|FICHEROS;
     iberz018 #0;
     agif0041 #1;
     agifa517 #17;
     iber0041 #41;
     agifa142 #142;
     iber0019 #19;
|FIN;

|VARIABLES;
  {4}aP        = "";
     aIP       = "";
     aLon      = "";
     i         = 0;
     nPos      = 0;
     aClave    = "";
     aEmpre    = "";
     aAlfa     = "";
     aOrg      = "";
     aDes      = "";
     aOrg1     = "";
     aDes1     = "";
     aAlf1     = "";
     aAlf2     = "";
 {-1}auxiliar  = "";
     auxiliar1 = "agifa091";  || F.Pago
     auxiliar2 = "agifm003";  || Grupo Cli/Pro
     auxiliar3 = "agifa040";  || Provi
     auxiliar4 = "dsm00225";  || Paises
     auxiliar5 = "agifa324";  || Divisas
     auxiliar6 = "agifm001";  || Zonas
     auxiliar7 = "agifm002";  || Rutas
     auxiliar8 = "dsm00113";  || Tipo IVA CLI
     auxiliar9 = "agifa553";  || Linea
     auxiliar10= "agifa060";  || Familia
     auxiliar11= "agifa120";  || Subfamilia
     auxiliar12= "agi00003";  || Marcas
     auxiliar13= "agifa066";  || IVA
     auxiliar14= "dsm00116";  || Grupo
     auxiliar15= "dsm00238";  || Unidades
     auxiliar16= "iber0031";
     auxiliar17= "iber0032";
     auxiliar18= "iber0033";
     auxiliar19= "dsm00117";
     auxiliar20= "agifa510";  ||Horarios
     auxiliar21= "iber0065";  ||Secciones
     auxiliar22= "iber0012";
     auxiliar23= "iber0057";
     auxiliar24= "dsm00239";
     auxiliar25= "dsm00240";
     auxiliar26= "dsm00241";
     auxiliar27= "iber0084";
     auxiliar28= "iber0085";
     auxiliar29= "iber0087";
     auxiliar30= "iber0090";
     auxiliar31= "iber0091";
     auxiliar32= "iber0092";
     auxiliar33= "dsm00226";
     auxiliar34= "dsm00237";
     auxiliar35= "iber0112";
     auxiliar36= "agitp001";
     auxiliar37= "iber0136";
     auxiliar38= "agifa321";
     auxiliar39= "agifa142";
     auxiliar40= "FIN";       ||***************FINAL DE auxiliarS

 {-1}Fichero   = "";
     Fichero1  = "iber0016";
     Fichero2  = "agifa024";
     Fichero3  = "agifa019";
     Fichero4  = "agifa112";
     Fichero5  = "agifa505";
     Fichero6  = "agifa081";
     Fichero7  = "agifa067";
     Fichero8  = "iber0017";
     Fichero9  = "iber0018";
     Fichero10 = "iber0019";
     Fichero11 = "iber0020";
     Fichero12 = "iber0001";
     Fichero13 = "iber0002";
     Fichero14 = "agifa048";
     Fichero15 = "agifa049";
     Fichero16 = "agifa007";
     Fichero17 = "agifa029";
     Fichero18 = "iber0040";
     Fichero19 = "iber0041";
     Fichero20 = "iber0101";
     Fichero21 = "iber0056";
     Fichero22 = "iber0063";
     Fichero23 = "iber0064";
     Fichero24 = "iber0066";
     Fichero25 = "iber0067";
     Fichero26 = "iber0068";
     Fichero27 = "iber0069";
     Fichero28 = "iber0070";
     Fichero29 = "iber0074";
     Fichero30 = "iber0076";
     Fichero31 = "dsm00018";
     Fichero32 = "iber0113";
     Fichero33 =  "FIN";       ||***************FINAL
|FIN;

|PROCESO iber0019;
     #19#9 = "N";
     |GRABA 020#19a;
     |LIBERA #19;
|FPRC;

|DEFBUCLE iber0019;
     #19#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, iber0019;
|FIN;

|PROCESO Terminales;
     #41#3 = aP1;
     #41#4 = aP2;
     #41#5 = aP3;
     #41#6 = aP4;
     |GRABA 020#41a;
|FPRC;

|DEFBUCLE Terminales;
     #41#1;
     ;
     #0#0, 01;
     #0#0, 99;
     be;
     NULL, Terminales;
|FIN;

|PROCESO Rmdir;
     |DBASE aAlf1;
     aAlf1 = aAlf1 + "fich/" + (("000" + #0#0) % -103) + "00";
     |DIRECTORIO aAlf2;
     aAlf2 = aAlf2 + "bin/agirm -r " + aAlf1;
     |SYSTEM aAlf2;
|FPRC;

|PROCESO Tipo 3; |TIPO 3;
     |SI #0#1 ! "SI"; |ACABA; |FINSI;

     |DBASE aDes;
     |DFICE aOrg;
     aDes = aDes + "fich/";
     aEmpre = aOrg % -205;

     |SI aOrg = aDes;
          |MENAV "0000ERROR el centro es el actual";
          |ACABA;
     |FINSI;

     |PATH_DAT #1 aDes;
     aDes = aDes + (("000" + #0#0) % -103) + "00/";
     |ABRE #1;
     #1#0 = aEmpre;
     |LEE 000#1=;
     aClave = #1#8;
     #1#0 = #0#0 * 100;
     |LEE 000#1=;
     |SI FSalida = 0;
          |MENAV "0000La Empresa EXISTE.";
          |CONFI "0000NEsta Seguro de Continuar";
          |SI FSalida ! 0;
               |ACABA;
          |FINSI;
          |HAZ Rmdir;

          aAlfa = aOrg % -403;
          #1#1 = "Copia Centro " + aAlfa + " Simulacion";
          #1#8 = aClave;
          |GRABA 020#1a;
     |SINO;
          aAlfa = aOrg % -403;
          #1#1 = "Copia Centro " + aAlfa + " Simulacion";
          #1#8 = aClave;
          |GRABA 020#1n;
     |FINSI;
     |CIERRA #1;

     |MKDIR aDes;

     Iauxiliar = auxiliar1<-;
     |PARA; |SI auxiliar ! "FIN"; |HACIENDO;
          |PINTA 1624, auxiliar;

          aOrg1 = aOrg + auxiliar + ".dat";
          aDes1 = aDes + auxiliar + ".dat";
          |COPIA_FICHERO aOrg1, aDes1;

          aOrg1 = aOrg + auxiliar + ".ixx";
          aDes1 = aDes + auxiliar + ".ixx";
   ||       |COPIA_FICHERO aOrg1, aDes1;

          aOrg1 = aOrg + auxiliar + ".ddx";
          aDes1 = aDes + auxiliar + ".ddx";
          |COPIA_FICHERO aOrg1, aDes1;

          Iauxiliar = Iauxiliar + 1;
     |SIGUE;

     IFichero = Fichero1<-;
     |PARA; |SI Fichero ! "FIN"; |HACIENDO;
          |PINTA 1624, Fichero;

          aOrg1 = aOrg + Fichero + ".dat";
          aDes1 = aDes + Fichero + ".dat";
          |COPIA_FICHERO aOrg1, aDes1;

          aOrg1 = aOrg + Fichero + ".ixx";
          aDes1 = aDes + Fichero + ".ixx";
   ||       |COPIA_FICHERO aOrg1, aDes1;

          aOrg1 = aOrg + Fichero + ".ddx";
          aDes1 = aDes + Fichero + ".ddx";
          |COPIA_FICHERO aOrg1, aDes1;

          IFichero = IFichero +1 ;
     |SIGUE;

     |PATH_DAT #142 aDes;
     |ABRE #142;
     |LEE 101#142=;
     |SI FSalida = 0;
          #142#164 = "D";
          |GRABA 020#142a;
     |FINSI;
     |CIERRA #142;

     |PATH_DAT #17 aDes;
     |ABRE #17;
     |GRABA 000#17n;
     |CIERRA #17;

     |PATH_DAT #19 aDes;
     |BUCLE iber0019;

     |PATH_DAT #41 aDes;
     |IP_REMOTO aIP;
/*
     aLon = aIP % A0;
     IaP = IaP<-;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aAlfa = aIP % nPos;
          |SI aAlfa = ".";
               IaP = IaP + 1;
          |SINO;
               aP = aP + aAlfa;
          |FINSI;
     |SIGUE;
*/
     |BUCLE Terminales;


     |PTEC 807;
     |SUB_EJECUTA_NP ":/agitool/bin/rwindex";
|FPRC;
