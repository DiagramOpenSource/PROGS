|FICHEROS;
     grsol004 #0;
     grsol002 #2;
     referen@;
|FIN;

|VARIABLES;
     nForma = 0;
     nModo = 0;
     aDef = "";
     aAlfa = "";
     nNume = 0;

     &efFecha = @;
     &eaAbono = "";
     &eaSerie = "";
     &enNumero = 0;
     &enLinea = 0;
     &enUniSol = 0;
     &eaTmpSol = "";
     &nDeci_Uni = 0;

     i1        = "";
     i2        = "";
     i3        = "";
     i4        = "";
     i5        = "";
     i6        = "";
     p1        = "";
     p2        = "";
     p3        = "";
     p4        = "";
     p5        = "";
     p6        = "";
     calcodb   = "";
     sumai     = 0;
     sumap     = 0;
     base      = 0;
     resto     = 0;
     total     = 0;
     digito    = 0;
|FIN;

|PROCESO Min;
     #0#0 = eaSerie;
     #0#1 = enNumero;
     #0#2 = enLinea;
     #0#3 = 1;
|FPRC;

|PROCESO Max;
     #0#0 = eaSerie;
     #0#1 = enNumero;
     #0#2 = enLinea;
     #0#3 = 999;
|FPRC;

|PROCESO SumUni; |TIPO 2;
     nForma = 0 +. 1;
     enUniSol = enUniSol +. 1;

     |ABRE #2;
     #2#0 = #0#4;
     |LEE 101#2=;
     |SI FSalida = 0;
          |SI nForma = 1;
               #2#6 = eaSerie;
               #2#7 = enNumero;
               #2#8 = enLinea;
               #2#9 = efFecha;
               #2#10 = eaAbono;
          |SINO;
               #2#6 = "";
               #2#7 = "";
               #2#8 = "";
               #2#9 = "01.01.0000";
               #2#10 = "";
          |FINSI;
          |GRABA 020#2a;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO EAN13; |TIPO 0;
     i1 = #0#4 % 101;
     i2 = #0#4 % 301;
     i3 = #0#4 % 501;
     i4 = #0#4 % 701;
     i5 = #0#4 % 901;
     i6 = #0#4 % 1101;
     p1 = #0#4 % 201;
     p2 = #0#4 % 401;
     p3 = #0#4 % 601;
     p4 = #0#4 % 801;
     p5 = #0#4 % 1001;
     p6 = #0#4 % 1201;
     sumai = i1 + i2 + i3 + i4 + i5 + i6;
     sumap = p1 + p2 + p3 + p4 + p5 + p6;
     sumap = sumap * 3;
     total = sumai + sumap;
     base = total / 10;
     resto = total $ 10;
     |SI resto ! 0;
          resto = resto / 10;
          base = (base - resto) + 1;
          base = base * 10;
     |SINO;
          base = base * 10;
     |FINSI;
     digito = base - total;
     calcodb = #0#4;
     |QBF calcodb;
     calcodb = calcodb + "000000000000000";
     calcodb = calcodb % 0112;
     calcodb = calcodb + digito;
     |QBF calcodb;
     #0#4 = calcodb;
     |PINTA #0#4;
|FPRC;

|PROCESO CheqSerie; |TIPO 0;
     |ABRE #2;
     #2#0 = #0#4;
     |LEE 000#2=;
     |SI FSalida ! 0;
          |MENAV "0000Serie Fabricacion Inexistente...";
          |ERROR;
     |SINO;
          |SI #2#7 ! 0;
               aAlfa = "0000Serie vendida en alb:" + #2#6 + "/" + #2#7 + "/" + #2#8;
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROGRAMA;
     |ENTLINEAL #1#0, 4, 1, 22, 1, Min, Max;
|FPRO;
