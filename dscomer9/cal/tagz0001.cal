|FICHEROS;
     tagz0001 #0;
     agifa010 #10;
     agifa071 #71;
     agifa084 #84;
     agifa069 #69;
     agifa024 #24;
     agifa091 #91;
|FIN;

|VARIABLES;
     &enCoste = 0;
     &aDivisa = "";
     &aMoneda = "";
     &enForma = 0;
     aParam = "";
     aAlfa = "";
     i = 0;
|FIN;

|PROCESO LinAlbaran;
     #71#29 = #10#52;
     #71#0 = #10#0;
     |PARA i = 1; |SI i [ 17; |HACIENDO i = i + 1;
          #71i = #69i;
     |SIGUE;
     #71#5 = -#71#5;
     #71#27 = #69#18;
     #71#33 = #69#21;
     #71#34 = #69#22;
     #71#35 = #69#23;
     #71#36 = #69#26;
     #71#48 = -#69#30;
     #71#49 = #69#31;
     #71#50 = #69#32;
     #71#51 = #69#33;
     #71#52 = #69#34;
     #71#53 = #69#35;
     |HAZ TotalLin71;
     |HAZ AcumulaAV;
     #71#14 = enCoste;
     |GRABA 020#71n;
|FPRC;

|PROCESO CabAlbaran;
     |ABRE #24;
     #24#0 = #84#3;
     |LEE 000#24=;
     |CIERRA #24;

     |ABRE #91;
     #91#0 = #24#8;
     |LEE 000#91=;
     |CIERRA #91;

     |PARA i = 1; |SI i [ 37; |HACIENDO i = i + 1;
          #10i = #84i;
     |SIGUE;
     #10#10 = "N";
     #10#40 = #24#41;
     #10#62 = #84#64
     #10#63 = #84#60;
     #10#66 = #91#69;      ||Tipo Rec
     #10#68 = #84#65;
     #10#69 = #84#66;
     #10#70 = #84#67;
     #10#73 = #84#68;
     #10#74 = #84#69;
     #10#83 = #84#87;
     #10#84 = #84#91;
     #10#88 = #84#78;
     #10#89 = #84#79;
     #10#91 = #24#206;
     |GRABA 020#10a;
|FPRC;

|PROCESO LinFactura;
     #69#20 = #0#3;
     #69#0 = #0#4;
     #69#5 = -#69#5;
     #69#30 = -#69#30;
     |GRABA 020#69b;
     |HAZ TotalLin69;
     |GRABA 020#69a;
     |LIBERA #69;
     |HAZ AcumulaFC;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     enForma = 1;
     |ABRE #84;
     |ABRE #10;
     |ABRE #71;
     |SI #0#2 = "F";
          #84#48 = #0#3;
          #84#0 = #0#4;
          |LEE 000#84=;
     |SINO;
          #10#52 = #0#3;
          #10#0 = #0#4;
          |LEE 000#10=;
     |FINSI;
     |SI FSalida = 0;
          |MENAV "0000ERROR. Documento destino existente...";
     |SINO;
          #84#48 = #0#0;
          #84#0 = #0#1;
          |LEE 000#84=;
          |SI FSalida ! 0;
               |MENAV "0000ERROR. Documento origen inexistente...";
          |SINO;
               |SI #0#2 = "F";
                    aDivisa = #84#65;
                    aMoneda = #84#67;
                    |HAZ Divisas084;
                    |BUCLELIN 2 LinFactura #84;
                    #84#48 = #0#3;
                    #84#0 = #0#4;
                    |GRABA 020#84b;
                    |HAZ LimCabAgifa084;
                    |BUCLELIN 0 CalCabAgifa084 #84;
                    |GRABA 020#84a;
                    aAlfa = "0000Factura creada:"  + #0#3 + "/" + (("000000" + #0#4)%-106);
               |SINO;
                    aDivisa = #84#65;
                    aMoneda = #84#67;
                    |HAZ Divisas010;
                    |DDEFECTO #10;
                    #10#52 = #0#3;
                    #10#0 = #0#4;
                    |GRABA 020#10b;
                    |HAZ CabAlbaran;
                    |BUCLELIN 2 LinAlbaran #84;
                    |HAZ LimCabAgifa010;
                    |BUCLELIN 0 CalCabAgifa010 #10;
                    |GRABA 020#10a;
                    aAlfa = "0000Albaran creado:"  + #0#3 + "/" + (("000000" + #0#4)%-106);
               |FINSI;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |CIERRA #71;
     |CIERRA #10;
     |CIERRA #84;
|FPRC;

|PROCESO Conta0; |TIPO 0;
     |SI #0#2 = "F";
          #84#48 = #0#3;
          #84#0 = #0#4;
          |ABRE #84;
          |HAZ ContaFD0;
          |CIERRA #84;
     |SINO;
          #10#52 = #0#3;
          #10#0 = #0#4;
          |ABRE #10;
          |HAZ ContaAV0;
          |CIERRA #10;
     |FINSI;
|FPRC;

|PROCESO Conta7; |TIPO 7;
     |SI #0#2 = "F";
          #84#48 = #0#3;
          #84#0 = #0#4;
          |ABRE #84;
          |HAZ ContaFD7;
          |CIERRA #84;
          #0#4 = #84#0;
     |SINO;
          #10#52 = #0#3;
          #10#0 = #0#4;
          |ABRE #10;
          |HAZ ContaAV7;
          |CIERRA #10;
          #0#4 = #10#0;
     |FINSI;
     |PINTA #0#4;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |SI aParam = "";
          |MANTE #0;
     |SINO;
          |CLS;
          #0#0 = aParam;
          aParam = aParam % 606;
          #0#1 = aParam;
          |C_M #0#0, 1, "N";
          |C_M #0#1, 1, "N";
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |FINSI;
|FPRO;
