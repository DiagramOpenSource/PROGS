|| Calculo Impresion Facturas Marhuenda (agifa136)
|| Ordena articulos por orden de actuacion :-(

|FICHEROS;
     &marhu355@ #100;
     agifa134   #134;
     agifa059   #59;
     agifa010   #10;
     agifa071   #71;
     marhu042@  #42;     ||Orden
     agifa017   #17;
|FIN;

|VARIABLES;
     &Tempo     = "";
     aTempo100  = "";
     &enSwMarhu = 0;
     aAlfa      = "";
     bAlfa      = "";
     aDef       = "";
     aOrden     = "";
|FIN;

|PROCESO LinAlba;
     #17#0 = #71#2;
     #17#1 = #71#3;
     |LEE 000#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

     aAlfa = #17#2;

     bAlfa = aAlfa % 101;
     #42#2 = bAlfa;
     bAlfa = aAlfa % 201;
     #42#3 = bAlfa;
     bAlfa = aAlfa % 301;
     #42#4 = bAlfa;
     bAlfa = aAlfa % 401;
     #42#5 = bAlfa;
     bAlfa = aAlfa % 502;
     #42#6 = bAlfa;
     |LEE 000#42=;
     |SI FSalida ! 0; |DDEFECTO #42; |FINSI;

     |SI #42#0 = "A"; aAlfa = "B"; |SINO; aAlfa = "A"; |FINSI;
     aOrden = aAlfa + (("0000" + #42#1) % -104) + #17#0;

     #100#0 = #71#29;
     #100#1 = #71#0;
     #100#2 = #71#1;
     #100#3 = aOrden;
     |GRABA 020#100n;
|FPRC;

|PROCESO Albaran;
     #10#52 = #59#15;
     #10#0 = #59#2;
     |LEE 020#10=;
     |SI FSalida = 0;
          |BUCLELIN 2 LinAlba #10;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴Procesos Externos컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO OrdenaMarhu;
     |SI enSwMarhu ! 0; |ACABA; |FINSI;

     |ABRE #42; |SELECT #2#42;
     |ABRE #100;
     |ABRE #10;
     |ABRE #17
     |BUCLELIN 2 Albaran #134;
     |CIERRA #10;
     |CIERRA #17
     |CIERRA #100;
     |CIERRA #42;
|FPRC;

|PROCESO FinMarhu;
     |SI enSwMarhu = 0;
          |DELINDEX #100; Tempo = aTempo100; |HAZ BoraTempo;
          |DESCARGA_DEF #marhu042@;
          |DESCARGA_DEF #marhu355@;
     |FINSI;
|FPRC;

|PROCESO IniMarhu;
     aAlfa = ""; |DBIN aAlfa;
     aAlfa = aAlfa + "marhup07.tab";
     |XABRE "E", aAlfa, 0;
     enSwMarhu = FSalida;
     |SI enSwMarhu = 0;
          |DDEF aDef;
          aAlfa = aDef + "marhu355";
          |CARGA_DEF aAlfa, marhu355@;
          enSwMarhu = FSalida;
          |SI FSalida = 0;
               aAlfa = aDef + "marhu042";
               |CARGA_DEF aAlfa, marhu042@;
               enSwMarhu = FSalida;
               |SI FSalida = 0;
                    |HAZ CreaTempo; aTempo100 = Tempo;
                    |NOME_DAT #100 aTempo100;
                    |DELINDEX #100;
               |SINO;
                    aAlfa = "0000Error al cargar " + aAlfa;
                    |MENAV aAlfa;
               |FINSI;
          |SINO;
               aAlfa = "0000Error al cargar " + aAlfa;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;
