|FICHEROS;
     agifa146 #146,MANTE;
     agifa142 #142;
|FIN;

|VARIABLES;
     &eaSerNuevo = "";
     &enNumNuevo = 0;
     &eaSerie = "";
     &enCodigo = 0;
     &enSwMenu = 0;
     &serie = "";
     &numero = 0;
     &reimpr = "";
     aAlfa = "";
     aAccion = "";
     aSerie = "";
     aCodigo = "";
     aCliente = "";
     aDirEnt = "";
     aTempo = "";
     nHandle = 0;
|FIN;

|PROCESO GraTmp;
     |DFICE aAlfa;
     aAlfa = aAlfa + aTempo;
     |XABRE "W", aAlfa, nHandle;
     |SI FSalida = 0;
          aAlfa = eaSerNuevo + (("000000" + enNumNuevo) % -106);
          |XGRABA nHandle, aAlfa;
          |XCIERRA nHandle;
     |FINSI;
|FPRC;

|PROGRAMA;
     aAccion = PARAMETRO % 101;
     aSerie = PARAMETRO % 205;
     aCodigo = PARAMETRO % 706;
     aCliente = PARAMETRO % 1306;
     aDirEnt = PARAMETRO % 1904;
     aTempo = PARAMETRO % 2308;

     |SI aDirEnt = 0; aDirEnt = "1"; |FINSI;

     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |CLS;
     |ABRE #146;
     #146#48 = aSerie;
     #146#0 = aCodigo;
     |SI aAccion = "I";
          |LEE 020#146=;
          |SI FSalida = 0;
               serie = #146#48;
               numero = #146#0;
               reimpr = #146#10;
               |SUB_EJECUTA_NP "agifa150";
          |FINSI;
     |FINSI;
     |SI aAccion = "V";
          |LEE 020#146=;
          |SI FSalida = 0;
               |PINPA #0#146;
               |PINDA #0#146;
               |ENDATOS #4#146;
          |FINSI;
     |FINSI;
     |SI aAccion = "M";
          |LEE 121#146=;
          |SI FSalida = 0;
               |PINPA #0#146;
               |PINDA #0#146;
               |ENDATOS #2#146;
               |SI FSalida = 0;
                    |GRABA 020#146a;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aAccion = "N";
          |SI #142#185 = "S";
               #146#48 = #142#191;
          |FINSI;
          |PINPA #0#146;
          |PINDA #0#146;
          |ENCAMPO #48#146;
          |SI FSalida = 0;
               FEntrada = 101;
               |HAZ ContaPR7;
               FEntrada = 0;
               |ENCAMPO #0#146;
               |SI FSalida = 0;
                    |LEE 101#146=;
                    |SI FSalida = 0;
                         |PINDA #0#146;
                         |MENAV "0000Registro existente...";
                         |PAUSA;
                    |SINO;
                         #146#3 = aCliente; |PINTA #146#3;
                         #146#80 = aDirEnt; |PINTA #146#80;
                         |GRABA 020#146b;
                         |ENDATOS #1#146;
                         |SI FSalida = 0;
                              |GRABA 020#146a;
                              eaSerNuevo = #146#48;
                              enNumNuevo = #146#0;
                              |HAZ GraTmp;
                         |SINO;
                              |BORRA 020#146c;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aAccion = "P";  || Ver Pedido
          |LEE 020#146=;
          |SI FSalida = 0;
               |SI #146#62 = "P";
                    aAlfa = "dszx0003;V" + #146#60 + (("000000" + #146#61) % -106);
                    |SUB_EJECUTA_NP aAlfa;
               |SINO;
                    |MENAV "0000Oferta no adjudicada a pedido...";
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aAccion = "R";
          eaSerie = aSerie;
          enCodigo = aCodigo;
          |SUB_EJECUTA_NP "diaw0025";
     |FINSI;
     |CIERRA #146;
|FPRO;
