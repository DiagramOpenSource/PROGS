|FICHEROS;
     sctrm060 #0;
     sctrm003 #3;
     sctrm008 #8;
     sctrm021 #21;
     sctrw022 #22;
     sctrm023 #23;
     sctrm026 #26;
     sctrm050 #50;
     sctrm051 #51;
     sctrm052 #52;
     sctrm056 #56;
     sctrm061 #61;
     sctrz078 #78,MANTE;
     sctrw021 #121;
     sctrm061@;
|FIN;

|VARIABLES;
     aUsu = "";
     &enErrorBaja = 0;
     &eaSwBaja = "";
     &enForma = 0;
     &Tempo = "";
     &eaTemporada = "";
     nKmsGrupo = 0;
     nExiste = 0;
     nSw = 0;
     nHoja = 0;
     nLin = 0;
     fHasta = @;
     fFecha = @;
     aTmp22 = "";
     aTmp121 = "";
     nSwLleno = 0;
     aConfir = "";
     nOk = 0;
     nNume = 0;
     nFiltro = 0;
     nCheq = 0;
     i = 0;
     i1 = 0;
     nAnte = 0;
     aAnte = "";
     aAlfa = "";
     nSal61 = 0;
     nHay = 0;
|FIN;

|PROCESO BuscaTempo;
     |SI #0#0 ] #8#2; |Y #0#0 [ #8#3;
          eaTemporada = #8#0;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaTempo;
     #8#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, BuscaTempo;
|FIN;

|PROCESO BuscaTempo0;
     eaTemporada = "";
     |BUCLE BuscaTempo;
|FPRC;

|PROCESO TmpOrg1;
     |SI #121#12 = "S";
          |ACABA;
     |FINSI;
/*
     nCheq = 0;
     |SI #0#32 ! "    "; nCheq = 1; |FINSI;
     |SI #0#33 ! "    "; nCheq = 1; |FINSI;
     |SI #0#34 ! "    "; nCheq = 1; |FINSI;
     |SI #0#38 ! "    "; nCheq = 1; |FINSI;
     |SI #0#39 ! "    "; nCheq = 1; |FINSI;
     |SI #0#40 ! "    "; nCheq = 1; |FINSI;

     nFiltro = 0;
     |SI nCheq = 1;
          nFiltro = 1;
          |SI #0#32 = #121#4; nFiltro = 0; |FINSI;
          |SI #0#33 = #121#4; nFiltro = 0; |FINSI;
          |SI #0#34 = #121#4; nFiltro = 0; |FINSI;
          |SI #0#38 = #121#4; nFiltro = 0; |FINSI;
          |SI #0#39 = #121#4; nFiltro = 0; |FINSI;
          |SI #0#40 = #121#4; nFiltro = 0; |FINSI;
     |FINSI;
     |SI nFiltro = 1; |ACABA; |FINSI;
*/
     nFiltro = 0;
     || Si hay filtro por origen comprobamos que la poblacion de la reserva este entre las indicadas que queremos que no viajen.
     |SI #0#24 = "S";
          nFiltro = 0;
          |SI #0#26 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#27 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#28 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#35 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#36 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#37 = #121#3; nFiltro = 1; |FINSI;
     |FINSI;
     |SI nFiltro = 1; |ACABA; |FINSI;

     nFiltro = 0;
     || Si hay filtro por destino comprobamos que la poblacion destuno de la reserva no este entre las indicadas que queremos que viajen.
     |SI #0#25 = "S";
          nFiltro = 0;
          |SI #0#29 = #121#11; nFiltro = 1; |FINSI;
          |SI #0#30 = #121#11; nFiltro = 1; |FINSI;
          |SI #0#31 = #121#11; nFiltro = 1; |FINSI;
     |FINSI;
     |SI nFiltro = 1; |ACABA; |FINSI;

     |SI #50#35 < #50#19;     || Viajeros Origen < Pax Vehiculo
          #50#35 = #50#35 + 1;     || Viajeros Origen
          #50#40 = #50#40 + 1;     || Viajeros bajan inter
          #50#20 = #50#20 + 1;

          #52#0 = #121#0;
          |LEE 140#52=;
          |SI FSalida ! 0;
               aAlfa = ("0000000" + #52#0) % -107;
               aUsu = Usuario % 810;
               aAlfa = "0000Reserva  " + aAlfa + " bloqueada por " + aUsu + ", compruebe la creaci¢n de la hoja de ruta...";
               |MENAV aAlfa;
          |SINO;
               |SI #121#2 = "I";
                    #52#73 = #50#0;
                    #52#74 = #50#1;
                    #52#77 = #50#2;
                    #52#103 = 0;
                    #52#122 = 0;
               |SINO;
                    #52#78 = #50#0;
                    #52#79 = #50#1;
                    #52#82 = #50#2;
                    #52#104 = 0;
                    #52#123 = 0;
               |FINSI;
               |GRABA 020#52a;
               |LIBERA #52;
          |FINSI;

          #121#12 = "S";
          #121#13 = "N";
          #121#15 = #0#1;
          |GRABA 020#121a;
     |SINO;
          nSwLleno = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE TmpOrg1;
     #121#2;
     ;
     #61#3, "01.01.0000", "     ", 0000000;
     #61#3, "31.12.9999", "zzzzz", 9999999;
     be;
     NULL, TmpOrg1;
|FIN;

|PROCESO TmpOrg;
     #sctrm061@#0 = #61#0;
     #sctrm061@#1 = #61#1;
     #sctrm061@#2 = #61#2;
     #sctrm061@#3 = #121#4;
     #sctrm061@#6 = #121#2;
     |LEE 000#sctrm061@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     nFiltro = 0;
     || Si hay filtro por origen comprobamos que la poblacion de la reserva este entre las indicadas que queremos que no viajen.
     |SI #0#24 = "S";
          nFiltro = 0;
          |SI #0#26 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#27 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#28 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#35 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#36 = #121#3; nFiltro = 1; |FINSI;
          |SI #0#37 = #121#3; nFiltro = 1; |FINSI;
     |FINSI;
     |SI nFiltro = 1; |ACABA; |FINSI;

     nFiltro = 0;
     || Si hay filtro por destino comprobamos que la poblacion destuno de la reserva no este entre las indicadas que queremos que viajen.
     |SI #0#25 = "S";
          nFiltro = 0;
          |SI #0#32 = #121#4; nFiltro = 1; |FINSI;
          |SI #0#33 = #121#4; nFiltro = 1; |FINSI;
          |SI #0#34 = #121#4; nFiltro = 1; |FINSI;
          |SI #0#38 = #121#4; nFiltro = 1; |FINSI;
          |SI #0#39 = #121#4; nFiltro = 1; |FINSI;
          |SI #0#40 = #121#4; nFiltro = 1; |FINSI;
     |FINSI;
     |SI nFiltro = 1; |ACABA; |FINSI;

     |SI #50#35 < #50#19;     || Viajeros Origen < Pax Vehiculo
          #50#35 = #50#35 + 1;     || Viajeros Origen
          #50#39 = #50#39 + 1;     || Viajeros suben inter
          #50#20 = #50#20 + 1;

          #52#0 = #121#0;
          |LEE 140#52=;
          |SI FSalida ! 0;
               aAlfa = ("0000000" + #52#0) % -107;
               aUsu = Usuario % 810;
               aAlfa = "0000Reserva  " + aAlfa + " bloqueada por " + aUsu + ", compruebe la creaci¢n de la hoja de ruta...";
               |MENAV aAlfa;
          |SINO;
               |SI #121#2 = "I";
                    #52#73 = #50#0;
                    #52#74 = #50#1;
                    #52#77 = #50#2;
                    #52#103 = #52#77;
                    #52#122 = 0;
               |SINO;
                    #52#78 = #50#0;
                    #52#79 = #50#1;
                    #52#82 = #50#2;
                    #52#104 = #52#82;
                    #52#123 = 0;
               |FINSI;
               |GRABA 020#52a;
               |LIBERA #52;
          |FINSI;

          #121#12 = "S";
          #121#13 = "S";
          #121#15 = #0#1;
          #121#16 = #0#1;
          |GRABA 020#121a;
     |SINO;
          nSwLleno = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE TmpOrg;
     #121#2;
     ;
     #61#3, "01.01.0000", "     ", 0000000;
     #61#3, "31.12.9999", "zzzzz", 9999999;
     be;
     NULL, TmpOrg;
|FIN;

|PROCESO Lineas;
     |SI nSw = 1;
          |BUCLE TmpOrg;
     |SINO;
          |BUCLE TmpOrg1;
     |FINSI;
     |SI nSwLleno = 1; |ERROR10; |FINSI;
|FPRC;

|DEFBUCLE Lineas;
     #61#2;
     ;
     #0#0, #0#1, #0#2, "O", 0, "    ";
     #0#0, #0#1, #0#2, "O", 9, "zzzz";
     ;
     NULL, Lineas;
|FIN;

|PROCESO TmpInter;
     |SI #50#39 < #50#19;    || Quedan Plazas en el intercambiador y no esta asig.
          |SI #121#13 = "S";
               |ACABA;
          |FINSI;
          #50#39 = #50#39 + 1;
          #52#0 = #121#0;
          |LEE 140#52=;
          |SI FSalida ! 0;
               aAlfa = ("0000000" + #52#0) % -107;
               aUsu = Usuario % 810;
               aAlfa = "0000Reserva  " + aAlfa + " bloqueada por " + aUsu + ", compruebe la creaci¢n de la hoja de ruta...";
               |MENAV aAlfa;
          |SINO;
               |SI #121#2 = "I";
                    #52#103 = #50#2;
               |SINO;
                    #52#104 = #50#2;
               |FINSI;
               |GRABA 020#52a;
               |LIBERA #52;
          |FINSI;

          #121#13 = "S";
          #121#16 = #0#1;
          |GRABA 020#121a;
     |SINO;
          nSwLleno = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE TmpInter;
     #121#4;
     ;
     #61#3, "01.01.0000", "     ", 0000000;
     #61#3, "31.12.9999", "zzzzz", 9999999;
     be;
     NULL, TmpInter;
|FIN;

|PROCESO Inter;
     |BUCLE TmpInter;
|FPRC;

|DEFBUCLE Inter;
     #61#2;
     ;
     #0#0, #0#1, #0#2, "D", 0, "    ";
     #0#0, #0#1, #0#2, "D", 9, "zzzz";
     ;
     NULL, Inter;
|FIN;

|PROCESO Antena;
     |SI #121#14 = "S";
          |ACABA;
     |FINSI;

     |SI #50#35 < #50#19;     || Viajeros Origen < Pax Vehículo
          #61#0 = #0#0;
          #61#1 = #0#1;
          #61#2 = #0#2;
          #61#3 = #121#4;
          #61#6 = #121#2;
          |LEE 000#61=;
          nSal61 = FSalida;

          |SI nSw = 3; |Y FSalida ! 0;
               |ACABA;
          |FINSI;

          #50#35 = #50#35 + 1;     || Viajeros Origen
          #50#20 = #50#20 + 1;

          #52#0 = #121#0;
          |LEE 140#52=;
          |SI FSalida ! 0;
               aAlfa = ("0000000" + #52#0) % -107;
               aUsu = Usuario % 810;
               aAlfa = "0000Reserva  " + aAlfa + " bloqueada por " + aUsu + ", compruebe la creaci¢n de la hoja de ruta...";
               |MENAV aAlfa;
          |SINO;
               |SI #121#2 = "I";
                    #52#122 = #50#2;
                    #52#124 = aAnte;
                    |SI #0#2 = "I";
                         |SI nSal61 = 0;
                              #52#103 = #50#2;
                              #50#39 = #50#39 + 1
                         |SINO;
                              #52#103 = 0;
                              #50#40 = #50#40 + 1
                         |FINSI;
                    |FINSI;
               |SINO;
                    #52#123 = #50#2;
                    #52#125 = aAnte;
                    |SI #0#2 = "I";
                         |SI nSal61 = 0;
                              #52#104 = #50#2;
                              #50#39 = #50#39 + 1
                         |SINO;
                              #52#104 = 0;
                              #50#40 = #50#40 + 1
                         |FINSI;
                    |FINSI;
               |FINSI;
               |GRABA 020#52a;
               |LIBERA #52;
          |FINSI;

          #121#14 = "S";
          |SI nSal61 = 0; |Y #0#2 = "I";
               #121#13 = "S";
          |FINSI;
          |GRABA 020#121a;
     |SINO;
          nSwLleno = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE Antena;
     #121#3;
     ;
     nAnte, 000000; ||nAnte es el valor del #0#66, 68, 70 o 72 cuando son disitintos de 0.
     nAnte, 999999;
     be;
     NULL, Antena;
|FIN;

|DEFBUCLE AntenaTodo;
     #121#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Antena;
|FIN;

|PROCESO Masiva2;
     |SI nSw = 4;
          |SI #0#2 = "I";
               |SI #0#42 = "N"; |ACABA; |FINSI;
               |SI #0#45 = "    "; |ACABA; |FINSI;
          |SINO;
               |SI #0#67 ! "    "; |ACABA; |FINSI;
          |FINSI;
     |FINSI;

     #22#0 = #0#0;
     #22#1 = #0#1;
     #22#2 = #0#2;
     |LEE 000#22=;
     |SI FSalida = 0;
          nSwLleno = 0;
          #50#0 = #0#0;
          #50#1 = #22#3; ||Nr Hoja Diario
          |LEE 121#50=;

          |SI nSw < 3;
               |BUCLE Lineas;
          |SINO;
               |SI nSw = 3; |O nSw = 5;
                    |SI #0#2 = "I";
                         |PARA i = 66; |SI i [ 72; |HACIENDO i = i + 2;
                              |SI #0i ! 0;
                                   i1 = i +1
                                   aAnte = #0i1;
                                   nAnte = #0i;
                                   |ABRE #61;
                                   |ABRE #52;
                                   |BUCLE Antena;
                                   |CIERRA #52;
                                   |CIERRA #61;
                              |FINSI;
                         |SIGUE;
                    |SINO;
                         |SI #0#67 ! "    ";
                              aAnte = #0#67;
                              |BUCLE AntenaTodo;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |SI #50#39 < #50#19; || Quedan Plazas en el intercambiador.
                         |ABRE #52;
                         |BUCLE Inter;
                         |CIERRA #52;
                    |FINSI;
               |FINSI;
          |FINSI;
          #50#45 = #0#83;
          |GRABA 020#50a;
          |LIBERA #50;
     |FINSI;
|FPRC;

|DEFBUCLE Masiva2;
     #0#1;
     ;
     #78#0, #78#2, #78#1;
     #78#0, #78#3, #78#1;
     ;
     NULL, Masiva2;
|FIN;

|PROCESO Reservas3;
     |SI #52#53 = "L"; |ACABA; |FINSI;
     |SI #52#53 = "A";
          |SI #52#63 = "T"; |O #52#63 = "R";
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #52#79 ! 0; |ACABA; |FINSI;    ||Vuelta Nr Dia H.Ruta

     fFecha = #52#26;
     nNume = 1 - #52#100;
     fFecha = fFecha + nNume;
     |SI fFecha ! #78#0; |ACABA; |FINSI;

     |SI #52#82 ! 0; |Y #52#104 ! 0;
          #3#0 = #52#8
          |LEE 000#3=;
          |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
          |SI #3#14 = "N";
               |ACABA;
          |SINO;
               |SI #52#123 = 0
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     #23#0 = #52#105;
     #23#2 = #52#80;
     #23#4 = #52#102;
     #23#5 = #52#28;
     |LEE 000#23=;
     |SI FSalida ! 0; |DDEFECTO #23; |FINSI;

     |DDEFECTO #121;
     #121#0 = #52#0;
     #121#1 = #52#28;
     #121#2 = "V";
     #121#3 = #52#12;
     #121#4 = #52#8;
     #121#5 = #52#26;
     #121#6 = #52#27;
     #121#7 = #52#29;
     #121#8 = #52#30;
     #121#9 = #52#102;
     #121#10 = #23#9;
     #121#11 = #23#11;

     |SI #52#82 ! 0;
          #121#15 = #52#82;
          #121#12 = "S";
     |FINSI;
     |SI #52#104 ! 0;
          #121#16 = #52#104;
          #121#13 = "S";
     |FINSI;

     |GRABA 020#121n;
|FPRC;

|DEFBUCLE Reservas3;
     #52#3;
     102;
     #78#0, 000000, 0000000, #78#1;
     fHasta, 999999, 9999999, #78#1;
     ;
     NULL, Reservas3;
|FIN;

|PROCESO Reservas2;
     |SI #52#52 = "L"; |ACABA; |FINSI;
     |SI #52#52 = "A";
          |SI #52#63 = "T"; |O #52#63 = "S";
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #52#74 ! 0; |ACABA; |FINSI;    ||Ida Nr Diario H.Ruta

     fFecha = #52#20;
     nNume = 1 - #52#99;
     fFecha = fFecha + nNume;
     |SI fFecha ! #78#0; |ACABA; |FINSI;

     |SI #52#77 ! 0; |Y #52#103 ! 0;
          #3#0 = #52#8
          |LEE 000#3=;
          |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
          |SI #3#14 = "N";
               |ACABA;
          |SINO;
              |SI #52#122 = 0
                    |ACABA;
              |FINSI;
          |FINSI;
     |FINSI;

     #23#0 = #52#96;
     #23#2 = #52#75;
     #23#4 = #52#101;
     #23#5 = #52#22;
     |LEE 000#23=;
     |SI FSalida ! 0; |DDEFECTO #23; |FINSI;


     |DDEFECTO #121;
     #121#0 = #52#0;
     #121#1 = #52#22;
     #121#2 = "I";
     #121#3 = #52#8;
     #121#4 = #52#12;
     #121#5 = #52#20;
     #121#6 = #52#21;
     #121#7 = #52#23;
     #121#8 = #52#24;
     #121#9 = #52#101;
     #121#10 = #23#9;
     #121#11 = #23#11;

     |SI #52#77 ! 0;
          #121#15 = #52#77;
          #121#12 = "S";
     |FINSI;
     |SI #52#103 ! 0;
          #121#16 = #52#103;
          #121#13 = "S";
     |FINSI;

     |GRABA 020#121n;
|FPRC;

|DEFBUCLE Reservas2;
     #52#2;
     101;
     #78#0, 000000, 0000000, #78#1;
     fHasta, 999999, 9999999, #78#1;
     ;
     NULL, Reservas2;
|FIN;

|PROCESO ServiTempo;
     |SI #0#25 = "S";
          |SI #23#11 ! #0#29; |Y #23#11 ! #0#30; |Y #23#11 ! #0#31;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;

     |SELECT #3#26;
     #26#0 = #50#3;
     #26#4 = #50#6;
     #26#5 = #23#5;
     #26#7 = #50#0;
     |LEE 101#26=;
     |SI FSalida = 0;
          #51#0 = #50#0;
          #51#1 = #50#1;
          #51#2 = 999;
          |LEE 000#51];
          |SI FSalida = 0;
               |LEE 000#51a;
          |SINO;
               |LEE 000#51u;
          |FINSI;
          |SI FSalida = 0; |Y #51#0 = #50#0; |Y #51#1 = #50#1;
               nLin = #51#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #51;
          #51#0 = #50#0;
          #51#1 = #50#1;
          #51#2 = nLin;
          #51#3 = #23#5;
          #51#4 = #26#6
          #51#5 = #26#13;
          #51#6 = #26#14;
          #51#7 = #26#17;
          #51#8 = #26#15;
          #51#9 = #26#16;
          #51#10 = #26#18;
          #51#11 = #26#19;
          #51#12 = #26#26;
          |GRABA 020#51n;
          enForma = 1; |HAZ ActLin;
          |LIBERA #26;
     |FINSI;
|FPRC;

|DEFBUCLE ServiTempo;
     #23#4;
     0;
     #50#23, eaTemporada;
     #50#23, eaTemporada;
     ;
     NULL, ServiTempo;
|FIN;

|PROCESO Masiva1;
     |HAZ BuscaTempo0;
     |SI eaTemporada = "";
          |MENAV "0000No existe temporada...";
          |ACABA;
     |FINSI;

     #50#0 = #0#0;
     #50#1 = 9999;
     |LEE 000#50];
     |SI FSalida = 0;
          |LEE 000#50a;
     |SINO;
          |LEE 000#50u;
     |FINSI;
     |SI FSalida = 0; |Y #50#0 = #0#0;
          nHoja = #50#1 + 1;
     |SINO;
          nHoja = 1;
     |FINSI;

     |SELECT #2#50;
     #50#3 = eaTemporada;
     #50#4 = 999999;
     |LEE 000#50];
     |SI FSalida = 0;
          |LEE 000#50a;
     |SINO;
          |LEE 000#50u;
     |FINSI;
     |SI FSalida = 0; |Y #50#3 = eaTemporada;
          nLin = #50#4 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
     |SELECT #1#50;

     |DDEFECTO #50;
     #50#0 = #0#0;
     #50#1 = nHoja;
     #50#2 = #0#1;
     #50#3 = eaTemporada;
     #50#4 = nLin;
     #50#5 = #0#74;
     #50#6 = #0#2;
     #50#7 = #0#5;
     #50#8 = #0#6;
     #50#9 = #0#3;
     #50#10 = #0#4;
     #50#11 = #0#8;
     #50#12 = #0#9;
     #50#13 = #0#11;
     #50#14 = #0#12;
     #50#15 = #0#14;
     #50#16 = #0#15;
     #50#17 = #0#17;
     #50#18 = #0#18;
     #50#19 = #0#7;
     ||#50#20 =
     #50#21 = #0#20;
     #50#22 = #0#19;
     #50#23 = #0#22;

     ||pob. destino
     #50#24 = #0#45;
     #50#25 = #0#46;
     #50#26 = #0#47;
     #50#27 = #0#48;

     #50#30 = #0#10;
     #50#31 = #0#13;
     #50#32 = #0#16;

     #50#43 = #0#23;
     #50#44 = #0#49;
     #50#45 = #0#83;
     |GRABA 020#50n;
     |BUCLE ServiTempo;

     #22#0 = #0#0;
     #22#1 = #0#1;
     #22#2 = #0#2;
     #22#3 = nHoja;
     |GRABA 020#22n;
|FPRC;

|DEFBUCLE Masiva1;
     #0#1;
     ;
     #78#0, #78#2, #78#1;
     #78#0, #78#3, #78#1;
     ;
     NULL, Masiva1;
|FIN;

|PROCESO Borra51;
     |BORRA 020#51a;

     |SELECT #3#26;
     #26#0 = #50#3;
     #26#4 = #50#6;
     #26#5 = #51#3;
     #26#7 = #50#0;
     |LEE 121#26=;
     |SI FSalida = 0;
          enForma = -1; |HAZ ActLin;
          |LIBERA #26;
     |FINSI;
|FPRC;

|DEFBUCLE Borra51;
     #51#1;
     ;
     #50#0, #50#1, 000;
     #50#0, #50#1, 999;
     be;
     NULL, Borra51;
|FIN;

|PROCESO ReseConfir;
     nOk = 1;
     |SI #52#101 = #50#6; |Y #52#73 = #50#0; |Y #52#74 = #50#1;
          nOk = 0;
     |FINSI;
     |SI #52#102 = #50#6; |Y #52#78 = #50#0; |Y #52#79 = #50#1;
          nOk = 0;
     |FINSI;
     |SI nOk = 0;
          |SI #52#52 = "C";
               aConfir = "S";
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE ReseConfirIda;
     #52#2;
     ;
     #50#0, 000000, 0000000;
     #50#0, 999999, 9999999;
     ;
     NULL, ReseConfir;
|FIN;

|DEFBUCLE ReseConfirVta;
     #52#3;
     ;
     #50#0, 000000, 0000000;
     #50#0, 999999, 9999999;
     ;
     NULL, ReseConfir;
|FIN;

|PROCESO CheqExiste;
     |SI nSw = 0;
          nExiste = 1;
          |BUCLE ReseConfirIda;
          |BUCLE ReseConfirVta;
     |SINO;
          enForma = -1; |HAZ ActCab;
          |BORRA 020#50a;
          |BUCLE Borra51;
     |FINSI;
|FPRC;

|DEFBUCLE CheqExiste;
     #50#1;
     2, 6;
     #78#0, 0000, #78#2, #78#1;
     #78#0, 9999, #78#3, #78#1;
     be;
     NULL, CheqExiste;
|FIN;

|PROCESO NoAsignadas;
     |SI #121#12 = "N"; |O #121#13 = "N";
          |SI nSw = 1;
               nHay = 1; |ERROR10;
          |SINO;
               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE NoAsignadas;
     #121#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, NoAsignadas;
|FIN;

|PROCESO Creacion;
     aConfir = "N";
     nExiste = 0;
     nSw = 0; |BUCLE CheqExiste;

     enErrorBaja = 1;
     |SI nExiste ! 0;
          |SI eaSwBaja = "S";
               aAlfa = "0000N¨Anular hoja  Fecha: " + #0#0 + " Orden: "+#0#1 + " Sentido: " + #0#2 + "?";
               |CONFI aAlfa;
          |SINO;
               |CONFI "0000N¨Las hojas de ruta ya se hab¡an creado, procedemos a su anulaci¢n?";
          |FINSI;
          |SI FSalida ! 0;
               |MENAV "0000Proceso cancelado...";
               |ACABA;
          |FINSI;
          |SI aConfir = "S";
               |CONFI "0000NHay reservas confirmadas, ¨continuar con la anulaci¢n?";
               |SI FSalida ! 0;
                    |MENAV "0000Proceso cancelado...";
                    |ACABA;
               |FINSI;
          |FINSI;
          |ABRE #21;
          |ABRE #26;
          nSw = 1; |BUCLE CheqExiste;   ||Borra
          |CIERRA #21;
          |CIERRA #26;
     |FINSI;
     enErrorBaja = 0;
     |SI eaSwBaja = "S"; |ACABA; |FINSI;

     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm061";
     |CARGA_DEF aAlfa, sctrm061@;
     |ABRE #sctrm061@;

     |HAZ CreaTempo; |NOME_DAT #22 Tempo; |DELINDEX #22; aTmp22 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #121 Tempo; |DELINDEX #121; aTmp121 = Tempo;
     |ABRE #22;

     |ABRE #50;
     |ABRE #51;
     |ABRE #26;
     |ABRE #21;
     |BUCLE Masiva1;
     |CIERRA #21;
     |CIERRA #26;
     |CIERRA #51;
     |CIERRA #50;

     |SI #78#1 = "I";
          fHasta = #78#0 + 1;
          |ABRE #121;
          |ABRE #23;
          |ABRE #3;
          |BUCLE Reservas2;
          |BUCLE Reservas3;
          |CIERRA #3;
          |CIERRA #23;
          |CIERRA #121;

          |ABRE #50;
          |ABRE #52;
          |ABRE #61;
          nSw = 1; |BUCLE Masiva2;
          nSw = 2; |BUCLE Masiva2;
          nSw = 3; |BUCLE Masiva2;
          nSw = 5; |BUCLE Masiva2;
          nSw = 4; |BUCLE Masiva2;
          |CIERRA #61;
          |CIERRA #52;
          |CIERRA #50;
     |FINSI;

     |SI #78#1 = "V";
          fHasta = #78#0 + 1;
          |ABRE #121;
          |ABRE #23;
          |BUCLE Reservas2;
          |BUCLE Reservas3;
          |CIERRA #23;
          |CIERRA #121;

          |ABRE #50;
          |ABRE #52;
          |ABRE #61;
          nSw = 1; |BUCLE Masiva2;
          nSw = 2; |BUCLE Masiva2;
          nSw = 3; |BUCLE Masiva2;
          nSw = 4; |BUCLE Masiva2;
          |CIERRA #61;
          |CIERRA #52;
          |CIERRA #50;
     |FINSI;

     nHay = 0;
     nSw = 1; |BUCLE NoAsignadas;
     |SI nHay = 0;
          |MENAV "0000Asignadas todoas las reservas...";
          FSalida = "1";
     |SINO;
          |CONFI "0000S¨Imprimir reservas no asignadas?";
     |FINSI;
     |SI FSalida = 0;
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "sctrm060";
               |SI FSalida = 0;
                    nSw = 2; |BUCLE NoAsignadas;
                    |PIEINF;
                    |FININF;
               |SINO;
                    |MENAV "0000Error en informe 'sctrm060'...";
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;

     |CIERRA #22;
     Tempo = aTmp121; |DELINDEX #121; |HAZ BoraTempo;
     Tempo = aTmp22; |DELINDEX #22; |HAZ BoraTempo;

     |CIERRA #sctrm061@;
     |DESCARGA_DEF #sctrm061@;
|FPRC;
