|FICHEROS;
     agitp001 #1;
     pcegm005 #5;
     agifa041 #11;
     agifa017 #17;
     agifa019 #19;
     agifa081 #81,MANTE;
     agifa067 #67;
     agifa112 #112;
     agifa142 #142;
     agifa321 #321;
     agifa324 #324;
|FIN;

|VARIABLES;
     &eaPregunta = "";
     &eaPCEAsigna = "";
     &enDocu = 0;
     &eaTipo = "";
     &eaSerie = "";
     &enPedido = 0;
     &enLinea = 0;
     &eaDocu = "";
     &enSwMenu = 0;
     &eaFich = "";
     &eaArticulo = "";
     &enUnidades = 0;
     &aDivisa = "";
     &aMoneda = "";
     &eaConPanta = "";
     aModo = "";
     aSer = "";
     aNum = "";
     fHoy = @;
     aDirEmp = "";
     nCodEmp = 0;
     aDatos = "";
     aAlfa = "";
     fhoy = @;
     &enSWMneu = 0;
|FIN;

|PROCESO Linea;
     |ABRE #1;
     #1#0 = #81#4;
     #1#1 = #19#0;
     |LEE 000#1=;
     |CIERRA #1;

     |DDEFECTO #67;
     #67#28 = #81#25;
     #67#0 = #81#0;
     #67#1 = 1;
     #67#2 = #19#0;
     #67#3 = 1;
     #67#4 = #19#1;
     #67#5 = enUnidades;
     #67#6 = #1#9;
     #67#14 = #19#30;
     #67#18 = #19#2;
     #67#26 = #81#9;
     #67#37 = #67#5;
     |GRABA 020#67n;

     |ABRE #5;
     #5#28 = eaSerie;
     #5#0 = enPedido;
     #5#1 = enLinea;
     |LEE 121#5=;
     |SI FSalida = 0;
          #5#30 = #67#0;
          #5#31 = #67#28;
          #5#32 = #67#1;
          |GRABA 020#5a;
     |FINSI;
     |CIERRA #5;

     eaDocu = "agifa067";
     |HAZ StockEntra;
|FPRC;

|PROCESO Cabecera;
     #81#1 = ~;
     #81#4 = #112#0;
     #81#8 = #112#1;
     #81#9 = #112#17;

     |DFICE aDirEmp;
     |DFICB aDatos;
     aDirEmp = aDirEmp % -205;
     nCodEmp = aDirEmp;
     |PATH_DAT #11 aDatos;
     |ABRE #11;
     #11#0 = nCodEmp;
     |LEE 000#11=;
     |SI FSalida = 0;
          #81#19 = #11#1;
          #81#18 = #11#2;
          #81#20 = #11#3;
          #81#21 = #11#4;
     |FINSI;
     |CIERRA #11;

     |ABRE #324;
     #81#27 = #112#81;
     #324#0 = #81#27;
     |LEE 000#324=;
     #81#28 = #324#3; ||Cambio
     #81#29 = #112#82;
     #81#32 = #321#9;
     #324#0 = #81#32;
     |LEE 000#324=;
     #81#33 = #324#3; ||Cambio
     |CIERRA #324;
     #81#45 = #112#87;

     #81#26 = eaSerie + "/" + (("000000" + enPedido) % -106);
|FPRC;

|PROCESO CreaPedido;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;

     |ABRE #19;
     #19#0 = eaArticulo;
     |LEE 000#19=;
     |CIERRA #19;

     |ABRE #112;
     #112#0 = #19#27;
     |LEE 000#112=;
     |CIERRA #112;

     |ABRE #81;
     |ABRE #67;

     fHoy = ~;
     aAlfa = fHoy;
     aSer = "CAL" + (aAlfa % -102);
     #81#25 = aSer;
     enSwMenu = 1;
     |HAZ ContaPC7;
     |GRABA 040#81b;
     |SI FSalida = 0;
          |HAZ Cabecera;
          |HAZ Linea;

          aDivisa = #81#27;
          aMoneda = #81#29;
          |HAZ CalCabAgifa081;
          |GRABA 020#81a;

          |SI eaConPanta ! "N";
               eaPCEAsigna = "N";
               |CLS;
               |PINPA #0#81;
               |PINDA #0#81;
               |ENDATOS #2#81;
               |SI FSalida = 0;
                    |GRABA 020#81a;
               |FINSI;             || las Etiquetas las imprime el agifa081
          |SINO;
               aAlfa = eaSerie;

               eaSerie = #81#25;
               enDocu = #81#0;
               eaTipo = "PC";
               eaPregunta = "S";
               |SUB_EJECUTA_NP "pcegz019";   || Etiquetas

               eaSerie = aAlfa;
          |FINSI;
     |FINSI;
     |CIERRA #67;
     |CIERRA #81;
|FPRC;

|PROGRAMA;
     |HAZ CreaPedido;
|FPRO;
