|FICHEROS;
     coima022 #22;
     agifa104 #104;
|FIN;

|VARIABLES;
     &enSwPsion = 0;
     aAlfa = "";
     nHandle = 0;
     aFic = "";
     aDjunto = "";
     aTo = "";
     aIP = "";
     aMensaje = "";
     aAsunto = "";
     aServidor = "";
     aFrom = "";
|FIN;

|PROCESO EnviaMail;
     |ABRE #22; |LEE 000#22p; |CIERRA #22;

     |DFICE aAlfa;
     aFic = aAlfa + Usuario + ".txt";
     |XABRE "W", aFic, nHandle;
     aAlfa = "El pedido número:" + #104#25;
     |QBF aAlfa;
     aAlfa = aAlfa + "/" + (("000000" + #104#0) % -106);
     aAlfa = aAlfa + " del cliente:" + #104#4 + ", " + #104#8;
     |QBF aAlfa;
     aAlfa = aAlfa + ", tiene las siguientes observaciones:";
     |XGRABA nHandle, aAlfa;

     |SI enSwPsion = 1;
          aAlfa = #104#15; |XGRABA nHandle, aAlfa;
     |SINO;
          aAlfa = #104#53; |XGRABA nHandle, aAlfa;
          aAlfa = #104#54; |XGRABA nHandle, aAlfa;
          aAlfa = #104#55; |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     aAsunto = "Observaciones Pedido Web";
     aTo = "ventas@coimasa.com";
     aIP = "";
     |SI #22#8 = "L";
          |IP_REMOTO aIP;
     |SINO;
          |SI #22#8 = "S";
               |IP_LOCAL aIP;
          |SINO;
               aIP = #22#7;
          |FINSI;
     |FINSI;
     |QBF aIP;
     aServidor = #22#14; |QBF aServidor;
     aFrom = #22#15; |QBF aFrom;
     aMensaje = "$$$$" + aFic;
     aDjunto = aFic;
     |DSCORREO_ENVIA aIP, aServidor, aFrom, aTo, aAsunto, aMensaje, aDjunto;
     |FBORRA aFic;
|FPRC;
