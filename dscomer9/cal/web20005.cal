|FICHEROS;
     web20005 #0;
     malpe001 #1;
     web20004 #4;
     agifa024 #24;
|FIN;

|VARIABLES;
     &aIdent  = "";
     &aTipo   = "";
     &aCodCli = "";
     nCont = 0;
     nIncluye = 0;
     nExcluye = 0;
     aAlfa1 = "";
|FIN;

|PROCESO ConfEx;
     |SI #0#12 = "N";
           |CAMPO_MODIFICA #0#5, 1, "N";
           |CAMPO_MODIFICA #0#6, 1, "N";
           |CAMPO_MODIFICA #0#7, 1, "N";
           |CAMPO_MODIFICA #0#8, 1, "N";
      |FINSI;
|FPRC;

|PROCESO CompCliente; |TIPO 0;
     |SI #0#11 = "N";
           |CAMPO_MODIFICA #0#1, 1, "N";
           |CAMPO_MODIFICA #0#2, 1, "N";
           |CAMPO_MODIFICA #0#3, 1, "N";
           |CAMPO_MODIFICA #0#4, 1, "N";
           |CAMPO_MODIFICA #0#9, 1, "N";
           |CAMPO_MODIFICA #0#10, 1, "N";
     |SINO;
           |CAMPO_MODIFICA #0#1, 1, "S";
           |CAMPO_MODIFICA #0#2, 1, "S";
           |CAMPO_MODIFICA #0#5, 1, "S";
           |CAMPO_MODIFICA #0#6, 1, "S";
     |FINSI;

     |SI aTipo = "C";
          #0#1 = aCodCli;
          #0#2 = aCodCli;
          #0#5 = aCodCli;
          #0#6 = aCodCli;
          |PINTA #0#1;
          |PINTA #0#2;
          |PINTA #0#5;
          |PINTA #0#6;
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_MODIFICA #0#2, 1, "N";
          |CAMPO_MODIFICA #0#5, 1, "N";
          |CAMPO_MODIFICA #0#6, 1, "N";
     |FINSI;
|FPRC;

|PROCESO web20004;
     |BORRA 020#4a;
     nExcluye = nExcluye + 1;
|FPRC;

|DEFBUCLE web20004;
     #4#1;
     ;
     aIdent,#0#5,#0#7;
     aIdent,#0#6,#0#8;
     e;
     NULL,web20004;
|FIN;

|PROCESO malpe001;
     #24#0 = #1#0;
     |LEE 000#24=;
     |SI FSalida ! 0;   |ACABA;   |FINSI;

     |SI #24#25 < #0#9;|O #24#25 > #0#10;    |ACABA;   |FINSI;
     |SI #24#26 < #0#9;|O #24#26 > #0#10;    |ACABA;   |FINSI;

     #4#0 = aIdent;   ||Identificador
     #4#1 = #1#1;     ||Num. Obra
     #4#4 = #1#0;     ||Cod. Cliente
     |LEE 101#4=;
     |SI FSalida ! 0;
          |GRABA 020#4b;
     |FINSI;
     #4#2 = #1#2;     ||Nombre
     #4#3 = #1#6;     ||Poblacion
     |GRABA 020#4a;
     |LIBERA #4;

     nIncluye = nIncluye + 1;
|FPRC;

|DEFBUCLE malpe001;
     #1#1;
     ;
     #0#1,#0#3;
     #0#2,#0#4;
     e;
     NULL,malpe001;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #0;
     |ABRE #4;
     |ABRE #1;
     |ABRE #24;
     |SI #0#11 = "S" ;
          |BUCLE malpe001;
          aAlfa1 = "0000Se han incluido [" + nIncluye + "] obras.";
          |MENAV aAlfa1;
     |FINSI;
     |SI #0#12 ="S";
          |BUCLE web20004;
          aAlfa1 = "0000Se han excluido [" + nExcluye + "] obras.";
          |MENAV aAlfa1;
     |FINSI;
     |CIERRA #24;
     |CIERRA #0;
     |CIERRA #4;
     |CIERRA #1;
|FPRC;
