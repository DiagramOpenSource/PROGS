|FICHEROS;
     coima004 #0;
     coima002 #2;
|FIN;

|VARIABLES;
     nConta = 0;
     nModo = 0;
|FIN;

|PROCESO Contador; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "coima004";
          |SI FSalida = 0;
               |BUCLELIN 2 Imprime #0;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'coima004'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000N¿Imprimir documento?";
     |SI FSalida = 0; |HAZ Tipo4; |FINSI;
|FPRC;

|PROCESO Min;
     #2#0 = #0#4;
     #2#1 = 00;
|FPRC;

|PROCESO Max;
     #2#0 = #0#4;
     #2#1 = 99;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #2;
     #2#0 = #0#4;
     #2#1 = #0#1;
     |LEE 000#2];
     |CONSULTA_F_CLAVE #1#2, Min, Max;
     |SI FSalida = 0;
          #2#1 = #0#1; |PINTA #2#1;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;
