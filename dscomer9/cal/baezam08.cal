|FICHEROS;
     baezam08 #0;
     baezam15 #15;
|FIN;

|VARIABLES;
     aSerie = "";
     nModo = 0;
     nConta = 0;
     aAlfa = "";
|FIN;

|PROCESO Baeza7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     aSerie = #0#47;
     #0#0 = 999999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida = 0; |Y aSerie = #0#47;
          nConta = #0#0 + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     |DDEFECTO #0;
     #0#47 = aSerie;
     #0#0 = nConta;
|FPRC;

|PROCESO Baeza2; |TIPO 2;
     aAlfa = (("00" + #0#9) % -102) + (("000" + #0#10) % -103);
     #0#11 = aAlfa;
     aAlfa = (("00" + #0#25) % -102) + (("000" + #0#26) % -103);
     #0#27 = aAlfa;
|FPRC;

|PROCESO Baeza3; |TIPO 3;
     |CONFI "0000NImprimir Documento?";
     |SI FSalida = 0;
          |HAZ Baeza4;
     |FINSI;
|FPRC;

|PROCESO Baeza4; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #15;
          #15#0 = #0#47;
          |LEE 000#15=;
          |CIERRA #15;
          aAlfa = #15#1; |QBF aAlfa;
          |INFOR aAlfa;
          |SI FSalida ! 0;
               aAlfa = "0000Error en informe " + aAlfa;
               |MENAV aAlfa;
          |SINO;
               |PRINT;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO CheqFTran; |TIPO 0;
     |SI #0#14 < #0#1;
          |MENAV "0000La fecha no puede ser inferior a la recogida...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO FecRec; |TIPO 0;
     |SI #0#14 = "01.01.0000";
          #0#14 = #0#1; |PINTA #0#14;
     |SINO;
          |SI #0#14 < #0#1;
               |MENAV "0000La fecha no puede ser superior al transporte";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO DefSerie; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #15;
          |SELECT #2#15;
          #15#2 = "S";
          |LEE 000#15=;
          |SI FSalida = 0;
               #0#47 = #15#0;
          |SINO;
               |SELECT #1#15;
               |LEE 000#15p;
               #0#47 = #15#0;
          |FINSI;
          |CIERRA #15;
     |FINSI;
|FPRC;

|PROCESO Serie66; |TIPO 66;
     |ABRE #15;
     #15#0 = #0#47;
     |LEE 000#15];
     |CONSULTA_CLAVE #1#15;
     |SI FSalida = 0;
          #0#47 = #15#0; |PINTA #0#47;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #15;
|FPRC;
