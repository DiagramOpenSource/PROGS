|FICHEROS;
     marhu369 #0;
     refer19@ #1;
     agifa019 #19;
     agifa065 #65;
|FIN;

|VARIABLES;
     nCampo    = 0;
     nUni      = 0;
     nImpo     = 0;
     i         = 0;
     aFecha    = "";
     aFic      = "";
     aAno      = "";
     aDef      = "";
|FIN;

|PROCESO agifa019;
     |DDEFECTO #1;
     #1#0 = #19#0;
     |LEE 101#1=;
     |SI FSalida ! 0;
          #1#1 = #19#1;
          |GRABA 020#1b;
     |FINSI;

     |PARA i = #0#1; |SI i [ #0#2; |HACIENDO i = i + 1;
          nCampo = (i - 1) * 5 + 34;
          nUni = -#19nCampo;
          #1nCampo = #19nCampo;
          #1#94 = #1#94 + #19nCampo;
          nCampo = nCampo + 1;
          nImpo = -#19nCampo;
          #1nCampo = #19nCampo;
          #1#95 = #1#95 + #19nCampo;
          aAno = ("0000" + #0#3) % -104;
          aFecha = "01." + (("00" + i) % -102) + "." + aAno;

          |SI nUni ! 0; |O nImpo ! 0;
               |DDEFECTO #65;
               #65#0 = #19#0;
               #65#1 = aFecha;
               #65#2 = "AV";
               #65#3 = 1;
               #65#4 = 1;
               #65#11 = "-----";
               |LEE 101#65=;
               |SI FSalida ! 0; |GRABA 020#65b; |FINSI;
               #65#5 = 1;
               #65#6 = nUni;
               #65#7 = nUni;
               #65#8 = #19#9;
               #65#9 = nImpo / nUni;
               |GRABA 020#65a;
               |LIBERA #65;
          |FINSI;
     |SIGUE;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE agifa019;
     #19#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa019;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |DBASE aFic;
     aFic = aFic + "fich/" + (("00000" + #0#0) % -105) + "/";
     |PATH_DAT #19 aFic;

     |DDEF aDef;
     aDef = aDef + "agifa019";
     |CARGA_DEF aDef, refer19@;
     |SI FSalida = 0;
          |ABRE #1;
          |ABRE #65;
          |BUCLE agifa019;
          |CIERRA #65;
          |CIERRA #1;
     |SINO;
          aDef = "0000Error al cargar " + aDef;
          |MENAV aDef;
     |FINSI;
|FPRC;
