     ActProdu2, BorProdu2, LeeArti, FormaHora

|FICHEROS;
     gesiz007 #16,MANTE; ||Procesar Aviso

     gesim001 #1;
     gesim006 #6;
     agifa019 #19;
     gesim022 #22;
|FIN;

|VARIABLES;
     &enTecnico = 0;
     &eaProg = "";
     &eaHora = "";
     &eaArti = "";
     &enError = 0;
     nVentana = 0;
 {-1}aVent = "";
     aVent1 = 0;
     aVent2 = 0;
     aVent3 = 0;
     aVent4 = 0;
     aVent5 = "";
     aHora = "";
     aMinu = "";
     nHora = 0;
     nMinu = 0;
     nPan = 0;
     aAlfa = "";
|FIN;

|PROCESO HoraProceso; |TIPO 0;
     |SI #16#20 ! "01.01.0000";
          eaHora = #16#21;
          |HAZ FormaHora;
          #16#21 = eaHora; |PINTA #16#21;
          |SI #16#21 = "00:00"; #16#21 = #1#36; |FINSI;
          |PINTA #16#21;
          |SI #16#21 < #1#36; |O #16#21 > #1#37;
               aAlfa = "0000El horario laboral es desde " + #1#36 + " hasta " + #1#37;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnAgendaProce;
     enTecnico = #16#15;
     eaProg = "gesiz023";
     |HAZ EjecutaProg;
|FPRC;

|PROCESO ProcesaAviso;
     |VENTANA 0909, 2791, -1, 17, "Procesar Aviso";
     nVentana = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PINPA #0#16; nPan = FSalida;
     |PINDA #0#16;
     |CONTROL_SIMPLE nPan, "BOTON,{{135}}Agenda", 1974, 1984, BtnAgendaProce;
     |PARA; |SI; |HACIENDO;
          |ENDATOS #2#16;
          |SI FSalida = 0;
               |SI #16#20 = "01.01.0000"; |O #16#21 = "        ";
                    |MENAV "0000Debe indicar la fecha y hora prevista...";
               |SINO;
                    |SAL;
               |FINSI;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
     enError = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|FICHEROS;
     &refera1@;
     &refera2@;
     &refera3@;
     &referb1@;
     &referb2@;
     &referb3@;
     &referc1@;
     &referc2@;
     &referc3@;
     &referd1@;
     &referd2@;
     &referd3@;
     &referp2@;
     &referp3@;
|FIN;

|PROCESO NoReindexa; || si esto reindexa el gesim007!!!
     #refera3@#0 = #refera2@#0;
     #refera3@#1 = #refera2@#1;
     #refera3@#2 = #refera2@#2;
     #refera3@#3 = 1;
     |LEE 000#refera3@.];

     #referb3@#0 = #referb2@#0;
     #referb3@#1 = #referb2@#1;
     #referb3@#2 = #referb2@#2;
     #referb3@#3 = 1;
     |LEE 000#referb3@.];

     #referc3@#1 = #referc2@#1;
     #referc3@#2 = #referc2@#2;
     #referc3@#3 = #referc2@#3;
     #referc3@#4 = 1;
     |LEE 000#referc3@.];

     #referd3@#1 = #referd2@#1;
     #referd3@#2 = #referd2@#2;
     #referd3@#3 = #referd2@#3;
     #referd3@#4 = 1;
     |LEE 000#referd3@.];

     #referp3@#0 = #referp2@#0;
     #referp3@#1 = #referp2@#1;
     #referp3@#2 = #referp2@#2;
     #referp3@#3 = 1;
     |LEE 000#referp3@.];
|FPRC;

|PROCESO ActProdu2;
     |ABRE #22;
     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 1;    || Desplaza
     |LEE 101#22=;
     |SI FSalida ! 0; |GRABA 020#22b; |FINSI;
     #22#4 = #6#44; eaArti = #22#4; |HAZ LeeArti;
     #22#5 = #19#1;
     #22#6 = #6#45;
     #22#7 = #6#46;
     #22#10 = #6#47;
     #22#11 = #6#49;
     #22#12 = "D";
     #22#13 = #6#39;
     #22#14 = #6#40;
     #22#15 = #6#41;
     #22#16 = #19#9;
     #22#17 = #6#48;
     |GRABA 020#22a;
     |LIBERA #22;

     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 2;    || Mano Obra
     |LEE 101#22=;
     |SI FSalida ! 0; |GRABA 020#22b; |FINSI;
     #22#4 = #6#50; eaArti = #22#4; |HAZ LeeArti;
     #22#5 = #19#1;
     #22#6 = #6#51;
     #22#7 = #6#52;
     #22#10 = #6#53;
     #22#11 = #6#55;
     #22#12 = "O";
     #22#13 = #6#39;
     #22#14 = #6#40;
     #22#15 = #6#41;
     #22#16 = #19#9;
     #22#17 = #6#54;
     |GRABA 020#22a;
     |LIBERA #22;

     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 3;    || Kms
     |LEE 101#22=;
     |SI FSalida ! 0; |GRABA 020#22b; |FINSI;
     #22#4 = #6#56; eaArti = #22#4; |HAZ LeeArti;
     #22#5 = #19#1;
     #22#6 = #6#57;
     #22#7 = #6#58;
     #22#10 = #6#59;
     #22#11 = #6#61;
     #22#12 = "K";
     #22#13 = #6#39;
     #22#14 = #6#40;
     #22#15 = #6#41;
     #22#16 = #19#9;
     #22#17 = #6#60;
     |GRABA 020#22a;
     |LIBERA #22;
     |CIERRA #22;
|FPRC;

|PROCESO BorProdu2;
     |ABRE #22;
     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 1;    || Desplaza
     |LEE 101#22=;
     |SI FSalida = 0; |BORRA 020#22a; |FINSI;
     |LIBERA #22;

     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 2;    || Mano Obra
     |LEE 101#22=;
     |SI FSalida = 0; |BORRA 020#22a; |FINSI;
     |LIBERA #22;

     |DDEFECTO #22;
     #22#0 = #6#0;
     #22#1 = #6#1;
     #22#2 = #6#2;
     #22#3 = 3;    || Kms
     |LEE 101#22=;
     |SI FSalida = 0; |BORRA 020#22a; |FINSI;
     |LIBERA #22;
     |CIERRA #22;
|FPRC;

|PROCESO LeeArti;
     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = eaArti;
     |LEE 000#19=;
     |CIERRA #19;
|FPRC;

|PROCESO FormaHora;
     aHora = eaHora % 102; nHora = aHora; nHora = nHora $ 24;
     aMinu = eaHora % 402; nMinu = aMinu; nMinu = nMinu $ 60;
     eaHora = (("00" + nHora)%-102) + ":" + (("00" + nMinu)%-102);
|FPRC;
