|FICHEROS;
     visem005 #0;
     visem006 #1;
     agifa019 #19;
     agifa017 #17;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enNumero = 0;
     aSerie = "";
     nConta = 0;
     nModo = 0;
     nForma = 0;
     aFab = "";
|FIN;

|PROCESO ContaOrd; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;
     aSerie = #0#0;
     #0#1 = 999999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida = 0; |Y #0#0 = aSerie;
          nConta = #0#1 + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     |DDEFECTO #0;
     #0#0 = aSerie;
     #0#1 = nConta;
|FPRC;

|PROCESO Orden4; |TIPO 4;
     eaSerie = #0#0;
     enNumero = #0#1;
     |SUB_EJECUTA_NP "visez005";
|FPRC;

|PROCESO AcumuArti; |TIPO 2;
     nForma = 0 +. 1;
     |SI #1#11 = "S";
          |SI nForma = -1;
               |MENAV "0000Linea fabricada...";
          |FINSI;
          |ERROR; |ACABA;
     |FINSI;

     || Act Stock
     |ABRE #17;
     |ABRE #19;
     |DDEFECTO #19;
     #19#0 = #1#3;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     |DDEFECTO #17;
     #17#0 = #1#3;
     #17#1 = #1#10;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     #19#13 = #19#13 +. #1#5;
     #17#9 = #17#9 +. #1#5;
     |GRABA 020#17a;
     |GRABA 020#19a;
     |CIERRA #17;
     |CIERRA #19;
|FPRC;

|PROCESO Lineas;
     |SI #1#11 = "S";
          aFab = "S";
     |FINSI;
|FPRC;

|PROCESO Cabecera2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          aFab = "N";
          |BUCLELIN 2Lineas#0;
          |SI aFab = "S";
               |MENAV "0000Hay lineas fabricadas...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;
