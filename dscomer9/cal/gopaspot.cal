|FICHEROS;
     gopaspot #0;
     gopre001 #1;
     goclipon #21;
     agifa024 #24,MANTE;
     agifa027 #27;
     agifa142 #142;
|FIN;

|VARIABLES;
     &enSwAltaCli = 0;
     cont = "";
     contador = 1;
|FIN;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #24;
     #24#0 = #0#2;
     |LEE 000#24];
     |CONSULTA_CLAVE #1#24;
     |CIERRA #24;
     |ERROR;
|FPRC;

|PROCESO PasaCampos;
     #24#1   = #21#2;
     #24#2   = #21#3;
     #24#5   = #21#4; #24#8  = #21#4; #24#11 = #21#4;
     #24#6   = #21#5; #24#9  = #21#5; #24#12 = #21#5;
     #24#7   = #21#6; #24#10 = #21#6; #24#13 = #21#6;
     #24#14  = #21#9;
     #24#15  = #21#1;
     #24#17  = #21#11;
     #24#18  = #21#12;
     #24#178 = #21#7; #24#179 = #21#8; #24#180 = #21#7 + #21#8;
     #24#181 = #21#7; #24#182 = #21#8; #24#183 = #21#7 + #21#8;
     #24#184 = #21#7; #24#185 = #21#8; #24#186 = #21#7 + #21#8;
     #24#196 = #21#13;
     #24#197 = #21#10;
     #24#205 = #21#14;
|FPRC;

|PROCESO ModiPresu;
     #1#41 = "G";
     #1#2 = #24#0;
     #1#3 = #24#2;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE ModiPresu;
     #1#1;
     41, 2;
     "     ", 000001, "P", #0#0;
     "zzzzz", 999999, "P", #0#0;
     be;
     NULL, ModiPresu;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #21;
     #21#0 = #0#0;
     |LEE 000#21=;
     |SI FSalida ! 0;
          |MENAV "0000Cliente potencial inexistente...";
          |ACABA;
     |FINSI;

     |ABRE #24;
     #24#0 = #0#2;
     |LEE  000#24=;
     |SI FSalida = 0;
          |MENAV "0000Cliente general existente...";
     |SINO;
          |GRABA 020#24b;
          |HAZ PasaCampos;
          |PINPA #0#24;
          |PINDA #0#24;
          |ENDATOS #1#24;
          |SI FSalida = 0;
               enSwAltaCli = 1; || Para que funcione el control de empresas
               |GRABA 020#24a;
               |BUCLE ModiPresu;
               |BORRA 020#21a;
          |SINO;
               |BORRA 020#24c;
          |FINSI;
     |FINSI;
     |CIERRA #24;
     |CIERRA #21;
|FPRC;

|PROCESO DefCli; |TIPO 0;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |SI #142#1 = "S"; |Y #0#2 = "      ";
          |ABRE #27
          #27#0 = "clientes";
          |LEE 101#27=;
          |SI FSalida = 0;
               #27#1 = #27#1 + 1;
               contador = #27#1;
               |GRABA 021#27a;
          |SINO;
               contador = 1;
               #27#1 = 1;
               |GRABA 021#27n;
          |FINSI;
          cont = contador;
          cont = ("000000" + cont) % -106;
          #0#2 = cont;
          |CIERRA #27;
     |FINSI;
|FPRC;
