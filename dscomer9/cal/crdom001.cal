|FICHEROS;
     crdom001 #0;
     agifa024 #24;
     agifa060 #60;
     agifa553 #553;
     agifa112 #112;
     referen@;
     crdoz001 #10,MANTE;
|FIN;

|VARIABLES;
     i = 0;
     aAlfa = "";
     nModo = 0;
     aSocio = "";
     aNom = "";
     nOrden = 0;
     fHoy = @;
|FIN;

|PROCESO Fecha; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     |DDEF aAlfa;
     aAlfa = aAlfa + "crdom001";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #0#0;
          #referen@#2 = #0#2;
          |LEE 000#referen@.=;
          |SI FSalida = 0;
               |LEE 000#referen@.a;
               |SI FSalida = 0;
                    aAlfa = "|NC";
                    aAlfa = #0aAlfa;
                    |PARA i = 1; |SI i < aAlfa; |HACIENDO i = i + 1;
                         |SI i ! 2;
                              #0i = #referen@#i#;
                         |FINSI;
                    |SIGUE;
                    |PINDA #0#0;
               |FINSI;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Orden; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aSocio= #0#0;
          aNom = #0#1;
          #0#2 = 999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y #0#0 = aSocio;
               nOrden = #0#2 + 1;
          |SINO;
               nOrden= 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSocio;
          #0#1 = aNom;
          #0#2 = nOrden; |PINTA #0#2;

          fHoy = ~;
          aAlfa = fHoy % 704;
          #0#12 = aAlfa; |PINTA #0#12;
     |FINSI;
|FPRC;

|PROCESO Socio6; |TIPO 6;
     nModo = (FEntrada / 100) ! 0;
     |SI FSalida = 13;
          |ABRE #24;
          #24#0 = #0#0;
          |LEE 000#24];
          |CONSULTA_CLAVE #1#24;
          |SI FSalida = 0;
               #0#0 = #24#0; |PINTA #0#0;
               |SI nModo = 1;
                    #0#1 = #24#1; |PINTA #0#1;
               |FINSI;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #24;
     |SINO;
          |SI nModo = 1;
               |ABRE #24;
               #24#0 = #0#0;
               |LEE 000#24=;
               |SI FSalida = 0;
                    #0#1 = #24#1; |PINTA #0#1;
               |SINO;
                    aAlfa = "*dszx0001;C" + #0#0;
                    |SUB_EJECUTA_NP aAlfa;
                    #24#0 = #0#0;
                    |LEE 000#24=;
                    |SI FSalida = 0;
                         #0#1 = #24#1; |PINTA #0#1;
                    |SINO;
                         |ERROR;
                    |FINSI;
               |FINSI;
               |CIERRA #24;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Variedad; |TIPO 0;
     |ABRE #60;
     #60#0 = #0#10;
     |LEE 000#60=;
     |SI FSalida = 0;
          |PINTA 1922, #60#1;
     |SINO;
          |MENAV "0000No existe c¢digo...";
          |ERROR;
     |FINSI;
     |CIERRA #60;
|FPRC;

|PROCESO Apoyo; |TIPO 0;
     |ABRE #553;
     #553#0 = #0#11;
     |LEE 000#553=;
     |SI FSalida = 0;
          |PINTA 1967, #553#1;
     |SINO;
          |MENAV "0000No existe c¢digo...";
          |ERROR;
     |FINSI;
     |CIERRA #553;
|FPRC;

|PROCESO Tomador; |TIPO 0;
     |ABRE #112;
     #112#0 = #0#15;
     |LEE 000#112=;
     |SI FSalida = 0;
          |PINTA 2425, #112#1;
     |SINO;
          |MENAV "0000No existe c¢digo...";
          |ERROR;
     |FINSI;
     |CIERRA #112;
|FPRC;

|PROCESO T13; |TIPO 13;
     |ABRE #60;
     #60#0 = #0#10;
     |LEE 000#60=;
     |SI FSalida ! 0; |DDEFECTO #60; |FINSI;
     |CIERRA #60;

     |ABRE #553;
     #553#0 = #0#11;
     |LEE 000#553=;
     |SI FSalida ! 0; |DDEFECTO #553; |FINSI;
     |CIERRA #553;

     |C_A #112#1, 1, 60;
     |ABRE #112;
     #112#0 = #0#15;
     |LEE 000#112=;
     |SI FSalida ! 0; |DDEFECTO #112; |FINSI;
     |CIERRA #112;

     |PINTA 1922, #60#1;
     |PINTA 1967, #553#1;
     |PINTA 2425, #112#1;
|FPRC;

|PROCESO T4; |TIPO 4;
     |VENTANA 1130, 1867, -1, 17, "Impresi¢n Parcelas";
     |HAZ PushVenModal;
     #10#0 = #0#0;
     #10#1 = #0#0;
     |PINPA #0#10;
     |PINDA #0#10;
     |ENDATOS #1#10;
     aAlfa = FSalida;
     |HAZ PopVenModal;
     |SI aAlfa = 0;
          |SALVA_DATOS #0;
          |HAZ Imprime;
          |REPON_DATOS #0;
          |LEE 0000#0=;
     |FINSI;
|FPRC;

|PROCESO Impresion;
     |PRINT;
     |PIEINF;
|FPRC;

|DEFBUCLE Impresion;
     #0#1;
     ;
     #10#0, 000;
     #10#1, 999;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "crdom001";
          |SI FSalida = 0;
               |BUCLE Impresion;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO T3; |TIPO 3;
     |CONFI "0000N¨Imprimir registro parcelas?";
     |SI FSalida = 0;
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "crdom001";
               |SI FSalida = 0;
                    |HAZ Impresion;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;
