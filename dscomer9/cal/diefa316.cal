|FICHEROS;
     diefa316 #0;  ||Este Def.
     agifa010 #1;  ||Albaranes (C).
     agifa071 #2;  ||Albaranes (L).
     diefz316 #5;  ||Temporal.
     agifa019 #6;  ||Articulos.
     agifa084 #11; ||Facturas  (C).
     agifa069 #22; ||Facturas  (L).
|FIN;


|VARIABLES;
     &eaArticulo = "";
     aFich = "";
     nSal  = 0;
     nImp  = 0;
     swImp = 0;
     aRep  = "";
     &nTip = 0;
|FIN;

|PROCESO Llena316; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;


|PROCESO diefz316;
     |SI swImp = 0;
          swImp = 1;
          aRep = #5#0;
     |FINSI;
     |SI aRep ! #5#0;
          #0#6 = #0#5 / #0#4;
          #0#8 = ((#0#6 - #0#7)/#0#6)*100;
          |PIEINF;
          #0#4 = 0;
          #0#5 = 0;
          #0#6 = 0;
          #0#7 = 0;
          #0#8 = 0;
          aRep = #5#0;
     |FINSI;
     |PRINT;
     #0#4 = #0#4 + #5#4;
     #0#5 = #0#5 + #5#5;
     #0#7 = #5#7;
|FPRC;

|DEFBUCLE diefz316;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,diefz316;
|FIN;

|PROCESO agifa069;
     |SI #22#2 < #0#0; |O #22#2 > #0#1; |ACABA; |FINSI;
     |DDEFECTO #6;
     #6#0 = #22#2;
     |LEE 000#6=;
     |DDEFECTO #5;
     #5#0 = #22#2;
     #5#1 = #11#3;
     |LEE 000#5=;
     nSal = FSalida;
     #5#2 = #22#4; ||Descripcion Articulo.
     #5#3 = #11#4; ||Nombre Cliente
     #5#4 = #5#4 + #22#5;

     nImp = #22#9 < #11#5;
     nImp = nImp < #11#32;
     nImp = nImp < #11#7;
     #5#5 = #5#5 + nImp;
     #5#6 = #5#5 / #5#4;
     #5#7 = #6#133;
     #5#8 = ((#5#6 - #5#7)/#5#6)*100;
     |SI nSal = 0; |GRABA 020#5a; |FINSI;
     |SI nSal ! 0; |GRABA 020#5n; |FINSI;
|FPRC;

|DEFBUCLE agifa084;
     #11#4;
     ;
     "     ",#0#2,000000;
     "zzzzz",#0#3,999999;
     ;
     NULL,NULL,agifa069;
|FIN;

|PROCESO agifa071;
     |SI #2#2 < #0#0; |O #2#2 > #0#1; |ACABA; |FINSI;
     |DDEFECTO #6;
     #6#0 = #2#2;
     |LEE 000#6=;
     |DDEFECTO #5;
     #5#0 = #2#2;
     #5#1 = #1#3;
     |LEE 000#5=;
     nSal = FSalida;
     #5#2 = #2#4; ||Descripcion Articulo.
     #5#3 = #1#4; ||Nombre Cliente
     #5#4 = #5#4 + #2#5;

     nImp = #2#9 < #1#5;
     nImp = nImp < #1#32;
     nImp = nImp < #1#7;
     #5#5 = #5#5 + nImp;
     #5#6 = #5#5 / #5#4;
     #5#7 = #6#133;
     #5#8 = (#5#6 - #5#7)/(#5#6*100);
     |SI nSal = 0; |GRABA 020#5a; |FINSI;
     |SI nSal ! 0; |GRABA 020#5n; |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #1#4;
     ;
     "     ",#0#2,000000;
     "zzzzz",#0#3,999999;
     ;
     NULL,NULL,agifa071;
|FIN;

|PROCESO ejec; |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |INFOR "diefa316";
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
     aFich = Usuario;
     |NOME_DAT #5 aFich; |ABRE #5; |CIERRA #5; |DELINDEX #5;
     |ABRE #5;
     |ABRE #6;
     |BUCLE agifa010;
     |BUCLE agifa084;
     |CIERRA #5;
     |CIERRA #6;
     |BUCLE diefz316;
     |SI swImp = 1;
          |PIEINF;
     |FINSI;
     |FININF;
     |FINIMP;
     |DELINDEX #5;
|FPRC;
