|FICHEROS;
     desan012 #0;
     desan013 #1,MANTE;
     agifa019 #2;
     agifa081 #3;
     desan004 #4;
     desan003 #5;
     agifa017 #8;
     agifa321 #5;
     agifa324 #6;
     desan045 #45;
     desan023 #23;  ||Tmp Acu. Ventas
     agifa029 #29;
     dsw00063 #63,MANTE;
     agifa065 #65;
     desan001 #110; || Cascos
     desan014 #136; || Documentos
     desan015 #137;
     tempo226 #100; ||Temporal de la estandar
|FIN;

|VARIABLES;
     &eaDSubf = "";
     &eaHSubf = "";
     nDAlma = 0;
     nHAlma = 0;
     fFecha = @;
     nSwRecal = 0;
     &eaProve = "";
     nBtnPrecio = 0;
     nBtnRecal = 0;
     &eaDocu = "";
     &eaDLoca = "";
     &eaHLoca = "";
     &eaFichero = "";
     &eaDArti = "";
     &eaHArti = "";
     &eaDFami = "";
     &eaHFami = "";
     &eaDProv = "";
     &eaHProv = "";
     &enDAlma = 0;
     &enHAlma = 99999;
     nSum = 0;
     i = 0;
     ii = 0;
     nAlma = 0;
     aTempo100 = "";
     aTempo1 = "";
     aTempo63 = "";
     aTempo23 = "";
     &Tempo = "";
     &eaArticulo = "";
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
     stotal = 0;
     sw = 0;
     lin = 0;
     &titulo = "";
     aAlfa = "";
     nReg = 0;
 {-1}Menu = "";
     Menu1 = "2400";
     Menu2 = "1";
     Menu3 = " ";
     Menu4 = "RIGuBC";
     Menu5 = " Repasar ";
     Menu6 = " Imprimir ";
     Menu7 = " Generar ";
     Menu8 = " Guardar ";
     Menu9 = " Borrar ";
     Menu10 = " Cancelar ";
     nHayOfe = 0;
     fHoy = @;
|FIN;

|PROCESO NuevoExi; |TIPO 0;
     |PARA i = 0; |SI i [ 11; |HACIENDO i = i + 1;
          |C_M #0i, 1, "N";
     |SIGUE;
     |PARA i = 13; |SI i [ 22; |HACIENDO i = i + 1;
          |C_M #0i, 1, "N";
     |SIGUE;
     |SI #0#12 = "E";
          |C_M #0#13, 1, "S";
     |SINO;
          |PARA i = 0; |SI i [ 11; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
          |PARA i = 14; |SI i [ 22; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Pendientes; |TIPO 7;
     |ABRE #2;
     #2#0 = #1#0;
     |LEE 000#2=;
     |CIERRA #2;
     |ABRE #8;
     #8#0 = #1#0;
     #8#1 = #1#9;
     |LEE 000#8=;
     |CIERRA #8;
     |ATRI I;
     |PINTA 2217, #8#42;
     |PINTA 2254, #8#43;
     |ATRI 0;
     |SI #2#179 = "S";
          |ATRI I;
          |PINTA 2228, #8#44;
          |PINTA 2266, #8#45;
          |ATRI 0;
     |SINO;
          |PINTA 2227, "            ";
          |PINTA 2265, "            ";
     |FINSI;
|FPRC;

|PROCESO Consulta; |TIPO 11;
     |SI FSalida = 13;   ||F5
          |HAZ BtnPrecio;
     |FINSI;
     |SI FSalida = 14;   ||F6
          eaArticulo = #1#0;
          |SUB_EJECUTA_NP "agifa083;auto";
     |FINSI;
     |SI FSalida = 15;   ||F7;
          aAlfa = "dsz99894;" + #1#0 + (("00000" + #1#9) % -105);
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;
|FPRC;
-------------------------
|PROCESO NuevoReg;
     |LEE 000#137u;
     |SI FSalida = 0;
          #0#13 = #137#0 + 1;
     |SINO;
          #0#13 = 1;
     |FINSI;
     |DDEFECTO #137;
     #137#0 = #0#13;
     #137#1 = ~;
     |HORA aAlfa;
     #137#2 = aAlfa;
     #137#3 = Usuario % 810;
     |GRABA 020#137b;
|FPRC;

|PROCESO GrabaLin;
     |PARA i = 0; |SI i [ 11; |HACIENDO i = i + 1;
          #136i = #1i;
     |SIGUE;
     #136#12 = #137#0;
     |PARA i = 12; |SI i [ 21; |HACIENDO i = i + 1;
          ii = i + 1;
          #136ii = #1i;
     |SIGUE;
     |GRABA 020#136n;
|FPRC;

|DEFBUCLE GrabaLin;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, GrabaLin;
|FIN;

|PROCESO BorraLin;
     |BORRA 020#136a;
|FPRC;

|DEFBUCLE BorraLin;
     #136#1;
     ;
     #137#0, 00001;
     #137#0, 99999;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO Guardar;
     |ABRE #136;
     |ABRE #137;
     |SI #0#13 = 0; || Crea uno nuevo
          |HAZ NuevoReg;
     |SINO;
          #137#0 = #0#13;
          |LEE 101#137=;
          |SI FSalida ! 0; |HAZ NuevoReg; |FINSI;
     |FINSI;
     |BUCLE BorraLin;
     |BUCLE GrabaLin;
     |CIERRA #136;
     |CIERRA #137;
|FPRC;

|PROCESO Borrar;
     |ABRE #137;
     #137#0 = #0#13;
     |LEE 101#137=;
     |SI FSalida = 0;
          aAlfa = "2400NBorrar registro: " + #0#13;
          |CONFI aAlfa;
          |SI FSalida = 0;
               |BUCLE BorraLin;
               |BORRA 020#137a;
          |FINSI;
     |SINO;
          |MENAV "0000No existe el registro...";
     |FINSI;
     |CIERRA #137;
|FPRC;

|PROCESO Min8;
     #8#0 = #1#0;
     #8#1 = 1;
|FPRC;

|PROCESO Max8;
     #8#0 = #1#0;
     #8#1 = 99999;
|FPRC;

|PROCESO ConsuAlma; |TIPO 66;
     |ABRE #8;
     #8#0 = #1#0;
     #8#1 = #1#9;
     |LEE 000#8];
     |CONSULTA_F_CLAVE #1#8, Min8, Max8;
     |SI FSalida = 0;
          #1#9 = #8#1;
          |PINTA #1#9;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO Marca; |TIPO 0;
     |SI #63Campo = Contenido; |Y FSalida = 0;
          |SI #63#2 = "*";
               #63#2 = "";
          |SINO;
               #63#2 = "*";
          |FINSI;
          |GRABA 020#63a;
          |PINTA #63#2;
     |FINSI;
|FPRC;

|PROCESO Min63;
     #63#0 = 1;
|FPRC;

|PROCESO Max63;
     #63#0 = 99999;
|FPRC;

|PROCESO Desglose0; |TIPO 0;
     |SI #0#11 = "S";
          |PUSHV 0501 2380;
          |ENTLINEAL #1#63, 1, 4, 22, 1, Min63, Max63;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Desglose7; |TIPO 7;
     |SI #0#12 = "N";
          |SI #0#10 = 0;
               |C_M #0#11, 1, "S";
          |SINO;
               |C_M #0#11, 1, "N";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO EntraAlm; |TIPO 7;
     |SI #0#12 = "N";
          |SI #0#3 = 3;
               #0#10 = 0; |PINTA #0#10;
               |C_M #0#10, 1, "N";
          |SINO;
               |C_M #0#10, 1, "S";
          |FINSI;
     |FINSI;
|FPRC;

|| ---------- Acumulacion Temporal ------------------;
|CALCULO lisminart;
     #8#0 = #2#0;
     #8#1 = #2#161;
     |LEE 000#8=;
     |SI FSalida = 0;
          nAlma = #2#161;
     |SINO;
          #8#0 = #2#0;
          #8#1 = 1;
          |LEE 000#8];
          |SI FSalida = 0; |Y #8#0 = #2#0;
               nAlma = #8#1;
          |SINO;
               nAlma = 1;
          |FINSI;
     |FINSI;

     |SI #0#3 = 1;        || Sobre Stock Menor Que Minimo
          |SI #2#6 < #2#7;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #2#6;
               #1#3 = #2#8 - (#2#6 + #2#16);
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #2#15;
               #1#9 = nAlma;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
               |LIBERA #1;
          |FINSI;
     |FINSI;
     |SI #0#3 = 2;        || Sobre Stock Menor Que Pendiente Servir
          |SI #2#6 < #2#15;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #2#6;
               #1#3 = #2#15 - #2#6;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #2#15;
               #1#9 = nAlma;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
               |LIBERA #1;
          |FINSI;
     |FINSI;
     |SI #0#3 = 3;        || Sobre Stock Menor Necesidades
          |SI #2#11 > 0;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #2#6;
               #1#3 = #2#11;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #2#11;
               #1#9 = nAlma;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
               |LIBERA #1;
          |FINSI;
     |FINSI;
     |SI #0#3 = 4;        || Sobre Stock Menor Igual Que Minimo
          |SI #2#6 [ #2#7;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #2#6;
               #1#3 = #2#8 - (#2#6 + #2#16);
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #2#15;
               #1#9 = nAlma;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
               |LIBERA #1;
          |FINSI;
     |FINSI;
     |SI #0#3 = 6;
          #23#0 = #2#0;
          |LEE 000#23=;
          |SI FSalida = 0;
               #1#17 = #23#1;
          |SINO;
               #1#17 = 0;
          |FINSI;
          nSum = (#1#17 > #0#20) - (#8#6 + #8#16);
          |SI nSum > 0;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #2#6;
               #1#3 = nSum;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #2#15;
               #1#9 = nAlma;
               #1#11 = #2#209;

               nReg = nReg + 1;
               #1#10 = nReg;
               |GRABA 020#1n;
          |FINSI;
     |FINSI;
|FCAL;

|DEFBUCLE lisminart;
     #2#5;
     2, 3;
     #0#6, #0#0 , #0#4, #0#23;
     #0#7, #0#1 , #0#5, #0#24;
     ;
     NULL, lisminart;
|FIN;

|PROCESO PorAlmacen;
     #2#0 = #8#0;
     |LEE 000#2=;
     |SI FSalida ! 0;
          aAlfa = "0000Articulo [" + #8#0 + "] inexistente...";
          |MENAV aAlfa;
          |ACABA;
     |FINSI;

     |SI #2#2 < #0#4; |O #2#2 > #0#5;   ||Fam
          |ACABA;
     |FINSI;
     |SI #2#3 < #0#23; |O #2#3 > #0#24;   ||SubFam
          |ACABA;
     |FINSI;
     |SI #2#27 < #0#6; |O #2#27 > #0#7; ||Prv
          |ACABA;
     |FINSI;

     |SI #0#3 = 1;        || Sobre Stock Menor Que Minimo
          |SI #8#5 < #8#6;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #8#5;
               #1#3 = #8#7 - (#8#5 + #8#43);
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #8#42;
               #1#9 = #8#1;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #0#3 = 2;        || Sobre Stock Menor Que Pendiente Servir
          |SI #8#5 < #8#42;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #8#5;
               #1#3 = #8#42 - #8#5;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #8#42;
               #1#9 = #8#1;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #0#3 = 3;       || Sobre Stock Menor Necesidades
          |SI #8#50 > 0;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #8#5;
               #1#3 = #8#50;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #8#42;
               #1#9 = #8#1;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #0#3 = 4;        || Sobre Stock Menor Igual Que Minimo
          |SI #8#5 [ #8#6;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #8#5;
               #1#3 = #8#7 - (#8#5 + #8#43);
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #8#42;
               #1#9 = #8#1;
               #1#11 = #2#209;
               |SI #1#3 > 0;
                    nReg = nReg + 1;
                    #1#10 = nReg;
                    |GRABA 020#1n;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #0#3 = 6;
          #23#0 = #2#0;
          |LEE 000#23=;
          |SI FSalida = 0;
               #1#17 = #23#1;
          |SINO;
               #1#17 = 0;
          |FINSI;
          nSum = (#1#17 > #0#20) - (#8#5 + #8#43);
          |SI nSum > 0;
               #1#0 = #2#0;
               #1#1 = #2#1;
               #1#2 = #8#5;
               #1#3 = nSum;
               #1#4 = #2#27;
               #1#5 = #2#28;
               #1#6 = #2#29;
               #1#7 = #2#129;
               #1#8 = #8#42;
               #1#9 = #8#1;
               #1#11 = #2#209;
               nReg = nReg + 1;
               #1#10 = nReg;
               |GRABA 020#1n;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE PorAlmacen;
     #8#1;
     2;
     #0#0, nAlma, #0#14;
     #0#1, nAlma, #0#15;
     ;
     NULL, PorAlmacen;
|FIN;

|PROCESO Almacenes;
     nAlma = #63#0;
     |BUCLE PorAlmacen;
|FPRC;

|DEFBUCLE Almacenes;
     #63#1;
     2;
     000001, "*";
     999999, "*";
     ;
     NULL, Almacenes;
|FIN;

|PROCESO inf;
     #1#10 = 1;
|FPRC;

|PROCESO sup;
     #1#10 = 99999;
|FPRC;

|PROCESO dsm00136;
     |PARA i = 0; |SI i [ 11; |HACIENDO i = i + 1;
          #1i = #136i;
     |SIGUE;
     |PARA i = 12; |SI i [ 21; |HACIENDO i = i + 1;
          ii = i + 1;
          #1i = #136ii;
     |SIGUE;
     nReg = 1;
     |GRABA 020#1n;
|FPRC;

|DEFBUCLE dsm00136;
     #136#1;
     ;
     #0#13, 00001;
     #0#13, 99999;
     ;
     NULL, dsm00136;
|FIN;

|PROCESO Habilita; |TIPO 7;
     |SI #1#13 = " ";
          |ESTADO_CONTROL nBtnPrecio, "DISABLE";
     |SINO;
          |ESTADO_CONTROL nBtnPrecio, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO BtnRecal;
     nSwRecal = 1;
     |PTEC 807;
|FPRC;

|PROCESO BtnPrecio;
     |SI #1#13 = " ";
          |MENAV "0000Articulo sin precios por cantidad...";
     |SINO;
          eaDocu = "desan012";
          eaProve = #1#4;
          eaArticulo = #1#0;
          |HAZ DesanOfeCon;
     |FINSI;
|FPRC;

|PROCESO CargaTempo;
     #1#0 = #100#0;
     #1#1 = #100#1;
     #1#2 = #100#2;
     #1#3 = #100#3;
     #1#4 = #100#4;
     #1#5 = #100#5;
     #1#6 = #100#6;
     #1#7 = #100#7;
     #1#8 = #100#8;
     #1#9 = #100#9;
     #1#10 = #100#10;
     #1#11 = #100#11;
     |GRABA 020#1n;
|FPRC;

|DEFBUCLE CargaTempo;
     #100#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaTempo;
|FIN;

|PROCESO AcuVentas;
     |SI #65#2 = "AV"; |O #65#2 = "BV";
          |SI #65#10 = "999999";
               |ACABA;
          |FINSI;

          #45#1 = #65#0;
          |LEE 000#45=;
          |SI FSalida = 0;
               #23#0 = #45#2;
          |SINO;
               #23#0 = #65#0;
          |FINSI;
          |LEE 101#23=;
          |SI FSalida = 0;
               #23#1 = #23#1 - #65#6;
               |GRABA 020#23a;
          |SINO;
               #23#1 = -#65#6;
               |GRABA 020#23n;
          |FINSI;
          |LIBERA #23;
     |FINSI;
|FPRC;

|DEFBUCLE AcuVentas;
     #65#1;
     10, 5;
     #0#0, #0#18, "  ", 000000, 00000, "     ", #0#21, nDAlma;
     #0#1, #0#19, "zz", 999999, 99999, "zzzzz", #0#22, nHAlma;
     ;
     NULL, AcuVentas;
|FIN;

|PROCESO Ofertas;
     #5#0 = #4#0;
     |LEE 000#5=;
     |SI FSalida = 0; |Y fHoy ] #5#2; |Y fHoy [ #5#3;
          |SI fHoy ] #4#12; |Y fHoy [ #4#13;
               nHayOfe = nHayOfe + 1;
               |SI #1#3 > #4#10;
                    #1#14 = #4#6;
                    #1#15 = #4#8;
                    #1#16 = #4#9;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Ofertas;
     #4#2;
     ;
     #1#4, #1#0, -99999;
     #1#4, #1#0, 99999;
     ;
     NULL, Ofertas;
|FIN;

|PROCESO RellenaMod;
     |DDEFECTO #2;
     #2#0 = #1#0;
     |LEE 000#2=;

     #23#0 = #1#0;
     |LEE 000#23=;
     |SI FSalida = 0;
          #1#17 = #23#1;
     |SINO;
          #1#17 = 0;
     |FINSI;
     #1#12 = #2#28;
     #1#14 = #2#29;
     #1#15 = #2#129;
     #1#16 = #2#209;


     #110#0 = #1#0;
     |LEE 000#110=;
     |SI FSalida = 0;
          #1#14 = 0;
          #1#15 = 0;
          #1#16 = 0;
     |FINSI;

     |DDEFECTO #8;
     #8#0 = #1#0;
     #8#1 = 1;
     |LEE 000#8=;
     #1#20 = #8#5;
     |DDEFECTO #8;
     #8#0 = #1#0;
     #8#1 = 2;
     |LEE 000#8=;
     #1#21 = #8#5;

     |SI #1#4 = "999999"; |O #1#4 = "000000";
          |DDEFECTO #65;
          #65#0 = #2#0;
          #65#1 = "31.12.9999";
          |LEE 000#65];
          |SI FSalida = 0;
               |LEE 000#65a;
          |SINO;
               |LEE 000#65u;
          |FINSI;
          |PARA; |SI FSalida = 0; |Y #65#0 = #2#0; |HACIENDO;
               |SI #65#2 = "AC"; |Y #65#10 ! "999999"; |Y #65#10 ! "      ";
                    #1#4 = #65#10;
                    #1#12 = #65#9;
                    #1#14 = #65#12;
                    #1#15 = #65#13;
                    #1#16 = #65#21;
                    |SAL;
               |FINSI;
               |LEE 000#65a;
          |SIGUE;
     |FINSI;

     nHayOfe = 0;
     |BUCLE Ofertas;
     |SI nHayOfe ] 1;
          #1#13 = "*";
     |SINO;
          #1#13 = "";
     |FINSI;

     |SI #1#4 = "999999";
          |BORRA 020#1a;
     |SINO;
          |GRABA 020#1a;
     |FINSI;
|FPRC;

|DEFBUCLE RellenaMod;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, RellenaMod;
|FIN;

|PROCESO Docu; |TIPO 0;
     |SI #0#12 = "E";
          |ABRE #137;
          #137#0 = #0#13;
          |LEE 000#137=;
          |SI FSalida ! 0;
               |MENAV "0000Registro inexistente...";
               |ERROR;
          |FINSI;
          |CIERRA #137;
     |FINSI;
|FPRC;

|CALCULO lismin;|TIPO 3;
     |HAZ LeeDecimBaseLi;

     |SI #0#10 = 0;
          nDAlma = 1; nHAlma = 99999;
     |SINO;
          nDAlma = #0#10; nHAlma = #0#10;
     |FINSI;
     |ABRE #23;
     |ABRE #45; |SELECT #2#45;
     |SI #0#12 ! "E";
          |BUCLE AcuVentas;
     |FINSI;
     |CIERRA #45;
     |ABRE #110;
     |SI #0#3 = 5; |Y #0#12 ! "E";
          eaDArti = #0#0; eaHArti = #0#1;
          eaDFami = #0#4; eaHFami = #0#5;
          eaDSubf = #0#23; eaHSubf = #0#24;
          eaDProv = #0#6; eaHProv = #0#7;
          |SI #0#10 = 0;
               enDAlma = 1; enHAlma = 99999;
          |SINO;
               enDAlma = #0#10; enHAlma = #0#10;
          |FINSI;
          eaDLoca = #0#14;
          eaHLoca = #0#15;
          eaFichero = aTempo100;
          |SUB_EJECUTA_NP "dsm00243;auto";

          |ABRET #2;
          |ABRET #1;
          |BUCLE CargaTempo;
          |LEE 000#1p;
          |SI FSalida = 0; nReg = 1; |FINSI;
     |SINO;
          |ABRET #1;
          |ABRET #2;

          |SI #0#12 = "E";
               |BUCLE dsm00136;
          |SINO;
               |SI #0#10 = 0;
                    |SI #0#11 = "S";
                         |ABRE #2;
                         |BUCLE Almacenes;
                         |CIERRA #2;
                    |SINO;
                         |ABRE #8;
                         |BUCLE lisminart;
                         |CIERRA #8;
                    |FINSI;
               |SINO;
                    |ABRE #2;
                    nAlma = #0#10;
                    |BUCLE PorAlmacen;
                    |CIERRA #2;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #110;
     |CIERRA #23;

     |SI nReg > 0;
          |ABRE #8;
          |ABRE #65;
          |ABRE #23;
          |ABRE #100;
          |ABRE #5;
          fHoy = ~;
          |SI #0#12 ! "E";
               |BUCLE RellenaMod;  || Rellena campos Tmp segun el modulo
          |FINSI;
          |CIERRA #5;
          |CIERRA #100;
          |CIERRA #23;
          |CIERRA #65;
          |CIERRA #8;

          |PINPA #0#1;

          |CONTROL_SIMPLE 0, "BOTON,Precio por cantidad", 1958, 1978, BtnPrecio;
          nBtnPrecio = FSalida;
          |CONTROL_SIMPLE 0, "BOTON,Recalcular pedido  ", 2058, 2078, BtnRecal;
          nBtnRecal = FSalida;

          |HAZ RecalPedi;

          |PARA; |SI; |HACIENDO;
               |ESTADO_CONTROL nBtnPrecio, "ENABLE";
               |ESTADO_CONTROL nBtnRecal, "ENABLE";
               |SI Menu2 ! 2; |Y Menu2 ! 3; |Y Menu2 ! 4; |Y Menu2 ! 5;
                    |PARA; |SI; |HACIENDO;
                         nSwRecal = 0;
                         |ENTLINEAL #1#1, 1, 2, 17, 0, inf, sup;
                         |SI nSwRecal = 1; |HAZ RecalPedi; |SINO; |SAL; |FINSI;
                    |SIGUE;
               |FINSI;
               |ESTADO_CONTROL nBtnPrecio, "DISABLE";
               |ESTADO_CONTROL nBtnRecal, "DISABLE";
               |MENU Menu;
               Menu2 = FSalida;
               |SI Menu2 = 2;
                    |CONFI "2400SImprimir Listado Minimos (S/N): ";
                    |SI FSalida = 0; |HAZ imprime; |FINSI;
               |FINSI;
               |SI Menu2 = 3;
                    |CONFI "2400NGenerar Pedidos De Compra (S/N): ";
                    |SI FSalida = 0; |SAL; |FINSI;
               |FINSI;
               |SI Menu2 = 4;
                    |HAZ Guardar;
                    |CONFI "2400SImprimir Listado Minimos (S/N): ";
                    |SI FSalida = 0; |HAZ imprime; |FINSI;
               |FINSI;
               |SI Menu2 = 5;
                    |HAZ Borrar;
               |FINSI;
               |SI Menu2 = 6; |SAL; |FINSI;
          |SIGUE;

          |SI Menu2 = 3;
               |HAZ temp226;
          |FINSI;

          |FIN_CONTROL_WINDOWS nBtnPrecio;
          |FIN_CONTROL_WINDOWS nBtnRecal;
     |SINO;
          |MENAV "0000NO HAY ARTICULOS A PROCESAR";
     |FINSI;
     |LIBERA #1;
     |LIBERA #2;
     |CIERRAT #1;
     |CIERRAT #2;
|FCAL;

|CALCULO pro1;
     #1#0 = "";
|FCAL;

|CALCULO pro2;
     #1#0 = "zzzzzzzzzzzzzzzzzzzz";
|FCAL;

|CALCULO impresion;
     |PRINT;
|FCAL;

|DEFBUCLE lisminimp;
     #1#3;
     ;
     INICIO;
     FINAL;
     ;
     NULL,impresion;
|FIN;

|| ---------- Impresion Temporal ------------------;
|CALCULO imprime;
     |IMPRE 1;
     |SI FSalida = 0;
          |INFOR "desan012";
          |SI #0#3 = 1;
            titulo = "LISTADO ARTICULOS BAJO MINIMOS";
          |SINO;
            titulo = "LISTADO ARTICULOS PENDIENTE DE SERVIR";
          |FINSI;
          |BUCLE lisminimp;
          |PIEINF;
          |FININF;
     |SINO;
          |MENAV "0000Impresion cancelada.";
     |FINSI;
     |FINIMP;
|FCAL;

|PROCESO LeeDecimBaseLi;
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9; ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;  ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     |CIERRA #agifa321;
     |CIERRA #agifa324;
|FPRC;

|PROCESO Llena226; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO LlenaAlma;
     #63#0 = #29#0;
     #63#1 = #29#1;
     #63#2 = "*";
     |GRABA 020#63n;
|FPRC;

|DEFBUCLE LlenaAlma;
     #29#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, LlenaAlma;
|FIN;

|PROCESO DefA¤o; |TIPO 7;
     fFecha = ~;
     aAlfa = "01.01." + (fFecha % -104);
     #0#18 = aAlfa; |PINTA #0#18;
|FPRC;

|PROGRAMA;
     |HAZ CreaTempo; aTempo1 = Tempo;
     |HAZ CreaTempo; aTempo63 = Tempo;
     |HAZ CreaTempo; aTempo23 = Tempo;
     |HAZ CreaTempo; aTempo100 = Tempo;
     |NOME_DAT #1 aTempo1; |DELINDEX #1;
     |NOME_DAT #63 aTempo63; |DELINDEX #63;
     |NOME_DAT #23 aTempo23; |DELINDEX #23;
     |NOME_DAT #100 aTempo100; |DELINDEX #100;

     |ABRE #63;
     |BUCLE LlenaAlma;
     |CIERRA #63;

     |MANTE #0;

     |DELINDEX #1; |DELINDEX #63; |DELINDEX #23; |DELINDEX #100;
     Tempo = aTempo1; |HAZ BoraTempo;
     Tempo = aTempo63; |HAZ BoraTempo;
     Tempo = aTempo23; |HAZ BoraTempo;
     Tempo = aTempo100; |HAZ BoraTempo;
|FPRO;
