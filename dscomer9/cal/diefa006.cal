|FICHEROS;
     diefa006 #0;
     diefaw05 #5,MANTE; ||TMP
     diefa007 #7;
     agifa010 #10;
     agifa071 #71;
     agifa073 #73;
     agifa019 #19;
     agifa104 #104;
     agifa024 #24;
|FIN;

|VARIABLES;
     nFalta    = 0;
     &enForma  = 0;
     &aDivisa  = "";
     &aMoneda  = "";
     aAlfa     = "";
     fFecha    = @;
 {-1}menu      = "";
     menu1     = "2400";
     menu2     = "1";
     menu3     = "";
     menu4     = "RAC";
     menu5     = " Revisar ";
     menu6     = " Aceptar ";
     menu7     = " Cancelar ";
     nMult     = 0;
     nImpDiv   = 0;
     nImpo     = 0;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Pedido;
     #73#5 = #5#8;
     #73#43 = #5#8;
     #73#12 = #73#43 - #73#42;

     #73#36 = #5#5;
|FPRC;

|PROCESO Albaran;
     enForma = -1;
     |HAZ AcumulaAV;
     |SI #5#8 = 0;
          |BORRA 020#71a;
     |SINO;
          #71#5 = #5#8;
          ||#71#35 = #5#5;||Bultos
          #71#35 = #5#8;  ||Servidas
          |HAZ TotalLin71;
          |GRABA 020#71a;
          enForma = 1;
          |HAZ AcumulaAV;
     |FINSI;
|FPRC;


|PROCESO Histo;
     nFalta = #5#13 - #5#8;
     |SI nFalta = 0; |ACABA; |FINSI;

     |DDEFECTO #7;
     #7#15 = "A";
     #7#0 = #5#0;
     #7#1 = #5#1;
     #7#2 = #5#2;
     |LEE 101#7=;
     |SI FSalida ! 0; |GRABA 020#7b; |FINSI;
     #7#3 = #5#9;
     #7#4 = #5#3;
     #7#5 = #5#11;
     #7#6 = #5#13;
     #7#7 = #5#8;
     #7#8 = #7#6 - #7#7;
     #7#9 = #71#36;
     #7#10 = #71#8;
     #7#11 = #71#33;
     #7#12 = #71#61;
     #7#13 = "N";
     #7#14 = #5#17;
     #7#16 = #10#83;
     |GRABA 020#7a;
     |LIBERA #7;
|FPRC;

|PROCESO Actualiza;
     |ABRE #10;
     |ABRE #71;
     |ABRE #73;
     |ABRE #104;
     #10#52 = #5#0;
     #10#0 = #5#1;
     |LEE 121#10=;
     |SI FSalida = 0;
          aDivisa = #10#68;
          aMoneda = #10#70;
          |HAZ Divisas010;

          #71#29 = #5#0;
          #71#0 = #5#1;
          #71#1 = #5#2;
          |LEE 121#71=;
          |SI FSalida = 0;
               |HAZ Histo;
               |SI #5#15 ! 0;
                    #73#28 = #5#14;
                    #73#0 = #5#15;
                    #73#1 = #5#16;
                    |LEE 121#73=;
                    |SI FSalida = 0;
                         #104#25 = #5#14;
                         #104#0 = #5#15;
                         |LEE 121#104=;
                         |SI FSalida = 0;
                              |HAZ Albaran;
                              |HAZ Pedido;
                              |HAZ TotalLin73;
                              |GRABA 020#73a;
                              |HAZ CalCabAgifa104;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |HAZ Albaran;
               |FINSI;
          |FINSI;
          |HAZ LimCabAgifa010;
          |BUCLELIN 0 CalCabAgifa010 #10;
          |GRABA 020#10a;
     |FINSI;
     |CIERRA #104;
     |CIERRA #73;
     |CIERRA #71;
     |CIERRA #10;
|FPRC;

|DEFBUCLE Actualiza;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Actualiza;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO agifa071;
     #10#52 = #71#29;
     #10#0 = #71#0;
     |LEE 020#10=;
     |SI FSalida = 0; |Y #10#38 = "N";
          |DDEFECTO #24;
          #24#0 = #10#3;
          |LEE 020#24=;
          |SI #24#189 < #0#6; |O #24#189 > #0#7;  ||RUTA
               |ACABA;
          |FINSI;

          fFecha = #10#57;

          |SI fFecha ] #0#2; |Y fFecha [ #0#3;
               |SI #10#83 ] #0#4; |Y #10#83 [ #0#5;
                    #5#0 = #71#29;
                    #5#1 = #71#0;
                    #5#2 = #71#1;
                    #5#3 = #71#2;
                    #5#4 = #71#4;
                    #5#5 = #71#35;
                    #5#7 = #71#5;
                    #5#6 = #5#7 / #5#5;
                    #5#8 = #5#7;
                    #5#9 = #10#57;
                    #5#10 = #10#83;
                    #5#11 = #10#3;
                    #5#12 = #10#4;
                    #5#13 = #71#5;
                    #5#17 = #10#6;

                    |DDEFECTO #73;
                    #73#28 = #71#31;
                    #73#0 = #71#12;
                    #73#1 = #71#21;
                    |LEE 000#73=;
                    |SI FSalida = 0;
                       ||  #5#13 = #73#5;
                         #5#14 = #73#28;
                         #5#15 = #73#0;
                         #5#16 = #73#1;
                    |FINSI;
                    |GRABA 020#5n;

               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa071;
     #71#3;
     ;
     "   ", #0#0;
     "zzz", #0#1;
     ;
     NULL, agifa071;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI #5#0 = Contenido; |Y FSalida = 0;
          |ENCAMPO #8#5;
          |SI FSalida = 0;
               |GRABA 020#5a;
          |SINO;
               |LEE 000#5=;
          |FINSI;
          |PINTA #5#8;
     |FINSI;
|FPRC;

|PROCESO Conver; |TIPO 0;
     #5#6 = #5#7 / #5#5;
     |PINTA #5#6;
|FPRC;

|PROCESO Min;
     #5#0 = "     ";
     #5#1 = 1;
     #5#2 = 1;
|FPRC;

|PROCESO Max;
     #5#0 = "zzzzz";
     #5#1 = 999999;
     #5#2 = 999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #5 aAlfa; |DELINDEX #5;

     |ABRE #24;
     |ABRE #5;
     |ABRE #10;
     |ABRE #73;
     |BUCLE agifa071;
     |CIERRA #73;
     |CIERRA #10;
     |CIERRA #5;
     |CIERRA #24;

     |PINPA #0#5;
     |PARA; |SI menu2 = 1; |HACIENDO;
          |ENTLINEAL #1#5, -1, 4, 22, 0, Min, Max;
          |MENU menu;
          menu2 = FSalida;
     |SIGUE;
     |SI menu2 = 2;
          |ABRE #7;
          |BUCLE Actualiza;
          |CIERRA #7;
     |FINSI;

     |DELINDEX #5;
|FPRC;
