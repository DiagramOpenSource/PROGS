|FICHEROS;
     agifa035 #0;
     agifa036 #1;
     agifa024 #3;
     agifa038 #13;
     agifa070 #14;
     agifa007 #40;
     dsm00010 #910;
     dsm00053 #53;
     dsm00225 #225;
     dsm00156 #156;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     &eaImpElige = "";
     &eaDoc = "";
     nSwPackList = 0;

     &aMoneda     = "";
     &aDivisa     = "";

     &enCodig     = 0;
     &eaNArticulo = "";
     &enImpo = 0;
     &enPantalla  = 0;

     desde = "                              ";
     hasta = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     indtope = 0;
     ind = 0;
     informe = "";
     &informe1 = "";
     &descrip="";
     &linea=0;
     vacio="";
     &iva1 = 0;
     &iva2 = 0;
     &iva3 = 0;
     &iva4 = 0;
     &iva5 = 0;
     &re1 = 0;
     &re2 = 0;
     &re3 = 0;
     &re4 = 0;
     &re5 = 0;
     &bl  = "                              ";
     &num_ped = 0;
     &ser_ped = "";
     aAlfa = "";
|FIN;

|PROCESO IdiomaArticulo;
     aAlfa = "";
     |ABRE #225;
     #225#0 = #3#205;
     |LEE 000#225=;
     |SI FSalida = 0;
          |ABRE #156;
          #156#0 = #14#2;
          #156#1 = #225#5;
          |LEE 000#156=;
          |SI FSalida = 0;
               aAlfa = #156#2; |QBF aAlfa;
          |FINSI;
          |CIERRA #156;
     |FINSI;
     |CIERRA #225;
|FPRC;

|PROCESO depimpr2;|TIPO 0;
     |SI #910#19 = "S";  |HAZ ElRemate;  |FINSI;
     |PIEINF;
     |FININF;
|FPRC;

|PROCESO xx;
     indtope = 0
     |PARA ind = 6;|SI ind > 0;|HACIENDO ind =ind - 1;
           descrip = #13ind;
           |QBF descrip;
           |SI descrip ! vacio;
               indtope = ind + 1;
               ind     = 0;
           |FINSI;
     |SIGUE;
     |PARA ind = 1;|SI ind < indtope; |HACIENDO ind = ind + 1;
           descrip = #13ind;
           linea   = 0;
           |PRINT;
     |SIGUE;
|FPRC;

|PROCESO impdesam;|TIPO 0;
     |ABRE #13;
     #13#0 = #14#21;
     |LEE 121#13=;
     |SI FSalida = 0;  |HAZ xx;  |FINSI;
     |LIBERA #13;
     |CIERRA #13;
|FPRC;

|PROCESO DesAmpli;
     |DDEFECTO #14;
     #14#3 = 0;      || Almacen
     #14#4 = #53#5;
     descrip = #14#4;
     enSwDA = 1;
     |PRINT;
     enSwDA = 0;
|FPRC;

|DEFBUCLE DesAmpli;
     #53#1;
     ;
     "D", #14#22, #14#0, #14#1, 0001;
     "D", #14#22, #14#0, #14#1, 9999;
     ;
     NULL, DesAmpli;
|FIN;

|PROCESO ImpreNormal;
     |HAZ EsAparecida;
     |SI FSalida = 0;
          eaArticulo = #14#2;
          |HAZ ImpAparecida;
     |FINSI;

     enArtImp = #14#2; |QBF enArtImp;
     descrip  = #14#4;
     linea    = 1;

     |HAZ IdiomaArticulo;
     |SI aAlfa ! "";
          #14#4 = aAlfa;
          descrip = aAlfa;
     |FINSI;

     |PRINT;

     |SALVA_DATOS #14;
     |BUCLE DesAmpli;
     |REPON_DATOS #14;
     |HAZ impdesam;
|FPRC;

|PROCESO ImpreHorizo;
     enArtImp = #14#2; |QBF enArtImp;
     eaTipo      = "DP";
     eaSerie     = #14#22;
     enCodig     = #14#0;
     enLinea     = #14#1;
     eaArticulo  = #14#2;
     eaNArticulo = #14#4;
     enUnidades  = #14#5;
     enPrecio    = #14#6;
     enImpo = #14#25;
     enDto1      = #14#8;
     enDto2      = #14#23;
     |HAZ TrataCompo;
|FPRC;

|PROCESO depimprl;|TIPO 0;
     |SI #910#19 = "N";  |HAZ ImpreNormal;  |FINSI;
     |SI #910#19 = "S";  |HAZ ImpreHorizo;  |FINSI;
|FPRC;

|PROCESO IVAS;
     eaCli = #1#3;
     efFiva = #1#1;
     enTiva = 1; |HAZ IVACli; iva1 = enIva; re1 = enRec;
     enTiva = 2; |HAZ IVACli; iva2 = enIva; re2 = enRec;
     enTiva = 3; |HAZ IVACli; iva3 = enIva; re3 = enRec;
     enTiva = 4; |HAZ IVACli; iva4 = enIva; re4 = enRec;
     enTiva = 5; |HAZ IVACli; iva5 = enIva; re5 = enRec;
|FPRC;

|PROCESO depimpr1;
     eaSerLog = #1#46;
     eaNumLog = (A\("000000" + #1#0) % -106);
     eaTipLog = "DE";
     |HAZ ImprimeLog;

     |SI nSwPackList = 0;
          eaDoc = "DP" + #1#46 + #1#0;
          |HAZ PackListVar;
     |FINSI;

     |HAZ IVAS;

     aDivisa = #agifa036#49;
     aMoneda = #agifa036#51;
     |HAZ Divisas036;

     |SI #3#0 ! #1#3;
         #3#0 = #1#3;
         |LEE 021#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |FINSI;

     |ABRE #40;
     #40#26 = #1#46;
     |LEE 001#40=;
     |SI FSalida ! 0;  |DDEFECTO #40;  |FINSI;
     |CIERRA #40;

     informe = #40#2; |QBF informe;
     informe1 = (informe % 0104) + "5" + (informe % 0603); |QBF informe1;

     |INFOR informe;
     |SI FSalida ! 0; |ERROR10; |FINSI;

     |SI #910#19 = "S";  |HAZ AbreTemporales;  |FINSI;
|FPRC;

|DEFBUCLE agifa036;
     #1#3;
     ;
     #0#0, #0#4, #0#6, #0#2;
     #0#1, #0#5, #0#7, #0#3;
     e;
     NULL, depimpr1, depimprl, depimpr2;
|FIN;

|PROCESO Tipo3;
     |IMPRE 1;
     eaImpElige = Impresora;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #3;

     |BUCLE agifa036;

     |CIERRA #3;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |HAZ MiraLogos; || Copia Logos para el Crystal

     |HAZ EsPackList;
     nSwPackList = FSalida;

     enPantalla  = 0;

     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI ser_ped = ""; |Y num_ped = 0;
         |CLS;
         |CABEZA "Imp.Depositos";
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;  |HAZ Tipo3;  |FINSI;
     |SINO;
         #0#6 = ser_ped;
         #0#7 = ser_ped;
         #0#2 = num_ped;
         #0#3 = num_ped;
         |HAZ Tipo3;
     |FINSI;
|FPRO;
