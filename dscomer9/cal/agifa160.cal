               ||Cambio de codigos de Subfamilia

|FICHEROS;
     agifa160 #0;
     agifa120 #15;       ||Familias
     agifa019 #1;        ||Articulos
     agifa154 #20;       ||Linas Ajuste Articulos
|FIN;

|VARIABLES;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     &CambDesc = "";
     &AltaArt  = "";

     i = 0;
     &tabla = 0;
     &sust = " ";
     &stock = " ";
     &tipo = " ";
     fam = "";
     fam1 = "";
|FIN;

|PROCESO copiafam;
     |ABRE #15;
     #15#0 = fam;
     |LEE  001#15=;
     |SI FSalida = 0;
          |SI sust = "S";
               |BORRA 021#15a;
          |FINSI;
     |FINSI;
     #15#0 = fam1;
     |SI CambDesc = "S"; #15#1 = #20#5; |FINSI;
     |SI AltaArt = "S";
          |GRABA 000#15n;
          |SI FSalida ! 0;
               enErr = FSalida;
               eaFic = "agifa120";
               eaOrg = fam;
               eaDes = fam1;
               |HAZ Print;
          |FINSI;
     |FINSI;
     |LIBERA #15;
     |CIERRA #15;
|FPRC;

|PROCESO arti;
     #1#3 = fam1;
     |GRABA 021#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE articulo;
#1#1;
3;
"                    " , fam;
"zzzzzzzzzzzzzzzzzzzz" , fam;
be;
NULL , arti;
|FIN;

|PROGRAMA;
     |HAZ bucleini;
|FPRO;

|PROCESO empieza;
     fam = #20#2 % 105;  ||antiguo
     fam1 = #20#3 % 105; ||nuevo
     #0#0 = fam;
     #0#1 = fam1;
     |PINTA #0#0; |PINTA #0#1;
     |HAZ copiafam;
     |SI sust = "S";          ||Si es sustituir, debo hacerlo en donde haya
          |BUCLE articulo;    ||Articulos
     |FINSI;
|FPRC;

|DEFBUCLE primero;
#20#1;
6;
tabla ,     0, tipo;
tabla , 99999, tipo;
e;
NULL , empieza;
|FIN;

|PROCESO bucleini;
     |PINPA #0#0;
     |BUCLE primero;
     |HAZ EnviaMail;
|FPRC;
