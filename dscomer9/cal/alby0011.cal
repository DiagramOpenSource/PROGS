|FICHEROS;
     alby0011 #0;

     albm0046 #46;       ||Art./Alm./PartidaCAB
     agifa112 #112;      ||Proveedores
     agifa019 #19;       ||Articulos
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";
     aInforme = "";
     nSwPie = 0;
     aArticulo = "";
     aAlfa = "";

     &enUd1 = 0;
     &enUd2 = 0;

     &eaProAnt = "";
     &eaArtAnt = "";
     &eaDesPro = "";
     &eaDesArt = "";
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          aRespuesta = #alby0011#20;
          #alby0011#20 = "NO";
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |SI aRespuesta = "SI";
               |HAZ Principal;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO albm0046;
     ||Quito lo que no cumpla los requisitos.

     |DDEFECTO #agifa019;
     #agifa019#0 = #albm0046#0;
     |LEE 000#agifa019.=;

     |SI #agifa019#125 < #alby0011#5; |O #agifa019#125 > #alby0011#6;
          |ACABA;
     |FINSI;

     aArticulo = #albm0046#0;
     aAlfa = aArticulo % 102;
     |SI aAlfa < #alby0011#7; |O aAlfa > #alby0011#8;
          |ACABA;
     |FINSI;

     aAlfa = aArticulo % 302;
     |SI aAlfa < #alby0011#9; |O aAlfa > #alby0011#10;
          |ACABA;
     |FINSI;

     aAlfa = aArticulo % 504;
     |SI aAlfa < #alby0011#11; |O aAlfa > #alby0011#12;
          |ACABA;
     |FINSI;

     aAlfa = aArticulo % 901;
     |SI aAlfa < #alby0011#13; |O aAlfa > #alby0011#14;
          |ACABA;
     |FINSI;

     aAlfa = aArticulo % 1002;
     |SI aAlfa < #alby0011#15; |O aAlfa > #alby0011#16;
          |ACABA;
     |FINSI;

     aAlfa = aArticulo % 1202;
     |SI aAlfa < #alby0011#17; |O aAlfa > #alby0011#18;
          |ACABA;
     |FINSI;

     |DDEFECTO #agifa112;
     #agifa112#0 = #albm0046#3;
     |LEE 000#agifa112.=;

     |SI #alby0011#19 = "D";
          |PRINT;
          nSwPie = 1;
     |SINO;
          |SI #albm0046#3 ! eaProAnt; |O #albm0046#0 ! eaArtAnt;
               |SI eaProAnt ! "-1"; |Y eaArtAnt ! "-1";
                    |PRINT;
                    nSwPie = 1;
                    enUd1 = 0;
                    enUd2 = 0;
                    |SI #albm0046#3 ! eaProAnt;
                         eaProAnt = #albm0046#3;
                         eaDesPro = #agifa112#1;
                    |FINSI;
                    |SI #albm0046#0 ! eaArtAnt;
                         eaArtAnt = #albm0046#0;
                         eaDesArt = #agifa019#1;
                    |FINSI;
               |SINO;
                    eaProAnt = #albm0046#3;
                    eaArtAnt = #albm0046#0;
                    eaDesPro = #agifa112#1;
                    eaDesArt = #agifa019#1;
               |FINSI;
          |FINSI;
     |FINSI;

     enUd1 = enUd1 + #albm0046#31;
     enUd2 = enUd2 + #albm0046#32;
|FPRC;

|DEFBUCLE albm0046;
 #albm0046#4;
 ;
 #alby0011#3, #alby0011#1;
 #alby0011#4, #alby0011#2;
 ;
 NULL, albm0046;
|FIN;

|PROCESO Principal;
     |IMPRE 0;
     |SI FSalida = 0;
          |SI #alby0011#19 = "D";
               aInforme = "alby0011";
          |SINO;
               eaProAnt = "-1";
               eaArtAnt = "-1";
               aInforme = "albyr011";
          |FINSI;
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #agifa112;
               |ABRE #agifa019;
               |BUCLE albm0046;
               |CIERRA #agifa019;
               |CIERRA #agifa112;
               |SI #alby0011#19 = "R"; |Y eaProAnt ! "-1";
                    |PRINT;
                    nSwPie = 1;
               |FINSI;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;
