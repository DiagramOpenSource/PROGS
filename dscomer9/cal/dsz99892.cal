|FICHEROS;
     referen@ #99;
|FIN;

|VARIABLES;
     aPath = "";
     aDef = "";
     aSerie = "";
     aDatos = "";
     aEmp = "";
     nEmp = 0;
     aNumero = "";
     &enEmpresaOriClon = 0;
     &eaSerieOriClon = "";
     &enNumFraOriClon = 0;
|FIN;

|PROCESO PonContabilizadoSIClon;
     ||Primero miro si estoy en alba.
     |DBASE aPath;
     aDef = aPath + "bin/iber0001.tab";
     |XABRE "E", aDef, 0;
     |SI FSalida ] 0;
          ||CCC. ATENCION
          ||COMENTAR EL ACABA, PARA PRUEBAS EN ALBA
          ||ACABA;
     |FINSI;

     ||Ahora miro si tengo instalado Artenvas
     |DBASS aPath;
     aDef = aPath + "edi/def/artfacca.mas";
     |XABRE "E", aDef, 0;
     |SI FSalida ] 0;
          |CARGA_DEF aDef, referen@;
          |SI FSalida ! 0;
               |ACABA;
          |FINSI;
          aEmp = ("00" + enEmpresaOriClon) % -102;
          aDatos = aPath + "edi/fich/" + aEmp + "/";
          |PATH_DAT #99 aDatos;
          |ABRE #99;
          aSerie = eaSerieOriClon % 102;
          #99#0 = aSerie;
          #99#1 = enNumFraOriClon;
          |LEE 101#99.=;
          |SI FSalida = 0;
               #99#101 = "S";
               |GRABA 020#99.a;
               |LIBERA #99;
          |FINSI;
          |CIERRA #99;
          |DESCARGA_DEF #referen@;
     |FINSI;

     ||Tambien miro a ver si tengo instalado COMPAQ.
     |DBASS aPath;
     aDef = aPath + "compaq4/def/agifa134.mas";
     |XABRE "E", aDef, 0;
     |SI FSalida ] 0;
          |CARGA_DEF aDef, referen@;
          |SI FSalida ! 0;
               |ACABA;
          |FINSI;
          |DFICE aEmp;
          aEmp = aEmp % -205;
          nEmp = aEmp;
          aEmp = ("00" + nEmp) % -102;
          aDatos = aPath + "compaq4/fich/" + aEmp + "/";
          |PATH_DAT #99 aDatos;
          |ABRE #99;
          aSerie = eaSerieOriClon % 102;
          #99#49 = aSerie;
          aNumero = ("000000" + enNumFraOriClon) % -106;
          #99#0 = aNumero;
          |LEE 101#99.=;
          |SI FSalida = 0;
               #99#48 = "S";
               |GRABA 020#99.a;
               |LIBERA #99;
          |FINSI;
          |CIERRA #99;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
