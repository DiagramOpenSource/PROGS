|FICHEROS;
 ortig002 #0;
 ortig001 #1;
 agifa019 #2;
 ortig004 #3;
 agifa321 #4;
 agifa324 #5;
|FIN;

|VARIABLES;
 mater = "";
 nModo = 0;
 &nDeci_prebase = 0;
 &nDeci_impbase = 0;
 &nDeci_PreBase = 0;
|FIN;

|CALCULO mayus;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FCAL;

|CALCULO metros;
 |SI #0#9 = "2";
   #0#10 = #1#2 + #1#3;
 |FINSI;
 |SI #0#9 = "L";
   #0#10 = #1#2;
 |FINSI;
 |SI #0#9 = "A";
   #0#10 = #1#3;
 |FINSI;
 |SI #0#9 = "N";
   #0#10 = 1;
 |FINSI;
 |SI #0#9 = "F";
   #0#10 = (#1#2 * #1#3)+(#1#3*#0#3);
 |FINSI;
 |SI #0#9 ! "F"; ||NO ES FORMULA
   #0#10 = #0#10 * #0#2 * #0#3;
 |SINO;
   #0#10 = #0#10 * #0#2;
 |FINSI;
 |PINTA #0#10;
 |HAZ importe;
|FCAL;

|CALCULO importe;
 #0#12 = #0#10 * #0#4;
 #0#6  = #0#12 > #0#5;
 |SI #0#6 < #0#14;
   #0#6 = #0#14;
 |FINSI;
 |SI #0#6 ! 0;
  |PINTA #0#6;
|FINSI;
|FCAL;

|CALCULO precio;
 |ABRE #2;
 #2#0 = #0#11;
 |LEE 010#2=;
 |SI FSalida ! 0;|DDEFECTO #2;|FINSI;
 |LIBERA #2;
 |CIERRA #2;
 #0#4 = #2#133;
 |SI #2#189 ! 0;
   #0#4 = #2#133 / #2#189;
 |FINSI;
 |PINTA #0#4;
|FCAL;

|CALCULO material;|TIPO 7;
 #0#11 = mater;
 |PINTA #0#11;
|FCAL;

|CALCULO tipo2;|TIPO 2;
 #1#13 = #1#13 +. #0#6;
 #1#12 = #1#12 +. #0#12;
 || #1#5 = #1#13 + (#1#9>#0#5);
 #1#5 = #1#13 + #1#9;
 #1#8 = #1#12 + #1#9;
 |PINTA #1#5;
 |PINTA #1#8;
 |ABRE #3;
 #3#0 = #0#8; ||MODELO
 #3#1 = #0#11; ||MATERIAL
 |LEE 010#3=;
 |SI FSalida ! 0;
   |CDEFECTO #3,1;
   |GRABA 010#3b;
   |LIBERA #3;
 |FINSI;
 nModo = (FEntrada/100)!0;
 |SI nModo = 1;|O nModo = 2;
    #3#2 = #3#2 +. #0#10;
    |GRABA 010#3a;
 |FINSI;
 |SI nModo = 3;
   |BORRA 010#3a;
 |FINSI;
 |LIBERA #3;
 |CIERRA #3;
|FCAL;

|PROCESO desde;
 #3#0 = #0#8;
 #3#1 = "                    ";
|FPRC;

|PROCESO hasta;
 #3#0 = #0#8;
 #3#1 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|CALCULO tecla;|TIPO 11;
|SI FSalida = 10;
  |PUSHV 0501 2380;
  |ENTLINEAL #1#3,1,4,15,1,desde,hasta;
  |POPV;
|FINSI;
|FCAL;
