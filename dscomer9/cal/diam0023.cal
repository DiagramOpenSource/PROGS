|FICHEROS;
     diam0023 #23;
     diam0025 #25;
|FIN;

|VARIABLES;
     nBoton1      = 0;

     aBase        = "";
     aDirPdf      = "";
     aFichero     = "";
     aAbre        = "";
     aOrigen      = "";
     aDestino     = "";
     aIPRemoto    = "";
|FIN;

|PROCESO Boton1;
     aOrigen  = "C:\DOCUMENTOS";           |RMKDIR aOrigen;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBF aIPRemoto;

     |DBASE aBase;  |QBT aBase;
     aFichero = #25#0 + ".pdf";  |QBT aFichero;
     aDirPdf  = aBase + "000577/pdfofertas/" + (("00000" + #48#0) % -105) + "/";
     aDestino = aOrigen + "/" + aFichero;
     aOrigen  = aDirPdf + aFichero;
     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |SI FSalida = 0;
         |RSYSTEM aDestino;
         |RFBORRA aDestino;
     |FINSI;
|FPRC;

|PROCESO Tipo14;  |TIPO 14;
     |ABRE #25;
     #25#0 = #23#2;
     |LEE 000#25=;
     |SI FSalida ! 0;  |DDEFECTO #25;  |FINSI;

     |SI #25#4 = "S";
         |ESTADO_CONTROL nBoton1, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton1, "DISABLE";
     |FINSI;
     |CIERRA #25;
|FPRC;

|PROCESO Tipo8;  |TIPO 8;
     |CONTROL_SIMPLE 0, "BOTON,{{217}} Ver Documento ", 0660, 0673, Boton1;
     nBoton1 = FSalida;

     |ESTADO_CONTROL nBoton1, "DISABLE";
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
     |FIN_CONTROL_WINDOWS nBoton1;
     |PULSATECLA;
|FPRC;
