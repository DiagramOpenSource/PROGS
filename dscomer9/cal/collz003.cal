|FICHEROS;
     collz003 #0;
     collm001 #1;
     collm003 #3;
     collm007 #7;
     collm008 #8;
     collm011 #11;
|FIN;

|VARIABLES;
     fFecha = @;
     aAlfa = "";
     nPrime = 0;
     nInfor = 0;
     nImpre = 0;
     aFecha = "";
     fDesde = @;
     fHasta = @;
     nLeeAnt = 0;
     fFecAnt = 0;
|FIN;

|PROCESO Imprime;
     |SI nPrime = 0;
          nPrime = 1;
          |IMPRE 0;
          nImpre = FSalida;
          |SI FSalida = 0;
               |INFOR "collz003";
               nInfor = FSalida;
               |SI FSalida ! 0;
                    |MENAV "0000Error en informe 'collz003'";
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nImpre = 0; |Y nInfor = 0;
          |PRINT;
     |FINSI;
|FPRC;

|PROCESO Contador;
     aFecha = "01." + (("00" + #0#2)%-102) + "." + (("0000" + #0#3)%-104)
     fFecha = aFecha;

     aAlfa = "01." + (#8#4 % -107);
     fDesde = aAlfa;

     aAlfa = "01." + (#8#5 % -107);
     fHasta = aAlfa;

     |SI fFecha ] fDesde; |Y fFecha [ fHasta;
          |SELECT #5#11;
          |DDEFECTO #11;
          #11#0 = #8#0;
          #11#1 = #0#1;
          #11#2 = #8#1;
          #11#3 = #8#3;
          #11#5 = #0#3;
          #11#4 = #0#2;
          |LEE 101#11];
          |SI FSalida = 0;
               |LEE 000#11a;
          |SINO;
               |LEE 000#11u;
          |FINSI;
          |SI FSalida = 0; |Y #11#0 = #8#0;  |Y #11#2 = #8#1;
                    |Y #11#3 = #8#3;
               nLeeAnt = #11#8;
               fFecAnt = #11#9;
          |SINO;
               nLeeAnt = #8#6;
               fFecAnt = #8#4;
          |FINSI;
          |SELECT #1#11;
          |DDEFECTO #11;
          #11#0 = #8#0;
          #11#1 = #0#1;
          #11#2 = #8#1;
          #11#3 = #8#3;
          #11#5 = #0#3;
          #11#4 = #0#2;
          |LEE 101#11=;
          |SI FSalida ! 0; |GRABA 020#11b; |FINSI;

          |DDEFECTO #3;
          #3#0 = #11#3;
          |LEE 000#3=;

          #11#13 = #3#4;
          |SI #11#8 = 0;
               #11#6 = nLeeAnt;
               #11#7 = fFecAnt;
               |GRABA 020#11a;
          |SINO;
               |HAZ Imprime;
          |FINSI;
          |LIBERA #11;
     |FINSI;
|FPRC;

|DEFBUCLE Contador;
     #7#1;
     ;
     #0#0, "      ";
     #0#0, "zzzzzz";
     ;
     NULL, NULL, Contador;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #11;
     |ABRE #3;
     |BUCLE Contador;
     |CIERRA #3;
     |CIERRA #11;
     |SI nPrime ! 0;
          |SI nInfor = 0; |PIEINF; |FININF; |FINSI;
          |SI nImpre = 0; |FINIMP; |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     #0#1 = #1#1;
     fFecha = ~;
     aAlfa = fFecha % 402;
     #0#2 = aAlfa;
     aAlfa = fFecha % 704;
     #0#3 = aAlfa;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
