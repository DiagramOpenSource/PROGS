|FICHEROS;
     ialbz024 #0;
     ialbw003 #3;   || tmp Impresion
     ialbm004 #4;
     ialbm005 #5;
     ialbm009 #9;
     ialbm010 #10;
     agifa019 #19;
     ialbm017 #17;
     ialbm023 #23;
     agifa024 #24;
     agifa071 #71;
     agifa010 #110;
     ialbm019 #119;
|FIN;

|VARIABLES;
     &Tempo = "";
     aDMatri = "";
     aHMatri = "";
     aAlfa = "";
     i = 0;
     nLinProdu = 0;
     nLinAlba = 0;
|FIN;

|PROCESO Tmp;
     |DDEFECTO #24;
     #24#0 = #3#0;
     |LEE 000#24=;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Productos;
     nLinProdu = nLinProdu + 1;
     |SI nLinProdu = nLinAlba;
          #3#13 = #119#10;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE Productos;
     #119#1;
     ;
     #17#0, #17#1, 001, 001;
     #17#0, #17#1, 999, 999;
     ;
     NULL, Productos;
|FIN;

|PROCESO LinAlba1;
     nLinAlba = nLinAlba + 1;
     |DDEFECTO #3;
     #3#0 = #17#5;
     #3#1 = #17#22;
     #3#2 = 3;
     #3#3 = #71#29;
     #3#4 = #71#0;
     #3#5 = #71#1;
     #3#6 = #71#2;
     #3#7 = #71#4;
     #3#8 = #110#1;
     #3#11 = #71#5;
     #3#13 = #71#9;
     |SI #3#13 = 0;
          nLinProdu = 0;
          |BUCLE Productos;
     |FINSI;
     #3#14 = #17#0;
     #3#15 = #17#1;
     #3#16 = #71#6;
     #3#17 = #110#67;
     |GRABA 000#3n;
|FPRC;

|PROCESO RelacionAlba;
     #110#52 = #23#2;
     #110#0 = #23#3;
     |LEE 000#110=;
     |SI FSalida = 0;
          |SI #110#3 ] #0#0; |Y #110#3 [ #0#1;
               |SI #110#1 ] #0#2; |Y #110#1 [ #0#3;
                    nLinAlba = 0;
                    |BUCLELIN 2 LinAlba1 #110;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RelacionAlba;
     #23#1;
     ;
     #17#0, #17#1, 0;
     #17#0, #17#1, 999;
     ;
     NULL, RelacionAlba;
|FIN;

|PROCESO Avisos;
     |BUCLE RelacionAlba;
|FPRC;

|DEFBUCLE Avisos;
     #17#2;
     22;
     #0#0, "   ", 00000, "     ", 000001, aDMatri;
     #0#1, "zzz", 99999, "zzzzz", 999999, aHMatri;
     ;
     NULL, Avisos;
|FIN;

|PROCESO Cartones;
     |SI #0#2 ] #10#7; |Y #0#3 [ #10#8;
          |DDEFECTO #9;
          #9#0 = #10#1;
          |LEE 000#9=;
          |DDEFECTO #3;
          #3#0 = #10#1;
          #3#1 = #10#4;
          #3#2 = 2;
          #3#5 = #10#0;
          #3#6 = #10#2;
          #3#7 = #10#3;
          #3#9 = #10#7;
          #3#10 = #10#8;
          #3#13 = #10#11;
          #3#16 = 0;
          #3#17 = #10#11;
          |GRABA 000#3n;
     |FINSI;
|FPRC;

|DEFBUCLE Cartones;
     #10#3;
     ;
     #0#0, aDMatri, "                    ";
     #0#1, aHMatri, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, Cartones;
|FIN;

|PROCESO LinAlba0;
     |DDEFECTO #19;
     #19#0 = #5#2;
     |LEE 000#19=;

     |DDEFECTO #3;
     #3#0 = #5#0;
     #3#1 = #5#1;
     #3#2 = 1;
     #3#3 = #71#29;
     #3#4 = #71#0;
     #3#5 = #71#1;
     #3#6 = #5#2;
     #3#7 = #19#1;
     #3#8 = #5#8;
     #3#11 = #71#5;
     #3#12 = #5#4;
     #3#13 = #71#9;
     #3#16 = #71#6;
     #3#17 = #110#67;
     |GRABA 000#3n;
|FPRC;

|PROCESO FotocopiaLin;
     |SI #5#8 ] #0#2; |Y #5#8 [ #0#3;
          #110#52 = #5#5;
          #110#0 = #5#6;
          |LEE 000#110=;
          |SI FSalida = 0;
               |SI #110#3 ] #0#0; |Y #110#3 [ #0#1;
                    |DDEFECTO #9;
                    #9#0 = #4#0;
                    |LEE 000#9=;
                    |BUCLELIN 2 LinAlba0 #110;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Fotocopias;
     #4#1;
     ;
     #0#0, aDMatri, "                    ";
     #0#1, aHMatri, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, NULL, FotocopiaLin;
|FIN;

|PROCESO ModiMatri; |TIPO 7;
     aAlfa = #0#4 + #0#5; |QBF aAlfa;
     |SI aAlfa = "";
          |C_M #0Campo, 1, "S";
     |SINO;
          |C_M #0Campo, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "ialbz024";
          |SI FSalida = 0;
               |HAZ CreaTempo; |NOME_DAT #3 Tempo; |DELINDEX #3;
               |ABRE #3;
               |ABRE #9;
               |ABRE #19;
               |ABRE #110;
               aAlfa = #0#4 + #0#5; |QBF aAlfa;
               |SI aAlfa = "";
                    |PARA i = 6; |SI i [ 15; |HACIENDO i = i + 1;
                         aDMatri = #0i;
                         aHMatri = #0i;
                         |BUCLE Fotocopias;
                         |BUCLE Cartones;
                         |BUCLE Avisos;
                    |SIGUE;
               |SINO;
                    aDMatri = #0#4;
                    aHMatri = #0#5;
                    |BUCLE Fotocopias;
                    |BUCLE Cartones;
                    |BUCLE Avisos;
               |FINSI;
               |CIERRA #110;
               |CIERRA #19;
               |CIERRA #9;
               |CIERRA #3;

               |ABRE #24;
               |BUCLE Tmp;
               |CIERRA #24;

               |HAZ BoraTempo; |DELINDEX #3;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
