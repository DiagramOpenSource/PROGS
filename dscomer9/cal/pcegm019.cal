|FICHEROS;
     pcegm019 #0;
     pcegm018 #18;
     pcegm011 #11;
     agifa071 #71;
     pcegm004 #4;
     :/dscarter/def/dscam003 #3;
     :/dscarter/def/dscam045 #45;
|FIN;

|VARIABLES;
     &eAviso = "";
     aFax = "";
     aMail = "";
     aAsunto = "";
     aAlfa = "";
     nEmpresa = 0;
     nEmpCarte = 0;
     aEmp = "";
     aBase = "";
|FIN;

|PROCESO Recibos;
     |IMPRE 0;
     |SI FSalida = 0;
          |SI #0#13 < 2;
               aAlfa = #18#22;
          |SINO;
               aAlfa = #18#21;
          |FINSI;
          |QBF aAlfa;
          |INFOR aAlfa;
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|DEFBUCLE Recibos;
     #3#12;
     ;
     #0#4, #0#5, #0#6, "01.01.0000", "            ", "      ";
     #0#4, #0#5, #0#6, "31.12.9999", "zzzzzzzzzzzz", "zzzzzz";
     ;
     NULL, Recibos;
|FIN;

|PROCESO dscam045;
     |SI nEmpCarte ! #45#6;
          nEmpCarte = #45#6;

          aEmp = ("00000" + #45#6) % -105;
          aAlfa = aBase + "dscarter/fich/" + aEmp + "/";
          |PATH_DAT #3#aAlfa#;
          |BUCLE Recibos;
     |FINSI;
|FPRC;

|DEFBUCLE dscam045;
     #45#1;
     ;
     nEmpresa, 001;
     nEmpresa, 999;
     ;
     NULL, NULL, NULL, NULL, NULL, dscam045;
     #45#6;
|FIN;

|PROCESO Tipo4; |TIPO 4;
     |CONFI "0000N¿Imprimir documento?";
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DBASS aBase;
     aAlfa = aBase + "dscarter/fich/";
     |PATH_DAT #45 aAlfa;


     |DFICE aAlfa;
     aAlfa = aAlfa % -205;
     nEmpresa = aAlfa;
     nEmpCarte = 0;

     |ABRE #18; |LEE 000#18p; |CIERRA #18;
     |BUCLE dscam045;
|FPRC;
