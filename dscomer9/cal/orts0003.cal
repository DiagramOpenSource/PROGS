|FICHEROS;
 orts0003 #0;
 agifa104 #1;
 agifa073 #2;
 agifa024 #3;
 agifa019 #4;
 orts0004 #5;
 dsm00003 #30;
|FIN;

|VARIABLES;
 nSal = 0;
 &Tempo = "";
 aZona = "";
 aServido = "";
 informe = "orts0003";
 sw = 0;

 tptas = 0;
 tvol  = 0;
 tpeso = 0;
 pdte   = 0;
|FIN;

|PROCESO impresion;
     pdte = #2#5 - #2#43;
     |DDEFECTO #4;
     #4#0 = #2#2;
     |LEE 040#4=;
     |SI #0#13 = "P";
          tvol = tvol  + (pdte * #4#114);
          tpeso = tpeso + (pdte * #4#102);
     |SINO;
          tvol = tvol  + (#2#5 * #4#114);
          tpeso = tpeso + (#2#5 * #4#102);
     |FINSI;
|FPRC;

|DEFBUCLE linpedi;
 #2#1;
 ;
 #1#25,#1#0,001;
 #1#25,#1#0,999;
 ;
 NULL,impresion;
|FIN;

|PROCESO lineas;
     |SI aServido = "N"; |O #0#13 = "T";
          |DDEFECTO #3;
          #3#0 = #1#4;||Lee clientes;
          |LEE 000#3=;

          |DDEFECTO #30;
          #30#0 = #1#4;
          #30#1 = #1#57;
          |LEE 000#30=;

          |SI #30#11 ] #0#9;|Y #30#11 [ #0#10;||Seleccion zonas;
             |SI #0#13 = "P";
                  tptas = tptas + #1#12;
             |SINO;
                  tptas = tptas + #1#11;
             |FINSI;

             |BUCLE linpedi;

             |DDEFECTO #5;
             #5#0 = #30#11;
             |LEE 101#5=;
             |SI FSalida ! 0;
                  |GRABA 020#5b;
             |FINSI;
             #5#1 = #5#1 + tptas;
             #5#2 = #5#2 + tvol;
             #5#3 = #5#3 + tpeso;
             |GRABA 020#5a;
             |LIBERA #5;
          |FINSI;
          tptas = 0;
          tvol  = 0;
          tpeso = 0;
     |FINSI;
|FPRC;


|PROCESO Lin;
     pdte = #2#5 - #2#43;
     |SI pdte > 0; |Y #2#9 ! 0;
          aServido = "N";
     |FINSI;
|FPRC;

|PROCESO Cab;
     aServido = "S";
|FPRC;

|DEFBUCLE pedido;
 #1#1;
 1,4,2;
 #0#4,#0#6,#0#2,#0#0, #0#11;
 #0#5,#0#7,#0#3,#0#1, #0#12;
 ;
 NULL, Cab, Lin, lineas;
|FIN;

|PROCESO zona;
  |PRINT;
|FPRC;

|DEFBUCLE zonas;
      #5#1;
      ;
      #0#9;
      #0#10;
      ;
      NULL,zona;
|FIN;

|PROCESO inicio;|TIPO 3;
     |ABRE #30;
     |ABRE #3;
     |IMPRE 0;
     |SI FSalida = 0;
         |INFOR informe;
            |SI FSalida = 0;
                 |HAZ CreaTempo; |NOME_DAT #5 Tempo; |DELINDEX #5;
                 |ABRE #4;
                 |ABRE #5;
                 |BUCLE pedido;
                 |BUCLE zonas;
                 |PIEINF;
                 |FININF;
                 |CIERRA #5;
                 |CIERRA #4;
                 |HAZ BoraTempo; |DELINDEX #5;
            |FINSI;
         |FINIMP;
     |FINSI;
     |CIERRA #3;
     |CIERRA #30;
|FPRC;
