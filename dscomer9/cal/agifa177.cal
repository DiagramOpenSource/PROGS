|FICHEROS;
  agifa177 #0;
|FIN;

|VARIABLES;
     &endigC   = 0;
     &eaCta    = "";
     &eswCta   = 0;
    alfa1 = "";
    alfa2 = "";
    dbase = "";

    inkey = 0;
    aginform   = ":/ut/aginfo";
    empresa    = "agifa041";

    aplicacion = "";
    orden      = "";  || Editor de Informes
    alinforme  = "";
    fichero1   = "";
    fichero2   = "";
    comando    = "";
|FIN;

|PROCESO r_tipo8; |TIPO 8;
 |DIRECTORIO dbase;   || Directorio Base /agi/agitra/ ...
 |DBASE aplicacion;   || Directorio de la Aplicacion
 aplicacion = aplicacion - dbase; || Aplicacion

 |VERSIONRTME alfa1;  || Segun Version aginform aginfobx ...
 orden = "";
 alfa1 = alfa1 % 101;      || en AGISYSTEM-VI cambia el aginform
 |SI alfa1 = "6";
    |QUE_SISTEMA alfa2;
    |SI alfa2 = "ESSCO"; orden = aginform + "sx"; |FINSI;
    |SI alfa2 = "ESBSD"; orden = aginform + "bx"; |FINSI;
    |SI alfa2 = "ESDOS"; orden = aginform + "nt"; |FINSI;
 |FINSI;
 |SI orden = "";  orden = aginform + "rm"; |FINSI;

|FPRC;

|PROCESO edita; |TIPO 0;
 inkey = FSalida;

 alinforme = #0Campo;

 |SI inkey = 9;     |HAZ r_edita;    |FINSI;
 |SI inkey = 10;    |HAZ r_copia;    |FINSI;
 |SI inkey = 11;    |HAZ r_restaura; |FINSI;

 |SI inkey ] 9;|Y inkey [ 12;
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO r_edita;
 |INFOR alinforme;
 |SI FSalida ! 0;
     |CONFI "2400SNo existe Informe. Crear Nuevo S/N: ";
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;
     |CONFI "2400SCopiar Informe Standar S/N: ";
     |SI FSalida = 0;
         |HAZ r_copstand;
     |FINSI;
 |FINSI;
 |FININF;

 |ATRI R;
 alfa1 = "    Ejecutando [" + orden + "] ...";
 |MENSA alfa1;
 |ATRI 0;
 |SLEEP 2;

 comando = orden + " " + aplicacion + "def/" + " " + empresa + " " + alinforme;
 |SYSTEM comando;
|FPRC;

|PROCESO r_restaura;
 |ATRI P;
 |MENSA "    Restaurando desde extension '.seg' ...";
 |ATRI 0;

 alfa1 = alinforme;
 |QBF alfa1;

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".seg";
 fichero2 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;
 |ATRI R;
 |BLIN 4;
 |ATRI 0;
|FPRC;

|PROCESO r_copia;
 |ATRI P;
 |MENSA "    Copiando a extension '.seg' ...";
 |ATRI 0;

 alfa1 = alinforme;
 |QBF alfa1;

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 fichero2 = dbase + aplicacion + "def/" + alfa1 + ".seg";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;

 |ATRI R;
 |BLIN 4;
 |ATRI 0;
|FPRC;

|PROCESO r_copstand;

 |ATRI P;
 |MENSA "    Copiando Standard ...";
 |ATRI 0;

 alfa1 = "agifa114";   |QBF alfa1;  || Fichero Standard
 alfa2 = alinforme;    |QBF alfa2;  || Fichero Personalizado

 fichero1 = dbase + aplicacion + "def/" + alfa1 + ".inf";
 fichero2 = dbase + aplicacion + "def/" + alfa2 + ".inf";
 |COPIA_FICHERO fichero1, fichero2;
 |SI FSalida ! 0;
     alfa1 = "    Error [" + FSalida + "] en copia de ficheros ...";
     |MENAV alfa1;
 |FINSI;

 |ATRI R;
 |BLIN 4;
 |ATRI 0;
|FPRC;

|PROCESO MCta177; |TIPO 0;
  eaCta = #0Campo;
  |HAZ MFiltraPtos;
  #0Campo = eaCta; |PINTA #0Campo;

  |HAZ MCtaContable;
  |SI eswCta = 1;
      |MENAV "    Error. Longitud de Cuenta fuera de Nivel";
      |ERROR;
  |FINSI;
|FPRC;
