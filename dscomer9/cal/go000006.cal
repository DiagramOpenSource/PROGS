|FICHEROS;
     go000006 #0;
     agifa019 #19;
     agifa017 #17;
     agifa065 #65;
     go000004 #120;
     go000005 #121;
     referen@;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     aAlfa = "";
     dArt = "";
     hArt = "";
     nTecla = 0;
     nPosi = 0;
     nSw       = 0;
     &Tempo    = "";
     fFecha    = @;
     aTempo0   = "";
     nModo     = 0;
     nDAlma = 0;
     nHAlma = 0;
|FIN;

|PROCESO Consulta; |TIPO 66;
     |ABRE #120;
     #120#4 = #0#3;
     #120#0 = #0#0;
     |LEE 000#120];
     |CONSULTA_CLAVE #1#120;
     |SI FSalida = 0;
          #0#3 = #120#4; |PINTA #0#3;
          #0#0 = #120#0; |PINTA #0#0;
     |FINSI;
     |CIERRA #120;
|FPRC;

|PROCESO Llena042; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     |ABRE #121;
     #121#0 = #0#0;
     #121#1 = #0#1;
     #121#3 = #0#3;
     |LEE 101#121=;
     |SI FSalida ! 0; |GRABA 020#121b; |FINSI;
     |SI nModo = 3;
          |BORRA 020#121a;
     |SINO;
          #121#5 = #0#5;
          #121#6 = #0#6;
          |GRABA 020#121a;
     |FINSI;
     |CIERRA #121;
|FPRC;

|PROCESO Calcu; |TIPO 0;
     #0#6 = #0#5 - #0#4;
     |PINTA #0#6;
|FPRC;

|PROCESO dsm00121;
     #0#0 = #121#0;
     #0#1 = #121#1;
     #0#2 = #121#2;
     #0#3 = #121#3;
     #0#4 = #121#4;
     #0#5 = #121#5;
     #0#6 = #121#6;
     #0#7 = #121#7;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE dsm00121;
     #121#1;
     ;
     nDAlma, fFecha, "                   ";
     nHAlma, fFecha, "zzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dsm00121;
|FIN;

|PROCESO Min_42;
     #0#0 = fFecha;
     #0#1 = " " * 20;
     #0#3 = 00001;
|FPRC;

|PROCESO Max_42;
     #0#0 = fFecha;
     #0#1 = "z" * 20;
     #0#3 = 99999;
|FPRC;

|PROGRAMA;
     |C_V #0#0, 1, "N"
     |CLS;
     |PINPA #0#0;
     |ENTLINEAL #1#0, 3, 7, 20, 0, Min_42, Max_42;
     |PUSHV 0501 2380;
     |BLANCO 1127 1655;
     |CUADRO 1127 1655;
     |ATRI R;
     |PINTA 1330, "Obra......:";
     |PINTA 1430, "INVENTARIO:";
     |C_V #0#0, 1, "S"
     |C_M #0#3, 1, "S"
     |C_P #0#3, 0, nPosi;
     |C_P #0#3, 1, 1343;
     |C_P #0#0, 1, 1443;
     #0#3 = 1;
     #0#0 = ~;
     |PINTA #0#0;
     |PINTA #0#3;
     |ATRI 0;
 |ET Otra;
     |ENCAMPO #3#0;
     |SI FSalida ! 0; |ACABA; |Y FSalida ! 6; |FINSI;
     |ENCAMPO #0#0;
     |SI FSalida = 2; |VETE Otra; |FINSI;
     |SI FSalida ! 0; |ACABA; |Y FSalida ! 6; |FINSI;

     |C_V #0#0, 1, "N";

     |ABRE #120;
     #120#4 = #0#3;
     #120#0 = #0#0;
     |LEE 000#120=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Recuento...";
          |ACABA;
     |SINO;
          |SI #120#6 ! 0;
               |MENAV "0000El recuento ya se actualizo.";
               |ACABA;
          |FINSI;
     |FINSI;
     |CIERRA #120;

     fFecha = #0#0;
     nDAlma = #0#3;
     nHAlma = #0#3;
     |POPV;

     |SI FSalida = 0
          |C_V #0#0, 1, "N";
          |C_M #0#3, 1, "N";
          |C_P #0#3, 1, nPosi;
          |ABRE #120;
          #120#4 = #0#3;
          #120#0 = fFecha;
          |LEE 101#120=;
          |SI FSalida = 0;
               |SI #120#1 = "S";
                    |MENAV "0000Inventario Actualizado...";
               |SINO;
                    |HAZ CreaTempo; aTempo0 = Tempo;
                    |NOME_DAT #0 aTempo0; |DELINDEX #0;
                    |ABRE #0;

                    |BUCLE dsm00121;
                    |CIERRA #0;
                    |PARA nSw = 1; |SI nSw  = 1; |HACIENDO;
                         nSw = 0;
                         |ENTLINEAL #1#0, -3, 2, 20, 0, Min_42, Max_42;
                    |SIGUE;
                    |DELINDEX #0; Tempo = aTempo0; |HAZ BoraTempo;
               |FINSI;
          |FINSI;
          |CIERRA #120;
     |FINSI;
|FPRO;
