|FICHEROS;
     golis031 #0;
     gomantho #1;
     goprepec #2;
     goprepel #3;
     agifa019 #19;
     golis032 #32;  || Tmp
     agifa065 #65;
     agifa067 #67;
     referen@;
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp1 = "";
     aTmp2 = "";
     nPdte = "";
     aAlfa = "";
|FIN;

|PROCESO Lee;
     |DDEFECTO #19;
     #19#0 = #32#2;
     |LEE 000#19=;
     |DDEFECTO #1;
     #1#0 = #32#0;
     #1#1 = #32#1;
     |LEE 000#1=;
|FPRC;

|PROCESO Imprime;
     |SI #32#5 ] 0;
          |HAZ Lee;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Imprime;
     #32#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Imprime;
|FIN;

|PROCESO Agrupa;
     |DDEFECTO #referen@;
     #referen@#2 = #32#2;
     |LEE 101#referen@.=;
     |SI FSalida ! 0; |GRABA 020#referen@.b; |FINSI;
     #referen@#3 = #referen@#3 + #32#3;
     #referen@#4 = #referen@#4 + #32#4;
     #referen@#5 = #referen@#3 - #referen@#4;
     #referen@#6 = #referen@#6 + #32#6;
     #referen@#7 = #32#7;
     |GRABA 020#referen@.a;
     |LIBERA #referen@;
|FPRC;

|DEFBUCLE Agrupa;
     #32#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Agrupa;
|FIN;

|PROCESO agifa067;
     nPdte = #67#5 - #67#38;
     #32#6 = #32#6 + nPdte;
|FPRC;

|DEFBUCLE agifa067;
     #67#3;
     3;
     #32#2, #32#0, 000000, "     ", #32#7;
     #32#2, #32#0, 999999, "zzzzz", #32#7;
     ;
     NULL, agifa067;
|FIN;

|PROCESO agifa065;
     |SI #65#2 = "AC"; |O #65#2 = "ME"; |O #65#2 = "MS";
          #32#4 = #32#4 + #65#6;
     |FINSI;
|FPRC;

|DEFBUCLE agifa065;
     #65#1;
     5;
     #32#2, "01.01.0000", "  ", 000000, 00000, #32#0, #32#7;
     #32#2, "31.12.9999", "zz", 999999, 99999, #32#0, #32#7;
     ;
     NULL, agifa065;
|FIN;

|PROCESO Temporal;
     |BUCLE agifa065;
     #32#5 = #32#3 - #32#4;
     |SI #32#5 < 0;           || Sin negativos
          |BORRA 020#32a;
     |SINO;
          |BUCLE agifa067;
          |GRABA 0220#32a;
          |SI #0#4 = "N";
               |HAZ Lee;
               |PRINT;
          |FINSI;
     |FINSI;
     |LIBERA #32;
|FPRC;

|DEFBUCLE Temporal;
     #32#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Temporal;
|FIN;

|PROCESO goprepel;
     |DDEFECTO #32;
     #32#0 = #2#3;
     #32#1 = #2#7;
     #32#2 = #3#2;
     |LEE 101#32=;
     |SI FSalida ! 0; |GRABA 020#32b; |FINSI;
     #32#3 = #32#3 + #3#30;
     #32#7 = #1#11;
     |GRABA 020#32a;
     |LIBERA #32;
|FPRC;

|PROCESO goprepec;
     #1#0 = #2#3;
     #1#1 = #2#7;
     |LEE 000#1=;
     |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;

     |SI #0#5 = "S"; |Y #1#9 ! "C"; |ERROR; |ACABA; |FINSI;
|FPRC;

|DEFBUCLE goprepec;
     #2#2;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, goprepec, goprepel;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |SI #0#4 = "S";
               |INFOR "golisr31";
          |SINO;
               |INFOR "golisd31";
          |FINSI;
          |SI FSalida = 0;
               |HAZ CreaTempo; aTmp1 = Tempo; |NOME_DAT #32 Tempo; |DELINDEX #32;
               |ABRE #1;
               |ABRE #19;
               |ABRE #32;
               |BUCLE goprepec;
               |CIERRA #32;
               |BUCLE Temporal;

               |SI #0#4 = "S";
                    |HAZ CreaTempo; aTmp2 = Tempo;
                    |DDEF aAlfa;
                    aAlfa = aAlfa + "golis032";
                    |CARGA_DEF aAlfa, referen@;
                    |SI FSalida = 0;
                         |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@;
                         |ABRE #referen@;
                         |BUCLE Agrupa;
                         |CIERRA #referen@;
                         Tempo = aTmp2; |HAZ BoraTempo;
                         |DESCARGA_DEF #referen@;
                    |FINSI;
                    |NOME_DAT #32 aTmp2;
                    |BUCLE Imprime;
                    |DELINDEX #32;
                    |NOME_DAT #32 aTmp1;
               |FINSI;
               Tempo = aTmp1; |HAZ BoraTempo; |DELINDEX #32;
               |CIERRA #19;
               |CIERRA #1;

               |PIEINF;
               |FININF;
          |SINO;
               |SI #0#4 = "S";
                    |MENAV "0000Error en informe 'golisr31'";
               |SINO;
                    |MENAV "0000Error en informe 'golisd31'";
               |FINSI;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
