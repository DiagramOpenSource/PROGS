|FICHEROS;
     marhu365 #0; ||Este Def.
     marhu359 #1; ||Temporal.
     agifa010 #2; ||Albaranes.
     agifa025 #3; ||Representantes
     agifa071 #4; ||Albaranes (L).
     agifa019 #19;||Articulos.
     marhu371 #371;      ||Grupos Series (CAB)
     marhu372 #372;      ||Grupos Series (LIN)
|FIN;

|VARIABLES;
     &Tempo = "";
     aTempo1 = "";
     nSal  = 0;
     aFich = "";
     nAno  = 0;
     nMes  = 0;
     aMes  = "";
     tMes  = 0;
     aEmp  = "";
     swAno = 0;
     swImp = 0;
     i = 0;
     aDesdeSer = "";
     aHastaSer = "";
|FIN;

|PROCESO regulariza;
     |DDEFECTO #1;
     #1#0 = #3#0;
     #1#1 = #0#2;
     |LEE 000#1=;
     |SI FSalida ! 0;
          |GRABA 020#1n;
     |FINSI;
|FPRC;

|DEFBUCLE regulariza;
     #3#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL,regulariza;
|FIN;

|PROCESO marhu359;
     |PRINT;
     swImp = 1;
|FPRC;

|DEFBUCLE marhu359;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,marhu359;
|FIN;

|PROCESO marhu372;
     |SI #marhu372#2 = #agifa010#52;
          |HAZ Principal;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE marhu372;
 #marhu372#1;
 ;
 #marhu365#45, 001;
 #marhu365#45, 999;
 ;
 NULL, marhu372;
|FIN;

|PROCESO agifa010;
     ||TODO CCC
     |SI #0#46 = "P";
          ||Comprobar uno a uno todas las series
          |PARA i = 49; |SI i [ 58; |HACIENDO i = i + 1;
               |SI #marhu365#i# = #agifa010#52; |Y #marhu365#i# ! ".    ";
                    |HAZ Principal;
                    |SAL;
               |FINSI;
          |SIGUE;
     |SINO;
          |SI #0#46 = "G";
               ||Ver si la serie pertenece al grupo
               |BUCLE marhu372;
          |SINO;         ||(L)imites
               |HAZ Principal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Principal;
     |LIBERA #19;
     #19#0 = #4#2;
     |LEE 041#19=;
     |SI #19#125 = "Z ";  |ACABA;  |FINSI;  ||RB C.Banyo
     |DDEFECTO #1;
     #1#0 = #2#6;
     #1#1 = #0#2;
     |LEE 000#1=;
     nSal = FSalida;
     aMes = #2#1 % 402;
     nMes = aMes;
     tMes = aMes;
     nMes = aMes + 1;
     #1nMes = #1nMes + #4#9;
     #1#14  = #1#14  + #4#9;
     |SI nSal = 0; |GRABA 020#1a; |FINSI;
     |SI nSal ! 0; |GRABA 020#1n; |FINSI;
     tMes = tMes + swAno;
     #0tMes = #0tMes + #4#9;
     tMes = swAno + 13;
     #0tMes = #0tMes + #4#9;
|FPRC;

|DEFBUCLE agifa010;
     #2#1;
     6;
     aDesdeSer, 000001, #0#0;
     aHastaSer, 999999, #0#1;
     ;
     NULL,NULL,agifa010;
|FIN;

|PROCESO ejec; |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |INFOR "marhu358";
     |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
     |HAZ CreaTempo; aTempo1 = Tempo;
     |NOME_DAT #1 aTempo1; |DELINDEX #1;
     |ABRE #1;
     swAno = 10;
     #0#24 = #0#2;
     |ABRE #19;
     ||TODO CCC
     |SI #0#46 = "L";
          aDesdeSer = #0#47;
          aHastaSer = #0#48;
     |SINO;
          aDesdeSer = "     ";
          aHastaSer = "zzzzz";
     |FINSI;
     |BUCLE agifa010;
     |BUCLE regulariza;
     |CIERRA #19;
     |DBASE aFich;
     #0#2 = #0#2 - 1;
     #0#44 = #0#2;
     aEmp = #0#3;
     |QBF aEmp;
     aEmp = ("00000" + aEmp) % -105;
     aFich = aFich + "fich/" + aEmp + "/";
     |PATH_DAT #2  aFich;
     |PATH_DAT #4  aFich;
     |PATH_DAT #19 aFich;
     swAno = 30;
     |ABRE #19;
     |SI #0#46 = "L";
          aDesdeSer = #0#47;
          aHastaSer = #0#48;
     |SINO;
          aDesdeSer = "     ";
          aHastaSer = "zzzzz";
     |FINSI;
     |BUCLE agifa010;
     |BUCLE regulariza;
     |CIERRA #19;
     |CIERRA #1;
     |BUCLE marhu359;
     |SI swImp = 1;
          |PIEINF;
     |FINSI;
     |FININF;
     |FINIMP;
     |DELINDEX #1;  Tempo = aTempo1; |HAZ BoraTempo;
|FPRC;

|PROCESO Serie; |TIPO 0;
     |SI #0#46 = "L";
          |C_M #0#47, 1, "S";
          |C_M #0#48, 2, "S";
          |PARA i = 49; |SI i [ 58; |HACIENDO i = i + 1;
               |C_M #0i, 1, "N";
          |SIGUE;
          |C_M #0#45, 1, "N";
     |SINO;
          |SI #0#46 = "P";
               |C_M #0#47, 1, "N";
               |C_M #0#48, 2, "N";
               |PARA i = 49; |SI i [ 58; |HACIENDO i = i + 1;
                    |C_M #0i, 1, "S";
               |SIGUE;
               |C_M #0#45, 1, "N";
          |SINO;              ||(G)rupo
               |C_M #0#47, 1, "N";
               |C_M #0#48, 2, "N";
               |PARA i = 49; |SI i [ 58; |HACIENDO i = i + 1;
                    |C_M #0i, 1, "N";
               |SIGUE;
               |C_M #0#45, 1, "S";
          |FINSI;
     |FINSI;
|FPRC;
