|FICHEROS;
     agifa112 #0;
     agifa142 #1;
     agifa027 #2;
     agifa321 #4;
     agifa324 #5;
     dsw00032 #6,MANTE;
     dsw00034 #666;               ||Aux.Art/Prov. para Albero
     dsw00060 #66,MANTE;          ||Aux.Prov/Art. Incid.
     agifa065 #7;
     agifa019 #8;
     dsw00033 #9;
     agifa077 #10;
     agifa080 #80;
     dsm00238 #238;
     agifa142 #444;
     agifa324 #12;       || Divisas
     agifa321 #13;       || Parametros divisas
     agifa029 #29;       ||Almacenes
     agif0041 #41;
     agifa200 #200;
     agifa205 #205;
     agifa208 #208;
     dsm00241 #241;
     dsw00061 #61,MANTE; ||Mas info Artic./Prv
     agifa067 #67;      ||Pedidos Compras. LIN
     agifa081 #81;      ||Pedidos Compras. CAB
     albm0046 #46;      ||Art./Alm./PartidaCAB
     agifm004 #504;
     agifm005 #505,MANTE;
     dsm00279 #279;
     agifa040 #40;
     dsm00225 #225;

     albm0035@ #935;     ||Incidencias Albero (CARGA_DEF)
     dscam045@ #1000;
     canempre@ #600;
     caclipro@ #601;
     Referenc@ #700;
     dscam104@ #701;
     referen@;
     trabajo@;
|FIN;

|CAMPOS;
     #0#39 tot;
     #0#55 tot2;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     nBtnItemDocPrv = -1;
     &eaSucursal = "";
     &eaEntidad = "";
     &eaDC = "";
     &eaIBAN = "";
     &eaIBANant = "";
     nBtnAuxPrv = -1;
     nHandle = 0;
     aEmp = "";
     nEmpCart = 0;
     nSwForestales = 0;
     &EURODB = 0;
     nForma = 0;
     nError = 0;
     alfa = "";
     aNif = "";
     &enSwAltaPrv = 0; || Para la replica segun el control de empresas
     &enCambiCodi = 0;   || para la copia de empresas
     aUsu = "";
     nContaLog = 0;
     aNum = "";
     aTipo = "";
     aExiste = "";
     &eaRodExporta = "";
     aMulti = "";
     aCodUni = "";
     nFactor = 0;
     eaSerTintado = "";
     enNumTintado = 0;
     eaPartidaTin = "";
     aAux = "";
     &enSwNoCopia = 0; || Para desactivar la actualizacion
     aPath = "";
     nTipo = 0;
     nReg = 0;
     fFecAnt = @;
     &eaPar29 = "";
     &enAlm29 = 0;

     &ser_ped = "";
     &num_ped = 0;

     nCampo = 0;
     nCalc  = 0;
     nCont  = 0;

     aOrig  = "";
     aDest  = "";

     nPrimero = 0;
     aFecUlt = "";
     nPreUlt = 0;
     nPreAnt = 0;
     nTecla = 0;
     nModoLin = 0;
     nPos1 = 0;
     nPos2 = 0;
     aPrograma = "";
     aBase = "";
     aPathDef = "";
     aPathFic = "";
     aQueQuiero = "";
     aNomDef = "";
     aInfo = "";
     nSalida = 0;
     &endigC   = 0;
     &eaCta    = "";
     &eswCta   = 0;

     nModiRec = 0;
     aDef = "";
     &enSwCtrlUsu  = 0;

     &Tempo     = "";
     aTempo6    = "";
     aTempo66   = "";
     aTempo666  = "";
     aTempo61   = "";
     cambio_div = 0;
     cambio_base = 0;
     &nDeci_PreDiv  = 0;
     &precio_base = 0;
     aAlfa     = "";
     aTx3      = "";
     aTx4      = "";
     aTx7      = "";
     aTx8      = "";
     aTx9      = "";
     aTx0      = "";
     aSer      = "";
     nDoc      = 0;
     nLdo      = 0;
     aArt      = "";
     fFec      = @;
     nCan      = 0;
     nPre      = 0;
     nSw       = 0;
     aFich     = "";
     nModo     = 0;
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
     &mes = 0;
     informe = "agifa112";
     &modo = 0;
     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Contador:  ";
     menu4 = "AM";
     menu5 = " Automatico ";
     menu6 = " Manual ";
     contador = 0;
     cont = "";
     programa = "";
     sw1 = 0;
     cam_pos = 0;
     cam_mod = "";
     cod     = 0;
     cam_vis = "";
     vis = 0;
     i = 0;
     puente = "";
     puente1 = "";
     &registro = "";
     cuen = "";
     quitar = 0;

     nSwAlbero = 0;
     nBoton1   = 0;
     nBoton2   = 0;
     nBoton3   = 0;

     aAlfa1        = "";
     aAlfa2        = "";
     aParametro    = "";

     fFecha        = @;

     &eaCodigo     = "";
     &eaTipoCodigo = "PR";


     {-1}aUtil  = "";
         aUtil1 = "2400";
         aUtil2 = "1";
         aUtil3 = "Opciones : ";
         aUtil4 = "IOAC";
         aUtil5 = " Imprimir ";
         aUtil6 = " Observaciones ";
         aUtil7 = " Articulos ";
         aUtil8 = " Contactos ";
         aUtil9 = " Calidad ";


     aFecha = "";
     nPrecio = 0;
     aIncidencia = "";
     aArticulo = "";
     aSerie = "";
     nNumero = 0;
     nPreCom = 0;
     aMensaje = "";
     aPartida = "";
     nVentana  = 0;
     nVentana1 = 0;
     nNueva = 0;
     fFechaUlt = @;
     aArtAnt = "";
     aPro    = "";
     nSal    = 0;
     nCambioAlgo = 0;
     &eaClPr = "P";
     &eaCodigoNum = "";
     nsw = 0;
     nEsOTP = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaCtaCble  = "";
     &eaVarDni   = "";
     &enCalcCif  = 0;
     &eaMensaCad = "";
     &enErrorCad = 0;
     &eaCod      = "";
     &eaModo     = "";
     &enOk       = 0;
|FIN;

|PROCESO creacod3; |TIPO 0;
   aAlfa1 = #0#102;
   aAlfa1 = ("00"  + aAlfa1) % -102;
   aAlfa2 = #0#103;
   aAlfa2 = ("000" + aAlfa2) % -103;
   #0#107 = aAlfa1 + aAlfa2;
|FPRC;

|PROCESO Envio7; |TIPO 7;
  modo = (FEntrada / 100) ! 0;
  |SI modo = 1; |HAZ IgualEnvio; |FINSI;
|FPRC;

|PROCESO Envio0; |TIPO 0;
  |SI FSalida = 10; |HAZ IgualEnvio; |FINSI;
|FPRC;

|PROCESO IgualEnvio;
 #0#101 = #0#3;  |PINTA #0#101;
 #0#102 = #0#74; |PINTA #0#102;
 #0#103 = #0#75; |PINTA #0#103;
 #0#104 = #0#5;  |PINTA #0#104;
 #0#105 = #0#4;  |PINTA #0#105;
 |HAZ creacod3;
|FPRC;

|PROCESO AntesConf; |TIPO 7;
 |SI #0#99 ! " ";
     |C_M #0Campo,1,"S";
 |SINO;
     |C_M #0Campo,1,"N";
 |FINSI;
|FPRC;

|PROCESO CambioAlgo;
     |SI #0Campo ! Contenido;
         nCambioAlgo = 1;
     |FINSI;
|FPRC;

|PROCESO totalpro;|TIPO 0;
tot = tot - Contenido + #0Campo;
|PINTA tot;
|FPRC;

|PROCESO totalpr2;|TIPO 0;
tot2 = tot2 - Contenido + #0Campo;
|PINTA tot2;
|FPRC;


|PROCESO alta1; |TIPO 7;
     modo = (FEntrada / 100) ! 0;
     |SI modo ! 4;
         |SI nEsOTP = 1;
             |MENAV "0000No se puede crear ni modificar proveedores desde aqui.";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     eaDocu = "agifa112";
     |HAZ ControlUsu;
     |SI enSwCtrlUsu ! 0;
          |ERROR; |ACABA;
     |FINSI;
     |HAZ LeeDecimBase112;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1;
          #0#81 = #agifa321#9; || Divisa por defecto = Moneda Base
          |MODULO programa;
          |QBF programa;
          |SI programa ! "agifa112"; |ACABA; |FINSI;
          |ABRE #agifa142; |LEE 001#agifa142.p; |CIERRA #agifa142;
          |SI #1#3 = "S";
               |HAZ menus1;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO menus1;
|MENU menu;
|SI FSalida = 1;    ||Automatico
     |ABRE #2;
     #2#0 = "proveedo";
     |LEE 101#2=;
     |SI FSalida = 0;
          #2#1 = #2#1 + 1;
          contador = #2#1;
          |GRABA 021#2a;
     |SINO;
          contador = 1;
          #2#1 = 1;
          |GRABA 021#2n;
     |FINSI;
     cont = contador;
     cont = "000000" + cont;
     cont = cont % -106;
     #0#0 = cont;
     |PINTA #0#0;
     |||PTEC 802;     ||Provoco un return para saltar de campo
     |LIBERA #2;
     |CIERRA #2;
|FINSI;
|FPRC;

|PROCESO tex2; |TIPO 14;
     #0#73 = &178 * 4;
     |CAMPO_MODIFICA #0#73 , 1 , "S";
     |CAMPO_VISUAL #0#73 , 1 , "S";
|FPRC;

|PROCESO texto2; |TIPO 14;
     |CAMPO_MODIFICA #0#73 , 1 , "N";
     |CAMPO_VISUAL #0#73 , 1 , "N";
     |SI sw1 ! 0; |ACABA; |FINSI;

     |DDEF aDef;
     aDef = aDef + "agifa164";
     |CARGA_DEF aDef, referen@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #referen@;
     #referen@#0 = "A";
     |LEE 001#referen@.=;
     |SI FSalida = 0;
          |PINDA #1#referen@;
          sw1 = 1;
          |PARA i = 1; |SI i [ 12; |HACIENDO i = i + 1;
               cam_mod = #referen@#i#;
               cam_pos = i + 12;
               cam_pos = #referen@#cam_pos#;
               vis = i + 25;
               cam_vis = #referen@#vis#;
               |HAZ modifica2;
          |SIGUE;
          sw1 = 0;
     |FINSI;
     |CIERRA #referen@;
     |DESCARGA_DEF #referen@;
|FPRC;


|PROCESO modifica2;
     |SI i = 1;
          |CAMPO_MODIFICA #0#59 , 1 , cam_mod;
          |CAMPO_VISUAL #0#59 , 1 , cam_vis;
          |CAMPO_POSICION #0#59 , 1 , cam_pos;
     |FINSI;
     |SI i = 2;
          |CAMPO_MODIFICA #0#60 , 1 , cam_mod;
          |CAMPO_VISUAL #0#60 ,  1 , cam_vis;
          |CAMPO_POSICION #0#60 , 1 , cam_pos;
     |FINSI;
     |SI i = 3;
          |CAMPO_MODIFICA #0#61 , 1 , cam_mod;
          |CAMPO_VISUAL #0#61 ,  1 , cam_vis;
          |CAMPO_POSICION #0#61 , 1 , cam_pos;
     |FINSI;
     |SI i = 4;
          |CAMPO_MODIFICA #0#62 , 1 , cam_mod;
          |CAMPO_VISUAL #0#62 ,  1 , cam_vis;
          |CAMPO_POSICION #0#62 , 1 , cam_pos;
     |FINSI;
     |SI i = 5;
          |CAMPO_MODIFICA #0#63 , 1 , cam_mod;
          |CAMPO_VISUAL #0#63 ,  1 , cam_vis;
          |CAMPO_POSICION #0#63 , 1 , cam_pos;
     |FINSI;
     |SI i = 6;
          |CAMPO_MODIFICA #0#64 , 1 , cam_mod;
          |CAMPO_VISUAL #0#64 ,  1 , cam_vis;
          |CAMPO_POSICION #0#64 , 1 , cam_pos;
     |FINSI;
     |SI i = 7;
          |CAMPO_MODIFICA #0#65 , 1 , cam_mod;
          |CAMPO_VISUAL #0#65 ,  1 , cam_vis;
          |CAMPO_POSICION #0#65 , 1 , cam_pos;
     |FINSI;
     |SI i = 8;
          |CAMPO_MODIFICA #0#66 , 1 , cam_mod;
          |CAMPO_VISUAL #0#66 ,  1 , cam_vis;
          |CAMPO_POSICION #0#66 , 1 , cam_pos;
     |FINSI;
     |SI i = 9;
          |CAMPO_MODIFICA #0#67 , 1 , cam_mod;
          |CAMPO_VISUAL #0#67 ,  1 , cam_vis;
          |CAMPO_POSICION #0#67 , 1 , cam_pos;
     |FINSI;
     |SI i = 10;
          |CAMPO_MODIFICA #0#68 , 1 , cam_mod;
          |CAMPO_VISUAL #0#68 ,  1 , cam_vis;
          |CAMPO_POSICION #0#68 , 1 , cam_pos;
     |FINSI;
     |SI i = 11;
          |CAMPO_MODIFICA #0#69 , 1 , cam_mod;
          |CAMPO_VISUAL #0#69 ,  1 , cam_vis;
          |CAMPO_POSICION #0#69 , 1 , cam_pos;
     |FINSI;
     |SI i = 12;
          |CAMPO_MODIFICA #0#70 , 1 , cam_mod;
          |CAMPO_VISUAL #0#70 ,  1 , cam_vis;
          |CAMPO_POSICION #0#70 , 1 , cam_pos;
     |FINSI;
|FPRC;


|PROCESO cp4;
     puente = #0#74; puente = "00" + puente; puente = puente % -102;
     puente1 = puente;
     puente = #0#75; puente = "000" + puente; puente = puente % -103;
     puente1 = puente1 + puente;
     #0#76 = puente1;
/*
     Cambiado por un defecto: 001911/00370 martes, 31 de marzo de 2009

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O Campo ! Contenido; |Y Campo = 74;
          |ABRE #40;
          #40#0 = #0#74;
          |LEE 000#40=;
          |CIERRA #40;
          #0#5 = #40#1; |PINTA #0#5;
     |FINSI;
*/
     |SI #0Campo ! Contenido;
          #0#108 = #0#76; |PINTA #0#108;
     |FINSI;
|FPRC;

|PROCESO clave3; |TIPO 6;
     |SI FSalida = 3; |O FSalida = 5; |PTEC 808; |ERROR; |ACABA; |FINSI;
|FPRC;

|PROCESO copia1; |TIPO 2;
     |SI nEsOTP = 1;  |ACABA;  |FINSI;

     |ABRE #agifa142; |LEE 001#agifa142.p; |CIERRA #agifa142;
     modo = (FEntrada / 100) ! 0;
     mes = 0 +. 1;
     nForma = 0 +. 1;
     enSwAltaPrv = modo;

     eaDocu = "agifa112";
     |HAZ ControlUsu;
     |SI enSwCtrlUsu ! 0;
          |ERROR; |ACABA;
     |FINSI;
     |SI nForma = 1;
          |HAZ CamObligar2;
          |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;
     |FINSI;

     |SI modo = 3;
         |HAZ CargaContagen;
         |SI enOk = 1;
             eaCod     = #agifa112#0;
             eaCtaCble = #agifa112#10;
             eaTipo    = "P";
             |HAZ BorraCliProv;
             |SI enError = 1;
                 |MENAV "0000Existen movimientos de esta ficha. Se cancela la baja";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |SINO;
             |ABRE #7;
             |SELECT #3#7;
             |DDEFECTO #7;
             #7#10 = #0#0;
             #7#1 = "01.01.0000";
             |LEE 000#7];
             |SI FSalida = 0; |Y #7#10 = #0#0;
                 |CONFI "0000NExisten movimientos de esta ficha. Continuar con la baja?";
                 |SI FSalida ! 0;
                     |ERROR; |ACABA;
                 |FINSI;
             |FINSI;
             |CIERRA #7;
         |FINSI;
     |FINSI;

     |SI modo = 1; |O modo = 3;
          |HAZ BloqProvCartera;         || OJO puede provocar ERROR
     |FINSI;

     |HAZ EsGesenvia;
     |SI FSalida = 0;
          |HAZ GesenviaCop112;
     |FINSI;
     |SI modo = 3;
          |SUB_EJECUTA_NP "dsz99994;BORRA";
          |HAZ EsCamiCor;
          |SI FSalida = 0;
               eaProve = #0#0;
               |SUB_EJECUTA_NP "camcor31;BORRA";
          |FINSI;
          |HAZ EsRavenida;
          |SI FSalida = 0;
               eaProve = #0#0;
               |SUB_EJECUTA_NP "ravem002;BORRA";
          |FINSI;
     |SINO;
          |SI nForma = 1;
               |HAZ EsCamiCor;
               |SI FSalida = 0;
                    eaProve = #0#0;
                    |SUB_EJECUTA_NP "camcor31;SINOEXISTE";
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO T66C10F112; |TIPO 66;
     eaTipo    = "P";
     eaCtaCble = #agifa112#10;
     |HAZ SacaCliProv;
     #agifa112#10 = eaCtaCble;
     |PINTA #agifa112#10;
|FPRC;

|PROCESO T7C10F112; |TIPO 7;
     |HAZ MensaCTA;
|FPRC;

|PROCESO cuenta2; |TIPO 0;
     eaDocu = "agifa112";
     |HAZ ControlUsu;
     |SI enSwCtrlUsu ! 0;
          |ERROR; |ACABA;
     |FINSI;
     modo = (FEntrada / 100) ! 0;
     cuen = #0#10; |QBF cuen;
     |SI modo = 1; |Y cuen = "";
         cod = #0#0;
         |SI cod ! 0;
              cuen = "000000000000" + cod; || #0#0;
              |QBT cuen;
              quitar = -(100 + (#1#11 - 2));
              cuen = cuen % quitar;
              cuen = "40" + cuen;
              #0#10 = cuen;
              |PINTA #0#10;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO MCta112; |TIPO 0;
     eaCta = #0Campo;
     |HAZ MFiltraPtos;
     #0Campo = eaCta; |PINTA #0Campo;

     |HAZ MCtaContable;
     |SI eswCta = 1;
         |MENAV "    Error. Longitud de Cuenta fuera de Nivel";
         |ERROR; |ACABA;
     |FINSI;

     |HAZ EsOTP;
     |SI FSalida = 0;
          |HAZ CheqCtaOTP;
     |FINSI;

     |SI Contenido ! #agifa112#10;
         nModo = (FEntrada / 100) ! 0;
         |SI nModo = 1;
             eaTipo    = "P";
             eaVarDni  = #agifa112#9;
             eaCtaCble = #agifa112#10;
             |HAZ BuscaCliProv;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO salta_exp; |TIPO 7;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1; |O modo = 2;
          |CAMPO_MODIFICA #0#71 , 1 , "N";
     |FINSI;
|FPRC;

|PROCESO salta_exp1; |TIPO 0;
     |SI modo = 1; |O modo = 2;
          |CAMPO_MODIFICA #0#71 , 1 , "S";
     |FINSI;
|FPRC;


|PROCESO mayusvic; |TIPO 0;
     #0Campo = #0Campo > "";
     |PINTA #0Campo;
|FPRC;

|PROCESO LeeDecimBase112; |TIPO 13;
     modo = (FEntrada / 100) ! 0;
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9; ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;  ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     |CIERRA #agifa321;
     |CIERRA #agifa324;
     |SI modo = 1;
          #0#81 = #agifa321#9; || Divisa por defecto = Moneda BAse
     |FINSI;

     |HAZ EsDesanch;
     |SI FSalida = 0;
          |HAZ PinDesanch;
     |FINSI;
     |HAZ EsRavenida;
     |SI FSalida = 0;
          |HAZ PinRavenida;
     |FINSI;
|FPRC;

|PROCESO impo_tpv; |TIPO 7;
     |SI #0#79 = "I";
          |C_M #0#85, 1, "S";
     |SINO;
          |C_M #0#85, 1, "N";
          #0#85 = 0; |PINTA #0#85;
     |FINSI;
|FPRC;

|PROCESO prnprove;
     |HAZ MiraLogos;

     eaSerLog = "";
     eaNumLog = #0#0;
     eaTipLog = "PR";
     |HAZ ImprimeLog;

     |IMPRE 0;
     |SI 0 = FSalida;
       |INFOR informe;
       |SI 0 = FSalida;
          |PRINT;
          |PIEINF;
          |FININF;
       |FINSI;
       |FINIMP;
     |FINSI;
|FPRC;

|PROCESO ClaveMas;
 #505#0 = #0#0;
 #505#1 = 001;
|FPRC;

|PROCESO ClaveMenos;
 #505#0 = #0#0;
 #505#1 = 999;
|FPRC;

|PROCESO Tipo2012;  |TIPO 20;
     nModo = (FEntrada / 100) ! 0;

     aAlfa1 = FSalida;

     |SI aAlfa1 = "OPCION";
         FSalida = "Opciones";
         |ACABA;
     |FINSI;

     |LEE 101#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LIBERA #0;

     eaCodigo = #0#0;

     aUtil4 = "IOAC";

     |HAZ EsAlbero;
     nSwAlbero = FSalida;
     |SI nSwAlbero = 0;
          aUtil4 = "IOACL";
     |FINSI;

     |HAZ EsForestales;
     nSwForestales = FSalida;
     |SI nSwForestales = 0;
          aUtil4 = "IOACL";
     |FINSI;

     |MENU aUtil;
     aUtil2 = FSalida;

     |SI aUtil2 = "5"; |Y nSwAlbero = 0;
          aAlfa = "|albm0053;PIDEPA" + #0#0;
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;
     |SI aUtil2 = "5"; |Y nSwForestales = 0;
          aAlfa = "goma0009;" + #0#0;
          |SUB_EJECUTA_NP aAlfa;
     |FINSI;

     |SI aUtil2 = "4";
          eaCodigoNum = #0#0;
          |PUSHV 0501 2380;
          |PINPA #0#505;
          |ENTLINEAL #1#505, -2, 2, 22, 0, ClaveMas, ClaveMenos;
          |POPV;
     |FINSI;

     |SI aUtil2 = "3";
          |PUSHV 0501 2380;
          |SI nSwAlbero = 0;
               |HAZ proveart_albero;
          |SINO;
               |HAZ proveart;
          |FINSI;
          |POPV;
     |FINSI;
     |SI aUtil2 = "1";  |HAZ prnprove;           |FINSI;
     |SI aUtil2 = "2";
          |SI nModo = 1; |O nModo = 2;
               |GRABA 020#0a;
          |FINSI;
          |LIBERA #0; |CIERRAT #0;
          eaCodigo = #0#0;
          |SUB_EJECUTA_NP "dsz99994;MANTE";
          |ABRET #0;
          |SI nModo = 4;
               |LEE 000#0=;
          |SINO;
               |LEE 101#0=;
          |FINSI;
     |FINSI;

     |LIBERA #0;
|FPRC;

|PROCESO GrabaLinea;
     |DDEFECTO #8;
     #8#0 = aArt;
     |LEE 000#8=;

     aMulti = #1#163;
     |SI #8#204 = "S"; aMulti = "S"; |FINSI;

     |SELECT #2#241;
     #241#0 = #8#5;
     #241#2 = aCodUni;
     |LEE 000#241=;
     nFactor = 1;
     |SI FSalida = 0; |Y aMulti = "S";
          |SI #241#6 = "D";
               nFactor = 1 / #241#5;
          |SINO;
               nFactor = 1 * #241#5;
          |FINSI;
     |FINSI;

     #6#0 = aArt;
     #6#1 = #8#1;
     #6#2 = fFec;
     #6#3 = nCan;
     #6#4 = nPre * nFactor;
     #6#5 = aSer;
     #6#6 = nDoc;
     #6#7 = nLdo;
     |GRABA 020#6n;
|FPRC;

|PROCESO agifa065;
     |SI nSw = 0;
          aArt = #7#0;
          nSw  = 1;
     |FINSI;
     |SI aArt ! #7#0;
          |HAZ GrabaLinea;
          aArt = #7#0;
     |FINSI;
     fFec = #7#1;
     nCan = #7#6;
     nPre = #7#14;
     aSer = #7#11;
     nDoc = #7#3;
     nLdo = #7#4;
     aCodUni = #7#20;
|FPRC;

|DEFBUCLE agifa065;
     #7#3;
     ;
     #0#0,"AC","                    ","00.00.0000";
     #0#0,"AC","zzzzzzzzzzzzzzzzzzzz","31.12.9999";
     ;
     NULL,agifa065;
|FIN;

|PROCESO PedidoCompra112;
     fFecha = ~;
     aParametro = #0#0 + #66#0 + "00000";
     aParametro = aParametro + "000000000000000";
     aParametro = aParametro + fFecha;
     aParametro = aParametro + "          ";

     |DFICE aAlfa;
     aAlfa = aAlfa + Usuario;
     |XABRE "W", aAlfa, nHandle;
     |SI FSalida = 0;
          |XGRABA nHandle, aParametro;
          |XCIERRA nHandle;
          aAlfa = "|albz0008;FICHERO";
          |SUB_EJECUTA_NP aAlfa;
          |PTEC 812;
     |FINSI;
|FPRC;

|PROCESO ControlCal112;
     aAlfa    = "|albm0054;PIDEPA" + #0#0 + #66#0;
     |SUB_EJECUTA_NP aAlfa;
|FPRC;

|PROCESO GrabaLinProv;
     |DDEFECTO #0;
     #0#0 = aPro;
     |LEE 000#0=;

     |DDEFECTO #666;
     #666#0 = aPro;
     |LEE 000#666=;
     nSal = FSalida;

     #666#1 = #0#1;
     #666#2 = fFec;
     #666#3 = nCan;
     #666#4 = nPre;
     #666#5 = aSer;
     #666#6 = nDoc;
     #666#7 = nLdo;
     |SI nSal ! 0; |GRABA 020#666n; |FINSI;
     |SI nSal = 0; |GRABA 020#666a; |FINSI;
|FPRC;

|PROCESO agifa065_prov;
     |SI nSw = 0;
          aPro = #7#10;
          nSw  = 1;
     |FINSI;
     |SI aPro ! #7#10;
          |HAZ GrabaLinProv;
          aPro = #7#10;
     |FINSI;
     fFec = #7#1;
     nCan = #7#6;
     nPre = #7#14;
     aSer = #7#11;
     nDoc = #7#3;
     nLdo = #7#4;
|FPRC;

|DEFBUCLE agifa065_prov;
     #7#1;
     ;
     #66#0,"00.00.0000","AC",000000,00000,"     ";
     #66#0,"31.12.9999","AC",999999,99999,"zzzzz";
     ;
     NULL, agifa065_prov;
|FIN;

|RUTINA inf666;
     #666#0 = "      ";
|FRUT;

|RUTINA sup666;
     #666#0 = "zzzzzz";
|FRUT;

|PROCESO OtrosProv;
     |SALVA_DATOS #0;

     |HAZ CreaTempo; aTempo666 = Tempo;
     |NOME_DAT #666 aTempo666; |DELINDEX #666;
     |ABRE #666;

     nSw = 0;
     |BUCLE agifa065_prov;
     |SI nSw = 1;
          |HAZ GrabaLinProv;
     |FINSI;
     |CIERRA #8;
     |CIERRA #6;

     |PUSHV 0501 2380;

     |PINPA #0#666;

     |ENTLINEAL #1#666 , -1 , 4 , 22 , 0 , inf666 , sup666;

     |POPV;

     |DELINDEX #666; Tempo = aTempo666; |HAZ BoraTempo;

     |REPON_DATOS #0;
     |LEE 000#0=;
|FPRC;

|PROCESO proveart;
     |HAZ CreaTempo; aTempo6 = Tempo;
     |NOME_DAT #6 aTempo6; |DELINDEX #6;
     |ABRE #6;
     |ABRE #8;
     |ABRE #241;
     nSw = 0;
     |BUCLE agifa065;
     |SI nSw = 1;
          |HAZ GrabaLinea;
     |FINSI;
     |CIERRA #241;
     |CIERRA #8;
     |CIERRA #6;
     |ENTLINEAL #1#6 , -1 , 4 , 22 , 1 , inf32 , sup32;
     |DELINDEX #6; Tempo = aTempo6; |HAZ BoraTempo;
|FPRC;

|PROCESO proveart_albero;               ||Para Modulo ALBERO. 003026
     |HAZ CreaTempo; aTempo66 = Tempo;
     |NOME_DAT #66 aTempo66; |DELINDEX #66;
     |ABRE #66;

     |HAZ CreaTempo; aTempo61 = Tempo;
     |NOME_DAT #61 aTempo61; |DELINDEX #61;
     |ABRE #61;
     |HAZ CargaTmpAlbero;

     |CONTROL_SIMPLE 0, "BOTON, Crear Pedido Compra", 2330, 2350, PedidoCompra112;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Control Calidad Articulo", 2355, 2375, ControlCal112;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Otros Proveedores", 2302, 2322, OtrosProv;
     nBoton3 = FSalida;

     |MENSA "0000 <DobleClick> para ver Detalle del Articulo";

     |ABRE #66;
     nModoLin = 2 + 4 + 8 + 16 + 32;
     nPos1 = 1002;
     nPos2 = 2275;
     |LINEAL_SIMPLE #1#66, nModoLin, nPos1, nPos2, infalbero , supalbero, LineasArt;

     |MENSA "0000                                           ";

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |PULSATECLA;

     |CIERRA #66;
     |CIERRA #61;
     |DELINDEX #66; Tempo = aTempo66; |HAZ BoraTempo;
     |DELINDEX #61; Tempo = aTempo61; |HAZ BoraTempo;
|FPRC;

|PROCESO LineasArt;
     nTecla = FSalida;
     |SI nTecla = 4;
          FSalida = 13;
          |HAZ MasInfo;
          |MENSA "0000 <DobleClick> para ver Detalle del Articulo";
     |FINSI;
|FPRC;

|RUTINA inf32;
     #6#0 = "                    ";
|FRUT;

|RUTINA sup32;
     #6#0 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;


|RUTINA infalbero;
     #66#0 = "                    ";
|FRUT;

|RUTINA supalbero;
     #66#0 = "zzzzzzzzzzzzzzzzzzzz";
|FRUT;


|PROCESO VerFich;
     |HAZ EsAlbero;
     nSwAlbero = FSalida;
     |SI nSwAlbero = 0;
          aArticulo = #66#0;
          aSerie = #66#5;
          nNumero = #66#6;
          nPreCom = #66#4;
          |ACABA;             ||No ense¤o esta ficha si es Albero. Sino se liaran mas
     |SINO;
          aArticulo = #6#0;
          aSerie = #6#5;
          nNumero = #6#6;
          nPreCom = #6#4;
     |FINSI;

     |DDEFECTO #9;
     |ABRE #8;
     #8#0 = aArticulo;
     |LEE 000#8=;
     |SI FSalida = 0;
          |HAZ decdivPro;
          |DDEFECTO #10;
          |ABRE #10;
          #10#50 = aSerie;
          #10#0  = nNumero;
          |LEE 000#10=;
          #9#0  = #8#0;   ||Cod.Articulo
          #9#1  = #8#1;   ||Descripcion.
          #9#2  = #8#125; ||Linea.
          #9#3  = #8#2;   ||Familia.
          #9#4  = #8#3;   ||SubFamilia.
          #9#5  = #8#200; ||Grupo.
          #9#6  = #8#127; ||N§Orden.
          #9#7  = nPreCom;   ||Precio Compra.
          #9#8  = #10#5;  ||Dto.
          #9#9  = #10#7;  ||Dto.P.P.
          #9#10 = #10#32; ||Dto.Acum.
          #9#11 = #8#6;   ||Stock.Total.
          #9#12 = #8#12;  ||Reservado.
          #9#13 = #8#203; ||P.Pedidos.
          #9#14 = #8#16;  ||Pdte.Recibir.
          #9#15 = #8#104; ||Disponible.
          #9#16 = #8#185; ||Stock Total 2
          #9#19 = #8#183; ||Pdte.Recibir 2
          #9#20 = #8#193; ||Disponible 2
          #9#7 = #9#7 < #9#8;
          #9#7 = #9#7 < #9#10;
          #9#7 = #9#7 < #9#9;
          |CIERRA #10;
          |SI #8#179 = "S";
               |ABRE #238;
               #238#0 = #8#201;
               |LEE 000#238=;
               |CIERRA #238;
          |FINSI;
          ||ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
          |ATRI N;
          |SI #8#179 = "S";
               aTx3 = "Pd.Recibir " + #238#5 + ":";
               aTx4 = "Pd.Recibir " + #238#4 + ":";
               aTx7 = "Stock Tot. " + #238#5 + ":";
               aTx8 = "Stock.Tot. " + #238#4 + ":";
               aTx9 = "Disponible " + #238#5 + ":";
               aTx0 = "Disponible " + #238#4 + ":";
               |C_V #9#16, 1, "S";
               |C_V #9#19, 1, "S";
               |C_V #9#20, 1, "S";
          |SINO;
               aAlfa = " " * 10;
               aTx3 = "Pdte.Recibir..:";
               aTx4 = "               " + aAlfa;
               aTx7 = "Stock Total...:";
               aTx8 = "               " + aAlfa;
               aTx9 = "Disponible....:";
               aTx0 = "               " + aAlfa;
               |C_V #9#16, 1, "N";
               |C_V #9#19, 1, "N";
               |C_V #9#20, 1, "N";
          |FINSI;
          |PUSHV 0501 2380;
          |PINPA #0#9;
          |PINTA 2130, aTx3;
          |PINTA 2230, aTx4;
          |PINTA 1903, aTx7;
          |PINTA 2003, aTx8;
          |PINTA 2103, aTx9;
          |PINTA 2203, aTx0;
          |PINDA #0#9;
          |ATRI I;
          |PAUSA;
          |POPV;
          |ERROR;
     |FINSI;
     |CIERRA #8;


|FPRC;

|PROCESO decdivPro;
  |ABRE #agifa324;
  #agifa324#0 = #agifa019#165;
  |LEE 001#agifa324.=;
  nDeci_PreDiv = #agifa324#9;
  cambio_div = #agifa324#3;
  |ABRE #agifa321;
  |LEE 001#agifa321.p;
  #agifa324#0 = #agifa321#9; ||Igualo a moneda base
  |LEE 001#agifa324.=;
  nDeci_Base = #agifa324#7;  ||Decimales moneda base
  nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
  cambio_base = #agifa324#3;
  |CIERRA #agifa321;
  |CIERRA #agifa324;
|FPRC;

ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
|PROCESO Digito3;
     ||ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄSolo 10 digitos
     aAlfa = #0#12;
     aAlfa = aAlfa % 110;
     #0#12 = aAlfa;
     ||ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
     eaEntidad = #0#14; |QBF eaEntidad; eaEntidad = eaEntidad % 104;
     eaSucursal = #0#15; |QBF eaSucursal; eaSucursal = eaSucursal % 104;
     eaCuenta = #0#12; |QBF eaCuenta; eaCuenta = eaCuenta % 110;
     eaDC = "";
     |HAZ CalculoDC;
     #0#13 = eaDC;
     |PINTA #0#13;
     |SI #0Campo ! Contenido;
          |HAZ CalculaIban;
     |FINSI;
|FPRC;

|PROCESO T7C9F112; |TIPO 7;
     |HAZ MensaNIF;
|FPRC;

|PROCESO NifDup; |TIPO 6;
     |BLIN 04;

     eaPais = #0#89;

     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         |HAZ ConsultaNIFS;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
     |FINSI;

     |SI FSalida = 9;
          eaVarDni  = #0Campo;
          |HAZ CalculoNIFCIF;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo; |QBF eaVarDni;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |ABRE #225;
     #225#0 = #0#89;
     |LEE 000#225=;
     |CIERRA #225;
     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! ""; |Y #225#6 = "N";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;

     |SI nModo = 1;
         enOk     = 0;
         eaTipo   = "P";
         eaVarDni = #agifa112#9;
         eaModo   = "1";
         |HAZ RecogeCliProvNIF;
         |SI enOk = 1;
             |MENAV "0000No esta en la base de datos el NIF introducido";
             |ERROR;
         |FINSI;
     |FINSI;

     |SI nModo = 2;
         enOk     = 0;
         eaTipo   = "P";
         eaVarDni = #agifa112#9;
         eaModo   = "2";
         |HAZ RecogeCliProvNIF;
     |FINSI;


     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     aAlfa = #0#9; |QBF aAlfa;
     |SI #1#212 ! "N"; |Y aAlfa ! "";
          |DDEF aDef;
          aDef = aDef + "agifa112";
          |CARGA_DEF aDef , referen@;
          |SI FSalida = 0;
               |ABRE #referen@;
               |SELECT #6#referen@;
               #referen@#9 = #0#9;
               |LEE 000#referen@.];
               |PARA; |SI FSalida = 0; |Y #referen@#9 = #0#9; |HACIENDO;
                    |SI #referen@#0 ! #0#0;
                         |SI #1#212 = "X";
                             alfa = "0000El DNI existe. Codigo: "+ #referen@#0+&13+&13;
                             alfa = alfa + " Modifiquelo.";
                             |ERROR;
                             |SAL;
                         |FINSI;

                         |SI #1#212 ! "X";
                             alfa = "S0000El DNI existe. Codigo: "+ #referen@#0+&13+&13;
                             alfa = alfa + " Continuar buscando duplicados:";
                             |CONFI alfa;
                             |SI FSalida ! 0; |SAL; |FINSI;
                         |FINSI;
                    |FINSI;
                    |LEE 000#referen@.s;
               |SIGUE;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Recagifa077;
     #10#36 = #0#58;
     |GRABA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE Recagifa077;
     #10#3;
     38;
     #0#0, "01.01.0000", "     ", 000001, "N";
     #0#0, "31.12.9999", "zzzzz", 999999, "N";
     be;
     NULL, Recagifa077;
|FIN;

|PROCESO ModRec; |TIPO 0;
     |SI #0Campo ! Contenido;
          nModiRec = 1;
     |FINSI;
|FPRC;

|PROCESO finficha; |TIPO 3;
     #0#71 = "N";
     #0#72 = "00.00.0000";
     |SI nModiRec = 1;
          |CONFI "0000NModificar alabaranes no facturados";
          |SI FSalida = 0;
               |BUCLE Recagifa077;
          |FINSI;
          nModiRec = 0;
     |FINSI;
|FPRC;

|PROCESO Tipo30; |TIPO 30;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     |SI #1#208 = "S";
         |HAZ CargaContagen;
         |SI enOk = 0;
             aAlfa = "dsz00097;P" + #0#0;  || Alta contabilidad y basica
             |SUB_EJECUTA_NP aAlfa;
         |FINSI;
     |SINO;
          |SI nCambioAlgo ! 0;
              nCambioAlgo = 0;
              nsw = 0;
              eaClPr = "P"; eaCodigoNum = #0#0;
              |SUB_EJECUTA_NP "agifa141";
          |FINSI;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
         |HAZ CargaContagen;
         |SI enOk = 0;  |ACABA;  |FINSI;

         eaCtaCble = #agifa112#10;
         eaTipo    = "P";
         |HAZ CreaCliProv;
     |FINSI;
|FPRC;


|RUTINA infw61;
     #dsw00061#0 = #dsw00060#0;
     #dsw00061#14 = " ";
     #dsw00061#1 = "     ";
     #dsw00061#2 = 000000;
     #dsw00061#3 = 1;
     #dsw00061#4 = "31.12.9999";
|FRUT;

|RUTINA supw61;
     #dsw00061#0 = #dsw00060#0;
     #dsw00061#14 = "z";
     #dsw00061#1 = "zzzzz";
     #dsw00061#2 = 999999;
     #dsw00061#3 = 999;
     #dsw00061#4 = "01.01.0000";
|FRUT;

|PROCESO MasInfo; |TIPO 11;
     |SI FSalida = 13;
          |PUSHV 0501 2380;
          |ABRE #dsw00061;
          |ENTLINEAL #2#61, -5, 4, 21, 1, infw61, supw61;
          |CIERRA #dsw00061;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO MiraSiEsOTP;
     |DBASS aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "dspreven/def/pycm0070.mas";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |CARGA_DEF aAlfa, trabajo@;
     |ABRE #trabajo@;
     |LEE 000#trabajo@.p;
     |SI FSalida = 0;
         nEsOTP = 1;

         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa - "ase1012";
         |SI FSalida ! 0;
             |SI #48#0 = 70102;
                 nEsOTP = 0;
             |FINSI;
         |FINSI;
     |FINSI;
     |DESCARGA_DEF #trabajo@;
|FPRC;

|PROCESO Tipo80Prov;  |TIPO 80;
     nEsOTP = 0;
     |HAZ MiraSiEsOTP;
|FPRC;

|PROCESO CargaDef112; |TIPO 8;
     eaMensaCad = "9";
     |HAZ ControlCaducidad;
     |SI enErrorCad = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |HAZ EsAlbero;
     nSwAlbero = FSalida;
     |SI nSwAlbero = 0;
          |ABRE #agifa324;
          |DDEFECTO #agifa324;
          #agifa324#0 = "EUR";
          |LEE 000#agifa324.=;
          EURODB = #agifa324#9;
          |CIERRA #agifa324;


          |DDEF aDef;
          aDef = aDef + "albm0035";
          |CARGA_DEF aDef , albm0035@;
          |SI FSalida ! 0;
               aMensaje = "0000Problemas con CARGA_DEF " + aDef;
               |MENAV aMensaje;
               |PTEC 807;
          |SINO;
               |ABRE #albm0035@;
          |FINSI;
     |FINSI;
     |HAZ EsCamiCor;
     |SI FSalida = 0;
          |CONTROL_SIMPLE 0, "BOTON, Auxiliar", 0470, 0579, BtnAuxPrv;
          nBtnAuxPrv = FSalida;
     |FINSI;

     |HAZ EsTagloma;
     |SI FSalida = 0;
          |CONTROL_SIMPLE 0, "BOTON, ItemDoc", 0570, 0579, BtnItemDocPrv;
          nBtnItemDocPrv = FSalida;
     |FINSI;
|FPRC;

|PROCESO DesCargaDef112; |TIPO 9;
     |HAZ EsAlbero;
     nSwAlbero = FSalida;
     |SI nSwAlbero = 0;
          |CIERRA #albm0035@;
          |DESCARGA_DEF #albm0035@;
     |FINSI;
     |SI nBtnAuxPrv ! -1; |FIN_CONTROL_WINDOWS nBtnAuxPrv; |FINSI;

     |SI nBtnItemDocPrv ! -1; |FIN_CONTROL_WINDOWS nBtnItemDocPrv; |FINSI;
     |PULSATECLA;
|FPRC;

|PROCESO Incidencias;
     aPartida = #dsw00061#8;
     |QBF aPartida;
     |SI aPartida ! "";
          aPartida = #dsw00061#8;
          #albm0035@#0 = #dsw00061#0;
          #albm0035@#2 = #dsw00061#11;
          #albm0035@#4 = aPartida;
          |LEE 000#albm0035@.=;
          |SI FSalida = 0;
               |SI #935#11 = "S"; |O #935#12 = "S"; |O #935#13 = "S"; |O #935#14 = "S"; |O #935#15 = "S"; |O #935#16 = "S"; |O #935#17 = "S";
                    aIncidencia = "S";
                    #dsw00061#12 = "S";
               |FINSI;
               |SI #935#18 = "S"; |O #935#19 = "S"; |O #935#20 = "S"; |O #935#21 = "S"; |O #935#22 = "S"; |O #935#23 = "S"; |O #935#24 = "S";
                    aIncidencia = "S";
                    #dsw00061#12 = "S";
               |FINSI;
               |SI #935#25 = "S"; |O #935#27 = "S";
                    aIncidencia = "S";
                    #dsw00061#12 = "S";
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO SacaInc; |TIPO 11;
     |SI FSalida = 13;
          |SI #dsw00061#12 = "N";
               aMensaje = "0000No hay incidencias";
               |MENAV aMensaje;
               |ERROR;
          |SINO;
               aPartida = #dsw00061#8;
               |QBF aPartida;
               |SI aPartida ! "";
                    ||TODO CCC
                    ||Llamo al albm0035 .. Incidencias
                    ||No van las variables globales.
                    ||El 4 significa Consulta.
                    aParametro = "4" + #dsw00061#0 + (("00000" + #dsw00061#11) % -105) + #dsw00061#8;
                    aAlfa      = "|albz0010;" + aParametro;
                    |SUB_EJECUTA_NP aAlfa;
               |SINO;
                    aMensaje = "0000No hay partida asociada a este Albaran.";
                    |MENAV aMensaje;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI FSalida = 14;
          ||Pedido
          ser_ped = #dsw00061#1;
          num_ped = #dsw00061#2;
          |SUB_EJECUTA_NP "agifa100";
     |FINSI;
     |SI FSalida = 15;
          ||Consultar Partida
          aPartida = #dsw00061#8;
          |QBF aPartida;
          |SI aPartida ! "";
               aAlfa = ("0000" + #dsw00061#11) % -104;
               aAlfa = "|albm0046;" + aAlfa + #dsw00061#8;
               |SUB_EJECUTA_NP aAlfa;
          |SINO;
               aMensaje = "0000Partida vacia";
               |MENAV aMensaje;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO albm0046_112;
     eaPartidaTin = #albm0046#2;
     |ERROR10;
|FPRC;

|DEFBUCLE albm0046_112;
 #albm0046#5;
 ;
 eaSerTintado, enNumTintado;
 eaSerTintado, enNumTintado;
 ;
 NULL, albm0046_112;
|FIN;

|PROCESO DamePartida;
     |BUCLE albm0046_112;
|FPRC;

============================================================
|PROCESO AlbeHisto;
     aAux = #agifa065#0;
     |QBF aAux;
     |SI aAux ! "";

          |DDEFECTO #8;
          #8#0 = #7#0;
          |LEE 000#8=;

          #agifa080#27 = #agifa065#11;
          #agifa080#0  = #agifa065#3;
          #agifa080#1  = #agifa065#4;
          |LEE 000#agifa080.=;
          |SI FSalida = 0;
               |DDEFECTO #dsw00061;
               #dsw00061#0 = #agifa065#0;
               #dsw00061#14 = "A";
               #dsw00061#1 = #agifa065#11;
               #dsw00061#2 = #agifa065#3;
               #dsw00061#3 = #agifa065#4;
               |SI #agifa080#12 ! 0;
                   #dsw00061#1 = #agifa080#29;
                   #dsw00061#2 = #agifa080#12;
                   #dsw00061#3 = #agifa080#21;
               |FINSI;
               |LEE 101#dsw00061.=;
               |SI FSalida ! 0; |GRABA 020#dsw00061.b; |FINSI;
               #dsw00061#4 = #agifa065#1;
               aAlfa = #agifa080#4; |QBF aAlfa;
               |SI aAlfa = ""; aAlfa = #8#1; |FINSI;
               #dsw00061#5 = aAlfa;
               #dsw00061#6 = #agifa080#5;
               #dsw00061#7 = #agifa065#14;
               #dsw00061#8 = #agifa080#37;

               ||ARA
               aAux = #dsw00061#8;
               |QBF aAux;
               |SI aAux = "";
                    aAux = #dsw00061#1;
                    |QBF aAux;
                    |SI aAux = "T";
                         eaSerTintado = #dsw00061#1;
                         enNumTintado = #dsw00061#2;
                         eaPartidaTin = "";
                         |HAZ DamePartida;
                         #dsw00061#8 = eaPartidaTin;
                    |FINSI;
               |FINSI;

               #dsw00061#9 = #agifa080#36;
               #dsw00061#10 = #agifa080#5;        ||Kilos = Unidades
               #dsw00061#11 = #agifa080#3;

               |DDEFECTO #agifa029;
               #agifa029#0 = #dsw00061#11;
               |LEE 000#agifa029.=;
               #dsw00061#13 = #agifa029#1;

               |HAZ Incidencias;

               |GRABA 020#dsw00061.a;
               |LIBERA #dsw00061;
          |SINO;
               |DDEFECTO #dsw00061;
               #dsw00061#0 = #agifa065#0;
               #dsw00061#14 = "A";
               #dsw00061#1 = #agifa065#11;
               #dsw00061#2 = #agifa065#3;
               #dsw00061#3 = #agifa065#4;
               |LEE 101#dsw00061.=;
               |SI FSalida ! 0; |GRABA 020#dsw00061.b; |FINSI;
               #dsw00061#4 = #agifa065#1;
               #dsw00061#6 = #agifa065#6;
               #dsw00061#7 = #agifa065#14;
               #dsw00061#8 = #agifa065#18;
               #dsw00061#9 = #agifa065#17;
               #dsw00061#10 = #agifa065#6;        ||Kilos = Unidades
               #dsw00061#11 = #agifa065#3;

               |DDEFECTO #agifa029;
               #agifa029#0 = #dsw00061#11;
               |LEE 000#agifa029.=;
               #dsw00061#13 = #agifa029#1;

               |HAZ Incidencias;

               |GRABA 020#dsw00061.a;
               |LIBERA #dsw00061;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE AlbeHisto;
     #7#3;
     ;
     #0#0,"AC","                    ","00.00.0000";
     #0#0,"AC","zzzzzzzzzzzzzzzzzzzz","31.12.9999";
     ;
     NULL, AlbeHisto;
|FIN;

|PROCESO AlbePedido;
     aAux = #agifa067#2;
     |QBF aAux;
     |SI aAux ! "";

          |SI #agifa067#38 = 0;    ||Pedido sin adjudicar
               |DDEFECTO #8;
               #8#0 = #agifa067#2;
               |LEE 000#8=;

               |DDEFECTO #dsw00061;
               #dsw00061#0 = #agifa067#2;
               #dsw00061#14 = "P";
               #dsw00061#1 = #agifa067#28;
               #dsw00061#2 = #agifa067#0;
               #dsw00061#3 = #agifa067#1;
               |LEE 101#dsw00061.=;
               |SI FSalida ! 0; |GRABA 020#dsw00061.b; |FINSI;
               #dsw00061#4 = #agifa081#1;
               aAlfa = #agifa067#4; |QBF aAlfa;
               |SI aAlfa = ""; aAlfa = #8#1; |FINSI;
               #dsw00061#5 = aAlfa;
               #dsw00061#6 = #agifa067#5;
               #dsw00061#7 = #agifa067#6;
               #dsw00061#8 = "";
               #dsw00061#9 = 0;
               #dsw00061#10 = #agifa067#5;        ||Kilos = Unidades
               #dsw00061#11 = #agifa067#3;

               |DDEFECTO #agifa029;
               #agifa029#0 = #dsw00061#11;
               |LEE 000#agifa029.=;
               #dsw00061#13 = #agifa029#1;

               |GRABA 020#dsw00061.a;
               |LIBERA #dsw00061;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE AlbePedido;
     #agifa081#2;
     ;
     #agifa112#0;
     #agifa112#0;
     ;
     NULL, NULL, NULL, NULL, NULL, NULL, AlbePedido;
     #agifa081#1;
|FIN;

|PROCESO AlbeTempo;
     |DDEFECTO #8;
     #8#0 = #dsw00061#0;
     |LEE 000#8=;
     #dsw00061#5 = #8#1;
     |GRABA 020#dsw00061.a;
     |LIBERA #dsw00061;

     |DDEFECTO #dsw00060;
     #dsw00060#0 = #dsw00061#0;
     |LEE 101#dsw00060.=;
     |SI FSalida ! 0; |GRABA 020#dsw00060.b; |FINSI;
     #dsw00060#1 = #dsw00061#5;
     #dsw00060#2 = #dsw00061#4;
     #dsw00060#3 = #dsw00061#6;
     #dsw00060#4 = #dsw00061#7;
     #dsw00060#5 = #dsw00061#1;
     #dsw00060#6 = #dsw00061#2;
     #dsw00060#7 = #dsw00061#3;

     |SI aArtAnt ! #dsw00060#0;
          fFecAnt = "01.01.0000";
          aIncidencia = "N";
     |FINSI;
     |SI #dsw00061#14 = "S";
          aIncidencia = "S";
     |FINSI;
     |SI fFecAnt ! "01.01.0000"; |Y nPreAnt ! #dsw00060#4;
          #dsw00060#8 = fFecAnt;
          #dsw00060#9 = nPreAnt;
     |FINSI;
     aArtAnt = #dsw00060#0;
     fFecAnt = #dsw00060#2;
     nPreAnt = #dsw00060#4;

     #dsw00060#10 = aIncidencia;
     #dsw00060#11 = (#dsw00060#4 * 166.386) ! 0;
     #dsw00060#12 = aIncidencia;
     |GRABA 020#dsw00060.a;
     |LIBERA #dsw00060;
|FPRC;

|DEFBUCLE AlbeTempo;
     #dsw00061#3;
     ;
     INICIO;
     FINAL;
     be;
     NULL, AlbeTempo;
|FIN;

|PROCESO CargaTmpAlbero;
     aIncidencia = "N";
     |ABRE #agifa080;
     |ABRE #agifa029;
     |ABRE #8;
     |BUCLE AlbeHisto;
     |BUCLE AlbePedido;
     |CIERRA #agifa080
     |CIERRA #8;
     |CIERRA #agifa029;
     aArtAnt = "";
     |ABRE #8;
     |BUCLE AlbeTempo;
     |CIERRA #8;
|FPRC;
/*
|PROCESO LogProv;
     |DDEF aAlfa;
     aAlfa = aAlfa + "dsm00087";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     aSer = "";
     aNum = #0#0;
     aTipo = "PR";

     |ABRE #referen@;
     |DDEFECTO #referen@;
     |SELECT #2#referen@;
     #referen@#1 = aSer;
     #referen@#2 = aNum;
     #referen@#3 = aTipo;
     |LEE 101#referen@.=;
     |SI FSalida ! 0;
          |SELECT #1#referen@;
          |LEE 000#referen@.u;
          |SI FSalida = 0;
               nContaLog = #referen@#0 + 1;
          |SINO;
               nContaLog = 1;
          |FINSI;
          |DDEFECTO #referen@;
          #referen@#0 = nContaLog;
          #referen@#1 = aSer;
          #referen@#2 = aNum;
          #referen@#3 = aTipo;
          |GRABA 020#referen@.b;
     |FINSI;
     |SI FSalida = 0;
          |HORA aAlfa;
          aUsu = Usuario % 810;
          |SI nTipo = 15;
               #referen@#4 = aUsu;
               #referen@#5 = ~;
               #referen@#6 = aAlfa;
               #referen@#7 = "";
               #referen@#8 = "01.01.0000";
               #referen@#9 = ""
               #referen@#10 = "";
               #referen@#11 = "01.01.0000";
               #referen@#12 = ""
          |FINSI;
          |SI nTipo = 16;
               #referen@#7 = aUsu;
               #referen@#8 = ~;
               #referen@#9 = aAlfa;
          |FINSI;
          |SI nTipo = 17;
               #referen@#10 = aUsu;
               #referen@#11 = ~;
               #referen@#12 = aAlfa;
          |FINSI;
          |GRABA 020#referen@.a;
     |FINSI;
     |CIERRA #referen@;
     |DESCARGA_DEF #referen@;
|FPRC;
*/

|PROCESO Tipo7C1F112; |TIPO 7;
     |SI nEsOTP = 1;
         |MENAV "0000No se puede crear ni modificar proveedores desde aqui.";
         |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO CamObligar; |TIPO 0;
     |ABRE #279; |LEE 000#279p; |CIERRA #279;

     |SI #279#2 = "S";
          |SI Campo = 1; |O Campo = 9; |O Campo = 3; |O Campo = 4;
                    |O Campo = 5;
               aAlfa = #0Campo; |QBF aAlfa;
               |SI aAlfa = "";
                    |MENAV "0000Campo obligatorio.";
                    |ERROR;
               |FINSI;
          |FINSI;
          |SI Campo = 74;
               |ABRE #225;
               #225#0 = #0#89;
               |LEE 000#225=;
               |CIERRA #225;
               |SI #0Campo = 0; |Y #225#6 = "N";
                    |MENAV "0000Campo obligatorio.";
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CamObligar2;
     nError = 0;
     |SI #279#1 = "S";
          aAlfa = #0#1; |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000Nombre fiscal, campo obligatorio...";
               nError = 1;
          |FINSI;
          aAlfa = #0#9; |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000NIF/CIF, campo obligatorio...";
               nError = 1;
          |FINSI;
          aAlfa = #0#3; |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000Direccion envio, campo obligatorio...";
               nError = 1;
          |FINSI;
          aAlfa = #0#4; |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000Poblacion envio, campo obligatorio...";
               nError = 1;
          |FINSI;
          aAlfa = #0#5; |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000Provincia envio, campo obligatorio...";
               nError = 1;
          |FINSI;
          |ABRE #225;
          #225#0 = #0#89;
          |LEE 000#225=;
          |CIERRA #225;
          |SI #0#74 = 0; |Y #225#6 = "N";
               |MENAV "0000Codigo postal, campo obligatorio...";
               nError = 1;
          |FINSI;
     |FINSI;
     FSalida = nError;
|FPRC;


|PROCESO ProEnvio; |TIPO 0;
     |SI #0Campo ! Contenido;
          |ABRE #40;
          #40#0 = #0Campo;
          |LEE 000#40=;
          |CIERRA #40;
          #0#5 = #40#1; |PINTA #0#5;
     |FINSI;
|FPRC;


|PROCESO CheqCtaOTP;
     |DBASS aPath;
     aAlfa = aPath + "contagen/def/canempre";
     |CARGA_DEF aAlfa, canempre@;
     |SI FSalida ! 0; |ACABA; |FINSI;

     aAlfa = aPath + "contagen/def/caclipro";
     |CARGA_DEF aAlfa, caclipro@;
     |SI FSalida = 0;
          fFecha  = ~;
          aAlfa   = fFecha % -102;

          |DBASS aBase;  |QBF aBase;

          aFich = aBase + "contagen/fich/";
          |PATH_DAT #600 aFich;

          |ABRE #600; |SELECT #4#600;
          #600#2  = #48#0;
          #600#26 = aAlfa;
          |LEE 000#600=;
          |SI FSalida = 0;
               aFich = aBase + "contagen/fich/" + (("00000" + #600#2) % -105) + #600#3 + "/";
               |PATH_DAT #601 aFich;

               aAlfa = #0Campo % 103;
               aTipo = "";
               |SI aAlfa = "400";  |O aAlfa = "410";
                   aTipo = "P";
                   aExiste = "proveedor";
               |FINSI;
               |SI aTipo = "";
                   |MENAV "0000No puedo chequear la cuenta ya que no empieza por (400, 410)";
               |SINO;
                    |ABRE #601;
                    |SELECT #1#601;
                    #601#23 = aTipo;
                    #601#10 = #0Campo;
                    |LEE 000#601=;
                    |SI FSalida = 0;
                        aAlfa1 = #601#9; |QBF aAlfa1;
                        aAlfa2 = #0#9;   |QBF aAlfa2;
                        |SI aAlfa1 = "";
                            aAlfa = "0000Existe un " + aExiste + " con esta cuenta pero sin contenido en el campo NIF";
                            |MENAV aAlfa;
                            |MENAV "0000No puedo aceptar este c¢digo de cuenta ya que no lo puedo chequear";
                            |ERROR;
                        |SINO;
                             |SI aAlfa1 ! aAlfa2;
                                 aAlfa = "0000Existe un " + aExiste + " con esta cuenta pero distinto NIF. Revise los datos";
                                 |MENAV aAlfa;
                                 |ERROR;
                             |FINSI;
                         |FINSI;
                    |FINSI;
                    |CIERRA #601;
               |FINSI;
          |FINSI;
          |CIERRA #600;

          |DESCARGA_DEF #caclipro@;
     |FINSI;
     |DESCARGA_DEF #canempre@;
|FPRC;

|PROCESO BloqProvCartera;
   nEmpCart = -1;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa1 = aAlfa + "dscarter/def/dscam045.mas";
   |CARGA_DEF aAlfa1, Referenc@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa1 = aAlfa + "dscarter/fich/"; |PATH_DAT #Referenc@#aAlfa1#;
      |ABRE #Referenc@;
      #Referenc@#0 = #48#0;
      #Referenc@#1 = 1;
      |LEE 000#Referenc@.];
      |PARA; |SI FSalida = 0; |Y #Referenc@#0 = #48#0; |HACIENDO;
         |SI #Referenc@#2 = "C"; nEmpCart = #Referenc@#6; |SAL; |FINSI;
         |LEE 000#Referenc@.s;
      |SIGUE;
      |CIERRA #Referenc@; |DESCARGA_DEF #Referenc@;
   |FINSI;

   aAlfa1 = aAlfa + "dscarter/def/dscam051.mas";
   |CARGA_DEF aAlfa1, Referenc@;
   |SI FSalida = 0;
      aAlfa1 = aAlfa + "dscarter/def/dscam104.mas";
      |CARGA_DEF aAlfa1, dscam104@;
      |SI FSalida = 0;
         aAlfa1 = aAlfa + "dscarter/fich/" + (("00000" + nEmpCart) % -105) + "/";
         |PATH_DAT #Referenc@#aAlfa1#; |PATH_DAT #dscam104@#aAlfa1#;
         |ABRE #Referenc@; |ABRE #dscam104@;

         |LEE 000#Referenc@.p;
         |SI FSalida ! 0; |DDEFECTO #Referenc@; |FINSI;

         |SI #Referenc@#96 = "S";
            |SI modo = 1;
               |SELECT #3#dscam104@;
               #dscam104@#0 = #agifa112#0;
               |LEE 000#dscam104@.=;
               |SI FSalida ! 0;
                  |DDEFECTO #dscam104@;
                  #dscam104@#0 = #agifa112#0;
                  #dscam104@#1 = #agifa112#10;
                  #dscam104@#2 = #agifa112#2;
                  #dscam104@#3 = "N";
                  #dscam104@#4 = "01.01.0000";
                  |GRABA 020#dscam104@.n;
               |FINSI;
               |SELECT #1#dscam104@;
            |FINSI;
            |SI modo = 3;
               |SELECT #3#dscam104@;
               #dscam104@#0 = #agifa112#0;
               |LEE 101#dscam104@.=;
               |SI FSalida = 0;
                  |SI #dscam104@#3 = "S";
                     aAlfa = "    NEste proveedor esta bloqueado en cartera. " + &191 + " Continuar con la baja ?";
                     |CONFI aAlfa;
                     |SI FSalida = 0;
                        |BORRA 020#dscam104@.a; |LIBERA #dscam104@;
                     |SINO;
                        |ERROR;
                     |FINSI;
                  |SINO;
                     |BORRA 020#dscam104@.a; |LIBERA #dscam104@;
                  |FINSI;
               |FINSI;
               |SELECT #1#dscam104@;
            |FINSI;
         |FINSI;
         |CIERRA #dscam104@; |DESCARGA_DEF #dscam104@;
      |FINSI;
      |CIERRA #Referenc@; |DESCARGA_DEF #Referenc@;
   |FINSI;
|FPRC;

|PROCESO PinDesanch;
     |PINTA 2248, "Cambiar PVP:";
     |PINTA 2348, "ÄÄÄÄÄÄÄÄÄÄÄÄ";
     |DDEF aAlfa;
     aAlfa = aAlfa + "desan042";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          #referen@#0 = #0#0;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          |PINTA #referen@#1;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Campo88; |TIPO 0;
     |SI FSalida = 0; |O FSalida = 3;
          |HAZ EsDesanch;
          |SI FSalida = 0;
               aAlfa = "desan042;" + #0#0;
               |SUB_EJECUTA_NP aAlfa;
               |HAZ PinDesanch;
          |FINSI;
          |HAZ EsRavenida;
          |SI FSalida = 0;
               eaProve = #0#0;
               |SUB_EJECUTA_NP "ravem002";
               |HAZ PinRavenida;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO GesenviaCop112;
     |DBASS aPath;
     aAlfa = aPath + "gesenvia/def/gestr000";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          aAlfa = aPath + "gesenvia/fich/";
          |PATH_DAT #referen@#aAlfa#;
          |DFICE aAlfa; aEmp = aAlfa % -205;
          |ABRE #referen@;
          #referen@#0 = aEmp;
          |LEE 000#referen@.=;
          aAlfa = FSalida;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
          |SI aAlfa = 0;
               aAlfa = aPath + "gesenvia/def/gestr070";
               |CARGA_DEF aAlfa, referen@;
               |SI FSalida = 0;
                    aAlfa = aPath + "gesenvia/fich/" + aEmp + "/";
                    |PATH_DAT #referen@#aAlfa#;
                    |ABRE #referen@;
                    |SI modo = 3;
                         #referen@#0 = #0#0;
                         |BORRA 000#referen@.c;
                    |SINO;
                         |DDEFECTO #referen@;
                         #referen@#0 = #0#0;
                         |LEE 101#referen@.=;
                         |SI FSalida ! 0; |GRABA 020#referen@.b; |FINSI;
                         |PARA i = 1; |SI i [ 109; |HACIENDO i = i + 1;
                              #referen@#i# = #0i;
                         |SIGUE;
                         |GRABA 020#referen@.a;
                    |FINSI;
                    |CIERRA #referen@;
                    |DESCARGA_DEF #referen@;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnAuxPrv;
     |HAZ EsCamiCor;
     |SI FSalida = 0;
          eaProve = #0#0;
          |SUB_EJECUTA_NP "camcor31";
     |FINSI;
|FPRC;

|PROCESO CodBanco; |TIPO 0;
     |SI #0Campo ! Contenido;
          |HAZ CalculaIban;
     |FINSI;
|FPRC;

|PROCESO CodSucu; |TIPO 0;
     |SI #0Campo ! Contenido;
          |HAZ CalculaIban;
     |FINSI;
|FPRC;

|PROCESO CalculaIban; |TIPO 0;
     eaCta = (#0#14 % 104) + (#0#15 % 104) + #0#13 + (#0#12 % 110);
     eaPais = #0#89
     |HAZ CalcuIBAN;
     |QBF eaIBAN;
     |SI eaIBAN ! "";
          |PULSATECLA;
          #0#96 = eaIBAN;
          ||PINTA #0#96; || no pinta el campo !!!
          |PINDA #1#0;
     |FINSI;
     eaIBANant = "";
|FPRC;

|PROCESO IBAN7; |TIPO 7;
     aAlfa = #0#96; |QBF aAlfa;
     |SI aAlfa = "";
         eaIBANant = "";
         |HAZ CalculaIban;
     |FINSI;
|FPRC;

|PROCESO IBAN0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     eaCta     = (#0#14 % 104) + (#0#15 % 104) + #0#13 + (#0#12 % 110);
     eaPais    = #0#89;
     eaIBANant = #0#96;
     |HAZ CalcuIBAN;
     aAlfa = eaIBANant; |QBF aAlfa;
     |SI aAlfa ! eaIBAN;
         |SI aAlfa = "";
             #0#96 = eaIBAN;
             |PINTA #0#96;
         |SINO;
             |CONFI "0000SError. Código IBAN incorrecto, quiere calcularlo.";
             |SI FSalida = 0;
                 #0#96 = eaIBAN;
                 |ERROR;
             |FINSI;
         |FINSI;
     |FINSI;
     eaIBANant = "";
|FPRC;

|PROCESO BtnItemDocPrv;
     aAlfa = "tagz0025;PR" + #0#0;
     |SUB_EJECUTA_NP aAlfa;
|FPRC;

|PROCESO T0C0F112;  |TIPO 0;
     |C_M #agifa112#1,  1, "S";
     |C_M #agifa112#89, 1, "S";
     |C_M #agifa112#9,  1, "S";
     |C_M #agifa112#74, 1, "S";
     |C_M #agifa112#10, 1, "S";

     |HAZ CargaContagen;
     |SI enOk = 0;  |ACABA;  |FINSI;

     |C_M #agifa112#10, 1, "N";

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;
         |C_M #agifa112#1,  1, "N";
         |C_M #agifa112#89, 1, "N";
         |C_M #agifa112#9,  1, "N";
         |C_M #agifa112#74, 1, "N";

         |ACABA;
     |FINSI;

     |HAZ cuenta2;

     eaCtaCble = #agifa112#10;
     eaTipo    = "P";
     |HAZ RecogeCliProvCOD;
     |SI enOk = 0;
         |POSICIONATE #agifa112#9;
     |SINO;
         |C_M #agifa112#1,  1, "N";
         |C_M #agifa112#89, 1, "N";
         |C_M #agifa112#9,  1, "N";
         |C_M #agifa112#74, 1, "N";
     |FINSI;
|FPRC;

|PROCESO PinRavenida;
     |PINTA 2247, "%Reparto Maq:";
     |PINTA 2347, "ÄÄÄÄÄÄÄÄÄÄÄÄÄ";
     |DDEF aAlfa;
     aAlfa = aAlfa + "ravem002";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |DDEFECTO #referen@;
          |ABRE #referen@;
          #referen@#0 = #0#0;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          |PINTA #referen@#1;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;
