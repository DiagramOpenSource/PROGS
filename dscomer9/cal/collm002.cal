|FICHEROS;
     collm002 #0;
     agifa024 #24;
|FIN;

|VARIABLES;
     aAlfa = "";
     aNifQbf1   = "";
     aNifQbf2   = "";
     nModo = 0;
     &eaVarDni  = "";
     &enCalcCif = 0;
     &eaPais = "";
|FIN;

|PROCESO MontaCP; |TIPO 0;
     aAlfa = (("00" + #0#4) % -102) + (("000" + #0#5) % -103);
     #0#6 = aAlfa;
|FPRC;

|PROCESO NifSocio; |TIPO 6;
     eaPais = "";

     |SI FSalida = 9;
          eaVarDni  = #0Campo;
          |HAZ CalculoNIFCIF;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     |HAZ CalculoNIFCIF;
     |SI FSalida = 9;
          eaVarDni  = #0Campo;
          |HAZ CalculoNIFCIF;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO AltaSocio; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #24;
          #24#0 = #0#0;
          |LEE 020#24=;
          |SI FSalida = 0;
               #0#5 = #24#182; |PINTA #0#5;
               #0#7 = #24#10; |PINTA #0#7;
               #0#13 = #24#32; |PINTA #0#13;
               #0#14 = #24#33; |PINTA #0#14;
               #0#15 = #24#31; |PINTA #0#15;
               #0#16 = #24#30; |PINTA #0#16;
          |FINSI;
          |CIERRA #24;
     |FINSI;
|FPRC;
