|FICHEROS;
     mecaw028 #0;
     mecaw029 #1,MANTE;   || Tmp
     mecam005 #5;
     mecam006 #6;
     agifa104 #104;
     agifa073 #73;
|FIN;

|VARIABLES;
     aAlfa = "";
     nHay = 0;
     nHayOrd = 0;
     nRecarga = 0;
     nTecla = 0;
|FIN;

|PROCESO Texto; |TIPO 0;
     aAlfa = #1#8; |QBF aAlfa;
     |SI aAlfa = "";
          |AVISO; |ERROR;
     |FINSI;
|FPRC;

|PROCESO LinPedido;
     |ABRE #6;
     |DDEFECTO #6;
     #6#0 = #73#28;
     #6#1 = #73#0;
     #6#2 = #73#1;
     |LEE 101#6=;
     |SI FSalida ! 0; |GRABA 020#6b; |FINSI;
     #6#15 = #5#5;
     #6#16 = #5#6;
     |GRABA 020#6a;
     |LIBERA #6;
     |CIERRA #6;
|FPRC;

|PROCESO MiraOrden;
     |SI #6#8 ! 0;
          nHayOrd = 1;
     |FINSI;
|FPRC;

|DEFBUCLE MiraOrden;
     #6#1;
     ;
     #1#0, #1#1, 001;
     #1#0, #1#1, 999;
     ;
     NULL, MiraOrden;
|FIN;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 13; |O FSalida = 14; |O FSalida = 15;
          nTecla = FSalida;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0; |Y #1Campo = Contenido;
          nHayOrd = 0;
          |BUCLE MiraOrden;
          |SI nHayOrd ! 0;
               |MENAV "0000Hay lineas con orden de producion. No se modifica.";
               |ERROR; |ACABA;
          |FINSI;

          |DDEFECTO #5;
          #5#0 = #1#0;
          #5#1 = #1#1;
          |LEE 101#5=;
          |SI FSalida ! 0; |GRABA 020#5b; |FINSI;

          |SI #1#6 = "*";
               #1#6 = "";
               #1#7 = "01.01.0000";
               #1#8 = "";
               #5#5 = "N";
               #5#6 = #1#7;
               #5#7 = #1#8;
          |SINO;
               |ENCAMPO #8#1;
               |SI FSalida ! 0; |ACABA; |FINSI;
               #1#6 = "*";
               #1#7 = ~;
               #5#5 = "S";
               #5#6 = #1#7;
               #5#7 = #1#8;
          |FINSI;
          |GRABA 020#1a;
          |GRABA 020#5a;
          |LIBERA #5;

          #104#25 = #1#0;
          #104#0 = #1#1;
          |LEE 020#104=;
          |SI FSalida = 0;
               |BUCLELIN 2 LinPedido #104;
          |FINSI;

          |PINTA #1#6;
          |PINTA #1#7;
     |FINSI;
|FPRC;

|PROCESO Min;
     #1#0 = "     ";
     #1#1 = 0;
|FPRC;

|PROCESO Max;
     #1#0 = "zzzzzz";
     #1#1 = 999999;
|FPRC;

|PROCESO Pedido;
     |DDEFECTO #5;
     #5#0 = #104#25;
     #5#1 = #104#0;
     |LEE 000#5=;
     |SI nRecarga = 0;
          |SI #5#5 = "S"; |ACABA; |FINSI;
     |SINO;
          |SI nTecla = 13; |Y #5#5 = "N"; |ACABA; |FINSI;
          |SI nTecla = 14; |Y #5#5 = "S"; |ACABA; |FINSI;
     |FINSI;

     #1#0 = #104#25;
     #1#1 = #104#0;
     #1#2 = #104#1;
     #1#3 = #104#4;
     #1#4 = #104#8;
     #1#5 = #104#45;
     |SI #5#5 = "S";
          #1#6 = "*";
     |SINO;
          #1#6 = "";
     |FINSI;
     #1#7 = #5#6;
     #1#8 = #5#7;
     |GRABA 020#1n;
     nHay = 1;
|FPRC;

|DEFBUCLE Pedido;
     #104#1;
     1, 4;
     #0#0, #0#2, #0#4, #0#6;
     #0#1, #0#3, #0#5, #0#7;
     ;
     NULL, Pedido;
|FIN;

|PROCESO Recarga;
     nRecarga = 1;
     |DELINDEX #1;
     |ABRE #1;
     |BUCLE Pedido;
     |CIERRA #1;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #1 aAlfa;
     |DELINDEX #1;
     |ABRE #1;
     |ABRE #5;
     |BUCLE Pedido;
     |CIERRA #5;
     |CIERRA #1;
     |SI nHay = 0;
          |MENAV "0000No hay registros";
     |SINO;
          |ABRE #104;
          |ABRE #5;
          |PARA nTecla = 1; |SI nTecla ! 0; |HACIENDO;
               nTecla = 0;
               |ENTLINEAL #1#1, 1, 4, 20, 1, Min, Max;
               |SI nTecla ! 0;
                    |HAZ Recarga;
               |FINSI;
          |SIGUE;
          |CIERRA #5;
          |CIERRA #104;
     |FINSI;
     |DELINDEX #1;
|FPRC;
