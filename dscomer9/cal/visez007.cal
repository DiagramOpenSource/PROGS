|FICHEROS;
     visez007 #0;
     visem006 #6;
     agifa017 #17;
     agifa019 #19;
|FIN;

|VARIABLES;
     &Tempo = "";
     nSwCambio = 0;
     aSerie = "";
     nNumero = 0;
     aArticulo = "";
     nHay = 0;
     nClave = 0;
|FIN;

|PROCESO Tipo0; |TIPO 0;
     |SI FSalida ! 0; |O #0Campo ! Contenido;
          |ACABA;
     |FINSI;

     |SI #0#11 = "*";
          #0#11 = "";
     |SINO;
          #0#11 = "*";
     |FINSI;
     |GRABA 020#0a;
     |PINTA #0#11;

     #6#0 = #0#0;
     #6#1 = #0#1;
     #6#2 = #0#2;
     |LEE 121#6=;
     |SI FSalida = 0;
          |SI #0#11 = "*";
               #6#11 = "S";
          |SINO;
               #6#11 = "N";
          |FINSI;
          |GRABA 020#6a;
          |LIBERA #6;
     |FINSI;

     #19#0 = #6#3;
     |LEE 121#19=;
     |SI FSalida = 0;
          #17#0 = #6#3;
          #17#1 = #6#10;
          |LEE 121#17=;
          |SI FSalida = 0;
               |SI #6#11 = "S";
                    #19#13 = #19#13 - #6#5;
                    #17#9 = #17#9 - #6#5;
               |SINO;
                    #19#13 = #19#13 + #6#5;
                    #17#9 = #17#9 + #6#5;
               |FINSI;
               |GRABA 020#19a;
               |GRABA 020#17a;

               |LIBERA #17;
          |FINSI;
          |LIBERA #19;
     |FINSI;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 13; || F5
          nSwCambio = 1;
          aSerie = #0#0;
          nNumero = #0#1;
          aArticulo = #0#3;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO visem006;
     #0#0 = #6#0;
     #0#1 = #6#1;
     #0#2 = #6#2;
     #0#3 = #6#3;
     #0#4 = #6#4;
     #0#5 = #6#5;
     #0#6 = #6#6;
     #0#7 = #6#7;
     #0#8 = #6#8;
     #0#9 = #6#9;
     #0#10 = #6#10;
     #0#11 = "";
     |GRABA 020#0n;
     nHay = 1;
|FPRC;

|DEFBUCLE visem006;
     #6#1;
     11;
     "     ", 000001, 001, "N";
     "zzzzz", 999999, 999, "N";
     be;
     NULL, visem006;
|FIN;

|PROCESO Min;
     #0#0 = "     ";
     #0#1 = 1;
     #0#3 = " " * 20;
     |SI FSalida = "POSICION";
          #0#0 = aSerie;
          #0#1 = nNumero;
          #0#3 = aArticulo;
     |FINSI;
|FPRC;

|PROCESO Max;
     #0#0 = "zzzzz";
     #0#1 = 999999;
     #0#3 = "z" * 20;
|FPRC;

|PROGRAMA;
     |CLS;
     |MENSA "0000Cargando....";
     |HAZ CreaTempo; |NOME_DAT #0#Tempo#; |DELINDEX #0;
     |ABRE #0;
     |BUCLE visem006;
     |CIERRA #0;

     |SI nHay = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |ABRE #6;
          |ABRE #17;
          |ABRE #19;
          |PARA nSwCambio = 1; |SI nSwCambio = 1; |HACIENDO;
               nSwCambio = 0;
               |SI nClave = 0;
                    |ENTLINEAL #2#0, 3, 4, 22, 1, Min, Max;
               |SINO;
                    |ENTLINEAL #3#0, 1, 4, 22, 1, Min, Max;
               |FINSI;
               nClave = nClave + 1;
               nClave = nClave $ 2;
          |SIGUE;
          |CIERRA #19;
          |CIERRA #17;
          |CIERRA #6;
     |FINSI;

     |DELINDEX #0;
|FPRO;
