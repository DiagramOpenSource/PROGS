|FICHEROS;
     agifa131 #0; || propio
     agifa048 #1; || cabecera de escandallo
     agifa049 #2; || lineas de escandallo
     agifa019 #3; || fichero de articulos
     agifa142 #142;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     &Tempo    = "";
     informe   = "agifa131";
     resta     = 0;
|FIN;

|INCLUYE i_escand;

|PROCESO Salir; |TIPO 6;
     |SI FSalida = 1;
          |ERROR;
          |PTEC 807;
     |SINO;
          eaArticulo = #0Campo;
          |HAZ LlenaArticulo;
          |SI FSalida = 0;
               #0Campo = eaArticulo;
               |PINTA #0Campo;
          |SINO;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO LinEscan;
     #0#3 = nCantiEscan;
     #3#0 = #2#2;
     |LEE 001#3=;
     |SI FSalida = 0;
          |SI #3#104 ] #0#3;
               resta = #3#104 - #0#3;
               |SI resta < #3#7;
                    #0#5 = "BAJO MINIMOS";
               |SINO;
                    #0#4 = resta;
                    #0#5 = "";
               |FINSI;
          |SINO;
               #0#4 = #3#104 - #0#3;
               #0#5 = "INSUFICIENTE";
          |FINSI;
     |SINO;
          #0#5 = "INEXISTENTE";
     |FINSI;
     |PRINT;
|FPRC;

|PROCESO miresca;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |ABRE #1;
     #1#0 = #0#0;
     |LEE 001#1=;
     |SI FSalida = 0;
          |ABRE #3;
          aEscan = #0#0;
          |SI #142#159 = "N";
               nMaxNivel = 1;
          |FINSI;
          nCantiEscan = #0#2;
          |HAZ DesglosaEscan;
          |CIERRA #3;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO impri;|TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR informe;
          |SI FSalida = 0;
               |HAZ miresca;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
