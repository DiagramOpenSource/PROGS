|FICHEROS;
 platm026 #0;
|FIN;

|VARIABLES;
 Mensa = "";
 aCod = "";
 nModo = 0;
 nNumero = 0;
 &aCod1 = "";
 &aCod2 = "";
 &aCodigo = "";

     aAlfa      = "";
     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO LetraDni026;
     eaVarDni  = #0Campo;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|CALCULO cont001;|TIPO 7;
nModo = (FEntrada/100)!0;
|SI nModo = 1;
  |ABRE #0;
  |LEE 010#0u;
  |SI FSalida ! 0;
    nNumero = 1;
  |SINO;
    nNumero = #0#0;
    nNumero = nNumero + 1;
  |FINSI;
  |DDEFECTO #0;
  #0#0 = nNumero;
|FINSI;
|FCAL;

|CALCULO MiraNif;
nModo = (FEntrada/100)!0;
|SI nModo = 1;
  |SALVA_FICHA #0;
  |SELECT #2#0;
  |LEE 010#0=;
  |SI FSalida = 0;
    aCod = #0#0;
    Mensa = "0000 Este nif existe con el codigo: "+aCod;
    |MENAV Mensa;
    |ERROR;
  |FINSI;
  |SELECT #1#0;
  |REPON_FICHA #0;
|FINSI;
|FCAL;
