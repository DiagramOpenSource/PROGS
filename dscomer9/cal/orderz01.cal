|FICHEROS;
     orderz01 #0;
     orderm01 #10,MANTE;
|FIN;

|VARIABLES;
     &enCtrFin = 0;
     nRango = 0;
     nGrid = 0;
     nModo = 0;
     nForma = 0;

     nHandle = 0;
     aAlfa = "";
     aClave = "";
     alfa1 = "";
     alfa2 = "";
     nume1 = 0;
     para1 = 0;
     camuf = 0;
     camufz = "";
     clave = "";
|FIN;

|PROCESO Tipo0; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENAV "0000Alta no permitida...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Desencripta;
     clave = aClave;
     camufz = "";
     |PARA para1 = 1; |SI para1 [ 20; |HACIENDO para1 = para1 + 2;
          nume1 = (para1 * 100) + 1;           alfa1 = clave % nume1;
          nume1 = ((para1 + 1) * 100) + 1;     alfa2 = clave % nume1;

          nume1 = &alfa2;
          nume1 = nume1 - 65;

          camuf = &alfa1;
          camuf = camuf - 65;
          camuf = ((camuf * 26) + nume1) / 2;

          camufz = camufz + &camuf;
     |SIGUE;
     aClave = camufz;
|FPRC;

|PROCESO CargaUsu;
     |DIRECTORIO aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "dev/usr/ds_sys.psw"
     |XABRE "", aAlfa, nHandle;
     |SI FSalida ] 0;
          |XLEE nHandle, 200, aAlfa;
          |PARA; |SI FSalida ] 0; |HACIENDO;
               #10#0 = aAlfa % 410;
               aClave = aAlfa % 1420;
               |HAZ Desencripta;
               #10#2 = aClave;
               |GRABA 000#10n;
               |XLEE nHandle, 200, aAlfa;
          |SIGUE;
          |XCIERRA nHandle;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #10;
     |HAZ CargaUsu;
     |PINPA #0#0;
     |LEE 000#10p;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#10, nRango, 1002, 2999, NULL, NULL, NULL;
     nGrid = FSalida;
     enCtrFin = nGrid;
     |HAZ EsperaFin;
     |CIERRA #10;
|FPRO;
