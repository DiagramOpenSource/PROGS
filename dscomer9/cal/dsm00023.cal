|FICHEROS;
     dsm00023 #0;
|FIN;
                ||         1         2         3         4
|VARIABLES;     ||1234567890123456789012345678901234567890
 {-1}aOpera    = "";
     aOpera1   = "PC = Pedidos Compras";
     aOpera2   = "AC = Albaranes Compras";
     aOpera3   = "RC = Adjudicacion Albaranes Compras";
     aOpera4   = "PV = Pedidos Ventas";
     aOpera5   = "AV = Albaranes Ventas";
     aOpera6   = "RV = Adjudicacion Pedidos Ventas";
     aOpera7   = "AD = Adjudicacion Depositos";
     aOpera8   = "FC = Facturas Directa";
     aOpera9   = "TI = Tiquets";
     aOpera10  = "DP = Depositos Ventas";
     aOpera11  = "DV = Devolucion Depositos";
     aOpera12  = "SA = Entrada Stock Inicial";
     aOpera13  = "ES = Entrada Stock";
     aOpera14  = "SS = Salida Stock";
     aOpera15  = "EV = Entrada Valorada Stock";
     aOpera16  = "ME = Movimiento Entrada Almacen";
     aOpera17  = "MS = Movimiento Salida Almacen";
     aOpera18  = "SF = Salida Fabrica Compo/Enva/Monta"
     aOpera19  = "FB = Entrada Fabrica Compo/Enva/Monta";
     aOpera20  = "S1 = Salida Fabrica Proce/Transfor";
     aOpera21  = "F1 = Entrada Fabrica Proce/Transfor";
     aOpera22  = "S2 = Salida Fabrica Desco/Despi/Corte";
     aOpera23  = "F2 = Entrada Fabrica Desco/Despi/Corte";
     aOpera24  = "CI = Carga Inventario";
     aOpera25  = "RI = Recuento Inventario";
     aOpera26  = "RG = Regularizacion Inventario";
     aOpera27  = "FP = Facturas Proformas";
     aOpera28  = "KI = Fabricacion Kits";
     aOpera29  = "DC = Depositos Compras";
     aOPera30  = "OF = Orden Fabricacion";
     aOpera31  = "FIN";                             ||-> Se acabo

 {-1}aOpeUni   = "";
     aOpeUni1  = "SE = Sin Entrada Directa";
     aOpeUni2  = "MA = Manual";
     aOpeUni3  = "AM = Automatico Modificable";
     aOpeUni4  = "AN = Automatico";
     aOpeUni5  = "MT = Unidades x Medidas (dimensiones)";
     aOpeUni6  = "FIN";

 {-1}aOpeUnii  = "";
     aOpeUnii1 = "PM = Peso Medio Articulo/Partida";
     aOpeUnii2 = "PR = Peso Real";
     aOpeUnii3 = "CB = En el Codigo de barras";
     aOpeUnii4 = "MT = Unidades x Medidas (dimensiones)";
     aOpeUnii5 = "FIN";

 {-1}aOpeParti = "";
     aOpeParti1= "SE = Sin Entrada";
     aOpeParti2= "MA = Manual";
     aOpeParti3= "CB = En el Codigo de barras";
     aOpeParti4= "FIN";

 {-1}aOpeMerma = "";
     aOpeMerma1= "SC = No se calcula";
     aOpeMerma2= "DF = Calcula Kgs Teoricos";
     aOpeMerma3= "ME = Calcula Merma Estimada";
     aOpeMerma4= "CB = Diferencia";
     aOpeMerma5= "FIN";

     i         = 0;
     nPos      = 0;
     aOpe      = "";
     aBlanco   = "";
     aParam    = "";
     aAlfa     = "";
     aTipo     = "";
     nModo     = 0;
|FIN;

|PROCESO Crea;
     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |CIERRA #0;
          |ACABA;
     |FINSI;

     aAlfa = "0000SDoble stock/Partidas" + &13 + "Manual(Si) Metros(No)";
     |CONFI aAlfa;
     |SI FSalida = 0;
          aTipo = "MA";
     |SINO;
          aTipo = "MT";
     |FINSI;

     IaOpera = aOpera1<-;
     |PARA; |SI aOpera ! "FIN"; |HACIENDO;
          aAlfa = aOpera % 102;
          #0#0 = aAlfa;
          #0#2 = "PR";
          #0#1 = aTipo;
          #0#3 = "MA";
          #0#4 = "ME";
          |GRABA 020#0b;
          |HAZ Opera;
          IaOpera = IaOpera + 1;
     |SIGUE;

     |CIERRA #0;

     |MENAV "0000Defecto creado, reviselo...";
|FPRC;

|PROCESO CCB; |TIPO 0;
     |SI #0#8 = "S";
          |PARA i = 9; |SI i [ 19; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
     |SINO;
          |PARA i = 9; |SI i [ 19; |HACIENDO i = i + 1;
               |C_M #0i, 1, "N";
               #0i = ""; |PINTA #0i;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO PosLon; |TIPO 7;
     |SI Campo = 6;
          |SI #0#2 = "CB";
               |C_M #0Campo, 1, "S";
          |SINO;
               |C_M #0Campo, 1, "N";
               #0Campo = 0; |PINTA #0Campo;
          |FINSI;
     |SINO;
          |SI #0#3 = "CB";
               |C_M #0Campo, 1, "S";
          |SINO;
               |C_M #0Campo, 1, "N";
               #0Campo = 0; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tecla11; |TIPO 11;
     |SI FSalida ! 13; |ACABA; |FINSI;
     |PUSHV 0501 2380;
     |BLANCO 0828 2070;
     |CUADRO 0828 2170;
     |CUADRO 1029 2069;
     |ATRI R; |PINTA 0929, "               OPERACIONES               "; |ATRI 0;
     aBlanco = " " * 39;

     |SI Campo = 0; IaOpera = aOpera1<-; |FINSI;
     |SI Campo = 1; IaOpera = aOpeUni1<-; |FINSI;
     |SI Campo = 2; IaOpera = aOpeUnii1<-; |FINSI;
     |SI Campo = 3; IaOpera = aOpeParti1<-; |FINSI;
     |SI Campo = 4; IaOpera = aOpeMerma1<-; |FINSI;

     |PARA; |SI aOpera ! "FIN"; |HACIENDO;
          |PARA nPos = 1130; |SI nPos [ 1930; |HACIENDO nPos = nPos + 100;
               |SI aOpera ! "FIN";
                    |PINTA nPos, aBlanco;
                    |PINTA nPos, aOpera;
                    IaOpera = IaOpera + 1;
               |SINO;
                    |PINTA nPos, aBlanco;
               |FINSI;
          |SIGUE;
          |PAUSA;
     |SIGUE;
     |POPV;
     |ERROR;
|FPRC;

|PROCESO Tecla0;
     |HAZ Tecla11;
     |SI FSalida = 0; |Y #0Campo = "  ";
          |ERROR;
     |FINSI;
|FPRC;


|PROCESO Opera; |TIPO 7;
     IaOpera = aOpera1<-;
     |PARA; |SI aOpera ! "FIN"; |HACIENDO;
          aOpe = aOpera % 102;
          |SI aOpe = #0#0;
               aOpe = aOpe + " = ";
               #0#5 = aOpera - aOpe; |PINTA #0#5;
               |GRABA 020#0a;
               |ACABA;
          |FINSI;
          IaOpera = IaOpera + 1;
     |SIGUE;
|FPRC;

|PROCESO Opera0; |TIPO 0;
     IaOpera = aOpera1<-;
     |PARA; |SI aOpera ! "FIN"; |HACIENDO;
          aOpe = aOpera % 102;
          |SI aOpe = #0#0;
               |ACABA;
          |FINSI;
          IaOpera = IaOpera + 1;
     |SIGUE;
     |MENAV "0000Operacion no permitida...";
     |ERROR;
|FPRC;

|PROCESO Min;
     #0#0 = "  ";
|FPRC;

|PROCESO Max;
     #0#0 = "zz";
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;
     |SI aParam = "CREA";                || Lo llama agifa142
          |HAZ Crea;
          |ACABA;
     |FINSI;

     |CLS;
     |CABEZA "Tabla Operaciones";
     |PINPA #0#0;
     |ENTLINEAL #1#0, 1, 2, 20, 0, Min, Max;
|FPRO;
