|FICHEROS;
     guerm218 #0; || Tmp
     guerm215 #1; || Fecha Carga
     guerm205 #205,MANTE; || Salidas
     guerm207 #207;
     guerm210 #210;
     guerm211 #211;
|FIN;

|VARIABLES;
     nSigue = 0;
     &Tempo = "";
     aAlfa = "";
     aTmp0 = "";
     nHay = 0;
     nModo = 0;
|FIN;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|PROCESO Finaliza;
     |SI #0#6 = "S";
          |C_M #0#7, 1, "N";
          |ABRE #205;
          #205#0 = #0#0;
          |LEE 121#205=;
          |SI FSalida = 0;
               |ABRE #211;
               |DDEFECTO #211;
               #211#0 = #205#48;
               #211#1 = #205#49;
               #211#2 = #205#54;   || Es 0 cuando se crea de forma manual
               |LEE 000#211=;
               |SI FSalida = 0;
                    || #205#53 = #211#6;
                    |ABRE #210;
                    #210#0 = #211#0;
                    #210#1 = #211#1;
                    |LEE 020#210=;
                    |CIERRA #210;
                    |ABRE #207;
                    #207#0 = #210#6;
                    |LEE 000#207=;
                    |SI FSalida = 0;
                         #205#53 = #207#11;
                    |SINO;
                         #205#53 = "N";
                    |FINSI;
                    |CIERRA #207;
               |FINSI;
               |CIERRA #211;

               |PUSHV 01012380;
               |CLS;
               |PINPA #0#205;
               |PINDA #0#205;
            |||   |PTEC 815;          || Av-pag
               |ENDATOS #2#205;
               |SI FSalida = 0;
                    |GRABA 020#205a;
                    |CONFI "0000NImprimir Orden?";
                    |SI FSalida = 0;
                         |IMPRE 0;
                         |SI FSalida = 0;
                              |INFOR "guerm205";
                              |SI FSalida ! 0;
                                   |MENAV "0000No existe informe 'guerm205'";
                              |SINO;
                                   |BUCLELIN 2 Imprime #205;
                                   |PIEINF;
                                   |FININF;
                              |FINSI;
                              |FINIMP;
                         |FINSI;
                    |FINSI;
               |FINSI;
               |POPV;
          |FINSI;
          |CIERRA #205;
     |SINO;
          |C_M #0#7, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |ABRE #205;
     #205#0 = #0#0;
     |LEE 000#205=;
     |SI #205#26 = "S";
          |MENAV "0000Orden Facturada...";
          |ERROR; |ACABA;
     |FINSI;
     |CIERRA #205;

     |SI nModo = 3;
          |CONFI "0000NBorrar Salida?";
          |SI FSalida ! 0;
               |ERROR;
          |SINO;
               |ABRE #205;
               #205#0 = #0#0;
               |LEE 121#205=;
               |SI FSalida = 0;
                    |PUSHV 01012380;
                    |BUCLELIN 1NULL#205;
                    |POPV;
                    |BORRA 020#205a;
               |FINSI;
               |CIERRA #205;
          |FINSI;
     |SINO;
          |ABRE #205;
          #205#0 = #0#0;
          |LEE 121#205=;
          |SI FSalida = 0;
               |ABRE #211;
               #211#0 = #205#48;
               #211#1 = #205#49;
               #211#2 = #205#54; || Es 0 cuando se crea de forma manual
               |LEE 000#211=;
               |SI #0#6 = "N";
                    #205#52 = #0#7;
                    #205#53 = "P";
               |SINO;
                    #205#52 = "";
                    |SI FSalida = 0;
                         ||#205#53 = #211#6;
                         |ABRE #210;
                         #210#0 = #211#0;
                         #210#1 = #211#1;
                         |LEE 000#210=;
                         |CIERRA #210;
                         |ABRE #207;
                         #207#0 = #210#6;
                         |LEE 000#207=;
                         |SI FSalida = 0;
                              #205#53 = #207#11;
                         |SINO;
                              #205#53 = "N";
                         |FINSI;
                         |CIERRA #207;
                    |FINSI;
               |FINSI;
               #205#51 = #0#6;
               |GRABA 020#205a;
               |CIERRA #211;
          |FINSI;
          |CIERRA #205;
     |FINSI;
|FPRC;

|PROCESO CargaSali;
     #0#0 = #205#0;
     #0#1 = #205#48;
     #0#2 = #205#49;
     #0#3 = #205#50;
     #0#4 = #205#1;
     #0#5 = #205#11;
     #0#6 = #205#51;
     #0#7 = #205#52;
     |GRABA 020#0n;
     nHay = 1;
|FPRC;

|DEFBUCLE CargaSali;
     #205#6;
     47;
     #1#0, 000001, "S";
     #1#0, 999999, "S";
     ;
     NULL, CargaSali;
|FIN;

|PROCESO Max;
     #0#0 = 999999;
|FPRC;

|PROCESO Min;
     #0#0 = 1;
|FPRC;


|PROCESO NoAlta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |ERROR; |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ CreaTempo; aTmp0 = Tempo; |NOME_DAT #0#Tempo#; |DELINDEX #0;
     |ABRE #1;
     |CLS;
     |PINPA #0#0;
     |ENTLINEAL #1#0, 1, 7, 22, 0, Min, Max;
     |PINDA #0#1;
     #1#0 = ~;
     |ENCAMPO #0#1;
     |SI FSalida = 0;
          nSigue = 1;
          |LEE 000#1=;
          |SI FSalida = 0;
               nSigue = 0;
               aAlfa = "0000Proceso bloqueado por otro usuario:" + #1#1;
               |QBF aAlfa;
               aAlfa = aAlfa + &13 + #1#2 + " " + #1#3;
               |MENAV aAlfa;
               |CONFI "0000NContinuar S/N";
               |SI FSalida = 0;
                    |BORRA 020#1c;
                    nSigue = 1;
               |FINSI;
          |FINSI;
          |SI nSigue = 1;
               #1#1 = Usuario % 810;
               #1#2 = ~;
               |HORA aAlfa;
               #1#3 = aAlfa;
               #1#4 = "guerm215";
               |GRABA 020#1n;
               |SI FSalida = 0;
                    |ABRE #0;
                    |BUCLE CargaSali;
                    |CIERRA #0;
                    |SI nHay = 0;
                         |MENAV "0000No hay salidas para esta fecha";
                    |SINO;
                         |ENTLINEAL #1#0, 1, 2, 22, 0, Min, Max;
                    |FINSI;
                    |BORRA 040#1c;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #1;
     |DELINDEX #0; Tempo = aTmp0; |HAZ BoraTempo;
|FPRO;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 10;
          |ABRE #205;
          #205#0 = #0#0;
          |LEE 020#205=;
          |PUSHV 0101 2380;
          |CLS;
          |PINPA #0#205;
          |PINDA #0#205;
          |ENDATOS #4#205;
          |POPV;
          |CIERRA #205;
     |FINSI;
|FPRC;
