|FICHEROS;
     clipr066 #0;
     clipr067 #1;
     clipr004 #4;
     clipr001 #10;
     clipr077 #77;
     clipr078 #78;
     agifa084 #84;
|FIN;

|VARIABLES;
     &aCon_Serie = "";
     &aCon_Clave = "liquidac";
     &nCon_Conta = 0;
     nModo = 0;
     nLin = 0;
     nComi = 0;
     i = 0;
     aAlfa = "";
|FIN;

|CALCULO contaliq;
 aCon_Serie = #0#0;
 aCon_Clave = "liquidac";
 nCon_Conta = 0;
 |HAZ ContadorFicClip;
 #0#1 = nCon_Conta;
 |PINTA #0#1;
|FCAL;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000SImprimir liquidacion:";
     |SI FSalida = 0;
          |HAZ Tipo4;
     |FINSI;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |VARIABLES;
          &ser_liq = "";
          &num_liq = 0;
          &fec_liq = @;
     |FIN;

     ser_liq = #clipr066#0;
     num_liq = #clipr066#1;
     fec_liq = #clipr066#2;
     |SUB_EJECUTA "clipr071";
|FPRC;

|PROCESO FactuCon
     #78#2 = #84#48;
     |LEE 000#78=;
     |SI FSalida ! 0; |ACABA; |FINSI; || No existe Especialidad en Relacion

     #77#0 = #78#1;
     |LEE 000#77=;
     |SI FSalida ! 0; |ACABA; |FINSI; || No existe Especialidad

     #1#6 = #84#48;
     #1#7 = #84#0;
     |LEE 000#1=;
     |SI FSalida = 0; |ACABA; |FINSI;   || Ya existe

     #10#0 = #84#60;
     |LEE 000#10=;
     |SI FSalida ! 0; |ACABA; |FINSI;   || No existe Empresa

     |SI #10#3 ! #0#3; |ACABA; |FINSI;  || Es de otro colaborador

     nComi = 0;
     |PARA i = 39; |SI i [ 51; |HACIENDO i = i + 1;
          |SI #4i = #77#0;
               |SI i = 39; nComi = #4#13; |FINSI;
               |SI i = 40; nComi = #4#18; |FINSI;
               |SI i = 41; nComi = #4#19; |FINSI;
               |SI i = 42; nComi = #4#20; |FINSI;
               |SI i = 43; nComi = #4#21; |FINSI;
               |SI i = 44; nComi = #4#22; |FINSI;
               |SI i = 45; nComi = #4#23; |FINSI;
               |SI i = 46; nComi = #4#24; |FINSI;
               |SI i = 47; nComi = #4#25; |FINSI;
               |SI i = 48; nComi = #4#26; |FINSI;
               |SI i = 49; nComi = #4#33; |FINSI;
               |SI i = 50; nComi = #4#35; |FINSI;
               |SI i = 51; nComi = #4#37; |FINSI;
               |SAL;
          |FINSI;
     |SIGUE;

     nLin = nLin + 1;
     |DDEFECTO #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = nLin;
     #1#3 = #10#0;
     #1#4 = #10#1;
     #1#5 = #77#2;
     #1#6 = #84#48;
     #1#7 = #84#0;
     #1#8 = #84#16+#84#19#84#22+#84#28+#84#42+#84#45;
     #1#9 = nComi; || %Comi
     #1#10 = #1#8 % #1#9;
     #1#11 = #0#3;
     |GRABA 020#1n;

     #0#9 = #0#9 + #1#10;
     |PINTA #0#9;
|FPRC;

|DEFBUCLE FactuCon;
     #84#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, FactuCon;
|FIN;

|PROCESO Tipo5; |TIPO 5;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     nLin = 0;

     |ABRE #4;
     #4#0 = #0#3;
     |LEE 020#4=;
     |CIERRA #4;

     |SELECT #2#1;
     |ABRE #10;
     |ABRE #78; |SELECT #2#78;
     |ABRE #77;
     |BUCLE FactuCon;
     |CIERRA #77;
     |CIERRA #78;
     |CIERRA #10;
     |SELECT #1#1;
|FPRC;
