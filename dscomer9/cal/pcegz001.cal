|| NO se puede agregar mas ficheros

|FICHEROS;
     pcegz001 #0;
     pcegm002 #2; || Ofertas C
     pcegm003 #3; || Ofertas L
     pcegm004 #4; || Pedidos C
     pcegm005 #5; || Pedidos L
     pcegz006 #6; || Ventana Espera
     pcegz007 #7,MANTE; || Motivo Rechazo
     pcegz009 #9,MANTE; || Observa. Pedido
     agifa010 #10;
     pcegz011 #11,MANTE; || Aceptar Oferta
     pcegm012 #12; ||Aux arti
     pcegz013 #13,MANTE; || Confirma Pedido
     pcegz014 #14,MANTE; || Rechaza Pedido
     pcegz015 #15,MANTE; || Reservar unidades
     pcegm016 #16;       || Relacion albaranes
     pcegz017 #17,MANTE;
     agifa019 #19;
     pcegz037 #37;
     pcegm020 #20;
     pcegm023 #23;       || Etiquetas/Paquetes
     pcegm029 #29;
     agifa024 #24;
     agifa027 #27;
     pcegm040 #40;
     pcegm042 #42; || Reparaciones C
     pcegm043 #43; || Reparaciones L
     agifa071 #71;
     agifa080 #80;
     agifa091 #91;
     agifm001 #101; || Zonas
     pcegm006 #106; || Obse. Pedido
     pcegm007 #107; || Zonas por paises
     pcegm024 #124;
     agifa142 #142;
     agifa134 #134;
     dsm00225 #225; ||Paises
     agifa321 #321;
     agifa324 #324;
     pcegm039 #390
     agis0002 #1002;
     dsm00003 #1003;
     pcegm011 #1011;
     dsm00020 #1020;
     gestempo;
     pcegm005@;
     &pcegm042@ #500;
     &pcegm043@ #501;
|FIN;

|VARIABLES;
     &eaArtRep = "";
     &eaSerie = "";
     &enDocu = 0;
     &eaTipo = "";
     &enError = 0;
     &enTipoTexto = 0;
     &eaTexto = "";
     &eaCierra = "";
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     {-1}aGet       = 0;
         aGet1      = 0;
         aGet2      = 0;
     &enRechaza = 0;
     &enAnula = 0
     &eaImpresora = "";
     &aDivisa = "";
     &aMoneda = "";
     &enForma = 0;
     &eaTipoImp = "";
     &ser_ped = "";
     &num_ped = 0;
     &enSwMenu = 0;
     &enModo = 0;
     &eaSerFac = "";
     &enNumFac = 0;
     aRese = "N";
     aServ = "N";
     aFact = "N";
     aArti = "";
     aEsCalibra = "";
     fFecha = @;
     nClaveOfe = 0;
     nClavePed = 0;
     aRecha = "";
     nCobrado = 0;
     nTecla = 0;
     nOk = 0;
     nSwVer = 0;
     aEstado = "";
     nNume = 0;
     nLin = 0;
     nConta = 0;
     aAlfa = "";
     nSal = 0;
     aPath = "";
     nPestana = 0;
     nPanta0 = 0;
     nPanOfe = 0;
     nPanPed = 0;
     nPanFac = 0;
     nPanPaq = 0;
     nVentana0 = 0;
     nVentana1 = 0;
     nVenEspera = -1;

     nBtnActualiza = 0;
     nBtnModiCli = 0;
     nBtnNuevoCli = 0;
     nBtnNuevoDir = 0;

     nGridOfeC = -1;
     nGridOfeL = -1;
     nFocoOfe = 0;
     nBtnOfePen = 0;
     nBtnOfeAce = 0;
     nBtnOfeRecha = 0;
     nBtnOfeToda = 0;
     nBtnOfeImp = 0;
     nBtnOfeFax = 0;
     nBtnOfeMail = 0;
     nBtnOfeVer = 0;
     nBtnOfeSal = 0;
     nBtnOfePenNueva = -1;
     nBtnOfePenAcep = -1;
     nBtnOfePenRecha = -1;
     nBtnOfePenModi = -1;
     nBtnOfeAceVerPed = -1;
     nBtnOfeAceRecha = -1;
     nBtnOfeAceAnula = -1;
     nBtnOfeRechaNueva = -1;
     nBtnOfeRechaMotivo = -1;
     nBtnOfeRechaAnula = -1;

     nGridPedC = -1;
     nGridPedL = -1;
     nFocoPed = 0;
     nBtnPedPen = 0;
     nBtnPedConf = 0;
     nBtnPedRecha = 0;
     nBtnPedCali = 0;
     nBtnPedApar = 0;
     nBtnPedSin = 0;
     nBtnPedPdt = 0;
     nBtnPedTodo = 0;
     nBtnPedNuevo = 0;
     nBtnPedObs = 0;
     nBtnPedVer = 0;
     nBtnPedWeb = 0;
     nBtnPedImp = 0;
     nBtnPedFax = 0;
     nBtnPedMail = 0;
     nBtnPedSal = 0;
     nBtnPedPenConf = -1;
     nBtnPedPenCobro = -1;
     nBtnPedPenModi = -1;
     nBtnPedPenRecha = -1;
     nBtnPedPenFact = -1;
     nBtnPedPenFase = -1;
     nBtnPedConfCobro = -1;
     nBtnPedConfFact = -1;
     nBtnPedConfModi = -1;
     nBtnPedConfRecha = -1;
     nBtnPedConfVServ = -1;
     nBtnPedConfVFact = -1;
     nBtnPedConfAdj = -1;
     nBtnPedConfFase = -1;
     nBtnPedConfAlb = -1;
     nBtnPedConfAnula = -1;
     nBtnEnvAlema = -1;
     nBtnPedConfPedir = -1;
     nBtnPedConfReser = -1;
     nBtnPedRechaNueva = -1;
     nBtnPedRechaVer = -1;
     nBtnPedRechaAnu = -1;
     nBtnPedCaliSele = -1;
     nBtnPedAparSele = -1;
     nBtnPedSinSele = -1;
     nBtnPedPdtSele = -1;
     nBtnPedTodoSele = -1;

     nBtnDatoEnvio = 0;
     nBtnRelaAgen = 0;
     nPanta = 0;

     nGridFac = 0;
     nFocoFac = 0;
     nBtnFacSer = 0;
     nBtnFacImp = 0;
     nBtnFacPaq = 0;
     nBtnFacSal = 0;

     nGridPaq = 0;
     nFocoPaq = 0;
     nBtnPaqVer = 0;
     nBtnPaqImp = 0;
     nBtnPaqSal = 0;

     nPanRep = 0;
     nGridRepC = -1;
     nGridRepL = -1;
     nFocoRep = 0;
     nBtnRepEnt = 0;
     nBtnRepOfe = 0;
     nBtnRepArep = 0;
     nBtnRepAfac = 0;
     nBtnRepCer = 0;
     nBtnRepTodo = 0;
     nBtnRepSal = 0;

     nBtnRepCierra1 = -1;
     nBtnRepNuevo1 = -1;
     nBtnRepVer1 = -1;
     nBtnRepModi1 = -1;
     nBtnRepBorra1 = -1;
     nBtnRepAofe1 = -1;
     nBtnRepImp1 = -1;
     nBtnRepLin = -1;
     nBtnRepModOfe2 = -1;
     nBtnRepBorrOfe2 = -1;
     nBtnRepVerOfe2 = -1;
     nBtnRepImpOfe2 = -1;
     nBtnRepARep2 = -1;
     nBtnRepVerOfe3 = -1;
     nBtnRepVerPed3 = -1;
     nBtnRepImpOfe3 = -1;
     nBtnRepImpVacio3 = -1;
     nBtnRepImp3 = -1;
     nBtnRepAfac3 = -1;
     nBtnRepAofe3 = -1;
     nBtnRepImpPed3 = -1;
     nBtnRepModPed3 = -1;
     nBtnRepRese3 = -1;
     nBtnRepArepa4 = -1;
     nBtnRepCierra4 = -1;
     nBtnRepModi4 = -1;
     nBtnRepTodo4 = -1;
     nBtnRepImpFac5 = -1;
     nBtnRepVerSer5 = -1;
     nBtnRepSelec6 = -1;
     nPanRep1 = 0;
     nBtnNueva = 0;
     nBtnConsu = 0;
     nBtnModifi = 0;
     nBtnBaja = 0;
     nClaveRep = 0;
     aBotonRep = "";
     aBotonRep1 = "";
     &enEdiRep = 0;

     aEstadoBtnIni = "";

     {20} aPopup = "";
     nPos1 = 0;
     nPos2 = 0;
     nRango = 0;
     aEsc1 = "";
     aEsc2 = "";
     aRetu = "";
     aTecla = "";
     aHSituOfe = "";
     aDSituOfe = "";
     aHSituPed = "";
     aDSituPed = "";
     nDTipoPed = 0;
     nHTipoPed = 0;
     nPrimera = 0;
     nModo = 0;
     nSwBloquea = 0;
     nHay = 0;
     nUni = 0;
     i = 0;
     {-1}aVent = "";
         aVent1 = 0;
         aVent2 = 0;
         aVent3 = 0;
         aVent4 = 0;
         aVent5 = "";
     aAuto = "";
     &eaEmp = "";
     aFich = "";
     &eaFich = "";
     aFichero = "";
     nHandle = 0;
     aPestana = "";
     aGuardaPestana = "";
     aProg = "";
     aCliente = "";
     aBotonOfe = "";
     aClaveOfe = "";
     aBotonPed = "";
     aClavePed = "";
     aClaveFac = "";
     aClavePaq = "";
     aClaveRep = "";
     aPosicion = "";
     nPendiente = 0;
     aHayCal = "";
     aAlf1 = "";
     aAlf2 = "";
     aAlf3 = "";
     aAlf4 = "";
     aAlf5 = "";
     aAlf6 = "";
     nDepar = 0;
     aSer = "";
     nNum = 0;
     nError = 0;
     nRese = 0;
     nSwRese = 0;
|FIN;

|PROCESO PonClaveOfe;
     |SI nClaveOfe = 3; |SELECT #3#2; |FINSI;
     |SI nClaveOfe = 4; |SELECT #4#2; |FINSI;
     |SI nClaveOfe = 5; |SELECT #5#2; |FINSI;
|FPRC;

|PROCESO PonClavePed;
     |SI nClavePed = 3; |SELECT #3#4; |FINSI;
     |SI nClavePed = 4; |SELECT #4#4; |FINSI;
     |SI nClavePed = 5; |SELECT #5#4; |FINSI;
     |SI nClavePed = 6; |SELECT #6#4; |FINSI;
     |SI nClavePed = 7; |SELECT #7#4; |FINSI;
     |SI nClavePed = 8; |SELECT #8#4; |FINSI;
|FPRC;

|PROCESO FinVentanaEspera;
     |SI nVenEspera = -1; |ACABA; |FINSI;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVenEspera;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVenEspera;
|FPRC;

|PROCESO IniVentanaEspera;
     |VENTANA 1512, 2291, -1, 17, "Mensaje";
     nVenEspera = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVenEspera;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PINPA #0#6;
     |PTEC 802;
     |PAUSA;
|FPRC;
--------------------REPARACIONES-----------------------------------------
|PROCESO ExisteRep;
     |ABRE #42;
     #42#0 = #pcegm042@#0;
     #42#1 = #pcegm042@#1;
     |LEE 000#42=;
     aAlfa = FSalida;
     |CIERRA #42;
     FSalida = aAlfa;
|FPRC;

|PROCESO BtnRepCierra1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     |HAZ TextoRep1;
     |SI enError = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               eaSerFac = "";
               enNumFac = 0;
               |SI eaCierra = "P";
                    |HAZ AlbFac0;
               |SINO;
                    enError = 0;
               |FINSI;
               |SI enError = 0;
                    #pcegm042@#19 = eaTexto;
                    #pcegm042@#22 = "C";
                    #pcegm042@#23 = eaSerFac;
                    #pcegm042@#24 = enNumFac;
                    #pcegm042@#25 = #10#52;
                    #pcegm042@#26 = #10#0;

                    aAlfa = Usuario % 810;
                    fFecha = ~;
                    |SI eaCierra = "P";
                         #pcegm042@#12 = fFecha;
                         #pcegm042@#13 = aAlfa;
                         #pcegm042@#17 = fFecha;
                         #pcegm042@#18 = aAlfa;
                    |SINO;
                         aAlfa = aAlfa + "/" + fFecha;
                         #pcegm042@#19 = aAlfa;
                    |FINSI;

                    |GRABA 020#pcegm042@.a;
                    |LIBERA #pcegm042@;
                    enForma = -1; eaArtRep = #pcegm042@#7; |HAZ StockRep;

                    |CONFI "0000N¿Generar etiqueta de envio?";
                    |SI FSalida = 0;
                         eaSerie = #pcegm042@#0;
                         enDocu = #pcegm042@#1;
                         eaTipo = "RE";
                         |SUB_EJECUTA_NP "pcegz019";
                    |FINSI;
                    #pcegm042@#0 = 0;
                    |REFRESCACONTROL nGridRepL;
                    |REFRESCACONTROL nGridRepC;
               |FINSI;
               |GRABA 020#pcegm042@.a;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnRepNuevo1;
     enEdiRep = 1;
     |HAZ EditaRep;
     |SI enError = 0;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepVer1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     enEdiRep = 4;
     |HAZ EditaRep;
|FPRC;

|PROCESO BtnRepModi1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     enEdiRep = 2;
     |HAZ EditaRep;
     |SI enError = 0;
          |REFRESCACONTROL nGridRepC;
          |REFRESCACONTROL nGridRepL;
     |FINSI;
|FPRC;

|PROCESO BorLinRep;
     |BORRA 020#pcegm043@.a;
|FPRC;

|DEFBUCLE BorLinRep;
     #pcegm043@#1003;
     ;
     #42#0, #42#1, 001;
     #42#0, #42#1, 999;
     be;
     NULL, BorLinRep;
|FIN;

|PROCESO BtnRepBorra1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     |SI #pcegm042@#16 ! 0;
          |MENAV "0000Parte reparaci¢n pasado a oferta...";
     |SINO;
          aAlfa = "0000N¿Borrar parte de reparaci¢n: " + #pcegm042@#0 + "/" + (("000000" + #pcegm042@#1) % -106) + "?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |LEE 121#pcegm042@.=;
               |SI FSalida = 0;
                    enForma = -1; eaArtRep = #pcegm042@#7; |HAZ StockRep;
                    |BORRA 020#pcegm042@.a;
                    #42#0 = #pcegm042@#0;
                    #42#1 = #pcegm042@#1;
                    |BUCLE BorLinRep;
                    |LIBERA #pcegm042@;
               |FINSI;
               |REFRESCACONTROL nGridRepL;
               |REFRESCACONTROL nGridRepC;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Borra40;
     |BORRA 020#40a;
|FPRC;

|DEFBUCLE Borra40;
     #40#1;
     ;
     #2#48, #2#0, 001;
     #2#48, #2#0, 999;
     be;
     NULL, Borra40;
|FIN;

|PROCESO BtnRepAofe1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     nSal = 1;
     enTipoTexto = 2;
     |HAZ TextoRep;
     |SI enError = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               |SALVA_DATOS #pcegm042@;
               |REPON_DATOS #42;
               |SALVA_DATOS #2;
               |SELECT #1#2;
               |HAZ CreaOfeRepa;
               |SI FSalida = 0;
                              ||Programa + Modo + Clave + aCli + aDir
                    aProg = "*pcegz004;" + "2" + #2#48 + (("000000" + #2#0) % -106) + #2#3 + (("000" + #2#80)%-103);
                    |SUB_EJECUTA_NP aProg;
                    |LEE 000#2=;
                    |SI FSalida = 0;
                         #pcegm042@#12 = ~;
                         aAlfa = Usuario % 810;
                         #pcegm042@#13 = aAlfa;
                         #pcegm042@#14 = eaTexto;
                         #pcegm042@#15 = #2#48;
                         #pcegm042@#16 = #2#0;
                         #pcegm042@#22 = "O";
                         |GRABA 020#pcegm042@.a;
                         nSal = 0;
                    |SINO;
                         |BUCLE Borra40;
                    |FINSI;
               |FINSI;
               |REPON_DATOS #2;
               |HAZ PonClaveOfe;
               |LEE 000#2=;
          |FINSI;
          |LIBERA #pcegm042@;

          |SI nSal = 0;
               |SALVA_DATOS #pcegm042@;
               #pcegm042@#0 = 0;
               |REFRESCACONTROL nGridRepL;
               |REPON_DATOS #pcegm042@;
               |REFRESCACONTROL nGridRepC;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImpreRepa;
     |PRINT;
|FPRC;

|DEFBUCLE ImpreRepa;
     #43#1;
     ;
     #42#0, #42#1, 001;
     #42#0, #42#1, 999;
     ;
     NULL, ImpreRepa;
|FIN;

|PROCESO BtnRepImp1;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "E"; |ACABA; |FINSI;

     |SALVA_DATOS #pcegm042@;
     |REPON_DATOS #42;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "pcegm042";
          |SI FSalida = 0;
               |BUCLE ImpreRepa;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO BtnRepLin2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     |HAZ EditaRepLin;
     |SI enError = 0;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepModOfe2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "2" + #pcegm042@#15 + (("000000" + #pcegm042@#16) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BorraOferLin;
     |BORRA 020#3a;
     |ABRE #390;
     #390#0 = #3#20;
     #390#1 = #3#0;
     #390#2 = 0;
     |LEE 101#390];
     |PARA; |SI FSalida = 0; |Y #390#0 = #3#20; |Y #390#1 = #3#0; |HACIENDO;
          |BORRA 020#390a;
          |LIBERA #390;
          |LEE 101#390s;
     |SIGUE;
     |CIERRA #390;
|FPRC;

|PROCESO BtnRepBorrOfe2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 121#2=;
     |SI FSalida = 0;
          |SI #2#83 ! "P";
               |SI #2#83 = "A"; |MENAV "0000Oferta aceptada, no se puede borrar..."; |FINSI;
               |SI #2#83 = "R"; |MENAV "0000Oferta rechazada, no se puede borrar..."; |FINSI;
          |SINO;
               aAlfa =  #2#48 + "/" + (("000000" + #2#0) % -106);
               aAlfa = "0000N¨Borra oferta: " + aAlfa + "?";
               |CONFI aAlfa;
               |SI FSalida = 0;
                    |BORRA 020#2a;
                    |BUCLELIN 0 BorraOferLin #2;

                    |LEE 121#pcegm042@.=;
                    #pcegm042@#12 = "01.01.0000";
                    #pcegm042@#13 = "";
                    #pcegm042@#15 = "";
                    #pcegm042@#16 = 0;
                    #pcegm042@#22 = "E";
                    |GRABA 020#pcegm042@.a;
                    |LIBERA #pcegm042@;

                    |SALVA_DATOS #pcegm042@;
                    #pcegm042@#0 = 0;
                    |REFRESCACONTROL nGridRepL;
                    |REPON_DATOS #pcegm042@;
                    |REFRESCACONTROL nGridRepC;
                    |REFRESCACONTROL nGridOfeC;
               |FINSI;
          |FINSI;
     |FINSI;
     |REPON_DATOS #2;
     |HAZ PonClaveOfe;
     |LEE 000#2=;
|FPRC;

|PROCESO BtnRepVerOfe2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "4" + #pcegm042@#15 + (("000000" + #pcegm042@#16) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnRepImpOfe2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 020#2=;
     |SI FSalida = 0;
          |HAZ IniVentanaEspera;
          aAuto = "1";
                     ||Programa + Clave + Reimprimir +  Modo impresion
          aProg = "pcegz002"+ #2#48 + (("000000" + #2#0) % -106) + #2#10 + "P";
          |PTEC 807;
     |FINSI;
     |HAZ PonClaveOfe;
     |REPON_DATOS #2;
     |LEE 000#2=;
|FPRC;

|PROCESO BtnRepARep2;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "O"; |ACABA; |FINSI;

     aAlfa = "0000N¨Cambiar situaci¢n parte: " + #pcegm042@#0 + "/" + (("000000"+#pcegm042@#1)%-106) + " a reparar?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               |SALVA_DATOS #2;
               |SELECT #1#2;
               #2#48 = #pcegm042@#15;
               #2#0 = #pcegm042@#16;
               |LEE 020#2=;
               |SI FSalida = 0;
                    #pcegm042@#22 = "R";
                    |GRABA 020#pcegm042@.a;
                    |LIBERA #pcegm042@;

                    |SALVA_DATOS #4;
                    |SELECT #1#4;

                    |HAZ Carga11;
                    #11#121 = "C";
                    |HAZ AceptaOferta;

                    |REPON_DATOS #4;
                    |HAZ PonClavePed;
                    |LEE 000#4=;
                    |REFRESCACONTROL nGridPedC;
               |FINSI;
               |HAZ PonClaveOfe;
               |REPON_DATOS #2;
               |LEE 000#2=;
               |REFRESCACONTROL nGridOfeC;
          |FINSI;
          |SALVA_DATOS #pcegm042@;
          #pcegm042@#0 = 0;
          |REFRESCACONTROL nGridRepL;
          |REPON_DATOS #pcegm042@;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepLin3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |HAZ EditaRepLin;
     |SI enError = 0;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepVerOfe3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "4" + #pcegm042@#15 + (("000000" + #pcegm042@#16) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnRepVerPed3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 000#2=;
     |SI FSalida = 0;
          |HAZ IniVentanaEspera;
          aAuto = "1";
                                   ||Programa + Modo + Clave
          aProg = "pcegz008" + "4" + #2#60 + (("000000" + #2#61) % -106);
          |PTEC 807;
     |FINSI;
     |HAZ PonClaveOfe;
     |REPON_DATOS #2;
     |LEE 000#2=;
|FPRC;

|PROCESO BtnRepImpOfe3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |HAZ BtnRepImpOfe2;
|FPRC;

|PROCESO BtnRepImpVacio3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |SALVA_DATOS #pcegm042@;
     |REPON_DATOS #42;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "pcegmv42";
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO BtnRepImp3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |HAZ BtnRepImp1;
|FPRC;

|PROCESO BtnRepAfac3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     aAlfa = "0000N¨Cambiar situaci¢n parte: " + #pcegm042@#0 + "/" + (("000000"+#pcegm042@#1)%-106) + " a facturar?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               #pcegm042@#22 = "F";
               |GRABA 020#pcegm042@.a;
               |LIBERA #pcegm042@;
          |FINSI;
          |SALVA_DATOS #pcegm042@;
          #pcegm042@#0 = 0;
          |REFRESCACONTROL nGridRepL;
          |REPON_DATOS #pcegm042@;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepAofe3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     aAlfa = "0000N¨Cambiar situaci¢n parte: " + #pcegm042@#0 + "/" + (("000000"+#pcegm042@#1)%-106) + " a oferta?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               #pcegm042@#22 = "O";
               |GRABA 020#pcegm042@.a;
               |LIBERA #pcegm042@;

               |SALVA_DATOS #2;
               |SELECT #1#2;
               #2#48 = #pcegm042@#15;
               #2#0 = #pcegm042@#16;
               |LEE 020#2=;
               |SI FSalida = 0;
                    |SELECT #1#4;
                    |HAZ BorraPedido;
                    |HAZ PonClavePed;
                    |REFRESCACONTROL nGridPedC;
               |FINSI;
               |HAZ PonClaveOfe;
               |REPON_DATOS #2;
               |LEE 000#2=;
          |FINSI;
          |SALVA_DATOS #pcegm042@;
          #pcegm042@#0 = 0;
          |REFRESCACONTROL nGridRepL;
          |REPON_DATOS #pcegm042@;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepImpPed3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 020#2=;
     |SI FSalida = 0;
          |SALVA_DATOS #4;
          |SELECT #1#4;
          #4#25 = #2#60;
          #4#0 = #2#61;
          |LEE 020#4=;
          |SI FSalida = 0;
               aAuto = "1";
          |FINSI;
          |REPON_DATOS #4;
          |HAZ PonClavePed;
          |LEE 000#4=;
          |REFRESCACONTROL nGridPedC;
     |FINSI;
     |HAZ PonClaveOfe;
     |REPON_DATOS #2;
     |LEE 000#2=;

     |SI aAuto = "1";
          |HAZ IniVentanaEspera;

          aAuto = "1";
                  ||Programa + Reimprimir + Clave + Modo impresion
          aProg = "pcegz003"+ #4#25 + (("000000" + #4#0) % -106) + #4#58 + "P";
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnRepModPed3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 020#2=;
     |SI FSalida = 0;
          |SALVA_DATOS #4;
          |SELECT #1#4;
          #4#25 = #2#60;
          #4#0 = #2#61;
          |LEE 020#4=;
          |SI FSalida = 0;
               aAuto = "1";
          |FINSI;
          |REPON_DATOS #4;
          |HAZ PonClavePed;
          |LEE 000#4=;
          |REFRESCACONTROL nGridPedC;
     |FINSI;
     |HAZ PonClaveOfe;
     |REPON_DATOS #2;
     |LEE 000#2=;

     |SI aAuto = "1";
          |HAZ IniVentanaEspera;
          aAuto = "1";
                                   ||Programa + Modo + Clave
          aProg = "pcegz008" + "2" + #4#25 + (("000000" + #4#0) % -106);
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnRepRese3;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "R"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 020#2=;
     |SI FSalida = 0;
          #4#25 = #2#60;
          #4#0 = #2#61;
     |FINSI;
     |HAZ PonClaveOfe;
     |REPON_DATOS #2;
     |LEE 000#2=;

     |SELECT #1#4;
     |LEE 020#4=;
     |HAZ PonClavePed;

     |SALVA_DATOS #4;
     |SI #4#70 = "C"; |HAZ BtnPedConf; |FINSI;
     |SI #4#70 = "P"; |HAZ BtnPedPen; |FINSI;
     |SI #4#70 = "R"; |HAZ BtnPedRecha; |FINSI;
     |HAZ EventoFocoPed;
     |REPON_DATOS #4;
     |LEE 000#4=;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnRepLin4;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "F"; |ACABA; |FINSI;

     |HAZ EditaRepLin;
     |SI enError = 0;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO BtnRepArepa4;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "F"; |ACABA; |FINSI;

     aAlfa = "0000N¨Cambiar situaci¢n parte: " + #pcegm042@#0 + "/" + (("000000"+#pcegm042@#1)%-106) + " a reparar?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               #pcegm042@#22 = "R";
               |GRABA 020#pcegm042@.a;
               |LIBERA #pcegm042@;

               |SALVA_DATOS #2;
               |SELECT #1#2;
               #2#48 = #pcegm042@#15;
               #2#0 = #pcegm042@#16;
               |LEE 020#2=;
               |SI FSalida = 0;
                    |SALVA_DATOS #4;
                    |SELECT #1#4;
                    #4#25 = #2#60;
                    #4#0 = #2#61;
                    |LEE 121#4=;
                    |SI FSalida = 0;
                         #4#70 = "P";
                         |GRABA 020#4a;
                         |LIBERA #4;
                    |FINSI;
                    |REPON_DATOS #4;
                    |HAZ PonClavePed;
                    |LEE 000#4=;
                    |REFRESCACONTROL nGridPedC;
               |FINSI;
               |HAZ PonClaveOfe;
               |REPON_DATOS #2;
               |LEE 000#2=;
          |FINSI;
          |SALVA_DATOS #pcegm042@;
          #pcegm042@#0 = 0;
          |REFRESCACONTROL nGridRepL;
          |REPON_DATOS #pcegm042@;
          |REFRESCACONTROL nGridRepC;
     |FINSI;
|FPRC;

|PROCESO ReciCalibra;
     nHay = 1;
|FPRC;

|DEFBUCLE ReciCalibra;
     #80#4;
     ;
     "     ", 000001, #3#2;
     "zzzzz", 999999, #3#2;
     ;
     NULL, ReciCalibra;
|FIN;

|PROCESO BusCalibraOfe;
     aAlfa = #3#2;
     aAlfa = aAlfa - "CAL";
     |SI FSalida > 0;
          nHay = 0;
          |BUCLE ReciCalibra;
          |SI nHay = 0;
               aAlfa = "0000No ha llegado el material de reparación:" + #3#2;
               |MENAV aAlfa;
               |ERROR10;
               nError = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BusCalibraOfe;
     #3#1;
     ;
     aSer, nNum, 001;
     aSer, nNum, 999;
     ;
     NULL, BusCalibraOfe;
|FIN;

|PROCESO MiraRese;
     nPendiente = #5#5 - #5#43;
     nRese = nPendiente - #5#60;
     |SI nRese ! 0;
          nSwRese = 1;
          aAlfa = "0000Faltan unidades por reservar:" + &13 + "Art:" + #5#2 + &13 + "Uni:" + nRese;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO BtnRepCierra4;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "F"; |ACABA; |FINSI;

     |SALVA_FICHA #3
     aSer = #pcegm042@#15;
     nNum = #pcegm042@#16;
     nError = 0;
     ||BUCLE BusCalibraOfe;
     |REPON_FICHA #3;
     |SI nError = 1; |ACABA; |FINSI;

     enTipoTexto = 3;
     |HAZ TextoRep;
     |SI enError = 0;
          |LEE 121#pcegm042@.=;
          |SI FSalida = 0;
               |SALVA_DATOS #2;
               |SELECT #1#2;
               #2#48 = #pcegm042@#15;
               #2#0 = #pcegm042@#16;
               |LEE 020#2=;
               |SI FSalida = 0;
                    |SALVA_DATOS #4;
                    |SELECT #1#4;
                    #4#25 = #2#60;
                    #4#0 = #2#61;
                    |LEE 020#4=;
                    |SI FSalida = 0;
                         nSwRese = 0;
                         |BUCLELIN 2 MiraRese #4;
                         |SI nSwRese = 0;
                              ||HAZ CreaAlbFac;
                              aAuto = "1";
                                  ||Programa +  Clave + F.Prev.Env + REP
                              aProg = "pcegz018" + #4#25 + (("000000" + #4#0) % -106) + #4#66 + "REP";

                              #pcegm042@#17 = ~;
                              aAlfa = Usuario % 810;
                              #pcegm042@#18 = aAlfa;
                              #pcegm042@#19 = eaTexto;
                              #pcegm042@#22 = "C";
                              |GRABA 020#pcegm042@.a;
                              |LIBERA #pcegm042@;
                         |FINSI;
                    |FINSI;
                    |REPON_DATOS #4;
                    |HAZ PonClavePed;
                    |LEE 000#4=;
               |FINSI;
               |REPON_DATOS #2;
               |HAZ PonClaveOfe;
               |LEE 000#2=;
               ||REFRESCACONTROL nGridPedC;
               ||REFRESCACONTROL nGridFac;
          |FINSI;
          |SALVA_DATOS #pcegm042@;

          ||#pcegm042@#0 = 0;
          ||REFRESCACONTROL nGridRepL;
          ||REPON_DATOS #pcegm042@;
          ||REFRESCACONTROL nGridRepC;
     |FINSI;

     |SI aAuto = "1";
          |HAZ IniVentanaEspera;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnRepModi4;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "F"; |ACABA; |FINSI;

     |SALVA_DATOS #2;
     |SALVA_DATOS #4;

     |SELECT #1#2;
     #2#48 = #pcegm042@#15;
     #2#0 = #pcegm042@#16;
     |LEE 020#2=;
     |SI FSalida = 0;
          |SELECT #1#4;
          #4#25 = #2#60;
          #4#0 = #2#61;
          |LEE 020#2=;
          |SI FSalida = 0;
              |HAZ BtnPedPenModi;

              |HAZ PonClavePed;
          |FINSI;
          |HAZ PonClaveOfe;
     |FINSI;

     |REPON_DATOS #4;
     |REPON_DATOS #2;
     |LEE 000#4=;
     |LEE 000#2=;
|FPRC;

|PROCESO BtnRepTodo4;
     |HAZ TextoRepTodo;
     |SI enError = 0;
          aAuto = "1";
          ||Programa +  Clave + F.Prev.Env + REP
          aProg = "pcegz018" + #0#0 + (("00000" + #0#1) % -105) + "00.00.0000" + "TOD" + eaTexto;
          |HAZ IniVentanaEspera;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnRepVerSer5;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "C"; |ACABA; |FINSI;

     |SALVA_DATOS #4;
     |SELECT #10#4;
     #4#95 = #42#0;
     #4#96 = #42#1;
     |LEE 000#4=;
     |SI FSalida = 0;
          aProg = "*pcegz024;REP" + #4#25 + (("000000" + #4#0) % -106);
          |SUB_EJECUTA_NP aProg;
     |SINO;
          |SI #42#26 ! 0;
               aProg = "*pcegz027;REP" + #42#25 + (("000000" + #42#26) % -106);
               |SUB_EJECUTA_NP aProg;
          |SINO;
               |MENAV "0000Cerrado sin factura...";
          |FINSI;
     |FINSI;
     |HAZ PonClavePed;
     |REPON_DATOS #4;
     |LEE 000#4=;
|FPRC;

|PROCESO BtnRepImpFac5;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |O #42#22 ! "C"; |ACABA; |FINSI;

     |SI #pcegm042@#24 = 0;
          |MENAV "0000Parte reparaci¢n cerrado sin facturar...";
          |ACABA;
     |FINSI;

     |SALVA_DATOS #134;
     |SELECT #1#134;
     #134#49 = #pcegm042@#23;
     #134#0 = #pcegm042@#24;
     |LEE 020#134=;
     |SI FSalida = 0;
          aAuto = "1";
               ||Programa +  Clave + reimp + orden
           aProg = "agifa136" +  #134#49 + (("000000" + #134#0) % -106) + #134#45 + #142#141;
     |FINSI;
     |REPON_DATOS #134;
     |SELECT #6#134;
     |LEE 000#134=;

     |SI aAuto = "1";
          |HAZ IniVentanaEspera;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnRepSelec6;
     |HAZ ExisteRep;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #pcegm042@;
     |SI #pcegm042@#22 = "E"; |HAZ BtnRepEnt; |FINSI;
     |SI #pcegm042@#22 = "O"; |HAZ BtnRepOfe; |FINSI;
     |SI #pcegm042@#22 = "R"; |HAZ BtnRepArep; |FINSI;
     |SI #pcegm042@#22 = "F"; |HAZ BtnRepAfac; |FINSI;
     |SI #pcegm042@#22 = "C"; |HAZ BtnRepCer; |FINSI;
     |PULSATECLA;
     |REPON_DATOS #pcegm042@;
     |LEE 000#pcegm042@.=;
     |REFRESCACONTROL nGridRepC;
|FPRC;

|PROCESO BtnRepEnt;
     aBotonRep = "E";
     |ESTADO_CONTROL nBtnRepEnt, "DISABLE";
     |ESTADO_CONTROL nBtnRepOfe, "ENABLE";
     |ESTADO_CONTROL nBtnRepArep, "ENABLE";
     |ESTADO_CONTROL nBtnRepAfac, "ENABLE";
     |ESTADO_CONTROL nBtnRepCer, "ENABLE";
     |ESTADO_CONTROL nBtnRepTodo, "ENABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepOfe;
     aBotonRep = "O";
     |ESTADO_CONTROL nBtnRepEnt, "ENABLE";
     |ESTADO_CONTROL nBtnRepOfe, "DISABLE";
     |ESTADO_CONTROL nBtnRepArep, "ENABLE";
     |ESTADO_CONTROL nBtnRepAfac, "ENABLE";
     |ESTADO_CONTROL nBtnRepCer, "ENABLE";
     |ESTADO_CONTROL nBtnRepTodo, "ENABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepArep;
     aBotonRep = "R";
     |ESTADO_CONTROL nBtnRepEnt, "ENABLE";
     |ESTADO_CONTROL nBtnRepOfe, "ENABLE";
     |ESTADO_CONTROL nBtnRepArep, "DISABLE";
     |ESTADO_CONTROL nBtnRepAfac, "ENABLE";
     |ESTADO_CONTROL nBtnRepCer, "ENABLE";
     |ESTADO_CONTROL nBtnRepTodo, "ENABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepAfac;
     aBotonRep = "F";
     |ESTADO_CONTROL nBtnRepEnt, "ENABLE";
     |ESTADO_CONTROL nBtnRepOfe, "ENABLE";
     |ESTADO_CONTROL nBtnRepArep, "ENABLE";
     |ESTADO_CONTROL nBtnRepAfac, "DISABLE";
     |ESTADO_CONTROL nBtnRepCer, "ENABLE";
     |ESTADO_CONTROL nBtnRepTodo, "ENABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepCer;
     aBotonRep = "C";
     |ESTADO_CONTROL nBtnRepEnt, "ENABLE";
     |ESTADO_CONTROL nBtnRepOfe, "ENABLE";
     |ESTADO_CONTROL nBtnRepArep, "ENABLE";
     |ESTADO_CONTROL nBtnRepAfac, "ENABLE";
     |ESTADO_CONTROL nBtnRepCer, "DISABLE";
     |ESTADO_CONTROL nBtnRepTodo, "ENABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepTodo;
     aBotonRep = "T";
     |ESTADO_CONTROL nBtnRepEnt, "ENABLE";
     |ESTADO_CONTROL nBtnRepOfe, "ENABLE";
     |ESTADO_CONTROL nBtnRepArep, "ENABLE";
     |ESTADO_CONTROL nBtnRepAfac, "ENABLE";
     |ESTADO_CONTROL nBtnRepCer, "ENABLE";
     |ESTADO_CONTROL nBtnRepTodo, "DISABLE";
     |HAZ GridRepara;
|FPRC;
|PROCESO BtnRepSal;
     |PTEC 807;
|FPRC;

|PROCESO EventoFocoReg;
     aPestana = "5";
     |FOCOTECLADO nGridRepC;
|FPRC;

|PROCESO EventoRepC;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#pcegm042@.=;
          |REFRESCACONTROL nGridRepL;
     |FINSI;
|FPRC;
|PROCESO EventoRepL;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#pcegm043@.=;
     |FINSI;
|FPRC;

|PROCESO MaxRepL;
     #pcegm043@#0 = #pcegm042@#0;
     #pcegm043@#1 = #pcegm042@#1;
     #pcegm043@#2 = 999;
|FPRC;
|PROCESO MinRepL;
     #pcegm043@#0 = #pcegm042@#0;
     #pcegm043@#1 = #pcegm042@#1;
     #pcegm043@#2 = 1;
|FPRC;

|PROCESO MaxRepC;
     #pcegm042@#22 = aBotonRep;
     |SI #0#0 = "000000";
          #pcegm042@#3 = "zzzzzz";
          #pcegm042@#5 = 999;
     |SINO;
          #pcegm042@#3 = #0#0;
          |SI #0#1 = 0;
               #pcegm042@#5 = 999;
          |SINO;
               #pcegm042@#5 = #0#1;
          |FINSI;
     |FINSI;

     #pcegm042@#0 = "zzzzz";
     #pcegm042@#1 = 999999;
|FPRC;
|PROCESO MinRepC;
     #pcegm042@#22 = aBotonRep;
     |SI #0#0 = "000000";
          #pcegm042@#3 = "      ";
          #pcegm042@#5 = 1;
     |SINO;
          #pcegm042@#3 = #0#0;
          |SI #0#1 = 0;
               #pcegm042@#5 = 1;
          |SINO;
               #pcegm042@#5 = #0#1;
          |FINSI;
     |FINSI;
     #pcegm042@#0 = "     ";
     #pcegm042@#1 = 1;
|FPRC;

|PROCESO BtnRepDestruye;
     |SI nBtnRepCierra1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepCierra1; |FINSI;
     |SI nBtnRepNuevo1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepNuevo1; |FINSI;
     |SI nBtnRepVer1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepVer1; |FINSI;
     |SI nBtnRepModi1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepModi1; |FINSI;
     |SI nBtnRepBorra1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepBorra1; |FINSI;
     |SI nBtnRepAofe1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepAofe1; |FINSI;
     |SI nBtnRepImp1 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImp1; |FINSI;

     |SI nBtnRepLin ! -1; |FIN_CONTROL_WINDOWS nBtnRepLin; |FINSI;
     |SI nBtnRepModOfe2 ! -1; |FIN_CONTROL_WINDOWS nBtnRepModOfe2; |FINSI;
     |SI nBtnRepBorrOfe2 ! -1; |FIN_CONTROL_WINDOWS nBtnRepBorrOfe2; |FINSI;
     |SI nBtnRepVerOfe2 ! -1; |FIN_CONTROL_WINDOWS nBtnRepVerOfe2; |FINSI;
     |SI nBtnRepImpOfe2 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImpOfe2; |FINSI;
     |SI nBtnRepARep2 ! -1; |FIN_CONTROL_WINDOWS nBtnRepARep2; |FINSI;

     |SI nBtnRepVerOfe3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepVerOfe3; |FINSI;
     |SI nBtnRepVerPed3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepVerPed3; |FINSI;
     |SI nBtnRepImpOfe3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImpOfe3; |FINSI;
     |SI nBtnRepImpVacio3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImpVacio3; |FINSI;
     |SI nBtnRepImp3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImp3; |FINSI;
     |SI nBtnRepAfac3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepAfac3; |FINSI;
     |SI nBtnRepAofe3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepAofe3; |FINSI;
     |SI nBtnRepImpPed3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImpPed3; |FINSI;
     |SI nBtnRepModPed3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepModPed3; |FINSI;
     |SI nBtnRepRese3 ! -1; |FIN_CONTROL_WINDOWS nBtnRepRese3; |FINSI;

     |SI nBtnRepArepa4 ! -1; |FIN_CONTROL_WINDOWS nBtnRepArepa4; |FINSI;
     |SI nBtnRepCierra4 ! -1; |FIN_CONTROL_WINDOWS nBtnRepCierra4; |FINSI;
     |SI nBtnRepModi4 ! -1; |FIN_CONTROL_WINDOWS nBtnRepModi4; |FINSI;
     |SI nBtnRepTodo4 ! -1; |FIN_CONTROL_WINDOWS nBtnRepTodo4; |FINSI;

     |SI nBtnRepImpFac5 ! -1; |FIN_CONTROL_WINDOWS nBtnRepImpFac5; |FINSI;
     |SI nBtnRepVerSer5 ! -1; |FIN_CONTROL_WINDOWS nBtnRepVerSer5; |FINSI;

     |SI nBtnRepSelec6 ! -1; |FIN_CONTROL_WINDOWS nBtnRepSelec6; |FINSI;

     nBtnRepCierra1 = -1;
     nBtnRepNuevo1 = -1;
     nBtnRepVer1 = -1;
     nBtnRepModi1 = -1;
     nBtnRepBorra1 = -1;
     nBtnRepAofe1 = -1;
     nBtnRepImp1 = -1;

     nBtnRepLin = -1;
     nBtnRepModOfe2 = -1;
     nBtnRepBorrOfe2 = -1;
     nBtnRepVerOfe2 = -1;
     nBtnRepImpOfe2 = -1;
     nBtnRepARep2 = -1;

     nBtnRepVerOfe3 = -1;
     nBtnRepVerPed3 = -1;
     nBtnRepImpOfe3 = -1;
     nBtnRepImpVacio3 = -1;
     nBtnRepImp3 = -1;
     nBtnRepAfac3 = -1;
     nBtnRepImp3 = -1;
     nBtnRepModPed3 = -1;
     nBtnRepRese3 = -1;

     nBtnRepArepa4 = -1;
     nBtnRepCierra4 = -1;

     nBtnRepImpFac5 = -1;
     nBtnRepVerSer5 = -1;

     nBtnRepSelec6 = -1;
|FPRC;

|PROCESO BtnRepara;
     |HAZ BtnRepDestruye;
     |SI aBotonRep = "E";
          |CONTROL_SIMPLE nPanRep, "BOTON,Cerrar reparaci¢n", 2201, 2213, BtnRepCierra1;
          nBtnRepCierra1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{193}}Nuevo", 2214, 2226, BtnRepNuevo1;
          nBtnRepNuevo1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{155}}Ver", 2227, 2239, BtnRepVer1;
          nBtnRepVer1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Modificar", 2240, 2252, BtnRepModi1;
          nBtnRepModi1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{207}}Borrar", 2253, 2265, BtnRepBorra1;
          nBtnRepBorra1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{206}}A oferta", 2266, 2278, BtnRepAofe1;
          nBtnRepAofe1 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. Parte", 2279, 2291, BtnRepImp1;
          nBtnRepImp1 = FSalida;
     |FINSI;
     |SI aBotonRep = "O";
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Lineas Rep.", 2201, 2213, BtnRepLin2;
          nBtnRepLin = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Modificar ofe.", 2214, 2226, BtnRepModOfe2;
          nBtnRepModOfe2 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{207}}Borrar ofe.", 2227, 2239, BtnRepBorrOfe2;
          nBtnRepBorrOfe2 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{155}}Ver ofe.", 2240, 2252, BtnRepVerOfe2;
          nBtnRepVerOfe2 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imprimir ofe.", 2253, 2265, BtnRepImpOfe2;
          nBtnRepImpOfe2 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{206}}A Reparar", 2266, 2278, BtnRepARep2;
          nBtnRepARep2 = FSalida;
     |FINSI;
     |SI aBotonRep = "R";
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Lineas Rep.", 2201, 2213, BtnRepLin3;
          nBtnRepLin = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{155}}Ver Oferta", 2214, 2226, BtnRepVerOfe3;
          nBtnRepVerOfe3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{155}}Ver Pedido", 2227, 2239, BtnRepVerPed3;
          nBtnRepVerPed3 = FSalida;
/*
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. Oferta", 2240, 2252, BtnRepImpOfe3;
          nBtnRepImpOfe3 = FSalida;
*/
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. Vacio", 2240, 2252, BtnRepImpVacio3;
          nBtnRepImpVacio3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. Compl.", 2253, 2265, BtnRepImp3;
          nBtnRepImp3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{206}}A facturar", 2266, 2278, BtnRepAfac3;
          nBtnRepAfac3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{207}}A ofertar", 2279, 2291, BtnRepAofe3;
          nBtnRepAofe3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. Ped.", 2301, 2313, BtnRepImpPed3;
          nBtnRepImpPed3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Mod. Ped.", 2314, 2326, BtnRepModPed3;
          nBtnRepModPed3 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,Reservar", 2327, 2339, BtnRepRese3;
          nBtnRepRese3 = FSalida;
     |FINSI;
     |SI aBotonRep = "F";
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Lineas Rep.", 2201, 2213, BtnRepLin4;
          nBtnRepLin = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{207}}A reparar", 2214, 2226, BtnRepArepa4;
          nBtnRepArepa4 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{206}}Cerrar", 2227, 2239, BtnRepCierra4;
          nBtnRepCierra4 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{197}}Mod. condic.", 2240, 2252, BtnRepModi4;
          nBtnRepModi4 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{206}}Cerrar todo", 2253, 2265, BtnRepTodo4;
          nBtnRepTodo4 = FSalida;
     |FINSI;
     |SI aBotonRep = "C";
          |CONTROL_SIMPLE nPanRep, "BOTON,{{205}}Imp. factura", 2201, 2213, BtnRepImpFac5;
          nBtnRepImpFac5 = FSalida;
          |CONTROL_SIMPLE nPanRep, "BOTON,{{155}}Ver Servicios", 2214, 2226, BtnRepVerSer5;
          nBtnRepVerSer5 = FSalida;
     |FINSI;
     |SI aBotonRep = "T";
          |CONTROL_SIMPLE nPanRep, "BOTON,Seleccionar", 2201, 2213, BtnRepSelec6;
          nBtnRepSelec6 = FSalida;
     |FINSI;
|FPRC;

|PROCESO GridRepara;
     |PINPA #5#0;  nPanRep = FSalida;
     #pcegm042@#0 = 0; || para que no salgan las lineas si no hay cabeceras

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2302;
     nPos2 = 3398;
     |SI nGridRepL ! -1; |DESTRUYECONTROL nGridRepL; |FINSI;
     |SI aBotonRep = "R";
          nPos1 = 2402;
     |FINSI;
     |LINEAL_SIMPLE #1#pcegm043@, nRango, nPos1, nPos2, MinRepL, MaxRepL, EventoRepL;
     nGridRepL = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 2198;
     |SI nGridRepC ! -1; |DESTRUYECONTROL nGridRepC; |FINSI;
     |SI aBotonRep = "T";
          nClaveRep = 3;
          |LINEAL_SIMPLE #3#pcegm042@, nRango, nPos1, nPos2, MinRepC, MaxRepC, EventoRepC;
     |SINO;
          nClaveRep = 2;
          |LINEAL_SIMPLE #2#pcegm042@, nRango, nPos1, nPos2, MinRepC, MaxRepC, EventoRepC;
     |FINSI;
     nGridRepC = FSalida;
     |HAZ BtnRepara;
|FPRC;

|PROCESO PanRepara;
     |PINPA #5#0;  nPanRep = FSalida;

     |CONTROL_SIMPLE nPanRep, "EVENTOPAN", 0000, 0000, EventoFocoReg;
     nFocoRep = FSalida;

     |CONTROL_SIMPLE nPanRep, "BOTON,Entrada", 0501, 0513, BtnRepEnt;
     nBtnRepEnt = FSalida;
     |CONTROL_SIMPLE nPanRep, "BOTON,Ofertados", 0514, 0526, BtnRepOfe;
     nBtnRepOfe = FSalida;
     |CONTROL_SIMPLE nPanRep, "BOTON,A reparar", 0527, 0539, BtnRepArep;
     nBtnRepArep = FSalida;
     |CONTROL_SIMPLE nPanRep, "BOTON,A facturar", 0540, 0552, BtnRepAfac;
     nBtnRepAfac = FSalida;
     |CONTROL_SIMPLE nPanRep, "BOTON,Cerrados", 0553, 0565, BtnRepCer;
     nBtnRepCer = FSalida;
     |CONTROL_SIMPLE nPanRep, "BOTON,Todos", 0566, 0578, BtnRepTodo;
     nBtnRepTodo = FSalida;

     |CONTROL_SIMPLE nPanRep, "BOTON,{{207}} Salir", 3490, 3498, BtnRepSal;
     nBtnRepSal = FSalida;

     |HAZ BtnRepEnt;
|FPRC;
--------------------FACTURAS---------------------------------------------
|PROCESO BtnFacSer;
     |LEE 000#134=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DDEFECTO #10;
     |ABRE #10;
     |SELECT #5#10;
     #10#53 = #134#49;
     #10#39 = #134#0;
     |LEE 000#10];
     |SI FSalida = 0; |Y #10#53 = #134#49; |Y #10#39 = #134#0;
          |ABRE #16;
          #16#0 = #10#52;
          #16#1 = #10#0;
          |LEE 000#16=;
          |SI FSalida = 0;
               |HAZ IniVentanaEspera;
               aAuto = "1";
                                ||Programa +  Clave
               aProg = "pcegz027" +  #16#2 + (("000000" + #16#3) % -106);
               |PTEC 807;
          |SINO;
               |MENAV "0000factura anticipada sin servicio";
          |FINSI;
          |CIERRA #16;
     |SINO;
          |MENAV "0000No encuentro el albaran!!!";
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO BtnFacImp;
     |LEE 000#134=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                      ||Programa +  Clave + reimp + orden
     aProg = "agifa136" +  #134#49 + (("000000" + #134#0) % -106) + #134#45 + #142#141;
     |PTEC 807;
|FPRC;

|PROCESO BtnFacPaq;
     |LEE 000#134=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |MENAV "0000Ver paquetes factura";
|FPRC;

|PROCESO EventoFocoFac;
     |SI nDepar = 1;          || no permite ver esta pesta¤a
          |AVISO;
          |SI aPestana = "1";
               |FOCOTECLADO nGridOfeC;
          |SINO;
               |FOCOTECLADO nGridPedC;
          |FINSI;
     |SINO;
          aPestana = "4";
          |FOCOTECLADO nGridFac;
     |FINSI;
|FPRC;

|PROCESO EventoFac;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#134=;
     |FINSI;
|FPRC;

|PROCESO BtnFacSal;
     |PTEC 807;
|FPRC;

|PROCESO MinFac;
     |SI #0#0 = "000000";
          #134#2 = "      ";
     |SINO;
          #134#2 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #134#115 = 0;
     |SINO;
          #134#115 = #0#1;
     |FINSI;
     #134#49 = "     ";
     #134#0 = 1;
|FPRC;

|PROCESO MaxFac;
     |SI #0#0 = "000000";
          #134#2 = "zzzzzz";
     |SINO;
          #134#2 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #134#115 = 9999;
     |SINO;
          #134#115 = #0#1;
     |FINSI;
     #134#49 = "zzzzz";
     #134#0 = 999999;
|FPRC;

|PROCESO PanFacturas;
     |PINPA #4#0;  nPanFac = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 3398;
     |LINEAL_SIMPLE #6#134, nRango, nPos1, nPos2, MinFac, MaxFac, EventoFac;
     nGridFac = FSalida;

     |CONTROL_SIMPLE nPanFac, "EVENTOPAN", 0000, 0000, EventoFocoFac;
     nFocoFac = FSalida;

     |CONTROL_SIMPLE nPanFac, "BOTON,{{155}}Ver servicio", 0501, 0513, BtnFacSer;
     nBtnFacSer = FSalida;
     |CONTROL_SIMPLE nPanFac, "BOTON,{{205}}Imprimir", 0514, 0526, BtnFacImp;
     nBtnFacImp = FSalida;
     |CONTROL_SIMPLE nPanFac, "BOTON,{{155}}Ver paquetes", 0527, 0539, BtnFacPaq;
     nBtnFacPaq = FSalida;

     |ESTADO_CONTROL nBtnFacPaq, "HIDE";     ||| lo quito

     |CONTROL_SIMPLE nPanFac, "BOTON,{{207}} Salir", 3490, 3498, BtnFacSal;
     nBtnFacSal = FSalida;
|FPRC;
--------------------PAQUETES---------------------------------------------
|PROCESO BtnPaqVer;
     |HAZ IniVentanaEspera;
     aAuto = "1";
                                ||Programa +  Clave
     aProg = "pcegz027" +  #23#1 + (("000000" + #23#2) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPaqImp;
     |HAZ IniVentanaEspera;
     aAuto = "1";
                                ||Programa +  Clave
     aProg = "pcegz019" +  #23#1 + (("000000" + #23#2) % -106);
     |PTEC 807;
|FPRC;

|PROCESO EventoFocoPaq;
     |SI nDepar = 1;          || no permite ver esta pesta¤a
          |AVISO;
          |SI aPestana = "1";
               |FOCOTECLADO nGridOfeC;
          |SINO;
               |FOCOTECLADO nGridPedC;
          |FINSI;
     |SINO;
          aPestana = "3";
          |FOCOTECLADO nGridPaq;
     |FINSI;
|FPRC;

|PROCESO EventoPaq;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#23=;
     |FINSI;
|FPRC;

|PROCESO BtnPaqSal;
     |PTEC 807;
|FPRC;

|PROCESO MinPaq;
     #23#0 = "AV";
     |SI #0#0 = "000000";
          #23#32 = "      ";
     |SINO;
          #23#32 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #23#33 = 0;
     |SINO;
          #23#33 = #0#1;
     |FINSI;
     #23#1 = "     ";
     #23#2 = 1;
|FPRC;

|PROCESO MaxPaq;
     #23#0 = "AV";
     |SI #0#0 = "000000";
          #23#32 = "zzzzzz";
     |SINO;
          #23#32 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #23#33 = 9999;
     |SINO;
          #23#33 = #0#1;
     |FINSI;
     #23#1 = "zzzzz";
     #23#2 = 999999;
|FPRC;

|PROCESO PanPaquetes;
     |PINPA #3#0;  nPanPaq = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 3398;
     |LINEAL_SIMPLE #3#23, nRango, nPos1, nPos2, MinPaq, MaxPaq, EventoPaq;
     nGridPaq = FSalida;

     |CONTROL_SIMPLE nPanPaq, "EVENTOPAN", 0000, 0000, EventoFocoPaq;
     nFocoPaq = FSalida;

     |CONTROL_SIMPLE nPanPaq, "BOTON,{{155}}Ver Albaran", 0501, 0513, BtnPaqVer;
     nBtnPaqVer = FSalida;
     |CONTROL_SIMPLE nPanPaq, "BOTON,{{205}}Etiquetas", 0514, 0526, BtnPaqImp;
     nBtnPaqImp = FSalida;

     |CONTROL_SIMPLE nPanPaq, "BOTON,{{207}} Salir", 3490, 3498, BtnPaqSal;
     nBtnPaqSal = FSalida;
|FPRC;
--------------------PEDIDOS----------------------------------------------
----Llamadas del pcegz013

|PROCESO LeeAgen13; |TIPO 0;
     |ABRE #1020;
     #1020#0 = #13#127;
     |LEE 000#1020=;
     |SI FSalida = 0;
          #13#128 = #1020#1; |PINTA #13#128;
          |SI #13#127 = #20#2;
               |ABRE #124;
               #124#0 = #13#117;
               |LEE 000#124=;
               |SI FSalida ! 0;
                    |MENAV "0000No existe el pais en el auxiliar paises CHRONOEXPRES";
                    |ERROR;
               |FINSI;
               |CIERRA #124;
          |FINSI;
     |SINO;
          |MENAV "0000No existe agencia de transporte";
          |ERROR;
     |FINSI;
     |CIERRA #1020;
|FPRC;

|PROCESO Portes13; |TIPO 0;
     |SI #13#126 ! "D"; |Y #13#126 ! "P";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO ImpPedido; |TIPO 0;
     aAlfa = #13#122;
     |C_M #13#124, 1, aAlfa;
|FPRC;

|PROCESO Min1003_2;
     #1003#0 = #13#99;
     #1003#1 = 1;
|FPRC;

|PROCESO Max1003_2;
     #1003#0 = #13#99;
     #1003#1 = 9999;
|FPRC;

|PROCESO DirAcePed66; |TIPO 66;
     |ABRE #1003;
     #1003#0 = #13#99;
     #1003#1 = #13#100;
     |LEE 000#1003];
     |CONSULTA_F_CLAVE #1#1003, Min1003_2, Max1003_2;
     |SI FSalida = 0;
          #13#99 = #1003#1; |PINTA #13#99;
          #13#100 = #1003#2; |PINTA #13#100;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #1003;
|FPRC;

|PROCESO DirAcePed; |TIPO 6;
     |ABRE #1003;
     #1003#0 = #13#99;
     #1003#1 = #13#100;
     |LEE 000#1003=;
     |SI FSalida ! 0;
          |CONFI "0000SNo existe la direccion de factura. ¿Desea crearla?";
          |SI FSalida = 0;
               aAuto = "1";

                    ||Programa + "D" + Cli + Dir.Ent
               aProg = "dszx0001"+ "D" + #13#99 + (("0000" + #13#100) % -104);

               aPosicion = "CONFIRMA_PEDI" + #13#99 + (("0000" + #13#100) % -104);
               |ERROR;
               |PTEC 807;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #1003;
|FPRC;

|PROCESO CliAcePed; |TIPO 6;
     |ABRE #24;
     #24#0 = #13#99;
     |LEE 000#24=;
     |SI FSalida ! 0;
          |CONFI "0000SNo existe el cliente. ¿Desea crearlo?";
          |SI FSalida = 0;
               aAuto = "1";

                    ||Programa + "C" + Cliente
               aProg = "dszx0001"+ "C" + #13#99;

               aPosicion = "CONFIRMA_PEDI" + #13#99 + (("0000" + #13#100) % -104);
               |ERROR;
               |PTEC 807;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #24;
|FPRC;
------------------------------
|PROCESO BtnDatoEnvioPed;
     |ABRE #1003;
     #1003#0 = #13#99;
     #1003#1 = #13#100;
     |LEE 020#1003=;
     |CIERRA #1003;
     |SI #13#127 = #20#2;
          |ABRE #124;
          #124#0 = #1003#19;
          |LEE 000#124=;
          |SI FSalida ! 0;
               |MENAV "0000No existe el pais en el auxiliar paises CHRONOEXPRES";
               |ACABA;
          |FINSI;
          |CIERRA #124;
     |FINSI;
     #13#111 = #1003#22; |PINTA #13#111;
     #13#112 = #1003#10; |PINTA #13#112;
     #13#113 = #1003#2; |PINTA #13#113;
     #13#114 = #1003#3; |PINTA #13#114;
     #13#115 = #1003#23; |PINTA #13#115;
     #13#116 = #1003#7; |PINTA #13#116;
     #13#117 = #1003#19; |PINTA #13#117;
     #13#118 = #1003#8; |PINTA #13#118;
     #13#119 = #1003#11; |PINTA #13#119;
     #13#120 = #1003#12; |PINTA #13#120;
     #13#131 = #1003#25; |PINTA #13#131;
     #13#132 = #1003#26; |PINTA #13#132;
|FPRC;

|PROCESO PintaObsPed;
     #0#4 = ""; #0#5 = ""; #0#6 = "";
     |ABRE #106;
     #106#0 = #4#25;
     #106#1 = #4#0;
     #106#2 = 1;
     |LEE 000#106=;
     |SI FSalida = 0; #0#4 = #106#3; |FINSI;
     #106#2 = 2;
     |LEE 000#106=;
     |SI FSalida = 0; #0#5 = #106#3; |FINSI;
     #106#2 = 3;
     |LEE 000#106=;
     |SI FSalida = 0; #0#6 = #106#3; |FINSI;
     |CIERRA #106;
     |PINTA #0#4; |PINTA #0#5; |PINTA #0#6;
|FPRC;

|PROCESO PintaStock;
     |ABRE #19;
     #19#0 = #5#2;
     |LEE 000#19=;
     |SI FSalida = 0;
          #0#9 = #19#6;
          #0#10 = #19#12;
          #0#11 = #19#104;
     |SINO;
          #0#9 = 0;
          #0#10 = 0;
          #0#11 = 0;
     |FINSI;
     |CIERRA #19;
     |PINTA #0#9;
     |PINTA #0#10;
     |PINTA #0#11;
|FPRC;

|PROCESO PintaObsCalibra;
     #0#7 = "";
     #0#8 = "";
     aArti = #5#2; |QBF aArti;
     aAlfa = aArti - "CAL";
     |SI aAlfa ! aArti;
          #0#7 = #5#61;
          #0#8 = #5#62;
     |FINSI;
     |PINTA #0#7;
     |PINTA #0#8;
|FPRC;

|PROCESO GrabaPedObs;
     |ABRE #106;
     |PARA nLin = 0; |SI nLin [ 98; |HACIENDO nLin = nLin + 1;
          #106#0 = #4#25;
          #106#1 = #4#0;
          #106#2 = nLin + 1;
          |LEE 101#106=;
          #106#3 = #9nLin;
          |SI FSalida = 0;
               |GRABA 020#106a;
          |SINO;
               |GRABA 020#106n;
          |FINSI;
          |LIBERA #106;
     |SIGUE;
     |CIERRA #106;
|FPRC;

|PROCESO LlenaPedObs;
     #9nLin = #106#3;
     #13nLin = #106#3;
     nLin = nLin + 1;
|FPRC;

|DEFBUCLE LlenaPedObs;
     #106#1;
     ;
     #4#25, #4#0, 01;
     #4#25, #4#0, 99;
     ;
     NULL, LlenaPedObs;
|FIN;

|PROCESO EntregaPed;
     nCobrado = nCobrado + #1002#9;
|FPRC;

|DEFBUCLE EntregaPed;
     #1002#1;
     ;
     "P", #4#25, #4#0, 01;
     "P", #4#25, #4#0, 99;
     ;
     NULL, EntregaPed;
|FIN;

|PROCESO LeePago13; |TIPO 0;
     |ABRE #91;
     #91#0 = #13#108;
     |LEE 000#91=;
     |SI FSalida = 0;
          #13#109 = #91#1; |PINTA #13#109;
     |SINO;
          |MENAV "0000No existe forma de pago";
          |ERROR;
     |FINSI;
     |CIERRA #91;
|FPRC;

|PROCESO HayCalPedido;
     aArti = #5#2;
     aAlfa = aArti - "CAL";
     |SI aAlfa ! aArti;
          aHayCal = "S";
     |FINSI;
|FPRC

|PROCESO BtnPedPenConf;
     |LEE 101#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #4#96 ! 0;
          |MENAV "0000Documento de reparación...";
          |ACABA;
     |FINSI;

     aAlf1 = #4#85; |QBF aAlf1;
     aAlf2 = #4#86; |QBF aAlf2;
     aAlf3 = #4#87; |QBF aAlf3;
     aAlf4 = #4#88; |QBF aAlf4;
     aAlf5 = #4#89; |QBF aAlf5;
     |SI aAlf1 = ""; |O aAlf2 = ""; |O aAlf3 = ""; |O aAlf4 = ""; |O aAlf5 = "";
          aHayCal = "N";
          |BUCLELIN 2 HayCalPedido #4;
          |SI aHayCal = "S";
               |MENAV "0000No se pude confirmar, faltan los datos de calibración";
               |ACABA;
          |FINSI;
     |FINSI;

     |VENTANA 504, 3894, -1, 17, "Confirmar Pedido";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aDivisa = #4#35;
     aMoneda = #4#37;
     |HAZ Divisas104;

     |ABRE #91;
     #91#0 = #4#9;
     |LEE 000#91=;
     |CIERRA #91;
     |ABRE #225;
     #225#0 = #4#74;
     |LEE 000#225=;
     |CIERRA #225;
     |ABRE #101;
     #101#0 = #4#75;
     |LEE 000#101=;
     |CIERRA #101;
     |ABRE #1020;
     #1020#0 = #4#60;
     |LEE 000#1020=;
     |CIERRA #1020;

     nCobrado = 0;
     |BUCLE EntregaPed;

     |DDEFECTO #13;
     nLin = 0;
     |BUCLE LlenaPedObs;
     #13#99 = #4#4;
     #13#100 = #4#57;
     #13#101 = #4#65;
     #13#102 = #4#62;
     #13#103 = "31.12.2099"; ||#4#66;
     |SI #4#37 = "D";
          #13#104 = #4#98;
     |SINO;
          #13#104 = #4#67;
     |FINSI;
     #13#105 = #4#19;
     #13#106 = #4#71;
     #13#107 = #4#72;
     #13#108 = #4#9;
     #13#109 = #91#1;
     #13#110 = nCobrado;
     #13#111 = #4#73;
     #13#112 = #4#19;
     #13#113 = #4#14;
     #13#114 = #4#20;
     #13#115 = #4#59;
     #13#116 = #4#21;
     #13#117 = #4#74;
     #13#118 = #225#1;
     #13#119 = #4#75;
     #13#120 = #101#1;
     #13#123 = #4#8;
     #13#126 = #4#61;
     #13#127 = #1020#0;
     #13#128 = #1020#1;
     #13#129 = #4#77;
     #13#130 = ~;
     #13#131 = #4#92;
     #13#132 = #4#93;

     aAlfa = aPosicion % 113;
     |SI aAlfa = "CONFIRMA_PEDI";
          aAlfa = aPosicion % 1406; #13#99 = aAlfa;
          aAlfa = aPosicion % 2004; #13#100 = aAlfa;
     |FINSI;
     aPosicion = "";
     aAuto = "";

     |PINPA #0#13;
     nPanta = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Poner dir. factura", 2522, 2540, BtnDatoEnvioPed;
     nBtnDatoEnvio = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Reparto envios por agencia", 1070, 1091, BtnRelaAgen;
     nBtnRelaAgen = FSalida;

     enForma = -1;
     |HAZ CalStockPedido;

     |C_M #13#110, 1, "S";
     |C_M #13#130, 1, "S";
     |SI nCobrado ! 0;
          |C_M #13#110, 1, "N";
          |C_M #13#130, 1, "N";
     |FINSI;

     |PINDA #0#13;
  |ET OtraConPed;
     nOk = 1;
     |ENDATOS #2#13;
     |SI FSalida = 0; |Y nTecla = 0;
          |SI #13#126 = " ";
               |MENAV "0000Debe de indicar el tipo de portes...";
               |VETE OtraConPed;
          |FINSI;
          nOk = 0;
          |HAZ ConfirmaPedido;
          |HAZ RecalTipoPed;
          |GRABA 020#4a;
          fFecha = ~;
          |SI #4#66 > fFecha;
               |MENAV "0000No se procede al intento de servicio inmediato por tener fecha de servicio superior a la fecha del sistema";
          |SINO;
                                  ||Programa +  Clave + F.Pre.Env
               aProg = "pcegz018" + #4#25 + (("000000" + #4#0) % -106) + #4#66;
               aAuto = "1";
          |FINSI;
          |SI #13#122 = "S";
               |LIBERA #4;
               eaImpresora = "CrystalReport";
               eaTipoImp = #13#124;
               ser_ped = #4#25;
               num_ped = #4#0;
               |SUB_EJECUTA_NP "pcegz003";
          |FINSI;
     |FINSI;

     enForma = 1;
     |HAZ CalStockPedido;

     |LIBERA #4;

     |FIN_CONTROL_WINDOWS nBtnDatoEnvio;
     |FIN_CONTROL_WINDOWS nBtnRelaAgen;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;

     |SI aAuto ! "";
          |PTEC 807;
          |HAZ IniVentanaEspera;
     |FINSI;

     |SI nOk = 0;
          |SALVA_DATOS #4;
          |HAZ BtnPedConf;
          |REPON_DATOS #4;
          |LEE 020#4=;
          |REFRESCACONTROL nGridPedC;
     |FINSI;
|FPRC;

|PROCESO BtnPedPenCobro;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                        ||Programa +  Clave
     aProg = "pcegm013" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedPenModi;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz008" + "2" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO MiraReseSerFac;
     |SI #5#60 ! 0; aRese = "S"; |FINSI;
     |SI #5#43 ! 0; aServ = "S"; |FINSI;
     |SI #5#59 ! 0; aFact = "S"; |FINSI;
|FPRC;

|PROCESO BtnPedPenRecha;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI nSwVer = 0;
          nCobrado = 0;
          |BUCLE EntregaPed;
          |SI nCobrado ! 0;
               aAlfa = "0000El pedido tiene importe cobrado: " + nCobrado + "...";
               |MENAV aAlfa;
          |FINSI;
          aRese = "N"; aServ = "N"; aFact = "N";
          |BUCLELIN 2 MiraReseSerFac #4;
          |SI aRese = "S"; |MENAV "0000El pedido tiene unidades reservadas..."; |FINSI;
          |SI aServ = "S"; |MENAV "0000El pedido tiene unidades servidas..."; |FINSI;
          |SI aFact = "S"; |MENAV "0000El pedido tiene unidades facturadas..."; |FINSI;
          |SI aRese = "S";
               |MENAV "0000No se puede rechazar un pedido con unidades reservadas...";
               |ACABA;
          |FINSI;
     |FINSI;

     |LEE 121#4=;

     |VENTANA 1302, 2197, -1, 17, "Rechazo de pedido";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #14;
     #14#0 = #4#25;
     #14#1 = #4#0;
     #14#2 = #4#78;
     #14#3 = #4#79;
     #14#4 = #4#80;
     #14#5 = #4#94;
     |PINPA #0#14;
     |SI nSwVer = 1;
          |PINDA #0#14;
          |PAUSA;
     |SINO;
          #14#2 = Usuario % 810;
          #14#3 = ~;
          |PINDA #0#14;
          |ENDATOS #2#14;
          |SI FSalida = 0; |Y nTecla = 0;
               |SI #4#70 = "C";
                    enForma = -1;
                    |HAZ CalStockPedido;
               |SINO;
                    enForma = -1;
                    enRechaza = 1;
                    |HAZ CalStockPedido;
                    enRechaza = 0;
               |FINSI;
               #4#70 = "R";
               #4#78 = #14#2;
               #4#79 = #14#3;
               #4#80 = #14#4;
               #4#94 = #14#5;
               |GRABA 020#4a;

               |SALVA_FICHA #2;
               |SELECT #6#2;
               #2#60 = #4#25;
               #2#61 = #4#0;
               |LEE 101#2=;
               |SI FSalida = 0;
                    #2#83 = "R";
                    #2#100 = #4#78;
                    #2#110 = #4#79;
                    #2#101 = #4#80;
                    |GRABA 020#2a;
                    |LIBERA #2;
               |FINSI;
               |HAZ PonClaveOfe;
               |REPON_FICHA #2;

               aEstado = "DISABLE"; |HAZ BtnPedHabilita;
               |REFRESCACONTROL nGridPedC;

               aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
               |REFRESCACONTROL nGridOfeC;
          |FINSI;
     |FINSI;
     |LIBERA #4;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;
|FPRC;

|PROCESO HayPedLinAlba;
     nUni = #5#5 - #5#59;
     |SI nUni > 0; nHay = 1; |FINSI;
|FPRC;

|PROCESO BtnPedPenFact;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #4#96 ! 0;
          |MENAV "0000Documento de reparación, facturar desde reparaciones.";
          |ACABA;
     |FINSI;

     nHay = 0;
     |BUCLELIN 0 HayPedLinAlba #4;
     |SI nHay = 0;
          |MENAV "0000No hay unidades pendientes de facturar.";
          |ACABA;
     |FINSI;

     |HAZ FacturaSinServ;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                      ||Programa +  Clave + reimp + orden
     aProg = "agifa136" +  #134#49 + (("000000" + #134#0) % -106) + #134#45 + #142#141;
     |PTEC 807;
|FPRC;

|PROCESO BtnPedPenFase;
     |LEE 121#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 1725, 2566, -1, 17, "Cambio tipo fase";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #17#0 = #4#25;
     #17#1 = #4#0;
     #17#2 = #4#84;

     |PINPA #0#17;
     |PINDA #0#17;
     |ENDATOS #2#17;
     |SI FSalida = 0; |Y nTecla = 0;
          #4#84 = #17#2;
          |GRABA 020#4a;
          |REFRESCACONTROL nGridPedC;
     |FINSI;

     |LIBERA #4;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;
|FPRC;

|PROCESO BtnPedConfCobro;
     |HAZ BtnPedPenCobro;
|FPRC;

|PROCESO BtnPedConfFact;
     |HAZ BtnPedPenFact;
|FPRC;

|PROCESO BtnPedConfModi;
     |HAZ BtnPedPenModi;
|FPRC;

|PROCESO BtnPedConfRecha;
     |HAZ BtnPedPenRecha;
|FPRC;

|PROCESO BtnPedConfVServ;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                         ||Programa + Clave
     aProg = "pcegz024" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedConfVFact;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                         ||Programa + Clave
     aProg = "pcegz026" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedConfAdj;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #4#96 ! 0;
          |MENAV "0000Documento de reparación, facturar desde reparaciones.";
          |ACABA;
     |FINSI;

     fFecha = ~;
     |SI #4#66 > fFecha;
          |CONFI "0000NFecha de servicio superior a la fecha del sistema. ¿Desea adjudicarlo?";
          |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                        ||Programa +  Clave + F.Prev.Env + ADJ
     aProg = "pcegz018" + #4#25 + (("000000" + #4#0) % -106) + #4#66 + "ADJ";
     |PTEC 807;
|FPRC;

|PROCESO BtnPedConfFase;
     |HAZ BtnPedPenFase;
|FPRC;

|PROCESO BtnPedConfAlb;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #4#96 ! 0;
          |MENAV "0000Documento de reparación, facturar desde reparaciones.";
          |ACABA;
     |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                        ||Programa + "P " +  Clave
     aProg = "pcegz022" + "P " + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedConfAnula;
     |LEE 101#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ AnulaAcePedido;
     |SI FSalida = 0;
          enForma = -1;
          enAnula = 1;
          |HAZ CalStockPedido;
          enAnula = 0;
          #4#70 = "P";
          |GRABA 020#4a;
          |REFRESCACONTROL nGridPedC;
     |FINSI;
     |LIBERA #4;
|FPRC;

|PROCESO BtnEnvAlema;
     |LEE 101#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #4#101 = "S";
          |CONFI "0000NEl pedido ya esta enviado. ¨Reenviar?";
     |SINO;
          |CONFI "0000S¨Realizar fichero de envio?";
     |FINSI;
     |SI FSalida = 0;
          |HAZ EnvioAlemania;
          |SI FSalida = 0;
               #4#101 = "S";
               |GRABA 020#4a;
               |REFRESCACONTROL nGridPedC;
          |FINSI;
     |FINSI;
     |LIBERA #4;
|FPRC;

|PROCESO BtnPedConfPedir;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     aAlfa = #5#2;
     aAlfa = aAlfa - "CAL";
     |SI aAlfa = #5#2;
          |MENAV "0000El articulo no es un servicio...";
          |ACABA;
     |FINSI;
     |SI #5#32 ! 0;
          aAlfa = "0000Unidades ya pedidas en el pedido:" + #5#31 +"/"+ (("000000" + #5#30)%-106) +"/"+(("000" + #5#32)%-103);
          |MENAV aAlfa;
          |ACABA;
     |FINSI;

     |CONFI "0000N¿Pedir unidades al proveedor?";
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
       ||Programa + Articulo + Unidades + Serie + Pedido + Linea
     aProg = "pcegz016" + #5#2 + (("0000000000000000" + #5#5) % -116);
     aProg = aProg + #5#28 + (("000000" + #5#0)%-106) + (("000" + #5#1)%-103);
     |PTEC 807;
|FPRC;

|PROCESO EsRepara;
     |SELECT #1#4;
     #4#25 = #5#28;
     #4#0 = #5#0;
     |LEE 020#4=;
     |SI #4#96 ! 0;
          nSal = 0;
     |SINO;
          nSal = 1;
          |MENAV "0000Pedido que no viene de reparaciones";
     |FINSI;
     |HAZ PonClavePed;
     FSalida = nSal;
|FPRC;

|PROCESO BtnPedConfReser;
     |LEE 000#5=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI nDepar = 1;
          |HAZ EsRepara;
          |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     nPendiente = #5#5 - #5#43;

     |SI #5#5 < 0;
          |MENAV "0000Unidades negativas...";
          |ACABA;
     |FINSI;

     |SI nPendiente [ 0;
          |MENAV "0000La linea esta completamente servida...";
          |ACABA;
     |FINSI;

     |VENTANA 1302, 2197, -1, 17, "Reservar unidades";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 121#4=;
     |LEE 121#5=;

     |DDEFECTO #15;
     #15#0 = #5#28;
     #15#1 = #5#0;
     #15#2 = #5#1;
     #15#3 = #5#2;
     #15#4 = #5#4;
     #15#5 = #5#5;
     #15#6 = #5#60;

     enForma = -1;
     |HAZ AcumulaPV_PCEG;

     |PINPA #0#15;
     |PINDA #0#15;
  |ET Reserva;
     |ENDATOS #2#15;
     |SI FSalida = 0; |Y nTecla = 0;
          |SI #15#6 > nPendiente;
               |MENAV "0000No se pueden reservar mas unidades de las pendientes...";
               |VETE Reserva;
          |FINSI;

          #5#60 = #15#6;
          |GRABA 020#5a;
          |SALVA_FICHA #5;
          |HAZ RecalTipoPed;
          |GRABA 020#4a;
          |REPON_FICHA #5;
          |REFRESCACONTROL nGridPedC;
     |FINSI;

     enForma = 1;
     |HAZ AcumulaPV_PCEG;

     |LIBERA #4;
     |LIBERA #5;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;

     |SI aAuto ! "";  || Pide CAL al proveedor
          |HAZ IniVentanaEspera;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO BtnPedRechaNueva;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |CONFI "0000N¿Crear nueva oferta con los datos del pedido rechazado?";
     |SI FSalida = 0;
          |HAZ CreaOfePedRecha;
          |SI FSalida = 0;
               |HAZ IniVentanaEspera;
               aAuto = "1";
                                        ||Programa + Modo + Clave
               aProg = "pcegz004" + "2" + #2#48 + (("000000" + #2#0) % -106);
               |PTEC 807;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BtnPedRechaVer;
     nSwVer = 1;
     |HAZ BtnPedPenRecha;
     nSwVer = 0;
|FPRC;

|PROCESO BtnPedRechaAnu;
     |LEE 101#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |CONFI "0000N¿Anular rechazo de oferta?";
     |SI FSalida = 0;

          aRese = "N"; aServ = "N"; aFact = "N";
          |BUCLELIN 2 MiraReseSerFac #4;
          |SI aServ = "S"; |O aFact = "S";
               #4#70 = "C";
               enForma = 1
               |HAZ CalStockPedido;
          |SINO;
               #4#70 = "P";
               enForma = 1
               enRechaza = 1;
               |HAZ CalStockPedido;
               enRechaza = 0;
          |FINSI;
          #4#79 = "01.01.0000";
          #4#80 = "";
          |GRABA 020#4a;
     |FINSI;
     |LIBERA #4;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedRechaLin;
     |HAZ BtnPedConfPedir;
|FPRC;

|PROCESO BtnPedCaliSele;
     |HAZ BtnPedTodoSele;
|FPRC;

|PROCESO BtnPedAparSele;
     |HAZ BtnPedTodoSele;
|FPRC;

|PROCESO BtnPedSinSele;
     |HAZ BtnPedTodoSele;
|FPRC;

|PROCESO BtnPedPdtSele;
     |HAZ BtnPedTodoSele;
|FPRC;

|PROCESO BtnPedTodoSele;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SALVA_DATOS #4;
     |SI #4#70 = "C"; |HAZ BtnPedConf; |FINSI;
     |SI #4#70 = "P"; |HAZ BtnPedPen; |FINSI;
     |SI #4#70 = "R"; |HAZ BtnPedRecha; |FINSI;
     |REPON_DATOS #4;
     |LEE 000#4=;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedNuevo;
     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz008" + "1" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedObs;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 1302, 2697, -1, 17, "Observaciones pedido";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 121#4=;

     |DDEFECTO #9;
     nLin = 0;
     |BUCLE LlenaPedObs;
     |PINPA #0#9;
     |PINDA #0#9;
     |ENDATOS #2#9;
     |SI FSalida = 0; |Y nTecla = 0;
          |HAZ GrabaPedObs;
          |HAZ PintaObsPed;
     |FINSI;

     |LIBERA #4;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;
|FPRC;

|PROCESO BtnPedVer;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz008" + "4" + #4#25 + (("000000" + #4#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnPedWeb;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #29;
     |SELECT #2#29;
     #29#28 = #4#25;
     #29#29 = #4#0;
     #29#27 = "";
     |LEE 000#29];
     |SI FSalida = 0; |Y #29#28 = #4#25; |Y #29#29 = #4#0;
          |HAZ IniVentanaEspera;
          aAuto = "1";
                              ||Programa + Modo + Clave
          aProg = "pcegz044" + "4" + #4#25 + (("000000" + #4#0) % -106);
          |PTEC 807;
     |SINO;
          |MENAV "0000No existe pedido web para este pedido...";
     |FINSI;
     |CIERRA #29;
|FPRC;

|PROCESO BtnPedImp;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;

     aAuto = "1";
             ||Programa + Reimprimir + Clave + Modo impresion
     aProg = "pcegz003"+ #4#25 + (("000000" + #4#0) % -106) + #4#58 + "P";
     |PTEC 807;
|FPRC;

|PROCESO BtnPedFax;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;

     aAuto = "1";
             ||Programa + Reimprimir + Clave + Modo impresion
     aProg = "pcegz003"+ #4#25 + (("000000" + #4#0) % -106) + #4#58 + "F";
     |PTEC 807;
|FPRC;

|PROCESO BtnPedMail;
     |LEE 000#4=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;

     aAuto = "1";
             ||Programa + Reimprimir + Clave + Modo impresion
     aProg = "pcegz003"+ #4#25 + (("000000" + #4#0) % -106) + #4#58 + "M";
     |PTEC 807;
|FPRC;

|PROCESO BtnPedHabilita;
     |SI nBtnPedPenConf ! -1; |ESTADO_CONTROL nBtnPedPenConf, aEstado; |FINSI;
     |SI nBtnPedPenCobro ! -1; |ESTADO_CONTROL nBtnPedPenCobro, aEstado; |FINSI;
     |SI nBtnPedPenModi ! -1; |ESTADO_CONTROL nBtnPedPenModi, aEstado; |FINSI;
     |SI nBtnPedPenRecha ! -1; |ESTADO_CONTROL nBtnPedPenRecha, aEstado; |FINSI;
     |SI nBtnPedPenFact ! -1; |ESTADO_CONTROL nBtnPedPenFact, aEstado; |FINSI;
     |SI nBtnPedPenFase ! -1; |ESTADO_CONTROL nBtnPedPenFase, aEstado; |FINSI;

     |SI nBtnPedConfCobro ! -1; |ESTADO_CONTROL nBtnPedConfCobro, aEstado; |FINSI;
     |SI nBtnPedConfFact ! -1; |ESTADO_CONTROL nBtnPedConfFact, aEstado; |FINSI;
     |SI nBtnPedConfModi ! -1; |ESTADO_CONTROL nBtnPedConfModi, aEstado; |FINSI;
     |SI nBtnPedConfRecha ! -1; |ESTADO_CONTROL nBtnPedConfRecha, aEstado; |FINSI;
     |SI nBtnPedConfVServ ! -1; |ESTADO_CONTROL nBtnPedConfVServ, aEstado; |FINSI;
     |SI nBtnPedConfVFact ! -1; |ESTADO_CONTROL nBtnPedConfVFact, aEstado; |FINSI;
     |SI nBtnPedConfAdj ! -1; |ESTADO_CONTROL nBtnPedConfAdj, aEstado; |FINSI;
     |SI nBtnPedConfFase ! -1; |ESTADO_CONTROL nBtnPedConfFase, aEstado; |FINSI;
     |SI nBtnPedConfAlb ! -1; |ESTADO_CONTROL nBtnPedConfAlb, aEstado; |FINSI;
     |SI nBtnPedConfAnula ! -1; |ESTADO_CONTROL nBtnPedConfAnula, aEstado; |FINSI;
     |SI nBtnPedConfPedir ! -1; |ESTADO_CONTROL nBtnPedConfPedir, aEstado; |FINSI;
     |SI nBtnPedConfReser ! -1; |ESTADO_CONTROL nBtnPedConfReser, aEstado; |FINSI;

     |SI nBtnPedRechaNueva ! -1; |ESTADO_CONTROL nBtnPedRechaNueva, aEstado; |FINSI;
     |SI nBtnPedRechaVer ! -1; |ESTADO_CONTROL nBtnPedRechaVer, aEstado; |FINSI;
     |SI nBtnPedRechaAnu ! -1; |ESTADO_CONTROL nBtnPedRechaAnu, aEstado; |FINSI;

     |SI nBtnPedAparSele ! -1; |ESTADO_CONTROL nBtnPedAparSele, aEstado; |FINSI;

     |SI nBtnPedCaliSele ! -1; |ESTADO_CONTROL nBtnPedCaliSele, aEstado; |FINSI;

     |SI nBtnPedSinSele ! -1; |ESTADO_CONTROL nBtnPedSinSele, aEstado; |FINSI;

     |SI nBtnPedPdtSele ! -1; |ESTADO_CONTROL nBtnPedPdtSele, aEstado; |FINSI;

     |SI nBtnPedTodoSele ! -1; |ESTADO_CONTROL nBtnPedTodoSele, aEstado; |FINSI;

     |ESTADO_CONTROL nBtnPedObs, aEstado;
     |ESTADO_CONTROL nBtnPedVer, aEstado;
     |ESTADO_CONTROL nBtnPedWeb, aEstado;
     |ESTADO_CONTROL nBtnPedImp, aEstado;
     |ESTADO_CONTROL nBtnPedFax, aEstado;
     |ESTADO_CONTROL nBtnPedMail, aEstado;
|FPRC;

|PROCESO BtnPedDestruye;
     |SI nBtnPedPenConf ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenConf; |FINSI;
     |SI nBtnPedPenCobro ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenCobro; |FINSI;
     |SI nBtnPedPenModi ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenModi; |FINSI;
     |SI nBtnPedPenRecha ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenRecha; |FINSI;
     |SI nBtnPedPenFact ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenFact; |FINSI;
     |SI nBtnPedPenFase ! -1; |FIN_CONTROL_WINDOWS nBtnPedPenFase; |FINSI;

     |SI nBtnPedConfCobro ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfCobro; |FINSI;
     |SI nBtnPedConfFact ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfFact; |FINSI;
     |SI nBtnPedConfModi ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfModi; |FINSI;
     |SI nBtnPedConfRecha ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfRecha; |FINSI;
     |SI nBtnPedConfVServ ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfVServ; |FINSI;
     |SI nBtnPedConfVFact ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfVFact; |FINSI;
     |SI nBtnPedConfAdj ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfAdj; |FINSI;
     |SI nBtnPedConfFase ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfFase; |FINSI;
     |SI nBtnPedConfAlb ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfAlb; |FINSI;
     |SI nBtnPedConfAnula ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfAnula; |FINSI;
     |SI nBtnPedConfPedir ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfPedir; |FINSI;
     |SI nBtnPedConfReser ! -1; |FIN_CONTROL_WINDOWS nBtnPedConfReser; |FINSI;

     |SI nBtnPedRechaNueva ! -1; |FIN_CONTROL_WINDOWS nBtnPedRechaNueva; |FINSI;
     |SI nBtnPedRechaVer ! -1; |FIN_CONTROL_WINDOWS nBtnPedRechaVer; |FINSI;
     |SI nBtnPedRechaAnu ! -1; |FIN_CONTROL_WINDOWS nBtnPedRechaAnu; |FINSI;

     |SI nBtnPedAparSele ! -1; |FIN_CONTROL_WINDOWS nBtnPedAparSele; |FINSI;

     |SI nBtnPedCaliSele ! -1; |FIN_CONTROL_WINDOWS nBtnPedCaliSele; |FINSI;

     |SI nBtnPedSinSele ! -1; |FIN_CONTROL_WINDOWS nBtnPedSinSele; |FINSI;

     |SI nBtnPedPdtSele ! -1; |FIN_CONTROL_WINDOWS nBtnPedPdtSele; |FINSI;

     |SI nBtnPedTodoSele ! -1; |FIN_CONTROL_WINDOWS nBtnPedTodoSele; |FINSI;
|FPRC;

|PROCESO BtnPedPenPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Confirmar", 2301, 2315, BtnPedPenConf;
     nBtnPedPenConf = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Cobro", 2317, 2331, BtnPedPenCobro;
     nBtnPedPenCobro = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{197}}Modificar", 2333, 2347, BtnPedPenModi;
     nBtnPedPenModi = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{207}}Rechazar", 2349, 2363, BtnPedPenRecha;
     nBtnPedPenRecha = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Fact. sin servi.", 2365, 2379, BtnPedPenFact;
     nBtnPedPenFact = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Cambiar Fase", 2381, 2395, BtnPedPenFase;
     nBtnPedPenFase = FSalida;

     |SI nDepar = 1;
          |ESTADO_CONTROL nBtnPedPenConf, "HIDE";
          |ESTADO_CONTROL nBtnPedPenCobro, "HIDE";
          |ESTADO_CONTROL nBtnPedPenModi, "HIDE";
          |ESTADO_CONTROL nBtnPedPenRecha, "HIDE";
          |ESTADO_CONTROL nBtnPedPenFact, "HIDE";
          |ESTADO_CONTROL nBtnPedPenFase, "HIDE";
     |FINSI;
     |SI nDepar = 3;
          |ESTADO_CONTROL nBtnPedPenConf, "HIDE";
          |ESTADO_CONTROL nBtnPedPenCobro, "HIDE";
          |ESTADO_CONTROL nBtnPedPenRecha, "HIDE";
          |ESTADO_CONTROL nBtnPedPenFact, "HIDE";
          |ESTADO_CONTROL nBtnPedPenFase, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnPedConfPin;;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Cobro", 2301, 2315, BtnPedConfCobro;
     nBtnPedConfCobro = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Fac. sin serv.", 2317, 2331, BtnPedConfFact;
     nBtnPedConfFact = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{197}}Mod. condic.", 2333, 2347, BtnPedConfModi;
     nBtnPedConfModi = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{207}}Rechazar", 2349, 2363, BtnPedConfRecha;
     nBtnPedConfRecha = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{155}}Ver Servicios", 2365, 2379, BtnPedConfVServ;
     nBtnPedConfVServ = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{155}}Ver Facturas", 2381, 2395, BtnPedConfVFact;
     nBtnPedConfVFact = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Adj. Stock/Servir", 2401, 2415, BtnPedConfAdj;
     nBtnPedConfAdj = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Cambio Fase", 2417, 2431, BtnPedConfFase;
     nBtnPedConfFase = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Albaran reser.", 2433, 2447, BtnPedConfAlb;
     nBtnPedConfAlb = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Anular Confirma.", 2449, 2463, BtnPedConfAnula;
     nBtnPedConfAnula = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Envio Alemania", 2465, 2479, BtnEnvAlema;
     nBtnEnvAlema = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Pedir a Prov.", 3201, 3215, BtnPedConfPedir;
     nBtnPedConfPedir = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Reservar", 3217, 3231, BtnPedConfReser;
     nBtnPedConfReser = FSalida;

     |SI nDepar = 1;
          |ESTADO_CONTROL nBtnPedConfCobro, "HIDE";
          |ESTADO_CONTROL nBtnPedConfFact, "HIDE";
          |ESTADO_CONTROL nBtnPedConfModi, "HIDE";
          |ESTADO_CONTROL nBtnPedConfRecha, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAdj, "HIDE";
          |ESTADO_CONTROL nBtnPedConfFase, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAlb, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAnula, "HIDE";
          |ESTADO_CONTROL nBtnPedConfPedir, "HIDE";
||          |ESTADO_CONTROL nBtnPedConfReser, "HIDE";
     |FINSI;
     |SI nDepar = 2;
          |ESTADO_CONTROL nBtnPedConfCobro, "HIDE";
          |ESTADO_CONTROL nBtnPedConfFact, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAdj, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAlb, "HIDE";
     |FINSI;
     |SI nDepar = 3;
          |ESTADO_CONTROL nBtnPedConfCobro, "HIDE";
          |ESTADO_CONTROL nBtnPedConfFact, "HIDE";
          |ESTADO_CONTROL nBtnPedConfRecha, "HIDE";
          |ESTADO_CONTROL nBtnPedConfFase, "HIDE";
          |ESTADO_CONTROL nBtnPedConfAnula, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnPedCaliPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Seleccionar", 2301, 2316, BtnPedCaliSele;
     nBtnPedCaliSele = FSalida;
|FPRC;

|PROCESO BtnPedRechaPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{193}} Crear Nueva", 2301, 2316, BtnPedRechaNueva;
     nBtnPedRechaNueva = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{206}} Motivo Rechazo", 2321, 2336, BtnPedRechaVer;
     nBtnPedRechaVer = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{206}} Anular Rechazo", 2341, 2356, BtnPedRechaAnu;
     nBtnPedRechaAnu = FSalida;

     |SI nDepar = 1;
          |ESTADO_CONTROL nBtnPedRechaNueva, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnPedAparPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Seleccionar", 2301, 2316, BtnPedAparSele;
     nBtnPedAparSele = FSalida;
|FPRC;

|PROCESO BtnPedSinPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Seleccionar", 2301, 2316, BtnPedSinSele;
     nBtnPedSinSele = FSalida;
|FPRC;

|PROCESO BtnPedPdtPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Seleccionar", 2301, 2316, BtnPedPdtSele;
     nBtnPedPdtSele = FSalida;
|FPRC;

|PROCESO BtnPedTodoPin;
     |HAZ BtnPedDestruye;

     |CONTROL_SIMPLE nPanPed, "BOTON,Seleccionar", 2301, 2316, BtnPedTodoSele;
     nBtnPedTodoSele = FSalida;
|FPRC;

|PROCESO BtnPedPen;
     aBotonPed = "1";
     |HAZ BtnPedPenPin;
     |ESTADO_CONTROL nBtnPedPen, "DISABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     aDSituPed = "P";
     aHSituPed = "P";
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedConf;
     aBotonPed = "2";
     |HAZ BtnPedConfPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "DISABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     aDSituPed = "C";
     aHSituPed = "C";
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedCali;
     aBotonPed = "3";
     |HAZ BtnPedCaliPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "DISABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     nDTipoPed = 3;
     nHTipoPed = 3;
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedApar;
     aBotonPed = "4";
     |HAZ BtnPedAparPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "DISABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     nDTipoPed = 2;
     nHTipoPed = 2;
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedSin;
     aBotonPed = "5";
     |HAZ BtnPedSinPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "DISABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     nDTipoPed = 1;
     nHTipoPed = 1;
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedPdt;
     aBotonPed = "6";
     |HAZ BtnPedPdtPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "DISABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     nDTipoPed = 1;
     nHTipoPed = 3;
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedTodo;
     aBotonPed = "7";
     |HAZ BtnPedTodoPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "ENABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "DISABLE";
     aDSituPed = " ";
     aHSituPed = "z";
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedRecha;
     aBotonPed = "15";
     |HAZ BtnPedRechaPin;
     |ESTADO_CONTROL nBtnPedPen, "ENABLE";
     |ESTADO_CONTROL nBtnPedConf, "ENABLE";
     |ESTADO_CONTROL nBtnPedRecha, "DISABLE";
     |ESTADO_CONTROL nBtnPedCali, "ENABLE";
     |ESTADO_CONTROL nBtnPedApar, "ENABLE";
     |ESTADO_CONTROL nBtnPedSin, "ENABLE";
     |ESTADO_CONTROL nBtnPedPdt, "ENABLE";
     |ESTADO_CONTROL nBtnPedTodo, "ENABLE";
     aDSituPed = "R";
     aHSituPed = "R";
     |HAZ GridPedido;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
|FPRC;

|PROCESO BtnPedSal;
     |PTEC 807;
|FPRC;

|PROCESO EventoFocoPed;
     aPestana = "2";
     |FOCOTECLADO nGridPedC;
|FPRC;

|PROCESO EventoPedL;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#5=;
          |HAZ PintaObsCalibra;
          |HAZ PintaStock;
     |FINSI;
|FPRC;

|PROCESO MinPedL;
     #5#28 = #4#25;
     #5#0 = #4#0;
     #5#1 = 001;
|FPRC;

|PROCESO MaxPedL;
     #5#28 = #4#25;
     #5#0 = #4#0;
     #5#1 = 999;
     |SI nPrimera = 0; ||Para evitar que al entrar muestre datos
          #5#1 = 0;
     |FINSI;
|FPRC;

|PROCESO EventoPedC;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#4=;
          |SI FSalida = 0;
               aEstado = "ENABLE"; |HAZ BtnPedHabilita;
               |REFRESCACONTROL nGridPedL;
               |HAZ PintaObsPed;
               aDivisa = #4#35;
               aMoneda = #4#37;
               |HAZ Divisas104;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MinPedC1;
     #4#70 = "C";
     #4#76 = nDTipoPed;
     |SI #0#0 = "000000";
          #4#4 = "000000";
     |SINO;
          #4#4 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #4#57 = 1;
     |SINO;
          #4#57 = #0#1;
     |FINSI;
     #4#25 = "     ";
     #4#0 = 000000;
|FPRC;

|PROCESO MaxPedC1;
     #4#70 = "C";
     #4#76 = nHTipoPed;
     |SI #0#0 = "000000";
          #4#4 = "999999";
     |SINO;
          #4#4 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #4#57 = 9999;
     |SINO;
          #4#57 = #0#1;
     |FINSI;
     #4#25 = "zzzzz";
     #4#0 = 999999;
|FPRC;

|PROCESO MinPedC;
     #4#70 = aDSituPed;
     |SI #0#0 = "000000";
          #4#4 = "000000";
     |SINO;
          #4#4 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #4#57 = 1;
     |SINO;
          #4#57 = #0#1;
     |FINSI;
     #4#25 = "     ";
     #4#0 = 000000;
|FPRC;

|PROCESO MaxPedC;
     #4#70 = aHSituPed;
     |SI #0#0 = "000000";
          #4#4 = "999999";
     |SINO;
          #4#4 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #4#57 = 9999;
     |SINO;
          #4#57 = #0#1;
     |FINSI;
     #4#25 = "zzzzz";
     #4#0 = 999999;
|FPRC;

|PROCESO GridPedido;
     |PINPA #2#0;  nPanPed = FSalida;
     |PINDA #2#0;

     #4#0 = 0; || para que no salgan las lineas si no hay cabeceras

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2502;
     nPos2 = 3198;
     |SI nGridPedL ! -1; |DESTRUYECONTROL nGridPedL; |FINSI;
     |LINEAL_SIMPLE #1#5, nRango, nPos1, nPos2, MinPedL, MaxPedL, EventoPedL;
     nGridPedL = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0702;
     nPos2 = 1998;
     |SI nGridPedC ! -1; |DESTRUYECONTROL nGridPedC; |FINSI;
     |SI aBotonPed = "4"; |O aBotonPed = "5"; |O aBotonPed = "6";
               |O aBotonPed = "3";
          |SI #0#0 = "000000";
               |LINEAL_SIMPLE #7#4, nRango, nPos1, nPos2, MinPedC1, MaxPedC1, EventoPedC;
               nClavePed = 7;
          |SINO;
               |SI #0#1 = 0;
                    |LINEAL_SIMPLE #8#4, nRango, nPos1, nPos2, MinPedC1, MaxPedC1, EventoPedC;
                    nClavePed = 8;
               |SINO;
                    |LINEAL_SIMPLE #6#4, nRango, nPos1, nPos2, MinPedC1, MaxPedC1, EventoPedC;
                    nClavePed = 6;
               |FINSI;
          |FINSI;
     |SINO;
          |SI #0#0 = "000000";
               |LINEAL_SIMPLE #4#4, nRango, nPos1, nPos2, MinPedC, MaxPedC, EventoPedC;
               nClavePed = 4;
          |SINO;
               |SI #0#1 = 0;
                    |LINEAL_SIMPLE #5#4, nRango, nPos1, nPos2, MinPedC, MaxPedC, EventoPedC;
                    nClavePed = 5;
               |SINO;
                    |LINEAL_SIMPLE #3#4, nRango, nPos1, nPos2, MinPedC, MaxPedC, EventoPedC;
                    nClavePed = 3;
               |FINSI;
          |FINSI;
     |FINSI;
     nGridPedC = FSalida;
|FPRC;

|PROCESO PanPedidos;
     |HAZ GridPedido;

     |CONTROL_SIMPLE nPanPed, "EVENTOPAN", 0000, 0000, EventoFocoPed;
     nFocoPed = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,Ptes. Conf.", 0501, 0511, BtnPedPen;
     nBtnPedPen = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Confirmados", 0512, 0522, BtnPedConf;
     nBtnPedConf = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,A Calibrar", 0523, 0533, BtnPedCali;
     nBtnPedCali = FSalida;
       ||CONTROL_SIMPLE nPanPed, "BOTON,Apartados", 0534, 0544, BtnPedApar;
     |CONTROL_SIMPLE nPanPed, "BOTON,Reservados", 0534, 0544, BtnPedApar;
     nBtnPedApar = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Sin Reserva", 0545, 0555, BtnPedSin;
     nBtnPedSin = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Ptes. Servir", 0556, 0566, BtnPedPdt;
     nBtnPedPdt = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Todos", 0567, 0577, BtnPedTodo;
     nBtnPedTodo = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,{{193}}Nuevo", 0578, 0588, BtnPedNuevo;
     nBtnPedNuevo = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Observa.", 0589, 0599, BtnPedObs;
     nBtnPedObs = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,{{155}}Ver Ped.", 0601, 0611, BtnPedVer;
     nBtnPedVer = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Ped. Web", 0612, 0622, BtnPedWeb;
     nBtnPedWeb = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,{{205}}Imprimir", 0623, 0633, BtnPedImp;
     nBtnPedImp = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Fax", 0634, 0644, BtnPedFax;
     nBtnPedFax = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Mail", 0645, 0655, BtnPedMail;
     nBtnPedMail = FSalida;
     |CONTROL_SIMPLE nPanPed, "BOTON,Rechazados", 0656, 0666, BtnPedRecha;
     nBtnPedRecha = FSalida;

     |CONTROL_SIMPLE nPanPed, "BOTON,{{207}} Salir", 3490, 3498, BtnPedSal;
     nBtnPedSal = FSalida;

     |SI nDepar = 1;
          |ESTADO_CONTROL nBtnPedNuevo, "HIDE";
          |ESTADO_CONTROL nBtnPedFax, "HIDE";
          |ESTADO_CONTROL nBtnPedMail, "HIDE";
     |FINSI;
|FPRC;

--------------------OFERTAS----------------------------------------------
----Llamadas del pcegz011

|PROCESO RecalZona;
     |SI #11Campo = Contenido; |ACABA; |FINSI;
     |ABRE #107;
     #107#0 = #11#117;
     #107#1 = #11#115;
     |LEE 000#107=;
     |SI FSalida = 0;
          #11#119 = #107#2;
     |SINO;
          aAlfa = #11#115 % 102;
          #107#1 = aAlfa;
          |LEE 000#107=;
          |SI FSalida = 0;
               #11#119 = #107#2;
          |SINO;
               #107#1 = "";
               |LEE 000#107=;
               |SI FSalida = 0;
                    #11#119 = #107#2;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #107;
     |PINTA #11#119;
|FPRC;

|PROCESO ImprePedi; |TIPO 0;
     aAlfa = #11#122;
     |C_M #11#124, 1, aAlfa;
|FPRC;

|PROCESO Min1003_1;
     #1003#0 = #11#99;
     #1003#1 = 1;
|FPRC;

|PROCESO Max1003_1;
     #1003#0 = #11#99;
     #1003#1 = 9999;
|FPRC;

|PROCESO DirAceOfe66; |TIPO 66;
     |ABRE #1003;
     #1003#0 = #11#99;
     #1003#1 = #11#100;
     |LEE 000#1003];
     |CONSULTA_F_CLAVE #1#1003, Min1003_1, Max1003_1;
     |SI FSalida = 0;
          #11#99 = #1003#1; |PINTA #11#99;
          #11#100 = #1003#2; |PINTA #11#100;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #1003;
|FPRC;

|PROCESO DirAceOfe; |TIPO 6;
     |ABRE #1003;
     #1003#0 = #11#99;
     #1003#1 = #11#100;
     |LEE 000#1003=;
     |SI FSalida ! 0;
          |CONFI "0000SNo existe la direccion de factura. ¿Desea crearla?";
          |SI FSalida = 0;
               aAuto = "1";

                    ||Programa + "D" + Cli + Dir.Ent
               aProg = "dszx0001"+ "D" + #11#99 + (("0000" + #11#100) % -104);

               aPosicion = "ACEPTA_OFERTA" + #11#99 + (("0000" + #11#100) % -104);
               |ERROR;
               |PTEC 807;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #1003;
|FPRC;

|PROCESO CliAceOfe; |TIPO 6;
     |ABRE #24;
     #24#0 = #11#99;
     |LEE 000#24=;
     |SI FSalida ! 0;
          |CONFI "0000SNo existe el cliente. ¿Desea crearlo?";
          |SI FSalida = 0;
               aAuto = "1";

                    ||Programa + "C" + Cliente
               aProg = "dszx0001"+ "C" + #11#99;

               aPosicion = "ACEPTA_OFERTA" + #11#99 + (("0000" + #11#100) % -104);
               |ERROR;
               |PTEC 807;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO IVA011_66; |TIPO 66;
     enTiva = #11Campo;
     efFiva = #11#102;
     |HAZ ConsuIVA;
     |SI eaDiva = "";
          |ERROR;
     |SINO;
          #0Campo = enTiva; |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO IVA011_0; |TIPO 0;
     enTiva = #11Campo;
     efFiva = #11#102;
     |HAZ SacaIVA;
     |SI eaDiva = "";
          |MENAV "0000No existe tipo iva para esta fecha...";
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
------------------------------
|PROCESO BtnDatoEnvioOfe;
     |ABRE #1003;
     #1003#0 = #11#99;
     #1003#1 = #11#100;
     |LEE 020#1003=;
     |CIERRA #1003;
     |SI #11#127 = #20#2;
          |ABRE #124;
          #124#0 = #1003#19;
          |LEE 000#124=;
          |SI FSalida ! 0;
               |MENAV "0000No existe el pais en el auxiliar paises CHRONOEXPRES";
               |ACABA;
          |FINSI;
          |CIERRA #124;
     |FINSI;
     #11#111 = #1003#22; |PINTA #11#111;
     #11#112 = #1003#10; |PINTA #11#112;
     #11#113 = #1003#2; |PINTA #11#113;
     #11#114 = #1003#3; |PINTA #11#114;
     #11#115 = #1003#23; |PINTA #11#115;
     #11#116 = #1003#7; |PINTA #11#116;
     #11#117 = #1003#19; |PINTA #11#117;
     #11#118 = #1003#8; |PINTA #11#118;
     #11#119 = #1003#11; |PINTA #11#119;
     #11#120 = #1003#12; |PINTA #11#120;
     #11#132 = #1003#25; |PINTA #11#132;
     #11#133 = #1003#26; |PINTA #11#133;
|FPRC;

|PROCESO CalcuPedido;
     |SALVA_FICHA #2;

     #2#11 = #11#104;    || calcula con los nuevos portes
     #2#12 = #11#129;
     |HAZ LimCabpcegm002;
     |BUCLELIN 0 CalCabpcegm002 #2;
     nNume = #2#73;

     |REPON_FICHA #2;
|FPRC;

|PROCESO CreaOfePendLin;
     #3#0 = nConta;
     |GRABA 020#3n;
|FPRC;

|PROCESO CreaOfePend;
     |SALVA_DATOS #3;
     |SALVA_DATOS #2;
     enSwMenu = 1;
     |HAZ ContaOf7;
     nConta = #2#0;
     |REPON_DATOS #2;
     |BUCLELIN 2 CreaOfePendLin #2;
     #2#0 = nConta;
     #2#83 = "P";
     #2#98 = Usuario % 810;
     |GRABA 020#2n;
     |REPON_DATOS #3;
|FPRC;

|PROCESO BtnOfeRechaNueva;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;

     |HAZ CreaOfePend;

     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "2" + #2#48 + (("000000" + #2#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeRechaMotivo;
     |HAZ BtnOfePenRecha;
|FPRC;

|PROCESO BtnOfeRechaAnula;
     |LEE 101#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |CONFI "0000N¿Anular rechazo de oferta?";
     |SI FSalida = 0;
          #2#83 = "P";
          #2#110 = "01.01.0000";
          #2#101 = "";
          |GRABA 020#2a;
     |FINSI;
     |LIBERA #2;
     |REFRESCACONTROL nGridOfeC;
|FPRC;

|PROCESO BtnOfeAceRecha;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |MENAV "0000Oferta Aceptada, Rechaza Oferta";
|FPRC;

|PROCESO BtnOfeAceAnula;
     |LEE 101#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ AnulaAceOferta;
     |SI FSalida = 0;
          #2#83 = "P";
          |GRABA 020#2a;
          |REFRESCACONTROL nGridPedC;
          |REFRESCACONTROL nGridOfeC;
     |FINSI;
     |LIBERA #2;
|FPRC;

|PROCESO BtnOfeAceVerPed;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SELECT #1#4;
     #4#25 = #2#60;
     #4#0 = #2#61;
     |LEE 000#4=;
     nSal = FSalida;

     |SI nSal = 0;
          |SALVA_DATOS #4;
          |SI #4#70 = "C"; |HAZ BtnPedConf; |FINSI;
          |SI #4#70 = "P"; |HAZ BtnPedPen; |FINSI;
          |SI #4#70 = "R"; |HAZ BtnPedRecha; |FINSI;
          |HAZ EventoFocoPed;
          |REPON_DATOS #4;
          |HAZ PonClavePed;
          |LEE 020#4=;
          |REFRESCACONTROL nGridPedC;
     |SINO;
          aAlfa = "0000No existe pedido: " + #4#0 + "/" + (("000000" + #4#0) % -106);
          |MENAV aAlfa;
          |HAZ PonClavePed;
     |FINSI;
|FPRC;

|PROCESO BtnOfePenModi;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "2" + #2#48 + (("000000" + #2#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnOfePenRecha;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 1302, 2197, -1, 17, "Rechazo de oferta";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 121#2=;

     |DDEFECTO #7;
     #7#0 = #2#48;
     #7#1 = #2#0;
     #7#2 = #2#100;
     #7#3 = #2#101;
     #7#4 = #2#110;
     #7#5 = #2#129;

     |PINPA #0#7;
     |SI #2#83 = "R";
          |PINDA #0#7;
          |PAUSA;
     |SINO;
          #7#2 = Usuario % 810;
          #7#4 = ~;
          |PINDA #0#7;
          |ENDATOS #2#7;
          |SI FSalida = 0; |Y nTecla = 0;
               #2#83 = "R";
               #2#100 = #7#2;
               #2#101 = #7#3;
               #2#110 = #7#4;
               #2#129 = #7#5;
               |GRABA 020#2a;

               aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
               |REFRESCACONTROL nGridOfeC;
          |FINSI;
     |FINSI;

     |LIBERA #2;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;
|FPRC;

|PROCESO LeePago11; |TIPO 0;
     |ABRE #91;
     #91#0 = #11#108;
     |LEE 000#91=;
     |SI FSalida = 0;
          #11#109 = #91#1; |PINTA #11#109;
     |SINO;
          |MENAV "0000No existe forma de pago";
          |ERROR;
     |FINSI;
     |CIERRA #91;
|FPRC;

|PROCESO Portes11; |TIPO 0;
     |SI #11#131 ! "D"; |Y #11#131 ! "P";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO LeeAgen11; |TIPO 0;
     |ABRE #1020;
     #1020#0 = #11#127;
     |LEE 000#1020=;
     |SI FSalida = 0;
          #11#128 = #1020#1; |PINTA #11#128;
          |SI #11#127 = #20#2;
               |ABRE #124;
               #124#0 = #11#117;
               |LEE 000#124=;
               |SI FSalida ! 0;
                    |MENAV "0000No existe el pais en el auxiliar paises CHRONOEXPRES";
                    |ERROR;
               |FINSI;
               |CIERRA #124;
          |FINSI;
     |SINO;
          |MENAV "0000No existe agencia de transporte";
          |ERROR;
     |FINSI;
     |CIERRA #1020;
|FPRC;

|PROCESO HayCalOferta;
     aArti = #3#2;
     aAlfa = aArti - "CAL";
     |SI aAlfa ! aArti;
          aHayCal = "S";
     |FINSI;
|FPRC

|PROCESO OfeConfirmaPed; |TIPO 0;
     |SI #11#121 = "C";
          aAlf1 = #2#111; |QBF aAlf1;
          aAlf2 = #2#112; |QBF aAlf2;
          aAlf3 = #2#113; |QBF aAlf3;
          aAlf4 = #2#114; |QBF aAlf4;
          aAlf5 = #2#115; |QBF aAlf5;
          |SI aAlf1 = ""; |O aAlf2 = ""; |O aAlf3 = ""; |O aAlf4 = ""; |O aAlf5 = "";
               aHayCal = "N";
               |BUCLELIN 2 HayCalOferta #2;
               |SI aHayCal = "S";
                    |MENAV "0000No se pude confirmar, faltan los datos de calibración";
                    #11#121 = "P"; |PINTA #11#121;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PedRepartoAge;
     |SI #4#60 = #20#1;
          #37#0 = #37#0 + 1;
     |SINO;
          |SI #4#60 = #20#2;
               #37#1 = #37#1 + 1;
          |SINO;
               #37#2 = #37#2 + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE PedRepartoAge;
     #4#7;
     ;
     "C", 1, "      ", 0001, "     ", 000001;
     "C", 2, "zzzzzz", 9999, "zzzzz", 999999;
     ;
     NULL, PedRepartoAge;
|FIN;

|PROCESO BtnRelaAgen;
     |VENTANA 1228, 2069, -1, 17, "Reparto de Envios por Agencias";
     nVentana1 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana1;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #37;
     |BUCLE PedRepartoAge;

     |PINPA #0#37;
     |PINDA #0#37;
     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana1;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana1;
     |PULSATECLA;
|FPRC;

|PROCESO Carga11;
     aDivisa = #2#65;
     aMoneda = #2#67;
     |HAZ Divisas146;

     |ABRE #91;
     #91#0 = #2#8;
     |LEE 000#91=;
     |CIERRA #91;
     |ABRE #225;
     #225#0 = #2#107;
     |LEE 000#225=;
     |CIERRA #225;
     |ABRE #101;
     #101#0 = #2#108;
     |LEE 000#101=;
     |CIERRA #101;

     |DDEFECTO #11;
     #11#0 = #2#125;
     #11#1 = #2#126;
     #11#99 = #2#3;
     #11#100 = #2#80;
     #11#101 = #2#94;
     #11#102 = ~;
     nNume = #11#102; nNume = nNume - 2;
     #11#103 = "31.12.2099"; || nNume;
     |SI #2#67 = "D";
          #11#104 = #2#76;
     |SINO;
          #11#104 = #2#11;
     |FINSI;
     #11#105 = #2#87;
     #11#106 = #2#88;
     #11#107 = #2#89;
     #11#108 = #2#8;
     #11#109 = #91#1;
     #11#110 = 0;
     #11#111 = #2#106;
     #11#112 = #2#29;
     #11#113 = #2#30;
     #11#114 = #2#31;
     #11#115 = #2#81;
     #11#116 = #2#33;
     #11#117 = #2#107;
     #11#118 = #225#1;
     #11#119 = #2#108;
     #11#120 = #101#1;
     ||#11#121 = "C";    se carga despues
     #11#123 = #2#4;
     #11#125 = #2#109;
     #11#126 = ~;
     #11#127 = #2#78;
     #11#128 = #2#9;
     #11#129 = #2#12;
     #11#132 = #2#125;
     #11#133 = #2#126;
|FPRC;

|PROCESO BtnOfePenAcep;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |VENTANA 504, 3894, -1, 17, "Aceptar ofertas";
     nVentana0 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 121#2=;

     |HAZ Carga11;
     #11#121 = "P";

     |SI nDepar = 1;
          |C_M #11#110, 1, "N";
          |C_M #11#121, 1, "N";
          |C_M #11#126, 1, "N";
     |SINO;
          |C_M #11#110, 1, "S";
          |C_M #11#121, 1, "S";
          |C_M #11#126, 1, "S";
     |FINSI;

     aAlfa = aPosicion % 113;
     |SI aAlfa = "ACEPTA_OFERTA";
          aAlfa = aPosicion % 1406; #11#99 = aAlfa;
          aAlfa = aPosicion % 2004; #11#100 = aAlfa;
     |FINSI;
     aPosicion = "";
     aAuto = "";

     |PINPA #0#11;
     nPanta = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Poner dir. factura", 2522, 2540, BtnDatoEnvioOfe;
     nBtnDatoEnvio = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,Reparto envios por agencia", 1070, 1091, BtnRelaAgen;
     nBtnRelaAgen = FSalida;

     |PINDA #0#11;
   |ET OtraAceptaOfe;
     nOk = 1;
     |ENDATOS #2#11;
     |SI FSalida = 0; |Y nTecla = 0;
          |SI #11#131 = " ";
               |MENAV "0000Debe de indicar el tipo de portes...";
               |VETE OtraAceptaOfe;
          |FINSI;
          |HAZ CalcuPedido;
          |SI #11#110 > nNume;
               aAlfa = "0000Importe pedido " + nNume + " es menor que el importe cobrado";
               |MENAV aAlfa;
               |VETE OtraAceptaOfe;
          |FINSI;
          nOk = 0;

          |SALVA_DATOS #4;
          |SELECT #1#4;
          #11#131 = "P";
          |HAZ AceptaOferta;

          |ABRE #42; |SELECT #4#42;
          #42#15 = #2#48;
          #42#16 = #2#0;
          |LEE 101#42=;
          |SI FSalida = 0;
               #42#22 = "R";
               |GRABA 020#42a;
               |REFRESCACONTROL nGridRepC;
          |FINSI;
          |CIERRA #42;

          |SI #11#121 = "C";
               fFecha = ~;
               |SI #4#66 > fFecha;
                    |MENAV "0000No se procede al intento de servicio inmediato por tener fecha de servicio superior a la fecha del sistema";
               |SINO;
                                       ||Programa +  Clave + F.Prev.Env
                    aProg = "pcegz018" + #4#25 + (("000000" + #4#0) % -106) + #4#66;
                    aAuto = "1";
               |FINSI;
          |FINSI;
          |SI #11#122 = "S";
               |LIBERA #4;
               eaImpresora = "CrystalReport";
               eaTipoImp = #11#124;
               ser_ped = #4#25;
               num_ped = #4#0;
               |SUB_EJECUTA_NP "pcegz003";
          |FINSI;
          |REPON_DATOS #4;
          |HAZ PonClavePed;
          |LEE 000#4=;
     |FINSI;

     |LIBERA #2;

     |FIN_CONTROL_WINDOWS nBtnDatoEnvio;
     |FIN_CONTROL_WINDOWS nBtnRelaAgen;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana0;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana0;
     |PULSATECLA;

     |SI aAuto ! "";
          |PTEC 807;
          |HAZ IniVentanaEspera;
     |FINSI;

     |SI nOk = 0;
          |SALVA_DATOS #2;
          |HAZ BtnOfeAce;
          |REPON_DATOS #2;
          |LEE 020#2=;
          |REFRESCACONTROL nGridOfeC;
          |REFRESCACONTROL nGridPedC;
     |FINSI;
|FPRC;

|PROCESO BtnOfePenNueva;
     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "1" + #2#48 + (("000000" + #2#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeImp;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                ||Programa + Clave + Reimprimir +  Modo impresion
     aProg = "pcegz002"+ #2#48 + (("000000" + #2#0) % -106) + #2#10 + "P";
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeFax;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                ||Programa + Clave + Reimprimir +  Modo impresion
     aProg = "pcegz002"+ #2#48 + (("000000" + #2#0) % -106) + #2#10 + "F";
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeMail;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                ||Programa + Clave + Reimprimir +  Modo impresion
     aProg = "pcegz002"+ #2#48 + (("000000" + #2#0) % -106) + #2#10 + "M";
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeVer;
     |LEE 000#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                              ||Programa + Modo + Clave
     aProg = "pcegz004" + "4" + #2#48 + (("000000" + #2#0) % -106);
     |PTEC 807;
|FPRC;

|PROCESO BtnOfeHabilita
     |SI nBtnOfePenAcep ! -1; |ESTADO_CONTROL nBtnOfePenAcep, aEstado; |FINSI;
     |SI nBtnOfePenRecha ! -1; |ESTADO_CONTROL nBtnOfePenRecha, aEstado; |FINSI;
     |SI nBtnOfePenModi ! -1; |ESTADO_CONTROL nBtnOfePenModi, aEstado; |FINSI;

     |SI nBtnOfeAceVerPed ! -1; |ESTADO_CONTROL nBtnOfeAceVerPed, aEstado; |FINSI;
     |SI nBtnOfeAceRecha ! -1; |ESTADO_CONTROL nBtnOfeAceRecha, aEstado; |FINSI;
     |SI nBtnOfeAceAnula ! -1; |ESTADO_CONTROL nBtnOfeAceAnula, aEstado; |FINSI;

     |SI nBtnOfeRechaNueva ! -1; |ESTADO_CONTROL nBtnOfeRechaNueva, aEstado; |FINSI;
     |SI nBtnOfeRechaMotivo ! -1; |ESTADO_CONTROL nBtnOfeRechaMotivo, aEstado; |FINSI;
     |SI nBtnOfeRechaAnula ! -1; |ESTADO_CONTROL nBtnOfeRechaAnula, aEstado; |FINSI;

     |ESTADO_CONTROL nBtnOfeImp, aEstado;
     |ESTADO_CONTROL nBtnOfeFax, aEstado;
     |ESTADO_CONTROL nBtnOfeMail, aEstado;
     |ESTADO_CONTROL nBtnOfeVer, aEstado;
|FPRC;

|PROCESO BtnOfeDestruye;
     |SI nBtnOfePenNueva ! -1; |FIN_CONTROL_WINDOWS nBtnOfePenNueva; |FINSI;
     |SI nBtnOfePenAcep ! -1; |FIN_CONTROL_WINDOWS nBtnOfePenAcep; |FINSI;
     |SI nBtnOfePenRecha ! -1; |FIN_CONTROL_WINDOWS nBtnOfePenRecha; |FINSI;
     |SI nBtnOfePenModi ! -1; |FIN_CONTROL_WINDOWS nBtnOfePenModi; |FINSI;

     |SI nBtnOfeAceVerPed ! -1; |FIN_CONTROL_WINDOWS nBtnOfeAceVerPed; |FINSI;
     |SI nBtnOfeAceRecha ! -1; |FIN_CONTROL_WINDOWS nBtnOfeAceRecha; |FINSI;
     |SI nBtnOfeAceAnula ! -1; |FIN_CONTROL_WINDOWS nBtnOfeAceAnula; |FINSI;

     |SI nBtnOfeRechaNueva ! -1; |FIN_CONTROL_WINDOWS nBtnOfeRechaNueva; |FINSI;
     |SI nBtnOfeRechaMotivo ! -1; |FIN_CONTROL_WINDOWS nBtnOfeRechaMotivo; |FINSI;
     |SI nBtnOfeRechaAnula ! -1; |FIN_CONTROL_WINDOWS nBtnOfeRechaAnula; |FINSI;
|FPRC;

|PROCESO BtnOfePenPin;
     |HAZ BtnOfeDestruye;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{193}} Crear Nueva", 2301, 2316, BtnOfePenNueva;
     nBtnOfePenNueva = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{206}} Aceptar", 2321, 2336, BtnOfePenAcep;
     nBtnOfePenAcep = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{207}} Rechazar", 2341, 2356, BtnOfePenRecha;
     nBtnOfePenRecha = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{197}} Modificar", 2361, 2376, BtnOfePenModi;
     nBtnOfePenModi = FSalida;

     |SI nDepar = 3;
          |ESTADO_CONTROL nBtnOfePenNueva, "HIDE";
          |ESTADO_CONTROL nBtnOfePenAcep, "HIDE";
          |ESTADO_CONTROL nBtnOfePenRecha, "HIDE";
          |ESTADO_CONTROL nBtnOfePenModi, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnOfeAcePin;
     |HAZ BtnOfeDestruye;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{155}} Ver Pedido", 2301, 2316, BtnOfeAceVerPed;
     nBtnOfeAceVerPed = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,Anular Aceptación", 2321, 2336, BtnOfeAceAnula;
     nBtnOfeAceAnula = FSalida;

||     |CONTROL_SIMPLE nPanOfe, "BOTON,{{207}} Rechazar Oferta", 2341, 2356, BtnOfeAceRecha;
||     nBtnOfeAceRecha = FSalida;


     |SI nDepar = 3;
          |ESTADO_CONTROL nBtnOfeAceRecha, "HIDE";
          |ESTADO_CONTROL nBtnOfeAceAnula, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnOfeRechaPin;
     |HAZ BtnOfeDestruye;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{193}} Crear Nueva", 2301, 2316, BtnOfeRechaNueva;
     nBtnOfeRechaNueva = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{206}} Motivo Rechazo", 2321, 2336, BtnOfeRechaMotivo;
     nBtnOfeRechaMotivo = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,Anular Rechazo", 2341, 2356, BtnOfeRechaAnula;
     nBtnOfeRechaAnula = FSalida;

     |SI nDepar = 3;
          |ESTADO_CONTROL nBtnOfeRechaNueva, "HIDE";
          |ESTADO_CONTROL nBtnOfeRechaAnula, "HIDE";
     |FINSI;
|FPRC;

|PROCESO BtnOfePen;
     aBotonOfe = "1";
     |HAZ BtnOfePenPin;
     |ESTADO_CONTROL nBtnOfePen, "DISABLE";
     |ESTADO_CONTROL nBtnOfeAce, "ENABLE";
     |ESTADO_CONTROL nBtnOfeRecha, "ENABLE";
     |ESTADO_CONTROL nBtnOfeToda, "ENABLE";
     aDSituOfe = "P";
     aHSituOfe = "P";
     |HAZ GridOferta;
     aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
     |REFRESCACONTROL nGridOfeC;
|FPRC;

|PROCESO BtnOfeAce;
     aBotonOfe = "2";
     |HAZ BtnOfeAcePin;
     |ESTADO_CONTROL nBtnOfePen, "ENABLE";
     |ESTADO_CONTROL nBtnOfeAce, "DISABLE";
     |ESTADO_CONTROL nBtnOfeRecha, "ENABLE";
     |ESTADO_CONTROL nBtnOfeToda, "ENABLE";
     aDSituOfe = "A";
     aHSituOfe = "A";
     |HAZ GridOferta;
     aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
     |REFRESCACONTROL nGridOfeC;
|FPRC;

|PROCESO BtnOfeRecha;
     aBotonOfe = "3";
     |HAZ BtnOfeRechaPin;
     |ESTADO_CONTROL nBtnOfePen, "ENABLE";
     |ESTADO_CONTROL nBtnOfeAce, "ENABLE";
     |ESTADO_CONTROL nBtnOfeRecha, "DISABLE";
     |ESTADO_CONTROL nBtnOfeToda, "ENABLE";
     aDSituOfe = "R";
     aHSituOfe = "R";
     |HAZ GridOferta;
     aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
     |REFRESCACONTROL nGridOfeC;
|FPRC;

|PROCESO BtnOfeToda;
     aBotonOfe = "4";
     |HAZ BtnOfeDestruye;
     |ESTADO_CONTROL nBtnOfePen, "ENABLE";
     |ESTADO_CONTROL nBtnOfeAce, "ENABLE";
     |ESTADO_CONTROL nBtnOfeRecha, "ENABLE";
     |ESTADO_CONTROL nBtnOfeToda, "DISABLE";
     aDSituOfe = " ";
     aHSituOfe = "z";
     |HAZ GridOferta;
     aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
     |REFRESCACONTROL nGridOfeC;
|FPRC;

|PROCESO BtnOfeSal;
     |PTEC 807;
|FPRC;

|PROCESO EventoFocoOfe;
     aPestana = "1";
     |FOCOTECLADO nGridOfeC;
|FPRC;

|PROCESO EventoOfeL;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#3=;
     |FINSI;
     ||SI FSalida = 4; |HAZ MenuPopup; |FINSI;
|FPRC;

|PROCESO MinOfeL;
     #3#20 = #2#48;
     #3#0 = #2#0;
     #3#1 = 001;
|FPRC;

|PROCESO MaxOfeL;
     #3#20 = #2#48;
     #3#0 = #2#0;
     #3#1 = 999;
     |SI nPrimera = 0; ||Para evitar que al entrar muestre datos
          #3#1 = 0;
     |FINSI;
|FPRC;

|PROCESO EventoOfeC;
     |SI FSalida = 1;  |O FSalida = 2;
          |LEE 000#2=;
          |SI aDSituOfe = " "; |Y aHSituOfe = "z";
               |SI #2#83 = "P"; |HAZ BtnOfePenPin; |FINSI;
               |SI #2#83 = "A"; |HAZ BtnOfeAcePin; |FINSI;
               |SI #2#83 = "R"; |HAZ BtnOfeRechaPin; |FINSI;
          |FINSI;
          aEstado = "ENABLE"; |HAZ BtnOfeHabilita;
          |REFRESCACONTROL nGridOfeL;
     |FINSI;
|FPRC;

|PROCESO MinOfeC;
     #2#83 = aDSituOfe;
     |SI #0#0 = "000000";
          #2#3 = "000000";
     |SINO;
          #2#3 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #2#80 = 1;
     |SINO;
          #2#80 = #0#1;
     |FINSI;
     #2#48 = "     ";
     #2#0 = 000000;
|FPRC;

|PROCESO MaxOfeC;
     #2#83 = aHSituOfe;
     |SI #0#0 = "000000";
          #2#3 = "999999";
     |SINO;
          #2#3 = #0#0;
     |FINSI;
     |SI #0#1 = 0;
          #2#80 = 9999;
     |SINO;
          #2#80 = #0#1;
     |FINSI;
     #2#48 = "zzzzz";
     #2#0 = 999999;
|FPRC;

|PROCESO GridOferta;
     |PINPA #1#0;  nPanOfe = FSalida;

     #2#0 = 0; || para que no salgan las lineas si no hay cabeceras

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2402;
     nPos2 = 3398;
     |SI nGridOfeL ! -1; |DESTRUYECONTROL nGridOfeL; |FINSI;
     |LINEAL_SIMPLE #1#3, nRango, nPos1, nPos2, MinOfeL, MaxOfeL, EventoOfeL;
     nGridOfeL = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 2298;
     |SI nGridOfeC ! -1; |DESTRUYECONTROL nGridOfeC; |FINSI;
     |SI #0#0 = "000000";
          nClaveOfe = 4;
          |LINEAL_SIMPLE #4#2, nRango, nPos1, nPos2, MinOfeC, MaxOfeC, EventoOfeC;
     |SINO;
          |SI #0#1 = 0;
               nClaveOfe = 5;
               |LINEAL_SIMPLE #5#2, nRango, nPos1, nPos2, MinOfeC, MaxOfeC, EventoOfeC;
          |SINO;
               nClaveOfe = 3;
               |LINEAL_SIMPLE #3#2, nRango, nPos1, nPos2, MinOfeC, MaxOfeC, EventoOfeC;
          |FINSI;
     |FINSI;
     nGridOfeC = FSalida;
|FPRC;

|PROCESO PanOfertas;
     |HAZ GridOferta;

     |CONTROL_SIMPLE nPanOfe, "EVENTOPAN", 0000, 0000, EventoFocoOfe;
     nFocoOfe = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,Ptes. Contestar", 0501, 0513, BtnOfePen;
     nBtnOfePen = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,Aceptadas", 0514, 0526, BtnOfeAce;
     nBtnOfeAce = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,Rechazadas", 0527, 0539, BtnOfeRecha;
     nBtnOfeRecha = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,Todas", 0540, 0552, BtnOfeToda;
     nBtnOfeToda = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{205}}Imprimir", 0553, 0563, BtnOfeImp;
     nBtnOfeImp = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,Fax", 0564, 0574, BtnOfeFax;
     nBtnOfeFax = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,Mail", 0575, 0585, BtnOfeMail;
     nBtnOfeMail = FSalida;
     |CONTROL_SIMPLE nPanOfe, "BOTON,{{155}}Ver Oferta", 0586, 0599, BtnOfeVer;
     nBtnOfeVer = FSalida;

     |CONTROL_SIMPLE nPanOfe, "BOTON,{{207}} Salir", 3490, 3498, BtnOfeSal;
     nBtnOfeSal = FSalida;
|FPRC;

|PROCESO EstadoBotonIni;
     |ESTADO_CONTROL nBtnOfePen, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeAce, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeRecha, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeToda, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeImp, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeFax, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeMail, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeVer, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnOfeSal, aEstadoBtnIni;

     |ESTADO_CONTROL nBtnPedPen, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedConf, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedRecha, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedCali, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedApar, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedSin, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedPdt, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedTodo, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedNuevo, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedObs, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedVer, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedWeb, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedImp, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedFax, aEstadoBtnIni;
     |ESTADO_CONTROL nBtnPedMail, aEstadoBtnIni;

     || bloquea/desbloquea todas las pesta¤as
     aAlfa = nPanOfe;
     |MAINCOMMAND 32913, "-1", "-1", aAlfa, "-1", "-1";
     |SI FSalida > 0;
          nPestana = FSalida;
          |ESTADO_CONTROL nPestana, aEstadoBtnIni;
     |FINSI;
|FPRC;

|PROCESO SacaCampos;
     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 0;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     aAlfa = ("000000" + aAlfa) % -106;
     #0#0 = aAlfa; |PINTA #0#0;

     |SI #0#0 = "000000";
          #0#1 = 0; |PINTA #0#1;
     |SINO;
          |REFERENCIA_DEF aGet1, #0;
          aGet2  = 1;    || numero de campo
          IaGet = aGet1<-;
          |ESPECIFICA "GETDATACONTROL", aGet;
          aAlfa = FSalida; |QBT aAlfa;
          aAlfa = ("0000" + aAlfa) % -104;
          #0#1 = aAlfa; |PINTA #0#1;
     |FINSI;
|FPRC;

|PROCESO BtnActualiza;
     |HAZ SacaCampos;

     |SI nPrimera = 0; ||Solo la 1§ vez
          aEstadoBtnIni = "ENABLE"; |HAZ EstadoBotonIni;
          |HAZ EventoFocoOfe;
     |FINSI;
     nPrimera = 1;
     |SI aAuto = "";
          |HAZ BtnOfePen;
          |HAZ BtnPedPdt;
          |HAZ EventoFocoPed;

          |HAZ GridRepara;

          || para que no salgan las lineas si no hay cabeceras
          #4#0 = 0; FSalida = 1; |HAZ EventoPedC;
          #2#0 = 0; FSalida = 1; |HAZ EventoOfeC;

          || para que tome encuenta el cliente
          |REFRESCACONTROL nGridPaq;
          |REFRESCACONTROL nGridFac;
     |FINSI;
|FPRC;

|PROCESO BtnModiCli;
     |HAZ SacaCampos;

     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |SI FSalida = 0;
          |HAZ IniVentanaEspera;
          aAuto = "1";
                  ||Programa + "M" + Cliente
          aProg = "dszx0001"+ "M" + #0#0;
          |PTEC 807;
     |SINO;
          |MENAV "0000No existe cliente...";
     |FINSI;
|FPRC;

|PROCESO BtnNuevoCli;
     |ABRE #24;
     |SI #142#1 = "S";
          |ABRE #27;
          #27#2 = "";
          #27#0 = "clientes";
          |LEE 101#27=;
          |SI FSalida = 0;
               nConta = #27#1;
               #27#1 = #27#1 + 1;
               |GRABA 021#27a;
          |SINO;
               nConta = 0;
               #27#1 = 1;
               |GRABA 021#27n;
          |FINSI;
          |CIERRA #27;
     |SINO;
          #24#0 = #0#0;
          |LEE 000#24u;
          |SI FSalida = 0;
               nConta = #24#0;
          |SINO;
               nConta = 0;
          |FINSI;
     |FINSI;
     nNume = nConta + 1;
     |PARA; |SI; |HACIENDO;
          nConta = nConta + 1;
          #24#0 = ("000000" + nConta) % -106;
          |LEE 000#24=;
          |SI FSalida ! 0; |SAL; |FINSI;
     |SIGUE;
     |CIERRA #24;
     |SI nNume ! nConta; |Y #142#1 = "S";
          |ABRE #27;
          #27#2 = "";
          #27#0 = "clientes";
          |LEE 101#27=;
          |SI FSalida = 0;
               #27#1 = nConta;
               |GRABA 021#27a;
          |FINSI;
          |CIERRA #27;
     |FINSI;

     #0#0 = #24#0; |PINTA #0#0;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                ||Programa + "C" + Cliente
     aProg = "dszx0001"+ "C" + #0#0;
     |PTEC 807;
|FPRC;

|PROCESO BtnNuevoDir;
     |HAZ SacaCampos;
     |SI #0#1 = 0;
          |MENAV "0000La direccion factura no puede ser la '0000'";
          |ACABA;
     |FINSI;
     |ABRE #1003;
     #1003#0 = #0#0;
     #1003#1 = #0#1;
     |LEE 000#1003=;
     |SI FSalida = 0;
          |MENAV "0000La direccion factura ya existe...";
          |ACABA;
     |FINSI;
     |CIERRA #1003;

     |HAZ IniVentanaEspera;
     aAuto = "1";
                ||Programa + "D" + Cli + Dir.Ent
     aProg = "dszx0001"+ "D" + #0#0 + (("0000" + #0#1) % -104);
     |PTEC 807;
|FPRC;

|PROCESO Posiciona;
     aAlfa = aCliente % 106; #0#0 = aAlfa;
     aAlfa = aCliente % 704; #0#1 = aAlfa;
     Campo = 0; |HAZ Tipo0;
     Campo = 1; |HAZ Tipo0;
     aGuardaPestana = aPestana;
     |HAZ BtnActualiza;
     |SI aGuardaPestana = "1"; |FOCOTECLADO nGridOfeC; |FINSI;
     |SI aGuardaPestana = "2"; |FOCOTECLADO nGridPedC; |FINSI;
     |SI aGuardaPestana = "3"; |FOCOTECLADO nGridPaq; |FINSI;
     |SI aGuardaPestana = "4"; |FOCOTECLADO nGridFac; |FINSI;
     |SI aGuardaPestana = "5"; |FOCOTECLADO nGridRepC; |FINSI;
     |SI aBotonOfe = "1"; |HAZ BtnOfePen; |FINSI;
     |SI aBotonOfe = "2"; |HAZ BtnOfeAce; |FINSI;
     |SI aBotonOfe = "3"; |HAZ BtnOfeRecha; |FINSI;
     |SI aBotonOfe = "4"; |HAZ BtnOfeToda; |FINSI;
     aAlfa = aClaveOfe % 106; #2#3 = aAlfa;
     aAlfa = aClaveOfe % 704; #2#80 = aAlfa;
     aAlfa = aClaveOfe % 1101; #2#83 = aAlfa;
     aAlfa = aClaveOfe % 1205; #2#48 = aAlfa;
     aAlfa = aClaveOfe % 1706; #2#0 = aAlfa;
     |LEE 000#2=;
     aEstado = "DISABLE"; |HAZ BtnOfeHabilita;
     |REFRESCACONTROL nGridOfeC;
     #3#20 = #2#48;
     #3#0 = #2#0;
     aAlfa = aClaveOfe % 2403; #3#1 = aAlfa;
     |LEE 000#3=;
     |REFRESCACONTROL nGridOfeL;

     |SI aBotonPed = "1"; |HAZ BtnPedPen; |FINSI;
     |SI aBotonPed = "2"; |HAZ BtnPedConf; |FINSI;
     |SI aBotonPed = "3"; |HAZ BtnPedCali; |FINSI;
     |SI aBotonPed = "4"; |HAZ BtnPedApar; |FINSI;
     |SI aBotonPed = "5"; |HAZ BtnPedSin; |FINSI;
     |SI aBotonPed = "6"; |HAZ BtnPedPdt; |FINSI;
     |SI aBotonPed = "7"; |HAZ BtnPedTodo; |FINSI;
     |SI aBotonPed = "15"; |HAZ BtnPedRecha; |FINSI;
     aAlfa = aClavePed % 106; #4#4 = aAlfa;
     aAlfa = aClavePed % 704; #4#57 = aAlfa;
     aAlfa = aClavePed % 1101; #4#70 = aAlfa;
     aAlfa = aClavePed % 1205; #4#25 = aAlfa;
     aAlfa = aClavePed % 1706; #4#0 = aAlfa;
     |LEE 000#4=;
     aEstado = "DISABLE"; |HAZ BtnPedHabilita;
     |REFRESCACONTROL nGridPedC;
     #5#28 = #4#25;
     #5#0 = #4#0;
     aAlfa = aClavePed % 2403; #3#1 = aAlfa;
     |LEE 000#5=;
     |REFRESCACONTROL nGridPedL;

     aAlfa = aClaveFac % 106; #134#2 = aAlfa;
     aAlfa = aClaveFac % 704; #134#115 = aAlfa;
     aAlfa = aClaveFac % 1105; #134#49 = aAlfa;
     aAlfa = aClaveFac % 1606; #134#0 = aAlfa;
     |LEE 000#134=;
     |REFRESCACONTROL nGridFac;

     aAlfa = aClavePaq % 106; #23#32 = aAlfa;
     aAlfa = aClavePaq % 704; #23#33 = aAlfa;
     aAlfa = aClavePaq % 1105; #23#1 = aAlfa;
     aAlfa = aClavePaq % 1606; #23#2 = aAlfa;
     |LEE 000#23=;
     |REFRESCACONTROL nGridPaq;

     |SI aBotonRep1 = "E"; |HAZ BtnRepEnt; |FINSI;
     |SI aBotonRep1 = "O"; |HAZ BtnRepOfe; |FINSI;
     |SI aBotonRep1 = "R"; |HAZ BtnRepArep; |FINSI;
     |SI aBotonRep1 = "F"; |HAZ BtnRepAfac; |FINSI;
     |SI aBotonRep1 = "C"; |HAZ BtnRepCer; |FINSI;
     |PULSATECLA;
     aAlfa = aClaveRep % 101; #pcegm042@#22 = aAlfa;
     aAlfa = aClaveRep % 206; #pcegm042@#3 = aAlfa;
     aAlfa = aClaveRep % 804; #pcegm042@#5 = aAlfa;
     aAlfa = aClaveRep % 1205; #pcegm042@#0 = aAlfa;
     aAlfa = aClaveRep % 1706; #pcegm042@#1 = aAlfa;
     |LEE 000#pcegm042@.=;
     |REFRESCACONTROL nGridRepC;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |SI Campo = 0;
          |C_M #0#1, 1, "S":
          |DDEFECTO #24;
          |SI #0#0 = "000000";
               #0#2 = "< Todos los clientes >";
               #0#1 = 0; |PINTA #0#1;
               |C_M #0#1, 1, "N";
          |SINO;
               |ABRE #24;
               #24#0 = #0#0;
               |LEE 000#24=;
               |SI FSalida = 0;
                    #0#2 = #24#2;
               |SINO;
                    #0#2 = "< No existe el cliente >";
               |FINSI;
               |CIERRA #24;
          |FINSI;
          |PINTA #0#0;
          |PINTA #0#2;
     |FINSI;
     |SI Campo = 1;
          |DDEFECTO #1003;
          |SI #0#1 = 0;
               #0#3 = "< Todas las direcciones de entrega > ";
          |SINO;
               |ABRE #1003;
               #1003#0 = #0#0;
               #1003#1 = #0#1;
               |LEE 000#1003=;
               |SI FSalida = 0;
                    #0#3 = #1003#2;
               |SINO;
                    #0#3 = "< No existe la direccion de entrega >";
               |FINSI;
               |CIERRA #1003;
          |FINSI;
          |PINTA #0#1;
          |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO LeeTxt;
     |DBASE aFich;
     aFich = aFich + "fich/";
     aFichero = aFich + (Usuario % 810);
     |XABRE "", aFichero, nHandle;

     |XLEE nHandle, 250, eaEmp;
     |XLEE nHandle, 250, aAuto;
     |XLEE nHandle, 250, aProg;
     |XLEE nHandle, 250, aCliente;
     |XLEE nHandle, 250, aPestana;
     |XLEE nHandle, 250, aBotonOfe;
     |XLEE nHandle, 250, aClaveOfe;
     |XLEE nHandle, 250, aBotonPed;
     |XLEE nHandle, 250, aClavePed;
     |XLEE nHandle, 250, aClaveFac;
     |XLEE nHandle, 250, aPosicion;
     |XLEE nHandle, 250, aClavePaq;
     |XLEE nHandle, 250, aBotonRep1;
     |XLEE nHandle, 250, aClaveRep;

     |XCIERRA nHandle;
|FPRC;

|PROCESO GrabaTxt;
     |DBASE aFich;
     aFich = aFich + "fich/";
     aFichero = aFich + (Usuario % 810);
     |XABRE "W", aFichero, nHandle;

     |XGRABA nHandle, eaEmp;
     |XGRABA nHandle, aAuto;
     |XGRABA nHandle, aProg;
     aAlfa = #0#0 + (("0000" + #0#1) % -104);
     |XGRABA nHandle, aAlfa;       || cliente
     |XGRABA nHandle, aPestana;
     |XGRABA nHandle, aBotonOfe;
     aAlfa = #2#3 + (("0000" + #2#80) % -104) + #2#83;
     aAlfa = aAlfa + #2#48 + (("000000" + #2#0) % -106);
     aAlfa = aAlfa + (("000" + #3#1) % -103);
     |XGRABA nHandle, aAlfa;       || clave
     |XGRABA nHandle, aBotonPed;
     aAlfa = #4#4 + (("0000" + #4#57) % -104) + #4#70;
     aAlfa = aAlfa + #4#25 + (("000000" + #4#0) % -106);
     aAlfa = aAlfa + (("000" + #5#1) % -103);
     |XGRABA nHandle, aAlfa;       || clave
     aAlfa = #134#2 + (("0000" + #134#115) % -104);
     aAlfa = aAlfa + #134#49 + (("000000" + #134#0) % -106);
     aAlfa = aAlfa + (("000" + #5#1) % -103);
     |XGRABA nHandle, aAlfa;       || clave
     |XGRABA nHandle, aPosicion;
     aAlfa = #23#32 + (("0000" + #23#33) % -104);
     aAlfa = aAlfa + #23#1 + (("000000" + #23#2) % -106);
     |XGRABA nHandle, aAlfa;
     |XGRABA nHandle, aBotonRep;
     aAlfa = #pcegm042@#22 + #pcegm042@#3 + (("0000" + #pcegm042@#5) % -104);
     aAlfa = aAlfa + #pcegm042@#0 + (("000000" + #pcegm042@#1) % -106);
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;
|FPRC;

|PROCESO Min1003;
     #1003#0 = #0#0;
     #1003#1 = 1;
|FPRC;

|PROCESO Max1003;
     #1003#0 = #0#0;
     #1003#1 = 9999;
|FPRC;

|PROCESO Tipo_66; |TIPO 66;
     |SI #0#0 = "000000";
          |AVISO; |ERROR;
     |SINO;
          |ABRE #1003;
          #1003#0 = #0#0;
          #1003#1 = #0#1;
          |LEE 000#1003];
          |CONSULTA_F_CLAVE #1#1003, Min1003, Max1003;
          |SI FSalida = 0;
               #0#1 = #1003#1; |PINTA #0#1;
               #0#3 = #1003#2; |PINTA #0#3;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #1003;
     |FINSI;
|FPRC;

|PROCESO Tipo_7; |TIPO 7;
     aAlfa = aPosicion % 113;
     |SI aAlfa = "ACEPTA_OFERTA";
          |HAZ BtnOfePenAcep;
     |FINSI;
     |SI aAlfa = "CONFIRMA_PEDI";
          |HAZ BtnPedPenConf;
     |FINSI;
|FPRC;

|PROCESO Confirma; |TIPO 12;
     |SI FSalida ! 7;
          |CONFI "0000N¿Desea continuar?";
          nTecla = FSalida;
     |SINO;
          nTecla = 1;
     |FINSI;
|FPRC;

|PROCESO Tipo_12; |TIPO 12;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     FSalida = 3499;
|FPRC;

|PROGRAMA;
     |CLS;

     |PINPA #0#0;  nPanta0 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,Actualizar", 0802, 0811, BtnActualiza;
     nBtnActualiza = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,Mod.Cliente", 0813, 0822, BtnModiCli;
     nBtnModiCli = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Nuevo", 0623, 0632, BtnNuevoCli;
     nBtnNuevoCli = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Nueva", 0723, 0732, BtnNuevoDir;
     nBtnNuevoDir = FSalida;

     |HAZ LeeTxt;

     |ABRE #1011;
     #1011#0 = Usuario % 810;
     |LEE 000#1011=;
     |SI FSalida = 0;
          nDepar = #1011#3;
     |SINO;
          aAlfa = Usuario % 810;
          aAlfa = "0000Usuario: " + aAlfa + " no creado en 'Relacion de Emails de usuarios'";
          |MENAV aAlfa;
          |PTEC 807;
     |FINSI;
     |CIERRA #1011;

     |HAZ DecimalesBase;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #20; |LEE 000#20p; |CIERRA #20;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;
     |ABRET #2;
     |ABRET #3;
     |ABRET #4;
     |ABRET #5;
     |ABRET #23;
     |ABRET #134;

     |DDEF aPath;
     aAlfa = aPath + "pcegm042"; |CARGA_DEF aAlfa, pcegm042@;
     aAlfa = aPath + "pcegm043"; |CARGA_DEF aAlfa, pcegm043@;
     |ABRET #pcegm042@;
     |ABRET #pcegm043@;

     |HAZ PanOfertas;
     |HAZ PanPedidos;
     |HAZ PanPaquetes;
     |HAZ PanFacturas;
     |HAZ PanRepara;

     |SI aAuto = "1";
          |HAZ Posiciona;
     |SINO;
          aEstadoBtnIni = "DISABLE"; |HAZ EstadoBotonIni;
          |FOCOTECLADO nGridOfeC;
     |FINSI;

     aAuto = ""; || salida normal del programa

     |PINDA #0#0;
     |PARA; |SI; |HACIENDO;
          |ENDATOS #1#0;
          |SI FSalida ! 0; |SAL; |FINSI;
     |SIGUE;

     |PULSATECLA;        || si esto se cuelga
                         || Subtiquet nro. 00379.0004 Cliente: 003308

     |HAZ GrabaTxt;

     |CIERRAT #2;
     |CIERRAT #3;
     |CIERRAT #4;
     |CIERRAT #5;
     |CIERRAT #23;
     |CIERRAT #134;
     |CIERRAT #pcegm042@;
     |CIERRAT #pcegm043@;
/*
     |FIN_CONTROL_WINDOWS nBtnActualiza;
     |FIN_CONTROL_WINDOWS nBtnModiCli;
     |FIN_CONTROL_WINDOWS nBtnNuevoCli;
     |FIN_CONTROL_WINDOWS nBtnNuevoDir;

     |SI nGridOfeC ! -1; |DESTRUYECONTROL nGridOfeC; |FINSI;
     |SI nGridOfeL ! -1; |DESTRUYECONTROL nGridOfeL; |FINSI;
     |DESTRUYECONTROL nGridOfeL;
     |FIN_CONTROL_WINDOWS nFocoOfe;
     |FIN_CONTROL_WINDOWS nBtnOfePen;
     |FIN_CONTROL_WINDOWS nBtnOfeAce;
     |FIN_CONTROL_WINDOWS nBtnOfeRecha;
     |FIN_CONTROL_WINDOWS nBtnOfeToda;
     |FIN_CONTROL_WINDOWS nBtnOfeImp;
     |FIN_CONTROL_WINDOWS nBtnOfeFax;
     |FIN_CONTROL_WINDOWS nBtnOfeMail;
     |FIN_CONTROL_WINDOWS nBtnOfeVer;
     |FIN_CONTROL_WINDOWS nBtnOfeSal;
     |HAZ BtnOfeDestruye;

     |SI nGridPedC ! -1; |DESTRUYECONTROL nGridPedC; |FINSI;
     |SI nGridPedL ! -1; |DESTRUYECONTROL nGridPedL; |FINSI;
     |FIN_CONTROL_WINDOWS nFocoPed;
     |FIN_CONTROL_WINDOWS nBtnPedPen;
     |FIN_CONTROL_WINDOWS nBtnPedConf;
     |FIN_CONTROL_WINDOWS nBtnPedRecha;
     |FIN_CONTROL_WINDOWS nBtnPedCali;
     |FIN_CONTROL_WINDOWS nBtnPedApar;
     |FIN_CONTROL_WINDOWS nBtnPedSin;
     |FIN_CONTROL_WINDOWS nBtnPedPdt;
     |FIN_CONTROL_WINDOWS nBtnPedTodo;
     |FIN_CONTROL_WINDOWS nBtnPedNuevo;
     |FIN_CONTROL_WINDOWS nBtnPedObs;
     |FIN_CONTROL_WINDOWS nBtnPedVer;
     |FIN_CONTROL_WINDOWS nBtnPedWeb;
     |FIN_CONTROL_WINDOWS nBtnPedImp;
     |FIN_CONTROL_WINDOWS nBtnPedFax;
     |FIN_CONTROL_WINDOWS nBtnPedMail;
     |FIN_CONTROL_WINDOWS nBtnPedSal;
     |HAZ BtnPedDestruye;

     |DESTRUYECONTROL nGridFac;
     |FIN_CONTROL_WINDOWS nFocoFac;
     |FIN_CONTROL_WINDOWS nBtnFacSer;
     |FIN_CONTROL_WINDOWS nBtnFacImp;
     |FIN_CONTROL_WINDOWS nBtnFacPaq;
     |FIN_CONTROL_WINDOWS nBtnFacSal;

     |DESTRUYECONTROL nGridPaq;
     |FIN_CONTROL_WINDOWS nFocoPaq;
     |FIN_CONTROL_WINDOWS nBtnPaqVer;
     |FIN_CONTROL_WINDOWS nBtnPaqImp;
     |FIN_CONTROL_WINDOWS nBtnFacSal;

     |SI nGridRepC ! -1; |DESTRUYECONTROL nGridRepC; |FINSI;
     |SI nGridRepL ! -1; |DESTRUYECONTROL nGridRepL; |FINSI;
     |DESTRUYECONTROL nGridRepL;
     |FIN_CONTROL_WINDOWS nFocoRep;
     |FIN_CONTROL_WINDOWS nBtnRepEnt;
     |FIN_CONTROL_WINDOWS nBtnRepOfe;
     |FIN_CONTROL_WINDOWS nBtnRepArep;
     |FIN_CONTROL_WINDOWS nBtnRepAfac;
     |FIN_CONTROL_WINDOWS nBtnRepCer;
     |FIN_CONTROL_WINDOWS nBtnRepTodo;
     |FIN_CONTROL_WINDOWS nBtnRepSal;
     |HAZ BtnRepDestruye;
*/
     |HAZ FinVentanaEspera;

     |PULSATECLA;
     |DESCARGA_DEF #pcegm043@;
     |DESCARGA_DEF #pcegm042@;
|FPRO;
