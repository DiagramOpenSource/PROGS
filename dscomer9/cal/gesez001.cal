|FICHEROS;
     gesez001 #0;
     referen@ #1;   || referencia que carga el gesem001 o el gesem002
     gesem001;
     gesem002;
     gesez002 #200,MANTE;
     agifa017 #17;
     agifa019 #19;
     dsm00043 #43;
     dsm00044 #44;
     dsm00066 #66;
     dsm00070 #70;
     agifa077 #77;
     agifa080 #80;
     agifa553 #553;


     gestr000@;
     gestr001@;
     gestr006@;
     gestr069@;
     gestr071@;
     gestr073@;
     gestr076@;
     gestr135@;
     gestr138@;
     gestr141@;
     gestr162@;
     gestr163@ #163;
     gestr164@ #164;
     gestr165@ #165;
     refere0@;
     refere1@ #101;
     refere2@ #102;
|FIN;

|VARIABLES;
     &Tempo = "";
     &eaSerie = "";
     &enCodigo = 0;
     &enForma = 0;
     aSerNeu = "NEUMA";
     aSerCos = "COSTE";
     aAlfa = "";
     aPath = "";
     aEmp = "";
     nHay = 0;
     aArt = "";
     aDes = "";
     nUni = 0;
     nConta = 0;
     nNume = 0;
     aExiste = "";
     aParam = "";
     fFec = @;
     aPrv = "";
     nDto1 = 0;
     nDto2 = 0;
     nDto3 = 0;
     nImp = 0;
     nNum = 0;
     aCta = "";
     nCamion = 0;
     nGrupo = 0;
     aConce = "";
     i = 0;
     aSerie = "";
     nCodigo = 0;
     aRelle = "";
     aParte = "";
     nPosOrg = 0;
     nLon = 0;
     nPos = 0;
     aLinArt = "";
     nLinKit = 0;
     nImpKit = 0;
     nKms = 0;
|FIN;

|PROCESO MontaCta;
|| sustituye las X por el grupo contable y las Y por el n§ camion
     aRelle = "0" * #gestr001@#2;
     aAlfa = aCta - "X";
     |SI FSalida > 0;
          nPosOrg = (FSalida - 1) / 100;
          |PARA nLon = 0; |SI FSalida > 0; |HACIENDO nLon = nLon + 1;
               aAlfa = aAlfa - "X";
          |SIGUE;
          nPos = -1 * (100 + nLon);
          aParte = (aRelle + nGrupo) % nPos;
          nPos = (nPosOrg + nLon) * 100 + #gestr001@#2;
          nPosOrg = nPosOrg - 1 + 100;
          aCta = (aCta % nPosOrg) + aParte + (aCta % nPos);
     |FINSI;
     aAlfa = aCta - "Y";
     |SI FSalida > 0;
          nPosOrg = (FSalida - 1) / 100;
          |PARA nLon = 0; |SI FSalida > 0; |HACIENDO nLon = nLon + 1;
               aAlfa = aAlfa - "Y";
          |SIGUE;
          nPos = -1 * (100 + nLon);
          aParte = (aRelle + nCamion) % nPos;
          nPos = (nPosOrg + nLon) * 100 + #gestr001@#2;
          nPosOrg = nPosOrg - 1 + 100;
          aCta = (aCta % nPosOrg) + aParte + (aCta % nPos);
     |FINSI;
     nPos = #gestr001@#2 + 100;
     aCta = (aCta + aRelle) % nPos;

     #gestr135@#0 = aConce;
     #gestr135@#1 = nCamion;
     |LEE 000#gestr135@.=;
     |SI FSalida = 0;
          aCta = #gestr135@#2;
     |FINSI;
|FPRC;

|PROCESO LinReguNeu;
     |ABRE #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = 99999;
     |LEE 000#44];
     |SI FSalida = 0;
          |LEE 000#44a;
     |SINO;
          |LEE 000#44u;
     |FINSI;
     |SI FSalida = 0; |Y #44#21 = #43#4;
               |Y #44#18 = #43#0;
          nConta = #44#8 + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nConta;

     |ABRE #19;
     |DDEFECTO #19;
     #19#0 = #gestr164@#11;
     |LEE 000#19=;
     |CIERRA #19;

     |ABRE #17;
     |DDEFECTO #17;
     #17#0 = #gestr164@#11;
     #17#1 = #gestr006@#8;
     |LEE 000#17=;
     |CIERRA #17;

     #44#0 = #17#0;
     #44#1 = #17#1;
     #44#2 = #19#1;
     #44#4 = 1;
     #44#5 = #gestr164@#5;
     #44#7 = "S";

     #44#3 = #17#39;
     #44#6 = #19#6;
     #44#19 = #17#5;
     #44#20 = #19#104;
     #44#22 = #19#185;
     #44#23 = #17#47;
     #44#24 = #19#193;
     #44#25 = #17#48;
     #44#26 = #19#133;

     enCodigo = #44#18;
     |HAZ AcumulaES_SS;

     |GRABA 020#44n;
     |CIERRA #44;
|FPRC;

|PROCESO CabReguNeu;
     |ABRE #43;
     |SI #gestr164@#23 = 0;
          #43#4 = aSerNeu;
          #43#0 = 999999;
          |LEE 000#43];
          |SI FSalida = 0;
               |LEE 000#43a;
          |SINO;
               |LEE 000#43u;
          |FINSI;
          |SI FSalida = 0; |Y #43#4 = aSerNeu;
               nConta = #43#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
     |SINO;
          nConta = #gestr164@#23;
     |FINSI;
     |DDEFECTO #43;
     #43#4 = aSerNeu;
     #43#0 = nConta;
     #43#1 = #gestr164@#5;
     |GRABA 020#43n;
     |CIERRA #43;
|FPRC;

|PROCESO ActLinNeumatico;
     |ABRE #refere1@;         || referencia del gestr164
     |ABRE #refere2@;         || referencia del gestr163

     |DDEFECTO #gestr162@;
     #gestr162@#0 = #gestr164@#6;
     |LEE 000#gestr162@.=;

     #gestr006@#0 = #gestr164@#0;
     |LEE 020#gestr006@.=;

     |DDEFECTO #gestr073@;
     #gestr073@#0 = #gestr164@#11;
     |LEE 000#gestr073@.=;

     |SI enForma = 1;
          |SI #gestr164@#10 = "S";
               #refere1@#0 = #gestr164@#18;
               #refere1@#2 = #gestr164@#20;
               #refere1@#3 = #gestr164@#21;
               #refere1@#4 = 999;
               |LEE 000#refere1@.];
               |SI FSalida = 0;
                    |LEE 000#refere1@.a;
               |SINO;
                    |LEE 000#refere1@.u;
               |FINSI;
               |SI FSalida = 0; |Y #refere1@#0 = #gestr164@#18;
                         |Y #refere1@#2 = #gestr164@#20;
                         |Y #refere1@#3 = #gestr164@#21;
                    nNum = #refere1@#4 + 1;
               |SINO;
                    nNum = 1;
               |FINSI;
               |SALVA_DATOS #gestr164@;
               |REPON_DATOS #refere1@;

               #refere1@#0 = #gestr164@#18;
               #refere1@#1 = #gestr164@#19;
               #refere1@#2 = #gestr164@#20;
               #refere1@#3 = #gestr164@#21;
               #refere1@#4 = nNum;

               #refere1@#18 = #gestr164@#0;
               #refere1@#19 = #gestr164@#1;
               #refere1@#20 = #gestr164@#2;
               #refere1@#21 = #gestr164@#3;
               #refere1@#18 = #gestr164@#0;
               #refere1@#24 = #gestr164@#4;
               |GRABA 020#refere1@.n;

               #refere2@#0 = #refere1@#0;
               #refere2@#2 = #refere1@#2;
               #refere2@#3 = #refere1@#3;
               |LEE 121#refere2@.=;
               |SI FSalida = 0;
                    |SALVA_DATOS #refere2@;
                    #refere2@#4 = #gestr163@#4;    || Cod Neuma
                    #refere2@#5 = #gestr163@#5;    || Marca
                    #refere2@#6 = #gestr163@#6;    || Medida
                    #refere2@#7 = #gestr163@#7;    || Dibujo
                    #refere2@#8 = #gestr164@#16;   || Kms ult mov
                    #refere2@#9 = #gestr164@#15;   || Vida estimada
                    #refere2@#10 = #gestr164@#5;   || F. ult. mov
                    #refere2@#11 = #gestr164@#8;   || Estado actual
                    |GRABA 020#refere2@.a;
                    |REPON_DATOS #refere2@;

                    #gestr163@#4 = #refere2@#4;
                    #gestr163@#5 = #refere2@#5;
                    #gestr163@#6 = #refere2@#6;
                    #gestr163@#7 = #refere2@#7;
                    #gestr163@#8 = #refere2@#8;
                    #gestr163@#9 = #refere2@#9;
                    #gestr163@#10 = #refere2@#10;
                    #gestr163@#11 = #refere2@#11;
               |FINSI;
               #gestr164@#24 = nNum;
          |FINSI;
          |SI #gestr164@#17 ! 0;
               aCta = #gestr073@#4; |QBF aCta;
               nCamion = #gestr006@#0;
               nGrupo = #gestr006@#11;
               aConce = #gestr164@#4;
               |HAZ MontaCta;

               |DDEFECTO #gestr076@;
               #gestr076@#0 = #gestr164@#0;
               #gestr076@#1 = "NEUMA";
               #gestr076@#2 = #gestr164@#2 * 10 + #gestr164@#3;
               #gestr076@#3 = #gestr164@#4;
               |LEE 101#gestr076@.=;
               |SI FSalida ! 0; |GRABA 020#gestr076@.b; |FINSI;
               #gestr076@#4 = #gestr164@#11;
               #gestr076@#5 = #gestr073@#1;
               #gestr076@#6 = aCta;
               #gestr076@#7 = #gestr164@#5;
               #gestr076@#8 = #gestr164@#17;
               #gestr076@#9 = #gestr164@#17;
               #gestr076@#12 = 1;
               #gestr076@#13 = "N"
               #gestr076@#20 = #gestr006@#8;
               |GRABA 020#gestr076@.a;
               |LIBERA #gestr076@;
          |FINSI;
          |SI #gestr162@#2 = "S";
               #gestr138@#0 = #gestr164@#11;
               #gestr138@#1 = #gestr006@#8;
               |LEE 101#gestr138@.=;
               |SI FSalida = 0;
                    #gestr138@#2 = #gestr138@#2 - 1;
                    |GRABA 020#gestr138@.a;
               |FINSI;

               #gestr073@#0 = #gestr164@#11;
               |LEE 101#gestr073@.=;
               |SI FSalida = 0;
                    #gestr073@#9 = #gestr073@#9 - 1;
                    |GRABA 020#gestr073@.a;
               |FINSI;

               |LEE 000#gestr141@.u;
               |SI FSalida = 0;
                    #gestr164@#22 = #gestr141@#0 + 1;
               |SINO;
                    #gestr164@#22 = 1;
               |FINSI;
               |DDEFECTO #gestr141@;
               #gestr141@#0 = #gestr164@#22;
               #gestr141@#1 = #gestr006@#8;
               #gestr141@#2 = #gestr164@#11;
               #gestr141@#3 = #gestr164@#7;
               #gestr141@#4 = #gestr164@#5;
               #gestr141@#5 = 1;
               #gestr141@#6 = #gestr073@#8;
               #gestr141@#8 = #gestr073@#10;
               |GRABA 020#gestr141@.n;
          |FINSI;
          |SI #gestr001@#69 = "S"; |Y #gestr162@#2 = "S";
               |HAZ CabReguNeu;
               |HAZ LinReguNeu;
               #gestr164@#23 = #43#0;
          |FINSI;
     |SINO;
          |SI #gestr164@#9 = "N"; |Y #gestr164@#10 = "N";
          |FINSI;
          |SI #gestr164@#9 = "S";
          |FINSI;
          nCamion = 0;
          |SI #gestr164@#10 = "S";
               |DDEFECTO #refere1@;
               #refere1@#0 = #gestr164@#18;
               #refere1@#1 = #gestr164@#19;
               #refere1@#2 = #gestr164@#20;
               #refere1@#3 = #gestr164@#21;
               #refere1@#4 = #gestr164@#24;
               |LEE 121#refere1@.=;
               |SI FSalida = 0;
                    nCamion = #refere1@#0;
                    |BORRA 020#refere1@.a;
                    |SI #refere1@#22 ! 0;
                         #gestr006@#0 = #refere1@#0;
                         |LEE 020#gestr006@.=;

                         #gestr138@#0 = #refere1@#11;
                         #gestr138@#1 = #gestr006@#8;
                         |LEE 101#gestr138@.=;
                         |SI FSalida = 0;
                              #gestr138@#2 = #gestr138@#2 + 1;
                              |GRABA 020#gestr138@.a;
                         |FINSI;

                         #gestr073@#0 = #refere1@#11;
                         |LEE 101#gestr073@.=;
                         |SI FSalida = 0;
                              #gestr073@#9 = #gestr073@#9 + 1;
                              |GRABA 020#gestr073@.a;
                         |FINSI;

                         #gestr141@#0 = #refere1@#22;
                         |BORRA 020#gestr141@.c;
                    |FINSI;
                    |SI #refere1@#17 ! 0;
                         #gestr076@#0 = #refere1@#0;
                         #gestr076@#1 = "NEUMA";
                         #gestr076@#2 = #refere1@#2 * 10 + #refere1@#3;
                         #gestr076@#3 = #refere1@#4;
                         |BORRA 020#gestr076@.c;
                    |FINSI;
                    |SI #gestr001@#69 = "S"; |Y #refere1@#23 ! 0; |Y #gestr162@#2 = "S";
                         nCodigo = #refere1@#23;
                         aSerie = aSerNeu;
                         |HAZ BajaRegu;
                    |FINSI;
               |FINSI;
          |FINSI;
          |SI #gestr164@#17 ! 0; |Y nCamion = 0;
               #gestr076@#0 = #gestr164@#0;
               #gestr076@#1 = "NEUMA";
               #gestr076@#2 = #gestr164@#2 * 10 + #gestr164@#3;
               #gestr076@#3 = #gestr164@#4;
               |BORRA 020#gestr076@.c;
          |FINSI;

          #gestr006@#0 = #gestr164@#0;
          |LEE 000#gestr006@.=;

          |SI #gestr162@#2 = "S"; |Y  #gestr164@#22 ! 0;
               #gestr138@#0 = #gestr164@#11;
               #gestr138@#1 = #gestr006@#8;
               |LEE 101#gestr138@.=;
               |SI FSalida = 0;
                    #gestr138@#2 = #gestr138@#2 + 1;
                    |GRABA 020#gestr138@.a;
               |FINSI;

               #gestr073@#0 = #gestr164@#11;
               |LEE 101#gestr073@.=;
               |SI FSalida = 0;
                    #gestr073@#9 = #gestr073@#9 + 1;
                    |GRABA 020#gestr073@.a;
               |FINSI;

               #gestr141@#0 = #gestr164@#22;
               |BORRA 020#gestr141@.c;
          |FINSI;
          |SI #gestr001@#69 = "S"; |Y #gestr164@#23 ! 0; |Y #gestr162@#2 = "S";
               nCodigo = #gestr164@#23;
               aSerie = aSerNeu;
               |HAZ BajaRegu;
          |FINSI;
     |FINSI;

     |CIERRA #refere2@;
     |CIERRA #refere1@;
|FPRC;

|PROCESO ExisteMovi;
     #gestr163@#0 = #200#18;
     #gestr163@#2 = #200#20;
     #gestr163@#3 = #200#21;
     |LEE 000#gestr163@.=;
     |SI FSalida = 0;
          aExiste = "S";
     |SINO;
          |MENAV "0000No existe movimiento de cambio neum tico del nuevo cami¢n...";
          aExiste = "N";
     |FINSI;
|FPRC;

|PROCESO NuePosiEje; |TIPO 0;
     |SI FSalida = 2; |O #200#10 = "N"; |ACABA; |FINSI;
     |HAZ ExisteMovi;
     |SI aExiste = "N"; |ERROR; |ACABA; |FINSI;
|FPRC;

|PROCESO NueMatri66; |TIPO 66;
     |C_M #200#18, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SELECT #2#gestr006@;
     #gestr006@#16 = #200#19;
     |LEE 000#gestr006@.];
     |CONSULTA_CLAVE #2#gestr006@;
     |SI FSalida = 0;
          #200#18 = #gestr006@#0; |PINTA #200#18;
     |SINO;
          |ERROR;
     |FINSI;
     |SELECT #1#gestr006@;
|FPRC;

|PROCESO NueMatri0; |TIPO 0;
     |SELECT #2#gestr006@;
     #gestr006@#16 = #200#19;
     |LEE 000#gestr006@.=;
     |SI FSalida = 0;
          #200#19 = #gestr006@#16; |PINTA #200#19;
     |SINO;
          |MENAV "0000No existe matricula...";
          |ERROR;
     |FINSI;
     |SELECT #1#gestr006@;
|FPRC;

|PROCESO NuevoCami66; |TIPO 66;
     #gestr006@#0 = #200#18;
     |LEE 000#gestr006@.];
     |CONSULTA_CLAVE #1#gestr006@;
     |SI FSalida = 0;
          |C_M #200#19, 1, "N";
          #200#19 = #gestr006@#16; |PINTA #200#19;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO NuevoCami0; |TIPO 0;
     |C_M #200#18, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     ||SI nModoLin = 1;
          |SI #200#18 = 0;
               |C_M #200#19, 1, "S"; |PINTA #200#19;
          |SINO;
               #gestr006@#0 = #200#18;
               |LEE 000#gestr006@.=;
               |SI FSalida = 0;
                    |C_M #200#19, 1, "N";
                    #200#19 = #gestr006@#16; |PINTA #200#19;
               |SINO;
                    |ERROR;
               |FINSI;
          |FINSI;
     ||FINSI;
|FPRC;

|PROCESO Neuma0; |TIPO 0;
     |C_M #200#11, 0, aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     #gestr073@#0 = #200#11;
     |LEE 000#gestr073@.=;
     |SI FSalida = 0;
          |SI #gestr073@#12 ! "S";
               |MENAV "0000El c¢digo no es un neum tico...";
               |ERROR;
          |SINO;
               |SI Contenido ! #200#11;
                    #200#12 = #gestr073@#14; |PINTA #200#12;
                    #200#13 = #gestr073@#15; |PINTA #200#13;
                    #200#14 = #gestr073@#16; |PINTA #200#14;
                    #200#15 = #gestr073@#13; |PINTA #200#15;
                    #200#17 = #gestr073@#8; |PINTA #200#17;
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "0000No existe c¢digo neum tico...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO LlenaNeuma;
     |SI #gestr073@#12 = "S";
          |SALVA_DATOS #gestr073@;
          |REPON_DATOS #refere0@;
          |GRABA 020#refere0@.n;
     |FINSI;
|FPRC;

|DEFBUCLE LlenaNeuma;
     #gestr073@#1001;
     ;
     "                    ";
     "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, LlenaNeuma;
|FIN;

|PROCESO Neuma66; |TIPO 66;
     |HAZ CreaTempo; |NOME_DAT #refere0@#Tempo#;
     |DELINDEX #refere0@; |ABRE #refere0@;
     |BUCLE LlenaNeuma;
     |LEE 000#refere0@.p;
     |SI FSalida = 0;
          #refere0@#0 = #200#11;
          |CONSULTA_CLAVE #1#refere0@;
          |SI FSalida = 0;
               #200#11 = #refere0@#0; |PINTA #200#11;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          |MENAV "0000No existen c¢digos de neum ticos...";
          |ERROR;
     |FINSI;
     |CIERRA #refere0@; |DELINDEX #refere0@; |HAZ BoraTempo;
|FPRC;

|PROCESO Opera66; |TIPO 66;
     #gestr162@#0 = #200#6;
     |LEE 000#gestr162@.];
     |CONSULTA_CLAVE #1#gestr162@;
     |SI FSalida = 0;
          #200#6 = #gestr162@#0; |PINTA #200#6;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Opera0; |TIPO 0;
     #gestr162@#0 = #200#6;
     |LEE 000#gestr162@.=;
     |SI FSalida = 0;
          #200#7 = #gestr162@#1; |PINTA #200#7;
          #200#8 = #gestr162@#3; |PINTA #200#8;
          #200#9 = #gestr162@#5; |PINTA #200#9;
          #200#10 = #gestr162@#6; |PINTA #200#10;
          |SI #200#9 = "S";
               |C_M #200#8, 1, "S"; |PINTA #200#8;
               |C_M #200#11, 1, "S"; |PINTA #200#11;
               |C_M #200#12, 1, "S"; |PINTA #200#12;
               |C_M #200#13, 1, "S"; |PINTA #200#13;
               |C_M #200#14, 1, "S"; |PINTA #200#14;
               |C_M #200#16, 1, "S"; |PINTA #200#16;
               |C_M #200#18, 1, "N"; |PINTA #200#18;
               |C_M #200#19, 1, "N"; |PINTA #200#19;
               |C_M #200#20, 1, "N"; |PINTA #200#20;
               |C_M #200#21, 1, "N"; |PINTA #200#21;
          |SINO;
               |SI #200#10 = "S";
                    |C_M #200#8, 1, "S"; |PINTA #200#8;
                    |C_M #200#11, 1, "N"; |PINTA #200#11;
                    |C_M #200#12, 1, "N"; |PINTA #200#12;
                    |C_M #200#13, 1, "N"; |PINTA #200#13;
                    |C_M #200#14, 1, "N"; |PINTA #200#14;
                    |C_M #200#16, 1, "S"; |PINTA #200#16;
                    |C_M #200#18, 1, "S"; |PINTA #200#18;
                    |C_M #200#19, 1, "S"; |PINTA #200#19;
                    |C_M #200#20, 1, "S"; |PINTA #200#20;
                    |C_M #200#21, 1, "S"; |PINTA #200#21;
                    |SI #200Campo ! Contenido;
                         |SI #200#4 = 1;
                              |MENAV "0000El primer movimiento no puede ser cambio de posici¢n...";
                              |ERROR; |ACABA;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |SI #200#9 = "S"; |Y #200#10 = "S";
                         |MENAV "0000Operaci¢n incorrecta, no puede ser de cambio neum tico y posici¢n...";
                         |ERROR;
                    |SINO;
                         |C_M #200#8, 1, "N"; |PINTA #200#8;
                         |C_M #200#11, 1, "N"; |PINTA #200#11;
                         |C_M #200#12, 1, "N"; |PINTA #200#12;
                         |C_M #200#13, 1, "N"; |PINTA #200#13;
                         |C_M #200#14, 1, "N"; |PINTA #200#14;
                         |C_M #200#16, 1, "N"; |PINTA #200#16;
                         |C_M #200#18, 1, "N"; |PINTA #200#18;
                         |C_M #200#19, 1, "N"; |PINTA #200#19;
                         |C_M #200#20, 1, "N"; |PINTA #200#20;
                         |C_M #200#21, 1, "N"; |PINTA #200#21;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "0000No existe c¢digo de operaci¢n...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO CheqCod; |TIPO 0;
     #gestr163@#0 = #200#0;
     #gestr163@#2 = #200#2;
     #gestr163@#3 = #200#3;
     |LEE 000#gestr163@.=;
     |SI FSalida ! 0;
          |MENAV "0000No existe movimiento de neumatico por vehiculo...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min163;
     #gestr163@#0 = #200#0;
     |SI Campo = 2;
          #gestr163@#2 = 1;
          #gestr163@#3 = 1;
     |SINO;
          #gestr163@#2 = #200#2;
          #gestr163@#3 = 1;
     |FINSI;
|FPRC;

|PROCESO Max163;
     #gestr163@#0 = #200#0;
     |SI Campo = 2;
          #gestr163@#2 = 9;
          #gestr163@#3 = 9;
     |SINO;
          #gestr163@#2 = #200#2;
          #gestr163@#3 = 9;
     |FINSI;
|FPRC;

|PROCESO BusCod; |TIPO 66;
     #gestr163@#0 = #200#0;
     #gestr163@#2 = #200#2;
     #gestr163@#3 = #200#3;
     |LEE 000#gestr163@.];
     |CONSULTA_F_CLAVE #1#gestr163@, Min163, Max163;
     |SI FSalida = 0;
          #200#2 = #gestr163@#2; |PINTA #200#2;
          #200#3 = #gestr163@#3; |PINTA #200#3;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Neumatico;
     #553#0 = aLinArt;
     |LEE 000#553=;
     |SI FSalida ! 0; |DDEFECTO #553; |FINSI;

     |SI #553#2 ! "S"; |ACABA; |FINSI;

     |SI aParam = "ALB";
          #1#0 = #80#27;
          #1#1 = #80#0;
          #1#2 = #80#1;
          #1#7 = nLinKit;
          |LEE 121#1=;
     |SINO;
          #1#0 = #44#21;
          #1#1 = #44#18;
          #1#2 = #44#8;
          #1#7 = nLinKit;
          |LEE 121#1=;
     |FINSI;

     |SI enForma ! 1;
          #gestr163@#0 = #1#3;
          #gestr163@#2 = #1#8;
          #gestr163@#3 = #1#9;
          |LEE 121#gestr163@.=;

          #gestr164@#0 = #1#3;
          #gestr164@#2 = #1#8;
          #gestr164@#3 = #1#9;
          #gestr164@#4 = #1#10;
          |LEE 121#gestr164@.=;

          |HAZ ActLinNeumatico;
     |SINO;
          |DDEFECTO #200;
          #200#25 = aArt;
          #200#26 = aDes;
          #200#0 = #1#3;
          #200#1 = #1#4;

          #gestr006@#0 = #200#0;
          |LEE 020#gestr006@.=;

          |DDEFECTO #gestr073@;
          #gestr073@#0 = aArt;
          |LEE 000#gestr073@.=;

          #200#12 = #gestr073@#14;
          #200#13 = #gestr073@#15;
          #200#14 = #gestr073@#16;

          #200#16 = #gestr006@#6;
          #200#18 = #200#0;
          #200#19 = #200#1;
          #200#20 = #200#2;
          #200#21 = #200#3;

          #200#11 = aArt;

          |PINPA #0#200;
          |PINDA #0#200;
          |PARA; |SI; |HACIENDO;
               |ENDATOS #1#200;
               |SI FSalida = 0; |SAL; |FINSI;
          |SIGUE;

          #gestr163@#0 = #200#0;
          #gestr163@#2 = #200#2;
          #gestr163@#3 = #200#3;
          |LEE 121#gestr163@.=;

          #gestr164@#0 = #200#0;
          #gestr164@#2 = #200#2;
          #gestr164@#3 = #200#3;
          #gestr164@#4 = 999;
          |LEE 000#gestr164@.];
          |SI FSalida = 0;
               |LEE 000#gestr164@.a;
          |SINO;
               |LEE 000#gestr164@.u;
          |FINSI;
          |SI FSalida = 0; |Y #gestr164@#0 = #200#0; |Y #gestr164@#2 = #200#2;
                    |Y #gestr164@#3 = #200#3;
               #200#4 = #gestr164@#4 + 1;

               |SI #200#9 = "S";
                    nKms = #200#16 - #gestr164@#16;
                    |LEE 121#gestr164@.=;
                    #gestr164@#16 = nKms;
                    |GRABA 020#gestr164@.a;
                    |LIBERA #gestr164@;
               |FINSI;
          |SINO;
               #200#4 = 1;
               nKms = #200#16;
          |FINSI;

          |PARA i = 0; |SI i [ 24; |HACIENDO i = i + 1;
               #gestr164@#i# = #200i;
          |SIGUE;
          |SI #200#9 = "S";
               #gestr164@#16 = nKms;
          |FINSI;
          |GRABA 020#gestr164@.n;

          #1#8 = #gestr164@#2;
          #1#9 = #gestr164@#3;
          #1#10 = #gestr164@#4;
          |GRABA 020#1a;
          |LIBERA #1;

          |HAZ ActLinNeumatico;

          |GRABA 020#gestr163@.a;
     |FINSI;
|FPRC;

|PROCESO FecRev;
     |SI #gestr069@#2 = "M";
          nNume = #gestr069@#4 / 1000;
          #0#5 = #0#4 + nNume;
          #0#7 = 0;
     |SINO;
          #0#5 = "01.01.0000";
          #0#7 = #0#6 + #gestr069@#4;
     |FINSI;
     |PINTA #0#5;
     |PINTA #0#7;
|FPRC;

|PROCESO PideRev;
     |SI enForma ! 1; |ACABA; |FINSI;

     |DDEFECTO #0;
     #0#0 = aArt;
     #0#1 = aDes;
     #0#2 = #1#3;
     #0#3 = #1#4;
     #0#4 = fFec;
     #0#6 = #gestr006@#6;
     |HAZ FecRev;
     |PINPA #0#0;
     |PINDA #0#0;
     |PARA; |SI; |HACIENDO;
          |ENDATOS #1#0;
          |SI FSalida = 0; |SAL; |FINSI;
     |SIGUE;
     |DDEFECTO #gestr071@;
     #gestr071@#0 = #1#3;
     #gestr071@#1 = #gestr069@#0;
     #gestr071@#15 = #gestr069@#6;
     |LEE 101#gestr071@.=;
     |SI FSalida ! 0; |GRABA 020#gestr071@.b; |FINSI;
     #gestr071@#2 = #gestr069@#1;
     #gestr071@#3 = #gestr069@#2;
     #gestr071@#4 = #0#5;
     #gestr071@#5 = #0#7;
     #gestr071@#6 = #gestr069@#3
     #gestr071@#7 = #0#4;
     #gestr071@#8 = #0#6;
     #gestr071@#9 = aPrv;
     #gestr071@#10 = #0#8;
     #gestr071@#11 = "01.01.0000";
     #gestr071@#12 = 0;
     |SI #gestr071@#3 = "M";
          nNume = #gestr071@#4;
          nNume = nNume - #gestr071@#6;
          #gestr071@#11 = nNume;
     |FINSI;
     |SI #gestr071@#3 = "K";
          #gestr071@#12 = #gestr071@#5 - #gestr071@#6;
     |FINSI;
     #gestr071@#13 = #gestr069@#8;
     #gestr071@#14 = #1#4;
     |GRABA 020#gestr071@.a;
     |LIBERA #gestr071@;
|FPRC;

|PROCESO BajaRegu;
     |ABRE #43;
     |ABRE #44;
     #44#21 = aSerie;
     #44#18 = nCodigo;
     #44#8 = 1;
     |LEE 101#44=;
     |SI FSalida = 0;
          enCodigo = #44#18;
          |HAZ AcumulaES_SS;

          |BORRA 020#44a;
     |FINSI;
     #44#8 = 0;
     |LEE 101#44];
     |SI FSalida ! 0; |O #44#21 ! aSerie; |O #44#18 ! nCodigo;
          #43#4 = aSerie;
          #43#0 = nCodigo;
          |BORRA 000#43c;
     |FINSI;
     |CIERRA #43;
     |CIERRA #44;
|FPRC;

|PROCESO LinReguCos;
     |ABRE #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = 99999;
     |LEE 000#44];
     |SI FSalida = 0;
          |LEE 000#44a;
     |SINO;
          |LEE 000#44u;
     |FINSI;
     |SI FSalida = 0; |Y #44#21 = #43#4;
               |Y #44#18 = #43#0;
          nConta = #44#8 + 1;
     |SINO;
          nConta = 1;
     |FINSI;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nConta;

     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = #gestr165@#4;
     |LEE 000#19=;
     |CIERRA #19;

     |DDEFECTO #17;
     |ABRE #17;
     #17#0 = #gestr165@#4;
     #17#1 = #gestr006@#8;
     |LEE 000#17=;
     |CIERRA #17;

     #44#0 = #17#0;
     #44#1 = #17#1;
     #44#2 = #19#1;
     #44#4 = #gestr165@#8;
     #44#5 = #gestr165@#3;
     #44#7 = "S";

     #44#3 = #17#39;
     #44#6 = #19#6;
     #44#19 = #17#5;
     #44#20 = #19#104;
     #44#22 = #19#185;
     #44#23 = #17#47;
     #44#24 = #19#193;
     #44#25 = #17#48;
     #44#26 = #19#133;

     enCodigo = #44#18;
     |HAZ AcumulaES_SS;

     #44#3 = #19#39;            || Disponible que queda
     #44#19 = #19#5;

     |GRABA 020#44n;
     |CIERRA #44;
|FPRC;

|PROCESO CabReguCos;
     |ABRE #43;
     |SI #gestr165@#10 = 0;
          #43#4 = aSerCos;
          #43#0 = 999999;
          |LEE 000#43];
          |SI FSalida = 0;
               |LEE 000#43a;
          |SINO;
               |LEE 000#43u;
          |FINSI;
          |SI FSalida = 0; |Y #43#4 = aSerCos;
               nConta = #43#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
     |SINO;
          nConta = #gestr165@#10;
     |FINSI;
     |DDEFECTO #43;
     #43#4 = aSerCos;
     #43#0 = nConta;
     #43#1 = #gestr165@#3;
     |GRABA 020#43n;
     |CIERRA #43;
|FPRC;

|PROCESO ActualizaCos;
     |DDEFECTO #gestr073@;
     #gestr073@#0 = #gestr165@#4;
     |LEE 000#gestr073@.=;
     |SI enForma = 1;
          |SI #gestr073@#11 = "S";
               #gestr138@#0 = #gestr165@#4;
               #gestr138@#1 = #gestr006@#8;
               |LEE 101#gestr138@.=;
               |SI FSalida = 0;
                    #gestr138@#2 = #gestr138@#2 - #gestr165@#8;
                    |GRABA 020#gestr138@.a;
               |FINSI;

               |LEE 101#gestr073@.=;
               |SI FSalida = 0;
                    #gestr073@#9 = #gestr073@#9 - #gestr165@#8;
                    |GRABA 020#gestr073@.a;
               |FINSI;

               |LEE 000#gestr141@.u;
               |SI FSalida = 0;
                    #gestr165@#9 = #gestr141@#0 + 1;
               |SINO;
                    #gestr165@#9 = 1;
               |FINSI;
               |DDEFECTO #gestr141@;
               #gestr141@#0 = #gestr165@#9;
               #gestr141@#1 = #gestr006@#8;
               #gestr141@#2 = #gestr165@#4;
               #gestr141@#3 = 5;
               #gestr141@#4 = #gestr165@#3;
               #gestr141@#5 = #gestr165@#8;
               #gestr141@#6 = #gestr165@#7;
               #gestr141@#8 = #gestr073@#10;
               |GRABA 020#gestr141@.n;

               |SI #gestr001@#69 = "S"; |Y aParam = "ALB";
                    |HAZ CabReguCos;
                    |HAZ LinReguCos;
                    #gestr165@#10 = #43#0;
               |FINSI;
          |FINSI;
          |SI #gestr165@#7 ! 0;
               #gestr076@#0 = #gestr165@#1;
               #gestr076@#1 = "COSTE";
               #gestr076@#2 = #gestr165@#0;
               #gestr076@#3 = 1
               #gestr076@#4 = #gestr165@#4;
               #gestr076@#5 = #gestr165@#5;
               #gestr076@#6 = #gestr165@#6;
               #gestr076@#7 = #gestr165@#3;
               #gestr076@#8 = #gestr165@#7 * #gestr165@#8;
               #gestr076@#9 = #gestr165@#7 * #gestr165@#8;
               #gestr076@#12 = #gestr165@#8;
               #gestr076@#13 = "N";
               #gestr076@#17 = #gestr165@#11;
               #gestr076@#20 = #gestr006@#8;
               |GRABA 020#gestr076@.n;
          |FINSI;
     |SINO;
          |SI #gestr073@#11 = "S";
               #gestr138@#0 = #gestr165@#4;
               #gestr138@#1 = #gestr006@#8;
               |LEE 101#gestr138@.=;
               |SI FSalida = 0;
                    #gestr138@#2 = #gestr138@#2 + #gestr165@#8;
                    |GRABA 020#gestr138@.a;
               |FINSI;

               |LEE 101#gestr073@.=;
               |SI FSalida = 0;
                    #gestr073@#9 = #gestr073@#9 + #gestr165@#8;
                    |GRABA 020#gestr073@.a;
               |FINSI;

               #gestr141@#0 = #gestr165@#9;
               |BORRA 020#gestr141@.c;

               |SI #gestr001@#69 = "S"; |Y aParam = "ALB";
                    aSerie = aSerCos;
                    nCodigo = #gestr165@#10;
                    |HAZ BajaRegu;
               |FINSI;
          |FINSI;

          |SI #gestr165@#7 ! 0;
               #gestr076@#0 = #gestr165@#1;
               #gestr076@#1 = "COSTE";
               #gestr076@#2 = #gestr165@#0;
               #gestr076@#3 = 1
               |BORRA 020#gestr076@.c;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Imputa;
     |DDEFECTO #553;

     #gestr006@#0 = #1#3;
     |LEE 000#gestr006@.=;
     |SI FSalida ! 0; |DDEFECTO #gestr006@; |FINSI;

     |SI enForma ! 1;
          |SI aParam = "ALB";
               #1#0 = #80#27;
               #1#1 = #80#0;
               #1#2 = #80#1;
               #1#7 = nLinKit;
               |LEE 121#1=;
          |SINO;
               #1#0 = #44#21;
               #1#1 = #44#18;
               #1#2 = #44#8;
               #1#7 = nLinKit;
               |LEE 121#1=;
          |FINSI;
          |SI nLinKit ! 0; |BORRA 020#1a; |FINSI;
          |LIBERA #1;

          #gestr165@#0 = #1#6;
          |LEE 101#gestr165@.=;
          |SI FSalida = 0;
               |HAZ ActualizaCos;
               |BORRA 020#gestr165@.a;
          |FINSI;
     |SINO;
          |LEE 000#gestr165@.u;
          |SI FSalida = 0;
               nConta = #gestr165@#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #gestr165@;
          #gestr165@#0 = nConta;

          |GRABA 020#gestr165@.b;
          #gestr165@#1 = #1#3;
          #gestr165@#2 = #1#4;
          #gestr165@#3 = fFec;
          #gestr165@#4 = aArt;
          #gestr165@#5 = aDes;
          #gestr165@#6 = #1#5;
          #gestr165@#7 = nImpKit; ||((nImp < nDto1) < nDto2) < nDto3;
          #gestr165@#8 = nUni;
          |HAZ ActualizaCos;
          #gestr165@#11 = aPrv;
          |GRABA 020#gestr165@.a;

          |SI aParam = "ALB";
               #1#0 = #80#27;
               #1#1 = #80#0;
               #1#2 = #80#1;
               #1#7 = 0;
               |LEE 121#1=;
          |SINO;
               #1#0 = #44#21;
               #1#1 = #44#18;
               #1#2 = #44#8;
               #1#7 = 0;
               |LEE 121#1=;
          |FINSI;
          |SI nLinKit = 0;
               #1#6 = #gestr165@#0;
               |GRABA 020#1a;
          |SINO;
               #1#6 = #gestr165@#0;
               #1#7 = nLinKit;
               |GRABA 020#1n;
          |FINSI;
          |LIBERA #1;
     |FINSI;
     |LIBERA #gestr165@;
|FPRC;

|PROCESO KitCom;
     nHay = 1;
     |ABRE #19;
     #19#0 = #66#3;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
     |CIERRA #19;
     aArt = #66#3;
     aDes = #19#1;
     nUni = #66#5;
     aLinArt = #19#125;
     nLinKit = #66#6;
     nImpKit = #66#8;
     |SI enForma = 1;
          |HAZ Imputa;
          |HAZ Neumatico;
     |SINO;
          |HAZ Neumatico;
          |HAZ Imputa;
     |FINSI;
|FPRC;

|DEFBUCLE KitCom;
     #66#1;
     ;
     #80#27, #80#0, #80#1, 001;
     #80#27, #80#0, #80#1, 999;
     ;
     NULL, KitCom;
|FIN;

|PROCESO LineaCom;
     fFec = #77#1;
     aPrv = #77#3;
     nDto1 = #77#5;
     nDto2 = #77#32;
     nDto3 = #77#7;
     nImp = #80#9;

     #1#0 = #80#27;
     #1#1 = #80#0;
     #1#2 = #80#1;
     #1#7 = 0;
     |LEE 000#1=;
     |SI FSalida = 0; |Y #1#3 ! 0;
          nHay = 0;
          |BUCLE KitCom;
          |SI nHay = 0;
               aArt = #80#2;
               aDes = #80#4;
               nUni = #80#5;
               |ABRE #19;
               #19#0 = #80#2;
               |LEE 000#19=;
               |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
               |CIERRA #19;
               aLinArt = #19#125;
               nLinKit = 0;

               |SI enForma = 1;
                    |HAZ Imputa;
               |SINO;
                    |HAZ Neumatico;
               |FINSI;

               |SELECT #2#gestr069@;
               #gestr069@#6 = #80#2;
               |LEE 000#gestr069@.=;
               |SI FSalida = 0;
                    |HAZ PideRev;
               |FINSI;
               |SELECT #1#gestr069@;

               |SI enForma = 1;
                    |HAZ Neumatico;
               |SINO;
                    |HAZ Imputa;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO KitRegu;
     nHay = 1;
     |ABRE #19;
     #19#0 = #70#3;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
     |CIERRA #19;
     aArt = #70#3;
     aDes = #19#1;
     nUni = #70#5;
     aPrv = #19#27;
     nImp = #19#9 * #70#5;
     aLinArt = #19#125;
     nLinKit = #70#6;
     |SI enForma = 1;
          |HAZ Imputa;
          |HAZ Neumatico;
     |SINO;
          |HAZ Neumatico;
          |HAZ Imputa;
     |FINSI;
|FPRC;

|DEFBUCLE KitRegu;
     #70#1;
     ;
     #44#21, #44#18, #44#8, 001;
     #44#21, #44#18, #44#8, 999;
     ;
     NULL, KitRegu;
|FIN;

|PROCESO LineaRegu;
     |SI #44#7 = "E";
          |ACABA;
     |FINSI;
     fFec = #43#1;
     ||aPrv =
     nDto1 = 0;
     nDto2 = 0;
     nDto3 = 0;
     ||nImp = 0;

     #1#0 = #44#21;
     #1#1 = #44#18;
     #1#2 = #44#8;
     #1#7 = 0;
     |LEE 000#1=;
     |SI FSalida = 0; |Y #1#3 ! 0;
          nHay = 0;
          |BUCLE KitRegu;
          |SI nHay = 0;
               aArt = #44#0;
               aDes = #44#2;
               nUni = #44#5;
               |ABRE #19;
               #19#0 = #44#0;
               |LEE 000#19=;
               |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
               |CIERRA #19;
               aLinArt = #19#125;
               nLinKit = 0;
               aPrv = #19#27;
               nImp = #19#9 * #44#4;

               |SI enForma = 1;
                    |HAZ Imputa;
               |SINO;
                    |HAZ Neumatico;
               |FINSI;

               |SELECT #2#gestr069@;
               #gestr069@#6 = #44#0;
               |LEE 000#gestr069@.=;
               |SI FSalida = 0;
                    |HAZ PideRev;
               |FINSI;
               |SELECT #1#gestr069@;

               |SI enForma = 1;
                    |HAZ Neumatico;
               |SINO;
                    |HAZ Imputa;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;

     |DBASS aPath;
     aAlfa = aPath + "gesenvia/def/gestr000";
     |CARGA_DEF aAlfa, gestr000@;
     |SI FSalida = 0;
          aAlfa = aPath + "gesenvia/fich/";
          |PATH_DAT #gestr000@#aAlfa#;
          |DFICE aAlfa; aEmp = aAlfa % -205;
          |ABRE #gestr000@;
          #gestr000@#0 = aEmp;
          |LEE 000#gestr000@.=;
          aAlfa = FSalida;
          |CIERRA #gestr000@;
          |DESCARGA_DEF #gestr000@;
          |SI aAlfa = 0;
               aAlfa = aPath + "gesenvia/def/gestr001"; |CARGA_DEF aAlfa, gestr001@;
               aAlfa = aPath + "gesenvia/def/gestr006"; |CARGA_DEF aAlfa, gestr006@;
               aAlfa = aPath + "gesenvia/def/gestr069"; |CARGA_DEF aAlfa, gestr069@;
               aAlfa = aPath + "gesenvia/def/gestr071"; |CARGA_DEF aAlfa, gestr071@;
               aAlfa = aPath + "gesenvia/def/gestr073"; |CARGA_DEF aAlfa, gestr073@;
               aAlfa = aPath + "gesenvia/def/gestr076"; |CARGA_DEF aAlfa, gestr076@;
               aAlfa = aPath + "gesenvia/def/gestr135"; |CARGA_DEF aAlfa, gestr135@;
               aAlfa = aPath + "gesenvia/def/gestr138"; |CARGA_DEF aAlfa, gestr138@;
               aAlfa = aPath + "gesenvia/def/gestr141"; |CARGA_DEF aAlfa, gestr141@;
               aAlfa = aPath + "gesenvia/def/gestr162"; |CARGA_DEF aAlfa, gestr162@;
               aAlfa = aPath + "gesenvia/def/gestr163"; |CARGA_DEF aAlfa, gestr163@;
               aAlfa = aPath + "gesenvia/def/gestr164"; |CARGA_DEF aAlfa, gestr164@;
               aAlfa = aPath + "gesenvia/def/gestr165"; |CARGA_DEF aAlfa, gestr165@;
               aAlfa = aPath + "gesenvia/def/gestr073"; |CARGA_DEF aAlfa, refere0@;
               aAlfa = aPath + "gesenvia/def/gestr164"; |CARGA_DEF aAlfa, refere1@;
               aAlfa = aPath + "gesenvia/def/gestr163"; |CARGA_DEF aAlfa, refere2@;
               aAlfa = aPath + "gesenvia/fich/" + aEmp + "/";
               |PATH_DAT #gestr001@#aAlfa#;
               |PATH_DAT #gestr006@#aAlfa#;
               |PATH_DAT #gestr069@#aAlfa#;
               |PATH_DAT #gestr071@#aAlfa#;
               |PATH_DAT #gestr073@#aAlfa#;
               |PATH_DAT #gestr076@#aAlfa#;
               |PATH_DAT #gestr135@#aAlfa#;
               |PATH_DAT #gestr138@#aAlfa#;
               |PATH_DAT #gestr141@#aAlfa#;
               |PATH_DAT #gestr162@#aAlfa#;
               |PATH_DAT #gestr163@#aAlfa#;
               |PATH_DAT #gestr164@#aAlfa#;
               |PATH_DAT #gestr165@#aAlfa#;
               |PATH_DAT #refere1@#aAlfa#;
               |PATH_DAT #refere2@#aAlfa#;
               |ABRE #gestr001@;
               |ABRE #gestr006@;
               |ABRE #gestr069@;
               |ABRE #gestr071@;
               |ABRET #gestr073@;
               |ABRE #gestr076@;
               |ABRE #gestr135@;
               |ABRE #gestr138@;
               |ABRE #gestr141@;
               |ABRE #gestr162@;
               |ABRE #gestr163@;
               |ABRE #gestr164@;
               |ABRE #gestr165@;
               |LEE 000#gestr001@.p;
               |ABRE #553;
               |SI aParam = "ALB";
                    |REFERENCIA_DEF referen@, #gesem001;
                    |ABRE #1;
                    |ABRE #77;
                    #77#50 = eaSerie;
                    #77#0 = enCodigo;
                    |LEE 020#77=;
                    |CIERRA #77;
                    |BUCLELIN 2 LineaCom #77;
               |SINO;
                    |REFERENCIA_DEF referen@, #gesem002;
                    |ABRE #1;
                    |ABRE #43;
                    #43#4 = eaSerie;
                    #43#0 = enCodigo;
                    |LEE 020#43=;
                    |CIERRA #43;
                    |BUCLELIN 2 LineaRegu #43;
               |FINSI;
               |CIERRA #1;
               |CIERRA #553;
               |DESCARGA_DEF #refere2@;
               |DESCARGA_DEF #refere1@;
               |DESCARGA_DEF #refere0@;
               |CIERRA #gestr165@; |DESCARGA_DEF #gestr165@;
               |CIERRA #gestr164@; |DESCARGA_DEF #gestr164@;
               |CIERRA #gestr163@; |DESCARGA_DEF #gestr163@;
               |CIERRA #gestr162@; |DESCARGA_DEF #gestr162@;
               |CIERRA #gestr141@; |DESCARGA_DEF #gestr141@;
               |CIERRA #gestr138@; |DESCARGA_DEF #gestr138@;
               |CIERRA #gestr135@; |DESCARGA_DEF #gestr135@;
               |CIERRA #gestr076@; |DESCARGA_DEF #gestr076@;
               |CIERRAT #gestr073@; |DESCARGA_DEF #gestr073@;
               |CIERRA #gestr071@; |DESCARGA_DEF #gestr071@;
               |CIERRA #gestr069@; |DESCARGA_DEF #gestr069@;
               |CIERRA #gestr006@; |DESCARGA_DEF #gestr006@;
               |CIERRA #gestr001@; |DESCARGA_DEF #gestr001@;
          |FINSI;
     |FINSI;
|FPRO;
