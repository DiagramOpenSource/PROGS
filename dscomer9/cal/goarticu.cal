|FICHEROS;
     agifa019 #0;        || Este def.
     agifa324 #12;       || Divisas
     agifa321 #13;       || Parametros divisas
     goparame #8;        || parametros Obras.
     gogenpar #9,MANTE;
|FIN;

|VARIABLES;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     &eaPartida = "";
     &eaSeccion = "";
     &eaFamilia = "";
     &eaSubFamilia = "";
     &eaCapitulo = "";
     qAlta          = "";
     &nDeci_PreDiv  = 0;
     &nDeci_Base    = 0;
     &nDeci_PreBase = 0;
     &precio_base   = 0;
     cambio_div     = 0;
     cambio_base    = 0;
     nModo          = 0;
|FIN;

|PROCESO Na; |TIPO 0;    || No quitar
|FPRC;

|PROCESO D; |TIPO 13;
     |ABRE #agifa324;
     #agifa324#0 = #agifa019#165;
     |LEE 001#agifa324.=;
     nDeci_PreDiv = #agifa324#9;
     cambio_div = #agifa324#3;
     |ABRE #agifa321;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9; ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;  ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     cambio_base = #agifa324#3;
     |CIERRA #agifa321;
     |CIERRA #agifa324;

     |ABRE #8; |LEE 000#8p; |CIERRA #8;
     |SI #8#32 = "H";
          |MODO_RELACION #0, 1, "goapaive", "N", "N";
     |FINSI;
     |SI #8#90 = "S"; |Y #8#141 = "O";
          |PINTA 822, "Naturaleza:"
     |FINSI;
|FPRC;

|PROCESO ge; |TIPO 7;
     |C_M #0#2,   1, "S";
     |C_M #0#3,   1, "S";
     |C_M #0#125, 1, "S";
     |C_M #0#127, 1, "S";

     nModo = (FEntrada/100)!0;
     |SI nModo = 1;
          |ABRE #8; |LEE 000#8p; |CIERRA #8;
          |SI #8#32 ! "N";
               eaPartida = "  ";
               |SUB_EJECUTA_NP "goartive;goarticu";

               |SI eaPartida = ""; |ERROR; |ACABA; |FINSI;

               #0#0 = eaPartida;
               #0#125 = eaSeccion;
               #0#2 = eaFamilia;
               #0#3 = eaSubFamilia;
               #0#127 = eaCapitulo;
               |C_M #0#2,   1, "N";
               |C_M #0#3,   1, "N";
               |C_M #0#125, 1, "N";
               |C_M #0#127, 1, "N";
               |PINTA #0#2;
               |PINTA #0#3;
               |PINTA #0#125;
               |PINTA #0#127;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO IVAicu_66; |TIPO 66;
     enTiva = #0Campo;
     efFiva = ~;
     |HAZ ConsuIVA;
     |SI eaDiva = "";
          |ERROR;
     |SINO;
          #0Campo = enTiva; |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO IVAicu_0; |TIPO 0;
     enTiva = #0Campo;
     efFiva = ~;
     |HAZ SacaIVA;
     |SI eaDiva = "";
          |MENAV "0000No existe tipo iva para esta fecha...";
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
