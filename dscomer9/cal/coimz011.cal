|FICHEROS;
     coimz011 #0;
     coima001 #1;
     dsl00001 #10;
     agifa019 #19;
|FIN;

|VARIABLES;
     nLin = 0;
     aAlfa = "";
     i1        = "";
     i2        = "";
     i3        = "";
     i4        = "";
     i5        = "";
     i6        = "";
     p1        = "";
     p2        = "";
     p3        = "";
     p4        = "";
     p5        = "";
     p6        = "";
     calcodb   = "";
     sumai     = 0;
     sumap     = 0;
     base      = 0;
     resto     = 0;
     total     = 0;
     digito    = 0;
|FIN;

|PROCESO CalcuCB;
     i1 = aAlfa % 101;
     i2 = aAlfa % 301;
     i3 = aAlfa % 501;
     i4 = aAlfa % 701;
     i5 = aAlfa % 901;
     i6 = aAlfa % 1101;
     p1 = aAlfa % 201;
     p2 = aAlfa % 401;
     p3 = aAlfa % 601;
     p4 = aAlfa % 801;
     p5 = aAlfa % 1001;
     p6 = aAlfa % 1201;
     sumai = i1 + i2 + i3 + i4 + i5 + i6;
     sumap = p1 + p2 + p3 + p4 + p5 + p6;
     sumap = sumap * 3;
     total = sumai + sumap;
     base = total / 10;
     resto = total $ 10;
     |SI resto ! 0;
          resto = resto / 10;
          base = (base - resto) + 1;
          base = base * 10;
     |SINO;
          base = base * 10;
     |FINSI;
     digito = base - total;
     calcodb = aAlfa;
     |QBF calcodb;
     calcodb = calcodb + "000000000000000";
     calcodb = calcodb % 0112;
     calcodb = calcodb + digito;
     |QBF calcodb;
     aAlfa = calcodb;
|FPRC;

|PROCESO agifa019;
     aAlfa = #19#128; |QBF aAlfa;
     |SI aAlfa = "";
          |SI #1#22 = 0; #1#22 = 1; |FINSI;
          aAlfa = "00000000" + #0#0; |QBF aAlfa;
          aAlfa = (aAlfa % -108) + (("0000" + #1#22) % -104);
          |HAZ CalcuCB;
          #19#128 = aAlfa;
          #1#22 = #1#22 + 1;
          |GRABA 020#19a;
          |GRABA 020#1a;

          |LEE 000#10u;
          |SI FSalida = 0;
               nLin = #10#0 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #10;
          #10#0 = nLin;
          #10#1 = #19#0;
          #10#2 = #19#1;
          #10#3 = #19#128;
          |GRABA 020#10n;
     |FINSI;
     |LIBERA #19;
|FPRC;

|DEFBUCLE agifa019;
     #19#1;
     ;
     #0#1;
     #0#2;
     be;
     NULL, agifa019;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #10;
     |ABRE #1;
     |LEE 101#1p;
     |SI FSalida ! 0; |GRABA 020#1b; |FINSI;
     |BUCLE agifa019;
     |CIERRA #1;
     |CIERRA #10;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
