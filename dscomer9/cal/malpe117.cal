|FICHEROS;
     malpe117 #0;
     malpe087 #87;
     malpe088 #88;
     malpe090 #90;
     malpe091 #91;
     malpe104 #104;
|FIN;

|VARIABLES;
     aAlfa = "";
     nUni = 0;
     aLote = "";
     fFecha = @;
|FIN;

|PROCESO Ultimo;
     #90#52 = #91#29;
     #90#0 = #91#0;
     |LEE 000#90=;
     |SI FSalida = 0;
          |SI fFecha < #90#1;
               aLote = #91#49;
               fFecha = #90#1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Ultimo;
     #91#4;
     ;
     #88#28, #88#0, #88#1;
     #88#28, #88#0, #88#1;
     ;
     NULL, Ultimo;
|FIN;

|PROCESO Servicios;
     aAlfa = #104#12; |QBF aAlfa;

     |SI #104#7 ! #104#5; |Y aAlfa = "";
          #104#10 = aLote;
          |GRABA 020#104a;
          |LIBERA #104;
     |FINSI;
|FPRC;

|DEFBUCLE Servicios;
     #104#1;
     ;
     #88#28, #88#0, #88#1, 001;
     #88#28, #88#0, #88#1, 999;
     be;
     NULL, Servicios;
|FIN;

|PROCESO LinPedido;
     nUni = #88#5 - #88#43;
     |SI nUni > 0;
          aLote = "";
          fFecha = "01.01.0000";
          |BUCLE Ultimo;
          |SI aLote ! "";
               #88#45 = aLote;
               |GRABA 020#88a;
               |LIBERA #88;
               |BUCLE Servicios;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Pedido;
     #87#1;
     1;
     #0#0, #0#2, #0#4;
     #0#1, #0#3, #0#5;
     be;
     NULL, NULL, LinPedido;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #90;
     |BUCLE Pedido;
     |CIERRA #90;
|FPRC;
