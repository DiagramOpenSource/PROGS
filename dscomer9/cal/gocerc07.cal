         El gocerc05 = gocerc07 (modificar ambos)

|FICHEROS;
     gocerc07 #0;
     gopre003 #1;
     gomedive #2;
     goparame #3;
     gocerc08 #8;
     gocerc07@ #100;
|FIN;
-------------------------------------------------------------------------------
|VARIABLES;
     aCamp0         = "";
     aCamp1         = "";
     aCamp2         = "";
     aCamp3         = "";
     &nDeci_Medi    = 0;
     &nDeci_Meda    = 0;
     &Tempo         = "";
     &enSwCopia     = 0;
     &eaSer         = "";
     &eaCapi        = "";
     &enNum         = 0;
     &eaRefe        = "";
     &enPresu       = 0;
     i              = 0;
     nHay           = 0;
     aDef           = "";
     aPath          = "";
     cDesc          = "";
     cEstado        = "";
     cCampo         = "";
     nLin           = 0;
     nCampos        = 0;
     aAlfa          = "";
     nUlt           = 0;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Entra7; |TIPO 7;
     |ABRE #3;
     #3#0 = "A";
     |LEE 000#3=;
     |SI FSalida = 0;
          |SI #3#41 = "S";
               |ABRE #2;
               #2#0 = #1#6;
               |LEE 000#2=;
               |SI FSalida = 0;
                    |SI #2#3 = "S";
                         |C_M #0#6, 1, "S";
                    |SINO;
                         |C_M #0#6, 1, "N";
                    |FINSI;
                    |SI #2#4 = "S";
                         |C_M #0#7, 1, "S";
                    |SINO;
                         |C_M #0#7, 1, "N";
                    |FINSI;
                    |SI #2#5 = "S";
                         |C_M #0#8, 1, "S";
                    |SINO;
                         |C_M #0#8, 1, "N";
                    |FINSI;
               |FINSI;
               |CIERRA #2;
          |SINO;
               |C_M #0#6, 1, "S";|C_M #0#7, 1, "S";|C_M #0#8, 1, "S";
          |FINSI;
     |FINSI;
     |CIERRA #3;
/*
     |ATRI I;
     cDesc = "Total " + #1#6 + " ";
     cDesc = cDesc + #1#5;
     |QBF cDesc;
     cDesc = cDesc + ":";
     cDesc = cDesc % 150;
     |PINTA 2404, cDesc;
     |PINTA 2470, #1#7;
     |ATRI 0;
*/
|FPRC;
-------------------------------------------------------------------------------
|PROCESO InsertaLinea7;
     |DDEF aDef;
     aDef = aDef + "gocerc07";
     |CARGA_DEF aDef, gocerc07@;
     |SI FSalida = 0;
          |ABRE #gocerc07@;
          #gocerc07@#0 = #0#0;
          #gocerc07@#1 = #0#1;
          #gocerc07@#2 = #0#2;
          #gocerc07@#3 = #0#3;
          #gocerc07@#4 = 999;
          |LEE 000#gocerc07@.];
          |SI FSalida = 0;
               |LEE 000#gocerc07@.a;
          |SINO;
               |LEE 000#gocerc07@.u;
          |FINSI;
          |SI FSalida = 0; |Y #gocerc07@#0 = #0#0; |Y #gocerc07@#1 = #0#1;
                    |Y #gocerc07@#2 = #0#2; |Y #gocerc07@#3 = #0#3;
                    |Y #gocerc07@#4 ] #0#4;
               |PARA; |SI FSalida = 0; |Y #gocerc07@#0 = #0#0; |Y #gocerc07@#1 = #0#1;
                         |Y #gocerc07@#2 = #0#2; |Y #gocerc07@#3 = #0#3; |HACIENDO;
                    #gocerc07@#4 = #gocerc07@#4 + 1;
                    |BORRA 020#gocerc07@.a;
                    |GRABA 020#gocerc07@.n;
                    |LEE 101#gocerc07@.a;
                    |SI #gocerc07@#4 < #0#4; |SAL; |FINSI;
               |SIGUE;
               |DDEFECTO #gocerc07@;
               #gocerc07@#0 = #0#0;
               #gocerc07@#1 = #0#1;
               #gocerc07@#2 = #0#2;
               #gocerc07@#3 = #0#3;
               #gocerc07@#4 = #0#4;
               |GRABA 020#gocerc07@.n;
               |PONCONTROL 23, "SI";
               |PTEC 802; |PTEC 802;
          |FINSI;
          |CIERRA #gocerc07@;
          |DESCARGA_DEF #gocerc07@;
     |FINSI;
|FPRC;

|PROCESO Cambios7; |TIPO 2;
     #1#7 = #1#7 +. #0#9;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO CalLinMed7; |TIPO 0;

     ||Laro,Ancho y Alto.

     |SI #0#6 = 0; |Y #0#7 = 0;|Y #0#8 = 0;
          #0#9 = #0#5;
     |FINSI;

     |SI #0#6 ! 0; |Y #0#7 ! 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#6 * #0#7 * #0#8;
     |FINSI;

     ||Largo y Ancho;

     |SI #0#6 ! 0; |Y #0#7 ! 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#6 * #0#7;
     |FINSI;

     ||Largo y Alto.

     |SI #0#6 ! 0; |Y #0#7 = 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#6 * #0#8;
     |FINSI;

     ||Largo;

     |SI #0#6 ! 0; |Y #0#7 = 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#6;
     |FINSI;

     ||Ancho y Alto.

     |SI #0#6 = 0; |Y #0#7 ! 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#7 * #0#8;
     |FINSI;

     ||Ancho.

     |SI #0#6 = 0; |Y #0#7 ! 0;|Y #0#8 = 0;
          #0#9 = #0#5 * #0#7;
     |FINSI;

     ||Alto.

     |SI #0#6 = 0; |Y #0#7 = 0;|Y #0#8 ! 0;
          #0#9 = #0#5 * #0#8;
     |FINSI;

     |ABRE #8;
     |SELECT #2#8;
     #8#4 = #0#4;
     |LEE 000#8=;
     |CIERRA #8;

     #0#11 = #0#9 + #8#11;
     |SI #0#11 > #8#9;
          |MENAV "0000Se supera lo presupuestado...";
     |FINSI;

     |PINTA #0#11;
     |PINTA #0#9;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO TerProMed7; |TIPO 3;
     |SI #0#9 = 0;
          |MENAV "0000EXISTE ALGUN OPERANDO SIN VALOR O ESTA A 0";
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Mira7; |TIPO 0;
     |SI #3#41 = "S";
          |C_M #0Campo, 0, cCampo;
          |SI #0Campo = 0; |Y cCampo = "S";
               |MENAV "0000TIENE QUE ASIGNAR LA MEDIDA EN ESTE CAMPO";
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
|PROCESO Medida7;
     #0#0 = aCamp0;
     #0#1 = aCamp1;
     #0#2 = aCamp2;
     #0#3 = aCamp3;
     #0#4 = 999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida = 0; |Y #0#0 = aCamp0; |Y #0#1 = aCamp1;
               |Y #0#2 = aCamp2; |Y #0#3 = aCamp3;
          nUlt = #0#4 + 1;
     |SINO;
          nUlt = 1;
     |FINSI;

     aAlfa = "|NC";
     aAlfa = #0#aAlfa#;
     nCampos = aAlfa;
     nCampos = nCampos - 1;
     |PARA i = 5; |SI i [ nCampos; |HACIENDO i = i + 1;
          #0i = #100i;
     |SIGUE;
     #0#0 = aCamp0;
     #0#1 = aCamp1;
     #0#2 = aCamp2;
     #0#3 = aCamp3;
     #0#4 = nUlt;
     |GRABA 020#0n;
     #1#7 = #1#7 + #0#9;
|FPRC;

|DEFBUCLE Medida7;
     #100#1005;
     ;
     #0#0, #0#1, #0#2, nLin, 001;
     #0#0, #0#1, #0#2, nLin, 999;
     ;
     NULL, Medida7;
|FIN;

|PROCESO CopiaMedi7; |TIPO 11;
     |SI FSalida = 15; ||F7
          |HAZ InsertaLinea7;
          |ACABA;
     |FINSI;
     |SI FSalida = 14;
          |HAZ MediPresu;
          |ACABA;
     |FINSI;
     |SI FSalida  ! 13; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 2208 2430;
     |CUADRO 2208 2430;
     |ATRI I; |PINTA 2310, "Linea a Copiar:"; |ATRI 0;
     E_sup = 999;
     E_inf = 000;
     nLin = #0#4 - 1;
     nLin = 2326 ? 1;
     |SI FSalida = 0;
          |SI nLin = #0#3;
               |MENAV "0000­­­ Esta es la linea actual !!!...";
               |ERROR;
          |SINO;
               |DDEF aDef;
               aDef = aDef + "gocerc07";
               |CARGA_DEF aDef, gocerc07@;
               |SI FSalida = 0;
                    aCamp0 = #0#0;
                    aCamp1 = #0#1;
                    aCamp2 = #0#2;
                    aCamp3 = #0#3;
                    |BUCLE Medida7;
                    |PONCONTROL 23, "SI";
                    |DESCARGA_DEF #gocerc07@;
               |FINSI;
          |FINSI;
     |SINO;
          |ERROR;
     |FINSI;
     |POPV;
|FPRC;
