|FICHEROS;
     clipr001 #0;
     clipr035 #2;
     clipr034 #3;
     clipr038 #4,MANTE; ||aux. centros trabajo
     clipr015 #5; ||centros
     agifa024 #24;
     agifa025 #25;
     clipr077 #77;
     clipr999 #999;
     agifm001 #101;
     agifm002 #102;
     dsm00003 #7;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     &eaCodigo     = "";
     &eaTipoCodigo = "EM";
     nForma = 0;
     &eaEntidad = "";
     &eaSucursal = "";
     &eaCuenta = "";
     &eaDC = "";
     esletra = 0;
     cta1 = "";
     jj = 0;
     car = "";
     car1 = 0;
     car2 = "";
     cli = "";
     cta = "";
     sw = 0;
     izda = "";
     drch = "";
     cara = "";
     porcen = 0;
     ii = 0;
     loncuenta = 0;
     long = "";
     long1 = 0;
     cp1 = "";
     cp2 = "";
     &enEmpresa = "";
     &enFichero = "000";||001 FICHERO CLIENTESL
     ban = "";
     fic = "";
     nModo = 0;
     aAlfa1 = "";
     aCif1 = "";
     aCif2 = "";
|FIN;

|INCLUYE moneda_e;

|PROCESO codp;
 cp1 = #0#16;
 cp2 = #0#17;
 cp1 = "00"+cp1;
 cp1 = cp1 % -102;
 cp2 = "000"+cp2;
 cp2 = cp2 % -103;
 #0#18 = cp1 + cp2;
|FPRC;

|PROCESO ficha;|TIPO 4;
|IMPRE 0;
|SI FSalida = 0;
  |INFOR "clipr001";
  |SI FSalida = 0;
    |PRINT;
  |FINSI;
  |PIEINF;
  |FININF;
|FINSI;
|FINIMP;
|FPRC;

|PROCESO creatmp1;
#4#0 = #5#1;
#4#1 = #5#10;
#4#2 = #5#2;
|GRABA 010#4n;
|LIBERA #4;
|FPRC,

|DEFBUCLE creatmp;
#5#1;
;
#0#0,0000;
#0#0,9999;
e;
NULL,creatmp1;
|FIN;

|PROCESO desde;
 #4#0 = 0;
|FPRC;
|PROCESO hasta;
 #4#0 = 9999;
|FPRC;

|PROCESO tecla;|TIPO 6;
|SI FSalida = 10;
 enEmpresa = #0#0;
 enFichero = "000";
 |SUB_EJECUTA "dsam0054.tab";
|FINSI;
|SI FSalida = 11;
 fic = Usuario;
 |NOME_DAT #4 fic;
 |DELINDEX #4;
 |ABRE #4;
 |BUCLE creatmp;
 |PUSHV 0501 2380;
 enEmpresa = #0#0;
 |ENTLINEAL #1#4,1,4,22,1,desde,hasta;
 |POPV;
 |CIERRA #4;
 |DELINDEX #4;
|FINSI;
|FPRC;

|PROCESO mayusc;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FPRC;

|PROCESO veinte;|TIPO 6;
ban = #0#39;
|QBT ban;
ban = "0000"+ban;
ban = ban % -104;
#0#39 = ban;
|PINTA #0#39;
ban = #0#40;
|QBT ban;
ban = "0000"+ban;
ban = ban % -104;
#0#40 = ban;
|PINTA #0#40;
ban = #0#41;
|QBT ban;
ban = "00"+ban;
ban = ban % -102;
#0#41 = ban;
|PINTA #0#41;
ban = #0#42;
|QBT ban;
ban = "0000000000"+ban;
ban = ban % -110;
#0#42 = ban;
|PINTA #0#42;
#0#48 = #0#39+#0#40+#0#41+#0#42;
|PINTA #0#48;
|FPRC;

|PROCESO grupo;|TIPO 13;
#0#56 = "";
|ABRE #2;
|SELECT #2#2;
#2#2 = #0#0;
|LEE 010#2=;
|SI FSalida = 0;
  |ABRE #3;
  #3#0 = #2#0;
  |LEE 010#3=;
  |SI FSalida = 0;
    #0#56 = #3#1;
  |FINSI;
  |LIBERA #3;
  |CIERRA #3;
|FINSI;
|LIBERA #2;
|CIERRA #2;
|PINTA #0#56;
|FPRC;

|PROCESO punto;
cta = #0Campo;
|QBT cta;
|SI cta ! "";
  long = cta % 0;
  long1 = long
  izda = "";
  drch = "";
  cara = "";
  porcen = 0;
  sw = 0;
  |PARA ii = 1;|SI ii [ long1;|HACIENDO ii = ii + 1;
    porcen = 100 * ii + 1;
    cara = cta % porcen;
    |SI cara ! ".";|Y sw = 0;
      izda = izda + cara;
    |SINO;
     |SI cara = ".";
       sw = 1;
     |FINSI;
     |SI cara ! ".";
       drch = drch + cara;
     |FINSI;
    |FINSI;
  |SIGUE;
  cara = izda + drch;
  long = cara % 0;
  long1 = long;
  long1 = loncuenta - long1;
  long1 = 100 + long1;
  cara = "0"*loncuenta;
  cara = cara % long1;
  cara = izda + cara + drch;
  #0Campo = cara;
  |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO euro;|TIPO 8;
 |HAZ Monedas2;
 loncuenta = #999#3; ||longitud cuenta contable
|FPRC;


|PROCESO codigocar; |TIPO 3;
     cli = #0#49;
     |QBT cli;
     #0#58 = ("000000" + cli) % -106;
     |PINTA #0#58;
|FPRC;

|PROCESO tipo2;|TIPO 2;
     nModo = (FEntrada/100)!0;
     nForma = 0 +. 1;
     |HAZ CopiaCli;

     |SI nModo = 1;|O nModo = 2; ||ALTA 1§ CENTRO TRABAJO
      |ABRE #5;
      #5#0 = #0#0;
      #5#1 = 1;
      |LEE 010#5=;
      |SI FSalida = 0;
        |BORRA 010#5a;
        |LIBERA #5;
      |FINSI;
      #5#0 = #0#0;
      #5#1 = 1;
      #5#2 = #0#14;
      #5#3 = #0#15;
      #5#4 = #0#16;
      #5#5 = #0#17;
      #5#6 = #0#18;
      #5#7 = #0#19;
      #5#8 = #0#20;
      #5#9 = #0#22;
      #5#10 = "CENTRO TRABAJO EMPRESA";
      #5#20 = #0#29; ||contacto
      #5#36 = #0#12; ||cnae
      #5#37 = #0#54; ||actividad
      |GRABA 010#5n;
      |LIBERA #5;
      |CIERRA #5;
     |FINSI;
     |SI nModo = 3;
      |ABRE #5;
      #5#0 = #0#0;
      #5#1 = 1;
      |LEE 010#5=;
      |SI FSalida = 0;
        |BORRA 010#5a;
        |LIBERA #5;
      |FINSI;
      |CIERRA #5;
     |FINSI;
|FPRC;

|PROCESO buscaletra;
cta1 = #0#49;
|QBT cta1;
long = cta1 % 0;
long1 = long;
|PARA ii = 1;|SI ii [ long1;|HACIENDO ii = ii + 1;
  jj = 100*ii+1;
  car = cta1 % jj;
  car1 = &car
  |SI car1 < 48;|O car1 > 57;
     esletra = 0;
     |SAL;
  |SINO;
     esletra = 1;
  |FINSI;
|SIGUE;
|FPRC;

|PROCESO ctacont; |TIPO 0;
     esletra = 0;
     |HAZ punto;
     |HAZ buscaletra;
     |SI esletra = 0;
          |MENAV "0000La cuenta contable debe ser numerica";
          |ERROR;
     |SINO;
          |ABRE #24;
          cli = #0#49;
          |QBT cli;
          #24#0 = ("000000" + cli) % -106;
          |LEE 000#24=;
          |SI FSalida = 0;
               aCif1 = #24#15;     |QBF aCif1;
               aCif2 = #0#9;       |QBF aCif2;
               |SI aCif1 ! aCif2;
                    |AVISO;
                    aAlfa1 = "0000Cliente [" + #24#0 + "] con CIF distinto.";
                    |MENAV aAlfa1;
                    |ERROR;
               |SINO;
                    |HAZ codigocar;
               |FINSI;
          |SINO;
               |HAZ codigocar;
          |FINSI;
          |CIERRA #24;
     |FINSI;
|FPRC;

|PROCESO Digito7;|TIPO 7;
eaEntidad = #0#39;
eaSucursal = #0#40;
eaCuenta = #0#42;
|HAZ CalculoDC;
#0#41 = eaDC;
|PINTA #0#41;
|FPRC;

|PROCESO Digito;
eaEntidad = #0#39;
eaSucursal = #0#40;
eaCuenta = #0#42;
|HAZ CalculoDC;
|SI eaDC ! #0#41;
  |MENAV "0000 ­­ATENCION!! DIGITO DE CONTROL ERRONEO!!";
|FINSI;
|FPRC;

|PROCESO nif;
nModo = (FEntrada/100)!0;
|SI nModo = 1;
  #0#9 = #0#0;
  |PINTA #0#9;
|FINSI;
|FPRC;
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
|PROCESO CopiCampo;
     #24#1 = #0#1;
     #24#2 = #0#1;
     #24#5 = #0#14;
     #24#6 = #0#15;
     #24#7 = #0#19;
     #24#8 = #0#14;
     #24#9 = #0#15;
     #24#10 = #0#19;
     #24#11 = #0#14;
     #24#12 = #0#15;
     #24#13 = #0#19;
     #24#15 = #0#9;
     #24#16 = #0#49;
     #24#17 = #0#20;
     #24#18 = #0#22;
     #24#20 = #0#50;
     #24#22 = #0#51;
     #24#23 = #0#52;
     #24#24 = #0#53;
     #24#29 = #0#43;
     #24#30 = #0#42;
     #24#31 = #0#41;
     #24#32 = #0#39;
     #24#33 = #0#40;
     #24#34 = #0#44;
     #24#36 = #0#29;
     #24#53 = #0#25;
     #24#162 = #0#45;
     #24#178 = #0#16;
     #24#179 = #0#17;
     #24#180 = #0#18;
     #24#181 = #0#16;
     #24#182 = #0#17;
     #24#183 = #0#18;
     #24#184 = #0#16;
     #24#185 = #0#17;
     #24#186 = #0#18;
     #24#196 = #0#21;
     #24#197 = #0#23;
     #24#25 = #0#64;
|FPRC;

|PROCESO CopiaCli;
     |DDEFECTO #24;
     |ABRE #24;
     #24#0 = #0#58;
     |SI nModo = 1;|O nModo = 2;
          |SI nForma = 1;
               |LEE 101#24=;
               |SI FSalida ! 0;
                    |GRABA 020#24b;
                    |HAZ CopiCampo;
                    |GRABA 020#24a;
                    |HAZ Graba1Dir;
               |SINO;
                    aCif1 = #24#15;     |QBF aCif1;
                    aCif2 = #0#9;       |QBF aCif2;
                    |SI aCif1 ! aCif2;
                         |AVISO;
                         aAlfa1 = "0000NCliente [" + #0#58 + "] con CIF distinto. Actualizar?";
                         |CONFI aAlfa1;
                         |SI FSalida ! 0;
                              |LIBERA #24;
                              |CIERRA #24;
                              |ACABA;
                         |SINO;
                              |HAZ CopiCampo;
                              |GRABA 020#24a;
                              |HAZ Graba1Dir;
                         |FINSI;
                    |SINO;
                         |HAZ CopiCampo;
                         |GRABA 020#24a;
                         |HAZ Graba1Dir;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nModo = 3;
          |CONFI "2400SBorrar Maestro Gestion";
          |SI FSalida = 0;
               |HAZ BorraDir;
               |BORRA 020#24c;
          |FINSI;
     |FINSI;
     |LIBERA #24;
     |CIERRA #24;
|FPRC;

|PROCESO MasObs; |TIPO 0;
     |SI FSalida = 13;   ||F5
          eaCodigo = #0#0;
          nModo = (FEntrada/100)!0;
          |SI nModo = 1; |O nModo = 2;
               |GRABA 020#0a;
          |FINSI;
          |LIBERA #0; |CIERRAT #0;
          |SUB_EJECUTA_NP "dsz99994;MANTE";
          |ABRET #0;
          |SI nModo = 4;
               |LEE 000#0=;
          |SINO;
               |LEE 101#0=;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonNomRep;
     |ABRE #25;
     #25#0 = #0#64;
     |LEE 000#25=;
     #0#65 =#25#1;
     |PINTA 1719,#25#1;
     ||CIERRA #25;
|FPRC;

|PROCESO clipr077;
     |SI nCampo1 > 126;
          |ERROR10; |ACABA;
     |FINSI;
     #0nCampo1 = #77#1;
     #0nCampo2 = #77#0;
     nCampo1 = nCampo1 + 5;
     nCampo2 = nCampo2 + 1;
|FPRC;

|DEFBUCLE clipr077;
     #77#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, clipr077;
|FIN;

|PROCESO Especialidad; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;
     nCampo1 = 66;
     nCampo2 = 144;
     |BUCLE clipr077;
|FPRC;

|PROCESO Tecnico0; |TIPO 0;
     |SI #0Campo ! "00";
          |ABRE #25;
          #25#0 = #0Campo;
          |LEE 000#25=;
          |SI FSalida ! 0;
               |MENAV "0000No existe tecnico...";
               |ERROR;
          |SINO;
               nCampo1 = Campo + 1;
               #0nCampo1 = #25#1;
               |PINTA #0nCampo1;
          |FINSI;
          |CIERRA #25;
     |SINO;
          nCampo1 = Campo + 1;
          #0nCampo1 = "";
          |PINTA #0nCampo1;
     |FINSI;
|FPRC;

|PROCESO Tecnico66; |TIPO 66;
     |ABRE #25;
     #25#0 = #0Campo;
     |LEE 000#25];
     |CONSULTA_CLAVE #1#25;
     |SI FSalida = 0;
          #0Campo = #25#0;
          |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #25;
|FPRC;

|PROCESO Graba1Dir;
     |ABRE #101;
     #101#0 = #24#3;
     |LEE 000#101=; || Zona
     |CIERRA #101;

     |ABRE #102;
     #102#0 = #24#189;
     |LEE 000#102=; ||Ruta
     |CIERRA #102;

     |ABRE #25;
     #25#0 = #24#25;
     |LEE 000#25=;
     |CIERRA #25;

     |ABRE #7;
     |DDEFECTO #7;
     #7#0 = #24#0;
     #7#1 = 1;
     |LEE 101#7=;
     |SI FSalida ! 0; |GRABA 021#7b; |FINSI;
     #7#2 = #24#5;
     #7#3 = #24#6;
     #7#4 = #24#178;
     #7#5 = #24#179;
     #7#6 = #24#180;
     #7#7 = #24#7;
     #7#10 = #24#2;
     #7#11 = #24#3;
     #7#12 = #101#1;
     #7#13 = #24#17;
     #7#14 = #24#25;
     #7#15 = #25#1;
     #7#16 = #24#189;
     #7#17 = #102#1;
     |GRABA 021#7a;
     |CIERRA #7;
|FPRC;

|PROCESO BorraDirEnt;
     |BORRA 020#7a;
|FPRC;

|DEFBUCLE BorraDirEnt;
     #7#1;
     ;
     #24#0, 0001;
     #24#0, 9999;
     be;
     NULL, BorraDirEnt;
|FIN;

|PROCESO BorraDir;
     |BUCLE BorraDirEnt;
|FPRC;
