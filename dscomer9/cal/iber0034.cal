|FICHEROS;
     iber0034 #0;
     iber0035 #35,MANTE; || Escandallo
     iber0036 #36,MANTE; || Componentes agrupados
     iber0037 #37,MANTE; || Partida
     iber0038 #38;       || Stock Asignado
     iber0039 #39;       || Componentes sin agrupar

     iber0016 #16;       || Centros
     agifa017 #17;
     agifa019 #19;
     dsm00024 #24;
     agifa048 #480;
     agifa049 #49;
     agifa142 #142;
     agifa065 #65;
     agifa090 #90;
     agifa074 #74;
     dsm00052 #52;
     dsm00067 #67;
     dsm00238 #238; || Conversor Doble Stock
     dsm00241 #241; || Conversor Uni. Multi
|FIN;

|CAMPOS;
    #19#180 PARTI;
    #19#179 DOBLE;
    #19#204 MULTI;
|FIN;

|VARIABLES;
     &Tempo    = "";
     &enSwMenu = 0;
 {-1}Menu      = "";
     Menu1     = "2400";
     Menu2     = "2";
     Menu3     = "";
     Menu4     = "ARC";
     Menu5     = " Actualizar ";
     Menu6     = " Repasar ";
     Menu7     = " Cancelar ";

     aSerieOrd = "";
     nAlmaMate = 0;
     nAlmaProd = 0;
     nAsignar  = 0;
     aCentro   = "";
     nClave    = 0;
     aAlfa     = "";
     aUsu      = "";
     dArti     = "";
     hArti     = "";
     aPartiDefe= "";
     aParti    = "";
     aArti     = "";
     nHay      = 0;
     nCanti1   = 0;
     nCanti2   = 0;
     nCanti    = 0;
     nAlma     = 0;
     nStock    = 0;
     nModo     = 0;
     nNume     = 0;
     nLin      = 0;
     nLin2     = 0;
     nSubLin   = 0;
     nSwCrea   = 0;
     nSal      = 0;
     nVueltas  = 0;
     nFactor   = 0;
     nMulti    = 0;
     nUni1     = 0;
     nUni2     = 0;
|FIN;

|INCLUYE i_escank;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Tipo0_37; |TIPO 0;
     |SI #36#9 = "S";    ||Doble
          |C_M #37#4, 1, "S";
          #37#4 = #37#3 * #36#12;
          |PINTA #37#4;
     |SINO;
          |C_M #37#4, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo2_37; |TIPO 2;
     |DDEFECTO #38;
     |ABRE #38;
     #38#0 = #37#0;
     #38#1 = #37#1;
     #38#2 = #37#2;
     |LEE 101#38=;
     |SI FSalida ! 0; |GRABA 020#38b; |FINSI;
     #38#3 = #38#3 +. #37#3;
     |GRABA 020#38a;
     |CIERRA #38;
|FPRC;

|PROCESO Rellena_37; |TIPO 6;
     |SI #142#122 = "S";
          aAlfa = #37#2; |QBF aAlfa;
          aAlfa = (#142#121 * #142#120) + aAlfa;
          nNume = -(#142#120 + 100);
          #37#2 = aAlfa % nNume;
          |PINTA #37#2;
     |FINSI;
|FPRC;

|PROCESO Tipo0_36; |TIPO 0;
     |SI #36#9 = "S";    ||Doble
          #36#4 = #36#3 * #36#12;
          |PINTA #36#4;
     |FINSI;
     |SI #36#10= "S";    ||Multi
          #35#5 = #35#3 * #36#11;
     |FINSI;
|FPRC;

|PROCESO Tipo0_35; |TIPO 0;
     #35#6 = #35#3 * #35#8;
|FPRC;

|PROCESO Tipo7_35; |TIPO 7;
     |SI #35#5 = "S";
          |MODO_RELACION #35, 1, "dsm00024", "N", "S";
     |SINO;
          |MODO_RELACION #35, 1, "dsm00024", "N", "N";
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO FactorMulti;
     |ABRE #241; |SELECT #2#241;
     |DDEFECTO #241;
     #241#0 = #19#5;
     #241#2 = #19#207;
     |LEE 000#241=;
     |SI #241#6 = "D";
          nFactor = 1 * #241#5;
     |SINO;
          nFactor = 1 / #241#5;
     |FINSI;
     |CIERRA #241;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dsm00037;
     nUni1 = nCanti1;
     nUni2 = nCanti2;
     |SI #37#3 < nUni1; nUni1 = nCanti1; |FINSI;
     |SI #37#4 < nUni2; nUni2 = nCanti2; |FINSI;
     #37#3 = #37#3 - nUni1;
     #37#4 = #37#4 - nUni2;
     |GRABA 020#37a;
     |LIBERA #37;

     |DDEFECTO #19;
     #19#0 = #37#0;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;

     |DDEFECTO #17;
     #17#0 = #37#0;
     #17#1 = #37#1;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;

     |DDEFECTO #24;
     #24#0 = #37#0;
     #24#1 = #37#1;
     #24#2 = #37#2;
     |LEE 101#24=;
     |SI FSalida ! 0; |GRABA 020#24b; |FINSI;

     |SI MULTI = "S";
          nUni1 = nUni1 * #36#11;
          nUni2 = 0;
     |FINSI;

     #19#6 = #19#6 - nUni1;
     #19#104 = #19#104 - nUni1;
     #19#185 = #19#185 - nUni2;
     #19#193 = #19#193 - nUni2;

     #17#5 = #17#5 - nUni1;
     #17#39 = #17#39 - nUni1;
     #17#47 = #17#47 - nUni2;
     #17#48 = #17#48 - nUni2;

     #24#12 = #24#12 + nUni1;
     #24#11 = #24#11 + nUni2;

     |HAZ ValoraStock;

     |GRABA 020#19a;
     |GRABA 020#17a;
     |GRABA 020#24a;
     |LIBERA #19;
     |LIBERA #17;
     |LIBERA #24;

     |DDEFECTO #52;
     #52#0 = #74#0;
     #52#1 = #74#1;
     #52#2 = nLin2;
     #52#3 = #19#0;
     #52#4 = nUni1;
     #52#7 = nUni1;
     #52#5 = #17#1;
     #52#6 = #74#9;
     #52#8 = #37#2;
     #52#9 = nUni2;
     #52#10 = nUni2;
     |GRABA 020#52n;

     |DDEFECTO #65;
     #65#0 = #37#0;
     #65#1 = #90#1;
     #65#2 = "SF";
     #65#3 = #74#0;
     #65#4 = #74#1;
     #65#11 = #74#9; ||Serie
     |LEE 101#65=;
     |SI FSalida ! 0; |GRABA 020#65b; |FINSI;
     #65#5 = #37#1;
     #65#6 = -nUni1;
     #65#7 = #19#6;
     #65#8 = #19#9;
     #65#17 = -nUni2;
     #65#18 = #37#2;
     #65#20 = #36#14; || Conver Uni
     |GRABA 020#65a;
     |LIBERA #65;
     nLin2 = nLin2 + 1;
|FPRC;

|DEFBUCLE dsm00037;
     #37#1;
     ;
     #36#1, #36#13, "                              ";
     #36#1, #36#13, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, dsm00037;
|FIN;

|PROCESO Componente;
     nLin2 = nLin2 + 1;
     |SELECT #2#36;
     #36#1 = #39#1;
     |LEE 121#36=;
     nCanti1 = #39#2;
     nCanti2 = #39#3;
     |SI #36#3 < nCanti1; nCanti1 = #36#3; |FINSI;
     |SI #36#4 < nCanti2; nCanti2 = #36#4; |FINSI;
     #36#3 = #36#3 - nCanti1;
     #36#4 = #36#4 - nCanti2;
     |GRABA 020#36a;
     |LIBERA #36;

     |SI #36#8 = "S";         || Partidas
          |BUCLE dsm00037;
     |SINO;
          |DDEFECTO #19;
          #19#0 = #36#1;
          |LEE 101#19=;
          |SI FSalida ! 0; |GRABA 020#19b; |FINSI;

          |DDEFECTO #17;
          #17#0 = #36#1;
          #17#1 = #36#13;
          |LEE 101#17=;
          |SI FSalida ! 0; |GRABA 020#17b; |FINSI;

          |SI MULTI = "S";
               nCanti1 = nCanti1 * #36#11;
               nCanti2 = 0;
          |FINSI;

          #19#6 = #19#6 - nCanti1;
          #19#104 = #19#104 - nCanti1;

          #19#185 = #19#185 - nCanti2;
          #19#193 = #19#193 - nCanti2;

          #17#5 = #17#5 - nCanti1;
          #17#39 = #17#39 - nCanti1;

          #17#47 = #17#47 - nCanti2;
          #17#48 = #17#48 - nCanti2;

          |HAZ ValoraStock;

          |GRABA 020#19a;
          |GRABA 020#17a;
          |LIBERA #19;
          |LIBERA #17;

          |DDEFECTO #52;
          #52#0 = #74#0;
          #52#1 = #74#1;
          #52#2 = nLin2;
          #52#3 = #19#0;
          #52#4 = nCanti1;
          #52#5 = #17#1;
          #52#6 = #74#9;
          #52#7 = nCanti1;
          #52#8 = "";
          #52#9 = nCanti2;
          #52#10 = nCanti2;
          |GRABA 020#52n;

          |DDEFECTO #65;
          #65#0 = #36#1;
          #65#1 = #90#1;
          #65#2 = "SF";
          #65#3 = #74#0;
          #65#4 = #74#1;
          #65#5 = #36#13;
          #65#6 = -nCanti1;
          #65#7 = #19#6;
          #65#8 = #19#9;
          #65#11 = #74#9; ||Serie
          #65#17 = -nCanti2;
          #65#18 = "";
          #65#20 = #36#14; || Conver Uni
          |GRABA 020#65n;
     |FINSI;
|FPRC;

|DEFBUCLE Componente;
     #39#1;
     ;
     #35#0, dArti;
     #35#0, hArti;
     ;
     NULL, Componente;
|FIN;

|PROCESO Producto;
     |DDEFECTO #19;
     #19#0 = #35#0;
     |LEE 121#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;

     |DDEFECTO #17;
     #17#0 = #35#0;
     #17#1 = #35#1;
     |LEE 121#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;

     |SI #35#5 = "S";
          |DDEFECTO #24;
          #24#0 = #35#0;
          #24#1 = #35#1;
          #24#2 = #35#2;
          |LEE 101#24=;
          |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
     |FINSI;

     nCanti = #35#3;
     |SI MULTI = "S";
          nCanti = #35#6;
     |FINSI;

     #19#6 = #19#6 + nCanti;
     #19#104 = #19#104 + nCanti;

     #17#5 = #17#5 + nCanti;
     #17#39 = #17#39 + nCanti;

     #24#10 = #24#10 + nCanti;

     |HAZ ValoraStock;

     |GRABA 020#19a;
     |GRABA 020#17a;
     |LIBERA #19;
     |LIBERA #17;
     |SI #35#5 = "S";
          |GRABA 020#24a;
          |LIBERA #24;
     |FINSI;

     nLin = nLin + 1;
     |DDEFECTO #74;
     #74#9 = #90#20;
     #74#0 = #90#0;
     #74#1 = nLin;
     #74#2 = #35#0; || Esca
     #74#3 = #35#4; || Des
     #74#4 = #35#3; || a Fabr
     #74#5 = #35#3; || Fabri
     #74#7 = #35#1; || Alma
     #74#8 = ~;
     |GRABA 020#74n;

     |DDEFECTO #67;
     #67#0 = #74#9;
     #67#1 = #74#0;
     #67#2 = #74#1;
     #67#3 = #35#2;
     |LEE 101#67=;
     |SI FSalida ! 0; |GRABA 020#67b; |FINSI;
     #67#4 = #67#4 + #35#3;
     |GRABA 020#67a;
     |LIBERA #67;

     |DDEFECTO #65;
     #65#0 = #35#0;
     #65#1 = #90#1;
     #65#2 = "FB";
     #65#3 = #90#0;
     #65#4 = #74#1;
     #65#5 = #74#7;
     #65#6 = #74#4;
     #65#7 = #19#6;
     #65#8 = #19#9;
     #65#18 = #24#2;
     |GRABA 020#65n;

     nLin2 = 0;
     |ABRE #36;
     |BUCLE Componente;
     |CIERRA #36;
|FPRC;

|DEFBUCLE Producto;
     #35#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Producto;
|FIN;

|PROCESO Actualiza;
     |SI nSwCrea = 0;   ||Solo Crea una Orden
          nSwCrea = 1;
          |ABRE #90;
          enSwMenu = 1;
          #90#20 = aSerieOrd;
          |HAZ ContaOF7;
          #90#1 = ~;
          #90#2 = #90#1;
          #90#3 = #90#1;
          #90#10 = "S";
          |GRABA 020#90n;
          |CIERRA #90;
     |FINSI;

     |ABRE #24;
     |ABRE #19;
     |ABRE #17;
     |ABRE #65;

     |ABRE #74;
     |ABRE #52;
     |ABRE #67;
     |BUCLE Producto;
     |CIERRA #67;
     |CIERRA #52;
     |CIERRA #74;

     |CIERRA #65;
     |CIERRA #17;
     |CIERRA #19;
     |CIERRA #24;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Min37;
     #37#0 = #36#1;
     #37#1 = #36#13;
     #37#2 = " " * 15;
|FPRC;

|PROCESO Max37;
     #37#0 = #36#1;
     #37#1 = #36#13;
     #37#2 = "z" * 15;
|FPRC;

|PROCESO Pulsa; |TIPO 0;
     |SI FSalida = 0; |Y #36#1 = Contenido;
          |SI #36#8 = "S";
               |PUSHV 0501 2380;
               |ENTLINEAL #1#37, -3, 2, 22, 1, Min37, Max37;
               |POPV;
          |SINO;
               aAlfa = #36#9;       || Doble
               |C_M #36#4, 1, aAlfa;
            |ET Uno;
               |ENCAMPO #3#36;
               |SI FSalida = 0; |O FSalida = 3;
                    |ENCAMPO #4#36;
                    |SI FSalida = 2; |VETE Uno; |FINSI;
                    |SI FSalida = 0; |O FSalida = 3;
                         #36#6 = #36#3;
                         #36#7 = #36#4;
                         |SI #36#10 = "S";  || Multi
                              #36#5 = #36#3 * #36#11;
                         |FINSI;
                         |GRABA 020#36a;
                    |FINSI;
               |FINSI;
               |LEE 020#36=;
               |PINTA #36#3;
               |PINTA #36#4;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min36;
     #36#1 = dArti;
|FPRC;

|PROCESO Max36;
     #36#1 = hArti;
|FPRC;

|PROCESO BuscaPartida;
     #24#27 = "01.01.0000";
     #24#0 = aArti;
     #24#1 = #36#13;
     |LEE 000#24];
     |PARA; |SI FSalida = 0; |Y #24#0 = aArti; |Y #24#1 = #36#13; |HACIENDO;
          |SI #24#23 > 0;       ||컴컴컴컴컴컴컴 Hay Stock
               |DDEFECTO #38;
               #38#0 = #24#0;
               #38#1 = #24#1;
               #38#2 = #24#2;
               |LEE 101#38=;
               |SI FSalida ! 0; |GRABA 020#38b; |FINSI;
               nStock = #24#23 - #38#3;
               |SI nStock > 0;
                    |SI nStock ] #36#4;
                         nCanti = #36#4;
                    |SINO;
                         nCanti = nStock;
                    |FINSI;
                    nAlma = #24#1;
                    aParti = #24#2;

                    #38#3 = #38#3 + nCanti;
                    |GRABA 020#38a;
                    |SAL;
               |FINSI;
               |LIBERA #38;
          |FINSI;
          |LEE 000#24s;
     |SIGUE;
|FPRC;

|PROCESO iber0036;  ||컴컴컴컴컴컴컴컴컴컴 Asignacion de la Almacen/Partida
     |SI #36#10 = "S";
          nAsignar = #36#4;   || Multi
     |SINO;
          nAsignar = #36#3;
     |FINSI;

     |PARA; |SI nAsignar > 0; |HACIENDO;
          aArti = #36#1;
          aParti = "";
          nCanti1 = #36#3;
          nCanti2 = #36#4;
          nMulti = 0;
          |SI #36#8 = "S";
               aParti = aPartiDefe;
               nAlma = 0;
               |HAZ BuscaPartida;
               |SI nAlma = 0;         || No encuentra ninguna
                    nAlma = #36#13;
                    nCanti1 = nAsignar;
               |FINSI;
          |SINO;
               nAlma = #36#13;
               nCanti1 = nAsignar;
          |FINSI;
          |SI #36#9 = "S";    || Doble
               nCanti2 = nCanti1 * #36#12;
          |FINSI;
          |SI #36#10 = "S";   || Multi
               nMulti = nCanti1;
               nCanti1 = nMulti / #36#11;
          |FINSI;

          |DDEFECTO #37;
          #37#0 = aArti;
          #37#1 = nAlma;
          #37#2 = aParti;
          |LEE 101#37=;
          |SI FSalida ! 0; |GRABA 020#37b; |FINSI;
          #37#3 = #37#3 + nCanti1;
          #37#4 = #37#4 + nCanti2;
          |GRABA 020#37a;
          |LIBERA #37;

          nAsignar = nAsignar - nCanti1;
     |SIGUE;
     |GRABA 020#36a;
|FPRC;

|DEFBUCLE iber0036;
     #36#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, iber0036;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO LinKit;
     |DDEFECTO #19;
     #19#0 = aEscan;
     |LEE 000#19=;

     |DDEFECTO #238;
     #238#0 = #19#201;
     |LEE 000#238=;

     nClave = nClave + 1;
     |DDEFECTO #36;
     #36#0 = nClave
     |SELECT #2#36;      ||**
     #36#1 = #19#0;
     |LEE 000#36=;
     |SI FSalida ! 0;
          |SELECT #1#36; ||**
          |GRABA 020#36b;
     |SINO;
          |SELECT #1#36; ||**
          |LEE 101#36=;
     |FINSI;
     nCanti1 = nCantiEscan;
     nCanti2 = 0;
     nMulti = 0;

     |SI DOBLE = "S";
          nCanti2 = nCantiEscan;
          |SI #238#8 ] 1; #36#12 = #238#9; |FINSI;
          |SI #238#8 ] 2; #36#12 = #36#12 * #238#10; |FINSI;
          |SI #238#8 = 3; #36#12 = #36#12 * #238#11; |FINSI;
          nCanti2 = nCanti2 * #36#12;
     |FINSI;
     |SI MULTI = "S";
          |HAZ FactorMulti;
          nMulti = nCanti1;
          nCanti1 = nMulti / nFactor;
          #36#11= nFactor;
          #36#14 = #241#2;
     |FINSI;
     #36#2 = #19#1;
     #36#3 = #36#3 + nCanti1;
     #36#4 = #36#4 + nCanti2;
     #36#5 = #36#5 + nMulti;

     #36#6 = #36#3; || Pend.
     #36#7 = #36#4;

     #36#8 = PARTI;
     #36#9 = DOBLE;
     #36#10= MULTI;

     #480#0 = aEscan;
     |LEE 000#480=;
     |SI FSalida = 0;
          #36#13 = nAlmaProd;
     |SINO;
          #36#13 = nAlmaMate;
     |FINSI;
     |GRABA 020#36a;
     |LIBERA #36;

     |DDEFECTO #39;
     #39#0 = #35#0;
     #39#1 = #36#1;
     |LEE 101#39=;
     |SI FSalida ! 0; |GRABA 020#39b; |FINSI;

     #39#2 = #39#2 + nCanti1;
     #39#3 = #39#3 + nCanti2;
     |GRABA 020#39a;
     |LIBERA #39;
|FPRC;

|PROCESO iber0035;
||     |SI #35#7 = "S";
||          nCantiEscan = #35#6;
||     |SINO;
||          nCantiEscan = #35#3;
||     |FINSI;
     aEscan = #35#0;
     nCantiEscan = #35#3;
     nMaxNivel = 1;
     |HAZ DesglosaKit;
|FPRC;

|DEFBUCLE iber0035;
     #35#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, iber0035;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dsm00024;
     |SI #24#23 ] 0; |ACABA; |FINSI;     || Total

     |DDEFECTO #35;
     #35#0 = #24#0;
     #35#1 = #24#1;
     #35#2 = #24#2;
     |LEE 101#35=;
     |SI FSalida ! 0; |GRABA 020#35b; |FINSI;

     #35#3 = #35#3 - #24#23;
     #35#4 = #19#1;
     #35#5 = PARTI;
     #35#7 = MULTI;

     |GRABA 020#35a;
     |LIBERA #35;
     nHay = 1;
|FPRC;

|DEFBUCLE dsm00024;
     #24#1;
     ;
     #17#0, #17#1, "                              ";
     #17#0, #17#1, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dsm00024;
|FIN;

|PROCESO agifa017;
     #480#0 = #17#0;
     |LEE 000#480=;
     |SI FSalida ! 0; |ACABA; |FINSI;   ||Solo Escandallos

     #19#0 = #17#0;
     |LEE 000#19=;
     |SI PARTI = "S";
          |BUCLE dsm00024;
          |ACABA;
     |FINSI;

     |SI #17#5 ] 0; |ACABA; |FINSI;     || Tiene Stock

     |DDEFECTO #35;
     #35#0 = #17#0;
     #35#1 = #17#1;
     #35#2 = "";
     |LEE 101#35=;
     |SI FSalida ! 0; |GRABA 020#35b; |FINSI;

     #35#3 = #35#3 - #17#5;
     #35#4 = #19#1;
     #35#5 = PARTI;
     #35#7 = MULTI;
     |SI MULTI = "S";
          |HAZ FactorMulti;
          #35#8 = nFactor;
          #35#6 = #35#3;           || Cambia las unidades
          #35#3 = #35#6 / nFactor;
     |FINSI;
     |GRABA 020#35a;
     |LIBERA #35;
     nHay = 1;
|FPRC;

|DEFBUCLE agifa017;
     #17#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa017;
|FIN;

|PROCESO Min35;
     #35#0 = dArti;
     #35#1 = 00001;
     #35#2 = " " * 15;
|FPRC;

|PROCESO Max35;
     #35#0 = hArti;
     #35#1 = 99999;
     #35#2 = "z" * 15;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |DFICE aCentro;
     aCentro = aCentro % -403;

     |ABRE #16;
     #16#0 = aCentro;
     |LEE 020#16=;
     |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
     |CIERRA #16;

     nAlmaMate = #16#14;
     nAlmaProd = #16#15;
     aSerieOrd = #16#16;

     dArti = " " * 20;
     hArti = "z" * 20;

     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |SI #142#122 = "S";
          aPartiDefe = #142#121 * #142#120;
          aPartiDefe = (aPartiDefe + "1") % -115;
     |FINSI;

     aUsu = Usuario; |QBF aUsu;
     aAlfa = aUsu + "1"; |NOME_DAT #35 aAlfa;
     aAlfa = aUsu + "2"; |NOME_DAT #36 aAlfa;
     aAlfa = aUsu + "3"; |NOME_DAT #37 aAlfa;
     aAlfa = aUsu + "4"; |NOME_DAT #38 aAlfa;
     aAlfa = aUsu + "5"; |NOME_DAT #39 aAlfa;

     |PARA nVueltas = 1; |SI nVueltas [ 10; |HACIENDO nVueltas = nVueltas + 1;
          nHay = 0;
          |DELINDEX #35;
          |DELINDEX #36;
          |DELINDEX #37;
          |DELINDEX #38;
          |DELINDEX #39;

          |ABRE #480;
          |ABRE #35;
          |ABRE #19;
          |ABRE #238;
          |BUCLE agifa017;
          |CIERRA #238;
          |CIERRA #19;
          |CIERRA #35;
          |CIERRA #480;
          |SI nHay = 0;
               |SAL;
          |SINO;
               |ENTLINEAL #1#35, -1, 2, 22, 1, Min35, Max35;
               |ABRE #24; |SELECT #2#24;
               |ABRE #36;
               |ABRE #37;
               |ABRE #38;
               |ABRE #39;
               |ABRE #17;
               |ABRE #19;
               |ABRE #238;
               |ABRE #480;
               |BUCLE iber0035;
               nClave = 0;
               |BUCLE iber0036;
               |CIERRA #480;
               |CIERRA #238;
               |CIERRA #19;
               |CIERRA #17;
               |CIERRA #36;
               |CIERRA #37;
               |CIERRA #38;
               |CIERRA #39;
               |CIERRA #24;

               |SI #0#0 = "N";
                    |PINPA #0#36;
                    |PARA Menu2 = "2"; |SI Menu2 = "2"; |HACIENDO;
                         |ENTLINEAL #2#36, -1, 4, 22, 0, Min36, Max36;
                         |MENU Menu;
                         |SI FSalida [ 0; FSalida = 2; |FINSI;
                         Menu2 = FSalida;
                    |SIGUE;
                    |SI Menu2 = 1; |HAZ Actualiza; |FINSI;
                    |SI Menu2 = 3; |SAL; |FINSI;
               |SINO;
                    |HAZ Actualiza;
               |FINSI;
          |FINSI;
     |SIGUE;

     |DELINDEX #35;
     |DELINDEX #36;
     |DELINDEX #37;
     |DELINDEX #38;
     |DELINDEX #39;
|FPRC;
