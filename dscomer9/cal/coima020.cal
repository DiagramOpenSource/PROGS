|FICHEROS;
     coima020 #0;
     coima021 #1;
     agifa019 #19;
     coima030 #30;
|FIN;

|VARIABLES;
     nPvp = 0;
     nPrecio = 0;

     nModo = 0;
     nCata = 0;
     nCole = 0;
     nPagi = 0;
     nReg = 0;
     aAlfa = "";
     aRuta = "";
     aImg = "";
     aOrg = "";
     aDes = "";
     aLon = "";
     aCar = "";
     aNom = "";
     aIP = "";
     nPos = 0;
     i = 0;

 {-1}aUtil  = "";
     aUtil1 = "2400";
     aUtil2 = "1";
     aUtil3 = "";
     aUtil4  = "LER";
     aUtil5  = "Listado de paginas";
     aUtil6  = "Editar plantilla";
     aUtil7  = "Recuperar plantilla instalacion";
|FIN;

|PROCESO Registro; |TIPO 7;
     nModo = (FEntrada / 100) ! 0
     |SI nModo = 1;
          nCata = #0#0;
          nCole = #0#1;
          nPagi = #0#2;
          #0#3 = 999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y nCata = #0#0; |Y nCole = #0#1; |Y nPagi = #0#2;
               nReg = #0#3 + 1;
          |SINO;
               nReg = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nCata;
          #0#1 = nCole;
          #0#2 = nPagi;
          #0#3 = nReg;
     |FINSI;
|FPRC;

|PROCESO Articulo; |TIPO 0;
     nModo = (FEntrada / 100) ! 0
     |SI nModo = 2; |Y #1Campo ! Contenido; |Y #1#6 = "S";
          |ABRE #19;
          #19#0 = #1#5;
          |LEE 000#19=;
          |SI FSalida = 0;
               #1#7 = #19#1; |PINTA #1#7;
               #1#8 = #19#110; |PINTA #1#8;
               #1#9 = #19#111; |PINTA #1#9;
               #1#10 = #19#112; |PINTA #1#10;
               |SI #coima020#14 ! 0; |O #coima020#15 ! 0;
                    nPvp = #coima020#14;
                    |SI nPvp ! 0;
                         |SI nPvp = 1; nPrecio = #agifa019#18; |FINSI;
                         |SI nPvp = 2; nPrecio = #agifa019#19; |FINSI;
                         |SI nPvp = 3; nPrecio = #agifa019#20; |FINSI;
                         |SI nPvp = 4; nPrecio = #agifa019#147; |FINSI;
                         |SI nPvp = 5; nPrecio = #agifa019#148; |FINSI;
                         |SI nPvp = 6; nPrecio = #agifa019#149; |FINSI;
                         #1#16 = nPrecio;
                         |PINTA #1#16;
                    |FINSI;
                    nPvp = #coima020#15;
                    |SI nPvp ! 0;
                         |SI nPvp = 1; nPrecio = #agifa019#18; |FINSI;
                         |SI nPvp = 2; nPrecio = #agifa019#19; |FINSI;
                         |SI nPvp = 3; nPrecio = #agifa019#20; |FINSI;
                         |SI nPvp = 4; nPrecio = #agifa019#147; |FINSI;
                         |SI nPvp = 5; nPrecio = #agifa019#148; |FINSI;
                         |SI nPvp = 6; nPrecio = #agifa019#149; |FINSI;
                         #1#17 = nPrecio;
                         |PINTA #1#17;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #19;
     |SINO;
          |SI nModo = 1;      ||Alta
               |SI #coima020#14 ! 0; |O #coima020#15 ! 0;
                    |ABRE #19;
                    #19#0 = #1#5;
                    |LEE 000#19=;
                    |SI FSalida = 0;
                         nPvp = #coima020#14;
                         |SI nPvp ! 0;
                              |SI nPvp = 1; nPrecio = #agifa019#18; |FINSI;
                              |SI nPvp = 2; nPrecio = #agifa019#19; |FINSI;
                              |SI nPvp = 3; nPrecio = #agifa019#20; |FINSI;
                              |SI nPvp = 4; nPrecio = #agifa019#147; |FINSI;
                              |SI nPvp = 5; nPrecio = #agifa019#148; |FINSI;
                              |SI nPvp = 6; nPrecio = #agifa019#149; |FINSI;
                              #1#16 = nPrecio;
                              |PINTA #1#16;
                         |FINSI;
                         nPvp = #coima020#15;
                         |SI nPvp ! 0;
                              |SI nPvp = 1; nPrecio = #agifa019#18; |FINSI;
                              |SI nPvp = 2; nPrecio = #agifa019#19; |FINSI;
                              |SI nPvp = 3; nPrecio = #agifa019#20; |FINSI;
                              |SI nPvp = 4; nPrecio = #agifa019#147; |FINSI;
                              |SI nPvp = 5; nPrecio = #agifa019#148; |FINSI;
                              |SI nPvp = 6; nPrecio = #agifa019#149; |FINSI;
                              #1#17 = nPrecio;
                              |PINTA #1#17;
                         |FINSI;
                    |FINSI;
                    |CIERRA #19;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Recoge; |TIPO 0;
     nModo = (FEntrada / 100) ! 0
     |SI nModo = 1; |O #1Campo ! Contenido;
          |SI #1#6 = "S";
               |ABRE #19;
               #19#0 = #1#5;
               |LEE 000#19=;
               |SI FSalida = 0;
                    #1#7 = #19#1; |PINTA #1#7;
                    #1#8 = #19#110; |PINTA #1#8;
                    #1#9 = #19#111; |PINTA #1#9;
                    #1#10 = #19#112; |PINTA #1#10;
               |FINSI;
               |CIERRA #19;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Browse20;
     aRuta = "F*.*";
     |BROWSE aRuta;
     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta ! "F";
          #0Campo = aRuta; |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO BorraImagen20;
     |SI aImg = ""; |ACABA; |FINSI;
     |HAZ SacaNom20;
     |DBASE aOrg;
     aImg = aOrg + "000web/imagenes/" + aNom;
     |FBORRA aImg;
|FPRC;

|PROCESO SacaNom20;
     aLon = aImg % A0;
     aNom = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = -(i * 100 + 1)
          aCar = aImg % nPos;
          |SI aCar = "\"; |O aCar = "/"; |SAL; |FINSI;
          aNom = aCar + aNom;
     |SIGUE;
|FPRC;

|PROCESO CopiaImagen20;
     |SI aImg = ""; |ACABA; |FINSI;
     |DBASE aDes;
     aDes = aDes + "000web/"; |MKDIR aDes;
     aDes = aDes + "imagenes/"; |MKDIR aDes;
     |HAZ SacaNom20;
     aDes = aDes + aNom;
     aOrg = aImg;
     |SI aIP = "";
          |COPIA_FICHERO aOrg, aDes;
     |SINO;
          |RECIBE_FICHERO aOrg, aDes;
     |FINSI;
|FPRC;

|PROCESO Foto20; |TIPO 0;
     |SI FSalida = 10;
          |HAZ Browse20;
     |FINSI;
     |SI #0Campo ! Contenido;
          aIP = ""; |IP_REMOTO aIP; |QBF aIP;
          aImg = Contenido; |QBF aImg;
          |HAZ BorraImagen20;
          aImg = #0Campo; |QBF aImg;
          |HAZ CopiaImagen20;
     |FINSI;
|FPRC;

|PROCESO Browse21;
     aRuta = "F*.*";
     |BROWSE aRuta;
     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta ! "F";
          #1Campo = aRuta; |PINTA #1Campo;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Foto21; |TIPO 0;
     |SI FSalida = 10;
          |HAZ Browse21;
     |FINSI;
     |SI #1Campo ! Contenido;
          aIP = ""; |IP_REMOTO aIP; |QBF aIP;
          aImg = Contenido; |QBF aImg;
          |HAZ BorraImagen20;
          aImg = #1Campo; |QBF aImg;
          |HAZ CopiaImagen20;
     |FINSI;
|FPRC;

|PROCESO Texto0; |TIPO 0;
     |SI FSalida = 13;
          |ABRE #30;
          |CONSULTA_CLAVE #1#30;
          |SI FSalida = 0;
               #0#4 = #30#1; |PINTA #0#4;
               #0#11 = #30#2; |PINTA #0#11;
               #0#12 = #30#3; |PINTA #0#12;
               #0#13 = #30#4; |PINTA #0#13;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #30;
     |FINSI;
|FPRC;

|PROCESO Texto1; |TIPO 0;
     |SI FSalida = 13;
          |ABRE #30;
          |CONSULTA_CLAVE #1#30;
          |SI FSalida = 0;
               #1#7 = #30#1; |PINTA #1#7;
               #1#8 = #30#2; |PINTA #1#8;
               #1#9 = #30#3; |PINTA #1#9;
               #1#10 = #30#4; |PINTA #1#10;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #30;
     |FINSI;
|FPRC;

|PROCESO T20;  |TIPO 20;
     |SI FSalida = "OPCION";
         FSalida = "Listado";
         |ACABA;
     |FINSI;

     |MENU aUtil;
     aUtil2 = FSalida;

     |SI aUtil2 = "1";  |SUB_EJECUTA "coimy003;LISTADO";    |FINSI;
     |SI aUtil2 = "2";  |SUB_EJECUTA "coimy003;PLANTILLA";  |FINSI;
     |SI aUtil2 = "3";  |SUB_EJECUTA "coimy003;RECUPERAR";  |FINSI;
|FPRC;
