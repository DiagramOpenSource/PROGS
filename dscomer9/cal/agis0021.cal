|FICHEROS;
   agis0002 #1;
   agifa024 #3;
   agifa007 #40;
|FIN;

|VARIABLES;
   &TipoCta = "";
   informe1 = "agis0002";
   informe = "";
   &doc = 0;
   &ser = "";
/*
   &eaDivisa = "";
   &EURO = 0; &EURODB = 0; &EURODV = 0;
*/
|FIN;

|CALCULO recimpr1;|TIPO 0;
     |SI #agifa024#0 ! #agis0002#2;
       #agifa024#0 = #agis0002#2;|LEE 021#agifa024.=;
       |SI 0 ! FSalida;|DDEFECTO #agifa024;|FINSI;
     |FINSI;

     |ABRE #agifa007;
     #agifa007#26 = #agis0002#20;
     |LEE 001#agifa007.=;
     |SI FSalida = 0;
          informe = #agifa007#19; |QBF informe;
     |SINO;
          informe = informe1;
     |FINSI;
     |CIERRA #agifa007;

     |INFOR informe;
     |SI FSalida = 0;
          |PRINT;
          #agis0002#10 = AS;
          |GRABA 020#agis0002.a;
          |PIEINF;
          |FININF;
     |FINSI;
     |LIBERA #agis0002;
|FCAL;

|DEFBUCLE agifa523m0;
     #agis0002#1;
     10;
     " ", ser , doc , 01 , "N" ;
     "z", ser , doc , 99 , "N" ;
     be;
     NULL, recimpr1;
|FIN;

|PROCESO ImpreACta;
/*
     |SI eaDivisa = "EUR"; |O eaDivisa = "";
          EURODB = 2;
          EURO = 166.386;
          EURODV = 0;
     |SINO;
          EURODB = 0;
          EURO = 1 / 166.386;
          EURODV = 2;
     |FINSI;
*/

     |ABRE #agifa024;
     |IMPRE 0;
     |SI 0 = FSalida;
          |BUCLE agifa523m0;
          |FINIMP;
     |FINSI;
     |CIERRA #agifa024;
|FPRC;
