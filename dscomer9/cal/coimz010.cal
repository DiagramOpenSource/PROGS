|FICHEROS;
     coimz010 #0;
     agifa010 #10;
     coima038 #38;
     dsm00047 #47;
     agifa065 #65;
     agifa071 #71;
     coima047 #147;
|FIN;

|VARIABLES;
     fAnt = @;
     fHoy = @;
     aOpe = "";
|FIN;

|PROCESO dsm00047;
     #65#0 = #47#3;
     #65#1 = fAnt;
     #65#2 = aOpe;
     #65#3 = #10#0;
     #65#4 = #71#1;
     #65#11 = #10#52;
     |LEE 101#65=;
     |SI FSalida = 0;
          |BORRA 020#65a;
          |LIBERA #65;
          #65#1 = fHoy;
          |GRABA 020#65n;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00047;
     #47#1;
     ;
     #71#29, #71#0, #71#1, 001;
     #71#29, #71#0, #71#1, 999;
     ;
     NULL, dsm00047;
|FIN;

|PROCESO agifa071;
     |SI #10#43 = "S";
          aOpe = "BV";
     |SINO;
          aOpe = "AV";
     |FINSI;
     #65#0 = #71#2;
     #65#1 = fAnt;
     #65#2 = aOpe;
     #65#3 = #10#0;
     #65#4 = #71#1;
     #65#11 = #10#52;
     |LEE 101#65=;
     |SI FSalida = 0;
          |BORRA 020#65a;
          |LIBERA #65;
          #65#1 = fHoy;
          |GRABA 020#65n;
     |FINSI;
     |BUCLE dsm00047;
|FPRC;

|PROCESO agifa010;
     #147#0 = #10#52;
     #147#1 = #10#0;
     |LEE 000#147=;
     |SI FSalida ! 0;
          #147#2 = #10#1;
          |GRABA 020#147n;
     |FINSI;


     fAnt = #10#1;
     #10#1 = fHoy;
     |GRABA 020#10a;
     |LIBERA #10;


     |DDEFECTO #38;
     #38#0 = "AV";
     #38#1 = #10#52;
     #38#2 = #10#0;
     |LEE 101#38=;
     |SI FSalida ! 0; |GRABA 020#38b; |FINSI;
     #38#3 = #10#1;
     #38#4 = "N";
     |GRABA 020#38a;
     |LIBERA #38;
|FPRC;

|PROCESO Fin;
     |SI fAnt < "01.07.2010"; |Y fHoy ] "01.07.2010";
          |HAZ LimCabAgifa010;
          |BUCLELIN 2 CalCabAgifa010 #10;
          |GRABA 020#10a;
          |LIBERA #10;
     |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #10#1;
     2, 38;
     "      ", 000001, 0, "N";
     "zzzzz", 999999, 0, "N";
     be;
     NULL, agifa010, agifa071, Fin;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "SI";
          fHoy = ~;
          |ABRE #65;
          |ABRE #38;
          |ABRE #147;
          |BUCLE agifa010;
          |CIERRA #147;
          |CIERRA #38;
          |CIERRA #65;
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "menu";
          |MANTE #0;
     |SINO;
          #0#0 = "SI";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
