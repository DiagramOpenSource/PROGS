|FICHEROS;
     dsz00054 #0;
     agifa104 #104;
     agifa073 #73;
     dsm00005 #5;
     dsw00052 #52,MANTE;
     dsw00053 #53,MANTE;
     agifa019 #19;
|FIN;

|VARIABLES;
     nLinV = 0;
     &aDivisa = "";
     &aMoneda = "";
     nImpo = 0;
     nMult = 0;
     nNume7 = 0;
     nImpDiv = 0;
     &nDeci_PreDivP = 0;
     nNume11 = 0;
     nModo = 0;
     aSer = "";
     nNum = 0;
     nForma    = 0;
     &Tempo    = "";
     aTempo52  = "";
     aTempo53  = "";
     nErr      = 0;
     nSw       = 0;
     nEleme    = 0;
     nHay      = 0;
 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
|FIN;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Recal;
     |SI aSer ! "";
          |SI nNum ! #52#1; |O aSer ! #52#0;
               |HAZ CalCabAgifa104;
          |FINSI;
     |FINSI;
     aSer = #52#0;
     nNum = #52#1;
|FPRC;

|PROCESO dsw00053;
     #5#0 = "PV";
     #5#1 = #53#0;;
     #5#2 = #53#1;;
     #5#3 = #53#2;
     #5#4 = #53#3;
     |LEE 121#5=;
     |SI FSalida = 0;
          #5#6 = #53#9;||Uni
          #5#9 = #53#6;||Vari
          #5#11 = #53#7;||Pedidas
          #5#12 = #53#8;||Servidas
          #5#8 = #5#6 * #5#7;
          #5#14 = #5#6 * #5#13;
          |GRABA 020#5a;
          |LIBERA #5;
     |FINSI;
|FPRC;

|DEFBUCLE dsw00053;
     #53#1;
     ;
     #52#0, #52#1, #52#2, "      ";
     #52#0, #52#1, #52#2, "zzzzzz";
     ;
     NULL, dsw00053;
|FIN;

|PROCESO dsw00052;
     #104#25 = #52#0;
     #104#0 = #52#1;
     |LEE 121#104=;
     |SI FSalida = 0;
          aMoneda = #agifa104#37;
          aDivisa = #agifa104#35;
          |HAZ Divisas104;

          #73#28 = #52#0;
          #73#0 = #52#1;
          #73#1 = #52#2;
          |LEE 121#73=;
          |SI FSalida = 0;
               #73#5 = #52#10;
               #73#12 = #52#7;
               #73#42 = #52#8;
               #73#43 = #52#9;
               |HAZ TotalLin73
               |GRABA 020#73a;
               |LIBERA #73;
               |BUCLE dsw00053;
          |FINSI;
          |GRABA 020#104a;
          |LIBERA #104;
     |FINSI;
     |HAZ Recal;
|FPRC;

|DEFBUCLE dsw00052;
     #52#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsw00052;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Cuenta53;
     #52#6 = #52#6 + #53#5;
     #52#7 = #52#7 + #53#6;
     #52#8 = #52#8 + #53#7;
     #52#9 = #52#9 + #53#8;
     #52#10 = #52#10 + #53#9;
|FPRC;

|DEFBUCLE Cuenta53;
     #53#1;
     ;
     #52#0, #52#1, #52#2, "      ";
     #52#0, #52#1, #52#2, "zzzzzz";
     ;
     NULL, Cuenta53;
|FIN;

|PROCESO Uni53_0; |TIPO 0;
     #53#9 = #53#7 + #53#6;||Corrige
     |PINTA #53#9;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENAV "0000Alta no permitida";
          |ERROR;
          |ACABA;
     |FINSI;
     nForma = 0 +. 1;
     |SI #52#11 = "S"; |Y nForma = 1;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#53, 4, 2, 22, 1, Min53, Max53;
          |POPV;
          #52#6 = 0;||Uni
          #52#7 = 0;||Vari
          #52#8 = 0;||Pedidas
          #52#9 = 0;||Servidas
          #52#10 = 0;||Corrige
          |BUCLE Cuenta53;
     |FINSI;
|FPRC;

|PROCESO Uni52_7; |TIPO 7;
     |SI #52#11 = "S";
          |C_M #52#7, 1, "N";
     |SINO;
          |C_M #52#7, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Uni52_0; |TIPO 0;
     |C_M #52#7, 1, "S";
     #52#10 = #52#8 + #52#7;||Corrige
     |PINTA #52#10;
|FPRC;

|PROCESO Min53;
     #53#0 = #52#0;
     #53#1 = #52#1;
     #53#2 = #52#2;
     #53#3 = "      ";
|FPRC;

|PROCESO Max53;
     #53#0 = #52#0;
     #53#1 = #52#1;
     #53#2 = #52#2;
     #53#3 = "zzzzzz";
|FPRC;

|PROCESO Min;
     #52#0 = "     ";;
     #52#1 = 1;
     #52#2 = 1;
|FPRC;

|PROCESO Max;
     #52#0 = "zzzzz";
     #52#1 = 999999;
     #52#2 = 999;
|FPRC;

|PROCESO dsm00005;
     nEleme = 1;
     #53#0 = #5#1;
     #53#1 = #5#2;
     #53#2 = #5#3;
     #53#3 = #5#4;
     #53#4 = #5#5;
     #53#5 = #5#6;||Uni
     #53#6 = #5#9;||Vari
     #53#7 = #5#11;||Pedidas
     #53#8 = #5#12;||Servidas
     #53#9 = #53#7 + #53#6;||Corrige
     |SI #53#9 ! #53#5;
          nErr = 1;
     |FINSI;
     |SI nSw ! 0;
          |GRABA 020#53n;
     |FINSI;
     #52#11 = "S";
|FPRC;

|DEFBUCLE dsm00005;
     #5#1;
     ;
     "PV", #73#28, #73#0, nLinV, "      ";
     "PV", #73#28, #73#0, nLinV, "zzzzzz";
     ;
     NULL, dsm00005;
|FIN;

|PROCESO agifa073;
     #52#0 = #73#28;
     #52#1 = #73#0;
     #52#2 = #73#1;
     #52#3 = #104#1;
     #52#4 = #73#2;
     #52#5 = #73#4;
     #52#6 = #73#5;||Uni
     #52#7 = #73#12;||Vari
     #52#8 = #73#42;||Pedidas
     #52#9 = #73#43;||Servidas
     #52#10 = #52#8 + #52#7;||Corrige
     #52#11 = "N";

     nErr = 0;
     nSw = 0;
     nLinV = #73#1;
     |BUCLE dsm00005;

     |SI nErr ! 0; |O #52#10 ! #52#6;
          nSw = 1;
          |GRABA 020#52n;
          nLinV = #73#1;
          |BUCLE dsm00005;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE agifa104;
     #104#1;
     1;
     #0#0, #0#2, #0#4;
     #0#1, #0#3, #0#5;
     ;
     NULL, NULL, agifa073;
|FIN;

|PROCESO Tipo5; |TIPO 5;
     #52#11 = "S";
     |LINEAS_BI_ATRI #52#11, S, D, -1;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo; aTempo52 = Tempo;
     |NOME_DAT #52 aTempo52; |DELINDEX #52;
     |HAZ CreaTempo; aTempo53 = Tempo;
     |NOME_DAT #53 aTempo53; |DELINDEX #53;
     |ABRE #52;
     |ABRE #53;
     |BUCLE agifa104;
     |CIERRA #52;
     |CIERRA #53;
     |SI nHay ! 0;
          |PINPA #0#52;
          |PARA aMenu2 = 1; |SI aMenu2 = 1; |HACIENDO;
               |ENTLINEAL #1#52, 1, 2, 20, 0, Min, Max;
               |MENU aMenu;
               aMenu2 = FSalida;
          |SIGUE;
          |SI aMenu2 = 2;
               |ABRET #104;
               |ABRET #73;
               |ABRET #5;
               |BUCLE dsw00052;
               nNum = 0;
               |HAZ Recal;
               |CIERRAT #5;
               |CIERRAT #73;
               |CIERRAT #104;
          |FINSI;
     |SINO;
          |MENAV "0000No hay diferencias...";
     |FINSI;
     |DELINDEX #52; Tempo = aTempo52; |HAZ BoraTempo;
     |DELINDEX #53; Tempo = aTempo53; |HAZ BoraTempo;
|FPRC;
