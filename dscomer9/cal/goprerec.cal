|FICHEROS;
     goprerec #0;
     gopre002 #1;
     gopre003 #2;
     gopre004 #4;
     goartdes #9;
     gopre001 #10;
     gomedici #11;
     gofase01 #12;
     goparame #100;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";

     &nDeci_Medi    = 0;
     &nDeci_Meda    = 0;
     &nDeci_Incr    = 0;
     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;

     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;

     nModo          = 0;
     nIncrem        = 0;
     nHay           = 0;
     nMedAct        = 0;
|FIN;
-----------------------------------------------------------------------------
/*
|PROCESO MonTra006; |TIPO 14;
     cCodMonTrab = #0#4;
     |HAZ MonBas;
|FPRC;
*/
-----------------------------------------------------------------------------
|PROCESO MiraEsta; |TIPO 0;
     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     |LEE 000#10=;

     |SI FSalida = 0;

          |SI #10#17 ! " ";
               |MENAV "0000PRESUPUESTO ASIGNADO A UN EXPEDIENTE. SOLO AJUSTARA IMPORTES";
               |C_M #0#13, 1, "N";
               |C_M #0#14, 1, "N";
               |ACABA;
          |SINO;
               |C_M #0#13, 1, "S";
               |C_M #0#14, 1, "S";
          |FINSI;

     |FINSI;

     |CIERRA #10;

     |ABRE #12;
     #12#0 = #0#0;
     #12#1 = #0#1;
     |LEE 000#12=;

     |SI FSalida = 0;
          |MENAV "0000PRESUPUESTO ASIGNADO A FASES DE EJECUCION. SOLO AJUSTARA IMPORTES";
          |C_M #0#13, 1, "N";
          |C_M #0#14, 1, "N";
     |SINO;
          |C_M #0#13, 1, "S";
          |C_M #0#14, 1, "S";
     |FINSI;

     |CIERRA #12;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO MiraMone; |TIPO 0;
     cCodMonTrab = #0#4;
     |HAZ MonBas;
     |PINDA #0#0;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO CalPre; |TIPO 3;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     nDeci_Meda = #100#115;
     nDeci_Medi = #0#13;
     nDeci_Incr = #0#14;
     |HAZ CamPreCap;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO CalcMedi;
     ||Laro,Ancho y Alto.

     |SI #11#6 ! 0; |Y #11#7 ! 0;|Y #11#8 ! 0;
          #11#9 = #11#5 * #11#6 * #11#7 * #11#8;
     |FINSI;

     ||Largo y Ancho;

     |SI #11#6 ! 0; |Y #11#7 ! 0;|Y #11#8 = 0;
          #11#9 = #11#5 * #11#6 * #11#7;
     |FINSI;

     ||Largo y Alto.

     |SI #11#6 ! 0; |Y #11#7 = 0;|Y #11#8 ! 0;
          #11#9 = #11#5 * #11#6 * #11#8;
     |FINSI;

     ||Largo;

     |SI #11#6 ! 0; |Y #11#7 = 0;|Y #11#8 = 0;
          #11#9 = #11#5 * #11#6;
     |FINSI;

     ||Ancho y Alto.

     |SI #11#6 = 0; |Y #11#7 ! 0;|Y #11#8 ! 0;
          #11#9 = #11#5 * #11#7 * #11#8;
     |FINSI;

     ||Ancho.

     |SI #11#6 = 0; |Y #11#7 ! 0;|Y #11#8 = 0;
          #11#9 = #11#5 * #11#7;
     |FINSI;

     ||Alto.

     |SI #11#6 = 0; |Y #11#7 = 0;|Y #11#8 ! 0;
          #11#9 = #11#5 * #11#8;
     |FINSI;

     #2#7 = #2#7 + #11#9;
     nHay = 1;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE CalcMedi;
     #11#1;
     ;                                          ||Campos Extras.
     #1#0, #1#1, #1#12, #2#4,   1;
     #1#0, #1#1, #1#12, #2#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, CalcMedi;
|FIN;
-------------------------------------------------------------------------------
|PROCESO ActuPrecEsca;
     #4#10 = #4#9;                      ||Precio Compra.
     #4#11 = (#4#9*#4#8) > #4#13;       ||Importe Venta.
     #4#12 = #4#10*#4#8;                ||Importe Coste.
     nMedAct = #2#7;
     nHay = 0;
     #2#7 = 0;
     |BUCLE CalcMedi;

     |SI nHay = 0;
          #2#7 = nMedAct;
     |FINSI;

     #2#8  = #2#8 + #4#11;              ||Precio Venta Partida.
     #2#9  = #2#9 + #4#12;              ||Precio Compra Partida.
     #2#10 = #2#8 * #2#7;               ||Importe Venta Partida.
     #2#11 = #2#9 * #2#7;               ||Importe Coste Partida.
     #2#12 = ((#2#8-#2#9)/#2#9)*100;    ||Incremento Partida.
     |GRABA 020#4a;
     |GRABA 020#2a;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE ActuPrecEsca;
     #4#1;
     ;
     #2#0, #2#1, #2#2, #2#4, 1;
     #2#0, #2#1, #2#2, #2#4, 999;
     ;
     NULL, ActuPrecEsca;
|FIN;
-----------------------------------------------------------------------------
|PROCESO ActuPrecPart;
     #2#8 = 0;
     #2#9 = 0;
     |BUCLE ActuPrecEsca;
     #1#7  = #1#7 + #2#10;                        ||Precio Venta Capitulo.
     #1#8  = #1#8 + #2#11;                        ||Precio Coste Capitulo.
     #1#9  = #1#7 * #1#6;                         ||Importe Venta Capitulo
     #1#10 = #1#8 * #1#6;                         ||Importe Coste Capitulo.
     #1#11 = ((#1#7-#1#8)/#1#8)*100;              ||Incremento Partida.
     |GRABA 020#1a;
|FPRC;
-----------------------------------------------------------------------------
|DEFBUCLE ActuPrecPres;
     #2#1;
     ;
     #1#0, #1#1, #1#12, 1;
     #1#0, #1#1, #1#12, 999;
     ;
     NULL, ActuPrecPart;
|FIN;
-----------------------------------------------------------------------------
|PROCESO ActuPrecPres;
     #1#7  = 0;
     #1#8  = 0;
     |BUCLE ActuPrecPres;
     #10#5 = #10#5 + #1#9;
     #10#6 = #10#6 + #1#10;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO CamPreCap;
     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     |LEE 000#10=;

     |SI FSalida = 0;
          #10#5 = 0;
          #10#6 = 0;
          |BUCLELIN 2 ActuPrecPres #10;
          #10#24 = #0#13;
          #10#25 = #0#14;
          |GRABA 020#10a;
          #0#9 = #10#5;
          #0#10 = #10#6;
          |PINTA #0#9;
          |PINTA #0#10;
          |PAUSA;
     |FINSI;

     |CIERRA #10;
|FPRC;
-----------------------------------------------------------------------------
