|FICHEROS;
     diay0004 #0;
     agifa010 #10;
     agifa071 #71;
     agifa019 #19;
     diam0015 #15;
     diaw0010 #900;

     ma000001@ #200;
|FIN;

|VARIABLES;
     nCampo         = 0;
     nSwHay         = 0;
     nImporte       = 0;
     nLinea         = 0;

     aCliente       = "";
     aOrigen        = "";
     aDestino       = "";
     aBase          = "";
     aAlfa          = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aAlfa3         = "";
     aDocu          = "";
     aNCliente      = "";

     nTImPos1         = 0;
     nTImPos2         = 0;
     nTImPos3         = 0;
     nTImPos4         = 0;
     nTImPos5         = 0;
     nTImPos6         = 0;
     nTImPos7         = 0;
     nTImPos8         = 0;
     nTImPos9         = 0;
     nTImPos10        = 0;
     nTImPos11        = 0;
     nTImPos12        = 0;
     nTImPos13        = 0;
     nTImPos14        = 0;
     nTImPos15        = 0;
     nTImPos16        = 0;
     nTImPos17        = 0;
     nTImPos18        = 0;
     nTImPos19        = 0;
     nTImPos20        = 0;

     nTImNeg1         = 0;
     nTImNeg2         = 0;
     nTImNeg3         = 0;
     nTImNeg4         = 0;
     nTImNeg5         = 0;
     nTImNeg6         = 0;
     nTImNeg7         = 0;
     nTImNeg8         = 0;
     nTImNeg9         = 0;
     nTImNeg10        = 0;
     nTImNeg11        = 0;
     nTImNeg12        = 0;
     nTImNeg13        = 0;
     nTImNeg14        = 0;
     nTImNeg15        = 0;
     nTImNeg16        = 0;
     nTImNeg17        = 0;
     nTImNeg18        = 0;
     nTImNeg19        = 0;
     nTImNeg20        = 0;

     nTTotal1         = 0;
     nTTotal2         = 0;
     nTTotal3         = 0;
     nTTotal4         = 0;
     nTTotal5         = 0;
     nTTotal6         = 0;
     nTTotal7         = 0;
     nTTotal8         = 0;
     nTTotal9         = 0;
     nTTotal10        = 0;
     nTTotal11        = 0;
     nTTotal12        = 0;
     nTTotal13        = 0;
     nTTotal14        = 0;
     nTTotal15        = 0;
     nTTotal16        = 0;
     nTTotal17        = 0;
     nTTotal18        = 0;
     nTTotal19        = 0;
     nTTotal20        = 0;
     nTTotal21        = 0;
     nTTotal22        = 0;

     nTotalSoft       = 0;
     nTotalHard       = 0;
     nSwResumido      = 0;

     &Tempo           = "";
|FIN;

|PROCESO TipoInforme;
     |C_M #0#8, 1, "S";
     |C_M #0#9, 1, "S";
     |SI #0#5 = "D";
         |C_M #0#8, 1, "N";
         |C_M #0#9, 1, "N";
         #0#8 = 0;  |PINTA #0#8;
         #0#9 = 0;  |PINTA #0#9;
     |FINSI;
|FPRC;

|PROCESO agifa071;
     nImporte = #71#5 * #71#6;

     |DDEFECTO #900;
     #900#0  = #10#52;
     #900#1  = #10#0;
     #900#2  = #10#3;
     #900#3  = #10#4;
     #900#4  = #10#1;
     #900#5  = #10#6;
     #900#26 = 0;
     |SI nImporte < 0;  #900#26 = 1;  |FINSI;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |GRABA 020#900b;
     |FINSI;

     #19#0 = #71#2;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

     nCampo = 24;
     |SI #19#2 = #15#1;   nCampo = 6;   |FINSI;
     |SI #19#2 = #15#5;   nCampo = 7;   |FINSI;
     |SI #19#2 = #15#9;   nCampo = 8;   |FINSI;
     |SI #19#2 = #15#13;  nCampo = 9;   |FINSI;
     |SI #19#2 = #15#17;  nCampo = 10;  |FINSI;
     |SI #19#2 = #15#21;  nCampo = 11;  |FINSI;
     |SI #19#2 = #15#28;  nCampo = 12;  |FINSI;
     |SI #19#2 = #15#31;  nCampo = 13;  |FINSI;
     |SI #19#2 = #15#34;  nCampo = 14;  |FINSI;
     |SI #19#2 = #15#37;  nCampo = 15;  |FINSI;
     |SI #19#2 = #15#40;  nCampo = 16;  |FINSI;
     |SI #19#2 = #15#43;  nCampo = 17;  |FINSI;
     |SI #19#2 = #15#51;  nCampo = 18;  |FINSI;
     |SI #19#2 = #15#54;  nCampo = 19;  |FINSI;
     |SI #19#2 = #15#57;  nCampo = 20;  |FINSI;
     |SI #19#2 = #15#60;  nCampo = 21;  |FINSI;
     |SI #19#2 = #15#63;  nCampo = 22;  |FINSI;
     |SI #19#2 = #15#66;  nCampo = 23;  |FINSI;

     #900nCampo = #900nCampo + nImporte;
     #900#25    = #900#25    + nImporte;

     |GRABA 020#900a;
     |LIBERA #900;
     nSwHay = 1;
|FPRC;

|DEFBUCLE agifa010;
     #10#3;
     ;
     #0#0, #0#2, #0#6, 000000;
     #0#1, #0#3, #0#7, 999999;
     ;
     NULL, NULL, agifa071, NULL;
|FIN;

|PROCESO TotalMant;
   |SI #ma000001@#1 = "S"; nTotalSoft = nTotalSoft + #ma000001@#14; |FINSI;
   |SI #ma000001@#1 = "H"; nTotalHard = nTotalHard + #ma000001@#14; |FINSI;
|FPRC;

|DEFBUCLE TotalMant;
     #200#2002;
     28;
     #900#2,      0, "S";
     #900#2, 999999, "S";
     ;
     NULL, TotalMant;
|FIN;

|PROCESO PonACeros;
     nTImPos1   = 0;
     nTImPos2   = 0;
     nTImPos3   = 0;
     nTImPos4   = 0;
     nTImPos5   = 0;
     nTImPos6   = 0;
     nTImPos7   = 0;
     nTImPos8   = 0;
     nTImPos9   = 0;
     nTImPos10  = 0;
     nTImPos11  = 0;
     nTImPos12  = 0;
     nTImPos13  = 0;
     nTImPos14  = 0;
     nTImPos15  = 0;
     nTImPos16  = 0;
     nTImPos17  = 0;
     nTImPos18  = 0;
     nTImPos19  = 0;
     nTImPos20  = 0;

     nTImNeg1   = 0;
     nTImNeg2   = 0;
     nTImNeg3   = 0;
     nTImNeg4   = 0;
     nTImNeg5   = 0;
     nTImNeg6   = 0;
     nTImNeg7   = 0;
     nTImNeg8   = 0;
     nTImNeg9   = 0;
     nTImNeg10  = 0;
     nTImNeg11  = 0;
     nTImNeg12  = 0;
     nTImNeg13  = 0;
     nTImNeg14  = 0;
     nTImNeg15  = 0;
     nTImNeg16  = 0;
     nTImNeg17  = 0;
     nTImNeg18  = 0;
     nTImNeg19  = 0;
     nTImNeg20  = 0;
|FPRC;

|PROCESO ImprimePieD;
     nLinea     = nLinea + 1;

     aAlfa = "A" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "B" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "C" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "D" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "E" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "F" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "G" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "H" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "I" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "J" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "K" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "L" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "M" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "N" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "O" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "P" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "Q" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "R" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "S" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "T" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "V" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "W" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "X" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nLinea     = nLinea + 1;

     aAlfa = "B" + nLinea + ",T.POSITIVOS";        |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     |SI nTImPos1 ! 0;
         aAlfa = "D" + nLinea + "," + nTImPos1;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos2 ! 0;
         aAlfa = "E" + nLinea + "," + nTImPos2;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos3 ! 0;
         aAlfa = "F" + nLinea + "," + nTImPos3;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos4 ! 0;
         aAlfa = "G" + nLinea + "," + nTImPos4;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos5 ! 0;
         aAlfa = "H" + nLinea + "," + nTImPos5;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos6 ! 0;
         aAlfa = "I" + nLinea + "," + nTImPos6;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos7 ! 0;
         aAlfa = "J" + nLinea + "," + nTImPos7;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos8 ! 0;
         aAlfa = "K" + nLinea + "," + nTImPos8;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos9 ! 0;
         aAlfa = "L" + nLinea + "," + nTImPos9;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos10 ! 0;
         aAlfa = "M" + nLinea + "," + nTImPos10; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos11 ! 0;
         aAlfa = "N" + nLinea + "," + nTImPos11; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos12 ! 0;
         aAlfa = "O" + nLinea + "," + nTImPos12; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos13 ! 0;
         aAlfa = "P" + nLinea + "," + nTImPos13; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos14 ! 0;
         aAlfa = "Q" + nLinea + "," + nTImPos14; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos15 ! 0;
         aAlfa = "R" + nLinea + "," + nTImPos15; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos16 ! 0;
         aAlfa = "S" + nLinea + "," + nTImPos16; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos17 ! 0;
         aAlfa = "T" + nLinea + "," + nTImPos17; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos18 ! 0;
         aAlfa = "U" + nLinea + "," + nTImPos18; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos19 ! 0;
         aAlfa = "V" + nLinea + "," + nTImPos19; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos20 ! 0;
         aAlfa = "W" + nLinea + "," + nTImPos20; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nLinea = nLinea + 1;

     aAlfa = "B" + nLinea + ",T.NEGATIVOS";        |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     |SI nTImNeg1 ! 0;
         aAlfa = "D" + nLinea + "," + nTImNeg1;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg2 ! 0;
         aAlfa = "E" + nLinea + "," + nTImNeg2;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg3 ! 0;
         aAlfa = "F" + nLinea + "," + nTImNeg3;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg4 ! 0;
         aAlfa = "G" + nLinea + "," + nTImNeg4;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg5 ! 0;
         aAlfa = "H" + nLinea + "," + nTImNeg5;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg6 ! 0;
         aAlfa = "I" + nLinea + "," + nTImNeg6;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg7 ! 0;
         aAlfa = "J" + nLinea + "," + nTImNeg7;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg8 ! 0;
         aAlfa = "K" + nLinea + "," + nTImNeg8;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg9 ! 0;
         aAlfa = "L" + nLinea + "," + nTImNeg9;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg10 ! 0;
         aAlfa = "M" + nLinea + "," + nTImNeg10; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg11 ! 0;
         aAlfa = "N" + nLinea + "," + nTImNeg11; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg12 ! 0;
         aAlfa = "O" + nLinea + "," + nTImNeg12; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg13 ! 0;
         aAlfa = "P" + nLinea + "," + nTImNeg13; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg14 ! 0;
         aAlfa = "Q" + nLinea + "," + nTImNeg14; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg15 ! 0;
         aAlfa = "R" + nLinea + "," + nTImNeg15; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg16 ! 0;
         aAlfa = "S" + nLinea + "," + nTImNeg16; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg17 ! 0;
         aAlfa = "T" + nLinea + "," + nTImNeg17; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg18 ! 0;
         aAlfa = "U" + nLinea + "," + nTImNeg18; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg19 ! 0;
         aAlfa = "V" + nLinea + "," + nTImNeg19; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg20 ! 0;
         aAlfa = "W" + nLinea + "," + nTImNeg20; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nLinea = nLinea + 1;
     aAlfa = "A" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "B" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "C" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "D" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "E" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "F" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "G" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "H" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "I" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "J" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "K" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "L" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "M" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "N" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "O" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "P" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "Q" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "R" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "S" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "T" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "V" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "W" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "X" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nLinea = nLinea + 1;
     aAlfa = "B" + nLinea + ",TOTAL";        |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nImporte = nTImPos1 + nTImNeg1;
     |SI nImporte ! 0;
         aAlfa = "D" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos2 + nTImNeg2;
     |SI nImporte ! 0;
         aAlfa = "E" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos3 + nTImNeg3;
     |SI nImporte ! 0;
         aAlfa = "F" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos4 + nTImNeg4;
     |SI nImporte ! 0;
         aAlfa = "G" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos5 + nTImNeg5;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos6 + nTImNeg6;
     |SI nImporte ! 0;
         aAlfa = "I" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos7 + nTImNeg7;
     |SI nImporte ! 0;
         aAlfa = "J" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos8 + nTImNeg8;
     |SI nImporte ! 0;
         aAlfa = "K" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos9 + nTImNeg9;
     |SI nImporte ! 0;
         aAlfa = "L" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos10 + nTImNeg10;
     |SI nImporte ! 0;
         aAlfa = "M" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos11 + nTImNeg11;
     |SI nImporte ! 0;
         aAlfa = "N" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos12 + nTImNeg12;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos13 + nTImNeg13;
     |SI nImporte ! 0;
         aAlfa = "P" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos14 + nTImNeg14;
     |SI nImporte ! 0;
         aAlfa = "Q" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos15 + nTImNeg15;
     |SI nImporte ! 0;
         aAlfa = "R" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos16 + nTImNeg16;
     |SI nImporte ! 0;
         aAlfa = "S" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos17 + nTImNeg17;
     |SI nImporte ! 0;
         aAlfa = "T" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos18 + nTImNeg18;
     |SI nImporte ! 0;
         aAlfa = "T" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos19 + nTImNeg19;
     |SI nImporte ! 0;
         aAlfa = "V" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos20 + nTImNeg20;
     |SI nImporte ! 0;
         aAlfa = "W" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |HAZ PonACeros;
|FPRC;

|PROCESO ImprimePieS;
     nImporte = nTImPos20 + nTImNeg20;
     |SI nImporte < #0#8;  |O nImporte > #0#9;
         |HAZ PonACeros;
         |ACABA;
     |FINSI;

     |SI nSwResumido = 0;
         aAlfa = "I1,Desde Fecha: " + #0#2;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "M1,Hasta Fecha: " + #0#3;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "E2," + #15#1;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "F2," + #15#5;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "G2," + #15#9;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "H2," + #15#13 + "-" + #15#17 + "-" + #15#21;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "I2," + #15#28;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "J2," + #15#31;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "K2," + #15#34;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "L2," + #15#37;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "M2," + #15#40;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "N2," + #15#43;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "O2," + #15#51 + "-" + #15#60 + "-" + #15#63 + "-" + #15#66;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "P2," + #15#54;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "Q2," + #15#57;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "R2,OTROS";
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "S2,TOTALES";
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         nLinea      = 2;
         nSwResumido = 1;
     |FINSI;

     nLinea = nLinea + 1;

     aAlfa = aCliente;  |QBT aAlfa;
     aAlfa = ("000000" + aAlfa) % -106;
     aAlfa = "A" + nLinea + "," + aAlfa;           |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "B" + nLinea + "," + aNCliente;       |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     |SI nTImPos1 ! 0;
         aAlfa = "E" + nLinea + "," + nTImPos1;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos2 ! 0;
         aAlfa = "F" + nLinea + "," + nTImPos2;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos3 ! 0;
         aAlfa = "G" + nLinea + "," + nTImPos3;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos4 +  nTImPos5 + nTImPos6;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;    |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos7 ! 0;
         aAlfa = "I" + nLinea + "," + nTImPos7;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos8 ! 0;
         aAlfa = "J" + nLinea + "," + nTImPos8;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos9 ! 0;
         aAlfa = "K" + nLinea + "," + nTImPos9;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos10 ! 0;
         aAlfa = "L" + nLinea + "," + nTImPos10; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos11 ! 0;
         aAlfa = "M" + nLinea + "," + nTImPos11; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos12 ! 0;
         aAlfa = "N" + nLinea + "," + nTImPos12; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos13 +  nTImPos16 + nTImPos17 + nTImPos18;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;    |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos14 ! 0;
         aAlfa = "P" + nLinea + "," + nTImPos14; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos15 ! 0;
         aAlfa = "Q" + nLinea + "," + nTImPos15; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos19 ! 0;
         aAlfa = "R" + nLinea + "," + nTImPos19; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImPos20 ! 0;
         aAlfa = "S" + nLinea + "," + nTImPos20; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nLinea = nLinea + 1;

     |SI nTImNeg1 ! 0;
         aAlfa = "E" + nLinea + "," + nTImNeg1;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg2 ! 0;
         aAlfa = "F" + nLinea + "," + nTImNeg2;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg3 ! 0;
         aAlfa = "G" + nLinea + "," + nTImNeg3;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImNeg4 +  nTImNeg5 + nTImNeg6;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;    |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg7 ! 0;
         aAlfa = "I" + nLinea + "," + nTImNeg7;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg8 ! 0;
         aAlfa = "J" + nLinea + "," + nTImNeg8;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg9 ! 0;
         aAlfa = "K" + nLinea + "," + nTImNeg9;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg10 ! 0;
         aAlfa = "L" + nLinea + "," + nTImNeg10; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg11 ! 0;
         aAlfa = "M" + nLinea + "," + nTImNeg11; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg12 ! 0;
         aAlfa = "N" + nLinea + "," + nTImNeg12; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImNeg13 +  nTImNeg16 + nTImNeg17 + nTImNeg18;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;    |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg14 ! 0;
         aAlfa = "P" + nLinea + "," + nTImNeg14; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg15 ! 0;
         aAlfa = "Q" + nLinea + "," + nTImNeg15; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg19 ! 0;
         aAlfa = "R" + nLinea + "," + nTImNeg19; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTImNeg20 ! 0;
         aAlfa = "S" + nLinea + "," + nTImNeg20; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nLinea = nLinea + 1;

     |SI nTotalSoft ! 0;
         aAlfa = "C" + nLinea + "," + nTotalSoft;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTotalHard ! 0;
         aAlfa = "D" + nLinea + "," + nTotalHard;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos1 + nTImNeg1;
     |SI nImporte ! 0;
         aAlfa = "E" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos2 + nTImNeg2;
     |SI nImporte ! 0;
         aAlfa = "F" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos3 + nTImNeg3;
     |SI nImporte ! 0;
         aAlfa = "G" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte =            nTImPos4 + nTImNeg4;
     nImporte = nImporte + nTImPos5 + nTImNeg5;
     nImporte = nImporte + nTImPos6 + nTImNeg6;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos7 + nTImNeg7;
     |SI nImporte ! 0;
         aAlfa = "I" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos8 + nTImNeg8;
     |SI nImporte ! 0;
         aAlfa = "J" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos9 + nTImNeg9;
     |SI nImporte ! 0;
         aAlfa = "K" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos10 + nTImNeg10;
     |SI nImporte ! 0;
         aAlfa = "L" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos11 + nTImNeg11;
     |SI nImporte ! 0;
         aAlfa = "M" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos12 + nTImNeg12;
     |SI nImporte ! 0;
         aAlfa = "N" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte =            nTImPos13 + nTImNeg13;
     nImporte = nImporte + nTImPos16 + nTImNeg16;
     nImporte = nImporte + nTImPos17 + nTImNeg17;
     nImporte = nImporte + nTImPos18 + nTImNeg18;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos14 + nTImNeg14;
     |SI nImporte ! 0;
         aAlfa = "P" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos15 + nTImNeg15;
     |SI nImporte ! 0;
         aAlfa = "Q" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos19 + nTImNeg19;
     |SI nImporte ! 0;
         aAlfa = "R" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos20 + nTImNeg20;
     |SI nImporte ! 0;
         aAlfa = "S" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nTTotal1  = nTTotal1  + (nTImPos1  + nTImNeg1);
     nTTotal2  = nTTotal2  + (nTImPos2  + nTImNeg2);
     nTTotal3  = nTTotal3  + (nTImPos3  + nTImNeg3);
     nTTotal4  = nTTotal4  + (nTImPos4  + nTImNeg4);
     nTTotal5  = nTTotal5  + (nTImPos5  + nTImNeg5);
     nTTotal6  = nTTotal6  + (nTImPos6  + nTImNeg6);
     nTTotal7  = nTTotal7  + (nTImPos7  + nTImNeg7);
     nTTotal8  = nTTotal8  + (nTImPos8  + nTImNeg8);
     nTTotal9  = nTTotal9  + (nTImPos9  + nTImNeg9);
     nTTotal10 = nTTotal10 + (nTImPos10 + nTImNeg10);
     nTTotal11 = nTTotal11 + (nTImPos11 + nTImNeg11);
     nTTotal12 = nTTotal12 + (nTImPos12 + nTImNeg12);
     nTTotal13 = nTTotal13 + (nTImPos13 + nTImNeg13);
     nTTotal14 = nTTotal14 + (nTImPos14 + nTImNeg14);
     nTTotal15 = nTTotal15 + (nTImPos15 + nTImNeg15);
     nTTotal16 = nTTotal16 + (nTImPos16 + nTImNeg16);
     nTTotal17 = nTTotal17 + (nTImPos17 + nTImNeg17);
     nTTotal18 = nTTotal18 + (nTImPos18 + nTImNeg18);
     nTTotal19 = nTTotal19 + (nTImPos19 + nTImNeg19);
     nTTotal20 = nTTotal20 + (nTImPos20 + nTImNeg20);
     nTTotal21 = nTTotal21 + nTotalHard;
     nTTotal22 = nTTotal22 + nTotalSoft;

     |HAZ PonACeros;

     nLinea     = nLinea + 1;

     aAlfa = "A" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "B" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "C" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "D" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "E" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "F" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "G" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "H" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "I" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "J" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "K" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "L" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "M" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "N" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "O" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "P" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "Q" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "R" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "S" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "T" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
|FPRC;

|PROCESO ImprimePieR;
     nImporte = nTImPos20 + nTImNeg20;
     |SI nImporte < #0#8;  |O nImporte > #0#9;
         |HAZ PonACeros;
         |ACABA;
     |FINSI;

     |SI nSwResumido = 0;
         aAlfa = "I1,Desde Fecha: " + #0#2;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "M1,Hasta Fecha: " + #0#3;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "E2," + #15#1;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "F2," + #15#5;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "G2," + #15#9;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "H2," + #15#13 + "-" + #15#17 + "-" + #15#21;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "I2," + #15#28;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "J2," + #15#31;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "K2," + #15#34;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "L2," + #15#37;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "M2," + #15#40;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "N2," + #15#43;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "O2," + #15#51 + "-" + #15#60 + "-" + #15#63 + "-" + #15#66;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "P2," + #15#54;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "Q2," + #15#57;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "R2,OTROS";
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         aAlfa = "S2,TOTALES";
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

         nLinea      = 2;
         nSwResumido = 1;
     |FINSI;

     nLinea = nLinea + 1;

     aAlfa = aCliente;  |QBT aAlfa;
     aAlfa = ("000000" + aAlfa) % -106;
     aAlfa = "A" + nLinea + "," + aAlfa;           |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa = "B" + nLinea + "," + aNCliente;       |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     |SI nTotalSoft ! 0;
         aAlfa = "C" + nLinea + "," + nTotalSoft;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTotalHard ! 0;
         aAlfa = "D" + nLinea + "," + nTotalHard;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos1 + nTImNeg1;
     |SI nImporte ! 0;
         aAlfa = "E" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos2 + nTImNeg2;
     |SI nImporte ! 0;
         aAlfa = "F" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos3 + nTImNeg3;
     |SI nImporte ! 0;
         aAlfa = "G" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte =            nTImPos4 + nTImNeg4;
     nImporte = nImporte + nTImPos5 + nTImNeg5;
     nImporte = nImporte + nTImPos6 + nTImNeg6;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos7 + nTImNeg7;
     |SI nImporte ! 0;
         aAlfa = "I" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos8 + nTImNeg8;
     |SI nImporte ! 0;
         aAlfa = "J" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos9 + nTImNeg9;
     |SI nImporte ! 0;
         aAlfa = "K" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos10 + nTImNeg10;
     |SI nImporte ! 0;
         aAlfa = "L" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos11 + nTImNeg11;
     |SI nImporte ! 0;
         aAlfa = "M" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos12 + nTImNeg12;
     |SI nImporte ! 0;
         aAlfa = "N" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte =            nTImPos13 + nTImNeg13;
     nImporte = nImporte + nTImPos16 + nTImNeg16;
     nImporte = nImporte + nTImPos17 + nTImNeg17;
     nImporte = nImporte + nTImPos18 + nTImNeg18;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos14 + nTImNeg14;
     |SI nImporte ! 0;
         aAlfa = "P" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos15 + nTImNeg15;
     |SI nImporte ! 0;
         aAlfa = "Q" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos19 + nTImNeg19;
     |SI nImporte ! 0;
         aAlfa = "R" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTImPos20 + nTImNeg20;
     |SI nImporte ! 0;
         aAlfa = "S" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nTTotal1  = nTTotal1  + (nTImPos1  + nTImNeg1);
     nTTotal2  = nTTotal2  + (nTImPos2  + nTImNeg2);
     nTTotal3  = nTTotal3  + (nTImPos3  + nTImNeg3);
     nTTotal4  = nTTotal4  + (nTImPos4  + nTImNeg4);
     nTTotal5  = nTTotal5  + (nTImPos5  + nTImNeg5);
     nTTotal6  = nTTotal6  + (nTImPos6  + nTImNeg6);
     nTTotal7  = nTTotal7  + (nTImPos7  + nTImNeg7);
     nTTotal8  = nTTotal8  + (nTImPos8  + nTImNeg8);
     nTTotal9  = nTTotal9  + (nTImPos9  + nTImNeg9);
     nTTotal10 = nTTotal10 + (nTImPos10 + nTImNeg10);
     nTTotal11 = nTTotal11 + (nTImPos11 + nTImNeg11);
     nTTotal12 = nTTotal12 + (nTImPos12 + nTImNeg12);
     nTTotal13 = nTTotal13 + (nTImPos13 + nTImNeg13);
     nTTotal14 = nTTotal14 + (nTImPos14 + nTImNeg14);
     nTTotal15 = nTTotal15 + (nTImPos15 + nTImNeg15);
     nTTotal16 = nTTotal16 + (nTImPos16 + nTImNeg16);
     nTTotal17 = nTTotal17 + (nTImPos17 + nTImNeg17);
     nTTotal18 = nTTotal18 + (nTImPos18 + nTImNeg18);
     nTTotal19 = nTTotal19 + (nTImPos19 + nTImNeg19);
     nTTotal20 = nTTotal20 + (nTImPos20 + nTImNeg20);
     nTTotal21 = nTTotal21 + nTotalHard;
     nTTotal22 = nTTotal22 + nTotalSoft;

     |HAZ PonACeros;
|FPRC;

|PROCESO ImprimeDetalle;
     aAlfa = "B1," + #900#2 + " " + #900#3;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "I1,Desde Fecha: " + #0#2;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "M1,Hasta Fecha: " + #0#3;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "Q1,Total Soft: " + nTotalSoft;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "U1,Total Hard: " + nTotalHard;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "D2," + #15#1;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "E2," + #15#5;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "F2," + #15#9;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "G2," + #15#13;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "H2," + #15#17;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "I2," + #15#21;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "J2," + #15#28;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "K2," + #15#31;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "L2," + #15#34;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "M2," + #15#37;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "N2," + #15#40;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "O2," + #15#43;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "P2," + #15#51;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "Q2," + #15#54;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "R2," + #15#57;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "S2," + #15#60;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "T2," + #15#63;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "U2," + #15#66;
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "V2,OTROS";
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aAlfa = "W2,TOTALES";
     |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nLinea = 2;

|FPRC;

|PROCESO diaw0010;
     |SI aCliente ! #900#2;
         |SI nSwHay = 1;
             |SI #0#5 = "D";
                 |HAZ ImprimePieD;
                 |SI #0#4 = "P";
                     |ALFACALLDLL "agixl97.dll", "fin_book", "";
                 |SINO;
                     |ALFACALLDLL "agixl97.dll", "fin_book", "imprime";
                 |FINSI;

                 |DESCARGADLL "agixl97.dll";

                 |RFBORRA aDestino;
             |FINSI;

             |SI #0#5 = "R";  |HAZ ImprimePieR;  |FINSI;
             |SI #0#5 = "S";  |HAZ ImprimePieS;  |FINSI;
         |FINSI;

         |SI #0#5 = "D";
             |DBASE aBase;  |QBF aBase;
             aOrigen = aBase + "000577/AlbFamiliaD.xls";
             aDestino = "C:\DOCUMENTOS";         |RMKDIR aDestino;
             aDestino = aDestino + "\AlbFamiliaD.xls";
             aDocu    = aDestino;
             |ENVIA_FICHERO aOrigen, aDestino;

             |CARGADLL "agixl97.dll";
             |SI FSalida < 0;
                 |MENAV "0000No se puede usar agixl97.dll";
                 |ERROR10;
                 |ACABA;
             |FINSI;

             |ALFACALLDLL "agixl97.dll", "carga_book", aDocu;
             |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Hoja1";
         |FINSI;

         aCliente  = #900#2;
         aNCliente = #900#3;

         nTotalHard = 0;
         nTotalSoft = 0;
         |BUCLE TotalMant;

         |SI #0#5 = "D";  |HAZ ImprimeDetalle;  |FINSI;
     |FINSI;

     |SI #0#5 = "D";
         nLinea = nLinea + 1;
         aAlfa = "A"   + nLinea + "," + #900#4;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "B"   + nLinea + "," + #900#0 + " / " + (("000000" + #900#1) % -106);
                                                      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "C"   + nLinea + "," + #900#5;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |PARA nCampo = 6;  |SI nCampo [ 25;  |HACIENDO nCampo = nCampo + 1;
           |SI #900nCampo ! 0;
               |SI #900#26 = 0;
                   |SI nCampo = 6;   aAlfa = "D";  nTImPos1  = nTImPos1  + #900nCampo;  |FINSI;
                   |SI nCampo = 7;   aAlfa = "E";  nTImPos2  = nTImPos2  + #900nCampo;  |FINSI;
                   |SI nCampo = 8;   aAlfa = "F";  nTImPos3  = nTImPos3  + #900nCampo;  |FINSI;
                   |SI nCampo = 9;   aAlfa = "G";  nTImPos4  = nTImPos4  + #900nCampo;  |FINSI;
                   |SI nCampo = 10;  aAlfa = "H";  nTImPos5  = nTImPos5  + #900nCampo;  |FINSI;
                   |SI nCampo = 11;  aAlfa = "I";  nTImPos6  = nTImPos6  + #900nCampo;  |FINSI;
                   |SI nCampo = 12;  aAlfa = "J";  nTImPos7  = nTImPos7  + #900nCampo;  |FINSI;
                   |SI nCampo = 13;  aAlfa = "K";  nTImPos8  = nTImPos8  + #900nCampo;  |FINSI;
                   |SI nCampo = 14;  aAlfa = "L";  nTImPos9  = nTImPos9  + #900nCampo;  |FINSI;
                   |SI nCampo = 15;  aAlfa = "M";  nTImPos10 = nTImPos10 + #900nCampo;  |FINSI;
                   |SI nCampo = 16;  aAlfa = "N";  nTImPos11 = nTImPos11 + #900nCampo;  |FINSI;
                   |SI nCampo = 17;  aAlfa = "O";  nTImPos12 = nTImPos12 + #900nCampo;  |FINSI;
                   |SI nCampo = 18;  aAlfa = "P";  nTImPos13 = nTImPos13 + #900nCampo;  |FINSI;
                   |SI nCampo = 19;  aAlfa = "Q";  nTImPos14 = nTImPos14 + #900nCampo;  |FINSI;
                   |SI nCampo = 20;  aAlfa = "R";  nTImPos15 = nTImPos15 + #900nCampo;  |FINSI;
                   |SI nCampo = 21;  aAlfa = "S";  nTImPos16 = nTImPos16 + #900nCampo;  |FINSI;
                   |SI nCampo = 22;  aAlfa = "T";  nTImPos17 = nTImPos17 + #900nCampo;  |FINSI;
                   |SI nCampo = 23;  aAlfa = "U";  nTImPos18 = nTImPos18 + #900nCampo;  |FINSI;
                   |SI nCampo = 24;  aAlfa = "V";  nTImPos19 = nTImPos19 + #900nCampo;  |FINSI;
                   |SI nCampo = 25;  aAlfa = "W";  nTImPos20 = nTImPos20 + #900nCampo;  |FINSI;
               |SINO;
                   |SI nCampo = 6;   aAlfa = "D";  nTImNeg1  = nTImNeg1  + #900nCampo;  |FINSI;
                   |SI nCampo = 7;   aAlfa = "E";  nTImNeg2  = nTImNeg2  + #900nCampo;  |FINSI;
                   |SI nCampo = 8;   aAlfa = "F";  nTImNeg3  = nTImNeg3  + #900nCampo;  |FINSI;
                   |SI nCampo = 9;   aAlfa = "G";  nTImNeg4  = nTImNeg4  + #900nCampo;  |FINSI;
                   |SI nCampo = 10;  aAlfa = "H";  nTImNeg5  = nTImNeg5  + #900nCampo;  |FINSI;
                   |SI nCampo = 11;  aAlfa = "I";  nTImNeg6  = nTImNeg6  + #900nCampo;  |FINSI;
                   |SI nCampo = 12;  aAlfa = "J";  nTImNeg7  = nTImNeg7  + #900nCampo;  |FINSI;
                   |SI nCampo = 13;  aAlfa = "K";  nTImNeg8  = nTImNeg8  + #900nCampo;  |FINSI;
                   |SI nCampo = 14;  aAlfa = "L";  nTImNeg9  = nTImNeg9  + #900nCampo;  |FINSI;
                   |SI nCampo = 15;  aAlfa = "M";  nTImNeg10 = nTImNeg10 + #900nCampo;  |FINSI;
                   |SI nCampo = 16;  aAlfa = "N";  nTImNeg11 = nTImNeg11 + #900nCampo;  |FINSI;
                   |SI nCampo = 17;  aAlfa = "O";  nTImNeg12 = nTImNeg12 + #900nCampo;  |FINSI;
                   |SI nCampo = 18;  aAlfa = "P";  nTImNeg13 = nTImNeg13 + #900nCampo;  |FINSI;
                   |SI nCampo = 19;  aAlfa = "Q";  nTImNeg14 = nTImNeg14 + #900nCampo;  |FINSI;
                   |SI nCampo = 20;  aAlfa = "R";  nTImNeg15 = nTImNeg15 + #900nCampo;  |FINSI;
                   |SI nCampo = 21;  aAlfa = "S";  nTImNeg16 = nTImNeg16 + #900nCampo;  |FINSI;
                   |SI nCampo = 22;  aAlfa = "T";  nTImNeg17 = nTImNeg17 + #900nCampo;  |FINSI;
                   |SI nCampo = 23;  aAlfa = "U";  nTImNeg18 = nTImNeg18 + #900nCampo;  |FINSI;
                   |SI nCampo = 24;  aAlfa = "V";  nTImNeg19 = nTImNeg19 + #900nCampo;  |FINSI;
                   |SI nCampo = 25;  aAlfa = "W";  nTImNeg20 = nTImNeg20 + #900nCampo;  |FINSI;
               |FINSI;

               |SI #0#5 = "D";
                    aAlfa = aAlfa + nLinea + "," + #900nCampo;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
               |FINSI;
           |FINSI;
     |SIGUE;

     nSwHay = 1;
|FPRC;

|DEFBUCLE diaw0010;
     #900#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, diaw0010;
|FIN;

|PROCESO ImprimeTotal;
     |SI #0#5 = "R";
         nLinea     = nLinea + 1;

         aAlfa = "A" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "B" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "C" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "D" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "E" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "F" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "G" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "H" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "I" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "J" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "K" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "L" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "M" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "N" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "O" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "P" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "Q" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "R" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "S" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         aAlfa = "T" + nLinea + "," + ("-" * 100);  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nLinea = nLinea + 1;

     aAlfa = "B" + nLinea + ",TOTAL GENERAL ";  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     |SI nTTotal22 ! 0;
         aAlfa = "C" + nLinea + "," + nTTotal22;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI nTTotal21 ! 0;
         aAlfa = "D" + nLinea + "," + nTTotal21;      |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal1;
     |SI nImporte ! 0;
         aAlfa = "E" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal2;
     |SI nImporte ! 0;
         aAlfa = "F" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal3;
     |SI nImporte ! 0;
         aAlfa = "G" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal4 + nTTotal5 + nTTotal6;
     |SI nImporte ! 0;
         aAlfa = "H" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal7;
     |SI nImporte ! 0;
         aAlfa = "I" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal8;
     |SI nImporte ! 0;
         aAlfa = "J" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal9;
     |SI nImporte ! 0;
         aAlfa = "K" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal10;
     |SI nImporte ! 0;
         aAlfa = "L" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal11;
     |SI nImporte ! 0;
         aAlfa = "M" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal12;
     |SI nImporte ! 0;
         aAlfa = "N" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal13 + nTTotal16 + nTTotal17 + nTTotal18;
     |SI nImporte ! 0;
         aAlfa = "O" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal14;
     |SI nImporte ! 0;
         aAlfa = "P" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal15;
     |SI nImporte ! 0;
         aAlfa = "Q" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal19;
     |SI nImporte ! 0;
         aAlfa = "R" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nImporte = nTTotal20;
     |SI nImporte ! 0;
         aAlfa = "S" + nLinea + "," + nImporte;  |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ CreaTempo;
     |NOME_DAT #900 Tempo; |DELINDEX #900;

     |ABRE #15;
     |LEE 040#15u;
     |SI FSalida ! 0;  |DDEFECTO #15;  |FINSI;
     |CIERRA #15;

     |MENSA "0000 Creando Temporal ... ";
     |ABRE #900;
     |ABRE #19;
     |BUCLE agifa010;
     |CIERRA #19;
     |CIERRA #900;

     |SI nSwHay = 0;
         |MENAV "0000 Seleccion Vacia.";
         |DELINDEX #900;
         |HAZ BoraTempo;
         |ACABA;
     |FINSI;

     |MENSA "0000 Cargando Hoja Excel ... ";

     aAlfa1 = "";
     |DBASS aAlfa1;
     aAlfa1 = aAlfa1 + "dsman9/def/ma000001.mas";
     |CARGA_DEF aAlfa1, ma000001@;
     |SI FSalida ! 0;
         |MENAV "0000 Error en cargar el Def ma000001.mas";
         |ACABA;
     |FINSI;

     aAlfa1 = "";
     |DBASS aAlfa1;
     aAlfa1 = aAlfa1 + "dsman9/fich/84/";
     |PATH_DAT #200 aAlfa1;

     |DBASE aBase;  |QBF aBase;
     |SI #0#5 ! "D";
         aOrigen = aBase + "000577/AlbFamiliaR.xls";
         aDestino = "C:\DOCUMENTOS";         |RMKDIR aDestino;
         aDestino = aDestino + "\AlbFamiliaR.xls";
         aDocu    = aDestino;
         |ENVIA_FICHERO aOrigen, aDestino;

         |CARGADLL "agixl97.dll";
         |SI FSalida < 0;
             |MENAV "0000No se puede usar agixl97.dll";
             |ACABA;
         |FINSI;

         |ALFACALLDLL "agixl97.dll", "carga_book", aDocu;
         |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Hoja1";
     |FINSI;

     nSwHay = 0;
     |BUCLE diaw0010;

     |SI #0#5 = "D";  |HAZ ImprimePieD;                      |FINSI;
     |SI #0#5 = "R";  |HAZ ImprimePieR;  |HAZ ImprimeTotal;  |FINSI;
     |SI #0#5 = "S";  |HAZ ImprimePieS;  |HAZ ImprimeTotal;  |FINSI;

     |SI #0#4 = "P";
         |ALFACALLDLL "agixl97.dll", "fin_book", "";
     |SINO;
         |ALFACALLDLL "agixl97.dll", "fin_book", "imprime";
     |FINSI;
     |DESCARGADLL "agixl97.dll";

     |RFBORRA aDestino;

     |DESCARGA_DEF #ma000001@;

     |DELINDEX #900;
     |HAZ BoraTempo;
|FPRC;
