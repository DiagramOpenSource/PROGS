|FICHEROS;
     psion026 #0;
     psion025 #25;
|FIN;

|VARIABLES;
     aIPRemoto = "";
     aOrigen = "";
     aDestino = "";
     aNombre = "";
     aAlf1 = "";
     aAlf2 = "";
     aAlf3 = "";
     aAlf4 = "";
     {1}aLocal = "";
|FIN;

|PROCESO Min;
     #0#0 = " " * 15;
     #0#1 = "01.01.0000";
     #0#2 = " " * 8;
|FPRC;

|PROCESO Max;
     #0#0 = "z" * 15;
     #0#1 = "31.12.9999";
     #0#2 = "z" * 8;
|FPRC;

|PROGRAMA;
     |CLS;
     |ENTLINEAL #1#0, 1, 2, 22, 1, Min, Max;
|FPRO;

|PROCESO Tecla; |TIPO 11;
     |SI FSalida ! 13; |ACABA; |FINSI;

     |ABRE #25; |LEE 000#25p; |CIERRA #25;
     aNombre = #25#14; |QBF aNombre;
     aAlf1 = #0#0; |QBF aAlf1;
     aAlf2 = #0#1;
     aAlf3 = #0#2;
     aAlf2 = (aAlf2 % 102) + (aAlf2 % 402) + (aAlf2 % 704)
     aAlf3 = (aAlf3 % 102) + (aAlf3 % 402) + (aAlf3 % 702)
     aNombre = aNombre + aAlf1 + aAlf2 + aAlf3; |QBF aNombre;
     aNombre = aNombre + ".txt";

     |ESPECIFICA "RBASS", aLocal;
     aDestino = aLocal + "spool/" + aAlf1 + aAlf2 + aAlf3 + ".txt";
     aOrigen = aNombre;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
          |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
          |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
     aAlf1 = "start wordpad.exe " + aDestino;
     |RSYSTEM aAlf1;
     |ERROR;
|FPRC;
