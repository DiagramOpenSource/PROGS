|FICHEROS;
     gopre002 #1;
     godeivec #5;
     godeivel #6;
     godeprec #7;
     godeprel #8;
     goparame #9;
     gopre021 #21,MANTE;
     gopre022 #22;
|FIN;
------------------------------------------------------------------------------
|VARIABLES;
     &PasoPorDes    = 0;
     aDirectorio    = "";
     aNFichero      = "";
     aVariableCarga = "";
     aFichero       = "";
     aAlfa          = "";

     nVariable      = 0;
     nBaffer        = 0;
     nTotalLinea    = 0;
     nTope          = 0;
     nVari1         = 0;
     nVari2         = 0;

     &cDesc         = "";
     &eaCodigo      = "";
     &eaTipoCodigo  = "";
     &eaNombreList  = "";
     &eaSerie       = "";
     &eaNumero      = "";
     &eaCapi        = "";

     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;

{100}&epPuntEdita   = "";

     cMensa         = "";
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = enModoEdita + 100;
     |EDITA nBaffer, 0, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     enModoEdita = enModoEdita $ 100;
|FPRC;
------------------------------------------------------------------------------
|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabaAmpli;
     #8#0 = #7#0;
     #8#1 = #7#1;
     #8#2 = #7#2;
     #8#3 = #6#1;
     #8#4 = #6#2;
     #8#5 = #7#4;
     |GRABA 020#8n;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabBanc;
     |DDEFECTO #6;
     #6#0 = #8#0;
     #6#1 = #8#3;
     #6#2 = #8#4;
     |GRABA 020#6c;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE GrabBanc;
     #8#1;
     ;                                          ||Campos Extras.
     #7#0, #7#1, #7#2, #7#4,   1;
     #7#0, #7#1, #7#2, #7#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, GrabBanc;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Ampliada;

     |SI FSalida ! 16; |Y FSalida ! 10;
          |ACABA;
     |FINSI;

     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0811;
     enCuadroFin   = 2071;
     enCampoAncho  = 60;
     enModoEdita   = 0;

     |QBF eaCodigo;
     |QBF eaSerie;
     |QBF cDesc;

     |ABRE #7;
     |ABRE #8;
     #7#0 = eaCodigo;
     #7#1 = eaSerie;
     #7#2 = eaNumero;
     #7#4 = eaCapi;
     |LEE 000#7=;

     |SI FSalida ! 0;
          |GRABA 020#7b;
          |ABRE #5;
          #5#0 = #7#0;
          |LEE 000#5=;

          |SI FSalida = 0;
               |BUCLELIN 2 GrabaAmpli #5;
          |FINSI;

          |CIERRA #5;
     |FINSI;

     #7#3 = cDesc;
     |GRABA 020#7a;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #8#0 = eaCodigo;
           #8#1 = eaSerie;
           #8#2 = eaNumero;
           #8#5 = eaCapi;
           #8#3 = nVariable;
           |LIBERA #8;
           |LEE 101#8=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #8#4;
               |BORRA 020#8a;
           |FINSI;
     |SIGUE;

     |PUSHV  0501 2380;
     |COLOR 0, 2; |ATRI 0;
     |BLANCO 0506 2176;
     cDesc = cDesc % 130;
     cMensa = eaCodigo + "-" + cDesc;
     |COLOR 0, 7;|ATRI N;
     |PINTA 0611, "Concepto: ";
     |COLOR 9, 7;|ATRI N;
     |PINTA 0621, cMensa;
     |ATRI 0;
     PasoPorDes = 1;
     |HAZ Edita;
     |POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #8;
           #8#0 = eaCodigo;
           #8#1 = eaSerie;
           #8#2 = eaNumero;
           #8#5 = eaCapi;
           #8#3 = nVariable;
           |LIBERA #8;
           |LEE 101#8=;
           |SI FSalida ! 0;  |GRABA 020#8b;  |FINSI;
           #8#4 = epPuntEdita;
           |GRABA 020#8a;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #8#0 = eaCodigo;
           #8#1 = eaSerie;
           #8#2 = eaNumero;
           #8#5 = eaCapi;
           #8#3 = nVariable;
           |LIBERA #8;
           |LEE 101#8=;
           aAlfa = #8#4;  |QBF aAlfa;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#8a;
     |SIGUE;

     |CIERRA #8;

     |ABRE #9;
     #9#0 = "A";
     |LEE 000#9=;
     |SI FSalida = 0;
          |SI #9#27 = "S";
               |CONFI "0000NDesea actualizar el Banco de Descripciones Ampliadas";

               |SI FSalida = 0;
                    |ABRE #5;
                    |ABRE #6;
                    #5#0 = eaCodigo;
                    |LEE 000#5=;

                    |SI FSalida ! 0;
                         |GRABA 020#5c
                    |SINO;
                         |BUCLELIN 1 NULL #5;
                    |FINSI;

                    |BUCLELIN 2 GrabBanc #7;
                    #5#1 = cDesc;
                    |GRABA 020#5a;
                    |CIERRA #5;
                    |CIERRA #6;
               |FINSI;

          |FINSI;

     |FINSI;
     |CIERRA #9;
     |ERROR;
|FPRC;
------------------------------------------------------------------------------
|PROCESO DesAmpSuCap;
     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0811;
     enCuadroFin   = 2071;
     enCampoAncho  = 60;
     enModoEdita   = 0;
     |ABRE #22;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #22#0 = #21#0;
           #22#1 = #21#1;
           #22#2 = #21#2;
           #22#3 = nVariable;
           |LIBERA #22;
           |LEE 101#22=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #22#4;
               |BORRA 020#22a;
           |FINSI;
     |SIGUE;

     |PUSHV  0501 2380;
     |COLOR 0, 2; |ATRI 0;
     |BLANCO 0506 2176;
     |COLOR 9, 7;|ATRI N;
     |PINTA 0621, #21#3;
     |ATRI 0;

     |HAZ Edita;
     |POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #22;
           #22#0 = #21#0;
           #22#1 = #21#1;
           #22#2 = #21#2;
           #22#3 = nVariable;
           |LIBERA #22;
           |LEE 101#22=;
           |SI FSalida ! 0;  |GRABA 020#22b;  |FINSI;
           #22#4 = epPuntEdita;
           |GRABA 020#22a;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #22#0 = #21#0;
           #22#1 = #21#1;
           #22#2 = #21#2;
           #22#3 = nVariable;
           |LIBERA #22;
           |LEE 101#22=;
           aAlfa = #22#4;  |QBF aAlfa;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#22a;
     |SIGUE;

     |CIERRA #22;

|FPRC;
