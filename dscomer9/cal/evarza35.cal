  Copiado del evarz005

|FICHEROS;
||     evarz005 #0;
     evarm005 #2;
||     agifa024 #3;
     agifa007 #9;
     evarm006 #29;
     agifa073 #73;
     evarm004 #4;
     agifa024 #24;
     agifa104 #104;
||     evarm021 #21;
     evarm042 #42;
|FIN;

|VARIABLES;
     &nError = 0;
     nPrime = 0;
     nSwImp = 0;
     &nSwAbreImpre = -1;
     &barra  = "";
     &barra2 = "";
     etiq = "";
     &uni = 0;
     &talla = "";
     &color = "";
     &manga = "";
     &pecho = 0;
     &cintura = 0;
     &talle = 0;
     &espalda = 0;
     &lfalda = 0;
     &ltotal = 0;
     &lmanga = 0;
     &pu¤o = 0;
     &bultos = 0;
     marca = "";
     informe = "";
     cta1 = "";
     cta = "";
     esc = "";
     tt = "";
     aAlfa = "";
     nSw = 0;

     &eaTalla = "";
     &eaPecho = "";
     &eaCintura = "";
     &eaEspalda = "";
     &eaLManga = "";
     &eaPuno = "";
     &eaFalda = "";
     &eaLFalda = "";
     &eaLTotal = "";
     &eaTalle = "";

     aDife = "";
     nDife = 0;
     nDife1 = 0;
     nDife2 = 0;
     nVal1 = 0;
     nVal2 = 0;
     aTalla1 = "";
     aTalla2 = "";
|FIN;

|PROCESO Diferencia;
     |SI nVal2 = 0;
        aDife = "+0";
     |SINO;
          nDife = nVal2 - nVal1;
          |SI nDife ] 0;
               aDife = "+" + nDife;
          |SINO;
               aDife =  nDife;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MedidasEspeciales;
     eaTalla = "";
     eaPecho = "";
     eaCintura = "";
     eaEspalda = "";
     eaLManga = "";
     eaPuno = "";
     eaFalda = "";
     eaLFalda = "";
     eaLTotal = "";
     eaTalle = "";
     |SI talla = "Especial";
          |ABRE #42;
          |SELECT #2#42;
          #42#1 = #4#18;
          |LEE 000#42];
          |SI FSalida = 0;
               |LEE 000#42a;
          |SINO;
               |LEE 000#42u;
          |FINSI;
          nDife1 = #42#1 - #4#18;
          |SI nDife1 < 0; nDife1 = -nDife1; |FINSI;
          aTalla1 = #42#0;

          |LEE 000#42s;
          |SI FSalida ! 0; |DDEFECTO #42; |FINSI;
          nDife2 = #42#1 - #4#18;
          |SI nDife2 < 0; nDife2 = -nDife2; |FINSI;
          aTalla2 = #42#0;

          |SELECT #1#42;
          |SI nDife1 < nDife2;
               #42#0 = aTalla1;
          |SINO;
               #42#0 = aTalla2;
          |FINSI;
          |LEE 000#42=;

          eaTalla = #42#0;

          nVal1 = #42#1; nVal2 = #4#18; |HAZ Diferencia;
          eaPecho = aDife;

          nVal1 = #42#2; nVal2 = #4#19; |HAZ Diferencia;
          eaCintura = aDife;

          nVal1 = #42#3; nVal2 = #4#21; |HAZ Diferencia;
          eaEspalda = aDife;

          nVal1 = #42#7; nVal2 = #4#24; |HAZ Diferencia;
          eaLManga = aDife;

          nVal1 = #42#8; nVal2 = #4#25; |HAZ Diferencia;
          eaPuno = aDife;


          |SELECT #3#42;
          #42#5 = #4#22;
          |LEE 000#42];
          |SI FSalida = 0;
               |LEE 000#42a;
          |SINO;
               |LEE 000#42u;
          |FINSI;
          nDife1 = #42#1 - #4#18;
          |SI nDife1 < 0; nDife1 = -nDife1; |FINSI;
          aTalla1 = #42#0;

          |LEE 000#42s;
          |SI FSalida ! 0; |DDEFECTO #42; |FINSI;
          nDife2 = #42#1 - #4#18;
          |SI nDife2 < 0; nDife2 = -nDife2; |FINSI;
          aTalla2 = #42#0;

          |SELECT #1#42;
          |SI nDife1 < nDife2;
               #42#0 = aTalla1;
          |SINO;
               #42#0 = aTalla2;
          |FINSI;
          |LEE 000#42=;

          eaFalda = #42#0;

          nVal1 = #42#5; nVal2 = #4#22; |HAZ Diferencia;
          eaLFalda = aDife;

          nVal1 = #42#6; nVal2 = #4#23; |HAZ Diferencia;
          eaLTotal = aDife;

          nVal1 = #42#4; nVal2 = #4#20; |HAZ Diferencia;
          eaTalle = aDife;
     |FINSI;
|FPRC;

|PROCESO Barra;
     barra = " ";
     barra = barra + "  ";
     esc = &027+"027";
     barra = barra + esc;
     barra = barra + &20;
     barra = barra + &18;
     barra = barra + "R";
     barra = barra + "2";
     barra = barra + &24;
     barra = barra + &60;
     barra = barra + &1;
     barra = barra + etiq;
     barra = barra + "  ";
     barra = barra + "  ";
     barra = barra + " ";
     barra = barra + &10;
|FPRC;

|CALCULO printalla1;
     |SI nPrime = 0;
          |IMPRE 1;
          nSwAbreImpre = FSalida;
          nPrime = 1;
     |FINSI;

     |SI nSwAbreImpre ! 0;
          nError = 1;
          |ACABA;
     |FINSI;

     informe = "evaetiq";
     |ABRE #29;
     #29#0 = #agifa073#28;
     |LEE 000#29=;
     |SI 0 = FSalida;
          informe = #29#22;
     |FINSI;
     |CIERRA #29;

     |HAZ MedidasEspeciales;

     |QBT informe;
     |INFOR informe;
     |SI FSalida = 0;
          |PARA bultos = 1;|SI bultos [ uni;|HACIENDO bultos = bultos + 1;
               barra2 = etiq;
               |HAZ Barra;
               |PRINT;
               |PIEINF;
          |SIGUE;
          |FININF;
     |SINO;
          aAlfa = "0000Error en informe '" + informe + "'";
          |MENAV aAlfa;
          nError = 1;
     |FINSI;
|FCAL;

|CALCULO vertalla1;
  uni = 0;
  talla = "";
  color = "";
  manga = "";
  pecho = 0;
  cintura = 0;
  talle = 0;
  espalda = 0;
  lfalda = 0;
  ltotal = 0;
  lmanga = 0;
  pu¤o = 0;

  uni = 1;
  talla = #2#4; |QBF talla;
  etiq = #2#0; |QBF etiq;

  |SI talla = "80";  tt = "01"; |HAZ printalla1; |FINSI;
  |SI talla = "85";  tt = "02"; |HAZ printalla1; |FINSI;
  |SI talla = "90";  tt = "03"; |HAZ printalla1; |FINSI;
  |SI talla = "95";  tt = "04"; |HAZ printalla1; |FINSI;
  |SI talla = "100"; tt = "05"; |HAZ printalla1; |FINSI;
  |SI talla = "105"; tt = "06"; |HAZ printalla1; |FINSI;
  |SI talla = "110"; tt = "07"; |HAZ printalla1; |FINSI;
  |SI talla = "115"; tt = "08"; |HAZ printalla1; |FINSI;
  |SI talla = "120"; tt = "09"; |HAZ printalla1; |FINSI;
  |SI talla = "125"; tt = "10"; |HAZ printalla1; |FINSI;
  |SI talla = "130"; tt = "11"; |HAZ printalla1; |FINSI;
  |SI talla = "135"; tt = "12"; |HAZ printalla1; |FINSI;
  |SI talla = "140"; tt = "14"; |HAZ printalla1; |FINSI;
  |SI talla = "Compleme"; tt = "15"; |HAZ printalla1; |FINSI;
  |SI talla = "70"; tt = "16"; |HAZ printalla1; |FINSI;
  |SI talla = "75"; tt = "17"; |HAZ printalla1; |FINSI;

  |SI talla = "3M"; tt = "18"; |HAZ printalla1; |FINSI;
  |SI talla = "6M"; tt = "19"; |HAZ printalla1; |FINSI;
  |SI talla = "9M"; tt = "20"; |HAZ printalla1; |FINSI;
  |SI talla = "18M"; tt = "21"; |HAZ printalla1; |FINSI;

  |SI talla = "Especial";
      tt = "13";
      color = #evarm004#16;
      manga = #evarm004#17;
      pecho = #evarm004#18;
      cintura = #evarm004#19;
      talle = #evarm004#20;
      espalda = #evarm004#21;
      lfalda = #evarm004#22;
      ltotal = #evarm004#23;
      lmanga = #evarm004#24;
      pu¤o = #evarm004#25;
      |HAZ printalla1;
  |FINSI;
|FCAL;

|PROCESO Imprime;
     |ABRE #104;
     #104#25 = #2#1;
     #104#0 = #2#6;
     |LEE 020#104=;
     |SI FSalida = 0;
          |ABRE #73;
          #73#28 = #2#1;
          #73#0 = #2#6;
          #73#1 = #2#7;
          |LEE 020#73=;
          |SI FSalida = 0;
               |ABRE #4;
               #4#30 = #2#1;
               #4#31 = #2#6;
               #4#32 = #2#7;
               |LEE 020#4=;
               |SI FSalida = 0;
                    |ABRE #24;
                    #24#0 = #104#4;
                    |LEE 020#24=;
                    |SI FSalida = 0;
                         |HAZ vertalla1;
                    |FINSI;
                    |CIERRA #24;
               |FINSI;
               |CIERRA #4;
          |FINSI;
          |CIERRA #73;
     |FINSI;
     |CIERRA #104;
|FPRC;
