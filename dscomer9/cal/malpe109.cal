|FICHEROS;
     malpe109 #0;
     malpe004 #4;
     malpe090 #90;
|FIN;

|VARIABLES;
     nConta = 0;
     nModo = 0;
     aAlfa = "";
|FIN;

|PROCESO Contador; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |CONFI "0000NImprimir Documento";
     |SI FSalida = 0;
          |HAZ Tipo4;
     |FINSI;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "malpe109";
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe malpe109";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ABRE #90;
          |ABRE #4;
          |SELECT #4#4;
          #4#32 = #0#0;
          |LEE 101#4=;
          |SI FSalida = 0;
               |DDEFECTO #90;
               #90#52 = #4#0;
               #90#0 = #4#17;
               |LEE 101#90=;
               |SI FSalida = 0; |Y #90#38 = "N";
                    #90#51 = "N";
                    |GRABA 020#90a;
               |FINSI;
               |SI #90#38 = "N";
                    #4#29 = "01.01.0000";
                    #4#30 = "";
                    #4#32 = 0;
                    |GRABA 020#4a;
               |SINO;
                    aAlfa = "0000Albaran " + #90#52 + "/" + (("000000" + #90#0) % -106) + " facturado";
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
          |FINSI;
          |CIERRA #90;
          |CIERRA #4;
     |FINSI;
|FPRC;
