|FICHEROS;
     fergam02 #0;
     fergam03 #1,MANTE;
     fergam06 #6;
     fergam07 #7;
     fergam08 #8;
     fergam11 #11;
     agifa019 #19;
     dsm00024 #24;
     referen@;
|FIN;

|VARIABLES;
     i = 0;
     aPartiAnt = "";
     nPanta = 0;
     nModo = 0;
     nModoEntra = 0;
     aAlfa = "";
     nGrid1 = -1;
     nRango = 0;
     nForma = 0;
     nId = 0;
     nLin = 0;
     nBtnConsulta = -1;
     nGrid = 0;
     nNum = 0;
|FIN;

|PROCESO Evento;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#1;
          |LEE 000#1=;
     |FINSI;
     |SI FSalida = 4;
     |FINSI;
|FPRC;

|PROCESO Min;
     #1#0 = #0#0;
     #1#1 = 001;
|FPRC;

|PROCESO Max;
     #1#0 = #0#0;
     #1#1 = 999;
|FPRC;

|PROCESO Lineal;
     nRango = 1 + 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#1, nRango, 1402, 2398, Min, Max, Evento;
     nGrid1 = FSalida;
|FPRC;

|PROCESO T3_14; |TIPO 14;    ||(*)
     |SI nGrid1 = -1;
          |HAZ Lineal;
     |FINSI;
|FPRC;

|PROCESO T3_8; |TIPO 8; ||(*)
     |ABRET #1;
|FPRC;

|PROCESO T3_9; |TIPO 9; ||(*)
     |CIERRAT #1;
|FPRC;

|PROCESO BorraLin;
     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1;
     ;
     #0#0, 001;
     #0#0, 999;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO T3_2; |TIPO 2; ||(*)
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;
     |SI nModo = 3;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO T3_0; |TIPO 0;     ||(*)
     aAlfa  = "|X000"; aAlfa = #0aAlfa; nId = aAlfa;
     |ESTADO_CONTROL nId, "ENABLE";

     |REFRESCACONTROL nGrid1;
|FPRC

|PROCESO T3_12; |TIPO 12;    ||(*)
     |SI nModoEntra = 1; |Y FSalida = 7;
          |BUCLE BorraLin;
     |FINSI;
|FPRC;

|PROCESO T3_30; |TIPO 30;    ||(*)
     nModo = (FEntrada / 100) ! 0;

     |SI #0#2 = "S";
          #1#0 = #0#0;
          #1#1 = 1;
          |LEE 000#1];
          |SI FSalida ! 0; |O #1#0 ! #0#0;
               |SI nModo = 1;
                    |MENAV "0000Se anulan los datos entrados.";
               |SINO;
                    |MENAV "0000No existen lineas, se borra la cabecera.";
               |FINSI;
               |BORRA 020#0a;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO T3_13; |TIPO 13;
     |PINPA #0#0; nPanta = FSalida;
|FPRC;

|PROCESO T3_20; |TIPO 20;
     nModo = (FEntrada / 100) ! 0;
     |SI FSalida = "OPCION";
          FSalida = "";
     |SINO;
     |FINSI;
|FPRC;

|PROCESO T3_7; |TIPO 7;
     nModoEntra = (FEntrada / 100) ! 0;
     |SI nModoEntra = 1;
          aAlfa  = "|X000"; aAlfa = #0aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "DISABLE";

          |HAZ DefNumero;
     |FINSI;
|FPRC;

|PROCESO T3_1_7; |TIPO 7;
     nModoEntra = (FEntrada / 100) ! 0;
     |SI nModoEntra = 1;
          |BUCLE BorraLin;
          |REFRESCACONTROL nGrid1;
     |FINSI;
     |ESTADO_CONTROL nBtnConsulta, "DISABLE";
     |HAZ TipoMaq;
|FPRC;

|PROCESO DefeLin; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #1#0 = #0#0;
          #1#1 = 999;
          |LEE 000#1];
          |SI FSalida = 0;
               |LEE 000#1a;
          |SINO;
               |LEE 000#1u;
          |FINSI;
          |SI FSalida = 0; |Y #1#0 = #0#0;
               nLin = #1#1 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #1;
          #1#0 = #0#0;
          #1#1 = nLin; |PINTA #1#1;
          aAlfa  = "|X000"; aAlfa = #0aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO DefNumero;
     |LEE 000#0u;
     |SI FSalida = 0;
          nNum = #0#0 + 1;
     |SINO;
          nNum = 1;
     |FINSI;
     |DDEFECTO #0;
     aAlfa = ("000" + nNum) % -103;
     #0#0 = aAlfa;
|FPRC;

|PROCESO Articulo0; |TIPO 0;
     |ABRE #19;
     #19#0 = #1#2;
     |LEE 000#19=;
     |SI FSalida ! 0;
          |MENAV "0000No existe artículo...";
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Articulo66; |TIPO 66;
     |ABRE #19;
     #19#0 = #1#2;
     |LEE 000#19];
     |CONSULTA_CLAVE #1#19;
     |SI FSalida = 0;
          #1#2 = #19#0; |PINTA #1#2;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Partida0; |TIPO 0;
     |ABRE #24;
     #24#0 = #1#2;
     #24#1 = #1#3;
     #24#2 = #1#4;
     |LEE 000#24=;
     |SI FSalida ! 0;
          |GRABA 020#24n;
/*
          aAlfa = "*fergaz06;" + #24#0 + #24#2 + #24#1;
          |SUB_EJECUTA_NP aAlfa;
          #24#0 = #1#2;
          #24#1 = #1#3;
          #24#2 = #1#4;
          |LEE 000#24=;
          |SI FSalida ! 0; |ERROR; |FINSI;
*/
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO Min24;
     #24#0 = #1#2;
     #24#1 = #1#3;
     #24#2 = "                              ";
|FPRC;

|PROCESO Max24;
     #24#0 = #1#2;
     #24#1 = #1#3;
     #24#2 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Partida66; |TIPO 66;
     |ABRE #24;
     #24#0 = #1#2;
     #24#1 = #1#3;
     #24#2 = #1#4;
     |LEE 000#24];
     |CONSULTA_F_CLAVE #1#24, Min24, Max24;
     |SI FSalida = 0;
          #1#4 = #24#2; |PINTA #1#4;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO Maqui0; |TIPO 0;
     |DDEF aAlfa;
     aAlfa = aAlfa + "fergam02";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #1#6;
          |LEE 000#referen@.=;
          |SI FSalida ! 0;
               |MENAV "0000No existe maquina...";
               |ERROR;
          |SINO;
               #1#7 = #referen@#1; |PINTA #1#7;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Maqui66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "fergam02";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #1#6;
          |LEE 000#referen@.];
          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #1#6 = #referen@#0; |PINTA #1#6;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO TipoMaq; |TIPO 0;
     |SI #0Campo = "S";
          |PARA i = 2; |SI i [ 5; |HACIENDO i = i + 1;
               |SI i ! Campo;
                    #0i = "N"; |PINTA #0i;
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Lin; |TIPO 0;
     |SI #0#2 = "N";
          |AVISO; |ERROR; |PTEC 807;
     |SINO;
          aPartiAnt = #1#4;
     |FINSI;
|FPRC;

|PROCESO CompoOrden;
     #8#0 = #7#0;
     #8#1 = #7#1;
     #8#2 = 999;
     |LEE 000#8];
     |SI FSalida = 0;
          |LEE 000#8a;
     |SINO;
          |LEE 000#8u;
     |FINSI;
     |SI FSalida = 0; |Y #8#0 = #7#0; |Y #8#1 = #7#1;
          aAlfa = #8#6; |QBF aAlfa;
          |SI aAlfa = "";
               |DDEFECTO #11;
               #11#0 = #7#0;
               #11#1 = #7#1;
               #11#2 = #1#4;
               |LEE 000#11=;
               |SI FSalida ! 0;
                    |GRABA 020#11n;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE CompoOrden;
     #7#1;
     2;
     #6#0, 001, #1#2;
     #6#0, 999, #1#2;
     ;
     NULL, CompoOrden;
|FIN;

|PROCESO Ordenes;
     |BUCLE CompoOrden;
|FPRC;

|DEFBUCLE Ordenes;
     #6#2;
     ;
     "N", 000001;
     "N", 999999;
     ;
     NULL, Ordenes;
|FIN;

|PROCESO T2Lin; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;
     |SI nModo = 2; |Y nForma = 1; |Y aPartiAnt ! #1#4;
          |CONFI "0000S¨Asignar partidas a las ordenes en curso?";
          |SI FSalida = 0;
               |ABRE #11;
               |ABRE #8;
               |BUCLE Ordenes;
               |CIERRA #8;
               |CIERRA #11;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO T80Maq; |TIPO 80;
     FSalida = 2499;
|FPRC;
