|FICHEROS;
     diefaz06;
     agifa059;
     agifa010;
     agifa134;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;

     nCuantos = 0;
|FIN;
____________________________________/
|PROCESO agifa059;
     #agifa134#49 = #agifa059#14;
     #agifa134#0 = #agifa059#0;
     |LEE 000#agifa134.=;

     #agifa010#52 = #agifa059#15;
     #agifa010#0 = #agifa059#2;
     |LEE 101#agifa010.=;
     |SI FSalida = 0;
          |SI #agifa010#38 = "N";|O #agifa010#39 = 0;
               |SI nModo = 0;
                    aAlfa1 = "0000Albaran[" + #agifa010#52 + "." + #agifa010#0 + "] no facturado. Factura [" + #agifa059#14 + "." + #agifa059#0 + "]";
                    |MENAV aAlfa1;

                    |AVISO;
                    |CONFI "0000SContinuar avisando: ";
                    nModo = FSalida;
               |FINSI;

               #agifa010#10 = #agifa134#45;       || factura impresa S/N
               #agifa010#38 = "S";                || facturado S/N
               #agifa010#53 = #agifa059#14;       || serie fra.
               #agifa010#39 = #agifa059#0;        || numero fra.
               |GRABA 020#agifa010.a;
               |SI FSalida = 0;
                    nCuantos = nCuantos + 1;
               |FINSI;
          |FINSI;
     |SINO;
          aAlfa1 = "0000Albaran[" + #agifa010#52 + "." + #agifa010#0 + "] inaccesible. Factura [" + #agifa059#14 + "." + #agifa059#0 + "]";
          |MENAV aAlfa1;
     |FINSI;
     |LIBERA #agifa010;
|FPRC;

|DEFBUCLE agifa059;
     #agifa059#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa059;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #diefaz06#0 = "SI";
          |ABRE #agifa010;
          |ABRE #agifa134;
          |BUCLE agifa059;
          |CIERRA #agifa010;
          |CIERRA #agifa134;
          |SI nCuantos ! 0;
               aAlfa1 = "0000[" + nCuantos + "] albaranes erroneos recuperados.";
               |MENAV aAlfa1;
          |SINO;
               |MENAV "0000Ningun albaran erroneo.";
          |FINSI;
     |FINSI;
|FPRC;
