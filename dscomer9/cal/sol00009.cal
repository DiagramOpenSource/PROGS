          ImprimeWord

|FICHEROS;
     solm0001 #1;
     solm0009 #9;
     solm0010 #10;
     solm0011 #11;
     agifa024 #24;
|FIN;

|VARIABLES;
     nDe = 0;
     nIz = 0;
     aLon = "";
     aIz = "";
     aDe = "";
     nPos = 0;
     aAlfa1 = "";
     aSal = "";

     aPrecio = "";
     nPrecio = 0;
     aNonGes = "";
     aCifGes = "";
     aDomGes = "";
     aPobGes = "";
     aProGes = "";
     aIP = "";
     aFic = "";
     {1000}CamWord = "";
     nCamWord = 0;
     aAsigna = "";
     aAlfa = "";
     aDes = "";
     nWord = 0;
     aCadena = "";
     aLen = "";
     nLen = 0;
     aCaracter = "";
     nPosi = 0;
     nCampo = 0;
|FIN;

|| NO SE USA
|| Entra aAlfa con la cadena y retorna aAlfa;
|PROCESO LetraMasculino;
     |LETRA aAlfa;                 ||Siempre es femenino
     aAlfa1 = aAlfa - "UNA";
     aLon = aAlfa % A0;
     |PARA; |SI FSalida ! 0; |HACIENDO;
          aSal = "0000" + FSalida;
          aIz = aSal % -302;

          nIz = aIz - 1; aIz = ("00" + nIz) % -102;
          nDe = aLon; nDe = nDe - nIz - 3; aDe = ("00" + nDe) % -102;

          aIz = "01" + aIz;
          nPos = aIz;
          aIz = aAlfa % nPos;

          aDe = "-01" + aDe;
          nPos = aDe;
          aDe = aAlfa % nPos;
          aAlfa = aIz + "UNO" + aDe;
          aAlfa1 = aAlfa - "UNA";
     |SIGUE;
|FPRC;

|PROCESO xQuitaRaros;
     |QBF aAlfa;
     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPosi = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO aSignaCampo;
     |HAZ xQuitaRaros;
     ICamWord = CamWord1<-;
     ICamWord = ICamWord + (nCamWord);
     CamWord = aAsigna;
     ICamWord = ICamWord + 1;
     CamWord = aAlfa;
     nCamWord = nCamWord + 2;
|FPRC;

|PROCESO ImprimeWord;
     aIP = "";
     |IP_LOCAL aIP;

     aFic = #9#4; |QBF aFic;
     |SI aIP = "";
          |XABRE "E", aFic, 0;
     |SINO;
          |XABRE "CE", aFic, 0;
     |FINSI;
     |SI FSalida < 0;
          |MENAV "0000No existe documento word";
          |ACABA;
     |FINSI;
     aDes = "C:/DOCUMENTOS";
     |RMKDIR aDes;
     aDes = aDes + "/WORD";
     |RMKDIR aDes;
     aDes = aDes + "/" + (("0000" + #9#0) % -104) + (("0000" + #9#1) % -104);
     |RCOPIA_FICHERO aFic, aDes;

     |MENSA "      Abriendo el Documento, espere un Momento.";
     |WORD_ABRE nWord, aDes;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |MENSA "      Asignando Campos al Documento, espere un momento.";
     nCamWord = 0;
     |HAZ AsignaCampos;
     ICamWord = CamWord1<-;
     nCamWord = nCamWord / 2;
     aAlfa = nCamWord; |QBT aAlfa;
     |WORD_ASIGNA_TEXTO nWord, aAlfa, CamWord;

     |MENSA "      Mostrando Documento.";
     |WORD_PROPIEDADES nWord, "Visible", "SI";
     |PARA FSalida = "NO"; |SI FSalida = "NO";  |HACIENDO;
           |PULSATECLA;
           |WORD_PROPIEDADES nWord, "Quit", "";
     |SIGUE;
     |MENSA "     ";
|FPRC;

|PROCESO AsignaLin;
     |SI #10#9 = "D1";
          aAsigna = "#ID1#"; aAlfa = #10#6; |HAZ aSignaCampo;
          aAlfa = "E" + #10#6;
          |LETRA aAlfa;
          aAsigna = "#ID1L#"; |HAZ aSignaCampo;

          aAsigna = "#PID1#"; aAlfa = #10#5; |HAZ aSignaCampo;
     |FINSI;
     |SI #10#9 = "D2";
          aAsigna = "#ID2#"; aAlfa = #10#6; |HAZ aSignaCampo;
          aAlfa = "E" + #10#6;
          |LETRA aAlfa;
          aAsigna = "#ID2L#"; |HAZ aSignaCampo;

          aAsigna = "#PID2#"; aAlfa = #10#5; |HAZ aSignaCampo;
     |FINSI;
     |SI #10#9 = "D3";
          aAsigna = "#ID3#"; aAlfa = #10#6; |HAZ aSignaCampo;
          aAlfa = "E" + #10#6;
          |LETRA aAlfa;
          aAsigna = "#ID3L#"; |HAZ aSignaCampo;

          aAsigna = "#PID3#"; aAlfa = #10#5; |HAZ aSignaCampo;
     |FINSI;
     |SI #10#9 = "D4";
          aAsigna = "#ID4#"; aAlfa = #10#6; |HAZ aSignaCampo;
          aAlfa = "E" + #10#6;
          |LETRA aAlfa;
          aAsigna = "#ID4L#"; |HAZ aSignaCampo;

          aAsigna = "#PID4#"; aAlfa = #10#5; |HAZ aSignaCampo;
     |FINSI;
|FPRC;

|PROCESO AsignaCampos;
     |ABRE #1;
     |ABRE #11;
     |ABRE #24;

     aAsigna = "#FECHAC#"; aAlfa = #9#5; |HAZ aSignaCampo;

||     aAlfa = (("0000" + #9#0) % -104) + " ";
||     aAlfa = aAlfa + (("0000" + #9#1) % -104) + "/";
||     aAlfa = aAlfa + (#9#5 % -104);

     aAlfa = #9#3 + (#9#5 % -104) + " " + (("0000" + #9#1) % -104);

     aAsigna = "#CONTRATO#";  |HAZ aSignaCampo;

     |DDEFECTO #11;
     #11#0 = #9#6;
     |LEE 000#11=;
     aAsigna = "#NF1#"; aAlfa = #11#1; |HAZ aSignaCampo;
     aAsigna = "#DNIF1#"; aAlfa = #11#2; |HAZ aSignaCampo;

     |DDEFECTO #11;
     #11#0 = #9#7;
     |LEE 000#11=;
     aAsigna = "#NF2#"; aAlfa = #11#1; |HAZ aSignaCampo;
     aAsigna = "#DNIF2#"; aAlfa = #11#2; |HAZ aSignaCampo;

     aAsigna = "#NOMBREPRO#"; aAlfa = #48#1; |HAZ aSignaCampo;

     |DDEFECTO #24;
     #24#0 = #9#2;
     |LEE 000#24=;
     aAlfa = #9#8; |QBF aAlfa;
     |SI aAlfa = ""; aAlfa = #24#1; |FINSI;
     aAsigna = "#NOMBRECLI#"; |HAZ aSignaCampo;

     aAlfa = #9#9; |QBF aAlfa;
     |SI aAlfa = ""; aAlfa = #24#15; |FINSI;
     aAsigna = "#DNICLI#"; |HAZ aSignaCampo;

     aAlfa = #9#8; |QBF aAlfa;
     |SI aAlfa ! "";
          aNonGes = #24#1; |QBF aNonGes;
          aCifGes = #24#15; |QBF aCifGes;
          aDomGes = #24#8; |QBF aDomGes;
          aPobGes = #24#9; |QBF aPobGes;
          aProGes = #24#10; |QBF aProGes;
          aAlfa = "actuando en nombre y representacion de la mercantil " + aNonGes;
          aAlfa = aAlfa + ", con CIF " + aCifGes;
          aAlfa = aAlfa + ", y domiciliada en " + aDomGes + "," + aPobGes + " " + aProGes;
     |FINSI;
     aAsigna = "#TEXTOEMPRESA#"; |HAZ aSignaCampo;

     |DDEFECTO #1;
     #1#0 = #9#0;
     |LEE 000#1=;
     aAsigna = "#NOMBREPROMO#"; aAlfa = #1#1; |HAZ aSignaCampo;
     aAsigna = "#TM#"; aAlfa = #1#2; |HAZ aSignaCampo;
     aAsigna = "#NI#"; aAlfa = #1#3; |HAZ aSignaCampo;

     |SI #9#10 = 1;
          aAlfa = "UNA INSTALACION";
     |SINO;
          aAlfa = #9#10;
          |LETRA aAlfa;
          aAlfa = aAlfa + " INSTALACIONES";
     |FINSI;
     aAsigna = "#NIC#";  |HAZ aSignaCampo;

     aAsigna = "#NPRO#"; aAlfa = #1#4; |HAZ aSignaCampo;
     aAsigna = "#LHU#"; aAlfa = #1#5; |HAZ aSignaCampo;
     aAsigna = "#PHU#"; aAlfa = #1#6; |HAZ aSignaCampo;
     aAsigna = "#PARCELAS#"; aAlfa = #1#7; |HAZ aSignaCampo;
     aAsigna = "#SP#"; aAlfa = #1#8; |HAZ aSignaCampo;

     aPrecio = #9#11;
     aAsigna = "#PTN#"; aAlfa = aPrecio; |HAZ aSignaCampo;
     aPrecio = "E" + aPrecio;
     |LETRA aPrecio;
     aAsigna = "#PTL#"; aAlfa = aPrecio; |HAZ aSignaCampo;

     aAsigna = "#IPE#"; aAlfa = #9#12; |HAZ aSignaCampo;
     aAlfa = "E" + #9#12;
     |LETRA aAlfa;
     aAsigna = "#IPEL#"; |HAZ aSignaCampo;

     aAsigna = "#PIPE#"; aAlfa = #9#13; |HAZ aSignaCampo;

     aAsigna = "#IDE#"; aAlfa = #9#14; |HAZ aSignaCampo;
     aAlfa = "E" + #9#14;
     |LETRA aAlfa;
     aAsigna = "#IDEL#"; |HAZ aSignaCampo;

     aAsigna = "#PIDE#"; aAlfa = #9#15; |HAZ aSignaCampo;
     aAsigna = "#IDE#"; aAlfa = #9#14; |HAZ aSignaCampo;
     aAsigna = "#IFO#"; aAlfa = #9#16; |HAZ aSignaCampo;
     aAlfa = "E" + #9#16;
     |LETRA aAlfa;
     aAsigna = "#IFOL#"; |HAZ aSignaCampo;

     aAsigna = "#PIFO#"; aAlfa = #9#17; |HAZ aSignaCampo;
     aAsigna = "#PORMAN#"; aAlfa = #9#18; |HAZ aSignaCampo;

     aAsigna = "#POTENCIAL#"; aAlfa = #9#26; |HAZ aSignaCampo;

     |BUCLELIN 2 AsignaLin #9;

     |CIERRA #1;
     |CIERRA #11;
     |CIERRA #24;
|FPRC;
