|FICHEROS;
     agifa137 #0;
     agifa007 #7;
     agifa090 #90;
     agifa074 #74;
     agifa142 #142;
     dsm00052 #52;
     dsm00067 #67;
     agifa019 #19;
|FIN;

|INCLUYE i_varart;

|VARIABLES;
     Impresora = "";
     &Tempo    = "";
     aInforme  = "agifa090";

     &tipo     = 0;      || Para Impresion
     &SwCompo  = 0;

     &enOrden  = 0;
     &eaReimp  = "";
     &eaCompo  = "";
     aAlfa = "";

     aImprime = "";
     aFormato = "";
|FIN;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dsm00052;
     |PRINT;
|FPRC;

|DEFBUCLE dsm00052;
     #52#1;
     ;
     #74#9, #74#0, #74#1, 001;
     #74#9, #74#0, #74#1, 999;
     ;
     NULL, dsm00052;
|FIN;

|PROCESO Lineas;
     eaSerLog = #90#20;
     eaNumLog = (A\("000000" + #90#0) % -106);
     eaTipLog = "OR";
     |HAZ ImprimeLog;

     #67#0 = #74#9;
     #67#1 = #74#0;
     #67#2 = #74#1;
     #67#3 = "";
     |LEE 000#67];
     |SI FSalida ! 0; |O #67#0 ! #74#9; |O #67#1 ! #74#0; |O #67#2 ! #74#1;
          |DDEFECTO #67;
     |FINSI;

     tipo = 0; |PRINT;

     |SI SwCompo = 1;
          tipo = 1;
          |BUCLE dsm00052;
     |FINSI;

     |SI #142#59 = "S"; |PIEINF; |FINSI;
|FPRC;

|PROCESO FinCab;
     |SI #142#59 ! "S"; |PIEINF; |FINSI;
     |FININF;

     #90#9 = "S";
     |GRABA 020#90a;
|FPRC;

|PROCESO Cab;
     |DDEFECTO #7;
     #7#26 = #90#20;
     |LEE 000#7=;

     aInforme = #7#51; |QBF aInforme;
     |INFOR aInforme;

     |SI FSalida ! 0;
          aAlfa = "0000Error informe:" + aInforme;
          |MENAV aAlfa;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE agifa090;
     #90#2;
     9;
     #0#2, #0#6, #0#0, #0#4;
     #0#3, #0#7, #0#1, #0#4;
     be;
     NULL, Cab, Lineas, FinCab;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |SI #0#5 = "S"; SwCompo = 1; |FINSI;

     |SI #0#8 = "S";
          |HAZ ImpCrystal;
     |SINO;
          |IMPRE 0;
          |SI FSalida  = 0;
               |ABRE #7;
               |ABRE #67;
               |ABRE #19;
               |BUCLE agifa090;
               |CIERRA #19;
               |CIERRA #67;
               |CIERRA #7;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Crystal; |TIPO 0;
     aAlfa = #0#8;
     |C_M #0#9, 1, aAlfa;
|FPRC;

|PROGRAMA;
     |HAZ EsBerria;
     |SI FSalida = 0; |CORRE "berz0006"; |FINSI;
     |HAZ EsDefelino;
     |SI FSalida = 0; |CORRE "defelz02"; |FINSI;

     |HAZ MiraLogos; || Copia Logos para el Crystal
     |SI enOrden = 0;
          |ABRE #0;
          |LEE 000#0p;   || sin bloqueo
          |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
          aImprime = #0#8;
          aFormato = #0#9;
          |DDEFECTO #0;
          #0#8 = aImprime;
          #0#9 = aFormato;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0; |GRABA 020#0a; |FINSI;
          |CIERRA #0;
     |SINO;
          #0#6 = eaSerie;
          #0#7 = eaSerie;
          #0#0 = enOrden;
          #0#1 = enOrden;
          #0#2 = "01.01.0000";
          #0#3 = "31.12.9999";
          #0#4 = eaReimp;
          #0#5 = eaCompo;
          |HAZ Tipo3;
     |FINSI;
|FPRO;
