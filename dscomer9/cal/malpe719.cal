|FICHEROS;
     malpe719 #0;
     agifa059 #59;
     malpe087 #87;
     malpe088 #88;
     malpe090 #90;
     malpe091 #91;
     agifa134 #134;
     malpe716 #716; || Estadistica
     malpe718 #718;
     malpe723 #723;
|FIN;

|VARIABLES;
     aMes = "";
     aAno = "";
     aDAno = "";
     aHAno = "";
|FIN;

|PROCESO Albaranes;
     #723#0 = #91#2;
     |LEE 000#723=;
     |SI FSalida = 0; |ACABA; |FINSI;

     aMes = #134#1 % 402;
     |DDEFECTO #716;
     #716#0 = aAno;
     #716#1 = aMes;
     #716#2 = #134#7;
     #716#3 = #91#3;
     |LEE 101#716=;
     |SI FSalida ! 0; |GRABA 020#716b; |FINSI;
     #716#7 = #716#7 + #91#5;
     #716#10 = #716#10 + (#91#5 * #91#67);
     |GRABA 020#716a;
     |LIBERA #716;
|FPRC;

|DEFBUCLE Albaranes;
     #91#1;
     ;
     #59#15, #59#2, 001;
     #59#15, #59#2, 999;
     ;
     NULL, Albaranes;
|FIN;

|PROCESO Facturas;
     |BUCLE Albaranes;
|FPRC;

|DEFBUCLE Facturas;
     #134#2;
     ;
     "      ", aDAno, "     ", 000001;
     "zzzzzz", aHAno, "zzzzz", 999999;
     ;
     NULL, NULL, Facturas;
|FIN;

|PROCESO Pedidos;
     #723#0 = #88#2;
     |LEE 000#723=;
     |SI FSalida = 0; |ACABA; |FINSI;

     aMes = #87#1 % 402;
     |DDEFECTO #716;
     #716#0 = aAno;
     #716#1 = aMes;
     #716#2 = #87#7;
     #716#3 = #88#3;
     |LEE 101#716=;
     |SI FSalida ! 0; |GRABA 020#716b; |FINSI;
     #716#4 = #716#4 + #88#5;
     #716#9 = #716#9 + (#88#5 * #88#58);
     |GRABA 020#716a;
     |LIBERA #716;
|FPRC;

|DEFBUCLE Pedidos;
     #87#1;
     1;
     "     ", 000001, aDAno;
     "zzzzz", 999999, aHAno;
     ;
     NULL, NULL, Pedidos;
|FIN;

|PROCESO BorraAno;
     |BORRA 020#716a;
|FPRC;

|DEFBUCLE BorraAno;
     #716#1;
     ;
     aAno, 01, "  ", 00001;
     aAno, 12, "zz", 99999;
     be;
     NULL, BorraAno;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 ! "SI"; |ACABA; |FINSI;
     |ABRE #718; |LEE 000#718p; |CIERRA #718;
     aAno = #718#1;
     |BUCLE BorraAno;
     aDAno = "01.01." + aAno;
     aHAno = "31.12." + aAno;
     |ABRE #716;
     |ABRE #723;
     |BUCLE Pedidos;
     |BUCLE Facturas;
     |CIERRA #723;
     |CIERRA #716;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "";
          #0#0 = "SI";
          |HAZ Tipo3;
     |SINO;
          |MANTE #0;
     |FINSI;
|FPRO;
