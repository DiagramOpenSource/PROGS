|FICHEROS;
     agifa552 #0;

     expor024@ #1;        ||Cliente a importar
     agifa024 #11;

     expor019@ #2;        ||Articulo a importar
     agifa019 #12;

     expor112@ #3;        ||Proveedor a importar
     agifa112 #13;

     expor025@ #4;        ||Comisionista a importar
     agifa025 #14;

     expor065@ #5;        ||Historico Movimientos,
     agifa065 #15;

     expor001@ #6;        ||Cod. Barras Mult.
     dsl00001 #16;

     agifa555 #50;       || Fichero CONTROL CAMINO EXPORT/IMPORT
     dsm00033 #100;

     expord10@ #30;
     dsm00010 #40;

     expord06@ #31;
     dsm00006 #41;

     expord14@ #33;
     dsm00014 #43;

     expord16@ #34;
     dsm00016 #44;

     expord15@ #35;
     dsm00015 #45;

     expor023@ #103;
     agifa023 #203;
     ||컴컴컴컴컴컴컴컴컴컴컴컴Marhuenda
     expor334@ #334;
     marhu334@ #434;
     expor335@ #335;
     marhu335@ #435;

     expor362@ #362;
     marhu362@ #462;
     expor363@ #363;
     marhu363@ #463;
     expor361@ #361;
     marhu361@ #461;
     ||컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|FIN;

|VARIABLES;
     &eaNomDef = "";
     &enCamposDef = 0;
     nSwMarhu = 0;
     nCampos  = 0;
     n024 = 0; n019 = 0; n112 = 0; n025 = 0; n065 = 0; n001 = 0;
     nd10 = 0; nd06 = 0; nd14 = 0; nd16 = 0; nd15;
     ddx = "";
     aParam  = "";
     &qFichero = "";
     fich = "";
     org = "";
     num = 0;
     bufer = 0;
     err = 0;
     fdes = "";
     des = "";
     fdef = "";
     def = "";
     exp = 0;
     sw_pasada = 0;
     desdec="      ";
     hastac="zzzzzz";
     desdea="                    ";
     hastaa="zzzzzzzzzzzzzzzzzzzz";
     desdep="    ";
     hastap="zzzz";
     desdecom="  ";
     hastacom="zz";
     desfecha="00.00.0000";
     hasfecha="31.12.2000";
     i=0;
     sist="";
     dirfich="";
     mandato="";
     mandato1="";
     mensaje1= "0000ATENCION No puedo abrir fichero de control EXPORT/IMPORT";
     mensaje2= "0000ATENCION Debe informar del CONTROL CAMINO EXPORT/IMPORT";
     path="";
     path1="";
     path2="";
     path3="";
     path4="";
     no="N";
     fecha="00.00.0000";
     copia="";
     si="S";
     blanco="                         ";
     blanco1="                    ";
     longfich  = "";
     longfich1 = 0;
     longfich2 = "";
     nLin      = 0;
     aAlfa     = "";
     aFic      = "";
     aTar      = "";
     fFecha    = @;
     a1        = "";
     a2        = "";
     empresa   = "";

     swErr    = 0;
     aMensa   = "";
     aPath    = "";
     aDef     = "";
     aDef1    = "";
     aDef2    = "";
     aDef3    = "";
     aDef4    = "";
     aDef5    = "";
     aDef6    = "";
     aDef7    = "";
     aDef8    = "";
     aDef9    = "";
     aDef10   = "";
     aDef11   = "";
     aDef12   = "";
     aDef13   = "";
     aDef14   = "";
     aDef15   = "";
     aDef16   = "";
     aDef17   = "";
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO BusCampos;
     |DFICE org; |QBF org;
     |DBASE des; |QBF des;
     |DDEF  def; |QBF def;
     eaNomDef = "agifa024"; |HAZ CamposDef; n024 = enCamposDef;
     eaNomDef = "agifa019"; |HAZ CamposDef; n019 = enCamposDef;
     eaNomDef = "agifa112"; |HAZ CamposDef; n112 = enCamposDef;
     eaNomDef = "agifa025"; |HAZ CamposDef; n025 = enCamposDef;
     eaNomDef = "agifa065"; |HAZ CamposDef; n065 = enCamposDef;
     eaNomDef = "dsl00001"; |HAZ CamposDef; n001 = enCamposDef;
     eaNomDef = "dsm00010"; |HAZ CamposDef; nd10 = enCamposDef;
     eaNomDef = "dsm00006"; |HAZ CamposDef; nd06 = enCamposDef;
     eaNomDef = "dsm00014"; |HAZ CamposDef; nd14 = enCamposDef;
     eaNomDef = "dsm00015"; |HAZ CamposDef; nd15 = enCamposDef;
     eaNomDef = "dsm00016"; |HAZ CamposDef; nd16 = enCamposDef;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
  El Nombre del Fichero:  ddmmyy + empresa + "." + Linea Histo
           digitos....   Fecha(6)   (5)             (3)
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Comprime;
     |ABRE #100;
     #100#0 = "E";
     #100#1 = fFecha;
     #100#2 = 999;
     |LEE 000#100];
     |SI FSalida = 0;
          |LEE 000#100a;
     |SINO;
          |LEE 000#100u;
     |FINSI;
     |SI FSalida = 0; |Y #100#0 = "E"; |Y #100#1 = fFecha;
          nLin = #100#2 + 1;
     |SINO;
          nLin = 1;
     |FINSI;

     aFic = (fFecha % 102) + (fFecha % 402) + (fFecha % -102);
     aAlfa = ("000" + nLin) % -103;
     aTar = aFic + empresa + "." + aAlfa;    ||->Nombre del Fichero

     a1 = path + aTar + " *.dat *.ixx *.ddx";
     a2 = path;
     |ATAR a1, a2;

     a1 = path + aTar;
     |COMPRIME a1;
     |FBORRA a1;
     a2 = path + aFic + empresa + ".gz";
     |RENOMBRA_FICHERO a2, a1;

     aFic = path + aTar;
     |XABRE "E", aFic, 0;
     |SI FSalida ! 0;
          aAlfa = "0000No puede compactar... " + aTar;
          |MENAV aAlfa;
          aTar = "ERROR EN TAR";
     |SINO;
          aFic = path;
          |_PDIR aFic;
          |PARA; |SI FSalida = 0; |HACIENDO;
               aAlfa = aFic % -103;
               |SI aAlfa = "ddx"; |O aAlfa = "ixx"; |O aAlfa = "dat";
                    aAlfa = aFic % -0805;
                    |SI aAlfa = "expor"; |FBORRA aFic; |FINSI;
                    aAlfa = aFic % -0507;
                    |SI aAlfa = "testigo"; |FBORRA aFic; |FINSI;
               |FINSI;
               |_SDIR aFic;
          |SIGUE;
     |FINSI;
     ||--------------------Registro
     |HORA aAlfa;
     |DDEFECTO #100;
     #100#0 = "E";
     #100#1 = fFecha;
     #100#2 = nLin;
     #100#3 = aAlfa;
     #100#4 = Usuario % 810;
     #100#5 = aTar;
     |GRABA 020#100n;
     |CIERRA #100;
|FPRC;

||**********NO SE INCLUYEN ACUMULADOS
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO agifa023;
     aAlfa = "|NC";
     aAlfa = #203#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #103i = #203i;
     |SIGUE;
     |GRABA 020#103n;
|FPRC;

|DEFBUCLE agifa023;
     #203#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa023;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO marhu361;
     aAlfa = "|NC";
     aAlfa = #461#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #361i = #461i;
     |SIGUE;
     |GRABA 020#361n;
|FPRC;

|DEFBUCLE marhu361;
     #461#1001;
     ;
     "      ";
     "zzzzzz";
     ;
     NULL, marhu361;
|FIN;

|PROCESO marhu363;
     aAlfa = "|NC";
     aAlfa = #463#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #363i = #463i;
     |SIGUE;
     |GRABA 020#363n;
|FPRC;

|DEFBUCLE marhu363;
     #463#1002;
     ;
     #462#0, "                    ";
     #462#0, "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, marhu363;
|FIN;

|PROCESO marhu362;
     aAlfa = "|NC";
     aAlfa = #462#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #362i = #462i;
     |SIGUE;
     |GRABA 020#362n;
     |BUCLE marhu363;
|FPRC;

|DEFBUCLE marhu362;
     #462#1001;
     ;
     "      ";
     "zzzzzz";
     be;
     NULL, marhu362;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO marhu335;
     aAlfa = "|NC";
     aAlfa = #435#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #335i = #435i;
     |SIGUE;
     |GRABA 020#335n;
|FPRC;

|DEFBUCLE marhu335;
     #435#1003;
     ;
     #434#0, #434#1, 001;
     #434#0, #434#1, 999;
     ;
     NULL, marhu335;
|FIN;

|PROCESO marhu334;
     |SI #434#3 = "S"; |ERROR; |ACABA; |FINSI; || Exportado
     aAlfa = "|NC";
     aAlfa = #434#aAlfa#;
     nCampos = aAlfa; nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #334i = #434i;
     |SIGUE;
     |GRABA 020#334n;
     #434#3 = "S";
     #434#4 = fFecha;
     |GRABA 020#434a;
     |BUCLE marhu335;
|FPRC;

|DEFBUCLE marhu334;
     #434#1002;
     ;
     00001, 000001;
     99999, 999999;
     be;
     NULL, marhu334;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO CodBarra;
     sw_pasada = 1;
     |PINTA 2263 , blanco1;
     |PINTA 2263 , #16#1;
     |PARA i = 0; |SI i [ n001; |HACIENDO i = i + 1;
          #6i = #16i;
     |SIGUE;
     |GRABA 011#6n;
     |LIBERA #6;
     #16#4 = "S";
     #16#5 = #0#4;
     |GRABA 011#16a;     ||Graba el original
     |LIBERA #16;
|FPRC;

|PROCESO miracli;
     sw_pasada = 1;
     |PINTA 2263 , blanco1;
     |PINTA 2263 , #11#0;
     |PARA i = 0; |SI i [ n024; |HACIENDO i = i + 1;
          #1i = #11i;
     |SIGUE;
     |GRABA 011#1n;
     |LIBERA #1;
     #11#175="S";
     #11#176=#0#4;
     |GRABA 011#11a;     ||Graba el original
     |LIBERA #11;
|FPRC;

|PROCESO miraarti;
     sw_pasada = 1;
     |PINTA 2263 , blanco1;
     |PINTA 2263 , #12#0;
     |PARA i = 0; |SI i [ n019;|HACIENDO i = i + 1;
          #2i = #12i;
     |SIGUE;
     |GRABA 011#2n;
     |LIBERA #2;
     #12#123 = "S";
     #12#124 = #0#4;
     |GRABA 011#12a;     ||Graba el original
     |LIBERA #12;
|FPRC;

|PROCESO miraprove;
     sw_pasada = 1;
     |PINTA 2263 , blanco1;
     |PINTA 2263 , #13#0;
     |PARA i = 0; |SI i [ n112; |HACIENDO i = i + 1;
          #3i = #13i;
     |SIGUE;
     |GRABA 011#3n;
     |LIBERA #3;
     #13#71 = "S";
     #13#72 = #0#4;
     |GRABA 011#13a;     ||Graba el original
     |LIBERA #13;
|FPRC;

|PROCESO miracomis;
     sw_pasada = 1;
     |PINTA 2263 , blanco1;
     |PINTA 2263 , #14#0;
     |PARA i = 0; |SI i [ n025; |HACIENDO i = i + 1;
          #4i = #14i;
     |SIGUE;
     |GRABA 011#4n;
     |LIBERA #4;
     #14#54 = "S";
     #14#55 = #0#4;
     |GRABA 011#14a;     ||Graba el original
     |LIBERA #14;
|FPRC;

|PROCESO HistoEleme;
     |PARA i = 0; |SI i [ nd06; |HACIENDO i = i + 1;
          #31i = #41i;
     |SIGUE;
     |GRABA 020#31n;
|FPRC;

|DEFBUCLE HistoEleme;
     #41#1;
     ;
     #15#0, #15#5, #15#1, #15#2, #15#11, #15#3, #15#4, "      ";
     #15#0, #15#5, #15#1, #15#2, #15#11, #15#3, #15#4, "zzzzzz";
     ;
     NULL, HistoEleme;
|FIN;

|PROCESO mirahis;
     |SI #15#2 = "ES"; |O #15#2 = "SS"; |O #15#2 = "EV"; |O #15#2 = "ME";
               |O #15#2 = "MS";|O #15#2 = "AC";|O #15#2 = "AV";
               |O #15#2 = "FC"; |O #15#2 = "SA";
          |PINTA 2263 , blanco1;
          |PINTA 2263 , #15#0;
          |PARA i = 0; |SI i [ n065; |HACIENDO i = i + 1;
               #5i = #15i;
          |SIGUE;
          |GRABA 011#5n;
          |LIBERA #5;
          #15#15 = "S";
          #15#16 = #0#4;
          |GRABA 011#15a;     ||Graba el original
          |LIBERA #15;
          sw_pasada = 1;

          |BUCLE HistoEleme;
     |FINSI;
|FPRC;

|DEFBUCLE 0;        ||CLientes #1
     #11#7;
     176;
     no,"      " ,desfecha;
     no,"zzzzzz" ,hasfecha;
     be;
     NULL,miracli;
|FIN;

|| Articulos
|DEFBUCLE 1;
     #12#3;
     ;
     no,"00.00.0000","                    ";
     no,"31.12.2300","zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL,miraarti;
|FIN;

|DEFBUCLE 2;        ||Proveedor #3
     #13#4;
     ;
     no,desfecha,"      ";
     no,hasfecha,"zzzzzz";
be;
NULL,miraprove;
|FIN;

|DEFBUCLE 3;        ||Comisionista #4
     #14#3;
     55;
     no,"  ",desfecha;
     no,"zz",hasfecha;
be;
NULL,miracomis;
|FIN;

|DEFBUCLE 4;        ||Historico
     #15#6;
     ;
     "N"; || "                    ", "01.01.1900", "  ", 000000, 00000, "     ", "N";
     "N"; || "zzzzzzzzzzzzzzzzzzzz", "31.12.9999", "zz", 999999, 99999, "zzzzz", "N";
     be;
     NULL,mirahis;
|FIN;

|DEFBUCLE CodBarra;
     #16#4;
     5;
     no,0000001,desfecha;
     no,9999999,hasfecha;
     be;
     NULL, CodBarra;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO dsm00010;
     sw_pasada = 1;
     |ABRE #40;
     |LEE 000#40p;
     |CIERRA #40;

     |PARA i = 0; |SI i [ nd10; |HACIENDO i = i + 1;
          #30i = #40i;
     |SIGUE;
     |GRABA 000#30n;
|FPRC;

|PROCESO dsm00014;
     sw_pasada = 1;
     |PARA i = 0; |SI i [ nd14; |HACIENDO i = i + 1;
          #33i = #43i;
     |SIGUE;
     |GRABA 000#33n;
|FPRC;

|PROCESO dsm00016;
     sw_pasada = 1;
     |PARA i = 0; |SI i [ nd16; |HACIENDO i = i + 1;
          #34i = #44i;
     |SIGUE;
     |GRABA 000#34n;
|FPRC;

|PROCESO dsm00015;
     sw_pasada = 1;
     |PARA i = 0; |SI i [ nd15; |HACIENDO i = i + 1;
          #35i = #45i;
     |SIGUE;
     |GRABA 000#35n;
|FPRC;

|DEFBUCLE dsm00014;
     #43#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00014;
|FIN;

|DEFBUCLE dsm00016;
     #44#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00016;
|FIN;
|DEFBUCLE dsm00015;
     #45#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsm00015;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO inicio;
     |HAZ BusCampos;
     |SI err ! 0;
          |MENAV "0000Proceso anulado...";
          |ACABA;
     |FINSI;

     fFecha = ~;

     |ABRE #100;
     #100#0 = "E";
     #100#1 = fFecha;
     |LEE 000#100];
     |SI FSalida = 0; |Y #100#0 = "E"; |Y #100#1 = fFecha;
          aAlfa = "0000NSe genero una exportacion hoy " + fFecha  + ". Crear otra S/N ";
          |CONFI aAlfa;
          |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;
     |CIERRA #100;

     |DFICE dirfich; |QBF dirfich;      ||Directorio de la empresa
     empresa = dirfich % -205;

     |ABRE #50;
     |SI FSalida ! 0;        || Por si hubiera un desastre en el disco duro
         |MENAV mensaje1;
         |ERROR;
         |ACABA;
     |FINSI;

     |LEE 001#50p;
     path=#50#1;
     |QBF path;
     |SI path = "";   || Si no habia nada informado, debo indicar que lo ponga bien
          |MENAV mensaje2;
          |ERROR;
          |ACABA;
     |FINSI;

     |CIERRA #50;

     |HAZ  CargaDef;
     |SI swErr ! 0;
          aMensa = "0000Error al cargar:" + aDef;
          |MENAV aMensa;
          |HAZ DesCargaDef;
          |ACABA;
     |FINSI;

     ||Clientes
     |SI #0#5="S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Clientes";
          |PATH_DAT #1 path;   || Marco camino de clientes exportacion
          |ABRE #1;  |CIERRA #1;
          |DELINDEX #1;
          |ABRE #1;
          |BUCLE 0;
          |LIBERA #1;
          |CIERRA #1;

          |PINTA 2224 , blanco;
          |PINTA 2224 , "Precio Cli/Art";
          |PATH_DAT #103 path;
          |DELINDEX #103;
          |ABRE #103;
          |BUCLE agifa023;
          |CIERRA #103;
     |FINSI;

     ||Articulo
     |SI #0#6="S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Articulos";
          |PATH_DAT #2 path;   || Marco camino de articulos exportacion
          |ABRE #2;
          |CIERRA #2;
          |DELINDEX #2;
          |ABRE #2;
          |BUCLE 1;
          |LIBERA #2;
          |CIERRA #2;
     |FINSI;
     ||Proveedores
     |SI #0#7="S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Proveedores";
          |PATH_DAT #3 path;   || Marco camino de proveedores exportacion
          |ABRE #3;
          |CIERRA #3;
          |DELINDEX #3;
          |ABRE #3;
          |BUCLE 2;
          |LIBERA #3;
          |CIERRA #3;
     |FINSI;

     ||Comisionistas
     |SI #0#8="S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Comisionistas";
          |PATH_DAT #4 path;   || Marco camino de comisionistas exportacion
          |ABRE #4;
          |CIERRA #4;
          |DELINDEX #4;
          |ABRE #4;
          |BUCLE 3;
          |LIBERA #4;
          |CIERRA #4;
     |FINSI;

     ||Historico
     |SI #0#9="S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Historico    ";
          |PATH_DAT #5 path;
          |PATH_DAT #31 path;
          |DELINDEX #5;
          |DELINDEX #31;
          |ABRE #5;
          |ABRE #31;
          |BUCLE 4;
          |CIERRA #5;
          |CIERRA #31;
     |FINSI;

     ||Barras
     |SI #0#10 = "S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Cod. Barras  ";
          |PATH_DAT #6 path;   || Marco camino de historico  exportacion
          |ABRE #6; |CIERRA #6; |DELINDEX #6;
          |ABRE #6;
          |BUCLE CodBarra;
          |LIBERA #6;
          |CIERRA #6;
     |FINSI;

     ||Division
     |SI #0#10 = "S";
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Div.Vertical ";
          |PATH_DAT #30 path;
          |PATH_DAT #33 path;
          |PATH_DAT #34 path;
          |PATH_DAT #35 path;
          |DELINDEX #30;
          |DELINDEX #33;
          |DELINDEX #34;
          |DELINDEX #35;
          |ABRE #30;
          |ABRE #33;
          |ABRE #34;
          |ABRE #35;
          |HAZ dsm00010;   ||Parametros
          |BUCLE dsm00014; ||Div. Arti
          |BUCLE dsm00015; ||Defectos
          |BUCLE dsm00016; ||Defectos
          |CIERRA #30;
          |CIERRA #33;
          |CIERRA #34;
          |CIERRA #35;
     |FINSI;
     |SI nSwMarhu = 1;
          |PINTA 2224 , blanco;
          |PINTA 2224 , "Pedidos Reposicion";
          |PATH_DAT #334 path;
          |PATH_DAT #335 path;
          |DELINDEX #334;
          |DELINDEX #335;
          |ABRE #334;
          |ABRE #335;
          |BUCLE marhu334;
          |CIERRA #335;
          |CIERRA #334;

          |PINTA 2224 , blanco;
          |PINTA 2224 , "Tarifas Articulos";
          |PATH_DAT #362 path;
          |PATH_DAT #363 path;
          |DELINDEX #362;
          |DELINDEX #363;
          |ABRE #362;
          |ABRE #363;
          |BUCLE marhu362;
          |CIERRA #362;
          |CIERRA #363;

          |PATH_DAT #361 path;
          |DELINDEX #361;
          |ABRE #361;
          |BUCLE marhu361;
          |CIERRA #361;
     |FINSI;

     |HAZ DesCargaDef;

     |SI sw_pasada = 1;
          |HAZ Comprime;
          |SI #0#12 = "S";        || SI quiere envio Por Correo.
               qFichero = path + aTar;
               |CONFI "0000SEnviar Exportacion a TPV ahora: ";
               |SI FSalida = 0;
                   |MENAV "0000Atencion!! Debe estar conectado a internet";
                   |SUB_EJECUTA "dsm00203.tab;moddel";
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "0000No hay nada nuevo para exportar!!";
     |FINSI;
|FPRC;

|PROCESO CargaDef;
     |DBASE aPath;

     aDef1 = aPath + "def/" + "agifa024";
     aDef  = aDef1;
     |CARGA_DEF aDef, expor024@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef1 = "";
          |ACABA;
     |FINSI;
     aDef2 = aPath + "def/" + "agifa019";
     aDef  = aDef2;
     |CARGA_DEF aDef, expor019@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef2 = "";
          |ACABA;
     |FINSI;
     aDef3 = aPath + "def/" + "agifa112";
     aDef  = aDef3;
     |CARGA_DEF aDef, expor112@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef3 = "";
          |ACABA;
     |FINSI;
     aDef4 = aPath + "def/" + "agifa025";
     aDef  = aDef4;
     |CARGA_DEF aDef, expor025@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef4 = "";
          |ACABA;
     |FINSI;
     aDef5 = aPath + "def/" + "agifa065";
     aDef  = aDef5;
     |CARGA_DEF aDef, expor065@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef5 = "";
          |ACABA;
     |FINSI;
     aDef6 = aPath + "def/" + "dsl00001";
     aDef  = aDef6;
     |CARGA_DEF aDef, expor001@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef6 = "";
          |ACABA;
     |FINSI;
     aDef7 = aPath + "def/" + "dsm00010";
     aDef  = aDef7;
     |CARGA_DEF aDef, expord10@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef7 = "";
          |ACABA;
     |FINSI;
     aDef8 = aPath + "def/" + "dsm00006";
     aDef  = aDef8;
     |CARGA_DEF aDef, expord06@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef8 = "";
          |ACABA;
     |FINSI;
     aDef9 = aPath + "def/" + "dsm00014";
     aDef  = aDef9;
     |CARGA_DEF aDef, expord14@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef9 = "";
          |ACABA;
     |FINSI;
     aDef10 = aPath + "def/" + "dsm00016";
     aDef  = aDef10;
     |CARGA_DEF aDef, expord16@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef10 = "";
          |ACABA;
     |FINSI;
     aDef11 = aPath + "def/" + "dsm00015";
     aDef  = aDef11;
     |CARGA_DEF aDef, expord15@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef11 = "";
          |ACABA;
     |FINSI;
     aDef14 = aPath + "def/" + "agifa023";
     aDef  = aDef14;
     |CARGA_DEF aDef, expor023@;
     |SI FSalida ! 0;
          swErr = 1;
          aDef14 = "";
          |ACABA;
     |FINSI;
     |SI nSwMarhu = 1;
          aDef12 = aPath + "def/" + "marhu334";
          aDef  = aDef12;
          |CARGA_DEF aDef, expor334@;
          |SI FSalida ! 0;
               swErr = 1;
               aDef12 = "";
               |ACABA;
          |FINSI;
          aDef13 = aPath + "def/" + "marhu335";
          aDef  = aDef13;
          |CARGA_DEF aDef, expor335@;
          |SI FSalida ! 0;
               swErr = 1;
               aDef13 = "";
               |ACABA;
          |FINSI;
          aDef15 = aPath + "def/" + "marhu362";
          aDef  = aDef15;
          |CARGA_DEF aDef, expor362@;
          |SI FSalida ! 0;
               swErr = 1;
               aDef15 = "";
               |ACABA;
          |FINSI;
          aDef16 = aPath + "def/" + "marhu363";
          aDef  = aDef16;
          |CARGA_DEF aDef, expor363@;
          |SI FSalida ! 0;
               swErr = 1;
               aDef16 = "";
               |ACABA;
          |FINSI;
          aDef17 = aPath + "def/" + "marhu361";
          aDef  = aDef17;
          |CARGA_DEF aDef, expor361@;
          |SI FSalida ! 0;
               swErr = 1;
               aDef17 = "";
               |ACABA;
          |FINSI;
     |FINSI;
     |HAZ NomeDat;
|FPRC;

|PROCESO DesCargaDef;
     |SI nSwMarhu = 1;
          |SI aDef17 ! ""; |DESCARGA_DEF #expor361@; |FINSI;
          |SI aDef16 ! ""; |DESCARGA_DEF #expor363@; |FINSI;
          |SI aDef15 ! ""; |DESCARGA_DEF #expor362@; |FINSI;
          |SI aDef13 ! ""; |DESCARGA_DEF #expor335@; |FINSI;
          |SI aDef12 ! ""; |DESCARGA_DEF #expor334@; |FINSI;
     |FINSI;
     |SI aDef14 ! ""; |DESCARGA_DEF #expor023@; |FINSI;
     |SI aDef11 ! ""; |DESCARGA_DEF #expord15@; |FINSI;
     |SI aDef10 ! ""; |DESCARGA_DEF #expord16@; |FINSI;
     |SI aDef9  ! ""; |DESCARGA_DEF #expord14@; |FINSI;
     |SI aDef8  ! ""; |DESCARGA_DEF #expord06@; |FINSI;
     |SI aDef7  ! ""; |DESCARGA_DEF #expord10@; |FINSI;
     |SI aDef6  ! ""; |DESCARGA_DEF #expor001@; |FINSI;
     |SI aDef5  ! ""; |DESCARGA_DEF #expor065@; |FINSI;
     |SI aDef4  ! ""; |DESCARGA_DEF #expor025@; |FINSI;
     |SI aDef3  ! ""; |DESCARGA_DEF #expor112@; |FINSI;
     |SI aDef2  ! ""; |DESCARGA_DEF #expor019@; |FINSI;
     |SI aDef1  ! ""; |DESCARGA_DEF #expor024@; |FINSI;
|FPRC;

|PROCESO NomeDat;
     |NOME_DAT #103 "expor023";
     |SI nSwMarhu = 1;
          |NOME_DAT #334 "expor334";
          |NOME_DAT #335 "expor335";
          |NOME_DAT #362 "expor362";
          |NOME_DAT #363 "expor363";
          |NOME_DAT #361 "expor361";
     |FINSI;
     |NOME_DAT #35 "expord15";
     |NOME_DAT #34 "expord16";
     |NOME_DAT #33 "expord14";
     |NOME_DAT #31 "expord06";
     |NOME_DAT #30 "expord10";
     |NOME_DAT #6  "expor001";
     |NOME_DAT #5  "expor065";
     |NOME_DAT #4  "expor025";
     |NOME_DAT #3  "expor112";
     |NOME_DAT #2  "expor019";
     |NOME_DAT #1  "expor024";
|FPRC;

|PROCESO Marhuenda;
     aAlfa = ""; |DBIN aAlfa;
     aAlfa = aAlfa + "marhu334.tab";
     |XABRE "E", aAlfa, 0;
     |SI FSalida = 0
          |DBASE aPath;
          aAlfa = aPath + "def/marhu334";
          |CARGA_DEF aAlfa, marhu334@;
          |SI FSalida = 0;
               aAlfa = aPath + "def/marhu335";
               |CARGA_DEF aAlfa, marhu335@;
               |SI FSalida = 0;
                    nSwMarhu = 1;
               |SINO;
                    aAlfa = "0000Error al cargar " + aAlfa;
                    |MENAV aAlfa;
               |FINSI;
          |SINO;
               aAlfa = "0000Error al cargar " + aAlfa;
               |MENAV aAlfa;
          |FINSI;
          |SI nSwMarhu = 1;
               aAlfa = aPath + "def/marhu362";
               |CARGA_DEF aAlfa, marhu362@;
               |SI FSalida = 0;
                    aAlfa = aPath + "def/marhu363";
                    |CARGA_DEF aAlfa, marhu363@;
                    |SI FSalida = 0;
                         nSwMarhu = 1;
                    |SINO;
                         aAlfa = "0000Error al cargar " + aAlfa;
                         |MENAV aAlfa;
                    |FINSI;
               |SINO;
                    aAlfa = "0000Error al cargar " + aAlfa;
                    |MENAV aAlfa;
               |FINSI;
          |FINSI;
          |SI nSwMarhu = 1;
               aAlfa = aPath + "def/marhu361";
               |CARGA_DEF aAlfa, marhu361@;
               |SI FSalida = 0;
                    nSwMarhu = 1;
               |SINO;
                    aAlfa = "0000Error al cargar " + aAlfa;
                    |MENAV aAlfa;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ Marhuenda;

     aParam = PARAMETRO;
     |QBF aParam;
     |ABRE #0;
     #0#13 = 1;
     |LEE 101#0=;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0b;
     |FINSI;
     |SI aParam = "centralaut";
          |HAZ inicio;
     |SINO;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0;
               |GRABA 020#0a;
               |HAZ inicio;
          |FINSI;
     |FINSI;
     |CIERRA #0;

     |SI nSwMarhu = 1;
          |DESCARGA_DEF #marhu361@;
          |DESCARGA_DEF #marhu363@;
          |DESCARGA_DEF #marhu362@;
          |DESCARGA_DEF #marhu335@;
          |DESCARGA_DEF #marhu334@;
     |FINSI;
|FPRO;
