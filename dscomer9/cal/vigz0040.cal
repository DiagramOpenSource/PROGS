|FICHEROS;
     vigz0040 #0;
     vigm0006 #6;
     vigm0007 #7;
     dsm00020 #20;
     agifa024 #24;
     agifa104 #104;
     agifa073 #73;
     agifa007 #70;
     agifa019 #4;        || Articulos
     agifa142 #42;
|FIN;

|VARIABLES;
     nPendiente = 0;
     nPendiente2 = 0;
     nSwSirve = 0;
     i = 0;
     aSer = "";
     nNum = 0;
     nCampo = 0;
     nLin = 0;
     &enSwMenu = 0;
|FIN;

|PROCESO Parrilla; |TIPO 0;
     |SI #0#8 = "P";
          |PARA i = 0; |SI i < 8; |HACIENDO i = i + 1;
               |C_M #0i, 1, "N";
          |SIGUE;
          |PARA i = 9; |SI i [ 26; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
     |SINO;
          |PARA i = 0; |SI i < 8; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S";
          |SIGUE;
          |PARA i = 9; |SI i [ 26; |HACIENDO i = i + 1;
               |C_M #0i, 1, "N";
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Lineas;
     nLin = nLin + 1;
     |DDEFECTO #7;
     #7#29 = #6#52;
     #7#0 = #6#0;
     #7#1 = nLin;
     #7#2 = #73#2;
     #7#3 = #73#3;
     #7#4 = #73#4;
     #7#5 = #73#5;
     #7#6 = #73#6;
     #7#8 = #73#8;
     #7#10 = #73#10;

     |ABRE #70;
     #70#26 = #7#29;
     |LEE 000#70=;
     |CIERRA #70;

     |SI #70#30 = "S";
          #7#11 = 0;
     |SINO;
          #7#11 = #73#14;
     |FINSI;
     #7#13 = #73#18;
     #7#15 = #6#3;
     #7#16 = #73#17;
     #7#17 = #73#19;
     #7#33 = #73#29;
     #7#34 = #73#35;
     #7#35 = #73#36;
     #7#36 = #73#38;
     #7#48 = #73#44;
     #7#49 = #73#45;
     #7#50 = #73#46;
     #7#51 = #73#50;
     #7#52 = #73#51;
     #7#53 = #73#52;

     #7#12 = #73#0;
     #7#21 = #73#1;
     #7#31 = #73#28;

     |HAZ TotalLinVigor;
     |HAZ CalCabVigor;
     |GRABA 020#7n;
     |LIBERA #7;

     #73#43 = #73#5;
     |GRABA 020#73.a;
|FPRC;

|PROCESO agifa073_pendiente;
     #4#0 = #73#2;
     |LEE 000#4=;
     nPendiente = #73#5 - #73#43;
     nPendiente2 = #73#44 - #73#49;
     |SI #4#179 = "N"; |O #agifa142#117 = "N";  ||Sin Doble Stock
          |SI nPendiente ! 0;
               nSwSirve = 1;
               |ERROR10;
          |FINSI;
     |SINO;
          |SI #agifa142#224 = "B";
               |SI nPendiente ! 0; |O nPendiente2 ! 0;
                    nSwSirve = 1;
                    |ERROR10;
               |FINSI;
          |SINO;
               |SI nPendiente ! 0; |Y nPendiente2 ! 0;
                    nSwSirve = 1;
                    |ERROR10;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa073_pendiente;
 #agifa073#1;
 ;
 #104#25, #104#0,   1;
 #104#25, #104#0, 999;
 ;
 NULL, agifa073_pendiente;
|FIN;

|PROCESO DimePendiente;
     ||ARA
     |ABRE #4;
     |BUCLE agifa073_pendiente;
     |CIERRA #4;
|FPRC;

|PROCESO Pedido;
     nSwSirve = 0;
     |HAZ DimePendiente;
     |SI nSwSirve = 0;
          |ERROR;
          |ACABA;
     |FINSI;

     |SI #0#27 = "*****";
          #6#52 = #104#25;
     |SINO;
          #6#52 = #0#27;
     |FINSI;
     enSwMenu = 1;
     |HAZ ContaVi7;
     |GRABA 000#6b;
     |PARA; |SI FSalida ! 0; |HACIENDO;
          #6#0 = #6#0 + 1;
          |GRABA 000#6b;
     |SIGUE;
     #6#1 = #0#28;
     #6#3 = #104#4;
     #6#4 = #104#8;

     #6#5 = #104#5;

     #6#6 = #104#7;
     #6#7 = #104#6;
     #6#8 = #104#9;

     |DDEFECTO #20;
     #20#0 = #104#60;
     |LEE 000#20=;
     #6#9 = #20#1;

     #6#29 = #104#19;
     #6#30 = #104#14;
     #6#31 = #104#20;
     #6#32 = #104#17;
     #6#33 = #104#21;

     #6#34 = #104#16;
     #6#35 = #104#18;

     |DDEFECTO #24;
     #24#0 = #6#3;
     |LEE 000#24=;

     #6#36 = #24#47;
     #6#40 = #24#41;
     #6#50 = #24#40;
     #6#55 = #104#53;
     #6#56 = #104#54;
     #6#57 = #104#55;
     #6#62 = #104#59;
     #6#63 = #104#64;
     #6#64 = #104#61;
     #6#68 = #104#35;
     #6#69 = #104#36;
     #6#70 = #104#37;
     #6#73 = #104#40;
     #6#74 = #104#41;
     #6#83 = #104#51;
     #6#84 = #104#57;
     #6#70 = #104#37;
     #6#101 = #104#15;
     |HAZ LimCabVigor;
|FPRC;

|PROCESO FinPed;
     |GRABA 020#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE Pedido;
     #104#1;
     ;
     aSer, nNum;
     aSer, nNum;
     ;
     NULL, Pedido, Lineas, FinPed;
|FIN;

|DEFBUCLE Pedidos;
     #104#1;
     1, 4;
     #0#0, #0#2, #0#4, #0#6;
     #0#1, #0#3, #0#5, #0#7;
     ;
     NULL, Pedido, Lineas, FinPed;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #42; |LEE 000#42p; |CIERRA #42;
     |ABRE #6;
     |ABRE #7;
     |ABRE #20;
     |ABRE #24;
     |SI #0#8 = "P";
          |PARA i = 9; |SI i [ 25; |HACIENDO i = i + 2;
               nCampo = i;
               aSer = #0nCampo;
               nCampo = i + 1;
               nNum = #0nCampo;
               |BUCLE Pedido;
          |SIGUE;
     |SINO;
          |BUCLE Pedidos;
     |FINSI;
     |CIERRA #24;
     |CIERRA #20;
     |CIERRA #6;
     |CIERRA #7;
|FPRC;
