|FICHEROS;
     agifa281 #0;
     agifa024 #24;
|FIN;

|VARIABLES;
     &eaCliente = "";
     &enSwWebServiceFace = 0;

     nBoton = 0;
     aEjecuta = "";

     aClienteFacE = "";
     aMensaje = "";
     nSalida = 0;

     puente = "";
     puente1 = "";

|FIN;

|PROCESO webFace;
     aEjecuta = "start https://face.gob.es/es/directorio";
     |RSYSTEM aEjecuta;
|FPRC;

|PROCESO ControWSFace;
     |SI enSwWebServiceFace = 1;
          |ATRI 0;
          |PINTA 2305, "Enviar facturaE al WebService de FACE: ";
          |ATRI I;

          |C_V #agifa281#44, 1, "S";
          |C_M #agifa281#44, 1, "S";
     |SINO;
          |C_V #agifa281#44, 1, "N";
          |C_M #agifa281#44, 1, "N";
     |FINSI;
|FPRC;

|PROCESO PonDatosAAPP;
     aClienteFacE = #agifa024#0;
     |QBF aClienteFacE;
     |SI aClienteFacE = "";
          aMensaje = "0000Debe seleccionar un Cliente para introducir los datos AAPP";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |CLS;
     |ABRE #agifa281;

     |DDEFECTO #agifa281;
     #agifa281#0 = aClienteFacE;
     |LEE 101#agifa281.=;
     nSalida = FSalida;

     |SI nSalida ! 0;
          #agifa281#1 = #agifa024#1;

          |PINPA #0#agifa281;
          |HAZ ControWSFace;
          |PINDA #0#agifa281;

          aMensaje = "0000SDesea copiar las direcciones de la ficha del cliente?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               #agifa281#5 = #agifa024#8;
               #agifa281#6 = #agifa024#181;
               #agifa281#7 = #agifa024#182;
               #agifa281#8 = ("00" + #agifa281#6) % -102 + ("000" + #agifa281#7) % -103;
               #agifa281#9 = #agifa024#9;
               #agifa281#10 = #agifa024#10;

               #agifa281#15 = #agifa281#5;
               #agifa281#16 = #agifa281#6;
               #agifa281#17 = #agifa281#7;
               #agifa281#18 = #agifa281#8;
               #agifa281#19 = #agifa281#9;
               #agifa281#20 = #agifa281#10;

               #agifa281#25 = #agifa281#5;
               #agifa281#26 = #agifa281#6;
               #agifa281#27 = #agifa281#7;
               #agifa281#28 = #agifa281#8;
               #agifa281#29 = #agifa281#9;
               #agifa281#30 = #agifa281#10;

               #agifa281#35 = #agifa281#5;
               #agifa281#36 = #agifa281#6;
               #agifa281#37 = #agifa281#7;
               #agifa281#38 = #agifa281#8;
               #agifa281#39 = #agifa281#9;
               #agifa281#40 = #agifa281#10;
          |FINSI;
     |FINSI;

     |PINPA #0#agifa281;
     |HAZ ControWSFace;
     |PINDA #0#agifa281;

     |CONTROL_SIMPLE 0, "BOTON,Web FACe", 0770, 0780, webFace;
     nBoton = FSalida;

     |ENDATOS #2#agifa281;
     |SI FSalida = 0;
          |SI nSalida = 0;
               |GRABA 020#agifa281.a;
          |SINO;
               |GRABA 020#agifa281.n;
          |FINSI;
     |FINSI;
     |LIBERA #agifa281;

     |FIN_CONTROL_WINDOWS nBoton;

     |CIERRA #agifa281;
|FPRC;

|PROCESO cp1FacE;
     puente = #0#6; puente = "00" + puente; puente = puente % -102;
     puente1 = puente;
     puente = #0#7; puente = "000" + puente; puente = puente % -103;
     puente1 = puente1 + puente;
     #0#8 = puente1;
|FPRC;

|PROCESO cp2FacE;
     puente = #0#16; puente = "00" + puente; puente = puente % -102;
     puente1 = puente;
     puente = #0#17; puente = "000" + puente; puente = puente % -103;
     puente1 = puente1 + puente;
     #0#18 = puente1;
|FPRC;

|PROCESO cp3FacE;
     puente = #0#26; puente = "00" + puente; puente = puente % -102;
     puente1 = puente;
     puente = #0#27; puente = "000" + puente; puente = puente % -103;
     puente1 = puente1 + puente;
     #0#28 = puente1;
|FPRC;

|PROCESO cp4FacE;
     puente = #0#36; puente = "00" + puente; puente = puente % -102;
     puente1 = puente;
     puente = #0#37; puente = "000" + puente; puente = puente % -103;
     puente1 = puente1 + puente;
     #0#38 = puente1;
|FPRC;


|PROGRAMA;
     |ABRE #24;
     #24#0 = eaCliente;
     |LEE 121#24=;
     |SI FSalida = 0;
          |HAZ PonDatosAAPP;
     |FINSI;
     |CIERRA #24;
|FPRO;
