|FICHEROS;
     dsz00052 #0;
     agifa077 #77;
     agifa080 #80;
     agifa019 #19;
     agifa112 #112;

     &gopartia@ #1;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     aDpv = "";
     aHpv = "";
     nSwObra = 0;
     nModo = 0;
     nConta = 0;
     aAlfa = "";
     nHay = 0;
     nPPort2 = 0;
     nPPort1 = 0;
     nImpDiv = 0;
     &nDeci_PreDiv = 0;
     &aDivisa     = "";
     &aMoneda     = "";
     nForma       = 0;
     aDef = "";
     &nDeci_TBase = 0;
     &nDeci_PBase = 0;
     &nDeci_PreBase = 0;
     &nDeci_Base = 0;
|FIN;

|PROCESO gopartia;
     nDeci_PBase = nDeci_PreBase;
     nDeci_TBase = nDeci_Base;

     #1#41 = #0#9;
     #1#42 = #0#10;
     #1#43 = #0#11;
     |HAZ CalcuGopartiaRef;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE gopartia;
     #1#1005;
     ;
     " ", #80#27, #80#0, #80#1, 001;
     "z", #80#27, #80#0, #80#1, 999;
     be;
     NULL, gopartia;
|FIN;

|PROCESO ModiGoparti;
    |BUCLE gopartia;
|FPRC;

|PROCESO Conta52; |TIPO  7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |LEE 000#0u;
          |SI FSalida = 0;
               nConta = #0#0+1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = nConta;
     |FINSI;
|FPRC;

|PROCESO Arti1; |TIPO 0;
     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = #0#8;
     |LEE 000#19=;
     |CIERRA #19;
     aAlfa = #19#195; |QBF aAlfa;
     |SI aAlfa = "";
          aAlfa = #19#1;
     |FINSI;
     #0#12 = aAlfa; |PINTA #0#12;
|FPRC;

|PROCESO Fin77;
     |SI nHay = 1;
          |HAZ LimCabAgifa077;
          |BUCLELIN 0 CalCabAgifa077 #77;
          |GRABA 020#77a;
          |LIBERA #77;
     |FINSI;
     nHay = 0;
|FPRC;


|PROCESO agifa080;
     |SI #80#2 ! #0#8;
          |ACABA;
     |FINSI;

     #80#30 = #0#9;
     #80#6 = #0#9;
     #80#8 = #0#10;
     #80#26 = #0#11;
     #80#45 = #0#15;
     |HAZ TotalLin80;
     |GRABA 020#80a;
     |LIBERA #80;
     |SI nSwObra = 0;
          |HAZ ModiGoparti;
     |FINSI;

     nHay = 1;
     #0#14 = #0#14 + 1;
     |PINTA #0#14;
|FPRC;

|PROCESO agifa077;
     aDivisa = #agifa077#56;
     aMoneda = #agifa077#58;
     |HAZ Divisas077;
|FPRC;

|DEFBUCLE agifa077;
     #77#3;
     38;
     aDpv, #0#6, #0#2, #0#4, "N";
     aHpv, #0#7, #0#3, #0#5, "N";
     be;
     NULL, agifa077, agifa080, Fin77;
|FIN;

|PROCESO ModiPrecio;
     |HAZ EsConstru;
     nSwObra = FSalida;
     |SI nSwObra = 0;
          |DDEF aDef;
          aDef = aDef + "gopartia";
          |CARGA_DEF aDef, gopartia@;
          |SI FSalida ! 0; aDef = ""; |FINSI;
     |FINSI;
     aDpv = #0#1;
     aHpv = #0#1;
     |SI #0#1 = "******";
          aDpv = "      ";
          aHpv = "zzzzzz";
     |FINSI;
     |BUCLE agifa077;

     |SI aDef ! "";
          |DESCARGA_DEF #gopartia@;
     |FINSI;

     #0#13 = ~;
     |PINTA #0#13;
     aAlfa = "0000Registros modificados " + #0#14;
     |MENAV aAlfa;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#13 = "01.01.0000";
          |CONFI "0000NCambiar Precios";
          |SI FSalida = 0;
               |HAZ ModiPrecio;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nForma = 0 +. 1;
     |SI #0#13 ! "01.01.0000"; |Y nForma = -1;
          |MENAV "0000Registro ejecutado";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = " Ejecutar ";
     |SINO;
          |SI #0#13 = "01.01.0000";
               |HAZ ModiPrecio;
          |SINO;
               |MENAV "0000Registro ejecutado";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Proveedor; |TIPO 0;
     aAlfa = #0#1; |QBF aAlfa;
     |SI aAlfa = "******"; |O aAlfa = "*";
          #0#1 = "******";
          |PINTA #0#1;
          |HAZ Tipo13;
     |SINO;
          aAlfa = ("000000" +  aAlfa) % -106;
          #0#1 = aAlfa;
          |PINTA #0#1
          |ABRE #112;
          #112#0 = #0#1;
          |LEE 000#112=;
          |SI FSalida = 0;
               |HAZ Tipo13;
          |SINO;
               |MENAV "0000El Proveedor no existe...";
               |ERROR;
          |FINSI;
          |CIERRA #112;
     |FINSI;
|FPRC;

|PROCESO Tipo13; |TIPO 13;
     aAlfa = #0#1; |QBF aAlfa;
     |SI aAlfa = "******";
          #112#1 = "TODOS LOS PROVEEDORES";
     |SINO;
          |DDEFECTO #112;
          |ABRE #112;
          #112#0 = #0#1;
          |LEE 000#112=;
          |CIERRA #112;
     |FINSI;
     |PINTA 1025, #112#1;
|FPRC;

|PROCESO Llena052; |TIPO 6;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;
