|FICHEROS;
 agifa142 #942;
|FIN;

|VARIABLES;
   &endigC   = 0;
   &eaCta    = "";
   &eswCta   = 0;

   aLong  = "";
   nLong  = 0;

   nNume1 = 0;
   nPos   = 0;
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";
   aAlfa4 = "";
   aGuarda = "";
   aPunto  = "";
|FIN;

|PROCESO MCtaContable;

   |DDEFECTO #942;
   |ABRE #942;
   |LEE 001#942p;
   endigC = #942#11;
   |CIERRA #942;

   eswCta = 0;     ||Errores en Cuenta
   |SI eaCta = "            "; |ACABA; |FINSI;

   aLong  = eaCta;
   |QBF aLong;
   aLong  = aLong % 0;
   nLong  = aLong;
   |SI nLong ! endigC;  eswCta = 1; |FINSI;

|FPRC;

|PROCESO MFiltraPtos;
    aGuarda = FSalida;
    |SI eaCta = "            "; |ACABA; |FINSI;

    |DDEFECTO #942;
    |ABRE #942;
    |LEE 001#942p;
    endigC = #942#11;
    |CIERRA #942;

    aAlfa1 = "";
    |PARA nNume1 = 1; |SI nNume1 [ 12; |HACIENDO nNume1 = nNume1 + 1;
          aAlfa2 = nNume1; |QBF aAlfa2;
          aAlfa2 = aAlfa2 + "01";
          aAlfa3 = eaCta % aAlfa2;
          |SI aAlfa3 = "."; |O aAlfa3 = "0"; |O aAlfa3 = "1"; |O aAlfa3 = "2";
                            |O aAlfa3 = "3"; |O aAlfa3 = "4"; |O aAlfa3 = "5";
                            |O aAlfa3 = "6"; |O aAlfa3 = "7"; |O aAlfa3 = "8";
                            |O aAlfa3 = "9";
              aAlfa1 = aAlfa1 + aAlfa3;
          |FINSI;
    |SIGUE;

    |HAZ EsGesenvia;
    |SI FSalida = 0;
          eaCta = eaCta;      || modulo, no se modifica
    |SINO;
          eaCta = aAlfa1;     || la estandar
    |FINSI;

    aPunto = eaCta - ".";
    |SI FSalida ! 0;
        nNume1 = FSalida;
        nPos   = 100 + (((nNume1 / 100) ! 0) -1);
        aAlfa2 = eaCta % nPos;   |QBF aAlfa2;
        nPos   = (((nNume1 / 100) ! 0) * 100) + 199;
        aAlfa3 = eaCta % nPos;   |QBF aAlfa3;

        FSalida = nNume1;
        |PARA; |SI FSalida ! 0; |HACIENDO;
               aAlfa3 = aAlfa3 - "."; || limpiar mas puntos (los ignoramos)
        |SIGUE;

        nPos   = endigC - ( (A \ aAlfa2 % 0) + (A \ aAlfa3 % 0));
        aAlfa4 = (A\ "0" * nPos);
        eaCta  = (A\ aAlfa2 + aAlfa4 + aAlfa3);
    |FINSI;

    FSalida = aGuarda;
|FPRC;
