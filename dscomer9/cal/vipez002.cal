|FICHEROS;
     vipez002 #0;
     vipew001 #1;   ||Tmp Alb y Tiquets
     vipem002 #2;
     vipem003 #3;

     agifa017 #17;
     vipem018 #18;
     agifa019 #19;
     agifa024 #24;
     agifa029 #29;
     dsm00043 #43;
     dsm00044 #44;
     agifa049 #49;
     agifa060 #60;
     agifa077 #77;
     agifa080 #80;
     agifa112 #112;
     agifa142 #142;
     dsm00239 #239;
     dsm00241 #241;
     dsm00237 #237;
     dsm00226 #226;
     agifa048 #480;
     agifa501 #501;
     agifa502 #502;
     agifa505 #505;
     agifa509 #509;
     agitp001;
|FIN;

|VARIABLES;
     nSwOfertaProv = 0;
     &aDivisa = "";
     &aMoneda = "";
     nSal = 0;
     aCaja = "";
     nMinu = 0;
     nSegu = 0;
     nHora = 0;
     aHora = "";
     nLinMat = 0;
     nLinDes = 0;
     nLinCon = 0;
     nDia = 0;
     nA쨚 = 0;
     aVal = "";
     &eCaja    = 0;
     &eTienda  = 0;
     &eFecha   = "";
     &eaTabla = "";
     &enRegistro = 0;
     &enSw = 0;
     &eaCam1 = "";
     &eaCam2 = "";
     &eaCam3 = "";
     &eaCam4 = "";
     &eaCam5 = "";
     &eaCam6 = "";
     &eaCam7 = "";
     &eaCam8 = "";
     &eaCam9 = "";
     &eaCam10 = "";
     &enForma = 1;
     &enSwMenu = 0;
     nCodLinAnt = 0;
     aConta = "";
     aFecha = "";
 {90}Valor = "";
     aReg = "";
     aLon = "";
     aDato = "";
     nPos = 0;
     aLetra = "";
     aTab = "";
     i = 0;
     nCampo = 0;
     aTabla = "";
     nPrime = 0;
     aCod = "";
     aAlfa = "";
     aSerie = "";
     nConta = 0;
     fFecha = @;
     fFechaAnt1 = @;
     fFechaAnt2 = @;
     nLinea = 0;
     aCli = "";
     aArt = "";
     aPro = "";
     fmes = "";
     imneto = 0;
     nDto = 0;
     nImpo = 0;
     beta = 0;
     mes = 0;
     aEmpre = "";
     &enImpCliCom = 0;
     &enImpCliDto = 0;
     &enImpCliMar = 0;
     &enImpCliFac = 0;
     &eaCliente = "";
     &efFecha = @;
     nLinNarti = 0;
     aTablaAnt = "";
     &eaMovimi = "";
     &enCodigo = 0;
     &eaSerie = "";
     &enLinea = 0;
     &enPrecioB = 0;
     &precio_base = 0;
     &enDeciB = 0;
     &nDeci_PreBase = 0;
     &eaDocu = "";
     aMes = "";
     nMes = 0;
     &enImpPrvCom = 0;
     &eaProve = "";
|FIN;

|PROCESO Fecha;
     aLon = aFecha % A0;
     nConta = 0;
     aVal = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aAlfa = aFecha % nPos;
          |SI aAlfa = "/";
               |SI nConta = 0; nDia = aVal; |FINSI;
               |SI nConta = 1; nMes = aVal; |FINSI;
               aVal = "";
               nConta = nConta + 1;
          |SINO;
               aVal = aVal + aAlfa;
          |FINSI;
     |SIGUE;
     nA쨚 = aVal;
     |SI nA쨚 < 100; nA쨚 = nA쨚 + 2000; |FINSI;
     aFecha = (("00" + nDia) % -102)+"."+(("00" + nMes) % -102)+"."+(("0000" + nA쨚) % -104);
     fFecha = aFecha;
|FPRC;

|PROCESO Hora;
     aLon = aHora % A0;
     nConta = 0;
     aVal = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aAlfa = aHora % nPos;
          |SI aAlfa = ":";
               |SI nConta = 0; nHora = aVal; |FINSI;
               |SI nConta = 1; nMinu = aVal; |FINSI;
               aVal = "";
               nConta = nConta + 1;
          |SINO;
               aVal = aVal + aAlfa;
          |FINSI;
     |SIGUE;
     nSegu = aVal;
     aHora = (("00" + nHora) % -102)+":"+(("00" + nMinu) % -102)+":"+(("00" + nSegu) % -102);
|FPRC;

|PROCESO pcmlinea;
     enForma = 1;
     ||컴컴컴컴컴컴 Doble/Multi
     enPrecioB = precio_base;
     enDeciB = nDeci_PreBase;
     eaDocu = "agifa077";
     |HAZ StockEntra;
     ||컴컴컴컴컴컴컴컴컴컴컴컴
     nImpo = (#80#9 < #77#5) < #77#32;
     |SI #142#114 = "S";
          nImpo = nImpo < #77#7;
     |FINSI;

     #112#0 = #77#3;
     |LEE 101#112=;
     |SI FSalida = 0;
         aMes = #77#1 % A402;
         nMes = aMes + 26;
         |SI #77#42 = "N";
             #112nMes = #112nMes + nImpo;
             #112#39 = #112#39 + nImpo;
         |SINO;
             #112nMes = #112nMes - nImpo;
             #112#39 = #112#39 - nImpo;
         |FINSI;
         |GRABA 020#112a;
         |LIBERA #112;
     |FINSI;

     |SI #77#42 = "N";
          enImpPrvCom = nImpo;
     |SINO;
          enImpPrvCom = -nImpo;
     |FINSI;
     efFecha = #77#1;
     eaProve = #77#3;
     |HAZ AcumulaPrv;
|FPRC;

|PROCESO AcuESSS;
     eaMovimi = "ES_SS";
     eaSerie = #44#21;
     enCodigo = #44#18;
     enLinea = #44#8;
     |SUB_EJECUTA_NP "dsz90001";
|FPRC;

|PROCESO LeeArt;
     |DDEFECTO #19;
     #19#0 = aArt;
     |LEE 000#19=;
|FPRC;

|PROCESO LeeCli;
     |DDEFECTO #24;
     #24#0 = aCli;
     |LEE 000#24=;
|FPRC;

|PROCESO LeePro;
     |DDEFECTO #112;
     #112#0 = aPro;
     |LEE 000#112=;
|FPRC;

|PROCESO StockPeriodo;
     |SELECT #2#18;
     aAlfa = "M" + Valor4 + Valor5;
     aFecha = Valor3; |HAZ Fecha;
     #18#4 = aAlfa;
     #18#3 = fFecha;
     aAlfa = Valor1 % 2;
     #18#1 = aAlfa;
     |LEE 000#18=;
     nSal = FSalida;
     |SI FSalida ! 0;
          |SELECT #1#18;
          |LEE 000#18u;
          |SI FSalida = 0;
               nConta = #18#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #18;
          #18#0 = nConta;
     |FINSI;
     aAlfa = Valor1 % 2;
     #18#1 = aAlfa;
     aFecha = Valor2; |HAZ Fecha;
     #18#2 = fFecha;
     aFecha = Valor3; |HAZ Fecha;
     #18#3 = fFecha;
     aAlfa = "M" + Valor4 + Valor5;
     #18#4 = aAlfa;
     #18#5 = Valor6;
     #18#6 = Valor7;
     #18#7 = Valor8;
     #18#8 = Valor9;
     #18#9 = Valor10;
     #18#10 = Valor11;
     #18#11 = Valor12;
     #18#12 = Valor13;
     #18#13 = Valor14;
     #18#14 = Valor15;
     #18#15 = Valor16;
     #18#16 = Valor17;
     #18#17 = Valor18;
     #18#18 = Valor19;
     #18#19 = Valor20;
     #18#20 = Valor21;
     #18#21 = Valor22;
     #18#22 = Valor23;
     #18#23 = Valor24;
     #18#24 = Valor25;
     #18#25 = Valor26;
     #18#26 = Valor27;
     #18#27 = Valor28;
     #18#28 = Valor29;
     #18#29 = Valor30;
     |SI nSal = 0;
          |GRABA 020#18a;
     |SINO;
          |GRABA 020#18n;
     |FINSI;

     #0#19 = #0#19 + 1;
|FPRC;

|PROCESO ConsumoTeorico;
     |SI Valor4 = 0; |ACABA; |FINSI;

     |SI nLinCon ] 99999; |O nLinCon = 0;
          nLinCon = 0;
          |DDEFECTO #43;
          #43#4 = "CT";
          aSerie = #43#4;
          #43#0 = 999999;
          |LEE 000#43];
          |SI FSalida = 0;
               |LEE 000#43a;
          |SINO;
               |LEE 000#43u;
          |FINSI;
          |SI FSalida = 0; |Y #43#4 = aSerie;
               nConta = #43#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #43;
          #43#0 = nConta;
          #43#4 = aSerie;
          #43#1 = #2#1;
          |GRABA 020#43n;
     |FINSI;

     aFecha = Valor1; |HAZ Fecha;
     aArt = "M" + Valor3 + Valor4; |HAZ LeeArt;

     nLinCon = nLinCon + 1;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nLinCon;
     #44#7 = "S";
     #44#0 = #19#0;
     #44#1 = 1;
     #44#2 = #19#1;
     #44#4 = Valor6;
     |GRABA 020#44n;
     |HAZ AcuESSS;

     #0#18 = #0#18 + 1;
|FPRC;

|PROCESO Pedidos;
     aCaja = Valor1 % 103;

     |DDEFECTO #505;
     #505#0 = 1;    ||Caja 1
     |LEE 000#505=;

     aFecha = Valor2; |HAZ Fecha;
     aConta = Valor1 % 506;

     |DDEFECTO #501;
     #501#0 = aConta;
     #501#1 = "000001";
     #501#2 = "N";
     #501#3 = Valor3;
     |SI Valor7 = "ANULADO";
          #501#2 = "S";
          #501#28 = Valor5; #501#28 = -#501#28;
          #501#9 = 0;
          #501#10 = 0;
     |SINO;
          #501#28 = Valor4; #501#28 = -#501#28;
          #501#9 = Valor5;
          #501#10 = Valor6;
     |FINSI;
     #501#11 = #501#10 - #501#9;
     #501#12 = aCaja;
     #501#13 = "S";
     #501#14 = #2#1;     ||Fecha
     #501#17 = Valor12;
     #501#23 = #501#9 / 1.07;
     #501#24 = #501#9 - #501#23;
     #501#4 = #501#9 - #501#23;
     #501#32 = 1;
     #501#33 = Valor2;
     aHora = Valor9; |HAZ Hora;
     #501#34 = aHora;
     #501#35 = "T";
     #501#36 = aCaja;
     #501#38 = #501#9;
     #501#55 = Valor13;
     |SI Valor10 = "BARRA"; #501#56 = 0; |SINO; #501#56 = 1; |FINSI;
     #501#57 = aCaja;
     #501#58 = #501#0;
     aAlfa = Valor1 % 1202;
     #501#76 = aAlfa;
     |GRABA 020#501n;

     #1#0 = Valor1 % 506;
     #1#1 = #501#36;
     #1#2 = #501#0;
     #1#3 = "T";
     |GRABA 020#1n;

     aAlfa = #501#14 + aCaja;
     #1#0 = aAlfa;
     #1#3 = "C";
     |GRABA 040#1n;

     #0#17 = #0#17 + 1;
|FPRC;

|PROCESO DescripcionPedido;
     #1#0 = Valor1 % 506;
     |LEE 000#1=;
     |SI FSalida ! 0;
          eaCam1 = Valor1; eaCam2 = Valor2; eaCam3 = Valor3;
          eaCam4 = Valor5; eaCam5 = Valor4;
          |SI enSw [ 1; enSw = 2; |PRINT; |FINSI;
          enSw = 3; |PRINT;
          |ACABA;
     |FINSI;

     #501#36 = #1#1;
     #501#0 = #1#2;
     |LEE 020#501=;

     |SI nCodLinAnt ! #501#0;
          nCodLinAnt = #501#0;
          nLinea = 0;
     |FINSI;
     nLinea = nLinea + 1;

     |DDEFECTO #502;
     #502#0 = #1#2;
     #502#1 = nLinea;
     #502#2 = "A" + Valor2;
     #502#3 = #501#32;
     #502#4 = #501#1;
     #502#5 = Valor4;
     #502#6 = Valor6 / Valor4;
     #502#7 = Valor6;
     #502#8 = Valor5;
     #502#9 = #501#14;
     #502#10 = #502#6 / 1.07;
     aArt = #502#2; |HAZ LeeArt;
     #502#11 = #19#2;
     #502#12 = #19#3;
     #502#13 = 2;
     #502#15 = #501#12;
     #502#16 = #501#34;
     #502#17 = #501#33;
     #502#18 = "T";
     #502#19 = #502#7 - (#502#10*#502#5);
     #502#20 = #501#36;
     #502#21 = #502#7 - #502#19;
     #502#23 = #19#9 * #502#5;
     #502#44 = Valor4;
     |GRABA 020#502n;

     #0#15 = #0#15 + 1;
|FPRC;

|PROCESO FormasDePago;
     #1#0 = Valor7 % 506;
     |LEE 000#1=;
     |SI FSalida ! 0;
          eaCam1 = Valor7; eaCam2 = Valor1; eaCam3 = Valor2;
          eaCam4 = Valor3;
          |SI enSw [ 3; enSw = 4; |PRINT; |FINSI;
          enSw = 5; |PRINT;
          |ACABA;
     |FINSI;
     #501#36 = #1#1;
     #501#0 = #1#2;
     |LEE 101#501=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #501#2 = "S"; |ACABA; |FINSI;

     |SI Valor1 = 1; #501#31 = "E"; |FINSI;
     |SI Valor1 = 2; #501#31 = "T"; |FINSI;
     |SI Valor1 = 3; #501#31 = "C"; |FINSI;
     |SI Valor1 = 4; #501#31 = "C"; |FINSI;

     |SI Valor1 = 2;
          #501#40 = #501#40 + Valor4;
          #501#38 = #501#38 - Valor4;
     |FINSI;
     |SI Valor1 = 3; |O Valor1 = 4;
          #501#39 = #501#39 + Valor4;
          #501#38 = #501#38 - Valor4;
     |FINSI;

     |GRABA 020#501a;
     |LIBERA #501;

     #0#16 = #0#16 + 1;
|FPRC;

|PROCESO Cancelaciones;
     #1#0 = Valor1 % 506;
     |LEE 000#1=;
     |SI FSalida ! 0;
          eaCam1 = Valor1; eaCam2 = Valor2; eaCam3 = Valor5;
          eaCam4 = Valor4;
          |SI enSw [ 5; enSw = 6; |PRINT; |FINSI;
          enSw = 7; |PRINT;
          |ACABA;
     |FINSI;

     #0#14 = #0#14 + 1;
|FPRC;


|PROCESO DatosProveedor;
     |DDEFECTO #112;
     #112#0 = "0" + Valor3;
     |LEE 101#112=;
     |SI FSalida ! 0; |GRABA 020#112b; |FINSI;
     #112#1 = Valor4;
     #112#2 = #112#1;
     |GRABA 020#112a;
     |LIBERA #112;

     |DDEFECTO #19;
     #19#0 = Valor1 + Valor2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #19#134 = Valor5;
     #19#195 = Valor6;
     |GRABA 020#19a;
     |LIBERA #19;

     #0#5 = #0#5 + 1;
|FPRC;

|PROCESO CompoArticulo;
     aArt = Valor1; |HAZ LeeArt;
     |DDEFECTO #480;
     #480#0 = Valor1;
     |LEE 000#480=;
     #480#1 = #19#1;
     |SI FSalida ! 0; |GRABA 020#480n; |FINSI;

     aArt = Valor2; |HAZ LeeArt;
     |SELECT #2#49;
     #49#0 = #480#0;
     #49#2 = Valor2;
     |LEE 101#49=;
     |SI FSalida ! 0;
          |SELECT #1#49;
          #49#0 = #480#0;
          #49#1 = 999;
          |LEE 000#49];
          |SI FSalida = 0;
               |LEE 000#49a;
          |SINO;
               |LEE 000#49u;
          |FINSI;
          |SI FSalida = 0; |Y #49#0 = #480#0;
               nConta = #49#1 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #49;
          #49#0 = #480#0;
          #49#1 = nConta;
          #49#2 = Valor2;
          #49#3 = #19#1;
          |GRABA 020#49b;
     |FINSI;
     #49#12 = Valor3;
     |GRABA 020#49a;
     |LIBERA #49;

     #0#6 = #0#6 + 1;
|FPRC;

|PROCESO MateriasPrimas;
     |DDEFECTO #19;
     ||#19#0 = "M" + Valor8;
     #19#0 = "M" + Valor1 + Valor2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #19#2 = Valor1;
     #19#1 = Valor3;
     #19#28 = Valor5;
     #19#133 = Valor5;
     #19#163 = Valor5;
     #19#164 = Valor5;
     #19#5 = Valor4;
     #19#27 = Valor9;
     #19#125 = "M";
     |GRABA 020#19a;
     |LIBERA #19;

     |DDEFECTO #239;
     #239#0 = Valor4;
     |LEE 000#239=;
     |SI FSalida ! 0;
          #239#1 = Valor4;
          #239#2 = Valor4;
          |GRABA 020#239n;
     |FINSI;

     #0#7 = #0#7 + 1;
|FPRC;

|PROCESO FamMateriasPrimas;
     |DDEFECTO #60;
     #60#0 = Valor1;
     |LEE 101#60=;
     |SI FSalida ! 0; |GRABA 020#60b; |FINSI;
     #60#1 = Valor2;
     |GRABA 020#60a;
     |LIBERA #60;

     #0#8 = #0#8 + 1;
|FPRC;

|PROCESO DespMaterias;
     |SI Valor4 = 0; |ACABA; |FINSI;

     |SI nLinMat ] 99999; |O nLinMat = 0;
          nLinMat = 0;
          |DDEFECTO #43;
          #43#4 = "DM";
          aSerie = #43#4;
          #43#0 = 999999;
          |LEE 000#43];
          |SI FSalida = 0;
               |LEE 000#43a;
          |SINO;
               |LEE 000#43u;
          |FINSI;
          |SI FSalida = 0; |Y #43#4 = aSerie;
               nConta = #43#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #43;
          #43#0 = nConta;
          #43#4 = aSerie;
          #43#1 = #2#1;
          |GRABA 020#43n;
     |FINSI;

     aArt = "M" + Valor1 + Valor2; |HAZ LeeArt;

     nLinMat = nLinMat + 1;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nLinMat;
     #44#7 = "S";
     #44#0 = #19#0;
     #44#1 = 1;
     #44#2 = #19#1;
     #44#4 = Valor4;
     |GRABA 020#44n;
     |HAZ AcuESSS;

     #0#9 = #0#9 + 1;
|FPRC;

|PROCESO DespArticulos;
     |SI Valor4 = 0; |ACABA; |FINSI;

     |SI nLinDes ] 99999; |O nLinDes = 0;
          nLinDes = 0;
          |DDEFECTO #43;
          #43#4 = "DA";
          aSerie = #43#4;
          #43#0 = 999999;
          |LEE 000#43];
          |SI FSalida = 0;
               |LEE 000#43a;
          |SINO;
               |LEE 000#43u;
          |FINSI;
          |SI FSalida = 0; |Y #43#4 = aSerie;
               nConta = #43#0 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #43;
          #43#0 = nConta;
          #43#4 = aSerie;
          #43#1 = #2#1;
          |GRABA 020#43n;
     |FINSI;

     aArt = "A" + Valor1 + Valor2 ; |HAZ LeeArt;

     nLinDes = nLinDes + 1;
     |DDEFECTO #44;
     #44#21 = #43#4;
     #44#18 = #43#0;
     #44#8 = nLinDes;
     #44#7 = "S";
     #44#0 = #19#0;
     #44#1 = 1;
     #44#2 = #19#1;
     #44#4 = Valor4;
     |GRABA 020#44n;
     |HAZ AcuESSS;

     #0#10 = #0#10 + 1;
|FPRC;

|PROCESO OfertasProveedo;
     #226#0 = #237#0;
     |LEE 000#226=;
     |SI FSalida = 0; |Y #77#1 ] #226#2; |Y #77#1 [ #226#3;
          |SI #226#5 = "S"; |Y #80#27 ! "";
               |SI aSerie ! #226#6; |ACABA; |FINSI;
          |FINSI;

          |SI nSwOfertaProv = 1;
               aAlfa = "0000Articulo [" + #80#2 + "]" +&13+ "en mas de una oferta.";
               |MENAV aAlfa;
          |FINSI;
          Valor9 = #237#4;
          #80#8 = #237#6;
          nSwOfertaProv = 1;
     |FINSI;
|FPRC;

|DEFBUCLE OfertasProveedo;
     #dsm00237#2;
     ;
     #77#3, #80#2;
     #77#3, #80#2;
     ;
     NULL, OfertasProveedo;
|FIN;

|PROCESO DescripcionAlbaran;
     aAlfa = Valor2 + Valor3 + Valor4;
     #1#0 = aAlfa;
     |LEE 000#1=;
     |SI FSalida ! 0;
          eaCam1 = Valor1; eaCam2 = Valor2; eaCam3 = Valor3; eaCam4 = Valor4;
          eaCam5 = Valor5; eaCam6 = Valor6; eaCam7 = Valor7; eaCam8 = Valor8;
          eaCam9 = Valor9; eaCam10 = Valor10;
          |SI enSw = 0; |PRINT; |FINSI;
          enSw = 1; |PRINT;
          |ACABA;
     |FINSI;
     #80#27 = #1#1;
     #80#0 = #1#2;
     #80#1 = 999;
     |LEE 000#80];
     |SI FSalida = 0;
          |LEE 000#80a;
     |SINO;
          |LEE 000#80u;
     |FINSI;
     |SI FSalida = 0; |Y #80#27 = #1#1;  |Y #80#0 = #1#2;
          nLinea = #80#1 + 1;
     |SINO;
          nLinea = 1;
     |FINSI;

     aArt = "M" + Valor5; |HAZ LeeArt;

     |DDEFECTO #77;
     #77#50 = #80#27;
     #77#0 = #80#0;
     |LEE 000#77=;

     |DDEFECTO #80;
     #80#27 = #1#1;
     #80#0 = #1#2;
     #80#1 = nLinea;
     #80#2 = #19#0;
     #80#3 = (A\(Valor1 % -104));
||     #80#4 = Valor6;
     #80#5 = Valor7;

     #19#0 = #80#2;
     |LEE 000#19=;

     #80#4 = #19#1;

     #agitp001#0 = #77#3
     #agitp001#1 = #80#2
     |LEE 000#agitp001.=;
     |SI FSalida = 0;
          Valor9 = #agitp001#9;
          #80#8 = #agitp001#4;
          #80#26 = #agitp001#5;
          #80#45 = #agitp001#10;
     |SINO;
          |SI #19#133 ! 0;
               Valor9 = #19#28
               #80#8 = #19#29;
               #80#26 = #19#129;
               #80#45 = #19#209;
          |FINSI;
     |FINSI;

     |ABRE #226;
     nSwOfertaProv = 0;
     |BUCLE OfertasProveedo;
     |CIERRA #226;

     #80#6 = Valor9; || precio
     #80#30 = Valor9;
     #80#9 = Valor10;|| impor
     #80#31 = Valor10;
     #80#11 = #19#30;
     #80#13 = #19#2;
     #80#15 = #77#3;

     |SI #19#204 = "S";
          |ABRE #241;
          |DDEFECTO #241;
          #241#0 = #19#5;
          #241#2 = #19#205;
          |SELECT #2#241;     ||LA LECTURA ES POR LA CLAVE 2
          |LEE 000#241=;
          |SI FSalida = 0;
               |SI #241#6 = "D";
                    #80#5 = Valor7 / #241#5;
                    #80#6 = Valor9 * #241#5;
               |SINO;
                    #80#5 = Valor7 * #241#5;
                    #80#6 = Valor9 / #241#5;
               |FINSI;
               #80#36 = Valor7;
               #80#43 = #19#205;
          |FINSI;
          |CIERRA #241;
     |FINSI;
     #80#30 = #80#6;
     #80#32 = #80#6;
     #80#7 = #80#5 * #80#6;
     #80#9 = (((#80#5 * #80#6) < #80#8) < #80#26) < #80#45;
     #80#31 = #80#9;
     #80#33 = #80#9;
     |GRABA 020#80n;

     #0#11 = #0#11 + 1;
|FPRC;

|PROCESO Albaran;
     aPro = Valor3; |HAZ LeePro;

     aFecha = Valor5; |HAZ Fecha;
     |DDEFECTO #77;
     enSwMenu = 1;
     |HAZ ContaAC7;
     #77#1 = fFecha;
     #77#3 = "0" + Valor3;
     #77#4 = Valor4;
     #77#54 = Valor6;
     #77#55 = Valor7;
     #77#64 = Valor7;
     #77#66 = Valor7;
     #77#68 = Valor7;
     #77#30 = #112#3;
     #77#31 = #112#4;
     #77#33 = #112#5;
     #77#56 = "EUR";
     #77#57 = 1;
     #77#61 = "EUR";
     #77#62 = 1;
     |GRABA 020#77n;

     || EL Proveedor
     |DDEFECTO #112;
     #112#0 = #77#3;
     |LEE 000#112=;
     |SI FSalida ! 0;
          #112#1 = #77#4;
          #112#2 = #112#1;
          |GRABA 020#112n;
     |FINSI;

     aAlfa = Valor3 + Valor5 + Valor6;
     #1#0 = aAlfa;
     #1#1 = #77#50;
     #1#2 = #77#0;
     #1#3 = "A";
     |GRABA 020#1n;

     #0#12 = #0#12 + 1;
|FPRC;

|PROCESO Articulos;
     |DDEFECTO #19;
     #19#0 = "A" + Valor1 + Valor2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     #19#2 = Valor1;
     #19#1 = Valor3;
     #19#18 = Valor5;
     #19#19 = Valor6;
     #19#20 = Valor7;
     #19#147 = Valor8;
     #19#148 = Valor9;
     #19#149 = Valor10;
  ||   |SI Valor12 = "A"; #19#30 = 2; |FINSI;
  ||   |SI Valor12 = "2"; #19#30 = 7; |FINSI;
     #19#25 = 1;
     #19#125 = "A";
     |GRABA 020#19a;
     |LIBERA #19;
     #0#13 = #0#13 + 1;
|FPRC;
=========================================================================
|PROCESO Dato;
     IValor = Valor1<-;
     |PARA i = 1; |SI i [ 90; |HACIENDO i = i + 1;
          Valor = "";
          IValor = IValor + 1;
     |SIGUE;
     nCampo = 1;
     IValor = Valor1<-;
     aLon = aDato % A0;
     aReg = "";
     aTab = &9;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aLetra = aDato % nPos;
          |SI aLetra = aTab;
               Valor = aReg;
               aReg = "";
               nCampo = nCampo + 1;
               IValor = IValor + 1;
          |SINO;
               aReg = aReg + aLetra;
          |FINSI;
          |SI nCampo > 90; |SAL; |FINSI;     || Por si.... :)
     |SIGUE;
     Valor = aReg;
|FPRC;

|PROCESO vipem003;
     |SI aTablaAnt ! #3#2;
          aTablaAnt = #3#2;
          aAlfa = "0000Procesando tabla " + #3#2;
          |MENSA aAlfa;
     |FINSI;

     aDato = #3#3; |QBF aDato;
     |HAZ Dato;

     aTabla = #3#2; |QBF aTabla;
   |||SI aTabla = "datosproveedor"; |HAZ DatosProveedor; |FINSI;
     |SI aTabla = "articulos"; |HAZ Articulos; |FINSI;
     |SI aTabla = "fammateriasprimas"; |HAZ FamMateriasPrimas; |FINSI;
     |SI aTabla = "materiasprimas"; |HAZ MateriasPrimas; |FINSI;
   |||SI aTabla = "compoarticulo"; |HAZ CompoArticulo; |FINSI;
   ||  |SI aTabla = "desparticulos"; |HAZ DespArticulos; |FINSI;
   ||  |SI aTabla = "despmaterias"; |HAZ DespMaterias; |FINSI;
     |SI aTabla = "albaran"; |HAZ Albaran; |FINSI;
     |SI aTabla = "descripcionalbaran"; |HAZ DescripcionAlbaran; |FINSI;
   |||SI aTabla = "cancelaciones"; |HAZ Cancelaciones; |FINSI;
     |SI aTabla = "descripcionpedido"; |HAZ DescripcionPedido; |FINSI;
     |SI aTabla = "formasdepago"; |HAZ FormasDePago; |FINSI;
     |SI aTabla = "pedidos"; |HAZ Pedidos; |FINSI;
   ||  |SI aTabla = "consumoteorico"; |HAZ ConsumoTeorico; |FINSI;
     |SI aTabla = "stockperiodo"; |HAZ StockPeriodo; |FINSI;
|FPRC;

|PROCESO vipem002Fin;
     #2#5 = "S";
     |GRABA 020#2a;
     |LIBERA #2;

|FPRC;

|DEFBUCLE vipem002;
     #2#1;
     1,5;
     00000001, #0#1, "N";
     99999999, #0#2, "N";
     be;
     NULL, NULL, vipem003, vipem002Fin;
|FIN;

|PROCESO RecalLinAlba;
     |HAZ TotalLin80;
     |GRABA 020#80a;
     |HAZ CalCabAgifa077;
     |LIBERA #80;
|FPRC;

|PROCESO RecalAlba;
     |SI #1#3 ! "A";
          |ACABA;
     |FINSI;

     #77#50 = #1#1;
     #77#0 = #1#2;
     |LEE 121#77=;
     |SI FSalida = 0;
          aDivisa = #77#56;
          aMoneda = #77#58;
          |HAZ Divisas077;
          |HAZ LimCabAgifa077;
          |BUCLELIN 0 RecalLinAlba #77;
          |BUCLELIN 0 pcmlinea #77;
          |GRABA 020#77a;
          |LIBERA #77;
     |FINSI;
|FPRC;

|DEFBUCLE RecalAlba;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, RecalAlba;
|FIN;

|PROCESO RecalTiquetLin;
     aArt = #502#2; |HAZ LeeArt;

     #501#76 = #501#76 + #502#5;

     |HAZ AcumulaTPV;
|FPRC;

|DEFBUCLE RecalTiquetLin;
     #502#1;
     ;
     #501#36, #501#0, 001;
     #501#36, #501#0, 999;
     ;
     NULL, RecalTiquetLin;
|FIN;

|PROCESO RecalTiquet;
     |SI #1#3 ! "T";
          |ACABA;
     |FINSI;

     #501#36 = #1#1;
     #501#0 = #1#2;
     |LEE 101#501=;
     |SI FSalida = 0;
          aCli = #501#1; |HAZ LeeCli;
          #501#76 = 0;
          |BUCLE RecalTiquetLin;
          |GRABA 020#501a;
          |LIBERA #501;

          |DDEFECTO #24;
          #24#0 = #501#1;
          |LEE 101#24=;
          |SI FSalida ! 0; |GRABA 020#24b; |FINSI;
          fmes = #501#24 % A402;
          mes = ((fmes - 1) * 4) + 54;
          imneto = #501#3 - nDto;
          |SI #142#115 = "N";
               nImpo = (imneto * 100) / (100 - #501#18);
               nDto = nDto + (imneto - nImpo);
          |SINO;
               nImpo = imneto;
          |FINSI;
          #24mes = #24mes +. nImpo;
          mes = mes + 1;
          #24mes = #24mes +. nDto;
          mes = mes + 1;
          #24mes = #24mes +. #501#8;
          #24#102 = #24#102 +. nImpo;
          #24#103 = #24#103 +. nDto;
          #24#104 = #24#104 +. #501#8;
          beta = (FEntrada / 100) ! 0;
          |SI beta = 1;
               #24#45 = #501#24;
          |FINSI;
          #24#46 = imneto;
          #24#110 = #24#110 +. imneto;

          enImpCliCom = nImpo;
          enImpCliDto = nDto;
          enImpCliMar = #501#8;
          enImpCliFac = imneto;
          eaCliente = #501#1;
          efFecha = #501#14;
          |HAZ AcumulaCli;
          |GRABA 020#24a;
          |LIBERA #24;
     |FINSI;
|FPRC;

|DEFBUCLE RecalTiquet;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, RecalTiquet;
|FIN;

|PROCESO CreaResumen;
     |SI #1#3 ! "C";
          |ACABA;
     |FINSI;

     |DFICE aAlfa;
     aAlfa = aAlfa % -205;

     eTienda = aAlfa;;
     eCaja = (A\(#1#0 % 11));
     eFecha = (A\(#1#0 % 110));
     |SUB_EJECUTA_NP "agifa565;algo";
|FPRC;

|DEFBUCLE CreaResumen;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CreaResumen;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vipez002";
          |SI FSalida ! 0;
               |MENAV "0000No existe informe 'vipez002'";
          |SINO;
               |HAZ DecimalesBase;
               |ABRE #142; |LEE 000#142p; |CIERRA #142;
               |DFICE aEmpre;
               aEmpre = aEmpre % -205;

               aAlfa = Usuario;
               |NOME_DAT #1 aAlfa; |DELINDEX #1;
               |ABRET #19;
               |ABRET #17;
               |ABRET #112;
               |ABRE #1;
               |ABRE #77;
               |ABRE #43;
               |ABRE #44;
               |ABRE #60;
               |ABRE #480;
               |ABRE #49;
               |ABRE #501;
               |ABRE #502;
               |ABRE #505;
               |ABRE #24;
               |ABRE #29;
               |ABRE #509;
               |ABRE #80;
               |ABRE #239;
               |ABRE #18;
               |ABRE #agitp001;

               |BUCLE vipem002;

               |MENSA "0000Recalculando Tiquets";
               |BUCLE RecalTiquet;

               |MENSA "0000Creando Resumem";
               |BUCLE CreaResumen;

               |MENSA "0000Recalculando Albaran";
               |BUCLE RecalAlba;

               |CIERRA #agitp001;
               |CIERRA #18;
               |CIERRA #239;
               |CIERRA #80;
               |CIERRA #509;
               |CIERRA #29;
               |CIERRA #24;
               |CIERRA #505;
               |CIERRA #502;
               |CIERRA #501;
               |CIERRA #49;
               |CIERRA #480;
               |CIERRA #60;
               |CIERRA #44;
               |CIERRA #43;
               |CIERRA #77;
               |CIERRA #1;
               |CIERRAT #19;
               |CIERRAT #17;
               |CIERRAT #112;
               |DELINDEX #1;
               enSw = 8; |PRINT;
               enSw = 9;
               |PARA i = 3; |SI i [ 19; |HACIENDO i = i + 1;
                    enRegistro = #0i;
                    eaTabla = "";
               ||     |SI i = 5; eaTabla = "DatosProvedor"; |FINSI;
               ||     |SI i = 6; eaTabla = "CompoArticulo"; |FINSI;
                    |SI i = 7; eaTabla = "MateriasPrimas"; |FINSI;
                    |SI i = 8; eaTabla = "FAMMateriasPrimas"; |FINSI;
               ||     |SI i = 9; eaTabla = "DespMaterias"; |FINSI;
               ||     |SI i = 10; eaTabla = "DespArticulos"; |FINSI;
                    |SI i = 11; eaTabla = "DescripcionAlbaran"; |FINSI;
                    |SI i = 12; eaTabla = "Albaran"; |FINSI;
                    |SI i = 13; eaTabla = "Articulos"; |FINSI;
               ||     |SI i = 14; eaTabla = "Cancelaciones"; |FINSI;
                    |SI i = 15; eaTabla = "DescripcioPedido"; |FINSI;
                    |SI i = 16; eaTabla = "FormasDePago"; |FINSI;
                    |SI i = 17; eaTabla = "Pedidos"; |FINSI;
              ||      |SI i = 18; eaTabla = "ConsumoTeorico"; |FINSI;
                    |SI i = 19; eaTabla = "StockPeriodo"; |FINSI;
                    |SI eaTabla ! ""; |PRINT; |FINSI;
               |SIGUE;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |PARA i = 3; |SI i [ 19; |HACIENDO i = i + 1;
          #0i = 0;
     |SIGUE;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
