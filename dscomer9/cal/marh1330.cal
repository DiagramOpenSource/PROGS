|| Secuencias de Escape  marhu330 y marhu331

|VARIABLES;
     &eaCampo = "";
     &eaSecu1 = "";
     &eaSecu2 = "";
     ascii = "";
     secu  = "";
     traba = "";
     trab1 = "";
     trab2 = "";
     trab3 = "";
     nume = 0;
     num1 = 0;
     num2 = 0;
     x = 0;
     y = 0;
|FIN;

|PROCESO PasaaNume;
     secu = "";
     trab1 = traba % 0;
     nume = trab1;
     |PARA x = 1; |SI x [ nume;  |HACIENDO x = x + 1;
          num1 = (100 *  x) + 1;
          trab2 = num1;
          trab1 = traba % trab2;
          |SI trab1 = "\";
               |HAZ SecEscape;
               trab2 = trab1;
          |SINO;
               num1 = &trab1;
               trab2 = num1;
          |FINSI;

          ascii = "000" + trab2;  ascii = ascii % -103;
          |SI ascii = "000"; |O ascii = "027";
               secu = secu + &27 + ascii;
          |SINO;
               secu = secu + &trab2;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO SecEscape;
     trab3 = "";
     x = x + 1;
     num1 = (100 * x) + 1;
     trab2 = num1;
     trab1 = traba % trab2;
     |SI trab1 = "\";
          trab1 = "92";
          |ACABA;
     |FINSI;
     trab3 = trab3 + trab1;
     x = x + 1;
     num1 = (100 * x) + 1;
     trab2 = num1;
     trab1 = traba % trab2;
     |SI trab1 = "\";
          trab1 = trab3;
          |ACABA;
     |FINSI;
     trab3 = trab3 + trab1;
     x = x + 1;
     num1 = (100 * x) + 1;
     trab2 =  num1;
     trab1 = traba % trab2;
     |SI trab1 = "\";
          trab1 = trab3;
          |ACABA;
     |FINSI;
     trab3 = trab3 + trab1;
     x = x + 1;
     trab1 = trab3;
|FPRC;

|PROCESO Secuencias;
     traba = eaSecu1;
     |HAZ PasaaNume;
     eaSecu1 = secu;

     traba = eaSecu2;
     |HAZ PasaaNume;
     eaSecu2 = secu;
|FPRC;

|PROCESO comprueba;
  traba = eaCampo;
  |QBF traba;
  trab1 = traba % 0;
  nume = trab1;
  |PARA x = 1;  |SI x [ nume; |HACIENDO x = x + 1;
        num1 = (100 *  x) + 1;
        trab2 = num1;
        trab1 = traba % trab2;
        num2 = 0;
        |SI trab1 = "\";
            |HAZ escapes;
        |FINSI;
        |SI num2 ! 0;
            |MENAV "     N£mero incongruente en secuencias de ESCAPE";
            |ERROR;
            |SAL;
        |FINSI;
  |SIGUE;
|FPRC;

|PROCESO escapes;
  trab3 = "":
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 = num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 = num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab3 + trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 =  num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab3 + trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 =  num1;
  trab1 = traba % trab2;
  |SI trab1 ! "\";
      |ACABA;
  |FINSI;
  |SI trab3 > "255";
      num2 = 1;
  |FINSI;
|FPRC;
