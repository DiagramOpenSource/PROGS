|FICHEROS;
     sctrz015 #0;
     sctrm003 #3;
     sctrm004 #4;
     sctrm008 #8;
     sctrm010 #10;
     sctrm011 #11;
     sctrm012 #12;
     sctrm021 #21;
     sctrm022 #22;
     sctrm023 #23;
     sctrm024 #24,MANTE;
     sctrm025 #25,MANTE;
     sctrm026 #26;
     sctrm027 #27;
     sctrm028 #28;
     sctrm057 #57;
     sctrm069 #69;
     sctrm001 #100;
     sctrz014 #114,MANTE;     ||Pan Trafico Diario
     sctrz016 #116,MANTE;     ||Pan Cab
     sctrz065 #165,MANTE;     ||Pan Crea Masiva
     referen@ #1;
|FIN;

|VARIABLES;
     nForma = 0;
     aInf = "";
     &eaMensaje = "";
     &eaTempo = "";
     &eaSentido = "";
     &enServicio = 0;
     &efFecha = @;
     &eaModo = "";
     &enLinServi = 0;
     &eaNomLogo = "";
     &enPantaLogo = 0;
     &enCtrFin = 0;
     &Tempo = "";
     aAlfa = "";
     nModoCab = 0;
     nModoPeri = 0;
     nModoPobla = 0;
     nModoTra = 0;
     nPanta = 0;
     nPantaCab = 0;
     nPantaPeri = 0;
     nPantaPobla = 0;
     nRango = 0;
     nGridCab = 0;
     nGridPeri = 0;
     nGridPobla = 0;
     nGridTra = 0;
     nBtnAlta = 0;
     nBtnModi = 0;
     nBtnBaja = 0;
     nBtnCons = 0;
     nBtnImpr = 0;
     nBtnTodos = 0;
     nBtnTrafico = 0;
     nBtnMasiva = 0;
     nBtnAltaTrafico = 0;
     nBtnModiTrafico = 0;
     nBtnBajaTrafico = 0;
     nBtnConsTrafico = 0;
     i = 0;
     aReg0 = "";
     nReg2 = 0;
     aReg4 = "";
     nReg5 = 0;
     aRegTra0 = "";
     nRegTra2 = 0;
     aRegTra4 = "";
     nRegTra5 = 0;
     aRegTra7 = "";
     nBloquea = 0;
     nId = 0;
     nSwFin = 0;
     nLin = 0;
     aHora = "";
     aMinu = "";
     nHora = 0;
     nMinu = 0;
     aDias = "";
     aCar = "";
     nPos = 0;
     nDia1 = 0;
     nDia2 = 0;
     nDia3 = 0;
     nDia4 = 0;
     nDia5 = 0;
     nDia6 = 0;
     nDia7 = 0;
     aLon = "";
     nError = 0;
     nCampo = 0;
     fFecha = @;
     aConte = "";
     nSwBorra = 0;
     aLetraDia = "";
     aDiaSemanaN = "";
     aDiaSemanaL = "";
     f = @;
     nSwCheq = 0;
     nHay = 0;
     nKms = 0;
     nLinea = 0;
     aSentido = "";
|FIN;

|PROCESO ViajerosLinea;
     #69#0 = #26#2;
     #69#1 = #26#4;
     #69#2 = #26#7;
     |LEE 000#69=;
     |SI FSalida ! 0;
          #69#3 = #26#20;
          #69#4 = 0;
          #69#5 = "N";
          |GRABA 020#69n;
     |FINSI;
|FPRC;

|PROCESO PeriodosM;
     #23#0 = #24#0;
     #23#2 = #24#1;
     #23#4 = #24#2;
     #23#5 = #24#3;
     |LEE 000#23=;
     |SI FSalida = 0;
          |HAZ Periodos;
     |FINSI;
|FPRC;

|DEFBUCLE PeriodosM;
     #24#1;
     ;
     #165#0, #12#0, #165#3, #165#5, 00;
     #165#0, #12#0, #165#4, #165#6, 99;
     ;
     NULL, PeriodosM;
|FIN;

|PROCESO TraficoM;
     |SI #26#27 = 0;
          #24#0 = #26#0;
          #24#1 = #26#2;
          #24#2 = #26#4;
          #24#3 = #26#5;
          #24#4 = 0;
          |LEE 000#24];
          |SI FSalida = 0; |Y #24#0 = #26#0; |Y #24#1 = #26#2; |Y #24#2 = #26#4;
                    |Y #24#3 = #26#5;
               |SI #26#7 ] #24#5; |Y #26#7 [ #24#6;
                    fFecha = #26#7;
                    |HAZ DiaSemana;
                    aAlfa = #24#7; |QBF aAlfa;
                    |SI aAlfa ! "*";
                         aAlfa = aAlfa - aDiaSemanaN;
                         |SI FSalida [ 0;
                              |BORRA 020#26a;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |BORRA 020#26a;
               |FINSI;
          |SINO;
               |BORRA 020#26a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE TraficoM;
     #26#1;
     ;
     #165#0, #12#0, #165#3, #165#5, "01.01.0000";
     #165#0, #12#0, #165#4, #165#6, "31.12.9999";
     be;
     NULL, TraficoM;
|FIN;

|PROCESO CreaTraficoMasivo;
     |SALVA_FICHA #23;

     |ABRE #69;
     |ABRE #24;
     |BUCLE TraficoM;
     |CIERRA #24;

     nLinea = 0; aSentido = "";
     |ABRE #26;
     |ABRE #21;
     |DDEF aAlfa; aAlfa = aAlfa + "sctrm023";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          |BUCLE PeriodosM;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
     |CIERRA #21;
     |CIERRA #26;
     |CIERRA #69;

     |REPON_FICHA #23;
|FPRC;

|PROCESO LineaServicio;
     |HAZ CreaTraficoMasivo;
|FPRC;

|DEFBUCLE LineaServicio;
     #12#1;
     ;
     #165#1;
     #165#2;
     ;
     NULL, LineaServicio;
|FIN;

|PROCESO CargaServi;
     |SALVA_DATOS #23;
     |REPON_DATOS #referen@;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE CargaServi;
     #23#1;
     ;
     #165#0, #165#1, #165#3, 000000;
     #165#0, #165#2, #165#4, 999999;
     ;
     NULL, CargaServi;
|FIN;

|PROCESO Servi66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm023";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |HAZ CreaTempo; |NOME_DAT #referen@#Tempo#; |DELINDEX #referen@;
          |ABRE #referen@;
          |BUCLE CargaServi;
          #referen@#0 = #165#0;
          #referen@#2 = #165#1;
          #referen@#4 = #165#3;
          #referen@#5 = #165#4;
          |LEE 000#referen@.];
          |CONSULTA_CLAVE #1#referen@;
          |SI FSalida = 0;
               #165Campo = #referen@#5; |PINTA #165Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #23;
          |HAZ BoraTempo; |DELINDEX #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO BtnMasiva;
     |VENTANA 1020, 2080, -1, 17, "Creaci¢n Masiva Tr fico Diario";
     |HAZ PushVenModal;
     |PINPA #0#165;
     |PINDA #0#165;
     |ENDATOS #1#165;
     |SI FSalida = 0;
          eaMensaje = "Creaci¢n masiva..."; |HAZ IniMensaje;
          |BUCLE LineaServicio;
          |HAZ FinMensaje;
     |FINSI;
     |HAZ PopVenModal;
|FPRC;

|PROCESO DiaSemana;
     fFecha = fFecha % A1; aAlfa = fFecha % 1102;
     |SI aAlfa = "Lu"; aDiaSemanaN = "1"; aDiaSemanaL = "L"; |FINSI;
     |SI aAlfa = "Ma"; aDiaSemanaN = "2"; aDiaSemanaL = "M"; |FINSI;
     |SI aAlfa = "Mi"; aDiaSemanaN = "3"; aDiaSemanaL = "X"; |FINSI;
     |SI aAlfa = "Ju"; aDiaSemanaN = "4"; aDiaSemanaL = "J"; |FINSI;
     |SI aAlfa = "Vi"; aDiaSemanaN = "5"; aDiaSemanaL = "V"; |FINSI;
     |SI aAlfa = "Sa"; aDiaSemanaN = "6"; aDiaSemanaL = "S"; |FINSI;
     |SI aAlfa = "Do"; aDiaSemanaN = "7"; aDiaSemanaL = "D"; |FINSI;
|FPRC;

|PROCESO LeeKms;
     |SI nLinea ! #24#1; |O aSentido ! #24#2;
          nLinea = #24#1;
          aSentido = #24#2;

          #21#0 = #24#1;
          |SI #24#2 = "I";
               #21#2 = #23#9;
               #21#4 = #23#11;
          |SINO;
               #21#2 = #23#11;
               #21#4 = #23#9;
          |FINSI;
          |LEE 000#21=;
          |SI FSalida = 0;
               nKms = #21#6;
          |SINO;
               nKms = 0;
               aAlfa = "0000No estan configurados los kilometros del trayecto l¡nea/origen/destino:" + #21#0 + "/" + #21#2 + "/" + #21#4;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Periodos;
     |HAZ LeeKms;
     |PARA f = #24#5; |SI f [ #24#6; |HACIENDO f = f + 1;
          fFecha = f;
          |HAZ DiaSemana;
          aAlfa = #24#7; |QBF aAlfa;
          |SI aAlfa ! "*";
               aAlfa = aAlfa - aDiaSemanaN;
          |SINO;
               FSalida = "1";
          |FINSI;
          |SI FSalida > 0;
               |DDEFECTO #26;
               #26#0 = #23#0;
               #26#1 = #23#1;
               #26#2 = #23#2;
               #26#3 = #23#3;
               #26#4 = #23#4;
               #26#5 = #23#5;
               #26#6 = #23#6;
               #26#7 = f;
               |LEE 101#26=;
               |SI FSalida ! 0; |GRABA 020#26b; |FINSI;
               |SI #26#27 = 0;
                    fFecha = f % A1;
                    #26#8 = fFecha % 11;

                    #26#13 = #23#9;
                    #26#14 = #23#10;
                    #26#19 = #23#15;
                    #26#20 = #23#16;
                    #26#21 = #23#17;
                    |SI #24#8 = "S";
                         #26#24 = "A";
                    |SINO;
                         #26#24 = "S";
                    |FINSI;
                    #26#22 = nKms;

                    #referen@#0 = #26#0;
                    #referen@#2 = #26#2;
                    #referen@#4 = #26#4;
                    #referen@#5 = #26#5;
                    |LEE 000#referen@.=;
                    |SI FSalida = 0;
                         #26#15 = #referen@#11;
                         #26#16 = #referen@#12;
                         #26#17 = #referen@#13;
                         #26#18 = #referen@#14;
                    |FINSI;

                    |GRABA 020#26a;
                    |HAZ ViajerosLinea;
               |FINSI;
               |LIBERA #26;
          |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE Periodos;
     #24#1;
     ;
     #23#0, #23#2, #23#4, #23#5, 00;
     #23#0, #23#2, #23#4, #23#5, 99;
     ;
     NULL, Periodos;
|FIN;

|PROCESO Trafico;
     |SI #26#27 = 0;
          #24#0 = #26#0;
          #24#1 = #26#2;
          #24#2 = #26#4;
          #24#3 = #26#5;
          #24#4 = 0;
          |LEE 000#24];
          |SI FSalida = 0; |Y #24#0 = #26#0; |Y #24#1 = #26#2;
                    |Y #24#2 = #26#4; |Y #24#3 = #26#5;
               |SI #26#7 ] #24#5; |Y #26#7 [ #24#6;
                    fFecha = #26#7;
                    |HAZ DiaSemana;
                    aAlfa = #24#7; |QBF aAlfa;
                    |SI aAlfa ! "*";
                         aAlfa = aAlfa - aDiaSemanaN;
                         |SI FSalida [ 0;
                              |BORRA 020#26a;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |BORRA 020#26a;
               |FINSI;
          |SINO;
               |BORRA 020#26a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Trafico;
     #26#1;
     ;
     #23#0, #23#2, #23#4, #23#5, "01.01.0000";
     #23#0, #23#2, #23#4, #23#5, "31.12.9999";
     be;
     NULL, Trafico;
|FIN;

|PROCESO CreaTrafico;
     |ABRE #69;
     |ABRE #24;
     |BUCLE Trafico
     |CIERRA #24;

     nLinea = 0; aSentido = "";
     |ABRE #26;
     |ABRE #21;
     |DDEF aAlfa; aAlfa = aAlfa + "sctrm023";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          |BUCLE Periodos;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
     |CIERRA #21;
     |CIERRA #26;
     |CIERRA #69;
|FPRC;

|PROCESO Hora114; |TIPO 0;
     aAlfa = #114Campo;
     |HAZ FormaHora;
     #114Campo = aAlfa; |PINTA #114Campo;
|FPRC;

|PROCESO PobSal114; |TIPO 0;
     |ABRE #3;
     #3#0 = #114#13;
     |LEE 000#3=;
     |SI FSalida = 0;
          #114#14 = #3#1; |PINTA #114#14;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO PobLlega114; |TIPO 0;
     |ABRE #3;
     #3#0 = #114#15;
     |LEE 000#3=;
     |SI FSalida = 0;
          #114#16 = #3#1; |PINTA #114#16;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Conductor; |TIPO 0;
     |SI aConte ! #114Campo;
          |SI #114Campo = 0;
               nCampo = Campo + 1;
               #114nCampo = ""; |PINTA #114nCampo;
          |SINO;
               |ABRE #27;
               #27#0 = #114Campo;
               |LEE 000#27=;
               |SI FSalida = 0;
                    nCampo = Campo + 1;
                    #114nCampo = #27#1; |PINTA #114nCampo;
               |SINO;
                    |MENAV "0000No existe c¢digo de conductor...";
                    |ERROR;
               |FINSI;
               |CIERRA #27;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Matri0; |TIPO 0;
     |ABRE #28;
     |SELECT #2#28;
     #28#1 = #114#12;
     |LEE 000#28=;
     |SI FSalida = 0;
          #114#11 = #28#0; |PINTA #114#11;
     |SINO;
          |MENAV "0000No existe matr¡cula...";
          |ERROR;
     |FINSI;
     |CIERRA #28;
|FPRC;

|PROCESO Matri66; |TIPO 66;
     |ABRE #28;
     |SELECT #2#28;
     #28#1 = #114#12;
     |CONSULTA_CLAVE #2#28;
     |SI FSalida = 0;
          #114#12 = #28#1; |PINTA #114#12;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #28;
|FPRC;

|PROCESO Vehiculo; |TIPO 0;
     |SI #114#11 = 0;
          |C_M #114#12, 1, "S"; |PINTA #114#12;
     |SINO;
          |ABRE #28;
          #28#0 = #114#11;
          |LEE 000#28=;
          |SI FSalida = 0;
               #114#12 = #28#1; |PINTA #114#12;
               |C_M #114#12, 1, "N"; |PINTA #114#12;
               |SI aConte ! #114#11;
                    #114#25 = #28#9; |PINTA #114#25;
               |FINSI;
          |SINO;
               |MENAV "0000No existe c¢digo de veh¡culo...";
               |ERROR;
          |FINSI;
          |CIERRA #28;
     |FINSI;
|FPRC;

|PROCESO Socio; |TIPO 0;
     |ABRE #10;
     #10#0 = #114#9;
     |LEE 000#10=;
     |SI FSalida = 0;
          #114#10 = #10#1; |PINTA #114#10;
     |SINO;
          |MENAV "0000No existe c¢digo de socio...";
          |ERROR;
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO Chequea114; |TIPO 0;
     |SI nModoTra = 1; |Y nBloquea = 0;
          fFecha = #114#7 % A1;
          #114#8 = fFecha % 11; |PINTA #114#8;

          |DDEFECTO #26;
          #26#0 = #114#0;
          #26#2 = #114#2;
          #26#4 = #114#4;
          #26#5 = #114#5;
          #26#7 = #114#7;
          |GRABA 000#26b;

          |SI FSalida ! 0;
               |MENAV "0000Registro existente...";
               |ERROR;
          |SINO;
               |C_M #114#7, 1, "N";
               nBloquea = 1;

               aAlfa  = "|X000"; aAlfa = #114aAlfa; nId = aAlfa;
               |ESTADO_CONTROL nId, "ENABLE";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Valida114; |TIPO 7;
     |SI nModoTra = 1;
          aAlfa  = "|X000"; aAlfa = #114aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Conte114; |TIPO 7;
     aConte = #114Campo;
|FPRC;

|PROCESO EditaTrafico;
     aRegTra0 = #26#0;
     nRegTra2 = #26#2;
     aRegTra4 = #26#4;
     nRegTra5 = #26#5;
     aRegTra7 = #26#7;

     |SI nModoTra = 1; |VENTANA 901, 2898, -1, 17, "Nueva Fecha Viaje"; |FINSI;
     |SI nModoTra = 2; |VENTANA 901, 2898, -1, 17, "Modifica Fecha Viaje"; |FINSI;
     |SI nModoTra = 4; |VENTANA 901, 2898, -1, 17, "Consulta Fecha Viaje"; |FINSI;
     |HAZ PushVenModal;

     |SI nModoTra = 1;
          |DDEFECTO #114;
          #114#0 = #23#0;
          #114#1 = #23#1;
          #114#2 = #23#2;
          #114#3 = #23#3;
          #114#4 = #23#4;
          #114#5 = #23#5;
          #114#6 = #23#6;
          #114#15 = #23#11;
          #114#16 = #23#12;
          #114#17 = #23#13;
          #114#18 = #23#14;
          |C_M #114#7, 1, "S";
     |SINO;
          |PARA i = 0; |SI i [ 38; |HACIENDO i = i + 1;
               #114i = #26i;
          |SIGUE;
          |C_M #114#7, 1, "N";
     |FINSI;

     |SI #114#4 = "I";
          #114#39 = "IDA";
     |SINO;
          #114#39 = "VUELTA";
     |FINSI;
     |PINPA #0#114;
     |PINDA #0#114;

     nBloquea = 0;
     |SI nModoTra = 1; |ENDATOS #1#114; |FINSI;
     |SI nModoTra = 2; |ENDATOS #2#114; |FINSI;
     |SI nModoTra = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModoTra ! 4;
          #26#0 = #114#0;
          #26#2 = #114#2;
          #26#4 = #114#4;
          #26#5 = #114#5;
          #26#7 = #114#7;
          |LEE 121#26=;
          |PARA i = 0; |SI i [ 38; |HACIENDO i = i + 1;
               #26i = #114i;
          |SIGUE;
          |GRABA 020#26a;
          aRegTra0 = #26#0;
          nRegTra2 = #26#2;
          aRegTra4 = #26#4;
          nRegTra5 = #26#5;
          aRegTra7 = #26#7;
     |SINO;
          |SI nBloquea = 1;
               #26#0 = #114#0;
               #26#2 = #114#2;
               #26#4 = #114#4;
               #26#5 = #114#5;
               #26#7 = #114#7;
               |BORRA 020#26c;
          |FINSI;
     |FINSI;
     |LIBERA #26;

     |HAZ PopVenModal;

     #26#0 = aRegTra0;
     #26#2 = nRegTra2;
     #26#4 = aRegTra4;
     #26#5 = nRegTra5;
     #26#7 = aRegTra7;
     |LEE 000#26=;
     |REFRESCACONTROL nGridTra;
|FPRC;

|PROCESO BtnAltaTrafico;
     nModoTra = 1; |HAZ EditaTrafico;
     |HAZ TieneLineas26;
|FPRC;

|PROCESO BtnModiTrafico;
     |LEE 100#26=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoTra = 2; |HAZ EditaTrafico;
|FPRC;

|PROCESO BtnBajaTrafico;
     |LEE 100#26=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     aAlfa = "0000N¨Borrar fecha viaje: " + #26#7 + "?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |BORRA 020#26a;
          |HAZ TieneLineas26;
          |REFRESCACONTROL nGridTra;
     |FINSI;
     |LIBERA #26;
|FPRC;

|PROCESO BtnConsTrafico;
     |LEE 000#26=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoTra = 4; |HAZ EditaTrafico;
|FPRC;

|PROCESO TieneLineas26;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm026";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #23#0;
          #referen@#2 = #23#2;
          #referen@#4 = #23#4;
          #referen@#5 = #23#5;
          #referen@#7 = "01.01.0000";
          |LEE 000#referen@.];
          |SI FSalida = 0; |Y #referen@#0 = #23#0; |Y #referen@#2 = #23#2;
                    |Y #referen@#4 = #23#4; |Y #referen@#5 = #23#5;
               |ESTADO_CONTROL nBtnModiTrafico, "ENABLE";
               |ESTADO_CONTROL nBtnBajaTrafico, "ENABLE";
               |ESTADO_CONTROL nBtnConsTrafico, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBtnModiTrafico, "DISABLE";
               |ESTADO_CONTROL nBtnBajaTrafico, "DISABLE";
               |ESTADO_CONTROL nBtnConsTrafico, "DISABLE";
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Evento26;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#26;
          |LEE 000#26=;
          |HAZ TieneLineas26;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnConsTrafico;
     |FINSI;
|FPRC;

|PROCESO Min26;
     #26#0 = #23#0;
     #26#2 = #23#2;
     #26#4 = #23#4;
     #26#5 = #23#5;
     #26#7 = "01.01.0000";
|FPRC;

|PROCESO Max26;
     #26#0 = #23#0;
     #26#2 = #23#2;
     #26#4 = #23#4;
     #26#5 = #23#5;
     #26#7 = "31.12.9999";
|FPRC;

|PROCESO BtnTrafico;
     |VENTANA 901, 2898, -1, 17, "Tr fico diario";
     |HAZ PushVenModal;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 1002, 1012, BtnAltaTrafico;
     nBtnAltaTrafico = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 1014, 1024, BtnModiTrafico;
     nBtnModiTrafico = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{199}}Baja", 1026, 1036, BtnBajaTrafico;
     nBtnBajaTrafico = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{155}}Consulta", 1038, 1048, BtnConsTrafico;
     nBtnConsTrafico = FSalida;

     |HAZ TieneLineas26;
     |ABRET #26;
     |HAZ Min26; |LEE 000#26];
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#26, nRango, 1102, 2698, Min26, Max26, Evento26;
     nGridTra = FSalida;
     enCtrFin = nGridTra;
     |HAZ EsperaFin;
     |CIERRAT #26;
     |HAZ PopVenModal;
|FPRC;

|PROCESO FormaHora;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aHora = aAlfa % 102; nHora = aHora; nHora = nHora $ 24;
          aMinu = aAlfa % 402; nMinu = aMinu; nMinu = nMinu $ 60;
          aAlfa = (("00" + nHora)%-102) + ":" + (("00" + nMinu)%-102);
     |FINSI;
|FPRC;

|PROCESO CheqDias;
     nError = 0;
     nDia1 = 0;
     nDia2 = 0;
     nDia3 = 0;
     nDia4 = 0;
     nDia5 = 0;
     nDia6 = 0;
     nDia7 = 0;
     |QBF aDias;
     aLon = aDias % A0;
     |SI aLon ! 1; |O aDias ! "*";
          |SI aLon = 0; nError = 1; |FINSI;
          |PARA i = 1; |SI  i [ aLon; |HACIENDO i = i + 1;
               nPos = i * 100 + 1;
               aCar = aDias % nPos;
               |SI aCar = "*";
                    nError = 1;
               |SINO;
                    aAlfa = "1234567" - aCar;
                    |SI FSalida [ 0; nError = 1; |FINSI;
                    |SI aCar = "1"; nDia1 = nDia1 + 1; |FINSI;
                    |SI aCar = "2"; nDia2 = nDia2 + 1; |FINSI;
                    |SI aCar = "3"; nDia3 = nDia3 + 1; |FINSI;
                    |SI aCar = "4"; nDia4 = nDia4 + 1; |FINSI;
                    |SI aCar = "5"; nDia5 = nDia5 + 1; |FINSI;
                    |SI aCar = "6"; nDia6 = nDia6 + 1; |FINSI;
                    |SI aCar = "7"; nDia7 = nDia7 + 1; |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;
     |SI nDia1 > 1; |O nDia2 > 1; |O nDia3 > 1; |O nDia4 > 1;
               |O nDia5 > 1; |O nDia6 > 1; |O nDia7 > 1;
          nError = 1;
     |FINSI;
     |SI nError ! 0;
          |MENAV "0000Error en dias...";
     |FINSI;
|FPRC;

|PROCESO Hora25; |TIPO 0;
     aAlfa = #25#8;
     |HAZ FormaHora;
     #25#8 = aAlfa; |PINTA #25#8;
|FPRC;

|PROCESO Pobla0; |TIPO 0;
     |ABRE #3;
     #3#0 = #25#5;
     |LEE 000#3=;
     |SI FSalida = 0;
          #25#6 = #3#1; |PINTA #25#6;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Pobla66; |TIPO 66;
     |ABRE #3;
     #3#0 = #25#5;
     |LEE 000#3];
     |CONSULTA_CLAVE #1#3;
     |SI FSalida = 0;
          #25#5 = #3#0; |PINTA #25#5
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO DefeLin25; |TIPO 7;
     nModoPobla = (FEntrada / 100) ! 0;
     |SI nModoPobla = 1;
          #25#0 = #116#0;
          #25#1 = #116#2;
          #25#2 = #116#4;
          #25#3 = #116#5;
          #25#4 = 99;
          |LEE 000#25];
          |SI FSalida = 0;
               |LEE 000#25a;
          |SINO;
               |LEE 000#25u;
          |FINSI;
          |SI FSalida = 0; |Y #25#0 = #116#0; |Y #25#1 = #116#2;
                    |Y #25#2 = #116#4; |Y #25#3 = #116#5;
               nLin = #25#4 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #25;
          #25#0 = #116#0;
          #25#1 = #116#2;
          #25#2 = #116#4;
          #25#3 = #116#5;
          #25#4 = nLin; |PINTA #25#4;
     |FINSI;
|FPRC;

|PROCESO HastaFec; |TIPO 0;
     |SI #24#6 < #24#5;
          |MENAV "0000Error en fecha...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Dias; |TIPO 0;
     aDias = #24#7;
     |HAZ CheqDias;
     |SI nError ! 0; |ERROR; |FINSI;
|FPRC;

|PROCESO DefeLin24; |TIPO 7;
     nModoPobla = (FEntrada / 100) ! 0;
     |SI nModoPobla = 1;
          #24#0 = #116#0;
          #24#1 = #116#2;
          #24#2 = #116#4;
          #24#3 = #116#5;
          #24#4 = 99;
          |LEE 000#24];
          |SI FSalida = 0;
               |LEE 000#24a;
          |SINO;
               |LEE 000#24u;
          |FINSI;
          |SI FSalida = 0; |Y #24#0 = #116#0; |Y #24#1 = #116#2;
                    |Y #24#2 = #116#4; |Y #24#3 = #116#5;
               nLin = #24#4 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #24;
          #24#0 = #116#0;
          #24#1 = #116#2;
          #24#2 = #116#4;
          #24#3 = #116#5;
          #24#4 = nLin; |PINTA #24#4;
     |FINSI;
|FPRC;

|PROCESO Temporada; |TIPO 0;
     |ABRE #8;
     #8#0 = #116#0;
     |LEE 000#8=;
     |SI FSalida = 0;
          #116#1 = #8#1; |PINTA #116#1;
     |SINO;
          |MENAV "0000No existe c¢digo temporada...";
          |ERROR;
     |FINSI;
     |CIERRA #8;
|FPRC;

|PROCESO LinServi; |TIPO 0;
     |ABRE #12;
     #12#0 = #116#2;
     |LEE 000#12=;
     |SI FSalida = 0;
          #116#3 = #12#1; |PINTA #116#3;
     |SINO;
          |MENAV "0000No existe c¢digo l¡nea servicio...";
          |ERROR;
     |FINSI;
     |CIERRA #12;
|FPRC;

|PROCESO Servi7; |TIPO 7;
     |SI nModoCab = 1; |Y nBloquea = 0;
          #23#0 = #116#0;
          #23#2 = #116#2;
          #23#4 = #116#4;
          #23#5 = 999999;
          |LEE 000#23];
          |SI FSalida = 0;
               |LEE 000#23a;
          |SINO;
               |LEE 000#23u;
          |FINSI;
          |SI FSalida = 0; |Y #23#0 = #116#0; |Y #23#2 = #116#2;
                    |Y #23#4 = #116#4;
               nLin = #23#5 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          #116#5 = nLin; |PINTA #116#5;
     |FINSI;
|FPRC;

|PROCESO Plantilla; |TIPO 0;
     |ABRE #11;
     #11#0 = #116#7;
     |LEE 000#11=;
     |SI FSalida = 0;
          #116#8 = #11#1; |PINTA #116#8;
     |SINO;
          |MENAV "0000No existe c¢digo plantilla..";
          |ERROR;
     |FINSI;
     |CIERRA #11;
|FPRC;

|PROCESO Graba25;
     nLin = nLin + 1;
     #25#0 = #116#0;
     #25#1 = #116#2;
     #25#2 = #116#4;
     #25#3 = #116#5;
     #25#4 = nLin;
     #25#5 = #4#2;
     #25#6 = #4#3;
     |GRABA 020#25n;
|FPRC;

|DEFBUCLE Graba25;
     #4#1;
     ;
     #116#11, 00;
     #116#11, 99;
     ;
     NULL, Graba25;
|FIN;

|PROCESO Borra25a;
     |BORRA 020#25a;
|FPRC;

|DEFBUCLE Borra25a;
     #25#1;
     5;
     #116#0, #116#2, #116#4, #116#5, 00, aConte;
     #116#0, #116#2, #116#4, #116#5, 99, aConte;
     be;
     NULL, Borra25a;
|FIN;

|PROCESO PobSal; |TIPO 0;
     |ABRE #3;
     #3#0 = #116#9;
     |LEE 000#3=;
     |SI FSalida = 0;
          #116#10 = #3#1; |PINTA #116#10;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO PobLlega; |TIPO 0;
     |ABRE #3;
     #3#0 = #116#11;
     |LEE 000#3=;
     |SI FSalida = 0;
          #116#12 = #3#1; |PINTA #116#12;
          |SI aConte ! #116Campo; |Y nModoCab = 1;
               nLin = 0;
               |BUCLE Borra25a;
               |BUCLE Graba25;
               |REFRESCACONTROL nGridPobla;
          |FINSI;
     |SINO;
          |MENAV "0000No existe c¢digo poblaci¢n...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO Hora; |TIPO 0;
     aAlfa = #116Campo;
     |HAZ FormaHora;
     #116Campo = aAlfa; |PINTA #116Campo;
|FPRC;

|PROCESO Sentido; |TIPO 0;
     |SI #116#4 = "I";
          #116#19 = "IDA";
     |SINO;
          #116#19 = "VUELTA";
     |FINSI;
     |PINTA #116#19;
|FPRCC;


|PROCESO Chequea; |TIPO 0;
     |SI nModoCab = 1; |Y nBloquea = 0;
          |DDEFECTO #23;
          #23#0 = #116#0;
          #23#2 = #116#2;
          #23#4 = #116#4;
          #23#5 = #116#5;
          |GRABA 000#23b;
          |SI FSalida ! 0;
               |MENAV "0000Registro existente...";
               |ERROR;
          |SINO;
               |C_M #116#0, 1, "N";
               |C_M #116#2, 1, "N";
               |C_M #116#4, 1, "N";
               |C_M #116#5, 1, "N";
               nBloquea = 1;

               aAlfa  = "|X000"; aAlfa = #116aAlfa; nId = aAlfa;
               |ESTADO_CONTROL nId, "ENABLE";

               |ABRE #8;
               #8#0 = #116#0;
               |LEE 020#8=;
               |CIERRA #8;
               #24#0 = #116#0;
               #24#1 = #116#2;
               #24#2 = #116#4;
               #24#3 = #116#5;
               #24#4 = 1;
               #24#5 = #8#2;
               #24#6 = #8#3;
               #24#7 = "*";
               #24#8 = "S";
               |GRABA 020#24n;

               |REFRESCACONTROL nGridPeri;
               |REFRESCACONTROL nGridPobla;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Valida7; |TIPO 7;
     |SI nModoCab = 1;
          aAlfa  = "|X000"; aAlfa = #116aAlfa; nId = aAlfa;
          |ESTADO_CONTROL nId, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO PintaCampos;
     |HAZ Sentido;
|FPRC;

|PROCESO Borra25;
     |BORRA 020#25a;
|FPRC;

|DEFBUCLE Borra25;
     #25#1;
     ;
     #23#0, #23#2, #23#4, #23#5, 00;
     #23#0, #23#2, #23#4, #23#5, 99;
     be;
     NULL, Borra25;
|FIN;

|PROCESO Borra24;
     |BORRA 020#24a;
|FPRC;

|DEFBUCLE Borra24;
     #24#1;
     ;
     #23#0, #23#2, #23#4, #23#5, 00;
     #23#0, #23#2, #23#4, #23#5, 99;
     be;
     NULL, Borra24;
|FIN;

|PROCESO Min25;
     #25#0 = #116#0;
     #25#1 = #116#2;
     #25#2 = #116#4;
     #25#3 = #116#5;
     #25#4 = 00;
|FPRC;

|PROCESO Max25;
     #25#0 = #116#0;
     #25#1 = #116#2;
     #25#2 = #116#4;
     #25#3 = #116#5;
     #25#4 = 99;
|FPRC;

|PROCESO Min24;
     #24#0 = #116#0;
     #24#1 = #116#2;
     #24#2 = #116#4;
     #24#3 = #116#5;
     #24#4 = 00;
|FPRC;

|PROCESO Max24;
     #24#0 = #116#0;
     #24#1 = #116#2;
     #24#2 = #116#4;
     #24#3 = #116#5;
     #24#4 = 99;
|FPRC;

|PROCESO Conte; |TIPO 7;
     aConte = #116Campo;
|FPRC;

|PROCESO Edita;
     aReg0 = #23#0;
     nReg2 = #23#2;
     aReg4 = #23#4;
     nReg5 = #23#5;

     |SI nModoCab = 1; |VENTANA 0501, 3098, -1, 17, "Nuevo Servicio Temporada"; |FINSI;
     |SI nModoCab = 2; |VENTANA 0501, 3098, -1, 17, "Modifica Servicio Temporada"; |FINSI;
     |SI nModoCab = 4; |VENTANA 0501, 3098, -1, 17, "Consulta Servicio Temporada"; |FINSI;
     |HAZ PushVenModal;

     |SI nModoCab = 1;
          |DDEFECTO #116;
          |C_M #116#0, 1, "S";
          |C_M #116#2, 1, "S";
          |C_M #116#4, 1, "S";
          |C_M #116#5, 1, "S";
     |SINO;
          |PARA i = 0; |SI i [ 18; |HACIENDO i = i + 1;
               #116i = #23i;
          |SIGUE;
          |C_M #116#0, 1, "N";
          |C_M #116#2, 1, "N";
          |C_M #116#4, 1, "N";
          |C_M #116#5, 1, "N";
     |FINSI;

     |PINPA #0#116; nPantaCab = FSalida;
     |PINDA #0#116;
     |HAZ PintaCampos;

     |SI nModoCab = 4;
          nRango = 4 + 8 + 16 + 32;
     |SINO;
          nRango = 1 + 4 + 8 + 16 + 32;
     |FINSI;
     |LINEAL_SIMPLE #1#24, nRango, 1602, 2198, Min24, Max24, NULL;
     nGridPeri = FSalida;
     |LINEAL_SIMPLE #1#25, nRango, 2302, 2998, Min25, Max25, NULL;
     nGridPobla = FSalida;

     nBloquea = 0;
     |SI nModoCab = 1; |ENDATOS #1#116; |FINSI;
     |SI nModoCab = 2; |ENDATOS #2#116; |FINSI;
     |SI nModoCab = 4; |PAUSA; |FINSI;
     |SI FSalida = 0; |Y nModoCab ! 4;
          #23#0 = #116#0;
          #23#2 = #116#2;
          #23#4 = #116#4;
          #23#5 = #116#5;
          |LEE 121#23=;
          |PARA i = 0; |SI i [ 18; |HACIENDO i = i + 1;
               #23i = #116i;
          |SIGUE;
          |GRABA 020#23a;
          |HAZ CreaTrafico;
          aReg0 = #23#0;
          nReg2 = #23#2;
          aReg4 = #23#4;
          nReg5 = #23#5;
     |SINO;
          |SI nBloquea = 1;
               #23#0 = #116#0;
               #23#2 = #116#2;
               #23#4 = #116#4;
               #23#5 = #116#5;
               |BORRA 020#23c;
               |BUCLE Borra24;
               |BUCLE Borra25;
          |FINSI;
     |FINSI;
     |LIBERA #23;

     |HAZ PopVenModal;

     #23#0 = aReg0;
     #23#2 = nReg2;
     #23#4 = aReg4;
     #23#5 = nReg5;
     |LEE 000#23=;
     |REFRESCACONTROL nGridCab;
|FPRC;

|PROCESO BtnAlta;
     nModoCab = 1; |HAZ Edita;
     |HAZ TieneLineas;
|FPRC;

|PROCESO BtnModi;
     |LEE 100#23=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoCab = 2; |HAZ Edita;
|FPRC;

|PROCESO sctrm026B;
     |SI nSwCheq = 1;
          |SI #26#27 ! 0;
               nError = 1; |ERROR10;
          |FINSI;
     |SINO;
          |BORRA 020#26a;
     |FINSI;
|FPRC;

|DEFBUCLE sctrm026B;
     #26#1;
     ;
     #23#0, #23#2, #23#4, #23#5, "01.01.0000";
     #23#0, #23#2, #23#4, #23#5, "31.12.9999";
     be;
     NULL, sctrm026B;
|FIN;

|PROCESO BtnBaja;
     |LEE 100#23=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     aAlfa = "0000N¨Borrar servicio temporada: " + #23#0 + "/" + #23#2 + "/" + #23#4 + "/" + #23#5 + "?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          nError = 0;
          nSwCheq = 1; |BUCLE sctrm026B;
          |SI nError = 0;
               nSwCheq = 0; |BUCLE sctrm026B;
               |BORRA 020#23a;
               |BUCLE Borra24;
               |BUCLE Borra25;
               |HAZ TieneLineas;
               |REFRESCACONTROL nGridCab;
          |SINO;
               |MENAV  "0000El tr fico diario esta iniciado, no se puede dar de baja del servicio..."
          |FINSI;
     |FINSI;
     |LIBERA #23;
|FPRC;

|PROCESO BtnCons;
     |LEE 000#23=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     nModoCab = 4; |HAZ Edita;
|FPRC;

|PROCESO sctrm026;
     |PRINT;
|FPRC

|DEFBUCLE sctrm026;
     #26#1;
     ;
     #23#0, #23#2, #23#4, #23#5, "01.01.0000";
     #23#0, #23#2, #23#4, #23#5, "31.12.9999";
     ;
     NULL, sctrm026;
|FIN;

|PROCESO Imprime;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          aInf = #57#2; |QBF aInf;
          |INFOR aInf;
          |SI FSalida = 0;
               |BUCLE sctrm026;
               |PIEINF;
               |FININF;
          |SINO;
               aInf = "0000Error en in forme:" + aInf;
               |MENAV aInf;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO BtnImpr;
     |LEE 000#23=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |HAZ Imprime;
|FPRC;

|PROCESO Evento23;
     |SI FSalida = 1; |O FSalida = 2;
          |SI enLinServi = 0;
               |SELECT #1#23;
          |SINO;
               |SELECT #2#23;
          |FINSI;
          |LEE 000#23=;
          |HAZ TieneLineas;
     |FINSI;
     |SI FSalida = 4;
          |HAZ BtnCons;
     |FINSI;
|FPRC;

|PROCESO TieneLineas;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm023";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          |SI enLinServi = 0;
               |LEE 000#referen@.p;
          |SINO;
               |SELECT #2#referen@;
               |DDEFECTO #referen@;
               #referen@#2 = enLinServi;
               |LEE 000#referen@.];
               |SI FSalida ! 0; |O #referen@#2 ! enLinServi;
                    FSalida = "1";
               |FINSI;
          |FINSI;
          |SI FSalida = 0;
               |ESTADO_CONTROL nBtnModi, "ENABLE";
               |ESTADO_CONTROL nBtnBaja, "ENABLE";
               |ESTADO_CONTROL nBtnCons, "ENABLE";
               |ESTADO_CONTROL nBtnImpr, "ENABLE";
               |ESTADO_CONTROL nBtnTrafico, "ENABLE";
               |ESTADO_CONTROL nBtnMasiva, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBtnModi, "DISABLE";
               |ESTADO_CONTROL nBtnBaja, "DISABLE";
               |ESTADO_CONTROL nBtnCons, "DISABLE";
               |ESTADO_CONTROL nBtnImpr, "DISABLE";
               |ESTADO_CONTROL nBtnTrafico, "DISABLE";
               |ESTADO_CONTROL nBtnMasiva, "DISABLE";
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROCESO BtnTodos;
     nSwFin = 1;
     enLinServi = 0;
     |PTEC 807;
|FPRC;

|PROCESO Min23;
     #23#2 = enLinServi;
     #23#0 = "          ";
     #23#4 = " ";
     #23#5 = 000000;
|FPRC;

|PROCESO Max23;
     #23#2 = enLinServi;
     #23#0 = "zzzzzzzzzz";
     #23#4 = "z";
     #23#5 = 999999;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;

     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Alta", 1002, 1012, BtnAlta;
     nBtnAlta = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Modificar", 1014, 1024, BtnModi;
     nBtnModi = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}Baja", 1026, 1036, BtnBaja;
     nBtnBaja = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{155}}Consulta", 1038, 1048, BtnCons;
     nBtnCons = FSalida;
     |CONTROL_SIMPLE nPanta, "BOTON,{{205}}Impresi¢n", 1050, 1060, BtnImpr;
     nBtnImpr = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{230}}Todos", 1088, 1098, BtnTodos;
     nBtnTodos = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Tr fico diario", 2902, 2917, BtnTrafico;
     nBtnTrafico = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Creaci¢n Masiva", 2919, 2934, BtnMasiva
     nBtnMasiva = FSalida;

     |ABRET #23;
     |ABRET #24;
     |ABRET #25;
     |SI eaModo = "CONSULTA";
          #23#0 = eaTempo;
          #23#2 = enLinServi;
          #23#4 = eaSentido;
          #23#5 = enServicio;
          #23#7 = efFecha;
          |LEE 020#23=;
          |SI FSalida = 0; |HAZ BtnCons; |FINSI;
     |SINO;
          |PARA nSwFin = 1; |SI nSwFin = 1; |HACIENDO;
               |HAZ TieneLineas;
               nSwFin = 0;
               nRango = 4 + 8 + 16 + 32;
               |SI enLinServi = 0;
                    |ESTADO_CONTROL nBtnTodos, "DISABLE";
                    |LINEAL_SIMPLE #1#23, nRango, 1102, 2799, NULL, NULL, Evento23;
               |SINO;
                    |LINEAL_SIMPLE #2#23, nRango, 1102, 2799, Min23, Max23, Evento23;
               |FINSI;
               nGridCab = FSalida;
               enCtrFin = nGridCab;
               |HAZ EsperaFin;
               |PULSATECLA;
               |DESTRUYECONTROL nGridCab;
          |SIGUE;
     |FINSI;
     |CIERRAT #25;
     |CIERRAT #24;
     |CIERRAT #23;
|FPRO;
