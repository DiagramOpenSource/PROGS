|FICHEROS;
     vigz0028 #0;
     vigm0001 #1;
     vigm0002 #2;
     vigm0003 #3;
     vigm0019 #19;
     vigm0020 #20;
     vigw0018 #18; || Tmp
|FIN;

|VARIABLES;
     &Tempo = "";
|FIN;

|PROCESO Tmp;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #18#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Formula;
     |DDEFECTO #1;
     #1#0 = #3#2;
     |LEE 000#1=;

     |SI #1#9 ] #0#1; |Y #1#9 [ #0#2; |Y #1#1 = "M";
          |DDEFECTO #18;
          #18#0 = #3#2;
          |LEE 101#18=;
          |SI FSalida ! 0; |GRABA 020#18b; |FINSI;
          #18#1 = #3#3;
          #18#2 = #18#2 + (#20#4 * #3#4 / #2#3);
          #18#3 = #1#9;
          |GRABA 020#18a;
          |LIBERA #18;
     |FINSI;
|FPRC;

|DEFBUCLE Formula;
     #2#2;
     ;
     #20#10;
     #20#10;
     ;
     NULL, NULL, Formula;
|FIN;

|PROCESO vigm0020;
     |BUCLE Formula;
|FPRC;

|DEFBUCLE vigm0019;
     #19#2;
     ;
     #0#0, "     ", 000001;
     #0#0, "zzzzz", 999999;
     ;
     NULL, NULL, vigm0020;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigz0028";
          |SI FSalida = 0;
               |HAZ CreaTempo; |NOME_DAT #18#Tempo#; |DELINDEX #18;
               |ABRE #1;
               |ABRE #18;
               |BUCLE vigm0019;
               |CIERRA #18;
               |BUCLE Tmp;
               |CIERRA #1;
               |PIEINF;
               |FININF;
               |DELINDEX #18; |HAZ BoraTempo;
          |SINO;
               |MENAV "0000Error en informe 'vigz0028'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
