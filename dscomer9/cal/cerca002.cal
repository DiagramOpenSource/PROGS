|FICHEROS;
     cerca001 #1;
     agifa017 #17;
     agifa019 #19;
     agifa081 #81;
     dsm00083 #83;
     agifa067 #67;
     agifa142 #142;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enCodigo = 0;
|FIN;

|CAMPOS;
     #19#16  art_prec;
     #19#183 art_prec2;
     #17#43  alm_prec;
     #17#45  alm_prec2;
|FIN;

|PROCESO dsm00083;
     |BORRA 020#83a;
|FPRC;

|DEFBUCLE dsm00083;
     #83#1;
     ;
     "P", #67#28, #67#0, #67#1, 001;
     "P", #67#28, #67#0, #67#1, 999;
     be;
     NULL, dsm00083;
|FIN;

|PROCESO BorraLin;
     |DDEFECTO #19;
     #19#0 = #67#2;
     |LEE 101#19=;
     |SI FSalida ! 0; |GRABA 020#19b; |FINSI;
     art_prec = art_prec - #67#5;
     art_prec2 = art_prec2 - #67#41;
     |GRABA 020#19a;
     |LIBERA #19;

     |DDEFECTO #17;
     #17#0 = #67#2;
     #17#1 = #67#3;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17a; |FINSI;
     alm_prec = alm_prec - #67#5;
     alm_prec2 = alm_prec2 - #67#41;
     |GRABA 020#17a;
     |LIBERA #17;

     |BUCLE dsm00083;

     |BORRA 020#67a;
|FPRC;

|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |ABRE #1; |SELECT #2#1;
     #1#4 = eaSerie;
     #1#5 = enCodigo;
     |LEE 101#1=;
     |SI FSalida = 0;
          |ABRE #81;
          #81#25 = #1#0;
          #81#0 = #1#1;
          |LEE 101#81=;
          |SI FSalida = 0;
               |ABRE #19;
               |ABRE #17;
               |BUCLELIN 0 BorraLin #81;
               |CIERRA #17;
               |CIERRA #19;
               |BORRA 020#81a;
          |FINSI;
          |CIERRA #81;
          |BORRA 020#1a;
     |FINSI;
     |CIERRA #1;
|FPRO;
