|FICHEROS;
     qdclor02 #0;
     qdclor03 #1;
     qdclor11 #11,MANTE;
     dsm00024 #24;
     agifa142 #142;
|FIN;

|VARIABLES;
     nModo = 0;
     aAlfa = "";
     aParti = "";
     nPos = 0;
|FIN;

|PROCESO CopiaLin;
     #1#0 = #11#1;
     #1#7 = #11#3;
     |GRABA 020#1n;
|FPRC;

|PROCESO BorraLin;
     |BORRA 020#1a;
|FPRC;

|DEFBUCLE BorraLin;
     #1#1;
     ;
     #11#1, #11#3, 01;
     #11#1, #11#3, 99;
     be;
     NULL, BorraLin;
|FIN;

|PROCESO Copialo;
     #0#0 = #11#0;
     #0#2 = #11#2;
     |LEE 020#0=;
     |SI FSalida = 0;
          |BUCLE BorraLin;
          |BUCLELIN 2 CopiaLin #0;
          #0#0 = #11#1;
          #0#2 = #11#3;
          |LEE 000#0=;
          |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

          |DDEFECTO #24;
          |ABRE #24;
          #24#0 = #0#0;
          #24#1 = 1;
          #24#2 = #0#2;
          |LEE 000#24=;
          |SI FSalida ! 0;
               |GRABA 020#24n;
          |FINSI;
          |CIERRA #24;
     |FINSI;
|FPRC;

|PROCESO Org66; |TIPO 66;
     |CONSULTA_CLAVE #1#0;
     |SI FSalida = 0;
          #11#0 = #0#0; |PINTA #11#0;
          #11#2 = #0#2; |PINTA #11#2;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Org0; |TIPO 0;
     #0#0 = #11#0;
     #0#2 = #11#2;
     |LEE 000#0=;
     |SI FSalida ! 0;
          |MENAV "0000No existe boletin...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min;
     #24#0 = #11#1;
     #24#1 = 1;
     #24#2 = "                            ";
|FPRC;

|PROCESO Max;
     #24#0 = #11#1;
     #24#1 = 1;
     #24#2 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO PartDes0; |TIPO 0;
/*
     |ABRE #24;
     #24#0 = #11#1;
     #24#1 = 1;
     #24#2 = #11#3;
     |LEE 000#24=;
     |SI FSalida ! 0;
          |MENAV "0000No existe partida...";
          |ERROR;
     |FINSI;
     |CIERRA #24;
*/
|FPRC;

|PROCESO PartDes66; |TIPO 66;
     |ABRE #24;
     #24#0 = #11#1;
     #24#1 = 1;
     #24#2 = #11#3;
     |LEE 000#24];
     |CONSULTA_F_CLAVE #1#24, Min, Max;
     |SI FSalida = 0;
          #11#3 = #24#2; |PINTA #11#3;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO Parti11; |TIPO 6;
     aParti = #11Campo;
     |HAZ RelleParti;
     #11Campo = aParti; |PINTA #11Campo;
|FPRC;

|PROCESO Copia; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI FSalida = 10;
          |SI nModo = 1;
               |PUSHV 0501 2380;
               |BLANCO 1123 2159;
               |DDEFECTO #11;
               |PINPA #0#11;
               |PINDA #0#11;
               |ENDATOS #1#11;
               |SI FSalida = 0;
                    |HAZ Copialo;
                    |PTEC 802;
               |SINO;
                    |ERROR;
               |FINSI;
               |POPV;
          |SINO;
               |MENAV "0000Opcion solo en alta...";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Impre;
     |PRINT;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "qdclor02";
          |SI FSalida = 0;
               |BUCLELIN 2 Impre #0;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Parti; |TIPO 6;
     aParti = #0#2;
     |HAZ RelleParti;
     #0#2 = aParti; |PINTA #0#2;
|FPRC;

|PROCESO RelleParti;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |QBF aParti;
     |SI #142#122 = "S";
          aAlfa = #142#121 * #142#120;
          aParti = aAlfa + aParti;
     |FINSI;
     nPos = -1 * (100 + #142#120);
     aParti = aParti % nPos;
|FPRC;
