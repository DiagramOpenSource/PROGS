|FICHEROS;
     web20002 #0;
     web20004 #1,MANTE;
     dsm00003 #2;
     web20005 #5,MANTE;
|FIN;

|VARIABLES;
     aAlfa1   = "";
     &aIdent  = "";
     &aTipo   = "";
     &aCodCli = "";
     nSalteLineal = 0;
     nLimSub = 9999;
|FIN;

|PROCESO Modifica; |TIPO 0;
     |SI #web20002#5 = "C";
          |C_M #web20002#3, 1, "S";
          |C_M #web20002#4, 1, "N";
     |FINSI;
     |SI #web20002#5 = "R";
          |C_M #web20002#3, 1, "N";
          |C_M #web20002#4, 1, "S";
     |FINSI;
|FPRC;


|PROCESO Tipo20; |TIPO 20;
     aAlfa1 = FSalida;
     |SI aAlfa1 = "OPCION";
          FSalida = "Obras";
          |ACABA;
     |FINSI;

     |LEE 000#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |HAZ Obras;
|FPRC;

|PROCESO inf;
     #1#0 = #0#0;
     #1#4 = "000000";
     #1#1 = 0001;
|FPRC;

|PROCESO sup;
     #1#0 = #0#0;
     #1#4 = "999999";
     #1#1 = nLimSub;
|FPRC;

|PROCESO Obras;
     |PUSHV 0501 2380;
     aIdent  = #0#0;
     aTipo   = #0#5;
     aCodCli = #0#3;
     |PARA; |SI; |HACIENDO;
          |ABRET #1;
          |ENTLINEAL #1#1,2,2,22,1,inf,sup;
          |CIERRAT #1;
          |SI nSalteLineal = 1;
               nSalteLineal = 0;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;

     |POPV;
|FPRC;

|PROCESO linf;
  #2#0 = #0#3;
  #2#1 = 1;
|FPRC;

|PROCESO lsup;
  #2#0 = #0#3;
  #2#1 = 9999;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 10;
          |ABRE #2;
          |CONSULTA_F_CLAVE #1#2,linf,lsup;
          |SI FSalida = 0;
               #1#0=#0#0;
               #1#1=#2#1;     ||num obra
               |LEE 101#1=;
               |SI FSalida ! 0;    |GRABA 020#1b; |FINSI;
               #1#2=#2#10;    ||nombre obra
               #1#3=#2#3;     ||provincia
               |GRABA 020#1a;
               |LIBERA #1;
               |PTEC 817;
               |PTEC 814;
          |FINSI;
          |CIERRA #2;
          |ERROR;
     |FINSI;
     |SI FSalida = 13;
          |PUSHV 0501 2380;
          |PINPA #0#5;
          |PINDA #0#5;
          |ENDATOS #1#5;
          |POPV;
          |SI #5#11 = "S";
               nLimSub = #5#4;
          |FINSI;
          nSalteLineal = 1;

          |PTEC 807;
     |FINSI;
|FPRC;
