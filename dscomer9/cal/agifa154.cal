|FICHEROS;
     agifa154 #0;
     agifa019 #1;
     agifa153 #2;
     agifa024 #3;
     agifa112 #4;
     agifa025 #5;
     agifa060 #6;
     agifa120 #7;
     dsm00010 #910;
|FIN;

|VARIABLES;
     &eaPinTexto = "";
     &eAlfa = "";
     cod = "";
     &enAlta = 0;
     &eaArticulo = "";
|FIN;

|PROCESO PideArti; |TIPO 7;
     |SI #2#2 ! "A"; |ACABA; |FINSI;

     |ABRE #910; |LEE 040#910p; |CIERRA #910;
     |SI #910#2 < 3;  |ACABA;  |FINSI;

     |SI Campo = 2;
          eaPinTexto = "    Codigo  Antiguo    ";
     |SINO;
          eaPinTexto = "    Codigo  Nuevo      ";
     |FINSI;
     eAlfa     = #0Campo;
     |SUB_EJECUTA_NP "dsz99990";                 || Por Pantalla

     |SI eAlfa = "-1";  |PTEC 807;  |ACABA;  |FINSI;
     |SI eAlfa = "-2";              |ACABA;  |FINSI;

     eaArticulo = eAlfa;      ||  700000-4215

     #0Campo = eAlfa;
     |PINTA #0Campo;
     |PTEC 802;
|FPRC;

|PROCESO ant;
|SI #2#2 = "A";
     |ABRE #1;
     #1#0 = #0#2;
     |LEE 001#1=;
     |SI FSalida ! 0;
          |MENAV "0000El Articulo NO Existe";
          |CIERRA #1;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #1#1; |PINTA #0#4;
     #0#5 = #1#1; |PINTA #0#5;
     |CIERRA #1;
|FINSI;
|SI #2#2 = "C";
     |ABRE #3;
     cod = #0#2 % 106;
     #3#0 = cod;
     |LEE 001#3=;
     |SI FSalida ! 0;
          |MENAV "0000El Cliente NO Existe";
          |CIERRA #3;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #3#1; |PINTA #0#4;
     #0#5 = #3#1; |PINTA #0#5;
     #0#2 = cod;  |PINTA #0#2;
     |CIERRA #3;
|FINSI;
|SI #2#2 = "P";
     |ABRE #4;
     cod = #0#2 % 106;
     #4#0 = cod;
     |LEE 001#4=;
     |SI FSalida ! 0;
          |MENAV "0000El Proveedor NO Existe";
          |CIERRA #4;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #4#1; |PINTA #0#4;
     #0#5 = #4#1; |PINTA #0#5;
     #0#2 = cod;  |PINTA #0#2;
     |CIERRA #4;
|FINSI;
|SI #2#2 = "R";
     |ABRE #5;
     cod = #0#2 % 102;
     #5#0 = cod;
     |LEE 001#5=;
     |SI FSalida ! 0;
          |MENAV "0000El Representante NO Existe";
          |CIERRA #5;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #5#1; |PINTA #0#4;
     #0#5 = #5#1; |PINTA #0#5;
     #0#2 = cod;  |PINTA #0#2;
     |CIERRA #5;
|FINSI;
|SI #2#2 = "F";
     |ABRE #6;
     cod = #0#2 % 103;
     #6#0 = cod;
     |LEE 001#6=;
     |SI FSalida ! 0;
          |MENAV "0000La Familia NO Existe";
          |CIERRA #6;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #6#1; |PINTA #0#4;
     #0#5 = #6#1; |PINTA #0#5;
     #0#2 = cod;  |PINTA #0#2;
     |CIERRA #6;
|FINSI;
|SI #2#2 = "S";
     |ABRE #7;
     cod = #0#2 % 105;
     #7#0 = cod;
     |LEE 001#7=;
     |SI FSalida ! 0;
          |MENAV "0000La Subfamilia NO Existe";
          |CIERRA #7;
          |ERROR;
          |ACABA;
     |FINSI;
     #0#4 = #7#1; |PINTA #0#4;
     #0#5 = #7#1; |PINTA #0#5;
     #0#2 = cod;  |PINTA #0#2;
     |CIERRA #7;
|FINSI;

|FPRC;

|PROCESO nuevo;
|SI #2#2 = "A";
     |ABRE #1;
     #1#0 = #0#3;
     |LEE 001#1=;
     |SI FSalida = 0;
          |CONFI "0000NEl Articulo ya Existe ¿ Continuar ?";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #1;
             |ACABA;
          |SINO;
             #0#5 = #1#1;
          |FINSI;
     |FINSI;
     |CIERRA #1;
|FINSI;
|SI #2#2 = "C";
     |ABRE #3;
     cod = #0#3 % 106;
     #3#0 = cod;
     |LEE 001#3=;
     |SI FSalida = 0;
          |CONFI "0000NEl Cliente ya Existe. Continuar ?";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #3;
             |ACABA;
          |SINO;
             #0#5 = #3#2;
          |FINSI;
     |FINSI;
     #0#3 = cod; |PINTA #0#3;
     |CIERRA #3;
|FINSI;
|SI #2#2 = "P";
     |ABRE #4;
     cod = #0#3 % 106;
     #4#0 = cod;
     |LEE 001#4=;
     |SI FSalida = 0;
          |CONFI "0000NEl Proveedor ya Existe ¿ Continuar ?";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #4;
             |ACABA;
          |SINO;
             #0#5 = #4#2;
          |FINSI;
     |FINSI;
     #0#3 = cod; |PINTA #0#3;
     |CIERRA #4;
|FINSI;
|SI #2#2 = "R";
     |ABRE #5;
     cod = #0#3 % 102;
     #5#0 = cod;
     |LEE 001#5=;
     |SI FSalida = 0;
          |CONFI "0000NEl Representante ya Existe ¿ Continuar ?";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #5;
             |ACABA;
          |SINO;
             #0#5 = #5#1;
          |FINSI;
     |FINSI;
     #0#3 = cod; |PINTA #0#3;
     |CIERRA #5;
|FINSI;
|SI #2#2 = "F";
     |ABRE #6;
     cod = #0#3 % 103;
     #6#0 = cod;
     |LEE 001#6=;
     |SI FSalida = 0;
          |CONFI "0000NLa Familia YA Existe ¿ Continuar ?";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #6;
             |ACABA;
          |SINO;
             #0#5 = #6#1;
          |FINSI;
     |FINSI;
     #0#3 = cod; |PINTA #0#3;
     |CIERRA #6;
|FINSI;
|SI #2#2 = "S";
     |ABRE #7;
     cod = #0#3 % 105;
     #7#0 = cod;
     |LEE 001#7=;
     |SI FSalida = 0;
          |CONFI "0000NLa Subfamilia YA Existe ¿ Continuar ? ";
          |SI FSalida ! 0;
             |ERROR;
             |CIERRA #7;
             |ACABA;
          |SINO;
             #0#5 = #7#1;
          |FINSI;
     |FINSI;
     #0#3 = cod; |PINTA #0#3;
     |CIERRA #7;
|FINSI;

|FPRC;

|PROCESO tipo3; |TIPO 3;
     #0#6 = #2#2;
|FPRC;

|PROCESO Llena154; |TIPO 6;
     |SI #2#2 = "A";
          enAlta = 1;
          eaArticulo = #0Campo;
          |HAZ LlenaArticulo;
          |SI FSalida = 0;
               #0Campo = eaArticulo;
               |PINTA #0Campo;
          |SINO;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |SI #2#2 = "A";
          |ABRE #1;
          #1#0 = #0Campo;
          |LEE 000#1];
          |CONSULTA_CLAVE #1#1;
          |SI FSalida = 0;
               #0Campo = #1#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #1;
     |FINSI;
     |SI #2#2 = "C";
          |ABRE #3;
          #3#0 = #0Campo;
          |LEE 000#3];
          |CONSULTA_CLAVE #1#3;
          |SI FSalida = 0;
               #0Campo = #3#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #3;
     |FINSI;
     |SI #2#2 = "P";
          |ABRE #4;
          #4#0 = #0Campo;
          |LEE 000#4];
          |CONSULTA_CLAVE #1#4;
          |SI FSalida = 0;
               #0Campo = #4#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #4;
     |FINSI;
     |SI #2#2 = "R";
          |ABRE #5;
          #5#0 = #0Campo;
          |LEE 000#5];
          |CONSULTA_CLAVE #1#5;
          |SI FSalida = 0;
               #0Campo = #5#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #5;
     |FINSI;
     |SI #2#2 = "F";
          |ABRE #6;
          #6#0 = #0Campo;
          |LEE 000#6];
          |CONSULTA_CLAVE #1#6;
          |SI FSalida = 0;
               #0Campo = #6#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #6;
     |FINSI;
     |SI #2#2 = "S";
          |ABRE #7;
          #7#0 = #0Campo;
          |LEE 000#7];
          |CONSULTA_CLAVE #1#7;
          |SI FSalida = 0;
               #0Campo = #7#0;
               |PINTA #0Campo;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #7;
     |FINSI;
|FPRC;
