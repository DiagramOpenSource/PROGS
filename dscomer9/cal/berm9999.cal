||PLB. Modulo 004379. Berria Bikes

|VARIABLES;
     {1}aContiene = "";
     &eaUnidadBasico = "";
     &enError = 0;
     &eaUnidad = "";
     aAlfa = "";
     aBase = "";
     aOrigen = "";
     aDestino = "";
     aDirBaseLocal = "";
     aDocRemoto = "";
     aDocServidor = "";
     aIPRemoto = "";
     nHandle = 0;
|FIN;

|PROCESO DimeUnidad;
     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     eaUnidadBasico = (aContiene1 % 102) > "";

     aAlfa = eaUnidadBasico % -101;
     |SI aAlfa ! ":";
         eaUnidadBasico = "";
     |FINSI;

     eaUnidad = eaUnidadBasico % 101;
|FPRC;


|PROCESO Traete_dsselect;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     aOrigen = aBase + "plugins/dsselect.exe";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     |HAZ DimeUnidad;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS";               |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSCOMER9";      |RMKDIR aDirBaseLocal;
     aDirBaseLocal = eaUnidad + ":\DOCUMENTOS\DSCOMER9\";
     aDestino      = aDirBaseLocal + "\dsselect.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;
