|FICHEROS;
     palmhz05 #0;
     agifa077 #77;
     agifa080 #80;
     agifa079 #79;
     agifa021 #21;
     agifa112 #112;
     agifa142 #142;
     dsm00279 #279;
|FIN;

|VARIABLES;
     &enContaFac = 0;
     &enSwMenu = 0;
     &qSerie = "";
     &qSerieF = "";
     &qAlbar = 0;
     &qFecha = @;
     &qAbono = "";

     aCam38 = "";
     aCam51 = "";
     aCam39 = "";
|FINSI;

|PROCESO AlbaCom;
     qSerieF = "Z" + (#77#50 % 104);
     #79#66 = qSerieF;
     #79#0 = #77#0;
     |LEE 000#79=;
     |SI FSalida ! 0;
          qSerie = #77#50;
          qAlbar = #77#0;
          qFecha = #77#1;
          qAbono = #77#42;
          qSerieF = "Z" + (#77#50 % 104);
          enContaFac = #77#0;

          aCam38 = #77#38;
          aCam51 = #77#51;
          aCam39 = #77#39;

          |LEE 121#77=;
          #77#38 = "N";  || pongo como N para que se facture
          |GRABA 020#77a;
          |LIBERA #77;

          |SUB_EJECUTA_NP "agifa229";       ||Facturar Albaranes

          |LEE 121#77=;  || restaura lo que tenia
          #77#38 = aCam38;
          #77#51 = aCam51;
          #77#39 = aCam39;
          |GRABA 020#77a;

          |LIBERA #77;
     |FINSI;
|FPRC;

|DEFBUCLE AlbaCom;
     #77#1;
     ;
     #0#0, #0#1;
     #0#2, #0#3;
     ;
     NULL, AlbaCom;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |ABRE #279; |LEE 000#279p; |CIERRA #279;

     |ABRE #79;
     |BUCLE AlbaCom;
     |CIERRA #79;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "menu";
          |MANTE #0;
     |SINO;
          |HAZ Tipo3;
     |FINSI;
|FPRO;
