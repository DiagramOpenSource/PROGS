|FICHEROS;
     psion002 #99;  || Este def.
     psion001 #0;   || Fichero de control de parametros para el pase.
     agifa091 #1;   || Formas de Pago.
     agifa024 #2;   || Clientes.
     agifa019 #3;   || Articulos.
     agifa027 #5;   || Contadores.
||     agifa114 #6;   || Recibos de cobros.
     agifa017 #7;   || Datos Articulo Almacen.
     agifa023 #8;   || Precios Cliente/Articulo.
     agifa039 #9;   || Descuento Cliente/Familia.
     psion017 #10;  || Visitas.
     psion018 #11;  || Datos Empresa Por Serie.
     agifa010 #12;  || Cabeceras Albaranes.
     agifa142 #13;  || Parametros Generales.
     agifa321 #14;  || Divisas-Parametros.
     agifa324 #15;  || Divisas-Divisas.
     dsm00024 #24;  || Partidas
     psion030 #30;  || Ayuda Ventas
     psion032 #32;  || Rutas
     psion033 #33;  || Rutas Clientes
     psion034 #34;  || Situaciones
     psion035 #35,MANTE;  || Rutas a exportar
     agifa112 #112;

     dscam045@ #200;
     dscam003@ #201;
     dsm00003 #300;
     agifa025 #25;
     dsl00001 #100;
     psion060 #60;       || Config. Articulo
     agim0001 #101;
     agis0002 #102;
     dsm00134 #134;
     carm0001@;
     carm0002@;
     referen@;
|FIN;

|VARIABLES;
     &eaValXor = "";
     aGuarda = "";
     aSistema = "";
     aModoFic = "";
     aDeSolWeb = "";
     aDeSolNom = "";
     aDeSolShell = "";
     aDeSolUsu = "";
     aDeSolPwd = "";
     nSwDeSol = 0;
     nPsion = 0;
     fHoy = @;
     nPvp1 = 0;
     nPvp2 = 0;
     nPvp3 = 0;
     nPvp4 = 0;
     nPvp5 = 0;
     nPvp6 = 0;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     aPath = "";
     aTipo = "";
     nSwCarnicas = 0;
     nTotal = 0;
     nActa = 0;
     nAbo = 0;
     nSwJamaica = 0;
     aSerie = "";
     fHFecha = @;
     fDFecha = @;
     nNume = 0;
     aSer = "";
     nNum = 0;
     nJamaEntre = 0;
     {10}&eaVariable = "";
     aCar = "";
     aExe = "";
     nPos = 0;
     aLon = "";
     &aFicDes = "";
     aFicOrg = "";
     aVer1 = "";
     aVer2 = "";
     aIP = "";
     aBase = "";
     {1}aLocal = "";
     {1}aConte = "";
     aOrigen = "";
     aDestino = "";

     aCadena = "";
     aLen = "";
     nLen = 0;
     nCampo = 0;
     nPosi = 0;
     aCaracter = "";
     nAlma = 0;
     nHandle = 0;
     aFinReg = "";
     aEjecuta = "";
     empresa  = "";
     cadena   = "";
     fichero  = "";
     long     = "";
     caracter = "";
     campo    = "";
     &variable = "";
     alfa     = "";
     tab1     = 0;
     final1   = 0;
     final2   = 0;
     tab      = "";
     final    = "";
     i        = 0;
     f        = 0;
     ind      = 0;
     valor    = 0;
     sw       = 0;
     pasa     = 0;
     jj       = 0;
     sal      = 0;
     guarda   = 0;
     se1      = "";
     se2      = "";
     se3      = "";
     se4      = "";
     se5      = "";
     se6      = "";
     se7      = "";
     se8      = "";
     se9      = "";
     se10     = "";
     se11     = "";
     se12     = "";
     con1     = 0;
     con2     = 0;
     con3     = 0;
     con4     = 0;
     con5     = 0;
     con6     = 0;
     con7     = 0;
     con8     = 0;
     con9     = 0;
     con10    = 0;
     con11    = 0;
     con12    = 0;
     nume1    = 0;

     aAlfa = "";
     nEmpresa = 0;
|FIN;

|PROCESO carm0001;
     campo = #carm0001@#1; variable = variable + tab + campo;
     campo = #carm0001@#2; variable = variable + tab + campo;
     campo = #carm0001@#3; variable = variable + tab + campo;
     campo = #carm0001@#4; variable = variable + tab + campo;
|FPRC;

|DEFBUCLE carm0001;
     #carm0001@#1002;
     ;
     aTipo, "01.01.0000";
     aTipo, "31.12.9999";
     ;
     NULL, carm0001;
|FIN;

|PROCESO carm0002;
     campo = #carm0002@#0; |QBF campo; variable = campo + tab;
     campo = #carm0002@#1; |QBF campo; variable = variable + campo;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "IMPUESTOS:";
     |PINTA 1935,variable;
     aTipo = #carm0002@#1;
     |BUCLE carm0001;
     variable = variable + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE carm0002;
     #carm0002@#1001;
     ;
     "                    ";
     "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, carm0002;
|FIN;

|PROCESO CarImpuesto;
     |DDEF aPath;
     aAlfa = aPath + "carm0001";
     |CARGA_DEF aAlfa, carm0001@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'carm0001'";
          |ACABA;
     |FINSI;

     aAlfa = aPath + "carm0002";
     |CARGA_DEF aAlfa, carm0002@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'carm0002'";
     |SINO;
          empresa = #0#29;
          |QBF empresa;
          aFicOrg = empresa + "impuesto.txt";
          aFicDes = empresa + "impuesto.asc";
          empresa = empresa + "impuesto.txt";

          |XABRE aModoFic, empresa, nHandle;
          |SI FSalida ] 0;
               |HAZ IniDiferencia;
               |BUCLE carm0002;
               |XCIERRA nHandle;
               |HAZ FinDiferencia;
          |SINO;
               aAlfa = "0000Error al crear:" + empresa;
               |MENAV aAlfa;
          |FINSI;
          |DESCARGA_DEF #carm0002@;
     |FINSI;
     |DESCARGA_DEF #carm0001@;
|FPRC;

|PROCESO QuitaRaros;
/*
     |QBF variable;
     aCadena = "";
     aLen    = variable % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPosi = (100 * nCampo) + 1;
           aCaracter = variable % nPosi;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     variable = aCadena;
*/
|FPRC;

|PROCESO dsm00134;
     campo = #134#0; |QBF campo; variable = campo + tab;
     campo = #134#1; |QBF campo; variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "PROMOCION.:";
     |PINTA 1935,variable;
     campo = #134#2; |QBF campo; variable = variable + campo + tab;
     campo = #134#3; |QBF campo; variable = variable + campo + tab;
     campo = #134#4; |QBF campo; variable = variable + campo + tab;
     campo = #134#5; |QBF campo; variable = variable + campo + tab;
     campo = #134#6; |QBF campo; variable = variable + campo + tab;
     campo = #134#7; |QBF campo;
     variable = variable + campo + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE dsm00134;
     #134#1
     ;
     #0#2, #0#7;
     #0#3, #0#8;
     ;
     NULL, dsm00134;
|FIN;

|PROCESO PromoCliArt;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "prcliart.txt";
     aFicDes = empresa + "prcliart.asc";
     empresa = empresa + "prcliart.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |SI #agifa142#250 = "S";
               |BUCLE dsm00134;
          |FINSI;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO agim0001;
     campo = #101#0; |QBF campo; variable = campo + tab;
     campo = #101#1; |QBF campo; variable = variable + campo;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "ENVASES.:";
     |PINTA 1935,variable;
     variable = variable + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE agim0001;
     #101#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agim0001;
|FIN;

|PROCESO Envases;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "envase.txt";
     aFicDes = empresa + "envase.asc";
     empresa = empresa + "envase.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE agim0001;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO agifa112;
     campo = #112#0; |QBF campo; variable = campo + tab;
     campo = #112#1; |QBF campo; variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "PROVEEDOR.:";
     |PINTA 1935,variable;
     campo = #112#9; |QBF campo; variable = variable + campo + tab;
     campo = #112#3; |QBF campo; variable = variable + campo + tab;
     campo = #112#4; |QBF campo; variable = variable + campo + tab;
     campo = #112#76; |QBF campo; variable = variable + campo + tab;
     campo = #112#5; |QBF campo; variable = variable + campo;
     variable = variable + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE agifa112;
     #112#1;
     ;
     #0#64;
     #0#65;
     ;
     NULL, agifa112;
|FIN;

|PROCESO Proveedores;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "proveedo.txt";
     aFicDes = empresa + "proveedo.asc";
     empresa = empresa + "proveedo.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE agifa112;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO dsl00001;
     |SI #100#1 < #0#7; |O #100#1 > #0#8;
          |ACABA;
     |FINSI;
     #3#0 = #100#1;
     |LEE 000#3=;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #3#2 < #0#9; |O #3#2 > #0#10;
          |ACABA;
     |FINSI;
     |SI #3#125 < #0#36; |O #3#125 > #0#37;
          |ACABA;
     |FINSI;

     campo = #100#3; |QBF campo; variable = campo + tab;
     campo = #100#1; |QBF campo; variable = variable + campo + tab;

     |PINTA 1922,"                                                         ";
     |PINTA 1922, "COD.BARRAS:";
     |PINTA 1935,variable;
     campo = #100#6; |QBF campo; variable = variable + tab + campo + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE dsl00001;
     #100#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsl00001;
|FIN;

|PROCESO CodBarra;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "codbar.txt";
     aFicDes = empresa + "codbar.asc";
     empresa = empresa + "codbar.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |ABRE #3;
          |BUCLE dsl00001;
          |CIERRA #3;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO agifa025;
     |SI #0#59 = 3;
          |SI #25#0 = "00"; |ACABA; |FINSI;
          |SI #25#0 = "  "; |ACABA; |FINSI;
     |FINSI;
     campo = #25#0; |QBF campo;
     variable = campo + tab;
     campo = #25#1; |QBF campo;
     variable = variable + campo;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "REPRESENT.:";
     |PINTA 1935,variable;
     variable = variable + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE agifa025;
     #25#1;
     ;
     #0#39;
     #0#40;
     ;
     NULL, agifa025;
|FIN;

|PROCESO Representantes;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "represen.txt";
     aFicDes = empresa + "represen.asc";
     empresa = empresa + "represen.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE agifa025;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO dsm00024;
     #3#0 = #24#0;
     |LEE 000#3=;
     |SI FSalida ! 0; |O #3#180 = "N"; |ACABA; |FINSI;

     |SI #3#125 < #0#36; |O #3#125 > #0#37; |ACABA; |FINSI; ||Linea
     |SI #3#2 < #0#9; |O #3#2 > #0#10; |ACABA; |FINSI;      ||Familia

     |SI #0#60 = "S"; |Y #24#22 [ 0; || Sin Stock
          |ACABA;
     |FINSI;

     campo = #24#0; |QBF campo;
     variable = campo + tab;
     campo = #24#2; |QBF campo;
     variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "PARTIDA   :";
     |PINTA 1935,variable;
     campo = #24#22; |QBF campo;
     variable = variable + campo + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE dsm00024;
     #24#1;
     ;
     #0#7, nAlma, "                              ";
     #0#8, nAlma, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dsm00024;
|FIN;

|PROCESO Partidas;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "partidas.txt";
     aFicDes = empresa + "partidas.asc";
     empresa = empresa + "partidas.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          nAlma = #0#27;
          |ABRE #3;
          |BUCLE dsm00024;
          |CIERRA #3;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO dsm00024_1;
     #3#0 = #24#0;
     |LEE 000#3=;
     |SI FSalida ! 0; |O #3#180 = "N"; |ACABA; |FINSI;

     |SI #3#125 < #0#36; |O #3#125 > #0#37; |ACABA; |FINSI; ||Linea
     |SI #3#2 < #0#9; |O #3#2 > #0#10; |ACABA; |FINSI;      ||Familia

     |SI #0#60 = "S"; |Y #24#22 [ 0; || Sin Stock
          |ACABA;
     |FINSI;

     campo = nAlma; |QBF campo;
     variable = campo + tab;

     campo = #24#0; |QBF campo;
     variable = variable + campo + tab;

     campo = #24#2; |QBF campo;
     variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "PARTIDA1  :";
     |PINTA 1935,variable;
     campo = #24#22; |QBF campo;
     variable = variable + campo + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE dsm00024_1;
     #24#1;
     ;
     #0#7, nAlma, "                              ";
     #0#8, nAlma, "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, dsm00024_1;
|FIN;

|PROCESO PartiGen;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "partidas1.txt";
     aFicDes = empresa + "partidas1.asc";
     empresa = empresa + "partidas1.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          nAlma = #0#70;
          |ABRE #3;
          |BUCLE dsm00024_1;
          |CIERRA #3;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO psion030;
     #3#0 = #30#2;
     |LEE 000#3=;
     |SI FSalida ! 0; |O #0#6 = "N"; |ACABA; |FINSI;
     |SI #3#125 < #0#36; |O #3#125 > #0#37; |ACABA; |FINSI; ||Linea
     |SI #3#2 < #0#9; |O #3#2 > #0#10; |ACABA; |FINSI;      ||Familia

     #2#0 = #30#0;
     |LEE 000#2=
     |SI FSalida ! 0; |O #0#1 = "N"; |ACABA; |FINSI;
     |SI #2#3 < #0#4;|O #2#3 > #0#5; |ACABA; |FINSI;          || Zona
     |SI #2#25 < #0#39;|O #2#25 > #0#40; |ACABA; |FINSI;      || Repre
     |SI #2#158 < #0#31;|O #2#158 > #0#32; |ACABA; |FINSI;    || Grupo
     |SI #2#4 < #0#33;|O #2#4 > #0#34; |ACABA; |FINSI;        || Tipo
     |SI #2#39 < #0#51;|O #2#39 > #0#52; |ACABA; |FINSI;      || Tarifa

     campo = #30#0; |QBF campo;
     variable = campo + tab;
     campo = #30#1; |QBF campo;
     variable = variable + campo + tab;
     campo = #30#2; |QBF campo;
     variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "AYUDA VTA.:";
     |PINTA 1935,variable;
     variable = variable + #30#3 + tab + #30#4 + tab + #30#5 + tab;
     variable = variable + #30#6 + tab + #30#7 + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE psion030;
     #30#1;
     3;
     #0#2, 0001, #0#7, fDFecha;
     #0#3, 9999, #0#8, fHFecha;
     ;
     NULL, psion030;
|FIN;

|PROCESO AyudaVta;
     fHFecha = ~;
     nNume = fHFecha;
     nNume = nNume - #0#69;
     fDFecha = nNume;

     |SI #0#69 = 9999;
          fDFecha = "01.01.0000";
          fHFecha = "31.12.9999";
     |FINSI;

     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "ayudaven.txt";
     aFicDes = empresa + "ayudaven.asc";
     empresa = empresa + "ayudaven.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |ABRE #2;
          |ABRE #3;
          |BUCLE psion030;
          |CIERRA #2;
          |CIERRA #3;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO psion032;
     campo = #32#0; |QBF campo;
     variable = campo + tab;
     campo = #32#1; |QBF campo;
     variable = variable + campo;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "RUTAS.....:";
     |PINTA 1935,variable;
     variable = variable + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE psion032;
     #32#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, psion032;
|FIN;

|PROCESO Ruta;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "rutas.txt";
     aFicDes = empresa + "rutas.asc";
     empresa = empresa + "rutas.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE psion032;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO psion034;
     campo = #34#0; |QBF campo;
     variable = campo + tab;
     campo = #34#1; |QBF campo;
     variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "SITUACION.:";
     |PINTA 1935,variable;
     variable = variable + #34#2 +  aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE psion034;
     #34#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, psion034;
|FIN;

|PROCESO Situaciones;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "situacio.txt";
     aFicDes = empresa + "situacio.asc";
     empresa = empresa + "situacio.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE psion034;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO psion033;
     #2#0 = #33#1;
     |LEE 000#2=
     |SI FSalida ! 0; |O #0#1 = "N"; |ACABA; |FINSI;
     |SI #2#3 < #0#4;|O #2#3 > #0#5; |ACABA; |FINSI;          || Zona
     |SI #2#25 < #0#39;|O #2#25 > #0#40; |ACABA; |FINSI;      || Repre
     |SI #2#158 < #0#31;|O #2#158 > #0#32; |ACABA; |FINSI;    || Grupo
     |SI #2#4 < #0#33;|O #2#4 > #0#34; |ACABA; |FINSI;        || Tipo
     |SI #2#39 < #0#51;|O #2#39 > #0#52; |ACABA; |FINSI;      || Tarifa

     campo = #33#0; |QBF campo;
     variable = campo + tab;
     campo = #33#1; |QBF campo;
     variable = variable + campo + tab;
     campo = #33#2; |QBF campo;
     variable = variable + campo + tab;
     |PINTA 1922,"                                                         ";
     |PINTA 1922, "RUTAS CLI.:";
     |PINTA 1935,variable;
     variable = variable + #33#3 + aFinReg;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = "";
|FPRC;

|DEFBUCLE psion033;
     #33#1;
     ;
     #35#1, #0#2, 0001;
     #35#1, #0#3, 9999;
     ;
     NULL, psion033;
|FIN;

|PROCESO psion035;
     |SI #35#3 = "*";
          |BUCLE psion033;
     |FINSI;
|FPRC;

|DEFBUCLE psion035;
     #35#1;
     ;
     #0#0, "      ";
     #0#0, "zzzzzz";
     ;
     NULL, psion035;
|FIN;

|PROCESO RutasCli;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "rutascli.txt";
     aFicDes = empresa + "rutascli.asc";
     empresa = empresa + "rutascli.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |ABRE #2;
          |BUCLE psion035;
          |CIERRA #2;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;
||------------------------------  CLIENTES ----------------------------------

|PROCESO DirEnt;
     variable = #300#0 + tab + #300#1 + tab + #300#10 + tab + #300#11 + tab;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     |PINTA 1922,"                                                         ";
     |PINTA 1922,"DIR.ENT.:";
     |PINTA 1935,variable;
     variable = #300#2 + tab + #300#3 + tab + #300#6 + tab;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     variable = #300#7 + tab + #300#13 + &13 + &10;
     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0;
                    variable = eaVariable1; |HAZ Encripta; eaVariable1 = variable;
                    variable = eaVariable2; |HAZ Encripta; eaVariable2 = variable;
                    variable = eaVariable3; |HAZ Encripta; eaVariable3 = variable;
               |FINSI;
               |XGRABA nHandle, eaVariable1;
               |XGRABA nHandle, eaVariable2;
               |XGRABA nHandle, eaVariable3;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
|FPRC;

|DEFBUCLE DirEnt;
     #300#1;
     11;
     #2#0, 001, #0#4;
     #2#0, 999, #0#5;
     ;
     NULL, DirEnt;
|FIN;

|PROCESO Direccion;
     |BUCLE DirEnt;
|FPRC;

|DEFBUCLE Direccion;
     #2#1;
     3,158,4,25,39;
     #0#2,#0#4,#0#31,#0#33,#0#39,#0#51;
     #0#3,#0#5,#0#32,#0#34,#0#40,#0#52;
     ;
     NULL, Direccion;
|FIN;

|PROCESO pasa_cli;
          campo = #2#0; |QBF campo; variable = campo + tab;
          campo = #2#1; |SI #0#59 = 1; campo = campo % 130; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          |PINTA 1922,"                                                         ";
          |PINTA 1922,"CLIENTES:";
          |PINTA 1935,variable;
          campo = #2#2; |SI #0#59 = 1; campo = campo % 130; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          campo = #2#5; |SI #0#59 = 1; campo = campo % 130; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          campo = #2#6; |SI #0#59 = 1; campo = campo % 130; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          campo = #2#180;|QBF campo; variable = variable + campo + tab;
          campo = #2#7; |SI #0#59 = 1; campo = campo % 130; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          campo = #2#15; |SI #0#59 = 1; campo = campo % 115; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          campo = #2#17; |SI #0#59 = 1; campo = campo % 115; |FINSI; |QBF campo;
          variable = variable + campo + tab;
          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          variable = "";

          campo = #2#47; |QBF campo; variable = variable + campo + tab;
          campo = #2#20; |QBF campo; variable = variable + campo + tab;
          campo = #2#39; |QBF campo; variable = variable + campo + tab;
          campo = #2#3;  |QBF campo; variable = variable + campo + tab;
          campo = #2#158; |QBF campo; variable = variable + campo + tab;
          campo = #2#37; |QBF campo; variable = variable + campo + tab;
          campo = #2#38; |QBF campo; variable = variable + campo + tab;
          campo = #2#156; |QBF campo;
          |SI #0#58 ] 10;      ||Version Programa PSION;
              variable = variable + campo + tab;
              campo = #2#41; |QBF campo;
          |FINSI;
          variable = variable + campo;

          |SI #0#59 = 2;
               variable = variable + tab + #2#204;
          |FINSI;
          |SI #0#59 = 3;
               variable = variable + tab + #2#204;
               variable = variable + tab + #2#189;
          |FINSI;

          variable = variable + aFinReg;

          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0;
                         variable = eaVariable1; |HAZ Encripta; eaVariable1 = variable;
                         variable = eaVariable2; |HAZ Encripta; eaVariable2 = variable;
                    |FINSI;
                    |XGRABA nHandle, eaVariable1;
                    |XGRABA nHandle, eaVariable2;
               |FINSI;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          campo = "";
          variable = "";
          cadena = "";
|FPRC;

|DEFBUCLE lee_cli;
     #2#1;
     3,158,4,25,39;
     #0#2,#0#4,#0#31,#0#33,#0#39,#0#51;
     #0#3,#0#5,#0#32,#0#34,#0#40,#0#52;
     ;
     NULL,pasa_cli;
|FIN;

|PROCESO clientes;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "clientes.txt";
     aFicDes = empresa + "clientes.asc";
     empresa = empresa + "clientes.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_cli;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
     |HAZ Ansi2Utf8;

     |SI #0#59 = 2; |Y #0#71 = "S";
          empresa = #0#29;
          |QBF empresa;
          aFicOrg = empresa + "direccion.txt";
          aFicDes = empresa + "direccion.asc";
          empresa = empresa + "direccion.txt";

          |XABRE aModoFic, empresa, nHandle;
          |SI FSalida ] 0;
               |HAZ IniDiferencia;
               |BUCLE Direccion;
               |XCIERRA nHandle;
               |HAZ FinDiferencia;
          |SINO;
               aAlfa = "0000Error al crear:" + empresa;
               |MENAV aAlfa;
          |FINSI;
          |HAZ Ansi2Utf8;
     |FINSI;
|FPRC;

||--------------------------  ARTICULOS  ------------------------------------

|PROCESO pasa_art;
     |ABRE #7;
     #7#0 = #3#0;
     #7#1 = #0#27;
     |LEE 111#7=;
     |SI FSalida ! 0;
         |DDEFECTO #7;
         #7#0 = #3#0;
         #7#1 = #0#27;
         |GRABA 000#7c;
         |LIBERA #7;
     |FINSI;
     |LIBERA #7;
     |CIERRA #7;

     |PINTA 1922,"                                                         ";
     |PINTA 1922,"ARTICULOS:";
     |PINTA 1935, #3#0;

     efFiva = ~;
     enTiva = #3#30;
     |HAZ SacaIVA;
     nPvp1 = #3#18;
     nPvp2 = #3#19;
     nPvp3 = #3#20;
     nPvp4 = #3#147;
     nPvp5 = #3#148;
     nPvp6 = #3#149;
     |SI #3#130 = "S"; nPvp1 = nPvp1 / (1+(enIva/100)); |FINSI;
     |SI #3#131 = "S"; nPvp2 = nPvp2 / (1+(enIva/100)); |FINSI;
     |SI #3#132 = "S"; nPvp3 = nPvp3 / (1+(enIva/100)); |FINSI;
     |SI #3#153 = "S"; nPvp4 = nPvp4 / (1+(enIva/100)); |FINSI;
     |SI #3#154 = "S"; nPvp5 = nPvp5 / (1+(enIva/100)); |FINSI;
     |SI #3#155 = "S"; nPvp6 = nPvp6 / (1+(enIva/100)); |FINSI;
     nPvp1 = nPvp1 ! #15#9;
     nPvp2 = nPvp2 ! #15#9;
     nPvp3 = nPvp3 ! #15#9;
     nPvp4 = nPvp4 ! #15#9;
     nPvp5 = nPvp5 ! #15#9;
     nPvp6 = nPvp6 ! #15#9;

     #60#0 = #99#0;
     |LEE 000#60=;
     |SI FSalida = 0; |Y #0#59 ! 3;
          |SI #60#1 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#0; |QBF campo; variable = campo;
                    || el QBF estaba puesto en la 9.40, fue quitado
                    ||/en la 9.41, respuesto en la 00psion_9.41.005
          |FINSI;
          |SI #60#2 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#1; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#3 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#2; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#4 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#128; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#5 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#30; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#6 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp1; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#7 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp2; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#8 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp3; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#9 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp4; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#10 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp5; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#11 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = nPvp6; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#12 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#21; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#13 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#22; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#14 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#23; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#15 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#150; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#16 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#151; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#17 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#152; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#18 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #7#5; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#19 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#4; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#20 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#180; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#21 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#5; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#22 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#139; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#23 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#140; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#24 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#141; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#25 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#142; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#26 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#143; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#27 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#144; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#28 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#145; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#29 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#146; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#30 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#208; |QBF campo; variable = variable + campo;
          |FINSI;
          |SI #60#31 = "S";
               |SI variable ! ""; variable = variable + tab; |FINSI;
               campo = #3#133; |QBF campo; variable = variable + campo;
          |FINSI;
     |SINO;
          campo = #3#0; |QBF campo; variable = campo + tab;
          campo = #3#1; |QBF campo; variable = variable + campo + tab;
          campo = #3#2; |QBF campo; variable = variable + campo + tab;
          campo = #3#128; |QBF campo; variable = variable + campo + tab;
          campo = #3#30; |QBF campo; variable = variable + campo + tab;
          campo = nPvp1; |QBF campo; variable = variable + campo + tab;
          campo = nPvp2; |QBF campo; variable = variable + campo + tab;
          campo = nPvp3; |QBF campo; variable = variable + campo + tab;
          campo = nPvp4; |QBF campo; variable = variable + campo + tab;
          campo = nPvp5; |QBF campo; variable = variable + campo + tab;
          campo = nPvp6; |QBF campo; variable = variable + campo + tab;
          campo = #3#21; |QBF campo; variable = variable + campo + tab;
          campo = #3#22; |QBF campo; variable = variable + campo + tab;
          campo = #3#23; |QBF campo; variable = variable + campo + tab;
          campo = #3#150; |QBF campo; variable = variable + campo + tab;
          campo = #3#151; |QBF campo; variable = variable + campo + tab;
          campo = #3#152; |QBF campo; variable = variable + campo + tab;
          |SI #0#59 = 1; || PSION
               campo = #7#5; |QBF campo;
               |SI #0#58 ] 10;
                    variable = variable + campo + tab;
                    campo = #3#4; |QBF campo;
               |FINSI;
               variable = variable + campo;
               |SI #0#58 = 30;
                    variable = variable + tab + #3#180;
               |FINSI;
               variable = variable + tab + #3#133;
          |FINSI;
          |SI #0#59 = 2; |O #0#59 = 3;  || PDA/Tablet
               campo = #7#5; |QBF campo;
               variable = variable + campo;
               variable = variable + tab + #3#180;
               |SI #0#59 = 2;
                    variable = variable + tab + #3#5;
               |FINSI;
               variable = variable + tab + #3#139;
               variable = variable + tab + #3#140;
               variable = variable + tab + #3#141;
               variable = variable + tab + #3#142;
               variable = variable + tab + #3#143;
               variable = variable + tab + #3#144;
               variable = variable + tab + #3#145;
               variable = variable + tab + #3#146;
               |SI #0#59 = 2;
                    variable = variable + tab + #3#208;
                    variable = variable + tab + #3#133;
               |FINSI;
               |SI #0#59 = 3;
                    variable = variable + tab + #3#3;
               |FINSI;
          |FINSI;
          || OJO AL A¥ADIR, ANADIR EN EL  psion060
     |FINSI;

     variable = variable + aFinReg;

     |HAZ QuitaRaros;
     |SI #0#67 = "D";
          |HAZ Diferencia;
          |SI FSalida ! 0;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
     |SINO;
          |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
          |XGRABA nHandle, variable;
     |FINSI;
     campo = "";
     variable = "";
     cadena = "";
|FPRC;

|DEFBUCLE lee_art;
     #3#1;
     2,125;
     #0#7,#0#9,#0#36;
     #0#8,#0#10,#0#37;
     ;
     NULL,pasa_art;
|FIN;

|PROCESO articulos;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "articulo.txt";
     aFicDes = empresa + "articulo.asc";
     empresa = empresa + "articulo.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |ABRE #60;
          |BUCLE lee_art;
          |CIERRA #60;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||---------------------------- FORMAS DE PAGO -------------------------------

|PROCESO pasa_pago;
          campo = #1#0; |QBF campo;
          variable = campo + tab;
          campo = #1#1; |QBF campo;
          variable = variable + campo + tab;
          |PINTA 1922,"                                                         ";
          |PINTA 1922,"F.PAGO:";
          |PINTA 1935,variable;
          campo = #1#3; |QBF campo;
          variable = variable + campo + tab;
          campo = #1#2; |QBF campo;
          variable = variable + campo + tab;
          campo = #1#4; |QBF campo;
          variable = variable + campo + aFinReg;
          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          campo = "";
          variable = "";
          cadena = "";
|FPRC;

|DEFBUCLE lee_pago;
     #1#1;
     ;
     "  ";
     "zz";
     ;
     NULL,pasa_pago;
|FIN;

|PROCESO f_pago;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "fpago.txt";
     aFicDes = empresa + "fpago.asc";
     empresa = empresa + "fpago.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_pago;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||------------------------- FICHERO DE I.V.A. ------------------------------

|PROCESO lee_iva;
     |PARA enTiva = 0;  |SI enTiva [ 5; |HACIENDO enTiva = enTiva + 1;
          efFiva = ~;
          |HAZ SacaIVA;
          |SI eaDiva ! "";
               campo = enTiva; |QBF campo;
               variable = campo + tab;
               campo = enIva; |QBF campo;
               variable = variable + campo + tab;
               campo = enRec; |QBF campo;
               variable = variable + campo;
               |PINTA 1922,"                                                         ";
               |PINTA 1922,"TIPOS IVA:";
               |PINTA 1935,variable;
               variable = variable + aFinReg;
               |HAZ QuitaRaros;
               |SI #0#67 = "D";
                    |HAZ Diferencia;
                    |SI FSalida ! 0;
                         |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                         |XGRABA nHandle, variable;
                    |FINSI;
               |SINO;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
               campo = "";
               variable = "";
               cadena = "";
          |FINSI;
     |SIGUE;
|FPRC;


|PROCESO f_iva;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "iva.txt";
     aFicDes = empresa + "iva.asc";
     empresa = empresa + "iva.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |HAZ lee_iva;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||----------------------- FICHERO DE CONTADOR ----------------------------

|PROCESO pasa_contador;
          alfa = #5#0;
          |QBF alfa;

          |SI alfa = "valbaran";
               |SI #5#2=#0#12; |O #5#2=#0#13; |O #5#2=#0#14; |O #5#2=#0#15;
                   |SI se1 = ""; se1 = #5#2; con1 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se2 = ""; se2 = #5#2; con2 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se3 = ""; se3 = #5#2; con3 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se4 = ""; se4 = #5#2; con4 = #5#1 - 1; |ACABA; |FINSI;
               |FINSI;
          |FINSI;

          |SI alfa = "vfactuco";
               |SI #5#2=#0#16; |O #5#2=#0#17; |O #5#2=#0#18; |O #5#2=#0#19;
                   |SI se5 = ""; se5 = #5#2; con5 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se6 = ""; se6 = #5#2; con6 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se7 = ""; se7 = #5#2; con7 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se8 = ""; se8 = #5#2; con8 = #5#1 - 1; |ACABA; |FINSI;
               |FINSI;
          |FINSI;

          |SI alfa = "vpedido";
               |SI #5#2=#0#23; |O #5#2=#0#24; |O #5#2=#0#25; |O #5#2=#0#26;
                   |SI se9  = ""; se9  = #5#2; con9  = #5#1 - 1; |ACABA; |FINSI;
                   |SI se10 = ""; se10 = #5#2; con10 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se11 = ""; se11 = #5#2; con11 = #5#1 - 1; |ACABA; |FINSI;
                   |SI se12 = ""; se12 = #5#2; con12 = #5#1 - 1; |ACABA; |FINSI;
               |FINSI;
          |FINSI;
|FPRC;

|DEFBUCLE lee_contador;
     #5#1;
     ;
     "     ","                               ";
     "zzzzz","zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
     ;
     NULL,pasa_contador;
|FIN;

|PROCESO f_contador;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "contador.txt";
     aFicDes = empresa + "contador.asc";
     empresa = empresa + "contador.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          se1  = "";se2  = "";se3  = "";se4  = "";se5  = "";se6  = "";
          se7  = "";se8  = "";se9  = "";se10 = "";se11 = "";se12 = "";
          con1 = 0;con2  = 0;con3 = 0;con4  = 0;con5  = 0;con6  = 0;
          con7 = 0;con8  = 0;con9 = 0;con10 = 0;con11 = 0;con12 = 0;
          |BUCLE lee_contador;
          campo = se1; |QBF campo;
          variable = campo + tab;
          campo = se2; |QBF campo;
          variable = variable + campo + tab;
          campo = se3; |QBF campo;
          variable = variable + campo + tab;
          campo = se4; |QBF campo;
          variable = variable + campo + tab;
          |PINTA 1922,"                                                         ";
          |PINTA 1922,"CONTADORES:";
          |PINTA 1935,variable;
          campo = se5; |QBF campo;
          variable = variable + campo + tab;
          campo = se6; |QBF campo;
          variable = variable + campo + tab;
          campo = se7; |QBF campo;
          variable = variable + campo + tab;
          campo = se8; |QBF campo;
          variable = variable + campo + tab;
          campo = se9; |QBF campo;
          variable = variable + campo + tab;
          campo = se10; |QBF campo;
          variable = variable + campo + tab;
          campo = se11; |QBF campo;
          variable = variable + campo + tab;
          campo = se12; |QBF campo;
          variable = variable + campo + tab;
          campo = con1; |QBF campo;
          variable = variable + campo + tab;
          campo = con2; |QBF campo;
          variable = variable + campo + tab;
          campo = con3; |QBF campo;
          variable = variable + campo + tab;
          campo = con4; |QBF campo;
          variable = variable + campo + tab;
          campo = con5; |QBF campo;
          variable = variable + campo + tab;
          campo = con6; |QBF campo;
          variable = variable + campo + tab;
          campo = con7; |QBF campo;
          variable = variable + campo + tab;
          campo = con8; |QBF campo;
          variable = variable + campo + tab;
          campo = con9; |QBF campo;
          variable = variable + campo + tab;
          campo = con10; |QBF campo;
          variable = variable + campo + tab;
          campo = con11; |QBF campo;
          variable = variable + campo + tab;
          campo = con12; |QBF campo;
          variable = variable + campo + aFinReg;
          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
     cadena = "";
     campo = "";
     variable = "";
|FPRC;

||------------------------- FICHERO DE COBROS DE FACTURAS ----------------------
|PROCESO pasa_recibos;
     |SI #dscam003@#14 ! "P"; |Y #dscam003@#14 ! "C"; |Y #dscam003@#14 ! "I"; |ACABA; |FINSI;
     aAlfa = "|C090TIPO"; aAlfa = #dscam003@#aAlfa#;
     |SI aAlfa ! "F";
        |SI #dscam003@#90 = "S"; |ACABA; |FINSI;
     |FINSI;
     |SI #dscam003@#46 ! #48#0;  |ACABA; |FINSI;

     |SI #dscam003@#30 = #dscam003@#23; || Total recibo = Total liquidado
          |ACABA;
     |FINSI;

     #2#0 = #dscam003@#32;
     |LEE 000#2=;

     |SI #2#0 ] #0#2;|Y #2#0 [ #0#3;            || Cliente
       |SI #2#3 ] #0#4;|Y #2#3 [ #0#5;          || Zona
         |SI #dscam003@#33 ] #0#39; |Y #dscam003@#33 [ #0#40;    || Repre
           |SI #2#158 ] #0#31;|Y #2#158 [ #0#32;|| Grupo
             |SI #2#4 ] #0#33;|Y #2#4 [ #0#34;  || Tipo
               |SI #2#39 ] #0#51;|Y #2#39 [ #0#52;|| Tarifa
                   campo = #dscam003@#0; |QBF campo;
                   variable = campo + tab;
                   campo = #dscam003@#1; |QBF campo;
                   variable = variable + campo + tab;
                   |PINTA 1922,"                                                         ";
                   |PINTA 1922,"REC.COBROS:";
                   |PINTA 1935,variable;
                   campo = #dscam003@#2;  |QBF campo;
                   variable = variable + campo + tab;
                   campo = #dscam003@#6;  |QBF campo;
                   variable = variable + campo + tab;
                   campo = #dscam003@#30; |QBF campo;
                   variable = variable + campo + tab;
                   campo = #dscam003@#23; |QBF campo;
                   variable = variable + campo + tab;
                   campo = "N";   |QBF campo;
                   variable = variable + campo + tab;
                   campo = #2#2;  |QBF campo;
                   |SI campo = "";
                       campo = #2#1;  |QBF campo;
                   |FINSI;
                   campo = campo + tab + (("000000000" + #dscam003@#40) % -109);
                   variable = variable + campo;
                   |SI #0#59 = 1;  || PSION
                         |SI #0#58 = 80;
                            variable = variable + tab + #dscam003@#12;
                            variable = variable + tab + #dscam003@#99;
                         |FINSI;
                         |SI #0#58 = 40;
                             variable = variable + tab + #dscam003@#12;
                             variable = variable + tab + #dscam003@#99;
                         |FINSI;
                   |FINSI;
                   |SI #0#59 = 2;  || PDA
                        variable = variable + tab + #dscam003@#32;
                        variable = variable + tab + #dscam003@#4;
                   |FINSI;

                   variable = variable + aFinReg;
                   |HAZ QuitaRaros;
                   |SI #0#67 = "D";
                         |HAZ Diferencia;
                         |SI FSalida ! 0;
                              |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                              |XGRABA nHandle, variable;
                         |FINSI;
                   |SINO;
                         |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                         |XGRABA nHandle, variable;
                   |FINSI;
                   campo = "";
                   variable = "";
                   cadena = "";
               |FINSI;
             |FINSI;
           |FINSI;
         |FINSI;
       |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE lee_recibos;
     #dscam003@#12006;
     69;
     #dscam045@#4, 000000, 000, "00.00.0000", "            ", #0#2, " ";
     #dscam045@#5, 999999, 999, "31.12.9999", "zzzzzzzzzzzz", #0#3, " ";
     ;
     NULL,pasa_recibos;
|FIN;

|PROCESO LineasCtrl;
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dscarter/fich/" + (("00000" + #dscam045@#6) % -105) + "/";
   |PATH_DAT #201 aAlfa;
   |ABRE #2;
   |BUCLE lee_recibos;
   |CIERRA #2;
|FPRC;

|DEFBUCLE LineasCtrl;
     #dscam045@#1002;
     2;
     nEmpresa, 001, "V";
     nEmpresa, 999, "V";
     ;
     NULL,LineasCtrl;
|FIN;

|PROCESO f_cobros;                || Cobros De Facturas.
     empresa = #0#29;
     |QBF empresa;
     |SI #0#59 = 2; |O #0#59 = 3;
          aFicOrg = empresa + "icobros.txt";
          aFicDes = empresa + "icobros.asc";
          empresa = empresa + "icobros.txt";
     |SINO;
          aFicOrg = empresa + "cobros.txt";
          aFicDes = empresa + "cobros.asc";
          empresa = empresa + "cobros.txt";
     |FINSI;

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |DBASS aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscarter/def/dscam045.mas";
          |CARGA_DEF aAlfa, dscam045@;
          |SI FSalida = 0;
             |DBASS aAlfa; |QBF aAlfa;
             aAlfa = aAlfa + "dscarter/fich/";
             |PATH_DAT #200 aAlfa;
             |DBASS aAlfa; |QBF aAlfa;
             aAlfa = aAlfa + "dscarter/def/dscam003.mas";
             |CARGA_DEF aAlfa, dscam003@;
              |SI FSalida = 0;
                nEmpresa = #48#0;
                |BUCLE LineasCtrl;
                |DESCARGA_DEF #dscam003@;
             |FINSI;
             |DESCARGA_DEF #dscam045@;
          |FINSI;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||------------------------- FICHERO DE COBROS DE ALBARANES ----------------------
|PROCESO Entregas;
     nActa = nActa + #102#9;
|FPRC;

|DEFBUCLE Entregas;
     #102#1;
     22;
     "A", #12#52, #12#0, 01, 3;
     "A", #12#52, #12#0, 99, 4;
     ;
     NULL, Entregas;
|FIN;

|PROCESO pasa_recalb;

  |SI #12#67 ] 0;
     nAbo = 1;
  |SINO;
     nAbo = -1;
  |FINSI;
  nTotal = #12#67 * nAbo;
  nActa = #12#61 * nAbo;

  |SI nSwJamaica = 0;
     |BUCLE Entregas;
  |FINSI;

  |SI nActa < nTotal;
      |ABRE #2;
      #2#0 = #12#3;
      |LEE 000#2=;
      |LIBERA #2;
      |SI #2#0 ] #0#2;|Y #2#0 [ #0#3;
        |SI #2#3 ] #0#4;|Y #2#3 [ #0#5;
          |SI #2#25 ] #0#39;|Y #2#25 [ #0#40;
            |SI #2#158 ] #0#31;|Y #2#158 [ #0#32;
              |SI #2#4 ] #0#33;|Y #2#4 [ #0#34;
               |SI #2#39 ] #0#51;|Y #2#39 [ #0#52;
                      campo = #12#52; |QBF campo;
                      variable = campo + tab;
                      campo = #12#0; |QBF campo;
                      variable = variable + campo + tab;
                      |PINTA 1922,"                                                         ";
                      |PINTA 1922,"REC.ALBARAN:";
                      |PINTA 1935,variable;
                      campo = "1";  |QBF campo;
                      variable = variable + campo + tab;
                      campo = #2#1;  |QBF campo;
                      variable = variable + campo + tab;
                      nume1 = #12#67 - #12#61;
                      nume1 = nume1 ! #15#7;
                      campo = nume1; |QBF campo;
                      variable = variable + campo + tab;
                      campo = "0"; |QBF campo;
                      variable = variable + campo + tab;
                      campo = "N";   |QBF campo;
                      variable = variable + campo + tab;
                      campo = #2#2;  |QBF campo;
                      |SI campo = "";
                          campo = #2#1;  |QBF campo;
                      |FINSI;
                      variable = variable + campo;
                      |ABRE #1;
                      #1#0 = #12#8;
                      |LEE 000#1=;
                      |CIERRA #1;

                      |SI #0#59 = 2;
                           variable = variable + tab + #12#3;
                      |FINSI;
                      |SI #0#59 = 1;
                            |SI #0#58 = 80;
                                variable = variable + tab + #1#69;
                                variable = variable + tab + #12#1;
                            |FINSI;
                            |SI #0#58 = 40;
                                variable = variable + tab + #1#69;
                                variable = variable + tab + #12#1;
                            |FINSI;
                      |FINSI;
                      variable = variable + aFinReg;
                      |HAZ QuitaRaros;
                      |SI #0#67 = "D";
                           |HAZ Diferencia;
                           |SI FSalida ! 0;
                                |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                                |XGRABA nHandle, variable;
                                |SI nSwJamaica = 0; |HAZ JamaCheqActa; |FINSI;
                           |FINSI;
                      |SINO;
                           |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                           |XGRABA nHandle, variable;
                           |SI nSwJamaica = 0; |HAZ JamaCheqActa; |FINSI;
                      |FINSI;
                      campo = "";
                      variable = "";
                      cadena = "";
                |FINSI;
              |FINSI;
            |FINSI;
          |FINSI;
        |FINSI;
      |FINSI;
      |LIBERA #2;
      |CIERRA #2;
 |FINSI;
|FPRC;

|DEFBUCLE lee_recalb_T;
     #12#1;
     3;
     "     ",     0,#0#2;
     "zzzzz",999999,#0#3;
     ;
     NULL,NULL,NULL,NULL,NULL,pasa_recalb;
     #12#2;
|FIN;

|DEFBUCLE lee_recalb;
     #12#1;
     3,38;
     "     ",     0,#0#2,"N";
     "zzzzz",999999,#0#3,"N";
     ;
     NULL,NULL,NULL,NULL,NULL,pasa_recalb;
     #12#2;
|FIN;

|PROCESO f_cobalb;                || Cobros De Albaranes.
     empresa = #0#29;
     |QBF empresa;
     |SI #0#59 = 2;
          aFicOrg = empresa + "icobros1.txt";
          aFicDes = empresa + "icobros1.asc";
          empresa = empresa + "icobros1.txt";
     |SINO;
          aFicOrg = empresa + "cobros1.txt";
          aFicDes = empresa + "cobros1.asc";
          empresa = empresa + "cobros1.txt";
     |FINSI;

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |SI #0#53 = "S";    |BUCLE lee_recalb;   |FINSI;
          |SI #0#53 = "T";    |BUCLE lee_recalb_T; |FINSI;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;

|FPRC;

||------------------------- FICHERO DE PRECIOS -----------------------------

|PROCESO pasa_precios;
     |ABRE #2;
     #2#0 = #8#0;
     |LEE 000#2=;
     |LIBERA #2;
     |ABRE #3;
     #3#0 = #8#1;
     |LEE 000#3=;
     |LIBERA #3;
     |SI #3#2 ] #0#9;|Y #3#2 [ #0#10;
       |SI #3#125 ] #0#36;|Y #3#125 [ #0#37;
         |SI #2#3 ] #0#4;|Y #2#3 [ #0#5;
           |SI #2#25 ] #0#39;|Y #2#25 [ #0#40;
             |SI #2#158 ] #0#31;|Y #2#158 [ #0#32;
               |SI #2#4 ] #0#33;|Y #2#4 [ #0#34;
                 |SI #2#39 ] #0#51;|Y #2#39 [ #0#52;
                     campo = #8#0; |QBF campo;
                     variable = campo + tab;
                     campo = #8#1; |QBF campo;
                     variable = variable + campo + tab;
                     #8#2 = #8#2 ! #15#9;
                     campo = #8#2;  |QBF campo;
                     variable = variable + campo + tab;
                     |PINTA 1922,"                                                         ";
                     |PINTA 1922,"PRE.CLI/ART:";
                     |PINTA 1935,variable;
                     campo = #8#32;  |QBF campo;
                     variable = variable + campo + aFinReg;
                     |HAZ QuitaRaros;
                     |SI #0#67 = "D";
                           |HAZ Diferencia;
                           |SI FSalida ! 0;
                                |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                                |XGRABA nHandle, variable;
                           |FINSI;
                     |SINO;
                           |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                           |XGRABA nHandle, variable;
                     |FINSI;
                     campo = "";
                     variable = "";
                     cadena = "";
                 |FINSI;
               |FINSI;
             |FINSI;
           |FINSI;
         |FINSI;
       |FINSI;
     |FINSI;
     |LIBERA #3;
     |CIERRA #3;
     |LIBERA #2;
     |CIERRA #2;
|FPRC;

|DEFBUCLE lee_precios;
     #8#1;
     29;
     #0#2 , #0#7, fHoy;
     #0#3 , #0#8, "31.12.9999";
     ;
     NULL,pasa_precios;
|FIN;

|PROCESO f_precios;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "precios.txt";
     aFicDes = empresa + "precios.asc";
     empresa = empresa + "precios.txt";

     fHoy = ~;
     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_precios;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||------------------------- FICHERO DE DTOS.FAMILIA -------------------------

|PROCESO pasa_dtofam;
     |ABRE #2;
     #2#0 = #9#0;
     |LEE 000#2=;
     |LIBERA #2;
     |SI #2#3 ] #0#4;|Y #2#3 [ #0#5;
       |SI #2#25 ] #0#39;|Y #2#25 [ #0#40;
         |SI #2#158 ] #0#31;|Y #2#158 [ #0#32;
           |SI #2#4 ] #0#33;|Y #2#4 [ #0#34;
             |SI #2#39 ] #0#51;|Y #2#39 [ #0#52;
                 campo = #9#0; |QBF campo;
                 variable = campo + tab;
                 campo = #9#1; |QBF campo;
                 variable = variable + campo + tab;
                 campo = #9#2; |QBF campo;
                 |PINTA 1922,"                                                         ";
                 |PINTA 1922,"DTO.FAMILIA:";
                 |PINTA 1935,variable;
                 variable = variable + campo + aFinReg;
                 |HAZ QuitaRaros;
                 |SI #0#67 = "D";
                      |HAZ Diferencia;
                      |SI FSalida ! 0;
                           |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                           |XGRABA nHandle, variable;
                      |FINSI;
                 |SINO;
                      |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                      |XGRABA nHandle, variable;
                 |FINSI;
                 campo = "";
                 variable = "";
                 cadena = "";
             |FINSI;
           |FINSI;
         |FINSI;
       |FINSI;
     |FINSI;
     |LIBERA #2;
     |CIERRA #2;
|FPRC;

|DEFBUCLE lee_dtofam;
     #9#1;
     ;
     #0#2 , #0#9;
     #0#3 , #0#10;
     ;
     NULL,pasa_dtofam;
|FIN;

|PROCESO f_dtofam;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "dtofam.txt";
     aFicDes = empresa + "dtofam.asc";
     empresa = empresa + "dtofam.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_dtofam;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||------------------------- FICHERO DE VISITAS ----------------------------
|PROCESO pasa_visitas;
   |ABRE #2;
   #2#0 = #10#0;
   |LEE 000#2=;
   |LIBERA #2;
   |SI #2#25 ] #0#39;|Y #2#25 [ #0#40;
     |SI #2#158 ] #0#31;|Y #2#158 [ #0#32;
       |SI #2#4 ] #0#33;|Y #2#4 [ #0#34;
         |SI #2#39 ] #0#51;|Y #2#39 [ #0#52;
             campo = #10#2; |QBF campo;
             variable = campo + tab;
             campo = #10#0; |QBF campo;
             variable = variable + campo + tab;
             campo = #2#1;  |QBF campo;
             variable = variable + campo + tab;
             |PINTA 1922,"                                                         ";
             |PINTA 1922,"VISITAS : ";
             |PINTA 1933,variable;
             campo = #10#1;  |QBF campo;
             variable = variable + campo + tab;
             campo = #2#2;  |QBF campo;
             |SI campo = "";
                 campo = #2#1;  |QBF campo;
             |FINSI;
             variable = variable + campo + aFinReg;
             |HAZ QuitaRaros;
             |SI #0#67 = "D";
                  |HAZ Diferencia;
                  |SI FSalida ! 0;
                       |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                       |XGRABA nHandle, variable;
                  |FINSI;
             |SINO;
                  |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                  |XGRABA nHandle, variable;
             |FINSI;
             campo = "";
             variable = "";
             cadena = "";
         |FINSI;
       |FINSI;
     |FINSI;
   |FINSI;
   |LIBERA #2;
   |CIERRA #2;
|FPRC;

|DEFBUCLE lee_visitas;
     #10#1;
     ;
     #0#2,#0#4;
     #0#3,#0#5;
     ;
     NULL,NULL,NULL,NULL,NULL,pasa_visitas;
     #10#2;
|FIN;

|PROCESO f_visitas;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "visitas.txt";
     aFicDes = empresa + "visitas.asc";
     empresa = empresa + "visitas.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_visitas;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||------------------------- FICHERO DE IMPRESION ----------------------------
|PROCESO pasa_impresion;
   |SI #0#47 = #11#0;|O #0#48 = #11#0;|O #0#49 = #11#0;|O #0#50 = #11#0;
           campo = #11#0; |QBF campo;
           variable = campo + tab;
           campo = #11#1; |QBF campo;
           variable = variable + campo + tab;
           |PINTA 1922,"                                                         ";
           |PINTA 1922,"IMPRESION : ";
           |PINTA 1933,variable;
           campo = #11#2;  |QBF campo;
           variable = variable + campo + tab;
           campo = #11#3;  |QBF campo;
           variable = variable + campo + tab;
           campo = #11#4;  |QBF campo;
           variable = variable + campo + tab;
           campo = #11#5;  |QBF campo;
           variable = variable + campo + tab;
           campo = #11#6;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#41;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#42;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#43;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#44;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#45;  |QBF campo;
           variable = variable + campo + tab;
           campo = #0#46;  |QBF campo;
           |SI #0#58 ] 10;      ||Version Programa PSION;
               variable = variable + campo + tab;
               campo = #0#54;  |QBF campo;
               variable = variable + campo + tab;
               campo = #0#55;  |QBF campo;
               variable = variable + campo + tab;
               campo = #0#56;  |QBF campo;
               variable = variable + campo + tab;
               campo = #0#57;  |QBF campo;
               variable = variable + campo + tab;
               campo = #13#72;  |QBF campo;
           |FINSI;
           variable = variable + campo + aFinReg;
           |HAZ QuitaRaros;
           |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
           |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
           |FINSI;
           campo = "";
           variable = "";
           cadena = "";
   |FINSI;
|FPRC;

|DEFBUCLE lee_impresion;
     #11#1;
     ;
     "     ";
     "zzzzz";
     ;
     NULL,NULL,NULL,NULL,NULL,pasa_impresion;
     #10#2;
|FIN;

|PROCESO f_impresion;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "impre.txt";
     aFicDes = empresa + "impre.asc";
     empresa = empresa + "impre.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_impresion;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||--------------------------  ARTICULOS CODIGO -----------------------------

|PROCESO pasa_art1;
          campo = #3#0; |QBF campo;
          variable = campo + tab;
          campo = #3#1; |QBF campo;
          variable = variable + campo + tab;
          |PINTA 1922,"                                                         ";
          |PINTA 1922,"C.ARTICULO:";
          |PINTA 1935,variable;
          campo = #3#128; |QBF campo;
          variable = variable + campo;
          |SI #0#59 = 1;
               |SI #0#58 =  30;
                    variable = variable + tab + #3#180;
               |FINSI;
          |FINSI;
          |SI #0#59 = 2;
               variable = variable + tab + #3#180;
          |FINSI;
          variable = variable + aFinReg;
          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          campo = "";
          variable = "";
          cadena = "";
|FPRC;

|DEFBUCLE lee_art1;
     #3#1;
     2,125;
     #0#7,#0#9,#0#36;
     #0#8,#0#10,#0#37;
     ;
     NULL,pasa_art1;
|FIN;

|PROCESO articul1;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "articul1.txt";
     aFicDes = empresa + "articul1.asc";
     empresa = empresa + "articul1.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_art1;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

||--------------------------  ARTICULOS COD.BARRAS ---------------------------

|PROCESO pasa_art2;
          campo = #3#128; |QBF campo;
          variable = campo + tab;
          campo = #3#1; |QBF campo;
          variable = variable + campo + tab;
          |PINTA 1922,"                                                         ";
          |PINTA 1922,"COD.BARRA:";
          |PINTA 1935,variable;
          campo = #3#0; |QBF campo;
          variable = variable + campo;
          |SI #0#59 = 1;
               |SI #0#58 = 30;
                    variable = variable + tab + #3#180;
               |FINSI;
          |FINSI;
          |SI #0#59 = 2;
               variable = variable + tab + #3#180;
          |FINSI;
          variable = variable + aFinReg;
          |HAZ QuitaRaros;
          |SI #0#67 = "D";
               |HAZ Diferencia;
               |SI FSalida ! 0;
                    |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
                    |XGRABA nHandle, variable;
               |FINSI;
          |SINO;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               |XGRABA nHandle, variable;
          |FINSI;
          campo = "";
          variable = "";
          cadena = "";
|FPRC;

|DEFBUCLE lee_art2;
     #3#1;
     2,125;
     #0#7,#0#9,#0#36;
     #0#8,#0#10,#0#37;
     ;
     NULL,NULL,NULL,NULL,NULL,pasa_art2;
     #3#128;
|FIN;

|PROCESO articul2;
     empresa = #0#29;
     |QBF empresa;
     aFicOrg = empresa + "articul2.txt";
     aFicDes = empresa + "articul2.asc";
     empresa = empresa + "articul2.txt";

     |XABRE aModoFic, empresa, nHandle;
     |SI FSalida ] 0;
          |HAZ IniDiferencia;
          |BUCLE lee_art2;
          |XCIERRA nHandle;
          |HAZ FinDiferencia;
     |SINO;
          aAlfa = "0000Error al crear:" + empresa;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO LeeConfDeSol;
     |DDEF aAlfa;
     aAlfa = aAlfa + "desol001";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          #referen@#0 = #0#0;
          |LEE 000#referen@.=;
          |CIERRA #referen@;
          aDeSolNom = #0#74; |QBF aDeSolNom;
          aDeSolWeb = #0#75; |QBF aDeSolWeb;
          aDeSolUsu = #0#76; |QBF aDeSolUsu;
          aDeSolPwd = #0#77; |QBF aDeSolPwd;
          |DBASE aPath;
          aAlfa = aPath + aDeSolNom + "/exporta";
          |MKDIR aAlfa;
          #0#29 = aAlfa + "/";
          |SI aSistema = "ESDOS";
               aDeSolShell = aPath + "exporta.bat";
          |SINO;
               aDeSolShell = aPath + "exporta.sh";
          |FINSI;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

||------------------------- RUTINA PRINCIPAL --------------------------------
|PROCESO Entra; |TIPO 7;
     |HAZ EsJamaica; nSwJamaica = FSalida;
     |HAZ EsCarnicas; nSwCarnicas = FSalida;
     |HAZ EsDeSol; nSwDeSol = FSalida;
|FPRC;

|PROCESO pasa_psion; |TIPO 3;
     |QUE_SISTEMA aSistema;
     aFinReg = &13;
     aFinReg = aFinReg + &10;

     aModoFic = "CWB"
     |SI nSwDeSol = 0; aModoFic = "WB"; |FINSI;

     |SI #99#1 = "SI";|O #99#1 = "si";
         |HAZ LeeParam;
         |HAZ LeeDivisa;
         |SI #99#2 = "S";|O #99#2 = "s";
             |PARA nPsion = 3;|SI nPsion [ 12;|HACIENDO nPsion = nPsion + 1;
                   |SI #99nPsion = "";|O #99nPsion = "          ";
                       |SAL;
                   |FINSI;
                   |ABRE #0;
                   #0#0 = #99nPsion;
                   |LEE 000#0=;
                   |SI FSalida = 0;
                       |SI nSwDeSol = 0; |HAZ LeeConfDeSol; |FINSI;
                       |HAZ CreaContadores;
                       empresa = #0#29;
                       |HAZ inicio;
                   |FINSI;
                   |CIERRA #0;
             |SIGUE;
         |SINO;
             |ABRE #0;
             #0#0 = #99#0;
             |LEE 020#0=;
             |SI FSalida = 0;
                 |SI nSwDeSol = 0; |HAZ LeeConfDeSol; |FINSI;
                 |HAZ CreaContadores;
                 empresa = #0#29;
                 |HAZ inicio;
             |FINSI;
             |CIERRA #0;
         |FINSI;
     |FINSI;
     |ATRI P;
     |MENAV "0000FIN DE PROCESOS";
     |ATRI p;
|FPRC;

|CALCULO inicio;
     tab1 = 9;
     final1 = 10;
     final2 = 13;
     tab = &tab1;
     final = "";

     |SI #0#59 = 2;
          aAlfa = #0#29; |QBF aAlfa;
          aAlfa = aAlfa + "exporta.cfg";
          |XABRE aModoFic, aAlfa, nHandle;
          |SI FSalida ] 0;
               variable = #0#67;
               |SI nSwDeSol = 0;
                    |HORA eaValXor; eaValXor = eaValXor % -102;
                    variable = variable + tab + eaValXor;
               |FINSI;
               aGuarda = eaValXor;
               eaValXor = 69;
               |SI nSwDeSol = 0; |HAZ Encripta; |FINSI;
               eaValXor = aGuarda;
               |XGRABA nHandle, variable;
               |XCIERRA nHandle;
          |SINO;
               aAlfa = "0000Error al crear:" + aAlfa;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |SI #0#58 ! 99;
         |SI #0#1  = "S"; |HAZ clientes; |FINSI;
         |SI #0#6  = "S"; |HAZ articulos; |HAZ Ansi2Utf8; |FINSI;
         |SI #0#11 = "S"; |HAZ f_contador;|HAZ Ansi2Utf8; |FINSI;
         |SI #0#20 = "S"; |HAZ f_iva;     |HAZ Ansi2Utf8; |FINSI;
         |SI #0#21 = "S"; |HAZ f_pago;    |HAZ Ansi2Utf8; |FINSI;
         |SI #0#22 = "S"; |HAZ f_cobros;  |HAZ Ansi2Utf8; |FINSI;
         |SI #0#53 ! "N"; |HAZ f_cobalb;  |HAZ Ansi2Utf8; |FINSI;
         |SI #0#28 = "S"; |HAZ f_precios; |HAZ Ansi2Utf8; |FINSI;
         |SI #0#35 = "S"; |HAZ f_dtofam;  |HAZ Ansi2Utf8; |FINSI;
         |SI #0#38 = "S"; |HAZ f_visitas; |HAZ Ansi2Utf8; |FINSI;
         |SI #0#59 = 2; |O #0#58 = 30;
              |SI #0#60 ! "N";
                    |HAZ Partidas; |HAZ Ansi2Utf8;
                    |HAZ PartiGen; |HAZ Ansi2Utf8;
              |FINSI;
         |FINSI;
     |FINSI;
     |SI #0#11 = "S";
          |HAZ f_impresion; |HAZ Ansi2Utf8;
     |FINSI;
     |SI #0#58 = 99;                  ||Venta Directa
         |SI #0#6  = "S"; |HAZ articul1; |HAZ Ansi2Utf8; |FINSI;
         |SI #0#6  = "S"; |HAZ articul2; |HAZ Ansi2Utf8; |FINSI;
     |FINSI;
     |SI #0#61 = "S"; |HAZ AyudaVta; |HAZ Ansi2Utf8; |FINSI;
     |SI #0#62 = "S";    ||Rutas
          |HAZ Ruta; |HAZ Ansi2Utf8
          |HAZ Situaciones; |HAZ Ansi2Utf8
          |HAZ RutasCli; |HAZ Ansi2Utf8
     |FINSI;
     |SI #0#59 = 2; |O #0#59 = 3;
          |HAZ Representantes; |HAZ Ansi2Utf8;
          |SI #0#6 = "S"; |Y #0#73 = "S";
               |HAZ CodBarra; |HAZ Ansi2Utf8;
          |FINSI;
     |FINSI;
     |SI #0#1 = "S"; |Y #0#6 = "S";
          |HAZ PromoCliArt; |HAZ Ansi2Utf8;
     |FINSI;
     |SI #0#63 = "S";
          |HAZ Proveedores; |HAZ Ansi2Utf8;
     |FINSI;
     |SI #0#6 = "S"; |Y #0#59 = 2;
          |HAZ Envases; |HAZ Ansi2Utf8;
     |FINSI;

     |SI nSwCarnicas = 0;
          |HAZ CarImpuesto; |HAZ Ansi2Utf8;
     |FINSI;

     |SI nSwDeSol = 0;
          aPath = #0#29; |QBF aPath;
          aLon = aPath % A0;
          nPos = 100 + (aLon - 1);
          aPath = aPath % nPos;
          aEjecuta = aDeSolShell;
          |SI aEjecuta ! "";
               |SI aSistema = "ESDOS";
                    |HAZ CreaBat;
                    |SYSTEM aEjecuta;
                    |FBORRA aEjecuta;
               |SINO;
                    |HAZ CreaShell;
                    |SYSTEM aEjecuta;
               |FINSI;
          |FINSI;
          |ACABA;
     |FINSI;

     aEjecuta = #psion002#13;
     |QBF aEjecuta;
     |SI aEjecuta ! "";
          |RSYSTEM aEjecuta;
     |FINSI;
|FCAL;

|PROCESO CreaBat;
     |XABRE "W", aEjecuta, nHandle;
     aAlfa = "@echo off";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo Sincronizando... >> sincro_log.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "date /T >> sincro_log.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "time /T >> sincro_log.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo open " + aDeSolWeb + "> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo " + aDeSolUsu + ">> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo " + aDeSolPwd + ">> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo lcd " + aPath + ">> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo cd canvi/auto/" + aDeSolNom + ">> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo bin >> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo prompt >> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo mput * >> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "echo quit >> ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "ftp -s:ftps.txt >> sincro_log.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa = "del /Q ftps.txt";
     |XGRABA nHandle, aAlfa;
     aAlfa =  aPath + "/*.*";
     |HAZ Cambia2Dos;
     aAlfa = "del /Q " + aAlfa;
     |XGRABA nHandle, aAlfa;
     |DBASS aAlfa;
     aAlfa = aAlfa + "agitool\plugins\ds_eje_php "
     |HAZ Cambia2Dos;
     aAlfa = aAlfa + "https://" + aDeSolWeb + "/" + "actualizacion_auto.php?tablet=" + aDeSolNom;
     |XGRABA nHandle, aAlfa;
     |XCIERRA nHandle;
|FPRC;

|PROCESO Cambia2Dos;
     aCadena = aAlfa;
     aAlfa = "";
     aLon = aCadena % A0;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aCar = aCadena % nPos;
          |SI aCar = "/"; aCar = "\"; |FINSI;
          aAlfa = aAlfa + aCar;
     |SIGUE;
|FPRC;

|PROCESO CreaShell;
     |XABRE "WB", aEjecuta, nHandle;
     aAlfa = "#!/bin/sh" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa =  "ftp -inv " + aDeSolWeb + " << EOF" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "user " + aDeSolUsu + " " + aDeSolPwd + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "bin" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "cd canvi/auto/" + aDeSolNom + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "lcd " + aPath + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "mput *" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa =  "quit" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "EOF" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "wget -o /tmp/wget_ineed.log -O /tmp/wget_ineed.res --no-check-certificate https://" + aDeSolWeb + "/actualizacion_auto.php?tablet=" + aDeSolNom + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "rm -f " + aPath + "/*.*" + &10;
     |XGRABA nHandle, aAlfa;
     aAlfa = "rm -f $0" + &10;
     |XGRABA nHandle, aAlfa;
     |XCIERRA nHandle;
     aAlfa = "chmod +x " + aEjecuta;

     |SYSTEM aAlfa;
|FPRC;

|CALCULO Varios7; |TIPO 7;
     |HAZ Entra;
     |SI nSwDeSol = 0;
          #99#13 = ""; |PINTA #99#13;
     |FINSI;
|FCAL;

|CALCULO Varios0;
     |PARA i = 3;|SI i [ 12;|HACIENDO i = i + 1;
           #99i = "";
           |PINTA #99i;
           #99#0 = "";
           |PINTA #99#0;
           |PINTA 1309 , "                      ";
     |SIGUE;
     |SI #99#2 = "N";|O #99#2 = "n";
         |PARA i = 3;|SI i [ 12;|HACIENDO i = i + 1;
               |C_M #99i , 1 , "N";
               |C_M #99#0 , 1 , "S";
         |SIGUE;
     |SINO;
         |PARA i = 3;|SI i [ 12;|HACIENDO i = i + 1;
               |C_M #99i , 1 , "S";
               |C_M #99#0 , 1 , "N";
         |SIGUE;
     |FINSI;
|FCAL;

|PROCESO LeeParam;
     |ABRE #13;
     #13#0 = "A";
     |LEE 001#13=;
     |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
     |LIBERA #13;
     |CIERRA #13;
|FPRC;

|PROCESO LeeDivisa;
     |ABRE #14;
     |ABRE #15;
     #14#0 = "A";
     |LEE 001#14=;
     |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
     #15#0 = #14#9;
     |LEE 001#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
     |LIBERA #14;
     |LIBERA #15;
     |CIERRA #14;
     |CIERRA #15;
|FPRC;

|PROCESO Modi; |TIPO 7;
     |ABRE #0;
     aAlfa = "N";
     |SI #99#2 = "S";
          |PARA i = 3; |SI i [ 12; |HACIENDO i = i + 1;
               #0#0 = #99i;
               |LEE 000#0=;
               |SI FSalida = 0; |Y #0#59 = 1;
                    aAlfa = "S";
               |FINSI;
          |SIGUE;
     |SINO;
          #0#0 = #99#0;
          |LEE 000#0=;
          |SI #0#59 = 1; aAlfa = "S"; |FINSI;
     |FINSI;
     |CIERRA #0;

     |C_M #99#13, 1, aAlfa;

     |SI nSwDeSol = 0;
          |C_M #99#13, 1, "N";
     |FINSI;

     |SI aAlfa = "N";
          #99#13 = ""; |PINTA #99#13;
     |FINSI;
|FPRC;

|PROCESO Ansi2Utf8;
     |SI nSwDeSol = 0;
          |COPIA_FICHERO aFicOrg, aFicDes;
          |FBORRA aFicOrg;
          |ACABA;
     |FINSI;

     |SI #0#59 = 1;
          |RCOPIA_FICHERO aFicOrg, aFicDes;
          |RFBORRA aFicOrg;
          |ACABA;
     |FINSI;

     aIP = "";
     |IP_REMOTO aIP;
     |DBASE aBase;
     |ESPECIFICA "RBASS", aLocal;

     aOrigen = aBase + "00psion/wait.exe"
     aDestino = aLocal + "/bin/wait.exe";
     aConte = aOrigen;
     |ESPECIFICA "MD5", aConte;
     aVer1 = FSalida;
     aConte = aDestino;
     |ESPECIFICA "REMOTOMD5", aConte;
     aVer2 = FSalida;
     |SI aVer1 ! aVer2;
          |SI aIP ! "";
               |ENVIA_FICHERO aOrigen, aDestino;
          |SINO;
               |COPIA_FICHERO aOrigen, aDestino;
          |FINSI;
     |FINSI;

     aOrigen = aBase + "00psion/ansitoutf8.exe"
     aDestino = aLocal + "/bin/ansitoutf8.exe";
     aConte = aOrigen;
     |ESPECIFICA "MD5", aConte;
     aVer1 = FSalida;
     aConte = aDestino;
     |ESPECIFICA "REMOTOMD5", aConte;
     aVer2 = FSalida;
     |SI aVer1 ! aVer2;
          |SI aIP ! "";
               |ENVIA_FICHERO aOrigen, aDestino;
          |SINO;
               |COPIA_FICHERO aOrigen, aDestino;
          |FINSI;
     |FINSI;

     aAlfa = "wait " + aDestino + " 4 " + aFicOrg + " " + aFicDes;
     aLon = aAlfa % A0;
     aExe = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aCar = aAlfa % nPos;
          |SI aCar = "/"; aCar = "\"; |FINSI;
          aExe = aExe + aCar;
     |SIGUE;

     |RSYSTEM aExe;
     |RFBORRA aFicOrg;
|FPRC;

|PROCESO Min;
     #35#0 = #0#0;
     #35#1 = "     ";
|FPRC;

|PROCESO Max;
     #35#0 = #0#0;
     #35#1 = "zzzzz";
|FPRC;

|PROCESO Rutas; |TIPO 0;
     |SI FSalida = 0; |Y #0#62 = "S";
          |PUSHV 0501 2380;
          |BLANCO 818 2354;
          |ENTLINEAL #1#35, 2, 4, 21, 1, Min, Max;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI FSalida = 0; |Y #35#1 = Contenido;
          |SI #35#3 = " ";
               #35#3 = "*";
          |SINO;
               #35#3 = " ";
          |FINSI;
          |GRABA 000#35a;
          |PINTA #35#3;
     |FINSI;
|FPRC;

|PROCESO CreaConta;
     #5#2 = aSerie;
     #5#0 = "";
     |LEE 000#5];
     |SI FSalida ! 0; |O #5#2 ! aSerie;
          #5#1 = 1;
          #5#2 = aSerie;
          #5#3 = "";
          #5#0 = "vpedido"; |GRABA 020#5n;
          #5#0 = "vpedcom"; |GRABA 020#5n;
          #5#0 = "vdepo"; |GRABA 020#5n;
          #5#0 = "valbaran"; |GRABA 020#5n;
          #5#0 = "valbaco"; |GRABA 020#5n;
          #5#0 = "vfactura"; |GRABA 020#5n;
          #5#0 = "vfacturo"; |GRABA 020#5n;
          #5#0 = "vfactuco"; |GRABA 020#5n;
          #5#0 = "vfacprof"; |GRABA 020#5n;
          #5#0 = "remesa"; |GRABA 020#5n;
          #5#0 = "desglos"; |GRABA 020#5n;
          #5#0 = "vpresup"; |GRABA 020#5n;
          #5#0 = "ordenfab"; |GRABA 020#5n;
          #5#0 = "vtiquet"; |GRABA 020#5n;
     |FINSI;
|FPRC;

|PROCESO CreaContadores;
     |ABRE #5
     aSerie = #0#23; |HAZ CreaConta;
     aSerie = #0#24; |HAZ CreaConta;
     aSerie = #0#25; |HAZ CreaConta;
     aSerie = #0#26; |HAZ CreaConta;
     aSerie = #0#12; |HAZ CreaConta;
     aSerie = #0#13; |HAZ CreaConta;
     aSerie = #0#14; |HAZ CreaConta;
     aSerie = #0#15; |HAZ CreaConta;
     aSerie = #0#16; |HAZ CreaConta;
     aSerie = #0#17; |HAZ CreaConta;
     aSerie = #0#18; |HAZ CreaConta;
     aSerie = #0#19; |HAZ CreaConta;
     aSerie = #0#47; |HAZ CreaConta;
     aSerie = #0#48; |HAZ CreaConta;
     aSerie = #0#49; |HAZ CreaConta;
     aSerie = #0#50; |HAZ CreaConta;
     |CIERRA #5;
|FPRC;

|PROCESO JamaCheqActa;
     |SI #12#61 = 0;
          |ABRE #102;
          #102#30 = "A";
          #102#20 = #12#52;
          #102#17 = #12#0;
          #102#18 = 1;
          |LEE 000#102];
          |SI FSalida = 0; |Y #102#30 = "A"; |Y #102#20 = #12#52;
                    |Y #102#17 = #12#0;
               aAlfa = "0000Albaran:" + #12#52 + "/" + (("000000" + #12#0) % -106) + &13;
               aAlfa = aAlfa + " a cuenta '0' y con recibos !!!";
               |MENAV aAlfa;
          |FINSI;
          |CIERRA #102;
     |FINSI;
|FPRC;
