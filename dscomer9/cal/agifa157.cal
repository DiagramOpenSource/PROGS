                    ||CAMBIO CODIGOS PROVEEDOR
|FICHEROS;
     agifa157 #0;
     agifa154 #1;
     agifa112 #2;        ||Proveedores
     agifa019 #3;        ||Articulos
     agifa065 #4;        ||Historico
     agifa081 #5;        ||Pedidos Compras
     agifa067 #6;        ||Lineas Pedidos Compras
     agifa077 #7;        ||albaran Compras
     agifa080 #8;        ||Lineas Albaran Compras
     agifa079 #9;        ||Facturas Compras
     agitp001;
     dsm00226;
     dsm00244;
     dsm00245;
     dsm00018 #11;
     agi00028 #12;
     dsm00112 #13;
     agifa561 #14;
     agrom011@;
|FIN;


|VARIABLES;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     &enSwAltaPrv = 0;
     aDef = "";
     &CambDesc = "";
     &AltaArt  = "";

     aCuenta   = "";
     nLon      = 0;
     aLon      = 0;
     &tabla = 0;
     &sust = " ";
     &stock = " ";
     &tipo = " ";
     i = 0;
     prov1 = "";
     prov = "";
     desde = "                              ";
     hasta = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FIN;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Bagrom011;
     #agrom011@#3 = prov1;
     |GRABA 020#agrom011@.a;
     |LIBERA #agrom011@;
|FPRC;

|DEFBUCLE Bagrom011;
     #agrom011@#1003;
     3;
     "     ", 000001, 001, prov;
     "zzzzz", 999999, 999, prov;
     be;
     NULL, Bagrom011;
|FIN;

|PROCESO agrom011;
     |DDEF aDef;
     aDef = aDef + "agrom011";
     |CARGA_DEF aDef, agrom011@;
     |SI FSalida = 0;
          |BUCLE Bagrom011;
          |DESCARGA_DEF #agrom011@;
     |FINSI;
|FPRC;

|PROCESO dsm00112;
     |BORRA 020#13a;
     #13#0 = prov1;
     |GRABA 000#13n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "dsm00112";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00112;
     #13#1;
     ;
     prov, 1;
     prov, 9;
     be;
     NULL, dsm00112;
|FIN;

|PROCESO agifa561;
     |BORRA 020#14a;
     #14#1 = prov1;
     |GRABA 000#14n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agifa561";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE agifa561;
     #14#1;
     ;
     "                    ", prov;
     "zzzzzzzzzzzzzzzzzzzz", prov;
     be;
     NULL, agifa561;
|FIN;

|PROCESO agi00028;
     |SI #12#4 = prov;
          #12#4 = prov1;
          |GRABA 020#12a;
          |LIBERA #12;
     |FINSI;
|FPRC;

|DEFBUCLE agi00028;
     #12#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, agi00028;
|FIN;

|PROCESO dsm00018;
     |SI sust = "S";
          |BORRA 020#11a;
     |FINSI;
     #11#0 = prov1;
     |GRABA 000#11n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "dsm00018";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE  dsm00018;
     #11#1;
     ;
     prov, "PR", 001;
     prov, "PR", 999;
     be;
     NULL, dsm00018;
|FIN;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴

|PROCESO Cuenta;
     aCuenta = #2#10; |QBF aCuenta;
     aLon = aCuenta % A0;
     nLon = aLon;
     nLon = nLon - 4 + 100;
     aCuenta = aCuenta % nLon;
     aCuenta = aCuenta + prov1;
|FPRC;

|PROCESO miraprov;
     |ABRE #2;
     #2#0 = prov;
     |LEE 001#2=;
     |SI FSalida = 0;
          |SI sust = "S";
               |BORRA 021#2a;
          |FINSI;
          |SI stock = "S";
               |PARA i = 27; |SI i [ 40; |HACIENDO i = i + 1;
                    #2i = 0;
               |SIGUE;
               |PARA i = 43; |SI i [ 56; |HACIENDO i = i + 1;
                    #2i = 0;
               |SIGUE;
          |FINSI;
          #2#0 = prov1;
          |SI CambDesc = "S"; #2#1 = #1#5; #2#2 = #1#5; |FINSI;
          |HAZ Cuenta;
          #2#10 = aCuenta;
          |SI AltaArt = "S";
               enSwAltaPrv = 1;
               |GRABA 000#2b; || No cambiar para ejecucion
               |SI FSalida ! 0;
                    enErr = FSalida;
                    eaFic = "agifa112";
                    eaOrg = prov;
                    eaDes = prov1;
                    |HAZ Print;
               |FINSI;
               |GRABA 000#2a; || del TIPO 16
          |FINSI;
          |LIBERA #2;
     |FINSI;
     |CIERRA #2;
|FPRC;


||===================== CAMBIO DE CODIGO EN PROMOCIONES LINS ===============

|PROCESO dsm00245;
     |BORRA 020#dsm00245.a;
     #dsm00245#0 = prov1;
     |GRABA 000#dsm00245.n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "dsm00245";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00245;
     #dsm00245#1;
     ;
     prov,   0, "                    ";
     prov, 999, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, dsm00245;
|FIN;

||===================== CAMBIO DE CODIGO EN PROMOCIONES CABS ===============

|PROCESO dsm00244;
     |BORRA 020#dsm00244.a;
     #dsm00244#0 = prov1;
     |GRABA 000#dsm00244.n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "dsm00244";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE dsm00244;
     #dsm00244#1;
     ;
     prov,   0;
     prov, 999;
     be;
     NULL, dsm00244;
|FIN;

||===================== CAMBIO DE CODIGO EN OFERTAS =====================

|PROCESO dsm00226;
     #dsm00226#1 = prov1;
     |GRABA 020#dsm00226.a;
|FPRC;

|DEFBUCLE dsm00226;
     #dsm00226#1;
     1;
          0, prov;
     999999, prov;
     be;
     NULL, dsm00226;
|FIN;

||===================== CAMBIO DE CODIGO EN TARIFAS =====================

|PROCESO agitp001;
     |BORRA 020#agitp001.a;
     #agitp001#0 = prov1;
     |GRABA 000#agitp001.n;
     |SI FSalida ! 0;
          enErr = FSalida;
          eaFic = "agitp001";
          eaOrg = prov;
          eaDes = prov1;
          |HAZ Print;
     |FINSI;
|FPRC;

|DEFBUCLE agitp001;
     #agitp001#1;
     ;
     prov, "                    ";
     prov, "zzzzzzzzzzzzzzzzzzzz";
     be;
     NULL, agitp001;
|FIN;

||===================== CAMBIO DE CODIGO EN ARTICULOS =====================

|PROCESO arti;
     #3#27 = prov1;
     |GRABA 021#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE articulo;
#3#1;
27;
"                    " , prov;
"zzzzzzzzzzzzzzzzzzzz" , prov;
be;
NULL , arti;
|FIN;

||======================== CAMBIO CODIGO EN HISTORICO =====================

|PROCESO histo;
     #4#10 = prov1;
     ||GRABA 021#4a;     modificado para inforpor
     |BORRA 020#4a;
     |GRABA 020#4n;
     |LIBERA #4;
|FPRC;

|DEFBUCLE historic;
#4#1;
10;
"                    " , "00.00.0000" , "  " ,       0 ,     0 , "     " , prov;
"zzzzzzzzzzzzzzzzzzzz" , "31.12.9999" , "zz" ,  999999 , 99999 , "zzzzz" , prov;
be;
NULL , histo;
|FIN;

||==================== CAMBIO CODIGO EN PEDIDOS COMPRAS ===================

|PROCESO cabpedi;
     #5#4 = prov1;
     |SI CambDesc = "S"; #5#8 = #1#5; |FINSI;
     |GRABA 021#5a;
     |LIBERA #5;
|FPRC;

|PROCESO linpedi;
     |LEE 101#6=;
     #6#20 = prov1;
     |GRABA 021#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE pedido;
#5#2;
;
prov;
prov;
be;
NULL , cabpedi , linpedi;
|FIN;

||==================== CAMBIO CODIGO EN ALBARAN COMPRAS ===================

|PROCESO cabalb;
     #7#3 = prov1;
     |SI CambDesc = "S"; #7#4 = #1#5; |FINSI;
     |GRABA 021#7a;
     |LIBERA #7;
|FPRC;

|PROCESO linalb;
     |LEE 101#8=;
     #8#15 = prov1;
     |GRABA 021#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE albaran;
     #7#3;
     ;
     prov, "01.01.0000", "     ", 000001;
     prov, "31.12.9999", "zzzzz", 999999;
     be;
     NULL , cabalb , linalb;
|FIN;


||==================== CAMBIO CODIGO EN FACTURAS COMPRAS ===================

|PROCESO cabfac;
     #9#2 = prov1;
     |SI CambDesc = "S"; #9#3 = #1#5; |FINSI;
     #9#12 = aCuenta;
     |GRABA 021#9a;
     |LIBERA #9;
|FPRC;

|DEFBUCLE factura;
#9#2;
;
prov, desde;
prov, hasta;
be;
NULL , cabfac;
|FIN;

||==================== CAMBIO CODIGO EN RECIBOS COMPRAS ===================

|PROCESO empieza;
     prov = #1#2 % 106;
     prov1 = #1#3 % 106;
     #0#0 = prov;
     #0#1 = prov1;
     |PINTA #0#0;   |PINTA #0#1;
     |HAZ miraprov;
     |SI sust = "S";
          |BUCLE articulo;
          |BUCLE historic;
          |BUCLE pedido;
          |BUCLE albaran;
          |BUCLE factura;
          |BUCLE agitp001;
          |BUCLE dsm00226;
          |BUCLE dsm00244;
          |BUCLE dsm00245;
          |BUCLE agi00028;
          |BUCLE agifa561;
          |BUCLE dsm00112;
     |FINSI;
     |BUCLE dsm00018;
|FPRC;

|DEFBUCLE primero;
#1#1;
6;
tabla ,     0, tipo;
tabla , 99999, tipo;
e;
NULL , empieza;
|FIN;

|PROGRAMA;
     |PINPA #0#0;
     |BUCLE primero;
     |HAZ EnviaMail;
|FPRO;
