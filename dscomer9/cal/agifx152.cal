     Envio Mail errores

|VARIABLES;
     &eaMail = "";
     &tabla = 0;
     &eaFic = "";
     &eaOrg = "";
     &eaDes = "";
     &enErr = 0;
     aTitulo = "";
     nPrime = 0;
     nImpre = -1;
     nInfor = -1;
     aFic = "";
     aIP = "";
     aServidor = "";
     aFrom = "";
     aTo = "";
     aSubject = "";
     aMensaje = "";
     aDjunto = "";
|FIN;

|PROCESO Print;
     |SI eaMail = ""; |ACABA; |FINSI;

     |SI aTitulo = "";
          aTitulo = "Errores informe cambio códigos: " + (("000"+ tabla)%-103);
     |FINSI;

     |SI nPrime = 0;
          |DFICE aFic;
          aFic = aFic + Usuario + ".txt";

          Impresora = aFic;
          |IMPRE -77;
          nImpre = FSalida;
          |SI FSalida = 0;
               |INFOR "agifa155";
               nInfor = FSalida;
          |FINSI;
          nPrime = 1;
     |FINSI;

     |SI nImpre = 0; |Y nInfor = 0;
          |PRINT;
     |FINSI;
|FPRC;

|PROCESO EnviaMail;
     |SI eaMail = ""; |ACABA; |FINSI;

     |SI nImpre = 0; nInfor = 0;
          |PIEINF;
     |SINO;
          aTitulo = "Informe cambio códigos sin errores: " + (("000"+ tabla)%-103);
          |HAZ Print;
          |SI nImpre = 0; nInfor = 0;
               |PIEINF;
          |FINSI;
     |FINSI;
     |SI nInfor = 0; |FININF; |FINSI;
     |SI nImpre = 0; |FINIMP; |FINSI;

     aIP = "xdscorreo.dv.diagram.net";
     aServidor = "asmtp.diagram.es";
     aFrom = eaMail;
     aTo = aFrom;
     aSubject = aTitulo;
     aMensaje = aTitulo;
     aDjunto = aFic;
     |DSCORREO_ENVIA aIP, aServidor, aFrom, aTo, aSubject, aMensaje, aDjunto;
|FPRC;
