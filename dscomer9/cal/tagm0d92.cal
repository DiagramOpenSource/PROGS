  DsSelect

|VARIABLES;
     &eaPath = "";
     &eaTipoSele = "";
     &eaFic = "";
     aAlfa = "";
     aBase = "";
     aIPRemoto = "";
     {1}aContiene = "";
     {1}aLocal = "";
     aVersion1 = "";
     aVersion2 = "";
     aOrigen = "";
     aDestino = "";
     aTxt = "";
     nCar = 0;
     aCar = "";
     nPos = 0;
     aLon = "";
     i = 0;
     nHandle = 0;
     aFin = "";
     nPausa = "";
     aIni = "";
|FIN;

|PROCESO EnviaMD5;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aVersion2 = FSalida; |QBF aVersion2;

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aVersion1  = FSalida;  |QBF aVersion1;

     |SI aVersion1 ! aVersion2;
          |SI aIPRemoto ! "";
               |ENVIA_FICHERO aOrigen, aDestino;
          |SINO;
               |COPIA_FICHERO aOrigen, aDestino;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CamCarac;
     aLon = aAlfa % 0;
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
           nPos = (i * 100) + 1;
           aCar = aAlfa % nPos;
           nCar = &aCar;
           |SI nCar = 241;  aCar = "¤";  |FINSI;
           |SI nCar = 225;  aCar = " ";  |FINSI;
           |SI nCar = 233;  aCar = "‚";  |FINSI;
           |SI nCar = 237;  aCar = "¡";  |FINSI;
           |SI nCar = 243;  aCar = "¢";  |FINSI;
           |SI nCar = 250;  aCar = "£";  |FINSI;
           |SI nCar = 209;  aCar = "¥";  |FINSI;
           |SI nCar = 193;  aCar = "A";  |FINSI;
           |SI nCar = 201;  aCar = "E";  |FINSI;
           |SI nCar = 205;  aCar = "I";  |FINSI;
           |SI nCar = 211;  aCar = "O";  |FINSI;
           |SI nCar = 218;  aCar = "U";  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO DsSelect;
     eaFic = "";
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |DBASE aOrigen;
     aOrigen = aOrigen + "plugins/dsselect.exe";
     |SI aIPRemoto = "";
          |DBASS aBase;
          aAlfa = aBase + "bin/";
     |SINO;
          |ESPECIFICA "RBASS", aLocal;
          aBase = aLocal;
          aAlfa = aBase + "bin/";
     |FINSI;
     aDestino = aAlfa + "dsselect.exe";
     aIni = aAlfa + "dsselect.ini";
     |HAZ EnviaMD5;

     aTxt = aBase + "dsselect.txt";
     |RFBORRA aTxt;

     eaTipoSele = "";    || 'C' para carpeta

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + " " + &34 + eaPath + &34 + " " + aTxt +  " " + eaTipoSele + &34;
     |RSYSTEM aAlfa;

     |XABRE "CU", aTxt, nHandle;
     |SI FSalida ] 0;
          |XLEE nHandle, 250, eaFic;
          |SI FSalida ] 0
               aAlfa = eaFic;
               |HAZ CamCarac;
               eaFic = aAlfa;
          |FINSI;
          |XCIERRA nHandle;
          |RFBORRA aTxt;
     |FINSI;
|FPRC;
