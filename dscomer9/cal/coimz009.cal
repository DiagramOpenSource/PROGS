/* Antes de T13953
|FICHEROS;
     coimz009 #0;
     coima001 #1;
     coima003 #3;
     coima013 #13;
     agifa010 #10;
     agifa017 #17;
     coima021 #21;
     coima027 #27;
     agifa019 #19;
     agifa049 #49;
     agifa065 #65;
     agifa071 #71;
     coima041 #41;
|FIN;

|VARIABLES;
     fHoy = @;
     nNume = 0;
     nCanti = 0;
     nCant1 = 0;
     nDispo = 0;
     nDispo1 = 0;
     nDispo2 = 0;
     nDispoTot = 0;
     nDispoTot1 = 0;
     nDispoTot2 = 0;
     prime = 0;
     prim1 = 0;
     nLin = 0;
     nOk = 0;
|FIN;

|PROCESO coima021;
     #19#0 = #21#5;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;

     #17#0 = #21#5;
     #17#1 = 1;
     |LEE 000#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

     #21#26 = 0;
     |SI #19#135 = "S";
          |SI #17#39 > 0;
               #21#26 = 1;
          |SINO;
               #27#0 = #17#0;
               #27#1 = #17#1;
               |LEE 000#27=;
               |SI FSalida ! 0; |DDEFECTO #27; |FINSI;
               nNume = #17#39  + #27#4;
               |SI nNume > 0;
                    #21#26 = 2;
               |SINO;
                    nNume = #17#39 + #27#4 + #27#5;
                    |SI nNume > 0;
                         #21#26 = 3;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI #19#135 = "N";
          |SI #17#9 > 0;
               #21#26 = 1;
          |SINO;
               #27#0 = #17#0;
               #27#1 = #17#1;
               |LEE 000#27=;
               |SI FSalida ! 0; |DDEFECTO #27; |FINSI;
               nNume = #17#39  + #27#4;
               |SI nNume > 0;
                    #21#26 = 2;
               |SINO;
                    nNume = #17#9 + #27#4 + #27#5;
                    |SI nNume > 0;
                         #21#26 = 3;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     ||ARA44
     |SI #21#26 = 0;
          |ABRE #coima041;
          |DDEFECTO #coima041;
          #coima041#0 = #agifa019#125;
          |LEE 000#coima041.=;
          |SI FSalida ! 0;
               #21#26 = 4;
          |FINSI;
          |CIERRA #coima041;
     |FINSI;
     |GRABA 020#21a;
|FPRC;

|DEFBUCLE coima021;
     #21#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, coima021;
|FIN;

|PROCESO Albaranes;
     nOk = 1;
     |SALVA_FICHA #10;
     #10#52 = #10#86;
     #10#0 = #10#87;
     |LEE 000#10=;
     |SI FSalida = 0;
          |SI #10#2 ! 0; |Y #10#87 = 0;
               nOk = 0;
          |FINSI;
     |FINSI;
     |REPON_FICHA #10;
     |SI nOk = 0;        || Todas las lineas estan con 0 unidades
          nLin = 0;
          |LEE 121#10=;
          |BUCLELIN 0 BorraUni0 #10;
          |SI nLin = 0;
               |HAZ BorraPrepa;
               |BORRA 020#10a;
          |FINSI;
          |LIBERA #10;
     |FINSI;
|FPRC;

|DEFBUCLE Albaranes;
     #10#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Albaranes;
|FIN;

|PROCESO BorraPrepa;
     |ABRE #13;
     #13#0 = #10#52;
     #13#1 = #10#0;
     |LEE 101#13=;
     |SI FSalida = 0;
          |BUCLELIN 1 NULL #13;
          |BORRA 020#13a;
     |FINSI;
     |CIERRA #13;

|FPRC;

|PROCESO BorraUni0;
     |SI #71#5 = 0;
          |BORRA 020#71a;

          #65#0 = #71#2;
          #65#1 = #10#1;
          |SI #10#43 = "S";
               #65#2 = "BV";
          |SINO;
               #65#2 = "AV";
          |FINSI;
          #65#3 = #10#0;
          #65#4 = #71#1;
          #65#11 = #10#52;
          |BORRA 000#65c;
     |SINO;
          nLin = nLin + 1;
     |FINSI;
|FPRC;

|PROCESO Fin;
     |SI nOk = 1;
          |SALVA_DATOS #10;

          #10#52 = #10#86;
          #10#0 = #10#87;
          |LEE 101#10=;
          |SI FSalida = 0;
               nLin = 0;
               |BUCLELIN 0 BorraUni0 #10;
               |SI nLin = 0;
                    |HAZ BorraPrepa;
                    |BORRA 020#10a;
               |FINSI;
               |LIBERA #10;
          |FINSI;

          |REPON_DATOS #10;
          |LEE 101#10=;
          |SI FSalida = 0;
               #10#85 = "N";  || Quita Albaran hermano
               #10#86 = "";
               #10#87 = 0;
               |GRABA 020#10a;
          |FINSI;
     |FINSI;
     |LIBERA #10;
|FPRC;

|PROCESO QuitaLin;
     |SI nOk = 1;
          #71#47 = "";   || Quita Albaran hermano
          |GRABA 020#71a;
     |FINSI;
     |LIBERA #71;
|FPRC;

|PROCESO QuitaHermano;
     |SI #10#87 ! 0; |Y #10#2 ! 0;
          nOk = 1;
     |SINO;
          nOk = 0;
          |ERROR;
     |FINSI;
|FPRC;

|DEFBUCLE QuitaHermano;
     #10#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, QuitaHermano, QuitaLin, Fin;
|FIN;

|PROCESO coima003;
     |DDEFECTO #27;
     #27#0 = #3#13;
     #27#1 = #3#16;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     nNume = #3#10 - fHoy;
     |SI nNume < #1#5;
          #27#4 = #27#4 + (#3#7 - #3#8);
     |SINO;
          #27#5 = #27#5 + (#3#7 - #3#8);
     |FINSI;
     |GRABA 020#27a;
     |LIBERA #27;

     |SI #3#17 ! 0;
          #3#17 = 0;
          |GRABA 020#3a;
     |FINSI;
|FPRC;

|DEFBUCLE coima003;
     #3#3;
     ;
     "                    ", 00001, "N";
     "zzzzzzzzzzzzzzzzzzzz", 99999, "N";
     be;
     NULL, coima003;
|FIN;

|PROCESO agifa017;
     |DDEFECTO #27;
     #27#0 = #17#0;
     #27#1 = #17#1;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     #27#4 = 0;
     #27#5 = 0;
     #27#7 = 0;
     |GRABA 020#27a;
     |LIBERA #27;
|FPRC;

|DEFBUCLE agifa017;
     #17#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa017;
|FIN;

|PROCESO Escankits;
     |DDEFECTO #17;
     #17#0 = #49#2;
     #17#1 = 1;
     |LEE 000#17=;
     |SI FSalida = 0;
          nDispo = #17#39;
          |DDEFECTO #17;
          #17#0 = #19#0;
          #17#1 = 1;
          |LEE 101#17=;
          |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
          |SI prime = 0;;
               #17#9 = nDispo;
               prime = 1;
               nDispoTot = nDispo;
          |SINO;
               |SI nDispo [ #17#9;
                    #17#9 = nDispo;
                    nDispoTot = nDispo;
               |FINSI;
          |FINSI;
          |GRABA 020#17a;
          |LIBERA #17;
     |FINSI;

     |DDEFECTO #27;
     #27#0 = #49#2;
     #27#1 = 1;
     |LEE 000#27=;
     |SI FSalida = 0;
          nCanti = #27#4;
          nCant1 = #27#5;
          |SI prim1 = 0;
               nDispoTot1 = nCanti + nDispo;
               nDispoTot2 = nCant1 + nCanti + nDispo;
               prim1 = 1;
         |SINO;
               nDispo1 = nDispo + nCanti;
               nDispo2 = nDispo1 + nCant1;
               |SI nDispo1 < nDispoTot1;
                    nDispoTot1 = nDispo1;
               |FINSI;
               |SI nDispo2 < nDispoTot2;
                    nDispoTot2 = nDispo2;
               |FINSI;
          |FINSI;
     |FINSI;

|FPRC;

|DEFBUCLE Escankits;
     #49#1;
     ;
     #19#0,   0;
     #19#0, 999;
     ;
     NULL, Escankits;
|FIN;


|PROCESO kits;
     |DDEFECTO #17;
     #17#0 = #19#0;
     #17#1 = 1;
     |LEE 101#17=;
     |SI FSalida ! 0; |GRABA 020#17b; |FINSI;
     #17#9 = 0;
     |GRABA 020#17a;
     |LIBERA #17;
     |DDEFECTO #27;
     #27#0 = #17#0;
     #27#1 = #17#1;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     #27#4 = 0;
     #27#5 = 0;
     |GRABA 020#27a;
     |LIBERA #27;
     prime = 0;
     prim1 = 0;
     nDispoTot = 0;
     nDispoTot1 = 0;
     nDispoTot2 = 0;
     |BUCLE Escankits;
     |DDEFECTO #27;
     #27#0 = #19#0;
     #27#1 = 1;
     |LEE 101#27=;
     |SI FSalida ! 0; |GRABA 020#27b; |FINSI;
     #27#4 = nDispoTot1 - nDispoTot;
     #27#5 = nDispoTot2 - nDispoTot1;
     |GRABA 020#27a;
     |LIBERA #27;
|FPRC;

|DEFBUCLE kits;
     #19#1;
     135;
     "                    ", "N";
     "zzzzzzzzzzzzzzzzzzzz", "N";
     ;
     NULL, kits;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 = "NO"; |ACABA; |FINSI;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     |ABRE #27;
     |BUCLE agifa017;
     |BUCLE coima003;
     |ABRE #17;
     |BUCLE kits;
     |CIERRA #17;
     |CIERRA #27;

     |ABRE #65;
     |BUCLE QuitaHermano;
     |CIERRA #65;

     |BUCLE Albaranes;

     ||* Semaforo Ineed *
     |ABRE #19;
     |ABRE #17;
     |ABRE #27;
     |BUCLE coima021;
     |CIERRA #27;
     |CIERRA #17;
     |CIERRA #19;
|FPRC;

|PROGRAMA;
     fHoy = ~;
     |SI PARAMETRO = "menu";
          |MANTE #0;
     |SINO;
          #0#0 = "SI";
          |HAZ Tipo3;
     |FINSI;
|FPRO;
*/
