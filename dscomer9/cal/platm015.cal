|FICHEROS;
 platm015 #0;
 platm011 #1;
 platm020 #2;
 platm012 #3;
|FIN;

|VARIABLES;
 linea = 0;
 ii = 0;
 aEstado = "";
 nModo = 0;
|FIN;

|PROCESO tipo3015;| TIPO 3;
|SI FSalida = 0;
  |ABRE #1;
  #1#0 = #0#0;
  |LEE 010#1=;
  |SI FSalida = 0;
       aEstado = #1#7;
      #1#7 = "AVERIADO";
      |GRABA 010#1a;
  |FINSI;
  |LIBERA #1;
  |CIERRA #1;
  |ABRE #2;
  #2#0 = #0#0;
  #2#3 = 001;
  |LEE 010#2=;
  |SI FSalida ! 0;
    linea = 1;
  |SINO;
    |PARA ii = 1;|SI ii [100;|HACIENDO;
      linea = #2#3;
      |LEE 010#2s;
      |SI #2#0 ! #0#0;|O FSalida ! 0;
        |SAL;
      |FINSI;
    |SIGUE;
  |FINSI;
  |LIBERA #2;
  #2#0 = #0#0;
  #2#3 = linea+1;
  #2#1 = "AVERIA";
  #2#2 = #0#3;
  |GRABA 010#2n;
  |LIBERA #2;
  |CIERRA #2;
|FINSI;
|FPRC;

|CALCULO MiraSiYa;
nModo = (FEntrada/100)!0;
|SI nModo = 1;
  |ABRE #1;
  #1#0 = #0#0;
  |LEE 010#1=;
  |SI FSalida = 0;
      aEstado = #1#7;
      |QBF aEstado;
      |SI aEstado ! "ALMACEN";
        |MENAV "0000 Mercancia no esta en almacen";
        |ERROR;
      |FINSI;
      |SI #1#8 = "O";
        |MENAV "0000 SOLO NUMEROS DE SERIE";
        |ERROR;
      |FINSI;
  |FINSI;
  |LIBERA #1;
  |CIERRA #1;
|FINSI;
|FCAL;

|PROCESO MiraEstado;
|ABRE #1;
#1#0 = #0#0;
|LEE 010#1=;
|SI FSalida ! 0;|DDEFECTO #1;|FINSI;
|LIBERA #1;
|CIERRA #1;
|FPRC;

|PROCESO SumaTipo;
|HAZ MiraEstado;
|QBF aEstado;
|ABRE #platm012;
#platm012#0 = #platm011#2;
|LEE 010#platm012.=;
|SI FSalida = 0;
  |SI aEstado = "ALMACEN";
    #platm012#2 = #platm012#2 -. 1;
  |FINSI;
  |SI aEstado = "INSTALADO";
    #platm012#3 = #platm012#3 -. 1;
  |FINSI;
  |SI aEstado = "REPARADO";
    #platm012#5 = #platm012#5 -. 1;
  |FINSI;
  |SI aEstado = "ENVIOPLATA";
    #platm012#7 = #platm012#7 -. 1;
  |FINSI;
  #platm012#4 = #platm012#4 +. 1;
  #platm012#6 = #platm012#2 + #platm012#3 + #platm012#4 + #platm012#5+#platm012#7;
  |GRABA 010#platm012.a;
|FINSI;
|LIBERA #platm012;
|CIERRA #platm012;
|FPRC;

|PROCESO Baja;
nModo = (FEntrada/100)!0;
|SI nModo = 3;
  |HAZ MiraEstado;
  |SI aEstado ! "AVERIADO";
    |MENAV "0000 MATERIAL NO AVERIADO. NO SE PUEDE DAR DE BAJA";
  |SINO;
    |ABRE #1;
    #1#0 = #0#0;
    |LEE 010#1=;
    |SI FSalida = 0;
      #1#7 = "ALMACEN";
      |GRABA 010#1a;
    |FINSI;
    |LIBERA #1;
    |CIERRA #1;
  |FINSI;
|FINSI;
|FPRC;

|CALCULO tipo2;|TIPO 2;
|HAZ Baja;
|HAZ SumaTipo;
|FCAL;
