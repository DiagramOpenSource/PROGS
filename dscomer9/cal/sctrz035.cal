|FICHEROS;
     sctrz035 #0;
     sctrm008 #8;
     sctrw009 #9;   ||Tmp1
     sctrw010 #10;  ||Tmp2
     sctrm023 #23;
     sctrm025 #25;
     sctrm026 #26;
     sctrm001 #100;
     sctrz014 #114; ||Pan Trafico diario
     sctrz041 #141,MANTE; ||Pan Masivo
     sctrz042 #142,MANTE; ||Pan Pax
     referen@ #500;
|FIN;

|VARIABLES;
     &enCtrFin = 0;
     &Tempo = "";
     &eaNomLogo = "";
     &enPantaLogo = 0;
     nPanta = 0;
     aTmp9 = "";
     aTmp10 = "";
     nRango = 0;
     nGrid9 = 0;
     nGrid10 = 0;
     nBtnAbreCierra = 0;
     nBtnMasivo = 0;
     nBtnPax = 0;
     nBtnAnulaSi = 0;
     nBtnAnulaNo = 0;
     nBtnCancela = 0;
     aDEstado = "";
     aHEstado = "";
     aAlfa = "";
     aTemporada = "";
     i = 0;
     fDFecha = @;
     fHFecha = @;
     fFecha = @;
|FIN;

|PROCESO BtnPax;
     |VENTANA 1035, 1665, -1, 17, "Cambio Pax Servicio";
     |HAZ PushVenModal;
     |PINPA #0#142;
     |PINDA #0#142;
     |ENDATOS #1#142;
     |SI FSalida = 0;
          #9#4 = #9#4 - #10#8;
          #10#8 = #142#0;
          #10#11 = #10#8 + #10#9 - #10#10;
          #9#4 = #9#4 + #10#8;
          #9#7 = #9#4 + #9#5 - #9#6;
          |GRABA 020#9a;
          |GRABA 020#10a;

          |ABRE #26;
          #26#0 = #10#17;
          #26#2 = #10#0;
          #26#4 = #10#2;
          #26#5 = #10#4;
          #26#7 = #10#18;
          |LEE 121#26=;
          |SI FSalida = 0;
               #26#20 = #142#0;
               |GRABA 020#26a;
          |FINSI;
          |CIERRA #26;

          |REFRESCACONTROL nGrid9;
          |REFRESCACONTROL nGrid10;
     |FINSI;
     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnCancela;
     |ABRE #26;
     #26#0 = #10#17;
     #26#2 = #10#0;
     #26#4 = #10#2;
     #26#5 = #10#4;
     #26#7 = #10#18;
     |LEE 121#26=;
     |SI FSalida = 0;
          |SI #26#24 = "S";
               |CONFI "0000S¨Desea volver a abrirlo?";
               |SI FSalida = 0;
                    #26#24 = "A";
               |FINSI;
          |SINO;
               |CONFI "0000S¨Cancelar el servicio?";
               |SI FSalida = 0;
                    #26#24 = "S";
               |FINSI;
          |FINSI;
          |GRABA 020#26a;

          #10#7 = #26#24;
          |GRABA 020#10a;
          |LEE 000#10s;
          |REFRESCACONTROL nGrid10;
     |FINSI;
     |CIERRA #26;
|FPRC;

|PROCESO Masivo;
     |SI #10#7 ! "S";
          #10#7 = #141#2;
          |GRABA 020#10a;

          #26#0 = #10#17;
          #26#2 = #10#0;
          #26#4 = #10#2;
          #26#5 = #10#4;
          #26#7 = #10#18;
          |LEE 121#26=;
          |SI FSalida = 0;
               #26#24 = #141#2;
               |GRABA 020#26a;
               |LIBERA #26;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Masivo;
     #10#1;
     ;
     "          ", "01.01.0000", 000, " ", #141#0, 000000;
     "zzzzzzzzzz", "31.12.9999", 999, "z", #141#0, 999999;
     be;
     NULL, Masivo;
|FIN;

|PROCESO BtnMasivo;
     |VENTANA 1020, 1880, -1, 17, "Cambio Pax (Total Servicio)";
     |HAZ PushVenModal;
     |PINPA #0#141;
     |PINDA #0#141;
     |ENDATOS #1#141;
     |SI FSalida = 0;
          |ABRE #26;
          |BUCLE Masivo;
          |CIERRA #26;
          |REFRESCACONTROL nGrid10;
     |FINSI;
     |HAZ PopVenModal;
|FPRC;

|PROCESO BtnAbreCierra;
     |SI #10#7 = "S";
          |MENAV "0000El servicio esta suspendido...";
     |SINO;
          |ABRE #26;
          #26#0 = #10#17;
          #26#2 = #10#0;
          #26#4 = #10#2;
          #26#5 = #10#4;
          #26#7 = #10#18;
          |LEE 121#26=;
          |SI FSalida = 0;
               |SI #26#24 = "A";
                    #26#24 = "C";
               |SINO;
                    #26#24 = "A";
               |FINSI;
               |GRABA 020#26a;
          |FINSI;
          |CIERRA #26;
          #10#7 = #26#24;
          |GRABA 020#10a;
          |LEE 000#10s;
          |REFRESCACONTROL nGrid10;
     |FINSI;
|FPRC;

|PROCESO TieneLineas;
     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrw010";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |NOME_DAT #referen@#aTmp10#;
          |ABRE #referen@;
          |SELECT #2#referen@;
          #referen@#17 = #9#14;
          #referen@#18 = #9#15;
          #referen@#0 = #9#0;
          #referen@#2 = #9#2;
          #referen@#3 = #9#3
          #referen@#7 = aDEstado;
          #referen@#4 = 000000;
          |LEE 000#referen@.];
          |SI FSalida = 0;
                    |Y #referen@#17 = #9#14;
                    |Y #referen@#18 = #9#15;
                    |Y #referen@#0 = #9#0;
                    |Y #referen@#2 = #9#2;
                    |Y #referen@#3 = #9#3
                    |Y #referen@#7 ] aDEstado; |Y #referen@#7 [ aHEstado;
               |ESTADO_CONTROL nBtnAbreCierra, "ENABLE";
               |ESTADO_CONTROL nBtnMasivo, "ENABLE";
               |ESTADO_CONTROL nBtnPax, "ENABLE";
               |ESTADO_CONTROL nBtnCancela, "ENABLE";
          |SINO;
               |ESTADO_CONTROL nBtnAbreCierra, "DISABLE";
               |ESTADO_CONTROL nBtnMasivo, "DISABLE";
               |ESTADO_CONTROL nBtnPax, "DISABLE";
               |ESTADO_CONTROL nBtnCancela, "DISABLE";
          |FINSI;
          |CIERRA #referen@;
          |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO BtnAnulaSi;
     |ESTADO_CONTROL nBtnAnulaNo, "SHOW";
     |ESTADO_CONTROL nBtnAnulaSi, "HIDE";
     aDEstado = " ";
     aHEstado = "z";
     |HAZ TieneLineas;
     |REFRESCACONTROL nGrid10;
|FPRC;

|PROCESO BtnAnulaNo;
     |ESTADO_CONTROL nBtnAnulaNo, "HIDE";
     |ESTADO_CONTROL nBtnAnulaSi, "SHOW";
     aDEstado = "S";
     aHEstado = "S";
     |HAZ TieneLineas;
     |REFRESCACONTROL nGrid10;
|FPRC;

|PROCESO TraficoDiario;
     |VENTANA 901, 2899, -1, 17, "Consulta Fecha Viaje";
     |HAZ PushVenModal;

     |ABRE #26;
     #26#0 = #10#17;
     #26#2 = #10#0;
     #26#4 = #10#2;
     #26#5 = #10#4;
     #26#7 = #10#18;
     |LEE 020#26=;
     |CIERRA #26;

     |PARA i = 0; |SI i [ 38; |HACIENDO i = i + 1;
          #114i = #26i;
     |SIGUE;
     |SI #114#4 = "I";
          #114#39 = "IDA";
     |SINO;
          #114#39 = "VUELTA";
     |FINSI;
     |PINPA #0#114;
     |PINDA #0#114;
     |PAUSA;

     |HAZ PopVenModal;
|FPRC;

|PROCESO Evt9;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#9;
          |LEE 000#9=;
          |REFRESCACONTROL nGrid10;
     |FINSI;
|FPRC;

|PROCESO Evt10;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #2#10;
          |LEE 000#10=;
     |FINSI;
     |SI FSalida = 4;
          |HAZ TraficoDiario;
     |FINSI;
|FPRC;

|PROCESO Min10;
     #10#17 = #9#14;
     #10#18 = #9#15;
     #10#0 = #9#0;
     #10#2 = #9#2;
     #10#3 = #9#3;
     #10#7 = aDEstado;
     #10#4 = 000000;
|FPRC;

|PROCESO Max10;
     #10#17 = #9#14;
     #10#18 = #9#15;
     #10#0 = #9#0;
     #10#2 = #9#2;
     #10#3 = #9#3;
     #10#7 = aHEstado;
     #10#4 = 999999;
|FPRC;

|PROCESO Transito;
     #9#8 = #9#8 + #referen@#20;
     #9#9 = #9#9 + #referen@#21;
     #9#10 = #9#10 + #referen@#26;
     #9#11 = #9#8 + #9#9 - #9#10;

     #10#13 = #10#13 + #referen@#20;
     #10#14 = #10#14 + #referen@#21;
     #10#15 = #10#15 + #referen@#26;
     #10#16 = #10#13 + #10#14 - #10#15;
|FPRC;

|DEFBUCLE Transito;
     #referen@#1005;
     13, 15;
     aTemporada, #0#2, #0#4, 000000, fDFecha, #23#9, #25#5;
     aTemporada, #0#3, #0#4, 999999, fHFecha, #23#9, #25#5;
     ;
     NULL, Transito;
|FIN;

|PROCESO PobTransito;
     |BUCLE Transito;
|FPRC;

|DEFBUCLE PobTransito;
     #25#1;
     ;
     #23#0, #23#2, #23#4, #23#5, 000;
     #23#0, #23#2, #23#4, #23#5, 999;
     ;
     NULL, PobTransito;
|FIN;

|PROCESO sctrm026;
     |SI #0#0 = "L";
          fFecha = #26#7 + #26#19;
          |SI fFecha ! #0#1; |ACABA; |FINSI;
     |FINSI;

     |DDEFECTO #9;
     #9#14 = #26#0;
     #9#0 = #26#2;
     #9#2 = #26#4;
     #9#3 = #26#15;
     #9#15 = #26#7;
     |LEE 101#9=;
     |SI FSalida ! 0; |GRABA 020#9b; |FINSI;
     #9#1 = #26#3;
     #9#4 = #9#4 + #26#20;
     #9#5 = #9#5 + #26#21;
     #9#6 = #9#6 + #26#26;
     #9#7 = #9#4 + #9#5 - #9#6;
     |SI #0#0 = "L";
          #9#12 = #26#7 + #26#19;
          #9#13 = #26#18;
     |SINO;
          #9#12 = #26#7;
          #9#13 = #26#17;
     |FINSI;

     |DDEFECTO #10;
     #10#17 = #26#0;
     #10#0 = #26#2;
     #10#2 = #26#4;
     #10#3 = #26#15;
     #10#4 = #26#5;
     #10#18 = #26#7;
     |LEE 101#10=;
     |SI FSalida ! 0; |GRABA 020#10b; |FINSI;
     #10#1 = #26#3;
     #10#5 = #26#13;
     #10#6 = #26#15;
     #10#7 = #26#24;              ||Estado
     #10#8 = #10#8 + #26#20;
     #10#9 = #10#9 + #26#21;
     #10#10 = #10#10 + #26#26;
     #10#11 = #10#8 + #10#9 - #10#10;
     #10#12 = #10#12 + #26#38;

     #23#0 = #26#0;
     #23#2 = #26#2;
     #23#4 = #26#4;
     #23#5 = #26#5;
     |LEE 000#23=;
     |SI FSalida = 0;
          |BUCLE PobTransito;
     |FINSI;

     |GRABA 020#9a;
     |LIBERA #9;
     |GRABA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE sctrm026;
     #26#1;
     15;
     aTemporada, #0#2, #0#4, 000000, fDFecha, #0#5;
     aTemporada, #0#3, #0#4, 999999, fHFecha, #0#6;
     ;
     NULL, sctrm026;
|FIN;

|PROCESO BuscaTempo;
     |SI #0#1 ] #8#2; |Y #0#1 [ #8#3;
          aTemporada = #8#0;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaTempo;
     #8#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, BuscaTempo;
|FIN;

|PROCESO T3; |TIPO 3;
     |HAZ CreaTempo; aTmp9 = Tempo; |DELINDEX #9; |NOME_DAT #9 Tempo; |ABRE #9;
     |HAZ CreaTempo; aTmp10 = Tempo; |DELINDEX #10; |NOME_DAT #10 Tempo; |ABRE #10;

     |BUCLE BuscaTempo;
     |SI #0#0 = "L";
          fDFecha = "01.01.0000";
          fHFecha = "31.12.9999";
     |SINO;
          fDFecha = #0#1;
          fHFecha = #0#1;
     |FINSI;

     |DDEF aAlfa;
     aAlfa = aAlfa + "sctrm026";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #23;
          |ABRE #referen@
          |BUCLE sctrm026;
          |CIERRA #referen@;
          |CIERRA #23;
          |DESCARGA_DEF #referen@;
     |FINSI;

     |VENTANA 0501, 2899, -1, 17, "Tratamiento Cupos Servicio por Fecha";
     |HAZ PushVenModal;

     |CONTROL_SIMPLE 0, "BOTON,{{137}}Abierto/Cerrado", 1602, 1617, BtnAbreCierra;
     nBtnAbreCierra = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{137}}Masivo", 1619, 1629, BtnMasivo;
     nBtnMasivo = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{137}}Pax", 1631, 1641, BtnPax;
     nBtnPax = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{137}}Anulado", 1643, 1655, BtnAnulaNo;
     nBtnAnulaNo = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{137}}Todos", 1643, 1655, BtnAnulaSi;
     nBtnAnulaSi = FSalida;
     |CONTROL_SIMPLE 0, "BOTON,{{137}}Cancelar", 1657, 1667, BtnCancela;
     nBtnCancela = FSalida;
     |ESTADO_CONTROL nBtnAnulaSi, "HIDE";
     |CONTROL_SIMPLE 0, "LABEL,{{003}}(Doble click consulta tr fico diario)", 1670, 1697, NULL;

     aDEstado = " "; aHEstado = "z";
     |SI #0#7 = "S";
          |HAZ BtnAnulaNo;
     |FINSI;
     |LEE 000#9p;
     |HAZ TieneLineas;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#9, nRango, 0602, 1598, NULL, NULL, Evt9;
     nGrid9 = FSalida;
     |LINEAL_SIMPLE #2#10, nRango, 1702, 2698, Min10, Max10, Evt10;
     nGrid10 = FSalida;
     enCtrFin = FSalida;
     |HAZ EsperaFin;
     |HAZ PopVenModal;

     |DELINDEX #10; |CIERRA #10; Tempo = aTmp10; |HAZ BoraTempo;
     |DELINDEX #9; |CIERRA #9; Tempo = aTmp9; |HAZ BoraTempo;
|FPRC;

|PROCESO LogoPanta;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;

     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |HAZ LogoPanta;
     |ENDATOS #1#0;
|FPRO;
