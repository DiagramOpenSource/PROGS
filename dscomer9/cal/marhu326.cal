|FICHEROS;
     marhu325 #3;
     marhu326 #0;
     agifa019 #1;
     agifa017 #2;
     agifa065 #9;
     agifa142 #11;
     dsm00055 #55;
     marhu323 #323;
     marhu324 #324;
     marhu327 #327;
     dsm00043 #43;
     dsm00044 #44;

     marhu325 #325;
     marhu334 #334;
     marhu335 #335;
     marhu337 #337,MANTE;
|FIN;

|CAMPOS;
     #1#15  art_pser; #2#42  alm_pser;
     #1#16  art_prec; #2#43  alm_prec;
     #1#17  art_pval; #2#4   alm_pval;
     #1#11  art_nece;
     #1#12  art_rese; #2#8   alm_rese;
     #1#14  art_depo; #2#10  alm_depo;
     #1#13  art_fabr; #2#9   alm_fabr;
     #1#10  art_vsto; #2#3   alm_vsto;
     #1#7   art_mini; #2#6   alm_mini;
     #1#8   art_maxi; #2#7   alm_maxi;
     #1#6   art_tota; #2#5   alm_tota;
     #1#104 art_disp; #2#39  alm_disp;
     #1#9   art_pcm;
|FIN;

|VARIABLES;
     &Tempo    = "";
     aTempo337 = "";
     aCompleto = "";
     i         = 0;
     &r_arti   = "";
     aAlfa     = "";
     nNume     = 0;
     nSwAct    = 0;
     nModo     = 0;
     nLin      = 0;
     nSw       = 0;
     nEmpre    = 0;
     nPen      = 0;
     nLine     = 0;
     fiac      = "  ";
     guarda    = "  ";
     relleno   = "                                       ";
     aponer    = "  ";
|FIN;

|INCLUYE i_varart;

|PROCESO Ultima44;
     #44#18 = #43#0;
     #44#8 = 999;
     |LEE 000#44];
     |SI FSalida = 0;
          |LEE 000#44a;
     |SINO;
          |LEE 000#44u;
     |FINSI;
     |SI FSalida = 0; |Y #44#18 = #43#0;
          nLin = #44#8 + 1;
     |SINO;
          nLin = 1;
     |FINSI;
|FPRC;

|PROCESO marhu327;
     #44#18 = #3#2;
     #44#8 = #327#2;
     |LEE 121#44=;
     |SI FSalida = 0;
          enCodigo = #44#18;
          |HAZ AcumulaES_SS;
          |BORRA 020#44a;
     |FINSI;
     |BORRA 020#327a;
|FPRC;

|DEFBUCLE marhu327;
     #327#1;
     ;
     #0#15, #0#11, 001;
     #0#15, #0#11, 999;
     ;
     NULL, marhu327;
|FIN;

|PROCESO marhu324;
     |DDEFECTO #44;
     nLin = nLin + 1;
     #44#18 = #43#0;
     #44#8 = nLin;
     #44#7 = "E";
     #44#0 = #324#2;
     #44#1 = #0#5;
     #44#2 = #324#3;
     #44#4 = #0#4 * #324#4;
     |GRABA 020#44n;
     enCodigo = #44#18;
     |HAZ AcumulaES_SS;

     #327#0 = #0#15;
     #327#1 = #0#11;
     #327#2 = nLin;
     |GRABA 020#327n;
|FPRC;

|DEFBUCLE marhu324;
     #324#1;
     ;
     #0#0, 001;
     #0#0, 999;
     ;
     NULL, marhu324;
|FIN;

|PROCESO Regulariza;
     |ABRE #327;

     |SI #3#2 = 0;
          |ABRE #43; |LEE 000#43u; |CIERRA #43;
          #3#2 = #43#0 + 1;
     |FINSI;

     |ABRE #43;
     |DDEFECTO #43;
     #43#0 = #3#2;
     |LEE 101#43=;
     |SI FSalida ! 0; |GRABA 020#43b; |FINSI;
     #43#1 = #3#1;
     |GRABA 020#43a;
     |CIERRA #43;

     |ABRE #44;
     |SI enForma = 1;
          |HAZ Ultima44;
          |DDEFECTO #44;
          nLin = nLin + 1;
          #44#18 = #43#0;
          #44#8 = nLin;
          #44#7 = "S";        ||Entrada/Salida
          #44#0 = #0#0;       ||Arti
          #44#1 = #0#5;       ||AE
          #44#2 = #0#2;       ||Descrip
          #44#4 = #0#4;       ||Uni
          |GRABA 020#44n;
          enCodigo = #44#18;
          |HAZ AcumulaES_SS;

          #327#0 = #0#15;
          #327#1 = #0#11;
          #327#2 = nLin;
          |GRABA 020#327n;

          |BUCLE marhu324;
     |SINO;
          |BUCLE marhu327;
     |FINSI;

     |CIERRA #44;

     |CIERRA #327;
|FPRC;

|PROCESO CopiaLineas;
     |ABRE #55;
     |SI enForma = 1;
          |DDEFECTO #55;
          |PARA i = 0; |SI i [ 14; |HACIENDO i = i + 1;
               #55i = #0i;
          |SIGUE;
          #55#27 = #0#15;
          |GRABA 020#55n;
     |SINO;
          #55#27 = #0#15;
          #55#11 = #0#11;
          |LEE 121#55=;
          |SI FSalida = 0;
               |BORRA 020#55a;
          |FINSI;
     |FINSI;
     |CIERRA #55;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     enCodigo = #0#15;
     enForma = 0 +. 1;
     |SI #0#16 = "S";
          |HAZ Regulariza;
     |FINSI;
     |HAZ CopiaLineas;
     enCodigo = #0#15;
     |HAZ AcumulaME_MS;
|FPRC;

|PROCESO decim;
     #0#4 = #0#4 ! #11#8;
     |PINTA #0#4;
|FPRC;

|PROCESO Relacion; |TIPO 6;
     |SI #0#16 = "N";
          |MODO_RELACION #0, 1, "marhu323", "N", "N";
     |SINO;
          |MODO_RELACION #0, 1, "marhu323", "S", "S";
     |FINSI;
|FPRC;

|PROCESO Consulta; |TIPO 6;
     |SI FSalida = 18;
          |ABRE #323;
          |LEE 000#323p;
          |CONSULTA_CLAVE #1#323;
          |SI FSalida = 0;
               #0Campo = #323#0;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #323;
     |FINSI;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO Completo;
     aCompleto = "C";
     #335#0 = #337#11;
     #335#1 = #337#0;
     #335#2 = 1;
     |LEE 000#335];
     |PARA; |SI FSalida = 0; |Y #335#0 = #337#11; |Y #335#1 = #337#0; |HACIENDO;
          |SI #335#8 > 0; aCompleto = "P"; |SAL; |FINSI;
          |LEE 000#335s;
     |SIGUE;

     #334#0 = #335#0;
     #334#1 = #335#1;
     |LEE 121#334=;
     |SI FSalida = 0;
          #334#5 = aCompleto;
          #334#8 = #3#1;
          |GRABA 020#334a;
          |LIBERA #334;
     |FINSI;
|FPRC;

|PROCESO marhu337;
     |SI #337#7 = 0; |ACABA; |FINSI;
     #335#0 = #337#11;
     #335#1 = #337#0;
     #335#2 = #337#8;
     |LEE 121#335=;
     |SI FSalida = 0;
          #335#7 = #335#7 + #337#7;
          #335#8 = #335#6 - #335#7;
          |GRABA 020#335a;
          |HAZ Completo;
          #0#11 = nLine; nLine = nLine + 1;
          #0#16 = #337#4; || Open
          #0#0 = #337#2; || Art
          #0#2 = #337#3; || Des
          #0#1 = #337#9; || Al S
          #0#5 = #337#10;|| Al E
          #0#4 = #337#7; || Uni
          #0#8 = #325#1;
          |GRABA 020#0n;
          |HAZ Tipo2;
     |FINSI;
|FPRC;

|DEFBUCLE marhu337;
     #337#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, marhu337;
|FIN;

|PROCESO marhu335;
     |SI #334#5 = "C"; |ACABA; |FINSI;
     nPen = #335#6 - #335#7;
     |SI nPen = 0; |ACABA; |FINSI;

     |DDEFECTO #337;
     #337#11 = #335#0;
     #337#0 = #335#1;
     #337#8 = #335#2;

     #337#1 = #334#2;
     #337#2 = #335#3;
     #337#3 = #335#4;
     #337#4 = #335#5;
     #337#5 = #335#6; ||Pedi
     #337#6 = #335#7; ||Ser.
     #337#7 = 0;
     #337#10 = #334#7;
     |GRABA 020#337n;
|FPRC;

|DEFBUCLE marhu334;
     #334#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, NULL, marhu335;
|FIN;

|PROCESO Sirve; |TIPO 11;
     |SI FSalida = 10;
          nSw = 1;
       |ET Otra;
          |ENCAMPO #7#337;
          |ENCAMPO #9#337;
          nPen = #337#5 - #337#6;
          |SI nPen <  #337#7;
               |MENAV "0000Unidades incorrectas....";
               |VETE Otra;
          |FINSI;
          |GRABA 020#337a;
          |PTEC 802;
     |FINSI;
|FPRC;

|PROCESO Inf;
     #337#0 = 1;
     #337#8 = 1;
|FPRC;

|PROCESO Sup;
     #337#0 = 999999;
     #337#8 = 99;
|FPRC;

|PROCESO poncontr;
     fiac = Control % A109;
     fiac = fiac + relleno;
     guarda = fiac % A109;
     fiac = Control % A1001;
     Control = Control + fiac;
     Control = Control + relleno;
     Control = Control % A120;
     Control = Control + aponer;
|FPRC;

|PROCESO Reposicion; |TIPO 11;
     nModo = (FEntrada / 100) ! 0;
     |SI FSalida ! 10; |O nModo ! 1; |ACABA; |FINSI;
     |HAZ CreaTempo; aTempo337 = Tempo;
     |NOME_DAT #337 aTempo337; |DELINDEX #337;
     |ABRE #337;
     |BUCLE marhu334;
     |CIERRA #337;
     nSw = 0;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#337, -1, 4, 20, 1, Inf, Sup;
     |POPV;
     |SI nSw ! 0;
          nLine = #0#11;
          aponer = Asino;
          |HAZ poncontr;
          |ABRE #334;
          |ABRE #335;
          |BUCLE marhu337;
          |CIERRA #334;
          |CIERRA #335;
          aponer = Anosi;
          |HAZ poncontr;
          |PTEC 815;
     |SINO;
          |ERROR;
     |FINSI;
     |DELINDEX #337; Tempo = aTempo337; |HAZ BoraTempo;
|FPRC;
