|FICHEROS;
     godiasig #0;
     godiacaj #1;
     godiacal #2;
     gopartia #10;
     gomantl1 #16;
     goparame #100;
|FIN;

|VARIABLES;
     &eaSerPre = "";
     &enNumPre = 0;
     &eaCapi   = "";
     &eaParti  = "";
     &eaDesPa  = "";
     &eaDesCa  = "";
     nConta = 0;
     aAlfa = "";
     nHay = 0;
     nModo = 0;
|FIN;

|PROCESO ActGopartia;
     |DDEFECTO #10;
     #10#34 = "C";
     #10#4  = #godiacal#19;
     #10#5  = #godiacal#20;
     #10#6  = #godiacal#21;
     #10#7  = 1;
     |LEE 101#10=;
     |SI FSalida = 0;
          #10#2  = #godiacal#5;
          #10#3  = #godiacal#6;
          #10#0  = #godiacal#7;
          #10#1  = #godiacal#8;
          #10#33 = #godiacal#9;
          #10#8  = #godiacal#10;
          #10#9  = #godiacal#14;
          |GRABA 020#10a;
          |LIBERA #10;
     |FINSI;
|FPRC;

|PROCESO Tmp;
     aAlfa = #0#11 + #0#12; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;

     |DDEFECTO #2;
     #2#0 = #0#15;
     #2#15 = #0#16;
     #2#1 = #0#17;
     #2#2 = #0#18;
     |LEE 121#2=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |DDEFECTO #1;
     #1#0 = #2#0;
     #1#2 = #2#15;
     #1#1 = #2#1;
     |LEE 020#1=;

     #2#5 = #0#1
     #2#6 = #0#2;
     #2#7 = #0#3;
     #2#8 = #0#4;
     #2#9 = #0#11;
     #2#10 = #0#12;
     #2#13 = #0#13;
     #2#14 = #0#14;
     |GRABA 020#2a;
     |LIBERA #2;
     nConta = nConta + 1;
     |HAZ ActGopartia;
|FPRC;

|DEFBUCLE Tmp;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO MinPresu;
     #16#0 = #0#1;                                 ||Expediente.
     #16#1 = #0#2;                                 ||Numero Expediente.
     #16#2 = 1;                                    ||Linea.
|FPRC;

|PROCESO MaxPresu;
     #16#0 = #0#1;                                 ||Expediente.
     #16#1 = #0#2;                                 ||Numero Expediente.
     #16#2 = 999;                                  ||Linea.
|FPRC;

|PROCESO gomantl1;
     |SI #0#3 = #16#3; |Y #0#4 = #16#4;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE gomantl1;
     #16#1;
     ;
     #0#1, #0#2, 001;
     #0#1, #0#2, 999;
     ;
     NULL, gomantl1;
|FIN;

|PROCESO CheqPres; |TIPO 6;
     |SI FSalida = 10;
          |ABRE #16;
          |LEE 000#16p;
          |CONSULTA_F_CLAVE #1#16, MinPresu, MaxPresu;
          |SI FSalida ! 0;
               |ERROR; |ACABA;
          |SINO;
               #0#3 = #16#3; |PINTA #0#3;
               #0#4 = #16#4; |PINTA #0#4;
          |FINSI;
          |CIERRA #16;
     |FINSI;
     nHay = 0;
     |BUCLE gomantl1;
     |SI nHay = 0; |Y Campo = 4;
          |MENAV "0000No existe Presupuesto en el Expediente...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO CheqCap; |TIPO 6;
     eaSerPre = #0#3;
     enNumPre = #0#4;
     eaCapi   = #0#11;
     eaParti  = #0#12;
     |HAZ GuerPartid;
     |SI eaParti = "";
          |ERROR;
     |SINO;
          #0#11 = eaCapi; |PINTA #0#11;
          #0#13 = eaDesCa; |PINTA #0#13;
          #0#12 = eaParti; |PINTA #0#12;
          #0#14 = eaDesPa; |PINTA #0#14;
     |FINSI;
|FPRC;

|PROCESO NoAlta;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO godiacal;
     aAlfa = #2#9 + #2#10; |QBF aAlfa;
     |SI aAlfa ! ""; |ACABA; |FINSI;

     |DDEFECTO #1;
     #1#0 = #2#0;
     #1#2 = #2#15;
     #1#1 = #2#1;
     |LEE 020#1=;

     nHay = nHay + 1;
     #0#0 = nHay;
     #0#1 = #2#5;
     #0#2 = #2#6;
     #0#3 = #2#7;
     #0#4 = #2#8;
     #0#5 = #1#32;
     #0#6 = #1#33;
     #0#7 = #1#4;
     #0#8 = #1#37;
     #0#9 = #1#6;
     #0#10 = #1#7;
     #0#15 = #2#0;
     #0#16 = #2#15;
     #0#17 = #2#1;
     #0#18 = #2#2;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE godiacal;
     #2#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, godiacal;
|FIN;

|PROCESO Min;
     #0#0 = 1;
|FPRC;

|PROCESO Max;
     #0#0 = 99999999;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |CONSULTA_CLAVE #1#0;
     |SI FSalida = 0;
          |PTEC 802;
     |FINSI;
     |ERROR;
|FPRC;

|PROGRAMA;
     aAlfa = Usuario;
     |NOME_DAT #0 aAlfa; |DELINDEX #0;

     |CLS;
     |PINPA #0#0;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |SI #100#141 = "O";
          |PINTA 817, "O.T........:";
          |PINTA 917, "O.E........:";
     |FINSI;
     |ENTLINEAL #1#0, 1, 7, 22, 0, Min, Max;

     |MENSA "0000Cargando...";
     |ABRE #0;
     |ABRE #1;
     |BUCLE godiacal;
     |CIERRA #1;
     |CIERRA #0;
     |MENSA "0000...";

     |SI nHay = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |ENTLINEAL #1#0, 1, 2, 22, 0, Min, Max;
          |CONFI "0000NActualizar Control Caja";
          |SI FSalida = 0;
               |ABRE #1;
               |ABRE #2;
               |ABRE #10;
               |BUCLE Tmp;
               |CIERRA #10;
               |CIERRA #2;
               |CIERRA #1;
               aAlfa = "0000Registroa actualizados:" + nConta;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |DELINDEX #0;
|FPRO;
