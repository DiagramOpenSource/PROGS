|FICHEROS;
     agifa165 #1;
     agifa134 #0;        ||Fichero de facturas
     agifa084 #2;        ||Fichero de facturas directas
     agifa024 #6;
     agifa321 #321;
     agifa324 #324;
|FIN;


|VARIABLES;
     &nDeci_Base = 0;
     &nDeci_PreBase = 0;
|FIN;

|PROCESO LeeDecimBase;
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 001#agifa321.p;
     #agifa324#0 = #agifa321#9; ||Igualo a moneda base
     |LEE 001#agifa324.=;
     nDeci_Base = #agifa324#7;  ||Decimales moneda base
     nDeci_PreBase = #agifa324#9;  ||Decimales precio de moneda base
     |CIERRA #agifa321;
     |CIERRA #agifa324;
|FPRC;

|PROCESO cabfact;
     |DDEFECTO #6;
     #6#0 = #0#2;
     |LEE 001#6=;

     |HAZ VenciVta;
|FPRC;

|DEFBUCLE factu;
     #0#1;
     45;
     #1#0 , #1#2 , #1#5;
     #1#1 , #1#3 , #1#5;
     e;
     NULL , cabfact;
|FIN;

|PROCESO cabfactd;
     |DDEFECTO #6;
     #6#0 = #1#3;
     |LEE 001#6=;

     |HAZ VenciDir;
|FPRC;

|DEFBUCLE factuD;
     #2#1;
     10;
     #1#0 , #1#2 , #1#5;
     #1#1 , #1#3 , #1#5;
     e;
     NULL , cabfactd;
|FIN;

|PROCESO inicio; |TIPO 3;
     |SI #1#4 ! "SI"; |ACABA; |FINSI;

     |HAZ LeeDecimBase;

     |ABRE #6;
     |BUCLE factu;
     |BUCLE factuD;
     |CIERRA #6;
|FPRC;
