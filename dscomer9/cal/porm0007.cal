|FICHEROS;
     porm0007 #0;

     porm0008 #8,MANTE;   || detalle de ventas, donde tenemos que guardar
                          || la info

     agifa059 #59;  || lineas de factura
     agifa071 #71;  || lineas de albaran
     agifa010 #10;  || cabecera de albaran, solo para leer la fecha

|FIN;

|PROCESO PCrearFicheroVentas;
     |ABRE #10;      || para leer la fecha del albaran
     #10#52=#71#29;
     #10#0=#71#0;
     |LEE 000#10=;
     |CIERRA #10;

     |DDEFECTO #8;

     #8#0=#59#14;  || serie factura
     #8#1=#59#0;   || numero factura
     #8#2=#59#1;   || linea factura
     #8#3=#71#29;  || serie albaran
     #8#4=#71#0;   || numero albaran
     #8#5=#71#1;   || linea albaran
     #8#6=#71#2;   || codigo articulo
     #8#7=#71#4;   || descripcion articulo
     #8#8=#71#5;   || unidades
     #8#9=#71#6;   || precio
     #8#10=#71#7;  || importe
     #8#11=#10#1;  || fecha
     #8#12=#71#8;  || descuento

     |GRABA 020#8n;
|FPRC;

|DEFBUCLE BLineasAlbaran;
     #71#1;
     ;
     #59#15,#59#2,001;
     #59#15,#59#2,999;
     ;
     NULL,PCrearFicheroVentas;
|FIN;


|PROCESO PBuscaAlbaranes;
     |BUCLE BLineasAlbaran;
|FPRC;


|DEFBUCLE BLineasFactura;
     #59#1;
     ;
     #0#0,#0#1,001;
     #0#0,#0#1,999;
     ;
     NULL,PBuscaAlbaranes;
|FIN;


|PROCESO Ventas;|TIPO 0;
     |SI FSalida=0;
          |DELINDEX #8;
          |ABRE #8;
          |BUCLE BLineasFactura;
          |CONSULTA_CLAVE #1#8;
          |CIERRA #8;
          |DELINDEX #8;
          |ERROR;
     |FINSI;
|FPRC;
