|FICHEROS;
     dsecap09 #0;
     dsecap10 #1,MANTE;
     dsecap11 #2,MANTE;
     agifa019 #19;
     agifa024 #24;
     agifa025 #25;
     agifa084 #84;
     agifa069 #69;
     agifa321 #321;
     agifa324 #324;
     dsecaz03 #103,MANTE;
|FIN;

|VARIABLES;
     &enTotaFac = 0;
     &enSwMenu = 0;
     &enCoste = 0;
     nUni = 0;
     nDto = 0;
     nPrecio = 0;
     nPreDivide = 0;
     nSwDivide = 0;
     aSerie = "";
     i = 0;
     ii = 0;
|FIN;

|PROCESO SacaUni;
     nUni = nUni + 1;
|FPRC;

|DEFBUCLE SacaUni;
     #2#1;
     ;
     #1#0, #1#1, #1#2, 000000;
     #1#0, #1#1, #1#2, 999999;
     ;
     NULL, SacaUni;
|FIN;

|PROCESO CreaFac;
     |ABRE #321; |LEE 000#321p; |CIERRA #321;
     |DDEFECTO #24;
     |ABRE #24;
     #24#0 = #1#2;
     |LEE 020#24=
     |CIERRA #24;
     |DDEFECTO #25;
     |ABRE #25;
     #25#0 = #24#25;
     |LEE 020#25=
     |CIERRA #25;

     |ABRE #84;
     |ABRE #69;

     #84#48 = aSerie;
     enSwMenu = 1;
     |HAZ ContaFD7;
     |GRABA 020#84b;
     #84#1 = ~;
     #84#3 = #24#0;
     #84#4 = #24#1;
     #84#5 = #24#37;
     #84#6 = #24#25;
     #84#7 = #24#38;
     #84#8 = #24#20;
     #84#9 = #24#38;

     #84#29 = #24#1;
     #84#30 = #24#8;
     #84#31 = #24#9;
     #84#33 = #24#10;
     #84#60 = #24#15;

     #84#32 = #24#156;
     #84#34 = #25#7;
     #84#35 = #24#4;
     #84#36 = #24#47;
     #84#40 = #24#16;
     #84#64 = #24#183;
     #84#65 = #24#192;

     |ABRE #324;
     #324#0 = #84#65;
     |LEE 000#324=;
     #84#66 = #324#2;
     #84#67 = #24#193;
     #84#68 = #321#9;
     #324#0 = #84#68;
     |LEE 000#324=;
     #84#69 = #324#2;
     |CIERRA #324;
     #84#88 = #24#23;
     #84#89 = #24#24;
     #84#90 = #24#25;
     #84#95 = #0#0 + "/" + (("000000" + #0#1) % -106);

     nUni = 0;
     |BUCLE SacaUni;

     |HAZ LimCabAgifa084;

     |ABRE #19;
     #19#0 = 1;
     |LEE 000#19=;
     |CIERRA #19;

     |DDEFECTO #69;
     #69#20 = #84#48;
     #69#0 = #84#0;
     #69#1 = 1;
     #69#2 = #19#0;
     #69#3 = 1;
     #69#4 = "COSTES DE IMPARTICION";
     |SI #24#39 = 1; nPrecio = #19#18; nDto = #19#21; |FINSI;
     |SI #24#39 = 2; nPrecio = #19#19; nDto = #19#22; |FINSI;
     |SI #24#39 = 3; nPrecio = #19#20; nDto = #19#24; |FINSI;
     |SI #24#39 = 4; nPrecio = #19#147; nDto = #19#150; |FINSI;
     |SI #24#39 = 5; nPrecio = #19#148; nDto = #19#151; |FINSI;
     |SI #24#39 = 6; nPrecio = #19#149; nDto = #19#152; |FINSI;
     |SI nSwDivide = 0;
          #69#5 = nUni;
          #69#6 = nPrecio;
     |SINO;
          #69#5 = 1
          #69#6 = nPreDivide;
     |FINSI;
     #69#8 = nDto;
     #69#11 = #19#30;
     #69#13 = #19#2;
     #69#15 = #84#3;
     #69#16 = #84#34;
     #69#17 = #84#35;
     #69#15 = #84#3;
     #69#26 = #69#6;
     |HAZ AcumulaFC;
     #69#14 = enCoste;
     |HAZ TotalLin69;
     |HAZ CalCabAgifa084;
     |GRABA 020#69n;

     |ABRE #19;
     #19#0 = 2;
     |LEE 000#19=;
     |CIERRA #19;

     |DDEFECTO #69;
     #69#20 = #84#48;
     #69#0 = #84#0;
     #69#1 = 2;
     #69#2 = #19#0;
     #69#3 = 1;
     #69#4 = "COSTES DE ORGANIZACION";
     |SI #24#39 = 1; nPrecio = #19#18; nDto = #19#21; |FINSI;
     |SI #24#39 = 2; nPrecio = #19#19; nDto = #19#22; |FINSI;
     |SI #24#39 = 3; nPrecio = #19#20; nDto = #19#24; |FINSI;
     |SI #24#39 = 4; nPrecio = #19#147; nDto = #19#150; |FINSI;
     |SI #24#39 = 5; nPrecio = #19#148; nDto = #19#151; |FINSI;
     |SI #24#39 = 6; nPrecio = #19#149; nDto = #19#152; |FINSI;
     |SI nSwDivide = 0;
          #69#5 = nUni;
          #69#6 = nPrecio;
          #69#8 = nDto;
     |FINSI;
     #69#11 = #19#30;
     #69#13 = #19#2;
     #69#15 = #84#3;
     #69#16 = #84#34;
     #69#17 = #84#35;
     #69#15 = #84#3;
     #69#26 = #69#6;
     |HAZ AcumulaFC;
     #69#14 = enCoste;
     |HAZ TotalLin69;
     |HAZ CalCabAgifa084;
     |GRABA 020#69n;

     |GRABA 020#84a;

     |CIERRA #69;
     |CIERRA #84;
|FPRC;

|PROCESO TotalFac;
     |DDEFECTO #24;
     |ABRE #24;
     #24#0 = #1#2;
     |LEE 020#24=
     |CIERRA #24;
     nUni = 0;
     |BUCLE SacaUni;
     |ABRE #19;
     #19#0 = 1;
     |LEE 000#19=;
     |CIERRA #19;
     |SI #24#39 = 1; nPrecio = #19#18; nDto = #19#21; |FINSI;
     |SI #24#39 = 2; nPrecio = #19#19; nDto = #19#22; |FINSI;
     |SI #24#39 = 3; nPrecio = #19#20; nDto = #19#24; |FINSI;
     |SI #24#39 = 4; nPrecio = #19#147; nDto = #19#150; |FINSI;
     |SI #24#39 = 5; nPrecio = #19#148; nDto = #19#151; |FINSI;
     |SI #24#39 = 6; nPrecio = #19#149; nDto = #19#152; |FINSI;
     enTotaFac = nUni * nPrecio;
     |ABRE #19;
     #19#0 = 2;
     |LEE 000#19=;
     |CIERRA #19;
     |SI #24#39 = 1; nPrecio = #19#18; nDto = #19#21; |FINSI;
     |SI #24#39 = 2; nPrecio = #19#19; nDto = #19#22; |FINSI;
     |SI #24#39 = 3; nPrecio = #19#20; nDto = #19#24; |FINSI;
     |SI #24#39 = 4; nPrecio = #19#147; nDto = #19#150; |FINSI;
     |SI #24#39 = 5; nPrecio = #19#148; nDto = #19#151; |FINSI;
     |SI #24#39 = 6; nPrecio = #19#149; nDto = #19#152; |FINSI;
     enTotaFac = enTotaFac + (nUni * nPrecio);
|FPRC;

|PROCESO Factura;
     aSerie = #0#0;
     |HAZ CreaFac;
|FPRC;

|PROCESO DivideFac;
     nSwDivide = 1;
     |PARA i = 0 ; |SI i [ 9; |HACIENDO i = i + 3;
          aSerie = #103i;
          ii = i + 2;
          nPreDivide = #103ii;
          |SI nPreDivide ! 0;
               |HAZ CreaFac;
               |SI i = 0; #1#5 = #84#48; #1#6 = #84#0; |FINSI;
               |SI i = 3; #1#8 = #84#48; #1#9 = #84#0; |FINSI;
               |SI i = 6; #1#10 = #84#48; #1#11 = #84#0; |FINSI;
               |SI i = 9; #1#12 = #84#48; #1#13 = #84#0; |FINSI;
          |FINSI;
     |SIGUE;
     nSwDivide = 0;
|FPRC;
