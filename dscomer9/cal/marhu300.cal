|FICHEROS;
     marhu300 #0;
|FIN;

|VARIABLES;
     YaNo   = "N";
     aCarpetaInicial = "";
     aCarpetaPase = "";
     aSalir = "N";
     aSistema = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aCarpetaUsr = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nCodigos = 1;
     nNombres = 1;
     aCodigo = "";
     aNombre = "";
     nPos   = 0;
     nPos2  = 0;
     nPos3  = 0;
     aPos   = "";
     aPos2  = "";
     aPos3  = "";
     aLetra = "";
     aLetra2= "";
     aLetras= "";
     aCarpeta = "";
     aFabre = "";
     aField = "";
     aFcanl = "";
     nCampo = 0;
     aCampo = "";
|FIN;


|RUTINA ProcesaLinea;
     nNume2 = &aField;
     |SI nNume2 = 13;         || final linea DOS
               #0#0 = aCodigo;
               #0#1 = aNombre;
               |LEE 000#0=;
               |SI FSalida = 0;
                  |GRABA 010#0a;
               |SINO;
                  |GRABA 010#0n;
               |FINSI;
               nCodigos = 1;
               aCodigo = "";
               nNombres = 1;
               aNombre = "";
               |XLEE nNume1,1,aField;
          |ACABA;
     |FINSI;

     |SI nNume2 = 10;         || final linea UNIX
               #0#0 = aCodigo;
               #0#1 = aNombre;
               |GRABA 010#0n;
               nCodigos = 1;
               aCodigo = "";
               nNombres = 1;
               aNombre = "";
          |ACABA;
     |FINSI;

     |SI nCodigos [ 3;
          aCodigo = aCodigo + aField;
          nCodigos = nCodigos +1;
     |SINO;
          |SI nNombres [ 10;
               aNombre = aNombre + aField;
               nNombres = nNombres +1;
          |FINSI;
     |FINSI;
|FRUT;

|PROCESO BuscaUsuarios;|TIPO 11;
     |SI FSalida = 13;
          |DBASS aCarpetaUsr;
          |QUE_SISTEMA aSistema;
          |SI aSistema = "ESDOS";
              aCarpetaUsr = aCarpetaUsr + "dev\usr\ds_sys.psw";
          |SINO;
              aCarpetaUsr = aCarpetaUsr + "dev/usr/ds_sys.psw";
          |FINSI;
          |XABRE "B",aCarpetaUsr,nNume1;
          |SI FSalida ] 0;
              |XLEE nNume1,1,aField;
              |PARA; |SI FSalida = 1; |HACIENDO;
                    |HAZ ProcesaLinea;
                    aField = aFcanl + " 1";
                    |XLEE nNume1,1,aField;
              |SIGUE;
              |XCIERRA nNume1;
          |FINSI;
     |SINO;
        aAlfa2 = FSalida;
          aAlfa1 = "0000" + aAlfa2;
          |MENSA aAlfa1;
     |FINSI;
     |SI FSalida = 1;
          aSalir = "S";
     |FINSI;
|FPRC;

|PROCESO CreaCarpetas;
     aCarpetaInicial = "";
     aCarpetaPase = "";
     YaNo = "N";
     |PARA nNume2 = 1;|SI nNume2 < 50;|HACIENDO nNume2 = nNume2 + 1;
          nPos = (nNume2 * 100) + 1;
          aPos = nPos;
          aAlfa1 = #0#2;
          |QBF aAlfa1;
          aLetra = aAlfa1 % aPos;
          aCarpetaInicial = aCarpetaInicial + aLetra;
          |SI aLetra = "/";|O aLetra = "\";
              nNume3 = nNume2+1;
              |PARA; |SI YaNo = "N"; |HACIENDO;
                  nPos = (nNume3 * 100) + 1;
                  aPos = nPos;
                  aAlfa1 = #0#2;
                  |QBF aAlfa1;
                  aLetra = aAlfa1 % aPos;
                  |SI aLetra = "/";|O aLetra = "\";
                       |MKDIR aCarpetaInicial;
                  |FINSI;
                  aCarpetaInicial = aCarpetaInicial + aLetra;
                  nNume3 = nNume3 + 1;
                  |SI aLetra = "";
                       |MKDIR aCarpetaInicial;
                       YaNo = "S";
                  |FINSI;
              |SIGUE;
              |SAL;
          |FINSI;
     |SIGUE;
     YaNo = "N";
     |PARA nNume2 = 1;|SI nNume2 < 50;|HACIENDO nNume2 = nNume2 + 1;
          nPos = (nNume2 * 100) + 1;
          aPos = nPos;
          aAlfa1 = #0#3;
          |QBF aAlfa1;
          aLetra = aAlfa1 % aPos;
          aCarpetaPase = aCarpetaPase + aLetra;
          |SI aLetra = "/";|O aLetra = "\";
              nNume3 = nNume2+1;
              |PARA; |SI YaNo = "N"; |HACIENDO;
                  nPos = (nNume3 * 100) + 1;
                  aPos = nPos;
                  aAlfa1 = #0#3;
                  |QBF aAlfa1;
                  aLetra = aAlfa1 % aPos;
                  |SI aLetra = "/";|O aLetra = "\";
                       |MKDIR aCarpetaPase;
                  |FINSI;
                  aCarpetaPase = aCarpetaPase + aLetra;
                  nNume3 = nNume3 + 1;
                  |SI aLetra = "";
                       |MKDIR aCarpetaPase;
                       YaNo = "S";
                  |FINSI;
              |SIGUE;
              |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Inferior;
     #0#0 = "   ";
|FPRC;

|PROCESO Superior;
     #0#0 = "999";
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Config. Pasarela";
     |ABRE #0;
     |PINPA #0#0;
     |PARA;|SI;|HACIENDO;
         |ENTLINEAL #1#0,1,1,21,0,Inferior,Superior;
         |SI aSalir = "S";
              |SAL;
         |FINSI;
     |SIGUE;
     |LEE 000#0p;
     |SI FSalida = 0;
       |PARA;|SI;|HACIENDO;
          |HAZ CreaCarpetas;
          |LEE 000#0s;
          |SI FSalida ! 0;
               |SAL;
          |FINSI;
       |SIGUE;
     |FINSI;
     |CIERRA #0;
|FPRO;
