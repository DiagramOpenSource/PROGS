|FICHEROS;
     go000003 #0;
     go000004 #4;
     go000005 #5;
     agifa019 #19;
     agifa077 #77; || Cab Alb
     agifa080 #80; || Lin Alb
     goparame #100;
|FIN;

|VARIABLES;
     fIni = @;
     nPrime = 0;
|FIN;

|PROCESO AlbCom;
     |SI #80#3 ! #0#2;
          |ACABA;
     |FINSI;

     |DDEFECTO #19;
     #19#0 = #80#2;
     |LEE 000#19=;

     |SI #0#1 = "S";
          |SI #19#126 ! #100#6; |ACABA; |FINSI;
     |FINSI;

     |SI nPrime = 0;
          nPrime = 1;
          |DDEFECTO #4;
          #4#0 = #0#3;
          #4#1 = "N";
          #4#2 = #0#0;
          #4#3 = #0#1;
          #4#4 = #0#2;
          #4#10 = fIni;
          |GRABA 020#4n;
     |FINSI;

     |DDEFECTO #5;
     #5#0 = #0#3;
     #5#1 = #80#2;
     #5#3 = #80#3;
     |LEE 101#5=;
     |SI FSalida ! 0; |GRABA 020#5b; |FINSI;
     #5#2 = #19#1;
     #5#4 = #5#4 + #80#5;
     |SI #0#6 = "S";
          #5#5 = 0;
          #5#6 = #5#4;
     |SINO;
          #5#5 = #5#4;
          #5#6 = 0;
     |FINSI;
     #5#7 = #19#5;
     #5#9 = "N";
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE AlbCom;
     #77#3;
     ;
     "      ", fIni, "     ", 000001;
     "zzzzzz", #0#3, "zzzzz", 999999;
     ;
     NULL, NULL, AlbCom;
|FIN;

|PROCESO Existe;
     |ABRE #4;
     #4#0 = #0#3;
     #4#4 = #0#2;
     |LEE 000#4=;
     |SI FSalida = 0;
          |MENAV "0000Ya existe una carga con esa fecha";
          |ERROR;
     |SINO;
          |LEE 000#4];
          |SI FSalida = 0; |Y #4#4 = #0#2;
               |MENAV "0000Ya existe inventario con fecha mayor";
          |FINSI;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #4;
     |LEE 101#4u;
     |SI FSalida = 0;
          fIni = #4#0 + 1;
     |SINO;
          fIni = "01.01.0000";
     |FINSI;
     |ABRE #5;
     |ABRE #19;
     |BUCLE AlbCom;
     |CIERRA #19;
     |CIERRA #5;
     |CIERRA #4;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |CIERRA #0;
|FPRO;
