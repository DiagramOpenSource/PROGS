|FICHEROS;
     ialbz007;
     ialbz008 #0;
     dsm00003 #3;
     agifa024 #24;
     agifa027 #27;
     agifa142 #142;
|FIN;

|VARIABLES;
     &Tempo = "";
     &nDeci_Base = 0; &nDeci_Div = 0;
     &eaAlfa = "";
     &eaRegNuevo = "";
     &eaEstadoBtn = "";
     aProg = "";
     &eaTmp = "";
     &eaPestana = "";
     &eaSwCarga1 = "";
     &eaBtnAcota1 = "";
     &eaSer1 = "";
     &eaNum1 = "";
     &eaLin1 = "";
     &eaSwCarga2 = "";
     &eaBtnAcota2 = "";
     &eaSer2 = "";
     &eaNum2 = "";
     &eaLin2 = "";
     &eaSwCarga3 = "";
     &eaBtnAcota3 = "";
     &eaSer3 = "";
     &eaNum3 = "";
     &eaLin3 = "";
     &eaSwCarga4 = "";
     &eaBtnAcota4 = "";
     &eaSer4 = "";
     &eaNum4 = "";
     &eaLin4 = "";
     &eaCli4 = "";
     &eaDir4 = "";
     &eaSwCarga5 = "";
     &eaBtnAcota5 = "";
     &eaSer5 = "";
     &eaNum5 = "";
     &eaLin5 = "";
     &eaSwCarga6 = "";
     &eaBtnAcota6 = "";
     &eaCli6 = "";
     &eaMat6 = "";
     &eaArt6 = "";
     &eaLin6 = "";

     aGuardaPestana = "";
     aClaves = "";
     aAlfa = "";
     aFich = "";
     aFichero = "";
     aEmp = "";
     aCliente = "";
     nHandle = 0;
     nPrimera = 0;
     nConta = 0;
     nNume = 0;
 {-1}aGet = 0;
     aGet1 = 0;
     aGet2 = 0;
     aSwCarga = "";
     nPanta0 = 0;
     nBtnActualiza = 0;
     nBtnModiCli = 0;
     nBtnNuevoCli = 0;
     nBtnNuevoDir = 0;
     aTmp = "";
     i = 0;
     nPos = 0;
|FIN;

|PROCESO ValorCampo;
     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 0;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     aAlfa = ("000000" + aAlfa) % -106;
     #0#0 = aAlfa; |PINTA #0#0;

     |REFERENCIA_DEF aGet1, #0;
     aGet2  = 1;    || numero de campo
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     aAlfa = FSalida; |QBT aAlfa;
     #0#1 = aAlfa; |PINTA #0#1;
|FPRC;

|PROCESO BtnModiCli;
     |HAZ ValorCampo;
     |ABRE #24;
     #24#0 = #0#0;
     |LEE 000#24=;
     |SI FSalida = 0;
          aProg = "*dszx0001;"+ "M" + #0#0;
          |SUB_EJECUTA_NP aProg;
          Campo = 0;
          |HAZ Tipo0;
     |SINO;
          |MENAV "0000No existe cliente...";
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO BtnNuevoCli;
     |ABRE #24;
     |SI #142#1 = "S";
          |ABRE #27;
          #27#2 = "";
          #27#0 = "clientes";
          |LEE 101#27=;
          |SI FSalida = 0;
               nConta = #27#1;
               #27#1 = #27#1 + 1;
               |GRABA 021#27a;
          |SINO;
               nConta = 0;
               #27#1 = 1;
               |GRABA 021#27n;
          |FINSI;
          |CIERRA #27;
     |SINO;
          #24#0 = #0#0;
          |LEE 000#24u;
          |SI FSalida = 0;
               nConta = #24#0;
          |SINO;
               nConta = 0;
          |FINSI;
     |FINSI;
     nNume = nConta + 1;
     |PARA; |SI; |HACIENDO;
          nConta = nConta + 1;
          #24#0 = ("000000" + nConta) % -106;
          |LEE 000#24=;
          |SI FSalida ! 0; |SAL; |FINSI;
     |SIGUE;
     |CIERRA #24;
     |SI nNume ! nConta; |Y #142#1 = "S";
          |ABRE #27;
          #27#2 = "";
          #27#0 = "clientes";
          |LEE 101#27=;
          |SI FSalida = 0;
               #27#1 = nConta;
               |GRABA 021#27a;
          |FINSI;
          |CIERRA #27;
     |FINSI;

     #0#0 = #24#0; |PINTA #0#0;

     aProg = "*dszx0001;"+ "C" + #0#0;
     |SUB_EJECUTA_NP aProg;
     Campo = 0;
     |HAZ Tipo0;
|FPRC;

|PROCESO BtnNuevoDir;
     |HAZ ValorCampo;
     |SI #0#1 = 0;
          |MENAV "0000La direccion factura no puede ser la '0000'";
          |ACABA;
     |FINSI;
     |ABRE #3;
     #3#0 = #0#0;
     #3#1 = #0#1;
     |LEE 000#3=;
     |SI FSalida = 0;
          |MENAV "0000La direccion factura ya existe...";
          |ACABA;
     |FINSI;
     |CIERRA #3;

     aProg = "*dszx0001;"+ "D" + #0#0 + (("0000" + #0#1) % -104);
     |SUB_EJECUTA aProg;
     Campo = 1;
     |HAZ Tipo0;
|FPRC;

|PROCESO BtnActualiza;
     |HAZ ValorCampo;

     |SI nPrimera = 0; ||Solo la 1§ vez
          eaEstadoBtn = "ENABLE"; |HAZ EstadoBotonIni;
          nPrimera = 1;
     |FINSI;

     eaSwCarga1 = "N";
     eaSwCarga2 = "N";
     eaSwCarga3 = "N";
     eaSwCarga4 = "N";
     eaSwCarga5 = "N";
     eaSwCarga6 = "N";
     ||...

     |SI eaPestana = ""; |O eaPestana = "1";
          eaPestana = "1";
          |HAZ CargaDatos1; eaNum1 = ""; eaSer1 = ""; eaLin1 = ""; |HAZ Posiciona1;
     |FINSI;
     |SI eaPestana = "2";
          |HAZ CargaDatos2; eaNum2 = ""; eaSer2 = ""; eaLin2 = ""; |HAZ Posiciona2;
     |FINSI;
     |SI eaPestana = "3";
          |HAZ CargaDatos3; eaNum3 = ""; eaSer3 = ""; eaLin3 = ""; |HAZ Posiciona3;
     |FINSI;
     |SI eaPestana = "4";
          |HAZ CargaDatos4; eaNum4 = ""; eaSer4 = ""; eaLin4 = ""; |HAZ Posiciona4;
     |FINSI;
     |SI eaPestana = "5";
          |HAZ CargaDatos5; eaNum5 = ""; eaSer5 = ""; eaLin5 = ""; |HAZ Posiciona5;
     |FINSI;
     |SI eaPestana = "6";
          |HAZ CargaDatos6; eaCli6 = ""; eaMat6 = ""; eaArt6 = ""; eaLin6 = ""; |HAZ Posiciona6;
     |FINSI;
     ||...
|FPRC;

|PROCESO EstadoBotonIni;
     |HAZ EstadoIniBtnPan1;
     |HAZ EstadoIniBtnPan2;
     |HAZ EstadoIniBtnPan3;
     |HAZ EstadoIniBtnPan4;
     |HAZ EstadoIniBtnPan5;
     |HAZ EstadoIniBtnPan6;
     ||...
|FPRC;

|PROCESO CargaVar;
     aAlfa = aCliente % 106; #0#0 = aAlfa; |PINTA #0#0;
     Campo = 0; |HAZ Tipo0;
     aAlfa = aCliente % 704; #0#1 = aAlfa; |PINTA #0#1;
     Campo = 1; |HAZ Tipo0;

     eaSwCarga1 = aSwCarga % 101;
     eaBtnAcota1 = aSwCarga % 201;
     eaSwCarga2 = aSwCarga % 301;
     eaBtnAcota2 = aSwCarga % 401;
     eaSwCarga3 = aSwCarga % 501;
     eaBtnAcota3 = aSwCarga % 601;
     eaSwCarga4 = aSwCarga % 701;
     eaBtnAcota4 = aSwCarga % 801;
     eaSwCarga5 = aSwCarga % 901;
     eaBtnAcota5 = aSwCarga % 1001;
     eaSwCarga6 = aSwCarga % 1101;
     eaBtnAcota6 = aSwCarga % 1201;
     ||...

     || Botones por de fecto
     |SI eaBtnAcota1 = ""; eaBtnAcota1 = "1"; |FINSI;
     |SI eaBtnAcota2 = ""; eaBtnAcota2 = "1"; |FINSI;
     |SI eaBtnAcota3 = ""; eaBtnAcota3 = "1"; |FINSI;
     |SI eaBtnAcota4 = ""; eaBtnAcota4 = "1"; |FINSI;
     |SI eaBtnAcota5 = ""; eaBtnAcota5 = "1"; |FINSI;
     |SI eaBtnAcota6 = ""; eaBtnAcota6 = "1"; |FINSI;
     ||...

     eaSer1 = aClaves % 105;
     eaNum1 = aClaves % 606;
     eaLin1 = aClaves % 1203;
     eaSer2 = aClaves % 1505;
     eaNum2 = aClaves % 2006;
     eaLin2 = aClaves % 2603;
     eaSer3 = aClaves % 2905;
     eaNum3 = aClaves % 3406;
     eaLin3 = aClaves % 4003;
     eaSer4 = aClaves % 4305;
     eaNum4 = aClaves % 4806;
     eaLin4 = aClaves % 5403;
     eaCli4 = aClaves % 5706;
     eaDir4 = aClaves % 6304;
     eaSer5 = ""
     eaNum5 = aClaves % 6709;
     eaLin5 = aClaves % 7602;
     eaCli6 = aClaves % 7806;
     eaMat6 = aClaves % 8415;
     eaArt6 = aClaves % 9920;
     eaLin6 = aClaves % 11903;
     ||...
|FPRC;

|PROCESO Posiciona;
     eaPestana = aGuardaPestana;

     |HAZ EstadoBtn1;
     |HAZ Posiciona1;

     |HAZ EstadoBtn2;
     |HAZ Posiciona2;

     |HAZ EstadoBtn3;
     |HAZ Posiciona3;

     |HAZ EstadoBtn4;
     |HAZ Posiciona4;

     |HAZ EstadoBtn5;
     |HAZ Posiciona5;

     |HAZ EstadoBtn6;
     |HAZ Posiciona6;
     ||...
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |HAZ ValorCampo;
     |SI Campo = 0;
          |C_M #0#1, 1, "S":
          |DDEFECTO #24;
          |SI #0#0 = "000000";
               #0#2 = "< Todos los clientes >";
               #0#1 = 0; |PINTA #0#1;
               |C_M #0#1, 1, "N";
          |SINO;
               |ABRE #24;
               #24#0 = #0#0;
               |LEE 000#24=;
               |SI FSalida = 0;
                    #0#2 = #24#2;
               |SINO;
                    #0#2 = "< No existe el cliente >";
               |FINSI;
               |CIERRA #24;
          |FINSI;
          |PINTA #0#0;
          |PINTA #0#2;
     |FINSI;
     |SI Campo = 1;
          |DDEFECTO #3;
          |SI #0#1 = 0;
               #0#3 = "< Todas las direcciones de entrega > ";
          |SINO;
               |ABRE #3;
               #3#0 = #0#0;
               #3#1 = #0#1;
               |LEE 000#3=;
               |SI FSalida = 0;
                    #0#3 = #3#2;
               |SINO;
                    #0#3 = "< No existe la direccion de entrega >";
               |FINSI;
               |CIERRA #3;
          |FINSI;
          |PINTA #0#1;
          |PINTA #0#3;
     |FINSI;
|FPRC;

|PROCESO Min3;
     #3#0 = #0#0;
     #3#1 = 1;
|FPRC;

|PROCESO Max3;
     #3#0 = #0#0;
     #3#1 = 9999;
|FPRC;

|PROCESO Tipo_66; |TIPO 66;
     |SI #0#0 = "000000";
          |AVISO; |ERROR;
     |SINO;
          |ABRE #3;
          #3#0 = #0#0;
          #3#1 = #0#1;
          |LEE 000#3];
          |CONSULTA_F_CLAVE #1#3, Min3, Max3;
          |SI FSalida = 0;
               #0#1 = #3#1; |PINTA #0#1;
               #0#3 = #3#2; |PINTA #0#3;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #3;
     |FINSI;
|FPRC;

|PROCESO Tipo_7; |TIPO 7;
|FPRC;

|PROCESO Tipo_12; |TIPO 12;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     FSalida = 3499;
|FPRC;

|PROGRAMA;
     |CLS;

     |PARA i = 0; |SI i [ 6; |HACIENDO i = i + 1;
          |HAZ CreaTempo;
          aTmp = aTmp + Tempo;
     |SIGUE;
     eaTmp = aTmp;

     |HAZ DecimalesBase;
     nDeci_Div = nDeci_Base; || Para el importe de los recibos

     |PINPA #0#0;  nPanta0 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,Actualizar", 0688, 0699, BtnActualiza;
     nBtnActualiza = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,Mod.Cliente", 0788, 0799, BtnModiCli;
     nBtnModiCli = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Nuevo", 0623, 0632, BtnNuevoCli;
     nBtnNuevoCli = FSalida;
     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}} Nueva", 0723, 0732, BtnNuevoDir;
     nBtnNuevoDir = FSalida;

     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     |HAZ DecimalesBase;
     |HAZ CargaCartera;

     |HAZ CargaVar;
     |HAZ PintaPanta1;
     |HAZ PintaPanta2;
     |HAZ PintaPanta3;
     |HAZ PintaPanta4;
     |HAZ PintaPanta5;
     |HAZ PintaPanta6;
     |HAZ PintaPanta7;
     ||...
     eaEstadoBtn = "DISABLE";
     |HAZ EstadoBotonIni;

     |PINDA #0#0;
     |PARA; |SI; |HACIENDO;
          |ENDATOS #1#0;
          |SI FSalida ! 0; |SAL; |FINSI;
     |SIGUE;

/*
     |HAZ CogePosicion1;
     |HAZ CogePosicion2;
     |HAZ CogePosicion3;
     |HAZ CogePosicion4;
     |HAZ CogePosicion5;
     |HAZ CogePosicion6;
     ||....

     |FIN_CONTROL_WINDOWS nBtnActualiza;
     |FIN_CONTROL_WINDOWS nBtnModiCli;
     |FIN_CONTROL_WINDOWS nBtnNuevoCli;
     |FIN_CONTROL_WINDOWS nBtnNuevoDir;

     |HAZ DestruyePan7;
     |HAZ DestruyePan6;
     |HAZ DestruyePan5;
     |HAZ DestruyePan4;
     |HAZ DestruyePan3;
     |HAZ DestruyePan2;
     |HAZ DestruyePan1;
*/
     |PULSATECLA;

     ||...     Ojo con el orden (por los cargadef) ...........||
     |HAZ Descarga7;
     |HAZ Descarga6;
     |HAZ Descarga5;
     |HAZ Descarga4;
     |HAZ Descarga3;
     |HAZ Descarga2;
     |HAZ Descarga1;
     |HAZ DescargaCartera;

     |PARA i = 0; |SI i [ 6; |HACIENDO i = i + 1;
          nPos = (8 * i + 1) * 100 + 8;
          aAlfa = aTmp % nPos;
          Tempo = aAlfa;
          |NOME_DAT #ialbz007#Tempo#; |DELINDEX #ialbz007;
          |HAZ BoraTempo;
     |SIGUE;

     |PULSATECLA;
|FPRO;
