|FICHEROS;
     guerz071 #0;
     goalbpa4 #4;
     goalbpa5 #5;
     gopartia #6;
     goparame #10;
     goparam5 #11;
     dsm00054 #54;
     guerw065 #65,MANTE;
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp65 = "";
     i = 0;
     &xDocTras      = 0;
     &xFecDocu      = @;
     &xLinDocu      = 0;
     &xCodArti      = "";
     &xDesArti      = "";
     &xSerie        = "";
     &xCanArti      = 0;
     &xAlmEntr      = 0;
     &xAlmSali      = 0;
     &xModo         = 0;
     &xForma        = 0;
     &enEnvio       = 0;
     &eaDestino     = "";
|FIN;

|PROCESO Corrige;
     #4#0 = #65#0;
     #4#1 = #65#1;
     |LEE 020#4=;

     #5#0 = #65#0;
     #5#1 = #65#1;
     #5#2 = #65#2;
     |LEE 121#5=;

     #6#34 = "A";
     #6#4 = #65#0;
     #6#5 = #65#1;
     #6#6 = #65#2;
     #6#7 = 1;
     |LEE 101#6=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |SI #5#8 = #65#8; |ACABA; |FINSI;

     #5#8 = #65#8;

     xForma =  1;
     xSerie   = #4#0;
     xDocTras = #4#1;
     xFecDocu = #4#2;
     xLinDocu = 0;       || #6#35;  si es 0 hace ultima linea+1
     xCodArti = #5#3;
     xDesArti = #5#4;
     xCanArti = #6#10;
     xAlmEntr = #6#17;
     xAlmSali = #5#8;
     |SI #5#8 ! #6#17;
          |SUB_EJECUTA_NP "gomoval1";
     |FINSI;

     #6#19 = xDocTras;
     #6#32 = xSerie;
     #6#35 = xLinDocu;
     #5#11 = xDocTras;
     |GRABA 020#5a;
     |GRABA 020#6a;


     |LIBERA #5;
     |LIBERA #6;
|FPRC;

|DEFBUCLE Corrige;
     #65#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Corrige;
|FIN;

|PROCESO goalbpa5;
     |SI #10#76 = "N";
          |SI #10#22 = #5#8; |ACABA; |FINSI;
     |SINO;
          #11#0 = #5#8;
          |LEE 000#11=;
          |SI FSalida = 0; |ACABA; |FINSI;
     |FINSI;

     #54#2 = #5#0;
     #54#0 = #5#11;
     |LEE 000#54=;
     |SI FSalida = 0; |ACABA; |FINSI;

     |PARA i = 0; |SI i [ 11; |HACIENDO i = i + 1;
          #65i = #5i;
     |SIGUE;
     |GRABA 020#65n;
|FPRC;

|DEFBUCLE goalbpa4;
     #4#1;
     2;
     #0#2, 000001, #0#0;
     #0#3, 999999, #0#1;
     ;
     NULL, NULL, goalbpa5;
|FIN;

|PROCESO Min;
     #65#0 = "     ";
     #65#1 = 000001;
     #65#2 = 001;
|FPRC;

|PROCESO Max;
     #65#0 = "zzzzz";
     #65#1 = 999999;
     #65#2 = 999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |HAZ CreaTempo; aTmp65 = Tempo; |NOME_DAT #65#Tempo#; |DELINDEX #65;
     |ABRE #65;
     |ABRE #11;
     |ABRE #54;
     |BUCLE goalbpa4;
     |CIERRA #54;
     |CIERRA #11;
     |CIERRA #65;
     |PINPA #0#65;
     |ENTLINEAL #1#65, 1, 2, 22, 0, Min, Max;
     |CONFI "0000NCorrecto ?";
     |SI FSalida = 0;
          |ABRE #4;
          |ABRE #5;
          |ABRE #6;
          |BUCLE Corrige;
          |CIERRA #6;
          |CIERRA #5;
          |CIERRA #4;
     |FINSI;

     Tempo = aTmp65; |HAZ BoraTempo; |DELINDEX #65;
|FPRC;
