Calculo llamado por aojentr3, aojentr5 del modulo 003774 de laboral

|FICHEROS;
     gomantho #0;
     gomantl1 #1;
     gosubcoc #2;

     gomatcab #3,MANTE;
     gomatlin #4;
     gomatljn #5,MANTE;
     gopre001 #6;

     goparame #10;
|FIN;

|VARIABLES;
     &enSubcon = 0;
     aAlfa = "";
     aSerExp = "";
     nNumExp = "";
     aSerPre = "";
     nNumPre = "";
     fFec = @;
     aSub = "";
     nError = 0;
     aEstado = "";
     nLin = 0;
     &cCodMonBase = "";
     &cCodMonTrab = "";
     &nEurVenTrab = 0;
     &nEurVenBase = 0;
|FIN;

|PROCESO SumaTotal1;
     #4#5 = #4#5 + #5#9;
     #4#6 = #4#6 + #5#10;
     #4#7 = #4#7 + #5#11;
     #4#8 = #4#8 + #5#12;
|FPRC;

|DEFBUCLE SumaTotal1;
     #5#1;
     ;
     #4#3, #4#4, 0001;
     #4#3, #4#4, 9999;
     ;
     NULL, SumaTotal1;
|FIN;

|PROCESO SumaTotal;
     #4#5 = 0;
     #4#6 = 0;
     #4#7 = 0;
     #4#8 = 0;
     |BUCLE SumaTotal1;
     |GRABA 020#4a;
     |LIBERA #4;

     |SI #4#9 = "P";
          #3#2  = #3#2 + #4#5;         ||Pres. Costo.
          #3#4  = #3#4 + #4#7;         ||Pres. Venta.
     |FINSI;

     |SI #4#9 = "A";
          #3#6  = #3#6 + #4#5;         ||Admi. Costo.
          #3#8  = #3#8 + #4#7;         ||Admi. Venta.
     |FINSI;

     |SI #4#9 = "E";
          #3#10 = #3#6 + #4#5;         ||Extr. Costo.
          #3#12 = #3#8 + #4#7;         ||Extr. Venta.
     |FINSI;

     #3#14 = #3#4+#3#8+#3#12;           ||Total Gen. Venta.
     #3#16 = #3#2+#3#6+#3#10;           ||Total Gen. Venta.
|FPRC;

|DEFBUCLE SumaTotal;
     #4#1;
     ;
     #3#0, #3#1, 0001;
     #3#0, #3#1, 9999;
     be;
     NULL, SumaTotal;
|FIN;

|PROCESO Min5;
     #5#0 = #4#3;
     #5#1 = #4#4;
     #5#2 = 1;
|FPRC;

|PROCESO Max5;
     #5#0 = #4#3;
     #5#1 = #4#4;
     #5#2 = 9999;
|FPRC;

|PROCESO Min4;
     #4#0 = #3#0;
     #4#1 = #3#1;
     #4#2 = nLin;
|FPRC;

|PROCESO Max4;
     #4#0 = #3#0;
     #4#1 = #3#1;
     #4#2 = nLin;
|FPRC;

|PROCESO LinExpe;
     aSerPre = #1#3;
     nNumPre = #1#4;
     aEstado = #1#10;
     |SI #1#10 = "C"; |ERROR10; |FINSI;
|FPRC;

|PROGRAMA;
     aAlfa = PARAMETRO % 105; aSerExp = aAlfa;
     aAlfa = PARAMETRO % 606; nNumExp = aAlfa;
     aAlfa = PARAMETRO % 1210; fFec = aAlfa;
     aAlfa = PARAMETRO % 2206; aSub = aAlfa;

     |ABRE #10; |LEE 000#10p; |CIERRA #10;

     |ABRE #0;
     #0#0 = aSerExp;
     #0#1 = nNumExp;
     |LEE 020#0=;
     |SI FSalida = 0;
          |BUCLELIN 2 LinExpe #0;
          |SI aEstado = "E";
               |MENAV "0000Obra en estado de ESPERA...";
               nError = 1;
          |FINSI;
          |SI aEstado = "P";
               |SI #10#72 = "S"; |MENAV "0000Obra en estado PARADA..."; |FINSI;
               |SI #10#73 = "N"; nError = 1; |FINSI;
          |FINSI;
          |SI aEstado = "T";
               |SI #10#74 = "S"; |MENAV "0000Obra en estado TERMINADA..."; |FINSI;
               |SI #10#75 = "N"; nError = 1; |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #0;

     |SI nError ! 0; |ACABA; |FINSI;

     |ABRE #2;
     #2#0 = aSub;
     |SI #2#0 ! 0;
          |LEE 020#2=;
          |SI FSalida ! 0;
               aSerPre = #2#4;
               nNumPre = #2#5;
          |FINSI;
     |FINSI;
     |CIERRA #2;

     |ABRE #6;
     #6#0 = aSerPre;
     #6#1 = nNumPre;
     |LEE 020#6=;
     |CIERRA #6;

     |ABRET #3;
     #3#0 = aSerExp;
     #3#1 = nNumExp;
     |LEE 101#3=;
     |SI FSalida ! 0;
          #3#18 = #0#2;
          #3#19 = #0#3;
          #3#20 = #0#6;
          cCodMonTrab = #3#20;
          #3#21 = cCodMonBase;          ||Moneda Base.
          #3#22 = nEurVenTrab;          ||Valor cambio Trabajo.
          #3#23 = nEurVenBase;          ||Valor cambio Base.
          |GRABA 020#3b;
     |FINSI;
     |ABRET #4;
     |SELECT #2#4;
     #4#3 = aSerPre;
     #4#4 = nNumPre;
     |LEE 000#4=;
     |SI FSalida ! 0;
          |SELECT #1#4;
          #4#0 = #3#0;
          #4#1 = #3#1;
          #4#2 = 9999;
          |LEE 000#4];
          |SI FSalida = 0;
               |LEE 000#4a;
          |SINO;
               |LEE 000#4u;
          |FINSI;
          |SI FSalida = 0; |Y #4#0 = #3#0; |Y #4#1 = #3#1;
               nLin = #4#2 + 1;
          |SINO;
               nLin = 1;
          |FINSI;
          |DDEFECTO #4;
          #4#0 = #3#0;
          #4#1 = #3#1;
          #4#2 = nLin;

          #4#3 = aSerPre;
          #4#4 = nNumPre;
          #4#9 = #6#18;
          |GRABA 020#4b;
     |SINO;
          |SELECT #1#4;
          |LEE 121#4=;
          nLin = #4#2;
     |FINSI;

     enSubcon = #2#0;

     |CLS;
     |PINPA #0#3;
     |PINDA #0#3;

     || Solo presento el presupuesto actual
     |ENTLINEAL #1#4, -3, 7, 12, 0, Min4, Max4;

     |ENTLINEAL #1#5, -3, 1, 22, 0, Min5, Max5;

     #3#2  = 0;
     #3#4  = 0;
     #3#6  = 0;
     #3#8  = 0;
     #3#10 = 0;
     #3#12 = 0;
     |BUCLE SumaTotal;
     |GRABA 020#3a;

     |CIERRAT #4;
     |CIERRAT #3;
|FPRO;
