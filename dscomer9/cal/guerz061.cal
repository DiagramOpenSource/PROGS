|FICHEROS;
     gopartia #0;   || = goalbpa3
     goalbpa1 #1;
     goalbpa2 #2;
     gosubaux #3;
|FIN;

|VARIABLES;
     &enModo = 0;
     &eaSerie = "";
     &enCodigo = 0;
     &enLinea = 0;
     &enUnidades = 0;
     &enDto1 = 0;
     &enDto2 = 0;
     &enDto = 0;
     &enPrecio = 0;
     &enError = 0;
|FIN;

|PROCESO ActGosuaux;
     |ABRE #3;
     #3#0 = #0#34;
     #3#1 = #0#4;
     #3#2 = #0#5;
     #3#3 = #0#6;
     #3#4 = #0#7;
     |SI enModo = 3;
          |BORRA 000#3c;
     |SINO;
          |LEE 101#3=;
          |SI FSalida = 0;
               #3#7 = #0#28;
               #3#8 = #0#12;
               |GRABA 020#3a;
          |FINSI;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROGRAMA;
     enError = 0;
     |ABRE #0;
     |ABRE #1;
     |ABRE #2;

     #1#0 = eaSerie;
     #1#1 = enCodigo;
     |LEE 101#1=;
     |SI FSalida = 0;
          #2#0 = #1#0;
          #2#1 = #1#1;
          #2#2 = enLinea;
          |LEE 101#2=;
          |SI FSalida = 0;
               #0#34 = "M";
               #0#4 = #2#0;
               #0#5 = #2#1;
               #0#6 = #2#2;
               #0#7 = 1;
               |LEE 000#0];
               |SI FSalida = 0;
                    |SI #0#34 = "M"; |Y #0#4 = #2#0;|Y #0#5 = #2#1;|Y #0#6 = #2#2;
                         |LEE 000#0s;
                         |SI #0#34 = "M"; |Y #0#4 = #2#0;|Y #0#5 = #2#1;|Y #0#6 = #2#2; |Y FSalida = 0;
                              enError = 1;
                         |FINSI;
                    |FINSI;
                    |SI enError = 0;
                         #0#34 = "M";
                         #0#4 = #2#0;
                         #0#5 = #2#1;
                         #0#6 = #2#2;
                         #0#7 = 1;
                         |LEE 101#0];
                         |SI enModo = 3;
                              |BORRA 020#0a;
                              #2#6 = #2#6 - #0#10;
                         |FINSI;
                         |SI enModo = 2;
                              #2#6 = #2#6 - #0#10;

                              #0#10 = enUnidades;
                              #0#41 = enPrecio;
                              #0#42 = enDto1;
                              #0#43 = enDto2;
                              #0#44 = enDto;
                              |HAZ CalcuGopartia;
                              |GRABA 020#0a;


                              #2#6 = #2#6 + #0#10;
                         |FINSI;
                         #2#7 = #2#5 - #2#6;
                         |HAZ ActGosuaux;
                         |GRABA 020#2a;
                    |SINO;
                         |MENAV "0000Linea asignada a varias partidas, no se modifica";
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |CIERRA #2;
     |CIERRA #1;
     |CIERRA #0;
|FPRO;
