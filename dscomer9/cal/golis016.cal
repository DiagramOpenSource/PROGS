|FICHEROS;
     golis016 #0;
     gopartia #1;
     gomantho #2;
     gotmp006 #3;
     agifa724 #724;
     cacuenta@ #10;
     agifa142 #142;
     agifa084 #84;
     goman001 #4;

     goptrbli #5;
|FIN;

|VARIABLES;
     aInforme1 = "golis016";
     aInforme2 = "goli0016";
     aInforme3 = "golir016";
     aInforme  = "";
     dA        = "                    ";
     hA        = "zzzzzzzzzzzzzzzzzzzz";
     aDef      = "";
     aPath     = "";
     aAlfa     = "";
     nHay      = 0;
     aTipo     = "";
     acTipo    = "";
     aCta      = "";
     nEsGasto  = 0;
     nExpe     = 1;
|FIN;

|PROCESO agrupa;
  |SI #0#9 = "S";
      #0#11 = "N";
      |PINTA #0#11;
  |FINSI;
|FPRC;

|PROCESO normal;
  |SI #0#9 = "S"; |Y #0#11 = "R";
      |MENAV "    No puede ser resumido";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO Tmp;
     |SI aDef ! "";
          |DDEFECTO #10;
          #10#0 = #3#3;
          |LEE 000#10=;
          aAlfa = #10#2;
          |QBT aAlfa;
          |SI aAlfa ! "";
              #3#6 = #10#2;
          |FINSI;
     |FINSI;
     |PRINT;
     nHay = 1;
|FPRC;

|DEFBUCLE Tmp;
     #3#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO agifa_084;
  #4#0 = #84#87;
  |LEE 101#4=;
  |SI FSalida = 0;
      aAlfa = #4#2;
      nExpe = #4#3;
      |QBT aAlfa;
      |SI aAlfa = "";
          aAlfa = #84#87 % 105;
          nExpe = 1;
      |FINSI;
  |SINO;
      aAlfa = #84#87 % 105;
      nExpe = 1;
  |FINSI;
  |SI aAlfa < #0#0; |O aAlfa > #0#1;
      |ACABA;
  |FINSI;
  aTipo = "C";
  acTipo = aTipo;
  |DDEFECTO #3;
  |SI #0#9 = "N";
      #3#0 = aAlfa;
      #3#1 = nExpe;
  |FINSI;
  #3#2 = acTipo;
  |SI #0#11 = "N";
      #3#3 = "799999999";
  |SINO;
      #3#3 = "";
  |FINSI;
  |LEE 101#3=;
  |SI FSalida ! 0; |GRABA 020#3b; |FINSI;
  #3#5 = #3#5 + #84#16 + #84#19 + #84#22 + #84#42 + #84#45;
  #3#6 = "VENTAS FACTURAS DIRECTAS";
  |GRABA 020#3a;
  |LIBERA #3;
|FPRC;

|DEFBUCLE agifa_084;
#84#1;
1;
"     ", 000000, #0#6;
"zzzzz", 999999, #0#7;
be;
NULL,agifa_084;
|FIN


|PROCESO gopartia;
     |LIBERA #2;
     #2#0 = #1#2;
     #2#1 = #1#3;
     |LEE 000#2=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SI #2#30 < #0#4; |O #2#30 > #0#5;||Jefe
         |ACABA;
     |FINSI;
     nEsGasto = 1;
     aAlfa = #1#20 % 101;
     |SI aAlfa = "7";
         nEsGasto = 0;
     |FINSI;
     #724#0 = #1#20;
     |LEE 000#724=;
     |SI FSalida ! 0; |DDEFECTO #724; |FINSI;
     |LIBERA #724;
     |SI nEsGasto = 0;
         #724#3 = #1#20;
     |FINSI;
     aTipo = "C";
     acTipo = aTipo;
     |DDEFECTO #3;
     |SI #0#9 = "N";
         #3#0 = #2#0;
         #3#1 = #2#1;
     |FINSI;
     #3#2 = acTipo;
     |SI #0#11 = "R";
         #3#3 ="";
     |SINO;
         #3#3 = aCta;
     |FINSI;
     |LEE 101#3=;
     |SI FSalida ! 0; |GRABA 020#3b; |FINSI;
     |SI nEsGasto = 1;
         #3#4 = #3#4 + #1#25;
     |SINO;
         #3#5 = #3#5 + #1#25;
     |FINSI;
     |GRABA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE gopartia;
     #1#3;
     28;
     #0#0, #0#2, "     ", 000001, dA, dA, #0#6;
     #0#1, #0#3, "zzzzz", 999999, hA, hA, #0#7;
     ;
     NULL, gopartia;
|FIN;

|DEFBUCLE gopartiaT;
     #1#3;
     28, 34;
     #0#0, #0#2, "     ", 000000, dA, dA, #0#6, "T";
     #0#1, #0#3, "zzzzz", 999999, hA, hA, #0#7, "T";
     ;
     NULL, gopartia;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |HAZ MiraLogos; || Copia Logos para el Crystal
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     aDef = #142#151; |QBF aDef;
     aDef = aDef + "/def/cacuenta";
     |CARGA_DEF aDef, cacuenta@;
     |SI FSalida ! 0;
          aAlfa = "0000Error al cargar:" + aDef;
          aDef = "";
          |MENAV aAlfa;
     |SINO;
          aPath = #142#151; |QBF aPath;
          aPath = aPath + "/fich/" + (("000000" + #142#152) % -106) + "/";
          |PATH_DAT #10 aPath;
          |ABRE #10;
     |FINSI;

     |SI #0#9 = "S";
          aInforme = aInforme2;
     |FINSI;
     |SI #0#11 = "N";
          aInforme = aInforme1;
     |SINO;
          aInforme = aInforme3;
     |FINSI;

     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               aAlfa = Usuario; |QBF aAlfa;
               |NOME_DAT #3 aAlfa; |DELINDEX #3;

               |ABRE #2;
               |ABRE #724;
               |ABRE #3;
               |SI #0#12 = "N";
                    |ABRE #5;
                    |BUCLE gopartia;
                    |CIERRA #5;
                    |SI #0#10 = "S";
                        |ABRE #4;
                        |BUCLE agifa_084;
                        |CIERRA #4;
                    |FINSI;
               |SINO;
                    |ABRE #5;
                    |BUCLE gopartiaT;
                    |CIERRA #5;
               |FINSI;
               |CIERRA #3;
               |CIERRA #2;
               |BUCLE Tmp;
               |CIERRA #724;
               |DELINDEX #3;

               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               aInforme = "0000No existe informe " + aInforme;
               |MENAV aInforme;
          |FINSI;
          |FINIMP;
     |FINSI;

     |SI aDef ! "";
          |CIERRA #10;
          |DESCARGA_DEF #cacuenta@;
     |FINSI;
|FPRC;
