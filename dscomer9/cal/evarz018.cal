|FICHEROS;
     evarz018 #0;
     evarm004 #1;
     evarm005 #2;
     evarm021 #21;
     evarm022 #22;
     evarw004 #26;  || Tmp Chequeo
     agifa104 #104;
     agifa073 #73;
     agifa010 #10;
     agifa071 #71;
|FIN;


|VARIABLES;
     &enExiste = 0;
     aEsNormal = "N";
     aDNom = "";
     aHNom = "";
     nTalla = 0;
     aTalla = "";
     nNume = 0;
     aCB = "";
     aAlfa = "";
     nUni = 0;
     i = 0;
     j = 0;
     nHay = 0;
|FIN;

|PROCESO Situacion;
     #2#0 = #21#0;
     |LEE 000#2=;
     |SI FSalida = 0;
          #21#8 = #2#3;

          #26#0 = #21#0;
          #26#1 = #21#4;
          #26#2 = #21#5;
          #26#3 = #21#6;
          |LEE 000#26=;
          |SI FSalida = 0;
                |SI #26#4 ! #21#8;
                    enExiste = 0;
                    |PRINT;
                    nHay = 1;
                |FINSI;
          |SINO;
               enExiste = 1;
               |PRINT;
               nHay = 1;
          |FINSI;

          |GRABA 020#21a;
     |FINSI;
     |LIBERA #21;
|FPRC;

|DEFBUCLE Situacion;
     #21#4;
     ;
     #0#0;
     #0#1;
     be;
     NULL, Situacion;
|FIN;

|PROCESO eva00021;
     nHay = 1;
     |SI nUni [ 0;
          |ACABA;
     |FINSI;
     aAlfa = #21#0; |QBF aAlfa;
     |SI aAlfa = "";
          #21#14 = #21#14 + #71#5;

          #22#11 = #71#5;
     |SINO;
          nUni = nUni - 1;
          #21#14 = #21#14 + 1;

          #22#11 = 1;
          #22#12 = #21#2;
          #22#13 = #21#0;
     |FINSI;
     #22#4 = #21#3;
     #22#8 = #21#7;
     #21#12 = #21#13 - #21#14;
     |SI #21#12 [ 0;
          #21#11 = "S";
     |FINSI;
     |GRABA 020#21a;
     |LIBERA #21;

     |GRABA 020#22n;
|FPRC;

|DEFBUCLE eva00021;
     #21#3;
     11;
     #22#5, #22#6, #22#7, "N";
     #22#5, #22#6, #22#7, "N";
     be;
     NULL, eva00021;
|FIN;

|PROCESO agifa071;
     |DDEFECTO #22;
     #22#0 = #71#29;
     #22#1 = #71#0;
     #22#2 = #71#1;
     #22#3 = #71#2;
     #22#5 = #71#31;
     #22#6 = #71#12;
     #22#7 = #71#21;
     #22#9 = #10#1;
     #22#10 = #10#3;
     nUni = #71#5;
     nHay = 0;
     |BUCLE eva00021;
     |SI nHay = 0;
          #22#11 = #71#5;
          |GRABA 020#22n;
     |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #10#3;
     ;
     #0#0, "01.01.0000", "     ", 000000;
     #0#1, "31.12.9999", "zzzzz", 999999;
     ;
     NULL, NULL, agifa071;
|FIN;

|PROCESO GrabaNormal;
     |DDEFECTO #21;
     #21#0 = "";
     #21#1 = #73#2;
     #21#2 = "";
     #21#3 = #1#29;
     #21#4 = #1#30;
     #21#5 = #1#31;
     #21#6 = #1#32;
     #21#7 = #1#28;
     #21#8 = "";
     #21#9 = #104#1;
     #21#10 = #104#4;
     #21#11 = "N";
     #21#12 = #73#5;
     #21#13 = #73#5;
     |GRABA 020#21n;
|FPRC;

|PROCESO Etiqueta;
     |PARA j = 1; |SI j [ nUni; |HACIENDO j = j + 1;
          aAlfa = aCB + (("00" + j) % -102);
          |DDEFECTO #21;
          #21#0 = aAlfa;
          #21#1 = #73#2;
          #21#2 = aTalla;
          #21#3 = #1#29;
          #21#4 = #1#30;
          #21#5 = #1#31;
          #21#6 = #1#32;
          #21#7 = #1#28;
          #21#8 = "PREVIO";
          #21#9 = #104#1;
          #21#10 = #104#4;
          #21#11 = "N";
          #21#12 = 1;
          #21#13 = 1;
          |GRABA 020#21n;
     |SIGUE;
|FPRC;

|PROCESO agifa073;
     aEsNormal = "S";
     |DDEFECTO #1;
     #1#30 = #73#28;
     #1#31 = #73#0;
     #1#32 = #73#1;
     |LEE 000#1=;
     nTalla = 80;
     nNume = 1;
     |PARA i = 3; |SI i [ 14; |HACIENDO i = i + 1;
          |SI #1i ! 0;
               aEsNormal = "N";
               aTalla = nTalla;
               aCB = ("000000" + #73#0) % -106;
               aCB = aCB + ("00" + #73#1) % -102;
               aCB = aCB + ("00" + nNume) % -102;
               nUni = #1i;
               |HAZ Etiqueta;
          |FINSI;
          nTalla = nTalla + 5;
          nNume = nNume + 1;
     |SIGUE;
     |SI #1#27 ! 0;
          aEsNormal = "N";
          aTalla = "140"
          nNume = 14;
          aCB = ("000000" + #73#0) % -106;
          aCB = aCB + ("00" + #73#1) % -102;
          aCB = aCB + ("00" + nNume) % -102;
          nUni = #1#27;
          |HAZ Etiqueta;
     |FINSI;
     |SI #1#15 ! 0;
          aEsNormal = "N";
          aTalla = "Especial";
          nNume = 13;
          aCB = ("000000" + #73#0) % -106;
          aCB = aCB + ("00" + #73#1) % -102;
          aCB = aCB + ("00" + nNume) % -102;
          nUni = #1#15;
          |HAZ Etiqueta;
     |FINSI;
     |SI aEsNormal = "S";
          |HAZ GrabaNormal;
     |FINSI;
|FPRC;

|DEFBUCLE agifa104;
     #104#6;
     ;
     #0#0, 0001;
     #0#1, 9999;
     ;
     NULL, NULL, agifa073;
|FIN;

|PROCESO Borra22;
     |BORRA 020#22a;
     |LIBERA #22;
|FPRC;

|DEFBUCLE Borra22;
     #22#3;
     ;
     #0#0, "  ", 000001, 001;
     #0#1, "zz", 999999, 999;
     be;
     NULL, Borra22;
|FIN;

|PROCESO Borra21;
     |BORRA 020#21a;
     |LIBERA #21;

     #26#0 = #21#0;
     #26#1 = #21#4;
     #26#2 = #21#5;
     #26#3 = #21#6;
     #26#4 = #21#8;
     |GRABA 020#26n;
|FPRC;

|DEFBUCLE Borra21;
     #21#4;
     ;
     #0#0;
     #0#1;
     be;
     NULL, Borra21;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aDNom = " " * 30;
     aHNom = "z" * 30;

     aAlfa = Usuario;
     |NOME_DAT #26 aAlfa; |DELINDEX #26;

     |ABRE #26;

     |BUCLE Borra21;
     |BUCLE Borra22;

     |ABRE #21;
     |ABRE #22;
     |ABRE #1;
     |BUCLE agifa104;
     |CIERRA #1;
     |BUCLE agifa010;
     |CIERRA #22;
     |CIERRA #21;

     |SI PARAMETRO = "menu";
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "eva00023";
               |SI FSalida ! 0;
                    |MENAV "0000Error en informe 'eva00023'";
               |SINO;
                    nHay = 0;
                    |ABRE #2;
                    |BUCLE Situacion;
                    |CIERRA #2;
                    |SI nHay = 0;
                         |MENAV "0000No hay diferencias...";
                    |SINO;
                        |PIEINF;
                    |FINSI;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
     |SINO;
          |ABRE #2;
          |BUCLE Situacion;
          |CIERRA #2;
     |FINSI;

     |CIERRA #26; |DELINDEX #26;
|FPRC;
