|FICHEROS;
     coima028 #0;
|FIN;

|VARIABLES;
     aAlfa = "";
     aRuta = "";
     aImg = "";
     aOrg = "";
     aDes = "";
     aLon = "";
     aCar = "";
     aNom = "";
     aIP = "";
     nPos = 0;
     i = 0;
|FIN;

|PROCESO Browse28;
     aRuta = "F*.*";
     |BROWSE aRuta;
     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta ! "F";
          #0Campo = aRuta; |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO BorraImagen28;
     |SI aImg = ""; |ACABA; |FINSI;
     |HAZ SacaNom28;
     |DBASE aOrg;
     aImg = aOrg + "000web/imagenes/" + aNom;
     |FBORRA aImg;
|FPRC;

|PROCESO SacaNom28;
     aLon = aImg % A0;
     aNom = "";
     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = -(i * 100 + 1)
          aCar = aImg % nPos;
          |SI aCar = "\"; |O aCar = "/"; |SAL; |FINSI;
          aNom = aCar + aNom;
     |SIGUE;
|FPRC;

|PROCESO CopiaImagen28;
     |SI aImg = ""; |ACABA; |FINSI;
     |DBASE aDes;
     aDes = aDes + "000web/"; |MKDIR aDes;
     aDes = aDes + "imagenes/"; |MKDIR aDes;
     |HAZ SacaNom28;
     aDes = aDes + aNom;
     aOrg = aImg;
     |SI aIP = "";
          |COPIA_FICHERO aOrg, aDes;
     |SINO;
          |RECIBE_FICHERO aOrg, aDes;
     |FINSI;
|FPRC;

|PROCESO Foto28; |TIPO 0;
     |SI FSalida = 10;
          |HAZ Browse28;
     |FINSI;
     |SI #0Campo ! Contenido;
          aIP = ""; |IP_REMOTO aIP; |QBF aIP;
          aImg = Contenido; |QBF aImg;
          |HAZ BorraImagen28;
          aImg = #0Campo; |QBF aImg;
          |HAZ CopiaImagen28;
     |FINSI;
|FPRC;
