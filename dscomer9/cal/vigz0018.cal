|FICHEROS;
alba0017 #0;
agifa071 #1;
agifa010 #2;
agifa019 #3;
agifa025 #4;
alba0018 #5;   ||Temporal.
agifa024 #6;
agifa134 #7;
agifa114 #8;
|FIN;

|VARIABLES;
&Tempo = "";
informe   = "alba0017";
&zona     = "";
&repres   = "";
i         = 0;
sw        = 0;
&swlin    = 0;
&t1       = 0;
&t2       = 0;
&t3       = 0;
&t4       = 0;
&t5       = 0;
&t6       = 0;
&tr1      = 0;
&tr2      = 0;
&tr3      = 0;
&tr4      = 0;
&tr5      = 0;
&tr6      = 0;
&tt1      = 0;
&tt2      = 0;
&tt3      = 0;
&tt4      = 0;
&tt5      = 0;
&tt6      = 0;
swpasa    = 0;
|FIN;

|CALCULO pasa_lin;
|ABRE #2;
#2#52 = #1#29;
#2#0 = #1#0;
|LEE 000#2=;
|LIBERA #2;
|CIERRA #2;
|ABRE #3;
#3#0 = #1#2;
|LEE 000#3=;
|LIBERA #3;
|CIERRA #3;
|ABRE #4;
#4#0 = #2#6;
|LEE 000#4=;
|LIBERA #4;
|CIERRA #4;
|ABRE #6;
#6#0 = #2#3;
|LEE 000#6=;
|LIBERA #6;
|CIERRA #6;
|ABRE #7;
#7#0 = #2#39;
#7#49 = #2#53;
|LEE 000#7=;
|LIBERA #7;
|CIERRA #7;
|ABRE #8;
#8#0 = #7#0;
#8#17 = #7#49;
#8#1 = 1;
|LEE 000#8=;
|LIBERA #8;
|CIERRA #8;
swpasa = 0;
|SI #8#13 = "S";|Y #0#0 = "S";
    |SI #8#16 ] #0#13;|Y #8#16 [ #0#14;
        swpasa = 1;
    |FINSI;
|FINSI;
|SI #8#13 = "N";|Y #0#0 = "N";
    swpasa = 1;
|FINSI;
|SI #0#0 = "T";
    swpasa = 1;
|FINSI;

|SI swpasa = 1;
    |SI #2#1 ] #0#3;|Y #2#1 [ #0#4;
        |SI #2#6 ] #0#7;|Y #2#6 [ #0#8;
            |SI #6#3 ] #0#9;|Y #6#3 [ #0#10;
                |SI #2#3 ] #0#11;|Y #2#3 [ #0#12;
                    |ABRE #5;
                    #5#10 = #2#6;
                    #5#0  = #6#3;
                    #5#1  = #2#3;
                    |LEE 000#5=;
                    |SI FSalida ! 0;
                        |DDEFECTO #5;
                        #5#10 = #2#6;
                        #5#0  = #6#3;
                        #5#1  = #2#3;
                        |GRABA 000#5c;
                        |LIBERA #5;
                    |FINSI;
                    #5#10 = #2#6;
                    #5#0  = #6#3;
                    #5#1  = #2#3;
                    #5#2  = #6#1;
                    #5#3  = #6#6;
                    #5#4  = #5#4 + #1#9;
                    #5#5  = #5#5 + #1#5;
                    #5#6  = #5#6 + #1#14;
                    #5#7  = #5#4 - #5#6;
                    #5#8  = (#5#7 / #5#4) * 100;
                    #5#9  = #5#6 / #5#5;
                    |GRABA 000#5a;
                    |LIBERA #5;
                    |PARA i = 0;|SI i = 10;|HACIENDO i = i + 1;
                          #5i = "";
                    |SIGUE;
                    |CIERRA #5;
                |FINSI;
            |FINSI;
        |FINSI;
    |FINSI;
|FINSI;
|FCAL;

|DEFBUCLE lee_lin;
#1#1;
;
#0#1 , "      ",  0;
#0#2 , "zzzzzz",999;
be;
NULL,pasa_lin;
|FIN;

|CALCULO imprime;
|SI sw = 0;
    sw = 1;
    repres  = #5#10;
    zona    = #5#0;
    swlin = 3;  ||Datos Representante
    |PRINT;
    swlin = 0;
    swlin = 2;  ||Datos Zona
    |PRINT;
    swlin = 0;
|FINSI;

|SI sw = 1;

    |SI repres ! #5#10;
        swlin = 1;   ||Totales Zona
        |PRINT;
        swlin = 0;
        swlin = 4;   ||Totales Representante
        |PRINT;
        swlin = 0;
        |PIEINF;
        repres  = #5#10;
        zona    = #5#0;
        swlin = 3;   ||Datos Representante
        |PRINT;
        swlin = 0;
        swlin = 2;   ||Datos Zona
        |PRINT;
        swlin = 0;
        t1 = 0;
        t2 = 0;
        t3 = 0;
        t4 = 0;
        t5 = 0;
        t6 = 0;

        tr1 = 0;
        tr2 = 0;
        tr3 = 0;
        tr4 = 0;
        tr5 = 0;
        tr6 = 0;

    |FINSI;

    |SI zona ! #5#0;
        swlin = 1;  ||Totales Zona
        |PRINT;
        swlin = 0;
        zona = #5#0;
        swlin = 2;  ||Datos Zona
        |PRINT;
        swlin = 0;
        t1 = 0;
        t2 = 0;
        t3 = 0;
        t4 = 0;
        t5 = 0;
        t6 = 0;
    |FINSI;

|FINSI;

t1 = t1 + #5#4;
t2 = t2 + #5#5;
t3 = t3 + #5#6;
t4 = t4 + #5#7;
t5 = (t4 / t1) * 100;
t6 = t3 / t2;

tr1 = tr1 + #5#4;
tr2 = tr2 + #5#5;
tr3 = tr3 + #5#6;
tr4 = tr4 + #5#7;
tr5 = (tr4 / tr1) * 100;
tr6 = tr3 / tr2;

tt1 = tt1 + #5#4;
tt2 = tt2 + #5#5;
tt3 = tt3 + #5#6;
tt4 = tt4 + #5#7;
tt5 = (tt4 / tt1) * 100;
tt6 = tt3 / tt2;

|PRINT;
|FCAL;

|DEFBUCLE impresion;
#5#1;
;
"  " , "   " , "      ";
"zz" , "zzz" , "zzzzzz";
be;
NULL,NULL,NULL,NULL,NULL,imprime;
#5#10,#5#0,#5#3,#5#1;
|FIN;

|CALCULO alba0017;|TIPO 3;
|SI #0#5 = "SI";|O #0#5 = "si";
    |HAZ CreaTempo; |NOME_DAT #5 Tempo;
    |DELINDEX #5;
    |IMPRE 0;
    |SI FSalida = 0;
        |INFOR informe;
        |SI FSalida = 0;
            |BUCLE lee_lin;
            |BUCLE impresion;
            swlin = 1;  ||Totales Zona
            |PRINT;
            swlin = 0;
            swlin = 4;  ||Totales Representante
            |PRINT;
            swlin = 0;
            |PIEINF;
            swlin = 10;
            |PIEINF;
            swlin = 0;
        |FINSI;
        |FININF;
    |FINSI;
    |FINIMP;
    |HAZ BoraTempo; |DELINDEX #5;
|FINSI;
|FCAL;

|CALCULO solcob;
|C_M #0#13, 1, "N";
|C_M #0#14, 1, "N";
|SI #0#0 = "S";
    |C_M #0#13, 1, "S";
    |C_M #0#14, 1, "S";
|FINSI;
|FCAL;
