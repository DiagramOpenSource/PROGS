|FICHEROS;
     golis002 #0;
     gomantho #10;       ||Expedientes CAB.
     gomantl1 #11;       ||Expedientes LIN.
     gopre001 #21;       ||Presupuestos
     gopartia #22;
     gocercab #23;
     gocerlin #24;
|FIN;

|VARIABLES;
     aInforme  = "";
     aInformes = "golis0s2"
     aInformec = "golis0c2";
     aInformeo = "golis0o2";
     nEje      = 0;
     &enEje    = 0;
     &enGGBI   = 0;
     &enSub    = 0;
     &enCer    = 0;
     nHay      = 0;
     nPor      = 0;
     nSw0      = 0;
     nSw1      = 0;
     nTotal    = 0;
     n31       = 0;
     n32       = 0;
     n33       = 0;
     nDescuen  = 0;
|FIN;


|PROCESO CalcuTot;
     nDescuen = enCer % #21#43;
     enCer = enCer - nDescuen;
     n31 = enCer % #21#26;
     n32 = enCer % #21#27;
     enCer = enCer + n31 + n32;
     n33 = enCer % #21#28;
     enCer = enCer - n33;
|FPRC;

|PROCESO gopartia;
     enEje = enEje + (#22#23 * #22#10);
     nEje = nEje + (#22#23 * #22#10);
|FPRC;

|DEFBUCLE gopartia;
     #22#3;
     ;
     #10#0, #10#1, #11#3, #11#4, "                    ", "                    ";
     #10#0, #10#1, #11#3, #11#4, "zzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, gopartia;
|FIN;

|PROCESO gocerlin;
     |SI #24#15 ! 0;
          enCer = enCer + #24#15;
     |SINO;
          enCer = enCer + #24#6;
     |FINSI;
|FPRC;

|PROCESO gomantl1;
     nSw0 = 0;
     |SI #0#14 = "S"; |Y #11#10 = "C"; nSw0 = 1; |FINSI;
     |SI #0#15 = "S"; |Y #11#10 = "P"; nSw0 = 1; |FINSI;
     |SI #0#16 = "S"; |Y #11#10 = "T"; nSw0 = 1; |FINSI;
     |SI #0#17 = "S"; |Y #11#10 = "E"; nSw0 = 1; |FINSI;
     |SI nSw0 = 1;
          nSw1 = 1;
          #gocercab#0 = #gomantl1#3;
          #gocercab#1 = #gomantl1#4;
          |LEE 000#gocercab.=;
          |SI FSalida = 0;
               |BUCLELIN 2 gocerlin #23;
          |FINSI;

          |DDEFECTO #gopre001;
          #gopre001#0 = #gomantl1#3;
          #gopre001#1 = #gomantl1#4;
          |LEE 000#gopre001.=;
          |SI FSalida = 0;
               nPor = #gopre001#26 + #gopre001#27;
               |SI nPor = 0;
                    nPor = 19;
               |FINSI;

               |HAZ CalcuTot;
          |SINO;
               nPor = 19;
          |FINSI;
          nEje = 0;
          |BUCLE gopartia;

          enGGBI = enGGBI + (nEje % nPor);
     |FINSI;
|FPRC;

|PROCESO gomantho;
     enEje = 0; enGGBI = 0; enSub = 0; enCer = 0; nSw1 = 0;
     |BUCLELIN 2 gomantl1 #10;
     |SI nSw1 ! 0;
          enSub = enEje + enGGBI;
          |PRINT;
          nHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE gomantho_s;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, gomantho;
|FIN;

|DEFBUCLE gomantho_c;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, NULL, NULL, NULL, NULL, gomantho, NULL, NULL;
     #gomantho#2;
|FIN;

|DEFBUCLE gomantho_o;
     #gomantho#1;
     2, 30, 24, 25;
     #golis002#1, #golis002#3, #golis002#5, #golis002#7, #golis002#9, #golis002#11;
     #golis002#2, #golis002#4, #golis002#6, #golis002#8, #golis002#10, #golis002#12;
     ;
     NULL, NULL, NULL, NULL, NULL, gomantho, NULL, NULL;
     #gomantho#30;
|FIN;

|PROCESO Inicio;
     |SI #0#13 = "S"; aInforme = aInformes; |FINSI;
     |SI #0#13 = "C"; aInforme = aInformec; |FINSI;
     |SI #0#13 = "O"; aInforme = aInformeo; |FINSI;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida ! 0;
               aInforme = "0000No existe informe:" + aInforme;
               |MENAV aInforme;
          |SINO;
               |ABRE #21;
               |ABRE #23;
               |SI #0#13 = "S"; |BUCLE gomantho_s; |FINSI;
               |SI #0#13 = "C"; |BUCLE gomantho_c; |FINSI;
               |SI #0#13 = "O"; |BUCLE gomantho_o; |FINSI;
               |CIERRA #21;
               |CIERRA #23;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;


|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
          |HAZ Inicio;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
