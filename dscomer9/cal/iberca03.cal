|FICHEROS;
     iberca01 #1;
     iberca02 #2;
     iberca03 #3;
     iberca04 #4;
     iberca05 #5,MANTE;
|FIN;

|VARIABLES;
      nModo    = 0;

     &eaTipo   = "";
     &enCodigo = 0;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 1;  |O FSalida = 7;
         |SI #3#3 ! 100;
             |MENAV "     La suma de porcentajes no suman 100.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI FSalida ! 10;  |ACABA;  |FINSI;

     eaTipo = #3#1;
     |SUB_EJECUTA_NP "iberca01";

     #4#2 = enCodigo;   |PINTA #4#2;
     |ERROR;
     |PTEC 802;
|FPRC;

|PROCESO Grabalo;
     |DDEFECTO #5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = #4#2;
     #5#3 = #2#2;
     #5#4 = #2#3;
     #5#5 = 0;
     |GRABA 020#5n;
     |LIBERA #5;
|FPRC;

|DEFBUCLE iberca02;
     #2#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     be;
     NULL, Grabalo;
|FIN;

|PROCESO Borralo;
     |BORRA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE iberca05;
     #5#1;
     ;
     #4#0, #4#1, #4#2, 01;
     #4#0, #4#1, #4#2, 99;
     be;
     NULL, Borralo;
|FIN;

|RUTINA ClaveBaja5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = #4#2;
     #5#3 = 01;
|FRUT;

|RUTINA ClaveAlta5;
     #5#0 = #4#0;
     #5#1 = #4#1;
     #5#2 = #4#2;
     #5#3 = 99;
|FRUT;

|PROCESO Tipo11ca5;  |TIPO 11;
     |SI FSalida = 1;  |O FSalida = 7;
         |SI #4#6 ! 100;
             |MENAV "     La suma de porcentajes no suman 100.";
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo2ca5;  |TIPO 2;
     #4#6 = #4#6 +. #5#5;
     |PINTA 2274, #4#6;
|FPRC;

|PROCESO Desglose;
     |SI #4#4 = "S";
         |PINTA 2274, #4#6;
         |ENTLINEAL #1#5, -4, nModo, 20, 0, ClaveBaja5, ClaveAlta5;
     |SINO;
         |BUCLE iberca05;
     |FINSI;
|FPRC;

|PROCESO LeeControl;  |TIPO 0;
     |ABRE #1;
     #1#0 = #3#1;
     #1#1 = #4#2;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "      No existe Codigo de Control de Calidad";
         |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO PintaCampos;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;  |ACABA;  |FINSI;

     #4#3 = #1#2;   |PINTA #4#3;
     #4#4 = #1#3;   |PINTA #4#4;

     |ABRE #5;
     |BUCLE iberca02;
     |CIERRA #5;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |PINTA 2274, #4#6;
     |ENTLINEAL #1#5, -4, 7, 20, 0, ClaveBaja5, ClaveAlta5;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     #3#3 = #3#3 +. #4#5;
     |PINTA #3#3;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE iberca05;
|FPRC;

|PROCESO SinBarra;  |TIPO 5;
     FSalida = "SINBARRA";
|FPRC;
