|FICHEROS;
     orts0006 #0;
     orts0007 #7; ||Tmp
     ortsm008 #8;
     ortsm020 #20;
     agifa019 #19;
     agifa049 #49;
     agifa073 #73;
     agifa104 #104;
     ortsm019 #119;
|FIN;

|VARIABLES;
     aAlfa = "";
     nSw = 0;
|FIN;

|PROCESO LinEscan;
     |SI nSw = 3;
          |DDEFECTO #7;
          #7#0 = #73#28;
          #7#1 = #73#0;
          #7#2 = #73#1;
          #7#6 = #49#3;
          |LEE 101#7=;
          |SI FSalida ! 0; |GRABA 020#7b; |FINSI;

          #7#3 = #49#7;

          #119#0 = #73#2;
          |LEE 000#119=;
          |SI FSalida = 0;
               |SI #119#2 = "S";
                   #20#0 = #49#0;
                   #20#1 = #49#1;
                   |LEE 000#20=;
                   |SI FSalida = 0;
                        #7#3 = #20#16;
                   |FINSI;
              |FINSI;
          |FINSI;

          #7#7 = #7#5 + (#73#5 * #49#12);

          #7#4 = #73#2;
          #7#5 = #73#4;
          #7#8 = #8#3;
          #7#9 = #8#4;
          |GRABA 020#7a;
          |LIBERA #7;
     |SINO;
          |SI nSw = 0; nSw = 1; |FINSI;
          |SI #49#10 = 4; nSw = 2; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE LinEscan;
     #49#1;
     ;
     #73#2, 001;
     #73#2, 999;
     ;
     NULL, LinEscan;
|FIN;

|PROCESO GraTmp;
     |DDEFECTO #8;
     #8#0 = #73#28;
     #8#1 = #73#0;
     #8#2 = #73#1;
     |LEE 000#8=;

     nSw = 0;
     |BUCLE LinEscan;
     |SI nSw = 0; |O nSw = 1;
          |DDEFECTO #7;
          #7#0 = #73#28;
          #7#1 = #73#0;
          #7#2 = #73#1;

          #7#3 = #19#126;
          #7#6 = #73#4;
          #7#7 = #73#5;

          #7#4 = #73#2;
          #7#5 = #73#4;
          #7#8 = #8#3;
          #7#9 = #8#4;
          |GRABA 020#7n;
     |FINSI;
     |SI nSw = 2;
          nSw = 3;
          |BUCLE LinEscan;
     |FINSI;
|FPRC;

|PROCESO Pedidos;
     |SI #73#13 ] #0#2; |Y #73#13 [ #0#3;
          #19#0 = #73#2;
          |LEE 000#19=;
          |SI FSalida = 0;
               |SI #19#126 ] #0#4; |Y #19#126 [ #0#5;
                    |SI #19#125 ] #0#10; |Y #19#125 [#0#11;
                         |SI #19#2 ] #0#12; |Y #19#2 [ #0#13;
                              |SI #19#3 ] #0#14; |Y #19#3 [ #0#15;
                                   |HAZ GraTmp;
                              |FINSI;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Pedidos;
     #104#1;
     1;
     #0#6, #0#8, #0#0;
     #0#7, #0#9, #0#1;
     ;
     NULL, NULL, Pedidos;
|FIN;

|PROCESO Tmp;
     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #7#2;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #7 aAlfa; |DELINDEX #7;

     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "orts0006";
          |SI FSalida = 0;
               |ABRE #7;
               |ABRE #19;
               |ABRE #119;
               |ABRE #20;
               |BUCLE Pedidos;
               |CIERRA #20;
               |CIERRA #119;
               |CIERRA #19;
               |CIERRA #7;
               |BUCLE Tmp;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #7;
|FPRC;
