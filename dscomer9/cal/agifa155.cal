|FICHEROS;
     agifa155 #0;
     agifa153 #1;
|FIN;

|VARIABLES;
     &enCambiCodi = 0;   || para la copia de empresas
     &stock = " ":
     &sust = " ";
     &CambDesc = "";
     &AltaArt  = "";
     &tabla = 0;
     &tipo = " ";
     programa = "";
     &barras = "";
     &eaMail = "";
|FIN;

|PROCESO inicio; |TIPO 3;
     enCambiCodi = 1;

     tabla = #0#1;
     sust = #0#3;
     stock = #0#6;
     barras = #0#7;
     CambDesc = #0#8;
     AltaArt  = #0#9;
     eaMail = #0#10; |QBF eaMail;

     |SI #0#0 = "SI"
          |SI #1#2 = "A";     ||Cambio El codigo de Articulo
               tipo = "A";
               programa = "agifa152.run";
          |FINSI;
          |SI #1#2 = "C";     ||Cambio El codigo de Cliente
               tipo = "C";
               programa = "agifa156.run";
          |FINSI;
          |SI #1#2 = "P";     ||Cambio el Codigo del proveedor
               tipo = "P";
               programa = "agifa157.run";
          |FINSI;
          |SI #1#2 = "R";     ||Representante
               tipo = "R";
               programa = "agifa158.run";
          |FINSI;
          |SI #1#2 = "F";     ||Familia
               tipo = "F";
               programa = "agifa159.run";
          |FINSI;
          |SI #1#2 = "S";     ||Subfamilia
               tipo = "S";
               programa = "agifa160.run";
          |FINSI;
          |SUB_EJECUTA_NP programa;
     |FINSI;

     enCambiCodi = 0;
|FPRC;

|PROCESO stock;
     |SI #0#3 = "S";
          |CAMPO_MODIFICA #0#6 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#6 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO SoloArticulos; |TIPO 0;
     |SI #1#2 ! "A";
          |CAMPO_MODIFICA #0#7 , 1 , "N";
          |CAMPO_MODIFICA #0#8 , 1 , "N";
          |CAMPO_MODIFICA #0#9 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#7 , 1 , "S";
          |CAMPO_MODIFICA #0#8 , 1 , "S";
          |CAMPO_MODIFICA #0#9 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO Avisa; |TIPO 0;
     |SI #0#3 = "S";|Y #0#9 = "N";
          |AVISO;
          |CONFI "0000NEsta seguro de que los articulos nuevos estan creados correctamente?";
          |SI FSalida ! 0;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;
