|FICHEROS;
     visez003 #0;
     visew001 #1; || Tmp
     visew002 #2; || Tmp
     gomantho #10;
     gomantl1 #11;
     agifa017 #17;
     agifa019 #19;
     visem001 #21;
     visem002 #22;
     visem003 #23;
     gopartia #100;
|FIN;

|VARIABLES;
     &Tempo = "";
     aTmp1 = "";
     aTmp2 = "";
     nSwOK = 0;
     nHay = 0;
     fFecha = @;
     aD = "";
     aH = "";
|FIN;

|PROCESO gopartia;
     #1#3 = #1#3 + #100#10;
|FPRC;

|DEFBUCLE gopartia;
     #100#3;
     20;
     #1#4, #1#5, "     ", 000001, aD, aD, #1#0;
     #1#4, #1#5, "zzzzz", 999999, aH, aH, #1#0;
     ;
     NULL, gopartia;
|FIN;

|PROCESO CargaEnviadas;
     |BUCLE gopartia;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE CargaEnviadas;
     #1#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, CargaEnviadas;
|FIN;

|PROCESO visem003;
     |DDEFECTO #1;
     #1#4 = #21#3;
     #1#5 = #21#7;
     #1#0 = #23#3;
     #1#1 = #23#24;
     |LEE 101#1=;
     |SI FSalida ! 0; |GRABA 020#1b; |FINSI;
     #1#2 = #1#2 + #23#6;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE visem003;
     #23#1;
     22, 24;
     #22#0, #22#1, 001, "01.01.0000", #0#0;
     #22#0, #22#1, 999, #0#6, #0#1;
     ;
     NULL, visem003;
|FIN;

|PROCESO visem002;
     |BUCLE visem003;
|FPRC;

|DEFBUCLE visem001;
     #21#2;
     ;
     #10#0, #10#1;
     #10#0, #10#1;
     ;
     NULL, NULL, visem002;
|FIN;

|PROCESO gomantho;
     |SI nSwOK = 1;
          |BUCLE visem001;
     |FINSI;
     nSwOK = 0;
|FPRC;

|PROCESO gomantl1;
     |SI #11#10 = "C";
          nSwOK = 1;
     |FINSI;
|FPRC;

|DEFBUCLE gomantho;
     #10#1;
     ;
     #0#2, #0#4;
     #0#3, #0#5;
     ;
     NULL, NULL, gomantl1, gomantho;
|FIN;

|PROCESO Tmp2;
     |DDEFECTO #19;
     #19#0 = #2#0;
     |LEE 000#19=;

     |DDEFECTO #17;
     #17#0 = #2#0;
     #17#1 = #2#1;
     |LEE 000#17=;
     |PRINT;
     nHay = 1;
|FPRC;

|DEFBUCLE Tmp2;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp2;
|FIN;

|PROCESO Tmp1;
     |DDEFECTO #2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     |LEE 101#2=;
     |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
     #2#2 = #2#2 + #1#2;
     #2#3 = #2#3 + #1#3;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE Tmp1;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp1;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo; |NOME_DAT #1Tempo; |DELINDEX #1; aTmp1 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #2Tempo; |DELINDEX #2; aTmp2 = Tempo;
     aD = " " * 20;
     aH = "z" * 20;
     fFecha = ~;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "visez003";
          |SI FSalida = 0;
               |MENSA "0000Calculado...";
               |ABRE #1;
               |BUCLE gomantho;
               |CIERRA #1;
               |BUCLE CargaEnviadas;
               |ABRE #19;
               |ABRE #17;
               |ABRE #2;
               |BUCLE Tmp1;
               |CIERRA #2;
               |BUCLE Tmp2;
               |CIERRA #17;
               |CIERRA #19;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               |MENAV "0000No existe informe 'visez003'";
          |FINSI;
          |FINIMP;
     |FINSI;
     Tempo = aTmp1; |DELINDEX #1; |HAZ BoraTempo;
     Tempo = aTmp2; |DELINDEX #2; |HAZ BoraTempo;
|FPRC;
