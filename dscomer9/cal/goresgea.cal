
|FICHEROS;
     goresgea #0;
     goresgeb #1;
     gopartca #2;
     gopartll #3;
     gotresob #4;
     gomatcab #5;
     gopre001 #6;
     goparame #12;
     gosubcoc #15;
     gosubpar #16;
     gopartia #17;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     &Tempo = "";
     aTmp4 = "";
     &cCodMonBase   = "";
     &cDesMonBase   = "";
     &cCodMonTrab   = "";
     &cDesMonTrab   = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;

     nModo          = 0;
     nHay           = 0;
     nEntra         = 0;
     cTrab          = "";
     cAlba          = "";
     cSubc          = "";
     cFich          = "";
|FIN;
-----------------------------------------------------------------------------
|PROCESO GraSubPar;
     |SI #16#9 [ 0; |ACABA; |FINSI;
     #4#17 = #4#17 + #16#11;                 ||Total Materiales Venta.
     #4#18 = #4#18 + #16#9;                  ||Total Materiales Coste.
     nHay = 1;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE GraSubPar;
     #16#1;
     ;                                          ||Campos Extras.
     #15#0, "                    ",   1;
     #15#0, "zzzzzzzzzzzzzzzzzzzz", 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, GraSubPar;
|FIN;
-------------------------------------------------------------------------------
|PROCESO TomaSubPar;
     |BUCLE GraSubPar;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE TomaSubc;
     #15#1;
     4,5;                                          ||Campos Extras.
          1, #1#3, #1#4;
     999999, #1#3, #1#4;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, TomaSubPar;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Subcontrata;
     |BUCLE TomaSubc;
|FPRC;
-------------------------------------------------------------------------------
|PROGRAMA;
     |HAZ CreaTempo; aTmp4 = Tempo;
     |NOME_DAT #4 aTmp4; |DELINDEX #4;

     |ABRE #12; |LEE 000#12p; |CIERRA #12;

     |CLS;
     |ABRE #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENCLAVE #0,4,0;
     |LEE 000#0=;

     |SI FSalida = 0;
          cCodMonTrab = #0#6;
          |HAZ MonBas;
          |HAZ Valores;
          |PINDA #0#0;
          |ENDATOS #4#0;
     |FINSI;


     Tempo = aTmp4; |HAZ BoraTempo; |DELINDEX #4;
|FPROG;
-----------------------------------------------------------------------------
|PROCESO Valores;
     |ABRE #12;
     #12#0 = "A";
     |LEE 000#12=;

     |SI FSalida = 0;
          cTrab = #12#3; cAlba = #12#1; cSubc = #12#29;
     |SINO;
          |MENAV "0000NO HAY PARAMETROS DEFINIDOS DE OBRAS";
          |ERROR;
          |ACABA;
     |FINSI;

     |DELINDEX #4;
     |ABRE #4;
     |DDEFECTO #4;
     |HAZ ParteTraba;
     |HAZ Materiales;
     |BUCLELIN 2 Subcontrata #0;

     #4#0 = #0#0;                  ||Expediente.
     #4#1 = #0#1;                  ||N§ Expediente.
     #4#6  = #4#2 + #4#4 + #4#17;            ||Total   Venta Pres.
     #4#7  = #4#3 + #4#5 + #4#18;            ||Total   Costo Pres.
     #4#8  = (#0#5/#4#14)*#4#15;             ||Dia Hoy Venta.
     #4#9  = (#0#10/#4#14)*#4#15;            ||Dia Hoy Costo.
     #4#10 = #4#6 - #4#8;                    ||Desviacion Moneda Venta.
     #4#11 = #4#7 - #4#9;                    ||Desviacion Moneda Costo.
     #4#12 = ((#4#10*100)/#0#5);             ||Desviacion % Venta.
     #4#13 = ((#4#11*100)/#0#10);            ||Desviacion % Costo.
     |GRABA 020#4c;
     |PINDA #0#4;

|FPRC;
-----------------------------------------------------------------------------
|PROCESO ParteTraba;

     |SI FSalida = 0;
          |BUCLELIN 2 Estimados #0;
     |FINSI;

     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = #0#1;
     |LEE 000#2=;

     |SI FSalida = 0;
          |BUCLELIN 2 SumaDias #2;
          #4#4 = #2#7;                  ||Total Venta M.O.
          #4#5 = #2#6;                  ||Total Coste M.O.
          #4#6 = #0#5;                  ||Total Expediente Venta.
          #4#7 = #0#10;                 ||Total Expediente Coste.
          nHay = 1;
     |FINSI;

     |CIERRA #2;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO SumaDias;
     #4#15 = #4#15 + 1;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Estimados;
     #4#14 = #4#14 + #1#15;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO MoneResu; |TIPO 13;
     nEntra = 0;
     cCodMonTrab = #0#6;
     |HAZ MonBas;

     |SI #12#141 = "O";
          |PINTA 702, "O.T.......:";
          |ATRI R; |PINTA 1215, "    O.E.            "; |ATRI 0;
          |ATRI R; |PINTA 1040, " O.E.       "; |ATRI 0;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Materiales;
     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = #0#1;
     |LEE 000#5=;

     |SI FSalida = 0;
          #4#2 = #5#14;                 ||Total Materiales Venta.
          #4#3 = #5#16;                 ||Total Materiales Coste.
          nHay = 1;
     |FINSI;

     |CIERRA #5;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO Cambia; |TIPO 7;
     |PINDA #0#4;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO PinLin; |TIPO 7;
     |ABRE #6;
     #6#0 = #1#3;
     #6#1 = #1#4;
     |LEE 000#6=;
     |SI FSalida = 0;
          #0#2 = #6#2;                           ||Codigo Cliente;
          #0#8 = #6#3;                           ||Nombre Cliente;
          |PINTA #0#2; |PINTA #0#8;
     |FINSI;
     |CIERRA #6;
|FPRC;
