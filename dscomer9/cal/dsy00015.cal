|FICHEROS;
     dsy00015 #0;
     agifa010 #10;
     agifa134 #134;
     agifa059 #59;
     dsw00104 #104;   ||Tmp
     dscam003@;
     dscam045@;
|FIN;

|VARIABLES;
     &enSw = 0;
     &Tempo = "";
     &eaReci = "";
     &enDoc = 0;
     &eaEstado = "";
     &eaDesEstado = "";
     &enImpo = 0;
     aAlfa = "";
     nEmp = 0;
     aBase = "";
     aTipo = "";
     aSer = "";
     nNum = 0;
     nHay = 0;
     aImpre = "";
     nPrimeFac = 0;
|FIN;

|PROCESO dscam003;
     eaReci = "S";
     |SI #0#16 = "F";
          |SI #dscam003@#14 < #0#6; |O #dscam003@#14 > #0#7; |ACABA; |FINSI;
     |SINO;
          |SI #dscam003@#14 < #0#14; |O #dscam003@#14 > #0#15; |ACABA; |FINSI;
     |FINSI;
     enDoc = #dscam003@#40;
     eaEstado = #dscam003@#14;
     eaDesEstado = #dscam003@#15;
     enImpo = #dscam003@#60;
     |SI enSw = 2; |PRINT; enSw = 3; |FINSI;
     nHay = 1;

     |SI aTipo = " " ; nPrimeFac = 1; |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE dscam003;
     #dscam003@#12006;
     69;
     aSer, nNum, 000, "01.01.0000", "            ", "      ", aTipo;
     aSer, nNum, 999, "31.12.9999", "zzzzzzzzzzzz", "zzzzzz", aTipo;
     ;
     NULL, dscam003;
|FIN;

|PROCESO dscam045;
     aAlfa = ("00000" + #dscam045@#6) % -105;
     aAlfa = aBase + "dscarter/fich/" + aAlfa + "/";
     |PATH_DAT #dscam003@#aAlfa#;
     |BUCLE dscam003;
|FPRC;

|DEFBUCLE dscam045;
     #dscam045@#1002;
     2;
     nEmp, 001, "V";
     nEmp, 999, "V";
     ;
     NULL, dscam045;
|FIN;

|PROCESO Tmp;
     |SI #104#1 ! 0;
          enSw = 1;
          #134#49 = #104#0;
          #134#0 = #104#1;
          |LEE 000#134=;
          |SI FSalida = 0;
               aSer = #134#49;
               nNum = #134#0;
               eaReci = "N";
               enDoc = 0;
               eaEstado = "";
               eaDesEstado = "";
               enImpo = 0;
               aTipo = " ";
               |BUCLE dscam045;
               |SI eaReci = "N"; |PRINT; nHay = 1; |FINSI;
          |FINSI;
     |FINSI;

     |SI nPrimeFac = 1;
          enSw = 2;
     |FINSI;
     #10#52 = #104#2;
     #10#0 = #104#3;
     |LEE 000#10=;
     |SI FSalida = 0;
          aSer = #10#52;
          nNum = #10#0;
          eaReci = "N";
          enDoc = 0;
          eaEstado = "";
          eaDesEstado = "";
          enImpo = 0;
          aTipo = "A";
          |BUCLE dscam045;
          |SI eaReci = "N";
               |SI nPrimeFac = 0; |Y enSw = 0; enSw = 2; |FINSI;
               |SI enSw = 2; |PRINT; enSw = 3; |FINSI;
               |PRINT; nHay = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #104#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO agifa059;
     #104#0 = #59#14;
     #104#1 = #59#0;
     #104#2 = #59#15;
     #104#3 = #59#2;
     |GRABA 000#104n;
|FPRC;

|DEFBUCLE agifa134;
     #134#1;
     1;
     #0#0, #0#2, #0#4;
     #0#1, #0#3, #0#5;
     ;
     NULL, NULL, agifa059;
|FIN;

|PROCESO agifa010;
     |SI #10#38 = "S";
          #134#49 = #10#53;
          #134#0 = #10#39;
          |LEE 000#134=;
          |SI FSalida = 0;
               |BUCLELIN 2 agifa059 #134;
          |SINO;         || esto no deberia de ocurrir
               #104#0 = "";
               #104#1 = 0;
               #104#2 = #10#52;
               #104#3 = #10#0;
               |GRABA 000#104n;
          |FINSI;
     |SINO;
          #104#0 = "";
          #104#1 = 0;
          #104#2 = #10#52;
          #104#3 = #10#0;
          |GRABA 000#104n;
     |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #10#1;
     1;
     #0#8, #0#10, #0#12;
     #0#9, #0#11, #0#13;
     ;
     NULL, agifa010;
|FIN;

|PROCESO Acota; |TIPO 0;
     |SI #0#16 = "F";
          |C_M #0#0, 1, "S";
          |C_M #0#1, 1, "S";
          |C_M #0#2, 1, "S";
          |C_M #0#3, 1, "S";
          |C_M #0#4, 1, "S";
          |C_M #0#5, 1, "S";
          |C_M #0#6, 1, "S";
          |C_M #0#7, 1, "S";
          |C_M #0#8, 1, "N";
          |C_M #0#9, 1, "N";
          |C_M #0#10, 1, "N";
          |C_M #0#11, 1, "N";
          |C_M #0#12, 1, "N";
          |C_M #0#13, 1, "N";
          |C_M #0#14, 1, "N";
          |C_M #0#15, 1, "N";
     |SINO;
          |C_M #0#0, 1, "N";
          |C_M #0#1, 1, "N";
          |C_M #0#2, 1, "N";
          |C_M #0#3, 1, "N";
          |C_M #0#4, 1, "N";
          |C_M #0#5, 1, "N";
          |C_M #0#6, 1, "N";
          |C_M #0#7, 1, "N";
          |C_M #0#8, 1, "S";
          |C_M #0#9, 1, "S";
          |C_M #0#10, 1, "S";
          |C_M #0#11, 1, "S";
          |C_M #0#12, 1, "S";
          |C_M #0#13, 1, "S";
          |C_M #0#14, 1, "S";
          |C_M #0#15, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |DFICE aAlfa; aAlfa = aAlfa % -205; nEmp = aAlfa;

     |DBASS aBase;
     aAlfa = aBase + "dscarter/def/dscam045"; |CARGA_DEF aAlfa, dscam045@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'dscam045'...";
          |ACABA;
     |FINSI;
     aAlfa = aBase + "dscarter/def/dscam003"; |CARGA_DEF aAlfa, dscam003@;
     |SI FSalida ! 0;
          |DESCARGA_DEF #dscam045@;
          |MENAV "0000Error al cargar 'dscam003'...";
          |ACABA;
     |FINSI;
     aAlfa = aBase + "dscarter/fich/";
     |PATH_DAT #dscam045@#aAlfa#;

     |HAZ CreaTempo;
     |NOME_DAT #104 Tempo; |DELINDEX #104; |ABRE #104;

     |IMPRE 0;
     |SI FSalida = 0;
          aImpre = Impresora;
          |INFOR "dsy00015";
          |SI FSalida = 0;
               |SI #0#16 = "F";
                    |BUCLE agifa134;
               |SINO;
                    |ABRE #134;
                    |BUCLE agifa010;
                    |CIERRA #134;
               |FINSI;
               |ABRE #134;
               |ABRE #10;
               |BUCLE Tmp;
               |CIERRA #10;
               |CIERRA #134;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'dsy00015'";
          |FINSI;
          |FINIMP;
     |FINSI;

     |CIERRA #104; |DELINDEX #104; |HAZ BoraTempo;

     |DESCARGA_DEF #dscam003@;
     |DESCARGA_DEF #dscam045@;
|FPRC;
