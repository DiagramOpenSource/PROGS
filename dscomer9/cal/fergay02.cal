|FICHEROS;
     fergay02 #0;
     fergam01 #1;
     fergam02 #2;
     fergaw05 #5; ||Tmp
     fergam06 #6;
     fergam08 #8;
     fergam10 #10;
     agifa024 #24;
     agifa073 #73;
     agifa104 #104;
|FIN;

|VARIABLES;
     aCli = "";
     fFecha = @;
     nMaqui1 = 0;
     nTotalTiempo = 0;
     nNume = 0;
     nTiempo = 0;
     nHora = 0;
     nMinu = 0;
     nHora1 = 0;
     nHora2 = 0;
     nMaqui = 0;
     aFecha = "";
     aHoraIni = "";
     aHoraFin = "";
     &Tempo = "";
     &eaMaquina = "";
     nTipo = 0;
     aHoraIniOrd = "";
     aHoraFinOrd = "";
|FIN;

|PROCESO Tmp;
     #24#0 = #5#0;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;

     #2#0 = #5#1;
     |LEE 000#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     |SI #5#2 = 1; eaMaquina = "Elaborados"; |FINSI;
     |SI #5#2 = 2; eaMaquina = "Armados"; |FINSI;
     |SI #5#2 = 4; eaMaquina = "Pilotes"; |FINSI;
     |SI #5#2 = 5; eaMaquina = "S/P"; |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE Tmp;
     #5#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Tiempo;
     nHora = (A\(aHoraIni % 102));
     nMinu = (A\(aHoraIni % 402));
     nHora1 = nHora * 60 + nMinu;

     nHora = (A\(aHoraFin % 102));
     nMinu = (A\(aHoraFin % 402));
     nHora2 = nHora * 60 + nMinu;

     |SI nHora2 < nHora1;
          nNume = ((24*60 - nHora1) + nHora2) / 60;
     |SINO;
          nNume = (nHora2 - nHora1) / 60;
     |FINSI;
     nTiempo = nTiempo + nNume;
|FPRC;

|PROCESO TiempoMaqui;
     |SI aFecha ! "";
          |HAZ Tiempo;
          nTotalTiempo = nTotalTiempo + nTiempo;
     |FINSI;
|FPRC;

|PROCESO fergam10;
     |SI #10#0 ! aFecha; |O #10#1 ! nMaqui;
          |HAZ TiempoMaqui;
          nTiempo = 0;
          aHoraIni = #10#3;
          aHoraFin = #10#4;
     |SINO;
          |SI #10#3 > aHoraFin;
               |HAZ Tiempo;
               aHoraIni = #10#3;
               aHoraFin = #10#4;
          |SINO;
               aHoraFin = #10#4;
          |FINSI;
     |FINSI;
     aFecha = #10#0;
     nMaqui = #10#1;
|FPRC;

|DEFBUCLE fergam010;
     #10#1;
     ;
     #8#3, #8#4,  0001, "        ";
     #8#3, #8#4,  9999, "zzzzzzzz";
     ;
     NULL, NULL, NULL, NULL, NULL, fergam10;
     #10#0, #10#1, #10#3, #10#4;
|FIN;

|PROCESO Orden;
     #6#0 = #8#0;
     |LEE 000#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;

     #104#25 = #6#2;
     #104#0 = #6#3;
     |LEE 000#104=;
     |SI FSalida ! 0; |DDEFECTO #104; |FINSI;
|FPRC;

|PROCESO fergam08;
     #6#0 = #8#0;
     |LEE 000#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;

     #104#25 = #6#2;
     #104#0 = #6#3;
     |LEE 000#104=;
     |SI FSalida ! 0; |DDEFECTO #104; |FINSI;

     |SI #104#4 < #0#2; |O #104#4 > #0#3; |ACABA; |FINSI;
     |SI #104#57 < #0#4; |O #104#57 > #0#5; |ACABA; |FINSI;

     #73#28 = #6#2;
     #73#0 = #6#3;
     #73#1 = 1;
     |LEE 000#73];
     |SI FSalida ! 0; |O #73#28 ! #6#2; |O #73#0 ! #6#3; |DDEFECTO #73; |FINSI;

     |SI #73#18 < #0#6; |O #73#18 > #0#7; |ACABA; |FINSI;

     #2#0 = #8#4;
     |LEE 000#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

     nTipo = 5;     || Sin
     |SI #2#2 = "S"; nTipo = 1; |FINSI;  ||Elaboracion
     |SI #2#3 = "S"; nTipo = 2; |FINSI;  ||Armado Kg
     |SI #2#4 = "S"; nTipo = 2; |FINSI;  ||Armado Puntos
     |SI #2#5 = "S"; nTipo = 4; |FINSI;  ||Pilotera


     |DDEFECTO #5;
     #5#0 = #104#4;
     #5#1 = #8#4;
     #5#2 = nTipo;
     |LEE 101#5=;
     |SI FSalida ! 0; |GRABA 020#5b; |FINSI;

     |SI fFecha ! #8#3; |O aCli ! #104#4; |O nMaqui1 ! #8#4;
               |O aHoraIniOrd ! #8#5; |O aHoraFinOrd ! #8#6;
          nTotalTiempo = 0;
          nTiempo = 0;
          aHoraIni = "";
          aHoraFin = "";
          |BUCLE fergam010;
          |HAZ TiempoMaqui;
          #5#3 = #5#3 + nTotalTiempo;

          fFecha = #8#3;
          aCli = #104#4;
          nMaqui1 = #8#4;
          aHoraIniOrd = #8#5;
          aHoraFinOrd = #8#6;
     |FINSI;

     |SI #2#4 ! "S";
          #5#4 = #5#4 + #8#9;
     |FINSI;
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE fergam08;
     #8#3;
     ;
     #0#0, 001;
     #0#1, 999;
     ;
     NULL, Orden, NULL, NULL, NULL, fergam08;
     #8#3, #104#4, #8#4, #8#5, #8#6;
|FIN;

|PROCESO T3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "fergay02";
          |SI FSalida = 0;
               |HAZ CreaTempo;
               |NOME_DAT #5 Tempo; |DELINDEX #5; |ABRE #5;

               |ABRE #104;
               |ABRE #73;
               |ABRE #6;
               |ABRE #2;
               |BUCLE fergam08;
               |CIERRA #2;
               |CIERRA #6;
               |CIERRA #73;
               |CIERRA #104;

               |LEE 000#5p;
               |SI FSalida = 0;
                    |ABRE #2;
                    |ABRE #24;
                    |BUCLE Tmp;
                    |CIERRA #24;
                    |CIERRA #2;
               |SINO;
                    |MENAV "0000Selecci¢n vacia...";
               |FINSI;

               |CIERRA #5; |HAZ BoraTempo; |DELINDEX #5;

               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "000Error en informe 'fergay02'...";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
