|FICHEROS;
   malpe800 #0;

   :/modelos/def/dsmom030  #100;
   :/contagen/def/cacuenta #101;
   :/contagen/def/camandia #102;
   :/contagen/def/canempre #103;
   :/contagen/def/calibros #104;
   :/contagen/def/anm00002 #105;
|FIN;

|VARIABLES;
   aAlfa  = "";
   aAlfa1 = "";

   nCalc  = 0;
   nTecla = 0;
|FIN;

|PROCESO Cacuenta_17;
|FPRC;
|PROCESO Cacuenta_16;
|FPRC;
|PROCESO Cacuenta_15;
|FPRC;

|PROCESO EmpresaC;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/fich/";
   |PATH_DAT #103#aAlfa#;
   |ABRE #canempre;
   |SI nTecla = 10;
      |SI Campo = 18; |O Campo = 21;
         nCalc = Campo + 1;
         #canempre#2 = #malpe800#Campo#;
         #canempre#3 = #malpe800#nCalc#;
      |FINSI;
      |SI Campo = 19; |O Campo = 22;
         nCalc = Campo - 1;
         #canempre#2 = #malpe800#nCalc#;
         #canempre#3 = #malpe800#Campo#;
      |FINSI;
      |LEE 000#canempre.];
      |CONSULTA_CLAVE #1#canempre;
      |SI Campo = 18; |O Campo = 21;
         #malpe800#Campo# = #canempre#2; |PINTA #malpe800#Campo#;
         #malpe800#nCalc# = #canempre#3; |PINTA #malpe800#nCalc#;
      |FINSI;
      |SI Campo = 19; |O Campo = 22;
         #malpe800#nCalc# = #canempre#2; |PINTA #malpe800#nCalc#;
         #malpe800#Campo# = #canempre#3; |PINTA #malpe800#Campo#;
      |FINSI;
      |ERROR;
   |FINSI;

   |SI Campo = 18; |O Campo = 21;
      nCalc = Campo + 1;
      #canempre#2 = #malpe800#Campo#;
      #canempre#3 = #malpe800#nCalc#;
   |FINSI;
   |SI Campo = 19; |O Campo = 22;
      nCalc = Campo - 1;
      #canempre#2 = #malpe800#nCalc#;
      #canempre#3 = #malpe800#Campo#;
   |FINSI;
   |LEE 000#canempre.=;
   |SI FSalida = 0;
      |SI Campo = 18; |O Campo = 21;
         #malpe800#Campo# = #canempre#2; |PINTA #malpe800#Campo#;
         nCalc = Campo + 1;
         #malpe800#nCalc# = #canempre#3; |PINTA #malpe800#nCalc#;
         nCalc = nCalc + 1;
         #malpe800#nCalc# = #canempre#1; |PINTA #malpe800#nCalc#;
      |FINSI;
      |SI Campo = 19; |O Campo = 22;
         nCalc = Campo - 1;
         #malpe800#nCalc# = #canempre#2; |PINTA #malpe800#nCalc#;
         #malpe800#Campo# = #canempre#3; |PINTA #malpe800#Campo#;
         nCalc = Campo + 1;
         #malpe800#nCalc# = #canempre#1; |PINTA #malpe800#nCalc#;
      |FINSI;
   |SINO;
      |SI Campo = 19; |O Campo = 22;
         |MENAV "    Empresa inexistente";
         |ERROR;
      |FINSI;
   |FINSI;

   |CIERRA #canempre;
|FPRC;

|PROCESO CuentaC;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/fich/" + (("00000" + #malpe800#18) % -105) + #malpe800#19 + "/";
   |PATH_DAT #101#aAlfa#;
   |ABRE #cacuenta;
   |SI nTecla = 10;
      #cacuenta#0 = #malpe800#Campo#;
      |LEE 000#cacuenta.];
      |CONSULTA_CLAVE #1#cacuenta;
      #malpe800#Campo# = #cacuenta#0;
      |ERROR;
   |FINSI;

   #cacuenta#0 = #malpe800#Campo#;
   |LEE 000#cacuenta.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      #malpe800#Campo# = #cacuenta#0; |PINTA #malpe800#Campo#;
      #malpe800#nCalc# = #cacuenta#2; |PINTA #malpe800#nCalc#;
   |SINO;
      |MENAV "    Cuenta inexistente";
      |ERROR;
   |FINSI;

   |CIERRA #cacuenta;
|FPRC;

|PROCESO ConceptosC;
   nTecla = FSalida;
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "modelos/fich/";
   |PATH_DAT #100#aAlfa#;
   |ABRE #dsmom030;
   |SI nTecla = 10;
      #dsmom030#0 = #malpe800#Campo#;
      |LEE 000#dsmom030.];
      |CONSULTA_CLAVE #1#dsmom030;
      #malpe800#Campo# = #dsmom030#0;
      |ERROR;
   |FINSI;

   #dsmom030#0 = #malpe800#Campo#;
   |LEE 000#dsmom030.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      #malpe800#Campo# = #dsmom030#0; |PINTA #malpe800#Campo#;
      #malpe800#nCalc# = #dsmom030#1; |PINTA #malpe800#nCalc#;
   |SINO;
      |MENAV "    Concepto inexistente";
      |ERROR;
   |FINSI;

   |CIERRA #dsmom030;
|FPRC;

|PROCESO LibrosC;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/fich/" + (("00000" + #malpe800#18) % -105) + #malpe800#19 + "/";
   |PATH_DAT #104#aAlfa#;
   |ABRE #calibros;
   |SI nTecla = 10;
      #calibros#0 = #malpe800#Campo#;
      |LEE 000#calibros.];
      |CONSULTA_CLAVE #1#calibros;
      #malpe800#Campo# = #calibros#0;
      |ERROR;
   |FINSI;

   #calibros#0 = #malpe800#Campo#;
   |LEE 000#calibros.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      #malpe800#Campo# = #calibros#0; |PINTA #malpe800#Campo#;
      #malpe800#nCalc# = #calibros#1; |PINTA #malpe800#nCalc#;
   |SINO;
      |MENAV "    Libro inexistente";
      |ERROR;
   |FINSI;

   |CIERRA #calibros;
|FPRC;

|PROCESO DiarioC;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/fich/" + (("00000" + #malpe800#18) % -105) + #malpe800#19 + "/";
   |PATH_DAT #102#aAlfa#;
   |ABRE #camandia;
   |SI nTecla = 10;
      #camandia#0 = #malpe800#Campo#;
      |LEE 000#camandia.];
      |CONSULTA_CLAVE #1#camandia;
      #malpe800#Campo# = #camandia#0;
      |ERROR;
   |FINSI;

   #camandia#0 = #malpe800#Campo#;
   |LEE 000#camandia.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      #malpe800#Campo# = #camandia#0; |PINTA #malpe800#Campo#;
      #malpe800#nCalc# = #camandia#1; |PINTA #malpe800#nCalc#;
   |SINO;
      |MENAV "    Libro inexistente";
      |ERROR;
   |FINSI;

   |CIERRA #camandia;
|FPRC;

|PROCESO GrupoAnalit;
   nTecla = FSalida;

   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/fich/" + (("00000" + #malpe800#18) % -105) + #malpe800#19 + "/";
   |PATH_DAT #105#aAlfa#;
   |ABRE #anm00002;
   |SI nTecla = 10;
      #anm00002#0 = #malpe800#Campo#;
      |LEE 000#anm00002.];
      |CONSULTA_CLAVE #1#anm00002;
      #malpe800#Campo# = #anm00002#0;
      |ERROR;
   |FINSI;

   #anm00002#0 = #malpe800#Campo#;
   |LEE 000#anm00002.=;
   |SI FSalida = 0;
      nCalc = Campo + 1;
      #malpe800#Campo# = #anm00002#0; |PINTA #malpe800#Campo#;
      #malpe800#nCalc# = #anm00002#1; |PINTA #malpe800#nCalc#;
   |SINO;
      |MENAV "    Grupo analitico inexistente";
      |ERROR;
   |FINSI;

   |CIERRA #anm00002;
|FPRC;

|PROGRAMA;
   |ABRE #malpe800;
   |LEE 000#malpe800.p;
   |SI FSalida ! 0;
      |DDEFECTO #malpe800;
      |GRABA 020#malpe800.c;
   |FINSI;

   |CLS;
   |CABEZA "Configuraci¢n enlaces facturas de transporte";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#malpe800.a;
   |FINSI;

   |CIERRA #malpe800;
|FPRO;
