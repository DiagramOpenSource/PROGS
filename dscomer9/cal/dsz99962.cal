|FICHEROS;
     gopartia #1;
     goalbpa1 #20,MANTE;
     gomantho #30;
     gomantl1 #31;
     gomatljn #40;
     agifa077 #77;
     goparame #100;
|FINSI;

|VARIABLES;
     &fFechaAlba = @;
     &cSeriePres = "";
     &nNumerPres = 0;
     &cSerieExpe = "";
     &nNumerExpe = 0;
     aAlfa = "";
     aSer = "";
     aNum = "";
     nLin = 0;
|FINS;

|PROCESO TotalGopartia;
     #40#9 = #40#9 + #1#14;
     #40#10 = #40#10 + #1#25;
     #40#11 = #40#11 + #1#13;
     #40#12 = #40#12 + #1#24;
|FPRC;

|DEFBUCLE TotalGopartia;
     #1#1;
     ;
     "M", #77#50, #77#0, 001, 001;
     "M", #77#50, #77#0, 999, 999;
     ;
     NULL, TotalGopartia;
|FIN;

|PROCESO gomatljn;
     |ABRE #40;
     |SELECT #4#40;
     #40#5 = #77#50;
     #40#6 = #77#0;
     |LEE 000#40=;
     |SI FSalida = 0; |ACABA; |FINSI;

     |SELECT #1#40;
     #40#0 = cSeriePres;
     #40#1 = nNumerPres;
     #40#2 = 9999;
     |LEE 000#40];
     |SI FSalida = 0;
          |LEE 000#40a;
     |SINO;
          |LEE 000#40u;
     |FINSI;
     |SI FSalida = 0; |Y #40#0 = cSeriePres; |Y #40#1 = nNumerPres;
          nLin = #40#2 + 1;
     |SINO;
          nLin = 1;
     |FINSI;

     |DDEFECTO #40;
     #40#0 = cSeriePres;
     #40#1 = nNumerPres;
     #40#2 = nLin;
     #40#3 = #77#1;
     #40#4 = #77#54;
     #40#5 = #77#50;
     #40#6 = #77#0;
     #40#7 = #77#3;
     #40#8 = #77#4;

     |BUCLE TotalGopartia;

     #40#14 = cSerieExpe;
     #40#15 = nNumerExpe;
     |GRABA 020#40n;
     |CIERRA #40;
|FPRC;

|PROCESO LinExpe;
     cSeriePres = #31#3;
     nNumerPres = #31#4;
     cSerieExpe = #31#0;
     nNumerExpe = #31#1;
     |ERROR10;
|FPRC;

|PROCESO ConAsignaAlb;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;

     cSeriePres = "";
     nNumerPres = 0;
     cSerieExpe = "";
     nNumerExpe = 0;
     |ABRE #30;
     #30#0 = aSer;
     #30#1 = 0;
     |LEE 000#30];
     |SI FSalida = 0; |Y #30#0 = aSer;
          |BUCLELIN 0 LinExpe #30;
     |FINSI;
     |CIERRA #30;

     |ABRE #77;
     #77#50 = aSer;
     #77#0 = aNum;
     |LEE 020#77=;
     |CIERRA #77;
     fFechaAlba = #77#1;

     |PUSHV 0101 2380;
     |CLS;
     |ABRE #20;
     |DDEFECTO #20;
     #20#0 = aSer;
     #20#1 = aNum;
     |GRABA 020#20b;
     |PTEC 815;
     |PINPA #0#20;
     |PINDA #0#20;
     |ENDATOS #1#20;
     |SI FSalida = 0;
          |ABRE #77;
          #77#50 = aSer;
          #77#0 = aNum;
          |LEE 121#77=;
          |SI FSalida = 0;
               #77#34 = "AS";
               |GRABA 020#77a;
               |HAZ gomatljn;
          |FINSI;
          |CIERRA #77;

          |GRABA 020#20a;
     |FINSI;
     |CIERRA #20;
     |POPV;
|FPRC;

|PROGRAMA;               || lo llama el 'agifa072'
     aAlfa = PARAMETRO;
     |QBF aAlfa;
     aSer = aAlfa % 105;
     aNum = aAlfa % 606;
     |HAZ ConAsignaAlb;
|FPRO;
