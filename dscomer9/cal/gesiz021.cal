|FICHEROS;
     gesim002 #2,MANTE;
     agifa019 #19;
     agifa024 #24;
     agifa112 #112;
|FIN;

|VARIABLES;
     aParam = "";
     aDocu = "";
     aMatri = "";
     aCliPrv = "";
     aFecha = "";
     aArti = "";
|FIN;

|PROGRAMA;
     aParam = PARAMETRO;
     aDocu = aParam % 102;
     aMatri = aParam % 330;
     aCliPrv = aParam % 3306;
     aFecha = aParam % 3910;
     aArti = aParam % 4920;

     |ABRE #19;
     #19#0 = aArti;
     |LEE 000#19=;
     |SI FSalida ! 0; |DDEFECTO #19; |FINSI;
     |CIERRA #19;

     |ABRE #24;
     #24#0 = aCliPrv;
     |LEE 000#24=;
     |SI FSalida ! 0; |DDEFECTO #24; |FINSI;
     |CIERRA #24;

     |ABRE #112;
     #112#0 = aCliPrv;
     |LEE 000#112=;
     |SI FSalida ! 0; |DDEFECTO #112; |FINSI;
     |CIERRA #112;

     |ABRE #2;
     #2#0 = aMatri;
     |GRABA 020#2b;
     |SI FSalida = 0;
          |VENTANA 0501, 3399, -1, 17, "Maquinas";
          |HAZ PushVenModal;

          |C_M #2#20, 1, "N";

          |C_M #2#2, 1, "N";
          |C_M #2#3, 1, "N";
          |C_M #2#4, 1, "N";
          |C_M #2#5, 1, "N";
          |C_M #2#25, 1, "N";
          |C_M #2#19, 1, "N";

          |C_M #2#6, 1, "N";
          |C_M #2#7, 1, "N";
          |C_M #2#8, 1, "N";
          |C_M #2#12, 1, "N";
          |C_M #2#15, 1, "N";
          |C_M #2#16, 1, "N";
          |C_M #2#9, 1, "N";
          |C_M #2#17, 1, "N";
          |C_M #2#18, 1, "N";
          |C_M #2#21, 1, "N";
          |C_M #2#26, 1, "N";
          |C_M #2#27, 1, "N";
          |C_M #2#10, 1, "N";
          |C_M #2#11, 1, "N";

          #2#12 = "01.01.0000";
          |SI aDocu = "PC"; |O aDocu = "AC"; |O aDocu = "EV";
               #2#20 = #19#0;
               #2#2 = #112#0;
               #2#3 = #112#1;
               #2#4 = aFecha;
               #2#8 = "01.01.0000";
          |FINSI;
          |SI aDocu = "RE";
               #2#20 = #19#0;
               #2#4 = "01.01.0000";
               #2#8 = "01.01.0000";
          |FINSI;
          |SI aDocu = "AV"; |O aDocu = "AJ"; |O aDocu = "FD";
               #2#20 = #19#0;
               #2#6 = #24#0;
               #2#7 = #24#1;
               #2#8 = aFecha;
               #2#4 = "01.01.0000";
               #2#21 = #24#17;
               #2#26 = #24#196;
               #2#27 = #24#197;
               #2#10 = #24#25;
               #2#11 = #24#26;
          |FINSI;

          |PINPA #0#2
          |PINDA #0#2;
          |ENDATOS #1#2;
          |SI FSalida = 0;
               |GRABA 020#2a;
          |SINO;
               |BORRA 020#2c;
          |FINSI;
          |HAZ PopVenModal;
     |FINSI;
     |CIERRA #2;
     |PULSATECLA;
|FPRO;
