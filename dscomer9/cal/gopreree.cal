|FICHEROS;
     gopreree #0;
     gopre001 #1;
     gopre002 #2;
     gopre003 #3;
     gopre004 #4;
     agifa027 #8;
     agifa324 #9;
     gomedici #10;
     gopredu1 #11;
     gopredu2 #12;
     gopredu3 #13;
     gopredu4 #14;
     godupmed #15;
     goduprec #16;
     goduprel #17;
     godeprec #18;
     godeprel #19;
     gopre021 #21;
     gopre022 #22;
     gopre024 #24;
     gopre025 #25;
     goparame #100;
|FIN;
-----------------------------------------------------------------------------
|VARIABLES;
     &Tempo = "";
     aTmp11 = "";
     aTmp12 = "";
     aTmp13 = "";
     aTmp14 = "";
     aTmp16 = "";
     aTmp17 = "";
     aAlfa = "";
     nCampo = 0;
     &cCodMonBase   = "";
     &cCodMonTrab   = "";
     &cCodMonDe     = "";
     &cCodMonA      = "";
     &cCodMonConv   = "";
     &cCodMonActu   = "";
     &cDesMonBase   = "";
     &cDesMonTrab   = "";

     &nDeci_PBase   = 0;
     &nDeci_TBase   = 0;
     &nDeci_PTrab   = 0;
     &nDeci_TTrab   = 0;
     &nDeci_TotVis  = 0;
     &nEurComTrab   = 0;
     &nEurComBase   = 0;
     &nEurVenTrab   = 0;
     &nEurVenBase   = 0;
     &nPreComTrab   = 0;
     &nPreComBase   = 0;
     &nPreVenTrab   = 0;
     &nPreVenBase   = 0;
     &nPrecioComp   = 0;
     &nPrecioVent   = 0;
     &nDeci_Medi    = 0;
     &nDeci_Meda    = 0;
     &nDeci_Incr    = 0;


     nEuroExis      = 0;
     nEuroNuev      = 0;
     nPrecio        = 0;
     nImporte       = 0;
     nConta         = 0;

     cConta         = "";
     dVacio = "";
     hVacio = "";
|FIN;
------------------------------------------------------------------------------
|PROCESO Copia25;
     #25#21 = #0#3;
     #25#22 = #0#4;
     |GRABA 020#25n;
|FPRC;

|DEFBUCLE Copia25;
     #25#1;
     ;
     #0#1, #0#2, dVacio, dVacio, 000, dVacio, 001;
     #0#1, #0#2, hVacio, hVacio, 999, hVacio, 999;
     ;
     NULL, Copia25;
|FIN;

|PROCESO Copia24;
     #24#35 = #0#3;
     #24#36 = #0#4;
     |GRABA 020#24n;
|FPRC;

|DEFBUCLE Copia24;
     #24#1;
     ;
     #0#1, #0#2, dVacio, dVacio, 000, dVacio;
     #0#1, #0#2, hVacio, hVacio, 999, hVacio;
     ;
     NULL, Copia24;
|FIN;

|PROCESO Copia22;
     #22#0 = #0#3;
     #22#1 = #0#4;
     |GRABA 020#22n;
|FPRC;

|DEFBUCLE Copia22;
     #22#1;
     ;
     #0#1, #0#2, 001, 001;
     #0#1, #0#2, 999, 999;
     ;
     NULL, Copia22;
|FIN;

|PROCESO Copia21;
     #21#0 = #0#3;
     #21#1 = #0#4;
     |GRABA 020#21n;
|FPRC;

|DEFBUCLE Copia21;
     #21#1;
     ;
     #0#1, #0#2, 001;
     #0#1, #0#2, 999;
     ;
     NULL, Copia21;
|FIN;

|PROCESO GrabDesc;
     #14#0 = #0#3;
     #14#1 = #0#4;

     |PARA nConta = 2; |SI nConta [ 15; |HACIENDO nConta= nConta+1;
          #14nConta = #4nConta;
     |SIGUE;

     |GRABA 020#14c;
     #0#9 = "COPIANDO DESCOMPOSICION";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabDupDesc;
     nPrecio = #14#9 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#9 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #14#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#10 = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #14#11 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#11 = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #14#12 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #14#12 = nPrecio;                  ||IMPORTE COSTE.

     |PARA nConta = 0; |SI nConta [ 15; |HACIENDO nConta= nConta+1;
          #4nConta = #14nConta;
     |SIGUE;
     |GRABA 020#4c;
     #0#9 = "GRABANDO DESCOMPOSICION";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDesc;
     #4#1;
     ;
     #3#0, #3#1, #3#2, #3#4,   1;
     #3#0, #3#1, #3#2, #3#4, 999;
     ;
     NULL, GrabDesc;
|FIN;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupDesc;
     #14#1;
     ;
     #13#0, #13#1, #13#2, #13#4,   1;
     #13#0, #13#1, #13#2, #13#4, 999;
     ;
     NULL, GrabDupDesc;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabPart;
     |BUCLE EjecDesc;
     #13#0 = #0#3;
     #13#1 = #0#4;
     |PARA nConta = 2; |SI nConta [ 16; |HACIENDO nConta= nConta+1;
          #13nConta = #3nConta;
     |SIGUE;
     |GRABA 020#13c;
     #0#9 = "COPIANDO PARTIDA";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO DupliMedi;
     |DDEFECTO #15;
     #15#0 = #0#3;            || Serie presupuesto nuevo
     #15#1 = #0#4;            || Numero presupuesto nuevo
     #15#2 = #10#2;           || Capitulo
     #15#3 = #10#3;           || Partida
     #15#4 = #10#4;           || Linea
     |LEE 101#15=;

     |SI FSalida ! 0;
          #15#5 = #10#5;      || Unidades
          #15#6 = #10#6;      || Largo
          #15#7 = #10#7;      || Ancho
          #15#8 = #10#8;      || Alto
          #15#9 = #10#9;      || Parcial
          |GRABA 020#15n;
          |PARA nConta = 0; |SI nConta [ 9; |HACIENDO nConta = nConta + 1;
               #10nConta = #15nConta;
          |SIGUE;

          |GRABA 020#10n;
          |LIBERA #10;
     |FINSI;
     |LIBERA #15;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE Mediciones;
     #10#1;
     ;
     #0#1,#0#2,#3#2,#3#4,1;
     #0#1,#0#2,#3#2,#3#4,999;
     be;
     NULL,DupliMedi;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabDupPart;
     |BUCLE EjecDupDesc;
     nPrecio = #13#8 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#8 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #13#9  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#9  = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #13#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#10 = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #13#11 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #13#11 = nPrecio;                  ||IMPORTE COSTE.
     |PARA nConta = 0; |SI nConta [ 16; |HACIENDO nConta= nConta+1;
          #3nConta = #13nConta;
     |SIGUE;
     |GRABA 020#3c;
     #0#9 = "GRABANDO PARTIDA";
     |PINTA #0#9;
     |BUCLE Mediciones;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecPart;
     #3#1;
     ;
     #2#0, #2#1, #2#12,   1;
     #2#0, #2#1, #2#12, 999;
     ;
     NULL, GrabPart;
|FIN;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupPart;
     #13#1;
     ;
     #12#0, #12#1, #12#12,   1;
     #12#0, #12#1, #12#12, 999;
     ;
     NULL, GrabDupPart;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabCapi;
     |BUCLE EjecPart;
     #12#0 = #0#3;
     #12#1 = #0#4;
     |PARA nConta = 2; |SI nConta [ 13; |HACIENDO nConta= nConta+1;
          #12nConta = #2nConta;
     |SIGUE;
     |GRABA 020#12c;
     #0#9 = "COPIANDO CAPITULO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|PROCESO GrabDupCapi;
     |BUCLE EjecDupPart;
     nPrecio = #12#7 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#7 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #12#8  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#8  = nPrecio;                  ||PRECIO COSTE.
     nPrecio = #12#9  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#9  = nPrecio;                  ||IMPORTE VENTA.
     nPrecio = #12#10 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #12#10 = nPrecio;                  ||IMPORTE COSTE.
     |PARA nConta = 0; |SI nConta [ 13; |HACIENDO nConta= nConta+1;
          #2nConta = #12nConta;
     |SIGUE;
     |GRABA 020#2c;
     #0#9 = "GRABANDO CAPITULO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupCapi;
     #12#1;
     ;
     #11#0, #11#1,   1;
     #11#0, #11#1, 999;
     ;
     NULL, GrabDupCapi;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabDupPres;
     |BUCLE EjecDupCapi;
     |DDEFECTO #1;
     nPrecio = #11#5 / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #11#5 = nPrecio;                   ||PRECIO VENTA.
     nPrecio = #11#6  / nEuroExis;
     nPrecio = nPrecio * nEuroNuev;
     #11#6  = nPrecio;                  ||PRECIO COSTE.
     #1#0 = #11#0;
     #1#1 = #11#1;
     |LEE 000#1=;
     |SI FSalida = 0;
          |PARA nConta = 2; |SI nConta [ 39; |HACIENDO nConta= nConta+1;
               #1nConta = #11nConta;
               |SI nConta = 7;
                    #1nConta = #0#11;
               |FINSI;
               |SI nConta = 8;
                    #1nConta = #0#14;
               |FINSI;
               |SI nConta = 15; |O nConta = 17;
                    #1nConta = "       "
               |FINSI;
               |SI nConta = 16;
                    #1nConta = 0
               |FINSI;
          |SIGUE;
     |FINSI;
     |GRABA 020#1a;
     #0#9 = "GRABANDO PRESUPUESTO";
     |PINTA #0#9;
|FPRC;
------------------------------------------------------------------------------
|DEFBUCLE EjecDupPres;
     #11#1;
     ;
     #0#3, #0#4;
     #0#3, #0#4;
     ;
     NULL, GrabDupPres;
|FIN;
------------------------------------------------------------------------------
|PROCESO DesAmpLin;
     #19#1 = #0#3;
     #19#2 = #0#4;
     |GRABA 020#19n;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE DesAmpLin;
     #19#1;
     ;                                          ||Campos Extras.
     #18#0, #18#1, #18#2, #18#4,  1;
     #18#0, #18#1, #18#2, #18#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, DesAmpLin;
|FIN;
-------------------------------------------------------------------------------
|PROCESO DescAmpCab;
     |BUCLE DesAmpLin;
     #18#1 = #0#3;
     #18#2 = #0#4;
     |GRABA 020#18n;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE DescAmpCab;
     #18#1;
     ;                                          ||Campos Extras.
     "                    ", #0#1, #0#2, "                    ";
     "zzzzzzzzzzzzzzzzzzzz", #0#1, #0#2, "zzzzzzzzzzzzzzzzzzzz";
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, DescAmpCab;
|FIN;
-------------------------------------------------------------------------------
|PROCESO Duplica; |TIPO 3;
     dVacio = " " * 20;
     hVacio = "z" * 20;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     nDeci_Meda = #100#115;
     |HAZ CreaTempo; aTmp11 = Tempo;
     |HAZ CreaTempo; aTmp12 = Tempo;
     |HAZ CreaTempo; aTmp13 = Tempo;
     |HAZ CreaTempo; aTmp14 = Tempo;
     |HAZ CreaTempo; aTmp16 = Tempo;
     |HAZ CreaTempo; aTmp17 = Tempo;

     |NOME_DAT #11 aTmp11; |DELINDEX #11;
     |NOME_DAT #12 aTmp12; |DELINDEX #12;
     |NOME_DAT #13 aTmp13; |DELINDEX #13;
     |NOME_DAT #14 aTmp14; |DELINDEX #14;
     |NOME_DAT #16 aTmp16; |DELINDEX #16;
     |NOME_DAT #17 aTmp17; |DELINDEX #17;
     |DELINDEX #11;
     |DELINDEX #12;
     |DELINDEX #13;
     |DELINDEX #14;
     |DELINDEX #16;
     |DELINDEX #17;

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #4;
     |ABRE #10;
     |ABRE #11;
     |ABRE #12;
     |ABRE #13;
     |ABRE #14;
     |ABRE #15;
     |ABRE #16;
     |ABRE #17;
     |HAZ BorraReemp;
     #1#0 = #0#1;        ||Serie.
     #1#1 = #0#2;        ||Numero.
     |LEE 000#1=;

     |SI FSalida = 0;
          nDeci_Medi = #1#24;
          nDeci_Incr = #1#25;
          |BUCLELIN 0 GrabCapi #1;
          #11#0 = #0#3;
          #11#1 = #0#4;
          #11#2 = #0#5;
          #11#3 = #0#6;

          aAlfa = "|NC";
          aAlfa = #1#aAlfa#;
          nCampo = aAlfa;
          nCampo = nCampo - 1;
          |PARA nConta = 4; |SI nConta [ nCampo; |HACIENDO nConta= nConta+1;
               #11nConta = #1nConta;
          |SIGUE;

          |GRABA 020#11c;
          |BUCLE Copia21;
          |BUCLE Copia22;
          |BUCLE Copia24;
          |BUCLE Copia25;
          |BUCLE EjecDupPres;
          |BUCLE DescAmpCab;
     |FINSI;

     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;
     |CIERRA #11;
     |CIERRA #12;
     |CIERRA #13;
     |CIERRA #14;
     |CIERRA #15;
     |CIERRA #16;
     |CIERRA #17;
     |DELINDEX #11;
     |DELINDEX #12;
     |DELINDEX #13;
     |DELINDEX #14;
     |DELINDEX #16;
     |DELINDEX #17;
|FPRC;
------------------------------------------------------------------------------
|PROCESO BorraDesAmpLin;
     |BORRA 020#19a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraDesAmpLin;
     #19#1;
     ;                                          ||Campos Extras.
     #18#0, #18#1, #18#2, #18#4,  1;
     #18#0, #18#1, #18#2, #18#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraDesAmpLin;
|FIN;
-------------------------------------------------------------------------------
|PROCESO BorraDescAmpCab;
     |BUCLE BorraDesAmpLin;
     |BORRA 020#18a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraDescAmpCab;
     #18#1;
     ;                                          ||Campos Extras.
     "                    ", #0#3, #0#4, "                    ";
     "zzzzzzzzzzzzzzzzzzzz", #0#3, #0#4, "zzzzzzzzzzzzzzzzzzzz";
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraDescAmpCab;
|FIN;

|PROCESO Borra25;
     |BORRA 020#25a;
|FPRC;

|DEFBUCLE Borra25;
     #25#1;
     ;
     #0#3, #0#4, dVacio, dVacio, 000, dVacio, 001;
     #0#3, #0#4, hVacio, hVacio, 999, hVacio, 999;
     be;
     NULL, Borra25;
|FIN;

|PROCESO Borra24;
     |BORRA 020#24a;
|FPRC;

|DEFBUCLE Borra24;
     #24#1;
     ;
     #0#3, #0#4, dVacio, dVacio, 000, dVacio;
     #0#3, #0#4, hVacio, hVacio, 999, hVacio;
     be;
     NULL, Borra24;
|FIN;

|PROCESO Borra22;
     |BORRA 020#22a;
|FPRC;

|DEFBUCLE Borra22;
     #22#1;
     ;
     #0#3, #0#4, 001, 001;
     #0#3, #0#4, 999, 999;
     be;
     NULL, Borra22;
|FIN;

|PROCESO Borra21;
     |BORRA 020#21a;
|FPRC;

|DEFBUCLE Borra21;
     #21#1;
     ;
     #0#3, #0#4, 001;
     #0#3, #0#4, 999;
     be;
     NULL, Borra21;
|FIN;
-------------------------------------------------------------------------------
|PROCESO BorraReemp;
     #1#0 = #0#3;        ||Serie.
     #1#1 = #0#4;        ||Numero.
     |LEE 000#1=;

     |SI FSalida = 0;
          |BUCLELIN 0 BorraCapi #1;
          |BUCLE BorraDescAmpCab;
          |BUCLE Borra21;
          |BUCLE Borra22;
          |BUCLE Borra24;
          |BUCLE Borra25;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO BorraDesco;
     |BORRA 020#4a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraDesco;
     #4#1;
     ;                                          ||Campos Extras.
     #3#0, #3#1, #3#2, #3#4,   1;
     #3#0, #3#1, #3#2, #3#4, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraDesco;
|FIN;
-------------------------------------------------------------------------------
|PROCESO BorraMedi;
     |BORRA 020#10a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraMedi;
     #10#1;
     ;
     #3#0,#3#1,#3#2,#3#4,1;
     #3#0,#3#1,#3#2,#3#4,999;
     ;
     NULL,BorraMedi;
|FIN;
-------------------------------------------------------------------------------
|PROCESO BorraParti;
     |BUCLE BorraDesco;
     |BUCLE BorraMedi;
     |BORRA 020#3a;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE BorraParti;
     #3#1;
     ;                                          ||Campos Extras.
     #2#0, #2#1, #2#12,   1;
     #2#0, #2#1, #2#12, 999;
     ;                                          ||b/e Bolqueo-Ordenacion.
     NULL, BorraParti;
|FIN;
-------------------------------------------------------------------------------
|PROCESO BorraCapi;
     |BUCLE BorraParti;
     |BORRA 020#2a;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO MonedaS; |TIPO 0;
     |ABRE #9;
     #9#0 = #0#10;
     |LEE 000#9=;

     |SI FSalida = 0;
          nEuroExis = #9#2;        ||Valor Euro Existente.
     |FINSI;

     #9#0 = #0#11;
     |LEE 000#9=;

     |SI FSalida = 0;
          nEuroNuev = #9#2;        ||Valor Euro Nuevo.
          cCodMonTrab = #0#11;
          |HAZ MonBas;
     |FINSI;

     |SI #0#10 ! #0#11;
          |CONFI "0000SLA MONEDA DE TRABAJO ES DISTINTA.¨REALIZAR CONVERSION?";

          |SI FSalida = -1;
               |PTEC 807;
          |FINSI;

     |FINSI;

|FPRC;
------------------------------------------------------------------------------

|PROCESO Tipo13; |TIPO 13;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;

     |SI #100#141 = "O";
          |ATRI R; |PINTA 624, "ORDEN ENTRADA "; |ATRI 0;
          |PINTA 812, "O.E............:";
     |FINSI;
|FPRC;
