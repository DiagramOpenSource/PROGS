|FICHEROS;
   guerz208 #0;

   gopartia #10;
|FIN;

|VARIABLES;
   nPrecio = 0;
   nCalc   = 0;

   aSerie   = "";
   nDocum   = 0;
   nPrimero = 0;
   nLinea   = 0;
|FIN;

|PROCESO gopartia;
   |SI aSerie ! #gopartia#4; |O nDocum ! #gopartia#5;
      |SI nPrimero = 1;
         nPrimero = 0;
      |SINO;
         |SI nPrecio ] -0.0000001; |Y nPrecio [ 0.0000001; nPrecio = 0; |FINSI;

         |SI nPrecio ! 0;
            |SALVA_FICHA #gopartia;
            #gopartia#34 = "A";
            #gopartia#4  = aSerie;
            #gopartia#5  = nDocum;
            #gopartia#6  = nLinea;
            #gopartia#7  = 1;
            |LEE 000#gopartia.=;
            |SI FSalida = 0;
               #gopartia#6  = #gopartia#6 + 1;
               #gopartia#10 = 1;
               #gopartia#41 = nPrecio * -1;
               #gopartia#42 = 0; #gopartia#43 = 0; #gopartia#44 = 0;
               #gopartia#49 = nPrecio * -1;
               #gopartia#50 = 0; #gopartia#51 = 0; #gopartia#52 = 0;

               #gopartia#14 = #gopartia#10 * #gopartia#41;
               #gopartia#14 = #gopartia#14 < #gopartia#42;
               #gopartia#14 = #gopartia#14 < #gopartia#43;
               #gopartia#14 = #gopartia#14 < #gopartia#44;
               #gopartia#12 = #gopartia#14 / #gopartia#10;

               #gopartia#25 = #gopartia#10 * #gopartia#49;
               #gopartia#25 = #gopartia#25 < #gopartia#50;
               #gopartia#25 = #gopartia#25 < #gopartia#51;
               #gopartia#25 = #gopartia#25 < #gopartia#52;
               #gopartia#23 = #gopartia#25 / #gopartia#10;
               |GRABA 020#gopartia.n;
            |FINSI;
            |REPON_FICHA #gopartia;
         |FINSI;
      |FINSI;
      aSerie = #gopartia#4; nDocum = #gopartia#5;
      nPrecio = 0;
   |FINSI;

   nLinea = #gopartia#6;
   nCalc = #gopartia#14; nCalc = nCalc ! 2;
   nPrecio = nPrecio + nCalc;
|FPRC;

|DEFBUCLE gopartia;
#gopartia#1;
;
"A", "     ", 000001, 001, 001;
"A", "zzzzz", 999999, 999, 999;
;
NULL,gopartia;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA " Recalculo regularizacion precios ";
   |PINPA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0; |Y #0#0 = "S";
      nPrimero = 1; |BUCLE gopartia;
   |FINSI;
|FPRO;
