|FICHEROS;
     inmoz010 #0;
     inmow004 #4,MANTE;
     inmom008 #8;
     inmow006 #6;
|FIN;

|VARIABLES;
     i = 0;
     aAlfa = "";
     nLinea = 0;
     aExpe = "";
     aCB = "";
     nXls = 0;
|FIN;

|PROCESO PinCampos;
     |PARA i = 0; |SI i [ 13; |HACIENDO i = i + 1;
          |PINTA #4i;
     |SIGUE;
|FPRC;

|PROCESO ActTmp;
     |PARA i = 0; |SI i [ 6; |HACIENDO i = i + 1;
          #4i = #8i;
     |SIGUE;
     #4#8 = #8#7;
     #4#9 = #8#11;
     #4#10 = #8#12;
     #4#11 = #8#13;
     #4#12 = #8#14;
     #4#13 = #8#15;
     |GRABA 020#4a;
|FPRC

|PROCESO Tecla; |TIPO 0;
     |SI #4Campo = Contenido; |Y FSalida = 0;
          |ABRE #8;
          #8#0 = #4#0;
          #8#1 = #4#1;
          #8#2 = #4#2;
          |LEE 121#8=;
          |SI FSalida = 0;
               aExpe = #8#0;
               aCB = #8#1;
               nXls = #8#2;
               |PARA i = 0; |SI i [ 7; |HACIENDO i = i + 1;
                    #6i = #8i;
               |SIGUE;
               |PARA i = 11; |SI i [ 15; |HACIENDO i = i + 1;
                    #6i = #8i;
               |SIGUE;
               |PUSHV 0501 2380;
               |PINPA #0#6;
               |PINDA #0#6;
               |ENDATOS #1#6;
               |SI FSalida = 0;
                    |SI #6#0 = #8#0; |Y #6#1 = #8#1; |Y #6#2 = #8#2;
                         |PARA i = 0; |SI i [ 7; |HACIENDO i = i + 1;
                              #8i = #6i;
                         |SIGUE;
                         |PARA i = 11; |SI i [ 15; |HACIENDO i = i + 1;
                              #8i = #6i;
                         |SIGUE;
                         |GRABA 020#8a;
                         |HAZ ActTmp;
                    |SINO;
                         |PARA i = 0; |SI i [ 7; |HACIENDO i = i + 1;
                              #8i = #6i;
                         |SIGUE;
                         |PARA i = 11; |SI i [ 15; |HACIENDO i = i + 1;
                              #8i = #6i;
                         |SIGUE;
                         |GRABA 000#8n;
                         |SI FSalida = 100;
                              |MENAV "0000Registro existente....";
                         |SINO;
                              |HAZ ActTmp;
                              #8#0 = aExpe;
                              #8#1 = aCB;
                              #8#2 = nXls;
                              |BORRA 020#8c;
                         |FINSI;
                    |FINSI;
               |FINSI;
               |POPV;
               |HAZ PinCampos;
          |FINSI;
          |CIERRA #8;
     |FINSI;
|FPRC;

|PROCESO Min;
     #4#7 = 1;
|FPRC;

|PROCESO Max;
     #4#7 = 99999;
|FPRC;

|PROCESO inmom008;
     nLinea = nLinea + 1;
     |PARA i = 0; |SI i [ 6; |HACIENDO i = i + 1;
          #4i = #8i;
     |SIGUE;
     #4#7 = nLinea;
     #4#8 = #8#7;
     #4#9 = #8#11;
     #4#10 = #8#12;
     #4#11 = #8#13;
     #4#12 = #8#14;
     #4#13 = #8#15;
     |GRABA 020#4n;
|FPRC;

|DEFBUCLE inmom008;
     #8#1;
     ;
     #0#0, "                    ", 0;
     #0#0, "zzzzzzzzzzzzzzzzzzzz", 99999
     ;
     NULL, inmom008;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #4 aAlfa; |DELINDEX #4;

     |ABRE #4;
     |BUCLE inmom008;
     |CIERRA #4;

     |SI i = 0;
          |MENAV "0000No hay registros";
     |SINO;
          |ENTLINEAL #1#4, 1, 4, 19, 1, Min, Max;
     |FINSI;

     |DELINDEX #4;
|FPRC;
