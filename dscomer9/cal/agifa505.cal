|FICHEROS;
     agifa505  #0;
     agifa204  #1;
     agifa142  #142;
|FIN;

|VARIABLES;
     aAlfa = "";
     cam = 0;
     err = 0;

     alfa = "";
     alf1 = "";
     clave_ant = "";
     nu1 = 0;
     nu2 = 0;
     i = 0;
     mensa = "";
     nSwDs_suite = 0;
|FINSI;

|PROCESO Campo109; |TIPO 0;
     |SI #0Campo ! Contenido;
          #0#157 = #0#109;
          |PINTA #0#157;
     |FINSI;
|FPRC;

|PROCESO ModiDoble; |TIPO 7;
     |ABRE #142; |LEE 000#142=; |CIERRA #142;
     aAlfa = #142#117;
     |C_M #0#126, 1, aAlfa;
     |C_M #0#127, 1, aAlfa;
     |C_M #0#138, 1, aAlfa;
     |C_M #0#131, 1, aAlfa;
     |C_M #0#130, 1, aAlfa;
     |C_M #0#135, 1, aAlfa;
     |C_M #0#136, 1, aAlfa;
     |C_M #0#137, 1, aAlfa;
|FPRC;

|PROCESO CbCompo; |TIPO 0;
     aAlfa = #0#148;
     |C_M #0#149, 1, aAlfa;
     |C_M #0#150, 1, aAlfa;
     |C_M #0#151, 1, aAlfa;
     |C_M #0#152, 1, aAlfa;
     |C_M #0#158, 1, aAlfa;
     |C_M #0#159, 1, aAlfa;
     |C_M #0#160, 1, aAlfa;
     |C_M #0#161, 1, aAlfa;
     |C_M #0#162, 1, aAlfa;
     |C_M #0#164, 1, aAlfa;
     |C_M #0#169, 1, aAlfa;
     |C_M #0#170, 1, aAlfa;
|FPRC;

|PROCESO funcion;
     |SI FSalida = 12;   ||Se ha pulsado F4
          |PUSHV 1418 1847;
          |CAMPO_MODIFICA #0#59, 1 , "S";
          |CAMPO_MODIFICA #0#60, 1 , "S";
          |CAMPO_MODIFICA #0#63, 1 , "S";
          |CAMPO_VISUAL #0#59, 1 , "S";
          |CAMPO_VISUAL #0#60, 1 , "S";
          |CAMPO_VISUAL #0#63, 1 , "S";
          |CAMPO_POSICION #0#59 , 1 , 1541;
          |CAMPO_POSICION #0#60 , 1 , 1641;
          |CAMPO_POSICION #0#63 , 1 , 1741;

          |CUADRO 14 18 18 47;
          |BLANCO 15 19 17 46;
          |PINTA 1520 ,"Control Estadistico ";
          |PINTA 1620 ,"Porcentaje......... ";
          |PINTA 1720 ,"Saltar Numero Fra.. ";


          |PINTA #0#59;
          |PINTA #0#60;
          |PINTA #0#63;

          |ET encampo1;
          |ENCAMPO #59#0;
          |ET encampo2;
          |ENCAMPO #60#0;
          |SI FSalida = 2; |VETE encampo1; |FINSI;
          |ENCAMPO #63#0;
          |SI FSalida = 2; |VETE encampo2; |FINSI;
          |POPV;

          |CAMPO_MODIFICA #0#59, 1 , "N";
          |CAMPO_MODIFICA #0#60, 1 , "N";
          |CAMPO_MODIFICA #0#63, 1 , "N";
          |CAMPO_VISUAL #0#59, 1 , "N";
          |CAMPO_VISUAL #0#60, 1 , "N";
          |CAMPO_VISUAL #0#63, 1 , "N";

          |ERROR;
     |FINSI;
|FPRC;

************************** Comprobacion de las secuencias de Escape
|VARIABLES;
     traba = "";
     trab1 = "";
     trab2 = "";
     trab3 = "";
     nume = 0;
     num1 = 0;
     num2 = 0;
     x = 0;
     y = 0;
|FIN;

|PROCESO comprueba;
     |SI Campo = 28; |Y #0#142 = "P"; |ACABA; |FINSI;

  traba = #0Campo;
  |QBF traba;
  trab1 = traba % 0;
  nume = trab1;
  |PARA x = 1;  |SI x [ nume; |HACIENDO x = x + 1;
        num1 = (100 *  x) + 1;
        trab2 = num1;
        trab1 = traba % trab2;
        num2 = 0;
        |SI trab1 = "\";
            |HAZ escapes;
        |FINSI;
        |SI num2 ! 0;
            |MENAV "     N£mero incongruente en secuencias de ESCAPE";
            |ERROR;
            |SAL;
        |FINSI;
  |SIGUE;
|FPRC;

|PROCESO escapes;
  trab3 = "":
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 = num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 = num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab3 + trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 =  num1;
  trab1 = traba % trab2;
  |SI trab1 = "\";
      |ACABA;
  |FINSI;
  |SI trab1 < "0";  |O trab1 > "9";
      num2 = 1;
      |ACABA;
  |FINSI;
  trab3 = trab3 + trab1;
  x = x + 1;
  num1 = (100 * x) + 1;
  trab2 =  num1;
  trab1 = traba % trab2;
  |SI trab1 ! "\";
      |ACABA;
  |FINSI;
  |SI trab3 > "255";
      num2 = 1;
  |FINSI;
|FPRC;

|PROCESO pos; |TIPO 0;
     err = 0;
     |SI #0#69 ! 0; |Y #0#72 ! 0; |Y #0#70 > #0#73;
          err = 1;
     |FINSI;
     |SI #0#72 ! 0; |Y #0#75 ! 0; |Y #0#73 > #0#76;
          err = 1;
     |FINSI;
     |SI #0#75 ! 0; |Y #0#78 ! 0; |Y #0#76 > #0#79;
          err = 1;
     |FINSI;
     |SI #0#78 ! 0; |Y #0#81 ! 0; |Y #0#79 > #0#82;
          err = 1;
     |FINSI;
     |SI err = 1;
          |MENAV "0000La posicion debe ser ascendente";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO camp; |TIPO 0;
     cam = Campo - 3;
     |SI #0cam = 0; |Y #0Campo ! 0;
          |MENAV "0000Defina el campo en la linea anterior";
          |ERROR;
     |FINSI;
|FPRC;

-----
|PROCESO LaClave;
     |BLIN 24;
     |PINTA 2420, mensa;
     alfa = "";
     E_sup = 10;
     E_inf = "";
     alfa = 2439 ? -1;
     #0#153 = alfa;
     |BLIN 24;
     nu2 = 0;
     |PARA i = 101; |SI i [ 1100; |HACIENDO i = i + 100;
          alf1 = alfa % i;
          nu1 = &alf1 * i;    || Encripta la clave
          nu2 = nu2 + nu1;
     |SIGUE;
     alfa = nu2;
     |QBF alfa;
|FPRC;

|PROCESO clave_ne; |TIPO 0;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #0#95 = "S";
          |MENSA "0000CLAVE PARA UNIDADES EN NEGATIVO";
          |SI #0#96 = "          ";
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               #0#96 = alfa;
               mensa = "Confirme la clave:";
               |HAZ LaClave;
               alf1 = #0#96; |QBF alf1;
               |SI alf1 ! alfa;
                    |MENAV "0000Clave incorrecta...";
                    #0#96 = "";
                    #0#95 = "N"; |PINTA #0#95;
               |FINSI;
          |SINO;
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               alf1 = #0#96; |QBF alf1;
               |SI alfa ! alf1;
                    |MENAV "0000Clave incorrecta...";
               |SINO;
                    |CONFI "2400NDesea modificar la clave S/N.: ";
                    |SI FSalida = 0;
                         clave_ant = #0#96;
                         mensa = "Nueva clave......:";
                         |HAZ LaClave;
                         #0#96 = alfa;
                         mensa = "Confirme la clave:";
                         |HAZ LaClave;
                         alf1 = #0#96; |QBF alf1;
                         |SI alf1 ! alfa;
                              |MENAV "0000Clave incorrecta, no hay cambio...";
                              #0#96 = clave_ant;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          |SI Contenido ! #0Campo;
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               alf1 = #0#96; |QBF alf1;
               |SI alf1 ! alfa;
                    |MENAV "0000Clave incorrecta...";
                    #0#95 = "S"; |PINTA #0#95;
               |SINO;
                    #0#96 = "";
               |FINSI;
          |FINSI;
          |BLIN 4;
     |FINSI;
|FPRC;

|PROCESO clave_dto; |TIPO 0;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #0#113 = "S";
          |MENSA "0000CLAVE PARA DESCUENTO";
          |SI #0#114 = "          ";
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               #0#114 = alfa;
               mensa = "Confirme la clave:";
               |HAZ LaClave;
               alf1 = #0#114; |QBF alf1;
               |SI alf1 ! alfa;
                    |MENAV "0000Clave incorrecta...";
                    #0#114 = "";
                    #0#113 = "N"; |PINTA #0#113;
               |FINSI;
          |SINO;
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               alf1 = #0#114; |QBF alf1;
               |SI alfa ! alf1;
                    |MENAV "0000Clave incorrecta...";
               |SINO;
                    |CONFI "2400NDesea modificar la clave S/N.: ";
                    |SI FSalida = 0;
                         clave_ant = #0#114;
                         mensa = "Nueva clave......:";
                         |HAZ LaClave;
                         #0#114 = alfa;
                         mensa = "Confirme la clave:";
                         |HAZ LaClave;
                         alf1 = #0#114; |QBF alf1;
                         |SI alf1 ! alfa;
                              |MENAV "0000Clave incorrecta, no hay cambio...";
                              #0#114 = clave_ant;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          |SI Contenido ! #0Campo;
               mensa = "Entre la clave...:";
               |HAZ LaClave;
               alf1 = #0#114; |QBF alf1;
               |SI alf1 ! alfa;
                    |MENAV "0000Clave incorrecta...";
                    #0#113 = "S"; |PINTA #0#113;
               |SINO;
                    #0#114 = "";
               |FINSI;
          |FINSI;
          |BLIN 4;
     |FINSI;
|FPRC;
-----------------------------
|PROCESO tari; |TIPO 7;
     alfa = #0#97;
     |C_M #0#98, 1, alfa;
|FPRC;

|PROCESO CajaTipo14; |TIPO 14;
     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida = 0;
          |ATRI N;
          aAlfa = #1#10; |QBF aAlfa;
          aAlfa = (aAlfa + "...............") % 115;
          |PINTA 1115, aAlfa;
          |ATRI I;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Tipo14_127; |TIPO 14;
     |HAZ EsDs_suite;
     nSwDs_suite = FSalida;
     |HAZ EsPalmHotel;
     |SI FSalida = 0; |O nSwDs_suite = 0;
          |C_V #0#182, 1, "S";
          |ATRI 0;
          |PINTA 2207, "Path Envio Hotel:";
          |ATRI I;
     |FINSI;
|FPRC;
