|FICHEROS;
     sctrz083 #0;
     sctrw024 #1; || Tmp Informes
     sctrm003 #3;
     sctrm005 #5;
     sctrm007 #7;
     sctrm010 #10;
     sctrm012 #12;
     sctrm017 #17;
     sctrm028 #28;
     sctrm050 #50;
     sctrm052 #52;
     sctrm053 #53;
     sctrm057 #57;
     sctrm062 #62;
     sctrm067 #67;
     sctrm001 #100;
|FIN;

|VARIABLES;
     &enPantaLogo = 0;
     &eaNomLogo = "";
     &eaPobOrg = "";
     &eaPobDes = "";
     &eaSentido = "";
     &eaSentidoM = "";
     &enSwViaje = 0;
     &enTipo = 0;
     &eaLis1 = "";
     &eaLis2 = "";
     &eaLis3 = "";
     &eaLis4 = "";
     &eaLis5 = "";
     &eaLis6 = "";
     &eaLis7 = "";
     &eaLis8 = "";
     &eaLis9 = "";
     &eaLis10 = "";
     &eaLis11 = "";
     &eaLis12 = "";
     &eaLis13 = "";
     &eaLis14 = "";
     &eaLis15 = "";
     &eaLis16 = "";
     &eaLis17 = "";
     &eaLis18 = "";
     &eaLis19 = "";
     &eaLis20 = "";
     &eaLis21 = "";
     &eaLis22 = "";
     &eaLis23 = "";
     &eaLis24 = "";
     &Tempo = "";
     nPanta = 0;
     fHoy = @;
     aAlfa = "";
     aTmp1 = "";
     nRango = 0;
     nGrid = 0;
     aFDesde = "";
     aFHasta = "";
     f = @;
     nEje = 0;
     nDMes = 0;
     nHMes = 0;
     aVerde = "";
     aMarca = "";
     i = 0;
     nHay = 0;
|FIN;

|PROCESO sctrm050;
     #3#0 = #50#23;
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     eaPobOrg = #3#1;

     #3#0 = #50#24;
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     eaPobDes = #3#1;

     #28#0 = #50#9;
     |LEE 000#28=;
     |SI FSalida ! 0; |DDEFECTO #28; |FINSI;

     #10#0 = #28#16;
     |LEE 000#10=;
     |SI FSalida ! 0; |DDEFECTO #10; |FINSI;
/*
Para probar el 21, 22 y 23

                    #50#35 = 1;    || acota 2015 a 2015
                    #50#45 = "S";
*/

     |PRINT;
|FPRC;

|DEFBUCLE sctrm050;
     #50#1;
     ;
     aFDesde, 0000;
     aFHasta, 9999;
     ;
     NULL, sctrm050;
|FIN;

|PROCESO sctrm052IdaVuelta;
     #12#0 = #52#75;
     |LEE 000#12=;
     |SI FSalida ! 0; |DDEFECTO #12; |FINSI;

     #3#0 = #52#8;  || Pob.Org
     |LEE 000#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     #5#0 = #3#3;
     |LEE 000#5=;
     |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

     eaSentido = #5#9;
     eaSentidoM = #5#10;

     |PRINT;
|FPRC;

|DEFBUCLE sctrm052Vuelta;
     #52#3;
     ;
     aFDesde, 000000, 0000000;
     aFHasta, 999999, 9999999;
     ;
     NULL, sctrm052IdaVuelta;
|FIN;

|DEFBUCLE sctrm052Ida;
     #52#2;
     ;
     aFDesde, 000000, 0000000;
     aFHasta, 999999, 9999999;
     ;
     NULL, sctrm052IdaVuelta;
|FIN;

|PROCESO sctrm052;
     #53#0 = #52#0;
     #53#1 = 1;
     |LEE 000#53=;
     |SI FSalida ! 0; |DDEFECTO #53; |FINSI;

     #7#0 = #53#7;
     |LEE 000#7=;
     |SI FSalida ! 0; |DDEFECTO #7; |FINSI;

     #17#0 = #52#96;
     #17#2 = #53#7;
     #17#4 = #53#8;
     |LEE 000#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE sctrm052;
     #52#2;
     ;
     aFDesde, 000000, 0000000;
     aFHasta, 999999, 9999999;
     ;
     NULL, sctrm052;
|FIN;

|PROCESO sctrm067;
     |PRINT;
|FPRC;

|DEFBUCLE sctrm067;
     #67#2;
     ;
     aFDesde, "   ";
     aFHasta, "zzz";
     ;
     NULL, sctrm067;
|FIN;

|PROCESO sctrm062;
     #10#0 = #62#0;
     |LEE 000#10=;
     |SI FSalida ! 0; |DDEFECTO #10; |FINSI;

     |SI #0#4 = "P";
          nHay = 0;
          |PARA i = 7; |SI i [ 16; |HACIENDO i = i + 1;
               |SI #62#15 = #0i;
                    nHay = 1; |SAL;
               |FINSI;
          |SIGUE;
          |SI nHay = 0; |ACABA; |FINSI;
     |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE sctrm062;
     #62#1;
     ;
     nEje, nDMes, "   ", #0#5;
     nEje, nHMes, "zzz", #0#6;
     ;
     NULL, sctrm062;
|FIN;

|PROCESO Informes;
     |SI eaLis1 = "S"; |O eaLis2 = "S"; |O eaLis3 = "S"; |O eaLis4 = "S";
               |O eaLis5 = "S"; |O eaLis6 = "S"; |O eaLis7 = "S"; |O eaLis8 = "S";
               |O eaLis11 = "S"; |O eaLis12 = "S"; |O eaLis13 = "S";
          enTipo = 1;
          nDMes = #0#0;
          nHMes = #0#1;
          |ABRE #10;
          nEje  = #0#2; |BUCLE sctrm062;
          nEje  = #0#3; |BUCLE sctrm062;
          |CIERRA #10;
     |FINSI;

     |SI eaLis9 = "S";
          enTipo = 2;
          nEje = #0#2; |HAZ Limites;
          |BUCLE sctrm067;
          nEje = #0#3; |HAZ Limites;
          |BUCLE sctrm067;
     |FINSI;

     |SI eaLis10 = "S";
          enTipo = 3;
          |ABRE #53;
          |ABRE #17;
          |ABRE #7;
          nEje = #0#2; |HAZ Limites;
          |BUCLE sctrm052;
          nEje = #0#3; |HAZ Limites;
          |BUCLE sctrm052;
          |CIERRA #7;
          |CIERRA #17;
          |CIERRA #53;
     |FINSI;

     |SI eaLis14 = "S"; |O eaLis15 = "S"; |O eaLis16 = "S";
               |O eaLis17 = "S"; |O eaLis18 = "S";
               |O eaLis19 = "S"; |O eaLis20 = "S";
          enTipo = 4;
          |ABRE #12;
          |ABRE #5;
          |ABRE #3;
          enSwViaje = 1;
          nEje = #0#2; |HAZ Limites;
          |BUCLE sctrm052Ida;
          nEje = #0#3; |HAZ Limites;
          |BUCLE sctrm052Ida;

          enSwViaje = 2;
          nEje = #0#2; |HAZ Limites;
          |BUCLE sctrm052Vuelta;
          nEje = #0#3; |HAZ Limites;
          |BUCLE sctrm052Vuelta;
          |CIERRA #3;
          |CIERRA #5;
          |CIERRA #12;
     |FINSI;

     |SI eaLis21 = "S"; |O eaLis22 = "S"; |O eaLis23 = "S";
          enTipo = 5;
          |ABRE #3;
          |ABRE #10;
          nEje = #0#2; |HAZ Limites;
          |BUCLE sctrm050;
          nEje = #0#3; |HAZ Limites;
          |BUCLE sctrm050;
          |CIERRA #10;
          |CIERRA #3;
     |FINSI;
|FPRC;

|PROCESO Limites;
     aFDesde = "01." + (("00" + #0#0)%-102) + "." + (("0000" + nEje)%-104);
     aFHasta = "01." + (("00" + #0#1)%-102) + "." + (("0000" + nEje)%-104);
     |PARA f = aFHasta; |SI; |HACIENDO f = f + 1;
          aAlfa = f % 402;
          |SI aAlfa ! #0#1; |SAL; |FINSI;
          aFHasta = f;
     |SIGUE;
|FPRC;

|PROCESO T3; |TIPO 3;
     nHay = 0;
     |LEE 000#1p;
     |PARA; |SI FSalida = 0; |HACIENDO;
          |SI #1#1 = "*"; nHay = 1; |FINSI;
          |SI #1#0 = 1; |SI #1#1 = "*"; eaLis1 = "S"; |SINO; eaLis1 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 2; |SI #1#1 = "*"; eaLis2 = "S"; |SINO; eaLis2 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 3; |SI #1#1 = "*"; eaLis3 = "S"; |SINO; eaLis3 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 4; |SI #1#1 = "*"; eaLis4 = "S"; |SINO; eaLis4 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 5; |SI #1#1 = "*"; eaLis5 = "S"; |SINO; eaLis5 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 6; |SI #1#1 = "*"; eaLis6 = "S"; |SINO; eaLis6 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 7; |SI #1#1 = "*"; eaLis7 = "S"; |SINO; eaLis7 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 8; |SI #1#1 = "*"; eaLis8 = "S"; |SINO; eaLis8 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 9; |SI #1#1 = "*"; eaLis9 = "S"; |SINO; eaLis9 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 10; |SI #1#1 = "*"; eaLis10 = "S"; |SINO; eaLis10 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 11; |SI #1#1 = "*"; eaLis11 = "S"; |SINO; eaLis11 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 12; |SI #1#1 = "*"; eaLis12 = "S"; |SINO; eaLis12 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 13; |SI #1#1 = "*"; eaLis13 = "S"; |SINO; eaLis13 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 14; |SI #1#1 = "*"; eaLis14 = "S"; |SINO; eaLis14 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 15; |SI #1#1 = "*"; eaLis15 = "S"; |SINO; eaLis15 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 16; |SI #1#1 = "*"; eaLis16 = "S"; |SINO; eaLis16 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 17; |SI #1#1 = "*"; eaLis17 = "S"; |SINO; eaLis17 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 18; |SI #1#1 = "*"; eaLis18 = "S"; |SINO; eaLis18 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 19; |SI #1#1 = "*"; eaLis19 = "S"; |SINO; eaLis19 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 20; |SI #1#1 = "*"; eaLis20 = "S"; |SINO; eaLis20 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 21; |SI #1#1 = "*"; eaLis21 = "S"; |SINO; eaLis21 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 22; |SI #1#1 = "*"; eaLis22 = "S"; |SINO; eaLis22 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 23; |SI #1#1 = "*"; eaLis23 = "S"; |SINO; eaLis23 = "N"; |FINSI; |FINSI;
          |SI #1#0 = 24; |SI #1#1 = "*"; eaLis24 = "S"; |SINO; eaLis24 = "N"; |FINSI; |FINSI;
          |LEE 000#1s;
     |SIGUE;

     |SI nHay ! 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0
               aAlfa = #57#22; |QBF aAlfa;
               |INFOR aAlfa;
               |SI FSalida = 0;
                    |HAZ Informes;
                    |PIEINF;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe:" + aAlfa;
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO EvtLis;
     |SI FSalida = 1; |O FSalida = 2;
          |SELECT #1#1;
          |LEE 000#1=;
     |FINSI;
     |SI FSalida = 4;
          |SI #1#1 = " ";
               #1#1 = "*";
               #1#3 = aVerde;
          |SINO;
               #1#1 = "";
               #1#3 = "";
          |FINSI;
          |GRABA 020#1a;
          |REFRESCACONTROL nGrid;
     |FINSI;
|FPRC;

|PROCESO BtnMarca;
     |SALVA_FICHA #1;
     |LEE 000#1p;
     |SI #1#1 = "*"; aMarca = ""; |SINO; aMarca = "*"; |FINSI;
     |PARA; |SI FSalida = 0; |HACIENDO;
          #1#1 = aMarca;
          |SI aMarca = "*";
               #1#3 = aVerde;
          |SINO;
               #1#3 = "";
          |FINSI;
          |GRABA 020#1a;
          |LEE 000#1s;
     |SIGUE;
     |REPON_FICHA #1;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO LinParri; |TIPO 0;
     |SI #0#4 = "P";
          #0#5 = 0;
          #0#6 = 999;
          |C_M #0#5, 1, "N"; |PINTA #0#5;
          |C_M #0#6, 1, "N"; |PINTA #0#6;
          |PARA i = 7; |SI i [ 16; |HACIENDO i = i + 1;
               |C_M #0i, 1, "S"; |PINTA #0i;
          |SIGUE;
     |SINO;
          |C_M #0#5, 1, "S"; |PINTA #0#5;
          |C_M #0#6, 1, "S"; |PINTA #0#6;
          |PARA i = 7; |SI i [ 16; |HACIENDO i = i + 1;
               |C_M #0i, 1, "N"; |PINTA #0i;
          |SIGUE;
     |FINSI;
|FPRC;

|PROGRAMA;
     aVerde = "24,106,29;255,255,255";

     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |ABRE #57; |LEE 000#57p; |CIERRA #57;
     |PINPA #0#0; nPanta = FSalida;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;

     fHoy = ~;
     aAlfa = fHoy % 402; #0#0 = aAlfa; #0#1 = aAlfa;
     aAlfa = fHoy % 704; #0#3 = aAlfa; #0#2 = #0#3 - 1;
     |HAZ CreaTempo; |NOME_DAT #1 Tempo; |DELINDEX #1; aTmp1 = Tempo; |ABRE #1;

     #1#0 = 1; #1#2 = "Socios Mensual";           |GRABA 020#1n;
     #1#0 = 2; #1#2 = "Socios Acumulado";         |GRABA 020#1n;
     #1#0 = 3; #1#2 = "General Mensual";          |GRABA 020#1n;
     #1#0 = 4; #1#2 = "General Acumulado";        |GRABA 020#1n;
     #1#0 = 5; #1#2 = "Kilometros Socios";        |GRABA 020#1n;
     #1#0 = 6; #1#2 = "N§ Viajes Socios";         |GRABA 020#1n;
     #1#0 = 7; #1#2 = "N§ Viajeros Socios";       |GRABA 020#1n;
     #1#0 = 8; #1#2 = "Ingresos Brutos Socios";   |GRABA 020#1n;
     #1#0 = 9; #1#2 = "Desglose Costes Socios";   |GRABA 020#1n;
     #1#0 = 10; #1#2 = "Reservas Por Tipo Tarifas";    |GRABA 020#1n;
     #1#0 = 11; #1#2 = "C lculo de Saldos por Socio";  |GRABA 020#1n;
     #1#0 = 12; #1#2 = "Reparto de Kilometros del Mes"; |GRABA 020#1n;
     #1#0 = 13; #1#2 = "Reparto de Kilometros del A¤o"; |GRABA 020#1n;
     #1#0 = 14; #1#2 = "Pax Lista - Origenes / Destinos Viajeros"; |GRABA 020#1n;
     #1#0 = 15; #1#2 = "Resumen Poblaciones seg£n sentido Norte/Sur"; |GRABA 020#1n;
     #1#0 = 16; #1#2 = "Resumen Poblaciones seg£n sentido Sur/Norte"; |GRABA 020#1n;
     #1#0 = 17; #1#2 = "Resumen Poblaciones seg£n sentido Norte/Sur con Vuelta"; |GRABA 020#1n;
     #1#0 = 18; #1#2 = "Resumen Poblaciones seg£n sentido Sur/Norte con Vuelta"; |GRABA 020#1n;
     #1#0 = 19; #1#2 = "Lista Viajeros Intercambiador Ida"; |GRABA 020#1n;
     #1#0 = 20; #1#2 = "Lista Viajeros Intercambiador Vuelta"; |GRABA 020#1n;
     #1#0 = 21; #1#2 = "Ocupaci¢n por D¡a"; |GRABA 020#1n;
     #1#0 = 22; #1#2 = "Relaci¢n de Viajes"; |GRABA 020#1n;
     #1#0 = 23; #1#2 = "Estadistica Kilometros Realizados seg£n Socio Veh¡culo"; |GRABA 020#1n;

     |LEE 000#1p;
     |PINPA #0#0; nPanta = FSalida;
     |PINDA #0#0;
     |CONTROL_SIMPLE nPanta, "BOTON,{{137}}Marca/Desmarcar todos", 1475, 1498, BtnMarca;
     nRango = 4 + 8 + 16 + 32;
     |LINEAL_SIMPLE #1#1, nRango, 1502, 2998, NULL, NULL, EvtLis;
     nGrid = FSalida;
     |ENDATOS #1#0;
     |CIERRA #1; |DELINDEX #1; Tempo = aTmp1; |HAZ BoraTempo;
|FPRO;
