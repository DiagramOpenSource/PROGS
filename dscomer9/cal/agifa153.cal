|FICHEROS;
     agifa153 #0;

     agifa019 #10;
     agifa154 #11;
     agifa168 #12;
|FIN;


|VARIABLES;
     &Tempo = "";
     aTmp168 = "";
     modo   = 0;
     nLinea = 0;

     aAlfa = "";
     aDArt = "";
     aHArt = "";
     aCArt = "";
|FIN;

|PROCESO tipos;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 2;
          |CAMPO_MODIFICA #0#2 , 1 , "N";
     |SINO;
          |CAMPO_MODIFICA #0#2 , 1 , "S";
     |FINSI;
|FPRC;

|PROCESO tipo7; |TIPO 7;
|PUSHV 10461877;
|ATRI I;
|CUADRO 10 46 18 77;
|ATRI R;
||            123456789012345678901234567890;
|PINTA 1147, " - POSIBLES TIPOS DE CAMBIO - ";
|PINTA 1247, " (A)  Articulos               ";
|PINTA 1347, " (C)  Clientes                ";
|PINTA 1447, " (P)  Proveedores             ";
|PINTA 1547, " (R)  Representantes          ";
|PINTA 1647, " (F)  Familias                ";
|PINTA 1747, " (S)  Subfamilias             ";
|ATRI 0;
|FPRC;

|PROCESO salida;
     |POPV;
|FPRC;

|PROCESO Rellena;
   #agifa154#0 = #agifa153#0;
   #agifa154#2 = #agifa019#0;
   |LEE 000#agifa154.=;
   |SI FSalida ! 0;
      |SELECT #1#agifa154;
      |DDEFECTO #agifa154;
      #agifa154#0 = #agifa153#0;
      #agifa154#1 = nLinea;    nLinea = nLinea + 1;
      #agifa154#2 = #agifa019#0;
      #agifa154#3 = aCArt;
      #agifa154#4 = #agifa019#1;
      #agifa154#5 = #agifa019#1;
      #agifa154#6 = #agifa153#2;
      |GRABA 020#agifa154.n;
      |SELECT #2#agifa154;
   |FINSI;
|FPRC;

|DEFBUCLE Rellena;
#agifa019#1;
;
aDArt;
aHArt;
;
NULL,Rellena;
|FIN;

|PROCESO RellTmp;
   |SALVA_FICHA #agifa154;
   |SELECT #2#agifa154;
   #agifa154#0 = #agifa153#0;
   #agifa154#2 = #agifa019#0;
   |LEE 000#agifa154.=;
   |SI FSalida ! 0;
      #agifa168#0 = nLinea;    nLinea = nLinea + 1;
      #agifa168#1 = #agifa019#0;
      #agifa168#2 = #agifa019#1;
      |GRABA 020#agifa168.n
   |FINSI;
   |SELECT #1#agifa154;
   |REPON_FICHA #agifa154;
|FPRC;

|DEFBUCLE RellTmp;
#agifa019#1;
;
"                    ";
"zzzzzzzzzzzzzzzzzzzz";
;
NULL,RellTmp;
|FIN;

|RUTINA inf;
   #agifa168#0 = 1;
|FRUT;

|RUTINA sup;
   #agifa168#0 = 99999;
|FRUT;

|PROCESO T13; |TIPO 13;
   |SI #agifa153#2 = "A";
      |MENSA "<F5>Carga art.desde/hasta,<F6>Carga art.masiva,<F7>Consulta art.restantes";
   |SINO;
      |MENSA "";
   |FINSI;
|FPRC;

|PROCESO TFuncion; |TIPO 11;
   |SI #agifa153#2 = "A";
      |MENSA "<F5>Carga art.desde/hasta,<F6>Carga art.masiva,<F7>Consulta art.restantes";
   |SINO;
      |MENSA "";
   |FINSI;
   |SI FSalida = 13; |Y #agifa153#2 = "A";
      |SALVA_FICHA #agifa154;
      |PUSHV 0919 1661;
      |BLANCO 0919 1661;
      |CUADRO 1020 1560;
      |ATRI R; |PINTA 0921, " CARGA AUTOMATICA DESDE/HASTA           "; |ATRI N;
      |PINTA 1121, " Desde Articulo ";
      |PINTA 1221, " Hasta Articulo ";
      |PINTA 1321, " Codigo defecto ";

      #agifa019#0 = "";       |PINTA 1137, #agifa019#0;
      #agifa019#0 = "z" * 20; |PINTA 1237, #agifa019#0;
      #agifa019#0 = "";       |PINTA 1337, #agifa019#0;
      #agifa019#0 = aAlfa;
      aDArt = "";
      aHArt = "z" * 20;
      aCArt = "";

   |ET Pregunta1;
      E_sup  = 20;
      E_inf  = "";
      aDArt = 1137 ? 0;
      |SI FSalida = 0; |O FSalida = 3;
   |ET Pregunta2;
         E_sup  = 20;
         E_inf  = "";
         aHArt = 1237 ? 0;
         |SI FSalida = 2; |VETE Pregunta1; |FINSI;
         |SI FSalida = 0; |O FSalida = 3;
            E_sup  = 20;
            E_inf  = "";
            aCArt = 1337 ? 0;
            |SI FSalida = 2; |VETE Pregunta2; |FINSI;
            |SI FSalida = 0; |O FSalida = 3;
               FSalida = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      |SI FSalida = 7; |ERROR; |FINSI;
      |SI FSalida = 1;
         |CONFI "    NConfima rellenado ? ";
         |SI FSalida = 0;
            |ABRE #agifa154;
            #agifa154#0 = #agifa153#0 + 1;
            #agifa154#1 = 1;
            |LEE 000#agifa154.];
            |SI FSalida = 0;
               |LEE 000#agifa154.a;
            |SINO;
               |LEE 000#agifa154.u;
            |FINSI;
            |SI FSalida = 0; |Y #agifa154#0 = #agifa153#0;
               nLinea = #agifa154#1 + 1;
            |SINO;
               nLinea = 1;
            |FINSI;
            |SELECT #2#agifa154;
            |BUCLE Rellena;
            |SELECT #1#agifa154;
            |REPON_FICHA #agifa154;
            |CIERRA #agifa154;
         |FINSI;
      |FINSI;
      |POPV;
      |PONCONTROL 23, "si";
   |FINSI;
   |SI FSalida = 14; |Y #agifa153#2 = "A";

      |SALVA_FICHA #agifa154;
      |PUSHV 1119 1561;
      |BLANCO 1119 1561;
      |CUADRO 1220 1460;
      |ATRI R; |PINTA 1121, " CARGA AUTOMATICA MASIVA                "; |ATRI N;
      |PINTA 1321, " Codigo defecto ";

      aAlfa = #agifa019#0;
      #agifa019#0 = "";       |PINTA 1337, #agifa019#0;
      #agifa019#0 = aAlfa;
      aCArt = "";

      E_sup  = 20;
      E_inf  = "";
      aCArt = 1337 ? 0;
      |SI FSalida = 7; |ERROR; |FINSI;
      |SI FSalida = 1; |O FSalida = 0;
         |CONFI "    NConfima rellenado ? ";
         |SI FSalida = 0;
            |ABRE #agifa154;
            #agifa154#0 = #agifa153#0 + 1;
            #agifa154#1 = 1;
            |LEE 000#agifa154.];
            |SI FSalida = 0;
               |LEE 000#agifa154.a;
            |SINO;
               |LEE 000#agifa154.u;
            |FINSI;
            |SI FSalida = 0; |Y #agifa154#0 = #agifa153#0;
               nLinea = #agifa154#1 + 1;
            |SINO;
               nLinea = 1;
            |FINSI;
            |SELECT #2#agifa154;
            aDArt = " " * 20; aHArt = "z" * 20;
            |BUCLE Rellena;
            |SELECT #1#agifa154;
            |REPON_FICHA #agifa154;
            |CIERRA #agifa154;
         |FINSI;
      |FINSI;
      |POPV;
      |PONCONTROL 23, "si";
   |FINSI;
   |SI FSalida = 15;
      |HAZ CreaTempo; aTmp168 = Tempo;
      |NOME_DAT #agifa168#aTmp168#; |DELINDEX #agifa168;
      |ABRE #agifa168;
      |ABRE #agifa154;
      nLinea = 1;
      |BUCLE RellTmp;
      |CIERRA #agifa154;
      |PUSHV 0501 2380;
      |ENTLINEAL #1#agifa168,-1,4,21,1,inf,sup;
      |POPV;
      |CIERRA #agifa168;
      Tempo = aTmp168; |HAZ BoraTempo; |DELINDEX #agifa168;
      |ERROR;
   |FINSI;
|FPRC;
