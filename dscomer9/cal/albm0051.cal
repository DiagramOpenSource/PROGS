|FICHEROS;
     albm0051 #51;
|FIN;

|VARIABLES;
     aBase       = "";
     aAlfa       = "";
     aAlfa1      = "";

     nModo       = 0;
     nBufUsr     = 0;
     nEleUsr     = 0;
     nRegis      = 0;
|FIN;

|PROCESO TipoEntrada;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
         |MENAV "0000 La Alta va enlazada con los Usuarios generados en la Gestion de Usuarios.";
         |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRE #51;
     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "dev/usr/ds_sys.psw"
     |LEESECUENCIAL aAlfa, nBufUsr, nEleUsr, 0, 0;
     |PARA nRegis = 0; |SI nRegis < nEleUsr; |HACIENDO nRegis = nRegis + 1;
           |DEL_BUF nBufUsr, nRegis, aAlfa;
           aAlfa1 = aAlfa % 410;

           #51#0 = aAlfa1;
           |LEE 101#51=;
           |SI FSalida ! 0;
               |DDEFECTO #51;
               #51#0 = aAlfa1;
               |GRABA 020#51n;
           |FINSI;
           |LIBERA #51;
     |SIGUE;
     |FINDIM nBufUsr;
     |CIERRA #51;
|FPRC;
