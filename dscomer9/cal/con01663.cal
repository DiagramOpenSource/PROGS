|FICHEROS;
     con00663 #0;
     agifa027 #13;
|FIN;

|VARIABLES;
 {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Contador:  ";
     menu4 = "AM";
     menu5 = " Automatico ";
     menu6 = " Manual ";
     nModo = 0;
|FIN;


|PROCESO ContaTA0; |TIPO 0;
|FPRC;

|PROCESO ContaTA7; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |MENU menu;
          |SI FSalida = 1;
               |ABRE #13;
               #13#2 = #0#0;
               #13#0 = "facturao";
               |LEE 101#13=;
               |SI FSalida ! 0;
                    #13#1 = 1;
                    |GRABA 020#13b;
               |FINSI;
               #0#1 = #13#1; |PINTA #0#1;
               #13#1 = #13#1 + 1;
               |GRABA 021#13a;
               |CIERRA #13;
               |PTEC 802;
          |FINSI;
     |FINSI;
|FPRC;

==========Quitado segun  Subtiquet nro. 00768.0008 Cliente: 003218
/*
          ||Copiado del dsz99988

|FICHEROS;
     agifa027 #27;
     agifa084 #84;
     agifa134 #134;
     agifa142 #142;
     con00663 #663;
|FIN;


|VARIABLES;
     nSwFechaPos = 0;
     &efFacPosterior = @;
     &enSwNuevaFecha = 0;

     nNum = 0;
     nUltimo = 0;
     aPath = "";
     &eaHuecosVipei = "";
     &eaHayHuecos = "";
     &eaSerHuecos = "";
     &enNumHueco = 0;

     &nCon_Conta = 0;
     &aCon_Serie = "";

     &efFecConta = @;
     fFecha = @;
     nLin = 0;
     aDef = "";
     &eaDocu = "";
     &enSwMenu      = 0;
     &enCodigo      = 0;
     &enCodAlbNegro = 0;
     &eaSerie       = "";
     &enSwSimula    = 0;
     &enDesdeX      = 0;

 {-1}aMenu          = "";
     aMenu1         = "2400";
     aMenu2         = "1";
     aMenu3         = " Contador: ";
     aMenu4         = "AM";
     aMenu5         = " Automatico ";
     aMenu6         = " Manual ";
     aClave         = "";
     aSerie         = "";
     aAlfa          = "";
     nConta         = 0;
     nNume          = 0;
     nModo          = 0;
     nSalMenu       = 0;

     &eaSwClaveRepre= "";
     nConta2        = 0;
     aRef           = "";
|FIN;

|PROCESO CompruConta;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1; |ACABA; |FINSI;

     |SI #142#137 = "F"; |ACABA; |FINSI;

     |SI #142#136 ! "S";
          aAlfa = ("000000" + nConta ) % -106;
          |SI #142#136 = "N";
               |SI nNume > nConta;
                    aAlfa = "0000Numero incorrecto. No puede ser mayor de " + aAlfa;
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
          |SINO;
               |SI nNume > nConta;
                    aAlfa = "0000Numero superior a " + aAlfa;
                    |MENAV aAlfa;
                    |CONFI "0000N¿Esta Seguro?";
                    |SI FSalida ! 0; |ERROR; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ContadorFic;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |SI enSwMenu = 0;
         |SI enDesdeX = 1;
             aMenu1 = "2800";
         |FINSI;
          |MENU aMenu
          nSalMenu = FSalida;
          |SI nSalMenu ! 1; |ACABA; |FINSI;
     |FINSI;

     |SI #142#137 = "F";
          |ABRE #27;
          #27#2 = aSerie;
          #27#0 = aClave;
          |LEE  101#27=;
          |SI FSalida ! 0;
               #27#1 = 1;
               |GRABA 020#27b;
          |FINSI;
          nConta = #27#1;
          |SI enSwSimula = 0;       ||Lo usa la adj. de facturas ventas
               #27#1 = #27#1 + 1;
               |GRABA 020#27a;
          |FINSI;
          |CIERRA #27;
     |FINSI;
|FPRC;

|PROCESO ContaTA7; |TIPO 7;
     |ABRE #142; |LEE 000#142=; |CIERRA #142;
     |SI enSwMenu = 0;
          nModo = (FEntrada/100) !  0;
          |SI nModo ! 1; |ACABA; |FINSI;
     |FINSI;

     nConta = 1;
     aSerie = #663#0;
     |ABRE #134;
     #134#49 = aSerie;
     #134#0 = 999999;
     |LEE 000#134];
     |SI FSalida = 0;
          |LEE 000#134a;
     |SINO;
          |LEE 000#134u;
     |FINSI;
     |SI FSalida  = 0; |Y #134#49 = aSerie;
          nConta = #134#0 + 1;
     |FINSI;
     |SI #142#26 = "S";
          |ABRE #84;
          #84#48 = aSerie;
          #84#0 = 999999;
          |LEE 000#84];
          |SI FSalida = 0;
               |LEE 000#84a;
          |SINO;
               |LEE 000#84u;
          |FINSI;
          |SI FSalida  = 0; |Y #84#48 = aSerie;
               nConta2 = #84#0 + 1;
          |FINSI;
          |CIERRA #84;
          |SI nConta2 > nConta; nConta = nConta2; |FINSI;
     |SINO;
          |ABRE #84;
          #84#48 = aSerie;
          #84#0  = 1;
          |LEE 000#84];
          |SI FSalida = 0; |Y #84#48 = aSerie;
             |AVISO;
             |MENAV "    Esta serie se usa en facturas directas. Repase su configuracion de series.";
          |FINSI;
          |CIERRA #84;
     |FINSI;
     |CIERRA #134;
     aClave = "vfactura";
     |HAZ ContadorFic;

     |DDEFECTO #663;
     #663#0 = aSerie;
     |SI nSalMenu = 1;
          #663#1 = nConta;
          |PTEC 802;
     |SINO;
          #663#1 = 1;
     |FINSI;
     enSwMenu = 0;
|FPRC;

|PROCESO ContaTA0; |TIPO 0;
     nNume = #663#1;
     |HAZ CompruConta;
|FPRC;
*/
