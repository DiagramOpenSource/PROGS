|FICHEROS;
     con00003 #0;
     agif0041 #1;
     agifa200 #10;
     agifa142 #142;
|FIN;

|VARIABLES;
     &fichero  = "";

     cab       = "Control Empresas";
     empresa   = "";
     base      = "";
     long      = "";

     longi     = 0;
     i         = 0;
     empresa1  = 0;

     swpa019   = 0;
     swpa024   = 0;
     swpa112   = 0;
     swpa003   = 0;
     swpa601   = 0;
     &sinver   = 0;
     nForma = 0;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nForma = 0 +. 1;
     |ABRE #10;
     #10#0 = #0#0;
     |LEE 101#10=;
     |SI nForma = 1;
          |SI FSalida ! 0; |GRABA 020#10b; |FINSI;
          |PARA i = 0; |SI i [ 12; |HACIENDO i = i + 1;
               #10i = #0i;
          |SIGUE;
          |GRABA 020#10a;
     |SINO;
          |SI FSalida = 0;
               |BORRA 020#10a;
          |FINSI;
     |FINSI;
     |CIERRA #10;
|FPRC;


|PROCESO pro1;
 #0#1 = 1;
|FPRC;

|PROCESO pro2;
 #0#0 = 99999;
|FPRC;

|PROCESO empres; |TIPO 0;
 |SI empresa1 = #0#0;
     |MENAV "0000Ya esta en esta Empresa";
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO inicio;
     |DFICE empresa;
     |QBF empresa;
     long = empresa % 0;
     longi = long - 2;
     long = longi + "05";
     empresa = empresa % long;
     empresa1 = empresa;
     |DFICB base;
     |QBF base;
     |PATH_DAT #1 base;
     |ABRE #1;
|FPRC;

|PROCESO lee_campo; |TIPO 0;
     |SI FSalida = 10;
          |SI Campo = 1; |O Campo = 2;  fichero = "agifa024"; swpa024 = 1; |FINSI;
          |SI Campo = 4; |O Campo = 5;  fichero = "agifa019"; swpa019 = 1; |FINSI;
          |SI Campo = 7; |O Campo = 8;  fichero = "agifa112"; swpa112 = 1; |FINSI;
          |SI Campo = 10; |O Campo = 11;  fichero = "dsm00003"; swpa003 = 1; |FINSI;
          |SI Campo = 13; |O Campo = 14;  fichero = "con00601"; swpa601 = 1; |FINSI;
          sinver = 0;
          |SUB_EJECUTA_NP "agifa208.run";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO grabo_campo;
 |SI swpa024 = 0;
     fichero = "agifa024";
     sinver = 1;
     |SUB_EJECUTA_NP "agifa208.run";
     swpa024 = 1;
 |FINSI;
 |SI swpa019 = 0;
     fichero = "agifa019";
     sinver = 1;
     |SUB_EJECUTA_NP "agifa208.run";
     swpa019 = 1;
 |FINSI;
 |SI swpa112 = 0;
     fichero = "agifa112";
     sinver = 1;
     |SUB_EJECUTA_NP "agifa208.run";
     swpa112 = 1;
 |FINSI;
 |SI swpa003 = 0;
     fichero = "dsm00003";
     sinver = 1;
     |SUB_EJECUTA_NP "agifa208.run";
     swpa003 = 1;
 |FINSI;
 |SI swpa601 = 0;
     fichero = "con00601";
     sinver = 1;
     |SUB_EJECUTA_NP "agifa208.run";
     swpa601 = 1;
 |FINSI;
|FPRC;

|PROCESO mayus200;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FPRC;


|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |SI #142#28 = "N";
          |MENAV "0000ATENCION: Control de Empresas no activo en Parametros Generales...";
     |SINO;
          |CLS;
          |CABEZA cab;
          |PINPA #0#0;
          |HAZ inicio;
          |ENTLINEAL #1#0 , -1 , 1 , 20 , 1 , pro1 , pro2;
          |HAZ grabo_campo;
          |CIERRA #1;
     |FINSI;
|FPRO;
