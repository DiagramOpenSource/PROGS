|FICHEROS;
   diam0030 #0;
   diam0031 #1;
   diaz0017 #10,MANTE;
|FIN;

|VARIABLES;
   nCont = 0;
   nCalc = 0;
|FIN;

|PROCESO SalCopia;
   |SI #diaz0017#Campo# = 0;
      |PARA nCont = Campo; |SI nCont [ 22; |HACIENDO nCont = nCont + 1;
         |C_M #diaz0017#nCont#, 1, "N";
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO ComprOrig;
   |SI FSalida = 2; |ACABA; |FINSI;

   |ABRE #diam0030;
   #diam0030#0 = #diaz0017#0;
   #diam0030#1 = #diaz0017#1;
   #diam0030#2 = #diaz0017#2;
   |LEE 000#diam0030.=;
   |SI FSalida ! 0;
      |MENAV "    Registro no encontrado";
      |ERROR;
   |FINSI;
   |CIERRA #diam0030;
|FPRC;

|PROCESO BorraLins;
   |BORRA 020#diam0031.a;
|FPRC;

|DEFBUCLE BorraLins;
#diam0031#1;
;
#diam0030#0, #diam0030#1, #diam0030#2, "                    ";
#diam0030#0, #diam0030#1, #diam0030#2, "zzzzzzzzzzzzzzzzzzzz";
be;
NULL,BorraLins;
|FIN;

|PROCESO ComprDest;
   |SI FSalida = 2; |ACABA; |FINSI;

   |ABRE #diam0030; nCalc = Campo - 1;
   #diam0030#0 = #diaz0017#nCalc#;
   #diam0030#1 = #diaz0017#Campo#;
   #diam0030#2 = #diaz0017#2;
   |LEE 000#diam0030.=;
   |SI FSalida = 0;
      |CONFI "    NLa semana del a¤o indicada ya existe para este grupo. ¨ Sobreescribir ? ";
      |SI FSalida = 0;
         |BUCLE BorraLins;
         |BORRA 020#diam0030.a;
      |SINO;
         |ERROR;
      |FINSI;
   |FINSI;
   |CIERRA #diam0030;
|FPRC;

|PROCESO Selec;
   |SI #diaz0017#24 = "S";
      |C_M #diaz0017#25, 1, "N"; |C_M #diaz0017#26, 1, "N";
      |PARA nCont = 3; |SI nCont [ 22; |HACIENDO nCont = nCont + 1;
         |C_M #diaz0017#nCont#, 1, "S";
      |SIGUE;
   |SINO;
      |C_M #diaz0017#25, 1, "S"; |C_M #diaz0017#26, 1, "S";
      |PARA nCont = 3; |SI nCont [ 22; |HACIENDO nCont = nCont + 1;
         #diaz0017#nCont# = 0; |PINTA #diaz0017#nCont#;
         |C_M #diaz0017#nCont#, 1, "N";
      |SIGUE;
   |FINSI;
|FPRC;
