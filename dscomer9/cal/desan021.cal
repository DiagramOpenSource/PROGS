|FICHEROS;
     desan021 #0;
     desan022 #1,MANTE;
     agifa010 #10;
     agifa019 #19;
     desan045 #45;
     agifa071 #71;
     agifa112 #112;
|FIN;

|VARIABLES;
     &Tempo = "";
     f = @;
     i = 0;
     aArt = "";
     aAlfa = "";
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones:  ";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
     nDias = 0;
     nDiasPrv = 0;
|FIN;

|PROCESO Ventas;
     aArt = #71#2;

     #45#1 = #71#2;
     |LEE 000#45=;
     |SI FSalida = 0;
          aArt = #45#2;
     |FINSI;

     |DDEFECTO #19;
     #19#0 = aArt;
     |LEE 000#19=;

     |SI #19#0 < #0#0; |O #19#0 > #0#1; |ACABA; |FINSI;
     |SI #19#2 < #0#2; |O #19#2 > #0#3; |ACABA; |FINSI;
     |SI #71#3 < #0#4; |O #71#3 > #0#5; |ACABA; |FINSI;

     |DDEFECTO #112;
     #112#0 = #19#27;
     |LEE 000#112=;
     nDiasPrv = #112#91;
     |SI nDiasPrv = 0; nDiasPrv = 1; |FINSI;

     nDias = #0#7 - #0#6;
     nDias = (nDias / 30) ! 0;
     nDiasPrv = nDiasPrv / 30;

     |DDEFECTO #1;
     #1#0 = #19#0;
     |LEE 101#1=;
     |SI FSalida ! 0; |GRABA 020#1b; |FINSI;
     #1#1 = #19#1;
     #1#4 = #1#4 + #71#5;
     #1#2 = (#1#4 / nDias * nDiasPrv) ! 0;
     |SI #1#2 = 0; #1#2 = 1; |FINSI;
     #1#3 = (#1#2 * #0#9) ! 0;             ||Max
     |SI #1#3 = 0; #1#3 = 1; |FINSI;
     #1#2 = (#1#2 * #0#8) ! 0;             ||Min
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE Ventas;
     #10#7;
     ;
     #0#6, "     ", 000001;
     #0#7, "zzzzz", 999999;
     ;
     NULL, NULL, Ventas;
|FIN;

|PROCESO Tecla; |TIPO 0;
     |SI #1Campo = Contenido;
          |ENCAMPO #2#1;
          |SI FSalida = 0;
               |ENCAMPO #3#1;
               |SI FSalida = 0;
                    |GRABA 020#1a;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min;
     #1#0 = "                    ";
|FPRC;

|PROCESO Max;
     #1#0 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROCESO Actualiza;
     #19#0 = #1#0;
     |LEE 101#19=;
     |SI FSalida = 0;
          #19#7 = #1#2;
          #19#8 = #1#3;
          |GRABA 020#19a;
          |LIBERA #19;
     |FINSI;
|FPRC;

|DEFBUCLE Actualiza;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Actualiza;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ CreaTempo; |NOME_DAT #1 Tempo; |DELINDEX #1;
          |ABRE #1;
          |ABRE #45; |SELECT #2#45;
          |ABRE #19;
          |ABRE #112;
          |BUCLE Ventas;
          |CIERRA #112;
          |CIERRA #19;
          |CIERRA #45;
          |CIERRA #1;
          |PINPA #0#1;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#1, 1, 4, 20, 0, Min, Max;
               |MENU aMenu;
               aMenu2 = FSalida;
               |SI FSalida ! 1; |SAL; |FINSI;
          |SIGUE;
          |SI aMenu2 = 2;
               |ABRE #19;
               |BUCLE Actualiza;
               |CIERRA #19;
          |FINSI;

          |HAZ BoraTempo; |DELINDEX #1;
     |FINSI;
|FPRO;
