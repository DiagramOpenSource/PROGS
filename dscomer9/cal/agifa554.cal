|FICHEROS;
     agifa554 #0;
     dsm00003 #3;
     agifa024 #24;
     agifa142 #142;
     referen@;
|FIN;

|VARIABLES;
     &Tempo = "";
     aAlfa = "";
|FIN;

|PROCESO DefDirEnt;
     |SI #142#229 = "F";
          #0#2 = #24#8; |PINTA #0#2;  || Dir.
          #0#3 = #24#9; |PINTA #0#3;  || Pob.
          #0#4 = #24#10;|PINTA #0#4;  || Prv.
          #0#9 = #24#181; |PINTA #0#9;|| CP1
          #0#10 = #24#182; |PINTA #0#10; ||CP2
     |FINSI;
     |SI #142#229 = "C";
          #0#2 = #24#11; |PINTA #0#2;  || Dir.
          #0#3 = #24#12; |PINTA #0#3;  || Pob.
          #0#4 = #24#13;|PINTA #0#4;  || Prv.
          #0#9 = #24#184; |PINTA #0#9;|| CP1
          #0#10 = #24#185; |PINTA #0#10; ||CP2
     |FINSI;
     |SI #142#229 = "E"; |O #0#8 = "A";
          #0#0 = #3#10;
          #0#2 = #3#2; |PINTA #0#2;  || Dir.
          #0#3 = #3#3; |PINTA #0#3;  || Pob.
          #0#4 = #3#7; |PINTA #0#4;  || Prv.
          #0#9 = #3#4; |PINTA #0#9;|| CP1
          #0#10 = #3#5; |PINTA #0#10; ||CP2
     |FINSI;
|FPRC;

|PROCESO DirEntrega0; |TIPO 0;
     |SI #0Campo ! Contenido;
          |ABRE #3;
          #3#0 = #0#7;
          #3#1 = #0#6;
          |LEE 000#3=;
          |SI FSalida = 0; |Y #3#18 = "S";
               |HAZ DefDirEnt;
          |SINO;
               |SI #3#18 = "N"; |Y FSalida = 0;
                    |MENAV "0000Direccion no activa...";
               |SINO;
                    |MENAV "0000No existe direccion de entrega...";
               |FINSI;
               |ERROR;
          |FINSI;
          |CIERRA #3;
     |FINSI;
|FPRC;

|PROCESO Min3;
     #referen@#0 = #0#7;
     #referen@#1 = 0000;
|FPRC;

|PROCESO Max3;
     #referen@#0 = #0#7;
     #referen@#1 = 9999;
|FPRC;

|PROCESO CargaDirEnt;
     |SALVA_DATOS #3;
     |REPON_DATOS #referen@;
     |GRABA 020#referen@.n;
|FPRC;

|DEFBUCLE CargaDirEnt;
     #3#1;
     18;
     #0#7, 0001, "S";
     #0#7, 9999, "S";
     ;
     NULL, CargaDirEnt;
|FIN;

|PROCESO DirEntrega66; |TIPO 66;
     |DDEF aAlfa;
     aAlfa = aAlfa + "dsm00003";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida ! 0;
          |MENAV "0000Error al cargar 'dsm00003'";
          |ACABA;
     |FINSI;

     |HAZ CreaTempo;
     |NOME_DAT #referen@#Tempo#;
     |DELINDEX #referen@;

     |ABRE #referen@;
     |BUCLE CargaDirEnt;

     #referen@#0 = #0#7;
     #referen@#1 = #0#6;
     |LEE 000#referen@.];
     |CONSULTA_F_CLAVE #1#referen@, Min3, Max3;
     |SI FSalida = 0;
          #0#7 = #referen@#0;
          #0#6 = #referen@#1; |PINTA #0#6;

          |ABRE #3;
          #3#0 = #0#7;
          #3#1 = #0#6;
          |LEE 000#3=;
          |CIERRA #3;
          |HAZ DefDirEnt;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #referen@;

     |DELINDEX #referen@;
     |DESCARGA_DEF #referen@;
|FPRC;
