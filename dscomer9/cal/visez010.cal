|FICHEROS;
     visez010 #0;
     visem001 #1;
     visem002 #2;
     visem003 #3;
     visem012 #12;
|FIN;

|VARIABLES;
     nLin = 0;
|FIN;

|PROCESO visem002;
     #12#0 = #1#3;
     #12#1 = #1#7;
     #12#2 = #2#2;
     |LEE 000#12=;
     |SI FSalida = 0;
          #3#0 = #2#0;
          #3#1 = #2#1;
          #3#2 = 1;
          |LEE 101#3];
          |SI FSalida = 0; |Y #3#0 = #2#0;  |Y #3#1 = #2#1;
               |SALVA_DATOS #3;
               #3#6 = #12#3;
               #3#28 = 999999;
               #3#29 = 999999;
               |GRABA 020#3a;
               |LIBERA #3;

               #3#2 = 999;
               |LEE 000#3];
               |SI FSalida = 0;
                    |LEE 000#3a;
               |SINO;
                    |LEE 000#3u;
               |FINSI;
               |SI FSalida = 0; |Y #3#0 = #2#0;  |Y #3#1 = #2#1;
                    nLin = #3#2 + 1;
               |SINO;
                    nLin = 1;
               |FINSI;
               |REPON_DATOS #3;
               #2#22 = #2#5 - #12#3;
               #3#2 = nLin;
               #3#6 = #2#22;
               |SI #3#6 > 0;
                    |GRABA 020#3n;
               |FINSI;
               |LIBERA #3;
          |FINSI;
     |FINSI;
     |GRABA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE visem001;
     #1#1;
     ;
     #0#0;
     #0#0;
     be;
     NULL, NULL, visem002;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#1 = "SI";
          |ABRE #12;
          |ABRE #3;
          |BUCLE visem001;
          |CIERRA #3;
          |CIERRA #12;
     |FINSI;
|FPRC;
