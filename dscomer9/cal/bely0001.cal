|FICHEROS;
   bely0001 #0;

   belm0021 #1;
   belm0022 #2;
   belm0023 #3;
   belm0024 #4;

   belm0004 #40;

   agifa024 #24;
   agifa019 #19;
   dsm00225 #225;
   dsm00156 #156;
|FIN;

|VARIABLES;
   aIdioma = "";
   aPais = "";
   aParametro = "";
   nNumero = 0;

   &eaArtIdioma = "";
   &eaCodArtIdioma = "";
   &descrip = "";

   aMensaje = "";

   &eaDoc = "";
   &Cod1  = ""; &Des1  = ""; &Unid1 = 0;
   &Cod2  = ""; &Des2  = ""; &Unid2 = 0;
   &Cod3  = ""; &Des3  = ""; &Unid3 = 0;
   &Cod4  = ""; &Des4  = ""; &Unid4 = 0;
   &Cod5Elem  = "";
   &Cant5Elem = "";

   &SwLinPaq  = 0;
   &SwLinArt  = 0;
   &SwLin5Ele = 0;
   aInforme   = "";
|FIN;

|PROCESO IdiomaPedidoCoimasa;
     aPais = #agifa024#205;

     |ABRE #dsm00225;
     |DDEFECTO #dsm00225;
     #dsm00225#0 = aPais;
     |LEE 000#dsm00225.=;
     |SI FSalida = 0;
          aIdioma = #dsm00225#5;
          |SI aIdioma ! "";
               |ABRE #dsm00156;
               |DDEFECTO #dsm00156;
               #dsm00156#0 = aIdioma;
               #dsm00156#1 = eaCodArtIdioma;
               |LEE 000#dsm00156.=;
               |SI FSalida = 0;
                    eaArtIdioma = #dsm00156#2;
               |FINSI;
               |CIERRA #dsm00156;
          |FINSI;
     |FINSI;
     |CIERRA #dsm00225;
|FPRC;

|PROCESO Det5Elem;
   Cod5Elem = Cod5Elem + "[" + (#belm0024#3 % 0104) + "] ";
   Cant5Elem = Cant5Elem + "[" + (("0000" + #belm0024#4) % -104) + "] ";
|FPRC;

|DEFBUCLE Det5Elem;
#belm0024#1;
;
#belm0023#0, #belm0023#1, #belm0023#2, "      ";
#belm0023#0, #belm0023#1, #belm0023#2, "zzzzzz";
be;
NULL,Det5Elem;
|FIN;

|PROCESO DetArticulos;
   #40#2 = #belm0023#4;
   |LEE 000#40=;
   |SI FSalida ! 0; |DDEFECTO #40; |FINSI;


   Cod5Elem = "";
   Cant5Elem = "";
   |SI #belm0023#5 = "S";
      |BUCLE Det5Elem;
   |FINSI;

   |DDEFECTO #agifa019;
   #agifa019#0 = #belm0023#4;
   |LEE 000#agifa019.=;
   descrip = #agifa019#1;

   eaCodArtIdioma = #belm0023#4;
   eaArtIdioma = "";
   |HAZ IdiomaPedidoCoimasa;
   |SI eaArtIdioma ! "";
         descrip = eaArtIdioma;
   |FINSI;

   SwLinArt = 1; |PRINT; SwLinArt = 0;
|FPRC;

|DEFBUCLE DetArticulos;
#belm0023#1;
;
#belm0022#0,#belm0022#1,001;
#belm0022#0,#belm0022#1,999;
be;
NULL,DetArticulos;
|FIN;

|PROCESO DetPaquetes;
   |DDEFECTO #agifa024;
   #agifa024#0 = #belm0021#27;
   |LEE 000#agifa024.=;

   SwLinPaq = 1; |PRINT; SwLinPaq = 0;
   |BUCLE DetArticulos;
|FPRC;

|DEFBUCLE DetPaquetes;
#belm0022#1;
;
#belm0021#0,001;
#belm0021#0,999;
be;
NULL,DetPaquetes;
|FIN;

|PROCESO Emision;
   eaDoc = "PL" + "     " + #1#0;
   |HAZ PackListVar;

   aInforme = #0#6; |QBF aInforme;
   |INFOR aInforme;
   |SI FSalida ! 0;
        aMensaje = "0000Informe " + aInforme + " inaccesible.";
        |MENAV aMensaje;
        |ACABA;
   |FINSI;
   Cod1  = ""; Des1  = ""; Unid1 = 0;
   Cod2  = ""; Des2  = ""; Unid2 = 0;
   Cod3  = ""; Des3  = ""; Unid3 = 0;
   Cod4  = ""; Des4  = ""; Unid4 = 0;

   |ABRE #agifa024;
   |ABRE #agifa019;
   |ABRE #40; |SELECT #3#40;
   |BUCLE DetPaquetes;
   |CIERRA #40;
   |CIERRA #agifa019;
   |CIERRA #agifa024;
   |PIEINF;
   |FININF;
|FPRC;

|DEFBUCLE Emision;
#belm0021#1;
1,27;
#bely0001#0,#bely0001#1,#bely0001#2;
#bely0001#3,#bely0001#4,#bely0001#5;
be;
NULL,Emision;
|FIN;

|PROGRAMA;
   |ABRE #0;
   |LEE 101#0=;
   |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

   aParametro = PARAMETRO;
   |QBF aParametro;
   |SI aParametro ! "";
      nNumero = aParametro;
      |DDEFECTO #0;
      #0#0 = nNumero;
      #0#3 = nNumero;
      Impresora = "CrystalReport";
      |IMPRE -1;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |BUCLE Emision;
      |FINIMP;
   |SINO;
      |CLS;
      |CABEZA "Emision de packing list";
      |PINPA #0#0; |PINDA #0#0;
      |ENDATOS #1#0;
      |SI FSalida = 0;
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
         |BUCLE Emision;
         |FINIMP;
         |GRABA 020#0a;
      |FINSI;
   |FINSI;

   |CIERRA #0;
|FPRO;
