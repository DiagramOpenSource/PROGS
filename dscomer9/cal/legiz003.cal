|FICHEROS;
     legiz003 #0;

     legim003 #3;        ||Partes CAB
     legim004 #4;        ||Partes LIN

     legim005 #5;        ||Formatos por Series

     agifa024 #24;
     agifa025 #25;
     agifa060 #60;

     legiw002 #100,MANTE;      ||Aux. Planning
     legiw003 #103,MANTE;      ||Aux3. Planning
|FIN;

|VARIABLES;
     nVoy = 0;
     &eaSerieParte = "";
     &enNumeroParte = 0;
     aInforme = "";
     nSwPie = 0;
     aAlfa = "";
     nClave = 0;
     &enEscape = 0;
     nSalir = 0;
     nSwHay = 0;
     aMensaje = "";

      {-1}menu      = "";
          menu1     = "2400";
          menu2     = "1";
          menu3     = "";
          menu4     = "RRC";
          menu5     = "Revisar";
          menu6     = "Planning";
          menu7     = "Cancelar";

     aTempo100 = "";
     &Tempo = "";
|FIN;

|PROCESO legim003;
     |SI #legiz003#6 = "S"; |Y #legim003#15 = "N";
          |ACABA;
     |FINSI;

     |SI #legiz003#6 = "N"; |Y #legim003#15 = "S";
          |ACABA;
     |FINSI;

     |SI #legiz003#7 = "S"; |Y #legim003#12 = "N";
          |ACABA;
     |FINSI;

     |SI #legiz003#7 = "N"; |Y #legim003#12 = "S";
          |ACABA;
     |FINSI;

     ||ARA39
     |DDEFECTO #agifa024;
     #agifa024#0 = #legim003#2;
     |LEE 000#agifa024.=;

     |SI #agifa024#189 < #legiz003#8; |O #agifa024#189 > #legiz003#9;
          |ACABA;
     |FINSI;

     |DDEFECTO #legiw002;
     #legiw002#0 = #legim003#0;
     #legiw002#1 = #legim003#1;
     |LEE 101#legiw002.=;
     |SI FSalida ! 0; |GRABA 020#legiw002.b; |FINSI;

     #legiw002#2 = #legim003#2;
     #legiw002#3 = #legim003#3;
     #legiw002#4 = #legim003#4;
     #legiw002#5 = #legim003#5;
     #legiw002#6 = #legim003#6;
     #legiw002#7 = #legim003#7;
     #legiw002#8 = #legim003#8;
     #legiw002#9 = #legim003#9;
     #legiw002#10 = #legim003#10;
     #legiw002#11 = #legim003#11;
     #legiw002#12 = #legim003#12;
     #legiw002#13 = #legim003#13;
     #legiw002#14 = #legim003#14;
     #legiw002#15 = #legim003#15;
     #legiw002#16 = #legim003#16;

     #legiw002#18 = #legim003#17;
     #legiw002#19 = #legim003#18;
     #legiw002#20 = #legim003#19;
     #legiw002#21 = #legim003#20;

     |GRABA 020#legiw002.a;
     |LIBERA #legiw002;

     nSwHay = nSwHay + 1;
|FPRC;

|DEFBUCLE legim003;
 #legim003#1;
 6, 2, 13;
 "     ", 000000, #legiz003#0, #legiz003#4, #legiz003#2;
 "zzzzz", 999999, #legiz003#1, #legiz003#5, #legiz003#3;
 ;
 NULL, legim003;
|FIN;

|PROCESO Minw002;
     #legiw002#0 = "     ";
     #legiw002#1 = 000000;
     #legiw002#2 = "      ";
     #legiw002#6 = "01.01.0000";
|FPRC;

|PROCESO Maxw002;
     #legiw002#0 = "zzzzz";
     #legiw002#1 = 999999;
     #legiw002#2 = "999999";
     #legiw002#6 = "31.12.2099";
|FPRC;

|PROCESO Principal;
     nSwHay = 0;

     ||Temporal
     |HAZ CreaTempo; aTempo100 = Tempo;
     |NOME_DAT #100 aTempo100; |DELINDEX #100;

     |ABRE #legiw002;

     ||Relleno el temporal
     |BUCLE legim003;

     |SI nSwHay = 0;
          aMensaje = "0000Seleccion vacia";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     ||Revisar, Planning, Cancelar  + cambio de clave.

     |PARA nSalir = 1; |SI nSalir [ 1; |HACIENDO;
          enEscape = 0;
          |SI nClave = 0;
               |ENTLINEAL #1#legiw002, 1, 4, 22, 1, Minw002, Maxw002;
          |SINO;
               |SI nClave = 1;
                    |ENTLINEAL #2#legiw002, 1, 4, 22, 1, Minw002, Maxw002;
               |SINO;
                    |ENTLINEAL #3#legiw002, 1, 4, 22, 1, Minw002, Maxw002;
               |FINSI;
          |FINSI;

          |SI enEscape = 1;
               nSalir = 1;
          |SINO;
               |MENU menu;
               nSalir = FSalida;
          |FINSI;
     |SIGUE;

     |SI nSalir = 2;
          ||Imprimir Planning
          |HAZ ImpPlanning;
     |FINSI;

     |CIERRA #legiw002;

     |DELINDEX #100; Tempo = aTempo100; |HAZ BoraTempo;
|FPRC;

|PROCESO legim004Imp;
     |DDEFECTO #agifa060;
     #agifa060#0 = #legim004#5;
     |LEE 000#agifa060.=;

     |PRINT;
     nSwPie = 1;
|FPRC;

|DEFBUCLE legim004Imp;
 #legim004#1;
 ;
 #legim003#0, #legim003#1, 001;
 #legim003#0, #legim003#1, 999;
 ;
 NULL, legim004Imp;
|FIN;


|PROCESO legiw002Imp;
     |SI #legiw002#17 ! "*"; |ACABA; |FINSI;

     |DDEFECTO #legim003;
     #legim003#0 = #legiw002#0;
     #legim003#1 = #legiw002#1;
     |LEE 000#legim003.=;

     |ABRE #legim005;
     |DDEFECTO #legim005;
     #legim005#0 = #legim003#0;
     |LEE 000#legim005.=;
     aInforme = #legim005#6;
     |QBF aInforme;
     |CIERRA #legim005

     |SI aInforme ! "";
          |INFOR aInforme;
          |SI FSalida = 0;

               |DDEFECTO #agifa024;
               #agifa024#0 = #legim003#2;
               |LEE 000#agifa024.=;

               |DDEFECTO #agifa025;
               #agifa025#0 = #legim003#13;
               |LEE 000#agifa025.=;


               |BUCLE legim004Imp;
               |SI nSwPie = 1;
                    |PIEINF;
               |FINSI;
               |FININF;
          |SINO;
               aMensaje = "0000Informe " + aInforme + " inaccesible.";
               |MENAV aMensaje;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE legiw002Imp;
 #legiw002#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, legiw002Imp;
|FIN;

|PROCESO ImpPlanning;
     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #legim003;
          |ABRE #agifa025;
          |ABRE #agifa060;
          |BUCLE legiw002Imp;
          |CIERRA #legim003;
          |CIERRA #agifa025;
          |CIERRA #agifa060;
          |FINIMP;
     |SINO;
          |MENAV "0000Proceso cancelado.";
     |FINSI;
|FPRC;

|PROCESO Marcar;
     #100#17 = aAlfa;
     |GRABA 020#100a;
|FPRC;

|DEFBUCLE Marcar;
 #100#1;
 ;
 INICIO;
 FINAL;
 be;
 NULL,Marcar;
|FIN;

|PROCESO Funciones; |TIPO 11;
     || <F9> Marcar/Desmarcar linea
     |SI FSalida = 17;
          |SI #100#17 = "*";
               #100#17 = " ";
          |SINO;
               #100#17 = "*":
          |FINSI;
          |PINTA #100#17;
          |GRABA 020#100a;
          |ERROR;
     |FINSI;

     || <F8> Modificar Parte
     |SI FSalida = 16;
          |LEE 101#legiw002.=;
          |SI FSalida = 0;
               |PUSHV 1014 1868;
               |DDEFECTO #legiw003;
               |PARA nVoy = 0; |SI nVoy [ 21; |HACIENDO nVoy = nVoy + 1;
                    #legiw003#nVoy# = #legiw002#nVoy#;
               |SIGUE;

               |PINPA #0#legiw003;
               |PINDA #0#legiw003;
               |ENDATOS #1#legiw003;
               |SI FSalida = 0;
                    #legiw002#13 = #legiw003#13;
                    #legiw002#14 = #legiw003#14;
                    #legiw002#7 = #legiw003#7;
                    #legiw002#8 = #legiw003#8;
                    #legiw002#9 = #legiw003#9;
                    |GRABA 020#legiw002.a;
                    |PINTA #legiw002#13;
                    |PINTA #legiw002#14;
                    |PINTA #legiw002#7;
                    |PINTA #legiw002#8;
                    |PINTA #legiw002#9;
                    ||ARA39;

                    |ABRE #legim003;
                    |DDEFECTO #legim003;
                    #legim003#0 = #legiw002#0;
                    #legim003#1 = #legiw002#1;
                    |LEE 101#legim003.=;
                    |SI FSalida = 0;
                         #legim003#13 = #legiw002#13;
                         #legim003#14 = #legiw002#14;
                         #legim003#7 = #legiw002#7;
                         #legim003#8 = #legiw002#8;
                         #legim003#9 = #legiw002#9;
                         |GRABA 020#legim003.a;
                         |LIBERA #legim003;
                    |FINSI;
                    |CIERRA #legim003;
               |FINSI;
               |LIBERA #legiw002;
               |POPV;
          |FINSI;
     |FINSI;

     || <F7> Consulta Parte
     |SI FSalida = 15;
          eaSerieParte = #legiw002#0;
          enNumeroParte = #legiw002#1;
          |SUB_EJECUTA_NP "legim003;CONSU";
     |FINSI;

     || <F5> Marcar/desmarcar todos
     |SI FSalida = 13;
          |SI #100#17 = "*";
               aAlfa = " ";
          |SINO;
               aAlfa = "*";
          |FINSI;
          |BUCLE Marcar;
          enEscape = 1;
          |PTEC 806;
     |FINSI;

     || <F3> Cambio Clave
     |SI FSalida = 11;
          nClave = nClave + 1;
          |SI nClave > 2;
               nClave = 0;
          |FINSI;
          enEscape = 1;
          |PTEC 806;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |DDEFECTO #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #agifa024;
          |HAZ Principal;
          |CIERRA #agifa024;
     |FINSI;
|FPRO;
