|FICHEROS;
     sctrz082 #0;
     sctrm022 #22;
     sctrm050 #50;
     sctrm052 #52;
     sctrm062 #62;
     sctrm066 #66;
     sctrm067 #67;
     sctrm001 #100;
|FIN;

|VARIABLES;
     &enPantaLogo = 0;
     &eaNomLogo = "";
     nPanta = 0;
     aMes = "";
     aAno = "";
     nNume = 0;
     nTotal = 0;
     aPrvOrg = "";
     aPrvDes = "";
     nHay = 0;
     fHoy = @;
     aAlfa = "";
     aDesde = "";
     aHasta = "";
     f = @;
     nIva = 0;
|FIN;

|PROCESO CosteSocio;
     aMes = #67#2 % 402;
     aAno = #67#2 % 704;

     |DDEFECTO #62;
     #62#2 = aAno;
     #62#1 = aMes;
     #62#0 = #67#0;
     #62#15 = 0;
     |LEE 101#62=;
     |SI FSalida ! 0; |GRABA 020#62b; |FINSI;

     #62#12 = #62#12 + #67#5;

     |GRABA 020#62a;
     |LIBERA #62;
|FPRC;

|DEFBUCLE CosteSocio;
     #67#2;
     ;
     aDesde, "   ";
     aHasta, "zzz";
     ;
     NULL, CosteSocio;
|FIN;

|PROCESO sctrm022;
     nHay = 1;

     nIva = 0;
     #66#5 = #22#4;
     #66#0 = #100#24;
     #66#4 = "01.01.0001"; || #52#1;
     |LEE 000#66];
     |PARA; |SI FSalida = 0; |Y #66#5 = #22#4; |Y #66#0 = #100#24; |Y #52#1 ] #66#4; |HACIENDO;
          nIva = #66#2;
          |LEE 000#66s;
     |SIGUE;

     |SI #0#4 = "S";
          |SI #52#17 = 1;
               nNume = #52#32;
          |SINO;
               nNume = #52#32 / 2;
          |FINSI;
     |SINO;
          |SI #52#17 = 1;
               nNume = #52#32 - #52#108;
          |SINO;
               nNume = (#52#32 - #52#108) / 2;
          |FINSI;
     |FINSI;
     nNume = nNume * #22#7 / 100;
     nNume = nNume * nIva / 100;
     nTotal = nTotal + nNume;
|FPRC;

|DEFBUCLE sctrm022;
     #22#1;
     ;
     #52#75, aPrvOrg, aPrvDes, 0000;
     #52#75, aPrvOrg, aPrvDes, 9999;
     ;
     NULL, sctrm022;
|FIN;

|PROCESO Reservas;
     |SI #52#136 = 0;
          #52#136 = 1;
     |FINSI;

     #62#7 = #62#7 + 1;

     |SI #52#17 = 1;
          |SI #0#4 = "S";
               #62#10 = #62#10 + #52#32*#52#136;            || Bruto
          |SINO;
               #62#10 = #62#10 + (#52#32 - #52#108)*#52#136;     || Bruto
          |FINSI;
          #62#11 = #62#11 + #52#108*#52#136;     || Tasas
          #62#13 = #62#13 + ((#52#32 - #52#108) * #52#121 / 100)*#52#136; || Comi

          aPrvOrg = #52#8;
          aPrvDes = #52#12;
          nTotal = 0;
          nHay = 0;
          |BUCLE sctrm022;
          |SI nHay = 0;
               aPrvOrg = #52#12;
               aPrvDes = #52#8;
               |BUCLE sctrm022;
          |FINSI;
          #62#14 = #62#14 + nTotal*#52#136;
     |SINO;
          |SI #0#4 = "S";
               #62#10 = #62#10 + (#52#32/2)*#52#136;
          |SINO;
               #62#10 = #62#10 + ((#52#32 - #52#108)/2)*#52#136;
          |FINSI;
          #62#11 = #62#11 + (#52#108)/2*#52#136;
          #62#13 = #62#13 + (((#52#32 - #52#108)/2) * #52#121 / 100)*#52#136;

          aPrvOrg = #52#8;
          aPrvDes = #52#12;
          nTotal = 0;
          nHay = 0;
          |BUCLE sctrm022;
          |SI nHay = 0;
               aPrvOrg = #52#12;
               aPrvDes = #52#8;
               |BUCLE sctrm022;
          |FINSI;
          #62#14 = #62#14 + nTotal*#52#136;
     |FINSI;
|FPRC;

|PROCESO Reservas3;
     |SI #52#53 = "A"; |ACABA; |FINSI;
     |SI #52#79 = 0; |ACABA; |FINSI;

     aMes = #52#26 % 402;
     aAno = #52#26 % 704;

     |DDEFECTO #62;
     #62#2 = aAno;
     #62#1 = aMes;
     #62#0 = #52#56;
     #62#15 = #52#75;
     |LEE 101#62=;
     |SI FSalida ! 0; |GRABA 020#62b; |FINSI;
     |HAZ Reservas;
     |GRABA 020#62a;
     |LIBERA #62;
|FPRC;

|PROCESO Reservas2;
     |SI #52#52 = "A"; |ACABA; |FINSI;
     |SI #52#74 = 0; |ACABA; |FINSI;

     aMes = #52#20 % 402;
     aAno = #52#20 % 704;

     |DDEFECTO #62;
     #62#2 = aAno;
     #62#1 = aMes;
     #62#0 = #52#56;
     #62#15 = #52#75;
     |LEE 101#62=;
     |SI FSalida ! 0; |GRABA 020#62b; |FINSI;
     |HAZ Reservas;
     |GRABA 020#62a;
     |LIBERA #62;
|FPRC;

|DEFBUCLE Reservas3;
     #52#3;
     ;
     aDesde, 000000, 0000000;
     aHasta, 999999, 9999999;
     ;
     NULL, Reservas3;
|FIN;

|DEFBUCLE Reservas2;
     #52#2;
     ;
     aDesde, 000000, 0000000;
     aHasta, 999999, 9999999;
     ;
     NULL, Reservas2;
|FIN;

|PROCESO sctrm050;
     aMes = #50#0 % 402;
     aAno = #50#0 % 704;

     |DDEFECTO #62;
     #62#0 = #50#7;
     #62#1 = aMes;
     #62#2 = aAno;
     #62#15 = #50#5;
     |LEE 101#62=;
     |SI FSalida ! 0; |GRABA 020#62b; |FINSI;

     |SI #50#45 = "N"
          #62#3 = #62#3 + #50#17 + #50#18;
          |SI #50#22 = "N";
               #62#5 = #62#5 + 1;
          |SINO;
               #62#5 = #62#5 + 2;
          |FINSI;
          #62#8 = #62#8 + #50#19;
     |SINO;
          #62#4 = #62#4 + #50#17 + #50#18;
          |SI #50#22 = "N";
               #62#6 = #62#5 + 1;
          |SINO;
               #62#6 = #62#5 + 2;
          |FINSI;
          #62#9 = #62#9 + #50#19;
     |FINSI;
     |GRABA 020#62a;
     |LIBERA #62;
|FPRC;

|DEFBUCLE sctrm050;
     #50#1;
     ;
     aDesde, 0000;
     aHasta, 9999;
     ;
     NULL, sctrm050;
|FIN;

|PROCESO sctrm062;
     |BORRA 020#62a;
|FPRC;

|DEFBUCLE sctrm062;
     #62#1;
     ;
     #0#0, #0#1, "   ", 000;
     #0#0, #0#3, "zzz", 999;
     be;
     NULL, sctrm062;
|FIN;

|PROCESO T3; |TIPO 3;
     |BUCLE sctrm062;

     aDesde = "01." + (("00" + #0#1)%-102) + "." + (("0000" + #0#0)%-104);
     aHasta = "01." + (("00" + #0#3)%-102) + "." + (("0000" + #0#0)%-104);
     |PARA f = aHasta; |SI; |HACIENDO f = f + 1;
          aAlfa = f % 402;
          |SI aAlfa ! #0#3; |SAL; |FINSI;
          aHasta = f;
     |SIGUE;

     |ABRE #66;
     |ABRE #62;
     |BUCLE sctrm050;
     |BUCLE Reservas2;
     |BUCLE Reservas3;
     |BUCLE CosteSocio;
     |CIERRA #62;
     |CIERRA #66;
|FPRC;

|PROGRAMA;
     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     |PINPA #0#0; nPanta = FSalida;
     eaNomLogo = #100#1;
     |HAZ TraeLogoPan;
     enPantaLogo = nPanta;
     |HAZ PintaLogoPan;

     fHoy = ~;
     aAlfa = fHoy % 704; #0#0 = aAlfa;
     aAlfa = fHoy % 402; #0#1 = aAlfa; #0#3 = aAlfa;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
