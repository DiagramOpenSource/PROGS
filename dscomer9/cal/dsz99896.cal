|FICHEROS;
     agifa212 #0,MANTE;
     agifa007@ #7;
|FINSI;

|VARIABLES;
     &eaProve = "";
     &eaFPago = "";
     &enDto1 = 0;
     &enDto2 = 0;
     &enDto3 = 0;
     &eaFecConstru  = "";
     aAlfa = "";
     aSer = "";
     aNum = "";
     &enSalida = 0;
     nExiste = 0;
     aBono = "";
     aDef = "";
|FINS;

|PROGRAMA;
     ||eaFecConstru = llega cargado desde el gomatljn
     aAlfa = PARAMETRO;
     |QBF aAlfa;
     aBono = aAlfa % 101;
     aSer = aAlfa % 205;
     aNum = aAlfa % 706;

     |C_M #0#42, 1, "N";
     #0#42 = aBono;

     |PUSHV 0101 2380;
     |CLS;
     |ABRE #0;
     #0#50 = aSer;
     #0#0 = aNum;
     |LEE 101#0=;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |SI nExiste ! 0;
          |GRABA 020#0b;
          |CONFI "0000SConfirma el alta (S/N)";
     |SINO;
          FSalida = 0;
     |FINSI;
     enSalida = FSalida;
     |SI FSalida ! 0;
          |SI nExiste ! 0; |BORRA 020#0c; |FINSI;
     |SINO;
          |DDEF aDef; aDef = aDef + "agifa007";
          |CARGA_DEF aDef, agifa007@;
          |SI FSalida = 0;
               |ABRE #7;
               #7#26 = aSer;
               |LEE 020#7=;
               |CIERRA #7;
               |ATRI I;
               |PINTA 1004, #7#27;
               |ATRI 0;
               |DESCARGA_DEF #agifa007@;
          |FINSI;

          |SI nExiste = 0;
               |ENDATOS #2#0;
          |SINO;
               |SI eaProve ! ""; |Y eaFPago ! ""; || Llama agifa072
                    #0#3 = eaProve; |PINTA #0#3;
                    #0#8 = eaFPago; |PINTA #0#8;
                    #0#5 = enDto1; |PINTA #0#5;
                    #0#32 = enDto2; |PINTA #0#32;
                    #0#7 = enDto2; |PINTA #0#7;
                    |C_M #0#3, 1, "N";
                    |C_M #0#8, 1, "N";
                    |C_M #0#5, 1, "N";
                    |C_M #0#32, 1, "N";
                    |C_M #0#7, 1, "N";
               |FINSI;
               |ENDATOS #1#0;
          |FINSI;
          enSalida = FSalida;
          |SI FSalida ! 0;
               |SI nExiste ! 0; |BORRA 020#0c; |FINSI;
          |SINO;
               |GRABA 020#0a;
               enSalida = FSalida;
          |FINSI;
     |FINSI;
     |CIERRA #0;
     |POPV;
|FPRO;
