|FICHEROS;
     vigz0029 #0;
     vigm0001 #1;
     vigm0037 #37;
     vigm0038 #38;
|FIN;

|VARIABLES;
     &Tempo = "";
     &efCaduca = @;
     i = 0;
     nUni = 0;
     nNume = 0;
|FIN;

|PROCESO vigm0038;
     |DDEFECTO #1;
     #1#0 = #38#5;
     |LEE 000#1=;

     efCaduca = #0#0;
     |SI #1#5 = "M";
          nNume = (#1#4/1000);
          efCaduca = efCaduca + nNume;
     |SINO;
          efCaduca = efCaduca + #1#4;
     |FINSI;

     |PARA i = 1; |SI i [ #38#7; |HACIENDO i = i + 1;
          |PRINT;
          |PIEINF;
     |SIGUE;
|FPRC;

|DEFBUCLE vigm0037;
     #37#1;
     ;
     #0#0;
     #0#0;
     ;
     NULL, NULL, vigm0038;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "vigz0029";
          |SI FSalida = 0;
               |ABRE #1;
               |BUCLE vigm0037;
               |CIERRA #1;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'vigz0029'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
