     Sacado del ortsa016 (ortsm016)

|FICHEROS;
     ortsm017 #17,MANTE;  ||Ped Combi
     ortsm018 #18,MANTE;  ||Ped Combi
     ortsm029 #29;
     ortsm030 #30;
|FIN

|VARIABLES;
     &eaSerie = "";
     &enCodigo = 0;
     &enLinea = 0;
     nModo = 0;
     aVer = "";
     nBtnHerraje = 0;
     nBtnCanteado = 0;
|FIN;

|PROCESO Componentes;
|FPRC;

|PROCESO TecOrt11;
     |HAZ TecOrt17;
|FPRC;

|PROCESO Ort17_2;
|FPRC;

|PROCESO Min29;
     #29#0 = #17#0;
     #29#1 = #17#1;
     #29#2 = #17#2;
     #29#3 = #17#3;
     #29#4 = 001;
|FPRC;

|PROCESO Max29;
     #29#0 = #17#0;
     #29#1 = #17#1;
     #29#2 = #17#2;
     #29#3 = #17#3;
     #29#4 = 999;
|FPRC;

|PROCESO Min30;
     #30#0 = #17#0;
     #30#1 = #17#1;
     #30#2 = #17#2;
     #30#3 = #17#3;
     #30#4 = 001;
|FPRC;

|PROCESO Max30;
     #30#0 = #17#0;
     #30#1 = #17#1;
     #30#2 = #17#2;
     #30#3 = #17#3;
     #30#4 = 999;
|FPRC;

|PROCESO TecOrt17;
     |SI FSalida = 14;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#29, 4, 4, 22, 1, Min29, Max29;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
     |SI FSalida = 15;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#30, 4, 4, 22, 1, Min30, Max30;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
|FPRC;

|PROCESO Desglose0; |TIPO 0;
|FPRC;

|PROCESO Desglose7; |TIPO 7;
     |SI #17#7 > 1;
          |C_M #17#8, 1, "S";
     |SINO;
          |C_M #17#8, 1, "N";
     |FINSI;
|FPRC;

|PROCESO NoBaja; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO NoAlta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO Min18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     #18#4 = 001;
|FPRC;

|PROCESO Max18;
     #18#0 = #17#0;
     #18#1 = #17#1;
     #18#2 = #17#2;
     #18#3 = #17#3;
     #18#4 = 999;
|FPRC;

|PROCESO CombUni; |TIPO 11;
     |SI FSalida = 13;
          |SI #17#8 = "S";
               |PUSHV 0501 2380;
               |SI aVer = "S";
                    |ENTLINEAL #1#18, 5, 4, 22, 1, Min18, Max18;
               |SINO;
                    |ENTLINEAL #1#18, 5, 2, 22, 1, Min18, Max18;
               |FINSI;
               |POPV;
          |SINO;
               |MENAV "0000No tiene desglose de unidades...";
          |FINSI;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Min17;
     #17#0 = eaSerie;
     #17#1 = enCodigo;
     #17#2 = enLinea;
     #17#3 = 001;
|FPRC;

|PROCESO Max17;
     #17#0 = eaSerie;
     #17#1 = enCodigo;
     #17#2 = enLinea;
     #17#3 = 999;
|FPRC;

|PROCESO BtnHerraje;
     |PTEC 828;
|FPRC;

|PROCESO BtnCanteado;
     |PTEC 829;
|FPRC;

|PROGRAMA;
     aVer = "S";
     |PUSHV 0501 2380;
     |CONTROL_SIMPLE 0, "BOTON, F6.-Herrajes", 1303, 1315, BtnHerraje; nBtnHerraje = FSalida;
     |CONTROL_SIMPLE 0, "BOTON, F7.-Canteado", 1316, 1328, BtnCanteado; nBtnCanteado = FSalida;
     |ENTLINEAL #1#17, 4, 4, 22, 1, Min17, Max17;
     |FIN_CONTROL_WINDOWS nBtnHerraje;
     |FIN_CONTROL_WINDOWS nBtnCanteado;
     |POPV;
|FPRO;
