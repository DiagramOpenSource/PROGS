|FICHEROS;
     inmoz019 #0;
     inmom001 #1;
     inmow009 #9,MANTE;
     agifa071 #71;
|FIN;

|VARIABLES;
     &eaTexto = "";
     &enSw = 0;
     i = 0;
     aAlfa = "";
     aMarca = "";
|FIN;

|PROCESO Imprime;
     enSw = 2; |PRINT;
|FPRC;

|DEFBUCLE Imprime;
     #1#3;
     9, 29, 30, 31;
     #0#0, "                    ", #0#1, #0#2, #0#3, #0#4;
     #0#0, "zzzzzzzzzzzzzzzzzzzz", #0#1, #0#2, #0#3, #0#4;
     ;
     NULL, Imprime;
|FIN;

|PROCESO Impresion;
     Impresora = "Excel Estandard";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "inmoz019";
          |SI FSalida = 0;
               eaTexto = "ANEXO ALBARAN " + #0#2 + "/" + (("000000" + #0#3)%-106) +"/"+ (("000"+#0#4)%-103);
               enSw = 1; |PRINT;
               |BUCLE Imprime;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'inmoz019'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Min71;
     #71#29 = #0#2;
     #71#0 = #0#3;
     #71#1 = 1;
|FPRC;

|PROCESO Max71;
     #71#29 = #0#2;
     #71#0 = #0#3;
     #71#1 = 999;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #71;
     #71#29 = #0#2;
     #71#0 = #0#3;
     #71#1 = #0#4;
     |LEE 000#71];
     |CONSULTA_F_CLAVE #1#71, Min71, Max71;
     |SI FSalida = 0;
          #0#4 = #71#1; |PINTA #0#4;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #71;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida = 13;
          aMarca = "*";
          |PTEC 807;
     |FINSI;
     |SI FSalida = 14;
          aMarca = " ";
          |PTEC 807;
     |FINSI;
     |SI FSalida = 15;
          aMarca = "i";
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI #9Campo = Contenido; |Y FSalida = 0;
          |ABRE #1;
          #1#0 = #9#0;
          |LEE 121#1=;
          |SI FSalida = 0;
               |SI #9#32 = "*";
                    #9#32 = ""; |PINTA #9#32;
                    #1#29 = "";
                    #1#30 = "";
                    #1#31 = "";

                    #0#6 = #0#6 - 1;
               |SINO;
                    #9#32 = "*"; |PINTA #9#32;
                    #1#29 = #0#2;
                    #1#30 = #0#3;
                    #1#31 = #0#4;

                    #0#6 = #0#6 + 1;
               |FINSI;
               |PINTA 574, #0#6;
               |GRABA 020#9a;
               |GRABA 020#1a;
          |FINSI;
          |CIERRA #1;
     |FINSI;
|FPRC;

|PROCESO inmom001;
     |PARA i = 0; |SI i [ 31; |HACIENDO i = i + 1;
          #9i = #1i;
     |SIGUE;
     |SI #0#5 = "V";
          #9#32 = "*";
          #0#6 = #0#6 + 1;
     |FINSI;
     |GRABA 020#9n;
|FPRC;

|DEFBUCLE inmom001A;
     #1#3;
     9, 29, 30, 31;
     #0#0, "                    ", #0#1, "     ", 000000, 000;
     #0#0, "zzzzzzzzzzzzzzzzzzzz", #0#1, "     ", 000000, 999;
     ;
     NULL, inmom001;
|FIN;

|DEFBUCLE inmom001V;
     #1#3;
     9, 29, 30, 31;
     #0#0, "                    ", #0#1, #0#2, #0#3, #0#4;
     #0#0, "zzzzzzzzzzzzzzzzzzzz", #0#1, #0#2, #0#3, #0#4;
     ;
     NULL, inmom001;
|FIN;

|PROCESO Cuenta;
     #0#6 = #0#6 + 1;
|FPRC;

|DEFBUCLE Cuenta;
     #1#3;
     9, 29, 30, 31;
     #0#0, "                    ", #0#1, #0#2, #0#3, #0#4;
     #0#0, "zzzzzzzzzzzzzzzzzzzz", #0#1, #0#2, #0#3, #0#4;
     ;
     NULL, Cuenta;
|FIN;

|PROCESO Min;
     #9#0 = " " * 20;
|FPRC;

|PROCESO Max;
     #9#0 = "z" * 20;
|FPRC;

|PROCESO MarcaTodo;
     #1#0 = #9#0;
     |LEE 101#1=;
     |SI FSalida = 0;
          |SI aMarca = "*";
               #1#29 = #0#2;
               #1#30 = #0#3;
               #1#31 = #0#4;
               |SI #9#32 = " ";
                    #0#6 = #0#6 + 1;
               |FINSI;
          |SINO;
               #1#29 = "";
               #1#30 = "";
               #1#31 = "";
               |SI #9#32 = "*";
                    #0#6 = #0#6 - 1;
               |FINSI;
          |FINSI;
          #9#32 = aMarca;
          |GRABA 020#9a;
          |GRABA 020#1a;
          |LIBERA #1;
     |FINSI;
     |LIBERA #9;
|FPRC;

|DEFBUCLE MarcaTodo;
     #9#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, MarcaTodo;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aAlfa = Usuario;
     |NOME_DAT #9 aAlfa;
     |DELINDEX #9;
     |ABRE #9;
     |SI #0#5 = "A";
          |BUCLE inmom001A;
          |BUCLE Cuenta;
     |SINO;
          |BUCLE inmom001V;
     |FINSI;
     |CIERRA #9;


     |SI i = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |PARA aMarca = " "; |SI aMarca ! ""; |HACIENDO;
               aMarca = "";
               |PINPA #0#9;
               |PINTA 574, #0#6;
               |PINTA 546, #0#2;
               |PINTA 552, #0#3;
               |PINTA 559, #0#4;
               |ENTLINEAL #1#9, 1, 4, 22, 0, Min, Max;
               |SI aMarca ! "";
                    |SI aMarca = "i";
                         |HAZ Impresion;
                    |SINO;
                         |ABRE #9;
                         |ABRE #1;
                         |BUCLE MarcaTodo;
                         |CIERRA #1;
                         |CIERRA #9;
                    |FINSI;
               |FINSI;
          |SIGUE;
     |FINSI;
     |DELINDEX #9;
|FPRC;
