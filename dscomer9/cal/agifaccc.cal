|FICHEROS;
     agifaccc #0;
     agifa112 #112;
     agifa007 #7;
|FIN;

|VARIABLES;
     aImpSel = "";
     aInforme = "";
     nSwPie = 0;
     aMensaje = "";

     aParametro = "";
     aAsunto = "";
|FIN;

|PROCESO agifa112;
     |PRINT;
     nSwPie = 1;
|FPRC;

|DEFBUCLE agifa112;
 #agifa112#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, agifa112;
|FIN;

|PROCESO agifa007;
     |PRINT;
     nSwPie = 1;
|FPRC;

|DEFBUCLE agifa007;
 #agifa007#1;
 ;
 INICIO;
 FINAL;
 ;
 NULL, agifa007;
|FIN;

|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;

     |SI aParametro = "";
          |IMPRE 0;
          |SI FSalida = 0;
               aInforme = "agifaccc";
               |INFOR aInforme;
               |SI FSalida = 0;
                    |BUCLE agifa112;
                    |SI nSwPie = 1;
                         |PIEINF;
                    |FINSI;
                    |FININF;
               |SINO;
                    aMensaje = "0000Informe " + aInforme + " inaccesible.";
                    |MENAV aMensaje;
               |FINSI;
               |FINIMP;

               ||MAINCOMMAND 32929, "ToFront", "","", "", "";

               aMensaje = "0000SVolver a imprimir?";
               |CONFI aMensaje;
               |SI FSalida = 0;
                    |IMPRE 0;
                    |SI FSalida = 0;
                         aInforme = "agifacc2";
                         |INFOR aInforme;
                         |SI FSalida = 0;
                              |BUCLE agifa007;
                              |SI nSwPie = 1;
                                   |PIEINF;
                              |FINSI;
                              |FININF;
                         |SINO;
                              aMensaje = "0000Informe " + aInforme + " inaccesible.";
                              |MENAV aMensaje;
                         |FINSI;
                         |FINIMP;
                    |FINSI;
               |FINSI;
          |SINO;
               |MENAV "0000Proceso cancelado.";
          |FINSI;
     |SINO;
          |SI aParametro = "correo";
               aAsunto = "Aqui va el asunto del correo";
               Impresora = "Correo;-" + aAsunto;
               |IMPRE -1;
               |SI FSalida = 0;
                    aInforme = "agifaccc";
                    |INFOR aInforme;
                    |SI FSalida = 0;
                         |BUCLE agifa112;
                         |SI nSwPie = 1;
                              |PIEINF;
                         |FINSI;
                         |FININF;
                    |SINO;
                         aMensaje = "0000Informe " + aInforme + " inaccesible.";
                         |MENAV aMensaje;
                    |FINSI;
                    |FINIMP;
               |SINO;
                    |MENAV "0000Proceso cancelado.";
               |FINSI;
          |SINO;
               |SI aParametro = "crystal";
                    |IMPRE 0;
                    |SI FSalida = 0;
                         aImpSel = Impresora;
                         |QBF aImpSel;
                         aMensaje = "0000Impresora seleccionada: " + aImpSel;
                         |MENAV aMensaje;

/*
                         ||ARA pruebas.
                         |FINIMP;
                         |ACABA;
*/

                         aInforme = "agifaccc";
                         |INFOR aInforme;
                         |SI FSalida = 0;
                              |BUCLE agifa112;
                              |SI nSwPie = 1;
                                   |PIEINF;
                              |FINSI;
                              |FININF;
                         |SINO;
                              aMensaje = "0000Informe " + aInforme + " inaccesible.";
                              |MENAV aMensaje;
                         |FINSI;
                         |FINIMP;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRO;
