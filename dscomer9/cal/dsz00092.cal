|FICHEROS;
     dsz00092 #0;
     dsm00089 #89; || Param
     dsm00090 #90; || Histo

     dsw00084 #84; || Tmp
|FIN;

|VARIABLES;
     aCeros = "";
     aCB = "";
     aAlfa = "";
     nPos = 0;
     i = 0;
     aInforme = "";
     &enEtiq = 0;
|FIN;

|PROCESO ImpHisto;
     #90#0 = #84#0;
     |LEE 020#90=;
     |SI FSalida = 0;
          |PARA i = 1; |SI i [ #0#1; |HACIENDO i = i + 1;
               enEtiq = i;
               |PRINT;
               |PIEINF;
          |SIGUE;

          #90#2 = "S";
          |GRABA 020#90a;
     |FINSI;
|FPRC;

|DEFBUCLE ImpHisto;
     #84#1;
     ;
     "                    ";
     "zzzzzzzzzzzzzzzzzzzz";
     ;
     NULL, ImpHisto;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#0 ! "SI";
          |ACABA;
     |FINSI;


     aAlfa = Usuario;
     |NOME_DAT #84 aAlfa; |DELINDEX #84;
     |ABRE #84;

     |ABRE #89;
     |LEE 101#89p;
     |SI FSalida ! 0;
          |MENAV "0000Parametros no definidos...";
     |SINO;
          aCeros = "0" * 20;
          |ABRE #90;
          |PARA i = 1; |SI i [ #89#2; |HACIENDO i = i + 1;
               |PARA; |SI; |HACIENDO;
                    aAlfa = aCeros + #89#4;
                    #89#4 = #89#4 + 1;
                    nPos = -(#89#1 + 100);
                    aCB = aAlfa % nPos;
                    |DDEFECTO #90;
                    #90#0 = aCB;
                    |LEE 000#90=;
                    |SI FSalida ! 0; |SAL; |FINSI;
               |SIGUE;
               |GRABA 020#90n;

               #84#0 = #90#0;
               |GRABA 020#84n;
          |SIGUE;

          aInforme = #89#3; |QBF aInforme;
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR aInforme;
               |SI FSalida = 0;
                    |BUCLE ImpHisto;
                    |FININF;
               |SINO;
                    aAlfa = "0000Error en informe '" + aInforme + "'";
                    |MENAV aAlfa;
               |FINSI;
               |FINIMP;
          |FINSI;
          |GRABA 020#89a;
          |CIERRA #90;
     |FINSI;
     |CIERRA #89;

     |CIERRA #84;
     |DELINDEX #84;
|FPRC;
