|FICHEROS;
     dsm00010 #0;
|FIN;

|VARIABLES;
     nPosi     = 0;
     nLong     = 0;
     nCampo    = 0;
     nVersion  = 0;
     nNume     = 0;
     nNivelMax = 0;
     nContador = 0;

     aAlfa     = "";
     aLong     = "";
     aVersion  = "";
     aCaracter = "";
|FIN;

|PROCESO NoCarta;
     |C_M #0#47, 1, "S";
     |SI #0#46 = "N";
         |C_M #0#47, 1, "N";
         #0#47 = "N";  |PINTA #0#47;
     |FINSI;
|FPRC;

|PROCESO Entrada;
     |C_M #0#1, 1, "S";
     |SI #0Campo = 4;
         |C_M #0#1, 1, "N";
         #0#1 = "N";
         |PINTA #0#1;
    |FINSI;
|FPRC;

|PROCESO Tipo7C25;  |TIPO 7;
     |PUSHV 0501 2380;
     |D_CUADRO 0825, 1380;
     |ATRI R;
     |PINTA 0926, "-N- Entrada por  Codigo Libre.                        ";
     |PINTA 1026, "-S- Entrada por  Codigo  presentado Tablas/Defectos   ";
     |PINTA 1126, "-X- Entrada por  Codigo  sin presentar Tablas/Defectos";
     |PINTA 1226, "-F- Entrada por Unidades presentado Tablas/Defectos   ";
|FPRC;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;

     |SI Campo = 1;
         aAlfa = #0Campo;
         |C_M #0#3,  1, aAlfa;  |C_M #0#4,  1, aAlfa;
         |C_M #0#5,  1, aAlfa;  |C_M #0#6,  1, aAlfa;  |C_M #0#7,  1, aAlfa;
         |C_M #0#8,  1, aAlfa;  |C_M #0#9,  1, aAlfa;  |C_M #0#10, 1, aAlfa;
         |C_M #0#11, 1, aAlfa;  |C_M #0#12, 1, aAlfa;  |C_M #0#13, 1, aAlfa;
         |C_M #0#14, 1, aAlfa;  |C_M #0#15, 1, aAlfa;  |C_M #0#16, 1, aAlfa;
         |C_M #0#17, 1, aAlfa;  |C_M #0#18, 1, aAlfa;  |C_M #0#28, 1, aAlfa;

         |SI #0Campo = "N";
             |PDEFECTO #0, 3, 19;
         |FINSI;
     |FINSI;

     |SI Campo = 19;
         aAlfa = #0Campo;
         |C_M #0#20, 1, aAlfa;  |C_M #0#21, 1, aAlfa;  |C_M #0#22, 1, aAlfa;
         |C_M #0#23, 1, aAlfa;  |C_M #0#24, 1, aAlfa;

         |SI #0Campo = "N";  |PDEFECTO #0, 20, 26;   |FINSI;
     |FINSI;

     |SI Campo = 25;
         |C_M #0#44, 1, "S";
         |C_M #0#27, 1, "S";
         |POPV;
     |FINSI;

     |SI #0#1 = "S"; |Y #0#19 = "N";
         |C_M #0#44, 1, "S";
     |FINSI;

     |SI #0#1 = "S"; |Y #0#19 = "S";
         |C_M #0#44, 1, "S";
     |FINSI;

     |SI #0#1 = "N"; |Y #0#19 = "S";
         #0#44 = "T";  |PINTA #0#44;
         |C_M #0#44, 1, "N";
     |FINSI;

     |SI #0#1 = "N"; |Y #0#19 = "N";
         |C_M #0#25, 1, "N";
         #0#25 = "N";  |PINTA #0#25;
     |SINO;
         |C_M #0#25, 1, "S";
     |FINSI;

     |SI #0#25 = "N";
         |C_M #0#44, 1, "N";
         |C_M #0#27, 1, "N";
         #0#27 = "N";  |PINTA #0#27;
         #0#44 = " ";  |PINTA #0#44;
     |FINSI;

     |SI #0#25 = "X";
         #0#27 = "S";  |PINTA #0#27;
         |C_M #0#27, 1, "N";
     |FINSI;

     |SI #0#44 ! "N";
         #0#26 = 0;    |PINTA #0#26;  |C_M #0#26, 1, "N";
         #0#46 = "N";  |PINTA #0#46;  |C_M #0#46, 1, "N";
     |SINO;
         |C_M #0#26, 1, "S";
         |C_M #0#46, 1, "S";
     |FINSI;

     |C_M #0#29, 1, "S";
     |C_M #0#30, 1, "S";
     |C_M #0#31, 1, "S";
     |C_M #0#32, 1, "S";

     |SI #0#4  = 0;  |C_M #0#29, 1, "N";  |FINSI;
     |SI #0#8  = 0;  |C_M #0#30, 1, "N";  |FINSI;
     |SI #0#12 = 0;  |C_M #0#31, 1, "N";  |FINSI;
     |SI #0#16 = 0;  |C_M #0#32, 1, "N";  |FINSI;

     |SI Campo = 33;
         aAlfa = #0Campo;
         |C_M #0#34, 1, aAlfa;  |C_M #0#35, 1, aAlfa;
         |C_M #0#36, 1, aAlfa;  |C_M #0#37, 1, aAlfa;
         |C_M #0#38, 1, aAlfa;  |C_M #0#39, 1, aAlfa;
         |C_M #0#40, 1, aAlfa;  |C_M #0#41, 1, aAlfa;
         |C_M #0#42, 1, aAlfa;

         |SI #0#33 = "N";  |PDEFECTO #0, 34, 44;  |FINSI;
    |FINSI;

     |SI #0#25 = "X"; |O #0#25 = "S";
          |C_M #0#27, 1, "S";
     |SINO;
          |C_M #0#27, 1, "N";
     |FINSI;

    |PINDA #0#0;
|FPRC;

|PROCESO Digito;
     nContador = 0;
     |SI #0#34 = "S";  nContador = nContador + #0#4;   |FINSI;
     |SI #0#36 = "S";  nContador = nContador + #0#8;   |FINSI;
     |SI #0#38 = "S";  nContador = nContador + #0#12;  |FINSI;
     |SI #0#40 = "S";  nContador = nContador + #0#16;  |FINSI;

     nContador = nContador + #0#42;
     |SI nContador > 20;
         |MENAV "      La suma de todas las longitudes supera a 20 Caracteres";
         |ERROR;
         |ACABA;
     |FINSI;

     nNume = #0#42;  |CAMPO_ANCHO #0#43, 1, nNume;
     aAlfa = "\" + "0+#";
     |CAMPO_MAXIMO #0#43, 1, aAlfa;
|FPRC;

|PROCESO TLongitud;
     nNume = #0#4 + #0#8 + #0#12 + #0#16;
     |SI nNume > 20;
         |MENAV "      La suma de todas las longitudes supera a 20 Caracteres";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO PintaConcep;
     |ATRI N;  |PINTA 2031, #0#20;  |ATRI n;
|FPRC;

|PROCESO Nivel;
     |SI #0#25 ! "N";  |Y #0#26 = 0;  |Y #0#44 = "N";
         |MENAV "     Introduzca el Nivel de los Defectos.";
         |ERROR;
         |ACABA;
     |FINSI;

     nNivelMax = 1;
     |SI #0#8  ! 0;  nNivelMax = 2;  |FINSI;
     |SI #0#12 ! 0;  nNivelMax = 3;  |FINSI;
     |SI #0#16 ! 0;  nNivelMax = 4;  |FINSI;

     |SI #0#26 > nNivelMax;
         |MENAV "      Nivel Erroneo";
         |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     |VERSIONRTME aAlfa;
     aLong = aAlfa % 0;
     nLong = aLong;
     aVersion = "";
     |PARA nCampo = 1;  |SI nCampo [ nLong;  |HACIENDO nCampo = nCampo + 1;
           nPosi = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = ".";  |SAL;  |FINSI;

           aVersion = aVersion + aCaracter;
     |SIGUE;

     nVersion = aVersion;

     |SI nVersion < 9;
         |MENAV "      Programa ejecutable solamente en Diagram9.09E o superior.";
         |ACABA;
     |SINO;
         |SI nVersion = 9;
              |QBT aAlfa;
              |SI aAlfa < "9.09E"
                   |MENAV "      Programa ejecutable solamente en Diagram9.09E o superior.";
                   |ACABA;
              |FINSI;
         |FINSI;
     |FINSI;

     |CLS;
     |CABEZA "Emision Masiva";

     |PINPA #0#0;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

     nNume = #0#42;  |CAMPO_ANCHO #0#43, 1, nNume;
     aAlfa = "\" + "0+#";
     |CAMPO_MAXIMO #0#43, 1, aAlfa;

     |PINDA #0#0;
     |ATRI N;  |PINTA 2031, #0#20;  |ATRI n;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;

     |SUB_EJECUTA_NP "dsz99990;N";
|FPRO;

|PROCESO Modi49; |TIPO 7;
     |SI #0#2 = 1; |Y #0#8 = 0;
          |C_M #0#49, 1, "S";
     |SINO;
          |C_M #0#49, 1, "N";
     |FINSI;
|FPRC;
