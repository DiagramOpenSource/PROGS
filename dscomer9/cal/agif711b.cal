     TallerMarcaVO

|FICHEROS;
     agifa727;
     agifa715;
     &con00620@;
     referen1@;
     referen2@;
     &FMaster@;
|FIN;

|VARIABLES;
     &eaSerFac = "";
     &enNumFac = 0;
     &enSwTaller = 0;
     &enSwAgifa079 = 0;
     aAlfa = "";
     aPath = "";
     aCta = "";
|FIN;

|PROCESO TallerMarcaVO;
     |SI enSwTaller = 0; |Y enSwAgifa079 > 0;
          |DDEF aAlfa;
          aAlfa = aAlfa + "con00620";
          |CARGA_DEF aAlfa, con00620@;
          |SI FSalida = 0;
               |ABRE #con00620@;
               #con00620@#0 = eaSerFac;
               #con00620@#1 = enNumFac;
               |LEE 101#con00620@.=;
               |SI FSalida = 0;
                    #con00620@#13 = "S";
                    |GRABA 020#con00620@.a;
                    |LIBERA #con00620@;
               |FINSI;
               |CIERRA #con00620@;
               |DESCARGA_DEF #con00620@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO TallerCuentaSeccion;
     || Modifica el camop 37 con la Cta contable de la seccion

     aCta = "";
     |DDEF aPath;
     aAlfa = aPath + "con00005";
     |CARGA_DEF aAlfa, referen1@;
     |SI FSalida = 0;
          aAlfa = aPath + "con00002";
          |CARGA_DEF aAlfa, referen2@;
          |SI FSalida = 0;
               |ABRE #referen1@;
               #referen1@#0 = #FMaster@#27;
               #referen1@#1 = #FMaster@#0;
               #referen1@#2 = #FMaster@#1;
               |LEE 000#referen1@.=;
               |SI FSalida ! 0; |DDEFECTO #referen1@; |FINSI;
               |CIERRA #referen1@;

               |ABRE #referen2@;
               #referen2@#0 = #referen1@#3
               |LEE 000#referen2@.=;
               |SI FSalida ! 0; |DDEFECTO #referen2@; |FINSI;
               |CIERRA #referen2@;
               aCta = #referen2@#2;
               |DESCARGA_DEF #referen2@;
          |FINSI;
          |DESCARGA_DEF #referen1@;
     |FINSI;

     #agifa715#0 = "agifa080";
     #agifa715#1 = 37;
     |LEE 101#agifa715.=;
     |SI FSalida = 0;
          #agifa715#3 = aCta;
          |GRABA 020#agifa715.a;
          |LIBERA #agifa715;
     |FINSI;
|FPRC;
