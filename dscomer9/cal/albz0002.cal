|FICHEROS;
     albz0002 #0;
     albw0005 #1;
     agifa019 #2;

     albm0014 #14;
     albm0015 #15;
     albm0016 #16;
     albm0017 #17;
     albm0018 #18;
     albm0019 #19;
|FIN;

|VARIABLES;
     nSwSal = 0;
     aAlfa = "";
     aUsu = "";
     nConta = 0;
     aDes = "";
     aAbre = "";
     i = 0;
|FIN;

|PROCESO Descri; |TIPO 0;
     |DDEFECTO #14;
     |ABRE #14;
     #14#0 = #0#0;
     |LEE 000#14=;
     |CIERRA #14;
     aDes = #14#1; |QBF aDes;
     aAbre = #14#2; |QBF aAbre;

     |DDEFECTO #15;
     |ABRE #15;
     #15#0 = #0#1;
     |LEE 000#15=;
     |CIERRA #15;
     aDes = aDes + " " + #15#1; |QBF aDes;
     aAbre = aAbre + " " + #15#2; |QBF aAbre;

     |DDEFECTO #16;
     |ABRE #16;
     #16#0 = #0#2;
     |LEE 000#16=;
     |CIERRA #16;
     aDes = aDes + " " + #16#1; |QBF aDes;
     aAbre = aAbre + " " + #16#2; |QBF aAbre;

     |DDEFECTO #17;
     |ABRE #17;
     #17#0 = #0#3;
     |LEE 000#17=;
     |CIERRA #17;
     aDes = aDes + " " + #17#1; |QBF aDes;
     aAbre = aAbre + " " + #17#2; |QBF aAbre;


     |ABRE #18;
     |PARA i = 4; |SI i [ 8; |HACIENDO i = i + 1;
          |DDEFECTO #18;
          #18#0 = #0i;
          |LEE 000#18=;
          aDes = aDes + " " + #18#1; |QBF aDes;
          aAbre = aAbre + " " + #18#2; |QBF aAbre;
     |SIGUE;
     |CIERRA #18;

     #0#9 = aDes;
     #0#10 = aAbre;
     |PINTA #0#9;
     |PINTA #0#10;
|FPRC;

|PROCESO albm0014;
     nConta = nConta + 1;
     |SI nConta > 20; |ERROR10; |FINSI;
     #1#0 = #14#0;
     #1#1 = #14#1;
     #1#2 = #14#2;
     |SI #1#0 ! "    "; |GRABA 020#1n; |FINSI;
|FPRC;

|PROCESO albm0015;
     nConta = nConta + 1;
     |SI nConta > 20; |ERROR10; |FINSI;
     #1#0 = #15#0;
     #1#1 = #15#1;
     #1#2 = #15#2;
     |SI #1#0 ! "    "; |GRABA 020#1n; |FINSI;
|FPRC;

|PROCESO albm0016;
     nConta = nConta + 1;
     |SI nConta > 20; |ERROR10; |FINSI;
     #1#0 = #16#0;
     #1#1 = #16#1;
     #1#2 = #16#2;
     |SI #1#0 ! "    "; |GRABA 020#1n; |FINSI;
|FPRC;

|PROCESO albm0017;
     nConta = nConta + 1;
     |SI nConta > 20; |ERROR10; |FINSI;
     #1#0 = #17#0;
     #1#1 = #17#1;
     #1#2 = #17#2;
     |SI #1#0 ! "    "; |GRABA 020#1n; |FINSI;
|FPRC;

|PROCESO albm0018;
     nConta = nConta + 1;
     |SI nConta > 20; |ERROR10; |FINSI;
     #1#0 = #18#0;
     #1#1 = #18#1;
     #1#2 = #18#2;
     |SI #1#0 ! "    "; |GRABA 020#1n; |FINSI;
|FPRC;

|DEFBUCLE albm0014;
     #14#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, albm0014;
|FIN;

|DEFBUCLE albm0015;
     #15#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, albm0015;
|FIN;

|DEFBUCLE albm0016;
     #16#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, albm0016;
|FIN;

|DEFBUCLE albm0017;
     #17#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, albm0017;
|FIN;

|DEFBUCLE albm0018;
     #18#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, albm0018;
|FIN;

|PROCESO Min;
     #1#0 = "    ";
|FPRC;

|PROCESO Max;
     #1#0 = "zzzz";
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #19; |LEE 000#19p; |CIERRA #19;
     aAlfa = "";
     |PARA i = 0; |SI i [ 8; |HACIENDO i = i + 1;
          aAlfa = aAlfa + #0i;
          |QBF aAlfa;
     |SIGUE;

     |DDEFECTO #2;
     |ABRE #2;
     #2#0 = aAlfa;
     |LEE 101#2=;
     |SI FSalida = 0;
          |CONFI "0000NEl Articulo existe. Actualizar";
          |SI FSalida ! 0;
               |CIERRA #2;
               |ACABA;
          |FINSI;
     |SINO;
          #2#134 = aAlfa; ||Arti Prov.
          |GRABA 020#2b;
     |FINSI;
     #2#125 = #19#1; ||Linea
     #2#20 = #19#2;  ||Tipo IVA
     #2#5 = #19#3;   ||Uni Med
     #2#180 = #19#4; ||Partida
     #2#179 = #19#5; ||Doble Stock
     #2#201 = #19#6; ||Codigo Unidades;

     #2#2 = #14#3;   ||Familia
     #2#3 = #16#3;   ||Subfam
     #2#200 = #18#3; ||Grupo
     #2#126 = #15#3; ||Marca

     #2#1 = #0#9;     ||Des     = dES
     #2#195 = #0#10;  ||Des Prv = Abr

     |GRABA 020#2a;
     |CIERRA #2;
|FPRC;

|PROCESO Alta;
     |SI Campo = 0;
          |ABRE #14;
          #14#0 = #0Campo;
          |LEE 000#14=;
          |CIERRA #14;
          #1#0 = #14#0;
          #1#1 = #14#1;
          #1#2 = #14#2;
          |GRABA 020#1n;
     |FINSI;
     |SI Campo = 1;
          |ABRE #15;
          #15#0 = #0Campo;
          |LEE 000#15=;
          |CIERRA #15;
          #1#0 = #15#0;
          #1#1 = #15#1;
          #1#2 = #15#2;
          |GRABA 020#1n;
     |FINSI;
     |SI Campo = 2;
          |ABRE #16;
          #16#0 = #0Campo;
          |LEE 000#16=;
          |CIERRA #15;
          #1#0 = #16#0;
          #1#1 = #16#1;
          #1#2 = #16#2;
          |GRABA 020#1n;
     |FINSI;
     |SI Campo = 3;
          |ABRE #17;
          #17#0 = #0Campo;
          |LEE 000#17=;
          |CIERRA #17;
          #1#0 = #17#0;
          #1#1 = #17#1;
          #1#2 = #17#2;
          |GRABA 020#1n;
     |FINSI;
     |SI Campo ] 4;
          |ABRE #18;
          #18#0 = #0Campo;
          |LEE 000#18=;
          |CIERRA #18;
          #1#0 = #18#0;
          #1#1 = #18#1;
          #1#2 = #18#2;
          |GRABA 020#1n;
     |FINSI;
|FPRC;

|PROCESO Lineal; |TIPO 7;
     nConta = Campo;
     |SI nConta ] 4;
          nConta = 5;
     |SINO;
          nConta = nConta + 1;
     |FINSI;

     aAlfa = nConta + aUsu;
     |NOME_DAT #1 aAlfa;

     aAlfa = #0Campo; |QBF aAlfa;
     |ABRE #1;
     #1#0 = #0Campo;
     |LEE 101#1=;
     |SI FSalida ! 0; |Y aAlfa ! "";
          |HAZ Alta;
     |FINSI;
     |CIERRA #1;


     |ENTLINEAL #1#1, 1, 7, 22, 0, Min, Max;
|FPRC;

|PROGRAMA;
     |CLS;
     aUsu = Usuario; |QBF aUsu;

     aAlfa = "1" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     nConta = 0;
     |ABRE #1; |BUCLE albm0014; |CIERRA #1;
     aAlfa = "2" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     nConta = 0;
     |ABRE #1; |BUCLE albm0015; |CIERRA #1;
     aAlfa = "3" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     nConta = 0;
     |ABRE #1; |BUCLE albm0016; |CIERRA #1;
     aAlfa = "4" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     nConta = 0;
     |ABRE #1; |BUCLE albm0017; |CIERRA #1;
     aAlfa = "5" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     nConta = 0;
     |ABRE #1; |BUCLE albm0018; |CIERRA #1;

     |PINPA #0#0;
     |ENTLINEAL #1#1, 1, 7, 22, 0, Min, Max;
     |PARA FSalida = 0; |SI FSalida = 0; |HACIENDO;
          |DDEFECTO #0;
          |PINDA #0#0;
          |ENDATOS #1#0;
     |SIGUE;

     aAlfa = "1" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     aAlfa = "2" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     aAlfa = "3" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     aAlfa = "4" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
     aAlfa = "5" + aUsu; |NOME_DAT #1 aAlfa; |DELINDEX #1;
|FPRO;
