|FICHEROS;
     cafe0007 #0;
     agifa010 #10;
     agifa024 #24;
     agis0002 #148;
     psioa033 #33;
|FIN;

|VARIABLES;
     &nSw      = 0;
     &nCobra   = 0;
     &nEntrega = 0;
     &acliente = "";
     &swImpTot = 0;
     &aCliAnt = "";
     aInforme  = "cafe0007";
     &nPenEnt   = 0;
     &nPenTot   = 0;
     nHay      = 0;
     nHayRec   = 0;
     &EURODB = 0;
|FIN;

|PROCESO Min2;
     #33#1 = #0#1;
     #33#0 = "      ";
|FPRC;

|PROCESO Max2;
     #33#1 = #0#1;
     #33#0 = "zzzzzz";
|FPRC;

|PROCESO Min1;
     #33#1 = #0#0;
     #33#0 = "      ";
|FPRC;

|PROCESO Max1;
     #33#1 = #0#0;
     #33#0 = "zzzzzz";
|FPRC;

|PROCESO agifa148Impre;
     |SI nSw = 1;
          nHayRec = 1;
          |ERROR10;
     |SINO;
          nSw = 3; |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE agifa148Impre;
     #148#1;
     ;
     "A", #10#52, #10#0, 001;
     "A", #10#52, #10#0, 999;
     ;
     NULL, agifa148Impre;
|FIN;

|PROCESO agifa148Suma;
     nEntrega = nEntrega + #148#9;
     |SI #148#13 = "S"; |O #148#22 ! 2; || si es dstinto de 02 se da por cobrado
          nCobra = nCobra + #148#9;
     |FINSI;
|FPRC;

|DEFBUCLE agifa148Suma;
     #148#1;
     ;
     "A", #10#52, #10#0, 001;
     "A", #10#52, #10#0, 999;
     ;
     NULL, agifa148Suma;
|FIN;

|PROCESO agifa010;
     |DDEFECTO #24;
     #24#0 = #10#3;
     |LEE 000#24=;

     |SI #24#189 < #0#2; |O #24#189 > #0#3; |ACABA; |FINSI; ||Ruta

     |SI #0#9 = "F";
          acliente = #24#1; ||nombre fiscal
     |SINO;
          acliente = #24#2; ||nombre comercial
     |FINSI;

     nEntrega = 0;
     nCobra = 0;
     |BUCLE agifa148Suma;

     nEntrega = nEntrega ! EURODB;
     nCobra = nCobra ! EURODB;

     nPenEnt = nEntrega - nCobra;
     nPenTot = #10#78 - nCobra;

     ||SI nPenTot > 0;
     |SI nPenTot ! 0;
          nHay = 1;
          |SI aCliAnt ! #agifa010#3; |Y aCliAnt ! "";
               nSw = 4; |PRINT;
          |FINSI;
          aCliAnt = #agifa010#3;
          nSw = 1; |PRINT;

          |SI #0#8 = "S";
               nHayRec = 0;
               |BUCLE agifa148Impre;
               |SI nHayRec ! 0;
                    nSw = 2; |PRINT;
                    |BUCLE agifa148Impre;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa010;
     #10#3;
     6, 84;
     #33#1, #0#6, "     ", 000001, #0#4, #33#2;
     #33#1, #0#7, "zzzzz", 999999, #0#5, #33#2;
     ;
     NULL, agifa010;
|FIN;

|PROCESO psioa033;
     |BUCLE agifa010;
|FPRC;

|DEFBUCLE psioa033;
     #33#1;
     ;
     #0#2, #0#0, 0001;
     #0#3, #0#1, 9999;
     ;
     NULL, psioa033;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR aInforme;
          |SI FSalida = 0;
               |ABRE #24;
               |BUCLE psioa033;
               |CIERRA #24;
               |SI nHay ! 0;
                    nSw = 4; |PRINT;
                    |PIEINF;
               |FINSI;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
