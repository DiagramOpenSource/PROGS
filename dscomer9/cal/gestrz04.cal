|FICHEROS;
     gestrm01 #1;
     dsl00001 #10;
     agifa019 #19,MANTE;
     agifa060 #60,MANTE;
     agi00063 #63,MANTE;
     agifa120 #120,MANTE;
|FIN;

|VARIABLES;
     aAlfa = "";
     aCodi = "";
     aTipo = "";
     nConta = 0;
|FIN;

|PROCESO CB;
     aAlfa = #19#128; |QBF aAlfa;
     |SI aAlfa ! "";
          |ABRE #10;
          |SELECT #2#10;
          #10#4 = aAlfa;
          |LEE 101#10=;
          |SI FSalida ! 0;
               |SELECT #1#10;
               |LEE 000#10u;
               |SI FSalida = 0;
                    nConta = #10#0 + 1;
               |SINO;
                    nConta = 1;
               |FINSI;
               |DDEFECTO #10;
               #10#0 = nConta;
               |GRABA 020#10b;
          |FINSI;
          #10#1 = #19#0;
          #10#2 = #19#1;
          #10#3 = #19#128;
          |GRABA 020#10a;
          |CIERRA #10;
     |FINSI;
|FPRC;

|PROGRAMA;
     aTipo = PARAMETRO % 101;
     aCodi = PARAMETRO % 2;
     |SI aTipo = "F";
          |ABRE #60;
          #60#0 = aCodi;
          |GRABA 000#60b;
          |SI FSalida = 0;
               |PINPA #0#60;
               |PINDA #0#60;
               |ENDATOS #2#60;
               |SI FSalida = 0;
                    |GRABA 020#60a;
               |SINO;
                    |BORRA 020#60c;
               |FINSI;
          |FINSI;
          |CIERRA #60;
     |FINSI;
     |SI aTipo = "S";
          |ABRE #120;
          #120#0 = aCodi;
          |GRABA 000#120b;
          |SI FSalida = 0;
               |PINPA #0#120;
               |PINDA #0#120;
               |ENDATOS #2#120;
               |SI FSalida = 0;
                    |GRABA 020#120a;
               |SINO;
                    |BORRA 020#120c;
               |FINSI;
          |FINSI;
          |CIERRA #120;
     |FINSI;
     |SI aTipo = "M";
          |ABRE #63;
          #63#0 = aCodi;
          |GRABA 000#63b;
          |SI FSalida = 0;
               |PINPA #0#63;
               |PINDA #0#63;
               |ENDATOS #2#63;
               |SI FSalida = 0;
                    |GRABA 020#63a;
               |SINO;
                    |BORRA 020#63c;
               |FINSI;
          |FINSI;
          |CIERRA #63;
     |FINSI;
     |SI aTipo = "A";
          |ABRE #1; |LEE 000#1p; |CIERRA #1;
          #19#125 = #1#38;
          #19#5 = #1#39;
          #19#180 = #1#40;
          #19#179 = #1#41;
          |SI #1#41 = "S";
               #19#201 = #1#42;
          |FINSI;

          aAlfa = aCodi % 103; #19#2 = aAlfa;
          aAlfa = aCodi % 403; #19#3 = aAlfa;
          aAlfa = aCodi % 703; #19#126 = aAlfa;
          aAlfa = aCodi % 1250; #19#1 = aAlfa;
          aCodi = aCodi % 111;

          |ABRE #19;
          #19#0 = aCodi;
          |GRABA 000#19b;
          |SI FSalida = 0;
               #19#128 = aCodi;
               |PINPA #0#19;
               |PINDA #0#19;
               |ENDATOS #2#19;
               |SI FSalida = 0;
                    |HAZ CB;
                    |GRABA 020#19a;
               |SINO;
                    |BORRA 020#19c;
               |FINSI;
          |FINSI;
          |CIERRA #19;
     |FINSI;
|FPRO;
