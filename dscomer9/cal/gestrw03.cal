|FICHEROS;
     gestrw03 #0;
     gestrm01 #1;
     gestrm02 #2;
     gestrm04 #4;
|FIN;

|VARIABLES;
     &Tempo = "";
     aLinea = "";
     aArti = "";
     nModo = 0;
     nSuma = 0;
     aAlfa = "";
|FIN;

|PROCESO gestrm02;
     #0#0 = #2#0;
     #0#1 = #2#1;
     #0#2 = 0;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE gestrm02;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, gestrm02;
|FIN;

|PROCESO gestrm04;
     #2#0 = #4#1;
     |LEE 000#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     #0#0 = #4#1;
     #0#1 = #2#1;
     #0#2 = #4#2;
     |GRABA 020#0n;
|FPRC;

|DEFBUCLE gestrm04;
     #4#1;
     ;
     aArti, 00;
     aArti, 99;
     ;
     NULL, gestrm04;
|FIN;

|PROCESO Borra4;
     |BORRA 020#4a;
|FPRC;

|DEFBUCLE Borra4;
     #4#1;
     ;
     aArti, 00;
     aArti, 99;
     be;
     NULL, Borra4;
|FIN;

|PROCESO Tmp;
     |SI #0#2 ! 0;
          #4#0 = aArti;
          #4#1 = #0#0;
          #4#2 = #0#2;
          |GRABA 020#4n;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Suma;
     nSuma = nSuma + #0#2;
|FPRC;

|DEFBUCLE Suma;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Suma;
|FIN;
|PROCESO Min;
     #0#0 = 00;
|FPRC;

|PROCESO Max;
     #0#0 = 99;
|FPRC;

|PROCESO NoAlta;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |AVISO;
          |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     aLinea = PARAMETRO % 102;
     aArti = PARAMETRO % 3;
     |ABRE #1; |LEE 000#1p; |CIERRA #1;
     |SI aLinea = #1#45; |O aLinea = #1#46;
          |BLANCO 0718 2170;
          |HAZ CreaTempo;
          |NOME_DAT #0 Tempo; |DELINDEX #0; |ABRE #0;
          |ABRE #4;
          #4#0 = aArti;
          #4#1 = 0;
          |LEE 000#4];
          |SI FSalida ! 0; |O #4#0 ! aArti;
               |BUCLE gestrm02;
          |SINO;
               |ABRE #2;
               |BUCLE gestrm04;
               |CIERRA #2;
          |FINSI;
          |CIERRA #4;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#0, 1, 2, 19, 1, Min, Max;
               nSuma = 0;
               |BUCLE Suma;
               |SI nSuma ! 100;
                    aAlfa = "0000La suma de porcentajes:" + nSuma + "%, no es el 100% ...";
                    |MENAV aAlfa;
               |SINO;
                    |SAL;
               |FINSI;
          |SIGUE;
          |BUCLE Borra4;
          |ABRE #4;
          |BUCLE Tmp;
          |CIERRA #4;
          |CIERRA #0; |DELINDEX #0; |HAZ BoraTempo;
     |FINSI;
|FPRO;
