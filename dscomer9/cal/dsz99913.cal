     AlbaLinAutoAlta, AlbaLinAutoBaja

|FICHEROS;
     albad044@;
     agifa010 #10;
     agifa071 #71;
     agifa019 #19;
     agifa024 #24;
|FIN;

|VARIABLES;
     aAlfa = "";
     nSal = 0;
     aArti = "";
     nLin = 0;

     &aParam = "";
     &n_dec = 0;
     &uni_dt = 0;   || Unidades
     &fed_dt = @;   || Fecha....
     &art_dt = "";  || Articulo.
     &cli_dt = "";  || Cliente..
     &fam_dt = "";  || Familia.
     &iva_dt = 0;   || Tipo Iva.
     &dtos_2 = 0;   || Descuento 2.
     &dto_pt = 0;   || Descuento Ptas.
     &dtos_1 = 0;   || Descuento 1.
     &pvp_ve = 0;   || Precio Venta.
     &tarifa = 0;   || Tarifa Cliente.
     &quedto = 0;   || 1=cli./art, 2=cli./familia, 3=cli./subfam.
     &gru_dt = "";  || Grupo Cliente.
     &nPromo = 0;
     &enMensaje = 0;

     &enDescuento1 = 0;
     &enDescuento2 = 0;
     &eaTComision  = "";
     &enComision   = 0;
|FIN;

|INCLUYE i_varart;

|PROCESO Precio_divisa;
     #71#36 = #71#6 / #10#74 * #10#69;
     |SI #10#70 = "D";
          #71#6 = #71#36 / #10#69 * #10#74;
    |SINO;
          #71#36 = #71#6 / #10#74 * #10#69;
    |FINSI;

    |SI #10#70 = "D";
          #71#38 = #71#6;
    |SINO;
          #71#38 = #71#36;
    |FINSI;
|FPRC;

|PROCESO SacaPrecio;
     aParam = "";
     fed_dt = #10#1;   || Fecha....
     art_dt = #71#2;   || Articulo.
     cli_dt = #71#15;  || Cliente..
     fam_dt = #71#13;  || Familia.
     iva_dt = #19#30;  || Tipo Iva.
     dtos_2 = 0;      || Descuento 2.
     dto_pt = 0;      || Descuento Ptas.
     dtos_1 = 0;      || Descuento 1.
     pvp_ve = 0;      || Precio Venta.
     tarifa = #24#39;  || Tarifa Cliente....
     gru_dt = #24#158; || Grupo Cliente.
     nPromo = #10#89;
     |SI #71#35 ! 0;
          uni_dt = #71#35;
     |SINO;
          uni_dt = #71#5;
     |FINSI;
     enMensaje = 0;

     eaSerie = #71#29;
     enDirEnt = #10#84;
     enAlmacen = #71#3;
     |HAZ calcdtos;              || Calculo Dtos.....
     #71#6   = pvp_ve - dto_pt;   || Precio Venta. sin iva.
     #71#8   = dtos_1;            || 1¦ Dto.
     #71#33  = dtos_2;            || 2§ Dto.

     |HAZ Precio_divisa;
/*
     enDescuento1 = #71#8;
     enDescuento2 = #71#33;
     eaTComision  = #71#16;
     eaCliente    = #10#3;
     eaArticulo   = #71#2;
     eaRepre      = #10#6;
     efFecha      = #10#1;
     enDirEnt = #10#84;
     enAlmacen = #71#3;
     |HAZ Comisiones;
     #71#10 = enComision;
*/
|FPRC;

|PROCESO CreaAuto;
     nSal = 1;
     |DDEF aAlfa;
     aAlfa = aAlfa + "albad044";
     |CARGA_DEF aAlfa, albad044@;
     |SI FSalida = 0;
          |ABRE #albad044@;
          #albad044@#0 = #10#52;
          |LEE 000#albad044@.=;
          |SI FSalida = 0; |Y #albad044@#1 = "S";
               nSal = 0;
               aArti = #albad044@#2;
          |FINSI;
          |CIERRA #albad044@;
          |DESCARGA_DEF #albad044@;
     |FINSI;
     FSalida = nSal;
|FPRC;

|PROCESO AlbaLinAutoAlta;
     |HAZ CreaAuto;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #19;
     #19#0 = aArti;
     |LEE 000#19=;
     |CIERRA #19;

     |ABRE #24;
     #24#0 = #10#3;
     |LEE 000#24=;
     |CIERRA #24;

     #71#29 = #10#52;
     #71#0 = #10#0;
     #71#1 = 999;
     |LEE 000#71];
     |SI FSalida = 0;
          |LEE 000#71a;
     |SINO;
          |LEE 000#71u;
     |FINSI;
     |SI FSalida = 0; |Y #71#29 = #10#52; |Y #71#0 = #10#0;
          nLin = #71#1 + 1;
     |SINO;
          |ACABA;   || esto no debe de pasar nunca
     |FINSI;

     |DDEFECTO #71;
     #71#29 = #10#52;
     #71#0 = #10#0;
     #71#1 = nLin;
     #71#2 = #19#0;
     #71#3 = 1;
     #71#4 = #19#1;
     #71#5 = 1;
     #71#11 = #19#30;
     #71#13 = #19#2;
     #71#15 = #10#3;
     #71#16 = #10#34;
     #71#17 = #10#35;

     |HAZ SacaPrecio;
     |GRABA 020#71b;

     |HAZ TotalLin71;
     enForma = 1;
     |HAZ AcumulaAV;
     #71#14 = enCoste;

     |GRABA 020#71a;
     |LIBERA #71;
|FPRC;

|PROCESO AlbaLinAutoBaja;
     |HAZ CreaAuto;
     |SI FSalida ! 0; |ACABA; |FINSI;

     |ABRE #71;
     #71#29 = #10#52;
     #71#0 = #10#0;
     #71#1 = 999;
     |LEE 000#71];
     |SI FSalida = 0;
          |LEE 000#71a;
     |SINO;
          |LEE 000#71u;
     |FINSI;
     |SI FSalida = 0; |Y #71#29 = #10#52; |Y #71#0 = #10#0;
          nLin = #71#1;
     |SINO;
          |ACABA;   || esto no debe de pasar nunca
     |FINSI;

     #71#29 = #10#52;
     #71#0 = #10#0;
     #71#1 = nLin;
     |LEE 101#71=;
     |SI FSalida = 0; |Y #71#2 = aArti;
          enForma = -1;
          |HAZ AcumulaAV;
          |BORRA 020#71a;
          |HAZ LimCabAgifa010;
          |BUCLELIN 0 CalCabAgifa010 #10;
          |GRABA 020#10a;
          |PINDA #0#10;
     |FINSI;
     |CIERRA #71;
|FPRC;
