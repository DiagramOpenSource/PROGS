          || Crea /Borra paquetes.... llamado desde el agifa073

|FICHEROS;
     mecam001 #1;
     mecam006 #6;
     mecam007 #7;
     mecam008 #8;
|FIN;

|VARIABLES;
     &eaSerie = "";
     &enDocu = 0;
     &enLinea = 0;
     &eaArticulo = "";
     &enMedida1 = 0;
     &enUnidades = 0;
     nUnidades = 0;
     i = 0;
     nConta = 0;
     nPaquetes = 0;
     nUni = 0;
|FIN;

|PROCESO BorMecam008;
     |BORRA 020#8a;
     #7#0 = #8#0;
     #7#1 = #8#1;
     #7#2 = #8#2;
     |LEE 101#7=;
     |SI FSalida = 0;
          |BORRA 020#7a;
          |LIBERA #7;
     |FINSI;
     |LIBERA #8;
|FPRC;

|DEFBUCLE BorMecam008;
     #8#1;
     ;
     eaSerie, enDocu, 0001, enLinea;
     eaSerie, enDocu, 9999, enLinea;
     be;
     NULL, BorMecam008;
|FIN;

|PROGRAMA;
     |SI PARAMETRO = "BAJA";
          |ABRE #7;
          |BUCLE BorMecam008;
          |CIERRA #7;
     |SINO;
          |ABRE #1;
          #1#0 = eaArticulo;
          |LEE 000#1=;
          |CIERRA #1;

          |ABRE #6;
          #6#0 = eaSerie;
          #6#1 = enDocu;
          #6#2 = enLinea;
          |LEE 000#6=;
          |CIERRA #6;


          |ABRE #7;
          |ABRE #8;

          #7#0 = eaSerie;
          #7#1 = enDocu;
          #7#2 = 9999;
          |LEE 000#7];
          |SI FSalida = 0;
               |LEE 000#7a;
          |SINO;
               |LEE 000#7u;
          |FINSI;
          |SI FSalida = 0; |Y #7#0 = eaSerie; |Y #7#1 = enDocu;
               nConta = #7#2 + 1;
          |SINO;
               nConta = 1;
          |FINSI;

          nUnidades = enUnidades;
          |SI enUnidades < 0;
               nUnidades = -enUnidades;
          |FINSI;

          |DDEFECTO #7;
          nPaquetes = nUnidades / #1#1;
          nUni = 0;
          |PARA i = 1; |SI i [ nPaquetes; |HACIENDO i = i + 1;
               #7#0 = eaSerie;
               #7#1 = enDocu;
               #7#2 = nConta;
               #7#3 = eaArticulo;
               #7#4 = #1#1;
               #7#5 = #6#14;
               #7#6 = #6#8;
               |GRABA 020#7n;
               #8#0 = #7#0;
               #8#1 = #7#1;
               #8#2 = #7#2;
               #8#3 = enLinea;
               #8#4 = enMedida1;
               #8#5 = #1#1;
               |GRABA 020#8n;

               nConta = nConta + 1;
               nUni = nUni + #1#1;
          |SIGUE;
          |SI nUni ! nUnidades; |Y nUnidades ! 0; |Y #1#1 ! 0;
               #7#0 = eaSerie;
               #7#1 = enDocu;
               #7#2 = nConta;
               #7#3 = eaArticulo;
               #7#4 = nUnidades - nUni;
               #7#5 = #6#14;
               #7#6 = #6#8;
               |GRABA 020#7n;
               #8#0 = #7#0;
               #8#1 = #7#1;
               #8#2 = #7#2;
               #8#3 = enLinea;
               #8#4 = enMedida1;
               #8#5 = nUnidades - nUni;
               |GRABA 020#8n;
          |FINSI;
          |CIERRA #7;
          |CIERRA #8;
     |FINSI;
|FPRO;
