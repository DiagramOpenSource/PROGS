|FICHEROS;
     vipez011 #0;

     vipem007 #7;
     vipem021 #21;
|FIN;

|VARIABLES;
     nExiste = 0;
     aMensaje = "";
     fFechaPro = @;
|FIN;

|PROCESO vipem021;
     |SI #vipem021#4 > fFechaPro;
          fFechaPro = #vipem021#4;
     |FINSI;
|FPRC;

|DEFBUCLE vipem021;
 #vipem021#1;
 ;
 #vipem007#0, 01;
 #vipem007#0, 99;
 ;
 NULL, vipem021;
|FIN;

|PROCESO vipem007;

     fFechaPro = "01.01.0000";
     |BUCLE vipem021;
     |SI fFechaPro ! "01.01.0000";
          |SI #vipem007#17 ! fFechaPro;
               #vipem007#17 = fFechaPro;
               |GRABA 020#vipem007.a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vipem007;
 #vipem007#1;
 ;
 1;
 99999999;
 b;
 NULL, vipem007;
|FIN;

|PROGRAMA;
     |BUCLE vipem007;
|FPRO;
