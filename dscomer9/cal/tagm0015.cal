|FICHEROS;
     tagm0015 #0; ||Este Def.
     agifa019 #1; ||Articulos.
     tagw0015 #2; ||Auxiliar.
|FIN;
|VARIABLES;
     aFich = "";
     aDirDes = "";
     aDirOri = "";
     aAlfa   = "";
     nSal    = 0;
|FIN;

|PROCESO tagw0015;
     #1#0 = #2#0;
     |LEE 101#1=;
     |SI FSalida = 0;
          #1#97  = #2#1;
          #1#98  = #2#2;
          #1#99  = #2#3;
          #1#100 = #2#4;
          #1#101 = #2#5;
          |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|DEFBUCLE tagw0015;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,tagw0015;
|FIN;

|PROCESO agifa019;
     |PINTA 1720 , #1#0;
     |PINTA 1820 , #1#1;
     #2#0 = #1#0;
     |LEE 000#2=;
     nSal = FSalida;
     #2#1 = #1#92;    ||Total Compras Unidades.
     #2#2 = #1#93;    ||Total Compras Importe.
     #2#3 = #1#94;    ||Total Ventas  Unidades.
     #2#4 = #1#95;    ||Total Ventas  Importe.
     #2#5 = #1#96;    ||Total Margen.
     |SI nSal = 0; |GRABA 020#2a; |FINSI;
     |SI nSal ! 0; |GRABA 020#2n; |FINSI;
|FPRC;

|DEFBUCLE agifa019;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,agifa019;
|FIN;

|PROCESO ejec; |TIPO 3;
     aFich = Usuario;
     |NOME_DAT #2 aFich;
     |DELINDEX #2;
     |DFICE aDirDes;
     |DBASE aDirOri;
     aDirOri = aDirOri + "fich/";
     aAlfa   = #0#0;  aAlfa = "00000" + aAlfa;  aAlfa = aAlfa % -105;
     aDirOri = aDirOri + aAlfa + "/";
     |PATH_DAT #1 aDirOri;
     |ABRE #2;
     |BUCLE agifa019;
     |CIERRA #2;
     |PATH_DAT #1 aDirDes;
     |ABRE #1;
     |BUCLE tagw0015;
     |CIERRA #1;
     |DELINDEX #2;
|FPRC;
