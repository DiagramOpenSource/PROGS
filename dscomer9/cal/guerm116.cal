|FICHEROS;
     guerm116 #0;
     guerm117 #1,MANTE;
     guerm118 #2,MANTE;
     guerz210 #203; || Tmp .mas
|FIN;

|VARIABLES;
     nModo = 0;
     nForma = 0;
     nHandle = 0;
     nConta = 0;
     aRuta = "";
     aAlfa = "";
     aDato = "";
|FIN;

|PROCESO CargaMas;
     |ABRE #203;
     |DBASE aAlfa;
     aAlfa = aAlfa + "fich/dscomer9.dir";
     |XABRE "", aAlfa, nHandle;
     |SI FSalida ] 0;
          |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aAlfa;
               |SI FSalida < 0; |SAL; |FINSI;
               |SI nConta = 0; #203#0 = aAlfa; |FINSI;
               |SI nConta = 1;
                    #203#1 = aAlfa;
                    |GRABA 040#203n;
               |FINSI;
               nConta = (nConta + 1) $ 5;
          |SIGUE;
          |XCIERRA nHandle;
     |FINSI;
     |CIERRA #203;
|FPRC;

|PROCESO Ficheros; |TIPO 0;
     |SI FSalida = 13;  ||F5
          |ABRE #203;
          #203#0 = #2#1;
          |LEE 000#203];
          |CONSULTA_CLAVE #1#203;
          |SI FSalida = 0;
               #2#2 = #203#0; |PINTA #2#2;
          |FINSI;
          |CIERRA #203;
          |ERROR;
     |SINO;
          |DFICE aAlfa;
          aAlfa = aAlfa + #2#2; |QBF aAlfa;
          aAlfa = aAlfa + ".dat";
          |XABRE "E", aAlfa, 0;
          |SI FSalida ! 0;
               |MENAV "0000No existe fichero de datos";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Browse; |TIPO 0;
     |SI FSalida ! 13; |ACABA; |FINSI; ||F5
     aRuta = #0#1;
     |QBF aRuta;
     |SI aRuta = ""; aRuta = "*.*"; |FINSI;
     aRuta = "D" + aRuta;
     |BROWSE aRuta;
     aRuta = aRuta % 2;
     |QBF aRuta;
     #0#1 = aRuta; |PINTA #0#1;
     |SI aRuta = ""; |ERROR; |FINSI;
|FPRC;

|PROCESO Borra;
     |BORRA 020#2a;
|FPRC;

|DEFBUCLE Borra;
     #2#1;
     ;
     #1#0, 001;
     #1#0, 999;
     be;
     NULL, Borra;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nForma = 0 +. 1;
     |SI nForma = 1;
          |ENTLINEAL #1#2, 2, 2, 22, 0, Min2, Max2;
     |FINSI;
     |SI nModo = 3;
          |BUCLE Borra;
     |FINSI;
|FPRC;

|PROCESO Tipo7; |TIPO 7;
     |ENTLINEAL #1#2, 2, 7, 22, 0, Min2, Max2;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO Min2;
     #2#0 = #1#0;
     #2#1 = 001;
|FPRC;

|PROCESO Max2;
     #2#0 = #1#0;
     #2#1 = 999;
|FPRC;

|PROCESO Min1;
     #1#0 = 1;
|FPRC;

|PROCESO Max1;
     #1#0 = 999;
|FPRC;

|PROGRAMA;
     aAlfa = Usuario;
     |NOME_DAT #203 aAlfa;
     |DELINDEX #203;
     |ABRE #0;
     |LEE 101#0=;
     |SI FSalida ! 0; |HAZ Defecto; |GRABA 020#0b; |FINSI;
     |CLS;
     |PINPA #0#0;
     |ENTLINEAL #1#2, 2, 7, 22, 0, Min2, Max2;
     |ENTLINEAL #1#1, 1, 7, 22, 0, Min1, Max1;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ CargaMas;
          |ENTLINEAL #1#1, 1, 2, 22, 0, Min1, Max1;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
     |DELINDEX #203;
|FPRO;

|PROCESO Defecto;
     |ABRE #1;
     |ABRE #2;

     #1#0 = 1; #1#1 = "Presupuestos"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gopre001"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "gopre002"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 3; #2#2 = "gopre003"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 4; #2#2 = "gopre004"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 5; #2#2 = "gopre021"; |GRABA 020#2n;

     #1#0 = 2; #1#1 = "Expedientes"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gomantho"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "gomantl1"; |GRABA 020#2n;

     #1#0 = 3; #1#1 = "Certificaciones"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gocercab"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "gocerlin"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 3; #2#2 = "gocerhis"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 4; #2#2 = "guerm036"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 5; #2#2 = "guerm037"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 6; #2#2 = "guerm040"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 7; #2#2 = "guerm041"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 8; #2#2 = "guerm042"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 9; #2#2 = "guerm043"; |GRABA 020#2n;

     #1#0 = 4; #1#1 = "Adj.Expedientes"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gomatcab"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "gomatlin"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 3; #2#2 = "gomatljn"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 4; #2#2 = "goalbpa1"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 5; #2#2 = "goalbpa2"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 6; #2#2 = "goalbpa4"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 7; #2#2 = "goalbpa5"; |GRABA 020#2n;

     #1#0 = 5; #1#1 = "Albaranes"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "agifa077"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "agifa080"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 3; #2#2 = "agifa065"; |GRABA 020#2n;

     #1#0 = 6; #1#1 = "Subcontratas"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gosubcoc"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 2; #2#2 = "gosubcap"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 3; #2#2 = "gosubpar"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 4; #2#2 = "gosubdes"; |GRABA 020#2n;
     #2#0 = #1#0; #2#1 = 5; #2#2 = "gosubpa1"; |GRABA 020#2n;

     #1#0 = 7; #1#1 = "Clientes"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "agifa024"; |GRABA 020#2n;

     #1#0 = 8; #1#1 = "Proveedores"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "agifa112"; |GRABA 020#2n;

     #1#0 = 9; #1#1 = "Partidas"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "gopartia"; |GRABA 020#2n;

     #1#0 = 10; #1#1 = "Articulos"; |GRABA 020#1n;
     #2#0 = #1#0; #2#1 = 1; #2#2 = "agifa019"; |GRABA 020#2n;

     |CIERRA #2;
     |CIERRA #1;
|FPRC;
