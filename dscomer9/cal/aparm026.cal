|FICHEROS;
     aparm026 #0;
     aparm027 #27,MANTE;
     aparm028 #28,MANTE;
     aparm029 #29,MANTE;
|FIN;

|VARIABLES;
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones:";
     aMenu4 = "OIM";
     aMenu5 = "Observaciones";
     aMenu6 = "Incidencias";
     aMenu7 = "Mantenimientos";
     nPuntero = 0;
     aAlfa = "";
     nBuffer = 0;
     nLineas = 0;
     nModo = 0;
     nLin = 0;
     nCol = 0;
|FIN;

|PROCESO CogeLineas26;
     nPuntero = 1;
     |PARA nPuntero = 1; |SI nPuntero [ 999; |HACIENDO nPuntero = nPuntero + 1;
          #27#0 = #0#0;
          #27#1 = nPuntero;
          |LEE 000#27=;
          |SI FSalida = 0;
               aAlfa = #27#2; |AL_BUF nBuffer, nPuntero, aAlfa;
               |BORRA 020#27a;
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO PoneLineas26;
     |PARA nPuntero = 999; |SI nPuntero ] 0; |HACIENDO nPuntero = nPuntero - 1;
          |DEL_BUF nBuffer, nPuntero, aAlfa;
          |SI aAlfa ! ""; nLineas = nPuntero; |SAL; |FINSI;
     |SIGUE;
     |PARA nPuntero = 1; |SI nPuntero [ nLineas; |HACIENDO nPuntero = nPuntero + 1;
          |DEL_BUF nBuffer, nPuntero, aAlfa;
          #27#0 = #0#0;
          #27#1 = nPuntero;
          #27#2 = aAlfa;
          |GRABA 020#27n;
     |SIGUE;
|FPRC;

|PROCESO Observa26;
     |ABRE #27;
     |PINPA #0#27;
     |DIMENSIONA 200, nBuffer, 0;
     |HAZ CogeLineas26;
     nModo = 100; nLin = 10; nCol = 78;
     |EDITA nBuffer, 1, 10, 1002, 2279, nModo, "", 0, nLin, nCol;
     |HAZ PoneLineas26;
     |FINDIM nBuffer;
     |CIERRA #27;
|FPRC;

|PROCESO Min28;
     #28#0 = #0#0;
     #28#1 = 00001;
|FPRC;

|PROCESO Max28;
     #28#0 = #0#0;
     #28#1 = 99999;
|FPRC;

|PROCESO Min29;
     #29#0 = #0#0;
     #29#1 = 00001;
|FPRC;

|PROCESO Max29;
     #29#0 = #0#0;
     #29#1 = 99999;
|FPRC;

|PROCESO Tipo26_20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Opciones";
     |SINO;
          |LEE 101#0=;
          |SI FSalida ! 0; |ACABA; |FINSI;

          |PARA; |SI; |HACIENDO;
               |MENU aMenu;
               |SI FSalida [ 0; |SAL; |FINSI;
               aMenu2 = FSalida;
               |PUSHV 0501 2380;
               |SI aMenu2 = 1; |HAZ Observa26; |FINSI;
               |SI aMenu2 = 2;
                    |ENTLINEAL #1#28, 2, 1, 22, 1, Min28, Max28;
               |FINSI;
               |SI aMenu2 = 3;
                    |ENTLINEAL #1#29, 2, 1, 22, 1, Min29, Max29;
               |FINSI;
               |POPV;
               |GRABA 020#0a;
               |PINTA #0#6;
          |SIGUE;
          |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO Borra27;
     |BORRA 020#27a;
|FPRC;

|DEFBUCLE Borra27;
     #27#1;
     ;
     #0#0, 001;
     #0#0, 999;
     be;
     NULL,  Borra27;
|FIN;

|PROCESO Borra28;
     |BORRA 020#28a;
|FPRC;

|DEFBUCLE Borra28;
     #28#1;
     ;
     #0#0, 00001;
     #0#0, 99999;
     be;
     NULL,  Borra28;
|FIN;

|PROCESO Borra29;
     |BORRA 020#29a;
|FPRC;

|DEFBUCLE Borra29;
     #29#1;
     ;
     #0#0, 00001;
     #0#0, 99999;
     be;
     NULL,  Borra29;
|FIN;


|PROCESO Tipo26_2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE Borra27;
          |BUCLE Borra28;
          |BUCLE Borra29;
     |FINSI;
|FPRC;

|PROCESO FecMto29; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     nLin = #29#1;
     |SALVA_FICHA #29;
     #29#1 = 99999;
     |LEE 000#29];
     |SI FSalida = 0;
          |LEE 000#29a;
     |SINO;
          |LEE 000#29u;
     |FINSI;
     |SI nModo = 3; |Y nLin = #29#1; |LEE 000#29a; |FINSI;
     |SI FSalida ! 0; |O #0#0 ! #29#0;
          |DDEFECTO #29;
     |FINSI;
     |SI nModo = 1; |Y nLin ] #29#1;
          |REPON_FICHA #29;
          #0#6 = #29#2;
     |SINO;
          #0#6 = #29#2;
          |REPON_FICHA #29;
     |FINSI;
|FPRC;
