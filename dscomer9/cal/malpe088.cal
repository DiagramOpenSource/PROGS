|FICHEROS;
     malpe088 #0;   || Lineas de pedido
     malpe087 #1;   || Pedido
     agifa019 #2;   || Articulos
     malpe136 #3;||agifa129 #3;   || Comision
     agifa128 #4;   || Comision cliente
     agifa039 #5;   || Descuentos
     agifa024 #6;   || Clientes
     agifa017 #8;   || Stocks almacenes
     agifa065 #9;   || Historico.

     agifa142 #16;
     agifa007 #17;

     agifa290 #25;       || Promociones Articulos;
     agifa294 #28;       || Pantalla Equivalencias;
     agi00010 #80,MANTE; || Texto lineas de pedidos.
     agi00031 #90;       || Temporal para el calculo de adjudicacion por fechas de entrega.
     agi00033 #99;       || Auxiliar Pedidos.
     agifa067 #91;       || Pedidos de Compras(L).
     agifa321 #35;
     dsl00001 #36;       ||Codigos de barras multiples

     dsm00246 #40;       ||Control Riesgo Por Usuarios.
     dsm00247 #41;       ||Pantalla Informe Riesgo.
     dsm00248 #43;
     dsm00005 #905;
     dsm00010 #910;
     dsm00046 #946;
     referen@ #100;

     dsm00024 #24;
     malpe085 #85; || aux. partidas
     malpe083 #83; || aux. arti
     malpe084 #84;
     malpe001 #101;

     malpe019 #119;
     malpe104 #104,MANTE;
     agifa310 #310;
     malpe401 #401;
     malpe081 #81;
     malpe137 #137;
     malpe209 #209;
|FIN;

|VARIABLES;
     nRemanente = 0;
     nError = 0;
     aEsMortero = "";
     &eaTieneComi = "";
     &enComision1 = 0;
     &enComision2 = 0;
     &eaTipoCli = "";
     &eaRemanente = "";
     &eaTipoComi = "";
     ||&eaArticulo = "";
     ||&efFecha = @;
     ||&enDto = 0;

     nForma = 0;
     nComi1 = 0;
     nComi2 = 0;
     nPorce1 = 0;
     nPorce2 = 0;
     nImpo =0;
     &eaLote = "";
     nSwPreDto = 0;
     nPend = 0;
     &enPreBas = 0;
     &enPreDto = 0;
     &enPrePor = 0;
     &enDto = 0;
     &enObra = 0;
     &eaPorte = "";

     nUnidades = 0;
     nSwServi = 0;
     nSalida = 0;
     nLin401 = 0;
     nInc = 0;
     nLin = 0;
     nUni = 0;
     nDias = 0;
     nErr = 0;
     fFecha = @;
     nBorra104 = 0;
     nDto1 = 0;
     nDto2 = 0;
     nDto3 = 0;
     nDto = 0;
     nPrePorte = 0;
     &eaModulo = "";

     nCalc      = 0;
     nTecla     = 0;
     &eaIVAsn   = "";
     nCampo     = 0;
     nBene      = 0;
     &nDispoKit = 0;
     nConAu     = 0;
     &nMasRies  = 0;
     nTries     = 0;
     nAudito    = 0;
     aUs        = "";
     &nRieTotal = 0;
     &nRieUtili = 0;
     &aRieBloqu = "";
     &aBloquead = "";
     &eaTag     = "";
     &Tempo     = "";
     aTempo294  = "";
     aTempo90   = "";
     &enUniMarhu= 0;
     aDef       = "";
     nHayPen    = 0;
     fEntrega   = @;
     nModo      = 0;
     nTotRiesgo = 0;
     nSw_Dentro = 0;
     nCamp1    = 0;
     nCamp2    = 0;
     nCamp3    = 0;
     aAlfa     = "";
     nNume     = 0;
     aMod      = "";
     aVis      = "";
     nPos      = 0;
     &enDescuento1 = 0;
     &enDescuento2 = 0;
     &eaTComision  = "";
     &enComision   = 0;

     &nPromo    = 0;
     &ser_ped   = "";
     &num_ped   = 0;
     &lin_ped   = 0;
     &enSwPanta = 1;

     &TipoCta        = "";
     &nDeci_Base     = 0;   || Decimales en Totales de la moneda base
     &nDeci_PreBase  = 0;   || Decimales en el Precio en moneda base
     &nDeci_BaseMxP  = 0;   || Decimales en Totales de la moneda base (Maxima precision)
     &nDeci_PreBasMxP= 0;   || Decimales en el Precio en moneda base (Maxima precision)
     &nDeci_DivP     = 0;   || Decimales en Totales de la divisa
     &nDeci_PreDivP  = 0;   || Decimales en el Precio en divisa
     &nDeci_TotVisP  = 0;   || Decimales en Totales visibles (el de la moneda de trabajo)
     &nDeci_TotNoVisP = 0;  || Decimales en Totales no visibles (el de la otra moneda)
     &nDeci_PreVisP  = 0;   || Decimales en el Precio visual. (lineas)
     &nDeci_ImpVis   = 0;   || Decimales en el Importe visual. (lineas)

     &ac_divisa = ""; ||
     &pintado   = 0;|| Controla el pintado de mensa para que solo lo haga 1 vez

     &qAbono    = "";
     &Envase    = "";
     &Unidades1 = 0;
     &Unidades2 = 0;
     &VArticulo = "";

     &c_clien   = "";
     &c_artic   = "";
     &c_serie   = "";
     &entrada   = 0;

     &ext1          = "";

     &aSeriePedido  = "";
     &aNumeroPedido = 0;
     &Cliente = "";
     &SPedido = "";
      verpre  = "";
     &NPedido = 0;
     &PPedido = "";
     &FPedido = @;
     &BAdela  = 0;
     &ser = "";
     &doc = 0;
      prevul  = 0;
     &r_arti        = "";

     &aRecoge = "N";
     &aModalidad = "V";
     &aCliPro  = "";
     &aProceso = "agifa073";
     &fed_dt = @;   || Fecha....
     &art_dt = "";  || Articulo.
     &cli_dt = "";  || Cliente..
     &fam_dt = "";  || Familia.
     &iva_dt = 0;   || Tipo Iva.
     &dtos_2 = 0;   || Descuento 2.
     &dto_pt = 0;   || Descuento Ptas.
     &dtos_1 = 0;   || Descuento 1.
     &pvp_ve = 0;   || Precio Venta.
     &tarifa = 0;   || Tarifa Cliente.
     &quedto = 0;   || 1=cli./art, 2=cli./familia, 3=cli./subfam.
     &gru_dt = "";  || Grupo Cliente.
     &uni_dt = 0;
     &enMensaje = 0;
     &aParam    = "";

     nPrecio     = 0;

     tecla      = "";
     mensa      = ""; || Linea de visualizacion
     titdiv = "";   || Encabezado de precio e imp. con la divisa "Imp.Tot(USD)"

     aProg = "";

     TUnidad    = 0;
     TEnvase    = 0;

     i              = 0;
     asto           = 0;
     Unidades       = 0;
     alfa           = "";
     ind            = 0;
     salida         = "";
     prov2          = "";
     def_exp        = "N";
     avisa_st       = "N";
     vacio          = "                    ";
     mensaje        = "";
     mensa_exp      = "0000 Pedido para Exportacion.Tipo de IVA = 0  !!";
     articulo       = " ";
     desc_art       = "";
     fiac           = "  ";
     guarda         = "  ";
     relleno        = "                                       ";
     aponer         = "  ";
     serie          = "";
     pedido         = 0;
     pedido_o       = 0;
     serie_o        = "";
     alfa1          = "";
     alfa2          = 0;
     recoge         = "";  || Viene de agifa104
     DescAmpli      = "N";
     def_alm        = 0;
     n_dec          = 0;
     n_pre          = 0;
     descu          = 0;
     tf             = 0;
     comi1          = 0;
     comi2          = 0;
     comi3          = 0;
     comi3_2        = 0;
     pcr            = 0;
     menor          = 0;
     menor_2        = 0;
     pc1            = 0;
     pa             = 0;
     pa1            = 0;
     pa2            = 0;
     primera        = 0;
     cantidad       = 0;
     pc             = 0;
     pcs            = 0;
     pcv            = 0;
     pcd            = 0;
     modo           = 0;
     campo          = 0;
     nLineaD        = 0;
     nerror         = 0;
     nlinea         = 0;
     inkey      = 0;
     codiBarra  = "";
     ccomi          = 0;
     repr           = "";
     clie           = "";
     fami           = "";
     linea          = 0;
     usu            = "";
     fichero        = "";
     arti           = "";
     n              = 0;
     sped           = "";
     nped           = 0;
     pendser        = 0;
     pendrec        = 0;
     fecha          = "";
     unid           = 0;           || CONTINE LAS UND.DE LA LINEA DEL PED.
     feasig = @;
     nSali  = 0;
     aPedi = "";
     aSeri = "";
     aLine = "";
     nCan = 0;
     fede = "01.01.1900";
     feha = "31.12.2300";
     nSal = 0;
     sw_ay_c = 0;
     sw_no_a = 0;
     sw_vic = 0;
     SwAun  = 0;
     &qArti = "";
     &qUnid = 0;
     &eaProg = "";
|FIN;

|INCLUYE i_varart;

|PROCESO Pendientes;
     nHayPen = #referen@#5 - #referen@#43;
     |SI nHayPen ! 0;
          aAlfa = ("000000" + #referen@#0) % -106;
          aAlfa = "0000Pendiente Pedido: " + #referen@#28 + "/" + aAlfa + " Unidades:" + nHayPen;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE Pendientes;
     #referen@#3004;
     ;
     #0#2, "  ", 000000, #1#4;
     #0#2, "zz", 999999, #1#4;
     ;
     NULL, Pendientes;
|FIN;

|PROCESO MiraPend; |TIPO 0;
     |SI DescAmpli = "S";
          aTipoDA = "P";|HAZ DescriDA;
     |FINSI;

     |SI #16#147 = "S";
          |DDEF aDef;
          aDef = aDef + "agifa073";
          |CARGA_DEF aDef, referen@;
          |SI FSalida = 0;
               |BUCLE Pendientes;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
     |HAZ CtrlMortero;
     |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;
|FPRC;

|PROCESO mirespor;|TIPO 0;
     |SI #6#28 = "S";|Y #0#14 ! 0;
          |MENAV mensa_exp;#0#14 = 0;|PINTA #0#14;
     |SINO;
          |SI #0#14 ! 0; |Y def_exp = "S";
               |MENSA mensa_exp;#0#14 = 0;|PINTA #0#14;
          |FINSI;
     |FINSI;
|FPRC;


|PROCESO lpinfo;|TIPO 0;
     |SI Campo = 5;
          |SI avisa_st = "S"; |O avisa_st = "X";
               |SI #8#39 < #0#5;
                    |AVISO;
                    |MENAV "0000Se supera el Stock Disponible";
                    |SI avisa_st = "X";
                         |ERROR;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI verpre ! "S";
          mensaje = "0410Stock Disponible Almacen : " + #8#39+"     Stock Minimo : "+#8#6;
          |MENSA mensaje;
     |SINO;
          |HAZ verpre2;
          mensaje = "0401Disponible.: [" + #8#39 + "] Min.: [" + #8#6 + "] PC.: [" + #2#133 + "] PMC.: [" + #2#9 + "] PVU.: [" + prevul+"]";
          mensaje = mensaje % 180;
          |MENSA mensaje;
     |FINSI;
|FPRC;

|PROCESO lpdefec;|TIPO 0;
     nModo = (FEntrada / 100) ! 0;

     #0#16 = #1#7;  || #lin.pedidos#representante=#pedido#representante
     #0#17 = #1#16; || #lin.pedidos#tipo de comision=#pedidos#tipo de comision
     #0#20 = #1#4;  || #lin.pedidos#cliente=#pedidos#cliente

     |SI nModo = 1;
          #0#13= #1#2;   || #lin.pedidos#fecha entrega=#pedidos#fecha 1 entrega
     |FINSI;

     |SI #0#2 ! #2#0;
         |ABRE #2;
         #2#0 = #0#2;
         |LEE 000#2=;
         |CIERRA #2;
     |FINSI;
     |SI #0#20 ! #6#0;
     |ABRE #6;
     #6#0 = #0#20;
     |LEE 000#6=;
     |CIERRA #6;
     |FINSI;
     #0#18 = #2#2;
     #0#19 = #6#4;

     |HAZ PrecArt;
|FPRC;

|PROCESO Alma73_0; |TIPO 0;
     |HAZ lpdefec;
     |HAZ lpinfo;
     |HAZ mirespor;
     |HAZ CamposModiMp;
     |HAZ SacaKit;
|FPRC;

|PROCESO licogeap;|TIPO 0; ||Aunque parezca mentira sirve... je je je
     nSwPreDto = 0;
     articulo = #0#2;
|FPRC;

|PROCESO PrecArt;
     |SI pedido_o ! 0; |ACABA; |FINSI; || viene de la copia de pedido (F4)

     modo = (FEntrada / 100) ! 0;
     #0#20 = #1#4;

     FSalida = 1;
     |SI modo = 1; |Y nSwPreDto = 0; FSalida = 0; |FINSI;
     |SI articulo ! #0#2; FSalida = 0; |FINSI;

     |SI FSalida = 0;
          nSwPreDto = 1;
          articulo = #0#2;
          eaCliente = #1#4;
          eaArti = #0#2;
          efFecha = #1#1;
          |HAZ CalDtoMalpe1;
          #0#59 = enPrecio; |PINTA #0#59;
          |SI #0#54 = "N";
               #0#8 = 0; |PINTA #0#8;
          |SINO;
               #0#8 = enDto; |PINTA #0#8;
          |FINSI;
          #0#58 = #0#59 < #0#8; |PINTA #0#58;
          #0#6 = #0#58 + #0#60; |PINTA #0#6;
          |HAZ precio_divisa;
          |HAZ Comisiones;
          |PINTA #0#10;
     |FINSI;
|FPRC;

|PROCESO unidades; |TIPO 6;
     nTecla = FSalida;
     nModo = (FEntrada / 100) ! 0;
     |HAZ UniPalet;
     |SI nTecla = 13;
          enTipEnvase = 1;
          |HAZ Envase73;
     |FINSI;

     |HAZ lpinfo;
     #0#5 = #0#5 ! n_dec;
     |PINTA #0#5;
     |SI #0#5 [ 0; |ACABA; |FINSI;
     qArti = #0#2;
     qUnid = #0#5;
     |HAZ ComproMin;
     |SI enErr ! 0;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO totallip;|TIPO 0;
     #0#42 = #0#5;
     #0#48 = #0#44;
     |HAZ MalpeLin73;
     |PINTA #0#9;
|FPRC;

|PROCESO MiraServidas;
     |SI #104#6 = "S"; |O #104#7 ! 0;
          nSwServi = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE MiraServidas;
     #104#1;
     ;
     #0#28, #0#0, #0#1, 001;
     #0#28, #0#0, #0#1, 999;
     ;
     NULL, MiraServidas;
|FIN;

|PROCESO lpacarti; |TIPO 2;
     modo = (FEntrada / 100) ! 0;
     enForma = 0 +. 1;
     nForma = enForma;
     |SI #0#12 ! 0;|O #0#43 ! 0;|O #0#47 ! 0;|O #0#49 ! 0;
          |SI #0#43 = 0; |Y #0#49 = 0;
               #0#12 = 0;
               #0#47 = 0;
          |SINO;
               |SI modo = 3;
                    |MENAV "      No se permite dar de baja la Ficha.";
                    |ERROR;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI modo = 2; |O modo = 3;
          |SI #0#30 ! ""; |Y #0#30 ! "      ";
               |ATRI P;
               |MENAV "0000LA LINEA TIENE RESERVA EN PEDIDO DE COMPRAS";
               |ATRI p;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;

     desc_art = #0#2;
     |QBF desc_art;
     |SI #0#43 = #0#5; |Y #0#49 = #0#44; |Y enForma = -1;
               |Y desc_art ! ""; |Y modo = 2;  |Y #0#5 ! 0;
          |MENAV "0000Linea servida por completo";
          |ERROR;
          |ACABA;
     |FINSI;

     |SI modo = 3;
          nSwServi = 0;
          |BUCLE MiraServidas;
          |SI nSwServi ! 0;
               |MENAV "0000Hay unidades Servidas...";
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;

     |SI nForma = 1;
          |HAZ Riesgos73;
          |SI enErrRie = 1; |ERROR; |ACABA; |FINSI;
          |HAZ CuentaUni;
     |FINSI;

     ||컴컴컴컴컴컴컴컴횫ctualiza  Articulo y Almacen
     |HAZ AcumulaPVMp;
     enTipEnvase = 2;
     |HAZ Envase73;

     #1#11 = #1#11 +. #0#9;
     #1#12 = #1#12 +. #0#9;
     #1#13 = #1#11 - #1#12;

     #1#42 = #1#42 +. #0#39;
     #1#43 = #1#43 +. #0#39;
     #1#44 = #1#42 - #1#43;

     |HAZ visual_totales;

     |SI modo = 1; |O modo = 2;
          |SI enForma  = 1;             || Act. Precio Cli. Art.
/***
               #0#20 = #1#4;
               cli_dt = #0#20;
               art_dt = #0#2;
               pvp_ve = #0#6;
               dtos_1 = #0#8;
               aParam = "grapre";
               enDirEnt = #1#57;
               |HAZ calcdtos;
***/
          |FINSI;
     |FINSI;

     |SI modo = 3;
          ||컴컴컴컴컴컴컴컴컴
          aTipoDA = "P"; |HAZ BajaDA;
          ||컴컴컴컴컴컴컴컴컴
          |HAZ BorraEl104;
     |FINSI;
     |HAZ Remanente;
|FPRC;

|PROCESO cabeped;|TIPO 13;
     nPend = #0#5 - #0#43;
     aAlfa = ("        " + nPend) % -108;
     |ATRI S; |PINTA 1435, aAlfa; |ATRI 0;
     |HAZ visual_totales;
|FPRC;

|PROCESO TeclaPrecio; |TIPO 6;
     campo = Campo;
     inkey = FSalida;
     |SI inkey = 10;     ||F10
          |HAZ CalPrecio;
     |FINSI;
     |SI inkey = 13;   ||F5
          modo = (FEntrada / 100) ! 0;
          |SI modo = 4;
               |ABRE #6;
               #6#0 = #1#4;
               |LEE 001#6=;
               |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
               |CIERRA #6;
          |FINSI;
          |PUSHV 0501 2380;
          ext1 = #6#16;
          |SUB_EJECUTA_NP "caextrap.run";
          |POPV;
     |FINSI;
     |SI inkey = 14;     ||F6
          c_clien = #1#4;
          c_artic = #0#2;
          c_serie = #0#28;
          entrada = 1;
          |SUB_EJECUTA_NP "agifa283.run";
          inkey = 0;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO leeotro; |TIPO 11;
     modo = (FEntrada / 100) ! 0;
     inkey  = FSalida;
     salida = FSalida;
     |HAZ PintaMedidaV;
     |SI inkey = 9;          || A cuenta
|||          |HAZ a_cta1;
     |FINSI;
     |SI inkey = 10;          || Texto
|||          |HAZ tx;
     |FINSI;
     |SI inkey = 11;          || Estado
          ser_ped = #0#28;
          num_ped = #0#0;
          lin_ped = #0#1;
          |SUB_EJECUTA_NP "dsy00002";
          |ERROR;
          |ACABA;
     |FINSI;
     |SI inkey = 12;          || Copia
|||          |HAZ Recoge;
     |FINSI;
     |SI inkey = 13;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#104, 4, 4, 22, 1, Min104, Max104;
          |POPV;
          |ERROR; |ACABA;
     |FINSI;
     |SI inkey = 15;          || Cabecera
          |PUSHV 501 2380;
              |PINPA #0#1;
              |PINDA #0#1;
              |PAUSA;
          |POPV;
          |ERROR;
     |FINSI;
     |SI inkey = 14; |Y modo ! 1;          || Precios
          c_clien = #1#4;
          c_artic = #0#2;
          c_serie = #0#28;
          entrada = 1;
          |SUB_EJECUTA_NP "agifa283.run";
          inkey = 0;
          |ERROR;
     |FINSI;
     aAlfa = #0#2; |QBF aAlfa;
     |SI inkey = 16; |Y aAlfa ! ""; |Y DescAmpli = "S";
          aTipoDA = "P"; |HAZ VerDA;
          |ERROR;
     |FINSI;
     |SI inkey = 18;                  || Extrato
          alfa = "dsw00007;" + #1#4;
          |SUB_EJECUTA_NP alfa;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Recoge;
     |SI inkey = 12; |Y recoge ="N"; ||F4
          |PUSHV 0400 0479;
          |MENAV "0000Opcion no activada en Parametros Generales";
          |POPV;
          |ERROR;
          |ACABA;
     |FINSI;
     || compruebo que este en la ultima linea y en modo alta
     nLineaD = #0#1;    || Guardo puntero
     nLineaD = nLineaD +1;     || Porque si estoy en alta la linea en la que
                               || estoy todavia no esta grabada
     |LEE 001#0];

     |SI FSalida ! 0;|O #0#0 ! #1#0;
                      |O #0#28 ! #1#25;|Y modo = 1;

          nLineaD = nLineaD -1;

          || Recupero el puntero
          #0#0  = #1#0;    || pedido
          #0#28 = #1#25;   || Serie
          #0#1  = nLineaD;        || Numero de linea
          |LEE 001#0=;

          nerror = 0;
          |SI inkey = 12;
               |HAZ entradatos;
          |FINSI;
          |SI nerror = 0 ;
               |SI inkey = 12; ||F4
                    |HAZ leelineas;
               |FINSI;
               |HAZ control2;
               |PTEC 816;
               |PTEC 812;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          || Recupero el puntero
          nLineaD = nLineaD -1;
          #0#0  = #1#0;     || pedido
          #0#28 = #1#25;    || Serie
          #0#1  = nLineaD;         || Numero de linea
          |LEE 001#0=;

          |MENAV "0000Debe estar en la ultima linea";
          |ERROR;
     |FINSI;    || Si #0#1 = 1 ...
|FPRC;

|PROCESO entradatos;
     |PINTA 2420 , " Recogida de datos del pedido  :   /    ";
     alfa1 = "";
     E_sup = 5;
     E_inf = "";
     alfa1 = 2453 ? 1;
     serie_o = alfa1;
     alfa2 = "";
     E_sup = 999999;
     E_inf = 000000;
     alfa2 = 2459 ? 1;
     pedido_o = alfa2;
     |BLIN 24;
     || No puedo leer en el que estoy sino se embuclaria
     |SI  serie_o = #1#25;|Y pedido_o = #1#0;
         |MENAV "0000ATENCION !!! Esta en este pedido";
         nerror = 1;
     |FINSI;
|FPRC;

|PROCESO control1;
   aponer= Asino;
   |HAZ poncontr;
|FPRC;

|PROCESO control2;
   aponer= Anosi;
   |HAZ poncontr;
|FPRC;

|PROCESO poncontr;
     fiac = Control % A109;
     fiac = fiac + relleno;
     guarda = fiac % A109;
     fiac = Control % A1001;
     Control = Control + fiac;
     Control = Control + relleno;
     Control = Control % A120;
     Control = Control + aponer;
|FPRC;

|PROCESO dsm00046Kit;
     #946#0 = #0#28;
     #946#1 = #0#0;
     #946#2 = #0#1;
     |GRABA 020#946n;
|FPRC;

|DEFBUCLE dsm00046Kit;
     #946#1;
     ;
     serie, pedido, nlinea, 001;
     serie, pedido, nlinea, 999;
     ;
     NULL, dsm00046Kit;
|FIN;

|PROCESO CreaComponente;
     #905#0 = "PV";
     #905#1 = #0#28;
     #905#2 = #0#0;
     #905#3 = #0#1;
     #905#7 = #0#6;
     #905#6 = #905#11;
     #905#8 = #905#6 * #905#7;
     #905#9 = 0;
     #905#12 = 0;
     |GRABA 020#905n;
     |LIBERA #905;

     enUnidades = #905#6;

     eaTipo       = "PV";
     eaArticulo   = #0#2;
     enAlmacen    = #0#3;
     eaComponente = #905#4;
     eaReservado  = "N";
     enCamBas     = #1#36;
     eaMoneda     = #1#37;
     enCamDiv     = #1#41;
     |SUB_EJECUTA_NP "dsz00002;PVC";
|FPRC;

|DEFBUCLE dsm00005;
     #905#1;
     ;
     "PV", serie, pedido, nlinea, "      ";
     "PV", serie, pedido, nlinea, "zzzzzz";
     be;
     NULL, CreaComponente;
|FIN;

|PROCESO crealineasV;
    || Clave primaria
    #0#28= #1#25;    || Serie
    #0#0 = #1#0;     || Numero de Pedido
    #0#1 = nLineaD;  || Numero de linea

    |BUCLE dsm00046Kit; || Kit

    |DEFECTO #0#1;   || Cargo los valores de defecto de cab.pedido

    || Procedo a cambiar lo que no es igual
    |HAZ lpdefec;                  || Este proceso carga los defectos, ya que
                                   || estos no estan puestos en D000.....
                                   || porque no iba bien.
    #0#15 = "N";            || Bloqueado = N
    #0#21 = "";             || Numero
    #0#22 = "N";            || Reservado
    #0#5 = #0#42;
    #0#12 = 0;
    #0#30 = "";
    #0#31 = "";
    #0#32 = 0;
    #0#37 = 0;
    #0#43 = 0;
    #0#44 = #0#48;
    #0#47 = 0;
    #0#49 = 0;
    nPrecio = #0#6;

    |HAZ totallip;     || Calculo total linea
    |HAZ lpacarti;     || Lo envio al t ipo 2 para que calcule lo mismo que si fuera
                       || una linea introducida por el operador
    #0#6 = nPrecio;
    |GRABA 021#0b;
    |LIBERA #0;

    |BUCLE dsm00005;

    nLineaD = nLineaD + 1;  || Aumento contador de lineas
|FPRC;


|PROCESO leelineas;
      #0#28= serie_o;
      #0#0 = pedido_o;
      #0#1 = 1;
      |LEE 001#0];
      |SI FSalida =0;
           |PARA;|SI FSalida =0;|Y #0#28=serie_o;|Y #0#0=pedido_o;
                                                     |HACIENDO;
                  || Me guardo el puntero
                  serie   = #0#28;   || Serie y pedido actual
                  pedido  = #0#0;
                  nlinea  = #0#1;

                  |HAZ crealineasV;

                  || Recupero puntero
                  #0#28 = serie;
                  #0#0  = pedido;
                  #0#1  = nlinea;
                  |LEE 001#0=;

                  |LEE 001#0s;
           |SIGUE;
      |SINO;
           |MENAV "0000Atencion !!! No se ha encontrado el pedido indicado";
           |ERROR;
      |FINSI;

      pedido_o = 0;

      || Devuelvo el puntero de la linea
      #0#28= #1#25;       || Serie
      #0#0 = #1#0;        || pedido
      #0#1 = nLineaD;     || Linea
      |LEE 001#0=;
|FPRC;

|PROCESO LeeParam073;
     |ABRE #16; |LEE 000#16p; |CIERRA #16;

     avisa_st  = #16#35;
     n_dec     = #16#8;
     n_pre     = #16#9;
     recoge    = #16#38;
     DescAmpli = #16#197;     || Descargar descripcion ampliada
     |SI DescAmpli = "N";
          DescAmpli = #16#40;
     |FINSI;
     codiBarra = #16#53;     || Codigo Barras
     verpre    = #16#101;       || Ver Precio

     |ABRE #17;
     #17#26 = #1#25;
     |LEE 001#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
     |CIERRA #17;
     def_alm = #17#29;
     def_exp = #17#30;
|FPRC;

|| Se miran los parametros generales en la linea para evitar variables
|| externas que dan problemas

|PROCESO tipo7073; |TIPO 7;
     |HAZ PintaMedidaV;
     |HAZ LinDiv;
     |HAZ LeeParam073;
|FPRC;

|PROCESO tipo3073; |TIPO 3;
     aAlfa = #0#2; |QBF aAlfa;
     |SI aAlfa ! ""; |Y DescAmpli = "S";
          aTipoDA = "P"; |HAZ AltaDA;
     |FINSI;
|FPRC;

________________________/ TEXTO LINEAS.......................................
|RUTINA min34;
     #80#0 = #0#28;
     #80#1 = #0#0;
     #80#2 = #0#1;
     #80#3 = 1;
|FRUT;

|RUTINA max34;
     #80#0 = #0#28;
     #80#1 = #0#0;
     #80#2 = #0#1;
     #80#3 = 200;
|FRUT;




____________/ MODIFICADO EL 07-07-99
____________/ CONTROL DE RESERVAS SEGUN LA FECHA DE ENTREGA DE LAS LINEAS DE
____________/ LOS PEDIDOS DE VENTAS, Y DE LAS FECHAS DE RECEPCION DE LOS
____________/ PEDIDOS DE COMPRAS.

|PROCESO asigna;
  |SI #90#13 ! 0;
      sw_no_a = 1;
      nCan = #90#13 - #0#5;
      |SI nCan ] 0;
          |SI #0#13 < #90#10; |O #0#13 = "31.12.9999";
               #0#13 = #90#10;
          |SINO;
              |ABRE #99;
              #99#0 = #0#28;
              #99#1 = #0#0;
              #99#2 = #0#1;
              #99#3 = #0#2;
              |LEE 101#99=;
              nSali = FSalida;
              #99#4 = #90#10;
              |SI nSali ! 0; |GRABA 020#99n; |FINSI;
              |SI nSali = 0; |GRABA 020#99a; |FINSI;
              |LIBERA #99;
              |CIERRA #99;
           |FINSI;
          |GRABA 000#0n;
          |ERROR10;
          SwAun = 0;
      |SINO;
          |SALVA_DATOS #0;
          TUnidad = #0#5;
          TEnvase = #0#36;
          n       = #0#5 - #90#13;   || UNIDADES RESTANTES.
          #0#5    = #90#13;          || UNIDADES DISPONIBLES EN FECHA.
          #0#42   = #90#13;          || UNIDADES PEDIDAS
          #0#36   = (#90#13 * TEnvase) / TUnidad;
          |SI #0#13 < #90#10; |O #0#13 = "31.12.9999";
              #0#13 = #90#10;
          |SINO;
              |ABRE #99;
              #99#0 = #0#28;
              #99#1 = #0#0;
              #99#2 = #0#1;
              #99#3 = #0#2;
              |LEE 101#99=;
              nSali = FSalida;
              #99#4 = #90#10;
              |SI nSali ! 0; |GRABA 020#99n; |FINSI;
              |SI nSali = 0; |GRABA 020#99a; |FINSI;
              |LIBERA #99;
              |CIERRA #99;
          |FINSI;
          |HAZ MalpeLin73;
          |GRABA 000#0n;

          #90#13 = 0;
          |GRABA 021#90a;
          |LIBERA #90;

          sped = #0#28;
          nped = #0#0;
          |HAZ busca_ultima;
          |REPON_DATOS #0;

          #0#1  = linea;
          #0#5  = n;
          #0#42 = n;
          #0#36 = (n * TEnvase) / TUnidad;
          #0#13 = "31.12.9999";
          |HAZ MalpeLin73;
          SwAun = 1;
      |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE lee_resto;
  #90#1;
  ;
  #0#2,fede;
  #0#2,feha;
  ;
  NULL,asigna;
|FIN;

|PROCESO imprime;
     #90#13 = #90#13 - #0#5;            || PTE.RECIB. - (PTE.SER - UND.LIN)
     |GRABA 021#90a;
     |LIBERA #90;
|FPRC;

|DEFBUCLE lee_temporal;
     #90#1;
     ;
     #0#2,feasig;
     #0#2,feasig;
     ;
     NULL,imprime;
|FIN;

|PROCESO graba_ventas;
  |SI  arti  ! #0#2; |O aPedi  ! #0#0; |O aSeri ! #0#28; |O aLine ! #0#1;
       |ABRE #99;
       #99#0 = #0#28;
       #99#1 = #0#0;
       #99#2 = #0#1;
       #99#3 = #0#2;
       |LEE 041#99=;
       |SI FSalida ! 0;
           feasig = #0#13;
       |SINO;
           feasig = #99#4;
       |FINSI;
       |CIERRA #99;
       |BUCLE lee_temporal;
  |FINSI;
|FPRC;

|DEFBUCLE lee_ventas;
     #0#1;
     2,13;
     "  ",000000,001,arti,fede;
     "zz",999999,999,arti,feha;
     ;
     NULL,graba_ventas;
|FIN;


_______________________/ LEE Y RELLENA EL TEMPORAL CON LOS PEDIDOS DE VENTAS.
|PROCESO graba_compras;
     #90#7   = #91#2;
     #90#10  = #91#13;
     |LEE 141#90=;
     nSal = FSalida;
     |SI FSalida ! 0;
          #90#13 = 0;    || UNIDADES PENDIENTES DE RECIBIR.
     |FINSI;
          #90#13 = #90#13 + (#91#5 - #91#38);     || UNIDADES PENDIENTES DE RECIBIR.
     |SI nSal = 0; |GRABA 021#90a; |FINSI;
     |SI nSal ! 0; |GRABA 021#90n; |FINSI;
     sw_ay_c = 1;
     |LIBERA #90;
|FPRC;

|DEFBUCLE lee_compras;
     #91#1;
     2;
     "  ",000000,001,arti;
     "zz",999999,999,arti;
     ;
     NULL,graba_compras;
|FIN;

|PROCESO  reserva;
     unid = #0#5;
     modo = (FEntrada / 100) ! 0;

      || LEE LOS PEDIDOS DE COMPRAS Y VENTAS, Y RELLENA EL TEMPORAL.
     |SI #16#69 = "S"; |Y #0#5 > 0;
          |HAZ CreaTempo; aTempo90 = Tempo;
          |NOME_DAT #90 aTempo90; |DELINDEX #90;
          |SELECT #1#90;
          |ABRET #90;
          arti  = #0#2;            || Articulo.
          fecha = #0#13;           || Fecha Entrega.
          aPedi = #0#0;            || Pedido.
          aSeri = #0#28;           || Serie.
          aLine = #0#1;            || Linea.
          sw_ay_c = 0;
          sw_no_a = 0;
          |SALVA_DATOS #0;
          |BUCLE lee_compras;
          |SI sw_ay_c = 0;
               |REPON_DATOS #0;
               #0#13 = "31.12.9999";
          |SINO;
               |BUCLE lee_ventas;
               |REPON_DATOS #0;
               SwAun = 0;
               |BUCLE lee_resto;
               |SI SwAun = 1;
                   |GRABA 000#0n;
                   sw_no_a = 1;
               |FINSI;
               |SI sw_no_a = 0;
                    #0#13 = "31.12.9999";
                    |GRABA 000#0a;
               |FINSI;
          |FINSI;
          |PINTA #0#13;
          |CIERRAT #90;
          |DELINDEX #90; Tempo = aTempo90; |HAZ BoraTempo;
          |SI sw_ay_c ! 0;
               aponer = "kksi";
               |HAZ poncontr;
               Pos = -1;
               |PTEC 809;
               |PTEC 809;
               |PTEC 808;
          |FINSI;
     |FINSI;
|FPRC;

||*****************************************************************
||*****************************************************************
||*****************************************************************
||*****************************************************************

|PROCESO busca_ultima;
     #0#28 = sped;
     #0#0  = nped;
     #0#1  = 999;
     |LEE 000#0];
     |SI FSalida = 0;
          |LEE 000#0a;
     |SINO;
          |LEE 000#0u;
     |FINSI;
     |SI FSalida = 0; |Y #0#28 = sped; |Y #0#0 = nped;
          linea = #0#1 + 1;
     |SINO;
          linea = 1;
     |FINSI;
|FPRC;

|PROCESO Envase73;
     qAbono    = "N";
     Envase    = #0#35;
     Unidades1 = #0#36;
     VArticulo = #0#2;
     Unidades2 = #0#5;
     enAlmacen = #0#3;
     eaTipo = "V";
     eaProgEnv = "pedido";
     |HAZ EntraEnvase;
     #0#35 = Envase;
     #0#36 = Unidades1;
     #0#5  = Unidades2;  |PINTA #0#5;
|FPRC;

|PROCESO Conversion; |TIPO 7;
|FPRC;

|PROCESO prec;
     |SI #2#176 = "S";
         |SI #1#37 = "D";  || Si la moneda de trabajo es la divisa ...
             #0#38 = nPrecio;
         |SINO;
             #0#6  = nPrecio;
        |FINSI;
    |FINSI;


    |SI #1#37 = "D";  || Si la moneda de trabajo es la divisa ...
      #0#6 = #0#38 / #1#36 * #1#41;  || ... recalculo en funcion de la divisa
    |SINO;
      #0#38 = #0#6 / #1#41 * #1#36; || .. recalculo en funcion de la moneda base
    |FINSI;

    |HAZ visual_precio; || Visualiza el precio
|FPRC;

|PROCESO LinDiv;  |TIPO 7;
|ACABA;


     |ABRE #agifa321;
     |LEE 001#agifa321.p;  || Leo parametros de divisa
     |CIERRA #agifa321;

     |SI ac_divisa = "S"; |Y pintado = 0; || Si divisas estan activadas y no he pintado ...
          |SI #1#37 = "D";   || Si la moneda de trabajo es la divisa la pinto en
               |ATRI R;         || el encabezado del precio y el importe
               titdiv = "Precio" + "(" + #1#35 + ")";
               |PINTA 1444,titdiv;
               titdiv = "I.Tot." + "(" + #1#35 + ")";
               |PINTA 1468,titdiv;
               |ATRI r;
          |FINSI;
          |SI #agifa321#3 = "S";  || Si la visualizacion esta activada ...
               mensa = "Precio:            Imp.:                                                      ";
               |PINTA 1102,mensa;  || ... pinto la linea de visualizacion
               |PINTA #0#40; || Pinto precio visual
               |PINTA #0#41; || Pinto importe visual
               |SI #1#37 = "D"; || Si la moneda de trabajo es la divisa
                    #1#45 = #1#42;
                    #1#46 = #1#43;
                    #1#47 = #1#44;
                    #1#48 = #1#11;
                    #1#49 = #1#12;
                    #1#50 = #1#13;
                    |PINTA 1144,#1#49;
                    |PINTA 1156,#1#50;
                    |PINTA 1168,#1#48;
               |SINO;
                    #1#45 = #1#11;
                    #1#46 = #1#12;
                    #1#47 = #1#13;
                    #1#48 = #1#42;
                    #1#49 = #1#43;
                    #1#50 = #1#44;
                    |PINTA 1144,#1#43;
                    |PINTA 1156,#1#44;
                    |PINTA 1168,#1#42;
               |FINSI;
               pintado = 1;  || Ya hemos pintado
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO upc_div;
 |SI #1#37 = "B"; || Si la moneda de trabajo es la moneda base ...
   #0#38 = #0#6 / #1#41 * #1#36;  || Calculo el precio en divisa
 |SINO;
   |SI #1#35 = #2#165; |O #2#165 = "   "; || Si la divisa del U.P.C. coincide con la actual o esta vacia
     #0#38 = #2#163;  || Asigno el U.P.C en divisa
     #0#6 = #0#38 / #1#36 *  #1#41; || Recalculo el precio en moneda base
   |SINO;
     |MENAV "0000La divisa de trabajo no coincide con la divisa del U.P.C";
     #0#38  = #2#28 / #1#41 * #1#36;  || recalculo el precio en divisa en funcion del U.P.C en moneda base
   |FINSI;
 |FINSI;
 |HAZ visual_precio;
|FPRC;


|PROCESO visual_precio; || Pinta el precio visual.
|SI #1#37 = "D";  || Si la moneda de trabajo es la divisa ...
  #0#40 = #0#6;   || ... el campo visualiz. es el precio en moneda base
  |PINTA #0#38;
|SINO;            || Si la moneda de trabajo es la moneda base ...
  #0#40 = #0#38;  || ... el campo visual. es el precio en divisa
  |PINTA #0#6;
|FINSI;
|SI ac_divisa = "S"; |Y #agifa321#3= "S";
  |PINTA #0#40; || Si las divisas y la visualizacion estan activadas, pinto
|FINSI;
|FPRC;

|PROCESO visual_totales;
|ACABA;

     |ABRE #agifa321; |LEE 000#agifa321.p; |CIERRA #agifa321;

     |SI #1#37 = "D";
          #1#45 = #1#42;
          #1#46 = #1#43;
          #1#47 = #1#44;
          #1#48 = #1#11;
          #1#49 = #1#12;
          #1#50 = #1#13;
          |SI ac_divisa = "S"; |Y #agifa321#3= "S";
               |PINTA 1144,#1#49;
               |PINTA 1156,#1#50;
               |PINTA 1168,#1#48;
          |FINSI;
          |CIERRA #agifa321;
          |PINTA 1344,#1#43;
          |PINTA 1356,#1#44;
          |PINTA 1368,#1#42;
     |SINO;
          #1#45 = #1#11;
          #1#46 = #1#12;
          #1#47 = #1#13;
          #1#48 = #1#42;
          #1#49 = #1#43;
          #1#50 = #1#44;
          |SI ac_divisa = "S"; |Y #agifa321#3= "S";
               |PINTA 1144,#1#43;
               |PINTA 1156,#1#44;
               |PINTA 1168,#1#42;
          |FINSI;
          |CIERRA #agifa321;
          |PINTA 1344,#1#12;
          |PINTA 1356,#1#13;
          |PINTA 1368,#1#11;
     |FINSI;
|FPRC;

|PROCESO precio_divisa;
   #0#38 = #0#6 / #1#41 * #1#36;  || Calculo el precio en divisa
   |HAZ prec;
|FPRC;


|PROCESO CogeValores73;  |TIPO 7;
|FPRC;

|PROCESO art6pdv; |TIPO 6;         || Antes de la Relacion 4 Clave.
     r_arti = "";                  || LIMPIA LA VARIABLE DEL ARTICULO AUTOMATICO.
     |SI codiBarra = "N"; |ACABA; |FINSI;

     |ABRE #36;
     |SELECT #2#36;
     #36#3 = #0#2;
     |LEE 010#36=;
     |SI FSalida=0; |Y #0#2 ! #36#1;
         #0#2 = #36#1;
         |PINTA #0#2;
     |FINSI;
     |CIERRA #36;
|FPRC;

|PROCESO tx;
     |ABRET #80;
     |PUSHV 0501 2380;
     |PINPA #0#80;
     |PARA ind = 1; |SI ind [ 200; |HACIENDO ind = ind + 1;
           #80#0 = #0#28;
           #80#1 = #0#0;
           #80#2 = #0#1;
           #80#3 = ind;
           |LEE 141#80=;
           |SI FSalida ! 0;
                #80#4 = "";
                |GRABA 021#80n;
           |FINSI;
           |LIBERA #80;
      |SIGUE;
      |MENSA "0000< ESC > SALIR.";
      |ENTLINEAL #1#80,1,4,21,1,min34,max34;
      |PARA ind = 200; |SI ind ] 1; |HACIENDO ind = ind - 1;
           #80#0 = #0#28;
           #80#1 = #0#0;
           #80#2 = #0#1;
           #80#3 = ind;
           |LEE 141#80=;
           |SI FSalida = 0;
                alfa = #80#4;
                |QBF alfa;
                |SI alfa ! ""; |SAL; |FINSI;
                |BORRA 021#80a;
           |FINSI;
           |LIBERA #80;
      |SIGUE;
      |POPV;
      |CIERRAT #80;
      |ERROR;
|FPRC;

|PROCESO nomodif2; |TIPO 0;
     |QBF r_arti;
     |SI r_arti ! "";
          #0#2 = r_arti;
          |PINTA #0#2;
     |FINSI;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1; #0#3 = def_alm; |PINTA #0#3; |FINSI;
     |HAZ CamposModiMp;
|FPRC;

|PROCESO equiv;
     |SI #agifa142#218 = "S";
          eaArticulo = #0#2;
          enAlmacen = #0#3;
          |SUB_EJECUTA_NP "agifa294.tab;aTempo294";
          |SI enAlmacen = 0;
               |ERROR;
          |SINO;
               #0#2 = eaArticulo; |PINTA #0#2;
               #0#3 = enAlmacen; |PINTA #0#3;
               |ABRE #2;
               #2#0 = #0#2;
               |LEE 000#2=;
               |CIERRA #2;
               #0#4 = #2#1;
               |PINTA #0#4;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PideArt73;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI #16#140 = "S"; |Y nModo = 1; #0#2 = eaArtAnt; |FINSI;
|FPRC;

|PROCESO Calc673;  |TIPO 6;

     |SI FSalida = 10;
          |HAZ tx; |ACABA;
     |FINSI;


     eaArtAnt = #0#2;


     |SI #0Campo ! Contenido; |Y Campo = 2;
          eaArticulo = #0#2;
          eaCliente = #1#4;
          |HAZ DefectoMediV;
          #0#50 = enMedida1;
          #0#51 = enMedida2;
          #0#52 = enMedida3;
     |FINSI;
     |HAZ DobleArtiV;
     |SI eaSw2Stock = "S"; |ACABA; |FINSI;

     enAlta = 1;
     eaArticulo = #0Campo;
     |HAZ LlenaArticulo;
     |SI FSalida = 0;
          #0Campo = eaArticulo;
          |PINTA #0Campo;
     |SINO;
          |ERROR; |ACABA;
     |FINSI;

     |SI modo = 1;  |HAZ equiv;  |FINSI;

     |ABRE #2;
     #2#0 = #0#2;
     |LEE 000#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |SI #2#176 = "S";
          eaTipo      = "PV";
          eaSerie     = #0#28;
          enCodigo    = #0#0;
          enLinea     = #0#1;
          eaArticulo  = #0#2;
          enAlmacen   = #0#3;
          enUnidades  = #0#5;
          enTBruto    = #0#7;
          eaAbono     = #1#34;
          eaReservado = "N";
          enTarifa    = #6#39;
          efFecha     = #1#1;
          eaCliente   = #1#4;
          enCamBas     = #1#36;
          eaMoneda     = #1#37;
          enCamDiv     = #1#41;
          |SUB_EJECUTA_NP "dsz00002";

          #0#3    = enAlmacen;
          nPrecio = enTBruto / enUnidades;

          |PTEC 802;
          |PTEC 802;
          |PTEC 802;
          |PTEC 802;
     |FINSI;

     |HAZ art6pdv;
     |HAZ nomodif2;
|FPRC;

|PROCESO Tipo11073;  |TIPO 11;
     nModo = (FEntrada / 100) ! 0;
     salida = FSalida;
     |SI FSalida = 7; |Y nModo ! 1;
          |MENAV "0000Imposible anular;  Termine de introducir la linea y efectue una Baja.";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO verpre2;
     |ABRE #9;
     |SELECT #3#9;
     #9#10 = #1#4;  || Cliente.
     #9#0  = #0#2;  || Articulo.
     #9#1  = "31.12.2300";  || Fecha.
     #9#2  = "AV";  || Operacion.
     prevul = 0;
     |LEE 000#9];
     |SI FSalida = 0;
          |LEE 000#9a;
     |SINO;
          |LEE 000#9u;
     |FINSI;
     |SI FSalida = 0; |Y #9#10 = #1#4; |Y #9#0 = #0#2; |Y #9#2 = "AV";
          prevul = #9#9 / #1#41 * #1#36;  || Calculo el importe en divisas
          |SI #1#37 = "D";                     || Si la moneda de trabajo es la divisa ...
               prevul = prevul ! nDeci_PreDivP;
          |SINO;                               || Si la moneda de trabajo es la moneda base ...
               prevul = prevul ! nDeci_PreBase;
          |FINSI;
     |FINSI;
     |CIERRA #9;
|FPRC;

|PROCESO PintaBene; |TIPO 7;
     |SI #16#176 = "S";
          |SI #16#177 = "B";
               |SI #16#178 = "P";
                    nCampo = 9;
                    aAlfa = "0000Beneficio Bruto sobre PCM: ";
               |FINSI;
               |SI #16#178 = "U";
                    nCampo = 28;
                    aAlfa = "0000Beneficio Bruto sobre Ultimo Precio: ";
               |FINSI;
               |SI #16#178 = "D";
                    nCampo = 133;
                    aAlfa = "0000Beneficio Bruto sobre Ult. Precio con Dto: ";
               |FINSI;
               nBene = ((#0#38 - #2nCampo) / #2nCampo) * 100;
          |SINO;
               |SI #16#178 = "P";
                    nCampo = 9;
                    aAlfa = "0000Beneficio Neto sobre PCM: ";
               |FINSI;
               |SI #16#178 = "U";
                    nCampo = 28;
                    aAlfa = "0000Beneficio Neto sobre Ultimo Precio: ";
               |FINSI;
               |SI #16#178 = "D";
                    nCampo = 133;
                    aAlfa = "0000Beneficio Neto sobre Ult. Precio con Dto: ";
               |FINSI;
               nBene = (1 -(#2nCampo / #0#38) ) * 100;
          |FINSI;
          aAlfa = aAlfa + nBene;
          |MENSA aAlfa;
     |FINSI;
|FPRC;

|PROCESO CtaArt1;
   eaModulo = "agifa104"; |HAZ CtaArt;
|FPRC;

|PROCESO Tipo73_5; |TIPO 5;
     nModo = (FEntrada / 100) ! 0;
|FPRC;

|PROCESO PrePorte73; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI #0Campo ! Contenido; |O nModo  = 1;
          #0#6 = #0#58 + #0#60; |PINTA #0#6;
          |HAZ precio_divisa;
     |FINSI;
     |HAZ totallip;
|FPRC;

|PROCESO Dto073; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI #0Campo ! Contenido; |O nModo  = 1;
          #0#58 = #0#59 < #0#8; |PINTA #0#58;
          #0#6 = #0#58 + #0#60; |PINTA #0#6;
          |HAZ precio_divisa;
          |HAZ Comisiones;
          |PINTA #0#10;
     |FINSI;
     |HAZ totallip;
|FPRC;

|PROCESO Lote88; |TIPO 6;
     aAlfa = #0#45; |QBF aAlfa;
     |SI aAlfa = "";
          |ABRE #24;
          #24#0 = #0#2;
          #24#1 = #0#3;
          #24#2 = #0#45;
          |LEE 101#24=;
          |SI FSalida ! 0;
               |ABRE #85;
               #85#0 = #24#0;
               #85#1 = #0#3;
               #85#2 = #0#45;
               |LEE 101#85=;
               |SI FSalida ! 0; |GRABA 020#85b; |FINSI;
               #85#3 = #2#102;
               #85#4 = #2#4;
               |GRABA 020#85a;
               |CIERRA #85;

               |GRABA 020#24n;
          |FINSI;
          |CIERRA #24;
     |FINSI;
|FPRC;

|PROCESO EntraPalet; |TIPO 7;
     |SI #0#43 ! 0;
          |C_M #0#57, 1, "N";
     |SINO;
          |C_M #0#57, 1, "S";
     |FINSI;
|FPRC;

|PROCESO UniPalet; |TIPO 0;
     |DDEFECTO #85;
     |ABRE #85;
     #85#0 = #0#2;
     #85#1 = #0#3;
     #85#2 = #0#45;
     |LEE 000#85=;
     |SI FSalida ! 0; |GRABA 020#85n; |FINSI;
     |CIERRA #85;
     |SI Campo = 57;     ||Palets
          #0#5 = #0#57 * #85#4;
          |PINTA #0#5;
     |SINO;
          #0#57 = #0#5 / #85#4;
          |PINTA #0#57;
     |FINSI;
|FPRC;

|PROCESO CalPrecio; |TIPO 6;
     |SI FSalida ! 10; |O #0#54 = "N"; |ACABA; |FINSI; || F2

     eaCliente = #1#4;
     eaArti = #0#2;
     enAlma = #0#3;
     eaLote = #0#45;
     efFecha = #1#1;
     enObra = #1#63;
     enPreBas = #0#59;
     enPrecio = #0#6;
     |HAZ CalDtoMalpe2;
     #0#8 = enDto;     |PINTA #0#8;
     #0#6 = enPrecio;  |PINTA #0#6;
     #0#59 = enPreBas; |PINTA #0#59;
     #0#58 = enPreDto; |PINTA #0#58;
     |SI #1#61 = "D";
          #0#60 = 0; |PINTA #0#60;
     |SINO;
          #0#60 = enPrePor; |PINTA #0#60;
     |FINSI;
     |HAZ precio_divisa;
     |HAZ Comisiones;
     |PINTA #0#10;
     |ERROR;
|FPRC;

|PROCESO malpe019;
     |SI fFecha ] #119#1; |Y fFecha [ #119#2;
          aAlfa = "0000Fecha de servicio no permitida:"+fFecha+ &13 + "Revisar servicio.";
          |MENAV aAlfa;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE malpe019;
     #119#1;
     ;
     #0#2, "01.01.0000";
     #0#2, "31.12.9999";
     ;
     NULL, malpe019;
|FIN;

|PROCESO Min104;
     #104#0 = #0#28;
     #104#1 = #0#0;
     #104#2 = #0#1;
     #104#3 = 1;
|FPRC;

|PROCESO Max104;
     #104#0 = #0#28;
     #104#1 = #0#0;
     #104#2 = #0#1;
     #104#3 = 999;
|FPRC;

|PROCESO Compru104;
     |HAZ FecServi;
     nUnidades = nUnidades + #104#5;
|FPRC;

|DEFBUCLE Compru104;
     #104#1;
     ;
     #0#28, #0#0, #0#1, 001;
     #0#28, #0#0, #0#1, 999;
     ;
     NULL, Compru104;
|FIN;

|PROCESO UniPeriodo; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     nSalida = FSalida;
     |SI nModo = 1; |O #0Campo ! Contenido;
          nBorra104 = 1;
          |HAZ BorraEl104;
     |FINSI;
     |SI Campo = 61;
          fFecha = #0#61;
          |BUCLE malpe019;
     |FINSI;
     |SI Campo = 62;
          nNume = #0#62;
          |SI nNume = 0;
               aAlfa = #0#62; |QBF aAlfa;
               aAlfa = aAlfa > "";
               |SI aAlfa ! "D"; |Y aAlfa ! "S"; |Y aAlfa ! "Q"; |Y aAlfa ! "M";
                    |MENAV "0000Posibles: (D)iario, (S)emanal, (Q)uincenal, (M)ensual o Dias";
                    |ERROR; |ACABA;
               |SINO;
                    #0#62 = aAlfa; |PINTA #0#62;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI Campo = 63;
          |SI #0Campo = 0;
                |MENAV "0000Las unidades no pueden ser '0'";
                |ERROR; |ACABA;
          |FINSI;
          |SI nBorra104 = 1;
               nBorra104 = 0;
               |HAZ Carga104;
          |FINSI;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#104, 4, 2, 22, 1, Min104, Max104;
          |POPV;
          |HAZ CuentaUni;
     |FINSI;
|FPRC;

|PROCESO CuentaUni;
     nUnidades = 0;
     |BUCLE Compru104;
     #0#5 = nUnidades; |PINTA #0#5;
     |HAZ unidades;
     |HAZ totallip;
|FPRC;

|PROCESO malpe401;
     nLin401 = #401#1;
     |ERROR10;
|FPRC;

|DEFBUCLE malpe401;
     #401#3;
     ;
     #0#3, "01.01.0000", #104#4;
     #0#3, #104#4, "31.12.9999";
     be;
     NULL, malpe401;
|FIN;

|PROCESO ActCiclos;
     nLin401 = 0;
     |BUCLE malpe401;
     |ABRE #401;
     |SI nLin401 ! 0;
          |SELECT #1#401;
          #401#0 = #0#3;
          #401#1 = nLin401;
          |LEE 121#401=;
          |SI FSalida = 0;
               #401#6 = #401#6 + ((nUni/#84#2) * nInc);
               #401#7 = #401#5 - #401#6;
               |GRABA 020#401a;
          |FINSI;
          |SI nInc = 1; |Y #401#7 < 0;
               aAlfa = "0000Linea de servicio:" + ("000" + nLin)+&13+"No entra en ciclo. Revisar";
               |MENAV aAlfa;
          |FINSI;
     |SINO;
          |SI nInc = 1;
               aAlfa = "0000Linea de servicio:" + ("000" + nLin)+&13+"No encuentra ciclo. Revisar";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |CIERRA #401;
|FPRC;

|PROCESO Borra104;
     nInc = -1;
     nLin = #104#3;
     nUni = #104#5;
     |HAZ ActCiclos;
     |BORRA 020#104a;
     |HAZ Reserva;
|FPRC;

|DEFBUCLE Borra104;
     #104#1;
     ;
     #0#28, #0#0, #0#1, 001;
     #0#28, #0#0, #0#1, 999;
     be;
     NULL, Borra104;
|FIN;

|PROCESO BorraEl104;
     |BUCLE Borra104;
|FPRC;

|PROCESO Carga104;
     |SI #0#63 = 0; |ACABA; |FINSI;

     |ABRE #84;
     #84#0 = #0#2;
     #84#1 = #0#3;
     |LEE 000#84=;
     |SI FSalida ! 0; |GRABA 020#84n; |FINSI;
     |CIERRA #84;

     nUni = #0#5;
     |SI nUni < 0; nUni = -nUni; |FINSI;
     nDias = #0#62;
     |SI #0#62 = "D  "; nDias = 1; |FINSI;
     |SI #0#62 = "S  "; nDias = 7; |FINSI;
     |SI #0#62 = "Q  "; nDias = 15; |FINSI;
     |SI #0#62 = "M  "; nDias = 30; |FINSI;
     nLin = 0;
     fFecha = #0#61;
     |ABRE #104;
     |PARA i = nUni; |SI i > 0; |HACIENDO i = i - #0#63;
          nLin = nLin + 1;
          |DDEFECTO #104;
          #104#0 = #0#28;
          #104#1 = #0#0;
          #104#2 = #0#1;
          #104#3 = nLin;
          #104#4 = fFecha;
          |SI i < #0#63;
               #104#5 = i;
          |SINO;
               #104#5 = #0#63;
          |FINSI;
          |SI #104#5 = 0; |SAL; |FINSI;
          #104#8 = #0#2;
          #104#9 = #0#3;
          #104#10 = #0#45;
          |GRABA 020#104n;
          |BUCLE malpe019;
          nInc = 1;
          nUni = #104#5;
          |HAZ ActCiclos;
          nNume = fFecha; nNume = fFecha + nDias;
          fFecha = nNume;
     |SIGUE;
     |CIERRA #104;
|FPRC;

|PROCESO Reserva;
     aAlfa = #104#12; |QBF aAlfa;
     |SI aAlfa = ""; |ACABA; |FINSI;
     |DDEFECTO #2;
     |DDEFECTO #8;
     |DDEFECTO #85;
     |DDEFECTO #24;
     |ABRE #2;
     |ABRE #8;
     |ABRE #85;
     |ABRE #24;
     #2#0 = #104#8;
     |LEE 101#2=;
     |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
     #8#0 = #104#8;
     #8#1 = #104#9;
     |LEE 101#8=;
     |SI FSalida ! 0; |GRABA 020#2b; |FINSI;
     #85#0 = #104#8;
     #85#1 = #104#9;
     #85#2 = #104#12;
     |LEE 101#85=;
     |SI FSalida ! 0; |GRABA 020#85b; |FINSI;
     #24#0 = #104#8;
     #24#1 = #104#9;
     #24#2 = #104#12;
     |LEE 101#24=;
     |SI FSalida ! 0; |GRABA 020#24b; |FINSI;

     #2#12 = #2#12 + (nUni * nInc);
     #2#104 = #2#104 -(nUni * nInc);
     #8#8 = #8#8 + (nUni * nInc);
     #8#39 = #8#39 -(nUni * nInc);
     #85#9 = #85#9 + (nUni * nInc);
     #24#31 = #24#31 - (nUni * nInc);
     |GRABA 020#2a;
     |GRABA 020#8a;
     |GRABA 020#85a;
     |CIERRA #85;
     |GRABA 020#24a;
     |CIERRA #8;
     |CIERRA #2;
     |CIERRA #24;
|FPRC;

|PROCESODefUniServi; |TIPO 0;
     #104#8 = #0#2;
     #104#9 = #0#3;
|FPRC;

|PROCESO Unidad; |TIPO 0;
     |SI #104#5 < #104#7;
          |MENAV "0000 No puede ser inferior a las servidas...";
          |ERROR;
     |SINO;
          |SI #104#5 > #104#7;
               #104#6 = "N";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO LoteRese; |TIPO 6;
     aAlfa = #104#12; |QBF aAlfa;
     |SI aAlfa ! ""; |Y #104#12 ! #104#10;
          |MENAV "0000Lote incorrecto...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO MiraLote; |TIPO 0;
     aAlfa = #104Campo; |QBF aAlfa;
     |ABRE #24;
     #24#0 = #104#8;
     #24#1 = #104#9;
     #24#2 = aAlfa;
     |LEE 000#24=;
     |SI FSalida ! 0;
          |SI aAlfa ! "";
               |MENAV "0000No existe Lote...";
               |ERROR;
          |SINO;
               |GRABA 020#24n;
          |FINSI;
     |SINO;
          |SI aAlfa ! ""; |Y Campo = 12;
               |SI #24#31 <  #104#5;
                    aAlfa = "0000No hay stock Disponible, quedan: " + #24#31;
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #24;
|FPRC;

|PROCESO UniServi; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI #104#7 ! 0; |O #104#6 = "S";
          |SI nModo = 3;
               |MENAV "0000No se puede modificar...";
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     nInc = 0 +. 1;
     nLin = #104#3;
     nUni = #104#5;
     nErr = 0;
     |HAZ Reserva;
     |SI nErr = 0;
           |HAZ ActCiclos;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO FecServi; |TIPO 0;
     fFecha = #104#4;
     |BUCLE malpe019;
     nInc = 0;
     nLin = #104#3;
     nUni = #104#5;
     |HAZ ActCiclos
|FPRC;

|PROCESO Comisiones;
     nRemanente = 0;
     |SI #0#55 = "N";
          #0#10 = 0;
          |ACABA;
     |FINSI;

     |ABRE #2;
     #2#0 = #0#2;
     |LEE 000#2=;
     |CIERRA #2;
     descu = #0#8;
     comi1 = #2#31;
     comi2 = 0;

     |ABRE #4;
     #4#0 = #0#19;
     |LEE 000#4=;
     |SI 0 = FSalida
          comi2 = #4#1;
     |FINSI;
     |CIERRA #4;
     |HAZ lpsubcom;
|FPRC;

|CALCULO lpsubcom;|TIPO 0;
     #0#17 = #1#16;

     |ABRE #2;
     #2#0 = #0#2;
     |LEE 020#2=;
     |CIERRA #2;
     |SI #2#181 = "N";
          |HAZ ComiLadrillo;
     |SINO;
          |HAZ ComiMortero;
     |FINSI;
|FCAL;

|PROCESO ComiLadrillo;
     |ABRE #3;
     comi3 = 0;
     #3#0 = #0#17;
     aAlfa = #1#1; aAlfa = aAlfa % -104;
     #3#62 = aAlfa;
     #3#63 = #1#73;
     |LEE 000#3=;
     |SI 0 = FSalida;
          menor = 100;
          menor_2 = 0;
          comi3_2 = 0;
          |PARA pc = 1;|SI pc < 40;|HACIENDO pc = pc + 2;
               pcr = pc + 1;
               |SI #3pc ! 0;|Y #3pcr ! 0;
                    tf = #3pc;
                    |SI tf ] descu;|Y tf < menor;
                         menor = tf;
                         comi3 = #3pcr;
                    |SINO;
                         |SI menor_2 = 0; |Y comi3_2 = 0;
                              menor_2 = tf;
                              comi3_2 = #3pcr;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |SI menor_2 = 0; |Y comi3_2 = 0;
                         tf = #3pc;
                         menor_2 = tf;
                         comi3_2 = #3pcr;
                    |FINSI;
                    pc = 40;
               |FINSI;
          |SIGUE;
          comi3 = comi3_2 - ((descu-menor_2)*((comi3_2-comi3)/(menor-menor_2)));
     |FINSI;
     |CIERRA #3;

     menor = 100;
     |SI comi1 > 0;
          menor = comi1;
     |FINSI;
     |SI comi2 > 0;|Y comi2 < menor;
          menor = comi2;
     |FINSI;
     |SI comi3 > 0;|Y comi3 < menor;
          menor = comi3;
     |FINSI;
     |SI menor = 100;
          menor = 0;
     |FINSI;
     #0#10 = menor;
     nRemanente = #3#64;
|FPRC;

|PROCESO ComiMortero;
     |ABRE #209;
     comi3 = 0;
     #209#0 = #0#17;
     aAlfa = #1#1; aAlfa = aAlfa % -104;
     #209#62 = aAlfa;
     #209#63 = #1#73;
     |LEE 000#209=;
     |SI 0 = FSalida;
          menor = 100;
          menor_2 = 0;
          comi3_2 = 0;
          |PARA pc = 1;|SI pc < 40;|HACIENDO pc = pc + 2;
               pcr = pc + 1;
               |SI #209pc ! 0;|Y #209pcr ! 0;
                    tf = #209pc;
                    |SI tf ] descu;|Y tf < menor;
                         menor = tf;
                         comi3 = #209pcr;
                    |SINO;
                         |SI menor_2 = 0; |Y comi3_2 = 0;
                              menor_2 = tf;
                              comi3_2 = #209pcr;
                         |FINSI;
                    |FINSI;
               |SINO;
                    |SI menor_2 = 0; |Y comi3_2 = 0;
                         tf = #209pc;
                         menor_2 = tf;
                         comi3_2 = #209pcr;
                    |FINSI;
                    pc = 40;
               |FINSI;
          |SIGUE;
          comi3 = comi3_2 - ((descu-menor_2)*((comi3_2-comi3)/(menor-menor_2)));
     |FINSI;
     |CIERRA #209;

     menor = 100;
     |SI comi1 > 0;
          menor = comi1;
     |FINSI;
     |SI comi2 > 0;|Y comi2 < menor;
          menor = comi2;
     |FINSI;
     |SI comi3 > 0;|Y comi3 < menor;
          menor = comi3;
     |FINSI;
     |SI menor = 100;
          menor = 0;
     |FINSI;
     #0#10 = menor;
     nRemanente = #209#64;
|FPRC;

|PROCESO DtoComi;
     |SI #0Campo = "N";
          |SI Campo = 54;
               #0#8 = 0; |PINTA #0#8;
               #0#58 = #0#59 < #0#8; |PINTA #0#58;
               #0#6 = #0#58 + #0#60; |PINTA #0#6;
               |HAZ precio_divisa;
               |HAZ Comisiones;
               |PINTA #0#10;
          |FINSI;
          |SI Campo = 55;
               #0#10 = 0;|PINTA #0#10;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Remanente;
     |SI #0#43 ! 0; |ACABA; |FINSI;

     |SI #1#73 = "N";
          #0#65 = "N";
          #0#66 = 0;
          #0#67 = 0;
          |ACABA;
     |FINSI;

     |ABRE #81; |LEE 000#81p; |CIERRA #81;

     efFecha = #1#1;
     eaRemanente = #1#73;
     eaTieneComi = #0#55;
     eaArticulo = #0#2;
     eaTipoCli = #0#19;
     enDto = #0#8;
     eaTipoComi = #1#16;
     |HAZ BusComi;
     nComi1 = enComision1;
     nComi2 = enComision2;

     |DDEFECTO #137;
     |ABRE #137;
     #137#0 = #1#7;
     |LEE 101#137=;
     |SI FSalida ! 0; |GRABA 020#137b; |FINSI;

     nPorce1 = (#0#5 * #0#59) * #0#8 / 100;
     nPorce2 = (#0#5 * #0#59) * nRemanente / 100;
     nImpo = nPorce2 - nPorce1;
     |SI #0#8 = nRemanente;
          #0#65 = "N";
          #0#66 = 0;
          #0#67 = nComi1;
     |FINSI;
     |SI #0#8 < nRemanente;
          #0#65 = "A";
          #0#66 = nImpo;
          #0#67 = nComi1;
          #137#3 = #137#3 + (nImpo * nForma);
     |FINSI;
     |SI #0#8 > nRemanente;
          #0#65 = "C";
          #0#66 = nImpo;
          #0#67 = nComi1;
          #137#2 = #137#2 + (nImpo * nForma);
     |FINSI;
     #137#7 = #137#1 + #137#3 + #137#2 - #137#6;
     #137#8 = #137#1 + #137#5 + #137#4 - #137#6;
     |GRABA 020#137a;
     |CIERRA #137;

     |SI #137#7 < 0;
          #0#10 = nComi2;
     |FINSI;

     |HAZ PinRemanente
|FPRC;

|PROCESO Riesgos73;
     eaSerie = #0#28;
     eaTag = "PE";  |HAZ SacaRiesgoMalpe;
     |SI eaRieSuma = "S"; nRieUtili = nRieUtili + #1#11 + #0#9; |FINSI;
     |SI #agifa142#166 = "S";
          eaDocu = "L";
          eaTipo = "P";
          enImpoDoc = #1#11 + #0#9;
          |HAZ ControlRiesgo;
          |SI enErrRie = 1; |ERROR; |ACABA; |FINSI;
          |SI enAudito = 0;
               |ABRE #43;
               |LEE 000#43u;
               |SI FSalida = 0;
                    nConAu = #43#0 + 1;
               |SINO;
                    nConAu = 1;
               |FINSI;
               |DDEFECTO #43;
               #43#0 = nConAu;
               #43#12 = "PEDIDO";
               #43#1 = #1#25;
               #43#2 = #1#0;
               #43#3 = #1#1;
               #43#4 = #1#4;
               #43#5 = #1#8;
               #43#6 = aUs;
               #43#7 = nRieTotal;
               #43#8 = nRieUtili;
               #43#9 = #41#2;
               #43#10= #41#3;
               #43#11= #41#4;
               |GRABA 020#43n;
               |CIERRA #43;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraMortero;
     |SI #0#1 ! #referen@#1;
          #2#0 = #referen@#2;
          |LEE 020#2=;
          |SI aEsMortero ! #2#181;
               |SI aEsMortero = "S";
                    |MENAV "0000El articulo es MORTERO, no se pueden mezclar los productos...";
               |SINO;
                    |MENAV "0000El articulo es NO MORTERO, no se pueden mezclar los productos...";
               |FINSI;
               |ERROR10;
               nError = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE MiraMortero;
     #referen@#1003;
     ;
     #0#28, #0#0, 001;
     #0#28, #0#0, 999;
     ;
     NULL, MiraMortero;
|FIN;

|PROCESO CtrlMortero;
     nError = 0;
     |ABRE #2;
     #2#0 = #0#2;
     |LEE 000#2=;
     aEsMortero = #2#181;
     |DDEF aAlfa;
     aAlfa = aAlfa + "malpe088";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |BUCLE MiraMortero;
          |DESCARGA_DEF #referen@;
     |FINSI;
     |CIERRA #2;
     FSalida = nError;
|FPRC;

|PROCESO IVA088_66; |TIPO 66;
     enTiva = #0Campo;
     efFiva = #1#1;
     |HAZ ConsuIVA;
     |SI eaDiva = "";
          |ERROR;
     |SINO;
          #0Campo = enTiva; |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO IVA088_0; |TIPO 0;
     enTiva = #0Campo;
     efFiva = #1#1;
     |HAZ SacaIVA;
     |SI eaDiva = "";
          |MENAV "0000No existe tipo iva para esta fecha...";
          |ERROR; |ACABA;
     |SINO;
          |HAZ mirespor;
     |FINSI;
|FPRC;
