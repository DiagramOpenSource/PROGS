|FICHEROS;
     guerz001 #0;

     agifa024 #24;  ||Clientes
     agifa112 #112; ||Proveedores
     agifa040 #40;  ||Provincia
|FIN;

|VARIABLES;
     nTotCli = 0;
     aMensaje = "";
     nLogEscCli = 0;      ||Long. cod. escape en Clientes
     nLogEscPro = 0;      ||Long. cod. escape en Clientes
     nLog7 = 0;
     nLog4 = 0;
     aPathCli = "";
     aNomCli = "";
     aCli = "";
     aPathPro = "";
     aNomPro = "";
     aPro = "";
     nHandle = 0;
     aLinea = "";
     aLong = "";
     nLong = 0;
     aNumCli = "";
     aCliente = "";
     aDomicilio = "";
     aCP = "";
     aPoblacion = "";
     aTelefono = "";
     aDni = "";
     aProvincia = "";
     aCP1 = "";
     aCP2 = "";
     aNumPro = "";
     aProveedor = "";
     nTotPro = 0;
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |SI #guerz001#5 = "SI";
               |ABRE #agifa040;
               |HAZ Principal;
               |CIERRA #agifa040;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO Principal;
     nLogEscCli = 27;       ||Long. cod. escape en Clientes
     nLogEscPro = 29;       ||Long. cod. escape en Clientes
     nLog7 = nLogEscCli + 7;
     nLog4 = nLogEscPro + 4;

     aPathCli = #guerz001#1;
     |QBF aPathCli;
     aNomCli = #guerz001#2;
     |QBF aNomCli;
     aCli = aPathCli + aNomCli;

     aPathPro = #guerz001#3;
     |QBF aPathPro;
     aNomPro = #guerz001#4;
     |QBF aNomPro;
     aPro = aPathPro + aNomPro;

     |XABRE "U", aCli, nHandle;
     |SI FSalida = 0;
          |ABRE #agifa024;
          |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aLinea;
               |SI FSalida < 0;
                    |SAL;
               |SINO;
                    aLong = aLinea % A0;
                    nLong = aLong;
                    |SI nLong ] nLog7;
                         aLinea = aLinea % nLogEscCli;
                         aNumCli = aLinea % 107;
                         |SI aNumCli ! "       "; |Y aNumCli ! "RELACIO"; |Y aNumCli ! "======="; |Y aNumCli ! "CLIENTE"; |Y aNumCli ! "-------";

                              aCliente = aLinea % 940;
                              aCliente = aCliente % 130;

                              aDomicilio = aLinea % 5025;
                              aCP = aLinea % 7605;
                              aCP1 = aCP % 102;
                              aCP2 = aCP % -103;
                              #agifa040#0 = aCP1;
                              |LEE 000#agifa040.=;
                              |SI FSalida = 0;
                                   aProvincia = #agifa040#1;
                              |SINO;
                                   aProvincia = "";
                              |FINSI;

                              aPoblacion = aLinea % 8217;
                              aTelefono = aLinea % 10018;
                              aTelefono = aTelefono % 115;

                              aDni = aLinea % 11920;
                              aDni = aDni % -115;

                              aNumCli = ("00000" + aNumCli) % -106;
                              #agifa024#0 = aNumCli;
                              |LEE 101#agifa024.=;
                              |SI FSalida ! 0; |GRABA 020#agifa024.b; |FINSI;
                              ||TODO CCC. Linea Buena
                              #agifa024#1 = aCliente;
                              #agifa024#2 = aCliente;

                              #agifa024#5 = aDomicilio;
                              #agifa024#8 = aDomicilio;
                              #agifa024#11 = aDomicilio;

                              #agifa024#6 = aPoblacion;
                              #agifa024#9 = aPoblacion;
                              #agifa024#12 = aPoblacion;

                              #agifa024#7 = aProvincia;
                              #agifa024#10 = aProvincia;
                              #agifa024#13 = aProvincia;

                              #agifa024#15 = aDni;
                              #agifa024#17 = aTelefono;

                              #agifa024#178 = aCP1;
                              #agifa024#181 = aCP1;
                              #agifa024#184 = aCP1;
                              #agifa024#179 = aCP2;
                              #agifa024#182 = aCP2;
                              #agifa024#185 = aCP2;

                              |GRABA 020#agifa024.a;
                              |LIBERA #agifa024;
                              nTotCli = nTotCli + 1;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |SIGUE;
          |PINTA 1505,"Realizando Captura de Datos de Clientes, Espere un Momento .....";
          |XCIERRA nHandle;
          |PINTA 1505,"Finalizada Captura. " + nTotCli + " Clientes importados.        ";
          |CIERRA #agifa024;
     |FINSI;

     |XABRE "U", aPro, nHandle;
     |SI FSalida = 0;
          |ABRE #agifa112;
          |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aLinea;
               |SI FSalida < 0;
                    |SAL;
               |SINO;
                    aLong = aLinea % A0;
                    nLong = aLong;
                    |SI nLong ] nLog4;
                         aLinea = aLinea % nLogEscPro;
                         aNumPro = aLinea % 104;
                         |SI aNumPro ! "    "; |Y aNumPro ! "LIST"; |Y aNumPro ! "===="; |Y aNumPro ! "CLAV"; |Y aNumPro ! "----";

                              aNumPro = ("000000" + aNumPro) % -106;

                              aProveedor = aLinea % 640;

                              aDomicilio = aLinea % 6130;

                              aCP = aLinea % 13405;
                              aCP1 = aCP % 102;
                              aCP2 = aCP % -103;
                              #agifa040#0 = aCP1;
                              |LEE 000#agifa040.=;
                              |SI FSalida = 0;
                                   aProvincia = #agifa040#1;
                              |SINO;
                                   aProvincia = "";
                              |FINSI;

                              aPoblacion = aLinea % 10230;
                              aTelefono = aLinea % 17518;
                              aTelefono = aTelefono % 115;

                              aDni = aLinea % 15020;
                              aDni = aDni % 115;

                              #agifa112#0 = aNumPro;
                              |LEE 101#agifa112.=;
                              |SI FSalida ! 0; |GRABA 020#agifa112.b; |FINSI;
                              ||TODO CCC. Linea Buena
                              #agifa112#1 = aProveedor;
                              #agifa112#2 = aProveedor;

                              #agifa112#3 = aDomicilio;
                              #agifa112#4 = aPoblacion;
                              #agifa112#5 = aProvincia;
                              #agifa112#6 = aTelefono;
                              #agifa112#9 = aDni;

                              #agifa112#74 = aCP1;
                              #agifa112#75 = aCP2;

                              |GRABA 020#agifa112.a;
                              |LIBERA #agifa112;
                              nTotPro = nTotPro + 1;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |SIGUE;
          |PINTA 1505,"Realizando Captura de Datos de Proveedor, Espere un Momento .....";
          |XCIERRA nHandle;
          |PINTA 1505,"Finalizada Captura. " + nTotPro + " Proveedores importados.            ";
          |CIERRA #agifa112;
     |FINSI;
|FPRC;
