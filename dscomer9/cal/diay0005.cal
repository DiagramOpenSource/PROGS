|FICHEROS;
     diay0005 #0;

     agifa104 #104;
     agifa134 #134;
     agifa010 #10;
     agifa019 #19;
     agifa059 #59;
     agifa071 #71;
     agifa073 #73;
     agifa025 #25;

     diam0001 #101;
     diam0009 #109;
     diam0015 #115;
     diam0016 #116;
     diam0022 #122;

     diaw0011 #900;

     :/dspartes/def/dsasis04 #300;
|FIN;

|VARIABLES;
     nCampo       = 0;
     nCampo1      = 0;
     nSeguir      = 0;
     nAnyo        = 0;
     nMes         = 0;
     nComis1      = 0;
     nComis2      = 0;
     nCoste1      = 0;
     nCoste2      = 0;
     nImporte     = 0;
     nSwHay       = 0;
     nError       = 0;
     nErrorAlb    = 0;
     nErrorPed    = 0;
     nErrorInf    = 0;
     nHandle      = 0;
     nPedido      = 0;
     nAlbaran     = 0;
     nTecnico     = 0;

     aAlfa        = "";
     aComis1      = "";
     aComis2      = "";
     aRuta        = "";
     aBase        = "";
     aBaseBin     = "";
     aPathInforme = "";
     aPathPdf     = "";
     aNombreDoc   = "";
     aImpresora   = "";
     aPdf         = "";
     aSystem      = "";
     aOrigen      = "";
     aDestino     = "";
     aSeriePed    = "";
     aSerieAlb    = "";
     aFichError   = "";

     fFechaP      = @;
     fFechaF      = @;

     &Tempo       = "";
     &eaTitulo    = "";
     &enR1        = 0;
     &enR2        = 0;
     &enR3        = 0;
     &enR4        = 0;
     &enR5        = 0;
     &enR6        = 0;
     &enR7        = 0;
     &enR8        = 0;
     &enFinal     = 0;
|FIN;

|| -------------------------------------------------------------------------
|| PROCESOS DATOS POR PANTALLAS
|| -------------------------------------------------------------------------

|PROCESO Browse;  |TIPO 0;
     |SI FSalida = 10;
         aRuta = #0#18;  |QBF aRuta;
         aRuta = "D" + aRuta;

         |BROWSE aRuta;

         aRuta = aRuta % 299;  |QBF aRuta;
         #0#18 = aRuta + "\";
     |FINSI;

     aRuta = #0#18;
     |QBT aRuta;
     |SI aRuta = "";
         |MENAV "0000 Necesito una ubicacion.";
         |ERROR;
     |FINSI;

     |PINTA #0#18;
|FPRC;

|PROCESO SacaBrowse;  |TIPO 7;
     aRuta = #0#18;  |QBF aRuta;
     |SI aRuta = "";
         FSalida = 10;
         |HAZ Browse;
     |FINSI;
|FPRC;

|PROCESO Representante;
     |C_M #0#01, 1, "S";
     |C_M #0#02, 1, "S";
     |C_M #0#03, 1, "S";
     |C_M #0#04, 1, "S";
     |C_M #0#05, 1, "S";
     |C_M #0#06, 1, "S";
     |C_M #0#07, 1, "S";
     |C_M #0#08, 1, "S";
     |C_M #0#09, 1, "S";
     |C_M #0#10, 1, "S";
     |C_M #0#11, 1, "S";
     |C_M #0#12, 1, "S";

     |SI #0#0  = "T";
         #0#01 = "!!";  |PINTA #0#01;  |C_M #0#01, 1, "N";
         #0#02 = "!!";  |PINTA #0#02;  |C_M #0#02, 1, "N";
         #0#03 = "!!";  |PINTA #0#03;  |C_M #0#03, 1, "N";
         #0#04 = "!!";  |PINTA #0#04;  |C_M #0#04, 1, "N";
         #0#05 = "!!";  |PINTA #0#05;  |C_M #0#05, 1, "N";
         #0#06 = "!!";  |PINTA #0#06;  |C_M #0#06, 1, "N";
         #0#07 = "!!";  |PINTA #0#07;  |C_M #0#07, 1, "N";
         #0#08 = "!!";  |PINTA #0#08;  |C_M #0#08, 1, "N";
         #0#09 = "!!";  |PINTA #0#09;  |C_M #0#09, 1, "N";
         #0#10 = "!!";  |PINTA #0#10;  |C_M #0#10, 1, "N";
         #0#11 = "  ";  |PINTA #0#11;  |C_M #0#11, 1, "N";
         #0#12 = "zz";  |PINTA #0#12;  |C_M #0#12, 1, "N";
     |FINSI;

     |SI #0#0  = "A";
         #0#11 = "  ";  |PINTA #0#11;  |C_M #0#11, 1, "N";
         #0#12 = "zz";  |PINTA #0#12;  |C_M #0#12, 1, "N";
     |FINSI;

     |SI #0#0  = "D";
         #0#01 = "!!";  |PINTA #0#01;  |C_M #0#01, 1, "N";
         #0#02 = "!!";  |PINTA #0#02;  |C_M #0#02, 1, "N";
         #0#03 = "!!";  |PINTA #0#03;  |C_M #0#03, 1, "N";
         #0#04 = "!!";  |PINTA #0#04;  |C_M #0#04, 1, "N";
         #0#05 = "!!";  |PINTA #0#05;  |C_M #0#05, 1, "N";
         #0#06 = "!!";  |PINTA #0#06;  |C_M #0#06, 1, "N";
         #0#07 = "!!";  |PINTA #0#07;  |C_M #0#07, 1, "N";
         #0#08 = "!!";  |PINTA #0#08;  |C_M #0#08, 1, "N";
         #0#09 = "!!";  |PINTA #0#09;  |C_M #0#09, 1, "N";
         #0#10 = "!!";  |PINTA #0#10;  |C_M #0#10, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ConsuRepresentante;  |TIPO 66;
     |ABRE #25;

     #25#0 = #0Campo;
     |LEE 040#25=;
     |SI FSalida ! 0;  |LEE 040#25p; |FINSI;

     |CONSULTA_CLAVE #1#25;
     |SI FSalida = 0;
         #0Campo = #25#0;  |PINTA #0Campo;
     |FINSI;
     |CIERRA #25;
|FPRC;

|PROCESO Mes;
     nCampo1 = Campo + 1;

     |SI #0Campo = 0;   #0nCampo1 = "TODOS     ";  |FINSI;
     |SI #0Campo = 1;   #0nCampo1 = "ENERO     ";  |FINSI;
     |SI #0Campo = 2;   #0nCampo1 = "FEBRERO   ";  |FINSI;
     |SI #0Campo = 3;   #0nCampo1 = "MARZO     ";  |FINSI;
     |SI #0Campo = 4;   #0nCampo1 = "ABRIL     ";  |FINSI;
     |SI #0Campo = 5;   #0nCampo1 = "MAYO      ";  |FINSI;
     |SI #0Campo = 6;   #0nCampo1 = "JUNIO     ";  |FINSI;
     |SI #0Campo = 7;   #0nCampo1 = "JULIO     ";  |FINSI;
     |SI #0Campo = 8;   #0nCampo1 = "AGOSTO    ";  |FINSI;
     |SI #0Campo = 9;   #0nCampo1 = "SEPTIEMBRE";  |FINSI;
     |SI #0Campo = 10;  #0nCampo1 = "OCTUBRE   ";  |FINSI;
     |SI #0Campo = 11;  #0nCampo1 = "NOVIEMBRE ";  |FINSI;
     |SI #0Campo = 12;  #0nCampo1 = "DICIEMBRE ";  |FINSI;

     |PINTA #0nCampo1;
|FPRC;

|| -------------------------------------------------------------------------
|| PROCESOS DEL INFORME
|| -------------------------------------------------------------------------

|PROCESO AbreImpresora;
     |DBASE aBase;   |QBF aBase;
     aPathInforme = aBase + "000577/pdf";
     |MKDIR aPathInforme;

     aNombreDoc = "IFactura.pdf";
     aImpresora = aPathInforme + "/ifactura.txt";
     aPdf       = aPathInforme + "/" + aNombreDoc;

     nError    = 0;
     Impresora = aImpresora;
     |IMPRE -77;
     |SI FSalida ! 0;  nError = 1;  |FINSI;
|FPRC;

|PROCESO ComisionPrepedido;
     aComis1  = "";
     aComis2  = "";
     nComis1  = -1;
     nComis2  = -1;
     nCoste1  = 0;
     nCoste2  = 0;

     |SI #101#18 ! "  ";  |Y #101#18 ! "00";
         aComis1  = #101#18;
         nComis1  = #101#30;
     |FINSI;

     |SI #101#29 ! "  ";  |Y #101#29 ! "00";
         aComis2 = #101#29;
         nComis2 = #101#31;
     |FINSI;

     #116#0  = #101#0;
     #116#1  = #101#1;
     #116#13 = #101#13;
     |LEE 040#116=;
     |SI FSalida ! 0;
         |DDEFECTO #116;
         nCoste1 = #101#16;
         nCoste2 = (#134#91 + #134#94 + #134#97 + #134#102 + #134#105 + #134#47) - #101#16;
     |SINO;
         nCoste1 = #116#16;
         nCoste2 = #116#80 + #116#85 - #116#81;  || La Base Comision del tecnico
     |FINSI;
|FPRC;

|PROCESO ComisionFactura;
     aComis1 = "";
     aComis2 = "";
     nComis1 = -1;
     nComis2 = -1;
     nCoste1 = 0;
     nCoste2 = 0;

     aComis1 = #134#7;
     nComis1 = 1;
     |SI #134#49 ! "S1   ";  |Y #134#49 ! "H1   ";
         nComis1 = 3;
     |FINSI;

     #300#105 = #10#52;
     #300#106 = #10#0;
     |LEE 040#300=;
     |SI FSalida ! 0;  |DDEFECTO #300;  |FINSI;

     nCoste1 = #300#123;

     |SI #300#123 = 0;
         #122#0 = #134#49;
         #122#1 = #134#0;
         |LEE 040#122=;
         |SI FSalida ! 0;  |DDEFECTO #122;  |FINSI;

         nCoste1 = #122#7;
     |FINSI;
|FPRC;

|PROCESO agifa071;
     |SI nPedido = 0;
         aSeriePed  = #71#31;
         nPedido    = #71#12;
     |FINSI;

     |SI nErrorPed = 0;
         |SI aSeriePed ! #71#31;  |O nPedido ! #71#12;
             aAlfa = "Mas de un Pedido  en el ALBARAN : " + #71#29 + " " + #71#0 + " Dentro de la FACTURA : " + #134#49 + " " + #134#0 + &13 + &10;
             |XGRABA nHandle, aAlfa;

             nErrorInf = 1;
             nErrorPed = 1;
         |FINSI;
     |FINSI;

     nImporte = #71#5 * #71#6;

     #19#0 = #71#2;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

                           nCampo = 16;
     |SI #19#2 = #115#1;   nCampo = 12;  |FINSI;
     |SI #19#2 = #115#5;   nCampo = 12;  |FINSI;
     |SI #19#2 = #115#9;   nCampo = 12;  |FINSI;
     |SI #19#2 = #115#13;  nCampo = 12;  |FINSI;
     |SI #19#2 = #115#17;  nCampo = 12;  |FINSI;
     |SI #19#2 = #115#21;  nCampo = 12;  |FINSI;
     |SI #19#2 = #115#28;  nCampo = 12;  |FINSI;
     |SI #19#2 = #115#31;  nCampo = 12;  |FINSI;
     |SI #19#2 = #115#34;  nCampo = 13;  |FINSI;
     |SI #19#2 = #115#37;  nCampo = 13;  |FINSI;
     |SI #19#2 = #115#40;  nCampo = 14;  |FINSI;
     |SI #19#2 = #115#43;  nCampo = 14;  |FINSI;
     |SI #19#2 = #115#51;  nCampo = 15;  |FINSI;
     |SI #19#2 = #115#54;  nCampo = 15;  |FINSI;
     |SI #19#2 = #115#57;  nCampo = 15;  |FINSI;
     |SI #19#2 = #115#60;  nCampo = 15;  |FINSI;
     |SI #19#2 = #115#63;  nCampo = 15;  |FINSI;
     |SI #19#2 = #115#66;  nCampo = 15;  |FINSI;

     #900nCampo = #900nCampo + nImporte;
     #900#17    = #900#17    + nImporte;

     aSeriePed  = #71#31;
     nPedido    = #71#12;
|FPRC;

|DEFBUCLE agifa071;
     #71#1;
     ;
     #59#15, #59#2, 001;
     #59#15, #59#2, 999;
     ;
     NULL, agifa071;
|FIN;

|PROCESO agifa059;
     |SI nTecnico = 1;
         |SI nAlbaran = 0;
             aSerieAlb = #59#15;
             nAlbaran  = #59#2;
         |FINSI;

         |SI nErrorAlb = 0;
             |SI aSerieAlb ! #59#15;  |O nAlbaran ! #59#2;
                 aAlfa = "Mas de un Albaran en la FACTURA : " + #134#49 + " " + #134#0 + &13 + &10;
                 |XGRABA nHandle, aAlfa;

                 nErrorInf = 1;
                 nErrorAlb = 1;
             |FINSI;
         |FINSI;

         aSerieAlb = #59#15;
         nAlbaran  = #59#2;
     |FINSI;

     aSeriePed  = "";
     nPedido    = 0;
     nErrorPed  = 0;

     |BUCLE agifa071;
|FPRC;

|PROCESO GrabaTecnico1;
     nTecnico = 1;
     nSeguir  = 1;

     |SI #0#0 = "A";
         nSeguir = 0;

         |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = aComis1;
                   nSeguir = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #0#0 = "D";
         |SI aComis1 < #0#11;  |O aComis1 > #0#12;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nSeguir = 0;  |ACABA;  |FINSI;

     #25#0 = aComis1;
     |LEE 040#25=;
     |SI FSalida ! 0;  |DDEFECTO #25;  |FINSI;

     #109#0 = aComis1;
     |LEE 040#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;

     |DDEFECTO #900;
     #900#0 = aComis1;
     #900#1 = nAnyo;
     #900#2 = nMes;
     #900#3 = #134#49;
     #900#4 = #134#0;
     #900#5 = 1;
     #900#6 = #25#1;

     |SI nComis1 = 1;  #900#7 = #109#1;  |FINSI;
     |SI nComis1 = 2;  #900#7 = #109#2;  |FINSI;
     |SI nComis1 = 3;  #900#7 = #109#3;  |FINSI;

     #900#8  = fFechaP;
     #900#9  = fFechaF;
     #900#10 = #134#2;
     #900#11 = #134#3;

     aSerieAlb  = "";
     nAlbaran   = 0;
     nErrorAlb  = 0;

     |BUCLELIN 0agifa059#134;

     #900#18 = nCoste1;
     #900#19 = #900#17 - #900#18;

     |GRABA 020#900n;
     |LIBERA #900;

     nSwHay = 1;
|FPRC;

|PROCESO GrabaTecnico2;
     |SI aComis1 = aComis2;  |ACABA;  |FINSI;

     nTecnico = 2;
     nSeguir  = 1;

     |SI #0#0 = "A";
         nSeguir = 0;

         |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo = aComis2;
                   nSeguir = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;

     |SI #0#0 = "D";
         |SI aComis2 < #0#11;  |O aComis2 > #0#12;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI nSeguir = 0;  |ACABA;  |FINSI;

     #25#0 = aComis2;
     |LEE 040#25=;
     |SI FSalida ! 0;  |DDEFECTO #25;  |FINSI;

     #109#0 = aComis2;
     |LEE 040#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;

     |DDEFECTO #900;
     #900#0 = aComis2;
     #900#1 = nAnyo;
     #900#2 = nMes;
     #900#3 = #134#49;
     #900#4 = #134#0;
     #900#5 = 2;
     #900#6 = #25#1;

     |SI nComis2 = 1;  #900#7 = #109#1;  |FINSI;
     |SI nComis2 = 2;  #900#7 = #109#2;  |FINSI;
     |SI nComis2 = 3;  #900#7 = #109#3;  |FINSI;

     #900#8  = fFechaP;
     #900#9  = fFechaF;
     #900#10 = #134#2;
     #900#11 = #134#3;

     |BUCLELIN 0agifa059#134;

     #900#17 = #134#91 + #134#94 + #134#97 + #134#102 + #134#105 + #134#47;
     #900#19 = nCoste2;                       || La Base Comision del tecnico
     #900#18 = #900#17 - #900#19;             || 2 no entra el Hard ni los

     |GRABA 020#900n;
     |LIBERA #900;

     nSwHay = 1;
|FPRC;

|PROCESO agifa134;
     #59#14 = #134#49;
     #59#0  = #134#0;
     #59#1  = 1;
     |LEE 040#59];
     |SI FSalida ! 0;  |O  #59#14 ! #134#49;  |O  #59#0  ! #134#0;
         |DDEFECTO #59;
         #59#0 = 0;
     |FINSI;

     #10#52 = #59#15;
     #10#0  = #59#2;
     |LEE 040#10=;
     |SI FSalida ! 0;
         |DDEFECTO #10;
         #10#0 = 0;
     |FINSI;

     #71#29 = #10#52;
     #71#0  = #10#0;
     #71#1  = 1;
     |LEE 040#71];
     |SI FSalida ! 0;  |O  #71#29 ! #10#52;  |O  #71#0  ! #10#0;
         |DDEFECTO #71;
         #71#0 = 0;
     |FINSI;

     #73#28 = #71#31;
     #73#0  = #71#12;
     #73#1  = 1;
     |LEE 040#73];
     |SI FSalida ! 0;  |O  #73#28 ! #71#31;  |O  #73#0  ! #71#12;
         |DDEFECTO #73;
     |FINSI;

     |SI #73#28 = "     ";  |Y #73#0 = 1;
         #73#0 = 0;
     |FINSI;

     #104#25 = #73#28;
     #104#0  = #73#0;
     |LEE 040#104=;
     |SI FSalida = 0;  |Y #73#0 ! 0;
         aAlfa = #104#1 % 402;   nMes  = aAlfa;
         aAlfa = #104#1 % -104;  nAnyo = aAlfa;

         |SI nAnyo < #0#13;  |ACABA;  |FINSI;

         |SI #0#16 ! 0;
             |SI nMes < #0#14;  |O nMes > #0#16;
                 |ACABA;
             |FINSI;
         |SINO;
             |SI nMes < #0#14;
                 |ACABA;
             |FINSI;
         |FINSI;

         fFechaP = #104#1;
         fFechaF = #134#1;

         #101#14 = #73#28;
         #101#15 = #73#0;
         |LEE 040#101=;
         |SI FSalida = 0;
             |HAZ ComisionPrepedido;
         |SINO;
             |HAZ ComisionFactura;
         |FINSI;
     |SINO;
         aAlfa = #134#1 % 402;   nMes  = aAlfa;
         aAlfa = #134#1 % -104;  nAnyo = aAlfa;

         |SI nAnyo < #0#13;  |ACABA;  |FINSI;

         |SI #0#16 ! 0;
             |SI nMes < #0#14;  |O nMes > #0#16;
                 |ACABA;
             |FINSI;
         |SINO;
             |SI nMes < #0#14;
                 |ACABA;
             |FINSI;
         |FINSI;

         fFechaP  = "01.01.0000";
         fFechaF  = #134#1;

         |HAZ ComisionFactura;
     |FINSI;

     |SI nComis1 ! -1;  |HAZ GrabaTecnico1;  |FINSI;
     |SI nComis2 ! -1;  |HAZ GrabaTecnico2;  |FINSI;
|FPRC;

|DEFBUCLE agifa134;
     #134#4;
     ;
     "31.12.9999", "zzzzz", 999999, "      ";
     "01.01.0000", "     ", 000000, "zzzzzz";
     ;
     NULL, agifa134;
|FIN;

|PROCESO diaw0011;
     enR1 = enR1 + #900#12;
     enR2 = enR2 + #900#13;
     enR3 = enR3 + #900#14;
     enR4 = enR4 + #900#15;
     enR5 = enR5 + #900#16;
     enR6 = enR6 + #900#17;
     enR7 = enR7 + #900#18;
     enR8 = enR8 + #900#19;

     |PRINT;
|FPRC;

|DEFBUCLE diaw0011;
     #900#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, diaw0011;
|FIN;

|PROCESO diaw0011_2T;
     enR1 = enR1 - #900#12;
     enR2 = enR2 - #900#13;
     enR3 = enR3 - #900#14;
     enR4 = enR4 - #900#15;
     enR5 = enR5 - #900#16;
     enR6 = enR6 - #900#17;
     enR7 = enR7 - #900#18;
     enR8 = enR8 - #900#19;

     |PRINT;

     nSwHay = 1;
|FPRC;

|DEFBUCLE diaw0011_2T;
     #900#1;
     ;
     "  ", 0000, 00, "     ",      0, 2;
     "zz", 9999, 99, "zzzzz", 999999, 2;
     ;
     NULL, diaw0011_2T;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ CreaTempo;
     |NOME_DAT #900 Tempo;
     |DELINDEX #900;

     |ABRE #115;
     #115#71 = #0#13;
     |LEE 040#115=;
     |SI FSalida ! 0;  |DDEFECTO #115;  |FINSI;
     |CIERRA #115;

     |DBASE aBase;   |QBF aBase;
     aPathInforme = aBase + "000577/pdf";
     |MKDIR aPathInforme;

     aFichError = aPathInforme + "/ficherro.txt";
     |XABRE "W", aFichError, nHandle;

     |ABRET #25;
     |ABRET #59;
     |ABRET #10;
     |ABRET #19;
     |ABRET #71;
     |ABRET #73;
     |ABRET #101;
     |ABRET #104;
     |ABRET #109;
     |ABRET #116;
     |ABRET #122;
     |ABRET #300;
     |ABRE #900;

     |SELECT #2#101;
     |SELECT #2#300;

     nSwHay    = 0;
     nErrorInf = 0;
     |BUCLE agifa134;

     |XCIERRA nHandle;

     |CIERRAT #25;
     |CIERRAT #59;
     |CIERRAT #10;
     |CIERRAT #19;
     |CIERRAT #71;
     |CIERRAT #73;
     |CIERRAT #101;
     |CIERRAT #104;
     |CIERRAT #109;
     |CIERRAT #116;
     |CIERRAT #122;
     |CIERRAT #300;
     |CIERRA #900;

     |SI nSwHay = 0;
         |MENAV "0000 Seleccion Vacia.";
         |DELINDEX #900;  |HAZ BoraTempo;
         |ACABA;
     |FINSI;

     |HAZ AbreImpresora;
     |SI nError = 1;
         |DELINDEX #900;  |HAZ BoraTempo;
         |ACABA;
     |FINSI;

     |INFOR "diay0005";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     enFinal  = 0;
     eaTitulo = "INFORME DE FACTURAS PARA EL COTEJO DE COMISIONES";
     |BUCLE diaw0011;

     |PIEINF;

     nSwHay   = 0;
     enFinal  = 1;
     eaTitulo = "INFORME DE FACTURAS PARA EL COTEJO DE COMISIONES (SEGUNDO TECNICO)";
     |BUCLE diaw0011_2T;
     |SI nSwHay = 1;  |PIEINF;  |FINSI;

     |FININF;
     |FINIMP;

     |DBASS aBaseBin;  |QBF aBaseBin;
     aBaseBin = aBaseBin + "bin/topdf.sh ";

     aPathPdf = #0#18;  |QBF aPathPdf;

     aSystem = aBaseBin + aImpresora + " Horizontal";

     |QUE_SISTEMA aAlfa;
     |SI aAlfa = "ESDOS";
          aSystem = "d:\perl\bin\perl.exe d:\perl\bin\dsbin\ascii2pdf.pl -l -p6 " + aImpresora  + " >> d:\dsx\bin\log.log 2>> d:\dsx\bin\log.err";
     |FINSI;

     |SYSTEM aSystem;

     aOrigen  = aImpresora - ".txt" + ".pdf";
     aDestino = aPdf;
     |RENOMBRA_FICHERO aOrigen, aDestino;

     |FBORRA aImpresora;

     aOrigen  = aDestino;
     aDestino = aPathPdf + aNombreDoc;
     |RFBORRA aDestino;

     |ENVIA_FICHERO aOrigen, aDestino;

     |FBORRA aOrigen;

     aDestino = aPathPdf + "ficherro.txt";
     |RFBORRA aDestino;
     |SI nErrorInf = 1;
         aOrigen  = aFichError;
         |ENVIA_FICHERO aOrigen, aDestino;

         |MENAV "0000 Han habido incidencias en el calculo, consultar el fichero generado : ficherro.txt";
     |FINSI;

     |FBORRA aFichError;

     |DELINDEX #900;
     |HAZ BoraTempo;
|FPRC;

|PROGRAMA;
    |CLS;
    |CABEZA "Informe Facturas Comisiones";

    |ABRE #0;
    |DDEFECTO #0;
    #0#19 = Usuario % 810;
    |LEE 101#0=;
    |SI FSalida ! 0;
        |GRABA 020#0b;
    |FINSI;

    |PDEFECTO #0, 1, 18;
    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |HAZ Tipo3;
        |GRABA 020#0a;
    |FINSI;
    |LIBERA #0;
    |CIERRA #0;
|FPRO;
