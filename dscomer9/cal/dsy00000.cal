||* Calculo de:
||  agifa014, agifa016, agifa035, agifa100, agifa105, agifa150, dsy00012

Procesos: AbreTemporales, TrataCompo, ElRemate

Los informes estabdar con tallas son:
     ds000???.inf   sin agrupar
     ds005???.inf   agrupados


|FICHEROS;
     agifa081 #1;
     agifa104 #2;
     agifa077 #3;
     agifa010 #4;
     agifa036 #36;
     dsm00083 #83;
     dsm00138 #138;
     agifa146 #146;

     dsy00000 #900,MANTE;
     dsm00005 #905;
     dsm00010 #910;

     dsw00008 #1008;
     dsw00009 #1009;
     dsw00010 #1010;
     dsw00012 #1012;
     dsw00017 #1017;
     dsw00019 #1019;
|FIN;

|VARIABLES;
     nPrecio  = 0;
     &eaImpElige = "";
     &eaHayTallas = "S";
     &enSwAmpli = 0;
     &informe1    = "";
     &n5Elem      = 0;
     &enSwOtraPag = 0;
     &enSwCabElem = 0;
     aTitAnt      = "";
     aLong        = "";
     nLong1       = 0;
     nLong2       = 0;
     nNume        = 0;
     nNume1       = 0;
     nPrecAnt     = 0;

     &Tempo       = "";
     aTempo10     = "";
     aTempo20     = "";
     aTempo30     = "";
     aTempo40     = "";
     &aTempo905   = "";
     &enSwi       = 0;
     &aSer        = "";
     nNum         = 0;
     aCod         = "";
     aModulo      = "";
     &enImpo      = 0;
     &enSwImpre   = 0;
     &enSwAnna    = 0;
     &eaTipo      = "";
     &eaSerie     = "";
     &enCodig     = 0;
     &enLinea     = 0;
     &eaArticulo  = "";
     &eaNArticulo = "";
     &enUnidades  = 0;
     &enPrecio    = 0;
     &enDto1      = 0;
     &enDto2      = 0;
     &enPantalla  = 0;
     &efFEntrega  = @;
     &enNPedido   = 0;

     &Elem = "";
     &Unid = 0;
     &Prec = 0;
     &Tota = 0;

     &enSwCabArt = 0;
     aArtAnt = "";
     aLineaTit = ""; aLineaCom = "";
     Calc  = 0;
     nCont = 0;

     aArticulo   = "";
     aColor      = "";
     aAlfa       = "";
     aAlfa1      = "";
     nConta      = 0;
     nOrden      = 0;
     nSwPasa     = 0;
     nPasada     = 0;
     nCampo      = 0;
     aArti       = "";
     nLinea      = 0;
     nLineaNueva = 0;
     aMenInforme = "";
     nPrime = 0;
|FIN;

|PROCESO CargaDatosPan;
     |ABRE #910;
     |LEE 040#910p;
     |SI FSalida ! 0;  |DDEFECTO #910;  |FINSI;
     |CIERRA #910;

     |SI #910#19 = "N";
         |MENAV "      No tiene activado este proceso.";
         |ACABA;
     |FINSI;

     |SI eaImpElige = "CrystalReport";
          |ABRE #900; |LEE 101#900p;
          |SI FSalida ! 0; |GRABA 020#900b; |FINSI;
          #900#4 = "N";
          #900#1 = #910#51;
          #900#3 = 2;
          #900#2 = 1;
          |GRABA 020#900a;
          |CIERRA #900;
          |ACABA;
     |FINSI;

     |PUSHV 0501 2380;

     |ABRE #900;
     |LEE 101#900p;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         |GRABA 020#900b;
     |FINSI;
     |BLANCO 821 2058;
     |PINPA #0#900;
     |PINDA #0#900;

     |ATRI N;  |PINTA 1132, #910#20;
               |PINTA 1731, #910#20;
               |PINTA 1839, #910#20;
     |ATRI 0;

     |ENDATOS #1#900;
     |SI FSalida = 0;
         |GRABA 020#900a;
         |SI #900#4 = "S";    || Agrupa
             |FININF;
             |INFOR informe1;
             |SI FSalida ! 0;
                  aMenInforme = "0000Informe [" + informe1 + "] inaccesible.";
                  |MENAV aMenInforme;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |POPV;

     |ERROR;
|FPRC;

|PROCESO PulsaTecla;  |TIPO 6;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     |HAZ CargaDatosPan;
|FPRC;

|PROCESO AbreTemporales;
     nPrime = 0;
     |ABRE #900;
     |LEE 040#900p;
     |SI FSalida ! 0;
         |CIERRA #900;
         |HAZ CargaDatosPan;
     |SINO;
         |CIERRA #900;
     |FINSI;

     |HAZ CreaTempo; aTempo10 = Tempo;
     |HAZ CreaTempo; aTempo20 = Tempo;
     |HAZ CreaTempo; aTempo30 = Tempo;
     |HAZ CreaTempo; aTempo40 = Tempo;

     |NOME_DAT #1008 aTempo10;
     |NOME_DAT #1009 aTempo20;
     |NOME_DAT #1019 aTempo30;
     |NOME_DAT #1017 aTempo40;

     |DELINDEX #1008;
     |DELINDEX #1009;
     |DELINDEX #1019;
     |DELINDEX #1017;

     |ABRE #1008;
     |ABRE #1009;
     |ABRE #1019;
     |ABRE #1017;

     nConta = 1;
     nOrden = 1;
|FPRC;

|PROCESO Chequear;
     |SELECT #1#1019;

     #1019#0  = eaArticulo;
     #1019#1  = enPrecio;
     #1019#2  = efFEntrega;
     |LEE 040#1019=;
     |SI FSalida = 0;
         nLineaNueva = #1019#3;
     |SINO;
         |SELECT #2#1019;
         nLineaNueva = 0;
         |PARA nLineaNueva = 0;  |SI nLineaNueva [ 999;  |HACIENDO nLineaNueva = nLineaNueva + 1;
               #1019#0  = eaArticulo;
               #1019#3  = nLineaNueva;
               |LEE 101#1019=;
               |SI FSalida ! 0;
                   |SELECT #1#1019;
                   #1019#0  = eaArticulo;
                   #1019#1  = enPrecio;
                   #1019#2  = efFEntrega;
                   #1019#3  = nLineaNueva;
                   |GRABA 020#1019n;
                   |LIBERA #1019;
                   |SAL;
               |FINSI;
               |LIBERA #1019;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ChequearSin;
     |SELECT #4#1008;
     #1008#0 = eaArticulo;
     #1008#1 = "";
     #1008#6 = 999;
     |LEE 000#1008];
     |SI FSalida = 0;
          |LEE 000#1008a;
     |SINO;
          |LEE 000#1008u;
     |FINSI;
     |SI FSalida = 0; |Y #1008#0 = eaArticulo;
          nLineaNueva = #1008#6 + 1;
     |SINO;
          nLineaNueva = 1;
     |FINSI;
     |SELECT #1#1008;
|FPRC;

|PROCESO CargaTempo;
     nSwPasa = 1;

     |SI #900#3 = 1;     || Ordena por Arti
         |HAZ Chequear;
     |SINO;
         nLineaNueva = #905#3;
     |FINSI;

     #1008#0  = eaArticulo;
     #1008#1  = #905#4;
     #1008#6  = nLineaNueva;
     |LEE 101#1008=;
     |SI FSalida ! 0;
         |DDEFECTO #1008;
         #1008#0 = eaArticulo;
         #1008#1 = #905#4;
         #1008#6 = nLineaNueva;
         |GRABA 020#1008b;
     |FINSI;
     |SI enSwAnna = 1;
          #1008#2  = #1008#2 + (#905#6 - #905#12);
     |SINO;
          #1008#2  = #1008#2 + #905#6;
     |FINSI;
     #1008#3  = #905#7;
     #1008#4  = eaNArticulo;
     aAlfa    = #905#5 % 106;  |QBT aAlfa;
     aAlfa    = ("      " + aAlfa) % -106;
     #1008#5  = aAlfa;
     #1008#7  = #905#1;
     #1008#8  = #905#2;
     #1008#9  = #905#3;
     #1008#10 = efFEntrega;
     #1008#11 = enNPedido;
     #1008#12 = #1008#12 + enImpo;
     #1008#13 = enDto1;
     #1008#14 = enDto2;
     #1008#15 = "S";
     |GRABA 020#1008a;
     |LIBERA #1008;

     #1017#0 = eaArticulo;
     #1017#5 = #905#7;
     |LEE 101#1017=;
     |SI FSalida ! 0;
         |DDEFECTO #1017;
         #1017#0 = eaArticulo;
         #1017#1 = #905#4;
         #1017#5 = #905#7;
         aAlfa = #910#20; |QBF aAlfa;
         aAlfa = ("          " + aAlfa) % -110; #1017#2 = aAlfa;
         #1017#3 = "     .....";
         |GRABA 020#1017b;
     |FINSI;
     aLineaTit = #1017#2; |QBF aLineaTit;
     aLineaCom = #1017#3; |QBF aLineaCom;
     aAlfa = #905#4; |QBF aAlfa;
     aLineaTit = aLineaTit + " " + (("      " + aAlfa) % -106);
     |SI enSwAnna = 1;
        Calc  = #905#6 - #905#1;
     |SINO;
        Calc  = #905#6;
     |FINSI;
     aLineaCom = aLineaCom + " " + (("      " + Calc) % -106);
     #1017#2 = aLineaTit; #1017#3 = aLineaCom;
     #1017#4 = #1017#4 + Calc;
     #1017#6 = eaNArticulo;
     #1017#7 = enDto1;
     #1017#8 = enDto2;
     #1017#9 = "S";
     |GRABA 020#1017a; |LIBERA #1017;

     #1009#0 = #905#4;
     |LEE 101#1009=;
     |SI FSalida ! 0;
         |DDEFECTO #1009;
         #1009#0 = #905#4;
         |GRABA 020#1009b;
     |FINSI;
     |SI enSwAnna = 1;
          #1009#1 = #1009#1 + (#905#6 - #905#12);
     |SINO;
          #1009#1 = #1009#1 + #905#6;
     |FINSI;

     |GRABA 020#1009a;
     |LIBERA #1009;
|FPRC;

|DEFBUCLE dsm00005;
     #905#1;
     ;
     eaTipo, eaSerie, enCodig, enLinea, "      ";
     eaTipo, eaSerie, enCodig, enLinea, "zzzzzz";
     ;
     NULL, CargaTempo;
|FIN;

|PROCESO CheqTallas;
     |SI enPantalla = 0;
         |HAZ CargaDatosPan;
         enPantalla = 1;
     |FINSI;
     eaHayTallas = "S";
     |ERROR10;
|FPRC;

|DEFBUCLE CheqTallas;
     #905#1;
     ;
     eaTipo, eaSerie, enCodig, 00001, "      ";
     eaTipo, eaSerie, enCodig, 99999, "zzzzzz";
     ;
     NULL, CheqTallas;
|FIN;

|PROCESO TrataCompo;
     |SI aTempo905 ! "";
         |NOME_DAT #905 aTempo905;
     |FINSI;

     |SI nPrime = 0;
          nPrime = 1;
          eaHayTallas = "N";
          |BUCLE CheqTallas;
          |SI eaHayTallas = "N";   || No hay articulos con tallas
               #900#4 = "N";       || no agrupa
               #900#3 = 2;         || ordena por entrada
          |FINSI;
     |FINSI;

     nSwPasa = 0;
     |BUCLE dsm00005;
     |SI nSwPasa ! 0;  |ACABA;  |FINSI;

     |SI #900#3 = 1;     || Ordena por Arti
         ||HAZ Chequear;
         |HAZ ChequearSin; ||***
     |SINO;
         nLineaNueva = enLinea; ||***#905#3;
     |FINSI;

     #1008#0 = eaArticulo;
     #1008#1 = "";
     #1008#6 = nLineaNueva;
     |LEE 101#1008=;
     |SI FSalida ! 0;
         |DDEFECTO #1008;
         #1008#0 = eaArticulo;
         #1008#1 = "";
         #1008#6 = nLineaNueva;
         |GRABA 020#1008b;
     |FINSI;
     #1008#2  = #1008#2 + enUnidades;
     #1008#3  = enPrecio;
     #1008#4  = eaNArticulo;
     #1008#5  = "";
     #1008#7  = eaSerie;
     #1008#8  = enCodig;
     #1008#9  = enLinea;
     #1008#10 = efFEntrega;
     #1008#11 = enNPedido;
     #1008#12 = #1008#12 + enImpo;
     #1008#13 = enDto1;
     #1008#14 = enDto2;
     #1008#15 = "N";
     |GRABA 020#1008a;
     |LIBERA #1008;

     #1017#0 = eaArticulo;
     #1017#5 = enPrecio;      ||***#905#7;
     |LEE 101#1017=;
     |SI FSalida ! 0;
         |DDEFECTO #1017;
         #1017#0 = eaArticulo;
         #1017#1 = "";        ||***#905#4;
         #1017#5 = enPrecio;  ||***#905#7;
/***
         aAlfa = #910#20; |QBF aAlfa;
         aAlfa = ("          " + aAlfa) % -110; #1017#2 = aAlfa;
         #1017#3 = "     .....";
***/
         |GRABA 020#1017b;
     |FINSI;
/****
     aLineaTit = #1017#2; |QBF aLineaTit;
     aLineaCom = #1017#3; |QBF aLineaCom;
     aAlfa = #905#4; |QBF aAlfa;
     aLineaTit = aLineaTit + " " + (("      " + aAlfa) % -106);
     |SI enSwAnna = 1;
        Calc  = #905#6 - #905#1;
     |SINO;
        Calc  = #905#6;
     |FINSI;
     aLineaCom = aLineaCom + " " + (("      " + Calc) % -106);
     #1017#2 = aLineaTit; #1017#3 = aLineaCom;
     #1017#4 = #1017#4 + Calc;
****/
     #1017#4 = #1017#4 + enUnidades;
     #1017#6 = eaNArticulo;
     #1017#7 = enDto1;
     #1017#8 = enDto2;
     #1017#9 = "N";
     |GRABA 020#1017a; |LIBERA #1017;

     #1009#0 = "";
     |LEE 101#1009=;
     |SI FSalida ! 0;
         |DDEFECTO #1009;
         #1009#0 = "";
         |GRABA 020#1009b;
     |FINSI;

     #1009#1 = #1009#1 + enUnidades;
     #1009#2 = 0;
|FPRC;

|PROCESO GrabaOrden;
     |SI nConta > #900#1;
         nConta = 1;
         nOrden = nOrden + 1;
     |FINSI;

     #1009#2 = nOrden;
     #1009#3 = nConta;

     nConta = nConta + 1;

     |GRABA 020#1009a;
     |LIBERA #1009;
|FPRC;

|DEFBUCLE dsw00009o;
     #1009#2;
     ;
     999999999, "      ";
     -99999999, "zzzzzz";
     be;
     NULL, GrabaOrden;
|FIN;

|DEFBUCLE dsw00009a;
     #1009#1;
     ;
     "      ";
     "zzzzzz";
     be;
     NULL, GrabaOrden;
|FIN;

|PROCESO CargaCabe;
     #1009#0 = #1008#1;
     |LEE 040#1009=;
     |SI FSalida ! 0;  |DDEFECTO #1009;  |FINSI;

     |SI #1009#2 ! nPasada;  |ACABA;  |FINSI;

     aAlfa   = #1008#1;  |QBF aAlfa;
     aAlfa   = ("      " + aAlfa) % -106

     nCampo   = 1 + (#1009#3 * 3);  #1010nCampo = aAlfa;
     nCampo   = nCampo + 1;         #1010nCampo = #1008#5;
|FPRC;

|DEFBUCLE dsw00008a;
     #1008#1;
     ;
     000, "                    ", "      ";
     999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzz";
     ;
     NULL, CargaCabe;
|FIN;

|PROCESO Limpia;
     |PARA nCampo = 6;  |SI nCampo [ 63;  |HACIENDO nCampo = nCampo + 3;
           #1010nCampo = 0;
     |SIGUE;
     #1010#64 = 0;
     aColor   = #1010#4;
|FPRC;

|PROCESO &inicia;
     enSwi = 1;
|FPRC;

|PROCESO DesAmpli5;
     enSwi = 0;
     enSwAmpli = 1;
     |PRINT;
     enSwAmpli = 0;
|FPRC;

|DEFBUCLE DesAmpli5;
     #83#1;
     ;
     "P", #1010#65, #1010#66, #1010#67, 001;
     "P", #1010#65, #1010#66, #1010#67, 999;
     ;
     NULL, DesAmpli5;
|FIN;

|PROCESO Print;
     |MODULO aModulo;
     |SI aModulo = "agifa100";|O aModulo = "agifa105";|O aModulo = "agifa016";
               |O aModulo = "agifa014"; |O aModulo = "agifa035";
               |O aModulo = "dsy00012"; |O aModulo = "agifa150";
          |SI aModulo = "agifa100";
               |SI aSer ! #1#25; |O nNum ! #1#0; |O aCod ! #1010#4;
                    enSwi = 1; |PRINT;
               |SINO;
                    enSwi = 0; |PRINT;
               |FINSI;
               aSer = #1#25;
               nNum = #1#0;
               |BUCLE DesAmpli5;
          |FINSI;
          |SI aModulo = "agifa105";
              |SI aSer ! #2#26; |O nNum ! #2#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #2#26;
               nNum = #2#0;
          |FINSI;
          |SI aModulo = "agifa016";
              |SI aSer ! #3#50; |O nNum ! #3#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #3#50;
               nNum = #3#0;
          |FINSI;
          |SI aModulo = "dsy00012";
              |SI aSer ! #138#50; |O nNum ! #138#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #138#50;
               nNum = #138#0;
          |FINSI;
          |SI aModulo = "agifa014";
              |SI aSer ! #4#52; |O nNum ! #4#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #4#52;
               nNum = #4#0;
          |FINSI;
          |SI aModulo = "agifa035";
              |SI aSer ! #36#46; |O nNum ! #36#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #36#46;
               nNum = #36#0;
          |FINSI;
          |SI aModulo = "agifa150";
              |SI aSer ! #146#48; |O nNum ! #146#0; |O aCod ! #1010#4;
                   enSwi = 1; |PRINT;
              |SINO;
                   enSwi = 0; |PRINT;
              |FINSI;
               aSer = #146#48;
               nNum = #146#0;
          |FINSI;
          aCod = #1010#4;
     |SINO;
        |PRINT;
     |FINSI;
|FPRC;

|PROCESO CargaImpre;
     #1009#0 = #1008#1;
     |LEE 040#1009=;
     |SI FSalida ! 0;  |DDEFECTO #1009;  |FINSI;

     |SI #1009#2 ! nPasada;  |ACABA;  |FINSI;

     |SI #1009#2 = 0;
         #1010#0  = #1008#0;
         #1010#1  = #1008#4;
         #1010#2  = #1008#3;
         #1010#3  = #1008#2 * #1008#3;
         #1010#64 = #1008#2;
         #1010#65 = #1008#7;
         #1010#66 = #1008#8;
         #1010#67 = #1008#9;
         #1010#69 = #1008#11;
         #1010#70 = #1008#12;
         #1010#71 = #1008#13; ||%Dto
         #1010#72 = #1008#14; ||%Dto
         #1010#82 = #1008#15;
         enSwImpre = 1;
         |HAZ Print;
         |ACABA;
     |FINSI;

     |SI aArti = "";
         aArti  = #1008#0;
         nLinea = #1008#6;
         nPrecio = #1008#3;
     |FINSI;

     |SI aArti ! #1008#0;  |O nLinea ! #1008#6; |O nPrecio ! #1008#3;
         |SI #1010#64 ! 0;
              enSwImpre = 1;
              |HAZ Print;
              |HAZ Limpia;
         |FINSI;
         aArti  = #1008#0;
         nLinea = #1008#6;
         nPrecio = #1008#3;
     |FINSI;

     aAlfa   = #1008#1;  |QBF aAlfa;
     aAlfa   = ("      " + aAlfa) % -106

     nCampo   = 1 + (#1009#3 * 3);
     nCampo   = nCampo + 1;
     nCampo   = nCampo + 1;         #1010nCampo = #1008#2;
     #1010#0  = #1008#0;
     #1010#1  = #1008#4;
     #1010#2  = #1008#3;
     #1010#64 = #1010#6 + #1010#9  + #1010#12 + #1010#15 + #1010#18 + #1010#21;
     #1010#64 = #1010#64 + #1010#24 + #1010#27 + #1010#30 + #1010#33 + #1010#36;
     #1010#64 = #1010#64 + #1010#39 + #1010#42 + #1010#45 + #1010#48 + #1010#51;
     #1010#64 = #1010#64 + #1010#54 + #1010#57 + #1010#60 + #1010#63;
     #1010#3  = #1010#64 * #1010#2;
     #1010#65 = #1008#7;
     #1010#66 = #1008#8;
     #1010#67 = #1008#9;
     #1010#69 = #1008#11;
     #1010#70 = #1008#12;
     #1010#71 = #1008#13; ||%Dto
     #1010#72 = #1008#14; ||%Dto
     #1010#82 = #1008#15;
|FPRC;

|DEFBUCLE dsw00008b;
     #1008#5;
     ;
/*
  cambiado a clave 5 par ordenar por precio Tiquet: 3218/3355
  y de esa forma poder hacer una nueva linea por cada precio distinto
     000, "                    ", "      ";
     999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzz";
*/
     INICIO;
     FINAL;
     ;
     NULL, CargaImpre;
|FIN;

|PROCESO dsw00008Sin;
     #1010#65 = #1008#7;
     #1010#66 = #1008#8;
     #1010#67 = #1008#9;
     #1010#82 = #1008#15;
     |PRINT;
     |BORRA 020#1008a;
|FPRC;

|DEFBUCLE dsw00008Sin;
     #1008#1;
     15;
     000, "                    ", "      ", "N";
     999, "zzzzzzzzzzzzzzzzzzzz", "zzzzzz", "N";
     ;
     NULL, dsw00008Sin;
|FIN;

|PROCESO dsw00017;
   aAlfa = #1017#2; |QBF aAlfa;
   aAlfa1 = aTitAnt;
   nNume = #1017#5; nNume1 = nPrecAnt;
   aLong = aAlfa  % 0; nLong1 = aLong;
   aLong = aAlfa1 % 0; nLong2 = aLong;
   |SI nLong1 < nLong2;
      Calc = 100 + nLong1;
      aAlfa1 = aAlfa1 % Calc;
   |FINSI;
   |SI aAlfa ! aAlfa1; |O nNume ! nNume1;
      enSwCabElem = 1; aTitAnt = #1017#2; |QBF aTitAnt;
      nPrecAnt = #1017#5;
   |FINSI;
   |SI enSwOtraPag = 1;
      enSwCabElem = 1; enSwOtraPag = 0;
   |FINSI;
   |PRINT; enSwCabElem = 0;
|FPRC;

|DEFBUCLE dsw00017;
     #dsw00017#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,dsw00017;
|FIN;

|PROCESO dsw00017Sin;
     |SI #1017#9 = "N";
          |PRINT;
          |BORRA 020#1017a
     |FINSI;
|FPRC;

|DEFBUCLE dsw00017Sin;
     #dsw00017#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,dsw00017Sin;
|FIN;

|PROCESO ElRemate;
     |HAZ DecimalesBase;

     aCod = "";
     |SI #900#2 = 1;  |BUCLE dsw00009a;  |FINSI;
     |SI #900#2 = 2;  |BUCLE dsw00009o;  |FINSI;

     |SI #900#4 = "S";
        /***/
        |BUCLE dsw00017Sin;
        /***/

        |BUCLE dsw00017;
     |SINO;
        |SI nOrden ! 0;
            /***/
            |BUCLE dsw00008Sin;
            /***/

            |ABRE #1009;
            |PARA nPasada = 0;  |SI nPasada [ nOrden;  |HACIENDO nPasada = nPasada + 1;
               aArti  = "";
               nLinea = 0;
               |DDEFECTO #1010;
               |SI nPasada ! 0;  |BUCLE dsw00008a;  |FINSI;
               |BUCLE dsw00008b;
               |SI aArti ! "";
                   |SI #1010#64 ! 0;
                       enSwImpre = 1;
                       |HAZ Print;
                   |FINSI;
               |FINSI;
            |SIGUE;
            |CIERRA #1009;
        |FINSI;
     |FINSI;

     nOrden  = 0;
     |CIERRA #1008;  |DELINDEX #1008; Tempo = aTempo10; |HAZ BoraTempo;
     |CIERRA #1009;  |DELINDEX #1009; Tempo = aTempo20; |HAZ BoraTempo;
     |CIERRA #1019;  |DELINDEX #1019; Tempo = aTempo30; |HAZ BoraTempo;
     |CIERRA #1017;  |DELINDEX #1017; Tempo = aTempo40; |HAZ BoraTempo;
|FPRC;

|PROCESO Agrupado;
   |SI #900#4 = "S";
      n5Elem = 1; |C_M #900#1,1,"N";
   |SINO;
      n5Elem = 0; |C_M #900#1,1,"S";
   |FINSI;
|FPRC;
