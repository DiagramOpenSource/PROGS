|FICHEROS;
 ortig013 #0;
 ortig010 #1;
 ortig011 #2;
 ortig005 #3;
 ortig017 #4;
 agifa219 #5;
 ortig002 #6;
 agifa220 #7;
 agifa321 #321;
 agifa324 #324;
|FIN;

|VARIABLES;
 &Desc = 0;
 &nDescri = 0;
 &nLongi = 0;
 &nSobra = 0;
 &nAprovecha = 0;
 nLongi1 = 0;
 nDcmts = 0;
 nDcmts1 = 0;
 nDcmts2 = 0;
 aDcmts = "";
 nPrimer = 0;
 &aMaterial = "";
 &nBarra = 0;
 &marca = "";
 &marca2 = "";
 marca1 = "";
 marca21 = "";
 aDivisa = "";
 decim_divisa = 0;
 precio_divisa = 0;
 &decim_base = 0;
 &precio_base = 0;
 &ppto = 0;
 &aTipoi = "";
 &nTipoLi = 0;
 ppt1 = 0;
 ppt2 = 0;
 ppo = 0;
 primer = 0;
 salida = 0;
 &nDeci_Impbase = 0;
 &nDeci_Prebase = 0;
|FIN;

|PROCESO DescAmp;
|PRINT;
|FPRC;

|PROCESO imprime1;
nDescri = 1;
|PRINT;
|ABRE #agifa219;
#agifa219#0 = #ortig011#2;
|LEE 010#agifa219.=;
|SI FSalida = 0;
  nDescri = 0;
  |BUCLELIN 0DescAmp#agifa219;
|FINSI;
|FPRC;


|PROCESO imprime;
|SI ppo ! #1#0;
  |SI primer = 0;
    primer = 1;
  |SINO;
    |PIEINF;
  |FINSI;
  ppo = #1#0;
|FINSI;
|BUCLELIN 0imprime1#1;
|FPRC;

|DEFBUCLE imprimir;
#1#1;
;
ppt1;
ppt2;
e;
NULL,imprime;
|FIN;

|PROCESO presupuesto;
    |IMPRE 0;
    |SI FSalida = 0;
      |INFOR "ortig013";
      |SI FSalida = 0;
        |BUCLE imprimir;
        |PIEINF;
      |FINSI;
      |FININF;
    |FINSI;
    |FINIMP;
|FPRC;

|PROCESO produccion;
|PRINT;
|FPRC;

|DEFBUCLE produccion;
#ortig002#1;
;
#ortig011#2,000;
#ortig011#2,999;
;
NULL,produccion;
|FIN;

|PROCESO agifa220;
|PRINT;
|FPRC;

|DEFBUCLE agifa220;
#agifa220#1;
;
#ortig011#2,000;
#ortig011#2,999;
;
NULL,agifa220;
|FIN;

|PROCESO Hoja;
Desc = 0;
|BUCLE agifa220;
Desc = 1;
|PRINT;
Desc = 2;
|BUCLE produccion;
|PIEINF;
|FPRC;

|DEFBUCLE presu;
#ortig011#1;
;
ppt1,000;
ppt2,999;
e;
NULL,Hoja;
|FIN;

|PROCESO HojaProd;
|IMPRE 0;
|SI FSalida =0;
  |INFOR "ortiy002";
  |SI FSalida = 0;
   |BUCLE presu;
  |FINSI;
  |FININF;
|FINSI;
|FINIMP;
|FPRC;

|PROGRAMA;
  |HAZ decim13;
  |SI ppto = 0;
    |DDEFECTO #0;
    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida =  0;
      ppt1 = #0#0;
      ppt2 = #0#1;
      salida = 0;
      aTipoi = #0#2;
    |SINO;
      salida = 1;
    |FINSI;
  |SINO;
    ppt1 = ppto;
    ppt2 = ppto;
    salida = 0;
  |FINSI;
  |SI salida = 0;
    |SI aTipoi = "P";|O aTipoi = "T";
       |HAZ presupuesto;
    |FINSI;
    |SI aTipoi = "C";|O aTipoi = "T";
       |HAZ corte;
    |FINSI;
    |SI aTipoi = "H";|O aTipoi = "T";
       |HAZ HojaProd;
    |FINSI;
  |FINSI;
|FPRO;

|CALCULO decim13;
  |HAZ DecimalesBase;
  |HAZ LeeDivisas013;
  nDeci_Impbase = decim_base;
  nDeci_Prebase = precio_base;
|FCAL;

|PROCESO LeeDivisas013;
     |ABRE #agifa321;
     |LEE 010#agifa321.p;
     |CIERRA #agifa321;

     |ABRE #agifa324;

     #agifa324#0 = #agifa321#9;
     |LEE 010#agifa324.=;               || Moneda Base
     decim_base = #agifa324#7;
     precio_base = #agifa324#9;

     #agifa324#0 = aDivisa;
     |LEE 020#agifa324.=;               || Divisa
     decim_divisa = #agifa324#7;
     precio_divisa = #agifa324#9;

     |CIERRA #agifa324;
|FPRC

|PROCESO ortig017;
|ABRE #ortig005; ||MATERIAL
#ortig005#0 = #ortig017#0;
|LEE 010#ortig005.=;
|SI FSalida ! 0;|DDEFECTO #ortig005;|FINSI;
|LIBERA #ortig005;
|CIERRA #ortig005;
|SI nPrimer = 0;
  nPrimer = 1;
  aMaterial = #ortig017#0; ||material
  nBarra = #ortig017#1; ||n§ de barra
  nTipoLi = 0;
  |PRINT;
  nTipoLi = 1;
  |PRINT;
|FINSI;
|SI nBarra ! #ortig017#1;|O aMaterial ! #ortig017#0;
  |SI aMaterial ! #ortig017#0;
      |PRINT;
      aMaterial = #ortig017#0;
      nTipoLi = 0;
      |PRINT;
  |FINSI;
  |SI nTipoLi = 0;
    nTipoLi = 1;
  |SINO;
    |PRINT;
  |FINSI;
  marca = "";
  marca2 = "Corte-> ";
  nLongi = 0;
  nBarra = #ortig017#1;
|FINSI;
  nDcmts = #ortig017#3 / 100;
  nDcmts1 = nDcmts / 2;
  nDcmts1 = nDcmts1 ! 0;
  nDcmts2 = nDcmts1 - 1;
  marca1 = "-"*nDcmts2;
  marca1 = marca1 + #ortig017#2; ||n§ de corte
  marca1 = marca1 + ("-"*nDcmts1);
  marca = marca + marca1; ||tantos guiones por dcmt.
  marca = marca + "|";
 || marca21 = " "+#ortig017#2 + ":";
  marca21 = "/-" + #ortig017#3 + "-\,";
  marca21 = marca21 + " ";
  marca2 = marca2 + marca21;
  nLongi = nLongi + #ortig017#3;
  nSobra = (#ortig005#1*1000) - nLongi;
  nAprovecha = nLongi/(#ortig005#1*10)
|FPRC;

|DEFBUCLE ortig017;
#ortig017#1;
;
#1#0,"                    ",0000,0000;
#1#0,"zzzzzzzzzzzzzzzzzzzz",9999,9999;
;
NULL,ortig017;
|FIN;

|CALCULO PrintaCorte;
|IMPRE 0;
|SI FSalida = 0;
   |INFOR "ortiy001";
   |SI FSalida = 0;
      marca = ""
      nLongi = 0;
      marca2 = "Cortes->";
      |BUCLE ortig017;
||  marca2 = marca2 + marca21;
      |PRINT;
      |PIEINF;
   |FINSI;
   |FININF;
|FINSI;
|FINIMP;
|FCAL;

|CALCULO mayus;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FCAL;

|DEFBUCLE corte;
#1#1;
;
ppt1;
ppt2;
e;
NULL,PrintaCorte;
|FIN;

|CALCULO corte;
|BUCLE corte;
|FCAL;
