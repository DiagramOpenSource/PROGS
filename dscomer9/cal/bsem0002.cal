|FICHEROS;
        bsem0002 #1; || vinos001 #1;
        bsem0003 #2; ||vinos002 #2;
        agifa019 #19;
|FIN;

|VARIABLES;
        ttgrados = 0;
        attgrados= "   ";
        aAlfa1   = "";
        nNumero  = 0;
        nModo    = 0;
        aDeOtro  = "N";
        HayNeg   = "N";
        informe  = "vinos001";
|FIN;

|PROCESO CogeNumero; |TIPO 7;
        nModo=(FEntrada / 100) ! 0;
        |SI nModo=1;
                |LEE 000#1u;
                nNumero=#1#0;
        |FINSI;
        |DDEFECTO #1;
        #1#0=nNumero+1;
|FPRC;

|PROCESO CalculoGrado;
        #1#12 = #1#10 * #1#11/100;
        #1#23 = #1#21 * #1#22/100;
        #1#34 = #1#32 * #1#33/100;
        #1#45 = #1#43 * #1#44/100;
        #1#56 = #1#54 * #1#55/100;
        |PINTA #1#12;
        |PINTA #1#23;
        |PINTA #1#34;
        |PINTA #1#45;
        |PINTA #1#56;
        aDeOtro="S";
        |HAZ CalculoCom;
        |HAZ CalculoPor;
        |HAZ CalculoPro;
|FPRC;

|PROCESO CalculoCom;
        #1#14 = #1#12 * #1#13/100;
        #1#25 = #1#23 * #1#24/100;
        #1#36 = #1#34 * #1#35/100;
        #1#47 = #1#45 * #1#46/100;
        #1#58 = #1#56 * #1#57/100;
        |PINTA #1#14;
        |PINTA #1#25;
        |PINTA #1#36;
        |PINTA #1#47;
        |PINTA #1#58;
        aDeOtro="S";
        |HAZ CalculoPor;
        |HAZ CalculoPro;
|FPRC;

|PROCESO CalculoPor;
        #1#16 = #1#12 + #1#14 + #1#15;||ptas litro+ comision +porcentaje
        #1#27 = #1#23 + #1#25 + #1#26;
        #1#38 = #1#34 + #1#36 + #1#37;
        #1#49 = #1#45 + #1#47 + #1#48;
        #1#60 = #1#56 + #1#58 + #1#59;
        |PINTA #1#16;
        |PINTA #1#27;
        |PINTA #1#38;
        |PINTA #1#49;
        |PINTA #1#60;
        aDeOtro="S";
        |HAZ CalculoPro;
|FPRC;

|PROCESO CalculoPro;
|SI Campo ! 11;
        #1#18 = #1#16 * #1#17/100;
        #1#29 = #1#27 * #1#28/100;
        #1#40 = #1#38 * #1#39/100;
        #1#51 = #1#49 * #1#50/100;
        #1#62 = #1#60 * #1#61/100;
        |PINTA #1#18;
        |PINTA #1#29;
        |PINTA #1#40;
        |PINTA #1#51;
        |PINTA #1#62;
        ttgrados= #1#17 + #1#28 + #1#39 + #1#50 + #1#61;
     HayNeg="N";
     |SI #1#28<0;
          HayNeg="S";
     |FINSI;
     |SI #1#39<0;
          HayNeg="S";
     |FINSI;
     |SI #1#50<0;
          HayNeg="S";
     |FINSI;
     |SI #1#61<0;
          HayNeg="S";
     |FINSI;
     ||SI HayNeg="S"; |Y aDeOtro="N";|Y Campo ! 11;|Y Campo ! 13;|Y Campo ! 15;|Y Campo ! 20;|Y Campo ! 31;|Y Campo ! 42;|Y Campo ! 53;
                ||MENAV "2400La suma de los porcentajes no es igual a 100";
          ||ERROR;
        ||FINSI;
        ||SI ttgrados ! 100; |Y aDeOtro="N";|Y Campo ! 11;|Y Campo ! 13;|Y Campo ! 15;|Y Campo ! 20;|Y Campo ! 31;|Y Campo ! 42;|Y Campo ! 53;
                ||MENAV "2400La suma de los porcentajes no es igual a 100";
          ||ERROR;
        ||FINSI;

        #1#2 = (#1#18 + #1#29 + #1#40 + #1#51 + #1#62) *100 + #1#70;
        #1#3 = #1#2 / 100;
        |PINTA #1#2;
        |PINTA #1#3;
        #1#63 = (#1#11 * #1#17 / 100) + (#1#22 * #1#28 / 100) + (#1#33 * #1#39 / 100) + (#1#44 * #1#50 / 100) + (#1#55 * #1#61 / 100);
        |PINTA #1#63;
        aDeOtro="N"
|FINSI;
|FPRC;

|PROCESO P1;
        ||#1#28 = 100 - #1#17;
        ttgrados= #1#17;
        attgrados=ttgrados;
        ||PINTA 1777,"   ";
        ||PINTA 1777,attgrados;
        |PINTA #1#28;
        #1#69 = ttgrados;
        |PINTA #1#69;
        |SI ttgrados > 100;
                        |MENAV "2400La suma de los porcentajes  es mayor a 100";
                        |ERROR;
        |FINSI;
|FPRC;

|PROCESO P2;
        ||#1#39 = 100 - #1#17 - #1#28;
        ttgrados= #1#17 + #1#28;
        attgrados=ttgrados;
        ||PINTA 1777,"   ";
        ||PINTA 1777,attgrados;
        |PINTA #1#39;
        #1#69 = ttgrados;
        |PINTA #1#69;
        |SI ttgrados > 100;
                        |MENAV "2400La suma de los porcentajes  es mayor a 100";
                        |ERROR;
        |FINSI;
|FPRC;

|PROCESO P3;
        ||#1#50 = 100 - #1#17 - #1#28 - #1#39;
        ttgrados= #1#17 + #1#28 + #1#39;
        attgrados=ttgrados;
        ||PINTA 1777,"   ";
        ||PINTA 1777,attgrados;
        |PINTA #1#50;
        #1#69 = ttgrados;
        |PINTA #1#69;
        |SI ttgrados > 100;
                        |MENAV "2400La suma de los porcentajes es mayor a 100";
                        |ERROR;
        |FINSI;
|FPRC;

|PROCESO P4;
        ||#1#61 = 100 - #1#17 - #1#28 - #1#39 - #1#50;
        ttgrados= #1#17 + #1#28 + #1#39 + #1#50;
        attgrados=ttgrados;
        ||PINTA 1777,"   ";
        ||PINTA 1777,attgrados;
        |PINTA #1#61;
        #1#69 = ttgrados;
        |PINTA #1#69;
        |SI ttgrados > 100;
                        |MENAV "2400La suma de los porcentajes  es mayor a 100";
                        |ERROR;
        |FINSI;
|FPRC;

|PROCESO P5;
        ||ttgrados= #1#17 + #1#28 + #1#39 + #1#50 + #1#61;
        attgrados=ttgrados;
        ||PINTA 1777,"   ";
        ||PINTA 1777,attgrados;
        ||SI ttgrados ! 100;
                ||MENAV "2400La suma de los porcentajes  es mayor a 100";
                ||ERROR;
        ||FINSI;
        #1#69 = ttgrados;
        |PINTA #1#69;
        |SI ttgrados > 100;
                        |MENAV "2400La suma de los porcentajes no es igual a 100";
                        |ERROR;
        |FINSI;
|FPRC;

|PROCESO Petecs2;
/*
        aAlfa1 = #1#19;
        |QBT aAlfa1;
        |SI aAlfa1 = "";

                ttgrados= #1#17;
                ||SI ttgrados ! 100;
                        ||MENAV "2400La suma de los porcentajes no es igual a 100";
                        ||ERROR;
                ||FINSI;
                |C_M #1#20,1,"N";
                |C_M #1#21,1,"N";
                |C_M #1#24,1,"N";
                |C_M #1#26,1,"N";
                |C_M #1#28,1,"N";
                |C_M #1#30,1,"N";
                |C_M #1#31,1,"N";
                |C_M #1#41,1,"N";
                |C_M #1#42,1,"N";
                |C_M #1#52,1,"N";
                |C_M #1#53,1,"N";
        |SINO;
                |C_M #1#20,1,"S";
                |C_M #1#21,1,"S";
                |C_M #1#24,1,"S";
                |C_M #1#26,1,"S";
                |C_M #1#28,1,"S";
                |C_M #1#29,1,"S";
                |C_M #1#30,1,"S";
                |C_M #1#31,1,"S";
                |C_M #1#41,1,"S";
                |C_M #1#42,1,"S";
                |C_M #1#52,1,"S";
                |C_M #1#53,1,"S";
        |FINSI;
        |HAZ Petecs3;
        |HAZ Petecs4;
        |HAZ Petecs5;
*/
|FPRC;

|PROCESO Petecs3;
/*
       aAlfa1 = #1#30;
        |QBT aAlfa1;
        |SI aAlfa1 = "";

                ttgrados= #1#17 + #1#28;
                ||SI ttgrados ! 100;
                        ||MENAV "2400La suma de los porcentajes no es igual a 100";
                        ||ERROR;
                ||FINSI;
                |C_M #1#32,1,"N";
                |C_M #1#33,1,"N";
                |C_M #1#35,1,"N";
                |C_M #1#37,1,"N";
                |C_M #1#39,1,"N";
                |C_M #1#41,1,"N";
                |C_M #1#42,1,"N";
                |C_M #1#52,1,"N";
                |C_M #1#53,1,"N";
        |SINO;
                |C_M #1#32,1,"S";
                |C_M #1#33,1,"S";
                |C_M #1#35,1,"S";
                |C_M #1#37,1,"S";
                |C_M #1#39,1,"S";
                |C_M #1#41,1,"S";
                |C_M #1#42,1,"S";
                |C_M #1#52,1,"S";
                |C_M #1#53,1,"S";
        |FINSI;
        |HAZ Petecs4;
        |HAZ Petecs5;
*/
|FPRC;

|PROCESO Petecs4;
/*
        aAlfa1 = #1#41;
        |QBT aAlfa1;
        |SI aAlfa1 = "";

                ttgrados= #1#17 + #1#28 + #1#39;
                ||SI ttgrados ! 100;
                        ||MENAV "2400La suma de los porcentajes no es igual a 100";
                        ||ERROR;
                ||FINSI;
                |C_M #1#43,1,"N";
                |C_M #1#44,1,"N";
                |C_M #1#46,1,"N";
                |C_M #1#48,1,"N";
                |C_M #1#50,1,"N";
                |C_M #1#52,1,"N";
                |C_M #1#53,1,"N";
        |SINO;
                |C_M #1#43,1,"S";
                |C_M #1#44,1,"S";
                |C_M #1#46,1,"S";
                |C_M #1#48,1,"S";
                |C_M #1#50,1,"S";
                |C_M #1#52,1,"S";
                |C_M #1#53,1,"S";
        |FINSI;
        |HAZ Petecs5;
*/
|FPRC;

|PROCESO Petecs5;
/*
        aAlfa1 = #1#52;
        |QBT aAlfa1;
        |SI aAlfa1 = "";

                ttgrados= #1#17 + #1#28 + #1#39 + #1#50;
                ||SI ttgrados ! 100;
                        ||MENAV "2400La suma de los porcentajes no es igual a 100";
                        ||ERROR;
                ||FINSI;
                |C_M #1#54,1,"N";
                |C_M #1#55,1,"N";
                |C_M #1#57,1,"N";
                |C_M #1#59,1,"N";
                |C_M #1#61,1,"N";
        |SINO;
                |C_M #1#54,1,"S";
                |C_M #1#55,1,"S";
                |C_M #1#57,1,"S";
                |C_M #1#59,1,"S";
                |C_M #1#61,1,"S";
        |FINSI;
*/
|FPRC;

|PROCESO ManoObraL;
        #1#5 = #1#4 / 100;
        #1#6 = #1#2 + #1#4;
        #1#7 = #1#3 + #1#5;
        |PINTA #1#5;
        |PINTA #1#6;
        |PINTA #1#7;
||        |PTEC 815;
|FPRC;


|PROCESO Precio1;|TIPO 7;
     |ABRE #19;
     #19#0=#1#8;
     |LEE 000#19=;
     |SI FSalida=0;
          #1#10=#19#133*100/#19#114;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Precio2;|TIPO 7;
     |ABRE #19;
     #19#0=#1#19;
     |LEE 000#19=;
     |SI FSalida=0;
          #1#21=#19#133*100/#19#114;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Precio3;|TIPO 7;
     |ABRE #19;
     #19#0=#1#30;
     |LEE 000#19=;
     |SI FSalida=0;
          #1#32=#19#133*100/#19#114;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Precio4;|TIPO 7;
     |ABRE #19;
     #19#0=#1#41;
     |LEE 000#19=;
     |SI FSalida=0;
          #1#43=#19#133*100/#19#114;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO Precio5;|TIPO 7;
     |ABRE #19;
     #19#0=#1#52;
     |LEE 000#19=;
     |SI FSalida=0;
          #1#54=#19#133*100/#19#114;
     |FINSI;
     |CIERRA #19;
|FPRC;

|PROCESO vinos002;
     |PRINT;
|FPRC;

|DEFBUCLE vinos002;
     #2#1;
     ;
     #1#0,1;
     #1#0,999;
     be;
     NULL,vinos002;
|FIN;

|PROCESO Tipo4;|TIPO 4;
     |CONFI "0000SImprimir informe de escandallos?";
     |SI FSalida=0;
     |IMPRE 0;
     |INFOR informe;
     |BUCLE vinos002;
     |PIEINF;
     |FININF;
     |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Tipo30;|TIPO 30;
     |HAZ ManoObraL;
     |HAZ Tipo4;
|FPRC;


|PROCESO IrLin;
|SI nModo ! "2";
     |SI #1#69 = 100;
          |PTEC 815;
     |FINSI;
|FINSI;
|FPRC;
