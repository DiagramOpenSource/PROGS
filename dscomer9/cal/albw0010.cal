|FICHEROS;
     albm0004 #4;
     albm0010 #10;
     albw0010 #900,MANTE;
     albw0011 #901,MANTE;
     albw0013 #902,MANTE;

     albm0013 #13;
     agifa019 #19;
     agifa104 #104;
     agifa073 #73;
     agifa142 #142;
     dsm00114;
|FIN;

|VARIABLES;
     aAlfa = "";
     nSal = 0;
     aTecla = "";
     nVentanaI = 0;
     nBotonI1 = 0;
     nBotonI2 = 0;
     nBotonI3 = 0;

     &eaDefImpre = "";
     nSwHay           = 0;
     nRango           = 0;
     nLin             = 0;
     nCampo           = 0;

     aDHora           = "";
     aHHora           = "";

     fDFecha          = @;
     fHFecha          = @;

     &Tempo           = "";
     &enSwEntrar      = 0;
     &enDescuento1    = 0;
     &enDescuento2    = 0;
     &eaTComision     = "";
     &enComision      = 0;
     &ser_ped         = "";
     &num_ped         = 0;
     &enDobleClik     = 0;
     &efFechaPre      = @;
     &eaHora          = "";
|FIN;

|INCLUYE i_varart;

|PROCESO albw0011;
     |SI nSwHay = 0;
         nSwHay = 1;
         |ERROR10;
         |ACABA;
     |FINSI;

     #4#0 = #901#0;
     #4#1 = #901#1;
     #4#2 = #900#0;
     |LEE 101#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nLin = nLin + 1;

     |DDEFECTO #19;
     |ABRE #19;
     #19#0 = #4#3;
     |LEE 000#19=;
     |CIERRA #19;

     |DDEFECTO #73;
     #73#28 = #104#25;
     #73#0  = #104#0;
     #73#1  = nLin;
     #73#2  = #4#3;                 || articulo
     #73#3  = #4#4;                 || almacen
     #73#4  = #4#5;                 || descripcion
     #73#5  = #4#6;                 || unidades
     #73#6  = #4#8;                 || precio
     #73#8  = #4#9;                 || Descuento
     #73#13 = #104#2;               || Fecha de Entrega
     #73#14 = #19#30;               || Tipo de IVA
     #73#15 = "N";                  || Bloqueado
     #73#16 = #104#7;               || Representante
     #73#17 = #104#16;              || Tipo Comision
     #73#18 = #19#2;                || Familia
     #73#20 = #104#4;               || Cliente
     #73#23 = #104#5;               || Descuento
     #73#24 = #104#6;               || Descuento
     #73#25 = #104#17;              || Descuento
     #73#26 = #104#9;               || Forma de Pago
     #73#29 = #4#10;                || Descuento
     #73#38 = #4#8;                 || precio-DIV
     #73#42 = #4#6;                 || unidades pedidas
     #73#44 = #4#7;                 || unidades pedidas 2
     #73#48 = #4#7;                 || unidades pedidas 2

     enDescuento1 = #73#8;
     enDescuento2 = #73#29;
     eaTComision  = #73#17;
     eaCliente    = #104#4;
     eaRepre      = #104#7;
     eaArticulo   = #73#2;
     efFecha      = #104#1;
     eaSerie      = #104#28;
     enDirEnt     = #104#57;
     |HAZ Comisiones;

     #73#10 = enComision;

     |GRABA 020#73n;

     enForma = 1;
     |HAZ AcumulaPV;

     |SI #4#15 = "S";
         |BORRA 020#4a;
         |LIBERA #4;
     |FINSI;
|FPRC;

|DEFBUCLE albw0011;
     #901#1;
     8;
     "01.01.0000", "        ", "S";
     "31.12.2999", "zzzzzzzz", "S";
     ;
     NULL, albw0011;
|FIN;

|PROCESO GrabaPedido;
     #104#25 = #902#25;
     #104#0  = #902#0;
     |LEE 101#104=;
     |SI FSalida ! 0;
         |DDEFECTO #104;
         #104#25 = #902#25;
         #104#0  = #902#0;
         |GRABA 020#104b;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
           #104nCampo = #902nCampo;
     |SIGUE;

     |ABRE #10;
     #10#0 = #104#25;
     #10#1 = #104#0;
     |LEE 101#10=;
     |SI FSalida ! 0;
         |DDEFECTO #10;
         #10#0 = #104#25;
         #10#1 = #104#0;
         |GRABA 020#10b;
     |FINSI;

     #10#2 = #902#63;
     #10#3 = #902#64;
     |GRABA 020#10a;
     |LIBERA #10;
     |CIERRA #10;


     nLin = 0;
     |BUCLE albw0011;

     |HAZ CalCabAgifa104;
     |GRABA 020#104a;
     |LIBERA #104;
|FPRC;

|PROCESO albm0004;
     |DDEFECTO #901;
     #901#0  = #4#0;
     #901#1  = #4#1;
     #901#2  = #4#3;
     #901#3  = #4#4;
     #901#4  = #4#5;
     #901#5  = #4#6;
     #901#6  = #4#11;
     #901#7  = #4#13;
     |SI enDobleClik = 1;  #901#8 = "S";  |FINSI;
     |GRABA 020#901n;
     |LIBERA #901;

     nSwHay = 1;
|FPRC;

|DEFBUCLE albm0004;
     #4#1;
     2;
     fDFecha, aDHora, #900#0;
     fHFecha, aHHora, #900#0;
     ;
     NULL, albm0004;
|FIN;

|PROCESO Evento;
     |SI FSalida = 1;
         |LEE 040#901c;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#901=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #901#8 = "N";
             #901#8 = "S";
         |SINO;
             #901#8 = "N";
         |FINSI;
         |GRABA 020#901a;
         |LIBERA #901;

         FSalida = "SKIPDEFAULT";
     |FINSI;

     |PINTA #901#8;
     |PINTA #901#0;
     |PINTA #901#1;
     |PINTA #901#7;
     |PINTA #901#2;
     |PINTA #901#3;
     |PINTA #901#4;
     |PINTA #901#5;
     |PINTA #901#6;
|FPRC;

|PROCESO Tipo12w10;  |TIPO 12;
     |ABRE #13; |LEE 000#13p; |CIERRA #13;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |HAZ CreaTempo;
     |NOME_DAT #901 Tempo; |DELINDEX #901;

     |SI enDobleClik = 0;
         fDFecha = "01.01.0000";
         fHFecha = "31.12.9999";
         aDHora  = "        ";
         aHHora  = "zzzzzzzz";
     |SINO;
         fDFecha = efFechaPre;
         fHFecha = efFechaPre;
         aDHora  = eaHora;
         aHHora  = eaHora;
     |FINSI;

     nSwHay = 0;
     |ABRE #901;
     |BUCLE albm0004;

     |SI nSwHay = 0;
         |MENAV "0000 Cliente sin Prepedidos.";
         |CIERRA #901;
         |DELINDEX #901;
         |HAZ BoraTempo;
         |ACABA;
     |FINSI;

     |SI enDobleClik = 0;
         nRango     = 4 + 8 + 16 + 128;
         |LINEAL_SIMPLE #1#901, nRango, 1102, 2598, NULL, NULL, Evento;
     |FINSI;

     nSwHay = 0;
     |BUCLE albw0011;
     |SI nSwHay = 0;
         |MENAV "0000 Seleccion Vacia.";
         |CIERRA #901;
         |DELINDEX #901;
         |HAZ BoraTempo;
         |ACABA;
     |FINSI;

     enSwEntrar = 0;
     |DDEFECTO #902;
     #902#4  = #900#0;
     #902#8  = #900#1;

     |PINPA #0#902;
     |PINDA #0#902;
     |ENDATOS #1#902;
     |SI FSalida ! 0;
         |MENAV "0000 Proceso Cancelado.";
         |CIERRA #901;
         |DELINDEX #901;
         |HAZ BoraTempo;

         |SI #902#0 ! 0;
             |ABRE #104;
             #104#25 = #902#25;
             #104#0  = #902#0;
             |LEE 101#104=;
             |SI FSalida = 0;
                 |BORRA 020#104a;
                 |LIBERA #104;
             |FINSI;
             |CIERRA #104;
             |HAZ AutoEmpBaja;
         |FINSI;
         |ACABA;
     |FINSI;

     |ABRE #104;
     |ABRE #73;
     |ABRE #4;
     |HAZ GrabaPedido;
     |CIERRA #104;
     |CIERRA #73;
     |CIERRA #4;
     |HAZ AutoEmpAlta;

     |CIERRA #901;
     |DELINDEX #901;
     |HAZ BoraTempo;

     |CONFI "0000NDesea Imprimir el Pedido.";
     |SI FSalida = 0;
          eaDefImpre = #13#7;
          ser_ped = #104#25;
          num_ped = #104#0;
          ||SUB_EJECUTA_NP "agifa105";
          |HAZ MenuImpre;
     |FINSI;
|FPRC;

컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴횵mpresion컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO BotonI1;
     |SUB_EJECUTA_NP "agifa105";
|FPRC;

|PROCESO BotonI2;
     |SUB_EJECUTA_NP "agifa105;FAX";
|FPRC;

|PROCESO BotonI3;
     |SUB_EJECUTA_NP "agifa105;EMAIL";
|FPRC;

|PROCESO MenuImpre;
     |VENTANA 0835, 2065, -1, -1, "";
     nVentanaI = FSalida;

     |CONTROL_SIMPLE 0,"BOTON,{{205}}Imprimir", 0936, 0964,  BotonI1;
     nBotonI1 = FSalida;

     |CONTROL_SIMPLE 0,"BOTON,{{205}}Envio Fax", 1136, 1164,  BotonI2;
     nBotonI2 = FSalida;

     |CONTROL_SIMPLE 0,"BOTON,{{205}}Envio Email", 1336, 1364,  BotonI3;
     nBotonI3 = FSalida;

     |ESTADO_CONTROL nBotonI1, "ENABLE";
     |ESTADO_CONTROL nBotonI2, "ENABLE";
     |ESTADO_CONTROL nBotonI3, "ENABLE";

     |LEETECLA aTecla;

     |FIN_CONTROL_WINDOWS nBotonI1;
     |FIN_CONTROL_WINDOWS nBotonI2;
     |FIN_CONTROL_WINDOWS nBotonI3;

     |SI nVentanaI ! -1;  |FINVENTANA nVentanaI;  |FINSI;

     |PULSATECLA;
|FPRC;
컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
|PROCESO AutoEmpAlta;
     |ABRE #dsm00114; |LEE 000#dsm00114.p; nSal = FSalida; |CIERRA #dsm00114;
     |SI nSal = 0;
          eaCli = #104#4;
          aAlfa = "dsz99983;PEDALTA" + #104#25 + (("000000" + #104#0) % -106);
          |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|PROCESO AutoEmpBaja;
     |ABRE #dsm00114; |LEE 000#dsm00114.p; nSal = FSalida; |CIERRA #dsm00114;
     |SI nSal = 0;
          eaCli = #104#4;
          aAlfa = "dsz99983;PEDBAJA" + #104#25 + (("000000" + #104#0) % -106);
          |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;
