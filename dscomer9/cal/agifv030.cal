|FICHEROS;
     agifv030 #0;
     referen@ #1;
     dsm00120 #120;
     dsm00121 #121;
     dsm00132 #132;
     agifa142 #142;
|FIN;

|VARIABLES;
     nModo = 0;
     aAlfa = "";
     i = 0;
     nConta = 0;
     aClave = "";
|FIN

|PROCESO PideClave;
     |PUSHV 2401 2480;
     |ATRI S;
     |PINTA 2425, " Introduzca Clave:             ";
     |ATRI 0;
     E_sup = 8;
     E_inf = "";
     aAlfa = "";
     aAlfa = 2445 ? -1;
     |SI FSalida ! 0; aAlfa = ""; |FINSI;
     |POPV;
|FPRC;

|PROCESO dsm00121;
     #121#9 = "N";
     |GRABA 020#121a;
     |LIBERA #121;
|FPRC;

|DEFBUCLE dsm00121;
     #121#1;
     ;
     #120#0, "                    ", 00000, "               ";
     #120#1, "zzzzzzzzzzzzzzzzzzzz", 99999, "zzzzzzzzzzzzzzz";
     be;
     NULL, dsm00121;
|FIN;

|PROCESO dsm00120;
     #120#1 = "N";
     #120#5 = #120#5 - 1;
     |GRABA 020#120a;
     |BUCLE dsm00121;
     |LIBERA #120;
|FPRC;

|DEFBUCLE dsm00120;
     #120#1;
     ;
     #0#2;
     #0#2;
     be;
     NULL, dsm00120;
|FIN

|PROCESO Defe132;
     |PARA i = 0; |SI i [ 6; |HACIENDO i = i + 1;
          |C_M #132i, 1, "N";
     |SIGUE;
     |LEE 000#132u;
     nConta = #132#0 + 1;
     |DDEFECTO #132;
     #132#0 = nConta;
     #132#1 = #0#0;
     #132#2 = #0#1;
     #132#3 = #0#2;
     aAlfa = Usuario % 810;
     #132#4 = aAlfa;
     #132#5 = ~;
     |HORA aAlfa;
     #132#6 = aAlfa;
     |GRABA 020#132b;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |DDEF aAlfa;
          aAlfa = aAlfa + "agifv030";
          |CARGA_DEF aAlfa, referen@;
          |SI FSalida = 0;
               |ABRE #referen@;
               #referen@#0 = #0#0;
               #referen@#1 = #0#1;
               #referen@#2 = #0#2 + 1;
               |LEE 000#referen@.];
               |SI FSalida = 0; |Y #referen@#0 = #0#0; |Y #referen@#1 = #0#1;
                    |MENAV "0000Hay registros con fecha posterior...";
                    |ERROR;
               |SINO;
                    |HAZ PideClave;
                    |SI aAlfa = aClave;
                         |PUSHV 0501 2380;
                         |ABRE #132;
                         |HAZ Defe132;
                         |PINPA #0#132;
                         |PINDA #0#132;
                         |ENDATOS #1#132;
                         |SI FSalida = 0;
                              |GRABA 020#132a;
                              |BUCLE dsm00120;
                         |SINO;
                              |BORRA 020#132c;
                              |ERROR;
                         |FINSI;
                         |CIERRA #132;
                         |POPV;
                    |SINO;
                         |MENAV "0000Clave incorrecta...";
                         |ERROR;
                    |FINSI;
               |FINSI;
               |CIERRA #referen@;
               |DESCARGA_DEF #referen@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO min;
     #0#0 = " ";
     #0#1 = 00001;
     #0#2 = "01.01.0000";
|FPRC;

|PROCESO max;
     #0#0 = "z";
     #0#1 = 99999;
     #0#2 = "31.12.9999";
|FPRC;

|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;
     aClave = #142#245;
     |CLS;
     |CABEZA "Control Desgloses";
     |ENTLINEAL #1#0, 2, 1, 19, 1, min, max;
|FPRO;
