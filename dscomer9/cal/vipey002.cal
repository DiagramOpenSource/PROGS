|FICHEROS;
     vipey002 #0;
     vipem006 #6;
     vipem007 #7;
     vipem011 #11;
     vipem020 #20;
     vipem021 #21;
|FIN;

|VARIABLES;
     nSwHay   = 0;
     nActual  = 0;
     nConta   = 0;

     aInforme = "";
     aAlfa    = "";
     aDir     = "";
     aDirDef  = "";

  {101} aPopup  = "";
|FIN;

|PROCESO vipem021;
     |SI #0#8 ] #21#2;  |Y #0#8 [ #21#4;
         #0#11 = #21#1;

         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE vipem021;
     #21#1;
     ;
     #7#0, 01;
     #7#0, 99;
     ;
     NULL, vipem021;
|FIN;

|PROCESO vipem007;
     |SI #0#8 ] #7#16;  |Y #0#8 [ #7#17;
         #0#10 = #7#0;

         |BUCLE vipem021;

         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE vipem007;
     #7#2;
     ;
     #11#0, #11#1, 00000000;
     #11#0, #11#1, 99999999;
     ;
     NULL, vipem007;
|FIN;

|PROCESO vipem020;
     |SI nActual = 1;
          |SI #0#8 ] #20#11;  |Y #0#8 [ #20#12;
              #0#12 = #20#0;

              |ERROR10;
          |FINSI;
     |FINSI;

     |SI nActual = 0;
          |SI #0#8 > #20#12;
              #0#13 = #20#0;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE vipem020;
     #20#2;
     ;
     #11#0, #11#1, 00000000;
     #11#0, #11#1, 99999999;
     ;
     NULL, vipem020;
|FIN;

|PROCESO vipem011;
     #0#10 = 0;
     #0#11 = 0;
     #0#12 = 0;
     #0#13 = 0;

                   |BUCLE vipem007;
     nActual = 1;  |BUCLE vipem020;
     nActual = 0;  |BUCLE vipem020;

     |SI #0#10 ! 0;
         |ABRE #7;
         #7#0 = #0#10;
         |LEE 000#7=;
         |CIERRA #7;
     |SINO;
         |DDEFECTO #7;
         #7#0 = 0;
         #7#16 = "";
         #7#17 = "";
         #7#18 = "";
         #7#23 = "";
         #7#33 = 0;
         #7#34 = "";
     |FINSI;

     |SI #0#11 ! 0;
         |ABRE #21;
         #21#0 = #0#10;
         #21#1 = #0#11;
         |LEE 000#21=;
         |CIERRA #21;
     |SINO;
         #21#0 = 0;
         #21#1 = 0;
         #21#2 = "";
         #21#3 = 0;
         #21#4 = "";
     |FINSI;

     |SI #0#13 ! 0;
         |ABRE #20;
         #20#0 = #0#13;
         |LEE 000#20=;
         |CIERRA #20;

         #0#13  = #20#0;
         #0#14  = #20#3;
         #0#15  = #20#4;
         #0#16  = #20#5;
         #0#17  = #20#6;
         #0#18  = #20#7;
         #0#19  = #20#8;
         #0#20  = #20#9;
         #0#21  = #20#10;
         #0#22  = #20#11;
         #0#23  = #20#12;
         #0#24  = #20#13;
         #0#25  = #20#14;
     |SINO;
         #0#14  = "";
         #0#15  = "";
         #0#16  = "";
         #0#17  = "";
         #0#18  = "";
         #0#19  = 0;
         #0#20  = 0;
         #0#21  = "";
         #0#22  = "";
         #0#23  = "";
         #0#24  = "";
     |FINSI;

     |SI #0#12 ! 0;
         |ABRE #20;
         #20#0 = #0#12;
         |LEE 000#20=;
         |CIERRA #20;
     |SINO;
         |DDEFECTO #20;
         #20#0 = 0;
         #20#11 = "";
         #20#12 = "";
     |FINSI;

     nSwHay = 1;
     |PRINT;
|FPRC;

|DEFBUCLE vipem011;
     #11#1;
     ;
     #6#0, #0#6;
     #6#0, #0#7;
     ;
     NULL, vipem011;
|FIN;

|PROCESO vipem006;
     |BUCLE vipem011;
|FPRC;

|DEFBUCLE vipem006;
     #6#1;
     6, 7;
     #0#0, #0#2, #0#4;
     #0#1, #0#3, #0#5;
     ;
     NULL, vipem006;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aInforme = "vipey002";  |QBF aInforme;
     |INFOR aInforme;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |BUCLE vipem006;

     |SI nSwHay = 1;  |PIEINF;  |FINSI;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Tipo66C9;  |TIPO 66;
     aPopup1  = "-1";  || Si fuera -1 en la posicion

     |DDEF aDirDef;   |QBF aDirDef;

     aDir    = aDirDef + "vipey1*.inf";
     nConta  = 0;
     IaPopup = aPopup3 <-;

     |_PDIR aDir;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          aAlfa  = aDir - aDirDef;
          aPopup = aAlfa;
          nConta = nConta + 1;

          IaPopup = IaPopup + 1;
          |_SDIR aDir;
     |SIGUE;

     aPopup2  = nConta;
     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 208;
         #0#9 = aAlfa;  |PINTA #0#9;
     |FINSI;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3299;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Informe Disponibilidad de Alquileres";

     |DDEFECTO #0;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
