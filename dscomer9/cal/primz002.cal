/*
Cabfac.txt un registro por factura.
Dtofac.txt un registro por factura que tenga descuento pronto pago.
Impfac.txt un registro por factura.
Linfac.txt tantos registros como lineas de albaran incluya la factura.
Dtolfac.txt tantos registros como lineas de albaran tengan descuento.
OBSFAC.TXT observaciones
*/
|FICHEROS;
     primz002 #0;
     prim0001 #2;
     prim0002 #3;
     agifa010 #10;
     agifa019 #19;
     agifa024 #24;
     agifa059 #59;
     agifa071 #71;
     agifa133 #133;
     agifa134 #134;
     agifa324 #324;
|FIN;

|VARIABLES;
     &enTiva = 0;
     &efFiva = @;
     &eaDiva = "";
     &enIva = 0;
     &enRec = 0;
     nPorCenDto = 0;
     aTipoDto = "";
     nNumDto = 0;
     nNeto = 0;
     nBruto = 0;
     aDto1 = "";
     aDto2 = "";
     aDto3 = "";
     nDeci = 0;
     nBase = 0;
     nImp1 = 0;
     nImp2 = 0;
     nImp3 = 0;
     nDto1 = 0;
     nDto2 = 0;
     nDto3 = 0;
     aRuta = "";
     nConta    = 0;
 {20}a         = 0;
 {20}b         = 0;
 {20}c         = 0;
 {20}d         = "";
     aVto      = "";
     nLin      = 0;
     nNume     = 0;
     nHandle   = 0;
     nDec      = 0;
     aFinReg   = "";
     nSw       = 0;
     i         = 0;
     aFic      = "";
     aPath     = "";
     nHanCab   = 0;
     nHanDto   = 0;
     nHanImp   = 0;
     nHanLin   = 0;
     nHanDtol  = 0;
     nHanObs   = 0;
     nAbre1    = 0;
     nAbre2    = 0;
     nAbre3    = 0;
     nAbre4    = 0;
     nAbre5    = 0;
     nAbre6    = 0;
     aTipo     = "";
     nLon      = 0;
     aAlfa     = "";
     nVto      = 0;
     nNu1      = 0;
     nNu2      = 0;
     nPos      = 0;
     nLinObs   = 0;
|FIN;

|PROCESO Relleno;
     |SI aTipo = "A";
          aAlfa = aAlfa + "                                                                            ";
          nPos = nLon + 100;
          aAlfa = aAlfa % nPos;
     |SINO;
          |SI nNume < 0; nNume = nNume * - 1; |FINSI;
          nNu1 = nNume ! 0;
          |SI nNu1 > nNume; nNu1 = nNu1 - 1; |FINSI;
          nNu2 = nNume - nNu1;
          |SI nDec = 0;
               aAlfa = nNu1;
          |SINO;
               aAlfa = nNu2;
               aAlfa = aAlfa + "00000000000000000000000000";
               nPos = nDec + 300;
               aAlfa = aAlfa % nPos;
               aAlfa = nNu1 + "." + aAlfa;
          |FINSI;
          aAlfa = "000000000000000000000000000000000000000000000" + aAlfa;
          nPos = -1 * (nLon + 100);
          aAlfa = aAlfa % nPos;
     |FINSI;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Descuentos;
     nDto1 = #134#4; nDto2 = #134#5; nDto3 = #134#6;
     aDto1 = "TD"; aDto2 = "TD"; aDto3 = "EAB";
     |SI nDto1 = 0;
          nDto1 = nDto2; nDto2 = 0;
          aDto1 = aDto2;
          |SI nDto1 = 0;
               nDto1 = nDto3; nDto3 = 0;
               aDto1 = aDto3;
          |FINSI;
     |FINSI;
     |SI nDto2 = 0;
          nDto2 = nDto3; nDto3 = 0;
          aDto2 = aDto3;
     |FINSI;

     nImp1 = 0; nImp2 = 0; nImp3 = 0;

     |SI nDto1 ! 0; |Y nDto2 ! 0; |Y nDto3 ! 0;
          nImp1 = (#134#18 % nDto1) ! nDeci;
          nBase = #134#18 - nImp1;
          nImp2 = (nBase % nDto2) ! nDeci;
          nBase = nBase - nImp2;
          nImp3 = #134#17 - nImp1 - nImp2;
     |FINSI;
     |SI nDto1 ! 0; |Y nDto2 ! 0; |Y nDto3 = 0;
          nImp1 = (#134#18 % nDto1) ! nDeci;
          nBase = #134#18 - nImp1;
          nImp2 = #134#17 - nImp1;
     |FINSI;
     |SI nDto1 ! 0; |Y nDto2 = 0; |Y nDto3 = 0;
          nImp1 = #134#17;
     |FINSI;
|FPRC;

|PROCESO SumBrutoNetoAlb;
     nBruto = nBruto + #71#7;
     nNeto = nNeto + #71#9;
|FPRC;

|DEFBUCLE SumBrutoNetoAlb;
     #71#1;
     ;
     #59#15, #59#2, 001;
     #59#15, #59#2, 999;
     ;
     NULL, SumBrutoNetoAlb;
|FIN;

|PROCESO SumBrutoNetoFac;
     |BUCLE SumBrutoNetoAlb;
|FPRC;

|PROCESO Vto;
     |DDEFECTO #133;
     #133#4 = #134#49;
     #133#0 = #134#0;
     #133#1 = nVto;
     |LEE 000#133=;
     |SI FSalida = 0; |Y #133#2 ! 0;
          aVto = #133#3;
     |SINO;
          aVto = "                          ";
     |FINSI;
|FPRC;

|PROCESO DtolFac;
     nConta = 0;
     nHandle = nAbre5;

     |SI #71#8 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #134#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
          nNume = nLin;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NUMDTO
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALIF
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUE
          nNume = nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN
          nNume = #71#8;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES
          nNume = #71#5 * #71#36 * #71#8 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #71#33 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #134#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
          nNume = nLin;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NUMDTO
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALIF
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUE
          nNume = nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN
          nNume = #71#33;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES
          nNume = (#71#5 * #71#36 * #71#8)  / 100;
          nNume = ((#71#5 * #71#36) - nNume) * #71#33 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
|FPRC;

|PROCESO Obsfac;
     nHandle = nAbre6;

     nLinObs = nLinObs + 1;

||NUMFAC    X    15
     aAlfa = #134#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;

||NUMOBS    N    5
     nNume = nLinObs;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;

||TEMA X    3
     aAlfa = "AAI";
     aTipo = "A"; nLon = 3; |HAZ Relleno;

||TEXTO1    X    70
     aAlfa = #71#4;
     aTipo = "A"; nLon = 70; |HAZ Relleno;

||TEXTO2    X    70
     aAlfa = "";
     aTipo = "A"; nLon = 70; |HAZ Relleno;

||TEXTO3    X    70
     aAlfa = "";
     aTipo = "A"; nLon = 70; |HAZ Relleno;

||TEXTO4    X    70
     aAlfa = "";
     aTipo = "A"; nLon = 70; |HAZ Relleno;

||TEXTO5    X    70
     aAlfa = "";
     aTipo = "A"; nLon = 70; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;
|FPRC;

|PROCESO LinFac;
     aAlfa = #71#2; |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = ".";
          nLinObs = 0;
          |HAZ Obsfac;
          |ACABA;
     |FINSI;

     nLin = nLin + 1;
     nConta = 0;
     nHandle = nAbre4;

     |DDEFECTO #19;
     #19#0 = #71#2;
     |LEE 000#19=;

     enTiva = #71#11;
     efFiva = #10#1;
     |HAZ SacaIVA;

||NUMFAC:X15
     aAlfa = #134#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMLIN
     nNume = nLin;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||REFEAN
     ||aAlfa = #19#128; |QBF aAlfa;
     aAlfa = #19#110; |QBF aAlfa;
     |SI aAlfa = "";
          aAlfa = "0000Articulo:" + #19#0; |QBF aAlfa;
          aAlfa = aAlfa + " con REFEAN en blanco (alfanumerico1).";
          |MENAV aAlfa;
          aAlfa = "0000Error en factura:" + #134#49 + "/" + (("000000" + #134#0) % -106);
          |MENAV aAlfa;
     |FINSI;

     aTipo = "A"; nLon = 17; |HAZ Relleno;
||REFCLI
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||REFPRO
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||VP
     aAlfa = ""; aTipo = "A"; nLon = 2; |HAZ Relleno;
||DUN14
     aAlfa = ""; aTipo = "A"; nLon = 14; |HAZ Relleno;
||DES
     aAlfa = #71#4;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||CFAC
     nNume = #71#5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CENT
     nNume = 0; aTipo = "N"; nLon = 10; nDec = 0; |HAZ Relleno;
||UMEDIDA
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PRECIOB
     nNume = #71#6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PRECION
     nNume = (#71#6 < #71#8) < #71#33;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||TIPOIMP1
     aAlfa = "VAT";
     |SI #71#11 = 0; aAlfa = "EXT"; |FINSI;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA1
     nNume = enIva;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA1
     nNume = 0;  ||#71#9 * enIva / 100;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP2
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA2
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA2
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA3
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPTASA3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |SI #71#8 ! 0;
          nConta = nConta + 1;
||CALIF1
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume= nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = #71#8;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO1
          nNume = #71#7 * #71#8 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO1
          nNume = 0
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;

     |SI #71#33 ! 0;
          nConta = nConta + 1;
||CALIF2
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
          nNume= nConta;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
          aAlfa = "TD";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
          nNume = #71#33;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO2
          nNume = (#71#7 < #71#8) * #71#33 / 100;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF2
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
          nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO2
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;
||CALIF3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN3
     nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN3
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN4
     nNume= 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN4
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDTO4
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CBONI
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 0; |HAZ Relleno;
||NETO
     nNume = #71#9;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PVERDE
     nNume = 0;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||PEDIDO
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||ALBARAN
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||LOTE
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;

   ||  |SI #71#8 ! 0; |O #71#33 ! 0;
   ||       |HAZ DtolFac;
   ||  |FINSI;
|FPRC;

|PROCESO ImpFac;
     nHandle = nAbre3;
     nConta = 0;
     |SI #134#21 ! 0;
          nConta = nConta  + 1;
||NUMFAC:X15
          aAlfa = #134#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #134#21;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #134#39;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #134#22;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #134#24 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #134#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #134#24;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #134#41;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #134#25;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
     |SI #134#27 ! 0;
          nConta = nConta + 1;
||NUMFAC:X15
          aAlfa = #134#0;
          aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMIMP:N5
          nNume = nConta;
          aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||BASEIMP:N15,3
          nNume = #134#27;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPO:X3
          aAlfa = "VAT";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASA:N8,3
          nNume = #134#43;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPORTE:N15,3
          nNume = #134#28;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

          |XGRABA nHandle, aFinReg;
     |FINSI;
|FPRC;

|PROCESO DtoFac;
     nHandle = nAbre2;

     nNumDto = nNumDto + 1;

||NUMFAC:X15
     aAlfa = #134#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||NUMDTO:N5
     nNume = nNumDto;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||CALDTO:X3
     aAlfa = "A";
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN:N2
     nNume = nNumDto;
     aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO:X3
     aAlfa = aTipoDto;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN:N8,3
     nNume = nPorCenDto;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES:N15,3
     nNume = #134#18 * nPorCenDto / 100;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;
|FPRC;

|PROCESO CabFac;
     nHandle = nAbre1;

||NUMFAC
     aAlfa = #134#0;
     aTipo = "A"; nLon = 15; |HAZ Relleno;
||VENDEDOR: X17
     aAlfa = #2#0;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||EMISOR: X17
     aAlfa = #2#6;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||COBRADOR (*)
     aAlfa = #2#0; aTipo = "A"; nLon = 17; |HAZ Relleno;
||COMPRADOR: X17
     aAlfa = #3#7;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||DEPTO
     aAlfa = ""; aTipo = "A"; nLon = 13; |HAZ Relleno;
||RECEPTOR:X17
     aAlfa = #3#1;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||CLIENTE: X17
     aAlfa = #3#3;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||PAGADOR (*)
     aAlfa = #3#5; aTipo = "A"; nLon = 17; |HAZ Relleno;
||PEDIDO:X17
     aAlfa = #10#56;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||FECHA:X12 'YYYYMMDDhhmm'
     aAlfa = #134#1;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102) + "    ";
     aTipo = "A"; nLon = 12; |HAZ Relleno;
||NODO:X3
     |SI #134#101 < 0; aAlfa = "381"; |SINO; aAlfa = "380"; |FINSI;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||FUNCION
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||RAZON SOCIAL:X70
     aAlfa = #24#1;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||CALLE:X35
     aAlfa = #24#8;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||CIUDAD:X35
     aAlfa = #24#9;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||CP:N5
     nNume = #24#183;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||NIF:X17;
     aAlfa = #24#15;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||RAZON
     |SI #134#101 < 0; aAlfa = "1A"; |SINO; aAlfa = ""; |FINSI;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||ALBARAN:X17
     aAlfa = #59#2;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||CONTRATO
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NFACSUS
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FPAGO
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||DIVISA
     aAlfa = "EUR"; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SUMBRUTO
     nBruto = 0;
     nNeto = 0;
     |BUCLELIN 2 SumBrutoNetoFac #134;
     nNume = nBruto; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||SUMNETOS:N15,3
     nNume = nNeto; ||#134#18 - #134#17;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CARGOS:N15,3
     nNume = 0;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||DESCUEN:N15,3
     nNume = #134#17;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     a1 = 0; a2 = 0; a3 = 0; a4 = 0; a5 = 0; a6 = 0;
     b1 = 0; b2 = 0; b3 = 0; b4 = 0; b5 = 0; b6 = 0;
     c1 = 0; c2 = 0; c3 = 0; c4 = 0; c5 = 0; c6 = 0;
     d1 = "";d2 = "";d3 = "";d4 = "";d5 = "";d6 = "";
     Ia = a1<-; Ib = b1<-; Ic = c1<-; Id = d1<-;
     || IVAS
     |SI #134#22 ! 0;
          a = #134#21; b = #134#22; c = #134#39; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#25 ! 0;
          a = #134#24; b = #134#25; c = #134#41; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#28 ! 0;
          a = #134#27; b = #134#28; c = #134#43; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#34 ! 0;
          a = #134#33; b = #134#34; c = #134#50; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#37 ! 0;
          a = #134#36; b = #134#37; c = #134#52; d = "VAT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     || Exenta
     |SI #134#47 ! 0;
          a = #134#47; b = 0; c = 0; d = "EXT";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     || Recargo
     |SI #134#23 ! 0;
          a = #134#21; b = #134#23; c = #134#40; d = "RE";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#26 ! 0;
          a = #134#24; b = #134#26; c = #134#42; d = "RE";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#54 ! 0;
          a = #134#27; b = #134#54; c = #134#44; d = "RE";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#35 ! 0;
          a = #134#33; b = #134#35; c = #134#51; d = "RE";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;
     |SI #134#38 ! 0;
          a = #134#36; b = #134#38; c = #134#54; d = "RE";
          Ia = Ia + 1; Ib = Ib + 1; Ic = Ic + 1; Id = Id + 1;
     |FINSI;

||BASEIMP1:N15,3
     nNume = a1;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP1:X3
     aAlfa = d1;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP1:N8,3
     nNume = c1;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI1:N15,3
     nNume = b1;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP2:N15,3
     nNume = a2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP2:X3
     aAlfa = d2;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP2:N8,3
     nNume = c2;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI2:N15,3
     nNume = b2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP3:N15,3
     nNume = a3;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP3:X3
     aAlfa = d3;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP3:N8,3
     nNume = c3;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI3:N15,3
     nNume = b3;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP4:N15,3
     nNume = a4;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP4:X3
     aAlfa = d4;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP4:N8,3
     nNume = c4;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI4:N15,3
     nNume = b4;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP5:N15,3
     nNume = a5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP5:X3
     aAlfa = d5;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP5:N8,3
     nNume = c5;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI5:N15,3
     nNume = b5;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||BASEIMP6:N15,3
     nNume = a6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TIPOIMP6:X3
     aAlfa = d6;
     aTipo = "A"; nLon = 3; |HAZ Relleno;
||TASAIMP6:N8,3
     nNume = c6;
     aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPIMI6:N15,3
     nNume = b6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||BASEIMP:N15,3
     nNume = #134#21 + #134#24 + #134#27 + #134#33 + #134#36 + #134#47;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||TOTIMP:N15,3
     nNume = b1+b2+b3+b4+b5+b6;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||TOTAL:N15,3
     nNume = #134#31;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 1; |HAZ Vto;
||VTO1:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO1:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 2; |HAZ Vto;
||VTO2:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO2:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     nVto = 3; |HAZ Vto;
||VTO3:X8 'YYYYMMDD'
     aAlfa = aVto;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102);
     aTipo = "A"; nLon = 8; |HAZ Relleno;
||IMPVTO3:N15,3
     nNume = #133#2;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||TPVERDE:N15,3
     nNume = #134#123;
     aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

     |HAZ Descuentos;

     |SI nDto1 ! 0;
||CALIF1
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume = 1;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = aDto1;
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = nDto1;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES1
          nNume = nImp1;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
||CALIF1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN1
          nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO1
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN1
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES1
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;

     |SI nDto2 ! 0;
||CALIF2
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN2
          nNume = 2;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO2
          aAlfa = aDto2;
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN2
          nNume = nDto2;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES2
          nNume = nImp2;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;

     |SI nDto3 ! 0;
||CALIF3
          aAlfa = "A";
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN3
          nNume = 3;
          aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO3
          aAlfa = aDto3;
          aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN3
          nNume = nDto3;
          aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES3
          nNume = nImp3;
          aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |SINO;
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
          aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
          nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
     |FINSI;

||CALIF4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN4
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO4
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN4
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES4
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||CALIF5
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||SECUEN5
     nNume = 0; aTipo = "N"; nLon = 2; nDec = 0; |HAZ Relleno;
||TIPO5
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||PORCEN5
     nNume = 0; aTipo = "N"; nLon = 8; nDec = 3; |HAZ Relleno;
||IMPDES5
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;

||ERSOCIAL:X70
     aAlfa = #2#1;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||ECALLE:X35
     aAlfa = #2#3;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||EPOBLAC:X35
     aAlfa = #2#4;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||ECP:N5
     nNume = #2#5;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;
||ENIF:X17
     aAlfa = #2#13;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||EMERCA:X70
     aAlfa = #2#15;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||NOTAC
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NUMREL
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||RECOGIDA        17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||DESTINO        17
     aAlfa = #3#9; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FECHAFE        12
     || 'YYYYMMDD'
     aAlfa = #10#1;
     aAlfa = (aAlfa %  -104) + (aAlfa % 402) + (aAlfa % 102) + "0000";
     aTipo = "A"; nLon = 12; |HAZ Relleno;
||NCONFREC       17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIDENTICKET    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||CONTACTO       35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||TELEFONO       35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||FAX            35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||CODPROV        25
     aAlfa = ""; aTipo = "A"; nLon = 25; |HAZ Relleno;
||FECALB         12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||NORMEXEN1      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||NORMEXEN2      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||NORMEXEN3      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||NORMEXEN4      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||NORMEXEN5      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||NORMEXEN6      35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;

|| **** nuevos ***

||FECHADOC  X    8
     aAlfa = ""; aTipo = "A"; nLon = 8; |HAZ Relleno;
||REFPAGO   X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||ORIGEN    X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIFII     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIFPE     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIFIV     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIFPR     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NIFSU     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NUMMOVI   X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NUMINCOR  X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||IMPINCOR  N    15,3
     nNume = 0; aTipo = "N"; nLon = 15; nDec = 3; |HAZ Relleno;
||FENTMER   X    8
     aAlfa = ""; aTipo = "A"; nLon = 8; |HAZ Relleno;
||FEMIMEN   X    8
     aAlfa = ""; aTipo = "A"; nLon = 8; |HAZ Relleno;
||NUMMEN    X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||PERFAC    X    16
     aAlfa = ""; aTipo = "A"; nLon = 16; |HAZ Relleno;
||FPEDIDO   X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||CODAPROB  X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||NUMDEVOL  X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FNUMDEVOL X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||NOTIFDEVOL     X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FNOTIFDEVOL    X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||SEDESOC   X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||BUQUE     X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||FEMBARQUE X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||FORWARDER X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||RRSOCIAL  X    70
     aAlfa = #10#29;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||RCALLE    X    35
     aAlfa = #10#30;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||RCIUDAD   X    35
     aAlfa = #10#31;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||RCP  X    17
     aAlfa = #10#62;
     aTipo = "A"; nLon = 17; |HAZ Relleno;
||AGENENIF  X    3
     aAlfa = ""; aTipo = "A"; nLon = 3; |HAZ Relleno;
||ECAPSOCIAL     X    35
     aAlfa = #2#21; aTipo = "A"; nLon = 35; |HAZ Relleno;
||LUGCARGA  X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||FCARGA    X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||LUGDESCARGA    X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||MATRICULA X    17
     aAlfa = ""; aTipo = "A"; nLon = 17; |HAZ Relleno;
||FENTREGA  X    12
     aAlfa = ""; aTipo = "A"; nLon = 12; |HAZ Relleno;
||NUMVEN    X    35
     aAlfa = ""; aTipo = "A"; nLon = 35; |HAZ Relleno;
||IVRSOCIAL  X    70
     aAlfa = #24#1;
     aTipo = "A"; nLon = 70; |HAZ Relleno;
||IVCALLE   X    35
     aAlfa = #24#8;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||IVCIUDAD  X    35
     aAlfa = #24#9;
     aTipo = "A"; nLon = 35; |HAZ Relleno;
||IVCP N    5
     nNume = #24#211;
     aTipo = "N"; nLon = 5; nDec = 0; |HAZ Relleno;

     |XGRABA nHandle, aFinReg;
|FPRC;

|PROCESO agifa134;
     |DDEFECTO #324;
     #324#0 = #134#58;
     |LEE 000#324=;
     nDeci = #324#7;

     nSw = 1;
     |SI #0#11 ! 0;
          nSw = 0;
          |PARA i = 11; |SI i [ 30; |HACIENDO i = i + 1;
               |SI #0i = #134#2;
                    nSw = 1;
               |FINSI;
          |SIGUE;
     |FINSI;
     |SI #0#31 ! 0; |Y nSw = 1;
          nSw = 0;
          |PARA i = 31; |SI i [ 50; |HACIENDO i = i + 1;
               |SI #0i = #134#0;
                    nSw = 1;
               |FINSI;
          |SIGUE;
     |FINSI;

     #3#0 = #134#2;
     |LEE 000#3=;
     |SI FSalida ! 0; |O nSw = 0;
          |ERROR; |ACABA;
     |FINSI;

     |DDEFECTO #24;
     #24#0 = #134#2;
     |LEE 000#24=;

     #59#14 = #134#49;
     #59#0 = #134#0;
     #59#1 = 0;
     |LEE 020#59];
     |SI FSalida = 0; |Y #59#14 = #134#49; |Y #59#0 = #134#0;
          #10#52 = #59#15;
          #10#0 = #59#2;
          |LEE 020#10=;
          |SI FSalida = 0;
               |HAZ CabFac;
            ||   |SI #134#4 ! 0; aTipoDto = "TD"; nPorCenDto = #134#4; |HAZ DtoFac; |FINSI;
            ||   |SI #134#5 ! 0; aTipoDto = "TD"; nPorCenDto = #134#5; |HAZ DtoFac; |FINSI;
            ||   |SI #134#6 ! 0; aTipoDto = "EAB"; nPorCenDto = #134#6; |HAZ DtoFac; |FINSI;

            ||   |HAZ ImpFac;

               nLin = 0;
               |BUCLELIN 2 LinFac #10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa134;
     #134#1;
     2, 1, 101;
     #0#9,  #0#2, #0#0, #0#4, #0#7;
     #0#10, #0#3, #0#1, #0#5, #0#8;
     ;
     NULL, agifa134;
|FIN;

|PROCESO Browse; |TIPO 0;
     |SI FSalida ! 10; |ACABA; |FINSI;

     aRuta = "D*.*";

     |BROWSE aRuta;

     aRuta = aRuta % 2; |QBF aRuta;
     |SI aRuta = "D"; aRuta = ""; |FINSI;

     |QBF aRuta;
     |SI aRuta = "";
          |ERROR;
     |SINO;
          #0#51 = aRuta;
          |PINTA #0#51;
     |FINSI;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     aFinReg = &13;
     aFinReg = aFinReg + & 10;

     aPath = #0#51; |QBF aPath;
     aAlfa = aPath % -101;
     |SI aAlfa ! "/"; |Y aAlfa ! "\";
          aPath = aPath + "/";
     |FINSI;
     aFic = aPath + "cabfac.txt";
     |XABRE "CWB", aFic, nHanCab;
     nAbre1 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "dtofac.txt";
     |XABRE "CWB", aFic, nHanDto;
     nAbre2 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "impfac.txt";
     |XABRE "CWB", aFic, nHanImp;
     nAbre3 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "linfac.txt";
     |XABRE "CWB", aFic, nHanLin;
     nAbre4 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "dtolfac.txt";
     |XABRE "CWB", aFic, nHanDtol;
     nAbre5 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     aFic = aPath + "obsfac.txt";
     |XABRE "CWB", aFic, nHanObs;
     nAbre6 = FSalida;
     |SI FSalida < 0;
          aAlfa = "0000ERROR " + aFic;
          |MENAV aAlfa;
     |FINSI;

     |SI nAbre1 ] 0; |Y nAbre2 ] 0; |Y nAbre3 ] 0; |Y nAbre4 ] 0; |Y nAbre5 ] 0;
               |Y nAbre6 ] 0;
          |ABRE #2; |LEE 000#2p; |CIERRA #2;
          |ABRE #3;
          |ABRE #10;
          |ABRE #59;
          |ABRE #24;
          |ABRE #19;
          |ABRE #133;
          |ABRE #324;
          |BUCLE agifa134;
          |CIERRA #3;
          |CIERRA #10;
          |CIERRA #59;
          |CIERRA #24;
          |CIERRA #19;
          |CIERRA #133;
          |CIERRA #324;
     |FINSI;

     |XCIERRA nHanCab;
     |XCIERRA nHanDto;
     |XCIERRA nHanImp;
     |XCIERRA nHanLin;
     |XCIERRA nHanDtol;
     |XCIERRA nHanObs;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
     |CLS;
     aAlfa = #0#51;
     |DDEFECTO #0;
     #0#51 = aAlfa;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
|FPRO;
