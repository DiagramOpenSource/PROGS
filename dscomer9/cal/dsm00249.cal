|FICHEROS;
     dsm00249 #0;

     dsm00221 #221;      ||Parametro de Correo
     dsm00220 #220;      ||Control Directorios

     dscom010@ #10;      ||Parametros de Correo (DSCOM)
     dscom007@ #7;       ||Control (DSCOM)
     dscom006@ #6;       ||Libreta Direcciones (DSCOM)

|FIN;

|VARIABLES;
     aMensaje = "";
     aPathBase = "";
     aPathCom = "";
     aPathDef = "";
     aEmpCom = "";
     aCom010 = "";
     aCom007 = "";
     aCom006 = "";
     aPathFic = "";
     aDestino = "";
     aDSCorreo = "";
|FIN;

|PROGRAMA;
     aEmpCom = "01";     ||Empresa Comunicaciones: fijo la 01
     aDestino = "portatil@almacenes-marhuenda.com";    ||fijo a Central Marhuenda
     |DBASS aPathBase;
     |QBF aPathBase;

     aPathCom = aPathBase + "dscom/";
     aPathDef = aPathCom + "def/";
     aCom010 = aPathDef + "dscom010";
     aCom007 = aPathDef + "dscom007";
     aCom006 = aPathDef + "dscom006";
     aPathFic = aPathCom + "fich/" + aEmpCom + "/";

     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |CONFI "    NRealizar Configuracion?";
          |SI FSalida = 0;
               |HAZ Principal;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO Principal;
     |CARGA_DEF aCom010, dscom010@;
     |SI FSalida = 0;
          |CARGA_DEF aCom006, dscom006@;
          |SI FSalida ! 0;
               aMensaje = "0000Problemas al CARGA_DEF " + aCom006;
               |MENAV aMensaje;
               |DESCARGA_DEF #dscom010@;
               |ACABA;
          |FINSI;
          |PATH_DAT #10 aPathFic;
          |PATH_DAT #6 aPathFic;
          |ABRE #dscom010@;
          |ABRE #dscom006@
          |LEE 000#dscom010@.p;
          |SI FSalida = 0;
               |ABRE #dsm00221;
               |DDEFECTO #dsm00221;
               |LEE 101#dsm00221.p;
               |SI FSalida ! 0; |GRABA 020#dsm00221.b; |FINSI;

               ||TODO CCC. Faltara vore com faig la IP.
               ||Si a¤adint 2 camps o recalculant aci la IP
               ||Tambe falta el camp autentificacio


               #dsm00221#5 = #dscom010@#5;

               #dscom006@#0 = #dscom010@#6;
               |LEE 000#dscom006@.=;
               |SI FSalida = 0;
                    #dsm00221#6 = #dscom006@#3;
               |FINSI;

               #dsm00221#7 = aDestino;
               #dsm00221#8 = "Exp. portatil " + #dscom010@#17;
               #dsm00221#9 = "Exp. portatil " + #dscom010@#17;
               #dsm00221#11 = #dscom010@#11;
               #dsm00221#12 = #dscom010@#12;
               #dsm00221#13 = #dscom010@#13;
               #dsm00221#16 = #dscom010@#16;
               #dsm00221#17 = #dscom010@#18;
               #dsm00221#18 = #dscom010@#19;
               #dsm00221#19 = #dscom010@#20;

               |GRABA 020#dsm00221.a;
               |LIBERA #dsm00221;
               |CIERRA #dsm00221;
          |FINSI;
          |CIERRA #dscom006@;
          |CIERRA #dscom010@;
          |DESCARGA_DEF #dscom006@;
          |DESCARGA_DEF #dscom010@;
     |SINO;
          aMensaje = "0000Problemas al CARGA_DEF " + aCom010;
          |MENAV aMensaje;
     |FINSI;

     ||TODO CCC. Direcciones
     |CARGA_DEF aCom007, dscom007@;
     |SI FSalida = 0;
          |PATH_DAT #7 aPathFic;
          |ABRE #dscom007@
          |LEE 000#dscom007@.p;
          |SI FSalida = 0;
               |ABRE #dsm00220;
               |DDEFECTO #dsm00220;
               |LEE 101#dsm00220.p;
               |SI FSalida ! 0; |GRABA 020#dsm00220.b; |FINSI;
               #dsm00220#1 = #dscom007@#1;
               #dsm00220#2 = #dscom007@#1;
               #dsm00220#3 = #dscom007@#10;
               #dsm00220#4 = #dscom007@#11;
               #dsm00220#5 = #dscom007@#13;
               |GRABA 020#dsm00220.a;
               |LIBERA #dsm00220;
               |CIERRA #dsm00220;
          |FINSI;
          |CIERRA #dscom007@;
          |DESCARGA_DEF #dscom007@;
     |SINO;
          aMensaje = "0000Problemas al CARGA_DEF " + aCom010;
          |MENAV aMensaje;
     |FINSI;
|FPRC;


|PROCESO Tipo12;|TIPO 12;

|FPRC;
