|FICHEROS;
     sctrm001 #100;
     sctrm036 #36;
|FIN;

|VARIABLES;
     &eaFicErr = "";
     &eaMensa = "";
     &enError = 0;
     &eaReservas = "";
     &eaXml = "";
     &eaEsXml = "S";

     aMail = "";
     aIP = "";
     aServidor = "";
     aFrom = "";
     aTo = "";
     aSubject = "";
     aMensaje = "";
     aDjunto = "";
|FIN;

|PROCESO Envia;
     |SI aMail ! "";
          aIP = "";
          |SI #100#11 = "L";
               |IP_REMOTO aIP;
          |SINO;
               |SI #100#11 = "S";
                    |IP_LOCAL aIP;
               |SINO;
                    aIP = #100#10; |QBF aIP;
               |FINSI;
          |FINSI;
          aServidor = #100#12; |QBF aServidor;
          aFrom = #100#13; |QBF aFrom;
          aTo = aMail;
          ||aSubject =
          ||aMensaje = "$$$$"
          ||aDjunto =
          |DSCORREO_ENVIA aIP, aServidor, aFrom, aTo, aSubject, aMensaje, aDjunto;
     |FINSI;
|FPRC;

|PROCESO MailSocitransa;
     |SI eaEsXml = "S";
          |SI enError = 2;
               aSubject = "Error wenobo, al crear la reserva.";
          |SINO;
               aSubject = "Errores wenobo, reserva/s: " + eaReservas;
          |FINSI;
     |SINO;
          |SI enError = 2;
               aSubject = "Error goeuro, al crear la reserva.";
          |SINO;
               aSubject = "Errores goeuro, reserva/s: " + eaReservas;
          |FINSI;
     |FINSI;
     aMensaje = "$$$$" + eaFicErr;
     aMail = #100#33; |QBF aMail;
     aDjunto = eaXml;
     |HAZ Envia;
|FPRC;

|PROCESO MailError;
     aSubject = "Recerva no admitida. " + eaMensa;
     aMensaje = aSubject;
     aMail = #36#74; |QBF aMail;
     aDjunto = eaXml;
     |HAZ Envia;
|FPRC;
