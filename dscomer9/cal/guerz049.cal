|FICHEROS;
     guerz049 #0;
     gopartia #1;
     agifa077 #77;
     agifa080 #80;
     agifa065 #65;
     agifa029 #29;
     agifa067 #67;
|FIN;

|VARIABLES;
     &eaDarti = "";
     &eaHarti = "";
     nInfor = -1;
     nImpre = -1;
     nPrime = 0;
     nAlmacen = 0;
|FIN;

|PROCESO ModiPedi;
     #67#28 = #80#29;
     #67#0 = #80#12;
     #67#1 = #80#21;
     |LEE 101#67=;
     |SI FSalida = 0;
          #67#3 = #80#3;
          |GRABA 020#67a;
          |LIBERA #67;
     |FINSI;
|FPRC;

|PROCESO ModiParti;
     #1#17 = #80#3;
     #1#18 = #29#1;
     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE ModiParti;
     #1#1;
     ;
     "M", #80#27,#80#0, #80#1, 001;
     "M", #80#27,#80#0, #80#1, 999;
     be;
     NULL, ModiParti;
|FIN;

|PROCESO ModiHisto;
     #65#0 = #80#2;
     #65#1 = #77#1;
     |SI #77#42 = "N";
          #65#2 = "AC";
     |SINO;
          #65#2 = "BC";
     |FINSI;
     #65#3 = #80#0;
     #65#4 = #80#1;
     #65#11 = #80#27;
     |LEE 101#65=;
     |SI FSalida = 0;
          #65#5 = #80#3; || Almacen
          |GRABA 020#65a;
          |LIBERA #65;
     |FINSI;
|FPRC;

|PROCESO Imprime;
     |SI nPrime ! 0;
          |SI nInfor = 0;
               |PRINT;
          |FINSI;
     |SINO;
          nPrime = 1;
          |SI #0#7 = "S";
               |IMPRE 0;
               nImpre = FSalida;
               |SI FSalida = 0;
                    |INFOR "guerz049";
                    nInfor = FSalida;
                    |SI FSalida ! 0;
                         |MENAV "0000Falta informe 'guerz049'";
                    |SINO;
                         |PRINT;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO agifa080;
     |SI #80#3 = #0#8;
          |ACABA;
     |FINSI;
     |SI #80#3 = #0#9;
          |ACABA;
     |FINSI;
     |SI #80#3 = #0#10;
          |ACABA;
     |FINSI;

     |HAZ Imprime;
     |SI #0#6 = "S";
          #80#3 = nAlmacen;
          |GRABA 020#80a;
          |HAZ ModiHisto;
          |BUCLE ModiParti;
          |HAZ ModiPedi;
          eaDarti = #80#2;
          eaHarti = #80#2;
          |SUB_EJECUTA "agifa068;RECALCULA";
     |FINSI;

     |LIBERA #80;
|FPRC;

|DEFBUCLE agifa077;
     #77#3;
     ;
     "      ", #0#4, #0#0, #0#2;
     "zzzzzz", #0#5, #0#1, #0#3;
     be;
     NULL, NULL, agifa080;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     nAlmacen = 1;

     |ABRE #29;
     #29#0 = nAlmacen;
     |LEE 000#29=;
     |CIERRA #29;

     |ABRE #65;
     |ABRE #67;
     |BUCLE agifa077;
     |CIERRA #67;
     |CIERRA #65;

     |SI nPrime = 0;
          |MENAV "0000No hay registros...";
     |SINO;
          |SI nInfor = 0; |PIEINF; |FININF; |FINSI;
          |SI nImpre = 0; |FINIMP; |FINSI;
     |FINSI;
|FPRC;
