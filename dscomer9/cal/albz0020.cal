|FICHEROS;
     albz0020 #0;

     albm0031 #31;       ||Introd.Mezcladas CAB
     albm0032 #32;       ||Introd.Mezcladas LIN
     albm0043 #43;       ||Partidas.Introd.Mezc

     albm0046 #46;       ||Mantenimiento de partidas
|FIN;

|VARIABLES;
     &enMezclada = 0;
     &enPrecioPar = 0;
     &eaParRecalculo;
     &enAlmRecalculo;
     nDesde = 0;
     nHasta = 0;
     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";

     nImporte = 0;
     nKilos = 0;
     nAlmacen = 0;
     aParametro = "";
|FIN;

|PROGRAMA;
     aParametro = PARAMETRO;
     |QBF aParametro;

     |SI aParametro = "";
          |CLS;
          |ABRE #0;
          |DDEFECTO #0;
          |LEE 101#0p;
          nExiste = FSalida;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0;
               aRespuesta = #albz0020#1;
               #albz0020#1 = "NO";
               |SI nExiste = 0;
                    |GRABA 020#0a;
               |SINO;
                    |GRABA 020#0n;
               |FINSI;
               |SI aRespuesta = "SI";
                    nDesde = 0;
                    nHasta = 999999;
                    |HAZ Principal;
               |FINSI;
          |FINSI;
          |LIBERA #0;
          |CIERRA #0;
     |SINO;
          nDesde = enMezclada;
          nHasta = enMezclada;
          |HAZ Principal;
     |FINSI;
|FPRO;

|PROCESO albm0043;
     |DDEFECTO #albm0046;
     #albm0046#1 = nAlmacen;
     #albm0046#2 = #albm0043#2;
     |LEE 000#albm0046.=;
     |SI FSalida = 0;
          |SI aParametro = "";
               #albm0043#9 = #albm0046#38;
          |SINO;
               |SI #albm0046#1 = enAlmRecalculo; |Y #albm0046#2 = eaParRecalculo;
                    #albm0043#9 = enPrecioPar;
               |SINO;
                    #albm0043#9 = #albm0046#38;
               |FINSI;
          |FINSI;
          #albm0043#10 = #albm0043#9 * #albm0043#4;
          |GRABA 020#albm0043.a;
     |FINSI;
     nImporte = nImporte + #albm0043#10;
     nKilos = nKilos + #albm0043#4;
|FPRC;

|DEFBUCLE albm0043;
 #albm0043#1;
 ;
 #albm0032#0, #albm0032#1, "               ";
 #albm0032#0, #albm0032#1, "zzzzzzzzzzzzzzz";
 be;
 NULL, albm0043;
|FIN;

|PROCESO albm0032;
     nAlmacen = #albm0032#4;
     |BUCLE albm0043;
|FPRC;

|DEFBUCLE albm0032;
 #albm0032#1;
 ;
 #albm0031#0, 01;
 #albm0031#0, 99;
 ;
 NULL, albm0032;
|FIN;

|PROCESO albm0031;
     nImporte = 0;
     nKilos = 0;

     |BUCLE albm0032;
     #albm0031#14 = nKilos;
     #albm0031#21 = nImporte;
     #albm0031#22 = #albm0031#21 / #albm0031#14;
     |GRABA 020#albm0031.a;
     |LIBERA #albm0031;
|FPRC;

|DEFBUCLE albm0031;
 #albm0031#1;
 ;
 nDesde;
 nHasta;
 be;
 NULL, albm0031;
|FIN;

|PROCESO Principal;
     |ABRE #albm0046;
     |BUCLE albm0031;
     |CIERRA #albm0046;
|FPRC;
