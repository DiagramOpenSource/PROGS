|FICHEROS;
     guerw028 #0;
     agifa081 #81;
     agifa067 #67;
|FIN;

|VARIABLES;
     &eaDocu   = "";
     &enForma  = 1;
     &enConta  = 0;
     nErr      = 0;
|FIN;

|PROCESO Conta0; |TIPO 0;
     |SI #0#3 ! 0;
          |ABRE #81;
          #81#25 = #0#2;
          #81#0 = #0#3;
          |LEE 000#81=;
          |SI FSalida = 0;
               |MENAV "0000Pedido existente...";
               |ERROR;
          |FINSI;
          |CIERRA #81;
     |FINSI;
|FPRC;

|PROCESO Conta7; |TIPO 7;
     |SI #0#3 = 0;
          |ABRE #81;
          #81#25 = #0#2;
          |HAZ ContaPC7;
          |CIERRA #81;
          #0#3 = #81#0;
     |FINSI;
|FPRC;

|PROCESO agifa081Fin;
     |SI nErr = 0;
          #81#25 = #0#2;
          #81#0 = #0#3;
          |LEE 101#81=;
          |SI FSalida = 0;
               |HAZ CalCabAgifa081;
          |FINSI;
     |FINSI;
     |ERROR10;
|FPRC;

|PROCESO agifa067;
     #67#28 = #0#2;
     #67#0 = #0#3;
     #67#13 = #0#5;

     #67#5 = #67#37;
     #67#12 = 0;
     #67#38 = 0;

     #67#41 = #67#45;
     #67#44 = 0;
     #67#46 = 0;

     |GRABA 020#67n;
     |SI FSalida = 0;
          enForma = 1;
          eaDocu = "agifa067";
          |HAZ StockEntra;
     |FINSI;
|FPRC;

|PROCESO agifa081;
     |SALVA_FICHA #81;
     #81#25 = #0#2;
     #81#0 = #0#3;
     #81#1 = #0#4;
     #81#2 = #0#5;
     #81#26 = #0#0 + (("000000" + #0#1) % -106);
     |GRABA 020#81n;
     |SI FSalida ! 0;
          nErr = 1;
          |ERROR;
     |FINSI;
     |REPON_FICHA #81;
|FPRC;

|DEFBUCLE agifa081;
     #81#1;
     ;
     #0#0, #0#1;
     #0#0, #0#1;
     ;
     NULL, agifa081, agifa067, agifa081Fin;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |BUCLE agifa081;
|FPRC;
