|FICHEROS;
     porm0003 #0;
     marhup07 #1;
     marhup09 #2;
|FIN;

|VARIABLES;
     nSal = 0;
     nMod = 0;
     aAlfa = "";

     aAlfa1="";
     aAlfa2="";
     NifLetra="";
     x="";
     resto=0;
     lugar=0;
     final="";
     nNume1=0;
     nNume2=0;
     letra="";
     nifnum="";

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO Tipo12s; |TIPO 12;
|FPRC;

|PROCESO calculaletranif; |TIPO 0;
     |SI FSalida = 10;
          eaVarDni  = #0Campo;
          |HAZ CalculoNIFCIF;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     |HAZ CalculoNIFCIF;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|VARIABLES;
||para el digito de control
 {-1}nPesos = 0;
   nPesos1 = 1;
   nPesos2 = 2;
   nPesos3 = 4;
   nPesos4 = 8;
   nPesos5 = 5;
   nPesos6 = 10;
   nPesos7 = 9;
   nPesos8 = 7;
   nPesos9 = 3;
   nPesos10= 6;

   i=0;
   nValor  = 0;
   aAlfa3 = "";
   nNume3 = 0;
   aBuf  = "";
   aDigi1 = "";
   aDigi2 = "";
|FIN;

|PROCESO Calcula;
     nValor = 0;
     |PARA i=1;|SI i[10;|HACIENDO i=i+1;
          nNume2 = (i * 100);
          nNume2 = nNume2 + 1;
          aAlfa3 = nNume2;
          aAlfa2 = aBuf % aAlfa3;
          nNume3 = aAlfa2;
          InPesos = nPesos1<-;                ||Posiciono el array al pri$
          InPesos = InPesos + (i - 1);        ||Avanzo las posiciones nec$
          nValor = nValor + (nNume3 * nPesos);
     |SIGUE;
     nNume1=11 - (nValor $ 11);
     aAlfa1=nNume1;
|FPRC;

|PROCESO Digito1;
     aBuf = #0#17;            || entidad o codigo de banco
     |QBF aBuf;
     aBuf=aBuf+#0#18;         || sucursal
     |QBF aBuf;
     aBuf="00"+aBuf;
     |HAZ Calcula;
     aDigi1=aAlfa1 % 101;
     #0#19 = aDigi1 + aDigi2;
     |PINTA #0#19;            || DC
|FPRC;

|PROCESO Digito2;
     aBuf = #0#20;            || N§ Cuenta
     |QBF aBuf;
     |HAZ Calcula;
     aDigi2 = aAlfa1;
     #0#19 =  aDigi1 + aDigi2;
     |PINTA #0#19;
|FPRC;

|PROCESO obliga; |TIPO 0;
     |SI Campo = 1; |O Campo = 2; |O Campo = 3; |O Campo = 6; |O Campo = 7;
      |O Campo = 8; |O Campo = 13;
          aAlfa = #0Campo;
          |QBF aAlfa;
          |SI aAlfa = "";
               |MENAV "0000Campo Obligatorio....";
               |ERROR;
          |FINSI;
     |FINSI;
     |SI Campo = 4; |O Campo = 5;
          |SI #0Campo = 0;
               |MENAV "0000Campo Obligatorio....";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO marhup07;
     #2#0 = #0#0;
     #2#3 = #1#0;
     |LEE 101#2=;
     nSal = FSalida;
     #2#1 = #0#2;
     #2#2 = 1;
     #2#4 = #1#1;
     |SI nSal = 0; |GRABA 020#2a; |FINSI;
     |SI nSal ! 0; |GRABA 020#2n; |FINSI;
     |LIBERA #2;
|FPRC;

|DEFBUCLE marhup07;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL,marhup07;
|FIN;

|PROCESO tipo2; |TIPO 0;
/*
     nMod = (FEntrada/100) ! 0;
     |SI nMod = 1;
          |ABRE #2;
          |BUCLE marhup07;
          |CIERRA #2;
     |FINSI;
*/
|FPRC;
