|FICHEROS;
     albz0028 #0;

     albm0046 #46;       ||Art./Alm./PartidaCAB
     albm0047 #47;       ||Art./Alm./PartidaLIN
     agifa019 #19;       ||Articulos

     agifa065 #65;       ||Historico
     agifa080 #80;       ||Albaranes Com. Lins.
     agifa077 #77;       ||Albaranes Com. Cabs.
|FIN;

|VARIABLES;
     nAlmacen = "";
     aLinea = "";

     aMovimiento = "";
     aPartida = "";
     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";
     aParDesde = "";

     aArticulo = "";
|FIN;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste = FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          aRespuesta = #albz0028#7;
          #albz0028#7 = "NO";
          |SI nExiste = 0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |SI aRespuesta = "SI";
               |HAZ Principal;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;

|PROCESO Hasta; |TIPO 0;
     aParDesde = #albz0028#4;
     |QBF aParDesde;
     |SI aParDesde ! "";
          #albz0028#5 = #albz0028#4;
          |PINTA #albz0028#5;
     |FINSI;
|FPRC;

|PROCESO agifa065;
     aArticulo = #agifa065#0;
     aPartida = #agifa065#18;
     #agifa019#0 = #agifa065#0;
     |LEE 000#agifa019.=;
     aLinea = #agifa019#125;
     |SI aLinea = #albz0028#6;
          |HAZ PartidaHis;
     |FINSI;
|FPRC;

|DEFBUCLE agifa065;
 #agifa065#4;
 18;
 #albz0028#2, #albz0028#1, "                    ", #albz0028#4;
 #albz0028#3, #albz0028#1, "zzzzzzzzzzzzzzzzzzzz", #albz0028#5;
 be;
 NULL, agifa065;
|FIN;

|PROCESO agifa080;
     #agifa077#50 = #agifa080#27;
     #agifa077#0 = #agifa080#0;
     |LEE 000#agifa077.=;
     |SI FSalida = 0;
          |SI #agifa077#1 ] #albz0028#2; |Y #agifa077#1 [ #albz0028#3;
               aArticulo = #agifa080#2;
               aPartida = #agifa080#37;
               #agifa019#0 = #agifa080#2;
               |LEE 000#agifa019.=;
               aLinea = #agifa019#125;
               |SI aLinea = #albz0028#6;
                    |HAZ PartidaAC;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa080;
 #agifa080#1;
 3, 37;
 "     ", 000000,   1, #albz0028#1, #albz0028#4;
 "zzzzz", 999999, 999, #albz0028#1, #albz0028#5;
 be;
 NULL, agifa080;
|FIN;

|PROCESO Principal;
     |ABRE #agifa077;
     |ABRE #albm0046;
     nAlmacen = #albz0028#1;
     |ABRE #agifa019;
     |BUCLE agifa065;
     |BUCLE agifa080;
     |CIERRA #agifa019;
     |CIERRA #albm0046;
     |CIERRA #agifa077;
|FPRC;

|PROCESO PartidaAC;
     #albm0046#1 = nAlmacen;
     #albm0046#2 = aPartida;
     |LEE 000#albm0046.=;
     |SI FSalida ! 0;
          |HAZ BorraPartidaAC;
     |SINO;
          |SI aArticulo ! #albm0046#0;
               |HAZ BorraPartidaAC;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PartidaHis;
     #albm0046#1 = nAlmacen;
     #albm0046#2 = aPartida;
     |LEE 000#albm0046.=;
     |SI FSalida ! 0;
          |HAZ BorraPartidaHis;
     |SINO;
          |SI aArticulo ! #albm0046#0;
               |HAZ BorraPartidaHis;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BorraPartidaHis;
     #agifa065#18 = "";
     |GRABA 020#agifa065.a;
     |LIBERA #agifa065;
|FPRC;

|PROCESO BorraPartidaAC;
     #agifa080#37 = "";
     |GRABA 020#agifa080.a;
     |LIBERA #agifa080;
|FPRC;
