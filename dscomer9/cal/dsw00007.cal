*******  EL PROGRAMA RECIBE COMO PARAMETRO EL CLIENTE ***********
                                              -------

|FICHEROS;
     dsw00007 #0;
     dsm00017 #1;
     agifa065 #2;
     agifa019 #3;
     agifa024 #4;
|FIN;

|VARIABLES;
     &Tempo    = "";
     aParam    = "";
     aArti     = "";
     aCli      = "";
     aFic      = "";
     nLin      = 0;
     nAcu      = 0;
     aTempo0   = "";
|FIN;

|PROCESO agifa065;
     |SI #2#10 ! aCli; |ACABA; |FINSI;

     nAcu = nAcu + #2#6;

     nLin = nLin + 1;
     #0#0 = nLin;
     #0#1 = #3#0;
     #0#2 = #3#1;
     #0#3 = #4#0;
     #0#4 = #4#1;
     #0#5 = #2#1;        || Fec
     #0#6 = #2#2;        || Ope
     #0#7 = #2#11;       || Se
     #0#8 = #2#3;        || Doc
     #0#9 = #2#6;        || Cant
     #0#10 = nAcu;       || Acumu
     |GRABA 021#0n;
|FPRC;

|DEFBUCLE agifa065;
     #2#1;
     ;
     aArti, "01.01.0000", "  " ,       0 ,     0 , "     ";
     aArti, "31.12.9999", "zz" ,  999999 , 99999 , "zzzzz";
     ;
     NULL, agifa065;
|FIN;

|PROCESO Inf0;
     #0#0 = 1;
     #0#5 = "01.01.0000";
|FPRC;

|PROCESO Sup0;
     #0#0 = 99999999;
     #0#5 = "31.12.9999";
|FPRC;

|PROCESO Inf1;
     #1#1 = "                    ";
|FPRC;

|PROCESO Sup1;
     #1#1 = "zzzzzzzzzzzzzzzzzzzz";
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     aCli  = aParam; |QBF aCli;
     |ABRE #1;
     |LEE 000#1p;
     |SI FSalida = 0;
          aArti = #1#1;
          |LEE 000#1s;
          |SI FSalida = 0;      || Hay mas de uno
               |MENSA "0000Pulsar [ESC] para elegir el articulo...";
               |ENTLINEAL #2#1, 1, 4, 21, 1, Inf1, Sup1;
               aArti = #1#1;
          |FINSI;

          |ABRE #3;
          #3#0 = aArti;
          |LEE 000#3=;
          |CIERRA #3;

          |ABRE #4;
          #4#0 = aCli;
          |LEE 000#4=;
          |CIERRA #4;
          aCli = #4#0;   || Para que lo formatee como el campo

          |HAZ CreaTempo; aTempo0 = Tempo;
          |NOME_DAT #0 aTempo0; |DELINDEX #0;

          |ABRE #0;
          |BUCLE agifa065;
          |CIERRA #0;

          |SI nLin ! 0;
               |ENTLINEAL #2#0, 2, 4, 21, 1, Inf0, Sup0;
          |SINO;
               |MENAV "0000No hay registros...";
          |FINSI;

          |DELINDEX #0; Tempo = aTempo0; |HAZ BoraTempo;
     |FINSI;
     |CIERRA #1;
|FPRO;
