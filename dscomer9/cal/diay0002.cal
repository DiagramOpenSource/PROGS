|FICHEROS;
     diay0002 #0;
     diam0003 #3;
     diam0005 #5;
     agifa104 #104;
     dstelm02@;
|FIN;

|VARIABLES;
     &enLin    = 0;
     nHay      = 0;
     nEstado   = 0;
     &enHoras  = 0;
     nPedido   = 0;
     aSerie    = "";
     nTecnico  = 0;
     aAlfa     = "";
     aBase     = "";
|FIN;

|PROCESO HorasRealizadasPedido;
     enHoras = enHoras + #dstelm02@#39;
|FPRC;

|DEFBUCLE HorasRealizadasPedido;
     #dstelm02@#5003;
     ;
     nPedido, " ", aSerie;
     nPedido, "z", aSerie;
     ;
     NULL, HorasRealizadasPedido;
|FIN;

|PROCESO diam0005;
     enLin = 3;
     |PRINT;
|FPRC;

|DEFBUCLE diam0005;
     #5#1;
     ;
     #3#0, #3#1, #3#2, 0001;
     #3#0, #3#1, #3#2, 9999;
     ;
     NULL, diam0005;
|FIN;

|PROCESO diam0003;
     |SI enLin = 0;
          enLin = 1;
          |PRINT;
     |FINSI;
     enLin = 2;
     |PRINT;
     |BUCLE diam0005;
|FPRC;

|DEFBUCLE diam0003;
     #3#1;
     ;
     #104#25, #104#0, 0001;
     #104#25, #104#0, 9999;
     ;
     NULL, diam0003;
|FIN;

|PROCESO diam0003Mira;
     |SI #0#10 = "C";         ||Todos Cerrados
          |SI #3#6 = "C";
               nEstado = 1;
          |SINO;
               nEstado = 0;
               |ERROR10;
          |FINSI;
     |FINSI;

     |SI #0#10 = "A";         ||Alguno Abierto
          |SI #3#6 = "A";
               nEstado = 1;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE diam0003Mira;
     #3#1;
     ;
     #104#25, #104#0, 0001;
     #104#25, #104#0, 9999;
     ;
     NULL, diam0003Mira;
|FIN;

|PROCESO agifa104;
     nEstado = 0;
     |SI #0#10 ! "T";
          |BUCLE diam0003Mira;
     |SINO;
          nEstado = 1;
     |FINSI;
     |SI nEstado = 0; |ACABA; |FINSI;

     aSerie = #104#25;
     nPedido = #104#0;
     enHoras = 0;
     |BUCLE HorasRealizadasPedido;

     nHay = 1;
     enLin = 0;
     |PRINT;
     |BUCLE diam0003;
     |SI enLin ! 0;
          enLin = 4;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE agifa104;
     #104#1;
     7, 4, 1;
     #0#0, #0#2, #0#4, #0#6, #0#8;
     #0#1, #0#3, #0#5, #0#7, #0#9;
     ;
     NULL, agifa104;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "diay0002";
          |SI FSalida = 0;
               |DBASS aBase; |QBF aBase;
               aAlfa = aBase + "dspartes/def/dstelm02";
               |CARGA_DEF aAlfa, dstelm02@;
               |SI FSalida = 0;
                    |BUCLE agifa104;
                    |DESCARGA_DEF #dstelm02@;
               |FINSI;
               |SI nHay ! 0; |PIEINF; |FINSI;
               |FININF;
          |SINO;
               |MENAV "0000Falta informe diay0002";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
