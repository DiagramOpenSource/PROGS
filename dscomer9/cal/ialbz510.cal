     Todos

|FICHEROS;
     ialbz010 #0;
     ialbm017 #17;
     ialbm018 #18;

     refere1@;
     refere2@;
     refere3@;
|FIN;

|VARIABLES;
     &enPestana = 0;
     &eaCliDoc = "";
     &enPosiciona = 0;
     &enModo = 0;
     &enError = 0;
     &eaMatricula = "";
     &eaSerAviso = "";
     &enNumAviso = 0;
     v0 = "000000";
     v1 = "   ";
     v2 = 0;
     aPath = "";
     nPanta = 0;
     aAlfa = "";
     nRango = 0;
     nPos1 = 0;
     nPos2 = 0;

     nBtnSalir5 = 0;
     nBtnVer5 = 0;
     nEvtFoco = 0;
     nGrid1 = 0;
     nGrid2 = 0;
     nGrid3 = 0;
|FIN;

|PROCESO EventoFoco5;
     enPestana = 5;
|FPRC;

|PROCESO BtnVer5;
     |LEE 000#refere1@.=;
     |SI FSalida ! 0; |ACABA; |FINSI;

     enPosiciona = 1;
     |SI #refere1@#24 = "P";
          |HAZ Refresca1;
     |FINSI;
     |SI #refere1@#24 = "T";
          |HAZ Refresca2;
     |FINSI;
     |SI #refere1@#24 = "C";
          |HAZ Refresca3;
     |FINSI;
     |SI #refere1@#24 = "V";
          |HAZ Refresca4;
     |FINSI;
     enPosiciona = 0;
|FPRC;

|PROCESO Evento51;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#refere1@.=;
          |SI FSalida = 0;
               eaCliDoc = #refere1@#5;
               #0#6 = #refere1@#7;
               #0#7 = #refere1@#8;
               #0#8 = #refere1@#9;
          |SINO;
               #0#6 = "";
               #0#7 = "";
               #0#8 = "";
          |FINSI;
          |PINPA #5#0;
          |PINTA 1609, #0#6;
          |PINTA 1709, #0#7;
          |PINTA 1809, #0#8;
          #refere2@#1 = 0; |REFRESCACONTROL nGrid3;
          |REFRESCACONTROL nGrid2;
     |FINSI;
|FPRC;

|PROCESO Evento52;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#refere2@.=;
          |REFRESCACONTROL nGrid3;
     |FINSI;
|FPRC;

|PROCESO Evento53;
     |SI FSalida = 1; |O FSalida = 2;
          |LEE 000#refere3@.=;
     |FINSI;
|FPRC;

|PROCESO Min51;
     #refere1@#0 = "     ";
     #refere1@#1 = 000000;
     #refere1@#5 = #0#0;
     #refere1@#18 = #0#1;
     #refere1@#19 = #0#2;
     |SI #0#0 = "000000"; #refere1@#5# = "      "; |FINSI;
     |SI #0#1 = "000"; #refere1@#18# = "   "; |FINSI;
|FPRC;

|PROCESO Max51;
     #refere1@#0 = "zzzzz";
     #refere1@#1 = 999999;
     #refere1@#5 = #0#0;
     #refere1@#18 = #0#1;
     #refere1@#19 = #0#2;
     |SI #0#0 = "000000"; #refere1@#5# = "zzzzzz"; |FINSI;
     |SI #0#1 = "   "; #refere1@#18# = "zzz"; |FINSI;
     |SI #0#1 = "000"; #refere1@#18# = "zzz"; |FINSI;
     |SI #0#2 = 0; #refere1@#19# = 99999; |FINSI;
|FPRC;

|PROCESO Min52;
     #refere2@#0 = #refere1@#0;
     #refere2@#1 = #refere1@#1;
     #refere2@#2 = 1;
|FPRC;

|PROCESO Max52;
     #refere2@#0 = #refere1@#0;
     #refere2@#1 = #refere1@#1;
     #refere2@#2 = 999;
|FPRC;

|PROCESO Min53;
     #refere3@#0 = #refere2@#0;
     #refere3@#1 = #refere2@#1;
     #refere3@#2 = #refere2@#2;
     #refere3@#3 = 1;
|FPRC;

|PROCESO Max53;
     #refere3@#0 = #refere2@#0;
     #refere3@#1 = #refere2@#1;
     #refere3@#2 = #refere2@#2;
     #refere3@#3 = 999;
|FPRC;

|PROCESO Actualiza5;
     |DESTRUYECONTROL nGrid1;

     |PINPA #5#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1598;

     |SI #0#0 ! v0;
          |SI #0#1 ! v1;
               |LINEAL_SIMPLE #2#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
          |SINO;
               |LINEAL_SIMPLE #3#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
          |FINSI;
     |SINO;
          |SI #0#1 ! v1;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #4#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
               |SINO;
                    |LINEAL_SIMPLE #5#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
               |FINSI;
          |SINO;
               |SI #0#0 ! v0;
                    |LINEAL_SIMPLE #6#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
               |SINO;
                    |LINEAL_SIMPLE #7#refere1@, nRango, nPos1, nPos2, Min51, Max51, Evento51;
               |FINSI;
          |FINSI;
     |FINSI;
     nGrid1 = FSalida;
     #refere2@#1 = 0; |REFRESCACONTROL nGrid3;
     #refere1@#1 = 0; |REFRESCACONTROL nGrid2;
     |REFRESCACONTROL nGrid1;
|FPRC;

|PROCESO PintaPan5;
     |DDEF aPath;
     aAlfa = aPath + "ialbm017"; |CARGA_DEF aAlfa, refere1@;
     aAlfa = aPath + "ialbm018"; |CARGA_DEF aAlfa, refere2@;
     aAlfa = aPath + "ialbm019"; |CARGA_DEF aAlfa, refere3@;
     |ABRET #refere1@;
     |ABRET #refere2@;
     |ABRET #refere3@;

     |PINPA #5#0; nPanta = FSalida;
     nRango = 4 + 8 + 16 + 32;
     nPos1 = 2802;
     nPos2 = 3398;
     |LINEAL_SIMPLE #1#refere3@, nRango, nPos1, nPos2, Min53, Max53, Evento53;
     nGrid3 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 1902;
     nPos2 = 2798;
     |LINEAL_SIMPLE #1#refere2@, nRango, nPos1, nPos2, Min52, Max52, Evento52;
     nGrid2 = FSalida;

     nRango = 4 + 8 + 16 + 32;
     nPos1 = 0602;
     nPos2 = 1598;
     |LINEAL_SIMPLE #1#refere1@, nRango, nPos1, nPos2, Max51, Min51, Evento51;
     nGrid1 = FSalida;

     |CONTROL_SIMPLE nPanta, "EVENTOPAN", 0000, 0000, EventoFoco5;
     nEvtFoco = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,Ver Aviso", 0501, 0513, BtnVer5;
     nBtnVer5 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{207}} Salir", 3488, 3498, BtnSalir;
     nBtnSalir5 = FSalida;

     |PINTA 1609, #0#6;
     |PINTA 1709, #0#7;
     |PINTA 1809, #0#8;
|FPRC;

|PROCESO DestruyePan5;
/*
     |DESTRUYECONTROL nGrid1;
     |DESTRUYECONTROL nGrid2;
     |DESTRUYECONTROL nGrid3;

     |FIN_CONTROL_WINDOWS nEvtFoco;
     |FIN_CONTROL_WINDOWS nBtnVer5;
     |FIN_CONTROL_WINDOWS nBtnSalir5;
*/

     |CIERRAT #refere3@;
     |CIERRAT #refere2@;
     |CIERRAT #refere1@;
     |DESCARGA_DEF #refere3@;
     |DESCARGA_DEF #refere2@;
     |DESCARGA_DEF #refere1@;
|FPRC;
