|FICHEROS;
     gotrabaj #0;
     gotrabal #1;
     gonomica #2;
     gonomili #3;
     gotrabat #4,MANTE;
     gocatcon #5;
     gotracur #6;
     gocatcot #20,MANTE;
|FIN;

|VARIABLES;
     i = 0;
     aAlfa = "";
     nModo =   0;
     nConta =  0;
     fFecha = @;

     {-1}menu       = "";
     menu1          = "2400";
     menu2          = "1";
     menu3          = "Contador:  ";
     menu4          = "AM";
     menu5          = " Automatico ";
     menu6          = " Manual ";

     {-1}aUtil       = "";
     aUtil1          = "2400";
     aUtil2          = "1";
     aUtil3          = "Opciones:  ";
     aUtil4          = "IH";
     aUtil5          = " Imprimir ";
     aUtil6          = " Tipos Hora ";
     aAlfa1 = "";
     aAlfa2 = "";
     nNume = 0;
     nNume1 = 0;
     nNume2 = 0;
     nEdad = 0;

     aNifQbf1   = "";
     aNifQbf2   = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO letranif2;
     |SI FSalida = 10;
         eaVarDni   = #0Campo;
         enCalcCif  = 1;
         |HAZ CalculoNIFCIF;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoNIFCIF;
     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

-----------------------------------------------------------------------------
|PROCESO SuelPact; |TIPO 7;
     |SI FSalida = 13;
          |ATRI I;
          |PINTA 2224, "SUELDO PACTADO:";
          |ATRI 0;
          |C_M #0#23, 1, "S";
          |C_V #0#23, 1, "S";
     |SINO;
          |C_M #0#23, 1, "N";
          |C_V #0#23, 1, "N";
          |PINPA #0#0;
          |PINDA #0#0;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO BorSue; |TIPO 0;
     |C_M #0#23, 1, "N";
     |C_V #0#23, 1, "N";
     |PINPA #0#0;
     |PINDA #0#0;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ImpTrabaja;
     |PRINT;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ImpTrab;
     |SUB_EJECUTA_NP "goinform;IMPgotraba1";
     |INFOR "gotraba1";
     |PRINT;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgotraba1";
     |SUB_EJECUTA_NP "goinform;IMPgotraba2";
     |INFOR "gotraba2";
     |PRINT;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgotraba2";
     |SUB_EJECUTA_NP "goinform;IMPgotraba3";
     |INFOR "gotraba3";
     |BUCLELIN 2 ImpTrabaja #0;
     |PIEINF;
     |FININF;
     |SUB_EJECUTA_NP "goinform;ENVgotraba3";
     |SUB_EJECUTA_NP "goinform;RUNfichtrab";
|FPRC;
-----------------------------------------------------------------------------
|PROCESO ContFech; |TIPO 0;
     |SI #1#3 < #1#2;
          |MENAV "0000LA FECHA DE FINALIZACION DE CONTRATO, NO PUEDE SER INFERIOR";
          |ERROR10;
          |ACABA;
     |FINSI;
|FPRC;
-----------------------------------------------------------------------------
|PROCESO CalcEdad; |TIPO 0;
     aAlfa1 = #0#11; aAlfa1 = aAlfa1 % -104; nNume1 = aAlfa1; || Anyo Nacimiento
     fFecha = ~; aAlfa2 = fFecha; aAlfa2 = aAlfa2 % -104; nNume2 = aAlfa2; || Anyo Actual
     nEdad = nNume2 - nNume1;
     aAlfa1 = #0#11; aAlfa1 = aAlfa1 % 402; nNume1 = aAlfa1; || Mes Nacimiento
     fFecha = ~; aAlfa2 = fFecha; aAlfa2 = aAlfa2 % 402; nNume2 = aAlfa2; || Mes Actual
     nNume = nNume2 - nNume1;
     |SI nNume2 < nNume1;
          nEdad = nEdad - 1;
     |FINSI;
     #0#26 = nEdad;                        || edad
     |PINTA #0#26;
|FPRC;

-----------------------------------------------------------------------------
|PROCESO ContTrab; |TIPO 7;

     nModo = (FEntrada/100)!0;

     |SI nModo ! 1;
          |ACABA;
     |FINSI;

     |MENU menu;

     |SI FSalida = 1;    ||Automatico
          |LEE 000#0u;

          |SI FSalida ! 0;
               nConta = 1;
          |SINO;
               nConta = #0#0;
               nConta = nConta + 1;
          |FINSI;

          |DDEFECTO #0;
          #0#0 = nConta;
          |PTEC 802;
          |PINTA #0#0;
     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
|PROCESO BorTipHor;
     |BORRA 020#4a;
|FPRC;

|DEFBUCLE BorTipHor;
     #4#1;
     ;
     #0#0, 01;
     #0#0, 99;
     be;
     NULL, BorTipHor;
|FIN;

|PROCESO BorCurso;
     |BORRA 020#6a;
|FPRC;

|DEFBUCLE BorCurso;
     #6#1;
     ;
     #0#0, 01;
     #0#0, 99;
     be;
     NULL, BorCurso;
|FIN;

|PROCESO BajaTrab; |TIPO 2;
     nModo = (FEntrada/100)!0;
     |SI nModo = 3;
          |ABRE #2;
          #2#0 = #0#0;
          |LEE 000#2=;
          |SI FSalida = 0;
               |CONFI "0000N¿DESEA ELIMINAR LAS NOMINAS DEL TRABAJADOR?";
               |SI FSalida = 0;
                    |BUCLELIN 1 NULL #2;
                    |BORRA 020#2a;
               |SINO;
                    |ERROR; |ACABA;
               |FINSI;
          |FINSI;
          |CIERRA #2;
          |BUCLE BorTipHor;
          |BUCLE BorCurso;
     |FINSI;
|FPRC;

|PROCESO TipoHoras; |TIPO 20;
     aAlfa = FSalida;
     |SI aAlfa = "OPCION";
         FSalida = "Opciones";
         |ACABA;
     |FINSI;
     |MENU aUtil;
     aUtil2 = FSalida;
     |SI FSalida = 1;
          |HAZ ImpTrab;
     |FINSI;
     |SI FSalida = 2;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#4 , 2, 2 , 22 , 1 , Inf4 , Sup4;
          |POPV;
     |FINSI;
|FPRC;

|RUTINA Inf4;
     #4#0 = #0#0;
     #4#2 = 01;
|FRUT;

|RUTINA Sup4;
     #4#0 = #0#0;
     #4#2 = 99;
|FRUT;

|PROCESO TipoHora0; |TIPO 0;
     |SI #0#28 = "N"; |ACABA; |FINSI;
     |ABRE #4;
     #4#0 = #0#0;
     #4#2 = #0Campo;
     |LEE 000#4=;
     |SI FSalida ! 0; |Y #4#2 > 0;
          |MENAV "0000Tipo de hora no definido...";
     |FINSI;
     |CIERRA #0;
|FPRC;


|PROCESO TipoHora7; |TIPO 66;
     |ABRE #4;
     #4#0 = #0#0;
     #4#2 = #0Campo;
     |LEE 000#4];
     |CONSULTA_F_CLAVE #1#4, Inf4, Sup4;
     |SI FSalida = 0;
          #0Campo = #4#2;
          |PINTA #0Campo;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO ModGrupo; |TIPO 0;
     aAlfa = #0#28;
     |PARA i = 29; |SI i [ 73; |HACIENDO i = i + 1;
          |C_M #0i, 1, aAlfa;
     |SIGUE;
     |SI #0#28 ! Contenido;
          |SI #0#28 = "N";
               |PARA i = 29; |SI i [ 73; |HACIENDO i = i + 1;
                    #0i = "";
               |SIGUE;
          |SINO;
               |DDEFECTO #5;
               |ABRE #5;
               #5#0 = #0#3;
               #5#1 = #0#2;
               |LEE 000#5=;
               |CIERRA #5;
               #0#29 = #5#14;
               #0#30 = #5#92;
               #0#31 = #5#15;
               #0#32 = #5#27;
               #0#33 = #5#28;
               #0#34 = #5#29;
               #0#35 = #5#30;
               #0#36 = #5#31;
               #0#37 = #5#32;
               #0#38 = #5#33;
               #0#39 = #5#34;

               #0#40 = #5#21;
               #0#41 = #5#93;
               #0#42 = #5#22;
               #0#43 = #5#43;
               #0#44 = #5#44;
               #0#45 = #5#45;
               #0#46 = #5#46;
               #0#47 = #5#47;
               #0#48 = #5#48;
               #0#49 = #5#49;
               #0#50 = #5#50;

               #0#51 = #5#23;
               #0#52 = #5#94;
               #0#53 = #5#24;
               #0#54 = #5#75;
               #0#55 = #5#76;
               #0#56 = #5#77;
               #0#57 = #5#78;
               #0#58 = #5#79;
               #0#59 = #5#80;
               #0#60 = #5#81;
               #0#61 = #5#82;

               #0#62 = #5#25;
               #0#63 = #5#95;
               #0#64 = #5#26;
               #0#65 = #5#83;
               #0#66 = #5#84;
               #0#67 = #5#85;
               #0#68 = #5#86;
               #0#69 = #5#87;
               #0#70 = #5#88;
               #0#71 = #5#89;
               #0#72 = #5#90;

               #0#73 = #5#91;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Mini6;
     #6#0 = #0#0;
     #6#1 = 1;
|FPRC;

|PROCESO Maxi6;
     #6#0 = #0#0;
     #6#1 = 99;
|FPRC;

|PROCESO PinCentroTra; |TIPO 14;
     |ATRI 0;
     |ENTLINEAL #1#6, 2, 7, 15, 0, Mini6, Maxi6;
     |ATRI I;
|FPRC;

|PROCESO EntCentroTra; |TIPO 0;
     |SI FSalida ! 2;
          |ENTLINEAL #1#6, 2, 2, 15, 0, Mini6, Maxi6;
     |FINSI;
|FPRC;

|PROCESO ContaTrab9;
|FPRC;
|PROCESO ContaTrab1;
|FPRC;
