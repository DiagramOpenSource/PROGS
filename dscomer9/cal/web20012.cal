|FICHEROS;
     web20012 #0;
     web20002 #2;
     agifa065 #65;
|FIN;

|VARIABLES;
     i         = 0;
     nPos      = 0;
     aDato     = "";
     nHandle   = 0;
     aAlfa     = "";
     aID       = "";
     aFic      = "";
     aSw       = "";
     aLon      = "";
     aCli      = "";
     nUni      = 0;
|FIN;

|PROCESO agifa065;
     nUni = -#65#6;
     aAlfa = #65#11 + "|" + #65#3 + "|" + #65#1 + "|" + #65#0 + "|";
     aAlfa = aAlfa + nUni + "|" + #65#9;
     |XGRABA nHandle, aAlfa;
|FPRC;

|DEFBUCLE agifa065;
     #65#1;
     10;
     "                    ", "01.01.0000", "AV", 000000, 00000, "     ",aCli;
     "zzzzzzzzzzzzzzzzzzzz", "31.12.9999", "AV", 999999, 99999, "zzzzz",aCli;
     ;
     NULL, agifa065;
|FIN;

|PROGRAMA;
     aAlfa = PARAMETRO;
     aLon = aAlfa % A0;

     |PARA i = 1; |SI i [ aLon; |HACIENDO i = i + 1;
          nPos = i * 100 + 1;
          aDato = aAlfa % nPos;
          |SI aSw = "Z"; |O aDato = "Z";
               |SI aSw = "Z";
                    aFic = aFic + aDato;
               |SINO;
                    aSw = "Z";
               |FINSI;
          |SINO;
               aID = aID + aDato;
          |FINSI;
     |SIGUE;

     |ABRE #2;
     #2#0 = aID;
     |LEE 000#2=;
     |SI FSalida ! 0;
          aAlfa = "0000No existe identificador:[" + aID + "]";
          |MENSA aAlfa;
     |SINO;
          |XABRE "W", aFic, nHandle;
          |SI FSalida ] 0;
               aCli = #2#3;
               |BUCLE agifa065;
               |XCIERRA nHandle;
          |SINO;
               aAlfa = "0000No puedo crear: [" + aFic + "]";
               |MENSA aAlfa;
          |FINSI;
     |FINSI;
     |CIERRA #2;
|FPRO;
