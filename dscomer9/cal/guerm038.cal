|FICHEROS;
     guerm038 #0;
     gomantl1 #1;
     gopre002 #2;
     gopre003 #3;
     gopartia #4;
     gopre001 #5;
     guerw029 #10,MANTE;
     gopre001@ #101;
     gopre002@ #102;
     gopre003@ #103;
|FIN;

|VARIABLES;
 {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = " ";
     aMenu4 = "RAC";
     aMenu5 = " Repasar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
     aDef = "";
     aSer = "";
     nPre = 0;
     aAlfa = "";
     nCampos = 0;
     i = 0;
     aPath = "";
     aCap = "";
     aPar = "";
     aDes = "";
     aDesde = "";
     aHasta = "";
     nHay = 0;
     aAlf1 = "";
     aAlf2 = "";
     aAlf3 = "";
|FIN;

|PROCESO Sal; |TIPO 6;
     |SI FSalida = 1;
          |ERROR;
          |PTEC 807;
     |FINSI;
|FPRC;

|PROCESO Tecla; |TIPO 0;
     |SI #10Campo = Contenido; |Y FSalida = 0;
          |SI #10#53 = "*";
               #10#53 = "";
          |SINO;
               #10#53 = "*";
          |FINSI;
          |GRABA 020#10a;
          |PINTA #10#53;
     |FINSI;
|FPRC;

|PROCESO Asigna;
     |SI #10#53 ! " ";
          #4#34 = #10#34;
          #4#4 = #10#4;
          #4#5 = #10#5;
          #4#6 = #10#6;
          #4#7 = #10#7;
          |LEE 121#4=;
          |SI FSalida = 0;
               #4#0 = aSer;
               #4#1 = nPre;
               #4#8 = aPar;
               #4#33 = aCap;
               #4#9 = aDes;
               |GRABA 020#4a;
               |LIBERA #4;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Asigna;
     #10#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Asigna;
|FIN;

|PROCESO gopartia;
     |SI #4#34 = "A"; |O #4#34 = "M";
          || los que entran
     |SINO;
          |ACABA;
     |FINSI;

/* ANTES
     |SI #4#8 = aPar; |Y #4#33 = aCap;
          |ACABA;
     |FINSI;
*/
     aAlf1 = #4#0; |QBF aAlf1;
     aAlf2 = #4#8; |QBF aAlf2;
     aAlf3 = #4#33; |QBF aAlf3;
     |SI aAlf1 ! ""; |Y aAlf2 ! ""; |Y aAlf3 ! ""; |ACABA; |FINSI;

     nHay = 1;

     |PARA i = 0; |SI i [ 52; |HACIENDO i = i + 1;
          #10i = #4i;
     |SIGUE;

     |SI #0#2 = "S";
          #10#53 = "*";
     |SINO;
          #10#53 = "";
     |FINSI;

     |GRABA 020#10n;
|FPRC;

|DEFBUCLE gopartia;
     #4#3;
     ;
     #0#0, #0#1, "     ", 000000, aDesde, aDesde;
     #0#0, #0#1, "zzzzz", 999999, aHasta, aHasta;
     ;
     NULL, gopartia;
|FIN;

|PROCESO Min;
     #10#34 = " ";
     #10#4 = "     ";
     #10#5 = 1;
     #10#6 = 1;
     #10#7 = 1;
     #10#20 = " " *20;
|FPRC;

|PROCESO Max;
     #10#34 = "z";
     #10#4 = "zzzzz";
     #10#5 = 999999;
     #10#6 = 999;
     #10#7 = 999;
     #10#20 = "z" *20;
|FPRC;

|PROCESO ElGopartia;
     aAlfa = Usuario; aAlfa = "1" + aAlfa;
     |NOME_DAT #10 aAlfa;
     |DELINDEX #10;

     nHay = 0;
     |ABRE #10;
     |BUCLE gopartia;
     |CIERRA #10;
     |SI nHay = 0;
          |MENAV "0000No hay registros a asignar...";
     |SINO;
          |PUSHV 0501 2380;
          |PINPA #0#10;
          |PARA aMenu2 = 1; |SI aMenu2 = 1; |HACIENDO;
               ||ENTLINEAL #1#10, 5, 4, 20, 0, Min, Max;
               |ENTLINEAL #2#10, 1, 4, 20, 0, Min, Max;
               |MENU aMenu;
               aMenu2 = FSalida;
          |SIGUE;
          |POPV;
          |SI aMenu2 = 2;
               |ABRE #4;
               |BUCLE Asigna;
               |CIERRA #4;
          |FINSI;
     |FINSI;

     |DELINDEX #10;
|FPRC;

|PROCESO gopre003;
     aAlfa = "|NC";
     aAlfa = #3#aAlfa#;
     nCampos = aAlfa;
     nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #103i = #3i;
     |SIGUE;
     |GRABA 020#103n;
|FPRC;

|DEFBUCLE gopre003;
     #3#1;
     ;
     aSer, nPre, aCap, 001;
     aSer, nPre, aCap, 999;
     ;
     NULL, gopre003;
|FIN;

|PROCESO Partidas;
     aDef = aPath + "gopre003";
     |CARGA_DEF aDef, gopre003@;
     |SI FSalida = 0;
          aAlfa = Usuario; aAlfa = "2" + aAlfa;
          |NOME_DAT #103 aAlfa;
          |DELINDEX #103;
          |ABRE #103;
          |BUCLE gopre003;
          |LEE 000#103p;
          |CONSULTA_CLAVE #1#103;
          |SI FSalida = 0;
               aPar = #103#4;
               aDes = #103#5;
               |HAZ ElGopartia;
          |FINSI;
          |CIERRA #103;
          |DELINDEX #103;
          |DESCARGA_DEF #gopre003@;
     |FINSI;
|FPRC;

|PROCESO gopre002;
     aAlfa = "|NC";
     aAlfa = #2#aAlfa#;
     nCampos = aAlfa;
     nCampos = nCampos - 1;
     |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
          #102i = #2i;
     |SIGUE;
     |GRABA 020#102n;
|FPRC;

|DEFBUCLE gopre002;
     #2#1;
     ;
     aSer, nPre, 001;
     aSer, nPre, 999;
     ;
     NULL, gopre002;
|FIN;

|PROCESO Capitulos;
     aDef = aPath + "gopre002";
     |CARGA_DEF aDef, gopre002@;
     |SI FSalida = 0;
          aAlfa = Usuario; aAlfa = "3" + aAlfa;
          |NOME_DAT #102 aAlfa;
          |DELINDEX #102;
          |ABRE #102;
          |BUCLE gopre002;
          |LEE 000#102p;
          |CONSULTA_CLAVE #1#102;
          |SI FSalida = 0;
               aCap = #102#12;
               |HAZ Partidas;
          |FINSI;
          |CIERRA #102;
          |DELINDEX #102;
          |DESCARGA_DEF #gopre002@;
     |FINSI;
|FPRC;

|PROCESO gomantl1;
     #5#0 = #1#3;
     #5#1 = #1#4;
     |LEE 000#5=;
     |SI FSalida = 0;
          aAlfa = "|NC";
          aAlfa = #5#aAlfa#;
          nCampos = aAlfa;
          nCampos = nCampos - 1;
          |PARA i = 0; |SI i [ nCampos; |HACIENDO i = i + 1;
               #101i = #5i;
          |SIGUE;
          |GRABA 020#101n;
     |FINSI;
|FPRC;

|DEFBUCLE gomantl1;
     #1#1;
     ;
     #0#0, #0#1, 001;
     #0#0, #0#1, 999;
     ;
     NULL, gomantl1;
|FIN;

|PROCESO Tipo12; |TIPO 12;
     |SI FSalida ! 0; |ACABA; |FINSI;
     |DDEF aPath;
     aDef = aPath + "gopre001";
     |CARGA_DEF aDef, gopre001@;
     |SI FSalida = 0;
          aAlfa = Usuario; aAlfa = "4" + aAlfa;
          |NOME_DAT #101 aAlfa;
          |DELINDEX #101;
          |ABRE #101;
          |ABRE #5;
          |BUCLE gomantl1;
          |CIERRA #5;
          |LEE 000#101p;
          |CONSULTA_CLAVE #1#101;
          |SI FSalida = 0;
               aSer = #101#0;
               nPre = #101#1;
               |HAZ Capitulos;
          |FINSI;
          |CIERRA #101;
          |DELINDEX #101;
          |DESCARGA_DEF #gopre001@;
     |FINSI;
|FPRC;

|PROGRAMA;
     aDesde = " " * 20;
     aHasta = "z" * 20;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |PARA FSalida = 0; |SI FSalida = 0; |HACIENDO;
          |ENDATOS #1#0;
     |SIGUE;
|FPRO;
