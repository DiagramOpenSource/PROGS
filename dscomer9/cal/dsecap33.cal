|FICHEROS;
     dsecap33 #0;
     dsecap01 #1;
     dsecap05 #5;
     dsecap07 #7;
     dsecap09 #9;
     dsecap10 #10;
     dsecap11 #11;
     dsecap13 #13;
|FIN;

|VARIABLES;
     &enHora = 0;
     aAlfa = "";
     a1 = "";
     a2 = "";
     h1 = 0;
     h2 = 0;
     h3 = 0;
     h4 = 0;
     nHora = 0;
     nMinu = 0;
|FIN;

|PROCESO dsecap13;
     aAlfa = ("0000" + #13#3) % -104;
     a1 = aAlfa % 102; h1 = a1;
     a2 = aAlfa % 302; h2 = a2;
     aAlfa = ("0000" + #13#4) % -104;
     a1 = aAlfa % 102; h3 = a1;
     a2 = aAlfa % 302; h4 = a2;
     nHora = (h3 * 60 + h4) - (h1 * 60 + h2);

     nMinu = nHora $ 60;
     enHora = (nHora - nMinu) / 60;
     enHora = enHora + (nMinu / 100);

     |PRINT;
|FPRC;

|DEFBUCLE dsecap13;
     #13#1;
     6;
     #0#0, #0#1, #0#2, "S";
     #0#0, #0#1, #0#3, "S";
     ;
     NULL, NULL, NULL, NULL, NULL, dsecap13;
     #13#5, #13#3, #13#4;
|FIN;

|PROCESO dsecap11;
     |DDEFECTO #9;
     #9#0 = #11#0;
     #9#1 = #11#1;
     |LEE 000#9=;

     |DDEFECTO #1;
     #1#0 = #11#2;
     |LEE 000#1=;

     |DDEFECTO #7;
     #7#0 = #11#2;
     #7#1 = #11#3;
     |LEE 000#7=;

     |DDEFECTO #5;
     #5#0 = #9#2;
     |LEE 000#5=;

     |BUCLE dsecap13;
     |PIEINF;
|FPRC;

|DEFBUCLE dsecap11;
     #11#1;
     ;
     #0#0, #0#1, #0#4, 000000;
     #0#0, #0#1, #0#4, 999999;
     ;
     NULL, dsecap11;
|FIN;

|PROCESO Min10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     #10#2 = "      ";
     #10#3 = 0;
|FPRC;

|PROCESO Max10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     #10#2 = "zzzzzz";
     #10#3 = 999999;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     #10#2 = #0#4;
     #10#3 = 1;
     |LEE 000#10];
     |CONSULTA_F_CLAVE #1#10, Min10, Max10;
     |SI FSalida = 0;
          #0#4 = #10#2; |PINTA #0#4;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO Tipo0; |TIPO 0;
     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = #0#1;
     #10#2 = #0#4;
     |LEE 000#10=;
     |SI FSalida ! 0;
          |MENAV "0000No existe cliente en el expediente...";
          |ERROR;
     |FINSI;
     |CIERRA #10;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "dsecap33";
          |SI FSalida = 0;
               |ABRE #1;
               |ABRE #5;
               |ABRE #7;
               |ABRE #9;
               |BUCLE dsecap11;
               |CIERRA #9;
               |CIERRA #7;
               |CIERRA #5;
               |CIERRA #1;
               |FININF;
          |SINO;
               |MENAV "0000Error en 'dsecap33'";
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;
