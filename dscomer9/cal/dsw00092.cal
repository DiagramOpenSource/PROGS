|FICHEROS;
     dsw00092 #0;
     agifa024 #24;
     agifa025 #25;
     agifa073 #73;
     agifa104 #104;
     dsm00300 #300;
     dsm00301 #301;
     dsw00093 #93; ||Tmp
     dsw00094 #94; ||Tmp
     dsw00095 #95; ||Tmp
|FIN;

|VARIABLES;
     &aDivisa = "";
     &aMoneda = "";
     &Tempo = "";
     &enSwTipo = 0;
     aTmp93 = "";
     aTmp94 = "";
     aTmp95 = "";
     nConta = 0;
     nHay = 0;
     nPrime = 0;
|FIN;

|PROCESO Print;
     nHay = 1;
     |PRINT;
|FPRC;

|DEFBUCLE PedidosImp;
     #104#4;
     4;
     #94#0, #94#1;
     #94#0, #94#1;
     ;
     NULL, Print;
|FIN;

|DEFBUCLE Tmp95;
     #95#1;
     ;
     #94#0, #94#1, 1;
     #94#0, #94#1, 99999999;
     ;
     NULL, Print;
|FIN;

|PROCESO Tmp94;
     |DDEFECTO #24;
     #24#0 = #94#1;
     |LEE 000#24=;

     nHay = 0;
     enSwTipo = 1;
     |BUCLE Tmp95;
     |SI nHay = 0;
          |DDEFECTO #95;
          |PRINT;
     |FINSI;
     enSwTipo = 2;
     |BUCLE PedidosImp;
|FPRC;

|DEFBUCLE Tmp94;
     #94#1;
     ;
     #93#0, "      ";
     #93#0, "zzzzzz";
     ;
     NULL, Tmp94;
|FIN;

|PROCESO Tmp93;
     |DDEFECTO #25;
     #25#0 = #93#0;
     |LEE 000#25=;

     |BUCLE Tmp94;
|FPRC;

|DEFBUCLE Tmp93;
     #93#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp93;
|FIN;

|PROCESO RepreCli;
     |SI #94#5 = "S";
          #93#4 = #93#4 + 1;
     |SINO;
          #93#5 = #93#5 + 1;
     |FINSI;
     |GRABA 020#93a;
     |LIBERA #93;
|FPRC;

|DEFBUCLE RepreCli;
     #94#1;
     ;
     #93#0, "      ";
     #93#0, "zzzzzz";
     be;
     NULL, RepreCli;
|FIN;

|PROCESO CliVisitados;
     #93#4 = 0;
     |BUCLE RepreCli;
|FPRC;

|DEFBUCLE CliVisitados;
     #93#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CliVisitados;
|FIN;


|PROCESO Pedidos;
     aDivisa = #104#35;
     aMoneda = #104#37;
     |HAZ Divisas104;

     |DDEFECTO #24;
     #24#0 = #104#4;
     |LEE 000#24=;

     |DDEFECTO #25;
     #25#0 = #104#7;
     |LEE 000#25=;

     |DDEFECTO #93;
     #93#0 = #25#0;
     |LEE 101#93=;
     |SI FSalida ! 0; |GRABA 020#93b; |FINSI;
     #93#2 = #93#2 + #104#11;
     |SI #104#1 ] #0#2; |Y #104#2 [ #0#3;
          #93#3 = #93#3 + #104#11;
     |FINSI;
     |GRABA 020#93a;
     |LIBERA #93;

     |DDEFECTO #94;
     #94#0 = #25#0;
     #94#1 = #24#0;
     |LEE 101#94=;
     |SI FSalida ! 0; |GRABA 020#94b; |FINSI;
     #94#3 = #94#3 + #104#11;
     |SI #104#1 ] #0#2; |Y #104#2 [ #0#3;
          #94#4 = #94#4 + #104#11;
     |FINSI;
     |GRABA 020#94a;
     |LIBERA #94;
|FPRC,

|DEFBUCLE Pedidos;
     #104#4;
     4;
     #0#0, #0#7;
     #0#1, #0#8;
     ;
     NULL, Pedidos;
|FIN;

|PROCESO VisitasL;
     |SI #301#2 ] #0#4; |Y #301#2 [ #0#5;
          |SI nPrime = 0;
               nPrime = 1;
               |DDEFECTO #93;
               #93#0 = #24#25;
               |LEE 101#93=;
               |SI FSalida ! 0; |GRABA 020#93b; |FINSI;
               #93#1 = #93#1 + 1;
               |GRABA 020#93a;
               |LIBERA #93;

               |DDEFECTO #94;
               #94#0 = #24#25;
               #94#1 = #24#0;
               |LEE 101#94=;
               |SI FSalida ! 0; |GRABA 020#94b; |FINSI;
               #94#2 = #94#2 + 1;
               #94#5 = "S";
               |GRABA 020#94a;
               |LIBERA #94;
          |FINSI;
          nConta = nConta + 1;
          |DDEFECTO #95;
          #95#0 = #24#25;
          #95#1 = #24#0;
          #95#2 = nConta;
          #95#3 = #300#14;
          #95#4 = #301#2;
          #95#5 = #301#3;
          #95#6 = #300#15;
          #95#7 = #301#6;
          #95#8 = #301#7;
          #95#9 = #301#8;
          |GRABA 020#95n;
     |FINSI;
|FPRC;

|DEFBUCLE VisitasL;
     #301#1;
     ;
     #300#0, #300#14, 001;
     #300#0, #300#14, 999;
     ;
     NULL, VisitasL;
|FIN;

|PROCESO VisitasC;
     #24#0 = #300#0;
     |LEE 000#24=;
     |SI FSalida = 0; |Y #24#25 ] #0#0; |Y #24#25 [ #0#1;
          nPrime = 0;
          |BUCLE VisitasL;
     |FINSI;
|FPRC;

|DEFBUCLE Visitas;
     #300#1;
     ;
     #0#7, #0#2;
     #0#8, #0#3;
     ;
     NULL, VisitasC;
|FIN;

|PROCESO Clientes;
     |DDEFECTO #93;
     #93#0 = #24#25;
     |LEE 000#93=;
     |SI FSalida ! 0; |GRABA 020#93n; |FINSI;

     |DDEFECTO #94;
     #94#0 = #24#25;
     #94#1 = #24#0;
     |LEE 000#94=;
     |SI FSalida ! 0; |GRABA 020#94n; |FINSI;
|FPRC;

|DEFBUCLE Clientes;
     #24#1;
     25;
     #0#7, #0#0;
     #0#8, #0#1;
     ;
     NULL, Clientes;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |HAZ CreaTempo; |NOME_DAT #93 Tempo; |DELINDEX #93; aTmp93 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #94 Tempo; |DELINDEX #94; aTmp94 = Tempo;
     |HAZ CreaTempo; |NOME_DAT #95 Tempo; |DELINDEX #95; aTmp95 = Tempo;

     |HAZ DecimalesBase;

     Impresora = "Crystal Reports";
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "dsw00092";
          |SI FSalida = 0;
               |ABRE #24;
               |ABRE #25;
               |ABRE #93;
               |ABRE #94;
               |ABRE #95;
               |BUCLE Clientes;
               |BUCLE Visitas;
               |BUCLE Pedidos;
               |CIERRA #95;
               |CIERRA #94;
               |CIERRA #93;
               |BUCLE CliVisitados;
               |BUCLE Tmp93;
               |CIERRA #25;
               |CIERRA #24;
               |PIEINF;
               |FININF;
          |SINO;
               |MENAV "0000Error en informe 'dsw00092'";
          |FINSI;
          |FINIMP;
     |FINSI;

     Tempo = aTmp93; |HAZ BoraTempo; |DELINDEX #93;
     Tempo = aTmp94; |HAZ BoraTempo; |DELINDEX #94;
     Tempo = aTmp95; |HAZ BoraTempo; |DELINDEX #95;
|FPRC;
