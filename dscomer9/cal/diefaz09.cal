|FICHEROS;
     diefaz09 #10;
     agifa071 #0;
     agifa065 #1;
     agifa019 #2;
     agifa010 #3;
     diefam01 #4;
     agifa321;
     agifa324;
|FIN;

|VARIABLES;
     nUni      = 0;
     &eaTexto  = "";
     &nDeci_PreBase = 0;
     &nDeci_PreBaseMx = 0;
     nComi     = 0;
     nTari     = 0;
|FIN;

|PROCESO ModiLinea;
     nUni = -#1#6;
     |DDEFECTO #0;
     #0#0 = #1#3;
     #0#1 = #1#4;
     #0#2 = #1#0;
     #0#3 = #1#5;
     #0#4 = #2#1;
     #0#5 = nUni;
     #0#6 = #1#9;
     #0#7 = nUni * #1#9;
     #0#8 = #1#12;
     #0#9 = (nUni * #1#9) < #1#12 < #1#13;
||   #0#10
     #0#11 = #2#30;
     #0#12 = 0;
     #0#13 = #2#2;
     #0#14 = 0;
     #0#15 = #1#10;
||   #0#16
||   #0#17
     #0#18 = 0;
     #0#19 = "N";
     #0#20 = "N";
     #0#21 = 0;
     #0#22 = 0;
     #0#23 = 0;
     #0#24 = 0;
     #0#25 = 0;
     #0#26 = #3#39;

||   #0#27
||   #0#28
     #0#29 = #1#11;
     #0#30 = #3#53;
||   #0#31
||   #0#32
     #0#33 = #1#13;
||   #0#34
     #0#35 = #1#5;
     #0#36 = #0#6;
     #0#37 = #0#7;
     #0#38 = #0#6;
     #0#39 = #0#7;
     #0#40 = 0;
     #0#41 = 0;
     #0#42 = 0;
     #0#43 = 0;
     #0#44 = 0;
     #0#45 = 0;
     #0#46 = 0;
||   #0#47
     #0#48 = 0;
||   #0#49
     #0#50 = 0;
     #0#51 = 0;
     #0#52 = 0;
     #0#53 = 0;

     nTari = 0;
     |SI #1#9 = #2#18; nTari = 1; |FINSI;
     |SI #1#9 = #2#19; nTari = 2; |FINSI;
     |SI #1#9 = #2#20; nTari = 3; |FINSI;
     |SI #1#9 = #2#147; nTari = 4; |FINSI;
     |SI #1#9 = #2#148; nTari = 5; |FINSI;
     |SI #1#9 = #2#149; nTari = 6; |FINSI;

     #0#61 = nTari;

     nComi = 0;
     #4#0 = #3#6
     |LEE 000#4=;
     |SI FSalida = 0;
          |SI nTari = 0; nComi = #4#8; |FINSI;
          |SI nTari = 1; nComi = #4#2; |FINSI;
          |SI nTari = 2; nComi = #4#3; |FINSI;
          |SI nTari = 3; nComi = #4#4; |FINSI;
          |SI nTari = 4; nComi = #4#5; |FINSI;
          |SI nTari = 5; nComi = #4#6; |FINSI;
          |SI nTari = 6; nComi = #4#7; |FINSI;
     |FINSI;

     |SI #2#31 = 0;
          #0#10 = nComi;
     |SINO;
          #0#10 = #2#31;
     |FINSI;

     |GRABA 020#0n;
|FPRC;

|PROCESO agifa065;
     |SI #1#2 = "AV"; |O #1#2 = "BV";
          #3#52 = #1#11;
          #3#0 = #1#3;
          |LEE 101#3=;
          |SI FSalida = 0;
               #0#29 = #1#11;
               #0#0 = #1#3;
               #0#1 = #1#4;
               |LEE 101#0=;
               |SI FSalida ! 0;
                    #2#0 = #1#0;
                    |LEE 000#2=;
                    |SI FSalida ! 0;
                         eaTexto = "No existe articulo";
                         |PRINT;
                    |SINO;
                         |PINTA 1920, #1#11;
                         |PINTA 1930, #1#3;
                         |PINTA 1940, #1#4;
                         eaTexto = "Linea actualizada";
                         |PRINT;
                         |HAZ ModiLinea;
                    |FINSI;
               |FINSI;
          |SINO;
               eaTexto = "No exite albaran";
               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agifa065;
     #1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, agifa065;
|FIN;

|PROCESO LeeMonBase;
     |ABRE #agifa321;
     |ABRE #agifa324;
     |LEE 010#agifa321.p;

     #agifa324#0 = #agifa321#9;
     |LEE 010#agifa324.=;

     nDeci_PreBase = #agifa324#9;
     nDeci_PreBaseMx = #agifa324#9;
     |CIERRA #agifa324;
     |CIERRA #agifa321;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI #10#0 = "SI";
          |HAZ LeeMonBase;
          |IMPRE 0;
          |SI FSalida = 0;
               |INFOR "diefaz09";
               |SI FSalida = 0;
                    |ABRE #4;
                    |ABRE #3;
                    |ABRE #2;
                    |ABRE #0;
                    |BUCLE agifa065;
                    |CIERRA #0;
                    |CIERRA #2;
                    |CIERRA #3;
                    |CIERRA #4;
                    |FININF;
                    |PIEINF;
               |SINO;
                    |MENAV "0000No existe informe diefaz09";
               |FINSI;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRC;
