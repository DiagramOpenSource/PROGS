|FICHEROS;
     gocoscat #0;
     gocalcoc #1;
     gocalcol #2;
     gocatcon #3;
     gocatcot #4;
|FIN;
-------------------------------------------------------------------------------
|VARIABLES;
     &nDeci_TTrab   = 0;
     &cCodMonTrab   = "";

     nConta         = 0;
     nPosi          = 0;
     nModo          = 0;

     nCaracter      = 0;
     nFondo         = 0;
     cPosi          = "";
|FIN;
-------------------------------------------------------------------------------
|PROCESO PintTot; |TIPO 7;
     |ATRI I;

     |PARA nConta = 25; |SI nConta [ 36; |HACIENDO nConta = nConta + 1;
          nPosi = nConta - 17;
          cPosi = nPosi;
          |QBF cPosi;
          cPosi = cPosi+"23";
          nPosi = cPosi;
          |PINTA nPosi, #1nConta;
     |SIGUE;

     nCaracter = 4;
     nFondo = 0;
     |COLOR nCaracter, nFondo;
     |ATRI 0;
     |PINTA 2023, #1#41;
     |PINTA 2123, #1#42;
     |PINTA 2223, #1#42;
     |ATRI 0;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Incre; |TIPO 0;
     nModo = (FEntrada/100)!0;
     |SI nModo = 4;
          |ACABA;
     |SINO;
          |PTEC 802;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO Incremento; |TIPO 0;

     |SI Campo = 8; |Y Contenido ! #0Campo;
         #0#11 = #0#3 > #0#8;
         |PINTA #0#11;
     |FINSI;

     |SI Campo = 9; |Y Contenido ! #0Campo;
         #0#12 = #0#3 > #0#9;
         |PINTA #0#12;
     |FINSI;

     |SI Campo = 10; |Y Contenido ! #0Campo;
         #0#13 = #0#3 > #0#10;
         |PINTA #0#13;
     |FINSI;

     |SI Campo = 11; |Y Contenido ! #0Campo;
          #0#8 = (((#0#11*100)-(#0#3*100))/#0#3);
          |PINTA #0#8;
     |FINSI;

     |SI Campo = 12; |Y Contenido ! #0Campo;
          #0#9 = (((#0#12*100)-(#0#3*100))/#0#3);
          |PINTA #0#9;
     |FINSI;

     |SI Campo = 13; |Y Contenido ! #0Campo;
          #0#10 = (((#0#13*100)-(#0#3*100))/#0#3);
          |PINTA #0#10;
     |FINSI;
|FPRC;
-------------------------------------------------------------------------------
|PROCESO gocatcot;
     ||Importe --------- Presupuesto
     #4#4 = #3#3;
     #4#5 = #3#4;
     |SI #4#11 ! 0; |Y #3#3 ! 0;
          #4#4 = #3#3 + #4#11;
     |FINSI;
     |SI #4#12 ! 0; |Y #3#4 ! 0;
          #4#5 = #3#4 + #4#12;
     |FINSI;
     ||Importe --------- Administracion
     #4#6 = #3#7;
     #4#7 = #3#9;
     |SI #4#13 ! 0; |Y #3#7 ! 0;
          #4#6 = #3#7 + #4#13;
     |FINSI;
     |SI #4#14 ! 0; |Y #3#9 ! 0;
          #4#7 = #3#9 + #4#14;
     |FINSI;
     ||Importe --------- Extras
     #4#8 = #3#8;
     #4#9 = #3#10;
     |SI #4#15 ! 0; |Y #3#8 ! 0;
          #4#8 = #3#8 + #4#15;
     |FINSI;
     |SI #4#16 ! 0; |Y #3#10 ! 0;
          #4#9 = #3#10 + #4#16;
     |FINSI;
     ||Porcentaje --------- Presupuesto
     |SI #4#17 ! 0; |Y #3#3 ! 0;
          #4#4 = #3#3 > #4#17;
     |FINSI;
     |SI #4#18 ! 0; |Y #3#4 ! 0;
          #4#5 = #3#4 > #4#18;
     |FINSI;
     ||Porcentaje --------- Administracion
     |SI #4#19 ! 0; |Y #3#7 ! 0;
          #4#6 = #3#7 > #4#19;
     |FINSI;
     |SI #4#20 ! 0; |Y #3#9 ! 0;
          #4#7 = #3#9 > #4#20;
     |FINSI;
     ||Porcentaje --------- Extras
     |SI #4#21 ! 0; |Y #3#8 ! 0;
          #4#8 = #3#8 > #4#21;
     |FINSI;
     |SI #4#22 ! 0; |Y #3#10 ! 0;
          #4#9 = #3#10 > #4#22;
     |FINSI;

     |GRABA 020#4a;
|FPRC;



|DEFBUCLE gocatcot;
     #4#1;
     ;
     #3#0,#3#1,01;
     #3#0,#3#1,99;
     be;
     NULL,gocatcot;
|FIN;

|PROCESO ActCat;
     #3#0 = #0#1;                                 ||Categoria.
     #3#1 = #0#16;                                ||Convenio.
     |LEE 000#3=;

     |SI FSalida = 0;
          #3#3  = #0#11;           ||PVP Pres.
          #3#4  = #0#3;            ||Coste Pres.
          #3#7  = #0#12;           ||PVP Admi.
          #3#9  = #0#3;            ||Coste Admi.
          #3#8  = #0#13;           ||PVP Extr.
          #3#10 = #0#3;            ||Coste Extr.
          |GRABA 020#3a;
     |FINSI;
     |BUCLE gocatcot;
|FPRC;
-------------------------------------------------------------------------------
|DEFBUCLE ActuCate;
     #0#1;
     ;
     #1#0,  1,   1;
     #1#0, 99, 999;
     ;
     NULL, ActCat;
|FIN;
-------------------------------------------------------------------------------
|PROCESO ActPreCat; |TIPO 11;

     nModo = (FEntrada/100)!0

     |SI nModo = 4;
          |ACABA;
     |FINSI;

     |SI FSalida = 1;
          |CONFI "0000N¿DESEA ACTUALIZAR LOS PRECIOS EN LAS CATEGORIAS?";

          |SI FSalida = 0;
               |ABRE #3;
               |BUCLE ActuCate;
               |CIERRA #3;
          |FINSI;

     |FINSI;

|FPRC;
-------------------------------------------------------------------------------
