
     OJO, este mantenimiento es el mismo para muchos procesos
     y en cada caso hay campos que son o no modificables y
     calculos distintos a realizar


|FICHEROS;
     abym0002 #0;
     abym0003 #1;
     dsm00003 #3,MANTE;
|FIN;

|VARIABLES;
     aTipo = "";
     nOk = 0;
     aAlfa = "";
     &eaSerPlan = "";
     &enNumPlan = 0;
     &eaTipPlan = "";
     &enVisPlan = 0;
     aSer = "";
     nNum = 0;
     aTip = "";
     nConta = 0;
     aCli = "";
     nDir = 0;
     nModo = 0;
     aCam4 = "";
     aCam12 = "";
     aCam20 = "";
     aCam21 = "";
     aCam22 = "";
     aCam23 = "";
|FIN;

|PROCESO EsOK;
     nOk = 0;
     |MODULO aAlfa;
     |SI aAlfa = "abym0002";
          |SI PARAMETRO = "asistencia";
               |SI #0#2 ! "A";
                    nOk = 1;
                    |MENAV "0000Use el mantenimiento de revisiones";
               |FINSI;
          |SINO;
               |SI #0#2 ! "R";
                    nOk = 1;
                    |MENAV "0000Use el mantenimiento de asistencias";
               |FINSI;
          |FINSI;
     |FINSI;
     FSalida = nOk;
|FPRC;

|PROCESO ActCabPla; |TIPO 2;
     |HAZ EsOK;
     |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;

     |SI #1#11 = "S";
          #0#10 = #0#10 +. #1#9;
     |FINSI;
     #0#11 = #0#11 +. (#1#7 * #1#10);
     |PINTA #0#10;
     |PINTA #0#11;
|FPRC;

|PROCESO CalcTotal; |TIPO 0;
     #1#9 = #1#7 * #1#8;
     |PINTA #1#9;
|FPRC;

|PROCESO Min1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = 1;
|FPRC;

|PROCESO Max1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = 999;
|FPRC;

|PROCESO ModiTraba; |TIPO 0;
     |MODULO aAlfa;
     |SI aAlfa = "abyz0004";
          |ABRE #1;
          #1#0 = #0#0;
          #1#1 = #0#1;
          #1#2 = #0#2;
          #1#3 = #0#3;
          #1#4 = 1;
          |LEE 101#1=;
          |SI FSalida = 0;
               #1#12 = #0#12;
               |GRABA 020#1a;
          |FINSI;
          |CIERRA #1;
          |ENTLINEAL #1#1, 5, 7, 22, 0,  Min1, Max1;
     |FINSI;
|FPRC;

|PROCESO GenFactu; |TIPO 0;
     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     #1#2 = #0#2;
     #1#3 = #0#3;
     #1#4 = 1;
     |LEE 101#1=;
     |SI FSalida = 0;
          #1#11 = #0#7;
          |GRABA 020#1a;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO EntraLin; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |MODULO aAlfa;
     |SI aAlfa = "abyz0002"; |Y #1#4 > 1;
          |AVISO;
          |ERROR;
     |FINSI;
     |SI aAlfa = "abym0002"; |Y nModo = 1;
          #1#11 = #0#7; |PINTA #1#11;
     |FINSI;
|FPRC;

|PROCESO Situacion; |TIPO 0;
     |SI #0#18 = "V";
          |SI #0#7 = "S"; |Y #0#10 = 0;
               |MENAV "0000No se puede visar si es facturable sin importes...";
               |ERROR;
          |FINSI;
          |SI #0#7 = "N"; |Y #0#10 ! 0;
               |MENAV "0000No se puede visar si no es facturable con importes...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ImpPlanLin;
     |PRINT;
|FPRC;

|PROCESO ImpPlan; |TIPO 4;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "abym0002";
          |SI FSalida ! 0;
               |MENAV "0000No existe informe 'abym0002'";
          |SINO;
               |BUCLELIN 2 ImpPlanLin #0;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO FinPlan; |TIPO 30;
     |MODULO aAlfa;
     |SI aAlfa = "abym0002";
          |CONFI "0000SImprimir Documento";
          |SI FSalida = 0;
               |HAZ ImpPlan;
          |FINSI;
          |SI #0#18 = "V"; |Y #0#9 = 0; |Y #0#7 = "S";
               |CONFI "0000SFacturar Documento";
               |SI FSalida = 0;
                    eaSerPlan = #0#0;
                    enNumPlan = #0#1;
                    eaTipPlan = #0#2;
                    enVisPlan = #0#3;
                    |GRABA 020#0a;
                    |CIERRAT #0;
                    |SUB_EJECUTA_NP "abyz0006";
                    |ABRET #0;
                    |LEE 121#0=;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min;
     #3#0 = #0#3;
     #3#1 = 1;
|FPRC;

|PROCESO Max;
     #3#0 = #0#3;
     #3#1 = 9999;
|FPRC;

|PROCESO DirEnt66; |TIPO 66;
     |ABRE #3;
     #3#0 = #0#4;
     #3#1 = #0#20;
     |LEE 000#3];
     |CONSULTA_F_CLAVE #1#3, Min, Max;
     |SI FSalida = 0;
          #0#20 = #3#1;
          |PINTA #0#20;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO DirEnt0; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;
     |ABRE #3;
     #3#0 = #0#4;
     #3#1 = #0#20;
     |LEE 000#3=;
     |SI FSalida ! 0;
          |MENAV "0000No existe Direccion entrega...";
          |ERROR;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO ContaVisi; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          aCam4 = #0#4;
          aCam12 = #0#12;
          aCam20 = #0#20;
          aCam21 = #0#21;
          aCam22 = #0#22;
          aCam23 = #0#23;

          aSer = #0#0;
          nNum = #0#1;
          aTip = #0#2;

          #0#3 = 9999;
          |LEE 000#0];
          |SI FSalida = 0;
               |LEE 000#0a;
          |SINO;
               |LEE 000#0u;
          |FINSI;
          |SI FSalida = 0; |Y aSer = #0#0; |Y nNum = #0#1; |Y aTip = #0#2;
               nConta = #0#3 + 1;
          |SINO;
               nConta = 1;
          |FINSI;
          |DDEFECTO #0;
          #0#0 = aSer;
          #0#1 = nNum;
          #0#2 = aTip;
          #0#3 = nConta;

          #0#4 = aCam4;
          #0#12 = aCam12;
          #0#20 = aCam20;
          #0#21 = aCam21;
          #0#22 = aCam22;
          #0#23 = aCam23;
     |FINSI;
|FPRC;

|PROCESO Facturable; |TIPO 7;
     |MODULO aAlfa;
     |SI aAlfa = "abym0002";
          |SI #1#2 = "A";
               |C_M #1#11, 1, "S";
          |SINO;
               |C_M #1#11, 1, "N";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO QueTipo; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |MODULO aAlfa;
     |SI aAlfa = "abym0002";
          |C_M #0#2, 1, "N";
          |SI nModo = 1; |O #0#2 = " ";
               |SI PARAMETRO = "asistencia";
                    #0#2 = "A";
               |SINO;
                    #0#2 = "R";
               |FINSI;
               |PINTA #0#2;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CheqTipo; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 2;
          |HAZ EsOK;
          |SI FSalida ! 0; |ERROR; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min0;
     #0#0 = "     ";
     #0#1 = 1;
     #0#2 = aTipo;
     #0#3 = 1;
|FPRC;

|PROCESO Max0;
     #0#0 = "zzzzz";
     #0#1 = 999999;
     #0#2 = aTipo;
     #0#3 = 9999
|FPRC;

|PROCESO Cto66; |TIPO 66;
     |SI PARAMETRO = "asistencia";
          aTipo = "A";
     |SINO;
          aTipo = "R";
     |FINSI;
     |SELECT #5#0;
     |LEE 000#0];
     |CONSULTA_F_CLAVE #5#0, Min0, Max0;
     |SI FSalida = 0;
          |SELECT #1#0;
          |LEE 020#0=;
          |PINDA #0#0;
     |SINO;
          |SELECT #1#0;
          |ERROR;
     |FINSI;
|FPRC;
