|FICHEROS;
     agifa146 #146,MANTE;
|FIN;

|VARIABLES;
     aCli = "";
     nDir = 0;
     nModo = 0;
     aAlfa = "";
     nBloquea = 0;
     aFic = "";
     nHandle = 0;
     aDato = "";
|FIN;

|PROCESO Edita;
     |CLS;
     |PINPA #0#146;
     |PINDA #0#146;
     |SI nModo = 1;
          |DDEFECTO #146;
          FEntrada = 101;
          |HAZ DefSerVta;
          |ENCAMPO #48#146;
          |SI FSalida = 0;
               FEntrada = 101;
               |HAZ ContaPR7;
               |ENCAMPO #0#146;
               |SI FSalida = 0;
                    nBloquea = 1;
                    |GRABA 020#146b;
                    |SI aCli ! ""; #146#3 = aCli; |FINSI;
                    |SI nDir ! 0; #146#80 = nDir; |FINSI;
                    |ENDATOS #1#146;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI nModo = 2; |ENDATOS #2#146; |FINSI;
     aAlfa = FSalida;
     |SI FSalida ! 0; |Y nModo = 1;
          |SI nBloquea = 1; |BORRA 020#146c; |FINSI;
     |FINSI;
     FSalida = aAlfa;
|FPRC;

|PROGRAMA;
     |ABRE #146;
     aAlfa = PARAMETRO % 105; #146#48 = aAlfa;
     aAlfa = PARAMETRO % 606; #146#0 = aAlfa;
     aAlfa = PARAMETRO % 1206; aCli = aAlfa;
     aAlfa = PARAMETRO % 1804; nDir = aAlfa;
     aFic = PARAMETRO % 22;
     |LEE 101#146=;
     |SI FSalida = 0;
          nModo = 2; |HAZ Edita;
     |SINO;
          nModo = 1; |HAZ Edita;
     |FINSI;
     aDato = #146#48 + (("000000" + #146#0) % -106);
     |SI FSalida = 0;
          |GRABA 020#146a;
     |SINO;
          |SI nModo = 1; aDato = ""; |FINSI;
     |FINSI;
     |CIERRA #146;

     |DFICE aAlfa;
     aFic = aAlfa + aFic;
     |XABRE "W", aFic, nHandle;
     |SI FSalida = 0;
          |XGRABA nHandle, aDato;
          |XCIERRA nHandle;
     |FINSI;
|FPRO;
