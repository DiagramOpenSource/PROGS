|FICHEROS;
     ialbz001 #0;
     ialbm002 #2;
|FIN;

|VARIABLES;
     &eaArticulo = "";
     &eaMatri = "";
     &eaDefeArti = "";
     aAlfa = "";
|FIN;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|PROCESO Min;
     #2#20 = eaArticulo;
     #2#0 = " " * 15;
|FPRC;

|PROCESO Max;
     #2#20 = eaArticulo;
     #2#0 = "z" * 15;
|FPRC;

|PROCESO Tipo66; |TIPO 66;
     |ABRE #2;
     |SELECT #3#2;
     #2#20 = eaArticulo;
     #2#0 = #0#0;
     |LEE 000#2];
     |CONSULTA_F_CLAVE #3#2, Min, Max;
     |SI FSalida = 0;
          #0#0 = #2#0; |PINTA #0#0;
     |SINO;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO Chequea; |TIPO 0;
     |ABRE #2;
     #2#0 = #0#0;
     |LEE 000#2=;
     |SI PARAMETRO = "AV"; |O PARAMETRO = "FD"; |O PARAMETRO = "AJ";
          |SI FSalida = 0; |Y #2#16 ! 0;
               aAlfa = "0000Matricula asignada en el albaran:" + &13 + #2#15 + "/" + (("000000" + #2#16) % -106);
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
          |SI FSalida = 0; |Y #2#18 ! 0;
               aAlfa = "0000Matricula asignada en la factura:" + &13 + #2#17 + "/" + (("000000" + #2#18) % -106);
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |SI PARAMETRO = "AC";
          |SI FSalida = 0; |Y #2#19 ! 0;
               aAlfa = "0000Matricula asignada en el albaran: " + &13 + #2#25 + "/" + (("000000" + #2#19) % -106);
               |MENAV aAlfa;
               |ERROR; |ACABA;
          |FINSI;
     |FINSI;
     |SI FSalida = 0; |Y #2#20 ! eaArticulo;
          aAlfa = "0000Matricula con articulo: [" + #2#20 + "]";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROGRAMA;
     #0#0 = eaMatri;
     |SI PARAMETRO = "PC"; |C_P #0#0, 1, 1009; |FINSI;
     |SI PARAMETRO = "AV"; |C_P #0#0, 1, 1336; |FINSI;
     |SI PARAMETRO = "AJ"; |C_P #0#0, 1, 1113; |FINSI;
     |SI PARAMETRO = "FD"; |C_P #0#0, 1, 1335; |FINSI;
     |SI PARAMETRO = "AC"; |C_P #0#0, 1, 1327; eaDefeArti = eaArticulo; |FINSI;
     |SI PARAMETRO = "EV"; |C_P #0#0, 1, 1962; eaDefeArti = eaArticulo; |FINSI;
     |SI PARAMETRO = "RE"; |C_P #0#0, 1, 1165; eaDefeArti = eaArticulo; |FINSI;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          eaMatri = #0#0;
     |FINSI;
|FPRO;
