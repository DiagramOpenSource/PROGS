|FICHEROS;
   coima001 #7;        ||Parametros Coimasa
   coiply01 #0;

   coiplm01 #1;
   coiplm02 #2;
   coiplm03 #3;
   coiplm04 #4;

   agifa024 #24;
   agifa019 #19;
|FIN;

|VARIABLES;
   aParametro = "";
   nNumero = 0;

   &eaArtIdioma = "";
   &eaCodArtIdioma = "";
   &descrip = "";

   aMensaje = "";

   &eaDoc = "";
   &Cod1  = ""; &Des1  = ""; &Unid1 = 0;
   &Cod2  = ""; &Des2  = ""; &Unid2 = 0;
   &Cod3  = ""; &Des3  = ""; &Unid3 = 0;
   &Cod4  = ""; &Des4  = ""; &Unid4 = 0;
   &Cod5Elem  = "";
   &Cant5Elem = "";

   &SwLinPaq  = 0;
   &SwLinArt  = 0;
   &SwLin5Ele = 0;
   aInforme   = "coiply01";
|FIN;

|PROCESO Det5Elem;
   Cod5Elem = Cod5Elem + "[" + (#coiplm04#3 % 0104) + "] ";
   Cant5Elem = Cant5Elem + "[" + (("0000" + #coiplm04#4) % -104) + "] ";
|FPRC;

|DEFBUCLE Det5Elem;
#coiplm04#1;
;
#coiplm03#0, #coiplm03#1, #coiplm03#2, "      ";
#coiplm03#0, #coiplm03#1, #coiplm03#2, "zzzzzz";
be;
NULL,Det5Elem;
|FIN;

|PROCESO DetArticulos;
   Cod5Elem = "";
   Cant5Elem = "";
   |SI #coiplm03#5 = "S";
      |BUCLE Det5Elem;
   |FINSI;

   |DDEFECTO #agifa019;
   #agifa019#0 = #coiplm03#4;
   |LEE 000#agifa019.=;
   descrip = #agifa019#1;

   eaCodArtIdioma = #coiplm03#4;
   eaArtIdioma = "";
   |HAZ IdiomaPedidoCoimasa;
   |SI eaArtIdioma ! "";
         descrip = eaArtIdioma;
   |FINSI;

   SwLinArt = 1; |PRINT; SwLinArt = 0;
|FPRC;

|DEFBUCLE DetArticulos;
#coiplm03#1;
;
#coiplm02#0,#coiplm02#1,001;
#coiplm02#0,#coiplm02#1,999;
be;
NULL,DetArticulos;
|FIN;

|PROCESO DetPaquetes;
   |DDEFECTO #agifa024;
   #agifa024#0 = #coiplm01#27;
   |LEE 000#agifa024.=;

   SwLinPaq = 1; |PRINT; SwLinPaq = 0;
   |BUCLE DetArticulos;
|FPRC;

|DEFBUCLE DetPaquetes;
#coiplm02#1;
;
#coiplm01#0,001;
#coiplm01#0,999;
be;
NULL,DetPaquetes;
|FIN;

|PROCESO Emision;
   eaDoc = "PL" + "     " + #1#0;
   |HAZ PackListVar;

   |INFOR aInforme;
   |SI FSalida ! 0;
        aMensaje = "0000Informe " + aInforme + " inaccesible.";
        |MENAV aMensaje;
        |ACABA;
   |FINSI;
   Cod1  = ""; Des1  = ""; Unid1 = 0;
   Cod2  = ""; Des2  = ""; Unid2 = 0;
   Cod3  = ""; Des3  = ""; Unid3 = 0;
   Cod4  = ""; Des4  = ""; Unid4 = 0;

   |ABRE #agifa024;
   |ABRE #agifa019;
   |BUCLE DetPaquetes;
   |CIERRA #agifa019;
   |CIERRA #agifa024;
   |PIEINF;
   |FININF;
|FPRC;

|DEFBUCLE Emision;
#coiplm01#1;
1,27;
#coiply01#0,#coiply01#1,#coiply01#2;
#coiply01#3,#coiply01#4,#coiply01#5;
be;
NULL,Emision;
|FIN;

|PROGRAMA;
   |ABRE #7; |LEE 000#7p; |CIERRA #7;
   aInforme = #7#30; |QBF aInforme;

   aParametro = PARAMETRO;
   |QBF aParametro;
   |SI aParametro ! "";
      nNumero = aParametro;
      |DDEFECTO #0;
      #0#0 = nNumero;
      #0#3 = nNumero;
      Impresora = "CrystalReport";
      |IMPRE -1;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |BUCLE Emision;
      |FINIMP;
   |SINO;
      |CLS;
      |CABEZA "Emision de packing list";
      |PINPA #0#0; |PINDA #0#0;
      |ENDATOS #1#0;
      |SI FSalida = 0;
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
         |BUCLE Emision;
         |FINIMP;
      |FINSI;
   |FINSI;
|FPRO;
