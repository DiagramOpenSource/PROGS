|FICHEROS;
     conz0019 #0;
     agifa007 #7;
     con00008 #8;
     agifa041 #41;
     agifa142 #142;
     referen@;
|FIN;

|VARIABLES;
     nTecla = 0;
     &Tempo = "";
     {-1}aMenu = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "Opciones: ";
     aMenu4 = "RAC";
     aMenu5 = " Revisar ";
     aMenu6 = " Aceptar ";
     aMenu7 = " Cancelar ";
     aAlfa = "";
     nModo = 0;
     nCalc = 0;
     nCalc1 = 0;
|FIN;

|PROCESO Secciones;
     #8#5 = #0#3;
     #8#3 = #0#4;
     #8#8 = #0#5;
     |BORRA 000#8c;
     |GRABA 000#8n;
|FPRC;

|DEFBUCLE Secciones;
     #8#1;
     3, 8;
     #0#0, 0, 000, #0#1, #0#2;
     #0#0, 9, 999, #0#1, #0#2;
     ;
     NULL, Secciones;
|FIN;

|PROCESO Tmp;
     aAlfa = #0#3; |QBF aAlfa;
     |SI aAlfa ! "";
          |BUCLE Secciones;
     |FINSI;
|FPRC;

|DEFBUCLE Tmp;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Tmp;
|FIN;

|PROCESO Empresa11; |TIPO 11;
     |HAZ Empresa;
|FPRC;

|PROCESO Empresa; |TIPO 0;
     nTecla = FSalida;
     aAlfa = #142#151; |QBF aAlfa;
     aAlfa = aAlfa + "def/canempre.mas";
     |CARGA_DEF aAlfa, referen@;
     |SI FSalida = 0;
          |ABRE #referen@;
          aAlfa = #142#151; |QBF aAlfa;
          aAlfa = aAlfa + "fich/"; |QBF aAlfa; |PATH_DAT #referen@#aAlfa#;
          |SI nTecla = 10;
               |LEE 000#referen@.];
               |CONSULTA_CLAVE #1#referen@;
               |SI FSalida = 0;
                    aAlfa = (("00000" + #referen@#2) % -105) + #referen@#3;
                    #0#Campo# = aAlfa; |PINTA #0#Campo#;
               |FINSI;
               |ERROR;
          |SINO;
               |SI Campo ] 4; |Y #0#Campo# > 0;
                    nCalc = #0#Campo#;
                    nCalc1 = ((nCalc / 10) - 0.49) ! 0;
                    #referen@#2 = nCalc1;
                    nCalc1 = nCalc - (nCalc1 * 10);
                    #referen@#3 = nCalc1;
                    |LEE 000#referen@.=;
                    |SI FSalida ! 0;
                         |MENAV "    Empresa contable inexistente"; |ERROR;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #referen@; |DESCARGA_DEF #referen@;
     |FINSI;
|FPRC;

|PROCESO Serie; |TIPO 0;
     |ABRE #7;
     #7#26 = #0#3;
     |LEE 000#7=;
     |SI FSalida = 0;
          #0#7 = #7#27; |PINTA #0#7;
     |SINO;
          |MENAV "0000Serie inexistente...";
          |ERROR;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO NoAlta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |AVISO; |ERROR;
     |FINSI;
|FPRC;

|PROCESO con00008;
     #7#26 = #8#5;
     |LEE 000#7=;
     |SI FSalida ! 0; |DDEFECTO #7; |FINSI;

     #0#0 = #8#5;
     #0#1 = #8#3;
     #0#2 = #8#8;
     #0#6 = #7#27;
     |GRABA 000#0n;
|FPRC;

|DEFBUCLE con00008;
     #8#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, con00008;
|FIN;

|PROCESO Min;
     #0#0 = "     ";
     #0#1 = 000000;
     #0#2 = 000000;
|FPRC;

|PROCESO Max;
     #0#0 = "zzzzz";
     #0#1 = 999999;
     #0#2 = 999999;
|FPRC;

|PROGRAMA;
     |ABRE #142; |LEE 000#142p; |CIERRA #142;

     |HAZ CreaTempo;
     |NOME_DAT #0 Tempo; |DELINDEX #0;

     |ABRE #0;
     |ABRE #7;
     |BUCLE con00008;
     |CIERRA #7;
     |CIERRA #0;

     |PINPA #0#0;
     |PARA; |SI aMenu2 = 1; |HACIENDO;
          |ENTLINEAL #1#0, 1, 2, 22, 0, Min, Max;
          |MENU aMenu;
          aMenu2 = FSalida;
     |SIGUE;
     |SI aMenu2 = 2; |BUCLE Tmp; |FINSI;
|FPRO;
