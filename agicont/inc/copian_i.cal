|FICHEROS;
  cacuenta #6;    || plan contable
  camandia #18;   || diarios
  caexistl #19;   || descarga lins.
  caportad #21;   || portadas
  caplciec #32;   || Planilla de Cierre
  camautoc #33;   || Cabecera Asientos Automaticos

  camandep;
|FIN;

|VARIABLES;
    &SwAmort   = 0;
    &fich_copi = "";
    traba      = "";
    traba1     = "";
    temporal1  = "";
    temporal2  = "";
    &num_por1  = 0;
    &num_por   = 0;
    &any_por1  = 0;
    &any_por   = 0;
    swprogra   = 0;

    Comodin  = "";
    Comodin1 = "";
    Comodin2 = "";
    Comodin3 = "";
    Comodin4 = "";
    Calc     = 0;
    nCont    = 0;

|FIN;

*****************************************************************************

|PROCESO InitSeries;
   #Referen1@#3 = 1;
   |GRABA 020#Referen1@.a; |LIBERA #Referen1@;
|FPRC;

|DEFBUCLE InitSeries;
#Referen1@#1002;
;
"  "," ";
"zz","z";
be;
NULL,InitSeries;
|FIN;

|PROCESO InitLibros;
   #Referen2@#4 = 1;
   |GRABA 020#Referen2@.a; |LIBERA #Referen2@;
|FPRC;

|DEFBUCLE InitLibros;
#Referen2@#1001;
;
00;
99;
be;
NULL,InitLibros;
|FIN;

|PROCESO InitConts;
   |DBASE Comodin1;
   Comodin3 = Comodin1 + "def/caivases.mas";
   Comodin4 = Comodin1 + "def/calibros.mas";
   |CARGA_DEF Comodin3, Referen1@;
   |SI FSalida = 0;
      |CARGA_DEF Comodin4, Referen2@;
      |PATH_DAT #600 fich_alta; |PATH_DAT #601 fich_alta;
      |ABRE #Referen1@; |ABRE #Referen2@;
      |BUCLE InitSeries;
      |BUCLE InitLibros;
      |CIERRA #Referen2@; |DESCARGA_DEF #Referen2@;
      |CIERRA #Referen1@; |DESCARGA_DEF #Referen1@;
   |FINSI;
|FPRC;

|PROCESO copia_maes;  .......................  .... Solo copia Maestros
  |SI eSwC2008 = 0;
      traba1 = "caagrupa";  |HAZ copiando;    ||  1 agrupaciones
      traba1 = "cacuebal";  |HAZ copiando;    ||  7 cuentas balance
      traba1 = "cacuesig";  |HAZ copiando;    ||  9 cuentas balance segun Signo
      traba1 = "caepigra";  |HAZ copiando;    || 10 epigrafes
      traba1 = "caparbal";  |HAZ copiando;    || 18 partidas de balance
      traba1 = "caparexp";  |HAZ copiando;    || 19 partidas de explotacion
      traba1 = "cacuenta";  |HAZ copiando;    ||  8 plan contable
  |FINSI;

  traba1 = "caclipro";  |HAZ copiando;    ||  2 clientes/proveedores
  traba1 = "cacoivca";  |HAZ copiando;    ||  3 contrap.iva cabs.
  traba1 = "cacoivli";  |HAZ copiando;    ||  4 contrap.iva lins.
  traba1 = "caconcep";  |HAZ copiando;    ||  5 conceptos
  traba1 = "caconcyp";  |HAZ copiando;    ||  6 control cobros/pagos
  traba1 = "caexistc";  |HAZ copiando;    || 11 descarga cabs.
  traba1 = "caexistl";  |HAZ copiando;    || 12 descarga lins.
  traba1 = "caformul";  |HAZ copiando;    || 13 formulas de ratios
  traba1 = "calibros";  |HAZ copiando;    || 14 libros
  traba1 = "caivases";  |HAZ copiando;    || 14.5 Series
  traba1 = "camanban";  |HAZ copiando;    || 15 bancos
  traba1 = "camandia";  |HAZ copiando;    || 16 diarios
  traba1 = "camanrec";  |HAZ copiando;    || 17 tipos de recibos
  traba1 = "caprovin";  |HAZ copiando;    || 20 provincias
  traba1 = "casieaca";  |HAZ copiando;    || 21 predef. cabs.
  traba1 = "casieali";  |HAZ copiando;    || 22 predef. lins.
  traba1 = "casiegru";  |HAZ copiando;    || 23 grupos predef.
  traba1 = "casiesub";  |HAZ copiando;    || 24 subgrupos predef.
  traba1 = "caexttip";  |HAZ copiando;    || 25 tipo anotaciones
  traba1 = "caivaasi";  |HAZ copiando;    || 26 control entrada iva
  traba1 = "cacuivca";  |HAZ copiando;    || 27 cuentas iva cabs.
  traba1 = "cacuivli";  |HAZ copiando;    || 28 cuentas iva lins.
  traba1 = "camocabe";  |HAZ copiando;    || 29 amortiz. cabs.
  traba1 = "camoline";  |HAZ copiando;    || 30 amortiz. lins.

  traba1 = "camogrup";  |HAZ copiando;    || 31 grupos amortizacion
  traba1 = "caforpag";  |HAZ copiando;    || 32 formas de pago
  traba1 = "cacon300";  |HAZ copiando;    || 33 conceptos 300
  traba1 = "caportad";  |HAZ copiando;    || 34 datos portadas modelos
  traba1 = "cacup130";  |HAZ copiando;    || 35 control Asiento 130
  traba1 = "cacup202";  |HAZ copiando;    || 36 control Asiento 202
  traba1 = "cacup300";  |HAZ copiando;    || 37 control Asiento 300
  traba1 = "cacupimp";  |HAZ copiando;    || 38 control Asiento Imp.Soc.
  traba1 = "caplctac";  |HAZ copiando;    || 39 Cuentas a Mod. 130 y libros (cab)
  traba1 = "caplctal";  |HAZ copiando;    || 40 Cuentas a Mod. 130 y libros (lin)
  traba1 = "caiva300";  |HAZ copiando;    || 41 Control IVA 300
  traba1 = "capagaux";  |HAZ copiando;    || 42 Datos Auxiliares Pagares
  traba1 = "cacuadre";  |HAZ copiando;    || 43 Configuracion cuadres
  traba1 = "caconimp";  |HAZ copiando;    || 44 Tipo de impresos
  traba1 = "caxcontr";  |HAZ copiando;    || 45 Control traspasos externos
  traba1 = "impfich";   |HAZ copiando;    || 46 Control directorios pases
  traba1 = "capas347";  |HAZ copiando;    || 47 conceptos 347
  traba1 = "cacongru";  |HAZ copiando;    || 48 Grupos de conceptos
  traba1 = "cagruiva";  |HAZ copiando;    || 49 Grupos de Facturas Englobadas
  traba1 = "caconlib";  |HAZ copiando;    || 50 Columnas Libros Igresos/Gastos

  traba1 = "camoauxc";  |HAZ copiando;    || 51 Desglose cuentas
  traba1 = "camoauxl";  |HAZ copiando;    || 52 Desglose cuentas
  traba1 = "capas349";  |HAZ copiando;    || 53 Pase Conceptos 349

  traba1 = "caagrupr";  |HAZ copiando;    || 54 Agrupaciones Presupuestarias
  traba1 = "cared001";  |HAZ copiando;    || 55 Datos Secuencial Norma 58.

  traba1 = "caplciec";  |HAZ copiando;    || 56 Datos Planilla Cierre Cabs
  traba1 = "caplciel";  |HAZ copiando;    || 57 Datos Planilla Cierre Lins

  traba1 = "calendar";  |HAZ copiando;    || 58 Calendario
  traba1 = "cacalend";  |HAZ copiando;    || 59

  traba1 = "caredm01";  |HAZ copiando;    || 60 Datos Secuencial Norma 34.
  traba1 = "cacap115";  |HAZ copiando;    || 61 Pase Conceptos 115

  traba1 = "camautoc";  |HAZ copiando;    || 62 Astos Automaticos C
  traba1 = "camautol";  |HAZ copiando;    || 63 Astos Automaticos L
  traba1 = "camautti";  |HAZ copiando;    || 64 Tipos Astos Automaticos

  traba1 = "carepres";  |HAZ copiando;    || 65 Representantes

  traba1 = "caemrctx";  |HAZ copiando;    || 66 Parametros emision Carta
  traba1 = "carctxcb";  |HAZ copiando;    || 67  Cabecera Carta
  traba1 = "carctxpi";  |HAZ copiando;    || 68  Pie Carta

  traba1 = "n19datos";  |HAZ copiando;    || 69 Datos Sec. Norma 19
  traba1 = "n19sepam";  |HAZ copiando;    || 70 Datos Sec. Norma SEPA
  traba1 = "n34sepam";  |HAZ copiando;    || 71 Datos Sec. Norma 34 SEPA

  traba1 = "casiim03";  |HAZ copiando;    || 71 Datos Sec. Norma 34 SEPA

 |HAZ InitConts;
|FPRC;

|PROCESO acumulados6;
  #33#7 = "";
  #33#8 = "";
  #33#9 = "";
  |GRABA 020#33a;
  |LIBERA #33;
|FPRC;

|DEFBUCLE acerar6;
  #33#1;
  ;
  00001;
  99999;
  be;
  NULL, acumulados6;
|FIN;

|PROCESO Duplico_dep;
  #camandep#0 = num_por;
  |GRABA 000#camandep.n;
|FPRC;

|DEFBUCLE Duplico_dep;
  #camandep#1;
  ;
  num_por1, "  ";
  num_por1, "zz";
  e;
  NULL, Duplico_dep;
|FIN;

|PROCESO acerar4;

  |SI num_por1 ! num_por;
      |BUCLE Duplico_dep;
  |FINSI;

  |SI num_por1 ! num_por; |O any_por1 ! any_por;
      |PATH_DAT #21 fich_alta;
      |ABRE #21;
      #21#0 = num_por1;
      #21#1 = any_por1;
      |LEE 000#21=;
      |SI FSalida = 0;
          #21#0 = num_por;
          #21#1 = any_por;
          |GRABA 000#21n;
      |FINSI;
      |CIERRA #21;
  |FINSI;
|FPRC;

|PROCESO acumulados5;
  #32#2 = 0;
  |GRABA 020#32a;
  |LIBERA #32;
|FPRC;

|DEFBUCLE acerar5;
 #32#1;
 ;
  0;
 99;
 be;
 NULL, acumulados5;
|FIN;

|PROCESO acumulados3;
  |PDEFECTO #19,11,25;
  |GRABA 020#19a;
  |LIBERA #19;
|FPRC;

|DEFBUCLE acerar3;
 #19#1;
 ;
  0,  0;
 99, 99;
 be;
 NULL, acumulados3;
|FIN;

|PROCESO acumulados2;
  #18#2 = 0;
  #18#3 = 0;
  |GRABA 020#18a;
  |LIBERA #18;
|FPRC;

|DEFBUCLE acerar2;
 #18#1;
 ;
  0;
 99;
 be;
 NULL, acumulados2;
|FIN;

|PROCESO acumulados1;
  |PDEFECTO #6,9,54;
  #6#58 ="01.01.1900";
  |GRABA 020#6a;
  |LIBERA #6;
|FPRC;

|DEFBUCLE acerar1;
 #6#1;
 ;
 "            ", 0;
 "zzzzzzzzzzzz", 9;
 be;
 NULL, acumulados1;
|FIN;

|PROCESO pone0_maes;
  traba = " PONIENDO A CERO PLAN CONTABLE Y DIARIOS ...    ";
  |SI swprogra = 0; |PINTA 2301, traba; |FINSI;
  |SI swprogra = 1; |PINTA 2211, traba; |FINSI;

  |PATH_DAT #06 fich_alta;
  |PATH_DAT #18 fich_alta;
  |PATH_DAT #19 fich_alta;
  |PATH_DAT #32 fich_alta;
  |PATH_DAT #33 fich_alta;

  |BUCLE acerar1;          || cuentas
  |BUCLE acerar2;          || diarios
  |BUCLE acerar3;          || existencias
  |BUCLE acerar5;          || borra planillas Cierre
  |BUCLE acerar6;          || borra Cabecera Astos Automaticos
|FPRC;

|PROCESO copiando;
  traba = " COPIANDO FICHERO: " + traba1 + "        ";

  |SI swprogra = 0; |PINTA 2301, traba; |FINSI;
  |SI swprogra = 1; |PINTA 2211, traba; |FINSI;

  temporal1 = fich_copi + traba1 + ".ixx";
  temporal2 = fich_alta + traba1 + ".ixx";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  temporal1 = fich_copi + traba1 + ".dat";
  temporal2 = fich_alta + traba1 + ".dat";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;
      temporal2 = fich_alta + traba1 + ".ixx";
      |FBORRA temporal2;
      |ACABA;
  |FINSI;
  temporal1 = fich_copi + traba1 + ".ddx";
  temporal2 = fich_alta + traba1 + ".ddx";
  |COPIA_FICHERO temporal1,temporal2;
|FPRC;
