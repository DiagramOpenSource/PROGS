|FICHEROS;
     cacuenta #69;
     canempre #30;

     ca8cumay #403;
|FIN;

|VARIABLES;
    p_mensa1 = "0000LONGITUD DE CUENTA FUERA DE NIVEL!";
    p_mensa2 = "0000No Existe Cuenta Contable ";
    p_mensa3 = "0000Esta Cuenta NO tiene Pase Directo.";

    aLong     = "";
    nLong     = 0;
    &dig3     = 0;
    &dig4     = 0;
    &dig5     = 0;
    &dig6     = 0;
    &dig7     = 0;
    &dig8     = 0;
    &dig9     = 0;
    &eNum2008 = 0;
    &enEjerBal = 0;

    aAlfa1    = "";
    nNume1    = 0;
    nNume     = 0;
    aCuenta   = "";

|FIN;

|INCLUYE varnue_i;

|PROCESO eLeeCuenta; |TIPO 0;
   eswCta = 0;
   eaNomCta = "";
   |ABRE #69;
   #69#0 = eaCuenta;
   #69#1 = enNivel;
   |LEE 001#69=;
   |SI FSalida ! 0;
       eswCta = 1;
       |SI emCta = 1;
           |MENAV p_mensa2;
           |ERROR;
       |FINSI;
       |CIERRA #69;
       |ACABA;
   |FINSI;
   |CIERRA #69;

   |SI eaCuenta ! "            ";
      |SI #69#3 = "N";
          eswCta = 2;
          |SI emCta = 1;
              |MENAV p_mensa3;
              |ERROR;
          |FINSI;
      |FINSI;
   |FINSI;
   eaNomCta = #69#2;
|FPRC;

|PROCESO eSacaNivel;
   eswCta = 1;     ||Errores en Cuenta
   aLong = eaCuenta;
   |QBF aLong;
   aLong = aLong % 0;
   nLong = aLong;
   enNivel = 0;
   |SI nLong = dig4; |Y dig4 ! 0; eswCta = 0; enNivel = 1; |FINSI;
   |SI nLong = dig5; |Y dig5 ! 0; eswCta = 0; enNivel = 2; |FINSI;
   |SI nLong = dig6; |Y dig6 ! 0; eswCta = 0; enNivel = 3; |FINSI;
   |SI nLong = dig7; |Y dig7 ! 0; eswCta = 0; enNivel = 4; |FINSI;
   |SI nLong = dig8; |Y dig8 ! 0; eswCta = 0; enNivel = 5; |FINSI;
   |SI nLong = dig9; |Y dig9 ! 0; eswCta = 0; enNivel = 6; |FINSI;

   |SI eswCta = 1; |Y  nLong ! 0;
       |SI emCta = 1;
           |MENAV p_mensa1;
           |ERROR;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO eVarEmpresa;
   |SI #canempre#26 < 80;
        enEjercicio = 2000 + #canempre#26;
   |SINO;
        enEjercicio = 1900 + #canempre#26;
   |FINSI;
   eaNombreEmp = #canempre#1;
   eaNifEmp    = #canempre#8;
|FPRC;

|PROCESO eLeeCtaMayor;
   eaNomCtaSup = "";
   aAlfa1 = eaCuenta % 105;
   |ABRE #403;
   #403#12 = enEjerBal;
   #403#10 = eNum2008;
   #403#0  = aAlfa1;
   |LEE 040#403=;
   |SI FSalida = 0;
       eaNomCtaSup = #403#9;
   |FINSI;
   |CIERRA #403;
|FPRC;
