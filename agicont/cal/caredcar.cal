|FICHEROS;
   caredcar #0;

   camingca #1;
   camingli #2;
|FIN;

|VARIABLES;
   &FecLetra = "";
   &CLetra1  = "";
   &CLetra2  = "";
   &CLetra3  = "";
   &Fecha    = @;

   Caracter  = "";
   Comodin   = "";
   Comodin1  = "";
   aLong     = "";

   nLong     = 0;
   nCont     = 0;
   Calc      = 0;
   &EURODB   = 0;
|FIN;

|PROCESO MesLetra;
   |SI Comodin1 = "01"; Comodin1 = "Enero     "; |FINSI;
   |SI Comodin1 = "02"; Comodin1 = "Febrero   "; |FINSI;
   |SI Comodin1 = "03"; Comodin1 = "Marzo     "; |FINSI;
   |SI Comodin1 = "04"; Comodin1 = "Abril     "; |FINSI;
   |SI Comodin1 = "05"; Comodin1 = "Mayo      "; |FINSI;
   |SI Comodin1 = "06"; Comodin1 = "Junio     "; |FINSI;
   |SI Comodin1 = "07"; Comodin1 = "Julio     "; |FINSI;
   |SI Comodin1 = "08"; Comodin1 = "Agosto    "; |FINSI;
   |SI Comodin1 = "09"; Comodin1 = "Septiembre"; |FINSI;
   |SI Comodin1 = "10"; Comodin1 = "Octubre   "; |FINSI;
   |SI Comodin1 = "11"; Comodin1 = "Noviembre "; |FINSI;
   |SI Comodin1 = "12"; Comodin1 = "Diciembre "; |FINSI;
   |QBF Comodin1;
|FPRC;

|PROCESO Dividelo;
   |QBF Comodin; aLong = Comodin % 0; nLong = aLong;
   |SI nLong > 67;
      |PARA nCont = nLong; |SI nCont > 0; |HACIENDO nCont = nCont - 1;
         Calc = (nCont * 100) + 1;
         Caracter = Comodin % Calc;
         |SI Caracter = " ";
            Calc = (nCont * 100) + 99; Comodin1 = Comodin % Calc;
            Calc = 100 + nCont;        Comodin  = Comodin % Calc;
            |QBF Comodin; aLong = Comodin % 0; nLong = aLong; nLong = 67 - nLong;
            Comodin  = Comodin + ("-" * nLong);
            |QBF Comodin1; aLong = Comodin1 % 0; nLong = aLong; nLong = 67 - nLong;
            Comodin1 = Comodin1 + ("-" * nLong);
            |SAL;
         |FINSI;
      |SIGUE;
   |SINO;
      nLong = 67 - nLong;
      Comodin1 = "-" * nLong; Comodin = Comodin + Comodin1;
      Comodin1 = "-" * 67;
   |FINSI;
|FPRC;

|PROCESO Lineas;
   |PRINT;
|FPRC;

|DEFBUCLE Lineas;
#camingli#1;
;
#camingca#0,001;
#camingca#0,999;
;
NULL,Lineas;
|FIN;

|PROCESO Confirmes;
   CLetra3 = "Ptas. ";
   Fecha = #caredcar#4;
   Comodin = Fecha; Comodin1 = Comodin % 0402; |HAZ MesLetra;
   Comodin1 = (Comodin % 0102) + " de " + Comodin1 + " de " + (Comodin % -104);
   FecLetra = Comodin1;
   Comodin = #camingca#9; |QBF Comodin;
   |SI EURODB ! 0;
       CLetra3 = "Euros.";
       Comodin = "E" + Comodin;
   |FINSI;
   |LETRA Comodin;
   |HAZ Dividelo;
   CLetra1 = Comodin; CLetra2 = Comodin1;

   |INFOR "caredca1";
   |SI FSalida ! 0; |ACABA; |FINSI;
   |PRINT;
   |PIEINF;
   |FININF;

   |INFOR "caredca2";
   |SI FSalida ! 0; |ACABA; |FINSI;
   |BUCLE Lineas;
   |PIEINF;
   |FININF;

|FPRC;

|DEFBUCLE Confirmes;
#camingca#1;
1;
#caredcar#0, #caredcar#2;
#caredcar#1, #caredcar#3;
;
NULL,Confirmes;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA "Emision de cartas a banco";
   |PINPA #0#caredcar; |PINDA #0#caredcar;
   |ENDATOS #1#caredcar;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida ! 0; |MENAV "    Proceso abortado"; |ACABA; |FINSI;
      |BUCLE Confirmes;
      |FINIMP;
   |FINSI;
|FPRO;
