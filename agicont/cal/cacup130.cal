|FICHEROS;
  cacup130 #0;
  cacuenta #1;
  caconcep #2;
  camandia #3;
|FIN;

|VARIABLES;
  &entrada = 1;
  salidas = 0;
  cta_t = 0;
  dig_t = 0;
  alfa1 = "";
  alfa2 = "";
  long = 0;
  sw = 0;
  nopintes = 0;
  x = 0;
  y = 0;
  z = 0;
|FIN;

|INCLUYE inici1_i;
|INCLUYE puntos_i;

|PROCESO mayor11;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;

|PROCESO diario;
  |ABRE #3;
  #3#0 = #0#45;
  |LEE 000#3=;
  #0#46 = #3#1;
  |SI nopintes = 0;
      |PINTA #0#46;
  |FINSI;
  |CIERRA #3;
|FPRC;


|PROCESO cuefin;
  cta_t = Campo;
  dig_t = Campo + 11;
  #1#0 = #0cta_t
  #1#1 = #0dig_t;
  |LEE 001#1=;
  |SI FSalida ! 0;  |ERROR;  |ACABA;  |FINSI;
  |SI #1#3 = "N";
      |MENAV "     La Cuenta NO tiene PASE DIRECTO";
      |ERROR;
      |ACABA;
  |FINSI;
  x = Campo + 22;
  y = Campo + 33;
  z = Campo + 46;
  |SI #0Campo = "            ";
      |CAMPO_MODIFICA #0x,1,"N";
      #0y = "";
      |PINTA #0y;
      |CAMPO_MODIFICA #0y,1,"N";
      |CAMPO_MODIFICA #0z,1,"N";
  |SINO;
      |CAMPO_MODIFICA #0x,1,"S";
      |CAMPO_MODIFICA #0y,1,"S";
      |CAMPO_MODIFICA #0z,1,"S";
  |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;
      |MENAV "     ERROR EN CUENTA";
      |ERROR;
      |ACABA;
  |FINSI;
  cta_t = Campo;
  dig_t = cta_t + 11;
  |HAZ cuenta_t;
|FPRC;


|PROCESO cuenta_t;
  alfa1 = #0cta_t;
  |QBF alfa1;
  alfa2 = alfa1 % 0;
  long = alfa2;
  sw = 0;
  |SI long = dig4;  sw = 1;  #0dig_t = 1;  |FINSI;
  |SI long = dig5;  sw = 1;  #0dig_t = 2;  |FINSI;
  |SI long = dig6;  sw = 1;  #0dig_t = 3;  |FINSI;
  |SI long = dig7;  sw = 1;  #0dig_t = 4;  |FINSI;
  |SI long = dig8;  sw = 1;  #0dig_t = 5;  |FINSI;
  |SI long = dig9;  sw = 1;  #0dig_t = 6;  |FINSI;
  |SI long = 0;     sw = 1;  #0dig_t = 0;  |FINSI;
  |SI sw = 0;
      #0dig_t = 0;
      |MENAV "      Longitud de Cuenta Fuera de Nivel ";
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO altapase;
  Campo = 1;
/* ------------------------------------------------------------------
  #0#1 = "477.";
  p_alfa1 = #0#1;
  salidas = FSalida;
  |HAZ punto;
  cta_t = 1;
  dig_t = 12;
  |HAZ cuenta_t;
  Campo = 3;
  #0#3 = "472.";
  p_alfa1 = #0#3;
  salidas = FSalida;
  |HAZ punto;
  cta_t = 3;
  dig_t = 14;
  |HAZ cuenta_t;
  Campo = 10;
  #0#10 = "470.";
  p_alfa1 = #0#10;
  salidas = FSalida;
  |HAZ punto;
  cta_t = 10;
  dig_t = 21;
  |HAZ cuenta_t;
  Campo = 11;
  #0#11 = "4750.";
  p_alfa1 = #0#11;
  salidas = FSalida;
  |HAZ punto;
  cta_t = 11;
  dig_t = 22;
  |HAZ cuenta_t;
*/
  #0#45 = 1;
  nopintes = 1;
  |HAZ diario;
  nopintes = 0;
|FPRC;

|PROCESO leeconce;
  #2#0 = #0Campo;
  |LEE 000#2=;
  x = Campo + 11;
  #0x = #2#1;
  |PINTA #0x;
|FPRC;

|PROCESO descripci;
  x = Campo - 33;
  |SI #0x = "            ";
      #0Campo = "";
      |PINTA #0Campo;
  |FINSI;
|FPRC;

|PROGRAMA;
  entrada = 1;
  |HAZ comienzo;
  |CLS;
  |PINPA #0#0;
  |CABEZA "Cuentas Asto Mod.130";
  |ABRE #0;
  |ABRET #1;
  |ABRET #2;
  #0#0 = 1;
  |LEE 000#0=;
  |SI FSalida ! 0;
      |DDEFECTO #0;
      |HAZ altapase;
      #0#0 = 1;
      |GRABA 020#0c;
  |FINSI;
  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0;
      #0#0 = 1;
      |GRABA 020#0a;
  |FINSI;
  |CIERRA #0;
  |CIERRAT #1;
  |CIERRAT #2;
|FPRO;
