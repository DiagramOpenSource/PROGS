|FICHEROS;
     cacom110 #00;
     caman110 #20;
|FIN;

|VARIABLES;
    informe   = "cacom110";
    p_mes     = "";
    fecsys    = @;
    alfa1     = "";
    sw        = 0;
    desdemes  = 0;
    hastames  = 0;
    meses     = 0;
    campotB   = 0;
    campotR   = 0;
    campobas  = 0;
    camporet  = 0;
    camposso  = 0;
    nPara     = 0;

    &perialf  = "";
    &enSwLin  = 0;
    &n1       = 0;
    &n2       = 0;
    &enMod    = 0;
|FIN;

|INCLUYE acceso_i;

|| ****************************************************************
|PROCESO Mayus; |TIPO 0;
  #0Campo = #0Campo > #0Campo; |PINTA #0Campo;
|FPRC;

|PROCESO defecto; |TIPO 7;
  #0#0   = cod1;       |PINTA #0#0;
  #0#1   = #30#1;      |PINTA #0#1;
  #0#2   = #30#26;     |PINTA #0#2;
|FPRC;

|PROCESO pintames; |TIPO 0;
  |SI #0Campo =  1;  p_mes = "1§ Trimestre";  |FINSI;
  |SI #0Campo =  2;  p_mes = "2§ Trimestre";  |FINSI;
  |SI #0Campo =  3;  p_mes = "3§ Trimestre";  |FINSI;
  |SI #0Campo =  4;  p_mes = "4§ Trimestre";  |FINSI;
  |ATRI S; |PINTA 1539, p_mes; |ATRI 0;
|FPRC;

|PROCESO mirames; |TIPO 7; ||calcula el mes por defecto segun fecha sistema
  fecsys = ~;
  alfa1 = fecsys;
  alfa1 = alfa1 % 402;
  |SI alfa1 = "01"; #0Campo = 1; |FINSI;
  |SI alfa1 = "02"; #0Campo = 1; |FINSI;
  |SI alfa1 = "03"; #0Campo = 1; |FINSI;
  |SI alfa1 = "04"; #0Campo = 2; |FINSI;
  |SI alfa1 = "05"; #0Campo = 2; |FINSI;
  |SI alfa1 = "06"; #0Campo = 2; |FINSI;
  |SI alfa1 = "07"; #0Campo = 3; |FINSI;
  |SI alfa1 = "08"; #0Campo = 3; |FINSI;
  |SI alfa1 = "09"; #0Campo = 3; |FINSI;
  |SI alfa1 = "10"; #0Campo = 4; |FINSI;
  |SI alfa1 = "11"; #0Campo = 4; |FINSI;
  |SI alfa1 = "12"; #0Campo = 4; |FINSI;
  |PINTA #0Campo;
|FPRC;

|| ****************************************************************
|| **** calculos de lectura de empresa ****************************
|| ****************************************************************

|PROCESO a_imprimir;
  sw = 1;

  |PDEFECTO #0,7,20;

  |PARA meses = desdemes; |SI meses [ hastames;  |HACIENDO meses = meses + 1;

        campobas = meses + 22;
        camporet = meses + 35;
        campotB = 0;
        |SI #20#12 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#12 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#12 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#12 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI #20#12 = "A"; campotB = 16; campotR = 17; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;

        campobas = meses +  48;
        camporet = meses +  61;
        campotB = 0;
        |SI #20#13 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#13 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#13 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#13 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI #20#13 = "A"; campotB = 16; campotR = 17; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;

        campobas = meses +  74;
        camporet = meses +  87;
        campotB = 0;
        |SI #20#14 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#14 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#14 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#14 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI #20#14 = "A"; campotB = 16; campotR = 17; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;

        campobas = meses +  100;
        camposso = meses +  113;
        #0#18    = #0#18 + #20campobas;
        #0#19    = #0#19 + #20camposso;

  |SIGUE;

  #0#15 = #0#8 + #0#10 + #0#12 + #0#14 + #0#17;

  enSwLin = 0;
  |PARA nPara = 1; |SI nPara [ 5; |HACIENDO nPara = nPara + 1;
        |SI nPara = 1; #0#22 = "A"; #0#20 = #0#16; #0#21 = #0#17; |FINSI;
        |SI nPara = 2; #0#22 = "G"; #0#20 = #0#7;  #0#21 = #0#8;  |FINSI;
        |SI nPara = 3; #0#22 = "H"; #0#20 = #0#9;  #0#21 = #0#10; |FINSI;
        |SI nPara = 4; #0#22 = "K"; #0#20 = #0#11; #0#21 = #0#12; |FINSI;
        |SI nPara = 5; #0#22 = "L"; #0#20 = #0#13; #0#21 = #0#14; |FINSI;
        |SI #0#20 ! 0; |O #0#21 ! 0;
            |PRINT;
            enSwLin = 1;
        |FINSI;
  |SIGUE;
  |SI enSwLin = 0;
      |SI #0#18 ! 0; |O #0#19 ! 0;
          #0#22 = "A"; #0#20 = 0; #0#21 = 0;
          |PRINT;
      |FINSI;
  |FINSI;
  #0#23 = #0#23 + #0#7;   #0#24 = #0#24 + #0#8;
  #0#25 = #0#25 + #0#9;   #0#26 = #0#26 + #0#10;
  #0#27 = #0#27 + #0#11;  #0#28 = #0#28 + #0#12;
  #0#29 = #0#29 + #0#13;  #0#30 = #0#30 + #0#14;
  #0#31 = #0#31 + #0#16;  #0#32 = #0#32 + #0#17;

  #0#33 = #0#33 + #0#18; || Total Base exenta
  #0#34 = #0#34 + #0#19; || total seg.social
  #0#40 = #0#40 + #0#15;

  n1 = #0#23 + #0#25 + #0#27 + #0#29 + #0#31;
  n2 = #0#24 + #0#26 + #0#28 + #0#30 + #0#32;
|FPRC;

|DEFBUCLE por_nif;
  #20#2;
  0,1,134;
  "               ", #0#0, #0#3, #0#2;
  "zzzzzzzzzzzzzzz", #0#0, #0#4, #0#2;
  e;
  NULL, a_imprimir;
|FIN;

|DEFBUCLE por_numero;
  #20#1;
  ;
  #0#0, #0#3, #0#2;
  #0#0, #0#4, #0#2;
  e;
  NULL, a_imprimir;
|FIN;

|| *************************************** PROGRAMA TIPO 3
|PROCESO imprime; |TIPO 3;

  enMod = 110;
  |SI #0#2 ] 11;  enMod = 111; |FINSI;


  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |INFOR informe;
  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;


  desdemes = 0;
  hastames = 0;

  |SI #0#5 = 1; desdemes =  1; hastames =  3; perialf = " 1T"; |FINSI;
  |SI #0#5 = 2; desdemes =  4; hastames =  6; perialf = " 2T"; |FINSI;
  |SI #0#5 = 3; desdemes =  7; hastames =  9; perialf = " 3T"; |FINSI;
  |SI #0#5 = 4; desdemes = 10; hastames = 12; perialf = " 4T";  |FINSI;

  sw = 0;
  |SI #0#6 = 1;
      |BUCLE por_numero;
  |SINO;
      |BUCLE por_nif;
  |FINSI;
  |SI sw = 1;
      |SI #0#31 ! 0; |O #0#32 ! 0;
          #0#39 = #0#40; #0#45 = #0#33; #0#50 = #0#34;
      |SINO;
          |SI #0#23 ! 0; |O #0#24 ! 0;
              #0#35 = #0#40; #0#41 = #0#33; #0#46 = #0#34;
          |SINO;
              |SI #0#25 ! 0; |O #0#26 ! 0;
                  #0#36 = #0#40; #0#42 = #0#33; #0#47 = #0#34;
              |SINO;
                  |SI #0#27 ! 0; |O #0#28 ! 0;
                      #0#37 = #0#40; #0#43 = #0#33; #0#48 = #0#34;
                  |SINO;
                      |SI #0#29 ! 0; |O #0#30 ! 0;
                          #0#38 = #0#40; #0#44 = #0#33; #0#49 = #0#34;
                      |FINSI;
                  |FINSI;
              |FINSI;
           |FINSI;
       |FINSI;
       |PIEINF;
  |FINSI;

  |FININF;
  |FINIMP;
|FPRC;
