|FICHEROS;
  caextrax #0;
  cacuenta #1;
|FIN;

|VARIABLES;
  cta      = 0;
  long     = "";
  sw       = 0;
  &ext1    = "";
  &ext2    = "";
  &runnom  = "caextrax";
  &espe1   = @;
  &espe2   = @;
  &espe3   = 0;
  &espe4   = 0;
  &espe5   = "";
  &espe6   = "";
  &espe7   = 0;
  &espe8   = 0;
  &espe9   = 0;
  alfa1    = "";
  &sino    = "",

  nInkey    = 0;
  &espe15   = "";
  &espe16   = 0;
  &enEmpOrg = 0;
  &enPerOrg = 0;
  &eaFEmp   = "";
  &swVarios = 0;
  &eaMonOrg = "";
  &eaParam  = "";
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROCESO mayusc;
   alfa1 = #0Campo > " ";
   #0Campo = alfa1;
   |PINTA #0Campo;
|FPRC;

|CALCULO recoge; |TIPO 7;
   |SI #0#12 = "N";
       #0#2 = fec1;
   |SINO;
       #0#2 = "01.01.2000";
   |FINSI;
   |PINTA #0#2;
   #0#3 = fec2; |PINTA #0#3;
|FCAL;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  |SI #0#0 ! "            ";
      cta  = #0#0;
      long = cta % 0;
      sw = 0;
      |SI long = #30#14; sw = 1; #0#1 = 1; |FINSI;
      |SI long = #30#15; sw = 1; #0#1 = 2; |FINSI;
      |SI long = #30#16; sw = 1; #0#1 = 3; |FINSI;
      |SI long = #30#17; sw = 1; #0#1 = 4; |FINSI;
      |SI long = #30#18; sw = 1; #0#1 = 5; |FINSI;
      |SI long = #30#19; sw = 1; #0#1 = 6; |FINSI;
      |SI sw = 0;
          |MENAV "    Longitud de Cuenta fuera de Nivel ...";
          |ERROR;
      |SINO;
          #0#13 = #1#2; |PINTA #0#13;
      |FINSI;
  |SINO;
      |MENAV "    Error de Entrada ...";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO cuefin; |TIPO 0;
  |ABRE #1;
  #1#0 = #0#0;
  #1#1 = #0#1;
  |LEE 001#1=;
  |SI #1#3 = "N";|Y FSalida = 0;
      |MENAV "    Cuenta sin Pase Directo ...";
      |ERROR;
  |FINSI;
  |CIERRA #1;
  #0#13 = #1#2; |PINTA #0#13;
|FPRC;

|PROCESO fechas; |TIPO 0;
   |SI #0#12 = "N";
       |SI #0Campo > fec2;|O #0Campo < fec1;
           |MENAV "    Fecha fuera de Periodo ...";
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;
   |SI Campo = 3;
       |SI #0#2 > #0#3;
           |MENAV "    Fechas erroneas";
           |ERROR;
       |FINSI;
   |FINSI;
|FPRC;

|PROCESO no_dep; |TIPO 7;
  alfa1 = #30#24;
  |CAMPO_MODIFICA #0#6, 1, alfa1;
  |CAMPO_MODIFICA #0#7, 1, alfa1;
|FPRC;

|CALCULO SalAnt; |TIPO 7;
|FCAL;

|| **********************************************
|CALCULO engancha; |TIPO 3;
  sino = "S"; |SI #0#11 = "N"; sino = "N"; |FINSI;
  ext1 = #0#0;         || cuenta
  ext2 = #0#1;         || digito
  espe1 = #0#2;        || desde fecha
  espe2 = #0#3;        || hasta fecha
  espe3 = #0#4;        || desde concepto
  espe4 = #0#5;        || hasta concepto
  espe5 = #0#6;        || desde departamento
  espe6 = #0#7;        || hasta departamento
  espe7 = #0#8;        || tipo de Informe
  espe8 = #0#9;        || desde Diario
  espe9 = #0#10;       || hasta Diario
  espe15 = #0#12;

  |SI #0#12 = "S";
      |SUB_EJECUTA_NP "caextrap;001496NOMEQUITESQUETECORTOLOSGUEVOS";
  |SINO;
      |SUB_EJECUTA_NP "caextrap;NOMEQUITESQUETECORTOLOSGUEVOS";
  |FINSI;
  |PULSATECLA;
|FCAL;


|PROGRAMA;

 eaParam = "001496";  || incorporado a la estandar 27.09.2004
 |CLS;
 |CABEZA "Extractos Contables";
 |HAZ inicio;
 enEmpOrg = enEmpresa;
 enPerOrg = enPeriodo;
 |DFICE eaFEmp;
 eaMonOrg = eaMoneda;

 |DDEFECTO #0;

 FSalida = 0;
 |PARA;|SI FSalida = 0; |HACIENDO;
        sw = 0;
        |CLS;
        |PINPA #0#0;
        |PINDA #0#0;                    || Pinta los datos por defecto
        |ENDATOS #1#0;                  || Seleccion informe
        nInkey = FSalida;

        cod1 = enEmpOrg;
        cod2 = enPerOrg;
        emEmp = 1;  || Sin mensaje
        |HAZ leelo;

        |PATH_DAT #1 eaFEmp;
        #0#2 = espe1;
        #0#3 = espe2;
        FSalida = nInkey;
 |SIGUE;
|FPRO;
