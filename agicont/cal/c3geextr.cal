|FICHEROS;
    c3geextr #0;
    camaasil #1;
    camaasic #2;
    cacuenta #3;
    caclipro #5;
    camanban #6;
    canempre #30;
    calicont #31;
|FIN;

|VARIABLES;
    dirfich0 = "";
    emp1 = 0;
    per1 = 0;
    xx = 0;
    yy = 0;
    empcon = 0;
    ejecon = 0;
    sw = 0;
    anu = 0;
    leidos = 0;
    desde = 0;
    hasta = 0;
    varcamp = 0;
    &r_emp = 0;
    &r_per = 0;
    any = 0;
    &entrada = 1;
    mesnum = 0;
    columna = 0;
    sw_con = 0;          || 1 = EL CONCEPTO ES BUENO
    x = 0;
    sw_saldo = 0;        || 1 = EL SALDO DE LACUENTA ES CERO
    t_debe = 0;
    t_haber = 0;
    t_saldo = 0;
    campo = 0;
    d = 0;
    h = 0;
    sw_print = 0;        || 1 = NO DEBO ESCRIBIR
    sw_prim = 0;         || 0 = PRIMERA VEZ
    mesh = "";
    diah = "";
    anyoh = "";
    cuenta = "";
    cuen = "";
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    fecalf = "";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
    traba1 = "";
    varalf = "";

    &s_debe = 0;
    &s_haber = 0;
    &s_saldo = 0;
    &debe = 0;
    &haber = 0;
    &direc = "";
    &codpos = "";
    &pobla = "";
    &provi = "";
    &cif = "";
    &telef = "";
    &contra = "";
    contra_d = "";
    contra_h = "";
    swex_con = 0;
    informe = "";
    men2  = "     Longitud de Cuenta Fuera de Nivel ";
    long = "  ";
    cta  = 0;
    num   = 0;
    swdig = 0;
    digito = 0;
    &sw_inf = 0;
    &sw_cab = 0;
    &y = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    sw_pagina = 0;
    &pagina = 0;
    sw_cuen = 0;          ||1 = Hemos Leido la cuenta
    swtotal = 0;
    men9 = "     Empresa Contable INACTIVA ";
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|| *********************************************************************
||                         CALCULOS PANTALLA
|| *********************************************************************

|PROCESO &c_pagina;
  |SI sw_pagina = 0;
      pagina = 1;
      sw_pagina = 1;
  |SINO;
      pagina = pagina + 1;
  |FINSI;
  sw_cab = 1;
|FPRC;

|PROCESO coloca; |TIPO 8;
   |DBASE dir_fich;
   dir_fich = dir_fich + "fich/";
   |HAZ inicio;
|FPRC;

|PROCESO consulta;
  |SI FSalida ! 9;  |ACABA;  |FINSI;
  |SUB_EJECUTA "caconemp.run";
  |ERROR;
  |SI Campo = 40;
      #0#40 = r_emp;
      #0#42 = r_per;
      |PTEC 802;
      |PTEC 802;
  |FINSI;
  |SI Campo = 41;
      #0#41 = r_emp;
      #0#43 = r_per;
      |PTEC 802;
  |FINSI;
  |SI Campo ] 44;
      #0Campo = r_emp;
      varcamp = Campo + 20;
      #0varcamp = r_per;
      |PTEC 802;
      |PTEC 802;
  |FINSI;
|FPRC;

|PROCESO mayor;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;

|PROCESO mayor1;
  |HAZ mayor;
  |SI #0Campo = "N";
      |PARA x = 44;  |SI x [ 83;  |HACIENDO x = x + 1;
            |CAMPO_MODIFICA #0x,1,"S";
      |SIGUE;
      #0#40 = 0;
      #0#42 = 0;
      #0#41 = 0;
      #0#43 = 0;
      |CAMPO_MODIFICA #0#40,1,"N";
      |CAMPO_MODIFICA #0#42,1,"N";
      |CAMPO_MODIFICA #0#41,1,"N";
      |CAMPO_MODIFICA #0#43,1,"N";
      |PINTA #0#40;
      |PINTA #0#42;
      |PINTA #0#41;
      |PINTA #0#43;
  |SINO;
      |PARA x = 44;  |SI x [ 83;  |HACIENDO x = x + 1;
            #0x = 0;
            |CAMPO_MODIFICA #0x,1,"N";
      |SIGUE;
      |CAMPO_MODIFICA #0#40,1,"S";
      |CAMPO_MODIFICA #0#42,1,"S";
      |CAMPO_MODIFICA #0#41,1,"S";
      |CAMPO_MODIFICA #0#43,1,"S";
  |FINSI;
|FPRC;

|PROCESO seleccio; |TIPO 0;
|SI #0#4 = "N";
    |CAMPO_MODIFICA #0#05, 1, "S"; |CAMPO_MODIFICA #0#06, 1, "S";
    |CAMPO_MODIFICA #0#07, 1, "S"; |CAMPO_MODIFICA #0#08, 1, "S";
    |CAMPO_MODIFICA #0#09, 1, "S"; |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S"; |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S"; |CAMPO_MODIFICA #0#14, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S"; |CAMPO_MODIFICA #0#16, 1, "S";
    |CAMPO_MODIFICA #0#17, 1, "S"; |CAMPO_MODIFICA #0#18, 1, "S";
    |CAMPO_MODIFICA #0#19, 1, "S"; |CAMPO_MODIFICA #0#20, 1, "S";
    |CAMPO_MODIFICA #0#21, 1, "S"; |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S"; |CAMPO_MODIFICA #0#24, 1, "S";
    |CAMPO_MODIFICA #0#25, 1, "S"; |CAMPO_MODIFICA #0#26, 1, "S";
    |CAMPO_MODIFICA #0#27, 1, "S"; |CAMPO_MODIFICA #0#28, 1, "S";
    |CAMPO_MODIFICA #0#33, 1, "N"; |CAMPO_MODIFICA #0#34, 1, "N";
        #0#33 = 001;     |PINTA #0#33;
        #0#34 = 999;     |PINTA #0#34;
|SINO;
    |CAMPO_MODIFICA #0#05, 1, "N"; |CAMPO_MODIFICA #0#06, 1, "N";
    |CAMPO_MODIFICA #0#07, 1, "N"; |CAMPO_MODIFICA #0#08, 1, "N";
    |CAMPO_MODIFICA #0#09, 1, "N"; |CAMPO_MODIFICA #0#10, 1, "N";
    |CAMPO_MODIFICA #0#11, 1, "N"; |CAMPO_MODIFICA #0#12, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N"; |CAMPO_MODIFICA #0#14, 1, "N";
    |CAMPO_MODIFICA #0#15, 1, "N"; |CAMPO_MODIFICA #0#16, 1, "N";
    |CAMPO_MODIFICA #0#17, 1, "N"; |CAMPO_MODIFICA #0#18, 1, "N";
    |CAMPO_MODIFICA #0#19, 1, "N"; |CAMPO_MODIFICA #0#20, 1, "N";
    |CAMPO_MODIFICA #0#21, 1, "N"; |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N"; |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N"; |CAMPO_MODIFICA #0#26, 1, "N";
    |CAMPO_MODIFICA #0#27, 1, "N"; |CAMPO_MODIFICA #0#28, 1, "N";
    |CAMPO_MODIFICA #0#33, 1, "S"; |CAMPO_MODIFICA #0#34, 1, "S";
|FINSI;
|FPRC;

|PROCESO empieza; |TIPO 7;
    #0#2 = fec1;
    #0#3 = fec2;
    any = #30#26
|PINTA #0#2;
|PINTA #0#3;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  |SI #0Campo = "            ";  |ERROR;  |ACABA;  |FINSI;
  digito = Campo + 31;
  cta  = #0Campo;
  long = cta % 0;
  swdig = 0;
  |SI long = #30#14; swdig = 1; #0digito = 1; |FINSI;
  |SI long = #30#15; swdig = 1; #0digito = 2; |FINSI;
  |SI long = #30#16; swdig = 1; #0digito = 3; |FINSI;
  |SI long = #30#17; swdig = 1; #0digito = 4; |FINSI;
  |SI long = #30#18; swdig = 1; #0digito = 5; |FINSI;
  |SI long = #30#19; swdig = 1; #0digito = 6; |FINSI;
  |SI swdig = 0;  |MENAV men2;  |ERROR;  |FINSI;
|FPRC;

|PROCESO fechad;
  |SI #0#2 < fec1; |O #0#2 > fec2;
      |MENAV mensa1;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO fechah;
  |SI #0#3 < fec1; |O #0#3 > fec2; |O #0#3 < #0#2;
      |MENAV mensa1;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
                               || VARIABLES: A_
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;

|PROCESO colummes; |TIPO 7;
                          || Calculo para saber en que columna del plan contable
                          || se encuentra el mes hasta, y hacer no modificable
                          || el campo de (Con saldo S/N)
diah = #0#3 % 102;
mesh = #0#3 % 402;
anyoh = #0#3 % 902;
mesnum = mesh;

columna = #30#11 + (mesnum - 1);
|SI columna > 12; columna = columna - 12; |FINSI;

|SI diah = "31"; |O diah = "30"; |O diah = "28"; |O diah = "29";
     |SI diah = "30";
         |SI mesh = "01"; |O mesh = "03"; |O mesh = "05"; |O mesh = "07";
          |O mesh = "08"; |O mesh = "10"; |O mesh = "12";
               |HAZ nomodifi;
         |FINSI;
     |FINSI;
     |SI diah = "28"; |O diah = "29";
          |SI mesh ! "02";
             |HAZ nomodifi;
          |SINO;
             |SI diah = "28"
                |SI anyoh = "88"; |O anyoh = "92"; |O anyoh = "96";
                 |O anyoh = "00"; |O anyoh = "04"; |O anyoh = "08";
                    |O anyoh = "12"; |O anyoh = "16";
                   |HAZ nomodifi;
                |FINSI;
             |SINO;
                |SI anyoh ! "88"; |Y anyoh ! "92"; |Y anyoh ! "96";
                 |Y anyoh ! "00"; |Y anyoh ! "04"; |Y anyoh ! "08";
                    |Y anyoh ! "12"; |Y anyoh ! "16";
                   |HAZ nomodifi;
                |FINSI;
             |FINSI;
          |FINSI;
     |FINSI;
|SINO;
   |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO no_dep; |TIPO 7;
    alfa1 = #30#24;
|CAMPO_MODIFICA #0#36, 1, alfa1;
|CAMPO_MODIFICA #0#37, 1, alfa1;
|FPRC;

|| --------------- comprueba desde-hasta empresas ---------------------------

|PROCESO buscaem1;
  |SI #30#21 = "I"; |ACABA; |FINSI;
  |SI #30#26 ! any; |ACABA; |FINSI;
  leidos = 1;
|FPRC;

|DEFBUCLE buscaempre;
#30#1;
;
#0#40,desde;
#0#41,hasta;
e;
NULL,buscaem1;
|FIN;


|PROCESO buclempre;
  |SI #0#42 > #0#43;
      |MENAV "     ERROR EN INTRODUCCION";
      |ERROR;
      |ACABA;
  |FINSI;
  |SI #0#40 = 0;  |Y #0#41 = 0;  |ACABA;  |FINSI;
  desde = #0#42;
  hasta = #0#43;
  leidos = 0;
  |BUCLE buscaempre;
  |SI leidos = 0;
      |MENAV "    ATENCION SELECCION VACIA";
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO deshas;
  |SI #0#41 < #0#40;
      |MENAV "      Error en Introduccion";
      |ERROR;
  |FINSI;
|FPRC;

|| ------------------------------------------------------------------------

|PROCESO nomodi;
      |PARA x = Campo + 1;  |SI x [ 63;  |HACIENDO x = x + 1;
            #0x = 0;
            |CAMPO_MODIFICA #0x,1,"N";
            y = x + 20;
            #0y = 0;
            |CAMPO_MODIFICA #0y,1,"N";
      |SIGUE;
      y = Campo + 20;
      #0y = 0;
      |CAMPO_MODIFICA #0y,1,"N";
      |PINTA #0y;
|FPRC;


|PROCESO esbuena; || desde campo de empresas seleccion
  |SI FSalida = 2; |ACABA; |FINSI;
  |SI #0Campo = 0; |HAZ nomodi;  |ACABA;  |FINSI;
  |ABRE #30;
  #30#2 = #0Campo;
  #30#3 = 0;
  |LEE 011#30];
  |SI FSalida ! 0;  |O #30#2 ! #0Campo;
      |MENAV "     NO Existe la empresa Contable ";
      |ERROR;
  |FINSI;
  |CIERRA #30;
|FPRC;

|PROCESO esbuena1;
  |SI FSalida = 2;|ACABA;|FINSI;
  x = Campo - 20;
  |SI #0x = 0;  |ACABA;  |FINSI;
  |ABRE #30;
  x = Campo - 20;
  #30#2 = #0x;
  #30#3 = #0Campo;
  |LEE 011#30=;
  |SI FSalida ! 0;
      |MENAV "     NO Existe Periodo en la empresa Contable";
      |CIERRA #30;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #30;
  |SI #30#21 = "I";
      |MENAV men9;
      |ERROR;
      |ACABA;
  |FINSI;
  leidos = 0;
  |HAZ buscaem1;
  |SI leidos = 0;
      |MENAV "     NO Corresponde el a¤o contable ";
      |ERROR;
      |ACABA;
  |FINSI;
  x = Campo + 20;
  #0x = #30#1;
  |PINTA #0x;
  x = Campo - 20;
  alfa1 = #0x;
  alfa2 = #0Campo;
|FPRC;

|| **********************************************************************
||                       CALCULOS DE IMPRESION
|| **********************************************************************


|| ---------- Seleccion DESDE / HASTA Empresa.

|PROCESO esdesd1;
  |DBASE dir_fich;
  dirfich0 = dir_fich + "fich/";
  alfa1 = #30#2;
  alfa2 = #30#3;
  emp1 = #30#2;
  per1 = #30#3;
  alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
  alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
  dirfich0 = dirfich0 + alfa1 + alfa2 + "/";

  |SI #30#26 = any; |Y #30#21 ! "I";
      |HAZ haztodo;
  |FINSI;
|FPRC;

|DEFBUCLE esdesde;
#30#1;
;
#0#40,#0#42;
#0#41,#0#43;
e;
NULL,esdesd1;
|FIN;

|| ---------- Seleccion en parrilla.

|PROCESO esunaauna;
      |PARA xx = 44;  |SI xx [ 63;  |HACIENDO xx = xx + 1;
            |SI #0xx = 0;  |SAL;  |FINSI;
            |DBASE dir_fich;
            dirfich0 = dir_fich + "fich/";
            yy = xx + 20;
            emp1 = #0xx;
            per1 = #0yy;
            alfa1 = #0xx;
            alfa2 = #0yy;
            alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
            alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
            dirfich0 = dirfich0 + alfa1 + alfa2 + "/";
              || lee empresa
                 |ABRE #30;
                   #30#2 = emp1;
                   #30#3 = per1;
                 |LEE 011#30=;
                 |CIERRA #30;
                 |SI #30#26 = any; |Y #30#21 ! "I";
                     |HAZ haztodo;
                 |FINSI;
      |SIGUE;
|FPRC;


|| *************************************************************************
||                               MEOLLO
|| *************************************************************************

|PROCESO cabecera;
  #2#0 = #1#0;
  #2#1 = #1#1;
  #2#2 = #1#2;
  |LEE 040#2=;
  |SI FSalida ! 0;
      |DDEFECTO #2;
  |FINSI;
|FPRC;

|PROCESO concepto;
  sw_con = 0;
  |SI #0#5  = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#6  = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#7  = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#8  = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#9  = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#10 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#11 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#12 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#13 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#14 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#15 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#16 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#17 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#18 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#19 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#20 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#21 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#22 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#23 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#24 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#25 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#26 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#27 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
  |SI #0#28 = #1#6;  sw_con = 1;  |ACABA;  |FINSI;
|FPRC;

|PROCESO leecuen;
  swtotal = 0;
  sw_cuen = 1;
  sw_saldo = 0;
  #3#0 = #1#4;
  #3#1 = #1#5;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
  t_debe = 0;
  t_haber = 0;
  t_saldo = 0;
  |SI #0#29 = "N";
      campo = 12 + ((columna -1) * 3);
      |PARA d = 9; |SI d [ campo; |HACIENDO d = d + 3;
            h = d + 1;
            t_debe = t_debe + #3d;
            t_haber = t_haber + #3h;
      |SIGUE;
      t_saldo = t_debe - t_haber;
      |SI t_saldo = 0;  sw_saldo = 1; sw_print = 1; sw_cuen = 0;  |FINSI;
  |FINSI;

  direc = ""; codpos = ""; pobla = ""; provi = ""; cif = ""; telef = "";

  cuen = #1#4 % 102;
      #5#23 = "C";
      #5#10 = #1#4;
      #5#11 = #1#5;
      |LEE 040#5=;
      |SI FSalida = 0;
          direc = #5#2;
          varalf = #5#3;
          varalf = "0" + varalf;
          varalf = varalf % -102;
          codpos = varalf;
          varalf = #5#4;
          varalf = "00" + varalf;
          varalf = varalf % -103;
          codpos = codpos + varalf;
          pobla = #5#6;
          provi = #5#5;
          cif = #5#9;
          telef = #5#7;
          |ACABA;
      |FINSI;

      #5#23 = "P";
      #5#10 = #1#4;
      #5#11 = #1#5;
      |LEE 040#5=;
      |SI FSalida = 0;
           direc = #5#2;
           varalf = #5#3;
           varalf = "0" + varalf;
           varalf = varalf % -102;
           codpos = varalf;
           varalf = #5#4;
           varalf = "00" + varalf;
           varalf = varalf % -103;
           codpos = codpos + varalf;
           pobla = #5#6;
           provi = #5#5;
           cif = #5#9;
           telef = #5#7;
           |ACABA;
      |FINSI;

      #6#10 = #1#4;
      #6#11 = #1#5;
      |LEE 040#6=;
      |SI FSalida = 0;
           direc  = #6#2;
           varalf = #6#3;
           varalf = "00" + varalf;
           varalf = varalf % -102;
           codpos = varalf;
           varalf = #6#4;
           varalf = "000" + varalf;
           varalf = varalf % -103;
           codpos = codpos + varalf;
           pobla = #6#6;
           provi = #6#5;
           cif   = #6#14;
           telef = #6#7;
      |FINSI;
|FPRC;

          ||La variable 'y' se utiliza para saber cuando se hace un salto de
          ||pagina

|PROCESO buclepan;
  sw_con = 1;
  |SI #0#4 = "N"; |HAZ concepto;  |FINSI;
  |SI sw_con = 0; |ACABA;  |FINSI;
  |SI sw_prim = 0;
      cuenta = #1#4;
      sw_prim  = 1;
      |HAZ leecuen;
      |SI sw_saldo = 1; |ACABA; |FINSI;
  |FINSI;
  |SI cuenta ! #1#4;
      |SI sw_print = 0;
          |SI #0#35 = "N";
              sw_cab = 0;
              sw_inf = 2;
              |PRINT; swtotal = 1;
              sw_cab = 0;
          |SINO;
              |PIEINF;
          |FINSI;
      |FINSI;
      |HAZ borrar;
      cuenta = #1#4;
      |HAZ leecuen;
  |FINSI;
  |SI sw_saldo = 1;   |ACABA;   |FINSI;
  |SI #1#8 = "D";
      debe = #1#9;
      haber = 0;
  |SINO;
      debe = 0;
      haber = #1#9;
  |FINSI;
  |SI #1#1 ] #0#2; |Y #1#1 [ #0#3;
      |HAZ cabecera;
      |HAZ leocontra;
      |SI #1#3 [ 30; |O swex_con = 1;
          |SI #1#8 = "D";  contra = contra_d;   |FINSI;
          |SI #1#8 = "H";  contra = contra_h;   |FINSI;
      |SINO;
          contra = "";
      |FINSI;
      |SI #0#35 = "N";  |Y sw_cuen = 1;
          sw_cab = 1;
          sw_inf = 0;
          |PRINT; swtotal = 1;
          sw_cab = 0;
          sw_cuen = 0;
      |FINSI;
      sw_inf = 1;
      sw_cab = 0;
      |PRINT; swtotal = 1;
      sw_cab = 0;
      sw_print = 0;
  |FINSI;
  |SI #1#1 < #0#2;
      |SI #1#8 = "D";
          s_debe = s_debe  + #1#9;
      |SINO;
          s_haber = s_haber + #1#9;
      |FINSI;
      s_saldo = s_debe - s_haber;
      sw_print = 1;
  |FINSI;
|FPRC;

|PROCESO leocontra;
  contra = "";
  contra_d = #2#10;
  contra_h = #2#8;
  swex_con = 0;
  #31#0 = #1#0;
  #31#1 = #1#1;
  #31#2 = #1#2;
  #31#3 = #1#3;
  |LEE 001#31=;
  |SI FSalida = 0;
      swex_con = 1;
      contra_h = #31#4;
      contra_d = #31#4;
  |FINSI;
|FPRC;

|DEFBUCLE caextrim0;
 #1#3;
 0, 6, 21;
 #0#0, 0, fec1, 000000, #0#104, #0#33, #0#36;
 #0#1, 9, #0#3, 999999, #0#105, #0#34, #0#37;
 e;
 NULL, buclepan;
|FIN;

|| ***********************************************************************
||          COMIENZO CON TIPO 3
|| ***********************************************************************

|PROCESO impre; |TIPO 3;
  |CIERRA #1;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |HAZ los_informes;
  |SI #0#35 = "S";
         informe = que_i1;
  |SINO;
         informe = que_i2;
  |FINSI;

  |INFOR informe;
  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

  |SI #0#39 = "S";
      |BUCLE esdesde;
  |SINO;
      |HAZ esunaauna;
  |FINSI;

  |FINIMP;
|FPRC;

|PROCESO haztodo;
  enEmpresa = #canempre#2;
  enPeriodo = #canempre#3;
  swOperacion = 0
  |SUB_EJECUTA "camoneda.tab";

  |HAZ borrar;
  |HAZ borrar1;
  |PATH_DAT #1 dirfich0;
  |PATH_DAT #2 dirfich0;
  |PATH_DAT #3 dirfich0;
  |PATH_DAT #5 dirfich0;
  |PATH_DAT #6 dirfich0;
  |PATH_DAT #31 dirfich0;
  anu = 1900 + #30#26;
  |SI anu [ 1970;  anu = anu + 100;  |FINSI;
  empcon = #30#1;
  ejecon = #30#26;
  sw = 0;
  swtotal = 0;
  |ABRE #2;
  |ABRE #3;
  |ABRE #5;
  |ABRE #6;
  |ABRE #31;
  |SELECT #2#6;
          |BUCLE caextrim0;
  |CIERRA #2;
  |CIERRA #3;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #31;
  |SI #0#35 = "N"; |Y sw_print = 0;
      sw_cab = 0;
      sw_inf = 2;
      |SI swtotal = 1; |PRINT; |FINSI;
      sw_cab = 0;
  |FINSI;
  |SI sw_print = 0; |Y swtotal = 1;
      |PIEINF;
  |FINSI;
|FPRC;

|PROCESO borrar;
  s_debe = 0;
  s_haber = 0;
  s_saldo = 0;
|FPRC;

|PROCESO borrar1;
  sw_pagina = 0;
  sw_prim = 0;
  sw_saldo = 0;
  sw_print = 0;
  sw_inf = 0;
  sw_cuen = 0;
|FPRC;
