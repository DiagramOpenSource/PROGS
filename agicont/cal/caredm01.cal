|FICHEROS;
   caredm01 #0;
   camanban #1;
   caportad #7;

|FIN;

|VARIABLES;
 NombreP = "";
 NifP    = "";
 EntP    = "";
 SucP    = "";
 CtaP    = "";
 DirP    = "";
 Cp1P    = "";
 Cp2P    = "";
 PobP    = "";
 modo    = 0;
 vale    = 0;
 alfa1   = "";
 aAlfa = "";

 NifProv    = "";
 NombreProv = "";
 DirecProv  = "";
 PoblaProv  = "";
 ProviProv  = "";
 Cp1Prov    = "";
 Cp2Prov    = "";
 TelefProv  = "";
 FaxProv    = "";
 PaisProv   = "";
 varios     = 0;

|FIN;

|INCLUYE acceso_i;

|| *************************************************************************

|PROCESO tipo8; |TIPO 8;
 |SI PARAMETRO ! "";
    |C_M #caredm01#11, 1, "N"; |C_M #caredm01#12, 1, "N"; |C_M #caredm01#13, 1, "N";
    |C_M #caredm01#14, 1, "N"; |C_M #caredm01#16, 1, "N"; |C_M #caredm01#17, 1, "N";
    |C_M #caredm01#18, 1, "N"; |C_M #caredm01#19, 1, "N"; |C_M #caredm01#21, 1, "N";
    |C_M #caredm01#23, 1, "N"; |C_M #caredm01#24, 1, "N"; |C_M #caredm01#26, 1, "S";
    #caredm01#21 = "N";
 |FINSI;

 |HAZ inicio;
 |ABRE #7;
 |DDEFECTO #7;
 #7#0 = #30#2;
 #7#1 = #30#26;
 |LEE 001#7=;
 |SI FSalida = 0;
     NombreP = #7#2;
     NifP    = #7#13;
     EntP    = #7#66;
     SucP    = #7#67;
     CtaP    = #7#68;
     DirP    = #7#4;
     Cp1P    = #7#9;
     Cp2P    = #7#10;
     PobP    = #7#11;
 |SINO;
     NombreP = #30#4;
     NifP    = #30#8;
     EntP    = "0000";
     SucP    = "0000";
     CtaP    = "0000000000";
     DirP    = #30#5;
     alfa1   = #30#6; alfa1 = ("00000" + alfa1) % -105;
     Cp1P    = alfa1 %  102;
     Cp2P    = alfa1 % -103;
     PobP    = #30#7;
 |FINSI;
 |CIERRA #7;

|FPRC;

|PROCESO mayus; |TIPO 0;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;
|FPRC;

|PROCESO mayus1; |TIPO 0;
 |SI PARAMETRO ! "";
    #caredm01#21 = "N"; |PINTA #caredm01#21;
    |ACABA;
 |FINSI;
 |HAZ mayus;
 alfa1 = #0Campo;
 |C_M #0#11,1,alfa1;
 |C_M #0#12,1,alfa1;
 |C_M #0#13,1,alfa1;
 |C_M #0#14,1,alfa1;
||  |C_M #0#15,1,alfa1;
 |C_M #0#16,1,alfa1;
 |C_M #0#17,1,alfa1;
 |C_M #0#18,1,alfa1;
 |C_M #0#19,1,alfa1;
||  |C_M #0#20,1,alfa1;
|FPRC;

|PROCESO defban; |TIPO 7;
 modo = (FEntrada / 100) ! 0;
 |SI modo ! 1; |ACABA; |FINSI;
 |DDEFECTO #0;
 #0#2 = NifP;      #0#7  = DirP;
 #0#3 = NombreP;   #0#8  = Cp1P;
 #0#4 = EntP;         #0#9  = Cp2P;
 #0#5 = SucP;         #0#10 = PobP;
 #0#6 = CtaP;
 |PINDA #0#0;
|FPRC;

|PROCESO banco; |TIPO 0;
 modo = (FEntrada / 100) ! 0;

 |SI FSalida = 9;       || Para Consultar Ficha Banco
     |PUSHV 05012380;
     |ABRE #1;
     |PINPA #0#1;
     #1#0 = #0#0;
     |CONSULTA #0#1;
     vale = FSalida;
     |CIERRA #1;
     |POPV;
     |SI vale = 0;
         #0#0 = #1#0;
         |PINTA #0#0;
     |SINO;
         |ERROR;
         |ACABA;
     |FINSI;
 |FINSI;

 |SI modo ! 1; |ACABA; |FINSI;
 |ABRE #1;
 |DDEFECTO #1;
 #1#0 = #0#0;
 |LEE 001#1=;
 |SI FSalida = 0;
     #0#1  = #1#1;       |PINTA #0#1;
     #0#4  = #1#9 % 104; |PINTA #0#4;
     #0#5  = #1#9 % 504; |PINTA #0#5;
     #0#6  = #1#8 % 110; |PINTA #0#6;
 |FINSI;
 |CIERRA #1;
|FPRC;

|PROCESO DesPago; |TIPO 0;
 |SI PARAMETRO ! ""; |ACABA; |FINSI;
 |SI #0Campo = "S";
     |SI Campo = 23;
         #0#11 = "";  |PINTA #0#11; |C_M #0#11,1,"N";
         #0#12 = "N"; |PINTA #0#12; |C_M #0#12,1,"N";
         #0#13 = "N"; |PINTA #0#13; |C_M #0#13,1,"N";
         #0#14 = "N"; |PINTA #0#14; |C_M #0#14,1,"N";
     |SINO;
         #0#16 = "";  |PINTA #0#16; |C_M #0#16,1,"N";
         #0#17 = "N"; |PINTA #0#17; |C_M #0#17,1,"N";
         #0#18 = "N"; |PINTA #0#18; |C_M #0#18,1,"N";
         #0#19 = "N"; |PINTA #0#19; |C_M #0#19,1,"N";
     |FINSI;
  |SINO;
     |SI Campo = 23;
         |C_M #0#11,1,"S";
         |C_M #0#12,1,"S";
         |C_M #0#13,1,"S";
         |C_M #0#14,1,"S";
     |SINO;
         |C_M #0#16,1,"S";
         |C_M #0#17,1,"S";
         |C_M #0#18,1,"S";
         |C_M #0#19,1,"S";
     |FINSI;
  |FINSI;
|FPRC;
