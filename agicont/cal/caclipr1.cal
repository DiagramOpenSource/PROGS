|FICHEROS;
  caclipro #2;
  eosclipr #1,MANTE;
  agipobla #3;
  agiprovi #4;
  agim0016 #7;
  agicontr #23;
|FIN;

|VARIABLES;
  mens12 = "     Clave ya Existente !!!";
  &raf_cue = "";
  &raf_dig = 0;
  &raf_des = "";
  &raf_sw = 0;
  &entrada = 0;
  &tipoalta = "";
  entrad1 = 0;
  codcli = 0;
  directo = "";
  direct1 = "";
  tipotipo = "";
  &agi = "";
  &agi1 = "";
  &agi2 = "";
  &aste = "";
  &num = 0;
  &longi = "";
|FIN;

|INCLUYE acces2_i;

|PROGRAMA;
  entrad1 = entrada;
  entrada = 1;
  |HAZ inicio2;
  |HAZ tipo_8;

  raf_sw = 0;
  |ABRE #2;
  |DDEFECTO #2;
  |PINPA #0#2;
  |SI tipoalta = "X";
      |MENSA "2425 Introduzca Cliente/Proveedor: ";
      E_inf = "CP";
      E_sup = 1;
      tipotipo = 2456 ? 0;
      tipoalta = tipotipo;
  |FINSI;
  #2#23 = tipoalta;
  #2#10 = raf_cue;
  #2#11 = raf_dig;
  |LEE 101#2=;
  |SI FSalida = 0;
      |HAZ modcuen;
  |SINO;
      |HAZ altcuen;
  |FINSI;
  |CIERRA #2;
  entrada = entrad1;
|FPRO;

|PROCESO altcuen;
  raf_sw = 0;
  #2#23 = tipoalta;
  #2#10 = raf_cue;
  #2#11 = raf_dig;
  |LEE 040#2=;
  |SI FSalida = 0;  |MENAV mens12;  |ACABA;  |FINSI;
  |DDEFECTO #2;
  #2#23 = tipoalta;
  #2#10 = raf_cue;
  #2#11 = raf_dig;
  #2#1  = raf_des; ||Descripcion;
  |PINPA #0#2;
  |PINDA #0#2;
  |ENDATOS #1#2;
  |SI FSalida = 0;
      raf_des = #2#1;
      raf_sw = 1;
      |GRABA 040#2n;
  |FINSI;
|FPRC;

|PROCESO modcuen;
  |PINPA #0#2;
  |PINDA #0#2;
  |ENDATOS #2#2;

  |SI FSalida = 0;
      |GRABA 020#2a;
      raf_des = #2#1;
      raf_sw = 1;
  |FINSI;
  |LIBERA #2;
|FPRC;

|PROCESO tipo_8; || control de la ficha de clientes general
    |DIRECTORIO agi;
    |QBF agi;
    |PATH_DAT #23 agi;

    |ABRE #23;
    #23#0 = 1;
    |LEE 040#23=;
    |SI FSalida ! 0; aste = "*"; |CIERRA #23; |ACABA; |FINSI;
    |CIERRA #23;
    aste = #23#7;
    |QBF aste;
    |SI aste  = "*"; |ACABA; |FINSI;

    agi1 = #23#8; |QBF agi1;

   longi = agi1 % 0;
   num   = longi;
   num   = 100 + (num - 5);
   longi = num;

   agi2  = (agi1 % longi) + "pan/";

  |PATH_DAT #1 agi1;
  |PATH_DAT #3 agi1;
  |PATH_DAT #4 agi1;
  |PATH_DAT #7 agi1;

  |PATH_PAN #1 agi2;
  |PATH_PAN #3 agi2;
  |PATH_PAN #4 agi2;
  |PATH_PAN #7 agi2;
|FPRC;
