|FICHEROS;
|FIN;

|VARIABLES;
     Directorio  = "";
     nCanal      = 0;
     nPara       = 0;
     aNombreIP   = "";
     aAlfa       = "";
     aAlfa0      = "";
     aFichero    = "";
     aAlfa1      = "";
     aFichOrigen = "";
     aFichDestin = "";

     aAbre       = "";
     nHandle     = 0;
     &aNomAux    = "";
     &aNombre    = "";

     &eaTipoEmi    = "";
     &eaTipoSec    = "";

     &eaEjecutable = "";
     &eaFichCol    = "";
     &eaUnidad     = "";
     &enAnyo       = 0;

     &eaTEjer      = "";
     aCamino       = "";
     aCamino2      = "";
     aDirDes       = "";
     &eaCaminoT    = "";
     &eaUnidadBasico = "";
     &eaPathLanza    = "";

     {700}&NEmpresas = "";
|FIN;

|PROCESO CopiaFichero;
     aAlfa1 = "";
     |IP_REMOTO aAlfa1;  |QBT aAlfa1;
     |SI aAlfa1 ! "";
         |ENVIA_FICHERO aFichOrigen, aFichDestin;
     |SINO;
         |COPIA_FICHERO aFichOrigen, aFichDestin;
     |FINSI;
|FPRC;

|PROCESO Validacion347;
     aFichOrigen = Directorio + "hacienda/i347pr00.exe";
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/i347pr00.exe";
     |HAZ CopiaFichero;

     aAbre = eaUnidadBasico + "\MODELOS\" + eaTipoSec + "\imprime.bat";
     |XABRE "CW", aAbre, nHandle;

     aAlfa = "CD "+ eaUnidadBasico + "\MODELOS\" + eaTipoSec;
     |XGRABA nHandle, aAlfa;

     aAlfa = "i347pr00 -y";
     |XGRABA nHandle, aAlfa;

     aAlfa = "WAIT VSU347.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del " + eaUnidadBasico + "\MODELOS\" + eaTipoSec + "\I347PR00.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del VSU*.*";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del UNINST.ISU";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del LEAME.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del SIGLAS.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del DELEG.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del PAISES.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del PROVINCI.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ADMON.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ERRORES.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del WAIT.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del i347pr00";
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     aAlfa = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO CopiaDiskette;
     aCamino = eaUnidadBasico + "/MODELOS"; aCamino2 = "";
     |SI eaTipoSec = "180"; aCamino = eaUnidadBasico + "/AEAT"; aCamino2 = "_" + eaTEjer; |FINSI;

     aAlfa = aCamino;                                    |RMKDIR aAlfa;
     aAlfa = aCamino + "/" + eaTipoSec + aCamino2;       |RMKDIR aAlfa;

     |SI eaTipoSec = "190"; |O eaTipoSec = "180";
        |SI enAnyo ] 2001;
           aAlfa = "COPY "+ aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + " " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
           |RSYSTEM aAlfa;

           aAlfa = "COPY " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + ".car " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + ".car";
           |RSYSTEM aAlfa;
        |SINO;
           aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/" + eaFichCol;
           aFichDestin = aCamino + "/" + eaTipoSec + aCamino2  + "/" + eaFichCol;
           |HAZ CopiaFichero;

           aAlfa = "COPY " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + " " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
           |RSYSTEM aAlfa;
        |FINSI;

        |ACABA;
     |FINSI;

     |SI eaTipoSec = "347";
         |QBF aNomAux;
         |SI aNomAux = ""; aNomAux = "auxiliar.txt"; |FINSI;
         aAlfa = "COPY " + eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + eaFichCol + " " + eaUnidad + ":";
         |RSYSTEM aAlfa;

         aAlfa = "DEL " + eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
         |RSYSTEM aAlfa;

         aAlfa = "COPY " + eaUnidadBasico + "/MODELOS/" + eaTipoSec + aNomAux + " " + eaUnidad + ":";
         |RSYSTEM aAlfa;

         aAlfa = "DEL " + eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + aNomAux;
         |RSYSTEM aAlfa;

         |ACABA;
     |FINSI;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/" + eaFichCol;
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aAlfa = "COPY " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + " " + eaUnidad + ":";
     |RSYSTEM aAlfa;

     aAlfa = "DEL " + aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
     |RSYSTEM aAlfa;
     eaCaminoT = aCamino + "/" + eaTipoSec + aCamino2;
|FPRC;

|PROCESO Laser190;
     aCamino = eaUnidadBasico + "/MODELOS"; aCamino2 = "";
     |SI eaTipoSec = "180"; aCamino = eaUnidadBasico + "/AEAT"; aCamino2 = "_" + eaTEjer; |FINSI;

     aAlfa = aCamino;                               |RMKDIR aAlfa;
     aAlfa = aCamino + "/" + eaTipoSec + aCamino2;  |RMKDIR aAlfa;

     aAlfa = aCamino + "/" + eaTipoSec + aCamino2 + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108);
           aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + (NEmpresas % -108);
           |HAZ CopiaFichero;

           |SI eaTipoSec = "190"; |O eaTipoSec = "180";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108) + ".car";
               aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + (NEmpresas % -108) + ".car";
               |HAZ CopiaFichero;
           |FINSI;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime";
     |RSYSTEM aAlfa1;

     eaCaminoT = aCamino + "/" + eaTipoSec + aCamino2;
|FPRC;

|PROCESO Verifica190;
     aCamino = eaUnidadBasico + "/MODELOS"; aCamino2 = "";
     |SI eaTipoSec = "180"; aCamino = eaUnidadBasico + "/AEAT"; aCamino2 = "_" + eaTEjer; |FINSI;

     aAlfa = aCamino;                                   |RMKDIR aAlfa;
     aAlfa = aCamino + "/" + eaTipoSec + aCamino2;      |RMKDIR aAlfa;

     aAlfa = aCamino + "/" + eaTipoSec + aCamino2 + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol + ".car";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + ".car";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime";
     |RSYSTEM aAlfa1;
     eaCaminoT = aCamino + "/" + eaTipoSec + aCamino2;
|FPRC;

|PROCESO Verifica180;
     aCamino = eaUnidadBasico + "/MODELOS"; aCamino2 = "";
     |SI eaTipoSec = "180"; aCamino = eaUnidadBasico + "/AEAT"; aCamino2 = "_" + eaTEjer; |FINSI;

     aAlfa = aCamino;                               |RMKDIR aAlfa;
     aAlfa = aCamino + "/" + eaTipoSec + aCamino2;  |RMKDIR aAlfa;

     aAlfa = aCamino + "/" + eaTipoSec + aCamino2 + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     |SI enAnyo = 2001;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/i180pr01.exe";
         aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/i180pr01.exe";
         |HAZ CopiaFichero;
     |FINSI;

     |SI enAnyo = 2002;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/zpr02180.exe";
         aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/zpr02180.exe";
         |HAZ CopiaFichero;
     |FINSI;

     |SI enAnyo = 2003;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/zpr03180.exe";
         aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/zpr03180.exe";
         |HAZ CopiaFichero;
     |FINSI;

     |SI enAnyo = 2004;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/zpr04180.exe";
         aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/zpr04180.exe";
         |HAZ CopiaFichero;
     |FINSI;

     |SI enAnyo = 2005;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/zpr05180.exe";
         aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/zpr05180.exe";
         |HAZ CopiaFichero;
     |FINSI;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol + ".car";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaFichCol + ".car";
     |HAZ CopiaFichero;

     aAlfa0 = aCamino % 210; |QBF aAlfa0; aAlfa0 = "\" + aAlfa0;
     aAbre = aAlfa0 + "\" + eaTipoSec + aCamino2 + "\verifica.bat";
     |XABRE "CW", aAbre, nHandle;

     aAlfa = "CD " + aAlfa0 + "\" + eaTipoSec + aCamino2;
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "I180PR01 -y";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "ZPR02180 -y";  |FINSI;
     |SI enAnyo = 2003;  aAlfa = "ZPR03180 -y";  |FINSI;
     |SI enAnyo = 2004;  aAlfa = "ZPR04180 -y";  |FINSI;
     |SI enAnyo = 2005;  aAlfa = "ZPR05180 -y";  |FINSI;
     |XGRABA nHandle, aAlfa;

     aAlfa = "WAIT vs180 /E:" + eaFichCol + " /R:" + eaFichCol + ".txt /A:" + eaFichCol + ".car";
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "del " + aAlfa0 + "\" + eaTipoSec + aCamino2 + "\I180PR01.EXE";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "del " + aAlfa0 + "\" + eaTipoSec + aCamino2 + "\ZPR02180.EXE";  |FINSI;
     |SI enAnyo = 2003;  aAlfa = "del " + aAlfa0 + "\" + eaTipoSec + aCamino2 + "\ZPR03180.EXE";  |FINSI;
     |SI enAnyo = 2004;  aAlfa = "del " + aAlfa0 + "\" + eaTipoSec + aCamino2 + "\ZPR04180.EXE";  |FINSI;
     |SI enAnyo = 2005;  aAlfa = "del " + aAlfa0 + "\" + eaTipoSec + aCamino2 + "\ZPR05180.EXE";  |FINSI;
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.TAB";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.DLL";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ERROR180.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.WMF";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.EXE";
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "del i180pr01";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "del zls02180";  |FINSI;
     |SI enAnyo = 2003;  aAlfa = "del zls03180";  |FINSI;
     |SI enAnyo = 2004;  aAlfa = "del zls04180";  |FINSI;
     |SI enAnyo = 2005;  aAlfa = "del zls05180";  |FINSI;
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;
     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/verifica.bat";
     |RSYSTEM aAlfa1;
     eaCaminoT = aCamino + "/" + eaTipoSec + aCamino2;
|FPRC;

|PROCESO Laser;
     aCamino = eaUnidadBasico + "/MODELOS"; aCamino2 = "";
     |SI eaTipoSec = "180"; aCamino = eaUnidadBasico + "/AEAT"; aCamino2 = "_" + eaTEjer; |FINSI;

     aAlfa = aCamino;                               |RMKDIR aAlfa;
     aAlfa = aCamino + "/" + eaTipoSec + aCamino2;  |RMKDIR aAlfa;

     aAlfa = aCamino + "/" + eaTipoSec + aCamino2 + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           |SI eaTipoSec ! "347";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108);
               aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + (NEmpresas % -108);
               |HAZ CopiaFichero;
           |FINSI;

           |SI eaTipoSec = "190"; |O eaTipoSec = "180";  |O eaTipoSec = "347";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108) + ".car";
               aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/" + (NEmpresas % -108) + ".car";
               |HAZ CopiaFichero;
           |FINSI;

           |SI eaTipoSec = "347";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + "opa" + (NEmpresas % -505) + ".txt";
               aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + "opa" + (NEmpresas % -505) + ".txt";
               |HAZ CopiaFichero;

               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + "opb" + (NEmpresas % -505) + ".txt";
               aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + "opb" + (NEmpresas % -505) + ".txt";
               |HAZ CopiaFichero;
           |FINSI;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime.bat";
     |HAZ CopiaFichero;


     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime";
     |RSYSTEM aAlfa1;

     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/imprime.bat";
     |RFBORRA aAlfa1;

     aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/" + eaEjecutable + ".exe";
     |RFBORRA aAlfa1;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           aAlfa1 = aCamino + "/" + eaTipoSec + aCamino2 + "/" + (NEmpresas % -108);
           |RFBORRA aAlfa1;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     |HAZ Errores;
     eaCaminoT = aCamino + "/" + eaTipoSec + aCamino2;
|FPRC;

|PROCESO Verifica347;
     aAlfa = eaUnidadBasico + "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |HAZ CopiaFichero;

     |QBF aNomAux;
     |SI aNomAux = ""; aNomAux = "auxiliar.txt"; |FINSI;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + aNomAux;
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + aNomAux;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;
|FPRC;

|PROCESO Verifica347_2005;
     aAlfa = eaUnidadBasico + "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/opa*.txt";
     |_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFichOrigen = aAlfa;
            aFichDestin = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/" + (aAlfa % -112);
            |HAZ CopiaFichero;
            |FBORRA aFichOrigen;
            |_SDIR aAlfa;
     |SIGUE;

     aAlfa1 = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;

     aDirDes = eaUnidadBasico + "/AEAT";                        |RMKDIR aDirDes;
     aDirDes = eaUnidadBasico + "/AEAT/INTERNET";               |RMKDIR aDirDes;
     aDirDes = eaUnidadBasico + "/AEAT/INTERNET/347";           |RMKDIR aDirDes;
     aDirDes = eaUnidadBasico + "/AEAT/INTERNET/347/" + enAnyo; |RMKDIR aDirDes;
     aDirDes = aDirDes + "/";

     aAlfa  = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     aAlfa  = eaUnidadBasico + "/MODELOS/" + eaTipoSec + "/*.rst";
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aFichOrigen = (aAlfa % -1350) + "opa" + (aAlfa % -505) + ".txt";
            aFichDestin = aDirDes + "opa" + (aAlfa % -505) + ".txt"
            |RCOPIA_FICHERO aFichOrigen, aFichDestin;

            |RFBORRA aAlfa;
            |RFBORRA aFichOrigen;
            |R_SDIR aAlfa;
     |SIGUE;

     |HAZ Errores;
|FPRC;

|PROGRAMA;
     Directorio  = "";  |DBASE Directorio;

     |SI eaTipoEmi = "COPIA";
         |HAZ CopiaDiskette;
         |ACABA;
     |FINSI;

     |SI eaTipoEmi = "ERRORES190"; |O eaTipoEmi = "ERRORES180";
         |SI enAnyo [ 1999;
             |CONFI "0000SHA TERMINADO DE IMPRIMIR TODOS LOS IMPRESOS ";
         |SINO;
             FSalida = 0;
         |FINSI;
         |SI FSalida = 0;
             |HAZ Errores;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI eaTipoEmi = "ERRORES";
         |HAZ Errores;
         |ACABA;
     |FINSI;

     |SI eaTipoSec = "190"; |O eaTipoSec = "180";
         |SI eaTipoEmi = "VERIF190";    |HAZ Verifica190;  |ACABA;  |FINSI;
         |SI eaTipoEmi = "VERIF180";    |HAZ Verifica180;  |ACABA;  |FINSI;

         |HAZ Laser190;
         |ACABA;
     |FINSI;

     |SI eaTipoSec = "347";
         |SI eaTipoEmi = "VERIF347";
             |SI enAnyo = 2000;  |HAZ Verifica347;       |FINSI;
             |SI enAnyo = 2001;  |HAZ Verifica347;       |FINSI;
             |SI enAnyo = 2002;  |HAZ Verifica347;       |FINSI;
             |SI enAnyo = 2003;  |HAZ Verifica347;       |FINSI;
             |SI enAnyo = 2004;  |HAZ Verifica347;       |FINSI;
             |SI enAnyo = 2005;  |HAZ Verifica347_2005;  |FINSI;
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ Laser;
|FPRO;
