|FICHEROS;
   casiim03;
   caivaasi;
   caivases;
   calibros;
   siim1000@;
|FIN;

|VARIABLES;
     nOk           = 0;
 {20}aPopup        = "";
     nID           = 0;
     nNume1        = 0;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aID           = "";
     aMas          = "";
     nModo         = 0;
     aTConfig      = "";
     aTipoIVA      = "";
     snSerie       = "";
|FIN;

|INCLUYE acceso_i;

|PROCESO T7C18m03; |TIPO 7;
    aAlfa = "S";
    |SI aTipoIVA = "S";
        aAlfa = "N";
        #casiim03#18 = "N";
        |PINTA #casiim03#18;
    |FINSI;
    |C_M #casiim03#18,1,aAlfa;
|FPRC;

|PROCESO T7C20m03; |TIPO 7;
    aAlfa = "S";
    |SI aTipoIVA = "S";
        aAlfa = "N";
        #casiim03#20 = "N";
        |PINTA #casiim03#20;
    |FINSI;
    |C_M #casiim03#20,1,aAlfa;
|FPRC;

|PROCESO Descripcion;
     aAlfa = "S";
     |SI #casiim03#14 = "F"; |O #casiim03#14 = "C";
         aAlfa = "N";
         #casiim03#12 = "";
     |FINSI;
     |C_M #casiim03#12, 1, aAlfa;
     |PINTA #casiim03#12;
|FPRC;


|PROCESO T0C3R;
     |SI #casiim03#6 = "F1";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F2";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F3";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F4";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R1";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R2";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R3";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R4";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R5";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "XX";  nOk = 1;  |FINSI;
|FPRC;

|PROCESO T0C3S;
     |SI #casiim03#6 = "F1";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F2";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F3";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F4";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F5";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "F6";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "LC";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R1";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R2";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R3";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R4";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "R5";  nOk = 1;  |FINSI;
     |SI #casiim03#6 = "XX";  nOk = 1;  |FINSI;
|FPRC;

|PROCESO T0C3m01;  |TIPO 0;
     nOk = 0;

     |SI aTipoIVA = "R";
         |HAZ T0C3R;
     |FINSI;

     |SI aTipoIVA = "S";
         |HAZ T0C3S;
     |FINSI;

     |SI #casiim03#6 = "XX";
         |PTEC 806;
         |ACABA;
     |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #casiim03#10, 1, "S";
     |SI #casiim03#6 ! "F2";  |Y #casiim03#6 ! "F4";
         |C_M #casiim03#10, 1, "N";  #casiim03#10 = "";
     |FINSI;

     |C_M #casiim03#13, 1, "S";

     |SI #casiim03#13 =  " ";
         #casiim03#13 = "I"; |PINTA #casiim03#13;
     |FINSI;

     |SI #casiim03#6 ! "R1";  |Y #casiim03#6 ! "R2";  |Y #casiim03#6 ! "R3";
                              |Y #casiim03#6 ! "R4";  |Y #casiim03#6 ! "R5";
         |C_M #casiim03#13, 1, "N";  #casiim03#13 = "";
     |FINSI;

     |SI aTipoIVA = "R";
         |SI #casiim03#6 ! "F2";  |Y #casiim03#6 ! "F4";
             |C_M #casiim03#10, 1, "N";  #casiim03#10 = "";
         |FINSI;
     |FINSI;

     |SI aTipoIVA = "S";
         |C_M #casiim03#10, 1, "N";  #casiim03#10 = "";
         |C_M #casiim03#11, 1, "N";  #casiim03#11 = "";
     |FINSI;

     |C_M #casiim03#19, 1, "S";
     |SI #casiim03#6 = "F2";  |O #casiim03#6 = "F4";
        |O #casiim03#6 = "R5";  |O #casiim03#6 = "LC";
          |C_M #casiim03#19, 1, "N";
          #casiim03#19 = "S";
          |SI #casiim03#6 = "LC";
              #casiim03#19 = "N";
          |FINSI;
     |FINSI;
     |SI #casiim03#19 = " "; #casiim03#19 = "N"; |FINSI;
     |SI #casiim03#20 = " "; |Y aTipoIVA = "R";
         #casiim03#20 = "N";
     |FINSI;

     |PINTA #casiim03#19;
     |PINTA #casiim03#20;
     |PINTA #casiim03#7;
     |PINTA #casiim03#10;
     |PINTA #casiim03#11;
     |PINTA #casiim03#12;
     |PINTA #casiim03#13;
|FPRC;

|PROCESO T66C3R;
     aPopup2  = 10;
     aPopup3  = "F1. Factura completa o simplificada cualificada del art.7.2 y 7.3.";
     aPopup4  = "F2. Factura simplificada o sin identificacion del destinatario art.6.1d";
     aPopup5  = "F3. Factura emitida en sustitucion de facturas simplificadas";
     aPopup6  = "F4. Asiento resumen de facturas.";
     aPopup7  = "R1. Factura rectificativa. Error fundado y Articulo 80 uno y dos LIVA.";
     aPopup8  = "R2. Factura rectificativa. Articulo 80 tres LIVA - concurso acreedores";
     aPopup9  = "R3. Articulo 80 cuatro LIVA - deuda incobrable.";
     aPopup10 = "R4. Resto";
     aPopup11 = "R5. Rectificativa en facturas simplificadas.";
     aPopup12 = "XX. No importable al SII";
|FPRC;

|PROCESO T66C3S;
     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 13;
     aPopup3  = "F1. Factura completa o simplificada cualificada del art.7.2 y 7.3.";
     aPopup4  = "F2. Factura simplificada o sin identificacion del destinatario art.6.1d";
     aPopup5  = "F3. Factura emitida en sustitucion de facturas simplificadas";
     aPopup6  = "F4. Asiento resumen de facturas.";
     aPopup7  = "F5. Importaciones (DUA)";
     aPopup8  = "F6. Otros justificantes contables y documentos justificativos";
     aPopup9  = "LC. Aduanas - Liquidacion complementaria";
     aPopup10 = "R1. Factura rectificativa. Error fundado y Articulo 80 uno y dos LIVA.";
     aPopup11 = "R2. Factura rectificativa. Articulo 80 tres LIVA - concurso acreedores";
     aPopup12 = "R3. Articulo 80 cuatro LIVA - deuda incobrable.";
     aPopup13 = "R4. Resto";
     aPopup14 = "R5. Rectificativa en facturas simplificadas.";
     aPopup15 = "XX. No importable al SII";
|FPRC;

|PROCESO T66C3m01;  |TIPO 66;
     aAlfa = "|C003WID";
     aID   = #casiim03#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     |SI aTipoIVA = "R";
         |HAZ T66C3R;
     |FINSI;

     |SI aTipoIVA = "S";
         |HAZ T66C3S;
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #casiim03#6 = aAlfa;
     |FINSI;

     |PINTA #casiim03#6;
|FPRC;

|PROCESO T66C4R;
     |SI Campo = 7;
         aPopup2  = 16;
         aPopup3  = "01. Operaciones de régimen general";
         aPopup4  = "02. Exportacion";
         aPopup5  = "03. Operaciones de R.E.B.U.";
         aPopup6  = "04. Operaciones régimen especial oro de inversión";
         aPopup7  = "05. Operaciones régimen especial agencias de viajes.";
         aPopup8  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
         aPopup9  = "07. Operaciones de R.E.C.C.";
         aPopup10 = "08. Operaciones sujetas al IPSI/IGIC";
         aPopup11 = "09. Operaciones de facturación de las prestaciones de servicios de agencias de viaje";
         aPopup12 = "10. Cobros por cuenta de terceros de honorarios profesionales";
         aPopup13 = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
         aPopup14 = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
         aPopup15 = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
         aPopup16 = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
         aPopup17 = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         aPopup18 = "16. Facturas primer semestre 2017 y otras anteriores a la inclusion en el SII";
     |FINSI;

     |SI Campo ! 7;
         aPopup2  = "";

         |SI #casiim03#7 = "05";
             aPopup2  = "6";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "07. Operaciones de R.E.C.C.";
             aPopup6  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup7  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup8  = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
         |FINSI;

         |SI #casiim03#7 = "06";
             aPopup2  = "6";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup5  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup6  = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
             aPopup7  = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
             aPopup8  = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;

         |SI #casiim03#7 = "07";
             aPopup2  = "10";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "03. Operaciones de R.E.B.U.";
             aPopup6  = "05. Operaciones régimen especial agencias de viajes.";
             aPopup7  = "09. Operaciones de facturación de las prestaciones de servicios de agencias de viaje";
             aPopup8  = "11. Operaciones de arrendamiento de local de negocio sujetas a retención";
             aPopup9  = "12. Operaciones de arrendamiento de local de negocio no sujetos a retención";
             aPopup10 = "13. Operaciones de arrendamiento de local de negocio sujetas y no sujetas a retención";
             aPopup11 = "14. Factura con IVA pendiente de devengo (certificaciones de obra cuyo destinatario sea una Administración Pública)";
             aPopup12 = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;

         |SI #casiim03#7 = "11";  |O #casiim03#7 = "12";  |O #casiim03#7 = "13";
             aPopup2  = "05";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
             aPopup5  = "07. Operaciones de R.E.C.C.";
             aPopup6  = "08. Operaciones sujetas al IPSI/IGIC";
             aPopup7  = "15. Factura con IVA pendiente de devengo - operaciones de tracto sucesivo";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO T66C4S;
     |SI Campo = 7;
         aPopup2  = 12;
         aPopup3  = "01. Operaciones de régimen general";
         aPopup4  = "02. Operaciones por las que los Empresarios satisfacen compensaciones REAGYP";
         aPopup5  = "03. Operaciones de R.E.B.U.";
         aPopup6  = "04. Operaciones régimen especial oro de inversión";
         aPopup7  = "05. Operaciones régimen especial agencias de viajes.";
         aPopup8  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
         aPopup9  = "07. Operaciones de R.E.C.C.";
         aPopup10 = "08. Operaciones sujetas al IPSI/IGIC";
         aPopup11 = "09. Adquisiciones intracomunitarias de bienes y prestaciones de servicios";
         aPopup12 = "12. Operaciones de arrendamiento de local de negocio";
         aPopup13 = "13. Factura correspondiente a una importación (informada sin asociar a un DUA)";
         aPopup14 = "14. Primer semestre 2017 y otras facturas anteriores a la inclusion en el SII";
     |FINSI;

     |SI Campo ! 7;
         aPopup2  = "";
         |SI #casiim03#7 = "05";
             aPopup2  = "4";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "07. Operaciones de R.E.C.C.";
             aPopup6  = "12. Operaciones de arrendamiento de local de negocio";
         |FINSI;

         |SI #casiim03#7 = "07";
             aPopup2  = "5";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "01. Operaciones de régimen general";
             aPopup5  = "03. Operaciones de R.E.B.U.";
             aPopup6  = "05. Operaciones régimen especial agencias de viajes.";
             aPopup7  = "12. Operaciones de arrendamiento de local de negocio";
         |FINSI;

         |SI #casiim03#7 = "12";
             aPopup2  = "5";
             aPopup3  = "    No procede clave de operación";
             aPopup4  = "05. Operaciones régimen especial agencias de viajes.";
             aPopup5  = "06. Operaciones régimen especial grupo de entidades en iva (nivel avanzado)";
             aPopup6  = "07. Operaciones de R.E.C.C.";
             aPopup7  = "08. Operaciones sujetas al IPSI/IGIC";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO T66C4m01;  |TIPO 66;
     aAlfa = "|C004WID";
     aID   = #casiim03#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     |SI aTipoIVA = "R";
         |HAZ T66C4R;
     |FINSI;

     |SI aTipoIVA = "S";
         |HAZ T66C4S;
     |FINSI;

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #casiim03#Campo# = aAlfa;
     |FINSI;

     |PINTA #casiim03#Campo#;
|FPRC;

|PROCESO T0C4R;
     nOk = 0;

     |SI Campo ! 7;
         |SI #casiim03#Campo# = "  ";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "02";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "03";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "04";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "05";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "06";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "08";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "09";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "10";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "11";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "13";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "14";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "15";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "16";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI Campo = 7;
         |C_M #casiim03#8,  1, "S";
         |C_M #casiim03#9,  1, "S";

         |SI #casiim03#7 ! "05";  |Y #casiim03#7 ! "06";
          |Y #casiim03#7 ! "07";  |Y #casiim03#7 ! "11";
          |Y #casiim03#7 ! "12";  |Y #casiim03#7 ! "13";
             |C_M #casiim03#8, 1, "N";  #casiim03#8 = "";
             |C_M #casiim03#9, 1, "N";  #casiim03#9 = "";
         |FINSI;

         |PINTA #casiim03#8;
         |PINTA #casiim03#9;

         |ACABA;
     |FINSI;

     |SI #casiim03#Campo# = "  ";
         |ACABA;
     |FINSI;

     nOk = 0;
     |SI #casiim03#7 = "05";
         |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "13";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#7 = "06";
         |SI #casiim03#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "13";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "14";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#7 = "07";
         |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "03";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "05";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "09";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "11";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "13";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "14";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#7 = "11";  |O #casiim03#7 = "12";  |O #casiim03#7 = "13";
         |SI #casiim03#Campo# = "06";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "08";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "15";  nOk = 1;  |FINSI;
     |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T0C4S;
     nOk = 0;

     |SI Campo ! 7;
         |SI #casiim03#Campo# = "  ";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "02";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "03";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "04";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "05";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "06";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "08";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "09";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "13";  nOk = 1;  |FINSI;
     |SI #casiim03#Campo# = "14";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI Campo = 7;
         |C_M #casiim03#8, 1, "S";
         |C_M #casiim03#9, 1, "S";

         |SI #casiim03#7 ! "05";  |Y #casiim03#7 ! "07";  |Y #casiim03#7 ! "12";
             |C_M #casiim03#8, 1, "N";  #casiim03#8 = "";
             |C_M #casiim03#9, 1, "N";  #casiim03#9 = "";
         |FINSI;

         |PINTA #casiim03#8;
         |PINTA #casiim03#9;

         |ACABA;
     |FINSI;

     |SI #casiim03#Campo# = "  ";
         |ACABA;
     |FINSI;

     nOk = 0;
     |SI #casiim03#7 = "05";
         |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#7 = "07";
         |SI #casiim03#Campo# = "01";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "03";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "05";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "12";  nOk = 1;  |FINSI;
     |FINSI;

     |SI #casiim03#7 = "12";
         |SI #casiim03#Campo# = "05";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "06";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "07";  nOk = 1;  |FINSI;
         |SI #casiim03#Campo# = "08";  nOk = 1;  |FINSI;
     |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T0C4m01;  |TIPO 0;
     |SI #casiim03#6 = "XX";
         |ACABA;
     |FINSI;

     |SI aTipoIVA = "R";
         |HAZ T0C4R;
     |FINSI;

     |SI aTipoIVA = "S";
         |HAZ T0C4S;
     |FINSI;
|FPRC;

|PROCESO T0C8m01;  |TIPO 0;
     |C_M #casiim03#11, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     nOk = 0;

     |SI #casiim03#11 = "E1";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "E2";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "E3";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "E4";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "E5";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "E6";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "S1";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "S2";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "S3";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "N1";  nOk = 1;  |FINSI;
     |SI #casiim03#11 = "N2";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. Pulse F11 para ver tabla de contenido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C8m01;  |TIPO 66;
     |C_M #casiim03#11, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = "|C008WID";
     aID   = #casiim03#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     aPopup2  = 11;
     aPopup3  = "E1. Sujeta y exenta. Articulo 20 (por operaciones interiores, sanidad, educacion, etc).";
     aPopup4  = "E2. Sujeta y exenta. Articulo 21 (por exportaciones).";
     aPopup5  = "E3. Sujeta y exenta. Articulo 22 (operaciones asimiladas a las exportaciones).";
     aPopup6  = "E4. Sujeta y exenta. Articulo 24 (régimen aduanero y fiscal, como mercancias de zonas francas)";
     aPopup7  = "E5. Sujeta y exenta. Articulo 25 (entregas a un estado miembro).";
     aPopup8  = "E6. Sujeta y exenta. Otros. ";
     aPopup9  = "S1. Sujeta y no exenta. Normal.";
     aPopup10 = "S2. Sujeta y no exenta. Inversión del sujeto pasivo.";
     aPopup11 = "S3. Sujeta y no exenta. Normal e Inversión del sujeto pasivo.";
     aPopup12 = "N1. No sujeta articulo 7, 14, otros.";
     aPopup13 = "N2. No sujeta por reglas de localizacion. ";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #casiim03#11 = aAlfa;
     |FINSI;

     |PINTA #casiim03#11;
|FPRC;

|PROCESO T0C15m01;  |TIPO 0;
     |C_M #casiim03#13, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #casiim03#13 =  " ";
         |MENAV "0000Introduzca valor <S> Sustitucion <I> Por diferencias";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T0C7m01;  |TIPO 0;
     |C_M #casiim03#10, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     nOk = 0;
     |SI #casiim03#10 = " ";  nOk = 1;  |FINSI;
     |SI #casiim03#10 = "P";  nOk = 1;  |FINSI;
     |SI #casiim03#10 = "E";  nOk = 1;  |FINSI;

     |SI nOk = 0;
         |MENAV "0000Contenido incorrecto. <P> o <E>";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C7m01;  |TIPO 66;
     aAlfa = "|C007WID";
     aID   = #casiim03#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 2;
     aPopup3  = "P. Prestacion de servicios";
     aPopup4  = "E. Entrega de bienes";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #casiim03#10 = aAlfa;
     |FINSI;

     |PINTA #casiim03#10;
|FPRC;

|PROCESO T7C7m01;  |TIPO 7;
  |SI aTipoIVA = "R";
     |C_M #casiim03#11, 1, "S";
     |SI #casiim03#6 = "F2";  |O #casiim03#6 = "F4";
      |O #casiim03#6 = "R5";
         |C_M #casiim03#10, 1, "N";  #casiim03#10 = "";
         |PINTA #casiim03#10;
         |ACABA;
     |FINSI;

     |C_M #casiim03#10, 1, "S";
  |FINSI;
|FPRC;

|PROCESO T66C13m01;  |TIPO 66;
     |DBASS aMas;
     aMas = aMas + "siibase/def/siim1000.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida < 0;
         |MENAV "0000Opcion no instalada.";
         |ACABA;
     |FINSI;

     |CARGA_DEF aMas, siim1000@;
     |ABRE #siim1000@;
     |CONSULTA_CLAVE #2#siim1000@;
     |SI FSalida = 0;
         #casiim03#12 = #siim1000@#1;
         |PINTA #casiim03#12;
     |FINSI;
     |CIERRA #siim1000@;
     |DESCARGA_DEF #siim1000@;
|FPRC;

|CALCULO DesHasConcep; |TIPO 0;
   |C_M #casiim03#Campo#,0,aAlfa;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   |SI FSalida = 2; |ACABA; |FINSI;

   |SI FSalida = 10;
       #casiim03#17 = #casiim03#16;
       |PINTA #casiim03#17;
   |FINSI;

   |SI #casiim03#17 < #casiim03#16;
       |MENAV "0000Concepto Hasta menor que Concepto Desde. Modifique";
       |ERROR;
   |FINSI;
|FCAL;

|CALCULO Tipo7C05; |TIPO 7;
   |C_M #casiim03#Campo#,0,aAlfa;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   |SI #casiim03#5 = "     ";
       #casiim03#5 = #casiim03#4;
       |PINTA #casiim03#5;
   |FINSI;
|FCAL;

|CALCULO DesHasSerie; |TIPO 0;
   |C_M #casiim03#Campo#,0,aAlfa;
   |SI aAlfa = "N"; |ACABA; |FINSI;

   |SI FSalida = 2; |ACABA; |FINSI;

   |SI FSalida = 10;
       #casiim03#5 = #casiim03#4;
       |PINTA #casiim03#5;
   |FINSI;

   |SI #casiim03#5 < #casiim03#4;
       |MENAV "0000Serie Hasta menor que Serie Desde. Modifique";
       |ERROR;
   |FINSI;
|FCAL;

|CALCULO Libro; |TIPO 6;

   |C_M #casiim03#2, 1, "N";

   |SI #casiim03#1 ! 0;
       |ABRE #calibros;
       #calibros#0 = #casiim03#1;
       |LEE 010#calibros.=;
       |SI FSalida ! 0;
           |MENAV "      No existe libro";
           |CIERRA #calibros;
           |ERROR;
           |ACABA;
       |FINSI;
       |CIERRA #calibros;

       |SI #calibros#2 = "N";
           |MENAV "      Error, Libro de No IVA";
           |ERROR;
           |ACABA;
       |FINSI;

       aTipoIVA = #calibros#2;

       #casiim03#2 = #calibros#2; |PINTA #casiim03#2;
       #casiim03#3 = #calibros#1;
    |SINO;
       |C_M #casiim03#2, 1, "S";
       #casiim03#3 = "TODOS LOS LIBROS";
    |FINSI;
    |PINTA #casiim03#3;
|FCAL;

|CALCULO Tipo07C0; |TIPO 7;
       aAlfa = "                 ";
       nModo = (FEntrada / 100) ! 0;
       |SI nModo > 1;
           |SI #casiim03#2 = "R";
               aAlfa = " IVA REPERCUTIDO ";
           |SINO;
               aAlfa = " IVA SOPORTADO   ";
           |FINSI;
       |FINSI;
       |ATRI I;
       |PINTA 0643, aAlfa;
       |ATRI 0;
|FCAL;

|CALCULO TrasTipoIVA;
       nModo = (FEntrada / 100) ! 0;

       aTipoIVA = #casiim03#2;
       |ATRI I;
       |SI aTipoIVA = "R";
           |PINTA 0643, " IVA REPERCUTIDO ";
       |SINO;
           |SI aTipoIVA = "S";
              |PINTA 0643, " IVA SOPORTADO   ";
          |FINSI;
       |FINSI;
       |ATRI 0;

       |SI aTConfig = "S";
           |C_M #casiim03#4, 1,snSerie;
           |C_M #casiim03#5, 1,snSerie;
           |SI snSerie = "N";
               #casiim03#4 = "     "; |PINTA #casiim03#4;
               #casiim03#5 = "zzzzz"; |PINTA #casiim03#5;
           |FINSI;
       |SINO;
           aAlfa1 = "S";
           |C_M #casiim03#16, 1, aAlfa1;
           |C_M #casiim03#17, 1, aAlfa1;
           |SI aAlfa1 = "N";
               #casiim03#16 = 001; |PINTA #casiim03#16;
               #casiim03#17 = 999; |PINTA #casiim03#17;
           |SINO;
               |SI nModo = 1;
                   nNume1 = 31;
                   |SI aTipoIVA = "R"; nNume1 = 5; |FINSI;
                   #casiim03#16 = #caivaasi#nNume1#; |PINTA #casiim03#16;
                   #casiim03#17 = #caivaasi#nNume1#; |PINTA #casiim03#17;
               |FINSI;
           |FINSI;
       |FINSI;
|FCAL;

|PROCESO CojoConfig;

   |ABRE #caivaasi;
   |DDEFECTO #caivaasi;
   |LEE 141#caivaasi.p;
   |SI FSalida ! 0;
       |DDEFECTO #caivaasi;
       |GRABA 020#caivaasi.b;
   |FINSI;
   snSerie = #caivaasi#44;

   |CUADRO 1014 1361;
   |ATRI P;
   |PINTA 1115, "Configuracion Defectos Facturas SII (S/C):   ";
   |ATRI 0;
   |C_P #caivaasi#52,1,1159; |PINTA #caivaasi#52;

   |ENCAMPO #52#caivaasi;

   |GRABA 020#caivaasi.a;
   |LIBERA #caivaasi;

   |CIERRA #caivaasi;
|FPRC;

|PROCESO ClauMin;
   #casiim03#15 = aTConfig;
   #casiim03#0  = 001;
|FPRC;

|PROCESO ClauMax;
   #casiim03#15 = aTConfig;
   #casiim03#0  = 999;
|FPRC;

|PROGRAMA;

   |HAZ inicio;

   |CLS;
   |CABEZA "Ctrl defectos enlace SII";

   |HAZ CojoConfig;
   aTConfig = #caivaasi#52;

   |PINPA #0#casiim03;

   aAlfa1 = "S"; aAlfa2 = "N";
   |SI aTConfig = "C";
       aAlfa1 = "N"; aAlfa2 = "S";
       |ATRI R; |PINTA 0920, "Concepto Fra."; |ATRI 0;
   |FINSI;
   |C_V #casiim03#4,  1, aAlfa1; |C_M #casiim03#4,  1, aAlfa1;
   |C_V #casiim03#5,  1, aAlfa1; |C_M #casiim03#5,  1, aAlfa1;
   |C_V #casiim03#16, 1, aAlfa2; |C_M #casiim03#16, 1, aAlfa2;
   |C_V #casiim03#17, 1, aAlfa2; |C_M #casiim03#17, 1, aAlfa2;

   |ENTLINEAL #1#casiim03, -2, 2, 20, 0, ClauMin, ClauMax;
|FPRO;
