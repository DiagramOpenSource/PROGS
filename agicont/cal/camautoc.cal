|FICHEROS;
  camautoc #1;
  camautol #0;
  cacuenta #2;
  caconcep #3;
|FIN;

|VARIABLES;
  &entrada = 1;
  alfa1 = "";
  alfa2 = "";
  alfa3 = "";
  nume1 = 0;
  nume2 = 0;
  nume3 = 0;
  fech1 = @;

  long = 0;
  sw = 0;
  inkey = 0;
  cuant = "";
  diant = 0;
  coant = 0;
  deant = "";
  dhant = "";
  imant = 0;
  dpant = "";
  doce  = "            ";
  modo  = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;
|INCLUYE vardep_i;

|| ********************************************************************
|PROCESO alta; |TIPO 7;
 modo = (FEntrada / 100) ! 0;
 nume1 = 0;
 |SI modo = 1;
     |DDEFECTO #1;
     |LEE 001#1u;
     |SI FSalida = 0;
         nume1 = #1#0;
     |FINSI;
     |DDEFECTO #1;
     #1#0 = nume1 + 1;
     |PINTA #1#0;
 |FINSI;
  cuant = "";
  diant = 0;
  coant = 0;
  deant = "";
  dhant = "";
  imant = 0;
  dpant = "";
|FPRC;

|PROCESO mayus;
  #1Campo = #1Campo > " ";
  |PINTA #1Campo;
|FPRC;


|| ---------------> Procesos para el calculo automatico de la fecha contable
|| ---------------- queda anulado por ahora.

|PROCESO perio; |TIPO 0;
/*
 |HAZ mayus;
 alfa1 = "N"; alfa2 = "S";
 |SI #1Campo = "D";
     alfa1 = "S"; alfa2 = "N";
 |FINSI;
 |C_M #1#3,1,alfa1;
 |C_M #1#6,1,alfa1;
 |C_M #1#4,1,alfa2;
 |C_M #1#5,1,alfa2;
 |SI #1Campo = "M"; #1#3 = 30; |FINSI;
 |SI #1Campo = "B"; #1#3 = 60; |FINSI;
 |SI #1Campo = "T"; #1#3 = 90; |FINSI;
 |SI #1Campo = "S"; #1#3 = 180; |FINSI;
 |SI #1Campo = "A"; #1#3 = 365; |FINSI;
 |SI #1Campo ! "D"; |PINTA #1#3; |ACABA; |FINSI;
*/

|FPRC;

|PROCESO diames; |TIPO 0;
/*
 |C_M #1Campo,0,alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;
 |SI #1Campo > 30; |Y #1Campo ! 99;
     |ERROR;
 |FINSI;
*/
|FPRC;

|PROCESO primes; |TIPO 0;
/*
 |C_M #1Campo,0,alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;

 alfa1 = #1#5; alfa1 = ("00" + alfa1) % -102;
 alfa2 = #1#4; alfa2 = ("00" + alfa2) % -102;
 |SI alfa2 = "99";
     alfa2 = "31";
     |SI alfa1 = "02"; alfa2 = 28; |FINSI;
     |SI alfa1 = "04"; |O alfa1 = "06"; |O alfa1 = "09"; |O alfa1 = "11";
         alfa2 = 30;
     |FINSI;
 |FINSI;
 alfa3 = alfa2 + alfa1;
 #1#6  = alfa3; |PINTA #1#6;
*/
|FPRC;

|PROCESO prifecha; |TIPO 0;
/*
 |C_M #1Campo,0,alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;
 alfa1 = #1Campo;
 |HAZ com_fecha;
 |SI swerror = 1;
     |MENAV "    Fecha Erronea ";
     |ERROR;
 |FINSI;
*/
|FPRC;

|PROCESO com_fecha;
/*
 swerror = 0;
 alfa1 = ("0000" + alfa1) % -104;
 alfa2 = alfa1 % 102;
 alfa3 = alfa1 % 302;
 |SI alfa3 > "12"; swerror = 1; |ACABA; |FINSI;
 |SI alfa2 > "31"; swerror = 1; |ACABA; |FINSI;
 |SI alfa2 < "29"; |ACABA; |FINSI;
 |SI alfa3 = "02"; swerror = 1; |ACABA; |FINSI;
 |SI alfa2 [ "30"; |ACABA; |FINSI;
 |SI alfa3 = "04"; |O alfa3 = "06"; |O alfa3 = "09"; |O alfa3 = "11";
     swerror = 1;
 |FINSI;
*/
|FPRC;

|| ------------------------------------------------------------------------/

|PROCESO mod_asto; |TIPO 0;
 inkey = FSalida;
 |SI inkey ! 9; |ACABA; |FINSI;

 |C_M #1#7, 1, "S"; |C_M #1#8, 1, "S"; |C_M #1#9, 1, "S";

 |ENCAMPO #7#1; |SI #1#7 = "  "; |VETE nopr; |FINSI;
 |ENCAMPO #8#1;
 |ENCAMPO #9#1;

|ET nopr;
 |C_M #1#7, 1, "N"; |C_M #1#8, 1, "N"; |C_M #1#9, 1, "N";
 |ERROR;
|FPRC;

|PROCESO elcamp7; |TIPO 0;
 alfa1 = #1#7; |QBF alfa1;
 |SI alfa1 = "";
     #1#8 = ""; |PINTA #1#8;
     #1#9 = ""; |PINTA #1#9;
     |ACABA;
 |FINSI;
 alfa1 = ("00" + alfa1) % -102;
 #1#7 = alfa1;
 |PINTA #1#7;
|FPRC;

|PROCESO elcamp8; |TIPO 0;
 alfa1 = #1#8; |QBF alfa1;
 |SI alfa1 = ""; |ACABA; |FINSI;
 fech1 = #1#8;
 nume1 = fech1;
 fech1 = nume1;
 alfa1 = fech1;
 |SI alfa1 ! #1#8; |AVISO; |ERROR; |FINSI;
|FPRC;

|PROCESO elcamp9; |TIPO 0;
 alfa1 = #1#9; |QBF alfa1;
 |SI alfa1 = ""; |ACABA; |FINSI;
 alfa1 = ("000000" + alfa1) % -106;
 #1#9 = alfa1;
 |PINTA #1#9;
|FPRC;

|| *********************************** PROCESOS de Lineas
|PROCESO mayusl; |TIPO 0;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
  |C_M #0#8,1,"S";
  |SI #0Campo = "S"; |O #0Campo = "C";
      |C_M #0#8,1,"N";
      #0#8 = 0; |PINTA #0#8;
  |FINSI;
|FPRC;

|PROCESO cuefin;
  |ABRE #2;
  #2#0 = #0#2;
  #2#1 = #0#3;
  |LEE 001#2=;
  |SI FSalida ! 0;
      |MENAV "     La Cuenta NO Existe ";
      |ERROR;
      |CIERRA #2;
      |ACABA;
  |FINSI;
  |SI #2#3 = "N";
      |MENAV "     La Cuenta NO tiene PASE DIRECTO";
      |ERROR;
  |FINSI;
  |ATRI I;
  |PINTA 2210, #2#2;
  |ATRI 0;
  |CIERRA #2;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;
      |MENAV "     ERROR EN CUENTA";
      |ERROR;
      |ACABA;
  |FINSI;

  alfa1 = #0#2;
  |QBF alfa1;
  alfa2 = alfa1 % 0;
  long = alfa2;
  sw = 0;
  |SI long = dig4;  sw = 1;  #0#3 = 1;  |FINSI;
  |SI long = dig5;  sw = 1;  #0#3 = 2;  |FINSI;
  |SI long = dig6;  sw = 1;  #0#3 = 3;  |FINSI;
  |SI long = dig7;  sw = 1;  #0#3 = 4;  |FINSI;
  |SI long = dig8;  sw = 1;  #0#3 = 5;  |FINSI;
  |SI long = dig9;  sw = 1;  #0#3 = 6;  |FINSI;
  |SI long = 0;     sw = 1;  #0#3 = 0;  |FINSI;
  |SI sw = 0;
      #0#3 = 0;
      |MENAV "      Longitud de Cuenta Fuera de Nivel ";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO otravez;
 alfa1 = #0#2;
 |QBF alfa1;
 |SI alfa1 = ""; |ACABA; |FINSI;
     alfa2 = alfa1 % 0;
     long = alfa2;
     sw = 0;
 |SI long = dig4;  sw = 1;  #0#3 = 1;  |FINSI;
 |SI long = dig5;  sw = 1;  #0#3 = 2;  |FINSI;
 |SI long = dig6;  sw = 1;  #0#3 = 3;  |FINSI;
 |SI long = dig7;  sw = 1;  #0#3 = 4;  |FINSI;
 |SI long = dig8;  sw = 1;  #0#3 = 5;  |FINSI;
 |SI long = dig9;  sw = 1;  #0#3 = 6;  |FINSI;
 |SI long = 0;     sw = 1;  #0#3 = 0;  |FINSI;
|FPRC;

|PROCESO nodepar; |TIPO 7;
 |C_M #0#6, 1, eaDepar;
|FPRC;

|PROCESO cActividad; |TIPO 0;
   |SI eaDepar = "N"; |ACABA; |FINSI;
   |PINTA 2249, "                              ";
   eOpDep = 0; || 1 = Consulta pantalla
   |SI FSalida = 10;  eOpDep = 1; |FINSI;
   eaCodDep    = #0#6;
   |HAZ Actividad;
   |SI eswLect = 1;
       |MENAV "    Error.! No Existe Departamento";
       |ERROR;
   |SINO;
       #0#6 = eaCodDep; |PINTA #0#6;
       |ATRI S; |PINTA 2249, eaNombreAct; |ATRI 0;
   |FINSI;
|FPRC;

|PROCESO concepto; |TIPO 0;
 |ABRE #3;
 #3#0 = #0#4;
 |LEE 040#3=;
 |SI FEntrada = 101;
     #0#5 = #3#1;
 |SINO;
    |SI #0#4 = coant;
        #0#5 = deant;
    |SINO;
        #0#5 = #3#1;
    |FINSI;
 |FINSI;
 |PINTA #0#5;
 |CIERRA #3;
|FPRC;

|PROCESO descrip; |TIPO 0;
  inkey = FSalida;
  |SI inkey = 15;
      #0#5 = deant;
      |PINTA #0#5;
  |FINSI;
|FPRC;

|PROCESO c_descrip; |TIPO 7;
 |PTEC 816;
|FPRC;

|PROCESO nocero; |TIPO 0;
 |C_M #0Campo,0,alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;

 |SI #0Campo = 0;
     |MENAV "    ATENCION!!! Importe cero ...";
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO tipo3; |TIPO 3;
  alfa1 = #0#2;  |QBF alfa1;
  |SI alfa1 = "";
      |MENAV "    ATENCION!!! Apunte sin cuentas ...";
      |ERROR;
      |ACABA;
  |FINSI;
  |SI #0#8 = 0;
      |SI #0#7 = "D"; |O #0#7 = "H";
          |MENAV "    ATENCION!!! Importe cero ...";
          |ERROR;
          |ACABA;
      |FINSI;
  |FINSI;
  cuant = #0#2;
  diant = #0#3;
  coant = #0#4;
  deant = #0#5;
  dhant = #0#7;
  imant = #0#8;
  dpant = #0#6;
|FPRC;

|PROCESO tipo1; |TIPO 1;
  cuant = #0#2;
  diant = #0#3;
  coant = #0#4;
  deant = #0#5;
  dhant = #0#7;
  imant = #0#8;
  dpant = #0#6;
|FPRC;

|PROCESO tipo13; |TIPO 13;
 |SI #0#2 ! doce;
     |ABRE #2;
     #2#0 = #0#2;
     #2#1 = #0#3;
     |LEE 001#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;
 |SINO;
    |DDEFECTO #2;
 |FINSI;
 |ATRI I;
 |PINTA 2210, #2#2;
 |ATRI 0;

 |PINTA 2249, "                              ";
 modo = (FEntrada / 100) ! 0;
 |SI modo = 1; |ACABA; |FINSI;
 |SI eaDepar = "S";
       eOpDep = 0;
       eaCodDep    = #0#6;
       eSwNoalta   = 1;
       eaNombreAct = "";
       |HAZ Actividad;
       |ATRI S; |PINTA 2249, eaNombreAct; |ATRI 0;
       eSwNoalta   = 0;
  |FINSI;
|FPRC;

|PROCESO tipo5; |TIPO 5;
 FSalida = "SINBARRA";
|FPRC;
