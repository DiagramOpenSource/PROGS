|FICHEROS;
  cactrlal #0;
  canempre #30;
|FIN;

|VARIABLES;
  &r_emp = 0;
  &r_per = 0;
  alfa1 = "";
  alfa2 = "";
  nume1 = 0;
  nume2 = 0;
  nCampo = 0;
|FIN;

|| *************************************************************************
||                        CALCULOS DE PANTALLA
|| *************************************************************************

|CALCULO vercuentas; |TIPO 0;
 nume1 = Campo - 1;
 |SI #0nume1 > #0Campo;
     |MENAV "     ERROR EN INTRODUCCION";
     |ERROR;
 |FINSI;
|FCAL;

|CALCULO LosPred; |TIPO 0;
 |C_M #0#52,1,"S"; |C_M #0#53,1,"S";
 |C_M #0#54,1,"S"; |C_M #0#55,1,"S";
 |C_M #0#56,1,"S"; |C_M #0#57,1,"S";
 |C_M #0#58,1,"S"; |C_M #0#59,1,"S";

 |SI #0#51 = "N";
     |C_M #0#52,1,"N"; |C_M #0#53,1,"N";
     |C_M #0#54,1,"N"; |C_M #0#55,1,"N";
     |C_M #0#56,1,"N"; |C_M #0#57,1,"N";
     |C_M #0#58,1,"N"; |C_M #0#59,1,"N";
     |PDEFECTO #0, 52,60;
     |PINTA #0#52; |PINTA #0#53;
     |PINTA #0#54; |PINTA #0#55;
     |PINTA #0#56; |PINTA #0#57;
     |PINTA #0#58; |PINTA #0#59;
 |FINSI;

|FCAL;

|CALCULO Parrilla;  |TIPO 0;
     |SI #0#49 = 0;
         #0#49 = 0;  |PINTA #0#49;
         #0#50 = 0;  |PINTA #0#50;  |C_M #0#50, 1, "N";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#50, 1, "S";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
               nume2 = nCampo + 20;    #0nume2 = "";  |PINTA #0nume2;
         |SIGUE;
     |FINSI;
|FCAL;

|CALCULO esbuena; || desde campo de empresas seleccion

  |SI FSalida = 9;
      |ERROR;
      |SUB_EJECUTA_NP "caconemp";
      |SI r_emp ! 0;
          #0Campo = r_emp;
          |PINTA #0Campo;
          |PTEC 802;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #0Campo = 0;
       nume2 = Campo + 20; #0nume2 = ""; |PINTA #0nume2;
       |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
             #0nCampo = 0; |PINTA #0nCampo;
             |C_M #0nCampo, 1, "N";
             nume2 = nCampo + 20;
             #0nume2 = ""; |PINTA #0nume2;
       |SIGUE;
       |ACABA;
  |SINO;
       |PARA nCampo = Campo + 1;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
             |C_M #0nCampo, 1, "S";
       |SIGUE;
  |FINSI;

  |ABRE #30;
  #30#2 = #0Campo;
  #30#3 = 0;
  |LEE 011#30];
  |SI FSalida ! 0;  |O #30#2 ! #0Campo;
      |MENAV "     NO Existe la empresa Contable";
      |ERROR;
  |SINO;
      nume1 = Campo + 20;
      #0nume1 = #30#1;
      |PINTA #0nume1;
  |FINSI;
  |CIERRA #30;
|FCAL;


|| *************************************************************************

|PROGRAMA;

 |CLS;
 |CABEZA "Control Altas Automaticas";

 |PINPA #0#0;
 |ABRE #0;
 |DDEFECTO #0;
 |LEE 101#0p;
 |SI FSalida ! 0;
     |GRABA 020#0b;
 |FINSI;
 |PINDA #0#0;

 |ENDATOS #1#0;
 |SI FSalida = 0;
     |GRABA 020#0a;
 |FINSI;

 |LIBERA #0;
 |CIERRA #0;
|FPRO;
