|FICHEROS;
    cainffic #0;
    camocabe #1;
    camoline #2;
    camogrup #3;
|FIN;

|VARIABLES;
   &entrada = 1;
   informe = "cainffic";
   &tipo = "";
   &tiamoc = "";
   &tiamo = "";
   &valor = 0;
   &amorc = 0;
   &amor = 0;
   &resid = 0;
   &residc = 0;
   &cta1 = "";
   &cta2 = "";
   &am_ap ="";
   amo = "A";
   ulti = "";
   ene = "N";
   nueva = "NUEVA";
   usada = "USADA";
   norma = "NORMAL";
   acele = "ACELERADA";
   degre = "DEGRESIVA";
   residual = "RESIDUAL";
   alfa1 ="";
   &swfv=0;
   fecha=0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;
|INCLUYE numamo_i;
|INCLUYE vardep_i;

|PROCESO numamo; |TIPO 0;
    x_alfa1 = #0Campo;
|HAZ x_punto;
    #0Campo = x_alfa1;
    |PINTA #0Campo;
|FPRC;

|PROCESO no_dep; |TIPO 7;
   alfa1 = #30#24;
   |C_M #0#5, 1, alfa1;
   |C_M #0#6, 1, alfa1;
|FPRC;

|PROCESO cuenta; |TIPO 0;
    p_alfa1 = #0Campo;
    salidas = FSalida;
|HAZ punto;
|SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
|FPRC;

|PROCESO imprelin;
  |SI #2#4 = amo;
    amor  = amor + #2#5;
    amorc = amorc + #2#9;
  |FINSI;
  |SI #2#4= "C";
      valor = valor + #2#5;
  |FINSI;
      resid = valor - amor;
      residc = valor - amorc;
  |PRINT;
|FPRC;

|PROCESO ctas_grup;
   cta1 = "            ";
   cta2 = "            ";
   #3#0 = #1#15;
   |LEE 001#3=;
   |SI FSalida ! 0; |ACABA; |FINSI;
   cta1 = #3#1;
   cta2 = #3#3;
|FPRC;

|PROCESO fechafac;
  |SI #0#4 = "N";
      |SI #1#22 = "N"; |ACABA; |FINSI;
  |FINSI;
  |HAZ ctas_grup; || lee el grupo para saber las cuentas de amort.

  eaNombreAct = "";
  |SI eaDepar = "S";
      eOpDep    = 0;
      eaCodDep  = #1#28;
      eSwNoalta = 1;
      |HAZ Actividad;
  |FINSI;

|| ----- cambiar literales para la ficha -----------------------------------
  tipo = usada;
       |SI #1#8 = ene; tipo = nueva; |FINSI;
  tiamo = norma;
       |SI #1#10 = "D"; tiamo = degre;    |FINSI;
       |SI #1#10 = "A"; tiamo = acele;    |FINSI;
       |SI #1#10 = "R"; tiamo = residual; |FINSI;
  tiamoc = norma;
       |SI #1#16 = "D"; tiamoc = degre;    |FINSI;
       |SI #1#16 = "A"; tiamoc = acele;    |FINSI;
       |SI #1#16 = "R"; tiamoc = residual; |FINSI;
  am_ap = "Anual";
       |SI #1#21 = "P"; am_ap = "Periodica"; |FINSI;
  swfv=0;
  fecha=#1#23;
  |SI fecha ] 0; swfv=1; |FINSI;
  valor = 0;
  amorc = 0;
  amor  = 0;
  residc = 0;
  resid = 0;
  |BUCLELIN 2imprelin#1;
  |PIEINF;
|FPRC;

|DEFBUCLE cainffic0;
 #1#4;
 0,28;             || 0 = campo elemento 28 = Departamento
 #0#0,0,#0#2,#0#5; || indica campos de clave + elemento para seleccionar
 #0#1,9,#0#3,#0#6;
 e;
 NULL,fechafac;
|FIN;

|PROCESO impre; |TIPO 3;
  |IMPRE 0;
  |SI FSalida = 0;
      |INFOR informe;
      |SI FSalida = 0;
          |ABRE #3;
          |BUCLE cainffic0;
          |CIERRA #3;
          |FININF;
      |FINSI;
  |FINSI;
  |FINIMP;
|FPRC;
