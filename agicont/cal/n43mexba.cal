|FICHEROS;
    n43mexba #0;       || Este Def.
    cacuenta #2;       || Cuentas Contables.
    n43datos #3;       || Datos Importados.
    n43tempf #4,MANTE; || Temporal Datos Importados.
    camaasil #5;       || Lineas Apuntes.
    n43tempg #6,MANTE; || Temporal Asientos.
    n43consl #10;      || consolidados.
|FIN;

|VARIABLES;
    fichero1 = "";
    contador = 0;
    contadorc = 0;
    fd = @;
    fh = @;
    fichero = "";
    &entrada = 1;
    cont = 0;
    long = "  ";
    cta  = 0;
    men1  = "     NO EXISTE EMPRESA !";
    men2  = "     Longitud de Cuenta Fuera de Nivel !";
    num   = 0;
    sw = 0;
    juan = "            ";
    ctanum = 0;
    ctaalf = "";
    longnum = "";
    vacio = "            ";
    xxxxfiac = " ";
    xxaponer = " ";
    xrelleno = "                              ";
     letra = "";
     alfa1 = "";
     alfa2 = "";
     final = "";
     x = "";
     nume1 = 0;
     nume2 = 0;
     lugar = 0;
     nifnum = 0;
     resto = 0;
     cuentat = "";
     inkey = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;


|PROGRAMA;
     |HAZ inicio;
     |CLS;
     |CABEZA "Consolidacion Manual";
     |PINPA #0#0;

 |ET Vuelve;
     inkey = 0;
     |ENCAMPO #0#0;
     |SI FSalida = 0;
          |HAZ asiento;
          |VETE Vuelve;
     |FINSI;

|FPRO;

|PROCESO cuenta;|TIPO 6;
    entrada = 1;
    p_alfa1 = #0Campo;
    salidas = FSalida;
|HAZ punto;
|SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
    cta  = #0#0;
    long = cta % A0;
    cont = 0;
    sw = 0;
|PARA num = 14;|SI num [ 19;|HACIENDO num = num + 1;
        cont = cont + 1
    |SI long = #30num;
            sw = 1;
            num = 19;
    |FINSI;
|SIGUE;
|SI sw = 0;
    |MENAV men2;
    |ERROR;
    |ACABA;
|FINSI;
    #0#1 = cont;
|FPRC;


|PROCESO tecla; |TIPO 11;
     |SI FSalida = 9;
          |PTEC 806;
          inkey = 9;
     |FINSI;
     |SI FSalida = 10;
          |PINTA 1064, #6#10;
          |PINTA 1164, #6#12;
          |HAZ cargad;
          inkey = 10;
          |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO camaasil;
 |SI #5#18 ! "û";
   #10#10  = #5#4; ||Cuenta Apunte;
   #10#11  = #5#5; ||Digito;
   #10#12  = #5#1; ||Fecha Apunte;
   #10#13  = #5#2; ||Documento Apunte;
   #10#18  = #5#0; ||Diario
   #10#19  = #5#3; ||Apunte
   |LEE 040#10=;  ||Lee Fichero Consolidaciones;
   |SI FSalida ! 0;
        contador = contador + 1;
        #6#0   = contador;
        #6#1   = #5#4;
        #6#2   = #5#0;
        #6#3   = #5#1;
        #6#4   = #5#2;
        #6#5   = #5#3;
        #6#6   = #5#5;
        #6#7   = #5#6;
        #6#8   = #5#7;
        #6#9   = #5#8;
        #6#10  = #5#9;
        #6#11  = " ";
        #6#12  = 0;
        |GRABA 000#6n;
   |FINSI;
 |FINSI;
 |LIBERA #5;
|FPRC;

|DEFBUCLE camaasil;
  #5#3;
  ;
  #0#0,#0#1,fd,000000;
  #0#0,#0#1,fh,999999;
  be;
  NULL,camaasil;
|FIN;

|PROCESO n43datos;
     #4#0   = #3#0;
     #4#1   = #3#1;
     #4#2   = #3#2;
     #4#3   = #3#3;
     #4#4   = #3#4;
     #4#5   = #3#5;
     #4#6   = #3#6;
     #4#7   = #3#7;
     #4#8   = #3#8;
     #4#9   = #3#9;
     #4#10  = #3#10;
     #4#11  = #3#11;
     #4#12  = #3#12;
     #4#13  = 0;
     #4#14  = " ";
     |GRABA 000#4n;
     |LIBERA #3;
|FPRC;


|DEFBUCLE n43datos;
  #3#2;
  9,11;
  #0#0,000000,"N","N";
  #0#0,999999,"N","N";
  e;
  NULL,n43datos;
|FIN;


|PROCESO cargad;
     fichero = Usuario; fichero = "T0" + fichero;
     |QBF fichero;
     |NOME_DAT #4 fichero;
     |DELINDEX #4;
     |ABRE #4;
     |BUCLE n43datos;

  |ET enli;
     ||PINPA #0#4;
     inkey = 0;
     |ENTLINEAL #1#4, -2 , 4 , 12 , 1 , inff , supf;
     |SI inkey ! 9; |VETE enli;  |FINSI;
     |SI #6#12 ! 0; |HAZ actua; |FINSI;
     |CIERRA #4;
     |DELINDEX #4;

|FPRC;

|RUTINA inff;
     #4#1 = #0#0;
     #4#0 = 000001;
|FRUT;

|RUTINA supf;
     #4#1 = #0#0;
     #4#0 = 999999;
|FRUT;


|PROCESO asiento;
     fichero1 = Usuario; fichero1 = "T1" + fichero1;
     |QBF fichero1;
     |NOME_DAT #6 fichero1;

   |ET enlisi;
     |DELINDEX #6;
     |ABRE #6;
     |ABRE #10;
     |SELECT #3#10;
     contador = 0;
     fd = "01.01.1900";
     fh = "31.12.2300";
     |BUCLE camaasil;
     |CIERRA #10;
   |ET asi;
     |PINPA #0#6;
     inkey = 0;
     |ENTLINEAL #1#6, -2 , 4 , 21 , 0 , infa , supa;
     |SI inkey ! 9; |Y inkey ! 10; |VETE asi; |FINSI;
     |SI inkey = 10;
          |CIERRA #6;
          |VETE enlisi;
     |FINSI;
     |CIERRA #6;
     |DELINDEX #6;
|FPRC;


|PROCESO tecla2; |TIPO 11;
     |SI FSalida = 9;
          |PTEC 806;
          inkey = 9;
     |FINSI;
     |SI FSalida = 10;
          |HAZ graba;
          inkey = 0;
     |FINSI;
|FPRC;

|RUTINA infa;
     #6#1 = #0#0;
     #6#0 = 000001;
|FRUT;

|RUTINA supa;
     #6#1 = #0#0;
     #6#0 = 999999;
|FRUT;

|PROCESO graba;
     |SI #4#14 = "*";
          #4#14 = " ";
          #6#12 = #6#12 - #4#7;
          |PINTA 1164, #6#12;
     |SINO;
          #4#14 = "*";
          #6#12 = #6#12 + #4#7;
          |PINTA 1164, #6#12;
     |FINSI;
     |GRABA 000#4a;
|FPRC;

|PROCESO cpentrad;
  #3#0  = #4#0;
  |LEE 040#3=;
  |SI FSalida = 0;
           contadorc = contadorc + 1;
           #10#0  = contadorc; #10#1  = #4#0; #10#2  = #4#1;  #10#3  = #4#2;
           #10#4  = #4#3;      #10#5  = #4#4; #10#6  = #4#5;  #10#7  = #4#6;
           #10#8  = #4#7;      #10#9  = #4#8;

           #10#10 = #6#1;      #10#11 = #6#6; #10#12 = #6#3;  #10#13 = #6#4;
           #10#14 = #6#7;      #10#15 = #6#8; #10#16 = #6#9;  #10#17 = #6#10;
           #10#18 = #6#2;      #10#19 = #6#5;

           #10#20 = 2;  || Consolidacion Uno / Varios

           |GRABA 040#10n;
           #3#9 = "S";
           |GRABA 020#3a;
   |FINSI;
|FPRC;

|DEFBUCLE cpentrad;
  #4#1;
  14;
  #0#0,000000,"*";
  #0#0,999999,"*";
  ;
  NULL,cpentrad;
|FIN;

|PROCESO actua;
   |ABRE #10;
   |LEE 040#10u;
   contadorc = #10#0;
   |ABRE #3;
   |BUCLE cpentrad;           || Bucle entrada;
   |CIERRA #10;
   |CIERRA #3;
|FPRC;
