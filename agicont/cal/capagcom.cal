|FICHEROS;
    capagcom #0;
    cacuadre #9;
    capagcab #10;
|FIN;

|VARIABLES;
   &totbar = "";
   &importe = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &dia = "";
    &mes = "";
    &any = "";
    &dia_e = "";
    &dianum = 0;
    &mes_e = "";
    &any_e = "";
    &des = "";

    opcion = 0;
{-1}menu = "";
    menu1 = "2400";
    menu2 = "1";
    menu3 = " Elija opcion: ";
    menu4 = "RIS";
    menu5 = " Revisar ";
    menu6 = " Imprimir ";
    menu7 = " Salir ";
    cuadre = 1;
    informe = "";
    &enCanti = 0;
    &eaCanti = "";
|FIN;

|INCLUYE acceso_i;
____________________________________/
|PROCESO fec_emisi;
    alfa1 = #0#1;
    dia_e = alfa1 % 102;
    dianum = dia_e;
    mes_e = alfa1 % 402;
    any_e = alfa1 % -102;
|SI mes_e = "01";  mes_e = "Enero     ";  |FINSI;
|SI mes_e = "02";  mes_e = "Febrero   ";  |FINSI;
|SI mes_e = "03";  mes_e = "Marzo     ";  |FINSI;
|SI mes_e = "04";  mes_e = "Abril     ";  |FINSI;
|SI mes_e = "05";  mes_e = "Mayo      ";  |FINSI;
|SI mes_e = "06";  mes_e = "Junio     ";  |FINSI;
|SI mes_e = "07";  mes_e = "Julio     ";  |FINSI;
|SI mes_e = "08";  mes_e = "Agosto    ";  |FINSI;
|SI mes_e = "09";  mes_e = "Septiembre";  |FINSI;
|SI mes_e = "10";  mes_e = "Octubre   ";  |FINSI;
|SI mes_e = "11";  mes_e = "Noviembre ";  |FINSI;
|SI mes_e = "12";  mes_e = "Diciembre ";  |FINSI;
|FPRC;

|PROCESO fec_venci;
    alfa1 = #0#2;
    dia = alfa1 % 102;
    mes = alfa1 % 402;
    any = alfa1 % -102;
|SI mes = "01";  mes = "Enero     ";  |FINSI;
|SI mes = "02";  mes = "Febrero   ";  |FINSI;
|SI mes = "03";  mes = "Marzo     ";  |FINSI;
|SI mes = "04";  mes = "Abril     ";  |FINSI;
|SI mes = "05";  mes = "Mayo      ";  |FINSI;
|SI mes = "06";  mes = "Junio     ";  |FINSI;
|SI mes = "07";  mes = "Julio     ";  |FINSI;
|SI mes = "08";  mes = "Agosto    ";  |FINSI;
|SI mes = "09";  mes = "Septiembre";  |FINSI;
|SI mes = "10";  mes = "Octubre   ";  |FINSI;
|SI mes = "11";  mes = "Noviembre ";  |FINSI;
|SI mes = "12";  mes = "Diciembre ";  |FINSI;
|FPRC;

|PROCESO lee_pagares1;
|INFOR informe;
|SI FSalida = 0;
    |HAZ fec_emisi;
    |HAZ fec_venci;
        des = #0#4;      || descripcion

        #10#9 = #0#3;    || importe
        importe = #10#9;
        enCanti = importe;     |HAZ ConBarras;     totbar = eaCanti;
    |PRINT;
    |PIEINF;
    |FININF;
|SINO;
        alfa1 = "    Cuadre [" + informe + "] inaccesible o inexistente ...";
    |MENAV alfa1;
    |ERROR10;
|FINSI;
|FPRC;

|DEFBUCLE lee_pagares;
 #0#1;
 ;
  1;
 99;
 ;
 NULL, lee_pagares1;
|FIN;

|PROCESO informa;
  |ATRI I;
  |CUADRO 10 49 21 78;
  |ATRI N;
  |PINTA 1150 ,  "01-[        ]  11-[        ]";
  |PINTA 1250 ,  "02-[        ]  12-[        ]";
  |PINTA 1350 ,  "03-[        ]  13-[        ]";
  |PINTA 1450 ,  "04-[        ]  14-[        ]";
  |PINTA 1550 ,  "05-[        ]  15-[        ]";
  |PINTA 1650 ,  "06-[        ]  16-[        ]";
  |PINTA 1750 ,  "07-[        ]  17-[        ]";
  |PINTA 1850 ,  "08-[        ]  18-[        ]";
  |PINTA 1950 ,  "09-[        ]  19-[        ]";
  |PINTA 2050 ,  "10-[        ]  20-[        ]";
  |ATRI I;
  |PINTA 1154,  #9#7;  |PINTA 1169, #9#25;
  |PINTA 1254,  #9#8;  |PINTA 1269, #9#26;
  |PINTA 1354,  #9#9;  |PINTA 1369, #9#27;
  |PINTA 1454,  #9#10; |PINTA 1469, #9#28;
  |PINTA 1554,  #9#11; |PINTA 1569, #9#29;
  |PINTA 1654,  #9#12; |PINTA 1669, #9#30;
  |PINTA 1754,  #9#13; |PINTA 1769, #9#31;
  |PINTA 1854,  #9#14; |PINTA 1869, #9#32;
  |PINTA 1954,  #9#15; |PINTA 1969, #9#33;
  |PINTA 2054,  #9#16; |PINTA 2069, #9#34;
  |ATRI 0;
|FPRC;

|PROCESO pide_cuadre;
|PUSHV 1049 2178;
|HAZ informa;
    E_inf = 1;
    E_sup = 20;
|PINTA 2310, "Numero de Formato a utilizar: ";
    cuadre = 2340 ? 1;
|SI FSalida = 0;
    |SI cuadre [ 10;    para1 = cuadre + 6;      |FINSI;
    |SI cuadre > 10;    para1 = cuadre + 14;     |FINSI;
        informe = #9para1;
    |QBF informe;
    |SI informe = "";
        |MENAV "    Formato no configurado ...";
            informe = "NO";
    |FINSI;
|FINSI;
|POPV;
|FPRC;

|PROCESO imprime;
    elsw1 = 0;
|ABRE #0;
|LEE 000#0p;
|SI FSalida = 0;
        elsw1 = 1;
|FINSI;
|CIERRA #0;

|SI elsw1 = 1;
    |IMPRE 0;
    |SI FSalida = 0;
            informe = "NO";
        |HAZ pide_cuadre;
        |SI informe ! "NO";
            |BUCLE lee_pagares;
        |FINSI;
    |SINO;
        |MENAV "    Proceso abortado ...";
    |FINSI;
    |FINIMP;
|SINO;
    |MENAV "    Seleccion vacia ...";
|FINSI;
|FPRC;

|PROCESO min0;
    #0#0 = 1;
|FPRC;

|PROCESO max0;
    #0#0 = 99;
|FPRC;

|PROGRAMA;
 |HAZ inicio;
|CLS;
|CABEZA "Comprob.Pagares";
    alfa1 = Usuario;     |QBF alfa1;
|NOME_DAT #0 alfa1;
|DELINDEX #0;

|DDEFECTO #9;
|ABRE #9;           || config.cuadres
|LEE 000#9p;
|CIERRA #9;

|PARA; |SI; |HACIENDO;
    |ENTLINEAL #1#0, 1, 1, 20, 1, min0, max0;
    |MENU menu;
        opcion = FSalida;
    |SI opcion = 2; |HAZ imprime; |FINSI;
    |SI opcion = 3; |SAL;         |FINSI;
|SIGUE;

|DELINDEX #0;
|FPRO;
