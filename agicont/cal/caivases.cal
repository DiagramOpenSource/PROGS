|FICHEROS;
     caivases #0;
     caivarep #1;
     caivasop #2;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;

     ModoEntrada = 0;

     Numero = 0;
|FIN;

|INCLUYE vardep_i;

|| ******************************************************************
|PROCESO caivasop_1;
     |DDEFECTO #0;
     #0#0 = #2#27;
     #0#1 = "S";
     |LEE 101#0=;
     |SI FSalida ! 0;
          |GRABA 020#0b;
     |FINSI;
     |SI #0#3 [ #2#2;
         #0#3 = #2#2 + #0#4;
         |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE caivasop;
 #2#1;
 ;
 00, "  ",      0;
 99, "zz", 999999;
 ;
 NULL, caivasop_1;
|FIN;

|PROCESO caivarep_1;
     |DDEFECTO #0;
     #0#0 = #1#27;
     #0#1 = "R";
     |LEE 101#0=;
     |SI FSalida ! 0;
          |GRABA 020#0b;
     |FINSI;
     |SI #0#3 [ #1#2;
         #0#3 = #1#2 + #0#4;
         |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE caivarep;
 #1#1;
 ;
 00, "  ",      0;
 99, "zz", 999999;
 ;
 NULL, caivarep_1;
|FIN;


|PROCESO Tipo8; |TIPO 8;

   |ABRE #0;
   |LEE 000#0p;
   |SI FSalida ! 0;
       |PINPA #0#0;
       |AVISO;
       |CONFI "0000NNo hay registros. Recuperar (S/N): ";
       |SI FSalida = 0;
           |BUCLE caivarep;
           |BUCLE caivasop;
       |FINSI;
    |FINSI;
    |CIERRA #0;

    |HAZ BuscaModulo;

    |SI swModulo = 1872;
        |SUB_EJECUTA_NP "cazserie";
        |PTEC 807;
    |FINSI;
|FPRC;

|| *********************************************************************
|| ////////////////////////////////////////////

|PROCESO caivasop1;
   |SI #2#2 > Numero; Numero = #2#2; |FINSI;
|FPRC;

|DEFBUCLE caivasop1;
 #2#1;
 ;
 00,#0#0,000001;
 99,#0#0,999999;
 ;
 NULL,caivasop1;
|FIN;

|PROCESO caivarep1;
   |SI #1#2 > Numero; Numero = #1#2; |FINSI;
|FPRC;

|DEFBUCLE caivarep1;
 #1#1;
 ;
 00,#0#0,000001;
 99,#0#0,999999;
 ;
 NULL, caivarep1;
|FIN;

|PROCESO ContaSerie; |TIPO 7;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 1;
       |SI #0#1 = "R";
           Numero = 0;
           |BUCLE caivarep1;
           #0#3 = Numero + #0#4;
      |FINSI;
      |SI #0#1 = "S";
          Numero = 0;
          |BUCLE caivasop1;
          #0#3 = Numero + #0#4;
      |FINSI;
   |FINSI;
|FPRC;
