|FICHEROS;
     caem3390 #0;
     cama3390 #7;
     cama4390 #8;
     cama5390 #9;
     caportad #2;
|FIN;

|VARIABLES;
  alfa1 = "";
  nume1 = 0;
  longi = 0;
  fecsys = @;
  mesm   = 0;

     informe   = "";

     sw_fisica = 0;
     vacio_20  = "                    ";
     vacio_16  = "                ";
     vacio_12  = "            ";
     vacio_10  = "          ";
     x         = 0;
     sw_sigue  = 0;
     sw_impre  = 0;
     d_cliente = 0;
     h_cliente = 0;
     aAlfa     = "";

     &dia      = "";
     &mes      = "";
     &anyo     = "";
     &any      = "";
     &sw_sit   = 0;
     &d_empre  = 0;
     &h_empre  = 0;
     &el_anyo  = 0;
     &eaDirInternet = "";
     &enAnyo        = 0;
     &eaUnidadBasico = "";
  {1}aContiene       = "";
|FIN;

|INCLUYE acceso_i;

|PROCESO defecto; |TIPO 7;
  #0Campo = #30#26;
  |PINTA #0Campo;
|FPRC;

|PROCESO mayor; |TIPO 0;
 #0Campo = #0Campo > " ";
 |PINTA #0Campo;
|FPRC;

|| ***********************************************************************
|PROCESO impblanco;
  |INFOR "caeb139n";       ||Primera y Segunda Hoja del 390
  |SI FSalida = 0;
      |PRINT;
      |PIEINF;
      |FININF;
  |FINSI;

  |INFOR "caeb339n";       ||Tercera hoja del 390
  |SI FSalida = 0;
      |PRINT;
      |PIEINF;
      |FININF;
  |FINSI;

  |INFOR "caeb539n";       ||Quinta Hoja del 390
  |SI FSalida = 0;
      |PRINT;
      |PIEINF;
      |FININF;
  |FINSI;
|FPRC;
|| ---------------------------Imprimir Nuevo Cuadre

|PROCESO hoja1_95;
  |SI #0#0 = 97;               |INFOR "ca973901";  |FINSI;
  |SI #0#0 ] 98; |O #0#0 < 80; |INFOR "ca983901";  |FINSI;
  |SI FSalida ! 0; sw_impre = 1; |FININF; |ACABA; |FINSI;

  |PRINT;
  |PIEINF;
  |FININF;
|FPRC;

|PROCESO hoja2_95;
  |SI #0#0 = 97;                 |INFOR "ca973902";  |FINSI;
  |SI #0#0 ] 98; |O #0#0 < 80;   |INFOR "ca983902";  |FINSI;
  |SI FSalida ! 0; sw_impre = 1; |FININF; |ACABA; |FINSI;

  sw_impre = 0;

  |PRINT;
  |PIEINF;
  |FININF;
|FPRC;

|PROCESO hoja3_95;
  |SI #0#0 = 97;                 |INFOR "ca973903";  |FINSI;
  |SI #0#0 ] 98; |O #0#0 < 80;   |INFOR "ca983903";  |FINSI;
  |SI FSalida ! 0; sw_impre = 1; |FININF; |ACABA; |FINSI;

  sw_impre = 0;

  |PRINT;
  |PIEINF;
  |FININF;
|FPRC;

|PROCESO hoja4_95;
  |SI #0#0 = 97;                |INFOR "ca973904";  |FINSI;
  |SI #0#0 ] 98;|O #0#0 < 80;   |INFOR "ca983904";  |FINSI;
  |SI FSalida ! 0; sw_impre = 1; |FININF; |ACABA; |FINSI;

  sw_impre = 0;

  |PRINT;
  |PIEINF;
  |FININF;
|FPRC;

|PROCESO hoja5_95;
  |SI #0#0 = 97;                |INFOR "ca973905";  |FINSI;
  |SI #0#0 ] 98; |O #0#0 < 80;  |INFOR "ca983905";  |FINSI;
  |SI FSalida ! 0; sw_impre = 1; |FININF; |ACABA; |FINSI;

  sw_impre = 0;

  |PRINT;
  |PIEINF;
  |FININF;
|FPRC;

|PROCESO impre95;
  |SI sw_impre = 0; |HAZ hoja1_95; |FINSI;
  |SI sw_impre = 0; |HAZ hoja2_95; |FINSI;
  |SI sw_impre = 0; |HAZ hoja3_95; |FINSI;
  |SI sw_impre = 0; |HAZ hoja4_95; |FINSI;
  |SI sw_impre = 0; |HAZ hoja5_95; |FINSI;

  #7#3 = #0#1;
  #7#4 = "N";
  |GRABA 020#7a;
  |LIBERA #7;
|FPRC;

|PROCESO fecha;
     dia = #0#1 % 102;
     any = #0#1 % 704;
     anyo = any;
     mes = #0#1 % 402;
     mesm = mes;
     |SI mesm = 1;  mes = "ENERO";      |FINSI;
     |SI mesm = 2;  mes = "FEBRERO";    |FINSI;
     |SI mesm = 3;  mes = "MARZO";      |FINSI;
     |SI mesm = 4;  mes = "ABRIL";      |FINSI;
     |SI mesm = 5;  mes = "MAYO";       |FINSI;
     |SI mesm = 6;  mes = "JUNIO";      |FINSI;
     |SI mesm = 7;  mes = "JULIO";      |FINSI;
     |SI mesm = 8;  mes = "AGOSTO";     |FINSI;
     |SI mesm = 9;  mes = "SEPTIEMBRE"; |FINSI;
     |SI mesm = 10; mes = "OCTUBRE";    |FINSI;
     |SI mesm = 11; mes = "NOVIEMBRE";  |FINSI;
     |SI mesm = 12; mes = "DICIEMBRE";  |FINSI;
|FPRC;

|PROCESO impre;|TIPO 3;
     |HAZ fecha;
     |HAZ LeeUnidadBas_Local;

     |ABRE #7;
     #7#0 = #30#2;
     #7#1 = #0#0;
     |LEE 101#7=;
     |SI FSalida ! 0;
         |MENAV "0000SELECCION VACIA";
         |CIERRA #7;
         |ACABA;
     |FINSI;
     |LIBERA #7;

     |ABRE #8;
     #8#0 = #30#2;
     #8#1 = #0#0;
     |LEE 001#8=;
     |SI FSalida ! 0; |DDEFECTO #8; |FINSI;
     |CIERRA #8;

     |ABRE #9;
     #9#0 = #30#2;
     #9#1 = #0#0;
     |LEE 001#9=;
     |SI FSalida ! 0; |DDEFECTO #9; |FINSI;
     |CIERRA #9;

     |ABRE #2;
     #2#0 = #30#2;
     #2#1 = #30#26;
     |LEE 001#2=;
     |SI FSalida ! 0;
         |MENAV "0000No se encuentra el fichero de Portadas Modelos";
         |CIERRA #2;
         |CIERRA #7;
         |ACABA;
     |FINSI;

     |HAZ ProcesoUnicoXml;

     |CIERRA #7;
     |CIERRA #2;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#3 = eaMoneda;
     |SI #0#3 = "PESETAS";
         |MENAV "     Obligada la Emision en EUROS, cambien la Moneda en el Menu Ver";
         |ERROR;
     |FINSI;

     |SI #0#0 ] 80;
         enAnyo = 1900 + #0#0;
     |SINO;
         enAnyo = 2000 + #0#0;
     |FINSI;

     |C_M #0#2, 1, "S";
     |SI enAnyo ] 2004;
         |C_M #0#2, 1, "N";  #0#2 = "";  |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO LeeUnidadBas_Local;
     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     eaUnidadBasico = (aContiene1 % 102) > "";

     aAlfa = eaUnidadBasico % -101;
     |SI aAlfa ! ":";
         eaUnidadBasico = "";
     |FINSI;
|FPRC;
