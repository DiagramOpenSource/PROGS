|FICHEROS;
     cacup115 #0;
     cacuenta #1;
     camandia #3;
|FIN;

|VARIABLES;
     &entrada = 1;
     salidas = 0;
     cta_t = 0;
     dig_t = 0;
     alfa1 = "";
     alfa2 = "";
     long = 0;
     sw = 0;
     nopintes = 0;
     x = 0;
     y = 0;
     z = 0;
|FIN;

|INCLUYE inici1_i;
|INCLUYE puntos_i;

|PROCESO diario;
     |ABRE #3;
     #3#0 = #0#1;
     |LEE 000#3=;
     |SI nopintes = 0;
         |ATRI I;  |PINTA 1436, #3#1;  |ATRI 0;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO cuefin;
     cta_t = Campo;
     dig_t = Campo + 8;
     #1#0 = #0cta_t
     #1#1 = #0dig_t;
     |LEE 001#1=;
     |SI FSalida ! 0;  |ERROR;  |ACABA;  |FINSI;
     |SI #1#3 = "N";
         |MENAV "     La Cuenta NO tiene PASE DIRECTO";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI Campo = 3
         |SI #0Campo = "            ";
             |C_M #0#3,1,"N";  #0#3 = "";  |PINTA #0#3;
             |C_M #0#4,1,"N";  #0#4 = "";  |PINTA #0#4;
             |C_M #0#7,1,"N";  #0#7 = 0;   |PINTA #0#7;
             |C_M #0#8,1,"N";  #0#8 = 0;   |PINTA #0#8;
         |SINO;
             |C_M #0#3,1,"S";
             |C_M #0#4,1,"S";
             |C_M #0#7,1,"S";
             |C_M #0#8,1,"S";
         |FINSI;
     |FINSI;

     |SI Campo = 5;
         |SI #0Campo = "            ";
             |C_M #0#5, 1,"N";  #0#5  = "";  |PINTA #0#5;
             |C_M #0#6, 1,"N";  #0#6  = "";  |PINTA #0#6;
             |C_M #0#9, 1,"N";  #0#9  = 0;   |PINTA #0#9;
             |C_M #0#10,1,"N";  #0#10 = 0;   |PINTA #0#10;
         |SINO;
             |C_M #0#5, 1,"S";
             |C_M #0#6, 1,"S";
             |C_M #0#9, 1,"S";
             |C_M #0#10,1,"S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
     p_alfa1 = #0Campo;
     salidas = FSalida;
     |HAZ punto;
     |SI p_error ! 0;
         |MENAV "     ERROR EN CUENTA";
         |ERROR;
         |ACABA;
     |FINSI;
     cta_t = Campo;
     dig_t = cta_t + 8;
     |HAZ cuenta_t;
|FPRC;

|PROCESO cuenta_t;
     alfa1 = #0cta_t;  |QBF alfa1;
     alfa2 = alfa1 % 0;
     long = alfa2;
     sw = 0;

     |SI long = dig4;  sw = 1;  #0dig_t = 1;  |FINSI;
     |SI long = dig5;  sw = 1;  #0dig_t = 2;  |FINSI;
     |SI long = dig6;  sw = 1;  #0dig_t = 3;  |FINSI;
     |SI long = dig7;  sw = 1;  #0dig_t = 4;  |FINSI;
     |SI long = dig8;  sw = 1;  #0dig_t = 5;  |FINSI;
     |SI long = dig9;  sw = 1;  #0dig_t = 6;  |FINSI;
     |SI long = 0;     sw = 1;  #0dig_t = 0;  |FINSI;
     |SI sw = 0;
         #0dig_t = 0;
         |MENAV "      Longitud de Cuenta Fuera de Nivel ";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO altapase;
     Campo = 1;
     #0#1  = 1;
     nopintes = 1;
     |HAZ diario;
     nopintes = 0;
|FPRC;

|PROGRAMA;
     entrada = 1;
     |HAZ comienzo;
     |CLS;
     |PINPA #0#0;
     |CABEZA "Cuentas Asto Mod.115";
     |ABRE #0;
     |ABRET #1;
     #0#0 = 1;
     |LEE 000#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         |HAZ altapase;
         #0#0 = 1;
         |GRABA 020#0c;
     |FINSI;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
        #0#0 = 1;
        |GRABA 020#0a;
     |FINSI;
     |CIERRA #0;
     |CIERRAT #1;
|FPRO;
