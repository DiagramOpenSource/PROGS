|FICHEROS;
    careccab #0;
    camaasic #1;
    camaasil #2;
    caconasi #20;
|FIN;

|VARIABLES;
    &entrada = 1;
    feini = @;
    fefin = @;
    doini = 1;
    dofin = 999999;
    prim = 0;
    cuant = "";
    lon = 0;
    aa = 0;
    ini = 0;
    fecalf = "";
    mes = "";
    mesfec = 0;
    mesac = 0;
    a = 0;
    b = 0;
    c = 0;
    mensa = "";
    aar = "";
    traba = "";
    mensaa = "";
    errant = "aaaaaaaaaaaa";
    uno = "";
    dos = "";
    mascara = "";
    nivel = 0;
|FIN;

|INCLUYE acceso_i;

|PROCESO mayus;
  #0Campo = #0Campo > " "; |PINTA #0Campo;
  |SI #0Campo = "S";
      |CONFI "    NEsta Seguro de Borrar las Cabeceras";
      |SI FSalida ! 0;
          #0Campo = "N"; |PINTA #0Campo;
          |ERROR;
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO acerar;
    #1#4 = 0;       || debe
    #1#5 = 0;       || haber
    #1#6 = 0;       || saldo
    #1#8 = "";      || contrap. HABER
    #1#9 = 0;       || dig.contrap.HABER
    #1#10 = "";     || contrap. DEBE
    #1#11 = 0;      || dig.contrap.DEBE
|GRABA 020#1a;
|LIBERA #1;
|FPRC;

|DEFBUCLE careccab0;
 #1#1;
 ;
  0, feini,      0;
 99, fefin, 999999;
 be;
 NULL, acerar;
|FIN;

|PROCESO actuali;
|DDEFECTO #1;
    #1#0 = #2#0;
    #1#1 = #2#1;
    #1#2 = #2#2;
|LEE 101#1=;
|SI FSalida ! 0;
        #1#0 = #2#0;
        #1#1 = #2#1;
        #1#2 = #2#2;
        #1#3 = #2#2;
    |GRABA 020#1n;
    |LIBERA #1;
    |LEE 121#1=;
|FINSI;
|SI #2#8 = "D";
        #1#4 = #1#4 + #2#9;
    |SI #1#09 = 0; #1#08 = #2#4; #1#09 = #2#5; |FINSI;      || contrp.HABER
|SINO;
        #1#5 = #1#5 + #2#9;
    |SI #1#11 = 0; #1#10 = #2#4; #1#11 = #2#5; |FINSI;      || contrp.DEBE
|FINSI;
    #1#6 = #1#4 - #1#5;
|GRABA 020#1a;
|LIBERA #1;
  |SI #1#2 > #20#1;  #20#1 = #1#2; |FINSI;
|FPRC;

|DEFBUCLE careccab1;
 #2#1;
 ;
  0, feini, doini,    1;
 99, fefin, dofin, 9999;
 be;
 NULL, actuali;
|FIN;

|PROCESO procal;  |TIPO 3;
|SI #0#0 = "N";
    |PINTA 2410,"Acerando Saldos de Cabeceras";
    feini = "01.01.0000";
    fefin = "31.12.9999";
    |BUCLE careccab0;
 |SINO;
    |ABRE #1;
    |CIERRA #1;
    |DELINDEX #1;
 |FINSI;
 |BLIN 24;
 |PINTA 2410,"Recuperando Cabeceras";
 |ABRE #20;
 |LEE 101#20p;
 |SI FSalida ! 0;
     |DDEFECTO #20;
     |GRABA 020#20b;
 |FINSI;
 #20#1 = 0;
 |ABRE #1;
 feini = "01.01.0000";
 fefin = "31.12.9999";
 |BUCLE careccab1;
 |CIERRA #1;
 |SI #0#1 = "S";
     |GRABA 020#20a;
 |FINSI;
 |LIBERA #20;
 |CIERRA #20;
|FPRC;
