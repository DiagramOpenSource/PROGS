|FICHEROS;
  cafupz04 #0;
  cafupm01 #1;
  cafupm02 #2;
  cafupw05 #999,MANTE;

  cacuenta #15;
  canempre #30;
|FIN;

|VARIABLES;
 &entrada = 1;
 &salidas = 0;
 &enEjercicio = 0;
 &enAny       = 0;
 &eaNombreEmp = "";
 &eaDirDestino = "";
 &eaDirOrigen  = "";
 &eaCuenta = "";
 &enNivel = 0;

 &dig1 = 0;
 &dig3 = 0;
 &dig4 = 0;
 &dig5 = 0;
 &dig6 = 0;
 &dig7 = 0;
 &dig8 = 0;
 &dig9 = 0;

 nTecla = 0;
 nModo  = 0;
 nModoEntrada = 0;

 &nMaxDes  = 0;
 &nMaxOri  = 0;
 {-1}punt1 = 0;
 &ddig3 = 0;
 &ddig4 = 0;
 &ddig5 = 0;
 &ddig6 = 0;
 &ddig7 = 0;
 &ddig8 = 0;
 &ddig9 = 0;

 aAlfa1 = "";
 aAlfa2 = "";
 nNume1 = 0;

 aLong    = "";
 nLong    = 0;
 &nPlaEmp = 0;

 aDCuenta = "";
 aHCuenta = "";
 nerror   = 0;
 aBase    = "";
 aDef     = "";

 &nContar = 0;
 nEstoy   = 0;
 nSwOp    = 0;
 nSwError = 0;
 nConsol  = 0;
 nSwNO    = 0;
|FIN;

|INCLUYE punto2_i;

|| **********************************************************************
|PROCESO Tipo11_w5; |TIPO 11;
  nTecla = FSalida;

  |SI nTecla = 10; |O nTecla = 11;
      |LEE 001#999=;

      |SI nTecla = 10;
          |SI #999#7 = "S";
              #999#7 = "N";
          |SINO;
              #999#7 = "S";
          |FINSI;
          |PINTA #999#7;
      |FINSI;

      |SI #999#7 = "S";
          aAlfa1 = #999#5; |QBF aAlfa1;
          |SI nTecla = 11; |O aAlfa1 = "";
              |ENCAMPO #5#999;
         |FINSI;
      |FINSI;

      |GRABA 020#999a;

      |ERROR;
  |FINSI;
|FPRC;

|PROCESO cuenta5; |TIPO 6;
  salidas = FSalida;
  |SI salidas = 10; |ACABA; |FINSI;

  p_alfa1 = #999Campo;
  |HAZ punto2;
  |SI p_error ! 0;  |ERROR;  |ACABA; |FINSI;

  eaCuenta = #999Campo;
  |HAZ Sacanivel;
  |SI enNivel = 0;
      |MENAV "     Longitud de Cuenta Fuera de Nivel !";
      |ERROR;
  |SINO;
      nNume1   = Campo + 1;
      #999nNume1 = enNivel;
  |FINSI;
|FPRC;

|PROCESO inf15;
 #15#0 = "            ";
 #15#1 = 0;
|FPRC;

|PROCESO sup15;
 #15#0 = "zzzzzzzzzzzz";
 #15#1 = 9;
|FPRC;

|PROCESO cuefinw5_5; |TIPO 0;
  nTecla = FSalida;

  eaCuenta = #999#5;
  enNivel  = #999#6;

  |SI nTecla = 10;
      |ABRE #15;
      #15#0 = #999#5;
      #15#1 = #999#6;
      |CONSULTA_F_CLAVE #1#15, inf15, sup15;
      #999#5 = #15#0;
      #999#6 = #15#1;
      |CIERRA #15;
      |PINTA #999#5;
  |FINSI;

  |ABRE #15;
  #15#0 = #999#5;
  #15#1 = #999#6;
  |LEE 001#15=;
  |SI FSalida ! 0;
      |MENAV "    Error. No Existe Cuenta";
      |CIERRA #15;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #15;

  |SI #15#3 = "N";
      |MENAV "      Esta Cuenta NO tiene Pase directo";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO Sacanivel;
   aLong = eaCuenta; |QBF aLong;
   aLong = aLong % 0;
   nLong = aLong;
   enNivel = 0;
   |SI nLong = dig4; |Y dig4 ! 0; enNivel = 1; |FINSI;
   |SI nLong = dig5; |Y dig5 ! 0; enNivel = 2; |FINSI;
   |SI nLong = dig6; |Y dig6 ! 0; enNivel = 3; |FINSI;
   |SI nLong = dig7; |Y dig7 ! 0; enNivel = 4; |FINSI;
   |SI nLong = dig8; |Y dig8 ! 0; enNivel = 5; |FINSI;
   |SI nLong = dig9; |Y dig9 ! 0; enNivel = 6; |FINSI;
|FPRC;
