|FICHEROS;
 caredm10 #0;
 caredm01 #1;
 camingca #2;  || Confirming Cabeceras
 camingli #3;  || Confirming Lineas

 caclipro #4;  || Clientes/Proveedores
 camanpag #5;  || Pagos
 caivasop #6;  || Iva

 caconcep #7;  || Concepto
 camanban #8;  || Bancos..............

 caacrval #9;
 calisfra #10;
|FIN;

|VARIABLES;
 &fp = "";
 &eaDirProv = "";
 &eaNifProv = "";
 &HayConta = 0;
 &eaCadena = "";

 nCalc      = 0;
 nImporte   = 0;
 Prefijo    = "";
 aRef       = "";
 aDirec1    = "";
 aDirec2    = "";
 fFechaEmis = @;

 &aInforme = "";
 aOrigen  = "";
 aDestino = "";
 Comodin  = "";
 nSwImpre = 0;

 &Niv1 = 0;
 &Niv2 = 0;
 &Niv3 = 0;
 &Niv4 = 0;
 &Niv5 = 0;
 &Niv6 = 0;
 &Divisa = "";

 aCuenta = ""; nNivel = 0;

 alfa1 = "";
 alfa2 = "";
 alfa3 = "";
 alfa4 = "";
 nume1 = 0;
 nume2 = 0;
 nume3 = 0;
 nume4 = 0;

 mens     = "";
 swErrorR = 0;
 swErrorP = 0;
 menR1    = "    No Existe Confirme !!!";
 menR2    = "    Confirme YA contabilizado ";
 menR3    = "2400SConfirme YA Emitido en Papel. Aceptar S/N ";
 menR4    = "2400NConfirme YA lanzado en Diskette. Aceptar S/N ";

 Nombre  = "";
 CodCli  = "";
 sino     = "";
 ceros    = "000000000000000";
 fechapre = "      ";
 dd       = "";
 mm       = "";
 aa       = "";
 cabe1    = "0406";  || Registro Cabecera
 cabe2    = "2";  || Registro Detalle Pagos
 cabe3    = "3";  || Registro Total

 libre    = " ";
 libre40  = "";
 ca1  = "";
 ca2  = "";
 ca3  = "";
 ca4  = "";
 ca5  = "";
 ca6  = "";
 ca7  = "";
 ca8  = "";
 ca9  = "";
 ca10 = "";
 ca11 = "";
 ca12 = "";
 ca13 = "";
 ca14 = "";
 ca15 = "";
 ca115 = "";
 ca16 = "";
 ca17 = "";
 ca18 = "";
 ca19 = "";
 ca20 = "";
 ca21 = "";
 l          = 0;
 trecibos   = 0;
 timporte   = 0;

 NifProv    = "";
 NombreProv = "";
 DirecProv  = "";
 PoblaProv  = "";
 ProviProv  = "";
 Cp1Prov    = "";
 Cp2Prov    = "";
 TelefProv  = "";
 FaxProv    = "";
 PaisProv   = "";
 Entidad    = "";
 Sucursal   = "";
 DC         = "";
 Cuenta     = "";
 varios     = 0;

 handle     = "";
 fiche      = "";
 dirempr    = "";
 varalfa1   = "";
 varalfa2   = "";
 contenido  = "";
 swERROR    = 0;
 CampoDni   = "";
 Letra1     = "";
 Letra2     = "";
 Letra3     = "";
 Letra4     = "";
 Letra5     = "";
 Letra6     = "";
 Letra7     = "";
 Letra8     = "";
 Caracter   = "";
 Carac1     = 0;
 Carac2     = 0;
 Carac3     = 0;
 Carac4     = 0;
 Carac5     = 0;
 XPara      = 0;

 ccc        = "";
 c_alfa1    = "";
 c_alfa2    = "";
 c_nume1    = 0;
 c_nume2    = 0;
 c_nume3    = 0;

 direcc = "";
 numero = 0;
 longi  = 0;
 concepto = "";

 &programa = "";
 &ficcopia = "";
 aAlfa  = "";
 aAlfa1 = "";
 nHayProv = 0;

    &eaVarDni  = "";
    &enCalcCif = 0;
|FIN;

|INCLUYE acceso_i;

|| *************************************************************************
|PROCESO ver_confirming; |TIPO 6;
 |SI FSalida = 2; |ACABA; |FINSI;
 |ABRE #2;
 |HAZ leerem;
 |CIERRA #2;
 |SI swErrorR ! 0;
     |SI swErrorR < 3;
         |MENAV mens;
         |ERROR;
         |ACABA;
     |SINO;
         |CONFI mens;
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
 |FINSI;
 #0#2 = #2#3; || Banco

 |HAZ TomaDatos;
 #0#5 = #2#6; |PINTA #0#5;
 #0#3 = #2#1; |PINTA #0#3;

 |PINTA 1035, #2#2;   || Vto.
 |PINTA 1058, #2#8;   || N§ Efectos
 |PINTA 1135, #2#3;   || Banco
 |PINTA 1149, #2#9;   || Importe Total
|FPRC;

|PROCESO TomaDatos;
   |ABRE #1;
   #1#0 = #0#2;
   |LEE 000#1=;
   |SI FSalida ! 0;
     |DDEFECTO #1;
   |FINSI;
   |CIERRA #1;

||   #0#5  = #1#23; |PINTA #0#5;
||   #0#13 = #1#24; |PINTA #0#13;
|FPRC;

|PROCESO leerem;
 swErrorR = 0;
 |DDEFECTO #2;
 #2#0 = #0#1;
 |LEE 001#2=;
 |SI FSalida ! 0;
     swErrorR = 1; mens = menR1;
 |SINO;
     |SI #2#9 = "S";
         swErrorR = 2; mens = menR2;
     |SINO;
         |SI #2#10 = "S"; swErrorR = 3; mens = menR3; |FINSI;
         |SI #2#10 = "D"; swErrorR = 4; mens = menR4; |FINSI;
     |FINSI;
     |ABRE #8;
     #8#0 = #2#3;
     |LEE 000#8=;
     |CIERRA #8;
 |FINSI;
|FPRC;

||...................................................................................
||***********************************************************
||************ REGISTRO DE CABECERA *************************
||***********************************************************
|PROCESO cabecera;
  aAlfa1 = #1#2 % 109;
  Prefijo = "0356" + aAlfa1 + " " + (" " * 12);

  ca1  = "001";
  ca2  = #0#3;                 || Fecha presentacion
  ca2  = (ca2 % 0102) + (ca2 % 0402) + (ca2 % 0902);
  ca3  = ca2;                         || Fecha emision de las ordenes
  ca4  = "0128";                                                  || Entidad cargo
  ca5  = #1#5;  |QBF ca5; ca5 = (("0" *  4) + ca5) % -104; || Sucursal cargo
  ca6  = #1#6;  |QBF ca6; ca6 = (("0" * 10) + ca6) % -110; || Cuenta cargo
  ca7  = "0   ";
  ca8  = #1#22; |QBF ca8; ca8 = (("0" *  2) + ca8) % -102; || Digito control
  varalfa1 = Prefijo + ca1 + ca2 + ca3 + ca4 + ca5 + ca6 + ca7 + ca8 + "       ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  contenido = handle + " " + varalfa1 + &#0#7 + &#0#8;
  |FGRABA contenido;
  l = l + 1;

  ca1  = "002";
  ca2  = #1#3; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136; || Nombre ordenante
  ca3  = " " * 7;
  varalfa1 = Prefijo + ca1 + ca2 + ca3;
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  contenido = handle + " " + varalfa1 + &#0#7 + &#0#8;
  |FGRABA contenido;
  l = l + 1;

  ca1  = "003";
  ca2  = #1#7; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136; || Domicilio ordenante
  ca3  = " " * 7;
  varalfa1 = Prefijo + ca1 + ca2 + ca3;
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  contenido = handle + " " + varalfa1 + &#0#7 + &#0#8;
  |FGRABA contenido;
  l = l + 1;

  ca1  = "004";
  ca2  = #1#10; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136; || Poblacion ordenante
  ca3  = " " * 7;
  varalfa1 = Prefijo + ca1 + ca2 + ca3;
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  contenido = handle + " " + varalfa1 + &#0#7 + &#0#8;
  |FGRABA contenido;
  l = l + 1;
|FPRC;

||***********************************************************
||******************* REGISTRO INDIVIDUAL *******************
||***********************************************************

|PROCESO leecl_y_cobro;
 || .............. Lee la ficha del Cliente para obtener los datos necesarios

 NifProv    = "";
 NombreProv = "";
 DirecProv  = "";
 PoblaProv  = "";
 ProviProv  = "";
 Cp1Prov    = "";
 Cp2Prov    = "";
 TelefProv  = "";
 FaxProv    = "";
 PaisProv   = "";
 Entidad    = "";
 Sucursal   = "";
 DC         = "";
 Cuenta     = "";

 aRef = " " * 12;

 |DDEFECTO #5;
 #5#0 = #3#2;
 #5#1 = #3#3;
 #5#2 = #3#4;
 #5#3 = #3#5;
 |LEE 001#5=;

 |DDEFECTO #6;
 #6#0 = #3#2;
 #6#2 = #3#3;
 |LEE 001#6=;

 |DDEFECTO #7;
 #7#0 = #6#6;
 |LEE 001#7=;
 alfa1 = #7#1; |QBF alfa1;
 alfa2 = #6#7; |QBF alfa2;
 concepto = alfa2 - alfa1;
 concepto = (concepto + libre40) % 130;

 fFechaEmis = #3#6;

 nHayProv = 0;
 |DDEFECTO #4;
 #4#23 = "P";
 #4#10 = #3#9;
 #4#11 = #3#10;
 |LEE 001#4=;
 |SI FSalida = 0;
    NifProv    = #4#9;
    NombreProv = #4#1;
    DirecProv  = #4#2;
    PoblaProv  = #4#6;
    ProviProv  = #4#5;
    Cp1Prov    = #4#3; |QBF Cp1Prov; Cp1Prov = (("00"  + Cp1Prov) % -102);
    Cp2Prov    = #4#4; |QBF Cp2Prov; Cp2Prov = (("000" + Cp2Prov) % -103);
    TelefProv  = #4#7;
    FaxProv    = #4#8;
    PaisProv   = #4#24;
    |SI #0#4 = "1"; aRef = #4#10; |FINSI;
    |SI #0#4 = "2"; aRef = #4#0;  |FINSI;
    |QBF aRef; aRef = ((" " * 12) + aRef) % -112;

    aAlfa = "|NC"; nCalc = #caclipro#aAlfa#;
  ||  |SI nCalc > 29;
  ||     Entidad  = #4#29;
  ||     Sucursal = #4#30;
  ||     DC       = #4#31;
  ||     Cuenta   = #4#32;
  ||  |SINO;
       aAlfa    = #4#18; |QBF aAlfa;
       Entidad  = aAlfa % 0104;
       Sucursal = aAlfa % 0504;
       DC       = aAlfa % 0902;
       Cuenta = #4#17; |QBF Cuenta;
       Cuenta = ("0000000000" + Cuenta) % -110;
  ||  |FINSI;
 |SINO;
    nHayProv = 1;
 |FINSI;

    |HAZ MiraVarios;
    |SI varios = 0;
        NifProv    = #caclipro#9;
        NombreProv = #caclipro#1;
        DirecProv  = #caclipro#2;
        PoblaProv  = #caclipro#6;
        ProviProv  = #caclipro#5;
        Cp1Prov    = #caclipro#3; |QBF Cp1Prov; Cp1Prov = (("00"  + Cp1Prov) % -102);
        Cp2Prov    = #caclipro#4; |QBF Cp2Prov; Cp2Prov = (("000" + Cp2Prov) % -103);
        TelefProv  = #caclipro#7;
        FaxProv    = #caclipro#8;
        PaisProv   = #caclipro#24;

        |SI nHayProv = 1;
            aAlfa = "    No se encuentran los datos del proveedor " + #3#9; |QBF aAlfa;
            aAlfa = aAlfa + " en la ficha de contabilidad";
            |MENAV aAlfa;
            swERROR = 1;
        |FINSI;
    |SINO;
        NifProv    = #caacrval#4;
        NombreProv = #caacrval#3;
        DirecProv  = #caacrval#5;
        PoblaProv  = #caacrval#6;
        ProviProv  = #caacrval#7;
        Cp1Prov    = #caacrval#8; |QBF Cp1Prov; Cp1Prov = (("00"  + Cp1Prov) % -102);
        Cp2Prov    = #caacrval#9; |QBF Cp2Prov; Cp2Prov = (("000" + Cp2Prov) % -103);
        TelefProv  = #caacrval#11;
        FaxProv    = #caacrval#12;
        PaisProv   = #caacrval#13;
        swERROR    = 0;
    |FINSI;
|FPRC;

|PROCESO grabarecib; ||Calculo registros individuales;
  |SI #3#12 = "T";
     fp = "TRANS.";
     Prefijo = "0656";
  |FINSI;
  |SI #3#12 = "C";
     fp = "CHEQUE";
     Prefijo = "0657";
  |FINSI;
  |SI #3#12 = "P";
     fp = "PAGARE";
     Prefijo = "0658";
  |FINSI;
  |SI #3#12 = "E";
     fp = "PAGO CERTIFICADO";
     Prefijo = "0659";
  |FINSI;

  swERROR = 0;
  |HAZ leecl_y_cobro;
  eaNifProv = NifProv; eaDirProv = DirecProv;
   || ... |PRINT;
  |SI swERROR = 1; |ACABA; |FINSI;   || Salta este Cobro. NO el resto

  ca1 = NifProv; |QBF ca1; ca1 = (ca1 + "          ") % 0110;
  aAlfa1 = #1#2 % 109;
  Prefijo = Prefijo + aAlfa1 + " " + ca1 + "  ";
  ca1 = "010";
  nImporte = #3#8;
  |SI #3#12 ! "T";
     |SI nImporte < 0;
        ca7 = "- ";
     |SINO;
       ca7 = "  ";
     |FINSI;
  |SINO;
     ca7 = "  ";
  |FINSI;

  nImporte = (nImporte * 100) ! 0;
  ca2 = nImporte;
  ca2 = (("0" * 12) + ca2) % -112;
  |SI #3#12 = "T";
     ca3 = Entidad;  |QBF ca3; ca3 = (("0" * 4) + ca3) % -104;
     ca4 = Sucursal; |QBF ca4; ca4 = (("0" * 4) + ca4) % -104;
     ca5 = Cuenta;   |QBF ca5; ca5 = (("0" * 10) + ca5) % -110;
  |SINO;
     ca3 = "0000";
     ca4 = "0000";
     ca5 = "0000000000";
  |FINSI;
  |SI #caredm10#14 = "O";
     ca6 = "19";
  |SINO;
     ca6 = "29";
  |FINSI;

  |SI #3#12 = "T";
     ca8 = DC; |QBF ca8; ca8 = (ca8 + (" " * 2)) % 0102;
  |SINO;
     ca8 = "  ";
  |FINSI;

  |SI #3#12 = "P"; |O #3#12 = "E";
     ca9 = #3#7; |QBF ca9;
     ca9 = (ca9 % 0102) + (ca9 % 0402) + (ca9 % 0902);
  |SINO;
     ca9 = "      ";
  |FINSI;

  varalfa1 = Prefijo + ca1 + ca2 + ca3 + ca4 + ca5 + ca6 + ca7 + ca8 + ca9 + " ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  ca1 = "011";
  |QBF NombreProv;
  ca2 = (NombreProv + (" " * 36)) % 0136;
  ca3 = #3#6; |QBF ca3;
  ca3 = (ca3 % 0102) + (ca3 % 0402) + (ca3 % 0902);

  varalfa1 = Prefijo + ca1 + ca2 + ca3 + " ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  ca1 = "012"; |QBF DirecProv; aDirec1 = ""; aDirec2 = "";
  ca2 = (DirecProv + (" " * 36)) % 0136;
  varalfa1 = Prefijo + ca1 + ca2 + "       ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  aAlfa = " " * 36;
  ca1 = "013";
  |QBF ca2;
  ca2 = DirecProv - ca2; |QBF ca2;
  ca2 = ca2 + ((" " * 36) % 0136);
  |SI ca2 ! aAlfa;
     varalfa1 = Prefijo + ca1 + ca2 + (" " * 7);
     eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
     varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
     l = l + 1;
  |FINSI;

  ca1 = "014";
  ca2 = Cp1Prov + Cp2Prov + PoblaProv; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136;
  varalfa1 = Prefijo + ca1 + ca2 + "       ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  ca1 = "015";
  ca2 = ProviProv; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136;
  varalfa1 = Prefijo + ca1 + ca2 + "       ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  ca1 = "016";
  ca2 = #camanpag#28; |QBF ca2; ca2 = (ca2 + (" " * 36)) % 0136;
  varalfa1 = Prefijo + ca1 + ca2 + "       ";
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

/* OPCIONALES
  ca1 = "016";
  ca2 = FaxProv; |QBF ca2; ca2 = (ca2 + "       ") % 0110;
  ca3 = " " * 26;
  varalfa1 = Prefijo + ca1 + ca2 + ca3;
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  ca1 = "018";
  ca2 = #5#7;  |QBF ca2;   ||... fecha vencimiento
  ca2  = (ca2 % 0102) + (ca2 % 0402) + (ca2 % 0902);
  ca3 = #5#28; |QBF ca3; ca3 = (ca3 + (" " * 16)) % 0116;
  varalfa1 = Prefijo + ca1 + ca2 + ca3 + (" " * 14);
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1 + &#0#7 + &#0#8; |FGRABA varalfa1;
  l = l + 1;

  |QBF ca3;
  |SI ca3 = "";
     swERROR = 2; |ERROR10;
  |FINSI;
*/
  trecibos = trecibos + 1;
  timporte = timporte + #3#8;
|FPRC;

|PROCESO regindiv;
  trecibos = 0;
  timporte = 0;
  |BUCLELIN 0grabarecib#2;
  |SI swERROR = 1;
      |MENAV "    ATENCION !!!. DATOS DE CLIENTES INCOMPLETOS. ";
  |FINSI;
  |SI swERROR = 2;
      aAlfa = "    El documento de la linea " + #3#1 + " del confirme no tiene n§ factura del proveedor";
      |MENAV aAlfa;
  |FINSI;

  |SI trecibos ! 0;
      #2#1  = #0#3;
      #2#6  = #0#5;
      #2#10 = "D";
      |GRABA 020#2a;
      |LIBERA #2;
  |FINSI;
|FPRC;

||***********************************************************
||********** REGISTRO TOTAL ORDENANTE Y GENERAL *************
||***********************************************************
|PROCESO campo_totales;
  l = l + 1;
  aAlfa1 = #1#2 % 109;
  Prefijo = "0856";
  Prefijo = Prefijo + aAlfa1 + " " + (" " * 12);

  ca1 = "   ";
  nCalc = timporte * 100; ca2 = nCalc; |QBF ca2;
  ca2 = (("0" * 12) + ca2) % -112;
  ca3 = trecibos; |QBF ca3; ca3 = (("0" * 8)  + ca3) % -108;
  ca4 = l;        |QBF ca4; ca4 = (("0" * 10) + ca4) % -110;
  ca5 = " " * 13;

  varalfa1 = Prefijo + ca1 + ca2 + ca3 + ca4 + ca5 + &#0#7 + &#0#8;
  eaCadena = varalfa1; |HAZ QuitaRaros; varalfa1 = eaCadena;
  varalfa1 = handle + " " + varalfa1; |FGRABA varalfa1;
|FPRC;

|| **************************************************************************

|PROCESO pasecuencial; |TIPO 3;

  |ABRE #1;
  #1#0 = #0#2;
  |LEE 000#1=;
  |SI FSalida ! 0;
     |DDEFECTO #1;
  |FINSI;
  |CIERRA #1;

  |ABRE #2;
  |HAZ leerem;
  |SI swErrorR = 1; |O swErrorR = 2;
      |MENAV "    ERROR !!! CONFIRME NO CORRECTO ";
      |ACABA;
  |FINSI;

  |HAZ varia_fich;

  |CAMPO_VISUAL #0#10,1,"S"; #0#10 = 0;
  |CAMPO_VISUAL #0#11,1,"S"; #0#11 = 0;
  |CAMPO_VISUAL #0#12,1,"S"; #0#12 = 0;

|| ...................................................
  |ABRE #4;
  |ABRE #5;                || Cobros
  |ABRE #6;                || IVA soportado
  |ABRE #7;                || Conceptos

|| Abrir Fichero Secuencial

  |DFICE dirempr;
  fiche = "wb  " + dirempr + "casecmin.seq";  || "nomfiche.ext";
  |QBF fiche;
  |FABRE fiche;
  handle = FSalida;
  |SI FSalida ] 0;
      |HAZ cabecera;
      |HAZ regindiv;
      ||   |SI swERROR = 0;
               |HAZ campo_totales;
      ||   |FINSI;
  |FINSI;
  contenido = handle + " " + &#0#9;
  |FGRABA contenido;

  FSalida = handle;
  |FCIERRA FSalida;

  Pos = -1;
  |CIERRA #2;
  |CIERRA #4;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #7;

  |SI swERROR = 1; |O swERROR = 2; |ACABA; |FINSI;

  |D_CUADRO 1261, 2280;
  |ATRI R;
  |PINTA 1362, " Numero Recibos   ";
  |PINTA 1562, " Numero Registros ";
  |PINTA 1762, " Importe Total    ";
  |ATRI 0;
  |PINTA 1462, "                  ";
  |PINTA 1662, "                  ";
  |PINTA 1862, "                  ";
  |D_CUADRO 1961, 2280;
  |ATRI R;
  |PINTA 2062, " Desea grabar el  ";
  |PINTA 2162, " diskete ahora    ";
  |ATRI 0;

  #0#10 = trecibos;  |PINTA #0#10;
  #0#11 = l;         |PINTA #0#11;
  #0#12 = timporte;  |PINTA #0#12;

  programa = " CONFIRMES ";
  ficcopia = "CFREMESA.TXT";
  E_sup = 1;
  E_inf = "SNsn";
  sino  = "N";
  sino  = 2177 ? 1;
  |SI sino = "S"; |O sino = "s";
     |SUB_EJECUTA_NP "cared003";
  |FINSI;

/*
   |SI FSalida = 0;
      |CONFI "    NImprimir carta confirme ?";
      |SI FSalida = 0; nSwImpre = 1; |SINO; nSwImpre = 0; |FINSI;
      |SI nSwImpre = 1;
         |IMPRE 0; |SI FSalida < 0; |ACABA; |FINSI;
         aInforme = "Carta emision de confirmes"; |HAZ ObtenInforme;
         |INFOR aInforme;
         |SI FSalida < 0; |FINIMP; |ACABA; |FINSI;
      |FINSI;
      |SI nSwImpre = 1; |PIEINF; |FININF; |FINIMP; |FINSI;
   |FINSI;
*/
|FPRC;

|| ********** Rutinas Varias

|PROCESO LetraDni;
     eaVarDni   = CampoDni;
     enCalcCif  = 3;
     |HAZ CalculoDNI;
     CampoDni = eaVarDni;
     CampoDni = ("000000000" + CampoDni) % -109;
|FPRC;

|PROCESO cccBanco;
 |QBT ccc;
 c_alfa1 = ccc % 0;
 c_nume1 = c_alfa1;
 c_alfa1 = "";
 c_alfa2 = "";
 |PARA c_nume2 = 1; |SI c_nume2 [ c_nume1; |HACIENDO c_nume2 = c_nume2 + 1;
       c_nume3 = c_nume2 * 100 + 1;
       c_alfa2 = ccc % c_nume3;
       |SI c_alfa2 ] "0"; |Y c_alfa2 [ "9";
           c_alfa1 = c_alfa1 + c_alfa2;
       |FINSI;
 |SIGUE;
 ccc = c_alfa1;
|FPRC;

|PROCESO varia_fich;
|| .......... Variables del Presentador, del Ordenante y comunes

  CodCli = #0#5; |QBF CodCli;
  CodCli = CodCli + "  "; CodCli = CodCli % 102;

  libre40 = libre * 40;
  || Nombre = #48#1 + libre40;     Nombre = Nombre % 140;
  Nombre = #1#3 + libre40;     Nombre = Nombre % 140;

  alfa1 = #0#3;
  dd = alfa1 % A102;
  mm = alfa1 % A402;
  aa = alfa1 % A902;
  fechapre = aa + mm + dd;   || Fecha Formato a¤o + mes + dia
|FPRC;

|PROCESO separa;
  alfa3  = 0;
  numero = 0;
  |QBF direcc;
  alfa1 = direcc % 0;
  longi = alfa1;
  |PARA nume4 = longi; |SI nume4 > 1; |HACIENDO nume4 = nume4 - 1;
        nume2 = (nume4 * 100) + 1;
        alfa2 = direcc % nume2;
        |SI alfa2 = ",";
            nume3  = ((longi - nume4) + 100) * -1;
            alfa3  = direcc % nume3;
            nume2  = (nume4 - 1) + 100;
            direcc = direcc % nume2;
            |SAL;
        |FINSI;
  |SIGUE;
  |QBT alfa3;
  |SI alfa3 ! ""; numero = alfa3; |FINSI;
|FPRC;

|PROCESO SacaNivel1;
   |QBF aCuenta;
   aAlfa = aCuenta % 0; nNivel = aAlfa;
   |SI nNivel = Niv1; nNivel = 1; |FINSI;
   |SI nNivel = Niv2; nNivel = 2; |FINSI;
   |SI nNivel = Niv3; nNivel = 3; |FINSI;
   |SI nNivel = Niv4; nNivel = 4; |FINSI;
   |SI nNivel = Niv5; nNivel = 5; |FINSI;
   |SI nNivel = Niv6; nNivel = 6; |FINSI;
|FPRC;

|PROCESO MiraVarios;
     |DDEFECTO #caacrval;
     |ABRE #calisfra;
     #calisfra#0  = #camingli#2;   || libro
     #calisfra#1  = #camingli#4;   || serie
     #calisfra#2  = #camingli#3;   || orden
     |LEE 000#calisfra.=;
     |SI FSalida = 0;
          |ABRE #caacrval;
          #caacrval#0 = #calisfra#3;    || cuenta
          #caacrval#1 = #calisfra#4;    || digito
          #caacrval#2 = #calisfra#5;    || linea
          |LEE 000#caacrval.=;
          |SI FSalida ! 0;
               aAlfa1 = "0000Direccion [" + #caacrval#0 + "." + #caacrval#2 + "] Factura [" + #camingli#2 + "." + #camingli#4 + "." + #camingli#3 + "] inaccesible.";
               |MENAV aAlfa1;
          |FINSI;
          |CIERRA #caacrval;
          varios = 1;
     |SINO;
          |SI #camingli#16 ! 0;
               |ABRE #caacrval;
               #caacrval#0 = #camingli#9;    || cuenta
               #caacrval#1 = #camingli#10;   || digito
               #caacrval#2 = #camingli#16;   || linea
               |LEE 000#caacrval.=;
               |SI FSalida ! 0;
                    aAlfa1 = "0000Direccion [" + #caacrval#0 + "." + #caacrval#2 + "] Factura [" + #camingli#2 + "." + #camingli#4 + "." + #camingli#3 + "] inaccesible.";
                    |MENAV aAlfa1;
               |FINSI;
               |CIERRA #caacrval;
               varios = 1;
          |SINO;
               varios = 0;
          |FINSI;
     |FINSI;
     |CIERRA #calisfra;
|FPRC;
