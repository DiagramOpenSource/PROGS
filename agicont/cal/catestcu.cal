|FICHEROS;
    cacuenta #0;
    catestcu #2;
    cacuebal #5;
    ca8m0002 #422;
    ca8cumay #410;
|FIN;

|VARIABLES;
    &sw_conase4 = 0;
    &entrada = 1;
    informe = "catestcu";
    &error = "";
    &arreg = "";
    &ercue = "";
    &erdes = "";
    &erniv = 0;
    men1  = "     NO EXISTE EMPRESA !";
    long = "  ";
    valo = 0;
    saber = "";
    cuini = "            ";
    cufin = "zzzzzzzzzzzz";
    niini = 0;
    nifin = 9;
    prim = 0;
    nivant = 0;
    cuante = "";
    cuante1 = "";
    pasant = "";
    cuenta = "";
    desant = "";
    cta = "";
    nume1 = 0;

    nSwAlgun = 0;
    swGrabar = 0;
    nCam4      = 0;
    aCam5      = "";
    nCam6      = 0;
    nCam7      = 0;
    nCam8      = 0;
    nivel      = 0;
    alfa1      = "";
|FIN;

|INCLUYE acceso_i;
|INCLUYE varnue_i;
|INCLUYE defect_i;

|PROCESO mayus;
  #2Campo = #2Campo > " ";
  |PINTA #2Campo;
|FPRC;

____________________________________/ CALCULOS DE PANTALLA
|PROCESO conase4; |TIPO 7;
|SI sw_conase4 = 1;
        #2#0 = "SI";     |PINTA #2#0;
    |PTEC 802;
    |PTEC 802;
|FINSI;
|FPRC;
____________________________________/
|PROCESO balance;
   nCam4  = #cacuenta#4; aCam5 = #cacuenta#5;
   nCam6  = #cacuenta#6; nCam7 = #cacuenta#7;
   nCam8  = #cacuenta#8;
   nMensa = 1;
   |HAZ defect;
   |SI nNoBal = 1;
      ercue = #cacuenta#0;
      erniv = #cacuenta#1;
      erdes = #cacuenta#2;
      error = "NO EXISTE EN BALANCES 1990";
      arreg = "N";
      |SI nNoBalX = 0;
          |SI #cacuenta#4 ! nCam4; |O #cacuenta#5 ! aCam5; |O #cacuenta#6 ! nCam6;
              |O #cacuenta#7 ! nCam7; |O #cacuenta#8 ! nCam8;
              error = "NO EXISTE EN BAL. 1990. MODIFICADO COMO 2008";
              error = "NO EXISTE 1990. MOD. 2008";
              arreg = "S";
              swGrabar = 1;
          |FINSI;
      |FINSI;
      |PRINT; nSwAlgun = 1;
   |SINO;
      |SI #cacuenta#4 ! nCam4; |O #cacuenta#5 ! aCam5; |O #cacuenta#6 ! nCam6;
          |O #cacuenta#7 ! nCam7; |O #cacuenta#8 ! nCam8;
          ercue = #cacuenta#0;
          erniv = #cacuenta#1;
          erdes = #cacuenta#2;
          error = "NO CORRESPONDE CON BALANCES 1990"
          arreg = "S";
          swGrabar = 1;
          |PRINT; nSwAlgun = 1;
      |FINSI;
   |FINSI;
   |SI nNoBalX = 1;
      ercue = #cacuenta#0;
      erniv = #cacuenta#1;
      erdes = #cacuenta#2;
      error = eNum2008; error = ("00" + error) % -102;
      error = "NO EXISTE EN PLAN CTBLE: " + error;
      arreg = "N";
      |PRINT; nSwAlgun = 1;
   |FINSI;
   |SI nNoBal8 = 1;
      ercue = #cacuenta#0;
      erniv = #cacuenta#1;
      erdes = #cacuenta#2;
      error = "NO EXISTE EN BALANCES 2008";
      arreg = "N";
      |PRINT; nSwAlgun = 1;
   |FINSI;
|FPRC;

|PROCESO mayor;
|SI cuenta ! cuante1;
    |SI #0#1 ! 1;
            ercue = cuante1;
            erdes = "";
            erniv = #0#1 - 1;
            error = "NO EXISTE NIVEL";
            arreg = "N";
        |PRINT; nSwAlgun = 1;
    |FINSI;
|SINO;
    |SI pasant = "S";
            ercue = cuante1;
            erdes = desant;
            erniv = nivant;
            error = "NO ES DE PASE DIRECTO";
            arreg = "N";
        |PRINT; nSwAlgun = 1;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO igual;
|SI cuante ! cuante1;
    |SI #0#1 ! 1;
            ercue = cuante1;
            erdes = "";
            erniv = #0#1 - 1;
            error = "NO EXISTE NIVEL";
            arreg = "N";
        |PRINT; nSwAlgun = 1;
    |SINO;
            ercue = cuante1;
            erdes = desant;
            erniv = nivant;
            error = "NO ES DE PASE DIRECTO";
            arreg = "N";
        |PRINT; nSwAlgun = 1;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO menor;
|SI pasant = "N";
        ercue = cuenta;
        erdes = desant;
        erniv = nivant;
        error = "DEBERIA SER DE PASE DIRECTO";
        arreg = "N"
    |PRINT; nSwAlgun = 1;
|FINSI;
|FPRC;

|PROCESO guarda;
    cuenta = #0#0;
    |QBF cuenta;
    nivant = #0#1;
    desant = #0#2;
    pasant = #0#3;
|SI #0#1 = 6;  cuante = #0#0 % dig8;  |FINSI;
|SI #0#1 = 5;  cuante = #0#0 % dig7;  |FINSI;
|SI #0#1 = 4;  cuante = #0#0 % dig6;  |FINSI;
|SI #0#1 = 3;  cuante = #0#0 % dig5;  |FINSI;
|SI #0#1 = 2;  cuante = #0#0 % dig4;  |FINSI;
|SI #0#1 = 1;  cuante = #0#0 % dig4;  |FINSI;
|FPRC;

|PROCESO guard1;
|SI #0#1 = 6;  cuante1 = #0#0 % dig8;  |FINSI;
|SI #0#1 = 5;  cuante1 = #0#0 % dig7;  |FINSI;
|SI #0#1 = 4;  cuante1 = #0#0 % dig6;  |FINSI;
|SI #0#1 = 3;  cuante1 = #0#0 % dig5;  |FINSI;
|SI #0#1 = 2;  cuante1 = #0#0 % dig4;  |FINSI;
|FPRC;

|PROCESO buscando;
 saber = "Procesando Cuenta: " + #0#0;
 |PINTA 2210,saber;

 cta = #0#0; |QBF cta; |SI cta = ""; |ACABA; |FINSI;
 swGrabar = 0;
 |SI #0#1 > dig3;
     ercue = #0#0;
     erniv = #0#1;
     erdes = #0#2;
     error = "NIVEL NO PERMITIDO";
     arreg = "N";
     |PRINT; nSwAlgun = 1;
 |FINSI;
 nivel = 0;
 long  = cta % 0;
 nume1 = long;
 |SI nume1 = #30#14; nivel = 1; |FINSI;
 |SI nume1 = #30#15; nivel = 2; |FINSI;
 |SI nume1 = #30#16; nivel = 3; |FINSI;
 |SI nume1 = #30#17; nivel = 4; |FINSI;
 |SI nume1 = #30#18; nivel = 5; |FINSI;
 |SI nume1 = #30#19; nivel = 6; |FINSI;

 |SI nivel = 0;
     ercue = #0#0;
     erniv = #0#1;
     erdes = #0#2;
     error = "FUERA DE NIVEL ";
     arreg = "N";
     |PRINT; nSwAlgun = 1;
 |SINO;
     |SI nivel ! #0#1;
         ercue = #0#0;
         erniv = #0#1;
         erdes = #0#2;
         error = "NIVEL NO CORRESPONDE A LONGITUD";
         arreg = "N";
         |PRINT; nSwAlgun = 1;
     |FINSI;
 |FINSI;

 |SI prim = 0;
     |SI #0#1 ! 1;
         ercue = #0#0;
         erniv = #0#1;
         erdes = #0#2;
         error = "NO EMPIEZA CON NIVEL 1";
         arreg = "N";
         |PRINT; nSwAlgun = 1;
     |FINSI;
     prim = 1;
 |SINO;
    |HAZ guard1;
    |SI nivant < #0#1;  |HAZ mayor;  |FINSI;
    |SI nivant = #0#1;  |HAZ igual;  |FINSI;
    |SI nivant > #0#1;  |HAZ menor;  |FINSI;
    |SI #0#1 = dig3; |Y #0#3 = "N";
        ercue = #0#0;
        erniv = #0#1;
        erdes = #0#2;
        error = "DEBE SER DIRECTO";
        arreg = "S";
        |PRINT; nSwAlgun = 1;
        #0#3 = "S";
        swGrabar = 1;
    |FINSI;
|FINSI;
|HAZ balance;
|HAZ guarda;
|SI swGrabar = 1;
    alfa1 = #cacuenta#0;
    |QBF alfa1;
    alfa1 = alfa1 + "zzzzzzzzzzzz";
    #cacuenta#54 = alfa1 % 112;
    #cacuenta#55 = #cacuenta#1;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|FPRC;

|DEFBUCLE catestcu0;
 #0#1;
 ;
 cuini, niini;
 cufin, nifin;
 be;
 NULL, buscando;
|FIN;

|PROCESO creacion; |TIPO 3;
  |SI #2#0 = "NO"; |ACABA; |FINSI;
  |HAZ inicio;
  |HAZ eVarEmpresa;
  dig1 = #30#11;
  dig3 = #30#13;
  dig4 = 100 + #30#14;
  dig5 = 100 + #30#15;
  dig6 = 100 + #30#16;
  dig7 = 100 + #30#17;
  dig8 = 100 + #30#18;
  dig9 = 100 + #30#19;

  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

  |ABRE #5;
  prim     = 0;
  nSwAlgun = 0;
  |BUCLE catestcu0;
  |SI nSwAlgun = 1;
     |PIEINF;
  |FINSI;
  |FININF;
  |FINIMP;
  |CIERRA #5;
|FPRC;
