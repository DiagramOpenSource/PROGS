|FICHEROS;
  cafupz01 #0;
  cafupm01 #1,MANTE;
  cafupm02 #2,MANTE;
  cafupm04 #4;
  cafupm05 #5,MANTE;
  cafupz03 #50,MANTE;

  cacuenta #15;
  canempre #30;
  cafupw0@ #993;
  &cacuent@ #915;
|FIN;

|VARIABLES;
 &entrada = 1;
 &salidas = 0;
 &enEjercicio = 0;
 &enAny       = 0;
 &eaNombreEmp = "";
 &eaDirDestino = "";
 &eaDirOrigen  = "";
 &eaCuenta = "";
 &enNivel = 0;

 &dig1 = 0;
 &dig3 = 0;
 &dig4 = 0;
 &dig5 = 0;
 &dig6 = 0;
 &dig7 = 0;
 &dig8 = 0;
 &dig9 = 0;

 nTecla = 0;
 nModo  = 0;
 nModoEntrada = 0;

 &nMaxDes  = 0;
 &nMaxOri  = 0;
 {-1}punt1 = 0;
 &ddig3 = 0;
 &ddig4 = 0;
 &ddig5 = 0;
 &ddig6 = 0;
 &ddig7 = 0;
 &ddig8 = 0;
 &ddig9 = 0;

 aAlfa1 = "";
 aAlfa2 = "";
 nNume1 = 0;

 aLong    = "";
 nLong    = 0;
 &nPlaEmp = 0;

 &sw5      = 0;
 &enSalgo5 = 0;
 aDCuenta = "";
 aHCuenta = "";
 nerror   = 0;
 aBase    = "";
 aDef     = "";

 &nContar = 0;
 nEstoy   = 0;
 nSwOp    = 0;
 nSwError = 0;
 nConsol  = 0;
 nSwNO    = 0;
|FIN;

|INCLUYE punto2_i;

|PROCESO cuenta5; |TIPO 6;
  salidas = FSalida;
  |SI salidas = 10; |ACABA; |FINSI;

  p_alfa1 = #5Campo;
  |HAZ punto2;
  |SI p_error ! 0;  |ERROR;  |ACABA; |FINSI;

  eaCuenta = #5Campo;
  |SI Campo = 2;
      |HAZ Sacanivel2;
  |SINO;
      |HAZ Sacanivel;
  |FINSI;
  |SI enNivel = 0;
      |MENAV "     Longitud de Cuenta Fuera de Nivel !";
      |ERROR;
  |SINO;
      nNume1   = Campo + 1;
      #5nNume1 = enNivel;
  |FINSI;
|FPRC;

|PROCESO Tipo11_m5; |TIPO 11;
  |SI sw5= 0;
      |SI FSalida = 1; |O FSalida = 7;
          enSalgo5 = 1;
      |FINSI;
  |FINSI;
  |HAZ Tipo0_m5;
|FPRC;

|PROCESO inf915;
 aAlfa1 = " " * 40;
 #915#0 = aAlfa1;
 #915#1 = 0;
 #915#2 = aAlfa1;
|FPRC;

|PROCESO sup915;
 aAlfa1 = "z" * 40;
 #915#0 = "zzzzzzzzzzzz";
 #915#1 = 9;
 #915#2 = aAlfa1;
|FPRC;

|PROCESO Tipo0_m5; |TIPO 0;
  nTecla = FSalida;
  |SI nTecla = 10;
      |ABRE #915;
      #915#0 = #5#2;
      #915#1 = #5#3;
      |CONSULTA_F_CLAVE #1#915, inf915, sup915;
      #5#2 = #915#0;
      #5#3 = #915#1;
      #5#4 = #915#2;
      |CIERRA #915;
      |PINTA #5#2;
      |PINTA #5#4;
      |PTEC 802;
      |ERROR;
  |FINSI;
  |SI nTecla = 11;
      |HAZ RecojoE;
      sw5 = 1;
  |FINSI;
|FPRC;

|PROCESO cuefinm5; |TIPO 0;
  nModoEntrada = (FEntrada / 100) ! 0;

  aAlfa1 = #5#2; |QBF aAlfa1;
  |SI aAlfa1 = ""; |ERROR; |ACABA; |FINSI;
  eaCuenta = #5#2;
  enNivel  = #5#3;

  |ABRE #915;
  #915#0 = eaCuenta;
  #915#1 = enNivel;
  |LEE 001#915=;
  |SI FSalida ! 0;
      |MENAV "    Error. No Existe Cuenta";
      |CIERRA #915;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #915;

  |SI #915#3 = "N";
      |MENAV "      Esta Cuenta NO tiene Pase directo";
      |ERROR;
  |FINSI;
  #5#4 = #915#2; |PINTA #5#4;
|FPRC;

|PROCESO inf15;
 #15#0 = "            ";
 #15#1 = 0;
|FPRC;

|PROCESO sup15;
 #15#0 = "zzzzzzzzzzzz";
 #15#1 = 9;
|FPRC;

|PROCESO cuefinm5_5; |TIPO 0;
  nTecla = FSalida;

  eaCuenta = #5#5;
  enNivel  = #5#6;

  |SI nTecla = 10;
      |ABRE #15;
      #15#0 = #5#5;
      #15#1 = #5#6;
      |CONSULTA_F_CLAVE #1#15, inf15, sup15;
      #5#5 = #15#0;
      #5#6 = #15#1;
      |CIERRA #15;
      |PINTA #5#5;
  |FINSI;

  |ABRE #15;
  #15#0 = #5#5;
  #15#1 = #5#6;
  |LEE 001#15=;
  |SI FSalida ! 0;
      |MENAV "    Error. No Existe Cuenta";
      |CIERRA #15;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #15;

  |SI #15#3 = "N";
      |MENAV "      Esta Cuenta NO tiene Pase directo";
      |ERROR;
  |FINSI;
|FPRC;

|| ==============================================
|PROCESO MiroExcluir;
 |SI eaCuenta ] #4#3; |Y eaCuenta [ #4#4;
     nSwNO = 1;
     |ERROR10;
 |FINSI;
|FPRC;

|DEFBUCLE MiroExcluir;
 #4#1;
 ;
 #2#0, #2#1, 001;
 #2#0, #2#1, 999;
 ;
 NULL, MiroExcluir;
|FIN;


|PROCESO PorcacuentaE;
 eaCuenta = #915#0;
 aAlfa1   = #915#0; |QBF aAlfa1; |SI aAlfa1 = ""; |ACABA; |FINSI;
 enNivel  = #915#1;

 |SI #2#4 = "S";
     nSwNO = 0;
     |BUCLE MiroExcluir;
     |SI nSwNO = 1; |ACABA; |FINSI;
 |FINSI;

 #993#0 = #1#0;
 #993#1 = #2#1;
 #993#2 = eaCuenta;
 #993#3 = enNivel;
 |LEE 001#993=;
 |SI FSalida ! 0;
     #993#0 = #1#0;
     #993#1 = #2#1;
     #993#2 = eaCuenta;
     #993#3 = enNivel;
     #993#4 = #915#2;
     #993#5 = #993#2;
     #993#6 = enNivel;
     |HAZ LeeEstaCta;
     |GRABA 020#993n;
 |FINSI;
|FPRC;

|DEFBUCLE PorcacuentaE;
 #915#1002;
 3;
 aDCuenta, 1, "S";
 aHCuenta, 9, "S";
 e;
 NULL, PorcacuentaE;
|FIN;

|PROCESO  RecojoE;
  |HAZ CargaB;
  |SI nerror = 1; |ACABA; |FINSI;

  nConsol  = 0;
  aDCuenta = "            ";
  aHCuenta = "zzzzzzzzzzzz";
  |HAZ PidoLimitesE;

  |ABRE #993;
  |BUCLE PorcacuentaE;
  |CIERRA #993;
  |HAZ DescargaB;

  sw5 = 1;
  |ERROR;
  |PTEC 806;
|FPRC;

|PROCESO PidoLimitesE;
 |DDEFECTO #50;
 #50#0 = 0; |C_M #50#0,1,"N";
 #50#1 = "DESDE EL PLAN CONTABLE";

 |PUSHV 1431 2180;
 |PINPA #0#50;
 |PINDA #0#50;
 |ENDATOS #1#50;
 |SI FSalida ! 0;
     |POPV;
     |ACABA;
 |FINSI;
 aDCuenta = #50#2;
 aHCuenta = #50#3;

 |POPV;
|FPRC;

|PROCESO CargaB;
 nerror = 0;
 |DBASE aBase;
 aDef = aBase + "def/cafupm05.mas";
 |CARGA_DEF aDef, cafupw0@;
 |SI FSalida ! 0;
     |MENAV "    Error en Cafupm05";
     nerror = 1;
     |ACABA;
 |FINSI;
|FPRC;

|PROCESO DescargaB;
 |DESCARGA_DEF #cafupw0@;
|FPRC;

|| **********************************************************************
|PROCESO Sacanivel2;
   aLong = eaCuenta; |QBF aLong;
   aLong = aLong % 0;
   nLong = aLong;
   enNivel = 0;
   |SI nLong = ddig4; |Y ddig4 ! 0; enNivel = 1; |FINSI;
   |SI nLong = ddig5; |Y ddig5 ! 0; enNivel = 2; |FINSI;
   |SI nLong = ddig6; |Y ddig6 ! 0; enNivel = 3; |FINSI;
   |SI nLong = ddig7; |Y ddig7 ! 0; enNivel = 4; |FINSI;
   |SI nLong = ddig8; |Y ddig8 ! 0; enNivel = 5; |FINSI;
   |SI nLong = ddig9; |Y ddig9 ! 0; enNivel = 6; |FINSI;
|FPRC;


|PROCESO LeeEstaCta;
     |HAZ Sacanivel;
     |ABRE #15;
     |DDEFECTO #15;
     #15#0 = eaCuenta;
     #15#1 = enNivel;
     |LEE 001#15=;
     |SI FSalida ! 0;
         #993#5 = "";
     |FINSI;
     |CIERRA #15;
|FPRC;
