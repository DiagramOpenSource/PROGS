|FICHEROS;
     lubrm001 #0;
     cacuenta #1;
|FIN;

|VARIABLES;
     &entrada = 1;

     cont  = 0;
     long  = "  ";
     cta   = 0;
     num   = 0;
     sw    = 0;
     men2  = "     Longitud de Cuenta Fuera de Nivel !";
     aAlfa1 = "";
     aAlfa2 = "";
     nNume1 = 0;
     nInkey = 0;
|FIN;

|INCLUYE acces3_i;
|INCLUYE puntos_i;

|PROCESO QuitaBarra; |TIPO 0;
     aAlfa1 = #0Campo;
     |QBF aAlfa1;
     aAlfa2 = aAlfa1 % -101;
     |SI aAlfa2 ! "/";|Y aAlfa2 ! "\";
          aAlfa1 = #0Campo; |QBF aAlfa1;
          #0Campo = aAlfa1 + "/";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO ptec; |TIPO 7;
 |PTEC 816;
|FPRC;

|PROCESO cuenta;|TIPO 6;
   nInkey = FSalida;

   |SI nInkey = 10;
       #1#0 = #0Campo;
       |ABRE #1;
       |CONSULTA_CLAVE #1#1;
       |CIERRA #1;
       #0Campo = #1#0; |PINTA #0Campo;
   |FINSI;

   |SI Campo = 7;
       aAlfa1 = #0Campo; |QBF aAlfa1;
       aAlfa2 = aAlfa1 % -101;
       |SI aAlfa2 = "*";
           |ACABA;
       |FINSI;
   |FINSI;

    p_alfa1 = #0Campo;
    salidas = FSalida;
    |HAZ punto;
    |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;

    cta  = #0Campo;
    long = cta % A0;
    cont = 0;
    sw = 0;
    |SI long = dig4; sw = 1;  |FINSI;
    |SI long = dig5; sw = 2;  |FINSI;
    |SI long = dig6; sw = 3;  |FINSI;
    |SI long = dig7; sw = 4;  |FINSI;
    |SI long = dig8; sw = 5;  |FINSI;
    |SI long = dig9; sw = 6;  |FINSI;
    |SI sw = 0;
       |MENAV men2;
       |ERROR;
       |ACABA;
    |FINSI;

    |ABRE #1;
    #1#0 = #0Campo;
    #1#1 = sw;
    |LEE 001#1=;
    |SI FSalida ! 0;
        |CONFI "    SError, no existe la Cuenta, Continuar ";
        |SI FSalida ! 0;
            |ERROR;
        |FINSI;
    |SINO;
        |SI #1#3 = "N";
            |MENAV "    Error. La Cuenta no es de Pase Directo ";
            |ERROR;
        |FINSI;
    |FINSI;
    |CIERRA #1;
|FPRC;
