|FICHEROS;
    caxcopia #0;
    caxcontr #1;
|FIN;

|VARIABLES;
    fiche     = "";
    direc     = "";
    nUnidad   = 0;
    unida     = "";

    aOrigen   = "";
    aDestino  = "";
    aPath     = "";
    aCopia    = "";
    aTecla    = "";
    aIPRemoto = "";
    ip        = "";
    aAlfa     = "";
    &eaUnidadBasico = "";
|FIN;

____________________________________/ CALCULOS DE PANTALLA
|PROCESO copiando; |TIPO 12;
    |SI #0#0 = "SI";
        |HAZ LeeUnidadBasico;

        |ABRE #1;
        |LEE 001#1p;
        |SI FSalida = 0;
            |HAZ ejecuta;
        |SINO;
            |MENAV "    Debera definir el Control de Exportaciones/Importaciones ...";
        |FINSI;
        |CIERRA #1;
    |FINSI;
|FPRC;

|PROCESO ejecuta;

    |HAZ LeeUnidadBasico;
    |ATRI P;
    |PINTA 2305, "Ejecutando proceso de copia ...";
    |ATRI 0;

    |DFICE direc;            || directorio
    nUnidad = 0;
    aPath = #1#10; |QBF aPath;
    |SI aPath = "A"; |O aPath = "A:"; |O aPath = "A:/"; |O aPath = "A:\";
        nUnidad = 1;
        unida   = "A";
    |FINSI;

    fiche = "exmaasil.asc";   |HAZ ejecuta2;
    fiche = "excuenta.asc";   |HAZ ejecuta2;
    fiche = "exclipro.asc";   |HAZ ejecuta2;
    fiche = "exivarep.asc";   |HAZ ejecuta2;
    fiche = "exivaref.asc";   |HAZ ejecuta2;
    fiche = "exivasop.asc";   |HAZ ejecuta2;
    fiche = "exivasof.asc";   |HAZ ejecuta2;
    fiche = "exmancob.asc";   |HAZ ejecuta2;
    fiche = "exmanpag.asc";   |HAZ ejecuta2;
    fiche = "exsiim01.asc";   |HAZ ejecuta2;
    fiche = "exsiim02.asc";   |HAZ ejecuta2;

    |BLIN 23;
|FPRC;

|PROCESO ejecuta2;
    |SI #1#1 = "E";     |HAZ exporta;  |FINSI;
    |SI #1#1 = "I";     |HAZ importa;  |FINSI;
|FPRC;

|PROCESO importa;
   aAlfa  = eaUnidadBasico + "/DS/DISKETTE";  |MKDIR aAlfa;
   aAlfa  = eaUnidadBasico + "/DS/DISKETTE/"
   |R_PDIR aAlfa;
   |PARA; |SI FSalida = 0; |HACIENDO;
           |RFBORRA aAlfa;
           |R_SDIR aAlfa;
   |SIGUE;

   aOrigen  = direc + fiche;
   |SI nUnidad = 1;
       aAlfa  = eaUnidadBasico + "/DS/DISKETTE/";
   |SINO;
       aAlfa  = aPath;
   |FINSI;
   aDestino = aAlfa + fiche; |QBT aDestino;
   |SI nUnidad = 1;
       aCopia   = "COPY " +  unida + ":" + fiche + " " + aDestino;
       |RSYSTEM aCopia;
   |FINSI;

   aIPRemoto = "";
   |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
   |SI aIPRemoto ! "";
       |RECIBE_FICHERO aDestino, aOrigen;
   |SINO;
       |COPIA_FICHERO aDestino, aOrigen;
   |FINSI;
|FPRC;

|PROCESO exporta;
   aAlfa  = eaUnidadBasico + "/DS/DISKETTE";  |MKDIR aAlfa;
   aAlfa  = eaUnidadBasico + "/DS/DISKETTE/"
   |R_PDIR aAlfa;
   |PARA; |SI FSalida = 0; |HACIENDO;
           |RFBORRA aAlfa;
           |R_SDIR aAlfa;
   |SIGUE;

   |SI nUnidad = 1;
       aAlfa    = eaUnidadBasico + "/DS/DISKETTE/"
   |SINO;
       aAlfa    = aPath;
   |FINSI;

   aOrigen  = direc + fiche;
   aDestino = aAlfa + fiche; |QBT aDestino;

   aIPRemoto = "";
   |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
   |SI aIPRemoto ! "";
       |ENVIA_FICHERO aOrigen, aDestino;
   |SINO;
       |COPIA_FICHERO aOrigen, aDestino;
   |FINSI;

   |SI nUnidad = 1;
       aCopia   = "COPY " + aDestino + " " + unida + ":" + fiche;
       |RSYSTEM aCopia;
   |FINSI;
|FPRC;
