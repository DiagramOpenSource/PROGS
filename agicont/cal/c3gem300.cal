|FICHEROS;
     c3gem300 #0;
     caman300 #1;
     caportad #2;
     canempre #30;
     caw00002 #99;
     camoneda #21;

     eosw0544 #544;
     eosw0552 #552;

     eosw0601 #601,MANTE;
|FIN;

|VARIABLES;
  empcon = 0;
  ejecon = 0;
  leidos = 0;
  dirfich0 = "";
  emp1 = 0;
  per1 = 0;
  xx = 0;
  yy = 0;
  anu = 0;
  desde = 0;
  hasta = 0;
  x = 0;
  y = 0;
  varcamp = 0;
  &r_emp = 0;
  &r_per = 0;
  inform1 = "caemi300";
  inform2 = "caemb300";
  informe = "";
  alfa1 = "";
  alfa2 = "";
  &dia = "";
  &mes = "";
  mesm = 0;
  &anyo = "";
  imsn1 = "";
  imsn2 = "";
  men9 = "     Empresa Contable INACTIVA ";
  sw   = 0;
  nGraba = 0;

     aValfa0     = "";
     aValfa1     = "";
     aValfa2     = "";
     aValfa      = "";
     nPosi       = 0;
     nSwPunto    = 0;

     aMoneda      = "";

     nTCampo      = 0;
     nAnyo2D      = 0;
     aAlfa        = "";

     aAbre        = "";
     aModelos     = "";

     nHandle1     = 0;
     nHandle2     = 0;
     nSwHay       = 0;

     aAlfa1       = "";
     aUnidad      = "";

  {1}aContiene    = "";

     &eaMonedEmpre = "";
     &eaFOrigen    = "";
     &eaFDestino   = "";
     &eaInternet   = "";
     &eaImpresora  = "";
     &enNume       = 0;
     &eaAlfa       = "";
     &eaDiaB       = "";
     &eaMesB       = "";
     &eaAnyoB      = "";
     &eaModelos    = "";
     &eaUnidadBasico = "";
     &eaPathLanza    = "";
|FIN;

|INCLUYE acceso_i;
|INCLUYE seguim_i;
|INCLUYE i_laserc;

|| *************************************************************************
||                        CALCULOS DE PANTALLA
|| *************************************************************************

|PROCESO TipoImpreso;  |TIPO 0;
     |SI #0#73 = "F";  |Y #0#1 [ 2001;
         |MENAV "     Tipo de Impreso Incorrecto.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO FPago; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;

 |SI #0#73 ! "F";
     |SI #0#74 = "A";
         |MENAV "    Opcion valida solo para Fichero / Internet. ";
         |ERROR;
     |FINSI;
 |FINSI;
|FPRC;

|PROCESO def_any; |TIPO 7;
     |SI #30#26 < 80;
         #0#1   = 2000 + #30#26;     |PINTA #0#1;
     |SINO;
         #0#1   = 1900 + #30#26;     |PINTA #0#1;
     |FINSI;

     aAlfa    = #0#1 % -102;
     nAnyo2D  = aAlfa;
|FPRC;

|PROCESO consulta;
  |SI FSalida ! 9;  |ACABA;  |FINSI;
  |SUB_EJECUTA "caconemp.run";
  |ERROR;
  |SI Campo = 8;
      #0#8 = r_emp;
      #0#10 = r_per;
      |PTEC 802;
      |PTEC 802;
  |FINSI;
  |SI Campo = 9;
      #0#9 = r_emp;
      #0#11 = r_per;
      |PTEC 802;
  |FINSI;
  |SI Campo ] 12;
      #0Campo = r_emp;
      varcamp = Campo + 20;
      #0varcamp = r_per;
      |PTEC 802;
      |PTEC 802;
  |FINSI;
|FPRC;

|PROCESO mayor1;
  |SI #0Campo = "N";
      |PARA x = 12;  |SI x [ 51;  |HACIENDO x = x + 1;
            |CAMPO_MODIFICA #0x,1,"S";
      |SIGUE;
      #0#8  = 0;
      #0#10 = 0;
      #0#9  = 0;
      #0#11 = 0;
      |CAMPO_MODIFICA #0#8,1,"N";
      |CAMPO_MODIFICA #0#10,1,"N";
      |CAMPO_MODIFICA #0#9,1,"N";
      |CAMPO_MODIFICA #0#11,1,"N";
      |PINTA #0#8;
      |PINTA #0#10;
      |PINTA #0#9;
      |PINTA #0#11;
  |SINO;
      |PARA x = 12;  |SI x [ 51;  |HACIENDO x = x + 1;
            #0x = 0;
            |CAMPO_MODIFICA #0x,1,"N";
      |SIGUE;
      |CAMPO_MODIFICA #0#8,1,"S";
      |CAMPO_MODIFICA #0#10,1,"S";
      |CAMPO_MODIFICA #0#9,1,"S";
      |CAMPO_MODIFICA #0#11,1,"S";
  |FINSI;
|FPRC;

|| --------------- comprueba desde-hasta empresas ---------------------------

|PROCESO buscaem1;
  |SI #30#26 ! nAnyo2D; |O #30#21 = "I";
      |ACABA;
  |FINSI;
  leidos = 1;
|FPRC;


|DEFBUCLE buscaempre;
#30#1;
;
#0#8,desde;
#0#9,hasta;
e;
NULL,buscaem1;
|FIN;


|PROCESO buclempre;
  |SI #0#10 > #0#11;
      |MENAV "     ERROR EN INTRODUCCION";
      |ERROR;
      |ACABA;
  |FINSI;
  |SI #0#8 = 0;  |Y #0#9 = 0;  |ACABA;  |FINSI;
  desde = #0#10;
  hasta = #0#11;
  leidos = 0;
  |BUCLE buscaempre;
  |SI leidos = 0;
      |MENAV "    ATENCION SELECCION VACIA";
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO deshas;
  |SI #0#9 < #0#8;
      |MENAV "      Error en Introduccion";
      |ERROR;
  |FINSI;
|FPRC;

|| ------------------------------------------------------------------------

|PROCESO nomodi;
  |PARA x = Campo + 1;  |SI x [ 31;  |HACIENDO x = x + 1;
        #0x = 0;
        |CAMPO_MODIFICA #0x,1,"N";
        y = x + 20;
        #0y = 0;
        |CAMPO_MODIFICA #0y,1,"N";
  |SIGUE;
  y = Campo + 20;
  #0y = 0;
  |CAMPO_MODIFICA #0y,1,"N";
  |PINTA #0y;
|FPRC;

|PROCESO esbuena; || desde campo de empresas seleccion
  |SI FSalida = 2; |ACABA; |FINSI;
  |SI #0Campo = 0; |HAZ nomodi;  |ACABA;  |FINSI;
  |ABRE #30;
  #30#2 = #0Campo;
  #30#3 = 0;
  |LEE 011#30];
  |SI FSalida ! 0;  |O #30#2 ! #0Campo;
      |MENAV "     NO Existe la empresa Contable";
      |ERROR;
  |FINSI;
  |CIERRA #30;
|FPRC;

|PROCESO esbuena1;
  |SI FSalida = 2;|ACABA;|FINSI;
  x = Campo - 20;
  |SI #0x = 0;  |ACABA;  |FINSI;
  |ABRE #30;
  x = Campo - 20;
  #30#2 = #0x;
  #30#3 = #0Campo;
  |LEE 011#30=;
  |SI FSalida ! 0;
      |MENAV "     NO Existe Periodo en la empresa Contable";
      |CIERRA #30;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #30;
  |SI #30#21 = "I";
      |MENAV men9;
      |ERROR;
      |ACABA;
  |FINSI;
  |SI #30#26 ! nAnyo2D;
      |MENAV "     El a¤o contable NO esta dentro de la seleccion ";
      |ERROR;
      |ACABA;
  |FINSI;
  x = Campo + 20;
  #0x = #30#1;
  |PINTA #0x;
  x = Campo - 20;
  alfa1 = #0x;
  alfa2 = #0Campo;
|FPRC;

|| **********************************************************************
||                       CALCULOS DE IMPRESION
|| **********************************************************************


|| *************** propio de la emision 300

|PROCESO Valor12;
     |SI eaMonedEmpre = "P";
        |SI eaMoneda = "P";
           nCanti = nCanti ! 0;
        |SINO;
           nCanti = ((nCanti / 166.386) ! 2) * 100;
        |FINSI;
     |SINO;
        |SI eaMoneda = "P";
           nCanti = (nCanti / 166.386) ! 2;
        |SINO;
           nCanti = nCanti * 100;
        |FINSI;
     |FINSI;

     |SI nCanti ] 0;
         aCanti = nCanti;
         aCanti = ("000000000000" + aCanti) % -112;
     |SINO;
         nCanti = -nCanti;
         aCanti = nCanti;
         aCanti = "N" + (("00000000000" + aCanti) % -111);
     |FINSI;
|FPRC;

|PROCESO Ent1Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti         = (("0" + aValfa1) % -101) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Ent2Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti = (("00" + aValfa1) % -102) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Ent3Dec2;
     aValfa   = (nCanti + "          ") % 110;
     nPosi    = 0;
     aValfa0  = "";
     aValfa1  = "";
     aValfa2  = "";
     nSwPunto = 0;
     |PARA nCampo = 1;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           nPosi  =  (100 * nCampo) + 1;
           aValfa0 = aValfa % nPosi;
           |SI aValfa0 = ".";  nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aValfa0 ! " "; |Y  aValfa0 ! ".";
                   aValfa1 = aValfa1 + aValfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aValfa0 ! " "; |Y aValfa0 ! ".";
                   aValfa2 = aValfa2 + aValfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aCanti         = (("000" + aValfa1) % -103) + ((aValfa2 + "00") % 102);
|FPRC;

|PROCESO Carga3002001;
     |DDEFECTO #99;

     #99#4  = (("00" + #2#16) % -102) + (("000" + #2#17) % -103);

     Valfa  = #2#13; |QBF Valfa;
     #99#5  = ("000000000" + Valfa) % -109;
     #99#6  = #2#2;
     #99#8  = #2#3;
     #99#9  = #2#4;
     #99#10 = #2#5;
     #99#11 = #2#6;
     #99#12 = #2#7;
     #99#13 = #2#8;
     #99#14 = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     #99#15 = #2#11;
     #99#16 = #2#12;
     #99#17 = #2#14;
     |SI #1#2 ] 80;
         #99#18 = "19" + #1#2;
     |SINO;
         #99#18 = "20" + (("00" + #1#2) % -102);
     |FINSI;
     #99#19 = #1#1;

     nCanti = #1#5;   |HAZ Valor12;  #99#20 = aCanti;
     nCanti = #1#6;   |HAZ Ent2Dec2; #99#21 = aCanti;
     nCanti = #1#7;   |HAZ Valor12;  #99#22 = aCanti;

     nCanti = #1#8;   |HAZ Valor12;  #99#23 = aCanti;
     nCanti = #1#9;   |HAZ Ent2Dec2; #99#24 = aCanti;
     nCanti = #1#10;  |HAZ Valor12;  #99#25 = aCanti;

     nCanti = #1#11;   |HAZ Valor12;  #99#26 = aCanti;
     nCanti = #1#12;   |HAZ Ent2Dec2; #99#27 = aCanti;
     nCanti = #1#13 ;  |HAZ Valor12;  #99#28 = aCanti;

     nCanti = #1#14;   |HAZ Valor12;  #99#29 = aCanti;
     nCanti = #1#15;   |HAZ Ent1Dec2;  #99#30 = aCanti;
     nCanti = #1#16;   |HAZ Valor12;  #99#31 = aCanti;

     nCanti = #1#17;   |HAZ Valor12;  #99#32 = aCanti;
     nCanti = #1#18;   |HAZ Ent1Dec2;  #99#33 = aCanti;
     nCanti = #1#19;   |HAZ Valor12;  #99#34 = aCanti;

     nCanti = #1#46;   |HAZ Valor12;  #99#35 = aCanti;
     nCanti = #1#47;   |HAZ Ent1Dec2;  #99#36 = aCanti;
     nCanti = #1#48;   |HAZ Valor12;  #99#37 = aCanti;

     nCanti = #1#49;   |HAZ Valor12;  #99#38 = aCanti;
     nCanti = #1#50;   |HAZ Valor12;  #99#39 = aCanti;

     nCanti = #1#20;   |HAZ Valor12;  #99#40 = aCanti;

     nCanti = #1#21 + #1#43;  |HAZ Valor12;  #99#41 = aCanti;
     nCanti = #1#22 + #1#44;  |HAZ Valor12;  #99#42 = aCanti;
     nCanti = #1#51 + #1#58;  |HAZ Valor12;  #99#43 = aCanti;
     nCanti = #1#23;          |HAZ Valor12;  #99#44 = aCanti;
     nCanti = #1#24;          |HAZ Valor12;  #99#45 = aCanti;

     nCanti = #1#25;          |HAZ Valor12;  #99#46 = aCanti;
     nCanti = #1#26;          |HAZ Valor12;  #99#47 = aCanti;
     nCanti = #1#27;          |HAZ Ent3Dec2; #99#48 = aCanti;
     nCanti = #1#28;          |HAZ Valor12;  #99#49 = aCanti;
     nCanti = #1#29;          |HAZ Valor12;  #99#50 = aCanti;
     nCanti = #1#54;          |HAZ Valor12;  #99#51 = aCanti;
     nCanti = #1#30;          |HAZ Valor12;  #99#52 = aCanti;

     nCanti = #1#28 - #1#29 + #1#30;  |HAZ Valor12;  #99#53 = aCanti;
     nCanti = #1#32;                  |HAZ Valor12;  #99#54 = aCanti;
     nCanti = #1#31;                  |HAZ Valor12;  #99#56 = aCanti;
     nCanti = #1#33;                  |HAZ Valor12;  #99#63 = aCanti;

     #99#55 = " ";
     |SI #1#50 = 0;  |Y #1#25 = 0;
         #99#55 = "X";
     |FINSI;

     |SI #1#31 ! 0;
         #99#57 = #2#66;
         #99#58 = #2#67;
         #99#59 = #2#68;
         #99#60 = #2#69;
     |FINSI;

     |SI #1#33 ! 0;
         #99#64 = #2#66;
         #99#65 = #2#67;
         #99#66 = #2#68;
         #99#67 = #2#69;
     |FINSI;

     #99#68 = dia;
     #99#69 = mes;
     #99#70 = #0#5 % -104;
     #99#71 = &13 + &10;
|FPRC;

|PROCESO Secuencial300_2001;
     Raiz       = "";  |DIRECTORIO Raiz;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda/" + eaTipoSec;
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;

     Empresa  = ("00000" + #2#0) % -105;

     Fichero    = eaTipoSec + Empresa;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NACopiar;
     NFichero   = Directorio + Fichero;          |QBF NFichero;
     NEmpresas  = NFichero;
     NACopiar   = NACopiar + 1;

     Fichero  = "wb  "+ NFichero;

     Pos = -1;
     |FABRE Fichero;
     Handle = FSalida;
     |SI FSalida ] 0;
         |HAZ Carga3002001;
         |PARA nCampo = 1;  |SI nCampo [ 71;  |HACIENDO nCampo = nCampo + 1;
               |SI #0#1 [ 1999;
                   |SI nCampo = 18;  |O nCampo = 70;
                       |SI nCampo = 18;
                           Cadena = Handle + " " + (#99nCampo % -102);
                       |FINSI;
                       |SI nCampo = 70;
                           Cadena = Handle + " " + (#99nCampo % -101);
                       |FINSI;
                   |SINO;
                       Cadena = Handle + " " + #99nCampo;
                   |FINSI;
               |SINO;
                   Cadena = Handle + " " + #99nCampo;
               |FINSI;

               |FGRABA Cadena;
         |SIGUE;
     |FINSI;
     FSalida = Handle;
     |FCIERRA FSalida;
|FPRC;

|PROCESO CargaImprime;
     aAlfa = "del err" + (("00000" + #1#0) % -105) + ".TXT" + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "wait mipf32 ";
     aAlfa = aAlfa + "/E:300" + (("00000" + #1#0) % -105) + ".TXT ";
     aAlfa = aAlfa + "/R:err" + (("00000" + #1#0) % -105) + ".TXT ";
     |SI eaImpresora ! "";
         aAlfa = aAlfa + "/I:" + &34 + eaImpresora + &34;
     |FINSI;
     aAlfa = aAlfa + " /C:" + #601#0;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL " + "300" + (("00000" + #1#0) % -105) + ".TXT ";
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle1, aAlfa;
|FPRC;

|PROCESO TDeclaracion;
     |SI #1#31 ! 0;
         |SI #2#69 ! "          ";
             #544#58 = #2#66;
             #544#59 = #2#67;
             #544#60 = #2#68;
             #544#61 = #2#69;
         |FINSI;
     |FINSI;

     |SI #1#33 ! 0;
         |SI #0#74 = "S";  |O #0#74 = "D";
             |SI #2#69 = "          ";
                 #544#62 = "X";
             |SINO;
                 #544#63 = "X";
                 #544#65 = #2#66;
                 #544#66 = #2#67;
                 #544#67 = #2#68;
                 #544#68 = #2#69;
             |FINSI;
         |FINSI;
     |FINSI;

     #544#4 = "";
     |SI #0#73 ! "F";
         |SI #1#20 = 0;  |Y #1#25 = 0;
             #544#4 = "N";
         |FINSI;
     |SINO;
         |SI #1#32 ! 0;
             #544#4 = "C";
         |FINSI;

         |SI #1#31 ! 0;
             #544#4 = "D";
             |SI #2#69 ! "          ";
                 #544#4 = "V";
             |FINSI;
         |FINSI;

         |SI #1#33 ! 0;
                                                   #544#4 = "I";
             |SI #0#74 = "A";                      #544#4 = "A";  |FINSI;
             |SI  #544#63 = "X";  |Y #0#74 = "D";  #544#4 = "U";  |FINSI;

             |SI #1#1 = 4;  |Y #0#1 = 2007;
                                     aAlfa  = "0";
                 |SI #544#4  = "I";  aAlfa  = "1";  |FINSI;
                 |SI #544#4  = "A";  aAlfa  = "2";  |FINSI;
                 |SI #544#4  = "U";  aAlfa  = "3";  |FINSI;

                 #544#62 = aAlfa;
                 #544#63 = "";
             |FINSI;
         |FINSI;

         |SI #1#20 = 0;  |Y #1#25 = 0; |Y #1#29 = 0;
             #544#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga300_2002;
     |SI #0#73 = "L";
         aAbre = eaUnidadBasico + "\MODELOS\300\" + "300" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#73 = "F";
         aAbre = eaInternet + "300" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |DDEFECTO #544;

     #544#1   = "300";
     #544#2   = "01";
     #544#3   = "";

     #544#5   = (("00" + #2#16) % -102) + (("000" + #2#17) % -103);
     aAlfa    = #2#13;  |QBF aAlfa;
     #544#6   = ("000000000" + aAlfa) % -109;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #544#8   = eaAlfa;
     #544#9   = ".";
     eaAlfa   = #2#3;    |HAZ QuitaRaros;     #544#10  = eaAlfa;
     eaAlfa   = #2#4;    |HAZ QuitaRaros;     #544#11  = eaAlfa;
     #544#12  = #2#5;
     #544#13  = #2#6;
     #544#14  = #2#7;
     #544#15  = #2#8;
     #544#16  = (("00" + #2#9) % -102) + (("000" + #2#10) % -103);
     eaAlfa   = #2#11;   |HAZ QuitaRaros;     #544#17  = eaAlfa;
     eaAlfa   = #2#12;   |HAZ QuitaRaros;     #544#18  = eaAlfa;
     eaAlfa   = #2#14;   |HAZ QuitaRarosTfno; #544#19 = eaAlfa;

     #544#20  = #0#1;
     #544#21  = #1#1 + "T";

     enNume   = #1#5;              |HAZ Conver13;    #544#22 = eaAlfa;
     enNume   = #1#6 * 100;        #544#23 = ("0000" + enNume) % -104;
     enNume   = #1#7;              |HAZ Conver13;    #544#24 = eaAlfa;

     enNume   = #1#8;              |HAZ Conver13;    #544#25 = eaAlfa;
     enNume   = #1#9 * 100;        #544#26 = ("0000" + enNume) % -104;
     enNume   = #1#10;             |HAZ Conver13;    #544#27 = eaAlfa;

     enNume   = #1#11;             |HAZ Conver13;    #544#28 = eaAlfa;
     enNume   = #1#12 * 100;       #544#29 = ("0000" + enNume) % -104;
     enNume   = #1#13;             |HAZ Conver13;    #544#30 = eaAlfa;

     enNume   = #1#14;             |HAZ Conver13;    #544#31 = eaAlfa;
     enNume   = #1#15 * 100;       #544#32 = ("0000" + enNume) % -103;
     enNume   = #1#16;             |HAZ Conver13;    #544#33 = eaAlfa;

     enNume   = #1#17;             |HAZ Conver13;    #544#34 = eaAlfa;
     enNume   = #1#18 * 100;       #544#35 = ("0000" + enNume) % -103;
     enNume   = #1#19;             |HAZ Conver13;    #544#36 = eaAlfa;

     enNume   = #1#46;             |HAZ Conver13;    #544#37 = eaAlfa;
     enNume   = #1#47 * 100;       #544#38 = ("0000" + enNume) % -103;
     enNume   = #1#48;             |HAZ Conver13;    #544#39 = eaAlfa;

     enNume   = #1#49;             |HAZ Conver13;  #544#40 = eaAlfa;
     enNume   = #1#50;             |HAZ Conver13;  #544#41 = eaAlfa;

     enNume   = #1#20;             |HAZ Conver13;  #544#42 = eaAlfa;

     enNume  = #1#21 + #1#43;      |HAZ Conver13;  #544#43 = eaAlfa;
     enNume  = #1#22 + #1#44;      |HAZ Conver13;  #544#44 = eaAlfa;
     enNume  = #1#51 + #1#58;      |HAZ Conver13;  #544#45 = eaAlfa;
     enNume  = #1#23;              |HAZ Conver13;  #544#46 = eaAlfa;
     enNume  = #1#24;              |HAZ Conver13;  #544#47 = eaAlfa;

     enNume  = #1#25;              |HAZ Conver13;  #544#48 = eaAlfa;

     enNume  = #1#26;              |HAZ Conver13;  #544#49 = eaAlfa;
     enNume  = #1#27 * 100;                        #544#50 = ("00000" + enNume) % -105;
     enNume  = #1#28;              |HAZ Conver13;  #544#51 = eaAlfa;
     enNume  = #1#29;              |HAZ Conver13;  #544#52 = eaAlfa;
     enNume  = #1#54;              |HAZ Conver13;  #544#53 = eaAlfa;
     enNume  = #1#30;              |HAZ Conver13;  #544#54 = eaAlfa;
     enNume  = #1#28 - #1#29 + #1#30;  |HAZ Conver13;  #544#55 = eaAlfa;
     enNume  = #1#32;              |HAZ Conver13;  #544#56 = eaAlfa;
     enNume  = #1#31;              |HAZ Conver13;  #544#57 = eaAlfa;
     enNume  = #1#33;              |HAZ Conver13;  #544#64 = eaAlfa;

     |HAZ TDeclaracion;

     eaAlfa  = #2#89;          |HAZ QuitaRaros;     #544#69  = eaAlfa;
     eaAlfa  = #2#90 + #2#91;  |HAZ QuitaRarosTfno; #544#70  = eaAlfa;

     eaAlfa  = #0#5;     |HAZ FechaBonito;

     #544#75 = eaDiaB;
     #544#76 = eaMesB;
     #544#77 = eaAnyoB;
     #544#78 = &13 + &10;

     |SI #0#73 = "L";
         #544#7  = "";
         #544#69 = "";
         #544#70 = "";
         #544#71 = "";
         #544#72 = "";
         #544#73 = "";
         #544#74 = "";
         nTCampo = 78;
     |FINSI;

     |SI #0#73 = "F";
         || Esto es porque dicen que en internet no lo quiere a
         || cero.

         |SI #544#23 = "0000";  #544#23 = "    ";  |FINSI;
         |SI #544#26 = "0000";  #544#26 = "    ";  |FINSI;
         |SI #544#29 = "0000";  #544#29 = "    ";  |FINSI;
         |SI #544#32 = "000";   #544#32 = "   ";   |FINSI;
         |SI #544#35 = "000";   #544#35 = "   ";   |FINSI;
         |SI #544#38 = "000";   #544#38 = "   ";   |FINSI;

         #544#2  = "";
         #544#3  = "";
         #544#5  = "";
         #544#8  = "";
         #544#9  = "";
         #544#10 = "";
         #544#11 = "";
         #544#12 = "";
         #544#13 = "";
         #544#14 = "";
         #544#15 = "";
         #544#16 = "";
         #544#17 = "";
         #544#18 = "";
         #544#19 = "";
         #544#75 = "";
         #544#76 = "";
         #544#77 = "";
         #544#78 = "";
         nTCampo = 77;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           nGraba = 0;
           |SI #1#1 = 4;  |Y #0#1 = 2007;  |Y nCampo = 63;  |Y #0#73 = "F";
               nGraba = 1;
           |FINSI;

           |SI nGraba = 0;
               aAlfa = #544nCampo;
               |XGRABA nHandle2, aAlfa;
           |FINSI;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#73 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO TDeclaracion_2008;
     |SI #1#31 ! 0;
         |SI #2#69 ! "          ";
             #552#51 = #2#66;
             #552#52 = #2#67;
             #552#53 = #2#68;
             #552#54 = #2#69;
         |FINSI;
     |FINSI;

     #552#55 = "0";
     |SI #1#33 ! 0;
         #552#55 = "1";
         |SI #0#74 = "S";  |O #0#74 = "D";
             |SI #2#69 ! "          ";
                 |SI #0#74 = "S";  #552#55 = "2";  |FINSI;
                 |SI #0#74 = "D";  #552#55 = "3";  |FINSI;

                 #552#57 = #2#66;
                 #552#58 = #2#67;
                 #552#59 = #2#68;
                 #552#60 = #2#69;
             |FINSI;
         |FINSI;
     |FINSI;

     #552#4 = "";
     |SI #0#73 ! "F";
         |SI #1#20 = 0;  |Y #1#25 = 0;
             #552#4 = "N";
         |FINSI;
     |SINO;
         |SI #1#32 ! 0; #552#4 = "C"; |FINSI;
         |SI #1#31 ! 0; #552#4 = "D"; |FINSI;

         |SI #1#33 ! 0;
                                                  #552#4 = "I";
             |SI  #0#8 = "A";                     #552#4 = "A";  |FINSI;
             |SI  #552#55 = "3";  |Y #0#8 = "D";  #552#4 = "U";  |FINSI;
         |FINSI;

         |SI #1#20 = 0;  |Y #1#25 = 0; |Y #1#29 = 0;
             #552#4 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Carga300_2008;
     |SI #0#73 = "L";
         aAbre = eaUnidadBasico + "\MODELOS\300\" + "300" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |SI #0#73 = "F";
         aAbre = eaInternet + "300" + (("00000" + #1#0) % -105) + ".TXT";
         |XABRE "CBW", aAbre, nHandle2;
     |FINSI;

     |DDEFECTO #552;

     #552#1   = "300";
     #552#2   = "01";
     #552#3   = "";

     #552#5   = (("00" + #2#16) % -102) + (("000" + #2#17) % -103);
     aAlfa    = #2#13;  |QBF aAlfa;
     #552#6   = ("000000000" + aAlfa) % -109;
     eaAlfa   = #2#102;  |HAZ QuitaRaros;     #552#7   = eaAlfa;
     eaAlfa   = #2#2;    |HAZ QuitaRaros;     #552#8   = eaAlfa;
     #552#9   = ".";
     #552#10  = #0#1;
     #552#11  = #1#1 + "T";

     enNume   = #1#5;              |HAZ Conver13;    #552#12 = eaAlfa;
     enNume   = #1#6 * 100;        #552#13 = ("0000" + enNume) % -104;
     enNume   = #1#7;              |HAZ Conver13;    #552#14 = eaAlfa;

     enNume   = #1#8;              |HAZ Conver13;   #552#15 = eaAlfa;
     enNume   = #1#9 * 100;        #552#16 = ("0000" + enNume) % -104;
     enNume   = #1#10;             |HAZ Conver13;   #552#17 = eaAlfa;

     enNume   = #1#11;             |HAZ Conver13;   #552#18 = eaAlfa;
     enNume   = #1#12 * 100;       #552#19 = ("0000" + enNume) % -104;
     enNume   = #1#13;             |HAZ Conver13;   #552#20 = eaAlfa;

     enNume   = #1#14;             |HAZ Conver13;   #552#21 = eaAlfa;
     enNume   = #1#15 * 100;       #552#22 = ("000" + enNume) % -103;
     enNume   = #1#16;             |HAZ Conver13;   #552#23 = eaAlfa;

     enNume   = #1#17;             |HAZ Conver13;   #552#24 = eaAlfa;
     enNume   = #1#18 * 100;       #552#25 = ("000" + enNume) % -103;
     enNume   = #1#19;             |HAZ Conver13;   #552#26 = eaAlfa;

     enNume   = #1#46;             |HAZ Conver13;   #552#27 = eaAlfa;
     enNume   = #1#47 * 100;       #552#28 = ("000" + enNume) % -103;
     enNume   = #1#48;             |HAZ Conver13;   #552#29 = eaAlfa;

     enNume   = #1#49;             |HAZ Conver13;  #552#30 = eaAlfa;
     enNume   = #1#50;             |HAZ Conver13;  #552#31 = eaAlfa;

     enNume   = #1#20;             |HAZ Conver13;  #552#32 = eaAlfa;

     enNume  = #1#21 + #1#43;      |HAZ Conver13;  #552#33 = eaAlfa;
     enNume  = #1#22 + #1#44;      |HAZ Conver13;  #552#34 = eaAlfa;
     enNume  = #1#51 + #1#58;      |HAZ Conver13;  #552#35 = eaAlfa;
     enNume  = #1#23;              |HAZ Conver13;  #552#36 = eaAlfa;
     enNume  = #1#24;              |HAZ Conver13;  #552#37 = eaAlfa;
     enNume  = #1#61;              |HAZ Conver13;  #552#38 = eaAlfa;

     enNume  = #1#25;              |HAZ Conver13;  #552#39 = eaAlfa;

     enNume  = #1#26;              |HAZ Conver13;  #552#40 = eaAlfa;
     enNume  = #1#27 * 100;                        #552#41 = ("00000" + enNume) % -105;
     enNume  = #1#28;              |HAZ Conver13;  #552#42 = eaAlfa;
     enNume  = #1#29;              |HAZ Conver13;  #552#43 = eaAlfa;
     enNume  = #1#54;              |HAZ Conver13;  #552#44 = eaAlfa;
     enNume  = #1#30;              |HAZ Conver13;  #552#45 = eaAlfa;
     enNume  = #1#28 - #1#29 + #1#30;  |HAZ Conver13;  #552#46 = eaAlfa;
     enNume  = 0;                      |HAZ Conver13;  #552#47 = eaAlfa;
     enNume  = #1#28 - #1#29 + #1#30;  |HAZ Conver13;  #552#48 = eaAlfa;
     enNume  = #1#32;              |HAZ Conver13;  #552#49 = eaAlfa;
     enNume  = #1#31;              |HAZ Conver13;  #552#50 = eaAlfa;
     enNume  = #1#33;              |HAZ Conver13;  #552#56 = eaAlfa;

     |HAZ TDeclaracion_2008;

     eaAlfa  = #2#89;          |HAZ QuitaRaros;     #552#63  = eaAlfa;
     eaAlfa  = #2#90 + #2#91;  |HAZ QuitaRarosTfno; #552#64  = eaAlfa;

     eaAlfa  = #0#5;     |HAZ FechaBonito;

     #552#70 = eaDiaB;
     #552#71 = eaMesB;
     #552#72 = eaAnyoB;
     #552#73 = &13 + &10;

     |SI #0#73 = "L";
         #552#7  = "";
         #552#61 = "";
         #552#63 = "";
         #552#64 = "";
         #552#65 = "";
         #552#66 = "";
         #552#67 = "";
         #552#68 = "";
         nTCampo = 73;
     |FINSI;

     |SI #0#73 = "F";
         |SI #552#13 = "0000";  #552#13 = "    ";  |FINSI;
         |SI #552#16 = "0000";  #552#16 = "    ";  |FINSI;
         |SI #552#19 = "0000";  #552#19 = "    ";  |FINSI;
         |SI #552#22 = "000";   #552#22 = "   ";   |FINSI;
         |SI #552#25 = "000";   #552#25 = "   ";   |FINSI;
         |SI #552#28 = "000";   #552#28 = "   ";   |FINSI;

         #552#2  = "";
         #552#3  = "";
         #552#5  = "";
         #552#8  = "";
         #552#9  = "";
         #552#69 = "";
         #552#70 = "";
         #552#71 = "";
         #552#72 = "";
         #552#73 = "";
         nTCampo = 72;
     |FINSI;

     aAlfa = "";
     |PARA nCampo = 1;  |SI nCampo [ nTCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #552nCampo;
           |XGRABA nHandle2, aAlfa;
     |SIGUE;
     |XCIERRA nHandle2;

     |SI #0#6 = "L";
         |HAZ CargaImprime;
     |FINSI;

     nSwHay = 1;
|FPRC;

|PROCESO imprimir;
     sw = 1;
     |SI #0#73 = "O";  |O #0#73 = "B";
         |PRINT;
     |SINO;
         |SI #0#1 [ 2001;
             |HAZ Secuencial300_2001;
         |FINSI;

         |SI #0#1 ] 2002;  |Y #0#1 [ 2007;
             |HAZ Carga300_2002;
         |FINSI;

         |SI #0#1 ] 2008;
             |HAZ Carga300_2008;
         |FINSI;
     |FINSI;

     |LIBERA #1;
|FPRC;

|PROCESO graba1;
  |SI #0#73 = "B"; |ACABA; |FINSI;
  #1#3 = #0#5;
  #1#4 = "S";
  |GRABA 021#1a;
  |LIBERA #1;
   se_empre  = #2#0;
   se_ejerc  = #2#1;
   se_modelo = "300";
   se_impor  = #1#33 - #1#31 - #1#32;
   se_fecha  = #1#3;
   |SI SwAgicli = 1;
       |HAZ AlAgicl2;
   |FINSI;
|FPRC;

|DEFBUCLE mira_300;
#1#2;
;
#0#0 , #0#3 , nAnyo2D, imsn1;
#0#0 , #0#3 , nAnyo2D, imsn2;
be;
NULL , imprimir;
|FIN;

|DEFBUCLE graba_300;
#1#2;
;
#0#0 , #0#3 , nAnyo2D, imsn1;
#0#0 , #0#3 , nAnyo2D, imsn2;
be;
NULL , graba1;
|FIN;

|PROCESO lee_fijos;
  |ABRE #2;
  #2#0 = #30#2;
  #2#1 = #30#26;
  |LEE 001#2=;
  |SI FSalida ! 0;
      |DDEFECTO #2;
  |FINSI;
  |CIERRA #2;
|FPRC;

|PROCESO fecha;
  dia = #0#5 % 102;
  anyo = #0#5 % 704;
  mes = #0#5 % 402;
  mesm = mes;
  |SI mesm = 1;  mes = "ENERO";      |FINSI;
  |SI mesm = 2;  mes = "FEBRERO";    |FINSI;
  |SI mesm = 3;  mes = "MARZO";      |FINSI;
  |SI mesm = 4;  mes = "ABRIL";      |FINSI;
  |SI mesm = 5;  mes = "MAYO";       |FINSI;
  |SI mesm = 6;  mes = "JUNIO";      |FINSI;
  |SI mesm = 7;  mes = "JULIO";      |FINSI;
  |SI mesm = 8;  mes = "AGOSTO";     |FINSI;
  |SI mesm = 9;  mes = "SEPTIEMBRE"; |FINSI;
  |SI mesm = 10; mes = "OCTUBRE";    |FINSI;
  |SI mesm = 11; mes = "NOVIEMBRE";  |FINSI;
  |SI mesm = 12; mes = "DICIEMBRE";  |FINSI;
|FPRC;

|PROCESO reimpr;
   |SI #0#73 = "B";
       imsn1 = " ";
       imsn2 = "z";
   |SINO;
       imsn1 = #0#72;
       imsn2 = #0#72;
   |FINSI;
|FPRC;

|PROCESO haztodo;
     aMoneda     = eaMoneda;
     enEmpresa   = #canempre#2;
     enPeriodo   = #canempre#3;
     swOperacion = 0
     |SUB_EJECUTA "camoneda.tab";
     eaMoneda    = aMoneda;

     eaMonedEmpre = "P";
     |SI #0#1 ] 2001;
         |SI #0#73 = "L";  |O #0#73 = "F";
             |ABRE #camoneda;
             #camoneda#0 = #canempre#2;
             #camoneda#1 = #canempre#3;
             |LEE 000#camoneda.=;
             |SI FSalida = 0;
                 eaMonedEmpre = #camoneda#2;
             |FINSI;
             |CIERRA #camoneda;
        |FINSI;
     |FINSI;

     |PATH_DAT #1 dirfich0;
     |PATH_DAT #2 dirfich0;

     anu = 1900 + #30#26;
     |SI anu [ 1970;  anu = anu + 100;  |FINSI;
     empcon = #30#1;
     ejecon = #30#26;

     |HAZ fecha;
     |HAZ lee_fijos;
     |HAZ reimpr;
     |BUCLE mira_300;

     |SI #0#73 = "O";  |O #0#73 = "B";
         |PIEINF;
     |FINSI;

     |SI #0#73 ! "B"; |BUCLE graba_300; |FINSI;
|FPRC;

|| ---------- Seleccion DESDE / HASTA Empresa.

|PROCESO esdesd1;
  |DBASE dir_fich;
  dirfich0 = dir_fich + "fich/";
  alfa1 = #30#2;
  alfa2 = #30#3;
  emp1 = #30#2;
  per1 = #30#3;
  alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
  alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
  dirfich0 = dirfich0 + alfa1 + alfa2 + "/";

  |SI #30#26 ! nAnyo2D; |O #30#21 = "I";
      |ACABA;
  |FINSI;

  |HAZ haztodo;
|FPRC;


|DEFBUCLE esdesde;
#30#1;
;
#0#8,#0#10;
#0#9,#0#11;
e;
NULL,esdesd1;
|FIN;


|| ---------- Seleccion en parrilla.

|PROCESO esunaauna;
  |PARA xx = 12;  |SI xx [ 31;  |HACIENDO xx = xx + 1;
        |SI #0xx = 0;  |SAL;  |FINSI;
        |DBASE dir_fich;
        dirfich0 = dir_fich + "fich/";
        yy = xx + 20;
        emp1 = #0xx;
        per1 = #0yy;
        alfa1 = #0xx;
        alfa2 = #0yy;
        alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
        alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
        dirfich0 = dirfich0 + alfa1 + alfa2 + "/";
|| lee empresa
        |ABRE #30;
        #30#2 = emp1;
        #30#3 = per1;
        |LEE 011#30=;
        |CIERRA #30;
        |SI #30#26 ! nAnyo2D; |O #30#21 = "I";
            |VETE otramas;
        |FINSI;
        |HAZ haztodo;
|ET otramas;
  |SIGUE;
|FPRC;

|PROCESO Impresora;
   |IMPRE 0;
   |SI FSalida ! 0; |ACABA; |FINSI;
     |SI #0#73 = "O";
         informe = inform1;
     |SINO;
         informe = inform2;
     |FINSI;
     |INFOR informe;

   |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

  |HAZ AlAgicl1;
  |SI #0#7 = "S";
      |BUCLE esdesde;
  |SINO;
      |HAZ esunaauna;
  |FINSI;
  |FININF;
  |FINIMP;
|FPRC;

|PROCESO AbreImprime;
     aAbre = eaUnidadBasico + "\MODELOS\300\imprime.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = eaUnidadBasico + &13 + &10;                       |XGRABA nHandle1, aAlfa;
     aAlfa = "CD " + eaUnidadBasico + "\MODELOS" + &13 + &10;  |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 300" + &13 + &10;                             |XGRABA nHandle1, aAlfa;

     aAlfa = #0#1;
     aAlfa = aAlfa % -102;
     aVersion = "";

     |SI #0#1 ] 2008;
         aVersion = "01";
         |SI #0#1 = 2008;
             |SI #0#3 ] 2; |Y #0#0 = "T";
                 aVersion = "02";
             |FINSI;
             |SI #0#3 ] 6; |Y #0#0 = "M";
                 aVersion = "02";
             |FINSI;
         |FINSI;
     |FINSI;

     aAlfa1 = "DEL ERRORES.RST" + &13 + &10;      |XGRABA nHandle1, aAlfa1;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidad = (aContiene1 % 102) > "";

     |SI aVersion = "";
         aAlfa = "ZLS" + aAlfa + "MPF.EXE /T:" + aUnidad + "\MODELOS\300\"+ &13 + &10;
     |SINO;
         aAlfa = "Z" + aAlfa + aVersion + "MPF.EXE /T:" + aUnidad + "\MODELOS\300\"+ &13 + &10;
     |FINSI;

     |XGRABA nHandle1, aAlfa;

     |SI #0#1 ] 2002;
         aAlfa = "MOVE ERRORM~1.TXT ERRORMIPF.TXT" + &13 + &10;      |XGRABA nHandle1, aAlfa;
         aAlfa = "MOVE EAN128~1.DLL EAN128_32.DLL" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     |FINSI;
|FPRC;

|PROCESO EmiteEsto;
     aAlfa = "DEL *.wmf" + &13 + &10;             |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.tab"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.dll"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errorm~1.txt" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errormipf.txt"  + &13 + &10;    |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL errmipf.txt"  + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL *.exe"  + &13 + &10;            |XGRABA nHandle1, aAlfa;
     |XCIERRA nHandle1;

     eaModelos = "300";   |HAZ Copiampf;

     aAlfa = eaUnidadBasico + "\MODELOS\300\IMPRIME";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Laser;
     eaMoneda  = "P";
     |SI #0#1 = 2001;
         |PUSHV 1921 2155;
         |BLANCO 1921 2155;
         |CUADRO 1923 2153;
         |ATRI R; |PINTA 1924 , " Seleccione moneda de emision "; |ATRI N;
         |PINTA 2031, "(Pesetas/Euros)";
         |ATRI I; |PINTA 2032, "P"; |PINTA 2040, "E"; |ATRI N;
         E_sup   = 1;
         E_i nf  = "EP";
         eaMoneda  = "P";
         eaMoneda  = 2047 ? 0;
         |POPV;
     |FINSI;

     |SI #0#1 ] 2002;
         eaMoneda  = "E";
     |FINSI;

     |SI #0#1 ] 2002;
         |SI #0#73 = "L";
             |PARA;  |SI;  |HACIENDO;
                  |DDEFECTO #601;
                  |PINPA #0#601;
                  |PINDA #0#601;
                  |ENDATOS #1#601;
                  |SI FSalida = 0;
                      aAlfa = eaUnidadBasico + "/MODELOS";      |RMKDIR aAlfa;
                      aAlfa = eaUnidadBasico + "/MODELOS/300";  |RMKDIR aAlfa;
                      eaPathLanza = aAlfa + "/";
                      |HAZ AbreImprime;
                      |SAL;
                  |FINSI;
             |SIGUE;
          |FINSI;

          |SI #0#73 = "F";
              aAlfa      = eaUnidadBasico + "/AEAT";                       |RMKDIR aAlfa;
              aAlfa      = eaUnidadBasico + "/AEAT/INTERNET";              |RMKDIR aAlfa;
              aAlfa      = eaUnidadBasico + "/AEAT/INTERNET/300";          |RMKDIR aAlfa;
              aAlfa      = eaUnidadBasico + "/AEAT/INTERNET/300/" + #0#1;  |RMKDIR aAlfa;
              eaInternet = aAlfa + "/";
          |FINSI;
     |FINSI;

     nSwHay = 0;

     |HAZ AlAgicl1;
     |SI #0#7 = "S";
         |BUCLE esdesde;
     |SINO;
         |HAZ esunaauna;
     |FINSI;

     |SI #0#73 = "L";
         |SI #0#1 [ 2001;
             |SI sw = 1;  |HAZ GrabaDisketteL;  |FINSI;
         |FINSI;

         |SI #0#1 ] 2002;
             |SI nSwHay = 1;
                 |HAZ EmiteEsto;
                 eaTipoSec = "300";
                 eaTipoEmi = "ERRORES";
                 enAnyo    = #0#1;
                 |SUB_EJECUTA "eosz9999";
             |SINO;
                 |MENAV "     Seleccion Vacia";
                 |XCIERRA nHandle1;
             |FINSI;

             aAlfa = eaUnidadBasico + "\MODELOS\300\imprime.bat";
             |RFBORRA aAlfa;
         |FINSI;
     |FINSI;

     |SI #0#73 = "F";  |Y #0#1 ] 2002;
         |SI nSwHay = 1;
             aAlfa =  "      Ficheros Generados. Situados en " + eaInternet + " de su PC";
             |MENAV aAlfa;
         |SINO;
             |MENAV "     Seleccion Vacia";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO impre; |TIPO 3;
     |HAZ LeeUnidadBasico;
     aAlfa     = #0#1 % -102;
     nAnyo2D   = aAlfa;
     enAnyo    = #0#1;
     eaTipoSec = "300";
     aTipoSec  = "300";
     enPer     = #0#3;

     |SI #0#73 = "L"; |O #0#73 = "F";  |HAZ Laser;      |FINSI;
     |SI #0#73 = "O"; |O #0#73 = "B";  |HAZ Impresora;  |FINSI;
|FPRC;
