|FICHEROS;
   dsboem03 #0;
|FIN;

|VARIABLES;
   aAlfa    = "";
   aAlfaClv = "";
   aClave   = "";

   nCont    = 0;
   nCalc    = 0;
   nNumChar = 0;
   nPos     = 0;
|FIN;

|PROCESO Encriptado;
   aAlfaClv = "";
   aAlfa = aClave; |QBF aAlfa;
   aAlfa = aAlfa % 0; nNumChar = aAlfa;
   |PARA nCont = 1; |SI nCont [ nNumChar; |HACIENDO nCont = nCont + 1;
      nCalc = (nCont * 100) + 1; aAlfa = aClave % nCalc;
      nCalc = &aAlfa;
      |SI nCalc > 79;
         nCalc = 79 - (nCalc - 79);
      |SINO;
         nCalc = 79 + (79 - nCalc);
      |FINSI;
      aAlfaClv = aAlfaClv + &nCalc;
   |SIGUE;
   aClave = aAlfaClv;
|FPRC;

|PROCESO Tipo00F03C07;
   |PINTA #dsboem03#14;
|FPRC;

|PROCESO Tipo07F03C07; |TIPO 7;
   |C_V #dsboem03#14, 1, "N";
   |C_P #dsboem03#14, 0, nPos;

   aClave = #dsboem03#7;
   |HAZ Encriptado;

   E_sup = 20;
   E_inf = "";
   aClave = nPos ? -1;

   aAlfa = aClave; |QBF aAlfa;
   aAlfa = aAlfa % 0; nCalc = aAlfa;
   aAlfa = "*" * nCalc;
   #dsboem03#14 = aAlfa; |PINTA #dsboem03#14;

   |HAZ Encriptado;
   #dsboem03#7 = aClave;
|FPRC;

|PROCESO MiraTipo;
   |SI #dsboem03#12 ! "E";
      #dsboem03#13 = 0; |PINTA #dsboem03#13;
      |C_M #dsboem03#13, 1, "N";
   |SINO;
      |C_M #dsboem03#13, 1, "S";
   |FINSI;
|FPRC;

|PROGRAMA;
   |ABRE #dsboem03;
   |LEE 000#dsboem03.p;
   |SI FSalida ! 0;
      |DDEFECTO #dsboem03;
      |GRABA 020#dsboem03.c;
   |FINSI;

   |CLS;
   |CABEZA "Parametros Boecom";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dsboem03.a;
   |FINSI;
   |CIERRA #dsboem03;
|FPRO;
