|FICHEROS;
   zconcili #0;
   camaasil #1;
   caconccu #2;
   imporcon #3;
|FIN;

|VARIABLES;
    swvic = 0;
    &entrada = 1;
    &ext1     = "";
    &ext2     = "";
    &fichero  = "";
    &asien1   = 0;
    &asien2   = 0;
    &docum    = 0;
    &fecha    = @;

    &contador = 0;
    &cuenta   = "";
    &digito   = 0;
    &saldoant = 0;
    &nombre   = "";
    &eaCam5   = "";
    &enCam6   = 0;
    &enCam7   = 0;
    &eaCam8   = "";
    &eaCam9   = "";
    &eaCam10  = "";

    sw        = 0;
    inkey = 0;
 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|RUTINA inferior;
#0#0 = 1;
|FRUT;

|RUTINA superior;
#0#0 = contador;
|FRUT;

|PROCESO comim; |TIPO 11;
  |SI FSalida = 15;
       swvic = 1;
       |PTEC 806;
  |FINSI;
|FPRC;

|PROGRAMA;

  |PINPA #0#2;
  #2#0  = cuenta;
  #2#1  = digito;
  #2#2  = saldoant;
  #2#4  = nombre;
  #2#5  = eaCam5;
  #2#6  = enCam6;
  #2#7  = enCam7;
  #2#8  = eaCam8;
  #2#9  = eaCam9;
  #2#10 = eaCam10;
  |PINDA #0#2;

  |NOME_DAT #0fichero;

  |PARA; |SI; |HACIENDO;
         swvic=0;
         |ENTLINEAL #1#0, -1, 4, 22, 0, inferior, superior;
         |SI swvic = 1;
             |ABRE #0;
             |HAZ cociimp;
             |CIERRA #0;
         |SINO;
             |SAL;
         |FINSI;
   |SIGUE;
|FPRO;

|PROCESO pintali1; |TIPO 0;
|CAMPO_ATRIBUTO #0#0, R, 0, 0;
|CAMPO_ATRIBUTO #0#2, R, 0, 0;
|CAMPO_ATRIBUTO #0#3, R, 0, 0;
|CAMPO_ATRIBUTO #0#5, R, 0, 0;
|CAMPO_ATRIBUTO #0#6, R, 0, 0;
|CAMPO_ATRIBUTO #0#7, R, 0, 0;
|CAMPO_ATRIBUTO #0#8, R, 0, 0;
|PINTA #0#0;
|PINTA #0#2;
|PINTA #0#3;
|PINTA #0#5;
|PINTA #0#6;
|PINTA #0#7;
|PINTA #0#8;

|PUSHV 0401 2380;
|CUADRO 0447 1278;
|ATRI R;
|PINTA 0548, "    <F12> Puntear             ";
|PINTA 0648, "    <F2>  Anular punteado     ";
|PINTA 0748, "    <F3>  Extracto general    ";
|PINTA 0848, "    <F4>  Asiento concreto    ";
|PINTA 0948, "    <F5>  Buscar por importe  ";
|PINTA 1048, "    <F6>  Diferencias         ";
FSalida = -1;
|ENCAMPO #8#0;
|POPV;
|PINTA #2#3;
|FPRC;

|PROCESO pidetecl; |TIPO 0;
  |SI sw = 1; |ACABA; |FINSI;
  sw = 0;
|ET arriba;
  |SI sw = 1;
      FSalida = 0;
      |ENCAMPO #8#0;
  |FINSI;
  |SI FSalida < 9; |O FSalida > 14;
      sw = 0;
      |ACABA;
  |FINSI;

  |SI FSalida = 9; |Y #0#8 ! "*";
      |LIBERA #0;
      |LEE 110#0=;
      #0#8 = "*";
      |PINTA #0#8;
      |GRABA 020#0a;
      #2#3 = #2#3 + (#0#6 - #0#7);
  |FINSI;

  |SI FSalida = 10; |Y #0#8 = "*";
      |LIBERA #0;
      |LEE 110#0=;
      #0#8 = " ";
      |PINTA #0#8;
      |GRABA 020#0a;
      #2#3 = #2#3 - (#0#6 - #0#7);
  |FINSI;

  |SI FSalida = 11;
      ext1 = #2#0;
      ext2 = #2#1;
      |SUB_EJECUTA "caextrac.run";
      sw = 1;
      |VETE arriba;
  |FINSI;

  |SI FSalida = 12;
      ext1   = #0#1;
      ext2   = #0#1;
      asien1 = 0;
      asien2 = 999999;
      docum  = #0#3;
      fecha  = #0#2;
      |SUB_EJECUTA "caditrac.run";
      sw = 1;
      |VETE arriba;
  |FINSI;

  |SI FSalida = 13;
      ext1 = #2#0;
      ext2 = #2#1;
      |SUB_EJECUTA "caextrai.run";
      sw = 1;
      |VETE arriba;
  |FINSI;

  |SI FSalida = 14;
      ext1 = #2#0;
      ext2 = #2#1;
      |SUB_EJECUTA "caconci1.run";
      sw = 1;
      |VETE arriba;
  |FINSI;
  sw = 0;
|FPRC;


|PROCESO pintali2; |TIPO 0;
|CAMPO_ATRIBUTO #0#0, D, 0, 0;
|CAMPO_ATRIBUTO #0#2, D, 0, 0;
|CAMPO_ATRIBUTO #0#3, D, 0, 0;
|CAMPO_ATRIBUTO #0#5, D, 0, 0;
|CAMPO_ATRIBUTO #0#6, D, 0, 0;
|CAMPO_ATRIBUTO #0#7, D, 0, 0;
|CAMPO_ATRIBUTO #0#8, D, 0, 0;
|PINTA #0#0;
|PINTA #0#2;
|PINTA #0#3;
|PINTA #0#5;
|PINTA #0#6;
|PINTA #0#7;
|PINTA #0#8;
|FPRC;


|PROCESO zconcili;
    #3#0 = #0#0;
    #3#1 = #0#7;
    #3#2 = "";
    |GRABA 020#3n;
|FPRC;

|DEFBUCLE zconcili;
     #0#1;
   6;
   1,0;
9999,0;
;
NULL,zconcili;
|FIN;

|PROCESO coimp;
     |SI #0#6 = #3#1;
          #3#2= "*";
          |GRABA 020#3a;
          |LIBERA #3;
          #0#8 = "*";
          |GRABA 020#0a;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE coimp;
     #3#1;
 1,2;
   1,#0#6," ";
9999,#0#6," ";
;
NULL,coimp;
|FIN;

|PROCESO zconcil2;
    |BUCLE coimp;
|FPRC;

|DEFBUCLE zconcil2;
     #0#1;
   7;
   1,0;
9999,0;
be;
NULL,zconcil2;
|FIN;

|PROCESO zcoimp;
     #3#0 = #0#0;
     |LEE 041#3=;
     |SI FSalida = 0; |Y #3#2 = "*";
          #0#8 = "*";
          |GRABA 020#0a;
     |FINSI;
|FPRC;


|DEFBUCLE zcoimp;
     #0#1;
   6;
   1,0;
9999,0;
be;
NULL,zcoimp;
|FIN;


|PROCESO cociimp;
       |DELINDEX #3;
       |ABRE #3;
       |BUCLE zconcili;
       |CIERRA #3;
       |BUCLE zconcil2;
       |ABRE #3;
       |BUCLE zcoimp;
       |CIERRA #3;
       |DELINDEX #3;
|FPRC;
