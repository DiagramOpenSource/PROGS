|FICHEROS;
    cmvemp02 #1;
    canempre #30;

    caportad #2;
    cama3390 #3;
    camac347 #4;
    camal347 #5;
    camac349 #6;
    camal349 #7;
    caman130 #8;
    caman300 #9;
    caman303 #13;
    caman390 #10;
    camic347 #11;
    camil347 #12;
|FIN;

|VARIABLES;
  alfa1  = "";
  alfa2  = "";
  alfa3  = "";
  alfa4  = "";
  nume1  = 0;
  nume2  = 0;
  nume3  = 0;
  para1  = 0;
  para2  = 0;

  numero   = 0;
  periodo  = 0;
  estado   = 0;
  sw       = 0;
  dir_fich = "";
  dirfich0 = "";
|FIN;

****************************************************************************
      PROCESO PRINCIPAL
****************************************************************************

|PROCESO proceso1;

  |PARA periodo = 0; |SI periodo [ 9; |HACIENDO periodo = periodo + 1;
        #30#2 = #1#3;
        #30#3 = periodo;
        |LEE 001#30=;
        |SI FSalida = 0;
            alfa1 = #30#2;
            alfa2 = #30#3;
            alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
            alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
            dirfich0 = dir_fich + alfa1 + alfa2 + "/";
            |HAZ haztodo;
        |FINSI;
  |SIGUE;
  |BORRA 001#1a;
  |LIBERA #1;
|FPRC;

|DEFBUCLE leelineal;
 #1#2;
 4;
 00001, "*";
 99999, "*";
 be;
 NULL, proceso1;
|FIN;

|PROCESO proceso2;
 sw = 1;
|FPRC;

|DEFBUCLE comprueba;
 #1#1;
 ;
 0001;
 9999;
 be;
 NULL, proceso2;
|FIN;

|| *********************************************************************
||                              PROGRAMA
|| *********************************************************************

|PROGRAMA;
 |NOPARA;
 |D_CUADRO 2107, 2372;
 |ATRI I;
 |PINTA 2208, " CAMBIANDO MODELOS OFICIALES DE LA EMPRESA ->        Num:       ";
 |ATRI 0;

 |DFICB dir_fich;

 |ABRE #30;
 |BUCLE leelineal;   || mantenimiento de empresas
 |CIERRA #30;

 sw = 0;
 |BUCLE comprueba;
 |SI sw = 0;
     |DELINDEX #1;
 |FINSI;

 |SIPARA;
|FPRO;

|| ************************************************************************
|PROCESO haztodo;
  |PATH_DAT #2  dirfich0;
  |PATH_DAT #3  dirfich0;
  |PATH_DAT #4  dirfich0;
  |PATH_DAT #5  dirfich0;
  |PATH_DAT #6  dirfich0;
  |PATH_DAT #7  dirfich0;
  |PATH_DAT #8  dirfich0;
  |PATH_DAT #9  dirfich0;
  |PATH_DAT #10  dirfich0;
  |PATH_DAT #11  dirfich0;
  |PATH_DAT #12  dirfich0;

  numero = numero + 1;
  alfa1 = numero;  alfa1 = "      " + numero;  alfa1 = alfa1 % -105;
  |PINTA 2254,  #1#3;
  |PINTA 2266, alfa1;

  |HAZ caportad;
  |HAZ cama3390;
  |HAZ camac347;
  |HAZ camac349;
  |HAZ caman130;
  |HAZ caman300;
  |HAZ caman303;
  |HAZ caman390;
  |HAZ camic347;
|FPRC;

|| ************* MANTENIMIENTO PORTADAS OFICIALES **************************
|PROCESO caportad;
  |ABRE #2;
  #2#0 = #1#1;
  #2#1 = #30#26;
  |LEE 001#2=;
  |SI FSalida = 0;
      |SALVA_DATOS #2;
      #2#0 = #1#3;
      |LEE 101#2=;
      estado = FSalida;
      |REPON_DATOS #2;
      #2#0 = #1#3;
      |SI estado = 0; |GRABA 020#2a; |FINSI;
      |SI estado ! 0; |GRABA 020#2n; |FINSI;
      |LIBERA #2;
      #2#0 = #1#1;
      #2#1 = #30#26;
      |BORRA 020#2c;
  |FINSI;
  |CIERRA #2;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 390 NUEVO *********************
|PROCESO cama3390;
  |ABRE #3;
  #3#0 = #1#1;
  #3#1 = #30#26;
  |LEE 001#3=;
  |SI FSalida = 0;
      |SALVA_DATOS #3;
      #3#0 = #1#3;
      |LEE 101#3=;
      estado = FSalida;
      |REPON_DATOS #3;
      #3#0 = #1#3;
      |SI estado = 0; |GRABA 020#3a; |FINSI;
      |SI estado ! 0; |GRABA 020#3n; |FINSI;
      |LIBERA #3;
      #3#0 = #1#1;
      #3#1 = #30#26;
      |BORRA 020#3c;
  |FINSI;
  |CIERRA #3;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 347 ***************************
|PROCESO camac347;
  |ABRE #4;
  #4#0 = #1#1;
  |LEE 001#4=;
  |SI FSalida = 0;
      |SALVA_DATOS #4;
      #4#0 = #1#3;
      |LEE 101#4=;
      estado = FSalida;
      |REPON_DATOS #4;
      #4#0 = #1#3;
      |SI estado = 0; |GRABA 020#4a; |FINSI;
      |SI estado ! 0; |GRABA 020#4n; |FINSI;
      |LIBERA #4;
      #4#0 = #1#1;
      |BORRA 020#4c;
  |FINSI;
  |CIERRA #4;

  |ABRE #5;
  |PARA para1 = 1; |SI para1 [ 99999; |HACIENDO para1 = para1 + 1;
        #5#0 = #1#1;
        #5#1 = para1;
        |LEE 000#5];
        |SI FSalida ! 0;
            |SAL;
        |SINO;
            |SI #5#0 = #1#1;
                para1 = #5#1;
                |SALVA_DATOS #5;
                #5#0  = #1#3;
                |LEE 101#5=;
                estado = FSalida;
                |REPON_DATOS #5;
                #5#0 = #1#3;
                |SI estado = 0; |GRABA 020#5a; |FINSI;
                |SI estado ! 0; |GRABA 020#5n; |FINSI;
                |LIBERA #5;
                #5#0 = #1#1;
                |BORRA 020#5c;
             |SINO;
                |SAL;
             |FINSI;
        |FINSI;
  |SIGUE;
  |CIERRA #5;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 349 ***************************
|PROCESO camac349;

  |ABRE #6;
  |PARA para2 = 0; |SI para2 [ 4; |HACIENDO para2 = para2 + 1;
        #6#0 = #1#1;
        #6#1 = para2;
        #6#2 = #30#26;
        |LEE 000#6];
        |SI FSalida ! 0;
            |SAL;
        |SINO;
            |SI #6#0 = #1#1; |Y #6#2 = #30#26;
                para2 = #6#1;
                |SALVA_DATOS #6;
                #6#0 = #1#3;
                |LEE 101#6=;
                estado = FSalida;
                |REPON_DATOS #6;
                #6#0 = #1#3;
                |SI estado = 0; |GRABA 020#6a; |FINSI;
                |SI estado ! 0; |GRABA 020#6n; |FINSI;
                |LIBERA #6;
                #6#0 = #1#1;
                |BORRA 020#6c;

                |ABRE #7;
                |PARA para1 = 1; |SI para1 [ 999; |HACIENDO para1 = para1 + 1;
                      #7#0 = #1#1;
                      #7#1 = para2;
                      #7#2 = #30#26;
                      #7#3 = para1;
                      |LEE 000#7];
                      |SI FSalida ! 0;
                          |SAL;
                      |SINO;
                          |SI #7#0 = #1#1; |Y #7#1 = para2; |Y #7#2 = #30#26;
                              para1 = #7#3;
                              |SALVA_DATOS #7;
                              #7#0  = #1#3;
                              |LEE 101#7=;
                              estado = FSalida;
                              |REPON_DATOS #7;
                              #7#0 = #1#3;
                              |SI estado = 0; |GRABA 020#7a; |FINSI;
                              |SI estado ! 0; |GRABA 020#7n; |FINSI;
                              |LIBERA #7;
                              #7#0 = #1#1;
                              |BORRA 020#7c;
                          |SINO;
                              |SAL;
                          |FINSI;
                      |FINSI;
                |SIGUE;          || para1 (lineas)
                |CIERRA #7;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
  |SIGUE;                        || para2  (cabeceras)
  |CIERRA #6;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 130 ***************************
|PROCESO caman130;
  |ABRE #8;
  |PARA para2 = 1; |SI para2 [ 4; |HACIENDO para2 = para2 + 1;
        #8#0 = #1#1;
        #8#1 = 1;
        #8#2 = para2;
        #8#3 = #30#26;
        |LEE 000#8];
        |SI FSalida ! 0;
            |SAL;
        |SINO;
            |SI #8#0 = #1#1; |Y #8#3 = #30#26;
                para2 = #8#2;
                |SALVA_DATOS #8;
                #8#0 = #1#3;
                |LEE 101#8=;
                estado = FSalida;
                |REPON_DATOS #8;
                #8#0 = #1#3;
                |SI estado = 0; |GRABA 020#8a; |FINSI;
                |SI estado ! 0; |GRABA 020#8n; |FINSI;
                |LIBERA #8;
                #8#0 = #1#1;
                |BORRA 020#8c;
            |SINO;
                |SAL;
            |FINSI;
        |FINSI;
  |SIGUE;                        || para2
  |CIERRA #8;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 300 ***************************
|PROCESO grabaman300;
  #9#0 = #1#3;
  |GRABA 020#9a;
  |LIBERA #9;
|FPRC;

|DEFBUCLE leeman300;
 #9#1;
 ;
 " ", 00, 00;
 "z", 99, 99;
 be;
 NULL, grabaman300;
|FIN;

|PROCESO caman300;
 |BUCLE leeman300;
|FPRC;

|PROCESO grabaman303;
  #13#0 = #1#3;
  |GRABA 020#13a;
  |LIBERA #13;
|FPRC;

|DEFBUCLE leeman303;
 #13#1;
 ;
 " ", 00, 00;
 "z", 99, 99;
 be;
 NULL, grabaman303;
|FIN;

|PROCESO caman303;
 |BUCLE leeman303;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 390 ANTIGUO *******************
|PROCESO grabaman390;
  #10#120 = #1#3;
  |GRABA 020#10a;
  |LIBERA #10;
|FPRC;

|DEFBUCLE leeman390;
 #10#1;
 ;
 00;
 99;
 be;
 NULL, grabaman390;
|FIN;

|PROCESO caman390;
 |BUCLE leeman390;
|FPRC;

|| ************* MANTENIMIENTO MODELO OFICIAL 347 INMUEBLES *****************
|PROCESO camic347;
  |ABRE #11;
  #11#0 = #1#1;
  |LEE 001#11=;
  |SI FSalida = 0;
      |SALVA_DATOS #11;
      #11#0 = #1#3;
      |LEE 101#11=;
      estado = FSalida;
      |REPON_DATOS #11;
      #11#0 = #1#3;
      |SI estado = 0; |GRABA 020#11a; |FINSI;
      |SI estado ! 0; |GRABA 020#11n; |FINSI;
      |LIBERA #11;
      #11#0 = #1#1;
      |BORRA 020#11c;
  |FINSI;
  |CIERRA #11;

  |ABRE #12;
  |PARA para1 = 1; |SI para1 [ 99999; |HACIENDO para1 = para1 + 1;
        #12#0 = #1#1;
        #12#1 = para1;
        |LEE 000#12];
        |SI FSalida ! 0;
            |SAL;
        |SINO;
            |SI #12#0 = #1#1;
                para1 = #12#1;
                |SALVA_DATOS #12;
                #12#0  = #1#3;
                |LEE 101#12=;
                estado = FSalida;
                |REPON_DATOS #12;
                #12#0 = #1#3;
                |SI estado = 0; |GRABA 020#12a; |FINSI;
                |SI estado ! 0; |GRABA 020#12n; |FINSI;
                |LIBERA #12;
                #12#0 = #1#1;
                |BORRA 020#12c;
             |SINO;
                |SAL;
             |FINSI;
        |FINSI;
  |SIGUE;
  |CIERRA #12;
|FPRC;
