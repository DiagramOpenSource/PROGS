|FICHEROS;
  camaylin #0;
  camaycab #1;
  cafantas #2;
  caconcep #3;
  cacuenta #4;
|FIN;

|VARIABLES;
      &entrada = 1;
  saldo = 0;
  men2  = "     Longitud de Cuenta Fuera de Nivel !";
  cont = 0;
  long = "  ";
  cta  = 0;
  num   = 0;
  sw = 0;
  ctanum = 0;
  ctaalf = "";
  longnum = "";
  vacio = "            ";
  ini = 0;
  fecalf = "";
  mes = "";
  mesfec = 0;
  mesac = 0;
  a = 0;
  b = 0;
  c = 0;
  cuant = "";
  diant = 0;
  coant = 0;
  deant = "";
  dhant = "";
  imant = 0;
  trant = "";
  drant = 0;
  fiac = "  ";
  guarda = "  ";
  relleno = "                                       ";
  aponer = "  ";
  auto = 0;
  &dig1 = 0;
  &dig3 = 0;
  &dig4 = 0;
  &dig5 = 0;
  &dig6 = 0;
  &dig7 = 0;
  &dig8 = 0;
  &dig9 = 0;
  opera = "";
  nada = "";
  nada1 = 0;
  salidas = 0;
 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|INCLUYE puntos_i;

|PROCESO deha;
  |SI #0Campo = "0";  |O #0Campo = "d";
      #0Campo = "D";
  |FINSI;
  |SI #0Campo = "1";  |O #0Campo = "h";
      #0Campo = "H";
  |FINSI;
  |PINTA #0Campo;
|FPRC;

|PROCESO refresca; |TIPO 2;
  |SI #0#8 = "D";
      #1#4 = #1#4 +. #0#9;
  |SINO;
      #1#5 = #1#5 +. #0#9;
  |FINSI;
  #2#0 = #1#4 -#1#5;
  |PINTA #1#4;
  |PINTA #1#5;
  |PINTA 0967, #2#0;
  |ABRE #4;
  #4#0 = #0#4;
  #4#1 = #0#5;
  |LEE 101#4=;
  |CIERRA #4;
|FPRC;

|PROCESO nocero;
  |SI #0Campo = 0;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO concepto;
  |ABRE #3;
  #3#0 = #0#6;
  |LEE 040#3=;
  |SI FEntrada = 101;
      |SI #0#6 = coant; |Y #1#4 ! #1#5;
          #0#7 = deant;
      |SINO;
          #0#7 = #3#1;
      |FINSI;
  |SINO;
      |SI #0#6 = coant;
          #0#7 = deant;
      |SINO;
          #0#7 = #3#1;
      |FINSI;
  |FINSI;
  |PINTA #0#7;
  |CIERRA #3;
|FPRC;

|PROCESO cuefin;
  |ABRE #4;
  #4#0 = #0#4;
  #4#1 = #0#5;
  |LEE 040#4=;
  |SI FSalida ! 0;
      |CIERRA #4;
      |ERROR;
      |ACABA;
  |FINSI;
  |CIERRA #4;
  |PINTA 0739, #4#2;
|FPRC;

|PROCESO cuenta;|TIPO 6;
    p_alfa1 = #0Campo;
    salidas = FSalida;
|HAZ punto;
|SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  cta  = #0#4;
  nada = #0#4 % A101;
  |SI nada ! "0";
      long = cta % A0;
  |SINO;
      long = cta % A0;
       nada1 = long;
       nada1 = nada1 + 1;
       long = nada1;
  |FINSI;
  cont = 0;
  sw = 0;
  |SI long = dig4; sw = 1; #0#5 = 1; |FINSI;
  |SI long = dig5; sw = 1; #0#5 = 2; |FINSI;
  |SI long = dig6; sw = 1; #0#5 = 3; |FINSI;
  |SI long = dig7; sw = 1; #0#5 = 4; |FINSI;
  |SI long = dig8; sw = 1; #0#5 = 5; |FINSI;
  |SI long = dig9; sw = 1; #0#5 = 6; |FINSI;
  |SI sw = 0;
      |MENAV men2;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO contra;
  |SI FSalida = 9;
      auto = 1;
  |SINO;
      auto = 0;
  |FINSI;
  cta  = #0#10;
  long = cta % A0;
  cont = 0;
  sw = 0;
  |SI long = dig4; sw = 1; #0#11 = 1; |FINSI;
  |SI long = dig5; sw = 1; #0#11 = 2; |FINSI;
  |SI long = dig6; sw = 1; #0#11 = 3; |FINSI;
  |SI long = dig7; sw = 1; #0#11 = 4; |FINSI;
  |SI long = dig8; sw = 1; #0#11 = 5; |FINSI;
  |SI long = dig9; sw = 1; #0#11 = 6; |FINSI;
  |SI sw = 0;
      #0#11 = 9;
  |FINSI;
|ET fincontra;
  |ABRE #4;
  #4#0 = #0#10;
  #4#1 = #0#11;
  |LEE 040#4= ;
  |SI FSalida ! 0; |O #4#3 = "N";
      #0#11 = 9;
  |FINSI;
  |CIERRA #4;
|FPRC;


|PROCESO saalta;
  |SI FEntrada = 101; |Y #0#3 ! 1;
       #0#4 = cuant;
       #0#5 = diant;
       #0#6 = coant;
       #0#7 = deant;
       #0#8 = dhant;
       #0#9 = imant;
       #0#10 = trant;
       #0#11 = drant;
       |PINTA #0#4;
       |PINTA #0#6;
       |PINTA #0#7;
       |PINTA #0#8;
       |PINTA #0#9;
       |PINTA #0#10;
  |FINSI;
|FPRC;


|PROCESO guarda; |TIPO 3;
  cuant = #0#4;
  diant = #0#5;
  coant = #0#6;
  deant = #0#7;
  dhant = #0#8;
  imant = #0#9;
  trant = #0#10;
  drant = #0#11;
  |SI auto = 1; |Y #0#11 ! 9;
      |GRABA 040#0n;
      #0#3 = #0#3 + 1;
      #0#4 = trant;
      #0#5 = drant;
      #0#6 = coant;
      #0#7 = deant;
      saldo = #1#4 - #1#5;
      |SI dhant = "D";
          saldo = saldo + imant;
      |SINO;
          saldo = saldo - imant;
      |FINSI;
      |SI saldo = 0;
          |VETE nograbo;
      |FINSI;
      |SI saldo < 0;
          #0#8 = "D";
          #0#9 = - saldo;
      |SINO;
          #0#8 = "H";
          #0#9 = saldo;
      |FINSI;
      #0#10 = cuant;
      #0#11 = diant;
      |GRABA 021#0n;
      |HAZ refresca;
   |ET nograbo;
      #0#4 = cuant;
      #0#5 = diant;
      #0#6 = coant;
      #0#7 = deant;
      #0#8 = dhant;
      #0#9 = imant;
      #0#10 = trant;
      #0#11 = drant;
      aponer = Akksi;
      |HAZ poncontr;
      Pos = -1;
  |FINSI;
|FPRC;

|PROCESO poncontr;
   fiac = Control % A109;
   fiac = fiac + relleno;
   guarda = fiac % A109;
   fiac = Control % A1001;
   Control = Control + fiac;
   Control = Control + relleno;
   Control = Control % A120;
   Control = Control + aponer;
|FPRC;


|PROCESO descripc;
  |SI FSalida = 9;
      #0#7 = deant;
      |PINTA #0#7;
  |FINSI;
|FPRC;
