|FICHEROS;
    cacamctm #0;    || pantalla

    casieali #21;   || asientos predefinidos lins.
    camanban #24;   || bancos
    camaasic #25;   || apuntes cabs.
    camaasil #26;   || apuntes lins.
    caiivsol #28;   || intr. fras. soportado
    caivasop #29;   || iva soportado
    caivarep #31;   || iva repercutido
    cacuivli #32;   || ctas. iva lins.
    cacoivli #33;   || ctas. contrapartidas iva lins.
    camancob #34;   || cobros
    camanpag #35;   || pagos
    caremesc #36;   || remesas cabs.
    capagcab #37;   || pagares cabs.
    caconcic #38;   || diferencias cabs.
    cacuepre #39;   || cuentas presupuestarias
    camoauxc #40;   || cuentas inventario
    camoauxl #52;   || cuentas inventario
    camocabe #41;   || amortizaciones cabs.
    camogrup #42;   || grupos amortiz.
    caexistc #43;   || descarga existencias cabs.
    caexistl #44;   || descarga existencias lins.
    caconcil #45;   || diferencias lineas.
    camaylin #46;   || lineas mayor
    caiivrel #47;   || intr. fras. repercutido
    cacup300 #49;   || control pase contable 300.
    capasven #51;   || asiento ventas automaticas.

    cacup130 #61;   || control pase contable 130.
    cacup202 #62;   || control pase contable 202.
    cacupimp #63;   || control pase contable Impuesto.
    caivaasi #64;   || Ctrl Entrada IVA asientos.
    cagruiva #65;   || Grupos facturas Englobadas.
    cavengca #66;   || Ventas Englobadas Cabecera.

    calicont #67;   || Contrapartidas Apuntes
    caliconb #68;   || Contrapartidas Bloques

||    cacuenta #69;   || plan contable                 ---> puntos_i
||    caclipro #71;   || Clientes Proveedores GENERAL

    camautol #72;   || Asientos Automaticos
|FIN;

|VARIABLES;
    alfa1    = "";
    alfa2    = "";
    alfa3    = "";
    nume1    = 0;
    nume2    = 0;
    nume3    = 0;
    nume4    = 0;
    para1    = 0;
    para2    = 0;
    para3    = 0;
    para4    = 0;

    mens     = "";
    longi    = 0;
    niveles  = 0;
    cuenta   = "";
    fini     = @;
    ffin     = @;
    traba    = "";
    x        = 0;
    doce     = "            ";
    mascara  = "";
    sw_ya    = 0;
    sw_baja  = 0;
    clipro   = 0;
    {53}cant = 0;
    cta      = 0;
    long     = "";
    sw       = 0;
    uno      = "";
    dos      = "";
    mensa2   = "     No esta definida esta cuenta en Cuentas de Balance";
    &pathbal = "";
    &balance = 1;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;
____________________________________/ CALCULOS DE PANTALLA

|PROCESO cuenta; |TIPO 6;
  |SI FSalida = 2; |ACABA; |FINSI;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;    |ERROR; |ACABA; |FINSI;
  |SI #0Campo = doce; |ERROR; |ACABA; |FINSI;

   x = Campo + 1;
   cta  = #0Campo;
   long = cta % 0;
   sw = 0;
   |SI long = #30#14; sw = 1; #0x = 1; |FINSI;
   |SI long = #30#15; sw = 1; #0x = 2; |FINSI;
   |SI long = #30#16; sw = 1; #0x = 3; |FINSI;
   |SI long = #30#17; sw = 1; #0x = 4; |FINSI;
   |SI long = #30#18; sw = 1; #0x = 5; |FINSI;
   |SI long = #30#19; sw = 1; #0x = 6; |FINSI;
   |SI sw = 0;
       |MENAV "    Longitud de Cuenta fuera de Nivel ...";
       |ERROR;
       |ACABA;
   |FINSI;

  |ABRE #69;
  #69#0 = #0Campo;
  #69#1 = #0x;
  |LEE 001#69=;
  |SI Campo = 0;
      |SI FSalida ! 0;
          |MENAV "    No existe la Cuenta ...";
          |ERROR;
      |FINSI;
  |SINO;
      sw_ya = 0;
      |SI FSalida = 0;
          |CONFI "0000NLa cuenta Ya existe. ¨Aceptarla S/N? ";
          |SI FSalida ! 0;
              |ERROR;
          |FINSI;
          sw_ya = 1;
      |FINSI;
  |FINSI;
  |CIERRA #69;
|FPRC;

|PROCESO cuefin; |TIPO 0;
  x = Campo + 2;
  |SI Campo = 3; |Y sw_ya = 0; |ACABA; |FINSI;
  |SI #69#3 = "N";|Y FSalida = 0;
      |MENAV "    Cuenta sin Pase Directo ...";
      |CIERRA #69;
      |ERROR;
      |ACABA;
  |FINSI;
  #0x = #69#2;
  |PINTA #0x;
|FPRC;

|PROCESO desant; |TIPO 7;
 |SI sw_ya = 0;
     #0#5 = #0#2;
     |PINTA #0#5;
 |FINSI;
|FPRC;
____________________________________/ CAMBIO DE CUENTAS

|PROCESO lee_clipro; || leer los datos del nuevo cliente o proveedor.
 |ABRE #71;
  clipro = 0;
  #71#10 = #0#3;
  #71#11 = #0#4;
  traba = #71#10 % 102;
  |SI traba = "43"; |O traba = "44";
      #71#23 = "C";
  |SINO;
      #71#23 = "P";
  |FINSI;
  |LEE 000#71=;
  |SI FSalida ! 0;  |DDEFECTO #71; clipro = 1; |FINSI;
 |CIERRA #71;
|FPRC;

____________________________________/ camautol
|PROCESO camautol1;
 |SI #0#0 = #72#2; |Y #0#1 = #72#3;
     mens = " Asientos Automaticos.> " + #72#0 + "-" + #72#1; #0#7 = mens; |PINTA #0#7;
     #72#2 = #0#3;
     #72#3 = #0#4;
     |GRABA 020#72a;
 |FINSI;
 |LIBERA #72;
|FPRC;

|DEFBUCLE camautol;
 #72#1;
 ;
     0,    0;
 99999, 9999;
 be;
 NULL, camautol1;
|FIN;

____________________________________/ caliconb
|PROCESO caliconb1;
 |SI #0#0 = #68#2; |Y #0#1 = #68#3;
     mens = " Contrapartidas> " + #68#0 + "-" + #68#1; #0#7 = mens; |PINTA #0#7;
     #68#2 = #0#3;
     #68#3 = #0#4;
     |GRABA 020#68a;
 |FINSI;
 |LIBERA #68;
|FPRC;

|DEFBUCLE caliconb;
 #68#1;
 ;
 "        ",     0;
 "zzzzzzzz", 99999;
 be;
 NULL, caliconb1;
|FIN;
____________________________________/ calicont
|PROCESO calicont1;
 |SI #0#0 = #67#4; |Y #0#1 = #67#5;
     mens = " Contrapartidas> " + #67#0 + "-" + #67#1 + "-" + #67#2; #0#7 = mens; |PINTA #0#7;
     #67#4 = #0#3;
     #67#5 = #0#4;
     |GRABA 020#67a;
 |FINSI;
 |LIBERA #67;
|FPRC;

|DEFBUCLE calicont;
 #67#1;
 ;
  0, fini,      0,    0;
 99, ffin, 999999, 9999;
 be;
 NULL, calicont1;
|FIN;
____________________________________/ camaylin
|PROCESO camaylin1;
 |SI #0#0 = #46#4; |Y #0#1 = #46#5;
     mens = " Diario Mayor> " + #46#0 + "-" + #46#1; #0#7 = mens; |PINTA #0#7;
     #46#4 = #0#3;
     #46#5 = #0#4;
     |GRABA 020#46a;
 |FINSI;
 |SI #0#0 = #46#10; |Y #0#1 = #46#11;
     mens = " Diario Mayor> " + #46#0 + "-" + #46#1; #0#7 = mens; |PINTA #0#7;
     #46#10 = #0#3;
     #46#11 = #0#4;
     |GRABA 020#46a;
 |FINSI;
 |LIBERA #46;
|FPRC;

|DEFBUCLE camaylin;
 #46#1;
 ;
  0, fini,      0,    0;
 99, ffin, 999999, 9999;
 be;
 NULL, camaylin1;
|FIN;
____________________________________/ caexistl
|PROCESO caexistl1;
 |SI #0#0 = #44#2; |Y #0#1 = #44#3;
     mens = " Descarga Existencias> " + #44#0 + "-" + #44#1; #0#7 = mens; |PINTA #0#7;
     #44#2 = #0#3;
     #44#3 = #0#4;
     |GRABA 020#44a;
 |FINSI;
 |SI #0#0 = #44#5; |Y #0#1 = #44#6;
     mens = " Descarga Existencias> " + #44#0 + "-" + #44#1; #0#7 = mens; |PINTA #0#7;
     #44#5 = #0#3;
     #44#6 = #0#4;
     |GRABA 020#44a;
 |FINSI;
 |SI #0#0 = #44#8; |Y #0#1 = #44#9;
     mens = " Descarga Existencias> " + #44#0 + "-" + #44#1; #0#7 = mens; |PINTA #0#7;
     #44#8 = #0#3;
     #44#9 = #0#4;
     |GRABA 020#44a;
 |FINSI;
 |LIBERA #44;
|FPRC;

|DEFBUCLE caexistl;
 #44#1;
 ;
  0,  0;
 99, 99;
 be;
 NULL, caexistl1;
|FIN;
____________________________________/ caexistc
|PROCESO caexistc1;
 |SI #0#0 = #43#2; |Y #0#1 = #43#3;
     mens = " Descarga Existencias> " + #43#0; #0#7 = mens; |PINTA #0#7;
     #43#2 = #0#3;
     #43#3 = #0#4;
     |GRABA 020#43a;
 |FINSI;
 |LIBERA #43;
|FPRC;

|DEFBUCLE caexistc;
 #43#1;
 ;
  0;
 99;
 be;
 NULL, caexistc1;
|FIN;
____________________________________/ caivaasi
|PROCESO caivaasi;
|ABRE #64;
  #64#0 = 1;
  |LEE 000#64=;
  |SI FSalida ! 0;
      |CIERRA #64;
      |ACABA;
  |FINSI;
        |SI #0#0 = #64#39; |Y #0#1 = #64#40;
        mens = " Control Entrada Apuntes IVA> "; #0#7 = mens; |PINTA #0#7;
            #64#39 = #0#3;
            #64#40 = #0#4;
        |FINSI;

  |GRABA 020#64a;
  |LIBERA #64;
 |CIERRA #64;
|FPRC;
____________________________________/ cavengca
|PROCESO cavengca1;

  |SI #0#0 = #66#4; |Y #0#1 = #66#5;
       mens = " Ventas Englobadas > " + #66#0;   #0#7 = mens;   |PINTA #0#7;
       #66#4 = #0#3;
       #66#5 = #0#4;
      |GRABA 020#66a;
  |FINSI;

  |LIBERA #66;
|FPRC;

|DEFBUCLE cavengca;
 #66#1;
 ;
 fini;
 ffin;
 be;
 NULL, cavengca1;
|FIN;
____________________________________/ cagruiva
|PROCESO cagruiva1;
  |PARA para4 = 2; |SI para4 [ 16; |HACIENDO para4 = para4 + 1;
        para3 = para4 + 15;
        |SI #0#0 = #65para4; |Y #0#1 = #65para3;
            mens = " Grupos Facturas Englobadas IVA> " + #65#0; #0#7 = mens; |PINTA #0#7;
            #65para4 = #0#3;
            #65para3 = #0#4;
        |FINSI;
  |SIGUE;
        |SI #0#0 = #65#72; |Y #0#1 = #65#73;
            mens = " Grupos Facturas Englobadas IVA> " + #65#0; #0#7 = mens; |PINTA #0#7;
            #65#72 = #0#3;
            #65#73 = #0#4;
        |FINSI;
    |GRABA 020#65a;
|LIBERA #65;
|FPRC;

|DEFBUCLE cagruiva;
 #65#1;
 ;
 00;
 99;
 be;
 NULL, cagruiva1;
|FIN;
____________________________________/ cacup300
|PROCESO cacup300;
|ABRE #49;
  #49#0 = 1;
  |LEE 000#49=;
  |SI FSalida ! 0;
      |CIERRA #49;
      |ACABA;
  |FINSI;

  |PARA para4 = 1; |SI para4 [ 11; |HACIENDO para4 = para4 + 1;
        para3 = para4 + 11;
        |SI #0#0 = #49para4; |Y #0#1 = #49para3;
        mens = " Control Pase Modelo 300> " + para4; #0#7 = mens; |PINTA #0#7;
            #49para4 = #0#3;
            #49para3 = #0#4;
        |FINSI;
  |SIGUE;
  |GRABA 020#49a;
  |LIBERA #49;
 |CIERRA #49;
|FPRC;
____________________________________/ cacup130
|PROCESO cacup130;
|ABRE #61;
  #61#0 = 1;
  |LEE 000#61=;
  |SI FSalida ! 0;
      |CIERRA #61;
      |ACABA;
  |FINSI;

  |PARA para4 = 1; |SI para4 [ 11; |HACIENDO para4 = para4 + 1;
        para3 = para4 + 11;
        |SI #0#0 = #61para4; |Y #0#1 = #61para3;
        mens = " Control Pase Modelo 130> " + para4; #0#7 = mens; |PINTA #0#7;
            #61para4 = #0#3;
            #61para3 = #0#4;
        |FINSI;
  |SIGUE;
  |GRABA 020#61a;
  |LIBERA #61;
 |CIERRA #61;
|FPRC;
____________________________________/ cacup202
|PROCESO cacup202;
|ABRE #62;
  #62#0 = 1;
  |LEE 000#62=;
  |SI FSalida ! 0;
      |CIERRA #62;
      |ACABA;
  |FINSI;

  |PARA para4 = 1; |SI para4 [ 11; |HACIENDO para4 = para4 + 1;
        para3 = para4 + 11;
        |SI #0#0 = #62para4; |Y #0#1 = #62para3;
        mens = " Control Pase Modelo 202 > " + para4; #0#7 = mens; |PINTA #0#7;
            #62para4 = #0#3;
            #62para3 = #0#4;
        |FINSI;
  |SIGUE;
  |GRABA 020#62a;
  |LIBERA #62;
 |CIERRA #62;
|FPRC;
____________________________________/ cacupimp
|PROCESO cacupimp;
|ABRE #63;
  #63#0 = 1;
  |LEE 000#63=;
  |SI FSalida ! 0;
      |CIERRA #63;
      |ACABA;
  |FINSI;

  |PARA para4 = 1; |SI para4 [ 11; |HACIENDO para4 = para4 + 1;
        para3 = para4 + 11;
        |SI #0#0 = #63para4; |Y #0#1 = #63para3;
        mens = " Control Pase Modelo 202 > " + para4; #0#7 = mens; |PINTA #0#7;
            #63para4 = #0#3;
            #63para3 = #0#4;
        |FINSI;
  |SIGUE;
        |SI #0#0 = #63#58; |Y #0#1 = #63#59;
        mens = " Control Pase Modelo 202 > 59"; #0#7 = mens; |PINTA #0#7;
            #63#58 = #0#3;
            #63#59 = #0#4;
        |FINSI;

  |GRABA 020#63a;
  |LIBERA #63;
 |CIERRA #63;
|FPRC;
____________________________________/ camogrup
|PROCESO camogrup1;
 |SI #0#0 = #42#1; |Y #0#1 = #42#2;
     mens = " Grupos Amortizacion> " + #42#0; #0#7 = mens; |PINTA #0#7;
     #42#1 = #0#3;
     #42#2 = #0#4;
     |GRABA 020#42a;
 |FINSI;

 |SI #0#0 = #42#3; |Y #0#1 = #42#4;
     mens = " Grupos Amortizacion> " + #42#0; #0#7 = mens; |PINTA #0#7;
     #42#3 = #0#3;
     #42#4 = #0#4;
     |GRABA 020#42a;
 |FINSI;
 |LIBERA #42;
|FPRC;

|DEFBUCLE camogrup;
 #42#1;
 ;
    0;
 9999;
 be;
 NULL, camogrup1;
|FIN;
____________________________________/ camocabe
|PROCESO camocabe1;
 |SI #0#0 = #41#2; |Y #0#1 = #41#3;
     mens = " Elementos Amortizacion> " + #41#0; #0#7 = mens; |PINTA #0#7;
     #41#2 = #0#3;
     #41#3 = #0#4;
     |GRABA 020#41a;
 |FINSI;
 |LIBERA #41;
|FPRC;

|DEFBUCLE camocabe;
 #41#1;
 ;
 "        ",00;
 "zzzzzzzz",99;
 be;
 NULL, camocabe1;
|FIN;
____________________________________/ camoauxl
|PROCESO camoauxl;
 |ABRE #52;
 |PARA para3 = 1; |SI para3 [ 999; |HACIENDO para3 = para3 + 1;
       #52#0 = #0#0;
       #52#1 = #0#1;
       #52#2 = para3;
       |LEE 000#52];
       |SI FSalida ! 0;
           |SAL;
       |SINO;
           |SI #52#0 = #0#0; |Y #52#1 = #0#1;
               sw_ya = 0;
               #52#0 = #0#3;
               #52#1 = #0#4;
               para3 = #52#2;
               |LEE 000#52=;
               |SI FSalida = 0; sw_ya = 1; |FINSI;
               #52#0 = #0#0;
               #52#1 = #0#1;
               #52#2 = para3;
               |LEE 000#52=;
               |SI FSalida = 0;
                   |SI sw_baja = 0; |BORRA 020#52a; |FINSI;
                   mens = " Ctas. Inventario> " + #52#0 + "-" + #52#2; #0#7 = mens; |PINTA #0#7;
                   |SI sw_ya = 0;
                       #52#0 = #0#3;
                       #52#1 = #0#4;
                       #52#2 = para3;
                       |GRABA 020#52n;
                   |FINSI;
               |FINSI;
           |SINO;
               |SAL;
           |FINSI;
       |FINSI;
 |SIGUE;
 |CIERRA #52;
|FPRC;
____________________________________/ camoauxc
|PROCESO camoauxc;
 |ABRE #40;
 #40#0 = #0#3;
 #40#1 = #0#4;
 |LEE 000#40=;
 sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;

 #40#0 = #0#0;
 #40#1 = #0#1;
 |LEE 000#40=;
 |SI FSalida = 0;
      mens = " Ctas.Inventario> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
      |SI sw_baja = 0; |BORRA 020#40a; |FINSI;
      |SI sw_ya = 0;
          #40#0 = #0#3;
          #40#1 = #0#4;
          |GRABA 020#40n;
      |FINSI;
 |FINSI;
 |CIERRA #40;
|FPRC;
____________________________________/ cacuepre
|PROCESO cacuepre;
 |ABRE #39;
    #39#0 = #0#3;
    #39#1 = #0#4;
    |LEE 000#39=;
    sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
    #39#0 = #0#0;
    #39#1 = #0#1;
    |LEE 000#39=;
    |SI FSalida = 0;
         |SI sw_baja = 0; |BORRA 020#39a; |FINSI;
         mens = " Ctas.Presup.> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
         |SI sw_ya = 0;
             #39#0 = #0#3;
             #39#1 = #0#4;
             |GRABA 000#39n;
         |FINSI;
    |FINSI;
 |CIERRA #39;
|FPRC;
____________________________________/ caconcic
|PROCESO caconcic;
 |ABRE #38;
 #38#0 = #0#3;
 #38#1 = #0#4;
 |LEE 000#38=;
 sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
     #38#0 = #0#0;
     #38#1 = #0#1;
     |LEE 000#38=;
     |SI FSalida = 0;
         |SI sw_baja = 0; |BORRA 020#38a; |FINSI;
         mens = " Diferencias> " + #0#0;   #0#7 = mens;   |PINTA #0#7;
         |SI sw_ya = 0;
             #38#0 = #0#3;
             #38#1 = #0#4;
             |GRABA 020#38n;
         |FINSI;
     |FINSI;
 |CIERRA #38;
|FPRC;
____________________________________/ caconcil
|PROCESO caconcil;
 |ABRE #45;
 |PARA para3 = 1; |SI para3 [ 999; |HACIENDO para3 = para3 + 1;
       #45#0 = #0#0;
       #45#1 = #0#1;
       #45#2 = para3;
       |LEE 000#45];
       |SI FSalida ! 0;
           |SAL;
       |SINO;
           |SI #45#0 = #0#0; |Y #45#1 = #0#1;
               #45#0 = #0#3;
               #45#1 = #0#4;
               para3 = #45#2;
               |LEE 000#45=;
               sw_ya = 0; |SI FSalida = 0; sw_ya = 1; |FINSI;
               #45#0 = #0#0;
               #45#1 = #0#1;
               #45#2 = para3;
               |LEE 000#45=;
               |SI FSalida = 0;
                   mens = " Diferencias Lineas> " + #45#0 + "-"+#45#2; #0#7 = mens;   |PINTA #0#7;
                   |SI sw_baja = 0; |BORRA 020#45a; |FINSI;
                   |SI sw_ya = 0;
                       #45#0 = #0#3;
                       #45#1 = #0#4;
                       #45#2 = para3;
                       |GRABA 020#45n;
                   |FINSI;
               |FINSI;
           |SINO;
               |SAL;
           |FINSI;
       |FINSI;
 |SIGUE;
 |CIERRA #45;
|FPRC;
____________________________________/ capagcab
|PROCESO capagcab1;
 |SI #0#0 = #37#1; |Y #0#1 = #37#2;
     mens = " Pagares> " + #37#0;   #0#7 = mens;   |PINTA #0#7;
     #37#1 = #0#3;
     #37#2 = #0#4;
    |GRABA 020#37a;
 |FINSI;
 |SI #0#0 = #37#3; |Y #0#1 = #37#4;
     mens = " Pagares> " + #37#0;   #0#7 = mens;   |PINTA #0#7;
     #37#3 = #0#3;
     #37#4 = #0#4;
    |GRABA 020#37a;
 |FINSI;
 |LIBERA #37;
|FPRC;

|DEFBUCLE capagcab;
 #37#1;
 ;
      0;
 999999;
 be;
 NULL, capagcab1;
|FIN;
____________________________________/ caremesc
|PROCESO caremesc1;
 |SI #0#0 = #36#14; |Y #0#1 = #36#15;
     mens = " Remesas> " + #36#0;   #0#7 = mens;   |PINTA #0#7;
     #36#14 = #0#3;
     #36#15 = #0#4;
     |GRABA 020#36a;
 |FINSI;
 |LIBERA #36;
|FPRC;

|DEFBUCLE caremesc;
 #36#1;
 ;
     0;
 99999;
 be;
 NULL, caremesc1;
|FIN;
____________________________________/ camanpag
|PROCESO camanpag1;
 |SI #0#0 = #35#4; |Y #0#1 = #35#5;
     mens = " Pagos> " + #35#0 + "-" + #35#1;   #0#7 = mens;   |PINTA #0#7;
     #35#4 = #0#3;
     #35#5 = #0#4;
     |GRABA 020#35a;
 |FINSI;
 |LIBERA #35;
|FPRC;

|DEFBUCLE camanpag;
 #35#1;
 ;
  0, "  ",      0,   0;
 99, "zz", 999999, 999;
 be;
 NULL, camanpag1;
|FIN;
____________________________________/ camancob
|PROCESO camancob1;
  |SI #0#0 = #34#4; |Y #0#1 = #34#5;
      mens = " Cobros> " + #34#0 + "-" + #34#1;   #0#7 = mens;   |PINTA #0#7;
      #34#4 = #0#3;
      #34#5 = #0#4;
      |GRABA 020#34a;
  |FINSI;
  |LIBERA #34;
|FPRC;

|DEFBUCLE camancob;
 #34#1;
 ;
  0, "  ",      0,   0;
 99, "zz", 999999, 999;
 be;
 NULL, camancob1;
|FIN;
____________________________________/ cacoivli
|PROCESO cacoivli1;
 |SI #0#0 = #33#2; |Y #0#1 = #33#3;
     mens = " Contrapartidas.IVA Lins.> " + #33#0 + "-" + #33#1;   #0#7 = mens;   |PINTA #0#7;
     #33#2 = #0#3;
     #33#3 = #0#4;
     |GRABA 020#33a;
 |FINSI;

 |SI #0#0 = #33#11; |Y #0#1 = #33#12;
     mens = " Contrapartidas.IVA Lins.> " + #33#0 + "-" + #33#1;   #0#7 = mens;   |PINTA #0#7;
     #33#11 = #0#3;
     #33#12 = #0#4;
     |GRABA 020#33a;
 |FINSI;
 |LIBERA #33;
|FPRC;

|DEFBUCLE cacoivli;
 #33#1;
 ;
 " ",  0;
 "z", 99;
 be;
 NULL, cacoivli1;
|FIN;
____________________________________/ cacuivli
|PROCESO cacuivli1;
 |SI #0#0 = #32#3; |Y #0#1 = #32#4;
     mens = " Ctas.IVA Lins.> " + #32#0 + "-" + #32#1;   #0#7 = mens;   |PINTA #0#7;
     #32#3 = #0#3;
     #32#4 = #0#4;
     |GRABA 020#32a;
 |FINSI;
 |SI #0#0 = #32#6; |Y #0#1 = #32#7;
     mens = " Ctas.IVA Lins.> " + #32#0 + "-" + #32#1;   #0#7 = mens;   |PINTA #0#7;
     #32#6 = #0#3;
     #32#7 = #0#4;
     |GRABA 020#32a;
 |FINSI;
 |LIBERA #32;
|FPRC;

|DEFBUCLE cacuivli;
 #32#1;
 ;
 " ",  0;
 "z", 99;
 be;
 NULL, cacuivli1;
|FIN;
____________________________________/ capasven
|PROCESO capasven1;
 |SI #0#0 = #51#9; |Y #0#1 = #51#12;
     mens = " Control Pase Ventas Automaticas > " + #51#0; #0#7 = mens; |PINTA #0#7;
     #51#9  = #0#3;
     #51#12 = #0#4;
     |GRABA 020#51a;
 |FINSI;
 |SI #0#0 = #51#10; |Y #0#1 = #51#13;
     mens = " Control Pase Ventas Automaticas > " + #51#0; #0#7 = mens; |PINTA #0#7;
     #51#10 = #0#3;
     #51#13 = #0#4;
     |GRABA 020#51a;
 |FINSI;
 |SI #0#0 = #51#11; |Y #0#1 = #51#14;
     mens = " Control Pase Ventas Automaticas > " + #51#0; #0#7 = mens; |PINTA #0#7;
     #51#11 = #0#3;
     #51#14 = #0#4;
     |GRABA 020#51a;
 |FINSI;
 |LIBERA #51;
|FPRC;

|DEFBUCLE capasven;
 #51#1;
 ;
 00;
 99;
 be;
 NULL, capasven1;
|FIN;
____________________________________/ caivarep
|PROCESO caivarep1;
 |SI #0#0 = #31#4; |Y #0#1 = #31#5;
     mens = " Iva Repercutido> " + #31#0 + "-" + #31#2;   #0#7 = mens; |PINTA #0#7;
     #31#4 = #0#3;
     #31#5 = #0#4;
     #31#50= #0#5;
     |HAZ lee_clipro;
     |SI clipro = 0; #31#51 = #71#9; |FINSI;
     |GRABA 020#31a;
 |FINSI;
 |LIBERA #31;
|FPRC;

|DEFBUCLE caivarep;
 #31#1;
 ;
  0, "  ",      0;
 99, "zz", 999999;
 be;
 NULL, caivarep1;
|FIN;
____________________________________/ caiivrel
|PROCESO caiivrel1;
 |SI #0#0 = #47#5; |Y #0#1 = #47#6;
     mens = " Intr. Fras. Reperc.> " + #47#0 + "-" + #47#1; #0#7 = mens; |PINTA #0#7;
     #47#5 = #0#3;
     #47#6 = #0#4;
     #47#27 = #0#5;
     |HAZ lee_clipro;
     |SI clipro = 0; #47#30 = #71#9; |FINSI;
     |GRABA 020#47a;
 |FINSI;
 |SI #0#0 = #47#17; |Y #0#1 = #47#18;
     mens = " Intr. Fras. Reperc.> " + #47#0 + "-" + #47#1; #0#7 = mens; |PINTA #0#7;
     #47#17 = #0#3;
     #47#18 = #0#4;
     #47#28 = #0#5;
    |GRABA 020#47a;
 |FINSI;
 |SI #0#0 = #47#20; |Y #0#1 = #47#21;
     mens = " Intr. Fras. Reperc.> " + #47#0 + "-" + #47#1; #0#7 = mens; |PINTA #0#7;
     #47#20 = #0#3;
     #47#21 = #0#4;
     |GRABA 020#47a;
 |FINSI;
 |SI #0#0 = #47#22; |Y #0#1 = #47#23;
     mens = " Intr. Fras. Reperc.> " + #47#0 + "-" + #47#1; #0#7 = mens; |PINTA #0#7;
     #47#22 = #0#3;
     #47#23 = #0#4;
     |GRABA 020#47a;
 |FINSI;
 |SI #0#0 = #47#24; |Y #0#1 = #47#25;
     mens = " Intr. Fras. Reperc.> " + #47#0 + "-" + #47#1; #0#7 = mens; |PINTA #0#7;
     #47#24 = #0#3;
     #47#25 = #0#4;
     |GRABA 020#47a;
 |FINSI;
 |LIBERA #47;
|FPRC;

|DEFBUCLE caiivrel;
 #47#1;
 ;
  0,   0;
 99, 999;
 be;
 NULL, caiivrel1;
|FIN;
____________________________________/ caivasop
|PROCESO caivasop1;
 |SI #0#0 = #29#4; |Y #0#1 = #29#5;
     mens = " Iva Soportado> " + #29#0 + "-" + #29#2; #0#7 = mens; |PINTA #0#7;
     #29#4 = #0#3;
     #29#5 = #0#4;
     #29#50= #0#5;
     |HAZ lee_clipro;
     |SI clipro = 0; #29#51 = #71#9; |FINSI;
     |GRABA 020#29a;
 |FINSI;
 |LIBERA #29;
|FPRC;

|DEFBUCLE caivasop;
 #29#1;
 ;
  0, "  ",      0;
 99, "zz", 999999;
 be;
 NULL, caivasop1;
|FIN;
____________________________________/ caiivsol
|PROCESO caiivsol1;
 |SI #0#0 = #28#5; |Y #0#1 = #28#6;
     mens = " Intr. Fras. Soport.> " + #28#0 + "-" + #28#1; #0#7 = mens; |PINTA #0#7;
     #28#5 = #0#3;
     #28#6 = #0#4;
     #28#26 = #0#5;
     |HAZ lee_clipro;
     |SI clipro = 0; #28#29 = #71#9; |FINSI;
     |GRABA 020#28a;
 |FINSI;
 |SI #0#0 = #28#17; |Y #0#1 = #28#18;
     mens = " Intr. Fras. Soport.> " + #28#0 + "-" + #28#1; #0#7 = mens; |PINTA #0#7;
     #28#17 = #0#3;
     #28#18 = #0#4;
     #28#27 = #0#5;
    |GRABA 020#28a;
 |FINSI;
 |SI #0#0 = #28#20; |Y #0#1 = #28#21;
     mens = " Intr. Fras. Soport.> " + #28#0 + "-" + #28#1; #0#7 = mens; |PINTA #0#7;
     #28#20 = #0#3;
     #28#21 = #0#4;
     |GRABA 020#28a;
 |FINSI;
 |SI #0#0 = #28#22; |Y #0#1 = #28#23;
     mens = " Intr. Fras. Soport.> " + #28#0 + "-" + #28#1; #0#7 = mens; |PINTA #0#7;
     #28#22 = #0#3;
     #28#23 = #0#4;
     |GRABA 020#28a;
 |FINSI;
 |SI #0#0 = #28#24; |Y #0#1 = #28#25;
     mens = " Intr. Fras. Soport.> " + #28#0 + "-" + #28#1; #0#7 = mens; |PINTA #0#7;
     #28#24 = #0#3;
     #28#25 = #0#4;
     |GRABA 020#28a;
 |FINSI;
 |LIBERA #28;
|FPRC;

|DEFBUCLE caiivsol;
 #28#1;
 ;
  0,   0;
 99, 999;
 be;
 NULL, caiivsol1;
|FIN;
____________________________________/ camaasil
|PROCESO camaasil1;
 |SI #0#0 = #26#4; |Y #0#1 = #26#5;
     mens = " Apuntes Lins.> " + #26#0 + "-" + #26#1 + "-" + #26#2 + "-" + #26#3; #0#7 = mens; |PINTA #0#7;
     #26#4 = #0#3;
     #26#5 = #0#4;
     |SI #26#8 = "H";
         #26#10 = #0#3;
         #26#11 = #0#4;
     |SINO;
         #26#16 = #0#3;
         #26#17 = #0#4;
     |FINSI;
     |GRABA 020#26a;
 |FINSI;
 |LIBERA #26;
|FPRC;

|DEFBUCLE camaasil;
 #26#1;
 ;
  0, fini,      0,    0;
 99, ffin, 999999, 9999;
 be;
 NULL, camaasil1;
|FIN;
____________________________________/ camaasic - contrapartida
|PROCESO camaasic1;
 |SI #0#0 = #25#8; |Y #0#1 = #25#9;
     mens = " Apuntes Cabs.> " + #25#0 + "-" + #25#1 + "_" + #25#3; #0#7 = mens; |PINTA #0#7;
     #25#8 = #0#3;
     #25#9 = #0#4;
     |GRABA 020#25a;
 |FINSI;
 |SI #0#0 = #25#10; |Y #0#1 = #25#11;
     mens = " Apuntes Cabs.> " + #25#0 + "-" + #25#1 + "_" + #25#3; #0#7 = mens; |PINTA #0#7;
     #25#10 = #0#3;
     #25#11 = #0#4;
     |GRABA 020#25a;
 |FINSI;
|FPRC;

|DEFBUCLE camaasic;
 #25#1;
 ;
  0, fini,      0;
 99, ffin, 999999;
 be;
 NULL, camaasic1;
|FIN;
____________________________________/ camanban
|PROCESO camanban1;
 |SI #24#10 = #0#0; |Y #24#11 = #0#1;
     mens = " Bancos> " + #24#0; #0#7 = mens; |PINTA #0#7;
     #24#10 = #0#3;
     #24#11 = #0#4;
     |GRABA 020#24a;
 |FINSI;
 |LIBERA #24;
|FPRC;

|DEFBUCLE camanban;
 #24#1;
 ;
 000;
 999;
 be;
 NULL, camanban1;
|FIN;
____________________________________/ casieali
|PROCESO casieali1;
 |SI #21#3 = #0#0;
     mens = " Predefinidos> " + #21#0 + " " + #21#1; #0#7 = mens; |PINTA #0#7;
     #21#3 = #0#3;
     |GRABA 020#21a;
 |FINSI;
 |LIBERA #21;
|FPRC;

|DEFBUCLE casieali;
 #21#1;
 ;
    1,  1;
 9999, 99;
 be;
 NULL, casieali1;
|FIN;
____________________________________/ Contrapartida en CLIENTES Y PROVEEDORES
|PROCESO clienpro1;
 |SI #0#0 = #71#21; |Y #0#1 = #71#22;
     mens = "Contrapartida Cli./Prov.> " + #71#10; #0#7 = mens; |PINTA #0#7;
     #71#21 = #0#3;
     #71#22 = #0#4;
     |GRABA 020#71a;
 |FINSI;
 |LIBERA #71;
|FPRC;

|DEFBUCLE clienpro;
 #71#1;
 ;
 " ","            ",0;
 "z","zzzzzzzzzzzz",9;
 be;
 NULL, clienpro1;
|FIN;
____________________________________/ caclipro
|PROCESO caclipro;
 |ABRE #71;
  #71#10 = #0#3;
  #71#11 = #0#4;
  traba = #71#10 % 102;
  |SI traba = "43"; |O traba = "44";
      #71#23 = "C";
  |SINO;
      #71#23 = "P";
  |FINSI;
  |LEE 000#71=;
  sw_ya = 0; |SI FSalida = 0;  sw_ya = 1; |FINSI;
  #71#10 = #0#0;
  #71#11 = #0#1;
  traba = #71#10 % 102;
  |SI traba = "43";  |O traba = "44";
      #71#23 = "C";
  |SINO;
      #71#23 = "P";
  |FINSI;
  |LEE 000#71=;
  |SI FSalida = 0;
      mens = " CLIENTE/PROVEEDOR > " + #0#0; #0#7 = mens; |PINTA #0#7;
      |SI sw_baja = 0; |BORRA 020#71a; |FINSI;
      |SI sw_ya = 0;
          #71#10 = #0#3;
          #71#11 = #0#4;
          |GRABA 020#71n;
      |FINSI;
  |FINSI;
  |LIBERA #71;
 |CIERRA #71;
|FPRC;
____________________________________/ cacuenta
|PROCESO cacuenta;
  mens = " Plan Contable> " + #0#0;   #0#7 = mens;   |PINTA #0#7;

   |ABRE #69;
   #69#0 = #0#0;
   #69#1 = #0#1;
   |LEE 101#69=;
   |SI FSalida ! 0;  |CIERRA #69; |ACABA; |FINSI;
   Icant = cant1 <-;
   |PARA nume1 = 9; |SI nume1 [ 53; |HACIENDO nume1 = nume1+ 1;
         cant = #69nume1;
         Icant = Icant + 1;
   |SIGUE;
|| ------------------------------ Crea o actualiza cuenta ---------------
    #69#0 = #0#3;
    #69#1 = #0#4;
    |LEE 100#69=;
    |SI FSalida ! 0;
        #69#0 = #0#3;
        #69#1 = #0#4;
        |HAZ defectos;
        |GRABA 020#69n;
     |SINO;
          Icant = cant1 <-;
          |PARA nume1 = 9; |SI nume1 [ 53; |HACIENDO nume1 = nume1+ 1;
                #69nume1 = cant + #69nume1;
                Icant = Icant + 1;
          |SIGUE;
          |GRABA 020#69a;
     |FINSI;
     |LIBERA #69;


  #69#0 = #0#0;
  #69#1 = #0#1;
  |LEE 100#69=;
  |SI FSalida ! 0;  |CIERRA #69; |ACABA; |FINSI;

  |SI #0#6 = "S";
      |BORRA 020#69a;
  |SINO;
      |PDEFECTO #69,9,54;
      |PDEFECTO #69,56,60;
      |GRABA 020#69a;
  |FINSI;
  |LIBERA #69;
  |CIERRA #69;
|FPRC;

||**************************************************************************

|PROCESO camcta;
  |ATRI S; |PINTA 2315, #0#0; |ATRI 0;

  sw_baja = 0; |SI #0#6 = "N"; sw_baja = 1; |FINSI;

  fini = "01.01.1900";
  ffin = "31.12.9999";
  sw_baja = 0; |SI #0#6 = "N"; sw_baja = 1; |FINSI;

  |HAZ cacuenta; || PLAN CONTABLE
  |BUCLE casieali; || Cuentas en Lineas Predefinidos
  |HAZ caclipro;   || Cliente / Proveedor.
  |BUCLE clienpro; || Contrapartida en Cliente - Proveedor
  |BUCLE camanban; || Bancos
  |BUCLE camaasic; || Contrapartidas en Apuntes
  |BUCLE camaasil; || Cuentas en Lineas Apuntes
  |BUCLE caiivsol; || Intr. Iva Soportado.

  |BUCLE caivasop; || Cuentas en IVA Soportado.
  |BUCLE caiivrel; || Intr. Iva Repercutido.
  |BUCLE caivarep; || Cuentas en IVA Repercutido.
  |HAZ caivaasi;   || Control Entrada Asientos IVA.
  |BUCLE capasven; || Control pase ventas automaticas.
  |BUCLE cacuivli; || Cuentas IVA.
  |BUCLE cacoivli; || Contrapartidas.
  |BUCLE cagruiva; || Grupos Facturas Englobadas
  |BUCLE cavengca; || Facturas Englobadas

  |BUCLE camancob; || Cobros
  |BUCLE camanpag; || Pagos
  |BUCLE caremesc; || Remesas
  |BUCLE capagcab; || Pagares

  |HAZ caconcic; || Conciliar cuentas cab.
  |HAZ caconcil; || Conciliar cuentas lins.
  |HAZ cacuepre; || Cuenta Presupuestada.
  |HAZ camoauxc; || Desglose de Cuentas
  |HAZ camoauxl; || Desglose de Cuentas
  |BUCLE camogrup; || Grupos amortizacion
  |BUCLE camocabe; || Amortizacion cab.

  |HAZ cacup300;
  |HAZ cacup130;
  |HAZ cacup202;
  |HAZ cacupimp;

  |BUCLE caexistc;
  |BUCLE caexistl;
  |BUCLE camaylin;

  |BUCLE calicont;
  |BUCLE caliconb;

  |BUCLE camautol;


|FPRC;

|PROCESO defectos;
|| la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
  mascara = #69#0;
  |QBF mascara;
  mascara = mascara +"zzzzzzzzzzzz";
  mascara = mascara % 112;
  #69#54    = mascara;
  #69#55    = #69#1;
  #69#3     = "S";
|FPRC;

|DEFBUCLE leeTemporal;
 #0#1;
 ;
 0001;
 9999;
 e;
 NULL, camcta;
|FIN;

|PROCESO elCambio;

  |C_V #0#7,1,"S";
  |PINTA 2303, "En Proceso: ";

  |BUCLE leeTemporal;
  |DELINDEX #0;

  |DFICE pathbal;
  balance = 1;
  |SUB_EJECUTA "careccue.tab";
|FPRC;

|| ********************************************************************
|RUTINA mix;
 #0#8 = 1;
|FRUT;

|RUTINA max;
 #0#8 = 9999;
|FRUT;

|PROGRAMA;
 |HAZ inicio;
 |CLS;
 |CABEZA "Cambio Cuentas";

 |PINPA #0#0;
 |ENTLINEAL #1#0, -1, 1, 21, 0, mix, max;
 |SI FSalida = 0;
     |CONFI "1234SRealizar ahora el cambio S/N";
     |SI FSalida = 0;
         |HAZ elCambio;
     |FINSI;
 |FINSI;
|FPRO;
