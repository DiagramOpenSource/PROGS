|FICHEROS;
   cainfrem #0;
   caremesc #1;     || remesas cabs.
   caremesl #2;     || remesas lins.
|FIN;

|VARIABLES;
    &entrada = 1;
    &sw  = 0;
    &swlin = 1;
    informe = "";
    inform1 = "cainfrem";
    inform2 = "cainfrer";
    &tot1 = 0;
    &tot2 = 0;
|FIN;

|INCLUYE acceso_i;

|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

|PROCESO lineaspri;
  swlin = 1;
  |PRINT;
|FPRC;

|DEFBUCLE lineas;
 #2#1;
 ;
 #1#0,   1;
 #1#0, 999;
 e;
 NULL, NULL, NULL, NULL, NULL, lineaspri;
 #2#0, #2#6, #2#2, #2#3, #2#4, #2#1;
|FIN;

|PROCESO cabecera;
  |SI #0#8 ! "A";
      |SI #0#8 = "N"; |Y #1#8 ! "N"; |ACABA; |FINSI;
      |SI #0#8 = "S"; |Y #1#8 = "N"; |ACABA; |FINSI; || impresa
  |FINSI;
  |SI #0#9 ! "A";
      |SI #0#9 ! #1#9;  |ACABA;  |FINSI;  || contabilizada
  |FINSI;
  swlin = 0;
  |PRINT;
  |SI #0#10 = "D";
      |BUCLE lineas;
      |SI swlin = 1;
          swlin = 2;
          |PRINT;
      |FINSI;
  |FINSI;
  tot1 = tot1 + #1#10;
  tot2 = tot2 + #1#13;
  sw = 1;
|FPRC;

|DEFBUCLE cainfrem;
 #1#1;
 1, 2, 7;
 #0#0, #0#2, #0#4, #0#6;
 #0#1, #0#3, #0#5, #0#7;
 be;
 NULL, cabecera;
|FIN;

|PROCESO impre; |TIPO 3;
  |HAZ inicio;

  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |SI #0#10 = "D";
      informe = inform1;
  |SINO;
      informe = inform2;
  |FINSI;
  |INFOR informe
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

        |BUCLE cainfrem;
        |SI sw = 1; |PIEINF; |FINSI;
  |FININF;
  |FINIMP;
|FPRC;
