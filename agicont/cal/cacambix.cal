|FICHEROS;
    cacambix #0;
    cacambiy #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;
    inkey = 0;
    cuenta = "";
|FIN;

|INCLUYE acceso_i;
____________________________________/ GESTION PANTALLA
|PROCESO min;
    #0#4 = 10001;
|FPRC;

|PROCESO max;
    #0#4 = nume1;
|FPRC;

|PROGRAMA;
|CLS;
|CABEZA "Revision Cambio";
|PINPA #0#0;
|HAZ inicio;
    nume1 = -1;
|ABRE #0;
|SELECT #3#0;
|LEE 000#0u;
|SI FSalida = 0;|Y #0#4 ] 1001;
        nume1 = #0#4;
|FINSI;
|CIERRA #0;
|SI nume1 ! -1;
    |ENTLINEAL #3#0, 1, 3, 23, 0, min, max;
|SINO;
    |MENAV "    Preparacion Nula ...";
|FINSI;
|FPRO;

|PROCESO tipo13; |TIPO 13;
    inkey = FSalida;
|ATRI R;
|MENSA "    <F12> Funcion Modificacion Cuentas Destino por Ampliacion de Digitos.";
|ATRI 0;
|HAZ tipo11;
|FPRC;
____________________________________/ FUNCION DE MODIFICACION AUTOMATICA
|PROCESO tipo11;
|SI inkey = 9;
    |PUSHV 05012380;
    |PINPA #0#1;
    |PINDA #0#1;
    |ENDATOS #1#1;
    |SI FSalida = 0;|Y #1#9 = "SI";
            elsw1 = 0;
        |SI #1#2 = "S";|O #1#6 = "S";
            |ATRI P;    |MENSA "    Modificando ..."; |ATRI 0;
            |HAZ funcion;
            |ATRI R;    |BLIN 4;                      |ATRI 0;
                elsw1 = 1;
        |FINSI;
    |FINSI;
    |POPV;
    |ERROR;
    |SI elsw1 = 1;
        |PTEC 806;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO lee_revision1;
|SI #1#2 = "S";
        cuenta = #0#2;   |QBF cuenta;
        nume1 = 99 + #1#3;
        alfa1 = cuenta % nume1;        || parte izda.
        nume1 = #1#5 - #1#3;
        alfa2 = &32 * nume1;           || relleno de espacios
        nume1 = (#1#3 * 100) + #1#4;
        alfa3 = cuenta % nume1;        || parte a desplazar
        cuenta = alfa1 + alfa2 + alfa3;

        #0#2 = cuenta;
    |GRABA 020#0a;
|FINSI;
|SI #1#6 = "S";
        cuenta = #0#2;   |QBF cuenta;
        alfa1 = cuenta % 0;
        nume2 = alfa1;

        nume1 = 99 + #1#7;
        alfa1 = cuenta % nume1;         || parte izda.
        nume1 = #1#8;
        alfa2 = "0" * nume1;            || relleno de ceros
        nume1 = -((nume2 - (#1#7 + #1#8 - 1)) + 100);
        alfa3 = cuenta % nume1;         || parte dcha.
        cuenta = alfa1 + alfa2 + alfa3;

        #0#2 = cuenta;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|FPRC;

|DEFBUCLE lee_revision;
 #0#1;
 4;
 #1#0, 0,  10001;
 #1#1, 9, 999999;
 be;
 NULL, lee_revision1;
|FIN;

|PROCESO funcion;
|CIERRAT #0;
|BUCLE lee_revision;
|ABRET #0;
|FPRC;
