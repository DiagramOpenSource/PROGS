|FICHEROS;
    caplciec #0;
    caplciel #1;
    cacuenta #2;
|FIN;;

|VARIABLES;
    &entrada = 1;
    alfa1   = "";
    salida  = 0;
    sumapar = 0;
    uno     = "";
    dos     = "";
    signo   = "";
    &swpanta = 0;
    &swcalcu = 0;
    informe  = "caplciec";
    registro = 0;
|FIN;

|INCLUYE acces2_i;
|| *********************************************************************
|PROCESO cal_ctas2;
 |SI signo = "D";
     sumapar = sumapar + (#2#53 - #2#50)
 |SINO;
     sumapar = sumapar - (#2#53 - #2#50)
 |FINSI;
|FPRC;

|DEFBUCLE lee_ctas;
 #2#1;
 3;
 #1#2, 0, "S";
 dos,  9, "S";
 e;
 NULL, cal_ctas2;
|FIN;

|PROCESO buscacta;
   sumapar = 0;
   uno = #1#2;
   |QBF uno;
   dos = uno + "999999999999";
   dos = dos % A112;
   signo = #1#3;
   |BUCLE lee_ctas;
   #0#2 = #0#2 + sumapar;
|FPRC;

|PROCESO calsal; |TIPO 0;
 salida = FSalida;
 |SI salida ! 9;
     |ACABA;
 |FINSI;
 #0#2 = 0;
 |BUCLELIN 2buscacta#0;
 |PINTA #0#2;
|FPRC;

|| **************************************************************************
|| ************************ Campos de las L¡neas.
|PROCESO mayus;
  alfa1 = #1Campo > " ";
  #1Campo = alfa1;
  |PINTA #1Campo;
|FPRC;


|| **************************************************************************
|| ********************* CALCULO PARA IMPRIMIR.
|PROCESO impre;
 |PRINT;
|FPRC;

|DEFBUCLE caplciec0;
 #0#1;
 ;
 01;
 99;
 e;
 NULL, impre;
|FIN;

|PROCESO tipo4; |TIPO 4;
 |CONFI "2400SCalcular antes de Imprimir ? ";
 |SI FSalida = 0;
     swcalcu = 0;
     swpanta = 2;
     |SUB_EJECUTA "cargacie.tab";
 |FINSI;

  |HAZ inicio2;
  registro = #0#0;
  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
  |BUCLE caplciec0;
  |PIEINF;
  |FININF;
  #0#0 = registro;
  |FINIMP;
|FPRC;
|| ************************************************************************
