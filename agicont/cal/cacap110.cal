|FICHEROS;
  cacap110 #00;
  catra115 #1;
  caclipro #4;
  camaasil #7;
  cacuenta #8;
  caman110 #11;
  eosclipr #12;
  cacongru #13;
  canempre #30;
  agicontr #23;

  cacon110 #24;
|FIN;

|VARIABLES;
  desde   = 0;
  hasta   = 0;
  modif1  = "";
  modif2  = "";
  xy      = 0;
  x       = 0;
  y       = 0;
  z       = 0;
  yz      = 0;

  direcc  = "";
  linea   = 0;
  sien    = 0;
  alfa1   = "";
  alfa2   = "";
  alfa3   = "";
  alfa4   = "";
  lonagi  = "";
  longi   = 0;
  nume1   = 0;
  nume2   = 0;
  nume3   = 0;
  nume4   = 0;

  fech1   = @;
  fech2   = @;

  tipo0   = 0;
  totbas  = 0;
  swgr    = 0;
  grupo   = 0;
  concepto = 0;
  swclipro = 0;

  agi   = "";
  &agi1 = "";
  &agi2 = "";
  &aste = "";
  num   = 0;

  ult_cont  = 0;
  cclau     = "";
  ccc       = 0;
  nif       = "";
  cta       = "";
  dig       = 0;
  campobas1 = 0;
  camporet1 = 0;
  campobas2 = 0;
  camporet2 = 0;
  campobas3 = 0;
  camporet3 = 0;
  campobas4 = 0;
  camposso0 = 0;
  meses     = 0;
  traba     = "";
  base      = 0;
  retencion = 0;
  retenedor = 0;
  swtenedor = 0;
  segsocial = 0;
  baseexen  = 0;
  cuenretene   = "";
  digiretene   = 0;
  nombreretene = "";
  mensaca      = "";
  fechaasien   = @;
  documeant    = 0;
  encontrado   = 0;
  primeravez   = 0;
  guarcuen     = "";
|FIN;

|INCLUYE acceso_i;
|INCLUYE tempo_i;

|| ******************************************************************

|PROCESO mayor2;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;


|| ************************************************************************

|PROGRAMA;
  |HAZ inicio;
  |HAZ tipo_8; || controlar si existe la ficha de clientes
  |CLS;
  |CABEZA "Pase a Modelo 110";

  |ABRE #0;
  #0#0   = cod1;
  #0#2   = #30#26;
  |LEE 141#0=;
  |SI FSalida ! 0;
      |DDEFECTO #0;
      #0#0   = cod1;
      #0#1   = #30#1;
      #0#2   = #30#26;
      |GRABA 001#0b;
  |FINSI;
  |PINPA #0#0;
  |PINDA #0#0;
  |ENDATOS #2#0;
  |SI FSalida = 0;
      |GRABA 001#0a;
      |HAZ elpase;
  |FINSI;
  |CIERRA #0;
|FPRO;

|| ***********************************************************************
|| ****************** CREAR FICHERO DE MODELO 110 ************************
|| ***********************************************************************

|PROCESO encuentra;
  ccc = #11#1;
  |ERROR10;
|FPRC;

|DEFBUCLE busca_110;
 #11#2;
 0,134;
 cclau, #0#0, #0#2;
 cclau, #0#0, #0#2;
 be;
 NULL, encuentra;
|FIN;

|PROCESO lineas;
  cclau = #1#7;
  |SI #0#6 = "N";
      cta   = #1#7 %  112;
      alfa1 = #1#7 % 1301;
      dig = alfa1;
  |SINO;
      cta   = #1#127 %  112;
      alfa1 = #1#127 % 1301;
      dig = alfa1;
  |FINSI;
  ccc = 0;
  |BUCLE busca_110;
  |SI ccc = 0;
      ult_cont = ult_cont + 1;
      ccc = ult_cont;
  |FINSI;
  #11#0   = #0#0;
  #11#1   = ccc;
  #11#134 = #0#2;
  |LEE 101#11=;
  |SI FSalida ! 0;
      |DDEFECTO #11;
      #11#0   = #0#0;
      #11#1   = ccc;
      #11#134 = #0#2;
      #11#12  = 1;
      #11#13  = 2;
      |HAZ datospro;
      |GRABA 020#11b;
  |FINSI;

  |PARA meses = 1; |SI meses [ 12;  |HACIENDO meses = meses + 1;
        campobas1 = meses + 22;
        camporet1 = meses + 35;
        campobas2 = meses + 48;
        camporet2 = meses + 61;
        campobas3 = meses + 74;
        camporet3 = meses + 87;
        campobas4 = meses + 100;
        camposso0 = meses + 113;
        #11campobas1 = #11campobas1 + #1campobas1;  || total bases  1
        #11camporet1 = #11camporet1 + #1camporet1;  || total reten. 1
        #11campobas2 = #11campobas2 + #1campobas2;  || total bases  2
        #11camporet2 = #11camporet2 + #1camporet2;  || total reten. 2
        #11campobas3 = #11campobas3 + #1campobas3;  || total bases  3
        #11camporet3 = #11camporet3 + #1camporet3;  || total reten. 3
        #11campobas4 = #11campobas4 + #1campobas4;  || total bases  4
        #11#35  = #11#35  + #1campobas1;  || total bases  1
        #11#48  = #11#48  + #1camporet1;  || total reten. 1
        #11#61  = #11#61  + #1campobas2;  || total bases  2
        #11#74  = #11#74  + #1camporet2;  || total reten. 2
        #11#87  = #11#87  + #1campobas3;  || total bases  3
        #11#100 = #11#100 + #1camporet3;  || total reten. 3
        #11#113 = #11#113 + #1campobas4;  || total bases  4

        |SI #0#10 = "S";
            #11camposso0 = #11camposso0 + #1camposso0;  || Seg.Social
            #11#126 = #11#126 + #1camposso0;
        |FINSI;
  |SIGUE;
  #11#9  = #1#9;
  #11#10 = #1#10;
  #11#11 = #1#11;
  #11#12 = #1#12;
  #11#13 = #1#13;
  #11#14 = #1#14;

  |GRABA 020#11a;
  |LIBERA #11;
|FPRC;

|DEFBUCLE escribe;
  #1#1;
  ;
  #0#0, "               ";
  #0#0, "zzzzzzzzzzzzzzz";
  e;
  NULL,lineas;
|FIN;

|| ***********************************************************************
|| ********************* CREAR FICHERO DE TRABAJO ************************
|| ***********************************************************************
|PROCESO grabaficha;
  |SI retenedor = 0;  |Y base = 0;  |Y retencion = 0; |Y segsocial = 0;
      |ACABA;
  |FINSI;
  alfa2 = digiretene;
  alfa1 = cuenretene + "000000000000";
  cclau = alfa1 % 112;
  cclau = cclau + alfa2;
  guarcuen = cclau;
  |SI #0#6 = "S";
      |HAZ buscadni;                   ||SOLO BUSCA EN CACLIPRO 1a VEZ
  |FINSI;
  #1#0 = #0#0;
  #1#7 = cclau;
  |LEE 101#1=;
  |SI FSalida ! 0;
      |DDEFECTO #1;
      #1#0   = #0#0;
      #1#127 = guarcuen;
      #1#3   = nombreretene;
      #1#7   = cclau;
      |GRABA 020#1b;
  |FINSI;
  alfa1 = fechaasien;
  alfa1 = alfa1 % 0402;
  nume1 = alfa1;

  |SI #24#0 ! "E";
      |SI #1#12 = " ";  |O #1#12 = #24#0;
          #1#9 = ((retencion * 100) / base) ! 0;
          #1#12 = #24#0;
          campobas1 = nume1 + 22;
          camporet1 = nume1 + 35;
      |SINO;
          |SI #1#13 = " ";  |O #1#13 = #24#0;
              #1#10 = ((retencion * 100) / base) ! 0;
              #1#13 = #24#0;
              campobas1 = nume1 + 48;
              camporet1 = nume1 + 61;
          |SINO;
              |SI #1#14 = " ";  |O #1#14 = #24#0;
                  #1#11 = ((retencion * 100) / base) ! 0;
                  #1#14 = #24#0;
                  campobas1 = nume1 + 74;
                  camporet1 = nume1 + 87;
              |SINO;
                  mensaca = "    EXISTEN MAS DE TRES TIPOS " + cuenretene + " " + documeant;
                  |MENAV mensaca;
              |FINSI;
          |FINSI;
      |FINSI;
      #1campobas1 = #1campobas1 + base;
      #1camporet1 = #1camporet1 + retencion;
  |SINO;
      campobas1 = nume1 + 100;
      #1campobas1 = #1campobas1 + baseexen;
  |FINSI;

  |SI #0#10 = "S";
      camposso0 = nume1 + 113;
      #1camposso0 = #1camposso0 + segsocial;
  |FINSI;

  |GRABA 020#1a;
  |LIBERA #1;

  swtenedor  = 0;
  retenedor  = 0;
  base       = 0;
  baseexen   = 0;
  retencion  = 0;
  cuenretene = "";
  digiretene = 0;
  segsocial  = 0;
|FPRC;

|PROCESO grupos;
 |ABRE #13;
 #13#0 = grupo;
 |LEE 001#13=;
 |SI FSalida =  0;
     |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
           |SI #13x  = #7#6;
               encontrado = 1;
               |SAL;
           |FINSI;
     |SIGUE;
 |FINSI;
 |CIERRA #13;
|FPRC;

|| ---------------------------------------------------
|PROCESO retenedor;
  |SI #24#2 = "S";
      |SI #24#3 ! 0;  grupo = #24#3;  |HAZ grupos;  |FINSI;
      |SI #24#4 ! 0;  |Y encontrado = 0;  grupo = #24#4;  |HAZ grupos;  |FINSI;
      |SI #24#5 ! 0;  |Y encontrado = 0;  grupo = #24#5;  |HAZ grupos;  |FINSI;
      |SI #24#6 ! 0;  |Y encontrado = 0;  grupo = #24#6;  |HAZ grupos;  |FINSI;
  |FINSI;
  |SI encontrado = 0;
      |SI #24#7 = "S";
          |SI #7#6 ] #24#8;  |Y #7#6 [ #24#9;
              encontrado = 1;
          |FINSI;
      |SINO;
          |SI #7#6 = #24#10;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#11;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#12;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#13;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#14;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#15;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#16;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#17;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#18;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#19;  encontrado = 1;  |FINSI;
      |FINSI;
  |FINSI;
  |SI encontrado = 1;
      |SI swtenedor = 1;
          |HAZ grabaficha;
      |FINSI;
      fechaasien = #7#1;
      cuenretene = #7#4;
      digiretene = #7#5;
      retenedor  = #7#9;
      swtenedor  = 1;
  |FINSI;
|FPRC;

|PROCESO base;
  |SI #24#20 = "S";
      |SI #24#21 ! 0;  grupo = #24#21;  |HAZ grupos;  |FINSI;
      |SI #24#22 ! 0;  |Y encontrado = 0;  grupo = #24#22;  |HAZ grupos;  |FINSI;
      |SI #24#23 ! 0;  |Y encontrado = 0;  grupo = #24#23;  |HAZ grupos;  |FINSI;
      |SI #24#24 ! 0;  |Y encontrado = 0;  grupo = #24#24;  |HAZ grupos;  |FINSI;
  |FINSI;
  |SI encontrado = 0;
      |SI #24#25 = "S";
          |SI #7#6 ] #24#26;  |Y #7#6 [ #24#27;
              encontrado = 1;
          |FINSI;
      |SINO;
          |SI #7#6 = #24#28;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#29;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#30;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#31;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#32;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#33;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#34;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#35;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#36;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#37;  encontrado = 1;  |FINSI;
      |FINSI;
  |FINSI;
  |SI encontrado = 1;
      fechaasien = #7#1;
      base       = base + #7#9;
  |FINSI;
|FPRC;

|PROCESO baseexenta;
  |SI #24#20 = "S";
      |SI #24#21 ! 0;  grupo = #24#21;  |HAZ grupos;  |FINSI;
      |SI #24#22 ! 0;  |Y encontrado = 0;  grupo = #24#22;  |HAZ grupos;  |FINSI;
      |SI #24#23 ! 0;  |Y encontrado = 0;  grupo = #24#23;  |HAZ grupos;  |FINSI;
      |SI #24#24 ! 0;  |Y encontrado = 0;  grupo = #24#24;  |HAZ grupos;  |FINSI;
  |FINSI;
  |SI encontrado = 0;
      |SI #24#25 = "S";
          |SI #7#6 ] #24#26;  |Y #7#6 [ #24#27;
              encontrado = 1;
          |FINSI;
      |SINO;
          |SI #7#6 = #24#28;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#29;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#30;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#31;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#32;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#33;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#34;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#35;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#36;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#37;  encontrado = 1;  |FINSI;
      |FINSI;
  |FINSI;
  |SI encontrado = 1;
      fechaasien = #7#1;
      baseexen   = baseexen + #7#9;
  |FINSI;
|FPRC;

|PROCESO retencion;
  |SI #24#38 = "S";
      |SI #24#39 ! 0;  grupo = #24#39;  |HAZ grupos;  |FINSI;
      |SI #24#40 ! 0;  |Y encontrado = 0;  grupo = #24#40;  |HAZ grupos;  |FINSI;
      |SI #24#41 ! 0;  |Y encontrado = 0;  grupo = #24#41;  |HAZ grupos;  |FINSI;
      |SI #24#42 ! 0;  |Y encontrado = 0;  grupo = #24#42;  |HAZ grupos;  |FINSI;
  |FINSI;
  |SI encontrado = 0;
      |SI #24#43 = "S";
          |SI #7#6 ] #24#44;  |Y #7#6 [ #24#45;
              encontrado = 1;
          |FINSI;
      |SINO;
          |SI #7#6 = #24#46;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#47;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#48;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#49;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#50;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#51;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#52;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#53;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#54;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#55;  encontrado = 1;  |FINSI;
      |FINSI;
  |FINSI;
  |SI encontrado = 1;
      fechaasien = #7#1;
      retencion  = retencion + #7#9;
 |FINSI;
|FPRC;

|PROCESO segsocial;
  |SI #24#56 = "S";
      |SI #24#57 ! 0;  grupo = #24#57;  |HAZ grupos;  |FINSI;
      |SI #24#58 ! 0;  |Y encontrado = 0;  grupo = #24#58;  |HAZ grupos;  |FINSI;
      |SI #24#59 ! 0;  |Y encontrado = 0;  grupo = #24#59;  |HAZ grupos;  |FINSI;
      |SI #24#60 ! 0;  |Y encontrado = 0;  grupo = #24#60;  |HAZ grupos;  |FINSI;
  |FINSI;
  |SI encontrado = 0;
      |SI #24#61 = "S";
          |SI #7#6 ] #24#62;  |Y #7#6 [ #24#63;
              encontrado = 1;
          |FINSI;
      |SINO;
          |SI #7#6 = #24#64;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#65;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#66;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#67;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#68;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#69;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#70;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#71;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#72;  encontrado = 1;  |FINSI;
          |SI #7#6 = #24#73;  encontrado = 1;  |FINSI;
      |FINSI;
  |FINSI;
  |SI encontrado = 1;
      fechaasien = #7#1;
      segsocial  = segsocial + #7#9;
 |FINSI;
|FPRC;

|PROCESO camaasil;

  |SI primeravez = 0;
      primeravez = 1;
      documeant  = #7#2;
      swtenedor  = 0;
      retenedor  = 0;
      base       = 0;
      baseexen   = 0;
      retencion  = 0;
      segsocial  = 0;
      cuenretene = "";
      digiretene = 0;
  |FINSI;

  |SI documeant ! #7#2;
      |HAZ grabaficha;
      documeant = #7#2;
  |FINSI;

  encontrado = 0;
  |HAZ retenedor;
|| ... ... ... ... ... ...   |SI encontrado = 1;  |ACABA;  |FINSI;
  encontrado = 0;
  |SI #24#0 ! "E";
      |HAZ base;
      |SI encontrado = 1;  |ACABA;  |FINSI;
      |HAZ retencion;
      |SI encontrado = 1;  |ACABA;   |FINSI;
  |SINO;
      |HAZ baseexenta;
      |SI encontrado = 1;  |ACABA;   |FINSI;
  |FINSI;

  |SI #0#10 = "S"; |HAZ segsocial; |FINSI;
|FPRC;

|DEFBUCLE camaasil;
 #7#1;
 ;
 00, fech1, 000000, 0000;
 99, fech2, 999999, 9999;
 e;
 NULL,camaasil;
|FIN;

|PROCESO cacon110;
  primeravez = 0;
  |BUCLE camaasil;
  |HAZ grabaficha;
|FPRC;

|DEFBUCLE cacon110;
  #24#1;
  ;
  " ";
  "z";
  e;
  NULL,cacon110;
|FIN;

|| ***********************************************************************
|PROCESO acero;

  |PARA meses = desde; |SI meses [ hasta;  |HACIENDO meses = meses + 1;
        campobas1 = meses + 22;
        camporet1 = meses + 35;
        campobas2 = meses + 48;
        camporet2 = meses + 61;
        campobas3 = meses + 74;
        camporet3 = meses + 87;
        campobas4 = meses + 100;
        camposso0 = meses + 113;
        #11#35  = #11#35  - #11campobas1;
        #11#48  = #11#48  - #11camporet1;
        #11#61  = #11#61  - #11campobas2;
        #11#74  = #11#74  - #11camporet2;
        #11#87  = #11#87  - #11campobas3;
        #11#100 = #11#100 - #11camporet3;
        #11#113 = #11#113 - #11campobas4;
        |SI #0#10 = "S"; #11#126 = #11#126 - #11camposso0; |FINSI;
        #11campobas1 = 0;  || total bases  1
        #11camporet1 = 0;  || total reten. 1
        #11campobas2 = 0;  || total bases  2
        #11camporet2 = 0;  || total reten. 2
        #11campobas3 = 0;  || total bases  3
        #11camporet3 = 0;  || total reten. 3
        #11campobas4 = 0;  || total bases. 4
        |SI #0#10 = "S";
            #11camposso0 = 0;  || total Seguridad Social
        |FINSI;
  |SIGUE;

  ult_cont = #11#1;
  |GRABA 020#11a;
  |LIBERA #11;
|FPRC;

|DEFBUCLE borrar_acum;
 #11#1;
 ;
 #0#0, 00001, #0#2;
 #0#0, 99999, #0#2;
 be;
 NULL, acero;
|FIN;

|PROCESO elpase;

  |HAZ nom_usu;
  alfa1 = "y" + nom_tmp;
  |NOME_DAT #1 alfa1;

  |ABRE #1;
  |CIERRA #1;
  |DELINDEX #1;
  ult_cont = 0;

  desde = 1;
  |SI #0#7 = 2; desde =  4; |FINSI;
  |SI #0#7 = 3; desde =  7; |FINSI;
  |SI #0#7 = 4; desde = 10; |FINSI;

  hasta = 3;
  |SI #0#8 = 2; hasta =  6; |FINSI;
  |SI #0#8 = 3; hasta =  9; |FINSI;
  |SI #0#8 = 4; hasta = 12; |FINSI;

  |BUCLE borrar_acum;
  |SI #0#2 [ 80;
      nume2 = 2000 + #0#2;
  |SINO;
      nume2 = 1900 + #0#2;
  |FINSI;

  alfa3 = nume2; |QBF alfa3;
  alfa3 = ("0000" + alfa3) % -104;
  alfa1 = desde; |QBF alfa1;
  alfa1 = ("00" + alfa1) % -102;
  alfa2 = "01." + alfa1 + "." + alfa3;
  fech1 = alfa2;
  alfa1 = hasta; |QBF alfa1;
  alfa1 = ("00" + alfa1) % -102;
  alfa4 = "30."; |SI hasta = 3; |O hasta = 12; alfa4 = "31."; |FINSI;
  alfa2 = alfa4 + alfa1 + "." + alfa3;
  fech2 = alfa2;
  primeravez = 0;

  |ABRE #1;
  |BUCLE cacon110;
  |CIERRA #1;

  |ABRET #11;
  |BUCLE escribe;
  |CIERRAT #11;
|FPRC;


|PROCESO buscadni;                     ||SOLO BUSCA EN CLIPRO 1a VEZ

  |ABRE #4;
  cclau = "";
  #4#23 = "P";
  swclipro = 0;
  #4#10 = cuenretene;
  #4#11 = digiretene;
  |LEE 001#4=;
  |SI FSalida = 0;
      cclau = #4#9;
      nombreretene = #4#1;
      |CIERRA #4;
      |ACABA;
  |FINSI;
  #4#23 = "C";
  #4#10 = cuenretene;
  #4#11 = digiretene;
  |LEE 001#4=;
  |SI FSalida = 0;
      cclau = #4#9;
      nombreretene = #4#1;
  |SINO;
      |ABRE #8;
      cclau = cuenretene + digiretene;
      #8#0 = cuenretene;
      #8#1 = digiretene;
      |LEE 101#8=;
      |SI FSalida ! 0;
          nombreretene = "NO EXISTE CUENTA CONTABLE";
      |SINO;
          nombreretene = #8#2;
      |FINSI;
      |LIBERA #8;
      |CIERRA #8;
  |FINSI;
  |CIERRA #4;
|FPRC;

|PROCESO datospro;

  |ABRE #4;
  #4#23    = "P";
  swclipro = 0;
  #4#10    = cta;
  #4#11    = dig;
  |LEE 001#4=;
  |SI FSalida = 0;  swclipro = 1;  |FINSI;
  |SI swclipro = 0;
      #4#23 = "C";
      #4#10 = cta;
      #4#11 = dig;
      |LEE 001#4=;
      |SI FSalida = 0;  swclipro = 1;  |FINSI;
  |FINSI;

  #11#7   = cclau;
  #11#2   = #0#1;      ||nombre
  #11#3   = #1#3;      ||nombre
  |SI swclipro = 1; || lee el nombre de Clientes/Proveedores
      #11#7   = #4#9;      ||dni
      #11#3   = #4#1;      ||nombre
      #11#127 = #4#2;      || Domicilio
      #11#5   = #4#3;  || C.P.1
      #11#6   = #4#4;  || C.P.2
      #11#4   = #4#6;  || Localidad
      #11#132 = #4#5;  || Provincia
  |SINO;

      |ABRE #8;
      #8#0 = cta;
      #8#1 = dig;
      |LEE 101#8=;
      |SI FSalida ! 0;
          #11#3 = "NO EXISTE CUENTA CONTABLE";
      |SINO;
          #11#3 = #8#2;
      |FINSI;
      |LIBERA #8;
      |CIERRA #8;
  |FINSI;
  |CIERRA #4;
|FPRC;

|| ****************************************************************
|PROCESO tipo_8; || controlar si existe ficha clientes
  |DIRECTORIO agi;
  |QBF agi;
  |PATH_DAT #23 agi;
  |ABRE #23;
  #23#0 = 1;
  |LEE 040#23=;
  |SI FSalida ! 0; aste = "*"; |CIERRA #23; |ACABA; |FINSI;
  |CIERRA #23;
  aste = #23#7;
  |QBF aste;
  |SI aste  = "*"; |ACABA; |FINSI;
  agi1 = #23#8; |QBF agi1;
  lonagi = agi1 % 0;
  num   = lonagi;
  num   = 100 + (num - 5);
  lonagi = num;
  agi2  = (agi1 % lonagi) + "pan/";
  |PATH_DAT #12 agi1;
|FPRC;
