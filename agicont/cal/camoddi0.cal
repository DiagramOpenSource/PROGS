|FICHEROS;
    camoddi0 #0;    || def entrada
|FIN;

|VARIABLES;
    &entrada = 1;
    importe = 0;
    men1  = "     NO EXISTE EMPRESA !";
    men2  = "     Longitud de Cuenta Fuera de Nivel !";
    men3  = "     ERROR el asiento ya existe";
    men4  = "     ERROR el asiento NO existe";
    opera = "";
    fecalf = "";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
    &modcon = 0;
    &modifi = 0;
    mesi1 = "";
    mesi2 = "";
    traba1 = "";
    &ext1 = "";
    &ext2 = "";
    &ext3 = "";
    &ext4 = "";
    &no_mensaje = 0;
    &sw_ivamerr = 0;
    si_sigue = 0;
    sw_exi = 0;
    alfa1 = "";
    alfa2 = "";
    i_perio = 0;
    trim1 = @
    trim2 = @
    trim3 = @
|FIN;

|INCLUYE acceso_i;
|INCLUYE varnue_i;
|INCLUYE actudi_i;
|INCLUYE moddia_i;

|PROGRAMA;
  |HAZ inicio;
  |HAZ eVarEmpresa;

  #0#0 = ext1;         || diario viejo
  #0#1 = ext2;         || fecha vieja
  #0#2 = ext3;         || documento viejo
  #0#9 = ext4;         || asiento viejo
  #0#3 = #0#0;         || diario nuevo
  #0#4 = #0#1;         || fecha nueva
  #0#5 = #0#2;         || documento nuevo
  #0#10 = #0#9;        || asiento nuevo
  |HAZ lectura;
  |BLIN 4;
  |SI si_sigue ! 1;  |ACABA;  |FINSI;
  |ABRE #5;
  |LEE 101#5u;
  |SI FSalida ! 0;
      |DDEFECTO #5;
      #5#0 = 1;
  |SINO;
      #5#0 = #5#0 + 1;
  |FINSI;
  |GRABA 101#5n;
  codcon = #5#0;
  |LIBERA #5;
  |CIERRA #5;

  |CABEZA "Modificacion de Asiento";
  |PINPA #0#0;
  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0;
      |ABRE #1;
      |ABRE #2;
      #1#0 = #0#0;
      #1#1 = #0#1;
      #1#2 = #0#2;
      |LEE 001#1=;
      |SI FSalida ! 0;
          |MENAV men4;
          #0#6 = #1#4;
          #0#7 = #1#5;
          |PINTA #0#6;
          |PINTA #0#7;
      |SINO;
          #1#0 = #0#3;
          #1#1 = #0#4;
          #1#2 = #0#5;
          |LEE 001#1=;
          |SI FSalida = 0;
              |MENAV men3;
          |SINO;
              |HAZ cambio;
              |HAZ los_ivas;
              ext1 = #0#3;   || diario
              ext2 = #0#4;   || fecha
              ext3 = #0#5;   || documento
              ext4 = #0#10;  || asiento
              sw_ivamerr = 0;
          |FINSI;
      |FINSI;
      |CIERRA #1;
      |CIERRA #2;
  |FINSI;
  |SI modifi = 0;
      |ABRET #5;
      |DDEFECTO #5;
      #5#0 = codcon;
      |LEE 040#5=;
      |BORRA 101#5a;
      |CIERRAT #5;
  |SINO;
      |SUB_EJECUTA "camoddac.run";
  |FINSI;
|FPRO;

|PROCESO mayus;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;
