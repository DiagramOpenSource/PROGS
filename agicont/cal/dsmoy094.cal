|FICHEROS;
     dsmoy094;

     cama3390;
     cama4390;

     canempre;
|FIN;

|VARIABLES;
     aAlfa1     = "";
     aAlfa2     = "";
     nHay       = 0;
     nDEmpresa  = 0;
     nHEmpresa  = 0;
     aPath      = "";

     &enEjer    = 0;
     &eaNombre  = "";
     &dir_fich  = "";
|FIN;

|| /////////////////////// PROCESOS DE IMPRESION \\\\\\\\\\\\\\\\\\\\

|PROCESO canempre;
     eaNombre = #canempre#4;

     aAlfa1 = ("00000" + #canempre#2) % -105;
     aAlfa2 = ("0"     + #canempre#3) % -101;

     aPath  = dir_fich + aAlfa1 + aAlfa2 + "/";
     |PATH_DAT #cama3390#aPath#;
     |PATH_DAT #cama4390#aPath#;

     |ABRET #cama3390;
     |ABRET #cama4390;

     #cama3390#0 = #canempre#2;
     #cama3390#1 = enEjer;
     |LEE 101#cama3390.=;
     |SI FSalida = 0;

         |DDEFECTO #cama4390;
         #cama4390#0 = #canempre#2;
         #cama4390#1 = enEjer;
         |LEE 000#cama4390.=;

         |SI #cama3390#159 = #cama4390#158; |Y #cama3390#159 ! 0;
             |PRINT;
              nHay = 1;
          |FINSI;
     |FINSI;

     |CIERRAT #cama3390;
     |CIERRAT #cama4390;
|FPRC;

|DEFBUCLE canempre;
    #canempre#1;
    26;
    nDEmpresa, 0, enEjer;
    nHEmpresa, 9, enEjer;
    e;
    NULL, canempre;
|FIN;

|PROCESO Chequeo; |TIPO 3;
     |SI #dsmoy094#1 = "N"; |ACABA; |FINSI;

     |DFICB dir_fich;
     |QBF dir_fich;

     |IMPRE 0;
     |SI FSalida ! 0;
         |MENAV "0000Error en Impresora. Proceso interrumpido";
         |ACABA;
     |FINSI;

     |INFOR "dsmoy094";
     |SI FSalida ! 0;
         |FINIMP;
         |MENAV "0000Error en Informe.";
         |ACABA;
     |FINSI;

     enEjer    = #dsmoy094#0 - 2000;
     nDEmpresa = 00001;
     nHEmpresa = 99999;

     nHay = 0;
     |BUCLE canempre;
     |SI nHay ! 0;
         |PIEINF;
     |SINO;
         |MENAV "    Sin Incidencias";
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
