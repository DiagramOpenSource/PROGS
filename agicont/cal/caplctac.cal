|FICHEROS;
    caplctac #0;
    caplctal #1;
    caconlib #2;
|FIN;;

|VARIABLES;
    &entrada = 1;
    alfa1 = "";
    alfa2 = ""
    alfa3 = ""
    modo = 0;
    salida = 0;
    p = 0;
    x = 0;
    y = 0;
    z = 0;
    as = "*";
    linea = 0;
    &lib = 0;
    &descripcion = "";
|FIN;

|PROCESO baja; |TIPO 1;
 modo = (FEntrada / 100) ! 0;
 |SI modo = 3;
     |ABRE #2;
     #2#0 = #0#0;
     |BORRA 040#2c;
     |CIERRA #2;
 |FINSI;
|FPRC;

|PROCESO leecol; |TIPO 0;
 lib= #0#0;
 descripcion= #0#1;
 salida = FSalida;
 modo = (FEntrada / 100) ! 0;
 |SI modo = 1; |O salida = 9;
     |SUB_EJECUTA "caconlib";
 |FINSI;
 |ABRE #2;
 |DDEFECTO #2;
 #2#0 = #0#0;
 |LEE 040#2=;
 |CIERRA #2;
|FPRC;

|| ************************ Campos de las L¡neas.

|PROCESO defec1; |TIPO 0;
  salida = FSalida;
  |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
  |FINSI;
  modo = (FEntrada / 100) ! 0;
  |SI modo ! 1; |ACABA; |FINSI;
  alfa2 = #1#2 % 101;
  #1#3 = "R";
  #1#7 = "D";
  |SI alfa2 = "6";  #1#3 = "G"; #1#7 = "D"; #1#4 = "S"; |FINSI;
  |SI alfa2 = "7";  #1#3 = "I"; #1#7 = "H"; #1#4 = "S"; |FINSI;
  |SI alfa2 = "2";  #1#3 = "V"; #1#7 = "D"; #1#4 = as; |FINSI;
  |SI alfa2 = "4";  #1#3 = "R"; #1#7 = as; #1#4 = "D"; |FINSI;
  |PINTA #1#3;
  |HAZ descri;
  |PINTA #1#7;
|FPRC;

|PROCESO mayus;
  alfa1 = #1Campo > " ";
  #1Campo = alfa1;
  |PINTA #1Campo;
|FPRC;

|PROCESO descri;
  salida = FSalida;
  |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
  |FINSI;
  |HAZ mayus;
  |SI #1#3 = "I"; #1#5 = "(Ingresos)   "; |FINSI;
  |SI #1#3 = "G"; #1#5 = "(Gastos)     "; |FINSI;
  |SI #1#3 = "V"; #1#5 = "(Inversion)  "; |FINSI;
  |SI #1#3 = "R"; #1#5 = "(Retenciones)"; |FINSI;
  |SI #1#3 = "S"; #1#5 = "(Suplidos)   "; |FINSI;
  |PINTA #1#5;

  |CAMPO_MODIFICA #1#4,1,"S";
  |CAMPO_MODIFICA #1#6,1,"S";
  |CAMPO_MODIFICA #1#7,1,"S";

  |SI #1#3 = "V";
      |CAMPO_MODIFICA #1#4,1,"N";
      |CAMPO_MODIFICA #1#6,1,"N";
      #1#4 = as; |PINTA #1#4;
      #1#6 = 1;  |PINTA #1#6;
  |FINSI;
  |SI #1#3 = "R";
      |CAMPO_MODIFICA #1#6,1,"N";
      |CAMPO_MODIFICA #1#7,1,"N";
      #1#7 = as; |PINTA #1#7;
      #1#6 = 1;  |PINTA #1#6;
  |FINSI;
  |SI #1#3 = "S";
      |CAMPO_MODIFICA #1#4,1,"N";
      #1#4 = as; |PINTA #1#4;
  |FINSI;
|FPRC;

|PROCESO mayus1;
  salida = FSalida;
  |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
  |FINSI;
  |HAZ mayus;
|FPRC;


|PROCESO versegundo; |TIPO 0;
  salida = FSalida;
  |SI salida = 9;
      |HAZ leecol_li;
      |ERROR;
      |ACABA;
  |FINSI;

 |SI salida ! 10; |ACABA; |FINSI;
 |SI #1#3 ! "I"; |Y #1#3 ! "G"; |Y #1#3 ! "S"; |ACABA; |FINSI;
 |PUSHV 06411763;
 |CUADRO 06 41 17 63;
 |ATRI R;
 |SI #1#3 = "I";
     |PINTA 0742 , "--COLUMNAS INGRESOS--";
 |SINO;
     |SI #1#3 = "G";
         |PINTA 0742 , "---COLUMNAS GASTOS---";
     |SINO;
         |PINTA 0742 , "--COLUMNAS SUPLIDOS--";
     |FINSI;
 |FINSI;
 || |PINTA 0739 , "---------------------";
 |PINTA 0842 , " 1 ";
 |PINTA 0942 , " 2 ";
 |PINTA 1042 , " 3 ";
 |PINTA 1142 , " 4 ";
 |PINTA 1242 , " 5 ";
 |PINTA 1342 , " 6 ";
 |PINTA 1442 , " 7 ";
 |PINTA 1542 , " 8 ";
 |PINTA 1642 , " 9 ";
 |SI #1#3 = "I"; y = 1;  |FINSI;
 |SI #1#3 = "G"; y = 19; |FINSI;
 |SI #1#3 = "S"; y = 37; |FINSI;
 p = 745;
 |PARA x = 1; |SI x [ 9; |HACIENDO x = x + 1;
       z = (x - 1) * 2 + y;
       alfa1 = #2z;
       z = z + 1;
       alfa1 = alfa1 + "/" + #2z + " ";
       p = p + 100;
       |PINTA p, alfa1;
 |SIGUE;
 |ATRI 0;
 |PAUSA;
 |POPV;
 |ERROR;
|FPRC;

|PROCESO leecol_li;
 lib= #0#0;
 descripcion= #0#1;
 |SUB_EJECUTA "caconlib";
 |ABRE #2;
 |DDEFECTO #2;
 #2#0 = #0#0;
 |LEE 040#2=;
 |CIERRA #2;
|FPRC;
