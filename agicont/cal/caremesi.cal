|FICHEROS;
   caremesi #0;
   camanban #1;
|FIN;

|VARIABLES;
   &entrada = 1;
   &contador = 0;
   &fichero  = "";
   &banco    = 0;
    riesgo   = 0;
   &quepant  = 0;
   &totrem   = 0;
   &noremesa = 0;

 &TotalAcum = 0;
 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|RUTINA inferior;
#0#0 = 1;
|FRUT;

|RUTINA superior;
#0#0 = contador;
|FRUT;

|PROGRAMA;

 |SI quepant = 0;
     |PINPA #0#0;
 |SINO;
     |PINPA #1#0;
     |C_V #0#9,1,"S";  |C_V #0#10,1,"S";
     |C_V #0#12,1,"S"; |C_V #0#13,1,"S";
     |C_P #0#0,1,1103; |C_P #0#1,1,1110;
     |C_P #0#2,1,1116; |C_P #0#3,1,1123;
     |C_P #0#4,1,1138; |C_P #0#5,1,1161;
     |C_P #0#6,1,1173; |C_P #0#7,1,1176;
     |C_P #0#8,1,1113;
     |C_P #0#15,1,2159; |C_V #0#15,1,"N";
 |FINSI;
 |HAZ leeban;
 #0#15 = totrem; TotalAcum = totrem;
 |SI quepant = 0; |PINTA 2148, #0#15; |FINSI;
 |SI quepant ! 0;
    ||  |PINTA 2159, #0#15;
 |FINSI;

 noremesa = 0;
 |NOME_DAT #0fichero;
 |ENTLINEAL #1#0, -1, 4, 20, 0, inferior, superior;
 |SI quepant = 1;
     |CONFI "2400SDesea hacer la Remesa : ";
     |SI FSalida ! 0; noremesa = 1;  |FINSI;
 |FINSI;
|FPRO;

|PROCESO pidetecl; |TIPO 11;
 |SI FSalida ! 9; |ACABA; |FINSI;
 |LIBERA #0;
 |LEE 110#0=;
 |SI quepant = 0;
     |SI #0#7 = "*";
         #0#7 = " ";
         TotalAcum = TotalAcum - #0#5;
     |SINO;
         #0#7 = "*";
         TotalAcum = TotalAcum + #0#5;
     |FINSI;
 |SINO;
     |SI #0#7 = "S";
         #0#7 = "N";
         TotalAcum = TotalAcum - #0#5;
     |SINO;
         #0#7 = "S";
         TotalAcum = TotalAcum + #0#5;
     |FINSI;
 |FINSI;
 |PINTA #0#7;
 |GRABA 020#0a;

 |SI #0#7 = "S"; |O #0#7 = "*";
     riesgo  = riesgo + #0#5;
     #1#13   = #1#13  + #0#5;
 |FINSI;
 |SI #0#7 = "N"; |O #0#7 = " ";
     riesgo  = riesgo - #0#5;
     #1#13   = #1#13  - #0#5;
 |FINSI;

 |SI quepant = 1;
     |ATRI I;  |PINTA 0822, #1#13;
 |FINSI;

 #0#15 = TotalAcum;
 |SI quepant = 0; |PINTA 2148, #0#15; |FINSI;
 |SI quepant ! 0;
     || |PINTA 2159, #0#15;
 |FINSI;

 |SI riesgo > #1#12;
     |MENAV "      Hemos sobrepasado el riesgo concedido";
 |SINO;
     |PTEC 809;
 |FINSI;
|FPRC;

|PROCESO leeban;
 |ABRE #1;
 #1#0 = banco;
 |LEE 040#1=;
 |SI FSalida = 0;
     riesgo  = #1#13 + totrem;
 |FINSI;
 |CIERRA #1;

 |SI quepant = 1;
     #1#13 = totrem;  || Esto es uan fantasmada para que el total
                      || remesa salga con millares en la pantalla.
                      || El #1#13 no va a cambiar su valor real.

     |ATRI I;  |PINTA 0822, #1#13;
 |FINSI;
|FPRC;
