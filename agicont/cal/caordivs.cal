|FICHEROS;
  caordivs #0;
  caivasop #1;    || iva soportado
  camaasil #2;    || apuntes lins.
  camanpag #3;    || pagos
  caivatmp #4;    || temporal ivas
  catmppag #5;    || temporal pagos
  camingli #6;    || Confirmes Lins
  capaglin #7;    || Pagares Lins
|FIN;

|VARIABLES;
  SerieAnt = "";
  nume1 = 0;
  FEstado = 0;
  ordena = 0;
  guarda = 0;
  feini = @;
  fefin = @;
  alfa1 = "";
|FIN;

|INCLUYE tempo_i;

|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

______________________________________________ACTUALIZA PAGOS
|PROCESO lee_pagos1;
  |DDEFECTO #3;
  #3#0  = #5#0;   #3#1  = #5#1;   #3#2 = #5#2;    #3#3  = #5#3;   #3#4  = #5#4;
  #3#5  = #5#5;   #3#6  = #5#6;   #3#7 = #5#7;    #3#8  = #5#8;   #3#9  = #5#9;
  #3#10 = #5#10;  #3#11 = #5#11;  #3#12 = #5#12;  #3#13 = #5#13;  #3#14 = #5#14;
  #3#15 = #5#15;  #3#16 = #5#16;  #3#17 = #5#17;  #3#18 = #5#18;  #3#19 = #5#19;
  #3#20 = #5#20;  #3#21 = #5#21;  #3#22 = #5#22;  #3#23 = #5#23;  #3#24 = #5#24;
  #3#25 = #5#25;  #3#26 = #5#26;  #3#27 = #5#27;  #3#28 = #5#28;
  #3#1 = #1#2;         || nuevo nro. de fra. en pagos
  |GRABA 020#3n;
|FPRC;

|DEFBUCLE lee_pagos;
 #5#1;
 ;
 #1#0, #1#27, guarda,   1;
 #1#0, #1#27, guarda, 999;
 e;
 NULL, lee_pagos1;
|FIN;
______________________________________________ACTUALIZA APUNTES
|PROCESO lee_apuntes1;
    #2#14 = ordena;      || nuevo nro. de fra. en apuntes
|GRABA 020#2a;
|LIBERA #2;
|FPRC;

|DEFBUCLE lee_apuntes;
 #2#1;
 13,14,15;
 #1#45, #1#46, #1#47,    1, #1#0, guarda, #1#27;
 #1#45, #1#46, #1#47, 9999, #1#0, guarda, #1#27;
 be;
 NULL, lee_apuntes1;
|FIN;
______________________________________________ACTUALIZA PAGARES
|PROCESO lee_pagares1;
 #7#3 = ordena;      || nuevo nro. de fra. en pagares
 |GRABA 020#7a;
 |LIBERA #7;
|FPRC;

|DEFBUCLE lee_pagares;
 #7#1;
 2,3,9;
 000001, 01, #1#0, guarda, #1#27;
 999999, 99, #1#0, guarda, #1#27;
 be;
 NULL, lee_pagares1;
|FIN;

______________________________________________ACTUALIZA PAGARES
|PROCESO lee_confirmes1;
 #6#3 = ordena;      || nuevo nro. de fra. en confirmes
 |GRABA 020#6a;
 |LIBERA #6;
|FPRC;

|DEFBUCLE lee_confirmes;
 #6#1;
 2,3,4;
 00001, 001, #1#0, guarda, #1#27;
 99999, 999, #1#0, guarda, #1#27;
 be;
 NULL, lee_confirmes1;
|FIN;

______________________________________________ACTUALIZA HISTORICO IVA
|PROCESO lee_tempo1;
  |SI SerieAnt ! #4#27;
     SerieAnt = #4#27;
     ordena = 1;
  |FINSI;

  #0#3 = #4#3;
  |PINTA #0#3;
  |DDEFECTO #1;
  #1#0  = #4#0;   #1#1  = #4#1;   #1#2  = #4#2;   #1#3  = #4#3;   #1#4  = #4#4;
  #1#5  = #4#5;   #1#6  = #4#6;   #1#7  = #4#7;   #1#8  = #4#8;   #1#9  = #4#9;
  #1#10 = #4#10;  #1#11 = #4#11;  #1#12 = #4#12;  #1#13 = #4#13;  #1#14 = #4#14;
  #1#15 = #4#15;  #1#16 = #4#16;  #1#17 = #4#17;  #1#18 = #4#18;  #1#19 = #4#19;
  #1#20 = #4#20;  #1#21 = #4#21;  #1#22 = #4#22;  #1#23 = #4#23;  #1#24 = #4#24;
  #1#25 = #4#25;  #1#26 = #4#26;  #1#27 = #4#27;  #1#28 = #4#28;  #1#29 = #4#29;
  #1#30 = #4#30;  #1#31 = #4#31;  #1#32 = #4#32;  #1#33 = #4#33;  #1#34 = #4#34;
  #1#35 = #4#35;  #1#36 = #4#36;  #1#37 = #4#37;  #1#38 = #4#38;  #1#39 = #4#39;
  #1#40 = #4#40;  #1#41 = #4#41;  #1#42 = #4#42;  #1#43 = #4#43;  #1#44 = #4#44;
  #1#45 = #4#45;  #1#46 = #4#46;  #1#47 = #4#47;  #1#48 = #4#48;  #1#49 = #4#49;
  #1#50 = #4#50;  #1#51 = #4#51;  #1#52 = #4#52;  #1#53 = #4#53;  #1#54 = #4#54;
  #1#55 = #4#55;  #1#56 = #4#56;  #1#57 = #4#57;  #1#58 = #4#58;  #1#59 = #4#59;
  #1#60 = #4#60;  #1#61 = #4#61;
  guarda = #1#2;       || para leer los pagos
  #1#2 = ordena;       || nuevo nro. de fra.
  |GRABA 020#1n;
  |BUCLE lee_apuntes;
  |BUCLE lee_pagares;
  |BUCLE lee_confirmes;
  |BUCLE lee_pagos;
  ordena = ordena + #0#2;
|FPRC;

|DEFBUCLE lee_temp1;
 #4#1;
 ;
 00, "  ", feini,      0, 00, feini,      0;
 99, "zz", fefin, 999999, 99, fefin, 999999;
 e;
 NULL, lee_tempo1;
|FIN;

|DEFBUCLE lee_temp2;
 #4#2;
 ;
 00, "  ", feini,      0, feini, 00,      0;
 99, "zz", fefin, 999999, fefin, 99, 999999;
 e;
 NULL, lee_tempo1;
|FIN;
______________________________________________GRABACION TEMPORAL PAGOS
|PROCESO tmp_pagos1;         || temporal de pagos
  |DDEFECTO #5;
  #5#0  = #3#0;   #5#1  = #3#1;   #5#2  = #3#2;   #5#3  = #3#3;   #5#4  = #3#4;
  #5#5  = #3#5;   #5#6  = #3#6;   #5#7  = #3#7;   #5#8  = #3#8;   #5#9  = #3#9;
  #5#10 = #3#10;  #5#11 = #3#11;  #5#12 = #3#12;  #5#13 = #3#13;  #5#14 = #3#14;
  #5#15 = #3#15;  #5#16 = #3#16;  #5#17 = #3#17;  #5#18 = #3#18;  #5#19 = #3#19;
  #5#20 = #3#20;  #5#21 = #3#21;  #5#22 = #3#22;  #5#23 = #3#23;  #5#24 = #3#24;
  #5#25 = #3#25;  #5#26 = #3#26;  #5#27 = #3#27;  #5#28 = #3#28;
  |GRABA 020#5n;
  |BORRA 020#3a;
  |LIBERA #3;
|FPRC;

|DEFBUCLE tmp_pagos;
 #3#1;
 ;
 #1#0, #1#27, #1#2,   1;
 #1#0, #1#27, #1#2, 999;
 be;
 NULL, tmp_pagos1;
|FIN;
______________________________________________GRABACION TEMPORAL IVA
|PROCESO gra_tempo1;          || temporal de iva
  |DDEFECTO #4;
  #4#0  = #1#0;   #4#1  = #1#1;   #4#2  = #1#2;   #4#3  = #1#3;   #4#4  = #1#4;
  #4#5  = #1#5;   #4#6  = #1#6;   #4#7  = #1#7;   #4#8  = #1#8;   #4#9  = #1#9;
  #4#10 = #1#10;  #4#11 = #1#11;  #4#12 = #1#12;  #4#13 = #1#13;  #4#14 = #1#14;
  #4#15 = #1#15;  #4#16 = #1#16;  #4#17 = #1#17;  #4#18 = #1#18;  #4#19 = #1#19;
  #4#20 = #1#20;  #4#21 = #1#21;  #4#22 = #1#22;  #4#23 = #1#23;  #4#24 = #1#24;
  #4#25 = #1#25;  #4#26 = #1#26;  #4#27 = #1#27;  #4#28 = #1#28;  #4#29 = #1#29;
  #4#30 = #1#30;  #4#31 = #1#31;  #4#32 = #1#32;  #4#33 = #1#33;  #4#34 = #1#34;
  #4#35 = #1#35;  #4#36 = #1#36;  #4#37 = #1#37;  #4#38 = #1#38;  #4#39 = #1#39;
  #4#40 = #1#40;  #4#41 = #1#41;  #4#42 = #1#42;  #4#43 = #1#43;  #4#44 = #1#44;
  #4#45 = #1#45;  #4#46 = #1#46;  #4#47 = #1#47;  #4#48 = #1#48;  #4#49 = #1#49;
  #4#50 = #1#50;  #4#51 = #1#51;  #4#52 = #1#52;  #4#53 = #1#53;  #4#54 = #1#54;
  #4#55 = #1#55;  #4#56 = #1#56;  #4#57 = #1#57;  #4#58 = #1#58;  #4#59 = #1#59;
  #4#60 = #1#60;  #4#61 = #1#61;
  |GRABA 020#4n;      || graba en el temporal iva
  |BORRA 020#1a;      || borra en el historico iva
  |LIBERA #1;
  |BUCLE tmp_pagos;
|FPRC;

|DEFBUCLE gra_tempo;
 #1#1;
 ;
 #0#0, "  ",      1;
 #0#1, "zz", 999999;
 be;
 NULL, gra_tempo1;
|FIN;

______________________________________________PROCESO PRINCIPAL
|PROCESO ordena; |TIPO 3;
  |SI #0#4 ! "SI";  |ACABA;  |FINSI;
  |NOPARA;

    |HAZ nom_usu;
    alfa1 = "S" + nom_tmp;
    |NOME_DAT #4 alfa1;

    |HAZ nom_usu;
    alfa1 = "P" + nom_tmp;
    |NOME_DAT #5 alfa1;

    |ABRE #4;
    |CIERRA #4;
    |DELINDEX #4;
    |ABRE #5;
    |CIERRA #5;
    |DELINDEX #5;

  |ATRI P;  |PINTA 1063, "<TEMPORALES>";  |ATRI 0;
  |ABRE #4;
  |ABRE #5;
  |BUCLE gra_tempo;
  |CIERRA #4;
  |CIERRA #5;
  |PINTA 1063, "            ";
  ordena = 1;
  |ABRE #1;
  |ABRE #3;
  feini = "00.00.0000";
  fefin = "31.12.8999";
  |SI #0#5 = 1; |BUCLE lee_temp1; |FINSI;
  |SI #0#5 = 2; |BUCLE lee_temp2; |FINSI;
  |CIERRA #1;
  |CIERRA #3;
  |DELINDEX #4;
  |DELINDEX #5;
  |SI ordena = 1;
      |MENAV "    Seleccion vacia ...";
  |FINSI;

  |SIPARA;
|FPRC;
