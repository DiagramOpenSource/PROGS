|FICHEROS;
  cacongru #0;
  caconcep #1;
|FIN;

|VARIABLES;
  men1   = "    SNo existe Concepto. ¨Desea darlo de Alta? : ";
  men2   = "    Numero de Concepto repetido !. ";
  men3   = "    Grupo sin Conceptos !. ";
  xx = 0;
  yy = 0;
  zz = 0;
  swnoalta = 0;
  swalgun = 0;
  modo = 0;
  blanco = "                              ";
  salida = 0;
  antes = 0;
    &entrada = 1;
    registro = 0;
    informe = "cacongru";
    {-1}menu  = "";           || Variables menu Detallado o Resumido
        menu1 = "2400";
        menu2 = "1";
        menu3 = "Elija : ";
        menu4 = "RD";
        menu5 = " Resumido ";
        menu6 = " Detallado ";
  &swLinea = 0;
  &swLine1 = 0;
  &swLine2 = 0;
  &swLine3 = 0;
  &swLine4 = 0;
  &swLine5 = 0;
|FIN;

|INCLUYE acces2_i;

|PROCESO conficha;
  |SI FSalida ! 9; |ACABA; |FINSI;
  |ABRE #1;
    |PUSHV 0501 2380;
    |PINPA #0#1;
  antes = 0;
  yy = Campo;
  #1#0 = #0Campo;
  |LEE 000#1];
  |CONSULTA #0#1;
  salida = FSalida;
     |CIERRA #1;
     |POPV;
  |SI salida = 0;
      #0yy = #1#0;
      |PINTA #0yy;
  |SINO;
      antes = 1;
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO escero; |TIPO 7;
 zz = Campo - 1;
 |CAMPO_MODIFICA #0Campo, 1, "S";
 modo = (FEntrada / 100 ) ! 0;
 |SI modo = 2; |ACABA; |FINSI;
 |SI #0zz = 0;
     |CAMPO_MODIFICA #0Campo, 1, "N";
 |FINSI;
|FPRC;

|PROCESO leecon; |TIPO 0;
 |SI FSalida = 9; |O FSalida = 2; |ACABA; |FINSI;
 |SI antes = 1; |ACABA; |FINSI;
 modo = (FEntrada / 100 ) ! 0;
 swnoalta = 0;
 xx = Campo + 20;
 zz = Campo + 1;
 |SI #0Campo = 0;
     || |SI Campo ! 21;
     ||    |SI #0zz ! 0;
     ||        |ERROR;
     ||        |ACABA;
     ||    |FINSI;
     || |FINSI;
     #0xx = blanco;
     |PINTA #0xx;
     |ACABA;
 |FINSI;

 |ABRE #1;
 #1#0 = #0Campo;
 |LEE 011#1=;
 |SI FSalida = 0;
     #0Campo = #1#0;
     #0xx    = #1#1;
     |PINTA #0Campo;
     |PINTA #0xx;
  |SINO;
      |HAZ altacon;
  |FINSI;
  |CIERRA #1;
  |SI swnoalta = 1; |ERROR; |FINSI;
|FPRC;

|PROCESO altacon;
    swnoalta = 1;
    |CONFI men1;
    |SI FSalida = 0;
        |PUSHV 0501 2380;
        |PINPA #0#1;
        |DDEFECTO #1;
        #1#0 = #0Campo;
        |PINTA #1#0;
        |PINDA #0#1;
        |ENDATOS #1#1;
        |SI FSalida = 0;
            |POPV;
            #0Campo = #1#0;
            #0xx = #1#1;
            |PINTA #0Campo;
            |PINTA #0xx;
            |GRABA 020#1n;                 || Graba concepto
            swnoalta = 0;
        |SINO;
            |POPV;
        |FINSI;
    |FINSI;
 |LIBERA #1;
|FPRC;

|PROCESO norepite; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;
 |SI #0Campo = 0; |ACABA; |FINSI;
 |PARA zz = Campo - 1; |SI zz ] 2; |HACIENDO zz = zz - 1;
       |SI #0zz = #0Campo;
           |MENAV men2;
           |ERROR;
           |SAL;
       |FINSI;
 |SIGUE;
 |PARA zz = Campo + 1; |SI zz [ 21; |HACIENDO zz = zz + 1;
       |SI #0zz = #0Campo;
           |MENAV men2;
           |ERROR;
           |SAL;
       |FINSI;
 |SIGUE;
|FPRC;

|PROCESO veralgun; |TIPO 3;
 swalgun = 0;
 modo = (FEntrada / 100 ) ! 0;
 |SI modo = 3; |ACABA; |FINSI;
 |ABRE #1;
 |PARA zz = 2; |SI zz [ 21; |HACIENDO zz = zz + 1;
       |SI #0zz ! 0;
           #1#0 = #0zz;
           |LEE 011#1=;
           |SI FSalida = 0;
               swalgun = 1;
               |SAL;
           |FINSI;
       |FINSI;
  |SIGUE;
  |CIERRA #1;

  |SI swalgun = 0;
      |MENAV men3;
      |ERROR;
  |FINSI;
|FPRC;

|| ---- Calculo para imprimir

|PROCESO impre;
 swLinea = 0;
 swLine1 = 0;
 swLine2 = 0;
 swLine3 = 0;
 swLine4 = 0;
 swLine5 = 0;
 |PARA zz = 2; |SI zz [ 21; |HACIENDO zz = zz + 1;
       |SI #0zz ! 0;
           |SI zz [  5;             swLine1 = 1; |FINSI;
           |SI zz ]  6; |Y zz [  9; swLine2 = 1; |FINSI;
           |SI zz ] 10; |Y zz [ 13; swLine3 = 1; |FINSI;
           |SI zz ] 14; |Y zz [ 17; swLine4 = 1; |FINSI;
           |SI zz ] 18;             swLine5 = 1; |FINSI;
           |SI zz ] 11;             swLinea = 1; |FINSI;
       |FINSI;
 |SIGUE;
|PRINT;
|FPRC;

|DEFBUCLE cacongru0;
 #0#1;
 ;
 01;
 99;
 e;
 NULL, impre;
|FIN;

|PROCESO imprimir;|TIPO 4;
  |HAZ inicio2;
  registro = #0#0;

  |MENU menu;
  |SI FSalida ! 1; |Y FSalida ! 2; |ACABA; |FINSI;
  |SI FSalida = 1;
      informe = "cacongr1";
  |SINO;
      informe = "cacongr2";
  |FINSI;

  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;

  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

  |BUCLE cacongru0;
  |PIEINF;
  |FININF;
  |ABRE #0;
  #0#0 = registro;
  |FINIMP;
|FPRC;
