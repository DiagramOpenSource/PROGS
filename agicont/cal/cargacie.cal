|FICHEROS;
    caplciec #0;
    caplciel #1;
    cacuenta #2;
|FIN;;

|VARIABLES;
    &entrada = 1;
    &swpanta = 0;
    &swcalcu = 0;
    alfa1   = "";
    sumapar = 0;
    uno     = "";
    dos     = "";
    signo   = "";
    &algun   = 0;
    num1    = 0;
 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|| *********************************************************************
|PROCESO cal_ctas2;
 |SI signo = "D";
     sumapar = sumapar + (#2#53 - #2#50)
 |SINO;
     sumapar = sumapar - (#2#53 - #2#50)
 |FINSI;
|FPRC;

|DEFBUCLE lee_ctas;
 #2#1;
 3;
 #1#2, 0, "S";
 dos,  9, "S";
 e;
 NULL, cal_ctas2;
|FIN;

|PROCESO buscacta;
   sumapar = 0;
   uno = #1#2;
   |QBF uno;
   dos = uno + "999999999999";
   dos = dos % A112;
   signo = #1#3;
   |BUCLE lee_ctas;
   #0#2 = #0#2 + sumapar;
|FPRC;

|PROCESO calsal;
 #0#2 = 0;
 |BUCLELIN 2buscacta#0;
 |GRABA 020#0a;
 |LIBERA #0;
 algun = 1;
|FPRC;

|DEFBUCLE calculo;
 #0#1;
 ;
 00;
 99;
 e;
 NULL, calsal;
|FIN;

|| **************************************************************************
|RUTINA min;
 #0#0 = 1;
|FRUT;

|RUTINA max;
 #0#0 = 99;
|FRUT;

|PROGRAMA;
 |SI swcalcu = 0;
     algun = 0;
     |BUCLE calculo;
     swcalcu = 1;
 |FINSI;

 |SI algun = 0; |ACABA; |FINSI;

 |SI swpanta = 1;
     |PINPA #0#0;
     |ENTLINEAL #1#0, 1, 4, 13, 0, min, max;
 |FINSI;
 |SI swpanta = 0;
     |HAZ muevecam;
     |PINPA #1#0;
     |ENTLINEAL #1#0, 1, 4, 22, 0, min, max;
 |FINSI;
|FPRO;

|PROCESO muevecam;
 |C_P #0#0,0,num1; num1 = num1 + 928; |C_P #0#0,1,num1;
 |C_P #0#1,0,num1; num1 = num1 + 928; |C_P #0#1,1,num1;
 |C_P #0#2,0,num1; num1 = num1 + 928; |C_P #0#2,1,num1;
|FPRC;
