|FICHEROS;
     caems347;
     camac347;
     camal347;
     camic347;
     camil347;
     camal348;
     caportad;

     t1434701;
     t1434702;
     t1434703;
|FIN;

|VARIABLES;
     TDeclarantes  = 0;
     TDeclarados   = 0;
     TInmuebles    = 0;
     TotalA        = 0;
     TotalB        = 0;
     TotalC        = 0;
     TotalD        = 0;
     TotalE        = 0;
     TInm          = 0;
     TotalF        = 0;
     TotalG        = 0;
     TLinea        = 0;
     Cambio        = 0;
     Redond        = 0;
     SwError       = 0;
     Calc          = 0;
     nEspa         = 0;
     nLong      = 0;
     nPos       = 0;
     Comodin    = "";
     Comodin1   = "";
     aCadena    = "";
     Cadena1    = "";
     aLong      = "";
     aCaracter  = "";
     nTOperacion = 0;
     nTecla      = 0;

     VAlfa      = "";
     VAlfa1     = "";
     VAlfa2     = "";
     VAlfa3     = "";
     VAlfa4     = "";

     aTecla     = "";
     Letras     = "";
     Compl      = "";
     Refer      = "";

     Clave      = "";
     Contador   = 0;
     ModoModi   = "";
     SwLee      = 0;
     Fichero1   = "";
     FicheroD   = "";
     Path       = "";
     aTipo      = "";

     CampoDni   = "";
     Letra1     = "";
     Letra2     = "";
     Letra3     = "";
     Letra4     = "";
     Letra5     = "";
     Letra6     = "";
     Letra7     = "";
     Letra8     = "";
     Caracter   = "";
     Carac1     = 0;
     Carac2     = 0;
     Carac3     = 0;
     Carac4     = 0;
     Carac5     = 0;

     aAlfa       = "";
     aAbre       = "";

     nSwError    = 0;
     nCanal      = 0;
     nHandle     = 0;
     nTipo1      = 0;
     nTipo2      = 0;
     nSwInm      = 0;

     aFicheroTxt  = "";
     aFicheroCar  = "";
     aPathLocal   = "";
     aIPRemoto    = "";
     nEmpresa     = 0;
     nEjerDos     = 0;
     nSwLinea     = 0;
     nCobro       = 0;
     aEjerCobro   = "";
     nNume1       = 0;
     nTopeCobro   = 0;
     nHCampo      = 0;
     nNume        = 0;

     &eaFichDatos    = "";
     &eaFichAuxil    = "";
     &eaFichError    = "";
     &enValidacion   = 0;
     &enError        = 0;
     &eaTipoE        = "";
     &eaTipoR        = "";
     &eaTipoP        = "";
     &eaTipoC        = "";
     &eaTipoA        = "";
     &eaTipoV        = "";
     &eaModoImpre    = "";
     &eaModelos      = "";
     &eaEjer         = "";
     &eaPeriodo      = "";
     &eaVarDni       = "";
     &enCalcCif      = 0;
     &enNume         = 0;

     &eaUnidadBasico     = "";
     &eaPathEmision      = "";
     &eaPathLanza        = "";
     &eaPathExplorador   = "";
     &eaPathInternet     = "";
     &eaFicheroPlano     = "";
     &eaOpcion           = "";
     &enErrorPortal      = 0;
     &eaFicheroImpre     = "";
     &eaFicheroSalid     = "";
     &eaFicheroError     = "";
     &enEmpresa          = 0;
     &eaNomEmpresa       = "";
     &enPresentar        = 0;
     &eaCampo0     = "";
     &eaCampo1     = "";
     &eaCampo2     = "";
     &eaCampo3     = "";
     &eaCampo4     = "";
     &eaAlfa       = "";
     &eaJusti      = "";

     &eaMoneda = "";

     &eaPaisCCE = "";
     &eSwPaisCCE = 0;
|FIN;

|INCLUYE i_laserc;

|PROCESO ComparaSiglas_02;
    |QBF aAlfa; aAlfa = aAlfa > " ";
    |SI aAlfa = "AL";  aAlfa = "ALAM ";  |FINSI;
    |SI aAlfa = "AD";  aAlfa = "ALDEA";  |FINSI;
    |SI aAlfa = "AP";  aAlfa = "APTOS";  |FINSI;
    |SI aAlfa = "AR";  aAlfa = "ARRAL";  |FINSI;
    |SI aAlfa = "AY";  aAlfa = "ARRY ";  |FINSI;
    |SI aAlfa = "AV";  aAlfa = "AVDA ";  |FINSI;
    |SI aAlfa = "BJ";  aAlfa = "BJADA";  |FINSI;
    |SI aAlfa = "BR";  aAlfa = "BRANC";  |FINSI;
    |SI aAlfa = "BO";  aAlfa = "BARRO";  |FINSI;
    |SI aAlfa = "BL";  aAlfa = "BLQUE";  |FINSI;
    |SI aAlfa = "CL";  aAlfa = "CALLE";  |FINSI;
    |SI aAlfa = "CJ";  aAlfa = "CLLJA";  |FINSI;
    |SI aAlfa = "CM";  aAlfa = "CMNO ";  |FINSI;
    |SI aAlfa = "CR";  aAlfa = "CTRA ";  |FINSI;
    |SI aAlfa = "CS";  aAlfa = "CSRIO";  |FINSI;
    |SI aAlfa = "CO";  aAlfa = "COL  ";  |FINSI;
    |SI aAlfa = "CN";  aAlfa = "CJTO ";  |FINSI;
    |SI aAlfa = "CT";  aAlfa = "CUSTA";  |FINSI;
    |SI aAlfa = "CH";  aAlfa = "CHLET";  |FINSI;
    |SI aAlfa = "ED";  aAlfa = "EDIFC";  |FINSI;
    |SI aAlfa = "EN";  aAlfa = "ENTD ";  |FINSI;
    |SI aAlfa = "ES";  aAlfa = "ESCAL";  |FINSI;
    |SI aAlfa = "EX";  aAlfa = "EXPLA";  |FINSI;
    |SI aAlfa = "EM";  aAlfa = "EXTRM";  |FINSI;
    |SI aAlfa = "ER";  aAlfa = "EXTRR";  |FINSI;
    |SI aAlfa = "GL";  aAlfa = "GTA  ";  |FINSI;
    |SI aAlfa = "GV";  aAlfa = "G.V. ";  |FINSI;
    |SI aAlfa = "GR";  aAlfa = "GRUPO";  |FINSI;
    |SI aAlfa = "JR";  aAlfa = "JDIN ";  |FINSI;
    |SI aAlfa = "LG";  aAlfa = "LUGAR";  |FINSI;
    |SI aAlfa = "MS";  aAlfa = "MASIA";  |FINSI;
    |SI aAlfa = "MC";  aAlfa = "MERC ";  |FINSI;
    |SI aAlfa = "MT";  aAlfa = "MONTE";  |FINSI;
    |SI aAlfa = "ML";  aAlfa = "MUELL";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PD";  aAlfa = "PTDA ";  |FINSI;
    |SI aAlfa = "PJ";  aAlfa = "PSAJE";  |FINSI;
    |SI aAlfa = "PS";  aAlfa = "PASEO";  |FINSI;
    |SI aAlfa = "PZ";  aAlfa = "PLAZA";  |FINSI;
    |SI aAlfa = "PB";  aAlfa = "PBDO ";  |FINSI;
    |SI aAlfa = "PG";  aAlfa = "POLIG";  |FINSI;
    |SI aAlfa = "PR";  aAlfa = "PROL ";  |FINSI;
    |SI aAlfa = "PT";  aAlfa = "PNTE ";  |FINSI;
    |SI aAlfa = "PU";  aAlfa = "PTA  ";  |FINSI;
    |SI aAlfa = "RM";  aAlfa = "RAMAL";  |FINSI;
    |SI aAlfa = "RB";  aAlfa = "RBLA ";  |FINSI;
    |SI aAlfa = "RP";  aAlfa = "RAMPA";  |FINSI;
    |SI aAlfa = "RR";  aAlfa = "RIERA";  |FINSI;
    |SI aAlfa = "RC";  aAlfa = "RCON ";  |FINSI;
    |SI aAlfa = "RD";  aAlfa = "RONDA";  |FINSI;
    |SI aAlfa = "RU";  aAlfa = "RUA  ";  |FINSI;
    |SI aAlfa = "SC";  aAlfa = "SECT ";  |FINSI;
    |SI aAlfa = "SD";  aAlfa = "SENDA";  |FINSI;
    |SI aAlfa = "SB";  aAlfa = "SBIDA";  |FINSI;
    |SI aAlfa = "TO";  aAlfa = "TRRNT";  |FINSI;
    |SI aAlfa = "TR";  aAlfa = "TRVA ";  |FINSI;
    |SI aAlfa = "UR";  aAlfa = "URB  ";  |FINSI;
    |SI aAlfa = "VI";  aAlfa = "VIA  ";  |FINSI;
    |SI aAlfa = "VP";  aAlfa = "VIA  ";  |FINSI;

    |SI aAlfa = "";  aAlfa = "CALLE";  |FINSI;
    aAlfa = (aAlfa + "     ") % 105;
|FPRC;

|PROCESO AnalizaCadena;
|FPRC;

|PROCESO QuitaRarosTfno347;
|FPRC;

|PROCESO CargaT1434703;
     |DDEFECTO #t1434703;

     #t1434703#0  = "2";
     #t1434703#1  = "347";
     #t1434703#2  = eaEjer;
     eaAlfa  = #caportad#13;  |QBF eaAlfa;         #t1434703#3  = ("000000000" + eaAlfa) % -109;

     eaAlfa  = #camil347#2;   |QBF eaAlfa;
     |SI eaAlfa ! "";
         #t1434703#4  = ("000000000" + eaAlfa) % -109;
     |FINSI;

     eaAlfa       = #camil347#3;   |HAZ QuitaRaros;
     #t1434703#6  = eaAlfa;
     #t1434703#7  = "I";

     enNume       = #camil347#4;  |HAZ Conver15;
     #t1434703#9  = eaAlfa;

     #t1434703#10  = #camil347#17;
     #t1434703#11  = #camil347#15;

     aAlfa = #camil347#5;  |HAZ ComparaSiglas_02;
     #t1434703#12  = aAlfa;

     eaAlfa    = #camil347#6;     |HAZ QuitaRaros;
     #t1434703#13  = eaAlfa;

     #t1434703#14  = "NUM";

     eaAlfa        = #camil347#7; |QBT eaAlfa;
     eaAlfa        = ("00000" + eaAlfa) % -105;
     #t1434703#15  = eaAlfa;

     #t1434703#19  = #camil347#8;
     #t1434703#20  = #camil347#9;
     #t1434703#21  = #camil347#10;
     eaAlfa    = #camil347#14;  |HAZ QuitaRaros;
     #t1434703#24  = eaAlfa;
     #t1434703#25  = #camil347#18;

     #t1434703#26 = ("00" + #camil347#11) % -102;
     #t1434703#27 = (("00" + #camil347#11) % -102) + (("000" + #camil347#12) % -103);
     #t1434703#29 = &13 + &10;

                          nHCampo = 29;
     |SI eaOpcion ! "3";  nHCampo = 28;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434703#nCampo#;
          |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;

|PROCESO CargaT1434702;
     |DDEFECTO #t1434702;

     #t1434702#0 = "2";
     #t1434702#1 = "347";
     #t1434702#2 = eaEjer;
     eaAlfa  = #caportad#13;   |QBF eaAlfa;         #t1434702#3  = ("000000000" + eaAlfa) % -109;

||     |SI #camal347#9 = 99;
||         #camal347#3 = "";
||     |FINSI;

     |SI #camal347#15 = "N";
         eaAlfa   = #camal347#3;   |QBF eaAlfa;    #t1434702#4  = ("000000000" + eaAlfa) % -109;
     |FINSI;

     |SI #camal347#9 = 99;       || es extranjero, tique 4655_87
         #t1434702#4  = "";
         eaPaisCCE    = #camal347#16; |HAZ PaisCCE;
         |SI eSwPaisCCE = 1;
             aAlfa        = (#camal347#16 % 102) + #camal347#3;  |QBT aAlfa;
             #t1434702#26 = aAlfa;
         |FINSI;
     |FINSI;

     eaAlfa       = #camal347#4;   |HAZ QuitaRaros;
     #t1434702#6  = eaAlfa;
     #t1434702#7  = "D";

     eaAlfa       = ("00" + #camal347#9) % -102;
     #t1434702#8  = eaAlfa;

     |SI #camal347#9 = 99;
         #t1434702#9  =  #camal347#16 % 102;
     |FINSI;

     #t1434702#10 = "";

     |SI #camal347#2 = 2; #t1434702#11 = "A"; |FINSI;
     |SI #camal347#2 = 1; #t1434702#11 = "B"; |FINSI;
     |SI #camal347#2 = 3; #t1434702#11 = "C"; |FINSI;
     |SI #camal347#2 = 4; #t1434702#11 = "D"; |FINSI;
     |SI #camal347#2 = 5; #t1434702#11 = "E"; |FINSI;
     |SI #camal347#2 = 6; #t1434702#11 = "F"; |FINSI;
     |SI #camal347#2 = 7; #t1434702#11 = "G"; |FINSI;

     enNume       = #camal347#5;  |HAZ Conver16Signo;
     #t1434702#12 = eaAlfa;

     |SI #camal347#13 = "S";  #t1434702#13 = "X";  |FINSI;
     |SI #camal347#14 = "S";  #t1434702#14 = "X";  |FINSI;

     |SI nCobro ! 0;
         enNume = nCobro;   |HAZ Conver15;
         #t1434702#15 = eaAlfa;
         #t1434702#17 = aEjerCobro;
     |FINSI;

     enNume   = #camal347#18;  |HAZ Conver16Signo;  #t1434702#16 = eaAlfa;
     enNume   = #camal347#20;  |HAZ Conver16Signo;  #t1434702#18 = eaAlfa;
     enNume   = #camal347#24;  |HAZ Conver16Signo;  #t1434702#19 = eaAlfa;
     enNume   = #camal347#21;  |HAZ Conver16Signo;  #t1434702#20 = eaAlfa;
     enNume   = #camal347#25;  |HAZ Conver16Signo;  #t1434702#21 = eaAlfa;
     enNume   = #camal347#22;  |HAZ Conver16Signo;  #t1434702#22 = eaAlfa;
     enNume   = #camal347#26;  |HAZ Conver16Signo;  #t1434702#23 = eaAlfa;
     enNume   = #camal347#23;  |HAZ Conver16Signo;  #t1434702#24 = eaAlfa;
     enNume   = #camal347#27;  |HAZ Conver16Signo;  #t1434702#25 = eaAlfa;

     |SI #camal347#30 = "S";  #t1434702#27 = "X";  |FINSI;
     |SI #camal347#28 = "S";  #t1434702#28 = "X";  |FINSI;
     |SI #camal347#29 = "S";  #t1434702#29 = "X";  |FINSI;

     enNume = #camal347#31;  |HAZ Conver16Signo;  #t1434702#30 = eaAlfa;

     #t1434702#32 = &13 + &10;

                          nHCampo = 32;
     |SI eaOpcion ! "3";  nHCampo = 31;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434702#nCampo#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
     nSwLinea = 1;
|FPRC;

|PROCESO Registro4_02;
     |SI #camal348#3 > nTopeCobro;
         nCobro     = #camal348#3;
         aEjerCobro = ("0000" + #camal348#2) % -104;  || ejercicio del cobro
         |SI nSwLinea ! 0;
             #camal347#5  = 0;
             #camal347#18 = 0;
             #camal347#19 = 0;
             #camal347#20 = 0;
             #camal347#21 = 0;
             #camal347#22 = 0;
             #camal347#23 = 0;
             #camal347#24 = 0;
             #camal347#25 = 0;
             #camal347#26 = 0;
             #camal347#27 = 0;
         |FINSI;

         |HAZ CargaT1434702;
     |FINSI;
|FPRC;

|DEFBUCLE Registro4_02;
    #camal348#1;
    ;
    #camal347#0, #camal347#1, 2990;
    #camal347#0, #camal347#1, 2008;
    e;
    NULL, Registro4_02;
|FIN;

|PROCESO Tipo2_2012;
     aEjerCobro = "0000";
     nCobro     = #camal347#17;
     |SI #camal347#17 ! 0; aEjerCobro = ("0000" + #caems347#2) % -104; |FINSI;

     nSwLinea = 0;
     |SI #camal347#2 = 1; |O #camal347#2 = 2;
         |SI #camal347#5 ! 0;  |HAZ CargaT1434702; |FINSI;
         |BUCLE Registro4_02;
     |SINO;
         |HAZ CargaT1434702;
     |FINSI;
|FPRC;

|DEFBUCLE grlin_2012;
     #camal347#2;
     0;
     nTipo1, "            ", #caems347#0;
     nTipo2, "zzzzzzzzzzzz", #caems347#0;
     ;
     NULL, Tipo2_2012;
|FIN;

|PROCESO camal347_2012;
     nTipo1 = 2;
     nTipo2 = 2;
     |BUCLE grlin_2012; || las lineas - registro de operaciones

     nTipo1 = 1;
     nTipo2 = 1;
     |BUCLE grlin_2012; || las lineas - registro de operaciones

     nTipo1 = 3;
     nTipo2 = 9;
     |BUCLE grlin_2012; || las lineas - registro de operaciones
|FPRC;

|PROCESO Registro4;
     |SI #camal348#3 > nTopeCobro;
         nNume1 = nNume1 + 1;
     |FINSI;
|FPRC;

|DEFBUCLE Registro4;
    #camal348#1;
    ;
    #camal347#0, #camal347#1, 2990;
    #camal347#0, #camal347#1, 2008;
    e;
    NULL, Registro4;
|FIN;

|PROCESO TotalDecl;
     || TLinea = (#camal347#5 / Cambio) ! Redond;
     TLinea = #camal347#5;
     |SI #camal347#2 = "1"; TotalA = TotalA + TLinea; |FINSI;
     |SI #camal347#2 = "2"; TotalB = TotalB + TLinea; |FINSI;
     |SI #camal347#2 = "3"; TotalC = TotalC + TLinea; |FINSI;
     |SI #camal347#2 = "4"; TotalD = TotalD + TLinea; |FINSI;
     |SI #camal347#2 = "5"; TotalE = TotalE + TLinea; |FINSI;
     |SI #camal347#2 = "6"; TotalF = TotalF + TLinea; |FINSI;
     |SI #camal347#2 = "7"; TotalG = TotalG + TLinea; |FINSI;

     TDeclarados  = TDeclarados + 1;

     |SI enAnyo ] 2010;
         |SI #camal347#2 = 1; |O #camal347#2 = 2;
             nNume1 = 0;
             |SI #camal347#5 ! 0; nNume1 = 1; |FINSI;
             |BUCLE Registro4;
             |SI #camal347#2= 2; #camac347#6 = #camac347#6 + nNume1; |FINSI;
             |SI #camal347#2= 1; #camac347#8 = #camac347#8 + nNume1; |FINSI;
         |FINSI;
     |FINSI;

     |SI #camal347#2 ] "1"; |O  #camal347#2 [ "7";
         nTOperacion  = nTOperacion + ((#camal347#5 / Cambio) ! Redond);
     |FINSI;
|FPRC;

|DEFBUCLE TotalDecl;
     #camal347#1;
     ;
     nEmpresa,00001;
     nEmpresa,99999;
     ;
     NULL, TotalDecl;
|FIN;

|PROCESO TotalInm;
     TLinea     = (#camil347#4 / Cambio) ! Redond;
     TInm       = TInm + TLinea;
     TInmuebles = TInmuebles + 1;
|FPRC;

|DEFBUCLE TotalInm;
     #camil347#1;
     ;
     nEmpresa,00001;
     nEmpresa,99999;
     ;
     NULL, TotalInm;
|FIN;

|PROCESO CargaT1434701;
     |DDEFECTO #t1434701;

                                                   #t1434701#0  = "1";
                                                   #t1434701#1  = "347";
                                                   #t1434701#2  = eaEjer;
     eaAlfa  = #caportad#13;  |QBF eaAlfa;         #t1434701#3  = ("000000000" + eaAlfa) % -109;
     eaAlfa  = #caportad#2;   |HAZ QuitaRaros;     #t1434701#4  = eaAlfa;
                                                   #t1434701#5  = "T";
     eaAlfa  = #caportad#90 + #caportad#91;  |QBT eaAlfa;  |HAZ QuitaRarosTfno;
                                                   #t1434701#6  = eaAlfa;
     eaAlfa  = #caportad#89;  |HAZ QuitaRaros;     #t1434701#7  = eaAlfa;

     #t1434701#8  = "3470000000000";
     || |SI enDirecta = 1;
         |HAZ CalcJustificante;
         #t1434701#8 = eaJusti;
     || |FINSI;

     |SI #camac347#18 = "C";
         #t1434701#9  = "C";
         #t1434701#11 = #camac347#19;
     |FINSI;

     |SI #camac347#18 = "S";
         #t1434701#10 = "S";
         #t1434701#11 = #camac347#19;
     |FINSI;

     nNume = #camac347#6 + #camac347#8 + #camac347#10 + #camac347#12 + #camac347#14;
     nNume = nNume + #camac347#20 + #camac347#22;
     #t1434701#12 = ("000000000" + nNume) % -109;

     enNume    = nTOperacion ! 2;
     |HAZ Conver16Signo;
     #t1434701#13 = eaAlfa;

     #t1434701#14 = ("000000000" + #camic347#2) % -109;

     enNume  = TInm;
     |HAZ Conver16Signo;
     #t1434701#15 = eaAlfa;

     #t1434701#19 = &13 + &10;

                          nHCampo = 19;
     |SI eaOpcion ! "3";  nHCampo = 18;  |FINSI;

     aAlfa = "";
     |PARA nCampo = 0;  |SI nCampo [ nHCampo;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #t1434701#nCampo#;
           |XGRABA nHandle, aAlfa;
     |SIGUE;
|FPRC;


|PROCESO camac347_02;
     |ABRE #camac347;
     |LEE 001#camac347.p;
     |SI FSalida ! 0; |CIERRA #camac347; |ACABA; |FINSI;

     |ABRE #caportad;
     #caportad#0 = #caems347#0;
     #caportad#1 = nEjerDos;
     |LEE 001#caportad.=;
     |SI FSalida ! 0;
         |MENAV "    No existen datos en PORTADAS MOD. OFICIALES ";
         |CIERRA #camac347;
         |CIERRA #caportad;
         |ACABA;
     |FINSI;

     nSwInm = 0;
     |ABRE #camic347;
     |DDEFECTO #camic347;
     #camic347#0 = #caems347#0;
     |LEE 001#camic347.=;
     |SI #camic347#2 = 0; nSwInm = 1; |FINSI;

     |CIERRA #camac347;
     |CIERRA #caportad;
     |CIERRA #camic347;

     eaFicheroPlano = eaModelos + (("00000" + #caems347#0) % -105) + ".txt";
     eaFicheroImpre = eaModelos + (("00000" + #caems347#0) % -105) + ".imp";
     eaFicheroSalid = eaModelos + (("00000" + #caems347#0) % -105) + ".sal";
     eaFicheroError = "err" + (("00000" + #caems347#0) % -105) + ".txt";

     aAbre = eaPathEmision + eaFicheroPlano;
     |XABRE "BW", aAbre, nHandle;

     nTopeCobro  = 6000;
     TotalA      = 0;
     TotalB      = 0;
     TotalC      = 0;
     TotalD      = 0;
     TotalE      = 0;
     TotalF      = 0;
     TotalG      = 0;
     TInmuebles  = 0;
     nTOperacion = 0;
     nEmpresa    = #caems347#0;
     Cambio      = 1;
     Redond      = 2;

     #camac347#6 = 0;
     #camac347#8 = 0;

     |BUCLE TotalDecl;
     |BUCLE TotalInm;

     |HAZ CargaT1434701;

     SwLee = 2;
     |HAZ camal347_2012;
     |SI nSwInm = 0;
         SwLee = 3;
         |BUCLELIN 0CargaT1434703#camic347; || las lineas - Inmuebles.
     |FINSI;

     |XCIERRA nHandle;

     enEmpresa    = #caems347#0;
     eaNomEmpresa = #caportad#2;
     |HAZ PresentaPortal;
|FPRC;

|PROCESO Bloque2014;
     |HAZ Botones_2012;
     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     |HAZ camac347_02;

     |SI eaOpcion = "3";
         |HAZ SacaErrorPtl;

         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloque2015;
     |HAZ Botones_2015;
     |SI eaOpcion = "0";  |ACABA;  |FINSI;

     nTecla = 1;

     |HAZ camac347_02;

     |SI eaOpcion = "3";
         |SI enPresentar = 0;
             aAlfa =  "      Los ficheros generados estan: " + eaPathInternet + " de su PC";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO moy34702;
     enAnyo     = #caems347#2;
     eaModelos  = "347";
     eaEjer     = enAnyo;
     nTopeCobro = 6000;
     nEjerDos   = #caems347#2 - 2000;

     eaPathLanza = eaUnidad + "\MODELOS";            |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaModelos;    |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\" + eaEjer;       |RMKDIR eaPathLanza;
     eaPathLanza = eaPathLanza + "\";

     |DBASE eaPathEmision;
     eaPathEmision = eaPathEmision + "emisiones";       |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaModelos;   |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/" + eaEjer;      |MKDIR eaPathEmision;
     eaPathEmision = eaPathEmision + "/";

     eaPathInternet = eaUnidad + "/AEAT";                |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/INTERNET";      |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaModelos;  |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/" + eaEjer;     |RMKDIR eaPathInternet;
     eaPathInternet = eaPathInternet + "/";

     |SI enAnyo [ 2014;  |HAZ Bloque2014;  |FINSI;
     |SI enAnyo ] 2015;  |HAZ Bloque2015;  |FINSI;
|FPRC;
