|FICHEROS;
   ca8yf001  #0;
   ca8m0033  #805,MANTE;
   &imagen@  #910;
   :/agicont/def/ca8m0001 #421;  || Def Balance Textos
|FIN;

|VARIABLES;
   nImporte  = 0;
   nImporte0 = 0;
   nImporte1 = 0;
   nImporte2 = 0;
   nImporte3 = 0;
   nImporte4 = 0;
   nImporte5 = 0;
   nImporte11= 0;
   nImporte12= 0;
   nImporte13= 0;
   nImporte14= 0;
   nImporte15= 0;

   nCampo2 = 0;
   aCampo3 = "";
   nCampo4 = 0;
   nCampo5 = 0;
   nCampo6 = 0;
   nCampo7 = 0;
   nCampo8 = 0;

   nDCampo4  = 0;
   nDCampo5  = 0;
   nDCampo6  = 0;
   nDCampo7  = 0;
   nDCampo8  = 0;
   nHCampo4  = 0;
   nHCampo5  = 0;
   nHCampo6  = 0;
   nHCampo7  = 0;
   nHCampo8  = 0;
   aAlfa1    = "";
   nInkey    = 0;
   &nBalNum  = 0;
   &nBalance = 0;
   &sw_mod   = 0;

   nBoton1   = 0;

   &anyo2    = 0;
   &anyo1    = 0;

   &nCamp0  = 0;     ||desde mes
   &nCamp1  = 0;     ||hasta mes
   &aCamp2  = "";    ||nombre Mes
   &aCamp3  = "";    ||Nombre mes
   &fCamp12 = @;     ||fecha
   &aCamp13 = "";    ||comparativo
   &aCamp18 = "";    ||Datos empresa
   &aCamp29 = "";    ||Titulo Balance
   &nCamp30 = 0;     ||Pagina inicial

   &enEmpresa = 0;
   &enEjerBal = 0;
|FIN;

|INCLUYE varnue_i;

|PROCESO Imprimir;
   nCamp0  = #0#0;     ||desde mes
   nCamp1  = #0#1;     ||hasta mes
   aCamp2  = #0#2;     ||nombre Mes
   aCamp3  = #0#3;     ||Nombre mes
   fCamp12 = #0#12;    ||fecha
   aCamp13 = #0#13;    ||comparativo
   aCamp18 = #0#18;    ||Datos empresa
   aCamp29 = #0#29;    ||Titulo Balance
   nCamp30 = #0#30;    || Pagina inicial

  |SUB_EJECUTA_NP "ca8yfc02;4";
  |PONCONTROL 23, "SI";
|FPRC;

|PROCESO Tipo7_5;  |TIPO 7;
    aAlfa1 = "     ";
    |SI #805#8 = "C";
        aAlfa1 = "     Pulse <F2> para Introducir Importe ";
    |FINSI;
    |MENSA aAlfa1;

    |BLIN 22;
    |CONTROL_SIMPLE 0, "BOTON,F3 Imprimir Balance", 2260, 2278, Boton1;
    nBoton1 = FSalida;
|FPRC;

|PROCESO Tipo11_5;  |TIPO 11;
    nInkey = FSalida;

    |FIN_CONTROL_WINDOWS nBoton1;
    |PULSATECLA;

    |SI nInkey ! 10; |Y nInkey ! 11; |ACABA; |FINSI;
    |SI #805#8 ! "C";  |Y nInkey = 10; |ACABA; |FINSI;

|SI nInkey = 10;
    |LEE 101#805=;

    |SI nInkey = 10;
        |ENCAMPO #5#805;

        |SI #805#8 = "C";
            |ENCAMPO #7#805;
            |SI sw_mod = 0; |ENCAMPO #6#805; |FINSI;
        |FINSI;
    |FINSI;

    |GRABA 020#805a;
    |LIBERA #805;

    |SALVA_DATOS #805;

    |SI #805#8 = "C"; |Y nInkey = 10;
        |HAZ Totales_5;
    |FINSI;

    |REPON_DATOS #805;

    |PONCONTROL 23, "SI";
|FINSI;

|SI nInkey = 11;
    |HAZ Imprimir;
|FINSI;

|FPRC;

|PROCESO Boton1;
     |PTEC 825;
|FPRC;

|PROCESO Tipo0_5;  |TIPO 0;
   ||  |FIN_CONTROL_WINDOWS nBoton1;
   ||  |PULSATECLA;
|FPRC;

|PROCESO Tipo5_5;  |TIPO 5;
   ||    |LEE 040#805p;
   ||    #805#4 = "N";
   ||    |LINEAS_BI_ATRI #805#4, D, S, -1;
|FPRC;

|PROCESO LeeCas805;  ||Carga Trabajo de Cuentas
  #805#0  = enEmpresa;
  #805#1  = enEjercicio;
  #805#9  = nCampo2;
  #805#10 = aCampo3;
  #805#11 = nCampo4;
  #805#12 = nCampo5;
  #805#13 = nCampo6;
  #805#14 = nCampo7;
  #805#15 = nCampo8;
  |LEE 101#805=;
  |SI FSalida = 0; |Y #805#8 ! "A";
      #805#7 = #805#7 + nImporte;
      |SI sw_mod = 0; #805#6 = #805#6 + nImporte0; |FINSI;
      |GRABA 020#805a;
  |FINSI;
  |LIBERA #805;
|FPRC;

|PROCESO ASumar805;
  nImporte  = #910#7;
  nImporte0 = #910#6;

  nCampo2 = #910#9;
  aCampo3 = #910#10;
  nCampo4 = #910#11;
  nCampo5 = #910#12;
  nCampo6 = #910#13;
  nCampo7 = #910#14;
  nCampo8 = #910#15;

  |SI nCampo8 ! 0;    ||Subpartida (A/P = 0)
      nCampo8 = 0;
      |HAZ LeeCas805;
  |FINSI;

  |SI nCampo7 ! 0;   ||Partida
      nCampo8 = 0;
      nCampo7 = 0;
      |HAZ LeeCas805;
  |FINSI;
  |LIBERA #910;
|FPRC;

|PROCESO LeoTotales805;
 |SI #910#8 = "C";
     nImporte  = nImporte  + #910#7;
     nImporte0 = nImporte0 + #910#6;
 |FINSI;
|FPRC;

|DEFBUCLE LeoTotales805;
 #910#2009;
 ;
 enEmpresa, enEjercicio, nCampo2, aCampo3, nDCampo4, 0, 00, 00,0;
 enEmpresa, enEjercicio, nCampo2, aCampo3, nHCampo4, 9, 99, 99,9;
 ;
 NULL, LeoTotales805;
|FIN;

|PROCESO elTotal805;
  |SI #421#8 = "A"; |ACABA; |FINSI;

  nImporte  = 0;
  nImporte0 = 0;
  nCampo2 = #421#2;  ||Bloque
  aCampo3 = #421#3;  ||Tipo
  nCampo4 = #421#4;  ||Agrupacion
  nCampo5 = #421#5;  ||Subagrupacion

  nDCampo4 = 00; nHCampo4 = 99;
  |BUCLE LeoTotales805;

  |SI nCampo5 = 5;
      nImporte  = nImporte1  + nImporte2  + nImporte3  + nImporte4;
      nImporte0 = nImporte11 + nImporte12 + nImporte13 + nImporte14;
  |FINSI;

  |SI nCampo5 ! 4;
      nCampo6 = #421#6;
      nCampo7 = #421#7;
      nCampo8 = #421#10;
      |HAZ LeeCas805;
  |FINSI;

  |SI nCampo5 = 1; nImporte1 = nImporte; nImporte11 = nImporte0; |FINSI;
  |SI nCampo5 = 2; nImporte2 = nImporte; nImporte12 = nImporte0; |FINSI;
  |SI nCampo5 = 3; nImporte3 = nImporte; nImporte13 = nImporte0; |FINSI;
  |SI nCampo5 = 4; nImporte4 = nImporte; nImporte14 = nImporte0; |FINSI;
  |SI nCampo5 = 5; nImporte5 = nImporte; nImporte15 = nImporte0; |FINSI;
|FPRC;

|DEFBUCLE elTotal805;
 #421#1;
 ;
 enEjerBal, nBalNum, nBalance, 7, " ", 00, 1, 00, 00, 0;
 enEjerBal, nBalNum, nBalance, 9, "Z", 99, 9, 99, 99, 9;
 e;
 NULL, elTotal805;
|FIN;

|PROCESO Final5;
    nImporte1 = 0; nImporte11 = 0;
    nImporte2 = 0; nImporte12 = 0;
    nImporte3 = 0; nImporte13 = 0;
    nImporte4 = 0; nImporte14 = 0;
    nImporte5 = 0; nImporte15 = 0;
    |BUCLE elTotal805;
|FPRC;

|DEFBUCLE ASumar805;
 #910#1003;
 8;
 enEmpresa, enEjercicio, 0001, "C";
 enEmpresa, enEjercicio, 9999, "C";
 be;
 NULL, ASumar805;
|FIN;

|PROCESO ACero805;
  |SI #910#8 ! "C";
      #910#7 = 0;
      |SI sw_mod = 0; #910#6 = 0; |FINSI;
      |GRABA 020#910a;
  |FINSI;
  |LIBERA #910;
|FPRC;

|DEFBUCLE ACero805;
   #910#1003;
   ;
   enEmpresa, enEjercicio, 0001;
   enEmpresa, enEjercicio, 9999;
   be;
   NULL, ACero805;
|FIN;

|PROCESO Totales_5;

  |BUCLE ACero805;

  |SELECT #2#805;
  |BUCLE ASumar805;

  |HAZ Final5;
  |SELECT #1#805;
|FPRC;
