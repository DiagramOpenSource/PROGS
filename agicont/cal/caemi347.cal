|FICHEROS;
  caemi347 #0;
  camac347 #1;
  camal347 #2;
  camic347 #3;
  camil347 #4;
  caportad #7;
|FIN;

|VARIABLES;
  swinforme = 0;
  sw_impre = 0;
  men1   = " Introduzca Portada";
  men2   = " Introduzca la hoja de Las Operaciones.";
  men3   = " Introduzca la hoja de Relacion de Inmuebles.";
  men0   = "";
  informe1 = "capor347"; || portada
  informe2 = "cahoj347"; || Operaciones
  informe3 = "caloc347"; || Locales
  informe12000 = "cap2p347"; || portada
  informe22000 = "cah2p347"; || Operaciones
  informe32000 = "cal2p347"; || Locales
  informe = "";
  seleccion = 0;
  Vacio45 = "                                             ";
  Vacio20 = "                    ";

  Calc = 0; Calc1 = 0;
  &NHojaDec = 0; &NHojaInm = 0;
  &any = "";
  &dia = "";
  &mes = "";
  &anyo = "";
  &preimp = "";
  &predis = "";
  &predi1 = "";
  &predi2 = "";
  &numhoja = 0;
  &full = 0;
  &t_clave = "";
  &cp2 = "";
  &cargoem = "";
  &represen = "";
  &fecbo = "";
  &ttes = 0;
  &tdos = 0;
  paso = 0;
  tipo = 0;
  Linea = 1;

  numhA = 0; || hojas de Compras.
  numhB = 0; || hojas de Ventas.
  numhC = 0; || hojas de Pagos.
  numhD = 0; || hojas de Compras de Entidades Publicas
  numhE = 0; || hojas de Subvenciones
  numhI = 0; || hojas de Inmuebles
  numX = 0; || numero de Hojas.
  Contador = 0;
  {-1}opcion  = "";
      opcion1 = "1645";
      opcion2 = "1";
      opcion3 = "5";
      opcion4 = "Portada              ";
      opcion5 = "Hojas Comunes        ";
      opcion6 = "Anexo Arrendamientos ";
      opcion7 = "---------------------";
      opcion8 = "En Papel en Blanco   ";

  sw_inm = 0;
|FIN;

|INCLUYE i_cuadre;
|INCLUYE acceso_i;

|PROCESO pinta_anyo; |TIPO 7;
  #0#0 = cod2;
  |PINTA #0#0;
  |SI paso = 0;
      |ABRE #7;
      |DDEFECTO #7;
      #7#0 = #30#2;
      #7#1 = #0#0;
      |LEE 001#7=;
      |SI FSalida = 0;
          |HAZ representante;
          #0#3 = represen;
          |PINTA #0#3;
      |FINSI;
      |CIERRA #7;
      paso = 1;
  |FINSI;
|FPRC;

|PROCESO imprepo;
  fecbo ="";
  ttes = 0;
  tdos = 0;
  |HAZ mes;
  |SI #1#3 = "N";
      preimp = "X";
      predis = " ";
      predi1 = " ";
      predi2 = " ";
  |SINO;
      preimp = " ";
      |SI #1#16 = "I";
          predis = "X";
          predi1 = " ";
          predi2 = " ";
      |SINO;
          predis = " ";
          predi1 = " ";
          predi2 = "X";
      |FINSI;
  |FINSI;
  |PRINT;
  |PIEINF;
  #1#2 = #0#1;
  |GRABA 001#1a;
  |LIBERA #1;
|FPRC;

|PROCESO imprelih;
  cp2 = "000"; |SI #2#9 = 99; cp2 = #2#10; |FINSI;
  |SI sw_impre = 0;
      sw_impre = 1;
      Contador = 0;
  |FINSI;
  |SI Contador > 8;
      |SI seleccion = 5;
          |PIEINF;
      |FINSI;
      Contador = 0;
  |FINSI;
  |PRINT;
  Contador = Contador + 1;
|FPRC;

|DEFBUCLE imprelin;
 #2#2;
 0;
 tipo, "            ", #30#2;
 tipo, "zzzzzzzzzzzz", #30#2;
 e;
 NULL, imprelih;
|FIN;

|PROCESO Inm2000;
  Linea = Linea + 1;
  |SI Linea = 6;
     |PIEINF;
     numhoja = numhoja + 1;
     Linea = 1;
  |FINSI;
  sw_impre = 1;
  |PRINT;
|FPRC;

|DEFBUCLE Inm2000;
 #4#1;
 ;
 #30#2,00001;
 #30#2,99999;
 ;
 NULL,Inm2000;
|FIN;

|PROCESO ImpreIn2000;
   sw_impre = 0;
   Linea = 0;
   |BUCLE Inm2000;
   |PIEINF;
|FPRC;

|PROCESO ImpreLin2000;
  Linea = Linea + 1
  |SI Linea = 6; Linea = 1; |PIEINF; |FINSI;
  sw_impre = 1;
  cp2 = "000"; |SI #2#9 = 99; cp2 = #2#10; |FINSI;
  |SI #camal347#2 = 2; t_clave = "A"; |FINSI;
  |SI #camal347#2 = 1; t_clave = "B"; |FINSI;
  |SI #camal347#2 = 3; t_clave = "C"; |FINSI;
  |SI #camal347#2 = 4; t_clave = "D"; |FINSI;
  |SI #camal347#2 = 5; t_clave = "E"; |FINSI;
  |PRINT;
|FPRC;

|DEFBUCLE ImpreLin2000;
 #2#1;
 ;
 #30#2,00001;
 #30#2,99999;
 ;
 NULL,ImpreLin2000;
|FIN;

|PROCESO impreho2000;
   sw_impre = 0; Linea = 0;
   |BUCLE ImpreLin2000;
   |PIEINF;
|FPRC;

|PROCESO impreho; || Relacion de Operaciones
  full = 0;
|| ... Lineas de Compra
 |SI numhA ! 0;
     sw_impre = 0;
     tipo = 2;
     t_clave = "A";
     |BUCLE imprelin;
     |SI sw_impre = 1; |PIEINF; |FINSI;
     full = full + numhA;
 |FINSI;
|| ... Lineas de Venta
 |SI numhB ! 0;
     sw_impre = 0;
     tipo = 1;
     t_clave = "B";
     |BUCLE imprelin;
     |SI sw_impre = 1; |PIEINF; |FINSI;
     full = full + numhB;
 |FINSI;
|| ... Lineas de Pagos Mediacion
 |SI numhC ! 0;
     sw_impre = 0;
     tipo = 3;
     t_clave = "C";
     |BUCLE imprelin;
     |SI sw_impre = 1; |PIEINF; |FINSI;
     full = full + numhC;
 |FINSI;
|| ... Lineas de Venta
 |SI numhD ! 0;
     sw_impre = 0;
     tipo = 4;
     t_clave = "D";
     |BUCLE imprelin;
     |SI sw_impre = 1; |PIEINF; |FINSI;
     full = full + numhD;
 |FINSI;
|| ... Lineas de Subvenciones
 |SI numhE ! 0;
     sw_impre = 0;
     tipo = 5;
     t_clave = "E";
     |BUCLE imprelin;
     |SI sw_impre = 1; |PIEINF; |FINSI;
     full = full + numhE;
 |FINSI;
|FPRC;

|PROCESO impreli2;
  cp2 = "000";
  |SI #4#11 = 99; cp2 = #4#12; |FINSI;
  sw_impre = 1; |PRINT;
|FPRC;

|PROCESO imprein;  || Relacion de Inmuebles
  full = numhA + numhB + numhC + numhD + numhE;
  sw_impre = 0;
  |BUCLELIN 0impreli2#3;
  |SI sw_impre = 1; |PIEINF; |FINSI;
|FPRC;

|PROCESO impre;  |TIPO 3;
  any = #0#0;
  |SI any < "80";
     any = "20" + (("00" + any) % -102);
  |FINSI;
  |ABRE #1;
  |LEE 001#1p;
  |SI FSalida ! 0;
      |MENAV "     NO existen datos Mod. 347";
      |CIERRA #1;
      |ACABA;
  |FINSI;
  |ABRE #7;
  #7#0 = #30#2;
  #7#1 = #0#0;
  |LEE 001#7=;
  |SI FSalida ! 0;
      |MENAV "     ATENCION! NO existen datos en PORTADAS MOD. OFICIALES";
      |CIERRA #1;
      |CIERRA #7;
      |ACABA;
  |FINSI;
  |ABRE #3;
  |DDEFECTO #3;
  #3#0 = #30#2;
  |LEE 001#3=;
  |SI #3#2 = 0; sw_inm = 1; |FINSI;

  cargoem = #0#2;
  represen = #0#3;

|ET elegir;
  |MENUG opcion;
    opcion2 = FSalida;
  seleccion = FSalida;
  |SI seleccion < 1; |O seleccion > 5;
      |CIERRA #1;
      |CIERRA #3;
      |CIERRA #7;
      |ACABA;
  |FINSI;
  |SI seleccion = 1;
     men0 = men1;
     |SI #0#0 ] 80; informe = informe1; |SINO; informe = informe12000; |FINSI;
  |FINSI;
  |SI seleccion = 2;
     men0 = men2;
     |SI #0#0 ] 80; informe = informe2; |SINO; informe = informe22000; |FINSI;
  |FINSI;
  |SI seleccion = 3;
     men0 = men3;
     |SI #0#0 ] 80; informe = informe3; |SINO; informe = informe32000; |FINSI;
  |FINSI;
  |SI seleccion = 4; |VETE elegir; |FINSI;

  |SI seleccion = 3; |Y sw_inm = 1;
      |MENAV "    No existen Inmuebles para Relacionar ";
      |VETE elegir;
  |FINSI;

  |IMPRE 0;
  |SI FSalida ! 0; |CIERRA #1;  |CIERRA #3; |CIERRA #7;  |ACABA; |FINSI;

  |SI seleccion ! 5;
      |HAZ abreimpr; |SI swinforme = 1; |ACABA; |FINSI;
  |FINSI;

  |ABRE #2;
  |ABRE #4;
  |HAZ cal_hojas;
  |SI seleccion = 1; |HAZ imprepo; |FININF; |FINSI;
  |SI seleccion = 2;
     |SI #0#0 ] 80;
        |HAZ impreho;
     |SINO;
        |HAZ impreho2000;
     |FINSI;
     |FININF;
  |FINSI;
  |SI seleccion = 3;
     |SI #0#0 ] 80;
        |HAZ imprein;
     |SINO;
        |HAZ ImpreIn2000;
     |FINSI;
     |FININF;
  |FINSI;
  |SI seleccion = 5;
      informe = "capob347"; |HAZ abreimpr; |SI swinforme = 1; |ACABA; |FINSI;
      |HAZ imprepo; |FININF;
      informe = "cahob347"; |HAZ abreimpr; |SI swinforme = 1; |ACABA; |FINSI;
      |HAZ impreho; |FININF;
      informe = "calob347"; |HAZ abreimpr; |SI swinforme = 1; |ACABA; |FINSI;
      |HAZ imprein; |FININF;
  |FINSI;

  |FINIMP;
  |CIERRA #1;
  |CIERRA #2;
  |CIERRA #3;
  |CIERRA #4;
  |CIERRA #7;
|VETE elegir;
|FPRC;

|PROCESO abreimpr;
 swinforme = 0;
 |INFOR informe;
 |SI FSalida ! 0;
     |CIERRA #1;
     |CIERRA #3;
     |CIERRA #7;
     swinforme = 1;
     |FINIMP;
 |FINSI;
|FPRC;

|PROCESO cal_hojas2000;
   Calc  = (((#1#6 + #1#8 + #1#10 + #1#12 + #1#14) / 5) ! 0) * 5;
   Calc1 = #1#6 + #1#8 + #1#10 + #1#12 + #1#14;
   NHojaDec = (((#1#6 + #1#8 + #1#10 + #1#12 + #1#14) / 5) + 0.5) ! 0;
   |SI Calc = Calc1; NHojaDec = NHojaDec - 1; |FINSI;

   Calc = ((#3#2 / 5) ! 0) * 5;
   Calc1 = #3#2;
   NHojaInm = ((#3#2 / 5) + 0.5) ! 0;
   |SI Calc = Calc1; NHojaInm = NHojaInm - 1; |FINSI;
   NHojaInm = NHojaInm + NHojaDec;
   numhoja = NHojaDec + 1;
   NHojaDec = NHojaInm;
|FPRC;

|PROCESO cal_hojas;

  |SI #0#0 < 80; |HAZ cal_hojas2000; |ACABA; |FINSI;

  numX = #1#6 / 9; numhA = #1#6 / 9; numhA = numhA ! 0;
  |SI numX > numhA; numhA = numhA + 1; |FINSI;

  numX = #1#8 / 9; numhB = #1#8 / 9; numhB = numhB ! 0;
  |SI numX > numhB; numhB = numhB + 1; |FINSI;

  numX = #1#10 / 9; numhC = #1#10 / 9; numhC = numhC ! 0;
  |SI numX > numhC; numhC = numhC + 1; |FINSI;

  numX = #1#12 / 9; numhD = #1#12 / 9; numhD = numhD ! 0;
  |SI numX > numhD; numhD = numhD + 1; |FINSI;

  numX = #1#14 / 9; numhE = #1#14 / 9; numhE = numhE ! 0;
  |SI numX > numhE; numhE = numhE + 1; |FINSI;

  numX = #3#2 / 6; numhI = #3#2 / 6; numhI = numhI ! 0;
  |SI numX > numhI; numhI = numhI + 1; |FINSI;

  numhoja = numhA + numhB + numhC + numhD + numhE + numhI;
|FPRC;

|PROCESO mes;
  dia = #0#1 % 102;
  mes = #0#1 % 402;
  anyo = #0#1 % 704;
  |SI mes = "01"; mes = "Enero     "; |FINSI;
  |SI mes = "02"; mes = "Febrero   "; |FINSI;
  |SI mes = "03"; mes = "Marzo     "; |FINSI;
  |SI mes = "04"; mes = "Abril     "; |FINSI;
  |SI mes = "05"; mes = "Mayo      "; |FINSI;
  |SI mes = "06"; mes = "Junio     "; |FINSI;
  |SI mes = "07"; mes = "Julio     "; |FINSI;
  |SI mes = "08"; mes = "Agosto    "; |FINSI;
  |SI mes = "09"; mes = "Septiembre"; |FINSI;
  |SI mes = "10"; mes = "Octubre   "; |FINSI;
  |SI mes = "11"; mes = "Noviembre "; |FINSI;
  |SI mes = "12"; mes = "Diciembre "; |FINSI;
  fecbo = dia + " de " + mes + " de " + anyo;
|FPRC;

|PROCESO representante;
 represen = "";
 |SI #7#39 ! Vacio45;
     represen = #7#39;
 |SINO;
     |SI #7#51 ! Vacio20; |O #7#52 ! Vacio20;
         represen = #7#51;
         |QBF represen;
         represen = represen + ", " + #7#52;
     |SINO;
         |SI #7#56 ! Vacio20; |O #7#57 ! Vacio20;
              represen = #7#56;
              |QBF represen;
              represen = represen + ", " + #7#57;
         |SINO;
              |SI #7#61 ! Vacio20; |O #7#62 ! Vacio20;
                  represen = #7#61;
                  |QBF represen;
                  represen = represen + ", " + #7#62;
              |FINSI;
         |FINSI;
     |FINSI;
 |FINSI;
|FPRC;
