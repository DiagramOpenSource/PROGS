|FICHEROS;
    canivcta #0;
    cacuenta #1;    || plan contable
    cacuent1 #2;    || tmp. cuentas
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &nivel = 0;
    &niv_ant = 0;
    &recupe = "";
    sw_borra = 0;
    x = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE i_ficher;
____________________________________/

|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

|PROCESO lee_temporal1;
  #1#0 = #2#0;
  #1#1 = #2#1;
  |LEE 101#1=;
  |SI FSalida = 0;  |ACABA;  |FINSI;
  #1#0  = #2#0;   #1#1  = #2#1;   #1#2  = #2#2;   #1#3  = #2#3;
  #1#4  = #2#4;   #1#5  = #2#5;   #1#6  = #2#6;   #1#7  = #2#7;
  #1#8  = #2#8;   #1#9  = #2#9;   #1#10 = #2#10;  #1#11 = #2#11;
  #1#12 = #2#12;  #1#13 = #2#13;  #1#14 = #2#14;  #1#15 = #2#15;
  #1#16 = #2#16;  #1#17 = #2#17;  #1#18 = #2#18;  #1#19 = #2#19;
  #1#20 = #2#20;  #1#21 = #2#21;  #1#22 = #2#22;  #1#23 = #2#23;
  #1#24 = #2#24;  #1#25 = #2#25;  #1#26 = #2#26;  #1#27 = #2#27;
  #1#28 = #2#28;  #1#29 = #2#29;  #1#30 = #2#30;  #1#31 = #2#31;
  #1#32 = #2#32;  #1#33 = #2#33;  #1#34 = #2#34;  #1#35 = #2#35;
  #1#36 = #2#36;  #1#37 = #2#37;  #1#38 = #2#38;  #1#39 = #2#39;
  #1#40 = #2#40;  #1#41 = #2#41;  #1#42 = #2#42;  #1#43 = #2#43;
  #1#44 = #2#44;  #1#45 = #2#45;  #1#46 = #2#46;  #1#47 = #2#47;
  #1#48 = #2#48;  #1#49 = #2#49;  #1#50 = #2#50;  #1#51 = #2#51;
  #1#52 = #2#52;  #1#53 = #2#53;  #1#54 = #2#54;  #1#55 = #2#55;
  #1#56 = #2#56;  #1#57 = #2#57;  #1#58 = #2#58;  #1#59 = #2#59;
  |GRABA 020#1n;            || graba nueva cuenta con nivel correcto
|FPRC;

|DEFBUCLE lee_temporal;
 #2#1;
 ;
 "            ", 0;
 "zzzzzzzzzzzz", 9;
 e;
 NULL, lee_temporal1;
|FIN;

|PROCESO lee_cuentas1;

  alfa1 = #1#0;
  |QBF alfa1;
  alfa1 = alfa1 + "zzzzzzzzzzzz";
  #1#54 = alfa1 % 112;
  #1#55 = #1#1;
  |GRABA 001#1a;

  alfa1 = #1#0; |QBF alfa1;
  |SI alfa1 = ""; |ACABA; |FINSI; ||la banca no la modifica

  alfa2 = alfa1 % 0;
  nume1 = alfa2;

  recupe   = "N";
  niv_ant  = 0;
  nivel    = 0;
  sw_borra = 0;

  |SI nume1 = dig4;   nivel = 1;     |FINSI;
  |SI nume1 = dig5;   nivel = 2;     |FINSI;
  |SI nume1 = dig6;   nivel = 3;     |FINSI;
  |SI nume1 = dig7;   nivel = 4;     |FINSI;
  |SI nume1 = dig8;   nivel = 5;     |FINSI;
  |SI nume1 = dig9;   nivel = 6;     |FINSI;

  niv_ant = #1#1;

  |SI nivel = 0;
      sw_borra = 1;
  |SINO;
      |SI nivel ! #1#1;
          |DDEFECTO #2;
          #2#0  = #1#0;   #2#1  = #1#1;   #2#2  = #1#2;   #2#3  = #1#3;
          #2#4  = #1#4;   #2#5  = #1#5;   #2#6  = #1#6;   #2#7  = #1#7;
          #2#8  = #1#8;   #2#9  = #1#9;   #2#10 = #1#10;  #2#11 = #1#11;
          #2#12 = #1#12;  #2#13 = #1#13;  #2#14 = #1#14;  #2#15 = #1#15;
          #2#16 = #1#16;  #2#17 = #1#17;  #2#18 = #1#18;  #2#19 = #1#19;
          #2#20 = #1#20;  #2#21 = #1#21;  #2#22 = #1#22;  #2#23 = #1#23;
          #2#24 = #1#24;  #2#25 = #1#25;  #2#26 = #1#26;  #2#27 = #1#27;
          #2#28 = #1#28;  #2#29 = #1#29;  #2#30 = #1#30;  #2#31 = #1#31;
          #2#32 = #1#32;  #2#33 = #1#33;  #2#34 = #1#34;  #2#35 = #1#35;
          #2#36 = #1#36;  #2#37 = #1#37;  #2#38 = #1#38;  #2#39 = #1#39;
          #2#40 = #1#40;  #2#41 = #1#41;  #2#42 = #1#42;  #2#43 = #1#43;
          #2#44 = #1#44;  #2#45 = #1#45;  #2#46 = #1#46;  #2#47 = #1#47;
          #2#48 = #1#48;  #2#49 = #1#49;  #2#50 = #1#50;  #2#51 = #1#51;
          #2#52 = #1#52;  #2#53 = #1#53;  #2#54 = #1#54;  #2#55 = #1#55;
          #2#56 = #1#56;  #2#57 = #1#57;  #2#58 = #1#58;  #2#59 = #1#59;
          #2#1 = nivel;     || nivel correcto
          #2#55 = #2#1;
          |GRABA 040#2n;
          |SI FSalida = 0;
              recupe = "S";
          |FINSI;
          sw_borra = 1;
      |FINSI;
  |FINSI;

  |SI sw_borra = 1;  |PRINT;  |BORRA 020#1a;  |FINSI;

  |LIBERA #1;
|FPRC;

|DEFBUCLE lee_cuentas;
 #1#1;
 ;
 "            ", 0;
 "zzzzzzzzzzzz", 9;
 be;
 NULL, lee_cuentas1;
|FIN;

|PROCESO tipo3; |TIPO 3;
  |SI #0#0 ! "SI";  |ACABA;  |FINSI;
  |IMPRE 0;
  |SI FSalida ! 0;
      |MENAV "    Proceso Abortado ...";
      |ACABA;
  |FINSI;
  |INFOR "canivcta";
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
  comienza = "u";
  |HAZ fichero;
  |NOME_DAT #2 fichero;
  |ABRE #2;
  |CIERRA #2;
  |DELINDEX #2;
  |ABRE #2;
  |BUCLE lee_cuentas;
  |CIERRA #2;
  |PIEINF;
  |FININF;
  |ABRE #1;
  |BUCLE lee_temporal;
  |CIERRA #1;
  |DELINDEX #2;
  |FINIMP;
|FPRC;
