|FICHEROS;
     cacuenta #69;
     cacuentp #70;
     caclipro #71;
|FIN;

|VARIABLES;
    p_lugar = 0;
    p_cuan3 = 0;
    p_cuan4 = 0;
    p_cuan5 = 0;
    &p_alfa1 = "";
    p_alfa2 = "";
    p_alfa3 = "";
    p_alfa4 = "";
    &p_alfa5 = "";
    p_alfa6 = "";
    p_nume1 = 0;
    p_nume2 = 0;
    p_ceros = "";
    &p_error = 0;
    p_mensa = "    LONGITUD DE CUENTA FUERA DE NIVEL!";
    desdec1 = "";
    hastac1 = "";
    varia_cod = "";
    sw_nom = 0;
    cuen11 = "";
    cuen21 = "";
    cuen31 = "";
    num_campo = 0;
    p_nifs = "";
|FIN;

|PROCESO punto;               || desde calculo 'cuenta'
  |SI salidas = 18;
      num_campo = Campo;
      |HAZ cuent1;
      |ACABA;
  |FINSI;
  p_error = 0;
  p_lugar = 0;
  p_cuan3 = 0;
  p_cuan4 = 0;
  p_alfa3 = "";
  p_alfa4 = "";
  p_alfa4 = p_alfa1 > " ";
  p_alfa1 = p_alfa4;
  p_alfa4 = "";
  |PARA p_nume1 = 1; |SI p_nume1 [ 12; |HACIENDO p_nume1 = p_nume1 + 1;
        p_nume2 = (p_nume1 * 100) + 1;
        p_alfa2 = p_alfa1 % p_nume2;
        |SI p_alfa2 ! " ";
            |SI p_alfa2 = ".";
                p_lugar = p_nume1;
            |SINO;
                |SI p_lugar=0; p_alfa3=p_alfa3+p_alfa2; p_cuan3=p_cuan3+1; |FINSI;
                |SI p_lugar!0; p_alfa4=p_alfa4+p_alfa2; p_cuan4=p_cuan4+1; |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |SI p_lugar ! 0;
      |SI dig3 = 1;  p_cuan5 = dig4;  |FINSI;
      |SI dig3 = 2;  p_cuan5 = dig5;  |FINSI;
      |SI dig3 = 3;  p_cuan5 = dig6;  |FINSI;
      |SI dig3 = 4;  p_cuan5 = dig7;  |FINSI;
      |SI dig3 = 5;  p_cuan5 = dig8;  |FINSI;
      |SI dig3 = 6;  p_cuan5 = dig9;  |FINSI;
      p_nume1 = p_cuan5 - (p_cuan3 + p_cuan4);
      |SI p_nume1 > 0;
          cuen11 = p_alfa4 % 101;
          p_ceros = "0" * p_nume1;
          p_alfa5 = p_alfa3 + p_ceros + p_alfa4;
          cuen11 = p_alfa4 % 101;
          |SI cuen11 = "U";  |O cuen11 = "A";
              cuen31 = cuen11;
              |HAZ ultialta;
          |FINSI;
          ||#0Campo = p_alfa5;
          |||PINTA #0Campo;
      |SINO;
          |MENAV p_mensa;
          p_error = 1;
      |FINSI;
  |SINO;
      ||p_alfa5 = p_alfa1;
  |FINSI;
|FPRC;

|PROCESO busca_cuen1;
    |SI #70#0 = "P";
        p_alfa6 = #69#0;
        p_alfa6 = p_alfa6 % 103;
        |SI p_alfa6 ! "400"; |Y p_alfa6 ! "410"; |Y p_alfa6 ! "523";
            |ACABA;
        |FINSI;
    |FINSI;
     cuen31 = #69#2;
     cuen31 = cuen31 > cuen31;
     cuen21 = cuen31 - cuen11;
     |SI cuen21 ! cuen31; |Y #69#3 = "S";
          |HAZ leepornifs;
          #70#1 = #69#2;
          #70#2 = #69#0;
          #70#4 = p_nifs;
          |PINTA #70#1;
          |PINTA #70#2;
          |PINTA #70#4;
          |PAUSA;
          |SI FSalida = 1;  sw_nom = 1;  |ERROR10;  |FINSI; ||Esc
          |SI FSalida = 7;  |ERROR10;  |FINSI;    ||Ctrl+C
     |FINSI;
|FPRC;

|DEFBUCLE consulta11;
#69#1;
3;
desdec1 , 0, "S";
hastac1 , 9, "S";
e;
NULL , busca_cuen1;
|FIN;

|PROCESO cuent1; |TIPO 0;
          sw_nom = 0;
          |PUSHV 0501 2380;
          |DDEFECTO #70;
          |PINPA #0#70;
          |ENDATOS #1#70;
          |SI FSalida = 0;
               |SI #70#0 ] 1; |Y #70#0 [ 7;
                    desdec1 = #70#0 + "           ";
                    hastac1 = #70#0 + "99999999999";
               |SINO;
                    |SI #70#0 = "C";
                         desdec1 = "4300        ";
                         hastac1 = "449999999999";
                    |FINSI;
                    |SI #70#0 = "P";
                         desdec1 = "4000        ";
                         hastac1 = "523999999999";
                    |FINSI;
                    |SI #70#0 = "T";
                         desdec1 = "            ";
                         hastac1 = "zzzzzzzzzzzz";
                    |FINSI;
               |FINSI;
               cuen11 = #70#1; |QBF cuen11;
               cuen11 = cuen11 > cuen11;
               |MENSA "0000Pulse <Return> Para Seguir, <Esc> Para Aceptar, <Ctrl+C> Para Abandonar";
               |BUCLE consulta11;
          |FINSI;
          |POPV;
          |BLIN 4;
          |SI sw_nom = 1;
               varia_cod = #69#0;
               |QBF varia_cod;
               #0num_campo = varia_cod;
          |SINO;
               #0num_campo = p_alfa1;
          |FINSI;
          |PINTA #0num_campo;
          Campo = num_campo;
          |ERROR;
|FPRC;

|PROCESO ultialta;
  |ABRE #69;
  p_nume2 = p_alfa3;
  p_nume2 = p_nume2 + 1;
  cuen11 = p_nume2;
  #69#0 = cuen11;
  #69#1 = "0";
  |LEE 021#69];
  |SI FSalida ! 0;
      |LEE 021#69u;
  |SINO;
      |LEE 021#69a;
      |SI FSalida ! 0;
          |LEE 021#69p;
      |FINSI;
  |FINSI;
  cuen21 = p_alfa3 % 0;
  p_nume2 = cuen21;
  p_nume2 = p_nume2 + 100;
  cuen11 = p_nume2;
  cuen21 = #69#0 % cuen11;
  |SI cuen21 = p_alfa3;
      cuen21 = #69#0;
      p_nume2 = cuen21;
      |SI cuen31 = "A";
          p_nume2 = p_nume2 + 1;
      |FINSI;
      p_alfa5 = p_nume2;
  |SINO;
      p_ceros = "0" * p_nume1;
      p_alfa5 = p_alfa3 + p_ceros + "1";
  |FINSI;
  |DDEFECTO #69;
||  |CIERRA #69;
|FPRC;

|PROCESO leepornifs;
 p_nifs = "               ";
 p_alfa1 = #69#0; p_alfa1 = p_alfa1 % 101;
 |SI p_alfa1 ! "4"; |Y p_alfa1 ! "5";
     |ACABA;
 |FINSI;

 |ABRE #71;
 #71#23 = "C";
 #71#10 = #69#0;
 #71#11 = #69#1;
 |LEE 001#71=;
 |SI FSalida = 0;
     p_nifs = #71#9;
 |SINO;
     #71#23 = "P";
     #71#10 = #69#0;
     #71#11 = #69#1;
     |LEE 001#71=;
     |SI FSalida = 0;
         p_nifs = #71#9;
     |FINSI;
 |FINSI;
 |CIERRA #71;
|FPRC;
