|FICHEROS;
  cagruiva #0;
  caconcep #1;
  cacuenta #4;
|FIN;

|VARIABLES;
  &entrada = 1;
  sw = 0;
  men2  = "     Longitud de Cuenta Fuera de Nivel !";
  men3  = "      Esta Cuenta NO tiene Pase directo";
  men4  = "      Cuenta INEXISTENTE o no tiene Pase directo";
  long = "  ";
  cta  = 0;
  juan = 0;
  alfa1 = "";
  alfa2 = "";
  nume1 = 0;
  nume2 = 0;
  nume3 = 0;
  nume4 = 0;
  nume5 = 0;
  nume6 = 0;
  nume7 = 0;
  nume8 = 0;
  x = 0;
  y = 0;
  doce = "            ";
  blanco = "                              ";
  num = 0;
  avisos = "";
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROCESO mayor11;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;

|| ******************************** Cuentas

|PROCESO cuefin; |TIPO 0;
    juan = Campo + 15;
|ABRE #4;
    #4#0 = #0Campo;
    #4#1 = #0juan;
|LEE 001#4=;
|SI FSalida = 0;
    |SI #4#3 = "N";
        |MENAV men3;
        |ERROR;
    |FINSI;
|SINO;
    |ERROR;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  salidas = FSalida;
  p_alfa1 = #0Campo;
  |HAZ punto;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  juan = Campo + 15;
  #0juan = 0;
  alfa1 = #0Campo;
  |QBF alfa1;
  alfa2 = alfa1 % 0;
  long = alfa2;
  sw = 0;
  |SI long = dig4; sw = 1; #0juan = 1; |FINSI;
  |SI long = dig5; sw = 1; #0juan = 2; |FINSI;
  |SI long = dig6; sw = 1; #0juan = 3; |FINSI;
  |SI long = dig7; sw = 1; #0juan = 4; |FINSI;
  |SI long = dig8; sw = 1; #0juan = 5; |FINSI;
  |SI long = dig9; sw = 1; #0juan = 6; |FINSI;
  |SI long = 0;    sw = 1; #0juan = 0; |FINSI;
  |SI sw = 0;  |MENAV men2;  |ERROR;  |FINSI;
|FPRC;

|| **************************************************************************
|| ***************************** Calculos desde Base
|PROCESO base; |TIPO 0;
  nume1 = Campo; |HAZ sumanume;
  |SI #0Campo > doce;
      |CAMPO_MODIFICA #0nume2, 1, "S"; || concepto Base
      |CAMPO_MODIFICA #0nume3, 1, "S"; || % IVA
      |CAMPO_MODIFICA #0nume4, 1, "S"; || Cta IVA
      |CAMPO_MODIFICA #0nume5, 1, "S"; || Concepto IVA
      |CAMPO_MODIFICA #0nume6, 1, "S"; || % Recargo
      |CAMPO_MODIFICA #0nume7, 1, "S"; || Cta Recargo
      |CAMPO_MODIFICA #0nume8, 1, "S"; || Concepto Recargo
  |SINO;
      |CAMPO_MODIFICA #0nume2, 1, "N"; || concepto Base
      |CAMPO_MODIFICA #0nume3, 1, "N"; || % IVA
      |CAMPO_MODIFICA #0nume4, 1, "N"; || Cta IVA
      |CAMPO_MODIFICA #0nume5, 1, "N"; || Concepto IVA
      |CAMPO_MODIFICA #0nume6, 1, "N"; || % Recargo
      |CAMPO_MODIFICA #0nume7, 1, "N"; || Cta Recargo
      |CAMPO_MODIFICA #0nume8, 1, "N"; || Concepto Recargo
      #0nume2 = 0; |PINTA #0nume2;
      x = nume2 + 15; #0x = blanco ; |PINTA #0x;
      #0nume3 = 0; |PINTA #0nume3;
      #0nume4 = "";|PINTA #0nume4;
      #0nume5 = 0; |PINTA #0nume5;
      x = nume5 + 15; #0x = blanco ; |PINTA #0x;
      #0nume6 = 0; |PINTA #0nume6;
      #0nume7 = "";|PINTA #0nume7;
      #0nume8 = 0; |PINTA #0nume8;
      x = nume8 + 15; #0x = blanco ; |PINTA #0x;
  |FINSI;
|FPRC;

|| ******************** Conceptos en PANTALLA
|PROCESO lee_linea1; |TIPO 7;
  nume1 = Campo;
  |HAZ sumanume;
  |HAZ lee_todos;
|FPRC;
|PROCESO lee_linea2; |TIPO 7;
  nume1 = Campo - 40;
  |HAZ sumanume;
  |HAZ lee_todos;
|FPRC;
|PROCESO lee_todos;
  |ATRI R;
  |PINTA 1841, num;
  |ATRI 0;
  |ABRE #1;
  x   = nume2 + 15; #0x = blanco;
  |SI #0nume2 ! 0;
     #1#0 = #0nume2;
     |LEE 000#1=;
     |SI FSalida = 0; #0x = #1#1; |FINSI;
 |FINSI;
 |PINTA #0x;
  x   = nume5 + 15; #0x = blanco;
  |SI #0nume5 ! 0;
     #1#0 = #0nume5;
     |LEE 000#1=;
     |SI FSalida = 0; #0x = #1#1; |FINSI;
 |FINSI;
 |PINTA #0x;
  x   = nume8 + 15; #0x = blanco;
  |SI #0nume8 ! 0;
     #1#0 = #0nume8;
     |LEE 000#1=;
     |SI FSalida = 0; #0x = #1#1; |FINSI;
 |FINSI;
 |PINTA #0x;
 |CIERRA #1;
|FPRC;
|| *************************************************************************

|PROCESO iva; |TIPO 0;
  nume1 = Campo - 60;
  |HAZ sumanume;
    |SI #0Campo ! 0;
        |CAMPO_MODIFICA #0nume4, 1, "S"; || Cta IVA
        |CAMPO_MODIFICA #0nume5, 1, "S"; || Concepto IVA
        |CAMPO_MODIFICA #0nume6, 1, "S"; || % Recargo
        |CAMPO_MODIFICA #0nume7, 1, "S"; || Cta Recargo
        |CAMPO_MODIFICA #0nume8, 1, "S"; || Concepto Recargo
  |SINO;
      |CAMPO_MODIFICA #0nume4, 1, "N"; || Cta IVA
      |CAMPO_MODIFICA #0nume5, 1, "N"; || Concepto IVA
      |CAMPO_MODIFICA #0nume6, 1, "N"; || % Recargo
      |CAMPO_MODIFICA #0nume7, 1, "N"; || Cta Recargo
      |CAMPO_MODIFICA #0nume8, 1, "N"; || Concepto Recargo
      #0nume4 = "";|PINTA #0nume4;
      #0nume5 = 0; |PINTA #0nume5;
      x = nume5 + 15; #0x = blanco ; |PINTA #0x;
      #0nume6 = 0; |PINTA #0nume6;
      #0nume7 = "";|PINTA #0nume7;
      #0nume8 = 0; |PINTA #0nume8;
      x = nume8 + 15; #0x = blanco ; |PINTA #0x;
  |FINSI;
|FPRC;

|PROCESO rec; |TIPO 0;
  nume1 = Campo - 65;
  |HAZ sumanume;
    |SI #0Campo ! 0;
        |CAMPO_MODIFICA #0nume7, 1, "S"; || Cta Recargo
        |CAMPO_MODIFICA #0nume8, 1, "S"; || Concepto Recargo
    |SINO;
       |CAMPO_MODIFICA #0nume7, 1, "N"; || Cta Recargo
       |CAMPO_MODIFICA #0nume8, 1, "N"; || Concepto Recargo
       #0nume7 = "";|PINTA #0nume7;
       #0nume8 = 0; |PINTA #0nume8;
       x = nume8 + 15; #0x = blanco ; |PINTA #0x;
    |FINSI;
|FPRC;

|PROCESO leeconce; |TIPO 0;
  x   = Campo + 15;
  #0x = blanco;
 |SI #0Campo ! 0;
     |ABRE #1;
     #1#0 = #0Campo;
     |LEE 000#1=;
     |SI FSalida = 0; #0x = #1#1; |FINSI;
     |CIERRA #1;
 |FINSI;
 |PINTA #0x;
|FPRC;

|| **************************************************************************
|| ****************** Calculos por cada FIcha *******************************
|| **************************************************************************

|PROCESO nomodifica; |TIPO 13;    || campos modificables.
 |PARA x = 7; |SI x [ 71; |HACIENDO x = x + 1;
     |CAMPO_MODIFICA #0x, 1, "N";
 |SIGUE;
 |PARA x = 2; |SI x [ 6; |HACIENDO x = x + 1;
    |SI #0x > doce;
        nume1 = x; |HAZ sumanume;
        |CAMPO_MODIFICA #0nume2, 1, "S"; || concepto Base
        |CAMPO_MODIFICA #0nume3, 1, "S"; || % IVA
        |CAMPO_MODIFICA #0nume4, 1, "S"; || Cta IVA
        |CAMPO_MODIFICA #0nume5, 1, "S"; || Concepto IVA
        |CAMPO_MODIFICA #0nume6, 1, "S"; || % Recargo
        |CAMPO_MODIFICA #0nume7, 1, "S"; || Cta Recargo
        |CAMPO_MODIFICA #0nume8, 1, "S"; || Concepto Recargo
    |FINSI;
 |SIGUE;
 num = 1;
 |ATRI R; |PINTA 1841, num; |ATRI 0;
 |PINTA #0#47;
 |PINTA #0#52;
 |PINTA #0#57;
|FPRC;

|PROCESO final; |TIPO 3; || comprobar que estan todos los datos correctos.
sw = 0;
|PARA x = 2; |SI x [ 6; |HACIENDO x = x + 1;
      nume1 = x; |HAZ sumanume;
      |SI #0nume1 > doce;
          |SI #0nume2 = 0; #0nume2 = 1; |FINSI;
          |SI #0nume3 ! 0;
              |SI #0nume4 [ doce;   sw = 1; |FINSI;
              |SI #0nume5 = 0; #0nume5 = 1; |FINSI;
          |FINSI;
          |SI #0nume6 ! 0;
              |SI #0nume7 [ doce;   sw = 1; |FINSI;
              |SI #0nume8 = 0; #0nume8 = 1; |FINSI;
          |FINSI;
     |FINSI;
|SIGUE;
 |SI sw = 1;
     avisos = "AVISO!!! Faltan cuentas de IVA por introducir ";
    |HAZ aviso5;
    |PAUSA;
    |HAZ aviso9;

 |FINSI;
|FPRC;
|| **************************************************************************

|PROCESO sumanume;
  num = nume1 - 1;
  nume2 = nume1 + 30; || concepto Base
  nume3 = nume1 + 60; || % IVA
  nume4 = nume1 +  5; || Cta IVA
  nume5 = nume1 + 35; || Concepto IVA
  nume6 = nume1 + 65; || % Recargo
  nume7 = nume1 + 10; || Cta Recargo
  nume8 = nume1 + 40; || Concepto Recargo
|FPRC;

|PROCESO aviso5;
|PUSHV 09101171;
|HAZ color_f;
|CUADRO 09 10 11 71;
|HAZ color_c;
|QBF avisos;
    alfa1 = avisos % 0;  nume1 = alfa1;
    nume2 = ((60 - nume1) / 2) ! 0;     nume1 = 60 - nume1 - nume2;
    avisos = (" " * nume1) + avisos + (" " * nume2);        || lo centra
|PINTA 1011, avisos;
|ATRI 0;
|AVISO;
|FPRC;

|PROCESO aviso9;
|ATRI 0;
|POPV;
|FPRC;

|PROCESO color_c;        || activa el color caracter en avisos
|COLOR 14, 0;
|ATRI 0;
|FPRC;

|PROCESO color_f;        || activa el color graficos en avisos
|COLOR 4, 0;
|ATRI 0;
|FPRC;
