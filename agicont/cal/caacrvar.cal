|FICHEROS;
   caacrvar #0;
   caacrpan #1,MANTE;
   caacrval #2,MANTE;
   caprovin #3;
   cacuenta #4;
|FIN;

|VARIABLES;

   &entrada = 0;
   &LineaExt  = 0;
   &NombreExt = "";
   &CifExt    = "";

   nParte1 = 0;
   nParte2 = 0;

   aParte1 = "";
   aParte2 = "";

   aLong = "";
   nLong = 0;

   MaxDig = 0;

   Comodin = ""; Comodin1 = "";
   Calc    = 0;

   Linea = 0;
   Edit  = 0; Tecla = 0;

   ModoEntrada = 0; Opcion = 0;

{-1}Menu  = "";
    Menu1 = "2400";
    Menu2 = "1";
    Menu3 = "";
    Menu4 = "MB";
    Menu5 = " Modificacion ";
    Menu6 = " Baja ";

|FIN;

|PROCESO PuntoCuenta; |TIPO 6;
   entrada = 1;

   |SI #48#19 ! 0; MaxDig = #48#19; |SINO;
      |SI #48#18 ! 0; MaxDig = #48#18; |SINO;
         |SI #48#17 ! 0; MaxDig = #48#17; |SINO;
            |SI #48#16 ! 0; MaxDig = #48#16; |SINO;
               |SI #48#15 ! 0; MaxDig = #48#15; |SINO;
                  |SI #48#14 ! 0; MaxDig = #48#14; |SINO;
                     MaxDig = 0;
   |FINSI; |FINSI; |FINSI; |FINSI; |FINSI; |FINSI;

   Comodin = #caacrvar#Campo#;
   Comodin = Comodin - ".";
   |SI FSalida ! 0;
      Calc = FSalida;
      nParte1 = 99 + ((Calc / 100) ! 0);
      aParte1 = Comodin % nParte1;
      nParte2 = 98 + Calc;
      aParte2 = Comodin % nParte2;
      |QBF Comodin;
      aLong = Comodin % 0; nLong = aLong;
      nLong = MaxDig - nLong;
      Comodin = aParte1 + ("0" * nLong) + aParte2;
      #caacrvar#Campo# = Comodin;
      |PINTA #caacrvar#Campo#;
   |FINSI;
|FPRC;

|PROCESO Edicion; |TIPO 11;
   Tecla = FSalida;
   |SI FSalida ! 10; |Y FSalida ! 11; |Y FSalida ! 12; |ACABA; |FINSI;

   |SI FSalida = 12; |BORRA 020#caacrval.a; |ACABA; |FINSI;

   |SI FSalida = 11;
      #caacrpan#0 = #caacrval#3;
      #caacrpan#1 = #caacrval#4;
      #caacrpan#2 = #caacrval#5;
      #caacrpan#5 = #caacrval#6;
      #caacrpan#6 = #caacrval#7;
      #caacrpan#3 = #caacrval#8;
      #caacrpan#4 = #caacrval#9;
      #caacrpan#7 = #caacrval#10;
      #caacrpan#8 = #caacrval#11;
      #caacrpan#9 = #caacrval#12;
      #caacrpan#10 = #caacrval#13;
   |FINSI;

   |PUSHV 09081773;
   |PINPA #0#1;
   |PINDA #0#1;
   |ENDATOS #1#1;
   |SI FSalida = 0;
      |SI Tecla = 10;
         |DDEFECTO #caacrpan;
         #caacrval#0 = #caacrvar#0;
         #caacrval#1 = #caacrvar#1;
         #caacrval#2 = Linea;      Linea = Linea + 1;
      |FINSI;
      #caacrval#3 = #caacrpan#0;
      #caacrval#4 = #caacrpan#1;
      #caacrval#5 = #caacrpan#2;
      #caacrval#6 = #caacrpan#5;
      #caacrval#7 = #caacrpan#6;
      #caacrval#8 = #caacrpan#3;
      #caacrval#9 = #caacrpan#4;
      #caacrval#10 = #caacrpan#7;
      #caacrval#11 = #caacrpan#8;
      #caacrval#12 = #caacrpan#9;
      #caacrval#13 = #caacrpan#10;
      |GRABA 020#caacrval.a;
      |LIBERA #caacrval;
   |SINO;
      |SI Tecla = 10;
         |BORRA 020#caacrval.a;
         |LIBERA #caacrval;
         |PTEC 807;
      |FINSI;
   |FINSI;
   |POPV;
|FPRC;

|RUTINA inferior;
#caacrval#0 = #caacrvar#0;
#caacrval#1 = #caacrvar#1;
#caacrval#2 = 001;
|FRUT;

|RUTINA superior;
#caacrval#0 = #caacrvar#0;
#caacrval#1 = #caacrvar#1;
#caacrval#2 = 999;
|FRUT;

|PROGRAMA;
   |HAZ inicio;
   |CLS;
   |CABEZA "Gestion datos cuenta acreedores varios";
   |SI PARAMETRO ! "";
      Comodin = PARAMETRO % 0112;
      #0#0 = Comodin;
      Comodin = PARAMETRO % 1401;
      #0#1 = Comodin;
      |ABRE #cacuenta;
      #cacuenta#0 = #0#0;
      #cacuenta#1 = #0#1;
      |LEE 010#cacuenta.=;
      |SI FSalida = 0;
         #0#2 = #cacuenta#2;
      |FINSI;
      |CIERRA #cacuenta;
      |PINPA #0#0;
      |PINDA #0#0;
      FSalida = 0;
   |SINO;
      |PINPA #0#0;
      |PINDA #0#0;
      |ENDATOS #1#0;
   |FINSI;
   |SI FSalida = 0;
      |ABRE #caacrval;
      #caacrval#0 = #caacrvar#0;
      #caacrval#1 = #caacrvar#1;
      #caacrval#2 = 1;
      |LEE 010#caacrval.];
      |SI FSalida = 0; |Y #caacrval#0 = #caacrvar#0; |Y #caacrval#1 = #caacrvar#1;
         |PARA; |SI FSalida = 0; |Y #caacrval#0 = #caacrvar#0; |Y #caacrval#1 = #caacrvar#1; |HACIENDO;
            Linea = #caacrval#2 + 1;
            |LEE 010#caacrval.s;
         |SIGUE;
      |SINO;
         Linea = 1;
      |FINSI;
      |ENTLINEAL #1#2,3,2,20,1,inferior,superior;
      |CIERRA #caacrval;
      |SI PARAMETRO ! "";
         LineaExt  = #caacrval#2;
         NombreExt = #caacrval#3;
         CifExt    = #caacrval#4;
      |FINSI;
   |FINSI;
|FPRO;

|PROCESO cuapais;
 |SI FSalida ! 9; |ACABA; |FINSI;

 |PUSHV 1102 2260;
 |D_CUADRO 1102, 2260;

 |ATRI R;
 |PINTA 1203, " ----------------- PAISES COMUNITARIOS ------------------";

 |ATRI N;
 |PINTA 1303, " DE   Alemania     FR   Francia         LT   Lituania    ";
 |PINTA 1403, " AT   Austria      EL   Grecia          LU   Luxemburgo  ";
 |PINTA 1503, " BE   Belgica      GB   Gran Breta¤a    MT   Malta       ";
 |PINTA 1603, " CY   Chipre       NL   Holanda         PL   Polonia     ";
 |PINTA 1703, " DK   Dinamarca    HU   Hungria         PT   Portugal    ";
 |PINTA 1803, " SI   Eslovenia    IT   Italia          CZ   Rep.Checa   ";
 |PINTA 1903, " EE   Estonia      IE   Irlanda         SK   Rep.Eslovaca";
 |PINTA 2003, " FI   Finlandia    LV   Letonia         SE   Suecia      ";
 |PINTA 2103, " BG   Bulgaria     RO   Rumania         HR   Croacia     ";

 |ATRI I;
 |PINTA 1304 , "DE"; |PINTA 1322 , "FR"; |PINTA 1343 , "LT";
 |PINTA 1404 , "AT"; |PINTA 1422 , "EL"; |PINTA 1443 , "LU";
 |PINTA 1504 , "BE"; |PINTA 1522 , "GB"; |PINTA 1543 , "MT";
 |PINTA 1604 , "CY"; |PINTA 1622 , "NL"; |PINTA 1643 , "PL";
 |PINTA 1704 , "DK"; |PINTA 1722 , "HU"; |PINTA 1743 , "PT";
 |PINTA 1804 , "SI"; |PINTA 1822 , "IT"; |PINTA 1843 , "CZ";
 |PINTA 1904 , "EE"; |PINTA 1922 , "IE"; |PINTA 1943 , "SK";
 |PINTA 2004 , "FI"; |PINTA 2022 , "LV"; |PINTA 2043 , "SE";
 |PINTA 2104 , "BG"; |PINTA 2122 , "RO"; |PINTA 2043 , "HR";
 |ATRI 0;

 |PAUSA;
 |POPV;
|FPRC;

|PROCESO Edita;

   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 2;
      |MENU Menu;
      Opcion = FSalida;
      |SI FSalida < 1; |O FSalida > 2; |PTEC 807; |ACABA; |FINSI;
      |SI Opcion = 1; ModoEntrada = 2; |FINSI;
      |SI Opcion = 2; ModoEntrada = 3; |FINSI;
   |FINSI;

   |SI ModoEntrada = 1;
      |DDEFECTO #caacrpan;
   |FINSI;
   |SI ModoEntrada = 2;
      #caacrpan#0 = #caacrval#3;
      #caacrpan#1 = #caacrval#4;
      #caacrpan#2 = #caacrval#5;
      #caacrpan#5 = #caacrval#6;
      #caacrpan#6 = #caacrval#7;
      #caacrpan#3 = #caacrval#8;
      #caacrpan#4 = #caacrval#9;
      #caacrpan#7 = #caacrval#10;
      #caacrpan#8 = #caacrval#11;
      #caacrpan#9 = #caacrval#12;
      #caacrpan#10 = #caacrval#13;
   |FINSI;
   |SI ModoEntrada = 3;
      |BORRA 020#caacrval.a;
      |PONCONTROL 23,"SI";
      |SALVA_FICHA #caacrval;
      #caacrval#0 = #caacrvar#0;
      #caacrval#1 = #caacrvar#1;
      #caacrval#2 = 1;
      |LEE 010#caacrval.];
      |SI FSalida = 0; |Y #caacrval#0 = #caacrvar#0; |Y #caacrval#1 = #caacrvar#1;
         |PARA; |SI FSalida = 0; |Y #caacrval#0 = #caacrvar#0; |Y #caacrval#1 = #caacrvar#1; |HACIENDO;
            Linea = #caacrval#2 + 1;
            |LEE 010#caacrval.s;
         |SIGUE;
      |SINO;
         Linea = 1;
      |FINSI;
      |REPON_FICHA #caacrval;
      |ACABA;
   |FINSI;

   |PUSHV 09081773;
   |PINPA #0#1;
   |PINDA #0#1;
   |ENDATOS #1#1;
   |SI FSalida = 0;
      |SI ModoEntrada = 1;
         |DDEFECTO #caacrval;
         #caacrval#0 = #caacrvar#0;
         #caacrval#1 = #caacrvar#1;
         #caacrval#2 = Linea;      Linea = Linea + 1;
      |FINSI;
      #caacrval#3 = #caacrpan#0;
      #caacrval#4 = #caacrpan#1;
      #caacrval#5 = #caacrpan#2;
      #caacrval#6 = #caacrpan#5;
      #caacrval#7 = #caacrpan#6;
      #caacrval#8 = #caacrpan#3;
      #caacrval#9 = #caacrpan#4;
      #caacrval#10 = #caacrpan#7;
      #caacrval#11 = #caacrpan#8;
      #caacrval#12 = #caacrpan#9;
      #caacrval#13 = #caacrpan#10;
      |SI ModoEntrada = 1;  |GRABA 020#caacrval.n; |FINSI;
      |SI ModoEntrada = 2;  |GRABA 020#caacrval.a; |FINSI;
      |LIBERA #caacrval;
      |SI ModoEntrada ! 1; |PTEC 807; |FINSI;
   |SINO;
      |SI ModoEntrada ! 1;
         |PTEC 807;
      |SINO;
         |ERROR;
      |FINSI;
   |FINSI;
   |POPV;

|FPRC;
