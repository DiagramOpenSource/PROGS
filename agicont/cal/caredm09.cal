|FICHEROS;
 caredm09 #0;
 camingca #2;  || Confirming Cabeceras
 camingli #3;  || Confirming Lineas
 caclipro #4;  || Clientes/Proveedores
 camanpag #5;  || Pagos
 caivasop #6;  || Iva
 caconcep #7;  || Concepto
 camanban #8;  || Bancos..............

 caacrval #9;
 calisfra #10;

 camoneda #50;
|FIN;

|VARIABLES;
 Moneda = "";
 MonBase = 0;
 nCantidad = 0;
 nCalc = 0;

 alfa1 = "";
 alfa2 = "";
 alfa3 = "";
 alfa4 = "";
 nume1 = 0;
 nume2 = 0;
 nume3 = 0;
 nume4 = 0;

 mens     = "";
 swErrorR = 0;
 swErrorP = 0;
 menR1    = "    No Existe Confirme !!!";
 menR2    = "    Confirme YA contabilizado ";
 menR3    = "2400SConfirme YA Emitido en Papel. Aceptar S/N ";
 menR4    = "2400NConfirme YA lanzado en Diskette. Aceptar S/N ";

 Nombre  = "";
 CodCli  = "";
 sino     = "";
 ceros    = "000000000000000";
 fechapre = "      ";
 dd       = "";
 mm       = "";
 aa       = "";
 cabe1    = "1";  || Registro Cabecera
 cabe2    = "2";  || Registro Detalle Pagos
 cabe3    = "3";  || Registro Total

 libre    = " ";
 libre40  = "";

 VAlfa   = "";
 VAlfa01 = ""; VAlfa02 = ""; VAlfa03 = ""; VAlfa04 = ""; VAlfa05 = "";
 VAlfa06 = ""; VAlfa07 = ""; VAlfa08 = ""; VAlfa09 = ""; VAlfa10 = "";
 VAlfa11 = ""; VAlfa12 = ""; VAlfa13 = ""; VAlfa14 = ""; VAlfa15 = "";
 VAlfa16 = ""; VAlfa17 = ""; VAlfa18 = ""; VAlfa19 = ""; VAlfa20 = "";
 Dato  = 0;
 ProvAnt = "";
 NombreAnt = "";

 Regs  = 0;
 Recs  = 0;
 TotImporte = 0;

 NifProv    = "";
 NombreProv = "";
 DirecProv  = "";
 PoblaProv  = "";
 ProviProv  = "";
 Cp1Prov    = "";
 Cp2Prov    = "";
 TelefProv  = "";
 FaxProv    = "";
 PaisProv   = "";
 varios     = 0;

 handle     = "";
 fiche      = "";
 dirempr    = "";
 varalfa1   = "";
 varalfa2   = "";
 contenido  = "";
 swERROR    = 0;
 CampoDni   = "";
 Letra1     = "";
 Letra2     = "";
 Letra3     = "";
 Letra4     = "";
 Letra5     = "";
 Letra6     = "";
 Letra7     = "";
 Letra8     = "";
 Caracter   = "";
 Carac1     = 0;
 Carac2     = 0;
 Carac3     = 0;
 Carac4     = 0;
 Carac5     = 0;
 XPara      = 0;

 ccc        = "";
 c_alfa1    = "";
 c_alfa2    = "";
 c_nume1    = 0;
 c_nume2    = 0;
 c_nume3    = 0;

 direcc = "";
 numero = 0;
 longi  = 0;
 concepto = "";
 Comodin = "";

 &Dia  = 0;
 &Mes  = 0;
 &Year = 0;
 &MesAlfa = "";

 &programa = "";
 &ficcopia = "";
 aAlfa1 = "";

    &eaVarDni  = "";
    &enCalcCif = 0;

|FIN;

|INCLUYE acceso_i;

|| *************************************************************************

|PROCESO mayus1;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;
|FPRC;

|PROCESO ver_confirming; |TIPO 6;
 |SI FSalida = 2; |ACABA; |FINSI;
 |ABRE #2;
 |HAZ leerem;
 |CIERRA #2;
 |SI swErrorR ! 0;
     |SI swErrorR < 3;
         |MENAV mens;
         |ERROR;
         |ACABA;
     |SINO;
         |CONFI mens;
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
 |FINSI;
 #0#2 = #2#3; || Banco
 #0#5 = #2#6; |PINTA #0#5;
 #0#3 = #2#1; |PINTA #0#3;

 |PINTA 1035, #2#2;   || Vto.
 |PINTA 1058, #2#8;   || N§ Efectos
 |PINTA 1135, #2#3;   || Banco
 |PINTA 1149, #2#9;   || Importe Total
|FPRC;

|PROCESO leerem;
 swErrorR = 0;
 |DDEFECTO #2;
 #2#0 = #0#1;
 |LEE 001#2=;
 |SI FSalida ! 0;
     swErrorR = 1; mens = menR1;
 |SINO;
     |SI #2#9 = "S";
         swErrorR = 2; mens = menR2;
     |SINO;
         |SI #2#10 = "S"; swErrorR = 3; mens = menR3; |FINSI;
         |SI #2#10 = "D"; swErrorR = 4; mens = menR4; |FINSI;
     |FINSI;
     |ABRE #8;
     #8#0 = #2#3;
     |LEE 000#8=;
     |CIERRA #8;
 |FINSI;
|FPRC;

||...................................................................................
||***********************************************************
||************* REGISTROS DE CLIENTE ************************
||***********************************************************
|PROCESO Cliente;

  VAlfa01 = ""; VAlfa02 = ""; VAlfa03 = ""; VAlfa04 = ""; VAlfa05 = "";
  VAlfa06 = ""; VAlfa07 = ""; VAlfa08 = ""; VAlfa09 = ""; VAlfa10 = "";
  VAlfa11 = ""; VAlfa12 = ""; VAlfa13 = ""; VAlfa14 = ""; VAlfa15 = "";
  VAlfa16 = ""; VAlfa17 = ""; VAlfa18 = ""; VAlfa19 = ""; VAlfa20 = "";

  VAlfa01 = "001";              || Identificacion de cliente
  VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
  VAlfa03 = "            ";     || Libre
  VAlfa04 = #30#4;              || Razon social del emisor
  VAlfa04 = (VAlfa04 + (" " * 50)) % 0150;
  VAlfa05 = #camanban#8 % 0104; || Codigo entidad destino
  |SI Moneda = "P";
     VAlfa06 = "ESP";              || Moneda
  |SINO;
     VAlfa06 = "EUR";              || Moneda
  |FINSI;
  VAlfa07 = "01";               || Remesa de facturas
  VAlfa08 = " " * 26;           || Libre
  VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
  VAlfa = VAlfa + VAlfa07 + VAlfa08;
  VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
  VAlfa = handle + " " + VAlfa;
  |FGRABA VAlfa;
  Regs = Regs + 1;

|FPRC;

||********************************************************
||**************** REGISTROS DE PROVEEDOR ****************
||********************************************************

|PROCESO Proveedor;
   #caclipro#23 = "P";
   #caclipro#10 = #camingli#9;
   #caclipro#11 = #camingli#10;
   |LEE 010#caclipro.=;

   #caivasop#0  = #camingli#2;
   #caivasop#27 = #camingli#3;
   #caivasop#2  = #camingli#4;
   |LEE 010#caivasop.=;

   #camanpag#0  = #camingli#2;
   #camanpag#27 = #camingli#3;
   #camanpag#2  = #camingli#4;
   #camanpag#3  = #camingli#5;
   |LEE 010#camanpag.=;

    |HAZ MiraVarios;
    |SI varios = 0;
        NifProv    = #caclipro#9;
        NombreProv = #caclipro#1;
        DirecProv  = #caclipro#2;
        PoblaProv  = #caclipro#6;
        ProviProv  = #caclipro#5;
        Cp1Prov    = #caclipro#3;
        Cp2Prov    = #caclipro#4;
        TelefProv  = #caclipro#7;
        FaxProv    = #caclipro#8;
        PaisProv   = #caclipro#24;
    |SINO;
        NifProv    = #caacrval#4;
        NombreProv = #caacrval#3;
        DirecProv  = #caacrval#5;
        PoblaProv  = #caacrval#6;
        ProviProv  = #caacrval#7;
        Cp1Prov    = #caacrval#8;
        Cp2Prov    = #caacrval#9;
        TelefProv  = #caacrval#11;
        FaxProv    = #caacrval#12;
        PaisProv   = #caacrval#13;
    |FINSI;

   VAlfa01 = ""; VAlfa02 = ""; VAlfa03 = ""; VAlfa04 = ""; VAlfa05 = "";
   VAlfa06 = ""; VAlfa07 = ""; VAlfa08 = ""; VAlfa09 = ""; VAlfa10 = "";
   VAlfa11 = ""; VAlfa12 = ""; VAlfa13 = ""; VAlfa14 = ""; VAlfa15 = "";
   VAlfa16 = ""; VAlfa17 = ""; VAlfa18 = ""; VAlfa19 = ""; VAlfa20 = "";

   VAlfa01 = "010";              || Identificacion de proveedor
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   VAlfa04 = NifProv % 109;      || NIF del proveedor
   VAlfa04 = ("         " + VAlfa04) % -109;
   VAlfa05 = " " * 72;           || Nombre del proveedor
   VAlfa05 = (NombreProv + VAlfa05) % 0172;
   VAlfa06 = "    ";             || Libre
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

   VAlfa01 = "011";              || Identificacion de proveedor
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   VAlfa04 = " " * 72;           || Domicilio del proveedor
   VAlfa04 = (DirecProv + VAlfa05) % 0172;
   VAlfa05 = "             ";
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

   VAlfa01 = "012";              || Identificacion de proveedor
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   VAlfa04 = " " * 36;           || Localidad del proveedor
   VAlfa04 = (PoblaProv + VAlfa04) % 0136;
   VAlfa05 = ("00" + Cp1Prov) % -102;
   VAlfa05 = VAlfa05 + (("000" + Cp2Prov) % -103);
   VAlfa06 = " " * 36;           || Provincia del proveedor
   VAlfa06 = (ProviProv + VAlfa06) % 0136;
   VAlfa07 = "        ";         || Libre
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06 + VAlfa07;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

   VAlfa01 = "013";              || Identificacion de proveedor
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   |QBF TelefProv; |QBF FaxProv;
   VAlfa04 = ("          " + TelefProv) % -110;    || N§ de Telefono
   VAlfa05 = ("          " + FaxProv) % -110;      || N§ de Fax
   VAlfa06 = " " * 65;           || Libre
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

|FPRC;

||********************************************************
||**************** REGISTROS DE FACTURAS *****************
||********************************************************

|PROCESO Facturas;
   #caclipro#23 = "P";
   #caclipro#10 = #camingli#9;
   #caclipro#11 = #camingli#10;
   |LEE 010#caclipro.=;

   #caivasop#0  = #camingli#2;
   #caivasop#27 = #camingli#3;
   #caivasop#2  = #camingli#4;
   |LEE 010#caivasop.=;

   #camanpag#0  = #camingli#2;
   #camanpag#27 = #camingli#3;
   #camanpag#2  = #camingli#4;
   #camanpag#3  = #camingli#5;
   |LEE 010#camanpag.=;

    |HAZ MiraVarios;

    |SI varios = 0;
        NifProv    = #caclipro#9;
        NombreProv = #caclipro#1;
        DirecProv  = #caclipro#2;
        PoblaProv  = #caclipro#6;
        ProviProv  = #caclipro#5;
        Cp1Prov    = #caclipro#3;
        Cp2Prov    = #caclipro#4;
        TelefProv  = #caclipro#7;
        FaxProv    = #caclipro#8;
        PaisProv   = #caclipro#24;
    |SINO;
        NifProv    = #caacrval#4;
        NombreProv = #caacrval#3;
        DirecProv  = #caacrval#5;
        PoblaProv  = #caacrval#6;
        ProviProv  = #caacrval#7;
        Cp1Prov    = #caacrval#8;
        Cp2Prov    = #caacrval#9;
        TelefProv  = #caacrval#11;
        FaxProv    = #caacrval#12;
        PaisProv   = #caacrval#13;
    |FINSI;

   VAlfa01 = ""; VAlfa02 = ""; VAlfa03 = ""; VAlfa04 = ""; VAlfa05 = "";
   VAlfa06 = ""; VAlfa07 = ""; VAlfa08 = ""; VAlfa09 = ""; VAlfa10 = "";
   VAlfa11 = ""; VAlfa12 = ""; VAlfa13 = ""; VAlfa14 = ""; VAlfa15 = "";
   VAlfa16 = ""; VAlfa17 = ""; VAlfa18 = ""; VAlfa19 = ""; VAlfa20 = "";

   VAlfa01 = "020";              || Identificacion de proveedor0
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   VAlfa04 = "            ";     || Numero de la orden de pago
   VAlfa05 = ("00" + #camingli#2) % -102; || Numero externo de la factura
   VAlfa05 = VAlfa05 + ("/" + #camingli#4 + "/");
   VAlfa05 = VAlfa05 + (("000000" + #camingli#3) % -106) + "/";
   VAlfa05 = VAlfa05 + (("000" + #camingli#5) % -103);
   VAlfa05 = VAlfa05 % -112;
   |SI #camingli#8 < 0;
      VAlfa06 = "C";             || Abono al proveedor
   |SINO;
      VAlfa06 = "A";             || Cargo al proveedor
   |FINSI;
   nCantidad = #camingli#8; |HAZ Conversion;
   VAlfa07 = ("000000000000" + nCantidad) % -112; || Importe de la factura


   VAlfa08 = " " * 48;           || Libre
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
   VAlfa = VAlfa + VAlfa07 + VAlfa08;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

   VAlfa01 = "021";              || Identificacion de proveedor0
   VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
   VAlfa03 = NifProv % 112;      || NIF del proveedor
   |QBF VAlfa03;
   VAlfa03 = ("            " + VAlfa03) % -112;
   VAlfa04 = #camingli#6;        || Fecha de emision
   FSalida = 1;
   |PARA; |SI FSalida ! 0; |HACIENDO;
      VAlfa04 = VAlfa04 - "."
   |SIGUE;
   VAlfa05 = #camingli#7;        || Fecha de vencimiento
   FSalida = 1;
   |PARA; |SI FSalida ! 0; |HACIENDO;
      VAlfa05 = VAlfa05 - "."
   |SIGUE;
   |SI #camingli#12 = "T";
      VAlfa06 = "TR";            || Forma de pago : Transferencia
   |SINO;
      VAlfa06 = "CH";            || Forma de pago : Cheque
   |FINSI;
   VAlfa07 = " " * 67;           || Libre
   VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06 + VAlfa07;
   VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
   VAlfa = handle + " " + VAlfa;
   |FGRABA VAlfa;
   Regs = Regs + 1;

   |SI #camingli#12 = "T";
      VAlfa01 = "022";              || Identificacion de proveedor0
      VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
      VAlfa03 = NifProv % 112;      || NIF del proveedor
      |QBF VAlfa03;
      VAlfa03 = ("            " + VAlfa03) % -112;
      VAlfa04 = #camanban#9 % 0104;|| Codigo de entidad
      VAlfa05 = #camanban#9 % 0504;|| Codigo de sucursal
      VAlfa06 = #camanban#8 % 0110;|| Numero de cuenta
      VAlfa07 = #camanban#9 % 0902;|| Digito de control
      VAlfa08 = " " * 65;           || Libre
      VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
      VAlfa = VAlfa + VAlfa07 + VAlfa08;
      VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
      VAlfa = handle + " " + VAlfa;
      |FGRABA VAlfa;
      Regs = Regs + 1;
   |FINSI;

   Recs = Recs + 1;

   TotImporte = TotImporte + nCantidad;
|FPRC;

||***********************************************************
||********** REGISTRO TOTAL ORDENANTE Y GENERAL *************
||***********************************************************
|PROCESO Totales;
  VAlfa01 = ""; VAlfa02 = ""; VAlfa03 = ""; VAlfa04 = ""; VAlfa05 = "";
  VAlfa06 = ""; VAlfa07 = ""; VAlfa08 = ""; VAlfa09 = ""; VAlfa10 = "";
  VAlfa11 = ""; VAlfa12 = ""; VAlfa13 = ""; VAlfa14 = ""; VAlfa15 = "";
  VAlfa16 = ""; VAlfa17 = ""; VAlfa18 = ""; VAlfa19 = ""; VAlfa20 = "";

  VAlfa01 = "099";
  VAlfa02 = #caredm09#14;       || Codigo de ordenante del pagador
  VAlfa03 = "            ";     || Libre
  VAlfa04 = "000000000000" + #caredm09#12;
  |QBF VAlfa04;
  VAlfa04 = VAlfa04 % -112;     || Importe Total de la remesa;
  VAlfa04 = VAlfa04 + "00";

  VAlfa05 = "0000000000" + #caredm09#10;
  |QBF VAlfa05;
  VAlfa05 = VAlfa05 % -110;     || N§ de facturas de la remesa

  VAlfa06 = "0000000000" + #caredm09#11;
  |QBF VAlfa06;
  VAlfa06 = VAlfa06 % -110;     || Total lineas de registros
  VAlfa07 = " " * 53;           || Libre

  VAlfa = VAlfa01 + VAlfa02 + VAlfa03 + VAlfa04 + VAlfa05 + VAlfa06;
  VAlfa = VAlfa   + VAlfa07 + VAlfa08 + VAlfa09;
  VAlfa = VAlfa + &#caredm09#7 + &#caredm09#8;
  VAlfa = handle + " " + VAlfa;
  |FGRABA VAlfa;
|FPRC;

|| **************************************************************************

|PROCESO LinConfirme;
   |SI ProvAnt ! #camingli#9; |O NombreAnt ! #camingli#13;
      |HAZ Proveedor;
      ProvAnt = #camingli#9;
      NombreAnt = #camingli#13;
   |FINSI;
   |HAZ Facturas;
|FPRC;

|DEFBUCLE LinConfirme;
#camingli#1;
;
#caredm09#1,001;
#caredm09#1,999;
;
NULL,LinConfirme;
|FIN;

|PROCESO pasecuencial; |TIPO 3;

  |ABRE #camoneda;
  #camoneda#0 = #48#2;
  #camoneda#1 = #48#3;
  |LEE 000#camoneda.=;
  |SI FSalida = 0;
     Moneda = #camoneda#2;
     |SI #camoneda#2 = "P";
        MonBase = 1;
     |SINO;
        MonBase = 2;
     |FINSI;
  |SINO;
     Moneda = "P";
     MonBase = 1;
  |FINSI;
  |CIERRA #camoneda;

  |HAZ PideMoneda;

  |SI MonBase = 2;                  || euros
     EURO = 166.386;
     EURODB = 2;
     EURODV = 0;
  |SINO;
     EURO = 1 / 166.386;
     EURODB = 0;
     EURODV = 2;
  |FINSI;

  |ABRE #2;
  |HAZ leerem;
  |SI swErrorR = 1; |O swErrorR = 2;
      |MENAV "    ERROR !!! CONFIRME NO CORRECTO ";
      |ACABA;
  |FINSI;

  |HAZ varia_fich;

  |CAMPO_VISUAL #0#10,1,"S"; #0#10 = 0;
  |CAMPO_VISUAL #0#11,1,"S"; #0#11 = 0;
  |CAMPO_VISUAL #0#12,1,"S"; #0#12 = 0;

|| ...................................................
  |ABRE #4;                || Abre Clientes / Proveedores
  |ABRE #5;                || Cobros
  |ABRE #6;                || IVA soportado
  |ABRE #7;                || Conceptos

  Comodin = #caredm09#3 % 0102;
  Dia = Comodin;
  Comodin = #caredm09#3 % 0402;
  Mes = Comodin;
  Comodin = #caredm09#3 % 0704;
  Year = Comodin;
  |HAZ Mes;

|| Abrir Fichero Secuencial

  |DFICE dirempr;
  fiche = "wb  " + dirempr + "casecmin.seq";  || "nomfiche.ext";
  |QBF fiche;
  |FABRE fiche;
  handle = FSalida;
  |SI FSalida ] 0;

     |HAZ Cliente;
     Dato = 19;
     Regs = 0;
     Recs = 0;
     TotImporte = 0;
     |BUCLE LinConfirme;
     Regs = Regs + 1;
     #caredm09#10 = Recs;
     #caredm09#11 = Regs + 1;
     #caredm09#12 = TotImporte;
     |HAZ Totales;

  |FINSI;
  contenido = handle + " " + &#0#9;
  |FGRABA contenido;

  FSalida = handle;
  |FCIERRA FSalida;

  Pos = -1;
  |CIERRA #2;
  |CIERRA #4;
  |CIERRA #5;
  |CIERRA #6;
  |CIERRA #7;

|| ...   |SI swERROR = 1; |ACABA; |FINSI;

  |D_CUADRO 1261, 2280;
  |ATRI R;
  |PINTA 1362, " Numero Recibos   ";
  |PINTA 1562, " Numero Registros ";
  |PINTA 1762, " Importe Total    ";
  |ATRI 0;
  |PINTA 1462, "                  ";
  |PINTA 1662, "                  ";
  |PINTA 1862, "                  ";
  |PINTA #0#10;
  |PINTA #0#11;

  nCalc = EURODB;
  |SI Moneda = "E";
     EURODB = 2;
     #0#12 = #0#12 / 100;
  |SINO;
     EURODB = 0;
  |FINSI;
  |PINTA #0#12;
  EURODB = nCalc;

  |D_CUADRO 1961, 2280;
  |ATRI R;
  |PINTA 2062, " Desea grabar el  ";
  |PINTA 2162, " diskete ahora    ";
  |ATRI 0;

  programa = " CONFIRMES ";
  ficcopia = "CFREMESA.TXT";
  E_sup = 1;
  E_inf = "SNsn";
  sino  = "N";
  sino  = 2177 ? 1;
  |SI sino = "S"; |O sino = "s"; |CORRE "cared003.tab"; |FINSI;
|FPRC;

|| ********** Rutinas Varias

|PROCESO LetraDni;
     eaVarDni   = CampoDni;
     enCalcCif  = 3;
     |HAZ CalculoDNI;
     CampoDni = eaVarDni;
     CampoDni = ("000000000" + CampoDni) % -109;
|FPRC;

|PROCESO Mes;
   |SI Mes = 1;  MesAlfa = "Enero     "; |FINSI;
   |SI Mes = 2;  MesAlfa = "Febrero   "; |FINSI;
   |SI Mes = 3;  MesAlfa = "Marzo     "; |FINSI;
   |SI Mes = 4;  MesAlfa = "Abril     "; |FINSI;
   |SI Mes = 5;  MesAlfa = "Mayo      "; |FINSI;
   |SI Mes = 6;  MesAlfa = "Junio     "; |FINSI;
   |SI Mes = 7;  MesAlfa = "Julio     "; |FINSI;
   |SI Mes = 8;  MesAlfa = "Agosto    "; |FINSI;
   |SI Mes = 9;  MesAlfa = "Septiembre"; |FINSI;
   |SI Mes = 10; MesAlfa = "Octubre   "; |FINSI;
   |SI Mes = 11; MesAlfa = "Noviembre "; |FINSI;
   |SI Mes = 12; MesAlfa = "Diciembre "; |FINSI;
   |QBF MesAlfa;
|FPRC;

|PROCESO varia_fich;
|| .......... Variables del Presentador, del Ordenante y comunes

  CodCli = #0#5; |QBF CodCli;
  CodCli = CodCli + "  "; CodCli = CodCli % 102;

  libre40 = libre * 40;
  Nombre = #30#4 + libre40;     Nombre = Nombre % 140;

  alfa1 = #0#3;
  dd = alfa1 % A102;
  mm = alfa1 % A402;
  aa = alfa1 % A902;
  fechapre = aa + mm + dd;   || Fecha Formato a¤o + mes + dia
|FPRC;

|PROCESO MiraVarios;
     |DDEFECTO #caacrval;
     |ABRE #calisfra;
     #calisfra#0  = #camingli#2;   || libro
     #calisfra#1  = #camingli#4;   || serie
     #calisfra#2  = #camingli#3;   || orden
     |LEE 000#calisfra.=;
     |SI FSalida = 0;
          |ABRE #caacrval;
          #caacrval#0 = #calisfra#3;    || cuenta
          #caacrval#1 = #calisfra#4;    || digito
          #caacrval#2 = #calisfra#5;    || linea
          |LEE 000#caacrval.=;
          |SI FSalida ! 0;
               aAlfa1 = "0000Direccion [" + #caacrval#0 + "." + #caacrval#2 + "] Factura [" + #camingli#2 + "." + #camingli#4 + "." + #camingli#3 + "] inaccesible.";
               |MENAV aAlfa1;
          |FINSI;
          |CIERRA #caacrval;
          varios = 1;
     |SINO;
          |SI #camingli#16 ! 0;
               |ABRE #caacrval;
               #caacrval#0 = #camingli#9;    || cuenta
               #caacrval#1 = #camingli#10;   || digito
               #caacrval#2 = #camingli#16;   || linea
               |LEE 000#caacrval.=;
               |SI FSalida ! 0;
                    aAlfa1 = "0000Direccion [" + #caacrval#0 + "." + #caacrval#2 + "] Factura [" + #camingli#2 + "." + #camingli#4 + "." + #camingli#3 + "] inaccesible.";
                    |MENAV aAlfa1;
               |FINSI;
               |CIERRA #caacrval;
               varios = 1;
          |SINO;
               varios = 0;
          |FINSI;
     |FINSI;
     |CIERRA #calisfra;
|FPRC;

|PROCESO PideMoneda;
   |PUSHV 1943 2177;
   |BLANCO 1943 2177;
   |CUADRO 1945 2175;
   |ATRI R; |PINTA 1946 , " Seleccione moneda de emision "; |ATRI N;
   |PINTA 2053, "(Pesetas/Euros)";
   |ATRI I; |PINTA 2054, "P"; |PINTA 2062, "E"; |ATRI N;
   E_sup  = 1;
   E_inf  = "EP";
   |SI MonBase = 1; Moneda = "P"; |SINO; Moneda = "E"; |FINSI;
   Moneda = 2069 ? 0;
   |POPV;
|FPRC;

|PROCESO Conversion;
   |SI MonBase = 1;
      |SI Moneda = "E";
         nCantidad = ((nCantidad / 166.386) ! 2) * 100;
      |FINSI;
   |SINO;
      |SI Moneda = "P";
         nCantidad = (nCantidad * 166.386) ! 0;
      |SINO;
         nCantidad = nCantidad * 100;
      |FINSI;
   |FINSI;
|FPRC;
