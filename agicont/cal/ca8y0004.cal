|FICHEROS;
  :/agicont/def/ca8m0000 #0;
  :/agicont/def/ca8m0006 #1;
  :/agicont/def/ca8m0007 #2;
  :/agicont/def/ca8mtcol #3;
  ca8y0004 #10;
  :/agicont/def/ca8cumay #410;
|FIN;

|VARIABLES;
 aParam    = "";
 &nBalance = 0;
 &nNumero  = 0;
 aAlfa1    = "";
 nError    = 0;
 sw        = 0;
 &swLinea  = 0;
 informe   = "ca8y0004";

 nValo1    = 0;
 nValo2    = 0;
 aValor    = "";
 nSi       = 0;
 nCol      = 0;
 &aCol     = "";
 &eaText   = "";
|FIN;

|INCLUYE varnue_i;
|INCLUYE acceso_i;

|| ******************************************** Calculos Pantalla
|CALCULO AntesEjer; |TIPO 7;
   #10#9 = enEjerBal;
   |PINTA #10#9;
|FCAL;

|CALCULO descri;  |TIPO 6;
  |ABRE #0;
  #0#0 = #10#2;
  |LEE 001#0=;
  |SI FSalida ! 0;
      |MENAV "    No existe Definicion de Balance";
      |ERROR;
  |SINO;
      #10#3 = #0#1; |PINTA #10#3;
  |FINSI;
|FCAL;

|| /////////////////////// PROCESOS DE TRABAJO \\\\\\\\\\\\\\\\\\\\
|PROCESO BuscaTexto;
  aCol = nCol;
  aCol = ("00" + aCol) % -102;
  eaText = "";
  #3#5 = #2#7;
  #3#0 = #2#0;
  #3#1 = nCol;
  |LEE 040#3=;
  |SI FSalida = 0;
      eaText = #3#2; |QBF eaText;
  |FINSI;
|FPRC;

|PROCESO LeoCtas;
  |SI nCol = 0; |O nCol ! #2#2;
      nCol = #2#2;
      |HAZ BuscaTexto;
      swLinea = 1;
  |FINSI;
  |PRINT;
  swLinea = 2;
|FPRC;

|DEFBUCLE LeoCtas;
 #2#1;
 ;
 #1#34, #1#0, #1#1,  1, 001;
 #1#34, #1#0, #1#1, 99, 999;
 e;
 NULL, LeoCtas;
|FIN;

|PROCESO LeoDefinicion;
  swLinea = 0;
 |PRINT;
 sw = 1;
 |SI #10#4 = "S";
     |SI #1#5 = "I";
         nCol    = 0;
         |BUCLE LeoCtas;
         |SI swLinea ! 0;
             swLinea = 3; |PRINT;
         |FINSI;
    |FINSI;
 |FINSI;
|FPRC;

|DEFBUCLE LeoDefinicion;
 #1#1;
 2;
 enEjerBal, nNumero, #10#5, #10#7;
 enEjerBal, nNumero, #10#6, #10#8;
 e;
 NULL, LeoDefinicion;
|FIN;


|PROCESO Tipo3;  |TIPO 3;

 aParam   = "3";
 nBalance = aParam;
 nNumero  = #10#2;

 |IMPRE 0;
 |SI FSalida ! 0; |ACABA; |FINSI;

 |INFOR informe;
 |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;

 |ABRE #3;
 sw  = 0;
 swLinea = 0;
 |BUCLE LeoDefinicion;
 |CIERRA #3;
 |SI sw = 1;
     |PIEINF;
 |FINSI;
 |FININF;
 |FINIMP;
|FPRC;

|| **************************************************************************

|PROGRAMA;
   aParam = PARAMETRO; |QBF aParam;
   |SI aParam = "";
       |HAZ inicio;
       |HAZ eVarEmpresa;
   |SINO;
        enEjerBal = aParam; |SI enEjerBal < 2008; enEjerBal = 2008; |FINSI;
   |FINSI;

   |HAZ DirAplicSt;
   |SI HaySociedad = 1;
       aAlfa1 = enEjerBal;
       aAlfa1 = ":sociedad/soda8y01;" + aAlfa1;
       |SUB_EJECUTA_NP aAlfa1;
   |SINO;
        |MANTE #0;
   |FINSI;
|FPRO;
