|FICHEROS;
    ca8ut000 #0;
    cacuenta #1;         || cuentas

    ca8cumay #410;  || Control de Balances
    ca8m0000 #420;  || Descripcion Numero de Balance
    ca8m0001 #421;  || Def Balance Textos
    ca8m0002 #422;  || Def Balance Linea Cuentas
|FIN;

|VARIABLES;
   informe   = "ca8ut000";
   &entrada  = 1;
   aAlfa1    = "";
   aAlfa2    = "";
   nNume1    = 0;
   nNume2    = 0;
   nCampo    = 0;

   &aError   = "";
   aDCuenta    = "";
   aHCuenta    = "";
   nError      = 0;

   mascara  = "";
   uno      = "";
   dos      = "";
   nNoBal8  = 0;

   nTipo   = 0;
   nMensa  = 0;
|FIN;

|INCLUYE varnue_i;
|INCLUYE acceso_i;

|| ========================================================================
||                        CALCULOS PANTALLA
|| ========================================================================
|PROCESO descri; |TIPO 6;
 |ABRE #420;
 |DDEFECTO #420;
 #420#0 = #0Campo;
 |LEE 001#420=;
 |SI FSalida ! 0;
     |MENAV "   Error. No existe Numero de Balance";
     |ERROR;
 |FINSI;
 |CIERRA #420;
 nCampo = Campo + 1;
 #0nCampo = #420#1; |PINTA #0nCampo;
|FPRC;

|| ------------------------------------------------------------------------
|PROCESO saca2008;
   nNoBal8 = 0;
|FPRC;

|DEFBUCLE saca2008;
 #ca8m0002#2;
 ;
 enEjerBal, #0#2, nTipo, uno;
 enEjerBal, #0#2, nTipo, uno;
 ;
 NULL, saca2008;
|FIN;

|PROCESO Mirodefect;
  uno = (uno + "     " ) % 105;
  |BUCLE saca2008;
|FPRC;

|PROCESO LeoCuentas;

 nTipo = 9;
 aAlfa1 = #1#0; aAlfa1 = aAlfa1 % 101;
 |SI aAlfa1 ] "0"; |Y aAlfa1 [ "5";
     nTipo = 0;
 |FINSI;
 |SI aAlfa1 ] "6"; |Y aAlfa1 [ "7";
     nTipo = 1;
 |FINSI;
 |SI #0#0 ! nTipo;
     |SI #0#0 ! 2; |O nTipo > 2;
         |ACABA;
     |FINSI;
 |FINSI;

 uno     = #1#0; |QBF uno;
 |SI uno = ""; |ACABA; |FINSI;

 nNoBal8 = 1;

 uno  = #1#0; |QBF uno;
 dos  = uno + "000000000000";

 uno = dos % A105;
 |HAZ Mirodefect;
 |SI nNoBal8 = 0; |ACABA;  |FINSI;

 uno = dos % A104;
 |HAZ Mirodefect;
 |SI nNoBal8 = 0; |ACABA;  |FINSI;

 uno = dos % A103;
 |HAZ Mirodefect;
 |SI nNoBal8 = 0; |ACABA;  |FINSI;

 uno = dos % A102;
 |HAZ Mirodefect;
 |SI nNoBal8 = 0; |ACABA;  |FINSI;

 uno = dos % A101;
 |HAZ Mirodefect;
 |SI nNoBal8 = 1;
     |SI nTipo = 0; aAlfa1 = "SITUACION"; |FINSI;
     |SI nTipo = 1; aAlfa1 = "RESULTADOS"; |FINSI;
     aError = "NO EXISTE EN BALANCE " + aAlfa1;
     |PRINT;
     nError = 1;
 |FINSI;
|FPRC;

|DEFBUCLE LeoCuentas;
   #1#1;
   3;
   aDCuenta, 0, "S";
   aHCuenta, 9, "S";
   e;
   NULL, LeoCuentas;
|FIN;

|PROCESO Cheque12; |TIPO 12;
    |SI #0#4 = "N"; |ACABA; |FINSI;

    |HAZ eVarEmpresa;
    |IMPRE 0;
    |SI FSalida ! 0;  |ACABA;  |FINSI;
    |INFOR informe;
    |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

    |SI enEjercicio < 2008; |ACABA; |FINSI;

    aDCuenta = "            ";
    aHCuenta = "zzzzzzzzzzzz";
    nError = 0;
    |BUCLE LeoCuentas;
    |SI nError ! 0;
        |PIEINF;
    |SINO;
        |MENAV "    No detectado Error en las Estructuras y Plan Contable";
    |FINSI;

    |FININF;
    |FINIMP;
|FPRC;
