|FICHEROS;
  cafupz01 #0;
  cafupm01 #1,MANTE;
  cafupm02 #2,MANTE;
  cafupm03 #3,MANTE;
  cafupm04 #4,MANTE;
  cafupm05 #5,MANTE;

  cacuenta #15;
  canempre #30;
  &cacuent@ #915;
|FIN;

|VARIABLES;
 &entrada = 1;
 &salidas = 0;
 &enEjercicio = 0;
 &enAny       = 0;
 &eaNombreEmp = "";
 &eaDirDestino = "";
 &eaDirOrigen  = "";
 &eaCuenta = "";
 &enNivel = 0;

 &dig1 = 0;
 &dig3 = 0;
 &dig4 = 0;
 &dig5 = 0;
 &dig6 = 0;
 &dig7 = 0;
 &dig8 = 0;
 &dig9 = 0;

 nTecla = 0;
 nModo  = 0;
 nModoEntrada = 0;

 &nMaxDes  = 0;
 &nMaxOri  = 0;
 {-1}punt1 = 0;
 &ddig3 = 0;
 &ddig4 = 0;
 &ddig5 = 0;
 &ddig6 = 0;
 &ddig7 = 0;
 &ddig8 = 0;
 &ddig9 = 0;

 aAlfa1 = "";
 aAlfa2 = "";

 aLong    = "";
 nLong    = 0;
 &nPlaEmp = 0;

 &sw5      = 0;
 &enSalgo5 = 0;
 &p_alfa1  = "";
 &p_error  = 0;
 &enDef    = 0;
|FIN;

|| **********************************************************

|CALCULO LeeEmp; |TIPO 0;

  nModoEntrada = (FEntrada / 100) ! 0;
  |SI #2#1 = #0#0;
      |MENAV "    Error!. Introducida Empresa Destino ";
      |ERROR;
      |ACABA;
  |FINSI;

  |ABRE #30;
  #30#2 = #2#1;
  #30#3 = 0;
  |LEE 010#30];
  |SI FSalida ! 0; |O #30#2 ! #2#1;
      |MENAV "    No existe la empresa ";
      |ERROR;
      |CIERRA #30;
      |ACABA;
  |FINSI;
  |CIERRA #30;

  ddig3 = #30#13;
  ddig4 = #30#14;       || 1 nivel
  ddig5 = #30#15;       || 2 nivel
  ddig6 = #30#16;       || 3 nivel
  ddig7 = #30#17;       || 4 nivel
  ddig8 = #30#18;       || 5 nivel
  ddig9 = #30#19;       || 6 nivel

  || Recoger informacion sobre los niveles ...
  Ipunt1 = ddig3<-;
  Ipunt1 = Ipunt1 + ddig3;
  nMaxOri = punt1;

  |SI nMaxDes ! nMaxOri;
      |MENAV "    No corresponde Nivel Cuentas ";
      |ERROR;
      |ACABA;
  |FINSI;

  #2#0 = #1#0;
  #2#2 = #30#1; |PINTA #2#2;

  |DFICB aAlfa1;
  aAlfa2 = #30#0; |QBF aAlfa2;
  aAlfa2 = ("000000" + #30#0) % -106;
  eaDirOrigen = aAlfa1 + aAlfa2 + "/";
  |PATH_DAT #915 eaDirOrigen;
|FCAL;

|| -------------------------------------------------------------------------
|PROCESO Borram5;
 |BORRA 020#5a;
 |LIBERA #5;
|FPRC;

|DEFBUCLE Borram5;
 #5#1;
 ;
 #2#0, #2#1, "            ", 0;
 #2#0, #2#1, "zzzzzzzzzzzz", 9;
 be;
 NULL, Borram5;
|FIN;

|PROCESO Borram4;
 |BORRA 020#4a;
 |LIBERA #4;
|FPRC;

|DEFBUCLE Borram4;
 #4#1;
 ;
 #2#0, #2#1, 001;
 #2#0, #2#1, 999;
 be;
 NULL, Borram4;
|FIN;

|CALCULO Tipo1_m2; |TIPO 1;
 nModoEntrada = (FEntrada / 100) ! 0;
 |SI nModoEntrada = 3;
     |BUCLE Borram4;
     |BUCLE Borram5;
 |FINSI;
|FCAL;

|PROCESO inf1;
 aAlfa1 = " " * 40;
 #30#1 = aAlfa1;
 #30#2 = 00001;
 #30#3 = 0;
|FPRC;

|PROCESO inf2;
 aAlfa1 = "z" * 40;
 #30#1 = aAlfa1;
 #30#2 = 99999;
 #30#3 = 9;
|FPRC;

|PROCESO Tipo11_m2;  |TIPO 11;
  nTecla = FSalida;
  |SI nTecla = 10;
      |ABRE #30;
      #30#2 = #2#1;
      #30#1 = #2#2;
      |CONSULTA_F_CLAVE #3#30, inf1, inf2;
      #2#1 = #30#2;
      #2#2 = #30#1;
      |PINTA #2#1;
      |PINTA #2#2;
      |CIERRA #30;
      |PTEC 802;
      |ERROR;
  |FINSI;
  |SI nTecla = 16;
  |FINSI;
|FPRC;

|PROCESO ClaveBaja5;
 #5#0 = #1#0;
 #5#1 = nPlaEmp;
 #5#2 = "            ";
 #5#3 = 0;
|FPRC;

|PROCESO ClaveAlta5;
 #5#0 = #1#0;
 #5#1 = nPlaEmp;
 #5#2 = "zzzzzzzzzzzz";
 #5#3 = 9;
|FPRC;

|CALCULO Tipo7_m2; |TIPO 7;
     |PULSATECLA;
     |SI #1#12 ! "E"; |ACABA; |FINSI;
     nPlaEmp = #2#1;
     nModo   = 7;
     |ENTLINEAL #1#5, -3, 7, 22, 0, ClaveBaja5, ClaveAlta5;
|FCAL;

|CALCULO Tipo3_m2; |TIPO 3;
     |SI #1#12 ! "E"; |ACABA; |FINSI;
     nPlaEmp = #2#1;
     enSalgo5 = 0;
     |PARA; |SI enSalgo5 = 0; |HACIENDO;
            sw5 = 0;
            nModo = 2;
            |ENTLINEAL #1#5, -3, 2, 22, 0, ClaveBaja5, ClaveAlta5;
            |SI enSalgo5 = 1; |SAL; |FINSI;
     |SIGUE;

     enDef = #2#0;
     |SUB_EJECUTA_NP "cafupz04";
     |PULSATECLA;
|FCAL;

|| **********************************************************************

|PROCESO cuenta4; |TIPO 6;
  p_alfa1 = #4Campo;
  salidas = FSalida;
  |HAZ punto2;
  |SI p_error ! 0;  |ERROR;  |ACABA; |FINSI;

  |SI Campo = 4; |Y #4#3 > #4#4;
      |MENAV "    Error. Cuenta Erronea ... ";
      |ERROR;
  |FINSI;
|FPRC;

|RUTINA ClaveBaja4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 01;
|FRUT;

|RUTINA ClaveAlta4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 99;
|FRUT;

|CALCULO Excluir; |TIPO 0;
 |SI #2#4 = "S";
      |PUSHV 0948 2080;
      |ENTLINEAL #1#4, -3, 2, 18, 1, ClaveBaja4, ClaveAlta4;
      |POPV;
 |SINO;
     |BUCLE Borram4;
     || ... |ENTLINEAL #1#4, -3, 7, 18, 1, ClaveBaja4, ClaveAlta4;
 |FINSI;
|FCAL;
