|FICHEROS;
    cabanmin #0;
    camingca #1;
    camanban #2;
    cacuenta #3;
    cabanmi1 #4;
    cacuadre #9;
|FIN;

|VARIABLES;
    &entrada = 1;
    informe = "cabanmin";
    banco = "";
    vto = @;
    sw = 0;
    &sw1 = 0;
    &venci = 0;
    &swtot = 0;
    &tvenci = 0;
    &tbanco = 0;
    &nomban = "";
 {-1}elegir = "";
    elegir1 = "2400";
    elegir2 = "1";
    elegir3 = " Elija opcion .: ";
    elegir4 = "IP";
    elegir5 = " Impresora ";
    elegir6 = " Pantalla ";
    posic = 0;
    mas = 0;
    lin_pan = 0;
    alfa1 = "";
    sw_act = 0;
|FIN;

|INCLUYE acceso_i;

|PROCESO mayor;
   alfa1 = #0Campo > " ";
   #0Campo = alfa1;
   |PINTA #0Campo;
|FPRC;

|PROCESO detalles;       || lee el banco y la cuenta
  nomban = "";
  |DDEFECTO #camanban;
  #camanban#10 = #camingca#4;
  #camanban#11 = #camingca#5;
  |LEE 001#camanban.=;
  |SI FSalida = 0;
      nomban = #camanban#1;
  |SINO;
      |DDEFECTO #cacuenta;
      #cacuenta#00 = #camingca#4;
      #cacuenta#01 = #camingca#5;
      |LEE 001#cacuenta.=;
      nomban = #cacuenta#2;
 |FINSI;
|FPRC;

|PROCESO impre1;
  |SI #cabanmin#13 ! "A";
      |SI #cabanmin#13 ! #camingca#10;  |ACABA;  |FINSI;  || impreso confirme
  |FINSI;
  |SI #cabanmin#11 ! "A";
      |SI #cabanmin#11 ! #camingca#12;  |ACABA;  |FINSI;  || emision
  |FINSI;
  |SI #cabanmin#12 ! "A";
      |SI #cabanmin#12 ! #camingca#11;  |ACABA;  |FINSI;  || vencimiento
  |FINSI;

  |HAZ detalles;
  |SI sw = 0;
      banco = #camingca#4;
      vto   = #camingca#2;
      |PRINT;                   || Imprime Banco
       sw = 1;
       sw1 = 1;
  |FINSI;
  |SI banco ! #camingca#4;
       sw1   = 2;
       swtot = 1;
        venci = 1;
    |PRINT;                   || imprime total banco y vto.
        banco = #camingca#4;
        vto   = #camingca#2;
        tvenci = 0;
        tbanco = 0;
        swtot = 0;
        venci = 0;
        sw1 = 0;
    |PRINT;                   || imprime banco
        sw1 = 1;
|FINSI;
|SI vto ! #camingca#2;
        sw1   = 2;
        venci = 1;
    |PRINT;                   || imprime total vto.
        vto = #camingca#2;
        tvenci = 0;
        venci = 0;
        sw1 = 1;
|FINSI;
    tvenci  = tvenci + #camingca#9;
    tbanco  = tbanco + #camingca#9;
|PRINT;                       || imprime linea
|FPRC;

|DEFBUCLE impre;
 #camingca#3;
 1; || ..... ordenado por banco, vto y emision
 #cabanmin#2, 0, #cabanmin#4, #cabanmin#0, #cabanmin#8;
 #cabanmin#3, 9, #cabanmin#5, #cabanmin#1, #cabanmin#9;
 e;
 NULL, impre1;
|FIN;

|PROCESO impresora;
|IMPRE 0;
|SI FSalida = 0;
    |INFOR informe;
    |ABRE #camanban;
    |SELECT #2#camanban;
    |ABRE #cacuenta;
    |BUCLE impre;
    |CIERRA #camanban;
    |CIERRA #cacuenta;
        sw1   = 2;
        venci = 1;
        swtot = 1;
    |PRINT;
    |PIEINF;
    |FININF;
|SINO;
    |MENAV "    Proceso Abortado ...";
|FINSI;
|FINIMP;
|FPRC;

|PROCESO correte;
|CAMPO_POSICION #4#2,0,posic; posic=posic+mas; |CAMPO_POSICION #4#2,1,posic;
|CAMPO_POSICION #4#3,0,posic; posic=posic+mas; |CAMPO_POSICION #4#3,1,posic;
|CAMPO_POSICION #4#4,0,posic; posic=posic+mas; |CAMPO_POSICION #4#4,1,posic;
|CAMPO_POSICION #4#5,0,posic; posic=posic+mas; |CAMPO_POSICION #4#5,1,posic;
|CAMPO_POSICION #4#6,0,posic; posic=posic+mas; |CAMPO_POSICION #4#6,1,posic;
|CAMPO_POSICION #4#7,0,posic; posic=posic+mas; |CAMPO_POSICION #4#7,1,posic;
|FPRC;

|PROCESO empieza;
  |PINPA #0#4;
  mas = lin_pan * -100;
  lin_pan = 0;
  |HAZ correte;
|FPRC;

|PROCESO panta1;
  |SI #cabanmin#13 ! "A";
      |SI #cabanmin#13 ! #camingca#10;  |ACABA;  |FINSI;  || impreso confirme
  |FINSI;
  |SI #cabanmin#11 ! "A";
      |SI #cabanmin#11 ! #camingca#12;  |ACABA;  |FINSI;  || emision
  |FINSI;
  |SI #cabanmin#12 ! "A";
      |SI #cabanmin#12 ! #camingca#11;  |ACABA;  |FINSI;  || vencimiento
  |FINSI;


|HAZ detalles;
|SI sw = 0;
        banco = #camingca#4;
        vto   = #camingca#2;
        sw = 1;
|FINSI;
|SI banco ! #camingca#4;
    |PAUSA;
        banco = #camingca#4;
        tbanco = 0;
    |HAZ empieza;
|FINSI;
    tbanco  = tbanco + #camingca#9;
    lin_pan = lin_pan + 1;
|DDEFECTO #4;
    #4#0 = #camingca#4;    || cuenta banco
    #4#1 = nomban;  || nombre banco
    #4#2 = #camingca#0;    || nro. confirme
    ||#4#3 = #1#1;    || cuenta proveedor PEPE
    ||#4#4 = #3#2;    || nombre proveedor PEPE
    #4#5 = #camingca#1;    || fecha emision
    #4#6 = #camingca#2;    || fecha vencimiento
    #4#7 = #camingca#9;    || total pagare
    #4#9 = tbanco;  || total banco
|PINDA #0#4;
|SI lin_pan < 10;
        mas = 100;
|SINO;
        mas = -900;
        lin_pan = 0;
    |PAUSA;
    |PINPA #0#4;
|FINSI;
|HAZ correte;
|FPRC;

|DEFBUCLE panta;
 #camingca#3;
 1; || ..... ordenado por banco, vto y emision
 #cabanmin#2, 0, #cabanmin#4, #cabanmin#0, #cabanmin#8;
 #cabanmin#3, 9, #cabanmin#5, #cabanmin#1, #cabanmin#9;
 e;
 NULL, panta1;
|FIN;

|PROCESO pantalla;
|PUSHV 0501 2380;
|CLS;

|PINPA #0#4;
|ABRE #camanban;
|SELECT #2#camanban;
|ABRE #cacuenta;
|BUCLE panta;
|PAUSA;
|CIERRA #camanban;
|CIERRA #cacuenta;

|POPV;
|FPRC;

|PROCESO impre; |TIPO 3;
|HAZ inicio;
|MENU elegir;
|SI FSalida > 0;
    |SI FSalida = 1;  |HAZ impresora;  |FINSI;
    |SI FSalida = 2;  |HAZ pantalla;   |FINSI;
|FINSI;
|FPRC;
