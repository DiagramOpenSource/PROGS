|FICHEROS;
    caemipa2 #0;
    capagcab #1;
    capaglin #2;
    cacuenta #3;
    caclipro #5;
|FIN;

|VARIABLES;
     nSwImpre = 0;

     &prov    = "";
     &prov1   = "";
     &cc1     = "";
     &cc2     = "";
     &cc3     = "";
     &des     = " ";
     &dni     = " ";
     &dir     = " ";
     &pob     = " ";
     &pro     = " ";
|FIN;
|INCLUYE acceso_i;

|PROCESO Mayus;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO capagcab;
     |SI #0#10 ! "A";
         |SI #0#10 ! #1#07;  |ERROR;  |ACABA;  |FINSI;  || emision
     |FINSI;

     |SI #0#11 ! "A";
         |SI #0#11 ! #1#08;  |ERROR;  |ACABA;  |FINSI;  || vencimiento
     |FINSI;

     des = "<CUENTA SIN DEFINIR>";
     dni = " ";
     dir = " ";
     pob = " ";
     pro = " ";

     #5#23 = "P";
     #5#10 = #1#1;
     #5#11 = #1#2;
     |LEE 000#5=;        || lee el proveedor
     |SI FSalida = 0;
         des = #5#1;
         dni = #5#9;
         dir = #5#2;
         pob = #5#6;
         |QBF pob;
         pob =  "(" + (("00"  + #5#3) % -102) + (("000" + #5#4) % -103) + ")" + pob;
         pro = #5#5;
     |SINO;
         #3#0 = #1#1;   || si no esta lee la cuenta del proveedor
         #3#1 = #1#2;
         |LEE 000#3=;
         |SI FSalida = 0;  des = #3#2;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO capaglin;
     nSwImpre = 1;
     |PRINT;
|FPRC;

|PROCESO Pie;
     |PIEINF;
|FPRC;

|DEFBUCLE capagcab;
     #1#1;
     5, 6, 1, 3, 14;
     #0#0, #0#2, #0#4, #0#6, #0#8, #0#15; || Pagare,F.emi,F.vto,Prove,Banco
     #0#1, #0#3, #0#5, #0#7, #0#9, #0#16;
     ;
     NULL, capagcab, capaglin, Pie;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "caemipa2";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |ABRE #3;
     |ABRE #5;
     |BUCLE capagcab;
     |SI nSwImpre = 0;
         |MENAV "    Seleccion vacia ...";
     |FINSI;
     |CIERRA #3;
     |CIERRA #5;

     |FININF;
     |FINIMP;
|FPRC;
