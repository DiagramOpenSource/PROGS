|FICHEROS;
     dsprem01 #1;
     dsprem02 #2,MANTE;
     dsprem08 #8,MANTE;
     dsprem03 #3;
     dsprem04 #4;
     dsprem99 #99;

     dsorm001 #201;

     referen1@ #900;
     referen2@ #901;
|FIN;

|VARIABLES;
     nForma1     = 0;
     nForma2     = 0;
     nForma3     = 0;
     nModo1      = 0;
     nModo2      = 0;
     nModo3      = 0;
     nHandle     = 0;
     nDSPreven   = 0;
     nCampo      = 0;
     nNume       = 0;
     nPregunta1  = 0;
     nPregunta2  = 0;
     nPregunta3  = 0;
     nPregunta4  = 0;
     nEmpresa    = 0;
     nDAgrupa    = 0;
     nHAgrupa    = 0;
     nCambio     = 0;

     aBase       = "";
     aMas        = "";
     aAlfa       = "";
     aAlfa1      = "";
     aMenu       = "";
     aFic        = "";
     aEjercicio  = "";
     aOrigen     = "";
     aDestino    = "";
     aFich       = "";
     aHora       = "";
     nReg        = 0;

     fFecha      = @;

     &enEmpresa   = 0;
     &enEmpreOri  = 0;
     &enPeriodo   = 0;
     &enPerioOri  = 0;
     &swOperacion = 0;
     &any_pos     = 0;
     &eaMoneda    = "";
     &fich_alta   = "";
     &eaExterno   = "";
     &eaCopiar    = "";
     &eaCeros     = "";
     &eaOtras     = "";
     &eaEmpresa   = "";

     &eaApli        = "";
     &eaEmpPat      = "";
     &eaEmpDes      = "";
     &enHay         = 0;
|FIN;

|RUTINA Baja01;
     #1#0 = nDAgrupa;
|FRUT;

|RUTINA Alta01;
     #1#0 = nHAgrupa;
|FRUT;

|RUTINA Baja02;
     #2#0 = #8#0;
     #2#1 = #8#1;
     #2#2 = 1;
|FRUT;

|RUTINA Alta02;
     #2#0 = #8#0;
     #2#1 = #8#1;
     #2#2 = 99;
|FRUT;

|RUTINA Baja08;
     #8#0 = #1#0;
     #8#1 = 1;
|FRUT;

|RUTINA Alta08;
     #8#0 = #1#0;
     #8#1 = 99;
|FRUT;

|PROCESO dsprem04B;
     |BORRA 020#4a;
     |LIBERA #4;

     |HORA aHora;

     |ABRE #99;
     nReg = 1;
     |LEE 000#99u;
     |SI FSalida = 0;
         nReg = #99#0 + 1;
     |FINSI;

     #99#0  = nReg;
     |GRABA 020#99b;

     #99#1  = #4#5;
     #99#2  = ~;
     #99#3  = aHora;
     #99#4  = "B";
     #99#5  = "BAJA DEL USUARIO DESDE DEFINICION DE AGRUPACIONES";
     #99#6  = #4#0 + (("00" + #4#1) % -102) + (("00" + #4#2) % -102);
     #99#7  = #4#3;
     #99#8  = #4#4;
     #99#9  = #3#5;
     #99#10 = #3#6;
     #99#11 = #3#7;
     #99#12 = #3#8;
     #99#13 = #3#9;
     #99#14 = #3#10;
     #99#15 = #4#9;
     #99#16 = #4#10;
     #99#17 = #4#11;
     #99#18 = #3#11;
     #99#19 = #4#8;
     #99#20 = Usuario % 810;
     |GRABA 020#99a;
     |LIBERA #99;
     |CIERRA #99;
|FPRC;

|DEFBUCLE dsprem04B;
     #4#1;
     ;
     #3#0, #3#1, #3#2, #3#3, #3#4, "          ";
     #3#0, #3#1, #3#2, #3#3, #3#4, "zzzzzzzzzz";
     be;
     NULL, dsprem04B;
|FIN;

|PROCESO dsprem03B;
     |BUCLE dsprem04B;

     |BORRA 020#3a;
     |LIBERA #3;

     #201#0 = #3#11;
     |LEE 101#201=;
     |SI FSalida = 0;
         |BORRA 020#201a;
     |FINSI;
     |LIBERA #201;
|FPRC;

|DEFBUCLE dsprem03B;
     #3#1;
     ;
     #2#0, #2#1, #2#2, 01, 01;
     #2#0, #2#1, #2#2, 99, 99;
     be;
     NULL, dsprem03B;
|FIN;

|PROCESO dsprem02B;
     |ABRE #201;
     |BUCLE dsprem03B;
     |CIERRA #201;

     |BORRA 020#2a;
     |LIBERA #2;
|FPRC;

|DEFBUCLE dsprem02B;
     #2#1;
     ;
     #8#0, #8#1, 01;
     #8#0, #8#1, 99;
     be;
     NULL, dsprem02B;
|FIN;

|PROCESO dsprem08B;
     |BUCLE dsprem02B;

     |BORRA 020#8a;
     |LIBERA #8;
|FPRC;

|DEFBUCLE dsprem08B;
     #8#1;
     ;
     #1#0, 01;
     #1#0, 99;
     be;
     NULL, dsprem08B;
|FIN;

|| --------------------------------------------------------------------------
|| Procesos del dsprem02
|| --------------------------------------------------------------------------

|PROCESO Tipo7C2F2;  |TIPO 66;
     |SI nDSPreven ! 2;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dscurm01.mas";
     |CARGA_DEF aMas, referen1@;

     |ABRE #900;
     #900#0 = #2#0;
     #900#1 = #2#1;
     #900#2 = #2#2;
     |LEE 040#900=;
     |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;

     |CONSULTA_CLAVE #1#900;
     |SI FSalida = 0;
         #2#2 = #900#2;
         |PINTA #2#2;
         |ERROR;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Tipo0C2F2;  |TIPO 0;
     |SI nDSPreven ! 2;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dscurm01.mas";
     |CARGA_DEF aMas, referen1@;

     |ABRE #900;
     #900#0 = #2#0;
     #900#1 = #2#1;
     #900#2 = #2#2;
     |LEE 040#900=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe el Curso.";
         |ERROR;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Tipo0C5F2;  |TIPO 0;
     |C_M #2#6, 1, "S";
     |C_M #2#7, 1, "S";
     |C_M #2#8, 1, "S";
     |SI #2#5 = "S";
         |C_M #2#6, 1, "N";  #2#6  = 0;  |PINTA #2#6;
         |C_M #2#7, 1, "N";  #2#7  = 0;  |PINTA #2#7;
         |C_M #2#8, 1, "N";  #2#8  = 0;  |PINTA #2#8;
                             #2#9  = ""; |PINTA #2#9;
                             #2#10 = ""; |PINTA #2#10;
                             #2#11 = ""; |PINTA #2#11;
     |FINSI;
|FPRC;

|PROCESO Tipo0C6F2;  |TIPO 0;
     |SI #2#5 = "S";  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsprem01.mas";
     |CARGA_DEF aMas, referen1@;

     |ABRE #900;
     #900#0 = #2#6;
     |LEE 040#900=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Region Principal.";
         |ERROR;
     |SINO;
         #2#9 = #900#1;  |PINTA #2#9;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Tipo0C7F2;  |TIPO 0;
     |SI #2#5 = "S";  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsprem08.mas";
     |CARGA_DEF aMas, referen1@;

     |ABRE #900;
     #900#0 = #2#6;
     #900#1 = #2#7;
     |LEE 040#900=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Delegacion Principal.";
         |ERROR;
     |SINO;
         #2#10 = #900#2;  |PINTA #2#10;
         aAlfa = #2#10;   |QBF aAlfa;
         |SI aAlfa = "";
             #2#10 = #8#2;  |PINTA #2#10;
         |FINSI;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Tipo0C8F2;  |TIPO 0;
     |SI #2#5 = "S";  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dsprem02.mas";
     |CARGA_DEF aMas, referen1@;

     |ABRE #900;
     #900#0 = #2#6;
     #900#1 = #2#7;
     #900#2 = #2#8;
     |LEE 040#900=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Agencia Principal.";
         |ERROR;
     |SINO;
         #2#11 = #900#3;  |PINTA #2#11;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO AltaContabilidad;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/canempre.mas";
     aFic = aBase + "contagen/fich/";

     |CARGA_DEF aMas, referen1@;
     |CARGA_DEF aMas, referen2@;

     |PATH_DAT #900 aFic;
     |PATH_DAT #901 aFic;

     |ABRE #900;
     |ABRE #901;

     |SI nDSPreven = 1;
         #901#2 = 99999;
         #901#3 = 9;
     |SINO;
         aAlfa  = #2#0 + "9999";
         #901#2 = aAlfa;
         #901#3 = 9;
     |FINSI;

     |LEE 000#901=;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               #900nCampo = #901nCampo;
         |SIGUE;

         #900#2  = #2#12;
         #900#3  = aEjercicio;
         aAlfa1  = (("00000" + #900#2) % -105) + #900#3;
         #900#0  = aAlfa1;
         #900#1  = #2#3;
         #900#4  = #2#3;
         #900#5  = "";
         #900#6  = "";
         #900#7  = "";
         #900#8  = "";
         #900#10 = "";
         #900#11 = "";
         #900#22 = "O";       || subdepartamento OTROS
         #900#24 = "S";       || departamento SI
         #900#26 = aEjercicio;
         #900#28 = "E";

         |SI #900#26 ] 80;
             nNume = 1900 + #900#26;
         |SINO;
             nNume = 2000 + #900#26;
         |FINSI;
         aAlfa   =  "[" + (("00000" + #900#2) % -105) + "/" + nNume + "] " + #900#1;
         #900#29 = aAlfa;
         |GRABA 020#900n;
         |LIBERA #900;
         |CIERRA #900;

         aAlfa = aBase + "contagen/fich/" + (("000000" + #900#0) % -106);
         |MKDIR aAlfa;

         enEmpresa   = #900#2;
         enPeriodo   = #900#3;
         eaMoneda    = #900#28;
         swOperacion = 3;
         |SUB_EJECUTA_NP ":contagen/camoneda";
         swOperacion = 0;

         fich_alta  = aAlfa + "/";
         any_pos    = #900#26;
         eaExterno  = fich_alta;
         enEmpreOri = #901#2;
         enPerioOri = #901#3;
         eaCopiar   = "T";
         eaCeros    = "S";
         eaOtras    = "N";
         |SUB_EJECUTA ":contagen/cacrebal";
     |SINO;
         aAlfa1 = "0000Empresa [" + #901#2 + "." + #901#3 + "] inaccesible.";
         |MENAV aAlfa1;
     |FINSI;

     |DESCARGA_DEF #referen2@;
     |DESCARGA_DEF #referen1@;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/camandep.mas";
     aFic = aBase + "contagen/fich/000000/";

     |CARGA_DEF aMas, referen1@;
     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #2#12;
     #900#1 = #2#13;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #2#12;
         #900#1 = #2#13;
         aAlfa  = #2#10;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #8#2;  |FINSI;
         #900#2 = aAlfa;
         |GRABA 020#900n;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "contagen/def/camansde.mas";
     aFic = aBase + "contagen/fich/000000/";

     |CARGA_DEF aMas, referen1@;
     |PATH_DAT #900 aFic;

     |ABRE #900;
     #900#0 = #2#12;
     #900#1 = #2#13;
     #900#2 = #2#14;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #2#12;
         #900#1 = #2#13;
         #900#2 = #2#14;

         aAlfa  = #2#10;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #8#2;  |FINSI;
         #900#3 = aAlfa;

         aAlfa  = #2#11;  |QBF aAlfa;
         |SI aAlfa = "";  aAlfa = #2#3;  |FINSI;
         |GRABA 020#900n;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO DefAsiento;
     aAlfa  = aBase + "contagen/";
     #900#6 = aAlfa;
     #900#4 = #2#12;
     #900#5 = aEjercicio;

     |GRABA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE DefAsiento;
     #900#1001;
     ;
     "    ";
     "zzzz";
     be;
     NULL, DefAsiento;
|FIN;

|PROCESO AstosSeries;
     aAlfa  = ("00000" + nEmpresa) % -105;
     #900#2 = aAlfa;
     |GRABA 020#900a; |LIBERA #900;
|FPRC;

|DEFBUCLE AstosSeries;
     #900#1003;
     ;
     "     ", " ", " ";
     "zzzzz", "z", "z";
     be;
     NULL, AstosSeries;
|FIN;

|PROCESO AltaControlGestion;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa142.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         |LEE 101#900p;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             |GRABA 020#900b;
         |FINSI;
         aAlfa    = aBase + "contagen/";
         #900#151 = aAlfa;
         aAlfa    = (("00000" + #2#12) % -105) + aEjercicio;
         #900#152 = aAlfa;

         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa141.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         |LEE 101#900p;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             |GRABA 020#900b;
         |FINSI;
         aAlfa    = aBase + "contagen/";

         #900#11  = aAlfa;
         #900#0   = #2#12;
         #900#8   = aEjercicio;

         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa704.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |BUCLE DefAsiento;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/malpe115.mas";
     aFic = aBase + "dscomer9/fich/" + (("00000" + nEmpresa) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |BUCLE AstosSeries;

         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaGestion;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa041.mas";
     aFic = aBase + "dscomer9/fich/";

     |CARGA_DEF aMas, referen1@;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     |DDEFECTO #900;
     #900#0  = #2#16;
     #900#1  = #2#3;
     #900#8  = "~~~~~~~~~~";
     |GRABA 020#900n;
     |LIBERA #900;
     |CIERRA #900;

     aAlfa = aBase + "dscomer9/fich/" + (("00000" + #900#0) % -105);
     |MKDIR aAlfa;

     eaApli   = "dscomer9";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     enHay    = 0;
     |SUB_EJECUTA "dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de la Gestion] inaccesible.";
     |FINSI;

     nEmpresa = #900#0;

     |DESCARGA_DEF #referen1@;

     eaEmpresa = ("00000" + #2#16) % -105;
     |SUB_EJECUTA_NP ":dscomer9/agifa041;PATRONES";

     |HAZ AltaControlGestion;
|FPRC;

|PROCESO AltaControlCartera;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam044.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #2#15;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #2#15;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "dscomer9/";
         #900#1 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam045.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #2#15;
         #900#1 = 1;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #2#15;
             #900#1 = 1;
             #900#2 = "V";
             #900#3 = "VENTAS";
             #900#4 = "";
             #900#5 = "zzzzz";
             #900#6 = #2#15;
             |GRABA 020#900n;
         |SINO;
             #900#6 = #2#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         #900#0 = #2#15;
         #900#1 = 2;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #2#15;
             #900#1 = 2;
             #900#2 = "C";
             #900#3 = "COMPRAS";
             #900#4 = "";
             #900#5 = "zzzzz";
             #900#6 = #2#15;
             |GRABA 020#900n;
         |SINO;
             #900#6 = #2#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam037.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #2#15;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #2#15;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "dscomer9/";
         #900#2 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam038.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

          |ABRE #900;

          #900#0 = #2#15;
          #900#1 = 1;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #2#15;
              #900#1 = 1;
              #900#2 = "F";
              #900#7 = "Facturas";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #2#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #2#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          #900#0 = #2#15;
          #900#1 = 2;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #2#15;
              #900#1 = 2;
              #900#2 = "A";
              #900#7 = "Albaranes";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #2#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #2#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          #900#0 = #2#15;
          #900#1 = 3;
          |LEE 101#900=;
          |SI FSalida ! 0;
              #900#0 = #2#15;
              #900#1 = 3;
              #900#2 = "P";
              #900#7 = "Pedido";
              #900#3 = "";
              #900#4 = "zzzzz";
              #900#5 = #2#15;
              #900#6 = 01;
              #900#8 = "R";
              |GRABA 020#900n;
          |SINO;
              #900#5 = #2#15;
              |GRABA 020#900a;
          |FINSI;
          |LIBERA #900;

          |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam042.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #2#12;
         #900#1 = aEjercicio;
         |LEE 101#900=;
         |SI FSalida ! 0;
             |DDEFECTO #900;
             #900#0 = #2#12;
             #900#1 = aEjercicio;
             |GRABA 020#900b;
         |FINSI;
         aAlfa  = aBase + "contagen/";
         #900#2 = aAlfa;
         |GRABA 020#900a;
         |LIBERA #900;
         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam043.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;

         #900#0 = #2#12;
         #900#1 = aEjercicio;
         #900#2 = 1;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #2#12;
             #900#1 = aEjercicio;
             #900#2 = 1;
             #900#3 = "V";
             #900#4 = "VENTAS";
             #900#5 = 0;
             #900#6 = 99;
             #900#7 = "";
             #900#8 = "zzzzz";
             #900#9 = #2#15;
             |GRABA 020#900n;
         |SINO;
             #900#9 = #2#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         #900#0 = #2#12;
         #900#1 = aEjercicio;
         #900#2 = 2;
         |LEE 101#900=;
         |SI FSalida ! 0;
             #900#0 = #2#12;
             #900#1 = aEjercicio;
             #900#2 = 2;
             #900#3 = "C";
             #900#4 = "COMPRAS";
             #900#5 = 0;
             #900#6 = 99;
             #900#7 = "";
             #900#8 = "zzzzz";
             #900#9 = #2#15;
             |GRABA 020#900n;
         |SINO;
             #900#9 = #2#15;
             |GRABA 020#900a;
         |FINSI;
         |LIBERA #900;

         |CIERRA #900;

         |DESCARGA_DEF #referen1@;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam030.mas";
     aFic = aBase + "dscarter/fich/" + (("00000" + #2#15) % -105) + "/";

     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |BUCLE DefAsiento;

         |DESCARGA_DEF #referen1@;
     |FINSI;
|FPRC;

|PROCESO AltaCartera;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscarter/def/dscam000.mas";
     aFic = aBase + "dscarter/fich/";

     |CARGA_DEF aMas, referen1@;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     |DDEFECTO #900;
     #900#0  = #2#15;
     #900#1  = #2#3;
     #900#14 = #2#12;
     #900#15 = #2#16;
     aAlfa   = aBase + "contagen/";
     #900#16 = aAlfa;
     aAlfa   = aBase + "dscomer9/";
     #900#17 = aAlfa;
     #900#18 = "~~~~~~~~~~";
     #900#19 = aEjercicio;
     |GRABA 020#900n;
     |LIBERA #900;
     |CIERRA #900;

     aAlfa = aBase + "dscarter/fich/" + (("00000" + #900#0) % -105);
     |MKDIR aAlfa;

     eaApli   = "dscarter";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     |SUB_EJECUTA ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de Cartera ] inaccesible.";
     |FINSI;

     |DESCARGA_DEF #referen1@;

     |HAZ AltaControlCartera;
|FPRC;

|PROCESO AltaTesoreria;
     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dstesor/def/dstem000.mas";
     aFic = aBase + "dstesor/fich/";

     |CARGA_DEF aMas, referen1@;

     |PATH_DAT #900 aFic;

     |ABRE #900;
     |DDEFECTO #900;
     #900#0  = #2#15;
     #900#1  = #2#3;
     #900#2  = #2#12;
     #900#3  = aEjercicio;
     #900#4  = #2#4;
     #900#5  = "S";
     #900#6  = "~~~~~~~~~~";

     |GRABA 020#900n;
     |LIBERA #900;
     |CIERRA #900;

     aAlfa = aBase + "dstesor/fich/" + (("00000" + #900#0) % -105);
     |MKDIR aAlfa;

     eaApli   = "dstesor";
     eaEmpPat = "99999";
     eaEmpDes = (("00000" + #900#0) % -105);
     enHay    = 0;
     |SUB_EJECUTA ":dsoporte/dsorz013";

     |SI enHay = 0;
          |MENAV "0000 La empresa [99999-Patrones de la Gestion de Tesoreria] inaccesible.";
     |FINSI;

     |DESCARGA_DEF #referen1@;
|FPRC;

|PROCESO Crealos;
     |SI nPregunta1 = 1;  |HAZ AltaContabilidad;  |FINSI;
     |SI nPregunta2 = 1;  |HAZ AltaGestion;       |FINSI;
     |SI nPregunta3 = 1;  |HAZ AltaCartera;       |FINSI;
     |SI nPregunta4 = 1;  |HAZ AltaTesoreria;     |FINSI;
|FPRC;

|PROCESO Tipo2F2;  |TIPO 2;
     nModo3 = (FEntrada / 100) ! 0;
     |SI nModo3 = 3;
         |CONFI "0000NSeguro de Borrar la Agencia y todos su Registros asociados ";
         |SI FSalida = 0;
             |ABRE #201;
             |BUCLE dsprem03B;
             |CIERRA #201;
         |SINO;
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     nForma3 = 0 +. 1;
     |SI nForma3 ! 1;  |ACABA;  |FINSI;

     |SI #2#5 = "S";
         aAlfa  = #2#0 + (("00"  + #2#1) % -102) + (("00" + #2#2) % -102);
         aAlfa1 = #2#0 + (("00"  + #2#1) % -102) + (("00" + #2#2) % -102);
         #2#13  = ("00"  + #2#1) % -102;
         #2#14  = ("000" + #2#2) % -103;
     |SINO;
         aAlfa  = #2#6 + (("00"  + #2#7) % -102) + (("00" + #2#8) % -102);
         aAlfa1 = #2#0 + (("00"  + #2#1) % -102) + (("00" + #2#2) % -102);
         #2#13  = ("00"  + #2#7) % -102;
         #2#14  = ("000" + #2#8) % -103;
     |FINSI;

     #2#12 = aAlfa;
     #2#15 = aAlfa;
     #2#16 = aAlfa;
     #2#17 = aAlfa1;
     #2#18 = aAlfa1;
     #2#19 = aAlfa1;

     fFecha     = ~;
     aEjercicio = fFecha % -101;
     nPregunta1 = 0;
     nPregunta2 = 0;
     nPregunta3 = 0;
     nPregunta4 = 0;

     |SI #2#5 = "S";
         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "contagen/def/canempre.mas";
         aFic = aBase + "contagen/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#2 = #2#12;
             #900#3 = aEjercicio;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta1 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dscomer9/def/agifa041.mas";
         aFic = aBase + "dscomer9/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #2#16;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta2 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dscarter/def/dscam000.mas";
         aFic = aBase + "dscarter/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #2#15;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta3 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;

         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dstesor/def/dstem000.mas";
         aFic = aBase + "dstesor/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;

             |ABRE #900;
             #900#0 = #2#15;
             |LEE 000#900=;
             |SI FSalida ! 0;  nPregunta4 = 1;  |FINSI;
             |CIERRA #900;

             |DESCARGA_DEF #referen1@;
         |FINSI;
     |FINSI;

     nCambio = 0;
     |SI nPregunta4 = 1;  |Y nPregunta3 = 0;
         nPregunta3 = 1;
         nCambio    = 1;
     |FINSI;

     |SI nPregunta1 = 1;  |Y nPregunta2 = 1;  |Y nPregunta3 = 1;
         |CONFI "0000S Crear la Contabilidad, Cobros-Pagos y Facturacion ";
     |FINSI;

     |SI nPregunta1 = 1;  |Y nPregunta2 = 0;  |Y nPregunta3 = 1;
         |CONFI "0000S Crear la Contabilidad y Cobros-Pagos";
     |FINSI;

     |SI nPregunta1 = 1;  |Y nPregunta2 = 1;  |Y nPregunta3 = 0;
         |CONFI "0000S Crear la Contabilidad y Facturacion";
     |FINSI;

     |SI nPregunta1 = 0;  |Y nPregunta2 = 1;  |Y nPregunta3 = 1;
         |CONFI "0000S Crear Cobros-Pagos y Facturacion ";
     |FINSI;

     |SI nPregunta1 = 1;  |Y nPregunta2 = 0;  |Y nPregunta3 = 0;
         |CONFI "0000S Crear la Contabilidad";
     |FINSI;

     |SI nPregunta1 = 0;  |Y nPregunta2 = 1;  |Y nPregunta3 = 0;
         |CONFI "0000S Crear la Facturacion";
     |FINSI;

     |SI nPregunta1 = 0;  |Y nPregunta2 = 0;  |Y nPregunta3 = 1;
         |CONFI "0000S Crear Cobros-Pagos";
     |FINSI;

     |SI nCambio = 1;  nPregunta3 = 0;  |FINSI;

     |SI FSalida = 0;
         |HAZ Crealos;
     |FINSI;

     |DBASS aBase;  |QBF aBase;
     aMas = aBase + "dscomer9/def/agifa041.mas";
     aFic = aBase + "dscomer9/fich/";
     |CARGA_DEF aMas, referen1@;
     |SI FSalida = 0;
         |PATH_DAT #900 aFic;

         |ABRE #900;
         #900#0 = #2#16;
         |LEE 000#900=;
         |SI FSalida = 0;
             aMas = aBase + "dscomer9/def/agifa007.mas";
             |CARGA_DEF aMas, referen2@;
             |SI FSalida = 0;
                 aFic = aBase + "dscomer9/fich/" + (("00000" + #2#16) % -105) + "/";
                 |PATH_DAT #901 aFic;
                 |ABRE #901;
                 #901#26 = #2#17;
                 |LEE 101#901=;
                 |SI FSalida ! 0;
                     #901#26 = "     ";
                     |LEE 000#901=;
                     |SI FSalida ! 0; |DDEFECTO #901; |FINSI;
                     #901#26 = #2#17;
                                      aAlfa = #2#11;  |QBF aAlfa;
                     |SI aAlfa = "";  aAlfa = #2#3;  |FINSI;
                     #901#27 = aAlfa;
                     |GRABA 020#901n;
                 |FINSI;
                 |CIERRA #901;
                 |DESCARGA_DEF #referen2@;
             |FINSI;

             aMas = aBase + "dscomer9/def/agifa029.mas";
             |CARGA_DEF aMas, referen2@;
             |SI FSalida = 0;
                 aFic = aBase + "dscomer9/fich/" + (("00000" + #2#16) % -105) + "/";
                 |PATH_DAT #901 aFic;
                 |ABRE #901;
                 #901#0 = #2#18;
                 |LEE 101#901=;
                 |SI FSalida ! 0;
                     |DDEFECTO #901;
                     #901#0 = #2#18;
                                      aAlfa = #2#11;  |QBF aAlfa;
                     |SI aAlfa = "";  aAlfa = #2#3;  |FINSI;
                     #901#1 = aAlfa;
                     |GRABA 020#901n;
                 |FINSI;
                 |CIERRA #901;
                 |DESCARGA_DEF #referen2@;
             |FINSI;
         |FINSI;

        |DESCARGA_DEF #referen1@;
     |FINSI;

|FPRC;

|| --------------------------------------------------------------------------
|| Procesos del dsprem08
|| --------------------------------------------------------------------------

|PROCESO Tipo2F8;  |TIPO 2;
     nModo2 = (FEntrada / 100) ! 0;
     |SI nModo2 = 3;
         |CONFI "0000NSeguro de Borrar la Delegacion y todos su Registros asociados ";
         |SI FSalida = 0;
             |BUCLE dsprem02B;
         |SINO;
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     nForma2 = 0 +. 1;
     |SI nForma2 ! 1;  |ACABA;  |FINSI;

     |ENTLINEAL #1#2, -3, 2, 12, 0, Baja02, Alta02;
|FPRC;

|PROCESO Tipo0C1F8;  |TIPO 0;
|FPRC;

|PROCESO Tipo7C1F8;  |TIPO 7;
     |ENTLINEAL #1#2, -3, 7, 12, 0, Baja02, Alta02;
|FPRC;

|| --------------------------------------------------------------------------
|| Procesos del dsprem01
|| --------------------------------------------------------------------------

|PROCESO Tipo2F1;  |TIPO 2;
     nModo1 = (FEntrada / 100) ! 0;
     |SI nModo1 = 3;
         |CONFI "0000NSeguro de Borrar la Region y todos su Registros asociados ";
         |SI FSalida = 0;
             |BUCLE dsprem08B;
         |SINO;
             |ERROR;
         |FINSI;
         |ACABA;
     |FINSI;

     nForma1 = 0 +. 1;
     |SI nForma1 ! 1;  |ACABA;  |FINSI;

     |ENTLINEAL #1#8, -2, 2, 12, 0, Baja08, Alta08;
|FPRC;

|PROCESO Tipo0C0F1;  |TIPO 0;
|FPRC;

|PROCESO Tipo7C0F1;  |TIPO 7;
     |ENTLINEAL #1#8, -2, 7, 12, 0, Baja08, Alta08;

     |ABRE #2;
     #2#0 = #1#0;
     #2#1 = 1;
     #2#2 = 1;
     |LEE 040#2];
     |SI FSalida ! 0;  |O  #2#0 ! #1#0;
         |DDEFECTO #2;
     |FINSI;
     |CIERRA #2;

     |ENTLINEAL #1#2, -3, 7, 12, 0, Baja02, Alta02;
|FPRC;

|PROCESO dsprem02D;
     #8#0 = #2#0;
     #8#1 = #2#1;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     #900#0 = #2#19;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #2#19;
         |GRABA 020#900b;
     |FINSI;

     #900#1 = #8#2;
     #900#2 = #2#3;
     |GRABA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE dsprem02D;
     #2#1;
     ;
     0, 00, 00;
     9, 99, 99;
     be;
     NULL, dsprem02D;
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA "Definicion de Agrupaciones";

     |PINPA #0#1;

     nDSPreven = 0;
     |DBASS aBase;  |QBF aBase;
     aMenu = aBase + "dspreven/def/maesm011.mas";
     |XABRE "E", aMenu, nHandle;
     |SI FSalida ] 0;
         |ATRI R;
         |PINTA 0602, "Regiones      ";
         |PINTA 0626, "Delegaciones  ";
         |PINTA 0651, "Agencias      ";
         |ATRI r;

         |PINTA 1702, "Region Principal .......:";
         |PINTA 1902, "Delegacion Principal ...:";
         |PINTA 2102, "Agencia Principal ......:";

         nDAgrupa  = 0;
         nHAgrupa  = 9;
         nDSPreven = 1;
     |SINO;
         |DBASE aBase;  |QBF aBase;
         aMenu = aBase + "dscursos.men";
         |XABRE "E", aMenu, nHandle;
         |SI FSalida ] 0;
             |ATRI R;
             |PINTA 0602, "Curso Base    ";
             |PINTA 0626, "Curso         ";
             |PINTA 0651, "Usuario       ";
             |ATRI r;

             |PINTA 1702, "Curso Base Principal ...:";
             |PINTA 1902, "Curso Principal ........:";
             |PINTA 2102, "Usuario Principal ......:";

             nDAgrupa  = 0;
             nHAgrupa  = 9;
             nDSPreven = 2;
         |SINO;
             |DBASS aBase;  |QBF aBase;
             aAlfa    = aBase % -201;
             nDAgrupa = aAlfa;
             nHAgrupa = aAlfa;
             |SI nDAgrupa = 0;
                 nDAgrupa = 1;
                 nHAgrupa = 1;
             |FINSI;

             |ATRI R;
             |PINTA 0602, "Asesores      ";
             |PINTA 0626, "Clientes      ";
             |PINTA 0651, "Delegaciones  ";
             |ATRI r;

             |PINTA 1702, "Asesor Principal .......:";
             |PINTA 1902, "Cliente Principal ......:";
             |PINTA 2102, "Delegacion Principal ...:";
         |FINSI;
     |FINSI;

     |ENTLINEAL #1#1, -1, 2, 12, 0, Baja01, Alta01;

     |SI nDSPreven = 1;
         |DBASS aBase;  |QBF aBase;
         aMas = aBase + "dspreven/def/maesm001.mas";
         aFic = aBase + "dspreven/fich/";
         |CARGA_DEF aMas, referen1@;
         |SI FSalida = 0;
             |PATH_DAT #900 aFic;
             |ABRE #900;  |CIERRA #900;  |DELINDEX #900;

             |ABRE #900;
             |ABRE #8;
             |BUCLE dsprem02D;
             |CIERRA #900;
             |CIERRA #8;

             |DESCARGA_DEF #referen1@;
         |FINSI;
     |FINSI;
|FPRO;
