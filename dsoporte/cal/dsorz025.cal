|FICHEROS;
     dsprem03;
     dsprem04;
     dsprem07;

     dsorm002;
     dsorm003;
     dsorm004;

     dsorw008;
     dsorw010;
     dsorw017,MANTE;
|FIN;

|VARIABLES;
     aEsc                = "";
     aRetu               = "";
     aTecla              = "";
     aEsc1               = "";
     aEsc2               = "";
     aFichero            = "";
     aAlfa               = "";
     aAbre               = "";
     aBase               = "";
     aUsuario            = "";
     aNombre             = "";
     aMas                = "";
     aDAlfa              = "";
     aHAlfa              = "";

     nVentana            = 0;
     nVentTrab           = 0;
     nGrid07             = 0;
     nGrid08             = 0;
     nGrid10             = 0;
     nRango              = -1;
     nHandle             = -1;
     nBoton1             = -1;
     nBoton2             = -1;
     nBoton3             = -1;
     nBoton4             = -1;
     nBoton5             = -1;
     nPosi               = -1;
     nGrupo              = -1;
     nPasada             = -1;
     nBtnGnral           = -1;
     nHayMenuGnral       = 0;

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &eaCab              = "";
     &enPRM              = 0;
     &enError            = 0;
     &enPoner            = 0;
|FIN;

|PROCESO dsprem03Baja;
     |BORRA 020#dsprem03.a;
     |LIBERA #dsprem03;
|FPRC;

|DEFBUCLE dsprem03Baja;
     #dsprem03#1;
     ;
     0, 00, 00, #dsprem07#0, #dsprem07#1;
     9, 99, 99, #dsprem07#0, #dsprem07#1;
     be;
     NULL, dsprem03Baja;
|FIN;

|PROCESO dsorm003Baja;
     |BORRA 020#dsorm003.a;
     |LIBERA #dsorm003;
|FPRC;

|DEFBUCLE dsorm003Baja;
     #dsorm003#1;
     ;
     nGrupo, "        ", "        ", aDAlfa;
     nGrupo, "zzzzzzzz", "zzzzzzzz", aHAlfa;
     be;
     NULL, dsorm003Baja;
|FIN;

|PROCESO dsorm004Baja;
     |BORRA 020#dsorm004.a;
     |LIBERA #dsorm004;
|FPRC;

|DEFBUCLE dsorm004Baja;
     #dsorm004#1;
     ;
     nGrupo, "        ", "        ";
     nGrupo, "zzzzzzzz", "zzzzzzzz";
     be;
     NULL, dsorm004Baja;
|FIN;

|PROCESO PonMenuGeneral;
     |ABRE #dsorm003;
     #dsorm003#0 = nGrupo;
     #dsorm003#1 = "menugnrl";
     #dsorm003#2 = "ds";
     #dsorm003#6 = "";
     |LEE 000#dsorm003.];
     |SI FSalida = 0;  |Y #dsorm003#0 = nGrupo; |Y #dsorm003#1 = "menugnrl";
                       |Y #dsorm003#2 = "ds      ";
         #dsorw008#0 = nGrupo;
         #dsorw008#1 = "menugnrl";
         |LEE 101#dsorw008.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsorw008;
             #dsorw008#0 = nGrupo;
             #dsorw008#1 = "menugnrl";
             #dsorw008#2 = "Menu General";
             |GRABA 020#dsorw008.n;

             |ABRE #dsorw010;
             #dsorw010#0 = #dsorw008#0;
             #dsorw010#1 = #dsorw008#1;
             #dsorw010#2 = "ds";
             |LEE 101#dsorw010.=;
             |SI FSalida ! 0;
                 |DDEFECTO #dsorw010;
                 #dsorw010#0 = #dsorw008#0;
                 #dsorw010#1 = #dsorw008#1;
                 #dsorw010#2 = "ds";
                 |GRABA 020#dsorw010.b;
             |FINSI;

             #dsorw010#3 = #dsorm003#4;
             #dsorw010#4 = #dsorm003#7;

                                   #dsorw010#5 = "QUITAR ACCESO";
             |SI #dsorm003#8 = 2;  #dsorw010#5 = "MENSAJE        ";  |FINSI;

             |GRABA 020#dsorw010.a;
             |LIBERA #dsorw010;

             nHayMenuGnral = 1;
         |FINSI;
         |LIBERA #dsorw008;
     |FINSI;
     |CIERRA #dsorm003;
|FPRC;

|PROCESO dsorm002;
     |SI nPasada = 0;
         |HAZ PonMenuGeneral;
     |FINSI;

     #dsorw008#0 = nGrupo;
     #dsorw008#1 = #dsorm002#0;
     |LEE 101#dsorw008.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsorw008;
         #dsorw008#0 = nGrupo;
         #dsorw008#1 = #dsorm002#0;
         #dsorw008#2 = #dsorm002#2;
         |GRABA 020#dsorw008.n;
     |FINSI;
     |LIBERA #dsorw008;

     #dsorw010#0 = #dsorw008#0;
     #dsorw010#1 = #dsorw008#1;
     #dsorw010#2 = #dsorm002#1;
     |LEE 101#dsorw010.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsorw010;
         #dsorw010#0 = #dsorw008#0;
         #dsorw010#1 = #dsorw008#1;
         #dsorw010#2 = #dsorm002#1;

         |GRABA 020#dsorw010.b;
     |FINSI;

     |ABRE #dsorm003;
     #dsorm003#0 = #dsorw010#0;
     #dsorm003#1 = #dsorw010#1;
     #dsorm003#2 = #dsorw010#2;
     #dsorm003#6 = "";
     |LEE 040#dsorm003.];
     |SI FSalida = 0;  |Y #dsorm003#0 = #dsorw010#0; |Y #dsorm003#1 = #dsorw010#1;
                       |Y #dsorm003#2 = #dsorw010#2;
         #dsorw010#3 = #dsorm003#4;
         #dsorw010#4 = #dsorm003#7;

                               #dsorw010#5 = "QUITAR ACCESO";
         |SI #dsorm003#8 = 2;  #dsorw010#5 = "MENSAJE        ";  |FINSI;
     |FINSI;
     |CIERRA #dsorm003;

     |SI nGrupo = 0;
         #dsorw010#3 = "N";
         #dsorw010#4 = "N";
         #dsorw010#5 = "";
     |FINSI;

     |GRABA 020#dsorw010.a;
     |LIBERA #dsorw010;

     nPasada = 1;
|FPRC;

|DEFBUCLE dsorm002;
     #dsorm002#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsorm002;
|FIN;

|PROCESO Evento08;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dsorw008.=;

         |REFRESCACONTROL nGrid10;
     |FINSI;
|FPRC;

|PROCESO Evento10;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dsorw010.=;
     |FINSI;
|FPRC;

|PROCESO Baja10;
     #dsorw010#0 = #dsorw008#0;
     #dsorw010#1 = #dsorw008#1;
     #dsorw010#2 = "";
|FPRC;

|PROCESO Alta10;
     #dsorw010#0 = #dsorw008#0;
     #dsorw010#1 = #dsorw008#1;
     #dsorw010#2 = "zzzzzzzz";
|FPRC;

|PROCESO ActivaGnral;
     |CONFI "0000SSeguro que quiere activar el men£ general en el Area / Nivel";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsorw008#0 = nGrupo;
     #dsorw008#1 = "menugnrl";
     |LEE 101#dsorw008.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |DDEFECTO #dsorw008;
     #dsorw008#0 = nGrupo;
     #dsorw008#1 = "menugnrl";
     #dsorw008#2 = "Menu General";
     |GRABA 020#dsorw008.n;
     |LIBERA #dsorw008;

     #dsorw010#0 = #dsorw008#0;
     #dsorw010#1 = #dsorw008#1;
     #dsorw010#2 = "ds";
     |LEE 101#dsorw010.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsorw010;
         #dsorw010#0 = #dsorw008#0;
         #dsorw010#1 = #dsorw008#1;
         #dsorw010#2 = "ds";

         |GRABA 020#dsorw010.b;
     |FINSI;

     |ABRE #dsorm003;
     #dsorm003#0 = #dsorw010#0;
     #dsorm003#1 = #dsorw010#1;
     #dsorm003#2 = #dsorw010#2;
     #dsorm003#6 = "";
     |LEE 040#dsorm003.];
     |SI FSalida = 0;  |Y #dsorm003#0 = #dsorw010#0; |Y #dsorm003#1 = #dsorw010#1;
                       |Y #dsorm003#2 = #dsorw010#2;
         #dsorw010#3 = #dsorm003#4;
         #dsorw010#4 = #dsorm003#7;

                               #dsorw010#5 = "QUITAR ACCESO";
         |SI #dsorm003#8 = 2;  #dsorw010#5 = "MENSAJE        ";  |FINSI;
     |FINSI;
     |CIERRA #dsorm003;

     |GRABA 020#dsorw010.a;
     |LIBERA #dsorw010;

     |REFRESCACONTROL nGrid08;
     |FOCOTECLADO nGrid08;
|FPRC;

|PROCESO DesactivaGnral;
     |CONFI "0000SSeguro que quiere desactivar el men£ general en el Area / Nivel";
     |SI FSalida ! 0;  |ACABA;  |FINSI;


     #dsorw008#0 = nGrupo;
     #dsorw008#1 = "menugnrl";
     |LEE 101#dsorw008.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#dsorw008.a;
     |LIBERA #dsorw008;

     |ABRE #dsorw010;
     #dsorw010#0 = #dsorw008#0;
     #dsorw010#1 = #dsorw008#1;
     #dsorw010#2 = "ds";
     |LEE 101#dsorw010.=;
     |SI FSalida = 0;
         |BORRA 020#dsorw010.a;

         aDAlfa = " ";
         aHAlfa = "z" * 100;
         |BUCLE dsorm003Baja;
     |FINSI;
     |CIERRA #dsorw010;

     |REFRESCACONTROL nGrid08;
     |FOCOTECLADO nGrid08;
|FPRC;

|PROCESO CreaTempos;
     |SI nGrid08 ! -1;
         |DESTRUYECONTROL nGrid08;
         |DESTRUYECONTROL nGrid10;
         |FIN_CONTROL_WINDOWS nBtnGnral;

         |CIERRA #dsorw008;
         |CIERRA #dsorw010;

         nGrid08 = -1;
         nGrid10 = -1;
     |FINSI;

     aFichero = "dsorw008" + Usuario;  |NOME_DAT #dsorw008#aFichero#;
     aFichero = "dsorw010" + Usuario;  |NOME_DAT #dsorw010#aFichero#;

     |ABRE #dsorw008;  |CIERRA #dsorw008;  |DELINDEX #dsorw008;
     |ABRE #dsorw010;  |CIERRA #dsorw010;  |DELINDEX #dsorw010;

     nPasada       = 0;
     nHayMenuGnral = 0;
     |ABRE #dsorw008;
     |ABRE #dsorw010;
     |BUCLE dsorm002;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#dsorw008, nRango, 2502, 3235, NULL, NULL, Evento08;
     nGrid08 = FSalida;

     |LINEAL_SIMPLE #1#dsorw010, nRango, 2539, 3298, Baja10, Alta10, Evento10;
     nGrid10 = FSalida;

     |SI nHayMenuGnral = 0;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Activar menu general", 3302, 3415, ActivaGnral;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Desactivar menu general", 3302, 3415, DesactivaGnral;
     |FINSI;
     nBtnGnral = FSalida;
|FPRC;

|PROCESO Evento07;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dsprem07.=;

         nGrupo = (#dsprem07#0 * 100) + #dsprem07#1;
         |HAZ CreaTempos;
     |FINSI;
|FPRC;

|PROCESO Alta;
     |VENTANA 0501, 1445, -1, 16, "Alta Area / Nivel";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DDEFECTO #dsorw017;

     |PINPA #0#dsorw017;
     |PINDA #0#dsorw017;

     |ENDATOS #1#dsorw017;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
     |PULSATECLA;

     |REFRESCACONTROL nGrid07;
     |FOCOTECLADO nGrid07;
|FPRC;

|PROCESO Baja;
     |CONFI "0000NSe borraran tanto las restricciones de menus como las de tabla, seguro.";
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     |ABRE #dsprem04;
     |SELECT #5#dsprem04;
     #dsprem04#3 = #dsprem07#0;
     #dsprem04#4 = #dsprem07#1;
     #dsprem04#5 = "";
     |LEE 000#dsprem04.];
     |SI FSalida = 0;  |Y  #dsprem04#3 = #dsprem07#0;  |Y #dsprem04#4 = #dsprem07#1;
         |MENAV "0000 Existen Usuarios en este Area-Nivel no puedo dar de BAJA la Ficha.";
         |CIERRA #dsprem04;
         |ACABA;
     |FINSI;
     |CIERRA #dsprem04;

     |LEE 101#dsprem07.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDAlfa    = "";
     aHAlfa    = "z" * 100;

     |BUCLE dsprem03Baja;
     |BUCLE dsorm003Baja;
     |BUCLE dsorm004Baja;

     |BORRA 020#dsprem07.a;
     |LIBERA #dsprem07;

     |REFRESCACONTROL nGrid07;
     |FOCOTECLADO nGrid07;
|FPRC;

|PROCESO RestManual;
     |SI #dsorw010#3 = "S";
         |MENAV "      El Menu esta Quitado Completamente. Reponga el Menu";
         |ACABA;
     |FINSI;

     |LEE 101#dsorw010.=;
     #dsorw010#3 = "N";
     |GRABA 020#dsorw010.a;
     |LIBERA #dsorw010;

     |VENTANA 0501, 3699, -1, 0,  "";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     aAlfa = #dsprem07#2;  |QBF aAlfa;
     aAlfa = aAlfa + " " + #dsprem07#3;  |QBF aAlfa;

     eaCab   = "GRUPO (" + (("0000" + nGrupo) % -104) + "-" + aAlfa;  |QBF eaCab;
     eaCab   = eaCab + ")  (MENU " + #dsorw010#2;  |QBF eaCab;
     eaCab   = eaCab + ")";
     enPRM   = 0;
     enPoner = 0;

     |HAZ Tipo3;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO RestCompleta;
     |LEE 101#dsorw010.=;
     #dsorw010#3 = "S";
     |GRABA 020#dsorw010.a;
     |LIBERA #dsorw010;

     |VENTANA 0501, 0540, -1, 0,  "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     enPoner = 0;
     enPRM   = 0;
     |HAZ Tipo3;

     |SI enError = 1;
         |LEE 101#dsorw010.=;
         #dsorw010#3 = "N";
         |GRABA 020#dsorw010.a;
         |LIBERA #dsorw010;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid10;
     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO RepoCompleta;
     |VENTANA 0501, 0540, -1, 0,  "Prpcesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |LEE 101#dsorw010.=;
     #dsorw010#3 = "X";
     enPoner     = 0;
     |HAZ Tipo3;

     #dsorw010#3 = "N";
     |GRABA 020#dsorw010.a;
     |LIBERA #dsorw010;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid10;
     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO TabsPrm;
     |VENTANA 0501, 0540, -1, 0,  "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |LEE 101#dsorw010.=;
     |SI FSalida = 0;
         |SI #dsorw010#4 = "N";
             #dsorw010#4 = "S";
         |SINO;
             #dsorw010#4 = "N";
         |FINSI;
         |GRABA 020#dsorw010.a;
         |LIBERA #dsorw010;

         |PINTA #dsorw010#4;

         enPRM       = 1;
         enPoner     = 0;
         |HAZ Tipo3;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid10;
     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO QuitarAcceso;
     |VENTANA 0501, 0540, -1, 0,  "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |LEE 101#dsorw010.=;
     |SI FSalida = 0; |Y #dsorw010#5 = "MENSAJE        ";
         #dsorw010#5 = "QUITAR ACCESO";
         |GRABA 020#dsorw010.a;

         |PINTA #dsorw010#5;

         enPRM   = 1;
         enPoner = 0;
         |HAZ Tipo3;
     |FINSI;
     |LIBERA #dsorw010;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid10;
     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO MensajeAcceso;
     |VENTANA 0501, 0540, -1, 0,  "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |LEE 101#dsorw010.=;
     |SI FSalida = 0; |Y #dsorw010#5 = "QUITAR ACCESO  ";
         #dsorw010#5 = "MENSAJE";
         |GRABA 020#dsorw010.a;

         |PINTA #dsorw010#5;

         enPRM   = 1;
         enPoner = 0;
         |HAZ Tipo3;
     |FINSI;
     |LIBERA #dsorw010;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid10;
     |FOCOTECLADO nGrid10;
|FPRC;

|PROCESO SacaMenus;
     |SI nGrid08 ! -1;
         |DESTRUYECONTROL nGrid08;
         |DESTRUYECONTROL nGrid10;
         |FIN_CONTROL_WINDOWS nBtnGnral;

         |CIERRA #dsorw008;
         |CIERRA #dsorw010;

         nGrid08 = -1;
         nGrid10 = -1;
     |FINSI;

     aFichero = "dsorw008" + Usuario;  |NOME_DAT #dsorw008#aFichero#;
     aFichero = "dsorw010" + Usuario;  |NOME_DAT #dsorw010#aFichero#;

     |ABRE #dsorw008;  |CIERRA #dsorw008;  |DELINDEX #dsorw008;
     |ABRE #dsorw010;  |CIERRA #dsorw010;  |DELINDEX #dsorw010;

     nPasada       = 1;
     nGrupo        = 0;
     |ABRE #dsorw008;
     |ABRE #dsorw010;
     |BUCLE dsorm002;

     #dsorw008#0 = nGrupo;
     #dsorw008#1 = "menugnrl";
     |LEE 101#dsorw008.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsorw008;
         #dsorw008#0 = nGrupo;
         #dsorw008#1 = "menugnrl";
         #dsorw008#2 = "Menu General";
         |GRABA 020#dsorw008.n;

         |ABRE #dsorw010;
         #dsorw010#0 = #dsorw008#0;
         #dsorw010#1 = #dsorw008#1;
         #dsorw010#2 = "ds";
         |LEE 101#dsorw010.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsorw010;
             #dsorw010#0 = #dsorw008#0;
             #dsorw010#1 = #dsorw008#1;
             #dsorw010#2 = "ds";
             |GRABA 020#dsorw010.b;
         |FINSI;

         #dsorw010#5 = "";

         |GRABA 020#dsorw010.a;
         |LIBERA #dsorw010;
     |FINSI;

     |C_V #dsorw010#3, 1, "N";
     |C_V #dsorw010#4, 1, "N";
     |C_V #dsorw010#5, 1, "N";

     enError = 0;
     |CONSULTA_CLAVE #1#dsorw010;
     |SI FSalida ! 0;
         enError = 1;
     |FINSI;

     |C_V #dsorw010#3, 1, "S";
     |C_V #dsorw010#4, 1, "S";
     |C_V #dsorw010#5, 1, "S";
|FPRC;

|PROCESO QuitarOpciones;
     |MENAV "0000A continuaci¢n seleccione el men£";

     |HAZ SacaMenus;

     |VENTANA 0501, 3699, -1, 0,  "";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |SI enError = 0;
         eaCab   = "Quitar opciones  (MENU " + #dsorw010#2;  |QBF eaCab;
         eaCab   = eaCab + ")";
         enPRM   = 0;
         enPoner = 0;

         |HAZ Tipo3;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid07;
     |FOCOTECLADO nGrid07;
|FPRC;

|PROCESO PonerOpciones;
     |MENAV "0000A continuaci¢n seleccione el men£";

     |HAZ SacaMenus;

     |VENTANA 0501, 3699, -1, 0,  "";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |SI enError = 0;
         eaCab = "A¤adir opciones  (MENU " + #dsorw010#2;  |QBF eaCab;
         eaCab   = eaCab + ")";
         enPoner = 1;
         enPRM   = 0;

         |HAZ Tipo3;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid07;
     |FOCOTECLADO nGrid07;
|FPRC;

|PROGRAMA;
     |VENTANA 0501, 3699, -1, 0,  "Restricciones MENUS";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |ABRE #dsprem07;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}RESTRICCIONES MENUS", 0502, 0540, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Areas / Niveles", 0602, 0640, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Aplicaciones", 2402, 2415, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Menus", 2439, 2445, NULL;
     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 2388, 2398, Alta;
     |CONTROL_SIMPLE 0, "BOTON,{{199}}Baja", 2378, 2386, Baja;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Restricci¢n manual", 3388, 3498, RestManual;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Restricci¢n completa", 3376, 3486, RestCompleta;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Reposici¢n  completa", 3364, 3474, RepoCompleta;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}TABS en el PRM", 3352, 3462, TabsPrm;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Quitar acceso", 3342, 3450, QuitarAcceso;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Mensaje en acceso", 3330, 3440, MensajeAcceso;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Quitar opciones en todos los perfiles", 3602, 3630, QuitarOpciones;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}A¤adir opciones en todos los perfiles", 3632, 3660, PonerOpciones;

     |PULSATECLA;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#dsprem07, nRango, 0702, 2298, NULL, NULL, Evento07;
     nGrid07 = FSalida;

     |PULSATECLA;

     aEsc1      = &255 + "806";
     aEsc2      = &255 + "807";
     aRetu      = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid07;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |DESTRUYECONTROL nGrid07;

     |PULSATECLA;

     |CIERRA #dsprem07;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |CIERRA #dsorw008;  |DELINDEX #dsorw008;
     |CIERRA #dsorw010;  |DELINDEX #dsorw010;
|FPRO;
