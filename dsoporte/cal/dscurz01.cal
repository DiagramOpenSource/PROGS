|FICHEROS;
     dscurz01 #0;

     dscurm00 #10;
     dscurm01 #1;
     dscurm02 #2;
     dscurm03 #3;
     dscurm04 #4;
     dscurm05 #5;
     dscurm06 #6;
     dscurm07 #7;
     dscurm08 #8;
     dscurm09 #9;
     dscurm10 #100;
     dscurm12 #12;
     dscurm14 #14;
     dscurm15 #15;
     dscurm16 #16;

     dsprem01 #101;
     dsprem02 #102;
     dsprem08 #108;
     dsprem04 #104;

     dsorm003 #203;

     :/gecochek/def/gecom001 #501;
|FIN;

|VARIABLES;
     aExtension    = "";
     aCodComi      = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aAlfa4        = "";
     aAlfa5        = "";
     aAlfa6        = "";
     aAlfa7        = "";
     aServiCurso   = "";
     aLocalCurso   = "";
     aServiAlumno  = "";
     aLocalAlumno  = "";
     aServiXml     = "";
     aLocalXml     = "";
     aServiDsp     = "";
     aLocalDsp     = "";
     aAbre         = "";
     aAbreFtp      = "";
     aAlfa         = "";
     aAlfa1        = "";
     aCadena       = "";
     aLen          = "";
     aCaracter     = "";
     aAlumno       = "";
     aAplicacion   = "";
     aBloque       = "";
     aLeccion      = "";
     aDir          = "";
     aDirDentro    = "";
     aFijo1        = "";
     aFijo2        = "";
     aFijo3        = "";
     aDia          = "";
     aBase         = "";
     aPathGecochek = "";
     aAnyo         = "";
     aDFecha       = "";
     aHFecha       = "";
     aSystem       = "";
     aOrigen       = "";
     aDestino      = "";
     aIPRemoto     = "";

     nHandle       = 0;
     nHandleFtp    = 0;
     nLen          = 0;
     nCampo        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nCampo6       = 0;
     nCampo7       = 0;
     nCampo8       = 0;
     nPos          = 0;
     nCarpeta1     = 0;
     nCarpeta2     = 0;
     nCarpeta3     = 0;
     nCarpeta4     = 0;
     nSwXml        = 0;
     nFichero      = 0;
     nCarac        = 0;
     nHay          = 0;
     nNume         = 0;
     nBorra        = 0;
     nAnyo         = 0;

     fFecha        = @;
|FIN;

|PROCESO PonFuentes;
     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=";
     aAlfa = aAlfa + "'ISO-8859-1'?>";
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO QuitaRaros;
     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCarac = 1;  |SI nCarac [ nLen;  |HACIENDO nCarac = nCarac + 1;
           nPos = (100 * nCarac) + 1;
           aCaracter = aAlfa % nPos;

           |SI aCaracter = "¥";  aCaracter = &"0209"; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &0241;   |FINSI;
           |SI aCaracter = "á";  aCaracter = &0225;   |FINSI;

           |SI aCaracter = " ";  aCaracter = &0225;   |FINSI;
           |SI aCaracter = "‚";  aCaracter = &0233;   |FINSI;
           |SI aCaracter = "¡";  aCaracter = &0237;   |FINSI;
           |SI aCaracter = "¢";  aCaracter = &0243;   |FINSI;
           |SI aCaracter = "£";  aCaracter = &0250;   |FINSI;

           |SI aCaracter = "§";  aCaracter = &0176;   |FINSI;
           |SI aCaracter = "¦";  aCaracter = &0170;   |FINSI;
           |SI aCaracter = "¨";  aCaracter = &0191;   |FINSI;
           |SI aCaracter = "€";  aCaracter = &0199;   |FINSI;
           |SI aCaracter = "‡";  aCaracter = &0231;   |FINSI;
           aExtension = aAbre % -103;
           |SI aExtension = "xml";
                |SI aCaracter = "&";  aCaracter = "&amp;";   |FINSI;
           |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;
|FPRC;

|PROCESO QuitaComillas;
     aAlfa5  = "";
     aLen    = aAlfa4 % 0;
     nLen    = aLen;
     |PARA nCarac = 1;  |SI nCarac [ nLen;  |HACIENDO nCarac = nCarac + 1;
           nPos = (100 * nCarac) + 1;
           aCaracter = aAlfa4 % nPos;
           aAlfa3 = &34;
           |SI aCaracter = aAlfa3;
                aCaracter = &96;
           |FINSI;
           aAlfa5 = aAlfa5 + aCaracter;
     |SIGUE;
|FPRC;

|PROCESO GrabaPlano;
     |QBF aAlfa;

     |SI nSwXml = 1;
         aAlfa = aAlfa  + aFijo3;
     |FINSI;

     |HAZ QuitaRaros;

     aAlfa = aCadena + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO CopiaLocal;
     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|| -------------------------------------------------------------------
|| GRABACION FICHEROS PARA EL CD.
|| -------------------------------------------------------------------

|| --- Ficheros para el CD ---

|PROCESO CursoDs;
     nSwXml = 0;
     aAbre  = aServiAlumno + "/" + "Curso.ds";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aAlfa = "DENOMINACION CURSO ..: " + #1#3;
     |HAZ GrabaPlano;

     aAlfa = "REFERENCIA CURSO ....: " + #1#4;
     |HAZ GrabaPlano;

     aAlfa = "DESCRIPCION CURSO ...: " + #1#5;
     |HAZ GrabaPlano;

     aAlfa = "FECHA INICIO ........: " + #1#6;
     |HAZ GrabaPlano;

     aAlfa = "FECHA FINAL .........: " + #1#7;
     |HAZ GrabaPlano;

     aAlfa = "HORAS LECTIVAS ......: " + #1#8;
     |HAZ GrabaPlano;

     aAlfa = "LUGAR IMPARTICION ...: " + #1#9;
     |HAZ GrabaPlano;

     aAlfa = "MODALIDAD ...........: " + #1#10;
     |HAZ GrabaPlano;

     #8#0 = #1#11;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     aAlfa = "HORARIO LECTIVO .....: " + #8#65;
     |HAZ GrabaPlano;

     #8#0 = #1#88;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     aAlfa = "HORARIO TUTORIA .....: " + #8#65;
     |HAZ GrabaPlano;

     aAlfa = "ORGANIZA ............: " + #1#13;
     |HAZ GrabaPlano;

     aAlfa = "IMPARTE 1 ...........: " + #1#14;
     |HAZ GrabaPlano;

     aAlfa = "IMPARTE 2 ...........: " + #1#15;
     |HAZ GrabaPlano;

     aAlfa = "CODIGO POSTAL .......: " + #1#16;
     |HAZ GrabaPlano;

     aAlfa = "POBLACION ...........: " + #1#17;
     |HAZ GrabaPlano;

     aAlfa = "PROVINCIA ...........: " + #1#18;
     |HAZ GrabaPlano;

     aAlfa = "CIF/NIF .............: " + #1#19;
     |HAZ GrabaPlano;

     aAlfa = "TUTOR PRINCIPAL .....: " + #1#21;
     |HAZ GrabaPlano;

     aAlfa = "E_MAIL ..............: " + #1#22;
     |HAZ GrabaPlano;

     aAlfa = "TELEFONO ............: " + #1#23;
     |HAZ GrabaPlano;

     aAlfa = "TUTOR SUPLENTE ......: " + #1#25;
     |HAZ GrabaPlano;

     aAlfa = "E_MAIL ..............: " + #1#26;
     |HAZ GrabaPlano;

     aAlfa = "TELEFONO ............: " + #1#27;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 1 : " + #1#28;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 2 : " + #1#29;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 3 : " + #1#30;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 4 : " + #1#31;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 5 : " + #1#32;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 6 : " + #1#33;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 7 : " + #1#34;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 8 : " + #1#35;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 9 : " + #1#36;
     |HAZ GrabaPlano;

     aAlfa = "OBJETIVO DEL CURSO 10: " + #1#37;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 1 ...........: " + #1#38;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 2 ...........: " + #1#39;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 3 ...........: " + #1#40;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 4 ...........: " + #1#41;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 5 ...........: " + #1#42;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 6 ...........: " + #1#43;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 7 ...........: " + #1#44;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 8 ...........: " + #1#45;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 9 ...........: " + #1#46;
     |HAZ GrabaPlano;

     aAlfa = "TEMARIO 10 ..........: " + #1#47;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 1 .........: " + #1#48;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 2 .........: " + #1#49;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 3 .........: " + #1#50;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 4 .........: " + #1#51;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 5 .........: " + #1#52;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 6 .........: " + #1#53;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 7 .........: " + #1#54;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 8 .........: " + #1#55;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 9 .........: " + #1#56;
     |HAZ GrabaPlano;

     aAlfa = "PRACTICAS 10 ........: " + #1#57;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 1 ......: " + #1#58;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 2 ......: " + #1#59;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 3 ......: " + #1#60;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 4 ......: " + #1#61;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 5 ......: " + #1#62;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 6 ......: " + #1#63;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 7 ......: " + #1#64;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 8 ......: " + #1#65;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 9 ......: " + #1#66;
     |HAZ GrabaPlano;

     aAlfa = "METODOLOGIA 10 .....: " + #1#67;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 1 ........: " + #1#68;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 2 ........: " + #1#69;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 3 ........: " + #1#70;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 4 ........: " + #1#71;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 5 ........: " + #1#72;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 6 ........: " + #1#73;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 7 ........: " + #1#74;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 8 ........: " + #1#75;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 9 ........: " + #1#76;
     |HAZ GrabaPlano;

     aAlfa = "MATERIALES 10 .......: " + #1#77;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 1 ........: " + #1#78;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 2 ........: " + #1#79;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 3 ........: " + #1#80;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 4 ........: " + #1#81;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 5 ........: " + #1#82;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 6 ........: " + #1#83;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 7 ........: " + #1#84;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 8 ........: " + #1#85;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 9 ........: " + #1#86;
     |HAZ GrabaPlano;

     aAlfa = "EVALUACION 10 .......: " + #1#87;
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiAlumno + "/" + "Curso.ds";
     aDestino = aLocalAlumno + "/" + "Curso.ds";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO CursoXml;
     aAbre = aServiAlumno + "/Curso.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<curso>";
     |HAZ GrabaPlano;

     aFijo1 = "     <datos nombre=" + &34;
     aFijo2 = &34 + " value=" + &34;
     aFijo3 = &34 + " />";

     nSwXml = 1;

     aAlfa4 = #1#3; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "DENOMINACION CURSO"    + aFijo2 + aAlfa5;  |HAZ GrabaPlano;

     aAlfa4 = #1#4; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "REFERENCIA_CURSO"      + aFijo2 + aAlfa5;  |HAZ GrabaPlano;

     aAlfa4 = #1#5; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "DESCRIPCION_CURSO"      + aFijo2 + aAlfa5;  |HAZ GrabaPlano;

     aAlfa4 = #1#6; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "FECHA_INICIO"          + aFijo2 + aAlfa5;  |HAZ GrabaPlano;

     aAlfa4 = #1#7; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "FECHA_FINAL"           + aFijo2 + aAlfa5;  |HAZ GrabaPlano;

     aAlfa4 = #1#8; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "HORAS_LECTIVAS"        + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#9; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "LUGAR_IMPARTICION"     + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#10; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MODALIDAD"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     #8#0 = #1#11;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     aAlfa4 = #8#65; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "HORARIO_LECTIVO"       + aFijo2 + aAlfa5;  |QBF aAlfa;
     aAlfa = aAlfa + &34 + " codigo=" + &34 + (("000" + #1#11) % -103);
     |HAZ GrabaPlano;

     #8#0 = #1#88;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     aAlfa4 = #8#65; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "HORARIO_TUTORIA"       + aFijo2 + aAlfa5;  |QBF aAlfa;
     aAlfa = aAlfa + &34 + " codigo=" + &34 + (("000" + #1#88) % -103);
     |HAZ GrabaPlano;

     aAlfa4 = #1#13; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "ORGANIZA"              + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#14; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "IMPARTE"               + aFijo2 + aAlfa5;  |QBF aAlfa;

     aAlfa4 = #1#15; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aAlfa  + " " + aAlfa5;                              |HAZ GrabaPlano;

     aAlfa4 = #1#16; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "CODIGO_POSTAL"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#17; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "POBLACION"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#18; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PROVINCIA"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#19; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "CIF_NIF"               + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#21; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TUTOR_PRINCIPAL" + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = (("00000" + #1#20) % -105); |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "CODIGO_TUTOR_PRINCIPAL" + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#22; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "E_MAIL"                + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#23; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TELEFONO"              + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#25; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TUTOR_SUPLENTE"        + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = (("00000" + #1#24) % -105); |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "CODIGO_TUTOR_SUPLENTE" + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#26; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "E_MAIL_1"              + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#27; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TELEFONO_1"            + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#28; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_1"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#29; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_2"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#30; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_3"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#31; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_4"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#32; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_5"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#33; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_6"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#34; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_7"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#35; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_8"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#36; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_9"  + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#37; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "OBJETIVO_DEL_CURSO_10" + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#38; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_1"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#39; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_2"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#40; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_3"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#41; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_4"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#42; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_5"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#43; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_6"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#44; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_7"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#45; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_8"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#46; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_9"             + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#47; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "TEMARIO_10"            + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#48; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_1"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#49; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_2"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#50; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_3"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#51; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_4"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#52; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_5"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#53; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_6"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#54; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_7"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#55; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_8"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#56; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_9"           + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#57; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "PRACTICAS_10"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#58; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_1"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#59; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_2"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#60; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_3"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#61; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_4"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#62; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_5"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#63; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_6"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#64; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_7"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#65; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_8"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#66; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_9"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#67; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "METODOLOGIA_10"        + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#68; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_1"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#69; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_2"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#70; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_3"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#71; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_4"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#72; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_5"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#73; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_6"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#74; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_7"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#75; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_8"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#76; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_9"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#77; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "MATERIALES_10"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#78; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_1"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#79; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_2"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#80; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_3"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#81; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_4"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#82; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_5"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#83; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_6"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#84; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_7"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#85; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_8"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#86; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_9"          + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     aAlfa4 = #1#87; |QBF aCodComi;
     |HAZ QuitaComillas;
     aAlfa = aFijo1 + "EVALUACION_10"         + aFijo2 + aAlfa5; |HAZ GrabaPlano;

     nSwXml = 0;
     aAlfa  = "</curso>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiAlumno + "/" + "Curso.xml";
     aDestino = aLocalAlumno + "/" + "Curso.xml";
     |HAZ CopiaLocal;

     aAlfa = (("0"  + #1#0) % -101) + (("00" + #1#1) % -102);

     aDestino = aServiXml + "/Curso" + (#14#4 % 103) + ".xml";
     |COPIA_FICHERO aAbre, aDestino;

     aOrigen  = aDestino;
     aDestino = aLocalXml + "/Curso" + (#14#4 % 103) + ".xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO GrabaCarpeta1;
     #2#0 = #1#2;
     #2#1 = #4#1;
     |LEE 000#2=;

     aAlfa = "C1." + nCarpeta1 + ":" + #2#2;
     |HAZ GrabaPlano;
|FPRC;

|PROCESO GrabaCarpeta2;
     #3#0 = #1#2;
     #3#1 = #4#1;
     #3#2 = #4#2;
     |LEE 000#3=;

     aAlfa = "C1." + nCarpeta1 + "." + nCarpeta2 + ":" + #3#3;
     |HAZ GrabaPlano;
|FPRC;

|PROCESO GrabaCarpeta3;
     aAlfa = "C1." + nCarpeta1 + "." + nCarpeta2 + "." + nCarpeta3 + ":" + #4#4;
     |HAZ GrabaPlano;
|FPRC;

|PROCESO dscurm05;
     nCarpeta4 = nCarpeta4 + 1;
     aAlfa     = "P1." + nCarpeta1 + "." + nCarpeta2 + "." + nCarpeta3 + "." + nCarpeta4 + ":" + #5#5;
     |QBF aAlfa;
     aAlfa     = aAlfa + " {{" + #5#0 + #5#1 + #5#2 + #5#3 + #5#4 + ".AAA}}"
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm05;
     #5#1;
     ;
     #4#0, #4#1, #4#2, #4#3, "  ";
     #4#0, #4#1, #4#2, #4#3, "zz";
     ;
     NULL, dscurm05;
|FIN;

|PROCESO dscurm04;
     #203#0 = (#104#3 * 100) + #104#4;
     #203#1 = #4#5;
     #203#2 = #4#6;
     #203#6 = ("00000" + #4#7) % -105;
     |LEE 000#203=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |SI aAplicacion ! #4#1;
         nCarpeta1   = nCarpeta1 + 1;
         nCarpeta2   = 0;
         nCarpeta3   = 0;
         |HAZ GrabaCarpeta1;
         aAplicacion = #4#1;
     |FINSI;

     |SI aBloque ! #4#2;
         nCarpeta2   = nCarpeta2 + 1;
         nCarpeta3   = 0;
         |HAZ GrabaCarpeta2;
         aBloque     = #4#2;
     |FINSI;

     |SI aLeccion ! #4#3;
         nCarpeta3   = nCarpeta3 + 1;
         |HAZ GrabaCarpeta3;
         aLeccion    = #4#3;
     |FINSI;

     nCarpeta4 = 0;
     |BUCLE dscurm05;
|FPRC;

|DEFBUCLE dscurm04;
     #4#1;
     7;
     #1#2, "  ", "  ", "  ",     1;
     #1#2, "zz", "zz", "zz", 99999;
     ;
     NULL, dscurm04;
|FIN;

|PROCESO Alumno;
     aAlumno = #14#4 + #14#2;   |QBT aAlumno;

     aAbre   = aServiAlumno + "/" + "Alumno" + aAlumno + ".ds";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aAlfa = "NUMERO DE ALUMNO: " +  aAlumno;
     |HAZ GrabaPlano;

     aAlfa = "INI DEL ALUMNO: " +  #14#4;
     |HAZ GrabaPlano;

     aAlfa = "DENOMINACION CURSO: " + #1#3;
     |HAZ GrabaPlano;

     aAlfa = "NOMBRE ALUMNO: " + #14#7;
     |HAZ GrabaPlano;

     aAlfa = "CONEXION: " + #14#11;
     |HAZ GrabaPlano;

     aAplicacion = "";
     aBloque     = "";
     aLeccion    = "";
     nCarpeta1   = 0;
     nCarpeta2   = 0;
     nCarpeta3   = 0;
     nCarpeta4   = 0;

     aAlfa = "MENU: ";
     |HAZ GrabaPlano;

     aAlfa = "C1:" + #1#3;
     |HAZ GrabaPlano;

     |ABRE #203;
     |ABRE #2;
     |ABRE #3;
     |BUCLE dscurm04;
     |CIERRA #203;
     |CIERRA #2;
     |CIERRA #3;

     |XCIERRA nHandle;

     aOrigen  = aServiAlumno + "/" + "Alumno" + aAlumno + ".ds";
     aDestino = aLocalAlumno + "/" + "Alumno" + aAlumno + ".ds";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO dscurm07;
     nCarpeta2 = nCarpeta2 + 1;
     aAlfa     = "P" + nCarpeta1 + "." + nCarpeta2 + ":" + #7#4;
     |QBF aAlfa;
     aAlfa     = aAlfa + " [[" + #7#0 + #7#1 + #7#5 + #7#6 + #7#7 + "]]";
     aAlfa     = aAlfa + " {{" + #7#0 + #7#1 + #7#2 + #7#3 +  "}}";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm07;
     #7#1;
     ;
     #6#0, #6#1, #6#2, "  ";
     #6#0, #6#1, #6#2, "zz";
     ;
     NULL, dscurm07;
|FIN;

|PROCESO dscurm06;
     nCarpeta1 = nCarpeta1 + 1;
     aAlfa     = "C" + nCarpeta1 + ":" + #6#3;
     |HAZ GrabaPlano;

     nCarpeta2 = 0;
     |BUCLE dscurm07;
|FPRC;

|DEFBUCLE dscurm06;
     #6#1;
     ;
     #1#2, "  ", "  ";
     #1#2, "zz", "zz";
     ;
     NULL, dscurm06;
|FIN;

|PROCESO PracticasDs;
     aAbre   = aServiAlumno + "/" + "Practica.ds";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     nCarpeta1 = 0;
     nCarpeta2 = 0;

     |BUCLE dscurm06;

     |XCIERRA nHandle;

     aOrigen  = aServiAlumno + "/" + "Practica.ds";
     aDestino = aLocalAlumno + "/" + "Practica.ds";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO Identificacion;
     aAbre   = aServiAlumno + "/" + "Identificacion" + #14#4 + #14#2;  |QBF aAbre;
     aAbre   = aAbre + ".txt";

     |XABRE "W", aAbre, nHandle;

     aAlfa = "&Alumno=" + #14#4 + #14#2;  |QBF aAlfa;
     aAlfa = aAlfa + "&";
     |HAZ GrabaPlano;

     aAlfa = "&Pass=" + #14#9;  |QBF aAlfa;
     aAlfa = aAlfa + "&";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiAlumno + "/" + "Identificacion" + #14#4 + #14#2;  |QBF aOrigen;
     aOrigen  = aOrigen + ".txt";
     aDestino = aLocalAlumno + "/" + "Identificacion" + #14#4 + #14#2;  |QBF aDestino;
     aDestino = aDestino + ".txt";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO dscurm14;
     #1#0 = #14#0;
     #1#1 = #14#1;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     aServiAlumno = aServiCurso + "/" + #14#4;
     |MKDIR aServiAlumno;

     aLocalAlumno = aLocalCurso + "/" + #14#4;
     |RMKDIR aLocalAlumno;

     nBorra = 1;

     |HAZ CursoDs;
     |HAZ CursoXml;

     nSwXml = 0;

     |HAZ Alumno;
     |HAZ PracticasDs;
     |HAZ Identificacion;
|FPRC;

|DEFBUCLE dscurm14;
     #14#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dscurm14;
|FIN;

|| --- Ficheros para Internet ---

|PROCESO dscurm05Xml;
     nSwXml = 0;
     aAlfa  = "<apartado nombre=" + &34 + #5#5;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + " codigo=" + &34 + #5#0 + #5#1 + #5#2 + #5#3 + #5#4 + ".AAA" + &34;
     aAlfa  = aAlfa + " Tiempo_Estimado=" + &34 + #5#6 + &34;
     aAlfa  = aAlfa + " />";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm05Xml;
     #5#1;
     ;
     #4#0, #4#1, #4#2, #4#3, "  ";
     #4#0, #4#1, #4#2, #4#3, "zz";
     ;
     NULL, dscurm05Xml;
|FIN;

|PROCESO dscurm04Xml;
     nSwXml = 0;
     aAlfa  = "<leccion nombre=" + &34 + #4#4 + &34 + ">";
     |HAZ GrabaPlano;

     |BUCLE dscurm05Xml;

     aAlfa  = "</leccion>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm04Xml;
     #4#1;
     ;
     #3#0, #3#1, #3#2, "  ";
     #3#0, #3#1, #3#2, "zz";
     ;
     NULL, dscurm04Xml;
|FIN;

|PROCESO dscurm03Xml;
     nSwXml = 0;
     aAlfa  = "<bloque nombre=" + &34 + #3#3 + &34 + ">";
     |HAZ GrabaPlano;

     |BUCLE dscurm04Xml;

     aAlfa  = "</bloque>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm03Xml;
     #3#1;
     ;
     #2#0, #2#1, "  ";
     #2#0, #2#1, "zz";
     ;
     NULL, dscurm03Xml;
|FIN;

|PROCESO dscurm07Xml;
     nSwXml = 0;
     aAlfa  = "<ejercicio nombre=" + &34 + #7#4;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + " codigo=" + &34 + #7#0 + #7#1 + #7#2 + #7#3 + &34;
     aAlfa  = aAlfa + " Tiempo_Estimado=" + &34 + #7#8 + &34;
     aAlfa  = aAlfa + " />";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm07Xml;
     #7#1;
     ;
     #6#0, #6#1, #6#2, "  ";
     #6#0, #6#1, #6#2, "zz";
     ;
     NULL, dscurm07Xml;
|FIN;

|PROCESO dscurm06Xml;
     nSwXml = 0;
     aAlfa  = "<practica nombre=" + &34 + #6#3 + &34 + ">";
     |HAZ GrabaPlano;

     |BUCLE dscurm07Xml;

     aAlfa  = "</practica>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm06Xml;
     #6#1;
     ;
     #2#0, #2#1, "  ";
     #2#0, #2#1, "zz";
     ;
     NULL, dscurm06Xml;
|FIN;

|PROCESO dscurm02Xml;
     nSwXml = 0;
     aAlfa  = "<aplicacion nombre=" + &34 + #2#2 + &34 + ">";
     |HAZ GrabaPlano;

     |SI nFichero = 1;  |BUCLE dscurm03Xml;  |FINSI;
     |SI nFichero = 2;  |BUCLE dscurm06Xml;  |FINSI;

     aAlfa  = "</aplicacion>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm02Xml;
     #2#1;
     ;
     #10#1, "  ";
     #10#1, "zz";
     ;
     NULL, dscurm02Xml;
|FIN;

|PROCESO dscurm00;
     nSwXml = 0;
     aAlfa  = "<curso nombre=" + &34 + #10#2 + &34 + ">";
     |HAZ GrabaPlano;

     |BUCLE dscurm02Xml;

     aAlfa  = "</curso>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm00;
     #10#1;
     ;
     01;
     99;
     ;
     NULL, dscurm00;
|FIN;

|PROCESO LeccionesXml;
     aAbre = aServiXml + "/Lecciones.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<lecciones>";
     |HAZ GrabaPlano;

     nFichero = 1;  |BUCLE dscurm00;

     nSwXml = 0;
     aAlfa  = "</lecciones>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiXml + "/" + "Lecciones.xml";
     aDestino = aLocalXml + "/" + "Lecciones.xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO PracticasXml;
     aAbre = aServiXml + "/Practicas.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<practicas>";
     |HAZ GrabaPlano;

     nFichero = 2;  |BUCLE dscurm00;

     nSwXml = 0;
     aAlfa  = "</practicas>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiXml + "/" + "Practicas.xml";
     aDestino = aLocalXml + "/" + "Practicas.xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO dscurm14Xml;
     #12#0 = #14#5;
     #12#1 = #14#6;
     |LEE 000#12=;
     |SI FSalida ! 0;  |DDEFECTO #12;  |FINSI;

     nSwXml = 0;
     aAlfa  = "<alumno nombre=" + &34 + #14#7;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ">";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "codigo" + &34 + " valor=" + &34 + (("00" + #14#3) % -102);  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "usuario" + &34 + " valor=" + &34 + #14#2;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "clave" + &34 + " valor=" + &34 + #14#9;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nif_alumno" + &34 + " valor=" + &34 + #14#6;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "seguridad_social" + &34 + " valor=" + &34 + #12#3;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "domicilio" + &34 + " valor=" + &34 + #12#4;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "codigo_postal" + &34 + " valor=" + &34 + #12#5;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "poblacion" + &34 + " valor=" + &34 + #12#6;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "provincia" + &34 + " valor=" + &34 + #12#7;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "telefono" + &34 + " valor=" + &34 + #12#8;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "e_mail" + &34 + " valor=" + &34 + #12#9;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "sexo" + &34 + " valor=" + &34 + #12#10;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "fecha_nacimiento" + &34 + " valor=" + &34 + #12#11;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "categoria_directivo" + &34 + " valor=" + &34 + #12#12;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "categoria_mando_intermedio" + &34 + " valor=" + &34 + #12#13;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "categoria_tecnico" + &34 + " valor=" + &34 + #12#14;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "categoria_trabajador_cualificado" + &34 + " valor=" + &34 + #12#15;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "categoria_trabajador_no_cualificado" + &34 + " valor=" + &34 + #12#16;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "area_direccion" + &34 + " valor=" + &34 + #12#17;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "area_administracion" + &34 + " valor=" + &34 + #12#18;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "area_comercial" + &34 + " valor=" + &34 + #12#19;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "area_mantenimiento" + &34 + " valor=" + &34 + #12#20;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "area_produccion" + &34 + " valor=" + &34 + #12#21;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "colectivo_general" + &34 + " valor=" + &34 + #12#22;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "colectivo_autonomo" + &34 + " valor=" + &34 + #12#23;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "colectivo_otros" + &34 + " valor=" + &34 + #12#24;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "colectivo_desc_otros" + &34 + " valor=" + &34 + #12#25;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "cif_empresa" + &34 + " valor=" + &34 + #14#5;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nombre_empresa" + &34 + " valor=" + &34 + #14#8;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "</alumno>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm14Xml;
     #14#1;
     ;
     #1#0, #1#1, "          ";
     #1#0, #1#1, "zzzzzzzzzz";
     ;
     NULL, dscurm14Xml;
|FIN;

|PROCESO dscurm01Xml;
     nSwXml = 0;
     aAlfa  = "<curso nombre=" + &34 + #1#5;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + " codigo =" + &34 + (("00" + #1#1) % -102);  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ">";
     |HAZ GrabaPlano;

     |ABRE #12;
     |BUCLE dscurm14Xml;
     |CIERRA #12;

     aAlfa  = "</curso>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm01Xml;
     #1#1;
     ;
     #10#0, 01;
     #10#0, 99;
     ;
     NULL, dscurm01Xml;
|FIN;

|PROCESO dscurm00Xml;
     nSwXml = 0;
     aAlfa  = "<curso_base nombre=" + &34 + #10#2;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + " codigo =" + &34 + #10#0;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ">";
     |HAZ GrabaPlano;

     |BUCLE dscurm01Xml;

     aAlfa  = "</curso_base>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm00Xml;
     #10#1;
     ;
     0;
     9;
     ;
     NULL, dscurm00Xml;
|FIN;

|PROCESO AlumnoXml;
     aAbre = aServiXml + "/Alumnos.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<alumnos>";
     |HAZ GrabaPlano;

     |BUCLE dscurm00Xml;

     nSwXml = 0;
     aAlfa  = "</alumnos>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiXml + "/" + "Alumnos.xml";
     aDestino = aLocalXml + "/" + "Alumnos.xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO dscurm10Xml;
     nSwXml = 0;
     aAlfa  = "<empresa cif=" + &34 + #100#0;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ">";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nombre" + &34 + " valor=" + &34 + #100#1;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "cuenta_cotizacion" + &34 + " valor=" + &34 + #100#2;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "convenio" + &34 + " valor=" + &34 + #100#3;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "pyme" + &34 + " valor=" + &34 + #100#4;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "rtl" + &34 + " valor=" + &34 + #100#5;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nueva_creacion" + &34 + " valor=" + &34 + #100#6;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "fecha_creacion" + &34 + " valor=" + &34 + #100#7;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "plantilla_media" + &34 + " valor=" + &34 + #100#8;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "domicilio" + &34 + " valor=" + &34 + #100#9;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "codigo_postal" + &34 + " valor=" + &34 + #100#10;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "poblacion" + &34 + " valor=" + &34 + #100#11;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "provincia" + &34 + " valor=" + &34 + #100#12;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "telefono" + &34 + " valor=" + &34 + #100#13;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "fax" + &34 + " valor=" + &34 + #100#14;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "e_mail" + &34 + " valor=" + &34 + #100#15;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "cnae" + &34 + " valor=" + &34 + #100#16;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "desc_cnae" + &34 + " valor=" + &34 + #100#17;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nif_representante" + &34 + " valor=" + &34 + #100#18;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nombre_representante" + &34 + " valor=" + &34 + #100#19;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "apellido1_representante" + &34 + " valor=" + &34 + #100#20;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "apellido2_representante" + &34 + " valor=" + &34 + #100#21;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "solicitud_fecha" + &34 + " valor=" + &34 + #100#22;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "dispone_de" + &34 + " valor=" + &34 + #100#23;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "utilizados" + &34 + " valor=" + &34 + #100#34;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota1" + &34 + " valor=" + &34 + #100#24;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota2" + &34 + " valor=" + &34 + #100#25;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota3" + &34 + " valor=" + &34 + #100#26;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota4" + &34 + " valor=" + &34 + #100#27;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota5" + &34 + " valor=" + &34 + #100#28;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota6" + &34 + " valor=" + &34 + #100#29;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota7" + &34 + " valor=" + &34 + #100#30;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota8" + &34 + " valor=" + &34 + #100#31;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota9" + &34 + " valor=" + &34 + #100#32;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<dato campo=" + &34 + "nota10" + &34 + " valor=" + &34 + #100#33;  |QBF aAlfa;
     aAlfa  = aAlfa + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "</empresa>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm10Xml;
     #100#1;
     ;
     "            ";
     "zzzzzzzzzzzz";
     ;
     NULL, dscurm10Xml;
|FIN;

|PROCESO EmpresasXml;
     aAbre = aServiXml + "/Empresas.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<empresas>";
     |HAZ GrabaPlano;

     |BUCLE dscurm10Xml;

     nSwXml = 0;
     aAlfa  = "</empresas>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiXml + "/" + "Empresas.xml";
     aDestino = aLocalXml + "/" + "Empresas.xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO GrabaDias;
     |SI nCampo = 2;   aDia = "LUNES";      |FINSI;
     |SI nCampo = 11;  aDia = "MARTES";     |FINSI;
     |SI nCampo = 20;  aDia = "MIERCOLES";  |FINSI;
     |SI nCampo = 29;  aDia = "JUEVES";     |FINSI;
     |SI nCampo = 38;  aDia = "VIERNES";    |FINSI;
     |SI nCampo = 47;  aDia = "SABADO";     |FINSI;
     |SI nCampo = 56;  aDia = "DOMINGO";    |FINSI;

     nCampo1 = nCampo + 1;
     nCampo2 = nCampo + 2;
     nCampo3 = nCampo + 3;
     nCampo4 = nCampo + 4;
     nCampo5 = nCampo + 5;
     nCampo6 = nCampo + 6;
     nCampo7 = nCampo + 7;
     nCampo8 = nCampo + 8;

     nSwXml = 0;
     aAlfa  = "<dia nombre=" + &34 + aDia + &34 + ">";
     |HAZ GrabaPlano;

     aAlfa  = "<Hora Dma¤ana=" + &34 + #8nCampo1 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Minuto Dma¤ana=" + &34 + #8nCampo2 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Hora Hma¤ana=" + &34 + #8nCampo3 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Minuto Hma¤ana=" + &34 + #8nCampo4 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Hora Dtarde=" + &34 + #8nCampo5 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Minuto Dtarde=" + &34 + #8nCampo6 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Hora Htarde=" + &34 + #8nCampo7 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "<Minuto Htarde=" + &34 + #8nCampo8 + &34 + "/>";
     |HAZ GrabaPlano;

     aAlfa  = "</dia>";
     |HAZ GrabaPlano;
|FPRC;

|PROCESO dscurm09Xml;
     aAlfa  = "<No Lectivo=" + &34 + #9#1 + &34 + "/>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm09Xml;
     #9#1;
     ;
     #8#0, "01.01.0000";
     #8#0, "31.12.9999";
     ;
     NULL, dscurm09Xml;
|FIN;

|PROCESO dscurm08Xml;
     nSwXml = 0;
     aAlfa  = "<horario nombre=" + &34 + #8#1;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + " codigo =" + &34 + (("000" + #8#0) % -103);
     aAlfa  = aAlfa + &34 + ">";
     |HAZ GrabaPlano;

     |SI #8#2  = "S";  nCampo = 2;   |HAZ GrabaDias;  |FINSI;
     |SI #8#11 = "S";  nCampo = 11;  |HAZ GrabaDias;  |FINSI;
     |SI #8#20 = "S";  nCampo = 20;  |HAZ GrabaDias;  |FINSI;
     |SI #8#29 = "S";  nCampo = 29;  |HAZ GrabaDias;  |FINSI;
     |SI #8#38 = "S";  nCampo = 38;  |HAZ GrabaDias;  |FINSI;
     |SI #8#47 = "S";  nCampo = 47;  |HAZ GrabaDias;  |FINSI;
     |SI #8#56 = "S";  nCampo = 56;  |HAZ GrabaDias;  |FINSI;

     nSwXml = 0;
     aAlfa  = "<nolectivos>";
     |HAZ GrabaPlano;

     |BUCLE dscurm09Xml;

     aAlfa  = "</nolectivos>";
     |HAZ GrabaPlano;

     aAlfa  = "</horario>";
     |HAZ GrabaPlano;
|FPRC;

|DEFBUCLE dscurm08Xml;
     #8#1;
     ;
     001;
     999;
     ;
     NULL, dscurm08Xml;
|FIN;

|PROCESO CalendarioXml;
     aAbre = aServiXml + "/Calendario.xml";
     |XABRE "W", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |HAZ PonFuentes;

     nSwXml = 0;
     aAlfa  = "<calendario>";
     |HAZ GrabaPlano;

     |BUCLE dscurm08Xml;

     nSwXml = 0;
     aAlfa  = "</calendario>";
     |HAZ GrabaPlano;

     |XCIERRA nHandle;

     aOrigen  = aServiXml + "/" + "Calendario.xml";
     aDestino = aLocalXml + "/" + "Calendario.xml";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO FicherosXml;
     |HAZ LeccionesXml;
     |HAZ PracticasXml;
     |HAZ AlumnoXml;
     |HAZ EmpresasXml;
     |HAZ CalendarioXml;

     ||Comprimimos los Xml en un solo archivo
     aAlfa1 = aServiCurso + "/ZIP";   |MKDIR aAlfa1;

     aAlfa1 = aAlfa1 + "/dscursos.tar .";
     aAlfa2 = aServiXml + "/";
     |ATAR aAlfa1, aAlfa2;

     aAlfa1 = aServiCurso + "/ZIP/dscursos.tar";
     aAlfa2 = aServiXml + "/dscursos.tar";
     |COPIA_FICHERO aAlfa1, aAlfa2;

     |FBORRA aAlfa1;
     aAlfa1 = aServiCurso +"/ZIP/";
     |RMDIR aAlfa1;

     aOrigen  = aServiXml + "/" + "dscursos.tar";
     aDestino = aLocalXml + "/" + "dscursos.tar";
     |HAZ CopiaLocal;
|FPRC;

|PROCESO dscurm14dsp;
     #1#0 = #14#0;
     #1#1 = #14#1;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     #8#0 = #1#88;
     |LEE 000#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;

     #15#0 = #8#66;
     |LEE 000#15=;
     |SI FSalida ! 0;  |DDEFECTO #15;  |FINSI;

     #501#0 = #1#20;
     |LEE 000#501=;
     |SI FSalida ! 0;  |DDEFECTO #501;  |FINSI;

     nNume  = #14#4;
     nNume  = 600000 + nNume;
     aAlfa1 = ("000000" + nNume) % -106;
     aAlfa2 = aAlfa1;
     aAlfa3 = #8#66;
     aAlfa4 = #14#7 % 130;
     aAlfa5 = #15#2;
     aAlfa6 = "S";                 || telesoporte S/N
     aAlfa7 = #501#4;              || usuario guardian
     aAlfa  = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + aAlfa5 + aAlfa6 + aAlfa7 + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|DEFBUCLE dscurm14dsp;
     #14#1;
     ;
     0, 01, "          ";
     9, 99, "zzzzzzzzzz";
     ;
     NULL, dscurm14dsp;
|FIN;

|PROCESO cftlsprt;
     aAbre = aServiDsp + "/cftlsprt6.txt";
     |XABRE "BW", aAbre, nHandle;
     |SI FSalida ] 0;
         |ABRE #1;
         |ABRE #8;
         |ABRE #15;
         |ABRE #501;
         |BUCLE dscurm14dsp;
         |CIERRA #1;
         |CIERRA #8;
         |CIERRA #15;
         |CIERRA #501;
     |FINSI;
     |XCIERRA nHandle;

     aOrigen  = aServiDsp + "/" + "cftlsprt6.txt";
     aDestino = aLocalDsp + "/" + "cftlsprt6.txt";
     |HAZ CopiaLocal;

     aAlfa = "put cftlsprt6.txt" + &13 + &10;    |XGRABA nHandleFtp, aAlfa;
|FPRC;

|PROCESO dscurm16dsp;
     #15#0 = #16#0;
     |LEE 000#15=;
     |SI FSalida ! 0;    |DDEFECTO #15;   |FINSI;

     aAlfa1 = #16#0;
     aAlfa2 = #16#3;
     aAlfa3 = #15#3;
     |SI aAlfa3 = "  ";  aAlfa3 = "00";  |FINSI;
     aAlfa4 = #16#4;
     aAlfa  = aAlfa1 + aAlfa2 + aAlfa3 + aAlfa4 + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|DEFBUCLE dscurm16dsp;
     #16#1;
     ;
     "  ",     1;
     "zz", 99999;
     ;
     NULL, dscurm16dsp;
|FIN;

|PROCESO sstlsprt;
     aAbre = aServiDsp + "/sstlsprt6.txt";
     |XABRE "BW", aAbre, nHandle;
     |SI FSalida ] 0;
         |ABRE #15;
         |BUCLE dscurm16dsp;
         |CIERRA #15;
     |FINSI;
     |XCIERRA nHandle;

     aOrigen  = aServiDsp + "/" + "sstlsprt6.txt";
     aDestino = aLocalDsp + "/" + "sstlsprt6.txt";
     |HAZ CopiaLocal;

     aAlfa = "put sstlsprt6.txt" + &13 + &10;    |XGRABA nHandleFtp, aAlfa;
|FPRC;

|PROCESO dscurm09dsp;
     aAlfa = (#9#1 % 402) + (#9#1 % 102); |XGRABA nHandle, aAlfa;
|FPRC;

|DEFBUCLE dscurm09dsp;
     #9#1;
     ;
     #8#0, aDFecha;
     #8#0, aHFecha;
     ;
     NULL, dscurm09dsp;
|FIN;


|PROCESO dscurm08dsp;
     fFecha = ~;
     aAnyo  = fFecha % -102;

     aAbre = aServiDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     |XABRE "BW", aAbre, nHandle;
     |SI FSalida ] 0;
         aAlfa = "6";                      |XGRABA nHandle, aAlfa;
         aAlfa = "0";                      |XGRABA nHandle, aAlfa;
         aAlfa = "0";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#3)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#4)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#5)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#6)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#7)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#8)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#9)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#10) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "31";                     |XGRABA nHandle, aAlfa;
         aAlfa = "12";                     |XGRABA nHandle, aAlfa;
         aAlfa = "31";                     |XGRABA nHandle, aAlfa;
         aAlfa = "12";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aDFecha = "01.01.20" + aAnyo;
         aHFecha = "31.12.20" + aAnyo;
         |BUCLE dscurm09dsp;

         aAlfa = &10;                      |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     aOrigen  = aServiDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     aDestino = aLocalDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     |HAZ CopiaLocal;

     nAnyo  = aAnyo;
     nAnyo  = nAnyo + 1;
     aAnyo  = ("00" + nAnyo) % -102;

     aAbre = aServiDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     |XABRE "BW", aAbre, nHandle;
     |SI FSalida ] 0;
         aAlfa = "6";                      |XGRABA nHandle, aAlfa;
         aAlfa = "0";                      |XGRABA nHandle, aAlfa;
         aAlfa = "0";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#3)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#4)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#5)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#6)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#7)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#8)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#9)  % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#10) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "31";                     |XGRABA nHandle, aAlfa;
         aAlfa = "12";                     |XGRABA nHandle, aAlfa;
         aAlfa = "31";                     |XGRABA nHandle, aAlfa;
         aAlfa = "12";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;
         aAlfa = "00";                     |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aAlfa = "5";                      |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#39) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#40) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#41) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#42) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#43) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#44) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#45) % -102);  |XGRABA nHandle, aAlfa;
         aAlfa = (("00" + #8#46) % -102);  |XGRABA nHandle, aAlfa;

         aDFecha = "01.01.20" + aAnyo;
         aHFecha = "31.12.20" + aAnyo;
         |BUCLE dscurm09dsp;

         aAlfa = &10;                      |XGRABA nHandle, aAlfa;
     |FINSI;
     |XCIERRA nHandle;

     aOrigen  = aServiDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     aDestino = aLocalDsp + "/" + aAnyo + #8#66 + "sprt.txt";
     |HAZ CopiaLocal;

     aAlfa = "put " + aAnyo + #8#66 + "sprt.txt" + &13 + &10;    |XGRABA nHandleFtp, aAlfa;
|FPRC;

|DEFBUCLE dscurm08dsp;
     #8#1;
     ;
     001;
     999;
     ;
     NULL, dscurm08dsp;
|FIN;

|PROCESO tlsprt;
     |BUCLE dscurm08dsp;
|FPRC;

|PROCESO FicherosDsp;
     aAbreFtp = aServiDsp + "/ftp.ftp";
     |XABRE "BW", aAbreFtp, nHandleFtp;
     |SI FSalida ] 0;
         aAlfa = "open 217.13.81.39" + &13 + &10;    |XGRABA nHandleFtp, aAlfa;
         aAlfa = "user diagram joangil" + &13 + &10; |XGRABA nHandleFtp, aAlfa;
         aAlfa = "bin" + &13 + &10;                  |XGRABA nHandleFtp, aAlfa;
         aAlfa = "cd /usr/dsp/fich" + &13 + &10;     |XGRABA nHandleFtp, aAlfa;
         aAlfa = "lcd \DSCURSOS\DSP" + &13 + &10;    |XGRABA nHandleFtp, aAlfa;

         |HAZ cftlsprt;
         |HAZ sstlsprt;
         |HAZ tlsprt;

         aAlfa = "by" + &13 + &10;                   |XGRABA nHandleFtp, aAlfa;

         |XCIERRA nHandleFtp;

         aOrigen  = aServiDsp + "/" + "ftp.ftp";
         aDestino = aLocalDsp + "/" + "ftp.ftp";
         |HAZ CopiaLocal;

         aSystem = "ftp -i -n -s:" + aDestino;
         |RSYSTEM aSystem;
     |FINSI;
|FPRC;

|| -------------------------------------------------------------------
|| COMIENZA EL COTARRO
|| -------------------------------------------------------------------

|PROGRAMA;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBF aIPRemoto;

     |DBASS aBase;  |QBF aBase;
     aPathGecochek = aBase + "gecochek/fich/";
     |PATH_DAT #501 aPathGecochek;

     |DBASE aBase;  |QBF aBase;
     aServiCurso = aBase + "generar"; |MKDIR  aServiCurso;
     aLocalCurso = "/DSCURSOS";       |RMKDIR aLocalCurso;

     |PARA;  |SI;  |HACIENDO;
          aDir = aServiCurso + "/*";
          |_PDIR aDir;
          |SI FSalida ! 0;  |SAL;  |FINSI;

          nHay       = 0;
          aDirDentro = aDir + "/*.*";
          |_PDIR aDirDentro;
          |PARA;  |SI FSalida = 0;  |HACIENDO;
             nHay = 1;
             |FBORRA aDirDentro;
             |_SDIR aDirDentro;
          |SIGUE;

          |SI nHay = 1;   |RMDIR aDir;   |FINSI;

          |SI nHay = 0;
              |FBORRA aDir;
              |SI FSalida < 0;
                  |RMDIR aDir;
             |FINSI;
          |FINSI;
     |SIGUE;

     |PARA;  |SI;  |HACIENDO;
          aDir = aLocalCurso + "/*";
          |R_PDIR aDir;
          |SI FSalida ! 0;  |SAL;  |FINSI;

          nHay       = 0;
          aDirDentro = aDir + "/*.*";
          |R_PDIR aDirDentro;
          |PARA;  |SI FSalida = 0;  |HACIENDO;
             nHay = 1;
             |RFBORRA aDirDentro;
             |R_SDIR aDirDentro;
          |SIGUE;

          |SI nHay = 1;   |RRMDIR aDir;   |FINSI;

          |SI nHay = 0;
              |RFBORRA aDir;
              |SI FSalida < 0;
                  |RRMDIR aDir;
             |FINSI;
          |FINSI;
     |SIGUE;

     aServiXml  = aServiCurso + "/XML";   |MKDIR  aServiXml;
     aLocalXml  = aLocalCurso + "/XML";   |RMKDIR aLocalXml;

     nCarpeta1 = 0;
     nCarpeta2 = 0;

     |ABRE #1;
     |ABRE #8;
     |BUCLE dscurm14;
     |CIERRA #1;
     |CIERRA #8;

     |HAZ FicherosXml;

     aServiDsp  = aServiCurso + "/DSP";   |MKDIR  aServiDsp;
     aLocalDsp  = aLocalCurso + "/DSP";   |RMKDIR aLocalDsp;
     |HAZ FicherosDsp;
|FPRO;
