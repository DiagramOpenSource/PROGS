|FICHEROS;
|FIN;

|VARIABLES;
     aBase         = "";
     aAplicacion   = "";
     aAbre         = "";
     aAlfa         = "";
     aMas          = "";
     aInd          = "";
     aOrigen       = "";
     aDestino      = "";

     nHandle       = 0;
     nContador     = 0;

     &eaApli       = "";
     &eaEmpPat     = "";
     &eaEmpDes     = "";
     &enHay        = 0;
|FIN;

|PROCESO CopiaFichero;
     |QBF aMas;

     aOrigen  = aAplicacion + "/fich/" + eaEmpPat + "/" + aMas + ".dat";
     aDestino = aAplicacion + "/fich/" + eaEmpDes + "/" + aMas + ".dat";
     |COPIA_FICHERO aOrigen, aDestino;
     |SI FSalida = 0;  enHay = 1;  |FINSI;

     aOrigen  = aAplicacion + "/fich/" + eaEmpPat + "/" + aMas + ".ddx";
     aDestino = aAplicacion + "/fich/" + eaEmpDes + "/" + aMas + ".ddx";
     |COPIA_FICHERO aOrigen, aDestino;

     aOrigen  = aAplicacion + "/fich/" + eaEmpPat + "/" + aMas + ".ixx";
     aDestino = aAplicacion + "/fich/" + eaEmpDes + "/" + aMas + ".ixx";
     |COPIA_FICHERO aOrigen, aDestino;
|FPRC;

|PROGRAMA;
     |DBASS aBase;
     aAplicacion = aBase + eaApli;

     aAbre = aAplicacion + "/fich/" + eaApli + ".dir";
     |XABRE "U", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     nContador = 0;
     |PARA;  |SI;  |HACIENDO;
          |XLEE nHandle, 250, aAlfa;
          |SI FSalida < 0;  |SAL;  |FINSI;

          nContador = nContador + 1;

          |SI nContador = 1;  aMas = aAlfa;        |FINSI;

          |SI nContador = 4;
              aInd = aAlfa % 101;

              |SI aInd = "1";  |O aInd = 2;
                  |HAZ CopiaFichero;
              |FINSI;
          |FINSI;

          |SI nContador = 5;  nContador = 0;  |FINSI;
     |SIGUE;
|FPRO;
