|FICHEROS;
     dsorm002 #0;
     dslisde5 #1,MANTE;
|FIN;

|VARIABLES;
     aAlfa        = "";
     aAlfa1       = "";
     aBase        = "";
     aBaseEste    = "";
     aFichero     = "";
     aAplica      = "";
     aTitulo      = "";
     aDSoporte    = "";
     aDirAplica   = "";
     aAcceso      = "";
     aAcceso1     = "";
     aAbre        = "";

     nHandle      = 0;
     nHandle1     = 0;
|FIN;

|PROCESO LeeAccesos;
     |DBASE aBaseEste;  |QBF aBaseEste;
     aAbre = aBaseEste + "zaccesos.txt";  |QBT aAbre;
     |XABRE "U", aAbre, nHandle1;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA;  |SI;  |HACIENDO;
         |XLEE nHandle1, 250, aAcceso;
         |SI FSalida < 0;  |SAL;  |FINSI;

         aAcceso1 = aAcceso % 108;
         |SI aAcceso1 = #1#0;
             #1#2 = aAcceso % 1008;
             #1#3 = aAcceso % 1908;
             |SAL;
         |FINSI;

         |PULSATECLA;
     |SIGUE;
     |XCIERRA nHandle1;
|FPRC;

|PROCESO GrabaEl1;
     #1#0 = aAlfa;
     aTitulo   = "";
     aDSoporte = aBase + #1#0 + "/fich/" + #1#0 + ".dir";  |QBT aDSoporte;
     |XABRE "U", aDSoporte, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;
     |XCIERRA nHandle;

     #1#0 = aAlfa;
     aTitulo   = "";
     aDSoporte = aBase + #1#0 + "/" + #1#0 + ".men";  |QBT aDSoporte;
     |XABRE "U", aDSoporte, nHandle;
     |SI FSalida ] 0;
         |XLEE nHandle, 250, aAlfa1;
         |SI FSalida ] 0;
             aTitulo = aAlfa1 % 350;
         |FINSI;
     |FINSI;
     |XCIERRA nHandle;

     #1#1 = aTitulo;
     #1#2 = "";
     #1#3 = "";

     |HAZ LeeAccesos;

     |PTEC 802;  |PAUSA;
     |PULSATECLA;

     |GRABA 020#1n;
     |LIBERA #1;
|FPRC;

|PROCESO Tipo8;  |TIPO 8;
     |MENSA "     Cargando Configuracion";

     aFichero = ("d5" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #1 aFichero;
     |ABRE #1;  |CIERRA #1;  |DELINDEX #1;

     |ABRE #0;
     |ABRE #1;

     |DBASS aBase;  |QBF aBase;
     aDirAplica = aBase + "*";
     |_PDIR aDirAplica;
     |PARA;  |SI FSalida ] 0; |HACIENDO;
             aAlfa = aDirAplica - ".";
             |SI aAlfa = aDirAplica;
                 aAlfa = aDirAplica - aBase;
                 |HAZ GrabaEl1;
             |FINSI;

             |PULSATECLA;
             |_SDIR aDirAplica;
     |SIGUE;

     |CIERRA #1;
     |CIERRA #0;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |PTEC 802;  |PAUSA;
|FPRC;

|RUTINA ClaveBaja1;
    #1#0 = "        ";
|FRUT;

|RUTINA ClaveAlta1;
    #1#0 = "zzzzzzzz";
|FRUT;

|PROCESO Tipo0lisde5;  |TIPO 0;
     aAplica = #1#0;
     |PTEC 807;
|FPRC;

|PROCESO Aplicacion;
     |SI FSalida = 10;
         |PUSHV 0501 2380;
         |CLS;
         aAplica = "";
         |ENTLINEAL #1#1, -1, 4, 22, 1, ClaveBaja1, ClaveAlta1;
         |PULSATECLA;
         |POPV;
         #0#0 = aAplica;
         |PINTA #0#0;
     |FINSI;

     |ABRE #1;
     #1#0 = #0#0;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV "      Aplicacion no Instalada";
         |ERROR;
     |FINSI;
     |CIERRA #1;
|FPRC;

|PROCESO Menu;
     #0#2      = "";
     aDSoporte = aBase + #0#0 + "/" + #0#1 + ".men";  |QBT aDSoporte;
     |XABRE "U", aDSoporte, nHandle;
     |SI FSalida ] 0;
         |XLEE nHandle, 250, aAlfa1;
         |SI FSalida ] 0;
             #0#2 = aAlfa1 % 350;
         |FINSI;
     |SINO;
         |MENAV "     No existe Menu";
         |ERROR;
     |FINSI;
     |XCIERRA nHandle;

     |PINTA #0#2;
     |PINTA #0#3;
|FPRC;

|PROCESO PintaLos;  |TIPO 7;
     |HAZ Menu;

     |ABRE #1;
     #1#0 = #0#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     #0#3 = #1#2;  |PINTA #0#3;
     #0#4 = #1#3;  |PINTA #0#4;
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
     |ABRE #1;  |CIERRA #1;  |DELINDEX #1;
|FPRC;
