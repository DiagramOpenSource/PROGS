|FICHEROS;
     dscurm00 #0;
     dscurm02 #2;
     dscurm03 #3;
     dscurm04 #4;
     dscurm05 #5;
     dscurm06 #6;
     dscurm07 #7;
     dscurw02 #902;

     dscurm04@ #904;
|FIN;

|VARIABLES;
     nBoton1_1      = 0;
     nBoton1_2      = 0;
     nBoton1_3      = 0;
     nBoton1_4      = 0;
     nBoton2_1      = 0;
     nBoton2_2      = 0;
     nBoton2_3      = 0;

     nPanta0        = 0;
     nPanta1        = 0;
     nPanta2        = 0;
     nPanta3        = 0;
     nCampoD        = 0;
     nCampoH        = 0;
     nCampoHasta    = 0;
     nCampo1        = 0;
     nVentana       = 0;
     nGrid1         = 0;
     nGrid2         = 0;
     nRango         = 0;
     nPos1          = 0;
     nPos2          = 0;
     nResp          = 0;
     nCampo         = 0;
     nLen           = 0;
     nCampos        = 0;
     nPos           = 0;

     aAlfa          = "";
     aBase          = "";
     aMas           = "";
     aFichero       = "";
     aCadena        = "";
     aLen           = "";
     aCaracter      = "";
     aAbre          = "";
     aRuta          = "";
     aCampoA        = "";
     aCampoB        = "";
     aCampoC        = "";
     aCampoD        = "";
     aCampoE        = "";
     aCampoF        = "";
     aCampoG        = "";
     aCampoH        = "";
     aCampoI        = "";

     &enCurso       = 0;
     &enModo        = 1;
     &eaAplica      = "";
|FIN;

|PROCESO BajaPanta1;
     #2#0  = #902#1;
     #2#1  = "";
|FPRC;

|PROCESO AltaPanta1;
     #2#0  = #902#1;
     #2#1  = "zz";
|FPRC;

|PROCESO BajaPanta2;
     #2#0  = #902#1;
     #2#1  = "";
|FPRC;

|PROCESO AltaPanta2;
     #2#0  = #902#1;
     #2#1  = "zz";
|FPRC;

|| ------------------------------------------------------
|| Procesos Bajas de Ficheros;
|| ------------------------------------------------------

|PROCESO dscurm07B;
     |BORRA 020#7a;
     |LIBERA #7;
|FPRC;

|DEFBUCLE dscurm07B;
     #7#1;
     ;
     #6#0, #6#1, #6#2, "  ";
     #6#0, #6#1, #6#2, "zz";
     be;
     NULL, dscurm07B;
|FIN;

|PROCESO dscurm06B;
     |BUCLE dscurm07B;

     |BORRA 020#6a;
     |LIBERA #6;
|FPRC;

|DEFBUCLE dscurm06B;
     #6#1;
     ;
     #2#0, #2#1, "  ";
     #2#0, #2#1, "zz";
     be;
     NULL, dscurm06B;
|FIN;

|PROCESO dscurm05B;
     |BORRA 020#5a;
     |LIBERA #5;
|FPRC;

|DEFBUCLE dscurm05B;
     #5#1;
     ;
     #4#0, #4#1, #4#2, #4#3, "  ";
     #4#0, #4#1, #4#2, #4#3, "zz";
     be;
     NULL, dscurm05B;
|FIN;

|PROCESO dscurm04B;
     |BUCLE dscurm05B;

     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dscurm04B;
     #4#1;
     ;
     #3#0, #3#1, #3#2, "  ";
     #3#0, #3#1, #3#2, "zz";
     be;
     NULL, dscurm04B;
|FIN;

|PROCESO dscurm03B;
     |BUCLE dscurm04B;

     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE dscurm03B;
     #3#1;
     ;
     #2#0, #2#1, "  ";
     #2#0, #2#1, "zz";
     be;
     NULL, dscurm03B;
|FIN;

|| ------------------------------------------------------
|| Procesos Grabacion del Curso
|| ------------------------------------------------------

|PROCESO GrabaCurso;
     #0#0 = #902#0;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #902#0;
         |GRABA 020#0b;
     |FINSI;

     |PARA nCampoD = 1;  |SI nCampoD [ nCampoHasta;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD;
           #0nCampoD = #902nCampoH;
     |SIGUE;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_1
|| ------------------------------------------------------

|PROCESO Boton1_1;
     |HAZ GrabaCurso;

     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCurso   = #902#0;
     eaAplica  = "";
     enModo    = 1;
     |SUB_EJECUTA_NP "dscurw03";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_2
|| ------------------------------------------------------

|PROCESO Boton1_2;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCurso   = #902#0;
     eaAplica  = #2#1;
     enModo    = 2;
     |SUB_EJECUTA_NP "dscurw03";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_3
|| ------------------------------------------------------

|PROCESO Boton1_3;
     aAlfa = "0000NSeguro de dar de baja a " + #2#2;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#2=;
     |SI FSalida = 0;
         |BUCLE dscurm03B;
         |BUCLE dscurm06B;

         |BORRA 020#2a;
         |LIBERA #2;
     |FINSI;

     #2#0 = #902#1;
     #2#1 = "";
     |LEE 000#2];
     |SI FSalida = 0;  |Y  #2#0 = #902#1;
         |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |ESTADO_CONTROL nBoton1_3, "ENABLE";
         |ESTADO_CONTROL nBoton1_4, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton1_2, "DISABLE";
         |ESTADO_CONTROL nBoton1_3, "DISABLE";
         |ESTADO_CONTROL nBoton1_4, "DISABLE";
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 1_4
|| ------------------------------------------------------

|PROCESO QuitaRaros;
     |QBF aAlfa;

     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCampos = 1;  |SI nCampos [ nLen;  |HACIENDO nCampos = nCampos + 1;
           nPos = (100 * nCampos) + 1;
           aCaracter = aAlfa % nPos;

           |SI aCaracter = "Á";  aCaracter = "A";  |FINSI;
           |SI aCaracter = "É";  aCaracter = "E";  |FINSI;
           |SI aCaracter = "Í";  aCaracter = "I";  |FINSI;
           |SI aCaracter = "Ó";  aCaracter = "O";  |FINSI;
           |SI aCaracter = "Ú";  aCaracter = "U";  |FINSI;
           |SI aCaracter = "á";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "é";  aCaracter = "‚";  |FINSI;
           |SI aCaracter = "í";  aCaracter = "¡";  |FINSI;
           |SI aCaracter = "ó";  aCaracter = "¢";  |FINSI;
           |SI aCaracter = "ú";  aCaracter = "£";  |FINSI;
           |SI aCaracter = "º";  aCaracter = "§";  |FINSI;
           |SI aCaracter = "ª";  aCaracter = "¦";  |FINSI;
           |SI aCaracter = "ñ";  aCaracter = "¤";  |FINSI;
           |SI aCaracter = "Ñ";  aCaracter = "¥";  |FINSI;
           |SI aCaracter = "€";  aCaracter = "ç";  |FINSI;
           |SI aCaracter = "‡";  aCaracter = "Ç";  |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;

     aAlfa = aCadena;
|FPRC;

|PROCESO CargaDatos;
     #3#0 = #2#0;
     #3#1 = #2#1;
     #3#2 = aCampoC;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0 = #2#0;
         #3#1 = #2#1;
         #3#2 = aCampoC;
         |GRABA 020#3b;
     |FINSI;

     #3#3 = aCampoD;
     |GRABA 020#3a;
     |LIBERA #3;

     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = aCampoC;
     #4#3 = aCampoE;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0 = #2#0;
         #4#1 = #2#1;
         #4#2 = aCampoC;
         #4#3 = aCampoE;
         |GRABA 020#4b;
     |FINSI;

     #4#4 = aCampoF;

     #904#0 = #4#0;
     #904#1 = #4#1;
     #904#2 = #4#2;
     #904#3 = #4#3;
     |LEE 000#904=;
     |SI FSalida ! 0;  |DDEFECTO #904;  |FINSI;

     #4#5 = #904#5;
     #4#6 = #904#6;
     #4#7 = #904#7;
     |GRABA 020#4a;
     |LIBERA #4;

     #5#0 = #2#0;
     #5#1 = #2#1;
     #5#2 = aCampoC;
     #5#3 = aCampoE;
     #5#4 = aCampoG;
     |LEE 101#5=;
     |SI FSalida ! 0;
         |DDEFECTO #5;
         #5#0 = #2#0;
         #5#1 = #2#1;
         #5#2 = aCampoC;
         #5#3 = aCampoE;
         #5#4 = aCampoG;
         |GRABA 020#5b;
     |FINSI;

     #5#5 = aCampoH;
     #5#6 = aCampoI;
     |GRABA 020#5a;
     |LIBERA #5;
|FPRC;

|PROCESO dscurm04;
     #904#0 = #4#0;
     #904#1 = #4#1;
     #904#2 = #4#2;
     #904#3 = #4#3;
     #904#4 = #4#4;
     #904#5 = #4#5;
     #904#6 = #4#6;
     #904#7 = #4#7;
     |GRABA 020#904n;
     |LIBERA #904;
|FPRC;

|DEFBUCLE dscurm04;
     #4#1;
     ;
     #2#0, #2#1, "  ", "  ";
     #2#0, #2#1, "zz", "zz";
     be;
     NULL, dscurm04;
|FIN;

|PROCESO CogeExcel;
     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/dscurm04.mas";
     |CARGA_DEF aMas, dscurm04@;
     |SI FSalida ! 0;
         |MENAV "0000 Error cargando def dscurm04@";
         |ERROR;
         |ACABA;
     |FINSI;

     aFichero = ("04" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #904 aFichero;
     |ABRE #904;  |CIERRA #904;  |DELINDEX #904;

     |ABRE #904;
     |BUCLE dscurm04;

     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;
         |MENAV "0000No se puede usar agixl97.dll";
         |ACABA;
     |FINSI;

     |ALFACALLDLL "agixl97.dll", "carga_book", aAbre;
     |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Hoja1";

     nCampo = 1;
     |PARA; |SI; |HACIENDO;
           aCampoA = "A" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoA;
           |QBF aCampoA;
           |SI aCampoA = "";  |SAL;  |FINSI;
           aAlfa = aCampoA;  |HAZ QuitaRaros; aCampoA = aAlfa;

           aCampoB = "B" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoB;
           |QBF aCampoB;
           aAlfa = aCampoB;  |HAZ QuitaRaros; aCampoB = aAlfa;

           aCampoC = "C" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoC;
           |QBF aCampoC;
           aAlfa = aCampoC;  |HAZ QuitaRaros; aCampoC = aAlfa;

           aCampoD = "D" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoD;
           |QBF aCampoD;
           aAlfa = aCampoD;  |HAZ QuitaRaros; aCampoD = aAlfa;

           aCampoE = "E" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoE;
           |QBF aCampoE;
           aAlfa = aCampoE;  |HAZ QuitaRaros; aCampoE = aAlfa;

           aCampoF = "F" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoF;
           |QBF aCampoF;
           aAlfa = aCampoF;  |HAZ QuitaRaros; aCampoF = aAlfa;

           aCampoG = "G" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoG;
           |QBF aCampoG;
           aAlfa = aCampoG;  |HAZ QuitaRaros; aCampoG = aAlfa;

           aCampoH = "H" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoH;
           |QBF aCampoH;
           aAlfa = aCampoH;  |HAZ QuitaRaros; aCampoH = aAlfa;

           aCampoI = "I" + nCampo;
           |ALFACALLDLL "agixl97.dll", "peek_dato", aCampoI;
           |QBF aCampoI;
           aAlfa = aCampoI;  |HAZ QuitaRaros; aCampoI = aAlfa;

           |SI nCampo = 1;
               |SI aCampoA = #2#0;  |Y aCampoB = #2#1;
                   |BUCLE dscurm03B;
               |SINO;
                   |MENAV "0000 La Hoja Excel seleccionada no tiene informacion respecto al Curso - Aplicacion.";
                   |SAL;
               |FINSI;
           |FINSI;

           |ABRE #3;
           |ABRE #4;
           |ABRE #5;
           |HAZ CargaDatos;
           |CIERRA #3;
           |CIERRA #4;
           |CIERRA #5;

           nCampo = nCampo + 1;
     |SIGUE;

     |ALFACALLDLL "agixl97.dll", "fin_book", "salva";
     |DESCARGADLL "agixl97.dll";

     |CIERRA #904;
     |DELINDEX #904;
|FPRC;

|PROCESO Boton1_4;
     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";
     |ESTADO_CONTROL nBoton1_4, "DISABLE";

     aAlfa = "0000 Este proceso recoge los datos de la aplicacion " + #2#1;
     aAlfa = aAlfa + " de una hoja excel ya predise¤ada. Si hubieran puntos ";
     aAlfa = aAlfa + " del Menu introducidos NO SE PERDERAN.";
     |MENAV aAlfa;

     aAlfa = "0000NDesea recoger los datos de la hoja excel";
     |CONFI aAlfa;
     |SI FSalida ! 0;
         |ESTADO_CONTROL nBoton1_1, "ENABLE";
         |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |ESTADO_CONTROL nBoton1_3, "ENABLE";
         |ESTADO_CONTROL nBoton1_4, "ENABLE";
         |ACABA;
     |FINSI;

     aAlfa = "0000 A continuacion abra la hoja excel que contiene la informacion";
     |MENAV aAlfa;

     aRuta = "F";
     |BROWSE aRuta;

     aAbre = aRuta % 299;  |QBF aAbre;
     |SI aAbre = "";
         |ESTADO_CONTROL nBoton1_1, "ENABLE";
         |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |ESTADO_CONTROL nBoton1_3, "ENABLE";
         |ESTADO_CONTROL nBoton1_4, "ENABLE";
         |ACABA;
     |FINSI;

     |HAZ CogeExcel;

     |REFRESCACONTROL nGrid1;

     |ESTADO_CONTROL nBoton1_1, "ENABLE";
     |ESTADO_CONTROL nBoton1_2, "ENABLE";
     |ESTADO_CONTROL nBoton1_3, "ENABLE";
     |ESTADO_CONTROL nBoton1_4, "ENABLE";
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_1
|| ------------------------------------------------------

|PROCESO Boton2_1;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCurso   = #902#0;
     eaAplica  = "";
     enModo    = 1;
     |SUB_EJECUTA_NP "dscurw07";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_2
|| ------------------------------------------------------

|PROCESO Boton2_2;
     |VENTANA 0501, 2799, -1, -1, "";
     nVentana = FSalida;

     enCurso   = #902#0;
     eaAplica  = #2#1;
     enModo    = 2;
     |SUB_EJECUTA_NP "dscurw07";

     |FINVENTANA nVentana;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Boton 2_3
|| ------------------------------------------------------

|PROCESO Boton2_3;
     aAlfa = "0000NSeguro de dar de baja a " + #2#2;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#2=;
     |SI FSalida = 0;
         |BUCLE dscurm03B;
         |BUCLE dscurm06B;

         |BORRA 020#2a;
         |LIBERA #2;
     |FINSI;

     #2#0 = #902#1;
     #2#1 = "";
     |LEE 000#2];
     |SI FSalida = 0;  |Y  #2#0 = #902#1;
         |ESTADO_CONTROL nBoton2_2, "ENABLE";
         |ESTADO_CONTROL nBoton2_3, "ENABLE";
     |SINO;
         |ESTADO_CONTROL nBoton2_2, "DISABLE";
         |ESTADO_CONTROL nBoton2_3, "DISABLE";
     |FINSI;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|| ------------------------------------------------------
|| Procesos del Incio del Programa
|| ------------------------------------------------------

|PROCESO EventoPanta1;
     |SI FSalida = 1;
         |ESTADO_CONTROL nBoton1_1, "ENABLE";

         |LEE 000#2=;
         |SI FSalida = 0;  |Y  #2#0 = #902#1;
             |ESTADO_CONTROL nBoton1_2, "ENABLE";
             |ESTADO_CONTROL nBoton1_3, "ENABLE";
             |ESTADO_CONTROL nBoton1_4, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton1_2, "DISABLE";
             |ESTADO_CONTROL nBoton1_3, "DISABLE";
             |ESTADO_CONTROL nBoton1_4, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EventoPanta2;
     |SI FSalida = 1;
         |ESTADO_CONTROL nBoton2_1, "ENABLE";

         |LEE 000#2=;
         |SI FSalida = 0;  |Y  #2#0 = #902#1;
             |ESTADO_CONTROL nBoton2_2, "ENABLE";
             |ESTADO_CONTROL nBoton2_3, "ENABLE";
         |SINO;
             |ESTADO_CONTROL nBoton2_2, "DISABLE";
             |ESTADO_CONTROL nBoton2_3, "DISABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta1;
     |CONTROL_SIMPLE nPanta1, "BOTON,{{193}} Alta", 0777, 0898, Boton1_1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{197}} Modificar", 1077, 1198, Boton1_2;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{199}} Baja ", 1377, 1498, Boton1_3;
     nBoton1_3 = FSalida;

     |CONTROL_SIMPLE nPanta1, "BOTON,{{218}} Recoger de la Excel", 1677, 1798, Boton1_4;
     nBoton1_4 = FSalida;

     |ESTADO_CONTROL nBoton1_1, "ENABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";
     |ESTADO_CONTROL nBoton1_4, "DISABLE";
|FPRC;

|PROCESO BotonesPanta2;
     |CONTROL_SIMPLE nPanta2, "BOTON,{{193}} Alta", 0777, 0898, Boton2_1;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,{{197}} Modificar", 1077, 1198, Boton2_2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE nPanta2, "BOTON,{{199}} Baja ", 1377, 1498, Boton2_3;
     nBoton2_3 = FSalida;

     |ESTADO_CONTROL nBoton2_1, "ENABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_3, "DISABLE";
|FPRC;

|PROCESO Curso;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     #0#0 = #902#0;
     |LEE 000#0=;
     |SI FSalida = 0;
         |MENAV "0000 El Curso ya Existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO CursoComercial;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     |SELECT #2#0;
     #0#1 = #902#1;
     |LEE 000#0=;
     |SI FSalida = 0;
         |MENAV "0000 El Codigo Comercial ya existe en otro Curso.";
         |ERROR;
     |FINSI;

     |SELECT #1#0;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |ABRET #2;

     FSalida = 2799;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #2;
|FPRC;

|PROGRAMA;
     nCampoHasta = 66;
     |C_M #902#0, 1, "S";
     |C_M #902#1, 1, "S";

     |ABRE #0;
     |SI enModo ! 1;
         #0#0 = enCurso;
         |LEE 101#0=;
         |SI FSalida ! 0;  |DDEFECTO #0; |FINSI;

         |PARA nCampoD = 0;  |SI nCampoD [ nCampoHasta;   |HACIENDO nCampoD = nCampoD + 1;
               nCampoH = nCampoD;
               #902nCampoH = #0nCampoD;
         |SIGUE;

         |C_M #902#0, 1, "N";
         |C_M #902#1, 1, "N";
     |FINSI;

     |CABEZA "Curso Base";

     |PINPA #0#902;  nPanta0 = FSalida;
     |PINDA #0#902;

     |PINPA #1#902;  nPanta1 = FSalida;
     |PINDA #1#902;

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 0702;
     nPos2  = 2160;

     |LINEAL_SIMPLE #1#2, nRango, nPos1, nPos2, BajaPanta1, AltaPanta1, EventoPanta1;
     nGrid1 = FSalida;

     |PINPA #2#902;  nPanta2 = FSalida;
     |PINDA #2#902;

     nRango = 4 + 8 + 16 + 32;
     nPos1  = 0702;
     nPos2  = 2160;

     |LINEAL_SIMPLE #1#2, nRango, nPos1, nPos2, BajaPanta2, AltaPanta2, EventoPanta2;
     nGrid2 = FSalida;

     |PINPA #3#902;  nPanta3 = FSalida;
     |PINDA #3#902;

     |HAZ BotonesPanta1;
     |HAZ BotonesPanta2;

     |SI enModo = 1;  |ENDATOS #1#902;  |FINSI;
     |SI enModo = 2;  |ENDATOS #2#902;  |FINSI;

     |SI FSalida = 0;
         |HAZ GrabaCurso;
     |FINSI;
     |CIERRA #0;

     |FIN_CONTROL_WINDOWS nBoton1_1;
     |FIN_CONTROL_WINDOWS nBoton1_2;
     |FIN_CONTROL_WINDOWS nBoton1_3;
     |FIN_CONTROL_WINDOWS nBoton1_4;
     |FIN_CONTROL_WINDOWS nBoton2_1;
     |FIN_CONTROL_WINDOWS nBoton2_2;
     |FIN_CONTROL_WINDOWS nBoton2_3;

     |DESTRUYECONTROL nGrid1;
     |DESTRUYECONTROL nGrid2;

     |PULSATECLA;
|FPRO;
