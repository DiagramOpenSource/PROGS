|FICHEROS;
     dsorz020 #0;
     dsorm001 #1;
|FIN;

|VARIABLES;
     aParametro = "";
     aAlfa      = "";

     &enChequeoUsu = 0;
     &enErrorUsu   = 0;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI #0#2 ! "SI";  |ACABA;  |FINSI;

     enChequeoUsu = 1;
     |HAZ RevisaUsuarios;
     |SI enErrorUsu = 1;
         enChequeoUsu = 0;
         |HAZ RevisaUsuarios;
     |FINSI;

     enChequeoUsu = 1;
     |HAZ RevisaUsuarios;
     |SI enErrorUsu = 1;
         |MENAV "0000 Proceso cancelado. Entre en la opcion Grupos en Maestros, para actualizar usuarios";
         |ACABA;
     |FINSI;

     #0#3 = "Borrado ficheros PSD";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     |SUB_EJECUTA ":agitool/dsinsbor;AUTOMATICO";

     #0#3 = "Creacion de Usuarios a Partir de los Grupos";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     |SUB_EJECUTA "dsprez01;AUTOMATICO";

     aParametro = ("0000" + #0#0) % -104;
     #0#3 = "Generando Grupos";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     aAlfa = "dsorz005;" + aParametro;
     |SUB_EJECUTA aAlfa;

/*
     |SI #0#0 = 0;
         aParametro = "AUTOMATICO";
     |SINO;
         aParametro = ("0000" + #0#0) % -104;
     |FINSI;
     #0#3 = "Creando Fichero de Grupos";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     aAlfa = "dsorz006;" + aParametro;
     |SUB_EJECUTA aAlfa;

     #0#3 = "Instalado Grupos ";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     |SUB_EJECUTA ":agitool/dsinsgru;AUTOMATICO";
*/

     #0#3 = "Generando Permisos de Usuarios ";
     |SI PARAMETRO = "";  |PINTA #0#3;  |FINSI;
     aAlfa =":agitool/dsinsusu;" + aParametro;
     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO Tipo0C0;
     |SI #0#0 = 0;
         #0#1 = "TODOS LOS GRUPOS";
     |SINO;
         |ABRE #1;
         #1#0 = #0#0;
         |LEE 000#1=;
         |SI FSalida ! 0;
             |MENAV "0000 No existe el grupo.";
             |ERROR;
         |FINSI;
         |CIERRA #1;

         #0#1 = #1#1;
     |FINSI;

     |PINTA #0#1;
|FPRC;

|PROGRAMA;
     aParametro = PARAMETRO;  |QBF aParametro;
     |SI aParametro = "";
         |MANTE #0;
     |SINO;
         #0#0 = PARAMETRO;
         #0#2 = "SI";

         |HAZ Tipo12;
     |FINSI;
|FPRO;
