|FICHEROS;
     dsorz004 #0;
     dsorm009 #9;
     dsorm010 #10;
     dsorw005 #91;
     dsorw007 #97;
     dsorw008 #98;
     dsorw009 #99;

     referen@ #900;
|FIN;

|VARIABLES
     aBase       = "";
     aMas        = "";
     aQueQuiero  = "";
     aFichero    = "";
     aTitulo     = "";
     aAlfa       = "";
     aLongitud   = "";
     nCampo      = 0;
     nModo       = 0;
     nNume       = 0;
|FIN;

|PROCESO TipoOperacion;
     |C_M #10#8, 1, "S";
     |SI #10#6 = "=";  |O #10#6 = "!";
         |C_M #10#8, 1, "N";  #10#8 = "";  |PINTA #10#8;
     |FINSI;
|FPRC;

|PROCESO Formula;
     |SI aAlfa = "";
         aAlfa = "(" + #10#5;
     |SINO;
         |SI #10#9 = "S";
             aAlfa = aAlfa + ")" + " O " + "(" + #10#5;
         |SINO;
             aAlfa = aAlfa + " Y " + #10#5;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE dsorm010F;
     #10#1;
     ;
     #9#0, #9#1, #9#2, #9#3, 001;
     #9#0, #9#1, #9#2, #9#3, 999;
     be;
     NULL, Formula;
|FIN;

|PROCESO MontaFormula;
     aAlfa = "";
     |BUCLE dsorm010F;
     aAlfa = aAlfa + ")";
     #9#12 = aAlfa;  |PINTA #9#12;
|FPRC;

|PROCESO LeeCampo;
     |DBASS aBase;    |QBF aBase;
     aMas = aBase + #9#1 + "/def/" + #9#2 + ".mas";  |QBT aMas;
     |CARGA_DEF aMas, referen@;
     |SI FSalida ! 0;
         |MENAV "     No existe la Tabla";
         |ERROR;
         |ACABA;
     |FINSI;

     aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
     aFichero   = (#900#aQueQuiero# + (" " * 20)) % 120;
     aTitulo    = aFichero;  |QBF aTitulo;
     |SI aTitulo = "";
         |MENAV "     Campo Inexistente";
         |ERROR;
     |FINSI;

     aQueQuiero = "|C" + (("000" + nCampo) % -103) + "LONGITUD";
     aLongitud  = #900#aQueQuiero#;

     |DESCARGA_DEF #referen@;
|FPRC;

|RUTINA ClaveBaja10;
     #10#0 = #9#0;
     #10#1 = #9#1;
     #10#2 = #9#2;
     #10#3 = #9#3;
     #10#4 = 001;
|FRUT;

|RUTINA ClaveAlta10;
     #10#0 = #9#0;
     #10#1 = #9#1;
     #10#2 = #9#2;
     #10#3 = #9#3;
     #10#4 = 999;
|FRUT;

|RUTINA ClaveBaja91;
     #91#0  = 000;
|FRUT;

|RUTINA ClaveAlta91;
     #91#0  = 999;
|FRUT;

|PROCESO Intro;  |TIPO 0;
     nCampo = #91#0;
     |PTEC 807;
|FPRC;

|PROCESO Tipo3m09;  |TIPO 3;
     |ENTLINEAL #1#10, -5, 1, 22, 0,ClaveBaja10, ClaveAlta10;

     |HAZ MontaFormula;
|FPRC;

|PROCESO Tipo7m09;  |TIPO 7;
     |ENTLINEAL #1#10, -5, 7, 22, 0,ClaveBaja10, ClaveAlta10;
|FPRC;

|PROCESO PonDescri;  |TIPO 7;
     #9#4 = #97#1;  |PINTA #9#4;
     #9#5 = #98#2;  |PINTA #9#5;
     #9#6 = #99#3;  |PINTA #9#6;

     nNume = 70;

     |CAMPO_ANCHO  #10#7, 1, nNume;
     |CAMPO_ANCHO  #10#8, 1, nNume;

     nCampo = #9#3;
     |HAZ LeeCampo;

     #9#7 = aTitulo;  |PINTA #9#7;

     nNume = aLongitud;

     |CAMPO_ANCHO  #10#7, 1, nNume;
     |CAMPO_ANCHO  #10#8, 1, nNume;

     |PINTA #10#7;
     |PINTA #10#8;
|FPRC;

|PROCESO Tipo11m09;  |TIPO 11;
     |SI FSalida = 10;
         aFichero = "dsorw005" + Usuario;
         |NOME_DAT #91#aFichero#;

         nCampo = -1;
         |PUSHV 0501 2380;
         |ENTLINEAL #1#91, -1, 4, 22, 1, ClaveBaja91, ClaveAlta91;
         |PULSATECLA;
         |POPV;

         |SI nCampo = -1;  |ACABA;  |FINSI;

         #9#3 = nCampo;  |PINTA #9#3;
     |FINSI;
|FPRC;

|PROCESO Borra10F;
     |BORRA 020#10a;
     |LIBERA #10;
|FPRC;

|DEFBUCLE dsorm010B;
     #10#1;
     ;
     #9#0, #9#1, #9#2, #9#3, 000;
     #9#0, #9#1, #9#2, #9#3, 999;
     be;
     NULL, Borra10F;
|FIN;

|PROCESO Tipo2m09;  |TIPO 2;
     nModo  = (FEntrada / 100) ! 0;
     |SI nModo ! 3;  |ACABA;  |FINSI;

     |BUCLE dsorm010B;
|FPRC;
