|FICHEROS;
     dsprem03 #3;
     dsprem04 #4;
     dsprem05 #5;
     dsprem06 #6;
     dsprem07 #7;
     dsorm003 #103;
     dsorm004 #104;
|FIN;

|VARIABLES;
     nForma     = 0;
     nModo      = 0;
     nCodGrupo  = 0;

     aDAlfa     = "";
     aHAlfa     = "";

     &enArea    = 0;
     &enNivel   = 0;
     &eaTitulo  = "";
|FIN;

|PROCESO dsprem03;
     |BORRA 020#3a;
     |LIBERA #3;
|FPRC;

|DEFBUCLE dsprem03;
     #3#1;
     ;
     0, 00, 00, #7#0, #7#1;
     9, 99, 99, #7#0, #7#1;
     be;
     NULL, dsprem03;
|FIN;

|PROCESO dsorm003;
     |BORRA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE dsorm003;
     #103#1;
     ;
     nCodGrupo, "        ", "        ", aDAlfa;
     nCodGrupo, "zzzzzzzz", "zzzzzzzz", aHAlfa;
     be;
     NULL, dsorm003;
|FIN;

|PROCESO dsorm004;
     |BORRA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE dsorm004;
     #104#1;
     ;
     nCodGrupo, "        ", "        ";
     nCodGrupo, "zzzzzzzz", "zzzzzzzz";
     be;
     NULL, dsorm004;
|FIN;

|PROCESO Tipo2F7;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |CONFI "0000NSe borraran tanto las restricciones de menus como las de tabla, seguro";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;

         |ABRE #4;
         |SELECT #5#4;
         #4#3 = #7#0;
         #4#4 = #7#1;
         #4#5 = "";
         |LEE 000#4];
         |SI FSalida = 0;  |Y  #4#3 = #7#0;  |Y #4#4 = #7#1;
             |MENAV "0000 Existen Usuarios en este Area-Nivel no puedo dar de BAJA la Ficha.";
             |CIERRA #4;
             |ERROR;
             |ACABA;
         |FINSI;

         |BUCLE dsprem03;

         nCodGrupo = (#7#0 * 100) + #7#1;
         aDAlfa    = "";
         aHAlfa    = "z" * 100;
         |BUCLE dsorm003;
         |BUCLE dsorm004;

         |CIERRA #4;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;
     |SI nForma ! 1;  |ACABA;  |FINSI;

     enArea    = #7#0;
     enNivel   = #7#1;
     eaTitulo  = #7#2;  |QBF eaTitulo;
     eaTitulo  = eaTitulo + " " + #7#3;

     |SI PARAMETRO = "MENUS";
         |SUB_EJECUTA_NP "dsorz001;DSPREVEN";
     |FINSI;

     |SI PARAMETRO = "TABLAS";
         |SUB_EJECUTA_NP "dsorz002;DSPREVEN";
     |FINSI;

     |SI PARAMETRO = "EMPRESAS";
         |SUB_EJECUTA_NP "dsorz004;DSPREVEN";
     |FINSI;
|FPRC;

|RUTINA Baja07;
     #7#0 = 01;
     #7#1 = 01;
|FRUT;

|RUTINA Alta07;
     #7#0 = 99;
     #7#1 = 99;
|FRUT;

|PROCESO Area;  |TIPO 7;
     |ABRE #5;
     #5#0 = #7#0;
     |LEE 000#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #5;

     |ABRE #6;
     #6#0 = #7#1;
     |LEE 000#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     #7#2 = #5#1;  |PINTA #7#2;
     #7#3 = #6#1;  |PINTA #7#3;
|FPRC;

|PROGRAMA;
     |CLS;

     |SI PARAMETRO = "MENUS";
         |CABEZA "Asistente Menus";
     |FINSI;

     |PINPA #0#7;

     |SI PARAMETRO = "TABLAS";
         |ATRI S;
         |PINTA 0502, "Asistente a Restriciones de Tablas";
         |ATRI 0;

         |CABEZA "Asistente Tablas";
     |FINSI;

     |SI PARAMETRO = "EMPRESAS";
         |ATRI S;
         |PINTA 0502, "Asistente Filtros de Campos General";
         |ATRI 0;

         |CABEZA "Asistente Campos";
     |FINSI;

     |ENTLINEAL #1#7, -1, 2, 22, 0, Baja07, Alta07;
|FPRO;
