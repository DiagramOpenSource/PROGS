|FICHEROS;
     dsorz999 #0;

     dsprem01 #1;  || Tipo A
     dsprem02 #2;  || Tipo A
     dsprem03 #3;  || Tipo A
     dsprem04 #4;  || Tipo A
     dsprem07 #7;  || Tipo A

     dsorm001 #11;  || Tipo G
     dsorm002 #12;  || Tipo G
     dsorm003 #13;  || Tipo G
     dsorm004 #14;  || Tipo G
     dsorm005 #15;  || Tipo G
|FIN;

|VARIABLES;
     aTipo    = "";
     aBase    = "";
     aOrigen  = "";
     aDestino = "";

     nSalida1 = 0;
     nSalida2 = 0;
     nSalida3 = 0;
     nSalida4 = 0;
     nSalida5 = 0;
     nSalida6 = 0;
     nSalida7 = 0;

     nSalida11 = 0;
     nSalida12 = 0;
     nSalida13 = 0;
     nSalida14 = 0;
     nSalida15 = 0;
|FIN;

|PROCESO CalculaTipo;
     |ABRE #1;  |LEE 000#1p;  nSalida1 = FSalida;  |CIERRA #1;
     |ABRE #2;  |LEE 000#2p;  nSalida2 = FSalida;  |CIERRA #2;
     |ABRE #3;  |LEE 000#3p;  nSalida3 = FSalida;  |CIERRA #3;
     |ABRE #4;  |LEE 000#4p;  nSalida4 = FSalida;  |CIERRA #4;
     |ABRE #7;  |LEE 000#7p;  nSalida7 = FSalida;  |CIERRA #7;

     |ABRE #11;  |LEE 000#11p;  nSalida11 = FSalida;  |CIERRA #11;
     |ABRE #12;  |LEE 000#12p;  nSalida12 = FSalida;  |CIERRA #12;
     |ABRE #13;  |LEE 000#13p;  nSalida13 = FSalida;  |CIERRA #13;
     |ABRE #14;  |LEE 000#14p;  nSalida14 = FSalida;  |CIERRA #14;
     |ABRE #15;  |LEE 000#15p;  nSalida15 = FSalida;  |CIERRA #15;

     aTipo = "";
     |SI nSalida1 = 0;  |O nSalida2 = 0;  |O nSalida3 = 0;  |O nSalida4 = 0;
      |O nSalida7 = 0;
         aTipo = "A";
     |SINO;
          |SI nSalida11 = 0;  |O nSalida12 = 0;  |O nSalida13 = 0;
           |O nSalida14 = 0;  |O nSalida15 = 0;
              aTipo = "G";
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#1 = " ";
         |GRABA 020#0b;
     |FINSI;

     |SI #0#1 = " ";
         |HAZ CalculaTipo;

         #0#1 = aTipo;

         |PINPA #0#0;
         |PINDA #0#0;
         |PARA;  |SI;  |HACIENDO;
             |ENDATOS #1#0;
             |SI FSalida = 0;
                 |GRABA 020#0a;
                 |SAL;
             |FINSI;
         |SIGUE;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;

     |DBASE aBase;  |QBF aBase;

     |SI #0#1 = "G";  aOrigen  = aBase + "dsoport1.men";  |FINSI;
     |SI #0#1 = "A";  aOrigen  = aBase + "dsoport2.men";  |FINSI;

     aDestino = aBase + "dsmenu.men";
     |COPIA_FICHERO aOrigen, aDestino;
|FPRO;
