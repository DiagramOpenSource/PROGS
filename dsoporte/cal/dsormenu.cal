|FICHEROS;
     dsorm003;

     dsprem07;

     dsorw001;
     dsorw010;

     dsorw001@;
|FIN;

|VARIABLES;
     aCaracter = "";
     aDescri   = "";
     aPrograma = "";
     aAlfa     = "";
     aAlfa1    = "";
     aLong     = "";
     aFichero  = "";
     aBase     = "";
     aMenu     = "";
     aClave1   = "";
     aClave2   = "";
     aClave3   = "";
     aClave4   = "";
     aClave5   = "";
     aClave6   = "";
     aClave7   = "";
     aClave8   = "";
     aClave9   = "";
     aClave10  = "";
     aClave11  = "";
     aClave12  = "";
     aClave13  = "";
     aClave14  = "";
     aClave15  = "";
     aMarca    = "";
     aDClave   = "";
     aHClave   = "";
     aClaveMenu = "";
     aParametro = "";
     aNumero    = "";
     aMas       = "";

     nClave    = 0;
     nLong     = 0;
     nSw       = 0;
     nCaracter = 0;
     nPos      = 0;
     nHandle   = 0;
     nPasada   = 0;
     nCampo    = 0;
     nIde      = 0;
     nHayNO    = 0;
     nHaySI    = 0;
     nPasadaMen= 0;
     nGrupo    = 0;

     nD1  = 0;   nH1  = 99999;
     nD2  = 0;   nH2  = 99999;
     nD3  = 0;   nH3  = 99999;
     nD4  = 0;   nH4  = 99999;
     nD5  = 0;   nH5  = 99999;
     nD6  = 0;   nH6  = 99999;
     nD7  = 0;   nH7  = 99999;
     nD8  = 0;   nH8  = 99999;
     nD9  = 0;   nH9  = 99999;
     nD10 = 0;   nH10 = 99999;
     nD11 = 0;   nH11 = 99999;
     nD12 = 0;   nH12 = 99999;
     nD13 = 0;   nH13 = 99999;
     nD14 = 0;   nH14 = 99999;
     nD15 = 0;   nH15 = 99999;

     &enArea   = 0;
     &enNivel  = 0;
     &eaCab    = "";
     &enGrupo  = 0;
     &eaAplica = "";
     &eaMenu   = "";
     &enPRM    = 0;
     &enError  = 0;
     &enPoner  = 0;
|FIN;

|PROCESO Clave;
     |SI aCaracter = "\";  |ACABA;  |FINSI;

     aClaveMenu = aClaveMenu + aCaracter;

     |SI aCaracter = ",";
         nClave = nClave + 1;
         |ACABA;
     |FINSI;

     |SI nClave = 1;   aClave1  = aClave1  + aCaracter;  |FINSI;
     |SI nClave = 2;   aClave2  = aClave2  + aCaracter;  |FINSI;
     |SI nClave = 3;   aClave3  = aClave3  + aCaracter;  |FINSI;
     |SI nClave = 4;   aClave4  = aClave4  + aCaracter;  |FINSI;
     |SI nClave = 5;   aClave5  = aClave5  + aCaracter;  |FINSI;
     |SI nClave = 6;   aClave6  = aClave6  + aCaracter;  |FINSI;
     |SI nClave = 7;   aClave7  = aClave7  + aCaracter;  |FINSI;
     |SI nClave = 8;   aClave8  = aClave8  + aCaracter;  |FINSI;
     |SI nClave = 9;   aClave9  = aClave9  + aCaracter;  |FINSI;
     |SI nClave = 10;  aClave10 = aClave10 + aCaracter;  |FINSI;
     |SI nClave = 11;  aClave11 = aClave11 + aCaracter;  |FINSI;
     |SI nClave = 12;  aClave12 = aClave12 + aCaracter;  |FINSI;
     |SI nClave = 13;  aClave13 = aClave13 + aCaracter;  |FINSI;
     |SI nClave = 14;  aClave14 = aClave14 + aCaracter;  |FINSI;
     |SI nClave = 15;  aClave15 = aClave15 + aCaracter;  |FINSI;
|FPRC;

|PROCESO Descripcion;
     |SI aCaracter = ":";  |ACABA;  |FINSI;

     aDescri = aDescri + aCaracter;
|FPRC;

|PROCESO Programa;
     aPrograma = aPrograma + aCaracter;
|FPRC;

|PROCESO dsorm003;
     aMarca = "S";
     |SI #dsorm003#4 = "P";  aMarca = "P";  |FINSI;

     |BORRA 020#dsorm003.a;
     |LIBERA #dsorm003;

     |ERROR10;
|FPRC;

|DEFBUCLE dsorm003;
     #dsorm003#2;
     ;
     nGrupo, #dsorw010#1, #dsorw010#2, #dsorw001#15, #dsorw001#17, aDClave;
     nGrupo, #dsorw010#1, #dsorw010#2, #dsorw001#15, #dsorw001#17, aHClave;
     be;
     NULL, dsorm003;
|FIN;

|PROCESO GrabaMenu;
     aClave1    = ""; aClave2  = ""; aClave3  = ""; aClave4  = ""; aClave5  = "";
     aClave6    = ""; aClave7  = ""; aClave8  = ""; aClave9  = ""; aClave10 = "";
     aClave11   = ""; aClave12 = ""; aClave13 = ""; aClave14 = ""; aClave15 = "";
     aDescri    = "";
     aPrograma  = "";
     aClaveMenu = "";

     |QBF aAlfa1;
     |SI aAlfa1 = "";  |ACABA;  |FINSI;

     aAlfa = aAlfa1 % 101;
     |SI aAlfa = "#";  |ACABA;  |FINSI;
     |SI aAlfa = ";";  |ACABA;  |FINSI;

     aLong   = aAlfa1 % 0;
     aNumero = "";
     nLong   = aLong;
     nSw     = 1;
     nClave  = 1;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos = (nCaracter * 100) + 1;
           aCaracter = aAlfa1 % nPos;

           |SI aCaracter = "\";
               |SI nSw = 1;
                   nSw = 0;
               |SINO;
                   nSw = 1;
               |FINSI;
           |SINO;
               |SI nSw = 0;
                   aNumero = aNumero + aCaracter;
               |FINSI;
           |FINSI;

           |SI aCaracter = ":"; |Y nSw = 1;    nSw = 2;   |FINSI;
           |SI aCaracter = "{"; |Y nSw = 2;    nSw = 3;   |FINSI;

           |SI nSw = 1;  |HAZ Clave;        |FINSI;
           |SI nSw = 2;  |HAZ Descripcion;  |FINSI;
           |SI nSw = 3;  |HAZ Programa;     |FINSI;
     |SIGUE;

     #dsorw001#0  = aClave1;
     #dsorw001#1  = aClave2;
     #dsorw001#2  = aClave3;
     #dsorw001#3  = aClave4;
     #dsorw001#4  = aClave5;
     #dsorw001#5  = aClave6;
     #dsorw001#6  = aClave7;
     #dsorw001#7  = aClave8;
     #dsorw001#8  = aClave9;
     #dsorw001#9  = aClave10;
     #dsorw001#10 = aClave11;
     #dsorw001#11 = aClave12;
     #dsorw001#12 = aClave13;
     #dsorw001#13 = aClave14;
     #dsorw001#14 = aClave15;

     #dsorw001#15  = aDescri;
     #dsorw001#17  = aPrograma;
     #dsorw001#18  = aClaveMenu;
     #dsorw001#19  = aNumero;
     aMarca = "N";
     |SI aNumero ! "";
         |ABRE #dsorm003;
         |SELECT #1#dsorm003;
         #dsorm003#0 = nGrupo;
         #dsorm003#1 = #dsorw010#1;
         #dsorm003#2 = #dsorw010#2;
         #dsorm003#6 = aNumero;
         |LEE 101#dsorm003.=;
         |SI FSalida = 0;
             aMarca = "S";
             |SI #dsorm003#4 = "P";  aMarca = "P";  |FINSI;

             |BORRA 020#dsorm003.a;
             |LIBERA #dsorm003;
         |FINSI;
         |CIERRA #dsorm003;
     |SINO;
         aMarca  = "N";
         aDClave = " ";
         aHClave = "z" * 100;
         |BUCLE dsorm003;
     |FINSI;

     |SI #dsorw010#3 = "S";  aMarca = "S";  |FINSI;
     |SI #dsorw010#3 = "X";  aMarca = "N";  |FINSI;
     |SI #dsorw010#3 = "P";  aMarca = "P";  |FINSI;

     #dsorw001#16 = aMarca;

     nIde  = nIde + 1;
     #dsorw001#20 = nIde;

     |GRABA 020#dsorw001.n;
     |LIBERA #dsorw001;
|FPRC;

|PROCESO dsorm003B;
     |BORRA 020#dsorm003.a;
     |LIBERA #dsorm003;
|FPRC;

|DEFBUCLE dsorm003B;
     #dsorm003#1;
     ;
     nGrupo, #dsorw010#1, #dsorw010#2, aDClave;
     nGrupo, #dsorw010#1, #dsorw010#2, aHClave;
     be;
     NULL, dsorm003B;
|FIN;

|PROCESO Borra3;
     aDClave = " ";
     aHClave = "z" * 100;
     |BUCLE dsorm003B;
|FPRC;

|PROCESO Graba3;

     |PARA nCampo = 0;  |SI nCampo [ 14;  |HACIENDO nCampo = nCampo + 1;
           #dsorw001@#nCampo# = #dsorw001#nCampo#;
     |SIGUE;

     |PARA nCampo = 14;  |SI nCampo ] 0;  |HACIENDO nCampo = nCampo - 1;
           |SI #dsorw001@#nCampo# ! 0;
               #dsorw001@#nCampo# = 0;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI #dsorw001@#0 ! 0;
         |LEE 000#dsorw001@.=;
         |SI FSalida = 0;
             |SI #dsorw001@#16 = "S";  |Y #dsorw001#16 = "N";
                 #dsorw001#16 = "S";
                 |GRABA 020#dsorw001.a;
             |FINSI;
         |FINSI;
     |FINSI;

     |LIBERA #dsorw001;

     |SI #dsorw001#16 = "N";  |ACABA;  |FINSI;

     |SI enPoner = 1;
         #dsorm003#0 = nGrupo;
         #dsorm003#1 = #dsorw010#1;
         #dsorm003#2 = #dsorw010#2;
         #dsorm003#6 = #dsorw001#18;
         |SI #dsorw001#19 ! 0;  #dsorm003#6 = ("00000" + #dsorw001#19) % -105;  |FINSI;
         |LEE 101#dsorm003.=;
         |SI FSalida = 0;
             |BORRA 020#dsorm003.a;
             |LIBERA #dsorm003;
         |FINSI;

         |ACABA;
     |FINSI;

     #dsorm003#0 = nGrupo;
     #dsorm003#1 = #dsorw010#1;
     #dsorm003#2 = #dsorw010#2;
     #dsorm003#6 = #dsorw001#18;
     |SI #dsorw001#19 ! 0;  #dsorm003#6 = ("00000" + #dsorw001#19) % -105;  |FINSI;
     |LEE 101#dsorm003.=;
     |SI FSalida ! 0;
         #dsorm003#0  = nGrupo;
         #dsorm003#1  = #dsorw010#1;
         #dsorm003#2  = #dsorw010#2;
         #dsorm003#3  = #dsorw001#17;
         #dsorm003#4  = "N";
         |SI #dsorw001#16 = "P";  #dsorm003#4  = "P";    |FINSI;
         |SI #dsorw010#3 = "S";  #dsorm003#4  = #dsorw010#3;  |FINSI;
         #dsorm003#5  = #dsorw001#15;
         #dsorm003#6  = #dsorw001#18;
         |SI #dsorw001#19 ! 0;  #dsorm003#6 = ("00000" + #dsorw001#19) % -105;  |FINSI;
         #dsorm003#7  = #dsorw010#4;

                                               #dsorm003#8  = 1;
         |SI #dsorw010#5 = "MENSAJE        ";  #dsorm003#8  = 2;  |FINSI;

         |GRABA 020#dsorm003.n;
     |SINO;
         #dsorm003#7  = #dsorw010#4;

         |SI #dsorw001#16 = "P";  #dsorm003#4  = "P";    |FINSI;

                                         #dsorm003#8  = 1;
         |SI #dsorw010#5 = "MENSAJE        ";  #dsorm003#8  = 2;  |FINSI;

         |GRABA 020#dsorm003.a;
     |FINSI;
     |LIBERA #dsorm003;
|FPRC;

|DEFBUCLE dsorw001G;
     #dsorw001#1;
     ;
     nD1,nD2,nD3,nD4,nD5,nD6,nD7,nD8,nD9,nD10,nD11,nD12,nD13,nD14,nD15;
     nH1,nH2,nH3,nH4,nH5,nH6,nH7,nH8,nH9,nH10,nH11,nH12,nH13,nH14,nH15;
     be;
     NULL, Graba3;
|FIN;

|PROCESO dsprem07;
     nGrupo  = (#dsprem07#0 * 100) + #dsprem07#1;
     aDClave = " ";
     aHClave = "z" * 100;

     |SI #dsorw010#1 = "menugnrl";
         |ABRE #dsorm003;
         #dsorm003#0 = nGrupo;
         #dsorm003#1 = #dsorw010#1;
         #dsorm003#2 = #dsorw010#2;
         #dsorm003#6 = "";
         |LEE 000#dsorm003.];
         |SI FSalida ! 0;  |O  #dsorm003#0 ! nGrupo;
                           |O  #dsorm003#1 ! #dsorw010#1;
                           |O  #dsorm003#2 ! #dsorw010#2;
             |CIERRA #dsorm003;
             |ACABA;
         |FINSI;

         |CIERRA #dsorm003;
     |FINSI;

     |DBASE aMas;  |QBF aMas;
     aMas = aMas + "def/dsorw001.mas";
     |CARGA_DEF aMas, dsorw001@;
     |NOME_DAT #dsorw001@#aFichero#;

     |ABRE #dsorm003;
     |ABRE #dsorw001@;
     |BUCLE dsorw001G;
     |CIERRA #dsorw001@;
     |CIERRA #dsorm003;

     |DESCARGA_DEF #dsorw001@;
|FPRC;

|DEFBUCLE dsprem07;
     #dsprem07#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, dsprem07;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsorw001#aFichero#;

     |ABRE #dsorw001;  |CIERRA #dsorw001;  |DELINDEX #dsorw001;

     |ABRE #dsorw001;
     |ABRE #dsorm003;

     nGrupo = #dsorw010#0;

     |SI #dsorw010#1 ! "menugnrl";
         |DBASS aBase;  |QBF aBase;
         aMenu = aBase + #dsorw010#1 + "/" + #dsorw010#2 + ".men";  |QBT aMenu;
     |SINO;
         |DBASS aBase;  |QBF aBase;
         aMenu = aBase + #dsorw010#2 + ".men";  |QBT aMenu;
     |FINSI;

     |XABRE "U", aMenu, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     nIde = 0;
     |PARA;  |SI;  |HACIENDO;
         |XLEE nHandle, 250, aAlfa1;
         |SI FSalida < 0;  |SAL;  |FINSI;
         |HAZ GrabaMenu;
     |SIGUE;

     |XCIERRA nHandle;

     |SELECT #1#dsorm003;
     #dsorm003#0 = nGrupo;
     #dsorm003#1 = #dsorw010#1;
     #dsorm003#2 = #dsorw010#2;
     #dsorm003#6 = "";
     |LEE 101#dsorm003.];
     |SI FSalida = 0;  |Y #dsorm003#0 = nGrupo; |Y #dsorm003#1 = #dsorw010#1;  |Y #dsorm003#2 = #dsorw010#2;
         |MENAV "0000 El Menu Actual ha cambiado respecto al ultimo revisado, asegurese de que todo esta bien.";
     |FINSI;

     |CIERRA #dsorw001;
     |CIERRA #dsorm003;

     |SI #dsorw010#3 = "N";  |Y enPRM = 0;
         aAlfa = "|:dsoporte/dsorz016;" + Usuario + eaCab;
         |SUB_EJECUTA aAlfa;
     |FINSI;

     |SI #dsorw010#0 ! 0;
         aDClave = " ";
         aHClave = "z" * 100;

         |BUCLE dsorm003B;

         |DBASE aMas;  |QBF aMas;
         aMas = aMas + "def/dsorw001.mas";
         |CARGA_DEF aMas, dsorw001@;
         |NOME_DAT #dsorw001@#aFichero#;

         |ABRE #dsorm003;
         |ABRE #dsorw001@;
         |BUCLE dsorw001G;
         |CIERRA #dsorw001@;
         |CIERRA #dsorm003;

         |DESCARGA_DEF #dsorw001@;
     |FINSI;

     |SI #dsorw010#0 = 0;
         |BUCLE dsprem07;
     |FINSI;

     |DELINDEX #dsorw001;
|FPRC;


||DESDE LOS PERFILES

|PROCESO temporal_Chequeo;
     |SI  #dsorw001#0  = #dsorw001@#0;  |Y  #dsorw001#1  = #dsorw001@#1;
      |Y  #dsorw001#2  = #dsorw001@#2;  |Y  #dsorw001#3  = #dsorw001@#3;
      |Y  #dsorw001#4  = #dsorw001@#4;  |Y  #dsorw001#5  = #dsorw001@#5;
      |Y  #dsorw001#6  = #dsorw001@#6;  |Y  #dsorw001#7  = #dsorw001@#7;
      |Y  #dsorw001#8  = #dsorw001@#8;  |Y  #dsorw001#9  = #dsorw001@#9;
      |Y  #dsorw001#10 = #dsorw001@#10; |Y  #dsorw001#11 = #dsorw001@#11;
      |Y  #dsorw001#12 = #dsorw001@#12; |Y  #dsorw001#13 = #dsorw001@#13;
      |Y  #dsorw001#14 = #dsorw001@#14;
          |ACABA;
     |FINSI;

     |SI nPasadaMen = 1;
         |SI #dsorw001#16 = "S";
             |LEE 101#dsorw001@.=;
             |SI FSalida = 0;
                 #dsorw001@#16 = "S";
                 |GRABA 020#dsorw001@.a;
                 |LIBERA #dsorw001@;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #dsorw001@#16 = "S";
         nHaySI = nHaySI + 1;
     |SINO;
         nHayNO = nHayNO + 1;
     |FINSI;
|FPRC;

|DEFBUCLE temporal_Chequeo;
     #dsorw001@#1015;
     ;
     nD1,nD2,nD3,nD4,nD5,nD6,nD7,nD8,nD9,nD10,nD11,nD12,nD13,nD14,nD15;
     nH1,nH2,nH3,nH4,nH5,nH6,nH7,nH8,nH9,nH10,nH11,nH12,nH13,nH14,nH15;
     ;
     NULL, temporal_Chequeo;
|FIN;

|PROCESO dsorw001Cheq;
     nD1  = 0;   nH1  = 99999;
     nD2  = 0;   nH2  = 99999;
     nD3  = 0;   nH3  = 99999;
     nD4  = 0;   nH4  = 99999;
     nD5  = 0;   nH5  = 99999;
     nD6  = 0;   nH6  = 99999;
     nD7  = 0;   nH7  = 99999;
     nD8  = 0;   nH8  = 99999;
     nD9  = 0;   nH9  = 99999;
     nD10 = 0;   nH10 = 99999;
     nD11 = 0;   nH11 = 99999;
     nD12 = 0;   nH12 = 99999;
     nD13 = 0;   nH13 = 99999;
     nD14 = 0;   nH14 = 99999;
     nD15 = 0;   nH15 = 99999;

     |SI #dsorw001#0  ! 0;  nD1  = #dsorw001#0;   nH1  = #dsorw001#0;   |FINSI;
     |SI #dsorw001#1  ! 0;  nD2  = #dsorw001#1;   nH2  = #dsorw001#1;   |FINSI;
     |SI #dsorw001#2  ! 0;  nD3  = #dsorw001#2;   nH3  = #dsorw001#2;   |FINSI;
     |SI #dsorw001#3  ! 0;  nD4  = #dsorw001#3;   nH4  = #dsorw001#3;   |FINSI;
     |SI #dsorw001#4  ! 0;  nD5  = #dsorw001#4;   nH5  = #dsorw001#4;   |FINSI;
     |SI #dsorw001#5  ! 0;  nD6  = #dsorw001#5;   nH6  = #dsorw001#5;   |FINSI;
     |SI #dsorw001#6  ! 0;  nD7  = #dsorw001#6;   nH7  = #dsorw001#6;   |FINSI;
     |SI #dsorw001#7  ! 0;  nD8  = #dsorw001#7;   nH8  = #dsorw001#7;   |FINSI;
     |SI #dsorw001#8  ! 0;  nD9  = #dsorw001#8;   nH9  = #dsorw001#8;   |FINSI;
     |SI #dsorw001#9  ! 0;  nD10 = #dsorw001#9;   nH10 = #dsorw001#9;   |FINSI;
     |SI #dsorw001#10 ! 0;  nD11 = #dsorw001#10;  nH11 = #dsorw001#10;  |FINSI;
     |SI #dsorw001#11 ! 0;  nD12 = #dsorw001#11;  nH12 = #dsorw001#11;  |FINSI;
     |SI #dsorw001#12 ! 0;  nD13 = #dsorw001#12;  nH13 = #dsorw001#12;  |FINSI;
     |SI #dsorw001#13 ! 0;  nD14 = #dsorw001#13;  nH14 = #dsorw001#13;  |FINSI;
     |SI #dsorw001#14 ! 0;  nD15 = #dsorw001#14;  nH15 = #dsorw001#14;  |FINSI;

     nHaySI = 0;
     nHayNO = 0;
     |BUCLE temporal_Chequeo;

     |SI nHayNO = 0;  |Y nHaySI = 0;
         |SI #dsorw001#16 = "S";
             nHaySI = 1;
         |SINO;
             nHayNO = 1;
         |FINSI;
     |FINSI;

     |SI nHayNO ! 0;
         |SI #dsorw001#16 = "S";
             #dsorw001#16 = "N";
         |FINSI;
     |FINSI;

     |SI nHaySI ! 0;  |Y nHayNO = 0;
         |SI #dsorw001#16 ! "S";
             #dsorw001#16 = "S";
         |FINSI;
     |FINSI;

     |GRABA 020#dsorw001.a;
     |LIBERA #dsorw001;
|FPRC;

|DEFBUCLE dsorw001Cheq;
     #dsorw001#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, dsorw001Cheq;
|FIN;

|PROCESO LoCreaDesdePerfiles;
     #dsorw010#0 = enGrupo;
     #dsorw010#1 = eaAplica;
     #dsorw010#2 = eaMenu;

     |ABRE #dsorm003;
     #dsorm003#0 = #dsorw010#0;
     #dsorm003#1 = #dsorw010#1;
     #dsorm003#2 = #dsorw010#2;
     #dsorm003#6 = "";
     |LEE 040#dsorm003.];
     |SI FSalida = 0;  |Y #dsorm003#0 = #dsorw010#0; |Y #dsorm003#1 = #dsorw010#1; |Y #dsorm003#2 = #dsorw010#2;
         #dsorw010#3 = #dsorm003#4;
         |SI #dsorw010#3 = "P";  #dsorw010#3 = "N";  |FINSI;
         #dsorw010#4 = #dsorm003#7;

                               #dsorw010#5 = "QUITAR ACCESO";
         |SI #dsorm003#8 = 2;  #dsorw010#5 = "MENSAJE        ";  |FINSI;
     |FINSI;

     aFichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #dsorw001#aFichero#;

     |ABRE #dsorw001;  |CIERRA #dsorw001;  |DELINDEX #dsorw001;

     |ABRE #dsorw001;

     |SI #dsorw010#1 ! "menugnrl";
         |DBASS aBase;  |QBF aBase;
         aMenu = aBase + #dsorw010#1 + "/" + #dsorw010#2 + ".men";  |QBT aMenu;
     |SINO;
         |DBASS aBase;  |QBF aBase;
         aMenu = aBase + #dsorw010#2 + ".men";  |QBT aMenu;
     |FINSI;

     |XABRE "U", aMenu, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     nIde = 0;
     |PARA;  |SI;  |HACIENDO;
          |XLEE nHandle, 250, aAlfa1;
          |SI FSalida < 0;  |SAL;  |FINSI;
          |HAZ GrabaMenu;
     |SIGUE;

     |XCIERRA nHandle;

     |CIERRA #dsorw001;
     |CIERRA #dsorm003;

     aDClave = " ";
     aHClave = "z" * 100;
     |HAZ Borra3;

     |DBASE aMas;  |QBF aMas;
     aMas = aMas + "def/dsorw001.mas";
     |CARGA_DEF aMas, dsorw001@;
     |NOME_DAT #dsorw001@#aFichero#;

     nPasadaMen = 0;  |BUCLE dsorw001Cheq;
     nPasadaMen = 1;  |BUCLE dsorw001Cheq;

     nD1  = 0;   nH1  = 99999;
     nD2  = 0;   nH2  = 99999;
     nD3  = 0;   nH3  = 99999;
     nD4  = 0;   nH4  = 99999;
     nD5  = 0;   nH5  = 99999;
     nD6  = 0;   nH6  = 99999;
     nD7  = 0;   nH7  = 99999;
     nD8  = 0;   nH8  = 99999;
     nD9  = 0;   nH9  = 99999;
     nD10 = 0;   nH10 = 99999;
     nD11 = 0;   nH11 = 99999;
     nD12 = 0;   nH12 = 99999;
     nD13 = 0;   nH13 = 99999;
     nD14 = 0;   nH14 = 99999;
     nD15 = 0;   nH15 = 99999;

     |ABRE #dsorm003;
     |ABRE #dsorw001@;
     |BUCLE dsorw001G;
     |CIERRA #dsorw001@;
     |CIERRA #dsorm003;

     |DESCARGA_DEF #dsorw001@;

     |DELINDEX #dsorw001;
|FPRC;
