|FICHEROS;
     rem05000 #0;
     rem05001 #1;
     rem05002 #2;
     rem05003 #3;
     rem05004 #4;
     rem05005 #5;
     rem05006 #6;
     rem05007 #7;
     rem05008 #8;
     rem05009 #9;
     rem05010 #10;
     rem05011 #11;
     rem05012 #12;
     rem05013 #13;
     rem05014 #14;
     rem05015 #15;
     rem05016 #16;
     rem05017 #17;

     rem00020 #20;
     rem00021 #21;
     rem00100 #100;
     rem00101 #101;

     zregubic;

     tempora0@ #900;
     tempora1@ #901;
     tempora2@ #902;
     tempora3@ #903;
|FIN;

|VARIABLES;
     nVentana        = 0;
     nVentanita      = 0;
     nVent           = 0;
     nSubVent        = 0;
     nPanta          = 0;
     nGrid1          = 0;
     nGrid2          = 0;
     nTree           = 0;
     nEmpresa        = 0;
     nConta          = 0;
     nCampo          = 0;
     nCampo1         = 0;
     nCampoGet       = 0;
     nHandle         = 0;
     nContri         = 0;
     nLinea          = 0;
     nLinea901       = 0;
     nHay            = 0;
     nRango          = 0;
     nLong           = 0;
     nCarac          = 0;
     nPos            = 0;
     nPorce          = 0;
     nDiasHab        = 0;
     nDiasAlq        = 0;
     nError          = 0;
     nSalir          = 0;
     nBotonCancelar  = -1;
     nBoton          = 0;
     nModo           = 0;

     nBoton1_1       = 0;
     nBoton1_2       = 0;
     nBoton1_3       = 0;
     nBoton2_1       = 0;
     nBoton2_2       = 0;
     nBoton2_3       = 0;
     nBoton3_1       = 0;
     nBoton3_2       = 0;
     nBoton3_3       = 0;
     nBoton4_1       = 0;
     nBoton4_2       = 0;
     nBoton4_3       = 0;
     nBoton5_1       = 0;
     nBoton5_2       = 0;
     nBoton5_3       = 0;
     nBoton6_1       = 0;
     nBoton6_2       = 0;
     nBoton6_3       = 0;

     aAlfa           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aFichero        = "";
     aAbre           = "";
     aBase           = "";
     aMas            = "";
     aDef            = "";
     aDirLocal       = "";
     aDirServidor    = "";
     aOrigen         = "";
     aDestino        = "";
     aPathExplorador = "";
     aForzExplorador = "";
     aIPRemoto       = "";
     aCR             = "";
     aLF             = "";
     aCadena         = "";
     aContri         = "";
     aClave          = "";
     aEsc1           = "";
     aEsc2           = "";
     aRetu           = "";
     aTecla          = "";
     aRuta           = "";
     aLong           = "";
     aCaracter       = "";
     aNombreFic      = "";
     aNombreRea      = "";
     aVerde          = "0,0,0;81,222,62";
     aNegro          = "0,0,0;0,0,0";
     aRojo           = "0,0,0;192,0,0";
     aQueBoton       = "";
     aID             = "";

  {1}aContiene       = "";

 {-1}aGet            = 0;
     aGet1           = 0;
     aGet2           = 0;

 {-1}aVent           = "";
     aVent1          = 0;
     aVent2          = 0;
     aVent3          = 0;
     aVent4          = 0;
     aVent5          = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     &eaUnidadBasico = "";
|FIN;

|INCLUYE i_sepnom;

|| -----------------------------------------------------------------------

|PROCESO Salir;
     |PTEC 806;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |SI nBotonCancelar = 0;  |ACABA;  |FINSI;

     aQueBoton = "|X000";
     aID       = #0#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     aQueBoton = "|X001";
     aID       = #0#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", 2585, 2594, Salir;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Configurar explorador web", 2502, 2525, BotonExplora;
|FPRC;

|| -----------------------------------------------------------------------


|PROCESO BuscaLinea901;
     #901#0    = #900#0;
     #901#1    = #900#1;
     |PARA nLinea901 = 1;  |SI nLinea901 [ 99;  |HACIENDO nLinea901 = nLinea901 + 1;
           #901#2 = nLinea901;
           |LEE 000#901=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO PasaRegistroRT;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";
     #902#5  = #900#8;
     #902#6  = #900#11;
     #902#7  = #900#10;
     #902#9  = #900#12;
     #902#10 = #900#13;
     #902#11 = #900#14;
     #902#12 = #902#9 + #902#10 - #902#11;
     |SI #902#12 < 0;  #902#12 = 0;  |FINSI;
     #902#19 = #900#15;

     |SI #900#16 ! 0;
         #902#28 = #900#16;
         #902#27 = -1;
         #902#17 = -1;
         #902#18 = #900#16;
     |FINSI;

     #902#12 = #902#9  + #902#10 - #902#11;

     #902#23 = #902#19 + #902#20 + #902#21 + #902#22;
     #902#24 = #902#7  + #902#12 + #902#34 + #902#16 + #902#28 - #902#18 - #902#23;
     #902#36 = 0;

     |SI #902#35 = "S";
         #902#36 = #902#24 % 65;
     |FINSI;

     #902#37 = #902#24 - #902#36;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#7  = #900#7;
     #901#8  = #900#8;
     #901#9  = #900#9;
     #901#10 = #900#10;
     #901#11 = #900#11;
     #901#12 = #900#12;
     #901#13 = #900#13;
     #901#14 = #900#14;
     #901#15 = #900#15;
     #901#16 = #900#16;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRC;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";
     #902#15 = #900#11;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#7  = "";
     #901#8  = "Dato desconocido";
     #901#9  = "";
     #901#10 = 0;
     #901#11 = #902#15;
     #901#12 = 0;
     #901#13 = 0;
     #901#14 = 0;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroCB;
     aDef = aBase + "def/rem00023.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";

     #902#11 = "E1";
     #902#17 = #900#8;
     #902#18 = #900#9;
     #902#19 = "I";
     #902#20 = #900#12 + #900#14;
     #902#22 = #900#13 + #900#15;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#8  = #902#17;
     aAlfa   = #902#18;  |QBF aAlfa;
     aAlfa   = aAlfa % -110;
     #901#9  = aAlfa;
     #901#12 = #902#20;
     #901#13 = #902#22;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRE;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";

     |SI #900#5 = "rem00022";
         #902#11 = "G2";
         #902#17 = #900#8;
         #902#19 = #900#13;
         #902#22 = #900#13;
         #902#24 = #900#14;
         #902#27 = #900#15;
     |FINSI;

     |SI #900#5 = "rem00023";
         #902#11 = "F2";
         #902#17 = #900#8;
         #902#20 = #900#13;
         #902#22 = #900#14;
         #902#23 = #900#15;

         |SI #900#16 = "B01";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "B02";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "B03";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "B04";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "B05";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "B06";  #902#19 = "I";  |FINSI;
         |SI #900#16 = "C01";  #902#19 = "3";  |FINSI;
         |SI #900#16 = "C02";  #902#19 = "2";  |FINSI;
         |SI #900#16 = "C03";  #902#19 = "2";  |FINSI;
         |SI #900#16 = "C04";  #902#19 = "1";  |FINSI;
         |SI #900#16 = "C06";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "C07";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "C12";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D01";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D02";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D03";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D04";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D05";  #902#19 = "O";  |FINSI;
         |SI #900#16 = "D06";  #902#19 = "O";  |FINSI;
     |FINSI;

     |SI #900#5 = "rem00051";
         #902#17 = #900#8;
         #902#18 = "S";
         #902#19 = "V";
         #902#25 = -1;
         #902#26 = #900#13;
         #902#29 = #900#14;
     |FINSI;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;

     |SI #900#5 = "rem00022";
         #901#8  = #902#17;
         #901#11 = "Base imponible ahorro: dividendos       ";
         #901#13 = #902#19;
         #901#14 = #902#24;
         #901#15 = #902#27;
     |FINSI;

     |SI #900#5 = "rem00023";
         #901#8  = #902#17;
         |SI #902#19 = "I";  #901#11 = "Intereses  cuentas, depositos y activo";    |FINSI;
         |SI #902#19 = "B";  #901#11 = "Intereses activos derecho a bonificacion";  |FINSI;
         |SI #902#19 = "C";  #901#11 = "Rdtos transmision, amortizacion o reemb.";  |FINSI;
         |SI #902#19 = "5";  #901#11 = "Rdtos causa de imposicion de capitales  ";  |FINSI;
         |SI #902#19 = "O";  #901#11 = "Otros rdtos de capital mobiliario       ";  |FINSI;
         |SI #902#19 = "F";  #901#11 = "Intereses activos financieros c/bonif.  ";  |FINSI;
         |SI #902#19 = "1";  #901#11 = "Rdtos arrendamientos, negocios o minas  ";  |FINSI;
         |SI #902#19 = "2";  #901#11 = "Rdtos prestacion de asistencia tecnica  ";  |FINSI;
         |SI #902#19 = "3";  #901#11 = "Rdtos de la propiedad intelectual       ";  |FINSI;
         |SI #902#19 = "4";  #901#11 = "Rdtos de la propiedad industrial        ";  |FINSI;
         #901#13 = #902#20;
         #901#14 = #902#22;
         #901#15 = #902#23;
     |FINSI;

     |SI #900#5 = "rem00051";
         #901#8  = #902#17;
         #901#11 = "Rentas temporales o vitalicias";
         #901#13 = #902#26;
         #901#14 = #902#29;
     |FINSI;

     #901#13 = #902#22;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroSG;
     aDef = aBase + "def/rem00024.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";

     |SI #900#12 ! 0;
         #902#13 = "S";
     |FINSI;

     #902#15 = #900#8;
     #902#17 = #900#10;
     #902#18 = #900#10;
     #902#24 = #900#12;
     #902#20 = #900#11;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#8  = #902#15;
     #901#10 = #902#17;
     #901#11 = #902#20;
     #901#12 = #902#24;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO ChequeaInmueble;
     nError = 0;

     |ABRE #21;
     |SELECT #3#21;
     #21#0  = #900#0;
     #21#14 = #900#7;
     |LEE 000#21=;
     |SI FSalida ! 0;  |DDEFECTO #21;  |FINSI;
     |CIERRA #21;

     aAlfa1 = #21#14;   |QBF aAlfa1;
     aAlfa2 = #900#7;   |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;
         |ACABA;
     |FINSI;

     |SI #21#2 = "GANANCIAL ";
         |MENAV "0000No puedo trasladar el registro. Ese inmueble est  en la renta como ganancial";
         nError = 1;
     |FINSI;

     |SI #21#2 = "VARIOS    ";
         |SI #900#21 = 100;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "TITULAR";  |Y #21#5 ! #900#21;  |Y #21#5 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "CONYUGE";  |Y #21#6 ! #900#21; |Y #21#6 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "1 FAMILIAR";  |Y #21#7 ! #900#21;  |Y #21#7 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "2 FAMILIAR";  |Y #21#8 ! #900#21;  |Y #21#8 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "3 FAMILIAR";  |Y #21#9 ! #900#21;  |Y #21#9 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "4 FAMILIAR";  |Y #21#10 ! #900#21;  |Y #21#10 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #21#2 = "TITULAR   "; |O #21#2 = "CONYUGE   ";
         |MENAV "0000No puedo trasladar el registro. Este inmueble ya existe.";
         nError = 1;
         |ACABA;
     |FINSI;

     |SI #21#3 = "X";
         |MENAV "0000El registro ya existe en la renta. Pero no est  activo. Act¡velo o b¢rrelo";
         nError = 1;
         |ACABA;
     |FINSI;

     nLinea = #21#1;
|FPRC;

|PROCESO PasaRegistroUR;
     aAlfa  = #900#7;  |QBF aAlfa;
     nLinea = 0;

     |SI aAlfa ! "";
         |HAZ ChequeaInmueble;
         |SI nError = 1;  nLinea = 0;  |ACABA;  |FINSI;
     |FINSI;

     aDef = aBase + "def/rem00021.mas";
     |CARGA_DEF aDef, tempora2@;

     |ABRE #902;
     |SI nLinea = 0;
         nLinea = 1;

         #902#0 = #0#0;
         |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
               #902#1 = nLinea;
               |LEE 000#902=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |FINSI;

     #902#0  = #0#0;
     #902#1  = nLinea;
     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0  = #0#0;
         #902#1  = nLinea;
         |GRABA 020#902b;
     |FINSI;

     |SI #900#21 = 100;
         #902#2  = aContri;
     |SINO;
         #902#2  = "VARIOS";
         |SI aContri = "TITULAR";     #902#5  = #900#21;  |FINSI;
         |SI aContri = "CONYUGE";     #902#6  = #900#21;  |FINSI;
         |SI aContri = "1 FAMILIAR";  #902#7  = #900#21;  |FINSI;
         |SI aContri = "2 FAMILIAR";  #902#8  = #900#21;  |FINSI;
         |SI aContri = "3 FAMILIAR";  #902#9  = #900#21;  |FINSI;
         |SI aContri = "4 FAMILIAR";  #902#10 = #900#21;  |FINSI;
     |FINSI;

     #902#3   = "R";
     #902#13  = #900#8;
                           #902#125 = 1;
     |SI #900#25 = "2";    #902#125 = 2;  |FINSI;

     #902#14  = #900#7;

     |SI #900#19 = "PR";  #902#104 = "P";  |FINSI;
     |SI #900#19 = "US";  #902#104 = "U";  |FINSI;
     |SI #900#19 = "NP";  #902#104 = "N";  |FINSI;
     |SI #900#19 = "DF";  #902#104 = "M";  |FINSI;

     aAlfa = #900#9 % 102;  #902#105 = aAlfa;
     aAlfa = #900#9 % 303;  #902#106 = aAlfa;

     #902#17 = #900#18;
     #902#18 = "O";

     |SI #900#13 = "A";  #902#18 = "U";  |FINSI;
     |SI #900#13 = "V";  #902#18 = "U";  |FINSI;
     |SI #900#13 = "I";  #902#18 = "L";  |FINSI;
     |SI #900#13 = "O";  #902#18 = "L";  |FINSI;
     |SI #900#13 = "C";  #902#18 = "L";  |FINSI;
     |SI #900#13 = "M";  #902#18 = "S";  |FINSI;
     |SI #900#13 = "K";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "T";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "G";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "Y";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "E";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "R";  #902#18 = "O";  |FINSI;
     |SI #900#13 = "M";  #902#18 = "S";  |FINSI;
     |SI #900#13 = "P";  #902#18 = "U";  |FINSI;
     |SI #900#13 = "B";  #902#18 = "L";  |FINSI;
     |SI #900#13 = "J";  #902#18 = "L";  |FINSI;
     |SI #900#13 = "Z";  #902#18 = "L";  |FINSI;

     #902#15 = #900#17;

     |SI #900#23 = "H";
         #902#30 = #900#22;
         #902#141 = "";
     |FINSI;

     |SI #900#23 = "A";
         #902#31  = #900#22;
         #902#141 = "1";
     |FINSI;

     |SI #900#23 = "O";
         #902#32  = #900#22;
         #902#141 = "2";
     |FINSI;

     |SI #900#23 = "C";
         |MENAV "0000Inmueble con d¡as en habitual y en alquiler. A continuaci¢n introduzca los d¡as que ha estado en habitual";

         |VENTANA 0501, 0715, -1, 16, "D¡as en habitual";
         nVentanita  = FSalida;
         |PARA;  |SI;  |HACIENDO;
              E_inf    = 1;
              E_sup    = 365;
              nDiasHab = 0607 ? 1;
              |SI nDiasHab < #900#22; |Y nDiasHab ! 0; |SAL;  |FINSI;
              |MENAV "0000Los d¡as deben ser menor a los d¡as informados en el borrador";

         |SIGUE;
         |FINVENTANA nVentanita;

         #902#30  = nDiasHab;
         #902#31  = #900#22 - nDiasHab;
         #902#141 = "3";
     |FINSI;

     |GRABA 020#902a;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;

     #901#7  = #902#14;
     #901#8  = #902#13;
     aAlfa   = (("00" + #902#105) % -102) + (("000" + #902#106) % -103);
     #901#9  = aAlfa;

     |SI #902#18 = "R";  |O #902#18 = "T";
         #901#11 = "RU";
         #901#12 = "R£stica";
     |SINO;
         #901#11 = "UR";
         #901#12 = "Urbana";
     |FINSI;

     #901#13 = " ";
     #901#14 = "No existe el dato";
     #901#15 = "  ";
     #901#16 = "No existe el dato";
     #901#17 = #902#15;
     #901#18 = #902#17;

     |SI #902#104 = "P";
         #901#19 = "PR";
         #901#20 = "Propietario";
     |FINSI;

     |SI #902#104 = "U";
         #901#19 = "US";
         #901#20 = "Usufructuario";
     |FINSI;

     |SI #902#104 = "N";
         #901#19 = "NP";
         #901#20 = "Nuda propiedad";
     |FINSI;

     |SI #902#104 = "M";
         #901#19 = "DF";
         #901#20 = "Disfrutador";
     |FINSI;

     nPorce = 100;

     |SI #902#2 = "GANANCIAL ";  nPorce = 50;  |FINSI;

     |SI #902#2 = "VARIOS    ";
         |SI aContri = "TITULAR";     nPorce = #902#5;  |FINSI;
         |SI aContri = "CONYUGE";     nPorce = #902#6;  |FINSI;
         |SI aContri = "1 FAMILIAR";  nPorce = #902#7;  |FINSI;
         |SI aContri = "2 FAMILIAR";  nPorce = #902#8;  |FINSI;
         |SI aContri = "3 FAMILIAR";  nPorce = #902#9;  |FINSI;
         |SI aContri = "4 FAMILIAR";  nPorce = #902#10; |FINSI;
     |FINSI;

     #901#21 = nPorce;

     #901#22 = #902#30 + #902#31 + #902#32 + #902#33 + #902#34 + #902#35;

     nDiasHab = #902#30 + #902#33;
     nDiasAlq = #902#31 + #902#34;

     #901#23 = "O";
     #901#24 = "Otros";

     |SI nDiasHab ! 0;  |Y nDiasAlq = 0;
         #901#23 = "H";
         #901#24 = "Vivienda habitual";
     |FINSI;

     |SI nDiasHab = 0;  |Y nDiasAlq ! 0;
         #901#23 = "A";
         #901#24 = "Arrendada";
     |FINSI;

     |SI nDiasHab ! 0;  |Y nDiasAlq ! 0;
         #901#23 = "C";
         #901#24 = "Habitual y Arrendada";
     |FINSI;

     #901#25 = "1";
     #901#26 = "Inmuebles en territorio com£n";

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroPF;
     |SI #900#12 = 0;
         |MENAV "0000El resultado es cero. No se traslada el registro.";
         |ACABA;
     |FINSI;

     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";

     aAlfa   = #900#9;  |QBF aAlfa;

     |SI aAlfa = "01";  #902#11 = #900#12;  |FINSI;
     |SI aAlfa = "02";  #902#11 = #900#12;  |FINSI;
     |SI aAlfa = "03";  #902#11 = #900#12;  |FINSI;
     |SI aAlfa = "04";  #902#12 = #900#12;  |FINSI;
     |SI aAlfa = "05";  #902#12 = #900#12;  |FINSI;
     |SI aAlfa = "06";  #902#12 = #900#12;  |FINSI;
     |SI aAlfa = "07";  #902#13 = #900#12;  |FINSI;
     |SI aAlfa = "08";  #902#13 = #900#12;  |FINSI;
     |SI aAlfa = "09";  #902#13 = #900#12;  |FINSI;
     |SI aAlfa = "10";  #902#14 = #900#12;  |FINSI;
     |SI aAlfa = "11";  #902#14 = #900#12;  |FINSI;
     |SI aAlfa = "12";  #902#14 = #900#12;  |FINSI;
     |SI aAlfa = "1T";  #902#11 = #900#12;  |FINSI;
     |SI aAlfa = "2T";  #902#12 = #900#12;  |FINSI;
     |SI aAlfa = "3T";  #902#13 = #900#12;  |FINSI;
     |SI aAlfa = "4T";  #902#14 = #900#12;  |FINSI;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#7  = "";
     #901#8  = "Dato desconocido";

     aAlfa   = "";
     |SI #902#11 ! 0; aAlfa = aAlfa + "1P ";  |FINSI;
     |SI #902#12 ! 0; aAlfa = aAlfa + "2P ";  |FINSI;
     |SI #902#13 ! 0; aAlfa = aAlfa + "3P ";  |FINSI;
     |SI #902#14 ! 0; aAlfa = aAlfa + "4P ";  |FINSI;
     #901#9  = aAlfa;
     #901#10 = "";
     #901#11 = "";
     #901#12 = #902#11 + #902#12 + #902#13 + #902#14;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroDN;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";

     |SI #900#15 = 15;  #902#11 = 1;  |FINSI;
     |SI #900#15 = 30;  #902#11 = 2;  |FINSI;
     |SI #900#15 = 25;  #902#11 = 3;  |FINSI;
     |SI #900#15 = 10;  #902#11 = 4;  |FINSI;

     #902#12 = #900#8;
     #902#13 = #900#13;
     #902#14 = #900#15;
     #902#15 = #900#13 % #902#14;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#8  = #902#12;
     #901#9  = "";
     #901#10 = "Donativo";
     #901#13 = #902#13;
     #901#15 = #902#14;
     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroDM;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";
     #902#11 = 18;
     #902#12 = "Datos ficales borrador";
     #902#14 = #900#9;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;
     #901#7  = "";
     #901#8  = 0;
     #901#9  = #902#14;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaAlTrabajo;
     |ABRE #20;
     #20#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #20#1 = nLinea;
           |LEE 000#20=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #20;
     #20#0  = #0#0;
     #20#1  = nLinea;
     #20#2  = aContri;
     #20#3  = "R";
     #20#5  = #900#8;
     #20#13 = #902#11;
     #20#16 = #902#15 + #902#18;

     #20#12 = #20#9  + #20#10 - #20#11;
     #20#23 = #20#19 + #20#20 + #20#21 + #20#22;
     #20#24 = #20#7  + #20#12 + #20#34 + #20#16 + #20#28 - #20#18 - #20#23;
     #20#36 = 0;

     |SI #20#35 = "S";
         #20#36 = #20#24 % 65;
     |FINSI;

     #20#37 = #20#24 - #20#36;

     |GRABA 020#20n;
     |LIBERA #20;
     |CIERRA #20;

     #902#21 = "S";
     #902#22 = #20#1;
|FPRC;

|PROCESO PasaRegistroPP;
     aDef = aBase + "def/" + #900#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #902;
     #902#0 = #0#0;
     |PARA nLinea = 1;  |SI nLinea [ 99;  |HACIENDO nLinea = nLinea + 1;
           #902#1 = nLinea;
           |LEE 000#902=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |DDEFECTO #902;
     #902#0  = #0#0;
     #902#1  = nLinea;
     #902#2  = aContri;
     #902#3  = "R";
     #902#24 = "N";

     |SI nLinea = 1;
         #902#24 = "P";
     |FINSI;

     #902#11 = #900#8;
     aAlfa   = #900#13;  |QBF aAlfa;
     |SI aAlfa = "";
         #902#12 = "N";
         #902#15 = #900#12;
         #902#16 = #900#11 - #900#12;
         |SI #902#16 < 0;  #902#16 = 0;  |FINSI;
     |SINO;
         #902#12 = "S";
         #902#13 = "S";
         #902#17 = #900#13;
         #902#18 = #900#12;
         #902#19 = #900#11 - #900#12;
     |FINSI;

     |SI #902#15 ! 0;  |O #902#18 ! 0;
         |HAZ PasaAlTrabajo;
     |FINSI;

     |GRABA 020#902n;
     |LIBERA #902;
     |CIERRA #902;

     |HAZ BuscaLinea901;

     |DDEFECTO #901;

     #901#0  = #900#0;
     #901#1  = #900#1;
     #901#2  = nLinea901;
     #901#3  = aNegro;
     #901#4  = "Activo";
     #901#5  = #900#5;
     #901#6  = nLinea;

     #901#8  = #902#11;
     #901#9  = "Dato desconocido";
     #901#10 = "Dato desconocido";

     |SI #902#12 = "N";
          #901#11 = #902#16;
          #901#12 = #902#15;
     |SINO;
          #901#11 = #902#19;
          #901#12 = #902#18;
          #901#13 = #902#17;
     |FINSI;

     |GRABA 020#901n;
     |LIBERA #901;

     |DESCARGA_DEF #tempora2@;

|FPRC;

|PROCESO PasaRegistro;
     |CONFI "0000NUsted est  pasando el registro a la renta. Est  seguro";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nLinea = 0;
     |SI aClave = "RT"; |HAZ PasaRegistroRT;  |FINSI;
     |SI aClave = "RC"; |HAZ PasaRegistroRC;  |FINSI;
     |SI aClave = "CB"; |HAZ PasaRegistroCB;  |FINSI;
     |SI aClave = "RE"; |HAZ PasaRegistroRE;  |FINSI;
     |SI aClave = "DN"; |HAZ PasaRegistroDN;  |FINSI;
     |SI aClave = "SG"; |HAZ PasaRegistroSG;  |FINSI;
     |SI aClave = "UR"; |HAZ PasaRegistroUR;  |FINSI;
     |SI aClave = "PF"; |HAZ PasaRegistroPF;  |FINSI;
     |SI aClave = "DM"; |HAZ PasaRegistroDM;  |FINSI;
     |SI aClave = "PP"; |HAZ PasaRegistroPP;  |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |LEE 101#900=;

     #900#3 = aVerde;
     #900#4 = "En renta";
     #900#6 = nLinea;
     |GRABA 020#900a;
     |LIBERA #900;

     |REFRESCACONTROL nGrid1;
     |REFRESCACONTROL nGrid2;
|FPRC;

|PROCESO Evento900;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#900=;
     |FINSI;

     |SI FSalida = 4;
         |SI nModo = 4;
             |MENAV "0000Est  en modo consulta. Acci¢n cancelada.";
             |ACABA;
         |FINSI;

         aAlfa = #900#4;  |QBF aAlfa;
         |SI aAlfa = "No trasladable";
             |MENAV "0000Registro no trasladable";
             |ACABA;
         |FINSI;

         |SI aAlfa = "En renta";
             |MENAV "0000El registro est  ya en renta";
             |ACABA;
         |FINSI;

         |HAZ PasaRegistro;
     |FINSI;
|FPRC;

|PROCESO Desanula;
     |CONFI "0000NUsted est  activando el registro. Est  seguro";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = aBase + "def/" + #901#5 + ".mas";

     |CARGA_DEF aDef, tempora2@;

     |ABRE #902;
     #902#0 = #901#0;
     #902#1 = #901#6;
     |LEE 101#902=;
     |SI FSalida = 0;
         #902#3 = "R";
         |GRABA 020#902a;
         |LIBERA #902;
     |FINSI;
     |CIERRA #902;

     |SI aClave = "PP";
         |SI #902#21 = "S";
             |ABRE #20;
             #20#0 = #0#0;
             #20#1 = #902#22;
             |LEE 101#20=;
             |SI FSalida = 0;
                 #20#3 = "R";
                 |GRABA 020#20a;
                 |LIBERA #20;
             |FINSI;
             |CIERRA #20;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #tempora2@;

     |LEE 101#901=;

     #901#3  = aNegro;
     #901#4  = "Activo";
     |GRABA 020#901a;
     |LIBERA #901;

     |REFRESCACONTROL nGrid2;
|FPRC;

|PROCESO Anula;
     |CONFI "0000NUsted est  anulando el registro. Est  seguro";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aDef = aBase + "def/" + #901#5 + ".mas";

     |CARGA_DEF aDef, tempora2@;

     |SI aClave = "RT";  aDef = aBase + "def/rem05001.mas";  |FINSI;
     |SI aClave = "RC";  aDef = aBase + "def/rem05008.mas";  |FINSI;
     |SI aClave = "CB";  aDef = aBase + "def/rem05002.mas";  |FINSI;
     |SI aClave = "RE";  aDef = aBase + "def/rem05003.mas";  |FINSI;
     |SI aClave = "SG";  aDef = aBase + "def/rem05005.mas";  |FINSI;
     |SI aClave = "UR";  aDef = aBase + "def/rem05007.mas";  |FINSI;
     |SI aClave = "PF";  aDef = aBase + "def/rem05009.mas";  |FINSI;
     |SI aClave = "DN";  aDef = aBase + "def/rem05010.mas";  |FINSI;
     |SI aClave = "DM";  aDef = aBase + "def/rem05013.mas";  |FINSI;
     |SI aClave = "PP";  aDef = aBase + "def/rem05014.mas";  |FINSI;

     |CARGA_DEF aDef, tempora3@;

     |ABRE #902;
     #902#0 = #901#0;
     #902#1 = #901#6;
     |LEE 101#902=;

     |LEE 101#901=;

     |ABRE #903;
     |SELECT #2#903;
     #903#0 = #901#0;
     #903#1 = #901#1;
     #903#6 = #901#6;
     |LEE 101#903=;
     |SI FSalida = 0;
         #903#3  = aNegro;
         #903#4  = "Pendiente";
         #903#6  = 0;
         |GRABA 020#903a;
         |LIBERA #903;

         |BORRA 020#901a;
         |LIBERA #901;

         |BORRA 020#902a;
         |LIBERA #902;

         |SI aClave = "PP";
             |SI #902#21 = "S";
                 |ABRE #20;
                 #20#0 = #0#0;
                 #20#1 = #902#22;
                 |LEE 101#20=;
                 |SI FSalida = 0;
                     |BORRA 020#20a;
                     |LIBERA #20;
                 |FINSI;
                 |CIERRA #20;
             |FINSI;
         |FINSI;

         |REFRESCACONTROL nGrid1;
         |REFRESCACONTROL nGrid2;
     |SINO;
         #901#3  = aRojo;
         #901#4  = "Anulado";
         |GRABA 020#901a;
         |LIBERA #901;

         #902#3 = "X";
         |GRABA 020#902a;
         |LIBERA #902;

         |SI aClave = "PP";
             |SI #902#21 = "S";
                 |ABRE #20;
                 #20#0 = #0#0;
                 #20#1 = #902#22;
                 |LEE 101#20=;
                 |SI FSalida = 0;
                     #20#3 = "X";
                     |GRABA 020#20a;
                     |LIBERA #20;
                 |FINSI;
                 |CIERRA #20;
             |FINSI;
         |FINSI;

         |REFRESCACONTROL nGrid2;
     |FINSI;

     |CIERRA #902;
     |CIERRA #903;

     |DESCARGA_DEF #tempora3@;
     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO Evento901;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#901=;
     |FINSI;

     |SI FSalida = 4;
         |SI nModo = 4;
             |MENAV "0000Est  en modo consulta. Acci¢n cancelada.";
             |ACABA;
         |FINSI;

         aAlfa = #901#4;  |QBF aAlfa;
         |SI aAlfa = "Anulado";
             |HAZ Desanula;
         |SINO;
             |HAZ Anula;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja900;
     #900#0 = #0#0;
     #900#1 = nContri;
     #900#2 = 01;
|FPRC;

|PROCESO Alta900;
     #900#0 = #0#0;
     #900#1 = nContri;
     #900#2 = 99;
|FPRC;

|PROCESO CargaInmuebles;
     #901#7  = #902#14;
     #901#8  = #902#13;
     aAlfa   = (("00" + #902#105) % -102) + (("000" + #902#106) % -103);
     #901#9  = aAlfa;

     |SI #902#18 = "R";  |O #902#18 = "T";
         #901#11 = "RU";
         #901#12 = "R£stica";
     |SINO;
         #901#11 = "UR";
         #901#12 = "Urbana";
     |FINSI;

     #901#13 = "  ";
     #901#14 = "No existe el dato";
     #901#15 = "  ";
     #901#16 = "No existe el dato";
     #901#17 = #902#15;
     #901#18 = #902#17;

     |SI #902#104 = "P";
         #901#19 = "PR";
         #901#20 = "Propietario";
     |FINSI;

     |SI #902#104 = "U";
         #901#19 = "US";
         #901#20 = "Usufructuario";
     |FINSI;

     |SI #902#104 = "N";
         #901#19 = "NP";
         #901#20 = "Nuda propiedad";
     |FINSI;

     |SI #902#104 = "M";
         #901#19 = "DF";
         #901#20 = "Disfrutador";
     |FINSI;

     nPorce = 100;

     |SI #902#2 = "GANANCIAL ";  nPorce = 50;  |FINSI;

     |SI #902#2 = "VARIOS    ";
         |SI aContri = "TITULAR";     nPorce = #902#5;  |FINSI;
         |SI aContri = "CONYUGE";     nPorce = #902#6;  |FINSI;
         |SI aContri = "1 FAMILIAR";  nPorce = #902#7;  |FINSI;
         |SI aContri = "2 FAMILIAR";  nPorce = #902#8;  |FINSI;
         |SI aContri = "3 FAMILIAR";  nPorce = #902#9;  |FINSI;
         |SI aContri = "4 FAMILIAR";  nPorce = #902#10; |FINSI;
     |FINSI;

     #901#21 = nPorce;

     #901#22 = #902#30 + #902#31 + #902#32 + #902#33 + #902#34 + #902#35;

     nDiasHab = #902#30 + #902#33;
     nDiasAlq = #902#31 + #902#34;

     #901#23 = "O";
     #901#24 = "Otros";

     |SI nDiasHab ! 0;  |Y nDiasAlq = 0;
         #901#23 = "H";
         #901#24 = "Vivienda habitual";
     |FINSI;

     |SI nDiasHab = 0;  |Y nDiasAlq ! 0;
         #901#23 = "A";
         #901#24 = "Arrendada";
     |FINSI;

     |SI nDiasHab ! 0;  |Y nDiasAlq ! 0;
         #901#23 = "C";
         #901#24 = "Habitual y Arrendada";
     |FINSI;

     #901#25 = "1";
     #901#26 = "Inmuebles en territorio com£n";
|FPRC;

|PROCESO tempora2;
     |SI aClave = "PP";
         |SI #902#23 = "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "DM";
         |SI #902#11 ! 18;  |ACABA;  |FINSI;
     |FINSI;

     |SI #902#2 = "GANANCIAL ";
         |SI aContri ! "TITULAR";   |Y aContri ! "CONYUGE";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI aClave ! "RT";
         |SI #902#2 = "VARIOS    ";
             |SI aContri = "TITULAR";  |Y #902#5 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "CONYUGE";  |Y #902#6 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "1 FAMILIAR";  |Y #902#7 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "2 FAMILIAR";  |Y #902#8 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "3 FAMILIAR";  |Y #902#9 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "4 FAMILIAR";  |Y #902#10 = 0;
                 |ACABA;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI #902#2 = "TITULAR   "; |O #902#2 = "CONYUGE   ";
         aAlfa1 = #902#2;  |QBF aAlfa1;
         |SI aAlfa1 ! aContri;
             |ACABA;
         |FINSI;
     |FINSI;

     nLinea = nLinea + 1;

     |DDEFECTO #901;
     #901#0  = #0#0;
     #901#1  = nContri;
     #901#2  = nLinea;
     #901#3  = aNegro;
     #901#4  = "Activo";
     |SI #902#3 = "X";
         #901#3  = aRojo;
         #901#4 = "Anulado";
     |FINSI;

     #901#6  = #902#1;

     |SI aClave = "RT";
         #901#5  = "rem00020";
         #901#7  = "";
         #901#8  = #902#5;
         #901#9  = "";
         #901#10 = #902#7;
         #901#11 = #902#6;
         #901#12 = #902#9;
         #901#13 = #902#10;
         #901#14 = #902#11;
         #901#15 = #902#19;
         #901#16 = #902#18;
     |FINSI;

     |SI aClave = "RC";
         #901#5  = "rem00031";
         #901#7  = "";
         #901#8  = "Dato desconocido";
         #901#9  = "";
         #901#10 = 0;
         #901#11 = #902#15;
         #901#12 = 0;
         #901#13 = 0;
         #901#14 = 0;
     |FINSI;

     |SI aClave = "CB";
         |SI #902#19 ! "I";  |ACABA;  |FINSI;

         #901#5  = "rem00023";
         #901#8  = #902#17;
         aAlfa   = #902#18;  |QBF aAlfa;
         aAlfa   = aAlfa % -110;
         #901#9  = aAlfa;
         #901#12 = #902#20;
         #901#13 = #902#22;
     |FINSI;

     |SI aClave = "RE";
         aAlfa = aDef % -508;
         #901#5  = aAlfa;

         |SI #901#5 = "rem00022";
             #901#8  = #902#17;
             #901#11 = "Base imponible ahorro: dividendos       ";
             #901#13 = #902#19;
             #901#14 = #902#24;
             #901#15 = #902#27;
         |FINSI;

         |SI #901#5 = "rem00023";
             #901#8  = #902#17;
             |SI #902#19 = "I";  #901#11 = "Intereses  cuentas, depositos y activo";    |FINSI;
             |SI #902#19 = "B";  #901#11 = "Intereses activos derecho a bonificacion";  |FINSI;
             |SI #902#19 = "C";  #901#11 = "Rdtos transmision, amortizacion o reemb.";  |FINSI;
             |SI #902#19 = "5";  #901#11 = "Rdtos causa de imposicion de capitales  ";  |FINSI;
             |SI #902#19 = "O";  #901#11 = "Otros rdtos de capital mobiliario       ";  |FINSI;
             |SI #902#19 = "F";  #901#11 = "Intereses activos financieros c/bonif.  ";  |FINSI;
             |SI #902#19 = "1";  #901#11 = "Rdtos arrendamientos, negocios o minas  ";  |FINSI;
             |SI #902#19 = "2";  #901#11 = "Rdtos prestacion de asistencia tecnica  ";  |FINSI;
             |SI #902#19 = "3";  #901#11 = "Rdtos de la propiedad intelectual       ";  |FINSI;
             |SI #902#19 = "4";  #901#11 = "Rdtos de la propiedad industrial        ";  |FINSI;
             #901#13 = #902#20;
             #901#14 = #902#22;
             #901#15 = #902#23;
         |FINSI;

         |SI #901#5 = "rem00051";
             #901#8  = #902#17;
             #901#11 = "Rentas temporales o vitalicias";
             #901#13 = #902#26;
             #901#14 = #902#29;
         |FINSI;
     |FINSI;

     |SI aClave = "SG";
         #901#8  = #902#15;
         #901#10 = #902#17;
         #901#11 = #902#20;
         #901#12 = #902#24;
     |FINSI;

     |SI aClave = "UR";
         |HAZ CargaInmuebles;
     |FINSI;

     |SI aClave = "PF";
         #901#5  = "rem00031";
         #901#7  = "";
         #901#8  = "Dato desconocido";
         aAlfa   = "";
         |SI #902#11 ! 0; aAlfa = aAlfa + "1P ";  |FINSI;
         |SI #902#12 ! 0; aAlfa = aAlfa + "2P ";  |FINSI;
         |SI #902#13 ! 0; aAlfa = aAlfa + "3P ";  |FINSI;
         |SI #902#14 ! 0; aAlfa = aAlfa + "4P ";  |FINSI;
         #901#9  = aAlfa;
         #901#10 = "";
         #901#11 = "";
         #901#12 = #902#11 + #902#12 + #902#13 + #902#14;
     |FINSI;

     |SI aClave = "DN";
         #901#5  = "rem00046";
         #901#8  = #902#12;
         #901#9  = "";
         #901#10 = "Donativo";
         #901#13 = #902#13;
         #901#15 = #902#14;
     |FINSI;

     |SI aClave = "DM";
         #901#5  = "rem00056";
         #901#9  = #902#14;
     |FINSI;

     |SI aClave = "PP";
         #901#5  = "rem00053";
         #901#8  = #902#11;
         #901#9  = "Dato desconocido";
         #901#10 = "Dato desconocido";

         |SI #902#12 = "N";
             #901#11 = #902#16;
             #901#12 = #902#15;
         |SINO;
             #901#11 = #902#19;
             #901#12 = #902#18;
             #901#13 = #902#17;
         |FINSI;
     |FINSI;

     |GRABA 020#901n;
     |LIBERA #901;
|FPRC;

|DEFBUCLE tempora2;
     #902#1002;
     ;
     nEmpresa, 01;
     nEmpresa, 99;
     ;
     NULL, tempora2;
|FIN;

|PROCESO DatosDiagram;
     aDef = "";

     |SI aClave = "RT";  aDef = aBase + "def/rem00020.mas";  |FINSI;
     |SI aClave = "CB";  aDef = aBase + "def/rem00023.mas";  |FINSI;
     |SI aClave = "RE";  aDef = aBase + "def/rem00023.mas";  |FINSI;
     |SI aClave = "SG";  aDef = aBase + "def/rem00024.mas";  |FINSI;
     |SI aClave = "UR";  aDef = aBase + "def/rem00021.mas";  |FINSI;
     |SI aClave = "RC";  aDef = aBase + "def/rem00031.mas";  |FINSI;
     |SI aClave = "PF";  aDef = aBase + "def/rem00031.mas";  |FINSI;
     |SI aClave = "DN";  aDef = aBase + "def/rem00046.mas";  |FINSI;
     |SI aClave = "DM";  aDef = aBase + "def/rem00056.mas";  |FINSI;
     |SI aClave = "PP";  aDef = aBase + "def/rem00053.mas";  |FINSI;

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     nLinea = 0;
     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;

     aDef = "";
     |SI aClave = "RE";  aDef = aBase + "def/rem00022.mas";  |FINSI;

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;

     aDef = "";
     |SI aClave = "RE";  aDef = aBase + "def/rem00051.mas";  |FINSI;

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO Trasladables;
     |VENTANA 0501, 2799, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aDef = aBase + "def/" + aMas;
     |CARGA_DEF aDef, tempora0@;
     |CARGA_DEF aDef, tempora1@;

     aFichero = ("51" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #901 aFichero;
     |ABRE #901;  |CIERRA #901;  |DELINDEX #901;

     |ABRE #900;
     |ABRE #901;

     |HAZ DatosDiagram;

     |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos del borrador. (Doble click en la l¡nea para incorporar los datos a la renta)", 0502, 0598, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos Renta 2009. (Doble click en la l¡nea para activar o anular los datos en la renta)", 1602, 1698, NULL;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#900, nRango, 0601, 1499, Baja900, Alta900, Evento900;
     nGrid1 = FSalida;

     |LINEAL_SIMPLE #1#901, nRango, 1701, 2699, NULL, NULL, Evento901;
     nGrid2 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #900;
     |CIERRA #901;  |DELINDEX #901;

     |DESCARGA_DEF #tempora1@;
     |DESCARGA_DEF #tempora0@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;

|PROCESO NoTrasladables;
     |VENTANA 0501, 2799, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aDef = aBase + "def/" + aMas;
     |CARGA_DEF aDef, tempora0@;

     |ABRE #900;

     |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos del borrador. (Registros NO TRASDABLE)", 0502, 0598, NULL;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#900, nRango, 0601, 2699, Baja900, Alta900, NULL;
     nGrid1 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #900;

     |DESCARGA_DEF #tempora0@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;

|PROCESO PantaDatos;
     aMas = "";

     |SI aClave = "AR";
         aAlfa = "Arrendamientos de inmuebles";
         aMas  = "rem05011.mas";
     |FINSI;

     |SI aClave = "CB";
         aAlfa = "Cuentas bancarias";
         aMas  = "rem05002.mas";
     |FINSI;

     |SI aClave = "CT";
         aAlfa = "Cotizaciones a reg¡menes especiales de la seguridad social y convenios especiales";
         aMas  = "rem05006.mas";
     |FINSI;

     |SI aClave = "DM";
         aAlfa = "Deducciones por maternidad";
         aMas  = "rem05013.mas";
     |FINSI;

     |SI aClave = "DN";
         aAlfa = "Donaciones y aportaciones a patrimonio de persona con discapacidad";
         aMas  = "rem05010.mas";
     |FINSI;

     |SI aClave = "PF";
         aAlfa = "Pagos fraccionados de empresas y profesionales";
         aMas  = "rem05009.mas";
     |FINSI;

     |SI aClave = "PH";
         aAlfa = "Pr‚stamos y cr‚ditos relacionados con bienes inmuebles";
         aMas  = "rem05012.mas";
     |FINSI;

     |SI aClave = "PP";
         aAlfa = "Aportaciones y contribuciones a sistema de previsi¢n social";
         aMas  = "rem05014.mas";
     |FINSI;

     |SI aClave = "RE";
         aAlfa = "Rendimientos expl¡citos del capital mobiliario";
         aMas  = "rem05003.mas";
     |FINSI;

     |SI aClave = "RT";
         aAlfa = "Rendimientos del trabajo";
         aMas  = "rem05001.mas";
     |FINSI;

     |SI aClave = "RC";
         aAlfa = "Actividades econ¢micas";
         aMas  = "rem05008.mas";
     |FINSI;

     |SI aClave = "SG";
         aAlfa = "Rendimientos de operaciones de seguros";
         aMas  = "rem05005.mas";
     |FINSI;

     |SI aClave = "UR";
         aAlfa = "Informaci¢n catastral de inmuebles";
         aMas  = "rem05007.mas";
     |FINSI;

     |SI aClave = "TV";
         aAlfa = "Ventas de activos financieros y otros valores mobiliarios";
         aMas  = "rem05004.mas";
     |FINSI;

     |SI aClave = "IP";
         aAlfa = "Otras subvenciones,auxilios y ayudas satisfechos por las administraciones p£blicas";
         aMas  = "rem05015.mas";
     |FINSI;

     |SI aClave = "AG";
         aAlfa = "Subvenciones e indemnizaciones satisfechas a agricultores, ganaderos o forestales";
         aMas  = "rem05016.mas";
     |FINSI;

     |SI aClave = "FI";
         aAlfa = "Ventas de fondos de inversi¢n con retenci¢n";
         aMas  = "rem05017.mas";
     |FINSI;

     |SI aMas = "";  |ACABA;  |FINSI;

     |SI aMas = "rem05001.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05002.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05003.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05004.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05005.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05006.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05007.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05008.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05009.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05010.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05011.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05012.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05013.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05014.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05015.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05016.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05017.mas";  |HAZ NoTrasladables;  |FINSI;
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;  |ACABA;  |FINSI;

     aClave = Contenido;  |QBF aClave;
     |SI aClave = "";  |ACABA;  |FINSI;

     |ESTADO_CONTROL nTree, "DISABLE";

     |HAZ PantaDatos;

     |ESTADO_CONTROL nTree, "ENABLE";
     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Procesar;
     aFichero = "men" + (("00000" + #0#0) % -105) + ".txt";
     aAbre    = aDirServidor + aFichero;
     |XABRE "WB", aAbre, nHandle;

     nConta = 0;
     aMas   = "rem05001.mas";  aClave = "RT";  |HAZ BuscaRegistro;
     aMas   = "rem05008.mas";  aClave = "RC";  |HAZ BuscaRegistro;
     aMas   = "rem05015.mas";  aClave = "IP";  |HAZ BuscaRegistro;
     aMas   = "rem05014.mas";  aClave = "PP";  |HAZ BuscaRegistro;
     aMas   = "rem05016.mas";  aClave = "AG";  |HAZ BuscaRegistro;
     aMas   = "rem05002.mas";  aClave = "CB";  |HAZ BuscaRegistro;
     aMas   = "rem05017.mas";  aClave = "FI";  |HAZ BuscaRegistro;
     aMas   = "rem05012.mas";  aClave = "PH";  |HAZ BuscaRegistro;
     aMas   = "rem05009.mas";  aClave = "PF";  |HAZ BuscaRegistro;
     aMas   = "rem05004.mas";  aClave = "TV";  |HAZ BuscaRegistro;
     aMas   = "rem05003.mas";  aClave = "RE";  |HAZ BuscaRegistro;
     aMas   = "rem05005.mas";  aClave = "SG";  |HAZ BuscaRegistro;
     aMas   = "rem05011.mas";  aClave = "AR";  |HAZ BuscaRegistro;
     aMas   = "rem05010.mas";  aClave = "DN";  |HAZ BuscaRegistro;
     aMas   = "rem05006.mas";  aClave = "CT";  |HAZ BuscaRegistro;
     aMas   = "rem05007.mas";  aClave = "UR";  |HAZ BuscaRegistro;
     aMas   = "rem05013.mas";  aClave = "DM";  |HAZ BuscaRegistro;

     |XCIERRA nHandle;

     aAlfa =  "Datos fiscales del " + aContri;
     |VENTANA 0510, 2187, -1, 16, aAlfa;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aOrigen  = aAbre;
     aDestino = aDirLocal + aFichero;
     |HAZ CopiaFichero;

     |FBORRA aOrigen;

     |PTEC 802;  |PAUSA;

     aAlfa    = "TREECTRL,Datos fiscales {{" + aDestino + "}}";

     |CONTROL_SIMPLE 0, aAlfa, 0510, 1987, EventoTree;
     nTree    = FSalida;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";
     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1     = &255 + "806";
     aEsc2     = &255 + "807";
     aRetu     = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + nTree;
         |LEETECLA aTecla;

         |PULSATECLA;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;

         |FOCOTECLADO nTree;
     |SIGUE;

     aAlfa = aDirLocal + aFichero;  |RFBORRA aAlfa;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;

|PROCESO ClaveRT;
     nLinea = 1;

     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = nContri;
     #1#2 = 99;
     |LEE 000#1];
     |SI FSalida = 0;
         |LEE 000#1a;
     |SINO;
         |LEE 000#1u;
     |FINSI;

     |SI FSalida = 0;  |Y #1#0 = #0#0; |Y #1#1 = nContri;
         nLinea = #1#2 + 1;
     |FINSI;

     |DDEFECTO #1;
     #1#0   = #0#0;
     #1#1   = nContri;
     #1#2   = nLinea;
     #1#3   = aNegro;
     #1#4   = "Pendiente";
     #1#5   = "rem00020";
     #1#6   = 0;
     #1#7   = aCadena % 0909;
     #1#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = "A";  #1#9 = "Empleados";             |FINSI;
     |SI aAlfa1 = "B";  #1#9 = "Pensionistas";          |FINSI;
     |SI aAlfa1 = "C";  #1#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI aAlfa1 = "D";  #1#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI aAlfa1 = "E";  #1#9 = "Consej.y adminstrad.";  |FINSI;
     |SI aAlfa1 = "F";  #1#9 = "Cursos, conferencias";  |FINSI;
     |SI aAlfa1 = "L";  #1#9 = "Rentas exentas";        |FINSI;

     aAlfa1 = aCadena % 6013;   #1#10 = aAlfa1;  #1#10 = #1#10 / 100;
     aAlfa1 = aCadena % 7313;   #1#11 = aAlfa1;  #1#11 = #1#11 / 100;
     aAlfa1 = aCadena % 8613;   #1#12 = aAlfa1;  #1#12 = #1#12 / 100;
     aAlfa1 = aCadena % 9913;   #1#13 = aAlfa1;  #1#13 = #1#13 / 100;
     aAlfa1 = aCadena % 11213;  #1#14 = aAlfa1;  #1#14 = #1#14 / 100;
     aAlfa1 = aCadena % 12513;  #1#15 = aAlfa1;  #1#15 = #1#15 / 100;
     aAlfa1 = aCadena % 13813;  #1#16 = aAlfa1;  #1#16 = #1#16 / 100;

     |GRABA 020#1n;
     |LIBERA #1;
     |CIERRA #1;
|FPRC;

|PROCESO ClaveRC;
     nLinea = 1;

     |ABRE #8;
     #8#0 = #0#0;
     #8#1 = nContri;
     #8#2 = 99;
     |LEE 000#8];
     |SI FSalida = 0;
         |LEE 000#8a;
     |SINO;
         |LEE 000#8u;
     |FINSI;

     |SI FSalida = 0;  |Y #8#0 = #0#0; |Y #8#1 = nContri;
         nLinea = #8#2 + 1;
     |FINSI;

     |DDEFECTO #8;
     #8#0   = #0#0;
     #8#1   = nContri;
     #8#2   = nLinea;
     #8#3   = aNegro;
     #8#4   = "Pendiente";
     #8#5   = "rem00031";
     #8#6   = 0;
     #8#7   = aCadena % 0909;
     #8#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = "G";  #8#9 = "Profesionales";         |FINSI;
     |SI aAlfa1 = "H";  #8#9 = "Agr¡colas";             |FINSI;
     |SI aAlfa1 = "I";  #8#9 = "Art¡culo 70.2";         |FINSI;
     |SI aAlfa1 = "J";  #8#9 = "Derechos imagen";       |FINSI;

     aAlfa1 = aCadena % 6013;   #8#10 = aAlfa1;  #8#10 = #8#10 / 100;
     aAlfa1 = aCadena % 7313;   #8#11 = aAlfa1;  #8#11 = #8#11 / 100;
     aAlfa1 = aCadena % 8613;   #8#12 = aAlfa1;  #8#12 = #8#12 / 100;
     aAlfa1 = aCadena % 9913;   #8#13 = aAlfa1;  #8#13 = #8#13 / 100;
     aAlfa1 = aCadena % 11213;  #8#14 = aAlfa1;  #8#14 = #8#14 / 100;

     |GRABA 020#8n;
     |LIBERA #8;
     |CIERRA #8;
|FPRC;

|PROCESO ClaveCB;
     nLinea = 1;

     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = nContri;
     #2#2 = 99;
     |LEE 000#2];
     |SI FSalida = 0;
         |LEE 000#2a;
     |SINO;
         |LEE 000#2u;
     |FINSI;

     |SI FSalida = 0;  |Y #2#0 = #0#0; |Y #2#1 = nContri;
         nLinea = #2#2 + 1;
     |FINSI;

     |DDEFECTO #2;
     #2#0   = #0#0;
     #2#1   = nContri;
     #2#2   = nLinea;
     #2#3   = aNegro;
     #2#4   = "Pendiente";
     #2#5   = "rem00023";
     #2#6   = 0;
     #2#7   = aCadena % 0909;
     #2#8   = aCadena % 1840;
     #2#9   = aCadena % 5810;

     aAlfa1 = aCadena % 6801;
     |SI aAlfa1 = "1";  #2#10 = "Cuenta corriente";     |FINSI;
     |SI aAlfa1 = "2";  #2#10 = "Cuenta ahorro";        |FINSI;
     |SI aAlfa1 = "3";  #2#10 = "Imposici¢n a plazo";   |FINSI;
     |SI aAlfa1 = "4";  #2#10 = "Cuentas financieras";  |FINSI;
     |SI aAlfa1 = "5";  #2#10 = "Cuentas de cr‚dito";   |FINSI;
     |SI aAlfa1 = "6";  #2#10 = "Cuentas soportadas";   |FINSI;

     aAlfa1 = aCadena % 6903;   #2#11 = aAlfa1;
     aAlfa1 = aCadena % 7213;   #2#12 = aAlfa1;  #2#12 = #2#12 / 100;
     aAlfa1 = aCadena % 8513;   #2#13 = aAlfa1;  #2#13 = #2#13 / 100;
     aAlfa1 = aCadena % 9813;   #2#14 = aAlfa1;  #2#14 = #2#14 / 100;
     aAlfa1 = aCadena % 11113;  #2#15 = aAlfa1;  #2#15 = #2#15 / 100;

     |GRABA 020#2n;
     |LIBERA #2;
     |CIERRA #2;
|FPRC;

|PROCESO ClaveRE;
     nLinea = 1;

     |ABRE #3;
     #3#0 = #0#0;
     #3#1 = nContri;
     #3#2 = 99;
     |LEE 000#3];
     |SI FSalida = 0;
         |LEE 000#3a;
     |SINO;
         |LEE 000#3u;
     |FINSI;

     |SI FSalida = 0;  |Y #3#0 = #0#0; |Y #3#1 = nContri;
         nLinea = #3#2 + 1;
     |FINSI;

     |DDEFECTO #3;
     #3#0   = #0#0;
     #3#1   = nContri;
     #3#2   = nLinea;
     #3#3   = aNegro;
     #3#4   = "Pendiente";
     #3#6   = 0;
     #3#7   = aCadena % 0909;
     #3#8   = aCadena % 1840;
     #3#9   = aCadena % 5809;
     #3#10  = aCadena % 6740;
     #3#11  = "";

     aAlfa1 = aCadena % 10703;
     |SI aAlfa1 = "A01";  #3#11 = "Base imponible ahorro: primas asistencia";  #3#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A02";  #3#11 = "Base imponible ahorro: dividendos       ";  #3#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A03";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A04";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A05";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A07";  #3#11 = "Base imponible ahorro: dividendos       ";  #3#5 = "rem00022";   |FINSI;

     |SI aAlfa1 = "B01";  #3#11 = "Base imponible ahorro: intereses        ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B02";  #3#11 = "Base imponible ahorro: intereses        ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B03";  #3#11 = "Base imponible ahorro: intereses        ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B04";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B05";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B06";  #3#11 = "Base imponible ahorro: rendimientos     ";  #3#5 = "rem00023";   |FINSI;

     |SI aAlfa1 = "C05";  #3#11 = "Rentas vitalicias o temporales          ";  #3#5 = "rem00051";   |FINSI;
     |SI aAlfa1 = "GAS";  #3#11 = "Base imponible ahorro: gastos deducibles";  #3#5 = "rem00022";   |FINSI;

     |SI aAlfa1 = "C01";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C02";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C03";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C04";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C06";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C07";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C12";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;

     |SI aAlfa1 = "D01";  #3#11 = "Base imponible general: intereses       ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D02";  #3#11 = "Base imponible general: intereses       ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D03";  #3#11 = "Base imponible general: intereses       ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D04";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D05";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D06";  #3#11 = "Base imponible general: rendimientos    ";  #3#5 = "rem00023";   |FINSI;

     #3#16 = aAlfa1;

     aAlfa1 = #3#11;  |QBF aAlfa1;
     |SI aAlfa1  = "";  |ACABA;  |FINSI;

     aAlfa1 = aCadena % 11001;
     |SI aAlfa1 = "1";  #3#12 = "Dineraria";   |FINSI;
     |SI aAlfa1 = "2";  #3#12 = "En especie";  |FINSI;

     aAlfa1 = aCadena % 11313;  #3#13 = aAlfa1;  #3#13 = #3#13 / 100;
     aAlfa1 = aCadena % 12613;  #3#14 = aAlfa1;  #3#14 = #3#14 / 100;
     aAlfa1 = aCadena % 13913;  #3#15 = aAlfa1;  #3#15 = #3#15 / 100;

     |GRABA 020#3n;
     |LIBERA #3;
     |CIERRA #3;
|FPRC;

|PROCESO ClaveTV;
     nLinea = 1;

     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = nContri;
     #4#2 = 99;
     |LEE 000#4];
     |SI FSalida = 0;
         |LEE 000#4a;
     |SINO;
         |LEE 000#4u;
     |FINSI;

     |SI FSalida = 0;  |Y #4#0 = #0#0; |Y #4#1 = nContri;
         nLinea = #4#2 + 1;
     |FINSI;

     |DDEFECTO #4;
     #4#0   = #0#0;
     #4#1   = nContri;
     #4#2   = nLinea;
     #4#3   = aNegro;
     #4#4   = "No trasladable";
     #4#5   = "";
     #4#6   = 0;
     #4#7   = aCadena % 0909;
     #4#8   = aCadena % 1840;
     #4#9   = aCadena % 5809;
     #4#10  = aCadena % 6740;
     aAlfa1 = (aCadena % 11302) + "." + (aCadena % 11102) + "." + (aCadena % 10704);
     #4#11  = aAlfa1;

     aAlfa1 = aCadena % 11501;
     |SI aAlfa1 = "A";  #4#12 = "Acciones en sociedades resp.limitada    ";  |FINSI;
     |SI aAlfa1 = "B";  #4#12 = "Activos con rdtos explicitos            ";  |FINSI;
     |SI aAlfa1 = "C";  #4#12 = "Activos con rdtos implicitos            ";  |FINSI;
     |SI aAlfa1 = "D";  #4#12 = "Principales segregados                  ";  |FINSI;
     |SI aAlfa1 = "E";  #4#12 = "Cupones segregados                      ";  |FINSI;
     |SI aAlfa1 = "F";  #4#12 = "Derechos de Garant¡a                    ";  |FINSI;
     |SI aAlfa1 = "G";  #4#12 = "Derechos de Disfrute                    ";  |FINSI;
     |SI aAlfa1 = "H";  #4#12 = "Derechos de suscripci¢n                 ";  |FINSI;
     |SI aAlfa1 = "I";  #4#12 = "Otros                                   ";  |FINSI;
     |SI aAlfa1 = "K";  #4#12 = "Participaciones preferentes             ";  |FINSI;
     |SI aAlfa1 = "M";  #4#12 = "Acciones Instit.Inversion Colectivas    ";  |FINSI;

     aAlfa1 = aCadena % 11603;  #4#13 = aAlfa1;
     aAlfa1 = aCadena % 12113;  #4#14 = aAlfa1;  #4#14 = #4#14 / 100;
     aAlfa1 = aCadena % 13412;  #4#15 = aAlfa1;  #4#15 = #4#15 / 100;

     aAlfa1 = aCadena % 14601;
     |SI aAlfa1 = "B";  #4#16 = "Perceptor de los rendimientos";  |FINSI;
     |SI aAlfa1 = "C";  #4#16 = "Tercero por cuenta           ";  |FINSI;
     |SI aAlfa1 = "N";  #4#16 = "Nudo propietario             ";  |FINSI;
     |SI aAlfa1 = "P";  #4#16 = "Prestamista                  ";  |FINSI;
     |SI aAlfa1 = "Q";  #4#16 = "Prestatario                  ";  |FINSI;
     |SI aAlfa1 = "T";  #4#16 = "Titular                      ";  |FINSI;
     |SI aAlfa1 = "U";  #4#16 = "Usufructuario                ";  |FINSI;

     |GRABA 020#4n;
     |LIBERA #4;
     |CIERRA #4;
|FPRC;

|PROCESO ClaveSG;
     nLinea = 1;

     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = nContri;
     #5#2 = 99;
     |LEE 000#5];
     |SI FSalida = 0;
         |LEE 000#5a;
     |SINO;
         |LEE 000#5u;
     |FINSI;

     |SI FSalida = 0;  |Y #5#0 = #0#0; |Y #5#1 = nContri;
         nLinea = #5#2 + 1;
     |FINSI;

     |DDEFECTO #5;
     #5#0   = #0#0;
     #5#1   = nContri;
     #5#2   = nLinea;
     #5#3   = aNegro;
     #5#4   = "Pendiente";
     #5#5   = "rem00024"
     #5#6   = 0;
     #5#7   = aCadena % 0909;
     #5#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = "1";  #5#9 = "Dineraria";   |FINSI;
     |SI aAlfa1 = "2";  #5#9 = "En especie";  |FINSI;

     aAlfa1 = aCadena % 5913;   #5#10 = aAlfa1;  #5#10 = #5#10 / 100;
     aAlfa1 = aCadena % 7213;   #5#11 = aAlfa1;  #5#11 = #5#11 / 100;
     aAlfa1 = aCadena % 8513;   #5#12 = aAlfa1;  #5#12 = #5#12 / 100;

     |GRABA 020#5n;
     |LIBERA #5;
     |CIERRA #5;
|FPRC;

|PROCESO ClaveCT;
     nLinea = 1;

     |ABRE #6;
     #6#0 = #0#0;
     #6#1 = nContri;
     #6#2 = 99;
     |LEE 000#6];
     |SI FSalida = 0;
         |LEE 000#6a;
     |SINO;
         |LEE 000#6u;
     |FINSI;

     |SI FSalida = 0;  |Y #6#0 = #0#0; |Y #6#1 = nContri;
         nLinea = #6#2 + 1;
     |FINSI;

     |DDEFECTO #6;
     #6#0   = #0#0;
     #6#1   = nContri;
     #6#2   = nLinea;
     #6#3   = aNegro;
     #6#4   = "No trasladable";
     #6#5   = "";
     #6#6   = 0;
     #6#7   = aCadena % 0912;
     aAlfa1 = aCadena % 2104;

     |SI aAlfa1 = "0140";   #6#8 = "R‚gimen general (Conv.Esp.)          ";  |FINSI;
     |SI aAlfa1 = "0521";   #6#8 = "Reg. Esp. Trabajadores aut¢nomos     ";  |FINSI;
     |SI aAlfa1 = "0540";   #6#8 = "Reg. Esp. Aut¢nomos (Conv.Esp.)      ";  |FINSI;
     |SI aAlfa1 = "0611";   #6#8 = "Reg. Esp. Agrario (Cuenta Ajena)     ";  |FINSI;
     |SI aAlfa1 = "0640";   #6#8 = "Reg. Esp. Agrario Cuenta Ajena (C.Es)";  |FINSI;
     |SI aAlfa1 = "0721";   #6#8 = "Reg. Esp. Agrario (Cuenta Propia)    ";  |FINSI;
     |SI aAlfa1 = "0740";   #6#8 = "Reg. Esp. Agrario Cuenta Propia (C.E)";  |FINSI;
     |SI aAlfa1 = "0825";   #6#8 = "Reg. Esp. Del Mar (Aut¢nomos)        ";  |FINSI;
     |SI aAlfa1 = "0840";   #6#8 = "Reg. Esp. Del Mar (Conv.Esp.)        ";  |FINSI;
     |SI aAlfa1 = "0940";   #6#8 = "Reg. Esp. Miner¡a Carb¢n (Conv.Esp.) ";  |FINSI;
     |SI aAlfa1 = "1211";   #6#8 = "Reg. Esp. Empleados Hogar (Fijos)    ";  |FINSI;
     |SI aAlfa1 = "1221";   #6#8 = "Reg. Esp. Empleados Hogar (Discont.) ";  |FINSI;
     |SI aAlfa1 = "1240";   #6#8 = "Reg. Esp. Empleados Hogar (Conv.Esp.)";  |FINSI;
     |SI aAlfa1 = "3040";   #6#8 = "Asistencia Sanitaria (conv.Esp.)     ";  |FINSI;

     aAlfa1 = aCadena % 2517;  #6#9 = aAlfa1;  #6#9 = #6#9 / 100;

     |GRABA 020#6n;
     |LIBERA #6;
     |CIERRA #6;
|FPRC;

|PROCESO ClaveUR;
     nLinea = 1;

     |ABRE #7;
     #7#0 = #0#0;
     #7#1 = nContri;
     #7#2 = 99;
     |LEE 000#7];
     |SI FSalida = 0;
         |LEE 000#7a;
     |SINO;
         |LEE 000#7u;
     |FINSI;

     |SI FSalida = 0;  |Y #7#0 = #0#0; |Y #7#1 = nContri;
         nLinea = #7#2 + 1;
     |FINSI;

     |DDEFECTO #7;
     #7#0   = #0#0;
     #7#1   = nContri;
     #7#2   = nLinea;
     #7#3   = aNegro;
     #7#4   = "Pendiente";
     #7#5   = "rem00021"
     #7#6   = 0;
     #7#7   = aCadena % 0920;
     aAlfa1 = aCadena % 2902;  |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena % 3125);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena % 5604);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena % 6001);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena % 6202);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena % 6502);   |QBF aAlfa1;
     #7#8   = aAlfa1;
     #7#9   = aCadena % 6805;
     #7#10  = aCadena % 7414;

     #7#11  = aCadena % 8802;
     |SI #7#11 = "UR";  #7#12 = "Urbana";   |FINSI;
     |SI #7#11 = "RU";  #7#12 = "R£stica";  |FINSI;

     #7#13  = aCadena % 9001;
                       #7#14 = "Sin definir                                       ";
     |SI #7#13 = "A";  #7#14 = "Almac‚n y aparcamiento                            ";  |FINSI;
     |SI #7#13 = "V";  #7#14 = "Residencial                                       ";  |FINSI;
     |SI #7#13 = "I";  #7#14 = "Industrial                                        ";  |FINSI;
     |SI #7#13 = "O";  #7#14 = "Oficinas                                          ";  |FINSI;
     |SI #7#13 = "C";  #7#14 = "Comercial                                         ";  |FINSI;
     |SI #7#13 = "M";  #7#14 = "Solares                                           ";  |FINSI;
     |SI #7#13 = "K";  #7#14 = "Deportivo                                         ";  |FINSI;
     |SI #7#13 = "T";  #7#14 = "Espect culos                                      ";  |FINSI;
     |SI #7#13 = "G";  #7#14 = "Ocio y Hosteler¡a                                 ";  |FINSI;
     |SI #7#13 = "Y";  #7#14 = "Sanidad y Beneficiencia                           ";  |FINSI;
     |SI #7#13 = "E";  #7#14 = "Cultural                                          ";  |FINSI;
     |SI #7#13 = "R";  #7#14 = "Religioso                                         ";  |FINSI;
     |SI #7#13 = "M";  #7#14 = "Obras de urbanizaci¢n, suelos sin edificar        ";  |FINSI;
     |SI #7#13 = "P";  #7#14 = "Edificio singular                                 ";  |FINSI;
     |SI #7#13 = "B";  #7#14 = "Almac‚n agrario                                   ";  |FINSI;
     |SI #7#13 = "J";  #7#14 = "Industrial agrario                                ";  |FINSI;
     |SI #7#13 = "Z";  #7#14 = "Agrario                                           ";  |FINSI;

     #7#15  = aCadena % 9101;
     |SI #7#15 = "1";  #7#16 = "Residencial garaje";    |FINSI;
     |SI #7#15 = "2";  #7#16 = "Industrial";            |FINSI;
     |SI #7#15 = "3";  #7#16 = "Residencial trastero";  |FINSI;

     aAlfa1 = aCadena % 9213;   #7#17 = aAlfa1;  #7#17 = #7#17 / 100;

     #7#18  = aCadena % 10501;

     #7#19 = aCadena % 10602;
     |SI #7#19 = "PR";  #7#20 = "Propietario";               |FINSI;
     |SI #7#19 = "US";  #7#20 = "Usufructuario";             |FINSI;
     |SI #7#19 = "CA";  #7#20 = "Concesi¢n administrativa";  |FINSI;
     |SI #7#19 = "DS";  #7#20 = "Derecho de superficie   ";  |FINSI;
     |SI #7#19 = "NP";  #7#20 = "Nuda propiedad          ";  |FINSI;
     |SI #7#19 = "DF";  #7#20 = "Disfrutador             ";  |FINSI;

     aAlfa1 = aCadena % 10805;   #7#21 = aAlfa1;  #7#21 = #7#21 / 100;
     aAlfa1 = aCadena % 11303;   #7#22 = aAlfa1;

     #7#23 = aCadena % 11601;
     |SI #7#23 = "H";  #7#24 = "Vivienda habitual";      |FINSI;
     |SI #7#23 = "A";  #7#24 = "Arrendada";              |FINSI;
     |SI #7#23 = "C";  #7#24 = "Habitual y arrendada";   |FINSI;
     |SI #7#23 = "O";  #7#24 = "";                       |FINSI;

     #7#25 = aCadena % 11701;
     |SI #7#25 = "1";  #7#26 = "Inmuebles en territorio com£n";  |FINSI;
     |SI #7#25 = "2";  #7#26 = "Inmuebles en territorio foral";  |FINSI;

     |GRABA 020#7n;
     |LIBERA #7;
     |CIERRA #7;
|FPRC;

|PROCESO ClavePF;
     nLinea = 1;

     |ABRE #9;
     #9#0 = #0#0;
     #9#1 = nContri;
     #9#2 = 99;
     |LEE 000#9];
     |SI FSalida = 0;
         |LEE 000#9a;
     |SINO;
         |LEE 000#9u;
     |FINSI;

     |SI FSalida = 0;  |Y #9#0 = #0#0; |Y #9#1 = nContri;
         nLinea = #9#2 + 1;
     |FINSI;

     |DDEFECTO #9;
     #9#0   = #0#0;
     #9#1   = nContri;
     #9#2   = nLinea;
     #9#3   = aNegro;
     #9#4   = "Pendiente";
     #9#5   = "rem00031";
     #9#6   = 0;
     #9#7   = aCadena % 0903;

     aAlfa1 = aCadena % 1201;
     |SI aAlfa1 = "I";  #9#8 = "Ingreso";                      |FINSI;
     |SI aAlfa1 = "N";  #9#8 = "Negativa";                     |FINSI;
     |SI aAlfa1 = "C";  #9#8 = "Compensaci¢n";                 |FINSI;
     |SI aAlfa1 = "D";  #9#8 = "Devoluci¢n";                   |FINSI;
     |SI aAlfa1 = "F";  #9#8 = "Formalizaci¢n";                |FINSI;
     |SI aAlfa1 = "A";  #9#8 = "Aplazamiento";                 |FINSI;
     |SI aAlfa1 = "M";  #9#8 = "Imposibilidad de pago";        |FINSI;
     |SI aAlfa1 = "S";  #9#8 = "Solicitud de compensaci¢n";    |FINSI;
     |SI aAlfa1 = "E";  #9#8 = "Devoluci¢n ingreso excesivo";  |FINSI;
     |SI aAlfa1 = "G";  #9#8 = "Ingreso CCT";                  |FINSI;
     |SI aAlfa1 = "V";  #9#8 = "Devoluci¢n CCT";               |FINSI;

     #9#9   = aCadena % 1302;
     #9#10  = aCadena % 1502;
     #9#11  = aCadena % 1713;

     aAlfa1 = aCadena % 3013;  #9#12 = aAlfa1;  #9#12 = #9#12 / 100;

     |SI #9#12 = 0;
         #9#4   = "No trasladable";
     |FINSI;

     |GRABA 020#9n;
     |LIBERA #9;
     |CIERRA #9;
|FPRC;

|PROCESO ClaveDN;
     nLinea = 1;

     |ABRE #10;
     #10#0 = #0#0;
     #10#1 = nContri;
     #10#2 = 99;
     |LEE 000#10];
     |SI FSalida = 0;
         |LEE 000#10a;
     |SINO;
         |LEE 000#10u;
     |FINSI;

     |SI FSalida = 0;  |Y #10#0 = #0#0; |Y #10#1 = nContri;
         nLinea = #10#2 + 1;
     |FINSI;

     |DDEFECTO #10;
     #10#0   = #0#0;
     #10#1   = nContri;
     #10#2   = nLinea;
     #10#3   = aNegro;
     #10#4   = "Pendiente";
     #10#5   = "rem00046";
     #10#6   = 0;
     #10#7   = aCadena % 0909;
     #10#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = " ";  #10#9  = "Dinerarias";   |FINSI;
     |SI aAlfa1 = "X";  #10#9  = "En especie";   |FINSI;

     aAlfa1 = aCadena % 5901;
     |SI aAlfa1 = "A";  #10#10 = "Donativos";     |FINSI;
     |SI aAlfa1 = "B";  #10#10 = "Donativos";     |FINSI;
     |SI aAlfa1 = "C";  #10#10 = "Aportaciones";  |FINSI;

     aAlfa1 = aCadena % 6005;  #10#11 = aAlfa1;  #10#11 = #10#11 / 100;

     #10#12 = aCadena % 6502;

     aAlfa1 = aCadena % 6713;  #10#13 = aAlfa1;  #10#13 = #10#13 / 100;
     aAlfa1 = aCadena % 8005;  #10#15 = aAlfa1;  #10#15 = #10#15 / 100;

     |GRABA 020#10n;
     |LIBERA #10;
     |CIERRA #10;
|FPRC;

|PROCESO ClaveAR;
     nLinea = 1;

     |ABRE #11;
     #11#0 = #0#0;
     #11#1 = nContri;
     #11#2 = 99;
     |LEE 000#11];
     |SI FSalida = 0;
         |LEE 000#11a;
     |SINO;
         |LEE 000#11u;
     |FINSI;

     |SI FSalida = 0;  |Y #11#0 = #0#0; |Y #11#1 = nContri;
         nLinea = #11#2 + 1;
     |FINSI;

     |DDEFECTO #11;
     #11#0   = #0#0;
     #11#1   = nContri;
     #11#2   = nLinea;
     #11#3   = aNegro;
     #11#4   = "No trasladable";
     #11#5   = "";
     #11#6   = 0;
     #11#7   = aCadena % 0909;
     #11#8   = aCadena % 1840;

     aAlfa1  = aCadena % 5801;
     |SI aAlfa1 = "1";  #11#9 = "Dinerarias";  |FINSI;
     |SI aAlfa1 = "2";  #11#9 = "En especie"; |FINSI;

     aAlfa1 = aCadena % 5913;   #11#10 = aAlfa1;  #11#10 = #11#10 / 100;
     aAlfa1 = aCadena % 7213;   #11#11 = aAlfa1;  #11#11 = #11#11 / 100;

     |GRABA 020#11n;
     |LIBERA #11;
     |CIERRA #11;
|FPRC;

|PROCESO ClavePH;
     nLinea = 1;

     |ABRE #12;
     #12#0 = #0#0;
     #12#1 = nContri;
     #12#2 = 99;
     |LEE 000#12];
     |SI FSalida = 0;
         |LEE 000#12a;
     |SINO;
         |LEE 000#12u;
     |FINSI;

     |SI FSalida = 0;  |Y #12#0 = #0#0; |Y #12#1 = nContri;
         nLinea = #12#2 + 1;
     |FINSI;

     |DDEFECTO #12;
     #12#0   = #0#0;
     #12#1   = nContri;
     #12#2   = nLinea;
     #12#3   = aNegro;
     #12#4   = "No trasladable";
     #12#5   = "";
     #12#6   = 0;
     #12#7   = aCadena % 0909;
     #12#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5805;   #12#09 = aAlfa1;  #12#09 = #12#09 / 100;
     aAlfa1 = aCadena % 6320;   #12#10 = aAlfa1;  #12#10 = #12#10 / 100;
     aAlfa1 = aCadena % 8313;   #12#11 = aAlfa1;  #12#11 = #12#11 / 100;

     |GRABA 020#12n;
     |LIBERA #12;
     |CIERRA #12;
|FPRC;

|PROCESO ClaveDM;
     nLinea = 1;

     |ABRE #13;
     #13#0 = #0#0;
     #13#1 = nContri;
     #13#2 = 99;
     |LEE 000#13];
     |SI FSalida = 0;
         |LEE 000#13a;
     |SINO;
         |LEE 000#13u;
     |FINSI;

     |SI FSalida = 0;  |Y #13#0 = #0#0; |Y #13#1 = nContri;
         nLinea = #13#2 + 1;
     |FINSI;

     |DDEFECTO #13;
     #13#0   = #0#0;
     #13#1   = nContri;
     #13#2   = nLinea;
     #13#3   = aNegro;
     #13#4   = "Pendiente";
     #13#5   = "rem00056";
     #13#6   = 0;
     #13#7   = aCadena % 0902;

     aAlfa1 = aCadena % 1109;  #13#8 = aAlfa1;  #13#8 = #13#8 / 100;
     aAlfa1 = aCadena % 2008;  #13#9 = aAlfa1;  #13#9 = #13#9 / 100;

     |SI #13#9 = 0;
         #13#4   = "No trasladable";
     |FINSI;

     |GRABA 020#13n;
     |LIBERA #13;
     |CIERRA #13;
|FPRC;

|PROCESO ClavePP;
     nLinea = 1;

     |ABRE #14;
     #14#0 = #0#0;
     #14#1 = nContri;
     #14#2 = 99;
     |LEE 000#14];
     |SI FSalida = 0;
         |LEE 000#14a;
     |SINO;
         |LEE 000#14u;
     |FINSI;

     |SI FSalida = 0;  |Y #14#0 = #0#0; |Y #14#1 = nContri;
         nLinea = #14#2 + 1;
     |FINSI;

     |DDEFECTO #14;
     #14#0   = #0#0;
     #14#1   = nContri;
     #14#2   = nLinea;
     #14#3   = aNegro;
     #14#4   = "Pendiente";
     #14#5   = "rem00053";
     #14#6   = 0;
     #14#7   = aCadena % 0909;
     #14#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = "A";  #14#9 = "Aportaciones personales a Fondo de Pensiones      ";  |FINSI;
     |SI aAlfa1 = "C";  #14#9 = "Contribuciones deducibles del promotor            ";  |FINSI;
     |SI aAlfa1 = "E";  #14#9 = "Mutualidades. Cantidades abonadas prof. o empres. ";  |FINSI;
     |SI aAlfa1 = "F";  #14#9 = "Mutualidades. Cantidades abonadas trabajadores    ";  |FINSI;
     |SI aAlfa1 = "G";  #14#9 = "Mutualidades. Cantidades abonadas promotor        ";  |FINSI;
     |SI aAlfa1 = "H";  #14#9 = "Primas satisfechas a Planes de Previsi¢n Asegurado";  |FINSI;
     |SI aAlfa1 = "J";  #14#9 = "Primas a planes de previsi¢n social empresarial   ";  |FINSI;
     |SI aAlfa1 = "K";  #14#9 = "Primas a seguros de dependencia                   ";  |FINSI;

     aAlfa1 = aCadena % 5803;
     |SI aAlfa1 = "C01";  #14#10 = "Contribuciones de los promotores                 ";  |FINSI;
     |SI aAlfa1 = "J08";  #14#10 = "Aportaciones satisfechas por los asegurados      ";  |FINSI;
     |SI aAlfa1 = "J09";  #14#10 = "Contribuciones satisfechas por los tomadores     ";  |FINSI;

     aAlfa1 = aCadena % 6113;  #14#11 = aAlfa1;  #14#11 = #14#11 / 100;
     aAlfa1 = aCadena % 7413;  #14#12 = aAlfa1;  #14#12 = #14#12 / 100;

     #14#13  = aCadena % 8709;

     |GRABA 020#14n;
     |LIBERA #14;
     |CIERRA #14;
|FPRC;

|PROCESO ClaveIP;
     nLinea = 1;

     |ABRE #15;
     #15#0 = #0#0;
     #15#1 = nContri;
     #15#2 = 99;
     |LEE 000#15];
     |SI FSalida = 0;
         |LEE 000#15a;
     |SINO;
         |LEE 000#15u;
     |FINSI;

     |SI FSalida = 0;  |Y #15#0 = #0#0; |Y #15#1 = nContri;
         nLinea = #15#2 + 1;
     |FINSI;

     |DDEFECTO #15;
     #15#0   = #0#0;
     #15#1   = nContri;
     #15#2   = nLinea;
     #15#3   = aNegro;
     #15#4   = "No trasladable";
     #15#5   = "";
     #15#6   = 0;
     #15#7   = aCadena % 0909;
     #15#8   = aCadena % 1840;

     aAlfa1 = aCadena % 5813;   #15#9  = aAlfa1;  #15#9  = #15#9  / 100;

     |GRABA 020#15n;
     |LIBERA #15;
     |CIERRA #15;
|FPRC;

|PROCESO ClaveAG;
     nLinea = 1;

     |ABRE #16;
     #16#0 = #0#0;
     #16#1 = nContri;
     #16#2 = 99;
     |LEE 000#16];
     |SI FSalida = 0;
         |LEE 000#16a;
     |SINO;
         |LEE 000#16u;
     |FINSI;

     |SI FSalida = 0;  |Y #16#0 = #0#0; |Y #16#1 = nContri;
         nLinea = #16#2 + 1;
     |FINSI;

     |DDEFECTO #16;
     #16#0   = #0#0;
     #16#1   = nContri;
     #16#2   = nLinea;
     #16#3   = aNegro;
     #16#4   = "No trasladable";
     #16#5   = "";
     #16#6   = 0;
     #16#7   = aCadena % 0909;
     #16#8   = aCadena % 1840;
     #16#10  = aCadena % 6049;

     aAlfa1 = aCadena % 5801;
     |SI aAlfa1 = "1";  #16#9 = "Subvenciones corrientes";  |FINSI;
     |SI aAlfa1 = "2";  #16#9 = "Subvenciones capital";     |FINSI;
     |SI aAlfa1 = "3";  #16#9 = "Indemnizaciones al circulante";    |FINSI;
     |SI aAlfa1 = "4";  #16#9 = "Indemnizaciones al inmovilizado";  |FINSI;
     |SI aAlfa1 = "5";  #16#9 = "Indemnizaciones por cese";  |FINSI;
     |SI aAlfa1 = "6";  #16#9 = "Otras";  |FINSI;

     aAlfa1 = aCadena % 10915;   #16#11 = aAlfa1;  #16#11 = #16#11 / 100;

     |GRABA 020#16n;
     |LIBERA #16;
     |CIERRA #16;
|FPRC;

|PROCESO ClaveFI;
     nLinea = 1;

     |ABRE #17;
     #17#0 = #0#0;
     #17#1 = nContri;
     #17#2 = 99;
     |LEE 000#17];
     |SI FSalida = 0;
         |LEE 000#17a;
     |SINO;
         |LEE 000#17u;
     |FINSI;

     |SI FSalida = 0;  |Y #17#0 = #0#0; |Y #17#1 = nContri;
         nLinea = #17#2 + 1;
     |FINSI;

     |DDEFECTO #17;
     #17#0   = #0#0;
     #17#1   = nContri;
     #17#2   = nLinea;
     #17#3   = aNegro;
     #17#4   = "No trasladable";
     #17#5   = "";
     #17#6   = 0;
     #17#7   = aCadena % 0909;
     #17#8   = aCadena % 1840;
     #17#9   = aCadena % 5809;
     #17#10  = aCadena % 6740;
     #17#11  = (aCadena % 11302) + "." + (aCadena % 11102) + "." + (aCadena % 10704);

     aAlfa1 = aCadena % 11515;   #17#12 = aAlfa1;  #17#12 = #17#12 / 100;
     aAlfa1 = aCadena % 13015;   #17#13 = aAlfa1;  #17#13 = #17#13 / 100;
     aAlfa1 = aCadena % 14513;   #17#14 = aAlfa1;  #17#14 = #17#14 / 100;

     |GRABA 020#17n;
     |LIBERA #17;
     |CIERRA #17;
|FPRC;

|PROCESO TrataCadena;
     aAlfa1 = aCadena % 101;
     |SI aAlfa1 = "0";  |ACABA;  |FINSI;
     |SI aAlfa1 = "1";  |ACABA;  |FINSI;
     |SI aAlfa1 = "3";  nSalir = 1;  |ACABA;  |FINSI;

     aAlfa1 = aCadena % 203;
     |SI aAlfa1 = "RTA";  |HAZ ClaveRT;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RTC";  |HAZ ClaveRC;  |ACABA;  |FINSI;

     aAlfa1 = aCadena % 202;
     |SI aAlfa1 = "DO";                  |ACABA;  |FINSI;

     |SI aAlfa1 = "CB";   |HAZ ClaveCB;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RE";   |HAZ ClaveRE;  |ACABA;  |FINSI;
     |SI aAlfa1 = "TV";   |HAZ ClaveTV;  |ACABA;  |FINSI;
     |SI aAlfa1 = "SG";   |HAZ ClaveSG;  |ACABA;  |FINSI;
     |SI aAlfa1 = "CT";   |HAZ ClaveCT;  |ACABA;  |FINSI;
     |SI aAlfa1 = "UR";   |HAZ ClaveUR;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PF";   |HAZ ClavePF;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DN";   |HAZ ClaveDN;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AR";   |HAZ ClaveAR;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PH";   |HAZ ClavePH;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DM";   |HAZ ClaveDM;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PP";   |HAZ ClavePP;  |ACABA;  |FINSI;
     |SI aAlfa1 = "IP";   |HAZ ClaveIP;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AG";   |HAZ ClaveAG;  |ACABA;  |FINSI;
     |SI aAlfa1 = "FI";   |HAZ ClaveFI;  |ACABA;  |FINSI;

     |SI aClave ! aAlfa1;
         aAlfa = "0000Clave " + aAlfa1 + " no reconocida en esta versi¢n, ";
         aAlfa = aAlfa + "contacte con nuestro departamento de soporte para ";
         aAlfa = aAlfa + "incluirlo en una pr¢xima versi¢n";
         |MENAV aAlfa;
     |FINSI;

     aClave = aAlfa1;
|FPRC;

|PROCESO tempora0;
     |BORRA 020#900a;
     |LIBERA #900;
|FPRC;

|DEFBUCLE tempora0;
     #900#1003;
     ;
     nEmpresa, nContri, 01;
     nEmpresa, nContri, 99;
     be;
     NULL, tempora0;
|FIN;

|PROCESO ElBorrado;
     aDef = aBase + "def/" + aMas;

     |CARGA_DEF aDef, tempora0@;

     |BUCLE tempora0;

     |DESCARGA_DEF #tempora0@;
|FPRC;

|PROCESO BorraDatos;
     aMas = "rem05001.mas";  |HAZ ElBorrado;
     aMas = "rem05002.mas";  |HAZ ElBorrado;
     aMas = "rem05003.mas";  |HAZ ElBorrado;
     aMas = "rem05004.mas";  |HAZ ElBorrado;
     aMas = "rem05005.mas";  |HAZ ElBorrado;
     aMas = "rem05006.mas";  |HAZ ElBorrado;
     aMas = "rem05007.mas";  |HAZ ElBorrado;
     aMas = "rem05008.mas";  |HAZ ElBorrado;
     aMas = "rem05009.mas";  |HAZ ElBorrado;
     aMas = "rem05010.mas";  |HAZ ElBorrado;
     aMas = "rem05011.mas";  |HAZ ElBorrado;
     aMas = "rem05012.mas";  |HAZ ElBorrado;
     aMas = "rem05013.mas";  |HAZ ElBorrado;
     aMas = "rem05014.mas";  |HAZ ElBorrado;
     aMas = "rem05015.mas";  |HAZ ElBorrado;
     aMas = "rem05016.mas";  |HAZ ElBorrado;
     aMas = "rem05017.mas";  |HAZ ElBorrado;
|FPRC;

|PROCESO CargaDatos;
     aAbre = aDirServidor + (#0nCampo % 108) + ".dfp";  |QBT aAbre;
     |XABRE "AB", aAbre, nHandle;

     aCR        = &10;
     aLF        = &13;
     nSalir     = 0;
     aClave     = "";
     aCadena    = "";

     |XLEE nHandle, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            |SI aAlfa = aCR;
                |HAZ TrataCadena;
                aCadena = "";
            |SINO;
                |SI aAlfa ! aLF;
                    aCadena = aCadena + aAlfa;
                |FINSI;
            |FINSI;

            |SI nSalir = 1;  |SAL;  |FINSI;

            |XLEE nHandle, 1, aAlfa;
     |SIGUE;
     |XCIERRA nHandle;
|FPRC;

|PROCESO EnciendeBotones;
     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";
     |ESTADO_CONTROL nBoton2_1, "DISABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_3, "DISABLE";
     |ESTADO_CONTROL nBoton3_1, "DISABLE";
     |ESTADO_CONTROL nBoton3_2, "DISABLE";
     |ESTADO_CONTROL nBoton3_3, "DISABLE";
     |ESTADO_CONTROL nBoton4_1, "DISABLE";
     |ESTADO_CONTROL nBoton4_2, "DISABLE";
     |ESTADO_CONTROL nBoton4_3, "DISABLE";
     |ESTADO_CONTROL nBoton5_1, "DISABLE";
     |ESTADO_CONTROL nBoton5_2, "DISABLE";
     |ESTADO_CONTROL nBoton5_3, "DISABLE";
     |ESTADO_CONTROL nBoton6_1, "DISABLE";
     |ESTADO_CONTROL nBoton6_2, "DISABLE";
     |ESTADO_CONTROL nBoton6_3, "DISABLE";

     aAlfa = #0#2;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#3;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton1_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |FINSI;

         aAlfa = aDirServidor + (#0#1 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton1_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #0#6;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#7;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton2_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton2_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton2_3, "DISABLE";
         aAlfa = aDirServidor + (#0#5 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton2_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #0#10;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#11;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton3_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton3_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton3_3, "DISABLE";
         aAlfa = aDirServidor + (#0#11 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton3_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #0#14;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#15;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton4_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton4_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton4_3, "DISABLE";
         aAlfa = aDirServidor + (#0#13 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton4_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #0#18;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#19;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton5_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton5_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton5_3, "DISABLE";
         aAlfa = aDirServidor + (#0#17 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton5_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #0#22;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = #0#23;  |QBF aAlfa;
         |SI aAlfa ! "";
             |ESTADO_CONTROL nBoton6_1, "ENABLE";
         |FINSI;

         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton6_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton6_3, "DISABLE";
         aAlfa = aDirServidor + (#0#21 % 108) + ".dfp";  |QBT aAlfa;
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida ] 0;
             |ESTADO_CONTROL nBoton6_3, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaPortal;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO CopiaFichero;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO RecibeFichero;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |RECIBE_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO Explorador;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |ABRE #zregubic;
     #zregubic#0 = 2009;
     #zregubic#1 = aIPRemoto;
     |LEE 101#zregubic.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregubic;
         #zregubic#0 = 2009;
         #zregubic#1 = aIPRemoto;
         |GRABA 020#zregubic.b;
     |FINSI;

     aPathExplorador = #zregubic#4;  |QBF aPathExplorador;

     |SI aPathExplorador = "";  |O aForzExplorador = "S";
         |MENAV "0000Busque y pinche en el explorador con el que quiera trabajar";

         aPathExplorador = "F" + aPathExplorador;
         |BROWSE aPathExplorador;
         aPathExplorador = aPathExplorador % 290;  |QBF aPathExplorador;
     |FINSI;

     |SI aPathExplorador ! "";
         #zregubic#4 = aPathExplorador;
     |FINSI;

     |GRABA 020#zregubic.a;
     |LIBERA #zregubic;
     |CIERRA #zregubic;
|FPRC;

|PROCESO BotonExplora;
     aForzExplorador = "S";
     |HAZ Explorador;
|FPRC;

|PROCESO QuitaEnyes;
     aLong   = aAlfa1 % 0;
     nLong   = aLong;
     aCadena = "";
     |PARA nCarac = 1;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos       = (nCarac * 100) + 1;
           aCaracter  = aAlfa1 % nPos;

           |SI aCaracter = "¥";
               aCaracter = &0209;
           |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;

     aAlfa1 = aCadena;
|FPRC;

|PROCESO PaginaConsulta;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #0nCampoGet = FSalida;
     |SIGUE;

     aFichero = "pet" + (("00000" + #0#0) % -105) + ".htm";
     aAbre    = aDirServidor + aFichero;
     |XABRE "WB", aAbre, nHandle;

     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "ISO-8859-1" + &34 + " ?>";
     |HAZ GrabaPortal;

     aAlfa = "<!DOCTYPE html PUBLIC " + &34 + "-//W3C//DTD XHTML 1.0 Transitional//EN " + &34;
     aAlfa = aAlfa + &34 + "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html xmlns=" + &34 + "http://www.w3.org/1999/xhtml"  + &34;
     aAlfa = aAlfa + " xml:lang=" + &34 + "es" + &34 + " lang=" + &34 + "es" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Consulta de datos fiscales, ejercicio 2009</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Script-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/javascript" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<script type=" + &34 + "text/javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "//<![CDATA[";
     |HAZ GrabaPortal;

     aAlfa = "//INTERNET SIN CERTIFICADO (con referencia)";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "window.onload = function() {";
     |HAZ GrabaPortal;

     aAlfa = "        document.frm.submit();";
     |HAZ GrabaPortal;

     aAlfa = "}";
     |HAZ GrabaPortal;

     aAlfa = "//]]>";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "<body>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "      <form action="+ &34 + "https://www2.agenciatributaria.gob.es/es13/l/EWLZEWLINKLZ" + &34;
     aAlfa = aAlfa + " method=" + &34 + "post" + &34 + " name=" + &34 + "frm" + &34 + " id=" + &34 + "frm" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "MIC" + &34;
     aAlfa = aAlfa + " id=" + &34 + "MIC" + &34;
     aAlfa = aAlfa + " value=" + &34 + "IIS" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "IDI" + &34;
     aAlfa = aAlfa + " id=" + &34 + "IDI" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "PDP" + &34;
     aAlfa = aAlfa + " id=" + &34 + "PDP" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     nCampo1 = nCampo + 2;
     aAlfa1  = #0nCampo1;  |QBF aAlfa1;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "REF" + &34;
     aAlfa = aAlfa + " id=" + &34 + "REF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa1  = #0nCampo;  |QBF aAlfa1;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "NIF" + &34;
     aAlfa = aAlfa + " id=" + &34 + "NIF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;

     nCampo1 = nCampo + 1;
     aAlfa1  = #0nCampo1;  |QBF aAlfa1;
     |HAZ QuitaEnyes;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "APE" + &34;
     aAlfa = aAlfa + " id=" + &34 + "APE" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "FIN" + &34;
     aAlfa = aAlfa + " id=" + &34 + "FIN" + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa = "     </form>";
     |HAZ GrabaPortal;

     aAlfa = "</body>";
     |HAZ GrabaPortal;

     aAlfa = "</html>";
     |HAZ GrabaPortal;

     |XCIERRA nHandle;

     aOrigen  = aDirServidor + aFichero;
     aDestino = aDirLocal    + aFichero;
     |HAZ CopiaFichero;

     |FBORRA aOrigen;

     aForzExplorador = "N";
     |HAZ Explorador;

     |SI aPathExplorador ! "";
         aAlfa = aPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     |RFBORRA aDestino;

     |PULSATECLA;
|FPRC;

|PROCESO PaginaDescarga;
     aFichero = "des" + (("00000" + #0#0) % -105) + ".htm";
     aAbre    = aDirServidor + aFichero;
     |XABRE "WB", aAbre, nHandle;

     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "ISO-8859-15" + &34 + " ?>";
     |HAZ GrabaPortal;

     aAlfa = "<!DOCTYPE html PUBLIC " + &34 + "-//W3C//DTD XHTML 1.0 Transitional//EN " + &34;
     aAlfa = aAlfa + &34 + "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html xmlns=" + &34 + "http://www.w3.org/1999/xhtml"  + &34;
     aAlfa = aAlfa + " xml:lang=" + &34 + "es" + &34 + " lang=" + &34 + "es" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Consulta de datos fiscales, ejercicio 2009</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/html; charset=iso-8859-15" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Script-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/javascript" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<script type=" + &34 + "text/javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "//<![CDATA[";
     |HAZ GrabaPortal;

     aAlfa = "function inicializar(){";
     |HAZ GrabaPortal;

     aAlfa = "        document.enviar.submit()";
     |HAZ GrabaPortal;

     aAlfa = "}";
     |HAZ GrabaPortal;

     aAlfa = "window.onload = inicializar;";
     |HAZ GrabaPortal;

     aAlfa = "//]]>";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "<body>";
     |HAZ GrabaPortal;

     aAlfa = "      <form action="+ &34 + "https://www2.agenciatributaria.gob.es/es13/l/EWLZEWLINKLZ" + &34;
     aAlfa = aAlfa + " method=" + &34 + "post" + &34 + " name=" + &34 + "enviar" + &34;
     aAlfa = aAlfa + " id=" + &34 + "enviar" + &34;
     aAlfa = aAlfa + " class=" + &34 + "oculto" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "MIC" + &34;
     aAlfa = aAlfa + " value=" + &34 + "PIS" + &34;
     aAlfa = aAlfa + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "IDI" + &34;
     aAlfa = aAlfa + " value=" + &34 + "ES" + &34;
     aAlfa = aAlfa + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "PDP" + &34;
     aAlfa = aAlfa + " value=" + &34 + "S" + &34;
     aAlfa = aAlfa + " />";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     nCampo1 = nCampo + 2;
     aAlfa1  = #0nCampo1;  |QBF aAlfa1;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "REF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa1  = #0nCampo;  |QBF aAlfa1;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "NIF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + " />";
     |HAZ GrabaPortal;

     nCampo1 = nCampo + 1;
     aAlfa1  = #0nCampo1;  |QBF aAlfa1;
     |HAZ QuitaEnyes;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "APE" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "DIR" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "                  <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "FIN" + &34;
     aAlfa = aAlfa + " />";
     |HAZ GrabaPortal;

     aAlfa = "     </form>";
     |HAZ GrabaPortal;

     aAlfa = "</body>";
     |HAZ GrabaPortal;

     aAlfa = "</html>";
     |HAZ GrabaPortal;

     |XCIERRA nHandle;

     aOrigen  = aDirServidor + aFichero;
     aDestino = aDirLocal    + aFichero;
     |HAZ CopiaFichero;

     |FBORRA aOrigen;

     aForzExplorador = "N";
     |HAZ Explorador;

     |SI aPathExplorador ! "";
         aAlfa = aPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     |RFBORRA aDestino;

     aOrigen  = aDirLocal + (#0nCampo % 108) + ".dfp";  |QBT aAbre;
     aDestino = aDirServidor + (#0nCampo % 108) + ".dfp";
     |HAZ RecibeFichero;

     |PULSATECLA;
|FPRC;

|PROCESO Browse;
     aFichero = (#0nCampo % 108) + ".dfp";   |QBT aFichero;
     aRuta    = "F" + aFichero;
     |BROWSE aRuta;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos       = (nCarac * 100) + 1;
           aCaracter  = aAlfa % nPos;
           aRuta      = aRuta      + aCaracter;
           aNombreFic = aNombreFic + aCaracter;

           |SI aCaracter = "/";  |O aCaracter = "\";
               aNombreFic = "";
           |FINSI;
     |SIGUE;

     aNombreRea = aNombreFic < "";
     |SI aNombreRea ! aFichero;
         |ACABA;
     |FINSI;

     aOrigen = aRuta;
     aDestino = aDirServidor + aFichero;
     |HAZ RecibeFichero;
|FPRC;

|PROCESO Descarga;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #0nCampoGet = FSalida;
     |SIGUE;

     nCampo1 = nCampo + 3;
     aAlfa   = #0nCampo1;  |QBF aAlfa;
     |SI aAlfa = "Descargado";
          aAlfa = "0000El borrador ya ha sido descargado.";
          aAlfa = aAlfa + " Si se vuelve a descargar se perder n todas las conexiones posibles con los datos de la renta";
          |MENAV aAlfa;
          |CONFI "0000NQuiere descargarlo de nuevo";
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #0nCampo1 = "Sin descargar";   |PINTA #0nCampo1;

          |HAZ EnciendeBotones;
     |FINSI;

     aAbre = aDirServidor + (#0nCampo % 108) + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     nCampo1 = nCampo + 2;
     aAlfa   = #0nCampo1;  |QBF aAlfa;
     |SI aAlfa ! "";
         |HAZ PaginaDescarga;
     |SINO;
         |HAZ Browse;
     |FINSI;

     |HAZ BorraDatos;

     aAbre = aDirServidor + (#0nCampo % 108) + ".dfp";  |QBT aAbre;
     |XABRE "E", aAbre, nHandle;
     |SI FSalida ] 0;
         nCampo1   = nCampo + 3;
         #0nCampo1 = "Descargado";   |PINTA #0nCampo1;

         |HAZ CargaDatos;
         |HAZ EnciendeBotones;
     |SINO;
         |MENAV "0000Ha habido algun error en la descarga del borrador. Por favor intentelo de nuevo";
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO BuscaRegistro;
     aDef = aBase + "def/" + aMas;

     |CARGA_DEF aDef, tempora0@;

     nHay = 0;

     |ABRE #900;
     #900#0 = #0#0;
     #900#1 = nContri;
     #900#2 = 1;
     |LEE 000#900];
     |SI FSalida = 0;  |Y #900#0 = #0#0;  |Y #900#1 = nContri;
         nHay = 1;
     |FINSI;
     |CIERRA #900;

     |DESCARGA_DEF #tempora0@;

     |SI nHay = 0;  |ACABA;  |FINSI;

     nConta = nConta + 1;

     |SI aClave = "RT";  aAlfa = nConta + ":Rendimientos del trabajo {{RT}}";  |FINSI;
     |SI aClave = "RC";  aAlfa = nConta + ":Actividades econ¢micas {{RC}}";    |FINSI;
     |SI aClave = "PF";  aAlfa = nConta + ":Pagos fraccionados de empresas y profesionales {{PF}}";    |FINSI;
     |SI aClave = "CB";  aAlfa = nConta + ":Cuentas bancarias {{CB}}";         |FINSI;
     |SI aClave = "RE";  aAlfa = nConta + ":Rendimientos expl¡citos del capital mobiliario {{RE}}";  |FINSI;
     |SI aClave = "DN";  aAlfa = nConta + ":Donaciones y aportaciones a patrimonio de persona con discapacidad {{DN}}";  |FINSI;
     |SI aClave = "TV";  aAlfa = nConta + ":Ventas de activos financieros y otros valores mobiliarios {{TV}}";  |FINSI;
     |SI aClave = "SG";  aAlfa = nConta + ":Rendimientos de operaciones de seguros {{SG}}";  |FINSI;
     |SI aClave = "CT";  aAlfa = nConta + ":Cotizaciones a reg¡menes especiales de la seguridad social y convenios especiales {{CT}}";  |FINSI;
     |SI aClave = "UR";  aAlfa = nConta + ":Informaci¢n catastral de inmuebles {{UR}}";  |FINSI;
     |SI aClave = "AR";  aAlfa = nConta + ":Arrendamientos de inmuebles {{AR}}";  |FINSI;
     |SI aClave = "PH";  aAlfa = nConta + ":Pr‚stamos y cr‚ditos relacionados con bienes inmuebles {{PH}}";  |FINSI;
     |SI aClave = "DM";  aAlfa = nConta + ":Deducci¢n por maternidad {{DM}}";  |FINSI;
     |SI aClave = "PP";  aAlfa = nConta + ":Aportaciones y contribuciones a sistema de previsi¢n social {{PP}}";  |FINSI;
     |SI aClave = "IP";  aAlfa = nConta + ":Otras subvenciones,auxilios y ayudas satisfechos por las administraciones p£blicas {{IP}}";  |FINSI;
     |SI aClave = "AG";  aAlfa = nConta + ":Subvenciones e indemnizaciones satisfechas a agricultores, ganaderos o forestales {{AG}}";  |FINSI;
     |SI aClave = "FI";  aAlfa = nConta + ":Ventas de fondos de inversi¢n con retenci¢n {{FI}}";  |FINSI;

     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Consulta1;
     nCampo = 1;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga1;
     nContri = 1;
     nCampo  = 1;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar1;
     nCampo  = 1;
     nContri = 1;
     aContri = "TITULAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta2;
     nCampo = 5;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga2;
     nContri = 2;
     nCampo  = 5;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar2;
     nCampo  = 5;
     nContri = 2;
     aContri = "CONYUGE";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta3;
     nCampo = 9;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga3;
     nContri = 3;
     nCampo  = 9;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar3;
     nCampo  = 9;
     nContri = 3;
     aContri = "1 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta4;
     nCampo = 13;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga4;
     nContri = 4;
     nCampo  = 13;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar4;
     nCampo  = 13;
     nContri = 4;
     aContri = "2 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta5;
     nCampo = 17;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga5;
     nContri = 5;
     nCampo  = 17;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar5;
     nCampo  = 17;
     nContri = 5;
     aContri = "3 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO Consulta6;
     nCampo = 21;  |HAZ PaginaConsulta;
|FPRC;

|PROCESO Descarga6;
     nContri = 6;
     nCampo  = 21;
     |HAZ Descarga;
|FPRC;

|PROCESO Procesar6;
     nCampo  = 21;
     nContri = 6;
     aContri = "4 FAMILIAR";

     |HAZ Procesar;
|FPRC;

|PROCESO  rem00101;
     nConta    = nConta + 1;
     |SI nConta > 4;  |ERROR10;  |ACABA;  |FINSI;

     Cadena   = #101#3;   |HAZ SeparaNombre;

     nCampo   = nConta + (5 + (nConta * 3));
     #0nCampo = #101#2;

     nCampo   = nCampo + 1;
     #0nCampo = Cadena1;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     13;
     #100#0,  1, "S";
     #100#0, 99, "S";
     ;
     NULL, rem00101;
|FIN;


|PROCESO CargaCampos;
     |ABRE #100;
     #100#0 = #0#0;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #100;

     #0#1  = #100#1;
     #0#2  = #100#2;

     #0#5  = #100#35;
     #0#6  = #100#36;

     #0#10 = "";
     #0#11 = "";
     #0#14 = "";
     #0#15 = "";
     #0#18 = "";
     #0#19 = "";
     #0#22 = "";
     #0#23 = "";

     nConta = 0;
     |BUCLE rem00101;

     |PARA nCampo = 2;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 4;
           nCampo1 = nCampo + 1;
           |C_M #0nCampo1, 1, "S";

           aAlfa = #0nCampo;  |QBF aAlfa;
           |SI aAlfa = "";
               |C_M #0nCampo1, 1, "N";

               nCampo1   = nCampo + 2;
               #0nCampo1 = "No existe";
           |FINSI;
     |SIGUE;

     |HAZ EnciendeBotones;
|FPRC;

|PROCESO Tipo12;   |TIPO 12;
|FPRC;

|PROGRAMA;
     |VENTANA 0501, 2595, -1, 16, "Recogida datos fiscales";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa    = PARAMETRO % 105;
     nEmpresa = aAlfa;
     aAlfa    = PARAMETRO % 601;
     nModo    = aAlfa;


     |HAZ LeeUnidadBasico;
     aDirLocal = eaUnidadBasico + "\AEAT";   |RMKDIR  aDirLocal;
     aDirLocal = aDirLocal + "\Renta2009";   |RMKDIR  aDirLocal;
     aDirLocal = aDirLocal + "\";

     |DBASE aBase;
     aDirServidor = aBase + "web";  |MKDIR aDirServidor;
     aDirServidor = aDirServidor + "/";

     |ABRE #0;
     #0#0 = nEmpresa;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = nEmpresa;
         |GRABA 020#0b;
     |FINSI;

     |PINPA #0#0;    nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1002, 1017, Consulta1;
     nBoton1_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 1019, 1032, Descarga1;
     nBoton1_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1034, 1047, Procesar1;
     nBoton1_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1050, 1065, Consulta2;
     nBoton2_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 1067, 1080, Descarga2;
     nBoton2_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1082, 1095, Procesar2;
     nBoton2_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1702, 1717, Consulta3;
     nBoton3_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 1719, 1732, Descarga3;
     nBoton3_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1734, 1747, Procesar3;
     nBoton3_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 1750, 1765, Consulta4;
     nBoton4_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 1767, 1780, Descarga4;
     nBoton4_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 1782, 1795, Procesar4;
     nBoton4_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 2402, 2417, Consulta5;
     nBoton5_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descarga", 2419, 2432, Descarga5;
     nBoton5_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 2434, 2447, Procesar5;
     nBoton5_3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Consulta en web", 2450, 2465, Consulta6;
     nBoton6_1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{228}}Descargar", 2467, 2480, Descarga6;
     nBoton6_2 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Procesar", 2482, 2495, Procesar6;
     nBoton6_3 = FSalida;

     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";

     |ESTADO_CONTROL nBoton2_1, "DISABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_3, "DISABLE";

     |ESTADO_CONTROL nBoton3_1, "DISABLE";
     |ESTADO_CONTROL nBoton3_2, "DISABLE";
     |ESTADO_CONTROL nBoton3_3, "DISABLE";

     |ESTADO_CONTROL nBoton4_1, "DISABLE";
     |ESTADO_CONTROL nBoton4_2, "DISABLE";
     |ESTADO_CONTROL nBoton4_3, "DISABLE";

     |ESTADO_CONTROL nBoton5_1, "DISABLE";
     |ESTADO_CONTROL nBoton5_2, "DISABLE";
     |ESTADO_CONTROL nBoton5_3, "DISABLE";

     |ESTADO_CONTROL nBoton6_1, "DISABLE";
     |ESTADO_CONTROL nBoton6_2, "DISABLE";
     |ESTADO_CONTROL nBoton6_3, "DISABLE";

     |HAZ CargaCampos;
     |PINDA #0#0;

     |ENDATOS #1#0;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRO;
