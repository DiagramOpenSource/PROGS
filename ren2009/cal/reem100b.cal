|FICHEROS;
   reem100a #0;
   reacceso #5;

   rem00100 #10;
   rem00101 #11;
   rem00102 #12;
   rem01001 #13;
   rem01002 #14;

   rerenpre #20;
   reauxpai #21;

   rem01033 #50;
   rem01037 #51;
   rem01045 #52;
   rem01035 #53;
   rem01046 #54;
   rem01047 #55;
   rem01041 #56;
   rem01042 #57;
   rem01043 #58;
   rem01010 #59;
   rem01011 #60;
   rem01012 #61;
   rem01013 #62;
   rem01014 #63;
   rem01015 #64;
   rem01019 #65;
   rem01021 #66;
   rem01022 #67;
   rem01023 #68;
   rem01024 #69;
   rem01025 #70;
   rem01026 #71;
   rem01027 #72;
   rem01030 #73;
   rem01031 #74;
   rem01032 #75;
   rem01039 #76;

   &poblaci@ #703;
   Referen@ #1000;
|FIN;

|VARIABLES;
   &enEmpresa  = 0;
   &enEmpr     = 0;
   &eaTipo     = "";
   &eaNif      = "";
   &eaCRLF     = "";
   &enPagina   = 0;
   &enConDatos = 0;
   &enNumPags  = 0;
   &enHandle   = 0;
   &enSwFalle  = 0;

   &DiaInf    = "";
   MesNum     = "";
   &MesInf    = "";
   &EjerInf   = "";
   &enCodProv = 0;
   &enCodPobl = 0;
   &eaIP      = "";

   VEmpresa  = 0;
   Long      = 0;
   LongDec   = 0;
   nSwDatos  = 0;
   SwDatos   = 0;
   nSwPasa   = 0;
   nCharGrabados = 0;
   nTitul    = 0;
   nEmpr     = 0;
   nCont10   = 0;
   nCont     = 0;
   nCont1    = 0;
   nContC    = 0;
   nContCs   = 0;
   nConta    = 0;
   nContCas  = 0;
   nContRegs = 0;
   nCalc     = 0;
   nCalc1    = 0;
   nCalc2    = 0;
   Calc1     = 0;
   Calc2     = 0;
   nConCta   = 0;
   Bloque    = 0;
   SwError   = 0;
   nPYG      = 0;
   nApartados= 0;
   nDCampo   = 0;
   nHCampo   = 0;
   nVuelta   = 0;
   nDat      = 0;
   nTotal    = 0;
   nSusp     = 0;
   nNumFam   = 0;
   nNumPag   = 0;
   nPagAct   = 0;
   nHijosTit = 0;
   nHijosCon = 0;
   nLong     = 0;
   nPos      = 0;
   SwSalir   = 0;
   nETAct    = 0;
   nEnAct    = 0;
   nNoHay1   = 0;
   nPag      = 0;
   nNumLin   = 0;
   nNumLin1  = 0;
   nNumLin2  = 0;
   nNumLin3  = 0;
   nNumLin4  = 0;
   nNumLinAnt= 0;
   nSwFiltraBarra = 0;

   aLong     = "";
   Casilla   = "";
   VTipo     = "";
   aTipo     = "";
   aTipo2    = "";
   aNif      = "";
   Nombre    = "";
   Comodin   = "";
   Cadena    = "";
   Cadena1   = "";
   Cadena2   = "";
   Cadena3   = "";
   Cadena4   = "";
   aFicheros = "";
   aCasillas = "";
   aDCasilla = "";
   aHCasilla = "";
   aCampos   = "";
   Vacio1    = "";
   Vacio2    = "";

   aAlfa     = "";
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   aAlfa4    = "";
   aAlfaC1   = "";
   aAlfaC2   = "";
   aCDoc     = "";
   aPDec     = "";

   TipoDato  = "";

   aNif1      = ""; aNif2      = "";
   aNombre1  = "";  aNombre2   = "";
   aApell11   = ""; aApell12   = "";
   aApell21   = ""; aApell22   = "";
   aC1        = ""; aC2        = "";
   aSg1       = ""; aSg2       = "";
   aCalle1    = ""; aCalle2    = "";
   aNumero1   = ""; aNumero2   = "";
   aEscalera1 = ""; aEscalera2 = "";
   aPiso1     = ""; aPiso2     = "";
   aPuerta1   = ""; aPuerta2   = "";
   aLocali1   = ""; aLocali2   = "";
   aLocalB1   = ""; aLocalB2   = "";
   aCP1       = ""; aCP2       = "";
   aProvin1   = ""; aProvin2   = "";
   aEC1       = ""; aEC2       = "";
   aAnyoN1    = ""; aAnyoN2    = "";
   aSexo1     = ""; aSexo2     = "";
   aMovil1    = ""; aMovil2    = "";
   aNivRe     = "";
   aSMS1      = ""; aSMS2      = "";
   aFAdoH     = ""; aFNacH     = "";
   aFNac1     = ""; aFNac2     = "";
   aCodPais1  = ""; aCodPais2  = "";
   aMinusval1 = ""; aMinusval2 = "";
   aTelef1    = ""; aTelef2    = "";
   aIglesia1  = ""; aIglesia2  = "";
   aEntidad1  = ""; aEntidad2  = "";
   aSucursal1 = ""; aSucursal2 = "";
   aDC1       = ""; aDC2       = "";
   &aCuenta1  = ""; &aCuenta2   = "";
   aDom2P     = ""; aFra2P     = "";
   aRen2P     = ""; &aSeparada = "";

   aFax1      = ""; aFax2      = "";
   aTipNum1   = ""; aTipNum2   = "";
   aCalNum1   = ""; aCalNum2   = "";
   aDatComp1  = ""; aDatComp2  = "";
   aBloque1   = ""; aBloque2   = "";
   aPortal1   = ""; aPortal2   = "";
   aDomExtr1  = ""; aDomExtr2  = "";
   aDtCmpEx1  = ""; aDtCmpEx2  = "";
   aPoblExt1  = ""; aPoblExt2  = "";
   aEmailExt1 = ""; aEmailExt2 = "";
   aCPExt1    = ""; aCPExt2    = "";
   aEstExt1   = ""; aEstExt2   = "";
   aPaisExt1  = ""; aPaisExt2  = "";
   aCdPaisEx1 = ""; aCdPaisEx2 = "";
   aTlfExtr1  = ""; aTlfExtr2  = "";
   aFaxExtr1  = ""; aFaxExtr2  = "";
   aMovExtr1  = ""; aMovExtr2  = "";
   aNifDc1    = ""; aNifDc2    = "";
   aCambioDom1 = ""; aCambioDom2 = "";
   aEstCiv    = "";

   aNifH  = ""; aNombH = "";
   aAnyoH = ""; aMinuH = "";
   aVincH = ""; aOtroH = "";

   nOrdenFall1 = 0;
   aFechaFall1 = "";
   nOrdenFall2 = 0;
   aFechaFall2 = "";

   aFamil  = "";

   aNom   = "";
   aApel1 = "";
   aApel2 = "";
   aTipoContrB = "";
   nInd   = 0;
   nNegativo = 0;
   nCambia   = 0;

   {10}aColF = "";
   {10}aTit = "";
   {10}aPc1 = "";
   {10}aPc2 = "";
   {10}aRfC = "";
   {10}aSit = "";
   {10}aPc1b = "";
   {10}aPc2b = "";

   {12}nDescend = 0;
   {4}nAscend   = 0;
|FIN;

|PROCESO TipoContrB;
   |QBF aAlfa;
   |SI aAlfa = ""; aTipoContrB = "0"; |ACABA; |FINSI;
   |SI aSeparada = "S";
     aTipoContrB = "2";
   |SINO;
      aTipoContrB = "0";
      |SI aAlfa = "TITULAR";   aTipoContrB = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         |SI enSwFalle = 1;
            aTipoContrB = "2";
         |SINO;
            |SI VTipo = "CONYUGE      ";aTipoContrB = "2"; |SINO;aTipoContrB = "3"; |FINSI;
         |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContrB = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContrB = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContrB = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContrB = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContrB = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContrB = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContrB = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContrB = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContrB = "2"; |FINSI;
   |FINSI;
|FPRC;

|PROCESO Epigrafe;
   |QBF aAlfa;
   |SI aAlfa = "9999"; aAlfa = ""; |FINSI;
   aLong = aAlfa % 0; nLong = aLong;

   |SI nLong = 4;
      aAlfa = (aAlfa % 0103) + "." + (aAlfa % 0401);
   |FINSI;
|FPRC;

|PROCESO CargaFecha;
  DiaInf   = #0#33 % 102;
  MesNum   = #0#33 % 402;
  MesInf   = #0#33 % 402;
  EjerInf  = #0#33 % -104;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

  MesInf = MesInf > MesInf;
|FPRC;

|PROCESO FormateoB;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |QBF aAlfa;
      |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
      |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         ||SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         ||SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI nSwFiltraBarra = 1;
            |SI aAlfa1 = "/"; aAlfa1 = ".";    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa4 = &128;
         |SI aAlfa1 = aAlfa4; aAlfa1 = "Ç";   |VETE Sigue1; |FINSI;
         aAlfa4 = &135;
         |SI aAlfa1 = aAlfa4; aAlfa1 = "ç";   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "/";                  |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO BuscaPais;
   |ABRE #reauxpai;
   #reauxpai#0 = aAlfa;
   |LEE 000#reauxpai.=;
   |SI FSalida = 0;
      aAlfa = #reauxpai#2;
   |SINO;
      aAlfa = "   ";
   |FINSI;
   |CIERRA #reauxpai;
|FPRC;

|PROCESO SeparaNombre;
   aNom = ""; aApel1 = ""; aApel2 = "";
   nInd = 1;
   aLong = aAlfa % 0; nLong = aLong;
   aAlfa1 = "";
   |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
      nPos = (nCalc * 100) + 1;
      aAlfa2 = aAlfa % nPos;
      |SI aAlfa2 = " "; |O aAlfa2 = ",";
         |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
          |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
          |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
          |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
          |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "del";
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
             nInd = nInd + 1;
         |SINO;
            |SI nInd > 1; nInd = nInd - 1; |FINSI;
            |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
            |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
            |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
         |FINSI;
         aAlfa1 = "";
      |SINO;
         aAlfa1 = aAlfa1 + aAlfa2;
      |FINSI;
   |SIGUE;

   |PARA; |SI SwSalir = 0; |HACIENDO;
      SwSalir = 1;
      aAlfa1 = aApel1 % 0101;
      |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aApel2 % 0101;
      |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
      aAlfa1 = aNom   % 0101;
      |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
   |SIGUE;
|FPRC;

|PROCESO BuscaDatoB;
   #rem01002#0 = nEmpr;
   #rem01002#1 = " ";
   #rem01002#2 = aTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       Casilla = #rem01002#6;
       SwError = 0;
   |SINO;
       Casilla = 0; SwError = 1;
   |FINSI;
|FPRC;

|PROCESO BuscaCasillaB;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       Casilla = #rem01002#6;
       SwError = 0;
   |SINO;
       Casilla = 0; SwError = 1;
   |FINSI;
|FPRC;

|PROCESO GrabaVector;
   nCharGrabados = 0;
   enEmpr = VEmpresa; eaTipo = VTipo;

   |PARA nContC = 1; |SI nContC [ 21; |HACIENDO nContC = nContC + 1;
      enPagina = nContC; |HAZ MiraObligatoria;
      |SI enConDatos = 1;
         |PARA; |SI enNumPags > 0; |HACIENDO enNumPags = enNumPags - 1;
            Cadena = ("000" + nContC) % -103; nCharGrabados = nCharGrabados + 3;
            |HAZ GrabaCadB; Cadena = "";
         |SIGUE;
      |FINSI;
   |SIGUE;

   Cadena = "FIN"; |HAZ GrabaCadB; Cadena = "";
   nCharGrabados = nCharGrabados + 3;

   |PARA; |SI nCharGrabados < 290; |HACIENDO nCharGrabados = nCharGrabados + 10;
      Cadena = " " * 10; |HAZ GrabaCadB;
   |SIGUE;

   nCalc = 300 - nCharGrabados;
   Cadena = " " * nCalc; |HAZ GrabaCadB;
|FPRC;

|PROCESO GrabaCadB;
   |XGRABA enHandle, Cadena; Cadena = "";
|FPRC;

|PROCESO RecogeFam;
   |SI #rem00101#4 = "DESCENDIENTE";
      nDescend = #rem00101#1; InDescend = InDescend + 1;
      |SI #rem00101#16 = "X"; |O #rem00101#16 = "Z";
         aCDoc = "1";
      |FINSI;
      |SI #rem00101#16 = "D"; |O #rem00101#16 = "Z";
         aPDec = "1";
      |FINSI;
   |SINO;
      nAscend = #rem00101#1;  InAscend = InAscend + 1;
   |FINSI;
|FPRC;

|DEFBUCLE RecogeFam;
#rem00101#1;
;
#rem00100#0,01;
#rem00100#0,99;
;
NULL,RecogeFam;
|FIN;

|PROCESO CargaDatos;
   aAlfa = VTipo; |QBF aAlfa;

   aSMS1      = ""; aSMS2      = "";
   aNif1      = ""; aNif2      = "";
   aApell11   = ""; aApell12   = "";
   aApell21   = ""; aApell22   = "";
   aC1        = ""; aC2        = "";
   aSg1       = ""; aSg2       = "";
   aCalle1    = ""; aCalle2    = "";
   aNumero1   = ""; aNumero2   = "";
   aEscalera1 = ""; aEscalera2 = "";
   aPiso1     = ""; aPiso2     = "";
   aPuerta1   = ""; aPuerta2   = "";
   aLocali1   = ""; aLocali2   = "";
   aLocalB1   = ""; aLocalB2   = "";
   aCP1       = ""; aCP2       = "";
   aProvin1   = ""; aProvin2   = "";
   aEC1       = ""; aEC2       = "";
   aAnyoN1    = ""; aAnyoN2    = "";
   aFNac1     = ""; aFNac2     = "";
   aSexo1     = ""; aSexo2     = "";
   aCodPais1  = "";  aCodPais2  = "";
   aMinusval1 = "0"; aMinusval2 = "";
   aTelef1    = "";  aTelef2    = "";
   aIglesia1  = "";  aIglesia2  = "";
   aMovil1    = "";  aMovil2    = "";

   aFax1      = "";  aFax2      = "";
   aTipNum1   = "";  aTipNum2   = "";
   aCalNum1   = "";  aCalNum2   = "";
   aDatComp1  = "";  aDatComp2  = "";
   aBloque1   = "";  aBloque2   = "";
   aPortal1   = "";  aPortal2   = "";
   aDomExtr1  = "";  aDomExtr2  = "";
   aDtCmpEx1  = "";  aDtCmpEx2  = "";
   aPoblExt1  = "";  aPoblExt2  = "";
   aEmailExt1 = "";  aEmailExt2 = "";
   aCPExt1    = "";  aCPExt2    = "";
   aEstExt1   = "";  aEstExt2   = "";
   aPaisExt1  = "";  aPaisExt2  = "";
   aCdPaisEx1 = "";  aCdPaisEx2 = "";
   aTlfExtr1  = "";  aTlfExtr2  = "";
   aFaxExtr1  = "";  aFaxExtr2  = "";
   aMovExtr1  = "";  aMovExtr2  = "";

   aCambioDom1 = ""; aCambioDom2 = "";

   aAlfa1 = aAlfa - " FAMILIAR";
   |SI FSalida ! 0;
      aFamil = "S";
      |QBF aAlfa1; nCalc = aAlfa1;
      #rem00101#0 = #rem00100#0;
      #rem00101#1 = 1;
      |LEE 000#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
         |SI #rem00101#13 = "S";
            nCalc = nCalc - 1;
            |SI nCalc = 0;
               |SI #rem00101#6 < 33; aMinusval1 = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "N"; aMinusval1 = 1; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "S"; aMinusval1 = 2; |FINSI;
               |SI #rem00101#6 ] 65; aMinusval1 = 3; |FINSI;
               enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
               aNif1 = #rem00101#2;
               aAlfa = #rem00101#3; |HAZ SeparaNombre;
               aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
               aC1        = #rem00101#16;   aSg1     = #rem00100#14;
               aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
               aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
               aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
               aLocalB1   = #rem00100#119;
               aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
               aProvin1 = #703#2;
               aEC1       = "S";            aAnyoN1  = #rem00101#5;
               aFNac1     = #rem00101#17;   aSexo1   = #rem00101#20;
               aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
               aIglesia1  = #rem00100#59;   aCuenta1 = #rem00101#10;
               aMovil1    = #rem00100#109;  aSMS1     = #rem00100#111;
               aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
               aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
               aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
               aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
               aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
               aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
               aPaisExt1  = #rem00100#127;
               |SI #rem00101#16 = "X";
                  aCambioDom1 = "S";
               |SINO;
                  aCambioDom1 = "N";
               |FINSI;
               |ABRE #reauxpai;
               #reauxpai#0 = #rem00100#126;
               |LEE 000#reauxpai.=;
               |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
               |CIERRA #reauxpai;
               aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
               aMovExtr1  = #rem00100#109;
            |SINO;
               |LEE 000#rem00101.s;
            |FINSI;
         |SINO;
            |LEE 000#rem00101.s;
         |FINSI;
      |SIGUE;

      aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
      aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;

      |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
      |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
      |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
      |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
      |ACABA;
   |SINO;
      aFamil = "N";
   |FINSI;

   |SI aAlfa = "TITULAR"; |O aAlfa = "CONJUNTA";
      |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
      enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
      aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
      aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
      aC1        = #rem00100#100;  aSg1     = #rem00100#14;
      aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
      aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
      aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
      aLocalB1   = #rem00100#119;
      aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
      aProvin1 = #703#2;
      aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
      aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
      aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
      aIglesia1  = #rem00100#59;   aMovil1  = #rem00100#109;
      aSMS1      = #rem00100#111;
      aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
      aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
      aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
      aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
      aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
      aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
      aPaisExt1  = #rem00100#127;
      aCambioDom1 = #rem00100#145;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#126;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
      aMovExtr1  = #rem00100#109;
      |SI aAlfa = "TITULAR";  aCuenta1  = #rem00100#53; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta1  = #rem00100#55; |FINSI;

      |SI #rem00100#41 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval2 = 3; |FINSI;
      enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
      aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
      aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
      aC2        = #rem00100#101;  aSg2     = #rem00100#44;
      aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
      aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
      aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
      aLocalB2   = #rem00100#136;
      aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aProvin2   = #703#2;         aAnyoN2   = #rem00100#40;
      aFNac2     = #rem00100#104;  aCodPais2 = #rem00100#108;
      aTelef2    = #rem00100#13;   aSexo2 = #rem00100#106;
      aIglesia2  = #rem00100#60;   aMovil2  = #rem00100#110;
      aSMS2      = #rem00100#128;
      aFax2      = #rem00100#129;  aTipNum2   = #rem00100#131;
      aCalNum2   = #rem00100#132;  aDatComp2  = #rem00100#118;
      aBloque2   = #rem00100#133;  aPortal2   = #rem00100#117;
      aDomExtr2  = #rem00100#137;  aDtCmpEx2  = #rem00100#138;
      aPoblExt2  = #rem00100#139;  aEmailExt2 = #rem00100#123;
      aCPExt2    = #rem00100#141;  aEstExt2   = #rem00100#142;
      aPaisExt2  = #rem00100#144;  aCambioDom2 = #rem00100#146;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#143;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr2  = #rem00100#13;   aFaxExtr2  = #rem00100#129;
      aMovExtr2  = #rem00100#110;
      |SI aAlfa = "TITULAR";  aCuenta2  = #rem00100#54; |FINSI;
      |SI aAlfa = "CONJUNTA"; aCuenta2  = #rem00100#55; |FINSI;

      |SI #rem00100#91 = "C";
         aEC1 = "V";
         aNif2      = "";   aNombre2 = "";
         aApell21   = "";   aApell22 = "";
         aC2        = "";   aSg2     = "";
         aCalle2    = "";   aNumero2 = "";
         aEscalera2 = "";   aPiso2   = "";
         aPuerta2   = "";   aLocali2 = "";
         aCP2       = "";   aSexo2   = "";
         aProvin2   = "";   aAnyoN2   = "";
         aFNac2     = "";   aCodPais2 = "";
         aMinusval2 = "0";  aTelef2   = "";
         aMovil2    = ""; aFax2 = "";
         aTipNum2   = "";   aCalNum2   = "";
         aDatComp2  = "";   aBloque2   = "";
         aPortal2   = "";   aDomExtr2  = "";
         aDtCmpEx2  = "";   aPoblExt2  = "";
         aEmailExt2 = "";   aCPExt2    = "";
         aEstExt2   = "";   aPaisExt2  = "";
         aCdPaisEx2 = "";   aTlfExtr2  = "";
         aFaxExtr2  = "";   aMovExtr2  = "";
         aCambioDom2 = "";
      |FINSI;
   |FINSI;

   |SI aAlfa = "CONYUGE";
      |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
      |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
      |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
      enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
      aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
      aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
      aC1        = #rem00100#101;  aSg1     = #rem00100#44;
      aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
      aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
      aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
      aLocalB1   = #rem00100#136;
      aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
      aEC1       = #rem00100#6;
      aProvin1   = #703#2;         aAnyoN1  = #rem00100#40;
      aFNac1     = #rem00100#104;  aSexo1   = #rem00100#106;
      aCodPais1  = #rem00100#108;  aTelef1  = #rem00100#13;
      aIglesia1  = #rem00100#60;   aCuenta1   = #rem00100#54;
      aMovil1    = #rem00100#110;  aSMS1      = #rem00100#128;
      aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
      aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#118;
      aBloque1   = #rem00100#133;  aPortal1   = #rem00100#117;
      aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
      aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#123;
      aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
      aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#143;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
      aMovExtr1  = #rem00100#110;
      |SI #rem00100#8 < 33; aMinusval2 = 0; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval2 = 1; |FINSI;
      |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval2 = 2; |FINSI;
      |SI #rem00100#8 ] 65; aMinusval2 = 3; |FINSI;
      enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
      aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
      aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
      aC2        = #rem00100#100;  aSg2     = #rem00100#14;
      aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
      aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
      aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
      aLocalB2   = #rem00100#119;
      aCP2       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
      aProvin2 = #703#2;      aAnyoN2    = #rem00100#7;
      aFNac2     = #rem00100#103;  aCodPais2 = #rem00100#107;
      aTelef2  = #rem00100#12;     aSexo2   = #rem00100#105;
      aIglesia2  = #rem00100#59;   aCuenta2 = #rem00100#53;
      aMovil2    = #rem00100#109;  aSMS2    = #rem00100#111;
      aFax2      = #rem00100#112;  aTipNum2   = #rem00100#114;
      aCalNum2   = #rem00100#115;  aDatComp2  = #rem00100#118;
      aBloque2   = #rem00100#116;  aPortal2   = #rem00100#117;
      aDomExtr2  = #rem00100#120;  aDtCmpEx2  = #rem00100#121;
      aPoblExt2  = #rem00100#122;  aEmailExt2 = #rem00100#123;
      aCPExt2    = #rem00100#124;  aEstExt2   = #rem00100#125;
      aPaisExt2  = #rem00100#127;  aCambioDom2 = #rem00100#145;
      |ABRE #reauxpai;
      #reauxpai#0 = #rem00100#126;
      |LEE 000#reauxpai.=;
      |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
      |CIERRA #reauxpai;
      aTlfExtr2  = #rem00100#12;   aFaxExtr2  = #rem00100#112;
      aMovExtr2  = #rem00100#109;
      |SI #rem00100#91 = "T";
         aEC1 = "V";

         aNif2      = "";   aNombre2 = "";
         aApell21   = "";   aApell22 = "";
         aC2        = "";   aSg2     = "";
         aCalle2    = "";   aNumero2 = "";
         aEscalera2 = "";   aPiso2   = "";
         aPuerta2   = "";   aLocali2 = "";
         aCP2       = "";   aSexo2   = "";
         aProvin2   = "";   aAnyoN2   = "";
         aFNac2     = "";   aCodPais2 = "";
         aMinusval2 = "0";  aTelef2   = "";
         aMovil2    = ""; aFax2 = "";
         aTipNum2   = "";   aCalNum2   = "";
         aDatComp2  = "";   aBloque2   = "";
         aPortal2   = "";   aDomExtr2  = "";
         aDtCmpEx2  = "";   aPoblExt2  = "";
         aEmailExt2 = "";   aCPExt2    = "";
         aEstExt2   = "";   aPaisExt2  = "";
         aCdPaisEx2 = "";   aTlfExtr2  = "";
         aFaxExtr2  = "";   aMovExtr2  = "";
         aCambioDom2 = "";
      |FINSI;
   |FINSI;

   |SI aAlfa = "CONJUNTAE";
      |SI #rem00100#91 = "T";
         |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
         enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
         aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
         aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
         aC1        = #rem00100#101;  aSg1     = #rem00100#44;
         aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
         aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
         aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
         aLocalB1   = #rem00100#136;
         aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
         aEC1       = "V";            aSexo1 = #rem00100#106;
         aProvin1   = #703#2;    aAnyoN1  = #rem00100#40;
         aFNac1     = #rem00100#104;  aCodPais1 = #rem00100#108;
         aTelef1    = #rem00100#13;   aMovil1   = #rem00100#110;
         aIglesia1  = #rem00100#60;   aCuenta1 = #rem00100#54;
         aSMS1      = #rem00100#128;
         aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
         aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#118;
         aBloque1   = #rem00100#133;  aPortal1   = #rem00100#117;
         aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
         aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#123;
         aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
         aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
         |ABRE #reauxpai;
         #reauxpai#0 = #rem00100#143;
         |LEE 000#reauxpai.=;
         |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
         |CIERRA #reauxpai;

         aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
         aMovExtr1  = #rem00100#110;
      |SINO;
         |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
         |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
         |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
         enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
         aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
         aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
         aC1        = #rem00100#100;  aSg1     = #rem00100#14;
         aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
         aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
         aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
         aLocalB1   = #rem00100#119;
         aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
         aProvin1 = #703#2;
         aEC1       = "V";            aAnyoN1  = #rem00100#7;
         aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
         aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
         aIglesia1  = #rem00100#60;   aCuenta1 = #rem00100#53;
         aMovil1    = #rem00100#109;  aSMS1    = #rem00100#111;
         aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
         aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
         aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
         aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
         aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
         aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
         aPaisExt1  = #rem00100#127;  aCdPaisEx1 = #rem00100#126;
         aCambioDom1 = #rem00100#145;
         |ABRE #reauxpai;
         #reauxpai#0 = #rem00100#126;
         |LEE 000#reauxpai.=;
         |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
         |CIERRA #reauxpai;
         aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
         aMovExtr1  = #rem00100#109;
      |FINSI;
      aNif2      = "";   aNombre2 = "";
      aApell21   = "";   aApell22 = "";
      aC2        = "";   aSg2     = "";
      aCalle2    = "";   aNumero2 = "";
      aEscalera2 = "";   aPiso2   = "";
      aPuerta2   = "";   aLocali2 = "";
      aLocalB2   = "";
      aCP2       = "";   aSMS2    = "";
      aProvin2   = "";   aAnyoN2  = "";
      aMinusval2 = "0";  aTelef2  = "";
      aIglesia2  = "";   aCuenta2 = "";
      aMovil2    = "";   aSexo2   = "";
      aFax2      = "";
      aTipNum2   = "";   aCalNum2   = "";
      aDatComp2  = "";   aBloque2   = "";
      aPortal2   = "";   aDomExtr2  = "";
      aDtCmpEx2  = "";   aPoblExt2  = "";
      aEmailExt2 = "";   aCPExt2    = "";
      aEstExt2   = "";   aPaisExt2  = "";
      aCdPaisEx2 = "";   aTlfExtr2  = "";
      aFaxExtr2  = "";   aMovExtr2  = "";
      aCambioDom2 = "";
   |FINSI;

   aAlfa = aCuenta1; |QBF aAlfa; |SI aAlfa = ""; aCuenta1 = "0" * 20; |FINSI;
   aAlfa = aCuenta2; |QBF aAlfa; |SI aAlfa = ""; aCuenta2 = "0" * 20; |FINSI;

   |QBF aTelef1; |QBF aTelef2;

   |SI aC1 = "X"; |O aC1 = "Z";
      |SI aTelef1 = ""; aTelef1 = aTelef2; |FINSI;
   |FINSI;
   |SI aC2 = "X"; |O aC2 = "Z";
      |SI aTelef2 = ""; aTelef2 = aTelef1; |FINSI;
   |FINSI;

   |SI #0#34 = "F";
      |SI aC1 = "X";  |O aC1 = "Z";
         aSg1     = ""; aCalle1  = ""; aNumero1 = ""; aEscalera1 = "";
         aPiso1   = ""; aPuerta1 = ""; aLocali1 = ""; aCP1       = "";
         aProvin1 = "";                aFNac1   = ""; aSexo1     = "";
         aCodPais1  = ""; aMovil1 = "";
      |FINSI;
      |SI aC2 = "X"; |O aC2 = "Z";
         aSg2     = ""; aCalle2  = ""; aNumero2 = ""; aEscalera2 = "";
         aPiso2   = ""; aPuerta2 = ""; aLocali2 = ""; aCP2       = "";
         aProvin2 = ""; aSexo2   = ""; aFNac2   = ""; aCodPais2  = "";
         aMovil2  = "";
      |FINSI;
   |FINSI;

   aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;
   aAlfa = aCodPais2; |HAZ BuscaPais; aCodPais2 = aAlfa;

   TipoDato = "F"; aAlfa = aFNac1; |HAZ FormateoB; aFNac1 = aAlfa;
   TipoDato = "F"; aAlfa = aFNac2; |HAZ FormateoB; aFNac2 = aAlfa;
   TipoDato = "F"; aAlfa = aFNacH; |HAZ FormateoB; aFNacH = aAlfa;
   TipoDato = "F"; aAlfa = aFAdoH; |HAZ FormateoB; aFAdoH = aAlfa;
   |SI aFNac1 = "          "; aFNac1 = "00000000"; |FINSI;
   |SI aFNac2 = "          "; aFNac2 = "00000000"; |FINSI;
   |SI aFNacH = "          "; aFNacH = "00000000"; |FINSI;
   |SI aFAdoH = "          "; aFAdoH = "00000000"; |FINSI;

   |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
   |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
   |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
   |SI aSexo2 = "";  aSexo2 = " "; |FINSI;

   nCambia = 0;
   |SI aSg1 ! aSg2; |O aCalle1 ! aCalle2; |O aNumero1 ! aNumero2;
    |O aEscalera1 ! aEscalera2; |O aPiso1 ! aPiso2; |O aPuerta1 ! aPuerta2;
    |O aLocali1 ! aLocali2;
      nCambia = 1;
   |FINSI;

   aAlfa = VTipo; |QBF aAlfa;
   |SI aAlfa = "CONJUNTA"; |O aAlfa = "CONJUNTAE";
      |SI nCambia = 0;
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
         aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
         aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
         aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
         aCPExt2    = ""; aEstExt2   = "";
         aPaisExt2  = ""; aCdPaisEx2 = "";
         aCambioDom2 = "";
      |FINSI;
   |FINSI;

   |SI aAlfa ! "CONJUNTA"; |Y aAlfa ! "CONJUNTAE";
      aSg2       = ""; aCalle2    = "";
      aNumero2   = ""; aEscalera2 = "";
      aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
      aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
      aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
      aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
      aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
      aCPExt2    = ""; aEstExt2   = "";
      aPaisExt2  = ""; aCdPaisEx2 = "";
   |FINSI;
|FPRC;

|PROCESO Hoja01;
   Cadena = "";
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 000#rem00100.=;
   |SI FSalida = 0;
      |HAZ CargaDatos;
   |FINSI;
   |CIERRA #rem00100;

   LongDec = 0;
   Cadena = "<T10001> ";

   ||TITULAR
   || Nif del primer declarante
   TipoDato = "An"; Long = 9;  aAlfa = aNif1;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell11;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Apellido 2 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell12;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Nombre del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aNombre1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Sexo
   Cadena = Cadena + aSexo1;
   || Estado civil del declarante
   aAlfa = " ";
   |SI aEC1 = "S"; aAlfa = "1"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "C"; aAlfa = "2";               |FINSI;
   |SI aEC1 = "V"; aAlfa = "3"; aSexo2 = " "; |FINSI;
   |SI aEC1 = "L"; aAlfa = "4"; aSexo2 = " "; |FINSI;
   aEstCiv = aAlfa;

   VTipo = eaTipo; aTipo = VTipo % 0110;
   |SI #rem00100#91 = "C"; |Y aAlfa = "2";
      |SI aTipo = "TITULAR   "; |O aTipo = "CONJUNTA  "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = ""; aFax2      = "";
         aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = "";
         aPortal2   = ""; aDomExtr2  = "";
         aDtCmpEx2  = ""; aPoblExt2  = "";
         aEmailExt2 = ""; aCPExt2    = "";
         aEstExt2   = ""; aPaisExt2  = "";
         aCdPaisEx2 = ""; aTlfExtr2  = "";
         aFaxExtr2  = ""; aMovExtr2  = "";
         aCambioDom2 = "";
      |FINSI;
   |FINSI;
   |SI #rem00100#91 = "T"; |Y aAlfa = "2";
      |SI aTipo = "CONYUGE   "; |O aTipo = "CONJUNTAE ";
         aAlfa = "3";
         aNif2      = ""; aApell21   = "";
         aApell22   = ""; aC2        = "";
         aSg2       = ""; aCalle2    = "";
         aNumero2   = ""; aEscalera2 = "";
         aPiso2     = ""; aPuerta2   = "";
         aLocali2   = ""; aCP2       = "";
         aProvin2   = ""; aEC2       = "";
         aAnyoN2    = ""; aFNac2     = "";
         aCodPais2  = ""; aMinusval2 = "";
         aTelef2    = ""; aIglesia2  = "";
         aNombre2   = ""; aSexo2     = " ";
         aMovil2    = ""; aFax2      = "";
         aTipNum2   = ""; aCalNum2   = "";
         aDatComp2  = ""; aBloque2   = "";
         aPortal2   = ""; aDomExtr2  = "";
         aDtCmpEx2  = ""; aPoblExt2  = "";
         aEmailExt2 = ""; aCPExt2    = "";
         aEstExt2   = ""; aPaisExt2  = "";
         aCdPaisEx2 = ""; aTlfExtr2  = "";
         aFaxExtr2  = ""; aMovExtr2  = "";
         aCambioDom2 = "";
      |FINSI;
   |FINSI;

   Cadena = Cadena + aAlfa;
   || Fecha nacimiento
   TipoDato = "F";  Long = 8;  aAlfa = aFNac1;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del declarante
   TipoDato = "N";  Long = 1;  aAlfa = aMinusval1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Suscripcion servicio mensajes SMS
   |SI aSMS1 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Cambio domicilio primer declarante
   |SI aCambioDom1 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Tipo de la via del primer declarante
   TipoDato = "An";  Long = 5;  aAlfa = aSg1;       |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo de la via del primer declarante INE
   Cadena = Cadena + "00000";
   || Nombre de la via del primer declarante
   TipoDato = "An";  Long = 50; aAlfa = aCalle1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Tipo de numeracion del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aTipNum1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Numero del primer declarante
   TipoDato = "N"; Long = 5;  aAlfa = aNumero1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Calificador de numeracion del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aCalNum1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Bloque del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aBloque1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Portal del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPortal1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Escalera del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aEscalera1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Piso del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPiso1;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Puerta del primer declarante
   TipoDato = "An"; Long = 3;  aAlfa = aPuerta1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio del primer declarante
   TipoDato = "An"; Long = 40; aAlfa = aDatComp1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Municipio del primer declarante
   TipoDato = "An"; Long = 30; aAlfa = aLocalB1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo postal del primer declarante
   aAlfa = aCP1; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;
   || Codigo municipio INE
   Cadena = Cadena + "00000";
   |HAZ GrabaCadB;

   || Nombre del municipio
   TipoDato = "An"; Long = 30; aAlfa = aLocali1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo provincia del primer declarante
   aAlfa = aCP1; |QBF aAlfa; aAlfa = aAlfa % 0102;
   aAlfa = ("00" + aAlfa) % -102;                  Cadena = Cadena + aAlfa;
   || Nombre de la provincia del primer declarante
   TipoDato = "An"; Long = 20;  aAlfa = aProvin1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono fijo Titular
   TipoDato = "N";  Long = 9;   aAlfa = aTelef1;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil Titular
   TipoDato = "N";  Long = 9;   aAlfa = aMovil1;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Fax Titular
   TipoDato = "N";  Long = 9;   aAlfa = aFax1;       |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Domicilio extranjero del primer declarante

   TipoDato = "An";  Long = 50;  aAlfa = aDomExtr1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio extranjero del primer declarante
                    Long = 40;  aAlfa = aDtCmpEx1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Poblacion extranjera del primer declarante
                    Long = 30;  aAlfa = aPoblExt1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |HAZ GrabaCadB;

   || E-mail extranjero del primer declarante
                    Long = 99;  aAlfa = aEmailExt1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena = Cadena + " ";
   || Codigo postal extranjero del primer declarante
                    Long = 10;  aAlfa = aCPExt1;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Provincia/region/estado extranjero del primer declarante
                    Long = 30;  aAlfa = aEstExt1;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Pais extranjero del primer declarante
                    Long = 30;  aAlfa = aPaisExt1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo Pais extranjero del primer declarante
   TipoDato = "An"; Long = 2;   aAlfa = aCdPaisEx1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |QBF aPoblExt1; |QBF aEstExt1;
   |SI aPoblExt1 ! ""; |O aEstExt1 ! "";
      || Telefono fijo extranjero del primer declarante
      TipoDato = "A";  Long = 15;  aAlfa = aTlfExtr1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Telefono movil extranjero del primer declarante
                       Long = 15;  aAlfa = aMovExtr1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Fax extranjero del primer declarante
                       Long = 15;  aAlfa = aFaxExtr1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 45);
   |FINSI;
   |HAZ GrabaCadB;

   |PARA nConta = 0; |SI nConta < 10; |HACIENDO nConta = nConta + 1;
      IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
      IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
      IaRfC = aRfC1<-; IaSit = aSit1<-;
      IaTit = IaTit + nConta; IaPc1 = IaPc1 + nConta;
      IaPc2 = IaPc2 + nConta; IaRfC = IaRfC + nConta;
      IaSit = IaSit + nConta; IaColF = IaColF + nConta;
      IaPc1b = IaPc1b + nConta; IaPc2b = IaPc2b + nConta;

      aTit = ""; aPc1 = ""; aPc2 = ""; aRfC = ""; aSit = "";
      aPc1b = ""; aPc2b = ""; aColF = "";
   |SIGUE;

   aTipo = VTipo % 0110; |QBF aTipo; nDat  = 0;
   |ABRE #rem00102;
   #rem00102#0 = VEmpresa;
   #rem00102#1 = 1;
   |LEE 000#rem00102.];
   |PARA; |SI FSalida = 0; |Y #rem00102#0 = VEmpresa; |HACIENDO;
      |SI nDat ] 9; |SAL; |FINSI;

      IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
      IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
      IaRfC = aRfC1<-; IaSit = aSit1<-;
      IaColF = aColF1<-;
      IaTit = IaTit + nDat; IaPc1 = IaPc1 + nDat;
      IaPc2 = IaPc2 + nDat; IaRfC = IaRfC + nDat;
      IaSit = IaSit + nDat; IaColF = IaColF + nDat;
      IaPc1b = IaPc1b + nDat; IaPc2b = IaPc2b + nDat;

      aColF = #rem00102#13;
      aAlfa = aTipo; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
      |SI FSalida ! 0;
         aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - aTipo;
         |SI FSalida ! 0;
            aTit = #rem00102#9; aPc1 = 0; aPc2 = 0; aRfC = #rem00102#11;
            aSit = #rem00102#14;
            nDat = nDat + 1;
         |FINSI;
      |SINO;
         |SI aTipo = "TITULAR"; |O aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4; |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               |SI aTipo = "CONJUNTAE";
                  |SI #rem00100#91 = "C";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50; |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
                  |SI #rem00100#91 = "T";
                     aTit = #rem00102#9;
                     |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100; aPc2 = 0; |FINSI;
                     |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50; |FINSI;
                     |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4; |FINSI;
                     aRfC = #rem00102#11;
                     aSit = #rem00102#14;
                     aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                     |SI FSalida ! 0;
                        aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                     |SINO;
                        nDat = nDat + 1;
                     |FINSI;
                  |FINSI;
               |SINO;
               |DEBUG;
                  ||Hay fallecimiento del titular. Titular individual
                  aTit = #rem00102#9;
                  |SI #rem00102#2 = "TITULAR   "; aPc1 = 100; aPc2 = 0;   |FINSI;
                  |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;              |FINSI;
                  |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#3; aPc2 = #rem00102#4;  |FINSI;
                  aRfC = #rem00102#11;
                  aSit = #rem00102#14;
                  aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
                  |SI FSalida ! 0;
                     aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
                  |SINO;
                     nDat = nDat + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI aTipo = "CONYUGE";
            |SI #rem00100#91 = " ";
               aTit = #rem00102#9;
               |SI #rem00102#2 = "TITULAR   "; aPc1 = 0;   aPc2 = 100; |FINSI;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100; aPc2 = 0;   |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;  aPc2 = 50;  |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4; aPc2 = #rem00102#3;  |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |SINO;
               aTit = #rem00102#9;
               |SI #rem00102#2 = "CONYUGE   "; aPc1 = 100;             |FINSI;
               |SI #rem00102#2 = "GANANCIAL "; aPc1 = 50;              |FINSI;
               |SI #rem00102#2 = "VARIOS    "; aPc1 = #rem00102#4;     |FINSI;
               aRfC = #rem00102#11;
               aSit = #rem00102#14;
               aAlfa = #rem00102#2; |QBF aAlfa; aAlfa = aAlfa - "FAMILIAR";
               |SI FSalida ! 0;
                  aRfC = ""; aTit = ""; aPc1 = ""; aPc2 = ""; aSit = "";
               |SINO;
                  nDat = nDat + 1;
               |FINSI;
            |FINSI;
         |FINSI;
         aPc1b = aPc1; aPc2b = aPc2;
         |SI aTit = "3"; |O aTit = "4";
            aPc1 = 0; aPc2 = 0;
         |FINSI;
      |FINSI;
      |LEE 000#rem00102.s;
   |SIGUE;
   |CIERRA #rem00102;

   nTitul = 0;
   IaTit = aTit1<-; IaPc1 = aPc11<-; IaPc2 = aPc21<-;
   IaRfC = aRfC1<-; IaSit = aSit1<-; IaPc1b = aPc1b1<-; IaPc2b = aPc2b1<-;
   |PARA nConta = 0; |SI nConta < 10; |HACIENDO nConta = nConta + 1;
      LongDec = 0;
      |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE"; || nCalc = aPc1b; |FINSI;
       |O aTipo = "CONJUNTA"; |O aTipo = "VARIOS"; |O aTipo = "CONJUNTAE";
         nCalc = aPc1b + aPc2b;
      |SINO;
         nCalc = aPc1b;
      |FINSI;

      |SI aTit = "1"; |O aTit = "2";
         |SI nCalc = 0; nSwPasa = 0; |SINO; nSwPasa = 1; |FINSI;
      |FINSI;
      |SI aTit = "3"; |O aTit = "4";
         nSwPasa = 1;
      |FINSI;

      |SI nSwPasa = 1;
         nTitul = nTitul + 1;
         || Titularidad X
         TipoDato = "N"; Long = 1;  aAlfa = aTit;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Porcentaje participacion 1 (X)
         LongDec = 2;
         TipoDato = "N"; Long = 3;  aAlfa = aPc1;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Porcentaje participacion 2 (X)
         TipoDato = "N"; Long = 3;  aAlfa = aPc2;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Situacion (clave)
         LongDec = 0;
         TipoDato = "N"; Long = 1;  aAlfa = aSit;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Referencia catastral 1
         TipoDato = "An"; Long = 20; aAlfa = aRfC;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |FINSI;

      |SI nTitul ] 4; |SAL; |FINSI;
      IaTit = IaTit + 1; IaPc1 = IaPc1 + 1; IaPc2  = IaPc2 + 1;
      IaRfC = IaRfC + 1; IaSit = IaSit + 1; IaPc1b = IaPc1b + 1;
      IaPc2b = IaPc2b + 1;
   |SIGUE;

   |PARA; |SI nTitul < 4; |HACIENDO nTitul = nTitul + 1;
      Cadena = Cadena + (("0" * 12) + (" " * 20));
   |SIGUE;

   LongDec = 0;
   |HAZ GrabaCadB;

   ||CONYUGE
   || Nif del conyuge
   TipoDato = "An"; Long = 9;  aAlfa = aNif2;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Apellido 1 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell21;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Apellido 2 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell22;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Nombre del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aNombre2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Sexo conyuge
   Cadena = Cadena + aSexo2;
   || Fecha nacimiento conyuge
   TipoDato = "F";  Long = 8;  aAlfa = aFNac2;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del conyuge
   TipoDato = "N";  Long = 1; aAlfa = aMinusval2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Conyuge no residente y no contribuyente
   |SI #rem00100#102 = "X";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Suscripcion servicio mensajes SMS
   |SI aSMS2 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;
   || Cambio domicilio conyuge
   |SI aCambioDom2 = "S";
      Cadena = Cadena + "1";
   |SINO;
      Cadena = Cadena + "0";
   |FINSI;

   || Tipo de la via del conyuge
   TipoDato = "An";  Long = 5;  aAlfa = aSg2;       |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo de la via INE
   Cadena = Cadena + "00000";
   || Nombre de la via del conyuge
   TipoDato = "A";  Long = 50; aAlfa = aCalle2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Tipo de numeracion del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aTipNum2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Numero del conyuge
   TipoDato = "N"; Long = 5;  aAlfa = aNumero2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Calificador del numero del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aCalNum2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Bloque del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aBloque2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Portal del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPortal2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Escalera del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aEscalera2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Piso del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPiso2;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Puerta del conyuge
   TipoDato = "An"; Long = 3;  aAlfa = aPuerta2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Datos complementarios al domicilio habitual del conyuge
   TipoDato = "An"; Long = 40;  aAlfa = aDatComp2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Municipio del conyuge
   TipoDato = "An"; Long = 30; aAlfa = aLocalB2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo postal del conyuge
   aAlfa = aCP2; |QBF aAlfa; |SI aAlfa = ""; aAlfa = "00000"; |FINSI; Cadena = Cadena + aAlfa;

   || Codigo municipio INE
   Cadena = Cadena + "00000";
   |HAZ GrabaCadB;

   || Municipio del conyuge
   TipoDato = "An"; Long = 30; aAlfa = aLocali2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo provincial del conyuge
   aAlfa = aCP2; aAlfa = aAlfa % 0102; |QBF aAlfa;
   aAlfa = ("00" + aAlfa) % -102;                  Cadena = Cadena + aAlfa;
   || Provincia del conyuge
   TipoDato = "An"; Long = 20; aAlfa = aProvin2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono fijo conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aTelef2;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Telefono movil conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aMovil2;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Telefonos de contacto : Fax conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aFax2;      |HAZ FormateoB; Cadena = Cadena + aAlfa;

   || Domicilio extranjero del conyuge
   TipoDato = "An"; Long = 50;  aAlfa = aDomExtr2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Datos complementarios del domicilio extranjero del conyuge
                    Long = 40;  aAlfa = aDtCmpEx2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Poblacion extranjera del conyuge
                    Long = 30;  aAlfa = aPoblExt2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |HAZ GrabaCadB;

   || E-mail extranjero del conyuge
                    Long = 99;  aAlfa = aEmailExt2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena = Cadena + " ";
   || Codigo postal extranjero del conyuge
                    Long = 10;  aAlfa = aCPExt2;    |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Provincia/region/estado extranjero del conyuge
                    Long = 30;  aAlfa = aEstExt2;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Pais extranjero del conyuge
                    Long = 30;  aAlfa = aPaisExt2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Codigo Pais extranjero del conyuge
                    Long = 2;   aAlfa = aCdPaisEx2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |QBF aPoblExt2; |QBF aEstExt2;
   |SI aPoblExt2 ! ""; |O aEstExt2 ! "";
      || Telefono fijo extranjero del conyuge
                    Long = 15;  aAlfa = aTlfExtr2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Telefono movil extranjero del conyuge
                    Long = 15;  aAlfa = aMovExtr2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Fax extranjero del conyuge
                    Long = 15;  aAlfa = aFaxExtr2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 45);
   |FINSI;
   || RESERVADO AEAT
   Cadena = Cadena + " ";
   |HAZ GrabaCadB;

   |ABRE #rerenpre;
   #rerenpre#0 = #rem00100#65;
   |LEE 000#rerenpre.=;
   |SI FSalida = 0;
      || Representante : Nif
      TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Representante : Apellidos y nombre o razon social
      TipoDato = "An"; Long = 32; aAlfa = #rerenpre#1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 41);
   |FINSI;
   |CIERRA #rerenpre;

   || Fecha y firma de la declaracion : Localidad
   TipoDato = "An"; Long = 20; aAlfa = aLocali1;     |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |HAZ CargaFecha;
   || Fecha y firma de la declaracion : Dia Fecha
   TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Mes Fecha
   TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : A¤o Fecha
   TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |HAZ GrabaCadB;

   || Cuenta bancaria
   |SI #rem01001#11 = "X";
      aAlfa = "0" * 20;
   |SINO;
      aAlfa = aCuenta1;
   |FINSI;
   TipoDato = "N";  Long = 20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Numero justificante
   TipoDato = "N";  Long = 13;  aAlfa = "0";         |HAZ FormateoB; Cadena = Cadena + aAlfa;
   ||Reservado para la AEAT : N§ Referencia PADRE
   aAlfa = " " * 21; Cadena = Cadena + aAlfa;

   || Liquidacion : Resultado a ingresar o a devolver
   Bloque = 41; Casilla = "765"; |HAZ BuscaCasillaB; nTotal = Casilla; SwError = 1;
   |SI nTotal = 0;
      Bloque = 42;     Casilla = "768"; |HAZ BuscaCasillaB; nCalc = Casilla;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 43; Casilla = "769"; |HAZ BuscaCasillaB; nCalc = Casilla;
      |FINSI;
      |SI SwError = 1; |O nCalc = 0;
         Bloque = 39; Casilla = "760"; |HAZ BuscaCasillaB; nTotal = Casilla; SwError = 1;
      |SINO;
         nTotal = #rem01001#16;
      |FINSI;
   |FINSI;
   TipoDato = "N"; Long = 11; LongDec = 2;
   aAlfa = nTotal;                                   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Fraccionamiento del pago
   |SI #rem01001#8 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1; LongDec = 0;           |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Domiciliacion del 2§ plazo
   |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Renuncia a la devolucion
   |SI #rem01001#11 = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "N";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Compensacion entre conyuges
   nSusp = 0;
   Bloque = 42;     Casilla = "768"; |HAZ BuscaCasillaB; nCalc = Casilla;
   |SI SwError = 0; |Y nCalc ! 0; nSusp = 1; |FINSI;
   Bloque = 43;     Casilla = "769"; |HAZ BuscaCasillaB; nCalc = Casilla;
   |SI SwError = 0; |Y nCalc ! 0; |Y nSusp = 0; nSusp = 1; |FINSI;
   aAlfa = nSusp; TipoDato = "N";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;

   || Reservado para la AEAT : Identificacion cliente EEDD
   |SI #reem100a#37 = "S";
      aAlfa = VEmpresa + " " + VTipo;
      TipoDato = "A";  Long = 20;                   |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 20);
   |FINSI;
   || Sello electronico reservado para la AEAT
   Cadena = Cadena + (" " * 13);
   Cadena = Cadena + "</T10001>";
   Cadena = Cadena + eaCRLF; |HAZ GrabaCadB;
|FPRC;

|PROCESO Hoja02;
   Cadena = ""; LongDec = 0;
   VTipo = eaTipo; aTipo = VTipo % 0110;

   Cadena = "<T10002> ";

   || Bucle para la declaracion de hijos y otros descendientes
   aNifDc1 = ""; aNifDc2 = "";

   InAscend = nAscend1<-; InDescend = nDescend1<-;
   |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
      nDescend = 0; InDescend = InDescend + 1;
      |SI nCont [ 4; nAscend = 0; InAscend = InAscend + 1; |FINSI;
   |SIGUE;
   InAscend = nAscend1<-; InDescend = nDescend1<-;
   aCDoc = "0"; aPDec = "0";
   |BUCLE RecogeFam;

   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "rem00101.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      nNumFam = 1;
      aAlfa = "tu" + Usuario; |NOME_DAT #Referen@#aAlfa#;
      |DELINDEX #Referen@; |ABRE #Referen@;
      |SELECT #3#rem00101;
      |DDEFECTO #rem00101;
      #rem00101#0 = #rem00100#0;
      #rem00101#17 = "31.12.9999";
      |LEE 000#rem00101.];
      |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
         |SI #rem00101#4 = "DESCENDIENTE";
            aAlfa = "|NC"; aAlfa = #rem00101#aAlfa#; nCalc = aAlfa;
            |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
               #Referen@#nCont# = #rem00101#nCont#;
            |SIGUE;
            #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
            |GRABA 020#Referen@.n;
         |FINSI;

         |LEE 000#rem00101.s;
      |SIGUE;
      |SELECT #1#rem00101;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;

      |CIERRA #rem00101;
      aAlfa = "tu" + Usuario; |NOME_DAT #rem00101#aAlfa#;
      |ABRE #rem00101;
   |FINSI;

   nOrdenFall1 = 0; aFechaFall1 = "00.00.0000";
   nOrdenFall2 = 0; aFechaFall2 = "00.00.0000";
   aTipo = VTipo; |QBF aTipo;
   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1; nHijosTit = 0; nHijosCon = 0;
      |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         ||#rem00101#1 = nDescend;
         #rem00101#1 = nCont;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;
            aAlfa = #rem00101#2; |QBF aAlfa;
            |SI aAlfa ! ""; |Y #rem00101#7 = " ";
               |SI aNifDc1 = ""; aNifDc1 = aAlfa; |SINO; aNifDc2 = aAlfa; |FINSI;
            |FINSI;
            |SI #rem00101#7 = " ";
               nHijosTit = nHijosTit + 1;
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#7 = "1"; |O #rem00101#7 = "3";
               nHijosTit = nHijosTit + 1;
            |FINSI;
            |SI #rem00101#7 = "2"; |O #rem00101#7 = "4";
               nHijosCon = nHijosCon + 1;
            |FINSI;
            |SI #rem00101#21 ! "01.01.0000";
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosTit
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosTit
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI nOrdenFall1 = 0;
                        aFechaFall1 = #rem00101#21;
                        nOrdenFall1 = nHijosCon;
                     |SINO;
                        |SI nOrdenFall2 = 0;
                           aFechaFall2 = #rem00101#21;
                           nOrdenFall2 = nHijosCon;
                        |FINSI;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
            |SI #rem00101#11 ] 0;
               |SI aTipo = "TITULAR";
                  |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5; |QBF aAnyoH;
                     aVincH = #rem00101#7;  aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ FormateoB; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCadB;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
               |SI aTipo = "CONYUGE";
                  |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                     aAnyoH = #rem00101#5; |QBF aAnyoH;
                     aVincH = #rem00101#7;
                     |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                     aOtroH = #rem00101#8;
                     aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
                     TipoDato = "F";
                     aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
                     aAlfa = aFAdoH; |HAZ FormateoB; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

                     |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;
                     |SI #rem00100#91 ! " ";
                        |SI aVincH = " "; aVincH = "3"; |FINSI;
                     |FINSI;
                     |SI aVincH = "4"; aVincH = "3"; |FINSI;

                     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                     |HAZ GrabaCadB;
                     nCont10 = nCont10 + 1;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
            InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
            #rem00101#0 = #rem00100#0;
            #rem00101#1 = nCont;
            |LEE 000#rem00101.=;
            |SI FSalida = 0; |Y #rem00101#11 ] 0;
               |SI #rem00101#21 ! "01.01.0000";
                  |SI nOrdenFall1 = 0;
                     aFechaFall1 = #rem00101#21;
                     nOrdenFall1 = nCont;
                  |SINO;
                     |SI nOrdenFall2 = 0;
                        aFechaFall2 = #rem00101#21;
                        nOrdenFall2 = nCont;
                     |FINSI;
                  |FINSI;
               |FINSI;
               |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
               |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
               |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
               aNifH  = #rem00101#2;  aNombH = #rem00101#3;
               aAnyoH = #rem00101#5; |QBF aAnyoH;
               aVincH = #rem00101#7;  aOtroH = #rem00101#8;
               |SI #rem00100#91 ! " ";
                  |SI #rem00100#91 = "T"; |SI aVincH = "2"; aVincH = "1"; |FINSI; |FINSI;
                  |SI aVincH = " "; aVincH = "3"; |FINSI;
               |FINSI;
               aFNacH = #rem00101#17; aFAdoH = #rem00101#18;
               TipoDato = "F";
               aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
               aAlfa = aFAdoH; |HAZ FormateoB; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;
               TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
               |HAZ GrabaCadB;
               nCont10 = nCont10 + 1;
            |FINSI;
         |SIGUE;
      |FINSI;

      |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aFNacH = "00000000"; aFAdoH = "00000000";
         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
      |SIGUE;
   |FINSI;

   |CIERRA #rem00101;
   aAlfa = "rem00101"; |NOME_DAT #rem00101#aAlfa#;
   |ABRE #rem00101;

   || Hijos y otros descendientes : Fallecido 2006 - N§ orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fallecido 2006 - N§ orden
   TipoDato = "N"; Long = 2;  aAlfa = nOrdenFall2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Hijos y otros descendientes : Fecha fallecimiento
   TipoDato = "F"; Long = 8;  aAlfa = aFechaFall2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   TipoDato = "A"; Long = 9;  aAlfa = aNifDc1;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
   TipoDato = "A"; Long = 9;  aAlfa = aNifDc2;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || RESERVADO AEAT
   Cadena = Cadena + "                        ";

   || Bucle para la declaracion de ascendientes

   |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI aTipo = "TITULAR"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "1"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2; aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7; aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCadB;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
            |SI aTipo = "CONYUGE"; |Y #rem00101#13 = "N";
               |SI #rem00101#7 = "2"; |O #rem00101#7 = " ";
                  |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
                  |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
                  |SI #rem00101#6 ] 65;  aMinuH = 3; |FINSI;
                  aNifH  = #rem00101#2;  aNombH = #rem00101#3;
                  aAnyoH = #rem00101#5;
                  aVincH = #rem00101#7;
                  |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;
                  aOtroH = #rem00101#9;
                  aNivRe = #rem00101#19; aFNacH = #rem00101#17;
                  TipoDato = "F";
                  aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

                  |SI aEstCiv = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

                  TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
                  |HAZ GrabaCadB;
                  nCont10 = nCont10 + 1;
               |FINSI;
            |FINSI;
         |FINSI;
      |SIGUE;
      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
      |SIGUE;
   |SINO;
      nCont10 = 1;
      |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
         #rem00101#0 = #rem00100#0;
         #rem00101#1 = nAscend;
         |LEE 000#rem00101.=;
         |SI FSalida = 0;  |Y aFamil = "N";
            |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
            |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
            |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;
            aNifH  = #rem00101#2; aNombH = #rem00101#3;
            aAnyoH = #rem00101#5;
            aVincH = #rem00101#7; aOtroH = #rem00101#9;
            aNivRe = #rem00101#19; aFNacH = #rem00101#17;
            TipoDato = "F";
            aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;

            TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
            TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
            TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
            TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
            |HAZ GrabaCadB;
            nCont10 = nCont10 + 1;
         |FINSI;
         aTipo = VTipo; |QBF aTipo;
      |SIGUE;

      |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "0";
         aVincH = ""; aOtroH = "";
         aNivRe = ""; aFNacH = "00000000";

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
      |SIGUE;
   |FINSI;
   |CIERRA #rem00101;

   || Fecha Fallecimiento (en su caso)
   aTipo = VTipo; |QBF aTipo;
   aAlfa = "00000000";
   |SI #rem00100#91 = "T"; |Y aTipo = "TITULAR";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   |SI #rem00100#91 = "C"; |Y aTipo = "CONYUGE";
      aAlfa = #rem00100#92;
      |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
   |FINSI;
   Cadena = Cadena + aAlfa;

   || Tipo de tributacion
   aTipo = VTipo; |QBF aTipo;
   |SI #rem00100#57 = "X";
      aSeparada = "N";
      |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         Cadena = Cadena + "2";
      |SINO;
         Cadena = Cadena + "1";
      |FINSI;
   |SINO;
      aSeparada = "S";
      Cadena = Cadena + "1";
   |FINSI;
   |HAZ GrabaCadB;

   || Comunidad autonoma de residencia
   aAlfa = VTipo; |QBF aAlfa;
   |SI aAlfa = "CONYUGE";
      TipoDato = "N";  Long = 2;  aAlfa = #rem00100#43;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |SINO;
      TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   |FINSI;
   || Sostenimiento de la iglesia catolica
   |SI aIglesia1 = "I"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "O"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Colaboracion en fines sociales
   |SI aIglesia1 = "O"; |O aIglesia1 = "D";
      aAlfa = "X";
   |SINO;
      |SI aIglesia1 = "I"; |O aIglesia1 = " "; aAlfa = ""; |FINSI;
   |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;

   || Solicitudes : Borrador declaracion o datos fiscales (Casilla 110)
   |SI #reem100a#34 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Solicitudes : Envio individualizado borrador (Casilla 111)
   |SI #reem100a#38 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   Cadena = Cadena + aAlfa;
   || Solicitudes . Borrador o datos fiscales del ejercicio 2010 por internet (Casilla 112)
   |SI #reem100a#39 = "S"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
   Cadena = Cadena + aAlfa;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida ! 0; |DDEFECTO #rem01001; |FINSI;

   || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo o complementaria a devolver
   aAlfa = "0000";
   |SI #rem01001#14 = "1"; aAlfa = "1000"; |FINSI;
   |SI #rem01001#14 = "2"; aAlfa = "1100"; |FINSI;
   |SI #rem01001#14 = "3"; aAlfa = "1010"; |FINSI;
   |SI #rem01001#14 = "4"; aAlfa = "0001"; |FINSI;
   Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10002>";
   Cadena = Cadena + eaCRLF; |HAZ GrabaCadB;
|FPRC;

|PROCESO Hoja03;
   enPagina = 3; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10003> ";

   |ABRE #rem01010;
   #rem01010#0 = VEmpresa;
   #rem01010#1 = 0;
   #rem01010#2 = aTipo;
   |LEE 000#rem01010.=;
   |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
   |CIERRA #rem01010;

   TipoDato = "N";  Long = 11;  LongDec = 2;
   || (A) Rendim.trabajo: Ingresos Integros: Ret.Dinerarias : Ingr.Integros
   aAlfa = #rem01010#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Valoracion
   aAlfa = #rem01010#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta
   aAlfa = #rem01010#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta Reperc.
   aAlfa = #rem01010#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.Integros
   aAlfa = #rem01010#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Contrib.Planes Pens. y Prev.Social: Importes
   aAlfa = #rem01010#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Aportaciones al patrimonio protegido de discapacitados
   aAlfa = #rem01010#16;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reducciones especiales: Importe
   aAlfa = #rem01010#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Total ingresos integros computables
   aAlfa = #rem01010#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cotiz.Seg.Social/Mutuas grles.
   aAlfa = #rem01010#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena1 = Cadena; Cadena = "";

   || Rendim.trabajo: Gastos deducibles: Cuotas satisfechas a sindicatos
   aAlfa = #rem01010#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas a colegios profesionales
   aAlfa = #rem01010#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Gastos defensa jurid.derivados litigios con el empleador
   aAlfa = #rem01010#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01010#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01010#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Copa America 2007
   aAlfa = #rem01010#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Cuantia aplicable con caracter general
   aAlfa = #rem01010#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Increm.trab.activos > 65 a¤os
   aAlfa = #rem01010#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Increm.contrib.desempleados con traslado de residencia
   aAlfa = #rem01010#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reduccion obtencio rdtos.trabajo: Reduccion adicional trabajadores activos discapacitados
   aAlfa = #rem01010#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Rendimiento neto reducido
   aAlfa = #rem01010#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena2 = Cadena; Cadena = "";

   |ABRE #rem01012;
   #rem01012#0 = VEmpresa;
   #rem01012#1 = 0;
   #rem01012#2 = aTipo;
   |LEE 000#rem01012.=;
   |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
   |CIERRA #rem01012;

   || (B) Rend.Cap.Mobil: Base imp.ahorro: Int.de cuentas y dep.activos financieros
   aAlfa = #rem01012#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Intereses de activos financieros con derecho a bonificacion
   aAlfa = #rem01012#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Dividendos por part.fondos propios entidades
   aAlfa = #rem01012#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.transm.o amort.Letras del tesoro
   aAlfa = #rem01012#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.transm., amort.o reemb.otros activos financ.
   aAlfa = #rem01012#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.contratos seg.vida o invalidez y oper.cap.
   aAlfa = #rem01012#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rdtos.rentas imposic.capitales u otros rdtos.capital mobiliario a integrar en la B.I.del ahorro
   aAlfa = #rem01012#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Total ingresos integros
   aAlfa = #rem01012#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena3 = Cadena; Cadena = "";

   || Rend.Cap.Mobil: Base imp.ahorro: Gastos fiscalmente deducibles
   aAlfa = #rem01012#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rendimiento neto
   aAlfa = #rem01012#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Reducc.rendtos.contratos de seguro
   aAlfa = #rem01012#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Base imp.ahorro: Rendimiento neto reducido
   aAlfa = #rem01012#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rdtos.arrendamientos bienes inmueb., negocios, minas y subarrendamientos
   aAlfa = #rem01012#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.prestacion asistencia tecnica, salvo actividad economica
   aAlfa = #rem01012#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.propiedad intelectual contribuyente no autor
   aAlfa = #rem01012#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rend.propiedad industrial no afecta a actividad economica
   aAlfa = #rem01012#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Otros Rdtos.del capital mob.a integrar en la B.I.General
   aAlfa = #rem01012#8; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Total ingresos integros
   aAlfa = #rem01012#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Gtos.fiscalmente deducibles
   aAlfa = #rem01012#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Rendimiento neto
   aAlfa = #rem01012#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil.: Base imponible general: Reducc.rdtos.generados en mas de 2 a¤os u obtenidos de forma irregular
   aAlfa = #rem01012#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Base imponible general: Rendimiento neto reducido
   aAlfa = #rem01012#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   Cadena = Cadena + "</T10003>" + eaCRLF;
   Cadena4 = Cadena; Cadena = "";

   |SI nSwDatos = 1;
      Cadena = Cadena1; |HAZ GrabaCadB;
      Cadena = Cadena2; |HAZ GrabaCadB;
      Cadena = Cadena3; |HAZ GrabaCadB;
      Cadena = Cadena4; |HAZ GrabaCadB;
   |FINSI;
|FPRC;

|PROCESO Hoja04;
   enPagina = 4; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10004> ";
   |ABRE #rem01013; |ABRE #rem01011; |ABRE #rem01015;

   || N§ hojas adicionales de inmuebles
   LongDec = 0; TipoDato = "N";
   aAlfa = nNumPag; Long = 2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
   LongDec = 2; nNumPag = nNumPag + 1;

   #rem01011#0 = VEmpresa;
   #rem01011#1 = 0;
   #rem01011#2 = aTipo; aTipo2 = #rem01011#2;
   #rem01011#3 = 0;
   |LEE 000#rem01011.];
   |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
      |DDEFECTO #rem01011;
   |FINSI;

   #rem01015#0 = VEmpresa;
   #rem01015#1 = 0;
   #rem01015#2 = aTipo; aTipo2 = #rem01015#2;
   #rem01015#3 = 0;
   |LEE 000#rem01015.];
   |SI FSalida ! 0; |O #rem01015#0 ! VEmpresa; |O #rem01015#1 ! 0; |O #rem01015#2 ! aTipo2;
      |DDEFECTO #rem01015;
   |FINSI;

   #rem01013#0 = VEmpresa;
   #rem01013#1 = 0;
   #rem01013#2 = aTipo; aTipo2 = #rem01013#2;
   #rem01013#3 = 0;
   |LEE 000#rem01013.];
   |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
      |DDEFECTO #rem01013;
   |FINSI;

   |PARA nPagAct = 1; |SI nPagAct [ nNumPag; |HACIENDO nPagAct = nPagAct + 1;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
            |DDEFECTO #rem01011;
         |FINSI;

         || (C) Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Contribuyente
         aAlfa = #rem01011#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Porcentaje titularidad
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01011#5; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Naturaleza
         Long = 1; LongDec = 0;
         aAlfa = #rem01011#6; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Uso o destino. Clave
         aAlfa = #rem01011#7; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |SI #rem01011#7 = 1; #rem01011#10 = 0; |FINSI;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Situacion
         aAlfa = #rem01011#8; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion y arrendados o cedidos: Inmueble X : Referencia catastral
         TipoDato = "A";  Long = 20;  LongDec = 0;
         aAlfa = #rem01011#9; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Porcentaje disposicion
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01011#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         LongDec = 0;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Numero de dias
         aAlfa = #rem01011#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: A disposicion: Inmueble X : Renta imputada
         Long = 11;  LongDec = 2;
         aAlfa = #rem01011#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Ingresos integros computables
         aAlfa = #rem01011#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Importe pendiente de 2007 aplicable en esta declaracion
         aAlfa = #rem01011#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Importe de 2008 aplicable en esta declaracion
         aAlfa = #rem01011#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Int.Capit.Inv. : Pdte.deducir
         aAlfa = #rem01011#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Otros gtos.fiscalmente deducibles
         aAlfa = #rem01011#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rendimiento neto
         aAlfa = #rem01011#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Reduccion por arrendamiento destinado a vivienda
         aAlfa = #rem01011#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Reduc.rdtos.mas de 2 a¤os o forma irregular
         aAlfa = #rem01011#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rdto.minimo computable en caso de parentesco
         aAlfa = #rem01011#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Arrendado o cedido: Inmueble X : Gtos.deducibles : Rdto.neto reducido
         aAlfa = #rem01011#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |LEE 000#rem01011.s;
         |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
            |DDEFECTO #rem01011;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Bienes inmuebles no afectos: Rentas totales: Suma de rentas inmuebles a disposicion
         Bloque = 4; Casilla = "080"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles no afectos: Rentas totales: Suma de rdtos.reduc.inmuebles arrendados o cedidos
         Bloque = 4; Casilla = "085"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 26);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      || Numero de inmuebles en declaracion conjunta (Reservado para la AEAT)
      Cadena = "000";

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: Contribuyente
         aAlfa = #rem01015#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: NIF de la entidad
         TipoDato = "A";  Long = 9;
         aAlfa = #rem01015#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: Participacion
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01015#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: Naturaleza
         TipoDato = "N";  Long = 1;  LongDec = 0;
         aAlfa = #rem01015#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: Situacion
         aAlfa = #rem01015#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Relacion de inmuebles arrendados o cedidos a terceros: Inmueble X: Referencia catastral
         TipoDato = "A";  Long = 20;
         aAlfa = #rem01015#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |LEE 000#rem01015.s;
         |SI FSalida ! 0; |O #rem01015#0 ! VEmpresa; |O #rem01015#1 ! 0; |O #rem01015#2 ! aTipo2;
            |DDEFECTO #rem01015;
         |FINSI;
      |SIGUE;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (D) Bienes inmuebles urbanos afectos: Inmueble X: Contribuyente
         aAlfa = #rem01013#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Bienes inmuebles urbanos afectos: Inmueble X: Porcentaje titularidad
         TipoDato = "N";  Long = 3;  LongDec = 2;
         aAlfa = #rem01013#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Bienes inmuebles urbanos afectos: Inmueble X: Situacion
         aAlfa = #rem01013#9;  Cadena = Cadena + aAlfa;
         || Bienes inmuebles urbanos afectos: Inmueble X: Referencia catastral
         TipoDato = "A";  Long = 20;  LongDec = 0;
         aAlfa = #rem01013#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |LEE 000#rem01013.s;
         |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
            |DDEFECTO #rem01013;
         |FINSI;
      |SIGUE;

      Cadena = "</T10004>" + eaCRLF; |HAZ GrabaCadB;
      |SI nPagAct < nNumPag;
         Cadena = "<T10004>C00"; |HAZ GrabaCadB; FSalida = 0;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01013; |CIERRA #rem01011;
|FPRC;

|PROCESO Hoja05;
   enPagina = 5; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110; nEnAct = 0;
   Cadena = "<T10005> ";
   |ABRE #rem01014;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;
   TipoDato = "N";  Long = 11;  LongDec = 2;

   nNumPag = 1;

   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo; aTipo2 = #rem01014#2;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
          |Y #rem01014#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (E1-1) Rend.Activ.econ.est.directa : Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01014#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Rend.Activ.econ.est.directa : Actividad X: Clave ident.tipo actividad
         TipoDato = "An"; Long = 1;   LongDec = 0;
         aAlfa = #rem01014#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Modalidad normal o simplificada
         aAlfa = "0";
         |SI #rem01014#8 = "X"; aAlfa = "1"; |FINSI;
         |SI #rem01014#9 = "X"; aAlfa = "2"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Grupo o epigrafe IAE
         Long = 5; aAlfa = #rem01014#7; |HAZ Epigrafe;
         |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Criterio de cobros y pagos
         |SI #rem01014#6 = " "; aAlfa = "0"; |SINO; aAlfa = "1"; |FINSI;
         TipoDato = "A"; Long = 1;    LongDec = 0;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Explotacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01014#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros ingresos
         aAlfa = #rem01014#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Autoconsumo de bienes y servicios
         aAlfa = #rem01014#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Total ingresos computables
         aAlfa = #rem01014#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos consumos explotacion
         aAlfa = #rem01014#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos sueldos y salarios
         aAlfa = #rem01014#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos seguridad social
         aAlfa = #rem01014#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros gastos de personal
         aAlfa = #rem01014#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos arrend.y canones
         aAlfa = #rem01014#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos reparacion y conservacion
         aAlfa = #rem01014#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos servicios profesionales independientes
         aAlfa = #rem01014#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos otros serv.exteriores
         aAlfa = #rem01014#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos tributos fisc.deducibles
         aAlfa = #rem01014#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos financieros
         aAlfa = #rem01014#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos amortizaciones
         aAlfa = #rem01014#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Gastos perdidas por deterioro
         aAlfa = #rem01014#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Incentivos mecenazgo : Convenios
         aAlfa = #rem01014#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Incentivos mecenazgo : Gastos
         aAlfa = #rem01014#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Otros gastos fiscalmente deducibles
         aAlfa = #rem01014#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Suma de gastos
         aAlfa = #rem01014#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.normal : Decl.Actividad X: Provisiones
         aAlfa = #rem01014#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.normal : Decl.Actividad X: Total gastos deducibles
         aAlfa = #rem01014#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Diferencia
         aAlfa = #rem01014#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Provisiones deducc./gastos dificil justif.
         aAlfa = #rem01014#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Modal.Simplif. : Decl.Actividad X: Total gastos deducibles
         aAlfa = #rem01014#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Rendimiento neto
         aAlfa = #rem01014#35; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Reducciones
         aAlfa = #rem01014#36; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Diferencia
         aAlfa = #rem01014#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Reduccion rdtos.reg.esp."Copa America"
         aAlfa = #rem01014#38; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.directa : Decl.Actividad X: Rendimiento neto reducido
         aAlfa = #rem01014#39; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         nEnAct = nEnAct + 1;
         |LEE 000#rem01014.s;
         |SI FSalida ! 0; |O #rem01014#0 ! VEmpresa; |O #rem01014#1 ! 0;
          |O #rem01014#2 ! aTipo2;
            |DDEFECTO #rem01014;
         |FINSI;
      |SIGUE;

      || Rend.Activ.econ.est.directa : Rendimiento neto reducido total
      |SI nEnAct = 3;
         Bloque = 5; Casilla = "136"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

      |SI nEnAct = 3;
         Bloque = 5; Casilla = "137"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

      |SI nEnAct = 3;
         Bloque = 5; Casilla = "138"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

      |SI nEnAct = 3;
         Bloque = 5; Casilla = "140"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

      Cadena = "</T10005>" + eaCRLF; |HAZ GrabaCadB;
      |SI nNumPag < enNumPags;
         Cadena = "<T10005>C0"; |HAZ GrabaCadB; FSalida = 0;
         nNumPag = nNumPag + 1;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01014;
|FPRC;

|PROCESO Hoja06;
   enPagina = 6; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;  nEnAct = 0;
   Cadena = "<T10006> ";
   |ABRE #rem01019;

   nSwFiltraBarra = 1;
   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;

   nNumPag = 1;

   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo; aTipo2 = #rem01019#2;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
          |Y #rem01019#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0; |O #rem01019#2 ! aTipo2; |O nNoHay1 ! 0;
            |DDEFECTO #rem01019;
         |FINSI;
         TipoDato = "An"; LongDec = 0;
         || (E2) Rend.Activ.econ.est.objetiva: Actividad X: Clasificacion IAE
         Long = 5; aAlfa = #rem01019#4; |HAZ Epigrafe;
         |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01019#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 1¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 1¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 1¦
         Long = 9;
         aAlfa = #rem01019#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 2¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 2¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 2¦
         Long = 9;
         aAlfa = #rem01019#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 3¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 3¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 3¦
         Long = 9;
         aAlfa = #rem01019#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 4¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#15;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 4¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 4¦
         Long = 9;
         aAlfa = #rem01019#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 5¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 5¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 5¦
         Long = 9;
         aAlfa = #rem01019#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 6¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#21;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 6¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 6¦
         Long = 9;
         aAlfa = #rem01019#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 7¦
         TipoDato = "A"; Long = 24;   LongDec = 0;
         aAlfa = #rem01019#24;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 7¦
         TipoDato = "N"; Long = 7;   LongDec = 2;
         aAlfa = #rem01019#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 7¦
         Long = 9;
         aAlfa = #rem01019#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendimiento Neto previo
         Long = 11;
         aAlfa = #rem01019#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo al empleo
         aAlfa = #rem01019#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo a la inversion
         aAlfa = #rem01019#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto minorado
         aAlfa = #rem01019#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector especial
         Long = 2; LongDec = 2;
         aAlfa = #rem01019#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector empresas peque¤a dimension
         aAlfa = #rem01019#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector temporada
         aAlfa = #rem01019#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector exceso
         aAlfa = #rem01019#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector inicio nueva actividad
         aAlfa = #rem01019#35; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto de modulos
         Long = 11;
         aAlfa = #rem01019#36; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         || Rend.Activ.econ.est.objetiva: Actividad X: Reduccion de caracter general
         aAlfa = #rem01019#38; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Gastos extraordinarios
         aAlfa = #rem01019#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Otras percepciones empresariales
         aAlfa = #rem01019#40; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Total rendimiento neto
         aAlfa = #rem01019#41; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Reduccion Art.32.1 Ley del impuesto
         aAlfa = #rem01019#42; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.Activ.econ.est.objetiva: Actividad X: Total rendto.neto reducido
         aAlfa = #rem01019#43; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         nEnAct = nEnAct + 1;
         |LEE 000#rem01019.s;
         |SI FSalida ! 0; |O #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0;
          |O #rem01019#2 ! aTipo2;
            |DDEFECTO #rem01019;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 11;   LongDec = 2;
      || Rend.Activ.econ.est.objetiva : Rendimiento neto reducido total : Suma de rendimientos netos reducidos
      |SI nEnAct = 2;
         Bloque = 6; Casilla = "168"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      || Rend.Activ.econ.est.objetiva : Rendimiento neto reducido total : Reduccion por mantenimiento o creacion de empleo
      |SI nEnAct = 2;
         Bloque = 6; Casilla = "169"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      || Rend.Activ.econ.est.objetiva : Rendimiento neto reducido total
      |SI nEnAct = 2;
         Bloque = 6; Casilla = "170"; |HAZ BuscaCasillaB;
      |SINO;
         Casilla = 0;
      |FINSI;
      aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      Cadena = "</T10006>" + eaCRLF; |HAZ GrabaCadB;
      |SI nNumPag < enNumPags;
         Cadena = "<T10006>C0"; |HAZ GrabaCadB; FSalida = 0;
         nNumPag = nNumPag + 1;
      |FINSI;
      Cadena = "";
   |SIGUE;
   nSwFiltraBarra = 0;

   |CIERRA #rem01019;
|FPRC;

|PROCESO Hoja07;
   enPagina = 7; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;  nEnAct = 0;
   Cadena = "<T10007> ";
   |ABRE #rem01021;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;

   || Hecho esto, procedemos a leer registro a registro
   nNumPag = 1;

   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo; aTipo2 = #rem01021#2;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
          |Y #rem01021#2 = aTipo2; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || (E3) Rend.A.G.y F.est.objetiva: Actividad X: Clave de actividad
         TipoDato = "N"; Long = 1;   LongDec = 0;
         aAlfa = #rem01021#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Contribuyente que realiza la actividad
         aAlfa = #rem01021#6;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Rend.A.G.y F.est.objetiva: Actividad X: Imputacion temporal
         aAlfa = #rem01021#4;
         |SI aAlfa = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 1
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 1
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#8 ] 0; aAlfa = #rem01021#8; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 1
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 2
         aAlfa = #rem01021#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 2
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#11 ] 0; aAlfa = #rem01021#11; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 2
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 3
         aAlfa = #rem01021#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 3
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#14 ] 0; aAlfa = #rem01021#14; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 3
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 4
         aAlfa = #rem01021#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 4
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#17 ] 0; aAlfa = #rem01021#17; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 4
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 5
         aAlfa = #rem01021#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 5
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#20 ] 0; aAlfa = #rem01021#20; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 5
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 6
         aAlfa = #rem01021#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 6
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#23 ] 0; aAlfa = #rem01021#23; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 6
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 7
         aAlfa = #rem01021#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 7
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#26 ] 0; aAlfa = #rem01021#26; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 7
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 8
         aAlfa = #rem01021#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 8
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#29 ] 0; aAlfa = #rem01021#29; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 8
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 9
         aAlfa = #rem01021#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 9
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#32 ] 0; aAlfa = #rem01021#32; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 9
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 10
         aAlfa = #rem01021#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 10
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#35 ] 0; aAlfa = #rem01021#35; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 10
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#36; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 11
         aAlfa = #rem01021#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 11
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#38 ] 0; aAlfa = #rem01021#38; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 11
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#39; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 12
         aAlfa = #rem01021#40; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 12
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#41 ] 0; aAlfa = #rem01021#41; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 12
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#42; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 13
         aAlfa = #rem01021#43; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 13
         TipoDato = "An"; Long = 6;   LongDec = 0;
         |SI #rem01021#44 ] 0; aAlfa = #rem01021#44; |SINO; aAlfa = "VARIOS"; |FINSI;
                               |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 13
         TipoDato = "N"; Long = 9;   LongDec = 2;
         aAlfa = #rem01021#45; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Total ingresos
         aAlfa = #rem01021#46; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto previo (suma)
         aAlfa = #rem01021#47; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion gasoleo agricola
         aAlfa = #rem01021#58; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion fertilizantes o plasticos
         aAlfa = #rem01021#60; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Amortizacion inmovilizado
         aAlfa = #rem01021#48; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto minorado
         aAlfa = #rem01021#49; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector medios ajenos
         TipoDato = "N"; Long = 2;   LongDec = 2;
         aAlfa = #rem01021#50; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector util.pers.asalariado
         aAlfa = #rem01021#51; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector cultivos tierras arrend.
         aAlfa = #rem01021#52; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50% : Indice 1
         aAlfa = #rem01021#53; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50% : Indice 2
         aAlfa = "0.0";        |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector act.agricultura ecologica
         aAlfa = #rem01021#54; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector empresa no supera los 9015.18 E
         aAlfa = #rem01021#55; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector determ.act.forestales
         aAlfa = #rem01021#56; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto de modulos
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01021#57; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion caracter general (Act. Agricolas y ganaderas)
         aAlfa = #rem01021#61; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Diferencia
         aAlfa = #rem01021#66; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion agricultores jovenes
         aAlfa = #rem01021#62; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Gastos extraordinarios por circunstancias excepcionales
         aAlfa = #rem01021#59; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto
         aAlfa = #rem01021#63; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion rdtos.generados mas 2 a¤os o forma irregular
         aAlfa = #rem01021#64; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto reducido
         aAlfa = #rem01021#65; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         nEnAct = nEnAct + 1;
         |LEE 000#rem01021.s;
         |SI FSalida ! 0; |O #rem01021#0 ! VEmpresa; |O #rem01021#1 ! 0;
          |O #rem01021#2 ! aTipo2;
            |DDEFECTO #rem01021;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 11;   LongDec = 2;
      || Rend.A.G.y F.est.objetiva: Rendimiento neto reducido total activ.agric. : Suma de rendimientos netos reducidos
      |SI nEnAct = 2;
         Bloque = 7; Casilla = "195"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |SINO;
         aAlfa = 0;       |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |FINSI;
      || Rend.A.G.y F.est.objetiva: Rendimiento neto reducido total activ.agric. : Reduccion por mantenimientos o creacion de empleo
      |SI nEnAct = 2;
         Bloque = 7; Casilla = "196"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |SINO;
         aAlfa = 0;       |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |FINSI;
      || Rend.A.G.y F.est.objetiva: Rendimiento neto reducido total activ.agric.
      |SI nEnAct = 2;
         Bloque = 7; Casilla = "197"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |SINO;
         aAlfa = 0;       |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;
      |FINSI;
      Cadena = "</T10007>" + eaCRLF; |HAZ GrabaCadB;
      |SI nNumPag < enNumPags;
         Cadena = "<T10007>C0"; |HAZ GrabaCadB; FSalida = 0;
         nNumPag = nNumPag + 1;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01021;
|FPRC;

|PROCESO Hoja08;
   enPagina = 8; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10008> ";
   |ABRE #rem01022; |ABRE #rem01023; |ABRE #rem01024;
   |ABRE #rem01025; |ABRE #rem01026;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;

   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = aTipo; aTipo2 = #rem01022#2;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
      |DDEFECTO #rem01022;
   |FINSI;

   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo; aTipo2 = #rem01023#2;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
      |DDEFECTO #rem01023;
   |FINSI;

   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = aTipo; aTipo2 = #rem01024#2;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
      |DDEFECTO #rem01024;
   |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo; aTipo2 = #rem01025#2;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
      |DDEFECTO #rem01025;
   |FINSI;

   #rem01026#0 = VEmpresa;
   #rem01026#1 = 0;
   #rem01026#2 = aTipo;
   |LEE 000#rem01026.=;
   |SI FSalida ! 0; |DDEFECTO #rem01026; |FINSI;

   |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (F) Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : Contribuyente
         aAlfa = #rem01022#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : NIF entidad
         TipoDato = "A"; Long = 9;   LongDec = 0;
         aAlfa = #rem01022#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Participes : Porcentaje participacion
         TipoDato = "N"; Long = 2;   LongDec = 2;
         aAlfa = #rem01022#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto atribuido
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01022#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Reducciones y minoraciones
         aAlfa = #rem01022#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto computable
         aAlfa = #rem01022#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.Mob. : Rdto.Neto
         aAlfa = #rem01022#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Rdto.Neto atribuido
         aAlfa = #rem01022#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Reducciones y minoraciones
         aAlfa = #rem01022#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Cap.inmob. : Rdto.Neto computable
         aAlfa = #rem01022#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Rdto.Neto atribuido
         aAlfa = #rem01022#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Reducciones y minoraciones
         aAlfa = #rem01022#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Rdto.Act.Econ. : Rdto.Neto computable
         aAlfa = #rem01022#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: No derivadas transmision - Ganancias
         aAlfa = #rem01022#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: No derivadas transmision - Perdidas
         aAlfa = #rem01022#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: Derivadas transmision - Ganancias
         aAlfa = #rem01022#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Rentas atribuidas : Gan./Per.patrim 2007: Derivadas transmision - Perdidas
         aAlfa = #rem01022#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : Entidad X : Retencion e ing.a cuenta atribuidos
         aAlfa = #rem01022#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo2;
            |LEE 000#rem01022.s;
            |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
               |DDEFECTO #rem01022;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Cap.Mob : Rdto.integrar base imponible general - Total rdto.computable
         aAlfa = #rem01026#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Cap.Mob : Rdto.integrar base imponible ahorro - Total rdto.computable
         aAlfa = #rem01026#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Cap.Inmob : Total Rdto.Neto computable
         aAlfa = #rem01026#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Rdto.Act.Econ. : Total Rdto.Neto computable
         aAlfa = #rem01026#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2007 : No derivadas transmision : Total Ganancias
         aAlfa = #rem01026#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2007 : No derivadas transmision : Total Perdidas
         aAlfa = #rem01026#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2007 : Derivadas transmision : Total Ganancias
         aAlfa = #rem01026#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : G/P Patr.2007 : Derivadas transmision : Total Perdidas
         aAlfa = #rem01026#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: R.E. Atribucion rentas : rentas atribuidas : Retencion e ing.a cuenta atribuidos
         aAlfa = #rem01026#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 117; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : Contribuyente
         aAlfa = #rem01023#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : NIF Entidad
         TipoDato = "A"; Long = 9;   LongDec = 0;
         aAlfa = #rem01023#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Socios : Criterio de imputacion
         Long = 1;
         aAlfa = #rem01023#19;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Base imponible imputada
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01023#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.inv.empresarial
         aAlfa = #rem01023#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.creacion empleo
         aAlfa = #rem01023#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.rentas Ceuta/Melilla
         aAlfa = #rem01023#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.Base imp. y deduc. : Deduc.doble imposic.internac.
         aAlfa = #rem01023#10;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Entidad X: Imp.otros conceptos : Retenc.e ing.a cta.
         aAlfa = #rem01023#13;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo2;
            |LEE 000#rem01023.s;
            |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
               |DDEFECTO #rem01023;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Total base imponible imputada
         aAlfa = #rem01026#3; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Transp.fiscal, agrup. y ute : Total Retenciones e ingresos a cuenta imputados
         aAlfa = #rem01026#4; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Contribuyente
         aAlfa = #rem01024#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Denominacion entidad
         TipoDato = "An"; Long = 24;   LongDec = 0;
         aAlfa = #rem01024#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Criterio imputacion
         TipoDato = "An"; Long = 1;
         aAlfa = #rem01024#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X : Importe imputacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01024#10;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo2;
            |LEE 000#rem01024.s;
            |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
               |DDEFECTO #rem01024;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp.: Imputacion rentas positivas reg.transp.fiscal intern.: Total importe de la imputacion
         aAlfa = #rem01026#6; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : Contribuyente
         aAlfa = #rem01026#7;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reg.esp.: Imputacion rentas derechos imagen : NIF o denom.cesionario derechos
         TipoDato = "An"; Long = 25; LongDec = 0;
         aAlfa = #rem01026#8; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : NIF o denom.relacion laboral
         aAlfa = #rem01026#9; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp.: Imputacion rentas derechos imagen : Cantidad a imputar en la B.I.
         TipoDato = "N"; Long = 11; LongDec = 2;
         aAlfa = #rem01026#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 14; Cadena = Cadena + aAlfa;
         aAlfa = " " * 50; Cadena = Cadena + aAlfa;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Contribuyente
         aAlfa = #rem01025#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Denominacion Instit.
         TipoDato = "An"; Long = 24;   LongDec = 0;
         aAlfa = #rem01025#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : I.I.C. 1 : Importe imputacion
         TipoDato = "N"; Long = 11;   LongDec = 2;
         aAlfa = #rem01025#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo2;
            |LEE 000#rem01025.s;
            |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
               |DDEFECTO #rem01025;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         || Reg.esp. : Imputacion rentas I.I.Colectiva paraisos fiscales : Total importe imputacion
         aAlfa = #rem01026#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      Cadena = "</T10008>" + eaCRLF; |HAZ GrabaCadB;
      |SI nPag < enNumPags;
         Cadena = "<T10008>C0"; |HAZ GrabaCadB;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01026; |CIERRA #rem01025; |CIERRA #rem01024;
   |CIERRA #rem01023; |CIERRA #rem01022;
|FPRC;

|PROCESO Hoja09;
   enPagina = 9; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10009> ";
   |ABRE #rem01027; |ABRE #rem01039; |ABRE #rem01033; |ABRE #rem01031;

   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo; aTipo2 = #rem01027#2;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
      |DDEFECTO #rem01027;
   |FINSI;

   #rem01031#0 = VEmpresa;
   #rem01031#1 = 0;
   #rem01031#2 = aTipo; aTipo2 = #rem01031#2;
   #rem01031#3 = 1;
   |LEE 000#rem01031.];
   |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
      |DDEFECTO #rem01031;
   |FINSI;

   #rem01039#0 = VEmpresa;
   #rem01039#1 = 0;
   #rem01039#2 = aTipo; aTipo2 = #rem01039#2;
   #rem01039#3 = 1;
   |LEE 000#rem01039.];
   |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
      |DDEFECTO #rem01039;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;

   |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || (G-1) Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en metalico : Importe total
         aAlfa = #rem01033#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Valoracion
         aAlfa = #rem01033#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Ingresos a cuenta
         aAlfa = #rem01033#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Ingresos a cuenta repercutidos
         aAlfa = #rem01033#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Premios, juegos, concursos, rifas : Premio en especie : Importe computable
         aAlfa = #rem01033#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Subvenciones/ayudas adquisicion/rehabilitacion de la vivienda habitual 2009
         aAlfa = #rem01033#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Ganancias patrimoniales vecinos 2009, aprovechamientos forestales
         aAlfa = #rem01033#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Otras ganancias 2009, no derivadas transmision
         aAlfa = #rem01033#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales no derivan transmision : Otras ganancias/perdidas : Perdidas patrimoniales 2009, no derivadas transmision
         aAlfa = #rem01033#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 111; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (G-2) Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Contribuyente
         aAlfa = #rem01027#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : NIF
         TipoDato = "An"; Long = 9;   LongDec = 0;
         aAlfa = #rem01027#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Result.Netos Positivos : Ganancias netas
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01027#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Sociedad/Fondo X : Result.Netos Positivos : Perdidas netas
         aAlfa = #rem01027#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo2;
            |LEE 000#rem01027.s;
            |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
               |DDEFECTO #rem01027;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Totales : Total ganancias netas
         aAlfa = #rem01033#12;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Inst.Inv.Colectiva : Totales : Total perdidas netas
         aAlfa = #rem01033#13;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      || Numero de Ganancias/Perdidas en declaracion conjunta (Reservado AEAT)
      Cadena = "000";
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Contribuyente
         aAlfa = #rem01039#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Denominacion valores
         TipoDato = "An"; Long = 20;  LongDec = 0;
         aAlfa = #rem01039#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Importe global 2007
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01039#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Valor adquisicion global
         aAlfa = #rem01039#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Ganancias. Importe obtenido
         aAlfa = #rem01039#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Ganancias. Importe reducido
         aAlfa = #rem01039#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Perdidas. Importe obtenido
         aAlfa = #rem01039#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Entidad X : Resultados - Perdidas. Importe reducido
         aAlfa = #rem01039#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01039#0 = VEmpresa; |Y #rem01039#1 = 0; |Y #rem01039#2 = aTipo2;
            |LEE 000#rem01039.s;
            |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
               |DDEFECTO #rem01039;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Totales : Ganancias. Importe reducido
         aAlfa = #rem01033#14;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Mercados oficiales : Totales : Perdidas. Importe imputable
         aAlfa = #rem01033#15;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      || Numero de Ganancias/Perdidas en declaracion conjunta (Reservado AEAT)
      Cadena = "000";
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || (G-3) Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Contribuyente
         aAlfa = #rem01031#5; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Tipo elemento
         TipoDato = "N"; Long = 1;  LongDec = 0;
         aAlfa = #rem01031#6; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Inmuebles Situacion : Clave
         aAlfa = #rem01031#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Inmuebles Situacion : Ref.Catastral
         TipoDato = "A"; Long = 20;  LongDec = 0;
         aAlfa = #rem01031#24;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Fecha transmision
         TipoDato = "F";
         aAlfa = #rem01031#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Fecha adquisicion
         aAlfa = #rem01031#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Valor transmision
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01031#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Valor adquisicion
         aAlfa = #rem01031#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Perdida obtenida
         aAlfa = #rem01031#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Perdida imputable
         aAlfa = #rem01031#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : Diferencia obtenida : Ganancia obtenida
         aAlfa = #rem01031#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Parte ganancia susceptible reduccion
         aAlfa = #rem01031#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : A¤os permanencia hasta 31/12/94
         TipoDato = "N"; Long = 4;  LongDec = 0;
         nCalc = #rem01031#14; || En el programa se toman hasta el 31/12/1996
         |SI nCalc < 0; nCalc = 0; |FINSI;
         aAlfa = nCalc; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Reduccion aplicable
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01031#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida
         aAlfa = #rem01031#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia exenta reinversion vivienda hab.
         aAlfa = #rem01031#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida no exenta
         aAlfa = #rem01031#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida no exenta imputable 2007
         aAlfa = #rem01031#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Reduccion (licencia autotaxis)
         aAlfa = #rem01031#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida
         aAlfa = #rem01031#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Elemento X : No afectos : Ganancia reducida imputable 2007
         aAlfa = #rem01031#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo2;
            |LEE 000#rem01031.s;
            |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
               |DDEFECTO #rem01031;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : Total perdida imputable 2009
         aAlfa = #rem01033#16;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : No afectos : Total ganancia reducida imputable 2009
         aAlfa = #rem01033#17;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas patrimoniales deriv.transmision : Otros elementos : Totales : Afectos : Total ganancia reducida imputable 2009
         aAlfa = #rem01033#18;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 39; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      || Numero de Ganancias/Perdidas en declaracion conjunta (Reservado AEAT)
      Cadena = "000";
      Cadena = Cadena + "</T10009>" + eaCRLF; |HAZ GrabaCadB;

      |SI nPag < enNumPags;
         Cadena = "<T10009>C0000000"; |HAZ GrabaCadB;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01027; |CIERRA #rem01039; |CIERRA #rem01033; |CIERRA #rem01031;
|FPRC;

|PROCESO Hoja10;
   enPagina = 10; |HAZ MiraObligatoria;
   |SI enConDatos = 0; |ACABA; |FINSI;

   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10010> ";
   |ABRE #rem01030; |ABRE #rem01032; |ABRE #rem01033;

   #rem01030#0 = VEmpresa;
   #rem01030#1 = 0;
   #rem01030#2 = aTipo; aTipo2 = #rem01030#2;
   #rem01030#3 = 1;
   |LEE 000#rem01030.];
   |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
      |DDEFECTO #rem01030;
   |FINSI;

   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
      |DDEFECTO #rem01032;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
   Cadena = Cadena + aAlfa;

   nNumLin1 = 1; nNumLin2 = 1; nNumLin3 = 1; nNumLin4 = 1;
   |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
      #rem01032#0 = VEmpresa;
      #rem01032#1 = 0;
      #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
      #rem01032#2 = aTipo;
      #rem01032#3 = nNumLin3;
      |LEE 000#rem01032.];
      |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 ! aTipo2; |HACIENDO;
         |SI #rem01032#6 ! 0; nNumLin3 = #rem01032#3 + 1; |SAL; |FINSI;
         |LEE 000#rem01032.s;
      |SIGUE;
      |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
      |SINO;
         |SI #rem01032#6 = 0; |DDEFECTO #rem01032; |FINSI;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || (G-2) Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Ganancia X : Contribuyente
         aAlfa = #rem01032#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Ganancia X : Importe ganancia
         TipoDato = "N";  Long = 11;   LongDec = 2;
         aAlfa = #rem01032#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         nNumLinAnt = #rem01032#3;
         |LEE 000#rem01032.s;
         |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
            |SI #rem01032#6 ! 0; nNumLin3 = #rem01032#3; |SAL; |FINSI;
            |LEE 000#rem01032.s;
         |SIGUE;
         |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
            |DDEFECTO #rem01032;
            |SI nNumLinAnt = nNumLin3; nNumLin3 = 999; |FINSI;
         |SINO;
            |SI #rem01032#6 = 0; |DDEFECTO #rem01032; |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Total ganancias
         aAlfa = #rem01033#19;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      #rem01032#0 = VEmpresa;
      #rem01032#1 = 0;
      #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
      #rem01032#3 = nNumLin4;
      |LEE 000#rem01032.];
      |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
         |SI #rem01032#8 ! 0; nNumLin4 = #rem01032#3 + 1; |SAL; |FINSI;
         |LEE 000#rem01032.s;
      |SIGUE;
      |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
      |SINO;
         |SI #rem01032#8 = 0; |DDEFECTO #rem01032; |FINSI;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Perdida X : Contribuyente
         aAlfa = #rem01032#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Perdida X : Importe ganancia
         TipoDato = "N";  Long = 11;   LongDec = 2;
         aAlfa = #rem01032#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         nNumLinAnt = #rem01032#3;
         |LEE 000#rem01032.s;
         |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
            |SI #rem01032#8 ! 0; nNumLin4 = #rem01032#3; |SAL; |FINSI;
            |LEE 000#rem01032.s;
         |SIGUE;
         |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
            |DDEFECTO #rem01032;
            |SI nNumLinAnt = nNumLin4; nNumLin4 = 999; |FINSI;
         |SINO;
            |SI #rem01032#8 = 0; |DDEFECTO #rem01032; |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 ejerc.anter. : Total perdidas
         aAlfa = #rem01033#20;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Contribuyente
         aAlfa = #rem01030#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Importe ganancia
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01030#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Ganancia X : Metodo integracion : Clave
         TipoDato = "A";  Long = 1;  LongDec = 0;
         aAlfa = #rem01030#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         |SI #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo2;
            |LEE 000#rem01030.s;
            |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
               |DDEFECTO #rem01030;
            |FINSI;
         |FINSI;
      |SIGUE;

      |SI nPag ! 1; |DDEFECTO #rem01033; |FINSI;

      TipoDato = "N";  Long = 11;  LongDec = 2;
      || Ganancias/perdidas patrim.deriv.transmision : Imput.a 2007 difer.reinversion : Total ganancia
      aAlfa = #rem01033#21;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || (G-3) Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe susceptible de reinversion
      aAlfa = #rem01033#22;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Ganancia patrimonial consecuencia transmision
      aAlfa = #rem01033#23;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe reinvertido a 31/12/2007 adqu.nueva vivienda
      aAlfa = #rem01033#24;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Importe comprometido a reinvertir en 2 a¤os proximos
      aAlfa = #rem01033#25;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Exencion por reinversion ganancia patrimonial 2007 transm.vivienda hab. - Ganancia patrimonial exenta por reinversion
      aAlfa = #rem01033#26;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || (G-4) Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Contribuyente 1
      TipoDato = "N";  Long = 2;  LongDec = 0;
      aAlfa = #rem01033#27;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
      || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Numero operaciones 1
      aAlfa = #rem01033#28;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Contribuyente 2
      aAlfa = #rem01033#29;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
      || Opcion regimen especial fusiones, escisiones y canje valores entidades no residentes en Espa¤a : Numero operaciones 2
      aAlfa = #rem01033#30;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || (G-5) Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Suma ganancias
      TipoDato = "N";  Long = 11;  LongDec = 2;
      aAlfa = #rem01033#31;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Suma perdidas
      aAlfa = #rem01033#32;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Saldo neto - Diferencia positiva
      aAlfa = #rem01033#33;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |HAZ GrabaCadB; Cadena = "";

      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible general - Saldo neto - Diferencia negativa
      aAlfa = #rem01033#34;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Suma ganancias
      aAlfa = #rem01033#35;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Suma perdidas
      aAlfa = #rem01033#36;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Saldo neto - Diferencia positiva
      aAlfa = #rem01033#37;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Integracion/Compensacion ganancias/perdidas patrim.imputables 2007 - A integrar en base imponible ahorro - Saldo neto - Diferencia negativa
      aAlfa = #rem01033#38;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || (H) Base imp.general y ahorro : Base Imp.General : Saldo neto positivo ganan/perd. 2007 a integrar
      aAlfa = #rem01033#39;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Saldos netos positivo ganan/perd. 2003-2006 a integrar
      aAlfa = #rem01033#40;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Saldo neto rdtos.integrar en Base Imp.general/imputaciones renta
      aAlfa = #rem01033#41;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Compensaciones : Resto saldos negativos 2003-2006 a integrar
      aAlfa = #rem01033#42;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Compensaciones : Saldo neto negativo ganancias/perdidas 2007 a integrar
      aAlfa = #rem01033#43;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Total
      aAlfa = #rem01033#44;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.General : Saldo neto negativo gan/per 2007 : Importe pdte.compensar
      aAlfa = #rem01033#45;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Saldo neto positivo gan/per 2007
      aAlfa = #rem01033#46;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Saldos netos negativos gan/per 2003-2006
      aAlfa = #rem01033#47;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Saldo rdtos.capital mobiliario : Saldo negativo
      aAlfa = #rem01033#48;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Saldo rdtos.capital mobiliario : Saldo positivo
      aAlfa = #rem01033#49;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Saldo rdtos.capital mobiliario : Saldo neto negativo cap.mobiliario 2007
      aAlfa = #rem01033#111;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Base imp.general y ahorro : Base Imp.Ahorro : Base Imp.Ahorro
      aAlfa = #rem01033#50;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |HAZ GrabaCadB; Cadena = "";

      Cadena = "</T10010>" + eaCRLF; |HAZ GrabaCadB;

      |SI nPag < enNumPags;
         Cadena = "<T10010>C0"; |HAZ GrabaCadB;
      |FINSI;
      Cadena = "";
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01032; |CIERRA #rem01030;
|FPRC;

|PROCESO Hoja11;
   enPagina = 11; |HAZ MiraObligatoria;
   nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

   VTipo = eaTipo; aTipo = VTipo % 0110;
   Cadena = "<T10011> ";

   |ABRE #rem01033; |ABRE #rem01037; |ABRE #rem01045; |ABRE #rem01035;
   |ABRE #rem01046; |ABRE #rem01047;

   #rem01035#0 = VEmpresa;
   #rem01035#1 = 0;
   #rem01035#2 = aTipo; aTipo2 = #rem01035#2;
   #rem01035#3 = 1;
   |LEE 000#rem01035.];
   |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
      |DDEFECTO #rem01035;
   |FINSI;

   #rem01045#0 = VEmpresa;
   #rem01045#1 = 0;
   #rem01045#2 = aTipo; aTipo2 = #rem01045#2;
   #rem01045#3 = 1;
   |LEE 000#rem01045.];
   |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 ! aTipo2;
      |DDEFECTO #rem01045;
   |FINSI;

   #rem01046#0 = VEmpresa;
   #rem01046#1 = 0;
   #rem01046#2 = aTipo; aTipo2 = #rem01046#2;
   #rem01046#3 = 1;
   |LEE 000#rem01046.];
   |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
      |DDEFECTO #rem01046;
   |FINSI;

   #rem01047#0 = VEmpresa;
   #rem01047#1 = 0;
   #rem01047#2 = aTipo; aTipo2 = #rem01047#2;
   #rem01047#3 = 1;
   |LEE 000#rem01047.];
   |SI FSalida ! 0; |O #rem01047#0 ! VEmpresa; |O #rem01047#1 ! 0; |O #rem01047#2 ! aTipo2;
      |DDEFECTO #rem01047;
   |FINSI;

   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo; aTipo2 = #rem01037#2;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
      |DDEFECTO #rem01037;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   |PARA nPagAct = 1; |SI nPagAct [ enNumPags; |HACIENDO nPagAct = nPagAct + 1;
      || (I) Reducciones base imponible : Reduc.tribut.conjunta : Reduc.unidad familiar tribut.conjunta
      TipoDato = "N"; Long = 11;  LongDec = 2;
      |SI nPagAct ! 1;
         aAlfa = "0" * 13;
      |SINO;
         aAlfa = #rem01033#51; |HAZ FormateoB;
      |FINSI;
      Cadena = Cadena + aAlfa;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Contribuyente
         aAlfa = #rem01037#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Excesos pdtes.2002-2006
         aAlfa = #rem01037#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Aportaciones
         aAlfa = #rem01037#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Importes con derecho a deduccion
         aAlfa = #rem01037#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |LEE 000#rem01037.s;
         |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
            |DDEFECTO #rem01037;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones sist.prev.social : Regimen general : Total con derecho a deduccion
         aAlfa = #rem01033#52;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones sist.prev.social : Aportaciones conyuge : Total con derecho a deduccion
         aAlfa = #rem01033#55;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         || Reducciones base imponible : N§ hojas adicionales que se adjuntan
         TipoDato = "N"; Long = 1;  LongDec = 0;
         aAlfa = nNumPag;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 27);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Contribuyente X
         aAlfa = #rem01045#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         TipoDato = "An"; Long = 9;  LongDec = 0;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : NIF persona con discapacidad
         aAlfa = #rem01045#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11;  LongDec = 2;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Excesos pendientes reducir
         aAlfa = #rem01045#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Aportaciones 2007 propia persona discapacitada
         aAlfa = #rem01045#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Aportaciones 2007 parientes o tutores
         aAlfa = #rem01045#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |LEE 000#rem01045.s;
         |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 = aTipo2;
            |DDEFECTO #rem01045;
         |FINSI;
      |SIGUE;

      || Reducciones base imponible : Aportaciones a favor de personas con discapacidad : Total con derecho a deduccion
      |SI nPagAct = 1;
         aAlfa = #rem01033#56;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Contribuyente 1
         aAlfa = #rem01035#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : NIF persona discapacitada
         TipoDato = "An"; Long = 9;  LongDec = 0;
         aAlfa = #rem01035#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Excesos pdtes reducir 2004-2006
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01035#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Aportaciones 2007
         aAlfa = #rem01035#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |LEE 000#rem01035.s;
         |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
            |DDEFECTO #rem01035;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones patrimonios protegidos personas discapacidad : Total con derecho a deduccion
         aAlfa = #rem01033#59;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Contribuyente 1
         aAlfa = #rem01046#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : NIF persona receptora pension/anualidad
         TipoDato = "An"; Long = 9;  LongDec = 0;
         aAlfa = #rem01046#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Importe pension/anualidad 2007
         TipoDato = "N"; Long = 11;  LongDec = 2;
         aAlfa = #rem01046#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |LEE 000#rem01046.s;
         |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
            |DDEFECTO #rem01046;
         |FINSI;
      |SIGUE;

      |SI nPagAct = 1;
         || Reducciones base imponible : Pensiones compensatorias conyuge y anualidades excepto hijos : Total derecho a deduccion
         aAlfa = #rem01033#62;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 13);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Contribuyente 1
         aAlfa = #rem01047#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Aportaciones 2007
         aAlfa = #rem01047#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Aportaciones 2008
         aAlfa = #rem01047#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |LEE 000#rem01047.s;
         |SI FSalida ! 0; |O #rem01047#0 ! VEmpresa; |O #rem01047#1 ! 0; |O #rem01047#2 ! aTipo2;
            |DDEFECTO #rem01047;
         |FINSI;
      |SIGUE;
      |HAZ GrabaCadB; Cadena = "";

      |SI nPagAct = 1;
         || Reducciones base imponible : Aportaciones mutualidad prevision social deportistas profesionales : Total con derecho a deduccion
         aAlfa = #rem01033#63;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

         || (J) Base liquidable general/base liquidable ahorro : Determinacion base general : Base imponible general
         aAlfa = #rem01033#66;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Tributacion conjunta
         aAlfa = #rem01033#67;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social (R.G.)
         aAlfa = #rem01033#68;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social conyuge
         aAlfa = #rem01033#69;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Prev.Social Personas discap.
         aAlfa = #rem01033#70;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aport.Patr.Protegidos Personas discap.
         aAlfa = #rem01033#71;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Pensiones comp./anual. alimentos
         aAlfa = #rem01033#72;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Cuotas afiliacion y demas aportaciones
         aAlfa = #rem01033#74;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Reducciones Base imponible general : Aportaciones mutualidad deportistas profesionales
         aAlfa = #rem01033#73;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Base liquidable general
         aAlfa = #rem01033#75;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Compensacion
         aAlfa = #rem01033#76;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Base liquidable general/base liquidable ahorro : Determinacion base general : Base liquidable general sometida a gravamen
         aAlfa = #rem01033#77;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         Cadena = Cadena + ("0" * 169);
      |FINSI;
      |HAZ GrabaCadB; Cadena = "";
      Cadena = Cadena + "</T10011>" + eaCRLF; |HAZ GrabaCadB;
      |SI nPagAct < enNumPags;
         Cadena = Cadena + "<T10011>C"; |HAZ GrabaCadB;
      |FINSI;
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01037; |CIERRA #rem01045; |CIERRA #rem01035;
   |CIERRA #rem01046; |CIERRA #rem01047;
|FPRC;

|PROCESO Hoja21;
   nSwDatos = 0; nCalc1 = 0; nConCta = 0;
   VTipo = eaTipo; aTipo = VTipo % 0110;

   Cadena = "<T10021> ";

   TipoDato = "N"; Long = 11; LongDec = 2;
   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida = 0;
      nTotal = 0; nSusp = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      Bloque = 42;     Casilla = "768"; |HAZ BuscaCasillaB; nTotal = Casilla;
      |SI SwError = 1; |O nTotal = 0;
         Bloque = 43;     Casilla = "769"; |HAZ BuscaCasillaB; nTotal = Casilla;
      |FINSI;
      |SI SwError = 1; |O nTotal = 0;
         Bloque = 39;     Casilla = "760"; |HAZ BuscaCasillaB; nTotal = Casilla;
         nSusp = 0;
      |SINO;
         nSusp = 1;
         nTotal = #rem01001#16;
      |FINSI;

      nConCta = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      aAlfa = nTotal; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      || Liquidacion : Solicitud de suspension del ingreso conyuge/renuncia a la devol.otro conyuge
      aAlfa = nSusp; Cadena = Cadena + aAlfa;
      || Declaracion complementaria : Resultado de la decl.complementaria
      Bloque = 41;     Casilla = "765"; |HAZ BuscaCasillaB;

      |SI #rem01001#14 = "4"; Casilla = 0; |FINSI;

      nCalc = Casilla;
      aAlfa = Casilla; |HAZ FormateoB;  Cadena = Cadena + aAlfa;
      |SI nCalc ! 0; nTotal = nCalc; |FINSI;
      nConCta = 0;
      |SI nTotal > 0;
         || Ingreso : Fracciona o no el pago
         |SI #rem01001#8 = "S"; aAlfa = "01"; |SINO; aAlfa = "10"; |FINSI;
         Cadena = Cadena + aAlfa;
         || Ingreso : Importe del ingreso
         nCalc1 = #rem01001#16;
         |SI #rem01001#8 = "S"; nCalc1 = (nCalc1 % 60) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         |SI #rem01001#9 = "E"; aAlfa = "1";              |FINSI;
         |SI #rem01001#9 = "A"; aAlfa = "2"; nConCta = 1; |FINSI;
         |SI #rem01001#9 = "D"; aAlfa = "3"; nConCta = 1; |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Si domicilia o no el 2§ pago
         |SI #rem01001#8 = "S";
            |SI #rem01001#10 = "S";
               aAlfa = "01"; nConCta = 1;
            |SINO;
               aAlfa = "10";
            |FINSI;
         |SINO;
            aAlfa = "00";
         |FINSI;
         Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Importe 2§ plazo
         nCalc1 = 0;
         |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S"; nCalc1 = (#rem01001#16 % 40) ! 2; |FINSI;
         aAlfa = nCalc1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Opciones de pago 2§ plazo : Codigo cuenta
      |SINO;
         || Ingreso : Fracciona o no el pago
         Cadena = Cadena + "00";
         || Ingreso : Importe del ingreso
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         || Ingreso : Forma de pago
         Cadena = Cadena + "0";
         || Opciones de pago 2§ plazo : Si domicilia o no el 2§ pago
         Cadena = Cadena + "00";
         || Opciones de pago 2§ plazo : Importe 2§ plazo
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |FINSI;
      |SI nTotal < 0;
         nTotal = 0 - nTotal; aAlfa = "";
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         |SI #rem01001#11 = "X";
            Cadena = Cadena + "2";
         |SINO;
            |SI #rem01001#12 = "X";
               Cadena = Cadena + "1";
               nConCta = 1;
            |SINO;
               Cadena = Cadena + "0";
            |FINSI;
         |FINSI;
         || Devolucion : Importe de la devolucion
         aAlfa = nTotal; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |SINO;
         || Devolucion : Renuncia a la devolucion o Devolucion por transferencia
         Cadena = Cadena + "0";
         || Devolucion : Importe de la devolucion
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;
      |FINSI;
      || Codigo cuenta
      |SI nConCta = 1;
         Cadena = Cadena + aCuenta1;
      |SINO;
         Cadena = Cadena + ("0" * 20);
      |FINSI;
      Cadena = Cadena + "</T10021>" + eaCRLF; |HAZ GrabaCadB;
   |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
   eaIP = ""; |IP_REMOTO eaIP;

   VEmpresa = enEmpresa; VTipo    = eaTipo;
   aNif = eaNif; |QBF aNif; aNif = aNif % 0108;

   Nombre = ("00000" + VEmpresa) % -105;
   Nombre = "or" + Nombre;
   |QBF Nombre;
   Comodin = VTipo; |QBF Comodin;
   |SI Comodin = "CONJUNTA";  Comodin = "A"; |FINSI;
   |SI Comodin = "CONJUNTAE"; Comodin = "A"; |FINSI;
   Nombre = Nombre + (Comodin % 0101);
   |QBF Nombre;

   |DBASE Comodin; |QBF Comodin;
   Comodin = Comodin + "tmp/"; |MKDIR Comodin;
   Comodin = Comodin + Nombre;
   |XABRE "WB", Comodin, enHandle;
   enHandle = FSalida;
   |SI FSalida < 0; |MENAV "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

   |ABRE #rem00101; |ABRE #rem01001; |ABRE #rem01002;

   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;

   eaCRLF = ""; || eaCRLF = &13 + &10;

   LongDec = 0;
   Cadena = "<T100020090A0000><AUX>";
   Cadena = Cadena + (" " * 100);
   |HAZ GrabaCadB; Cadena = "";

   Cadena = Cadena + (" " * 100);
   Cadena = Cadena + (" " * 100);
   |HAZ GrabaCadB; Cadena = "";

   Cadena = "</AUX><VECTOR>"
   |HAZ GrabaCadB; Cadena = "";
   |HAZ GrabaVector;
   Cadena = "</VECTOR>";
   |HAZ GrabaCadB; Cadena = "";

   |HAZ Hoja01;
   |HAZ Hoja02;
   |HAZ Hoja03;
   |HAZ Hoja04;
   |HAZ Hoja05;
   |HAZ Hoja06;
   |HAZ Hoja07;
   |HAZ Hoja08;
   |HAZ Hoja09;
   |HAZ Hoja10;
   |HAZ Hoja11;
   |HAZ Hoja12;
   |HAZ Hoja13;
   |HAZ Hoja14;
   |HAZ Hoja15;
   |HAZ Hoja16;
   |HAZ Hoja17;
   |HAZ Hoja18;
   |HAZ Hoja19;
   |HAZ Hoja20;
   |HAZ Hoja21;

   Cadena = "</T100020090A0000>" + eaCRLF;
   |HAZ GrabaCadB; Cadena = "";

   |CIERRA #rem01002; |CIERRA #rem00101; |CIERRA #rem01001;

   |XCIERRA enHandle; SwDatos = 1;
|FPRC;
