|FICHEROS;
     reacceso;

     :/integral/def/dsam0000;
     :/integral/def/dsam0003;
     :/integral/def/dsam0005;

     :/basica/def/agicen14;
     :/basica/def/agicen17;
     :/basica/def/agicen18;
     :/basica/def/agicen30;

     :/modelos/def/dsmom001;
     :/modelos/def/dsmom004;
     :/modelos/def/dsmom010;
     :/modelos/def/dsmom011;
     :/modelos/def/dsmom012;
     :/modelos/def/dsmom013;
     :/modelos/def/dsmom014;
     :/modelos/def/dsmom017;
     :/modelos/def/dsmom018;
     :/modelos/def/dsmom022;
     :/modelos/def/dsmom051;
     :/modelos/def/dsmom052;
     :/modelos/def/dsmom053;
     :/modelos/def/dsmom055;
     :/modelos/def/dsmom104;
     :/modelos/def/dsmom105;

     :/modelos/def/dsmod130;
     :/modelos/def/dsmod131;
     :/modelos/def/dsm190ca;
     :/modelos/def/dsm19001;

     :/contagen/def/camaasil;
     :/contagen/def/canempre;
     :/contagen/def/caivalin;
     :/contagen/def/camaniva;

     reeleact;
     rem00500;
     rem00020;
     rem00021;
     rem00025;
     rem00026;
     rem00027;
     rem00028;
     rem00029;
     rem00031;
     rem00032;
     rem00058;
     rem00099;

     trabajo@;
|FIN;

|VARIABLES;
      aPathFich     = "";
      aAlfa         = "";
      aAlfa1        = "";
      aAlfa2        = "";
      aBase         = "";
      aNif          = "";
      aCuenta       = "";
      aDCuenta      = "";
      aHCuenta      = "";
      aCarac        = "";
      aMas          = "";
      aTipoRet      = "";

      nSwPatrimonio = 0;
      nSwPasa       = 0;
      nPorce        = 0;
      nPorceGasto   = 0;
      nDepar        = 0;
      nEmpresa      = 0;
      nActividad    = 0;
      nCampo        = 0;
      nFactor       = 0;
      nCampo1       = 0;
      nCampo2       = 0;
      nPorce1       = 0;
      nPorce2       = 0;
      nResto        = 0;
      nDifer        = 0;
      nCampoRdto    = 0;
      nSwAsala2     = 0;
      nLinea        = 0;
      nRefer        = 0;
      nCanti1       = 0;
      nCanti2       = 0;
      nCanti39      = 0;
      nContaAct     = 0;
      nError        = 0;
      nImporte      = 0;
      nImporte1     = 0;
      nImporte2     = 0;
      nEmpresaAnt   = 0;
      nCasilla      = 0;
      nLimite       = 0;
      nSwInMobi     = 0;
      nTotal        = 0;
      nUni          = 0;
      nRetencion    = 0;
      nHayTrabaj    = 0;
      nHay30        = 0;
      nComprueba    = 0;
      nConversor    = 0;
      nOpera        = 0;
      nPlanilla     = 0;
      nEnExi        = 0;
      nNume         = 0;
      nRetencion1   = 0;
      nRetencion2   = 0;
      nGananPerd    = 0;
      nAtribucion   = 0;
      nCarac        = 0;
      nPos          = 0;
      nDNI          = 0;
      nPago         = 0;
      nRetContab    = 0;
      nSumaCtas     = 0;
      nEmpAtrib     = 0;
      nPorAtrib     = 0;

     &eaLetra      = "";
     &eaDeclarante = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr16_1   = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr22     = "";
     &eaPatr23     = "";
     &enAmortiza   = 0;
     &enActividad  = 0;
     &enSwPasa     = 0;
     &enTipoGanan  = 0;
     &eaPerceptor  = "";
     &enImporteT   = 0;
     &enImporteC   = 0;
     &enImporte1   = 0;
     &enImporte2   = 0;
     &enImporte3   = 0;
     &enImporte4   = 0;

     &enEmpresa  = 0;
     &eaPrograma = "";
     &eaPunto    = "";
     &eaCaptura  = "";
     &enDComple  = 0;
     &enHComple  = 0;
     &enError    = 0;
     &enGastos   = 0;
     &eaLorca    = "";
     &eaRefCast  = "";
     &eaAzul     = "";
     &eaVerde    = "";
     &eaRojo     = "";
     &eaRosa     = "";
|FIN;

|PROCESO MiraHistorico;
     |ABRE #agicen30;
     #agicen30#0 = #agicen14#0;
     #agicen30#1 = #agicen14#1;
     #agicen30#2 = 2016;
     |LEE 101#agicen30.=;
     |SI FSalida ! 0;
         |DDEFECTO #agicen30;
         #agicen30#0  = #agicen14#0;
         #agicen30#1  = #agicen14#1;
         #agicen30#2  = 2016;
         #agicen30#3  = #agicen14#2;
         #agicen30#4  = #agicen14#3;
         #agicen30#5  = #agicen14#4;
         #agicen30#6  = #agicen14#7;
         #agicen30#7  = #agicen14#8;
         #agicen30#8  = #agicen14#9;
         #agicen30#9  = #agicen14#10;
         #agicen30#10 = #agicen14#11;
         #agicen30#11 = #agicen14#12;
         #agicen30#12 = #agicen14#16;
         #agicen30#13 = #agicen14#17;
         #agicen30#14 = #agicen14#18;
         #agicen30#15 = #agicen14#19;
         #agicen30#16 = #agicen14#15;
         |GRABA 020#agicen30.n;
     |FINSI;
     |LIBERA #agicen30;
     |CIERRA #agicen30;

     |SI #agicen30#16 = "          "; #agicen30#16 = #agicen14#15; |FINSI;
|FPRC;

|| \_________________________________ Recogida desde Modulos

|PROCESO Incentivo2016;
     nPorce1 = 0;
     |SI #rem00027#122 = "S";
         |SI nDifer > 0;
             nPorce1 = nDifer * .40;
         |FINSI;
     |FINSI;

     nPorce2 = 0;
     |SI #rem00027#53 = "I";
         |SI nResto > 8;
             nPorce  = nResto - 8;
             nPorce2 = nPorce2 + (nPorce * 0.30);
             nResto  = 8;
         |FINSI;

         |SI nResto > 5;
             nPorce  = nResto - 5;
             nPorce2 = nPorce2 + (nPorce * 0.25);
             nResto  = 5;
         |FINSI;

         |SI nResto > 3;
             nPorce  = nResto - 3;
             nPorce2 = nPorce2 + (nPorce * 0.20);
             nResto  = 3;
         |FINSI;

         |SI nResto > 1;
             nPorce  = nResto - 1;
             nPorce2 = nPorce2 + (nPorce * 0.15);
             nResto  = 1;
         |FINSI;

         |SI nResto > 0;
             nPorce2 = nPorce2 + (nResto * 0.10);
         |FINSI;
     |FINSI;

     |SI #rem00027#53 = "P";
         |SI nResto > 0;    |Y nResto [ 1;  nPorce2 = 0.10;  |FINSI;
         |SI nResto ] 1.01; |Y nResto [ 3;  nPorce2 = 0.15;  |FINSI;
         |SI nResto ] 3.01; |Y nResto [ 5;  nPorce2 = 0.20;  |FINSI;
         |SI nResto ] 5.01; |Y nResto [ 8;  nPorce2 = 0.25;  |FINSI;
         |SI nResto > 8;                    nPorce2 = 0.30;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO TotalModulo;
     |ABRE #reeleact;
     #reeleact#0 = #rem00027#16;
     #reeleact#1 = #rem00027#17;
     #reeleact#2 = #rem00027#18;
     |LEE 040#reeleact.=;
     |SI FSalida ! 0;  |DDEFECTO #reeleact;  |FINSI;
     |CIERRA #reeleact;

     nSwAsala2 = 0;
     aAlfa     = #reeleact#1 % 103;
     |SI aAlfa = "644";  nSwAsala2 = 1;  |FINSI;

     #rem00027#55 = #rem00027#31;
     #rem00027#57 = #rem00027#38;
     #rem00027#60 = 0;
     #rem00027#62 = 0;
     |SI nSwAsala2 = 1;  #rem00027#60 = #rem00027#32;  #rem00027#62 = #rem00027#39;  |FINSI;

     || Minoracion de Empleo

     nResto   = #rem00027#54 + #rem00027#59;
     #rem00027#56 = 0;
     #rem00027#61 = 0;
     #rem00027#58 = 0;
     #rem00027#63 = 0;
     nPorce1  = 0;
     nPorce2  = 0;
     nDifer   = (#rem00027#55 + #rem00027#60) - (#rem00027#54 + #rem00027#59);
     |SI nDifer < 0;  nResto = #rem00027#55 + #rem00027#60;  |FINSI;

     |SI #rem00027#122 = "N";
         nDifer = 0;
         nResto = #rem00027#55 + #rem00027#60;
     |FINSI;

     |HAZ Incentivo2016;

     #rem00027#56   = 0;
     #rem00027#61   = 0;

     |SI #rem00027#55 ! 0;
         #rem00027#56   = ((nPorce1 + nPorce2) / (#rem00027#55 + #rem00027#60)) * #rem00027#55;
     |FINSI;

     |SI #rem00027#60 ! 0;
         #rem00027#61   = ((nPorce1 + nPorce2) / (#rem00027#55 + #rem00027#60)) * #rem00027#60;
     |FINSI;

     #rem00027#58   = #rem00027#57 * #rem00027#56;
     #rem00027#63   = #rem00027#62 * #rem00027#61;
     #rem00027#64   = #rem00027#58 + #rem00027#63;

     || Minoracion Inversion

     #rem00027#78 = #rem00027#65 + #rem00027#68 + #rem00027#71 + #rem00027#74 + #rem00027#77;

     ||  Rdto Neto Minorado

     #rem00027#79 = #rem00027#52 - #rem00027#64 - #rem00027#78;

     ||  Quioscos

     #rem00027#81  = #rem00027#79 * #rem00027#80;
     |SI #reeleact#32 = "N";  #rem00027#81 = 0;  |FINSI;
     |SI #rem00027#81 < 0;    #rem00027#81 = 0;  |FINSI;

     ||  Taxis

     #rem00027#83  = #rem00027#79 * #rem00027#82;
     |SI #reeleact#33 = "N";  #rem00027#83 = 0;  |FINSI;
     |SI #rem00027#83 < 0;    #rem00027#83 = 0;  |FINSI;

     ||  Urbanos

     #rem00027#85  = #rem00027#79 * #rem00027#84;
     |SI #reeleact#35 = "N";  #rem00027#85 = 0;  |FINSI;
     |SI #rem00027#85 < 0;    #rem00027#85 = 0;  |FINSI;

     ||  Mercancias

     #rem00027#87  = #rem00027#79 * #rem00027#86;
     |SI #reeleact#34 = "N";  #rem00027#87 = 0;  |FINSI;
     |SI #rem00027#87 < 0;    #rem00027#87 = 0;  |FINSI;

     ||  Empresas Peque¤as dimensiones

                       nCampoRdto = 79;
     |SI #rem00027#81 ! 0;  nCampoRdto = 81;  |FINSI;

     #rem00027#89 = #rem00027#nCampoRdto# * #rem00027#88;
     |SI #rem00027#83 ! 0; |O #rem00027#85 ! 0; |O #rem00027#87 ! 0;
         #rem00027#89 = 0;
     |FINSI;

     |SI #rem00027#89 < 0;  #rem00027#89 = 0;  |FINSI;

     ||  Temporada

                       nCampoRdto = 79;
     |SI #rem00027#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #rem00027#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #rem00027#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #rem00027#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #rem00027#89 ! 0;  nCampoRdto = 89;  |FINSI;

     #rem00027#92 = #rem00027#nCampoRdto# * #rem00027#91;
     |SI #rem00027#92 < 0;  #rem00027#92 = 0;  |FINSI;

     || Exceso

     nCampoRdto = 79;
     |SI #rem00027#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #rem00027#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #rem00027#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #rem00027#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #rem00027#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #rem00027#92 ! 0;  nCampoRdto = 92;  |FINSI;

     #rem00027#95  = #reeleact#31;
     #rem00027#93  = #rem00027#nCampoRdto# - #rem00027#95;
     #rem00027#94  = #rem00027#95 + (#rem00027#93 * 1.30);
     |SI #rem00027#93 < 0;  #rem00027#94 = 0;  |FINSI;
     |SI #reeleact#31 = 0;  #rem00027#94 = 0;  |FINSI;
     |SI #rem00027#89 ! 0;  #rem00027#94 = 0;  |FINSI;

     || Nueva Actividad

                       nCampoRdto = 79;
     |SI #rem00027#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #rem00027#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #rem00027#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #rem00027#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #rem00027#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #rem00027#92 ! 0;  nCampoRdto = 92;  |FINSI;
     |SI #rem00027#94 ! 0;  nCampoRdto = 94;  |FINSI;

     #rem00027#97 = #rem00027#nCampoRdto# * #rem00027#96;
     |SI #rem00027#92 ! 0;  #rem00027#97 = 0;  |FINSI;
     |SI #rem00027#97 < 0;  #rem00027#97 = 0;  |FINSI;

     || Rendimiento Neto Modulos Ajustado

                       nCampoRdto = 79;
     |SI #rem00027#81 ! 0;  nCampoRdto = 81;  |FINSI;
     |SI #rem00027#83 ! 0;  nCampoRdto = 83;  |FINSI;
     |SI #rem00027#85 ! 0;  nCampoRdto = 85;  |FINSI;
     |SI #rem00027#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #rem00027#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #rem00027#92 ! 0;  nCampoRdto = 92;  |FINSI;
     |SI #rem00027#94 ! 0;  nCampoRdto = 94;  |FINSI;
     |SI #rem00027#97 ! 0;  nCampoRdto = 97;  |FINSI;

     #rem00027#98  = #rem00027#nCampoRdto#;

     #rem00027#108 = 0;
     |SI #rem00027#98 > 0;
         #rem00027#108 = #rem00027#98 % 5;
     |FINSI;

     |HAZ MiraLorca;
     #rem00027#125 = eaLorca;

     #rem00027#110 = 0;
     |SI #rem00027#125 = "S";
         #rem00027#110 = #rem00027#98 - #rem00027#108;
         |SI #rem00027#110 > 0;
             #rem00027#110 = #rem00027#110 % 20;
         |SINO;
             #rem00027#110 = 0;
         |FINSI;
     |FINSI;

     #rem00027#114 = #rem00027#98 - #rem00027#108 - #rem00027#110 - #rem00027#109 + #rem00027#113;

     #rem00027#116 = 0;
     |SI #rem00027#115 = "S";
          #rem00027#116 = #rem00027#113 % 30;
          |SI #rem00027#116 > 90000; #rem00027#116 = 90000;  |FINSI;
     |FINSI;

     #rem00027#117 = #rem00027#114 - #rem00027#116;
|FPRC;

|PROCESO ModModulo;
     #dsmom017#0  = #dsmom018#0;
     #dsmom017#1  = #dsmom018#1;
     #dsmom017#2  = #dsmom018#2;
     #dsmom017#3  = #dsmom018#3;
     |LEE 040#dsmom017.=;
     |SI FSalida ! 0;  |DDEFECTO #dsmom017;  |FINSI;

     #reeleact#0 = #dsmom017#4;
     #reeleact#1 = #dsmom017#5;
     #reeleact#2 = #dsmom017#6;
     |LEE 040#reeleact.=;
     |SI FSalida ! 0;  |DDEFECTO #reeleact;  |FINSI;

     |ABRE #dsam0005;
     #dsam0005#0 = #agicen14#0;
     #dsam0005#1 = #agicen14#1;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     #rem00027#0 = #reacceso#0;
     #rem00027#1 = nContaAct;
     |LEE 101#rem00027.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00027;
         #rem00027#0 = #reacceso#0;
         #rem00027#1 = nContaAct;
         |GRABA 020#rem00027.b;
     |FINSI;

     #rem00027#2  = eaPerceptor;
     #rem00027#3  = "A";
     #rem00027#4  = 0;
     |SI nPorce ! 100;
         #rem00027#14  = "S";
         #rem00027#19  = #dsam0000#3;
         #rem00027#126 = #dsam0000#1;
     |FINSI;
     #rem00027#15 = nPorce;
     #rem00027#16 = #dsmom017#4;
     #rem00027#17 = #dsmom017#5;
     #rem00027#18 = #dsmom017#6;
     #rem00027#20 = #reeleact#3;
     #rem00027#21 = #dsam0005#9;
     #rem00027#22 = #dsam0005#10;
     aAlfa   = #dsam0005#3 + " " + #dsam0005#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #dsam0005#5;
     #rem00027#23 = aAlfa;

     #rem00027#24 = #reeleact#5;
     #rem00027#25 = #reeleact#8;
     #rem00027#26 = #reeleact#11;
     #rem00027#27 = #reeleact#14;
     #rem00027#28 = #reeleact#17;
     #rem00027#29 = #reeleact#20;
     #rem00027#30 = #reeleact#23;

     #rem00027#38 = #reeleact#6;
     #rem00027#39 = #reeleact#9;
     #rem00027#40 = #reeleact#12;
     #rem00027#41 = #reeleact#15;
     #rem00027#42 = #reeleact#18;
     #rem00027#43 = #reeleact#21;
     #rem00027#44 = #reeleact#24;

     nUni    = #dsmom018#48;
     nTotal  = #dsmom018#15 * #dsmom018#48;
     |SI nTotal ! #dsmom018#59;
         nUni = #dsmom018#59 / #dsmom018#15;
     |FINSI;
     #rem00027#31 = nUni;

     nUni    = #dsmom018#49;
     nTotal  = #dsmom018#16 * #dsmom018#49;
     |SI nTotal ! #dsmom018#60;
         nUni = #dsmom018#60 / #dsmom018#16;
     |FINSI;
     #rem00027#32 = nUni;

     nUni    = #dsmom018#50;
     nTotal  = #dsmom018#17 * #dsmom018#50;
     |SI nTotal ! #dsmom018#61;
         nUni = #dsmom018#61 / #dsmom018#17;
     |FINSI;
     #rem00027#33 = nUni;

     nUni    = #dsmom018#51;
     nTotal  = #dsmom018#18 * #dsmom018#51;
     |SI nTotal ! #dsmom018#62;
         nUni = #dsmom018#62 / #dsmom018#18;
     |FINSI;
     #rem00027#34 = nUni;

     nUni    = #dsmom018#52;
     nTotal  = #dsmom018#19 * #dsmom018#52;
     |SI nTotal ! #dsmom018#63;
         nUni = #dsmom018#63 / #dsmom018#19;
     |FINSI;
     #rem00027#35 = nUni;

     nUni    = #dsmom018#53;
     nTotal  = #dsmom018#20 * #dsmom018#53;
     |SI nTotal ! #dsmom018#64;
         nUni = #dsmom018#64 / #dsmom018#20;
     |FINSI;
     #rem00027#36 = nUni;

     nUni    = #dsmom018#54;
     nTotal  = #dsmom018#21 * #dsmom018#54;
     |SI nTotal ! #dsmom018#65;
         nUni = #dsmom018#65 / #dsmom018#21;
     |FINSI;
     #rem00027#37 = nUni;

     #rem00027#52 = 0;
     |PARA nCampo = 45;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           nCampo1 = nCampo - 14;
           nCampo2 = nCampo - 7;
           #rem00027#nCampo# = #rem00027#nCampo1# * #rem00027#nCampo2#;
           #rem00027#52 = #rem00027#52 + #rem00027#nCampo#;
     |SIGUE;

     #rem00027#53  = #dsmom018#133;

     #rem00027#54  = #dsmom018#194;
     #rem00027#55  = #dsmom018#98;
     #rem00027#56  = #dsmom018#195;
     #rem00027#57  = #rem00027#38;
     #rem00027#58  = #dsmom018#196;

     #rem00027#59  = #dsmom018#197;
     #rem00027#60  = #dsmom018#100;
     #rem00027#61  = #dsmom018#198;
     #rem00027#62  = #rem00027#39;
     #rem00027#63  = #dsmom018#199;

     #rem00027#65  = #dsmom018#201;
     #rem00027#66  = #dsmom018#202;
     #rem00027#67  = #dsmom018#203;
     #rem00027#68  = #dsmom018#204;
     #rem00027#69  = #dsmom018#205;
     #rem00027#70  = #dsmom018#206;
     #rem00027#71  = #dsmom018#207;
     #rem00027#72  = #dsmom018#208;
     #rem00027#73  = #dsmom018#209;
     #rem00027#74  = #dsmom018#210;
     #rem00027#75  = #dsmom018#211;
     #rem00027#76  = #dsmom018#212;
     #rem00027#77  = #dsmom018#213;
     #rem00027#80  = #dsmom018#216;
     #rem00027#82  = #dsmom018#218;
     #rem00027#84  = #dsmom018#220;
     #rem00027#86  = #dsmom018#222;
     #rem00027#88  = #dsmom018#224;
     #rem00027#90  = #dsmom018#226;
     #rem00027#91  = #dsmom018#227;
     #rem00027#92  = #dsmom018#228;
     #rem00027#93  = #dsmom018#229;
     #rem00027#94  = #dsmom018#230;
     #rem00027#95  = #dsmom018#231;
     #rem00027#96  = #dsmom018#232;
     #rem00027#109 = #dsmom018#245;
     #rem00027#113 = #dsmom018#249;
     #rem00027#115 = #dsmom018#251;
     #rem00027#119 = "N";
     #rem00027#120 = 0;
     #rem00027#121 = 0;
     #rem00027#122 = #dsmom017#26;

     |SI #dsmom017#28 = "S";
         #rem00027#119 = "F";
         #rem00027#121 = #dsmom017#30;
     |FINSI;

     #rem00027#127 = nActividad;

     |HAZ TotalModulo;

     |GRABA 020#rem00027.a;
     |LIBERA #rem00027;

     eaPrograma   = "rem00027";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |SI #rem00027#14 = "S";
         |ABRE #rem00058;
         |SELECT #2#rem00058;
         #rem00058#0  = #rem00027#0;
         #rem00058#14 = "E3";
         #rem00058#15 = #rem00027#1;
         |LEE 040#rem00058.=;
         |SI FSalida ! 0;
             |SELECT #1#rem00058;
             #rem00058#0 = #rem00027#0;
             #rem00058#1 = 99;
             |LEE 040#rem00058.];
             |SI FSalida = 0;
                 |LEE 040#rem00058.a;
             |SINO;
                 |LEE 040#rem00058.u;
             |FINSI;
             nLinea = 1;

             |SI FSalida = 0;  |Y #rem00058#0 = #rem00027#0;
                 nLinea = #rem00058#1 + 1;
             |FINSI;
         |SINO;
             nLinea = #rem00058#1;
         |FINSI;

         |DDEFECTO #rem00058;
         |SELECT #1#rem00058;
         #rem00058#0  = #rem00027#0;
         #rem00058#1  = nLinea;
         |LEE 101#rem00058.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00058;
             #rem00058#0  = #rem00027#0;
             #rem00058#1  = nLinea;
             |GRABA 020#rem00058.b;
         |FINSI;

         #rem00058#2  = #rem00027#2;
         #rem00058#3  = "R";
         #rem00058#4  = #rem00027#4;
         #rem00058#5  = #rem00027#5;
         #rem00058#6  = #rem00027#6;
         #rem00058#7  = #rem00027#7;
         #rem00058#8  = #rem00027#8;
         #rem00058#9  = #rem00027#9;
         #rem00058#10 = #rem00027#10;
         #rem00058#11 = #rem00027#15;
         #rem00058#12 = #rem00027#19;
         #rem00058#13 = 3;
         #rem00058#14 = "E3";
         #rem00058#15 = #rem00027#1;
         #rem00058#27 = #rem00027#114 % #rem00058#11;
         #rem00058#29 = #rem00027#116 % #rem00058#11;
         #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;

         |GRABA 020#rem00058.a;
         |LIBERA #rem00058;
         |CIERRA #rem00058;

         eaPrograma   = "rem00058";
         eaPunto      = #rem00058#13;
         |HAZ ProgramaActivo;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom018;
     #dsmom018#1;
     ;
     nEmpresa, 2016, 00, nActividad;
     nEmpresa, 2016, 99, nActividad;
     ;
     NULL, ModModulo;
|FIN;

|PROCESO Modulos;
     |HAZ PintaPantalla;
     |PINTA 1218, "*";

     |ABRE #reeleact;
     |ABRE #rem00027;
     |ABRE #dsmom017;
     |BUCLE dsmom018;
     |CIERRA #reeleact;
     |CIERRA #rem00027;
     |CIERRA #dsmom017;
|FPRC;


|| \_________________________________ Recogida desde Contabilidad

|PROCESO ModNormal;
     |ABRE #dsam0005;
     #dsam0005#0 = #agicen14#0;
     #dsam0005#1 = #agicen14#1;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     |ABRE #rem00025;
     #rem00025#0 = #reacceso#0;
     #rem00025#1 = nContaAct;
     |LEE 101#rem00025.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00025;
         #rem00025#0 = #reacceso#0;
         #rem00025#1 = nContaAct;
         |GRABA 020#rem00025.b;
     |FINSI;

     #rem00025#2  = eaPerceptor;
     #rem00025#3  = "A";
     #rem00025#4  = 0;
     |SI nPorce ! 100;
         #rem00025#14 = "S";
         #rem00025#21 = #dsam0000#3;
         #rem00025#58 = #dsam0000#1;
     |FINSI;
     #rem00025#15 = nPorce;

                      #rem00025#17 = "1";
     |SI #agicen30#12 = 1;  #rem00025#17 = "1";  |FINSI;
     |SI #agicen30#12 = 2;  #rem00025#17 = "3";  |FINSI;
     |SI #agicen30#12 = 3;  #rem00025#17 = "2";  |FINSI;
     |SI #agicen30#12 = 5;  #rem00025#17 = "4";  |FINSI;
     |SI #agicen30#12 = 4;  #rem00025#17 = "5";  |FINSI;

     #rem00025#18 = #agicen30#3;
     #rem00025#19 = #agicen30#4;
     |SI #rem00025#19 = "9999";  #rem00025#19 = "    ";  |FINSI;
     #rem00025#22 = #agicen30#5;
     #rem00025#23 = #dsam0005#9;
     #rem00025#24 = #dsam0005#10;
     aAlfa  = #dsam0005#3 + " " + #dsam0005#4;  |QBF aAlfa;
     aAlfa  = aAlfa + " " + #dsam0005#5;
     #rem00025#25 = aAlfa;

     |SI #dsmom014#7 = 01;  #rem00025#26 = #rem00025#26 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 02;  #rem00025#27 = #rem00025#27 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 03;  #rem00025#28 = #rem00025#28 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 04;  #rem00025#30 = #rem00025#30 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 05;  #rem00025#31 = #rem00025#31 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 06;  #rem00025#32 = #rem00025#32 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 07;  #rem00025#33 = #rem00025#33 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 08;  #rem00025#34 = #rem00025#34 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 09;  #rem00025#35 = #rem00025#35 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 10;  #rem00025#36 = #rem00025#36 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 11;  #rem00025#37 = #rem00025#37 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 12;  #rem00025#37 = #rem00025#37 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 13;  #rem00025#38 = #rem00025#38 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 14;  #rem00025#39 = #rem00025#39 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 15;  #rem00025#40 = #rem00025#40 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 20;  #rem00025#41 = #rem00025#41 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 16;  #rem00025#42 = #rem00025#42 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 17;  #rem00025#43 = #rem00025#43 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 18;  #rem00025#49 = #rem00025#49 + nImporte;  |FINSI;
     |SI #dsmom014#7 = 19;  #rem00025#50 = #rem00025#50 + nImporte;  |FINSI;

     #rem00025#29 = #rem00025#26 + #rem00025#27 + #rem00025#28;
     #rem00025#44 = 0;
     |PARA nCampo = 30;  |SI nCampo [ 43;  |HACIENDO nCampo = nCampo + 1;
           #rem00025#44 = #rem00025#44 + #rem00025#nCampo#;
     |SIGUE;

     #rem00025#44 = #rem00025#44 + #rem00025#49;
     #rem00025#44 = #rem00025#44 + #rem00025#50;

     #rem00025#45 = #rem00025#29 - #rem00025#44;

     #rem00025#47 = 0;
     |SI #rem00025#46 = "S";
         #rem00025#47 = #rem00025#45 % 30;
          |SI #rem00025#47 > 90000; #rem00025#47 = 90000;  |FINSI;
     |FINSI;

     #rem00025#48 = #rem00025#45 - #rem00025#47;
     #rem00025#60 = nDepar;

     |GRABA 020#rem00025.a;
     |LIBERA #rem00025;
     |CIERRA #rem00025;

     eaPrograma   = "rem00025";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |SI #rem00025#14 = "S";
         |ABRE #rem00058;
         |SELECT #2#rem00058;
         #rem00058#0  = #rem00025#0;
         #rem00058#14 = "E1";
         #rem00058#15 = #rem00025#1;
         |LEE 040#rem00058.=;
         |SI FSalida ! 0;
             |SELECT #1#rem00058;
             #rem00058#0 = #rem00025#0;
             #rem00058#1 = 99;
             |LEE 040#rem00058.];
             |SI FSalida = 0;
                 |LEE 040#rem00058.a;
             |SINO;
                 |LEE 040#rem00058.u;
             |FINSI;
             nLinea = 1;

             |SI FSalida = 0;  |Y #rem00058#0 = #rem00025#0;
                 nLinea = #rem00058#1 + 1;
             |FINSI;
         |SINO;
             nLinea = #rem00058#1;
         |FINSI;

         |DDEFECTO #rem00058;
         |SELECT #1#rem00058;
         #rem00058#0  = #rem00025#0;
         #rem00058#1  = nLinea;
         |LEE 101#rem00058.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00058;
             #rem00058#0  = #rem00025#0;
             #rem00058#1  = nLinea;
             |GRABA 020#rem00058.b;
         |FINSI;

         #rem00058#2  = #rem00025#2;
         #rem00058#3  = "R";
         #rem00058#4  = #rem00025#4;
         #rem00058#5  = #rem00025#5;
         #rem00058#6  = #rem00025#6;
         #rem00058#7  = #rem00025#7;
         #rem00058#8  = #rem00025#8;
         #rem00058#9  = #rem00025#9;
         #rem00058#10 = #rem00025#10;
         #rem00058#11 = #rem00025#15;
         #rem00058#12 = #rem00025#21;
         #rem00058#14 = "E1";
         #rem00058#15 = #rem00025#1;

         |SI #rem00025#19 ! "8612";
             #rem00058#13 = 3;
             #rem00058#27 = #rem00025#45 % #rem00058#11;
             #rem00058#29 = #rem00025#47 % #rem00058#11;
             #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;
         |SINO;
             #rem00058#13 = 2;
             #rem00058#23 = #rem00025#45 % #rem00058#11;
             #rem00058#25 = #rem00025#47 % #rem00058#11;
             #rem00058#26 = #rem00058#23 - #rem00058#24 - #rem00058#25;
         |FINSI;

         |GRABA 020#rem00058.a;
         |LIBERA #rem00058;
         |CIERRA #rem00058;

         eaPrograma   = "rem00058";
         eaPunto      = #rem00058#13;
         |HAZ ProgramaActivo;
     |FINSI;
|FPRC;

|PROCESO ModSimpli;
     |ABRE #dsam0005;
     #dsam0005#0 = #agicen14#0;
     #dsam0005#1 = #agicen14#1;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     |ABRE #rem00026;
     #rem00026#0 = #reacceso#0;
     #rem00026#1 = nContaAct;
     |LEE 101#rem00026.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00026;
         #rem00026#0 = #reacceso#0;
         #rem00026#1 = nContaAct;
         |GRABA 020#rem00026.b;
     |FINSI;

     #rem00026#2  = eaPerceptor;
     #rem00026#3  = "A";
     #rem00026#4  = 0;
     |SI nPorce ! 100;
         #rem00026#14 = "S";
         #rem00026#21 = #dsam0000#3;
         #rem00026#60 = #dsam0000#1;
     |FINSI;
     #rem00026#15 = nPorce;

                      #rem00026#17 = "1";
     |SI #agicen30#12 = 1;  #rem00026#17 = "1";  |FINSI;
     |SI #agicen30#12 = 2;  #rem00026#17 = "3";  |FINSI;
     |SI #agicen30#12 = 3;  #rem00026#17 = "2";  |FINSI;
     |SI #agicen30#12 = 5;  #rem00026#17 = "4";  |FINSI;
     |SI #agicen30#12 = 4;  #rem00026#17 = "5";  |FINSI;

     #rem00026#18 = #agicen30#3;
     #rem00026#19 = #agicen30#4;
     |SI #rem00026#19 = "9999";  #rem00026#19 = "    ";  |FINSI;
     #rem00026#22 = #agicen30#5;
     #rem00026#23 = #dsam0005#9;
     #rem00026#24 = #dsam0005#10;
     aAlfa  = #dsam0005#3 + " " + #dsam0005#4;  |QBF aAlfa;
     aAlfa  = aAlfa + " " + #dsam0005#5;
     #rem00026#25 = aAlfa;

     |SI #dsmom014#8 = 01;  #rem00026#26 = #rem00026#26 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 02;  #rem00026#27 = #rem00026#27 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 03;  #rem00026#28 = #rem00026#28 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 04;  #rem00026#30 = #rem00026#30 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 05;  #rem00026#31 = #rem00026#31 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 06;  #rem00026#32 = #rem00026#32 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 07;  #rem00026#33 = #rem00026#33 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 08;  #rem00026#34 = #rem00026#34 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 09;  #rem00026#35 = #rem00026#35 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 10;  #rem00026#36 = #rem00026#36 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 11;  #rem00026#36 = #rem00026#36 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 12;  #rem00026#37 = #rem00026#37 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 13;  #rem00026#38 = #rem00026#38 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 14;  #rem00026#39 = #rem00026#39 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 15;  #rem00026#41 = #rem00026#41 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 16;  #rem00026#49 = #rem00026#49 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 17;  #rem00026#52 = #rem00026#52 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 18;  #rem00026#50 = #rem00026#50 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 19;  #rem00026#51 = #rem00026#51 + nImporte;  |FINSI;
     |SI #dsmom014#8 = 20;  #rem00026#40 = #rem00026#40 + nImporte;  |FINSI;

     #rem00026#29 = #rem00026#26 + #rem00026#27 + #rem00026#28;
     #rem00026#42 = 0;
     |PARA nCampo = 30;  |SI nCampo [ 41;  |HACIENDO nCampo = nCampo + 1;
           #rem00026#42 = #rem00026#42 + #rem00026#nCampo#;
     |SIGUE;
     #rem00026#42 = #rem00026#42 + #rem00026#50;
     #rem00026#42 = #rem00026#42 + #rem00026#51;
     #rem00026#42 = #rem00026#42 + #rem00026#52;
     #rem00026#43 = #rem00026#29 - #rem00026#42;

     nPorceGasto = 5;
     |SI #rem00026#17 = "6";
         nPorceGasto = 10;
     |FINSI;

                       #rem00026#44 = #rem00026#49;
     |SI #rem00026#43 > 0;  #rem00026#44 = #rem00026#44 + (#rem00026#43 % nPorceGasto);   |FINSI;
     |SI #rem00026#44 > 2000;  #rem00026#44 = 2000;  |FINSI;


     |SI #rem00026#56 = "S";
         #rem00026#44 = 0;
     |FINSI;

     #rem00026#45 = #rem00026#43 - #rem00026#44;
     #rem00026#47 = 0;

     |SI #rem00026#46 = "S";
         #rem00026#47 = #rem00026#45 % 30;
          |SI #rem00026#47 > 90000; #rem00026#47 = 90000;  |FINSI;
     |FINSI;

     #rem00026#48 = #rem00026#45 - #rem00026#47;
     #rem00026#62 = nDepar;

     |GRABA 020#rem00026.a;
     |LIBERA #rem00026;
     |CIERRA #rem00026;

     eaPrograma   = "rem00026";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |SI #rem00026#14 = "S";
         |ABRE #rem00058;
         |SELECT #2#rem00058;
         #rem00058#0  = #rem00026#0;
         #rem00058#14 = "E2";
         #rem00058#15 = #rem00026#1;
         |LEE 040#rem00058.=;
         |SI FSalida ! 0;
             |SELECT #1#rem00058;
             #rem00058#0 = #rem00026#0;
             #rem00058#1 = 99;
             |LEE 040#rem00058.];
             |SI FSalida = 0;
                 |LEE 040#rem00058.a;
             |SINO;
                 |LEE 040#rem00058.u;
             |FINSI;
             nLinea = 1;

             |SI FSalida = 0;  |Y #rem00058#0 = #rem00026#0;
                 nLinea = #rem00058#1 + 1;
             |FINSI;
         |SINO;
             nLinea = #rem00058#1;
         |FINSI;

         |DDEFECTO #rem00058;
         |SELECT #1#rem00058;
         #rem00058#0  = #rem00026#0;
         #rem00058#1  = nLinea;
         |LEE 101#rem00058.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00058;
             #rem00058#0  = #rem00026#0;
             #rem00058#1  = nLinea;
             |GRABA 020#rem00058.b;
         |FINSI;

         #rem00058#2  = #rem00026#2;
         #rem00058#3  = "R";
         #rem00058#4  = #rem00026#4;
         #rem00058#5  = #rem00026#5;
         #rem00058#6  = #rem00026#6;
         #rem00058#7  = #rem00026#7;
         #rem00058#8  = #rem00026#8;
         #rem00058#9  = #rem00026#9;
         #rem00058#10 = #rem00026#10;
         #rem00058#11 = #rem00026#15;
         #rem00058#12 = #rem00026#21;
         #rem00058#14 = "E2";
         #rem00058#15 = #rem00026#1;

         |SI #rem00026#19 ! "8612";
             #rem00058#13 = 3;
             #rem00058#27 = #rem00026#45 % #rem00058#11;
             #rem00058#29 = #rem00026#47 % #rem00058#11;
             #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;
         |SINO;
             #rem00058#13 = 2;
             #rem00058#23 = #rem00026#45 % #rem00058#11;
             #rem00058#25 = #rem00026#47 % #rem00058#11;
             #rem00058#26 = #rem00058#23 - #rem00058#24 - #rem00058#25;
         |FINSI;

         |GRABA 020#rem00058.a;
         |LIBERA #rem00058;
         |CIERRA #rem00058;

         eaPrograma   = "rem00058";
         eaPunto      = #rem00058#13;
         |HAZ ProgramaActivo;
     |FINSI;
|FPRC;

|PROCESO CogeLineal;
     #rem00028#25 = #rem00028#25 + #rem00029#6;

     |SI #rem00029#8 = "N";
         #rem00028#26 = #rem00028#26 + #rem00029#7;
     |SINO;
         #rem00028#27 = #rem00028#27 + #rem00029#7;
     |FINSI;
|FPRC;

|DEFBUCLE rem00029;
     #rem00029#1;
     ;
     #rem00028#0, #rem00028#1, 00;
     #rem00028#0, #rem00028#1, 99;
     be;
     NULL, CogeLineal;
|FIN;

|PROCESO TotalAgricultura;
     #rem00028#25 = 0;
     #rem00028#26 = 0;
     #rem00028#27 = 0;
     |BUCLE rem00029;

     #rem00028#33 = #rem00028#31 + #rem00028#32;
     #rem00028#58 = #rem00028#59 + #rem00028#60;

     #rem00028#30 = #rem00028#26 + #rem00028#27;
     #rem00028#34 = #rem00028#30 - #rem00028#58 - #rem00028#33;

     |SI #rem00028#34 < 0;
         #rem00028#35 = 0;
         #rem00028#36 = 0;
         #rem00028#37 = 0;
         #rem00028#38 = 0;
         #rem00028#54 = 0;
         #rem00028#55 = 0;
     |FINSI;

     nCanti1 = #rem00028#26 - #rem00028#59 - #rem00028#31;
     |SI #rem00028#35 ! 0;  nCanti1 = nCanti1 * #rem00028#35;  |FINSI;
     |SI #rem00028#36 ! 0;  nCanti1 = nCanti1 * #rem00028#36;  |FINSI;
     |SI #rem00028#38 ! 0;  nCanti1 = nCanti1 * #rem00028#38;  |FINSI;
     |SI #rem00028#54 ! 0;  nCanti1 = nCanti1 * #rem00028#54;  |FINSI;

     nCanti2 = #rem00028#27 - #rem00028#60 - #rem00028#32;
     |SI #rem00028#35 ! 0;  nCanti2 = nCanti2 * #rem00028#35;  |FINSI;
     |SI #rem00028#36 ! 0;  nCanti2 = nCanti2 * #rem00028#36;  |FINSI;
     |SI #rem00028#37 ! 0;  nCanti2 = nCanti2 * #rem00028#37;  |FINSI;
     |SI #rem00028#38 ! 0;  nCanti2 = nCanti2 * #rem00028#38;  |FINSI;
     |SI #rem00028#54 ! 0;  nCanti2 = nCanti2 * #rem00028#54;  |FINSI;

     #rem00028#39 = 0;
     |SI #rem00028#17 ! "2";  |Y  #rem00028#17 ! "6";  |Y  #rem00028#17 ! "8";
         |SI #rem00028#34 ] 0;
             |SI #rem00028#34 [ 9447.91;
                 |SI #rem00028#47 = 0;
                     #rem00028#39 = 0.9;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00028#39 ! 0;  nCanti1 = nCanti1 * #rem00028#39;  |FINSI;
     |SI #rem00028#55 ! 0;  nCanti1 = nCanti1 * #rem00028#55;  |FINSI;

     |SI #rem00028#39 ! 0;  nCanti2 = nCanti2 * #rem00028#39;  |FINSI;
     |SI #rem00028#55 ! 0;  nCanti2 = nCanti2 * #rem00028#55;  |FINSI;

     |SI #rem00028#35 ! 0;  #rem00028#36 = 0;  |FINSI;
     |SI #rem00028#36 ! 0;  #rem00028#35 = 0;  |FINSI;

     |SI #rem00028#47 > 0;  |O #rem00028#47 = -1;
          #rem00028#39 = 0;
     |FINSI;

     #rem00028#40 = nCanti1 + nCanti2;
     #rem00028#57 = 0;

     |SI #rem00028#40 > 0;
           #rem00028#64 =  5;
           #rem00028#57 = #rem00028#40 % #rem00028#64;
     |SINO;
          #rem00028#64 = 0;
     |FINSI;

     #rem00028#44 = #rem00028#40 - #rem00028#57;
     #rem00028#48 = 0;

     |SI #rem00028#47 > 0;
         #rem00028#48 = #rem00028#44 % #rem00028#47;
     |FINSI;

     |SI #rem00028#48 < 0;  #rem00028#48 = -#rem00028#48;  |FINSI;

     #rem00028#49 = #rem00028#44 - #rem00028#48 - #rem00028#43;

     #rem00028#51 = 0;
     |SI #rem00028#50 = "S";
         #rem00028#51 = #rem00028#49 % 30;
          |SI #rem00028#51 > 90000; #rem00028#51 = 90000;  |FINSI;
     |FINSI;

     #rem00028#52 = #rem00028#49 - #rem00028#51;

     |SI #rem00028#65 = "N";
         #rem00028#67 = 0;
     |FINSI;

     |SI #rem00028#65 = "F";
         |SI #rem00028#67 = 0;
             |SI #rem00028#52 > 0;
                 #rem00028#67 = #rem00028#52 % 20;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00028#65 = "S";
         nImporte1 = 0;
         |SI #rem00028#52 > 0;
             nImporte1 = (#rem00028#52 % 20) ! 2;
         |FINSI;
         nImporte2 = (#rem00028#66 / 2) ! 2;
         |SI nImporte1 > nImporte2;
             nImporte1 = nImporte2;
         |FINSI;

         #rem00028#67 = nImporte1;
     |FINSI;
|FPRC;

|PROCESO ModAgraria;
     |ABRE #dsam0005;
     #dsam0005#0 = #agicen14#0;
     #dsam0005#1 = #agicen14#1;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     |ABRE #rem00500;
     #rem00500#0 = #camaasil#28;
     |LEE 040#rem00500.=;
     |SI FSalida ! 0;  |CIERRA #rem00500;  |ACABA; |FINSI;
     |CIERRA #rem00500;

     |SI #rem00500#5 = 0;  |ACABA;  |FINSI;

     |ABRE #rem00028;
     #rem00028#0 = #reacceso#0;
     #rem00028#1 = nContaAct;
     |LEE 101#rem00028.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00028;
         #rem00028#0 = #reacceso#0;
         #rem00028#1 = nContaAct;

         enActividad = nActividad;
         |HAZ AmortizaAgricola;
         #rem00028#31 = enAmortiza;

         |GRABA 020#rem00028.b;
     |FINSI;

     #rem00028#2  = eaPerceptor;
     #rem00028#3  = "A";
     #rem00028#4  = 0;
     |SI nPorce ! 100;
         #rem00028#14 = "S";
         #rem00028#20 = #dsam0000#3;
         #rem00028#69 = #dsam0000#1;
     |FINSI;
     #rem00028#15 = nPorce;

     aAlfa = #agicen30#4 % 101;

                       #rem00028#17 = "1";
     |SI aAlfa = "0";  #rem00028#17 = "3";  |FINSI;

     #rem00028#18 = #agicen30#3;
     #rem00028#19 = #agicen30#4;
     #rem00028#21 = #agicen30#5;
     #rem00028#22 = #dsam0005#9;
     #rem00028#23 = #dsam0005#10;
     aAlfa   = #dsam0005#3 + " " + #dsam0005#4;  |QBF aAlfa;
     aAlfa   = aAlfa + " " + #dsam0005#5;
     #rem00028#24 = aAlfa;

     |ABRE #rem00029;
     |SELECT #2#rem00029;
     #rem00029#0 = #rem00028#0;
     #rem00029#1 = #rem00028#1;
     #rem00029#3 = #camaasil#28;
     |LEE 040#rem00029.=;
     |SI FSalida = 0;
         nRefer = #rem00029#2;
     |SINO;
         nRefer = 1;
         |SELECT #1#rem00029;
         #rem00029#0 = #rem00028#0;
         #rem00029#1 = #rem00028#1;
         #rem00029#2 = 99;
         |LEE 040#rem00029.];
         |SI FSalida = 0;
             |LEE 040#rem00029.a;
         |SINO;
             |LEE 040#rem00029.u;
         |FINSI;
         |SI FSalida = 0;  |Y #rem00029#0 = #rem00028#0; |Y #rem00029#1 = #rem00028#1;
             nRefer = #rem00029#2 + 1;
        |FINSI;
     |FINSI;

     |SELECT #1#rem00029;
     #rem00029#0 = #rem00028#0;
     #rem00029#1 = #rem00028#1;
     #rem00029#2 = nRefer;
     |LEE 101#rem00029.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00029;
         #rem00029#0 = #rem00028#0;
         #rem00029#1 = #rem00028#1;
         #rem00029#2 = nRefer;
         #rem00029#3 = #camaasil#28;
         #rem00029#5 = #rem00500#5;
         #rem00029#9 = #rem00500#8;
         |GRABA 020#rem00029.b;
     |FINSI;

     nFactor = 1;
     |SI #dsmom014#2 = "I";
         |SI #camaasil#8 = "D"; nFactor = -1; |FINSI;
     |SINO;
         |SI #camaasil#8 = "H"; nFactor = -1; |FINSI;
     |FINSI;

     #rem00029#6 = #rem00029#6 + (((#camaasil#9 / nConversor) * nFactor)) ! 2;
     #rem00029#7 = #rem00029#6 * #rem00029#5;
     #rem00029#8 = "N";

     |GRABA 101#rem00029.a;
     |LIBERA #rem00029;
     |CIERRA #rem00029;

     #rem00028#70 = nDepar;

     |HAZ TotalAgricultura;

     |GRABA 020#rem00028.a;
     |LIBERA #rem00028;
     |CIERRA #rem00028;

     eaPrograma   = "rem00028";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |SI #rem00028#14 = "S";
         |ABRE #rem00058;
         |SELECT #2#rem00058;
         #rem00058#0  = #rem00028#0;
         #rem00058#14 = "E4";
         #rem00058#15 = #rem00028#1;
         |LEE 040#rem00058.=;
         |SI FSalida ! 0;
             |SELECT #1#rem00058;
             #rem00058#0 = #rem00028#0;
             #rem00058#1 = 99;
             |LEE 040#rem00058.];
             |SI FSalida = 0;
                 |LEE 040#rem00058.a;
             |SINO;
                 |LEE 040#rem00058.u;
             |FINSI;
             nLinea = 1;

             |SI FSalida = 0;  |Y #rem00058#0 = #rem00028#0;
                 nLinea = #rem00058#1 + 1;
             |FINSI;
         |SINO;
             nLinea = #rem00058#1;
         |FINSI;

         |DDEFECTO #rem00058;
         |SELECT #1#rem00058;
         #rem00058#0  = #rem00028#0;
         #rem00058#1  = nLinea;
         |LEE 101#rem00058.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00058;
             #rem00058#0  = #rem00028#0;
             #rem00058#1  = nLinea;
             |GRABA 020#rem00058.b;
         |FINSI;

         #rem00058#2  = #rem00028#2;
         #rem00058#3  = "R";
         #rem00058#4  = #rem00028#4;
         #rem00058#5  = #rem00028#5;
         #rem00058#6  = #rem00028#6;
         #rem00058#7  = #rem00028#7;
         #rem00058#8  = #rem00028#8;
         #rem00058#9  = #rem00028#9;
         #rem00058#10 = #rem00028#10;
         #rem00058#11 = #rem00028#15;
         #rem00058#12 = #rem00028#20;
         #rem00058#13 = 3;
         #rem00058#14 = "E4";
         #rem00058#15 = #rem00028#1;
         #rem00058#27 = #rem00028#49 % #rem00058#11;
         #rem00058#29 = #rem00028#51 % #rem00058#11;
         #rem00058#30 = #rem00058#27 - #rem00058#28 - #rem00058#29;

         |GRABA 020#rem00058.a;
         |LIBERA #rem00058;
         |CIERRA #rem00058;

         eaPrograma   = "rem00058";
         eaPunto      = #rem00058#13;
         |HAZ ProgramaActivo;
     |FINSI;
|FPRC;

|PROCESO LeeRetencionArrend;
     #camaniva#0 = #caivalin#0;
     #camaniva#1 = #caivalin#1;
     |LEE 040#camaniva.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #camaniva#10;
     |SI nDepar = 0;  nDepar = nActividad;  |FINSI;
     |SI nDepar ! nActividad;  |ACABA;      |FINSI;

     nImporte = nImporte + ((#caivalin#22 / nConversor) ! 2);
|FPRC;

|DEFBUCLE caivalinArrend;
     #caivalin#1;
     23;
     01, 0000000001, 01, #camaasil#4;
     01, 9999999999, 99, #camaasil#4;
     ;
     NULL, LeeRetencionArrend;
|FIN;

|PROCESO rem00021Cheq;
     nLinea = #rem00021#1;
|FPRC;

|DEFBUCLE rem00021Cheq;
     #rem00021#3;
     2;
     #reacceso#0, #agicen17#3, eaPerceptor;
     #reacceso#0, #agicen17#3, eaPerceptor;
     ;
     NULL, rem00021Cheq;
|FIN;

|PROCESO Arrendamientos;
     nCasilla = 0;
     nImporte = 0;

     |ABRE #agicen17;
     #agicen17#0 = #canempre#2;
     #agicen17#1 = nDepar;
     #agicen17#2 = #camaasil#28;
     |LEE 040#agicen17.=;
     |SI FSalida ! 0;  |CIERRA #agicen17;  |ACABA;  |FINSI;
     |CIERRA #agicen17;

     |ABRE #dsmom022;
     #dsmom022#0 = #camaasil#4;
     |LEE 040#dsmom022.=;
     |SI FSalida = 0;
         |SI aCuenta ! #camaasil#4;
             nImporte = 0;
             |ABRE #camaniva;
             |BUCLE caivalinArrend;
             |CIERRA #camaniva;
             nCasilla = 5;
             |SI nImporte = 0;  nError = 1;  |FINSI;
         |SINO;
             nCasilla = 0;
             nImporte = 0;
         |FINSI;
     |SINO;
         |SI #camaasil#0 = 99;  |ACABA;  |FINSI;

         nCasilla = #dsmom014#9;
     |FINSI;
     |CIERRA #dsmom022;

     aCuenta = #camaasil#4;

     |SI nError = 1;  |Y nImporte = 0;  |ACABA;  |FINSI;

     |ABRE #agicen18;
     #agicen18#0 = #agicen17#0;
     #agicen18#1 = #agicen17#1;
     #agicen18#2 = #agicen17#2;
     #agicen18#3 = 2016;
     |LEE 101#agicen18.=;
     |SI FSalida ! 0;
         |MENAV "0000No existe el ejercicio 2016 en el fichero de Referencias Catastrales";
         |MENAV "0000Introduzca los valores en el capital inmobiliario y se actualizaran automaticamente";

         |DDEFECTO #agicen18;
         #agicen18#0 = #agicen17#0;
         #agicen18#1 = #agicen17#1;
         #agicen18#2 = #agicen17#2;
         #agicen18#3 = 2016;
         |GRABA 020#agicen18.n;
         |LIBERA #agicen18;
     |FINSI;
     |CIERRA #agicen18;

     |SI nImporte = 0;
         nFactor = 1;
         |SI #dsmom014#2 = "I";
             |SI #camaasil#8 = "D"; nFactor = -1; |FINSI;
         |SINO;
             |SI #camaasil#8 = "H"; nFactor = -1; |FINSI;
         |FINSI;

         nImporte = ((#camaasil#9 / nConversor) * nFactor) ! 2;
     |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     nLinea = 0;
     |BUCLE rem00021Cheq;

     |ABRE #rem00021;
     |SI nLinea = 0;
         nLinea = 1;
         |SELECT #1#rem00021;
         #rem00021#0 = #reacceso#0;
         #rem00021#1 = 99;
         |LEE 040#rem00021.];
         |SI FSalida = 0;
             |LEE 040#rem00021.a;
         |SINO;
             |LEE 040#rem00021.u;
         |FINSI;
         |SI FSalida = 0;  |Y #rem00021#0 = #reacceso#0;
             nLinea = #rem00021#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #rem00021#0 = #reacceso#0;
                       #rem00021#1 = nLinea;
                       |LEE 040#rem00021.=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |CIERRA #rem00021;  |ACABA;  |FINSI;

     |SELECT #1#rem00021;
     #rem00021#0 = #reacceso#0;
     #rem00021#1 = nLinea;
     |LEE 101#rem00021.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00021;
         #rem00021#0 = #reacceso#0;
         #rem00021#1 = nLinea;
         #rem00021#3  = "X";
         |GRABA 020#rem00021.b;
     |FINSI;

     |SI #rem00021#3 ! "X";  |ACABA;  |FINSI;

     #rem00021#2   = eaPerceptor;
     #rem00021#3   = "X";
     #rem00021#4   = 0;
     aAlfa    = #agicen17#10 + " " + #agicen17#11;  |QBF aAlfa;
     aAlfa    = aAlfa + " " + #agicen17#12;
     #rem00021#13  = aAlfa;
     #rem00021#14  = #agicen17#3;
     #rem00021#31  = 366;
     #rem00021#105 = #agicen17#6;
     #rem00021#106 = #agicen17#7;
     #rem00021#18  = #agicen17#16;

     |SI nCasilla = 1;   #rem00021#38  = #rem00021#38  + nImporte;  |FINSI;
     |SI nCasilla = 2;   #rem00021#40  = #rem00021#40  + nImporte;  |FINSI;
     |SI nCasilla = 3;   #rem00021#42  = #rem00021#42  + nImporte;  |FINSI;
     |SI nCasilla = 4;   #rem00021#44  = #rem00021#44  + nImporte;  |FINSI;
     |SI nCasilla = 5;   #rem00021#47  = #rem00021#47  + nImporte;  |FINSI;
     |SI nCasilla = 6;   #rem00021#22  = #rem00021#22  + nImporte;  |FINSI;
     |SI nCasilla = 7;   #rem00021#21  = #rem00021#21  + nImporte;  |FINSI;
     |SI nCasilla = 8;   #rem00021#51  = #rem00021#51  + nImporte;  |FINSI;
     |SI nCasilla = 9;   #rem00021#53  = #rem00021#53  + nImporte;  |FINSI;
     |SI nCasilla = 10;  #rem00021#57  = #rem00021#57  + nImporte;  |FINSI;
     |SI nCasilla = 11;  #rem00021#60  = #rem00021#60  + nImporte;  |FINSI;
     |SI nCasilla = 12;  #rem00021#55  = #rem00021#55  + nImporte;  |FINSI;
     |SI nCasilla = 13;  #rem00021#133 = #rem00021#133 + nImporte;  |FINSI;

     |SI #agicen18#4 ! 0;     #rem00021#15 = #agicen18#4;              |FINSI;
     |SI #agicen18#5 ! 0;     #rem00021#21 = #agicen18#5;              |FINSI;

     #rem00021#28 = #rem00021#15 % 20;

     |SI #agicen18#6 ! 0;     #rem00021#28 = #agicen18#6;              |FINSI;

     aCuenta = #camaasil#4;

     |SI #rem00021#60 ! 0;  #rem00021#58 = 0;  |FINSI;

     #rem00021#117 = "S";
     nNume    = #camaasil#28;
     #rem00021#118 = nNume;

     #rem00021#137 = "N";
     |SI nAtribucion = 1;
         #rem00021#137 = "S";
         #rem00021#138 = #dsam0000#3;
         #rem00021#139 = #dsmom001#7;

         #rem00021#36  = "N";
         #rem00021#46  = "A";  #rem00021#47  = 0;
         #rem00021#37  = "A";  #rem00021#38  = 0;
         #rem00021#39  = "A";  #rem00021#40  = 0;
         #rem00021#41  = "A";  #rem00021#42  = 0;
         #rem00021#43  = "A";  #rem00021#44  = 0;
         #rem00021#140 = 0;
         #rem00021#48  = "A";  #rem00021#22  = 0;
         #rem00021#130 = "A";  #rem00021#131 = 0;
         #rem00021#49  = "A";  #rem00021#21  = 0;
         #rem00021#50  = "A";  #rem00021#51  = 0;
         #rem00021#52  = "A";  #rem00021#53  = 0;
         #rem00021#56  = "A";  #rem00021#57  = 0;
         #rem00021#112 = 0;
         #rem00021#113 = 0;
         #rem00021#114 = 0;
         #rem00021#58  = 0;
         #rem00021#59  = "A";  #rem00021#115 = 0;
         #rem00021#60  = 0;
         #rem00021#54  = "A";  #rem00021#55  = 0;
         #rem00021#132 = "A";  #rem00021#133 = 0;
     |FINSI;

     enEmpresa = #rem00021#0;
     eaRefCast = #rem00021#14;
     |HAZ RecogeGastos;

     #rem00021#156 = enGastos;
     #rem00021#157 = 0;
     #rem00021#158 = 0;
     #rem00021#159 = 0;
     #rem00021#140 = enGastos;

     #rem00021#37  = "A";
     #rem00021#39  = "A";
     #rem00021#41  = "A";
     #rem00021#43  = "A";
     #rem00021#46  = "A";
     #rem00021#48  = "A";
     #rem00021#49  = "A";
     #rem00021#50  = "A";
     #rem00021#52  = "A";
     #rem00021#54  = "A";
     #rem00021#56  = "A";
     #rem00021#59  = "A";
     #rem00021#130 = "A";
     #rem00021#132 = "A";

                          #rem00021#143 = "";
     |SI #rem00021#117 = "S";  #rem00021#143 = eaAzul;  |FINSI;
     |SI #rem00021#3   = "X";  #rem00021#143 = eaRojo;  |FINSI;

     #rem00021#128 = "D";
     |SI #agicen30#8 ! 1;  |Y #agicen30#8 ! 18;  |Y #agicen30#8 ! 19;   || 1002/530
         #rem00021#128 = "A";
     |FINSI;

     |GRABA 020#rem00021.a;
     |LIBERA #rem00021;
     |CIERRA #rem00021;

     nSwInMobi    = 1;
     eaPrograma   = "rem00021";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO MiraCuentas;
     nError = 0;
     aAlfa  = #camaasil#4 % 104;
     #dsmom014#10  = 2008;
     #dsmom014#0   = aAlfa;
     |LEE 040#dsmom014.=;
     |SI FSalida ! 0;  nError = 1;  |FINSI;

     nDepar = #camaasil#21;
     |SI nDepar = 0;  nDepar = nActividad;  |FINSI;

     |SI nDepar ! nActividad;  |ACABA;      |FINSI;

     |SI #camaasil#28 ! "   ";
         |SI #agicen30#4 = "8612";
             |HAZ Arrendamientos;

             |SI #agicen30#8 ! 1;  |Y #agicen30#8 ! 18;  |Y #agicen30#8 ! 19;   || 1002/530
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #camaasil#0 = 99;  |ACABA;  |FINSI;

     |SI nError = 1;  |ACABA;  |FINSI;

     |SI #agicen30#8 = 3;  |O #agicen30#8 = 8;  |O #agicen30#8 = 13;
      |O #agicen30#8 = 18; |O #agicen30#8 = 19;
          nFactor = 1;
          |SI #dsmom014#2 = "I";
              |SI #camaasil#8 = "D"; nFactor = -1; |FINSI;
          |SINO;
              |SI #camaasil#8 = "H"; nFactor = -1; |FINSI;
          |FINSI;

          nImporte =  ((#camaasil#9 / nConversor) * nFactor) ! 2;
          |SI nImporte ! 0;  |HAZ ModNormal;  |FINSI;
     |FINSI;

     |SI #agicen30#8 = 4;  |O #agicen30#8 = 9;  |O #agicen30#8 = 14;
          nFactor = 1;
          |SI #dsmom014#2 = "I";
              |SI #camaasil#8 = "D"; nFactor = -1; |FINSI;
          |SINO;
              |SI #camaasil#8 = "H"; nFactor = -1; |FINSI;
          |FINSI;

          nImporte =  ((#camaasil#9 / nConversor) * nFactor) ! 2;
          |SI nImporte ! 0;  |HAZ ModSimpli;  |FINSI;
     |FINSI;

     |SI #agicen30#8 = 7;  |O #agicen30#8 = 12;  |O #agicen30#8 = 17;
      |O #agicen30#8 = 6;  |O #agicen30#8 = 11;  |O #agicen30#8 = 16;
         |SI #camaasil#28 ! "   ";
             |SI #dsmom014#2 = "I";
                 |HAZ ModAgraria;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE camaasil;
     #camaasil#3;
     0;
     "            ", "01.01.2016", 000001, 0001, 00;
     "zzzzzzzzzzzz", "31.12.2016", 999999, 9999, 99;
     ;
     NULL, MiraCuentas;
|FIN;

|PROCESO LeeRetencion;
     #camaniva#0 = #caivalin#0;
     #camaniva#1 = #caivalin#1;
     |LEE 040#camaniva.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #camaniva#10;
     |SI nDepar = 0;  nDepar = nActividad;  |FINSI;
     |SI nDepar ! nActividad;  |ACABA;      |FINSI;

     nRetencion = nRetencion + ((#caivalin#22 / nConversor) ! 2);
|FPRC;

|DEFBUCLE caivalin;
     #caivalin#1;
     ;
     01, 0000000001, 01;
     01, 9999999999, 99;
     ;
     NULL, LeeRetencion;
|FIN;

|PROCESO Contabilidad;
     |HAZ PintaPantalla;
     |PINTA 1118, "*";

     |ABRE #canempre;
     |SELECT #4#canempre;
     #canempre#2  = nEmpresa;
     #canempre#26 = 16;               || Ejercicio 2016
     |LEE 040#canempre.=;
     |SI FSalida ! 0;
         |CIERRA #canempre;
         |ACABA;
     |FINSI;

     nConversor = 1;

     |DBASS aBase;  |QBF aBase;
     aPathFich = aBase + "contagen/fich/" + (("00000" + #canempre#2) % -105) + #canempre#3 + "/";

     |PATH_DAT #camaasil#aPathFich#;
     |PATH_DAT #caivalin#aPathFich#;
     |PATH_DAT #camaniva#aPathFich#;

     |ABRE #dsmom014;
     aCuenta = "";
     |BUCLE camaasil;
     |CIERRA #dsmom014;

     |SI #agicen30#8 = 7;  |O #agicen30#8 = 12;  |O #agicen30#8 = 17;
      |O #agicen30#8 = 6;  |O #agicen30#8 = 11;  |O #agicen30#8 = 16;
      |O #agicen30#8 = 13;
         nRetencion = 0;
         |ABRE #camaniva;
         |BUCLE caivalin;
         |CIERRA #camaniva;
         |SI nRetencion ! 0;
             nRetencion = nRetencion % nPorce;
             |ABRE #rem00031;
             |HAZ GrabaPagosConta;
             |CIERRA #rem00031;
         |FINSI;
         nRetencion = 0;
     |FINSI;
|FPRC;

|| \_________________________________ Recogida desde Planillas

|PROCESO Ingresos;
     #dsmom004#0 = #dsmom010#0;
     #dsmom004#1 = #dsmom010#1;
     #dsmom004#2 = #dsmom010#2;
     #dsmom004#3 = 130;
     #dsmom004#4 = #dsmom010#3 + 1;
     |LEE 000#dsmom004.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nPlanilla = 1;

     #dsmom014#10  = 2008;
     #dsmom014#0   = #dsmom010#5;
     |LEE 040#dsmom014.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #dsmom010#4;

     nFactor = 1;
     |SI #dsmom010#7 = "-";  nFactor = -1;  |FINSI;

     nImporte =  #dsmom010#8 * nFactor;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI #agicen30#8 = 3;  |O #agicen30#8 = 8;  |O #agicen30#8 = 13;
      |O #agicen30#8 = 18; |O #agicen30#8 = 19;
         |HAZ ModNormal;
     |FINSI;

     |SI #agicen30#8 = 4;  |O #agicen30#8 = 9;  |O #agicen30#8 = 14;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom010;
     #dsmom010#1;
     ;
     nEmpresa, 2016, 00, 00, nActividad, "    ";
     nEmpresa, 2016, 99, 99, nActividad, "zzzz";
     ;
     NULL, Ingresos;
|FIN;

|PROCESO PonExistencias;
     nImporte = nImporte + (#dsmom011#8 - #dsmom011#9);
     nEnExi = 1;
|FPRC;

|DEFBUCLE dsmom011;
     #dsmom011#2;
     ;
     #dsmom012#0, #dsmom012#1, #dsmom012#2, #dsmom012#3, #dsmom012#4, #dsmom012#5, "    ";
     #dsmom012#0, #dsmom012#1, #dsmom012#2, #dsmom012#3, #dsmom012#4, #dsmom012#5, "zzzz";
     ;
     NULL, PonExistencias;
|FIN;

|PROCESO Consumo;
     #dsmom004#0 = #dsmom012#0;
     #dsmom004#1 = #dsmom012#1;
     #dsmom004#2 = #dsmom012#2;
     #dsmom004#3 = 130;
     #dsmom004#4 = #dsmom012#3 + 1;
     |LEE 000#dsmom004.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nPlanilla = 1;

     #dsmom014#10  = 2008;
     #dsmom014#0   = #dsmom012#5;
     |LEE 040#dsmom014.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #dsmom012#4;

     nFactor = 1;
     |SI #dsmom012#7 = "-";  nFactor = -1;  |FINSI;

     nEnExi   = 0;
     nImporte = 0;
     |BUCLE dsmom011;
     |SI nEnExi = 0;
          nImporte = #dsmom012#8 * nFactor;
     |SINO;
          |SI #dsmom012#2 ] 10;  |Y  nEnExi = 1;
              nImporte = nImporte * nFactor;
          |SINO;
              nImporte = 0;
          |FINSI;
     |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI #agicen30#8 = 3;  |O #agicen30#8 = 8;  |O #agicen30#8 = 13;
      |O #agicen30#8 = 18; |O #agicen30#8 = 19;
         |HAZ ModNormal;
     |FINSI;

     |SI #agicen30#8 = 4;  |O #agicen30#8 = 9;  |O #agicen30#8 = 14;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom012;
     #dsmom012#1;
     ;
     nEmpresa, 2016, 00, 00, nActividad, "    ";
     nEmpresa, 2016, 99, 99, nActividad, "zzzz";
     ;
     NULL, Consumo;
|FIN;

|PROCESO Gastos;
     #dsmom004#0 = #dsmom013#0;
     #dsmom004#1 = #dsmom013#1;
     #dsmom004#2 = #dsmom013#2;
     #dsmom004#3 = 130;
     #dsmom004#4 = #dsmom013#3 + 1;
     |LEE 000#dsmom004.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     nPlanilla = 1;

     #dsmom014#10  = 2008;
     #dsmom014#0   = #dsmom013#5;
     |LEE 040#dsmom014.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nDepar = #dsmom013#4;

     nFactor = 1;
     |SI #dsmom013#7 = "-";  nFactor = -1;  |FINSI;

     nImporte =  #dsmom013#8 * nFactor;
     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI #agicen30#8 = 3;  |O #agicen30#8 = 8;  |O #agicen30#8 = 13;
      |O #agicen30#8 = 18; |O #agicen30#8 = 19;
         |HAZ ModNormal;
     |FINSI;

     |SI #agicen30#8 = 4;  |O #agicen30#8 = 9;  |O #agicen30#8 = 14;
         |HAZ ModSimpli;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom013;
     #dsmom013#1;
     ;
     nEmpresa, 2016, 00, 00, nActividad, "    ";
     nEmpresa, 2016, 99, 99, nActividad, "zzzz";
     ;
     NULL, Gastos;
|FIN;

|PROCESO Planilla;
     |ABRE #dsmom014;
     |ABRE #dsmom004;

     |BUCLE dsmom010;
     |BUCLE dsmom012;
     |BUCLE dsmom013;

     |CIERRA #dsmom004;
     |CIERRA #dsmom014;
|FPRC;

|| \_________________________________ Recogida de Pagos Fraccionados

|PROCESO GrabaPagosConta;
     |SI aTipoRet = "M";  |ACABA;  |FINSI;

     #rem00031#0 = #reacceso#0;
     #rem00031#1 = nContaAct;
     |LEE 101#rem00031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00031;
         #rem00031#0 = #reacceso#0;
         #rem00031#1 = nContaAct;
         |GRABA 020#rem00031.b;
     |FINSI;

     #rem00031#2 = eaPerceptor;
     #rem00031#3 = "A";
     #rem00031#4 = 0;

     |SI nRetContab = 0;
         #rem00031#15 = #rem00031#15 + nRetencion;
     |SINO;
         #rem00031#15 = nRetContab;
     |FINSI;

     #rem00031#17 = "N";
     |SI nAtribucion = 1;  #rem00031#17 = "S";  |FINSI;

     |GRABA 020#rem00031.a;
     |LIBERA #rem00031;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO GrabaPagos104;
     |SI aTipoRet = "C";  |ACABA;  |FINSI;

     #rem00031#0 = #reacceso#0;
     #rem00031#1 = nContaAct;
     |LEE 101#rem00031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00031;
         #rem00031#0 = #reacceso#0;
         #rem00031#1 = nContaAct;
         |GRABA 020#rem00031.b;
     |FINSI;

     #rem00031#2 = eaPerceptor;
     #rem00031#3 = "A";
     #rem00031#4 = 0;

     |SI #dsmom104#3 = 3;   #rem00031#11 = #rem00031#11 + #dsmom104#4;  |FINSI;
     |SI #dsmom104#3 = 6;   #rem00031#12 = #rem00031#12 + #dsmom104#4;  |FINSI;
     |SI #dsmom104#3 = 9;   #rem00031#13 = #rem00031#13 + #dsmom104#4;  |FINSI;
     |SI #dsmom104#3 = 12;  #rem00031#14 = #rem00031#14 + #dsmom104#4;  |FINSI;

     |SI nRetContab = 0;
         #rem00031#15 = #rem00031#15 + #dsmom104#5;
     |SINO;
         #rem00031#15 = nRetContab;
     |FINSI;

     #rem00031#17 = "N";
     |SI nAtribucion = 1;  #rem00031#17 = "S";  |FINSI;

     |GRABA 020#rem00031.a;
     |LIBERA #rem00031;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom104;
     #dsmom104#1;
     ;
     130, #agicen14#0, 2016, 01;
     131, #agicen14#0, 2016, 99;
     ;
     NULL, GrabaPagos104;
|FIN;

|PROCESO GrabaPagos130;
     |SI #dsmod130#17 [ 0;  |Y #dsmod130#11 = 0;  |Y #dsmod130#15 = 0;  |Y #dsmod130#23 = 0;
         |ACABA;
     |FINSI;

     #rem00031#0 = #reacceso#0;
     #rem00031#1 = nContaAct;
     |LEE 101#rem00031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00031;
         #rem00031#0 = #reacceso#0;
         #rem00031#1 = nContaAct;
         |GRABA 020#rem00031.b;
     |FINSI;

     #rem00031#2 = eaPerceptor;
     #rem00031#3 = "A";
     #rem00031#4 = 0;

     nPago = #dsmod130#23;

     |SI nPago > 0;
         |SI #dsmod130#2 = 3;   #rem00031#11 = #rem00031#11 + nPago;  |FINSI;
         |SI #dsmod130#2 = 6;   #rem00031#12 = #rem00031#12 + nPago;  |FINSI;
         |SI #dsmod130#2 = 9;   #rem00031#13 = #rem00031#13 + nPago;  |FINSI;
         |SI #dsmod130#2 = 12;  #rem00031#14 = #rem00031#14 + nPago;  |FINSI;
     |FINSI;

     nRetencion1 = #dsmod130#11;
     nRetencion2 = nRetencion2 + #dsmod130#15;

     |SI nRetContab = 0;
         #rem00031#15 = nRetencion1 + nRetencion2;
     |SINO;
         #rem00031#15 = nRetContab;
     |FINSI;

     #rem00031#17 = "N";
     |SI nAtribucion = 1;  #rem00031#17 = "S";  |FINSI;

     |GRABA 020#rem00031.a;
     |LIBERA #rem00031;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmod130;
     #dsmod130#1;
     ;
     #agicen14#0, 2016, 00, 130, 00, 00;
     #agicen14#0, 2016, 99, 130, 99, 00;
     ;
     NULL, GrabaPagos130;
|FIN;

|PROCESO GrabaPagos131;
     #dsmom004#0 = #dsmod131#0;
     #dsmom004#1 = #dsmod131#1;
     #dsmom004#2 = #dsmod131#2;
     #dsmom004#3 = #dsmod131#3;
     #dsmom004#4 = #dsmod131#4 + 1;
     |LEE 000#dsmom004.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |SI #dsmod131#33 [ 0;  |Y #dsmod131#27 = 0;  |Y #dsmod131#31 = 0;
         |ACABA;
     |FINSI;

     #rem00031#0 = #reacceso#0;
     #rem00031#1 = nContaAct;
     |LEE 101#rem00031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00031;
         #rem00031#0 = #reacceso#0;
         #rem00031#1 = nContaAct;
         |GRABA 020#rem00031.b;
     |FINSI;

     #rem00031#2 = eaPerceptor;
     #rem00031#3 = "A";
     #rem00031#4 = 0;

     |SI #dsmod131#33 > 0;
         |SI #dsmod131#2 = 3;   #rem00031#11 = #rem00031#11 + #dsmod131#33;   |FINSI;
         |SI #dsmod131#2 = 6;   #rem00031#12 = #rem00031#12 + #dsmod131#33;   |FINSI;
         |SI #dsmod131#2 = 9;   #rem00031#13 = #rem00031#13 + #dsmod131#33;   |FINSI;
         |SI #dsmod131#2 = 12;  #rem00031#14 = #rem00031#14 + #dsmod131#33;   |FINSI;
     |FINSI;

     |SI nRetContab = 0;
         #rem00031#15 = #rem00031#15 + #dsmod131#37;
     |SINO;
         #rem00031#15 = nRetContab;
     |FINSI;

     #rem00031#17 = "N";
     |SI nAtribucion = 1;  #rem00031#17 = "S";  |FINSI;

     |GRABA 020#rem00031.a;
     |LIBERA #rem00031;

     eaPrograma   = "rem00031";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmod131;
     #dsmod131#1;
     ;
     #agicen14#0, 2016, 00, 131, 00, 00;
     #agicen14#0, 2016, 99, 131, 99, 00;
     ;
     NULL, GrabaPagos131;
|FIN;

|PROCESO camaasilR;
     #trabajo@#0 = #agicen14#0;
     #trabajo@#1 = #camaasil#21;
     #trabajo@#2 = 2016;
     |LEE 000#trabajo@.=;
     |SI FSalida ! 0;  |DDEFECTO #trabajo@;  |FINSI;

     |SI #trabajo@#4 = "8612";  |ACABA;  |FINSI;

     |SI #camaasil#8 = "H"; #camaasil#9 = 0; |FINSI;

     nImporte  = ((#camaasil#9  / nConversor) % nPorAtrib) ! 2;
     nSumaCtas = nSumaCtas + nImporte;
|FPRC;

|DEFBUCLE camaasilR;
     #camaasil#3;
     0;
     #dsmom022#0, "01.01.2016", 000001, 0001, 01;
     #dsmom022#0, "31.12.2016", 999999, 9999, 99;
     ;
     NULL, camaasilR;
|FIN;

|PROCESO dsmom022;
     nSumaCtas = 0;
     |BUCLE camaasilR;
     |SI #dsmom022#3 = "-";
         nRetContab = nRetContab - nSumaCtas;
     |SINO;
         nRetContab = nRetContab + nSumaCtas;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom022;
     #dsmom022#1;
     ;
     "            ";
     "zzzzzzzzzzzz";
     ;
     NULL, dsmom022;
|FIN;

|PROCESO PagosFraccionados;
     |HAZ PintaPantalla;
     |PINTA 1318, "*";

     nRetContab = 0;

     |SI aTipoRet = "C";
         |ABRE #canempre;
         |SELECT #4#canempre;
         #canempre#2  = nEmpAtrib;
         #canempre#26 = 16;               || Ejercicio 2016
         |LEE 040#canempre.=;
         |SI FSalida = 0;
             nConversor = 1;

             |DBASS aBase;  |QBF aBase;
             aPathFich = aBase + "contagen/fich/" + (("00000" + #canempre#2) % -105) + #canempre#3 + "/";
             |PATH_DAT #camaasil#aPathFich#;

             aMas = aBase + "basica/def/agicen30.mas";
             |CARGA_DEF aMas, trabajo@;

             aPathFich = aBase + "basica/fich/";
             |PATH_DAT #trabajo@#aPathFich#;

             |ABRE #trabajo@;
             |BUCLE dsmom022;
             |CIERRA #trabajo@;

             |DESCARGA_DEF #trabajo@;
         |FINSI;
         |CIERRA #canempre;
     |FINSI;

     |ABRE #rem00031;
     |BUCLE dsmom104;

     |ABRE #dsmom004;
     nRetencion1 = 0;
     nRetencion2 = 0;
     |BUCLE dsmod130;

     nRetencion1 = 0;
     nRetencion2 = 0;
     |BUCLE dsmod131;

     |SI aTipoRet = "C";  |Y nRetContab ! 0;
         #rem00031#0 = #reacceso#0;
         #rem00031#1 = nContaAct;
         |LEE 000#rem00031.=;
         |SI FSalida ! 0;
             |DDEFECTO #rem00031;
             #rem00031#0  = #reacceso#0;
             #rem00031#1  = nContaAct;
             #rem00031#2  = eaPerceptor;
             #rem00031#3  = "A";
             #rem00031#4  = 0;
             #rem00031#15 = nRetContab % nPorAtrib;
             #rem00031#17 = "N";
             |SI nAtribucion = 1;
                 #rem00031#17 = "S";
             |FINSI;

             |GRABA 020#rem00031.n;
             |LIBERA #rem00031;
         |FINSI;
     |FINSI;

     |CIERRA #rem00031;
     |CIERRA #dsmom004;

     nRetContab = 0;
|FPRC;

|PROCESO MiraComunero;
     |SI #dsmom001#8 > "01.01.0000";
         |SI #dsmom001#8 > "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |SI #dsmom001#9 > "01.01.0000";
         |SI #dsmom001#9 < "01.01.2016";  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #dsam0000;
     #dsam0000#0 = #dsmom001#0;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     eaCaptura = "";
     |HAZ BuscaCaptura;

     nEmpAtrib = #dsmom001#0;
     nPorAtrib = #dsmom001#7;

     |SI #agicen30#8  = 13;  |O #agicen30#8 = 14;  |O #agicen30#8 = 16;  |O #agicen30#8 = 17;
      |O #agicen30#8  = 19;  |O #agicen30#4 = "8612";
         nPorce        = #dsmom001#7;
         nEmpresa      = #dsmom001#0;
         nActividad    = #dsmom001#1;
         nPlanilla     = 0;
         |SI eaCaptura = "PLANILLAS ";  |HAZ Planilla;  |FINSI;
         |SI nPlanilla = 0;
             |HAZ Contabilidad;
         |FINSI;
     |FINSI;

     |SI #agicen30#8  = 15;
         nPorce        = #dsmom001#7;
         nEmpresa      = #dsmom001#0;
         nActividad    = #dsmom001#1;
         |HAZ Modulos;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#2;
     ;
     #agicen14#0, #agicen14#1;
     #agicen14#0, #agicen14#1;
     ;
     NULL, MiraComunero;
|FIN;

|PROCESO Renta;
     nContaAct = nContaAct + 1;

     nEmpresa    = #agicen14#0;
     nActividad  = #agicen14#1;
     nEmpAtrib   = #agicen14#0;
     nPorAtrib   = 100;
     nAtribucion = 0;

     |SI #agicen30#8  = 3;  |O #agicen30#8 = 4;  |O #agicen30#8 = 6;  |O #agicen30#8 = 7;
      |O #agicen30#4 = "8612";
         nPorce        = 100;
         nPlanilla     = 0;
         |SI #agicen30#16 = "PLANILLAS ";  |HAZ Planilla;  |FINSI;
         |SI nPlanilla = 0;
             |HAZ Contabilidad;
         |FINSI;
     |FINSI;

     |SI #agicen30#8  = 5;
         nPorce  = 100;
         |HAZ Modulos;
     |FINSI;

     |SI #agicen30#8  = 13;  |O #agicen30#8 = 14;  |O #agicen30#8 = 15;
      |O #agicen30#8  = 16;  |O #agicen30#8 = 17;  |O #agicen30#8 = 19;
         nAtribucion = 1;
         |BUCLE dsmom001;
     |FINSI;

     |SI nEmpresaAnt ! #agicen14#0;
         |HAZ PagosFraccionados;
         nEmpresaAnt = #agicen14#0;
     |FINSI;
|FPRC;

|PROCESO Patrimonio;
     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 [ "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |SI nEmpresa ! #agicen14#0;
         nEmpresa = #agicen14#0;
     |SINO;
         |ACABA;
     |FINSI;

     |HAZ PintaPantalla;
     |PINTA 1718, "*";

     |ABRE #dsam0005;
     #dsam0005#0 = #agicen14#0;
     #dsam0005#1 = #agicen14#1;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     |ABRE #dsmom051;
     #dsmom051#0 = #agicen14#0;
     #dsmom051#1 = 2016;
     |LEE 040#dsmom051.=;
     |SI FSalida = 0;
         |SI #dsmom051#6 = 3;  |O #dsmom051#6 = 4;  |O #dsmom051#6 = 5;
          |O #dsmom051#6 = 6;  |O #dsmom051#6 = 7;
             |SI #dsmom051#33 = 1;
                 |SI #dsmom051#30 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "C1";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #agicen30#5;
                     eaPatr18     = #agicen30#4;
                     eaPatr19     = "";
                     eaPatr06     = #dsam0005#3    + " " + #dsam0005#4;  |QBF eaPatr06;
                     eaPatr06     = eaPatr06 + " " + #dsam0005#5;
                     eaPatr08     = #dsam0005#9;
                     eaPatr09     = #dsam0005#10;
                     eaPatr10     = #dsmom051#30;
                     |HAZ GrabaPatrimonio;
                 |FINSI;

                 |SI #dsmom051#31 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "C2";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #agicen30#5;
                     eaPatr18     = #agicen30#4;
                     eaPatr19     = "";
                     eaPatr06     = #dsam0005#3    + " " + #dsam0005#4;  |QBF eaPatr06;
                     eaPatr06     = eaPatr06 + " " + #dsam0005#5;
                     eaPatr08     = #dsam0005#9;
                     eaPatr09     = #dsam0005#10;
                     eaPatr10     = #dsmom051#31;
                     |HAZ GrabaPatrimonio;
                 |FINSI;
             |SINO;
                 |SI #dsmom051#32 > 0;
                     |HAZ LimpiaPatrim;
                     eaLetra      = "D1";
                     eaDeclarante = eaPerceptor;
                     eaDeDonde    = "PA";
                     eaLinDonde   = "";
                     eaPatr15     = #agicen30#5;
                     eaPatr18     = #agicen30#4;
                     eaPatr19     = "";
                     eaPatr06     = #agicen30#5;
                     eaPatr08     = #dsam0005#9;
                     eaPatr09     = #dsam0005#10;
                     eaPatr10     = #dsmom051#32;
                     |HAZ GrabaPatrimonio;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom051;
|FPRC;

|PROCESO MiraActividad;
     |SI #agicen14#5 > "01.01.0000";
         |SI #agicen14#5 > "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 < "01.01.2016";  |ACABA;  |FINSI;
     |FINSI;

     |HAZ MiraHistorico;

     |SI #agicen30#15 = "T";  eaPerceptor = "TITULAR   ";  |FINSI;
     |SI #agicen30#15 = "C";  eaPerceptor = "CONYUGE   ";  |FINSI;
     |SI #agicen30#15 = "1";  eaPerceptor = "1 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "2";  eaPerceptor = "2 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "3";  eaPerceptor = "3 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "4";  eaPerceptor = "4 FAMILIAR";  |FINSI;

     |SI PARAMETRO = "ASALARIADO";
         |HAZ Asalariados;
         |ACABA;
     |FINSI;

     |SI nGananPerd = 1;
         |HAZ GananciasYPerdidas;
         |ACABA;
     |FINSI;

     |SI nSwPatrimonio = 0;
         |HAZ Renta;
     |SINO;
         |HAZ Patrimonio;
     |FINSI;
|FPRC;

|DEFBUCLE agicen14;
     #agicen14#3;
     ;
     enEmpresa, 00001;
     enEmpresa, 99999;
     ;
     NULL, MiraActividad;
|FIN;

|PROCESO agicen30;
     |ABRE #agicen14;
     #agicen14#0 = #agicen30#0;
     #agicen14#1 = #agicen30#1;
     |LEE 000#agicen14.=;
     |SI FSalida ! 0;
         |CIERRA #agicen14;
         |ACABA;
     |FINSI;
     |CIERRA #agicen14;

     |SI #agicen14#5 > "01.01.0000";
         |SI #agicen14#5 > "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 < "01.01.2016";  |ACABA;  |FINSI;
     |FINSI;

     nHay30 = 1;

     |SI #agicen30#16 = "          "; #agicen30#16 = #agicen14#15; |FINSI;

     |SI #agicen30#15 = "T";  eaPerceptor = "TITULAR   ";  |FINSI;
     |SI #agicen30#15 = "C";  eaPerceptor = "CONYUGE   ";  |FINSI;
     |SI #agicen30#15 = "1";  eaPerceptor = "1 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "2";  eaPerceptor = "2 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "3";  eaPerceptor = "3 FAMILIAR";  |FINSI;
     |SI #agicen30#15 = "4";  eaPerceptor = "4 FAMILIAR";  |FINSI;


     |SI PARAMETRO = "ASALARIADO";
         |HAZ Asalariados;
         |ACABA;
     |FINSI;

     |SI nGananPerd = 1;
         |HAZ GananciasYPerdidas;
         |ACABA;
     |FINSI;

     |SI nSwPatrimonio = 0;
         |HAZ Renta;
     |SINO;
         |HAZ Patrimonio;
     |FINSI;

     nHay30 = 1;
|FPRC;

|DEFBUCLE agicen30;
     #agicen30#2;
     ;
     enEmpresa, 01, 2016;
     enEmpresa, 99, 2016;
     ;
     NULL, agicen30;
|FIN;

|PROCESO Borra121;
     |SI #rem00021#117 = "S";  |Y #rem00021#3 = "X";  |Y nSwInMobi = 0;
         |BORRA 020#rem00021.a;
         eaPrograma   = "rem00021";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;

     |SI #rem00021#117 = "N";  |Y nSwInMobi = 1;
         |SI #rem00021#31 ! 0;  |Y #rem00021#3 = "X";
             |BORRA 020#rem00021.a;
             eaPrograma   = "rem00021";
             eaPunto      = "  ";
             |HAZ ProgramaActivo;
         |FINSI;
     |FINSI;

     |LIBERA #rem00021;
|FPRC;

|DEFBUCLE rem00021;
     #rem00021#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, Borra121;
|FIN;

|PROCESO Borra120;
     |SI #rem00020#31 = "S";  |Y #rem00020#3 = "X";
         |BORRA 020#rem00020.a;
         eaPrograma   = "rem00020";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;
     |LIBERA #rem00020;
|FPRC;

|DEFBUCLE rem00020;
     #rem00020#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     be;
     NULL, Borra120;
|FIN;

|PROCESO DNINumero;
     aAlfa    = #dsm19001#6 % 108;
     aAlfa1   = "";
     |PARA nCarac = 1;  |SI nCarac [ 8;  |HACIENDO nCarac = nCarac + 1;
           nPos   = (nCarac * 100) + 1;
           aCarac = aAlfa % nPos;
           |SI aCarac < "0";  |O aCarac > "9";
               aCarac = "0";
           |FINSI;
           aAlfa1 = aAlfa1 + aCarac;
     |SIGUE;
     nDNI  = aAlfa1;
     nDNI  = nDNI + #dsm19001#7;
|FPRC;

|PROCESO PasaTrabaBueno;
     |SI #dsm19001#8 ! "A";  |Y #dsm19001#8 ! "E";
         |ACABA;
     |FINSI;

     |SI nComprueba = 0;
         |SI #dsm19001#4 ! 0;
             |ABRE #dsm190ca;
             #dsm190ca#0 = #dsm19001#0;
             #dsm190ca#1 = #dsm19001#1;
             #dsm190ca#2 = #dsm19001#2;
             #dsm190ca#3 = #dsm19001#3;
             #dsm190ca#4 = #dsm19001#4;
             #dsm190ca#5 = #dsm19001#5;
             |LEE 040#dsm190ca.=;
             |SI FSalida ! 0;  |DDEFECTO #dsm190ca;  |FINSI;
             |CIERRA #dsm190ca;

             |SI #dsm190ca#10 = "S";
                 enDComple = #dsm19001#4;
                 enHComple = #dsm19001#4;
             |SINO;
                 enHComple = #dsm19001#4;
             |FINSI;
         |SINO;
             enDComple = #dsm19001#4;
             enHComple = #dsm19001#4;
         |FINSI;
         nHayTrabaj = 1;

         |HAZ GrabaFiltro;

         |ACABA;
     |FINSI;

     |HAZ LeeFiltro;
     |SI enError = 1;  |ACABA;  |FINSI;

     |HAZ DNINumero;

     |ABRE #rem00020;
     |SELECT #2#rem00020;
     #rem00020#0   = enEmpresa;
     #rem00020#32  = #dsm19001#0;
     #rem00020#33  = nDNI;
     |LEE 040#rem00020.=;
     |SI FSalida = 0;
         nLinea = #rem00020#1;
     |SINO;
         nLinea   = 1;
         |SELECT #1#rem00020;
         #rem00020#0 = enEmpresa;
         #rem00020#1 = 99;
         |LEE 040#rem00020.];
         |SI FSalida = 0;
             |LEE 040#rem00020.a;
         |SINO;
             |LEE 040#rem00020.u;
         |FINSI;
         |SI FSalida = 0;  |Y #rem00020#0 = enEmpresa;
             nLinea = #rem00020#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #rem00020#0 = enEmpresa;
                       #rem00020#1 = nLinea;
                       |LEE 040#rem00020.=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |SELECT #1#rem00020;
     #rem00020#0 = enEmpresa;
     #rem00020#1 = nLinea;
     |LEE 101#rem00020.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00020;
         #rem00020#0 = enEmpresa;
         #rem00020#1 = nLinea;
         #rem00020#3  = "X";
         |GRABA 020#rem00020.b;
     |FINSI;

     |SI #rem00020#3 ! "X";  |ACABA;  |FINSI;

     |HAZ PintaPantalla;
     |PINTA 1518, "*";

     |ABRE #dsam0000;
     #dsam0000#0 = #dsm19001#0;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     #rem00020#2  = eaPerceptor;
     #rem00020#5  = #dsam0000#1;
     #rem00020#6  = #rem00020#6  + #dsm19001#17 + #dsm19001#66;
     #rem00020#7  = #rem00020#7  + #dsm19001#16 + #dsm19001#65;
     #rem00020#9  = #rem00020#9  + #dsm19001#18 + #dsm19001#67;
     #rem00020#10 = #rem00020#10 + #dsm19001#19 + #dsm19001#68;
     #rem00020#11 = #rem00020#11 + #dsm19001#20 + #dsm19001#69;

     |SI #dsm19001#8 = "A";
         #rem00020#19  = #rem00020#19 + #dsm19001#22;
     |FINSI;

     #rem00020#12 = #rem00020#9  + #rem00020#10 - #rem00020#11;
     #rem00020#18 = #rem00020#28 % #rem00020#17;
     |SI #rem00020#27 ! -1;
         nLimite  = (22100 * #rem00020#27) % 30;
         |SI #rem00020#18 > nLimite;  #rem00020#18 = nLimite;  |FINSI;
     |FINSI;

     |SI #rem00020#21 > 500;  #rem00020#21 = 500;  |FINSI;
     |SI #rem00020#22 > 300;  #rem00020#22 = 300;  |FINSI;

     #rem00020#23 = #rem00020#19 + #rem00020#20 + #rem00020#21 + #rem00020#22;
     #rem00020#24 = #rem00020#7  + #rem00020#12 + #rem00020#16 - #rem00020#18 - #rem00020#23;
     #rem00020#37 = #rem00020#24;

     #rem00020#29 = "N";
     |SI #dsm19001#25 ! 0;  #rem00020#29 = "S";  |FINSI;

     #rem00020#31 = "S";
     #rem00020#32 = #dsm19001#0;
     #rem00020#33 = nDNI;

                         #rem00020#38 = "";
     |SI #rem00020#31 = "S";  #rem00020#38 = eaAzul;  |FINSI;
     |SI #rem00020#3  = "X";  #rem00020#38 = eaRojo;  |FINSI;

     |GRABA 020#rem00020.a;
     |LIBERA #rem00020;

     eaPrograma   = "rem00020";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;

     |REPON_DATOS #dsam0000;
|FPRC;

|DEFBUCLE dsm19001;
     #dsm19001#2;
     ;
     aNif, 2016, 00, "A", "  ";
     aNif, 2016, 99, "E", "zz";
     ;
     NULL, PasaTrabaBueno;
|FIN;

|PROCESO PasaTrabajador;
     |ABRE #rem00020;
     |SELECT #2#rem00020;
     #rem00020#0   = #dsmom105#9;
     #rem00020#32  = #dsmom105#1;
     #rem00020#33  = #dsmom105#2;
     |LEE 040#rem00020.=;
     |SI FSalida = 0;
         nLinea = #rem00020#1;
     |SINO;
         nLinea = 1;
         |SELECT #1#rem00020;
         #rem00020#0 = #dsmom105#9;
         #rem00020#1 = 99;
         |LEE 040#rem00020.];
         |SI FSalida = 0;
             |LEE 040#rem00020.a;
         |SINO;
             |LEE 040#rem00020.u;
         |FINSI;
         |SI FSalida = 0;  |Y #rem00020#0 = #dsmom105#9;
             nLinea = #rem00020#1 + 1;
             |SI nLinea ] 99;
                 |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                       #rem00020#0 = #dsmom105#9;
                       #rem00020#1 = nLinea;
                       |LEE 040#rem00020.=;
                       |SI FSalida ! 0;  |SAL;  |FINSI;
                 |SIGUE;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |SELECT #1#rem00020;
     #rem00020#0 = #dsmom105#9;
     #rem00020#1 = nLinea;
     |LEE 101#rem00020.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00020;
         #rem00020#0 = #dsmom105#9;
         #rem00020#1 = nLinea;
         #rem00020#3  = "X";
         |GRABA 020#rem00020.b;
     |FINSI;

     |SI #rem00020#3 ! "X";  |ACABA;  |FINSI;

     |HAZ PintaPantalla;
     |PINTA 1518, "*";

     |SI #dsmom105#10 = "T";    #rem00020#2 = "TITULAR";       |FINSI;
     |SI #dsmom105#10 = "C";    #rem00020#2 = "CONYUGE";       |FINSI;
     |SI #dsmom105#10 = "1";    #rem00020#2 = "1 FAMILIAR";    |FINSI;
     |SI #dsmom105#10 = "2";    #rem00020#2 = "2 FAMILIAR";    |FINSI;
     |SI #dsmom105#10 = "3";    #rem00020#2 = "3 FAMILIAR";    |FINSI;
     |SI #dsmom105#10 = "4";    #rem00020#2 = "4 FAMILIAR";    |FINSI;

     #rem00020#5  = #dsmom105#13;
     #rem00020#6  = #dsmom105#4;
     #rem00020#7  = #dsmom105#3;
     #rem00020#9  = #dsmom105#6;
     #rem00020#10 = #dsmom105#7;
     #rem00020#11 = #dsmom105#11;
     #rem00020#19 = #dsmom105#5;

     #rem00020#12 = #rem00020#9  + #rem00020#10 - #rem00020#11;
     #rem00020#18 = #rem00020#28 % #rem00020#17;
     |SI #rem00020#27 ! -1;
         nLimite  = (22100 * #rem00020#27) % 30;
         |SI #rem00020#18 > nLimite;  #rem00020#18 = nLimite;  |FINSI;
     |FINSI;

     |SI #rem00020#21 > 500;  #rem00020#21 = 500;  |FINSI;
     |SI #rem00020#22 > 300;  #rem00020#22 = 300;  |FINSI;

     #rem00020#23 = #rem00020#19 + #rem00020#20 + #rem00020#21 + #rem00020#22;
     #rem00020#24 = #rem00020#7  + #rem00020#12 + #rem00020#16 - #rem00020#18 - #rem00020#23;

     #rem00020#31 = "S";
     #rem00020#32 = #dsmom105#1;
     #rem00020#33 = #dsmom105#2;

     |GRABA 020#rem00020.a;
     |LIBERA #rem00020;

     eaPrograma   = "rem00020";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom105;
     #dsmom105#2;
     14;
     enEmpresa, "            ", 2016;
     enEmpresa, "zzzzzzzzzzzz", 2016;
     ;
     NULL, PasaTrabajador;
|FIN;

|PROCESO Borra132;
     |SI #rem00032#3 = "X";
         |BORRA 020#rem00032.a;
         eaPrograma   = "rem00032";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |SINO;
         nSwPasa = 0;
     |FINSI;
     |LIBERA #rem00032;
|FPRC;

|DEFBUCLE rem00032;
     #rem00032#1;
     26;
     enEmpresa, 01, "S";
     enEmpresa, 99, "S";
     be;
     NULL, Borra132;
|FIN;

|PROCESO Transparencia;
     |HAZ PintaPantalla;
     |PINTA 1618, "*";

     nLinea = 1;
     |ABRE #rem00032;
     #rem00032#0 = enEmpresa;
     #rem00032#1 = 99;
     |LEE 040#rem00032.];
     |SI FSalida = 0;
         |LEE 040#rem00032.a;
     |SINO;
         |LEE 040#rem00032.u;
     |FINSI;
     |SI FSalida = 0;  |Y #rem00032#0 = enEmpresa;
         nLinea = #rem00032#1 + 1;
         |SI nLinea ] 99;
             |PARA nLinea = 99; |SI nLinea ] 0; |HACIENDO nLinea = nLinea - 1;
                   #rem00032#0 = enEmpresa;
                   #rem00032#1 = nLinea;
                   |LEE 040#rem00032.=;
                   |SI FSalida ! 0;  |SAL;  |FINSI;
             |SIGUE;
         |FINSI;
     |FINSI;

     |ABRE #dsam0000;
     #dsam0000#0 = #dsmom055#0;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     #rem00032#0 = enEmpresa;
     #rem00032#1 = nLinea;
     |LEE 101#rem00032.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00032;
         #rem00032#0  = enEmpresa;
         #rem00032#1  = nLinea;
         #rem00032#3  = "X";
         |GRABA 020#rem00032.b;
     |FINSI;

     #rem00032#2  = eaPerceptor;
     #rem00032#11 = #dsam0000#3;
     #rem00032#13 = "C";

     #rem00032#14 = #dsmom055#7;
     #rem00032#18 = #dsmom055#11;
     #rem00032#19 = #dsmom055#12;
     #rem00032#15 = #dsmom055#8;
     #rem00032#16 = #dsmom055#9;
     #rem00032#17 = #dsmom055#10;
     #rem00032#26 = "S";

                         #rem00032#27 = "";
     |SI #rem00032#3  = "X";  #rem00032#27 = eaRojo;        |FINSI;

     |GRABA 020#rem00032.a;
     |LIBERA #rem00032;

     eaPrograma   = "rem00032";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE dsmom055;
     #dsmom055#3;
     ;
     aNif, 00001, 2016;
     aNif, 99999, 2016;
     ;
     NULL, Transparencia;
|FIN;

|PROCESO Borra199;
     |BORRA 020#rem00099.a;
     |LIBERA #rem00099;

     eaPrograma   = "rem00099";
     eaPunto      = #rem00099#1;
     eaLetra      = #rem00099#1;
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00099;
     #rem00099#1;
     4;
     enEmpresa, "  ", 001, "PA";
     enEmpresa, "zz", 999, "PA";
     be;
     NULL, Borra199;
|FIN;

|PROCESO Socios;
     |ABRE #dsmom051;
     #dsmom051#0 = #dsmom052#0;
     #dsmom051#1 = #dsmom052#1;
     |LEE 040#dsmom051.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom051;

     |SI #dsmom052#9 [ 0;  |ACABA;  |FINSI;

     |HAZ PintaPantalla;
     |PINTA 1718, "*";

     |SI #dsmom052#11 = 1;
         |HAZ LimpiaPatrim;
         eaLetra      = "G4";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #dsmom051#3;
         eaPatr10     = #dsmom052#9;
         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI #dsmom052#11 = 2;
         |HAZ LimpiaPatrim;
         eaLetra      = "H1";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #dsmom051#3;
         eaPatr10     = #dsmom052#9;
         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI #dsmom052#11 = 3;
         |HAZ LimpiaPatrim;
         eaLetra      = "H2";
         eaDeclarante = eaPerceptor;
         eaDeDonde    = "PA";
         eaLinDonde   = "";
         eaPatr06     = #dsmom051#3;
         eaPatr10     = #dsmom052#9;
         |HAZ GrabaPatrimonio;
     |FINSI;
|FPRC;

|DEFBUCLE dsmom052;
     #dsmom052#3;
     ;
     aNif, 00001, 2016;
     aNif, 99999, 2016;
     ;
     NULL, Socios;
|FIN;

|PROCESO Comuneros;
     |ABRE #dsmom051;
     #dsmom051#0 = #dsmom053#0;
     #dsmom051#1 = #dsmom053#1;
     |LEE 040#dsmom051.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |CIERRA #dsmom051;

     |HAZ PintaPantalla;
     |PINTA 1718, "*";

     |ABRE #dsam0005;
     #dsam0005#0 = #dsmom051#0;
     #dsam0005#1 = 1;
     |LEE 040#dsam0005.];
     |SI FSalida ! 0;    |DDEFECTO #dsam0005;  |FINSI;
     |SI #dsam0005#0 ! #dsmom051#0;  |DDEFECTO #dsam0005;  |FINSI;
     |CIERRA #dsam0005;

     |ABRE #agicen14;
     #agicen14#0 = #dsmom051#0;
     #agicen14#1 = #dsmom053#2;
     |LEE 040#agicen14.=;
     |SI FSalida ! 0;    |DDEFECTO #agicen14;  |FINSI;
     |SI #agicen14#0 ! #dsmom051#0;  |DDEFECTO #agicen14;  |FINSI;
     |CIERRA #agicen14;

     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 [ "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |DDEFECTO #agicen30;
     |SI #agicen14#0 = #dsmom051#0;
         |HAZ MiraHistorico;
     |FINSI;

     |SI #dsmom051#33 = 1;
         |SI #dsmom053#7 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "C1";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #agicen30#5;
             eaPatr18     = #agicen30#4;
             eaPatr19     = "";
             eaPatr06     = #dsam0005#3    + " " + #dsam0005#4;  |QBF eaPatr06;
             eaPatr06     = eaPatr06 + " " + #dsam0005#5;
             eaPatr08     = #dsam0005#9;
             eaPatr09     = #dsam0005#10;
             eaPatr10     = #dsmom053#7;
             |HAZ GrabaPatrimonio;
         |FINSI;

         |SI #dsmom053#8 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "C2";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #agicen30#5;
             eaPatr18     = #agicen30#4;
             eaPatr19     = "";
             eaPatr06     = #dsam0005#3    + " " + #dsam0005#4;  |QBF eaPatr06;
             eaPatr06     = eaPatr06 + " " + #dsam0005#5;
             eaPatr08     = #dsam0005#9;
             eaPatr09     = #dsam0005#10;
             eaPatr10     = #dsmom053#8;
             |HAZ GrabaPatrimonio;
         |FINSI;
     |SINO;
         |SI #dsmom053#7 > 0;
             |HAZ LimpiaPatrim;
             eaLetra      = "D1";
             eaDeclarante = eaPerceptor;
             eaDeDonde    = "PA";
             eaLinDonde   = "";
             eaPatr15     = #agicen30#5;
             eaPatr18     = #agicen30#4;
             eaPatr19     = "";
             eaPatr06     = #agicen30#5;
             eaPatr06     = eaPatr06 + " " + #dsam0005#5;
             eaPatr08     = #dsam0005#9;
             eaPatr09     = #dsam0005#10;
             eaPatr10     = #dsmom053#7;
             |HAZ GrabaPatrimonio;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE dsmom053;
     #dsmom053#3;
     ;
     aNif, 00001, 2016;
     aNif, 99999, 2016;
     ;
     NULL, Comuneros;
|FIN;

|PROCESO agicen14Hist;
     |SI #agicen14#5 > "01.01.0000";
         |SI #agicen14#5 > "31.12.2016";  |ACABA;  |FINSI;
     |FINSI;

     |SI #agicen14#6 > "01.01.0000";
         |SI #agicen14#6 < "01.01.2016";  |ACABA;  |FINSI;
     |FINSI;

     |HAZ MiraHistorico;
|FPRC;

|DEFBUCLE agicen14Hist;
     #agicen14#3;
     ;
     enEmpresa, 00001;
     enEmpresa, 99999;
     ;
     NULL, agicen14Hist;
|FIN;

|PROGRAMA;
     |HAZ CargaColores;

     |BUCLE agicen14Hist;

     |ABRE #dsmom014;
     #dsmom014#10 = 2008;
     #dsmom014#0  = "6500";
     |LEE 101#dsmom014.=;
     |SI FSalida = 0;
         |SI #dsmom014#9 ! 13;
             #dsmom014#9 = 13;
             |GRABA 020#dsmom014.a;
         |FINSI;
         |LIBERA #dsmom014;
     |FINSI;
     |CIERRA #dsmom014;

     |DDEF aMas;
     aMas = aMas + "reparame.mas";
     |CARGA_DEF aMas, trabajo@;

     |ABRE #trabajo@;
     |LEE 000#trabajo@.p;
     |SI FSalida ! 0;  |DDEFECTO #trabajo@;  |FINSI;
     |CIERRA #trabajo@;

     aTipoRet = #trabajo@#21;

     |DESCARGA_DEF #trabajo@;

     |ABRE #dsam0000;
     #dsam0000#0 = enEmpresa;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     |ABRE #reacceso;
     #reacceso#0 = enEmpresa;
     |LEE 040#reacceso.=;
     |SI FSalida ! 0;  |DDEFECTO #reacceso;  |FINSI;
     |CIERRA #reacceso;

     |ABRE #dsam0003;
     #dsam0003#0 = enEmpresa;
     |LEE 040#dsam0003.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0003;  |FINSI;
     |CIERRA #dsam0003;

     nGananPerd = 0;

     |SI PARAMETRO = "ASALARIADO";
         enImporteT = 0;
         enImporteC = 0;
         enImporte1 = 0;
         enImporte2 = 0;
         enImporte3 = 0;
         enImporte4 = 0;

         nHay30     = 0;  |BUCLE agicen30;
         |SI nHay30 = 0;
             |BUCLE agicen14;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #reacceso#7 = " ";
         nSwInMobi   = 0;
         |BUCLE rem00021;

         nEmpresaAnt   = 0;
         nContaAct     = 0;
         nSwPatrimonio = 0;

         nHay30     = 0;  |BUCLE agicen30;
         |SI nHay30 = 0;
             |BUCLE agicen14;
         |FINSI;

         |SI nSwInMobi = 1;
             |BUCLE rem00021;
         |FINSI;
     |FINSI;

     |BUCLE rem00020;        || Pasando Trabajo

     nHayTrabaj = 0;

     |HAZ AbreTempoTrab;
     aNif        = #dsam0003#1;   |QBT aNif;
     eaPerceptor = "TITULAR";
     enDComple   = 0;
     enHComple   = 99;
     |SI aNif ! "";
         nComprueba  = 0;  |BUCLE dsm19001;
         nComprueba  = 1;  |BUCLE dsm19001;
     |FINSI;
     |HAZ CierraTempoTrab;

     |HAZ AbreTempoTrab;
     aNif        = #dsam0003#35;   |QBT aNif;
     eaPerceptor = "CONYUGE";
     enDComple   = 0;
     enHComple   = 99;
     |SI aNif ! "";
         nComprueba  = 0;  |BUCLE dsm19001;
         nComprueba  = 1;  |BUCLE dsm19001;
     |FINSI;
     |HAZ CierraTempoTrab;

     |SI nHayTrabaj = 0;  |BUCLE dsmom105;  |FINSI;

     |HAZ PasaDelModelo193;

     |ABRE #dsam0000;
     #dsam0000#0 = enEmpresa;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     nSwPasa = 1;
     |BUCLE rem00032;        || Pasando Transparencia Fiscal
     |SI nSwPasa = 1;
         eaPerceptor = "TITULAR";
         aNif       = #dsam0003#1;   |QBT aNif;
         |SI aNif ! "";
             aNif = #dsam0003#1;
             |BUCLE dsmom055;
         |FINSI;

         eaPerceptor = "CONYUGE";
         aNif       = #dsam0003#35;  |QBT aNif;
         |SI aNif ! "";
             aNif = #dsam0003#35;
             |BUCLE dsmom055;
         |FINSI;
     |FINSI;

     nGananPerd = 1;
     enSwPasa   = 1;
     |HAZ Borra41;
     |SI enSwPasa = 1;
         nHay30     = 0;
         enTipoGanan = 1;  |BUCLE agicen30;
         enTipoGanan = 2;  |BUCLE agicen30;
         |SI nHay30 = 0;
             enTipoGanan = 1;  |BUCLE agicen14;
             enTipoGanan = 2;  |BUCLE agicen14;
         |FINSI;
     |FINSI;

     nGananPerd = 0;

     |ABRE #rem00099;
     |SELECT #2#rem00099;
     #rem00099#4 = "PA";
     #rem00099#5 = "";
     #rem00099#0 = enEmpresa;
     |LEE 000#rem00099.];
     |SI FSalida = 0;  |Y  #rem00099#4 = "PA";  |Y  #rem00099#0 = enEmpresa;
         |CIERRA  #rem00099;
         |ACABA;
     |FINSI;
     |CIERRA  #rem00099;

     |BUCLE rem00099;        || Pasando Patrimonio

     nSwPatrimonio = 1;
     nEmpresa      = 0;

     nHay30        = 0;  |BUCLE agicen30;
     |SI nHay30 = 0;
         |BUCLE agicen14;
     |FINSI;

     eaPerceptor = "TITULAR";
     aNif        = #dsam0003#1;   |QBT aNif;
     |SI aNif ! "";
         aNif = #dsam0003#1;
         |BUCLE dsmom052;
     |FINSI;

     eaPerceptor = "CONYUGE";
     aNif        = #dsam0003#35;  |QBT aNif;
     |SI aNif ! "";
         aNif = #dsam0003#35;
         |BUCLE dsmom052;
     |FINSI;

     eaPerceptor = "TITULAR";
     aNif        = #dsam0003#1;   |QBT aNif;
     |SI aNif ! "";
         aNif = #dsam0003#1;
         |BUCLE dsmom053;
     |FINSI;

     eaPerceptor = "CONYUGE";
     aNif       = #dsam0003#35;  |QBT aNif;
     |SI aNif ! "";
         aNif = #dsam0003#35;
         |BUCLE dsmom053;
     |FINSI;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     |SI PARAMETRO = "ASALARIADO";  |ACABA;  |FINSI;

     FSalida = 3499;
|FPRC;
