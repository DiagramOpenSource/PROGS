|FICHEROS;
     rem00100@;
     rem01010@;
     rem01011@;
     rem01012@;
     rem01014@;
     rem01018@;
     rem01033@;

     &refere1@;
     &refere2@;
     &refere3@;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varcal;

|PROCESO EsIndividual;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, rem00100@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #rem00100@;
     #rem00100@#0 = #refere1@#0;
     |LEE 101#rem00100@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100@;  |FINSI;
     |CIERRA #rem00100@;

     |SI #rem00100@#40 = "    ";  #rem00100@#40 = "0000";  |FINSI;

     |SI enSwConjunta = 0;  |Y #rem00100@#40 = "0000";  |Y enConta = 7;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI enSwConjuntaE = 0;  |Y enConta = 8;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI eaMuerto ! "";  |Y enConta = 7;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |DESCARGA_DEF #rem00100@;
|FPRC;

|PROCESO Empresarial1;
     |SI #rem01014@#5 = "4";  |O #rem01014@#5 = "5";
         nProfesional =  nProfesional + #rem01014@#35;
     |FINSI;
|FPRC;

|DEFBUCLE rem01014;
     #rem01014@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, Empresarial1;
|FIN;

|PROCESO rem01011_6;
     nImput = nImput + #rem01011@#12;
|FPRC;

|DEFBUCLE rem01011_6;
     #rem01011@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01011_6;
|FIN;

|PROCESO SeleccionRenta;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, rem01010@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01010@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01014.mas";
     |CARGA_DEF aDef, rem01014@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01014@#"zdat1014"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01033@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, rem01011@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01033@;
         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01011@#"zdat1011"#;  |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01011@;
         |DESCARGA_DEF #rem01033@;
         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     #refere1@#5 = "";
     #refere1@#6 = "N";
     #refere1@#4 = "N";

     |ABRE #rem01010@;
     #rem01010@#0 = #refere1@#0;
     #rem01010@#1 = #refere1@#1;
     #rem01010@#2 = #refere1@#2;
     |LEE 040#rem01010@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01010@;  |FINSI;
     |CIERRA #rem01010@;

     |ABRE #rem01018@;
     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 040#rem01018@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01018@;  |FINSI;
     |CIERRA #rem01018@;

     |ABRE #rem01033@;
     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = #refere1@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01033@;  |FINSI;
     |CIERRA #rem01033@;

     |ABRE #rem01012@;
     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 040#rem01012@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01012@;  |FINSI;
     |CIERRA #rem01012@;

     enBloque = 45; eaCasilla = "538"; |HAZ SacaImporte;

     |SI #rem01010@#29 > 12000;  |Y enImporte = 0;
         #refere1@#4 = "S";
     |FINSI;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI #rem01010@#26 > 1;
             enPagadoresC = enPagadoresC + #rem01010@#26;
         |FINSI;
     |FINSI;

     enPagadores = #rem01010@#26;
     nTotalPag   = #rem01010@#28 - #rem01010@#30;

     nValor = 0;
     enBloque = 36; eaCasilla = "433"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     |SI enImporte ! 0;
         |SI enConta ! 7;  |Y enConta ! 8;
             enPagadores  = enPagadores + 1;
         |SINO;
             enPagadoresC = enPagadoresC + 1;
         |FINSI;
         nTotalPag  = nTotalPag + enImporte;
     |FINSI;

     enBloque = 1; eaCasilla = "001"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "005"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "006"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "007"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI nValor ] 22000;  #refere1@#4 = "S";  |FINSI;

         |SI enPagadores > 1;
             |SI nTotalPag > 1500;
                 |SI nValor > 12000;
                     #refere1@#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nValor ] 22000;  #refere1@#4 = "S";  |FINSI;

         |SI enPagadoresC > 1;
             |SI nTotalPag > 1500;
                 |SI nValor > 12000;
                     #refere1@#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;


     nAlquiler = #rem01018@#17;
     nSuma1    = #rem01018@#22;

     nProfesional   = 0;
     |BUCLE rem01014;

     |SI nSuma1 ] 2;
         #refere1@#4 = "S";
     |SINO;
         enBloque = 4; eaCasilla = "076"; |HAZ SacaImporte;
         |SI enImporte > 1000;  #refere1@#4 = "S";  |FINSI;
     |FINSI;

     nContaAct = 0;

     |SI #rem01033@#32 ! 0;  |O #rem01033@#36 ! 0;
         nPerd = #rem01033@#32 + #rem01033@#36;
         |SI nPerd > 500;
             nContaAct = nContaAct + 2;
         |FINSI;
     |FINSI;

     nSuma1 = #rem01033@#12;

     enBloque = 29; eaCasilla = "380"; |HAZ SacaImporte; nValor29 = enImporte;
     enBloque = 30; eaCasilla = "384"; |HAZ SacaImporte; nValor36 = enImporte;
     nSuma = nValor29 + nValor36 + nProfesional;
     |SI nSuma = nSuma1;
         |SI nSuma ! 0;
             |SI nSuma > 1600;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nSuma ! 0;
             |SI nSuma > 1000;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor    = 0;
     enBloque  = 8;
     eaCasilla = "222"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "223"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "224"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "225"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "226"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "227"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "228"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "229"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "230"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI nValor ! 0;  nContaAct = 2;  |FINSI;

     nIngr = 0;
     nHay  = 0;

     enBloque = 4;  eaCasilla = "076"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#7;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#11;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#13;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enBloque = 26; eaCasilla = "380"; |HAZ SacaImporte;
     nIngr   = nIngr + enImporte;
     nValor2 = enImporte;

     enBloque = 27; eaCasilla = "384"; |HAZ SacaImporte;
     nIngr    = nIngr + enImporte;
     nValor2  = nValor2 + enImporte;
     nValor2  = nValor2 - nSuma1;
     |SI nValor2 ! 0;  nHay = nHay + 1;  |FINSI;

     enBloque = 1;  eaCasilla = "019"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 2;  eaCasilla = "033"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 3;  eaCasilla = "046"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 4;  eaCasilla = "075"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 9;  eaCasilla = "240"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 10; eaCasilla = "244"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 11; eaCasilla = "248"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     enBloque = 12; eaCasilla = "252"; |HAZ SacaImporte; nIngr = nIngr + enImporte;

     |SI nHay ! 0;
         |SI nIngr ] 1000;
             nContaAct = 2;
         |FINSI;
     |FINSI;

     nValor2  = 0;
     enBloque = 26; eaCasilla = "381"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;
     enBloque = 27; eaCasilla = "385"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;

     |SI nValor2 ] 500;
         nContaAct = 2;
     |FINSI;

     #refere1@#5 = "";
     |SI nContaAct > 1;  #refere1@#4 = "S";  |FINSI;

     enBloque = 4; eaCasilla = "075"; |HAZ SacaImporte;
     |SI enImporte > 1000;  #refere1@#4 = "S";  |FINSI;

     enBloque = 9; eaCasilla = "240"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     enBloque = 10; eaCasilla = "244"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     enBloque = 11; eaCasilla = "248"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     enBloque = 12; eaCasilla = "252"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     nImput = 0;
     |BUCLE rem01011_6;



     nValor = #rem01012@#13 - #rem01012@#5;

     enBloque = 13;  eaCasilla = "253"; |HAZ SacaImporte;
     nValor = nValor + enImporte;

     enBloque = 16;  eaCasilla = "286"; |HAZ SacaImporte;
     nValor = nValor + enImporte;
     |SI nValor > 1600;  #refere1@#4 = "S";  |FINSI;

     nValor = #rem01012@#5 + nImput;
     |SI nValor > 1000;  #refere1@#4 = "S";  |FINSI;

     |SI nAlquiler > 0;
         enBloque = 4;  eaCasilla = "075"; |HAZ SacaImporte;
         nValor   = #rem01018@#15  + #rem01018@#16 + #rem01018@#19 + #rem01018@#7 + #rem01018@#8;
         nValor   = nValor + #rem01018@#11 + #rem01018@#13 + #rem01033@#102;
         nValor   = nValor + #rem01033@#31 - #rem01033@#32 + #rem01033@#35 - #rem01033@#36;
         nValor   = nValor + enImporte;

         |SI nValor > 1000;
             #refere1@#4 = "S";
         |FINSI;
     |FINSI;

     #refere1@#13 = #refere1@#5;

     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #rem01011@;
     |DESCARGA_DEF #rem01033@;
     |DESCARGA_DEF #rem01014@;
     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01010@;

     |SI #refere1@#4 = "S";  |ACABA;  |FINSI;

     |SI nPerd ! 0;  |Y nIngr > 1000;
         #refere1@#4 = "R";
     |FINSI;

     enBloque  = 46; eaCasilla = "600"; |HAZ SacaImporte;
     |SI enImporte ] 0;  |ACABA;  |FINSI;

     enBloque  = 38;
     eaCasilla = "439";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "440";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "441";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "442";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     enBloque  = 42;  eaCasilla = "501";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;
|FPRC;
