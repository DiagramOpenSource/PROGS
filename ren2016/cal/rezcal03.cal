|FICHEROS;
      rem01033@;
      rem01026@;

     &refere1@;
     &refere2@;
     &refere3@;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varcal;

|PROCESO CalcuH1;
     enBloque = 02; eaCasilla = "035"; |HAZ SacaImporte; nValor1 = enImporte;

     #rem01033@#148  = 0;
     #rem01033@#149  = 0;

     nSuma  = (N\ nValor1 + #rem01026@#4 + #rem01026@#5);
     |SI nSuma ] 0;
         #rem01033@#148  = nSuma;
     |SINO;
         #rem01033@#149  = -nSuma;
     |FINSI;
|FPRC;

|PROCESO CalcuH4;
     enBloque = 27; eaCasilla = "384"; |HAZ SacaImporte; #rem01033@#46 = enImporte;

     |SI #rem01033@#46 [ 0;
         #rem01033@#160 = (N\ #rem01033@#160 + #rem01033@#156);
         #rem01033@#145 = (N\ #rem01033@#145 + #rem01033@#142);

         #rem01033@#150 = 0;
         #rem01033@#47  = 0;
         #rem01033@#156 = 0;
         #rem01033@#142 = 0;
         #rem01033@#157 = 0;
         #rem01033@#143 = 0;

         |ACABA;
     |FINSI;

     #rem01033@#150 = (N\ #rem01033@#149);
     nLimite = #rem01033@#46 % 15;
     |SI #rem01033@#150 > nLimite;
          #rem01033@#150 = (N\ nLimite);
     |FINSI;

     nResta = #rem01033@#46 - #rem01033@#150 - #rem01033@#47;
     |SI nResta < 0;
         #rem01033@#47  = (N\ #rem01033@#46 - #rem01033@#150);
         #rem01033@#160 = (N\ #rem01033@#160 + #rem01033@#156);
         #rem01033@#145 = (N\ #rem01033@#145 + #rem01033@#142);

         #rem01033@#156 = 0;
         #rem01033@#142 = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#46 - #rem01033@#150 - #rem01033@#47 - #rem01033@#156;
     |SI nResta < 0;
         #rem01033@#160 = (N\ #rem01033@#160 + -nResta);
         #rem01033@#156 = (N\ #rem01033@#46 - #rem01033@#150 - #rem01033@#47);
         #rem01033@#145 = (N\ #rem01033@#145 + #rem01033@#142);

         #rem01033@#142 = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#46 - #rem01033@#150 - #rem01033@#47 - #rem01033@#156;
     nResta = nResta - #rem01033@#142;
     |SI nResta < 0;
         #rem01033@#145 = (N\ #rem01033@#145 + -nResta);
         #rem01033@#142 = (N\ #rem01033@#46 - #rem01033@#150 - #rem01033@#47 - #rem01033@#156);
         |ACABA;
     |FINSI;

     nSaldoH4 = nResta;
|FPRC;

|PROCESO Compensa5_1;
     |SI nSaldoH4 [ 0;  |ACABA;  |FINSI;

     |SI nImporte1 ! 0;
         |SI nSaldoH4 > nImporte1;
             #rem01033@#157 = (N\ #rem01033@#157 + nImporte1);
             nSaldoH4       = nSaldoH4 - nImporte1;
             nImporte1      = 0;
         |SINO;
             #rem01033@#157 = (N\ #rem01033@#157 + nSaldoH4);
             nImporte1      = nImporte1 - nSaldoH4;
             nSaldoH4       = 0;
         |FINSI;
     |FINSI;

     |SI nSaldoH4 [ 0;  |ACABA;  |FINSI;

     |SI nImporte2 ! 0;
         |SI nSaldoH4 > nImporte2;
             #rem01033@#143 = (N\ #rem01033@#143 + nImporte2);
             nSaldoH4       = nSaldoH4 - nImporte2;
             nImporte2      = 0;
         |SINO;
             #rem01033@#143 = (N\ #rem01033@#143 + nSaldoH4);
             nImporte2      = nImporte2 - nSaldoH4;
             nSaldoH4       = 0;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalcuH5;
     #rem01033@#49 = #rem01033@#148;

     |SI #rem01033@#49 < 0;
         nImporte1 = #rem01033@#159;
         nImporte2 = #rem01033@#144;
         |HAZ Compensa5_1;

         #rem01033@#151 = 0;
         #rem01033@#111 = 0;
         #rem01033@#159 = 0;
         #rem01033@#144 = 0;
         #rem01033@#160 = 0;
         #rem01033@#145 = 0;

         |ACABA;
     |FINSI;

     #rem01033@#151 = (N\ #rem01033@#38);
     nLimite = #rem01033@#49 % 15;
     |SI #rem01033@#151 > nLimite;
          #rem01033@#151 = (N\ nLimite);
     |FINSI;

     nResta = #rem01033@#49 - #rem01033@#151 - #rem01033@#111;
     |SI nResta < 0;
         nImporte1 = #rem01033@#159;
         nImporte2 = #rem01033@#144;
         |HAZ Compensa5_1;

         #rem01033@#111 = (N\ #rem01033@#49 - #rem01033@#151);
         #rem01033@#159 = 0;
         #rem01033@#144 = 0;
         #rem01033@#160 = 0;
         #rem01033@#145 = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159;
     |SI nResta < 0;
         nImporte1 = -nResta;
         nImporte2 = #rem01033@#144;
         |HAZ Compensa5_1;

         #rem01033@#159 = (N\ #rem01033@#49 - #rem01033@#151 - #rem01033@#111);
         #rem01033@#144 = 0;
         #rem01033@#160 = 0;
         #rem01033@#145 = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159;
     nResta = nResta - #rem01033@#144;
     |SI nResta < 0;
         nImporte1 = 0;
         nImporte2 = -nResta;
         |HAZ Compensa5_1;

         #rem01033@#144 = (N\ #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159);
         #rem01033@#160 = 0;
         #rem01033@#145 = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159;
     nResta = nResta - #rem01033@#144 - #rem01033@#160;
     |SI nResta < 0;
         #rem01033@#160 = (N\ #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159);
         #rem01033@#160 = (N\ #rem01033@#160 - #rem01033@#144);
         #rem01033@#145 = 0;
     |FINSI;

     nResta = #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159;
     nResta = nResta - #rem01033@#144 - #rem01033@#160 - #rem01033@#145;
     |SI nResta < 0;
         #rem01033@#145 = (N\ #rem01033@#49 - #rem01033@#151 - #rem01033@#111 - #rem01033@#159);
         #rem01033@#145 = (N\ #rem01033@#145 - #rem01033@#144 - #rem01033@#160);
     |FINSI;
|FPRC;

|PROCESO CalcuH2;
     enBloque = 26; eaCasilla = "380"; |HAZ SacaImporte; #rem01033@#39 = enImporte;

     |SI #rem01033@#39 [ 0;
         #rem01033@#40  = 0;

         |ACABA;
     |FINSI;

     nResta = #rem01033@#39 - #rem01033@#40;
     |SI nResta < 0;
         #rem01033@#40 = (N\ #rem01033@#39);
     |FINSI;
|FPRC;

|PROCESO CalcuH3;
     enBloque = 26; eaCasilla = "381"; |HAZ SacaImporte; #rem01033@#155 = enImporte;

     nResta  = #rem01033@#40 - #rem01033@#42 - #rem01033@#155;
     |SI nResta = 0;
         #rem01033@#42  = 0;
         #rem01033@#155 = 0;
     |FINSI;

     |SI nResta < 0;
         nResta = -nResta;
         |SI #rem01033@#155 > nResta;
             #rem01033@#155  = nResta;
             #rem01033@#42   = 0;
             nResta = 0;
         |SINO;
             #rem01033@#42 = nResta - #rem01033@#155;
         |FINSI;
     |FINSI;

     #rem01033@#41 = 0;
     enBloque = 1;  eaCasilla = "021"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 3;  eaCasilla = "048"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 4;  eaCasilla = "075"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 4;  eaCasilla = "076"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 5;  eaCasilla = "130"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 6;  eaCasilla = "155"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 7;  eaCasilla = "185"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 8;  eaCasilla = "222"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 8;  eaCasilla = "225"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 8;  eaCasilla = "226"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 9;  eaCasilla = "240"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 10; eaCasilla = "244"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 11; eaCasilla = "248"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);
     enBloque = 12; eaCasilla = "252"; |HAZ SacaImporte; #rem01033@#41 = (N\ #rem01033@#41 + enImporte);

     |SI #rem01033@#41 [ 0;
         #rem01033@#155 = 0;
         #rem01033@#42  = 0;

         |ACABA;
     |FINSI;

     nValor1 = #rem01033@#41 % 25;
     nValor2 = #rem01033@#41 % 25;

     |SI #rem01033@#155 > nValor2;
         #rem01033@#155 = nValor2;
     |FINSI;

     nValor2 = nValor2 - #rem01033@#155;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     |SI #rem01033@#42 > nValor1;
         #rem01033@#42 = nValor1;
     |FINSI;

     |SI #rem01033@#42 > nValor2;
         #rem01033@#42 = nValor2;
     |FINSI;
|FPRC;

|PROCESO CalculaH;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01033@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, rem01026@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01026@#"zdat1026"#;  |FINSI;

     |ABRE #rem01026@;
     #rem01026@#0 = #refere1@#0;
     #rem01026@#1 = #refere1@#1;
     #rem01026@#2 = #refere1@#2;
     |LEE 000#rem01026@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01026@;  |FINSI;
     |CIERRA #rem01026@;

     |ABRE #rem01033@;
     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = #refere1@#2;
     |LEE 101#rem01033@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01033@;
         #rem01033@#0 = #refere1@#0;
         #rem01033@#1 = #refere1@#1;
         #rem01033@#2 = #refere1@#2;
         |GRABA 020#rem01033@.b;
     |FINSI;

     nSaldoH4 = 0;
     |HAZ CalcuH1;
     |HAZ CalcuH4;
     |HAZ CalcuH5;
     |HAZ CalcuH2;
     |HAZ CalcuH3;

     nLimite = (#rem01033@#49 % 15) - #rem01033@#151;
     |SI nLimite < 0;  nLimite = 0;  |FINSI;
     |SI #rem01033@#145 > nLimite;
          #rem01033@#145 = (N\ nLimite);
     |FINSI;

     nLimite = (#rem01033@#46 % 15) - #rem01033@#150;
     |SI nLimite < 0;  nLimite = 0;  |FINSI;
     |SI #rem01033@#143 > nLimite;
          #rem01033@#143 = (N\ nLimite);
     |FINSI;

     #rem01033@#44  = (N\ #rem01033@#39);
     #rem01033@#44  = (N\ #rem01033@#44 - #rem01033@#40);
     #rem01033@#44  = (N\ #rem01033@#44 + #rem01033@#41);
     #rem01033@#44  = (N\ #rem01033@#44 - #rem01033@#155);
     #rem01033@#44  = (N\ #rem01033@#44 - #rem01033@#42);

     #rem01033@#50  = (N\ #rem01033@#46);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#150);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#47);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#156);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#142);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#157);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#143);
     #rem01033@#50  = (N\ #rem01033@#50 + #rem01033@#49);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#151);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#111);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#159);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#144);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#160);
     #rem01033@#50  = (N\ #rem01033@#50 - #rem01033@#145);

     #rem01033@#45  = (N\ #rem01033@#34  - #rem01033@#155);
     #rem01033@#162 = (N\ #rem01033@#38  - #rem01033@#151);
     #rem01033@#163 = (N\ #rem01033@#149 - #rem01033@#150);

     enSwAcum  = 0;

     enBloque  = 28;
     eaCasilla = "386";  enImporte = #rem01033@#148; |HAZ GrabaLineal;
     eaCasilla = "387";  enImporte = #rem01033@#149; |HAZ GrabaLineal;

     enBloque  = 29;
     eaCasilla = "380";  enImporte = #rem01033@#39;  |HAZ GrabaLineal;
     eaCasilla = "388";  enImporte = #rem01033@#40;  |HAZ GrabaLineal;
     eaCasilla = "389";  enImporte = #rem01033@#41;  |HAZ GrabaLineal;
     eaCasilla = "390";  enImporte = #rem01033@#155; |HAZ GrabaLineal;
     eaCasilla = "391";  enImporte = #rem01033@#42;  |HAZ GrabaLineal;
     eaCasilla = "392";  enImporte = #rem01033@#44;  |HAZ GrabaLineal;

     enBloque  = 30;
     eaCasilla = "384";  enImporte = #rem01033@#46;  |HAZ GrabaLineal;
     eaCasilla = "393";  enImporte = #rem01033@#150; |HAZ GrabaLineal;
     eaCasilla = "394";  enImporte = #rem01033@#47;  |HAZ GrabaLineal;
     eaCasilla = "395";  enImporte = #rem01033@#156; |HAZ GrabaLineal;
     eaCasilla = "396";  enImporte = #rem01033@#142; |HAZ GrabaLineal;
     eaCasilla = "397";  enImporte = #rem01033@#157; |HAZ GrabaLineal;
     eaCasilla = "398";  enImporte = #rem01033@#143; |HAZ GrabaLineal;
     eaCasilla = "386";  enImporte = #rem01033@#49;  |HAZ GrabaLineal;
     eaCasilla = "399";  enImporte = #rem01033@#151; |HAZ GrabaLineal;
     eaCasilla = "400";  enImporte = #rem01033@#111; |HAZ GrabaLineal;
     eaCasilla = "401";  enImporte = #rem01033@#159; |HAZ GrabaLineal;
     eaCasilla = "402";  enImporte = #rem01033@#144; |HAZ GrabaLineal;
     eaCasilla = "403";  enImporte = #rem01033@#160; |HAZ GrabaLineal;
     eaCasilla = "404";  enImporte = #rem01033@#145; |HAZ GrabaLineal;
     eaCasilla = "405";  enImporte = #rem01033@#50;  |HAZ GrabaLineal;

     enBloque  = 31;
     eaCasilla = "406";  enImporte = #rem01033@#45;  |HAZ GrabaLineal;
     eaCasilla = "407";  enImporte = #rem01033@#162; |HAZ GrabaLineal;
     eaCasilla = "408";  enImporte = #rem01033@#163; |HAZ GrabaLineal;

     |GRABA 020#rem01033@.a;
     |LIBERA #rem01033@;
     |CIERRA #rem01033@;

     |DESCARGA_DEF #rem01026@;
     |DESCARGA_DEF #rem01033@;
|FPRC;
