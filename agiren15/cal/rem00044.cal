|FICHEROS;
     rem00044 #20;

     rem00021 #6;
     rem00007 #7,MANTE;
     rem00008 #8;
     rem00100 #100;
     rem00101 #101;
     reparame #1;
     rew99999 #999;

     rew00644 #644,MANTE;
     rew00003;

     espejo@;
     rem01001@;
     rem01043@;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";
     aAnyoI        = "";
     aAnyoF        = "";

     aPerceptor    = "";
     aEdad         = "";
     aEdadPer      = "";
     aAnyoAdop     = "";
     aNecAyuda     = "";
     aPreg1        = "";
     aPreg2        = "";
     aPrestamo     = "";
     aAyuda        = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";
     aEdadTit      = "";
     aEdadCon      = "";
     aBase         = "";
     aMas          = "";
     aPathFich     = "";

     nVentana       = -1;
     nCampo         = 0;
     nRango         = 0;
     nGrid          = -1;
     nLabel         = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonReco     = 0;
     nBotonCntr     = 0;
     nPanta         = 0;
     nID            = 0;
     nEntrar        = 0;

     n733           = 0;
     n807_2013      = 0;
     n807_2014      = 0;
     n816           = 0;
     n846           = 0;
     n964           = 0;
     n965           = 0;

     nLong         = 0;
     nNume         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nCampo15      = 0;
     nCampo16      = 0;
     nCampo17      = 0;
     nCampo20      = 0;
     nCampo27      = 0;
     nValor        = 0;
     nValor1       = 0;
     nValorPat     = 0;
     nDias         = 0;
     nAnyoVenta    = 0;
     nAnyoCompra   = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nLinea        = 0;
     nContenido    = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nPorce        = 0;
     nInteres      = 0;
     nAnyo         = 0;
     nAnyoDesde    = 0;
     nAnyoHasta    = 0;
     nDiasAnyo     = 0;
     nImporte1     = 0;
     nImporte2     = 0;
     nImporte3     = 0;
     nTope         = 0;

     nTodosDias    = 0;
     nParciDias    = 0;

     nComunidad    = 0;
     nTipo         = 0;
     nNumero       = 0;
     nInversion    = 0;
     nDeduccion    = 0;
     nDeduccionC   = 0;
     nHijosAnt     = 0;
     nHijosEje     = 0;
     nHijosDed     = 0;
     nHijosDed1    = 0;
     nHijosDed2    = 0;
     nHijosDed3    = 0;
     nHijosDedM    = 0;
     nHijosDedM1   = 0;
     nHijosDedM2   = 0;
     nHijosDedM3   = 0;
     nHijosDed33   = 0;
     nHijosDed333  = 0;
     nAnyo1        = 0;
     nAnyo2        = 0;
     nAnyoNac      = 0;
     nEl23         = 0;
     nEl22         = 0;

     nHijosAdop    = 0;
     nHijosAdopI   = 0;
     nHijosAdopI3  = 0;
     nAscend       = 0;
     nAscendN      = 0;
     nAscend70     = 0;
     nAscend65     = 0;
     nAscend65Prop = 0;
     nMinusv       = 0;
     nMinusTodos   = 0;
     nMinusTodos65 = 0;
     nMinusv33     = 0;
     nMinusv65     = 0;
     nMinusD       = 0;
     nMinusD65     = 0;
     nMinus33      = 0;
     nMinus65      = 0;
     nMinusEntero65= 0;
     nEdadMayor    = 0;
     nHijosNac33   = 0;
     nTotalHijos   = 0;
     nTotalHijosMin= 0;
     nHijos        = 0;
     nHijosTres    = 0;
     nHijosTres1   = 0;
     nHijosTresA   = 0;
     nHijosTresA1  = 0;
     nHijosTresA2  = 0;
     nHijosTresA3  = 0;
     nHijosDosA    = 0;
     nHijos2013    = 0;
     nHijos2014    = 0;
     nHijos2014Mul = 0;
     nHijosMult    = 0;
     nHijosMult1   = 0;
     nHijosMult3   = 0;
     nHijos65      = 0;
     nHijos65_1    = 0;
     nHijos65Prop  = 0;
     nPerc33       = 0;
     nPerc65       = 0;
     nAbuelo75      = 0;
     nAbueloMensaje = 0;
     nCantidad     = 0;
     nCantidad1    = 0;
     nCantidad2    = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     nInteres1     = 0;
     nInteres2     = 0;
     nPorceDed     = 0;
     nGradoMinus   = 0;
     nSwMensa      = 0;
     nAndalucia    = 0;
     nPuesto       = 0;
     nDesde        = 0;
     nSwPase       = 0;
     nSuma         = 0;

     fFecha        = @;
     fFechaAdq     = @;
     fFechaTra     = @;
     fFecha1       = @;
     fFecha2       = @;

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &enCalcCif    = 0;
     &enSwPresenta = 0;
     &enAutonomia  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr16_1   = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";

     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;
|FIN;

|| ---- RECOGIDA AUTOMATICA

|PROCESO LeeCasillaComunidad;
     #8#0 = nComunidad;
     #8#1 = nTipo;
     |LEE 040#8=;
     |SI FSalida ! 0;  |DDEFECTO #8;  |FINSI;
|FPRC;

|PROCESO GrabaLinea;
     |ABRE #7;
     #7#0 = nComunidad;
     |LEE 040#7=;
     |SI FSalida ! 0;  |CIERRA #7;  |ACABA;  |FINSI;
     |CIERRA #7;

     |HAZ LeeCasillaComunidad;

     |DDEFECTO #20;
     nLinea = nLinea + 1;
     #20#0   = enEmpresa;
     #20#1   = nLinea;
     #20#2   = aPerceptor;
     #20#3   = "A";
     #20#11  = #7#0;
     #20#12  = #7#1;
     #20#13  = #8#1;
     #20#14  = #8#2;
     #20#15  = #8#3;
     #20#16  = #8#4;
     #20#17  = nNumero;
     #20#18  = nInversion;
     #20#19  = nDeduccion;
     #20#22  = nDeduccionC;
     #20#20  = nPorceDed;

     |SI aPrestamo ! "";
         #20#25 = aPrestamo % 104;
         #20#26 = aPrestamo % 504;
         #20#27 = aPrestamo % 902;
         #20#28 = aPrestamo % 1110;
     |FINSI;

     |GRABA 020#20n;
     |LIBERA #20;
|FPRC;

|PROCESO Descendientes;
     |SI #101#7 = " ";
         nTotalHijos = nTotalHijos + 1;

         |SI #101#6 ] 33;
             nTotalHijosMin = nTotalHijosMin + 1;
         |FINSI;
     |FINSI;

     |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
         nTotalHijos = nTotalHijos + 1;

         |SI #101#6 ] 33; nTotalHijosMin = nTotalHijosMin + 1;  |FINSI;
     |FINSI;

     |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
         nTotalHijos = nTotalHijos + 1;

         |SI #101#6 ] 33; nTotalHijosMin = nTotalHijosMin + 1;  |FINSI;
     |FINSI;

     |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
         nTotalHijos = nTotalHijos + 1;

         |SI #101#6 ] 33; nTotalHijosMin = nTotalHijosMin + 1;  |FINSI;
     |FINSI;

     |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
         nTotalHijos = nTotalHijos + 1;

         |SI #101#6 ] 33; nTotalHijosMin = nTotalHijosMin + 1;  |FINSI;
     |FINSI;

     |SI #101#5 < "2015"; |Y #101#4 ! "    ";  |Y #101#4 ! "0000";
         |SI #101#7 = " ";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijosAnt = nHijosAnt + 1;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         |SI #101#7 = " ";
             nHijos65Prop  = nHijos65Prop + .5;
             nHijosDedM1   = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijos65Prop = nHijos65Prop + 1;
             nHijosDedM1  = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijos65Prop = nHijos65Prop + .5;
             nHijosDedM1  = nHijosDedM1  + 1;
             nHijosDedM3  = nHijosDedM3  + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijos65Prop = nHijos65Prop + 1;
             nHijosDedM1  = nHijosDedM1 + 1;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijos65Prop = nHijos65Prop + .5;
             nHijosDedM1  = nHijosDedM1 + 1;
             nHijosDedM3  = nHijosDedM3 + 1;
         |FINSI;
     |FINSI;

     aAnyoAdop = #101#18 % -104;
     |SI #101#5 = "2015";  |O aAnyoAdop = "2015";
         |SI #101#7 = " ";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed1 = nHijosDed1 + 1;

             |SI aAnyoAdop = "2015";
                 |SI #101#22 = "S";
                     nHijosAdopI = nHijosAdopI + 0.5;
                 |SINO;
                     nHijosAdop  = nHijosAdop + 0.5;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 33;
                 nHijosNac33 = nHijosNac33 + 1;

                 |SI nTotalHijos > 1;
                     nHijosDed33  = nHijosDed33 + 1;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM = nHijosDedM  + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nHijosEje  = nHijosEje  + 1;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;

             |SI aAnyoAdop = "2015";
                 |SI #101#22 = "S";
                     nHijosAdopI = nHijosAdopI + 1;
                 |SINO;
                     nHijosAdop  = nHijosAdop + 1;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 33; |Y nTotalHijos > 1; nHijosDed33  = nHijosDed33 + 1;  |FINSI;

             |SI #101#6 ] 65;    nHijosDedM   = nHijosDedM  + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;
             nHijosDed3 = nHijosDed3 + 1;

             |SI aAnyoAdop = "2015";
                 |SI #101#22 = "S";
                     nHijosAdopI = nHijosAdopI + 0.5;
                     nHijosAdopI3 = nHijosAdopI3 + 1;
                 |SINO;
                     nHijosAdop  = nHijosAdop + 0.5;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 33; |Y nTotalHijos > 1;
                 nHijosDed33   = nHijosDed33 + 1;
                 nHijosDed333  = nHijosDed333 + 1;
             |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
                 nHijosDedM2 = nHijosDedM2 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nHijosEje  = nHijosEje  + 1;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;

             |SI aAnyoAdop = "2015";
                 |SI #101#22 = "S";
                     nHijosAdopI = nHijosAdopI + 1;
                 |SINO;
                     nHijosAdop  = nHijosAdop + 1;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 33; |Y nTotalHijos > 1;  nHijosDed33  = nHijosDed33 + 1;  |FINSI;

             |SI #101#6 ] 65;  nHijosDedM   = nHijosDedM  + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nHijosEje  = nHijosEje  + 0.5;
             nHijosDed  = nHijosDed  + 1;
             nHijosDed2 = nHijosDed2 + 1;
             nHijosDed3 = nHijosDed3 + 1;

             |SI aAnyoAdop = "2015";
                 |SI #101#22 = "S";
                     nHijosAdopI = nHijosAdopI + 0.5;
                     nHijosAdopI3 = nHijosAdopI3 + 1;
                 |SINO;
                     nHijosAdop  = nHijosAdop + 0.5;
                 |FINSI;
             |FINSI;

             |SI #101#6 ] 33; |Y nTotalHijos > 1;
                 nHijosDed33   = nHijosDed33 + 1;
                 nHijosDed333  = nHijosDed333 + 1;
             |FINSI;

             |SI #101#6 ] 65;
                 nHijosDedM  = nHijosDedM  + 1;
                 nHijosDedM2 = nHijosDedM2 + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     aAnyoAdop = #101#18 % -104;
     nAnyo1    = #101#5;
     nAnyo2    = aAnyoAdop;
     nAnyoNac  = nAnyo1;
     |SI nAnyoNac < nAnyo2;
         nAnyoNac  = nAnyo2;
     |FINSI;

     |SI nAnyoNac = "2013";  |O nAnyoNac = "2014";
         |SI nAnyoNac = "2014";  nHijos2014Mul = nHijos2014Mul + 1;  |FINSI;

         |SI #101#7 = " ";
             |SI nAnyoNac = "2013";  nHijos2013  = nHijos2013  + 0.5;  |FINSI;
             |SI nAnyoNac = "2014";  nHijos2014  = nHijos2014  + 0.5;  |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
              |SI nAnyoNac = "2013";  nHijos2013  = nHijos2013  + 1;  |FINSI;
              |SI nAnyoNac = "2014";  nHijos2014  = nHijos2014  + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             |SI nAnyoNac = "2013";  nHijos2013  = nHijos2013  + 0.5;  |FINSI;
             |SI nAnyoNac = "2014";  nHijos2014  = nHijos2014  + 0.5;  |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             |SI nAnyoNac = "2013";  nHijos2013  = nHijos2013  + 1;  |FINSI;
             |SI nAnyoNac = "2014";  nHijos2014  = nHijos2014  + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             |SI nAnyoNac = "2013";  nHijos2013  = nHijos2013  + 0.5;  |FINSI;
             |SI nAnyoNac = "2014";  nHijos2014  = nHijos2014  + 0.5;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#5 ] "2013";
         |SI #101#7 = " ";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 0.5;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 0.5;
             |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 1;
             |FINSI;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             |SI #101#6 < 65;
                 nHijosTres  = nHijosTres  + 1;
                 nHijosTres1 = nHijosTres1 + 0.5;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #101#6 ] 65;
             |SI #101#7 = " ";
                 nHijos65   = nHijos65 + 1;
                 nHijos65_1 = nHijos65_1 + 0.5;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijos65   = nHijos65 + 1;
                 nHijos65_1 = nHijos65_1 + 1;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijos65   = nHijos65 + 1;
                 nHijos65_1 = nHijos65_1 + 0.5;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nHijos65   = nHijos65 + 1;
                 nHijos65_1 = nHijos65_1 + 1;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                 nHijos65   = nHijos65 + 1;
                 nHijos65_1 = nHijos65_1 + 0.5;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#5 ] "2013";
         |SI #101#5 = "2015";
             |SI fFecha = "01.01.0000";
                 fFecha = #101#17;
             |SINO;
                 |SI fFecha = #101#17;
                     nHijosMult = nHijosMult + 1;

                     |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                         nHijosMult1 = nHijosMult1 + 1;
                     |FINSI;

                     |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                         nHijosMult3 = nHijosMult3 + 1;
                     |FINSI;

                     |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                         nHijosMult3 = nHijosMult3 + 1;
                     |FINSI;
                 |FINSI;
                 fFecha = #101#17;
             |FINSI;
         |FINSI;

         |SI #101#5 ! "2015";
             |SI #101#7 = " ";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA1 = nHijosTresA1 + 1;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA2 = nHijosTresA2 + 1;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijosTresA  = nHijosTresA  + 1;
                 nHijosTresA3 = nHijosTresA3 + 1;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                  nHijosTresA  = nHijosTresA  + 1;
                  nHijosTresA2 = nHijosTresA2 + 1;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                  nHijosTresA  = nHijosTresA  + 1;
                  nHijosTresA3 = nHijosTresA3 + 1;
             |FINSI;

             |SI #101#7 = " ";
                 nHijosDosA  = nHijosDosA  + 0.5;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nHijosDosA  = nHijosDosA  + 1;
             |FINSI;

             |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
                 nHijosDosA  = nHijosDosA  + .5;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nHijosDosA  = nHijosDosA  + 1;
             |FINSI;

             |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
                 nHijosDosA  = nHijosDosA  + .5;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ascendientes;
||  Calculo para la 924 de Valencia

     nAnyo = 2015 - #101#5;
     |SI nAnyo ] 75;
         |SI #101#7 = " ";
             nAbuelo75 = nAbuelo75 + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nAbuelo75 = nAbuelo75 + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nAbuelo75 = nAbuelo75 + 1;
         |FINSI;
     |SINO;
         |SI nAnyo ] 65;
             |SI #101#7 = " ";
                 |SI #101#6 ] 65;
                     nAbuelo75 = nAbuelo75 + 1;
                 |SINO;
                     |SI #101#6 ] 33;  nAbueloMensaje = 1; |FINSI;
                 |FINSI;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 |SI #101#6 ] 65;
                     nAbuelo75 = nAbuelo75 + 1;
                 |SINO;
                     |SI #101#6 ] 33;  nAbueloMensaje = 1; |FINSI;
                 |FINSI;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 |SI #101#6 ] 65;
                     nAbuelo75 = nAbuelo75 + 1;
                 |SINO;
                     |SI #101#6 ] 33;  nAbueloMensaje = 1; |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

|| Fin  Calculo para la 924 de Valencia

     |SI #101#5 [ aEdad;  |Y #101#5 ! "    ";  |Y #101#5 ! "0000";
         |SI #101#7 = " ";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 nAscend70  = nAscend70  + .5;
             |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 |SI #101#15 = "S";
                     nAscend70  = nAscend70  + (1 % #101#11);
                 |SINO;
                     nAscend70  = nAscend70  + 1;
                 |FINSI;
              |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nAscend = nAscend + 1;
             |SI #101#6 < 65;
                 |SI #101#15 = "S";
                     nAscend70  = nAscend70  + (1 % #101#11);
                 |SINO;
                     nAscend70  = nAscend70  + 1;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #101#7 = " ";  |Y #101#11 ] 50;
             nAscendN = nAscendN + .5;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";  |Y #101#11 ] 50;
             nAscendN = nAscendN + 1;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";  |Y #101#11 ] 50;
             nAscendN = nAscendN + 1;
         |FINSI;
     |SINO;
         |SI #101#6 ] 65;
             |SI #101#7 = " ";
                 nAscend65 = nAscend65  + .5;
             |FINSI;

             |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
                 nAscend65  = nAscend65 + 1;
             |FINSI;

             |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
                 nAscend65  = nAscend65 + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         |SI #101#7 = " ";
             nAscend65Prop = nAscend65Prop  + .5;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nAscend65Prop  = nAscend65Prop + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nAscend65Prop  = nAscend65Prop + 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalcuHijos;
     |SI #101#4 = "DESCENDIENTE";  |HAZ Descendientes;  |FINSI;
     |SI #101#4 = "ASCENDIENTE ";  |HAZ Ascendientes;   |FINSI;

     |SI #101#6 ] 33;
         |SI #101#14 = "S";
             aNecAyuda = "S";
         |FINSI;

         |SI #101#7 = " ";
             nMinusv  = nMinusv  + 1;
             |SI #101#6 ] 65; nMinusEntero65 = nMinusEntero65 + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nMinusv  = nMinusv  + 1;
             |SI #101#6 ] 65; nMinusEntero65 = nMinusEntero65 + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nMinusv  = nMinusv  + 1;
             |SI #101#6 ] 65; nMinusEntero65 = nMinusEntero65 + 1;  |FINSI;
         |FINSI;

         |SI #101#7 = " ";
             nMinusv33 = nMinusv33  + 0.5;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nMinusv33 = nMinusv33  + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nMinusv33 = nMinusv33  + 0.5;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nMinusv33 = nMinusv33  + 1;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nMinusv33 = nMinusv33  + 0.5;
         |FINSI;
     |FINSI;

     |SI #101#6 ] 65;
         nMinusTodos = nMinusTodos + 1;

         |SI #101#7 = " ";
             nMinusv65 = nMinusv65  + .5;
         |FINSI;

         |SI #101#7 = "1";  |Y aPerceptor = "TITULAR";
             nMinusv65  = nMinusv65  + 1;
         |FINSI;

         |SI #101#7 = "2";  |Y aPerceptor = "CONYUGE";
             nMinusv65  = nMinusv65 + 1;
         |FINSI;

         |SI #101#7 = "3";  |Y aPerceptor = "TITULAR";
             nMinusv65  = nMinusv65  + .5;
         |FINSI;

         |SI #101#7 = "4";  |Y aPerceptor = "CONYUGE";
             nMinusv65  = nMinusv65  + .5;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem00101;
     #101#1;
     ;
     #20#0, 01;
     #20#0, 99;
     ;
     NULL, CalcuHijos;
|FIN;

|PROCESO LeeFamiliar;
     nTotalHijos    = 0;
     nTotalHijosMin = 0;
     nHijosNac33    = 0;
     nHijosAnt      = 0;   || Numero de Hijos nacidos antes de este ejercicio
     nHijosEje      = 0;   || Numero de Hijos nacidos en este ejercicio proporcinando
     nHijosDed      = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed1     = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed2     = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed3     = 0;   || Numero de Hijos nacidos en este ejercicio V.3 y 4
     nHijosDedM     = 0;   || Numero de Hijos nacidos en este ejercicio Minusv.
     nHijosDedM1    = 0;   || Numero de Hijos Minusvalidos > 65.
     nHijosDedM2    = 0;   || Numero de Hijos Minusvalidos > 65. V.3 y 4
     nHijosDedM3    = 0;   || Numero de Hijos Minusvalidos > 65. V.3 y 4
     nHijosDed33    = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijosDed333   = 0;   || Numero de Hijos nacidos en este ejercicio
     nHijos65Prop   = 0;  || Hijos Minusvalidos proporcional
     nHijosTres     = 0;   || Numero de Hijos menores de Tres a¤os Minusvalia < 65
     nHijosTres1    = 0;   || Numero de Hijos menores de Tres a¤os Minusvalia < 65
     nHijosTresA    = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA1   = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA2   = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosTresA3   = 0;   || Numero de Hijos menores de Tres a¤os Vinculacion 3 Y 4
     nHijosDosA     = 0;   || Numero de Hijos menores de Tres a¤os
     nHijosMult     = 0;   || Hijos Multiples
     nHijosMult1    = 0;   || Hijos Multiples Vinculacion 3 y 4
     nHijosMult3    = 0;   || Hijos Multiples Vinculacion 3 y 4
     nHijosAdop     = 0;   || Numero de Hijos Adoptados
     nHijosAdopI    = 0;   || Numero de Hijos Adoptados internacional
     nHijosAdopI3   = 0;   || Numero de Hijos Adoptados internacional Vinculacion 3 y 4
     nHijos65       = 0;   || Numero de Hijos Adoptados internacional Vinculacion 3 y 4
     nHijos65_1     = 0;   || Numero de Hijos Adoptados internacional Vinculacion 3 y 4
     nHijos2013     = 0;   || Numero de Hijos nacidos
     nHijos2014     = 0;   || Numero de Hijos nacidos
     nHijos2014Mul  = 0;   || Numero de Hijos nacidos  multiples
     nPerc33        = 0;   || Perceptor con minusvalia 33
     nPerc65        = 0;   || Perceptor con minusvalia 65
     nEdadMayor     = 0;   || Sujetos Pasivos de ....A¤os o mas
     nAscend        = 0;   || Ascendientes de ... A¤os  o mas
     nAscendN       = 0;   || Ascendientes de ... A¤os  o mas sin vinculacion
     nAscend70      = 0;   || Ascendientes de ... A¤os  o mas
     nAscend65      = 0;   || Ascendientes de ... A¤os  o mas
     nAscend65Prop  = 0;   || Ascendientes Minusvalido proporcional
     nMinusv        = 0;   || Minusvalidos
     nMinusv65      = 0;   || Minusvalidos
     nMinusv33      = 0;   || Minusvalidos
     nMinusD        = 0;   || Minusvalidos
     nMinusD65      = 0;   || Minusvalidos
     nMinusTodos    = 0;   || Suma de Todos los Minusvalidos
     nMinusTodos65  = 0;   || Suma de Todos los Minusvalidos
     nMinusEntero65 = 0;
     nAbuelo75      = 0;
     nAbueloMensaje = 0;

     fFecha      = "01.01.0000";
     aNecAyuda   = "";

     |BUCLE rem00101;

     |SI #100#8  ] 65;  nMinusTodos   = nMinusTodos   + 1;  |FINSI;
     |SI #100#41 ] 65;  nMinusTodos   = nMinusTodos   + 1;  |FINSI;
     |SI #100#8  ] 65;  nMinusTodos65 = nMinusTodos65 + 1;  |FINSI;
     |SI #100#41 ] 65;  nMinusTodos65 = nMinusTodos65 + 1;  |FINSI;

     |SI aPerceptor = "TITULAR";
         |SI #100#8 ] 33;                           nMinusv    = nMinusv + 1; |FINSI;
         |SI #100#8 ] 33;                           nMinusD    = 1;           |FINSI;
         |SI #100#8 ] 65;                           nMinusD65      = 1;           |FINSI;
         |SI #100#8 ] 65;                           nMinusEntero65 = nMinusEntero65 + 1;           |FINSI;
         |SI #100#7 [ aEdad;  |Y #100#7  ! "    ";  |Y #100#7 ! "0000";
             nEdadMayor = 1;
         |FINSI;

         |SI #100#8 ] 33;  |Y #100#8 < 65;
             nPerc33 = nPerc33 + 1;
         |FINSI;

         |SI #100#8 ] 65;
             nPerc65 = nPerc65 + 1;
         |FINSI;

         aAyuda = #100#9;
     |FINSI;

     |SI aPerceptor = "CONYUGE";
         |SI #100#41 ] 33;                           nMinusv = nMinusv + 1; |FINSI;
         |SI #100#41 ] 33;                           nMinusD    = 1;        |FINSI;
         |SI #100#41 ] 65;                           nMinusD65  = 1;        |FINSI;
         |SI #100#41 ] 65;                           nMinusEntero65 = nMinusEntero65 + 1;           |FINSI;
         |SI #100#40 [ aEdad;  |Y #100#40 ! "    ";  |Y #100#40 ! "0000";
             nEdadMayor = 1;
         |FINSI;

         |SI #100#41 ] 33;  |Y #100#41 < 65;
             nPerc33 = nPerc33 + 1;
         |FINSI;

         |SI #100#41 ] 65;
             nPerc65 = nPerc65 + 1;
         |FINSI;

         aAyuda = #100#42;
     |FINSI;
|FPRC;

|PROCESO MiraVivienda;
     |SI #6#2 = "TITULAR   ";  |Y aPerceptor = "CONYUGE";  |ACABA;  |FINSI;
     |SI #6#2 = "CONYUGE   ";  |Y aPerceptor = "TITULAR";  |ACABA;  |FINSI;
     |SI #6#3 = "X";                                       |ACABA;  |FINSI;

     |SI #6#30 = 0;  |Y #6#33 = 0;
         |ACABA;
     |FINSI;

     nPorceDed = 0;
     |SI nAndalucia = 1;
         |SI #6#25 < "01.01.2003";  |ACABA;      |FINSI;
         |SI #6#30 = 0;             |ACABA;      |FINSI;

         nPorceDed = 3;
         |SI aEdadPer [ "1980";     nPorceDed = 2;  |FINSI;
     |FINSI;

     |SI #6#2 = "TITULAR   ";  nPorce = 100;  |FINSI;
     |SI #6#2 = "CONYUGE   ";  nPorce = 100;  |FINSI;
     |SI #6#2 = "GANANCIAL ";  nPorce = 50;   |FINSI;
     |SI #6#2 = "VARIOS    ";
         |SI aPerceptor = "TITULAR";  nPorce = #6#5;  |FINSI;
         |SI aPerceptor = "CONYUGE";  nPorce = #6#6;  |FINSI;
     |FINSI;

     nEl23  = (#6#95 + #6#96 + #6#99 + #6#100) % #6#134;
     nEl23  = nEl23 + #6#97 + #6#98 + #6#101 + #6#102;
     nEl22  = #6#22 % #6#134;

     |SI #100#11 = 1;
         nCantidad    = nCantidad + (nEl23 % nPorce);
     |FINSI;

     |SI #100#11 = 3;
         nCantidad    = nCantidad + ((nEl23 - nEl22) % nPorce);
     |FINSI;

     |SI #100#11 = 10;
         nCantidad    = nCantidad + ((nEl23 + #6#29) % nPorce);
     |FINSI;

     |SI #100#11 = 13;
         nCantidad    = nCantidad + (nEl23 % nPorce);
     |FINSI;

     |SI #100#11 = 7;
         |SI aPrestamo = "";
             aPrestamo = #6#116;   |QBF aPrestamo;
         |FINSI;
         nCantidad    = nCantidad + (((#6#95 + #6#99 + #6#96 + #6#100) % nPorce) % #6#134);
     |FINSI;

     |SI #100#11 = 17;
         nCantidad    = nCantidad + ((nEl23 - nEl22) % nPorce);

         |SI #6#25 ] "20.01.2006";
             nCanti1     = (#6#95 + #6#99)  % #6#134;
             nCanti2     = (#6#96 + #6#100) % #6#134;
             nCantidad1  = nCantidad1 + (nCanti1 % nPorce);
             nCantidad2  = nCantidad2 + (nCanti2 % nPorce);
         |FINSI;
     |FINSI;

     |SI #6#119 = "S";  aPreg1 = "S";  |FINSI;
     |SI #6#135 = "S";  aPreg2 = "S";  |FINSI;
|FPRC;

|DEFBUCLE rem00021;
     #6#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, MiraVivienda;
|FIN;

|PROCESO rem01001;
     |SI nComunidad = 1;
         #rem01043@#0  = #rem01001@#0;
         #rem01043@#1  = #rem01001@#1;
         #rem01043@#2  = #rem01001@#2;
         #rem01043@#3  = 1;
         #rem01043@#4  = 756;
         |LEE 000#rem01043@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #rem01043@#12 = 0;
             |ACABA;
         |FINSI;

         aAlfa = #rem01043@#2;  |QBF aAlfa;
         |SI aAlfa = aPerceptor;
             n733 = #rem01043@#12;
             |ACABA;
         |FINSI;

         |SI aAlfa = "CONJUNTA";  |O aAlfa = "CONJUNTAE";
             |SI aPerceptor = "TITULAR";
                 n733 = #rem01043@#12;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nComunidad = 6;
         #rem01043@#0  = #rem01001@#0;
         #rem01043@#1  = #rem01001@#1;
         #rem01043@#2  = #rem01001@#2;
         #rem01043@#3  = 6;
         #rem01043@#4  = 823;
         |LEE 000#rem01043@.=;
         |SI FSalida = 0;  |Y #rem01043@#12 ! 0;
             aAlfa = #rem01043@#2;  |QBF aAlfa;
             |SI aAlfa = aPerceptor;
                 n807_2013 = #rem01043@#12;
             |FINSI;

             |SI aAlfa = "CONJUNTA";  |O aAlfa = "CONJUNTAE";
                 |SI aPerceptor = "TITULAR";
                     n807_2013 = #rem01043@#12;
                  |FINSI;
             |FINSI;
         |FINSI;

         #rem01043@#0  = #rem01001@#0;
         #rem01043@#1  = #rem01001@#1;
         #rem01043@#2  = #rem01001@#2;
         #rem01043@#3  = 6;
         #rem01043@#4  = 825;
         |LEE 000#rem01043@.=;
         |SI FSalida = 0;  |Y #rem01043@#12 ! 0;
             aAlfa = #rem01043@#2;  |QBF aAlfa;
             |SI aAlfa = aPerceptor;
                 n807_2014 = #rem01043@#12;
             |FINSI;

             |SI aAlfa = "CONJUNTA";  |O aAlfa = "CONJUNTAE";
                 |SI aPerceptor = "TITULAR";
                     n807_2014 = #rem01043@#12;
                  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nComunidad = 7;
         #rem01043@#0  = #rem01001@#0;
         #rem01043@#1  = #rem01001@#1;
         #rem01043@#2  = #rem01001@#2;
         #rem01043@#3  = 7;
         #rem01043@#4  = 832;
         |LEE 000#rem01043@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #rem01043@#13 = 0;
             |ACABA;
         |FINSI;

         aAlfa = #rem01043@#2;  |QBF aAlfa;
         |SI aAlfa = aPerceptor;
             n816 = #rem01043@#13;
             |ACABA;
         |FINSI;

         |SI aAlfa = "CONJUNTA";  |O aAlfa = "CONJUNTAE";
             |SI aPerceptor = "TITULAR";
                 n816 = #rem01043@#13;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nComunidad = 8;
         #rem01043@#0  = #rem01001@#0;
         #rem01043@#1  = #rem01001@#1;
         #rem01043@#2  = #rem01001@#2;
         #rem01043@#3  = 8;
         #rem01043@#4  = 999;
         |LEE 000#rem01043@.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |SI #rem01043@#13 = 0;  |Y #rem01043@#14 = 0;
          |Y #rem01043@#15 = 0;  |Y #rem01043@#16 = 0;
             |ACABA;
         |FINSI;

         aAlfa = #rem01043@#2;  |QBF aAlfa;
         |SI aAlfa = "CONJUNTA";  |O aAlfa = "CONJUNTAE";
             |SI aPerceptor = "TITULAR";
                 n964 = #rem01043@#13 + #rem01043@#15;
                 n965 = #rem01043@#14;
                 n846 = #rem01043@#16;
             |FINSI;
         |SINO;
            aAlfa = #rem01043@#2;  |QBF aAlfa;
             |SI aAlfa = aPerceptor;
                 n964 = #rem01043@#13 + #rem01043@#15;
                 n965 = #rem01043@#14;
                 n846 = #rem01043@#16;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001;
     #rem01001@#1003;
     5;
     enEmpresa, 00, "          ", "100";
     enEmpresa, 99, "zzzzzzzzzz", "101";
     ;
     NULL, rem01001;
|FIN;

|PROCESO PendientesAndalucia;
     |DBASS aBase;
     aMas = aBase + "agiren14/def/rem01001.mas";
     |CARGA_DEF aMas, rem01001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "agiren14/def/rem01043.mas";
     |CARGA_DEF aMas, rem01043@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aPathFich = aBase + "agiren14/fich/";
     |PATH_DAT #rem01001@#aPathFich#;
     |PATH_DAT #rem01043@#aPathFich#;

     n733 = 0;

     |ABRE #rem01043@;
     |BUCLE rem01001;
     |CIERRA #rem01043@;

     |DESCARGA_DEF #rem01043@;
     |DESCARGA_DEF #rem01001@;

     |SI n733 ! 0;
         nTipo       = 733;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n733;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Andalucia;
     |HAZ LeeFamiliar;

     |HAZ PendientesAndalucia;

     |SI nHijosTresA ! 0;  |Y nHijosDed ! 0;
         nTipo       = 717;  |HAZ LeeCasillaComunidad;

         nNumero     = nHijosTresA;
         nInversion  = 0;
         nDeduccion  = (nHijosTresA1 * #8#9) + (nHijosTresA2 * (#8#9 * 2)) + (nHijosTresA3 * #8#9);
         |SI nHijosMult ! 0;
             nDeduccion  = nDeduccion + (#8#9 * (nHijosMult + 1));
         |FINSI;

         nDeduccionC = (nHijosTresA3 * #8#9);
         |SI nHijosMult3 ! 0;
             nDeduccionC  = nDeduccionC + (#8#9 * (nHijosMult3 + 1));
         |FINSI;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosAdopI ! 0;
         nTipo       = 724;   |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdopI;
         nInversion  = 0;
         nDeduccion  = (nHijosAdopI  * (#8#9 * 2));
         nDeduccionC = (nHijosAdopI3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD ! 0;
         nTipo       = 725;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nCantidad  = 0;
     nPorce     = 100;
     nAndalucia = 1;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y nPorceDed = 3;
         nTipo       = 719;  |HAZ LeeCasillaComunidad;
         nDeduccionC = 0;
         nNumero     = 0;
         nInversion  = nCantidad;
         |SI nPorceDed = 3;
             |SI nInversion > #8#13;
                 nInversion = #8#13;
             |FINSI;
         |FINSI;

         nDeduccion  = nInversion % nPorceDed;

         |HAZ GrabaLinea;

         nPorceDed = 0;
     |FINSI;

     |SI #100#95 = "N";
         nTipo      = 726;  |HAZ LeeCasillaComunidad;

         aEdad = "1940";
         |HAZ LeeFamiliar;

         nDeduccion = 0;
         |SI nTotalHijos ! 0;
             nDeduccion = #8#9;
         |FINSI;

         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = nDeduccion + (nAscend * #8#11);
         nDeduccionC = 0;

         |SI nDeduccion ! 0;
             |HAZ GrabaLinea;
         |FINSI;
     |FINSI;

     |SI nMinusv33 ! 0;
         nTipo       = 727;  |HAZ LeeCasillaComunidad;

         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = (nMinusv33 * #8#9);
         nDeduccionC = 0;

         |HAZ GrabaLinea;

         |SI aNecAyuda = "S";
             |MENAV "0000Hay discapacitados que necesitan ayuda";
             |MENAV "0000De de alta la deduccion 810 con el 15% de las cuotas de la S.S. del titular del hogar.";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Aragon;
     aEdad = "1940";
     |HAZ LeeFamiliar;

     |SI nHijosDed ! 0;
         |SI nTotalHijos > 1;
             |SI nHijosDed = nTotalHijos;
                 nHijosDed = nHijosDed - 1;
             |FINSI;

             |SI nHijosDed > 0;
                 nTipo       = 736;  |HAZ LeeCasillaComunidad;
                 nDeduccion  = nHijosDed * #8#9;
                 nInversion  = 0;
                 nDeduccionC = #8#9;
                |HAZ GrabaLinea;
            |FINSI;
         |FINSI;
     |FINSI;

     |SI nHijosNac33 > 0;
         nNumero     = nHijosNac33;
         nTipo       = 737;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosAdopI ! 0;
         nTipo       = 738;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdopI;
         nInversion  = 0;
         nDeduccion  = (nHijosAdopI  * #8#9);
         nDeduccionC = (nHijosAdopI3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAscendN > 0;
         nTipo       = 739;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscendN;
         nInversion  = 0;
         nDeduccion  = nNumero * (#8#9 * 2);
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusv65 > 0;
         nTipo       = 739;  |HAZ LeeCasillaComunidad;
         nNumero     = nMinusv65;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI aEdadPer [ "1945";
         nTipo       = 750;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#7;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Asturias;
     aEdad = "1950";
     |HAZ LeeFamiliar;

     |SI nAscendN ! 0;
         nTipo       = 756;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscendN;
         nInversion  = 0;
         nDeduccion  = nAscendN * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nGradoMinus ] 65;
         nCantidad = 0;
         nPorce    = 100;
         |BUCLE rem00021;
         |SI nCantidad ! 0;
             nTipo       = 757;  |HAZ LeeCasillaComunidad;
             nNumero     = 0;
             nInversion  = nCantidad;
             |SI nInversion > #8#9;
                 nInversion = #8#9;
             |FINSI;
             nDeduccion  = nInversion % 3;
             nDeduccionC = 0;

             |HAZ GrabaLinea;
         |FINSI;
     |FINSI;

     nSuma = nAscend65Prop + nHijos65Prop + nMinusTodos65;
     |SI nGradoMinus = 0;  |Y nSuma ! 0;
         nCantidad = 0;
         nPorce    = 100;
         |BUCLE rem00021;
         |SI nCantidad ! 0;
             nTipo       = 758;  |HAZ LeeCasillaComunidad;
             nNumero     = 0;
             |SI nCantidad > #8#9;
                 nCantidad = #8#9;
             |FINSI;
             nInversion  = nCantidad;
             nDeduccion  = nInversion % 3;
             nDeduccionC = 0;

             |HAZ GrabaLinea;
         |FINSI;
     |FINSI;

     |SI nHijosAdopI ! 0;
         nTipo       = 764;   |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdopI;
         nInversion  = 0;
         nDeduccion  = (nHijosAdopI  * (#8#9 * 2));
         nDeduccionC = (nHijosAdopI3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosMult ! 0;
         nNumero     = 1;
         nTipo       = 765;   |HAZ LeeCasillaComunidad;

         |SI nHijosMult ! nHijosMult1;
             nDeduccion  = #8#9;
         |SINO;
             nDeduccion  = #8#9 * 2;
         |FINSI;

         nInversion  = 0;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Baleares;
     |HAZ LeeFamiliar;

     |SI nPerc33 ! 0;
         nTipo       = 969;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = 80;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nPerc65 ! 0;
         nTipo       = 969;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = 150;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Canarias;
     aEdad = "1950";
     |HAZ LeeFamiliar;

     |SI nHijosDed > 0;
         nPuesto = (nTotalHijos - nHijosDed) + 1;

         nTipo       = 788;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;
         |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
               |SI nDesde = 1;  nDeduccion = nDeduccion + #8#9;  |FINSI;
               |SI nDesde = 2;  nDeduccion = nDeduccion + #8#9;  |FINSI;
               |SI nDesde = 3;  nDeduccion = nDeduccion + #8#11; |FINSI;
               |SI nDesde = 4;  nDeduccion = nDeduccion + #8#13; |FINSI;
               |SI nDesde ] 5;  nDeduccion = nDeduccion + #8#15; |FINSI;
         |SIGUE;

         nDeduccionC = 0;
         |SI nHijosDed3 > 0;
             nPuesto = (nTotalHijos - nHijosDed3) + 1;
             nDeduccionC = 0;
             |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
                   |SI nDesde = 1;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 2;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 3;  nDeduccionC = nDeduccionC + #8#11;  |FINSI;
                   |SI nDesde = 4;  nDeduccionC = nDeduccionC + #8#13;  |FINSI;
                   |SI nDesde ] 5;  nDeduccionC = nDeduccionC + #8#15;  |FINSI;
             |SIGUE;
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nEdadMayor > 0;
         nTipo       = 789;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#11;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD > 0;
         nTipo       = 789;  |HAZ LeeCasillaComunidad;
         nNumero     = nMinusD;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO PendientesCantabria;
     |DBASS aBase;
     aMas = aBase + "agiren14/def/rem01001.mas";
     |CARGA_DEF aMas, rem01001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "agiren14/def/rem01043.mas";
     |CARGA_DEF aMas, rem01043@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aPathFich = aBase + "agiren14/fich/";
     |PATH_DAT #rem01001@#aPathFich#;
     |PATH_DAT #rem01043@#aPathFich#;

     n807_2013 = 0;
     n807_2014 = 0;

     |ABRE #rem01043@;
     |BUCLE rem01001;
     |CIERRA #rem01043@;

     |DESCARGA_DEF #rem01043@;
     |DESCARGA_DEF #rem01001@;

     |SI n807_2013 ! 0;
         nTipo       = 807;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n807_2013;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI n807_2014 ! 0;
         nTipo       = 807;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n807_2014;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Cantabria;
     |HAZ PendientesCantabria;

     aEdad = "1945";
     |HAZ LeeFamiliar;

     nNumero = nAscendN + nAscend65 + nHijosTres1 + nHijos65_1;

     |SI nNumero ! 0;
         nTipo       = 806;  |HAZ LeeCasillaComunidad;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO PendientesCastillaMancha;
     |DBASS aBase;
     aMas = aBase + "agiren14/def/rem01001.mas";
     |CARGA_DEF aMas, rem01001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "agiren14/def/rem01043.mas";
     |CARGA_DEF aMas, rem01043@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aPathFich = aBase + "agiren14/fich/";
     |PATH_DAT #rem01001@#aPathFich#;
     |PATH_DAT #rem01043@#aPathFich#;

     n816 = 0;

     |ABRE #rem01043@;
     |BUCLE rem01001;
     |CIERRA #rem01043@;

     |DESCARGA_DEF #rem01043@;
     |DESCARGA_DEF #rem01001@;

     |SI n816 ! 0;
         nTipo       = 816;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n816;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO CastillaMancha;
     aEdad = "1939";
     |HAZ LeeFamiliar;

     |HAZ PendientesCastillaMancha;

     |SI nHijosDed ! 0;
         nTipo       = 817;  |HAZ LeeCasillaComunidad;

         nNumero     = nHijosDed;
         nDeduccion  = 0;
         nDeduccionC = 0;
         nInversion  = 0;

         |SI nNumero > 0;   nDeduccion = #8#9  / 2;  |FINSI;
         |SI nNumero ] 2;   nDeduccion = #8#13 / 2;  |FINSI;
         |SI nNumero ] 3;   nDeduccion = #8#15 / 2;  |FINSI;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nMinusD65 ! 0;
         nTipo       = 818;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nNumero = nAscend65Prop + nHijos65Prop;
     |SI nNumero ! 0;
         nTipo       = 819;  |HAZ LeeCasillaComunidad;
         nInversion  = 0;
         nDeduccion  = nNumero * (#8#9 * 2);
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;

     nEdadMayor = nEdadMayor - nMinusD65;
     |SI nEdadMayor > 0;
         nTipo       = 820;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAscend70 > 0;
         nTipo       = 821;  |HAZ LeeCasillaComunidad;
         nNumero     = nAscend70;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nNume = nTotalHijos + nTotalHijosMin;
     |SI nNume ] 3;
         nMinus33 = nMinus33 + 2;
     |FINSI;

     |SI nNume ] 2;
         nMinus33 = nMinus33 + (nMinusD - nMinusD65);
         nMinus65 = nMinus65 + nMinusD65;
     |FINSI;
|FPRC;

|PROCESO PendientesLeon;
     |DBASS aBase;
     aMas = aBase + "agiren14/def/rem01001.mas";
     |CARGA_DEF aMas, rem01001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "agiren14/def/rem01043.mas";
     |CARGA_DEF aMas, rem01043@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aPathFich = aBase + "agiren14/fich/";
     |PATH_DAT #rem01001@#aPathFich#;
     |PATH_DAT #rem01043@#aPathFich#;

     n964 = 0;
     n965 = 0;
     n846 = 0;

     |ABRE #rem01043@;
     |BUCLE rem01001;
     |CIERRA #rem01043@;

     |DESCARGA_DEF #rem01043@;
     |DESCARGA_DEF #rem01001@;

     |SI n964 ! 0;
         nTipo       = 964;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n964;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI n846 ! 0;
         nTipo       = 846;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n846;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI n965 ! 0;
         nTipo       = 965;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = 0;
         nDeduccion  = n965;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO CastillaLeon;
     |HAZ PendientesLeon;

     aEdad = "1950";
     |HAZ LeeFamiliar;

     |SI nTotalHijos ] 3;
         nTipo       = 848;  |HAZ LeeCasillaComunidad;

         nNumero     = 0;
         |SI nTotalHijos ] 4;
             nNumero     = 1;
         |FINSI;

         nInversion  = 0;
         |SI nMinusTodos = 0;
             nDeduccion  = #8#9  + (nNumero * #8#13);
         |SINO;
             nDeduccion  = #8#11 + (nNumero * #8#13);
         |FINSI;

         nDeduccionC = 0;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosDed > 0;
         nPuesto = (nTotalHijos - nHijosDed) + 1;

         nTipo       = 849;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;
         |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
               |SI nDesde = 1;  nDeduccion = nDeduccion + #8#9;   |FINSI;
               |SI nDesde = 2;  nDeduccion = nDeduccion + #8#11;  |FINSI;
               |SI nDesde ] 3;  nDeduccion = nDeduccion + #8#13;  |FINSI;
         |SIGUE;
         nDeduccionC = 0;

         |SI nHijosDed3 > 0;
             nPuesto     = (nTotalHijos - nHijosDed3) + 1;
             nDeduccionC = 0;
             |PARA nDesde = nPuesto;  |SI nDesde [ nTotalHijos;  |HACIENDO nDesde = nDesde + 1;
                   |SI nDesde = 1;  nDeduccionC = nDeduccionC + #8#9;   |FINSI;
                   |SI nDesde = 2;  nDeduccionC = nDeduccionC + #8#11;  |FINSI;
                   |SI nDesde ] 3;  nDeduccionC = nDeduccionC + #8#13;  |FINSI;
             |SIGUE;
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijos2014Mul > 1;
         nTipo       = 851;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijos2014;
         nInversion  = 0;
         nDeduccion  = #8#13;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosAdopI > 0;  |O nHijosAdop > 0;
         nNumero     = nHijosAdopI ! 0;
         nTipo       = 855;  |HAZ LeeCasillaComunidad;
         nDeduccion  = (nHijosAdop * #8#9) + (nHijosAdopI * #8#11);
         nDeduccionC = 0;
         nInversion  = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nEdadMayor = 1; |Y nMinusD65 > 0;
         nTipo       = 832;  |HAZ LeeCasillaComunidad;
         nNumero     = 1;
         nInversion  = 0;
         nDeduccion  = #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |SINO;
         |SI nMinusD > 0;
             nTipo       = 832;  |HAZ LeeCasillaComunidad;
             nNumero     = 1;
             nInversion  = 0;
             nDeduccion  = #8#15;
             nDeduccionC = 0;

             |HAZ GrabaLinea;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Catalunya;
     |HAZ LeeFamiliar;

     |SI nHijosDed ! 0;
         nNumero     = nHijosDed;
         nTipo       = 863;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * #8#9;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Extremadura;
     |HAZ LeeFamiliar;

     nCantidad = 0;
     nPorce    = 100;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1980";
         nTipo       = 876;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad;
         |SI nInversion > #8#9;
             nInversion = #8#9;
         |FINSI;

         nDeduccion  = nInversion % 3;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosMult ! 0;
         nNumero     = 1;
         nTipo       = 880;   |HAZ LeeCasillaComunidad;

         nDeduccion  = #8#9;
         nInversion  = 0;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;

     |SI #rem00100#6 = "V";
         nNumero     = 1;
         nTipo       = 884;   |HAZ LeeCasillaComunidad;

         nDeduccion  = #8#13;
         |SI nTotalHijos > 0;
             nDeduccion  = #8#13 * 2;
         |FINSI;

         nInversion  = 0;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Galicia;
     |HAZ LeeFamiliar;

     |SI nHijosEje > 0;
         nTipo       = 890;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosEje;
         nInversion  = 0;
         |SI nHijosMult = 0;
             nDeduccion  = nHijosEje * 300;
         |SINO;
             nDeduccion  = nHijosEje * 360;
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijos2013 > 0;
         nTipo       = 190;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijos2013;
         nInversion  = 0;
         nDeduccion  = nHijos2013 * #8#13;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijos2014 > 0;
         nTipo       = 290;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijos2014;
         nInversion  = 0;
         nDeduccion  = nHijos2014 * #8#13;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Madrid;
     |HAZ LeeFamiliar;

     |SI nHijosDed > 0;
         nTipo       = 906;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosDed;
         nInversion  = 0;
         nDeduccion  = 0;

         |SI nNumero = 1;  nDeduccion = #8#9;             |FINSI;
         |SI nNumero = 2;  nDeduccion = #8#9 + #8#11;     |FINSI;
         |SI nNumero ] 3;
             nDeduccion = (#8#9 + #8#11) + ((nNumero - 2) * #8#13);
         |FINSI;

         nDeduccionC = 0;
         |SI nHijosDed3 = 1;  nDeduccionC = #8#9;         |FINSI;
         |SI nHijosDed3 = 2;  nDeduccionC = #8#9 + #8#11; |FINSI;
         |SI nHijosDed3 ] 3;
             nDeduccionC = (#8#9 + #8#11) + ((nHijosDed3 - 2) * #8#13);
         |FINSI;

         |HAZ GrabaLinea;

         |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
     |FINSI;

     |SI nHijosAdopI ! 0;
         nTipo       = 907;  |HAZ LeeCasillaComunidad;
         nNumero     = nHijosAdopI;
         nInversion  = 0;
         nDeduccion  = (nHijosAdopI  * #8#9);
         nDeduccionC = (nHijosAdopI3 * #8#9);

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO Murcia;
     |HAZ LeeFamiliar;

     nCantidad = 0;
     nPorce    = 100;
     aPreg1    = "N";
     aPreg2    = "N";
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1980";  |Y aPreg1 = "N";  |Y aPreg2 = "N";
         nTipo       = 919;  |HAZ LeeCasillaComunidad;

         nNumero     = 0;
         nInversion  = nCantidad;
         nDeduccion  = nInversion % 5;
         nPorceDed   = 5;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nCantidad ! 0; |Y aPreg2 = "S";
         nTipo       = 119;  |HAZ LeeCasillaComunidad;
         nInversion  = nCantidad;
         nDeduccion  = nInversion % 2;
         nDeduccionC = 0;
         nPorceDed   = 2;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nCantidad ! 0; |Y aPreg1 = "S";  |Y aEdadPer ] "1980";
         nTipo       = 919;  |HAZ LeeCasillaComunidad;
         nInversion  = nCantidad;
         nDeduccion  = nInversion % 5;
         nDeduccionC = 0;
         nPorceDed   = 5;

         |HAZ GrabaLinea;
     |FINSI;
|FPRC;

|PROCESO LaRioja;
     |HAZ LeeFamiliar;

     |SI nTotalHijos [ 1;  |ACABA;  |FINSI;

     |SI nHijosDed = nTotalHijos;
         nHijosDed = nHijosDed - 1;
     |FINSI;

     |SI nHijosDed [ 0;  |ACABA;  |FINSI;

     nTipo       = 927;  |HAZ LeeCasillaComunidad;
     nNumero     = nHijosDed;
     nInversion  = 0;
     nDeduccion  = 0;
     |SI nNumero = 1;  nDeduccion = #8#9;   |FINSI;
     |SI nNumero ] 2;
         nDeduccion = #8#9 + ((nNumero - 1) * #8#11);
     |FINSI;

     nDeduccionC = 0;
     |SI nHijosDed3 = 1;  nDeduccionC = #8#9;   |FINSI;
     |SI nHijosDed3 ] 2;
         nDeduccionC = #8#9 + ((nHijosDed3 - 1) * #8#11);
     |FINSI;

     |HAZ GrabaLinea;

     |SI nHijosDed2 ! 0;  nSwMensa = 1;  |FINSI;
|FPRC;

|PROCESO Valencia;
     aEdad = "1950";
     |HAZ LeeFamiliar;

     |SI nTotalHijos ] 2;
         nNumero     = 0;
         nTipo       = 957;  |HAZ LeeCasillaComunidad;
         nDeduccion  = 0;
         nInversion  = 0;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosEje ! 0;
         nNumero     = nHijosEje;
         nTipo       = 933;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;
         nDeduccionC = nHijosDed3 * #8#9;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijos2013 ! 0;
         nNumero     = nHijos2013;
         nTipo       = 133;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijos2014 ! 0;
         nNumero     = nHijos2014;
         nTipo       = 233;  |HAZ LeeCasillaComunidad;
         nDeduccion  = nNumero * (#8#9 * 2);
         nInversion  = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosMult ! 0;
         nNumero     = 1;
         nTipo       = 934;   |HAZ LeeCasillaComunidad;

         |SI nHijosMult ! nHijosMult1;
             nDeduccion  = #8#9;
         |SINO;
             nDeduccion  = #8#9 * 2;
         |FINSI;

         nInversion  = 0;
         nDeduccionC = 0;
         |HAZ GrabaLinea;
     |FINSI;

     |SI nHijosDedM ! 0;
         nNumero     = nHijosDedM;
         nTipo       = 935;  |HAZ LeeCasillaComunidad;
         nDeduccion  = #8#9;
         |SI nHijosDedM1 > 1;
             nDeduccion  = #8#11;
         |FINSI;
         nInversion  = 0;
         nDeduccionC = 0;

         |SI nHijosDedM2 ! 0;
             nDeduccionC = #8#9;
             |SI nHijosDedM3 ! 0;
                 nDeduccionC = nDeduccionC + ((nHijosDedM2 - 1) * #8#11);
             |FINSI;
         |FINSI;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nEdadMayor > 0; |Y nMinusD > 0;
         nTipo       = 939;  |HAZ LeeCasillaComunidad;
         nNumero     = nEdadMayor;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     nCantidad  = 0;
     nCantidad1 = 0;
     nCantidad2 = 0;
     nPorce     = 100;
     |BUCLE rem00021;
     |SI nCantidad ! 0;  |Y aEdadPer ] "1980";
         nTipo       = 942;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad;
         nDeduccion  = nInversion % 5;
         nDeduccionC = 0;
         nPorceDed   = 5;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nCantidad ! 0;  |Y nGradoMinus ] 65;
         nTipo       = 943;  |HAZ LeeCasillaComunidad;
         nNumero     = 0;
         nInversion  = nCantidad;
         nDeduccion  = nInversion % 5;
         nDeduccionC = 0;
         nPorceDed   = 5;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAbuelo75 ! 0;
         nTipo       = 940;  |HAZ LeeCasillaComunidad;
         nNumero     = nAbuelo75;
         nInversion  = 0;
         nDeduccion  = nNumero * #8#9;
         nDeduccionC = 0;

         |HAZ GrabaLinea;
     |FINSI;

     |SI nAbueloMensaje = 1;
         |MENAV "0000 Se han encontrado ascendientes entre 65 y 75 años con minusvalia entre 33% y 64%";
         |MENAV "0000 Si dicha minusvalia es psiquica, a¤adir la deduccion 924 correspondiente";
     |FINSI;
|FPRC;

|PROCESO Recogida;
     |SI nEntrar = 1;  |ACABA;  |FINSI;

     aPrestamo = "";

     #20#0 = enEmpresa;
     #20#1 = 1;
     |LEE 040#20];
     |SI FSalida = 0;  |Y #20#0 = enEmpresa;
         |MENAV "      Ya existen deducciones en esta empresa, debe estar sin deducciones.";
         |ERROR;
         |ACABA;
     |FINSI;

     nLinea = 0;

     #20#0 = enEmpresa;

     |ABRE #1;
     |LEE 040#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #8;

     nMinus33    = 0;
     nMinus65    = 0;
     aPerceptor  = "TITULAR";
     nComunidad  = #100#11;
     aEdadPer    = #100#7;
     nGradoMinus = #100#8;
     nSwMensa    = 0;
     nAndalucia  = 0;
     nPorceDed   = 0;

     |SI #100#11 = 1;   |HAZ Andalucia;         |FINSI;
     |SI #100#11 = 2;   |HAZ Aragon;            |FINSI;
     |SI #100#11 = 3;   |HAZ Asturias;          |FINSI;
     |SI #100#11 = 4;   |HAZ Baleares;          |FINSI;
     |SI #100#11 = 5;   |HAZ Canarias;          |FINSI;
     |SI #100#11 = 6;   |HAZ Cantabria;         |FINSI;
     |SI #100#11 = 7;   |HAZ CastillaMancha;    |FINSI;
     |SI #100#11 = 8;   |HAZ CastillaLeon;      |FINSI;
     |SI #100#11 = 9;   |HAZ Catalunya;         |FINSI;
     |SI #100#11 = 10;  |HAZ Extremadura;       |FINSI;
     |SI #100#11 = 11;  |HAZ Galicia;           |FINSI;
     |SI #100#11 = 12;  |HAZ Madrid;            |FINSI;
     |SI #100#11 = 13;  |HAZ Murcia;            |FINSI;
     |SI #100#11 = 16;  |HAZ LaRioja;           |FINSI;
     |SI #100#11 = 17;  |HAZ Valencia;          |FINSI;

     aPerceptor  = "CONYUGE";
     nComunidad  = #100#43;
     aEdadPer    = #100#40;
     nGradoMinus = #100#41;
     aAlfa       = #100#35;  |QBF aAlfa;
     nAndalucia  = 0;
     nPorceDed   = 0;

     |SI aAlfa ! "";
         |SI #100#43 = 1;   |HAZ Andalucia;         |FINSI;
         |SI #100#43 = 2;   |HAZ Aragon;            |FINSI;
         |SI #100#43 = 3;   |HAZ Asturias;          |FINSI;
         |SI #100#43 = 4;   |HAZ Baleares;          |FINSI;
         |SI #100#11 = 5;   |HAZ Canarias;          |FINSI;
         |SI #100#11 = 6;   |HAZ Cantabria;         |FINSI;
         |SI #100#11 = 7;   |HAZ CastillaMancha;    |FINSI;
         |SI #100#43 = 8;   |HAZ CastillaLeon;      |FINSI;
         |SI #100#43 = 9;   |HAZ Catalunya;         |FINSI;
         |SI #100#43 = 10;  |HAZ Extremadura;       |FINSI;
         |SI #100#43 = 11;  |HAZ Galicia;           |FINSI;
         |SI #100#43 = 12;  |HAZ Madrid;            |FINSI;
         |SI #100#43 = 13;  |HAZ Murcia;            |FINSI;
         |SI #100#43 = 16;  |HAZ LaRioja;           |FINSI;
         |SI #100#43 = 17;  |HAZ Valencia;          |FINSI;
     |FINSI;

     |CIERRA #8;

     |SI nSwMensa = 1;
         |MENAV "     Revise Deduccion de Hijos ya que tiene vinculaciones al Declarante o al Conyuge";
     |FINSI;

     |SI nMinus33 ] 2;  |O nMinus65 ] 1;
         aAlfa = "0000Es posible que tenga derecho a la deducci¢n por ";
         aAlfa = aAlfa + "familia numerosa (802). Revise datos personales";
         |MENAV aAlfa;
     |FINSI;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |PULSATECLA;
|FPRC;


|| ---- PROCESOS DEL REW00644

|PROCESO Tipo12Fw644;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     aAlfa = #644#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000No se puede validar la ficha, no hay contribuyente introducido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO IncrementoConjunta;
     |C_M #644#22, 1, "S";

     |SI #644#13 ! 717;  |Y #644#13 ! 719; |Y #644#13 ! 724;
      |Y #644#13 ! 736;  |Y #644#13 ! 738; |Y #644#13 ! 764;
      |Y #644#13 ! 788;  |Y #644#13 ! 817; |Y #644#13 ! 849;
      |Y #644#13 ! 863;  |Y #644#13 ! 890; |Y #644#13 ! 906;
      |Y #644#13 ! 907;  |Y #644#13 ! 927; |Y #644#13 ! 933;
      |Y #644#13 ! 133;  |Y #644#13 ! 233; |Y #644#13 ! 935;
         |C_M #644#22, 1, "N";  #644#22 = 0;
     |FINSI;

     |PINTA #644#22;
|FPRC;

|PROCESO Tipo0C18;
     |SI #644#13 = 901;
         |C_M #644#19, 1, "N";
         aAlfa = "0000Informar el importe total de la inversi¢n. ";
         aAlfa = aAlfa + "La deducci¢n se imputar  por 1/4 parte en este ejercicio";
         |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO TotalFw644;
     |SI #644#13 =  901;
         #644#19 = #644#18 % #644#20;
         |SI #644#19 > #8#7;  #644#19 = #8#7;  |FINSI;

         #644#19 = #644#19 / 4;

         |PINTA #644#19;

         |ACABA;
     |FINSI;

     nTope = #8#7;

     |SI #644#13 = 761;
                            nTope = #8#7;
         |SI #644#20 = 10;  nTope = 455;  |FINSI;
     |FINSI;

     |SI #644#13 =  817;
         |SI #644#17 > 0;   #644#19 = #8#9  / 2;  |FINSI;
         |SI #644#17 ] 2;   #644#19 = #8#13 / 2;  |FINSI;
         |SI #644#17 ] 3;   #644#19 = #8#15 / 2;  |FINSI;

         nTope = #8#15;
     |FINSI;

     |SI #644#13 =  853;
         |SI #644#20 = 30;   nTope = #8#9;   |FINSI;
         |SI #644#20 = 100;  nTope = #8#17;  |FINSI;
     |FINSI;

     |SI #644#13 = 941;  nTope = #8#7 * #644#17;  |FINSI;

     |SI #644#13 = 946;
         |SI #644#20 = 15;  nTope = #8#9;   |FINSI;
         |SI #644#20 = 20;  nTope = #8#15;  |FINSI;
         |SI #644#20 = 25;  nTope = #8#17;  |FINSI;
     |FINSI;

     |SI #644#2 = "GANANCIAL ";
         |SI #644#13 = 770;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 775;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 790;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 795;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 801;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 804;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 853;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 867;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 874;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 892;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 909;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 921;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 922;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 930;  nTope = nTope * 2;  |FINSI;
         |SI #644#13 = 949;  nTope = nTope * 2;  |FINSI;
     |FINSI;

     |SI #644#20 ! 0;
         |SI #644#13 ! 876;
             #644#19 = #644#18 % #644#20;
             |SI #8#7 ! 0;
                 |SI #644#19 > nTope;
                     #644#19 = nTope;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI #644#18 > #8#9;
                 #644#18 = #8#9;
             |FINSI;
             #644#19 = #644#18 % #644#20;
             |PINTA #644#18;
        |FINSI;
     |FINSI;

     |PINTA #644#19;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #rem00044#Campo#;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #rem00044#Campo# = eaVarDni;
         |PINTA #rem00044#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     #rew00644#34 = "S";
     eaVarDni     = #rem00044#Campo#;
     enCalcCif    = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "                    ") % 120;
     |SI #rem00044#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #rem00044#Campo# = eaVarDni;  |PINTA #rem00044#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;

         |CONFI "0000NEs un N£mero de Identificaci¢n de otro pais";
         |SI FSalida = 0;
             #rew00644#34 = "N";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja8;
     |SI FSalida = "POSICION";  |Y #20#13 ! 999;
         #8#1 = #644#13;
         |ACABA;
     |FINSI;
     #8#0 = #644#11;
     #8#1 = 0;
|FPRC;

|PROCESO Alta8;
     #8#0 = #644#11;
     #8#1 = 999;
|FPRC;

|PROCESO CamposEspeciales;
     |C_M #644#21, 1, "N";  |PINTA #644#21;
     |C_M #644#24, 1, "N";  |PINTA #644#24;
     |C_M #644#29, 1, "N";  |PINTA #644#29;
     |C_M #644#31, 1, "N";  |PINTA #644#31;
     |C_M #644#32, 1, "N";  |PINTA #644#32;
     |C_M #644#33, 1, "N";  |PINTA #644#33;

     |SI #644#11 = 1;
         |SI #644#13 = 729;  |O #644#13 = 731;
             |C_M #644#24, 1, "S";  |PINTA #644#24;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #644#11 = 5;
         |SI #644#13 = 795;
             |C_M #644#21, 1, "S";  |PINTA #644#21;
             |C_M #644#31, 1, "S";  |PINTA #644#31;
             |C_M #644#32, 1, "S";  |PINTA #644#32;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #644#11 = 8;
         |SI #644#13 = 842;
             |C_M #644#33, 1, "S";  |PINTA #644#33;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #644#11 = 11;
         |SI #644#13 = 903;
             |C_M #644#31, 1, "S";  |PINTA #644#31;

             |ACABA;
         |FINSI;
     |FINSI;

     |SI #644#11 = 16;
         |SI #644#13 = 930;
             |C_M #644#29, 1, "S";  |PINTA #644#29;

             |ACABA;
         |FINSI;
     |FINSI;

     |C_M #644#21, 1, "S";   |PINTA #644#21;
|FPRC;

|PROCESO Consulta;
     |SI #644#3 = "X";  |ACABA;  |FINSI;

     |SI FSalida = 10;
         |PUSHV 0501 2599;
         |PINPA #0#7;
         |PINDA #0#7;
         |ENTLINEAL #1#8, 2, 4, 25, 0, Baja8, Alta8;
         #644#13 = #8#1;
         |POPV;
     |FINSI;

     |ABRE #8;
     #8#0 = #644#11;
     #8#1 = #644#13;
     |LEE 040#8=;
     |SI FSalida ! 0;
         |MENAV "    No existe Deduccion.";
         |CIERRA #8;
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #8;

     |SI #644#13 = 942;
         |SI #644#2 = "TITULAR   ";
             |SI aEdadTit < "1980";
                 |MENAV "0000 El Titular tiene mas de 35 a¤os";
                 |ERROR;
             |FINSI;
         |FINSI;

         |SI #644#2 = "CONYUGE   ";
             |SI aEdadCon < "1980";
                 |MENAV "0000 El Conyuge tiene mas de 35 a¤os";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #644#2 = "GANANCIAL ";
             |SI aEdadTit < "1980";  |O aEdadCon < "1980";
                 |MENAV "0000 Uno de los contribuyentes tienen mas de 35 a¤os, introduzcalas individuales";
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #644#13 = 778;
         |SI #644#2 = "GANANCIAL ";  |O #644#2 = "VARIOS    ";
             |MENAV "0000 Este tipo de perceptor no es v lido para esta casilla";
             |ERROR;
             |ACABA;
         |FINSI;

         |SI #rew99999#5 = "N";
             |MENAV "0000 El perceptor debe haber fallecido";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |C_M #644#17, 1, "S";
     |C_M #644#18, 1, "S";
     |C_M #644#19, 1, "S";
     |C_M #644#20, 1, "S";
     |C_M #644#21, 1, "S";

     |SI #8#5 = "S";
         |C_M #644#18, 1, "N";   #644#18 = 0;
         |C_M #644#20, 1, "N";   #644#20 = 0;
     |FINSI;

     |SI #644#13 ! 848;  |Y #644#13 ! 855;
         |SI #8#5 = "N";
             |C_M #644#17, 1, "N";   #644#17 = 0;
             |C_M #644#18, 1, "N";   #644#18 = 0;
             |C_M #644#20, 1, "N";   #644#20 = 0;
         |FINSI;

         |SI #8#5 = "I";
             |C_M #644#17, 1, "N";   #644#17 = 0;

             |SI #644#20 = 0;
                 #644#20 = #8#6;
             |FINSI;

             |SI #644#20 = 0;
                 |C_M #644#20, 1, "N";  #644#20 = 0;
                 |C_M #644#19, 1, "N";  #644#19 = 0;
             |FINSI;
         |FINSI;
     |SINO;
         |SI #644#13 = 848;  |O #644#13 = 855;
             |C_M #644#17, 1, "N";
             |C_M #644#18, 1, "N";
             |C_M #644#20, 1, "N";   #644#20 = 0;
         |FINSI;

         #644#20 = #8#6;
     |FINSI;

     |HAZ CamposEspeciales;

     |SI #644#13 ! 721;  |Y #644#13 ! 746;  |Y #644#13 ! 761;
      |Y #644#13 ! 795;  |Y #644#13 ! 804;  |Y #644#13 ! 809;
      |Y #644#13 ! 829;  |Y #644#13 ! 129;  |Y #644#13 ! 838;
      |Y #644#13 ! 853;  |Y #644#13 ! 857;  |Y #644#13 ! 867;
      |Y #644#13 ! 886;  |Y #644#13 ! 896;  |Y #644#13 ! 911;
      |Y #644#13 ! 946;  |Y #644#13 ! 949;  |Y #644#13 ! 961;
      |Y #644#13 ! 161;  |Y #644#13 ! 196;
         |C_M #644#21, 1, "N";  #644#21 = "";
     |FINSI;

     #644#14 = #8#2;
     #644#15 = #8#3;
     #644#16 = #8#4;

     |PINTA #644#13;
     |PINTA #644#14;
     |PINTA #644#15;
     |PINTA #644#16;
     |PINTA #644#17;
     |PINTA #644#18;
     |PINTA #644#19;
     |PINTA #644#20;
     |PINTA #644#21;
     |PINTA #644#24;
     |PINTA #644#29;
     |PINTA #644#31;
     |PINTA #644#32;
     |PINTA #644#33;
|FPRC;

|PROCESO Tipo7C19;  |TIPO 7;
     |SI #644#13 ! 957;  |ACABA;  |FINSI;

     |MENSA "0000Deduccion manual: Importe en Cantidad deduccion y Chequear importe igual N";
|FPRC;

|PROCESO Tipo0C19;
     |SI #644#13 = 795;  |O #644#13 = 812; |O #644#13 = 877;
      |O #644#13 = 881;  |O #644#13 = 892;
         |SI #8#7 ! 0;
             |SI #644#19 > nTope;
                 #644#19 = nTope;   |PINTA #644#19;
             |FINSI;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw644;
     |C_M #644#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #20#0 = #644#0;
     #20#1 = #644#1;
     |LEE 000#20=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO CargaFantasma;
     |C_M #644#13, 1, "S";
     |C_M #644#17, 1, "S";
     |C_M #644#18, 1, "S";
     |C_M #644#19, 1, "S";
     |C_M #644#20, 1, "S";
     |C_M #644#21, 1, "S";
     |C_M #644#22, 1, "S";
     |C_M #644#23, 1, "S";

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #644nCampo = #20nCampo;

           |C_V #644nCampo, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #644nCampo;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO DescargaFantasma;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           |SI enSwLiquida = 1;
               |SI #20nCampo = #644nCampo;
                   enSwRetorno = 1;
               |FINSI;
           |FINSI;

           #20nCampo = #644nCampo;
     |SIGUE;

                        #20#30 = "";
     |SI #20#3  = "X";  #20#30 = eaRojo;  |FINSI;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO MiraRegistros;
     |DBASE aPathRenta;  |QBT aPathRenta;
     aDef = aPathRenta + "def/rem00044.mas";
     |CARGA_DEF aDef, espejo@;

     |ESTADO_CONTROL nBotonReco, "ENABLE";

     |ABRE #espejo@;
     #espejo@#0 = enEmpresa;
     #espejo@#1 = 1;
     |LEE 040#espejo@.];
     |SI FSalida = 0;  |Y #espejo@#0 = enEmpresa;
         |ESTADO_CONTROL nBotonReco, "DISABLE";
     |FINSI;
     |CIERRA #espejo@;

     |DESCARGA_DEF #espejo@;
|FPRC;

|PROCESO Alta;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     |PULSATECLA;

     #20#0 = enEmpresa;
     #20#1 = 99;
     |LEE 000#20];
     |SI FSalida = 0;
         |LEE 000#20a;
     |SINO;
         |LEE 000#20u;
     |FINSI;

     |DDEFECTO #644;
     #644#0 = enEmpresa;
     #644#1 = 1;
     |SI FSalida = 0;  |Y  #20#0 = enEmpresa;
         #644#1 = #20#1 + 1;
     |FINSI;

     |DDEFECTO #20;

     #20#0 = #644#0;
     #20#1 = #644#1;

     enModoReg = 1;
     |HAZ CargaFantasma;

     |C_M #644#1, 1, "S";
     |ENDATOS #1#644;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#20n;
         |LIBERA #20;
     |FINSI;

     |SI enModo ! 4;
         |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |FINSI;

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |LEE 101#20=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonAlta,  "DISABLE";
     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     enModoReg = 2;
     |C_M #644#1, 1, "N";

     |HAZ CargaFantasma;
     |ENDATOS #2#644;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#20a;
     |FINSI;
     |LIBERA #20;

     |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |ESTADO_CONTROL nBotonModi, "ENABLE";
     |ESTADO_CONTROL nBotonBaja, "ENABLE";

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#20=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#20a;
     |LIBERA #20;

     nEntrar     = 0;
     enSwRetorno = 1;

     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |HAZ MiraRegistros;
|FPRC;

|PROCESO BotonCntr;
     enComunes   = 1;
     enChequeo   = 0;

     #rew00003#0 = #644#2;
     #rew00003#1 = #644#3;
     #rew00003#2 = #644#4;
     #rew00003#3 = #644#5;
     #rew00003#4 = #644#6;
     #rew00003#5 = #644#7;
     #rew00003#6 = #644#8;
     #rew00003#7 = #644#9;
     #rew00003#8 = #644#10;

     |HAZ PantaREW00003;

     #644#2  = #rew00003#0;    |PINTA #644#2;
     #644#3  = #rew00003#1;
     #644#4  = #rew00003#2;
     #644#5  = #rew00003#3;
     #644#6  = #rew00003#4;
     #644#7  = #rew00003#5;
     #644#8  = #rew00003#6;
     #644#9  = #rew00003#7;
     #644#10 = #rew00003#8;

     aAlfa = "|C013WID";
     aID   = #644aAlfa;
     nID   = aID;
     |FOCOTECLADO nID;

     |SI #644#3 = "X";  |Y enModoReg ! 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Tipo0C2Fw644;  |TIPO 0;
     eaDeclarante = #644#2;
     enComunes    = 1;

     enSwPresenta = 1;
     |HAZ SacaDeclarantes;
     enSwPresenta = 0;

     #644#2  = eaDeclarante;
     #644#11 = enAutonomia;
     |PINTA #644#2;

     |ABRE #8;
     #8#0 = #644#11;
     #8#1 = 1;
     |LEE 040#8];
     |SI FSalida ! 0;
         |CIERRA #8;
         |MENAV "     No existe Autonomia en el Declarante.";
         |PTEC 807;
         |ACABA;
     |FINSI;
     |SI #8#1 = 99;
         |CIERRA #8;
         |MENAV "     No hay deducciones Autonomicas en la Comunidad";
         |PTEC 807;
         |ACABA;
     |FINSI;
     |CIERRA #8;

     |ABRE #7;
     #7#0 = #644#11;
     |LEE 040#7=;
     |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
     |CIERRA #7;

     #644#12 = #7#1;

     |PINTA #644#11;
     |PINTA #644#12;
|FPRC;

|PROCESO Tipo7C2Fw644;  |TIPO 7;
     aAlfa = #644#2;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y #644#3 ! "X";
         |ACABA;
     |FINSI;

     |HAZ BotonCntr;
|FPRC;


|PROCESO PintaDatosPantalla;
     |DDEFECTO #644;

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #644nCampo = #20nCampo;

           |C_V #644nCampo, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #644nCampo;  |FINSI;

           |C_M #644nCampo, 1, "N";
     |SIGUE;

     |SI enModo = 4;  |ACABA;  |FINSI;

     |HAZ MiraRegistros;

|FPRC;

|PROCESO Evento20;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#20=;

         |ESTADO_CONTROL nBotonReco, "DISABLE";

         |SI enModo = 4;
             |ESTADO_CONTROL nBotonAlta, "DISABLE";
             |ESTADO_CONTROL nBotonModi, "DISABLE";
             |ESTADO_CONTROL nBotonBaja, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonModi, "ENABLE";
             |ESTADO_CONTROL nBotonBaja, "ENABLE";
         |FINSI;

         |PULSATECLA;

         nEntrar   = 1;
         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta;
     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}&Alta ", 2164, 2174, Alta;
     nBotonAlta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Modificar ", 2176, 2186, Modificar;
     nBotonModi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}&Borrar", 2188, 2198, Baja;
     nBotonBaja = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Recogida autom tica", 2102, 2120, Recogida;
     nBotonReco = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Y", 2422, 2423, BotonCntr;
     nBotonCntr = FSalida;

     nEntrar = 0;

     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonReco, "DISABLE";
         |ESTADO_CONTROL nBotonAlta, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Baja20;
     #20#0 = enEmpresa;
     #20#1 = 1;
|FPRC;

|PROCESO Alta20;
     #20#0 = enEmpresa;
     #20#1 = 99;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     aEdadTit = #100#7;
     aEdadCon = #100#40;

     enSwRetorno = 0;
     aQueQuiero  = "|NC";
     aNumCampos  = #20#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;
     enModoReg   = 4;

     |PINPA #0#644;  nPanta = FSalida;

     |HAZ BotonesPanta;

     enSwPresenta = 1;
     |HAZ SacaDeclarantes;
     enSwPresenta = 0;

     |DDEFECTO #20;
     |HAZ PintaDatosPantalla;

     |ABRET #20;

     |LINEAL_SIMPLE #1#20, nRango, 0602, 2098, Baja20, Alta20, Evento20;
     nGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;

          |SI aTecla = aRetu;
              |HAZ Modificar;
          |FINSI;
     |SIGUE;

     |CIERRAT #20;

     eaPrograma   = "rem00044";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
