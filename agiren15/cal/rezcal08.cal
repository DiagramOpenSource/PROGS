|FICHEROS;
     rew99999;

     datfic1@ #1;
     datfic2@;
     datfic3@;
     datfic4@;
     datfic5@;

     rem00008;
     rem01043;

    &refere1@;
    &refere2@;
    &refere3@;
|FIN;

|VARIABLES;
     nMinus65  = 0;
     nValorCas = 0;
     nPaso     = 0;
     n807      = 0;
     n846      = 0;
     n847      = 0;
     n861      = 0;
     n965      = 0;
     n966      = 0;
     n967      = 0;
     nAcumVal  = 0;
     nNumero   = 0;
|FIN;

|INCLUYE i_varcal;

|PROCESO LeeValorCasilla;
     |SI enNomeDat = 1;  |NOME_DAT #rem01043#"zdat1043"#;  |FINSI;

     |ABRE #rem01043;
     #rem01043#0 = #refere1@#0;
     #rem01043#1 = #refere1@#1;
     #rem01043#2 = #refere1@#2;
     #rem01043#3 = nComunidad;
     #rem01043#4 = nCasilla;
     |LEE 000#rem01043.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01043;  |FINSI;
     |CIERRA #rem01043;

     nValorCas = #rem01043#6;
|FPRC;

|PROCESO LeeRentas;
     |ABRE #datfic3@;
     nSuma = 0;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "TITULAR";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = #datfic3@#44 + #datfic3@#50;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "CONYUGE";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = nSuma + #datfic3@#44 + #datfic3@#50;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "1 FAMILIAR";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = nSuma + #datfic3@#44 + #datfic3@#50;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "2 FAMILIAR";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = nSuma + #datfic3@#44 + #datfic3@#50;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "3 FAMILIAR";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = nSuma + #datfic3@#44 + #datfic3@#50;

     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = "4 FAMILIAR";
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     nSuma = nSuma + #datfic3@#44 + #datfic3@#50;

     |CIERRA #datfic3@;
|FPRC;

|PROCESO TotDedAutonomica;
     nValor    = 0;
     enBloque  = 41;
     eaCasilla = "491"; |HAZ SacaImporte; nValor = enImporte;
     eaCasilla = "493"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "496"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "498"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "500"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "502"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "504"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "506"; |HAZ SacaImporte; nValor = nValor - enImporte;
     eaCasilla = "508"; |HAZ SacaImporte; nValor = nValor - enImporte;
|FPRC;

|PROCESO Andalucia;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 719;
         |SI #datfic1@#13 = 3;
             nSuma = #datfic3@#44 + #datfic3@#50;
             |SI enConta [ 6;
                 |SI nSuma > #rem00008#9;  #datfic1@#13 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #rem00008#11; #datfic1@#13 = 0;  |FINSI;
             |FINSI;
         |FINSI;

         nValor = (#rem00008#13 % #datfic1@#13) ! 2;
         #datfic1@#6   = (N\ #datfic1@#12 % #datfic1@#13);
         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 721;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;

             |SI #rew99999#6 < 1977;    #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;

             |SI enEdadTit < 1977;  |Y enEdadCon < 1977;
                 #datfic1@#6 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 724;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 725;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 726;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 727;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 729;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 731;
         |SI #datfic1@#6 > 250;
            #datfic1@#6 = 250;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 734;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 732;
         |SI #datfic1@#6 > #rem00008#7;
             #datfic1@#6 = #rem00008#7;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Aragon;
     |HAZ LeeRentas;

     |SI #rem00008#1 = 736;  |O #rem00008#1 = 739;
         |SI #rem00008#1 = 736;
             |SI enConta [ 6;
                 |SI nSuma < #rem00008#13;
                     #datfic1@#6 = #datfic1@#12 * #rem00008#11;
                 |FINSI;
             |SINO;
                 |SI nSuma < #rem00008#15;
                     #datfic1@#6 = #datfic1@#12 * #rem00008#11;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #rem00008#1 = 739;
             |SI enConta [ 6;
                |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
             |SINO;
                |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 740;
         enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;
         nValor   = enImporte % 10;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 744;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;

         |SI enConta [ 6;
             |SI #rew99999#6 < 1977;    #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI enEdadTit < 1977;  |Y enEdadCon < 1977;
                 #datfic1@#6 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 746;
         |ABRE #datfic3@;
         #datfic3@#0 = #refere1@#0;
         #datfic3@#1 = #refere1@#1;
         #datfic3@#2 = #refere1@#2;
         |LEE 040#datfic3@.=;
         |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
         |CIERRA #datfic3@;

         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 749;
         nValor1  = #datfic1@#12;

         enBloque = 36; eaCasilla = "440"; |HAZ SacaImporte;
         nValor2  = enImporte;

         enBloque = 41; eaCasilla = "477"; |HAZ SacaImporte;
         nValor3  = enImporte;

         nValor   = ((nValor1 / nValor2) * nValor3) * 0.30;

         |SI nValor < 0; nValor = 0;  |FINSI;

         #datfic1@#6  = nValor;

         nValor   = ((nValor1 / nValor2) * nValor3);
         #datfic1@#12 = nValor3;
     |FINSI;

     |SI #rem00008#1 = 750;
         nValor = 0;
         enBloque  = 27;  eaCasilla = "380";  |HAZ SacaImporte; nValor = enImporte;
         enBloque  = 28;  eaCasilla = "395";  |HAZ SacaImporte; nValor = nValor + enImporte;

         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 751;
         nValor = 0;
         enBloque  = 27;  eaCasilla = "380";  |HAZ SacaImporte; nValor = enImporte;
         enBloque  = 28;  eaCasilla = "395";  |HAZ SacaImporte; nValor = nValor + enImporte;

         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 753;
         nValor = 0;
         enBloque  = 27;  eaCasilla = "380";  |HAZ SacaImporte; nValor = enImporte;
         enBloque  = 28;  eaCasilla = "395";  |HAZ SacaImporte; nValor = nValor + enImporte;

         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;

         enBloque  = 37;  eaCasilla = "445";  |HAZ SacaImporte; nValor = enImporte;
         |SI nValor > #rem00008#13;   #datfic1@#6 = 0;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Asturias;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 756;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 757;
         nValor = (#rem00008#9 % 3) ! 2;
         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 758;
         nValor = (#rem00008#9 % 3) ! 2;
         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 759;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#9;  #datfic1@#6 = #rem00008#9;  |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#11; #datfic1@#6 = #rem00008#11; |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 761;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             nValor = #rem00008#11;
             |SI nSuma > nValor;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 763;
         nSuma = #datfic3@#77 % 10;
         |SI #datfic1@#6 > nSuma;  #datfic1@#6 = nSuma;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 764;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#11;  #datfic1@#6 = #rem00008#11;  |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#13;  #datfic1@#6 = #rem00008#13;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 765;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#11;  #datfic1@#6 = #rem00008#11;  |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#13;  #datfic1@#6 = #rem00008#13;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 766;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#13; #datfic1@#6 = #rem00008#13; |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#15; #datfic1@#6 = #rem00008#15; |FINSI;
         |FINSI;

         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 767;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#13; #datfic1@#6 = #rem00008#13; |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#15; #datfic1@#6 = #rem00008#15; |FINSI;
         |FINSI;

         nSuma = #datfic3@#44 + #datfic3@#72;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 768;
         |SI enConta [ 6;
             |SI #datfic1@#6 > #rem00008#9;  #datfic1@#6 = #rem00008#9;  |FINSI;
         |SINO;
             |SI #datfic1@#6 > #rem00008#11; #datfic1@#6 = #rem00008#11; |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 770;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             nValor = #rem00008#11;
             |SI nSuma > nValor;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 771;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             nValor = #rem00008#11;
             |SI nSuma > nValor;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baleares;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 773;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             nValor = #rem00008#11;
             |SI nSuma > nValor;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 774;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 775;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 776;
         enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;

         nValor   = enImporte % 15;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 968;
         enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;
         nValor   = enImporte % 10;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 777;
         nSuma = #datfic3@#44 + #datfic3@#50;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 778;
         nSuma = #datfic3@#44 + #datfic3@#50;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 780;
         nSuma = #datfic3@#44 + #datfic3@#50;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 969;
         nSuma = #datfic3@#44 + #datfic3@#50;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Canarias;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte; nCuotaIntegra = nCuotaIntegra + enImporte;

     nValor2   = enImporte % 10;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     |SI #rem00008#1 = 801;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 782;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 783;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 784;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 785;
         nValor2   = enImporte % 40;
         |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;

         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 786;
         nValor1  = 0;
         enBloque = 1;  eaCasilla = "019"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
         enBloque = 5;  eaCasilla = "125"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
         enBloque = 6;  eaCasilla = "150"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
         enBloque = 7;  eaCasilla = "180"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;

         enBloque = 36; eaCasilla = "440"; |HAZ SacaImporte; nValor2 = enImporte;
         enBloque = 41; eaCasilla = "491"; |HAZ SacaImporte; nValor3 = enImporte;

         nValor   = (nValor3 * nValor1) / nValor2;

         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 788;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#17;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#19;   #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 789;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#13;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 790;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 791;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 795;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;

             nValor = #rem00008#7 / 2;
             |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;

             |SI #datfic1@#6 > #rem00008#7;
                 #datfic1@#6 = #rem00008#7;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO rew99999_714;
     |SI #rew99999#3 < 65;  |ACABA;  |FINSI;

     |SI enConta [ 6;
         |SI #rew99999#1 = #refere1@#2;
             nMinus65 = 1;
         |FINSI;
     |SINO;
         nMinus65 = nMinus65 + 1;
     |FINSI;
|FPRC;

|DEFBUCLE rew99999_714;
     #rew99999#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, rew99999_714;
|FIN;

|PROCESO Cantabria;
     |SI #rem00008#1 = 814;
         |SI #datfic1@#5 = "S";
             |SI #datfic1@#12 ! 0;
                 #rem00008#0 = nComunidad;
                 #rem00008#1 = 114;
                 |LEE 000#rem00008.=;
                 |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

                 |SI enConta [ 6;
                     nLimite = #rem00008#9;
                 |SINO;
                     nLimite = #rem00008#11;
                 |FINSI;

                 |SI #rew99999#3 ] 65;
                     nLimite = nLimite + #rem00008#13;
                 |FINSI;

                 |SI #datfic1@#12 > nLimite;
                     #datfic1@#12 = nLimite;
                 |FINSI;
             |FINSI;

             |SI #datfic1@#6 > 0;
                 #rem00008#0 = nComunidad;
                 #rem00008#1 = 814;
                 |LEE 000#rem00008.=;
                 |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

                 |SI enConta [ 6;
                     nLimite = #rem00008#9;
                 |SINO;
                     nLimite = #rem00008#11;
                 |FINSI;

                 |SI #rew99999#3 ] 65;
                     nLimite = nLimite + #rem00008#13;
                 |FINSI;

                 |SI #datfic1@#6 > nLimite;
                     #datfic1@#6 = nLimite;
                 |FINSI;
             |FINSI;
         |FINSI;

         #datfic1@#6  = #datfic1@#6 + #datfic1@#12;
         #datfic1@#12 = 0;
     |FINSI;

     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 804;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 807;
         #rem00008#0 = nComunidad;
         #rem00008#1 = 809;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

         nMinus65 = 0;
         |BUCLE rew99999_714;

         |SI enConta [ 6;
             nLimite = #rem00008#9;
         |SINO;
             nLimite = #rem00008#11;
         |FINSI;

         nLimite = nLimite + (#rem00008#13 * nMinus65);
         #datfic1@#12 = 0;

         |SI #datfic1@#6 > nLimite;
             #datfic1@#12 = #datfic1@#6 - nLimite;
             #datfic1@#6  = nLimite;

         |FINSI;

         n807 = #datfic1@#6;

         #rem00008#0 = nComunidad;
         #rem00008#1 = 807;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 809;
         nMinus65 = 0;
         |BUCLE rew99999_714;

         |SI enConta [ 6;
             nLimite = #rem00008#9;
         |SINO;
             nLimite = #rem00008#11;
         |FINSI;

         nLimite = nLimite + (#rem00008#13 * nMinus65);
         nTope   = nLimite - n807;
         #datfic1@#12 = 0;

         |SI #datfic1@#6 > nTope;
             #datfic1@#12 = #datfic1@#6 - nTope;
             #datfic1@#6  = nTope;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 811;
         nValor1  = #datfic1@#12 + nCasiB;
         enBloque = 36; eaCasilla = "440"; |HAZ SacaImporte;
         nValor2  = enImporte % 10;
         |SI nValor1 > nValor2;
             |SI nCasiB = 0;
                 #datfic1@#12 = nValor2;
             |SINO;
                 #datfic1@#12 = nValor2 - nCasiB;
             |FINSI;

             #datfic1@#6 = #datfic1@#12 % 15;

             |SI #datfic1@#6 < 0;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CastillaMancha;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 816;
         nValor   = 0;
         |HAZ TotDedAutonomica;

         #datfic1@#12 = #datfic1@#6;
         #datfic1@#6  = 0;

         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI nValor > 500;  nValor = 500;  |FINSI;
         |SI #datfic1@#12  > 500;  #datfic1@#12  = 500;  |FINSI;

         |SI #datfic1@#12 ! 0;
             |SI #datfic1@#12 [ nValor;
                 #datfic1@#6 = #datfic1@#12;
             |SINO;
                 #datfic1@#6 = nValor;
             |FINSI;
         |FINSI;

         nValor = #datfic1@#12 - #datfic1@#6;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         #datfic1@#13 = nValor;
     |FINSI;

     nValor= #datfic3@#44 + #datfic3@#50;

     |SI #rem00008#1 = 826;
         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 827;
         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 817;
         |SI enConta [ 6;
             |SI nValor > #rem00008#17;   #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 818;
         |SI enConta [ 6;
             |SI nValor > #rem00008#13;   #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 819;
         |SI enConta [ 6;
             |SI nValor > #rem00008#13;  #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 820;
         nCasilla = 818;  |HAZ LeeValorCasilla;
         |SI nValorCas ! 0;  #datfic1@#6 = 0;  |FINSI;

         |SI enConta [ 6;
             |SI nValor > #rem00008#13;  #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 821;
         nCasilla = 819;  |HAZ LeeValorCasilla;
         |SI nValorCas ! 0;  #datfic1@#6 = 0;  |FINSI;

         |SI enConta [ 6;
             |SI nValor > #rem00008#13;  #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 822;
         nValor  = ((#datfic3@#77 + #datfic3@#81) * 0.10) * 0.15;

         |SI #datfic1@#6 > nValor;
             #datfic1@#6 = nValor;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 823;
         |SI enConta [ 6;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;   |FINSI;
         |SINO;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 824;
         enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;
         nValor  = enImporte % 10;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI #datfic1@#6  > nValor;   #datfic1@#6 = nValor;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 829;
         |SI #datfic1@#12 ! 0;
             #rem00008#0 = nComunidad;
             #rem00008#1 = 129;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

             |SI enConta [ 6;
                 |SI nValor > #rem00008#9;   #datfic1@#12 = 0;  |FINSI;
             |SINO;
                  |SI nValor > #rem00008#11; #datfic1@#12 = 0;  |FINSI;
             |FINSI;
         |FINSI;

         |SI #datfic1@#6 ! 0;
             #rem00008#0 = nComunidad;
             #rem00008#1 = 829;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

             |SI enConta [ 6;
                 |SI nValor > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
             |SINO;
                  |SI nValor > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
             |FINSI;
         |FINSI;

         #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
         #datfic1@#12 = 0;

         #rem00008#0 = nComunidad;
         #rem00008#1 = 829;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO CastillaLeon;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 832;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 833;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 834;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#19;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 836;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#17;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 838;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;    #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;   #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 840;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 848;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#17;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 849;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#17;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 850;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 851;
         nSuma       = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         #datfic1@#6 = #rem00008#13;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;    #datfic1@#6 = #rem00008#15;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;   #datfic1@#6 = #rem00008#15;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 853;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 854;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 855;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 857;
         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Catalunya;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 867;
          nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;

          |SI enConta [ 6;
              |SI #datfic1@#6 > #rem00008#7;    #datfic1@#6 = #rem00008#7;   |FINSI;

              |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
          |SINO;
              |SI #datfic1@#6 > #rem00008#9;    #datfic1@#6 = #rem00008#9;   |FINSI;

              |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;
     nValor2  = enImporte % 10;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     |SI #rem00008#1 = 864;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 865;
         |SI #datfic1@#6 > nValor2;  #datfic1@#6 = nValor2;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 873;
         #datfic1@#6  = #datfic1@#6 + #datfic1@#12;
         #datfic1@#12 = 0;
     |FINSI;
|FPRC;

|PROCESO Extremadura;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 876;
         #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
         #datfic1@#12 = 0;

         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 877;
         enBloque = 1;   eaCasilla = "010";  |HAZ SacaImporte;  nValor1  = enImporte;

         nValor = 0;
         enBloque = 2;  eaCasilla = "035"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 3;  eaCasilla = "045"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 4;  eaCasilla = "070"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 4;  eaCasilla = "071"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 6;  eaCasilla = "150"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 7;  eaCasilla = "180"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 9;  eaCasilla = "235"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 10; eaCasilla = "240"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 11; eaCasilla = "244"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 12; eaCasilla = "250"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 24; eaCasilla = "366"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 24; eaCasilla = "367"; |HAZ SacaImporte; nValor = nValor - enImporte;
         enBloque = 25; eaCasilla = "370"; |HAZ SacaImporte; nValor = nValor + enImporte;
         enBloque = 25; eaCasilla = "371"; |HAZ SacaImporte; nValor = nValor - enImporte;

         |SI nValor1 > #rem00008#9;  |O nValor > #rem00008#11;
             #datfic1@#6 = 0;
         |FINSI;

         |SI #datfic1@#6 ! 0;
             nDedTrab = 1;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 878;
         #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
         #datfic1@#12 = 0;

         nSuma = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 880;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;   #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 881;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;   #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 883;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 884;
         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;

         |SI nDedTrab = 1;
             #datfic1@#6 = 0;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 886;
         #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
         #datfic1@#12 = 0;

         nSuma = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Galicia;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 890;
         nValor = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;

         |SI nValor > 31000;
             #datfic1@#12 = 0;
             #datfic1@#13 = 0;
         |FINSI;

         #datfic1@#6 = #datfic1@#12 + #datfic1@#13 + #datfic1@#14;
     |FINSI;

     |SI #rem00008#1 = 892;
         nValor = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;

         |SI enHijos [ 1; nLimite = #rem00008#13;  |FINSI;
         |SI enHijos > 1; nLimite = #rem00008#15;  |FINSI;

         |SI enConta [ 6;
             |SI nValor > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11; #datfic1@#6 = 0;  |FINSI;

             nLimite = nLimite * 2;
         |FINSI;

         |SI #datfic1@#6 > nLimite;  #datfic1@#6 = nLimite;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 893;
         nValor = #datfic3@#44 + #datfic3@#50 - #datfic3@#107;
         |SI enConta [ 6;
             |SI nValor > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 896;
         #rem00008#0 = nComunidad;
         #rem00008#1 = 196;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

         |SI #datfic1@#12 > #rem00008#7;
             #datfic1@#12 = #rem00008#7;
         |FINSI;

         #rem00008#0 = nComunidad;
         #rem00008#1 = 896;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

         |SI #datfic1@#6 > #rem00008#7;
             #datfic1@#6 = #rem00008#7;
         |FINSI;

         #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
         #datfic1@#12 = 0;

         nValor = #datfic3@#44 + #datfic3@#50;
         |SI nValor > #rem00008#9;
             #datfic1@#6 = 0;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 902;
         enBloque = 41;  eaCasilla = "491"; |HAZ SacaImporte;
         nValor   = enImporte % 10;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Madrid;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     nSuma = #datfic3@#44 + #datfic3@#50;

     |SI #rem00008#1 = 906;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#15;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#17;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 908;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 909;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11; #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 911;
         |SI #datfic1@#6 > #rem00008#9;   #datfic1@#6 = #rem00008#9;  |FINSI;

         |SI enConta [ 6;
             |SI nSuma > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nSuma > #rem00008#13;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     nSuma = 0;

     |SI #rem00008#1 = 914;
         |HAZ LeeRentas;
         |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
     |FINSI;

     |SI #rem00008#1 = 913;
         |HAZ LeeRentas;

         nValor = 30000 * enNumFamilia;

         |SI nSuma > nValor;   #datfic1@#6 = 0;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Murcia;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |ABRE #rew99999;
     |SELECT #2#rew99999;
     #rew99999#1 = #refere1@#2;
     |LEE 040#rew99999.=;
     |SI FSalida  ! 0;  |DDEFECTO #rew99999;  |FINSI;
     |CIERRA #rew99999;

     nBase    = 0;

     |SI #rem00008#1 = 919;
         nValor1 = #datfic3@#44 + #datfic3@#50;
         nValor2 = #datfic3@#50;
         nBase   = #datfic1@#6 * 50;
         |SI nBaseViv < #rem00008#13;
             nLimite = #rem00008#13 - nBaseViv;
             |SI nLimite < 0;  nLimite = 0;  |FINSI;

             |SI nBase > nLimite;
                 nBase = nLimite;
             |FINSI;

             nPorceBase = 5;
             |SI nValor1 < #rem00008#9;  |Y nValor2 [ #rem00008#11;
                 #datfic1@#6 = nBase % 5;
                 nPorceBase = 5;
             |SINO;
                 #datfic1@#6 = 0;
             |FINSI;
         |SINO;
             #datfic1@#6 = 0;
         |FINSI;

         |SI #datfic1@#6 > #rem00008#15;  #datfic1@#6 = #rem00008#15;  |FINSI;

         |SI #datfic1@#12 ! 0;
             #rem00008#0 = nComunidad;
             #rem00008#1 = 129;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

             nValor1 = #datfic3@#44 - #datfic3@#107;
             nValor2 = #datfic3@#50;
             nBase   = #datfic1@#12 * 50;
             |SI nBaseViv < #rem00008#9;
                 nLimite = #rem00008#9 - nBaseViv;
                 |SI nLimite < 0;  nLimite = 0;  |FINSI;

                 |SI nBase > nLimite;
                      nBase = nLimite;
                 |FINSI;

                 nPorceBase = 2;
                 |SI nValor1 < #rem00008#11;  |Y nValor2 [ #rem00008#13;
                     #datfic1@#12 = nBase % 3;
                     nPorceBase = 3;
                 |SINO;
                     #datfic1@#12 = nBase % 2;
                 |FINSI;
             |SINO;
                 #datfic1@#12 = 0;
             |FINSI;

             #datfic1@#6  = (N\ #datfic1@#6 + #datfic1@#12);
             #datfic1@#12 = 0;

             #rem00008#0 = nComunidad;
             #rem00008#1 = 919;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 920;
         nValor1  = ((#datfic3@#77 + #datfic3@#81) % 15) ! 2;
         nValor2  = (((#datfic2@#37  * 100) / 30)) ! 2;
         nValor3  = (((#datfic1@#6 * 100) / 30)) ! 2;
         nValor   = nValor1 - nValor2;
         |SI nValor < nValor3;
             #datfic1@#6 = nValor % 30;
             |SI #datfic1@#6 < 0;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 921;
         nValor1 = #datfic3@#44 - #datfic3@#107;

         |SI enConta [ 6;
             |SI #datfic1@#6    > #rem00008#9;    #datfic1@#6 = #rem00008#9;    |FINSI;
             |SI nValor1 > #rem00008#13;   #datfic1@#6 = 0;         |FINSI;
         |SINO;
             |SI #datfic1@#6    > #rem00008#11;   #datfic1@#6 = #rem00008#11;   |FINSI;
             |SI nValor1 > #rem00008#15;   #datfic1@#6 = 0;         |FINSI;

             |SI #datfic3@#50   > #rem00008#17;   #datfic1@#6 = 0;         |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 922;
         |SI #datfic1@#6 > #rem00008#7;  #datfic1@#6 = #rem00008#7;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO LaRioja;
     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 928;
         nValor = #datfic3@#44 + #datfic3@#50;
         |SI enConta [ 6;
             |SI nValor > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;
         |SINO;
             |SI nValor > #rem00008#11;  #datfic1@#6 = 0;  |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Valencia;
     |SI #rem00008#1 = 933;
         nValor = #datfic1@#6 + #datfic1@#12 + #datfic1@#13;
         #datfic1@#6   = nValor;
         #datfic1@#12  = 0;
         #datfic1@#13  = 0;
     |FINSI;

     |SI #datfic1@#5 ! "S";  |ACABA;  |FINSI;

     |SI #rem00008#1 = 936;
         |SI #datfic1@#6 ! 0;
             #rem00008#0 = nComunidad;
             #rem00008#1 = 936;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

             nSuma = #datfic3@#75 + #datfic3@#81;
             |SI enConta [ 6;
                 |SI nSuma > #rem00008#9;
                     #datfic1@#6 = 0;
                 |SINO;
                     |SI nSuma ] 26000;  |Y nSuma [ 30000;
                         nPorceBase = (1 - ((nSuma - 26000) / 4000));
                         #datfic1@#6 = #datfic1@#6 * nPorceBase;
                     |FINSI;
                 |FINSI;
             |SINO;
                 |SI nSuma > #rem00008#11;
                     #datfic1@#6 = 0;
                 |SINO;
                     |SI nSuma ] 46000;  |Y nSuma [ 50000;
                         nPorceBase = (1 - ((nSuma - 46000) / 4000));
                         #datfic1@#6 = #datfic1@#6 * nPorceBase;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #datfic1@#12 ! 0;
             #rem00008#0 = nComunidad;
             #rem00008#1 = 136;
             |LEE 000#rem00008.=;
             |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

             nSuma = #datfic3@#75 + #datfic3@#81;
             |SI enConta [ 6;
                 |SI nSuma > #rem00008#9;
                     #datfic1@#12 = 0;
                 |SINO;
                     |SI nSuma ] 23000;  |Y nSuma [ 25000;
                         nPorceBase = (1 - ((nSuma - 23000) / 2000));
                         #datfic1@#12 = #datfic1@#12 * nPorceBase;
                     |FINSI;
                 |FINSI;
             |SINO;
                 |SI nSuma > #rem00008#11;
                     #datfic1@#12 = 0;
                 |SINO;
                     |SI nSuma ] 37000;  |Y nSuma [ 40000;
                         nPorceBase = (1 - ((nSuma - 37000) / 3000));
                         #datfic1@#12 = #datfic1@#12 * nPorceBase;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;

         #datfic1@#6  = #datfic1@#6 + #datfic1@#12;
         #datfic1@#12 = 0;
     |FINSI;

     |SI #rem00008#1 = 941;
         nSuma = #datfic3@#75 + #datfic3@#81;
         |SI nSuma > #rem00008#9;
             #datfic1@#6 = 0;
         |SINO;
             |SI nSuma ] 23000;  |Y nSuma [ 25000;
                 nPorceBase = (1 - ((nSuma - 23000) / 2000));
                 #datfic1@#6 = #datfic1@#6 * nPorceBase;
             |FINSI;
          |FINSI;
     |FINSI;

     |SI #rem00008#1 = 942;
         nValor = #datfic3@#44 + #datfic3@#50;
         |SI nValor > #rem00008#9;
             #datfic1@#6 = 0;
         |FINSI;

         |SI #datfic1@#2 = "TITULAR   ";  nCas912T = #datfic1@#6;                 |FINSI;
         |SI #datfic1@#2 = "CONYUGE   ";  nCas912C = #datfic1@#6;                 |FINSI;
         |SI #datfic1@#2 = "CONJUNTA  ";  #datfic1@#6     = nCas912T + nCas912C;  |FINSI;

         |SI #datfic1@#2 = "CONJUNTAE  ";
             |SI eaMuerto = "T";
                 #datfic1@#6 = nCas912C;
             |SINO;
                 #datfic1@#6 = nCas912T;
             |FINSI;
         |FINSI;

         nValor = #datfic3@#44 + #datfic3@#50;
         |SI nValor > #rem00008#9;
             #datfic1@#6 = 0;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 943;
         nValor = #datfic3@#44 + #datfic3@#50;
         |SI nValor > #rem00008#9;  #datfic1@#6 = 0;  |FINSI;

         |SI #datfic1@#2 = "TITULAR   ";  nCas913T = #datfic1@#6;                 |FINSI;
         |SI #datfic1@#2 = "CONYUGE   ";  nCas913C = #datfic1@#6;                 |FINSI;
         |SI #datfic1@#2 = "CONJUNTA  ";  #datfic1@#6     = nCas913T + nCas913C;  |FINSI;

         |SI #datfic1@#2 = "CONJUNTAE  ";
             |SI eaMuerto = "T";
                 #datfic1@#6 = nCas913C;
             |SINO;
                 #datfic1@#6 = nCas913T;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 946;
         nLimite = #rem00008#9;
         |SI #rew99999#6 ] 1978;  |O #rew99999#3 > 65;
             nLimite = #rem00008#15;
         |FINSI;

         |SI #rew99999#6 ] 1978;  |Y #rew99999#3 > 65;
             nLimite = #rem00008#17;
         |FINSI;

         |SI enConta < 6;
             |SI #datfic1@#6 > nLimite;  #datfic1@#6 = nLimite;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 951;
         nSuma = #datfic3@#75 + #datfic3@#81;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;
                 nLimite = 0;
             |SINO;
                 nLimite = 4100;
                 |SI nSuma ] 23000;  |Y nSuma [ 25000;
                     nPorceBase = (1 - ((nSuma - 23000) / 2000));
                     nLimite = 4100 * nPorceBase;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;
                 nLimite = 0;
             |SINO;
                 nLimite = 4100;
                 |SI nSuma ] 37000;  |Y nSuma [ 40000;
                     nPorceBase = (1 - ((nSuma - 37000) / 3000));
                     nLimite = 4100 * nPorceBase;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #datfic1@#12 > nLimite;
             #datfic1@#12 = nLimite;
         |FINSI;

         #datfic1@#6 = #datfic1@#12 % 5;
     |FINSI;

     |SI #rem00008#1 = 954;
         nValor = (#datfic3@#75 + #datfic3@#81) % 20;
         nValor = nValor - nAcumVal;
         |SI nValor [ 0;
             nAcumVal = (#datfic3@#75 + #datfic3@#81) % 20;
             nValor   = 0;
         |FINSI;

         |SI #datfic1@#12 > 0;
             |SI #datfic1@#12 > nValor;  #datfic1@#12 = nValor;  |FINSI;

             nAcumVal = nAcumVal + #datfic1@#12;

             #datfic1@#12 = #datfic1@#12 % 20;
         |FINSI;

         nValor = (#datfic3@#75 + #datfic3@#81) % 20;
         nValor = nValor - nAcumVal;
         |SI nValor [ 0;
             nAcumVal = (#datfic3@#75 + #datfic3@#81) % 20;
             nValor = 0;
         |FINSI;

         |SI #datfic1@#6 > 0;
             |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;

             nAcumVal = nAcumVal + #datfic1@#6;

             #datfic1@#6 = #datfic1@#6 % 15;
         |FINSI;

         #datfic1@#6  = #datfic1@#6 + #datfic1@#12;
         #datfic1@#12 = 0;
     |FINSI;

     |SI #rem00008#1 = 955;
         nValor = (#datfic3@#75 + #datfic3@#81) % 20;
         nValor = nValor - nAcumVal;
         |SI nValor [ 0;
             nAcumVal = (#datfic3@#75 + #datfic3@#81) % 20;
             nValor   = 0;
         |FINSI;

         |SI #datfic1@#6 > 0;
             |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;

             nAcumVal = nAcumVal + #datfic1@#6;

             #datfic1@#6 = #datfic1@#6 % 15;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 956;
         nValor = (#datfic3@#75 + #datfic3@#81) % 20;
         nValor = nValor - nAcumVal;
         |SI nValor [ 0;
             nAcumVal = (#datfic3@#75 + #datfic3@#81) % 20;
             nValor   = 0;
         |FINSI;

         |SI #datfic1@#6 > 0;
             |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;

             nAcumVal = nAcumVal + #datfic1@#6;

             #datfic1@#6 = #datfic1@#6 % 15;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 962;
         nValor = (#datfic3@#75 + #datfic3@#81) % 20;
         nValor = nValor - nAcumVal;
         |SI nValor [ 0;
             nAcumVal = (#datfic3@#75 + #datfic3@#81) % 20;
             nValor   = 0;
         |FINSI;

         |SI #datfic1@#6 > 0;
             |SI #datfic1@#6 > nValor;  #datfic1@#6 = nValor;  |FINSI;

             nAcumVal = nAcumVal + #datfic1@#6;

             #datfic1@#6 = #datfic1@#6 % 15;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 957;
         n957   = 1;
     |FINSI;

     |SI #rem00008#1 = 933;  |O #rem00008#1 = 934;  |O #rem00008#1 = 935;  |O #rem00008#1 = 937;
      |O #rem00008#1 = 938;  |O #rem00008#1 = 939;  |O #rem00008#1 = 940;  |O #rem00008#1 = 946;
      |O #rem00008#1 = 949;  |O #rem00008#1 = 959;
         #rem00008#0 = nComunidad;
         #rem00008#1 = 937;
         |LEE 000#rem00008.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

         nSuma = #datfic3@#75 + #datfic3@#81;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;
                 #datfic1@#6 = 0;
             |SINO;
                 |SI nSuma ] 23000;  |Y nSuma [ 25000;
                     nPorceBase = (1 - ((nSuma - 23000) / 2000));
                     #datfic1@#6 = #datfic1@#6 * nPorceBase;
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;
                 #datfic1@#6 = 0;
             |SINO;
                 |SI nSuma ] 37000;  |Y nSuma [ 40000;
                     nPorceBase = (1 - ((nSuma - 37000) / 3000));
                     #datfic1@#6 = #datfic1@#6 * nPorceBase;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00008#1 = 961;
         nSuma = #datfic3@#75 + #datfic3@#81;
         |SI enConta [ 6;
             |SI nSuma > #rem00008#9;
                 #datfic1@#6  = 0;
                 #datfic1@#12 = 0;
             |FINSI;
         |SINO;
             |SI nSuma > #rem00008#11;
                 #datfic1@#6  = 0;
                 #datfic1@#12 = 0;
             |FINSI;
         |FINSI;

         |SI #datfic1@#12 ! 0;
             |SI enConta [ 6;
                 nLimite = 4500;
                 |SI nSuma ] 23000;  |Y nSuma [ 25000;
                     nPorceBase = (1 - ((nSuma - 23000) / 2000));
                     nLimite = 4500 * nPorceBase;
                 |FINSI;
             |SINO;
                 nLimite = 4500;
                 |SI nSuma ] 37000;  |Y nSuma [ 40000;
                     nPorceBase = (1 - ((nSuma - 37000) / 3000));
                     nLimite = 4500 * nPorceBase;
                 |FINSI;
             |FINSI;

             |SI #datfic1@#12 > nLimite;
                 #datfic1@#12 = nLimite;
             |FINSI;

             #datfic1@#12 = #datfic1@#12 % 10;
         |FINSI;

         |SI #datfic1@#6 ! 0;
             |SI enConta [ 6;
                 nLimite = 4500;
                 |SI nSuma ] 23000;  |Y nSuma [ 25000;
                     nPorceBase = (1 - ((nSuma - 23000) / 2000));
                     nLimite = 4500 * nPorceBase;
                 |FINSI;
             |SINO;
                 nLimite = 4500;
                 |SI nSuma ] 37000;  |Y nSuma [ 40000;
                     nPorceBase = (1 - ((nSuma - 37000) / 3000));
                     nLimite = 4500 * nPorceBase;
                 |FINSI;
             |FINSI;

             |SI #datfic1@#6 > nLimite;
                 #datfic1@#6 = nLimite;
             |FINSI;

             #datfic1@#6 = #datfic1@#6 % 25;
         |FINSI;

         #datfic1@#6  = #datfic1@#6 + #datfic1@#12;
         #datfic1@#12 = 0;
     |FINSI;
|FPRC;

|PROCESO rem01043T;
     |SI #datfic1@#4 = 999;  |ACABA;  |FINSI;

     |SI #datfic1@#4 = 957;
         |SI #datfic1@#6 = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     nImporte  = nImporte  + #datfic1@#6;
     enImporte = enImporte + #datfic1@#6;
     nPaso     = 1;
|FPRC;

|DEFBUCLE rem01043T;
     #datfic1@#1005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, nComunidad, 000;
     #refere1@#0, #refere1@#1, #refere1@#2, nComunidad, 999;
     be;
     NULL, rem01043T;
|FIN;

|PROCESO GrabaTotal;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 999;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 999;
         |GRABA 101#datfic1@.b;
     |FINSI;

     #datfic1@#6 = nImporte;
     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;

     enImporte  = nImporte;
     enSwAcum   = 0;
     enBloque   = 41;
     eaCasilla  = "511";
     |HAZ GrabaLineal;
|FPRC;

|PROCESO TAutonomicas;
     |ABRE #datfic1@;

     nPaso = 0;  nImporte = 0;  nComunidad = 1;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 2;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 3;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 4;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 5;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 6;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 7;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     ||Castilla y Leon se calcula en CastillaLeonAuto

     nPaso = 0;  nImporte = 0;  nComunidad = 9;  |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 10; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 11; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 12; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 13; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 16; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     nPaso = 0;  nImporte = 0;  nComunidad = 17; |BUCLE rem01043T;
     |SI nPaso = 1;  |HAZ GrabaTotal;  |FINSI;

     |CIERRA #datfic1@;
|FPRC;

|PROCESO rem01043;
     |SI #datfic1@#6  = 0;  |Y #datfic1@#12 = 0;
      |Y #datfic1@#13 = 0;  |Y #datfic1@#14 = 0;
         |ACABA;
     |FINSI;

     nDedTrab = 0;

     #rem00008#0 = #datfic1@#3;
     #rem00008#1 = #datfic1@#4;
     |LEE 000#rem00008.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

     |SI #rem00008#0 = 1;  |HAZ Andalucia;       |FINSI;
     |SI #rem00008#0 = 2;  |HAZ Aragon;          |FINSI;
     |SI #rem00008#0 = 3;  |HAZ Asturias;        |FINSI;
     |SI #rem00008#0 = 4;  |HAZ Baleares;        |FINSI;
     |SI #rem00008#0 = 5;  |HAZ Canarias;        |FINSI;
     |SI #rem00008#0 = 6;  |HAZ Cantabria;       |FINSI;
     |SI #rem00008#0 = 7;  |HAZ CastillaMancha;  |FINSI;
     |SI #rem00008#0 = 8;  |HAZ CastillaLeon;    |FINSI;
     |SI #rem00008#0 = 9;  |HAZ Catalunya;       |FINSI;
     |SI #rem00008#0 = 10; |HAZ Extremadura;     |FINSI;
     |SI #rem00008#0 = 11; |HAZ Galicia;         |FINSI;
     |SI #rem00008#0 = 12; |HAZ Madrid;          |FINSI;
     |SI #rem00008#0 = 13; |HAZ Murcia;          |FINSI;
     |SI #rem00008#0 = 16; |HAZ LaRioja;         |FINSI;
     |SI #rem00008#0 = 17; |HAZ Valencia;        |FINSI;

     |GRABA 020#datfic1@.a;
     |LIBERA #datfic1@;
|FPRC;

|DEFBUCLE rem01043;
     #datfic1@#1005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, nComunidad, 000;
     #refere1@#0, #refere1@#1, #refere1@#2, nComunidad, 999;
     be;
     NULL, rem01043;
|FIN;

|PROCESO CanariasAuto;
     aAlfa = #refere1@#2;
     |SI enConta > 6;  aAlfa = "TITULAR";  |FINSI;

     |ABRE #rew99999;
     |SELECT #2#rew99999;
     #rew99999#1 = aAlfa;
     |LEE 040#rew99999.=;
     |SI FSalida  ! 0;  |DDEFECTO #rew99999;  |FINSI;
     |CIERRA #rew99999;

     |SI #rew99999#7 ! 5;  |ACABA;  |FINSI;

     nValor = #datfic2@#3 + #datfic2@#6 + #datfic2@#9;
     |SI nValor ! 0;
         nSuma = #datfic3@#44 + #datfic3@#50;
                               nPorceBase = 1.75;
         |SI nSuma ] 12000;    nPorceBase = 1.55;  |FINSI;
         |SI nSuma > 24107.20; nPorceBase = 0;     |FINSI;

         |ABRE #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 808;
         |LEE 101#datfic1@.=;
         |SI FSalida ! 0;
             |DDEFECTO #datfic1@;
             #datfic1@#0 = #refere1@#0;
             #datfic1@#1 = #refere1@#1;
             #datfic1@#2 = #refere1@#2;
             #datfic1@#3 = nComunidad;
             #datfic1@#4 = 808;
             |GRABA 101#datfic1@.b;
         |FINSI;

         #datfic1@#6 = nValor % nPorceBase;
         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;

         |CIERRA #datfic1@;
     |FINSI;

     nValor = #datfic2@#12;
     |SI nValor ! 0;
         |ABRE #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 809;
         |LEE 101#datfic1@.=;
         |SI FSalida ! 0;
             |DDEFECTO #datfic1@;
             #datfic1@#0 = #refere1@#0;
             #datfic1@#1 = #refere1@#1;
             #datfic1@#2 = #refere1@#2;
             #datfic1@#3 = nComunidad;
             #datfic1@#4 = 809;
             |GRABA 101#datfic1@.b;
         |FINSI;

         #datfic1@#6 = nValor % 0.75;
         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;
         |CIERRA #datfic1@;
     |FINSI;
|FPRC;

|PROCESO CantabriaAuto;
     |ABRE #datfic1@;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 825;
     |LEE 000#datfic1@.=;
     |SI FSalida ! 0;  |O #datfic1@#12 = 0;
         |CIERRA #datfic1@;
         |ACABA;
     |FINSI;

     nValor = #datfic1@#12;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 826;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 826;

         |GRABA 101#datfic1@.b;
     |FINSI;

     #datfic1@#6 = nValor;
     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;
|FPRC;

|PROCESO QuitaDedu;
     |ABRE #datfic1@;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = nCasilla;
     |LEE 000#datfic1@.=;
     |SI FSalida ! 0;
         |CIERRA #datfic1@;
         |ACABA;
     |FINSI;

     |SI nValor ] #datfic1@#6;
         nValor = nValor - #datfic1@#6;
         |CIERRA #datfic1@;
         |ACABA;
     |FINSI;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = nCasilla;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = nCasilla;
         |GRABA 101#datfic1@.b;
     |FINSI;

     |SI nValor > 0;
         #datfic1@#6 = nValor;
     |SINO;
         #datfic1@#6 = 0;
         #datfic1@#7 = "";
     |FINSI;

     nValor = 0;

     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;
|FPRC;

|PROCESO CastillaManchaAuto;
     |HAZ TotDedAutonomica;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     nComunidad = 7;
     nCasilla   = 817;  |HAZ QuitaDedu;
     nCasilla   = 823;  |HAZ QuitaDedu;
     nCasilla   = 825;  |HAZ QuitaDedu;
     nCasilla   = 818;  |HAZ QuitaDedu;
     nCasilla   = 819;  |HAZ QuitaDedu;
     nCasilla   = 820;  |HAZ QuitaDedu;
     nCasilla   = 821;  |HAZ QuitaDedu;
     nCasilla   = 826;  |HAZ QuitaDedu;
     nCasilla   = 827;  |HAZ QuitaDedu;
     nCasilla   = 829;  |HAZ QuitaDedu;
     nCasilla   = 822;  |HAZ QuitaDedu;
     nCasilla   = 824;  |HAZ QuitaDedu;
     nCasilla   = 816;  |HAZ QuitaDedu;
|FPRC;

|PROCESO CastillaLeonAuto;
     |ABRE #datfic1@;

     nCasilla  = 834;  |HAZ LeeValorCasilla;
     aChequeo1 = #rem01043#5;
     nImporte1 = #rem01043#6;

     nCasilla  = 835;  |HAZ LeeValorCasilla;
     aChequeo2 = #rem01043#5;
     nImporte2 = #rem01043#6;

     nCasilla = 836;  |HAZ LeeValorCasilla;
     aChequeo3 = #rem01043#5;
     nImporte3 = #rem01043#6;


     |SI aChequeo1 = "S";  |O aChequeo2 = "S"; |O aChequeo3 = "S";
         nValor1 = ((nImporte1 + nImporte2 + nImporte3) * 100) / 10;
         nValor2 = ((#datfic3@#77 + #datfic3@#81) % 10) ! 2;
         |SI nValor1 > nValor2;
             nValor2 = nValor2 % 15;

             |SI nImporte1 ! 0;
                 |SI nImporte1 > nValor2;
                     nImporte1 = nValor2;
                     nValor2   = 0;
                 |SINO;
                     nValor2 = nValor2 - nImporte1;
                 |FINSI;
             |FINSI;

             |SI nImporte2 ! 0;
                 |SI nImporte2 > nValor2;
                     nImporte2 = nValor2;
                     nValor2   = 0;
                 |SINO;
                     nValor2 = nValor2 - nImporte2;
                 |FINSI;
             |FINSI;

             |SI nImporte3 ! 0;
                 nImporte3 = nValor2;
                 nValor2   = 0;
             |FINSI;
         |FINSI;

         |SI nValor2 < 0;
             nImporte1 = 0;
             nImporte2 = 0;
             nImporte3 = 0;
         |FINSI;

         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 850;
         |LEE 101#datfic1@.=;
         |SI FSalida ! 0;
             |DDEFECTO #datfic1@;
             #datfic1@#0 = #refere1@#0;
             #datfic1@#1 = #refere1@#1;
             #datfic1@#2 = #refere1@#2;
             #datfic1@#3 = nComunidad;
             #datfic1@#4 = 850;
             |GRABA 101#datfic1@.b;
         |FINSI;

         #datfic1@#6 = nImporte1;
         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;

         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 851;
         |LEE 101#datfic1@.=;
         |SI FSalida ! 0;
             |DDEFECTO #datfic1@;
             #datfic1@#0 = #refere1@#0;
             #datfic1@#1 = #refere1@#1;
             #datfic1@#2 = #refere1@#2;
             #datfic1@#3 = nComunidad;
             #datfic1@#4 = 851;
             |GRABA 101#datfic1@.b;
         |FINSI;

         #datfic1@#6 = nImporte2;
         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;

         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 852;
         |LEE 101#datfic1@.=;
         |SI FSalida ! 0;
             |DDEFECTO #datfic1@;
             #datfic1@#0 = #refere1@#0;
             #datfic1@#1 = #refere1@#1;
             #datfic1@#2 = #refere1@#2;
             #datfic1@#3 = nComunidad;
             #datfic1@#4 = 852;
             |GRABA 101#datfic1@.b;
         |FINSI;

         #datfic1@#6 = nImporte3;
         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;
     |FINSI;

     |HAZ TotDedAutonomica;

     nCasilla = 832;  |HAZ LeeValorCasilla;  nValor = nValor - nValorCas;
     nCasilla = 833;  |HAZ LeeValorCasilla;  nValor = nValor - nValorCas;
     nCasilla = 836;  |HAZ LeeValorCasilla;  nValor = nValor - nValorCas;
     nCasilla = 838;  |HAZ LeeValorCasilla;  nValor = nValor - nValorCas;
     nCasilla = 840;  |HAZ LeeValorCasilla;  nValor = nValor - nValorCas;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 860;
     |LEE 101#datfic1@.=;
     |SI FSalida = 0;
         |SI #datfic1@#6 ! 0;
             |SI #datfic1@#6 [ nValor;
                 #datfic1@#12 = #datfic1@#6;
             |SINO;
                 #datfic1@#12 = nValor;
             |FINSI;
         |FINSI;

         nValor = nValor - #datfic1@#12;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;
     |FINSI;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 862;
     |LEE 101#datfic1@.=;
     |SI FSalida = 0;
         |SI #datfic1@#6 ! 0;
             |SI #datfic1@#6 [ nValor;
                 #datfic1@#12 = #datfic1@#6;
             |SINO;
                 #datfic1@#12 = nValor;
             |FINSI;
         |FINSI;

         nValor = nValor - #datfic1@#12;
         |SI nValor < 0;  nValor = 0;  |FINSI;

         |GRABA 101#datfic1@.a;
         |LIBERA #datfic1@;
     |FINSI;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 999;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 999;
         |GRABA 101#datfic1@.b;
     |FINSI;

                                             nValor1 = 0;
     nCasilla = 848;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 849;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 850;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 851;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 853;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 854;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 855;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;
     nCasilla = 857;  |HAZ LeeValorCasilla;  nValor1 = nValor1 + nValorCas;

     #datfic1@#12 = 0;
     |SI nValor1 ! 0;
         |SI nValor1 [ nValor;
             #datfic1@#12 = nValor1;
         |SINO;
             #datfic1@#12 = nValor;
         |FINSI;
     |FINSI;

     #datfic1@#16 = nValor1 - #datfic1@#12;


                                             nValor = #datfic1@#12;
     nCasilla = 832;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 833;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 834;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 835;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 836;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 838;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 840;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 842;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 843;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;
     nCasilla = 844;  |HAZ LeeValorCasilla;  nValor = nValor + #rem01043#12;
     nCasilla = 846;  |HAZ LeeValorCasilla;  nValor = nValor + #rem01043#12;
     nCasilla = 859;  |HAZ LeeValorCasilla;  nValor = nValor + nValorCas;

     #datfic1@#6 = nValor;

     nCasilla = 844;  |HAZ LeeValorCasilla;  nValor = #rem01043#6 - #rem01043#12;

     #datfic1@#13 = nValor;

     nCasilla = 846;  |HAZ LeeValorCasilla;

     n846 = #rem01043#6;
     n847 = #rem01043#12;

     nCasilla = 965;  |HAZ LeeValorCasilla;
     n965 = #rem01043#6;

     nCasilla = 966;  |HAZ LeeValorCasilla;
     n966 = #rem01043#6;

     n967 = 0;
     n861 = 0;
     nValor = n965 - n847;
     |SI nValor > 0;
         n967 = n966;
         n861 = n846;
     |SINO;
         nValor = n965 - n847 + n966;
         |SI nValor > 0;
             n967 = nValor;
             n861 = n846;
         |SINO;
             nValor = n965 - n847 + n966 + n846;
             |SI nValor > 0;
                 n861 = nValor;
             |FINSI;
         |FINSI;
     |FINSI;

     #datfic1@#15 = n967;
     #datfic1@#14 = n861;

     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;

     |SI #datfic1@#6 ! 0;
         nImporte = #datfic1@#6;
         |HAZ GrabaTotal;
     |FINSI;
|FPRC;

|PROCESO LaRiojaAuto;
     nCasilla = 928;  |HAZ LeeValorCasilla;
     aChequeo1 = #rem01043#5;
     nImporte1 = #rem01043#6;

     nCasilla = 930;  |HAZ LeeValorCasilla;
     aChequeo2 = #rem01043#5;
     nImporte2 = #rem01043#6;

     |SI aChequeo1 = "N";  |Y aChequeo2 = "N";
         |ACABA;
     |FINSI;

     #rem00008#0 = nComunidad;
     #rem00008#1 = 928;
     |LEE 000#rem00008.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

     nImporte = nImporte1 + nImporte2;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     nBase1  = ((nImporte1 * 100) / 3) ! 2;
     nBase2  = ((nImporte2 * 100) / 7) ! 2;
     nValor  = nBase1 + nBase2;
     nLimite = #rem00008#9 - nBaseViv;
     |SI nLimite < 0;  nLimite = 0;  |FINSI;

     |SI nValor > nLimite;
         nValor1 = nValor - nLimite;
         |SI nBase1 ] nValor1;
             nBase1  = nBase1 - nValor1;
             nValor1 = 0;
         |SINO;
             nValor1 = nValor1 - nBase1;
             nBase1  = 0;
             nBase2  = nBase2  - nValor1;
         |FINSI;

         nImporte1 = nBase1 % 3;
         nImporte2 = nBase2 % 7;
         |SI nImporte2 > #rem00008#11;  nImporte2 = #rem00008#11;  |FINSI;
     |FINSI;

     |ABRE #datfic1@;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 937;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 937;
         |GRABA 101#datfic1@.b;
     |FINSI;

     #datfic1@#6 = nImporte1;
     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;

     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 939;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 939;
         |GRABA 101#datfic1@.b;
     |FINSI;

     #datfic1@#6 = nImporte2;
     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;
|FPRC;

|PROCESO ValenciaAuto;
     |HAZ TotDedAutonomica;
     enBloque = 41; eaCasilla = "511"; |HAZ SacaImporte;
     nValor   = nValor - enImporte;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     |ABRE #datfic1@;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     #datfic1@#3 = nComunidad;
     #datfic1@#4 = 957;
     |LEE 101#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         #datfic1@#3 = nComunidad;
         #datfic1@#4 = 957;
         |GRABA 101#datfic1@.b;
     |FINSI;

     #datfic1@#6 = nValor % 10;
     |SI #datfic1@#6 < 0;  #datfic1@#6 = 0;  |FINSI;

     #rem00008#0 = nComunidad;
     #rem00008#1 = 957;
     |LEE 000#rem00008.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00008;  |FINSI;

     nSuma = 0;
     |SI enConta [ 6;
         |HAZ LeeRentas;
     |SINO;
         |ABRE #datfic3@;
         #datfic3@#0 = #refere1@#0;
         #datfic3@#1 = #refere1@#1;
         #datfic3@#2 = #refere1@#2;
         |LEE 040#datfic3@.=;
         |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
         |CIERRA #datfic3@;

         nSuma = #datfic3@#44 + #datfic3@#50;
     |FINSI;

     |SI nSuma > #rem00008#9;   #datfic1@#6 = 0;  |FINSI;

     |GRABA 101#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;
|FPRC;

|PROCESO CalculaAnexoB;
     aDef    = eaPathDef + "rem01043.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1043"#;  |FINSI;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1041"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic3@;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1026"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic4@;
         |DESCARGA_DEF #datfic3@;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic5@#"zdat1018"#;  |FINSI;

     |ABRE #datfic2@;
     #datfic2@#0 = #refere1@#0;
     #datfic2@#1 = #refere1@#1;
     #datfic2@#2 = #refere1@#2;
     |LEE 040#datfic2@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic2@;  |FINSI;
     |CIERRA #datfic2@;

     nBaseViv = #datfic2@#64 + #datfic2@#65 + #datfic2@#66 + #datfic2@#67;
     nBaseViv = nBaseViv + #datfic2@#68 + #datfic2@#69 + #datfic2@#70 + #datfic2@#71;
     nCasiB   = #datfic2@#46;
     nAcumVal = 0;
     n957     = 0;
     n807     = 0;

     |ABRE #rem00008;

     nComunidad = 2;  |BUCLE rem01043;

     |ABRE #datfic3@;
     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = #refere1@#2;
     |LEE 040#datfic3@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic3@;  |FINSI;
     |CIERRA #datfic3@;

     |ABRE #datfic4@;
     #datfic4@#0 = #refere1@#0;
     #datfic4@#1 = #refere1@#1;
     #datfic4@#2 = #refere1@#2;
     |LEE 040#datfic4@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic4@;  |FINSI;
     |CIERRA #datfic4@;

     |ABRE #datfic5@;
     #datfic5@#0 = #refere1@#0;
     #datfic5@#1 = #refere1@#1;
     #datfic5@#2 = #refere1@#2;
     |LEE 040#datfic5@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic5@;  |FINSI;
     |CIERRA #datfic5@;

     nComunidad = 1;  |BUCLE rem01043;
     nComunidad = 3;  |BUCLE rem01043;
     nComunidad = 4;  |BUCLE rem01043;
     nComunidad = 5;  |BUCLE rem01043;   |HAZ CanariasAuto;
     nComunidad = 6;  |BUCLE rem01043;   |HAZ CantabriaAuto;
     nComunidad = 7;  |BUCLE rem01043;   |HAZ CastillaManchaAuto;
     nComunidad = 8;  |BUCLE rem01043;   |HAZ CastillaLeonAuto;
     nComunidad = 9;  |BUCLE rem01043;
     nComunidad = 10; |BUCLE rem01043;
     nComunidad = 11; |BUCLE rem01043;
     nComunidad = 12; |BUCLE rem01043;
     nComunidad = 13; |BUCLE rem01043;
     nComunidad = 16; |BUCLE rem01043;   |HAZ LaRiojaAuto;
     nComunidad = 17; |BUCLE rem01043;

     |HAZ TAutonomicas;

     |SI n957 = 1;
         nComunidad = 17;
         |HAZ ValenciaAuto;
         |HAZ TAutonomicas;
     |FINSI;

     |CIERRA #rem00008;

     |DESCARGA_DEF #datfic5@;
     |DESCARGA_DEF #datfic4@;
     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;
