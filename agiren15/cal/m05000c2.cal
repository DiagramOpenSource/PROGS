|| PROCESOS DE DATOS

|FICHEROS;
     rem05000;

     rem00019;
     rem00020;
     rem00021;
     rem00100;
     rem00101;

     tempora0@ #0;
     tempora1@ #1;
     tempora2@ #2;
     tempora3@ #3;

     &poblaci@;
|FIN;

|INCLUYE m05000c9;

|PROCESO BuscaLinea1;
     #tempora1@#0    = #tempora0@#0;
     #tempora1@#1    = #tempora0@#1;
     |PARA nLinea1 = 1;  |SI nLinea1 [ 999;  |HACIENDO nLinea1 = nLinea1 + 1;
           #tempora1@#2 = nLinea1;
           |LEE 000#tempora1@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO BuscaRegistro;
     aDef = aBase + "def/" + aMas;

     |CARGA_DEF aDef, tempora0@;

     nHay = 0;

     |ABRE #tempora0@;
     #tempora0@#0 = #rem05000#0;
     #tempora0@#1 = nContri;
     #tempora0@#2 = 1;
     |LEE 000#tempora0@.];
     |SI FSalida = 0;  |Y #tempora0@#0 = #rem05000#0;  |Y #tempora0@#1 = nContri;
         nHay = 1;
     |FINSI;
     |CIERRA #tempora0@;

     |DESCARGA_DEF #tempora0@;

     |SI nHay = 0;  |ACABA;  |FINSI;

     nConta = nConta + 1;

     |SI aClave = "TI";  aAlfa = nConta + ":Datos contribuyentes {{TI}}";  |FINSI;
     |SI aClave = "DE";  aAlfa = nConta + ":Datos familiares {{DE}}";  |FINSI;

     |SI aClave = "RT";  aAlfa = nConta + ":Rendimientos del trabajo {{RT}}";  |FINSI;
     |SI aClave = "RB";  aAlfa = nConta + ":Premios y ganancias patrimoniales {{RB}}";  |FINSI;
     |SI aClave = "RC";  aAlfa = nConta + ":Actividades econ¢micas {{RC}}";    |FINSI;
     |SI aClave = "AE";  aAlfa = nConta + ":Datos censales sobre actividades econ¢micas de alta en el ejercicio {{AE}}"; |FINSI;
     |SI aClave = "PF";  aAlfa = nConta + ":Pagos fraccionados de empresas y profesionales {{PF}}";    |FINSI;
     |SI aClave = "CB";  aAlfa = nConta + ":Cuentas bancarias {{CB}}";         |FINSI;
     |SI aClave = "RE";  aAlfa = nConta + ":Rendimientos expl¡citos del capital mobiliario, base imponible del ahorro {{RE}}";  |FINSI;
     |SI aClave = "RI";  aAlfa = nConta + ":Rendimientos expl¡citos del capital mobiliario {{RI}}";  |FINSI;
     |SI aClave = "DN";  aAlfa = nConta + ":Donaciones y aportaciones a patrimonio de persona con discapacidad {{DN}}";  |FINSI;
     |SI aClave = "TV";  aAlfa = nConta + ":Ventas de activos financieros y otros valores mobiliarios {{TV}}";  |FINSI;
     |SI aClave = "SG";  aAlfa = nConta + ":Rendimientos de operaciones de seguros {{SG}}";  |FINSI;
     |SI aClave = "CT";  aAlfa = nConta + ":Cotizaciones a reg¡menes especiales de la seguridad social y convenios especiales {{CT}}";  |FINSI;
     |SI aClave = "UR";  aAlfa = nConta + ":Informaci¢n catastral de inmuebles {{UR}}";  |FINSI;
     |SI aClave = "AR";  aAlfa = nConta + ":Arrendamientos de inmuebles {{AR}}";  |FINSI;
     |SI aClave = "EA";  aAlfa = nConta + ":Atribuci¢n de rendimientos del capital mobiliario {{EA}}";  |FINSI;
     |SI aClave = "EB";  aAlfa = nConta + ":Atribuci¢n de rendimientos del capital inmobiliario {{EB}}";  |FINSI;
     |SI aClave = "EC";  aAlfa = nConta + ":Atribuci¢n de rendimientos de actividades econ¢micas {{EC}}";  |FINSI;
     |SI aClave = "ED";  aAlfa = nConta + ":Atribuci¢n de ganancias y p‚rdidas patrimoniales {{ED}}";  |FINSI;
     |SI aClave = "EF";  aAlfa = nConta + ":Atribuci¢n de rentas deducciones {{EF}}";  |FINSI;
     |SI aClave = "PH";  aAlfa = nConta + ":Pr‚stamos y cr‚ditos relacionados con bienes inmuebles {{PH}}";  |FINSI;
     |SI aClave = "DM";  aAlfa = nConta + ":Deducci¢n por maternidad {{DM}}";  |FINSI;
     |SI aClave = "PP";  aAlfa = nConta + ":Aportaciones y contribuciones a sistema de previsi¢n social {{PP}}";  |FINSI;
     |SI aClave = "IP";  aAlfa = nConta + ":Otras subvenciones,auxilios y ayudas satisfechos por las administraciones p£blicas {{IP}}";  |FINSI;
     |SI aClave = "AG";  aAlfa = nConta + ":Subvenciones e indemnizaciones satisfechas a agricultores, ganaderos o forestales {{AG}}";  |FINSI;
     |SI aClave = "FI";  aAlfa = nConta + ":Ventas de fondos de inversi¢n con retenci¢n {{FI}}";  |FINSI;
     |SI aClave = "SC";  aAlfa = nConta + ":Participaci¢n en comunidades de bienes, herencias yacentes y sociedades civiles {{SC}}";  |FINSI;
     |SI aClave = "CU";  aAlfa = nConta + ":Abono por nacimiento o adopci¢n. Deducci¢n IRPF anticipada {{CU}}";  |FINSI;
     |SI aClave = "NO";  aAlfa = nConta + ":Operaciones de transmisi¢n de derechos sobre bienes inmuebles {{NO}}";  |FINSI;
     |SI aClave = "LT";  aAlfa = nConta + ":Rendimientos de letras del tesoro {{LT}}";  |FINSI;
     |SI aClave = "CC";  aAlfa = nConta + ":Deducciones auton¢micas {{CC}}";  |FINSI;
     |SI aClave = "EV";  aAlfa = nConta + ":Renta b sicas de emancipaci¢n {{EV}}";  |FINSI;
     |SI aClave = "SB";  aAlfa = nConta + ":Subvenciones recogidas de la Base de Datos Nacional de Subvenciones {{SB}}";  |FINSI;
     |SI aClave = "FA";  aAlfa = nConta + ":Deducci¢n por familia numerosa {{FA}}";  |FINSI;
     |SI aClave = "DD";  aAlfa = nConta + ":Deducci¢n por descendientes con discapacidad a cargo {{DD}}";  |FINSI;

     || Aqui insertar

     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO PasaTitular;
     nLinea = 1;

     |ABRE #rem00019;
     #rem00019#0 = #rem05000#0;
     #rem00019#1 = "TITULAR";
     |LEE 000#rem00019.=;
     |SI FSalida ! 0;
        |DDEFECTO #rem00019;
        #rem00019#0 = #rem05000#0;
        #rem00019#1 = "TITULAR";
        |GRABA 020#rem00019.b;
     |FINSI;

     |SI #tempora0@#15 = "1"; |O  #tempora0@#16 = "1";
         |SI #tempora0@#15 = "1";  #rem00019#2 = "S";  |FINSI;
         |SI #tempora0@#16 = "1";  #rem00019#3 = "S";  |FINSI;

         |GRABA 020#rem00019.a;
     |SINO;
         |BORRA 020#rem00019.a;
     |FINSI;
     |LIBERA #rem00019;
     |CIERRA #rem00019;

     #rem00100#8   = 0;
     #rem00100#9   = "N";
     #rem00100#11  = #tempora0@#14;
     #rem00100#12  = #tempora0@#35;
     #rem00100#14  = #tempora0@#20;
     #rem00100#15  = #tempora0@#21;
     aAlfa         = #tempora0@#23;  |QBF aAlfa;
     #rem00100#16  = aAlfa;
     #rem00100#17  = #tempora0@#27;
     aAlfa         = #tempora0@#28;  |QBF aAlfa;
     #rem00100#18  = aAlfa;
     aAlfa         = #tempora0@#29;  |QBF aAlfa;
     #rem00100#19  = aAlfa;
     aAlfa         = #tempora0@#32 % 102;  #rem00100#20  = aAlfa;
     aAlfa         = #tempora0@#32 % 303;  #rem00100#21  = aAlfa;
     #rem00100#22  = #tempora0@#31;
     #rem00100#23  = #tempora0@#32;
     #rem00100#53  = #tempora0@#18;
     #rem00100#95  = "";
     #rem00100#109 = #tempora0@#36;
     #rem00100#112 = #tempora0@#37;
     #rem00100#114 = #tempora0@#22;
     #rem00100#115 = #tempora0@#24;
     #rem00100#116 = #tempora0@#25;
     #rem00100#117 = #tempora0@#26;
     #rem00100#118 = #tempora0@#30;

     |SI #tempora0@#10 = "1";
         #rem00100#8 = 34;
     |FINSI;

     |SI #tempora0@#10 = "2";
         #rem00100#8 = 34;
         #rem00100#9 = "S";
     |FINSI;

     |SI #tempora0@#10 = "3";
         #rem00100#8 = 66;
     |FINSI;

     |SI #tempora0@#12 = "HOMBRE";  #rem00100#105 = "V";  |FINSI;
     |SI #tempora0@#12 = "MUJER ";  #rem00100#105 = "M";  |FINSI;

     |SI #tempora0@#11 ! "00.00.0000";  |Y #tempora0@#11 ! "          ";
         #rem00100#103 = #tempora0@#11;
     |FINSI;

     |SI #tempora0@#13 ! "00.00.0000";  |Y #tempora0@#13 ! "          ";
         #rem00100#90 = "S";
         #rem00100#91 = "T";
         #rem00100#92 = #tempora0@#13;
     |FINSI;
|FPRC;

|PROCESO PasaConyuge;
     nLinea = 2;

     |ABRE #rem00019;
     #rem00019#0 = #rem05000#0;
     #rem00019#1 = "CONYUGE";
     |LEE 000#rem00019.=;
     |SI FSalida ! 0;
        |DDEFECTO #rem00019;
        #rem00019#0 = #rem05000#0;
        #rem00019#1 = "CONYUGE";
        |GRABA 020#rem00019.b;
     |FINSI;

     |SI #tempora0@#15 = "1"; |O  #tempora0@#16 = "1";
         |SI #tempora0@#15 = "1";  #rem00019#2 = "S";  |FINSI;
         |SI #tempora0@#16 = "1";  #rem00019#3 = "S";  |FINSI;

         |GRABA 020#rem00019.a;
     |SINO;
         |BORRA 020#rem00019.a;
     |FINSI;
     |LIBERA #rem00019;
     |CIERRA #rem00019;

     #rem00100#13  = #tempora0@#35;
     #rem00100#35  = #tempora0@#8;
     #rem00100#39  = #tempora0@#9;
     #rem00100#41  = 0;
     #rem00100#42  = "N";
     #rem00100#43  =  #tempora0@#14;
     #rem00100#44  = #tempora0@#20;
     #rem00100#45  = #tempora0@#21;
     aAlfa         = #tempora0@#23;  |QBF aAlfa;
     #rem00100#46  = aAlfa;
     #rem00100#47  = #tempora0@#27;
     aAlfa         = #tempora0@#28;  |QBF aAlfa;
     #rem00100#48  = aAlfa;
     aAlfa         = #tempora0@#29;  |QBF aAlfa;
     #rem00100#49  = aAlfa;
     aAlfa         = #tempora0@#32 % 102;  #rem00100#50  = aAlfa;
     aAlfa         = #tempora0@#32 % 303;  #rem00100#51  = aAlfa;
     #rem00100#52  = #tempora0@#31;
     #rem00100#54  = #tempora0@#18;
     #rem00100#110 = #tempora0@#36;
     #rem00100#129 = #tempora0@#37;
     #rem00100#131 = #tempora0@#22;
     #rem00100#132 = #tempora0@#24;
     #rem00100#133 = #tempora0@#25;
     #rem00100#134 = #tempora0@#26;
     #rem00100#135 = #tempora0@#30;

     |SI #tempora0@#10 = "1";
         #rem00100#41 = 34;
     |FINSI;

     |SI #tempora0@#10 = "2";
         #rem00100#41 = 34;
         #rem00100#42 = "S";
     |FINSI;

     |SI #tempora0@#10 = "3";
         #rem00100#41 = 66;
     |FINSI;

     |SI #tempora0@#12 = "HOMBRE";  #rem00100#106 = "V";  |FINSI;
     |SI #tempora0@#12 = "MUJER ";  #rem00100#106 = "M";  |FINSI;

     |SI #tempora0@#11 ! "00.00.0000";  |Y #tempora0@#11 ! "          ";
         #rem00100#104 = #tempora0@#11;
     |FINSI;

     |SI #tempora0@#13 ! "00.00.0000";  |Y #tempora0@#13 ! "          ";
         #rem00100#90 = "S";
         #rem00100#91 = "C";
         #rem00100#92 = #tempora0@#13;
     |FINSI;

     #rem00100#6 = "C";
|FPRC;

|PROCESO PasaRegistroTI;
     |ABRE #rem00100;
     #rem00100#0  = #rem05000#0;
     |LEE 101#rem00100.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00100;
         #rem00100#0  = #rem05000#0;
         |GRABA 020#rem00100.b;
     |FINSI;

     |SI #tempora0@#2 = 1;  |HAZ PasaTitular;  |FINSI;
     |SI #tempora0@#2 = 2;  |HAZ PasaConyuge;  |FINSI;

     #rem00100#7  = #rem00100#103 % -104;
     #rem00100#40 = #rem00100#104 % -104;

     eaCta = #rem00100#53;    |HAZ CalcuIBAN;  #rem00100#147 = eaIBAN;
     eaCta = #rem00100#54;    |HAZ CalcuIBAN;  #rem00100#148 = eaIBAN;
     eaCta = #rem00100#55;    |HAZ CalcuIBAN;  #rem00100#149 = eaIBAN;

     |GRABA 020#rem00100.a;
     |LIBERA #rem00100;
     |CIERRA #rem00100;

     #tempora1@#0 = #tempora0@#0;
     #tempora1@#1 = #tempora0@#1;
     #tempora1@#2 = #tempora0@#2;
     |LEE 101#tempora1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #tempora1@;
         #tempora1@#0 = #tempora0@#0;
         #tempora1@#1 = #tempora0@#1;
         #tempora1@#2 = #tempora0@#2;
         #tempora1@#4 = "Activo";
         |GRABA 020#tempora1@.b;
     |FINSI;

     |PARA nCampo1 = 7;  |SI nCampo1 [ 37;  |HACIENDO nCampo1 = nCampo1 + 1;
           #tempora1@#nCampo1# = #tempora0@#nCampo1#;
     |SIGUE;

     |GRABA 020#tempora1@.a;
     |LIBERA #tempora1@;
|FPRC;

|PROCESO PasaRegistroDE;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = #tempora0@#7;
     #tempora2@#3  = #tempora0@#8;
     #tempora2@#4  = "DESCENDIENTE";
     #tempora2@#6  = #tempora0@#9;
     #tempora2@#7  = #tempora0@#12;
     #tempora2@#8  = #tempora0@#13;

     |SI #tempora0@#9 = "1";
         #tempora2@#6 = 34;
     |FINSI;

     |SI #tempora0@#9 = "2";
         #tempora2@#14 = "S";
         #tempora2@#6 = 34;
     |FINSI;

     |SI #tempora0@#9 = "3";
         #tempora2@#6 = 66;
     |FINSI;

     #tempora2@#17 = #tempora0@#10;
     |SI #tempora0@#10 = "00.00.0000";  #tempora2@#17 = "01.01.0000";  |FINSI;
     |SI #tempora0@#10 = "          ";  #tempora2@#17 = "01.01.0000";  |FINSI;

     #tempora2@#18 = #tempora0@#11;
     |SI #tempora0@#11 = "00.00.0000";  #tempora2@#18 = "01.01.0000";  |FINSI;
     |SI #tempora0@#11 = "          ";  #tempora2@#18 = "01.01.0000";  |FINSI;

     #tempora2@#19 = "3";
     |SI #tempora0@#16 [ 8000;  #tempora2@#19 = "2";  |FINSI;
     |SI #tempora0@#16 [ 0;     #tempora2@#19 = "";  |FINSI;

     #tempora2@#21 = #tempora0@#15;
     |SI #tempora0@#15 = "00.00.0000";  #tempora2@#21 = "01.01.0000";  |FINSI;
     |SI #tempora0@#15 = "          ";  #tempora2@#21 = "01.01.0000";  |FINSI;

     #tempora2@#5 = #tempora2@#17 % -104;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11;
     #tempora1@#12 = #tempora0@#12;
     #tempora1@#13 = #tempora0@#13;
     #tempora1@#14 = #tempora0@#14;
     #tempora1@#15 = #tempora0@#15;
     #tempora1@#16 = #tempora0@#16;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO SegSocial;
     aAlfa1 = #tempora2@#2;   |QBF aAlfa1;
     aAlfa2 = aContri;        |QBF aAlfa2;
     |SI aAlfa1 = aAlfa2;
         |SI #tempora2@#19 = #tempora0@#15;
             nSegSocial = 1;
             |ERROR10;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE SegSocial;
     #tempora2@#1002;
     ;
     #rem05000#0, 01;
     #rem05000#0, 99;
     ;
     NULL, SegSocial;
|FIN;

|PROCESO PasaRegistroRT;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     nSegSocial = 0;
     |BUCLE SegSocial;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#5  = #tempora0@#8;
     #tempora2@#6  = #tempora0@#11;
     #tempora2@#7  = #tempora0@#10;
     #tempora2@#9  = #tempora0@#12 - #tempora0@#13 + #tempora0@#14;
     #tempora2@#10 = #tempora0@#13;
     #tempora2@#11 = #tempora0@#14;

     |SI #tempora0@#16 ! 0;
         #tempora2@#7  = 0;
         #tempora2@#28 = #tempora0@#10;
         #tempora2@#27 = -1;
         #tempora2@#17 = -1;
         #tempora2@#18 = #tempora0@#16;
     |FINSI;

     #tempora2@#12 = #tempora2@#9 + #tempora2@#10 - #tempora2@#11;
     |SI #tempora2@#12 < 0;  #tempora2@#12 = 0;  |FINSI;

     |SI nSegSocial = 0;
         #tempora2@#19 = #tempora0@#15;
     |FINSI;

     #tempora2@#23 = #tempora2@#19 + #tempora2@#20 + #tempora2@#21 + #tempora2@#22;
     #tempora2@#24 = #tempora2@#7  + #tempora2@#12 + #tempora2@#34 + #tempora2@#16 + #tempora2@#28 - #tempora2@#18 - #tempora2@#23;
     #tempora2@#36 = 0;

     |SI #tempora2@#35 = "S";
         #tempora2@#36 = #tempora2@#24 % 65;
     |FINSI;

     #tempora2@#37 = #tempora2@#24 - #tempora2@#36;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11;
     #tempora1@#12 = #tempora0@#12;
     #tempora1@#13 = #tempora0@#13;
     #tempora1@#14 = #tempora0@#14;
     #tempora1@#15 = #tempora0@#15;
     #tempora1@#16 = #tempora0@#16;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRB;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     |SI #tempora0@#5 = "rem00037";
         #tempora2@#11 = #tempora0@#10;
         #tempora2@#16 = #tempora0@#11;
         #tempora2@#12 = #tempora0@#12;
         #tempora2@#13 = #tempora0@#13;
         #tempora2@#14 = #tempora0@#14;
         #tempora2@#15 = #tempora2@#12 + #tempora2@#13 - #tempora2@#14;
     |FINSI;

     |SI #tempora0@#5 = "rem00030";
         #tempora2@#12 = #tempora0@#10 + #tempora0@#12 + #tempora0@#13 - #tempora0@#14;
         #tempora2@#23 = #tempora0@#11 + #tempora0@#13;
     |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     |SI #tempora1@#5 = "rem00037";
         #tempora1@#7  = "";
         #tempora1@#8  = "";
         #tempora1@#15 = "K1";
         #tempora1@#9  = "Premios";
         #tempora1@#10 = #tempora2@#11;
         #tempora1@#11 = #tempora2@#16;
         #tempora1@#12 = #tempora2@#12;
         #tempora1@#13 = #tempora2@#13;
         #tempora1@#14 = #tempora2@#14;
     |FINSI;

     |SI #tempora1@#5 = "rem00030";
         #tempora1@#7  = "";
         #tempora1@#8  = "";
         #tempora1@#15 = "K2";
         #tempora1@#9  = "Ganancias patromoniales";
         #tempora1@#10 = #tempora2@#12;
         #tempora1@#11 = #tempora2@#23;
     |FINSI;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRC;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#15 = #tempora0@#11;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = "";
     #tempora1@#8  = "Dato desconocido";
     #tempora1@#9  = "";
     #tempora1@#10 = 0;
     #tempora1@#11 = #tempora2@#15;
     #tempora1@#12 = 0;
     #tempora1@#13 = 0;
     #tempora1@#14 = 0;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroCB;
     aDef = aBase + "def/rem00023.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     #tempora2@#11 = "E1";
     #tempora2@#17 = #tempora0@#8;
     #tempora2@#18 = #tempora0@#9;
     #tempora2@#19 = "I";
     #tempora2@#20 = #tempora0@#12 + #tempora0@#14;
     #tempora2@#22 = #tempora0@#13 + #tempora0@#15;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#8  = #tempora2@#17;
     aAlfa   = #tempora2@#18;  |QBF aAlfa;
     aAlfa   = aAlfa % -110;
     #tempora1@#9  = aAlfa;
     #tempora1@#12 = #tempora2@#20;
     #tempora1@#13 = #tempora2@#22;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRE;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     |SI #tempora0@#5 = "rem00022";
         #tempora2@#11 = "G2";
         #tempora2@#17 = #tempora0@#8;
         #tempora2@#19 = #tempora0@#13;
         #tempora2@#22 = #tempora0@#13;
         #tempora2@#24 = #tempora0@#14;
         #tempora2@#27 = #tempora0@#15;
     |FINSI;

     |SI #tempora0@#5 = "rem00023";
         #tempora2@#11 = "F2";
         #tempora2@#17 = #tempora0@#8;
         #tempora2@#20 = #tempora0@#13;
         #tempora2@#22 = #tempora0@#14;
         #tempora2@#23 = #tempora0@#15;

         |SI #tempora0@#16 = "B01";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "B02";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "B03";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "B04";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "B05";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "B06";  #tempora2@#19 = "I";  |FINSI;
         |SI #tempora0@#16 = "C01";  #tempora2@#19 = "3";  |FINSI;
         |SI #tempora0@#16 = "C02";  #tempora2@#19 = "2";  |FINSI;
         |SI #tempora0@#16 = "C03";  #tempora2@#19 = "2";  |FINSI;
         |SI #tempora0@#16 = "C04";  #tempora2@#19 = "1";  |FINSI;
         |SI #tempora0@#16 = "C06";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "C07";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "C12";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D01";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D02";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D03";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D04";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D05";  #tempora2@#19 = "O";  |FINSI;
         |SI #tempora0@#16 = "D06";  #tempora2@#19 = "O";  |FINSI;
     |FINSI;

     |SI #tempora0@#5 = "rem00051";
         #tempora2@#17 = #tempora0@#8;
         #tempora2@#18 = "S";
         #tempora2@#19 = "V";
         #tempora2@#25 = -1;
         #tempora2@#26 = #tempora0@#13;
         #tempora2@#29 = #tempora0@#14;
     |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     |SI #tempora0@#5 = "rem00022";
         #tempora1@#8  = #tempora2@#17;
         #tempora1@#11 = "Base imponible ahorro: dividendos       ";
         #tempora1@#13 = #tempora2@#19;
         #tempora1@#14 = #tempora2@#24;
         #tempora1@#15 = #tempora2@#27;
     |FINSI;

     |SI #tempora0@#5 = "rem00023";
         #tempora1@#8  = #tempora2@#17;
         |SI #tempora2@#19 = "I";  #tempora1@#11 = "Intereses  cuentas, depositos y activo";    |FINSI;
         |SI #tempora2@#19 = "B";  #tempora1@#11 = "Intereses activos derecho a bonificacion";  |FINSI;
         |SI #tempora2@#19 = "C";  #tempora1@#11 = "Rdtos transmision, amortizacion o reemb.";  |FINSI;
         |SI #tempora2@#19 = "5";  #tempora1@#11 = "Rdtos causa de imposicion de capitales  ";  |FINSI;
         |SI #tempora2@#19 = "O";  #tempora1@#11 = "Otros rdtos de capital mobiliario       ";  |FINSI;
         |SI #tempora2@#19 = "F";  #tempora1@#11 = "Intereses activos financieros c/bonif.  ";  |FINSI;
         |SI #tempora2@#19 = "1";  #tempora1@#11 = "Rdtos arrendamientos, negocios o minas  ";  |FINSI;
         |SI #tempora2@#19 = "2";  #tempora1@#11 = "Rdtos prestacion de asistencia tecnica  ";  |FINSI;
         |SI #tempora2@#19 = "3";  #tempora1@#11 = "Rdtos de la propiedad intelectual       ";  |FINSI;
         |SI #tempora2@#19 = "4";  #tempora1@#11 = "Rdtos de la propiedad industrial        ";  |FINSI;
         #tempora1@#13 = #tempora2@#20;
         #tempora1@#14 = #tempora2@#22;
         #tempora1@#15 = #tempora2@#23;
     |FINSI;

     |SI #tempora0@#5 = "rem00051";
         #tempora1@#8  = #tempora2@#17;
         #tempora1@#11 = "Rentas temporales o vitalicias";
         #tempora1@#13 = #tempora2@#26;
         #tempora1@#14 = #tempora2@#29;
     |FINSI;

     #tempora1@#13 = #tempora2@#22;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroRI;
     aDef = aBase + "def/rem00023.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     #tempora2@#11 = "F2";
     #tempora2@#17 = #tempora0@#8;

                         #tempora2@#19 = "C";
     |SI #tempora0@#14 = "S";  #tempora2@#19 = "O";  |FINSI;

     |SI #tempora0@#12 < 0;
         #tempora2@#27 = -#tempora0@#12;
     |SINO;
         #tempora2@#28 = #tempora0@#12;
     |FINSI;

     #tempora2@#29 = #tempora2@#28 - #tempora2@#27;
     #tempora2@#31 = #tempora0@#13;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#8  = #tempora2@#17;

     |SI #tempora2@#29 < 0;  #tempora1@#12 = -#tempora2@#29;  |FINSI;
     |SI #tempora2@#29 ] 0;  #tempora1@#12 = #tempora2@#29;   |FINSI;

     #tempora1@#13 = #tempora2@#31;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroSG;
     aDef = aBase + "def/rem00024.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     |SI #tempora0@#12 ! 0;
         #tempora2@#13 = "S";
     |FINSI;

     #tempora2@#15 = #tempora0@#8;

     |SI #tempora0@#10 ] 0;
         #tempora2@#17 = #tempora0@#10;
         #tempora2@#18 = #tempora0@#10;
     |SINO;
         #tempora2@#16 = -#tempora0@#10;
         #tempora2@#18 = #tempora0@#10;
     |FINSI;

     #tempora2@#24 = #tempora0@#12;
     #tempora2@#20 = #tempora0@#11;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#8  = #tempora2@#15;
     #tempora1@#10 = #tempora2@#17;
     #tempora1@#11 = #tempora2@#20;
     #tempora1@#12 = #tempora2@#24;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO ChequeaInmueble;
     nError = 0;

     |ABRE #rem00021;
     |SELECT #3#rem00021;
     #rem00021#0  = #tempora0@#0;
     #rem00021#14 = #tempora0@#7;
     |LEE 000#rem00021.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00021;  |FINSI;
     |CIERRA #rem00021;

     aAlfa1 = #rem00021#14;   |QBF aAlfa1;
     aAlfa2 = #tempora0@#7;   |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;
         |ACABA;
     |FINSI;

     |SI #rem00021#2 = "GANANCIAL ";
         |MENAV "0000No puedo trasladar el registro. Ese inmueble est  en la renta como ganancial";
         nError = 1;
     |FINSI;

     |SI #rem00021#2 = "VARIOS    ";
         |SI #tempora0@#21 = 100;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "TITULAR";  |Y #rem00021#5 ! #tempora0@#21;  |Y #rem00021#5 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "CONYUGE";  |Y #rem00021#6 ! #tempora0@#21; |Y #rem00021#6 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "1 FAMILIAR";  |Y #rem00021#7 ! #tempora0@#21;  |Y #rem00021#7 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "2 FAMILIAR";  |Y #rem00021#8 ! #tempora0@#21;  |Y #rem00021#8 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "3 FAMILIAR";  |Y #rem00021#9 ! #tempora0@#21;  |Y #rem00021#9 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;

         |SI aContri = "4 FAMILIAR";  |Y #rem00021#10 ! #tempora0@#21;  |Y #rem00021#10 ! 0;
             |MENAV "0000No puedo trasladar el registro. Ese inmueble ya existe en la renta";
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #rem00021#2 = "TITULAR   "; |O #rem00021#2 = "CONYUGE   ";
         |MENAV "0000No puedo trasladar el registro. Este inmueble ya existe.";
         nError = 1;
         |ACABA;
     |FINSI;

     |SI #rem00021#3 = "X";
         |MENAV "0000El registro ya existe en la renta. Pero no est  activo. Act¡velo o b¢rrelo";
         nError = 1;
         |ACABA;
     |FINSI;

     nLinea = #rem00021#1;
|FPRC;

|PROCESO PasaRegistroUR;
     aAlfa  = #tempora0@#7;  |QBF aAlfa;
     nLinea = 0;

     |SI aAlfa ! "";
         |HAZ ChequeaInmueble;
         |SI nError = 1;  nLinea = 0;  |ACABA;  |FINSI;
     |FINSI;

     aDef = aBase + "def/rem00021.mas";
     |CARGA_DEF aDef, tempora2@;

     |ABRE #tempora2@;
     |SI nLinea = 0;
         nLinea = 1;

         #tempora2@#0 = #rem05000#0;
         |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
               #tempora2@#1 = nLinea;
               |LEE 000#tempora2@.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |FINSI;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     |LEE 101#tempora2@.=;
     |SI FSalida ! 0;
         |DDEFECTO #tempora2@;
         #tempora2@#0  = #rem05000#0;
         #tempora2@#1  = nLinea;
         |GRABA 020#tempora2@.b;
     |FINSI;

     |SI #tempora0@#21 = 100;
         #tempora2@#2  = aContri;
     |SINO;
         #tempora2@#2  = "VARIOS";
         |SI aContri = "TITULAR";     #tempora2@#5  = #tempora0@#21;  |FINSI;
         |SI aContri = "CONYUGE";     #tempora2@#6  = #tempora0@#21;  |FINSI;
         |SI aContri = "1 FAMILIAR";  #tempora2@#7  = #tempora0@#21;  |FINSI;
         |SI aContri = "2 FAMILIAR";  #tempora2@#8  = #tempora0@#21;  |FINSI;
         |SI aContri = "3 FAMILIAR";  #tempora2@#9  = #tempora0@#21;  |FINSI;
         |SI aContri = "4 FAMILIAR";  #tempora2@#10 = #tempora0@#21;  |FINSI;
     |FINSI;

     #tempora2@#3   = "A";
     #tempora2@#13  = #tempora0@#8;
                           #tempora2@#125 = 1;
     |SI #tempora0@#25 = "2";    #tempora2@#125 = 2;  |FINSI;

     #tempora2@#14  = #tempora0@#7;

     |SI #tempora0@#19 = "PR";  #tempora2@#104 = "P";  |FINSI;
     |SI #tempora0@#19 = "US";  #tempora2@#104 = "U";  |FINSI;
     |SI #tempora0@#19 = "NP";  #tempora2@#104 = "N";  |FINSI;
     |SI #tempora0@#19 = "DF";  #tempora2@#104 = "M";  |FINSI;

     aAlfa = #tempora0@#9 % 102;  #tempora2@#105 = aAlfa;
     aAlfa = #tempora0@#9 % 303;  #tempora2@#106 = aAlfa;

     #tempora2@#17 = #tempora0@#18;
     #tempora2@#18 = "O";

     |SI #tempora0@#13 = "A";  #tempora2@#18 = "U";  |FINSI;
     |SI #tempora0@#13 = "V";  #tempora2@#18 = "U";  |FINSI;
     |SI #tempora0@#13 = "I";  #tempora2@#18 = "L";  |FINSI;
     |SI #tempora0@#13 = "O";  #tempora2@#18 = "L";  |FINSI;
     |SI #tempora0@#13 = "C";  #tempora2@#18 = "L";  |FINSI;
     |SI #tempora0@#13 = "M";  #tempora2@#18 = "S";  |FINSI;
     |SI #tempora0@#13 = "K";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "T";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "G";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "Y";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "E";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "R";  #tempora2@#18 = "O";  |FINSI;
     |SI #tempora0@#13 = "M";  #tempora2@#18 = "S";  |FINSI;
     |SI #tempora0@#13 = "P";  #tempora2@#18 = "U";  |FINSI;
     |SI #tempora0@#13 = "B";  #tempora2@#18 = "L";  |FINSI;
     |SI #tempora0@#13 = "J";  #tempora2@#18 = "L";  |FINSI;
     |SI #tempora0@#13 = "Z";  #tempora2@#18 = "L";  |FINSI;

     #tempora2@#15 = #tempora0@#17;

     |SI #tempora0@#23 = "H";
         #tempora2@#30 = #tempora0@#22;
         #tempora2@#141 = "";
     |FINSI;

     |SI #tempora0@#23 = "A";
         #tempora2@#31  = #tempora0@#22;
         #tempora2@#141 = "1";
     |FINSI;

     |SI #tempora0@#23 = "O";
         #tempora2@#32  = #tempora0@#22;
         #tempora2@#141 = "2";
     |FINSI;

     |SI #tempora0@#23 = "C";
         |MENAV "0000Inmueble con d¡as en habitual y en alquiler. A continuaci¢n introduzca los d¡as que ha estado en habitual";

         |VENTANA 0501, 0715, -1, 16, "D¡as en habitual";
         nVentanita  = FSalida;
         |PARA;  |SI;  |HACIENDO;
              E_inf    = 1;
              E_sup    = 365;
              nDiasHab = 0607 ? 1;
              |SI nDiasHab < #tempora0@#22; |Y nDiasHab ! 0; |SAL;  |FINSI;
              |MENAV "0000Los d¡as deben ser menor a los d¡as informados en el borrador";
         |SIGUE;
         |FINVENTANA nVentanita;

         #tempora2@#30  = nDiasHab;
         #tempora2@#31  = #tempora0@#22 - nDiasHab;
         #tempora2@#141 = "3";
     |FINSI;

     |GRABA 020#tempora2@.a;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     #tempora1@#7  = #tempora2@#14;
     #tempora1@#8  = #tempora2@#13;
     aAlfa   = (("00" + #tempora2@#105) % -102) + (("000" + #tempora2@#106) % -103);
     #tempora1@#9  = aAlfa;

     |SI #tempora2@#18 = "R";  |O #tempora2@#18 = "T";
         #tempora1@#11 = "RU";
         #tempora1@#12 = "R£stica";
     |SINO;
         #tempora1@#11 = "UR";
         #tempora1@#12 = "Urbana";
     |FINSI;

     #tempora1@#13 = " ";
     #tempora1@#14 = "No existe el dato";
     #tempora1@#15 = "  ";
     #tempora1@#16 = "No existe el dato";
     #tempora1@#17 = #tempora2@#15;
     #tempora1@#18 = #tempora2@#17;

     |SI #tempora2@#104 = "P";
         #tempora1@#19 = "PR";
         #tempora1@#20 = "Propietario";
     |FINSI;

     |SI #tempora2@#104 = "U";
         #tempora1@#19 = "US";
         #tempora1@#20 = "Usufructuario";
     |FINSI;

     |SI #tempora2@#104 = "N";
         #tempora1@#19 = "NP";
         #tempora1@#20 = "Nuda propiedad";
     |FINSI;

     |SI #tempora2@#104 = "M";
         #tempora1@#19 = "DF";
         #tempora1@#20 = "Disfrutador";
     |FINSI;

     nPorce = 100;

     |SI #tempora2@#2 = "GANANCIAL ";  nPorce = 50;  |FINSI;

     |SI #tempora2@#2 = "VARIOS    ";
         |SI aContri = "TITULAR";     nPorce = #tempora2@#5;  |FINSI;
         |SI aContri = "CONYUGE";     nPorce = #tempora2@#6;  |FINSI;
         |SI aContri = "1 FAMILIAR";  nPorce = #tempora2@#7;  |FINSI;
         |SI aContri = "2 FAMILIAR";  nPorce = #tempora2@#8;  |FINSI;
         |SI aContri = "3 FAMILIAR";  nPorce = #tempora2@#9;  |FINSI;
         |SI aContri = "4 FAMILIAR";  nPorce = #tempora2@#10; |FINSI;
     |FINSI;

     #tempora1@#21 = nPorce;

     #tempora1@#22 = #tempora2@#30 + #tempora2@#31 + #tempora2@#32 + #tempora2@#33 + #tempora2@#34 + #tempora2@#35;

     nDiasHab = #tempora2@#30 + #tempora2@#33;
     nDiasAlq = #tempora2@#31 + #tempora2@#34;

     #tempora1@#23 = "O";
     #tempora1@#24 = "Otros";

     |SI nDiasHab ! 0;  |Y nDiasAlq = 0;
         #tempora1@#23 = "H";
         #tempora1@#24 = "Vivienda habitual";
     |FINSI;

     |SI nDiasHab = 0;  |Y nDiasAlq ! 0;
         #tempora1@#23 = "A";
         #tempora1@#24 = "Arrendada";
     |FINSI;

     |SI nDiasHab ! 0;  |Y nDiasAlq ! 0;
         #tempora1@#23 = "C";
         #tempora1@#24 = "Habitual y Arrendada";
     |FINSI;

     #tempora1@#25 = "1";
     #tempora1@#26 = "Inmuebles en territorio com£n";

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroPF;
     |SI #tempora0@#12 = 0;
         |MENAV "0000El resultado es cero. No se traslada el registro.";
         |ACABA;
     |FINSI;

     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     aAlfa   = #tempora0@#9;  |QBF aAlfa;

     |SI aAlfa = "01";  #tempora2@#11 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "02";  #tempora2@#11 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "03";  #tempora2@#11 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "04";  #tempora2@#12 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "05";  #tempora2@#12 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "06";  #tempora2@#12 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "07";  #tempora2@#13 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "08";  #tempora2@#13 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "09";  #tempora2@#13 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "10";  #tempora2@#14 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "11";  #tempora2@#14 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "12";  #tempora2@#14 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "1T";  #tempora2@#11 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "2T";  #tempora2@#12 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "3T";  #tempora2@#13 = #tempora0@#12;  |FINSI;
     |SI aAlfa = "4T";  #tempora2@#14 = #tempora0@#12;  |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = "";
     #tempora1@#8  = "Dato desconocido";

     aAlfa   = "";
     |SI #tempora2@#11 ! 0; aAlfa = aAlfa + "1P ";  |FINSI;
     |SI #tempora2@#12 ! 0; aAlfa = aAlfa + "2P ";  |FINSI;
     |SI #tempora2@#13 ! 0; aAlfa = aAlfa + "3P ";  |FINSI;
     |SI #tempora2@#14 ! 0; aAlfa = aAlfa + "4P ";  |FINSI;
     #tempora1@#9  = aAlfa;
     #tempora1@#10 = "";
     #tempora1@#11 = "";
     #tempora1@#12 = #tempora2@#11 + #tempora2@#12 + #tempora2@#13 + #tempora2@#14;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroDN;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";

     |SI #tempora0@#15 = 15;    #tempora2@#11 = 1;  |FINSI;
     |SI #tempora0@#15 = 55;    #tempora2@#11 = 2;  |FINSI;
     |SI #tempora0@#15 = 50;    #tempora2@#11 = 3;  |FINSI;
     |SI #tempora0@#15 = 27.5;  #tempora2@#11 = 3;  |FINSI;
     |SI #tempora0@#15 = 32.5;  #tempora2@#11 = 4;  |FINSI;
     |SI #tempora0@#15 = 10;    #tempora2@#11 = 5;  |FINSI;
     |SI #tempora0@#15 = 20;    #tempora2@#11 = 6;  |FINSI;
     |SI #tempora0@#15 = 37.5;  #tempora2@#11 = 7;  |FINSI;

     #tempora2@#12 = #tempora0@#8;
     #tempora2@#13 = #tempora0@#13;
     #tempora2@#14 = #tempora0@#15;
     #tempora2@#15 = #tempora0@#13 % #tempora2@#14;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#8  = #tempora2@#12;
     #tempora1@#9  = "";
     #tempora1@#10 = "Donativo";
     #tempora1@#13 = #tempora2@#13;
     #tempora1@#15 = #tempora2@#14;
     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroDM;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#11 = "1";
     #tempora2@#14 = #tempora0@#9;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = "";
     #tempora1@#8  = 0;
     #tempora1@#9  = #tempora2@#14;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaAlTrabajo;
     |ABRE #rem00020;
     #rem00020#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #rem00020#1 = nLinea;
           |LEE 000#rem00020.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #rem00020;
         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #rem00020;
     #rem00020#0  = #rem05000#0;
     #rem00020#1  = nLinea;
     #rem00020#2  = aContri;
     #rem00020#3  = "A";
     #rem00020#5  = #tempora0@#8;
     #rem00020#13 = #tempora2@#11;
     #rem00020#16 = #tempora2@#15 + #tempora2@#18;

     #rem00020#12 = #rem00020#9  + #rem00020#10 - #rem00020#11;
     #rem00020#23 = #rem00020#19 + #rem00020#20 + #rem00020#21 + #rem00020#22;
     #rem00020#24 = #rem00020#7  + #rem00020#12 + #rem00020#34 + #rem00020#16 + #rem00020#28 - #rem00020#18 - #rem00020#23;
     #rem00020#36 = 0;

     |SI #rem00020#35 = "S";
         #rem00020#36 = #rem00020#24 % 65;
     |FINSI;

     #rem00020#37 = #rem00020#24 - #rem00020#36;

     |GRABA 020#rem00020.n;
     |LIBERA #rem00020;
     |CIERRA #rem00020;

     #tempora2@#21 = "S";
     #tempora2@#22 = #rem00020#1;
     #tempora2@#28 = eaAzul;
|FPRC;

|PROCESO PasaRegistroPP;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#24 = "N";

     |SI nLinea = 1;
         #tempora2@#24 = "P";
     |FINSI;

     #tempora2@#11 = #tempora0@#8;
     aAlfa   = #tempora0@#13;  |QBF aAlfa;
     |SI aAlfa = "000000000";  aAlfa = "";  |FINSI;

     |SI aAlfa = "";
         #tempora2@#12 = "N";
         #tempora2@#15 = #tempora0@#12;
         #tempora2@#16 = #tempora0@#11 - #tempora0@#12;
         |SI #tempora2@#16 < 0;  #tempora2@#16 = 0;  |FINSI;
     |SINO;
         #tempora2@#12 = "S";
         #tempora2@#13 = "S";
         #tempora2@#17 = #tempora0@#13;
         #tempora2@#18 = #tempora0@#12;
         #tempora2@#19 = #tempora0@#11 - #tempora0@#12;
     |FINSI;

     |SI #tempora2@#15 ! 0;  |O #tempora2@#18 ! 0;
         |HAZ PasaAlTrabajo;
     |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     #tempora1@#8  = #tempora2@#11;
     #tempora1@#9  = "Dato desconocido";
     #tempora1@#10 = "Dato desconocido";

     |SI #tempora2@#12 = "N";
          #tempora1@#11 = #tempora2@#16;
          #tempora1@#12 = #tempora2@#15;
     |SINO;
          #tempora1@#11 = #tempora2@#19;
          #tempora1@#12 = #tempora2@#18;
          #tempora1@#13 = #tempora2@#17;
     |FINSI;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;

|FPRC;

|PROCESO PasaRegistroCU;
     aDef = aBase + "def/" + #tempora0@#5 + ".mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#11 = 21;
     #tempora2@#12 = "Datos ficales borrador";
     #tempora2@#14 = #tempora0@#7;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |MENAV "0000Debe informar manualmente la deducci¢n que pueda tener derecho en la casilla 758";

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora2@#14;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroLT;
     aDef = aBase + "def/rem00052.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#11 = "F2";
     #tempora2@#16 = #tempora0@#8;
     #tempora2@#17 = #tempora0@#10;
     #tempora2@#18 = #tempora0@#12;
     #tempora2@#19 = #tempora0@#11;
     #tempora2@#20 = #tempora0@#9;

     aAlfa1      = #tempora2@#17 % -104;
     aAlfa2      = #tempora2@#17 % 0105;
     nAnyoCompra = aAlfa1;
     |SI aAlfa2 = "31.12";  nAnyoCompra = nAnyoCompra + 1;  |FINSI;

     #tempora2@#21 = #tempora2@#19 - #tempora2@#20;

     |SI #tempora2@#17 < "31.12.1996";
         |SI #tempora2@#21 < 0;
             #tempora2@#22 = -#tempora2@#21;
             #tempora2@#23 = 0;
             #tempora2@#24 = 0;
         |SINO;
             #tempora2@#23 = (1996 - nAnyoCompra) + 1;
             #tempora2@#24 = #tempora2@#21;
             #tempora2@#22 = 0;
         |FINSI;
     |SINO;
         |SI #tempora2@#21 < 0;
             #tempora2@#22 = -#tempora2@#21;
             #tempora2@#23 = 0;
             #tempora2@#24 = 0;
         |SINO;
             #tempora2@#24 = #tempora2@#21;
             #tempora2@#22 = 0;
             #tempora2@#23 = 0;
         |FINSI;
     |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     #tempora1@#8  = #tempora2@#16;
     #tempora1@#9  = #tempora2@#20;
     #tempora1@#10 = #tempora2@#17;
     #tempora1@#11 = #tempora2@#19;
     #tempora1@#12 = #tempora2@#18;
     #tempora1@#14 = #tempora2@#21;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroEV;
     aDef = aBase + "def/rem00030.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#13 = #tempora0@#9;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#9  = #tempora2@#13;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroEA;
     aDef = aBase + "def/rem00058.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#12 = #tempora0@#7;
     #tempora2@#13 = "1";
     #tempora2@#17 = #tempora0@#10;
     #tempora2@#19 = #tempora0@#11;
     #tempora2@#20 = #tempora2@#17 - #tempora2@#18 - #tempora2@#19;
     #tempora2@#21 = #tempora0@#12;
     #tempora2@#45 = #tempora0@#13;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11
     #tempora1@#12 = #tempora0@#12;
     #tempora1@#13 = #tempora0@#13;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroEB;
     aDef = aBase + "def/rem00058.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#12 = #tempora0@#7;
     #tempora2@#13 = "2";
     #tempora2@#23 = #tempora0@#9;
     #tempora2@#25 = #tempora0@#10;
     #tempora2@#26 = #tempora2@#23 - #tempora2@#24 - #tempora2@#25;
     #tempora2@#45 = #tempora0@#11;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroEC;
     aDef = aBase + "def/rem00058.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#12 = #tempora0@#7;
     #tempora2@#13 = "3";
     #tempora2@#27 = #tempora0@#9;
     #tempora2@#29 = #tempora0@#10;
     #tempora2@#30 = #tempora2@#27 - #tempora2@#28 - #tempora2@#29;
     #tempora2@#45 = #tempora0@#11;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroED;
     aDef = aBase + "def/rem00058.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#12 = #tempora0@#7;
     #tempora2@#13 = "4";
     #tempora2@#45 = #tempora0@#13;

     |SI #tempora0@#9 = "F";
         |SI #tempora0@#10 = "01";  #tempora2@#31 = #tempora0@#12;  |FINSI;
         |SI #tempora0@#10 = "02";  #tempora2@#32 = #tempora0@#12;  |FINSI;
     |FINSI;

     |SI #tempora0@#9 = "G";
         |SI #tempora0@#10 = "01";  #tempora2@#33 = #tempora0@#12;  |FINSI;
         |SI #tempora0@#10 = "02";  #tempora2@#44 = #tempora0@#12;  |FINSI;
     |FINSI;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora0@#10;
     #tempora1@#11 = #tempora0@#11
     #tempora1@#12 = #tempora0@#12;
     #tempora1@#13 = #tempora0@#13;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroSB;
     aDef = aBase + "def/rem00030.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#13 = #tempora0@#10;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;
     #tempora1@#7  = #tempora0@#7;
     #tempora1@#8  = #tempora0@#8;
     #tempora1@#9  = #tempora0@#9;
     #tempora1@#10 = #tempora2@#13;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroFA;
     aDef = aBase + "def/rem00065.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#11 = "4";
     #tempora2@#40 = "1";
     |SI #tempora0@#9 = "E";  #tempora2@#40 = "2";  |FINSI;
     #tempora2@#39 = #tempora0@#10;
     #tempora2@#43 = #tempora0@#11;
     #tempora2@#41 = #tempora0@#12;
     |SI #tempora0@#13 ] "01.01.2015";  |Y #tempora0@#13 [ "31.12.2015";
         #tempora2@#42 = #tempora0@#13;
     |FINSI;
     #tempora2@#51 = #tempora0@#15;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     |PARA nCampo = 7;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           #tempora1@#nCampo# = #tempora0@#nCampo#;
     |SIGUE;

     |SI #tempora2@#40 = "1";  #tempora1@#9  = "G";  |FINSI;
     |SI #tempora2@#40 = "2";  #tempora1@#9  = "E";  |FINSI;

     #tempora1@#11 = #tempora2@#43;
     #tempora1@#12 = #tempora2@#41;
     #tempora1@#13 = #tempora2@#42;
     #tempora1@#15 = #tempora2@#51;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistroDD;
     aDef = aBase + "def/rem00065.mas";
     |CARGA_DEF aDef, tempora2@;

     nLinea = 1;

     |ABRE #tempora2@;
     #tempora2@#0 = #rem05000#0;
     |PARA nLinea = 1;  |SI nLinea [ 100;  |HACIENDO nLinea = nLinea + 1;
           #tempora2@#1 = nLinea;
           |LEE 000#tempora2@.=;
           |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;

     |SI nLinea = 100;
         |CIERRA #tempora2@;
         |DESCARGA_DEF #tempora2@;

         |MENAV "0000Excedido el n£mero de registros";
         |ACABA;
     |FINSI;

     |DDEFECTO #tempora2@;
     #tempora2@#0  = #rem05000#0;
     #tempora2@#1  = nLinea;
     #tempora2@#2  = aContri;
     #tempora2@#3  = "A";
     #tempora2@#11 = "2";
     #tempora2@#15 = #tempora0@#7;
     #tempora2@#16 = #tempora0@#8;
     #tempora2@#17 = #tempora0@#9;

     |SI #tempora0@#10 ] "01.01.2015";  |Y #tempora0@#10 [ "31.12.2015";
         #tempora2@#18 = #tempora0@#10;
     |FINSI;

     #tempora2@#25 = #tempora0@#12;

     |GRABA 020#tempora2@.n;
     |LIBERA #tempora2@;
     |CIERRA #tempora2@;

     |HAZ BuscaLinea1;

     |DDEFECTO #tempora1@;

     #tempora1@#0  = #tempora0@#0;
     #tempora1@#1  = #tempora0@#1;
     #tempora1@#2  = nLinea1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#5  = #tempora0@#5;
     #tempora1@#6  = nLinea;

     |PARA nCampo = 7;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           #tempora1@#nCampo# = #tempora0@#nCampo#;
     |SIGUE;

     #tempora1@#7  = #tempora2@#15;
     #tempora1@#8  = #tempora2@#16;
     #tempora1@#9  = #tempora2@#17;
     #tempora1@#10 = #tempora2@#18;
     #tempora1@#12 = #tempora2@#25;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO PasaRegistro;
     |SI nMasivo = 0;
         |CONFI "0000NUsted est  pasando el registro a la renta. Est  seguro";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     nLinea = 0;
     |SI aClave = "TI"; |HAZ PasaRegistroTI;  |FINSI;
     |SI aClave = "DE"; |HAZ PasaRegistroDE;  |FINSI;
     |SI aClave = "RT"; |HAZ PasaRegistroRT;  |FINSI;
     |SI aClave = "RB"; |HAZ PasaRegistroRB;  |FINSI;
     |SI aClave = "RC"; |HAZ PasaRegistroRC;  |FINSI;
     |SI aClave = "CB"; |HAZ PasaRegistroCB;  |FINSI;
     |SI aClave = "RE"; |HAZ PasaRegistroRE;  |FINSI;
     |SI aClave = "RI"; |HAZ PasaRegistroRI;  |FINSI;
     |SI aClave = "DN"; |HAZ PasaRegistroDN;  |FINSI;
     |SI aClave = "SG"; |HAZ PasaRegistroSG;  |FINSI;
     |SI aClave = "UR"; |HAZ PasaRegistroUR;  |FINSI;
     |SI aClave = "PF"; |HAZ PasaRegistroPF;  |FINSI;
     |SI aClave = "DM"; |HAZ PasaRegistroDM;  |FINSI;
     |SI aClave = "PP"; |HAZ PasaRegistroPP;  |FINSI;
     |SI aClave = "CU"; |HAZ PasaRegistroCU;  |FINSI;
     |SI aClave = "LT"; |HAZ PasaRegistroLT;  |FINSI;
     |SI aClave = "EV"; |HAZ PasaRegistroEV;  |FINSI;
     |SI aClave = "EA"; |HAZ PasaRegistroEA;  |FINSI;
     |SI aClave = "EB"; |HAZ PasaRegistroEB;  |FINSI;
     |SI aClave = "EC"; |HAZ PasaRegistroEC;  |FINSI;
     |SI aClave = "ED"; |HAZ PasaRegistroED;  |FINSI;
     |SI aClave = "SB"; |HAZ PasaRegistroSB;  |FINSI;
     |SI aClave = "FA"; |HAZ PasaRegistroFA;  |FINSI;
     |SI aClave = "DD"; |HAZ PasaRegistroDD;  |FINSI;

     || Aqui insertar

     |SI nLinea = 0;  |ACABA;  |FINSI;

     |LEE 101#tempora0@.=;

     #tempora0@#3 = aVerde;
     #tempora0@#4 = "En renta";
     #tempora0@#6 = nLinea;
     |GRABA 020#tempora0@.a;
     |LIBERA #tempora0@;

     |SI nMasivo = 0;
         |REFRESCACONTROL nGrid1;
         |REFRESCACONTROL nGrid2;
     |FINSI;

     |SI nLinea = 100;  |Y nMasivo = 1;
         |ERROR10;
     |FINSI;
|FPRC;

|PROCESO Evento900;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#tempora0@.=;
     |FINSI;

     |SI FSalida = 4;
         |SI nModo = 4;
             |MENAV "0000Est  en modo consulta. Acci¢n cancelada.";
             |ACABA;
         |FINSI;

         aAlfa = #tempora0@#4;  |QBF aAlfa;
         |SI aAlfa = "No trasladable";
             |MENAV "0000Registro no trasladable";
             |ACABA;
         |FINSI;

         |SI aAlfa = "En renta";
             |MENAV "0000El registro est  ya en renta";
             |ACABA;
         |FINSI;

         nMasivo = 0;
         |HAZ PasaRegistro;
     |FINSI;
|FPRC;

|PROCESO Desanula;
     |SI nMasivo = 0;
         |CONFI "0000NUsted est  activando el registro. Est  seguro";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     aDef = aBase + "def/" + #tempora1@#5 + ".mas";

     |CARGA_DEF aDef, tempora2@;

     |ABRE #tempora2@;
     #tempora2@#0 = #tempora1@#0;
     #tempora2@#1 = #tempora1@#6;
     |LEE 101#tempora2@.=;
     |SI FSalida = 0;
         #tempora2@#3 = "A";
         |GRABA 020#tempora2@.a;
         |LIBERA #tempora2@;
     |FINSI;
     |CIERRA #tempora2@;

     |SI aClave = "PP";
         |SI #tempora2@#21 = "S";
             |ABRE #rem00020;
             #rem00020#0 = #rem05000#0;
             #rem00020#1 = #tempora2@#22;
             |LEE 101#rem00020.=;
             |SI FSalida = 0;
                 #rem00020#3 = "A";
                 |GRABA 020#rem00020.a;
                 |LIBERA #rem00020;
             |FINSI;
             |CIERRA #rem00020;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #tempora2@;

     |LEE 101#tempora1@.=;

     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     |GRABA 020#tempora1@.a;
     |LIBERA #tempora1@;

     |SI nMasivo = 0;
         |REFRESCACONTROL nGrid2;
     |FINSI;
|FPRC;

|PROCESO Anula;
     |SI aClave = "TI";  |ACABA;  |FINSI;

     |SI nMasivo = 0;
         |CONFI "0000NUsted est  anulando el registro. Est  seguro";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     aDef = aBase + "def/" + #tempora1@#5 + ".mas";

     |CARGA_DEF aDef, tempora2@;

     |SI aClave = "DE";  aDef = aBase + "def/rem05032.mas";  |FINSI;
     |SI aClave = "RT";  aDef = aBase + "def/rem05001.mas";  |FINSI;
     |SI aClave = "RB";  aDef = aBase + "def/rem05030.mas";  |FINSI;
     |SI aClave = "RC";  aDef = aBase + "def/rem05008.mas";  |FINSI;
     |SI aClave = "CB";  aDef = aBase + "def/rem05002.mas";  |FINSI;
     |SI aClave = "RE";  aDef = aBase + "def/rem05003.mas";  |FINSI;
     |SI aClave = "RI";  aDef = aBase + "def/rem05029.mas";  |FINSI;
     |SI aClave = "SG";  aDef = aBase + "def/rem05005.mas";  |FINSI;
     |SI aClave = "UR";  aDef = aBase + "def/rem05007.mas";  |FINSI;
     |SI aClave = "PF";  aDef = aBase + "def/rem05009.mas";  |FINSI;
     |SI aClave = "DN";  aDef = aBase + "def/rem05010.mas";  |FINSI;
     |SI aClave = "DM";  aDef = aBase + "def/rem05013.mas";  |FINSI;
     |SI aClave = "PP";  aDef = aBase + "def/rem05014.mas";  |FINSI;
     |SI aClave = "CU";  aDef = aBase + "def/rem05019.mas";  |FINSI;
     |SI aClave = "LT";  aDef = aBase + "def/rem05021.mas";  |FINSI;
     |SI aClave = "EV";  aDef = aBase + "def/rem05023.mas";  |FINSI;
     |SI aClave = "EA";  aDef = aBase + "def/rem05025.mas";  |FINSI;
     |SI aClave = "EB";  aDef = aBase + "def/rem05026.mas";  |FINSI;
     |SI aClave = "EC";  aDef = aBase + "def/rem05027.mas";  |FINSI;
     |SI aClave = "ED";  aDef = aBase + "def/rem05028.mas";  |FINSI;
     |SI aClave = "SB";  aDef = aBase + "def/rem05034.mas";  |FINSI;
     |SI aClave = "FA";  aDef = aBase + "def/rem05035.mas";  |FINSI;
     |SI aClave = "DD";  aDef = aBase + "def/rem05036.mas";  |FINSI;

     || Aqui insertar

     |CARGA_DEF aDef, tempora3@;

     |ABRE #tempora2@;
     #tempora2@#0 = #tempora1@#0;
     #tempora2@#1 = #tempora1@#6;
     |LEE 101#tempora2@.=;

     |LEE 101#tempora1@.=;

     |ABRE #tempora3@;
     |SELECT #2#tempora3@;
     #tempora3@#0 = #tempora1@#0;
     #tempora3@#1 = #tempora1@#1;
     #tempora3@#6 = #tempora1@#6;
     |LEE 101#tempora3@.=;
     |SI FSalida = 0;
         #tempora3@#3  = aNegro;
         #tempora3@#4  = "Pendiente";
         #tempora3@#6  = 0;
         |GRABA 020#tempora3@.a;
         |LIBERA #tempora3@;

         |BORRA 020#tempora1@.a;
         |LIBERA #tempora1@;

         |BORRA 020#tempora2@.a;
         |LIBERA #tempora2@;

         |SI aClave = "PP";
             |SI #tempora2@#21 = "S";
                 |ABRE #rem00020;
                 #rem00020#0 = #rem05000#0;
                 #rem00020#1 = #tempora2@#22;
                 |LEE 101#rem00020.=;
                 |SI FSalida = 0;
                     |BORRA 020#rem00020.a;
                     |LIBERA #rem00020;
                 |FINSI;
                 |CIERRA #rem00020;
             |FINSI;
         |FINSI;

         |SI nMasivo = 0;
             |REFRESCACONTROL nGrid1;
             |REFRESCACONTROL nGrid2;
         |FINSI;
     |SINO;
         |SI aClave ! "DE";
             #tempora1@#3  = aRojo;
             #tempora1@#4  = "Anulado";
             |GRABA 020#tempora1@.a;
             |LIBERA #tempora1@;

             #tempora2@#3 = "X";
             |GRABA 020#tempora2@.a;
             |LIBERA #tempora2@;
         |FINSI;

         |SI aClave = "DE";
             |BORRA 020#tempora1@.a;
             |LIBERA #tempora1@;

             |BORRA 020#tempora2@.a;
             |LIBERA #tempora2@;
         |FINSI;

         |SI aClave = "PP";
             |SI #tempora2@#21 = "S";
                 |ABRE #rem00020;
                 #rem00020#0 = #rem05000#0;
                 #rem00020#1 = #tempora2@#22;
                 |LEE 101#rem00020.=;
                 |SI FSalida = 0;
                     #rem00020#3 = "X";
                     |GRABA 020#rem00020.a;
                     |LIBERA #rem00020;
                 |FINSI;
                 |CIERRA #rem00020;
             |FINSI;
         |FINSI;

         |SI nMasivo = 0;
             |REFRESCACONTROL nGrid2;
         |FINSI;
     |FINSI;

     |CIERRA #tempora2@;
     |CIERRA #tempora3@;

     |DESCARGA_DEF #tempora3@;
     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO Evento1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#tempora1@.=;
     |FINSI;

     |SI FSalida = 4;
         |SI nModo = 4;
             |MENAV "0000Est  en modo consulta. Acci¢n cancelada.";
             |ACABA;
         |FINSI;

         nMasivo = 0;
         aAlfa   = #tempora1@#4;  |QBF aAlfa;
         |SI aAlfa = "Anulado";
             |HAZ Desanula;
         |SINO;
             |HAZ Anula;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja900;
     #tempora0@#0 = #rem05000#0;
     #tempora0@#1 = nContri;
     #tempora0@#2 = 001;
|FPRC;

|PROCESO Alta900;
     #tempora0@#0 = #rem05000#0;
     #tempora0@#1 = nContri;
     #tempora0@#2 = 999;
|FPRC;

|PROCESO DatosTitular;
     |ABRE #rem00019;
     #rem00019#0 = #rem05000#0;
     #rem00019#1 = "TITULAR";
     |LEE 000#rem00019.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;
     |CIERRA #rem00019;

     enCodProv = #rem00100#20;
     enCodPobl = #rem00100#21;
     |HAZ LeePoblacion;

     |DDEFECTO #tempora1@;
     #tempora1@#0  = #rem05000#0;
     #tempora1@#1  = nContri;
     #tempora1@#2  = 1;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#6  = 0;
     #tempora1@#8  = #rem00100#1;
     #tempora1@#9  = #rem00100#5;
     #tempora1@#10 = "";
     #tempora1@#11 = #rem00100#103;
     #tempora1@#13 = "";
     #tempora1@#15 = "";
     #tempora1@#16 = "";
     #tempora1@#17 = "";
     #tempora1@#18 = #rem00100#53;
     #tempora1@#19 = "20";
     #tempora1@#20 = #rem00100#14;
     #tempora1@#21 = #rem00100#15;
     #tempora1@#22 = #rem00100#114;
     #tempora1@#23 = #rem00100#16;
     #tempora1@#24 = #rem00100#115;
     #tempora1@#25 = #rem00100#116;
     #tempora1@#26 = #rem00100#117;
     #tempora1@#27 = #rem00100#17;
     #tempora1@#28 = #rem00100#18;
     #tempora1@#29 = #rem00100#19;
     #tempora1@#30 = #rem00100#118;
     #tempora1@#31 = #rem00100#22;
     #tempora1@#32 = #rem00100#23;
     #tempora1@#34 = #poblaci@#2;
     #tempora1@#35 = #rem00100#12;
     #tempora1@#36 = #rem00100#109;
     #tempora1@#37 = #rem00100#112;

     |SI #rem00100#8 > 33;  |Y #rem00100#8 [ 65;
         #tempora1@#10 = "1";
         |SI #rem00100#9 = "S";
             #tempora1@#10 = "2";
         |FINSI;
     |FINSI;

     |SI #rem00100#8 > 65;
         #tempora1@#10 = "3";
     |FINSI;

     |SI #rem00100#105 = "V";  #tempora1@#12 = "HOMBRE";  |FINSI;
     |SI #rem00100#105 = "M";  #tempora1@#12 = "MUJER" ;  |FINSI;

     |SI #rem00100#91 = "T";
         #tempora1@#13 = #rem00100#92;
     |FINSI;

     aAlfa = ("00" + #rem00100#20) % -102;  #tempora1@#7  = aAlfa;
     aAlfa = ("00" + #rem00100#11) % -102;  #tempora1@#14 = aAlfa;
     aAlfa = ("00" + #rem00100#20) % -102;  #tempora1@#33 = aAlfa;

     |SI #rem00019#2 = "S";
         #tempora1@#15 = "1";
     |FINSI;

     |SI #rem00019#3 = "S";
         #tempora1@#16 = "1";
     |FINSI;

     |SI #rem00100#113 = "S";
         #tempora1@#19 = "21";
     |FINSI;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;
|FPRC;

|PROCESO DatosConyuge;
     |ABRE #rem00019;
     #rem00019#0 = #rem05000#0;
     #rem00019#1 = "CONYUGE";
     |LEE 000#rem00019.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00019; |FINSI;
     |CIERRA #rem00019;

     enCodProv = #rem00100#50;
     enCodPobl = #rem00100#51;
     |HAZ LeePoblacion;

     |DDEFECTO #tempora1@;
     #tempora1@#0  = #rem05000#0;
     #tempora1@#1  = nContri;
     #tempora1@#2  = 2;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     #tempora1@#6  = 0;
     #tempora1@#8  = #rem00100#35;
     #tempora1@#9  = #rem00100#39;
     #tempora1@#10 = "";
     #tempora1@#11 = #rem00100#104;
     #tempora1@#13 = "          ";
     #tempora1@#15 = "";
     #tempora1@#16 = "";
     #tempora1@#17 = "";
     #tempora1@#18 = #rem00100#54;
     #tempora1@#19 = "20";
     #tempora1@#20 = #rem00100#44;
     #tempora1@#21 = #rem00100#45;
     #tempora1@#22 = #rem00100#131;
     #tempora1@#23 = #rem00100#46;
     #tempora1@#24 = #rem00100#132;
     #tempora1@#25 = #rem00100#133;
     #tempora1@#26 = #rem00100#134;
     #tempora1@#27 = #rem00100#47;
     #tempora1@#28 = #rem00100#48;
     #tempora1@#29 = #rem00100#49;
     #tempora1@#30 = #rem00100#135;
     #tempora1@#31 = #rem00100#52;
     #tempora1@#34 = #poblaci@#2;
     #tempora1@#35 = #rem00100#13;
     #tempora1@#36 = #rem00100#110;
     #tempora1@#37 = #rem00100#129;

     |SI #rem00100#41 > 33;  |Y #rem00100#41 [ 65;
         #tempora1@#10 = "1";
         |SI #rem00100#42 = "S";
             #tempora1@#10 = "2";
         |FINSI;
     |FINSI;

     |SI #rem00100#41 > 65;
         #tempora1@#10 = "3";
     |FINSI;

     |SI #rem00100#106 = "V";  #tempora1@#12 = "HOMBRE";  |FINSI;
     |SI #rem00100#106 = "M";  #tempora1@#12 = "MUJER" ;  |FINSI;

     |SI #rem00100#91 = "C";
         #tempora1@#13 = #rem00100#92;
     |FINSI;

     aAlfa = ("00" + #rem00100#50) % -102;  #tempora1@#7  = aAlfa;
     aAlfa = ("00" + #rem00100#43) % -102;  #tempora1@#14 = aAlfa;
     aAlfa = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
                                            #tempora1@#32 = aAlfa;
     aAlfa = ("00" + #rem00100#50) % -102;  #tempora1@#33 = aAlfa;

     |SI #rem00019#2 = "S";
         #tempora1@#15 = "1";
     |FINSI;

     |SI #rem00019#3 = "S";
         #tempora1@#16 = "1";
     |FINSI;

     |SI #rem00100#130 = "S";
         #tempora1@#19 = "21";
     |FINSI;

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;
|FPRC;

|PROCESO DatosContribuyentes;
     |ABRE #rem00100;
     #rem00100#0 = #rem05000#0;
     |LEE 000#rem00100.=;
     |SI FSalida ! 0;
         |CIERRA #rem00100;
         |ACABA;
     |FINSI;
     |CIERRA #rem00100;

     |HAZ DatosTitular;

     |SI #rem00100#6 = "C";
         |HAZ DatosConyuge;
     |FINSI;
|FPRC;

|PROCESO CargaInmuebles;
     #tempora1@#7  = #tempora2@#14;
     #tempora1@#8  = #tempora2@#13;
     aAlfa   = (("00" + #tempora2@#105) % -102) + (("000" + #tempora2@#106) % -103);
     #tempora1@#9  = aAlfa;

     |SI #tempora2@#18 = "R";  |O #tempora2@#18 = "T";
         #tempora1@#11 = "RU";
         #tempora1@#12 = "R£stica";
     |SINO;
         #tempora1@#11 = "UR";
         #tempora1@#12 = "Urbana";
     |FINSI;

     #tempora1@#13 = "  ";
     #tempora1@#14 = "No existe el dato";
     #tempora1@#15 = "  ";
     #tempora1@#16 = "No existe el dato";
     #tempora1@#17 = #tempora2@#15;
     #tempora1@#18 = #tempora2@#17;

     |SI #tempora2@#104 = "P";
         #tempora1@#19 = "PR";
         #tempora1@#20 = "Propietario";
     |FINSI;

     |SI #tempora2@#104 = "U";
         #tempora1@#19 = "US";
         #tempora1@#20 = "Usufructuario";
     |FINSI;

     |SI #tempora2@#104 = "N";
         #tempora1@#19 = "NP";
         #tempora1@#20 = "Nuda propiedad";
     |FINSI;

     |SI #tempora2@#104 = "M";
         #tempora1@#19 = "DF";
         #tempora1@#20 = "Disfrutador";
     |FINSI;

     nPorce = 100;

     |SI #tempora2@#2 = "GANANCIAL ";  nPorce = 50;  |FINSI;

     |SI #tempora2@#2 = "VARIOS    ";
         |SI aContri = "TITULAR";     nPorce = #tempora2@#5;  |FINSI;
         |SI aContri = "CONYUGE";     nPorce = #tempora2@#6;  |FINSI;
         |SI aContri = "1 FAMILIAR";  nPorce = #tempora2@#7;  |FINSI;
         |SI aContri = "2 FAMILIAR";  nPorce = #tempora2@#8;  |FINSI;
         |SI aContri = "3 FAMILIAR";  nPorce = #tempora2@#9;  |FINSI;
         |SI aContri = "4 FAMILIAR";  nPorce = #tempora2@#10; |FINSI;
     |FINSI;

     #tempora1@#21 = nPorce;

     #tempora1@#22 = #tempora2@#30 + #tempora2@#31 + #tempora2@#32 + #tempora2@#33 + #tempora2@#34 + #tempora2@#35;

     nDiasHab = #tempora2@#30 + #tempora2@#33;
     nDiasAlq = #tempora2@#31 + #tempora2@#34;

     #tempora1@#23 = "O";
     #tempora1@#24 = "Otros";

     |SI nDiasHab ! 0;  |Y nDiasAlq = 0;
         #tempora1@#23 = "H";
         #tempora1@#24 = "Vivienda habitual";
     |FINSI;

     |SI nDiasHab = 0;  |Y nDiasAlq ! 0;
         #tempora1@#23 = "A";
         #tempora1@#24 = "Arrendada";
     |FINSI;

     |SI nDiasHab ! 0;  |Y nDiasAlq ! 0;
         #tempora1@#23 = "C";
         #tempora1@#24 = "Habitual y Arrendada";
     |FINSI;

     #tempora1@#25 = "1";
     #tempora1@#26 = "Inmuebles en territorio com£n";
|FPRC;

|PROCESO tempora2;
     |SI aClave = "RE";
         aAlfa = aDef % -508;
         #tempora1@#5  = aAlfa;

         |SI #tempora1@#5 = "rem00023";
             |SI #tempora2@#27 ! 0;  |ACABA;  |FINSI;
             |SI #tempora2@#28 ! 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     |SI aClave = "RI";
         |SI #tempora2@#20 ! 0;  |ACABA;  |FINSI;
         |SI #tempora2@#22 ! 0;  |ACABA;  |FINSI;
         |SI #tempora2@#23 ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "PP";
         |SI #tempora2@#23 = "S";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "DM";
         |SI #tempora2@#11 ! "1";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "DD";
         |SI #tempora2@#11 ! "2";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "FA";
         |SI #tempora2@#11 ! "4";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "LT";
         |SI #tempora2@#11 ! "F2";  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "EV"; |O aClave = "SB";
         |SI #tempora2@#13 = 0;  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "EA";
         |SI #tempora2@#13 ! 1;  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "EB";
         |SI #tempora2@#13 ! 2;  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "EC";
         |SI #tempora2@#13 ! 3;  |ACABA;  |FINSI;
     |FINSI;

     |SI aClave = "ED";
         |SI #tempora2@#13 ! 4;  |ACABA;  |FINSI;
     |FINSI;

     || Aqui insertar

     |SI #tempora2@#2 = "GANANCIAL ";
         |SI aContri ! "TITULAR";   |Y aContri ! "CONYUGE";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI aClave ! "RT";
         |SI #tempora2@#2 = "VARIOS    ";
             |SI aContri = "TITULAR";  |Y #tempora2@#5 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "CONYUGE";  |Y #tempora2@#6 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "1 FAMILIAR";  |Y #tempora2@#7 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "2 FAMILIAR";  |Y #tempora2@#8 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "3 FAMILIAR";  |Y #tempora2@#9 = 0;
                 |ACABA;
             |FINSI;

             |SI aContri = "4 FAMILIAR";  |Y #tempora2@#10 = 0;
                 |ACABA;
             |FINSI;
        |FINSI;
     |FINSI;

     |SI #tempora2@#2 = "TITULAR   "; |O #tempora2@#2 = "CONYUGE   ";
         aAlfa1 = #tempora2@#2;  |QBF aAlfa1;
         |SI aAlfa1 ! aContri;
             |ACABA;
         |FINSI;
     |FINSI;

     nLinea = nLinea + 1;

     |DDEFECTO #tempora1@;
     #tempora1@#0  = #rem05000#0;
     #tempora1@#1  = nContri;
     #tempora1@#2  = nLinea;
     #tempora1@#3  = aNegro;
     #tempora1@#4  = "Activo";
     |SI #tempora2@#3 = "X";
         #tempora1@#3 = aRojo;
         #tempora1@#4 = "Anulado";
     |FINSI;

     #tempora1@#6  = #tempora2@#1;

     |SI aClave = "DE";
         #tempora1@#5  = "rem00101";
         #tempora1@#7  = #tempora2@#2;
         #tempora1@#8  = #tempora2@#3;
         #tempora1@#9  = "";
         #tempora1@#10 = #tempora2@#17;
         #tempora1@#11 = #tempora2@#18;
         #tempora1@#13 = #tempora2@#8;
         #tempora1@#15 = #tempora2@#21;

         |SI #tempora2@#6 > 33;  |Y #tempora2@#6 [ 65;
             #tempora1@#9 = "1";
             |SI #tempora2@#14 = "S";
                 #tempora1@#9 = "2";
             |FINSI;
         |FINSI;

         |SI #tempora2@#6 > 65;
             #tempora1@#9 = "3";
         |FINSI;

         #tempora1@#12 = #tempora2@#7;
         |SI #tempora1@#12 = " ";  #tempora1@#12 = "0";  |FINSI;
     |FINSI;

     |SI aClave = "RT";
         #tempora1@#5  = "rem00020";
         #tempora1@#7  = "";
         #tempora1@#8  = #tempora2@#5;
         #tempora1@#9  = "";
         #tempora1@#10 = #tempora2@#7;
         #tempora1@#11 = #tempora2@#6;
         #tempora1@#12 = #tempora2@#9;
         #tempora1@#13 = #tempora2@#10;
         #tempora1@#14 = #tempora2@#11;
         #tempora1@#15 = #tempora2@#19;
         #tempora1@#16 = #tempora2@#18;
     |FINSI;

     |SI aClave = "RB";
         aAlfa = aDef % -508;
         #tempora1@#5  = aAlfa;

         |SI #tempora1@#5 = "rem00037";
             #tempora1@#7  = "";
             #tempora1@#8  = "";
             #tempora1@#15 = "K1";
             #tempora1@#9  = "Premios";
             #tempora1@#10 = #tempora2@#11;
             #tempora1@#11 = #tempora2@#16;
             #tempora1@#12 = #tempora2@#12;
             #tempora1@#13 = #tempora2@#13;
             #tempora1@#14 = #tempora2@#14;
         |FINSI;

         |SI #tempora1@#5 = "rem00030";
             #tempora1@#7  = "";
             #tempora1@#8  = "";
             #tempora1@#15 = "K2";
             #tempora1@#9  = "Ganancias patromoniales";
             #tempora1@#10 = #tempora2@#12;
             #tempora1@#11 = #tempora2@#23;
         |FINSI;
     |FINSI;

     |SI aClave = "RC";
         #tempora1@#5  = "rem00031";
         #tempora1@#7  = "";
         #tempora1@#8  = "Dato desconocido";
         #tempora1@#9  = "";
         #tempora1@#10 = 0;
         #tempora1@#11 = #tempora2@#15;
         #tempora1@#12 = 0;
         #tempora1@#13 = 0;
         #tempora1@#14 = 0;
     |FINSI;

     |SI aClave = "CB";
         |SI #tempora2@#19 ! "I";  |ACABA;  |FINSI;

         #tempora1@#5  = "rem00023";
         #tempora1@#8  = #tempora2@#17;
         aAlfa   = #tempora2@#18;  |QBF aAlfa;
         aAlfa   = aAlfa % -110;
         #tempora1@#9  = aAlfa;
         #tempora1@#12 = #tempora2@#20;
         #tempora1@#13 = #tempora2@#22;
     |FINSI;

     |SI aClave = "RE";
         aAlfa = aDef % -508;
         #tempora1@#5  = aAlfa;

         |SI #tempora1@#5 = "rem00022";
             #tempora1@#8  = #tempora2@#17;
             #tempora1@#11 = "Base imponible ahorro: dividendos       ";
             #tempora1@#13 = #tempora2@#19;
             #tempora1@#14 = #tempora2@#24;
             #tempora1@#15 = #tempora2@#27;
         |FINSI;

         |SI #tempora1@#5 = "rem00023";
             #tempora1@#8  = #tempora2@#17;
             |SI #tempora2@#19 = "I";  #tempora1@#11 = "Intereses  cuentas, depositos y activo";    |FINSI;
             |SI #tempora2@#19 = "B";  #tempora1@#11 = "Intereses activos derecho a bonificacion";  |FINSI;
             |SI #tempora2@#19 = "C";  #tempora1@#11 = "Rdtos transmision, amortizacion o reemb.";  |FINSI;
             |SI #tempora2@#19 = "5";  #tempora1@#11 = "Rdtos causa de imposicion de capitales  ";  |FINSI;
             |SI #tempora2@#19 = "O";  #tempora1@#11 = "Otros rdtos de capital mobiliario       ";  |FINSI;
             |SI #tempora2@#19 = "F";  #tempora1@#11 = "Intereses activos financieros c/bonif.  ";  |FINSI;
             |SI #tempora2@#19 = "1";  #tempora1@#11 = "Rdtos arrendamientos, negocios o minas  ";  |FINSI;
             |SI #tempora2@#19 = "2";  #tempora1@#11 = "Rdtos prestacion de asistencia tecnica  ";  |FINSI;
             |SI #tempora2@#19 = "3";  #tempora1@#11 = "Rdtos de la propiedad intelectual       ";  |FINSI;
             |SI #tempora2@#19 = "4";  #tempora1@#11 = "Rdtos de la propiedad industrial        ";  |FINSI;
             #tempora1@#13 = #tempora2@#20;
             #tempora1@#14 = #tempora2@#22;
             #tempora1@#15 = #tempora2@#23;
         |FINSI;

         |SI #tempora1@#5 = "rem00051";
             #tempora1@#8  = #tempora2@#17;
             #tempora1@#11 = "Rentas temporales o vitalicias";
             #tempora1@#13 = #tempora2@#26;
             #tempora1@#14 = #tempora2@#29;
         |FINSI;
     |FINSI;

     |SI aClave = "RI";
         #tempora1@#5  = "rem00023";
         #tempora1@#8  = #tempora2@#17;

         |SI #tempora2@#19 = "C";  #tempora1@#11 = "Rdtos transmision, amortizacion o reemb.";  |FINSI;
         |SI #tempora2@#19 = "O";  #tempora1@#11 = "Otros rdtos de capital mobiliario       ";  |FINSI;

         |SI #tempora2@#29 < 0;  #tempora1@#12 = -#tempora2@#29;  |FINSI;
         |SI #tempora2@#29 ] 0;  #tempora1@#12 = #tempora2@#29;   |FINSI;

         #tempora1@#13 = #tempora2@#31;
     |FINSI;

     |SI aClave = "SG";
         #tempora1@#5  = "rem00024";
         #tempora1@#8  = #tempora2@#15;
         #tempora1@#10 = #tempora2@#17;
         #tempora1@#11 = #tempora2@#20;
         #tempora1@#12 = #tempora2@#24;
     |FINSI;

     |SI aClave = "UR";
         |HAZ CargaInmuebles;
     |FINSI;

     |SI aClave = "PF";
         #tempora1@#5  = "rem00031";
         #tempora1@#7  = "";
         #tempora1@#8  = "Dato desconocido";
         aAlfa   = "";
         |SI #tempora2@#11 ! 0; aAlfa = aAlfa + "1P ";  |FINSI;
         |SI #tempora2@#12 ! 0; aAlfa = aAlfa + "2P ";  |FINSI;
         |SI #tempora2@#13 ! 0; aAlfa = aAlfa + "3P ";  |FINSI;
         |SI #tempora2@#14 ! 0; aAlfa = aAlfa + "4P ";  |FINSI;
         #tempora1@#9  = aAlfa;
         #tempora1@#10 = "";
         #tempora1@#11 = "";
         #tempora1@#12 = #tempora2@#11 + #tempora2@#12 + #tempora2@#13 + #tempora2@#14;
     |FINSI;

     |SI aClave = "DN";
         #tempora1@#5  = "rem00046";
         #tempora1@#8  = #tempora2@#12;
         #tempora1@#9  = "";
         #tempora1@#10 = "Donativo";
         #tempora1@#13 = #tempora2@#13;
         #tempora1@#15 = #tempora2@#14;
     |FINSI;

     |SI aClave = "DM";
         #tempora1@#5  = "rem00065";
         #tempora1@#9  = #tempora2@#14;
     |FINSI;

     |SI aClave = "PP";
         #tempora1@#5  = "rem00053";
         #tempora1@#8  = #tempora2@#11;
         #tempora1@#9  = "Dato desconocido";
         #tempora1@#10 = "Dato desconocido";

         |SI #tempora2@#12 = "N";
             #tempora1@#11 = #tempora2@#16;
             #tempora1@#12 = #tempora2@#15;
         |SINO;
             #tempora1@#11 = #tempora2@#19;
             #tempora1@#12 = #tempora2@#18;
             #tempora1@#13 = #tempora2@#17;
         |FINSI;
     |FINSI;

     |SI aClave = "CU";
         #tempora1@#5  = "rem00056";
         #tempora1@#7  = #tempora2@#14;
     |FINSI;

     |SI aClave = "LT";
         #tempora1@#5  = "rem00052";
         #tempora1@#8  = #tempora2@#16;
         #tempora1@#9  = #tempora2@#20;
         #tempora1@#10 = #tempora2@#17;
         #tempora1@#11 = #tempora2@#19;
         #tempora1@#12 = #tempora2@#18;
         #tempora1@#14 = #tempora2@#21;
     |FINSI;

     |SI aClave = "EV";
         #tempora1@#5  = "rem00030";
         #tempora1@#9  = #tempora2@#13;
     |FINSI;

     |SI aClave = "SB";
         #tempora1@#5  = "rem00030";
         #tempora1@#10 = #tempora2@#13;
     |FINSI;

     |SI aClave = "EA";
         #tempora1@#5  = "rem00058";
         #tempora1@#7  = #tempora2@#12;
         #tempora1@#8  = "";
                           #tempora1@#9  = "02";
         |SI #tempora2@#30 ! 0;  #tempora1@#9  = "01";  |FINSI;
         #tempora1@#10 = #tempora2@#16;
         #tempora1@#11 = #tempora2@#17;
         #tempora1@#12 = #tempora2@#30;
         #tempora1@#13 = #tempora2@#29;
     |FINSI;

     |SI aClave = "EB";
         #tempora1@#5  = "rem00058";
         #tempora1@#7  = #tempora2@#12;
         #tempora1@#8  = "";
         #tempora1@#9  = #tempora2@#19;
         #tempora1@#10 = #tempora2@#20;
         #tempora1@#11 = #tempora2@#29;
     |FINSI;

     |SI aClave = "EC";
         #tempora1@#5  = "rem00058";
         #tempora1@#7  = #tempora2@#12;
         #tempora1@#8  = "";
         #tempora1@#9  = #tempora2@#22;
         #tempora1@#10 = #tempora2@#23;
         #tempora1@#11 = #tempora2@#29;
     |FINSI;

     |SI aClave = "ED";
         #tempora1@#5  = "rem00058";
         #tempora1@#7  = #tempora2@#12;
         #tempora1@#8  = "";
         #tempora1@#13 = #tempora2@#29;

         |SI #tempora2@#25 ! 0;
             #tempora1@#9  = "F";
             #tempora1@#10 = "01";
             #tempora1@#11 = "Ganancias no derivadas de transmisiones";
             #tempora1@#12 = #tempora2@#25;
         |FINSI;

         |SI #tempora2@#26 ! 0;
             #tempora1@#9  = "F";
             #tempora1@#10 = "02";
             #tempora1@#11 = "Perdidas no derivadas de transmisiones";
             #tempora1@#12 = #tempora2@#26;
         |FINSI;

         |SI #tempora2@#27 ! 0;
             #tempora1@#9  = "G";
             #tempora1@#10 = "01";
             #tempora1@#11 = "Ganancias derivadas de transmisiones";
             #tempora1@#12 = #tempora2@#27;
         |FINSI;

         |SI #tempora2@#28 ! 0;
             #tempora1@#9  = "G";
             #tempora1@#10 = "02";
             #tempora1@#11 = "Perdidas derivadas de transmisiones";
             #tempora1@#12 = #tempora2@#28;
         |FINSI;
     |FINSI;

     |SI aClave = "FA";
         #tempora1@#5  = "rem00065";
         #tempora1@#9  = #tempora2@#40;
         #tempora1@#10 = #tempora2@#39;
         #tempora1@#11 = #tempora2@#43;
         #tempora1@#12 = #tempora2@#41;
         #tempora1@#13 = #tempora2@#42;
         #tempora1@#15 = #tempora2@#51;
     |FINSI;

     |SI aClave = "DD";
         #tempora1@#5  = "rem00065";
         #tempora1@#7  = #tempora2@#15;
         #tempora1@#8  = #tempora2@#16;
         #tempora1@#9  = #tempora2@#17;
         #tempora1@#10 = #tempora2@#18;
         #tempora1@#12 = #tempora2@#25;
     |FINSI;

     || Aqui insertar

     |GRABA 020#tempora1@.n;
     |LIBERA #tempora1@;
|FPRC;

|DEFBUCLE tempora2;
     #tempora2@#1002;
     ;
     #rem05000#0, 001;
     #rem05000#0, 999;
     ;
     NULL, tempora2;
|FIN;

|PROCESO DatosDiagram;
     aDef = "";

     |SI aClave = "TI";
         |HAZ DatosContribuyentes;
         |ACABA;
     |FINSI;

     |SI aClave = "DE";  aDef = aBase + "def/rem00101.mas";  |FINSI;
     |SI aClave = "RT";  aDef = aBase + "def/rem00020.mas";  |FINSI;
     |SI aClave = "RB";  aDef = aBase + "def/rem00037.mas";  |FINSI;
     |SI aClave = "RI";  aDef = aBase + "def/rem00023.mas";  |FINSI;
     |SI aClave = "CB";  aDef = aBase + "def/rem00023.mas";  |FINSI;
     |SI aClave = "RE";  aDef = aBase + "def/rem00023.mas";  |FINSI;
     |SI aClave = "SG";  aDef = aBase + "def/rem00024.mas";  |FINSI;
     |SI aClave = "UR";  aDef = aBase + "def/rem00021.mas";  |FINSI;
     |SI aClave = "RC";  aDef = aBase + "def/rem00031.mas";  |FINSI;
     |SI aClave = "PF";  aDef = aBase + "def/rem00031.mas";  |FINSI;
     |SI aClave = "DN";  aDef = aBase + "def/rem00046.mas";  |FINSI;
     |SI aClave = "DM";  aDef = aBase + "def/rem00065.mas";  |FINSI;
     |SI aClave = "PP";  aDef = aBase + "def/rem00053.mas";  |FINSI;
     |SI aClave = "CU";  aDef = aBase + "def/rem00056.mas";  |FINSI;
     |SI aClave = "LT";  aDef = aBase + "def/rem00052.mas";  |FINSI;
     |SI aClave = "EV";  aDef = aBase + "def/rem00030.mas";  |FINSI;
     |SI aClave = "EA";  aDef = aBase + "def/rem00058.mas";  |FINSI;
     |SI aClave = "EB";  aDef = aBase + "def/rem00058.mas";  |FINSI;
     |SI aClave = "EC";  aDef = aBase + "def/rem00058.mas";  |FINSI;
     |SI aClave = "ED";  aDef = aBase + "def/rem00058.mas";  |FINSI;
     |SI aClave = "SB";  aDef = aBase + "def/rem00030.mas";  |FINSI;
     |SI aClave = "FA";  aDef = aBase + "def/rem00065.mas";  |FINSI;
     |SI aClave = "DD";  aDef = aBase + "def/rem00065.mas";  |FINSI;

     || Aqui insertar

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     nLinea = 0;
     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;

     aDef = "";
     |SI aClave = "RE";  aDef = aBase + "def/rem00022.mas";  |FINSI;
     |SI aClave = "RB";  aDef = aBase + "def/rem00030.mas";  |FINSI;

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;

     aDef = "";
     |SI aClave = "RE";  aDef = aBase + "def/rem00051.mas";  |FINSI;

     |SI aDef = "";  |ACABA;  |FINSI;

     |CARGA_DEF aDef, tempora2@;

     |BUCLE tempora2;

     |DESCARGA_DEF #tempora2@;
|FPRC;

|PROCESO RegistroAbajo;
     aAlfa = #tempora0@#4;  |QBF aAlfa;
     |SI aAlfa = "No trasladable";
         |ACABA;
     |FINSI;

     |SI aAlfa = "En renta";
         |ACABA;
     |FINSI;

     nMasivo = 1;
     |HAZ PasaRegistro;
|FPRC;

|DEFBUCLE RegistroAbajo;
     #tempora0@#1003;
     ;
     #rem05000#0, nContri, 001;
     #rem05000#0, nContri, 999;
     ;
     NULL, RegistroAbajo;
|FIN;

|PROCESO TodosAbajo;
    |BUCLE RegistroAbajo;

    |REFRESCACONTROL nGrid1;
    |REFRESCACONTROL nGrid2;
|FPRC;

|PROCESO RegistroArriba;
     nMasivo = 1;
     aAlfa   = #tempora1@#4;  |QBF aAlfa;
     |SI aAlfa = "Anulado";
         |HAZ Desanula;
     |SINO;
         |HAZ Anula;
     |FINSI;
|FPRC;

|DEFBUCLE RegistroArriba;
     #tempora1@#1003;
     ;
     #rem05000#0, nContri, 001;
     #rem05000#0, nContri, 999;
     ;
     NULL, RegistroArriba;
|FIN;

|PROCESO TodosArriba;
    |BUCLE RegistroArriba;

    |REFRESCACONTROL nGrid1;

    |SI aClave ! "DE";
        |REFRESCACONTROL nGrid2;
    |FINSI;
|FPRC;

|PROCESO Trasladables;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aDef = aBase + "def/" + aMas;
     |CARGA_DEF aDef, tempora0@;
     |CARGA_DEF aDef, tempora1@;

     aFichero = ("51" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #tempora1@#aFichero#;
     |ABRE #tempora1@;  |CIERRA #tempora1@;  |DELINDEX #tempora1@;

     |ABRE #tempora0@;
     |ABRE #tempora1@;

     |HAZ DatosDiagram;

     |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos del borrador. (Doble click en la l¡nea para incorporar el registro a la renta)", 0502, 0598, NULL;

     |SI aClave ! "TI";  |Y aClave ! "DE";
         |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos Renta 2015. (Doble click en la l¡nea para activar o anular el registro en la renta)", 3402, 3498, NULL;
     |FINSI;

     |SI aClave = "TI";
         |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos Renta 2015.", 2102, 2198, NULL;
     |FINSI;

     |SI aClave = "DE";
         |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos Renta 2015. (Doble click en la l¡nea para anular el registro en la renta)", 3402, 3498, NULL;
     |FINSI;

     |SI nModo ! 4;
         |CONTROL_SIMPLE 0, "BOTON, {{235}} ", 1902, 1905, TodosAbajo;
         |CONTROL_SIMPLE 0, "LABEL,{{16}}Incorporar todos los registros a la renta", 1907, 1998, NULL;

         |SI aClave ! "TI";
             |CONTROL_SIMPLE 0, "BOTON, {{234}} ", 2163, 2166, TodosArriba;
             |CONTROL_SIMPLE 0, "LABEL,{{16}}Anular todos los registros de la renta", 2168, 2198, NULL;
         |FINSI;
     |FINSI;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#tempora0@, nRango, 0601, 1899, Baja900, Alta900, Evento900;
     nGrid1 = FSalida;

     |LINEAL_SIMPLE #1#tempora1@, nRango, 2201, 3399, NULL, NULL, Evento1;
     nGrid2 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #tempora0@;
     |CIERRA #tempora1@;  |DELINDEX #tempora1@;

     |DESCARGA_DEF #tempora1@;
     |DESCARGA_DEF #tempora0@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;

|PROCESO NoTrasladables;
     |VENTANA 0501, 2799, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aDef = aBase + "def/" + aMas;
     |CARGA_DEF aDef, tempora0@;

     |ABRE #tempora0@;

     |CONTROL_SIMPLE 0, "LABEL,{{10}}Datos del borrador. (Registros NO TRASDABLE)", 0502, 0598, NULL;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#tempora0@, nRango, 0601, 2699, Baja900, Alta900, NULL;
     nGrid1 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid1;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #tempora0@;

     |DESCARGA_DEF #tempora0@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;

|PROCESO PantaDatos;
     aMas = "";

     |SI aClave = "TI";
         aAlfa = "Datos contribuyentes";
         aMas  = "rem05031.mas";
     |FINSI;

     |SI aClave = "DE";
         aAlfa = "Datos familiares";
         aMas  = "rem05032.mas";
     |FINSI;

     |SI aClave = "AR";
         aAlfa = "Arrendamientos de inmuebles";
         aMas  = "rem05011.mas";
     |FINSI;

     |SI aClave = "CB";
         aAlfa = "Cuentas bancarias";
         aMas  = "rem05002.mas";
     |FINSI;

     |SI aClave = "CT";
         aAlfa = "Cotizaciones a reg¡menes especiales de la seguridad social y convenios especiales";
         aMas  = "rem05006.mas";
     |FINSI;

     |SI aClave = "DM";
         aAlfa = "Deducciones por maternidad";
         aMas  = "rem05013.mas";
     |FINSI;

     |SI aClave = "DN";
         aAlfa = "Donaciones y aportaciones a patrimonio de persona con discapacidad";
         aMas  = "rem05010.mas";
     |FINSI;

     |SI aClave = "PF";
         aAlfa = "Pagos fraccionados de empresas y profesionales";
         aMas  = "rem05009.mas";
     |FINSI;

     |SI aClave = "PH";
         aAlfa = "Pr‚stamos y cr‚ditos relacionados con bienes inmuebles";
         aMas  = "rem05012.mas";
     |FINSI;

     |SI aClave = "PP";
         aAlfa = "Aportaciones y contribuciones a sistema de previsi¢n social";
         aMas  = "rem05014.mas";
     |FINSI;

     |SI aClave = "RE";
         aAlfa = "Rendimientos expl¡citos del capital mobiliario, base imponible del ahorro";
         aMas  = "rem05003.mas";
     |FINSI;

     |SI aClave = "RI";
         aAlfa = "Rendimientos expl¡citos del capital mobiliario";
         aMas  = "rem05029.mas";
     |FINSI;

     |SI aClave = "RT";
         aAlfa = "Rendimientos del trabajo";
         aMas  = "rem05001.mas";
     |FINSI;

     |SI aClave = "RB";
         aAlfa = "Premios y ganancias patrimoniales";
         aMas  = "rem05030.mas";
     |FINSI;

     |SI aClave = "RC";
         aAlfa = "Actividades econ¢micas";
         aMas  = "rem05008.mas";
     |FINSI;

     |SI aClave = "AE";
         aAlfa = "Datos censales sobre actividades econ¢micas de alta en el ejercicio";
         aMas  = "rem05024.mas";
     |FINSI;

     |SI aClave = "SG";
         aAlfa = "Rendimientos de operaciones de seguros";
         aMas  = "rem05005.mas";
     |FINSI;

     |SI aClave = "UR";
         aAlfa = "Informaci¢n catastral de inmuebles";
         aMas  = "rem05007.mas";
     |FINSI;

     |SI aClave = "TV";
         aAlfa = "Ventas de activos financieros y otros valores mobiliarios";
         aMas  = "rem05004.mas";
     |FINSI;

     |SI aClave = "IP";
         aAlfa = "Otras subvenciones,auxilios y ayudas satisfechos por las administraciones p£blicas";
         aMas  = "rem05015.mas";
     |FINSI;

     |SI aClave = "AG";
         aAlfa = "Subvenciones e indemnizaciones satisfechas a agricultores, ganaderos o forestales";
         aMas  = "rem05016.mas";
     |FINSI;

     |SI aClave = "FI";
         aAlfa = "Ventas de fondos de inversi¢n con retenci¢n";
         aMas  = "rem05017.mas";
     |FINSI;

     |SI aClave = "SC";
         aAlfa = "Participaci¢n en comunidades de bienes, herencias yacentes y sociedades civiles";
         aMas  = "rem05018.mas";
     |FINSI;

     |SI aClave = "CU";
         aAlfa = "Abono por nacimiento o adopci¢n. Deducci¢n IRPF anticipada";
         aMas  = "rem05019.mas";
     |FINSI;

     |SI aClave = "NO";
         aAlfa = "Operaciones de transmisi¢n de derechos sobre bienes inmuebles";
         aMas  = "rem05020.mas";
     |FINSI;

     |SI aClave = "LT";
         aAlfa = "Rendimientos de letras del tesoro";
         aMas  = "rem05021.mas";
     |FINSI;

     |SI aClave = "CC";
         aAlfa = "Deducciones auton¢micas";
         aMas  = "rem05022.mas";
     |FINSI;

     |SI aClave = "EV";
         aAlfa = "Renta b sicas de emancipaci¢n";
         aMas  = "rem05023.mas";
     |FINSI;

     |SI aClave = "EA";
         aAlfa = "Atribuci¢n de rendimientos del capital mobiliario";
         aMas  = "rem05025.mas";
     |FINSI;

     |SI aClave = "EB";
         aAlfa = "Atribuci¢n de rendimientos del capital inmobiliario";
         aMas  = "rem05026.mas";
     |FINSI;

     |SI aClave = "EC";
         aAlfa = "Atribuci¢n de rendimientos de actividades econ¢micas";
         aMas  = "rem05027.mas";
     |FINSI;

     |SI aClave = "ED";
         aAlfa = "Atribuci¢n de ganancias y p‚rdidas patrimoniales";
         aMas  = "rem05028.mas";
     |FINSI;

     |SI aClave = "EF";
         aAlfa = "Atribuci¢n de rentas deducciones";
         aMas  = "rem05033.mas";
     |FINSI;

     |SI aClave = "SB";
         aAlfa = "Subvenciones recogidas de la Base de Datos Nacional de Subvenciones";
         aMas  = "rem05034.mas";
     |FINSI;

     |SI aClave = "FA";
         aAlfa = "Deducci¢n por familia numerosa";
         aMas  = "rem05035.mas";
     |FINSI;

     |SI aClave = "DD";
         aAlfa = "Deducci¢n por descendientes con discapacidad a cargo";
         aMas  = "rem05036.mas";
     |FINSI;

     || Aqui insertar

     |SI aMas = "";  |ACABA;  |FINSI;

     |SI aMas = "rem05031.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05032.mas";  |HAZ Trasladables;    |FINSI;

     |SI aMas = "rem05001.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05002.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05003.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05004.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05005.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05006.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05007.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05008.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05009.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05010.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05011.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05012.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05013.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05014.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05015.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05016.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05017.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05018.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05019.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05020.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05021.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05022.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05023.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05024.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05025.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05026.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05027.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05028.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05029.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05030.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05033.mas";  |HAZ NoTrasladables;  |FINSI;
     |SI aMas = "rem05034.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05035.mas";  |HAZ Trasladables;    |FINSI;
     |SI aMas = "rem05036.mas";  |HAZ Trasladables;    |FINSI;

     || Aqui insertar
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;  |ACABA;  |FINSI;

     aClave = Contenido;  |QBF aClave;
     |SI aClave = "";  |ACABA;  |FINSI;

     |ESTADO_CONTROL nTree, "DISABLE";

     |HAZ PantaDatos;

     |ESTADO_CONTROL nTree, "ENABLE";
     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Procesar;
     aFichero = "men" + (("00000" + #rem05000#0) % -105) + ".txt";
     aAbre    = aDirServidor + aFichero;
     |XABRE "WB", aAbre, nHandle;

     nConta = 0;
     aMas   = "rem05031.mas";  aClave = "TI";  |HAZ BuscaRegistro;
     aMas   = "rem05032.mas";  aClave = "DE";  |HAZ BuscaRegistro;

     aMas   = "rem05001.mas";  aClave = "RT";  |HAZ BuscaRegistro;
     aMas   = "rem05030.mas";  aClave = "RB";  |HAZ BuscaRegistro;
     aMas   = "rem05008.mas";  aClave = "RC";  |HAZ BuscaRegistro;
     aMas   = "rem05024.mas";  aClave = "AE";  |HAZ BuscaRegistro;
     aMas   = "rem05015.mas";  aClave = "IP";  |HAZ BuscaRegistro;
     aMas   = "rem05014.mas";  aClave = "PP";  |HAZ BuscaRegistro;
     aMas   = "rem05016.mas";  aClave = "AG";  |HAZ BuscaRegistro;
     aMas   = "rem05002.mas";  aClave = "CB";  |HAZ BuscaRegistro;
     aMas   = "rem05017.mas";  aClave = "FI";  |HAZ BuscaRegistro;
     aMas   = "rem05025.mas";  aClave = "EA";  |HAZ BuscaRegistro;
     aMas   = "rem05026.mas";  aClave = "EB";  |HAZ BuscaRegistro;
     aMas   = "rem05027.mas";  aClave = "EC";  |HAZ BuscaRegistro;
     aMas   = "rem05028.mas";  aClave = "ED";  |HAZ BuscaRegistro;
     aMas   = "rem05033.mas";  aClave = "EF";  |HAZ BuscaRegistro;
     aMas   = "rem05012.mas";  aClave = "PH";  |HAZ BuscaRegistro;
     aMas   = "rem05009.mas";  aClave = "PF";  |HAZ BuscaRegistro;
     aMas   = "rem05004.mas";  aClave = "TV";  |HAZ BuscaRegistro;
     aMas   = "rem05003.mas";  aClave = "RE";  |HAZ BuscaRegistro;
     aMas   = "rem05029.mas";  aClave = "RI";  |HAZ BuscaRegistro;
     aMas   = "rem05005.mas";  aClave = "SG";  |HAZ BuscaRegistro;
     aMas   = "rem05011.mas";  aClave = "AR";  |HAZ BuscaRegistro;
     aMas   = "rem05010.mas";  aClave = "DN";  |HAZ BuscaRegistro;
     aMas   = "rem05006.mas";  aClave = "CT";  |HAZ BuscaRegistro;
     aMas   = "rem05007.mas";  aClave = "UR";  |HAZ BuscaRegistro;
     aMas   = "rem05013.mas";  aClave = "DM";  |HAZ BuscaRegistro;
     aMas   = "rem05018.mas";  aClave = "SC";  |HAZ BuscaRegistro;
     aMas   = "rem05019.mas";  aClave = "CU";  |HAZ BuscaRegistro;
     aMas   = "rem05020.mas";  aClave = "NO";  |HAZ BuscaRegistro;
     aMas   = "rem05021.mas";  aClave = "LT";  |HAZ BuscaRegistro;
     aMas   = "rem05022.mas";  aClave = "CC";  |HAZ BuscaRegistro;
     aMas   = "rem05023.mas";  aClave = "EV";  |HAZ BuscaRegistro;
     aMas   = "rem05034.mas";  aClave = "SB";  |HAZ BuscaRegistro;
     aMas   = "rem05035.mas";  aClave = "FA";  |HAZ BuscaRegistro;
     aMas   = "rem05036.mas";  aClave = "DD";  |HAZ BuscaRegistro;

     || Aqui insertar

     |XCIERRA nHandle;

     aAlfa =  "Datos fiscales del " + aContri;
     |VENTANA 0510, 2187, -1, 16, aAlfa;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     eaOrigen  = aAbre;
     eaDestino = aDirLocal + aFichero;
     |HAZ CopiaFichero;

     |FBORRA eaOrigen;

     |PTEC 802;  |PAUSA;

     aAlfa    = "TREECTRL,Datos fiscales {{" + eaDestino + "}}";

     |CONTROL_SIMPLE 0, aAlfa, 0510, 1987, EventoTree;
     nTree    = FSalida;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";
     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1     = &255 + "806";
     aEsc2     = &255 + "807";
     aRetu     = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::Salir," + nTree;
         |LEETECLA aTecla;

         |PULSATECLA;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;

         |FOCOTECLADO nTree;
     |SIGUE;

     aAlfa = aDirLocal + aFichero;  |RFBORRA aAlfa;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nSubVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nSubVent;
|FPRC;
