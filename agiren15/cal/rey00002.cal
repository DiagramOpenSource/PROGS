|FICHEROS
     rey00002 #0;
     rem00100 #1;        || datos contribuyentes
     rem00101 #2;        || datos familiares
     rem01001 #3;        || liquidacion 1
     rew00001 #99;       || puntear rentas
|FIN;

|VARIABLES;
     aDdecla = " ";
     aHdecla = "z";
     nSwTodos = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;

     nVentana = 0;
     nGrid    = 0;
     nRango   = 0;

     aEsc1    = "";
     aEsc2    = "";
     aRetu    = "";
     aTecla   = "";
|FINSI;

|INCLUYE i_varcpa;
|INCLUYE i_consul;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO seleccion; |TIPO 0;
     |SI #0#0 = "S";
          |CAMPO_MODIFICA #0#01, 1, "S";
          |CAMPO_MODIFICA #0#02, 1, "S";

          |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
               #0xxx = 0; |PINTA #0xxx;
               |CAMPO_MODIFICA #0xxx, 1, "N";
          |SIGUE;
     |SINO;
          #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
          #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

          |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
               |CAMPO_MODIFICA #0xxx, 1, "S";
          |SIGUE;
     |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS DATOS CONTRIBUYENTE
|| **************************************************************************

|PROCESO imprimelo;
     swporta  = 0;
     linea    = 0;
     hoja     = 0;

     |DDEFECTO #1;
     |ABRE #1;
     #1#0 = #99#0;
     |LEE 000#1=;
     |CIERRA #1;

     aRecorte = #99#2 % 110;
     |SI aRecorte = aTitular;           cif = #1#1;    |FINSI;
     |SI aRecorte = aConyuge;           cif = #1#1;    |FINSI;

     |HAZ recompa1;
     |HAZ recompa2;
     |HAZ recompa3;
     |HAZ recompa4;
     |HAZ recompa5;
|FPRC;

|DEFBUCLE rew00001;
     #99#1;
     11;
     00000, " ", "*";
     99999, "z", "*";
     ;
     NULL, imprimelo;
|FIN;

|PROCESO tipo_3; |TIPO 3;
     LineaInforme = #0#34 - 1;
     TopeLinea    = #0#34 - 8;
     SaltoPagina  = #0#35;

     |HAZ carga_index;

     |SI x ! 0;
          |IMPRE 0;
          |SI FSalida = 0;
               |BUCLE rew00001;
          |FINSI;
          |FINIMP;
     |FINSI;

     |DELINDEX #99;
|FPRC;

|PROCESO rem01001;
     #1#0 = #3#0;
     |LEE 000#1=;
     |SI FSalida = 0;
          |DDEFECTO #99;
          #99#0 = #3#0;       || contribuyente
          |SI #3#2 = aPatriTit;    #99#2 = aTitular;   |FINSI;
          |SI #3#2 = aPatriCon;    #99#2 = aConyuge;   |FINSI;
          #99#1 = #99#2 % 101;|| tipo declaracion
          |SI #3#2 = aPatriTit;    #99#3 = #1#5;       |FINSI;  || titular
          |SI #3#2 = aPatriCon;    #99#3 = #1#39;      |FINSI;  || conyuge
          #99#4 = 1;          || numero de copias
          #99#11 = "";
          |SI nSwTodos = 0;
               #99#11 = "*";
          |FINSI;
          |GRABA 000#99n;
          |SI FSalida = 0;
               x = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01001;
     #3#1;
     4;
     d_empre, 00, aPatriCon, aDdecla;
     h_empre, 00, aPatriTit, aHdecla;
     ;
     NULL, rem01001;
|FIN;

|PROCESO inferior;
     #99#0 = 1;
     #99#1 = " ";
|FPRC;

|PROCESO superior;
     #99#0 = 99999;
     #99#1 = "z";
|FPRC;

|PROCESO Evento;
   |SI FSalida = 1; |O FSalida = 2;
      |LEE 000#rew00001.=;
   |FINSI;

   |SI FSalida = 4;
      |SI #rew00001#11 = " ";
         #rew00001#11 = "*";
      |SINO;
         #rew00001#11 = " ";
      |FINSI;
      |GRABA 020#rew00001.a;
      |LIBERA #rew00001;

      |PINTA #rew00001#11;
   |FINSI;
|FPRC;

|PROCESO carga_index;
     |SI #0#36 = "n";
          aDdecla = " ";
          aHdecla = "z";
     |SINO;
          aDdecla = "S";
          aHdecla = "S";
     |FINSI;

     |SI #0#33 = "S";
          |CONFI "0000SMarcar todos: ";
          nSwTodos = FSalida;
     |SINO;
          nSwTodos = 0;
     |FINSI;

     aAlfa1 = Usuario; |QBF aAlfa1;
     |NOME_DAT #99 aAlfa1;
     |DELINDEX #99;
     |ABRE #1;
     |ABRE #99;
     x = 0;
     |SI #0#0 = "S";
          d_empre = #0#1;
          h_empre = #0#2;
          |BUCLE rem01001;
     |SINO;
         |PARA xxx = 3; |SI xxx [ 32; |HACIENDO xxx = xxx + 1;
              |SI #0xxx ! 0;
                   d_empre = #0xxx;
                   h_empre = #0xxx;
                   |BUCLE rem01001;
              |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #1;
     |CIERRA #99;

     |SI x = 0;
          |MENAV "0000Seleccion vacia";
          |ACABA;
     |FINSI;

     |SI #0#33 = "S";
          |VENTANA 0501, 2399, -1, 16, "Selecci¢n de contribuyentes";
          nVentana = FSalida;

          |PTEC 802;  |PAUSA;

          |PINPA #0#rew00001;
          nRango = 4 + 8 + 16 + 32;

          |ABRE #rew00001;
          |LINEAL_SIMPLE #1#rew00001, nRango, 0502, 2198, inferior, superior, Evento;
          nGrid = FSalida;

          aEsc1  = &255 + "806";
          aEsc2  = &255 + "807";
          aRetu  = &255 + "802";
          |PARA; |SI;  |HACIENDO;
               FSalida = "::{{001}}Salir," + nGrid;
               |LEETECLA aTecla;
               |SI aTecla = aEsc1; |SAL;  |FINSI;
               |SI aTecla = aEsc2; |SAL;  |FINSI;
               |SI aTecla = aRetu; |SAL;  |FINSI;
          |SIGUE;

          |CIERRA #rew00001;

          |FINVENTANA nVentana;
     |FINSI;
|FPRC;

|PROCESO Salto;
     |SI #0#35 = "S";
         #0#34 = 70;  |PINTA #0#34;
     |FINSI;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 2499;
|FPRC;
