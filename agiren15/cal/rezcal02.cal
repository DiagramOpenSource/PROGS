|FICHEROS;
      rew99999;
      rem00019;

      datfic0@ #0;
      datfic1@ #1;
      datfic2@ #2;
      datfic3@ #3;
      datfic4@ #4;
      datfic5@ #5;

     &refere1@;
     &refere2@;
     &refere3@;
|FIN;

|VARIABLES;
|FIN;

|INCLUYE i_varcal;

|PROCESO Ded_32_2_1;
     |SI #datfic3@#26 ! "S";  |ACABA;  |FINSI;

     nTotRdtos = nTotRenta - #datfic3@#7;    || 118
     nTotRdtos = nTotRdtos - #datfic3@#11;   || 143
     nTotRdtos = nTotRdtos - #datfic3@#13;   || 172

     enImporte = #datfic3@#18;
     nRdto     = 0;
     |SI enImporte > 0;
         nRdto = 2000;

         |SI enImporte [ 14450; |Y nTotRdtos < 6500.01;
             |SI enImporte < 11250;
                 nRdto = nRdto + 3700;
             |SINO;
                 |SI enImporte ] 11250;  |Y enImporte [ 14450;
                     nRdto = nRdto + (3700 - (1.15625 * (enImporte - 11250))) ! 2;
                 |FINSI;
             |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
             |SI #rew99999#4 = "N";
                 nRdto = nRdto + 3500;
             |SINO;
                 nRdto = nRdto + 7750;
             |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65;
             nRdto = nRdto + 7750;
         |FINSI;
     |FINSI;

     enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte;  nValor = enImporte;
     |SI nRdto > nValor;
         nRdto = nValor;
     |FINSI;

     |SI nRdto < 0;  nRdto = 0;  |FINSI;

     enSwAcum  = 0;
     enBloque  = 5;
     eaCasilla = "122";
     enImporte = nRdto;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO Ded_32_2_3;
     enBloque = 5;  eaCasilla = "122"; |HAZ SacaImporte;  nVal122 = enImporte;
     |SI nVal122 ! 0;  |ACABA;  |FINSI;

     nRdto = 0;
     |SI nTotRenta < 8000;
         nRdto = 1620;
     |SINO;
         |SI nTotRenta < 12000;
             nRdto = (N\ 1620 - (0.405 * (nTotRenta - 8000)));
         |FINSI;
     |FINSI;

     |SI #datfic1@#22 > 3700;
         nRdto = 0;
     |SINO;
         nSuma = #datfic1@#22 + nRdto;
         |SI nSuma > 3700;
             nRdto = 3700 - #datfic1@#22;
         |FINSI;
     |FINSI;

     enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte;  nValor = enImporte;
     |SI nValor > 0;
         enImporte = ((nRdto / #datfic3@#33) * nValor) ! 2;
         |SI enImporte > nValor;
             enImporte = nValor;
         |FINSI;

         |SI enImporte < 0;  enImporte = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 5;
         eaCasilla = "123";
         |HAZ GrabaLineal;
     |FINSI;

     enBloque = 6;  eaCasilla = "148"; |HAZ SacaImporte;  nValor = enImporte;
     |SI nValor > 0;
         enImporte = ((nRdto / #datfic3@#33) * nValor) ! 2;
         |SI enImporte > nValor;
             enImporte = nValor;
         |FINSI;

         |SI enImporte < 0;  enImporte = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 6;
         eaCasilla = "149";
         |HAZ GrabaLineal;
     |FINSI;

     enBloque = 7;  eaCasilla = "178"; |HAZ SacaImporte;  nValor = enImporte;
     |SI nValor > 0;
         enImporte = ((nRdto / #datfic3@#33) * nValor) ! 2;
         |SI enImporte > nValor;
             enImporte = nValor;
         |FINSI;

         |SI enImporte < 0;  enImporte = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 7;
         eaCasilla = "179";
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO Ded_32_3;
     |SI #datfic3@#29 ! "S";  |ACABA;  |FINSI;

     enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte;  nValor = enImporte;
     enBloque = 5;  eaCasilla = "122"; |HAZ SacaImporte;  nValor = nValor - enImporte;
     enBloque = 5;  eaCasilla = "123"; |HAZ SacaImporte;  nValor = nValor - enImporte;

     |SI nValor > 0;
         enImporte = nValor % 20;
         |SI enImporte > 20000;
             enImporte = 20000;
         |FINSI;
     |SINO;
         enImporte = 0;
     |FINSI;

     enSwAcum  = 0;
     enBloque  = 5;
     eaCasilla = "124";
     |HAZ GrabaLineal;
|FPRC;

|PROCESO TotActividad;
     enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 5;  eaCasilla = "122"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 5;  eaCasilla = "123"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 5;  eaCasilla = "124"; |HAZ SacaImporte; nValor = nValor - enImporte;

     enBloque = 5;  eaCasilla = "121"; |HAZ SacaImporte;
     |SI enImporte ] 0;
         |SI nValor < 0;  nValor = 0;   |FINSI;
     |FINSI;

     enSwAcum  = 0;
     enBloque  = 5;
     eaCasilla = "125";
     enImporte = nValor;
     |HAZ GrabaLineal;

     enBloque = 6;  eaCasilla = "148"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 6;  eaCasilla = "149"; |HAZ SacaImporte; nValor = nValor - enImporte;

     enBloque = 6;  eaCasilla = "148"; |HAZ SacaImporte;
     |SI enImporte ] 0;
         |SI nValor < 0;  nValor = 0;   |FINSI;
     |FINSI;

     enSwAcum  = 0;
     enBloque  = 6;
     eaCasilla = "150";
     enImporte = nValor;
     |HAZ GrabaLineal;

     enBloque = 7;  eaCasilla = "178"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 7;  eaCasilla = "179"; |HAZ SacaImporte; nValor = nValor - enImporte;

     enBloque = 7;  eaCasilla = "178"; |HAZ SacaImporte;
     |SI enImporte ] 0;
         |SI nValor < 0;  nValor = 0;   |FINSI;
     |FINSI;

     enSwAcum  = 0;
     enBloque  = 7;
     eaCasilla = "180";
     enImporte = nValor;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO rem01022;
     |SI nVal122 = 0;
         nRdto = 0;
         |SI nTotRenta < 8000;
             nRdto = 1620;
         |SINO;
             |SI nTotRenta < 12000;
                 nRdto = (N\ 1620 - (0.405 * (nTotRenta - 8000)));
             |FINSI;
         |FINSI;

         |SI #datfic1@#22 > 3700;
             nRdto = 0;
         |SINO;
             nSuma = #datfic1@#22 + nRdto;
             |SI nSuma > 3700;
                 nRdto = 3700 - #datfic1@#22;
             |FINSI;
         |FINSI;

         nValor = #datfic4@#21;
         |SI nValor > 0;
             enImporte = ((nRdto / #datfic3@#33) * nValor) ! 2;
             |SI enImporte > nValor;
                 enImporte = nValor;
             |FINSI;

             |SI enImporte < 0;  enImporte = 0;  |FINSI;

             #datfic4@#20 = enImporte;
             #datfic4@#21 = (N\ #datfic4@#18 - #datfic4@#19 - #datfic4@#20);
         |FINSI;
     |FINSI;

     |SI #datfic4@#36 = "S";
         #datfic4@#20 = (N\ #datfic4@#20 + (#datfic4@#21 % 20));
     |FINSI;

     #datfic4@#21 = (N\ #datfic4@#18 - #datfic4@#19 - #datfic4@#20);

     |GRABA 020#datfic4@.a;
     |LIBERA #datfic4@;

     #datfic5@#0 = #refere1@#0;
     #datfic5@#1 = #refere1@#1;
     #datfic5@#2 = #refere1@#2;
     |LEE 101#datfic5@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic5@;
         #datfic5@#0 = #refere1@#0;
         #datfic5@#1 = #refere1@#1;
         #datfic5@#2 = #refere1@#2;
         |GRABA 020#datfic5@.b;
     |FINSI;

     nImporte      = #datfic5@#7;
     nImporte      = nImporte + #datfic4@#21;
     #datfic5@#7   = nImporte;
     |GRABA 020#datfic5@.a;
     |LIBERA #datfic5@;

     enSwAcum  = 0;
     enBloque  = 8;
     eaCasilla = "216";  enImporte = #datfic5@#7;   |HAZ GrabaLineal;
|FPRC;

|DEFBUCLE rem01022;
     #datfic4@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     be;
     NULL, rem01022;
|FIN;

|PROCESO Ded_32_2_3_Comuneros;
     enBloque = 5;  eaCasilla = "122"; |HAZ SacaImporte;  nVal122 = enImporte;

     aDef    = eaPathDef + "rem01022.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1022"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic5@;
     |SI FSalida ! 0;
         |DESCARGA_DEF #datfic4@;

         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic5@#"zdat1026"#;  |FINSI;

     |ABRE #datfic5@;
     |BUCLE rem01022;
     |CIERRA #datfic5@;

     |DESCARGA_DEF #datfic5@;
     |DESCARGA_DEF #datfic4@;
|FPRC;

|PROCESO CalculaA;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1018"#;  |FINSI;

     |ABRE #rew99999;
     |SELECT #2#rew99999;
     #rew99999#1 = #refere1@#2;
     |LEE 040#rew99999.=;
     |SI FSalida  ! 0;  |DDEFECTO #rew99999;  |FINSI;
     |CIERRA #rew99999;

     |ABRE #datfic1@;
     #datfic1@#0 = #refere1@#0;
     #datfic1@#1 = #refere1@#1;
     #datfic1@#2 = #refere1@#2;
     |LEE 040#datfic1@.=;
     |SI FSalida ! 0;
         |DDEFECTO #datfic1@;
         #datfic1@#0 = #refere1@#0;
         #datfic1@#1 = #refere1@#1;
         #datfic1@#2 = #refere1@#2;
         |GRABA 020#datfic1@.b;
     |FINSI;

     |ABRE #datfic2@;
     #datfic2@#0 = #refere1@#0;
     #datfic2@#1 = #refere1@#1;
     #datfic2@#2 = #refere1@#2;
     |LEE 000#datfic2@.=;
     |SI FSalida ! 0;  |DDEFECTO #datfic2@;  |FINSI;
     |CIERRA #datfic2@;

     |ABRE #datfic3@;
     |DDEFECTO #datfic3@;
     #datfic3@#0 = #refere1@#0;
     #datfic3@#1 = #refere1@#1;
     #datfic3@#2 = #refere1@#2;
     |LEE 101#datfic3@.=;
     |SI FSalida = 0;
         |SI #datfic3@#3 < 0;  #datfic3@#3 = 0;  |FINSI;
         |SI #datfic3@#4 < 0;  #datfic3@#4 = 0;  |FINSI;
         |SI #datfic3@#5 < 0;  #datfic3@#5 = 0;  |FINSI;
         |SI #datfic3@#6 < 0;  #datfic3@#6 = 0;  |FINSI;

         #datfic3@#33 = #datfic3@#3 + #datfic3@#4 + #datfic3@#5 + #datfic3@#6;

         |GRABA 020#datfic3@.a;
         |LIBERA #datfic3@;
     |FINSI;
     |CIERRA #datfic3@;

     nTotRenta = 0;
     enBloque = 2;  eaCasilla = "035"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 3;  eaCasilla = "045"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 4;  eaCasilla = "070"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 8;  eaCasilla = "213"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 8;  eaCasilla = "214"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 8;  eaCasilla = "217"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 8;  eaCasilla = "218"; |HAZ SacaImporte; nTotRenta = nTotRenta - enImporte;
     enBloque = 8;  eaCasilla = "220"; |HAZ SacaImporte; nTotRenta = nTotRenta - enImporte;
     enBloque = 9;  eaCasilla = "235"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 10; eaCasilla = "240"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 11; eaCasilla = "244"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 12; eaCasilla = "250"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 24; eaCasilla = "364"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 24; eaCasilla = "365"; |HAZ SacaImporte; nTotRenta = nTotRenta - enImporte;
     enBloque = 25; eaCasilla = "368"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;
     enBloque = 25; eaCasilla = "369"; |HAZ SacaImporte; nTotRenta = nTotRenta - enImporte;

     nTotRenta    = nTotRenta + #datfic3@#14;   || Suma de mayor de 65 y 68
     nTotRenta    = nTotRenta + #datfic3@#7;    || 118
     nTotRenta    = nTotRenta + #datfic3@#11;   || 143
     nTotRenta    = nTotRenta + #datfic3@#13;   || 172
     nTotRenta    = nTotRenta + #datfic3@#8;    || 185 + #191 + 195
     nTotRenta    = nTotRenta + #datfic3@#9;    || 201

     |SI enConta = 1;  enRdtosTrab1 = #datfic1@#17;  enActivo1 = #datfic1@#27;  |FINSI;
     |SI enConta = 2;  enRdtosTrab2 = #datfic1@#17;  enActivo2 = #datfic1@#27;  |FINSI;
     |SI enConta = 3;  enRdtosTrab3 = #datfic1@#17;  enActivo3 = #datfic1@#27;  |FINSI;
     |SI enConta = 4;  enRdtosTrab4 = #datfic1@#17;  enActivo4 = #datfic1@#27;  |FINSI;
     |SI enConta = 5;  enRdtosTrab5 = #datfic1@#17;  enActivo5 = #datfic1@#27;  |FINSI;
     |SI enConta = 6;  enRdtosTrab6 = #datfic1@#17;  enActivo6 = #datfic1@#27;  |FINSI;
     |SI enConta > 6;  enRdtosTrab7 = #datfic1@#17;                             |FINSI;

     |SI enConta = 3;  enRentas3 = enRentas3 + #datfic1@#17; |FINSI;
     |SI enConta = 4;  enRentas4 = enRentas4 + #datfic1@#17; |FINSI;
     |SI enConta = 5;  enRentas5 = enRentas5 + #datfic1@#17; |FINSI;
     |SI enConta = 6;  enRentas6 = enRentas6 + #datfic1@#17; |FINSI;

     nRdto = 0;
     |SI #datfic1@#17 > 0;
         |SI #datfic1@#17 [ 14450; |Y nTotRenta < 6500.01;
             |SI #datfic1@#17 < 11250;
                 nRdto = 3700;
             |SINO;
                 |SI #datfic1@#17 ] 11250;  |Y #datfic1@#17 [ 14450;
                     nRdto = (3700 - (1.15625 * (#datfic1@#17 - 11250))) ! 2;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     nRdtoMov = 0;
     |SI #datfic1@#17 > 0;
         nRdtoMov = 2652;

         |SI #datfic1@#17 [ 13260; |Y nTotRenta < 6500.01;
             |SI #datfic1@#17 < 9180;
                 nRdtoMov = 4080;
             |SINO;
                 |SI #datfic1@#17 ] 9180;  |Y #datfic1@#17 [ 13260;
                     nRdtoMov = (4080 - (0.35 * (#datfic1@#17 - 9180))) ! 2;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     enCam22  = nRdto;

     nImporte = 0;
     enCam19  = 0;
     enCam23  = 0;

     |ABRE #rem00019;
     |SI enConta = 1;
         enRedTrab1 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "TITULAR";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_1   = #rem00019#3;
         enEjerMo1  = #rem00019#4;
         nImporte  = 0;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;       |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab1;  |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab1 ! 0;  |Y enActivo1 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab1 ! 0;  |Y enActivo1 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte; enCam20 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 2;
         enRedTrab2 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "CONYUGE";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_2  = #rem00019#3;
         enEjerMo2 = #rem00019#4;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;       |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab2;  |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab2 ! 0;  |Y enActivo2 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab2 ! 0;  |Y enActivo2 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte;  enCam20 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 3;
         enRedTrab3 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "1 FAMILIAR";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_3  = #rem00019#3;
         enEjerMo3 = #rem00019#4;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;       |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab3;  |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab3 ! 0;  |Y enActivo3 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab3 ! 0;  |Y enActivo3 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte;  enCam20 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 4;
         enRedTrab4 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "2 FAMILIAR";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_4  = #rem00019#3;
         enEjerMo4 = #rem00019#4;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;       |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab4;  |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab4 ! 0;  |Y enActivo4 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab4 ! 0;  |Y enActivo4 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte;  enCam20 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 5;
         enRedTrab5 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "3 FAMILIAR";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_5  = #rem00019#3;
         enEjerMo5 = #rem00019#4;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;      |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab5; |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab5 ! 0;  |Y enActivo5 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab5 ! 0;  |Y enActivo5 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte; enCam20 = nImporte;  |FINSI;
     |FINSI;

     |SI enConta = 6;
         enRedTrab6 = nRdtoMov;

         #rem00019#0     = #datfic1@#0;
         #rem00019#1     = "4 FAMILIAR";
         |LEE 000#rem00019.=;
         |SI FSalida ! 0;  |DDEFECTO #rem00019;  |FINSI;

         eaMov3_6  = #rem00019#3;
         enEjerMo6 = #rem00019#4;

         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2015;  enCam19 = 2000;      |FINSI;
         |SI #rem00019#3 = "S";  |Y #rem00019#4 = 2014;  enCam23 = enRedTrab6; |FINSI;

         |SI #rew99999#3 ] 33;  |Y #rew99999#3 < 65;
            |Y enRdtosTrab6 ! 0;  |Y enActivo6 ! 0;
               |SI #rew99999#4 = "N";
                   nImporte = nImporte + 3500;
               |SINO;
                   nImporte = nImporte + 7750;
               |FINSI;
         |FINSI;

         |SI #rew99999#3 ] 65; |Y enRdtosTrab6 ! 0;  |Y enActivo6 ! 0;
             nImporte = nImporte + 7750;
         |FINSI;

         |SI enCam20 < nImporte;  enCam20 = nImporte;  |FINSI;
     |FINSI;

     #datfic1@#18 = 2000;
     #datfic1@#20 = nImporte;

     |SI enConta > 6;
         enRedTrab1 = nRdtoMov;

         |SI eaMov3_1 = "S"; |Y enEjerMo1 = 2015; enCam19  = 2000;  |FINSI;
         |SI eaMov3_2 = "S"; |Y enEjerMo2 = 2015; enCam19  = 2000;  |FINSI;
         |SI eaMov3_3 = "S"; |Y enEjerMo3 = 2015; enCam19  = 2000;  |FINSI;
         |SI eaMov3_4 = "S"; |Y enEjerMo4 = 2015; enCam19  = 2000;  |FINSI;
         |SI eaMov3_5 = "S"; |Y enEjerMo5 = 2015; enCam19  = 2000;  |FINSI;
         |SI eaMov3_6 = "S"; |Y enEjerMo6 = 2015; enCam19  = 2000;  |FINSI;

         |SI eaMov3_1 = "S"; |Y enEjerMo1 = 2014; enCam23  = enRedTrab1;  |FINSI;
         |SI eaMov3_2 = "S"; |Y enEjerMo2 = 2014; enCam23  = enRedTrab1;  |FINSI;
         |SI eaMov3_3 = "S"; |Y enEjerMo3 = 2014; enCam23  = enRedTrab1;  |FINSI;
         |SI eaMov3_4 = "S"; |Y enEjerMo4 = 2014; enCam23  = enRedTrab1;  |FINSI;
         |SI eaMov3_5 = "S"; |Y enEjerMo5 = 2014; enCam23  = enRedTrab1;  |FINSI;
         |SI eaMov3_6 = "S"; |Y enEjerMo6 = 2014; enCam23  = enRedTrab1;  |FINSI;

         #datfic1@#20 = enCam20;
     |FINSI;
     |CIERRA #rem00019;

     #datfic1@#19 = enCam19;
     #datfic1@#23 = enCam23;

     |SI #datfic1@#23 > 0;
         #datfic1@#19 = 0;
     |FINSI;

     enBloque = 1;  eaCasilla = "015"; |HAZ SacaImporte;
     |SI enImporte < 0;
         #datfic1@#18 = 0;
         #datfic1@#19 = 0;
         #datfic1@#20 = 0;
     |SINO;
         nSuma = enImporte;
         |SI #datfic1@#18 ] nSuma;
             #datfic1@#18 = nSuma;
             nSuma = 0;
         |SINO;
             nSuma = nSuma - #datfic1@#18;
         |FINSI;

         |SI nSuma > 0;
             |SI #datfic1@#19 ] nSuma;
                 #datfic1@#19 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #datfic1@#19;
             |FINSI;
         |SINO;
             #datfic1@#19 = 0;
         |FINSI;

         |SI nSuma > 0;
             |SI #datfic1@#20 ] nSuma;
                 #datfic1@#20 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #datfic1@#20;
             |FINSI;
         |SINO;
             #datfic1@#20 = 0;
         |FINSI;
     |FINSI;

     #datfic1@#21 = (N\ #datfic1@#17 - #datfic1@#18 - #datfic1@#19 - #datfic1@#20);

     |SI enCam22 > #datfic1@#21;
         enCam22 = #datfic1@#21;
     |FINSI;

     #datfic1@#22 = enCam22;
     |SI #datfic1@#22 < 0;  #datfic1@#22 = 0;  |FINSI;

     |SI #datfic1@#21 < 0;
         #datfic1@#9  = 0;
         #datfic1@#22 = 0;
         #datfic1@#23 = 0;
     |SINO;
         nSuma  = #datfic1@#21 + #datfic1@#9;

         |SI #datfic1@#22 ] nSuma;
             #datfic1@#22 = nSuma;
             nSuma = 0;
         |SINO;
             nSuma = nSuma - #datfic1@#22;
         |FINSI;

         |SI nSuma > 0;
             |SI #datfic1@#23 ] nSuma;
                 #datfic1@#23 = nSuma;
                 nSuma = 0;
             |SINO;
                 nSuma = nSuma - #datfic1@#23;
             |FINSI;
         |SINO;
             #datfic1@#23 = 0;
         |FINSI;
     |FINSI;

     #datfic1@#24 = (N\ #datfic1@#21 - #datfic1@#22 - #datfic1@#23);
     |SI #datfic1@#24 < 0;  |Y #datfic1@#21 ] 0;
         #datfic1@#24 = 0;
     |FINSI;

     |GRABA 020#datfic1@.a;
     |LIBERA #datfic1@;
     |CIERRA #datfic1@;

     enSwAcum  = 0;
     enBloque  = 1;
     eaCasilla = "016";  enImporte = #datfic1@#18;  |HAZ GrabaLineal;
     eaCasilla = "017";  enImporte = #datfic1@#19;  |HAZ GrabaLineal;
     eaCasilla = "018";  enImporte = #datfic1@#20;  |HAZ GrabaLineal;
     eaCasilla = "019";  enImporte = #datfic1@#21;  |HAZ GrabaLineal;
     eaCasilla = "020";  enImporte = #datfic1@#22;  |HAZ GrabaLineal;
     eaCasilla = "021";  enImporte = #datfic1@#23;  |HAZ GrabaLineal;
     eaCasilla = "022";  enImporte = #datfic1@#24;  |HAZ GrabaLineal;

     || Y ahora suma los dtos. del trabajo que antes no pasaba.
     enBloque = 1;  eaCasilla = "019"; |HAZ SacaImporte; nTotRenta = nTotRenta + enImporte;

     |HAZ Ded_32_2_1;
     |HAZ Ded_32_2_3;
     |HAZ Ded_32_3;
     |HAZ TotActividad;
     |HAZ Ded_32_2_3_Comuneros;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;
