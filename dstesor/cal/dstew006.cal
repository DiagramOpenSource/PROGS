|FICHEROS;
   dstew006 #0;
   dstew007 #10,MANTE;
   dstez001 #11;

   Referen@ #1000;
   Refere1@ #1001;
|FIN;

|VARIABLES;
   &enPantw006 = 0;
   &enPantw007 = 0;
   &enPanta3   = 0;
   nGrid  = 0;
   nCalc  = 0;
   nCalc1 = 0;
   nCalc2 = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aCuenta = "";

   nVent11 = 0;
|FIN;

|PROCESO Tipo00Nif;
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/def/caclipro.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "contagen/fich/" + (("00000" + #48#2) % -105) + #48#3 + "/";
      |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      |SI nGrid = 1;
         nGrid = 0;
         |SELECT #4#Referen@;
         #Referen@#9 = #dstew006#0;
         |LEE 000#Referen@.];
         |SELECT #1#Referen@;
         |CONSULTA_CLAVE #4#Referen@;
         |SI FSalida = 0;
            #dstew006#0 = #Referen@#9; |PINTA #dstew006#0;
            #dstew006#1 = #Referen@#1; |PINTA #dstew006#1;
            #dstew006#2 = #Referen@#10;
            |ERROR;
         |FINSI;
      |SINO;
         |SELECT #4#Referen@;
         #Referen@#9 = #dstew006#0;
         |LEE 000#Referen@.=;
         |SI FSalida ! 0;
            |DDEFECTO #dstew007;
            #dstew007#0 = #dstew006#0; |C_M #dstew007#1, 1, "S";
            |DBASS aAlfa; |QBF aAlfa;
            aAlfa = aAlfa + "dscomer9/def/agenm007.mas";
            |CARGA_DEF aAlfa, Refere1@;
            |SI FSalida = 0;
               |DBASS aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + "dscomer9/fich/" + (("00000" + #48#2)% -105) + "/";
               |PATH_DAT #Refere1@#aAlfa#;
               |ABRE #Refere1@;
               |LEE 000#Refere1@.p;
               |SI FSalida ! 0; |DDEFECTO #Refere1@; |FINSI;
               #dstew007#2 = #Refere1@#13;
               #dstew007#3 = #Refere1@#14;
               #dstew007#5 = #Refere1@#15;
               |CIERRA #Refere1@; |DESCARGA_DEF #Refere1@;
            |FINSI;
            ||VENTANA 1011, 1965, -1, -1, ""; nVent11 = FSalida;
            |BORRA_HIJOS_PAN #3#dstez001;
            |SUB_PINPA #0#dstew007,enPanta3; enPantw007 = FSalida;
            |PINDA #0#dstew007;
            |CONFI "    SNif inexistente. Dar de alta ? ";
            |SI FSalida = 0;
               |DBASS aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + "contagen/def/caclipro.mas";
               |CARGA_DEF aAlfa, Refere1@;
               |SI FSalida = 0;
                  |DBASS aAlfa; |QBF aAlfa;
                  aAlfa = aAlfa + "contagen/fich/" + (("00000" + #48#2)% -105) + #48#3 + "/";
                  |PATH_DAT #Refere1@#aAlfa#; |ABRE #Refere1@;
                  |ENDATOS #1#dstew007;
                  |SI FSalida = 0;
                     #dstew006#1 = #dstew007#1; |PINTA #dstew006#1;
                     #dstew006#2 = #dstew007#4; |PINTA #dstew006#2;
                     |DDEFECTO #Refere1@;
                     #Refere1@#23 = "P";
                     #Refere1@#10 = #dstew006#2;
                     #Refere1@#1 = #dstew007#1;
                     #Refere1@#9 = #dstew007#0;
                     |GRABA 020#Refere1@.n;
                  |FINSI;
                  |CIERRA #Refere1@; |DESCARGA_DEF #Refere1@;
               |FINSI;
            |SINO;
               |ERROR;
            |FINSI;
            |BORRA_HIJOS_PAN #3#dstez001;
            |SUB_PINPA #0#dstew006,enPanta3; |PINDA #0#dstew006;
            ||FINVENTANA nVent11;
         |SINO;
            #dstew006#0 = #Referen@#9; |PINTA #dstew006#0;
            #dstew006#1 = #Referen@#1; |PINTA #dstew006#1;
            #dstew006#2 = #Referen@#10;
         |FINSI;
         |SELECT #1#Referen@;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;

|PROCESO Tipo66Nif; |TIPO 66;
   nGrid = 1; |HAZ Tipo00Nif;
|FPRC;

|PROCESO Tipo00Nom;
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "contagen/def/caclipro.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DBASS aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + "contagen/fich/" + (("00000" + #48#2) % -105) + #48#3 + "/";
      |PATH_DAT #Referen@#aAlfa#;
      |ABRE #Referen@;
      |SI nGrid = 1;
         nGrid = 0;
         |SELECT #2#Referen@;
         #Referen@#1 = #dstew006#0;
         |LEE 000#Referen@.];
         |SELECT #1#Referen@;
         |CONSULTA_CLAVE #2#Referen@;
         |SI FSalida = 0;
            #dstew006#0 = #Referen@#9; |PINTA #dstew006#0;
            #dstew006#1 = #Referen@#1; |PINTA #dstew006#1;
            #dstew006#2 = #Referen@#10;
            |ERROR;
         |FINSI;
      |SINO;
         |SELECT #2#Referen@;
         #Referen@#1 = #dstew006#1;
         |LEE 000#Referen@.=;
         |SI FSalida ! 0;
            |DDEFECTO #dstew007;
            #dstew007#0 = #dstew006#0;
            #dstew007#1 = #dstew006#1; |C_M #dstew007#1, 1, "N";
            |DBASS aAlfa; |QBF aAlfa;
            aAlfa = aAlfa + "dscomer9/def/agenm007.mas";
            |CARGA_DEF aAlfa, Refere1@;
            |SI FSalida = 0;
               |DBASS aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + "dscomer9/fich/" + (("00000" + #48#4)% -105) + "/";
               |PATH_DAT #Refere1@#aAlfa#;
               |ABRE #Refere1@;
               |LEE 000#Refere1@.p;
               |SI FSalida ! 0; |DDEFECTO #Refere1@; |FINSI;
               #dstew007#2 = #Refere1@#13;
               #dstew007#3 = #Refere1@#14;
               #dstew007#5 = #Refere1@#15;
               |CIERRA #Refere1@; |DESCARGA_DEF #Refere1@;
            |FINSI;
            |BORRA_HIJOS_PAN #3#dstez001;
            |SUB_PINPA #0#dstew007,enPanta3; enPantw007 = FSalida;
            |PINDA #0#dstew007;
            |CONFI "    SNif inexistente. Dar de alta ? ";
            |SI FSalida = 0;
               |DBASS aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + "contagen/def/caclipro.mas";
               |CARGA_DEF aAlfa, Refere1@;
               |SI FSalida = 0;
                  |DBASS aAlfa; |QBF aAlfa;
                  aAlfa = aAlfa + "contagen/fich/" + (("00000" + #48#2)% -105) + #48#3 + "/";
                  |PATH_DAT #Refere1@#aAlfa#; |ABRE #Refere1@;
                  |ENDATOS #1#dstew007;
                  |SI FSalida = 0;
                     #dstew006#2 = #dstew007#4; |PINTA #dstew006#2;
                     |DDEFECTO #Refere1@;
                     #Refere1@#23 = "P";
                     #Refere1@#10 = #dstew006#2;
                     #Refere1@#1 = #dstew007#1;
                     #Refere1@#9 = #dstew007#0;
                     |GRABA 020#Refere1@.n;
                  |FINSI;
                  |CIERRA #Refere1@; |DESCARGA_DEF #Refere1@;
               |FINSI;
            |SINO;
               |ERROR;
            |FINSI;
            |BORRA_HIJOS_PAN #3#dstez001;
            |SUB_PINPA #0#dstew006,enPanta3; |PINDA #0#dstew006;
         |SINO;
            #dstew006#0 = #Referen@#9; |PINTA #dstew006#0;
            #dstew006#1 = #Referen@#1; |PINTA #dstew006#1;
            #dstew006#2 = #Referen@#10;
         |FINSI;
         |SELECT #1#Referen@;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;

|PROCESO Tipo66Nom; |TIPO 66;
   nGrid = 1; |HAZ Tipo00Nom;
|FPRC;
