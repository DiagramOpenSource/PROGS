|FICHEROS;
     dsnetm02 #2;
     dsnetm03 #3,MANTE;
     dsnetm04 #4;
     dsnetm08 #8;
     dsnetm09 #9;
     dsnetm10 #10;
     dsnetw01 #100;
     dsnetw02 #101;
|FIN;

|VARIABLES;
     nModo     = 0;
     nForma    = 0;
     nSwHay    = 0;

     aFichero  = "";
|FIN;

|RUTINA ClaveBaja101;
     #101#0 = 0;
     #101#1 = 0;
     #101#2 = 0;
|FRUT;

|RUTINA ClaveAlta101;
     #101#0 = 999;
     #101#1 = 999;
     #101#2 = 999;
|FRUT;

|PROCESO Graba04;
     #4#0 = #3#0;
     #4#1 = #3#1;
     #4#2 = #101#0;
     #4#3 = #101#1;
     #4#4 = #101#2;
     #4#5 = #101#5;
     |GRABA 020#4n;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dsnetw02;
     #101#1;
     4;
     000, 000, 000, "S";
     999, 999, 999, "S";
     ;
     NULL, Graba04;
|FIN;

|PROCESO dsnetm10;
     #101#0 = #10#0;
     #101#1 = #10#1;
     #101#2 = #10#2;
     #101#3 = "          " + #10#3;
     #101#4 = "S";
     #101#5 = #10#3;

     |SI nSwHay = 1;
         #4#0 = #3#0;
         #4#1 = #3#1;
         #4#2 = #10#0;
         #4#3 = #10#1;
         #4#4 = #10#2;
         |LEE 040#4=;
         |SI FSalida ! 0;
             #101#4 = "N";
         |FINSI;
     |FINSI;

     |GRABA 020#101n;
     |LIBERA #101;
|FPRC;

|DEFBUCLE dsnetm10;
     #10#1;
     ;
     #9#0, #9#1, 000;
     #9#0, #9#1, 999;
     ;
     NULL, dsnetm10;
|FIN;

|PROCESO dsnetm09;
     #101#0 = #9#0;
     #101#1 = #9#1;
     #101#2 = 0;
     #101#3 = "     " + #9#2;
     #101#4 = "S";
     #101#5 = #9#2;

     |SI nSwHay = 1;
         #4#0 = #3#0;
         #4#1 = #3#1;
         #4#2 = #9#0;
         #4#3 = #9#1;
         #4#4 = 0;
         |LEE 040#4=;
         |SI FSalida ! 0;
             #101#4 = "N";
         |FINSI;
     |FINSI;

     |GRABA 020#101n;
     |LIBERA #101;

     |BUCLE dsnetm10;
|FPRC;

|DEFBUCLE dsnetm09;
     #9#1;
     ;
     #8#0, 000;
     #8#0, 999;
     ;
     NULL, dsnetm09;
|FIN;

|PROCESO dsnetm08;
     #101#0 = #8#0;
     #101#1 = 0;
     #101#2 = 0;
     #101#3 = #8#1;
     #101#4 = "S";
     #101#5 = #8#1;

     |SI nSwHay = 1;
         #4#0 = #3#0;
         #4#1 = #3#1;
         #4#2 = #8#0;
         #4#3 = 0;
         #4#4 = 0;
         |LEE 040#4=;
         |SI FSalida ! 0;
             #101#4 = "N";
         |FINSI;
     |FINSI;

     |GRABA 020#101n;
     |LIBERA #101;

     |BUCLE dsnetm09;
|FPRC;

|DEFBUCLE dsnetm08;
     #8#1;
     ;
     000;
     999;
     ;
     NULL, dsnetm08;
|FIN;

|RUTINA ClaveBaja4;
     #4#0 = #3#0;
     #4#1 = #3#1;
     #4#2 = 0;
     #4#3 = 0;
     #4#4 = 0;
|FRUT;

|RUTINA ClaveAlta4;
     #4#0 = #3#0;
     #4#1 = #3#1;
     #4#2 = 999;
     #4#3 = 999;
     #4#4 = 999;
|FRUT;

|PROCESO Borra04_m3;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dsnetm04B_m3;
     #4#1;
     ;
     #3#0, #3#1, 000, 000, 000;
     #3#0, #3#1, 999, 999, 999;
     be;
     NULL, Borra04_m3;
|FIN;

|PROCESO ClaveBaja3;
     #3#0 = #2#0;
     #3#1 = "          ";
|FPRC;

|PROCESO ClaveAlta3;
     #3#0 = #2#0;
     #3#1 = "zzzzzzzzzz";
|FPRC;

|PROCESO Tipo2m3;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
         |BUCLE dsnetm04B_m3;
         |ACABA;
     |FINSI;

     nForma = 0 +. 1;
     |SI nForma = 1;
         nSwHay = 0;
         |ABRE #4;
         #4#0 = #3#0;
         #4#1 = #3#1;
         #4#2 = 0;
         #4#3 = 0;
         #4#4 = 0;
         |LEE 040#4];
         |SI FSalida = 0;  |Y  #4#0 = #3#0;  |Y #4#1 = #3#1;
             nSwHay = 1;
         |FINSI;

         aFichero = ("02" + Usuario + "zzzzzzzz") % 108;
         |NOME_DAT #101 aFichero;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;

         |ABRE #101;
         |BUCLE dsnetm08;
         |CIERRA #101;
         |CIERRA #4;

         |PUSHV 0501 2380;
         |ENTLINEAL #1#101, -1, 4, 22, 1, ClaveBaja101, ClaveAlta101;
         |POPV;

         |BUCLE dsnetm04B_m3;

         |ABRE #4;
         |BUCLE dsnetw02;
         |CIERRA #4;

         |DELINDEX #101;
     |FINSI;
|FPRC;

|PROCESO Tipo7m3;  |TIPO 7;
     |ENTLINEAL #1#4, -3, 7, 22, 0, ClaveBaja4, ClaveAlta4;
|FPRC;

|PROCESO Accesos;
     |PUSHV 0501 2380;
     #100#0 = #2#0;
     #100#1 = #2#1;
     |PINPA #0#100;
     |PINDA #0#100;
     |ENTLINEAL #1#3, -2, 2, 22, 1, ClaveBaja3, ClaveAlta3;
     |POPV;
|FPRC;
