|FICHEROS;
     dsnetm00 #0;
     dsnetm02 #2;
|FIN;

|VARIABLES;
     aAlfa       = "";
     aAbre       = "";
     aBase       = "";

     nBaffer     = 0;
     nHandle     = 0;
     nOpcion     = 0;
     nCogeOpcion = 0;

     &enConta      = 0;
     &eaAplicacion = "";
|FIN;

|PROCESO SacaCuadro;
     |PUSHV 0501 2380;
     |LEESECUENCIAL aAbre, nBaffer, enConta, 0, 0;
     |PARA; |SI;  |HACIENDO;
            nOpcion = 1;
            |BMENUG nBaffer, 0, 1, 10, 65, nOpcion;
            nOpcion     = FSalida;
            nCogeOpcion = nOpcion - 1;
            |SI FSalida [ enConta; |Y FSalida ] 1;
                |DEL_BUF nBaffer, nCogeOpcion, aAlfa;

                |QBF aAlfa;
                eaAplicacion = aAlfa;
                |SAL;
             |FINSI;
      |SIGUE;
      |POPV;
|FPRC;

|PROCESO GrabaTxt;
     enConta = enConta + 1;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO CargaTxt;
     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#2 = "S";  |Y #2#6 = "S";
         aAlfa = "CONTABIL";  |HAZ GrabaTxt;
     |FINSI;

     |SI #0#3 = "S";  |Y #2#7 = "S";
         aAlfa = "FISCAL";    |HAZ GrabaTxt;
     |FINSI;

     |SI #0#4 = "S";  |Y #2#8 = "S";
         aAlfa = "SOCIEDAD";    |HAZ GrabaTxt;
     |FINSI;

     |SI #0#5 = "S";  |Y #2#9 = "S";
         aAlfa = "RENTA";    |HAZ GrabaTxt;
     |FINSI;

     |SI #0#6 = "S";  |Y #2#10 = "S";
         aAlfa = "LABORAL";    |HAZ GrabaTxt;
     |FINSI;
|FPRC;

|PROCESO AbreTxtAplicacion;
     enConta = 0;

     |DBASE aAbre;  |QBF aBase;
     aAbre = aAbre + "aplica.txt";
     |XABRE "W", aAbre, nHandle;
     |HAZ CargaTxt;
     |XCIERRA nHandle;
|FPRC;

|PROCESO BorraAplicacion;
     |FBORRA aAbre;
     |FINDIM nBaffer;
|FPRC;
