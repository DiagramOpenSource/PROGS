|FICHEROS;
     dsnetm00 #0;
     dsnetm06 #6,MANTE;
     dsnetm07 #7,MANTE;

     &refer01@ #900;
|FIN;

|VARIABLES;
     aBase      = "";
     aFich      = "";
     aMas       = "";
     aDef       = "";
     aAlfa      = "";
|FIN;

|PROCESO Tipo11m103;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |SI aDef ! "canempre";
         #900#0 = #7#2;
     |SINO;
         #900#2 = #7#2;
     |FINSI;

     |LEE 040#900];
     |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;

     |CONSULTA_CLAVE #1#900;
     |SI aDef ! "canempre";
         |SI FSalida = 0;  #7#2 = #900#0;  |FINSI;
     |SINO;
         |SI FSalida = 0;  #7#2 = #900#2;  |FINSI;
     |FINSI;

     |PINTA #7#2;
|FPRC;

|PROCESO LeeEmpresa;  |TIPO 7;
     |C_M #7#3, 1, "N";

     |SI aDef ! "canempre";
         #900#0 = #7#2;
     |SINO;
         #900#2 = #7#2;
     |FINSI;
     |LEE 040#900];
     |SI FSalida ! 0;
         |MENAV "0000 No existe la Empresa.";
         |C_M #7#3, 1, "S";
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aDef ! "canempre";
         |SI #900#0 ! #7#2;
             |MENAV "0000 No existe la Empresa.";
             |C_M #7#3, 1, "S";
             |PTEC 807;
             |ACABA;
         |FINSI;
     |SINO;
         |SI #900#2 ! #7#2;
             |MENAV "0000 No existe la Empresa.";
             |C_M #7#3, 1, "S";
             |PTEC 807;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI aDef = "agifigen";
         aAlfa = #900#1;  |QBF aAlfa;
         |SI aAlfa = "";
             aAlfa = #900#2;  |QBF aAlfa;
         |FINSI;
         #7#3 = aAlfa;
     |FINSI;

     |SI aDef = "labempre";
         #7#3 = #900#2;
     |FINSI;

     |SI aDef = "canempre";
         aAlfa = #900#1;  |QBF aAlfa;
         |SI aAlfa = "";
             aAlfa = #900#4;  |QBF aAlfa;
         |FINSI;
         #7#3 = aAlfa;
     |FINSI;

     |SI aDef = "eosclien";
         aAlfa = #900#2;  |QBF aAlfa;
         |SI aAlfa = "";
             aAlfa = #900#3;  |QBF aAlfa;
         |FINSI;
         #7#3 = aAlfa;
     |FINSI;

     |SI aDef = "maacceso";
         #7#3 = #900#2;
     |FINSI;

     |SI aDef = "reacceso";
         #7#3 = #900#2;
     |FINSI;

     |PINTA #7#3;
|FPRC;

|PROCESO ClaveBaja7;
     #7#0 = #6#0;
     #7#1 = #6#1;
     #7#2 = 00001;
|FPRC;

|PROCESO ClaveAlta7;
     #7#0 = #6#0;
     #7#1 = #6#1;
     #7#2 = 99999;
|FPRC;

|PROCESO SacaEmpresas;
     |ABRE #0;
     |LEE 040#0p;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |DBASS aBase;  |QBF aBase;
     |SI #6#1 = "LABORAL ";
         aDef  = "labempre";
         |SI #0#1 = "S";
             aMas  = aBase + "laboral/def/labempre.mas";
             aFich = aBase + "laboral/fich/";
         |SINO;
             aMas  = aBase + "aginom/def/labempre.mas";
             aFich = aBase + "aginom/fich/";
         |FINSI;
     |FINSI;

     |SI #6#1 = "CONTABIL";
         aDef  = "canempre";
         |SI #0#1 = "S";
             aMas  = aBase + "contagen/def/canempre.mas";
             aFich = aBase + "contagen/fich/";
         |SINO;
             aMas  = aBase + "agicont/def/canempre.mas";
             aFich = aBase + "agicont/fich/";
         |FINSI;
     |FINSI;

     |SI #6#1 = "FISCAL  ";
         aDef  = "agifigen";
         |SI #0#1 = "S";
             aMas  = aBase + "basica/def/agifigen.mas";
             aFich = aBase + "basica/fich/";
         |SINO;
             aMas  = aBase + "agicli/def/agifigen.mas";
             aFich = aBase + "agicli/fich/";
         |FINSI;
     |FINSI;

     |SI #6#1 = "SOCIEDAD";
         aDef  = "maacceso";
         |SI #0#1 = "S";
             aMas  = aBase + "contasoc/def/maacceso.mas";
             aFich = aBase + "contasoc/fich/";
         |SINO;
             aMas  = aBase + "sociedad/def/maacceso.mas";
             aFich = aBase + "sociedad/fich/";
         |FINSI;
     |FINSI;

     |SI #6#1 = "RENTA   ";
         aDef  = "reacceso";
         |SI #0#1 = "S";
             aMas  = aBase + "ren2002/def/reacceso.mas";
             aFich = aBase + "ren2002/fich/";
         |SINO;
             aMas  = aBase + "agiren02/def/reacceso.mas";
             aFich = aBase + "agiren02/fich/";
         |FINSI;
     |FINSI;

     |CARGA_DEF aMas, refer01@;
     |SI FSalida ! 0;
         aAlfa = "0000 No puedo cargar el Def " + aMas;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |PATH_DAT #900 aFich;

     |ABRE #900;
     |ENTLINEAL #1#7, -3, 2, 22, 0, ClaveBaja7, ClaveAlta7;
     |CIERRA #900;

     |DESCARGA_DEF #refer01@;
|FPRC;
