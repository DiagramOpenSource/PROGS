|PROCESO Hoja01;
   Cadena = "";
   |ABRE #rem00100;
   #rem00100#0 = VEmpresa;
   |LEE 000#rem00100.=;
   |SI FSalida = 0;
      |HAZ CargaDatos;
   |FINSI;
   |CIERRA #rem00100;

   LongDec = 0;
   Cadena = "10001 ";

   ||TITULAR
   || Nif del primer declarante
   TipoDato = "An"; Long = 9;  aAlfa = aNif1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aApell12;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del primer declarante
   TipoDato = "A";  Long = 15; aAlfa = aNombre1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cambio de domicilio o 1¦ declaracion
   TipoDato = "A";  Long = 1;  aAlfa = aC1;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Siglas de la via del primer declarante
   TipoDato = "A";  Long = 2;  aAlfa = aSg1;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre de la via del primer declarante
   TipoDato = "A";  Long = 20; aAlfa = aCalle1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del primer declarante
   TipoDato = "An"; Long = 5;  aAlfa = aNumero1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aEscalera1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPiso1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del primer declarante
   TipoDato = "An"; Long = 2;  aAlfa = aPuerta1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del primer declarante
   TipoDato = "An"; Long = 25; aAlfa = aLocali1;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del primer declarante
   aAlfa = aCP1; aAlfa = aAlfa % 0102;                            Cadena = Cadena + aAlfa;
   || Codigo postal del primer declarante
   aAlfa = aCP1;                                                  Cadena = Cadena + aAlfa;
   || Estado civil del declarante
   |SI aEC1 = "S"; Cadena = Cadena + "1"; |FINSI;
   |SI aEC1 = "C"; Cadena = Cadena + "2"; |FINSI;
   |SI aEC1 = "V"; Cadena = Cadena + "3"; |FINSI;
   |SI aEC1 = "L"; Cadena = Cadena + "4"; |FINSI;
   || A¤o de nacimiento del declarante
   TipoDato = "N";  Long = 4;  aAlfa = aAnyoN1;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del declarante
   TipoDato = "N";  Long = 2;  aAlfa = aMinusval1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefono de contacto del declarante
   TipoDato = "N";  Long = 9;  aAlfa = aTelef1;    |HAZ Formateo; Cadena = Cadena + aAlfa;

   |HAZ GrabaCad;

   ||CONYUGE
   || Nif del conyuge
   TipoDato = "An"; Long = 9;  aAlfa = aNif2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Apellido 1 del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aApell22;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre del conyuge
   TipoDato = "A";  Long = 15; aAlfa = aNombre2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cambio de domicilio o 1¦ declaracion
   TipoDato = "A";  Long = 1;  aAlfa = aC2;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Siglas de la via del conyuge
   TipoDato = "A";  Long = 2;  aAlfa = aSg2;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Nombre de la via del conyuge
   TipoDato = "A";  Long = 20; aAlfa = aCalle2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Numero del conyuge
   TipoDato = "An"; Long = 5;  aAlfa = aNumero2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Escalera del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aEscalera2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Piso del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aPiso2;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Puerta del conyuge
   TipoDato = "An"; Long = 2;  aAlfa = aPuerta2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Municipio del conyuge
   TipoDato = "An"; Long = 25; aAlfa = aLocali2;   |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Codigo provincial del conyuge
   aAlfa = aCP2; aAlfa = aAlfa % 0102;                            Cadena = Cadena + aAlfa;
   || Codigo postal del conyuge
   aAlfa = aCP2;                                                  Cadena = Cadena + aAlfa;
   || A¤o de nacimiento del conyuge
   TipoDato = "N";  Long = 4;  aAlfa = aAnyoN2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Grado de minusvalia del conyuge
   TipoDato = "N";  Long = 2;  aAlfa = aMinusval2; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Telefono de contacto del conyuge
   TipoDato = "N";  Long = 9;  aAlfa = aTelef2;    |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Conyuge no residente y no contribuyente
   Cadena = Cadena + #rem00100#102;
   || Fecha Fallecimiento (en su caso)
   |SI #rem00100#91 ! " ";
      aAlfa = #rem00100#92;
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + "        ";
   |FINSI;
   || Tipo de tributacion
   |SI #rem00100#57 = "X";
      aSeparada = "N";
      Cadena = Cadena + "2";
   |SINO;
      |SI #rem00100#6 = "C";
         aSeparada = "S";
      |SINO;
         aSeparada = "N";
      |FINSI;
      Cadena = Cadena + "1";
   |FINSI;
   || Cambio domicilio descendientes
   Cadena = Cadena + " ";

   |HAZ GrabaCad;

   || Bucle para la declaracion de hijos y otros descendientes

   InAscend = nAscend1<-; InDescend = nDescend1<-;
   |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
      nAscend = 0; InAscend = InAscend + 1;
      |SI nCont [ 4; nDescend = 0; InDescend = InDescend + 1; |FINSI;
   |SIGUE;
   InAscend = nAscend1<-; InDescend = nDescend1<-;
   |BUCLE RecogeFam;
   |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
      InDescend = nDescend1<-; InDescend = InDescend + (nCont - 1);
      #rem00101#0 = #rem00100#0;
      #rem00101#1 = nDescend;
      |LEE 000#rem00101.=;
      |SI FSalida = 0;
         aNifH  = #rem00101#2; aNombH = #rem00101#3;
         aAnyoH = #rem00101#5; aMinuH = #rem00101#6;
         aVincH = #rem00101#7; aOtroH = #rem00101#8;
      |SINO;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "";
         aVincH = ""; aOtroH = "";
      |FINSI;
      TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";  Long = 4;  aAlfa = aAnyoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";  Long = 2;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |HAZ GrabaCad;
   |SIGUE;

   || Bucle para la declaracion de ascendientes

   |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
      InAscend = nAscend1<-; InAscend = InAscend + (nCont - 1);
      #rem00101#0 = #rem00100#0;
      #rem00101#1 = nAscend;
      |LEE 000#rem00101.=;
      |SI FSalida = 0;
         aNifH  = #rem00101#2; aNombH = #rem00101#3;
         aAnyoH = #rem00101#5; aMinuH = #rem00101#6;
         aVincH = #rem00101#7; aOtroH = #rem00101#8;
      |SINO;
         aNifH  = ""; aNombH = "";
         aAnyoH = ""; aMinuH = "";
         aVincH = ""; aOtroH = "";
      |FINSI;
      TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "A";  Long = 33; aAlfa = aNombH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";  Long = 4;  aAlfa = aAnyoH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "N";  Long = 2;  aAlfa = aMinuH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |HAZ GrabaCad;
   |SIGUE;
   |CIERRA #rem00101;

   || Comunidad autonoma de residencia
   TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Se adjunta hoja de rectificacion
   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida = 0;
      aAlfa  = #rem01001#17;
      aDom2P = #rem01001#10;
      aFra2P = #rem01001#8;
      aRen2P = #rem01001#11;
   |SINO;
      aAlfa  = " ";
      aDom2P = "";
      aFra2P = "";
      aRen2P = "";
   |FINSI;
   TipoDato = "A";  Long = 1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |ABRE #rerenpre;
   #rerenpre#0 = #rem00100#65;
   |LEE 000#rerenpre.=;
   |SI FSalida = 0;
      || Representante : Nif
      TipoDato = "An"; Long = 9;  aAlfa = #rerenpre#2;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Apellidos y nombre o razon social
      TipoDato = "An"; Long = 32; aAlfa = #rerenpre#1;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Nombre de la via publica
      TipoDato = "An"; Long = 26; aAlfa = #rerenpre#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Numero de la via publica
      TipoDato = "An"; Long = 4;  aAlfa = #rerenpre#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Municipio
      TipoDato = "An"; Long = 15; aAlfa = #rerenpre#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Codigo provincial
      TipoDato = "N";  Long = 2;  aAlfa = #rerenpre#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Representante : Codigo postal
      aAlfa = (("00" + #rerenpre#5) % -102) + (("000" + #rerenpre#6) % -103);
      Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 88) + ("0" * 5);
   |FINSI;
   |CIERRA #rerenpre;

   || Sostenimiento de la iglesia catolica
   |SI aIglesia1 = "I"; |O aIglesia1 = "D"; aAlfa = "X"; |SINO; aAlfa = ""; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Colaboracion en fines sociales
   |SI aIglesia1 = "O"; |O aIglesia1 = "D"; aAlfa = "X"; |SINO; aAlfa = ""; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo
   aAlfa = "  ";
   |SI #rem00100#97 = "1"; aAlfa = "X "; |FINSI;
   |SI #rem00100#97 = "2"; aAlfa = " X"; |FINSI;
   TipoDato = "A";  Long = 2;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta bancaria
   TipoDato = "N";  Long = 20; aAlfa = aCuenta1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuenta bancaria si domicilia el 2§ Pago
   |SI aDom2P = "S"; aAlfa = aCuenta1; |SINO; aAlfa = "0" * 20; |FINSI;
   TipoDato = "N";  Long = 20;                       |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Numero justificante
   TipoDato = "N";  Long = 13;  aAlfa = "0";         |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fraccionamiento del pago
   |SI aFra2P = "S"; aAlfa = "X"; |SINO; aAlfa = " "; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Domiciliacion del 2§ plazo
   |SI aDom2P = "S"; aAlfa = "X"; |SINO; aAlfa = " "; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Renuncia a la devolucion
   |SI aRen2P = "S"; aAlfa = "X"; |SINO; aAlfa = " "; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Compensacion entre conyuges
   Bloque = 29;     Casilla = "  1"; |HAZ BuscaCasilla;
   |SI SwError = 1; Casilla = "  2"; |HAZ BuscaCasilla; |FINSI;
   |SI SwError = 1; aAlfa = " "; |SINO; aAlfa = "X"; |FINSI;
   TipoDato = "A";  Long = 1;                        |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Localidad
   TipoDato = "An"; Long = 20; aAlfa = aLocali1;     |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ CargaFecha;
   || Fecha y firma de la declaracion : Dia Fecha
   TipoDato = "N";  Long = 2;  aAlfa = DiaInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : Mes Fecha
   TipoDato = "A";  Long = 10; aAlfa = MesInf;       |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Fecha y firma de la declaracion : A¤o Fecha
   TipoDato = "N";  Long = 4;  aAlfa = EjerInf;      |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Reservado para la AEAT
   Cadena = Cadena + ("0" * 21);
   || Referencia
   |SI #reemi100#59 = "S";
      aAlfa = VEmpresa + " " + VTipo;
      TipoDato = "An";  Long = 20;                   |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SINO;
      Cadena = Cadena + (" " * 20);
   |FINSI;
   || Sello electronico reservado para la AEAT
   Cadena = Cadena + (" " * 13);
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
|FPRC;

|PROCESO Hoja02;
   nSwDatos = 2;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   Cadena = "10002 ";
   |ABRE #rem01010;
   #rem01010#0 = VEmpresa;
   #rem01010#1 = 0;
   #rem01010#2 = VTipo;
   |LEE 000#rem01010.=;
   |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
   |CIERRA #rem01010;

   TipoDato = "N";  Long = 10;  LongDec = 2;
   || (A) Rendim.trabajo: Ingresos Integros: Ret.Dinerarias : Ingr.Integros
   aAlfa = #rem01010#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Valoracion
   aAlfa = #rem01010#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta
   aAlfa = #rem01010#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta Reperc.
   aAlfa = #rem01010#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.Integros
   aAlfa = #rem01010#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Contrib.Planes Pens. y Prev.Social: Importes
   aAlfa = #rem01010#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reducciones especiales: Importe
   aAlfa = #rem01010#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cotiz.Seg.Social/Mutuas grles.
   aAlfa = #rem01010#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas satisfechas a sindicatos
   aAlfa = #rem01010#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas a colegios profesionales
   aAlfa = #rem01010#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Gastos defensa jurid.derivados litigios con el empleador
   aAlfa = #rem01010#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01010#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01010#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Importe de la reduccion
   aAlfa = #rem01010#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto reducido
   aAlfa = #rem01010#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena1 = Cadena; Cadena = "";

   |ABRE #rem01012;
   #rem01012#0 = VEmpresa;
   #rem01012#1 = 0;
   #rem01012#2 = VTipo;
   |LEE 000#rem01012.=;
   |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
   |CIERRA #rem01012;

   || (B) Rend.Cap.Mobil: Ingresos integros: Int.de cuentas y dep.activos financieros
   aAlfa = #rem01012#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Dividendos por part.fondos propios entidades
   aAlfa = #rem01012#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.transm.o amort.Letras del tesoro
   aAlfa = #rem01012#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.transm., amort.o reemb.otros activos financ.
   aAlfa = #rem01012#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.contratos seg.vida o invalidez y oper.cap.
   aAlfa = #rem01012#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Otros rdtos.capital mobiliario
   aAlfa = #rem01012#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Total ingresos integros
   aAlfa = #rem01012#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Gastos admin.y dep.de valores
   aAlfa = #rem01012#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Otros gastos fiscalmente deducibles
   aAlfa = #rem01012#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01012#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01012#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Total importe reducciones (Art.24.2 Ley 40/98)
   aAlfa = #rem01012#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Reducc.rendtos.contratos de seguro (Disp.Tr.6¦ Ley 40/98)
   aAlfa = #rem01012#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Total rendimiento neto reducido
   aAlfa = #rem01012#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Rend.netos transm,amort,val.deuda pub,antes 31/12/1996: Saldo positivo
   aAlfa = #rem01012#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Rend.netos transm,amort,val.deuda pub,antes 31/12/1996: Saldo negativo
   aAlfa = #rem01012#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena2 = Cadena; Cadena = "";

   || (C) Imputacion de rentas inmobiliarias (excluida vivienda habitual y suelo no edif.)
   Bloque = 3; Casilla = " 13"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;

   |ABRE #rem01011;
   #rem01011#0 = VEmpresa;
   #rem01011#1 = 0;
   #rem01011#2 = VTipo;
   |LEE 000#rem01011.=;
   |SI FSalida ! 0; |DDEFECTO #rem01011; |FINSI;
   |CIERRA #rem01011;

   || (D) Rend.Capital Inm.: Ingresos integros: Arrend./constitucion o cesion derechos uso inmueble
   aAlfa = #rem01011#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Ingresos integros: Part.propietario/usuf.en precio subarr.o traspaso
   aAlfa = #rem01011#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Ingresos integros: Total ingresos integros
   aAlfa = #rem01011#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Intereses cap.ajenos invertidos en adqu.bienes o derechos
   aAlfa = #rem01011#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Amort.inmuebles y bienes cedidos
   aAlfa = #rem01011#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Compens.fiscal contratos arrend.anteriores a 09/05/1985
   aAlfa = #rem01011#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Otros gastos fiscales deducibles
   aAlfa = #rem01011#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Total gastos deducibles
   aAlfa = #rem01011#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Total rendimiento neto
   aAlfa = #rem01011#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Reducciones (Art.21.2 Ley 40/1998)
   aAlfa = #rem01011#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Total rendimiento neto reducido
   aAlfa = #rem01011#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10; Cadena3 = Cadena; Cadena = "";

   |SI nSwDatos = 1;
      Cadena = Cadena1; |HAZ GrabaCad;
      Cadena = Cadena2; |HAZ GrabaCad;
      Cadena = Cadena3; |HAZ GrabaCad;
   |FINSI;
|FPRC;

|PROCESO Hoja03;
   nSwDatos = 3; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10003 ";
   |ABRE #rem01014; |ABRE #rem01015;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
    |Y #rem01014#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01014.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01015#0 = VEmpresa;
   #rem01015#1 = 0;
   #rem01015#2 = aTipo;
   #rem01015#3 = 1;
   |LEE 000#rem01015.];
   |PARA; |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0;
    |Y #rem01015#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01015.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |SI FSalida ! 0; |O #rem01014#0 ! VEmpresa; |O #rem01014#1 ! 0; |O #rem01014#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01015#0 = VEmpresa;
   #rem01015#1 = 0;
   #rem01015#2 = VTipo;
   #rem01015#3 = 1;
   |LEE 000#rem01015.];
   |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0; |Y #rem01014#2 = aTipo; |Y nNoHay1 = 0;
            || (E1-1) Rend.Activ.econ.est.directa normal: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01014#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa normal: Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01014#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01014#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Imputacion Temporal
            TipoDato = "A";  Long = 1;
            aAlfa = #rem01014#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Ingresos explotacion
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01014#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros ingresos
            aAlfa = #rem01014#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Autoconsumo de bienes y servicios
            aAlfa = #rem01014#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total ingresos computables
            aAlfa = #rem01014#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos consumos explotacion
            aAlfa = #rem01014#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos sueldos y salarios
            aAlfa = #rem01014#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos seguridad social
            aAlfa = #rem01014#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros gastos de personal
            aAlfa = #rem01014#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos arrend.y canones
            aAlfa = #rem01014#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos reparacion y conservacion
            aAlfa = #rem01014#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos servicios profesionales independientes
            aAlfa = #rem01014#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos suministros
            aAlfa = #rem01014#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos otros serv.exteriores
            aAlfa = #rem01014#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos tributos fisc.deducibles
            aAlfa = #rem01014#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos financieros
            aAlfa = #rem01014#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos amort.dotac.ejercicio
            aAlfa = #rem01014#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos provisiones dotac.ejercicio
            aAlfa = #rem01014#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros gastos fiscalmente deducibles
            aAlfa = #rem01014#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total gastos deducibles
            aAlfa = #rem01014#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Rendimiento neto
            aAlfa = #rem01014#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Reduccion del 30 %
            aAlfa = #rem01014#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total rendimiento neto reducido
            aAlfa = #rem01014#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0      " + ("0" * 164); |HAZ GrabaCad;
            Cadena = "0" * 100;                        |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01014.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0; |Y #rem01014#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo; |Y nNoHay2 = 0;
            || (E1-2) Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01015#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01015#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01015#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01015#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01015#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01015#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Reduccion del 30 %
            aAlfa = #rem01015#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01015#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0         0000     " + ("0" * 36);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01015.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 18"; |HAZ BuscaCasilla;
         aAlfa = Casilla; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10003C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01015; |CIERRA #rem01014;
|FPRC;

|PROCESO Hoja04;
   nSwDatos = 4; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10004 ";
   |ABRE #rem01016; |ABRE #rem01017; |ABRE #rem01018;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01016#0 = VEmpresa;
   #rem01016#1 = 0;
   #rem01016#2 = aTipo;
   #rem01016#3 = 1;
   |LEE 000#rem01016.];
   |PARA; |SI FSalida = 0; |Y #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0;
    |Y #rem01016#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01016.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01017#0 = VEmpresa;
   #rem01017#1 = 0;
   #rem01017#2 = aTipo;
   #rem01017#3 = 1;
   |LEE 000#rem01017.];
   |PARA; |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0;
    |Y #rem01017#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01017.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01016#0 = VEmpresa;
   #rem01016#1 = 0;
   #rem01016#2 = aTipo;
   #rem01016#3 = 1;
   |LEE 000#rem01016.];
   |SI FSalida ! 0; |O #rem01016#0 ! VEmpresa; |O #rem01016#1 ! 0; |O #rem01016#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01017#0 = VEmpresa;
   #rem01017#1 = 0;
   #rem01017#2 = VTipo;
   #rem01017#3 = 1;
   |LEE 000#rem01017.];
   |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0; |Y #rem01016#2 = aTipo; |Y nNoHay1 = 0;
            || (E2-1) Rend.Activ.econ.est.directa simpl.: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01016#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa simpl.: Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01016#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01016#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Imputacion Temporal
            TipoDato = "A";  Long = 1;
            aAlfa = #rem01016#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Ingresos explotacion
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01016#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Otros ingresos
            aAlfa = #rem01016#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Autoconsumo de bienes y servicios
            aAlfa = #rem01016#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total ingresos computables
            aAlfa = #rem01016#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos consumos explotacion
            aAlfa = #rem01016#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos sueldos y salarios
            aAlfa = #rem01016#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos seguridad social
            aAlfa = #rem01016#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos arrend.y canones
            aAlfa = #rem01016#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos reparacion y conservacion
            aAlfa = #rem01016#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos servicios profesionales independientes
            aAlfa = #rem01016#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos suministros
            aAlfa = #rem01016#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos otros serv.exteriores
            aAlfa = #rem01016#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos tributos fisc.deducibles
            aAlfa = #rem01016#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos financieros
            aAlfa = #rem01016#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos amort.dotac.ejercicio
            aAlfa = #rem01016#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Otros gastos fiscalmente deducibles
            aAlfa = #rem01016#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total gastos deducibles
            aAlfa = #rem01016#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Diferencia ingresos/gastos
            aAlfa = #rem01016#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Provisiones deducibles
            aAlfa = #rem01016#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Rendimiento neto
            aAlfa = #rem01016#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Reduccion del 30 %
            aAlfa = #rem01016#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total rendimiento neto reducido
            aAlfa = #rem01016#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0      " + ("0" * 164); |HAZ GrabaCad;
            Cadena = "0" * 100;                        |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01016.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0; |Y #rem01016#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo; |Y nNoHay2 = 0;
            || (E2-2) Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01017#9;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01017#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01017#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01017#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01017#6; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01017#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Reduccion del 30 %
            aAlfa = #rem01017#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01017#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0         0000     " + ("0" * 36);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01017.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 19"; |HAZ BuscaCasilla;
         aAlfa = Casilla; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         #rem01018#0 = VEmpresa;
         #rem01018#1 = 0;
         #rem01018#2 = aTipo;
         |LEE 000#rem01018.=;
         |SI FSalida = 0;
            aAlfa = #rem01018#3; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = #rem01018#4; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = #rem01018#5; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = #rem01018#6; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         |SINO;
            aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
            aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         |FINSI;
      |SINO;
         aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;
      Cadena = &13 + &10;  |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10004C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01018; |CIERRA #rem01017; |CIERRA #rem01016;
|FPRC;

|PROCESO Hoja05;
   nSwDatos = 5; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10005 ";
   |ABRE #rem01019; |ABRE #rem01020;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
    |Y #rem01019#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01019.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01020#0 = VEmpresa;
   #rem01020#1 = 0;
   #rem01020#2 = aTipo;
   #rem01020#3 = 1;
   |LEE 000#rem01020.];
   |PARA; |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0;
    |Y #rem01020#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01020.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |SI FSalida ! 0; |O #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0; |O #rem01019#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01020#0 = VEmpresa;
   #rem01020#1 = 0;
   #rem01020#2 = VTipo;
   #rem01020#3 = 1;
   |LEE 000#rem01020.];
   |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0; |Y #rem01019#2 = aTipo; |Y nNoHay1 = 0;
            || (E4-1) Rend.Activ.econ.est.objetiva: Actividad X: Clasificacion IAE
            aAlfa = #rem01019#4; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01019#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 1¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 1¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 1¦
            Long = 9;
            aAlfa = #rem01019#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 2¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 2¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 2¦
            Long = 9;
            aAlfa = #rem01019#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 3¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 3¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 3¦
            Long = 9;
            aAlfa = #rem01019#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 4¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 4¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 4¦
            Long = 9;
            aAlfa = #rem01019#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 5¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 5¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 5¦
            Long = 9;
            aAlfa = #rem01019#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;

            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 6¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 6¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 6¦
            Long = 9;
            aAlfa = #rem01019#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 7¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#24;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 7¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 7¦
            Long = 9;
            aAlfa = #rem01019#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto previo (suma)
            Long = 10;
            aAlfa = #rem01019#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo al empleo
            aAlfa = #rem01019#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo a la inversion
            aAlfa = #rem01019#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto minorado
            aAlfa = #rem01019#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector especial
            Long = 2; LongDec = 2;
            aAlfa = #rem01019#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector empresas peque¤a dimension
            aAlfa = #rem01019#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector temporada
            aAlfa = #rem01019#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector exceso
            aAlfa = #rem01019#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector inicio nueva actividad
            aAlfa = #rem01019#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto de modulos
            Long = 10;
            aAlfa = #rem01019#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;

            || Rend.Activ.econ.est.objetiva: Actividad X: Gastos extraordinarios
            aAlfa = #rem01019#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto calculado
            aAlfa = #rem01019#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Otras percepciones empresariales
            aAlfa = #rem01019#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Total rendimiento neto
            aAlfa = #rem01019#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Reduccion Art.30 Ley 40/98
            aAlfa = #rem01019#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Total rendto.neto reducido
            aAlfa = #rem01019#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "    0";
            aAlfa = (" " * 24) + ("0" * 20);
            Cadena = Cadena + aAlfa + aAlfa + aAlfa; |HAZ GrabaCad;
            Cadena = aAlfa + aAlfa + aAlfa + aAlfa;  |HAZ GrabaCad;
            Cadena = ("0" * 152);                    |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01019.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0; |Y #rem01019#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo; |Y nNoHay2 = 0;
            || (E4-2) Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01020#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01020#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N";  Long = 2;   LongDec = 2;
            aAlfa = #rem01020#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            TipoDato = "An"; Long = 4;   LongDec = 0;
            aAlfa = #rem01020#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01020#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01020#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0         0000    " + ("0" * 24);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01020.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 21"; |HAZ BuscaCasilla;
         aAlfa = Casilla; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10005C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01019; |CIERRA #rem01020;
|FPRC;

|PROCESO Hoja06;
   nSwDatos = 6; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10006 ";
   |ABRE #rem01021; |ABRE #rem01022;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
    |Y #rem01021#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01021.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = aTipo;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |PARA; |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0;
    |Y #rem01022#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01022.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |SI FSalida ! 0; |O #rem01021#0 ! VEmpresa; |O #rem01021#1 ! 0; |O #rem01021#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = VTipo;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0; |Y #rem01021#2 = aTipo; |Y nNoHay1 = 0;
            || (E5-1) Rend.A.G.y F.est.objetiva: Actividad X: Clave de actividad
            aAlfa = #rem01021#5; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01021#6;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.A.G.y F.est.objetiva: Actividad X: Imputacion temporal
            aAlfa = #rem01021#4;  Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 1
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 1
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 1
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 2
            aAlfa = #rem01021#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 2
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 2
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 3
            aAlfa = #rem01021#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 3
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 3
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 4
            aAlfa = #rem01021#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 4
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 4
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 5
            aAlfa = #rem01021#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 5
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 5
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 6
            aAlfa = #rem01021#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 6
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 6
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 7
            aAlfa = #rem01021#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 7
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 7
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 8
            aAlfa = #rem01021#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 8
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 8
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;

            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 9
            aAlfa = #rem01021#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 9
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 9
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 10
            aAlfa = #rem01021#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 10
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 10
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 11
            aAlfa = #rem01021#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 11
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 11
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 12
            aAlfa = #rem01021#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 12
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 12
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 13
            aAlfa = #rem01021#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 13
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 13
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Total ingresos
            aAlfa = #rem01021#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto previo (suma)
            aAlfa = #rem01021#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion gasoleo agricola (35% del precio)
            aAlfa = #rem01021#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Amortizacion inmovilizado
            aAlfa = #rem01021#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto minorado
            aAlfa = #rem01021#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector medios ajenos
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01021#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector util.pers.asalariado
            aAlfa = #rem01021#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector cultivos tierras arrend.
            aAlfa = #rem01021#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50%
            aAlfa = #rem01021#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector act.agricultura ecologica
            aAlfa = #rem01021#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector empresa no supera los 9015.18 E
            aAlfa = #rem01021#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector determ.act.forestales
            aAlfa = #rem01021#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;

            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto de modulos
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01021#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Gastos extraordinarios
            aAlfa = #rem01021#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto calculado por est.obj.
            aAlfa = #rem01021#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion Ley 19/95 (agricultores jovenes)
            aAlfa = #rem01021#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto
            aAlfa = #rem01021#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion prevista art.30 Ley 40/98
            aAlfa = #rem01021#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto reducido
            aAlfa = #rem01021#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            |HAZ GrabaCad;
            Cadena = "00 ";
            aAlfa = ("0" * 11) + (" " * 6) + ("0" * 11);
            Cadena = Cadena + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa;
            |HAZ GrabaCad;
            Cadena = aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa;
            |HAZ GrabaCad;
            Cadena = ("0" * 167); |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01021.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0; |Y #rem01021#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo; |Y nNoHay2 = 0;
            || (E5-2) Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: Contribuyente
            aAlfa = #rem01022#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: NIF entidad
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01022#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: Porcentaje participacion
            TipoDato = "N";  Long = 2;   LongDec = 2;
            aAlfa = #rem01022#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01022#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Actividad X: Rendto.neto red.atrib.al contribuyente
            aAlfa = #rem01022#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0         0000" + ("0" * 24); |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01022.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 22"; |HAZ BuscaCasilla;
         aAlfa = Casilla; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         Bloque = 5; Casilla = " 23"; |HAZ BuscaCasilla;
         aAlfa = Casilla; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10006C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01021; |CIERRA #rem01022;
|FPRC;

|PROCESO Hoja07;
   nSwDatos = 7; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10007 ";
   |ABRE #rem01023; |ABRE #rem01024; |ABRE #rem01025; |ABRE #rem01026;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |PARA; |SI FSalida = 0; |Y #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0;
    |Y #rem01023#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01023.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = aTipo;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |PARA; |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0;
    |Y #rem01024#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01024.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |PARA; |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0;
    |Y #rem01025#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01025.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = VTipo;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo;
      nNoHay3 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay3 = 1;
   |FINSI;

   #rem01026#0 = VEmpresa;
   #rem01026#1 = 0;
   #rem01026#2 = aTipo;
   |LEE 000#rem01026.=;
   |SI FSalida ! 0; |DDEFECTO #rem01026; |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo; |Y nNoHay1 = 0;
            || (F-1) Imputaciones a entidades: Sociedad X: Contribuyente
            aAlfa = #rem01023#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Imputaciones a entidades: Sociedad X: NIF Entidad transparente
            TipoDato = "A"; Long = 9;   LongDec = 0;
            aAlfa = #rem01023#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Clave tipo entidad transparente
            aAlfa = #rem01023#5;  Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Criterio de imputacion
            |SI #rem01023#19 = " "; |Y #rem01023#20 = " "; Cadena = Cadena + " "; |FINSI;
            |SI #rem01023#19 = "X"; Cadena = Cadena + "1"; |FINSI;
            |SI #rem01023#20 = "X"; Cadena = Cadena + "2"; |FINSI;
            || Imputaciones a entidades: Sociedad X: Base imponible positiva imputada
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01023#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por rentas en Ceuta o Melilla
            aAlfa = #rem01023#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por doble imposicion de dividendos
            aAlfa = #rem01023#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por doble imposicion internacional
            aAlfa = #rem01023#10;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por inversion empresarial
            aAlfa = #rem01023#11;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por creacion de empleo
            aAlfa = #rem01023#12;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Imputac.pagos frac.,retenc. e ing.a Cta.
            aAlfa = #rem01023#13;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Imputac.Cuota Imp.Sociedades satisfecha a la sociedad
            aAlfa = #rem01023#14;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Suma
            aAlfa = #rem01023#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Exceso de pagos a cta.imputados
            aAlfa = #rem01023#17;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0           " + ("0" * 120);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01023.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |SI nPasada = 0;
         || Imputaciones a entidades: Total base imponible imputada
         aAlfa = #rem01026#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Imputaciones a entidades: Total suma de deducciones, pagos fraccionados y cuotas Imp.sociedades
         aAlfa = #rem01026#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Imputaciones a entidades: Total exceso de pagos a cuenta imputados
         aAlfa = #rem01026#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SINO;
         |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo; |Y nNoHay2 = 0;
            || (F-2) Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Contribuyente
            aAlfa = #rem01024#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Denominacion entidad no residente
            TipoDato = "An"; Long = 24;   LongDec = 0;
            aAlfa = #rem01024#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Criterio de imputacion
            |SI #rem01024#6 = " "; |Y #rem01024#7 = " "; Cadena = Cadena + " "; |FINSI;
            |SI #rem01024#6 = "X"; Cadena = Cadena + "1"; |FINSI;
            |SI #rem01024#7 = "X"; Cadena = Cadena + "2"; |FINSI;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Importe rentas positivas imputables
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01024#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Impuestos analogos al Imp.Sociedades no imputables
            aAlfa = #rem01024#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Importe de la imputacion
            aAlfa = #rem01024#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0" + (" " * 25) + ("0" * 36); |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01024.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Imputacion rentas positivas reg.transp.fiscal intern.: Total importe de la imputacion
         aAlfa = #rem01026#6;  |HAZ Formateo;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: Contribuyente
         aAlfa = #rem01026#7;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
         || Imputacion rentas derechos de imagen: NIF o denominacion persona o entidad cesionaria
         TipoDato = "An"; Long = 25;   LongDec = 0;
         aAlfa = #rem01026#8;  |HAZ Formateo;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: NIF o denominacion persona o entidad relacion laboral
         aAlfa = #rem01026#9;  |HAZ Formateo;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: Cantidad a imputar en la base imponible
         TipoDato = "N"; Long = 10;   LongDec = 2;
         aAlfa = #rem01026#10; |HAZ Formateo;  Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = Cadena + aAlfa; |HAZ GrabaCad;
         Cadena = "0" + (" " * 50) + ("0" * 12); |HAZ GrabaCad;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo; |Y nNoHay3 = 0;
            || (F-3) Imputacion rentas instituciones: I.I.Colectiva X: Contribuyente
            aAlfa = #rem01025#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Imputacion rentas instituciones: I.I.Colectiva X: Denominacion institucion
            TipoDato = "An"; Long = 24;   LongDec = 0;
            aAlfa = #rem01025#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Valor liquidativo
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01025#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Valor de adquisicion
            aAlfa = #rem01025#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Importe de la imputacion
            aAlfa = #rem01025#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0" + (" " * 24) + ("0" * 36);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01025.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo;
         nNoHay3 = 0;
      |SINO;
         nNoHay3 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Imputacion rentas instituciones: Total del importe de la imputacion
         aAlfa = #rem01026#11; |HAZ Formateo;  Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;

      Cadena = &13 + &10; |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1; |Y nNoHay3 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10007C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01026; |CIERRA #rem01025; |CIERRA #rem01024; |CIERRA #rem01023;
|FPRC;

|PROCESO Hoja08;
   nSwDatos = 8; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10008 ";
   |ABRE #rem01027; |ABRE #rem01028; |ABRE #rem01033;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont1 = 0; nCont2 = 0;
   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |PARA; |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0;
    |Y #rem01027#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 9; nCont1 = nCont1 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01027.s;
   |SIGUE;

   nCalc1 = 0; nCalc2 = 0;
   #rem01028#0 = VEmpresa;
   #rem01028#1 = 0;
   #rem01028#2 = aTipo;
   #rem01028#3 = 1;
   |LEE 000#rem01028.];
   |PARA; |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0;
    |Y #rem01028#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCont2 = nCont2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01028.s;
   |SIGUE;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01028#0 = VEmpresa;
   #rem01028#1 = 0;
   #rem01028#2 = VTipo;
   #rem01028#3 = 1;
   |LEE 000#rem01028.];
   |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || (G-0) Regimen especial fusiones, escisiones y canje valores ent.no resid.: Contribuyente (1)
   aAlfa = #rem01033#35;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Opta por el regimen especial (1)
   Cadena = Cadena + #rem01033#36;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Contribuyente (2)
   aAlfa = #rem01033#37;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Opta por el regimen especial (2)
   Cadena = Cadena + #rem01033#38;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont1; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 8; |HACIENDO nCont = nCont + 1;
         |SI #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo; |Y nNoHay1 = 0;
            || (G-1) Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Contribuyente
            aAlfa = #rem01027#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: NIF
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01027#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Generacion <= 1 a¤o
            TipoDato = "N";  Long = 10;  LongDec = 2;

            Calc = #rem01027#6 - #rem01027#7; aAlfa = Calc;
            |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Generacion > 1 a¤o
            Calc = #rem01027#8 - #rem01027#9; aAlfa = Calc;
            |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Retenciones
            aAlfa = #rem01027#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0         " + ("0" * 36); |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01027.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      TipoDato = "N";  Long = 10;  LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo <= 1 a¤o: Ganancias partim.netas
         aAlfa = #rem01033#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo <= 1 a¤o: Perdidas partim.netas
         aAlfa = #rem01033#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo > 1 a¤o: Ganancias partim.netas
         aAlfa = #rem01033#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo > 1 a¤o: Perdidas partim.netas
         aAlfa = #rem01033#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En metalico: Importe total
         aAlfa = #rem01033#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Valoracion
         aAlfa = #rem01033#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Ingresos a cuenta
         aAlfa = #rem01033#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Ingresos a cuenta repercutidos
         aAlfa = #rem01033#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Importe total
         aAlfa = #rem01033#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Hojas adicionales capitulo (G-2)
         TipoDato = "N"; Long = 1; LongDec = 0; aAlfa = nCont2; |HAZ Formateo;
         Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         || Hojas adicionales capitulo (G-2)
         Cadena = Cadena + "0"; |HAZ GrabaCad;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo; |Y nNoHay2 = 0;
            || (G-2) Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Contribuyente
            aAlfa = #rem01028#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Descripcion
            TipoDato = "An"; Long = 20;  LongDec = 0;
            aAlfa = #rem01028#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Elementos afectos
            Cadena = Cadena + #rem01028#6;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Fecha adquisicion
            TipoDato = "F";
            aAlfa = #rem01028#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Fecha transmision
            aAlfa = #rem01028#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Valor transmision
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01028#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Valor adquisicion
            aAlfa = #rem01028#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Perdida patrimonial obtenida
            aAlfa = #rem01028#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Perdida patrimonial imputable a 2001
            aAlfa = #rem01028#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial obtenida
            aAlfa = #rem01028#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial exenta por reinversion
            aAlfa = #rem01028#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no exenta
            aAlfa = #rem01028#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no exenta 2001
            aAlfa = #rem01028#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Reduccion
            aAlfa = #rem01028#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial reducida
            aAlfa = #rem01028#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial diferida reinvers.
            aAlfa = #rem01028#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no diferida 2001
            aAlfa = #rem01028#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0" + (" " * 37) + ("0" * 144);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01028.s;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total perdida patrim.imputable 2001
         aAlfa = #rem01033#12; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total ganancia patrim.no exenta imputable 2001
         aAlfa = #rem01033#13; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total ganancia no diferida.imputable 2001
         aAlfa = #rem01033#14; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10008C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01028; |CIERRA #rem01027;
|FPRC;

|PROCESO Hoja09;
   aAlfa = "tm" + Usuario; |NOME_DAT #500 aAlfa;

   nSwDatos = 9; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10009 ";
   |DELINDEX #rew00055;
   |ABRE #rem01029; |ABRE #rem01030; |ABRE #rem01031;
   |ABRE #rem01032; |ABRE #rem01033; |ABRE #rew00055;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCalc3 = 0; nCont = 0; nLinG = 1; nLinP = 1;
   |DDEFECTO #rew00055;
   #rew00055#0 = 1;
   #rew00055#1 = 1;
   |GRABA 020#rew00055.n;

   #rem01029#0 = VEmpresa;
   #rem01029#1 = 0;
   #rem01029#2 = aTipo;
   #rem01029#3 = 1;
   |LEE 000#rem01029.];
   |PARA; |SI FSalida = 0; |Y #rem01029#0 = VEmpresa; |Y #rem01029#1 = 0;
    |Y #rem01029#2 = aTipo; |HACIENDO;
      |SI #rem01029#5 ! 0; |O #rem01029#6 ! 0;
         nCalc1 = nCalc1 + 1;
         #rew00055#0 = nLinG; #rew00055#1 = 1;
         |LEE 000#rew00055.=;
         |SI FSalida ! 0;
            |DDEFECTO #rew00055;
            #rew00055#0 = nLinG; #rew00055#1 = 1;
            |GRABA 020#rew00055.c;
         |FINSI;
         #rew00055#2 = #rem01029#4;
         #rew00055#3 = #rem01029#5; #rew00055#4 = #rem01029#6;
         |GRABA 020#rew00055.a; nLinG = nLinG + 1;
      |FINSI;
      |SI #rem01029#7 ! 0; |O #rem01029#8 ! 0;
         nCalc2 = nCalc2 + 1;
         #rew00055#0 = nLinP; #rew00055#1 = 1;
         |LEE 000#rew00055.=;
         |SI FSalida ! 0;
            |DDEFECTO #rew00055;
            #rew00055#0 = nLinP; #rew00055#1 = 1;
            |GRABA 020#rew00055.c;
         |FINSI;
         #rew00055#5 = #rem01029#4;
         #rew00055#6 = #rem01029#7; #rew00055#7 = #rem01029#8;
         |GRABA 020#rew00055.a; nLinP = nLinP + 1;
      |FINSI;
      |LEE 000#rem01029.s;
   |SIGUE;
   nCalc1 = (((nCalc1 - 1) / 3) - 0.5) ! 0; nCalc2 = (((nCalc2 - 1) / 3) - 0.5) ! 0;
   |SI nCont < nCalc1; nCont = nCalc1; |FINSI;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01030#0 = VEmpresa;
   #rem01030#1 = 0;
   #rem01030#2 = aTipo;
   #rem01030#3 = 1;
   |LEE 000#rem01030.];
   |PARA; |SI FSalida = 0; |Y #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0;
    |Y #rem01030#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01030.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01031#0 = VEmpresa;
   #rem01031#1 = 0;
   #rem01031#2 = aTipo;
   #rem01031#3 = 1;
   |LEE 000#rem01031.];
   |PARA; |SI FSalida = 0; |Y #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0;
    |Y #rem01031#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01031.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   nCalc1 = 0; nCalc2 = 0; nLinG = 1; nLinP = 1;
   |DDEFECTO #rew00055;
   #rew00055#0 = 1;
   #rew00055#1 = 2;
   |GRABA 020#rew00055.n;

   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = aTipo;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0;
    |Y #rem01032#2 = aTipo; |HACIENDO;
      |SI #rem01032#5 ! 0; |O #rem01032#6 ! 0;
         nCalc1 = nCalc1 + 1;
         #rew00055#0 = nLinG; #rew00055#1 = 2;
         |LEE 000#rew00055.=;
         |SI FSalida ! 0;
            |DDEFECTO #rew00055;
            #rew00055#0 = nLinG; #rew00055#1 = 2;
            |GRABA 020#rew00055.c;
         |FINSI;
         #rew00055#2 = #rem01032#4;
         #rew00055#3 = #rem01032#5; #rew00055#4 = #rem01032#6;
         |GRABA 020#rew00055.a; nLinG = nLinG + 1;
      |FINSI;
      |SI #rem01032#7 ! 0; |O #rem01032#8 ! 0;
         nCalc2 = nCalc2 + 1;
         #rew00055#0 = nLinP; #rew00055#1 = 2;
         |LEE 000#rew00055.=;
         |SI FSalida ! 0;
            |DDEFECTO #rew00055;
            #rew00055#0 = nLinP; #rew00055#1 = 2;
            |GRABA 020#rew00055.c;
         |FINSI;
         #rew00055#5 = #rem01032#4;
         #rew00055#6 = #rem01032#7; #rew00055#7 = #rem01032#8;
         |GRABA 020#rew00055.a; nLinP = nLinP + 1;
      |FINSI;
      |LEE 000#rem01032.s;
   |SIGUE;
   nCalc1 = (((nCalc1 - 1) / 3) - 0.5) ! 0; nCalc2 = (((nCalc2 - 1) / 3) - 0.5) ! 0;
   |SI nCont < nCalc1; nCont = nCalc1; |FINSI;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0; nNoHay3 = 0; nNoHay4 = 0;

   #rem01029#0 = VEmpresa;
   #rem01029#1 = 0;
   #rem01029#2 = VTipo;
   #rem01029#3 = 1;
   |LEE 000#rem01029.];
   |SI FSalida = 0; |Y #rem01029#0 = VEmpresa; |Y #rem01029#1 = 0; |Y #rem01029#2 = aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01030#0 = VEmpresa;
   #rem01030#1 = 0;
   #rem01030#2 = VTipo;
   #rem01030#3 = 1;
   |LEE 000#rem01030.];
   |SI FSalida = 0; |Y #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   #rem01031#0 = VEmpresa;
   #rem01031#1 = 0;
   #rem01031#2 = VTipo;
   #rem01031#3 = 1;
   |LEE 000#rem01031.];
   |SI FSalida = 0; |Y #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo;
      nNoHay3 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay3 = 1;
   |FINSI;

   #rem01032#0 = VEmpresa;
   #rem01032#1 = 0;
   #rem01032#2 = VTipo;
   #rem01032#3 = 1;
   |LEE 000#rem01032.];
   |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo;
      nNoHay4 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay4 = 1;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         nCalc1 = (nPasada * 3) + nCont;
         #rew00055#0 = nCalc1; #rew00055#1 = 1;
         |LEE 000#rew00055.=;
         |SI FSalida = 0; |Y #rew00055#3 ! 0; |Y #rew00055#4 ! 0;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Ganancia X: Contribuyente
            aAlfa = #rew00055#2;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Ganancia X: Importe total ganancia
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rew00055#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Ganancia X: Importe ganancia imputable 2001
            aAlfa = #rew00055#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + ("0" * 25);
            |HAZ GrabaCad;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         aAlfa = #rem01033#15;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = 0;             |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         nCalc1 = (nPasada * 3) + nCont;
         #rew00055#0 = nCalc1; #rew00055#1 = 1;
         |LEE 000#rew00055.=;
         |SI FSalida = 0; |Y #rew00055#3 ! 0; |Y #rew00055#4 ! 0;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Contribuyente
            aAlfa = #rew00055#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Importe total ganancia
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rew00055#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Importe ganancia imputable 2001
            aAlfa = #rew00055#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + ("0" * 25); |HAZ GrabaCad;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         aAlfa = #rem01033#16;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = 0;             |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;

      #rew00055#0 = ((nPasada + 1) * 3) + 1;
      #rew00055#1 = 1;
      |LEE 000#rew00055.=;
      |SI FSalida = 0;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo; |Y nNoHay2 = 0;
            || (G2-2) Ganancias/Perdidas no somet.a retencion: Diferimiento por reinversion: Ganancia X: Contribuyente
            aAlfa = #rem01030#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no somet.a retencion: Diferimiento por reinversion: Ganancia X: Importe total ganancia
            TipoDato = "N"; Long = 10;  LongDec = 2;
            aAlfa = #rem01030#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Diferimiento por reinversion: Ganancia X: Importe ganancia imputable 2001
            aAlfa = #rem01030#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Diferimiento por reinversion: Ganancia X: Metodo de integracion
            |SI #rem01030#7 = " "; |Y #rem01030#8 = " "; Cadena = Cadena + " "; |FINSI;
            |SI #rem01030#7 = "X"; Cadena = Cadena + "1"; |FINSI;
            |SI #rem01030#8 = "X"; Cadena = Cadena + "2"; |FINSI;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + ("0" * 25) + " "; |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01030.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas no somet.a retencion: Diferimiento por reinversion: Total ganancia imputable 2001
         aAlfa = #rem01033#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |SINO;
         aAlfa = 0;            |HAZ Formateo; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo; |Y nNoHay3 = 0;
            || (G2-3) Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Contribuyente
            aAlfa = #rem01031#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Descripcion
            TipoDato = "A"; Long = 24;  LongDec = 0;
            aAlfa = #rem01031#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Elementos afectos
            Cadena = Cadena + #rem01031#6;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Fecha adquisicion
            TipoDato = "F";
            aAlfa = #rem01031#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Fecha transmision
            aAlfa = #rem01031#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Valor transmision
            TipoDato = "N"; Long = 10;  LongDec = 2;
            aAlfa = #rem01031#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Valor adquisicion
            aAlfa = #rem01031#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Perdida patrim.obtenida
            aAlfa = #rem01031#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Perdida patrim.imputable 2001
            aAlfa = #rem01031#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.obtenida
            aAlfa = #rem01031#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: n§ a¤os hasta 31/12/1996
            aAlfa = #rem01031#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.reducida
            aAlfa = #rem01031#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia exenta por reinversion
            aAlfa = #rem01031#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.no exenta
            aAlfa = #rem01031#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.reducida no exenta
            aAlfa = #rem01031#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Reduccion
            aAlfa = #rem01031#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.reducida
            aAlfa = #rem01031#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.diferida por reinversion
            aAlfa = #rem01031#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Elemento X: Ganancia patrim.no diferida imput.2001
            aAlfa = #rem01031#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + "0" + (" " * 41) + ("0" * 168);
            |HAZ GrabaCad;
         |FINSI;
         |LEE 000#rem01031.s;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo;
         nNoHay3 = 0;
      |SINO;
         nNoHay3 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Total perdidas patrim.imputables 2001
         aAlfa = #rem01033#18; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Total ganancias reducidas no exentas imp.2001
         aAlfa = #rem01033#19; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         || Ganancias/Perdidas no somet.a retencion: Periodo > 1 a¤o: en 2001: Total ganancias no diferidas imp.2001
         aAlfa = #rem01033#20; |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         Cadena = "";
      |SINO;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         aAlfa = 0;       |HAZ Formateo; Cadena = aAlfa; |HAZ GrabaCad;
         Cadena = "";
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         nCalc1 = (nPasada * 3) + nCont;
         #rew00055#0 = nCalc1; #rew00055#1 = 2;
         |LEE 000#rew00055.=;
         |SI FSalida = 0; |Y #rew00055#3 ! 0; |Y #rew00055#4 ! 0;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores > 1 a¤o: Ganancia X: Contribuyente
            aAlfa = #rew00055#2;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores > 1 a¤o: Ganancia X: Importe total ganancia
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rew00055#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores > 1 a¤o: Ganancia X: Importe ganancia imputable 2001
            aAlfa = #rew00055#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + ("0" * 25);
            |HAZ GrabaCad;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         aAlfa = #rem01033#21;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = 0;             |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         nCalc1 = (nPasada * 3) + nCont;
         #rew00055#0 = nCalc1; #rew00055#1 = 2;
         |LEE 000#rew00055.=;
         |SI FSalida = 0; |Y #rew00055#3 ! 0; |Y #rew00055#4 ! 0;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Contribuyente
            aAlfa = #rew00055#5;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Importe total ganancia
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rew00055#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no sometidas a retencion: Ejerc.anteriores <= 1 a¤o: Perdida X: Importe ganancia imputable 2001
            aAlfa = #rew00055#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = Cadena + ("0" * 25); |HAZ GrabaCad;
         |FINSI;
      |SIGUE;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         aAlfa = #rem01033#22;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      |SINO;
         aAlfa = 0;             |HAZ Formateo; Cadena = Cadena + aAlfa;
      |FINSI;
      Cadena = Cadena + &13 + &10; |HAZ GrabaCad;

      #rew00055#0 = ((nPasada + 1) * 3) + 1;
      #rew00055#1 = 2;
      |LEE 000#rew00055.=;
      |SI FSalida = 0;
         nNoHay4 = 0;
      |SINO;
         nNoHay4 = 1;
      |FINSI;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1; |Y nNoHay3 = 1; |Y nNoHay4 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10009C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01029; |CIERRA #rem01030; |CIERRA #rem01031;
   |CIERRA #rem01032; |CIERRA #rem01033; |CIERRA #rew00055;
|FPRC;

|PROCESO Hoja10;
   nSwDatos = 10; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10010 ";
   |ABRE #rem01033; |ABRE #rem01034; |ABRE #rem01037;

   nNoHay = 0;
   #rem01037#0 = VEmpresa;
   #rem01037#1 = 0;
   #rem01037#2 = aTipo;
   #rem01037#3 = 1;
   |LEE 000#rem01037.];
   |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo;
      nNoHay = 1;
   |SINO;
      nNoHay = 0;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   #rem01034#0 = VEmpresa;
   #rem01034#1 = 0;
   #rem01034#2 = aTipo;
   |LEE 000#rem01034.=;
   |SI FSalida ! 0; |DDEFECTO #rem01034; |FINSI;

   || Exencion por reinversion ganancia patrim.vivienda habitual: Ganancia patrim.obtenida
   TipoDato = "N"; Long = 10;   LongDec = 2;
   aAlfa = #rem01033#23;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Exencion por reinversion ganancia patrim.vivienda habitual: Importe reinvertido en 2001
   aAlfa = #rem01033#24;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Exencion por reinversion ganancia patrim.vivienda habitual: Importe comprometido a reinvertir
   aAlfa = #rem01033#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Exencion por reinversion ganancia patrim.vivienda habitual: Ganancia patrim.exenta por reinversion
   aAlfa = #rem01033#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (G3) Integracion y compensacion ganancias y perdidas : Suma de ganancias patrimoniales
   aAlfa = #rem01033#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Suma de perdidas patrimoniales
   aAlfa = #rem01033#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Saldo neto a integrar parte general base imponible (positiva)
   aAlfa = #rem01033#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Saldo neto a integrar parte general base imponible (negativa)
   aAlfa = #rem01033#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Suma ganancias patrimoniales y saldo positivo casilla 202
   aAlfa = #rem01033#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Suma ganancias patrimoniales y saldo negativo casilla 203
   aAlfa = #rem01033#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Saldo neto a integrar parte especial base imponible (positiva)
   aAlfa = #rem01033#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Integracion y compensacion ganancias y perdidas : Saldo neto a integrar parte especial base imponible (negativa)
   aAlfa = #rem01033#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (H) Minimo personal y familiar : Importe minimo personal
   aAlfa = #rem01034#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Minimo personal y familiar : Importe minimo familiar por descendientes
   aAlfa = #rem01034#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Minimo personal y familiar : Importe minimo personal por ascendientes
   aAlfa = #rem01034#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Minimo personal y familiar : Suma minimo personal y familiar
   aAlfa = #rem01034#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || (I) Base liquidable general: Determinacion parte general: Saldo neto positivo ganancias y perdidas imputables 2001
   aAlfa = #rem01034#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Saldo neto negativo ganancias y perdidas imputables de 1999 y 2000
   aAlfa = #rem01034#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Saldo neto de rendimientos e imputaciones de renta
   aAlfa = #rem01034#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Compensaciones: Rendtos.irregulares negativos pdtes.compensacion 1996/1998
   aAlfa = #rem01034#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Compensaciones: Resto saldo neto negativo ganancias y perdidas 1999 y 2000
   aAlfa = #rem01034#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Compensaciones: Saldo neto negativo ganancias y perdidas 2001 parte general base imponible
   aAlfa = #rem01034#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Saldo neto negativo gan.y perd.imputables a 2001. Importe a compensar 4 ejerc.siguientes
   aAlfa = #rem01034#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Parte general de la base imponible previa aplicacion minimo personal y familiar
   aAlfa = #rem01034#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Minimo personal y familiar
   aAlfa = #rem01034#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Determinacion parte general: Parte general de la base imponible
   aAlfa = #rem01034#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   |SALVA_FICHA #rem01037;
   |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
      |SI #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo; |Y nNoHay = 0;
         |SI #rem01037#5 ! 0; |O #rem01037#6 ! 0;
            || (I1-1) Base liquidable general: Reduccion regimen general: Contribuyente
            aAlfa = #rem01037#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Base liquidable general: Reduccion regimen general: Exceso aport.realizadas no reducidas entre 1998 y 2000
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01037#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Base liquidable general: Reduccion regimen general: Aportaciones realizadas en 2001
            aAlfa = #rem01037#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |SINO;
            Cadena = "0" * 25; |HAZ GrabaCad;
         |FINSI;
      |SINO;
         Cadena = "0" * 25; |HAZ GrabaCad;
      |FINSI;
      |LEE 000#rem01037.s;
   |SIGUE;

   || Base liquidable general: Reduccion regimen general: Importe de la reduccion
   TipoDato = "N"; Long = 10;   LongDec = 2;
   aAlfa = #rem01034#16;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Reduccion regimen general: Reducir en los siguientes cinco ejercicios. Limite art.46.1. Exceso.
   aAlfa = #rem01034#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Reduccion aportaciones: Planes de pensiones participe el conyuge del contrib.Importe reduccion
   aAlfa = #rem01034#18; |HAZ Formateo; Cadena = Cadena + aAlfa;

   |REPON_FICHA #rem01037;

   nCont3 = 0;
   |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
      |SI #rem01037#0 = VEmpresa; |Y #rem01037#1 = 0; |Y #rem01037#2 = aTipo;
         |SI #rem01037#7 ! 0; |O #rem01037#8 ! 0;
            nCont3 = nCont3 + 1;
            || (I1-2) Base liquidable general: Reduccion aportaciones P.Pensiones a favor minusvalidos >= 65%: Contribuyente
            aAlfa = #rem01037#4;  |HAZ TipoContr; Cadena = Cadena + aTipoContr;
            || Base liquidable general: Reduccion aportaciones P.Pensiones a favor minusvalidos >= 65%: NIF Minusvalido
            TipoDato = "An"; Long = 9;    LongDec = 0;
            aAlfa = #rem01037#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Base liquidable general: Reduccion aportaciones P.Pensiones a favor minusvalidos >= 65%: Aportaciones Minusvalido
            TipoDato = "N";  Long = 10;   LongDec = 2;
            aAlfa = #rem01037#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            || Base liquidable general: Reduccion aportaciones P.Pensiones a favor minusvalidos >= 65%: Aportaciones parientes
            aAlfa = #rem01037#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad;
         |FINSI;
      |FINSI;
      |LEE 000#rem01037.s;
   |SIGUE;

   nCont3 = 2 - nCont3;

   |PARA nCont = 1; |SI nCont [ nCont3; |HACIENDO nCont = nCont + 1;
      aAlfa = "0         " + ("0" * 24); Cadena = Cadena + aAlfa;
      |HAZ GrabaCad;
   |SIGUE;

   || Base liquidable general: Reduccion aportaciones P.Pensiones a favor minusvalidos >= 65%: Importe de la reduccion
   TipoDato = "N"; Long = 10;   LongDec = 2;
   aAlfa = #rem01034#19;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquidable general: Reduccion aportaciones deportistas: Importe de la reduccion
   aAlfa = #rem01034#20;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   |SI #rem01034#21 = "X";
      || Base liquidable general: Reduccion pensiones compensatorias: Contribuyente
      aAlfa = "TITULAR   "; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Base liquidable general: Reduccion pensiones compensatorias: NIF del perceptor
      TipoDato = "An"; Long = 9;   LongDec = 0;
      aAlfa = #rem01034#23;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Base liquidable general: Reduccion pensiones compensatorias: Importe satisfecho
      TipoDato = "N"; Long = 10;   LongDec = 2;
      aAlfa = #rem01034#40;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |FINSI;

   |SI #rem01034#22 = "X";
      || Base liquidable general: Reduccion pensiones compensatorias: Contribuyente
      aAlfa = "CONYUGE   "; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
      || Base liquidable general: Reduccion pensiones compensatorias: NIF del perceptor
      TipoDato = "An"; Long = 9;   LongDec = 0;
      aAlfa = #rem01034#24;  |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Base liquidable general: Reduccion pensiones compensatorias: Importe satisfecho
      TipoDato = "N"; Long = 10;   LongDec = 2;
      aAlfa = #rem01034#41;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |FINSI;

   |SI #rem01034#21 = " ";
      aAlfa = "0         " + ("0" * 12); Cadena = Cadena + aAlfa;
   |FINSI;
   |SI #rem01034#22 = " ";
      aAlfa = "0         " + ("0" * 12); Cadena = Cadena + aAlfa;
   |FINSI;

   |HAZ GrabaCad;

   || Base liquidable general: Reduccion pensiones compensatorias: Total
   aAlfa = #rem01034#25;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general: Determinacion: Base liquidable general del ejercicio
   aAlfa = #rem01034#26;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general: Determinacion: Compensaciones: Bases liquidables regulares negativas 1996/1998
   aAlfa = #rem01034#27;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general: Determinacion: Compensaciones: Base liquidable general negativa 1999 y 2000
   aAlfa = #rem01034#28;  |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Base liquidable general: Determinacion: Compensaciones: Base liquidable general sometida a gravamen
   aAlfa = #rem01034#29;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   Cadena = &13 + &10; |HAZ GrabaCad;

   |CIERRA #rem01037; |CIERRA #rem01034; |CIERRA #rem01033;
|FPRC;

|PROCESO Hoja11;
   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "10011 ";

   |ABRE #rem01034; |ABRE #rem01041;

   #rem01034#0 = VEmpresa;
   #rem01034#1 = 0;
   #rem01034#2 = aTipo;
   |LEE 000#rem01034.=;
   |SI FSalida ! 0; |DDEFECTO #rem01034; |FINSI;

   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida ! 0; |DDEFECTO #rem01041; |FINSI;

   || (J) Base liquid.especial: Saldo neto positivo de gan.y per.patrim.a integrar parte especial base imponible
   TipoDato = "N"; Long = 10;   LongDec = 2;
   aAlfa = #rem01034#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquid.especial: Dismin.patrim.netas pdtes.compensar de ejercicios 1996 a 1998
   aAlfa = #rem01034#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquid.especial: Saldo neto negativo de gan.y per.patrim.1999 y 2000
   aAlfa = #rem01034#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquid.especial: Parte especial B.I. previa aplicacion min.personal/familiar
   aAlfa = #rem01034#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquid.especial: Minimo personal y familiar
   aAlfa = #rem01034#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Base liquid.especial: Total base liquidable especial
   aAlfa = #rem01034#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || (L) Cuota integra: Gravamen base liquidable gral.: Rentas exentas IRPF excepto para determinar el gravamen aplicable al resto
   Bloque = 9;  Casilla = " 49"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Base liquidable general sometida a gravamen
   Bloque = 10; Casilla = " 43"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Anualidades por alimentos en favor de los hijos por decision judicial
   Bloque = 10; Casilla = " 50"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Si se satisfacen anualidades por alimentos a hijos: Resto de la base liquidable general
   Bloque = 10; Casilla = " 51"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Cuota estatal
   Bloque = 10; Casilla = " 52"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Cuota autonomica o complementaria
   Bloque = 10; Casilla = " 53"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Tipo medio gravamen estatal
   Long = 2;
   Bloque = 10; Casilla = "TME"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable gral.: Tipo medio gravamen autonomico o complementario
   Bloque = 10; Casilla = "TMA"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable especial: Cuota estatal
   Long = 10;
   Bloque = 12; Casilla = " 54"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable especial: Cuota autonomica o complementaria
   Bloque = 12; Casilla = " 55"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable especial: Cuota integra estatal
   Bloque = 13; Casilla = " 56"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable especial: Cuota integra autonomica o complementaria
   Bloque = 13; Casilla = " 57"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota integra: Gravamen base liquidable especial: Cuota integra total
   Bloque = 13; Casilla = " 58"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || (M) Deduc.grales.cuota: Invers.y donativos: Importe invertidos: Inversiones y gastos en bienes de interes cultural
   aAlfa = #rem01041#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Importe con derecho a deduc.: Inversiones y gastos en bienes de interes cultural
   aAlfa = #rem01041#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Importe deduccion: Inversiones y gastos en bienes de interes cultural
   aAlfa = #rem01041#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Importes invertidos: Cantidades donadas a determinadas entidades
   aAlfa = #rem01041#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Importe con derecho a deduc.: Cantidades donadas a determinadas entidades
   aAlfa = #rem01041#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Importe deduccion: Cantidades donadas a determinadas entidades
   aAlfa = #rem01041#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Suma de cantidades invertidas o donadas
   aAlfa = #rem01041#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Invers.y donativos: Limite 10%
   aAlfa = #rem01041#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Adquisicion o rehabilitacion: Con financ.ajena: Importe de la deduccion
   aAlfa = #rem01041#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Adquisicion o rehabilitacion: Sin financ.ajena: Importe de la deduccion
   aAlfa = #rem01041#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Contruccion o ampliacion: Importe de la deduccion
   aAlfa = #rem01041#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Importe total de la deduccion
   aAlfa = #rem01041#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: Entidad
   TipoDato = "N"; Long = 4; LongDec = 0;
   aAlfa = #rem01041#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: Sucursal
   aAlfa = #rem01041#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuoTa: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: DC
   Long = 2;
   aAlfa = #rem01041#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: N§ Cuenta
   Long = 10;
   aAlfa = #rem01041#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: Titular de la cuenta
   aAlfa = #rem01041#20; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 1: Fecha apertura
   TipoDato = "F";
   aAlfa = #rem01041#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: Entidad
   TipoDato = "N"; Long = 4;   LongDec = 0;
   aAlfa = #rem01041#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: Sucursal
   aAlfa = #rem01041#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: DC
   Long = 2;
   aAlfa = #rem01041#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: N§ Cuenta
   Long = 10;
   aAlfa = #rem01041#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: Titular de la cuenta
   aAlfa = #rem01041#26; |HAZ TipoContr; Cadena = Cadena + aTipoContr;
   || Deduc.grales.cuota: Inversion vivienda habitual: Identificacion cuentas vivienda: Cuenta 2: Fecha apertura
   TipoDato = "F";
   aAlfa = #rem01041#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Por adecuacion viv.hab.de minusv.con financiacion ajena
   TipoDato = "N"; Long = 10; LongDec = 2;
   aAlfa = #rem01041#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Inversion vivienda habitual: Por adecuacion viv.hab.de minusv.sin financiacion ajena
   aAlfa = #rem01041#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Deducc.activ.economicas: por incentivos y estimulos a la inversion empresarial
   Bloque = 17; Casilla = " 67"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Deducc.activ.economicas: por rendtos.derivados bienes corporales producidos en Canarias
   Bloque = 17; Casilla = " 68"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deduc.grales.cuota: Deducc.activ.economicas: por dotaciones reserva para inversiones en Canarias
   Bloque = 17; Casilla = " 69"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10;  |HAZ GrabaCad;

   |CIERRA #rem01034; |CIERRA #rem01041;
|FPRC;

|PROCESO Hoja12;
   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "10012 ";

   |ABRE #rem01041;

   #rem01041#0 = VEmpresa;
   #rem01041#1 = 0;
   #rem01041#2 = aTipo;
   |LEE 000#rem01041.=;
   |SI FSalida ! 0; |DDEFECTO #rem01041; |FINSI;

   || (M) Deducciones grales.cuota integra: Deduc.rentas obtenidas en Ceuta o Melilla. Importe de la deduccion
   TipoDato = "N"; Long = 10; LongDec = 2;
   Bloque = 18; Casilla = " 70"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones grales.cuota integra: Total deduc.grales.cuota integra
   Bloque = 19; Casilla = " 71"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (N) Deducciones autonomicas de la cuota: Suma de deducciones autonomicas
   Bloque = 20; Casilla = " 72"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || (O) Cuota liquida: Cuota liquida estatal
   Bloque = 21; Casilla = " 73"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota liquida autonomica o complementaria
   Bloque = 21; Casilla = " 74"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota liquida total
   Bloque = 21; Casilla = " 75"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios anteriores a 1997: Importe perdida
   Bloque = 22; Casilla = " 76"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios anteriores a 1997: Intereses demora
   Bloque = 22; Casilla = " 77"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios 1997 a 2000: Importe perdida
   Bloque = 22; Casilla = " 78"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios 1997 a 2000: Intereses demora
   Bloque = 22; Casilla = " 79"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios 1998 a 2000: Importe perdida
   Bloque = 22; Casilla = " 80"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Increm.perdida derecho a determ.deduc.: Ejercicios 1998 a 2000: Intereses demora
   Bloque = 22; Casilla = " 81"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota liquida estatal incrementada
   Bloque = 22; Casilla = " 82"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota liquida autonomica incrementada
   Bloque = 22; Casilla = " 83"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota liquida total incrementada
   Bloque = 22; Casilla = " 84"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Cuota liquida: Deduc.Doble impos.dividendos: Saldo pendte.deduc.2001 : Deduc.procedentes de 1998 a 2000
   aAlfa = #rem01041#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Aplicado a esta declar. : Deduc.procedentes de 1998 a 2000
   aAlfa = #rem01041#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Pendientes de aplicacion: Deduc.procedentes de 1998 a 2000
   aAlfa = #rem01041#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Saldo pendte.deduc.2001 : Deduc.correspondientes a 2001
   aAlfa = #rem01041#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Aplicado a esta declar. : Deduc.correspondientes a 2001
   aAlfa = #rem01041#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Pendientes de aplicacion: Deduc.correspondientes a 2001
   aAlfa = #rem01041#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.dividendos: Importe que se aplica en esta declaracion
   aAlfa = #rem01041#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.internacional: Rentas obtenidas y grabadas en el extranjero
   Bloque = 23; Casilla = " 86"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos.internacional: En supuestos aplicacion regimen transp.fiscal internac.
   Bloque = 23; Casilla = " 87"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Deduc.Doble impos. en supuestos de imputacion de rentas derivadas de la cesion de derechos de imagen
   Bloque = 23; Casilla = " 88"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Compensaciones fiscales por deduccion: Comp.fiscal.contrib.arrendatarios vivienda habitual
   Bloque = 23; Casilla = " 89"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Compensaciones fiscales por deduccion: Comp.fiscal.por deduccion adquisicion vivienda habitual
   Bloque = 23; Casilla = " 90"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Cuota liquida: Cuota resultante de la autoliquidacion
   Bloque = 23; Casilla = " 91"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || (P) Retenciones y demas pagos a cuenta: Por rendtos.del trabajo: suma retenciones e ing.a cta.
   Bloque = 24; Casilla = " 92"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por rendtos.del capital mobil.: suma retenciones e ing.a cta.
   Bloque = 24; Casilla = " 93"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por arrend.inmuebles urbanos: suma retenciones e ing.a cta.
   Bloque = 24; Casilla = " 94"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por rend.activ.economicas: suma retenciones e ing.a cta.
   Bloque = 24; Casilla = " 95"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por actividades economicas: Pagos fraccionados realizados
   Bloque = 24; Casilla = " 96"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por ganancias y perdidas patrim.(incluidos premios): suma retenciones e ing.a cta.
   Bloque = 24; Casilla = " 97"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Imput.reg.transp.fiscal: Retenciones,ing.a cta.,pagos fracc.y Cuota Imp.Sociedades
   Bloque = 24; Casilla = " 98"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Imput.reg.transp.fiscal: Exceso pagos a cta.imput. (art.65, letra c, Ley 40/98)
   Bloque = 24; Casilla = " 99"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Imput.rentas derivadas cesion derechos imagen: Ing.a cta.(art.76.9 Ley 40/98)
   Bloque = 24; Casilla = "100"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Por bonif.otorgadas por el programa PREVER (art.3 Ley 29/97). Importe deducible.
   Bloque = 24; Casilla = "101"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Cuota impuesto renta no residentes
   Bloque = 25; Casilla = "107"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Retenciones y demas pagos a cuenta: Total pagos a cuenta
   Bloque = 26; Casilla = "102"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || (Q) Cuota diferencial: Cuota diferencial
   Bloque = 27; Casilla = "103"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || (R) Regular.mediante decl.complementaria. Result.ingresar ant.autoliq.o liqu.adtvas. Corresp.a 2001
   Bloque = 28; Casilla = "104"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regular.mediante decl.complementaria. Devoluciones acordadas admon.corresp.a 2001
   Bloque = 28; Casilla = "105"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Regular.mediante decl.complementaria. Resultado de la declaracion complementaria
   Bloque = 28; Casilla = "106"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10;  |HAZ GrabaCad;

   |CIERRA #rem01041;
|FPRC;

|PROCESO Hoja13;
   nSwDatos = 13; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10013 ";

   |ABRE #rem01043;

   #rem01043#0 = VEmpresa;
   #rem01043#1 = 0;
   #rem01043#2 = aTipo;
   |LEE 000#rem01043.=;
   |SI FSalida ! 0; |DDEFECTO #rem01043; |FINSI;

   || Deducciones Autonomicas Cuota: Cmdad. Baleares: importe deducc.contr.edad >= 65 a¤os
   TipoDato = "N"; Long = 10; LongDec = 2;
   aAlfa = #rem01043#3; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: importe deducc.invidentes,mutilados o invalidos
   aAlfa = #rem01043#4; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Adquisicion o rehabilitacion de la vivienda habitual por jovenes
   aAlfa = #rem01043#5; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Gastos de guarderia
   aAlfa = #rem01043#6; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Gastos conservacion fincas areas suelo rustico protegido
   aAlfa = #rem01043#7; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Baleares: Suma deducciones autonomicas
   aAlfa = #rem01043#8; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Deducc.condicion familia numerosa
   aAlfa = #rem01043#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Importe deducc.hijos nacidos/adopt.en el ejercicio
   aAlfa = #rem01043#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Deducc.por cant.para rehab.y conserv.Patrim.Hist.
   aAlfa = #rem01043#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Deducc.por cant.para restaurar inmueb.Patrim.Hist.
   aAlfa = #rem01043#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Castilla y Leon: Suma deducciones autonomicas
   aAlfa = #rem01043#13; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por nacim./adop. del segundo o ulterior hijo. Cada progenitor
   aAlfa = #rem01043#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Por donativos Fundac.Abadia Montserrat reconst.y repar.
   aAlfa = #rem01043#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Catalu¤a: Suma deducciones autonomicas
   aAlfa = #rem01043#16; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Importe deducc.hijos nacid./adopt.en el ejercicio
   aAlfa = #rem01043#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por familia numerosa
   aAlfa = #rem01043#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Por cuidado de hijos 3 o menos a¤os
   aAlfa = #rem01043#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Galicia: Suma deducciones autonomicas
   aAlfa = #rem01043#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Importe nacimiento o adopcion de hijos
   aAlfa = #rem01043#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Importe deducc.personas acogidas mayores 65 a¤os o minusvalidos
   aAlfa = #rem01043#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Por donat.Fundac.culturales, asistenciales, sanitarias
   aAlfa = #rem01043#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Madrid: Suma deducciones autonomicas
   aAlfa = #rem01043#24; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Deducc.por adquis.vivienda habitual jovenes
   aAlfa = #rem01043#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Por adq./rehab.vivienda habitual por contr.con derecho 1998,1999 o 2000
   aAlfa = #rem01043#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Deducc.donativ.a fundaciones protecc.patrim.hist.
   aAlfa = #rem01043#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Murcia: Suma deducciones autonomicas
   aAlfa = #rem01043#28; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Deducc.adqu./rehab.vivienda por jovenes
   aAlfa = #rem01043#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Deducc.adqu./rehab.2¦ vivienda medio rural
   aAlfa = #rem01043#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. La Rioja: Suma deducciones autonomicas
   aAlfa = #rem01043#31; |HAZ Formateo; Cadena = Cadena + aAlfa;

   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Importe deduc.hijos nacidos 3§ o sucesivos
   aAlfa = #rem01043#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Importe deduc.contr.munisvalidos >= 65 a¤os
   aAlfa = #rem01043#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Adqu.1¦ vivienda habit.contr.hasta 35 a¤os
   aAlfa = #rem01043#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Destinar ayudas public.para adqu.vivienda habit.
   aAlfa = #rem01043#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Donaciones con finalidad ecologica
   aAlfa = #rem01043#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Donacion bienes formen parte patrim.cultural valenciano
   aAlfa = #rem01043#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Donacion cantidades conserv.restaura.bienes Patrim.
   aAlfa = #rem01043#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Cant.destinadas por sus titulares a conserv.repar.bienes patrim.
   aAlfa = #rem01043#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Realizacion uno de los conyuges labores no remuneradas hogar
   aAlfa = #rem01043#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Deducciones Autonomicas Cuota: Cmdad. Valenciana: Suma deducciones autonomicas
   aAlfa = #rem01043#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja14;
   nSwDatos = 14; nCalc1 = 0;
   |HAZ MiraSiDatos;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10014 ";

   |ABRE #rem01042;

   #rem01042#0 = VEmpresa;
   #rem01042#1 = 0;
   #rem01042#2 = aTipo;
   |LEE 000#rem01042.=;
   |SI FSalida ! 0; |DDEFECTO #rem01042; |FINSI;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Gral.Saldos pdtes.ejer.1996 (act.fijos n.)
   TipoDato = "N"; Long = 10; LongDec = 2;
   aAlfa = #rem01042#3;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Gral.Saldos pdtes.ejer.1996 (act.fijos n.)
   aAlfa = #rem01042#4;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Gral.Saldos pdtes.ejer.1996 (Resto mod.)
   aAlfa = #rem01042#5;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Gral.Saldos pdtes.ejer.1996 (Resto mod.)
   aAlfa = #rem01042#6;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Gral.Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#7;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Gral.Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#8;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Gral.Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#9;  |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Esp. A¤o santo Jacobeo 1999
   aAlfa = #rem01042#10; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Esp. A¤o santo Jacobeo 1999
   aAlfa = #rem01042#11; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Esp. A¤o santo Jacobeo 1999
   aAlfa = #rem01042#12; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Esp. Santiago Cap.Cult.Europea 2000
   aAlfa = #rem01042#13; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Esp. Santiago Cap.Cult.Europea 2000
   aAlfa = #rem01042#14; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Esp. Santiago Cap.Cult.Europea 2000
   aAlfa = #rem01042#15; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Saldo ant./deducc.2001 R.Esp. Salamanca Cap.Cult.Europea 2002
   aAlfa = #rem01042#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Aplicado en esta decl. R.Esp. Salamanca Cap.Cult.Europea 2002
   aAlfa = #rem01042#17; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Saldos pdtes.ejerc.ant.Pendiente aplicacion   R.Esp. Salamamca Cap.Cult.Europea 2002
   aAlfa = #rem01042#18; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Gastos act.I+D
   aAlfa = #rem01042#19; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Gastos act.I+D
   aAlfa = #rem01042#20; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Gastos act.I+D
   aAlfa = #rem01042#21; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#22; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#23; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Gastos act.innov.tecnologica
   aAlfa = #rem01042#24; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Invers.Tecn.infor.y comunic.
   aAlfa = #rem01042#25; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Invers.Tecn.infor.y comunic.
   aAlfa = #rem01042#26; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Invers.Tecn.infor.y comunic.
   aAlfa = #rem01042#27; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Inv.gastos act.exportacion
   aAlfa = #rem01042#28; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Inv.gastos act.exportacion
   aAlfa = #rem01042#29; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Inv.gastos act.exportacion
   aAlfa = #rem01042#30; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Inv.Bienes interes cultural
   aAlfa = #rem01042#31; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Inv.Bienes interes cultural
   aAlfa = #rem01042#32; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Inv.Bienes interes cultural
   aAlfa = #rem01042#33; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Inv.Producc.cinemat.Audiov.
   aAlfa = #rem01042#34; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Inv.Producc.cinemat.Audiov.
   aAlfa = #rem01042#35; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Inv.Producc.cinemat.Audiov.
   aAlfa = #rem01042#36; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Inv.edicion de libros
   aAlfa = #rem01042#37; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Inv.edicion de libros
   aAlfa = #rem01042#38; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Inv.edicion de libros
   aAlfa = #rem01042#39; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Protec.medio ambiente
   aAlfa = #rem01042#40; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Protec.medio ambiente
   aAlfa = #rem01042#41; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Protec.medio ambiente
   aAlfa = #rem01042#42; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Modernizacion transportes
   aAlfa = #rem01042#43; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Modernizacion transportes
   aAlfa = #rem01042#44; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Modernizacion transportes
   aAlfa = #rem01042#45; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Gastos form.profesional
   aAlfa = #rem01042#46; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Gastos form.profesional
   aAlfa = #rem01042#47; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Gastos form.profesional
   aAlfa = #rem01042#48; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Gral. Creacion empleo trab.minusv.
   aAlfa = #rem01042#49; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Gral. Creacion empleo trab.minusv.
   aAlfa = #rem01042#50; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Gral. Creacion empleo trab.minusv.
   aAlfa = #rem01042#51; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Saldo ant./deducc.2001 R.Esp.  Salamanca capital europea 2002
   aAlfa = #rem01042#52; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Aplicado en esta decl. R.Esp.  Salamanca capital europea 2002
   aAlfa = #rem01042#53; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Gral.y r.especiales.Deducc.ejerc.2001 Pendiente aplicacion   R.Esp.  Salamanca capital europea 2002
   aAlfa = #rem01042#54; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Saldo ant./deducc.2001 Saldos pdtes.ejercicio 1996 (act.fijos)
   aAlfa = #rem01042#55; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Aplicado en esta decl. Saldos pdtes.ejercicio 1996 (act.fijos)
   aAlfa = #rem01042#56; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Saldo ant./deducc.2001 Saldos pdtes.ejerc.1997 a 2000 (act.fijos)
   aAlfa = #rem01042#57; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Aplicado en esta decl. Saldos pdtes.ejerc.1997 a 2000 (act.fijos)
   aAlfa = #rem01042#58; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Pendiente aplicacion   Saldos pdtes.ejerc.1997 a 2000 (act.fijos)
   aAlfa = #rem01042#59; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Saldo ant./deducc.2001 Saldos pdtes.ejercicio 1996 (resto modalidades)
   aAlfa = #rem01042#60; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Aplicado en esta decl. Saldos pdtes.ejercicio 1996 (resto modalidades)
   aAlfa = #rem01042#61; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Saldo ant./deducc.2001 Saldos pdtes.ejerc.1997 a 2000 (resto modalidades)
   aAlfa = #rem01042#62; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Aplicado en esta decl. Saldos pdtes.ejerc.1997 a 2000 (resto modalidades)
   aAlfa = #rem01042#63; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Saldos pdtes.ejer.ant.Pendiente aplicacion   Saldos pdtes.ejerc.1997 a 2000 (resto modalidades)
   aAlfa = #rem01042#64; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Gastos act.I+D
   aAlfa = #rem01042#65; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Gastos act.I+D
   aAlfa = #rem01042#66; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Gastos act.I+D
   aAlfa = #rem01042#67; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Gastos act.innov.tecnol.
   aAlfa = #rem01042#68; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Gastos act.innov.tecnol.
   aAlfa = #rem01042#69; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Gastos act.innov.tecnol.
   aAlfa = #rem01042#70; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.Tecnol.Inform.y comunic.
   aAlfa = #rem01042#71; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.Tecnol.Inform.y comunic.
   aAlfa = #rem01042#72; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.Tecnol.Inform.y comunic.
   aAlfa = #rem01042#73; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.gastos act.exportacion
   aAlfa = #rem01042#74; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.gastos act.exportacion
   aAlfa = #rem01042#75; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.gastos act.exportacion
   aAlfa = #rem01042#76; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.bienes interes cultural
   aAlfa = #rem01042#77; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.bienes interes cultural
   aAlfa = #rem01042#78; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.bienes interes cultural
   aAlfa = #rem01042#79; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.producc.cinemat.audiov.
   aAlfa = #rem01042#80; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.producc.cinemat.audiov.
   aAlfa = #rem01042#81; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.producc.cinemat.audiov.
   aAlfa = #rem01042#82; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Edicion de libros
   aAlfa = #rem01042#83; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Edicion de libros
   aAlfa = #rem01042#84; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Edicion de libros
   aAlfa = #rem01042#85; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.Protec.medio ambiente
   aAlfa = #rem01042#86; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.Protec.medio ambiente
   aAlfa = #rem01042#87; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.Protec.medio ambiente
   aAlfa = #rem01042#88; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Inv.modernizacion transportes
   aAlfa = #rem01042#89; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Inv.modernizacion transportes
   aAlfa = #rem01042#90; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Inv.modernizacion transportes
   aAlfa = #rem01042#91; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Gastos formacion profesional
   aAlfa = #rem01042#92; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Gastos formacion profesional
   aAlfa = #rem01042#93; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Gastos formacion profesional
   aAlfa = #rem01042#94; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Creacion empleo trab.minusvalidos
   aAlfa = #rem01042#95; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Creacion empleo trab.minusvalidos
   aAlfa = #rem01042#96; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Creacion empleo trab.minusvalidos
   aAlfa = #rem01042#97; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Saldo ant./deducc.2001 Invers.adqu.act.fijos
   aAlfa = #rem01042#98; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Aplicado en esta decl. Invers.adqu.act.fijos
   aAlfa = #rem01042#99; |HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.inver.Canarias. Deducc.ejercicio 2001.Pendiente aplicacion   Invers.adqu.act.fijos
   aAlfa = #rem01042#100;|HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Modalidad I+D Saldos pdtes.ejercicio 1996
   aAlfa = #rem01042#101;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Modalidad I+D Saldos pdtes.ejercicio 1996
   aAlfa = #rem01042#102;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Modalidad I+D Saldos pdtes.ejercicios 1997 a 2000
   aAlfa = #rem01042#103;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Modalidad I+D Saldos pdtes.ejercicios 1997 a 2000
   aAlfa = #rem01042#104;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Pendiente aplicacion   Modalidad I+D Saldos pdtes.ejercicios 1997 a 2000
   aAlfa = #rem01042#105;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Modalidad I+D Deduccion del 2001
   aAlfa = #rem01042#106;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Modalidad I+D Deduccion del 2001
   aAlfa = #rem01042#107;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Pendiente aplicacion   Modalidad I+D Deduccion del 2001
   aAlfa = #rem01042#108;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Otras modalidades Saldos pdtes.1996
   aAlfa = #rem01042#109;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Otras modalidades Saldos pdtes.1996
   aAlfa = #rem01042#110;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Otras modalidades Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#111;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Otras modalidades Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#112;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Pendiente aplicacion   Otras modalidades Saldos pdtes.ejer.1997 a 2000
   aAlfa = #rem01042#113;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Saldo ant./deducc.2001 Otras modalidades Deduccion 2001
   aAlfa = #rem01042#114;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Aplicado en esta decl. Otras modalidades Deduccion 2001
   aAlfa = #rem01042#115;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Proy.Cartuja 93 Pendiente aplicacion   Otras modalidades Deduccion 2001
   aAlfa = #rem01042#116;|HAZ Formateo; Cadena = Cadena + aAlfa;
   |HAZ GrabaCad;

   || Incent.estim.inv.emp.Importe total decl.deducc.incent.estim.inv.emp.Deducciones incentivos estimulos. Importe total
   aAlfa = #rem01042#117;|HAZ Formateo; Cadena = Cadena + aAlfa;

   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Importe dotaciones Reserva inv.Canarias 1998
   aAlfa = #rem01042#118;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Materializac.2001  Reserva inv.Canarias 1998
   aAlfa = #rem01042#119;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Clave              Reserva inv.Canarias 1998
   aAlfa = #rem01042#120;               Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Importe dotaciones Reserva inv.Canarias 1999
   aAlfa = #rem01042#121;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Materializac.2001  Reserva inv.Canarias 1999
   aAlfa = #rem01042#122;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Clave              Reserva inv.Canarias 1999
   aAlfa = #rem01042#123;               Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Pdte.Materializar  Reserva inv.Canarias 1999
   aAlfa = #rem01042#124;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Importe dotaciones Reserva inv.Canarias 2000
   aAlfa = #rem01042#125;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Materializac.2001  Reserva inv.Canarias 2000
   aAlfa = #rem01042#126;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Clave              Reserva inv.Canarias 2000
   aAlfa = #rem01042#127;               Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Pdte.Materializar  Reserva inv.Canarias 2000
   aAlfa = #rem01042#128;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Importe dotaciones Reserva inv.Canarias 2001
   aAlfa = #rem01042#129;|HAZ Formateo; Cadena = Cadena + aAlfa;
   || Incent.estim.inv.emp.R.Esp.Reserva inv.Canarias Deduccion 2001
   Bloque = 17; Casilla = " 69"; |HAZ BuscaCasilla;
   aAlfa = Casilla; |HAZ Formateo; Cadena = Cadena + aAlfa;

   Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
   |CIERRA #rem01043;
|FPRC;

|PROCESO Hoja15;
   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "10015 ";

   TipoDato = "N"; Long = 10; LongDec = 2; nCalc1 = 0;
   Bloque = 30; Casilla = "  b"; |HAZ BuscaCasilla; nCalc1 = Casilla;
   |SI nCalc1 < 0; nCalc1 = 0 - nCalc1; |FINSI;
   |SI SwError = 1;
      Bloque = 33; Casilla = "  a"; |HAZ BuscaCasilla; nCalc1 = Casilla;
      |SI nCalc1 < 0; nCalc1 = 0 - nCalc1; |FINSI;
   |FINSI;
   aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
   |SI nCalc1 ! 0;
      Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
   |FINSI;
|FPRC;

|PROCESO Hoja16;
   nSwDatos = 0; nCalc1 = 0;
   aTipo = VTipo % 0110;

   Cadena = "10016 ";

   TipoDato = "N"; Long = 10; LongDec = 2;
   #rem01001#0 = VEmpresa;
   #rem01001#1 = 0;
   #rem01001#2 = VTipo;
   |LEE 000#rem01001.=;
   |SI FSalida = 0;
      || Liquidacion : Resultado a ingresar o a devolver
      aAlfa = #rem01001#16; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Liquidacion : Solicitud de suspension del ingreso conyuge/renuncia a la devol.otro conyuge
      Bloque = 29;     Casilla = "  1"; |HAZ BuscaCasilla;
      |SI SwError = 1; Casilla = "  2"; |HAZ BuscaCasilla; |FINSI;
      |SI SwError = 1; aAlfa = " "; |SINO; aAlfa = "X"; |FINSI;
      Cadena = Cadena + aAlfa;
      || Declaracion complementaria : Resultado de la decl.complementaria
      Bloque = 28;     Casilla = "106"; |HAZ BuscaCasilla;
      aAlfa = Casilla; |HAZ Formateo;  Cadena = Cadena + aAlfa;
      || Ingreso : Fracciona o no el pago
      |SI #rem01001#8 = "S"; aAlfa = " X"; |SINO; aAlfa = "X "; |FINSI;
      Cadena = Cadena + aAlfa;
      || Ingreso : Importe del ingreso
      nCalc1 = #rem01001#16;
      |SI #rem01001#8 = "S"; nCalc1 = nCalc1 % 60; |FINSI;
      aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Ingreso : Forma de pago
      |SI #rem01001#9 = "S"; aAlfa = "X "; |SINO; aAlfa = " X"; |FINSI;
      Cadena = Cadena + aAlfa;
      || Ingreso : Codigo cuenta
      |SI #rem01001#9 = "S";
         Cadena = Cadena + ("0" * 20);
      |SINO;
         Cadena = Cadena + aCuenta1;
      |FINSI;
      || Opciones de pago 2§ plazo : Si domicilia o no el 2§ pago
      |SI #rem01001#10 = "S"; aAlfa = " X"; |SINO; aAlfa = "X "; |FINSI;
      Cadena = Cadena + aAlfa;
      || Opciones de pago 2§ plazo : Importe 2§ plazo
      nCalc1 = 0;
      |SI #rem01001#8 = "S"; nCalc1 = #rem01001#16 % 40; |FINSI;
      aAlfa = nCalc1; |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Opciones de pago 2§ plazo : Codigo cuenta
      |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S";
         Cadena = Cadena + aCuenta1;
      |SINO;
         Cadena = Cadena + ("0" * 20);
      |FINSI;

      aAlfa = "";
      || Devolucion : Renuncia a la devolucion
      |SI #rem01001#11 = "S"; aAlfa = aAlfa + "X"; |SINO; aAlfa = aAlfa + " "; |FINSI;
      || Devolucion : Devolucion por transferencia
      |SI #rem01001#12 = "S"; aAlfa = aAlfa + "X"; |SINO; aAlfa = aAlfa + " "; |FINSI;
      Cadena = Cadena + aAlfa;
      || Devolucion : Importe de la devolucion
      |SI #rem01001#16 < 0;
         aAlfa = #rem01001#16;
      |SINO;
         aAlfa = "0";
      |FINSI;
      |HAZ Formateo; Cadena = Cadena + aAlfa;
      || Devolucion : Codigo cuenta
      |SI #rem01001#12 = "S";
         Cadena = Cadena + aCuenta1;
      |SINO;
         Cadena = Cadena + ("0" * 20);
      |FINSI;

      Cadena = Cadena + &13 + &10; |HAZ GrabaCad;
   |FINSI;
|FPRC;

|PROCESO MiraSiDatos;
   |SI nSwDatos = 2;
      nSwDatos = 0; Bloque = 1;
      Casilla = " 01"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 02"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 03"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 04"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 05"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 06"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 07"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 2;
      Casilla = " 08"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 09"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 10"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 11"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 12"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 3;
      Casilla = " 13"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 4;
      Casilla = " 14"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 15"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 16"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 17"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 3;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 18"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 4;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 19"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 20"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 5;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 21"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 6;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 22"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 23"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 7;
      nSwDatos = 0; Bloque = 6;
      Casilla = " 24"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 25"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 26"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 27"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 8;
      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#3  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#4  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#5  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#6  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#7  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#11 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#12 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#13 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#14 ! 0; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 9;
      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#15 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#16 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#17 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#18 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#19 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#20 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#21 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#22 ! 0; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 10;
      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#23 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#24 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#25 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#26 ! 0; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      |ABRE #rem01034;
      #rem01034#0 = VEmpresa;
      #rem01034#1 = 0;
      #rem01034#2 = aTipo;
      |LEE 000#rem01034.=;
      |SI FSalida = 0;
         |SI #rem01034#6  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01034#13 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01034#17 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01034#26 ! 0; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01034;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      Bloque = 7;
      Casilla = " 28"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 29"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 30"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 31"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 32"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 33"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 34"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 35"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 36"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 37"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 38"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 39"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 40"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 41"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 42"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 43"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 11;
      nSwDatos = 0;
      |ABRE #rem01041;
      #rem01041#0 = VEmpresa;
      #rem01041#1 = 0;
      #rem01041#2 = aTipo;
      |LEE 000#rem01041.=;
      |SI FSalida = 0;
         aAlfa = #rem01041#20; |QBF aAlfa; |SI aAlfa ! ""; nSwDatos = 1; |FINSI;
         aAlfa = #rem01041#26; |QBF aAlfa; |SI aAlfa ! ""; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01041;
      |SI nSwDatos = 1; |ACABA; |FINSI;

      Bloque = 8;
      Casilla = " 44"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 45"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 46"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 47"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 48"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 9;
      Casilla = " 49"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 10;
      Casilla = " 50"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 51"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 52"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 53"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 12;
      Casilla = " 54"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 55"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 13;
      Casilla = " 56"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 57"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 58"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 15;
      Casilla = " 59"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 60"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 16;
      Casilla = " 61"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 62"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 63"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 64"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 65"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 66"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 17;
      Casilla = " 67"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 68"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 69"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 66"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 12;
      nSwDatos = 0; Bloque = 18;
      Casilla = " 70"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 19;
      Casilla = " 71"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 20;
      Casilla = " 72"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 21;
      Casilla = " 73"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 74"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 75"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 22;
      Casilla = " 76"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 77"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 78"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 79"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 80"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 81"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 82"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 83"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 84"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 23;
      Casilla = " 85"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 86"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 87"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 88"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 89"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 90"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 91"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 24;
      Casilla = " 92"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 93"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 94"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 95"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 96"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 97"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 98"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 99"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = "100"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = "101"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 25;
      Casilla = "107"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 26;
      Casilla = "102"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 27;
      Casilla = "103"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 28;
      Casilla = "104"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = "105"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = "106"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 13;
      nSwDatos = 0; Bloque = 20;
      Casilla = " 72"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 14;
      nSwDatos = 0; Bloque = 17;
      Casilla = " 67"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 69"; |HAZ BuscaCasilla; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
|FPRC;
