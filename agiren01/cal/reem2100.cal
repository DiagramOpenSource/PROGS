|FICHEROS;
   rem01010 #0;
   rem01011 #1;
   rem01012 #2;
   rem01014 #3;
   rem01015 #4;
   rem01016 #5;
   rem01017 #6;
   rem01018 #7;
   rem01019 #8;
   rem01020 #9;
   rem01021 #10;
   rem01022 #11;
   rem01023 #12;
   rem01024 #13;
   rem01025 #14;
   rem01026 #15;
   rem01027 #16;
   rem01028 #17;
   rem01033 #18;
   rem01002 #19;
|FIN;

|VARIABLES;

   aLong = ""; nLong = 0;
   aSeparada = "";

   Vacio1 = "";
   Vacio2 = "";
   nNegativo = "";

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   &aIP   = "";

   &Handle = 0;
   SwError = 0;
   Bloque = 0;
   Casilla = "";
   nSwDatos = 0;
   Cadena = "";
   Cadena1 = "";
   Cadena2 = "";
   Cadena3 = "";
   &VEmpresa = 0;
   &VTipo = "";
   aTipo = "";
   aTipoContr = "";

   TipoDato = "";
   Long = 0;
   LongDec = 0;

   Calc  = 0;
   Calc1 = 0;
   Calc2 = 0;

   nPasada = 0;
   nCont  = 0;
   nCont1 = 0;
   nCont2 = 0;
   nSalir = 0;
   nCalc1 = 0;
   nCalc2 = 0;
   nNoHay  = 0;
   nNoHay1  = 0;
   nNoHay2  = 0;
   nNoHay3  = 0;
   nNoHay4 = 0;
|FIN;

|PROCESO Hoja02;
   nSwDatos = 2;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;

   Cadena = "10002 ";
   |ABRE #rem01010;
   #rem01010#0 = VEmpresa;
   #rem01010#1 = 0;
   #rem01010#2 = VTipo;
   |LEE 000#rem01010.=;
   |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
   |CIERRA #rem01010;

   TipoDato = "N";  Long = 10;  LongDec = 2;
   || (A) Rendim.trabajo: Ingresos Integros: Ret.Dinerarias : Ingr.Integros
   aAlfa = #rem01010#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Valoracion
   aAlfa = #rem01010#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta
   aAlfa = #rem01010#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.a Cuenta Reperc.
   aAlfa = #rem01010#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Ret.Especie: Ing.Integros
   aAlfa = #rem01010#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Ingresos Integros: Contrib.Planes Pens. y Prev.Social: Importes
   aAlfa = #rem01010#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Reducciones especiales: Importe
   aAlfa = #rem01010#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cotiz.Seg.Social/Mutuas grles.
   aAlfa = #rem01010#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas satisfechas a sindicatos
   aAlfa = #rem01010#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Cuotas a colegios profesionales
   aAlfa = #rem01010#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Gastos defensa jurid.derivados litigios con el empleador
   aAlfa = #rem01010#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01010#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01010#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Importe de la reduccion
   aAlfa = #rem01010#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rendim.trabajo: Gastos deducibles: Total rendimiento neto reducido
   aAlfa = #rem01010#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena1 = Cadena; Cadena = "";

   |ABRE #rem01012;
   #rem01012#0 = VEmpresa;
   #rem01012#1 = 0;
   #rem01012#2 = VTipo;
   |LEE 000#rem01012.=;
   |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
   |CIERRA #rem01012;

   || (B) Rend.Cap.Mobil: Ingresos integros: Int.de cuentas y dep.activos financieros
   aAlfa = #rem01012#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Dividendos por part.fondos propios entidades
   aAlfa = #rem01012#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.transm.o amort.Letras del tesoro
   aAlfa = #rem01012#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.transm., amort.o reemb.otros activos financ.
   aAlfa = #rem01012#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Rdtos.contratos seg.vida o invalidez y oper.cap.
   aAlfa = #rem01012#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Otros rdtos.capital mobiliario
   aAlfa = #rem01012#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Ingresos integros: Total ingresos integros
   aAlfa = #rem01012#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Gastos admin.y dep.de valores
   aAlfa = #rem01012#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Otros gastos fiscalmente deducibles
   aAlfa = #rem01012#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Total gastos deducibles
   aAlfa = #rem01012#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Gastos deducibles: Total rendimiento neto
   aAlfa = #rem01012#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Total importe reducciones (Art.24.2 Ley 40/98)
   aAlfa = #rem01012#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Reducc.rendtos.contratos de seguro (Disp.Tr.6¦ Ley 40/98)
   aAlfa = #rem01012#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Cap.Mobil: Total rendimiento neto reducido
   aAlfa = #rem01012#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Rend.netos transm,amort,val.deuda pub,antes 31/12/1996: Saldo positivo
   aAlfa = #rem01012#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Deuda Publ.: Rend.netos transm,amort,val.deuda pub,antes 31/12/1996: Saldo negativo
   aAlfa = #rem01012#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena2 = Cadena; Cadena = "";

   || (C) Imputacion de rentas inmobiliarias (excluida vivienda habitual y suelo no edif.)
   Bloque = 3; Casilla = " 13"; |HAZ BuscaCasilla1;
   aAlfa = Casilla; |HAZ Formateo1; Cadena = Cadena + aAlfa;

   |ABRE #rem01011;
   #rem01011#0 = VEmpresa;
   #rem01011#1 = 0;
   #rem01011#2 = VTipo;
   |LEE 000#rem01011.=;
   |SI FSalida ! 0; |DDEFECTO #rem01011; |FINSI;
   |CIERRA #rem01011;

   || (D) Rend.Capital Inm.: Ingresos integros: Arrend./constitucion o cesion derechos uso inmueble
   aAlfa = #rem01011#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Ingresos integros: Part.propietario/usuf.en precio subarr.o traspaso
   aAlfa = #rem01011#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Ingresos integros: Total ingresos integros
   aAlfa = #rem01011#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Intereses cap.ajenos invertidos en adqu.bienes o derechos
   aAlfa = #rem01011#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Amort.inmuebles y bienes cedidos
   aAlfa = #rem01011#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Compens.fiscal contratos arrend.anteriores a 09/05/1985
   aAlfa = #rem01011#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Otros gastos fiscales deducibles
   aAlfa = #rem01011#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Gastos deducibles : Total gastos deducibles
   aAlfa = #rem01011#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Total rendimiento neto
   aAlfa = #rem01011#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Reducciones (Art.21.2 Ley 40/1998)
   aAlfa = #rem01011#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   || Rend.Capital Inm.: Rendimiento neto : Total rendimiento neto reducido
   aAlfa = #rem01011#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
   Cadena = Cadena + &13 + &10; Cadena3 = Cadena; Cadena = "";

   |SI nSwDatos = 1;
      Cadena = Cadena1; |HAZ GrabaCad1;
      Cadena = Cadena2; |HAZ GrabaCad1;
      Cadena = Cadena3; |HAZ GrabaCad1;
   |FINSI;
|FPRC;

|PROCESO Hoja03;
   nSwDatos = 3; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10003 ";
   |ABRE #rem01014; |ABRE #rem01015;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
    |Y #rem01014#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01014.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01015#0 = VEmpresa;
   #rem01015#1 = 0;
   #rem01015#2 = aTipo;
   #rem01015#3 = 1;
   |LEE 000#rem01015.];
   |PARA; |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0;
    |Y #rem01015#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01015.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01014#0 = VEmpresa;
   #rem01014#1 = 0;
   #rem01014#2 = aTipo;
   #rem01014#3 = 1;
   |LEE 000#rem01014.];
   |SI FSalida ! 0; |O #rem01014#0 ! VEmpresa; |O #rem01014#1 ! 0; |O #rem01014#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01015#0 = VEmpresa;
   #rem01015#1 = 0;
   #rem01015#2 = VTipo;
   #rem01015#3 = 1;
   |LEE 000#rem01015.];
   |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0; |Y #rem01014#2 = aTipo; |Y nNoHay1 = 0;
            || (E1-1) Rend.Activ.econ.est.directa normal: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01014#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa normal: Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01014#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01014#7; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Imputacion Temporal
            TipoDato = "A";  Long = 1;
            aAlfa = #rem01014#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Ingresos explotacion
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01014#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros ingresos
            aAlfa = #rem01014#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Autoconsumo de bienes y servicios
            aAlfa = #rem01014#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total ingresos computables
            aAlfa = #rem01014#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos consumos explotacion
            aAlfa = #rem01014#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos sueldos y salarios
            aAlfa = #rem01014#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos seguridad social
            aAlfa = #rem01014#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros gastos de personal
            aAlfa = #rem01014#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos arrend.y canones
            aAlfa = #rem01014#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos reparacion y conservacion
            aAlfa = #rem01014#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos servicios profesionales independientes
            aAlfa = #rem01014#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos suministros
            aAlfa = #rem01014#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos otros serv.exteriores
            aAlfa = #rem01014#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos tributos fisc.deducibles
            aAlfa = #rem01014#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos financieros
            aAlfa = #rem01014#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos amort.dotac.ejercicio
            aAlfa = #rem01014#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Gastos provisiones dotac.ejercicio
            aAlfa = #rem01014#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Otros gastos fiscalmente deducibles
            aAlfa = #rem01014#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total gastos deducibles
            aAlfa = #rem01014#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Rendimiento neto
            aAlfa = #rem01014#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Reduccion del 30 %
            aAlfa = #rem01014#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Decl.Actividad X: Total rendimiento neto reducido
            aAlfa = #rem01014#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0      " + ("0" * 164); |HAZ GrabaCad1;
            Cadena = "0" * 100;                        |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01014.s;
         |SI FSalida ! 0; |DDEFECTO #rem01014; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0; |Y #rem01014#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo; |Y nNoHay2 = 0;
            || (E1-2) Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01015#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01015#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01015#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01015#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01015#7; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01015#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Reduccion del 30 %
            aAlfa = #rem01015#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa normal: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01015#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0         0000     " + ("0" * 36);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01015.s;
         |SI FSalida ! 0; |DDEFECTO #rem01015; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01015#0 = VEmpresa; |Y #rem01015#1 = 0; |Y #rem01015#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 18"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10003C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01015; |CIERRA #rem01014;
|FPRC;

|PROCESO Hoja04;
   nSwDatos = 4; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10004 ";
   |ABRE #rem01016; |ABRE #rem01017; |ABRE #rem01018;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01016#0 = VEmpresa;
   #rem01016#1 = 0;
   #rem01016#2 = aTipo;
   #rem01016#3 = 1;
   |LEE 000#rem01016.];
   |PARA; |SI FSalida = 0; |Y #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0;
    |Y #rem01016#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01016.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01017#0 = VEmpresa;
   #rem01017#1 = 0;
   #rem01017#2 = aTipo;
   #rem01017#3 = 1;
   |LEE 000#rem01017.];
   |PARA; |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0;
    |Y #rem01017#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01017.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01016#0 = VEmpresa;
   #rem01016#1 = 0;
   #rem01016#2 = aTipo;
   #rem01016#3 = 1;
   |LEE 000#rem01016.];
   |SI FSalida ! 0; |O #rem01016#0 ! VEmpresa; |O #rem01016#1 ! 0; |O #rem01016#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01017#0 = VEmpresa;
   #rem01017#1 = 0;
   #rem01017#2 = VTipo;
   #rem01017#3 = 1;
   |LEE 000#rem01017.];
   |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0; |Y #rem01016#2 = aTipo; |Y nNoHay1 = 0;
            || (E2-1) Rend.Activ.econ.est.directa simpl.: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01016#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa simpl.: Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01016#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01016#7; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Imputacion Temporal
            TipoDato = "A";  Long = 1;
            aAlfa = #rem01016#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Ingresos explotacion
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01016#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Otros ingresos
            aAlfa = #rem01016#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Autoconsumo de bienes y servicios
            aAlfa = #rem01016#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total ingresos computables
            aAlfa = #rem01016#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos consumos explotacion
            aAlfa = #rem01016#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos sueldos y salarios
            aAlfa = #rem01016#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos seguridad social
            aAlfa = #rem01016#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos arrend.y canones
            aAlfa = #rem01016#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos reparacion y conservacion
            aAlfa = #rem01016#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos servicios profesionales independientes
            aAlfa = #rem01016#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos suministros
            aAlfa = #rem01016#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos otros serv.exteriores
            aAlfa = #rem01016#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos tributos fisc.deducibles
            aAlfa = #rem01016#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos financieros
            aAlfa = #rem01016#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Gastos amort.dotac.ejercicio
            aAlfa = #rem01016#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Otros gastos fiscalmente deducibles
            aAlfa = #rem01016#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total gastos deducibles
            aAlfa = #rem01016#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Diferencia ingresos/gastos
            aAlfa = #rem01016#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Provisiones deducibles
            aAlfa = #rem01016#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Rendimiento neto
            aAlfa = #rem01016#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Reduccion del 30 %
            aAlfa = #rem01016#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Decl.Actividad X: Total rendimiento neto reducido
            aAlfa = #rem01016#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0      " + ("0" * 164); |HAZ GrabaCad1;
            Cadena = "0" * 100;                        |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01016.s;
         |SI FSalida ! 0; |DDEFECTO #rem01016; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01016#0 = VEmpresa; |Y #rem01016#1 = 0; |Y #rem01016#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo; |Y nNoHay2 = 0;
            || (E2-2) Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01017#9;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01017#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01017#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Clave ident.tipo actividad
            TipoDato = "An"; Long = 1;   LongDec = 0;
            aAlfa = #rem01017#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            Long = 4; aAlfa = #rem01017#6; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01017#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Reduccion del 30 %
            aAlfa = #rem01017#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.directa simpl.: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01017#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0         0000     " + ("0" * 36);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01017.s;
         |SI FSalida ! 0; |DDEFECTO #rem01017; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01017#0 = VEmpresa; |Y #rem01017#1 = 0; |Y #rem01017#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 19"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         #rem01018#0 = VEmpresa;
         #rem01018#1 = 0;
         #rem01018#2 = aTipo;
         |LEE 000#rem01018.=;
         |SI FSalida = 0;
            aAlfa = #rem01018#3; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = #rem01018#4; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = #rem01018#5; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = #rem01018#6; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         |SINO;
            aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
            aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         |FINSI;
      |SINO;
         aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = &13 + &10;  |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10004C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01018; |CIERRA #rem01017; |CIERRA #rem01016;
|FPRC;

|PROCESO Hoja05;
   nSwDatos = 5; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10005 ";
   |ABRE #rem01019; |ABRE #rem01020;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
    |Y #rem01019#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01019.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01020#0 = VEmpresa;
   #rem01020#1 = 0;
   #rem01020#2 = aTipo;
   #rem01020#3 = 1;
   |LEE 000#rem01020.];
   |PARA; |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0;
    |Y #rem01020#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01020.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01019#0 = VEmpresa;
   #rem01019#1 = 0;
   #rem01019#2 = aTipo;
   #rem01019#3 = 1;
   |LEE 000#rem01019.];
   |SI FSalida ! 0; |O #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0; |O #rem01019#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01020#0 = VEmpresa;
   #rem01020#1 = 0;
   #rem01020#2 = VTipo;
   #rem01020#3 = 1;
   |LEE 000#rem01020.];
   |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0; |Y #rem01019#2 = aTipo; |Y nNoHay1 = 0;
            || (E4-1) Rend.Activ.econ.est.objetiva: Actividad X: Clasificacion IAE
            aAlfa = #rem01019#4; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01019#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 1¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 1¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 1¦
            Long = 9;
            aAlfa = #rem01019#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 2¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 2¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 2¦
            Long = 9;
            aAlfa = #rem01019#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 3¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 3¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 3¦
            Long = 9;
            aAlfa = #rem01019#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 4¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#15;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 4¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 4¦
            Long = 9;
            aAlfa = #rem01019#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 5¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 5¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 5¦
            Long = 9;
            aAlfa = #rem01019#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;

            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 6¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#21;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 6¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 6¦
            Long = 9;
            aAlfa = #rem01019#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Definicion 7¦
            TipoDato = "A"; Long = 24;   LongDec = 0;
            aAlfa = #rem01019#24;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Unidades definicion 7¦
            TipoDato = "N"; Long = 7;   LongDec = 2;
            aAlfa = #rem01019#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto por modulo definicion 7¦
            Long = 9;
            aAlfa = #rem01019#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto previo (suma)
            Long = 10;
            aAlfa = #rem01019#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo al empleo
            aAlfa = #rem01019#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Minorizaciones por incentivo a la inversion
            aAlfa = #rem01019#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto minorado
            aAlfa = #rem01019#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector especial
            Long = 2; LongDec = 2;
            aAlfa = #rem01019#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector empresas peque¤a dimension
            aAlfa = #rem01019#32; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector temporada
            aAlfa = #rem01019#33; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector exceso
            aAlfa = #rem01019#34; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Indice corrector inicio nueva actividad
            aAlfa = #rem01019#35; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto de modulos
            Long = 10;
            aAlfa = #rem01019#36; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;

            || Rend.Activ.econ.est.objetiva: Actividad X: Gastos extraordinarios
            aAlfa = #rem01019#37; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Rendto.Neto calculado
            aAlfa = #rem01019#38; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Otras percepciones empresariales
            aAlfa = #rem01019#40; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Total rendimiento neto
            aAlfa = #rem01019#41; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Reduccion Art.30 Ley 40/98
            aAlfa = #rem01019#42; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Actividad X: Total rendto.neto reducido
            aAlfa = #rem01019#43; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "    0";
            aAlfa = (" " * 24) + ("0" * 20);
            Cadena = Cadena + aAlfa + aAlfa + aAlfa; |HAZ GrabaCad1;
            Cadena = aAlfa + aAlfa + aAlfa + aAlfa;  |HAZ GrabaCad1;
            Cadena = ("0" * 152);                    |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01019.s;
         |SI FSalida ! 0; |DDEFECTO #rem01019; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0; |Y #rem01019#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo; |Y nNoHay2 = 0;
            || (E4-2) Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01020#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: NIF entid.reg.atrib.rentas
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01020#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Porcentaje participacion
            TipoDato = "N";  Long = 2;   LongDec = 2;
            aAlfa = #rem01020#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Grupo o epigrafe IAE
            TipoDato = "An"; Long = 4;   LongDec = 0;
            aAlfa = #rem01020#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01020#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.Activ.econ.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto reducido
            aAlfa = #rem01020#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0         0000    " + ("0" * 24);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01020.s;
         |SI FSalida ! 0; |DDEFECTO #rem01020; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01020#0 = VEmpresa; |Y #rem01020#1 = 0; |Y #rem01020#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 21"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10005C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01019; |CIERRA #rem01020;
|FPRC;

|PROCESO Hoja06;
   nSwDatos = 6; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10006 ";
   |ABRE #rem01021; |ABRE #rem01022;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
    |Y #rem01021#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01021.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = aTipo;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |PARA; |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0;
    |Y #rem01022#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 3; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01022.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01021#0 = VEmpresa;
   #rem01021#1 = 0;
   #rem01021#2 = aTipo;
   #rem01021#3 = 1;
   |LEE 000#rem01021.];
   |SI FSalida ! 0; |O #rem01021#0 ! VEmpresa; |O #rem01021#1 ! 0; |O #rem01021#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01022#0 = VEmpresa;
   #rem01022#1 = 0;
   #rem01022#2 = VTipo;
   #rem01022#3 = 1;
   |LEE 000#rem01022.];
   |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0; |Y #rem01021#2 = aTipo; |Y nNoHay1 = 0;
            || (E5-1) Rend.A.G.y F.est.objetiva: Actividad X: Clave de actividad
            TipoDato = "N"; Long = 1;   LongDec = 0;
            aAlfa = #rem01021#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Contribuyente que realiza la actividad
            aAlfa = #rem01021#6;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.A.G.y F.est.objetiva: Actividad X: Imputacion temporal
            aAlfa = #rem01021#4;  Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 1
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 1
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 1
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 2
            aAlfa = #rem01021#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 2
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 2
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 3
            aAlfa = #rem01021#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 3
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 3
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 4
            aAlfa = #rem01021#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 4
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 4
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 5
            aAlfa = #rem01021#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 5
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 5
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#21; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 6
            aAlfa = #rem01021#22; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 6
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#23; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 6
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#24; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 7
            aAlfa = #rem01021#25; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 7
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#26; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 7
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#27; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 8
            aAlfa = #rem01021#28; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 8
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#29; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 8
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#30; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;

            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 9
            aAlfa = #rem01021#31; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 9
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#32; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 9
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#33; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 10
            aAlfa = #rem01021#34; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 10
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#35; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 10
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#36; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 11
            aAlfa = #rem01021#37; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 11
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#38; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 11
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#39; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 12
            aAlfa = #rem01021#40; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 12
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#41; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 12
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#42; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Ingresos integros Producto 13
            aAlfa = #rem01021#43; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice Producto 13
            TipoDato = "An"; Long = 6;   LongDec = 0;
            aAlfa = #rem01021#44; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.base producto 13
            TipoDato = "N"; Long = 9;   LongDec = 2;
            aAlfa = #rem01021#45; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Total ingresos
            aAlfa = #rem01021#46; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto previo (suma)
            aAlfa = #rem01021#47; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion gasoleo agricola (35% del precio)
            aAlfa = #rem01021#58; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Amortizacion inmovilizado
            aAlfa = #rem01021#48; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto minorado
            aAlfa = #rem01021#49; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector medios ajenos
            TipoDato = "N"; Long = 2;   LongDec = 2;
            aAlfa = #rem01021#50; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector util.pers.asalariado
            aAlfa = #rem01021#51; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector cultivos tierras arrend.
            aAlfa = #rem01021#52; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector piensos adq.a terceros, mas del 50%
            aAlfa = #rem01021#53; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector act.agricultura ecologica
            aAlfa = #rem01021#54; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector empresa no supera los 9015.18 E
            aAlfa = #rem01021#55; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Indice corrector determ.act.forestales
            aAlfa = #rem01021#56; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;

            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto de modulos
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01021#57; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Gastos extraordinarios
            aAlfa = #rem01021#59; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendto.neto calculado por est.obj.
            aAlfa = #rem01021#60; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion Ley 19/95 (agricultores jovenes)
            aAlfa = #rem01021#62; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto
            aAlfa = #rem01021#63; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Reduccion prevista art.30 Ley 40/98
            aAlfa = #rem01021#64; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Actividad X: Rendimiento neto reducido
            aAlfa = #rem01021#65; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            |HAZ GrabaCad1;
            Cadena = "00 ";
            aAlfa = ("0" * 11) + (" " * 6) + ("0" * 11);
            Cadena = Cadena + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa;
            |HAZ GrabaCad1;
            Cadena = aAlfa + aAlfa + aAlfa + aAlfa + aAlfa + aAlfa;
            |HAZ GrabaCad1;
            Cadena = ("0" * 167); |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01021.s;
         |SI FSalida ! 0; |DDEFECTO #rem01021; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0; |Y #rem01021#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
         |SI #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo; |Y nNoHay2 = 0;
            || (E5-2) Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: Contribuyente
            aAlfa = #rem01022#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: NIF entidad
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01022#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Entidad X: Porcentaje participacion
            TipoDato = "N";  Long = 2;   LongDec = 2;
            aAlfa = #rem01022#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Actividad X: Rendimiento neto atrib.al contribuyente
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01022#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Rend.A.G.y F.est.objetiva: Atrib.Rentas Actividad X: Rendto.neto red.atrib.al contribuyente
            aAlfa = #rem01022#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0         0000" + ("0" * 24); |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01022.s;
         |SI FSalida ! 0; |DDEFECTO #rem01022; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         Bloque = 5; Casilla = " 22"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         Bloque = 5; Casilla = " 23"; |HAZ BuscaCasilla1;
         aAlfa = Casilla; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10006C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01021; |CIERRA #rem01022;
|FPRC;

|PROCESO Hoja07;
   nSwDatos = 7; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10007 ";
   |ABRE #rem01023; |ABRE #rem01024; |ABRE #rem01025; |ABRE #rem01026;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont = 0;
   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |PARA; |SI FSalida = 0; |Y #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0;
    |Y #rem01023#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01023.s;
   |SIGUE;
   nCont = nCalc2;

   nCalc1 = 0; nCalc2 = 0;
   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = aTipo;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |PARA; |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0;
    |Y #rem01024#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01024.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |PARA; |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0;
    |Y #rem01025#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCalc2 = nCalc2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01025.s;
   |SIGUE;
   |SI nCont < nCalc2; nCont = nCalc2; |FINSI;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01023#0 = VEmpresa;
   #rem01023#1 = 0;
   #rem01023#2 = aTipo;
   #rem01023#3 = 1;
   |LEE 000#rem01023.];
   |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01024#0 = VEmpresa;
   #rem01024#1 = 0;
   #rem01024#2 = VTipo;
   #rem01024#3 = 1;
   |LEE 000#rem01024.];
   |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   nCalc1 = 0; nCalc2 = 0;
   #rem01025#0 = VEmpresa;
   #rem01025#1 = 0;
   #rem01025#2 = aTipo;
   #rem01025#3 = 1;
   |LEE 000#rem01025.];
   |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo;
      nNoHay3 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay3 = 1;
   |FINSI;

   #rem01026#0 = VEmpresa;
   #rem01026#1 = 0;
   #rem01026#2 = aTipo;
   |LEE 000#rem01026.=;
   |SI FSalida ! 0; |DDEFECTO #rem01026; |FINSI;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo; |Y nNoHay1 = 0;
            || (F-1) Imputaciones a entidades: Sociedad X: Contribuyente
            aAlfa = #rem01023#4;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Imputaciones a entidades: Sociedad X: NIF Entidad transparente
            TipoDato = "A"; Long = 9;   LongDec = 0;
            aAlfa = #rem01023#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Clave tipo entidad transparente
            aAlfa = #rem01023#5;  Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Criterio de imputacion
            |SI #rem01023#19 = " "; |Y #rem01023#20 = " "; Cadena = Cadena + " "; |FINSI;
            |SI #rem01023#19 = "X"; Cadena = Cadena + "1"; |FINSI;
            |SI #rem01023#20 = "X"; Cadena = Cadena + "2"; |FINSI;
            || Imputaciones a entidades: Sociedad X: Base imponible positiva imputada
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01023#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por rentas en Ceuta o Melilla
            aAlfa = #rem01023#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por doble imposicion de dividendos
            aAlfa = #rem01023#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por doble imposicion internacional
            aAlfa = #rem01023#10;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por inversion empresarial
            aAlfa = #rem01023#11;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Deduc.por creacion de empleo
            aAlfa = #rem01023#12;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Imputac.pagos frac.,retenc. e ing.a Cta.
            aAlfa = #rem01023#13;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Imputac.Cuota Imp.Sociedades satisfecha a la sociedad
            aAlfa = #rem01023#14;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Suma
            aAlfa = #rem01023#15;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputaciones a entidades: Sociedad X: Exceso de pagos a cta.imputados
            aAlfa = #rem01023#17;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0           " + ("0" * 120);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01023.s;
         |SI FSalida ! 0; |DDEFECTO #rem01023; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      TipoDato = "N";  Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Imputaciones a entidades: Total base imponible imputada
         aAlfa = #rem01026#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Imputaciones a entidades: Total suma de deducciones, pagos fraccionados y cuotas Imp.sociedades
         aAlfa = #rem01026#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Imputaciones a entidades: Total exceso de pagos a cuenta imputados
         aAlfa = #rem01026#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
      |SINO;
         |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo; |Y nNoHay2 = 0;
            || (F-2) Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Contribuyente
            aAlfa = #rem01024#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Denominacion entidad no residente
            TipoDato = "An"; Long = 24;   LongDec = 0;
            aAlfa = #rem01024#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Criterio de imputacion
            |SI #rem01024#6 = " "; |Y #rem01024#7 = " "; Cadena = Cadena + " "; |FINSI;
            |SI #rem01024#6 = "X"; Cadena = Cadena + "1"; |FINSI;
            |SI #rem01024#7 = "X"; Cadena = Cadena + "2"; |FINSI;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Importe rentas positivas imputables
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01024#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Impuestos analogos al Imp.Sociedades no imputables
            aAlfa = #rem01024#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas positivas reg.transp.fiscal intern.: Entidad X: Importe de la imputacion
            aAlfa = #rem01024#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0" + (" " * 25) + ("0" * 36); |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01024.s;
         |SI FSalida ! 0; |DDEFECTO #rem01024; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Imputacion rentas positivas reg.transp.fiscal intern.: Total importe de la imputacion
         aAlfa = #rem01026#6;  |HAZ Formateo1;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: Contribuyente
         aAlfa = #rem01026#7;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
         || Imputacion rentas derechos de imagen: NIF o denominacion persona o entidad cesionaria
         TipoDato = "An"; Long = 25;   LongDec = 0;
         aAlfa = #rem01026#8;  |HAZ Formateo1;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: NIF o denominacion persona o entidad relacion laboral
         aAlfa = #rem01026#9;  |HAZ Formateo1;  Cadena = Cadena + aAlfa;
         || Imputacion rentas derechos de imagen: Cantidad a imputar en la base imponible
         TipoDato = "N"; Long = 10;   LongDec = 2;
         aAlfa = #rem01026#10; |HAZ Formateo1;  Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = Cadena + aAlfa; |HAZ GrabaCad1;
         Cadena = "0" + (" " * 50) + ("0" * 12); |HAZ GrabaCad1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo; |Y nNoHay3 = 0;
            || (F-3) Imputacion rentas instituciones: I.I.Colectiva X: Contribuyente
            aAlfa = #rem01025#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Imputacion rentas instituciones: I.I.Colectiva X: Denominacion institucion
            TipoDato = "An"; Long = 24;   LongDec = 0;
            aAlfa = #rem01025#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Valor liquidativo
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01025#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Valor de adquisicion
            aAlfa = #rem01025#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Imputacion rentas instituciones: I.I.Colectiva X: Importe de la imputacion
            aAlfa = #rem01025#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0" + (" " * 24) + ("0" * 36);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01025.s;
         |SI FSalida ! 0; |DDEFECTO #rem01025; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo;
         nNoHay3 = 0;
      |SINO;
         nNoHay3 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Imputacion rentas instituciones: Total del importe de la imputacion
         aAlfa = #rem01026#11; |HAZ Formateo1;  Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;

      Cadena = &13 + &10; |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1; |Y nNoHay3 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10007C0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01026; |CIERRA #rem01025; |CIERRA #rem01024; |CIERRA #rem01023;
|FPRC;

|PROCESO Hoja08;
   nSwDatos = 8; nCalc1 = 0;
   |HAZ MiraSiDatos1;
   |SI nSwDatos = 0; |ACABA; |FINSI;
   aTipo = VTipo % 0110;

   Cadena = "10008 ";
   |ABRE #rem01027; |ABRE #rem01028; |ABRE #rem01033;

   || Primero se calcula el n§ de paginas adicionales, puesto que las pide

   nCalc1 = 0; nCalc2 = 0; nCont1 = 0; nCont2 = 0;
   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |PARA; |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0;
    |Y #rem01027#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 9; nCont1 = nCont1 + 1; nCalc1 = 1; |FINSI;
      |LEE 000#rem01027.s;
   |SIGUE;

   nCalc1 = 0; nCalc2 = 0;
   #rem01028#0 = VEmpresa;
   #rem01028#1 = 0;
   #rem01028#2 = aTipo;
   #rem01028#3 = 1;
   |LEE 000#rem01028.];
   |PARA; |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0;
    |Y #rem01028#2 = aTipo; |HACIENDO;
      nCalc1 = nCalc1 + 1;
      |SI nCalc1 = 4; nCont2 = nCont2 + 1; nCalc1 = 1;|FINSI;
      |LEE 000#rem01028.s;
   |SIGUE;

   || Hecho esto, procedemos a leer registro a registro

   nNoHay = 0; nNoHay1 = 0; nNoHay2 = 0;

   #rem01027#0 = VEmpresa;
   #rem01027#1 = 0;
   #rem01027#2 = aTipo;
   #rem01027#3 = 1;
   |LEE 000#rem01027.];
   |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo;
      nNoHay1 = 1;
      nNoHay = 1;
   |SINO;
      nNoHay1 = 0;
   |FINSI;

   #rem01028#0 = VEmpresa;
   #rem01028#1 = 0;
   #rem01028#2 = VTipo;
   #rem01028#3 = 1;
   |LEE 000#rem01028.];
   |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo;
      nNoHay2 = 0;
      nNoHay = 0;
   |SINO;
      nNoHay2 = 1;
   |FINSI;

   #rem01033#0 = VEmpresa;
   #rem01033#1 = 0;
   #rem01033#2 = aTipo;
   |LEE 000#rem01033.=;
   |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

   || (G-0) Regimen especial fusiones, escisiones y canje valores ent.no resid.: Contribuyente (1)
   aAlfa = #rem01033#35;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Opta por el regimen especial (1)
   Cadena = Cadena + #rem01033#36;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Contribuyente (2)
   aAlfa = #rem01033#37;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
   || Regimen especial fusiones, escisiones y canje valores ent.no resid.: Opta por el regimen especial (2)
   Cadena = Cadena + #rem01033#38;

   || N§ de hojas adicionales
   TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nCont1; |HAZ Formateo1;
   Cadena = Cadena + aAlfa;

   FSalida = 0; nSalir = 0; nPasada = 0;
   |PARA; |SI nSalir = 0; |Y nNoHay = 0; |HACIENDO;
      |PARA nCont = 1; |SI nCont [ 8; |HACIENDO nCont = nCont + 1;
         |SI #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo; |Y nNoHay1 = 0;
            || (G-1) Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Contribuyente
            aAlfa = #rem01027#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: NIF
            TipoDato = "An"; Long = 9;   LongDec = 0;
            aAlfa = #rem01027#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Generacion <= 1 a¤o
            TipoDato = "N";  Long = 10;  LongDec = 2;

            Calc = #rem01027#6 - #rem01027#7; aAlfa = Calc;
            |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Generacion > 1 a¤o
            Calc = #rem01027#8 - #rem01027#9; aAlfa = Calc;
            |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Sociedad/Fondo X: Retenciones
            aAlfa = #rem01027#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0         " + ("0" * 36); |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01027.s;
         |SI FSalida ! 0; |DDEFECTO #rem01027; |FINSI;
      |SIGUE;

      |SI FSalida = 0; |Y #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo;
         nNoHay1 = 0;
      |SINO;
         nNoHay1 = 1;
      |FINSI;

      TipoDato = "N";  Long = 10;  LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo <= 1 a¤o: Ganancias partim.netas
         aAlfa = #rem01033#3;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo <= 1 a¤o: Perdidas partim.netas
         aAlfa = #rem01033#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo > 1 a¤o: Ganancias partim.netas
         aAlfa = #rem01033#5;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Transm.o reemb.: Periodo > 1 a¤o: Perdidas partim.netas
         aAlfa = #rem01033#6;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En metalico: Importe total
         aAlfa = #rem01033#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Valoracion
         aAlfa = #rem01033#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Ingresos a cuenta
         aAlfa = #rem01033#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Ingresos a cuenta repercutidos
         aAlfa = #rem01033#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Ganancias/Perdidas sometidas a retencion: Premios: En especie: Importe total
         aAlfa = #rem01033#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Hojas adicionales capitulo (G-2)
         TipoDato = "N"; Long = 1; LongDec = 0; aAlfa = nCont2; |HAZ Formateo1;
         Cadena = Cadena + aAlfa;
         |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         aAlfa = 0;            |HAZ Formateo1; Cadena = Cadena + aAlfa;
         || Hojas adicionales capitulo (G-2)
         Cadena = Cadena + "0"; |HAZ GrabaCad1;
      |FINSI;

      |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
         |SI #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo; |Y nNoHay2 = 0;
            || (G-2) Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Contribuyente
            aAlfa = #rem01028#5;  |HAZ TipoContr1; Cadena = Cadena + aTipoContr;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Descripcion
            TipoDato = "An"; Long = 20;  LongDec = 0;
            aAlfa = #rem01028#4;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Elementos afectos
            Cadena = Cadena + #rem01028#6;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Fecha adquisicion
            TipoDato = "F";
            aAlfa = #rem01028#7;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Fecha transmision
            aAlfa = #rem01028#8;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Valor transmision
            TipoDato = "N"; Long = 10;   LongDec = 2;
            aAlfa = #rem01028#9;  |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Valor adquisicion
            aAlfa = #rem01028#10; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Perdida patrimonial obtenida
            aAlfa = #rem01028#11; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Perdida patrimonial imputable a 2001
            aAlfa = #rem01028#12; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial obtenida
            aAlfa = #rem01028#13; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial exenta por reinversion
            aAlfa = #rem01028#14; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no exenta
            aAlfa = #rem01028#15; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no exenta 2001
            aAlfa = #rem01028#16; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Reduccion
            aAlfa = #rem01028#17; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial reducida
            aAlfa = #rem01028#18; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial diferida reinvers.
            aAlfa = #rem01028#19; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Elemento X: Ganancia patrimonial no diferida 2001
            aAlfa = #rem01028#20; |HAZ Formateo1; Cadena = Cadena + aAlfa;
            |HAZ GrabaCad1;
         |SINO;
            Cadena = Cadena + "0" + (" " * 37) + ("0" * 144);
            |HAZ GrabaCad1;
         |FINSI;
         |LEE 000#rem01028.s;
         |SI FSalida ! 0; |DDEFECTO #rem01028; |FINSI;
      |SIGUE;
      |SI FSalida = 0; |Y #rem01028#0 = VEmpresa; |Y #rem01028#1 = 0; |Y #rem01028#2 = aTipo;
         nNoHay2 = 0;
      |SINO;
         nNoHay2 = 1;
      |FINSI;

      TipoDato = "N"; Long = 10;   LongDec = 2;
      |SI nPasada = 0;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total perdida patrim.imputable 2001
         aAlfa = #rem01033#12; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total ganancia patrim.no exenta imputable 2001
         aAlfa = #rem01033#13; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         || Ganancias/Perdidas no somet.a retencion: Periodo <= 1 a¤o: en 2001: Importe total ganancia no diferida.imputable 2001
         aAlfa = #rem01033#14; |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |SINO;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
         aAlfa = 0;       |HAZ Formateo1; Cadena = aAlfa; |HAZ GrabaCad1;
      |FINSI;
      Cadena = &13 + &10; |HAZ GrabaCad1;

      || Si sigue habiendo datos, creamos una hoja adicional y seguimos

      |SI nNoHay1 = 1; |Y nNoHay2 = 1;
         nSalir = 1;
      |SINO;
         nSalir = 0;
         Cadena = "10008C0 0 0";
      |FINSI;
      nPasada = nPasada + 1;
   |SIGUE;

   |CIERRA #rem01033; |CIERRA #rem01028; |CIERRA #rem01027;
|FPRC;

|PROCESO Formateo1;
   |QBF aAlfa;
   |SI TipoDato = "F";
      aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
      |SI aAlfa = "01010000"; aAlfa = "        "; |FINSI;
      |ACABA;
   |FINSI;
   |SI TipoDato = "N";
      Vacio1 = "0" * Long;
      Vacio2 = "0" * LongDec;
      aAlfa = aAlfa - "-";
      |SI FSalida ! 0;
         nNegativo = 1;
      |SINO;
         nNegativo = 0;
      |FINSI;
   |SINO;
      Vacio1 = " " * Long;
   |FINSI;

   |SI TipoDato ! "N";
      Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
   |SINO;
      |SI LongDec = 0;
         Calc1 = 0 - (100 + Long);
         aAlfa = (Vacio1 + aAlfa) % Calc1;
      |SINO;
         aAlfa = aAlfa - ".";
         |SI FSalida = 0;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa) % Calc1;
            aAlfa1 = "0" * LongDec;
         |SINO;
            Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
            Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
            aAlfa1 = aAlfa % Calc2;
            aAlfa = aAlfa % Calc1;
            Calc1 = 0 - (100 + Long);
            aAlfa = (Vacio1 + aAlfa)  % Calc1;
            Calc1 = 100 + LongDec;
            aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
         |FINSI;
         aAlfa = aAlfa + aAlfa1;
      |FINSI;
      |SI nNegativo = 1;
         Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
         aAlfa = aAlfa % Calc1;
         aAlfa = "N" + aAlfa;
      |FINSI;
   |FINSI;

   aAlfa2 = "";

   |SI TipoDato = "A"; |O TipoDato = "An";
      aLong = aAlfa % 0; nLong = aLong;
      |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
         Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
         aAlfa1 = aAlfa1 > aAlfa1;
         |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
         |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
         |SI TipoDato = "An";
            |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
            |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
         |FINSI;
         aAlfa1 = " ";
|ET Sigue1;
         aAlfa2 = aAlfa2 + aAlfa1;
      |SIGUE;
      aAlfa = aAlfa2;
   |FINSI;
   Calc1 = aAlfa;
   |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO TipoContr1;
   |QBF aAlfa;
   |SI aAlfa = ""; aTipoContr = "0"; |ACABA; |FINSI;
   |SI aSeparada = "S";
     aTipoContr = "2";
   |SINO;
     aTipoContr = "0";
      |SI aAlfa = "TITULAR";   aTipoContr = "2"; |FINSI;
      |SI aAlfa = "CONYUGE";
         |SI VTipo = "CONYUGE      ";aTipoContr = "2"; |SINO;aTipoContr = "3"; |FINSI;
      |FINSI;
      |SI aAlfa = "COMUNES";   aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTA";  aTipoContr = "1"; |FINSI;
      |SI aAlfa = "CONJUNTAE"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "GANANCIAL"; aTipoContr = "1"; |FINSI;
      |SI aAlfa = "1 FAMILIAR";aTipoContr = "4"; |FINSI;
      |SI aAlfa = "2 FAMILIAR";aTipoContr = "5"; |FINSI;
      |SI aAlfa = "3 FAMILIAR";aTipoContr = "6"; |FINSI;
      |SI aAlfa = "4 FAMILIAR";aTipoContr = "7"; |FINSI;
      |SI aAlfa = "VARIOS";    aTipoContr = "2"; |FINSI;
   |FINSI;

|FPRC;

|PROCESO GrabaCad1;
   |SI aIP ! "";
      |XGRABA Handle, Cadena; Cadena = "";
   |SINO;
      Cadena = Handle + " " + Cadena; |FGRABA Cadena; Cadena = "";
   |FINSI;
|FPRC;

|PROCESO BuscaCasilla1;
   #rem01002#0 = VEmpresa;
   #rem01002#1 = " ";
   #rem01002#2 = VTipo;
   #rem01002#3 = Bloque;
   #rem01002#4 = Casilla;
   |LEE 010#rem01002.=;
   |SI FSalida = 0;
       |SI #rem01002#4 = "TME";  |O  #rem01002#4 = "TMA";
           Casilla = #rem01002#8;
       |SINO;
           Casilla = #rem01002#6;
       |FINSI;
       SwError = 0;
   |SINO;
       Casilla = 0;
       SwError = 1;
   |FINSI;
|FPRC;

|PROCESO MiraSiDatos1;
   aTipo = VTipo % 0110;
   |SI nSwDatos = 2;
      nSwDatos = 0; Bloque = 1;
      Casilla = " 01"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 02"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 03"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 04"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 05"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 06"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 07"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 2;
      Casilla = " 08"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 09"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 10"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 11"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 12"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 3;
      Casilla = " 13"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Bloque = 4;
      Casilla = " 14"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 15"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 16"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 17"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 3;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 18"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 4;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 19"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 20"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 5;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 21"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 6;
      nSwDatos = 0; Bloque = 5;
      Casilla = " 22"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 23"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 7;
      nSwDatos = 0; Bloque = 6;
      Casilla = " 24"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 25"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 26"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
      Casilla = " 27"; |HAZ BuscaCasilla1; nCalc1 = Casilla; |SI nCalc1 ! 0; nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
   |SI nSwDatos = 8;
      nSwDatos = 0;
      |ABRE #rem01033;
      #rem01033#0 = VEmpresa;
      #rem01033#1 = 0;
      #rem01033#2 = aTipo;
      |LEE 000#rem01033.=;
      |SI FSalida = 0;
         |SI #rem01033#3  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#4  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#5  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#6  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#7  ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#11 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#12 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#13 ! 0; nSwDatos = 1; |FINSI;
         |SI #rem01033#14 ! 0; nSwDatos = 1; |FINSI;
      |FINSI;
      |CIERRA #rem01033;
      |SI nSwDatos = 1; |ACABA; |FINSI;
   |FINSI;
|FPRC;
