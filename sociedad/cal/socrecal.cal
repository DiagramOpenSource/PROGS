|FICHEROS;
   socrecal #0;
   isocie65 #1;
|FIN;

|VARIABLES;
   Cont = 0;
   Suma = 0;
   Comodin = "";
|FIN;

|PROCESO Recalcula;

   Comodin = ("00000" + #isocie65#0) % -105;
   Comodin = "Recalculando empresa " + Comodin;
   |ATRI I;
   |PINTA 1928, Comodin;
   |ATRI N;

   || ACTIVO

   Suma = 0;
   |PARA Cont = 5; |SI Cont [ 13; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#5   = #isocie65#14; |FINSI;

   Suma = 0;
   |PARA Cont = 15; |SI Cont [ 21; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#15   = #isocie65#22; |FINSI;

   Suma = 0;
   |PARA Cont = 23; |SI Cont [ 31; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#23   = #isocie65#32; |FINSI;

   Suma = 0;
   |PARA Cont = 37; |SI Cont [ 43; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#37   = #isocie65#44; |FINSI;

   Suma = 0;
   |PARA Cont = 45; |SI Cont [ 51; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#45   = #isocie65#52; |FINSI;

   Suma = 0;
   |PARA Cont = 53; |SI Cont [ 60; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#53   = #isocie65#61; |FINSI;

   || PASIVO


   Suma = 0;
   |PARA Cont = 66; |SI Cont [ 79; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#66  = #isocie65#80; |FINSI;

   Suma = 0;
   |PARA Cont = 81; |SI Cont [ 84; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#81  = #isocie65#85; |FINSI;

   Suma = 0;
   |PARA Cont = 86; |SI Cont [ 89; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#86  = #isocie65#90; |FINSI;

   Suma = 0;
   |PARA Cont = 91; |SI Cont [ 105; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#91  = #isocie65#106; |FINSI;

   Suma = 0;
   |PARA Cont = 107; |SI Cont [ 125; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#107  = #isocie65#126; |FINSI;
   #isocie65#107 = #isocie65#126;

   || DEBE


   Suma = 0;
   |PARA Cont = 130; |SI Cont [ 132; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#130  = #isocie65#133; |FINSI;

   Suma = 0;
   |PARA Cont = 134; |SI Cont [ 135; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#134  = #isocie65#136; |FINSI;

   Suma = 0;
   |PARA Cont = 138; |SI Cont [ 140; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#138  = #isocie65#141; |FINSI;

   Suma = 0;
   |PARA Cont = 142; |SI Cont [ 145; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#142  = #isocie65#146; |FINSI;

   Suma = 0;
   |PARA Cont = 147; |SI Cont [ 150; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#147  = #isocie65#151; |FINSI;

   || HABER


   Suma = 0;
   |PARA Cont = 163; |SI Cont [ 165; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#163  = #isocie65#166; |FINSI;

   Suma = 0;
   |PARA Cont = 169; |SI Cont [ 171; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#169  = #isocie65#172; |FINSI;

   Suma = 0;
   |PARA Cont = 173; |SI Cont [ 175; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#173  = #isocie65#176; |FINSI;

   Suma = 0;
   |PARA Cont = 177; |SI Cont [ 179; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#177  = #isocie65#180; |FINSI;

   Suma = 0;
   |PARA Cont = 181; |SI Cont [ 184; |HACIENDO Cont = Cont + 1;
      Suma = Suma + #isocie65#Cont#;
   |SIGUE;
   |SI Suma = 0; #isocie65#181  = #isocie65#185; |FINSI;

   |GRABA 020#isocie65.a;
|FPRC;

|DEFBUCLE Recalcula;
#isocie65#1;
;
00001,1998;
99999,1999;
;
NULL,Recalcula;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA "Recalculo de desgloses";
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |ABRE #isocie65;
   |BUCLE Recalcula;
   |CIERRA #isocie65;
|FPRO;
