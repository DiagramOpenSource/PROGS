|FICHEROS;
    plaleese #0;
    plutraba #1;
    sodacuen #2;
|FIN;

|VARIABLES;
    fiche = "";
    handle = "";
    varalfa = "";
    a = 0;
    b = 0;
    trabajo = "";
    trabaj1 = "";
    traba = "";
    empresa = "";
    sw = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    &param = 0;
    &empre = 0;
    &ejerc = 0;
    &enPlan = 0;
|FIN;

|PROGRAMA;
|CLS;
|CABEZA "Importacion 2";
|DDEFECTO #0;
|PINPA #0#0;
|ABRE #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|PROCESO pasa;  |TIPO 3;
|SI #0#0 ! "S";   |ACABA;  |FINSI;
enPlan = 2008;|SI #0#5 < 2008; enPlan = 1990; |FINSI;

|DELINDEX #1;
|ABRE #1;
|ABRE #2;
|HAZ nombre;
|FABRE fiche;
    handle = FSalida;
|SI FSalida < 0;  |VETE agrabar;  |FINSI;
|PARA sw=0;  |SI sw = 0;  |HACIENDO sw = sw;
        varalfa = handle + " 62";
    |FLEE varalfa;
    |SI FSalida = 62;
        |DDEFECTO #1;
            trabajo = varalfa;
            #1#0 = #0#4;                || empresa
            #1#1 = #0#5;                || a¤o
            #1#2 = trabajo % 110;       || cuenta
        |HAZ lee_cuenta;
            #1#3 = #2#1;                || descripcion
            #1#4 = 0;                   || apertura
            traba = trabajo % 3713;
            #1#5 = traba;               || debe
            traba = trabajo % 5013;
            #1#6 = traba;               || haber
            #1#7 = 0;                   || saldo a¤o anterior
        |SI #1#5 ! 0;|O #1#6 ! 0;
            |GRABA 020#1n;
        |FINSI;
        |HAZ pinta;
    |SINO;
            sw = 1;
    |FINSI;
|SIGUE;
    FSalida = handle;
|FCIERRA FSalida;

|ET agrabar;
|CIERRA #1;
|CIERRA #2;
    param = #0#2;
    empre = #0#4;
    ejerc = #0#5;
|SUB_EJECUTA "plugrase.run";
|FPRC;

|CALCULO pinta;
|ATRI I;
|PINTA 2121, #1#2;
|PINTA 2126, #1#3;
|ATRI 0;
|FCAL;

|CALCULO nombre;
    Pos = -1;
    empresa = #0#1;
|QBF empresa;
    empresa = empresa + #0#3;
|QBF empresa;
    fiche = "rb  " + empresa;
|QBF fiche;
|FCAL;

|CALCULO lee_cuenta;
|DDEFECTO #2;
    #2#0 = #1#2;
    #2#2 = enPlan;
|LEE 001#2=;
|FCAL;
