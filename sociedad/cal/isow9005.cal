|FICHEROS;
     isow9005;

     trabajo@;
|FIN;

|VARIABLES;
     nNume        = 0;
     nPer         = 0;
     nPorce       = 0;

     aAlfa        = "";
     aBase        = "";
     aMas         = "";
|FIN;

|PROCESO Tipo12F9005;  |TIPO 12;
|FPRC;

|PROCESO TotalF9005;  |TIPO 0;
     |C_M #isow9005#54, 1, "S";
     |C_M #isow9005#55, 1, "S";

     |SI #isow9005#1 [ 2013;
         |SI #isow9005#1 [ 2012;
             |C_M #isow9005#54, 1, "N";  #isow9005#54 = 0;
             |C_M #isow9005#55, 1, "N";  #isow9005#55 = 0;
         |SINO;
             |SI #isow9005#2 ! "3P";
                 |C_M #isow9005#54, 1, "N";  #isow9005#54 = 0;
                 |C_M #isow9005#55, 1, "N";  #isow9005#55 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     #isow9005#56 = #isow9005#45 + #isow9005#54 + #isow9005#47;
     #isow9005#57 = #isow9005#46 + #isow9005#55 + #isow9005#48;

     #isow9005#50 = #isow9005#15 + #isow9005#56 - #isow9005#57;
     #isow9005#50 = #isow9005#50 + #isow9005#49;

     |SI #isow9005#6 = "2";
         #isow9005#18 = #isow9005#50 - #isow9005#17;
         |SI #isow9005#18 < 0;  #isow9005#18 = 0;  |FINSI;
     |FINSI;

     |SI #isow9005#6 = "3";
         #isow9005#21 = #isow9005#50 - #isow9005#17;
         |SI #isow9005#21 < 0;  #isow9005#21 = 0;  |FINSI;
     |FINSI;

     #isow9005#20 = (#isow9005#18 % #isow9005#19) - #isow9005#58;

     |SI #isow9005#22 > #isow9005#21;
         #isow9005#22 = #isow9005#21;
     |FINSI;

     #isow9005#24 = #isow9005#22 % #isow9005#23;
     #isow9005#25 = #isow9005#21 - #isow9005#22;
     #isow9005#27 = #isow9005#25 % #isow9005#26;
     #isow9005#28 = #isow9005#24 + #isow9005#27 - #isow9005#59;

     #isow9005#51 = #isow9005#20 + #isow9005#28;
     #isow9005#51 = #isow9005#51 - #isow9005#29 - #isow9005#30;
     #isow9005#51 = #isow9005#51 % #isow9005#31;
     #isow9005#51 = #isow9005#51 - #isow9005#32 - #isow9005#33;

     |SI #isow9005#51 < 0;  #isow9005#51 = 0;  |FINSI;

     nPorce = 0;
     |SI #isow9005#38 = "2";  nPorce = 12;  |FINSI;
     |SI #isow9005#38 = "3";  nPorce = 12;  |FINSI;

     |SI #isow9005#44 = "S";
         |SI #isow9005#38 = "2";  |O #isow9005#38 = "3";
             nPorce = 6;
         |FINSI;
     |FINSI;

     #isow9005#52 = (#isow9005#15 % nPorce) - #isow9005#33;
     |SI #isow9005#52 < 0;  #isow9005#52 = 0;  |FINSI;

     #isow9005#34 = #isow9005#51;
     |SI #isow9005#52 > #isow9005#34;  #isow9005#34 = #isow9005#52;  |FINSI;

     |SI #isow9005#14 < 0;  #isow9005#14 = 0;  |FINSI;
     |SI #isow9005#34 < 0;  #isow9005#34 = 0;  |FINSI;

     |PINTA #isow9005#18;
     |PINTA #isow9005#19;
     |PINTA #isow9005#20;
     |PINTA #isow9005#21;
     |PINTA #isow9005#22;
     |PINTA #isow9005#24;
     |PINTA #isow9005#25;
     |PINTA #isow9005#27;
     |PINTA #isow9005#28;
     |PINTA #isow9005#50;
     |PINTA #isow9005#51;
     |PINTA #isow9005#52;
     |PINTA #isow9005#54;
     |PINTA #isow9005#55;
     |PINTA #isow9005#56;
     |PINTA #isow9005#57;
     |PINTA #isow9005#34;
|FPRC;

|PROCESO Tipo0C34F9005;  |TIPO 0;
     |POSICIONATE #isow9005#15;
|FPRC;

|PROCESO trabajo;
    #isow9005#33 = #isow9005#33 + #trabajo@#34;
|FPRC;

|DEFBUCLE trabajo;
     #trabajo@#1004;
     ;
     #isow9005#0, #isow9005#1, aAlfa, 00;
     #isow9005#0, #isow9005#1, aAlfa, 99;
     ;
     NULL, trabajo;
|FIN;

|PROCESO Tipo7C15F9005;  |TIPO 7;
     |SI #isow9005#2 = "1P";  |ACABA;  |FINSI;

     #isow9005#33 = 0;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom9000.mas";
     |CARGA_DEF aMas, trabajo@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa   = #isow9005#2 % 102;
     nPer    = aAlfa;
     nPer    = nPer - 1;

     |PARA nNume = 1; |SI nNume [ nPer; |HACIENDO nNume = nNume + 1;
           aAlfa = nNume + "P";
           |BUCLE trabajo;
     |SIGUE;

     |DESCARGA_DEF #trabajo@;

     |C_M #isow9005#19, 1, "S";
     |C_M #isow9005#22, 1, "S";
     |C_M #isow9005#23, 1, "S";
     |C_M #isow9005#26, 1, "S";
     |C_M #isow9005#58, 1, "S";
     |C_M #isow9005#59, 1, "S";

     |SI #isow9005#6 = "2";
         |C_M #isow9005#22, 1, "N";   #isow9005#22 = 0;
         |C_M #isow9005#23, 1, "N";   #isow9005#23 = 0;
         |C_M #isow9005#26, 1, "N";   #isow9005#26 = 0;
         |C_M #isow9005#59, 1, "N";   #isow9005#59 = 0;
     |FINSI;

     |SI #isow9005#6 = "3";
         |C_M #isow9005#19, 1, "N";   #isow9005#19 = 0;
         |C_M #isow9005#58, 1, "N";   #isow9005#58 = 0;
     |FINSI;

     |PINTA #isow9005#19;
     |PINTA #isow9005#22;
     |PINTA #isow9005#23;
     |PINTA #isow9005#26;
     |PINTA #isow9005#33;
     |PINTA #isow9005#58;
     |PINTA #isow9005#59;
|FPRC;
