|FICHEROS;
     zhazdocu #0;
     zregdocu #1;

     zhazcrea #2,MANTE;
     maempr01 #301;
     megwordc #800;
     megwordl #801;

     cubal801 #1801;

     :/agicli/def/agim0019 #619;

     imagen@ #900;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAbreTxt         = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aIPRemoto        = "";
     aCuenta          = "";
     aAste            = "";
     aLong            = "";
     aCuentaD         = "";
     aCuentaH         = "";
     aHora            = "";
     aPag             = "";
     aPag1            = "";
     aPag2            = "";
     &eaPag1          = "";
     &eaPag2          = "";
     aCarac10         = "";
     aCarac13         = "";
     aQueQuiero       = "";
     &aCNAE           = "";
     aTipoMemoria     = "";
     aTipo            = "";

     nSwPaseAnt       = 0;
     nLong            = 0;
     nSubPanta        = 0;
     nVentana         = 0;
     nNume            = 0;
     nNume1           = 0;
     nNume2           = 0;
     nNume3           = 0;
     nNume4           = 0;
     nRango           = 0;
     nBotonSal        = 0;
     nImporte         = 0;
     nCta40I          = 0;
     nCta41I          = 0;
     nCta407I         = 0;
     nCta4I           = 0;
     nCta40F          = 0;
     nCta41F          = 0;
     nCta407F         = 0;
     nCta4F           = 0;
     nCta4            = 0;
     nCta6            = 0;
     nEjer            = 0;
     nEjerCuadro      = 0;
     nCampo1          = 0;
     nCampo2          = 0;
     nCampo3          = 0;
     nCampo4          = 0;

     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nConta           = 0;
     nTributa         = 0;
     nCasilla         = 0;
     nCuadro          = 0;
     nHay             = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &enPersonaliza   = 0;
     &enTBal          = 0;
     &enEjerCuadro    = 0;
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;

     &EURODB          = 0;
     any              = 0;
     aCondi           = "";
     aSigno           = "";
     aFichero         = "";
     aMas             = "";
     aDef             = "";
     nEstado          = 0;
     nEstado900       = 0;
     nSw              = 0;
|FIN;

|PROCESO ObjetoSocial;
     aAbreTxt = eaDirTrabajo + "objetosocial.txt";

     eaAsigna  = "T}3}1}1}+A";
     eaConten  = "[M]" + aAbreTxt + " [F]Arial [S]10 [A]0 [L]3";
     |HAZ GrabaContenido;

     |XABRE "WBC", aAbreTxt, nHandle;
     eaAlfa = #619#13;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
     |SI eaAlfa ! "";
         |XGRABA nHandle, eaAlfa;
     |FINSI;

     eaAlfa = #619#42;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
     |SI eaAlfa ! "";
         eaAlfa = " " + #619#42;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
         |XGRABA nHandle, eaAlfa;
     |FINSI;

     eaAlfa = #619#43;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
     |SI eaAlfa ! "";
         eaAlfa = " " + #619#43;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
         |XGRABA nHandle, eaAlfa;
     |FINSI;

     eaAlfa = #619#44;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
     |SI eaAlfa ! "";
         eaAlfa = " " + #619#44;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
         |XGRABA nHandle, eaAlfa;
     |FINSI;

     eaAlfa = #619#45;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
     |SI eaAlfa ! "";
         eaAlfa = " " + #619#45;  |QBF eaAlfa;|HAZ QuitaRarosDSXML;
         |XGRABA nHandle, eaAlfa;
     |FINSI;

     |XCIERRA nHandle;
|FPRC;

|PROCESO DesImagen_memor;
    |SI aDef = "";  |ACABA;  |FINSI;

    |CIERRA #900;
    |DESCARGA_DEF #900; aDef = "";
|FPRC;

|PROCESO CarImagen_memor;
     |HAZ DesImagen_memor;

     |DBASE aMas;
     aDef = aMas + "def/" + aFichero;
     |CARGA_DEF aDef, imagen@;
     |SI FSalida ! 0;
         aDef = "";
         |ACABA;
     |FINSI;

     |SI aFichero = "zregcu04";   |ACABA;   |FINSI;

     |ABRE #900;
     #900#0 = #2#0;
     #900#1 = nEjer;
     |LEE 000#900=;
     nEstado900 = FSalida;
|FPRC;

|PROCESO CargaVarDistr;
     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #1nCampo;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 21;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #1nCampo;
           nVar    = nCampo - 20;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |SI #2#1 [ 2008;  |ACABA;  |FINSI;

     aDef     = "";
     aFichero = "zregdocu";
     |HAZ CarImagen_memor;

     |ABRE #900;
     #900#0 = #2#0;
     #900#1 = #2#1 - 1;
     |LEE 040#900=;
     |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;

     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #900nCampo;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 21;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #900nCampo;
           nVar    = nCampo - 20;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |HAZ DesImagen_memor;
|FPRC;

|PROCESO CargaVarDistrCoop;
     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #1nCampo;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 70;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #1nCampo;
           nVar    = nCampo - 69;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     aDef     = "";
     aFichero = "zregdocu";
     |HAZ CarImagen_memor;

     |ABRE #900;
     #900#0 = #2#0;
     #900#1 = #2#1 - 1;
     |LEE 040#900=;
     |SI FSalida ! 0;  |DDEFECTO #900;  |FINSI;

     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #900nCampo;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 70;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #900nCampo;
           nVar    = nCampo - 69;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |HAZ DesImagen_memor;
|FPRC;

|PROCESO CargaVarMemoriaPYME;
     |HAZ CargaVarDistr;
     |HAZ Carga_zregcu01;
     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu02;
     |FINSI;

     |HAZ Carga_zregcu03;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu04;
         |HAZ Carga_zregcu05;
     |FINSI;

     |HAZ Carga_zregcu06;
     |HAZ Carga_zregcu07;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu24;
     |FINSI;

     |HAZ Carga_zregcu08;
     |HAZ Carga_zregcu09;
     |HAZ Carga_zregcu10;
     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu11;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;
     |HAZ Carga_zregcu12;
     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu28;

     |SI #2#1 = 2008;
         |ABRE #1801;
         |SELECT #3#1801;
         #1801#0  = #2#0;
         #1801#1  = #2#1;
         #1801#16 = 30000;
         |LEE 000#1801=;
         |SI FSalida ! 0;  |DDEFECTO #1801;  |FINSI;
         |CIERRA #1801;

         eaConten = "[B]";
         |SI #1801#6 ! 0;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}2}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}2}1}+A"; |HAZ GrabaContenido;
         |SINO;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}1}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}1}1}+A"; |HAZ GrabaContenido;
         |FINSI;

         |ACABA;
     |FINSI;

     |HAZ Carga_zregcu14;

     |SI #2#1 ] 2010;
         |SI #2#1 [ 2014;
             |HAZ Carga_zregcu15;
         |SINO;
             |HAZ Carga_zregcu29;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaVarMemoriaAbrev;
     |HAZ CargaVarDistr;
     |HAZ Carga_zregcu01;
     |HAZ Carga_zregcu16;
     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu17;
         |HAZ Carga_zregcu18;
     |FINSI;
     |HAZ Carga_zregcu03;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu19;
     |FINSI;

     |HAZ Carga_zregcu06;

     |SI #zhazcrea#1 [ 2014;
         |HAZ Carga_zregcu15;
     |SINO;
         |SI #zhazcrea#1 [ 2017;
             |HAZ Carga_zregcu29;
         |FINSI;
     |FINSI;

     |HAZ Carga_zregcu07;
     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu24;
     |FINSI;
     |HAZ Carga_zregcu20;
     |HAZ Carga_zregcu21;
     |HAZ Carga_zregcu22;

     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu23;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;

     |SI #zhazcrea#1 [ 2017;
         |HAZ Carga_zregcu12;
     |FINSI;

     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu14;
     |HAZ Carga_zregcu28;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaVarMemoriaCooper;
     |HAZ CargaVarDistrCoop;
     |HAZ Carga_zregcu01;
     |HAZ Carga_zregcu02;
     |HAZ Carga_zregcu03;
     |HAZ Carga_zregcu04;
     |HAZ Carga_zregcu05;
     |HAZ Carga_zregcu06;
     |HAZ Carga_zregcu26;
     |HAZ Carga_zregcu25;
     |HAZ Carga_zregcu07;
     |HAZ Carga_zregcu24;
     |HAZ Carga_zregcu08;
     |HAZ Carga_zregcu27;
     |HAZ Carga_zregcu09;
     |HAZ Carga_zregcu10;
     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu11;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;
     |HAZ Carga_zregcu12;
     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu28;

     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu17;
         |HAZ Carga_zregcu18;
     |FINSI;
     |SI #2#1 = 2008;
         |ABRE #1801;
         |SELECT #3#1801;
         #1801#0  = #2#0;
         #1801#1  = #2#1;
         #1801#16 = 30000;
         |LEE 000#1801=;
         |SI FSalida ! 0;  |DDEFECTO #1801;  |FINSI;
         |CIERRA #1801;

         eaConten = "[B]";
         |SI #1801#6 ! 0;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}2}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}2}1}+A"; |HAZ GrabaContenido;
         |SINO;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}1}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}1}1}+A"; |HAZ GrabaContenido;
         |FINSI;

         |ACABA;
     |FINSI;

     |HAZ Carga_zregcu14;

     |SI #2#1 [ 2014;
         |HAZ Carga_zregcu15;
     |SINO;
         |HAZ Carga_zregcu29;
     |FINSI;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaVarMemoria;
     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 040#301=;
     |SI FSalida ! 0;  |DDEFECTO #301;  |FINSI;
     |CIERRA #301;

     |SI #301#33 ! "          ";
         eaAlfa = #301#33;
         |HAZ SacaFecha;
         #1#40 = eaAlfa;
     |SINO;
         nNume  = #2#1 + 1;
         #1#40  = "30 de Marzo de " + nNume;
     |FINSI;

     eaAsigna   = "P" + #2#7;
     eaConten   = eaDirTrabajo + "paginas.txt";
     |HAZ GrabaContenido;

     nNume  = #2#1 - 1;

     eaAsigna = "V#ante#";
     eaConten = nNume;
     |HAZ GrabaContenido;

     eaAsigna = "V#actu#";
     eaConten = #2#1;
     |HAZ GrabaContenido;

     eaAsigna = "C#ejercicio#";
     |HAZ GrabaContenido;

     eaAlfa   = #1#40;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha formulacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #2#12;       |HAZ QuitaRarosDSXML;
     eaAsigna = "V#pgc#";
     eaConten = eaAlfa;;
     |HAZ GrabaContenido;

     eaAlfa   = #2#2;       |HAZ QuitaRarosDSXML;
     eaAsigna = "C#empresa#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa  = #301#3;                               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#CIF#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #301#13;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#poblacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #301#14;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#provincia#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #301#4;                              |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #301#5;               |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", n. " + #301#6;           |HAZ QuitaRarosDSXML;
     eaAsigna = "V#domicilio social#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |ABRE #619;
     #619#0 = #2#0;
     #619#1 = 99;
     |LEE 040#619];
     |SI FSalida = 0;
         |LEE 040#619a;
     |SINO;
         |LEE 040#619u;
     |FINSI;
     |SI FSalida ! 0;  |O #619#0 ! #2#0;
         |DDEFECTO #619;
     |FINSI;
     |CIERRA #619;

     aCNAE  = #619#40;     |HAZ LeeCNAE;
     |SI aCNAE = "";
         aCNAE  = #619#2;  |QBF aCNAE;
     |FINSI;

     eaAlfa = #619#40 + " - " + aCNAE;    |QBF eaAlfa;
     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#actividad 1#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = "";
     eaAsigna = "V#actividad 2#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "V#cnae 2#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#5;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tipo sociedad#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#25;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#registro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#28;
     eaAsigna = "V#fecha inscripcion#";
     eaConten = #619#28;
     |HAZ GrabaContenido;

     eaAlfa   = #619#29;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tomo#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#30;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#libro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#31;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#seccion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#32;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#folio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#33;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#hoja#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#34;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#34;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#28;
     eaAsigna = "V#fecha inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = "";
     eaAsigna = "V#aportacion minima coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |HAZ ObjetoSocial;

     nNume1 = #619#14;
     nNume2 = #619#16;
     nNume3 = #619#20;
     nNume4 = #619#24;

     |SI EURODB = 0;  |Y #619#51 = "E";
         nNume1  = (#619#14 * 166.386) ! EURODB;
         nNume2  = (#619#16 * 166.386) ! EURODB;
         nNume3  = (#619#20 * 166.386) ! EURODB;
         nNume4  = (#619#24 * 166.386) ! EURODB;
     |FINSI;

     |SI EURODB ! 0;  |Y #619#51 = "P";
         nNume1  = (#619#14 / 166.386) ! EURODB;
         nNume2  = (#619#16 / 166.386) ! EURODB;
         nNume3  = (#619#20 / 166.386) ! EURODB;
         nNume4  = (#619#24 / 166.386) ! EURODB;
     |FINSI;

     eaAsigna = "V#capital social#";
     eaConten = nNume1 + " euros";
     |HAZ GrabaContenido;

     aAlfa1 = "";
     aAlfa2 = "";
     |SI #619#15 ! 0;
         aAlfa1 = #619#15 + " acciones nominativas";
         aAlfa2 = nNume2;
     |FINSI;

     |SI #619#19 ! 0;
         |SI aAlfa1 = "";
             aAlfa1 = #619#19 + " acciones al portador";
             aAlfa2 = nNume3;
         |SINO;
             |SI #619#23 ! 0;
                 aAlfa1 = aAlfa1 + ", " + #619#19 + " acciones al portador";
                 aAlfa2 = aAlfa2 + ", " + nNume3;
             |SINO;
                 aAlfa1 = aAlfa1 + " y " + #619#19 + " acciones al portador";
                 aAlfa2 = aAlfa2 + " y " + nNume3;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #619#23 ! 0;
         |SI aAlfa1 = "";
             aAlfa1 = #619#23 + " participaciones socios";
             aAlfa2 = nNume4;
         |SINO;
             aAlfa1 = aAlfa1 + " y " + #619#23 + " participaciones socios";
             aAlfa2 = aAlfa2 + " y " + nNume4;
         |FINSI;
     |FINSI;

     eaAsigna = "V#literalacciones#";
     eaConten = aAlfa1;
     |HAZ GrabaContenido;

     eaAsigna = "V#nominal#";
     eaConten = aAlfa2 + " euros";
     |HAZ GrabaContenido;

     |SI #2#15 = "P";  |HAZ CargaVarMemoriaPYME;   |FINSI;
     |SI #2#15 = "A";  |HAZ CargaVarMemoriaAbrev;  |FINSI;
     |SI #2#15 = "C";  |HAZ CargaVarMemoriaCooper; |FINSI;
|FPRC;

|PROCESO CreaMemoria;
     |SI #1#4 = "S";
         |CONFI "0000NLa memoria ya est  creada, desea crearla de nuevo";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |PINTA #2#7;
     |HAZ VentanaTrabajo;

     |SI #0#0 = 2008;  eaPlanillaTra  = "memor001.doc";  |FINSI;
     |SI #0#0 = 2009;  eaPlanillaTra  = "memo2009.doc";  |FINSI;
     |SI #0#0 ] 2010;
          |SI #2#15 = "P";
              nEjer = #0#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              eaPlanillaTra  = "mem" + nEjer + "p.doc";
          |FINSI;

          |SI #2#15 = "A";
              nEjer = #0#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              eaPlanillaTra  = "mem" + nEjer + "a.doc";
          |FINSI;

          |SI #2#15 = "C";
              nEjer = #0#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              eaPlanillaTra  = "mem" + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     |DBASE aBase;
     aAlfa = aBase + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + eaPlanillaTra;
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/";
     |FINSI;

     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "";

     eaOrigen       = eaDirSerDoc  + eaPlanillaTra;
     eaDestino      = eaDirTrabajo + eaFicheroPla;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroPla;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;

         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroPla + "#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |HAZ CargaVarMemoria;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     aAlfa = eaDirTrabServi + eaFicheroTxt;
     |FBORRA aAlfa;

     |HAZ AbreWordExterno;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + "wmemori.doc";
     |HAZ RecibeFichero;

     |RFBORRA aAbre;

     aAbre = eaDirGuarda + "wmemori.doc";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aCarac10 = &10;
     aCarac13 = &13;
     aPag     = "";
     aPag1    = "";
     aPag2    = "";

     aAbre = eaDirTrabajo + "paginas.txt";
     |XABRE "ABC", aAbre, nHandle;
     |PARA;  |SI  FSalida ] 0;  |HACIENDO;
          |XLEE nHandle, 1, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          |SI aAlfa = aCarac10;  |O aAlfa = aCarac13;
              |SI aPag ! "";
                  |SI aPag1 = "";
                      aPag1 = aPag;
                  |SINO;
                      aPag2 = aPag;
                  |FINSI;
              |FINSI;
              aPag = "";
          |SINO;
              aPag = aPag + aAlfa;
         |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     |RFBORRA aAbre;

     aAlfa = eaDirTrabajo + "objetosocial.txt";
     |RFBORRA aAlfa;

     #1#4  = "S";
     #1#5  = aPag1;
     #1#6  = aPag2;
     #1#7  = #2#6;

     |SI #1#8 = "N";
         #1#9 = #1#6 + 1;
         #2#8 = #1#9;
     |FINSI;
     |SI #1#8 = "S";
         nNume = #1#6 + 1;
         |SI nNume ! #1#9;
             |CONFI "0000NEl n£mero de P ginas de la Memoria ha cambiado. Desea Renumerar el Informe de Gestion";
             |SI FSalida = 0;
                 |HAZ RenumerarGestion;
             |FINSI;
         |FINSI;
     |FINSI;

     |ABRE #800;
     #800#0 = #1#0;
     #800#1 = #1#1;
     |LEE 101#800=;
     |SI FSalida ! 0;
         |DDEFECTO #800;
         #800#0 = #1#0;
         #800#1 = #1#1;
         |GRABA 020#800b;
     |FINSI;

     #800#2 = #1#2;
     #800#3 = #1#5;
     #800#4 = #1#6;
     #800#5 = #1#9;
     #800#6 = #1#10;

     |GRABA 020#800a;
     |LIBERA #800;
     |CIERRA #800;

     |ABRE #801;
     #801#0 = #1#0;
     #801#1 = #1#1;
     #801#2 = "wmemori.doc";
     |LEE 101#801=;
     |SI FSalida ! 0;
         |DDEFECTO #801;
         #801#0 = #1#0;
         #801#1 = #1#1;
         #801#2 = "wmemori.doc";
         |GRABA 020#801b;
     |FINSI;

     #801#3 = "MEMORIA";
     #801#4 = ~;
     |HORA aHora;
     #801#5 = aHora % 102;
     #801#6 = aHora % 402;

     |GRABA 020#801a;
     |LIBERA #801;
     |CIERRA #801;

     |HAZ FinVentanaTrabajo;

     |MENAV "0000La memoria ha sido creada.";

     |PINTA #2#8;

     |SI #1#11 = "S";
         nNume = #1#39;
         |SI #1#6  ! 0;  nNume = #1#6;   |FINSI;
         |SI #1#10 ! 0;  nNume = #1#10;  |FINSI;
         |SI nNume ! #1#39;
             |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO VisualizaMemoria;
     |PINTA #2#7;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaPag1 = ""; |SI #2#7 ! #1#5;  eaPag1 = #2#7; |FINSI;
     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     eaPag1 = #2#7;
     |HAZ QuentaPagDocumento;

     #1#5  = eaPag1;
     #1#6  = eaPag2;
     |SI #1#8 = "N";
         #1#9 = #1#6 + 1;
         #2#8 = #1#9;
         |PINTA #2#8;
     |FINSI;
     |SI #1#8 = "S";
         nNume = #1#6 + 1;
         |SI nNume ! #1#9;
             |CONFI "0000NEl n£mero de P ginas de la Memoria ha cambiado. Desea Renumerar el Informe de Gestion";
             |SI FSalida = 0;
                 |HAZ RenumerarGestion;
             |FINSI;
         |FINSI;
     |FINSI;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |RFBORRA aAbre;

     eaPag1 = "";
     eaPag2 = "";

     |HAZ FinVentanaTrabajo;

     |SI #1#11 = "S";
         nNume = #1#39;
         |SI #1#6  ! 0;  nNume = #1#6;   |FINSI;
         |SI #1#10 ! 0;  nNume = #1#10;  |FINSI;
         |SI nNume ! #1#39;
             |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO MemoriaPDF;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "I#2#dspdf#2";

     |HAZ InstalaDSPDF;

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + "#" + eaDirTrabajo + "MEMORIA.DOC" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |XCIERRA enHandleTxt;

     eaOrigen       = eaDirTrabServi + eaFicheroTxt;
     eaDestino      = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |HAZ FinVentanaTrabajo;

     aAlfa = eaDirTrabajo + eaFicheroTra;   |RFBORRA aAlfa;
     aAlfa = eaDirTrabajo + "MEMORIA.DOC";  |RFBORRA aAlfa;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronPYME;
     |SI #zhazdocu#0 > enUltMemP;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     |SI #0#0 = 2008;
         eaFicheroTxt   = "memor001.txt";
         eaFicheroTra   = "memor001.doc";
     |FINSI;

     |SI #0#0 = 2009;
         eaFicheroTxt   = "memo2009.txt";
         eaFicheroTra   = "memo2009.doc";
     |FINSI;

     |SI #0#0 ] 2010;
         nEjer = #0#0;
         |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

         eaFicheroTxt   = "mem" + nEjer + "p.txt";
         eaFicheroTra   = "mem" + nEjer + "p.doc";
     |FINSI;

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronAbreviada;
     |SI #zhazdocu#0 > enUltMemA;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     nEjer = #0#0;
     |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

     eaFicheroTxt   = "mem" + nEjer + "a.txt";
     eaFicheroTra   = "mem" + nEjer + "a.doc";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronCooperativa;
     |SI #zhazdocu#0 > enUltMemC;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     nEjer = #0#0;
     |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

     eaFicheroTxt   = "mem" + nEjer + "c.txt";
     eaFicheroTra   = "mem" + nEjer + "c.doc";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO PersonalizaMemoria;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/memoria/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     |SI #2#15 = "P";
         |SI #0#0 = 2008;
             eaFicheroTxt   = "memor001.txt";
             eaFicheroTra   = "memor001.doc";
         |FINSI;

         |SI #0#0 = 2009;
             eaFicheroTxt   = "memo2009.txt";
             eaFicheroTra   = "memo2009.doc";
         |FINSI;

         |SI #0#0 ] 2010;
             nEjer = #0#0;
             |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

             eaFicheroTxt   = "mem" + nEjer + "p.txt";
             eaFicheroTra   = "mem" + nEjer + "p.doc";
         |FINSI;
     |FINSI;

     |SI #2#15 = "A";
         nEjer = #0#0;
         |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

         eaFicheroTxt   = "mem" + nEjer + "a.txt";
         eaFicheroTra   = "mem" + nEjer + "a.doc";
     |FINSI;

     |SI #2#15 = "C";
         nEjer = #0#0;
         |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

         eaFicheroTxt   = "mem" + nEjer + "c.txt";
         eaFicheroTra   = "mem" + nEjer + "c.doc";
     |FINSI;

     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "word/memoria/";
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAlfa     = aBase  + "word/memoria/" + (("00000" + #2#0) % -105);
     |MKDIR aAlfa;

     eaDirGuarda = aBase  + "word/memoria/" + (("00000" + #2#0) % -105) + "/";
     eaOrigen    = aAbre;
     eaDestino   = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO RenumerarGestion;
     #2#8 = #1#6 + 1; |PINTA #2#8;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wgestio.txt";
     eaFicheroTra   = "wgestio.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaPag1 = #2#8;
     |HAZ QuentaPagDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     aAbre = eaDirTrabajo + eaFicheroTra;

     #1#9  = eaPag1;
     #1#10 = eaPag2;

     |RFBORRA aAbre;

     |HAZ FinVentanaTrabajo;

     eaPag1 = "";
     eaPag2 = "";

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Cuadros;  |TIPO 12;
|FPRC;
