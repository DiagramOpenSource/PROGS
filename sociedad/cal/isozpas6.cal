|FICHEROS;
     ism00002;
     isocie59;
     isocie62;
     isocie85;
     isocie70;
     isocie75;

     isom0001;
     isom0009;
     isom0010;
     isom0011;
     isom0012;
     isom0022;
     isom0023;
     isom0026;
     isom0027;
     isom0028;
     isom0029;
     isom0030;
     isom0031;
     isom0032;
     isom0033;

     isom0507;
     isom0508;
     isom0509;
     isom0511;
     isom0515;
     isom0516;
     isom0517;
     isom0518;
     isom0519;
     isom0520;

     maempr11;

     anyoant@;
|FIN;

|VARIABLES;
     &enEmpresa  = 0;
     &enAnyo     = 0;
     &enCooperativa = 0;

     nLinea      = 0;
     nTotalDec   = 0;
     nAnyoDed    = 0;
     nTipoDec    = 0;
     nAnyoAnt    = 0;
     nAplicar    = 0;
     nCasilla    = 0;
     nDesde      = 0;
     nHasta      = 0;
     nNume       = 0;
     nPendiente  = 0;
     nClave      = 0;
     nCampo      = 0;
     nAnyo       = 0;
     nDiv        = 0;
     nPorce      = 0;
     nDLin       = 0;
     nHLin       = 0;

     aDescri     = "";
     aAnyo       = "";
     aCasilla    = "";
     aBase       = "";
     aMas        = "";
     aAlfa       = "";
     aCas        = "";
|FIN;

|PROCESO isocie70B;
     |BORRA 020#isocie70.a;
     |LIBERA #isocie70;
|FPRC;

|DEFBUCLE isocie70B;
     #isocie70#1;
     ;
     enEmpresa, enAnyo, 00;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isocie70B;
|FIN;

|PROCESO isom0011B;
     #isom0011#5  = 0;
     #isom0011#9  = 0;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011B;
     #isom0011#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0011B;
|FIN;

|PROCESO isocie70;
     aCas = #isocie70#7;
     |SI #isocie70#7 [ 999;
         aCas = ("000" + #isocie70#7) % -103;
     |FINSI;

     #isom0011#0 = enEmpresa;
     #isom0011#1 = enAnyo;
     #isom0011#4 = aCas;
     |LEE 101#isom0011.=;
     |SI FSalida = 0;
         #isom0011#5 = #isom0011#5 + #isocie70#11;

         |GRABA 020#isom0011.a;
         |LIBERA #isom0011;
     |FINSI;
|FPRC;

|DEFBUCLE isocie70;
     #isocie70#1;
     ;
     enEmpresa, enAnyo, 00;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isocie70;
|FIN;

|PROCESO isom0011R;
     |SI #isom0011#5 = 0;  |Y #isom0011#7 = 0;  |Y #isom0011#9 = 0;
         |BORRA 020#isom0011.a;
         |LIBERA #isom0011;
         |ACABA;
     |FINSI;

     |SI #isom0011#7 > #isom0011#5;
         #isom0011#7 = #isom0011#5;
     |FINSI;

     #isom0011#9 = 0;
     |SI #isom0011#8 ! "     ";
         #isom0011#9 = #isom0011#5 - #isom0011#7;
     |FINSI;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011R;
     #isom0011#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0011R;
|FIN;

|PROCESO CogeNuevaDed;
     #isocie70#0 = enEmpresa;
     #isocie70#1 = enAnyo;
     #isocie70#2 = 99;
     |LEE 040#isocie70.];
     |SI FSalida = 0;
         |LEE 040#isocie70.a;
     |SINO;
         |LEE 040#isocie70.u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y #isocie70#0 = enEmpresa;  |Y #isocie70#1 = enAnyo;
         nLinea = #isocie70#2 + 1;
     |FINSI;
|FPRC;

|PROCESO isocie70Ded;
     aDescri = #isocie70#12;

     |SI nTotalDec = 0; |ACABA; |FINSI;

     |SI #isocie70#11 [ nTotalDec;
         nAplicar  = #isocie70#11;
         nTotalDec = nTotalDec - #isocie70#11;
     |SINO;
         nAplicar  = nTotalDec;
         nTotalDec = 0;
     |FINSI;

     #ism00002#7 = nAnyoAnt;
     #ism00002#0 = #isocie70#3;
     #ism00002#1 = #isocie70#5;
     |LEE 040#ism00002.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #ism00002#8 = 0;  |Y #ism00002#9 = 0;
         |ACABA;
     |FINSI;

     #ism00002#7 = enAnyo;
     #ism00002#0 = #ism00002#8;
     #ism00002#1 = #ism00002#9;
     |LEE 040#ism00002.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SALVA_DATOS #isocie70;

     |HAZ CogeNuevaDed;

     |DDEFECTO #isocie70;
     #isocie70#0  = enEmpresa;
     #isocie70#1  = enAnyo;
     #isocie70#2  = nLinea;
     #isocie70#3  = #ism00002#0;
     #isocie70#4  = #ism00002#2;
     #isocie70#5  = #ism00002#1;
     #isocie70#6  = #ism00002#3;
     #isocie70#7  = #ism00002#4;
     #isocie70#8  = #ism00002#5;
     #isocie70#9  = #ism00002#6;
     |SI #isocie70#9 ! 0;
         #isocie70#10 = (nAplicar * 100) / #isocie70#9;
     |SINO;
         #isocie70#10 = nAplicar;
     |FINSI;
     #isocie70#11 = nAplicar;
     #isocie70#12 = aDescri;
     |GRABA 020#isocie70.n;
     |LIBERA #isocie70;

     |REPON_DATOS #isocie70;
     |LEE 000#isocie70.=;
|FPRC;

|DEFBUCLE isocie70Ded;
     #isocie70#1;
     7;
     enEmpresa, nAnyoAnt, 001, nCasilla;
     enEmpresa, nAnyoAnt, 999, nCasilla;
     ;
     NULL, isocie70Ded;
|FIN;

|PROCESO isom0508;
     #isom0011#0  = enEmpresa;
     #isom0011#1  = #isom0508#0;
     #isom0011#2  = #isom0508#1;
     |LEE 101#isom0011.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0011;
         #isom0011#0  = enEmpresa;
         #isom0011#1  = #isom0508#0;
         #isom0011#2  = #isom0508#1;
         |GRABA 020#isom0011.b;
     |FINSI;

     #isom0011#3  = #isom0508#5;
     #isom0011#4  = #isom0508#2;
     #isom0011#6  = #isom0508#3;
     #isom0011#8  = #isom0508#4;
     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0508;
     #isom0508#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0508;
|FIN;

|PROCESO Deduc2008;
     nAnyoAnt = enAnyo - 1

     |ABRE #isocie85;
     #isocie85#0 = enEmpresa;
     #isocie85#1 = nAnyoAnt;
     |LEE 040#isocie85.=;
     |SI FSalida ! 0; |CIERRA #isocie85; |ACABA; |FINSI;
     |CIERRA #isocie85;

     |BUCLE isocie70B;

     |ABRE #ism00002;

     |SI #isocie85#2   ! 0; nTotalDec = #isocie85#4;   nCasilla = 835; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#5   ! 0; nTotalDec = #isocie85#7;   nCasilla = 838; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#8   ! 0; nTotalDec = #isocie85#10;  nCasilla = 932; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#11  ! 0; nTotalDec = #isocie85#13;  nCasilla = 297; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#14  ! 0; nTotalDec = #isocie85#16;  nCasilla = 090; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#17  ! 0; nTotalDec = #isocie85#19;  nCasilla = 004; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#20  ! 0; nTotalDec = #isocie85#22;  nCasilla = 031; |BUCLE isocie70Ded; |FINSI;

     |SI #isocie85#029 ! 0; nTotalDec = #isocie85#031; nCasilla = 752; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#032 ! 0; nTotalDec = #isocie85#034; nCasilla = 755; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#035 ! 0; nTotalDec = #isocie85#037; nCasilla = 758; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#038 ! 0; nTotalDec = #isocie85#040; nCasilla = 761; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#041 ! 0; nTotalDec = #isocie85#043; nCasilla = 744; |BUCLE isocie70Ded; |FINSI;

     |SI #isocie85#047 ! 0; nTotalDec = #isocie85#049; nCasilla = 842; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#050 ! 0; nTotalDec = #isocie85#052; nCasilla = 768; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#053 ! 0; nTotalDec = #isocie85#055; nCasilla = 771; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#056 ! 0; nTotalDec = #isocie85#058; nCasilla = 774; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#059 ! 0; nTotalDec = #isocie85#061; nCasilla = 777; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#062 ! 0; nTotalDec = #isocie85#064; nCasilla = 780; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#065 ! 0; nTotalDec = #isocie85#067; nCasilla = 783; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#068 ! 0; nTotalDec = #isocie85#070; nCasilla = 786; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#071 ! 0; nTotalDec = #isocie85#073; nCasilla = 789; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#074 ! 0; nTotalDec = #isocie85#076; nCasilla = 766; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#077 ! 0; nTotalDec = #isocie85#079; nCasilla = 888; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#080 ! 0; nTotalDec = #isocie85#082; nCasilla = 198; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#083 ! 0; nTotalDec = #isocie85#085; nCasilla = 898; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#086 ! 0; nTotalDec = #isocie85#088; nCasilla = 288; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#089 ! 0; nTotalDec = #isocie85#091; nCasilla = 291; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#092 ! 0; nTotalDec = #isocie85#094; nCasilla = 466; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#095 ! 0; nTotalDec = #isocie85#097; nCasilla = 469; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#098 ! 0; nTotalDec = #isocie85#100; nCasilla = 061; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#101 ! 0; nTotalDec = #isocie85#103; nCasilla = 591; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#104 ! 0; nTotalDec = #isocie85#106; nCasilla = 472; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#107 ! 0; nTotalDec = #isocie85#109; nCasilla = 479; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#110 ! 0; nTotalDec = #isocie85#112; nCasilla = 792; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#113 ! 0; nTotalDec = #isocie85#115; nCasilla = 795; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#116 ! 0; nTotalDec = #isocie85#118; nCasilla = 798; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#119 ! 0; nTotalDec = #isocie85#121; nCasilla = 801; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#122 ! 0; nTotalDec = #isocie85#124; nCasilla = 804; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#125 ! 0; nTotalDec = #isocie85#127; nCasilla = 807; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#128 ! 0; nTotalDec = #isocie85#130; nCasilla = 810; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#131 ! 0; nTotalDec = #isocie85#133; nCasilla = 813; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#134 ! 0; nTotalDec = #isocie85#136; nCasilla = 816; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#137 ! 0; nTotalDec = #isocie85#139; nCasilla = 819; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#140 ! 0; nTotalDec = #isocie85#142; nCasilla = 891; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#143 ! 0; nTotalDec = #isocie85#145; nCasilla = 822; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#146 ! 0; nTotalDec = #isocie85#148; nCasilla = 996; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#149 ! 0; nTotalDec = #isocie85#151; nCasilla = 063; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#152 ! 0; nTotalDec = #isocie85#154; nCasilla = 633; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#155 ! 0; nTotalDec = #isocie85#157; nCasilla = 069; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#158 ! 0; nTotalDec = #isocie85#160; nCasilla = 589; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#161 ! 0; nTotalDec = #isocie85#163; nCasilla = 993; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#164 ! 0; nTotalDec = #isocie85#166; nCasilla = 040; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#167 ! 0; nTotalDec = #isocie85#169; nCasilla = 828; |BUCLE isocie70Ded; |FINSI;

     |SI #isocie85#173 ! 0; nTotalDec = #isocie85#175; nCasilla = 929; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#176 ! 0; nTotalDec = #isocie85#178; nCasilla = 942; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#179 ! 0; nTotalDec = #isocie85#181; nCasilla = 294; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#182 ! 0; nTotalDec = #isocie85#184; nCasilla = 066; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#185 ! 0; nTotalDec = #isocie85#187; nCasilla = 008; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#188 ! 0; nTotalDec = #isocie85#190; nCasilla = 034; |BUCLE isocie70Ded; |FINSI;

     |SI #isocie85#198 ! 0; nTotalDec = #isocie85#200; nCasilla = 857; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#201 ! 0; nTotalDec = #isocie85#203; nCasilla = 860; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#204 ! 0; nTotalDec = #isocie85#206; nCasilla = 863; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#207 ! 0; nTotalDec = #isocie85#209; nCasilla = 883; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#210 ! 0; nTotalDec = #isocie85#212; nCasilla = 194; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#213 ! 0; nTotalDec = #isocie85#215; nCasilla = 868; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#216 ! 0; nTotalDec = #isocie85#218; nCasilla = 871; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#219 ! 0; nTotalDec = #isocie85#221; nCasilla = 874; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#222 ! 0; nTotalDec = #isocie85#224; nCasilla = 877; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#225 ! 0; nTotalDec = #isocie85#227; nCasilla = 880; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#228 ! 0; nTotalDec = #isocie85#230; nCasilla = 866; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#231 ! 0; nTotalDec = #isocie85#233; nCasilla = 939; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#234 ! 0; nTotalDec = #isocie85#236; nCasilla = 191; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#237 ! 0; nTotalDec = #isocie85#239; nCasilla = 613; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#240 ! 0; nTotalDec = #isocie85#242; nCasilla = 200; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#243 ! 0; nTotalDec = #isocie85#245; nCasilla = 037; |BUCLE isocie70Ded; |FINSI;
     |SI #isocie85#246 ! 0; nTotalDec = #isocie85#248; nCasilla = 852; |BUCLE isocie70Ded; |FINSI;

     |CIERRA #ism00002;

     |BUCLE isom0011B;

     |ABRE #isom0011;
     |SELECT #1#isom0011;
     |BUCLE isom0508;

     |SELECT #2#isom0011;
     |BUCLE isocie70;
     |SELECT #1#isom0011;
     |CIERRA #isom0011;

     |ABRET #isom0011;
     |HAZ TotalFich111;
     |CIERRAT #isom0011;

     |BUCLE isom0011R;

     |ABRET #isom0011;
     |HAZ TotalFich111;
     |CIERRAT #isom0011;
|FPRC;

|PROCESO isom0011A;
     |SI #isom0011#9 = 0;   |ACABA;  |FINSI;

     nTotalDec = #isom0011#9;
     nCasilla  = #isom0011#4;
     |BUCLE isocie70Ded;
|FPRC;

|DEFBUCLE isom0011A;
     #isom0011#1;
     ;
     enEmpresa, nAnyoAnt, 0000;
     enEmpresa, nAnyoAnt, 9999;
     ;
     NULL, isom0011A;
|FIN;

|PROCESO isom0511;
     #isom0023#0  = enEmpresa;
     #isom0023#1  = #isom0511#0;
     #isom0023#2  = #isom0511#1;
     |LEE 101#isom0023.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0023;
         #isom0023#0  = enEmpresa;
         #isom0023#1  = #isom0511#0;
         #isom0023#2  = #isom0511#1;
         |GRABA 020#isom0023.b;
     |FINSI;

     #isom0023#3  = #isom0511#5;
     #isom0023#4  = #isom0511#2;
     #isom0023#6  = #isom0511#3;
     #isom0023#8  = #isom0511#4;

     |GRABA 020#isom0023.a;
     |LIBERA #isom0023;
|FPRC;

|DEFBUCLE isom0511;
     #isom0511#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0511;
|FIN;

|PROCESO isom0515;
     #isom0029#0  = enEmpresa;
     #isom0029#1  = #isom0515#0;
     #isom0029#2  = #isom0515#1;
     |LEE 101#isom0029.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0029;
         #isom0029#0  = enEmpresa;
         #isom0029#1  = #isom0515#0;
         #isom0029#2  = #isom0515#1;
         |GRABA 020#isom0029.b;
     |FINSI;

     #isom0029#3  = #isom0515#8;
     #isom0029#4  = #isom0515#2;
     #isom0029#6  = #isom0515#3;
     #isom0029#8  = #isom0515#4;
     #isom0029#10 = #isom0515#5;
     #isom0029#12 = #isom0515#6;
     #isom0029#14 = #isom0515#7;

     |GRABA 020#isom0029.a;
     |LIBERA #isom0029;
|FPRC;

|DEFBUCLE isom0515;
     #isom0515#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0515;
|FIN;

|PROCESO isom0023_2015;
     aAlfa =  #anyoant@#4;

     |SI #anyoant@#4 = "267  ";  |ACABA;  |FINSI;
     |SI #anyoant@#4 = "538  ";  |ACABA;  |FINSI;

     aCasilla = "";

     |SI #anyoant@#4 = "890  ";  aCasilla = "890";  |FINSI;
     |SI #anyoant@#4 = "503  ";  aCasilla = "503";  |FINSI;
     |SI #anyoant@#4 = "273  ";  aCasilla = "273";  |FINSI;
     |SI #anyoant@#4 = "955  ";  aCasilla = "273";  |FINSI;

     |SI aCasilla ! "";
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#4 = aCasilla;
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5 = #anyoant@#9;
             #isom0023#7 = 0;
             #isom0023#9 = #anyoant@#9;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #anyoant@#4 = "212  ";  aCasilla = "1191";  |FINSI;
     |SI #anyoant@#4 = "969  ";  aCasilla = "1196";  |FINSI;
     |SI #anyoant@#4 = "261  ";  aCasilla = "1201";  |FINSI;
     |SI #anyoant@#4 = "264  ";  aCasilla = "1201";  |FINSI;

     |SI aCasilla ! "";
         #isom0029#0  = enEmpresa;
         #isom0029#1  = enAnyo;
         #isom0029#14 = aCasilla;
         |LEE 101#isom0029.=;
         |SI FSalida = 0;
             #isom0029#7  = #anyoant@#9;
             #isom0029#11 = 0;
             #isom0029#15 = #anyoant@#9;
             |GRABA 020#isom0029.a;
             |LIBERA #isom0029;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0023_2016;
     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#4 = "890  ";  aCasilla = "890";  |FINSI;
     |SI #anyoant@#4 = "503  ";  aCasilla = "503";  |FINSI;
     |SI #anyoant@#4 = "273  ";  aCasilla = "273";  |FINSI;
     |SI #anyoant@#4 = "955  ";  aCasilla = "955";  |FINSI;
     |SI #anyoant@#4 = "1217 ";  aCasilla = "955";  |FINSI;

     |SI aCasilla ! "";
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#4 = aCasilla;
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5 = #anyoant@#9;
             #isom0023#7 = 0;
             #isom0023#9 = #anyoant@#9;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;

         |ACABA;
     |FINSI;
|FPRC;

|PROCESO isom0023_2017;
     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#4 = "890  ";  aCasilla = "890";  |FINSI;
     |SI #anyoant@#4 = "503  ";  aCasilla = "503";  |FINSI;
     |SI #anyoant@#4 = "273  ";  aCasilla = "273";  |FINSI;
     |SI #anyoant@#4 = "955  ";  aCasilla = "955";  |FINSI;
     |SI #anyoant@#4 = "1217 ";  aCasilla = "1217"; |FINSI;
     |SI #anyoant@#4 = "1467 ";  aCasilla = "1217";  |FINSI;

     |SI aCasilla ! "";
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#4 = aCasilla;
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5 = #anyoant@#9;
             #isom0023#7 = 0;
             #isom0023#9 = #anyoant@#9;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0023_2018;
     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#4 = "503  ";  aCasilla = "503";  |FINSI;
     |SI #anyoant@#4 = "273  ";  aCasilla = "273";  |FINSI;
     |SI #anyoant@#4 = "955  ";  aCasilla = "955";  |FINSI;
     |SI #anyoant@#4 = "1217 ";  aCasilla = "1217"; |FINSI;
     |SI #anyoant@#4 = "1467 ";  aCasilla = "1467"; |FINSI;
     |SI #anyoant@#4 = "1741 ";  aCasilla = "1467"; |FINSI;

     |SI aCasilla ! "";
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#4 = aCasilla;
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5 = #anyoant@#9;
             #isom0023#7 = 0;
             #isom0023#9 = #anyoant@#9;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0023_2019;
     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#4 = "273  ";  aCasilla = "273";  |FINSI;
     |SI #anyoant@#4 = "955  ";  aCasilla = "955";  |FINSI;
     |SI #anyoant@#4 = "1217 ";  aCasilla = "1217"; |FINSI;
     |SI #anyoant@#4 = "1467 ";  aCasilla = "1467"; |FINSI;
     |SI #anyoant@#4 = "1741 ";  aCasilla = "1741"; |FINSI;
     |SI #anyoant@#4 = "1982 ";  aCasilla = "1741"; |FINSI;

     |SI aCasilla ! "";
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#4 = aCasilla;
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5 = #anyoant@#9;
             #isom0023#7 = 0;
             #isom0023#9 = #anyoant@#9;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0023;
     |SI #anyoant@#9 = 0;  |ACABA;  |FINSI;

     |SI enAnyo = 2015;  |HAZ isom0023_2015;  |ACABA;  |FINSI;
     |SI enAnyo = 2016;  |HAZ isom0023_2016;  |ACABA;  |FINSI;
     |SI enAnyo = 2017;  |HAZ isom0023_2017;  |ACABA;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0023_2018;  |ACABA;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0023_2019;  |ACABA;  |FINSI;

     aCasilla = "";
     |SI enAnyo = 2013;
         |SI #anyoant@#4 = "267  ";  aCasilla = "969  ";  |FINSI;
         |SI #anyoant@#4 = "538  ";  aCasilla = "503  ";  |FINSI;
     |FINSI;

     |SI enAnyo = 2014;
         |SI #anyoant@#4 = "267  ";  |ACABA;  |FINSI;
         |SI #anyoant@#4 = "538  ";  |ACABA;  |FINSI;

         |SI #anyoant@#4 = "969  ";  aCasilla = "212";  |FINSI;
         |SI #anyoant@#4 = "261  ";  aCasilla = "969";  |FINSI;
         |SI #anyoant@#4 = "264  ";  aCasilla = "969";  |FINSI;
         |SI #anyoant@#4 = "503  ";  aCasilla = "890";  |FINSI;
         |SI #anyoant@#4 = "270  ";  aCasilla = "503";  |FINSI;
         |SI #anyoant@#4 = "273  ";  aCasilla = "503";  |FINSI;
     |FINSI;

     |SI aCasilla = "";  |ACABA;  |FINSI;

     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#4 = aCasilla;
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5 = #anyoant@#9;
         #isom0023#7 = 0;
         #isom0023#9 = #anyoant@#9;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;
|FPRC;

|DEFBUCLE isom0023;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0023;
|FIN;

|PROCESO isom0029;
     |SI #anyoant@#13 = 0;  |Y #anyoant@#15 = 0;
         |ACABA;
     |FINSI;

     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#14 = "1191 ";  aCasilla = "1191";  |FINSI;
     |SI #anyoant@#14 = "1196 ";  aCasilla = "1196";  |FINSI;
     |SI #anyoant@#14 = "1201 ";  aCasilla = "1201";  |FINSI;
     |SI #anyoant@#14 = "1206 ";  aCasilla = "1206";  |FINSI;
     |SI #anyoant@#14 = "1211 ";  aCasilla = "1211";  |FINSI;
     |SI #anyoant@#14 = "1466 ";  aCasilla = "1211";  |FINSI;

     |SI aCasilla ! "";
         #isom0029#0  = enEmpresa;
         #isom0029#1  = enAnyo;
         #isom0029#14 = aCasilla;
         |LEE 101#isom0029.=;
         |SI FSalida = 0;
             #isom0029#5  = #anyoant@#13;
             #isom0029#7  = #anyoant@#15;
             #isom0029#13 = #anyoant@#13;
             #isom0029#15 = #anyoant@#15;
             |GRABA 020#isom0029.a;
             |LIBERA #isom0029;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isom0029;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0029;
|FIN;

|PROCESO isom0023Bo;
     |SI #isom0023#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0023#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0023#9  ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0023.a;
     |LIBERA #isom0023;
|FPRC;

|DEFBUCLE isom0023Bo;
     #isom0023#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0023Bo;
|FIN;

|PROCESO isom0029Bo;
     |SI #isom0029#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0029#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0029#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0029#11 ! 0;  |ACABA;  |FINSI;
     |SI #isom0029#13 ! 0;  |ACABA;  |FINSI;
     |SI #isom0029#15 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0029.a;
     |LIBERA #isom0029;
|FPRC;

|DEFBUCLE isom0029Bo;
     #isom0029#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0029Bo;
|FIN;

|PROCESO Limita2014;
     |ABRET #isom0022;
     |ABRET #isom0023;

     |SELECT #1#isom0023;
     |BUCLE isom0511;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0023.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #3#isom0023;
     |BUCLE isom0023;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0023;

     |BUCLE isom0023Bo;

     |HAZ TotalFich122;
     |HAZ TotalFich123;
     |HAZ Total18Bis;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;

     |CIERRAT #isom0022;
     |CIERRAT #isom0023;
|FPRC;

|PROCESO Limita2015;
     |ABRET #isom0022;
     |ABRET #isom0023;
     |ABRET #isom0029;

     |SELECT #1#isom0023;  |BUCLE isom0511;
     |SELECT #1#isom0029;  |BUCLE isom0515;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0023.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #3#isom0023;
     |BUCLE isom0023;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0023;
     |SELECT #1#isom0029;

     |BUCLE isom0023Bo;
     |BUCLE isom0029Bo;

     |HAZ TotalFich122;
     |HAZ TotalFich123;
     |HAZ TotalFich129;
     |HAZ Total20;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;
     |SELECT #1#isom0029;

     |CIERRAT #isom0022;
     |CIERRAT #isom0023;
     |CIERRAT #isom0029;
|FPRC;

|PROCESO Limita2016;
     |ABRET #isom0022;
     |ABRET #isom0023;
     |ABRET #isom0029;

     |SELECT #1#isom0023;  |BUCLE isom0511;
     |SELECT #1#isom0029;  |BUCLE isom0515;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0023.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #3#isom0023;  |BUCLE isom0023;

     |DESCARGA_DEF #anyoant@;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0029.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #3#isom0029;  |BUCLE isom0029;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0023;
     |SELECT #1#isom0029;

     |BUCLE isom0023Bo;
     |BUCLE isom0029Bo;

     |HAZ TotalFich122;
     |HAZ TotalFich123;
     |HAZ TotalFich129;
     |HAZ Total20;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;
     |SELECT #1#isom0029;

     |CIERRAT #isom0022;
     |CIERRAT #isom0023;
     |CIERRAT #isom0029;
|FPRC;

|PROCESO isom0516_M0028;
     #isom0028#0  = enEmpresa;
     #isom0028#1  = #isom0516#0;
     #isom0028#2  = #isom0516#1;
     |LEE 101#isom0028.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0028;
         #isom0028#0  = enEmpresa;
         #isom0028#1  = #isom0516#0;
         #isom0028#2  = #isom0516#1;
         |GRABA 020#isom0028.b;
     |FINSI;

     #isom0028#3  = #isom0516#2;
     #isom0028#4  = #isom0516#3;
     #isom0028#6  = #isom0516#4;
     #isom0028#8  = #isom0516#5;
     #isom0028#10 = #isom0516#6;

     #isom0028#5  = 0;
     #isom0028#7  = 0;
     #isom0028#9  = 0;
     #isom0028#11 = 0;

     |GRABA 020#isom0028.a;
     |LIBERA #isom0028;
|FPRC;

|DEFBUCLE isom0516_M0028;
     #isom0516#1;
     ;
     enAnyo, nDLin;
     enAnyo, nHLin;
     ;
     NULL, isom0516_M0028;
|FIN;

|PROCESO isom0028_2017;
     |SI #anyoant@#4 = "1166 ";  aCasilla = "1166";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1438 ";  aCasilla = "1438";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1442 ";  aCasilla = "1438";  nDiv = 0.05;  |FINSI;

     |SI #anyoant@#4 = "1178 ";  aCasilla = "1178";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1447 ";  aCasilla = "1447";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1451 ";  aCasilla = "1447";  nDiv = 0.05;  |FINSI;
|FPRC;

|PROCESO isom0028_2018;
     |SI #anyoant@#4 = "1166 ";  aCasilla = "1166";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1438 ";  aCasilla = "1438";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1442 ";  aCasilla = "1442";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1721 ";  aCasilla = "1442";  nDiv = 0.05;  |FINSI;

     |SI #anyoant@#4 = "1178 ";  aCasilla = "1178";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1447 ";  aCasilla = "1447";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1451 ";  aCasilla = "1451";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1725 ";  aCasilla = "1451";  nDiv = 0.05;  |FINSI;
|FPRC;

|PROCESO isom0028_2019;
     aAlfa =  #anyoant@#4;

     |SI #anyoant@#4 = "1166 ";  aCasilla = "1166";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1438 ";  aCasilla = "1438";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1442 ";  aCasilla = "1442";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1721 ";  aCasilla = "1721";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1953 ";  aCasilla = "1721";  nDiv = 0.05;  |FINSI;

     |SI #anyoant@#4 = "1178 ";  aCasilla = "1178";  nDiv = 0.02;  |FINSI;
     |SI #anyoant@#4 = "1447 ";  aCasilla = "1447";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1451 ";  aCasilla = "1451";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1725 ";  aCasilla = "1725";  nDiv = 0.05;  |FINSI;
     |SI #anyoant@#4 = "1957 ";  aCasilla = "1725";  nDiv = 0.05;  |FINSI;
|FPRC;

|PROCESO isom0028;
     |SI #anyoant@#11 = 0;  |ACABA;  |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0028_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0028_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0028_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0028#0 = enEmpresa;
     #isom0028#1 = enAnyo;
     #isom0028#4 = aCasilla;
     |LEE 101#isom0028.=;
     |SI FSalida = 0;
         #isom0028#5 = #isom0028#5 + (#anyoant@#11 / nDiv);

         nPorce = 5;
         |SI #isom0028#4 = "1166 ";   |O #isom0028#4 = "1178 ";
             nPorce = 2;
         |FINSI;

         #isom0028#7 = #isom0028#5 % nPorce;

         #isom0028#11 = #isom0028#7;
         |GRABA 020#isom0028.a;
         |LIBERA #isom0028;
     |FINSI;
|FPRC;

|DEFBUCLE isom0028;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0028;
|FIN;

|PROCESO isom0028Bo;
     |SI #isom0028#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0028#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0028#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0028#11 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0028.a;
     |LIBERA #isom0028;
|FPRC;

|DEFBUCLE isom0028Bo;
     #isom0028#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0028Bo;
|FIN;

|PROCESO PasaM0028;
     |ABRET #isom0028;

     |SI enAnyo = 2017;
         nDLin  = 125;
         nHLin  = 175;
     |FINSI;

     |SI enAnyo = 2018;
         nDLin  = 135;
         nHLin  = 195;
     |FINSI;

     |SI enAnyo = 2019;
         nDLin  = 145;
         nHLin  = 215;
     |FINSI;

     |BUCLE isom0516_M0028;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0028.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0028;  |BUCLE isom0028;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0028;

     |HAZ TotalFich128;

     |BUCLE isom0028Bo;

     |CIERRAT #isom0028;
|FPRC;

|PROCESO isom0516_M0027;
     #isom0027#0  = enEmpresa;
     #isom0027#1  = #isom0516#0;
     #isom0027#2  = #isom0516#1;
     |LEE 101#isom0027.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0027;
         #isom0027#0  = enEmpresa;
         #isom0027#1  = #isom0516#0;
         #isom0027#2  = #isom0516#1;
         |GRABA 020#isom0027.b;
     |FINSI;

     #isom0027#3  = #isom0516#2;
     #isom0027#4  = #isom0516#3;
     #isom0027#6  = #isom0516#4;
     #isom0027#8  = #isom0516#5;
     #isom0027#10 = #isom0516#6;

     #isom0027#5  = 0;
     #isom0027#7  = 0;
     #isom0027#9  = 0;
     #isom0027#11 = 0;

     |GRABA 020#isom0027.a;
     |LIBERA #isom0027;
|FPRC;

|DEFBUCLE isom0516_M0027;
     #isom0516#1;
     ;
     enAnyo, nDLin;
     enAnyo, nHLin;
     ;
     NULL, isom0516_M0027;
|FIN;

|PROCESO isom0027_2017;
     |SI #anyoant@#4 = "1141 ";  aCasilla = "1141";  |FINSI;
     |SI #anyoant@#4 = "1144 ";  aCasilla = "1144";  |FINSI;
     |SI #anyoant@#4 = "1455 ";  aCasilla = "1144";  |FINSI;
|FPRC;

|PROCESO isom0027_2018;
     |SI #anyoant@#4 = "1141 ";  aCasilla = "1141";  |FINSI;
     |SI #anyoant@#4 = "1144 ";  aCasilla = "1144";  |FINSI;
     |SI #anyoant@#4 = "1455 ";  aCasilla = "1455";  |FINSI;
     |SI #anyoant@#4 = "1034 ";  aCasilla = "1455";  |FINSI;
|FPRC;

|PROCESO isom0027_2019;
     |SI #anyoant@#4 = "1141 ";  aCasilla = "1141";  |FINSI;
     |SI #anyoant@#4 = "1144 ";  aCasilla = "1144";  |FINSI;
     |SI #anyoant@#4 = "1455 ";  aCasilla = "1455";  |FINSI;
     |SI #anyoant@#4 = "1961 ";  aCasilla = "1961";  |FINSI;
     |SI #anyoant@#4 = "1034 ";  aCasilla = "1961";  |FINSI;
|FPRC;

|PROCESO isom0027;
     |SI #anyoant@#9 = 0;  |ACABA;  |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0027_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0027_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0027_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0027#0 = enEmpresa;
     #isom0027#1 = enAnyo;
     #isom0027#4 = aCasilla;
     |LEE 101#isom0027.=;
     |SI FSalida = 0;
         #isom0027#5 = #isom0027#5 + #anyoant@#9;
         #isom0027#9 = #isom0027#5;

         |GRABA 020#isom0027.a;
         |LIBERA #isom0027;
     |FINSI;
|FPRC;

|DEFBUCLE isom0027;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0027;
|FIN;

|PROCESO isom0027Bo;
     |SI #isom0027#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0027#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0027#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0027#11 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0027.a;
     |LIBERA #isom0027;
|FPRC;

|DEFBUCLE isom0027Bo;
     #isom0027#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0027Bo;
|FIN;

|PROCESO PasaM0027;
     |ABRET #isom0027;

     |SI enAnyo = 2017;
         nDLin  = 60;
         nHLin  = 115;
     |FINSI;

     |SI enAnyo = 2018;
         nDLin  = 60;
         nHLin  = 125;
     |FINSI;

     |SI enAnyo = 2019;
         nDLin  = 60;
         nHLin  = 135;
     |FINSI;

     |BUCLE isom0516_M0027;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0027.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0027;  |BUCLE isom0027;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0027;

     |HAZ TotalFich127;

     |BUCLE isom0027Bo;

     |CIERRAT #isom0027;
|FPRC;

|PROCESO isom0516_M0026;
     #isom0026#0  = enEmpresa;
     #isom0026#1  = #isom0516#0;
     #isom0026#2  = #isom0516#1;
     |LEE 101#isom0026.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0026;
         #isom0026#0  = enEmpresa;
         #isom0026#1  = #isom0516#0;
         #isom0026#2  = #isom0516#1;
         |GRABA 020#isom0026.b;
     |FINSI;

     #isom0026#3  = #isom0516#2;
     #isom0026#4  = #isom0516#3;
     #isom0026#6  = #isom0516#4;
     #isom0026#8  = #isom0516#5;

     #isom0026#5  = 0;
     #isom0026#7  = 0;
     #isom0026#9  = 0;

     |GRABA 020#isom0026.a;
     |LIBERA #isom0026;
|FPRC;

|DEFBUCLE isom0516_M0026;
     #isom0516#1;
     ;
     enAnyo, nDLin;
     enAnyo, nHLin;
     ;
     NULL, isom0516_M0026;
|FIN;

|PROCESO isom0026_2017;
     |SI #anyoant@#4 = "1131 ";  aCasilla = "1131";  |FINSI;
     |SI #anyoant@#4 = "1134 ";  aCasilla = "1134";  |FINSI;
     |SI #anyoant@#4 = "1470 ";  aCasilla = "1134";  |FINSI;
|FPRC;

|PROCESO isom0026_2018;
     |SI #anyoant@#4 = "1134 ";  aCasilla = "1134";  |FINSI;
     |SI #anyoant@#4 = "1470 ";  aCasilla = "1470";  |FINSI;
     |SI #anyoant@#4 = "1744 ";  aCasilla = "1470";  |FINSI;
|FPRC;

|PROCESO isom0026_2019;
     |SI #anyoant@#4 = "1470 ";  aCasilla = "1134";  |FINSI;
     |SI #anyoant@#4 = "1744 ";  aCasilla = "1470";  |FINSI;
     |SI #anyoant@#4 = "1985 ";  aCasilla = "1470";  |FINSI;
|FPRC;

|PROCESO isom0026;
     |SI #anyoant@#9 = 0;  |ACABA;  |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0026_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0026_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0026_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0026#0 = enEmpresa;
     #isom0026#1 = enAnyo;
     #isom0026#4 = aCasilla;
     |LEE 101#isom0026.=;
     |SI FSalida = 0;
         #isom0026#5 = #isom0026#5 + #anyoant@#9;

         |SI #isom0026#8 ! "     ";
             #isom0026#9 = #isom0026#5;
         |FINSI;

         |GRABA 020#isom0026.a;
         |LIBERA #isom0026;
     |FINSI;
|FPRC;

|DEFBUCLE isom0026;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0026;
|FIN;

|PROCESO isom0026Bo;
     |SI #isom0026#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0026#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0026#9  ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0026.a;
     |LIBERA #isom0026;
|FPRC;

|DEFBUCLE isom0026Bo;
     #isom0026#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0026Bo;
|FIN;

|PROCESO PasaM0026;
     |ABRET #isom0026;

     |SI enAnyo = 2017;
         nDLin  = 15;
         nHLin  = 45;
     |FINSI;

     |SI enAnyo = 2018;
         nDLin  = 15;
         nHLin  = 45;
     |FINSI;

     |SI enAnyo = 2019;
         nDLin  = 15;
         nHLin  = 45;
     |FINSI;

     |BUCLE isom0516_M0026;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0026.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0026;  |BUCLE isom0026;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0026;

     |HAZ TotalFich126;

     |BUCLE isom0026Bo;

     |CIERRAT #isom0026;
|FPRC;

|PROCESO isom0517_M0030;
     #isom0030#0  = enEmpresa;
     #isom0030#1  = #isom0517#0;
     #isom0030#2  = #isom0517#1;
     |LEE 101#isom0030.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0030;
         #isom0030#0  = enEmpresa;
         #isom0030#1  = #isom0517#0;
         #isom0030#2  = #isom0517#1;
         |GRABA 020#isom0030.b;
     |FINSI;

     #isom0030#3  = #isom0517#2;
     #isom0030#4  = #isom0517#3;
     #isom0030#6  = #isom0517#4;
     #isom0030#8  = #isom0517#5;
     #isom0030#11 = #isom0517#6;
     #isom0030#14 = #isom0517#7;
     #isom0030#16 = #isom0517#8;

     #isom0030#5  = 0;
     #isom0030#7  = 0;
     #isom0030#9  = 0;
     #isom0030#10 = 0;
     #isom0030#12 = 0;
     #isom0030#13 = 0;
     #isom0030#15 = 0;
     #isom0030#17 = 0;

     |GRABA 020#isom0030.a;
     |LIBERA #isom0030;
|FPRC;

|DEFBUCLE isom0517_M0030;
     #isom0517#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0517_M0030;
|FIN;

|PROCESO isom0030_2017;
     |SI #anyoant@#4 = "1473 ";  aCasilla = "1473";  |FINSI;
     |SI #anyoant@#4 = "1477 ";  aCasilla = "1477";  |FINSI;
     |SI #anyoant@#4 = "1485 ";  aCasilla = "1485";  |FINSI;
     |SI #anyoant@#4 = "1491 ";  aCasilla = "1485";  |FINSI;
|FPRC;

|PROCESO isom0030_2018;
     |SI #anyoant@#4 = "1473 ";  aCasilla = "1473";  |FINSI;
     |SI #anyoant@#4 = "1477 ";  aCasilla = "1477";  |FINSI;
     |SI #anyoant@#4 = "1485 ";  aCasilla = "1485";  |FINSI;
     |SI #anyoant@#4 = "1491 ";  aCasilla = "1491";  |FINSI;
     |SI #anyoant@#4 = "1750 ";  aCasilla = "1491";  |FINSI;
|FPRC;

|PROCESO isom0030_2019;
     |SI #anyoant@#4 = "1473 ";  aCasilla = "1473";  |FINSI;
     |SI #anyoant@#4 = "1477 ";  aCasilla = "1477";  |FINSI;
     |SI #anyoant@#4 = "1485 ";  aCasilla = "1485";  |FINSI;
     |SI #anyoant@#4 = "1491 ";  aCasilla = "1491";  |FINSI;
     |SI #anyoant@#4 = "1750 ";  aCasilla = "1750";  |FINSI;
     |SI #anyoant@#4 = "1991 ";  aCasilla = "1750";  |FINSI;
|FPRC;

|PROCESO isom0030;
     |SI #anyoant@#15 = 0;  |Y #anyoant@#17 = 0;
         |ACABA;
     |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0030_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0030_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0030_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0030#0 = enEmpresa;
     #isom0030#1 = enAnyo;
     #isom0030#4 = aCasilla;
     |LEE 101#isom0030.=;
     |SI FSalida = 0;
         |SI #anyoant@#15 ! 0;
             #isom0030#5 = #isom0030#5 + #anyoant@#15;
         |FINSI;

         |SI #anyoant@#17 ! 0;
             |SI #isom0030#6 ! "     ";
                 #isom0030#7 = #isom0030#7 + #anyoant@#17;
             |FINSI;
         |FINSI;

         |SI #isom0030#14 ! "     ";
             #isom0030#15 = #isom0030#5 - #isom0030#9  - #isom0030#12;
         |FINSI;

         |SI #isom0030#16 ! "     ";
             #isom0030#17 = #isom0030#7 - #isom0030#10 - #isom0030#13;
         |FINSI;

         |GRABA 020#isom0030.a;
         |LIBERA #isom0030;
     |FINSI;
|FPRC;

|DEFBUCLE isom0030;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0030;
|FIN;

|PROCESO isom0030Bo;
     |SI #isom0030#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#10 ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#12 ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#13 ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#15 ! 0;  |ACABA;  |FINSI;
     |SI #isom0030#17 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0030.a;
     |LIBERA #isom0030;
|FPRC;

|DEFBUCLE isom0030Bo;
     #isom0030#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0030Bo;
|FIN;

|PROCESO PasaM0030;
     |ABRET #isom0030;

     |BUCLE isom0517_M0030;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0030.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0030;  |BUCLE isom0030;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0030;

     |HAZ TotalFich130;

     |BUCLE isom0030Bo;

     |CIERRAT #isom0030;
|FPRC;

|PROCESO isom0518_M0031;
     #isom0031#0  = enEmpresa;
     #isom0031#1  = #isom0518#0;
     #isom0031#2  = #isom0518#1;
     |LEE 101#isom0031.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0031;
         #isom0031#0  = enEmpresa;
         #isom0031#1  = #isom0518#0;
         #isom0031#2  = #isom0518#1;
         |GRABA 020#isom0031.b;
     |FINSI;

     #isom0031#3  = #isom0518#2;
     #isom0031#4  = #isom0518#3;
     #isom0031#6  = #isom0518#4;
     #isom0031#8  = #isom0518#5;
     #isom0031#10 = #isom0518#6;
     #isom0031#12 = #isom0518#7;
     #isom0031#14 = #isom0518#8;
     #isom0031#16 = #isom0518#9;
     #isom0031#18 = #isom0518#10;

     #isom0031#5  = 0;
     #isom0031#7  = 0;
     #isom0031#9  = 0;
     #isom0031#11 = 0;
     #isom0031#13 = 0;
     #isom0031#15 = 0;
     #isom0031#17 = 0;
     #isom0031#19 = 0;

     |GRABA 020#isom0031.a;
     |LIBERA #isom0031;
|FPRC;

|DEFBUCLE isom0518_M0031;
     #isom0518#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0518_M0031;
|FIN;

|PROCESO isom0031_2017;
     aAlfa =  #anyoant@#4;

     aCasilla = "";

     |SI #anyoant@#4 = "1524 ";  aCasilla = "1524";  |FINSI;
     |SI #anyoant@#4 = "1529 ";  aCasilla = "1529";  |FINSI;

     |SI aCasilla ! "";
         #isom0031#0 = enEmpresa;
         #isom0031#1 = enAnyo;
         #isom0031#4 = aCasilla;
         |LEE 101#isom0031.=;
         |SI FSalida = 0;
             #isom0031#5 = #isom0031#5 + #anyoant@#19;

             #isom0031#19 = #isom0031#5 - #isom0031#9 - #isom0031#11;

             |SI #isom0031#14 = "1527 ";
                 #isom0031#15 = #isom0031#19;
             |FINSI;

             |SI #isom0031#14 = "1532 ";
                 #isom0031#15 = #isom0031#19;
             |FINSI;

             |GRABA 020#isom0031.a;
             |LIBERA #isom0031;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0031;
     |SI #anyoant@#19 = 0;
         |ACABA;
     |FINSI;

     |SI enAnyo ] 2017;
         |HAZ isom0031_2017;
     |FINSI;
|FPRC;

|DEFBUCLE isom0031;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0031;
|FIN;

|PROCESO isom0031Bo;
     |SI #isom0031#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#11 ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#13 ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#15 ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#17 ! 0;  |ACABA;  |FINSI;
     |SI #isom0031#19 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0031.a;
     |LIBERA #isom0031;
|FPRC;

|DEFBUCLE isom0031Bo;
     #isom0031#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0031Bo;
|FIN;

|PROCESO PasaM0031;
     |ABRET #isom0031;

     |BUCLE isom0518_M0031;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0031.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0031;  |BUCLE isom0031;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0031;

     |HAZ TotalFich131;

     |BUCLE isom0031Bo;

     |CIERRAT #isom0031;
|FPRC;

|PROCESO isom0519_M0032;
     #isom0032#0  = enEmpresa;
     #isom0032#1  = #isom0519#0;
     #isom0032#2  = #isom0519#1;
     |LEE 101#isom0032.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0032;
         #isom0032#0  = enEmpresa;
         #isom0032#1  = #isom0519#0;
         #isom0032#2  = #isom0519#1;
         |GRABA 020#isom0032.b;
     |FINSI;

     #isom0032#3  = #isom0519#2;
     #isom0032#4  = #isom0519#3;
     #isom0032#6  = #isom0519#4;
     #isom0032#8  = #isom0519#5;
     #isom0032#10 = #isom0519#6;
     #isom0032#12 = #isom0519#7;
     #isom0032#14 = #isom0519#8;
     #isom0032#16 = #isom0519#9;
     #isom0032#18 = #isom0519#10;
     #isom0032#20 = #isom0519#11;
     #isom0032#22 = #isom0519#12;

     #isom0032#5  = 0;
     #isom0032#7  = 0;
     #isom0032#9  = 0;
     #isom0032#11 = 0;
     #isom0032#13 = 0;
     #isom0032#15 = 0;
     #isom0032#17 = 0;
     #isom0032#19 = 0;
     #isom0032#21 = 0;
     #isom0032#23 = 0;

     |GRABA 020#isom0032.a;
     |LIBERA #isom0032;
|FPRC;

|DEFBUCLE isom0519_M0032;
     #isom0519#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0519_M0032;
|FIN;

|PROCESO isom0032_2017;
     |SI #anyoant@#4 = "1542 ";  aCasilla = "1542";  |FINSI;
     |SI #anyoant@#4 = "1552 ";  aCasilla = "1542";  |FINSI;
|FPRC;

|PROCESO isom0032_2018;
     |SI #anyoant@#4 = "1542 ";  aCasilla = "1542";  |FINSI;
     |SI #anyoant@#4 = "1552 ";  aCasilla = "1552";  |FINSI;
     |SI #anyoant@#4 = "1754 ";  aCasilla = "1552";  |FINSI;
|FPRC;

|PROCESO isom0032_2019;
     |SI #anyoant@#4 = "1542 ";  aCasilla = "1542";  |FINSI;
     |SI #anyoant@#4 = "1552 ";  aCasilla = "1552";  |FINSI;
     |SI #anyoant@#4 = "1754 ";  aCasilla = "1754";  |FINSI;
     |SI #anyoant@#4 = "2100 ";  aCasilla = "1754";  |FINSI;
|FPRC;

|PROCESO isom0032;
     |SI #anyoant@#19 = 0;
      |Y #anyoant@#21 = 0;
      |Y #anyoant@#23 = 0;
         |ACABA;
     |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0032_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0032_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0032_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0032#0 = enEmpresa;
     #isom0032#1 = enAnyo;
     #isom0032#4 = aCasilla;
     |LEE 101#isom0032.=;
     |SI FSalida = 0;
         #isom0032#5 = #isom0032#5 + (#anyoant@#19 + #anyoant@#21 + #anyoant@#23);

         |GRABA 020#isom0032.a;
         |LIBERA #isom0032;
     |FINSI;
|FPRC;

|DEFBUCLE isom0032;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0032;
|FIN;

|PROCESO isom0032Bo;
     |SI #isom0032#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#11 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#13 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#15 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#17 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#19 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#21 ! 0;  |ACABA;  |FINSI;
     |SI #isom0032#23 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0032.a;
     |LIBERA #isom0032;
|FPRC;

|DEFBUCLE isom0032Bo;
     #isom0032#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0032Bo;
|FIN;

|PROCESO PasaM0032;
     |ABRET #isom0032;

     |BUCLE isom0519_M0032;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0032.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0032;  |BUCLE isom0032;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0032;

     |HAZ TotalFich132;

     |BUCLE isom0032Bo;

     |CIERRAT #isom0032;
|FPRC;

|PROCESO isom0520_M0033;
     #isom0033#0  = enEmpresa;
     #isom0033#1  = #isom0520#0;
     #isom0033#2  = #isom0520#1;
     |LEE 101#isom0033.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0033;
         #isom0033#0  = enEmpresa;
         #isom0033#1  = #isom0520#0;
         #isom0033#2  = #isom0520#1;
         |GRABA 020#isom0033.b;
     |FINSI;

     #isom0033#3  = #isom0520#2;
     #isom0033#4  = #isom0520#3;
     #isom0033#6  = #isom0520#4;
     #isom0033#8  = #isom0520#5;
     #isom0033#10 = #isom0520#6;

     #isom0033#5  = 0;
     #isom0033#7  = 0;
     #isom0033#9  = 0;
     #isom0033#11 = 0;

     |GRABA 020#isom0033.a;
     |LIBERA #isom0033;
|FPRC;

|DEFBUCLE isom0520_M0033;
     #isom0520#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0520_M0033;
|FIN;

|PROCESO isom0033_2017;
     |SI #anyoant@#4 = "1571 ";  aCasilla = "1571";  |FINSI;
     |SI #anyoant@#4 = "1575 ";  aCasilla = "1571";  |FINSI;
|FPRC;

|PROCESO isom0033_2018;
     |SI #anyoant@#4 = "1571 ";  aCasilla = "1571";  |FINSI;
     |SI #anyoant@#4 = "1575 ";  aCasilla = "1575";  |FINSI;
     |SI #anyoant@#4 = "1763 ";  aCasilla = "1575";  |FINSI;
|FPRC;

|PROCESO isom0033_2019;
     |SI #anyoant@#4 = "1575 ";  aCasilla = "1575";  |FINSI;
     |SI #anyoant@#4 = "1763 ";  aCasilla = "1763";  |FINSI;
     |SI #anyoant@#4 = "2109 ";  aCasilla = "1763";  |FINSI;
|FPRC;

|PROCESO isom0033;
     |SI #anyoant@#11 = 0;
         |ACABA;
     |FINSI;

     aCasilla = "";

     |SI enAnyo = 2017;  |HAZ isom0033_2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ isom0033_2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ isom0033_2019;  |FINSI;

     |SI aCasilla = "";
         |ACABA;
     |FINSI;

     #isom0033#0 = enEmpresa;
     #isom0033#1 = enAnyo;
     #isom0033#4 = aCasilla;
     |LEE 101#isom0033.=;
     |SI FSalida = 0;
         #isom0033#5  = #isom0033#5 + #anyoant@#11;
         #isom0033#11 = #isom0033#5;

         |GRABA 020#isom0033.a;
         |LIBERA #isom0033;
     |FINSI;
|FPRC;

|DEFBUCLE isom0033;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0033;
|FIN;

|PROCESO isom0033Bo;
     |SI #isom0033#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0033#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0033#9  ! 0;  |ACABA;  |FINSI;
     |SI #isom0033#11 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0033.a;
     |LIBERA #isom0033;
|FPRC;

|DEFBUCLE isom0033Bo;
     #isom0033#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0033Bo;
|FIN;

|PROCESO PasaM0033;
     |ABRET #isom0033;

     |BUCLE isom0520_M0033;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0033.mas";
     |CARGA_DEF aMas, anyoant@;

     |SELECT #2#isom0033;  |BUCLE isom0033;

     |DESCARGA_DEF #anyoant@;

     |SELECT #1#isom0033;

     |HAZ TotalFich133;

     |BUCLE isom0033Bo;

     |CIERRAT #isom0033;
|FPRC;

|PROCESO DeduccionesActual;
     nAnyoAnt = enAnyo - 1

     |BUCLE isocie70B;

     |ABRE #ism00002;
     |BUCLE isom0011A;
     |CIERRA #ism00002;

     |BUCLE isom0011B;

     |ABRE #isom0011;
     |SELECT #1#isom0011;
     |BUCLE isom0508;

     |SELECT #2#isom0011;
     |BUCLE isocie70;
     |SELECT #1#isom0011;
     |CIERRA #isom0011;

     |ABRET #isom0011;
     |HAZ TotalFich111;
     |CIERRAT #isom0011;

     |BUCLE isom0011R;

     |ABRET #isom0011;
     |HAZ TotalFich111;
     |CIERRAT #isom0011;

     |SI enAnyo [ 2014;  |HAZ Limita2014;  |FINSI;
     |SI enAnyo = 2015;  |HAZ Limita2015;  |FINSI;
     |SI enAnyo ] 2016;  |HAZ Limita2016;  |FINSI;

     |SI enAnyo ] 2017;
         |HAZ PasaM0028;
         |HAZ PasaM0027;
         |HAZ PasaM0026;
         |HAZ PasaM0030;
         |HAZ PasaM0031;
         |HAZ PasaM0032;
         |HAZ PasaM0033;
     |FINSI;
|FPRC;

|PROCESO isom0507;
     |SI nDesde = 0;
         #isom0009#0  = enEmpresa;
         #isom0009#1  = #isom0507#0;
         #isom0009#2  = #isom0507#1;
         |LEE 101#isom0009.=;
         |SI FSalida ! 0;
             |DDEFECTO #isom0009;
             #isom0009#0  = enEmpresa;
             #isom0009#1  = #isom0507#0;
             #isom0009#2  = #isom0507#1;
             |GRABA 020#isom0009.b;
         |FINSI;

         #isom0009#3  = #isom0507#7;
         #isom0009#4  = #isom0507#2;
         #isom0009#5  = #isom0507#4;
         #isom0009#7  = #isom0507#5;
         #isom0009#9  = #isom0507#6;

         |SI #isom0009#4 ! aAnyo;
             #isom0009#6  = 0;
             #isom0009#8  = 0;
             #isom0009#10 = 0;
         |FINSI;

         |GRABA 020#isom0009.a;
         |LIBERA #isom0009;
     |FINSI;

     |SI nDesde ! 0;
         #isom0010#0  = enEmpresa;
         #isom0010#1  = #isom0507#0;
         #isom0010#2  = #isom0507#1;
         |LEE 101#isom0010.=;
         |SI FSalida ! 0;
             |DDEFECTO #isom0010;
             #isom0010#0  = enEmpresa;
             #isom0010#1  = #isom0507#0;
             #isom0010#2  = #isom0507#1;
             |SI enAnyo = 2008;   #isom0010#4 = "";   |FINSI;
             |GRABA 020#isom0010.b;
         |FINSI;

         #isom0010#3  = #isom0507#7;

         |SI enAnyo = 2008;
             |SI #isom0010#4 ! aAnyo;
                  #isom0010#4  = "";
             |FINSI;
         |SINO;
             #isom0010#4  = #isom0507#2;

             |SI #isom0010#4 ! aAnyo;
                 #isom0010#6  = 0;
                 #isom0010#8  = 0;
                 #isom0010#10 = 0;
             |FINSI;
         |FINSI;

         #isom0010#5  = #isom0507#4;
         #isom0010#7  = #isom0507#5;
         #isom0010#9  = #isom0507#6;

         |GRABA 020#isom0010.a;
         |LIBERA #isom0010;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507;
     #isom0507#1;
     ;
     enAnyo, nDesde;
     enAnyo, nHasta;     || Del 1 al 999 es el isom0009
     ;
     NULL, isom0507;
|FIN;

|PROCESO Graba547;
     |SI enAnyo = 2008;
         |SI aAnyo = "  ";
             aAnyo = "2007";
         |SINO;
             nNume = aAnyo;
             |SI nNume ] 93;  |Y nNume [ 99;
                 nNume = 1900 + nNume;
             |SINO;
                 nNume = 2000 + nNume;
             |FINSI;

             aAnyo = nNume;
         |FINSI;
     |FINSI;

     #isom0009#0 = enEmpresa;
     #isom0009#1 = enAnyo;
     #isom0009#4 = aAnyo;
     |LEE 101#isom0009.=;
     |SI FSalida = 0;
         #isom0009#6  = nPendiente;
         #isom0009#8  = 0;

         |SI #isom0009#9 ! "     ";  #isom0009#10 = nPendiente;  |FINSI;

         |GRABA 020#isom0009.a;
         |LIBERA #isom0009;
     |FINSI;
|FPRC;

|PROCESO isom0009B;
     |SI #isom0009#6  ! 0;  |ACABA;  |FINSI;
     |SI #isom0009#8  ! 0;  |ACABA;  |FINSI;
     |SI #isom0009#10 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0009.a;
     |LIBERA #isom0009;
|FPRC;

|DEFBUCLE isom0009B;
     #isom0009#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0009B;
|FIN;

|PROCESO isom0009;
     #isocie62#0 = enEmpresa;
     #isocie62#1 = enAnyo - 1;
     #isocie62#2 = nClave;
     |LEE 000#isocie62.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SI #isocie62#26 = 0;   |ACABA;  |FINSI;

     |SI #isocie62#21 ! 0;  aAnyo = #isocie62#4;   nPendiente = #isocie62#21;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#22 ! 0;  aAnyo = #isocie62#5;   nPendiente = #isocie62#22;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#23 ! 0;  aAnyo = #isocie62#6;   nPendiente = #isocie62#23;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#24 ! 0;  aAnyo = #isocie62#7;   nPendiente = #isocie62#24;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#25 ! 0;  aAnyo = #isocie62#8;   nPendiente = #isocie62#25;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#30 ! 0;  aAnyo = #isocie62#27;  nPendiente = #isocie62#30;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#34 ! 0;  aAnyo = #isocie62#31;  nPendiente = #isocie62#34;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#38 ! 0;  aAnyo = #isocie62#35;  nPendiente = #isocie62#38;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#42 ! 0;  aAnyo = #isocie62#39;  nPendiente = #isocie62#42;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#46 ! 0;  aAnyo = #isocie62#43;  nPendiente = #isocie62#46;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#50 ! 0;  aAnyo = #isocie62#47;  nPendiente = #isocie62#50;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#54 ! 0;  aAnyo = #isocie62#51;  nPendiente = #isocie62#54;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#58 ! 0;  aAnyo = #isocie62#55;  nPendiente = #isocie62#58;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#62 ! 0;  aAnyo = #isocie62#59;  nPendiente = #isocie62#62;  |HAZ Graba547;  |FINSI;
     |SI #isocie62#66 ! 0;  aAnyo = #isocie62#63;  nPendiente = #isocie62#66;  |HAZ Graba547;  |FINSI;
|FPRC;

|PROCESO BasesNegativas2008;
     enCooperativa = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 17;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 18;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     |CIERRA #maempr11;

     |SI enCooperativa = 1;  |ACABA;  |FINSI;

     nDesde = 0;
     nHasta = 999;

     |ABRE #isom0009;
     |SELECT #1#isom0009;
     |BUCLE isom0507;

     |SELECT #3#isom0009;

     |ABRE #isocie62;
     nClave = 547;  |HAZ isom0009;
     nClave = 653;  |HAZ isom0009;  ||Esto es solo para el 2008 viene del 225
     nClave = 694;  |HAZ isom0009;  ||Esto es solo para el 2008 viene del 225
     |CIERRA #isocie62;

     |ABRE #isocie59;
     #isocie59#0 = enEmpresa;
     #isocie59#1 = enAnyo - 1;
     |LEE 000#isocie59.=;
     |SI FSalida ! 0;  |DDEFECTO #isocie59;  |FINSI;
     |CIERRA #isocie59;

     |SI #isocie59#41 < 0;  aAnyo = "  ";  nPendiente = -#isocie59#41;  |HAZ Graba547;  |FINSI;

     |HAZ TotalFich109;

     |SELECT #1#isom0009;
     |CIERRA #isom0009;

     |BUCLE isom0009B;
|FPRC;

|PROCESO isom0009A;
     |SI #anyoant@#4  = "    ";  |ACABA;  |FINSI;
     |SI #anyoant@#10 = 0;       |ACABA;  |FINSI;

     aAnyo      = #anyoant@#4;
     nPendiente = #anyoant@#10;
     |HAZ Graba547;
|FPRC;

|DEFBUCLE isom0009A;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0009A;
|FIN;

|PROCESO BasesNegativasActual;
     enCooperativa = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 17;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 18;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     |CIERRA #maempr11;

     |SI enCooperativa = 1;  |ACABA;  |FINSI;

     nDesde = 0;
     nHasta = 999;
     nAnyo  = enAnyo - 1;
     aAnyo  = enAnyo;

     |ABRE #isom0009;
     |SELECT #1#isom0009;
     |BUCLE isom0507;

     |SELECT #3#isom0009;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0009.mas";
     |CARGA_DEF aMas, anyoant@;

     |BUCLE isom0009A;

     |DESCARGA_DEF #anyoant@;

     |ABRE #isom0001;
     |SELECT #2#isom0001;
     #isom0001#0 = enEmpresa;
     #isom0001#1 = enAnyo - 1;
     #isom0001#3 = "552";
     |LEE 000#isom0001.=;
     |SI FSalida = 0;
         |SI #isom0001#5 < 0;
             aAnyo      = #isom0001#1;
             nPendiente = -#isom0001#5;
             |HAZ Graba547;
         |FINSI;
     |FINSI;
     |CIERRA #isom0001;

     |HAZ TotalFich109;

     |SELECT #1#isom0009;
     |CIERRA #isom0009;

     |BUCLE isom0009B;
|FPRC;

|PROCESO Graba561;
     |SI enAnyo = 2008;
         |SI aAnyo = "  ";
             aAnyo = "2007";
         |SINO;
             nNume = aAnyo;
             |SI nNume ] 93;  |Y nNume [ 99;
                 nNume = 1900 + nNume;
             |SINO;
                 nNume = 2000 + nNume;
             |FINSI;

             aAnyo = nNume;
         |FINSI;

         |SELECT #3#isom0010;
         #isom0010#0 = enEmpresa;
         #isom0010#1 = enAnyo;
         #isom0010#4 = aAnyo;
         |LEE 101#isom0010.=;
         |SI FSalida = 0;
             #isom0010#6  = #isom0010#6  + nPendiente;
             #isom0010#8  = 0;
             |SI #isom0010#9 ! "     ";
                 #isom0010#10 = #isom0010#10 + nPendiente;
             |FINSI;
             |GRABA 020#isom0010.a;
             |LIBERA #isom0010;
             |ACABA;
         |FINSI;

         |SELECT #1#isom0010;
         |PARA nCampo = 1005;  |SI nCampo [ 1065;  |HACIENDO nCampo = nCampo + 5;
             #isom0010#0 = enEmpresa;
             #isom0010#1 = enAnyo;
             #isom0010#2 = nCampo;
             |LEE 101#isom0010.=;
             |SI FSalida = 0;
                 |SI #isom0010#4 = "    ";
                     #isom0010#4  = aAnyo;
                     #isom0010#6  = nPendiente;
                     #isom0010#8  = 0;
                     |SI #isom0010#9 ! "     ";
                         #isom0010#10 = nPendiente;
                     |FINSI;
                     |GRABA 020#isom0010.a;
                     |LIBERA #isom0010;
                     |SAL;
                 |FINSI;
                 |LIBERA #isom0010;
             |FINSI;
         |SIGUE;

         |ACABA;
     |FINSI;

     |SELECT #3#isom0010;
     #isom0010#0 = enEmpresa;
     #isom0010#1 = enAnyo;
     #isom0010#4 = aAnyo;
     |LEE 101#isom0010.=;
     |SI FSalida = 0;
         #isom0010#6  = #isom0010#6  + nPendiente;
         #isom0010#8  = 0;
         |SI #isom0010#9 ! "     ";
             #isom0010#10 = #isom0010#10 + nPendiente;
         |FINSI;
         |GRABA 020#isom0010.a;
         |LIBERA #isom0010;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO isom0010B;
     |SI #isom0010#6  ! 0;  |ACABA;  |FINSI;
     |SI #isom0010#8  ! 0;  |ACABA;  |FINSI;
     |SI #isom0010#10 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0010.a;
     |LIBERA #isom0010;
|FPRC;

|DEFBUCLE isom0010B;
     #isom0010#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0010B;
|FIN;

|PROCESO isom0010;
     enCooperativa = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 17;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 18;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     |CIERRA #maempr11;

     |SI enCooperativa = 0;  |ACABA;  |FINSI;

     #isocie62#0 = enEmpresa;
     #isocie62#1 = enAnyo - 1;
     #isocie62#2 = 561;
     |LEE 000#isocie62.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SI #isocie62#26 = 0;   |ACABA;  |FINSI;

     |SI #isocie62#21 ! 0;  aAnyo = #isocie62#4;   nPendiente = #isocie62#21;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#22 ! 0;  aAnyo = #isocie62#5;   nPendiente = #isocie62#22;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#23 ! 0;  aAnyo = #isocie62#6;   nPendiente = #isocie62#23;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#24 ! 0;  aAnyo = #isocie62#7;   nPendiente = #isocie62#24;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#25 ! 0;  aAnyo = #isocie62#8;   nPendiente = #isocie62#25;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#30 ! 0;  aAnyo = #isocie62#27;  nPendiente = #isocie62#30;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#34 ! 0;  aAnyo = #isocie62#31;  nPendiente = #isocie62#34;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#38 ! 0;  aAnyo = #isocie62#35;  nPendiente = #isocie62#38;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#42 ! 0;  aAnyo = #isocie62#39;  nPendiente = #isocie62#42;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#46 ! 0;  aAnyo = #isocie62#43;  nPendiente = #isocie62#46;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#50 ! 0;  aAnyo = #isocie62#47;  nPendiente = #isocie62#50;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#54 ! 0;  aAnyo = #isocie62#51;  nPendiente = #isocie62#54;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#58 ! 0;  aAnyo = #isocie62#55;  nPendiente = #isocie62#58;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#62 ! 0;  aAnyo = #isocie62#59;  nPendiente = #isocie62#62;  |HAZ Graba561;  |FINSI;
     |SI #isocie62#66 ! 0;  aAnyo = #isocie62#63;  nPendiente = #isocie62#66;  |HAZ Graba561;  |FINSI;
|FPRC;

|PROCESO CuotasNegativas2008;
     nDesde = 1000;
     nHasta = 9999;

     |ABRE #isom0010;
     |SELECT #1#isom0010;
     |BUCLE isom0507;

     |ABRE #isocie62;
     |HAZ isom0010;
     |CIERRA #isocie62;

     |ABRE #isocie59;
     #isocie59#0 = enEmpresa;
     #isocie59#1 = enAnyo - 1;
     |LEE 000#isocie59.=;
     |SI FSalida ! 0;  |DDEFECTO #isocie59;  |FINSI;
     |CIERRA #isocie59;

     |SI #isocie59#48 < 0;  aAnyo = "  ";  nPendiente = -#isocie59#48;  |HAZ Graba561;  |FINSI;

     |HAZ TotalFich110;

     |SELECT #1#isom0010;
     |CIERRA #isom0010;

     |BUCLE isom0010B;
|FPRC;

|PROCESO isom0010A;
     |SI #anyoant@#4  = "    ";  |ACABA;  |FINSI;
     |SI #anyoant@#10 = 0;       |ACABA;  |FINSI;

     aAnyo      = #anyoant@#4;
     nPendiente = #anyoant@#10;
     |HAZ Graba561;
|FPRC;

|DEFBUCLE isom0010A;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0010A;
|FIN;

|PROCESO CuotasNegativasActual;
     nDesde = 1000;
     nHasta = 9999;
     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |ABRE #isom0010;
     |SELECT #1#isom0010;
     |BUCLE isom0507;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0010.mas";
     |CARGA_DEF aMas, anyoant@;

     |BUCLE isom0010A;

     |DESCARGA_DEF #anyoant@;

     |ABRE #isom0001;
     |SELECT #2#isom0001;
     #isom0001#0 = enEmpresa;
     #isom0001#1 = enAnyo - 1;
     #isom0001#3 = "560";
     |LEE 000#isom0001.=;
     |SI FSalida = 0;
         |SI #isom0001#5 < 0;
             aAnyo      = #isom0001#1;
             nPendiente = -#isom0001#5;
             |HAZ Graba561;
         |FINSI;
     |FINSI;
     |CIERRA #isom0001;

     |HAZ TotalFich110;

     |SELECT #1#isom0010;
     |CIERRA #isom0010;

     |BUCLE isom0010B;
|FPRC;

|PROCESO isom0509;
     #isom0012#0  = enEmpresa;
     #isom0012#1  = #isom0509#0;
     #isom0012#2  = #isom0509#1;
     |LEE 101#isom0012.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0012;
         #isom0012#0  = enEmpresa;
         #isom0012#1  = #isom0509#0;
         #isom0012#2  = #isom0509#1;
         |GRABA 020#isom0012.b;
     |FINSI;

     #isom0012#3   = #isom0509#7;
     #isom0012#4   = #isom0509#2;
     #isom0012#5   = 0;
     #isom0012#6   = #isom0509#3;
     #isom0012#7   = 0;
     #isom0012#8   = #isom0509#4;
     #isom0012#9   = 0;
     #isom0012#10  = #isom0509#5;
     #isom0012#11  = 0;
     #isom0012#12  = #isom0509#6;
     #isom0012#13  = 0;
     |GRABA 020#isom0012.a;
     |LIBERA #isom0012;
|FPRC;

|DEFBUCLE isom0509;
     #isom0509#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0509;
|FIN;

|PROCESO GrabaImpo;
     #isom0012#0 = enEmpresa;
     #isom0012#1 = enAnyo;
     #isom0012#4 = aCasilla;
     |LEE 101#isom0012.=;
     |SI FSalida = 0;
         #isom0012#5 = nPendiente;
         |GRABA 020#isom0012.a;
         |LIBERA #isom0012;
     |FINSI;
|FPRC;

|PROCESO isom0012B;
     |SI #isom0012#5   ! 0;  |ACABA;  |FINSI;
     |SI #isom0012#9   ! 0;  |ACABA;  |FINSI;
     |SI #isom0012#11  ! 0;  |ACABA;  |FINSI;
     |SI #isom0012#13  ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0012.a;
     |LIBERA #isom0012;
|FPRC;

|DEFBUCLE isom0012B;
     #isom0012#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0012B;
|FIN;

|PROCESO Imposicion2008;
     |ABRE #isocie75;
     #isocie75#0 = enEmpresa;
     #isocie75#1 = enAnyo - 1;
     |LEE 000#isocie75.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #isom0012;
     |SELECT #1#isom0012;
     |BUCLE isom0509;

     |SELECT #2#isom0012;

     |SI #isocie75#4  ! 0;  nPendiente = #isocie75#4;   aCasilla = "151";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#7  ! 0;  nPendiente = #isocie75#7;   aCasilla = "101";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#10 ! 0;  nPendiente = #isocie75#10;  aCasilla = "153";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#13 ! 0;  nPendiente = #isocie75#13;  aCasilla = "104";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#16 ! 0;  nPendiente = #isocie75#16;  aCasilla = "154";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#25 ! 0;  nPendiente = #isocie75#25;  aCasilla = "106";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#28 ! 0;  nPendiente = #isocie75#28;  aCasilla = "155";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#31 ! 0;  nPendiente = #isocie75#31;  aCasilla = "108";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#34 ! 0;  nPendiente = #isocie75#34;  aCasilla = "156";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#37 ! 0;  nPendiente = #isocie75#37;  aCasilla = "110";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#40 ! 0;  nPendiente = #isocie75#40;  aCasilla = "157";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#49 ! 0;  nPendiente = #isocie75#49;  aCasilla = "112";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#52 ! 0;  nPendiente = #isocie75#52;  aCasilla = "158";  |HAZ GrabaImpo;  |FINSI;

     |SI #isocie75#19 ! 0;  nPendiente = #isocie75#19;  aCasilla = "114";  |HAZ GrabaImpo;  |FINSI;
     |SI #isocie75#22 ! 0;  nPendiente = #isocie75#22;  aCasilla = "159";  |HAZ GrabaImpo;  |FINSI;

     |HAZ TotalFich112;

     |SELECT #1#isom0012;
     |CIERRA #isom0012;

     |BUCLE isom0012B;
     |CIERRA #isocie75;
|FPRC;

|PROCESO isom0012A;
     |SI #anyoant@#13 = 0;  |ACABA;  |FINSI;

     nPendiente  = #anyoant@#13;
     nLinea      = 0;

     |SI enAnyo = 2009;
         |SI #anyoant@#4 = "104  ";  nLinea = 15;  |FINSI;
         |SI #anyoant@#4 = "106  ";  nLinea = 20;  |FINSI;
         |SI #anyoant@#4 = "108  ";  nLinea = 25;  |FINSI;
         |SI #anyoant@#4 = "110  ";  nLinea = 30;  |FINSI;
         |SI #anyoant@#4 = "112  ";  nLinea = 35;  |FINSI;
         |SI #anyoant@#4 = "114  ";  nLinea = 40;  |FINSI;
         |SI #anyoant@#4 = "119  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "123  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "127  ";  nLinea = 45;  |FINSI;

         |SI #anyoant@#4 = "151  ";  nLinea = 1010;  |FINSI;
         |SI #anyoant@#4 = "153  ";  nLinea = 1015;  |FINSI;
         |SI #anyoant@#4 = "154  ";  nLinea = 1020;  |FINSI;
         |SI #anyoant@#4 = "155  ";  nLinea = 1025;  |FINSI;
         |SI #anyoant@#4 = "156  ";  nLinea = 1030;  |FINSI;
         |SI #anyoant@#4 = "157  ";  nLinea = 1035;  |FINSI;
         |SI #anyoant@#4 = "158  ";  nLinea = 1040;  |FINSI;
         |SI #anyoant@#4 = "159  ";  nLinea = 1045;  |FINSI;
         |SI #anyoant@#4 = "163  ";  nLinea = 1046;  |FINSI;
         |SI #anyoant@#4 = "167  ";  nLinea = 1046;  |FINSI;
     |FINSI;

     |SI enAnyo = 2010;
         |SI #anyoant@#4 = "104  ";  nLinea = 15;  |FINSI;
         |SI #anyoant@#4 = "106  ";  nLinea = 20;  |FINSI;
         |SI #anyoant@#4 = "108  ";  nLinea = 25;  |FINSI;
         |SI #anyoant@#4 = "110  ";  nLinea = 30;  |FINSI;
         |SI #anyoant@#4 = "112  ";  nLinea = 35;  |FINSI;
         |SI #anyoant@#4 = "114  ";  nLinea = 40;  |FINSI;
         |SI #anyoant@#4 = "735  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "119  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "123  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "127  ";  nLinea = 45;  |FINSI;

         |SI #anyoant@#4 = "151  ";  nLinea = 1010;  |FINSI;
         |SI #anyoant@#4 = "153  ";  nLinea = 1015;  |FINSI;
         |SI #anyoant@#4 = "154  ";  nLinea = 1020;  |FINSI;
         |SI #anyoant@#4 = "155  ";  nLinea = 1025;  |FINSI;
         |SI #anyoant@#4 = "156  ";  nLinea = 1030;  |FINSI;
         |SI #anyoant@#4 = "157  ";  nLinea = 1035;  |FINSI;
         |SI #anyoant@#4 = "158  ";  nLinea = 1040;  |FINSI;
         |SI #anyoant@#4 = "159  ";  nLinea = 1045;  |FINSI;
         |SI #anyoant@#4 = "720  ";  nLinea = 1050;  |FINSI;
         |SI #anyoant@#4 = "739  ";  nLinea = 1055;  |FINSI;
         |SI #anyoant@#4 = "163  ";  nLinea = 1055;  |FINSI;
         |SI #anyoant@#4 = "167  ";  nLinea = 1055;  |FINSI;
     |FINSI;

     |SI enAnyo ] 2011;
         |SI #anyoant@#4 = "104  ";  nLinea = 15;  |FINSI;
         |SI #anyoant@#4 = "106  ";  nLinea = 20;  |FINSI;
         |SI #anyoant@#4 = "108  ";  nLinea = 25;  |FINSI;
         |SI #anyoant@#4 = "110  ";  nLinea = 30;  |FINSI;
         |SI #anyoant@#4 = "112  ";  nLinea = 35;  |FINSI;
         |SI #anyoant@#4 = "114  ";  nLinea = 40;  |FINSI;
         |SI #anyoant@#4 = "735  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "119  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "123  ";  nLinea = 45;  |FINSI;
         |SI #anyoant@#4 = "127  ";  nLinea = 45;  |FINSI;

         |SI #anyoant@#4 = "153  ";  nLinea = 1010;  |FINSI;
         |SI #anyoant@#4 = "154  ";  nLinea = 1015;  |FINSI;
         |SI #anyoant@#4 = "155  ";  nLinea = 1020;  |FINSI;
         |SI #anyoant@#4 = "156  ";  nLinea = 1025;  |FINSI;
         |SI #anyoant@#4 = "157  ";  nLinea = 1030;  |FINSI;
         |SI #anyoant@#4 = "158  ";  nLinea = 1035;  |FINSI;
         |SI #anyoant@#4 = "159  ";  nLinea = 1040;  |FINSI;
         |SI #anyoant@#4 = "720  ";  nLinea = 1045;  |FINSI;
         |SI #anyoant@#4 = "739  ";  nLinea = 1050;  |FINSI;
         |SI #anyoant@#4 = "134  ";  nLinea = 1055;  |FINSI;
         |SI #anyoant@#4 = "163  ";  nLinea = 1055;  |FINSI;
         |SI #anyoant@#4 = "167  ";  nLinea = 1055;  |FINSI;
     |FINSI;

     |SI enAnyo ] 2016;
         |SI #anyoant@#4 = "104  ";  nLinea = 15;  |FINSI;
         |SI #anyoant@#4 = "106  ";  nLinea = 20;  |FINSI;
         |SI #anyoant@#4 = "108  ";  nLinea = 25;  |FINSI;
         |SI #anyoant@#4 = "110  ";  nLinea = 30;  |FINSI;
         |SI #anyoant@#4 = "112  ";  nLinea = 35;  |FINSI;
         |SI #anyoant@#4 = "114  ";  nLinea = 40;  |FINSI;
         |SI #anyoant@#4 = "735  ";  nLinea = 45;  |FINSI;

         |SI #anyoant@#4 = "153  ";  nLinea = 1010;  |FINSI;
         |SI #anyoant@#4 = "154  ";  nLinea = 1015;  |FINSI;
         |SI #anyoant@#4 = "155  ";  nLinea = 1020;  |FINSI;
         |SI #anyoant@#4 = "156  ";  nLinea = 1025;  |FINSI;
         |SI #anyoant@#4 = "157  ";  nLinea = 1030;  |FINSI;
         |SI #anyoant@#4 = "158  ";  nLinea = 1035;  |FINSI;
         |SI #anyoant@#4 = "159  ";  nLinea = 1040;  |FINSI;
         |SI #anyoant@#4 = "720  ";  nLinea = 1045;  |FINSI;
         |SI #anyoant@#4 = "739  ";  nLinea = 1050;  |FINSI;
         |SI #anyoant@#4 = "134  ";  nLinea = 1055;  |FINSI;
     |FINSI;

     |SI nLinea = 0;  |ACABA;   |FINSI;

     #isom0012#0 = enEmpresa;
     #isom0012#1 = enAnyo;
     #isom0012#2 = nLinea;
     |LEE 101#isom0012.=;
     |SI FSalida = 0;
         #isom0012#5 = #isom0012#5 + nPendiente;
         |GRABA 020#isom0012.a;
         |LIBERA #isom0012;
     |FINSI;
|FPRC;

|DEFBUCLE isom0012A;
     #anyoant@#1003;
     ;
     enEmpresa, nAnyo, 0000;
     enEmpresa, nAnyo, 9999;
     ;
     NULL, isom0012A;
|FIN;

|PROCESO ImposicionActual;
     |ABRE #isom0012;
     |SELECT #1#isom0012;
     |BUCLE isom0509;

     |SELECT #1#isom0012;

     aAnyo  = enAnyo;
     nAnyo  = enAnyo - 1;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom0012.mas";
     |CARGA_DEF aMas, anyoant@;

     |BUCLE isom0012A;

     |DESCARGA_DEF #anyoant@;

     |HAZ TotalFich112;

     |SELECT #1#isom0012;
     |CIERRA #isom0012;

     |BUCLE isom0012B;
     |CIERRA #isocie75;
|FPRC;
