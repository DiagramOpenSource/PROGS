|FICHEROS;
     zhazdocu #0;
     zhazcrea #2;
     zregubic #3;

     zregdocu #1;
     zregfirm #4;
     zpcuadro #5;
     zocuadro #6;
     zqcuadro #7;

     zcuadros@;

     zregpres #107,MANTE;

     megwordl #801;

     :/agicli/def/agim0019 #619;
     :/agicli/def/agim0135 #635;
     :/agicli/def/agim0028 #628;
     :/agicli/def/agim0024 #624;
     :/agicli/def/agim0026 #626;
     :/agicli/def/agicontr #600;
|FIN;

|VARIABLES;
     fFecha     = @;

     aAlfa       = "";
     aAlfa1      = "";
     aEsc1       = "";
     aEsc2       = "";
     aRetu       = "";
     aTecla      = "";
     aRuta       = "";
     aLong       = "";
     aIPRemoto   = "";
     aBase       = "";
     aDirPatron  = "";
     aDirInsta   = "";
     aOrigen     = "";
     aDestino    = "";
     aFichero    = "";
     aTipoInstala = "";

     aDef         = "";
     aMas         = "";

     nCuadro    = 0;
     nLong      = 0;
     nCarac     = 0;
     nPos       = 0;
     nGrid      = 0;
     nRango     = 0;
     nPanta0    = 0;
     nPanta3    = 0;
     nPanta107  = 0;
     nBoton1    = 0;
     nBoton2    = 0;
     nBoton3    = 0;
     nBoton4    = 0;
     nBoton5    = 0;
     nBoton6    = 0;
     nBoton7    = 0;
     nBotonDep1 = -1;
     nBotonDep2 = -1;
     nBotonSal  = 0;
     nSalir     = 0;
     nVent      = 0;
     nVentana   = 0;
     nHandle    = 0;
     nMensa     = 0;
     nEjer      = 0;

     {20} aPopup      = "";
     {40} aSubPopup   = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     nInstalo         = 0;
     aAnyo            = "";

     &enModo          = 0;
     &eaFichero       = "";
     &enPersonaliza   = 0;
     &eaPathIntegral  = 0;
     &enEjercicio     = 0;
     &eaDSMAC         = "";
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;
     &enUltCoop       = 0;
     &enUltCert       = 0;
|FIN;

|PROCESO CopiaPatron;
     aOrigen    = aDirPatron + aFichero;
     aDestino   = aDirInsta  + aFichero;
     |COPIA_FICHERO aOrigen, aDestino;
|FPRC;

|PROCESO InstalaMemoriaP;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     |SI #0#0 = 2008;
         aFichero   = "memor001.doc";  |HAZ CopiaPatron;
         |ACABA;
     |FINSI;

     |SI #0#0 = 2009;
         aFichero   = "memo2009.doc";  |HAZ CopiaPatron;
         |ACABA;
     |FINSI;

     nEjer = #0#0;
     |SI nEjer > enUltMemP; nEjer = enUltMemP;  |FINSI;

     aFichero   = "mem" + nEjer + "p.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaMemoriaA;
     |SI #0#0 [ 2009;  |ACABA;  |FINSI;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #0#0;
     |SI nEjer > enUltMemA; nEjer = enUltMemA;  |FINSI;

     aFichero   = "mem" + nEjer + "a.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaMemoriaC;
     |SI #0#0 [ 2010;  |ACABA;  |FINSI;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #0#0;
     |SI nEjer > enUltMemC; nEjer = enUltMemC;  |FINSI;

     aFichero   = "mem" + nEjer + "c.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaGestion;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento del informe de gesti¢n ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/gestion";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "gesti001.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaActas;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de los certificados ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "cert0101.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0102.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0103.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0201.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0202.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0203.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0301.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0401.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0402.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0403.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0501.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0502.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0503.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0601.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0602.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0603.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0701.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0702.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0703.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0800.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0801.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0802.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0803.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0901.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1001.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1002.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1003.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1004.doc";  |HAZ CopiaPatron;

     |SI aTipoInstala ! "ACTAS16";
         aAnyo = "17"; |HAZ InsActasAnyo;
         aAnyo = "18"; |HAZ InsActasAnyo;
         aAnyo = "19"; |HAZ InsActasAnyo;
     |FINSI;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InstalaActasAny;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de los certificados ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltCert; nEjer = enUltCert;  |FINSI;
     |SI nEjer < 2017; |ACABA; |FINSI;

     aAnyo = nEjer; aAnyo = aAnyo % -102;
     |HAZ InsActasAnyo;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InsActasAnyo;
     aFichero   = "veract03.txt";  |HAZ CopiaPatron;

     aFichero   = "cer" + aAnyo + "01p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "01c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "01n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "03s.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "09s.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10n.doc";  |HAZ CopiaPatron;
|FPRC;

|PROCESO InstalaCuadroP;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zpcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroA;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zocuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroC;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zqcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCooperativa;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de las cuentas anuales de cooperativas ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/cuentas";         |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #0#0;
     |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

     |SI nEjer < 2012;
         |SI nEjer [ 2010;
             aFichero   = "cacoop21.doc";  |HAZ CopiaPatron;
             aFichero   = "cacoop22.doc";  |HAZ CopiaPatron;
         |SINO;
             aFichero   = nEjer + "cp21.doc";  |HAZ CopiaPatron;
             aFichero   = nEjer + "cp22.doc";  |HAZ CopiaPatron;
         |FINSI;
     |FINSI;

     aFichero   = nEjer + "cp31.doc";  |HAZ CopiaPatron;
     aFichero   = nEjer + "cp32.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InstalaCarpeta;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento Formulario carpeta Registro ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "porta001.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaTodo;
     nMensa     = 0;

     |HAZ InstalaMemoriaP;
     |HAZ InstalaMemoriaA;
     |HAZ InstalaMemoriaC;
     |HAZ InstalaGestion;
     |HAZ InstalaActas;
     |HAZ InstalaCuadroP;
     |HAZ InstalaCuadroA;
     |HAZ InstalaCuadroC;
     |HAZ InstalaCooperativa;
     |HAZ InstalaCarpeta;
|FPRC;

|PROCESO InstalaPatrones;
     |DBASE aBase;  |QBF aBase;
     aDirPatron = aBase + "planilla/";
     aFichero   = aDirPatron + "dcpatron.tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + "dcpatron.tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |SI aTipoInstala = "TODO";          |HAZ InstalaTodo;          |FINSI;
     |SI aTipoInstala = "MEMORIAP";      |HAZ InstalaMemoriaP;      |FINSI;
     |SI aTipoInstala = "MEMORIAA";      |HAZ InstalaMemoriaA;      |FINSI;
     |SI aTipoInstala = "MEMORIAC";      |HAZ InstalaMemoriaC;      |FINSI;
     |SI aTipoInstala = "GESTION";       |HAZ InstalaGestion;       |FINSI;
     |SI aTipoInstala = "ACTAS";         |HAZ InstalaActas;         |FINSI;
     |SI aTipoInstala = "ACTAS16";       |HAZ InstalaActas;         |FINSI;
     |SI aTipoInstala = "ACTASANY";      |HAZ InstalaActasAny;     |FINSI;
     |SI aTipoInstala = "CUADROP";       |HAZ InstalaCuadroP;       |FINSI;
     |SI aTipoInstala = "CUADROA";       |HAZ InstalaCuadroA;       |FINSI;
     |SI aTipoInstala = "CUADROC";       |HAZ InstalaCuadroC;       |FINSI;
     |SI aTipoInstala = "COOPERATIVA";   |HAZ InstalaCooperativa;   |FINSI;
     |SI aTipoInstala = "CARPETA"        |HAZ InstalaCarpeta;       |FINSI;

     aAlfa = aDirPatron + "memor001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "memo2009.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0101.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0102.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0103.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0201.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0202.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0203.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0301.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0401.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0402.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0403.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0501.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0502.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0503.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0601.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0602.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0603.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0701.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0702.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0703.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0800.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0801.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0802.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0803.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0901.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1002.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1003.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1004.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "gesti001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "porta001.doc";  |FBORRA aAlfa;

     aAnyo = "17"; |HAZ BActayCerti;
     aAnyo = "18"; |HAZ BActayCerti;
     aAnyo = "19"; |HAZ BActayCerti;

     |PULSATECLA;
|FPRC;

|PROCESO  BActayCerti;
     aAlfa = aDirPatron + "cer" + aAnyo + "01p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "03s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "09s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10n.doc";  |FBORRA aAlfa;

|FPRC;

|PROCESO EventoGrid;
     |SI FSalida = 1;  |O FSalida = 2;
         |ESTADO_CONTROL nBoton3, "DISABLE";
         |ESTADO_CONTROL nBoton7, "DISABLE";
         |LEE 000#1=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nBoton3, "ENABLE";
             |ESTADO_CONTROL nBoton7, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO zregfirmB;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE zregfirmB;
     #4#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, zregfirmB;
|FIN;

|PROCESO megwordlB;
     |DBASE aAlfa;   |QBT aAlfa;
     aAlfa = aAlfa + "emisiones/" + (("00000" + #801#0) % -105) + "/" + #801#1;
     aAlfa = aAlfa + "/" + #801#2;  |QBT aAlfa;
     |FBORRA aAlfa;

     |BORRA 020#801a;
     |LIBERA #801;
|FPRC;

|DEFBUCLE megwordlB;
     #801#1;
     ;
     #1#0, #1#1, "           ";
     #1#0, #1#1, "zzzzzzzzzzz";
     ;
     NULL, megwordlB;
|FIN;

|PROCESO BorraRegCuadro;
     |DDEF aDef;
     aDef = aDef + aMas;
     |CARGA_DEF aDef, zcuadros@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #zcuadros@;
     #zcuadros@#0 = #zregdocu#0;
     #zcuadros@#1 = #zregdocu#1;
     #zcuadros@#2 = 1;
     |LEE 101#zcuadros@.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #zcuadros@#0 ! #zregdocu#0;  |O #zcuadros@#1 ! #zregdocu#1;
              |SAL;
          |FINSI;

          |BORRA 000#zcuadros@.a;
          |LIBERA #zcuadros@;

          |LEE 101#zcuadros@.s;
     |SIGUE;
     |CIERRA #zcuadros@;

     |DESCARGA_DEF #zcuadros@;
|FPRC;

|PROCESO BorraCuadros;
     |PARA nCuadro = 1;  |SI nCuadro [ 33;  |HACIENDO nCuadro = nCuadro + 1;
           aMas = "zregcu" + (("00" + nCuadro) % -102);
           |HAZ BorraRegCuadro;
     |SIGUE;
|FPRC;

|PROCESO Boton7;
     |LEE 101#1=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NEst  seguro que quiere el borrar el registro seleccionado";
     |SI FSalida ! 0;  |LIBERA #1;  |ACABA;  |FINSI;

     |HAZ BorraCuadros;

     |BUCLE zregfirmB;
     |BUCLE megwordlB;

     |BORRA 020#1a;
     |LIBERA #1;

     |PULSATECLA;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Boton6;
     |VENTANA 0501, 1799, -1, 16, "Datos presentante";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |ABRE #107;
     #107#0 = #0#0;
     |LEE 101#107=;
     |SI FSalida ! 0;
         |DDEFECTO #107;
         #107#0 = #0#0;
         |GRABA 020#107b;
     |FINSI;

     |PINPA #0#107;
     nPanta107 = FSalida;

     |PINDA #0#107;
     |ENDATOS #1#107;
     |SI FSalida = 0;
         |GRABA 020#107a;
     |FINSI;
     |LIBERA #107;
     |CIERRA #107;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVent;

     |PULSATECLA;
|FPRC;

|PROCESO Baja5;
     #5#0 = #0#0;
     #5#1 = 1;
|FPRC;

|PROCESO Alta5;
     #5#0 = #0#0;
     #5#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroP;
     |SI #zhazdocu#0 > enUltMemP;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros PYME";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #5;
     |LINEAL_SIMPLE #1#5, nRango, 0502, 2159, Baja5, Alta5, NULL;
     |CIERRA #5;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Baja6;
     #6#0 = #0#0;
     #6#1 = 1;
|FPRC;

|PROCESO Alta6;
     #6#0 = #0#0;
     #6#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroA;
     |SI #zhazdocu#0 > enUltMemA;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros abreviada";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #6;
     |LINEAL_SIMPLE #1#6, nRango, 0502, 2159, Baja6, Alta6, NULL;
     |CIERRA #6;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Baja7;
     #7#0 = #0#0;
     #7#1 = 1;
|FPRC;

|PROCESO Alta7;
     #7#0 = #0#0;
     #7#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroC;
     |SI #zhazdocu#0 > enUltMemC;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros de cooperativas";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #7;
     |LINEAL_SIMPLE #1#7, nRango, 0502, 2159, Baja7, Alta7, NULL;
     |CIERRA #7;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO PatronesMemoria2009;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 5;
     aSubPopup3  = "1.- Instalar documento de la aplicacion";
     aSubPopup4  = "2.- Editar documento de la memoria PYME";
     aSubPopup5  = "3.- Instalar plantilla de la carga automatica de los cuadros";
     aSubPopup6  = "4.- Editar plantilla de la carga automatica de los cuadros";
     aSubPopup7  = "5.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1        = aSubPopup % 101;
              enPersonaliza = 0;
              nMensa        = 1;

              |SI aAlfa1 = "1";  aTipoInstala = "MEMORIAP"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "2";  |HAZ EditaMemoPatronPYME;                       |FINSI;
              |SI aAlfa1 = "3";  aTipoInstala = "CUADROP";  |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "4";  |HAZ PlantillaCuadroP;                |FINSI;
              |SI aAlfa1 = "5";  |SAL;                                 |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesMemoria2010;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 9;
     aSubPopup3  = "1.- Instalar documento de la memoria PYME";
     aSubPopup4  = "2.- Instalar documento de la memoria abreviada";
     aSubPopup5  = "3.- Editar documento de la memoria PYME";
     aSubPopup6  = "4.- Editar documento de la memoria abreviada";
     aSubPopup7  = "5.- Instalar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup8  = "6.- Instalar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup9  = "7.- Editar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup10 = "8.- Editar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup11 = "9.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1        = aSubPopup % 101;
              enPersonaliza = 0;
              nMensa        = 1;

              |SI aAlfa1 = "1";  aTipoInstala = "MEMORIAP"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "2";  aTipoInstala = "MEMORIAA"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "3";  |HAZ EditaMemoPatronPYME;                        |FINSI;
              |SI aAlfa1 = "4";  |HAZ EditaMemoPatronAbreviada;                   |FINSI;
              |SI aAlfa1 = "5";  aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "6";  aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "7";  |HAZ PlantillaCuadroP;                           |FINSI;
              |SI aAlfa1 = "8";  |HAZ PlantillaCuadroA;                           |FINSI;
              |SI aAlfa1 = "9";  |SAL;                                            |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesMemoria2011;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 13;
     aSubPopup3  = "01.- Instalar documento de la memoria PYME";
     aSubPopup4  = "02.- Instalar documento de la memoria abreviada";
     aSubPopup5  = "03.- Instalar documento de la memoria de cooperativas";
     aSubPopup6  = "04.- Editar documento de la memoria PYME";
     aSubPopup7  = "05.- Editar documento de la memoria abreviada";
     aSubPopup8  = "06.- Editar documento de la memoria de cooperativas";
     aSubPopup9  = "07.- Instalar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup10 = "08.- Instalar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup11 = "09.- Instalar plantilla de la carga automatica de los cuadros de cooperativas";
     aSubPopup12 = "10.- Editar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup13 = "11.- Editar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup14 = "12.- Editar plantilla de la carga automatica de los cuadros de cooperativas";
     aSubPopup15 = "13.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1        = aSubPopup % 102;
              enPersonaliza = 0;
              nMensa        = 1;

              |SI aAlfa1 = "01";  aTipoInstala = "MEMORIAP"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "02";  aTipoInstala = "MEMORIAA"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "03";  aTipoInstala = "MEMORIAC"; |HAZ InstalaPatrones; |FINSI;
              |SI aAlfa1 = "04";  |HAZ EditaMemoPatronPYME;                        |FINSI;
              |SI aAlfa1 = "05";  |HAZ EditaMemoPatronAbreviada;                   |FINSI;
              |SI aAlfa1 = "06";  |HAZ EditaMemoPatronCooperativa;                   |FINSI;
              |SI aAlfa1 = "07";  aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "08";  aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "09";  aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "10";  |HAZ PlantillaCuadroP;                           |FINSI;
              |SI aAlfa1 = "11";  |HAZ PlantillaCuadroA;                           |FINSI;
              |SI aAlfa1 = "12";  |HAZ PlantillaCuadroC;                           |FINSI;
              |SI aAlfa1 = "13";  |SAL;                                            |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesMemoria;
     |SI #0#0 [ 2009;  |HAZ PatronesMemoria2009;  |FINSI;
     |SI #0#0 = 2010;  |HAZ PatronesMemoria2010;  |FINSI;
     |SI #0#0 ] 2011;  |HAZ PatronesMemoria2011;  |FINSI;
|FPRC;

|PROCESO PatronesGestion;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 3;
     aSubPopup3  = "1.- Instalar documento de la aplicacion";
     aSubPopup4  = "2.- Editar documento del informe de gestion";
     aSubPopup5  = "3.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1        = aSubPopup % 101;
              enPersonaliza = 0;
              nMensa        = 1;

              |SI aAlfa1 = "1";  aTipoInstala = "GESTION";  |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "2";  |HAZ EditaGestiPatron;                |FINSI;
              |SI aAlfa1 = "3";  |SAL;                                 |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesCertificados;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 28;
     aSubPopup3  = "01.- Instalar documento de la aplicacion";
     aSubPopup4  = "02.- Editar documento Junta no universal abreviada (Resultado > 0)";
     aSubPopup5  = "03.- Editar documento Junta no universal abreviada (Resultado = 0)";
     aSubPopup6  = "04.- Editar documento Junta no universal abreviada (Resultado < 0)";
     aSubPopup7  = "05.- Editar documento Junta no universal normal (Resultado > 0)";
     aSubPopup8  = "06.- Editar documento Junta no universal normal (Resultado = 0)";
     aSubPopup9  = "07.- Editar documento Junta no universal normal (Resultado < 0)";
     aSubPopup10 = "08.- Editar documento Junta no universal sin aprobacion";
     aSubPopup11 = "09.- Editar documento Junta universal abreviada (Resultado > 0)";
     aSubPopup12 = "10.- Editar documento Junta universal abreviada (Resultado = 0)";
     aSubPopup13 = "11.- Editar documento Junta universal abreviada (Resultado < 0)";
     aSubPopup14 = "12.- Editar documento Junta universal normal (Resultado > 0)";
     aSubPopup15 = "13.- Editar documento Junta universal normal (Resultado = 0)";
     aSubPopup16 = "14.- Editar documento Junta universal normal (Resultado < 0)";
     aSubPopup17 = "15.- Editar documento Junta universal transparencia fiscal abreviada (Resultado > 0)";
     aSubPopup18 = "16.- Editar documento Junta universal transparencia fiscal abreviada (Resultado = 0)";
     aSubPopup19 = "17.- Editar documento Junta universal transparencia fiscal abreviada (Resultado < 0)";
     aSubPopup20 = "18.- Editar documento Junta universal transparencia fiscal normal (Resultado > 0)";
     aSubPopup21 = "19.- Editar documento Junta universal transparencia fiscal normal (Resultado = 0)";
     aSubPopup22 = "20.- Editar documento Junta universal transparencia fiscal normal (Resultado < 0)";
     aSubPopup23 = "21.- Editar documento Junta universal unipersonal (Resultado > 0)";
     aSubPopup24 = "22.- Editar documento Junta universal unipersonal (Resultado = 0)";
     aSubPopup25 = "23.- Editar documento Junta universal unipersonal (Resultado < 0)";
     aSubPopup26 = "24.- Editar documento Junta universal sin aprobacion";
     aSubPopup27 = "25.- Editar documento Asamblea cooperativas (Resultado > 0)";
     aSubPopup28 = "26.- Editar documento Asamblea cooperativas  (Resultado = 0)";
     aSubPopup29 = "27.- Editar documento Asamblea cooperativas  (Resultado < 0)";
     aSubPopup30 = "28.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1 = aSubPopup % 102;
              nMensa = 1;

              |SI aAlfa1 = "01";
                 |SI #zhazdocu#0 ] 2017;
                     aTipoInstala = "ACTASANY";
                 |SINO;
                    aTipoInstala = "ACTAS16";
                 |FINSI;
                  |HAZ InstalaPatrones;
              |FINSI;
              |SI aAlfa1 = "02";  eaFichero  = "cert0101.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "03";  eaFichero  = "cert0102.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "04";  eaFichero  = "cert0103.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "05";  eaFichero  = "cert0201.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "06";  eaFichero  = "cert0202.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "07";  eaFichero  = "cert0203.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "08";  eaFichero  = "cert0301.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "09";  eaFichero  = "cert0401.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "10";  eaFichero  = "cert0402.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "11";  eaFichero  = "cert0403.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "12";  eaFichero  = "cert0501.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "13";  eaFichero  = "cert0502.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "14";  eaFichero  = "cert0503.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "15";  eaFichero  = "cert0601.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "16";  eaFichero  = "cert0602.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "17";  eaFichero  = "cert0603.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "18";  eaFichero  = "cert0701.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "19";  eaFichero  = "cert0702.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "20";  eaFichero  = "cert0703.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "21";  eaFichero  = "cert0801.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "22";  eaFichero  = "cert0802.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "23";  eaFichero  = "cert0803.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "24";  eaFichero  = "cert0901.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "26";  eaFichero  = "cert1002.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "27";  eaFichero  = "cert1003.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "25";
                  |SI #0#0 [ 2010;  eaFichero  = "cert1001.doc";  |FINSI;
                  |SI #0#0 ] 2011;  eaFichero  = "cert1004.doc";  |FINSI;
                  |HAZ EditaCertPatron;
              |FINSI;
              |SI aAlfa1 = "28";  |SAL;                           |FINSI;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesCuentas;
     |SI #0#0 [ 2010;
         aSubPopup1  = nBoton5;
         aSubPopup2  = 4;
         aSubPopup3  = "01.- Instalar documento de la aplicacion";
         aSubPopup4  = "02.- Editar documento Cuentas anuales cooperativas PYMES - Balance 21";
         aSubPopup5  = "03.- Editar documento Cuentas anuales cooperativas ABREVIADAS - Balance 22";
         aSubPopup6  = "04.- Salir";

         nEjer = #0#0;
         |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

         |PARA;  |SI;  |HACIENDO;
              IaSubPopup  = aSubPopup1  <-;
              |ESPECIFICA "TRACKPOPUP", aSubPopup;
              |SI FSalida ! 0;
                  IaSubPopup  = aSubPopup3  <-;
                  IaSubPopup  = IaSubPopup + (FSalida - 1);

                  aAlfa1 = aSubPopup % 102;
                  nMensa = 1;

                  |SI aAlfa1 = "01";  aTipoInstala = "COOPERATIVA";     |HAZ InstalaPatrones;  |FINSI;
                  |SI aAlfa1 = "02";  eaFichero  = "cacoop21.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "03";  eaFichero  = "cacoop22.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "04";  |SAL;                                                |FINSI;
              |FINSI;
         |SIGUE;
     |FINSI;

     |SI #0#0 = 2011;
         aSubPopup1  = nBoton5;
         aSubPopup2  = 6;
         aSubPopup3  = "01.- Instalar documento de la aplicacion";
         aSubPopup4  = "02.- Editar documento Cuentas anuales cooperativas PYMES - Balance 21";
         aSubPopup5  = "03.- Editar documento Cuentas anuales cooperativas ABREVIADAS - Balance 22";
         aSubPopup6  = "04.- Editar documento Cuentas anuales cooperativas PYMES - Balance 31";
         aSubPopup7  = "05.- Editar documento Cuentas anuales cooperativas ABREVIADAS - Balance 32";
         aSubPopup8  = "06.- Salir";

         nEjer = #0#0;
         |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

         |PARA;  |SI;  |HACIENDO;
              IaSubPopup  = aSubPopup1  <-;
              |ESPECIFICA "TRACKPOPUP", aSubPopup;
              |SI FSalida ! 0;
                  IaSubPopup  = aSubPopup3  <-;
                  IaSubPopup  = IaSubPopup + (FSalida - 1);

                  aAlfa1 = aSubPopup % 102;
                  nMensa = 1;

                  |SI aAlfa1 = "01";  aTipoInstala = "COOPERATIVA";     |HAZ InstalaPatrones;  |FINSI;
                  |SI aAlfa1 = "02";  eaFichero  = nEjer + "cp21.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "03";  eaFichero  = nEjer + "cp22.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "04";  eaFichero  = nEjer + "cp31.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "05";  eaFichero  = nEjer + "cp32.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "06";  |SAL;                                                |FINSI;
              |FINSI;
         |SIGUE;
     |FINSI;

     |SI #0#0 ] 2012;
         aSubPopup1  = nBoton5;
         aSubPopup2  = 4;
         aSubPopup3  = "01.- Instalar documento de la aplicacion";
         aSubPopup4  = "02.- Editar documento Cuentas anuales cooperativas PYMES - Balance 31";
         aSubPopup5  = "03.- Editar documento Cuentas anuales cooperativas ABREVIADAS - Balance 32";
         aSubPopup6  = "04.- Salir";

         nEjer = #0#0;
         |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

         |PARA;  |SI;  |HACIENDO;
              IaSubPopup  = aSubPopup1  <-;
              |ESPECIFICA "TRACKPOPUP", aSubPopup;
              |SI FSalida ! 0;
                  IaSubPopup  = aSubPopup3  <-;
                  IaSubPopup  = IaSubPopup + (FSalida - 1);

                  aAlfa1 = aSubPopup % 102;
                  nMensa = 1;

                  |SI aAlfa1 = "01";  aTipoInstala = "COOPERATIVA";     |HAZ InstalaPatrones;  |FINSI;
                  |SI aAlfa1 = "02";  eaFichero  = nEjer + "cp31.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "03";  eaFichero  = nEjer + "cp32.doc";  |HAZ EditaCtasPatron;  |FINSI;
                  |SI aAlfa1 = "04";  |SAL;                                                |FINSI;
              |FINSI;
         |SIGUE;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesPortadas;
     aSubPopup1  = nBoton5;
     aSubPopup2  = 3;
     aSubPopup3  = "01.- Instalar documento de la aplicacion";
     aSubPopup4  = "02.- Editar documento Formulario carpeta Registro";
     aSubPopup5  = "03.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1 = aSubPopup % 102;
              nMensa = 1;

              |SI aAlfa1 = "01";  aTipoInstala = "CARPETA";     |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "02";  eaFichero  = "porta001.doc";  |HAZ EditaCertPatron;  |FINSI;
              |SI aAlfa1 = "03";  |SAL;                                                |FINSI;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO Boton5;
     aPopup1  = nBoton5;
     aPopup2  = 6;
     aPopup3  = "1.- Memoria";
     aPopup4  = "2.- Informe de gestion";
     aPopup5  = "3.- Certificados";
     aPopup6  = "4.- Cuentas anuales cooperativas";
     aPopup7  = "5.- Formulario carpeta Registro";
     aPopup8  = "6.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SI aAlfa = "1";  |HAZ PatronesMemoria;       |FINSI;
              |SI aAlfa = "2";  |HAZ PatronesGestion;       |FINSI;
              |SI aAlfa = "3";  |HAZ PatronesCertificados;  |FINSI;
              |SI aAlfa = "4";  |HAZ PatronesCuentas;       |FINSI;
              |SI aAlfa = "5";  |HAZ PatronesPortadas;      |FINSI;
              |SI aAlfa = "6";  |SAL;                       |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO BotonDep1;
     aRuta = "F" + #3#2;  |QBF aRuta;
     |SI aRuta = "F";
         aRuta = "F*.exe";  |QBF aRuta;
     |FINSI;

     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "F";  |ACABA;  |FINSI;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos = (nCarac * 100) + 1;
           aRuta = aRuta + (aAlfa % nPos);
     |SIGUE;

     #3#2 = aRuta;  |PINTA #3#2;
|FPRC;

|PROCESO BotonDep2;
     aRuta = "D";
     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "D";  |ACABA;  |FINSI;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos = (nCarac * 100) + 1;
           aRuta = aRuta + (aAlfa % nPos);
     |SIGUE;

     #3#3 = aRuta;  |PINTA #3#3;
|FPRC;

|PROCESO Boton4;
     enEjercicio = #0#0;
     |HAZ CogeMac;

     aAlfa = "Ubicaciones Dep¢sito Digital MAC: " + eaDSMAC;
     |VENTANA 1001, 1799, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #3;
     #3#0 = #0#0;
     #3#1 = eaDSMAC;
     |LEE 101#3=;
     |SI FSalida ! 0;
         |DDEFECTO #3;
         #3#0 = #0#0;
         #3#1 = eaDSMAC;
         |GRABA 020#3b;
     |FINSI;

     |PINPA #0#3;
     nPanta3 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,{{163}}", 0703, 0705, BotonDep1;
     nBotonDep1 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,{{163}}", 1003, 1005, BotonDep2;
     nBotonDep2 = FSalida;

     |PINDA #0#3;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir";
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |GRABA 020#3a;
     |LIBERA #3;
     |CIERRA #3;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FIN_CONTROL_WINDOWS nBotonDep1;
     |FIN_CONTROL_WINDOWS nBotonDep2;

     |PULSATECLA;

     |FINVENTANA nVent;

     |PULSATECLA;
|FPRC;

|PROCESO Boton3;
     enModo = 2;
     |HAZ zhazcrea;

     |PULSATECLA;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Boton2;
     enModo = 1;
     |HAZ zhazcrea;

     |PULSATECLA;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Baja1;
     #1#0 = 00001;
     #1#1 = #0#0;
|FPRC;

|PROCESO Alta1;
     #1#0 = 99999;
     #1#1 = #0#0;
|FPRC;

|PROCESO Boton1;
     |ENCAMPO #0#0;

     |PULSATECLA;
     |REFRESCACONTROL nGrid;

     |FOCOTECLADO nGrid;
     nSalir = 1;
|FPRC;

|PROCESO CompAvisos;
     |DBASE aBase;  |QBF aBase;
     aAlfa = #0#0;
     aAlfa = aBase + "word/memoria/mem" + aAlfa + "a.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;

         |SI #0#0 [ enUltMemA;
             aAlfa = #0#0;
             |SI #0#0 = enUltMemA;
                  aAlfa1 = "    Error en la Instalacion de";
             |SINO;
                  aAlfa1 = "    Error, no existen";
             |FINSI;
             aAlfa1 = aAlfa1 + " los Documentos Patrones Ejercicio " + aAlfa;
             |MENAV aAlfa1;
             |MENAV "    Pongase en contacto con su distribuidor";
         |FINSI;
         |SI #0#0 > enUltMemA;
             aAlfa = #0#0;
             aAlfa1 = "    No existen los Documentos Patrones Ejercicio " + aAlfa;
             |MENAV aAlfa1;
             aAlfa1 = "    Los Textos se emitiran con el patron del Ejercicio " + enUltMemA;
             |MENAV aAlfa1;
         |FINSI;
         |PULSATECLA;
     |FINSI;

     |SI #0#0 ] 2017;
         aAlfa = #0#0;
         aAlfa = aAlfa % -102;
         aAlfa = aBase + "word/actas/cer" + aAlfa + "10p.doc";
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida < 0;
             |SI #0#0 [ enUltCert;
                 aAlfa = #0#0;
                 |SI #0#0 = enUltCert;
                      aAlfa1 = "    Error en la Instalacion de";
                 |SINO;
                      aAlfa1 = "    Error, no existen";
                 |FINSI;
                 aAlfa1 = aAlfa1 + " los Certificados Patrones Ejercicio " + aAlfa;
                 |MENAV aAlfa1;
                 |MENAV "    Pongase en contacto con su distribuidor";
             |FINSI;

             |SI #0#0 > enUltCert;
                 aAlfa = #0#0;
                 aAlfa1 = "    No existen los Certificados Patrones Ejercicio " + aAlfa;
                 |MENAV aAlfa1;

                 aAlfa1 = "    Los Certificados se emitiran con el patron del Ejercicio " + enUltCert;
                 |MENAV aAlfa1;
             |FINSI;

             |PULSATECLA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
      |ABRE #107;
      #107#0 = #0#0;
      |LEE 000#107=;
      |SI FSalida ! 0;
          #107#0 = #0#0 - 1;
          |LEE 000#107=;
          |SI FSalida = 0;
              #107#0 = #0#0;
              |GRABA 020#107n;
              |LIBERA #107;
          |FINSI;
      |FINSI;
      |CIERRA #107;

      |SI #0#0 > 2009;
          |HAZ CompAvisos;
      |FINSI;
|FPRC;

|PROCESO AyudaColores;
     |VENTANA 0502, 1260, -1, 16, "Ayuda colores GRID";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{16}}Negro", 0603, 0610, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Datos por procesar", 0612, 0659, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Rojo", 0703, 0710, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Falta la memoria o el dep¢sito o las cuentas en papel", 0712, 0759, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Azul", 0803, 0810, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Falta el certificado", 0812, 0859, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Verde", 903, 910, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Todo creado", 0912, 0959, NULL;

     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO MiroCuadro;
   |SI #5#6 = "-"
       nInstalo = 1;
       |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE MiroCuadro;
   #5#1;
   2,3,4;
   2016,    1, 9, 30, "407         ";
   2016, 9999, 9, 30, "407zzzzzzzzz";
   e;
   NULL, MiroCuadro;
|FIN;

|PROGRAMA;

     fFecha    = ~;
     aAlfa     = fFecha % -104;
     #0#0      = aAlfa;
     #0#0      = #0#0 - 1;

     enUltMemA = 2019;
     enUltMemP = 2019;
     enUltMemC = 2019;
     enUltCoop = 2019;
     enUltCert = 2019;

|| Instalacion inicial de documentos para el a¤o actual

     |DBASE aBase;  |QBF aBase;

     aAlfa = aBase + "word/memoria/mem" + enUltMemA + "a.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAA";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/memoria/mem" + enUltMemP + "p.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAP";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/memoria/mem" + enUltMemC + "c.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAC";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/cuentas/" + enUltCoop + "cp31.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "COOPERATIVA";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/actas/veract03.txt";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;

         aTipoInstala = "ACTAS";
         |HAZ InstalaPatrones;
     |FINSI;

     aAnyo  = enUltCert; aAnyo = aAnyo % -102;
     aAlfa = aBase + "word/actas/cer" + aAnyo + "01c.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "ACTASANY";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "fich/zqcuadro.dat";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;
     |FINSI;

     nInstalo = 0;
     |ABRE #5;
     #5#0 = enUltMemA;
     #5#1 = 1;
     |LEE 041#5];
     |SI FSalida ! 0; |O #5#0 ! enUltMemA;
         nInstalo = 1;
     |SINO;
         |CIERRA #5;
         |BUCLE MiroCuadro;
         |ABRE #5;
     |FINSI;
     |CIERRA #5;
     |SI nInstalo = 1;
         nMensa       = 0;
         aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;
     |FINSI;

     |HAZ Tipo0;

     |PINPA #0#0;
     nPanta0 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Ayuda colores", 0550, 0565, AyudaColores;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Cambio de ejercicio", 0520, 0540, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{193}}Nuevo registro", 2802, 2913, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Abrir registro", 2816, 2927, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{207}}Borrar registro", 2830, 2944, Boton7;
     nBoton7 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{136}}Ubicaciones Dep¢sito Digital", 2847, 2966, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Datos presentante", 2869, 2980, Boton6;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{137}}Documentos patrones", 2883, 2998, Boton5;
     nBoton5 = FSalida;

     |ESTADO_CONTROL nBoton3, "DISABLE";
     |ESTADO_CONTROL nBoton7, "DISABLE";

     |PINDA #0#0;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#1, nRango, 0702, 2798, Baja1, Alta1, EventoGrid;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         nSalir  = 0;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu;  |Y nSalir = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;
|FPRO;

|PROCESO zregdocuColor;
     |HAZ PonColor;

     |GRABA 020#zregdocu.a;
     |LIBERA #zregdocu;
|FPRC;

|DEFBUCLE zregdocuColor;
     #zregdocu#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, zregdocuColor;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     |HAZ CargaColores;

     |ABRE #zregdocu;
     |SELECT #2#zregdocu;
     |LEE 000#zregdocu.u;
     |SI FSalida ! 0;  |DDEFECTO #zregdocu;  |FINSI;
     |CIERRA #zregdocu;

     aAlfa = #zregdocu#79;  |QBF aAlfa;
     |SI aAlfa = "";
         |BUCLE zregdocuColor;
     |FINSI;

     |DBASS aAlfa; |QBF aAlfa;
     |PATH_DAT #600 aAlfa;
     |ABRE #600;
     |LEE 040#600p;
     |SI FSalida ! 0;
         #600#8  = aAlfa + "agicli/fich/";
     |FINSI;
     |CIERRA #600;

     aAlfa = #600#8;  |QBF aAlfa;
     |SI aAlfa = "";
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "agicli/fich/";
     |FINSI;

     |PATH_DAT #619 aAlfa;
     |PATH_DAT #635 aAlfa;
     |PATH_DAT #628 aAlfa;
     |PATH_DAT #624 aAlfa;
     |PATH_DAT #626 aAlfa;

     |ABRET #1;

     FSalida = 2899;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #1;
|FPRC;
