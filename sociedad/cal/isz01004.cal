|FICHEROS;
   isz00004 #0;
   isocie11 #1;
   isocie05 #3;
   isocie06 #4;
   isocie07 #5;
   isocie08 #6;
   isocie09 #7;
   isocie10 #8;
   isocie38 #9;
   isocie31 #10;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &tipo    = 0;

     total    = 0;
     tipo_b   = "";
     linea    = 0;
     total_de = 0;
     l_linea  = 0;
     anyo_ant = 0;
     anyo_ded = 0;
     tipo_p   = "";
     casilla_p = 0;
     casilla_a = 0;
|FIN;

||**************************************************************************
||                      PROCESO DE IMPORTACION
||**************************************************************************

|PROCESO resumen;
#10#0 = empresa;
#10#1 = anyo;
|LIBERA #10;
|LEE 140#10=;
|SI FSalida ! 0; |DDEFECTO #10; #10#0 = empresa;  #10#1 = anyo; |FINSI;

casilla_p = casilla_a + 2;
#10casilla_a = #10casilla_a + total;
#10casilla_p = #10casilla_p + total;
|HAZ calcula_10;

|SI FSalida ! 0; |GRABA 140#10n; |SINO; |GRABA 140#10a; |FINSI;
|FPRC;

|PROCESO calcula_10;
#10#014 = #10#002 + #10#005 + #10#008 + #10#011;
#10#015 = #10#003 + #10#006 + #10#009 + #10#012;
#10#016 = #10#004 + #10#007 + #10#010 + #10#013;

#10#035 = #10#017 + #10#020 + #10#023 + #10#026 + #10#029 + #10#032;
#10#036 = #10#018 + #10#021 + #10#024 + #10#027 + #10#030 + #10#033;
#10#037 = #10#019 + #10#022 + #10#025 + #10#028 + #10#031 + #10#034;

#10#038 = #10#014 + #10#035;
#10#039 = #10#015 + #10#036;
#10#040 = #10#016 + #10#037;

#10#059 = #10#041 + #10#044 + #10#047 + #10#050 + #10#053 + #10#56;
#10#060 = #10#042 + #10#045 + #10#048 + #10#051 + #10#054 + #10#57;
#10#061 = #10#043 + #10#046 + #10#049 + #10#052 + #10#055 + #10#58;

#10#077 = #10#065 + #10#068 + #10#071 + #10#074;
#10#078 = #10#066 + #10#069 + #10#072 + #10#075;
#10#079 = #10#067 + #10#070 + #10#073 + #10#076;

#10#095 = #10#083 + #10#086 + #10#089 + #10#092;
#10#096 = #10#084 + #10#087 + #10#090 + #10#093;
#10#097 = #10#085 + #10#088 + #10#091 + #10#094;

#10#107 = #10#098 + #10#101 + #10#104;
#10#108 = #10#099 + #10#102 + #10#105;
#10#109 = #10#100 + #10#103 + #10#106;

#10#128 = #10#110 + #10#113 + #10#116 + #10#119 + #10#122 + #10#125;
#10#129 = #10#111 + #10#114 + #10#117 + #10#120 + #10#123 + #10#126;
#10#130 = #10#112 + #10#115 + #10#118 + #10#121 + #10#124 + #10#127;

#10#137 = #10#131 + #10#134;
#10#138 = #10#132 + #10#135;
#10#139 = #10#133 + #10#136;

#10#146 = #10#140 + #10#143;
#10#147 = #10#141 + #10#144;
#10#148 = #10#142 + #10#145;
|FPRC;

|PROCESO el_05;
|SI total_de = 0; |ACABA; |FINSI;
l_linea = #3#2;
|SI #3#7 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #3#7;
    #3#1 = anyo;
    #3#2 = linea;
    |GRABA 140#3n;
    |LIBERA #3;
|SINO;
    linea    = linea + 1;
    #3#1 = anyo;
    #3#2 = linea;
    #3#7 = total_de;
    |GRABA 140#3n;
    |LIBERA #3;
    total_de = 0;
|FINSI;
total = #3#7;
|SI anyo_ded = 88; casilla_a = 2;  |FINSI;
|SI anyo_ded = 89; casilla_a = 8;  |FINSI;
|SI anyo_ded = 90; casilla_a = 17; |FINSI;
|SI anyo_ded = 91; casilla_a = 23; |FINSI;
|SI anyo_ded = 92; casilla_a = 29; |FINSI;

|HAZ resumen;

#3#0 = empresa;
#3#1 = anyo_ant;
#3#2 = l_linea;
|LIBERA #3;
|LEE 140#3=;
|FPRC;

|DEFBUCLE isocie05_s;
#3#1;
3, 8;
empresa, anyo_ant, 001, anyo_ded, "S";
empresa, anyo_ant, 999, anyo_ded, "S";
be;
NULL, el_05;
|FIN;

|DEFBUCLE isocie05_n;
#3#1;
3, 8;
empresa, anyo_ant, 001, anyo_ded, "N";
empresa, anyo_ant, 999, anyo_ded, "N";
be;
NULL, el_05;
|FIN;

|PROCESO ficher_05;
|BUCLE isocie05_s;
|BUCLE isocie05_n;
|FPRC;

|PROCESO el_06;
|SI total_de = 0; |ACABA; |FINSI;

|SI #4#8 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #4#8;
    #3#0     = empresa;
    #3#1     = anyo;
    #3#2     = linea;
    #3#3     = 92;
    #3#4     = 25;
    #3#5     = #4#5;
    #3#6     = 0;
    #3#7     = #4#8;
    #3#8     = #4#9;
    |GRABA 140#3n;
    |LIBERA #3;
|SINO;
    linea    = linea + 1;
    #3#0     = empresa;
    #3#1     = anyo;
    #3#2     = linea;
    #3#3     = 92;
    #3#4     = 25;
    #3#5     = #4#5;
    #3#6     = 0;
    #3#7     = total_de;
    #3#8     = #4#9;

    |GRABA 140#3n;
    |LIBERA #3;
    total_de = 0;
|FINSI;

total = #3#7;
casilla_a = 29;
|HAZ resumen;
|FPRC;

|DEFBUCLE isocie06_s;
#4#1;
3, 9;
empresa, anyo_ant, 001, tipo_p, "S";
empresa, anyo_ant, 999, tipo_p, "S";
be;
NULL, el_06;
|FIN;

|DEFBUCLE isocie06_n;
#4#1;
3, 9;
empresa, anyo_ant, 001, tipo_p, "N";
empresa, anyo_ant, 999, tipo_p, "N";
be;
NULL, el_06;
|FIN;

|PROCESO ficher_06;
|ABRE #3;
|BUCLE isocie06_s;
|BUCLE isocie06_n;
|CIERRA #3;
|FPRC;

|PROCESO el_07;
|SI total_de = 0; |ACABA; |FINSI;

|SI #5#8 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #5#8;
    #9#0     = empresa;
    #9#1     = anyo;
    #9#2     = linea;
    #9#3     = "1";
    #9#4     = 92;
    #9#5     = 55;
    #9#6     = #5#5;
    #9#7     = #5#6;
    #9#8     = 0;
    #9#9     = #5#8;
    #9#10    = #5#9;
    |GRABA 140#9n;
    |LIBERA #9;
|SINO;
    linea    = linea + 1;
    #9#0     = empresa;
    #9#1     = anyo;
    #9#2     = linea;
    #9#3     = "1";
    #9#4     = 92;
    #9#5     = 55;
    #9#6     = #5#5;
    #9#7     = #5#6;
    #9#8     = 0;
    #9#9     = total_de;
    #9#10    = #5#9;
    |GRABA 140#9n;
    |LIBERA #9;
    total_de = 0;
|FINSI;
total = #9#9;
casilla_a = 131;
|HAZ resumen;
|FPRC;

|DEFBUCLE isocie07_s;
#5#1;
9;
empresa, anyo_ant, 001, "S";
empresa, anyo_ant, 999, "S";
be;
NULL, el_07;
|FIN;

|DEFBUCLE isocie07_n;
#5#1;
9;
empresa, anyo_ant, 001, "N";
empresa, anyo_ant, 999, "N";
be;
NULL, el_07;
|FIN;

|PROCESO ficher_07;
linea = 0;
|ABRE #9;
|BUCLE isocie07_s;
|BUCLE isocie07_n;
|CIERRA #9;
|FPRC;

|PROCESO el_08;
|SI total_de = 0; |ACABA; |FINSI;
tipo_b = #6#3;
|SI tipo_b = "1"; |O tipo_b = "2"; tipo_b = "2"; |FINSI;

|SI #6#9 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #6#9;
    #9#0     = empresa;
    #9#1     = anyo;
    #9#2     = linea;
    #9#3     = tipo_b;
    #9#4     = #6#4;
    #9#5     = #6#5;
    #9#6     = #6#6;
    #9#7     = #6#7;
    #9#8     = 0;
    #9#9     = #6#9;
    #9#10    = #6#10;
    |GRABA 140#9n;
    |LIBERA #9;
|SINO;
    linea    = linea + 1;
    #9#0     = empresa;
    #9#1     = anyo;
    #9#2     = linea;
    #9#3     = tipo_b;
    #9#4     = #6#4;
    #9#5     = #6#5;
    #9#6     = #6#6;
    #9#7     = #6#7;
    #9#8     = 0;
    #9#9     = total_de;
    #9#10    = #6#10;
    |GRABA 140#9n;
    |LIBERA #9;
    total_de = 0;
|FINSI;
total = #9#9;

|SI #9#3 = "J"; |Y #9#4 = 89; casilla_a = 83; |FINSI;
|SI #9#3 = "J"; |Y #9#4 = 90; casilla_a = 86; |FINSI;
|SI #9#3 = "J"; |Y #9#4 = 91; casilla_a = 89; |FINSI;
|SI #9#3 = "J"; |Y #9#4 = 92; casilla_a = 92; |FINSI;

|SI #9#3 = "E"; |Y #9#4 = 89; casilla_a = 65; |FINSI;
|SI #9#3 = "E"; |Y #9#4 = 90; casilla_a = 68; |FINSI;
|SI #9#3 = "E"; |Y #9#4 = 91; casilla_a = 71; |FINSI;
|SI #9#3 = "E"; |Y #9#4 = 92; casilla_a = 74; |FINSI;

|SI #9#3 = "M"; |Y #9#4 = 90; casilla_a = 98;  |FINSI;
|SI #9#3 = "M"; |Y #9#4 = 91; casilla_a = 101; |FINSI;
|SI #9#3 = "M"; |Y #9#4 = 92; casilla_a = 104; |FINSI;

|SI #9#3 = "2"; |Y #9#4 = 92; casilla_a = 140; |FINSI;
|HAZ resumen;
|FPRC;

|DEFBUCLE isocie08_s;
#6#1;
3, 4, 10;
empresa, anyo_ant, 000, tipo_p, anyo_ded, "S";
empresa, anyo_ant, 999, tipo_p, anyo_ded, "S";
be;
NULL, el_08;
|FIN;

|DEFBUCLE isocie08_n;
#6#1;
3, 4, 10;
empresa, anyo_ant, 000, tipo_p, anyo_ded, "N";
empresa, anyo_ant, 999, tipo_p, anyo_ded, "N";
be;
NULL, el_08;
|FIN;

|PROCESO ficher_08;
|ABRE #9;
|BUCLE isocie08_s;
|BUCLE isocie08_n;
|CIERRA #9;
|FPRC;

|PROCESO el_09;
|SI total_de = 0; |ACABA; |FINSI;
l_linea = #7#2;
|SI #7#6 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #7#6;
    #7#1 = anyo;
    #7#2 = linea;
    |GRABA 140#7n;
    |LIBERA #7;
|SINO;
    linea    = linea + 1;
    #7#1 = anyo;
    #7#2 = linea;
    #7#6 = total_de;
    |GRABA 140#7n;
    |LIBERA #7;
    total_de = 0;
|FINSI;

total = #7#6;
|SI #7#3 = 88; casilla_a = 110; |FINSI;
|SI #7#3 = 89; casilla_a = 113; |FINSI;
|SI #7#3 = 90; casilla_a = 116; |FINSI;
|SI #7#3 = 91; casilla_a = 119; |FINSI;
|HAZ resumen;

#7#0 = empresa;
#7#1 = anyo_ant;
#7#2 = l_linea;
|LIBERA #7;
|LEE 140#7=;
|FPRC;

|DEFBUCLE isocie09_s;
#7#1;
3, 7;
empresa, anyo_ant, 001, anyo_ded, "S";
empresa, anyo_ant, 999, anyo_ded, "S";
be;
NULL, el_09;
|FIN;

|DEFBUCLE isocie09_n;
#7#1;
3, 7;
empresa, anyo_ant, 001, anyo_ded, "N";
empresa, anyo_ant, 999, anyo_ded, "N";
be;
NULL, el_09;
|FIN;

|PROCESO ficher_09;
|BUCLE isocie09_s;
|BUCLE isocie09_n;
|FPRC;

|PROCESO ficher_10;
|ABRE #7;
|ABRE #8;
linea = linea + 1;
#8#0 = empresa;
#8#1 = anyo_ant;
|LEE 040#8=;
|SI FSalida = 0;
    #7#0 = empresa;
    #7#1 = anyo;
    #7#2 = linea;
    #7#3 = 92;
    #7#4 = "CREACION EMPLEO 1992";
    #7#6 = total_de;
    #7#7 = "S";
    |GRABA 140#7n;
    |LIBERA #7;

    total = #7#6;
    casilla_a = 122;
    |HAZ resumen;
|FINSI;
|CIERRA #8;
|CIERRA #7;
|FPRC;

|PROCESO importa_93;
anyo_ant = anyo - 1

|ABRE #10;
|ABRE #1;
#1#0 = empresa;
#1#1 = anyo_ant;
|LEE 040#1=;
|SI FSalida ! 0; |CIERRA #1; |ACABA; |FINSI;

linea = 0;
|SI #1#004 ! 0; total_de = #1#004; anyo_ded = 88;   |HAZ ficher_05; |FINSI;
|SI #1#010 ! 0; total_de = #1#010; anyo_ded = 89;   |HAZ ficher_05; |FINSI;
|SI #1#019 ! 0; total_de = #1#019; anyo_ded = 90;   |HAZ ficher_05; |FINSI;
|SI #1#025 ! 0; total_de = #1#025; anyo_ded = 91;   |HAZ ficher_05; |FINSI;

|SI #1#037 ! 0; total_de = #1#037; tipo_p   = "AF"; |HAZ ficher_06; |FINSI;
|SI #1#040 ! 0; total_de = #1#040; tipo_p   = "GI"; |HAZ ficher_06; |FINSI;
|SI #1#040 ! 0;                    tipo_p   = "GA"; |HAZ ficher_06; |FINSI;
|SI #1#043 ! 0; total_de = #1#043; tipo_p   = "EL"; |HAZ ficher_06; |FINSI;
|SI #1#046 ! 0; total_de = #1#046; tipo_p   = "AE"; |HAZ ficher_06; |FINSI;
|SI #1#049 ! 0; total_de = #1#049; tipo_p   = "BI"; |HAZ ficher_06; |FINSI;

|SI #1#124 ! 0; total_de = #1#124;                  |HAZ ficher_07; |FINSI;

tipo_p = "E";
|SI #1#061 ! 0; total_de = #1#061; anyo_ded = 89; |HAZ ficher_08; |FINSI;
|SI #1#064 ! 0; total_de = #1#064; anyo_ded = 90; |HAZ ficher_08; |FINSI;
|SI #1#067 ! 0; total_de = #1#067; anyo_ded = 91; |HAZ ficher_08; |FINSI;
|SI #1#070 ! 0; total_de = #1#070; anyo_ded = 92; |HAZ ficher_08; |FINSI;

tipo_p = "J";
|SI #1#079 ! 0; total_de = #1#079; anyo_ded = 89; |HAZ ficher_08; |FINSI;
|SI #1#082 ! 0; total_de = #1#082; anyo_ded = 90; |HAZ ficher_08; |FINSI;
|SI #1#085 ! 0; total_de = #1#085; anyo_ded = 91; |HAZ ficher_08; |FINSI;
|SI #1#088 ! 0; total_de = #1#088; anyo_ded = 92; |HAZ ficher_08; |FINSI;

tipo_p = "M";
|SI #1#094 ! 0; total_de = #1#094; anyo_ded = 90; |HAZ ficher_08; |FINSI;
|SI #1#097 ! 0; total_de = #1#097; anyo_ded = 91; |HAZ ficher_08; |FINSI;
|SI #1#100 ! 0; total_de = #1#100; anyo_ded = 92; |HAZ ficher_08; |FINSI;

tipo_p = "1";
|SI #1#127 ! 0; total_de = #1#127; anyo_ded = 92; |HAZ ficher_08; |FINSI;
tipo_p = "2";
|SI #1#127 ! 0;                    anyo_ded = 92; |HAZ ficher_08; |FINSI;

linea = 0;
|SI #1#106 ! 0; total_de = #1#106; anyo_ded = 88; |HAZ ficher_09; |FINSI;
|SI #1#109 ! 0; total_de = #1#109; anyo_ded = 89; |HAZ ficher_09; |FINSI;
|SI #1#112 ! 0; total_de = #1#112; anyo_ded = 90; |HAZ ficher_09; |FINSI;
|SI #1#115 ! 0; total_de = #1#115; anyo_ded = 91; |HAZ ficher_09; |FINSI;
|SI #1#118 ! 0; total_de = #1#118; anyo_ded = 92; |HAZ ficher_10; |FINSI;

|CIERRA #1;
|CIERRA #10;
|FPRC;
