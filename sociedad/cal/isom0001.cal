|FICHEROS;
     isom0000;
     isom0001;
     isom0003;
     isom0006;
     isom0500;

     maempr10;
     maempr11;

     zregdocu;

     isow0000,MANTE;
     isow0025,MANTE;
     isow0001,MANTE;
     isow0002,MANTE;
     isow0003,MANTE;
     isow0011,MANTE;
     isow0019,MANTE;
     isow0020,MANTE;
     isow0023,MANTE;
|FIN;

|INCLUYE incca8m0;

|VARIABLES;
      nRango         = 0;
      nBotonSal      = -1;
      nBotonAnota    = -1;
      nBotonDat      = -1;
      nLabel         = -1;
      nTree          = 0;
      nHandle        = 0;
      nPanta         = 0;
      n0Vent         = 0;
      nVentana       = 0;
      nVent          = 0;
      nSal           = 0;
      nCasilla       = 0;
      nContenido1    = 0;
      nContenido2    = 0;
      nGrid          = 0;
      nCampo         = 0;
      nCampoD        = 0;
      nCampoH        = 0;
      nLinea         = 0;
      nConta         = 0;
      nModo          = 0;
      nValor         = 0;
      nValor1        = 0;
      nValor2        = 0;
      nSuma1         = 0;
      nSuma2         = 0;
      nGrabo         = 0;
      n19            = 0;
      nTope          = 0;
      nPorce2        = 0;

      aContenido     = "";
      aTexto         = "";
      aBase          = "";
      aAlfa          = "";
      aAbre          = "";
      aEsc1          = "";
      aEsc2          = "";
      aRetu          = "";
      aTecla         = "";
      aCasilla       = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &enValor        = 0;
     &eaCasilla      = "";
     &eaTitCasilla   = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaTipoColor    = "";
     &eaColor        = "";
     &enCuaccpar     = 0;

     &enNavieras     = 0;
     &enCooperativa  = 0;
     &enTranspa      = 0;
     &enZEC          = 0;
     &enSOCIMI       = 0;
     &enPeqDimen     = 0;
     &enNovaCrea     = 0;
     &enForales      = 0;
     &enGrupos       = 0;
     &eaUnidadBasico = "";
     &enModoConsulta = 0;
|FIN;

|PROCESO isom0001;
     |SI #isom0001#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0001.a;
     |LIBERA #isom0001;
|FPRC;

|DEFBUCLE isom0001;
     #isom0001#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0001;
|FIN;

|PROCESO BotonSalir;
     |BUCLE isom0001;

     nSal = 0;
     |PTEC 807;
|FPRC;

|PROCESO Tipo1;  |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |HAZ Tipo1;
|FPRC;

|PROCESO CargaArbol;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO isom0002;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Balance (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0002";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;
|FPRC;

|PROCESO isom0003;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Cuenta P‚rdidas y Ganancias (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0003";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;
|FPRC;

|PROCESO isom0004;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa +  "Estado de Cambios en el Patrimonio Neto I (";
     aAlfa = aAlfa + (("00000" + #maempr10#0) % -105) + " / ";
     aAlfa = aAlfa + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0004";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;
|FPRC;

|PROCESO isom0005;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Estado de Cambios en el Patrimonio Neto II (";
     aAlfa =  aAlfa + (("00000" + #maempr10#0) % -105) + " / ";
     aAlfa =  aAlfa + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0005";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;
|FPRC;

|PROCESO isow0000;
     |SI enModoConsulta = 1;
         |VENTANA 0501, 2999, -1, 16, "(MODO CONSULTA)   Distribuci¢n de resultados";
         nVentana = FSalida;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODAL";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |PARA nCampoD = 0;  |SI nCampoD [ 21;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH     = nCampoD + 84;
               #isow0000#nCampoD# = #isom0000#nCampoH#;
         |SIGUE;

         #isow0000#22 = #isom0000#125;
         #isow0000#23 = #isom0000#126;

         |PINPA #0#isow0000;
         |PINDA #0#isow0000;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |PULSATECLA;

         |FINVENTANA nVentana;

         |ACABA;
     |FINSI;

     |ABRE #zregdocu;
     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     nGrabo = 0;
     #zregdocu#0 = #maempr10#0;
     #zregdocu#1 = #maempr10#1;
     |LEE 101#zregdocu.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregdocu;

         #zregdocu#0  = #maempr10#0;
         #zregdocu#1  = #maempr10#1;

         #zregdocu#16 = #isom0000#84;
         #zregdocu#17 = #isom0000#85;
         #zregdocu#18 = #isom0000#86;
         #zregdocu#19 = #isom0000#87;
         #zregdocu#20 = #isom0000#88;

         #zregdocu#21 = #isom0000#89;
         #zregdocu#22 = #isom0000#90;
         #zregdocu#23 = #isom0000#91;
         #zregdocu#24 = #isom0000#92;
         #zregdocu#25 = #isom0000#94 + #isom0000#95;
         #zregdocu#26 = #isom0000#104;
         #zregdocu#27 = #isom0000#102;
         #zregdocu#28 = #isom0000#93 + #isom0000#96  + #isom0000#97  + #isom0000#98  + #isom0000#99;
         #zregdocu#28 = #zregdocu#28 + #isom0000#100 + #isom0000#101 + #isom0000#103;
         #zregdocu#28 = #zregdocu#28 + #isom0000#125 + #isom0000#126;

         nGrabo = 1;
     |FINSI;

     |VENTANA 0501, 2999, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #isom0000#84 = #zregdocu#16;
     #isom0000#85 = #zregdocu#17;
     #isom0000#86 = #zregdocu#18;
     #isom0000#87 = #zregdocu#19;
     #isom0000#88 = #zregdocu#20;

     #isom0000#89 = #zregdocu#21;
     #isom0000#90 = #zregdocu#22;
     #isom0000#91 = #zregdocu#23;
     #isom0000#92 = #zregdocu#24;

     |SI #isom0000#94 = 0;  |Y #isom0000#95 = 0;
         #isom0000#94 = #zregdocu#25;
     |FINSI;

     #isom0000#104 = #zregdocu#26;
     #isom0000#102 = #zregdocu#27;

     |SI #isom0000#93 = 0;  |Y #isom0000#94  = 0;  |Y #isom0000#97  = 0;  |Y #isom0000#98 = 0;
      |Y #isom0000#99 = 0;  |Y #isom0000#100 = 0;  |Y #isom0000#101 = 0;  |Y #isom0000#103 = 0;
        |Y #isom0000#125 = 0;  |Y #isom0000#126 = 0;
         #isom0000#103 = #zregdocu#28;
     |FINSI;

     |PARA nCampoD = 0;  |SI nCampoD [ 21;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 84;
           #isow0000#nCampoD# = #isom0000#nCampoH#;
     |SIGUE;

     #isow0000#22 = #isom0000#125;
     #isow0000#23 = #isom0000#126;

     |SELECT #2#isom0001;
     #isom0001#0  = #maempr10#0;
     #isom0001#1  = #maempr10#1;
     #isom0001#3  = "500";
     |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     |SELECT #1#isom0001;

     |C_M #isow0000#0, 1, "S";
     |SI #isom0001#5 [ 0;
         |SELECT #1#isom0001;
         #isow0000#0 = 0;
         |C_M #isow0000#0, 1, "N";
     |FINSI;

     |PINPA #0#isow0000;
     |PINDA #0#isow0000;

     |ENDATOS #1#isow0000;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 21;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 84;
               #isom0000#nCampoH# = #isow0000#nCampoD#;
         |SIGUE;

         #isom0000#125 = #isow0000#22;
         #isom0000#126 = #isow0000#23;

         #zregdocu#16 = #isom0000#84;
         #zregdocu#17 = #isom0000#85;
         #zregdocu#18 = #isom0000#86;
         #zregdocu#19 = #isom0000#87;
         #zregdocu#20 = #isom0000#88;

         #zregdocu#21 = #isom0000#89;
         #zregdocu#22 = #isom0000#90;
         #zregdocu#23 = #isom0000#91;
         #zregdocu#24 = #isom0000#92;
         #zregdocu#25 = #isom0000#94 + #isom0000#95;
         #zregdocu#26 = #isom0000#104;
         #zregdocu#27 = #isom0000#102;
         #zregdocu#28 = #isom0000#93 + #isom0000#96  + #isom0000#97  + #isom0000#98  + #isom0000#99;
         #zregdocu#28 = #zregdocu#28 + #isom0000#100 + #isom0000#101 + #isom0000#103;
         #zregdocu#28 = #zregdocu#28 + #isom0000#125 + #isom0000#126;
         #zregdocu#29 = #isom0000#105;
     |FINSI;

     |GRABA 020#isom0000.a;  |LIBERA #isom0000;
     |SI nGrabo = 0;            || solo grabo si ya existe 1243_2503
         |GRABA 020#zregdocu.a;
     |FINSI;
     |CIERRA #zregdocu;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Carga25;
     #isow0025#0  = #isom0000#84;
     #isow0025#1  = #isom0000#85;
     #isow0025#2  = #isom0000#86;
     #isow0025#3  = #isom0000#87;
     #isow0025#4  = #isom0000#88;

     #isow0025#5  = #isom0000#89;
     #isow0025#6  = #isom0000#91;
     #isow0025#7  = #isom0000#92;
     #isow0025#8  = #isom0000#125;
     #isow0025#9  = #isom0000#126;
     #isow0025#10 = #isom0000#93;
     #isow0025#11 = #isom0000#94;
     #isow0025#12 = #isom0000#96;
     #isow0025#13 = #isom0000#97;
     #isow0025#14 = #isom0000#98;
     #isow0025#15 = #isom0000#100;
     #isow0025#16 = #isom0000#102;
     #isow0025#17 = #isom0000#103;
     #isow0025#18 = #isom0000#104;
     #isow0025#19 = #isom0000#105;
|FPRC;

|PROCESO Descarga25;
     #isom0000#84  = #isow0025#0;
     #isom0000#85  = #isow0025#1;
     #isom0000#86  = #isow0025#2;
     #isom0000#87  = #isow0025#3;
     #isom0000#88  = #isow0025#4;

     #isom0000#89  = #isow0025#5;
     #isom0000#91  = #isow0025#6;
     #isom0000#92  = #isow0025#7;
     #isom0000#125 = #isow0025#8;
     #isom0000#126 = #isow0025#9;
     #isom0000#93  = #isow0025#10;
     #isom0000#94  = #isow0025#11;
     #isom0000#96  = #isow0025#12;
     #isom0000#97  = #isow0025#13;
     #isom0000#98  = #isow0025#14;
     #isom0000#100 = #isow0025#15;
     #isom0000#102 = #isow0025#16;
     #isom0000#103 = #isow0025#17;
     #isom0000#104 = #isow0025#18;
     #isom0000#105 = #isow0025#19;
|FPRC;

|PROCESO isow0025;
     |SI enModoConsulta = 1;
         |VENTANA 0501, 2999, -1, 16, "(MODO CONSULTA)   Distribuci¢n de resultados";
         nVentana = FSalida;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODAL";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |HAZ Carga25;

         |PINPA #0#isow0025;
         |PINDA #0#isow0025;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |PULSATECLA;

         |FINVENTANA nVentana;

         |ACABA;
     |FINSI;

     |ABRE #zregdocu;
     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     nGrabo = 0;
     #zregdocu#0 = #maempr10#0;
     #zregdocu#1 = #maempr10#1;
     |LEE 101#zregdocu.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregdocu;

         #zregdocu#0  = #maempr10#0;
         #zregdocu#1  = #maempr10#1;

         #zregdocu#16 = #isom0000#84;
         #zregdocu#17 = #isom0000#85;
         #zregdocu#18 = #isom0000#86;
         #zregdocu#19 = #isom0000#87;
         #zregdocu#20 = #isom0000#88;

         #zregdocu#21 = #isom0000#89;
         #zregdocu#22 = #isom0000#90;
         #zregdocu#23 = #isom0000#91;
         #zregdocu#24 = #isom0000#92;
         #zregdocu#25 = #isom0000#94 + #isom0000#95;
         #zregdocu#26 = #isom0000#104;
         #zregdocu#27 = #isom0000#102;
         #zregdocu#28 = #isom0000#93 + #isom0000#96  + #isom0000#97  + #isom0000#98  + #isom0000#99;
         #zregdocu#28 = #zregdocu#28 + #isom0000#100 + #isom0000#101 + #isom0000#103;
         #zregdocu#28 = #zregdocu#28 + #isom0000#125 + #isom0000#126;

         nGrabo = 1;
     |FINSI;

     |VENTANA 0501, 2999, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #isom0000#84 = #zregdocu#16;
     #isom0000#85 = #zregdocu#17;
     #isom0000#86 = #zregdocu#18;
     #isom0000#87 = #zregdocu#19;
     #isom0000#88 = #zregdocu#20;

     #isom0000#89 = #zregdocu#21;
     #isom0000#90 = #zregdocu#22;
     #isom0000#91 = #zregdocu#23;
     #isom0000#92 = #zregdocu#24;

     |SI #isom0000#94 = 0;  |Y #isom0000#95 = 0;
         #isom0000#94 = #zregdocu#25;
     |FINSI;

     #isom0000#104 = #zregdocu#26;
     #isom0000#102 = #zregdocu#27;

     |SI #isom0000#93 = 0;  |Y #isom0000#94  = 0;  |Y #isom0000#97  = 0;  |Y #isom0000#98 = 0;
      |Y #isom0000#99 = 0;  |Y #isom0000#100 = 0;  |Y #isom0000#101 = 0;  |Y #isom0000#103 = 0;
        |Y #isom0000#125 = 0;  |Y #isom0000#126 = 0;
           #isom0000#103 = #zregdocu#28;
     |FINSI;

     |HAZ Carga25;

     |SELECT #2#isom0001;
     #isom0001#0  = #maempr10#0;
     #isom0001#1  = #maempr10#1;
     #isom0001#3  = "500";
     |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     |SELECT #1#isom0001;

     |C_M #isow0025#0, 1, "S";
     |SI #isom0001#5 [ 0;
         |SELECT #1#isom0001;
         #isow0025#0 = 0;
         |C_M #isow0025#0, 1, "N";
     |FINSI;

     |PINPA #0#isow0025;
     |PINDA #0#isow0025;

     |ENDATOS #1#isow0025;
     |SI FSalida = 0;
         |HAZ Descarga25;

         #zregdocu#16 = #isom0000#84;
         #zregdocu#17 = #isom0000#85;
         #zregdocu#18 = #isom0000#86;
         #zregdocu#19 = #isom0000#87;
         #zregdocu#20 = #isom0000#88;

         #zregdocu#21 = #isom0000#89;
         #zregdocu#22 = #isom0000#90;
         #zregdocu#23 = #isom0000#91;
         #zregdocu#24 = #isom0000#92;
         #zregdocu#25 = #isom0000#94 + #isom0000#95;
         #zregdocu#26 = #isom0000#104;
         #zregdocu#27 = #isom0000#102;
         #zregdocu#28 = #isom0000#93 + #isom0000#96  + #isom0000#97  + #isom0000#98  + #isom0000#99;
         #zregdocu#28 = #zregdocu#28 + #isom0000#100 + #isom0000#101 + #isom0000#103;
         #zregdocu#28 = #zregdocu#28 + #isom0000#125 + #isom0000#126;
         #zregdocu#29 = #isom0000#105;
     |FINSI;

     |GRABA 020#isom0000.a;  |LIBERA #isom0000;
     |SI nGrabo = 0;            || solo grabo si ya existe 1243_2503
         |GRABA 020#zregdocu.a;
     |FINSI;
     |CIERRA #zregdocu;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Tree500;
     |SI FEntrada = 0;
         |ACABA;
     |FINSI;

     aContenido = Contenido % -108;

     enEmpresa = #isom0001#0;
     enAnyo    = #isom0001#1;

     |SI aContenido = "isom0002";  |HAZ isom0002;  |FINSI;
     |SI aContenido = "isom0003";  |HAZ isom0003;  |FINSI;
     |SI aContenido = "isom0004";  |HAZ isom0004;  |FINSI;
     |SI aContenido = "isom0005";  |HAZ isom0005;  |FINSI;
     |SI aContenido = "isow0000";  |HAZ isow0000;  |FINSI;
     |SI aContenido = "isow0025";  |HAZ isow0025;  |FINSI;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Balance;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     |VENTANA 1055, 1795, -1, 17, "Casilla 500";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";      |MKDIR aAlfa;

     |HAZ LeeUnidadBasico;

     eaRutaOrigen  = aBase + "tmp/";
     eaRutaDestino = eaUnidadBasico + "\MODELOS";            |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP";        |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP\";
     eaFicheroTxt  = "isom0001" + Usuario + ".txt";
     eaFicheroTgz  = "isom0001" + Usuario + ".tgz";
     eaFicheroTar  = "isom0001" + Usuario + ".tar";

     sT_nID   = nTree;
     sT_nOper = 0;

     aAbre = eaRutaOrigen + eaFicheroTxt;
     |XABRE "WB", aAbre, nHandle;

     nConta = 0;

     nConta = nConta + 1;
     eaAlfa = nConta + ": Balance Activo, Patrimonio Neto y Pasivo {{isom0002}}";
     |HAZ CargaArbol;

     nConta = nConta + 1;
     eaAlfa = nConta + ":P‚rdidas y Ganancias {{isom0003}}";
     |HAZ CargaArbol;

     |SI #ca8m0000#2 ! 3;
         nConta = nConta + 1;
         eaAlfa = nConta + ":Estado de cambios en el PN-I {{isom0004}}";
         |HAZ CargaArbol;
     |FINSI;

     nConta = nConta + 1;
     eaAlfa = nConta + ":Estado de cambios en el PN-II {{isom0005}}";
     |HAZ CargaArbol;

     |SI enAnyo [ 2016;
         nConta = nConta + 1;
         eaAlfa = nConta + ":Distribuci¢n de Resultados {{isow0000}}";
         |HAZ CargaArbol;
     |FINSI;

     |SI enAnyo ] 2017;
         nConta = nConta + 1;
         eaAlfa = nConta + ":Distribuci¢n de Resultados {{isow0025}}";
         |HAZ CargaArbol;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL, Tabla de contenidos {{" + aAlfa + "}}";
     |CONTROL_SIMPLE 0, eaAlfa, 1055, 1595, Tree500;
     nTree = FSalida;

     eaFicheroTxt  = "isom0001" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}sali&R," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVent;

     |PULSATECLA;
|FPRC;

|PROCESO isow0001;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa =  "R‚gimen de las Entidades Navieras en funci¢n de tonelaje (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 1699, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     #isow0001#0  = #isom0000#2;
     #isow0001#1  = #isom0000#3;
     #isow0001#2  = #isom0000#4;
     #isow0001#3  = #isom0000#5;
     #isow0001#4  = #isom0000#6;

     |PINPA #0#isow0001;
     |PINDA #0#isow0001;
     |ENDATOS #1#isow0001;
     |SI FSalida = 0;
         #isom0000#2  = #isow0001#0;
         #isom0000#3  = #isow0001#1;
         #isom0000#4  = #isow0001#2;
         #isom0000#5  = #isow0001#3;
         #isom0000#6  = #isow0001#4;
         |GRABA 020#isom0000.a;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO LeeCasilla103;
     #isom0003#0  = #maempr10#0;
     #isom0003#1  = #maempr10#1;
     #isom0003#3  = aCasilla;
     |LEE 040#isom0003.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0003;  |FINSI;
|FPRC;

|PROCESO isow0002;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "R‚gimen de cooperativas. Determinaci¢n de la base imponible (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 2299, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isow0002#nCampo# = #isom0000#nCampo#;
         |SIGUE;

         |PINPA #0#isow0002;
         |PINDA #0#isow0002;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0002;

     |ABRE #isom0006;
     |ABRE #isom0003;

     |SELECT #2#isom0001;
     |SELECT #2#isom0003;
     |SELECT #2#isom0006;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "500";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     #isow0002#0 = #isom0001#5;

     nValor1 = 0;
     nValor2 = 0;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "301";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor1 = #isom0001#5;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "302";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor2 = #isom0001#5;

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "417";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 + #isom0006#5;
     nValor2 = nValor2 + #isom0006#7;

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "381";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 - #isom0006#5;
     nValor2 = nValor2 - #isom0006#7;
     #isow0002#5 = (#isom0006#5 - #isom0006#7);

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "403";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 - #isom0006#5;
     nValor2 = nValor2 - #isom0006#7;
     #isow0002#4 = (#isom0006#5 - #isom0006#7);

     |SELECT #3#isom0006;
     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#6  = "400";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor2 = nValor2 - #isom0006#7;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "547";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;

     #isow0002#3  = #isom0006#7;
     #isow0002#1  = nValor1;
     #isow0002#2  = nValor2 + #isom0001#5;
     #isow0002#6  = #isow0002#0 + #isow0002#1 - #isow0002#2 - #isow0002#3 + #isow0002#4 + #isow0002#5;

     |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           #isow0002#nCampo# = #isom0000#nCampo#;
     |SIGUE;

     nSuma1 = (#isow0002#16 + #isow0002#26) ! 2;
     nSuma2 = #isow0002#6 ! 2;
     |SI nSuma1 ! nSuma2;
         #isow0002#7  = 0;
         #isow0002#17 = 0;
         #isow0002#8  = 0;
         #isow0002#18 = 0;
         #isow0002#9  = 0;
         #isow0002#19 = 0;

         aCasilla = "255";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "259";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "265";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "285";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "286";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "295";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0002#7 = #isow0002#7 + #isom0003#5;  |FINSI;
         aCasilla = "297";  |HAZ LeeCasilla103;  #isow0002#7 = #isow0002#7 + #isom0003#5;
         aCasilla = "309";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0002#7 = #isow0002#7 + #isom0003#5;  |FINSI;
         aCasilla = "312";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0002#7 = #isow0002#7 + #isom0003#5;  |FINSI;

         aCasilla = "258";  |HAZ LeeCasilla103;  #isow0002#8 = #isow0002#8 + -(#isom0003#5);
         aCasilla = "260";  |HAZ LeeCasilla103;  #isow0002#8 = #isow0002#8 + -(#isom0003#5);

         aCasilla = "270";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "279";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "284";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "287";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "294";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "305";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "313";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "326";  |HAZ LeeCasilla103;  #isow0002#9 = #isow0002#9 + -(#isom0003#5);
         aCasilla = "309";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0002#9 = #isow0002#9 + (-#isom0003#5);  |FINSI;
         aCasilla = "312";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0002#9 = #isow0002#9 + (-#isom0003#5);  |FINSI;
         aCasilla = "295";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0002#9 = #isow0002#9 + (-#isom0003#5);  |FINSI;
     |FINSI;

     #isow0002#27 = #isom0000#27;
     #isow0002#29 = #isom0000#28;

     |SI #isow0002#27 = 0;  #isow0002#27 = 20;  |FINSI;
     |SI #isow0002#29 = 0;  #isow0002#29 = 30;  |FINSI;

     #isow0002#28 = #isow0002#16 % #isow0002#27;
     #isow0002#30 = #isow0002#26 % #isow0002#29;

     #isow0002#14 = #isow0002#4;

     |SELECT #1#isom0001;
     |SELECT #1#isom0003;
     |SELECT #1#isom0006;

     |PINPA #0#isow0002;
     |PINDA #0#isow0002;
     |ENDATOS #1#isow0002;
     |SI FSalida = 0;
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = #isow0002#nCampo#;
         |SIGUE;

         #isom0000#27 = #isow0002#27;
         #isom0000#28 = #isow0002#29;

         |GRABA 020#isom0000.a;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;
     |CIERRA #isom0003;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO TotalEsto;
     n19   = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  n19 = 1;  |FINSI;
     |CIERRA #maempr11;

     #isow0011#10 = #isow0011#7  - #isow0011#8  - #isow0011#9  - #isow0011#31;
     #isow0011#21 = #isow0011#17 - #isow0011#18 - #isow0011#19 - #isow0011#32 + #isow0011#20;

     |SI #isow0011#11 = 0; |Y #isow0011#22 = 0;  |Y Campo ! 11;
         #isow0011#11 = #isow0011#1;
     |FINSI;

     |SI #isow0011#12 = 0; |Y #isow0011#23 = 0;  |Y Campo ! 12;
         #isow0011#12 = #isow0011#2;
     |FINSI;

     |SI #isow0011#13 = 0; |Y #isow0011#24 = 0;  |Y Campo ! 13;
         #isow0011#13 = #isow0011#3;
     |FINSI;

     #isow0011#14 = #isow0011#4;

     |SI #isow0011#15 = 0; |Y #isow0011#25 = 0;  |Y Campo ! 15;
         #isow0011#15 = #isow0011#5;
     |FINSI;

     #isow0011#24 = #isow0011#3 - #isow0011#13;
     #isow0011#25 = #isow0011#5 - #isow0011#15;

     #isow0011#16 = #isow0011#10 + #isow0011#11 - #isow0011#12 - #isow0011#13 + #isow0011#14 + #isow0011#15;
     #isow0011#26 = #isow0011#21 + #isow0011#22 - #isow0011#23 - #isow0011#24 + #isow0011#25;

     |SI enAnyo [ 2014;
         |SI n19 = 0;
             nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
         |SINO;
             nTope = 120202.41;
             |SI #isow0011#16 [ nTope;
                 nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
             |SINO;
                                         nPorce2 = 0;
                 |SI #isow0011#27 = 20;  nPorce2 = 25;  |FINSI;
                 |SI #isow0011#27 = 25;  nPorce2 = 30;  |FINSI;
                 |SI #isow0011#27 = 30;  nPorce2 = 30;  |FINSI;

                 |SI nPorce2 ! 0;
                     nValor1 = ((nTope % #isow0011#27) + ((#isow0011#16 - nTope) % nPorce2)) ! 3;
                 |SINO;
                     nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo ] 2015;
         nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
     |FINSI;

     nValor2 = (#isow0011#26 % #isow0011#29) ! 3;

     #isow0011#28 = nValor1;
     #isow0011#30 = nValor2;
|FPRC;

|PROCESO isow0011;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "R‚gimen de cooperativas. Determinaci¢n de la base imponible (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 2399, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isow0011#nCampo# = #isom0000#nCampo#;
         |SIGUE;

         #isow0011#31 = #isom0000#110;
         #isow0011#32 = #isom0000#111;

         |PINPA #0#isow0011;
         |PINDA #0#isow0011;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0011;

     |ABRE #isom0006;
     |ABRE #isom0003;

     |SELECT #2#isom0001;
     |SELECT #2#isom0003;
     |SELECT #2#isom0006;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "500";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     #isow0011#0 = #isom0001#5;

     nValor1 = 0;
     nValor2 = 0;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "301";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor1 = #isom0001#5;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "302";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor2 = #isom0001#5;

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "417";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 + #isom0006#5;
     nValor2 = nValor2 + #isom0006#7;

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "381";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 - #isom0006#5;
     nValor2 = nValor2 - #isom0006#7;
     #isow0011#5 = (#isom0006#5 - #isom0006#7);

     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#4  = "403";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     nValor1 = nValor1 - #isom0006#5;
     nValor2 = nValor2 - #isom0006#7;
     #isow0011#4 = (#isom0006#5 - #isom0006#7);

     |SELECT #3#isom0006;
     #isom0006#0  = #maempr10#0;  #isom0006#1  = #maempr10#1;  #isom0006#6  = "400";  |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     nValor2 = nValor2 - #isom0006#7;

     #isom0001#0  = #maempr10#0;  #isom0001#1  = #maempr10#1;  #isom0001#3  = "547";  |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;

     #isow0011#3  = #isom0006#7;
     #isow0011#1  = nValor1;
     #isow0011#2  = nValor2 + #isom0001#5;
     #isow0011#6  = #isow0011#0 + #isow0011#1 - #isow0011#2 - #isow0011#3 + #isow0011#4 + #isow0011#5;

     |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           #isow0011#nCampo# = #isom0000#nCampo#;
     |SIGUE;

     #isow0011#31 = #isom0000#110;
     #isow0011#32 = #isom0000#111;

     nSuma1 = (#isow0011#16 + #isow0011#26) ! 2;
     nSuma2 = #isow0011#6 ! 2;
     |SI nSuma1 ! nSuma2;
         #isow0011#7  = 0;
         #isow0011#17 = 0;
         #isow0011#8  = 0;
         #isow0011#18 = 0;
         #isow0011#31 = 0;
         #isow0011#32 = 0;
         #isow0011#9  = 0;
         #isow0011#19 = 0;

         aCasilla = "255";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "259";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "265";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "285";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "286";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "295";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0011#7 = #isow0011#7 + #isom0003#5;  |FINSI;
         aCasilla = "297";  |HAZ LeeCasilla103;  #isow0011#7 = #isow0011#7 + #isom0003#5;
         aCasilla = "309";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0011#7 = #isow0011#7 + #isom0003#5;  |FINSI;
         aCasilla = "312";  |HAZ LeeCasilla103;
         |SI #isom0003#5 > 0;  #isow0011#7 = #isow0011#7 + #isom0003#5;  |FINSI;

         aCasilla = "258";  |HAZ LeeCasilla103;  #isow0011#8 = #isow0011#8 + -(#isom0003#5);
         aCasilla = "260";  |HAZ LeeCasilla103;  #isow0011#8 = #isow0011#8 + -(#isom0003#5);

         aCasilla = "270";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "279";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "284";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "287";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "294";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "305";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "313";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "326";  |HAZ LeeCasilla103;  #isow0011#9 = #isow0011#9 + -(#isom0003#5);
         aCasilla = "309";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0011#9 = #isow0011#9 + (-#isom0003#5);  |FINSI;
         aCasilla = "312";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0011#9 = #isow0011#9 + (-#isom0003#5);  |FINSI;
         aCasilla = "295";  |HAZ LeeCasilla103;
         |SI #isom0003#5 < 0;  #isow0011#9 = #isow0011#9 + (-#isom0003#5);  |FINSI;
     |FINSI;

     #isow0011#27 = #isom0000#27;
     #isow0011#29 = #isom0000#28;

     |SI enAnyo [ 2014;
         |SI #isow0011#27 = 0;  #isow0011#27 = 20;  |FINSI;
         |SI #isow0011#29 = 0;  #isow0011#29 = 30;  |FINSI;
     |FINSI;

     |SI enAnyo = 2015;
         |SI #isow0011#27 = 0;  #isow0011#27 = 20;  |FINSI;
         |SI #isow0011#29 = 0;  #isow0011#29 = 28;  |FINSI;
     |FINSI;

     |SI enAnyo ] 2016;
         |SI #isow0011#27 = 0;  #isow0011#27 = 20;  |FINSI;
         |SI #isow0011#29 = 0;  #isow0011#29 = 30;  |FINSI;
     |FINSI;

     #isow0011#28 = #isow0011#16 % #isow0011#27;
     #isow0011#30 = #isow0011#26 % #isow0011#29;

     #isow0011#14 = #isow0011#4;

     |HAZ TotalEsto;

     |SELECT #1#isom0001;
     |SELECT #1#isom0003;
     |SELECT #1#isom0006;

     |PINPA #0#isow0011;
     |PINDA #0#isow0011;
     |ENDATOS #1#isow0011;
     |SI FSalida = 0;
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = #isow0011#nCampo#;
         |SIGUE;

         #isom0000#27  = #isow0011#27;
         #isom0000#28  = #isow0011#29;
         #isom0000#110 = #isow0011#31;
         #isom0000#111 = #isow0011#32;

         |GRABA 020#isom0000.a;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;
     |CIERRA #isom0003;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO Coopera;
     |SI #maempr10#1 = 2008;  |HAZ isow0002;  |FINSI;
     |SI #maempr10#1 = 2009;  |HAZ isow0002;  |FINSI;
     |SI #maempr10#1 ] 2010;  |HAZ isow0011;  |FINSI;
|FPRC;

|PROCESO isow0003;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Agrupaciones de inter‚s econ¢mico y UTES (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 2999, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |PARA nCampoD = 0;  |SI nCampoD [ 29;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH     = nCampoD + 29;
               #isow0003#nCampoD# = #isom0000#nCampoH#;
         |SIGUE;

         |PINPA #0#isow0003;
         |PINDA #0#isow0003;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0003;

     |ABRE #isom0006;

     |SELECT #2#isom0006;

     |PARA nCampoD = 0;  |SI nCampoD [ 29;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 29;
           #isow0003#nCampoD# = #isom0000#nCampoH#;
     |SIGUE;

     |PINPA #0#isow0003;
     |PINDA #0#isow0003;
     |ENDATOS #1#isow0003;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 29;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH     = nCampoD + 29;
               #isom0000#nCampoH# = #isow0003#nCampoD#;
         |SIGUE;

         |GRABA 020#isom0000.a;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO CargaCampos23;
     |SELECT #2#isom0001;
     eaCasilla = "500";   |HAZ LeeCas101;  #isow0023#1  = #isom0001#5;
     eaCasilla = "1227";  |HAZ LeeCas101;  #isow0023#2  = #isom0001#5;
     eaCasilla = "1228";  |HAZ LeeCas101;  #isow0023#3  = #isom0001#5;
     eaCasilla = "552";   |HAZ LeeCas101;  #isow0023#4  = #isom0001#5;
     eaCasilla = "1330";  |HAZ LeeCas101;  #isow0023#5  = #isom0001#5;
     eaCasilla = "555";   |HAZ LeeCas101;  #isow0023#20 = #isom0001#5;
     eaCasilla = "556";   |HAZ LeeCas101;  #isow0023#21 = #isom0001#5;

     #isow0023#0  = #isom0000#29;
     #isow0023#6  = #isom0000#44;
     #isow0023#7  = #isom0000#45;
     #isow0023#8  = #isom0000#46;
     #isow0023#9  = #isom0000#47;
     #isow0023#10 = #isom0000#48;
     #isow0023#11 = #isom0000#49;
     #isow0023#12 = #isom0000#50;
     #isow0023#13 = #isom0000#51;
     #isow0023#14 = #isom0000#52;
     #isow0023#15 = #isom0000#53;
     #isow0023#16 = #isom0000#54;
     #isow0023#17 = #isom0000#55;
     #isow0023#18 = #isom0000#56;

     |SELECT #1#isom0001;
|FPRC;

|PROCESO GrabaCas101;
     #isom0001#0  = enEmpresa;
     #isom0001#1  = enAnyo;
     #isom0001#3  = eaCasilla;
     |LEE 101#isom0001.=;
     |SI FSalida = 0;
         #isom0001#5 = enValor;
         |GRABA 020#isom0001.a;
     |FINSI;
     |LIBERA #isom0001;
|FPRC;

|PROCESO isow0023;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Agrupaciones de inter‚s econ¢mico y UTES (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;
         #isow0023#19 = #isom0000#57;

         |HAZ CargaCampos23;

         |PINPA #0#isow0023;
         |PINDA #0#isow0023;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0023;

     |ABRE #isom0006;

     |SELECT #2#isom0006;

     |HAZ CargaCampos23;

     |PINPA #0#isow0023;
     |PINDA #0#isow0023;
     |ENDATOS #1#isow0023;
     |SI FSalida = 0;
         #isom0000#29 = #isow0023#0;
         #isom0000#44 = #isow0023#6;
         #isom0000#45 = #isow0023#7;
         #isom0000#46 = #isow0023#8;
         #isom0000#47 = #isow0023#9;
         #isom0000#48 = #isow0023#10;
         #isom0000#49 = #isow0023#11;
         #isom0000#50 = #isow0023#12;
         #isom0000#51 = #isow0023#13;
         #isom0000#52 = #isow0023#14;
         #isom0000#53 = #isow0023#15;
         #isom0000#54 = #isow0023#16;
         #isom0000#55 = #isow0023#17;
         #isom0000#56 = #isow0023#18;

         |GRABA 020#isom0000.a;

         |SELECT #2#isom0001;
         eaCasilla = "555";  enValor = #isow0023#20;   |HAZ GrabaCas101;
         eaCasilla = "556";  enValor = #isow0023#21;   |HAZ GrabaCas101;
         |SELECT #1#isom0001;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0006;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Correcciones al resultado contable (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0006";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0026;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Reserva de capitalizaci¢n (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0026";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0027;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Reserva de nivelaci¢n (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0027";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0028;
     eaCasilla = aCasilla;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     |SI eaCasilla = "1040";
         aAlfa =  aAlfa + "Reversi¢n de medidas temporales D.T. 37.1 LIS (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |FINSI;

     |SI eaCasilla = "1041";
         aAlfa =  aAlfa + "Reversi¢n de medidas temporales D.T. 37.2 LIS (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |FINSI;

     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0028";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0009;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Detalle de la compensaci¢n Bases Imponibles Negativas (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;
     |SUB_EJECUTA_NP "isom0009";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0010;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Detalle de la compensaci¢n de Cuotas (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0010";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0011;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Deducciones (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0011";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0012;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Doble imposici¢n (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0012";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isow0019;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Conversi¢n de activos (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 1655, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         #isow0019#0 = #isom0000#121;
         #isow0019#1 = #isom0000#122;
         #isow0019#2 = #isom0000#123;
         #isow0019#3 = #isom0000#124;

         |PINPA #0#isow0019;
         |PINDA #0#isow0019;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0019;

     #isow0019#0 = #isom0000#121;
     #isow0019#1 = #isom0000#122;
     #isow0019#2 = #isom0000#123;
     #isow0019#3 = #isom0000#124;

     |PINPA #0#isow0019;
     |PINDA #0#isow0019;
     |ENDATOS #1#isow0019;
     |SI FSalida = 0;
         #isom0000#121 = #isow0019#0;
         #isom0000#122 = #isow0019#1;
         #isom0000#123 = #isow0019#2;
         #isom0000#124 = #isow0019#3;

         |GRABA 020#isom0000.a;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isow0020;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Conversi¢n de activos (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 1655, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 1;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         #isow0020#0 = #isom0000#121;

         |PINPA #0#isow0020;
         |PINDA #0#isow0020;
         |PAUSA;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = nVentana;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |DESTRUYECONTROL nGrid;

         |FINVENTANA nVentana;

         |PULSATECLA;

         |ACABA;
     |FINSI;

     |ABRE #isom0000;
     #isom0000#0 = #maempr10#0;
     #isom0000#1 = #maempr10#1;
     |LEE 101#isom0000.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |GRABA 020#isom0000.b;
     |FINSI;

     |DDEFECTO #isow0020;

     |SELECT #2#isom0001;

     |SI #maempr10#1 [ 2014;
                                                #isow0020#0 = #isom0000#121;
         eaCasilla   = "150";  |HAZ LeeCas101;  #isow0020#1 = #isom0001#5;
         eaCasilla   = "506";  |HAZ LeeCas101;  #isow0020#2 = #isom0001#5;
     |FINSI;

     |SI #maempr10#1 ] 2015;
                                                #isow0020#0 = #isom0000#121;
         eaCasilla   = "1020";  |HAZ LeeCas101; #isow0020#1 = #isom0001#5;
         eaCasilla   = "1043";  |HAZ LeeCas101; #isow0020#1 = #isow0020#1 + #isom0001#5;
         eaCasilla   = "1021";  |HAZ LeeCas101; #isow0020#2 = #isom0001#5;
         eaCasilla   = "1044";  |HAZ LeeCas101; #isow0020#2 = #isow0020#2 + #isom0001#5;
     |FINSI;

     |PINPA #0#isow0020;
     |PINDA #0#isow0020;
     |ENDATOS #1#isow0020;
     |SI FSalida = 0;
         #isom0000#121 = #isow0020#0;

         |GRABA 020#isom0000.a;

         |SI #maempr10#1 [ 2014;
             enValor   = #isow0020#1;
             eaCasilla = "150";
             |HAZ GrabaCas101;

             enValor   = #isow0020#2;
             eaCasilla = "506";
             |HAZ GrabaCas101;
         |FINSI;

         |SI #maempr10#1 ] 2015;
             eaCasilla = "625"; |HAZ LeeCas101; nPorce2 = #isom0001#5;

             enValor   = (#isow0020#1 % nPorce2) ! 2;
             eaCasilla = "1020";
             |HAZ GrabaCas101;

             enValor   = #isow0020#1 - enValor;
             eaCasilla = "1043";
             |HAZ GrabaCas101;

             enValor   = (#isow0020#2 % nPorce2) ! 2;
             eaCasilla = "1021";
             |HAZ GrabaCas101;

             enValor   = #isow0020#2 - enValor;
             eaCasilla = "1044";
             |HAZ GrabaCas101;
         |FINSI;
     |FINSI;

     |LIBERA #isom0000;
     |CIERRA #isom0000;

     |SELECT #1#isom0001;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0031;
     eaCasilla = aCasilla;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     |VENTANA 0501, 3499, -1, 16, " Activos por impuesto diferido (AID), DT 33 y DA 13 LIS";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0031";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0032;
     eaCasilla = aCasilla;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     |VENTANA 0501, 3499, -1, 16, " Activos por impuesto diferido (AID), Art. 130 LIS";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0032";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO isom0033;
     eaCasilla = aCasilla;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     |VENTANA 0501, 3499, -1, 16, "Exceso cuota liquida positiva (art.130.1 y DT.33.4 LIS)";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     |SUB_EJECUTA_NP "isom0033";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRC;

|PROCESO TreeActivos;
     |SI FEntrada = 0;
         |ACABA;
     |FINSI;

     aContenido = Contenido % -101;

     |SI aContenido = "1";  |HAZ isom0031;  |FINSI;
     |SI aContenido = "2";  |HAZ isom0032;  |FINSI;
     |SI aContenido = "3";  |HAZ isow0020;  |FINSI;
     |SI aContenido = "4";  |HAZ isom0033;  |FINSI;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Activos;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 000#isom0001.=;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, NULL;
     nGrid = FSalida;

     |REFRESCACONTROL nGrid;

     |VENTANA 2030, 2795, -1, 17, "Conversi¢n de activos";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";      |MKDIR aAlfa;

     |HAZ LeeUnidadBasico;

     eaRutaOrigen  = aBase + "tmp/";
     eaRutaDestino = eaUnidadBasico + "\MODELOS";            |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP";        |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP\";
     eaFicheroTxt  = "isom0001" + Usuario + ".txt";
     eaFicheroTgz  = "isom0001" + Usuario + ".tgz";
     eaFicheroTar  = "isom0001" + Usuario + ".tar";

     sT_nID   = nTree;
     sT_nOper = 0;

     aAbre = eaRutaOrigen + eaFicheroTxt;
     |XABRE "WB", aAbre, nHandle;

     nConta = 0;

     nConta = nConta + 1;
     eaAlfa = nConta + ":Activos por impuesto diferido (AID), DT 33 y DA 13 LIS. {{1}}";
     |HAZ CargaArbol;

     nConta = nConta + 1;
     eaAlfa = nConta + ":Activos por impuesto diferido (AID), Art.130 LIS. {{2}}";
     |HAZ CargaArbol;

     nConta = nConta + 1;
     eaAlfa = nConta + ":Conversion de activos por impueto diferido en credito exigible {{3}}";
     |HAZ CargaArbol;

     nConta = nConta + 1;
     eaAlfa = nConta + ":Exceso cuota liquida positiva (art.130.1 y DT.33.4 LIS) {{4}}";
     |HAZ CargaArbol;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL, Tabla de contenidos {{" + aAlfa + "}}";
     |CONTROL_SIMPLE 0, eaAlfa, 2031, 2594, TreeActivos;
     nTree = FSalida;

     eaFicheroTxt  = "isom0001" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}sali&R," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA nVent;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     #isom0500#0 = #isom0001#1;
     #isom0500#1 = #isom0001#2;
     |LEE 000#isom0500.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0500;  |FINSI;

     |SI #isom0500#4 ! "I";  |ACABA;  |FINSI;

     |GRABA 020#isom0001.a;
     |LIBERA #isom0001;

     nLinea = #isom0001#2;

     enCuaccpar = 1;
     |HAZ TotalFich101;
     enCuaccpar = 0;

     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#2 = nLinea;
     |LEE 101#isom0001.=;

     aAlfa = "|IDGRID";
     aAlfa = #isom0001#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |C_M #isom0001#5, 1, "N";

     #isom0500#0 = #isom0001#1;
     #isom0500#1 = #isom0001#2;
     |LEE 000#isom0500.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0500;  |FINSI;

     |SI #isom0500#4 ! "I";  |ACABA;  |FINSI;

     |SI enZEC  = 0;
         |SI #isom0001#3 = "559  ";  |O #isom0001#3 = "1035 ";
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enSOCIMI = 0;
         |SI #isom0001#3 = "520  ";   |ACABA;  |FINSI;
         |SI #isom0001#3 = "521  ";   |ACABA;  |FINSI;
         |SI #isom0001#3 = "522  ";   |ACABA;  |FINSI;
         |SI #isom0001#3 = "523  ";   |ACABA;  |FINSI;
     |FINSI;

     |SI enForales = 0;
         |SI #isom0001#3 = "050  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "051  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "052  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "053  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "054  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "055  ";  |ACABA;  |FINSI;
         |SI #isom0001#3 = "056  ";  |ACABA;  |FINSI;
     |FINSI;

     |C_M #isom0001#5, 1, "S";
|FPRC;

|PROCESO IntroDatos;
     aCasilla = #isom0001#3;  |QBF aCasilla;
     nLinea   = #isom0001#2;
     nSal     = 1;
     |PTEC 807;
|FPRC;

|PROCESO Evento101;
     |SI FSalida = 1;
         |SI nBotonDat ! -1;
             |FIN_CONTROL_WINDOWS nBotonDat;
             nBotonDat = -1;
             |PULSATECLA;
         |FINSI;

         |SI nSal = 0;
             nLinea = #isom0001#2;
         |FINSI;

         #isom0001#2 = nLinea;
         |LEE 000#isom0001.=;

         |SI nSal = 1;
             aAlfa = "|IDGRID";
             aAlfa = #isom0001#aAlfa#;
             nGrid = aAlfa;
             |REFRESCACONTROL nGrid;
         |FINSI;

         nSal = 0;

         #isom0500#0 = #isom0001#1;
         #isom0500#1 = #isom0001#2;
         |LEE 000#isom0500.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0500;  |FINSI;

         |SI #isom0500#4 = "T";  |ACABA;  |FINSI;
         |SI #isom0500#4 = "I";  |ACABA;  |FINSI;

         |SI #isom0001#3 = "547  ";
             |SI enCooperativa ! 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #isom0001#3 = "578  ";  |O #isom0001#3 = "579  ";
             |SI enNavieras = 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #isom0001#3 = "553  ";  |O #isom0001#3 = "554  ";
          |O #isom0001#3 = "561  ";  |O #isom0001#3 = "1510 ";
             |SI enCooperativa = 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #isom0001#3 = "555  ";  |O #isom0001#3 = "556  ";
             |SI enTranspa = 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #isom0001#3 = "550  ";
             |SI enNavieras = 1;  |ACABA;  |FINSI;
         |FINSI;

         |SI #isom0001#3 = "1020 ";  |O #isom0001#3 = "1021 ";
          |O #isom0001#3 = "1043 ";  |O #isom0001#3 = "1044 ";
             |SI enGrupos = 1;  |ACABA;  |FINSI;
         |FINSI;

         aAlfa = "BOTON,C     T     R     L         &A " + (" " * 15) + "{{197}}";
         aAlfa = aAlfa + (" " * 15) + "C     T     R     L         &A";

         |CONTROL_SIMPLE 0, aAlfa, 0696, 3199, IntroDatos;
         nBotonDat = FSalida;
         |PULSATECLA;
     |FINSI;
|FPRC;

|PROCESO isom0500;
     #isom0001#0  = enEmpresa;
     #isom0001#1  = #isom0500#0;
     #isom0001#2  = #isom0500#1;
     |LEE 101#isom0001.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0001;
         #isom0001#0  = enEmpresa;
         #isom0001#1  = #isom0500#0;
         #isom0001#2  = #isom0500#1;
         |GRABA 020#isom0001.b;
     |FINSI;

     |SI #isom0001#1 ] 2016; |Y #isom0001#3 = "901  ";
         |BORRA 020#isom0001.a;
         |LIBERA #isom0001;

         |ACABA;
     |FINSI;

     #isom0001#3  = #isom0500#2;
     #isom0001#4  = #isom0500#3;

     eaTipoColor = #isom0500#5;
     |HAZ CogeColor;
     #isom0001#6 = eaColor;

     |GRABA 020#isom0001.a;
     |LIBERA #isom0001;
|FPRC;

|DEFBUCLE isom0500;
     #isom0500#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0500;
|FIN;

|PROCESO MontaEstructura500;
     |BUCLE isom0500;
|FPRC;

|PROCESO BotonAnota;
     eaCasilla    = #isom0001#3;  |QBF eaCasilla;
     eaTitCasilla = #isom0001#3;

     |SI eaCasilla = "";   |ACABA;  |FINSI;

     |SUB_EJECUTA "isom0499";
|FPRC;

|PROCESO Baja101;
     #isom0001#0  = enEmpresa;
     #isom0001#1  = enAnyo;
     #isom0001#2  = 1;
|FPRC;

|PROCESO Alta101;
     #isom0001#0  = enEmpresa;
     #isom0001#1  = enAnyo;
     #isom0001#2  = 9999;
|FPRC;


|PROGRAMA;
     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |ABRE #ca8m0000;
     #ca8m0000#0 = #maempr10#102;
     |LEE 000#ca8m0000.=;
     |SI FSalida ! 0;  |DDEFECTO #ca8m0000;  |FINSI;
     |CIERRA #ca8m0000;

     enNavieras    = 0;
     enCooperativa = 0;
     enTranspa     = 0;
     enZEC         = 0;
     enSOCIMI      = 0;
     enPeqDimen    = 0;
     enNovaCrea    = 0;
     enForales     = 0;
     enGrupos      = 0;

     |ABRE #maempr11;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 9;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enGrupos = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 10;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enGrupos = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 22;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enNavieras = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 17;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 18;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 2;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 13;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enTranspa = 13;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 14;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enTranspa = 14;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 15;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enZEC = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 12;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enSOCIMI = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 6;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enPeqDimen = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 63;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enNovaCrea = 1;  |FINSI;

     #maempr11#0 = #maempr10#0;
     #maempr11#1 = #maempr10#1;
     #maempr11#2 = 28;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enForales = 1;  |FINSI;

     |SI enCooperativa ! 0;
         enTranspa = 0;
         enZEC     = 0;
         enSOCIMI  = 0;
     |FINSI;

     |CIERRA #maempr11;

     |HAZ MontaEstructura500;

     nSal   = 0;
     enCuaccpar = 1;
     |HAZ TotalFich101;
     enCuaccpar = 0;
     nLinea = 5;

     |PARA;  |SI;  |HACIENDO;
          |VENTANA 0501, 3499, -1, 1, "";
          n0Vent = FSalida;

          |PINPA #0#isom0001;
          nPanta = FSalida;

          |CONTROL_SIMPLE 0, "BOTON,{{197}}Sa&Lir", 3485, 3498, BotonSalir;
          nBotonSal = FSalida;

          |CONTROL_SIMPLE 0, "BOTON,{{197}} a&Notaciones de la casilla", 3302, 3425, BotonAnota;
          nBotonAnota = FSalida;

          #isom0001#0 = #maempr10#0;
          #isom0001#1 = #maempr10#1;
          #isom0001#2 = nLinea;
          |LEE 000#isom0001.=;

          |SI enModoConsulta = 0;
              nRango = 1 + 2 + 4 + 8 + 16 + 128 + 256;
          |SINO;
              nRango = 2 + 4 + 8 + 16 + 128 + 256;
          |FINSI;

          |LINEAL_SIMPLE #1#isom0001, nRango, 0602, 3495, Baja101, Alta101, Evento101;

          |FIN_CONTROL_WINDOWS nBotonSal;
          |FIN_CONTROL_WINDOWS nBotonAnota;

          |SI nSal = 0;
              |FINVENTANA n0Vent;
              |SAL;
          |FINSI;

          |SI nBotonDat ! -1;
              |FIN_CONTROL_WINDOWS nBotonDat;
          |FINSI;

          |QBF aCasilla;

          |SI aCasilla = "500";  |HAZ Balance;   |FINSI;

          |SI aCasilla = "545";  |HAZ isom0006;  |FINSI;
          |SI aCasilla = "550";  |HAZ isom0006;  |FINSI;
          |SI aCasilla = "578";  |HAZ isom0006;  |FINSI;
          |SI aCasilla = "593";  |HAZ isom0006;  |FINSI;

          |SI aCasilla = "1032"; |HAZ isom0026;  |FINSI;
          |SI aCasilla = "579";  |HAZ isow0001;  |FINSI;
          |SI aCasilla = "547";  |HAZ isom0009;  |FINSI;
          |SI aCasilla = "1509"; |HAZ isom0009;  |FINSI;

          |SI aCasilla = "1033"; |HAZ isom0027;  |FINSI;
          |SI aCasilla = "1034"; |HAZ isom0027;  |FINSI;

          |SI aCasilla = "553";  |HAZ Coopera;   |FINSI;
          |SI aCasilla = "554";  |HAZ Coopera;   |FINSI;

          |SI aCasilla = "561";  |HAZ isom0010;  |FINSI;
          |SI aCasilla = "1510"; |HAZ isom0010;  |FINSI;

          |SI aCasilla = "585";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "584";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "590";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "588";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "082";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "565";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "083";  |HAZ isom0011;  |FINSI;
          |SI aCasilla = "408";  |HAZ isom0011;  |FINSI;

          |SI #maempr10#1 [ 2014;
              |SI aCasilla = "555";  |HAZ isow0003;  |FINSI;
              |SI aCasilla = "556";  |HAZ isow0003;  |FINSI;
              |SI aCasilla = "570";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "571";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "572";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "573";  |HAZ isom0012;  |FINSI;
          |FINSI;

          |SI #maempr10#1 ] 2015;
              |SI aCasilla = "555";  |HAZ isow0023;  |FINSI;
              |SI aCasilla = "556";  |HAZ isow0023;  |FINSI;
              |SI aCasilla = "1332"; |HAZ isom0011;  |FINSI;
              |SI aCasilla = "570";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "571";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "572";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "573";  |HAZ isom0012;  |FINSI;
          |FINSI;

          |SI #maempr10#1 ] 2016;
              |SI aCasilla = "1344";  |HAZ isom0012;  |FINSI;
              |SI aCasilla = "1280";  |HAZ isom0012;  |FINSI;
          |FINSI;

          |SI aCasilla = "1040"; |HAZ isom0028;  |FINSI;
          |SI aCasilla = "1041"; |HAZ isom0028;  |FINSI;

          |SI #maempr10#1 [ 2014;
              |SI aCasilla = "506";  |HAZ isow0020;  |FINSI;

              |SI aCasilla = "150";
                  |SI #maempr10#1 [ 2013;  |HAZ isow0019;  |FINSI;
                  |SI #maempr10#1 ] 2014;  |HAZ isow0020;  |FINSI;
              |FINSI;
          |FINSI;

          |SI #maempr10#1 [ 2015;
              |SI aCasilla = "1020";  |HAZ isow0020;  |FINSI;
              |SI aCasilla = "1021";  |HAZ isow0020;  |FINSI;
              |SI aCasilla = "1043";  |HAZ isow0020;  |FINSI;
              |SI aCasilla = "1044";  |HAZ isow0020;  |FINSI;
          |FINSI;

          |SI #maempr10#1 ] 2016;
              |SI aCasilla = "1020";  |HAZ Activos;  |FINSI;
              |SI aCasilla = "1021";  |HAZ Activos;  |FINSI;
              |SI aCasilla = "1043";  |HAZ Activos;  |FINSI;
              |SI aCasilla = "1044";  |HAZ Activos;  |FINSI;
          |FINSI;

          |SI enModoConsulta = 0;
              enCuaccpar = 1;
              |HAZ TotalFich101;
              enCuaccpar = 0;
          |FINSI;

          |FINVENTANA n0Vent;
     |SIGUE;

     |SUB_EJECUTA "isoz0002;CHEQUEO";

     |SI nBotonDat ! -1;
         |FIN_CONTROL_WINDOWS nBotonDat;
     |FINSI;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80m1;  |TIPO 80;
     |ABRET #isom0001;
     |ABRET #isom0500;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90m1;  |TIPO 90;
     |CIERRAT #isom0001;
     |CIERRAT #isom0500;
|FPRC;
