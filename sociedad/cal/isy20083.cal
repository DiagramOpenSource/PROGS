|FICHEROS;
      :agicli/agicontr;
      :agicli/agim0019;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aIPRemoto      = "";
     aCadena        = "";
     aLen           = "";
     aCaracter      = "";

     nLen           = 0;
     nNume          = 0;
     nPos           = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;

     &enCanti       = 0;
     &enHandle      = 0;
     &eaAlfa         = "";
     &eaEfectivo     = "";
     &eaAdeudo       = "";
     &eaEntidad      = "";
     &eaOficina      = "";
     &eaDC           = "";
     &eaCuenta       = "";
     &eaNomEnt       = "";
     &eaNomOfi       = "";
     &enModelo       = 0;
     &enAnyo         = 0;
     &enBanco        = 0;
     &enFormaPag     = 0;
     &enForzar       = 0;
     &enError        = 0;
|FIN;

|PROCESO QuitaRaros;
     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;
|FPRC;

|PROCESO Calcula3E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula2E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula5E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00000" + aAlfa1) % -105) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula3E4D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
|FPRC;

|PROCESO Calcula17D;
     enCanti = enCanti * 100;
     enCanti = enCanti ! 0;

     |SI enCanti ] 0;
         aAlfa = enCanti;
         eaAlfa = ("00000000000000000" + aAlfa) % -117;
     |SINO;
         enCanti  = -enCanti;
         aAlfa   = enCanti;
         eaAlfa   = "N" + (("0000000000000000" + aAlfa) % -116);
     |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO OtrasAplica;
     |DBASS aAlfa; |QBF aAlfa;
     |PATH_DAT #agicontr#aAlfa#;
     |ABRE #agicontr;
     |LEE 040#agicontr.p;
     |SI FSalida ! 0;
         #agicontr#8  = aAlfa + "agicli/fich/";
     |FINSI;
     |CIERRA #agicontr;

     aAlfa = #agicontr#8;  |QBF aAlfa;
     |SI aAlfa = "";
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "agicli/fich/";
     |FINSI;

     |PATH_DAT #agim0019#aAlfa#;
|FPRC;
