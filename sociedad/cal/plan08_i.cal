|FICHEROS;
     :/agicont/def/ca8ctrle #400;  ||Control Empresa
     :/agicont/def/ca8comay #401;  ||Control Empresa
     :/agicont/def/ca8eqmay #402;  ||Control Empresa

     :/agicont/def/ca8cumay #410;
     :/agicont/def/ca8m0002 #422;
     :/agicont/def/ca8m0010 #430;
     :/agicont/def/canempre #330;
     imagen@  #11;
|FIN;

|VARIABLES;
 aAlfa1     = "";
 aAlfa2     = "";
 aAlfa3     = "";
 nNume1     = 0;
 nNume2     = 0;
 nNume3     = 0;
 period     = 0;
 nHay       = 0;

 mascara    = "";
 aLong      = "";
 nLong      = 0;
 nLong1     = 0;
 nLong2     = 0;
 nLongMax   = 0;
 nEstado    = 0;


 nSalir = 0;
 mes    = "";
 mesdes = "";
 meshas = "";
 num    = 0;

 nProv8 = 0;
 aMas   = "";
 aDef   = "";
 uno    = "";
 dos    = "";
|FIN;

|INCLUYE varcon_i;
|INCLUYE varbal_i;

|PROCESO aContra8y9;
   |QBF eaCuenta;
   aAlfa1 = eaCuenta % 0;
   nLongMax = aAlfa1;
   |SI dig3 = 1; nLongMax  = dig4; |FINSI;
   |SI dig3 = 2; nLongMax  = dig5; |FINSI;
   |SI dig3 = 3; nLongMax  = dig6; |FINSI;
   |SI dig3 = 4; nLongMax  = dig7; |FINSI;
   |SI dig3 = 5; nLongMax  = dig8; |FINSI;
   |SI dig3 = 6; nLongMax  = dig9; |FINSI;

   eSwT8y9   = 1;
   eaCon8y9  = "";
   eaTit8y9  = "";
   eaRaiz89 = "";

   |ABRE #430;
   |DDEFECTO #430;

   uno = eaCuenta; |QBF uno;
   dos = uno + "000000000000";

   uno = dos % A105; nLong1 = 5;  || no doy opcion a la de 5
   #430#5 = enEjerBal;
   #430#0 = eNum2008;
   #430#1 = uno;
   |LEE 040#430=;
   |SI FSalida = 0;  |HAZ Datos8y9;  |ACABA;  |FINSI;

   uno = dos % A104; nLong1 = 4;
   #430#5 = enEjerBal;
   #430#0 = eNum2008;
   #430#1 = uno;
   |LEE 040#430=;
   |SI FSalida = 0;  |HAZ Datos8y9;  |ACABA;  |FINSI;

   uno = dos % A103; nLong1 = 3;
   #430#5 = enEjerBal;
   #430#0 = eNum2008;
   #430#1 = uno;
   |LEE 040#430=;
   |SI FSalida = 0;  |HAZ Datos8y9;  |ACABA;  |FINSI;

   uno = dos % A102; nLong1 = 2;
   #430#5 = enEjerBal;
   #430#0 = eNum2008;
   #430#1 = uno;
   |LEE 040#430=;
   |SI FSalida = 0;  |HAZ Datos8y9;  |ACABA;  |FINSI;

   uno = dos % A101; nLong1 = 1;
   #430#5 = enEjerBal;
   #430#0 = eNum2008;
   #430#1 = uno;
   |LEE 040#430=;
   |SI FSalida = 0;
       |HAZ Datos8y9;
   |SINO;
       |CIERRA #402;
   |FINSI;
|FPRC;

|PROCESO Datos8y9;
   |CIERRA #430;

   eSwT8y9  = 0;
   eaRaiz89 = "";
   eaCon8y9 = "";
   eaTit8y9 = "";;
   aAlfa3   = #430#3; |QBF aAlfa3;
   eaRaiz89 = aAlfa3;

   aAlfa1    = aAlfa3 % -101;
   |SI aAlfa1 = "*";
       eaCon8y9 = aAlfa3;
       eaRaiz89 = eaCon8y9 - aAlfa1;
       eSwT8y9 = 3;
       |ACABA;
   |FINSI;

   aAlfa1 = aAlfa3 % 0;
   nNume1 = aAlfa1;    || Longitud del Cambio
   nNume2 = nNume1 + 100; nLong2 = nNume1;

   |SI aAlfa3 = "";
       eSwT8y9 = 2;
       |ACABA;
   |FINSI;

   nNume3 = 0 - ((nLongMax - nLong2) + 100)
   aAlfa1 = eaCuenta % nNume2;
   aAlfa2 = eaCuenta % nNume3;

   eaCon8y9 = aAlfa3 + aAlfa2;

   |SI enEnContagen = 0; |ACABA; |FINSI;

   |HAZ SacaelNivel;

   |DBASS aMas;
   aDef = aMas + "agicont/def/cacuenta";
   |CARGA_DEF aDef, imagen@;
   |SI FSalida ! 0; |ACABA; |FINSI;
   |PATH_DAT #11 aPathConta;

   |ABRE #11;
   #11#0 = eaCon8y9;
   #11#1 = enNivel;
   |LEE 041#11=;
   |SI FSalida = 0;
       enNivel  = #11#1;
       eaTit8y9 = #11#2;
   |SINO;
       nNume2 = 100 + nLongMax;
       eaCon8y9 = (aAlfa3 + "000000000000") % nNume2;
       |HAZ SacaelNivel;
       #11#0 = eaCon8y9;
       #11#1 = enNivel;
       |LEE 041#11=;
       |SI FSalida = 0;
           enNivel  = #11#1;
           eaTit8y9 = #11#2;
       |SINO;
           eaCon8y9 = aAlfa3;
       |FINSI;
   |FINSI;
   |CIERRA #11;
   |DESCARGA_DEF #11;
|FPRC;

|PROCESO SacaelNivel;
   aLong = eaCon8y9;
   |QBF aLong;
   aLong = aLong % 0;
   nLong = aLong;
   enNivel = 0;
   |SI nLong = dig4; |Y dig4 ! 0; enNivel = 1; |FINSI;
   |SI nLong = dig5; |Y dig5 ! 0; enNivel = 2; |FINSI;
   |SI nLong = dig6; |Y dig6 ! 0; enNivel = 3; |FINSI;
   |SI nLong = dig7; |Y dig7 ! 0; enNivel = 4; |FINSI;
   |SI nLong = dig8; |Y dig8 ! 0; enNivel = 5; |FINSI;
   |SI nLong = dig9; |Y dig9 ! 0; enNivel = 6; |FINSI;
|FPRC;
