|FICHEROS;
     maempr10;

     isom0001;
     isom0007;
     isom0008;
     isom0009;
     isom0010;
     isom0011;
     isom0012;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aIPRemoto      = "";
     aCadena        = "";
     aLen           = "";
     aCaracter      = "";

     nLen           = 0;
     nNume          = 0;
     nPos           = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nNegativo      = 0;

     &enCanti       = 0;
     &enHandle      = 0;
     &eaAlfa         = "";
     &enError        = 0;
     &eaCasilla      = "";
|FIN;

|PROCESO QuitaRaros;
     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;
|FPRC;

|PROCESO Calcula3E2D;
     nNegativo = 0;
     |SI enCanti < 0;
         nNegativo = 1;
         enCanti   = -enCanti;
     |FINSI;

     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nNegativo = 0;
         eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
     |SINO;
         eaAlfa = "N" + (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
     |FINSI;
|FPRC;

|PROCESO Calcula2E2D;
     nNegativo = 0;
     |SI enCanti < 0;
         nNegativo = 1;
         enCanti   = -enCanti;
     |FINSI;

     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nNegativo = 0;
         eaAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
     |SINO;
         eaAlfa = "N" + (("00" + aAlfa1) % -101) + ((aAlfa2 + "00") % 102);
     |FINSI;
|FPRC;

|PROCESO Calcula5E2D;
     nNegativo = 0;
     |SI enCanti < 0;
         nNegativo = 1;
         enCanti   = -enCanti;
     |FINSI;

     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nNegativo = 0;
         eaAlfa = (("00000" + aAlfa1) % -105) + ((aAlfa2 + "00") % 102);
     |SINO;
         eaAlfa = "N" + (("00000" + aAlfa1) % -104) + ((aAlfa2 + "00") % 102);
     |FINSI;
|FPRC;

|PROCESO Calcula3E4D;
     nNegativo = 0;
     |SI enCanti < 0;
         nNegativo = 1;
         enCanti   = -enCanti;
     |FINSI;

     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nNegativo = 0;
         eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
     |SINO;
         eaAlfa = "N" + (("000" + aAlfa1) % -102) + ((aAlfa2 + "0000") % 104);
     |FINSI;
|FPRC;

|PROCESO Calcula17D;
     enCanti = enCanti * 100;
     enCanti = enCanti ! 0;

     |SI enCanti ] 0;
         aAlfa = enCanti;
         eaAlfa = ("00000000000000000" + aAlfa) % -117;
     |SINO;
         enCanti  = -enCanti;
         aAlfa   = enCanti;
         eaAlfa   = "N" + (("0000000000000000" + aAlfa) % -116);
     |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO LeeFich101;
     |ABRE #isom0001;
     |SELECT #2#isom0001;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#3 = eaCasilla;
     |LEE 000#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     |CIERRA #isom0001;
|FPRC;

|PROCESO LeeFich107;
     |ABRE #isom0007;
     |SELECT #2#isom0007;
     #isom0007#0 = #maempr10#0;
     #isom0007#1 = #maempr10#1;
     #isom0007#4 = eaCasilla;
     |LEE 000#isom0007.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0007;  |FINSI;
     |CIERRA #isom0007;
|FPRC;

|PROCESO LeeFich108;
     |ABRE #isom0008;
     |SELECT #1#isom0008;
     #isom0008#0 = #maempr10#0;
     #isom0008#1 = #maempr10#1;
     #isom0008#2 = eaCasilla;
     |LEE 000#isom0008.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0008;  |FINSI;
     |CIERRA #isom0008;
|FPRC;

|PROCESO LeeFich109;
     |ABRE #isom0009;
     |SELECT #2#isom0009;
     #isom0009#0 = #maempr10#0;
     #isom0009#1 = #maempr10#1;
     #isom0009#5 = eaCasilla;
     |LEE 000#isom0009.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0009;  |FINSI;
     |CIERRA #isom0009;
|FPRC;

|PROCESO LeeFich110;
     |ABRE #isom0010;
     |SELECT #2#isom0010;
     #isom0010#0 = #maempr10#0;
     #isom0010#1 = #maempr10#1;
     #isom0010#5 = eaCasilla;
     |LEE 000#isom0010.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0010;  |FINSI;
     |CIERRA #isom0010;
|FPRC;

|PROCESO LeeFich111;
     |ABRE #isom0011;
     |SELECT #2#isom0011;
     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = eaCasilla;
     |LEE 000#isom0011.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0011;  |FINSI;
     |CIERRA #isom0011;
|FPRC;

|PROCESO LeeFich112;
     |ABRE #isom0012;
     |SELECT #2#isom0012;
     #isom0012#0 = #maempr10#0;
     #isom0012#1 = #maempr10#1;
     #isom0012#4 = eaCasilla;
     |LEE 000#isom0012.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0012;  |FINSI;
     |CIERRA #isom0012;
|FPRC;
