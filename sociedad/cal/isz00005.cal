|FICHEROS;
     isocie46 #0;
     isocie17 #1;
     isocie18 #2;
     isocie21 #3;
     isocie37 #4;
     isocie43 #5;
     isocie44 #6;
     isocie45 #7;
     isocie47 #8;
     isocie52 #9;
     isocie48 #10;
     isocie53 #12;
     isocie54 #14;
     isocie40 #15;

     maempr01 #98;
     isz00005 #99;
|FIN;

|VARIABLES;
     &empresa  = 0;
     &anyo     = 0;

     FEstado   = 0;
     Gravamen  = 0;
     OperaUno  = 0;
     OperaDos  = 0;
     OperaTres = 0;
     Opera26   = 0;
     Compara   = 0;
|FIN;

|PROCESO carga_15;
|SI #15#3 = 2; Opera26 = Opera26 + #15#8; |FINSI;
|FPRC;

|DEFBUCLE isocie40;
#15#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, carga_15;
|FIN;

|PROCESO carga_17;
|SI #1#3 = 1; #0#21 = #0#21 +   #1#7 % 5;                 |FINSI;
|SI #1#3 = 2; #0#21 = #0#21 +   #1#7 % 10;                |FINSI;
|SI #1#3 = 3; #0#22 = #0#22 + ((#1#7 % Gravamen) % 50);   |FINSI;
|SI #1#3 = 4; #0#23 = #0#23 + ((#1#7 % Gravamen) % 100);  |FINSI;
|FPRC;

|DEFBUCLE isocie17;
#1#1;
;
empresa, anyo, 00;
empresa, anyo, 99;
e;
NULL, carga_17;
|FIN;

|PROCESO carga_18;
#0#24 = #0#24 + (#2#5 - #2#6);
|FPRC;

|DEFBUCLE isocie18;
#2#1;
;
empresa, anyo, 00;
empresa, anyo, 99;
e;
NULL, carga_18;
|FIN;

|PROCESO carga_12;
OperaUno = OperaUno + (#12#5 - #12#6 + #12#7);
OperaDos = OperaDos + #12#4;
|FPRC;

|DEFBUCLE isocie53;
#12#1;
;
empresa, anyo, 00;
empresa, anyo, 99;
e;
NULL, carga_12;
|FIN;

|PROCESO carga_37;
|SI #4#3 = 1; #0#30 = #0#30 + ((#4#6 - #4#7) % #4#5); |FINSI;
|SI #4#3 = 2; #0#31 = #0#31 + ((#4#6 - #4#7) % #4#5); |FINSI;
|SI #4#3 = 3; #0#28 = #0#28 + ((#4#6 - #4#7) % #4#5); |FINSI;
|SI #4#3 = 4; #0#29 = #0#29 + ((#4#6 - #4#7) % #4#5); |FINSI;
|FPRC;

|DEFBUCLE isocie37;
#4#1;
;
empresa, anyo, 00;
empresa, anyo, 99;
e;
NULL, carga_37;
|FIN;

|PROCESO carga_54;
|SI #14#3 = 1; #0#30 = #0#30 + ((#14#6 - #14#7 + #14#8) % #14#5); |FINSI;
|SI #14#3 = 2; #0#31 = #0#31 + ((#14#6 - #14#7 + #14#8) % #14#5); |FINSI;
|SI #14#3 = 3; #0#28 = #0#28 + ((#14#6 - #14#7 + #14#8) % #14#5); |FINSI;
|SI #14#3 = 4; #0#29 = #0#29 + ((#14#6 - #14#7 + #14#8) % #14#5); |FINSI;
|FPRC;

|DEFBUCLE isocie54;
#14#1;
;
empresa, anyo, 00;
empresa, anyo, 99;
e;
NULL, carga_54;
|FIN;

|PROGRAMA;
|PINPA #0#99;
|ABRE #0;
#0#0 = empresa;
#0#1 = anyo;
|LIBERA #0;
|LEE 140#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; |FINSI;

#0#0  = empresa;
#0#1  = anyo;
#0#21 = 0;
#0#22 = 0;
#0#23 = 0;
#0#24 = 0;
#0#26 = 0;
#0#28 = 0;
#0#29 = 0;
#0#30 = 0;
#0#31 = 0;
OperaUno  = 0;
OperaDos  = 0;
OperaTres = 0;
Opera26   = 0;
Compara   = 0;

|BUCLE isocie40;

|SI anyo [ 1994;
    Gravamen = #0#14;
    |SI Gravamen = 0; Gravamen = 35; |FINSI;

    |BUCLE isocie17;
    |BUCLE isocie18;
    |BUCLE isocie37;
|SINO;
    OperaUno = 0;
    OperaDos = 0;

    Gravamen = #0#14;
    |SI Gravamen = 0; Gravamen = 35; |FINSI;

    |BUCLE isocie53;
    |SI anyo = 1995; |BUCLE isocie54; |FINSI;
    |HAZ calculo_94;

    Gravamen = #0#14;
    |SI Gravamen = 0; Gravamen = 35; |FINSI;
    OperaTres = OperaUno % Gravamen;
    |SI OperaTres > OperaDos; OperaTres = OperaDos; |FINSI;
    #0#24 = OperaTres;
    Compara = #0#20 - #0#21 - #0#22 - #0#23;
    |SI Compara < OperaTres; #0#24 = Compara; |FINSI;
    |SI #0#24 < 0; #0#24 = 0; |FINSI;
    #0#26 = Opera26;

    |BUCLE isocie17;

    Compara = #0#20 - #0#21 - #0#22 - #0#23 - #0#24 - #0#25;
    |SI Compara < Opera26; #0#26 = Compara; |FINSI;
    |SI #0#26 < 0; #0#26 = 0; |FINSI;
|FINSI;

|ABRE #3;
#3#0 = empresa;
#3#1 = anyo;
|LEE 040#3=;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;
|CIERRA #3;

|SI anyo = 1994;
    |ABRE #5;
    #5#0 = empresa;
    #5#1 = anyo;
    |LEE 040#5=;
    |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
    |CIERRA #5;

    |ABRE #7;
    #7#0 = empresa;
    #7#1 = anyo;
    |LEE 040#7=;
    |SI FSalida ! 0; |DDEFECTO #7; |FINSI;
    |CIERRA #7;
|FINSI;

|SI anyo = 1995;
    |ABRE #9;
    #9#0 = empresa;
    #9#1 = anyo;
    |LEE 040#9=;
    |SI FSalida ! 0; |DDEFECTO #9; |FINSI;
    |CIERRA #9;

    |ABRE #10;
    #10#0 = empresa;
    #10#1 = anyo;
    |LEE 040#10=;
    |SI FSalida ! 0; |DDEFECTO #10; |FINSI;
    |CIERRA #10;
|FINSI;

|ABRE #6;
#6#0 = empresa;
#6#1 = anyo;
|LEE 040#6=;
|SI FSalida ! 0; |DDEFECTO #6; |FINSI;
|CIERRA #6;

|ABRE #8;
#8#0 = empresa;
#8#1 = anyo;
|LEE 040#8=;
|SI FSalida ! 0; |DDEFECTO #8; |FINSI;
|CIERRA #8;

|SI #3#3 = "N"; #0#17 = " "; |SINO; #0#17 = "X"; |FINSI;
|SI #3#2 = "S"; #0#44 = "X"; |SINO; #0#44 = " "; |FINSI;

#0#68 = #3#14;
#0#64 = (#3#17 / (#3#15 - #3#16)) * 100;
#0#65 = (#3#18 / (#3#15 - #3#16)) * 100;
#0#66 = (#3#19 / (#3#15 - #3#16)) * 100;
#0#67 = (#3#20 / (#3#15 - #3#16)) * 100;
#0#63 = 100 - #0#64 - #0#65 - #0#65 - #0#66;
#0#45 = (#0#63 / 100) * (#0#42 - #0#43);
#0#46 = ((#0#64 + #0#65 + #0#66 + #0#67) / 100) * (#0#42 - #0#43);
#0#47 = #3#4;
#0#49 = #3#5;
#0#51 = #3#6;
#0#48 = #3#7;
#0#50 = #3#8;
#0#52 = #3#9;
#0#53 = #0#45 - #0#47 - #0#49 - #0#51;
#0#54 = #0#46 - #0#48 - #0#50 - #0#52;
#0#55 = #3#10;
#0#56 = #3#11;
#0#57 = (#0#53 + #0#55) % #3#14;
#0#58 = (#0#54 + #0#56) % #3#14;
#0#59 = #3#12;
#0#60 = #3#13;

|SI anyo = 1994;
    #0#34 = #5#39;
    #0#35 = #5#60;
    #0#36 = #5#108;
    #0#37 = #5#147;
    #0#38 = #5#138;
    #0#39 = #5#129;
    #0#2  = #6#92;
    #0#3  = #7#40;
    #0#4  = #7#41;
|FINSI;

|SI anyo = 1995;
    #0#34 = #9#33;
    #0#35 = #9#57;
    #0#36 = #9#90;
    #0#37 = #9#141;
    #0#38 = #9#126;
    #0#39 = #9#111;
    #0#2  = #6#92;
    #0#3  = #10#43;
    #0#4  = #10#44;
|FINSI;

#0#10 = #8#18;
#0#11 = #8#28;

|HAZ calculo_94;

|SI FEstado ! 0; |GRABA 140#0n; |SINO; |GRABA 140#0a; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO calculo_94;
|ABRE #98;
#98#0 = empresa;
#98#1 = anyo;
|LEE 040#98=;
|SI FSalida ! 0; |DDEFECTO #98; |FINSI;
|CIERRA #98;

#0#5  = #0#2 + (#0#3 - #0#4);
||#0#7  = 0;

|SI #98#36 = "X"; |O #98#37 = "X";
    |SI #0#5 > 0; #0#7 = #0#5 % 50; |FINSI;
|FINSI;

#0#9  = #0#5 - (#0#6 + #0#7 + #0#8);

|HAZ cuota_94;

#0#18 = #0#15 + #0#16;

#0#20 = #0#18 - #0#19;
|SI #0#20 < 0; #0#20 = 0; |FINSI;

#0#27 = #0#20 - #0#21 - #0#22 - #0#23 - #0#24 - #0#25 - #0#26;
|SI #0#27 < 0; #0#27 = 0; |FINSI;

#0#32 = #0#27 - #0#28 - #0#29 - #0#30 - #0#31;
|SI #0#32 < 0; #0#32 = 0; |FINSI;

#0#40 = #0#32 - #0#33 - #0#34 - #0#35 - #0#36 - #0#37 - #0#38 - #0#39;
|SI #0#40 < 0; #0#40 = 0; |FINSI;

#0#42 = #0#40 - #0#41;

#0#63 = 100 - #0#64 - #0#65 - #0#66 - #0#67;

#0#45 = (#0#63 / 100) * (#0#42 - #0#43);
#0#46 = ((#0#64 + #0#65 + #0#66 + #0#67) / 100) * (#0#42 - #0#43);

#0#53 = #0#45 - #0#47 - #0#49 - #0#51;
#0#54 = #0#46 - #0#48 - #0#50 - #0#52;

#0#57 = (#0#53 + #0#55) % #0#68;
#0#58 = (#0#54 + #0#56) % #0#68;

#0#61 = #0#53 + #0#55 + #0#57 + #0#59;
#0#62 = #0#54 + #0#56 + #0#58 + #0#60;
|FPRC;

|PROCESO cuota_94; |TIPO 0;
|SI #0#17 = " "; #0#13 = 0; #0#14 = 35; |FINSI;

#0#15 = 0;
#0#16 = #0#9 % #0#14;
||SI #0#16 < 0; #0#16 = 0; |FINSI;
#0#12 = #0#14;

|SI #0#10 = 0; |Y #0#11 = 0; |ACABA; |FINSI;

|SI #0#17 = " "; #0#13 = 35;  #0#14 = 20; |FINSI;

|SI #0#10 = 0; #0#13 = 0; |FINSI;
|SI #0#11 = 0; #0#14 = 0; |FINSI;

#0#15 = #0#10 % #0#13;
||SI #0#15 < 0; #0#15 = 0; |FINSI;

#0#16 = #0#11 % #0#14;
||SI #0#16 < 0; #0#16 = 0; |FINSI;

|SI #0#10 ! 0;
    #0#12 = #0#13;
|SINO;
    #0#12 = #0#14;
|FINSI;
|FPRC;
