|FICHEROS;
   soda8m00 #0;
   maacceso #1;
   soda8m01 #2;
   sodacoli #3;
   agiconpa #4;
   sodacuen #8;
   sodirect #9;

   :/agicont/def/ca8eqmay #800;
   :/agicont/def/canempre #30;
   :/agicont/def/ca8m0003 #403;
|FIN;

|VARIABLES;
   nNume1 = 0;
   nNume2 = 0;
   nNume3 = 0;
   nNume4 = 0;
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";
   aAlfa4 = "";
   cuenta = "";
   nCrear = 0;
   aPath  = "";
   aParam = "";
   nAny   = 0;
   nLinea  = 0;
   inkey = 0;
   f1    = "823";
   tecla = "";
   opcion = 0;
   &eaPlanillaS = "";
   &enEjerS     = 0;
   &eaPrograma  = "";
   &eaExtension = "";

   aCta2008 = "";
   eaPlan8  = "";
   nLinApun = 0;
   uno      = "";
   dos      = "";
   nLong1   = 0;
   nLong2   = 0;
   aNombre  = "";
   nAlgun   = 0;

   &enPlan      = 0;
   &enEmpresa   = 0;
   &eaNombreEmp = "";
   &enEjer      = 0;
   &aPathConta   = "";
   empresa      = "";
   &eaCuenta    = "";
|FIN;

|CALCULO pintanom; |TIPO 6;
 |ABRE #1;
 |SELECT #1#1;
 #1#0 = #0#0;
 #1#1 = #0#1;
 |LEE 040#1=;
 |SI FSalida = 0;
     #0#2 = #1#2;
     |PINTA #0#2;
 |SINO;
    |MENAV "     No existe Empresa en el Ejercicio 2008";
    |ERROR;
 |FINSI;
 |CIERRA #1;
|FCAL;

|PROCESO Tipo5; |TIPO 5;
  FSalida = "SINBARRA";
|FPRC;

|PROCESO cuenta; |TIPO 6;
      nNume1  = Campo + 1;
      enPlan = 2008;
      |SI Campo = 2; enPlan = 1990; |FINSI;
      |ABRE #8;
      #8#2 = enPlan;
      #8#0 = #2Campo;
      |LEE 001#8=;
      |SI FSalida = 0;
          #2nNume1= #8#1; |PINTA #2nNume1;
      |SINO;
          #8#2 = enPlan;
          #8#0 = #2Campo;
          |GRABA 020#8n;
      |FINSI;
      |CIERRA #8;
|FPRC;

|PROCESO cuefin;
         nNume1 = Campo + 1;
         enPlan = 2008;
         |SI Campo = 2; enPlan = 1990; |FINSI;
         |ABRE #8;
         #8#2 = enPlan;
         #8#0 = #2Campo;
         |LEE 001#8=;
         |SI FSalida ! 0;
             #8#2 = enPlan;
             #8#0 = #2Campo;
             #8#1 = #2nNume1;
             |GRABA 020#8n;
         |FINSI;
         |CIERRA #8;
|FPRC;

|PROCESO LeeCta;
      |ABRE #8;
      #8#2 = enPlan;
      #8#0 = eaCuenta;
      |LEE 001#8=;
      |SI FSalida = 0;
         aNombre = #8#1;
      |FINSI;
      |CIERRA #8;
|FPRC;

|CALCULO traspaso8; |TIPO 0;
    opcion    = (FEntrada / 100) ! 0;
    |SI opcion ! 1; |ACABA; |FINSI;

    enEmpresa = #0#0;
    enEjer    = 2008;
    |MENSA "0415Pulse <F1> calculo tabla. (si existe la pasa de contabilidad)";
    |LEETECLA tecla;
    f1 = &255 + "823";
    |BLIN 04;

    inkey = FSalida;
    |SI tecla = f1;
        |HAZ ElPase;
    |FINSI;
|FCAL;
|| ---------------------------------------------------------------------

|PROCESO Leosodacoli;
    |SELECT #3#2;
    #2#0 = enEmpresa;
    #2#2 = #3#3;
    |LEE 001#2=;
    |SI FSalida = 0;
        nLinApun = #2#1;
    |SINO;
        nLinApun = nLinea;
    |FINSI;
    |SELECT #1#2;

    eaCuenta = #3#3;
    uno = eaCuenta; |QBF uno;
    dos = uno + "000000000000";

    uno = dos % A104; nLong1 = 4;
    #800#0 = 0;
    #800#1 = uno;
    |LEE 040#800=;
    |SI FSalida = 0;  |HAZ Datos08;  |ACABA;  |FINSI;

    uno = dos % A103; nLong1 = 3;
    #800#0 = 0;
    #800#1 = uno;
    |LEE 040#800=;
    |SI FSalida = 0;  |HAZ Datos08;  |ACABA;  |FINSI;

    uno = dos % A102; nLong1 = 2;
    #800#0 = 0;
    #800#1 = uno;
    |LEE 040#800=;
    |SI FSalida = 0;
        |HAZ Datos08;
    |FINSI;
|FPRC;

|PROCESO Datos08;
   enPlan   = 2008;
   eaPlan8  = #800#3;
   |QBF eaPlan8;

   aAlfa1 = eaPlan8 % 0;
   nNume1 = aAlfa1;     || Longitud del Cambio
   nNume2 = nNume1 + 100; nLong2 = nNume1;

   nNume3 = 0 - ((12 - nLong2) + 100)
   aAlfa1 = eaCuenta % nNume2;
   aAlfa2 = eaCuenta % nNume3;

   |SI aAlfa1 = eaPlan8;
       aCta2008 = eaCuenta;
   |SINO;
       aCta2008 = eaPlan8 + aAlfa2;
   |FINSI;

   |SI aCta2008 ! eaCuenta;
       |DDEFECTO #2;
       #2#0 = enEmpresa;
       #2#1 = nLinApun;
       |LEE 101#2=;
       |SI FSalida ! 0;
           |DDEFECTO #2;
           #2#0 = enEmpresa;
           #2#1 = nLinApun;
           #2#2 = #3#3;
           #2#3 = #3#4;
           |GRABA 020#2b;
       |FINSI;
       #2#4 = aCta2008;
       aNombre = #3#4; |HAZ LeeCta;
       #2#5 = aNombre;
       |GRABA 020#2a;
       |SI #2#1 = nLinea;
           nLinea = nLinea + 1;
       |FINSI;
       nAlgun = 1;
   |FINSI;
|FPRC;

|DEFBUCLE Leosodacoli;
 #3#1;
 ;
 enEmpresa, nAny, 0001;
 enEmpresa, nAny, 9999;
 ;
 NULL, Leosodacoli;
|FIN;

|PROCESO PasoUnoaUno;
 nAny = 2007;
 |ABRE #3;
 #3#0 = enEmpresa;
 #3#1 = nAny;
 #3#2 = 9999;
 |LEE 040#3];
 |SI FSalida = 0;
     |LEE 040#3a;
 |SINO;
     |LEE 040#3u;
 |FINSI;
 |SI FSalida = 0; |Y #3#0 = enEmpresa;
     nAny = #3#1;
 |FINSI;
 |CIERRA #3;

 |ABRE #2;
 #2#0 = enEmpresa;
 #2#1 = 9999;
 |LEE 040#2];
 |SI FSalida = 0;
     |LEE 040#2a;
 |SINO;
     |LEE 040#2u;
 |FINSI;
 nLinea = 1;
 |SI FSalida = 0; |Y #2#0 = enEmpresa;
     nLinea = #2#1 + 1;
 |FINSI;
 |CIERRA #2;

 |ABRE #800;
 |ABRE #2;
 |BUCLE Leosodacoli;
 |CIERRA #2;
 |CIERRA #800;
|FPRC;

|| /////////////////////////////////////////////////////////////////////
|PROCESO BorraTabla;
 |BORRA 020#2a
 |LIBERA #2;
|FPRC;

|DEFBUCLE BorraTabla;
 #2#1;
 ;
 enEmpresa, 0001;
 enEmpresa, 9999;
 be;
 NULL, BorraTabla;
|FIN;

|PROCESO PasarTabla;
 |SI #403#0 ! #403#2;
     #2#0 = enEmpresa;
     #2#1 = nLinea;
     |LEE 001#2=;
     |SI FSalida ! 0;
          |DDEFECTO #2;
          #2#0 = enEmpresa;
          #2#1 = nLinea;
          #2#2 = #403#0;
          #2#3 = #403#1;
          #2#4 = #403#2;
          #2#5 = #403#3;
          |GRABA 020#2n;
     |FINSI;
     nLinea = nLinea + 1;
     nAlgun = 1;
 |FINSI;
|FPRC;

|DEFBUCLE PasarTabla;
 #403#1;
 ;
 "            ";
 "zzzzzzzzzzzz";
 e;
 NULL, PasarTabla;
|FIN;

|PROCESO Elpasetabla;
  nAlgun = 0;
  |SI aParam ! "";
      #0#0 = enEmpresa;
      |LEE 101#0=;
      |SI FSalida = 0;
          |SI nCrear = 1; |BUCLE BorraTabla; |FINSI;
      |SINO;
           #0#0 = enEmpresa;
           #0#1 = 2008;
           #0#2 = eaNombreEmp;
           |GRABA 020#0b;
       |FINSI;
  |FINSI;
  |SI nCrear = 1;
      nLinea = 1;
     |ABRE #2;
     |BUCLE PasarTabla;
     |CIERRA #2;
  |SINO;
     |HAZ PasoUnoaUno;
  |FINSI;
  |SI aParam ! "";
      |SI nAlgun = 0; |BORRA 020#0a; |FINSI;
      |LIBERA #0;
  |FINSI;
|FPRC;

|PROCESO laempresa;
  aAlfa1 = #30#2; aAlfa1 = ("00000" + aAlfa1) % -105;
  aAlfa2 = #30#3; aAlfa2 = ("0"     + aAlfa2) % -101;
  empresa = aAlfa1 + aAlfa2;
  aPath = aPathConta + empresa +  "/";
  |PATH_DAT #403 aPath;
  nCrear = 1;
|FPRC;

|DEFBUCLE laempresa;
 #30#1;
 26;
 enEmpresa, 0, nAny;
 enEmpresa, 9, nAny;
 e;
 NULL, laempresa;
|FIN;

|PROCESO ElPase;
     nCrear = 0;
     |SI aPathConta ! "";
         aAlfa1 = enEjer;
         aAlfa1 = aAlfa1 % -102;
         nAny   = aAlfa1;
         |BUCLE laempresa;
     |FINSI;
     |HAZ Elpasetabla;
|FPRC;

|PROGRAMA;
 |HAZ BusquedaApli;

 || ... Tablas estandar que necesita
     enEjerS = 2008; eaPlanillaS = "sodacuen";  |HAZ PlanDePlanillasS;
     |ABRE #800;
     |LEE 001#800p;
     |SI FSalida ! 0;
         |MENAV "    Instale los ficheros patrones de Contabilidad";
         |CIERRA #800;
     |FINSI;
     |CIERRA #800;
 || ......................................................................

 aParam = PARAMETRO; |QBF aParam;
 |SI aParam = "Pase";
     |ABRE #0;
     |HAZ ElPase;
     |CIERRA #0;
 |SINO;
     |MANTE #0;
 |FINSI;
|FPRO;

|PROCESO BusquedaApli;
 |ABRE #9;
 |LEE 040#9p;
 |SI FSalida ! 0;
     |CIERRA #9;
     |MENAV "    No existe directorio de Contabilidad";
     |ACABA;
 |FINSI;
 |CIERRA #9;

 aPathConta = #9#2;  |QBF aPathConta;
|FPRC;
