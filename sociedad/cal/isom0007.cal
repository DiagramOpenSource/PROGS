|FICHEROS;
     isom0006;
     isom0007;
     isom0506;

     maempr10;
|FIN;

|VARIABLES;
      nRango         = 0;
      nBotonSal      = 0;
      nBotonAnota    = -1;
      nTree          = 0;
      nHandle        = 0;
      nPanta         = 0;
      nBotonLabel    = 0;
      nVentana       = 0;
      nVent          = 0;
      nGrid          = 0;
      nModo          = 0;
      nLinea         = 0;
      nBorraTodo     = 0;

      aContenido     = "";
      aTexto         = "";
      aBase          = "";
      aAlfa          = "";
      aAbre          = "";
      aEsc1          = "";
      aEsc2          = "";
      aRetu          = "";
      aTecla         = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &eaCasilla      = "";
     &eaTitCasilla   = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaTipoColor    = "";
     &eaColor        = "";
     &enModoConsulta = 0;
|FIN;


|PROCESO Tipo1;  |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |HAZ Tipo1;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     #isom0506#0 = #isom0007#1;
     #isom0506#1 = #isom0007#2;
     |LEE 000#isom0506.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0506;  |FINSI;

     |SI #isom0506#5 ! "I";  |ACABA;  |FINSI;

     |GRABA 020#isom0007.a;
     |LIBERA #isom0007;

     nLinea = #isom0007#2;

     |HAZ TotalFich107;

     #isom0007#0 = #maempr10#0;
     #isom0007#1 = #maempr10#1;
     #isom0007#2 = nLinea;
     |LEE 101#isom0007.=;

     aAlfa = "|IDGRID";
     aAlfa = #isom0007#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |C_M #isom0007#5, 1, "N";
     |C_M #isom0007#7, 1, "N";

     #isom0506#0 = #isom0007#1;
     #isom0506#1 = #isom0007#2;
     |LEE 000#isom0506.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0506;  |FINSI;

     |SI #isom0506#5 ! "I";  |ACABA;  |FINSI;

     |SI #isom0007#4 ! "     ";  |C_M #isom0007#5, 1, "S";  |FINSI;
     |SI #isom0007#6 ! "     ";  |C_M #isom0007#7, 1, "S";  |FINSI;
|FPRC;

|PROCESO Evento107;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#isom0007.=;
     |FINSI;
|FPRC;

|PROCESO isom0506;
     #isom0007#0  = enEmpresa;
     #isom0007#1  = #isom0506#0;
     #isom0007#2  = #isom0506#1;
     |LEE 101#isom0007.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0007;
         #isom0007#0  = enEmpresa;
         #isom0007#1  = #isom0506#0;
         #isom0007#2  = #isom0506#1;
         |GRABA 020#isom0007.b;
     |FINSI;

     #isom0007#3  = #isom0506#4;
     #isom0007#4  = #isom0506#2;
     #isom0007#6  = #isom0506#3;

     eaTipoColor = #isom0506#6;
     |HAZ CogeColor;
     #isom0007#8      = eaColor;

     |GRABA 020#isom0007.a;
     |LIBERA #isom0007;
|FPRC;

|DEFBUCLE isom0506;
     #isom0506#1;
     ;
     enAnyo, 0000;
     enAnyo, 0999;     || Hasta el 999 del 1000 para adelante es el isom0008
     ;
     NULL, isom0506;
|FIN;

|PROCESO MontaEstructura506;
     |BUCLE isom0506;
|FPRC;

|PROCESO isom0007;
     |SI nBorraTodo = 0;
         |SI #isom0007#5 ! 0;  |ACABA;  |FINSI;
         |SI #isom0007#7 ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |BORRA 020#isom0007.a;
     |LIBERA #isom0007;
|FPRC;

|DEFBUCLE isom0007;
     #isom0007#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0007;
|FIN;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO BotonAnota;
     eaCasilla = #isom0007#4;  |QBF eaCasilla;
     |SI eaCasilla = "";
         eaCasilla = #isom0007#6;  |QBF eaCasilla;
     |FINSI;

     |SI eaCasilla = "";   |ACABA;  |FINSI;

     eaTitCasilla = #isom0007#3;  |QBF eaTitCasilla;

     |SUB_EJECUTA "isom0499";
|FPRC;

|PROCESO Baja107;
     #isom0007#0  = enEmpresa;
     #isom0007#1  = enAnyo;
     #isom0007#2  = 1;
|FPRC;

|PROCESO Alta107;
     #isom0007#0  = enEmpresa;
     #isom0007#1  = enAnyo;
     #isom0007#2  = 9999;
|FPRC;


|PROGRAMA;
     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |HAZ MontaEstructura506;

     nBorraTodo = 0;

     #isom0007#0 = enEmpresa;
     #isom0007#1 = enAnyo;
     #isom0007#2 = 5;
     |LEE 000#isom0007.];

     |PINPA #0#isom0007;
     nPanta = FSalida;

     |PARA;  |SI;  |HACIENDO;
          |CONTROL_SIMPLE 0, "BOTON,{{197}} sal&Ir", 3488, 3498, BotonSalir;
          nBotonSal = FSalida;

          |CONTROL_SIMPLE 0, "BOTON,{{197}} a&Notaciones del detalle", 3302, 3425, BotonAnota;
          nBotonAnota = FSalida;

          |SI enModoConsulta = 0;
              nRango = 1 + 2 + 4 + 8 + 16 + 128 + 256;
          |SINO;
              nRango = 4 + 8 + 16 + 128 + 256;
          |FINSI;

          |LINEAL_SIMPLE #1#isom0007, nRango, 0502, 3498, Baja107, Alta107, Evento107;

          |ABRE #isom0006;
          |SELECT #2#isom0006;
          #isom0006#0 = #maempr10#0;
          #isom0006#1 = #maempr10#1;
          #isom0006#4 = "417";
          |LEE 000#isom0006.=;
          |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
          |CIERRA #isom0006;

          |SELECT #2#isom0007;
          #isom0007#0 = #maempr10#0;
          #isom0007#1 = #maempr10#1;
          #isom0007#4 = "417";
          |LEE 000#isom0007.=;
          |SI FSalida ! 0;  |DDEFECTO #isom0007;  |FINSI;

          |SELECT #1#isom0007;

          |FIN_CONTROL_WINDOWS nBotonSal;
          |FIN_CONTROL_WINDOWS nBotonAnota;

          |SI #isom0006#5 = #isom0007#5;  |Y #isom0006#7 = #isom0007#7;
              |SAL;
          |FINSI;

          |CONFI "0000NNo coinciden los importe de la 417 y 418. Cancelar introducci¢n";
          |SI FSalida = 0;
               nBorraTodo = 1;
               |SAL;
          |FINSI;
     |SIGUE;

     |BUCLE isom0007;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80m7;  |TIPO 80;
     |ABRET #isom0007;
     |ABRET #isom0506;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90m7;  |TIPO 90;
     |CIERRAT #isom0007;
     |CIERRAT #isom0506;
|FPRC;
