|FICHEROS;
     isom0200;
|FIN;

|VARIABLES;
     nVentana       = 0;
     nRango         = 0;
     nGrid          = 0;
     nImporte       = 0;

     aAlfa          = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aCasilla       = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &enModoConsulta = 0;
     &enSaltaError   = 0;
     &enCalcCif      = 0;
     &eaVarDni       = "";
|FIN;

|PROCESO LetraNif;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #isom0200#Campo#;
         |HAZ CalculoDNI;
         #isom0200#Campo# = eaVarDni;
         |PINTA #isom0200#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  =  #isom0200#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 109;
     |SI #isom0200#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #isom0200#Campo# = eaVarDni;
             |PINTA #isom0200#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja200;
     #isom0200#0  = enEmpresa;
     #isom0200#1  = enAnyo;
     #isom0200#2  = 1;
|FPRC;

|PROCESO Alta200;
     #isom0200#0  = enEmpresa;
     #isom0200#1  = enAnyo;
     #isom0200#2  = 99;
|FPRC;

|PROGRAMA;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Participaci¢n del declarante en entidades de atribuci¢n de rentas";

     |VENTANA 0501, 2099, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #isom0200;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#isom0200, nRango, 0602, 1898, Baja200, Alta200, NULL;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
            FSalida = "::{{001}}Salir," + nGrid;
            |LEETECLA aTecla;
            |SI aTecla = aEsc1; |SAL;  |FINSI;
            |SI aTecla = aEsc2; |SAL;  |FINSI;
            |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #isom0200;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRO;
