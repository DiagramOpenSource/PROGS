|FICHEROS;
   cubala04 #0;
|FIN;

|VARIABLES;
   &empresa = 0;
   &anyo    = 0;
   &nombre  = "";
   &nif     = "";
   &tipo    = "";
   &unid    = "";
   &modo    = 0;
   &sw_mod  = 0;

   anyo1    = 0;
   anyo2    = 0;
   x        = 0;
   tecla    = "";
   ntecla   = 0;
   avance   = "815";
   atras    = "814";
   FEstado  = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |HAZ nomodi; |ENDATOS #1#0; |FINSI;
|SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    #0#2 = nombre;
    #0#3 = nif;
    #0#4 = unid;
    #0#5 = tipo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
avance = &255 + avance;
atras  = &255 + atras;
#0#0   = empresa;
#0#1   = anyo;
|LEE 040#0=;
|SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
|PINPA #0#0;
|PINDA #0#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
|PINPA #1#0;
|PINDA #1#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
|PINPA #2#0;
|PINDA #2#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
|SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
|PINPA #3#0;
|PINDA #3#0;
|MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
|LEETECLA tecla;
|SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************
|PROCESO pintaany; |TIPO 13;
anyo2 = anyo - 1;
anyo1 = anyo;
|PINTA 963, anyo1;
|PINTA 975, anyo2;
|FPRC;

|PROCESO nomodi;
|SI sw_mod = 1;   |HAZ nomoaant; |FINSI;
|SI tipo   = "A"; |HAZ nomoabre; |FINSI;
|SI tipo   = "E"; |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO nomoaant;
|CAMPO_MODIFICA #0#006,1,"N"; |CAMPO_MODIFICA #0#007,1,"N";
|CAMPO_MODIFICA #0#008,1,"N"; |CAMPO_MODIFICA #0#009,1,"N";
|CAMPO_MODIFICA #0#010,1,"N"; |CAMPO_MODIFICA #0#011,1,"N";
|CAMPO_MODIFICA #0#012,1,"N"; |CAMPO_MODIFICA #0#013,1,"N";
|CAMPO_MODIFICA #0#014,1,"N"; |CAMPO_MODIFICA #0#015,1,"N";
|CAMPO_MODIFICA #0#016,1,"N"; |CAMPO_MODIFICA #0#017,1,"N";
|CAMPO_MODIFICA #0#018,1,"N"; |CAMPO_MODIFICA #0#019,1,"N";
|CAMPO_MODIFICA #0#020,1,"N"; |CAMPO_MODIFICA #0#021,1,"N";
|CAMPO_MODIFICA #0#022,1,"N"; |CAMPO_MODIFICA #0#023,1,"N";
|CAMPO_MODIFICA #0#024,1,"N"; |CAMPO_MODIFICA #0#025,1,"N";
|CAMPO_MODIFICA #0#026,1,"N"; |CAMPO_MODIFICA #0#027,1,"N";
|CAMPO_MODIFICA #0#028,1,"N"; |CAMPO_MODIFICA #0#029,1,"N";
|CAMPO_MODIFICA #0#030,1,"N"; |CAMPO_MODIFICA #0#031,1,"N";
|CAMPO_MODIFICA #0#032,1,"N"; |CAMPO_MODIFICA #0#033,1,"N";
|CAMPO_MODIFICA #0#034,1,"N"; |CAMPO_MODIFICA #0#035,1,"N";
|CAMPO_MODIFICA #0#036,1,"N"; |CAMPO_MODIFICA #0#037,1,"N";
|CAMPO_MODIFICA #0#038,1,"N"; |CAMPO_MODIFICA #0#039,1,"N";
|CAMPO_MODIFICA #0#040,1,"N"; |CAMPO_MODIFICA #0#041,1,"N";
|CAMPO_MODIFICA #0#042,1,"N"; |CAMPO_MODIFICA #0#043,1,"N";
|CAMPO_MODIFICA #0#044,1,"N";
|FPRC;

|PROCESO nomoabre;
|SI sw_mod = 0;
    |CAMPO_MODIFICA #0#008,1,"N"; |CAMPO_MODIFICA #0#009,1,"N";
    |CAMPO_MODIFICA #0#010,1,"N"; |CAMPO_MODIFICA #0#011,1,"N";
    |CAMPO_MODIFICA #0#017,1,"N"; |CAMPO_MODIFICA #0#018,1,"N";
    |CAMPO_MODIFICA #0#019,1,"N"; |CAMPO_MODIFICA #0#021,1,"N";
    |CAMPO_MODIFICA #0#022,1,"N"; |CAMPO_MODIFICA #0#023,1,"N";
    |CAMPO_MODIFICA #0#024,1,"N";
|FINSI;

|CAMPO_MODIFICA #0#047,1,"N"; |CAMPO_MODIFICA #0#048,1,"N";
|CAMPO_MODIFICA #0#049,1,"N"; |CAMPO_MODIFICA #0#050,1,"N";
|CAMPO_MODIFICA #0#056,1,"N"; |CAMPO_MODIFICA #0#057,1,"N";
|CAMPO_MODIFICA #0#058,1,"N"; |CAMPO_MODIFICA #0#060,1,"N";
|CAMPO_MODIFICA #0#061,1,"N"; |CAMPO_MODIFICA #0#062,1,"N";
|CAMPO_MODIFICA #0#063,1,"N";
|FPRC;

|PROCESO nomoexte;
|CAMPO_MODIFICA #0#016,1,"N"; |CAMPO_MODIFICA #0#020,1,"N";
|CAMPO_MODIFICA #0#055,1,"N"; |CAMPO_MODIFICA #0#059,1,"N";
|FPRC;

|PROCESO totales; |TIPO 0;
|SI tipo = "E";
    #0#008 = #0#009 + #0#010 + #0#011;                   |PINTA #0#008;
    #0#016 = #0#017 + #0#018 + #0#019;                   |PINTA #0#016;
    #0#020 = #0#021 + #0#022 + #0#023 + #0#024;          |PINTA #0#020;
    #0#047 = #0#048 + #0#049 + #0#050;                   |PINTA #0#047;
    #0#055 = #0#056 + #0#057 + #0#058;                   |PINTA #0#055;
    #0#059 = #0#060 + #0#061 + #0#062 + #0#063;          |PINTA #0#059;
|FINSI;
#0#012 = #0#013 + #0#014;                                |PINTA #0#012;
#0#051 = #0#052 + #0#053;                                |PINTA #0#051;
#0#026 = #0#027 + #0#028 + #0#029 + #0#030;              |PINTA #0#026;
#0#065 = #0#066 + #0#067 + #0#068 + #0#069;              |PINTA #0#065;
#0#006 = #0#007 + #0#008 + #0#012 + #0#015 + #0#016;
#0#006 = #0#006 + #0#020 + #0#026 + #0#031 + #0#032;
#0#006 = #0#006 + #0#035 + #0#036 + #0#037 + #0#038;
#0#006 = #0#006 + #0#039 + #0#042 + #0#043;              |PINTA #0#006;
#0#045 = #0#046 + #0#047 + #0#051 + #0#054 + #0#055;
#0#045 = #0#045 + #0#059 + #0#065 + #0#070 + #0#071;
#0#045 = #0#045 + #0#074 + #0#075 + #0#076 + #0#077;
#0#045 = #0#045 + #0#078 + #0#081 + #0#082;              |PINTA #0#045;
|FPRC;
