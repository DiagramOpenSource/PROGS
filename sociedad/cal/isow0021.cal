|FICHEROS;
     maempr10;
     maempr11;
     isom0514;

     :agicli/agim0020;

     isow0021;
     isow0022,MANTE;
|FIN;

|VARIABLES;
     n0Vent         = 0;
     n1Vent         = 0;
     nRango         = 0;
     nGrid          = 0;
     nFicha         = 0;

     aAlfa          = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aFicTmp        = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

    &enEmpresa      = 0;
    &enAnyo         = 0;
    &eaVerde        = "";
    &eaGris         = "";
    &enModoConsulta = 0;
|FIN;

|PROCESO Tipo12Fw22;  |TIPO 12;
|FPRC;

|PROCESO PideGrupo;
     |VENTANA 0501, 1050, -1, 16, "";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI nFicha = 0;
         |SI #maempr11#2 = 9;
             #isow0022#2 = "";  |C_M #isow0022#2, 1, "N";
         |FINSI;

         |SI #maempr11#2 = 10;
             |LIBERA #maempr11;
             #maempr11#0 = enEmpresa;
             #maempr11#1 = enAnyo;
             #maempr11#2 = 9;
             |LEE 000#maempr11.=;
             |SI FSalida ! 0;  |DDEFECTO #maempr11;  |FINSI;

             #isow0022#1 = #maempr11#5;

             |C_M #isow0022#2, 1, "S";
             #maempr11#0 = enEmpresa;
             #maempr11#1 = enAnyo;
             #maempr11#2 = 10;
             |LEE 101#maempr11.=;
             |SI FSalida ! 0;  |DDEFECTO #maempr11;  |FINSI;

             #isow0022#2 = #maempr11#5;

             #maempr11#0 = enEmpresa;
             #maempr11#1 = enAnyo;
             #maempr11#2 = 10;
         |FINSI;
     |FINSI;

     |SI nFicha = 1;
         |SI #agim0020#1 = 9;
             #isow0022#2 = "";  |C_M #isow0022#2, 1, "N";
         |FINSI;

         |SI #agim0020#1 = 10;
             |LIBERA #agim0020;
             #agim0020#0 = enEmpresa;
             #agim0020#1 = 9;
             |LEE 000#agim0020.=;
             |SI FSalida ! 0;  |DDEFECTO #agim0020;  |FINSI;

             #isow0022#1 = #agim0020#4;

             |C_M #isow0022#2, 1, "S";

             #agim0020#0 = enEmpresa;
             #agim0020#1 = 10;
             |LEE 101#agim0020.=;
             |SI FSalida ! 0;  |DDEFECTO #agim0020;  |FINSI;

             #isow0022#2 = #agim0020#4;

             #agim0020#0 = enEmpresa;
             #agim0020#1 = 10;
         |FINSI;
     |FINSI;

     |PINPA #0#isow0022;
     |PINDA #0#isow0022;
     |PTEC 802;  |PAUSA;

     |ENDATOS #1#isow0022;
     |SI FSalida = 0;
         |SI nFicha = 0;
             #maempr11#4 = #isow0022#0;

             |SI #maempr11#2 = 9;
                 #maempr11#5 = #isow0022#1;
             |FINSI;

             |SI #maempr11#2 = 10;
                 #maempr11#5 = #isow0022#2;
             |FINSI;
         |FINSI;

         |SI nFicha = 1;
             #agim0020#3 = #isow0022#0;

             |SI #agim0020#1 = 9;
                 #agim0020#4 = #isow0022#1;
             |FINSI;

             |SI #agim0020#1 = 10;
                 #agim0020#4 = #isow0022#2;
             |FINSI;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO MAEMPR11;
     aAlfa = #isow0021#3;  |QBF aAlfa;
     |SI aAlfa = eaVerde;
         #maempr11#0 = enEmpresa;
         #maempr11#1 = enAnyo;
         #maempr11#2 = #isow0021#1;
         |LEE 101#maempr11.=;
         |SI FSalida = 0;
             |SI #maempr11#2 = 9;  |O #maempr11#2 = 10;
                 #isow0022#0 = #maempr11#4;
                 #isow0022#1 = #maempr11#5;

                 |HAZ PideGrupo;
                 |CONFI "0000SQuiere desactivar el caracter";
             |FINSI;

             |SI FSalida = 0;
                 #isow0022#2 = "";
                 #isow0021#3 = eaGris;
                 |BORRA 020#maempr11.a;
             |SINO;
                 |SI #maempr11#2 = 9;
                     |SI #maempr11#4 = 0;
                         #isow0021#3 = eaGris;
                     |SINO;
                         #isow0021#3 = eaVerde;
                     |FINSI;
                 |SINO;
                     #isow0021#3 = eaVerde;
                 |FINSI;
                 |GRABA 020#maempr11.a;
             |FINSI;

             |LIBERA #maempr11;
         |FINSI;
     |SINO;
         #isow0021#3 = eaVerde;

         #maempr11#0 = enEmpresa;
         #maempr11#1 = enAnyo;
         #maempr11#2 = #isow0021#1;
         |LEE 101#maempr11.=;
         |SI FSalida ! 0;
             |DDEFECTO #maempr11;
             #maempr11#0 = enEmpresa;
             #maempr11#1 = enAnyo;
             #maempr11#2 = #isow0021#1;
             #maempr11#3 = #isow0021#2;

             |SI #maempr11#2 = 9;  |O #maempr11#2 = 10;
                 |DDEFECTO #isow0022;
                 |HAZ PideGrupo;
             |FINSI;

             |GRABA 020#maempr11.n;
             |LIBERA #maempr11;
         |FINSI;
     |FINSI;

     |SI #isow0022#2 ! "         ";
         #maempr11#0 = enEmpresa;
         #maempr11#1 = enAnyo;
         #maempr11#2 = 9;
         |LEE 101#maempr11.=;
         |SI FSalida ! 0;
             |DDEFECTO #maempr11;
             #maempr11#0 = enEmpresa;
             #maempr11#1 = enAnyo;
             #maempr11#2 = 9;
             |GRABA 020#maempr11.b;
         |FINSI;

         #maempr11#5 = #isow0022#1;
         |GRABA 020#maempr11.a;
         |LIBERA #maempr11;
     |FINSI;
|FPRC;

|PROCESO AGIM0020;
     aAlfa = #isow0021#3;  |QBF aAlfa;
     |SI aAlfa = eaVerde;
         #agim0020#0 = enEmpresa;
         #agim0020#1 = #isow0021#1;
         |LEE 101#agim0020.=;
         |SI FSalida = 0;
             |SI #agim0020#1 = 9;  |O #agim0020#1 = 10;
                 #isow0022#0 = #agim0020#3;
                 #isow0022#1 = #agim0020#4;

                 |HAZ PideGrupo;
                 |CONFI "0000SQuiere desactivar el caracter";
             |FINSI;

             |SI FSalida = 0;
                 #isow0022#2 = "";
                 #isow0021#3 = eaGris;
                 |BORRA 020#agim0020.a;
             |SINO;
                 |SI #agim0020#1 = 9;
                     |SI #agim0020#3 = 0;
                         #isow0021#3 = eaGris;
                     |SINO;
                         #isow0021#3 = eaVerde;
                     |FINSI;
                 |SINO;
                     #isow0021#3 = eaVerde;
                 |FINSI;
                 |GRABA 020#agim0020.a;
             |FINSI;
             |LIBERA #agim0020;
         |FINSI;
     |SINO;
         #isow0021#3 = eaVerde;

         #agim0020#0 = enEmpresa;
         #agim0020#1 = #isow0021#1;
         |LEE 101#agim0020.=;
         |SI FSalida ! 0;
             |DDEFECTO #agim0020;
             #agim0020#0 = enEmpresa;
             #agim0020#1 = #isow0021#1;
             #agim0020#2 = #isow0021#2;

             |SI #agim0020#1 = 9;  |O #agim0020#1 = 10;
                 |DDEFECTO #isow0022;
                 |HAZ PideGrupo;
             |FINSI;

             |GRABA 020#agim0020.n;
             |LIBERA #agim0020;
         |FINSI;
     |FINSI;

     |SI #isow0022#2 ! "         ";
         #agim0020#0 = enEmpresa;
         #agim0020#1 = 9;
         |LEE 101#agim0020.=;
         |SI FSalida ! 0;
             |DDEFECTO #agim0020;
             #agim0020#0 = enEmpresa;
             #agim0020#1 = 9;
             |GRABA 020#agim0020.b;
         |FINSI;

         #agim0020#4 = #isow0022#1;
         |GRABA 020#agim0020.a;
         |LIBERA #agim0020;
     |FINSI;
|FPRC;

|PROCESO Evnt;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#isow0021.=;
     |FINSI;

     |SI enModoConsulta = 1; |ACABA; |FINSI;

     |SI FSalida = 4;
         |SI #isow0021#1 = "     ";
             |ACABA;
         |FINSI;

         |SI #isow0021#1 = "073  ";
             |MENAV "0000Car cter todav¡a sin aprobar.";
             |ACABA;
         |FINSI;

         |LEE 101#isow0021.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |DDEFECTO #isow0022;

         |SI nFicha = 0;  |HAZ MAEMPR11;  |FINSI;
         |SI nFicha = 1;  |HAZ AGIM0020;  |FINSI;

         |GRABA 020#isow0021.a;
         |LIBERA #isow0021;

         |REFRESCACONTROL nGrid;
     |FINSI;
|FPRC;

|PROGRAMA;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;
     aAlfa =  aAlfa + "Car teres de la declaraci¢n (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3299, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 0;
         |CONTROL_SIMPLE 0, "LABEL,{{15}}Doble click en el registro para activar o desactivar", 0502, 0550, NULL;
     |FINSI;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}En verde caracteres activados", 0572, 0598, NULL;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#isow0021, nRango, 0602, 3098, NULL, NULL, Evnt;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}sal&Ir," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
     |PULSATECLA;
|FPRO;

|PROCESO isom0514;
     |DDEFECTO #isow0021;
     #isow0021#0 = #isom0514#1;
     #isow0021#1 = #isom0514#2;
     #isow0021#2 = #isom0514#3;
     #isow0021#3 = "";

     |SI #isom0514#5 = "G";
         #isow0021#3 = eaGris;
     |FINSI;

     |SI nFicha = 0;
         #maempr11#0 = enEmpresa;
         #maempr11#1 = enAnyo;
         #maempr11#2 = #isom0514#2;
         |LEE 000#maempr11.=;
         |SI FSalida = 0;
             |SI #maempr11#2 = 9;
                 |SI #maempr11#4 ! 0;
                     #isow0021#3 = eaVerde;
                 |FINSI;
             |SINO;
                 #isow0021#3 = eaVerde;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nFicha = 1;
         #agim0020#0 = enEmpresa;
         #agim0020#1 = #isom0514#2;
         |LEE 000#agim0020.=;
         |SI FSalida = 0;
             |SI #agim0020#1 = 9;
                 |SI #agim0020#3 ! 0;
                     #isow0021#3 = eaVerde;
                 |FINSI;
             |SINO;
                 #isow0021#3 = eaVerde;
             |FINSI;
         |FINSI;
     |FINSI;

     |GRABA 020#isow0021.n;
     |LIBERA #isow0021;
|FPRC;

|DEFBUCLE isom0514;
     #isom0514#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0514;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     |HAZ CargaColores;

     aAlfa  = PARAMETRO % 104;  enAnyo    = aAlfa;
     aAlfa  = PARAMETRO % 505;  enEmpresa = aAlfa;

     nFicha = 0;
     |SI enAnyo = 0;
         |ABRE #isom0514;
         |LEE 000#isom0514.u;
         |SI FSalida = 0;
             enAnyo = #isom0514#0;
             nFicha = 1;
         |FINSI;
         |CIERRA #isom0514;
     |FINSI;

     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |SI nFicha = 0;
         |ABRET #maempr11;
     |FINSI;

     |SI nFicha = 1;
         |ABRET #agim0020;
     |FINSI;

     aFicTmp = "isow0021" + Usuario;
     |NOME_DAT #isow0021#aFicTmp#;
     |ABRE #isow0021;  |CIERRA #isow0021;  |DELINDEX #isow0021;

     |ABRET #isow0021;
     |BUCLE isom0514;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |SI nFicha = 0;
         |CIERRAT #maempr11;
     |FINSI;

     |SI nFicha = 0;
         |CIERRAT #agim0020;
     |FINSI;

     |CIERRAT #isow0021;
     |DELINDEX #isow0021;
|FPRC;
