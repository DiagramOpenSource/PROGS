|FICHEROS;
|FIN;

|VARIABLES;
     aLong            = "";
     aCadena          = "";
     aIPRemoto        = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aCaracter        = "";
     aLen             = "";
     aDecima          = "";
     aEntero          = "";
     aImpor1          = "";
     aImpor2          = "";
     aDocRemoto       = "";
     aDocServidor     = "";
     aBase            = "";
     aDirec           = "";
     aLogo            = "";
     aGuarda          = "";
     aAbreId1         = "";
     aAbreId2         = "";
     aAbre            = "";
     aPath            = "";
     aLongitud        = "";
     aSit             = "";
     aNomLogo         = "";
     aLongAlfa        = "";
     aParaQuitar      = "";
     aFicheroLCK      = "";
     aFicheroIMA      = "";
     aFichDoc         = "";
     aFichTgz         = "";
     aFichTar         = "";
     aDirDoc          = "";
     aDirDsPdf        = "";
     aDirBasico       = "";
     aExten           = "";

     nLen             = 0;
     nLongitud        = 0;
     nSer             = 0;
     nLong            = 0;
     nBarra           = 0;
     nWord            = 0;
     nCar             = 0;
     nPos             = 0;
     nCampo           = 0;
     nDecimal         = 0;
     nCaracter        = 0;
     nHandle          = 0;
     nHandleYa        = 0;
     nTope            = 0;
     nPuntero         = 0;
     nIdSalir         = 0;
     nIdSalir1        = 0;
     nIdSalir2        = 0;
     nIdSalir3        = 0;
     nLinea           = 0;
     nHay             = 0;
     nBlanco1         = 0;
     nBlanco2         = 0;
     nComa            = 0;
     nPara            = 0;
     nPosi            = 0;
     nLongNume        = 0;
     nPausa           = 0;
     nVeces           = 0;
     nVentana         = 0;
     nInstala         = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaAlfa          = "";
     &eaImporte       = "";
     &eaPathLogo      = "";
     &eaAsigna        = "";
     &eaConten        = "";
     &eaMes           = "";
     &eaModoPresenta  = "";
     &enWord1         = 0;
     &enWord2         = 0;
     &enCamWord       = 0;
     &enModoExterno   = 0;
     &enHandleTxt     = 0;
     &enHandleTxt2    = 0;
     &enCargaPuntero  = 0;
     &efFecha         = @;
     &eaFecha         = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaDirTrabServi  = "";
     &eaDirDocId2     = "";
     &eaDirTraId2     = "";
     &eaDirSerPlan    = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaDestinoTra    = "";
     &eaFicheroTra    = "";
     &eaFicheroDef    = "";
     &eaFicheroXgz    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPlaGz  = "";
     &eaFicheroPlaMl  = "";
     &eaEtiqueta      = "";
     &eaPlanilla      = "";
     &enTipoDoc       = 0;
     &eaCadena1       = "";
     &eaCadena2       = "";
     &eaCadena3       = "";
     &eaCadena        = "";
     &eaParametro1    = "";
     &eaParametro2    = "";
     &eaParametro3    = "";
     &eaParametro4    = "";
     &eaParametro5    = "";
     &enAnyo          = 0;
     &enTBal          = 0;

     {1}aContiene     = "";
     {1}aVersion      = "";
     {2}nNivel        = 0;
     {18}aCarac       = "";

        &enError      = 0;
     aPag     = "";
     &eaPag1    = "";
     &eaPag2    = "";
|FIN;

|PROCESO SacaFecha;
     aAlfa1 = eaAlfa % 102;
     aAlfa2 = eaAlfa % 402;
     aAlfa3 = eaAlfa % 704;
     |SI aAlfa2 = "01";  aAlfa2 = "Enero";      |FINSI;
     |SI aAlfa2 = "02";  aAlfa2 = "Febrero";    |FINSI;
     |SI aAlfa2 = "03";  aAlfa2 = "Marzo";      |FINSI;
     |SI aAlfa2 = "04";  aAlfa2 = "Abril";      |FINSI;
     |SI aAlfa2 = "05";  aAlfa2 = "Mayo";       |FINSI;
     |SI aAlfa2 = "06";  aAlfa2 = "Junio";      |FINSI;
     |SI aAlfa2 = "07";  aAlfa2 = "Julio";      |FINSI;
     |SI aAlfa2 = "08";  aAlfa2 = "Agosto";     |FINSI;
     |SI aAlfa2 = "09";  aAlfa2 = "Septiembre"; |FINSI;
     |SI aAlfa2 = "10";  aAlfa2 = "Octubre";    |FINSI;
     |SI aAlfa2 = "11";  aAlfa2 = "Noviembre";  |FINSI;
     |SI aAlfa2 = "12";  aAlfa2 = "Diciembre";  |FINSI;

     eaAlfa = aAlfa1 + " de " + aAlfa2 + " de " + aAlfa3;
|FPRC;

|PROCESO QuitaRarosDSXML;
     |QBF eaAlfa;

     aCarac1   = "•";
     aCarac2   = "§";
     aCarac3   = "·";
     aCarac4   = "†";
     aCarac5   = "Ç";
     aCarac6   = "°";
     aCarac7   = "¢";
     aCarac8   = "£";
     aCarac9   = "ß";
     aCarac10  = "¶";
     aCarac11  = "®";
     aCarac12  = "Ä";
     aCarac13  = "á";
     aCarac14  = "Ö";
     aCarac15  = "ä";
     aCarac16  = "ç";
     aCarac17  = "ï";
     aCarac18  = "ó";

     IaCarac = aCarac1 <-;
     nHay    = 0;
     |PARA nCampo = 1;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           aCaracter = eaAlfa - aCarac;
           |SI FSalida ! 0;  nHay = 1;  |SAL;  |FINSI;

           IaCarac = IaCarac + 1;
     |SIGUE;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;

           |SI aCaracter = aCarac1;   aCaracter = &0209; |FINSI;
           |SI aCaracter = aCarac2;   aCaracter = &0241;   |FINSI;
           |SI aCaracter = aCarac3;   aCaracter = &0225;   |FINSI;
           |SI aCaracter = aCarac4;   aCaracter = &0225;   |FINSI;
           |SI aCaracter = aCarac5;   aCaracter = &0233;   |FINSI;
           |SI aCaracter = aCarac6;   aCaracter = &0237;   |FINSI;
           |SI aCaracter = aCarac7;   aCaracter = &0243;   |FINSI;
           |SI aCaracter = aCarac8;   aCaracter = &0250;   |FINSI;
           |SI aCaracter = aCarac9;   aCaracter = &0176;   |FINSI;
           |SI aCaracter = aCarac10;  aCaracter = &0170;   |FINSI;
           |SI aCaracter = aCarac11;  aCaracter = &0191;   |FINSI;
           |SI aCaracter = aCarac12;  aCaracter = &0199;   |FINSI;
           |SI aCaracter = aCarac13;  aCaracter = &0231;   |FINSI;
           |SI aCaracter = aCarac14;  aCaracter = &0224;   |FINSI;
           |SI aCaracter = aCarac15;  aCaracter = &0232;   |FINSI;
           |SI aCaracter = aCarac16;  aCaracter = &0236;   |FINSI;
           |SI aCaracter = aCarac17;  aCaracter = &0242;   |FINSI;
           |SI aCaracter = aCarac18;  aCaracter = &0249;   |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;
|FPRC;

|PROCESO ComprimeServidor;
     aAlfa    = (eaOrigen % -103) < "";
     |SI aAlfa = "doc";
         aDirDoc = eaDirSerDoc;
         aExten  = ".doc";
     |SINO;
         aDirDoc = eaDirSerPlan;
         aExten  = "." + aAlfa;
     |FINSI;

     |SI aExten = ".fdf";
         aDirDoc = eaDirSerDoc;
     |FINSI;

     aFichDoc = (eaOrigen - aDirDoc);
     aFichTgz = aFichDoc - aExten + ".tgz";
     aFichTar = aFichDoc - aExten + ".tar";

     aAlfa  = aDirDoc + aFichTar + " " + aFichDoc;
     |ATAR aAlfa, aDirDoc;

     aAlfa = aDirDoc + aFichTar;
     |COMPRIME aAlfa;

     aAlfa = aDirDoc + aFichTar;  |FBORRA aAlfa;

     eaOrigen  = aDirDoc  + aFichTgz;
     eaDestino = eaDirTrabajo + aFichTgz;
|FPRC;

|PROCESO ComprimeRemoto;
     aDirDoc = eaDirTrabajo;
     aExten  = eaOrigen % -104;

     aFichDoc = (eaOrigen - aDirDoc);
     aFichTgz = aFichDoc - aExten + ".tgz";
     aFichTar = aFichDoc - aExten + ".tar";

     aAlfa  = aDirDoc + aFichTar + " " + aFichDoc;
     |RATAR aAlfa, aDirDoc;

     aAlfa = aDirDoc + aFichTar;
     |RCOMPRIME aAlfa;

     aAlfa = aDirDoc + aFichTar;  |RFBORRA aAlfa;

     eaOrigen  = aDirDoc  + aFichTgz;
     eaDestino = eaDirGuarda + aFichTgz;
|FPRC;

|PROCESO DescomprimeRemoto;
     |RDESCOMPRIME eaDestino;
     |RDETAR eaDestino, eaDirTrabajo;

     aAlfa = eaDirTrabajo + aFichTgz;  |RFBORRA aAlfa;
     aAlfa = eaDirTrabajo + aFichTar;  |RFBORRA aAlfa;
     aAlfa = aDirDoc  + aFichTgz;      |FBORRA aAlfa;
|FPRC;

|PROCESO DescomprimeServidor;
     |DESCOMPRIME eaDestino;
     |DETAR eaDestino, eaDirGuarda;

     aAlfa = eaDirGuarda + aFichTgz;  |FBORRA aAlfa;
     aAlfa = eaDirGuarda + aFichTar;  |FBORRA aAlfa;
     aAlfa = aDirDoc  + aFichTgz;     |RFBORRA aAlfa;
|FPRC;

|PROCESO EnviaFicheroConMD5;
     aContiene1 = eaDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = eaOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;
         aExten = (eaOrigen % -103) < "";
         |SI aExten ! "tgz";  |HAZ ComprimeServidor;  |FINSI;

         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaOrigen, eaDestino;
         |SINO;
             |COPIA_FICHERO eaOrigen, eaDestino;
         |FINSI;

         |SI aExten ! "tgz";  |HAZ DescomprimeRemoto;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO EnviaFicheroSinMD5;
     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO eaOrigen, eaDestino;
     |SINO;
         |COPIA_FICHERO eaOrigen, eaDestino;
     |FINSI;
|FPRC;

|PROCESO RecibeFichero;
     |HAZ ComprimeRemoto;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO eaOrigen, eaDestino;
     |SINO;
         |COPIA_FICHERO eaOrigen, eaDestino;
     |FINSI;

     |HAZ DescomprimeServidor;
|FPRC;

|PROCESO EjecutaDSXML;
     || eaParametro1 = Path y fichero exe
     || eaParametro2 = Path y fichero txt
     || eaParametro3 = Origen  del dsxml
     || eaParametro4 = Destino 1 del dsxml
     || eaParametro5 = Destino 2 del dsxml

     |XABRE "EC", eaParametro2, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aFicheroLCK  = eaParametro2 < "";
     aFicheroLCK  = aFicheroLCK - ".txt" + ".lck";
     aFicheroIMA  = eaParametro5 < "";
     aFicheroIMA  = aFicheroIMA + "~$" + (eaFicheroTra % 215);  |QBF aFicheroIMA;

     |SI eaParametro3 ! "";
         eaOrigen       = eaParametro3 + "dsxml.exe";
         eaDestino      = eaParametro4 + "dsxml.exe";
         |HAZ EnviaFicheroConMD5;
     |FINSI;

     |RFBORRA aFicheroLCK;

     aAlfa  = "START " + eaParametro1 + " " + eaParametro2;
     |RSYSTEM aAlfa;

     |PARA;  |SI;  |HACIENDO;
             |PARA nPausa = 1; |SI nPausa [ 10000; |HACIENDO nPausa = nPausa + 1;
             |SIGUE;

             |XABRE "EC", aFicheroLCK, nHandle;
             |SI FSalida ] 0;
                 |SAL;
             |FINSI;

             |PULSATECLA;
     |SIGUE;

     |PARA nVeces = 0;  |SI nVeces [ 20;  |HACIENDO nVeces = nVeces + 1;
             |XABRE "EC", aFicheroIMA, nHandle;
             |SI FSalida < 0;  |SAL;  |FINSI;

             |MENSA "0000 Esperando cierre del documento.";
             |SLEEP 1;
             |PULSATECLA;
     |SIGUE;

     |RFBORRA eaParametro2;
     |RFBORRA aFicheroLCK;

     |PULSATECLA;
     |MENSA "0000  ";
|FPRC;

|PROCESO GrabaContenido;
     aAlfa = eaAsigna % 101;
     |SI aAlfa ! "V";  |Y aAlfa ! "M";
      |Y aAlfa ! "I";  |Y aAlfa ! "T";
      |Y aAlfa ! "X";  |Y aAlfa ! "P";
      |Y aAlfa ! "C";
         |ACABA;
     |FINSI;

     |SI aAlfa = "V";
         aAlfa = "W" + &13 + &10;  |XGRABA enHandleTxt, aAlfa;
     |SINO;
         |SI aAlfa ! "C";
             aAlfa = (eaAsigna % 101) + &13 + &10;  |XGRABA enHandleTxt, aAlfa;
         |SINO;
             aAlfa = "V" + &13 + &10;  |XGRABA enHandleTxt, aAlfa;
         |FINSI;
     |FINSI;

     aAlfa = (eaAsigna % 240) + &13 + &10;  |XGRABA enHandleTxt, aAlfa;
     aAlfa = eaConten + &13 + &10;          |XGRABA enHandleTxt, aAlfa;
|FPRC;

|PROCESO PegarWordId1;
     aAbre = eaDirTrabServi + "asignaya.txt";
     |XABRE "WB", aAbre, nHandleYa;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA nHandleYa, aAlfa;

     aAlfa = "M" + &13 + &10;                  |XGRABA nHandleYa, aAlfa;
     aAlfa = eaAsigna + &13 + &10;             |XGRABA nHandleYa, aAlfa;
     aAlfa = eaConten + &13 + &10;             |XGRABA nHandleYa, aAlfa;
     |XCIERRA nHandleYa;

     eaOrigen       = eaDirTrabServi + "asignaya.txt";
     eaDestino      = eaDirTrabajo   + "asignaya.txt";
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     eaParametro1 = eaDirTrabajo + "dsxml";
     eaParametro2 = eaDirTrabajo + "asignaya.txt";
     eaParametro3 = eaDirSerPlan;
     eaParametro4 = eaDirTrabajo;
     eaParametro5 = eaDirTrabajo;

     |HAZ EjecutaDSXML;
|FPRC;

|PROCESO AbreWordExterno;
     eaParametro1 = eaDirTrabajo + "dsxml";
     eaParametro2 = eaDirTrabajo + eaFicheroTxt;
     eaParametro3 = eaDirSerPlan;
     eaParametro4 = eaDirTrabajo;
     eaParametro5 = eaDirTrabajo;

     |HAZ EjecutaDSXML;
|FPRC;

|PROCESO EditaDocumento;
     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |SI eaPag1 ! "";                ||Para renumerar hojas
         eaAsigna   = "P" + eaPag1;
         eaConten   = eaDirTrabajo + "paginas.txt";
         |HAZ GrabaContenido;
     |FINSI;

     |XCIERRA enHandleTxt;

     eaOrigen       = eaDirTrabServi + eaFicheroTxt;
     eaDestino      = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;
|FPRC;

|PROCESO VentanaTrabajo;
     |VENTANA 1610, 2080, -1, 16, "Realizando trabajo";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{14}}Realizando trabajo", 1720, 1879, NULL;

     |PTEC 802;  |PAUSA;
     |PULSATECLA;
|FPRC;

|PROCESO FinVentanaTrabajo;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO InstalaDSPDF;
     nInstala = 0;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     aDirBasico = "\ds";                     |RMKDIR aDirBasico;
     aDirBasico = aDirBasico + "\bin";       |RMKDIR aDirBasico;
     aDirBasico = aDirBasico + "\";
     aDirDsPdf  = "\ds\dspdf\bin\";
     aAlfa      = aDirDsPdf + "puerto.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  nInstala = 1;  |FINSI;

     eaOrigen  = eaDirSerPlan + "dspdf.tgz";
     eaDestino = aDirBasico + "dspdf.tgz";

     |HAZ EnviaFicheroConMD5;
     |SI aDocRemoto ! aDocServidor;
         nInstala = 1;
     |FINSI;

     |SI nInstala = 1;
         aAlfa = aDirBasico + "dspdf.tgz";
         Pos   = -1;
         |RDESCOMPRIME aAlfa;
         |RDETAR aAlfa, "\ds\";

         aAlfa = aDirBasico + "dspdf.tar";  |RFBORRA aAlfa;

         aAlfa = aDirDsPdf + "puerto.exe";
         |XABRE "EC", aAlfa, nHandle;
         |SI FSalida < 0;
             |MENAV "0000 No puedo instalar la impresora en PDF.";
             enError = -1; |ACABA;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDirDsPdf + "PUERTO.EXE" + &34;
         |RSYSTEM aAlfa;
     |FINSI;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO EjecutaDSFDF;
     aAbre = eaDirTrabajo + "DEPOSITO.XML";
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 Faltan datos en las cuentas anuales";
         |ACABA;
     |FINSI;

     |DBASE aBase;
     eaDirSerPlan   = aBase  + "planilla/";

     eaOrigen  = eaDirSerPlan + "dsfdf" + enAnyo + ".tgz";
     eaDestino = eaDirTrabajo + "dsfdf" + enAnyo + ".tgz";
     |HAZ EnviaFicheroConMD5;

     |RDESCOMPRIME eaDestino;
     |RDETAR eaDestino, eaDirTrabajo;

     aAbre = eaDirTrabajo + "impcuentas.bat";
     |XABRE "WBC", aAbre, nHandle;

     aAlfa = eaDirTrabajo + "DEPOSITO.XML" + &13 + &10;
     |XGRABA nHandle, aAlfa;

     |SI enTBal = 2;
         aAlfa = eaDirTrabajo + "ctaab" + enAnyo + ".pdf" + &13 + &10;
         |XGRABA nHandle, aAlfa;

         aAlfa = eaDirTrabajo + "ctaab" + enAnyo + ".txt" + &13 + &10;
         |XGRABA nHandle, aAlfa;
     |SINO;
         aAlfa = eaDirTrabajo + "ctapy" + enAnyo + ".pdf" + &13 + &10;
         |XGRABA nHandle, aAlfa;

         aAlfa = eaDirTrabajo + "ctapy" + enAnyo + ".txt" + &13 + &10;
         |XGRABA nHandle, aAlfa;
     |FINSI;

     aAlfa = eaDirTrabajo + "wcuenta.fdf" + &13 + &10;
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaDirTrabajo + "dsfdf "+ aAbre + &34;
     |RSYSTEM aAlfa;

     aAlfa = eaDirTrabajo + "impcuentas.bat";           |RFBORRA aAbre;
     aAlfa = eaDirTrabajo + "DEPOSITO.XML";             |RFBORRA aAbre;
     aAlfa = eaDirTrabajo + "dsfdf" + enAnyo + ".tar";  |RFBORRA aAlfa;
|FPRC;

|PROCESO QuentaPagDocumento;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     eaAsigna   = "P" + eaPag1;
     eaConten   = eaDirTrabajo + "paginas.txt";
     |HAZ GrabaContenido;

     |XCIERRA enHandleTxt;

     eaOrigen       = eaDirTrabServi + eaFicheroTxt;
     eaDestino      = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |HAZ LeeNumPaginas;
|FPRC;

|PROCESO LeeNumPaginas;
     aCarac10 = &10;
     aCarac13 = &13;
     aPag     = "";
     eaPag1   = "";
     eaPag2   = "";

     aAbre = eaDirTrabajo + "paginas.txt";
     |XABRE "ABC", aAbre, nHandle;
     |PARA;  |SI  FSalida ] 0;  |HACIENDO;
          |XLEE nHandle, 1, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          |SI aAlfa = aCarac10;  |O aAlfa = aCarac13;
              |SI aPag ! "";
                  |SI eaPag1 = "";
                      eaPag1 = aPag;
                  |SINO;
                      eaPag2 = aPag;
                  |FINSI;
              |FINSI;
              aPag = "";
          |SINO;
              aPag = aPag + aAlfa;
         |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     |RFBORRA aAbre;
|FPRC;
