|FICHEROS;
      isoy2008 #0;
      maempr10 #200;
      maempr12 #212;
      maempr13 #213;

      isoh0822 #922;
|FIN;

|VARIABLES;
     aCasilla       = "";
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aBase          = "";
     aFichero       = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";

     nNume          = 0;
     nPos           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nPanta         = 0;
     nHandle        = 0;
     nCasilla       = 0;
     nFecha         = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nContaBucle    = 0;
     nContaBucleL   = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nTotal         = 0;

     fFechaD        = @;
     fFechaH        = @;

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enCanti         = 0;
     &eaPagina        = "";
     &eaFinLinea      = "";
|FIN;

|PROCESO maempr13;
     nContaBucleL  = nContaBucleL + 1;

     |SI nContaBucleL ] 6;
         |ERROR10;
         |ACABA;
     |FINSI;

     nPuntero = ((((nContaBucle + 5) - (6 * #922#0)) * 9) + 9) + nContaBucleL;

     #922nPuntero = #213#4;
|FPRC;

|DEFBUCLE maempr13;
     #213#1;
     ;
     #212#0, #212#1, #212#2, 00;
     #212#0, #212#1, #212#2, 99;
     ;
     NULL, maempr13;
|FIN;

|PROCESO maempr12;
     nContaBucle  = nContaBucle + 1;
     #922#0       = ((nContaBucle / 6) + .49) ! 0;

     |LEE 101#922=;
     |SI FSalida ! 0;
         |DDEFECTO #922;
         #922#0 = ((nContaBucle / 6) + .49) ! 0;

                          #922#5 = "";
         |SI #922#0 ! 1;  #922#5 = "C";  nComple = 1;  |FINSI;

         |SI #922#5 = "C";  |Y #0#0 = "2";
             ||ACABA;
         |FINSI;

         nTotal = 0;
         eaPagina = eaPagina + "022";

         |GRABA 020#922b;
     |FINSI;

     nPuntero     = (((nContaBucle + 5) - (6 * #922#0)) * 9) + 6;
     #922nPuntero = #212#3;

     nPuntero     = nPuntero + 1;
     #922nPuntero = #212#4;

     nPuntero     = nPuntero + 1;
     aPais        = #212#5 % 102;
     #922nPuntero = aPais;

     nPuntero     = nPuntero + 1;
     enCanti      = #212#6;
     |HAZ Calcula17D;
     #922nPuntero = eaAlfa;

     nTotal       = nTotal + #212#6;

     enCanti      = nTotal;
     |HAZ Calcula17D;
     #922#60      = eaAlfa;

     nContaBucleL = 0;  |BUCLE maempr13;

     |GRABA 020#922a;
     |LIBERA #922;
|FPRC;

|DEFBUCLE maempr12;
     #212#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr12;
|FIN;

|PROCESO isoh0822;
     |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #922nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0822;
     #922#1;
     ;
     01;
     99;
     ;
     NULL, isoh0822;
|FIN;

|PROCESO Hoja22;
     nHay = 0;

     |ABRE #212;
     #212#0 = #200#0;
     #212#1 = #200#1;
     #212#2 = 1;
     |LEE 000#212];
     |SI FSalida = 0;  |Y  #212#0 = #200#0;  |Y #212#1 = #200#1;
         nHay = 1;
     |FINSI;
     |CIERRA #212;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aFichero = ("22" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #922 aFichero;
     |ABRE #922; |CIERRA #922; |DELINDEX #922;

     |ABRE #922;

     |DDEFECTO #922;
     #922#0   = 1;
     #922#5   = "";
     nTotal   = 0;
     eaPagina = eaPagina + "022";

     |GRABA 020#922n;

     nContaBucle = 0;   |BUCLE maempr12;

     |CIERRA #922;

     |BUCLE isoh0822;

     |ABRE #922; |CIERRA #922; |DELINDEX #922;
|FPRC;
