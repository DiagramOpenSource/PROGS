|FICHEROS;
     isz00007 #0;
|FIN;

|VARIABLES;
     aRuta      = "";
     aAlfa      = "";
     aOrigen    = "";
     aDestino   = "";
     aIPRemoto  = "";
     aBase      = "";
     aDirPatron = "";
     aAbre      = "";
     aAnyo      = "";

     nHandle1   = 0;

     &enAnyo    = 0;
|FIN;

|PROCESO Ubicacion;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     aRuta = #0#1;  |QBF aRuta;
     aRuta = "F" + aRuta;
     |BROWSE aRuta;

     #0#1 = aRuta % 260;  |PINTA #0#1;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |DBASE aBase;

     aDirPatron = aBase + "hacienda/";
     aOrigen    = aDirPatron + "ierrores.exe";
     aDestino   = "C:/MODELOS/SOCIEDAD/201/" + enAnyo + "/ierrores.exe";

     aIPRemoto  = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aAbre = "C:\MODELOS\SOCIEDAD\201\" + enAnyo + "\errores.bat";
     |XABRE "CBW", aAbre, nHandle1;

     aAlfa = "C:" + &13 + &10;                   |XGRABA nHandle1, aAlfa;
     aAlfa = "CD \" + &13 + &10;                 |XGRABA nHandle1, aAlfa;
     aAlfa = "CD MODELOS" + &13 + &10;           |XGRABA nHandle1, aAlfa;
     aAlfa = "CD SOCIEDAD" + &13 + &10;          |XGRABA nHandle1, aAlfa;
     aAlfa = "CD 201" + &13 + &10;               |XGRABA nHandle1, aAlfa;
     aAlfa = "CD " + enAnyo + &13 + &10;         |XGRABA nHandle1, aAlfa;
     aAlfa = "IERRORES.EXE -y" + &13 + &10;      |XGRABA nHandle1, aAlfa;


     aAnyo  = enAnyo;
     aAnyo  = aAnyo % -102;
     aAlfa  = #0#1;  |QBF aAlfa;
     aAlfa  = "wait " + aAlfa + " fic201" + aAnyo + ".xls" + &13 + &10;

     |XGRABA nHandle1, aAlfa;

     aAlfa = "DEL *.XLS" + &13 + &10;         |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL WAIT.EXE" + &13 + &10;      |XGRABA nHandle1, aAlfa;
     aAlfa = "DEL IERRORES.EXE" + &13 + &10;  |XGRABA nHandle1, aAlfa;

     |XCIERRA nHandle1;

     aAlfa     = "C:/MODELOS/SOCIEDAD/201/" + enAnyo + "/ERRORES.BAT";
     |RSYSTEM aAlfa;

     |RFBORRA aAlfa;
|FPRC;

|PROGRAMA;
    aAlfa = Usuario % 810;  |QBF Usuario;
    |ABRE #0;
    #0#0 = aAlfa;
    |LEE 101#0=;
    |SI FSalida ! 0;
        |DDEFECTO #0;
        #0#0 = aAlfa;
        |GRABA 020#0b;
    |FINSI;

    |PINPA #0#0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |GRABA 020#0a;
    |FINSI;
    |LIBERA #0;
    |CIERRA #0;
|FPRO;
