|FICHEROS;
   isacceco #0;
   maempr01 #1;
   maempr11 #11;

   isocie00 #200;
   isocie29 #29;
   isocie55 #55;
   isocie59 #59;
   isocie60 #60;
   isocie61 #61;
   isocie62 #62;
   isocie63 #63;
   isocie64 #64;
   isocie65 #65;
   isocie66 #66;
   isocie69 #69;
   isocie73 #73;
   isocie74 #74;
   isocie75 #75;
   isocie76 #76;
   isocie81 #81;
   isocie82 #82;
   isocie83 #83;
   isocie84 #84;
   isocie85 #85;

   isocie03 #100;
   ctw00001 #900;
   ctw00002 #901;
   ctw00003 #902;

   :/agicli/def/agifigen #1000;    || Bancos
|FIN;

|VARIABLES;
   &empresa  = 0;
   &enEmpresa = 0;
   &enPeriodo = 0;
   &anyo     = 0;
   &nombre   = "";
   &nif      = "";
   &tipo     = "";
   &modo     = 0;
   &sw_mod   = 0;
   &SwAdic   = 0;
   &nPuntoC  = 0;
   &nPuntoT  = 0;
   &enPorce  = 0;
   &enPorce2 = 0;

   &empAlta = 0;
   &empre   = 0;
   &perio   = 0;
   &plani   = 0;
   &siono   = "";
   &cuent   = "";
   &acabalo = 0;
   &enNoPanta = 0;

   nClave    = 0;
   nSwAuto   = 0;
   Punto     = 0;
   Punto1    = 0;
   SwOpcion  = 0;
   SwOpcion1 = 0;
   nEstado   = 0;
   nLinea    = 0;
   nDClave   = 0;
   nHClave   = 0;
   nPunto503 = 0;
   nPunto504 = 0;
   nPunto509 = 0;
   nPunto510 = 0;
   nPunto511 = 0;
   nPunto547 = 0;
   nPunto595 = 0;
   nCampo    = 0;
   nAnyo1    = 0;
   nAnyo2    = 0;
   nAnyo3    = 0;
   nAnyo4    = 0;
   nAnyo5    = 0;
   nAnyo6    = 0;
   nAnyo7    = 0;
   nAnyo8    = 0;
   nAnyo9    = 0;
   nAnyo10   = 0;
   nAnyo11   = 0;
   nAnyo12   = 0;
   nAnyo13   = 0;
   nAnyo14   = 0;
   nAnyo15   = 0;
   nAumen    = 0;
   nDismi    = 0;

   nDiasAnyo    = 0;
   nDias        = 0;
   nBaseSubida  = 0;
   nCuota       = 0;
   nImpo1       = 0;
   nImpo2       = 0;
   nImpo3       = 0;

   fFecha1      = @;
   fFecha2      = @;

   aDesde    = "";
   aHasta    = "";
   aAlfa     = "";
   nAnyoDesde = 0;
   nPagos     = 0;
   nMes       = 0;

     SwError         = 0;
     SwForales       = 0;
     SwCoopera       = 0;
     SwTranspa       = 0;
     SwTranspa1      = 0;
     SwTranspa2      = 0;
     SwTranspa3      = 0;
     SwPeqDimen      = 0;
     SwZEC           = 0;
     ContaCampo      = 0;
     VarCampo        = 0;
     XPara           = 0;
     Hasta           = 0;
     CampoTotal      = 0;
     CampoTotal1     = 0;
     CampoTotal2     = 0;
     CampoAtras      = 0;
     CampoLiqui      = 0;
     TotalCampo      = 0;
     Suma            = 0;
     Clave           = 0;
     nTope           = 0;
     &EURODB         = 0;

   aFichero1 = "";
   aFichero2 = "";
   aFichero3 = "";
   aAnyoD    = "";
   aAnyoH    = "";

   aEntidad      = "";
   aSucursal     = "";
   aDC           = "";
   aCuenta       = "";

{-1} Menu   = "";
   Menu1    = "1315";
   Menu2    = "1";
   Menu3    = "4";
   Menu4    = "Deducciones                   ";
   Menu5    = "Liquidaci¢n                   ";
   Menu6    = "Informaci¢n Adicional Balance ";
   Menu7    = "Utilidades                    ";

{-1}MenuUtil  = "";
    MenuUtil1 = "1735";
    MenuUtil2 = "1";
    MenuUtil3 = "5";
    MenuUtil4 = "Pase deducciones a¤o anterior   ";
    MenuUtil5 = "Pase desde datos contabilidad   ";
    MenuUtil6 = "Pase B.Imponibles a¤o anterior  ";
    MenuUtil7 = "Pantalla de resultados          ";
    MenuUtil8 = "Borrado y Creaci¢n R.Deducciones";

{-1}MenuDedu   = "";
    MenuDedu1  = "1525";
    MenuDedu2  = "1";
    MenuDedu3  = "6";
    MenuDedu4  = "Por doble imposici¢n                ";
    MenuDedu5  = "A¤o Anterior                        ";
    MenuDedu6  = "A¤o Actual                          ";
    MenuDedu7  = "Cartuja 93, Canarias y A¤o Santo    ";
    MenuDedu8  = "Creacion empleo a¤os anteriores     ";
    MenuDedu9  = "Resumen                             ";

{-1}MenuAdic  = "";
    MenuAdic1 = "1835";
    MenuAdic2 = "1";
    MenuAdic3 = "4";
    MenuAdic4 = "Partidas del Activo ";
    MenuAdic5 = "Partidas del Pasivo ";
    MenuAdic6 = "Partidas del Debe   ";
    MenuAdic7 = "Partidas del Haber  ";
|FIN;

|PROCESO Tipo8;  |TIPO 8;
|FPRC;

|PROCESO Empresa; |TIPO 0;
  |ABRE #1;
  #1#0 = #0#0;
  #1#1 = #0#1;
  |LEE 040#1=;
  |SI FSalida = 0;
      #0#2 = #1#2;
      #0#3 = #1#3;
      #0#4 = #1#18;
  |FINSI;
  |CIERRA #1;
|FPRC;

|PROCESO GrabaBanco;
     aEntidad  = "";
     aSucursal = "";
     aDC       = "";
     aCuenta   = "";

     #200#0 = #0#0;
     #200#1 = #0#1 - 1;
     |LEE 000#200=;
     |SI FSalida = 0;
         aEntidad  = #200#2;
         aSucursal = #200#3;
         aDC       = #200#4;
         aCuenta   = #200#5;
     |FINSI;

     #200#0 = #0#0;
     #200#1 = #0#1;
     |LEE 101#200=;
     |SI FSalida ! 0;
         |DDEFECTO #200;
         #200#0 = #0#0;
         #200#1 = #0#1;

         |SI aEntidad ! "";
             #200#2 = aEntidad;
             #200#3 = aSucursal;
             #200#4 = aDC;
             #200#5 = aCuenta;
         |SINO;
             |ABRE #1000;
             #1000#0 = #0#0;
             |LEE 000#1000=;
             |SI FSalida ! 0;  |DDEFECTO #1000;  |FINSI;
             |CIERRA #1000;

             aAlfa   = #1000#81;        |QBF aAlfa; #200#2 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#82;        |QBF aAlfa; #200#3 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#83;        |QBF aAlfa; #200#4 = ("00"   + aAlfa) % -102;
             aAlfa   = #1000#84 % 110;  |QBF aAlfa; #200#5 =  ("0000000000" + aAlfa) % -110;
         |FINSI;

         |GRABA 020#200n;
         |LIBERA #200;
     |FINSI;
|FPRC;

|PROCESO Acceso;|TIPO 30;
  |SI #0#1 < 1996; |ACABA; |FINSI;

  |ABRE #200;
  |HAZ GrabaBanco;
  |CIERRA #200;

  |HAZ Pantalla;
  sw_mod = 0;
|FPRC;

|PROCESO Consulta; |TIPO 13;
  |SI #0#1 < 1996; |ACABA; |FINSI;

  modo = (FEntrada / 100) ! 0;
  |SI modo ! 4;  |ACABA;  |FINSI;

  |PINTA #0#0;  |PINTA #0#1;  |PINTA #0#2;  |PINTA #0#3;

  |HAZ Pantalla;
|FPRC;

|PROCESO Pantalla;
  Punto    = 1;
  SwOpcion = 0;
  empresa  = #0#0;
  anyo     = #0#1;
  nombre   = #0#2;
  nif      = #0#3;
  tipo     = #0#4;
  Punto    = 1;

  |SI nSwAuto = 1;  Punto = 4;  |PTEC 802;  |FINSI;

  |PARA; |SI SwOpcion = 0; |HACIENDO;
         Menu2  = Punto;
         |MENUG Menu;
         Punto = FSalida;
         |SI Punto ] 1; |Y Punto [ 4;
             |SI Punto = 1;  |HAZ Deduccion;           |FINSI;
             |SI Punto = 2;
                 |SUB_EJECUTA_NP "isocie59;laostia";
             |FINSI;
             |SI Punto = 3;  |HAZ Adicional;           |FINSI;
             |SI Punto = 4;  |HAZ Utilidad;            |FINSI;
         |SINO;
             SwOpcion = 1;
         |FINSI;
  |SIGUE;
  |PINPA #0#0;
|FPRC;

|PROCESO Utilidad;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |SI nSwAuto = 1;
      Punto1 = 2;
      |PTEC 802;
  |FINSI;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuUtil2 = Punto1;
         |MENUG MenuUtil;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 5;
             |SI Punto1 = 1;  |SUB_EJECUTA_NP "isz00004";  |FINSI;
             |SI Punto1 = 2;  |SUB_EJECUTA_NP "isz00001";  |FINSI;
             |SI Punto1 = 3;  |SUB_EJECUTA_NP "z0000012";  |FINSI;
             |SI Punto1 = 4;  |SUB_EJECUTA_NP "isz00002";  |FINSI;
             |SI Punto1 = 5;  |SUB_EJECUTA_NP "isz00006";  |FINSI;

             |SI nSwAuto = 1; |SAL;  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;

  |SI nSwAuto = 1;
      |HAZ GrabaLiqui;

      |PTEC 802;
      |PTEC 802;
      |PTEC 808;
      |PTEC 808;
      nSwAuto = 0;
  |FINSI;
|FPRC;

|PROCESO Deduccion;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuDedu2 = Punto1;
         |MENUG MenuDedu;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 6;
             |SI Punto1 = 1;  |Y #0#1 [ 2000;  |SUB_EJECUTA_NP "isocie63";  |FINSI;
             |SI Punto1 = 1;  |Y #0#1 ] 2001;  |SUB_EJECUTA_NP "isocie75";  |FINSI;
             |SI Punto1 = 2;  |SUB_EJECUTA_NP "isocie30";  |FINSI;
             |SI Punto1 = 3;  |SUB_EJECUTA_NP "isocie06";  |FINSI;
             |SI Punto1 = 4;  |SUB_EJECUTA_NP "isocie38";  |FINSI;
             |SI Punto1 = 5;  |SUB_EJECUTA_NP "isocie09";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 1997;  |SUB_EJECUTA_NP "isocie66";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 1998;  |SUB_EJECUTA_NP "isocie68";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 1999;  |SUB_EJECUTA_NP "isocie69";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2000;  |SUB_EJECUTA_NP "isocie73";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2001;  |SUB_EJECUTA_NP "isocie74";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2002;  |SUB_EJECUTA_NP "isocie76";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2003;  |SUB_EJECUTA_NP "isocie81";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2004;  |SUB_EJECUTA_NP "isocie82";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2005;  |SUB_EJECUTA_NP "isocie83";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2006;  |SUB_EJECUTA_NP "isocie84";  |FINSI;
             |SI Punto1 = 6;  |Y #0#1 = 2007;  |SUB_EJECUTA_NP "isocie85";  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Adicional;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuAdic2 = Punto1;
         |MENUG MenuAdic;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 4;
             |SI Punto1 = 1;  SwAdic = 1;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 2;  SwAdic = 2;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 3;  SwAdic = 3;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 4;  SwAdic = 4;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Borra100;
     |BORRA 020#100a;
     |LIBERA #100;
|FPRC;

|DEFBUCLE isocie03;
     #100#1;
     ;
     #0#0, #0#1, nDClave, 00;
     #0#0, #0#1, nHClave, 99;
     be;
     NULL, Borra100;
|FIN;

|PROCESO BuscaUlt;
     #100#0 = #0#0;
     #100#1 = #0#1;
     #100#2 = nClave;
     #100#3 = 99;
     |LEE 040#100];
     |SI FSalida = 0;
         |LEE 040#100a;
     |SINO;
         |LEE 040#100u;
     |FINSI;

     |SI FSalida = 0; |Y #100#1 = #0#1; |Y #100#2 = nClave;
         nLinea = #100#3 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;
|FPRC;

|PROCESO Graba503;
     nClave = 503;
     |SI #902#5 < 0;  nClave = 504;  #902#5 = -#902#5;  |FINSI;

     |HAZ BuscaUlt;

     #100#0 = #0#0;
     #100#1 = #0#1;
     #100#2 = nClave;
     #100#3 = nLinea;
     #100#4 = #902#4;
     #100#5 = #902#5;
     |GRABA 020#100n;

     |SI nClave = 503;  nPunto503 = nPunto503 + #902#5;  |FINSI;
     |SI nClave = 504;  nPunto504 = nPunto504 + #902#5;  |FINSI;
|FPRC;

|DEFBUCLE ctw00003;
     #902#1;
     ;
     "        ", 0, 000;
     "zzzzzzzz", 9, 999;
     ;
     NULL, Graba503;
|FIN;

|PROCESO Graba511;
     nClave = 511;

     |HAZ BuscaUlt;

     #100#0 = #0#0;
     #100#1 = #0#1;
     #100#2 = nClave;
     #100#3 = nLinea;
     #100#4 = #900#2;
     #100#5 = #900#3;
     |GRABA 020#100n;

     nPunto511 = nPunto511 + #900#3;
|FPRC;

|DEFBUCLE ctw00001;
     #900#1;
     ;
     nCampo, "            ";
     nCampo, "zzzzzzzzzzzz";
     ;
     NULL, Graba511;
|FIN;

|PROCESO Graba547;
     #62#3  = #901#1;

     aAlfa  = #901#6;  aAlfa = aAlfa % -102;

     |SI #901#6 = nAnyo15;
         #62#4  = aAlfa;
         #62#9  = #901#3;
         #62#15 = (#901#4 * 100) / enPorce;
         #62#21 = #62#9 - #62#15;
     |FINSI;

     |SI #901#6 = nAnyo14;
         #62#5  = aAlfa;
         #62#10 = #901#3;
         #62#16 = (#901#4 * 100) / enPorce;
         #62#22 = #62#10 - #62#16;
     |FINSI;

     |SI #901#6 = nAnyo13;
         #62#6  = aAlfa;
         #62#11 = #901#3;
         #62#17 = (#901#4 * 100) / enPorce;
         #62#23 = #62#11 - #62#17;
     |FINSI;

     |SI #901#6 = nAnyo12;
         #62#7  = aAlfa;
         #62#12 = #901#3;
         #62#18 = (#901#4 * 100) / enPorce;
         #62#24 = #62#12 - #62#18;
     |FINSI;

     |SI #901#6 = nAnyo11;
         #62#8  = aAlfa;
         #62#13 = #901#3;
         #62#19 = (#901#4 * 100) / enPorce;
         #62#25 = #62#13 - #62#19;
     |FINSI;

     |SI #901#6 = nAnyo10;
         #62#27 = aAlfa;
         #62#28 = #901#3;
         #62#29 = (#901#4 * 100) / enPorce;
         #62#30 = #62#28 - #62#29;
     |FINSI;

     |SI #901#6 = nAnyo9;
         #62#31 = aAlfa;
         #62#32 = #901#3;
         #62#33 = (#901#4 * 100) / enPorce;
         #62#34 = #62#32 - #62#33;
     |FINSI;

     |SI #901#6 = nAnyo8;
         #62#35 = aAlfa;
         #62#36 = #901#3;
         #62#37 = (#901#4 * 100) / enPorce;
         #62#38 = #62#36 - #62#37;
     |FINSI;

     |SI #901#6 = nAnyo7;
         #62#39 = aAlfa;
         #62#40 = #901#3;
         #62#41 = (#901#4 * 100) / enPorce;
         #62#42 = #62#40 - #62#41;
     |FINSI;

     |SI #901#6 = nAnyo6;
         #62#43 = aAlfa;
         #62#44 = #901#3;
         #62#45 = (#901#4 * 100) / enPorce;
         #62#46 = #62#44 - #62#45;
     |FINSI;

     |SI #901#6 = nAnyo5;
         #62#47 = aAlfa;
         #62#48 = #901#3;
         #62#49 = (#901#4 * 100) / enPorce;
         #62#50 = #62#48 - #62#49;
     |FINSI;

     |SI #901#6 = nAnyo4;
         #62#51 = aAlfa;
         #62#52 = #901#3;
         #62#53 = (#901#4 * 100) / enPorce;
         #62#54 = #62#52 - #62#54;
     |FINSI;

     |SI #901#6 = nAnyo3;
         #62#55 = aAlfa;
         #62#56 = #901#3;
         #62#57 = (#901#4 * 100) / enPorce;
         #62#58 = #62#56 - #62#57;
     |FINSI;

     |SI #901#6 = nAnyo2;
         #62#59 = aAlfa;
         #62#60 = #901#3;
         #62#61 = (#901#4 * 100) / enPorce;
         #62#62 = #62#60 - #62#61;
     |FINSI;

     |SI #901#6 = nAnyo1;
         #62#63 = aAlfa;
         #62#64 = #901#3;
         #62#65 = (#901#4 * 100) / enPorce;
         #62#66 = #62#64 - #62#65;
     |FINSI;

     #62#21 = #62#9  - #62#15;
     #62#22 = #62#10 - #62#16;
     #62#23 = #62#11 - #62#17;
     #62#24 = #62#12 - #62#18;
     #62#25 = #62#13 - #62#19;
     #62#30 = #62#28 - #62#29;
     #62#34 = #62#32 - #62#33;
     #62#38 = #62#36 - #62#37;
     #62#42 = #62#40 - #62#41;
     #62#46 = #62#44 - #62#45;
     #62#50 = #62#48 - #62#49;
     #62#54 = #62#52 - #62#54;
     #62#58 = #62#56 - #62#57;
     #62#62 = #62#60 - #62#61;
     #62#66 = #62#64 - #62#65;

     #62#14 = #62#9  + #62#10 + #62#11 + #62#12 + #62#13 + #62#28 + #62#32;
     #62#14 = #62#14 + #62#36 + #62#40 + #62#44 + #62#48 + #62#52 + #62#56;
     #62#14 = #62#14 + #62#60 + #62#64;
     #62#20 = #62#15 + #62#16 + #62#17 + #62#18 + #62#19 + #62#29 + #62#33;
     #62#20 = #62#20 + #62#37 + #62#41 + #62#45 + #62#49 + #62#53 + #62#57;
     #62#20 = #62#20 + #62#61 + #62#65;
     #62#26 = #62#21 + #62#22 + #62#23 + #62#24 + #62#25 + #62#30 + #62#34;
     #62#26 = #62#26 + #62#38 + #62#42 + #62#46 + #62#50 + #62#54 + #62#58;
     #62#26 = #62#26 + #62#62 + #62#66;
|FPRC;

|DEFBUCLE ctw00002;
     #901#1;
     6;
     "            ", nAnyo1;
     "zzzzzzzzzzzz", nAnyo14;
     ;
     NULL, Graba547;
|FIN;

|PROCESO AltaResto;
     nDClave = 503;  nHClave = 504;  |BUCLE isocie03;
     nDClave = 509;  nHClave = 510;  |BUCLE isocie03;
     nDClave = 511;  nHClave = 511;  |BUCLE isocie03;

     nPunto503 = 0;
     nPunto504 = 0;
     nPunto509 = 0;
     nPunto510 = 0;
     nPunto511 = 0;

     |ABRE #100;
                  |BUCLE ctw00003;
     nCampo = 5;  |BUCLE ctw00001;
     |CIERRA #100;

     |ABRE #100;
     nClave = 509;
     |SI nPuntoC < 0;  nClave = 510;  nPuntoC = -nPuntoC;  |FINSI;

     |SI nClave = 509;  nPunto509 = nPunto509 + nPuntoC;  |FINSI;
     |SI nClave = 510;  nPunto510 = nPunto510 + nPuntoC;  |FINSI;

     |HAZ BuscaUlt;

     #100#0 = #0#0;
     #100#1 = #0#1;
     #100#2 = nClave;
     #100#3 = nLinea;
     #100#4 = "";
     #100#5 = nPuntoC;
     |GRABA 020#100n;

     |CIERRA #100;

     |ABRE #62;
     #62#0 = #0#0;
     #62#1 = #0#1;
     #62#2 = 547;
     |BORRA 010#62c;
     |LIBERA #62;

     nAnyo1  = #0#1 - 14;
     nAnyo2  = #0#1 - 13;
     nAnyo3  = #0#1 - 12;
     nAnyo4  = #0#1 - 11;
     nAnyo5  = #0#1 - 10;
     nAnyo6  = #0#1 - 9;
     nAnyo7  = #0#1 - 8;
     nAnyo8  = #0#1 - 7;
     nAnyo9  = #0#1 - 6;
     nAnyo10 = #0#1 - 5;
     nAnyo11 = #0#1 - 4;
     nAnyo12 = #0#1 - 3;
     nAnyo13 = #0#1 - 2;
     nAnyo14 = #0#1 - 1;

     #62#0 = #0#0;
     #62#1 = #0#1;
     #62#2 = 547;
     |GRABA 020#62b;
     |BUCLE ctw00002;
     |GRABA 020#62a;

     |CIERRA #62;
|FPRC;

|PROCESO LeeFicheros;
  SwForales       = 0;
  SwCoopera       = 0;
  SwTranspa       = 0;
  SwTranspa1      = 0;
  SwTranspa2      = 0;
  SwTranspa3      = 0;
  SwPeqDimen      = 0;
  SwZEC           = 0;

  |ABRE #11;
  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 28;
  |LEE 040#11=;
  |SI FSalida = 0; SwForales = 1; |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 17;
  |LEE 040#11=;
  |SI FSalida = 0; SwCoopera = 1; |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 18;
  |LEE 040#11=;
  |SI FSalida = 0; SwCoopera = 1; |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 19;
  |LEE 040#11=;
  |SI FSalida = 0; SwCoopera = 1; |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 12;
  |LEE 040#11=;
  |SI FSalida = 0; SwTranspa = 1; SwTranspa1 = 1; |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 13;
  |LEE 040#11=;
  |SI FSalida = 0; SwTranspa = 1; SwTranspa2 = 1; |FINSI;

  #1#0 = empresa;
  #1#1 = anyo;
  #1#2 = 15;
  |LEE 040#1=;
  |SI FSalida = 0;
      |SI #0#1 [ 1999;
          SwTranspa = 1; SwTranspa3 = 1;
      |SINO;
          SwZEC = 1;
      |FINSI;
  |FINSI;

  #11#0 = empresa;
  #11#1 = anyo;
  #11#2 = 6;
  |LEE 040#11=;
  |SI FSalida = 0; SwPeqDimen = 1; |FINSI;
  |CIERRA #11;

  |SI SwCoopera = 0;
      |ABRE #60; #60#0 = #0#0; #60#1 = #0#1; |BORRA 140#60c; |LIBERA #60; |CIERRA #60;
      |ABRE #62; #62#0 = #0#0; #62#1 = #0#1; #62#2 = 561; |BORRA 140#62c; |LIBERA #62; |CIERRA #62;
  |FINSI;

  |SI SwTranspa = 0;
      |SI #0#1 = 1996;
          |ABRE #61; #61#0 = #0#0; #61#1 = #0#1; |BORRA 140#61c; |LIBERA #61; |CIERRA #61;
      |FINSI;

      |SI #0#1 ] 1997;
          |ABRE #64; #64#0 = #0#0; #64#1 = #0#1; |BORRA 140#64c; |LIBERA #64; |CIERRA #64;
      |FINSI;
  |FINSI;

  |SI #0#1 ] 1997;
      |ABRE #65;
      #65#0 = #0#0;
      #65#1 = #0#1;
      |LEE 040#65=;
      |SI FSalida ! 0;  |DDEFECTO #65;  |FINSI;
      |CIERRA #65;
  |FINSI;

  |ABRE #55;
  #55#0 = #0#0;
  #55#1 = #0#1;
  |LEE 040#55=;
  |SI FSalida ! 0;  |DDEFECTO #55;  |FINSI;
  |CIERRA #55;

  |ABRE #66;
  #66#0 = #0#0;
  #66#1 = #0#1;
  |LEE 040#66=;
  |SI FSalida ! 0;  |DDEFECTO #66;  |FINSI;
  |CIERRA #66;

  |ABRE #63;
  #63#0 = #0#0;
  #63#1 = #0#1;
  |LEE 040#63=;
  |SI FSalida ! 0;  |DDEFECTO #63;  |FINSI;
  |CIERRA #63;

  |ABRE #75;
  #75#0 = #0#0;
  #75#1 = #0#1;
  |LEE 040#75=;
  |SI FSalida ! 0;  |DDEFECTO #75;  |FINSI;
  |CIERRA #75;

  |ABRE #29;
  #29#0 = #0#0;
  #29#1 = #0#1;
  |LEE 040#29=;
  |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;
  |CIERRA #29;

  |ABRE #69;
  #69#0 = #0#0;
  #69#1 = #0#1;
  |LEE 040#69=;
  |SI FSalida ! 0;  |DDEFECTO #69;  |FINSI;
  |CIERRA #69;

  |ABRE #73;
  #73#0 = #0#0;
  #73#1 = #0#1;
  |LEE 040#73=;
  |SI FSalida ! 0;  |DDEFECTO #73;  |FINSI;
  |CIERRA #73;

  |ABRE #74;
  #74#0 = #0#0;
  #74#1 = #0#1;
  |LEE 040#74=;
  |SI FSalida ! 0;  |DDEFECTO #74;  |FINSI;
  |CIERRA #74;

  |ABRE #76;
  #76#0 = #0#0;
  #76#1 = #0#1;
  |LEE 040#76=;
  |SI FSalida ! 0;  |DDEFECTO #76;  |FINSI;
  |CIERRA #76;

  |ABRE #81;
  #81#0 = #0#0;
  #81#1 = #0#1;
  |LEE 040#81=;
  |SI FSalida ! 0;  |DDEFECTO #81;  |FINSI;
  |CIERRA #81;

  |ABRE #82;
  #82#0 = #0#0;
  #82#1 = #0#1;
  |LEE 040#82=;
  |SI FSalida ! 0;  |DDEFECTO #82;  |FINSI;
  |CIERRA #82;

  |ABRE #83;
  #83#0 = #0#0;
  #83#1 = #0#1;
  |LEE 040#83=;
  |SI FSalida ! 0;  |DDEFECTO #83;  |FINSI;
  |CIERRA #83;

  |ABRE #84;
  #84#0 = #0#0;
  #84#1 = #0#1;
  |LEE 040#84=;
  |SI FSalida ! 0;  |DDEFECTO #84;  |FINSI;
  |CIERRA #84;

  |ABRE #85;
  #85#0 = #0#0;
  #85#1 = #0#1;
  |LEE 040#85=;
  |SI FSalida ! 0;  |DDEFECTO #85;  |FINSI;
  |CIERRA #85;
|FPRC;

|PROCESO GrabaCoopera;
     |SI SwCoopera = 0;  |DDEFECTO #60;  |ACABA;  |FINSI;

     |ABRE #60;
     #60#0 = #0#0;
     #60#1 = #0#1;
     |LEE 101#60=;
     |SI FSalida ! 0;
         |DDEFECTO #60;
         #60#0 = #0#0;
         #60#1 = #0#1;
         |GRABA 020#60b;
    |FINSI;

    #60#9  = #65#193 - #65#190 - #65#192;
    #60#19 = #65#190;
    #60#20 = #65#157;
    #60#11 = #65#162 - #65#157 - #65#161;

    #60#2 = #59#2;

    nAumen = #59#03 + #59#05  + #59#07  + #59#09  + #59#11  + #59#13  + #59#14  + #59#18 + #59#17;
    nAumen = nAumen + #59#20  + #59#22  + #59#24  + #59#25  + #59#27  + #59#29  + #59#31;
    nAumen = nAumen + #59#33  + #59#35  + #59#129 + #59#132 + #59#134 + #59#136;
    nAumen = nAumen + #59#138 + #59#140 + #59#142;

    nDismi = #59#04 + #59#06  + #59#08  + #59#10  + #59#12;
    nDismi = nDismi + #59#15  + #59#16  + #59#19  + #59#21  + #59#23  + #59#26;
    nDismi = nDismi + #59#28  + #59#30  + #59#32  + #59#34  + #59#36  + #59#37;
    nDismi = nDismi + #59#124 + #59#127 + #59#128 + #59#130;
    nDismi = nDismi + #59#133 + #59#135 + #59#137 + #59#139 + #59#141 + #59#143;

    #60#3 = nAumen;
    #60#4 = nDismi;

    #60#5  = #59#39;
    #60#6  = -(#59#125 - #59#38);
    #60#7  = -(#59#126 - #59#40);
    #60#8  = #59#41;
    #60#16 = #60#6;
    #60#17 = #60#7;
    #60#23 = #60#19 - #60#20 - #60#21 + #60#22;

    |SI #60#24 = 0; #60#24 = #60#3 - #60#13;  |FINSI;
    |SI #60#25 = 0; #60#25 = #60#4 - #60#14;  |FINSI;
    |SI #60#26 = 0; #60#26 = #60#5 - #60#15;  |FINSI;
    |SI #60#27 = 0; #60#27 = #60#7 - #60#17;  |FINSI;

    #60#18 = #60#12 + #60#13 - #60#14 - #60#15 - #60#16 - #60#17;
    #60#28 = #60#23 + #60#24 - #60#25 - #60#26 - #60#27;

    #59#42  = #60#18;
    #59#43  = #60#28;
    #59#114 = 20;
    #59#112 = #59#42 % #59#114;

    |GRABA 020#60a;
    |LIBERA #60;
    |CIERRA #60;
|FPRC;

|PROCESO PagosFraccionados;
     aDesde = #1#31 % 105;
     aHasta = #1#32 % 105;
     |SI aDesde = "     ";  aDesde = "01.01";  |FINSI;
     |SI aHasta = "     ";  aHasta = "31.12";  |FINSI;

     |SI aDesde = "01.01";  |Y aHasta = "31.12";
         |SI #29#30 = 1;
             |SI #29#6 ! 0;  #59#85 = #29#6;  |FINSI;
             |SI #29#7 ! 0;  #59#87 = #29#7;  |FINSI;
             |SI #29#8 ! 0;  #59#89 = #29#8;  |FINSI;
         |SINO;
             |SI #29#24 ! 0; #59#85 = #29#24; |FINSI;
             |SI #29#25 ! 0; #59#87 = #29#25; |FINSI;
             |SI #29#26 ! 0; #59#89 = #29#26; |FINSI;
         |FINSI;
     |SINO;
        aAlfa      = #1#31 % -104;
        nAnyoDesde = aAlfa;
        nPagos     = 0;

        |ABRE #29;
        #29#0 = #0#0;
        #29#1 = nAnyoDesde;
        |LEE 040#29=;
        |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;

        aAlfa = #1#31 % 402;
        nMes   = aAlfa;
        |SI nMes [ 4;
            |SI #29#30 = 1;
                |SI #29#6 ! 0;  #59#85 = #29#6;  |FINSI;
                |SI #29#7 ! 0;  #59#87 = #29#7;  |FINSI;
                |SI #29#8 ! 0;  #59#89 = #29#8;  |FINSI;
            |SINO;
                |SI #29#24 ! 0; #59#85 = #29#24; |FINSI;
                |SI #29#25 ! 0; #59#87 = #29#25; |FINSI;
                |SI #29#26 ! 0; #59#89 = #29#26; |FINSI;
            |FINSI;
            nPagos = 3;
        |FINSI;

        |SI nMes > 4;  |Y nMes [ 10;
            |SI #29#30 = 1;
                |SI #29#7 ! 0;  #59#85 = #29#7;  |FINSI;
                |SI #29#8 ! 0;  #59#87 = #29#8;  |FINSI;
            |SINO;
                |SI #29#25 ! 0; #59#85 = #29#25; |FINSI;
                |SI #29#26 ! 0; #59#87 = #29#26; |FINSI;
            |FINSI;
            nPagos = 2;
        |FINSI;

        |SI nMes > 10;  |Y nMes [ 12;
            |SI #29#30 = 1;
                |SI #29#8 ! 0;  #59#85 = #29#8;  |FINSI;
            |SINO;
                |SI #29#26 ! 0; #59#85 = #29#26; |FINSI;
            |FINSI;
            nPagos = 1;
        |FINSI;

        aAnyoD = #1#31 % -104;
        aAnyoH = #1#32 % -104;

        |SI aAnyoD ! aAnyoH;
            nAnyoDesde = nAnyoDesde + 1;
            #29#0 = #0#0;
            #29#1 = nAnyoDesde;
            |LEE 040#29=;
            |SI FSalida ! 0;  |DDEFECTO #29;  |FINSI;

            |SI nPagos = 0;
                |SI #29#30 = 1;
                    |SI #29#6 ! 0;  #59#85 = #29#6;  |FINSI;
                    |SI #29#7 ! 0;  #59#87 = #29#7;  |FINSI;
                    |SI #29#8 ! 0;  #59#89 = #29#8;  |FINSI;
                |SINO;
                    |SI #29#24 ! 0; #59#85 = #29#24; |FINSI;
                    |SI #29#25 ! 0; #59#87 = #29#25; |FINSI;
                    |SI #29#26 ! 0; #59#89 = #29#26; |FINSI;
                |FINSI;
            |FINSI;

            |SI nPagos = 1;
                |SI #29#30 = 1;
                    |SI #29#6 ! 0;  #59#87 = #29#6;  |FINSI;
                    |SI #29#7 ! 0;  #59#89 = #29#7;  |FINSI;
                |SINO;
                    |SI #29#24 ! 0; #59#87 = #29#24; |FINSI;
                    |SI #29#25 ! 0; #59#89 = #29#25; |FINSI;
                |FINSI;
            |FINSI;

            |SI nPagos = 2;
                |SI #29#30 = 1;
                    |SI #29#6 ! 0;  #59#89 = #29#6;  |FINSI;
                |SINO;
                    |SI #29#24 ! 0; #59#89 = #29#24; |FINSI;
                |FINSI;
            |FINSI;
        |FINSI;
        |CIERRA #29;
    |FINSI;
|FPRC;

|PROCESO Completo;
     |SI SwCoopera = 0; |Y SwTranspa = 0;  |Y SwZEC = 0;
         #59#48 = #59#41 % #59#47;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwCoopera ! 0;
         #59#48 = #59#112 + #59#113;
     |SINO;
         #59#49 = 0;
     |FINSI;

     |SI SwTranspa ! 0;   #59#44 = #59#41;   |FINSI;

     |SI SwPeqDimen = 1;  |Y SwTranspa1 = 0;  |Y SwTranspa2 = 0;
      |Y SwCoopera  = 0;  |Y SwZEC      = 0;
         |SI #59#41 [ nTope;
             #59#47 = enPorce;
             #59#48 = #59#41 % #59#47;
         |SINO;
             #59#47   = enPorce;
             #59#116  = enPorce2;
             #59#48   = (nTope % #59#47) + ((#59#41 - nTope) % #59#116);
         |FINSI;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa1 ! 0; |Y SwPeqDimen = 1;
         |SI #59#41 [ nTope;
             #59#48 = (#59#44 % #59#47) + (#59#45 % #59#47) + (#59#46 % #59#116);
         |SINO;
             #59#48 =         ((#59#44 / #59#41) * nTope) % #59#47;
             #59#48 = #59#48 + ((#59#45 / #59#41) * nTope) % #59#47;
             #59#48 = #59#48 + ((#59#44 / #59#41) * (#59#41 - nTope)) % 35;
             #59#48 = #59#48 + ((#59#45 / #59#41) * (#59#41 - nTope)) % 35;
             #59#48 = #59#48 + (#59#46 % #59#116);
         |FINSI;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa1 ! 0; |Y SwPeqDimen = 0;
         #59#48 = (#59#44 % #59#47) + (#59#45 % 35) + (#59#46 % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa2 ! 0; |Y SwPeqDimen = 1;
         |SI #59#41 [ nTope;
             #59#48 = #59#45 % #59#47;
         |SINO;
             #59#48 =         ((#59#45 / #59#41) * nTope) % #59#47;
             #59#48 = #59#48 + ((#59#45 / #59#41) * (#59#41 - nTope)) % 35;
         |FINSI;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa2 ! 0; |Y SwPeqDimen = 0;
         #59#48 = #59#45 % #59#47;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa3 ! 0;  |Y SwPeqDimen = 0;
         #59#48 = ((#59#44 + #59#45) % #59#47) + (#59#46 % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwZEC ! 0;
         #59#48 = (#59#131 % #59#47) + ((#59#41 - #59#131) % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Incompleto;
     |SI SwCoopera = 0; |Y SwTranspa = 0;  |Y SwZEC = 0;
         #59#48 = #59#41 % #59#47;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwCoopera ! 0;
         #59#48 = #59#112 + #59#113;
     |SINO;
         #59#49 = 0;
     |FINSI;

     |SI SwTranspa ! 0;   #59#44 = #59#41;   |FINSI;

                      nDiasAnyo = 365;
     |SI #0#1 = 2008; nDiasAnyo = 366;  |FINSI;
     |SI #0#1 = 2012; nDiasAnyo = 366;  |FINSI;
     |SI #0#1 = 2016; nDiasAnyo = 366;  |FINSI;

     fFecha1 = #1#31;
     fFecha2 = #1#32;
     nDias   = fFecha2 - fFecha1;

     |SI SwPeqDimen = 1;  |Y SwTranspa1 = 0;  |Y SwTranspa2 = 0;
      |Y SwCoopera  = 0;  |Y SwZEC      = 0;
         nBaseSubida = ((#59#41 * nDiasAnyo) / nDias) ! EURODB;

         |SI nBaseSubida [ nTope;
             #59#47 = 30;
             #59#48 = #59#41 % #59#47;
         |SINO;
             #59#47   = 30;
             #59#116  = 35;
             nCuota  = ((nTope % #59#47) + ((nBaseSubida - nTope) % #59#116)) ! EURODB;

             #59#48   = (nCuota / nDiasAnyo) * nDias;
         |FINSI;

         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa1 ! 0; |Y SwPeqDimen = 1;
         nBaseSubida = ((#59#41 * nDiasAnyo) / nDias) ! EURODB;

         |SI nBaseSubida [ nTope;
             #59#48 = (#59#44 % #59#47) + (#59#45 % #59#47) + (#59#46 % #59#116);
         |SINO;
             nImpo1  = ((#59#44 * nDiasAnyo) / nDias) ! EURODB;
             nImpo2  = ((#59#45 * nDiasAnyo) / nDias) ! EURODB;
             nImpo3  = ((#59#46 * nDiasAnyo) / nDias) ! EURODB;
             nCuota  =          ((nImpo1 / nBaseSubida) * nTope) % #59#47;
             nCuota  = nCuota + ((nImpo2 / nBaseSubida) * nTope) % #59#47;
             nCuota  = nCuota + ((nImpo1 / nBaseSubida) * (nBaseSubida - nTope)) % 35;
             nCuota  = nCuota + ((nImpo2 / nBaseSubida) * (nBaseSubida - nTope)) % 35;
             nCuota  = nCuota + (nImpo3 % #59#116);

             #59#48   = (nCuota / nDiasAnyo) * nDias;
         |FINSI;

         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa1 ! 0; |Y SwPeqDimen = 0;
         #59#48 = (#59#44 % #59#47) + (#59#45 % 35) + (#59#46 % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa2 ! 0; |Y SwPeqDimen = 1;
         nBaseSubida = ((#59#41 * nDiasAnyo) / nDias) ! EURODB;

         |SI nBaseSubida [ nTope;
             #59#48  = #59#45 % #59#47;
         |SINO;
             nImpo1 = ((#59#45 * nDiasAnyo) / nDias) ! EURODB;
             nCuota =          ((nImpo1 / nBaseSubida) * nTope) % #59#47;
             nCuota = nCuota + ((nImpo1 / nBaseSubida) * (nBaseSubida - nTope)) % 35;

             #59#48   = (nCuota / nDiasAnyo) * nDias;
         |FINSI;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa2 ! 0; |Y SwPeqDimen = 0;
         #59#48 = #59#45 % #59#47;
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwTranspa3 ! 0;  |Y SwPeqDimen = 0;
         #59#48 = ((#59#44 + #59#45) % #59#47) + (#59#46 % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;

     |SI SwZEC ! 0;
         #59#48 = (#59#131 % #59#47) + ((#59#41 - #59#131) % #59#116);
         |SI #59#48 < 0; #59#48 = 0; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalculaCuotaIntegra;
     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     aAlfa = #1#16 % -101;

     |SI aAlfa ! "3";  |HAZ Completo;    |FINSI;
     |SI aAlfa = "3";  |HAZ Incompleto;  |FINSI;
|FPRC;

|PROCESO CargaLiqui;
     #59#2  = #65#77;
     #59#5  = nPunto503;
     #59#6  = nPunto504;
     #59#11 = nPunto509;
     #59#12 = nPunto510;
     #59#13 = nPunto511;
     #59#37 = #62#20;
     #59#81 = nPuntoT;

     nAumen = #59#03 + #59#05  + #59#07  + #59#09  + #59#11  + #59#13  + #59#14  + #59#18 + #59#17;
     nAumen = nAumen + #59#20  + #59#22  + #59#24  + #59#25  + #59#27  + #59#29  + #59#31;
     nAumen = nAumen + #59#33  + #59#35  + #59#125 + #59#126 + #59#129 + #59#132 + #59#134 + #59#136;
     nAumen = nAumen + #59#138 + #59#140 + #59#142;

     nDismi = #59#04 + #59#06  + #59#08  + #59#10  + #59#12;
     nDismi = nDismi + #59#15  + #59#16  + #59#19  + #59#21  + #59#23  + #59#26;
     nDismi = nDismi + #59#28  + #59#30  + #59#32  + #59#34  + #59#36  + #59#37 + #59#38;
     nDismi = nDismi + #59#39  + #59#40  + #59#124 + #59#127 + #59#128 + #59#130;
     nDismi = nDismi + #59#133 + #59#135 + #59#137 + #59#139 + #59#141 + #59#143;

     #59#41  = #59#2 + (nAumen - nDismi);
     #59#47  = enPorce;
     #59#116 = enPorce2;

     |HAZ GrabaCoopera;
     |HAZ CalculaCuotaIntegra;

     #59#50 = 0;
     |SI #59#48 > 0;
         #59#50 = #59#48 - #59#49;
         |SI #59#50 < 0; #59#49 = #59#48; |FINSI;
         #59#50 = #59#48 - #59#49;
     |FINSI;

     #59#69 = #59#50;
     |PARA XPara = 51; |SI XPara [ 68; |HACIENDO XPara = XPara + 1;
           #59#69 = #59#69 - #59XPara;
     |SIGUE;
     |SI #59#69 < 0; #59#69 = 0; |FINSI;

     |SI #59#1 [ 2000;
         #59#67 = #63#7;
     |SINO;
         #59#67 = #75#42;
     |FINSI;

     |SI #59#1 = 1999;
         #59#71 = #69#42;
         #59#73 = #69#156;
         #59#75 = #69#93;
         #59#76 = #69#114;
         #59#77 = #69#147;
     |FINSI;

     |SI #59#1 = 2000;
         #59#71 = #73#33;
         #59#73 = #73#159;
         #59#75 = #73#96;
         #59#76 = #73#117;
         #59#77 = #73#153;
     |FINSI;

     |SI #59#1 = 2001;
         #59#71 = #74#24;
         #59#72 = #74#156;
         #59#75 = #74#93;
         #59#76 = #74#114;
         #59#77 = #74#153;
     |FINSI;

     |SI #59#1 = 2002;
         #59#71 = #76#21;
         #59#72 = #76#111;
         #59#75 = #76#99;
         #59#76 = #76#114;
         #59#77 = #76#153;
         #59#52 = #76#102;
     |FINSI;

     |SI #59#1 = 2003;
         #59#71 = #81#21;
         #59#72 = #81#132;
         #59#75 = #81#111;
         #59#76 = #81#135;
         #59#77 = #81#180;
         #59#52 = #81#120;
     |FINSI;

     |SI #59#1 = 2004;
         #59#71 = #82#21;
         #59#72 = #82#150;
         #59#75 = #82#123;
         #59#76 = #82#153;
         #59#77 = #82#201;
         #59#52 = #82#135;
     |FINSI;

     |SI #59#1 = 2005;
         #59#71 = #83#21;
         #59#72 = #83#166;
         #59#75 = #83#132;
         #59#76 = #83#169;
         #59#77 = #83#220;
         #59#52 = #83#147;
     |FINSI;

     |SI #59#1 = 2006;
         #59#71 = #84#42;
         #59#72 = #84#21;
         #59#75 = #84#162;
         #59#76 = #84#184;
         #59#77 = #84#238;
         #59#52 = #84#180;
     |FINSI;

     |SI #59#1 = 2007;
         #59#71 = #85#45;
         #59#72 = #85#24;
         #59#75 = #85#171;
         #59#77 = #85#250;
         #59#52 = #85#192;
     |FINSI;

     #59#78 = #59#69 - #59#70 - #59#72 - #59#71 - #59#75 - #59#52 - #59#76 - #59#77 - #59#144;
     |SI #59#78 < 0; #59#78 = 0; |FINSI;

     |SI #59#1 < 2003;
         #59#80 = #59#78 - #59#79;
         |SI #59#80 < 0; #59#80 = 0; |FINSI;
     |FINSI;

     |HAZ PagosFraccionados;

     |SI SwForales = 0;
         #59#84  = 0;  #59#86  = 0;  #59#88  = 0;  #59#90  = 0;
         #59#92  = 0;  #59#94  = 0;  #59#96  = 0;  #59#98  = 0;
         #59#100 = 0;  #59#102 = 0;  #59#104 = 0;  #59#106 = 0;
         #59#117 = 0;  #59#118 = 0;  #59#119 = 0;  #59#120 = 0;
         #59#121 = 0;  #59#122 = 0;
     |FINSI;

     #59#108 = (#59#119 / (#59#117 - #59#118)) * 100;
     #59#109 = (#59#120 / (#59#117 - #59#118)) * 100;
     #59#110 = (#59#121 / (#59#117 - #59#118)) * 100;
     #59#111 = (#59#122 / (#59#117 - #59#118)) * 100;
     #59#107 = (100 - #59#108 - #59#109 - #59#110 - #59#111) ! 2;

     |SI #59#1 < 2003;
         #59#83  = (#59#107 / 100) * (#59#80 - #59#81 - #59#82 - #59#74);
         #59#84  = ((#59#108 + #59#109 + #59#110 + #59#111) / 100) * (#59#80 - #59#81 - #59#82 - #59#74);
     |SINO;
         #59#83  = (#59#107 / 100) * (#59#78 - #59#81 - #59#82 - #59#74);
         #59#84  = ((#59#108 + #59#109 + #59#110 + #59#111) / 100) * (#59#78 - #59#81 - #59#82 - #59#74);
     |FINSI;

     #59#95  = #59#83 - #59#85 - #59#87  - #59#89  - #59#91 - #59#93;
     #59#96  = #59#84 - #59#86 - #59#88  - #59#90  - #59#92 - #59#94;
     |SI #59#123 ! -1;
         #59#101 = (#59#95 - #59#97 + #59#99)  % #59#123;
         #59#102 = (#59#96 - #59#98 + #59#100) % #59#123;
     |FINSI;
     #59#105 = #59#95 - #59#97 + #59#99  + #59#101 + #59#103;
     #59#106 = #59#96 - #59#98 + #59#100 + #59#102 + #59#104;

     |SI SwTranspa = 1;
         |ABRE #64;
         #64#0 = #59#0;
         #64#1 = #59#1;
         |LIBERA #64;
         |LEE 140#64=;
         |SI FSalida ! 0;
             |DDEFECTO #64;
             #64#0 = #59#0;
             #64#1 = #59#1;
             #64#3 = #59#2;
             #64#4 = #59#41;
             |GRABA 040#64b;
         |FINSI;

         ||SI #64#2 = 0;  #64#2 = 100;  |FINSI;

         #64#3  = #59#2;
         #64#4  = #59#41;
         #64#27 = #59#85 + #59#86 + #59#87 + #59#88 + #59#89 + #59#90 + #59#91 + #59#92;
         #64#28 = #59#81 + #59#82;
         #64#29 = #59#105 + #59#106;
         #64#30 = #59#93 + #59#94;
         |GRABA 020#64a;
         |CIERRA #64;
     |FINSI;
|FPRC;

|PROCESO GrabaLiqui;
     |ABRE #65;
     #65#0 = #0#0;
     #65#1 = #0#1;
     |LEE 040#65=;
     |SI FSalida ! 0;  |DDEFECTO #65;  |FINSI;
     |CIERRA #65;

     |ABRE #59;
     #59#0 = #0#0;
     #59#1 = #0#1;
     |LEE 101#59=;
     |SI FSalida ! 0;
         |DDEFECTO #59;
         #59#0 = #0#0;
         #59#1 = #0#1;
         |GRABA 020#59b;
     |FINSI;
     |HAZ LeeFicheros;
     |HAZ CargaLiqui;
     |GRABA 020#59a;
     |LIBERA #59;
|FPRC;

|PROCESO isacceso;
     |HAZ GrabaBanco;
|FPRC;

|DEFBUCLE isacceso;
     #0#1;
     ;
     2006, 00001;
     2006, 99999;
     ;
     NULL, isacceso;
|FIN;

|PROGRAMA;
     |ABRE #100;
     |LEE 000#100p;
     |SI FSalida ! 0;
         |BUCLE isacceso;
     |FINSI;
     |CIERRA #100;

     nTope = 15000000; |SI anyo ] 2005; nTope = 20000000; |FINSI;
     |SI EURODB ! 0;
         nTope = (nTope / 166.386) ! EURODB;
         |SI anyo ] 2005; nTope = nTope - 0.01; |FINSI;
     |FINSI;

     empresa = enEmpresa;
     aFichero1 = ("1" + Usuario + "zzzzzzzz") % 108;
     aFichero2 = ("2" + Usuario + "zzzzzzzz") % 108;
     aFichero3 = ("3" + Usuario + "zzzzzzzz") % 108;

     |NOME_DAT #900 aFichero1;
     |NOME_DAT #901 aFichero2;
     |NOME_DAT #902 aFichero3;

     |CLS;
     |CABEZA "Impuesto desde Contabilidad";


     |SUB_EJECUTA_NP "maacceco";

     |HAZ Tipo8;

     |SUB_EJECUTA "z0000001;IMPUESTO1";

     |ABRET #0;
     #0#0 = empresa;
     #0#1 = anyo;
     |LEE 040#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = empresa;
         #0#1 = anyo;
         |GRABA 020#0b;
     |FINSI;

     FEntrada = 101;
     |HAZ Empresa;
     |PINPA #0#0;
     |PINDA #0#0;

     |GRABA 020#0a;

     empAlta = empresa;
     empre   = empresa;
     perio   = enPeriodo;
     plani   = 1;
     siono   = "SI";
     cuent   = "129000000";
     acabalo = 1;

     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 1324 1659;
     |ATRI S;
     |PINTA 1425, "Tratando Datos desde Contabilidad";

     enNoPanta = 1;
     |PTEC 802;
     |SUB_EJECUTA_NP "soagico1";

     |POPV;

     nSwAuto = 1;
     |HAZ AltaResto;
     |HAZ Acceso;
     |CIERRAT #0;
|FPRO;
