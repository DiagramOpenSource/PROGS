|FICHEROS;
    z0000014 #0;
    maacceso #1;
|FIN;

|VARIABLES;
     aRuta     = "";
     aAlfa     = "";
     aAlfa1    = "";
     aFichero  = "";
     nHandle   = 0;

     &empresa   = 0;
     &anyo      = 0;
     &enSwTrata = 0;
|FIN;

|PROCESO ExisteEmpresa;
     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = 0;
     |LEE 040#1];
     |SI FSalida ! 0;  |O #1#0 ! #0#0;
         |MENAV "       No existe Empresa";
         |ERROR;
     |FINSI;
     #0#1 = #1#2;
     |PINTA #0#1;
     |CIERRA #1;
|FPRC;

|PROCESO Borralos;
     empresa   = #1#0;
     anyo      = #1#1;
     |SUB_EJECUTA "z0000001";

     |BORRA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE maacceso;
     #1#1;
     ;
     #0#0, 0000;
     #0#0, 9999;
     be;
     NULL, Borralos;
|FIN;

|PROCESO Tipo3;
     enSwTrata = 1;

     |PINTA 0813, #0#0;
     |PINTA 0821, #0#1;

     |BUCLE maacceso;
|FPRC;

|DEFBUCLE z0000014;
     #0#1;
     ;
     00001;
     99999;
     ;
     NULL, Tipo3;
|FIN;

|RUTINA ClaveBaja0;
     #0#0 = 1;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99999;
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 13;  |ACABA;  |FINSI;

     aRuta = "F";
     |BROWSE aRuta;
     aRuta = aRuta % 299;

     |QBF aRuta;
     |SI aRuta = "";  |ACABA;  |FINSI;

     |XABRE "C", aRuta, nHandle;
     |SI FSalida ] 0;
         |PARA;  |SI;  |HACIENDO;
              |XLEE nHandle, 254, aAlfa;
              |SI FSalida < 0;  |SAL;  |FINSI;
              aAlfa1 = aAlfa % 106;  #0#0 = aAlfa;
              |LEE 101#0=;
              |SI FSalida ! 0;
                  aAlfa1 = aAlfa % 106;  #0#0 = aAlfa1;
                  aAlfa1 = aAlfa % 740;  #0#1 = aAlfa1;
                  |GRABA 020#0n;
              |FINSI;
              |LIBERA #0;
          |SIGUE;
     |FINSI;
     |XCIERRA nHandle;

     |PTEC 812;
     |PONCONTROL 23, "SI";
|FPRC;

|PROGRAMA;
     aFichero = ("14" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #0 aFichero;
     |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

     |CLS;
     |CABEZA "Borrado General";
     |ENTLINEAL #1#0, -1, 2, 22, 1, ClaveBaja0, ClaveAlta0;
     |CONFI "    SRealizamos el Borrado ";
     |SI FSalida = 0;
         |BUCLE z0000014;
     |FINSI;
|FPRO;
