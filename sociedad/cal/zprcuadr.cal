|FICHEROS;
     zhazdocu #0;
     zhazcrea;

     zpcuadro #5;
     zocuadro #6;
     zqcuadro #7;

     zregcu01 #1001;
     zregcu02 #1002;
     zregcu03 #1003;
     zregcu04 #1004;
     zregcu05 #1005;
     zregcu06 #1006;
     zregcu07 #1007;
     zregcu08 #1008;
     zregcu09 #1009;
     zregcu10 #1010;
     zregcu11 #1011;
     zregcu12 #1012;
     zregcu13 #1013;
     zregcu14 #1014;
     zregcu15 #1015;
     zregcu16 #1016;
     zregcu17 #1017;
     zregcu18 #1018;
     zregcu19 #1019;
     zregcu20 #1020;
     zregcu21 #1021;
     zregcu22 #1022;
     zregcu23 #1023;
     zregcu24 #1024;
     zregcu25 #1025;
     zregcu26 #1026;
     zregcu27 #1027;
     zregcu28 #1028;
     zregcu29 #1029;
     zregcu30;
     zregcu31;
     zregcu32;
     zregcu33;

     sodacoli #55;
     soda8m11 #431;  || Reparto 8 y 9 cabera
     soda8m12 #432;  || Reparto 8 y 9 lineas
     soda8w02 #999;

     imagen@ #900;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAbreTxt         = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aIPRemoto        = "";
     aCuenta          = "";
     aAste            = "";
     aLong            = "";
     aCuentaD         = "";
     aCuentaH         = "";
     aHora            = "";
     aPag             = "";
     aPag1            = "";
     aPag2            = "";
     &eaPag1          = "";
     &eaPag2          = "";
     aCarac10         = "";
     aCarac13         = "";
     aQueQuiero       = "";
     &aCNAE           = "";
     aTipoMemoria     = "";
     aTipo            = "";

     nSwPaseAnt       = 0;
     nLong            = 0;
     nSubPanta        = 0;
     nVentana         = 0;
     nNume            = 0;
     nNume1           = 0;
     nNume2           = 0;
     nNume3           = 0;
     nNume4           = 0;
     nRango           = 0;
     nBotonSal        = 0;
     nImporte         = 0;
     nCta40I          = 0;
     nCta41I          = 0;
     nCta407I         = 0;
     nCta4I           = 0;
     nCta40F          = 0;
     nCta41F          = 0;
     nCta407F         = 0;
     nCta4F           = 0;
     nCta4            = 0;
     nCta6            = 0;
     nEjer            = 0;
     nEjerCuadro      = 0;
     nCampo1          = 0;
     nCampo2          = 0;
     nCampo3          = 0;
     nCampo4          = 0;

     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nConta           = 0;
     nTributa         = 0;
     nCasilla         = 0;
     nCuadro          = 0;
     nHay             = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &enPersonaliza   = 0;
     &enTBal          = 0;
     &enEjerCuadro    = 0;
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;

     &EURODB          = 0;
     any              = 0;
     aCondi           = "";
     aSigno           = "";
     aFichero         = "";
     aMas             = "";
     aDef             = "";
     nEstado          = 0;
     nEstado900       = 0;
     nSw              = 0;
|FIN;

|PROCESO Carga_zregcu01;
     |ABRE #1001;
     #1001#0 = #zhazcrea#0;
     #1001#1 = #zhazcrea#1;
     |LEE 000#1001=;
     |SI FSalida ! 0;  |DDEFECTO #1001;  |FINSI;
     |CIERRA #1001;

     aQueQuiero = "|NC";
     aAlfa      = #1001#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1001#aQueQuiero#;  |QBF eaAsigna;
           |SI #1001nCampo ! 0;
               enCanti  = #1001nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;

     |ABRE #1001;
     #1001#0 = #zhazcrea#0;
     #1001#1 = #zhazcrea#1 - 1;
     |LEE 000#1001=;
     |SI FSalida ! 0;  |DDEFECTO #1001;  |FINSI;
     |CIERRA #1001;

     aQueQuiero = "|NC";
     aAlfa      = #1001#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + "#C1B" + (#1001#aQueQuiero# % 420);  |QBF eaAsigna;
           |SI #1001nCampo ! 0;
               enCanti  = #1001nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu02;
     |ABRE #1002;
     #1002#0 = #zhazcrea#0;
     #1002#1 = #zhazcrea#1;
     |LEE 000#1002=;
     |SI FSalida ! 0;  |DDEFECTO #1002;  |FINSI;
     |CIERRA #1002;

     aQueQuiero = "|NC";
     aAlfa      = #1002#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1002#aQueQuiero#;  |QBF eaAsigna;
           |SI #1002nCampo ! 0;
               enCanti  = #1002nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu03;
     |ABRE #1003;
     #1003#0 = #zhazcrea#0;
     #1003#1 = #zhazcrea#1;
     |LEE 000#1003=;
     |SI FSalida ! 0;  |DDEFECTO #1003;  |FINSI;
     |CIERRA #1003;

     aQueQuiero = "|NC";
     aAlfa      = #1003#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1003#aQueQuiero#;  |QBF eaAsigna;
           |SI #1003nCampo ! 0;
               enCanti  = #1003nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu04;
     |SI nConta > 2;
         eaAsigna = "T}1}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}1}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}2}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}2}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;
     |FINSI;

     nConta = nConta + 1;

     eaAsigna = "T}1}" + nConta + "}1}";
     eaConten = #1004#4;
     |HAZ GrabaContenido;

     eaAlfa   = #1004#5;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}1}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1004#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}1}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}1}" + nConta + "}4}";
     eaConten = #1004#7;
     |HAZ GrabaContenido;

     eaAsigna = "T}1}" + nConta + "}5}";
     eaConten = #1004#8;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}1}";
     eaConten = #1004#4;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}2}";
     enCanti  = #1004#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}3}";
     enCanti  = #1004#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}4}";
     enCanti  = #1004#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;
|FPRC;

|DEFBUCLE zregcu04;
     #1004#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu04;
|FIN;

|PROCESO Carga_zregcu04;
     nConta = 2;
     |BUCLE zregcu04;
|FPRC;

|PROCESO Carga_zregcu05;
     |ABRE #1005;
     #1005#0 = #zhazcrea#0;
     #1005#1 = #zhazcrea#1;
     |LEE 000#1005=;
     |SI FSalida ! 0;  |DDEFECTO #1005;  |FINSI;
     |CIERRA #1005;

     aQueQuiero = "|NC";
     aAlfa      = #1005#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1005#aQueQuiero#;  |QBF eaAsigna;
           |SI #1005nCampo ! 0;
               enCanti  = #1005nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu06;
     |ABRE #1006;
     #1006#0 = #zhazcrea#0;
     #1006#1 = #zhazcrea#1;
     |LEE 000#1006=;
     |SI FSalida ! 0;  |DDEFECTO #1006;  |FINSI;
     |CIERRA #1006;

     aQueQuiero = "|NC";
     aAlfa      = #1006#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1006#aQueQuiero#;  |QBF eaAsigna;
           |SI #1006nCampo ! 0;
               enCanti  = #1006nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu07;
     |ABRE #1007;
     #1007#0 = #zhazcrea#0;
     #1007#1 = #zhazcrea#1;
     |LEE 000#1007=;
     |SI FSalida ! 0;  |DDEFECTO #1007;  |FINSI;
     |CIERRA #1007;

     aQueQuiero = "|NC";
     aAlfa      = #1007#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1007#aQueQuiero#;  |QBF eaAsigna;
           |SI #1007nCampo ! 0;
               enCanti  = #1007nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu08;
     |ABRE #1008;
     #1008#0 = #zhazcrea#0;
     #1008#1 = #zhazcrea#1;
     |LEE 000#1008=;
     |SI FSalida ! 0;  |DDEFECTO #1008;  |FINSI;
     |CIERRA #1008;

     aQueQuiero = "|NC";
     aAlfa      = #1008#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1008#aQueQuiero#;  |QBF eaAsigna;
           |SI #1008nCampo ! 0;
               enCanti  = #1008nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu09;
     |ABRE #1009;
     #1009#0 = #zhazcrea#0;
     #1009#1 = #zhazcrea#1;
     |LEE 000#1009=;
     |SI FSalida ! 0;  |DDEFECTO #1009;  |FINSI;
     |CIERRA #1009;

     aQueQuiero = "|NC";
     aAlfa      = #1009#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1009#aQueQuiero#;  |QBF eaAsigna;
           |SI #1009nCampo ! 0;
               enCanti  = #1009nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu10;
     |ABRE #1010;
     #1010#0 = #zhazcrea#0;
     #1010#1 = #zhazcrea#1;
     |LEE 000#1010=;
     |SI FSalida ! 0;  |DDEFECTO #1010;  |FINSI;
     |CIERRA #1010;

     aQueQuiero = "|NC";
     aAlfa      = #1010#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1010#aQueQuiero#;  |QBF eaAsigna;
           |SI #1010nCampo ! 0;
               enCanti  = #1010nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu11;
     |ABRE #1011;
     #1011#0 = #zhazcrea#0;
     #1011#1 = #zhazcrea#1;
     |LEE 000#1011=;
     |SI FSalida ! 0;  |DDEFECTO #1011;  |FINSI;
     |CIERRA #1011;

     aQueQuiero = "|NC";
     aAlfa      = #1011#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1011#aQueQuiero#;  |QBF eaAsigna;
           |SI #1011nCampo ! 0;
               enCanti  = #1011nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu31;
     |ABRE #zregcu31;
     #zregcu31#0 = #zhazcrea#0;
     #zregcu31#1 = #zhazcrea#1;
     |LEE 000#zregcu31.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu31;  |FINSI;
     |CIERRA #zregcu31;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu31#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu31#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu31#nCampo# ! 0;
               enCanti  = #zregcu31#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu12;
     |ABRE #1012;
     #1012#0 = #zhazcrea#0;
     #1012#1 = #zhazcrea#1;
     |LEE 000#1012=;
     |SI FSalida ! 0;  |DDEFECTO #1012;  |FINSI;
     |CIERRA #1012;

     aQueQuiero = "|NC";
     aAlfa      = #1012#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1012#aQueQuiero#;  |QBF eaAsigna;
           |SI #1012nCampo ! 0;
               enCanti  = #1012nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu13;
     |ABRE #1013;
     #1013#0 = #zhazcrea#0;
     #1013#1 = #zhazcrea#1;
     |LEE 000#1013=;
     |SI FSalida ! 0;  |DDEFECTO #1013;  |FINSI;
     |CIERRA #1013;

     aQueQuiero = "|NC";
     aAlfa      = #1013#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1013#aQueQuiero#;  |QBF eaAsigna;
           |SI #1013nCampo ! 0;
               enCanti  = #1013nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu14;
     |ABRE #1014;
     #1014#0 = #zhazcrea#0;
     #1014#1 = #zhazcrea#1;
     |LEE 000#1014=;
     |SI FSalida ! 0;  |DDEFECTO #1014;  |FINSI;
     |CIERRA #1014;

     aQueQuiero = "|NC";
     aAlfa      = #1014#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1014#aQueQuiero#;  |QBF eaAsigna;
           |SI #1014nCampo ! 0;
               enCanti  = #1014nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu15;
     |ABRE #1015;
     #1015#0 = #zhazcrea#0;
     #1015#1 = #zhazcrea#1;
     |LEE 000#1015=;
     |SI FSalida ! 0;  |DDEFECTO #1015;  |FINSI;
     |CIERRA #1015;

     aQueQuiero = "|NC";
     aAlfa      = #1015#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1015#aQueQuiero#;  |QBF eaAsigna;
           |SI #1015nCampo ! 0;
               enCanti  = #1015nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu16;
     |SI nConta > 2;
         eaAsigna = "T}6}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 2;

         ||Combinar columnas

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "6," + nConta + ",3,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "6," + nConta + ",3,3" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;
     |FINSI;

     eaAsigna = "T}6}" + nConta + "}2}";
     eaConten = #1016#2;
     |HAZ GrabaContenido;

     eaAlfa   = #1016#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}6}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1016#4;
     eaAsigna = "T}6}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}5}";
     enCanti  = #1016#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAlfa   = #1016#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}6}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1016#7;
     eaAsigna = "T}6}" + nConta + "}7}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 2;

     eaAsigna = "T}6}" + nConta + "}4}";
     enCanti  = #1016#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}5}";
     enCanti  = #1016#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}6}";
     enCanti  = #1016#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}7}";
     enCanti  = #1016#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu16;
     #1016#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu16;
|FIN;

|PROCESO Carga_zregcu16;
     nConta = 2;
     |BUCLE zregcu16;
|FPRC;

|PROCESO Carga_zregcu17;
     |ABRE #1017;
     #1017#0 = #zhazcrea#0;
     #1017#1 = #zhazcrea#1;
     |LEE 000#1017=;
     |SI FSalida ! 0;  |DDEFECTO #1017;  |FINSI;
     |CIERRA #1017;

     aQueQuiero = "|NC";
     aAlfa      = #1017#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1017#aQueQuiero#;  |QBF eaAsigna;
           |SI #1017nCampo ! 0;
               enCanti  = #1017nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu32;
     |ABRE #zregcu32;
     #zregcu32#0 = #zhazcrea#0;
     #zregcu32#1 = #zhazcrea#1;
     |LEE 000#zregcu32.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu32;  |FINSI;
     |CIERRA #zregcu32;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu32#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu32#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu32#nCampo# ! 0;
               enCanti  = #zregcu32#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu33;
     |ABRE #zregcu33;
     #zregcu33#0 = #zhazcrea#0;
     #zregcu33#1 = #zhazcrea#1;
     |LEE 000#zregcu33.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu33;  |FINSI;
     |CIERRA #zregcu33;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu33#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu33#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu33#nCampo# ! 0;
               enCanti  = #zregcu33#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu18;
     |SI nConta > 2;
         eaAsigna = "T}7}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}6}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}7}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}8}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}9}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}10}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 1;

         ||Combinar columnas

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "7," + nConta + ",9,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;

         nConta   = nConta + 1;
     |FINSI;

     eaAsigna = "T}7}" + nConta + "}3}";
     eaConten = #1018#3;
     |HAZ GrabaContenido;

     eaAlfa   = #1018#4;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1018#5;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}5}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |SI #1018#6 = "G";  eaAlfa = "Grupo";       |FINSI;
     |SI #1018#6 = "M";  eaAlfa = "Multigrupo";  |FINSI;
     |SI #1018#6 = "A";  eaAlfa = "Asociada";    |FINSI;

     eaAsigna = "T}7}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 4;

     eaAsigna = "T}7}" + nConta + "}3}";
     enCanti  = #1018#7;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}4}";
     enCanti  = #1018#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}5}";
     enCanti  = #1018#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}6}";
     enCanti  = #1018#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}7}";
     enCanti  = #1018#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}8}";
     enCanti  = #1018#12;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}9}";
     enCanti  = #1018#13;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}10}";
     enCanti  = #1018#14;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}11}";
     enCanti  = #1018#15;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 3;

     eaAlfa   = #1018#16;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}4}";
     enCanti  = #1018#17;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}5}";
     enCanti  = #1018#18;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}6}";
     enCanti  = #1018#19;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}7}";
     enCanti  = #1018#20;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu18;
     #1018#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu18;
|FIN;

|PROCESO Carga_zregcu18;
     nConta = 2;
     |BUCLE zregcu18;
|FPRC;

|PROCESO Carga_zregcu19;
     |ABRE #1019;
     #1019#0 = #zhazcrea#0;
     #1019#1 = #zhazcrea#1;
     |LEE 000#1019=;
     |SI FSalida ! 0;  |DDEFECTO #1019;  |FINSI;
     |CIERRA #1019;

     aQueQuiero = "|NC";
     aAlfa      = #1019#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1019#aQueQuiero#;  |QBF eaAsigna;
           |SI #1019nCampo ! 0;
               enCanti  = #1019nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu20;
     |ABRE #1020;
     #1020#0 = #zhazcrea#0;
     #1020#1 = #zhazcrea#1;
     |LEE 000#1020=;
     |SI FSalida ! 0;  |DDEFECTO #1020;  |FINSI;
     |CIERRA #1020;

     aQueQuiero = "|NC";
     aAlfa      = #1020#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1020#aQueQuiero#;  |QBF eaAsigna;
           |SI #1020nCampo ! 0;
               enCanti  = #1020nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu21;
     |ABRE #1021;
     #1021#0 = #zhazcrea#0;
     #1021#1 = #zhazcrea#1;
     |LEE 000#1021=;
     |SI FSalida ! 0;  |DDEFECTO #1021;  |FINSI;
     |CIERRA #1021;

     aQueQuiero = "|NC";
     aAlfa      = #1021#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1021#aQueQuiero#;  |QBF eaAsigna;
           |SI #1021nCampo ! 0;
               enCanti  = #1021nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu22;
     |SI nConta > 2;
         eaAsigna = "T}8}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}6}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}7}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 2;

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "8," + nConta + ",5,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;
     |FINSI;

     eaAlfa   = #1022#2;
     eaAsigna = "T}8}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1022#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1022#4;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}5}";
     enCanti  = #1022#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta   = nConta + 2;

     eaAlfa   = #1022#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}4}";
     enCanti  = #1022#7;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}5}";
     enCanti  = #1022#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAlfa   = #1022#9;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 2;

     eaAlfa   = #1022#10;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}4}";
     enCanti  = #1022#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     aAlfa  = #1022#10;  |QBF aAlfa;
     eaAlfa = " ";

     |SI aAlfa ! "";
         |SI #1022#12 = "1";  eaAlfa = "Otorgada";  |FINSI;
         |SI #1022#12 = "2";  eaAlfa = "Recibida";  |FINSI;
     |FINSI;

     eaAsigna = "T}8}" + nConta + "}5}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}6}";
     enCanti  = #1022#13;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}7}";
     enCanti  = #1022#14;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu22;
     #1022#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu22;
|FIN;

|PROCESO Carga_zregcu22;
     nConta = 2;
     |BUCLE zregcu22;
|FPRC;

|PROCESO Carga_zregcu23;
     |ABRE #1023;
     #1023#0 = #zhazcrea#0;
     #1023#1 = #zhazcrea#1;
     |LEE 000#1023=;
     |SI FSalida ! 0;  |DDEFECTO #1023;  |FINSI;
     |CIERRA #1023;

     aQueQuiero = "|NC";
     aAlfa      = #1023#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1023#aQueQuiero#;  |QBF eaAsigna;
           |SI #1023nCampo ! 0;
               enCanti  = #1023nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu24;
     |ABRE #1024;
     #1024#0 = #zhazcrea#0;
     #1024#1 = #zhazcrea#1;
     |LEE 000#1024=;
     |SI FSalida ! 0;  |DDEFECTO #1024;  |FINSI;
     |CIERRA #1024;

     aQueQuiero = "|NC";
     aAlfa      = #1024#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1024#aQueQuiero#;  |QBF eaAsigna;
           |SI #1024nCampo ! 0;
               enCanti  = #1024nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu25;
     |ABRE #1025;
     #1025#0 = #zhazcrea#0;
     #1025#1 = #zhazcrea#1;
     |LEE 000#1025=;
     |SI FSalida ! 0;  |DDEFECTO #1025;  |FINSI;
     |CIERRA #1025;

     aQueQuiero = "|NC";
     aAlfa      = #1025#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1025#aQueQuiero#;  |QBF eaAsigna;
           |SI nCampo ! 15
               |SI #1025nCampo ! 0;
                   enCanti  = #1025nCampo;
                   |HAZ SeparaImporte;
                   eaConten = eaImporte;  |QBT eaConten;
               |SINO;
                   eaConten = "";
               |FINSI;
           |SINO;
               eaAlfa   = #1025#15;  |HAZ QuitaRarosDSXML;
               eaConten = eaAlfa;
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu26;
     |ABRE #1026;
     #1026#0 = #zhazcrea#0;
     #1026#1 = #zhazcrea#1;
     |LEE 000#1026=;
     |SI FSalida ! 0;  |DDEFECTO #1026;  |FINSI;
     |CIERRA #1026;

     aQueQuiero = "|NC";
     aAlfa      = #1026#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1026#aQueQuiero#;  |QBF eaAsigna;
           |SI #1026nCampo ! 0;
               enCanti  = #1026nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu27;
     |ABRE #1027;
     #1027#0 = #zhazcrea#0;
     #1027#1 = #zhazcrea#1;
     |LEE 000#1027=;
     |SI FSalida ! 0;  |DDEFECTO #1027;  |FINSI;
     |CIERRA #1027;

     aQueQuiero = "|NC";
     aAlfa      = #1027#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1027#aQueQuiero#;  |QBF eaAsigna;
           |SI #1027nCampo ! 0;
               enCanti  = #1027nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu28;
     |ABRE #1028;
     #1028#0 = #zhazcrea#0;
     #1028#1 = #zhazcrea#1;
     |LEE 000#1028=;
     |SI FSalida ! 0;  |DDEFECTO #1028;  |FINSI;
     |CIERRA #1028;

     aQueQuiero = "|NC";
     aAlfa      = #1028#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1028#aQueQuiero#;  |QBF eaAsigna;
           |SI #1028nCampo ! 0;
               enCanti  = #1028nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu29;
     |ABRE #1029;
     #1029#0 = #zhazcrea#0;
     #1029#1 = #zhazcrea#1;
     |LEE 000#1029=;
     |SI FSalida ! 0;  |DDEFECTO #1029;  |FINSI;
     |CIERRA #1029;

     aQueQuiero = "|NC";
     aAlfa      = #1029#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #1029#aQueQuiero#;  |QBF eaAsigna;
           |SI #1029nCampo ! 0;
               enCanti  = #1029nCampo;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu30;
     nConta = nConta + 1;
     |SI nConta > 3;
         eaAsigna = "T}9}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}9}2}1}+P";  eaConten = "";  |HAZ GrabaContenido;
     |FINSI;

     eaAlfa   = #zregcu30#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |SI #zregcu30#4 = "1";  eaAlfa = "Administraci¢n local";         |FINSI;
     |SI #zregcu30#4 = "2";  eaAlfa = "Administraci¢n auton¢mica";    |FINSI;
     |SI #zregcu30#4 = "3";  eaAlfa = "Administraci¢n estatal";       |FINSI;
     |SI #zregcu30#4 = "4";  eaAlfa = "Administraci¢n internacional"; |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}9}" + nConta + "}3}";
     enCanti  = #zregcu30#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     |SI #zregcu30#6 = "1";  eaAlfa = "Subvenci¢n";         |FINSI;
     |SI #zregcu30#6 = "2";  eaAlfa = "Donaci¢n o legado";  |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;
|FPRC;

|DEFBUCLE zregcu30;
     #zregcu30#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu30;
|FIN;

|PROCESO Carga_zregcu30;
     nConta = 1;
     |BUCLE zregcu30;
|FPRC;

|PROCESO DesImagen_cuadr;
    |SI aDef = "";  |ACABA;  |FINSI;

    |CIERRA #900;
    |DESCARGA_DEF #900; aDef = "";
|FPRC;

|PROCESO CarImagen_cuadr;
     |HAZ DesImagen_cuadr;

     |DBASE aMas;
     aDef = aMas + "def/" + aFichero;
     |CARGA_DEF aDef, imagen@;
     |SI FSalida ! 0;
         aDef = "";
         |ACABA;
     |FINSI;

     |SI aFichero = "zregcu04";   |ACABA;   |FINSI;

     |ABRE #imagen@;
     #imagen@#0 = #zhazcrea#0;
     #imagen@#1 = nEjer;
     |LEE 000#imagen@.=;
     nEstado900 = FSalida;
|FPRC;

|PROCESO Quadre01;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1001;
     #1001#0 = #zhazcrea#0;
     #1001#1 = #zhazcrea#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0  = #zhazcrea#0;
         #1001#1  = #zhazcrea#1;
         |GRABA 020#1001b;
     |FINSI;

     #1001#2  = #900#5;  #1001#15 = #900#18;  #1001#28 = #900#31;
     #1001#6  = #900#9;  #1001#19 = #900#22;  #1001#32 = #900#35;
     #1001#10 = #900#14; #1001#23 = #900#27;  #1001#36 = #900#40;

     |GRABA 020#1001a;
     |LIBERA #1001;
     |CIERRA #1001;
|FPRC;

|PROCESO Quadre02;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #1002;
     #1002#0 = #zhazcrea#0;
     #1002#1 = #zhazcrea#1;
     |LEE 101#1002=;
     |SI FSalida ! 0;
         |DDEFECTO #1002;
         #1002#0  = #zhazcrea#0;
         #1002#1  = #zhazcrea#1;
         |GRABA 020#1002b;
     |FINSI;

     #1002#3  = #900#2;  #1002#11 = #900#10;  #1002#19 = #900#18; #1002#27 = #900#26;
     #1002#5  = #900#4;  #1002#13 = #900#12;  #1002#21 = #900#20; #1002#29 = #900#28;
     #1002#7  = #900#6;  #1002#15 = #900#14;  #1002#23 = #900#22; #1002#31 = #900#30;
     #1002#9  = #900#8;  #1002#17 = #900#16;  #1002#25 = #900#24; #1002#33 = #900#32;

     #1002#35  = #900#34;  #1002#43 = #900#42;  #1002#51 = #900#50; #1002#59 = #900#58;
     #1002#37  = #900#36;  #1002#45 = #900#44;  #1002#53 = #900#52; #1002#61 = #900#60;
     #1002#39  = #900#38;  #1002#47 = #900#46;  #1002#55 = #900#54; #1002#63 = #900#62;
     #1002#41  = #900#40;  #1002#49 = #900#48;  #1002#57 = #900#56; #1002#65 = #900#64;

     |GRABA 020#1002a;
     |LIBERA #1002;
     |CIERRA #1002;
|FPRC;

|PROCESO Quadre03;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1003;
     #1003#0 = #zhazcrea#0;
     #1003#1 = #zhazcrea#1;
     |LEE 101#1003=;
     |SI FSalida ! 0;
         |DDEFECTO #1003;
         #1003#0  = #zhazcrea#0;
         #1003#1  = #zhazcrea#1;
         |GRABA 020#1003b;
     |FINSI;

     #1003#2 = #900#7;   #1003#13 = #900#18;
     #1003#3 = #900#8;   #1003#14 = #900#19;
     #1003#4 = #900#9;   #1003#15 = #900#20;
     #1003#5 = #900#10;  #1003#16 = #900#21;
     #1003#6 = #900#11;  #1003#17 = #900#22;
     #1003#7 = #900#12;  #1003#18 = #900#23;

     |PARA nCampo3 = 24;  |SI nCampo3 [ 34;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #1003nCampo3 = #1003nCampo1 + #1003nCampo2;
     |SIGUE;

     #1003#35 = #900#40;   #1003#46 = #900#51;
     #1003#36 = #900#41;   #1003#47 = #900#52;
     #1003#37 = #900#42;   #1003#48 = #900#53;
     #1003#38 = #900#43;   #1003#49 = #900#54;
     #1003#39 = #900#44;   #1003#50 = #900#55;
     #1003#40 = #900#45;   #1003#51 = #900#56;

     |PARA nCampo3 = 57;  |SI nCampo3 [ 67;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #1003nCampo3 = #1003nCampo1 + #1003nCampo2;
     |SIGUE;

     |GRABA 020#1003a;
     |LIBERA #1003;
     |CIERRA #1003;
|FPRC;

|PROCESO zregcu04I;
     |SI #zhazcrea#15 = "P";
         #1004#0 = #zhazcrea#0;
         #1004#1 = #zhazcrea#1;
         #1004#2 = #900#2;
         |LEE 101#1004=;
         |SI FSalida ! 0;
             |DDEFECTO #1004;
             #1004#0 = #zhazcrea#0;
             #1004#1 = #zhazcrea#1;
             #1004#2 = #900#2;
             |GRABA 020#1004b;
         |FINSI;
         |PARA nCampo = 3;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
               #1004nCampo = #900nCampo;
         |SIGUE;
         |GRABA 020#1004a;
         |LIBERA #1004;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         #1018#0 = #zhazcrea#0;
         #1018#1 = #zhazcrea#1;
         #1018#2 = #900#2;
         |LEE 101#1018=;
         |SI FSalida ! 0;
             |DDEFECTO #1018;
             #1018#0 = #zhazcrea#0;
             #1018#1 = #zhazcrea#1;
             #1018#2 = #900#2;
             |GRABA 020#1018b;
         |FINSI;

         #1018#3  = #900#4;
         #1018#4  = #900#5;
         #1018#5  = #900#6;
         #1018#6  = #900#3;
         #1018#7  = #900#7;
         #1018#8  = #900#8;
         #1018#9  = #900#9;

         |GRABA 020#1018a;
         |LIBERA #1018;
     |FINSI;
|FPRC;

|DEFBUCLE zregcu04I;
     #900#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu04I;
|FIN;

|PROCESO Quadre04;
    |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

    |HAZ CarImagen_cuadr;

    |SI aDef ! "";
        |ABRE #1004;
        |ABRE #1018;
        |BUCLE zregcu04I;
        |CIERRA #1004;
        |CIERRA #1018;

        |ABRE #900;
    |FINSI;
|FPRC;

|PROCESO zregcu18I;
     |SI #zhazcrea#15 = "P";
         #1004#0 = #zhazcrea#0;
         #1004#1 = #zhazcrea#1;
         #1004#2 = #900#2;
         |LEE 101#1004=;
         |SI FSalida ! 0;
             |DDEFECTO #1004;
             #1004#0 = #zhazcrea#0;
             #1004#1 = #zhazcrea#1;
             #1004#2 = #900#2;
             |GRABA 020#1004b;
         |FINSI;

         #1004#3  = #900#6;
         #1004#4  = #900#3;
         #1004#5  = #900#4;
         #1004#6  = #900#5;
         #1004#7  = #900#7;
         #1004#8  = #900#8;
         #1004#9  = #900#9;

         |GRABA 020#1004a;
         |LIBERA #1004;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         #1018#0 = #zhazcrea#0;
         #1018#1 = #zhazcrea#1;
         #1018#2 = #900#2;
         |LEE 101#1018=;
         |SI FSalida ! 0;
             |DDEFECTO #1018;
             #1018#0 = #zhazcrea#0;
             #1018#1 = #zhazcrea#1;
             #1018#2 = #900#2;
             |GRABA 020#1018b;
         |FINSI;

         #1018#3  = #900#3;
         #1018#4  = #900#4;
         #1018#5  = #900#5;
         #1018#6  = #900#6;
         #1018#7  = #900#7;
         #1018#8  = #900#8;
         #1018#9  = #900#9;

         |GRABA 020#1018a;
         |LIBERA #1018;
     |FINSI;
|FPRC;

|DEFBUCLE zregcu18I;
     #900#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu18I;
|FIN;

|PROCESO Quadre18;
    |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

    |HAZ CarImagen_cuadr;

    |SI aDef ! "";
        |ABRE #1004;
        |ABRE #1018;
        |BUCLE zregcu18I;
        |CIERRA #1004;
        |CIERRA #1018;

        |ABRE #900;
    |FINSI;
|FPRC;

|PROCESO zregcu16I;
     #1016#0 = #zhazcrea#0;
     #1016#1 = #zhazcrea#1;
     #1016#2 = #900#2;
     |LEE 101#1016=;
     |SI FSalida ! 0;
         |DDEFECTO #1016;
         #1016#0 = #zhazcrea#0;
         #1016#1 = #zhazcrea#1;
         #1016#2 = #900#2;
         |GRABA 020#1016b;
     |FINSI;

     #1016#3  = #900#3;
     #1016#4  = #900#4;
     #1016#5  = #900#5;
     #1016#6  = #900#6;
     #1016#7  = #900#7 + 1;
     #1016#8  = #900#9;
     #1016#9  = 0;
     #1016#10 = #900#10;
     #1016#11 = #900#11;

     |GRABA 020#1016a;
     |LIBERA #1016;
|FPRC;

|DEFBUCLE zregcu16I;
     #900#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu16I;
|FIN;

|PROCESO Quadre16;
    |HAZ CarImagen_cuadr;

    |SI aDef ! "";
        |ABRE #1016;
        |BUCLE zregcu16I;
        |CIERRA #1016;

        |ABRE #900;
    |FINSI;
|FPRC;

|PROCESO Quadre05;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #1005;
     #1005#0 = #zhazcrea#0;
     #1005#1 = #zhazcrea#1;
     |LEE 101#1005=;
     |SI FSalida ! 0;
         |DDEFECTO #1005;
         #1005#0  = #zhazcrea#0;
         #1005#1  = #zhazcrea#1;
         |GRABA 020#1005b;
     |FINSI;

     #1005#3  = #900#2; #1005#11 = #900#10; #1005#19 = #900#18;
     #1005#5  = #900#4; #1005#13 = #900#12; #1005#21 = #900#20;
     #1005#7  = #900#6; #1005#15 = #900#14; #1005#23 = #900#22;
     #1005#9  = #900#8; #1005#17 = #900#16; #1005#25 = #900#24;

     #1005#27 = #900#26; #1005#35 = #900#34; #1005#43 = #900#42;
     #1005#29 = #900#28; #1005#37 = #900#36; #1005#45 = #900#44;
     #1005#31 = #900#30; #1005#39 = #900#38; #1005#47 = #900#46;
     #1005#33 = #900#32; #1005#41 = #900#40; #1005#49 = #900#48;

     |GRABA 020#1005a;
     |LIBERA #1005;
     |CIERRA #1005;
|FPRC;

|PROCESO Quadre08;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#15 = "P";
         |ABRE #1008;
         #1008#0 = #zhazcrea#0;
         #1008#1 = #zhazcrea#1;
         |LEE 101#1008=;
         |SI FSalida ! 0;
             |DDEFECTO #1008;
             #1008#0  = #zhazcrea#0;
             #1008#1  = #zhazcrea#1;
             |GRABA 020#1008b;
         |FINSI;

         #1008#18 = #900#4;  #1008#19 = #900#5;
         #1008#20 = #900#6;  #1008#21 = #900#7;
         #1008#22 = #900#8;  #1008#23 = #900#9;
         #1008#24 = #900#10; #1008#25 = #900#11;
         #1008#26 = #900#12; #1008#27 = #900#13;
         #1008#28 = #900#14; #1008#29 = #900#15;

         #1008#02 = #1008#03 + #1008#04 + #1008#05;
         #1008#07 = #1008#08 + #1008#09 + #1008#10;
         #1008#16 = #1008#17 + #1008#18 + #1008#19;
         #1008#21 = #1008#22 + #1008#23 + #1008#24;

         #1008#34 = #1008#02 + #1008#06;
         #1008#35 = #1008#07 + #1008#11;
         #1008#36 = #1008#30 + #1008#31;
         #1008#37 = #1008#12 + #1008#13;
         #1008#38 = #1008#16 + #1008#20;
         #1008#39 = #1008#21 + #1008#25;
         #1008#40 = #1008#32 + #1008#33;
         #1008#41 = #1008#26 + #1008#27;

         |GRABA 020#1008a;
         |LIBERA #1008;
         |CIERRA #1008;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #1020;
         #1020#0 = #zhazcrea#0;
         #1020#1 = #zhazcrea#1;
         |LEE 101#1020=;
         |SI FSalida ! 0;
             |DDEFECTO #1020;
             #1020#0  = #zhazcrea#0;
             #1020#1  = #zhazcrea#1;
             |GRABA 020#1020b;
         |FINSI;

         #1020#24 = #900#2;
         #1020#26 = #900#4;
         #1020#27 = #900#5;
         #1020#28 = #900#6;
         #1020#30 = #900#7;
         #1020#31 = #900#8;
         #1020#32 = #900#9;
         #1020#33 = #900#10;
         #1020#34 = #900#11;
         #1020#40 = #900#12;
         #1020#41 = #900#13;
         #1020#42 = #900#14;
         #1020#43 = #900#15;

         #1020#03 = #1020#04 + #1020#05 + #1020#06;
         #1020#02 = #1020#03 + #1020#07;
         #1020#24 = #1020#25 + #1020#26 + #1020#27;
         #1020#23 = #1020#24 + #1020#28;

         #1020#09 = #1020#10 + #1020#11 + #1020#12;
         #1020#08 = #1020#09 + #1020#13;
         #1020#30 = #1020#31 + #1020#32 + #1020#33;
         #1020#29 = #1020#30 + #1020#34;

         #1020#14 = #1020#15 + #1020#16 + #1020#17;
         #1020#35 = #1020#36 + #1020#37 + #1020#38;

         #1020#18 = #1020#19 + #1020#20;
         #1020#39 = #1020#40 + #1020#41;

         |GRABA 020#1020a;
         |LIBERA #1020;
         |CIERRA #1020;
    |FINSI;
|FPRC;

|PROCESO Quadre09;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #1009;
     #1009#0 = #zhazcrea#0;
     #1009#1 = #zhazcrea#1;
     |LEE 101#1009=;
     |SI FSalida ! 0;
         |DDEFECTO #1009;
         #1009#0  = #zhazcrea#0;
         #1009#1  = #zhazcrea#1;
         |GRABA 020#1009b;
     |FINSI;

     #1009#8  = #900#2; #1009#9  = #900#3;
     #1009#10 = #900#4; #1009#11 = #900#5;
     #1009#12 = #900#6; #1009#13 = #900#7;

     |GRABA 020#1009a;
     |LIBERA #1009;
     |CIERRA #1009;
|FPRC;

|PROCESO Quadre11;
     |SI #zhazcrea#1 > 2017; aFichero = "zregcu31"; |FINSI;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#1 [ 2016;

         |SI #zhazcrea#15 ! "A";
             |ABRE #zregcu11;
             #zregcu11#0 = #zhazcrea#0;
             #zregcu11#1 = #zhazcrea#1;
             |LEE 101#zregcu11.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu11;
                 #zregcu11#0  = #zhazcrea#0;
                 #zregcu11#1  = #zhazcrea#1;
                 |GRABA 020#zregcu11.b;
             |FINSI;

             #zregcu11#8  = #imagen@#2; #zregcu11#20 = #imagen@#14;
             #zregcu11#9  = #imagen@#3; #zregcu11#21 = #imagen@#15;
             #zregcu11#10 = #imagen@#4; #zregcu11#22 = #imagen@#16;
             #zregcu11#11 = #imagen@#5; #zregcu11#23 = #imagen@#17;
             #zregcu11#12 = #imagen@#6; #zregcu11#24 = #imagen@#18;
             #zregcu11#13 = #imagen@#7; #zregcu11#25 = #imagen@#19;

             |GRABA 020#zregcu11.a;
             |LIBERA #zregcu11;
             |CIERRA #zregcu11;
         |FINSI;

         |SI #zhazcrea#15 = "A";
             |ABRE #zregcu23;
             #zregcu23#0 = #zhazcrea#0;
             #zregcu23#1 = #zhazcrea#1;
             |LEE 101#zregcu23.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu23;
                 #zregcu23#0  = #zhazcrea#0;
                 #zregcu23#1  = #zhazcrea#1;
                 |GRABA 020#zregcu23.b;
             |FINSI;

             #zregcu23#14  = #imagen@#2;
             #zregcu23#19  = #imagen@#3;
             #zregcu23#20  = #imagen@#4;
             #zregcu23#21  = #imagen@#5;
             #zregcu23#24  = #imagen@#6;
             #zregcu23#25  = #imagen@#7;

             #zregcu23#38  = #imagen@#14;
             #zregcu23#43  = #imagen@#15;
             #zregcu23#44  = #imagen@#16;
             #zregcu23#45  = #imagen@#17;
             #zregcu23#48  = #imagen@#18;
             #zregcu23#49  = #imagen@#19;

             #zregcu23#03 = #zregcu23#04 + #zregcu23#05;   |PINTA #zregcu23#03;
             #zregcu23#06 = #zregcu23#07 + #zregcu23#08;   |PINTA #zregcu23#06;
             #zregcu23#11 = #zregcu23#12 + #zregcu23#13;   |PINTA #zregcu23#11;

             #zregcu23#15 = #zregcu23#16 + #zregcu23#17;   |PINTA #zregcu23#15;
             #zregcu23#18 = #zregcu23#19 + #zregcu23#20;   |PINTA #zregcu23#18;
             #zregcu23#23 = #zregcu23#24 + #zregcu23#25;   |PINTA #zregcu23#23;

             #zregcu23#27 = #zregcu23#28 + #zregcu23#29;   |PINTA #zregcu23#27;
             #zregcu23#30 = #zregcu23#31 + #zregcu23#32;   |PINTA #zregcu23#38;
             #zregcu23#35 = #zregcu23#36 + #zregcu23#37;   |PINTA #zregcu23#35;

             #zregcu23#39 = #zregcu23#40 + #zregcu23#41;   |PINTA #zregcu23#39;
             #zregcu23#42 = #zregcu23#43 + #zregcu23#44;   |PINTA #zregcu23#42;
             #zregcu23#47 = #zregcu23#48 + #zregcu23#49;   |PINTA #zregcu23#47;

             |GRABA 020#zregcu23.a;
             |LIBERA #zregcu23;
             |CIERRA #zregcu23;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |ABRE #zregcu31;
         #zregcu31#0 = #zhazcrea#0;
         #zregcu31#1 = #zhazcrea#1;
         |LEE 101#zregcu31.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu31;
             #zregcu31#0  = #zhazcrea#0;
             #zregcu31#1  = #zhazcrea#1;
             |GRABA 020#zregcu31.b;
         |FINSI;

         |SI #zhazcrea#1 = 2017;
             #zregcu31#4  = #imagen@#6; #zregcu31#8 = #imagen@#18;
             #zregcu31#5  = #imagen@#7; #zregcu31#9 = #imagen@#19;
         |SINO;
             #zregcu31#4  = #imagen@#2; #zregcu31#8 = #imagen@#6;
             #zregcu31#5  = #imagen@#3; #zregcu31#9 = #imagen@#7;
         |FINSI;
         #zregcu31#10 = #zregcu31#2 + #zregcu31#3;
         #zregcu31#11 = #zregcu31#4 + #zregcu31#5;
         #zregcu31#12 = #zregcu31#6 + #zregcu31#7;
         #zregcu31#13 = #zregcu31#8 + #zregcu31#9;

         |GRABA 020#zregcu31.a;
         |LIBERA #zregcu31;
         |CIERRA #zregcu31;
     |FINSI;
|FPRC;

|PROCESO Quadre12;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1012;
     #1012#0 = #zhazcrea#0;
     #1012#1 = #zhazcrea#1;
     |LEE 101#1012=;
     |SI FSalida ! 0;
         |DDEFECTO #1012;
         #1012#0  = #zhazcrea#0;
         #1012#1  = #zhazcrea#1;
         |GRABA 020#1012b;
     |FINSI;

     #1012#18 = #900#2;
     #1012#19 = #900#3;
     #1012#20 = #900#4;
     #1012#21 = #900#5;
     #1012#22 = #900#6;
     #1012#23 = #900#7;
     #1012#24 = #900#8;
     #1012#25 = #900#9;
     #1012#26 = #900#10;
     #1012#27 = #900#11;
     #1012#28 = #900#12;
     #1012#29 = #900#13;
     #1012#30 = #900#14;
     #1012#31 = #900#15;
     #1012#32 = #900#16;
     #1012#33 = #900#17;

     |GRABA 020#1012a;
     |LIBERA #1012;
     |CIERRA #1012;
|FPRC;

|PROCESO Quadre13;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1013;
     #1013#0 = #zhazcrea#0;
     #1013#1 = #zhazcrea#1;
     |LEE 101#1013=;
     |SI FSalida ! 0;
         |DDEFECTO #1013;
         #1013#0  = #zhazcrea#0;
         #1013#1  = #zhazcrea#1;
         |GRABA 020#1013b;
     |FINSI;

     #1013#13 = #900#2;  #1013#35 = #900#24; #1013#57 = #900#46;
     #1013#14 = #900#3;  #1013#36 = #900#25; #1013#58 = #900#47;
     #1013#15 = #900#4;  #1013#37 = #900#26; #1013#59 = #900#48;
     #1013#16 = #900#5;  #1013#38 = #900#27; #1013#60 = #900#49;
     #1013#17 = #900#6;  #1013#39 = #900#28; #1013#61 = #900#50;
     #1013#18 = #900#7;  #1013#40 = #900#29; #1013#62 = #900#51;
     #1013#19 = #900#8;  #1013#41 = #900#30; #1013#63 = #900#52;
     #1013#20 = #900#9;  #1013#42 = #900#31; #1013#64 = #900#53;
     #1013#21 = #900#10; #1013#43 = #900#32; #1013#65 = #900#54;
     #1013#22 = #900#11; #1013#44 = #900#33; #1013#66 = #900#55;
     #1013#23 = #900#12; #1013#45 = #900#34; #1013#67 = #900#56;

     |GRABA 020#1013a;
     |LIBERA #1013;
     |CIERRA #1013;
|FPRC;

|PROCESO Quadre15;
     |SI #zhazcrea#1 ] 2015; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1015;
     #1015#0 = #zhazcrea#0;
     #1015#1 = #zhazcrea#1;
     |LEE 101#1015=;
     |SI FSalida ! 0;
         |DDEFECTO #1015;
         #1015#0  = #zhazcrea#0;
         #1015#1  = #zhazcrea#1;
         |GRABA 020#1015b;
     |FINSI;

     #1015#09 = #900#2;
     #1015#13 = #900#6;
     #1015#10 = #900#3;
     #1015#14 = #900#7;
     #1015#11 = #900#4;
     #1015#15 = #900#8;
     #1015#12 = #900#5;

     |GRABA 020#1015a;
     |LIBERA #1015;
     |CIERRA #1015;
|FPRC;

|PROCESO Quadre17;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15 = "P";  |ACABA;  |FINSI;

     |ABRE #1017;
     #1017#0 = #zhazcrea#0;
     #1017#1 = #zhazcrea#1;
     |LEE 101#1017=;
     |SI FSalida ! 0;
         |DDEFECTO #1017;
         #1017#0  = #zhazcrea#0;
         #1017#1  = #zhazcrea#1;
         |GRABA 020#1017b;
     |FINSI;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 97;  |HACIENDO nCampo1 = nCampo1 + 2;
           nCampo2      = nCampo1 - 1;
           #1017nCampo1 = #900nCampo2;
     |SIGUE;

     |GRABA 020#1017a;
     |LIBERA #1017;
     |CIERRA #1017;
|FPRC;

|PROCESO Quadre19;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15 = "P";  |ACABA;  |FINSI;

     |ABRE #1019;
     #1019#0 = #zhazcrea#0;
     #1019#1 = #zhazcrea#1;
     |LEE 101#1019=;
     |SI FSalida ! 0;
         |DDEFECTO #1019;
         #1019#0  = #zhazcrea#0;
         #1019#1  = #zhazcrea#1;
         |GRABA 020#1019b;
     |FINSI;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 65;  |HACIENDO nCampo1 = nCampo1 + 2;
           nCampo2      = nCampo1 - 1;
           #1019nCampo1 = #900nCampo2;
     |SIGUE;

     |GRABA 020#1019a;
     |LIBERA #1019;
     |CIERRA #1019;
|FPRC;

|PROCESO Quadre20;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#15 = "P";
         |ABRE #1008;
         #1008#0 = #zhazcrea#0;
         #1008#1 = #zhazcrea#1;
         |LEE 101#1008=;
         |SI FSalida ! 0;
             |DDEFECTO #1008;
             #1008#0  = #zhazcrea#0;
             #1008#1  = #zhazcrea#1;
             |GRABA 020#1008b;
         |FINSI;

         #1008#17 = #900#4;
         #1008#18 = #900#5;
         #1008#19 = #900#6;
         #1008#20 = #900#7;
         #1008#21 = #900#9;
         #1008#22 = #900#10;
         #1008#23 = #900#11;
         #1008#24 = #900#12;
         #1008#25 = #900#13;
         #1008#26 = #900#19;
         #1008#27 = #900#20;
         #1008#28 = #900#21;
         #1008#29 = #900#22;

         #1008#02 = #1008#03 + #1008#04 + #1008#05;
         #1008#07 = #1008#08 + #1008#09 + #1008#10;
         #1008#16 = #1008#17 + #1008#18 + #1008#19;
         #1008#21 = #1008#22 + #1008#23 + #1008#24;

         #1008#34 = #1008#02 + #1008#06;
         #1008#35 = #1008#07 + #1008#11;
         #1008#36 = #1008#30 + #1008#31;
         #1008#37 = #1008#12 + #1008#13;
         #1008#38 = #1008#16 + #1008#20;
         #1008#39 = #1008#21 + #1008#25;
         #1008#40 = #1008#32 + #1008#33;
         #1008#41 = #1008#26 + #1008#27;

         |GRABA 020#1008a;
         |LIBERA #1008;
         |CIERRA #1008;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #1020;
         #1020#0 = #zhazcrea#0;
         #1020#1 = #zhazcrea#1;
         |LEE 101#1020=;
         |SI FSalida ! 0;
             |DDEFECTO #1020;
             #1020#0  = #zhazcrea#0;
             #1020#1  = #zhazcrea#1;
             |GRABA 020#1020b;
         |FINSI;

         #1020#25 = #900#4;
         #1020#26 = #900#5;
         #1020#27 = #900#6;
         #1020#28 = #900#7;
         #1020#31 = #900#10;
         #1020#32 = #900#11;
         #1020#33 = #900#12;
         #1020#34 = #900#13;
         #1020#36 = #900#15;
         #1020#37 = #900#16;
         #1020#38 = #900#17;
         #1020#40 = #900#19;
         #1020#41 = #900#20;
         #1020#42 = #900#21;
         #1020#43 = #900#22;

         #1020#03 = #1020#04 + #1020#05 + #1020#06;
         #1020#02 = #1020#03 + #1020#07;
         #1020#24 = #1020#25 + #1020#26 + #1020#27;
         #1020#23 = #1020#24 + #1020#28;

         #1020#09 = #1020#10 + #1020#11 + #1020#12;
         #1020#08 = #1020#09 + #1020#13;
         #1020#30 = #1020#31 + #1020#32 + #1020#33;
         #1020#29 = #1020#30 + #1020#34;

         #1020#14 = #1020#15 + #1020#16 + #1020#17;
         #1020#35 = #1020#36 + #1020#37 + #1020#38;

         #1020#18 = #1020#19 + #1020#20;
         #1020#39 = #1020#40 + #1020#41;

         |GRABA 020#1020a;
         |LIBERA #1020;
         |CIERRA #1020;
    |FINSI;
|FPRC;

|PROCESO Quadre21;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";    |ACABA;  |FINSI;
     |SI nEstado900 ! 0;     |ACABA;  |FINSI;
     |SI #zhazcrea#15 = "P"; |ACABA;  |FINSI;

     |ABRE #1021;
     #1021#0 = #zhazcrea#0;
     #1021#1 = #zhazcrea#1;
     |LEE 101#1021=;
     |SI FSalida ! 0;
         |DDEFECTO #1021;
         #1021#0  = #zhazcrea#0;
         #1021#1  = #zhazcrea#1;
         |GRABA 020#1021b;
     |FINSI;

     #1021#12 = #900#2;
     #1021#13 = #900#3;
     #1021#14 = #900#4;
     #1021#15 = #900#5;
     #1021#16 = #900#6;
     #1021#17 = #900#7;
     #1021#18 = #900#8;
     #1021#19 = #900#9;
     #1021#20 = #900#10;
     #1021#21 = #900#11;

     |GRABA 020#1021a;
     |LIBERA #1021;
     |CIERRA #1021;
|FPRC;

|PROCESO Quadre23;
     |SI #zhazcrea#1 > 2017; aFichero = "zregcu31"; |FINSI;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#1 [ 2016;
         |SI #zhazcrea#15 ! "A";
             |ABRE #zregcu11;
             #zregcu11#0 = #zhazcrea#0;
             #zregcu11#1 = #zhazcrea#1;
             |LEE 101#zregcu11.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu11;
                 #zregcu11#0  = #zhazcrea#0;
                 #zregcu11#1  = #zhazcrea#1;
                 |GRABA 020#zregcu11.b;
             |FINSI;

             #zregcu11#8  = #imagen@#2;
             #zregcu11#9  = #imagen@#7;
             #zregcu11#10 = #imagen@#8;
             #zregcu11#11 = #imagen@#9;
             #zregcu11#12 = #imagen@#12;
             #zregcu11#13 = #imagen@#13;

             #zregcu11#20 = #imagen@#26;
             #zregcu11#21 = #imagen@#31;
             #zregcu11#22 = #imagen@#32;
             #zregcu11#23 = #imagen@#33;
             #zregcu11#24 = #imagen@#36;
             #zregcu11#25 = #imagen@#37;

             |GRABA 020#zregcu11.a;
             |LIBERA #zregcu11;
             |CIERRA #zregcu11;
         |FINSI;

         |SI #zhazcrea#15 = "A";
             |ABRE #zregcu23;
             #zregcu23#0 = #zhazcrea#0;
             #zregcu23#1 = #zhazcrea#1;
             |LEE 101#zregcu23.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu23;
                 #zregcu23#0  = #zhazcrea#0;
                 #zregcu23#1  = #zhazcrea#1;
                 |GRABA 020#zregcu23.b;
             |FINSI;

             #zregcu23#14 = #imagen@#2;
             #zregcu23#15 = #imagen@#3;
             #zregcu23#16 = #imagen@#4;
             #zregcu23#17 = #imagen@#5;
             #zregcu23#18 = #imagen@#6;
             #zregcu23#19 = #imagen@#7;
             #zregcu23#20 = #imagen@#8;
             #zregcu23#21 = #imagen@#9;
             #zregcu23#22 = #imagen@#10;
             #zregcu23#23 = #imagen@#11;
             #zregcu23#24 = #imagen@#12;
             #zregcu23#25 = #imagen@#13;

             #zregcu23#38 = #imagen@#26;
             #zregcu23#39 = #imagen@#27;
             #zregcu23#40 = #imagen@#28;
             #zregcu23#41 = #imagen@#29;
             #zregcu23#42 = #imagen@#30;
             #zregcu23#43 = #imagen@#31;
             #zregcu23#44 = #imagen@#32;
             #zregcu23#45 = #imagen@#33;
             #zregcu23#46 = #imagen@#34;
             #zregcu23#47 = #imagen@#35;
             #zregcu23#48 = #imagen@#36;
             #zregcu23#49 = #imagen@#37;

             #zregcu23#03 = #zregcu23#04 + #zregcu23#05;   |PINTA #zregcu23#03;
             #zregcu23#06 = #zregcu23#07 + #zregcu23#08;   |PINTA #zregcu23#06;
             #zregcu23#11 = #zregcu23#12 + #zregcu23#13;   |PINTA #zregcu23#11;

             #zregcu23#15 = #zregcu23#16 + #zregcu23#17;   |PINTA #zregcu23#15;
             #zregcu23#18 = #zregcu23#19 + #zregcu23#20;   |PINTA #zregcu23#18;
             #zregcu23#23 = #zregcu23#24 + #zregcu23#25;   |PINTA #zregcu23#23;

             #zregcu23#27 = #zregcu23#28 + #zregcu23#29;   |PINTA #zregcu23#27;
             #zregcu23#30 = #zregcu23#31 + #zregcu23#32;   |PINTA #zregcu23#38;
             #zregcu23#35 = #zregcu23#36 + #zregcu23#37;   |PINTA #zregcu23#35;

             #zregcu23#39 = #zregcu23#40 + #zregcu23#41;   |PINTA #zregcu23#39;
             #zregcu23#42 = #zregcu23#43 + #zregcu23#44;   |PINTA #zregcu23#42;
             #zregcu23#47 = #zregcu23#48 + #zregcu23#49;   |PINTA #zregcu23#47;

             |GRABA 020#zregcu23.a;
             |LIBERA #zregcu23;
             |CIERRA #zregcu23;
         |FINSI;
    |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |ABRE #zregcu31;
         #zregcu31#0 = #zhazcrea#0;
         #zregcu31#1 = #zhazcrea#1;
         |LEE 101#zregcu31.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu31;
             #zregcu31#0  = #zhazcrea#0;
             #zregcu31#1  = #zhazcrea#1;
             |GRABA 020#zregcu31.b;
         |FINSI;

         |SI #zhazcrea#1 = 2017;
             #zregcu31#4  = #imagen@#12; #zregcu31#8 = #imagen@#36;
             #zregcu31#5  = #imagen@#13; #zregcu31#9 = #imagen@#37;
         |SINO;
             #zregcu31#4  = #imagen@#2; #zregcu31#8 = #imagen@#6;
             #zregcu31#5  = #imagen@#3; #zregcu31#9 = #imagen@#7;
         |FINSI;
         #zregcu31#10 = #zregcu31#2 + #zregcu31#3;
         #zregcu31#11 = #zregcu31#4 + #zregcu31#5;
         #zregcu31#12 = #zregcu31#6 + #zregcu31#7;
         #zregcu31#13 = #zregcu31#8 + #zregcu31#9;

         |GRABA 020#zregcu31.a;
         |LIBERA #zregcu31;
         |CIERRA #zregcu31;
     |FINSI;
|FPRC;

|PROCESO Quadre24;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";    |ACABA;  |FINSI;
     |SI nEstado900 ! 0;     |ACABA;  |FINSI;
     |SI #0#0       [ 2010;  |ACABA;  |FINSI;

     |ABRE #1024;
     #1024#0 = #zhazcrea#0;
     #1024#1 = #zhazcrea#1;
     |LEE 101#1024=;
     |SI FSalida ! 0;
         |DDEFECTO #1024;
         #1024#0  = #zhazcrea#0;
         #1024#1  = #zhazcrea#1;
         |GRABA 020#1024b;
     |FINSI;

     #1024#11 = #900#2;
     #1024#12 = #900#3;
     #1024#13 = #900#4;
     #1024#14 = #900#5;
     #1024#15 = #900#6;
     #1024#16 = #900#7;
     #1024#17 = #900#8;
     #1024#18 = #900#9;
     #1024#19 = #900#10;

     |GRABA 020#1024a;
     |LIBERA #1024;
     |CIERRA #1024;
|FPRC;

|PROCESO Quadre28;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";    |ACABA;  |FINSI;
     |SI nEstado900 ! 0;     |ACABA;  |FINSI;
     |SI #0#0       [ 2010;  |ACABA;  |FINSI;

     |ABRE #1028;
     #1028#0 = #zhazcrea#0;
     #1028#1 = #zhazcrea#1;
     |LEE 101#1028=;
     |SI FSalida ! 0;
         |DDEFECTO #1028;
         #1028#0  = #zhazcrea#0;
         #1028#1  = #zhazcrea#1;
         |GRABA 020#1028b;
     |FINSI;

     #1028#6 = #900#2;
     #1028#7 = #900#3;
     #1028#8 = #900#4;
     #1028#9 = #900#5;

     |GRABA 020#1028a;
     |LIBERA #1028;
     |CIERRA #1028;
|FPRC;

|PROCESO Quadre29;

     |SI #zhazcrea#1 [ 2015; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #1029;
     #1029#0 = #zhazcrea#0;
     #1029#1 = #zhazcrea#1;
     |LEE 101#1029=;
     |SI FSalida ! 0;
         |DDEFECTO #1029;
         #1029#0  = #zhazcrea#0;
         #1029#1  = #zhazcrea#1;
         |GRABA 020#1029b;
     |FINSI;

     #1029#03 = #900#2;
     |GRABA 020#1029a;
     |LIBERA #1029;
     |CIERRA #1029;
|FPRC;

|PROCESO Quadre32;

     |SI #zhazcrea#1 < 2018; |ACABA; |FINSI;
     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
                                       ||ver zhazcrea15 = P
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu32;
     #zregcu32#0 = #zhazcrea#0;
     #zregcu32#1 = #zhazcrea#1;
     |LEE 101#zregcu32.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu32;
         #zregcu32#0  = #zhazcrea#0;
         #zregcu32#1  = #zhazcrea#1;
         |GRABA 020#zregcu32.b;
     |FINSI;

     #zregcu32#2 = #imagen@#5; #zregcu32#9  = #imagen@#12; #zregcu32#16 = #imagen@#19;
     #zregcu32#3 = #imagen@#6; #zregcu32#10 = #imagen@#13; #zregcu32#17 = #imagen@#20;
     #zregcu32#4 = #imagen@#7; #zregcu32#11 = #imagen@#14; #zregcu32#18 = #imagen@#21;
     #zregcu32#5 = #imagen@#8; #zregcu32#12 = #imagen@#15; #zregcu32#19 = #imagen@#22;

     #zregcu32#23 = #zregcu32#2 + #zregcu32#9  + #zregcu32#16;
     #zregcu32#24 = #zregcu32#3 + #zregcu32#10 + #zregcu32#17;
     #zregcu32#25 = #zregcu32#4 + #zregcu32#11 + #zregcu32#18;
     #zregcu32#26 = #zregcu32#5 + #zregcu32#12 + #zregcu32#19;

     |GRABA 020#zregcu32.a;
     |LIBERA #zregcu32;
     |CIERRA #zregcu32;
|FPRC;

|PROCESO Quadre33;
     |SI #zhazcrea#1 < 2018; |ACABA; |FINSI;

     |HAZ CarImagen_cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
                                       ||ver zhazcrea15 = P
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu33;
     #zregcu33#0 = #zhazcrea#0;
     #zregcu33#1 = #zhazcrea#1;
     |LEE 101#zregcu33.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu33;
         #zregcu33#0  = #zhazcrea#0;
         #zregcu33#1  = #zhazcrea#1;
         |GRABA 020#zregcu33.b;
     |FINSI;

     #zregcu33#2 = #imagen@#7;
     #zregcu33#8 = #imagen@#13;
     #zregcu33#14 = #imagen@#19;
     #zregcu33#20 = #imagen@#25;

     |GRABA 020#zregcu33.a;
     |LIBERA #zregcu33;
     |CIERRA #zregcu33;
|FPRC;

|PROCESO PaseAnterior;
    nEjer = #zhazcrea#1 - 1;
    aDef  = "";
    |SI #0#0 < 2009;  |ACABA;  |FINSI;

    aFichero = "zregdocu";
    |HAZ CarImagen_cuadr;
    aTipoMemoria = #900#69;

    |SI nSwPaseAnt = 1;
        |SI aTipoMemoria = "P";
            aFichero = "zregcu04"; |HAZ Quadre04;
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu02"; |HAZ Quadre02;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu05"; |HAZ Quadre05;
            aFichero = "zregcu08"; |HAZ Quadre08;
            aFichero = "zregcu09"; |HAZ Quadre09;
            aFichero = "zregcu11"; |HAZ Quadre11;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu24"; |HAZ Quadre24;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;
        |FINSI;

        |SI aTipoMemoria = "A";
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu17"; |HAZ Quadre17;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu19"; |HAZ Quadre19;
            aFichero = "zregcu20"; |HAZ Quadre20;
            aFichero = "zregcu21"; |HAZ Quadre21;
            aFichero = "zregcu23"; |HAZ Quadre23;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu18"; |HAZ Quadre18;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;

            |SI #zhazcrea#15 = "A";
                aFichero = "zregcu16"; |HAZ Quadre16;
            |FINSI;
        |FINSI;

        |SI aTipoMemoria = "C";
            aFichero = "zregcu04"; |HAZ Quadre04;
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu02"; |HAZ Quadre02;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu05"; |HAZ Quadre05;
            aFichero = "zregcu08"; |HAZ Quadre08;
            aFichero = "zregcu09"; |HAZ Quadre09;
            aFichero = "zregcu11"; |HAZ Quadre11;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu24"; |HAZ Quadre24;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;
        |FINSI;
    |SINO;
        |SI aTipoMemoria = "P";
            nHay = 1;

            |ABRE #1004;
            #1004#0 = #zhazcrea#0;
            #1004#1 = #zhazcrea#1;
            #1004#2 = 1;
            |LEE 101#1004];
            |SI FSalida = 0;  |Y #1004#0 = #zhazcrea#0;  |Y  #1004#1 = #zhazcrea#1;
                nHay = 0;
            |FINSI;
            |CIERRA #1004;

            |SI nHay = 1;  aFichero = "zregcu04"; |HAZ Quadre04;  |FINSI;
        |FINSI;

        |SI aTipoMemoria = "A";
            nHay = 1;

            |ABRE #1018;
            #1018#0 = #zhazcrea#0;
            #1018#1 = #zhazcrea#1;
            #1018#2 = 1;
            |LEE 101#1018];
            |SI FSalida = 0;  |Y #1018#0 = #zhazcrea#0;  |Y  #1018#1 = #zhazcrea#1;
                nHay = 0;
            |FINSI;
            |CIERRA #1018;

            |SI nHay = 1;  aFichero = "zregcu18"; |HAZ Quadre18;  |FINSI;

            |SI #zhazcrea#15 = "A";
                nHay = 1;

                |ABRE #1016;
                #1016#0 = #zhazcrea#0;
                #1016#1 = #zhazcrea#1;
                #1016#2 = 1;
                |LEE 101#1016];
                |SI FSalida = 0;  |Y #1016#0 = #zhazcrea#0;  |Y  #1016#1 = #zhazcrea#1;
                    nHay = 0;
                |FINSI;
                |CIERRA #1016;

                |SI nHay = 1;  aFichero = "zregcu16"; |HAZ Quadre16;  |FINSI;
            |FINSI;
        |FINSI;
    |FINSI;

    |HAZ DesImagen_cuadr;
|FPRC;

|PROCESO Graba_zregcu01;
     #1001#0 = #zhazcrea#0;
     #1001#1 = #zhazcrea#1;
     |LEE 101#1001=;
     |SI FSalida ! 0;
         |DDEFECTO #1001;
         #1001#0 = #zhazcrea#0;
         #1001#1 = #zhazcrea#1;
         |GRABA 020#1001b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1001; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1001; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1001nCampo = #1001nCampo + nImporte;
     |SINO;
         #1001nCampo = #1001nCampo - nImporte;
     |FINSI;

     |GRABA 020#1001a;
     |LIBERA #1001;
|FPRC;

|PROCESO Graba_zregcu02;
     #1002#0 = #zhazcrea#0;
     #1002#1 = #zhazcrea#1;
     |LEE 101#1002=;
     |SI FSalida ! 0;
         |DDEFECTO #1002;
         #1002#0 = #zhazcrea#0;
         #1002#1 = #zhazcrea#1;
         |GRABA 020#1002b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1002; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1002; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1002nCampo = #1002nCampo + nImporte;
     |SINO;
         #1002nCampo = #1002nCampo - nImporte;
     |FINSI;

     #1002#8  = #1002#2  + #1002#4  + #1002#6;
     #1002#9  = #1002#3  + #1002#5  + #1002#7;
     #1002#16 = #1002#10 + #1002#12 + #1002#14;
     #1002#17 = #1002#11 + #1002#13 + #1002#15;
     #1002#24 = #1002#18 + #1002#20 + #1002#22;
     #1002#25 = #1002#19 + #1002#21 + #1002#23;

     #1002#40 = #1002#34 + #1002#36 + #1002#38;
     #1002#41 = #1002#35 + #1002#37 + #1002#39;
     #1002#48 = #1002#42 + #1002#44 + #1002#46;
     #1002#49 = #1002#43 + #1002#45 + #1002#47;
     #1002#56 = #1002#50 + #1002#52 + #1002#54;
     #1002#57 = #1002#51 + #1002#53 + #1002#55;

     |PARA nCampo4 = 26;  |SI nCampo4 [ 33;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 24;
           nCampo2   = nCampo4 - 16;
           nCampo3   = nCampo4 - 8;
           #1002nCampo4 = #1002nCampo1 + #1002nCampo2 + #1002nCampo3;
     |SIGUE;

     |PARA nCampo4 = 58;  |SI nCampo4 [ 65;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 24;
           nCampo2   = nCampo4 - 16;
           nCampo3   = nCampo4 - 8;
           #1002nCampo4 = #1002nCampo1 + #1002nCampo2 + #1002nCampo3;
     |SIGUE;

     |GRABA 020#1002a;
     |LIBERA #1002;
|FPRC;

|PROCESO Graba_zregcu03;
     #1003#0 = #zhazcrea#0;
     #1003#1 = #zhazcrea#1;
     |LEE 101#1003=;
     |SI FSalida ! 0;
         |DDEFECTO #1003;
         #1003#0 = #zhazcrea#0;
         #1003#1 = #zhazcrea#1;
         |GRABA 020#1003b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1003; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1003; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1003nCampo = #1003nCampo + nImporte;
     |SINO;
         #1003nCampo = #1003nCampo - nImporte;
     |FINSI;

     |PARA nCampo3 = 24;  |SI nCampo3 [ 34;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #1003nCampo3 = #1003nCampo1 + #1003nCampo2;
     |SIGUE;

     |PARA nCampo3 = 57;  |SI nCampo3 [ 67;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #1003nCampo3 = #1003nCampo1 + #1003nCampo2;
     |SIGUE;

     |GRABA 020#1003a;
     |LIBERA #1003;
|FPRC;

|PROCESO Graba_zregcu05;
     #1005#0 = #zhazcrea#0;
     #1005#1 = #zhazcrea#1;
     |LEE 101#1005=;
     |SI FSalida ! 0;
         |DDEFECTO #1005;
         #1005#0 = #zhazcrea#0;
         #1005#1 = #zhazcrea#1;
         |GRABA 020#1005b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1005; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1005; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1005nCampo = #1005nCampo + nImporte;
     |SINO;
         #1005nCampo = #1005nCampo - nImporte;
     |FINSI;

     #1005#8  = #1005#2  + #1005#4  + #1005#6;
     #1005#9  = #1005#3  + #1005#5  + #1005#7;
     #1005#16 = #1005#10 + #1005#12 + #1005#14;
     #1005#17 = #1005#11 + #1005#13 + #1005#15;
     #1005#32 = #1005#26 + #1005#28 + #1005#30;
     #1005#33 = #1005#27 + #1005#29 + #1005#31;
     #1005#40 = #1005#34 + #1005#36 + #1005#38;
     #1005#41 = #1005#35 + #1005#37 + #1005#39;

     |PARA nCampo3 = 18;  |SI nCampo3 [ 25;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1    = nCampo3 - 16;
           nCampo2    = nCampo3 - 8;
           #1005nCampo3 = #1005nCampo1 + #1005nCampo2;
     |SIGUE;

     |PARA nCampo3 = 42;  |SI nCampo3 [ 49;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1    = nCampo3 - 16;
           nCampo2    = nCampo3 - 8;
           #1005nCampo3 = #1005nCampo1 + #1005nCampo2;
     |SIGUE;

     |GRABA 020#1005a;
     |LIBERA #1005;
|FPRC;

|PROCESO Graba_zregcu07;
     #1007#0 = #zhazcrea#0;
     #1007#1 = #zhazcrea#1;
     |LEE 101#1007=;
     |SI FSalida ! 0;
         |DDEFECTO #1007;
         #1007#0 = #zhazcrea#0;
         #1007#1 = #zhazcrea#1;
         |GRABA 020#1007b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1007; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1007; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1007nCampo = #1007nCampo + nImporte;
     |SINO;
         #1007nCampo = #1007nCampo - nImporte;
     |FINSI;

     |GRABA 020#1007a;
     |LIBERA #1007;
|FPRC;

|PROCESO Graba_zregcu08;
     #1008#0 = #zhazcrea#0;
     #1008#1 = #zhazcrea#1;
     |LEE 101#1008=;
     |SI FSalida ! 0;
         |DDEFECTO #1008;
         #1008#0 = #zhazcrea#0;
         #1008#1 = #zhazcrea#1;
         |GRABA 020#1008b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1008; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1008; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1008nCampo = #1008nCampo + nImporte;
     |SINO;
         #1008nCampo = #1008nCampo - nImporte;
     |FINSI;

     #1008#02 = #1008#03 + #1008#04 + #1008#05;
     #1008#07 = #1008#08 + #1008#09 + #1008#10;
     #1008#16 = #1008#17 + #1008#18 + #1008#19;
     #1008#21 = #1008#22 + #1008#23 + #1008#24;

     #1008#34 = #1008#02 + #1008#06;
     #1008#35 = #1008#07 + #1008#11;
     #1008#36 = #1008#30 + #1008#31;
     #1008#37 = #1008#12 + #1008#13;
     #1008#38 = #1008#16 + #1008#20;
     #1008#39 = #1008#21 + #1008#25;
     #1008#40 = #1008#32 + #1008#33;
     #1008#41 = #1008#26 + #1008#27;

     |GRABA 020#1008a;
     |LIBERA #1008;
|FPRC;

|PROCESO Graba_zregcu09;
     #1009#0 = #zhazcrea#0;
     #1009#1 = #zhazcrea#1;
     |LEE 101#1009=;
     |SI FSalida ! 0;
         |DDEFECTO #1009;
         #1009#0 = #zhazcrea#0;
         #1009#1 = #zhazcrea#1;
         |GRABA 020#1009b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1009; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1009; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1009nCampo = #1009nCampo + nImporte;
     |SINO;
         #1009nCampo = #1009nCampo - nImporte;
     |FINSI;

     |GRABA 020#1009a;
     |LIBERA #1009;
|FPRC;

|PROCESO Graba_zregcu15;
     #1015#0 = #zhazcrea#0;
     #1015#1 = #zhazcrea#1;
     |LEE 101#1015=;
     |SI FSalida ! 0;
         |DDEFECTO #1015;
         #1015#0 = #zhazcrea#0;
         #1015#1 = #zhazcrea#1;
         |GRABA 020#1015b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1015; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1015; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1015nCampo = #1015nCampo + nImporte;
     |SINO;
         #1015nCampo = #1015nCampo - nImporte;
     |FINSI;

     #1015#4  = #1015#02 + #1015#03;
     #1015#6  = (#1015#02 * 100) / #1015#4;
     #1015#7  = 0;
     |SI #1015#3 ! 0;
         #1015#7  = 100 - #1015#6;
     |FINSI;
     #1015#8  = #1015#6 + #1015#7;

     #1015#11 = #1015#09 + #1015#10;
     #1015#13 = (#1015#09 * 100) / #1015#11;
     #1015#14 = 0;
     |SI #1015#10 ! 0;
         #1015#14 = 100 - #1015#13;
     |FINSI;
     #1015#15 = #1015#13 + #1015#14;

     |GRABA 020#1015a;
     |LIBERA #1015;
|FPRC;

|PROCESO Graba_zregcu17;
     #1017#0 = #zhazcrea#0;
     #1017#1 = #zhazcrea#1;
     |LEE 101#1017=;
     |SI FSalida ! 0;
         |DDEFECTO #1017;
         #1017#0 = #zhazcrea#0;
         #1017#1 = #zhazcrea#1;
         |GRABA 020#1017b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1017; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1017; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1017nCampo = #1017nCampo + nImporte;
     |SINO;
         #1017nCampo = #1017nCampo - nImporte;
     |FINSI;

     #1017#12 = #1017#2  + #1017#4  + #1017#6  + #1017#8  + #1017#10;
     #1017#13 = #1017#3  + #1017#5  + #1017#7  + #1017#9  + #1017#11;
     #1017#24 = #1017#14 + #1017#16 + #1017#18 + #1017#20 + #1017#22;
     #1017#25 = #1017#15 + #1017#17 + #1017#19 + #1017#21 + #1017#23;
     #1017#36 = #1017#26 + #1017#28 + #1017#30 + #1017#32 + #1017#34;
     #1017#37 = #1017#27 + #1017#29 + #1017#31 + #1017#33 + #1017#35;

     #1017#60 = #1017#50 + #1017#52 + #1017#54 + #1017#56 + #1017#58;
     #1017#61 = #1017#51 + #1017#53 + #1017#55 + #1017#57 + #1017#59;
     #1017#72 = #1017#62 + #1017#64 + #1017#66 + #1017#68 + #1017#70;
     #1017#73 = #1017#63 + #1017#65 + #1017#67 + #1017#69 + #1017#71;
     #1017#84 = #1017#74 + #1017#76 + #1017#78 + #1017#80 + #1017#82;
     #1017#85 = #1017#75 + #1017#77 + #1017#79 + #1017#81 + #1017#83;

     |PARA nCampo4 = 38;  |SI nCampo4 [ 49;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 36;
           nCampo2   = nCampo4 - 24;
           nCampo3   = nCampo4 - 12;
           #1017nCampo4 = #1017nCampo1 + #1017nCampo2 + #1017nCampo3;
     |SIGUE;

     |PARA nCampo4 = 86;  |SI nCampo4 [ 97;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 36;
           nCampo2   = nCampo4 - 24;
           nCampo3   = nCampo4 - 12;
           #1017nCampo4 = #1017nCampo1 + #1017nCampo2 + #1017nCampo3;
     |SIGUE;

     |GRABA 020#1017a;
     |LIBERA #1017;
|FPRC;

|PROCESO Graba_zregcu19;
     #1019#0 = #zhazcrea#0;
     #1019#1 = #zhazcrea#1;
     |LEE 101#1019=;
     |SI FSalida ! 0;
         |DDEFECTO #1019;
         #1019#0 = #zhazcrea#0;
         #1019#1 = #zhazcrea#1;
         |GRABA 020#1019b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1019; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1019; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1019nCampo = #1019nCampo + nImporte;
     |SINO;
         #1019nCampo = #1019nCampo - nImporte;
     |FINSI;

     #1019#8  = #1019#2  + #1019#4  + #1019#6;
     #1019#9  = #1019#3  + #1019#5  + #1019#7;
     #1019#16 = #1019#10 + #1019#12 + #1019#14;
     #1019#17 = #1019#11 + #1019#13 + #1019#15;
     #1019#24 = #1019#18 + #1019#20 + #1019#22;
     #1019#25 = #1019#19 + #1019#21 + #1019#23;

     #1019#40 = #1019#34 + #1019#36 + #1019#38;
     #1019#41 = #1019#35 + #1019#37 + #1019#39;
     #1019#48 = #1019#42 + #1019#44 + #1019#46;
     #1019#49 = #1019#43 + #1019#45 + #1019#47;
     #1019#56 = #1019#50 + #1019#52 + #1019#54;
     #1019#57 = #1019#51 + #1019#53 + #1019#55;

     |PARA nCampo4 = 26;  |SI nCampo4 [ 33;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1    = nCampo4 - 24;
           nCampo2    = nCampo4 - 16;
           nCampo3    = nCampo4 - 8;
           #1019nCampo4 = #1019nCampo1 + #1019nCampo2 + #1019nCampo3;
     |SIGUE;

     |PARA nCampo4 = 58;  |SI nCampo4 [ 65;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1    = nCampo4 - 24;
           nCampo2    = nCampo4 - 16;
           nCampo3    = nCampo4 - 8;
           #1019nCampo4 = #1019nCampo1 + #1019nCampo2 + #1019nCampo3;
     |SIGUE;

     |GRABA 020#1019a;
     |LIBERA #1019;
|FPRC;

|PROCESO Graba_zregcu20;
     #1020#0 = #zhazcrea#0;
     #1020#1 = #zhazcrea#1;
     |LEE 101#1020=;
     |SI FSalida ! 0;
         |DDEFECTO #1020;
         #1020#0 = #zhazcrea#0;
         #1020#1 = #zhazcrea#1;
         |GRABA 020#1020b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1020; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1020; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1020nCampo = #1020nCampo + nImporte;
     |SINO;
         #1020nCampo = #1020nCampo - nImporte;
     |FINSI;

     #1020#03 = #1020#04 + #1020#05 + #1020#06;
     #1020#02 = #1020#03 + #1020#07;
     #1020#24 = #1020#25 + #1020#26 + #1020#27;
     #1020#23 = #1020#24 + #1020#28;

     #1020#09 = #1020#10 + #1020#11 + #1020#12;
     #1020#08 = #1020#09 + #1020#13;
     #1020#30 = #1020#31 + #1020#32 + #1020#33;
     #1020#29 = #1020#30 + #1020#34;

     #1020#14 = #1020#15 + #1020#16 + #1020#17;
     #1020#35 = #1020#36 + #1020#37 + #1020#38;

     #1020#18 = #1020#19 + #1020#20;
     #1020#39 = #1020#40 + #1020#41;

     |GRABA 020#1020a;
     |LIBERA #1020;
|FPRC;

|PROCESO Graba_zregcu21;
     #1021#0 = #zhazcrea#0;
     #1021#1 = #zhazcrea#1;
     |LEE 101#1021=;
     |SI FSalida ! 0;
         |DDEFECTO #1021;
         #1021#0 = #zhazcrea#0;
         #1021#1 = #zhazcrea#1;
         |GRABA 020#1021b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1021; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1021; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1021nCampo = #1021nCampo + nImporte;
     |SINO;
         #1021nCampo = #1021nCampo - nImporte;
     |FINSI;

     |GRABA 020#1021a;
     |LIBERA #1021;
|FPRC;

|PROCESO Graba_zregcu24;
     #1024#0 = #zhazcrea#0;
     #1024#1 = #zhazcrea#1;
     |LEE 101#1024=;
     |SI FSalida ! 0;
         |DDEFECTO #1024;
         #1024#0 = #zhazcrea#0;
         #1024#1 = #zhazcrea#1;
         |GRABA 020#1024b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1024; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1024; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1024nCampo = #1024nCampo + nImporte;
     |SINO;
         #1024nCampo = #1024nCampo - nImporte;
     |FINSI;

     |GRABA 020#1024a;
     |LIBERA #1024;
|FPRC;

|PROCESO Graba_zregcu25;
     #1025#0 = #zhazcrea#0;
     #1025#1 = #zhazcrea#1;
     |LEE 101#1025=;
     |SI FSalida ! 0;
         |DDEFECTO #1025;
         #1025#0 = #zhazcrea#0;
         #1025#1 = #zhazcrea#1;
         |GRABA 020#1025b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1025; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1025; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1025nCampo = #1025nCampo + nImporte;
     |SINO;
         #1025nCampo = #1025nCampo - nImporte;
     |FINSI;

     |GRABA 020#1025a;
     |LIBERA #1025;
|FPRC;

|PROCESO Graba_zregcu26;
     #1026#0 = #zhazcrea#0;
     #1026#1 = #zhazcrea#1;
     |LEE 101#1026=;
     |SI FSalida ! 0;
         |DDEFECTO #1026;
         #1026#0 = #zhazcrea#0;
         #1026#1 = #zhazcrea#1;
         |GRABA 020#1026b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1026; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1026; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1026nCampo = #1026nCampo + nImporte;
     |SINO;
         #1026nCampo = #1026nCampo - nImporte;
     |FINSI;

     |GRABA 020#1026a;
     |LIBERA #1026;
|FPRC;

|PROCESO Graba_zregcu28;
     #1028#0 = #zhazcrea#0;
     #1028#1 = #zhazcrea#1;
     |LEE 101#1028=;
     |SI FSalida ! 0;
         |DDEFECTO #1028;
         #1028#0 = #zhazcrea#0;
         #1028#1 = #zhazcrea#1;
         |GRABA 020#1028b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #1028; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #1028; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #1028nCampo = #1028nCampo + nImporte;
     |SINO;
         #1028nCampo = #1028nCampo - nImporte;
     |FINSI;

     |GRABA 020#1028a;
     |LIBERA #1028;
|FPRC;

|PROCESO sodacoli;

                       nImporte = 0;
     |SI aTipo = "I";  nImporte = #55#5;  |FINSI;
     |SI aTipo = "F";  nImporte = #55#8;  |FINSI;
     |SI aTipo = "D";  nImporte = #55#6;  |FINSI;
     |SI aTipo = "H";  nImporte = #55#7;  |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI nCuadro = 1;   |HAZ Graba_zregcu01;   |FINSI;
     |SI nCuadro = 2;   |HAZ Graba_zregcu02;   |FINSI;
     |SI nCuadro = 3;   |HAZ Graba_zregcu02;   |FINSI;
     |SI nCuadro = 4;   |HAZ Graba_zregcu03;   |FINSI;
     |SI nCuadro = 5;   |HAZ Graba_zregcu03;   |FINSI;
     |SI nCuadro = 8;   |HAZ Graba_zregcu05;   |FINSI;
     |SI nCuadro = 9;   |HAZ Graba_zregcu05;   |FINSI;
     |SI nCuadro = 11;  |HAZ Graba_zregcu07;   |FINSI;
     |SI nCuadro = 12;  |HAZ Graba_zregcu08;   |FINSI;
     |SI nCuadro = 13;  |HAZ Graba_zregcu09;   |FINSI;
     |SI nCuadro = 19;  |HAZ Graba_zregcu15;   |FINSI;
     |SI nCuadro = 20;  |HAZ Graba_zregcu17;   |FINSI;
     |SI nCuadro = 21;  |HAZ Graba_zregcu17;   |FINSI;
     |SI nCuadro = 22;  |HAZ Graba_zregcu19;   |FINSI;
     |SI nCuadro = 23;  |HAZ Graba_zregcu19;   |FINSI;
     |SI nCuadro = 26;  |HAZ Graba_zregcu20;   |FINSI;
     |SI nCuadro = 27;  |HAZ Graba_zregcu21;   |FINSI;
     |SI nCuadro = 28;  |HAZ Graba_zregcu24;   |FINSI;
     |SI nCuadro = 29;  |HAZ Graba_zregcu25;   |FINSI;
     |SI nCuadro = 30;  |HAZ Graba_zregcu26;   |FINSI;
     |SI nCuadro = 32;  |HAZ Graba_zregcu28;   |FINSI;

     |SI nCuadro = 33;
         |SI aSigno = "+";
             nNume1 = nNume1 + nImporte;
         |SINO;
             nNume1 = nNume1 - nImporte;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE sodacoli;
     #55#2;
     ;
     #zhazcrea#0, nEjer, aCuentaD;
     #zhazcrea#0, nEjer, aCuentaH;
     ;
     NULL, sodacoli;
|FIN;

|PROCESO CalculosCuadro29;
     nCta40I  = 0;
     nCta41I  = 0;
     nCta407I = 0;
     nCta4I   = 0;
     nCta40F  = 0;
     nCta41F  = 0;
     nCta407F = 0;
     nCta4F   = 0;
     nCta4    = 0;
     nCta6    = 0;
     aCondi   = " ";

     aCuentaD = "40          ";
     aCuentaH = "40zzzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta40I = nNume1;

     aCuentaD = "41          ";
     aCuentaH = "41zzzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta41I = nNume1;

     aCuentaD = "407         ";
     aCuentaH = "407zzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta407I = nNume1;

     aCuentaD = "40          ";
     aCuentaH = "40zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta40F = nNume1;

     aCuentaD = "41          ";
     aCuentaH = "41zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta41F = nNume1;

     aCuentaD = "407         ";
     aCuentaH = "407zzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta407F = nNume1;

     nCta4I   = (nCta40I + nCta41I - nCta407I) ! 2;
     nCta4F   = (nCta40F + nCta41F - nCta407F) ! 2;
     nCta4    = ((nCta4I + nCta4F) / 2) ! 2;

     aCuentaD = "60          ";
     aCuentaH = "60zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "+";
     nNume1   = 0;  |BUCLE sodacoli; nCta6 = nNume1;
     aCuentaD = "62          ";
     aCuentaH = "62zzzzzzzzzz";
     nNume1   = 0;  |BUCLE sodacoli; nCta6 = nCta6 + nNume1;

     nImporte = 0;
     |SI nCta4 ! 0; |Y nCta6 ! 0;
         nImporte = ((nCta4 / nCta6) * 365) ! 2;
     |FINSI;
     #zregcu29#nCampo# = nImporte;
|FPRC;

|PROCESO PaseZregcu29;
     |ABRE #1029;
     #1029#0 = #zhazcrea#0;
     #1029#1 = #zhazcrea#1;
     |LEE 101#1029=;
     |SI FSalida ! 0;
         |DDEFECTO #1029;
         #1029#0 = #zhazcrea#0;
         #1029#1 = #zhazcrea#1;
         |GRABA 020#1029b;
     |FINSI;

     nCuadro  = 33;
     nCampo   = 2;
     nEjer    = #zhazcrea#1;
     |HAZ CalculosCuadro29;

     |SI nSwPaseAnt = 0; |Y #zhazcrea#1 ! 2015;
         nCampo = 3;
         nEjer  = #zhazcrea#1 - 1;
         |HAZ CalculosCuadro29;
     |FINSI;

     |GRABA 020#1029a;
     |LIBERA #1029;
     |CIERRA #1029;
|FPRC;

|PROCESO elAuxiliar;
    #55#9 = 0;
    #55#5 = 0;
    #55#6 = #999#1;
    #55#7 = #999#2;
    #55#8 = #55#6 - #55#7;

    |SI nCuadro = 13;  |HAZ Graba_zregcu09;  |FINSI;
    |SI nCuadro = 27;  |HAZ Graba_zregcu21;  |FINSI;
|FPRC;

|DEFBUCLE elAuxiliar;
     #999#1;
     ;
     nEjer, aCuentaD;
     nEjer, aCuentaH;
     ;
     NULL, elAuxiliar;
|FIN;

|PROCESO zpcuadro;
     aCuenta = #5#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #5#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #5#2;
     nCasilla = #5#3;
     aTipo    = #5#5;
     aSigno   = #5#6;
     aCondi   = #5#8;

     |SI nCuadro = 19; |Y #0#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI nCuadro = 13;  |O nCuadro = 27;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zpcuadro;
     #5#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zpcuadro;
|FIN;

|PROCESO zocuadro;
     aCuenta = #6#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #6#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #6#2;
     nCasilla = #6#3;
     aTipo    = #6#5;
     aSigno   = #6#6;
     aCondi   = #6#8;

     |SI nCuadro = 19; |Y #0#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI #6#2 = 13;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zocuadro;
     #6#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zocuadro;
|FIN;

|PROCESO zqcuadro;
     aCuenta = #7#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #7#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #7#2;
     nCasilla = #7#3;
     aTipo    = #7#5;
     aSigno   = #7#6;
     aCondi   = #7#8;

     |SI nCuadro = 19; |Y #0#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI nCuadro = 13;  |O nCuadro = 27;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zqcuadro;
     #7#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zqcuadro;
|FIN;


|PROCESO cuadros_c;
     nSw = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE zqcuadro_c;
     #7#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|DEFBUCLE zocuadro_c;
     #6#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|DEFBUCLE zpcuadro_c;
     #5#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|PROCESO Grabaw3;
     |DDEFECTO #999;
     #999#0 = aCuenta;
     #999#5 = any;
     |LEE 101#999=;
     |SI FSalida ! 0;
         #999#0 = aCuenta;
         #999#5 = any;
         |GRABA 020#999b;
     |FINSI;

     |SI aSigno = "D";
         #999#1 = #999#1 + nImporte;
     |SINO;
         #999#2 = #999#2 + nImporte;
     |FINSI;
     |GRABA 020#999a;
     |LIBERA #999;
|FPRC;

|PROCESO reparto_lin;
 aAlfa1 = #432#2; |QBF aAlfa1;
 |SI aAlfa1 ! "";
     aCuenta  = #432#2;
     aSigno   = #431#8;
     nImporte = #432#4;
     |HAZ Grabaw3;
 |FINSI;
|FPRC;

|DEFBUCLE reparto_lin;
     #432#1;
     ;
     #431#9, #431#10, #431#0, 01;
     #431#9, #431#10, #431#0, 99;
     e;
     NULL, reparto_lin;
|FIN;

|PROCESO reparto;
    aAlfa1 = #431#2; |QBF aAlfa1;
    |SI aAlfa1 ! "";
        aCuenta  = #431#2;
        nImporte = #431#4;
        aSigno   = #431#8;
        |HAZ Grabaw3;
    |SINO;
        |BUCLE reparto_lin;
    |FINSI;
|FPRC;

|DEFBUCLE reparto;
     #431#1;
     ;
     #zhazcrea#0, any, "            ";
     #zhazcrea#0, any, "zzzzzzzzzzzz";
     e;
     NULL, reparto;
|FIN;

|PROCESO zregcu04P;
     |BORRA 020#1004a;
     |LIBERA #1004;
|FPRC;

|DEFBUCLE zregcu04P;
     #1004#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu04P;
|FIN;

|PROCESO zregcu16P;
     |BORRA 020#1016a;
     |LIBERA #1016;
|FPRC;

|DEFBUCLE zregcu16P;
     #1016#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu16P;
|FIN;

|PROCESO zregcu18P;
     |BORRA 020#1018a;
     |LIBERA #1018;
|FPRC;

|DEFBUCLE zregcu18P;
     #1018#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu18P;
|FIN;

|PROCESO zregcu22P;
     |BORRA 020#1022a;
     |LIBERA #1022;
|FPRC;

|DEFBUCLE zregcu22P;
     #1022#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu22P;
|FIN;

|PROCESO zregcu30P;
     |BORRA 020#zregcu30.a;
     |LIBERA #zregcu30;
|FPRC;

|DEFBUCLE zregcu30P;
     #zregcu30#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu30P;
|FIN;

|PROCESO PaseCuadros;
     nSw = 0;
     nEjerCuadro = #zhazcrea#1;
     |SI #zhazcrea#15 = "P"; |Y nEjerCuadro > enUltMemP; nSw = 1; nEjerCuadro = enUltMemP; |FINSI;
     |SI #zhazcrea#15 = "A"; |Y nEjerCuadro > enUltMemA; nSw = 1; nEjerCuadro = enUltMemA; |FINSI;
     |SI #zhazcrea#15 = "C"; |Y nEjerCuadro > enUltMemC; nSw = 1; nEjerCuadro = enUltMemC; |FINSI;

     aAlfa = "0000SEsta seguro de pasar los datos a los cuadros automaticos.";
     |SI nSw = 1;
         aAlfa = "0000NEsta seguro de pasar los datos a los cuadros con la configuracion del a¤o anterior.";
     |FINSI;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nSw = 0;
     |SI #zhazcrea#15 = "P"; |BUCLE zpcuadro_c; |FINSI;
     |SI #zhazcrea#15 = "A"; |BUCLE zocuadro_c; |FINSI;
     |SI #zhazcrea#15 = "C"; |BUCLE zqcuadro_c; |FINSI;
     |SI nSw = 0;
         |MENAV "0000No Existe Planilla para pasar los datos a Cuadros";
         |ACABA;
     |FINSI;

     nSwPaseAnt = 0;
     |SI #0#0 ] 2009;
         nNume1 = #0#0 - 1;
         aAlfa1 = nNume1;
         aAlfa1 = "0000S¨Quiere recoger los datos A¤o Anterior de las CCAA del Ejercicio " + aAlfa1 + " ?";
         |CONFI aAlfa1;
         |SI FSalida = 0; nSwPaseAnt = 1; |FINSI;
     |FINSI;

     |HAZ VentanaTrabajo;

     |ABRE #1001;  #1001#0  = #zhazcrea#0;  #1001#1  = #zhazcrea#1;  |BORRA 000#1001c;   |LIBERA #1001;   |CIERRA #1001;
     |ABRE #1002;  #1002#0  = #zhazcrea#0;  #1002#1  = #zhazcrea#1;  |BORRA 000#1002c;   |LIBERA #1002;   |CIERRA #1002;
     |ABRE #1003;  #1003#0  = #zhazcrea#0;  #1003#1  = #zhazcrea#1;  |BORRA 000#1003c;   |LIBERA #1003;   |CIERRA #1003;
     |ABRE #1005;  #1005#0  = #zhazcrea#0;  #1005#1  = #zhazcrea#1;  |BORRA 000#1005c;   |LIBERA #1005;   |CIERRA #1005;
     |ABRE #1007;  #1007#0  = #zhazcrea#0;  #1007#1  = #zhazcrea#1;  |BORRA 000#1007c;   |LIBERA #1007;   |CIERRA #1007;
     |ABRE #1008;  #1008#0  = #zhazcrea#0;  #1008#1  = #zhazcrea#1;  |BORRA 000#1008c;   |LIBERA #1008;   |CIERRA #1008;
     |ABRE #1009;  #1009#0  = #zhazcrea#0;  #1009#1  = #zhazcrea#1;  |BORRA 000#1009c;   |LIBERA #1009;   |CIERRA #1009;
     |ABRE #1015;  #1015#0  = #zhazcrea#0;  #1015#1  = #zhazcrea#1;  |BORRA 000#1015c;   |LIBERA #1015;   |CIERRA #1015;
     |ABRE #1017;  #1017#0  = #zhazcrea#0;  #1017#1  = #zhazcrea#1;  |BORRA 000#1017c;   |LIBERA #1017;   |CIERRA #1017;
     |ABRE #1019;  #1019#0  = #zhazcrea#0;  #1019#1  = #zhazcrea#1;  |BORRA 000#1019c;   |LIBERA #1019;   |CIERRA #1019;
     |ABRE #1020;  #1020#0  = #zhazcrea#0;  #1020#1  = #zhazcrea#1;  |BORRA 000#1020c;   |LIBERA #1020;   |CIERRA #1020;
     |ABRE #1021;  #1021#0  = #zhazcrea#0;  #1021#1  = #zhazcrea#1;  |BORRA 000#1021c;   |LIBERA #1021;   |CIERRA #1021;
     |ABRE #1024;  #1024#0  = #zhazcrea#0;  #1024#1  = #zhazcrea#1;  |BORRA 000#1024c;   |LIBERA #1024;   |CIERRA #1024;
     |ABRE #1025;  #1025#0  = #zhazcrea#0;  #1025#1  = #zhazcrea#1;  |BORRA 000#1025c;   |LIBERA #1025;   |CIERRA #1025;
     |ABRE #1026;  #1026#0  = #zhazcrea#0;  #1026#1  = #zhazcrea#1;  |BORRA 000#1026c;   |LIBERA #1026;   |CIERRA #1026;
     |ABRE #1028;  #1028#0  = #zhazcrea#0;  #1028#1  = #zhazcrea#1;  |BORRA 000#1028c;   |LIBERA #1028;   |CIERRA #1028;
     |ABRE #1029;  #1029#0  = #zhazcrea#0;  #1029#1  = #zhazcrea#1;  |BORRA 000#1029c;   |LIBERA #1028;   |CIERRA #1029;
     |ABRE #zregcu31;  #zregcu31#0  = #zhazcrea#0;  #zregcu31#1  = #zhazcrea#1;  |BORRA 000#zregcu31.c;   |LIBERA #zregcu31;   |CIERRA #zregcu31;
     |ABRE #zregcu32;  #zregcu32#0  = #zhazcrea#0;  #zregcu32#1  = #zhazcrea#1;  |BORRA 000#zregcu32.c;   |LIBERA #zregcu32;   |CIERRA #zregcu32;
     |ABRE #zregcu33;  #zregcu33#0  = #zhazcrea#0;  #zregcu33#1  = #zhazcrea#1;  |BORRA 000#zregcu33.c;   |LIBERA #zregcu33;   |CIERRA #zregcu33;

     |SI nSwPaseAnt = 1;
         |BUCLE zregcu04P;
         |BUCLE zregcu16P;
         |BUCLE zregcu18P;
         |BUCLE zregcu22P;
         |BUCLE zregcu30P;
     |FINSI;

     aFichero = "8m" + Usuario;
     |NOME_DAT #999 aFichero;
     |DELINDEX #999;
     |ABRE #999;
     any = #zhazcrea#1;     |BUCLE reparto;
     any = #zhazcrea#1 - 1; |BUCLE reparto;
     |CIERRA #999;

     |SI #zhazcrea#15 = "P";
         |ABRE #1001;
         |ABRE #1002;
         |ABRE #1003;
         |ABRE #1005;
         |ABRE #1007;
         |ABRE #1008;
         |ABRE #1009;
         |ABRE #1015;
         |ABRE #1024;
         |ABRE #1028;

         |BUCLE zpcuadro;

         |CIERRA #1001;
         |CIERRA #1002;
         |CIERRA #1003;
         |CIERRA #1005;
         |CIERRA #1007;
         |CIERRA #1008;
         |CIERRA #1009;
         |CIERRA #1015;
         |CIERRA #1024;
         |CIERRA #1028;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #1001;
         |ABRE #1017;
         |ABRE #1003;
         |ABRE #1019;
         |ABRE #1007;
         |ABRE #1020;
         |ABRE #1021;
         |ABRE #1015;
         |ABRE #1024;
         |ABRE #1028;

         |BUCLE zocuadro;

         |CIERRA #1001;
         |CIERRA #1017;
         |CIERRA #1003;
         |CIERRA #1019;
         |CIERRA #1007;
         |CIERRA #1020;
         |CIERRA #1021;
         |CIERRA #1015;
         |CIERRA #1024;
         |CIERRA #1028;
     |FINSI;

     |SI #zhazcrea#15 = "C";
         |ABRE #1001;
         |ABRE #1002;
         |ABRE #1003;
         |ABRE #1005;
         |ABRE #1007;
         |ABRE #1008;
         |ABRE #1009;
         |ABRE #1015;
         |ABRE #1024;
         |ABRE #1025;
         |ABRE #1026;
         |ABRE #1028;

         |BUCLE zqcuadro;

         |CIERRA #1001;
         |CIERRA #1002;
         |CIERRA #1003;
         |CIERRA #1005;
         |CIERRA #1007;
         |CIERRA #1008;
         |CIERRA #1009;
         |CIERRA #1015;
         |CIERRA #1024;
         |CIERRA #1025;
         |CIERRA #1026;
         |CIERRA #1028;
     |FINSI;

     |DELINDEX #999;

     |HAZ PaseAnterior;

     |SI #0#0 ] 2015;
         |HAZ PaseZregcu29;
         ||  ....  Pase Cuadro Nuevo
     |FINSI;

     |HAZ FinVentanaTrabajo;

     |MENAV "0000Pase a cuadro realizado.";

     |PULSATECLA;
|FPRC;
