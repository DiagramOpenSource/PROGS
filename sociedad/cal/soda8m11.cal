|FICHEROS;
   soda8m11 #0,MANTE;    || cuentas
   soda8m12 #12,MANTE;   ||Varias lineas

   sodacoli #1;
   sodacoca #2;

   soda8z03 #10;
   maacceso #31;

  :/agicont/def/ca8ctrle #400;  ||Control Empresa
  :/agicont/def/ca8comay #401;  ||Control Cuentas de mayor
  :/agicont/def/ca8m0010 #430;  ||Tabla de Conf.Cierre
  :/agicont/def/canempre #30;

  sodacoli@ #3;
   agiconpa #4;     || control pases (basica)
   sodacuen #8;
|FIN;

|VARIABLES;
   &entrada = 1;
   nSalir   = 0;
   nModo    = 0;
   cinco    = "     ";
   aCta1    = "";
   aCta2    = "";
   cta      = "     ";
   ctanum   = 0;
   ctaalf   = "";
   longalf  = "";
   longnum  = "";
   nada     = "";
   aAlfa1   = "";
   aAlfa2   = "";
   nNume1   = 0;
   nInkey   = 0;

   mesdes = "";
   meshas = "";

   nYaExiste = 0;
   aMas      = "";
   aDef      = "";
   nSw       = 0;
   xx        = 0;
   nOper     = 0;
   aCuenta   = "";
   aAntes    = "";
|FIN;

|INCLUYE varcon_i;
|INCLUYE varbal_i;

|PROCESO Tipo5; |TIPO 5;
  FSalida = "SINBARRA";
|FPRC;

||  ***************************************
|PROCESO BorroLineas;
  #0#4 = #0#4 - #12#4; |PINTA #0#4;
  |SI nOper = 0;
      |BORRA 020#12a;
  |SINO;
       #12#4 = 0;
       |GRABA 020#12a;
  |FINSI;
  |LIBERA #12;
|FPRC;

|DEFBUCLE BorroLineas;
 #12#1;
 ;
 #0#9, #0#10, #0#0, 01;
 #0#9, #0#10, #0#0, 99;
 be;
 NULL, BorroLineas;
|FIN;

|CALCULO Tipo1; |TIPO 1;
 nModo = (FEntrada / 100) ! 0;
 |SI nModo = 3;
     nOper = 0;
     |BUCLE BorroLineas;
 |FINSI;
|FCAL;

|PROCESO inf0;
 #1#0 = #0#9;
 #1#1 = #0#10;
 #1#3 = "8          ";
|FPRC;

|PROCESO sup0;
 #1#0 = #0#9;
 #1#1 = #0#10;
 #1#3 = "9zzzzzzzzzzz";
|FPRC;

|PROCESO inf430;
 #430#5 = enEjerBal;
 #430#0 = eNum2008;
 #430#1 = "           ";
|FPRC;

|PROCESO sup430;
 #430#5 = enEjerBal;
 #430#0 = eNum2008;
 #430#1 = "zzzzzzzzzzzz";
|FPRC;

|PROCESO inf12;
 #12#7 = #0#9;
 #12#8 = #0#10;
 #12#0 = #0#0;
 #12#1 = 01;
|FPRC;

|PROCESO sup12;
 #12#7 = #0#9;
 #12#8 = #0#10;
 #12#0 = #0#0;
 #12#1 = 99;
|FPRC;

|CALCULO tipo7; |TIPO 7;
 |ENTLINEAL #1#12, -4, 7, 22, 0, inf12, sup12;
|FCAL;

|CALCULO Tipo11; |TIPO 11;
 nInkey = FSalida;
 |SI nInkey = 10;
     |ABRE #1;
     #1#3 = #0#0;
     |CONSULTA_F_CLAVE #2#1, inf0, sup0;
     #0#0 = #1#3; |PINTA #0#0;
     #0#1 = #1#4; |PINTA #0#1;
     |CIERRA #1;
     |ERROR;
     |ACABA;
 |FINSI;

 |HAZ LeoCuenta;
|FCAL;

|CALCULO cuefin; |TIPO 0;
   nInkey = FSalida;

   |C_M #0Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |SI nInkey = 10;
     |ABRE #1;
     #1#3 = #0#0;
     |CONSULTA_F_CLAVE #2#1, inf0, sup0;
     #0#0 = #1#3; |PINTA #0#0;
     #0#1 = #1#4; |PINTA #0#1;
     |CIERRA #1;
   |FINSI;

   |SI nInkey = 11; |Y Campo = 2;
       |ABRE #430;
       #430#5 = enEjerBal;
       #430#0 = eNum2008;
       #430#1 = #0#0;
       |CONSULTA_F_CLAVE #1#430, inf430, sup430;
       |CIERRA #430;
       |ERROR;
       |ACABA;
   |FINSI;

   eaCuenta = #0Campo; |QBF eaCuenta;

   |SI Campo = 0;
       aAlfa1 = eaCuenta % 101;
       |SI aAlfa1 ! "8"; |Y aAlfa1 ! "9";
           |MENAV "    Error. No ha introducido una cuenta del Grupo 8 o 9";
           |ERROR;
           |ACABA;
       |FINSI;
   |FINSI;

   |SI Campo = 2;
       |SI eaCuenta = ""; |O nInkey = 12;
           #0Campo = ""; |PINTA #0#2;
           #0#3    = ""; |PINTA #0#3;
           |SI aAntes ! doce;
               #0#4  = 0; |PINTA #0#4;
           |FINSI;
           nSalir = 1;
           |PARA; |SI nSalir = 1; |HACIENDO;
                  |ENTLINEAL #1#12, -2, 2, 22, 0, inf12, sup12;
                  nSalir = 0;
                  |SI #0#7 ! #0#4;
                      |CONFI "    NReparto no Correcto. Salir ";
                      |SI FSalida ! 0; nSalir = 1; |FINSI;
                 |FINSI;
           |SIGUE;
           |ACABA;
       |FINSI;
   |FINSI;

   |HAZ LeoCuenta;
   |SI Campo = 0; |Y eswCta = 1;
       |MENAV "    Atencion. No existe cuenta en el Balance de la Empresa";
       |ERROR;
       |ACABA;
   |FINSI;

   |SI Campo = 0;
       eaCuenta = #0#0;
       |HAZ aContra8y9;
       |SI eSwT8y9 = 1;
           |MENAV "    Atencion, cuenta no definida en Cierre del P.Neto";
       |FINSI;
   |FINSI;

   |SI Campo = 2;
       aAlfa1 = eaRaiz89; |QBF aAlfa1;
       |SI aAlfa1 ! "";
           aAlfa2 = aAlfa1 % 0;
           nNume1 = aAlfa2;
           nNume1 = 100 + nNume1;
           aAlfa2 = #0Campo % nNume1;
           |SI aAlfa2 ! aAlfa1;
               |MENAV "    Atencion. No corresponde definicion de Cierre del P.Neto";
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;
  |FINSI;

   |SI aAntes = doce; |Y Campo = 2;
       #0#4 = #0#7; |PINTA #0#4;
       nOper = 1;
       |BUCLE BorroLineas;
       #0#4 = #0#7; |PINTA #0#4;
   |FINSI;

   nModo = (FEntrada / 100) ! 0;
   |SI nModo = 1; |Y  Campo = 0;
       #0#2 = eaCon8y9;
       #0#3 = eaTit8y9;
       #0#6 = enNivel;
       |SI #1#8 ] 0;
            #0#7 = #1#8;
            #0#8 = "D";
       |SINO;
            #0#7 = -#1#8;
            #0#8 = "H";
       |FINSI;
       aCuenta = #0#2; |QBF aCuenta;
       |SI aCuenta ! "";
            #0#4 = #0#7;  || Todo Repartido
       |FINSI;
   |FINSI;
   aAntes = #0#2;
|FCAL;

|CALCULO cuenta_l; |TIPO 6;
   |C_M #12Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;
|FCAL;

|CALCULO cuefin_l; |TIPO 0;
   nInkey = FSalida;
   |C_M #12Campo, 0, aAlfa1;
   |SI aAlfa1 = "N"; |ACABA; |FINSI;

   |SI nInkey = 10;
     |ABRE #1;
     #1#3 = #12Campo;
     |CONSULTA_F_CLAVE #2#1, inf0, sup0;
     #12#0 = #1#3; |PINTA #12#0;
     #12#1 = #1#4; |PINTA #12#1;
     |CIERRA #1;
   |FINSI;
|FCAL;

|CALCULO Tipo66; |TIPO 66;
|FCAL;

|CALCULO Tipo2_l; |TIPO 2;
 #0#4 = #0#4 +. #12#4;
 |PINTA #0#4;
|FCAL;

|CALCULO Tipo0_l; |TIPO 0;
 nInkey = FSalida;
 |SI nInkey = 11;
     #12#4 = #0#7 - #0#4;
     |PINTA #12#4;
     |ERROR;
 |FINSI;
|FCAL;

|PROCESO LeoCuenta;

 nNume1  = Campo + 1;
 enPlan = 2008;

 |ABRE #8;
 #8#2 = enPlan;
 #8#0 = #0Campo;
 |LEE 001#8=;
 |SI FSalida = 0;
     #0nNume1= #8#1; |PINTA #0nNume1;
 |SINO;
     #8#0 = enPlan;
     #8#0 = #0Campo;
     |GRABA 020#8n;
 |FINSI;
 |CIERRA #8;

 eswCta = 0;
 |ABRE #1;
 |SELECT #2#1;
 #1#0 = #0#9;
 #1#1 = #0#10;
 #1#3 = #0#0;
 |LEE 001#1=;
 |SI FSalida ! 0;
     eswCta = 1;
 |SINO;
     #0nNume1= #1#4; |PINTA #0nNume1;
 |FINSI;
 |CIERRA #1;
|FPRC;
