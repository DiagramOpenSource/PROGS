|FICHEROS;
     isom9000;
     maempr01;
     isocie00;

     :agicli/agim0019;
     :agicli/agifigen;

     isow9103;                    || Registro emision 2018 H1
     isow9102;                    || Registro emision 2017 H2
|FIN;

|INCLUYE 9001vari;

|PROCESO FormaPago2018;
     |SI #isom9000#36 = "2";  |O #isom9000#36 = "3";
         |SI #isom9000#37 = "1";
             |ABRE #isocie00;
             |PARA nAnyoI = #isom9000#1 - 1;  |SI;  |HACIENDO nAnyoI = nAnyoI - 1;
                   |SI nAnyoI [ 2007;  |SAL;  |FINSI;

                   |DDEFECTO #isocie00;
                   #isocie00#0 = #isom9000#0;
                   #isocie00#1 = nAnyoI;
                   |LEE 000#isocie00.=;
                   |SI FSalida = 0;
                       |SI #isocie00#5 ! "0000000000";  |Y #isocie00#5 ! "          ";
                           #isow9102#41 = #isocie00#7;
                       |FINSI;
                       |SAL;
                   |FINSI;
             |SIGUE;
             |CIERRA #isocie00;
         |FINSI;

         aAlfa = #isow9102#41; |QBF aAlfa;
         |SI #isom9000#37 = "2";  |O aAlfa = "";
             |ABRE #agifigen;
             #agifigen#0 = #isom9000#0;
             |LEE 040#agifigen.=;
             |SI FSalida ! 0;  |DDEFECTO #agifigen;  |FINSI;
             |CIERRA #agifigen;

             #isow9102#41 = #agifigen#94;
         |FINSI;
     |FINSI;

                               #isow9103#6 = "I";
     |SI #isom9000#36 = "3";   #isow9103#6 = "U";  |FINSI;
     |SI #isom9000#36 = "4";   #isow9103#6 = "G";  |FINSI;
|FPRC;

|PROCESO P90012018_2P;
     |ABRE #agim0019;
     #agim0019#0 = #isom9000#0;
     #agim0019#1 = 99;
     |LEE 000#agim0019.];
     |SI FSalida = 0;
         |LEE 000#agim0019.a;
     |SINO;
         |LEE 000#agim0019.u;
     |FINSI;
     |CIERRA #agim0019;

     aCNAE = "";
     |SI FSalida = 0;  |Y #agim0019#0 = #isom9000#0;
         aCNAE = #agim0019#40;
     |FINSI;

     |ABRE #maempr01;
     #maempr01#0 = #isom9000#0;
     #maempr01#1 = #isom9000#1;
     |LEE 000#maempr01.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr01;  |FINSI;
     |CIERRA #maempr01;

     |DDEFECTO #isow9103;
     |DDEFECTO #isow9102;

     #isow9103#7  = #isom9000#4;
     #isow9103#8  = #isom9000#5;
     #isow9103#10 = #isom9000#1;
     #isow9103#11 = #isom9000#2;
     #isow9103#12 = (#isom9000#7 % 102) + (#isom9000#7 % 402) + (#isom9000#7 % 704);
     #isow9103#13 = aCNAE;

     |SI #isom9000#60 = "S";  #isow9103#14 = "X";  |FINSI;
     |SI #isom9000#61 = "S";  #isow9103#15 = "X";  |FINSI;
     |SI #isom9000#53 = "S";  #isow9103#16 = "X";  |FINSI;
     |SI #isom9000#39 = "S";  #isow9103#17 = "X";  |FINSI;
     |SI #isom9000#40 = "S";  #isow9103#18 = "X";  |FINSI;
     |SI #isom9000#85 = "S";  #isow9103#48 = "X";  |FINSI;

                              #isow9103#19 = "0";
     |SI #isom9000#41 = "S";  #isow9103#19 = "1";  |FINSI;
     |SI #isom9000#42 = "S";  #isow9103#19 = "2";  |FINSI;

     #isow9103#20 = #isom9000#43;
     #isow9103#21 = #isom9000#38;

     |SI #isom9000#75 = "S";  #isow9103#22 = "X";  |FINSI;

     enCanti = #isom9000#10;  |HAZ Calcula17D;  #isow9103#23 = eaAlfa;
     enCanti = #isom9000#13;  |HAZ Calcula17D;  #isow9103#24 = eaAlfa;
     enCanti = #isom9000#14;  |HAZ Calcula17D;  #isow9103#25 = eaAlfa;

     enCanti = #isom9000#15;  |HAZ Calcula17D;  #isow9103#26 = eaAlfa;
     enCanti = #isom9000#45;  |HAZ Calcula17D;  #isow9103#27 = eaAlfa;
     enCanti = #isom9000#46;  |HAZ Calcula17D;  #isow9103#28 = eaAlfa;
     enCanti = #isom9000#55;  |HAZ Calcula17D;  #isow9103#29 = eaAlfa;
     enCanti = #isom9000#47;  |HAZ Calcula17D;  #isow9103#30 = eaAlfa;
     enCanti = #isom9000#48;  |HAZ Calcula17D;  #isow9103#31 = eaAlfa;
     enCanti = #isom9000#56;  |HAZ Calcula17D;  #isow9103#32 = eaAlfa;
     enCanti = #isom9000#57;  |HAZ Calcula17D;  #isow9103#33 = eaAlfa;

     enCanti = #isom9000#50;  |HAZ Calcula17D;  #isow9103#34 = eaAlfa;
     enCanti = #isom9000#64;  |HAZ Calcula17D;  #isow9103#35 = eaAlfa;
     enCanti = #isom9000#17;  |HAZ Calcula17D;  #isow9103#36 = eaAlfa;
     enCanti = #isom9000#65;  |HAZ Calcula17D;  #isow9103#37 = eaAlfa;
     enCanti = #isom9000#66;  |HAZ Calcula17D;  #isow9103#38 = eaAlfa;
     enCanti = #isom9000#18;  |HAZ Calcula17D;  #isow9103#39 = eaAlfa;
     enCanti = #isom9000#19 * 100;              #isow9103#40 = ("00000" + enCanti) % -105;
     enCanti = #isom9000#67;  |HAZ Calcula17D;  #isow9103#41 = eaAlfa;
     enCanti = #isom9000#58;  |HAZ Calcula17D;  #isow9103#42 = eaAlfa;
     enCanti = #isom9000#68;  |HAZ Calcula17D;  #isow9103#43 = eaAlfa;
     enCanti = #isom9000#69;  |HAZ Calcula17D;  #isow9103#44 = eaAlfa;
     enCanti = #isom9000#20;  |HAZ Calcula17D;  #isow9103#45 = eaAlfa;

     #isow9103#46 = "";
     |SI #isom9000#6 = "A ";
         |SI #isom9000#14 [ 0;
             #isow9103#46 = "A";
         |FINSI;
     |SINO;
         |SI #isom9000#34 [ 0;
             #isow9103#46 = "B";
         |FINSI;
     |FINSI;

     #isow9103#47 = #isom9000#86;

     |SI #isow9103#47 > "1";
         #isow9103#11 = "0A";
     |FINSI;

     enCanti = #isom9000#21;  |HAZ Calcula17D;  #isow9102#6  = eaAlfa;
     enCanti = #isom9000#22;  |HAZ Calcula17D;  #isow9102#7  = eaAlfa;
     enCanti = #isom9000#23 * 100;              #isow9102#8  = ("00000" + enCanti) % -105;
     enCanti = #isom9000#24;  |HAZ Calcula17D;  #isow9102#9  = eaAlfa;
     enCanti = #isom9000#25;  |HAZ Calcula17D;  #isow9102#10 = eaAlfa;
     enCanti = #isom9000#26 * 100;              #isow9102#11 = ("00000" + enCanti) % -105;
     enCanti = #isom9000#27;  |HAZ Calcula17D;  #isow9102#12 = eaAlfa;
     enCanti = #isom9000#70;  |HAZ Calcula17D;  #isow9102#13 = eaAlfa;
     enCanti = #isom9000#59;  |HAZ Calcula17D;  #isow9102#14 = eaAlfa;
     enCanti = #isom9000#71;  |HAZ Calcula17D;  #isow9102#15 = eaAlfa;
     enCanti = #isom9000#72;  |HAZ Calcula17D;  #isow9102#16 = eaAlfa;
     enCanti = #isom9000#28;  |HAZ Calcula17D;  #isow9102#17 = eaAlfa;
     enCanti = #isom9000#29;  |HAZ Calcula17D;  #isow9102#18 = eaAlfa;
     enCanti = #isom9000#30;  |HAZ Calcula17D;  #isow9102#19 = eaAlfa;
                                                #isow9102#20 = "00000";
     |SI #isom9000#6 ! "A ";
         enCanti = #isom9000#31 * 100;          #isow9102#20 = ("00000" + enCanti) % -105;
     |FINSI;

     enCanti = #isom9000#33;  |HAZ Calcula17D;  #isow9102#21 = eaAlfa;
     enCanti = #isom9000#32;  |HAZ Calcula17D;  #isow9102#22 = eaAlfa;
     enCanti = #isom9000#51;  |HAZ Calcula17D;  #isow9102#23 = eaAlfa;
     enCanti = #isom9000#52;  |HAZ Calcula17D;  #isow9102#24 = eaAlfa;
     enCanti = #isom9000#34;  |HAZ Calcula17D;  #isow9102#25 = eaAlfa;

     nTotal  = #isom9000#14 + #isom9000#34;
     #isow9102#26 = "";
     #isow9102#27 = "";

     enCanti = #isom9000#73;  |HAZ Calcula17D;  #isow9102#28 = eaAlfa;
     enCanti = #isom9000#74;  |HAZ Calcula17D;  #isow9102#29 = eaAlfa;
     enCanti = #isom9000#76;  |HAZ Calcula17D;  #isow9102#30 = eaAlfa;
     enCanti = #isom9000#77;  |HAZ Calcula17D;  #isow9102#31 = eaAlfa;
     enCanti = #isom9000#78;  |HAZ Calcula17D;  #isow9102#32 = eaAlfa;
     enCanti = #isom9000#79;  |HAZ Calcula17D;  #isow9102#33 = eaAlfa;
     enCanti = #isom9000#80;  |HAZ Calcula17D;  #isow9102#34 = eaAlfa;
     enCanti = #isom9000#81;  |HAZ Calcula17D;  #isow9102#35 = eaAlfa;
     enCanti = #isom9000#82;  |HAZ Calcula17D;  #isow9102#36 = eaAlfa;
     enCanti = #isom9000#83;  |HAZ Calcula17D;  #isow9102#37 = eaAlfa;
     enCanti = #isom9000#84;  |HAZ Calcula17D;  #isow9102#38 = eaAlfa;

     #isow9102#39= "";
     |SI #isom9000#3 > 0;
         #isow9102#39 = "X";
         #isow9102#40 = #isom9000#35;
     |FINSI;

     #isow9103#6  = "N";
     |SI nTotal > 0;
         |HAZ FormaPago2018;
     |FINSI;

     #isow9103#49 = "";
     |SI #isom9000#1 = 2020;
         |SI #isom9000#2 = "1P"; ||  |O #isom9000#2 = "2P";
             #isow9103#49 = #isom9000#87;
         |FINSI;
     |FINSI;

     aPer = #isom9000#2;
     |SI #isow9103#47 > "1";
         aPer = "0A";
     |FINSI;

     eaAlfa = "<T2020" + #isom9000#1 + aPer + "0000>";  |HAZ GrabaSecuencial;
     eaAlfa = "<AUX>";       |HAZ GrabaSecuencial;
     eaAlfa = " " * 70;      |HAZ GrabaSecuencial;
     eaAlfa = "1.00";        |HAZ GrabaSecuencial;
     eaAlfa = "    ";        |HAZ GrabaSecuencial;
     eaAlfa = "B53179768";   |HAZ GrabaSecuencial;
     eaAlfa = " " * 213;     |HAZ GrabaSecuencial;
     eaAlfa = "</AUX>";      |HAZ GrabaSecuencial;

     nTCmp = 51;
     |PARA nCampo = 1;  |SI nCampo [ nTCmp;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isow9103#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 1;  |SI nCampo [ 44;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isow9102#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = "</T2020" + #isom9000#1 + aPer + "0000>";  |HAZ GrabaSecuencial;
     eaAlfa = &13 + &10;  |HAZ GrabaSecuencial;
|FPRC;
