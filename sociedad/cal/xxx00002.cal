|FICHEROS;
    xxx00002 #0;
    xxx00004 #1;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &nombre    = "";
    &modo      = 0;

    FEstado = 0;
    varcamp = 0;
    x       = 0;
    tecla_p = "";
    avance  = "815";
    atras   = "814";
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0  = empresa;
#0#39 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#39 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0  = empresa;
    #0#39 = anyo;
    #0#1  = nombre;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |CIERRA #0;
    |HAZ contable;
|FINSI;
|FPRC;

|PROCESO consulta;
  avance = &255 + avance;
  atras = &255 + atras;
  #0#0 = empresa;
  #0#39 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
  |PINPA #0#0;
  |PINDA #0#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla_p;
  |SI tecla_p = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
  |PINPA #1#0;
  |PINDA #1#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla_p;
  |SI tecla_p = atras;  |HAZ pantalla1; |ACABA; |FINSI;
|FPRC;

|PROCESO existen;|TIPO 0;
#0#5 = #0#2 + #0#3 + #0#4;
#0#8 = #0#6 + #0#7;
#0#15 = #0#5  + #0#8  + #0#9  + #0#10 + #0#11;
#0#15 = #0#15 + #0#12 + #0#13 + #0#14;
#0#18 = #0#15 + #0#16 + #0#17;
#0#22 = #0#19 + #0#20 + #0#21;
#0#29 = #0#24 + #0#25 + #0#26 + #0#27 + #0#28;
#0#35 = #0#22 + #0#23 + #0#29 + #0#30 + #0#31;
#0#35 = #0#35 + #0#32 + #0#33 + #0#34;
#0#38 = #0#35 + #0#36 + #0#37;

|PINTA #0#5;
|PINTA #0#8;
|PINTA #0#15;
|PINTA #0#18;
|PINTA #0#22;
|PINTA #0#29;
|PINTA #0#35;
|PINTA #0#38;
|FPRC;

|PROCESO contable;
|ABRE #1;
#1#0 = #0#0;
#1#36 = #0#39;
|LIBERA #1;
|LEE 140#1=;
FEstado = FSalida;

#1#1 = #0#1;
#1#2 = #0#18 - #0#38;
|SI FEstado = 0; |GRABA 140#1a; |SINO; |GRABA 140#1n; |FINSI;
|CIERRA #1;
|FPRC;
