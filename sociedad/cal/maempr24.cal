|FICHEROS;
    maempr24;

     :/agicli/def/agim0016;
     :/agicli/def/agim0003;
     :/agicli/def/agicontr;
|FIN;

|VARIABLES;
     &empresa   = 0;
     &anyo      = 0;
     &modo      = 0;

     SwError    = 0;
     nSalir     = 0;
     aAlfa      = "";
     aAlfa1     = "";
     nModo      = 0;
     nCampo     = 0;
     nNume1     = 0;
     aPath      = "";

     &enCalcCif = 0;
     &eaVarDni  = "";
     &eaCodPais = "";
     &eaCodNif  = "";
     &eswNif    = 0;
|FIN;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempr24#Campo#;
         |HAZ CalculoDNI;
         #maempr24#Campo# = eaVarDni;
         |PINTA #maempr24#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #maempr24#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempr24#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempr24#Campo# = eaVarDni;  |PINTA #maempr24#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeePaism24; |TIPO 6;
     |ABRE #agim0016;
     #agim0016#0 = #maempr24#Campo#;
     |LEE 041#agim0016.=;
     |SI FSalida = 0;
         nCampo = Campo + 1;
         #maempr24#nCampo# = #agim0016#1; |PINTA #maempr24#nCampo#;
     |FINSI;
     |CIERRA #agim0016;
|FPRC;


|PROCESO Tipo0C3; |TIPO 0;
/*
     SwError = 0;
     |SI #maempr24#4 = "F"; |Y #maempr24#3 = 1;
         SwError = 1;
     |FINSI;
     |SI #maempr24#4 = "J"; |Y #maempr24#3 ! 1;
         SwError = 1;
     |FINSI;
     |SI SwError = 1;
         |MENAV "0000Revise si es correcto el Nivel introducido";
     |FINSI;
*/
|FPRC;

|PROCESO PonDatos;
     aAlfa1 = Contenido;
     nModo  = (FEntrada / 100) ! 0;
     aAlfa  = #maempr24#6; |QBF aAlfa;

     |SI nModo = 1; |O aAlfa = ""; |O aAlfa1 ! #maempr24#3;

         |ABRE #agim0003;
         #agim0003#0  = #maempr24#3;
         |LEE 040#agim0003.=;
         |SI FSalida = 0;
             #maempr24#5 = #agim0003#1; |PINTA #maempr24#5;
         |FINSI;
         |CIERRA #agim0003;

         #maempr24#6  = #agim0003#1;  |PINTA #maempr24#6;

         aAlfa  = #agim0003#2; |QBF aAlfa;
         aAlfa1 = #agim0003#3; |QBF aAlfa1;
         |SI aAlfa1 ! "";
             |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
             aAlfa = aAlfa + aAlfa1;
         |FINSI;
         aAlfa1 = #agim0003#6; |QBF aAlfa1;
         |SI aAlfa1 ! ""; aAlfa = aAlfa + " " + aAlfa1; |FINSI;
         aAlfa1 = #agim0003#7; |QBF aAlfa1;
         |SI aAlfa1 ! ""; aAlfa = aAlfa + " (" + aAlfa1 + ")"; |FINSI;
         #maempr24#7 = aAlfa; |PINTA #maempr24#7;

         aAlfa = #maempr24#5 % 101; aAlfa = aAlfa > " ";
         |SI aAlfa < "0"; |O aAlfa > "9";
             |SI aAlfa ! "X"; |Y aAlfa ! "Y"; |Y aAlfa ! "Z";
                 #maempr24#4 = "J";
             |FINSI;
         |FINSI;
         |PINTA #maempr24#4;
         |PINTA #maempr24#3;
     |FINSI;
|FPRC;

|PROCESO inferior;
     #maempr24#0 = empresa;
     #maempr24#1 = anyo;
     #maempr24#2 = 01;
|FPRC;

|PROCESO superior;
     #maempr24#0 = empresa;
     #maempr24#1 = anyo;
     #maempr24#2 = 99;
|FPRC;

|PROGRAMA;
     |DBASS aPath; |QBF aPath;
     |PATH_DAT #agicontr#aAlfa#;

     |ABRE #agicontr;
     |DDEFECTO #agicontr;
     |LEE 040#agicontr.p;
     |CIERRA #agicontr;
     aAlfa = #agicontr#8;  |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "*";
         aAlfa = aPath + "agicli/fich/";
     |FINSI;
     aPath = aAlfa;
     |PATH_DAT #agim0016#aPath#;
     |PATH_DAT #agim0003#aPath#;

     |PINPA #0#maempr24;
     |SI modo = 4;
         |ENTLINEAL #1#maempr24, -3, 4, 21, 0, inferior, superior;
     |SINO;
         |ENTLINEAL #1#maempr24, -3, 2, 21, 0, inferior, superior;
     |FINSI;
|FPRO;
