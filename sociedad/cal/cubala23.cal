|FICHEROS;
     cubala23 #0;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &nombre  = "";
     &nif     = "";
     &tipo    = "";
     &unid    = "";
     &modo    = 0;
     &sw_mod  = 0;

     anyo1    = 0;
     anyo2    = 0;
     x        = 0;
     tecla    = "";
     ntecla   = 0;
     avance   = "815";
     atras    = "814";
     FEstado  = 0;
     nCampo   = 0;
|FIN;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************

|PROCESO pintaany; |TIPO 13;
     anyo2 = anyo - 1;
     anyo1 = anyo;
     |PINTA 963, anyo1;
     |PINTA 975, anyo2;
|FPRC;

|PROCESO totales; |TIPO 0;
     |SI tipo = "E";
         #0#9   = #0#10  + #0#11  + #0#12  + #0#13;
         #0#14  = #0#15  + #0#16  + #0#17;
         #0#21  = #0#22  + #0#23  + #0#24;
         #0#26  = #0#27  + #0#28  + #0#29  + #0#30;
         #0#33  = #0#34  + #0#35  + #0#36  + #0#37;
         #0#39  = #0#40  + #0#41  + #0#42;
         #0#43  = #0#44  + #0#45  + #0#46;
         #0#47  = #0#48  + #0#49  + #0#50;
         #0#53  = #0#54  + #0#55  + #0#56  + #0#57  + #0#58;
         #0#59  = #0#60  + #0#61;
         #0#62  = #0#63  + #0#64  + #0#65;
         #0#66  = #0#67  + #0#68  + #0#69;
         #0#70  = #0#71  + #0#72  + #0#73  + #0#74  + #0#75;

         #0#6   = #0#7   + #0#8   + #0#9   + #0#14  + #0#18  + #0#19  + #0#20;
         #0#31  = #0#32  + #0#33  + #0#38  + #0#39  + #0#43  + #0#47;
         #0#51  = #0#52  + #0#53  + #0#59  + #0#62  + #0#66  + #0#70  + #0#76  + #0#77;

         #0#82  = #0#83  + #0#84  + #0#85  + #0#86;
         #0#87  = #0#88  + #0#89  + #0#90;
         #0#94  = #0#95  + #0#96  + #0#97;
         #0#99  = #0#100 + #0#101 + #0#102 + #0#103;
         #0#106 = #0#107 + #0#108 + #0#109 + #0#110;
         #0#112 = #0#113 + #0#114 + #0#115;
         #0#116 = #0#117 + #0#118 + #0#119;
         #0#120 = #0#121 + #0#122 + #0#123;
         #0#126 = #0#127 + #0#128 + #0#129 + #0#130 + #0#131;
         #0#132 = #0#133 + #0#134;
         #0#135 = #0#136 + #0#137 + #0#138;
         #0#139 = #0#140 + #0#141 + #0#142;
         #0#143 = #0#144 + #0#145 + #0#146 + #0#147 + #0#148;

         #0#79  = #0#80  + #0#81  + #0#82  + #0#87  + #0#91  + #0#92  + #0#93;
         #0#104 = #0#105 + #0#106 + #0#111 + #0#112 + #0#116 + #0#120;
         #0#124 = #0#125 + #0#126 + #0#132 + #0#135 + #0#139 + #0#143 + #0#149 + #0#150;
     |SINO;
         #0#9   = #0#10  + #0#11  + #0#13;
         #0#6   = #0#7   + #0#8   + #0#9   + #0#14  + #0#18  + #0#19  + #0#20;
         #0#31  = #0#32  + #0#42  + #0#45;
         #0#51  = #0#52  + #0#65  + #0#73;

         #0#82  = #0#83  + #0#84  + #0#86;
         #0#79  = #0#80  + #0#81  + #0#82  + #0#87  + #0#91  + #0#92  + #0#93;
         #0#104 = #0#105 + #0#115 + #0#118;
         #0#124 = #0#125 + #0#138 + #0#146;
     |FINSI;

     #0#78  = #0#6   + #0#21  + #0#25  + #0#26  + #0#31  + #0#51;
     #0#151 = #0#79  + #0#94  + #0#98  + #0#99  + #0#104 + #0#124;

     |PINTA #0#6;
     |PINTA #0#9;
     |PINTA #0#14;
     |PINTA #0#21;
     |PINTA #0#26;
     |PINTA #0#31;
     |PINTA #0#33;
     |PINTA #0#39;
     |PINTA #0#43;
     |PINTA #0#47;
     |PINTA #0#51;
     |PINTA #0#53;
     |PINTA #0#59;
     |PINTA #0#62;
     |PINTA #0#66;
     |PINTA #0#70;
     |PINTA #0#78;

     |PINTA #0#79;
     |PINTA #0#82;
     |PINTA #0#87;
     |PINTA #0#94;
     |PINTA #0#99;
     |PINTA #0#104;
     |PINTA #0#106;
     |PINTA #0#112;
     |PINTA #0#116;
     |PINTA #0#120;
     |PINTA #0#124;
     |PINTA #0#126;
     |PINTA #0#132;
     |PINTA #0#135;
     |PINTA #0#139;
     |PINTA #0#143;
     |PINTA #0#151;
|FPRC;

|PROCESO nomoaant;
     |PARA nCampo = 6;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
           |C_M #0nCampo,1, "N";
     |SIGUE;
|FPRC;

|PROCESO nomoabre;
     |SI sw_mod = 0;
         |C_M #0#9,   1, "N";
         |C_M #0#12,  1, "N";
         |C_M #0#15,  1, "N";
         |C_M #0#16,  1, "N";
         |C_M #0#17,  1, "N";
         |C_M #0#22,  1, "N";
         |C_M #0#23,  1, "N";
         |C_M #0#24,  1, "N";
         |C_M #0#27,  1, "N";
         |C_M #0#28,  1, "N";
         |C_M #0#29,  1, "N";
         |C_M #0#30,  1, "N";
         |C_M #0#33,  1, "N";
         |C_M #0#34,  1, "N";
         |C_M #0#35,  1, "N";
         |C_M #0#36,  1, "N";
         |C_M #0#37,  1, "N";
         |C_M #0#38,  1, "N";
         |C_M #0#39,  1, "N";
         |C_M #0#40,  1, "N";
         |C_M #0#41,  1, "N";
         |C_M #0#43,  1, "N";
         |C_M #0#44,  1, "N";
         |C_M #0#46,  1, "N";
         |C_M #0#47,  1, "N";
         |C_M #0#48,  1, "N";
         |C_M #0#49,  1, "N";
         |C_M #0#50,  1, "N";
         |C_M #0#53,  1, "N";
         |C_M #0#54,  1, "N";
         |C_M #0#55,  1, "N";
         |C_M #0#56,  1, "N";
         |C_M #0#57,  1, "N";
         |C_M #0#58,  1, "N";
         |C_M #0#59,  1, "N";
         |C_M #0#60,  1, "N";
         |C_M #0#61,  1, "N";
         |C_M #0#62,  1, "N";
         |C_M #0#63,  1, "N";
         |C_M #0#64,  1, "N";
         |C_M #0#66,  1, "N";
         |C_M #0#67,  1, "N";
         |C_M #0#68,  1, "N";
         |C_M #0#69,  1, "N";
         |C_M #0#70,  1, "N";
         |C_M #0#71,  1, "N";
         |C_M #0#72,  1, "N";
         |C_M #0#74,  1, "N";
         |C_M #0#75,  1, "N";
         |C_M #0#76,  1, "N";
         |C_M #0#77,  1, "N";
     |FINSI;

     |C_M #0#82,  1, "N";
     |C_M #0#85,  1, "N";
     |C_M #0#88,  1, "N";
     |C_M #0#89,  1, "N";
     |C_M #0#90,  1, "N";
     |C_M #0#95,  1, "N";
     |C_M #0#96,  1, "N";
     |C_M #0#97,  1, "N";
     |C_M #0#100, 1, "N";
     |C_M #0#101, 1, "N";
     |C_M #0#102, 1, "N";
     |C_M #0#103, 1, "N";
     |C_M #0#106, 1, "N";
     |C_M #0#107, 1, "N";
     |C_M #0#108, 1, "N";
     |C_M #0#109, 1, "N";
     |C_M #0#110, 1, "N";
     |C_M #0#111, 1, "N";
     |C_M #0#112, 1, "N";
     |C_M #0#113, 1, "N";
     |C_M #0#114, 1, "N";
     |C_M #0#116, 1, "N";
     |C_M #0#117, 1, "N";
     |C_M #0#119, 1, "N";
     |C_M #0#120, 1, "N";
     |C_M #0#121, 1, "N";
     |C_M #0#122, 1, "N";
     |C_M #0#123, 1, "N";
     |C_M #0#126, 1, "N";
     |C_M #0#127, 1, "N";
     |C_M #0#128, 1, "N";
     |C_M #0#129, 1, "N";
     |C_M #0#130, 1, "N";
     |C_M #0#131, 1, "N";
     |C_M #0#132, 1, "N";
     |C_M #0#133, 1, "N";
     |C_M #0#134, 1, "N";
     |C_M #0#135, 1, "N";
     |C_M #0#136, 1, "N";
     |C_M #0#137, 1, "N";
     |C_M #0#139, 1, "N";
     |C_M #0#140, 1, "N";
     |C_M #0#141, 1, "N";
     |C_M #0#142, 1, "N";
     |C_M #0#143, 1, "N";
     |C_M #0#144, 1, "N";
     |C_M #0#145, 1, "N";
     |C_M #0#147, 1, "N";
     |C_M #0#148, 1, "N";
     |C_M #0#149, 1, "N";
     |C_M #0#150, 1, "N";
|FPRC;

|PROCESO nomoexte;
     |SI sw_mod = 0;
         |C_M #0#9,  1, "N";
         |C_M #0#14, 1, "N";
         |C_M #0#21, 1, "N";
         |C_M #0#26, 1, "N";
         |C_M #0#33, 1, "N";
         |C_M #0#39, 1, "N";
         |C_M #0#43, 1, "N";
         |C_M #0#47, 1, "N";
         |C_M #0#53, 1, "N";
         |C_M #0#59, 1, "N";
         |C_M #0#62, 1, "N";
         |C_M #0#66, 1, "N";
         |C_M #0#70, 1, "N";
     |FINSI;

     |C_M #0#82,  1, "N";
     |C_M #0#87,  1, "N";
     |C_M #0#94,  1, "N";
     |C_M #0#99,  1, "N";
     |C_M #0#106, 1, "N";
     |C_M #0#112, 1, "N";
     |C_M #0#116, 1, "N";
     |C_M #0#120, 1, "N";
     |C_M #0#126, 1, "N";
     |C_M #0#132, 1, "N";
     |C_M #0#135, 1, "N";
     |C_M #0#139, 1, "N";
     |C_M #0#143, 1, "N";
|FPRC;

|PROCESO nomodi;
     |SI sw_mod = 1;   |HAZ nomoaant; |FINSI;
     |SI tipo   = "A"; |HAZ nomoabre; |FINSI;
     |SI tipo   = "E"; |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO pidedato;
     #0#0 = empresa;
     #0#1 = anyo;
     |LEE 110#0=;
     FEstado = FSalida;
     |SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
     |PINDA #0#0;
     |SI modo = 1; |HAZ nomodi; |ENDATOS #1#0; |FINSI;
     |SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;
     |SI FSalida = 0;
         #0#0 = empresa;
         #0#1 = anyo;
         #0#2 = nombre;
         #0#3 = nif;
         #0#4 = unid;
         #0#5 = tipo;
         |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO pantalla1;
     |PINPA #0#0;
     |PINDA #0#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
     |PINPA #1#0;
     |PINDA #1#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
     |PINPA #2#0;
     |PINDA #2#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
     |PINPA #3#0;
     |PINDA #3#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
     |PINPA #4#0;
     |PINDA #4#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla6;
     |PINPA #5#0;
     |PINDA #5#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla5; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla7; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla7;
     |PINPA #6#0;
     |PINDA #6#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
     avance = &255 + avance;
     atras  = &255 + atras;
     #0#0   = empresa;
     #0#1   = anyo;
     |LEE 040#0=;
     |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |PINPA #0#0;
     |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
     |SI modo = 4; |HAZ consulta; |FINSI;
     |CIERRA #0;
|FPRO;
