|FICHEROS;
     maempr10 #200;

     isom0001 #101;
     isom0007 #107;
     isom0008 #108;
     isom0009 #109;
     isom0010 #110;
     isom0011 #111;
     isom0012 #112;

     :/agicli/def/agicontr #300;
     :/agicli/def/agim0019 #319;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aIPRemoto      = "";
     aCadena        = "";
     aLen           = "";
     aCaracter      = "";

     nLen           = 0;
     nNume          = 0;
     nPos           = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;

     &enCanti       = 0;
     &enHandle      = 0;
     &eaAlfa         = "";
     &eaEfectivo     = "";
     &eaAdeudo       = "";
     &eaEntidad      = "";
     &eaOficina      = "";
     &eaDC           = "";
     &eaCuenta       = "";
     &eaNomEnt       = "";
     &eaNomOfi       = "";
     &enModelo       = 0;
     &enAnyo         = 0;
     &enBanco        = 0;
     &enFormaPag     = 0;
     &enForzar       = 0;
     &enError        = 0;
     &eaCasilla      = "";
|FIN;

|PROCESO QuitaRaros;
     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;
|FPRC;

|PROCESO Calcula3E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula2E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula5E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00000" + aAlfa1) % -105) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula3E4D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
|FPRC;

|PROCESO Calcula17D;
     enCanti = enCanti * 100;
     enCanti = enCanti ! 0;

     |SI enCanti ] 0;
         aAlfa = enCanti;
         eaAlfa = ("00000000000000000" + aAlfa) % -117;
     |SINO;
         enCanti  = -enCanti;
         aAlfa   = enCanti;
         eaAlfa   = "N" + (("0000000000000000" + aAlfa) % -116);
     |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO OtrasAplica;
     |DBASS aAlfa; |QBF aAlfa;
     |PATH_DAT #300 aAlfa;
     |ABRE #300;
     |LEE 040#300p;
     |SI FSalida ! 0;
         #300#8  = aAlfa + "agicli/fich/";
     |FINSI;
     |CIERRA #300;

     aAlfa = #300#8;  |QBF aAlfa;
     |SI aAlfa = "";
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "agicli/fich/";
     |FINSI;

     |PATH_DAT #319 aAlfa;
|FPRC;

|PROCESO LeeFich101;
     |ABRE #101;
     |SELECT #2#101;
     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#3 = eaCasilla;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;
|FPRC;

|PROCESO LeeFich107;
     |ABRE #107;
     |SELECT #2#107;
     #107#0 = #200#0;
     #107#1 = #200#1;
     #107#4 = eaCasilla;
     |LEE 000#107=;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;
|FPRC;

|PROCESO LeeFich108;
     |ABRE #108;
     |SELECT #1#108;
     #108#0 = #200#0;
     #108#1 = #200#1;
     #108#2 = eaCasilla;
     |LEE 000#108=;
     |SI FSalida ! 0;  |DDEFECTO #108;  |FINSI;
     |CIERRA #108;
|FPRC;

|PROCESO LeeFich109;
     |ABRE #109;
     |SELECT #2#109;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#5 = eaCasilla;
     |LEE 000#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;
     |CIERRA #109;
|FPRC;

|PROCESO LeeFich110;
     |ABRE #110;
     |SELECT #2#110;
     #110#0 = #200#0;
     #110#1 = #200#1;
     #110#5 = eaCasilla;
     |LEE 000#110=;
     |SI FSalida ! 0;  |DDEFECTO #110;  |FINSI;
     |CIERRA #110;
|FPRC;

|PROCESO LeeFich111;
     |ABRE #111;
     |SELECT #2#111;
     #111#0 = #200#0;
     #111#1 = #200#1;
     #111#4 = eaCasilla;
     |LEE 000#111=;
     |SI FSalida ! 0;  |DDEFECTO #111;  |FINSI;
     |CIERRA #111;
|FPRC;

|PROCESO LeeFich112;
     |ABRE #112;
     |SELECT #2#112;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#4 = eaCasilla;
     |LEE 000#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;
     |CIERRA #112;
|FPRC;
