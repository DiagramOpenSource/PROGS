|FICHEROS;
     maacceso #1;
     agicontr #6;
     agim0028 #7;

     cuacceso #102;
     maempr10 #103;
     meempme1 #104;
     mem10amb #113;
     :/agicli/def/agim0135 #109;
     :/agicli/def/agim0035 #135;
     megwordl #105;

     cubala02 #202;
     cubala03 #203;
     cubala04 #204;
     cubala05 #205;
     agim0019 #319;
     agim0038 #338;
     agim0039 #339;
     agim0040 #340;
     agim0041 #341;
     agim0042 #342;
     agim0043 #343;
     agim0044 #344;
     agim0045 #345;
     agim0046 #346;

     zhazdepo #99;
     mew00009 #98;
     meempmem #100;
     maempr01 #106;
|FIN;

|VARIABLES;
     &eaImporte  = "";
     aFichero    = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aAlfa5      = "";
     aAlfa6      = "";
     aAlfa7      = "";
     aAlfa8      = "";
     aCampo2     = "";
     aCampo3     = "";
     aCampo4     = "";
     aCampo5     = "";
     aCampo6     = "";
     aCampo7     = "";
     aCampo8     = "";
     aCampo9     = "";
     aCampo10    = "";
     aCampo11    = "";
     aCampo14    = "";
     aCampo15    = "";
     aAutoReturn = "";
     aCadena     = "";
     aDirec      = "";

     aDirEmpresa  = "";
     aDirDeposito = "";
     aBase        = "";
     aAbre        = "";
     aVariable    = "";
     aPrefijo     = "";
     aTelefono    = "";
     aCaracter    = "";
     aLong        = "";
     aClave       = "";
     aPonChmod    = "";
     aChmod       = "";
     aVersion     = "";
     aPathDocu    = "";
     aOrigen      = "";
     aDestino     = "";
     aIPRemoto    = "";
     aAsigna      = "";
     aIdenti      = "";
     aDirWord     = "";
     aDocRemoto   = "";
     aDocServidor = "";

     aBalanceAbreviado  = "";
     aBalanceExtenso    = "";
     aCuentasAbreviadas = "";
     aCuentasExtensas   = "";
     aNombreFirmante    = "";

     nWord        = 0;
     nPosicion    = 0;
     nModoPos     = 0;
     nVersion     = 0;
     nSwVersion   = 0;
     nHandle      = 0;
     nHandle1     = 0;
     nHandle2     = 0;
     nHandle3     = 0;
     nConta       = 0;
     nCampo       = 0;
     nCampo1      = 0;
     nCampo2      = 0;
     nPos         = 0;
     nReturn      = 0;
     nImporteAct  = 0;
     nImportePas  = 0;
     nSw339       = 0;
     nSw340       = 0;
     nSw341       = 0;
     nSw342       = 0;
     nSw343       = 0;
     nSw344       = 0;
     nSw345       = 0;
     nComprueba   = 0;
     nPagina      = 0;
     nMax         = 0;
     nNume1       = 0;
     nNume2       = 0;
     nHoja        = 0;

     nNume       = 0;
     nModo       = 0;
     nLong       = 0;
     nCaracter   = 0;
     nPosi       = 0;
     nPtec       = 0;
     nForma      = 0;
     nCanal      = 0;
     nNumer1     = 0;
     nNumer2     = 0;
     nForzar     = 0;
     nVariable   = 0;
     nHojaMemo   = 0;
     nContador   = 0;
     nConver     = 0;

  {-1}aMenu  = "";
      aMenu1  = "2400";
      aMenu2  = "1";
      aMenu3  = "";
      aMenu4  = "MGDS"
      aMenu5  = " capitulos Memorias";
      aMenu6  = " capitulos Gestion ";
      aMenu7  = " crear Documentos";
      aMenu8  = " Salir";

  {-1}aMenuDup  = "";
      aMenuDup1  = "2400";
      aMenuDup2  = "1";
      aMenuDup3  = "";
      aMenuDup4  = "DF"
      aMenuDup5  = " duplicar del ejercicio anterior";
      aMenuDup6  = " de la Ficha sociedades";

     &efFecha   = @;
     &enEmpresa = 0;
     &enAnyo    = 0;
     &empresa   = 0;
     &anyo      = 0;
     &siono     = "";
     &empAlta = 0;
     &empre   = 0;
     &perio   = 0;
     &plani   = 0;
     &cuent   = "";
     &acabalo = 0;
     &eImpresora = "";
     &eaHoja     = "";
     &enHoja     = 0;
     &eaPrograma = "";
     &eaMoneda   = "";
     &enCanti    = 0;
     &enSwTrata  = 0;

     &enDentro      = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;
{101}&epPuntEdita   = "";
     nSwMedAmb      = 0;

     nSwContar      = 0;
     nContador1     = 0;
     nContador2     = 0;

     Nume1          = 0;
     importe        = "";

     {1}aContiene   = "";
|FIN;

|PROCESO MiraVarMoneda;  |TIPO 7;
     eaPrograma = "zhazdepo";
     |HAZ PintaMoneda;
     #99#16 = eaMoneda;

     |PINTA #99#16;
|FPRC;

|PROCESO Tipo7C10;  |TIPO 7;
     |PUSHV 0501 1453;
     |BLANCO 0501 1453;
     |CUADRO 0501 1453;
     |ATRI R;
     |PINTA 0602, "                   DATOS MEMORIAS                  ";
     |ATRI r;

     |ATRI S;
     |PINTA 0706, "A.- Abreviada";
     |PINTA 0806, "B.- Abreviada con Datos Portada";
     |PINTA 0906, "C.- Abreviada con Datos Portada sin Socios";
     |PINTA 1106, "E.- Extendida";
     |PINTA 1206, "F.- Extendida con Datos Portada";
     |PINTA 1306, "C.- Extendida con Datos Portada sin Socios";
     |ATRI s;
|FPRC;

|PROCESO Tipo0C10;  |TIPO 0;
     |POPV;
|FPRC;

|| ****************************************
|| PROCESOS DEL LINEAL
|| ****************************************

|PROCESO HazEdita;
     enTotalVaria  = 101;
     eaNombreList  = "";
     enCuadroIni   = 1025;
     enCuadroFin   = 2249;
     enCampoAncho  = 25;
     enModoEdita   = 0;

     |ABRE #98;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #98#0 = #99#0;
           #98#1 = #99#2;
           #98#2 = nVariable;
           |LEE 101#98=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #98#3;
               |BORRA 020#98a;
           |FINSI;
           |LIBERA #98;
     |SIGUE;

     |PUSHV  0501 2380;
     |CUADRO 0924 2350;
     |BLANCO 1025 2249;
     |ATRI S;  |PINTA 0924, "    OTROS DOCUMENTOS   ";  |ATRI s;

     |HAZ Edita;
     |POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #98;
           #98#0 = #99#0;
           #98#1 = #99#2;
           #98#2 = nVariable;
           |LEE 1010#98=;
           |SI FSalida ! 0;  |GRABA 020#98b;  |FINSI;
           #98#3 = epPuntEdita;
           |GRABA 020#98a;
           |LIBERA #98;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #98#0 = #99#0;
           #98#1 = #99#2;
           #98#2 = nVariable;
           |LEE 101#98=;
           aAlfa = #98#3;  |QBF aAlfa;

           |LIBERA #98;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#98a;
     |SIGUE;

     |CIERRA #98;
|FPRC;

|PROCESO Borra98;
     |BORRA 020#98a;
     |LIBERA #98;
|FPRC;

|DEFBUCLE mew00009;
     #98#1;
     ;
     #99#0, #99#2, 001;
     #99#0, #99#2, 999;
     be;
     NULL, Borra98;
|FIN;

|PROCESO OtrosDocumentos;
     |SI #99#9 = "S";
         |HAZ HazEdita;
     |SINO;
         |BUCLE mew00009;
     |FINSI;
|FPRC;

|PROCESO HayMemoria;
     |C_M #99#11, 1, "S";
     |C_M #99#10, 1, "S";
     |SI #99#5 = "N";
         |C_M #99#10, 1, "N";
         |C_M #99#11, 1, "N";
         #99#10 = " ";   |PINTA #99#10;
         #99#11 = "N";   |PINTA #99#11;
     |SINO;
         #99#10 = "A";   |PINTA #99#10;

         |SI #99#5 = "I";
             |C_M #99#11, 1, "N";
             #99#11 = "N";   |PINTA #99#11;
         |SINO;
             #99#11 = "S";   |PINTA #99#11;
         |FINSI;
     |FINSI;

     |SI #99#5 = "I";
         |ABRE #105;
         #105#0 = #99#0;
         #105#1 = #99#2;
         #105#2 = "wmemori.doc";
         |LEE 000#105=;
         |SI FSalida ! 0;
             |MENAV "0000 No se ha creado la memoria en word, por favor creela.";
             |ERROR;
         |FINSI;
         |CIERRA #105;
     |FINSI;
|FPRC;

|PROCESO HayGestion;
     |C_M #99#13, 1, "S";
     |SI #99#8 ! "S";
         |C_M #99#13, 1, "N";
         #99#13 = "N";   |PINTA #99#13;
     |FINSI;

     |SI #99#8 = "I";
         |ABRE #105;
         #105#0 = #99#0;
         #105#1 = #99#2;
         #105#2 = "wgestio.doc";
         |LEE 000#105=;
         |SI FSalida ! 0;
             |MENAV "0000 No se ha creado el informe de gestion en word, por favor creelo.";
             |ERROR;
         |FINSI;
         |CIERRA #105;
     |FINSI;
|FPRC;

|PROCESO PaginarMemoria;
     |C_M #99#12, 1, "S";
     |SI #99#11 = "N";
         |C_M #99#12, 1, "N";
         #99#12 = 0;   |PINTA #99#12;
     |SINO;
         #99#12 = 5;   |PINTA #99#12;
     |FINSI;
|FPRC;

|PROCESO PaginarGestion;
     |C_M #99#14, 1, "S";
     |SI #99#13 = "N";
         |C_M #99#14, 1, "N";
         #99#14 = 0;   |PINTA #99#14;
     |SINO;
         #99#14 = -1;  |PINTA #99#14;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |SI nModo ! 1;  |ACABA; |FINSI;

     aCampo2  = #99#2;
     aCampo4  = #99#4;
     aCampo5  = #99#5;
     aCampo6  = #99#6;
     aCampo7  = #99#7;
     aCampo8  = #99#8;
     aCampo9  = #99#9;
|FPRC;

|PROCESO LeeEmpresaFicha;
     |ABRE #7;
     #7#0 = #99#0;
     |LEE 040#7=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa en la Ficha de Sociedades";
         |ERROR;
         |CIERRA #7;
         |ACABA;
     |FINSI;
     |CIERRA #7;
|FPRC;

|PROCESO PonEmpresa;  |TIPO 7;
     #99#1 = #7#1;
     |PINTA #99#1;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;  |ACABA; |FINSI;

     |SI aCampo2 ! "";
         #99#2   = aCampo2;   |PINTA #99#2;
         #99#5   = aCampo5;   |PINTA #99#5;
         #99#8   = aCampo8;   |PINTA #99#8;
         #99#9   = aCampo9;   |PINTA #99#9;
     |FINSI;
|FPRC;

|PROCESO LeeEmpresaSoc;
     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #99#2;
     |LEE 040#1=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa con el Ejercicio seleccionado";
         |ERROR;
     |FINSI;
     |CIERRA #1;

     |ABRE #102;
     #102#0 = #99#0;
     #102#1 = #99#2;
     |LEE 040#102=;
     |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;
     |CIERRA #102;

     |SI #102#13 = "S";
         |MENAV "0000 Cuentas Anuales de Cooperativas, el deposito no esta preparado.";
         |ERROR;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja99;
     #99#0 = 1;
|FRUT;

|RUTINA ClaveAlta99;
     #99#0 = 99999;
|FRUT;

|PROCESO LeeSociedad;
     |ABRE #319;
     #319#0 = #99#0;
     #319#1 = 99;
     |LEE 040#319];
     |SI FSalida = 0;
         |LEE 040#319a;
     |SINO;
         |LEE 040#319u;
     |FINSI;

     |SI FSalida ! 0;  |O #319#0 ! #99#0;
         |DDEFECTO #319;
     |FINSI;
     |CIERRA #319;

     |ABRE #338;
     #338#0 = #319#0;
     #338#1 = #319#1;
     |LEE 040#338=;
     |SI FSalida ! 0;  |DDEFECTO #338;  |FINSI;
     |CIERRA #338;

     nSw339 = 0;
     nSw340 = 0;
     nSw341 = 0;
     nSw342 = 0;
     nSw343 = 0;
     nSw344 = 0;
     nSw345 = 0;

     |ABRE #339;
     #339#0 = #319#0;
     #339#1 = #319#1;
     #339#2 = 1;
     |LEE 040#339];
     |SI FSalida = 0; |Y  #339#0 = #319#0; |Y #339#1 = #319#1;
         nSw339 = 1;
     |FINSI;
     |CIERRA #339;

     |ABRE #340;
     #340#0 = #319#0;
     #340#1 = #319#1;
     #340#2 = 1;
     |LEE 040#340];
     |SI FSalida = 0; |Y  #340#0 = #319#0; |Y #340#1 = #319#1;
         nSw340 = 1;
     |FINSI;
     |CIERRA #340;

     |ABRE #341;
     #341#0 = #319#0;
     #341#1 = #319#1;
     #341#2 = 1;
     |LEE 040#341];
     |SI FSalida = 0; |Y  #341#0 = #319#0; |Y #341#1 = #319#1;
         nSw341 = 1;
     |FINSI;
     |CIERRA #341;

     |ABRE #342;
     #342#0 = #319#0;
     #342#1 = #319#1;
     #342#2 = 1;
     |LEE 040#342];
     |SI FSalida = 0; |Y  #342#0 = #319#0; |Y #342#1 = #319#1;
         nSw342 = 1;
     |FINSI;
     |CIERRA #342;

     |ABRE #343;
     #343#0 = #319#0;
     #343#1 = #319#1;
     #343#2 = 1;
     |LEE 040#343];
     |SI FSalida = 0; |Y  #343#0 = #319#0; |Y #343#1 = #319#1;
         nSw343 = 1;
     |FINSI;
     |CIERRA #343;

     |ABRE #344;
     #344#0 = #319#0;
     #344#1 = #319#1;
     #344#2 = 1;
     |LEE 040#344];
     |SI FSalida = 0; |Y  #344#0 = #319#0; |Y #344#1 = #319#1;
         nSw344 = 1;
     |FINSI;
     |CIERRA #344;

     |ABRE #345;
     #345#0 = #319#0;
     #345#1 = #319#1;
     #345#2 = 1;
     |LEE 040#345];
     |SI FSalida = 0; |Y  #345#0 = #319#0; |Y #345#1 = #319#1;
         nSw345 = 1;
     |FINSI;
     |CIERRA #345;
|FPRC;

|| CREACION FICHERO DE CUENTAS ANUALES

|PROCESO Graba;
    |SI nReturn = 0;  aVariable = aVariable;              |FINSI;
    |SI nReturn = 1;  aVariable = aVariable + &13 + &10;  |FINSI;
    |XGRABA nHandle, aVariable;
|FPRC;

|PROCESO Registro1;
     nReturn   = 0;
     aVariable = "1";                                      |HAZ Graba;
     aVariable = #102#4 % 109;                             |HAZ Graba;
     aVariable = #99#2;                                    |HAZ Graba;
     aVariable = "000000";                                 |HAZ Graba;
     aVariable = "02";                                     |HAZ Graba;
     aVariable = "        ";                               |HAZ Graba;
     aVariable = "        ";                               |HAZ Graba;
     aVariable = ("00" + #103#10) % -102;                  |HAZ Graba;
     aVariable = (#103#2 + (" " * 50)) % 150;              |HAZ Graba;
     aAlfa     = #103#4 + " " + #103#5;  |QBF aAlfa;
     |SI #103#6 ! "    ";
         aAlfa     = aAlfa + ", Num:" + #103#6;  |QBF aAlfa;
     |FINSI;
     |SI #103#7 ! "   ";
         aAlfa     = aAlfa + " Esc:" + #103#7;  |QBF aAlfa;
     |FINSI;
     |SI #103#8 ! "  ";
         aAlfa     = aAlfa + " Piso:" + #103#8;  |QBF aAlfa;
     |FINSI;
     |SI #103#9 ! "  ";
         aAlfa     = aAlfa + " Pta:" + #103#9;  |QBF aAlfa;
     |FINSI;
     aVariable = (aAlfa + (" " * 40)) % 140;               |HAZ Graba;
     aVariable = (#103#13 + (" " * 30)) % 130;             |HAZ Graba;
     aVariable = (("00" + #103#10) % -102) + (("000" + #103#11) % -103);
                                                           |HAZ Graba;

     aAlfa     = #103#15;  |QBT aAlfa;
     aLong     = aAlfa % 0;
     nLong     = aLong;
     nConta    = 0;
     aTelefono = "";
     aPrefijo  = "";
     |PARA nCampo = nLong;  |SI nCampo ] 1;  |HACIENDO nCampo = nCampo - 1;
           nConta    = nConta + 1;
           nPos      = (nCampo * 100) + 1;
           aCaracter = aAlfa % nPos;
           |SI nConta [ 7;
               aTelefono = aCaracter + aTelefono;
           |SINO;
               aPrefijo  = aCaracter + aPrefijo;
           |FINSI;
     |SIGUE;

     aTelefono = ("0000000" + aTelefono) % -107;
     aPrefijo  = ("000"     + aPrefijo)  % -103;

     aVariable = aPrefijo;                               |HAZ Graba;
     aVariable = aTelefono;                              |HAZ Graba;
     aVariable = "000";                                  |HAZ Graba;
     aVariable = "000";                                  |HAZ Graba;
     aVariable = (#109#1 + (" " * 80)) % 180;            |HAZ Graba;
     aVariable = "0000000000";                           |HAZ Graba;

     nReturn   = 1;
     aVariable = "00000";                                |HAZ Graba;
|FPRC;

|PROCESO Registro2;
     |SI nConver = 1;
         enCanti     = nImporteAct;
         |HAZ ConverMoneda;
         nImporteAct = enCanti;

         enCanti     = nImportePas;
         |HAZ ConverMoneda;
         nImportePas = enCanti;
     |FINSI;

     nReturn   = 0;
     aVariable = "2";                                      |HAZ Graba;
     aVariable = #102#4 % 109;                             |HAZ Graba;
     aVariable = #99#2;                                    |HAZ Graba;
     aVariable = aClave;                                   |HAZ Graba;

     |SI nImporteAct > 0;
         aVariable = "+";                                  |HAZ Graba;
     |FINSI;

     |SI nImporteAct < 0;
         aVariable   = "-";                                |HAZ Graba;
         nImporteAct = -nImporteAct;
     |FINSI;

     |SI nImporteAct = 0;
         |SI nForzar = 0;  aVariable   = "-";  |HAZ Graba;  |FINSI;
         |SI nForzar = 1;  aVariable   = "+";  |HAZ Graba;  |FINSI;
     |FINSI;

     nImporteAct = nImporteAct * 100;
     aVariable   = ("000000000000000" + nImporteAct) % -115; |HAZ Graba;

     |SI nImportePas > 0;
         aVariable = "+";                                  |HAZ Graba;
     |FINSI;

     |SI nImportePas < 0;
         aVariable   = "-";                                |HAZ Graba;
         nImportePas = -nImportePas;
     |FINSI;

     |SI nImportePas = 0;
         |SI nForzar = 0;  aVariable   = "-";  |HAZ Graba;  |FINSI;
         |SI nForzar = 1;  aVariable   = "+";  |HAZ Graba;  |FINSI;
     |FINSI;

     nReturn     = 1;
     nImportePas = nImportePas * 100;
     aVariable   = ("000000000000000" + nImportePas) % -115; |HAZ Graba;
|FPRC;

|PROCESO MiraCampos202;
     |SI #202nCampo1 ! 0;  |O #202nCampo2 ! 0;
         nForzar     = 0;
         nConver     = 1;
         nImporteAct = #202nCampo1;
         nImportePas = #202nCampo2;
         |HAZ Registro2;
     |FINSI;
|FPRC;

|PROCESO MiraCampos203;
     |SI #203nCampo1 ! 0;  |O #203nCampo2 ! 0;
         nForzar     = 0;
         nConver     = 1;
         nImporteAct = #203nCampo1;
         nImportePas = #203nCampo2;
         |HAZ Registro2;
     |FINSI;
|FPRC;

|PROCESO MiraCampos204;
     |SI #204nCampo1 ! 0;  |O #204nCampo2 ! 0;
         nForzar     = 0;
         nConver     = 1;
         nImporteAct = #204nCampo1;
         nImportePas = #204nCampo2;
         |HAZ Registro2;
     |FINSI;
|FPRC;

|PROCESO MiraCampos205;
     |SI #205nCampo1 ! 0;  |O #205nCampo2 ! 0;
         nForzar     = 0;
         nConver     = 1;
         nImporteAct = #205nCampo1;
         nImportePas = #205nCampo2;
         |HAZ Registro2;
     |FINSI;
|FPRC;

|PROCESO BalanceAbreviado;
     aBalanceAbreviado = "X";
     aBalanceExtenso   = " ";
     nCampo1 = 70;   nCampo2 = 6;   aClave = "110000";  |HAZ MiraCampos202;
     nCampo1 = 71;   nCampo2 = 7;   aClave = "120000";  |HAZ MiraCampos202;
     nCampo1 = 72;   nCampo2 = 8;   aClave = "121000";  |HAZ MiraCampos202;
     nCampo1 = 73;   nCampo2 = 9;   aClave = "122000";  |HAZ MiraCampos202;
     nCampo1 = 83;   nCampo2 = 19;  aClave = "123000";  |HAZ MiraCampos202;
     nCampo1 = 91;   nCampo2 = 27;  aClave = "124000";  |HAZ MiraCampos202;
     nCampo1 = 100;  nCampo2 = 36;  aClave = "125000";  |HAZ MiraCampos202;
     nCampo1 = 101;  nCampo2 = 37;  aClave = "126000";  |HAZ MiraCampos202;
     nCampo1 = 102;  nCampo2 = 38;  aClave = "130000";  |HAZ MiraCampos202;
     nCampo1 = 103;  nCampo2 = 39;  aClave = "140000";  |HAZ MiraCampos202;
     nCampo1 = 104;  nCampo2 = 40;  aClave = "141000";  |HAZ MiraCampos202;
     nCampo1 = 105;  nCampo2 = 41;  aClave = "142000";  |HAZ MiraCampos202;
     nCampo1 = 113;  nCampo2 = 49;  aClave = "143000";  |HAZ MiraCampos202;
     nCampo1 = 121;  nCampo2 = 57;  aClave = "144000";  |HAZ MiraCampos202;
     nCampo1 = 130;  nCampo2 = 66;  aClave = "145000";  |HAZ MiraCampos202;
     nCampo1 = 131;  nCampo2 = 67;  aClave = "146000";  |HAZ MiraCampos202;
     nCampo1 = 132;  nCampo2 = 68;  aClave = "147000";  |HAZ MiraCampos202;
     nCampo1 = 133;  nCampo2 = 69;  aClave = "100000";  |HAZ MiraCampos202;

     nCampo1 = 79;   nCampo2 = 6;   aClave = "210000";  |HAZ MiraCampos203;
     nCampo1 = 80;   nCampo2 = 7;   aClave = "211000";  |HAZ MiraCampos203;
     nCampo1 = 81;   nCampo2 = 8;   aClave = "212000";  |HAZ MiraCampos203;
     nCampo1 = 82;   nCampo2 = 9;   aClave = "213000";  |HAZ MiraCampos203;
     nCampo1 = 83;   nCampo2 = 10;  aClave = "214000";  |HAZ MiraCampos203;
     nCampo1 = 156;  nCampo2 = 157; aClave = "214060";  |HAZ MiraCampos203;
     nCampo1 = 88;   nCampo2 = 15;  aClave = "214070";  |HAZ MiraCampos203;
     nCampo1 = 89;   nCampo2 = 16;  aClave = "215000";  |HAZ MiraCampos203;
     nCampo1 = 93;   nCampo2 = 20;  aClave = "216000";  |HAZ MiraCampos203;
     nCampo1 = 94;   nCampo2 = 21;  aClave = "217000";  |HAZ MiraCampos203;
     nCampo1 = 95;   nCampo2 = 22;  aClave = "218000";  |HAZ MiraCampos203;
     nCampo1 = 96;   nCampo2 = 23;  aClave = "220000";  |HAZ MiraCampos203;
     nCampo1 = 100;  nCampo2 = 27;  aClave = "230000";  |HAZ MiraCampos203;
     nCampo1 = 105;  nCampo2 = 32;  aClave = "240000";  |HAZ MiraCampos203;
     nCampo1 = 125;  nCampo2 = 52;  aClave = "250000";  |HAZ MiraCampos203;
     nCampo1 = 150;  nCampo2 = 77;  aClave = "260000";  |HAZ MiraCampos203;
     nCampo1 = 151;  nCampo2 = 78;  aClave = "200000";  |HAZ MiraCampos203;
|FPRC;

|PROCESO CuentasAbreviado;
     aCuentasAbreviadas = "X";
     aCuentasExtensas   = " ";

     nCampo1 = 45;   nCampo2 = 6;   aClave = "300000";  |HAZ MiraCampos204;
     nCampo1 = 46;   nCampo2 = 7;   aClave = "301009";  |HAZ MiraCampos204;
     nCampo1 = 51;   nCampo2 = 12;  aClave = "303000";  |HAZ MiraCampos204;
     nCampo1 = 52;   nCampo2 = 13;  aClave = "303010";  |HAZ MiraCampos204;
     nCampo1 = 53;   nCampo2 = 14;  aClave = "303020";  |HAZ MiraCampos204;
     nCampo1 = 54;   nCampo2 = 15;  aClave = "304000";  |HAZ MiraCampos204;
     nCampo1 = 55;   nCampo2 = 16;  aClave = "305000";  |HAZ MiraCampos204;
     nCampo1 = 59;   nCampo2 = 20;  aClave = "306000";  |HAZ MiraCampos204;
     nCampo1 = 64;   nCampo2 = 25;  aClave = "301900";  |HAZ MiraCampos204;
     nCampo1 = 65;   nCampo2 = 26;  aClave = "307000";  |HAZ MiraCampos204;
     nCampo1 = 66;   nCampo2 = 27;  aClave = "307010";  |HAZ MiraCampos204;
     nCampo1 = 67;   nCampo2 = 28;  aClave = "307020";  |HAZ MiraCampos204;
     nCampo1 = 68;   nCampo2 = 29;  aClave = "307030";  |HAZ MiraCampos204;
     nCampo1 = 69;   nCampo2 = 30;  aClave = "307040";  |HAZ MiraCampos204;
     nCampo1 = 70;   nCampo2 = 31;  aClave = "308000";  |HAZ MiraCampos204;
     nCampo1 = 71;   nCampo2 = 32;  aClave = "309000";  |HAZ MiraCampos204;
     nCampo1 = 72;   nCampo2 = 33;  aClave = "302900";  |HAZ MiraCampos204;
     nCampo1 = 73;   nCampo2 = 34;  aClave = "303900";  |HAZ MiraCampos204;
     nCampo1 = 74;   nCampo2 = 35;  aClave = "310000";  |HAZ MiraCampos204;
     nCampo1 = 75;   nCampo2 = 36;  aClave = "311000";  |HAZ MiraCampos204;
     nCampo1 = 76;   nCampo2 = 37;  aClave = "312000";  |HAZ MiraCampos204;
     nCampo1 = 77;   nCampo2 = 38;  aClave = "313000";  |HAZ MiraCampos204;
     nCampo1 = 78;   nCampo2 = 39;  aClave = "314000";  |HAZ MiraCampos204;
     nCampo1 = 79;   nCampo2 = 40;  aClave = "304900";  |HAZ MiraCampos204;
     nCampo1 = 80;   nCampo2 = 41;  aClave = "305900";  |HAZ MiraCampos204;
     nCampo1 = 81;   nCampo2 = 42;  aClave = "315000";  |HAZ MiraCampos204;
     nCampo1 = 82;   nCampo2 = 43;  aClave = "316000";  |HAZ MiraCampos204;
     nCampo1 = 83;   nCampo2 = 44;  aClave = "306900";  |HAZ MiraCampos204;

     nCampo1 = 44;   nCampo2 = 6;   aClave = "400000";  |HAZ MiraCampos205;
     nCampo1 = 45;   nCampo2 = 7;   aClave = "401009";  |HAZ MiraCampos205;
     nCampo1 = 46;   nCampo2 = 8;   aClave = "401000";  |HAZ MiraCampos205;
     nCampo1 = 52;   nCampo2 = 14;  aClave = "401029";  |HAZ MiraCampos205;
     nCampo1 = 56;   nCampo2 = 18;  aClave = "401900";  |HAZ MiraCampos205;
     nCampo1 = 57;   nCampo2 = 19;  aClave = "402009";  |HAZ MiraCampos205;
     nCampo1 = 59;   nCampo2 = 21;  aClave = "402019";  |HAZ MiraCampos205;
     nCampo1 = 60;   nCampo2 = 22;  aClave = "402029";  |HAZ MiraCampos205;
     nCampo1 = 69;   nCampo2 = 31;  aClave = "402039";  |HAZ MiraCampos205;
     nCampo1 = 70;   nCampo2 = 32;  aClave = "402040";  |HAZ MiraCampos205;
     nCampo1 = 71;   nCampo2 = 33;  aClave = "408000";  |HAZ MiraCampos205;
     nCampo1 = 72;   nCampo2 = 34;  aClave = "402900";  |HAZ MiraCampos205;
     nCampo1 = 73;   nCampo2 = 35;  aClave = "403900";  |HAZ MiraCampos205;
     nCampo1 = 74;   nCampo2 = 36;  aClave = "409000";  |HAZ MiraCampos205;
     nCampo1 = 75;   nCampo2 = 37;  aClave = "410000";  |HAZ MiraCampos205;
     nCampo1 = 76;   nCampo2 = 38;  aClave = "411000";  |HAZ MiraCampos205;
     nCampo1 = 77;   nCampo2 = 39;  aClave = "412000";  |HAZ MiraCampos205;
     nCampo1 = 78;   nCampo2 = 40;  aClave = "413000";  |HAZ MiraCampos205;
     nCampo1 = 79;   nCampo2 = 41;  aClave = "404900";  |HAZ MiraCampos205;
     nCampo1 = 80;   nCampo2 = 42;  aClave = "405900";  |HAZ MiraCampos205;
     nCampo1 = 81;   nCampo2 = 43;  aClave = "406900";  |HAZ MiraCampos205;
|FPRC;

|PROCESO BalanceExtenso;
     aBalanceAbreviado = " ";
     aBalanceExtenso   = "X";
     nCampo1 = 70;   nCampo2 = 6;   aClave = "110000";  |HAZ MiraCampos202;
     nCampo1 = 71;   nCampo2 = 7;   aClave = "120000";  |HAZ MiraCampos202;
     nCampo1 = 72;   nCampo2 = 8;   aClave = "121000";  |HAZ MiraCampos202;
     nCampo1 = 73;   nCampo2 = 9;   aClave = "122000";  |HAZ MiraCampos202;
     nCampo1 = 74;   nCampo2 = 10;  aClave = "122010";  |HAZ MiraCampos202;
     nCampo1 = 75;   nCampo2 = 11;  aClave = "122020";  |HAZ MiraCampos202;
     nCampo1 = 76;   nCampo2 = 12;  aClave = "122030";  |HAZ MiraCampos202;
     nCampo1 = 77;   nCampo2 = 13;  aClave = "122040";  |HAZ MiraCampos202;
     nCampo1 = 78;   nCampo2 = 14;  aClave = "122050";  |HAZ MiraCampos202;
     nCampo1 = 79;   nCampo2 = 15;  aClave = "122060";  |HAZ MiraCampos202;
     nCampo1 = 80;   nCampo2 = 16;  aClave = "122070";  |HAZ MiraCampos202;
     nCampo1 = 81;   nCampo2 = 17;  aClave = "122080";  |HAZ MiraCampos202;
     nCampo1 = 82;   nCampo2 = 18;  aClave = "122090";  |HAZ MiraCampos202;
     nCampo1 = 83;   nCampo2 = 19;  aClave = "123000";  |HAZ MiraCampos202;
     nCampo1 = 84;   nCampo2 = 20;  aClave = "123010";  |HAZ MiraCampos202;
     nCampo1 = 85;   nCampo2 = 21;  aClave = "123020";  |HAZ MiraCampos202;
     nCampo1 = 86;   nCampo2 = 22;  aClave = "123030";  |HAZ MiraCampos202;
     nCampo1 = 87;   nCampo2 = 23;  aClave = "123040";  |HAZ MiraCampos202;
     nCampo1 = 88;   nCampo2 = 24;  aClave = "123050";  |HAZ MiraCampos202;
     nCampo1 = 89;   nCampo2 = 25;  aClave = "123060";  |HAZ MiraCampos202;
     nCampo1 = 90;   nCampo2 = 26;  aClave = "123070";  |HAZ MiraCampos202;
     nCampo1 = 91;   nCampo2 = 27;  aClave = "124000";  |HAZ MiraCampos202;
     nCampo1 = 92;   nCampo2 = 28;  aClave = "124010";  |HAZ MiraCampos202;
     nCampo1 = 93;   nCampo2 = 29;  aClave = "124020";  |HAZ MiraCampos202;
     nCampo1 = 94;   nCampo2 = 30;  aClave = "124030";  |HAZ MiraCampos202;
     nCampo1 = 95;   nCampo2 = 31;  aClave = "124040";  |HAZ MiraCampos202;
     nCampo1 = 96;   nCampo2 = 32;  aClave = "124050";  |HAZ MiraCampos202;
     nCampo1 = 97;   nCampo2 = 33;  aClave = "124060";  |HAZ MiraCampos202;
     nCampo1 = 98;   nCampo2 = 34;  aClave = "124070";  |HAZ MiraCampos202;
     nCampo1 = 99;   nCampo2 = 35;  aClave = "124080";  |HAZ MiraCampos202;
     nCampo1 = 135;  nCampo2 = 134; aClave = "124100";  |HAZ MiraCampos202;
     nCampo1 = 100;  nCampo2 = 36;  aClave = "125000";  |HAZ MiraCampos202;
     nCampo1 = 101;  nCampo2 = 37;  aClave = "126000";  |HAZ MiraCampos202;
     nCampo1 = 102;  nCampo2 = 38;  aClave = "130000";  |HAZ MiraCampos202;
     nCampo1 = 103;  nCampo2 = 39;  aClave = "140000";  |HAZ MiraCampos202;
     nCampo1 = 104;  nCampo2 = 40;  aClave = "141000";  |HAZ MiraCampos202;
     nCampo1 = 105;  nCampo2 = 41;  aClave = "142000";  |HAZ MiraCampos202;
     nCampo1 = 106;  nCampo2 = 42;  aClave = "142010";  |HAZ MiraCampos202;
     nCampo1 = 107;  nCampo2 = 43;  aClave = "142020";  |HAZ MiraCampos202;
     nCampo1 = 108;  nCampo2 = 44;  aClave = "142030";  |HAZ MiraCampos202;
     nCampo1 = 109;  nCampo2 = 45;  aClave = "142040";  |HAZ MiraCampos202;
     nCampo1 = 110;  nCampo2 = 46;  aClave = "142050";  |HAZ MiraCampos202;
     nCampo1 = 111;  nCampo2 = 47;  aClave = "142060";  |HAZ MiraCampos202;
     nCampo1 = 112;  nCampo2 = 48;  aClave = "142070";  |HAZ MiraCampos202;
     nCampo1 = 113;  nCampo2 = 49;  aClave = "143000";  |HAZ MiraCampos202;
     nCampo1 = 114;  nCampo2 = 50;  aClave = "143010";  |HAZ MiraCampos202;
     nCampo1 = 115;  nCampo2 = 51;  aClave = "143020";  |HAZ MiraCampos202;
     nCampo1 = 116;  nCampo2 = 52;  aClave = "143030";  |HAZ MiraCampos202;
     nCampo1 = 117;  nCampo2 = 53;  aClave = "143040";  |HAZ MiraCampos202;
     nCampo1 = 118;  nCampo2 = 54;  aClave = "143050";  |HAZ MiraCampos202;
     nCampo1 = 119;  nCampo2 = 55;  aClave = "143060";  |HAZ MiraCampos202;
     nCampo1 = 120;  nCampo2 = 56;  aClave = "143070";  |HAZ MiraCampos202;
     nCampo1 = 121;  nCampo2 = 57;  aClave = "144000";  |HAZ MiraCampos202;
     nCampo1 = 122;  nCampo2 = 58;  aClave = "144010";  |HAZ MiraCampos202;
     nCampo1 = 123;  nCampo2 = 59;  aClave = "144020";  |HAZ MiraCampos202;
     nCampo1 = 124;  nCampo2 = 60;  aClave = "144030";  |HAZ MiraCampos202;
     nCampo1 = 125;  nCampo2 = 61;  aClave = "144040";  |HAZ MiraCampos202;
     nCampo1 = 126;  nCampo2 = 62;  aClave = "144050";  |HAZ MiraCampos202;
     nCampo1 = 127;  nCampo2 = 63;  aClave = "144060";  |HAZ MiraCampos202;
     nCampo1 = 128;  nCampo2 = 64;  aClave = "144070";  |HAZ MiraCampos202;
     nCampo1 = 129;  nCampo2 = 65;  aClave = "144080";  |HAZ MiraCampos202;
     nCampo1 = 130;  nCampo2 = 66;  aClave = "145000";  |HAZ MiraCampos202;
     nCampo1 = 131;  nCampo2 = 67;  aClave = "146000";  |HAZ MiraCampos202;
     nCampo1 = 132;  nCampo2 = 68;  aClave = "147000";  |HAZ MiraCampos202;
     nCampo1 = 133;  nCampo2 = 69;  aClave = "100000";  |HAZ MiraCampos202;

     nCampo1 = 79;   nCampo2 = 6;   aClave = "210000";  |HAZ MiraCampos203;
     nCampo1 = 80;   nCampo2 = 7;   aClave = "211000";  |HAZ MiraCampos203;
     nCampo1 = 81;   nCampo2 = 8;   aClave = "212000";  |HAZ MiraCampos203;
     nCampo1 = 82;   nCampo2 = 9;   aClave = "213000";  |HAZ MiraCampos203;
     nCampo1 = 83;   nCampo2 = 10;  aClave = "214000";  |HAZ MiraCampos203;
     nCampo1 = 84;   nCampo2 = 11;  aClave = "214010";  |HAZ MiraCampos203;
     nCampo1 = 85;   nCampo2 = 12;  aClave = "214020";  |HAZ MiraCampos203;
     nCampo1 = 86;   nCampo2 = 13;  aClave = "214030";  |HAZ MiraCampos203;
     nCampo1 = 87;   nCampo2 = 14;  aClave = "214040";  |HAZ MiraCampos203;
     nCampo1 = 156;  nCampo2 = 157; aClave = "214060";  |HAZ MiraCampos203;
     nCampo1 = 88;   nCampo2 = 15;  aClave = "214050";  |HAZ MiraCampos203;
     nCampo1 = 89;   nCampo2 = 16;  aClave = "215000";  |HAZ MiraCampos203;
     nCampo1 = 90;   nCampo2 = 17;  aClave = "215010";  |HAZ MiraCampos203;
     nCampo1 = 91;   nCampo2 = 18;  aClave = "215020";  |HAZ MiraCampos203;
     nCampo1 = 92;   nCampo2 = 19;  aClave = "215030";  |HAZ MiraCampos203;
     nCampo1 = 93;   nCampo2 = 20;  aClave = "216000";  |HAZ MiraCampos203;
     nCampo1 = 94;   nCampo2 = 21;  aClave = "217000";  |HAZ MiraCampos203;
     nCampo1 = 95;   nCampo2 = 22;  aClave = "218000";  |HAZ MiraCampos203;
     nCampo1 = 96;   nCampo2 = 23;  aClave = "220000";  |HAZ MiraCampos203;
     nCampo1 = 97;   nCampo2 = 24;  aClave = "220010";  |HAZ MiraCampos203;
     nCampo1 = 98;   nCampo2 = 25;  aClave = "220020";  |HAZ MiraCampos203;
     nCampo1 = 99;   nCampo2 = 26;  aClave = "220030";  |HAZ MiraCampos203;
     nCampo1 = 152;  nCampo2 = 153; aClave = "220050";  |HAZ MiraCampos203;
     nCampo1 = 100;  nCampo2 = 27;  aClave = "230000";  |HAZ MiraCampos203;
     nCampo1 = 101;  nCampo2 = 28;  aClave = "230010";  |HAZ MiraCampos203;
     nCampo1 = 102;  nCampo2 = 29;  aClave = "230020";  |HAZ MiraCampos203;
     nCampo1 = 103;  nCampo2 = 30;  aClave = "230030";  |HAZ MiraCampos203;
     nCampo1 = 104;  nCampo2 = 31;  aClave = "230040";  |HAZ MiraCampos203;
     nCampo1 = 105;  nCampo2 = 32;  aClave = "240000";  |HAZ MiraCampos203;
     nCampo1 = 106;  nCampo2 = 33;  aClave = "241000";  |HAZ MiraCampos203;
     nCampo1 = 107;  nCampo2 = 34;  aClave = "241010";  |HAZ MiraCampos203;
     nCampo1 = 108;  nCampo2 = 35;  aClave = "241020";  |HAZ MiraCampos203;
     nCampo1 = 109;  nCampo2 = 36;  aClave = "241030";  |HAZ MiraCampos203;
     nCampo1 = 110;  nCampo2 = 37;  aClave = "242000";  |HAZ MiraCampos203;
     nCampo1 = 111;  nCampo2 = 38;  aClave = "242010";  |HAZ MiraCampos203;
     nCampo1 = 112;  nCampo2 = 39;  aClave = "242020";  |HAZ MiraCampos203;
     nCampo1 = 113;  nCampo2 = 40;  aClave = "243000";  |HAZ MiraCampos203;
     nCampo1 = 114;  nCampo2 = 41;  aClave = "243010";  |HAZ MiraCampos203;
     nCampo1 = 115;  nCampo2 = 42;  aClave = "243020";  |HAZ MiraCampos203;
     nCampo1 = 116;  nCampo2 = 43;  aClave = "244000";  |HAZ MiraCampos203;
     nCampo1 = 117;  nCampo2 = 44;  aClave = "244010";  |HAZ MiraCampos203;
     nCampo1 = 118;  nCampo2 = 45;  aClave = "244020";  |HAZ MiraCampos203;
     nCampo1 = 119;  nCampo2 = 46;  aClave = "244030";  |HAZ MiraCampos203;
     nCampo1 = 154;  nCampo2 = 155; aClave = "244050";  |HAZ MiraCampos203;
     nCampo1 = 120;  nCampo2 = 47;  aClave = "245000";  |HAZ MiraCampos203;
     nCampo1 = 121;  nCampo2 = 48;  aClave = "245010";  |HAZ MiraCampos203;
     nCampo1 = 122;  nCampo2 = 49;  aClave = "245020";  |HAZ MiraCampos203;
     nCampo1 = 123;  nCampo2 = 50;  aClave = "245030";  |HAZ MiraCampos203;
     nCampo1 = 124;  nCampo2 = 51;  aClave = "246000";  |HAZ MiraCampos203;
     nCampo1 = 125;  nCampo2 = 52;  aClave = "250000";  |HAZ MiraCampos203;
     nCampo1 = 126;  nCampo2 = 53;  aClave = "251000";  |HAZ MiraCampos203;
     nCampo1 = 127;  nCampo2 = 54;  aClave = "251010";  |HAZ MiraCampos203;
     nCampo1 = 128;  nCampo2 = 55;  aClave = "251020";  |HAZ MiraCampos203;
     nCampo1 = 129;  nCampo2 = 56;  aClave = "251030";  |HAZ MiraCampos203;
     nCampo1 = 130;  nCampo2 = 57;  aClave = "251040";  |HAZ MiraCampos203;
     nCampo1 = 131;  nCampo2 = 58;  aClave = "252000";  |HAZ MiraCampos203;
     nCampo1 = 132;  nCampo2 = 59;  aClave = "252010";  |HAZ MiraCampos203;
     nCampo1 = 133;  nCampo2 = 60;  aClave = "252020";  |HAZ MiraCampos203;
     nCampo1 = 134;  nCampo2 = 61;  aClave = "252030";  |HAZ MiraCampos203;
     nCampo1 = 135;  nCampo2 = 62;  aClave = "253000";  |HAZ MiraCampos203;
     nCampo1 = 136;  nCampo2 = 63;  aClave = "253010";  |HAZ MiraCampos203;
     nCampo1 = 137;  nCampo2 = 64;  aClave = "253020";  |HAZ MiraCampos203;
     nCampo1 = 138;  nCampo2 = 65;  aClave = "254000";  |HAZ MiraCampos203;
     nCampo1 = 139;  nCampo2 = 66;  aClave = "254010";  |HAZ MiraCampos203;
     nCampo1 = 140;  nCampo2 = 67;  aClave = "254020";  |HAZ MiraCampos203;
     nCampo1 = 141;  nCampo2 = 68;  aClave = "254030";  |HAZ MiraCampos203;
     nCampo1 = 142;  nCampo2 = 69;  aClave = "255000";  |HAZ MiraCampos203;
     nCampo1 = 143;  nCampo2 = 70;  aClave = "255010";  |HAZ MiraCampos203;
     nCampo1 = 144;  nCampo2 = 71;  aClave = "255020";  |HAZ MiraCampos203;
     nCampo1 = 145;  nCampo2 = 72;  aClave = "255030";  |HAZ MiraCampos203;
     nCampo1 = 146;  nCampo2 = 73;  aClave = "255040";  |HAZ MiraCampos203;
     nCampo1 = 147;  nCampo2 = 74;  aClave = "255050";  |HAZ MiraCampos203;
     nCampo1 = 148;  nCampo2 = 75;  aClave = "256000";  |HAZ MiraCampos203;
     nCampo1 = 149;  nCampo2 = 76;  aClave = "257000";  |HAZ MiraCampos203;
     nCampo1 = 150;  nCampo2 = 77;  aClave = "260000";  |HAZ MiraCampos203;
     nCampo1 = 151;  nCampo2 = 78;  aClave = "200000";  |HAZ MiraCampos203;
|FPRC;

|PROCESO CuentasExtenso;
     aCuentasAbreviadas = " ";
     aCuentasExtensas   = "X";

     nCampo1 = 45;   nCampo2 = 6;   aClave = "300000";  |HAZ MiraCampos204;
     nCampo1 = 46;   nCampo2 = 7;   aClave = "301000";  |HAZ MiraCampos204;
     nCampo1 = 47;   nCampo2 = 8;   aClave = "302000";  |HAZ MiraCampos204;
     nCampo1 = 48;   nCampo2 = 9;   aClave = "302010";  |HAZ MiraCampos204;
     nCampo1 = 49;   nCampo2 = 10;  aClave = "302020";  |HAZ MiraCampos204;
     nCampo1 = 50;   nCampo2 = 11;  aClave = "302030";  |HAZ MiraCampos204;
     nCampo1 = 51;   nCampo2 = 12;  aClave = "303000";  |HAZ MiraCampos204;
     nCampo1 = 52;   nCampo2 = 13;  aClave = "303010";  |HAZ MiraCampos204;
     nCampo1 = 53;   nCampo2 = 14;  aClave = "303020";  |HAZ MiraCampos204;
     nCampo1 = 54;   nCampo2 = 15;  aClave = "304000";  |HAZ MiraCampos204;
     nCampo1 = 55;   nCampo2 = 16;  aClave = "305000";  |HAZ MiraCampos204;
     nCampo1 = 56;   nCampo2 = 17;  aClave = "305010";  |HAZ MiraCampos204;
     nCampo1 = 57;   nCampo2 = 18;  aClave = "305020";  |HAZ MiraCampos204;
     nCampo1 = 58;   nCampo2 = 19;  aClave = "305030";  |HAZ MiraCampos204;
     nCampo1 = 59;   nCampo2 = 20;  aClave = "306000";  |HAZ MiraCampos204;
     nCampo1 = 60;   nCampo2 = 21;  aClave = "306010";  |HAZ MiraCampos204;
     nCampo1 = 61;   nCampo2 = 22;  aClave = "306020";  |HAZ MiraCampos204;
     nCampo1 = 62;   nCampo2 = 23;  aClave = "306030";  |HAZ MiraCampos204;
     nCampo1 = 63;   nCampo2 = 24;  aClave = "306040";  |HAZ MiraCampos204;
     nCampo1 = 64;   nCampo2 = 25;  aClave = "301900";  |HAZ MiraCampos204;
     nCampo1 = 65;   nCampo2 = 26;  aClave = "307000";  |HAZ MiraCampos204;
     nCampo1 = 66;   nCampo2 = 27;  aClave = "307010";  |HAZ MiraCampos204;
     nCampo1 = 67;   nCampo2 = 28;  aClave = "307020";  |HAZ MiraCampos204;
     nCampo1 = 68;   nCampo2 = 29;  aClave = "307030";  |HAZ MiraCampos204;
     nCampo1 = 69;   nCampo2 = 30;  aClave = "307040";  |HAZ MiraCampos204;
     nCampo1 = 70;   nCampo2 = 31;  aClave = "308000";  |HAZ MiraCampos204;
     nCampo1 = 71;   nCampo2 = 32;  aClave = "309000";  |HAZ MiraCampos204;
     nCampo1 = 72;   nCampo2 = 33;  aClave = "302900";  |HAZ MiraCampos204;
     nCampo1 = 73;   nCampo2 = 34;  aClave = "303900";  |HAZ MiraCampos204;
     nCampo1 = 74;   nCampo2 = 35;  aClave = "310000";  |HAZ MiraCampos204;
     nCampo1 = 75;   nCampo2 = 36;  aClave = "311000";  |HAZ MiraCampos204;
     nCampo1 = 76;   nCampo2 = 37;  aClave = "312000";  |HAZ MiraCampos204;
     nCampo1 = 77;   nCampo2 = 38;  aClave = "313000";  |HAZ MiraCampos204;
     nCampo1 = 78;   nCampo2 = 39;  aClave = "314000";  |HAZ MiraCampos204;
     nCampo1 = 79;   nCampo2 = 40;  aClave = "304900";  |HAZ MiraCampos204;
     nCampo1 = 80;   nCampo2 = 41;  aClave = "305900";  |HAZ MiraCampos204;
     nCampo1 = 81;   nCampo2 = 42;  aClave = "315000";  |HAZ MiraCampos204;
     nCampo1 = 82;   nCampo2 = 43;  aClave = "316000";  |HAZ MiraCampos204;
     nCampo1 = 83;   nCampo2 = 44;  aClave = "306900";  |HAZ MiraCampos204;

     nCampo1 = 44;   nCampo2 = 6;   aClave = "400000";  |HAZ MiraCampos205;
     nCampo1 = 46;   nCampo2 = 8;   aClave = "401000";  |HAZ MiraCampos205;
     nCampo1 = 47;   nCampo2 = 9;   aClave = "401010";  |HAZ MiraCampos205;
     nCampo1 = 48;   nCampo2 = 10;  aClave = "401020";  |HAZ MiraCampos205;
     nCampo1 = 49;   nCampo2 = 11;  aClave = "401030";  |HAZ MiraCampos205;
     nCampo1 = 50;   nCampo2 = 12;  aClave = "402000";  |HAZ MiraCampos205;
     nCampo1 = 51;   nCampo2 = 13;  aClave = "403000";  |HAZ MiraCampos205;
     nCampo1 = 52;   nCampo2 = 14;  aClave = "404000";  |HAZ MiraCampos205;
     nCampo1 = 53;   nCampo2 = 15;  aClave = "404010";  |HAZ MiraCampos205;
     nCampo1 = 54;   nCampo2 = 16;  aClave = "404020";  |HAZ MiraCampos205;
     nCampo1 = 55;   nCampo2 = 17;  aClave = "404030";  |HAZ MiraCampos205;
     nCampo1 = 56;   nCampo2 = 18;  aClave = "401900";  |HAZ MiraCampos205;
     nCampo1 = 58;   nCampo2 = 20;  aClave = "405000";  |HAZ MiraCampos205;
     nCampo1 = 59;   nCampo2 = 21;  aClave = "405010";  |HAZ MiraCampos205;
     nCampo1 = 60;   nCampo2 = 22;  aClave = "405020";  |HAZ MiraCampos205;
     nCampo1 = 61;   nCampo2 = 23;  aClave = "405030";  |HAZ MiraCampos205;
     nCampo1 = 62;   nCampo2 = 24;  aClave = "406000";  |HAZ MiraCampos205;
     nCampo1 = 63;   nCampo2 = 25;  aClave = "406010";  |HAZ MiraCampos205;
     nCampo1 = 64;   nCampo2 = 26;  aClave = "406020";  |HAZ MiraCampos205;
     nCampo1 = 65;   nCampo2 = 27;  aClave = "406030";  |HAZ MiraCampos205;
     nCampo1 = 66;   nCampo2 = 28;  aClave = "407000";  |HAZ MiraCampos205;
     nCampo1 = 67;   nCampo2 = 29;  aClave = "407010";  |HAZ MiraCampos205;
     nCampo1 = 68;   nCampo2 = 30;  aClave = "407020";  |HAZ MiraCampos205;
     nCampo1 = 69;   nCampo2 = 31;  aClave = "407030";  |HAZ MiraCampos205;
     nCampo1 = 70;   nCampo2 = 32;  aClave = "407040";  |HAZ MiraCampos205;
     nCampo1 = 71;   nCampo2 = 33;  aClave = "408000";  |HAZ MiraCampos205;
     nCampo1 = 72;   nCampo2 = 34;  aClave = "402900";  |HAZ MiraCampos205;
     nCampo1 = 73;   nCampo2 = 35;  aClave = "403900";  |HAZ MiraCampos205;
     nCampo1 = 74;   nCampo2 = 36;  aClave = "409000";  |HAZ MiraCampos205;
     nCampo1 = 75;   nCampo2 = 37;  aClave = "410000";  |HAZ MiraCampos205;
     nCampo1 = 76;   nCampo2 = 38;  aClave = "411000";  |HAZ MiraCampos205;
     nCampo1 = 77;   nCampo2 = 39;  aClave = "412000";  |HAZ MiraCampos205;
     nCampo1 = 78;   nCampo2 = 40;  aClave = "413000";  |HAZ MiraCampos205;
     nCampo1 = 79;   nCampo2 = 41;  aClave = "404900";  |HAZ MiraCampos205;
     nCampo1 = 80;   nCampo2 = 42;  aClave = "405900";  |HAZ MiraCampos205;
     nCampo1 = 81;   nCampo2 = 43;  aClave = "406900";  |HAZ MiraCampos205;
|FPRC;

|PROCESO CalculaAMiles;
     |SI #202#5 = "E";
         #202#9 = 0;
         |PARA nCampo = 10; |SI nCampo [ 18; |HACIENDO nCampo = nCampo + 1;
               #202#9 = #202#9 + #202nCampo;
         |SIGUE;

         #202#73 = 0;
         |PARA nCampo = 74; |SI nCampo [ 82; |HACIENDO nCampo = nCampo + 1;
               #202#73 = #202#73 + #202nCampo;
         |SIGUE;

         #202#19 = 0;
         |PARA nCampo = 20; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 1;
               #202#19 = #202#19 + #202nCampo;
         |SIGUE;

         #202#83 = 0;
         |PARA nCampo = 84; |SI nCampo [ 90; |HACIENDO nCampo = nCampo + 1;
               #202#83 = #202#83 + #202nCampo;
         |SIGUE;

         #202#27 = 0;
         |PARA nCampo = 28; |SI nCampo [ 35; |HACIENDO nCampo = nCampo + 1;
               #202#27 = #202#27 + #202nCampo;
         |SIGUE;
         #202#27 = #202#27 + #202#134;

         #202#91 = 0;
         |PARA nCampo = 92; |SI nCampo [ 99; |HACIENDO nCampo = nCampo + 1;
               #202#91 = #202#91 + #202nCampo;
         |SIGUE;
         #202#91 = #202#91 + #202#135;

         #202#41 = 0;
         |PARA nCampo = 42; |SI nCampo [ 48; |HACIENDO nCampo = nCampo + 1;
               #202#41 = #202#41 + #202nCampo;
         |SIGUE;

         #202#105 = 0;
         |PARA nCampo = 106; |SI nCampo [ 112; |HACIENDO nCampo = nCampo + 1;
               #202#105 = #202#105 + #202nCampo;
         |SIGUE;

         #202#49  = 0;
         |PARA nCampo = 50; |SI nCampo [ 56; |HACIENDO nCampo = nCampo + 1;
               #202#49  = #202#49 + #202nCampo;
         |SIGUE;

         #202#113 = 0;
         |PARA nCampo = 114; |SI nCampo [ 120; |HACIENDO nCampo = nCampo + 1;
               #202#113  = #202#113 + #202nCampo;
         |SIGUE;

         #202#57 = 0;
         |PARA nCampo = 58; |SI nCampo [ 65; |HACIENDO nCampo = nCampo + 1;
               #202#57 = #202#57 + #202nCampo;
         |SIGUE;

         #202#121 = 0;
         |PARA nCampo = 122; |SI nCampo [ 129; |HACIENDO nCampo = nCampo + 1;
               #202#121 = #202#121 + #202nCampo;
         |SIGUE;
     |FINSI;

     #202#7   = #202#8   + #202#9   + #202#19  + #202#27  + #202#36  + #202#37;
     #202#71  = #202#72  + #202#73  + #202#83  + #202#91  + #202#100 + #202#101;
     #202#39  = #202#40  + #202#41  + #202#49  + #202#57  + #202#66  + #202#67  + #202#68;
     #202#103 = #202#104 + #202#105 + #202#113 + #202#121 + #202#130 + #202#131 + #202#132;
     #202#69  = #202#6   + #202#7   + #202#38  + #202#39;
     #202#133 = #202#70  + #202#71  + #202#102 + #202#103;

     |SI #203#5 = "E";
         #203#010 = #203#011 + #203#012 + #203#013 + #203#014 + #203#015 + #203#157;
         #203#083 = #203#084 + #203#085 + #203#086 + #203#087 + #203#088 + #203#156;
         #203#016 = #203#017 + #203#018 + #203#019;
         #203#089 = #203#090 + #203#091 + #203#092;
         #203#023 = #203#024 + #203#025 + #203#026 + #203#153;
         #203#096 = #203#097 + #203#098 + #203#099 + #203#152;
         #203#027 = #203#028 + #203#029 + #203#030 + #203#031;
         #203#100 = #203#101 + #203#102 + #203#103 + #203#104;
         #203#032 = #203#033 + #203#037 + #203#040 + #203#043 + #203#047 + #203#051;
         #203#105 = #203#106 + #203#110 + #203#113 + #203#116 + #203#120 + #203#124;

         #203#033 = #203#034 + #203#035 + #203#036;
         #203#106 = #203#107 + #203#108 + #203#109;
         #203#037 = #203#038 + #203#039;
         #203#110 = #203#111 + #203#112;
         #203#040 = #203#041 + #203#042;
         #203#113 = #203#114 + #203#115;
         #203#043 = #203#044 + #203#045 + #203#046 + #203#155;
         #203#116 = #203#117 + #203#118 + #203#119 + #203#154;
         #203#047 = #203#048 + #203#049 + #203#050;
         #203#120 = #203#121 + #203#122 + #203#123;
         #203#053 = #203#054 + #203#055 + #203#056 + #203#057;
         #203#126 = #203#127 + #203#128 + #203#129 + #203#130;
         #203#058 = #203#059 + #203#060 + #203#061;
         #203#131 = #203#132 + #203#133 + #203#134;
         #203#062 = #203#063 + #203#064;
         #203#135 = #203#136 + #203#137;
         #203#065 = #203#066 + #203#067 + #203#068;
         #203#138 = #203#139 + #203#140 + #203#141;
         #203#069 = #203#070 + #203#071 + #203#072 + #203#073 + #203#074;
         #203#142 = #203#143 + #203#144 + #203#145 + #203#146 + #203#147;
         #203#052 = #203#053 + #203#058 + #203#062 + #203#065 + #203#069;
         #203#052 = #203#052 + #203#075 + #203#076;
         #203#125 = #203#126 + #203#131 + #203#135 + #203#138 + #203#142;
         #203#125 = #203#125 + #203#148 + #203#149;
     |SINO;
         #203#010 = #203#015 + #203#157;
         #203#083 = #203#088 + #203#156;
     |FINSI;

     #203#6   = #203#7   + #203#8   + #203#9   + #203#10  + #203#16  + #203#20 + #203#21 + #203#22;
     #203#79  = #203#80  + #203#81  + #203#82  + #203#83  + #203#89  + #203#93 + #203#94 + #203#95;

     #203#78  = #203#6   + #203#23  + #203#27  + #203#32  + #203#52  + #203#77;
     #203#151 = #203#79  + #203#96  + #203#100 + #203#105 + #203#125 + #203#150;

     |SI #204#5 = "E";
         #204#008 = #204#009 + #204#010 + #204#011;
         #204#016 = #204#017 + #204#018 + #204#019;
         #204#020 = #204#021 + #204#022 + #204#023 + #204#024;
         #204#047 = #204#048 + #204#049 + #204#050;
         #204#055 = #204#056 + #204#057 + #204#058;
         #204#059 = #204#060 + #204#061 + #204#062 + #204#063;
     |FINSI;
     #204#012 = #204#013 + #204#014;
     #204#051 = #204#052 + #204#053;
     #204#026 = #204#027 + #204#028 + #204#029 + #204#030;
     #204#065 = #204#066 + #204#067 + #204#068 + #204#069;
     #204#006 = #204#007 + #204#008 + #204#012 + #204#015 + #204#016;
     #204#006 = #204#006 + #204#020 + #204#026 + #204#031 + #204#032;
     #204#006 = #204#006 + #204#035 + #204#036 + #204#037 + #204#038;
     #204#006 = #204#006 + #204#039 + #204#042 + #204#043;
     #204#045 = #204#046 + #204#047 + #204#051 + #204#054 + #204#055;
     #204#045 = #204#045 + #204#059 + #204#065 + #204#070 + #204#071;
     #204#045 = #204#045 + #204#074 + #204#075 + #204#076 + #204#077;
     #204#045 = #204#045 + #204#078 + #204#081 + #204#082;

     |SI #205#5 = "E";
         #205#007 = 0; #205#19 = 0;
         #205#045 = 0; #205#57 = 0;
         #205#008 = #205#009 + #205#010 + #205#011;
         #205#014 = #205#015 + #205#016 + #205#017;
         #205#020 = #205#021 + #205#022 + #205#023;
         #205#024 = #205#025 + #205#026 + #205#027;
         #205#028 = #205#029 + #205#030 + #205#031 + #205#32;
         #205#046 = #205#047 + #205#048 + #205#049;
         #205#052 = #205#053 + #205#054 + #205#055;
         #205#058 = #205#059 + #205#060 + #205#061;
         #205#062 = #205#063 + #205#064 + #205#065;
         #205#066 = #205#067 + #205#068 + #205#069 + #205#70;

         #205#006 = #205#008 + #205#012 + #205#013 + #205#014 + #205#020;
         #205#006 = #205#006 + #205#024 + #205#028 + #205#033 + #205#036;
         #205#006 = #205#006 + #205#037 + #205#038 + #205#039 + #205#040;

         #205#044 = #205#046 + #205#050 + #205#051 + #205#052 + #205#058;
         #205#044 = #205#044 + #205#062 + #205#066 + #205#071 + #205#074;
         #205#044 = #205#044 + #205#075 + #205#076 + #205#077 + #205#078;
     |SINO;
         #205#007 = #205#008 + #205#014;
         #205#019 = #205#021 + #205#022 + #205#031 + #205#32;
         #205#045 = #205#046 + #205#052;
         #205#057 = #205#059 + #205#060 + #205#069 + #205#70;

         #205#006 = #205#007 + #205#019 + #205#033 + #205#036 + #205#037;
         #205#006 = #205#006 + #205#038 + #205#039 + #205#040;

         #205#044 = #205#045 + #205#057 + #205#071 + #205#074 + #205#075;
         #205#044 = #205#044 + #205#076 + #205#077 + #205#078;
     |FINSI;

     #205#018 = 0; #205#034 = 0; #205#035 = 0; #205#041 = 0; #205#042 = 0; #205#043 = 0;
     #205#056 = 0; #205#072 = 0; #205#073 = 0; #205#079 = 0; #205#080 = 0; #205#081 = 0;

     |SI #204#5 = "E";
         #204#025 = #205#008 + #205#012 + #205#013 + #205#014;
     |SINO;
         #204#025 = #205#007;
     |FINSI;

     #204#025 = #204#025 - (#204#007 + #204#008 + #204#012 + #204#015 + #204#016 + #204#020);
     |SI #204#025 < 0; #205#018 = -#204#025; #204#025 = 0; |FINSI;

     |SI #204#5 = "E";
         #204#064 = #205#046 + #205#050 + #205#051 + #205#052;
     |SINO;
         #204#064 = #205#045;
     |FINSI;
     #204#064 = #204#064 - (#204#046 + #204#047 + #204#051 + #204#054 + #204#055 + #204#059);
     |SI #204#064 < 0; #205#056 = -#204#064; #204#064 = 0; |FINSI;

     |SI #204#5 = "E";
         #204#033 = #205#020 + #205#024 + #205#028 + #205#033;
     |SINO;
         #204#033 = #205#019 + #205#033;
     |FINSI;
     #204#033 = #204#033 - (#204#026 + #204#031 + #204#032);
     |SI #204#033 < 0; #205#034 = -#204#033; #204#033 = 0; |FINSI;

     |SI #204#5 = "E";
         #204#072 = #205#058 + #205#062 + #205#066 + #205#071;
     |SINO;
         #204#072 = #205#057 + #205#071;
     |FINSI;
     #204#072 = #204#072 - (#204#065 + #204#070 + #204#071);
     |SI #204#072 < 0; #205#072 = -#204#072; #204#072 = 0; |FINSI;

     #204#034 = #204#025 + #204#033 - #205#018 - #205#034;
     |SI #204#034 < 0; #205#035 = -#204#034; #204#034 = 0; |FINSI;

     #204#073 = #204#064 + #204#072 - #205#056 - #205#072;
     |SI #204#073 < 0; #205#073 = -#204#073; #204#073 = 0; |FINSI;

     #204#040 = #205#036 +  #205#037 + #205#038 + #205#039 + #205#040;
     #204#040 = #204#040 - (#204#035 + #204#036 + #204#037 + #204#038 + #204#039);
     |SI #204#040 < 0; #205#041 = -#204#040; #204#040 = 0; |FINSI;

     #204#079 = #205#074 +  #205#075 + #205#076 + #205#077 + #205#078;
     #204#079 = #204#079 - (#204#074 + #204#075 + #204#076 + #204#077 + #204#078);
     |SI #204#079 < 0; #205#079 = -#204#079; #204#079 = 0; |FINSI;

     #204#041 = #204#034 + #204#040 - #205#035 - #205#041;
     |SI #204#041 < 0; #205#042 = -#204#041; #204#041 = 0; |FINSI;

     #204#080 = #204#073 + #204#079 - #205#073 - #205#079;
     |SI #204#080 < 0; #205#080 = -#204#080; #204#080 = 0; |FINSI;

     |SI #204#41 ! 0;
         #204#044 = #204#041 - #204#42 - #204#043;
         |SI #204#044 < 0; #205#43 = -#204#44; #204#044 = 0; |FINSI;
     |SINO;
         #204#44 = 0;
     |FINSI;

     |SI #204#80 ! 0;
         #204#083 = #204#080 - #204#81 - #204#082;
         |SI #204#083 < 0; #205#81 = -#204#83; #204#083 = 0; |FINSI;
     |SINO;
         #204#83 = 0;
     |FINSI;

     |SI #205#042 ! 0;
         #205#043 = #205#042 + #204#042 + #204#043;
         |SI #205#043 < 0; #204#44 = -#205#43; #205#043 = 0; |FINSI;
     |FINSI;

     |SI #205#080 ! 0;
         #205#081 = #205#080 + #204#081 + #204#082;
         |SI #205#081 < 0; #204#83 = -#205#81; #205#081 = 0; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CreaCuentas;
     aAbre = aDirEmpresa + "DATOS.ASC";
     |XABRE "BW", aAbre, nHandle;

     |ABRE #102;
     #102#0 = #99#0;
     #102#1 = #99#2;
     |LEE 040#102=;
     |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;
     |CIERRA #102;

     |ABRE #103;
     #103#0 = #99#0;
     #103#1 = #99#2;
     |LEE 040#103=;
     |SI FSalida ! 0;  |DDEFECTO #103;  |FINSI;
     |CIERRA #103;

     |SI #103#1 < 2008;
         |ABRE #135;
         #135#0 = #103#17;
         |LEE 040#135=;
         |SI FSalida ! 0;  |DDEFECTO #135;  |FINSI;
         |CIERRA #135;
     |SINO;
         |ABRE #109;
         #109#0 = #103#17;
         |LEE 040#109=;
         |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;
         |CIERRA #109;
     |FINSI;
     |ABRE #202;
     #202#0 = #99#0;
     #202#1 = #99#2;
     |LEE 040#202=;
     |SI FSalida ! 0;  |DDEFECTO #202;  |FINSI;
     |CIERRA #202;

     |ABRE #203;
     #203#0 = #99#0;
     #203#1 = #99#2;
     |LEE 040#203=;
     |SI FSalida ! 0;  |DDEFECTO #203;  |FINSI;
     |CIERRA #203;

     |ABRE #204;
     #204#0 = #99#0;
     #204#1 = #99#2;
     |LEE 040#204=;
     |SI FSalida ! 0;  |DDEFECTO #204;  |FINSI;
     |CIERRA #204;

     |ABRE #205;
     #205#0 = #99#0;
     #205#1 = #99#2;
     |LEE 040#205=;
     |SI FSalida ! 0;  |DDEFECTO #205;  |FINSI;
     |CIERRA #205;

     |SI #103#93 = 2;
         |PARA nCampo = 6; |SI nCampo [ 135; |HACIENDO nCampo = nCampo + 1;

               #202nCampo = #202nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 157; |HACIENDO nCampo = nCampo + 1;
               #203nCampo = #203nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 83; |HACIENDO nCampo = nCampo + 1;
               #204nCampo = #204nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 81; |HACIENDO nCampo = nCampo + 1;
               #205nCampo = #205nCampo / 1000;
         |SIGUE;

         |HAZ CalculaAMiles;
     |FINSI;

     |HAZ Registro1;

     aAlfa1      = (#103#31 % 704) + (#103#31 % 402) + (#103#31 % 102);
     nImporteAct = aAlfa1;
     nImportePas = 0;
     aClave      = "810290";
     nForzar     = 0;
     nConver     = 0;
     |HAZ Registro2;

     aAlfa1      = (#103#32 % 704) + (#103#32 % 402) + (#103#32 % 102);
     nImporteAct = aAlfa1;
     nImportePas = 0;
     aClave      = "810190";
     nForzar     = 0;
     nConver     = 0;
     |HAZ Registro2;

     nImporteAct = #103#17;
     |SI nImporteAct [ 99;
         nImporteAct = nImporteAct * 100;
     |FINSI;

     |SI nImporteAct [ 999;
         nImporteAct = nImporteAct * 10;
     |FINSI;

     nImportePas = 1;
     aClave      = "810010";
     nForzar     = 0;
     nConver     = 0;
     |HAZ Registro2;

     nImporteAct = #103#86;
     nImportePas = #103#87;
     aClave      = "810100";
     nForzar     = 1;
     nConver     = 0;
     |HAZ Registro2;

     nImporteAct = #103#88;
     nImportePas = #103#89;
     aClave      = "810110";
     nForzar     = 1;
     nConver     = 0;
     |HAZ Registro2;

     nImporteAct = #103#90;
     nImportePas = 0;
     aClave      = "810200";
     nForzar     = 1;
     nConver     = 0;
     |HAZ Registro2;

     |SI #103#93 = 1;
         nForzar     = 0;
         nConver     = 0;
         |SI #99#16 = "PESETAS";
             nImporteAct = 1; nImportePas = 0; aClave = "999021"; |HAZ Registro2;
         |SINO;
             nImporteAct = 1; nImportePas = 0; aClave = "999024"; |HAZ Registro2;
         |FINSI;

         |SI #102#12 = "A";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999411"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999511"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999414"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999514"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "E";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999111"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999211"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999114"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999214"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "P";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999111"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999211"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999114"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999514"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "B";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999411"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999211"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999414"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999214"; |HAZ Registro2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #103#93 = 2;
         nForzar     = 0;
         |SI #99#16 = "PESETAS";
             nImporteAct = 1; nImportePas = 0; aClave = "999022"; |HAZ Registro2;
         |SINO;
             nImporteAct = 1; nImportePas = 0; aClave = "999025"; |HAZ Registro2;
         |FINSI;

         |SI #102#12 = "A";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999412"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999512"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999415"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999515"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "E";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999112"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999212"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999115"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999215"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "P";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999112"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999512"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999115"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999515"; |HAZ Registro2;
             |FINSI;
         |FINSI;

         |SI #102#12 = "B";
             |SI #99#16 = "PESETAS";
                 nImporteAct = 1; nImportePas = 0; aClave = "999412"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999212"; |HAZ Registro2;
             |SINO;
                 nImporteAct = 1; nImportePas = 0; aClave = "999415"; |HAZ Registro2;
                 nImporteAct = 1; nImportePas = 0; aClave = "999215"; |HAZ Registro2;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #102#5 = "A";
         |HAZ BalanceAbreviado;
         |HAZ CuentasAbreviado;
     |FINSI;

     |SI #102#5 = "E";
         |SI #102#12 = "A";
             |HAZ BalanceAbreviado;
             |HAZ CuentasAbreviado;
         |FINSI;
         |SI #102#12 = "E";
             |HAZ BalanceExtenso;
             |HAZ CuentasExtenso;
         |FINSI;
         |SI #102#12 = "P";
             |HAZ BalanceExtenso;
             |HAZ CuentasAbreviado;
         |FINSI;
         |SI #102#12 = "B";
             |HAZ BalanceAbreviado;
             |HAZ CuentasExtenso;
         |FINSI;
     |FINSI;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;

|PROCESO PonAdministradores;
     nContador = nContador + 1;
     nReturn   = 1;
     aAlfa     = #104#3;
     aAlfa  = aAlfa -  "Sr./a. ";
     aAlfa  = aAlfa -  "Sres./as. ";
     aAlfa  = aAlfa -  "Don/Doa ";

     |SI nContador = 1;
         aNombreFirmante = aAlfa;
     |FINSI;

     aVariable = "02" + (("0000000" + "79100" + nContador) % -107) + aAlfa;
     |QBF aVariable;
     |HAZ Graba;
|FPRC;

|DEFBUCLE meempme1;
     #104#1;
     ;
     #99#0, 01;
     #99#0, 99;
     ;
     NULL, PonAdministradores;
|FIN;

|PROCESO CreaCertificado;
     aAbre = aDirEmpresa + "CERTIF.ASC";
     |XABRE "BW", aAbre, nHandle;

     nContador = 0;
     |BUCLE meempme1;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;

|PROCESO Cuenta98;
     |SI nComprueba = 0;
         nConta = nConta + 1;
         |ACABA;
     |FINSI;

     nConta    = nConta + 1;
     |SI nConta > 99;  |ACABA;  |FINSI;

     aVariable = "02" + (("0000000" + "7810" + nConta) % -107) + #98#3;
     |QBF aVariable;
     |HAZ Graba;
|FPRC;

|DEFBUCLE mew00009C;
     #98#1;
     ;
     #99#0, #99#2, 001;
     #99#0, #99#2, 999;
     ;
     NULL, Cuenta98;
|FIN;

|PROCESO CreaInstancia;
     aAbre = aDirEmpresa + "INSTANCIA.ASC";
     |XABRE "BW", aAbre, nHandle;

     nReturn = 1;

     aVariable = "020781001" + #319#27;   |QBF aVariable;  |HAZ Graba;
     aVariable = "020781002" + #319#29;   |QBF aVariable;  |HAZ Graba;
     aVariable = "020781003" + #319#32;   |QBF aVariable;  |HAZ Graba;
     aVariable = "020781004" + #319#33;   |QBF aVariable;  |HAZ Graba;


     aCadena   = "E";
     |SI #99#16 = "PESETAS"; aCadena = "P"; |FINSI;

     |SI #102#5 = "A";  aCadena = aCadena + "11";  |FINSI;
     |SI #102#5 = "E";
         |SI #102#12 = "A";  aCadena = aCadena + "11";  |FINSI;
         |SI #102#12 = "E";  aCadena = aCadena + "22";  |FINSI;
         |SI #102#12 = "B";  aCadena = aCadena + "12";  |FINSI;
         |SI #102#12 = "P";  aCadena = aCadena + "21";  |FINSI;
     |FINSI;

     |SI #99#5 = "N";
         aCadena   = aCadena + "0";
     |SINO;
         |SI #99#10 = "A";  aCadena   = aCadena + "1";  |FINSI;
         |SI #99#10 = "B";  aCadena   = aCadena + "1";  |FINSI;
         |SI #99#10 = "E";  aCadena   = aCadena + "2";  |FINSI;
         |SI #99#10 = "F";  aCadena   = aCadena + "2";  |FINSI;
     |FINSI;

     |SI #99#8 = "N";
         aCadena   = aCadena + "0";
     |SINO;
         aCadena   = aCadena + "1";
     |FINSI;

     |SI nSw339 = 0; |Y nSw340 = 0; |Y nSw341 = 0; |Y nSw342 = 0;
      |Y nSw343 = 0; |Y nSw344 = 0; |Y nSw345 = 0;
         aCadena   = aCadena + "0";
     |SINO;
         aCadena   = aCadena + "1";
     |FINSI;

     aCadena   = aCadena + "1";
     aCadena   = aCadena + "0";

     |SI #99#9 = "N";
         aCadena   = aCadena + "0";
         aCadena   = aCadena + "0000";
     |SINO;
         nConta = 0;
         nComprueba = 0;  |BUCLE mew00009C;
         aCadena   = aCadena + "1";
         aCadena   = aCadena + (("00" + nConta) % -102) + "00";
     |FINSI;
||Pongo fijo el ambienta.txt
     aCadena = aCadena + "010";

     aVariable = "020781010" + aCadena;              |HAZ Graba;

     |SI #99#9 = "S";
         nConta     = 10;
         nComprueba = 1;  |BUCLE mew00009C;
     |FINSI;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;

|PROCESO GrabaAccionTipo1;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         |SI nPagina = 1;  nMax = 25;  |FINSI;
         |SI nPagina ! 1;  nMax = 27;  |FINSI;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI nConta = 0;
         |SI #338#4 ! 0;
             enCanti   = #338#4;   |HAZ ConverMoneda;
             aVariable = "020719010" + enCanti;   |HAZ Graba;
         |FINSI;

         |SI #338#2 ! 0;
             enCanti   = #338#2;   |HAZ ConverMoneda;
             aVariable = "020719020" + enCanti;   |HAZ Graba;
         |FINSI;

         |SI #338#5 ! 0;
             aVariable = "020719030" + #338#5;   |HAZ Graba;
         |FINSI;

         |SI #338#3 ! 0;
             aVariable = "020719040" + #338#3;   |HAZ Graba;
         |FINSI;
     |FINSI;

     nConta = nConta + 1;

     |SI nPagina = 1;  nMax = 25;  |FINSI;
     |SI nPagina ! 1;  nMax = 27;  |FINSI;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "711" + (("00" + nNume2) % -102) + nNume1) % -107) + #339#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "712" + (("00" + nNume2) % -102) + nNume1) % -107) + #339#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "713" + (("00" + nNume2) % -102) + nNume1) % -107) + #339#5;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "714" + (("00" + nNume2) % -102) + nNume1) % -107) + #339#6;
     |HAZ Graba;

     enCanti   = #339#7;   |HAZ ConverMoneda;
     aVariable = "02" + (("0000000" + "715" + (("00" + nNume2) % -102) + nNume1) % -107) + enCanti;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "716" + (("00" + nNume2) % -102) + nNume1) % -107) + #339#8;
     |HAZ Graba;

     enCanti   = #339#9;   |HAZ ConverMoneda;
     aVariable = "02" + (("0000000" + "717" + (("00" + nNume2) % -102) + nNume1) % -107) + enCanti;
     |HAZ Graba;

     enCanti   = #339#10;  |HAZ ConverMoneda;
     aVariable = "02" + (("0000000" + "718" + (("00" + nNume2) % -102) + nNume1) % -107) + enCanti;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0039;
     #339#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo1;
|FIN;

|PROCESO GrabaAccionTipo2;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "721" + (("00" + nNume2) % -102) + nNume1) % -107) + #340#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "722" + (("00" + nNume2) % -102) + nNume1) % -107) + #340#4;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0040;
     #340#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo2;
|FIN;

|PROCESO GrabaAccionTipo3;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "731" + (("00" + nNume2) % -102) + nNume1) % -107) + #341#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "732" + (("00" + nNume2) % -102) + nNume1) % -107) + #341#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "733" + (("00" + nNume2) % -102) + nNume1) % -107) + #341#5;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "734" + (("00" + nNume2) % -102) + nNume1) % -107) + #341#6;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0041;
     #341#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo3;
|FIN;

|PROCESO GrabaAccionTipo4;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "741" + (("00" + nNume2) % -102) + nNume1) % -107) + #342#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "742" + (("00" + nNume2) % -102) + nNume1) % -107) + #342#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "743" + (("00" + nNume2) % -102) + nNume1) % -107) + #342#5;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "744" + (("00" + nNume2) % -102) + nNume1) % -107) + #342#6;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0042;
     #342#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo4;
|FIN;

|PROCESO GrabaAccionTipo5;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "751" + (("00" + nNume2) % -102) + nNume1) % -107) + #343#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "752" + (("00" + nNume2) % -102) + nNume1) % -107) + #343#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "753" + (("00" + nNume2) % -102) + nNume1) % -107) + #343#5;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0043;
     #343#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo5;
|FIN;

|PROCESO GrabaAccionTipo6;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "761" + (("00" + nNume2) % -102) + nNume1) % -107) + #344#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "762" + (("00" + nNume2) % -102) + nNume1) % -107) + #344#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "763" + (("00" + nNume2) % -102) + nNume1) % -107) + #344#5;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0044;
     #344#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo6;
|FIN;

|PROCESO GrabaAccionTipo7;
     |SI nComprueba = 0;
         nConta = nConta + 1;

         nMax = 23;
         |SI nConta > nMax;
             nConta = 0;
             nPagina = nPagina + 1;
         |FINSI;
         |ACABA;
     |FINSI;

     nConta = nConta + 1;

     nMax = 23;
     |SI nConta > nMax;
         nConta  = 1;
         nPagina = nPagina + 1;
     |FINSI;

     |SI nPagina ] 10;  |ACABA;  |FINSI;

     nNume1    = nPagina - 1;
     nNume2    = nConta  - 1;

     aVariable = "02" + (("0000000" + "771" + (("00" + nNume2) % -102) + nNume1) % -107) + #345#3;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "772" + (("00" + nNume2) % -102) + nNume1) % -107) + #345#4;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "773" + (("00" + nNume2) % -102) + nNume1) % -107) + #345#5;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "774" + (("00" + nNume2) % -102) + nNume1) % -107) + #345#6;
     |HAZ Graba;

     aVariable = "02" + (("0000000" + "775" + (("00" + nNume2) % -102) + nNume1) % -107) + #345#7;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0045;
     #345#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo7;
|FIN;

|PROCESO GrabaAccionTipo8;
     aVariable =  #346#3;
     |HAZ Graba;
|FPRC;

|DEFBUCLE agim0046;
     #346#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, GrabaAccionTipo8;
|FIN;

|PROCESO CreaAcciones;
     aAbre = aDirEmpresa + "ACCIONES.ASC";
     |XABRE "BW", aAbre, nHandle;

     nReturn = 1;

     nComprueba = 0;
     |SI nSw339 = 0;
         nPagina  = 1;
         aVariable = "020710000" + nPagina;       |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0039;

         aVariable = "020710000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw340 = 0;
         nPagina  = 1;
         aVariable = "0207200001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0040;

         aVariable = "020720000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw341 = 0;
         nPagina  = 1;
         aVariable = "0207300001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0041;

         aVariable = "020730000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw342 = 0;
         nPagina   = 1;
         aVariable = "0207400001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0042;

         aVariable = "020740000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw343 = 0;
         nPagina   = 1;
         aVariable = "0207500001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0043;

         aVariable = "020750000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw344 = 0;
         nPagina   = 1;
         aVariable = "0207600001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0044;

         aVariable = "020760000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     |SI nSw345 = 0;
         nPagina   = 1;
         aVariable = "0207700001";              |HAZ Graba;
     |SINO;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0045;

         aVariable = "020770000" + nPagina;       |HAZ Graba;
         nHoja     = nHoja + nPagina;
     |FINSI;

     nComprueba = 1;

     |SI nSw339 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0039;
     |FINSI;

     |SI nSw340 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0040;
     |FINSI;

     |SI nSw341 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0041;
     |FINSI;

     |SI nSw342 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0042;
     |FINSI;

     |SI nSw343 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0043;
     |FINSI;

     |SI nSw344 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0044;
     |FINSI;

     |SI nSw345 = 1;
         nPagina    = 1;
         nConta     = 0;
         |BUCLE agim0045;
     |FINSI;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;

     aAbre = aDirEmpresa + "ACCIONES.TXT";
     |XABRE "BW", aAbre, nHandle;
     |BUCLE agim0046;
     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;

|PROCESO CreaMemoria;
     aAbre = aDirEmpresa + "MEMORIA.TXT";   |FBORRA aAbre;

     |PARA nCampo = 1;  |SI nCampo [ 99;  |HACIENDO nCampo = nCampo + 1;
           aAbre = aDirEmpresa + "MEMORIA.M" + (("00" + nCampo) % -102);
           |XABRE "E", aAbre, nHandle;
           |SI FSalida ] 0;
               |FBORRA aAbre;
           |SINO;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI #99#5 = "N";
         aAbre = aDirEmpresa + "MEMORIA.TXT";
         |XABRE "BW", aAbre, nHandle;
         |XCIERRA nHandle;
         aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
     |FINSI;

     |SI #99#5 = "I";
         aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
         aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;
         aAlfa = "C:/MODELOS/DOCUMENTOS/TIF";    |RMKDIR aAlfa;

         |DBASE aBase;
         aDirWord = aBase + "emisiones/" + (("00000" + #99#0) % -105);
         aDirWord = aDirWord + "/" + #99#2 + "/";
         aOrigen  = aDirWord + "wmemori.doc";
         aDestino = "C:/MODELOS/DOCUMENTOS/TIF/MEMORIA.DOC";

         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;
         |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         aOrigen = aBase + "planilla/dsprint.exe";
         aDestino = "C:/MODELOS/DOCUMENTOS/TIF/dsprint.exe";

         aContiene1 = aDestino;
         |ESPECIFICA "REMOTOMD5", aContiene;
         aDocRemoto = FSalida;  |QBF aDocRemoto;

         aContiene1 = aOrigen;
         |ESPECIFICA "MD5", aContiene;
         aDocServidor = FSalida;  |QBF aDocServidor;

         |SI aDocRemoto ! aDocServidor;
             |SI aIPRemoto ! "";
                 |ENVIA_FICHERO aOrigen, aDestino;
             |SINO;
                 |COPIA_FICHERO aOrigen, aDestino;
             |FINSI;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT ";
         aAlfa  = aAlfa + aDestino;
         aAlfa  = aAlfa + " C:\MODELOS\DOCUMENTOS\TIF\memoria.doc @TIFF2 ";
         aAlfa  = aAlfa + "C:\MODELOS\DOCUMENTOS\TIF" + &34;
         |RSYSTEM aAlfa;

         aAlfa  = "C:/MODELOS/DOCUMENTOS/TIF/note*.*";
         nConta = 0;
         |R_PDIR aAlfa;
         |PARA;  |SI FSalida = 0;  |HACIENDO;
              nConta   = nConta + 1;
              aOrigen  = aAlfa;
              aDestino = aDirEmpresa + "MEMORIA.M" + (("00" + nConta) % -102);

              |SI aIPRemoto ! "";
                  |RECIBE_FICHERO aOrigen, aDestino;
              |SINO;
                  |COPIA_FICHERO aOrigen, aDestino;
              |FINSI;
              |RFBORRA aOrigen;

              |R_SDIR aAlfa;
         |SIGUE;
         aAlfa  = "C:\MODELOS\DOCUMENTOS\TIF\memoria.doc";      |RFBORRA aAlfa;
     |FINSI;

     |SI #99#5 = "S";
         enEmpresa   = #99#0;
         eaHoja      = #99#11;
         enHoja      = #99#12;
         eImpresora  = aDirEmpresa + "MEMOTMP.TXT";

         acabalo     = 2;
         |SI #99#10 = "B";  |O #99#10 = "F";
             acabalo = 3;
         |FINSI;

         |SI #99#10 = "C";  |O #99#10 = "G";
             acabalo = 4;
         |FINSI;

         |SUB_EJECUTA "memoria1";
         nHojaMemo   = enHoja;

         aAbre = aDirEmpresa + "MEMOTMP.TXT";
         |XABRE "U", aAbre, nHandle1;

         aAbre = aDirEmpresa + "MEMORIA.TXT";
         |XABRE "W", aAbre, nHandle2;

         |PARA;  |SI  FSalida ] 0;  |HACIENDO;
                 |XLEE nHandle1, 250, aAlfa;
                 |SI FSalida < 0;  |SAL;  |FINSI;

                 aAlfa1 = aAlfa;   |QBT aAlfa1;
                 |SI aAlfa1 = "XT";
                     aAlfa = " " + &13 + &10;
                     |XGRABA nHandle2, aAlfa;
                 |SINO;
                     |XGRABA nHandle2, aAlfa;
                 |FINSI;
         |SIGUE;
         |XCIERRA  nHandle1;
         |XCIERRA  nHandle2;

         aAbre = aDirEmpresa + "MEMOTMP.TXT";
         |FBORRA aAbre;
     |FINSI;
|FPRC;

|PROCESO CreaGestion;
     aAbre = aDirEmpresa + "GESTION.TXT";   |FBORRA aAbre;

     |PARA nCampo = 1;  |SI nCampo [ 99;  |HACIENDO nCampo = nCampo + 1;
           aAbre = aDirEmpresa + "GESTION.G" + (("00" + nCampo) % -102);
           |XABRE "E", aAbre, nHandle;
           |SI FSalida ] 0;
               |FBORRA aAbre;
           |SINO;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI #99#8 = "N";
         aAbre = aDirEmpresa + "GESTION.TXT";
         |XABRE "BW", aAbre, nHandle;
         |XCIERRA nHandle;
         aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
     |FINSI;

     |SI #99#8 = "I";
         aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
         aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;
         aAlfa = "C:/MODELOS/DOCUMENTOS/TIF";    |RMKDIR aAlfa;

         |DBASE aBase;
         aDirWord = aBase + "emisiones/" + (("00000" + #99#0) % -105);
         aDirWord = aDirWord + "/" + #99#2 + "/";
         aOrigen  = aDirWord + "wgestio.doc";
         aDestino = "C:/MODELOS/DOCUMENTOS/TIF/GESTION.DOC";

         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;
         |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;

         aOrigen = aBase + "planilla/dsprint.exe";
         aDestino = "C:/MODELOS/DOCUMENTOS/TIF/dsprint.exe";

         aContiene1 = aDestino;
         |ESPECIFICA "REMOTOMD5", aContiene;
         aDocRemoto = FSalida;  |QBF aDocRemoto;

         aContiene1 = aOrigen;
         |ESPECIFICA "MD5", aContiene;
         aDocServidor = FSalida;  |QBF aDocServidor;

         |SI aDocRemoto ! aDocServidor;
             |SI aIPRemoto ! "";
                 |ENVIA_FICHERO aOrigen, aDestino;
             |SINO;
                 |COPIA_FICHERO aOrigen, aDestino;
             |FINSI;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT ";
         aAlfa  = aAlfa + aDestino;
         aAlfa  = aAlfa + " C:\MODELOS\DOCUMENTOS\TIF\gestion.doc @TIFF2 ";
         aAlfa  = aAlfa + "C:\MODELOS\DOCUMENTOS\TIF" + &34;
         |RSYSTEM aAlfa;

         aAlfa  = "C:/MODELOS/DOCUMENTOS/TIF/note*.*";
         nConta = 0;
         |R_PDIR aAlfa;
         |PARA;  |SI FSalida = 0;  |HACIENDO;
              nConta   = nConta + 1;
              aOrigen  = aAlfa;
              aDestino = aDirEmpresa + "GESTION.G" + (("00" + nConta) % -102);

              |SI aIPRemoto ! "";
                  |RECIBE_FICHERO aOrigen, aDestino;
              |SINO;
                  |COPIA_FICHERO aOrigen, aDestino;
              |FINSI;
              |RFBORRA aOrigen;

              |R_SDIR aAlfa;
         |SIGUE;

         aAlfa  = "C:\MODELOS\DOCUMENTOS\TIF\gestion.doc";      |RFBORRA aAlfa;
     |FINSI;

     |SI #99#8 = "S";
         acabalo     = 2;
         enEmpresa   = #99#0;
         eImpresora  = aDirEmpresa + "GESTTMP.TXT";
         eaHoja      = #99#13;
         |SI #99#14  ! -1;
             enHoja      = #99#14;
         |FINSI;

         |SUB_EJECUTA "meinfges";

         aAbre = aDirEmpresa + "GESTTMP.TXT";
         |XABRE "U", aAbre, nHandle1;

         aAbre = aDirEmpresa + "GESTION.TXT";
         |XABRE "W", aAbre, nHandle2;

         |PARA;  |SI  FSalida ] 0;  |HACIENDO;
                 |XLEE nHandle1, 250, aAlfa;
                 |SI FSalida < 0;  |SAL;  |FINSI;

                 aAlfa1 = aAlfa;   |QBT aAlfa1;
                 |SI aAlfa1 = "XT";
                     aAlfa = " " + &13 + &10;
                     |XGRABA nHandle2, aAlfa;
                 |SINO;
                     |XGRABA nHandle2, aAlfa;
                 |FINSI;
         |SIGUE;
         |XCIERRA  nHandle1;
         |XCIERRA  nHandle2;

         aAbre = aDirEmpresa + "GESTTMP.TXT";
         |FBORRA aAbre;
     |FINSI;
|FPRC;

|PROCESO PonNumDeposito;
     |ABRE #103;
     #103#0 = #99#0;
     #103#1 = #99#2;
     |LEE 101#103=;
     |SI FSalida = 0;
         |SI #99#11 = "S";
             #103#90 = (nHojaMemo - 1) + nHoja;
         |FINSI;
         |SI #99#13 = "S";  |Y #99#14 = -1;
             #103#90 = (enHoja - 1) + nHoja;
         |FINSI;
         |GRABA 020#103a;
     |FINSI;
     |LIBERA #103;
     |CIERRA #103;

     |ABRE #100;
     #100#0 = #99#0;
     |LEE 101#100=;
     |SI FSalida = 0;
         #100#133 = 1;
         |SI #99#11 = "S";
             #100#134 = (nHojaMemo - 1) + nHoja;
         |FINSI;
         |SI #99#13 = "S";  |Y #99#14 = -1;
             #100#134 = (enHoja - 1) + nHoja;
         |FINSI;
         |GRABA 020#100a;
     |FINSI;
     |LIBERA #100;
     |CIERRA #100;
|FPRC;

|PROCESO CreaPortada;
     |SI #99#15 = "N";  |ACABA;  |FINSI;

     |ABRE #7;
     #7#0 = #99#0;
     |LEE 040#7=;
     |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
     |CIERRA #7;

     |DBASE aPathDocu;
     |QBF aPathDocu;
     aPathDocu = aPathDocu + "word/actas/a510000.doc";
     |XABRE "E", aPathDocu, nHandle3;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     aAlfa = "C:/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = "C:/MODELOS/DOCUMENTOS";        |RMKDIR aAlfa;

     aOrigen   = aPathDocu;
     aDestino  = "C:/MODELOS/DOCUMENTOS/a510000.doc";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aAbre  = aDestino;

     |MENSA "      Abriendo el Documento, espere un Momento.";

     |WORD_ABRE nWord, aAbre;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |MENSA "      Asignando Campos, espere un Momento.";

     aAsigna = #319#27;
     aIdenti = "!#0#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #7#1;
     aIdenti = "!#1#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #7#3;
     aIdenti = "!#2#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #319#29;
     aIdenti = "!#3#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #319#30;
     aIdenti = "!#4#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #319#31;
     aIdenti = "!#5#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #319#32;
     aIdenti = "!#6#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #319#33;
     aIdenti = "!#7#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #99#2;
     aIdenti = "!#8#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = " ";
     aIdenti = "!S1";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = "X";
     aIdenti = "!N1";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = #100#135;  |QBF aAsigna;
     aIdenti = "!#9#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = aNombreFirmante;  |QBF aAsigna;
     aIdenti = "!#10#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = "ADMINISTRADOR";
     aIdenti = "!#11#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = "X";
     aIdenti = "!L1";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = aBalanceAbreviado;
     aIdenti = "!L2";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = aBalanceExtenso;
     aIdenti = "!L3";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = "X";
     aIdenti = "!L4";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = aCuentasAbreviadas;
     aIdenti = "!L5";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = aCuentasExtensas;
     aIdenti = "!L6";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = " ";
     |SI #99#5 = "S";  aAsigna = "X";  |FINSI;
     aIdenti = "!L7";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = " ";
     |SI #99#8 = "S";  aAsigna = "X";  |FINSI;
     aIdenti = "!L8";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = " ";
     aIdenti = "!L9";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     aAsigna = ("00000" + #99#0) % -105;
     aIdenti = "!#12#";
     |WORD_ASIGNA_TEXTO nWord, aIdenti, aAsigna;

     |WORD_IMPRIME nWord, "";
     |SLEEP 5;
     |WORD_SALVA nWord, "";
     |RFBORRA aAbre;
|FPRC;

|| ... Parte nueva del Ambienta.txt
|PROCESO Firmantes;
     |SI nSwContar = 0;
         nContador1 = nContador1 + 1;
         |ACABA;
     |FINSI;

     nContador2 = nContador2 + 1;

     |SI nContador2 = 1;
         aAlfa  = #104#3;                    |QBF aAlfa;
         aAlfa1 = #104#2;                    |QBF aAlfa1;
         |ACABA;
     |FINSI;

     |SI nContador2 = nContador1;
         aAlfa  = aAlfa  +  " y " + #104#3;  |QBF aAlfa;
         aAlfa1 = aAlfa1 +  " y " + #104#2;  |QBF aAlfa1;
         |ACABA;
     |FINSI;

     aAlfa  = aAlfa  + ", " + #104#3;        |QBF aAlfa;
     aAlfa1 = aAlfa1 + ", " + #104#2;        |QBF aAlfa1;
|FPRC;

|DEFBUCLE meempme1f;
     #104#1;
     ;
     #99#0, 01;
     #99#0, 99;
     ;
     NULL, Firmantes;
|FIN;

|PROCESO CreaAmbientaNeg;

     aAbre = aDirEmpresa + "AMBIENTA.TXT";
     |XABRE "BW", aAbre, nHandle;

     nReturn = 1;

     aVariable = "     DECLARACION NEGATIVA ACERCA DE LA INFORMACION";              |HAZ Graba;
     aVariable = "        MEDIOAMBIENTAL EN LAS CUENTAS ANUALES";                   |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;

     aAlfa      = " ";
     nContador1 = 0;
     nContador2 = 0;
     nSwContar  = 0;  |BUCLE meempme1f;
     nSwContar  = 1;  |BUCLE meempme1f;

     aAlfa  = aAlfa + " como " + #100#127;  |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;

     aAlfa  = &34 + #100#1;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ",";
     aVariable = aAlfa;  |HAZ Graba;
     aAlfa  = " con domicilio fiscal en " + #106#13; |QBF aAlfa;
     aAlfa  = aAlfa + " " + "(" + #106#14;           |QBF aAlfa;
     aAlfa  = aAlfa + "), " + #106#4;                |QBF aAlfa;
     aAlfa  = aAlfa + " " + #106#5;                  |QBF aAlfa;
     aAlfa  = aAlfa + ", n. " + #106#6;              |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;
     aAlfa  = " y C.I.F. " + #106#3;                 |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;

     aVariable = "                                             ";                   |HAZ Graba;
     aVariable = " DECLARO                                     ";                   |HAZ Graba;
     aVariable = "       Que  en  la  contabilidad  de  la  Sociedad   correspondienta  a  las";|HAZ Graba;
     aVariable = " presentes cuentas anuales no existe ninguna partidad que deba ser incluidas";|HAZ Graba;
     aVariable = " en el documento aparte  de informacion  medioambiental prevista en la Orden";|HAZ Graba;
     aVariable = " del Ministerio de Economia del 8 de octubre del 2001."; |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;

     aVariable = "       Y para que asi conste expido el siguiente certificado en"; |HAZ Graba;
     aAlfa     = #100#138;  |QBF aAlfa;
     aVariable = aAlfa; |HAZ Graba;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;


|PROCESO CreaAmbientaPos;

     aAbre = aDirEmpresa + "AMBIENTA.TXT";
     |XABRE "BW", aAbre, nHandle;

     nReturn = 1;

     aVariable = "     DECLARACION POSITIVA ACERCA DE LA INFORMACION";              |HAZ Graba;
     aVariable = "        MEDIOAMBIENTAL EN LAS CUENTAS ANUALES";                   |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;

     aAlfa      = "";
     nContador1 = 0;
     nContador2 = 0;
     nSwContar  = 0;  |BUCLE meempme1f;
     nSwContar  = 1;  |BUCLE meempme1f;

     aAlfa  = aAlfa + " como " + #100#127;  |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;

     aAlfa  = &34 + #100#1;   |QBF aAlfa;
     aAlfa  = aAlfa + &34 + ",";
     aVariable = aAlfa;  |HAZ Graba;
     aAlfa  = " con domicilio fiscal en " + #106#13; |QBF aAlfa;
     aAlfa  = aAlfa + " " + "(" + #106#14;           |QBF aAlfa;
     aAlfa  = aAlfa + "), " + #106#4;                |QBF aAlfa;
     aAlfa  = aAlfa + " " + #106#5;                  |QBF aAlfa;
     aAlfa  = aAlfa + ", n. " + #106#6;              |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;
     aAlfa  = " y C.I.F. " + #106#3;                 |QBF aAlfa;
     aVariable = aAlfa;  |HAZ Graba;

     aVariable = "                                             ";                   |HAZ Graba;
     aVariable = " DECLARO                                     ";                   |HAZ Graba;
     aVariable = "       Que  en  la  contabilidad  de  la  Sociedad   correspondienta  a  las";|HAZ Graba;
     aVariable = " presentes  cuentas  anuales   existen  partidas  que  deben  ser  incluidas";|HAZ Graba;
     aVariable = " en el documento aparte  de informacion  medioambiental prevista en la Orden";|HAZ Graba;
     aVariable = " del Ministerio de Economia del 8 de octubre del 2001."; |HAZ Graba;
     aVariable = "                                             ";                   |HAZ Graba;

     aVariable = "                                                                                              IMPORTE ";|HAZ Graba;
     aVariable = "                                                                                          ------------";|HAZ Graba;

  |PARA Nume1 = 4; |SI Nume1 [ 27; |HACIENDO Nume1 = Nume1 + 1;
        aVariable = "";
        nImporteAct = #113Nume1; |HAZ importe;
        |SI Nume1 = 4;
            aVariable = "    A) ACTIVOS DE NATURALEZA MEDIOAMBIENTAL                                             "; |HAZ Graba;
            aVariable = "       ------------------------------------                                             "; |HAZ Graba;
            aVariable = "      1. Activos materiales                                                             "; |HAZ Graba;
            aVariable = "      1.1. Valor contable ..............................................................";
        |FINSI;
        |SI Nume1 = 5;
            aVariable = "      1.2. Amortizacion acumulada ......................................................";
        |FINSI;
        |SI Nume1 = 6;
            aVariable = ""; |HAZ Graba;
            aVariable = "      2. Compensacioneas a recibir de un tercero .......................................";
        |FINSI;
        |SI Nume1 = 7;
            aVariable = ""; |HAZ Graba;
            aVariable = ""; |HAZ Graba;
            aVariable = "    B) PASIVOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                                "; |HAZ Graba;
            aVariable = "       -------------------------------------------------                                "; |HAZ Graba;
            aVariable = "      1. Subvenciones de capital que financian activos de naturaleza medioambiental ....";
        |FINSI;
        |SI Nume1 = 8;
            aVariable = ""; |HAZ Graba;
            aVariable = "      2. Provision para act. medioamb., incluidas  en  provisiones para riesgos y gastos"; |HAZ Graba;
            aVariable = "      2.1. Saldo al inicio del ejercicio " + #99#2 + " ..........................................";
        |FINSI;
        |SI Nume1 = 9;
            aVariable = "      2.2. Dotaciones ..................................................................";
        |FINSI;
        |SI Nume1 = 10;
            aVariable = "      2.3. Aplicaciones ................................................................";
        |FINSI;
        |SI Nume1 = 11;
            aVariable = "      2.4. Excesos .....................................................................";
        |FINSI;
        |SI Nume1 = 12;
            aVariable = "      2.5. Saldo al Cierre del ejercicio " + #99#2 + " ..........................................";
        |FINSI;
        |SI Nume1 = 13;
            aVariable = ""; |HAZ Graba;
            aVariable = "      3. Otra Informacion ..............................................................";
        |FINSI;
        |SI Nume1 = 14;
            aVariable = "      3.1. Importe integro de las responsabilidades de naturaleza medioambiental .......";
        |FINSI;
        |SI Nume1 = 15;
            aVariable = "      3.2. Responsabilidades cubiertas con compensaciones a recibir ....................";
        |FINSI;
        |SI Nume1 = 16;
            aVariable = ""; |HAZ Graba;
            aVariable = "      4. Contingencias                                                                  "; |HAZ Graba;
            aVariable = "      4.1. Importe de las contingencias relacionadas con el medio ambiente .............";
        |FINSI;
        |SI Nume1 = 17;
            aVariable = "      4.1.1. Efectos sobre el patrimonio ...............................................";
        |FINSI;
        |SI Nume1 = 18;
            aVariable = "      4.1.2. Efectos sobre el resultado ................................................";
        |FINSI;
        |SI Nume1 = 19;
            aVariable = "      4.2. Riesgos transferidos a otras Entidades ......................................";
        |FINSI;
        |SI Nume1 = 20;
            aVariable = "      4.3. Riesgos maximos .............................................................";
        |FINSI;
        |SI Nume1 = 21;
            aVariable = "      4.4. Riesgos minimos .............................................................";
        |FINSI;
        |SI Nume1 = 22;
            aVariable = ""; |HAZ Graba;
            aVariable = ""; |HAZ Graba;
            aVariable = "    C) GASTOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                                 "; |HAZ Graba;
            aVariable = "       ------------------------------------------------                                 "; |HAZ Graba;
            aVariable = "      1. Gastos medioambientales incluidos en otros gastos de explotacion ..............";
        |FINSI;
        |SI Nume1 = 23;
            aVariable = "      2. Gastos extraordinarios derivados de actuaciones medioambientales ..............";
        |FINSI;
        |SI Nume1 = 24;
            aVariable = ""; |HAZ Graba;
            aVariable = ""; |HAZ Graba;
            aVariable = "    D) INGRESOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                               "; |HAZ Graba;
            aVariable = "      ---------------------------------------------------                               "; |HAZ Graba;
            aVariable = "      1. Ingresos derivados de subvenciones ............................................";
        |FINSI;
        |SI Nume1 = 25;
            aVariable = "      1.1. Subvenciones de naturaleza medioambiental ...................................";
        |FINSI;
        |SI Nume1 = 26;
            aVariable = "      1.2. Imputacion   al  resultado  extraordinario  de  subvenciones  de  capital que"; |HAZ Graba;
            aVariable = "      financian activos de naturaleza medioambiental ...................................";
        |FINSI;
        |SI Nume1 = 27;
            aVariable = "      2. Ingresos de actividades relacionadas con el medio ambiente ....................";
        |FINSI;

        aVariable = aVariable + importe;  |HAZ Graba;
  |SIGUE;

   |XCIERRA nHandle;
   aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
|FPRC;

|PROCESO importe;    || Calculo para poner las comas en el importe
     importe = "";
     eaMoneda  = #99#16;
     enCanti   = nImporteAct;
     enSwTrata = 1;
     |HAZ SeparaImporte;
     importe   = eaImporte;
|FPRC;

|PROCESO EjecutaEmpresa;

     |ABRE #113;
     |DDEFECTO #113;
     nSwMedAmb = 0;
     #113#0 = #99#0;
     #113#1 = #99#2;
     |LEE 040#113=;
     |SI FSalida = 0; nSwMedAmb = 1; |FINSI;
     |CIERRA #113;

     |ABRE #106;
     |DDEFECTO #106;
     #106#0 = #99#0;
     #106#1 = #99#2;
     |LEE 040#106=;
     |CIERRA #106;

     eaMoneda    = #99#16;
     enSwTrata   = 1;

     aDirEmpresa = aDirDeposito + "/" + (("00000" + #99#0) % -105);
     |MKDIR aDirEmpresa;
     aPonChmod    = aChmod + aDirEmpresa; |SYSTEM aPonChmod;

     aDirEmpresa = aDirEmpresa + "/" + #99#2;
     |MKDIR aDirEmpresa;
     aPonChmod    = aChmod + aDirEmpresa; |SYSTEM aPonChmod;

     aDirEmpresa = aDirEmpresa + "/";

     aAbre = aDirEmpresa + "FICHERO.TXT";
     |XABRE "BW", aAbre, nHandle;
     nReturn   = 1;
     aVariable = "FICHERO.TXT";      |HAZ Graba;
     aVariable = "DATOS.ASC";        |HAZ Graba;
     aVariable = "ACCIONES.ASC";     |HAZ Graba;
     aVariable = "CERTIF.ASC";       |HAZ Graba;
     aVariable = "INSTANCIA.ASC";    |HAZ Graba;
     aVariable = "MEMORIA.TXT";      |HAZ Graba;
     aVariable = "GESTION.TXT";      |HAZ Graba;
     aVariable = "ACCIONES.TXT";     |HAZ Graba;
     aVariable = "AMBIENTA.TXT";     |HAZ Graba;

     |XCIERRA nHandle;
     aPonChmod    = aChmod + aAbre;   |SYSTEM aPonChmod;
     nHoja        = 0;

     |HAZ LeeSociedad;
     |HAZ CreaMemoria;
     |HAZ CreaGestion;
     |HAZ CreaAcciones;
     |HAZ PonNumDeposito;
     |HAZ CreaCuentas;
     |HAZ CreaCertificado;
     |HAZ CreaInstancia;
     |HAZ CreaPortada;
     |SI nSwMedAmb = 0;
         |HAZ CreaAmbientaNeg;
     |SINO;
         |HAZ CreaAmbientaPos;
     |FINSI;
|FPRC;

|DEFBUCLE zhazdepo;
     #99#1;
     ;
     00001;
     99999;
     ;
     NULL, EjecutaEmpresa;
|FIN;

|PROCESO QueVersion;
     nSwVersion = 0;

     |VERSIONRTME aVersion;
     |SI aVersion ] "9.09V";  nSwVersion = 1;  |ACABA;  |FINSI;

     aLong = aVersion % 0;
     nLong = aLong;
     aAlfa  = "";
     |PARA nCampo = 1;  |SI nCampo [ nLong;  |HACIENDO nCampo = nCampo + 1;
           nPosi  = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPosi;
           |SI aCaracter = ".";  |SAL;  |FINSI;

           aVersion = aVersion + aCaracter;
     |SIGUE;

     nVersion = aVersion;

     |SI nVersion ] 10;  nSwVersion = 1; |FINSI;
|FPRC;

|PROGRAMA;
       |HAZ QueVersion;
       |SI nSwVersion = 0;
          |MENAV "     Version del Basico Diagram inferior al requerido, Version requerida 9.09V2";
          |ACABA;
       |FINSI;

     |DBASS aChmod;  |QBT aChmod;
     aChmod = aChmod + "bin/agichmod 777 ";

     |DBASE aBase;  |QBT aBase;
     aDirDeposito = aBase + "depositos";   |MKDIR aDirDeposito;

     aPonChmod    = aChmod + aDirDeposito; |SYSTEM aPonChmod;

     |DBASS aAlfa; |QBF aAlfa;
     |PATH_DAT #6aAlfa;
     |ABRE #6;
     |LEE 040#6p;
     |SI FSalida ! 0;
         |MENAV "      No existe Ficha de Sociedades";
         |ERROR;
         |CIERRA #6;
         |ACABA;
     |FINSI;
     |CIERRA #6;

     aAlfa = #6#8;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "      No existe Ficha de Sociedades";
         |ERROR;
         |ACABA;
     |FINSI;

     |PATH_DAT #7 aAlfa;
     |PATH_DAT #319 aAlfa;
     |PATH_DAT #338 aAlfa;
     |PATH_DAT #339 aAlfa;
     |PATH_DAT #340 aAlfa;
     |PATH_DAT #341 aAlfa;
     |PATH_DAT #342 aAlfa;
     |PATH_DAT #343 aAlfa;
     |PATH_DAT #344 aAlfa;
     |PATH_DAT #345 aAlfa;
     |PATH_DAT #346 aAlfa;

     aFichero = ("D1" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 aFichero;
     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     aFichero = ("D2" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #98 aFichero;
     |ABRE #98;  |CIERRA #98;  |DELINDEX #98;

     |ENTLINEAL #1#99, -1, 1, 22, 1, ClaveBaja99, ClaveAlta99;

     |BUCLE zhazdepo;

     |DELINDEX #98;
     |DELINDEX #99;
|FPRO;
