|FICHEROS;
     cubaz801 #0;

     cuacceso #100;
     :/agicont/def/ca8m0000 #101;
     :/agicont/def/ca8m0001 #421;
     cubal801 #801;
     cubal802 #802;
     cubal803 #803;
     cubal805 #805;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &enAnyo    = 0;
     nCampo0 = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     aCampo3 = "";
     nCampo4 = 0;
     nCampo5 = 0;
     nCampo6 = 0;
     nCampo7 = 0;
     nCampo8 = 0;
     nSi     = 0;
     aAlfa1  = "";
     aAlfa2  = "";
     aAlfa3  = "";
     aAlfa4  = "";
     aAlfa5  = "";
     nNume1  = 0;
     aParam  = "";
|FIN;

|INCLUYE varbal_i;

|PROCESO Leo421;
 nSi = 0;
 #421#14 = enEjerBal;
 #421#0  = nCampo0;
 #421#1  = nCampo1;
 #421#2  = nCampo2
 #421#3  = aCampo3;
 #421#4  = nCampo4;
 #421#5  = nCampo5;
 #421#6  = nCampo6;
 #421#7  = nCampo7;
 #421#10 = nCampo8;
 |LEE 040#421=;
 |SI FSalida = 0; nSi = 1; |FINSI;
|FPRC;

|PROCESO PonaCero801;
  nCampo0 = nBalNum;
  nCampo1 = 0;
  nCampo2 = #801#9;
  aCampo3 = #801#10;
  nCampo4 = #801#11;
  nCampo5 = #801#12;
  nCampo6 = #801#13;
  nCampo7 = #801#14;
  nCampo8 = #801#15;
  |HAZ Leo421;
  |SI nSi = 1;
      #801#3  = #421#9;
      #801#8  = #421#8;
      #801#16 = #421#11;
      #801#17 = #421#12;
      #801#5  = #421#13;
      |GRABA 020#801a;
  |FINSI;
  |LIBERA #801;
|FPRC;

|DEFBUCLE PonaCero801;
 #801#1;
 ;
 empresa,anyo, 0001;
 empresa,anyo, 9999;
 be;
 NULL, PonaCero801;
|FIN;

|PROCESO PonaCero802;
  nCampo0 = nCtaNum;
  nCampo1 = 1;
  nCampo2 = #802#9;
  aCampo3 = #802#10;
  nCampo4 = #802#11;
  nCampo5 = #802#12;
  nCampo6 = #802#13;
  nCampo7 = #802#14;
  nCampo8 = #802#15;
  |HAZ Leo421;
  |SI nSi = 1;
      #802#3  = #421#9;
      #802#8  = #421#8;
      #802#16 = #421#11;
      #802#17 = #421#12;
      #802#5  = #421#13;
      |GRABA 020#802a;
  |FINSI;
  |LIBERA #802;
|FPRC;

|DEFBUCLE PonaCero802;
 #802#1;
 ;
 empresa,anyo, 0001;
 empresa,anyo, 9999;
 be;
 NULL, PonaCero802;
|FIN;

|PROCESO PonaCero803;
  nCampo0 = nCtaNum;
  nCampo1 = 2;
  nCampo2 = #803#9;
  aCampo3 = #803#10;
  nCampo4 = #803#11;
  nCampo5 = #803#12;
  nCampo6 = #803#13;
  nCampo7 = #803#14;
  nCampo8 = #803#15;
  |HAZ Leo421;
  |SI nSi = 1;
      #803#3  = #421#9;
      #803#8  = #421#8;
      #803#16 = #421#11;
      #803#17 = #421#12;
      #803#5  = #421#13;
      |GRABA 020#803a;
  |FINSI;
  |LIBERA #803;
|FPRC;

|DEFBUCLE PonaCero803;
 #803#1;
 ;
 empresa,anyo, 0001;
 empresa,anyo, 9999;
 be;
 NULL, PonaCero803;
|FIN;

|PROCESO PonaCero805;
  nCampo0 = nBalNum;
  nCampo1 = 4;
  nCampo2 = #805#9;
  aCampo3 = #805#10;
  nCampo4 = #805#11;
  nCampo5 = #805#12;
  nCampo6 = #805#13;
  nCampo7 = #805#14;
  nCampo8 = #805#15;
  |HAZ Leo421;
  |SI nSi = 1;
      #805#3  = #421#9;
      #805#8  = #421#8;
      #805#16 = #421#11;
      #805#17 = #421#12;
      #805#5  = #421#13;
      |GRABA 020#805a;
  |FINSI;
  |LIBERA #805;
|FPRC;

|DEFBUCLE PonaCero805;
 #805#1;
 ;
 empresa,anyo, 00001;
 empresa,anyo, 99999;
 be;
 NULL, PonaCero805;
|FIN;

|PROCESO LeoEmpresas;
 aAlfa1 = "Modificando la Empresa " + #100#0 + " " + #100#2;
 |PINTA 2006, aAlfa1;
 empresa = #100#0;
 anyo    = #100#1;

 nBalNum = #100#15;
 nCtaNum = #100#16;

|| .... Balance de Situacion
 nBalance = 0;
 |BUCLE PonaCero801;

|| .... Balance de Cuenta de Resultado
 nBalance = 1;
 |BUCLE PonaCero802;

|| .... Ingresos y Gastos
 nBalance = 2;
 |BUCLE PonaCero803;

|| .... Flujo de Efectivos
  nBalance = 4;
 |BUCLE PonaCero805;

 |LIBERA #100;
|FPRC;

|DEFBUCLE LeoEmpresas;
 #100#1
 ;
 #0#0, #0#2;
 #0#1, #0#2;
 be;
 NULL, LeoEmpresas;
|FIN;

|PROCESO Tipo12; |TIPO 12;
 |SI #0#3 = "SI";
     enAnyo  = #0#2; |HAZ eHazEjerCCAA;
     |ABRE #421;
     |BUCLE LeoEmpresas;
     |CIERRA #421;
 |FINSI;
|FPRC;

|PROGRAMA;

     aParam = PARAMETRO; |QBF aParam;
     |SI empresa = 0; |Y aParam = "";
         |MANTE #0;
     |SINO;
         #0#0 = 1;
         #0#1 = 99999;
         #0#2 = 2008;
         |SI aParam = "";
             #0#0 = empresa;
             #0#1 = empresa;
             #0#2 = anyo;
         |FINSI;
         #0#3 = "SI";
         |HAZ Tipo12;
     |FINSI;
|FPRO;
