|FICHEROS;
     cubaz802 #0;

     cuacceso #100;
     :/agicont/def/ca8m0000 #101;
     :/agicont/def/ca8m0001 #421;
     cubal801 #801;
     cubal802 #802;
     cubal803 #803;
     cubal805 #805;

     imagen@  #900;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &enAnyo  = 0;
     nCampo0 = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     aCampo3 = "";
     nCampo4 = 0;
     nCampo5 = 0;
     nCampo6 = 0;
     nCampo7 = 0;
     nCampo8 = 0;
     nSi     = 0;
     aAlfa1  = "";
     aAlfa2  = "";
     aAlfa3  = "";
     aAlfa4  = "";
     aAlfa5  = "";
     nNume1  = 0;
     aParam  = "";

     aDef     = "";
     aMas     = "";
     aFichero = "";
|FIN;

|INCLUYE varbal_i;

|PROCESO PasoNuevosDatos;
  #802#0  = #900#0;
  #802#1  = #900#1;
  #802#16 = #900#16;
  |LEE 101#802=;
  |SI FSalida = 0;
      #802#5 = #900#5;
      #802#6 = #900#6;
      #802#7 = #900#7;
      |GRABA 040#802a;
  |FINSI;
  |LIBERA #802;
|FPRC;

|DEFBUCLE PasoNuevosDatos;
 #900#1003;
 ;
 empresa, anyo, 0001;
 empresa, anyo, 9999;
 e;
 NULL, PasoNuevosDatos;
|FIN;

|PROCESO PonaCero802;
  #900#0  = #802#0;
  #900#1  = #802#1;
  #900#2  = #802#2;
  #900#3  = #802#3;
  #900#4  = #802#4;
  #900#5  = #802#5;
  #900#6  = #802#6;
  #900#7  = #802#7;
  #900#8  = #802#8;
  #900#9  = #802#9;
  #900#10 = #802#10;
  #900#11 = #802#11;
  #900#12 = #802#12;
  #900#13 = #802#13;
  #900#14 = #802#14;
  #900#15 = #802#15;
  #900#16 = #802#16;
  #900#17 = #802#17;
  |GRABA 040#900n;

  |BORRA 020#802a;
  |LIBERA #802;
|FPRC;

|DEFBUCLE PonaCero802;
 #802#1;
 ;
 empresa,anyo, 0001;
 empresa,anyo, 9999;
 be;
 NULL, PonaCero802;
|FIN;

|PROCESO LeoEmpresas;
 aAlfa1 = "Modificando la Empresa " + #100#0 + " " + #100#2;
 |PINTA 2006, aAlfa1;
 empresa = #100#0;
 anyo    = #100#1;

 nBalNum = #100#15;
 nCtaNum = #100#16;

 |DELINDEX #900;
|| .... Balance de Cuenta de Resultado
 |ABRE #900;
 nBalance = 1;
 |BUCLE PonaCero802;
 |CIERRA #900;

 |HAZ eCrearVacio;

 |ABRE #802;
 |SELECT #3#802;
 |BUCLE PasoNuevosDatos;
 |SELECT #1#802;
 |CIERRA #802;

 |LIBERA #100;
|FPRC;

|DEFBUCLE LeoEmpresas;
 #100#1
 ;
 #0#0, #0#2;
 #0#1, #0#2;
 be;
 NULL, LeoEmpresas;
|FIN;

|PROCESO Tipo12; |TIPO 3;

 |DBASS aMas;
 aDef = aMas + "sociedad/def/cubal802";
 |CARGA_DEF aDef, imagen@;
 |SI FSalida ! 0; |ACABA; |FINSI;

 aFichero = ("8w" + Usuario) % 108;
 |NOME_DAT #900 aFichero;
 |DELINDEX #900;

 enAnyo = #0#2; |HAZ eHazEjerCCAA;
 |SI #0#3 = "SI";
     |ABRE #421;
     |BUCLE LeoEmpresas;
     |CIERRA #421;
 |FINSI;

 |DELINDEX #900;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |SI empresa = 0; |Y aParam = "";
         |CLS;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;

         |ABRE #0;
         #0#4 = "A";
         |LEE 101#0=;
         |SI FSalida ! 0;
             #0#4 = "A";
             |GRABA 040#0c;
         |FINSI;
         #0#0 = 1;
         #0#1 = 99999;
         #0#2 = 2009;
         #0#3 = "SI";
         |HAZ Tipo12;

         #0#5 = "X";
         |GRABA 040#0a;
         |LIBERA #0;
         |CIERRA #0;
     |FINSI;
|FPRO;
