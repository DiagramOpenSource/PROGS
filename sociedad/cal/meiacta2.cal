|FICHEROS;
     meiacta2 #0;            || Fichero emision
     meempmem #1;            || Fichero empresas memoria
     maempr01 #3;
     agim0019 #19;
     agim0026 #26;
     agicontr #6;
|FIN;

|VARIABLES;
     &acabalo  = 0;
     &eImpresora = "";

     PathFich = "";
     Modulo   = "";
     Contador = 0;
     Nombre1  = "";
     Nombre2  = "";

     empre    = 0;
     registro = 0;
     empresa  = 0;
     x        = 0;
     opcion   = 0;
     direct   = "";
     informe  = "";
     pepe1    = "";
     pepe2    = "";

 {-1}menu     = "";
     menu1    = "2400";
     menu2    = "1";
     menu3    = " Actas con : ";
     menu4    = "GP";
     menu5    = "  Ganancias  ";
     menu6    = "  Perdidas   ";
|FIN;

|PROCESO Tipo8;  |TIPO 8;
  |DBASS PathFich; |QBF PathFich;
  |PATH_DAT #6PathFich;
  |ABRE #6;
  |LEE 040#6p;
  |SI FSalida ! 0;
      |MENAV "      No existe Ficha de Sociedades";
      |ERROR;
      |CIERRA #6;
      |ACABA;
  |FINSI;
  |CIERRA #6;

  Modulo = #6#8;  |QBF Modulo;
  |SI Modulo = "";
      |MENAV "      No existe Ficha de Sociedades";
      |ERROR;
      |ACABA;
  |FINSI;

  |PATH_DAT #19Modulo;
  |PATH_DAT #26Modulo;
|FPRC;

|PROCESO BuscaAdminis;
  Contador = Contador + 1;

  |SI #26#13 = "U"; |O #26#13 = "S";
      Nombre1 = #26#4;
      |ERROR10;
      |ACABA;
  |FINSI;

  |SI Contador = 1;
      Nombre1 = #26#4;
  |SINO;
      Nombre2 = #26#4;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE agim0026;
  #26#1;
  16;
  #19#0, #19#1, 01, 7;
  #19#0, #19#1, 99, 7;
  ;
  NULL, BuscaAdminis;
|FIN;

|PROCESO cargacam;|TIPO 0;
  empresa = #0#0;
  |DDEFECTO #0;
  |PINDA #0#0;
  #0#0 = empresa;
  empre = empresa;

  |ABRE #1;
  |ABRE #3;

  #1#0 = #0#0;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

  #3#0 = #0#0; #3#1 = #1#5; |LEE 040#3];
  |SI FSalida ! 0;  |O #3#0 ! #0#0; |O #3#1 ! #1#5;
      |DDEFECTO #3;
  |FINSI;

  |ABRE #19;
  #19#0 = #0#0;
  #19#1 = 99;
  |LEE 040#19];
  |SI FSalida = 0;
      |LEE 040#19a;
  |SINO;
      |LEE 040#19u;
  |FINSI;

  |SI FSalida ! 0;  |O #19#0 ! #0#0;
      |DDEFECTO #19;
  |FINSI;
  |CIERRA #19;

  Contador  = 0;
  Nombre1   = "";
  Nombre2   = "";

  |BUCLE agim0026;

  #0#4  = #3#2;
  #0#5  = #3#33;
  #0#6  = #3#13;
  #0#7  = Nombre1;
  #0#8  = #3#77;
  #0#10 = #3#13;

  |SI Contador = 0;
      #0#1  = "DON. " +  #3#77;
      #0#2  = "";
      #0#3  = "SECRETARIO";
      #0#12 = "V.PRESIDENTE";
  |SINO;
      |SI Contador = 1;
          #0#1  = "DON.  " + Nombre1;
          #0#2  = "";
          #0#3  = "ADMINISTRADOR";
          #0#12 = "";
       |SINO;
          #0#1  = "SRES.  " + Nombre1;
          #0#2  = Nombre2;
          #0#3 = "ADMINISTRADORES";
          #0#12 = "";
      |FINSI;
  |FINSI;

  |PINDA #0#0;

  |CIERRA #1;
  |CIERRA #3;
|FPRC;

|PROCESO impre;|TIPO 3;
  |DBASS PathFich; |QBF PathFich;
  |PATH_DAT #6PathFich;
  |ABRE #6;
  |LEE 040#6p;
  |SI FSalida ! 0;
      |MENAV "      No existe Ficha de Sociedades";
      |ERROR;
      |CIERRA #6;
      |ACABA;
  |FINSI;
  |CIERRA #6;

  Modulo = #6#8;  |QBF Modulo;
  |SI Modulo = "";
      |MENAV "      No existe Ficha de Sociedades";
      |ERROR;
      |ACABA;
  |FINSI;

  |PATH_DAT #19Modulo;
  |PATH_DAT #26Modulo;

  |MENU menu;
  opcion = FSalida;
  |SI opcion = 2;
      informe = "actas3";
  |SINO;
      informe = "actas2";
  |FINSI;

  |SI acabalo = 1;
      Impresora = eImpresora;
      |IMPRE -1;
  |SINO;
      |IMPRE 0;
  |FINSI;
  |SI FSalida ! 0;  |ACABA;  |FINSI;

  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

  |PRINT;
  |PIEINF;
  |FININF;
  |FINIMP;
|FPRC;
