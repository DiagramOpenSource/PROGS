|FICHEROS;
     isow9000 #902;

     reflejo@ #1902;
|FIN;

|VARIABLES;
     aBase           = "";
     aMas            = "";
     aAlfa           = "";

     nPer            = 0;
     nNume           = 0;
     nVentana        = -1;
     nValor          = 0;
     nPorce1         = 0;
     nPorce2         = 0;
|FIN;

|PROCESO FinVentana;
     |SI nVentana ! -1;
         |FINVENTANA nVentana;
         nVentana = -1;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Fw9000;  |TIPO 12;
     |HAZ FinVentana;
|FPRC;

|PROCESO Tipo7C38;  |TIPO 7;
     |HAZ Tipo0C6Fw9000;

     |VENTANA 0659, 1798, -1, 1, "";
     nVentana = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}VOLUMEN DE OPERACIONES", 0665, 0698, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}0.- No procede", 0860, 0898, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}1.- Entre 20 y 60 millones de euros", 0960, 0998, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}2.- Mas de 60 millones de euros", 1060, 1098, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}3.- Entre 20 y 60 millones de euros si el 85% ", 1160, 1198, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}    de los ingresos aplican la exenci¢n de los ", 1260, 1298, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}    art.21, 22 o 30.2 de la LIS.", 1360, 1398, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}4.- Mas de 60 millones de euros si el 85% de los ", 1460, 1498, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}    ingresos aplican la exenci¢n de los art.21,", 1560, 1598, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}    22 o 30.2 de la LIS.", 1660, 1698, NULL;

     |PTEC 802;  |PAUSA;
|FPRC;


|PROCESO Tipo0C38;  |TIPO 0;
     |HAZ FinVentana;
|FPRC;

|PROCESO SumaPagosFrac;
    #902#33 = #902#33 + #1902#34;
|FPRC;

|DEFBUCLE SumaPagosFrac;
    #1902#1004;
    ;
    #902#0, #902#1, aAlfa, 00;
    #902#0, #902#1, aAlfa, 99;
    e;
    NULL, SumaPagosFrac;
|FIN;

|PROCESO PagosFraccionados;
     #902#33 = 0;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom9000.mas";
     |CARGA_DEF aMas, reflejo@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa   = #902#2 % 102;
     nPer    = aAlfa;
     nPer    = nPer - 1;

     |PARA nNume = 1; |SI nNume [ nPer; |HACIENDO nNume = nNume + 1;
           aAlfa = nNume + "P";
           |BUCLE SumaPagosFrac;  ||los suma todos 714_984
     |SIGUE;

     |DESCARGA_DEF #reflejo@;
|FPRC;

|PROCESO Total202Fw90;  |TIPO 0;
     |SI #902#38 ! "0";
         |SI #902#1 = 2012;  |O #902#1 = 2013;
             nPorce1 = 8;
             nPorce2 = 4;

             |SI #902#1 = 2012;  |Y #902#2 = "1P";
                 nPorce1 = 4;
                 nPorce2 = 2;
             |FINSI;

             |SI #902#38 = "1";  |O #902#38 = "2";
                 nValor = (#902#15 - #902#17) % nPorce1;
             |FINSI;

             |SI #902#38 = "3";  |O #902#38 = "4";
                 nValor = (#902#15 - #902#17) % nPorce2;
             |FINSI;
         |FINSI;
     |FINSI;

     #902#12 = #902#10 % #902#11;
     #902#14 = #902#12 - #902#13;

     |SI #902#6 = "2";
         #902#18 = #902#15 + #902#16 - #902#17;
         |SI #902#18 < 0;  #902#18 = 0;  |FINSI;
     |FINSI;

     |SI #902#6 = "3";
         #902#21 = #902#15 + #902#16 - #902#17;
         |SI #902#21 < 0;  #902#21 = 0;  |FINSI;
     |FINSI;

     #902#20 = #902#18 % #902#19;
     |SI #902#18 ! 0;
         |SI #902#20 < nValor;  #902#20 = nValor;  |FINSI;
     |FINSI;

     |SI #902#22 > #902#21;
         #902#22 = #902#21;
     |FINSI;

     #902#24 = #902#22 % #902#23;
     #902#25 = #902#21 - #902#22;
     #902#27 = #902#25 % #902#26;
     #902#28 = #902#24 + #902#27;

     #902#34 = (((#902#20 + #902#28) - #902#29 - #902#30) % #902#31) - #902#32 - #902#33;

     |SI #902#14 < 0;  #902#14 = 0;  |FINSI;
     |SI #902#34 < 0;  #902#34 = 0;  |FINSI;

     |PINTA #902#12;
     |PINTA #902#14;
     |PINTA #902#18;
     |PINTA #902#20;
     |PINTA #902#21;
     |PINTA #902#22;
     |PINTA #902#24;
     |PINTA #902#25;
     |PINTA #902#27;
     |PINTA #902#28;
     |PINTA #902#34;
|FPRC;

|PROCESO Tipo0C6Fw9000;  |TIPO 0;
     |SI #902#6 = "1";
         |C_M #902#10, 1, "S";
         |C_M #902#11, 1, "S";

         |C_M #902#15, 1, "N";   #902#15 = 0;
         |C_M #902#16, 1, "N";   #902#16 = 0;
         |C_M #902#17, 1, "N";   #902#17 = 0;
         |C_M #902#19, 1, "N";   #902#19 = 0;
         |C_M #902#22, 1, "N";   #902#22 = 0;
         |C_M #902#23, 1, "N";   #902#23 = 0;
         |C_M #902#26, 1, "N";   #902#26 = 0;
         |C_M #902#29, 1, "N";   #902#29 = 0;
         |C_M #902#30, 1, "N";   #902#30 = 0;
         |C_M #902#31, 1, "N";   #902#31 = 0;
         |C_M #902#38, 1, "N";   #902#38 = "0";
     |FINSI;

     |SI #902#6 = "2";
         |C_M #902#15, 1, "S";
         |C_M #902#16, 1, "S";
         |C_M #902#17, 1, "S";
         |C_M #902#19, 1, "S";
         |C_M #902#29, 1, "S";
         |C_M #902#30, 1, "S";
         |C_M #902#31, 1, "S";
         |C_M #902#38, 1, "S";

         |C_M #902#10, 1, "N";   #902#10 = 0;
         |C_M #902#11, 1, "N";   #902#11 = 0;
         |C_M #902#22, 1, "N";   #902#22 = 0;
         |C_M #902#23, 1, "N";   #902#23 = 0;
         |C_M #902#26, 1, "N";   #902#26 = 0;

         |SI #902#2 ! "1P";  |HAZ PagosFraccionados;  |FINSI;
     |FINSI;

     |SI #902#6 = "3";
         |C_M #902#15, 1, "S";
         |C_M #902#16, 1, "S";
         |C_M #902#17, 1, "S";
         |C_M #902#22, 1, "S";
         |C_M #902#23, 1, "S";
         |C_M #902#26, 1, "S";
         |C_M #902#29, 1, "S";
         |C_M #902#30, 1, "S";
         |C_M #902#31, 1, "S";

         |C_M #902#38, 1, "N";   #902#38 = "0";
         |C_M #902#10, 1, "N";   #902#10 = 0;
         |C_M #902#11, 1, "N";   #902#11 = 0;
         |C_M #902#19, 1, "N";   #902#19 = 0;

         |SI #902#2 ! "1P";  |HAZ PagosFraccionados;  |FINSI;
     |FINSI;

     |PINTA #902#10;
     |PINTA #902#11;
     |PINTA #902#15;
     |PINTA #902#16;
     |PINTA #902#17;
     |PINTA #902#19;
     |PINTA #902#22;
     |PINTA #902#23;
     |PINTA #902#26;
     |PINTA #902#29;
     |PINTA #902#30;
     |PINTA #902#31;
     |PINTA #902#32;
     |PINTA #902#33;
     |PINTA #902#38;
|FPRC;
