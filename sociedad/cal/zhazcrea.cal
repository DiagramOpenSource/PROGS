|FICHEROS;
     zhazdocu #0;
     zregdocu #1;
     zhazcrea #2;
     zregubic #3;
     zregfirm #4;

     maacceso #51;
     sodacoca #52;
     cuacceso #53;
     meempmem #54;

     isom0000 #100;
     maempr01 #301;

     megwordc #800;
     megwordl #801;

     cubal802 #1802;

     :/agicli/def/agim0028 #628;
     :/agicli/def/agim0019 #619;
     :/agicli/def/agim0024 #624;
     :/agicli/def/agim0026 #626;

     :/agicont/def/canempre #408;
     :/agicont/def/ca8ctrle #400;
     :/agicont/def/ca8comay #401;
     :/agicont/def/ca8m0000 #420;

     zw000001 #901,MANTE;
     zw000002 #902,MANTE;
     zw000003 #903,MANTE;
     zw000004 #904,MANTE;
     zw000005 #905,MANTE;
     zw000006 #906,MANTE;
     zw000016 #916,MANTE;
     zw000021 #921,MANTE;

     imagen@  #900;
|FIN;

|VARIABLES;
     nNumer1          = 0;
     nNumer2          = 0;
     nVent            = 0;
     nVentTrab        = 0;
     nVentana         = 0;
     nError           = 0;
     nError1          = 0;
     nError2          = 0;
     nCampo           = 0;
     nCampoD          = 0;
     nCampoH          = 0;
     nID              = 0;
     nTipo            = 0;
     nContador        = 0;
     nPantalla        = 0;
     nNume            = 0;
     nHandle          = 0;
     nPanta           = 0;
     nSubPanta        = 0;
     nGrid            = 0;
     nLinea           = 0;
     nChequeo         = 0;
     nSuma            = 0;

     nBoton           = 0;
     nBoton1          = 0;
     nBoton2          = 0;
     nBoton3          = 0;
     nBoton4          = 0;
     nBoton5          = 0;
     nBoton6          = 0;
     nBoton7          = 0;

     nBoton13         = 0;
     nBoton14         = 0;
     nBoton15         = 0;
     nBoton16         = 0;
     nBoton17         = 0;

     nSubBoton1       = 0;
     nSubBoton2       = 0;
     nSubBoton3       = 0;
     nBotonSal        = -1;
     nBotonCarga      = -1;
     nBotonPer1       = -1;
     nBotonPer2       = -1;
     nBotonPort       = -1;
     nRango           = -1;
     nTipoCert        = 0;
     nEjer            = 0;

     nLabel1          = -1;
     nLabel2          = -1;
     nLabel3          = -1;
     nLabel4          = -1;
     nLabel5          = -1;

     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aID              = "";
     aQueBoton        = "";
     aIPRemoto        = "";
     aDni             = "";
     aPresi           = "";
     aNombre1         = "";
     aDTipo           = "";
     aHTipo           = "";
     aTipo            = "";
     aNif1            = "";
     aAbre            = "";
     aBase            = "";
     aHora            = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aMas             = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     {30} aPopup      = "";

     {-1}aGet         = 0;
         aGet1        = 0;
         aGet2        = 0;

      &enModo         = 0;
      &enEmpresa      = 0;
      &empresa        = 0;
      &anyo           = 0;
      &enAnyo         = 0;
      &enError        = 0;
      &fFechaChequeo  = @;
      &fFechaDisol    = @;
      &empAlta        = 0;
      &empre          = 0;
      &perio          = 0;
      &plani          = 0;
      &cuent          = ""
      &siono          = "";
      &eaCampo3       = "";
      &eaCampo4       = "";
      &eaCampo5       = "";
      &eaCampo6       = "";
      &eaCampo7       = "";
      &eaCampo8       = "";
      &eaCampo9       = "";
      &eaCampo10      = "";
      &eaCampo11      = "";
      &eaCampo12      = "";
      &enPersonaliza  = 0;
      &eaAlfa         = "";
      &eaDirTrabajo   = "";
      &eaDirGuarda    = "";
      &eaDirSerPlan   = "";
      &eaFicheroTra   = "";
      &eaDirSerDoc    = "";
      &eaOrigen       = "";
      &eaDestino      = "";
      &enCoopera      = 0;
      &eaModoPresenta = "";
      &enEjerCuadro   = 0;
      &enEjercicio    = 0;
      &eaDSMAC        = "";
      &enUltMemA      = 0;
      &enUltMemP      = 0;
      &enUltMemC      = 0;
      &eaTipoMemo     = "";
|FIN;

|INCLUYE varbal_i;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |ERROR;
|FPRC;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO RefrescaLabel;
     |SI nLabel1 ! -1;
         |FIN_CONTROL_WINDOWS nLabel1;      nLabel1    = -1;
         |FIN_CONTROL_WINDOWS nLabel2;      nLabel2    = -1;
         |FIN_CONTROL_WINDOWS nLabel3;      nLabel3    = -1;
         |FIN_CONTROL_WINDOWS nLabel4;      nLabel4    = -1;
         |FIN_CONTROL_WINDOWS nLabel5;      nLabel5    = -1;
         |FIN_CONTROL_WINDOWS nBotonPer1;   nBotonPer1 = -1;
         |FIN_CONTROL_WINDOWS nBotonPer2;   nBotonPer2 = -1;
         |FIN_CONTROL_WINDOWS nBotonPort;   nBotonPort = -1;
     |FINSI;

     |SI #1#3 = "N";
         aAlfa = "LABEL,{{4}}NO CREADO";
     |SINO;
         aAlfa = "LABEL,{{6}}CREADO";
     |FINSI;

     |SI enTBal = 1;
         aAlfa = "LABEL,{{4}}NO DISPONIBLE";
     |FINSI;

     |CONTROL_SIMPLE nPanta, aAlfa, 2368, 2385, NULL;
     nLabel1 = FSalida;

     |SI #1#4 = "N";
         aAlfa = "LABEL,{{4}}NO CREADO";
     |SINO;
         aAlfa = "LABEL,{{6}}CREADO";
     |FINSI;

     |CONTROL_SIMPLE nPanta, aAlfa, 1468, 1485, NULL;
     nLabel2 = FSalida;

     |SI #1#8 = "N";
         aAlfa = "LABEL,{{4}}NO CREADO";
     |SINO;
         aAlfa = "LABEL,{{6}}CREADO";
     |FINSI;

     |CONTROL_SIMPLE nPanta, aAlfa, 1768, 1785, NULL;
     nLabel3 = FSalida;

     |SI #1#14 = "N";
         aAlfa = "LABEL,{{4}}NO CREADO";
     |SINO;
         aAlfa = "LABEL,{{6}}CREADO";
     |FINSI;

     |SI #2#4 = 21;  |O #2#4 = 22;
      |O #2#4 = 31;  |O #2#4 = 32;
         aAlfa = "LABEL,{{4}}NO DISPONIBLE";
     |FINSI;

     |CONTROL_SIMPLE nPanta, aAlfa, 2068, 2085, NULL;
     nLabel4 = FSalida;

     |SI #1#11 = "N";
         aAlfa = "LABEL,{{4}}NO CREADO";
     |SINO;
         aAlfa = "LABEL,{{6}}CREADO";
     |FINSI;

     |CONTROL_SIMPLE nPanta, aAlfa, 2668, 2685, NULL;
     nLabel5 = FSalida;

     |ESTADO_CONTROL nBoton13,  "DISABLE";

     |SI #1#3 = "S";
         |ESTADO_CONTROL nBoton13,  "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBoton14,  "DISABLE";

     |SI #1#4 = "S";
         |ESTADO_CONTROL nBoton14,  "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBoton15,  "DISABLE";

     |SI #1#8 = "S";
         |ESTADO_CONTROL nBoton15,  "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBoton16,  "DISABLE";

     |SI #1#14 = "S";
         |ESTADO_CONTROL nBoton16,  "ENABLE";
     |FINSI;

     |ESTADO_CONTROL nBoton17,  "DISABLE";

     |SI #1#11 = "S";
         |ESTADO_CONTROL nBoton17,  "ENABLE";
     |FINSI;

     |DBASE aAlfa;  |QBF aAlfa;

     |SI #0#0 = 2008;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "memor001.doc";
     |FINSI;

     |SI #0#0 = 2009;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "memo2009.doc";
     |FINSI;

     |SI #0#0 ] 2010;
          |SI #2#15 = "P";
              nEjer = #0#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "p.doc";
          |FINSI;

          |SI #2#15 = "A";
              nEjer = #0#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "a.doc";
          |FINSI;

          |SI #2#15 = "C";
              nEjer = #0#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Personalizar memoria patr¢n para esta empresa", 2702, 2830, BotonPer1;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Editar o quitar personalizaci¢n memoria patr¢n para esta empresa", 2702, 2830, BotonPer1;
     |FINSI;
     nBotonPer1 = FSalida;

     |DBASE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "word/gestion/" + (("00000" + #2#0) % -105) + "/" + "gesti001.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Personalizar i.gesti¢n patr¢n para esta empresa", 2733, 2862, BotonPer2;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}}Editar o quitar personalizaci¢n i.gesti¢n patr¢n para esta empresa", 2733, 2862, BotonPer2;
     |FINSI;
     nBotonPer2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Formulario carpeta Registro", 2764, 2886, BotonPort;
     nBotonPort = FSalida;
|FPRC;

|PROCESO BotonPer1;
     |DBASE aAlfa;  |QBF aAlfa;

     |SI #0#0 = 2008;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "memor001.doc";
     |FINSI;

     |SI #0#0 = 2009;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "memo2009.doc";
     |FINSI;

     |SI #0#0 ] 2010;
          |SI #2#15 = "P";
              nEjer = #0#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "p.doc";
          |FINSI;

          |SI #2#15 = "A";
              nEjer = #0#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "a.doc";
          |FINSI;

          |SI #2#15 = "C";
              nEjer = #0#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #2#0) % -105) + "/" + "mem" + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |CONFI "0000SSeguro que quiere personalizar la memoria para esta empresa";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |HAZ PersonalizaMemoria;
     |SINO;
         aPopup1  = nBotonPer1;
         aPopup2  = 3;
         aPopup3  = "1.- Editar";
         aPopup4  = "2.- Quitar";
         aPopup5  = "3.- Salir";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;
         |SI FSalida ! 0;
             IaPopup  = aPopup3  <-;
             IaPopup  = IaPopup + (FSalida - 1);

             aAlfa1        = aPopup % 101;
             enPersonaliza = 1;

             |SI aAlfa1 = "1";
                 |SI #2#15 = "P";  |HAZ EditaMemoPatronPYME;        |FINSI;
                 |SI #2#15 = "A";  |HAZ EditaMemoPatronAbreviada;   |FINSI;
                 |SI #2#15 = "C";  |HAZ EditaMemoPatronCooperativa; |FINSI;
             |FINSI;

             |SI aAlfa1 = "2";
                 |CONFI "0000SSeguro que quiere quitar la memoria personalizada de esta empresa";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;

                 |FBORRA aAlfa;
             |FINSI;
         |FINSI;
     |FINSI;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO BotonPer2;
     |DBASE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "word/gestion/" + (("00000" + #2#0) % -105) + "/" + "gesti001.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |CONFI "0000SSeguro que quiere personalizar el informe de gesti¢n para esta empresa";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |HAZ PersonalizaGestion;
     |SINO;
         aPopup1  = nBotonPer2;
         aPopup2  = 3;
         aPopup3  = "1.- Editar";
         aPopup4  = "2.- Quitar";
         aPopup5  = "3.- Salir";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;
         |SI FSalida ! 0;
             IaPopup  = aPopup3  <-;
             IaPopup  = IaPopup + (FSalida - 1);

             aAlfa1        = aPopup % 101;
             enPersonaliza = 1;
             |SI aAlfa1 = "1";  |HAZ EditaGestiPatron;  |FINSI;
             |SI aAlfa1 = "2";
                 |CONFI "0000SSeguro que quiere quitar el informe de gesti¢n personalizado de esta empresa";
                 |SI FSalida ! 0;  |ACABA;  |FINSI;

                 |FBORRA aAlfa;
             |FINSI;
         |FINSI;
     |FINSI;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO BotonPort;
     aPopup1  = nBotonPort;
     aPopup2  = 3;
     aPopup3  = "1.- Por pantalla";
     aPopup4  = "2.- Por impresora";
     aPopup5  = "3.- Salir";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         eaModoPresenta = "";
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa1        = aPopup % 101;
         |SI aAlfa1 = "1";  eaModoPresenta = "P";  |FINSI;
         |SI aAlfa1 = "2";  eaModoPresenta = "I";  |FINSI;
     |FINSI;

     |SI eaModoPresenta ! "";
         |HAZ CreaPortada;
     |FINSI;
|FPRC;

|PROCESO Tipo66C10Crea;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 10;
     aPopup3  = "01.- JUNTA NO UNIVERSAL ABREVIADA";
     aPopup4  = "02.- JUNTA NO UNIVERSAL NORMAL";
     aPopup5  = "03.- JUNTA NO UNIVERSAL SIN APROBACION";
     aPopup6  = "04.- JUNTA UNIVERSAL ABREVIADA";
     aPopup7  = "05.- JUNTA UNIVERSAL NORMAL";
     aPopup8  = "06.- JUNTA UNIVERSAL TRANSPARENCIA FISCAL ABREVIADA";
     aPopup9  = "07.- JUNTA UNIVERSAL TRANSPARENCIA FISCAL NORMAL";
     aPopup10 = "08.- JUNTA UNIVERSAL UNIPERSONAL ABREVIADA";
     aPopup11 = "09.- JUNTA UNIVERSAL SIN APROBACION";
     aPopup12 = "10.- ASAMBLEA COOPERATIVAS";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;

         #2#10 = aAlfa;  |PINTA #2#10;
     |FINSI;
|FPRC;

|PROCESO Tipo0C11Crea;  |TIPO 0;
     |C_M #2#16, 1, "S";
     |SI #2#11 ! "H";  |Y #2#11 ! "T";
         |C_M #2#16, 1, "N";  #2#16 = "";
     |FINSI;

     |PINTA #2#16;
|FPRC;

|PROCESO Tipo0C15Crea;  |TIPO 0;
     |SI #0#0 [ 2010;
         |SI #2#15 = "C";
             |MENAV "0000No procede esta memoria. A partir del 2011";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #2#15 ! Contenido;
         |SI #2#15 = "C";
             |HAZ CogeDistrISCoop;

             #2#10 = 10;  |PINTA #2#10;
         |SINO;
             |HAZ CogeDistrIS;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO canempre;
     nNumer1 = #2#1 $ 100;
     |SI nNumer1 = #408#26;
         perio   = #408#3;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE canempre;
     #408#1;
     ;
     #2#0, 0;
     #2#0, 9;
     ;
     NULL, canempre;
|FIN;

|PROCESO BuscaPeriodo;
     perio = -1;
     nNumer2 = #4#5;
     |BUCLE canempre;
|FPRC;

|PROCESO LeePlan;
     |C_M #2#3, 1, "S";

     aAlfa = #2#1;
     aAlfa = aAlfa % -102;

     |HAZ BuscaPeriodo;

     |SI perio = -1;  |ACABA;  |FINSI;

     |ABRE #400;
     |DDEFECTO #400;
     #400#0 = #408#2;
     #400#1 = #408#3;
     |LEE 000#400=;
     |SI FSalida = 0;
         eNum2008 = #400#2;
         #2#3     = eNum2008; |PINTA #2#3;
         |C_M #2#3, 1, "N";
     |FINSI;
     |CIERRA #400;
|FPRC;

|PROCESO DatosCuentas;
     |ESTADO_CONTROL nBoton2, "DISABLE";
     |ESTADO_CONTROL nBoton6, "DISABLE";

     |SI enTBal ! 1;  |ESTADO_CONTROL nBoton3, "ENABLE";  |FINSI;

     |ESTADO_CONTROL nBoton4, "ENABLE";
     |ESTADO_CONTROL nBoton5, "ENABLE";
     |ESTADO_CONTROL nBoton7, "ENABLE";

     aAlfa = #3#3;  |QBT aAlfa;
     |SI aAlfa ! "";  |Y #2#4 ! 20;  |Y #2#4 ! 21; |Y #2#4 ! 22;
                      |Y #2#4 ! 30;  |Y #2#4 ! 31; |Y #2#4 ! 32;
         |ESTADO_CONTROL nBoton6, "ENABLE";
     |FINSI;

     |C_M #2#3,  1, "N";
     |C_M #2#4,  1, "N";
     |C_M #2#5,  1, "N";
     |C_M #2#7,  1, "S";
     |C_M #2#8,  1, "S";
     |C_M #2#9,  1, "S";
     |C_M #2#10, 1, "S";
     |C_M #2#11, 1, "S";

     |ABRE #53;
     #53#0 = #2#0;
     #53#1 = #2#1;
     |LEE 040#53=;
     nError2 = FSalida;
     |SI FSalida ! 0;
         |ESTADO_CONTROL nBoton2, "ENABLE";
         |ESTADO_CONTROL nBoton3, "DISABLE";
         |ESTADO_CONTROL nBoton4, "DISABLE";
         |ESTADO_CONTROL nBoton5, "DISABLE";
         |ESTADO_CONTROL nBoton6, "DISABLE";
         |ESTADO_CONTROL nBoton7, "DISABLE";

         |HAZ LeePlan;
         |HAZ LeeBalanceD;

         |C_M #2#4,  1, "S";
         |C_M #2#5,  1, "S";
         |C_M #2#7,  1, "N";
         |C_M #2#8,  1, "N";
         |C_M #2#9,  1, "N";
         |C_M #2#10, 1, "N";
         |C_M #2#11, 1, "N";
     |SINO;
         #2#3 = #53#14;   |PINTA #2#3;
         #2#4 = #53#15;   |PINTA #2#4;
         #2#5 = #53#16;   |PINTA #2#5;
     |FINSI;
     |CIERRA #53;
|FPRC;

|PROCESO DatosContabilidad;
     |ESTADO_CONTROL nBoton1, "DISABLE";
     |ESTADO_CONTROL nBoton2, "DISABLE";
     |ESTADO_CONTROL nBoton3, "DISABLE";
     |ESTADO_CONTROL nBoton4, "DISABLE";
     |ESTADO_CONTROL nBoton5, "DISABLE";
     |ESTADO_CONTROL nBoton6, "DISABLE";
     |ESTADO_CONTROL nBoton7, "DISABLE";

     |C_M #2#3,  1, "N";
     |C_M #2#4,  1, "N";
     |C_M #2#5,  1, "N";
     |C_M #2#7,  1, "N";
     |C_M #2#8,  1, "N";
     |C_M #2#9,  1, "N";
     |C_M #2#10, 1, "N";
     |C_M #2#11, 1, "N";

     |ABRE #52;
     #52#0 = #2#0;
     #52#1 = #2#1;
     |LEE 040#52=;
     nError1 = FSalida;
     |SI FSalida ! 0;
         |ESTADO_CONTROL nBoton1, "ENABLE";
     |SINO;
          |HAZ DatosCuentas;
     |FINSI;
     |CIERRA #52;
|FPRC;

|PROCESO GetData;
     |REFERENCIA_DEF aGet1, #2;
     |PARA nCampo = 0;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
           |C_V #2nCampo, 0, aAlfa;
           |C_M #2nCampo, 0, aAlfa1;
           |SI aAlfa = "S"; |Y aAlfa1 = "S";
               aGet2 = nCampo;
               IaGet = aGet1<-;
               |ESPECIFICA "GETDATACONTROL", aGet;
               #2nCampo = FSalida;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Boton1Crea;
     aAlfa = #2#1;
     aAlfa = aAlfa % -102;

     |HAZ BuscaPeriodo;
     |SI perio = -1;  |ACABA;  |FINSI;

     |HAZ VentanaTrabajo;

     empAlta = empresa;
     empre   = #2#0;
     plani   = 1;
     siono   = "SI";
     |SUB_EJECUTA "soagico1;AUTO";

     |HAZ FinVentanaTrabajo;

     |SI enHay129 = 1;
         |MENAV "0000La Cta 129 tiene Saldo. Debe hacer la Distribucion Resultado antes del pase al Impuesto";
         |ACABA;
     |FINSI;

     |HAZ DatosContabilidad;

     |SI nError1 = 0;
         |MENAV "0000 Generados datos de contabilidad";
     |FINSI;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO Boton2Crea;

     |HAZ Tipo0C3Crea;
     |HAZ LeeBalance;
     |SI eTip2008 = 2;
         |SI enTBal = 1; |O enTBal = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar estos Balances";
             |ACABA;
         |FINSI;
     |FINSI;
     |HAZ LeeResultados;
     |SI eTip2008 = 2;
         |SI enTCta = 1; |O enTCta = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar esta Cta de Resultados";
             |ACABA;
         |FINSI;
     |FINSI;

     |CONFI "0000SHa introducido bien las estructuras";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ VentanaTrabajo;
     empresa   = #2#0;
     anyo      = #2#1;
     eNum2008  = #2#3;
     enTBal    = #2#4;
     enTCta    = #2#5;

     |SUB_EJECUTA "cuacceso;AUTO";

     |SI #1#1 ] 2012;
         |SI #2#15 = "C";
             |HAZ CogeDistrISCoop;
         |SINO;
             |HAZ CogeDistrIS;
         |FINSI;
     |FINSI;

     |HAZ FinVentanaTrabajo;

     |HAZ LeeBalance;
     |HAZ LeeResultados;
     |HAZ DatosCuentas;

     |SI nError2 = 0;
         |MENAV "0000 Generados datos en cuentas anuales";
     |FINSI;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO PorXbrl;
     |HAZ VentanaTrabajo;

     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";

     enEmpresa = #2#0;
     enAnyo    = #2#1;
     eaCampo3  = "N";
     eaCampo4  = "N";
     eaCampo5  = "N";
     eaCampo6  = "N";
     eaCampo7  = "N";
     eaCampo8  = "N";
     eaCampo9  = "N";
     eaCampo10 = "N";
     eaCampo11 = "P";
     eaCampo12 = "";

     |SUB_EJECUTA "zhazxbrl;AUTO";

     enAnyo = #2#1;
     |HAZ EjecutaDSFDF;

     |HAZ FinVentanaTrabajo;

     aAlfa = eaDirTrabajo + "wcuenta.fdf";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaOrigen       = aAlfa;
     eaDestino      = eaDirGuarda + "wcuenta.fdf";
     |HAZ RecibeFichero;

     |RFBORRA eaOrigen;

     |ABRE #800;
     #800#0 = #1#0;
     #800#1 = #1#1;
     |LEE 101#800=;
     |SI FSalida ! 0;
         |DDEFECTO #800;
         #800#0 = #1#0;
         #800#1 = #1#1;
         |GRABA 020#800b;
     |FINSI;

     #800#2 = #1#2;
     #800#3 = #1#5;
     #800#4 = #1#6;
     #800#5 = #1#9;
     #800#6 = #1#10;

     |GRABA 020#800a;
     |LIBERA #800;
     |CIERRA #800;

     |ABRE #801;
     #801#0 = #1#0;
     #801#1 = #1#1;
     #801#2 = "wcuenta.fdf";
     |LEE 101#801=;
     |SI FSalida ! 0;
         |DDEFECTO #801;
         #801#0 = #1#0;
         #801#1 = #1#1;
         #801#2 = "wcuenta.fdf";
         |GRABA 020#801b;
     |FINSI;

     #801#3 = "CUENTAS ANUALES";
     #801#4 = ~;
     |HORA aHora;
     #801#5 = aHora % 102;
     #801#6 = aHora % 402;

     |GRABA 020#801a;
     |LIBERA #801;
     |CIERRA #801;

     #1#3 = "S";
|FPRC;

|PROCESO Boton3Crea;
     enCoopera = 0;
     |SI #2#4 = 21;  |O #2#4 = 22;
      |O #2#4 = 31;  |O #2#4 = 32;
         enCoopera = 1;
     |FINSI;

     |SI #1#3 = "S";
         |CONFI "0000NLas cuentas anuales ya est n creadas, desea crearlas de nuevo";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |SI enCoopera = 0;
             |CONFI "0000SVamos a crear los datos en el documento PDF. Continuar";
         |SINO;
             |CONFI "0000SVamos a crear los datos en el documento WORD. Continuar";
         |FINSI;
     |FINSI;

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI enCoopera = 0;
         |HAZ PorXbrl;
     |SINO;
         |HAZ CreaCtasCoop;
     |FINSI;

     |MENAV "0000Las cuentas han sido creadas.";

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO DistResultadosAnt;
     aAlfa = "Distribuci¢n de resultados ejercicio " + nNumer2;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DBASE aMas;
     aMas = aMas + "def/zregdocu.mas";
     |CARGA_DEF aMas, imagen@;

     |ABRE #900;
     #900#0 = #1#0;
     #900#1 = #1#1 - 1;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #1#0;
         #900#1 = #1#1 - 1;
         #900#2 = #1#2;
         |GRABA 020#900b;
     |FINSI;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 16;
           #901nCampoD = #900nCampoH;
           #921nCampoD = #900nCampoH;
     |SIGUE;
     #921#12 = #921#12  + #921#6;
     #921#6  = 0;

     |ABRE #1802;
     |SELECT #3#1802;
     #1802#0  = #2#0;
     #1802#1  = #2#1 - 1;
     #1802#16 = 49500;
     |LEE 000#1802=;
     |SI FSalida ! 0;  |DDEFECTO #1802;  |FINSI;
     |CIERRA #1802;

     |SI #1802#7 > 0;
         #901#0 = #1802#7;
         #921#0 = #1802#7;
     |FINSI;

     |SI #2#1 ] 2017;
         |PINPA #0#921;
         |PINDA #0#921;
         |ENDATOS #1#921;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #900nCampoH = #921nCampoD;
             |SIGUE;
         |FINSI;
    |SINO;
         |PINPA #0#901;
         |PINDA #0#901;
         |ENDATOS #1#901;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #900nCampoH = #901nCampoD;
             |SIGUE;
         |FINSI;
     |FINSI;
     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |DESCARGA_DEF #900;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO DistResultados;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 16;
           #901nCampoD = #1nCampoH;
           #921nCampoD = #1nCampoH;
     |SIGUE;
     #921#12 = #921#12  + #921#6;
     #921#6  = 0;

     |ABRE #1802;
     |SELECT #3#1802;
     #1802#0  = #2#0;
     #1802#1  = #2#1;
     #1802#16 = 49500;
     |LEE 000#1802=;
     |SI FSalida ! 0;  |DDEFECTO #1802;  |FINSI;
     |CIERRA #1802;

     |SI #1802#7 > 0;
         #901#0 = #1802#7;
         #921#0 = #1802#7;
     |FINSI;

     |SI #2#1 ] 2017;
         |PINPA #0#921;
         |PINDA #0#921;
         |ENDATOS #1#921;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #1nCampoH = #921nCampoD;
             |SIGUE;
         |FINSI;
    |SINO;
         |PINPA #0#901;
         |PINDA #0#901;
         |ENDATOS #1#901;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #1nCampoH = #901nCampoD;
             |SIGUE;
         |FINSI;
     |FINSI;

     #1#13 = #2#10;
     #1#12 = #2#9;
     #1#68 = #2#11;
     #1#69 = #2#15;
     #1#15 = #2#16;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO DistResultadosAntCoop;
     aAlfa = "Distribuci¢n de resultados ejercicio " + nNumer2;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |DBASE aMas;
     aMas = aMas + "def/zregdocu.mas";
     |CARGA_DEF aMas, imagen@;

     |ABRE #900;
     #900#0 = #1#0;
     #900#1 = #1#1 - 1;
     |LEE 101#900=;
     |SI FSalida ! 0;
         |DDEFECTO #900;
         #900#0 = #1#0;
         #900#1 = #1#1 - 1;
         #900#2 = #1#2;
         |GRABA 020#900b;
     |FINSI;

     nSuma = #900#70 + #900#71 + #900#72 + #900#73 + #900#74 + #900#75 + #900#76 + #900#77 + #900#78;
     |SI nSuma = 0;
         #900#70 = #900#21;
         #900#71 = #900#24;
         #900#73 = #900#25;
         #900#74 = #900#26;
         #900#76 = #900#22 + #900#23 + #900#27 + #900#28;
         #900#78 = #900#70 + #900#71 + #900#72 + #900#73 + #900#74 + #900#75 + #900#76 + #900#77;
     |FINSI;

     #916#0  = #900#16;
     #916#1  = #900#17;
     #916#2  = #900#18;
     #916#3  = #900#19;
     #916#4  = #900#20;
     #916#5  = #900#70;
     #916#6  = #900#71;
     #916#7  = #900#72;
     #916#8  = #900#73;
     #916#9  = #900#74;
     #916#10 = #900#75;
     #916#11 = #900#76;
     #916#12 = #900#77;
     #916#13 = #900#78;

     |ABRE #1802;
     |SELECT #3#1802;
     #1802#0  = #2#0;
     #1802#1  = #2#1 - 1;
     #1802#16 = 49500;
     |LEE 000#1802=;
     |SI FSalida ! 0;  |DDEFECTO #1802;  |FINSI;
     |CIERRA #1802;

     |SI #1802#7 > 0;
         #916#0 = #1802#7;
     |FINSI;

     |PINPA #0#916;
     |PINDA #0#916;
     |ENDATOS #1#916;
     |SI FSalida = 0;
         #900#16 = #916#0;
         #900#17 = #916#1;
         #900#18 = #916#2;
         #900#19 = #916#3;
         #900#20 = #916#4;
         #900#70 = #916#5;
         #900#71 = #916#6;
         #900#72 = #916#7;
         #900#73 = #916#8;
         #900#74 = #916#9;
         #900#75 = #916#10;
         #900#76 = #916#11;
         #900#77 = #916#12;
         #900#78 = #916#13;
     |FINSI;

     |GRABA 020#900a;
     |LIBERA #900;
     |CIERRA #900;

     |DESCARGA_DEF #900;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO DistResultadosCoop;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #916#0  = #1#16;
     #916#1  = #1#17;
     #916#2  = #1#18;
     #916#3  = #1#19;
     #916#4  = #1#20;
     #916#5  = #1#70;
     #916#6  = #1#71;
     #916#7  = #1#72;
     #916#8  = #1#73;
     #916#9  = #1#74;
     #916#10 = #1#75;
     #916#11 = #1#76;
     #916#12 = #1#77;
     #916#13 = #1#78;

     |ABRE #1802;
     |SELECT #3#1802;
     #1802#0  = #2#0;
     #1802#1  = #2#1;
     #1802#16 = 49500;
     |LEE 000#1802=;
     |SI FSalida ! 0;  |DDEFECTO #1802;  |FINSI;
     |CIERRA #1802;

     |SI #1802#7 > 0;
         #916#0 = #1802#7;
     |FINSI;

     |PINPA #0#916;
     |PINDA #0#916;
     |ENDATOS #1#916;
     |SI FSalida = 0;
         #1#16 = #916#0;
         #1#17 = #916#1;
         #1#18 = #916#2;
         #1#19 = #916#3;
         #1#20 = #916#4;
         #1#70 = #916#5;
         #1#71 = #916#6;
         #1#72 = #916#7;
         #1#73 = #916#8;
         #1#74 = #916#9;
         #1#75 = #916#10;
         #1#76 = #916#11;
         #1#77 = #916#12;
         #1#78 = #916#13;
     |FINSI;

     #1#13 = #2#10;
     #1#12 = #2#9;
     #1#68 = #2#11;
     #1#69 = #2#15;
     #1#15 = #2#16;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO MenuMemoria2008;
     aPopup1  = nBoton4;
     aPopup2  = 17;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- Distribucion de resultados ";
     aPopup5  = "03.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias ";
     aPopup6  = "04.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup7  = "05.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup8  = "06.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup9  = "07.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup10 = "08.- (Manual)        Clasificacion por vencimientos";
     aPopup11 = "09.- (Automatico) Impuesto sobre beneficios";
     aPopup12 = "10.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup13 = "11.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup14 = "12.- (Manual)        Arrendamientos financieros";
     aPopup15 = "13.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup16 = "14.- (Manual)        Actuaciones medioambientales";
     aPopup17 = "15.- (Manual)        Personal de la sociedad";
     aPopup18 = "16.- Emitir la Memoria";
     aPopup19 = "17.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup      = aPopup3  <-;
              IaPopup      = IaPopup + (FSalida - 1);
              enEjerCuadro = #0#0;
              enEmpresa    = #2#0;

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;         |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultados;      |FINSI;
              |SI aAlfa = "03";  |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "04";  |SUB_EJECUTA "zregcu02";  |FINSI;
              |SI aAlfa = "05";  |SUB_EJECUTA "zregcu03";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu04";  |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu05";  |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu06";  |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu07";  |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu08";  |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu09";  |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu10";  |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu11";  |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu12";  |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu13";  |FINSI;
              |SI aAlfa = "16";  |HAZ CreaMemoria;  |SAL;  |FINSI;
              |SI aAlfa = "17";  |SAL;                     |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2009;
     aPopup1  = nBoton4;
     aPopup2  = 20;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup9  = "07.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup10 = "08.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup11 = "09.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup12 = "10.- (Manual)        Clasificacion por vencimientos";
     aPopup13 = "11.- (Automatico) Impuesto sobre beneficios";
     aPopup14 = "12.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup15 = "13.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup16 = "14.- (Manual)        Arrendamientos financieros";
     aPopup17 = "15.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup18 = "16.- (Manual)        Actuaciones medioambientales";
     aPopup19 = "17.- (Manual)        Personal de la sociedad";
     aPopup20 = "18.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup21 = "19.- Emitir la Memoria";
     aPopup22 = "20.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu08";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu09";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu11";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "19";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "20";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2010P;
     aPopup1  = nBoton4;
     aPopup2  = 21;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup17 = "15.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup18 = "16.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup19 = "17.- (Manual)        Personal de la sociedad";
     aPopup20 = "18.- (Manual)        Actuaciones medioambientales";
     aPopup21 = "19.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup22 = "20.- Emitir la Memoria";
     aPopup23 = "21.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu15";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu08";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu09";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu11";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "20";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "21";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2010A;
     aPopup1  = nBoton1;
     aPopup2  = 22;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup17 = "15.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup18 = "16.- (Manual)        Operaciones con partes vinculadas";
     aPopup19 = "17.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup20 = "18.- (Manual)        Personal de la sociedad";
     aPopup21 = "19.- (Manual)        Actuaciones medioambientales";
     aPopup22 = "20.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup23 = "21.- Emitir la Memoria";
     aPopup24 = "22.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup      = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu16";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu17";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu18";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu19";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu15";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu20";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu21";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu22";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu23";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "21";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "22";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2011P;
     aPopup1  = nBoton1;
     aPopup2  = 23;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Saldos con Administraciones Públicas";
     aPopup17 = "15.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup18 = "16.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup19 = "17.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup20 = "18.- (Manual)        Personal de la sociedad";
     aPopup21 = "19.- (Manual)        Actuaciones medioambientales";
     aPopup22 = "20.- (Manual)        Derechos de emision de gases de efecto invernadero";
     aPopup23 = "21.- (Automatico)  Reservas de revalorizacion";
     aPopup24 = "22.- Emitir la Memoria";
     aPopup25 = "23.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu08";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu09";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu11";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "21";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "22";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "23";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2011A;
     aPopup1  = nBoton1;
     aPopup2  = 24;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Saldos con Administraciones Públicas";
     aPopup17 = "15.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup18 = "16.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup19 = "17.- (Manual)        Operaciones con partes vinculadas";
     aPopup20 = "18.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup21 = "19.- (Manual)        Personal de la sociedad";
     aPopup22 = "20.- (Manual)        Actuaciones medioambientales";
     aPopup23 = "21.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup24 = "22.- (Automatico)  Reservas de revalorizacion";
     aPopup25 = "23.- Emitir la Memoria";
     aPopup26 = "24.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup      = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu16";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu17";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu18";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu19";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu20";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu21";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu22";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu23";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "21";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "22";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "23";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "24";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2011C;
     aPopup1  = nBoton1;
     aPopup2  = 26;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Fondos propios. Análisis del movimiento durante el ejercicio";
     aPopup16 = "14.- (Automatico) Fondo de educación, formación y promoción";
     aPopup17 = "15.- (Automatico) Impuesto sobre beneficios";
     aPopup18 = "16.- (Automatico) Saldos con Administraciones Públicas";
     aPopup19 = "17.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup20 = "18.- (Manual)        Separación de las partidas de la cuenta de perdidas y ganancias";
     aPopup21 = "19.- (Automatico) Detalle de subvenciones, donaciones y legados";
     aPopup22 = "20.- (Manual)        Sueldos, dietas y remuneraciones";
     aPopup23 = "21.- (Manual)        Personal de la sociedad";
     aPopup24 = "22.- (Manual)        Actuaciones medioambientales";
     aPopup25 = "23.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup26 = "24.- (Automatico)  Reservas de revalorizacion";
     aPopup27 = "25.- Emitir la Memoria";
     aPopup28 = "26.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAntCoop;            |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultadosCoop;               |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu26";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu25";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu08";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu27";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu09";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu11";               |FINSI;
              |SI aAlfa = "21";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "22";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "23";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "24";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "25";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "26";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2016P;
     aPopup1  = nBoton1;
     aPopup2  = 22;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Saldos con Administraciones Públicas";
     aPopup17 = "15.- (Manual)         Detalle de subvenciones, donaciones y legados";
     |SI #0#0 < 2017;
          aPopup18 = "16.- (Manual)        Sueldos, dietas y remuneraciones";
          aPopup19 = "17.- (Manual)        Personal de la sociedad";
     |SINO;
          aPopup18 = "16.- (Manual)        Importes recibidos personal alta direcci¢n y organos administracion";
          aPopup19 = "17.- (Manual)        Personal medio de la sociedad";
     |FINSI;
     aPopup20 = "18.- (Manual)       Actuaciones medioambientales";
     aPopup21 = "19.- (Manual)       Derechos de emision de gases de efecto invernadero";
     aPopup22 = "20.- (Automatico) Reservas de revalorizacion";
     aPopup23 = "21.- Emitir la Memoria";
     aPopup24 = "22.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "16";
                  |SI #0#0 < 2017;
                      |SUB_EJECUTA "zregcu11";
                  |SINO;
                      |SUB_EJECUTA "zregcu31";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "21";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "22";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2016A;
     aPopup1  = nBoton1;
     aPopup2  = 23;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Automatico) Saldos con Administraciones Públicas";
     aPopup17 = "15.- (Manual)        Detalle de subvenciones, donaciones y legados";
     aPopup18 = "16.- (Manual)        Operaciones con partes vinculadas";
     |SI #0#0 < 2017;
         aPopup19 = "17.- (Manual)        Sueldos, dietas y remuneraciones";
         aPopup20 = "18.- (Manual)        Personal de la sociedad";
     |SINO;
         aPopup19 = "17.- (Manual)        Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
         aPopup20 = "18.- (Manual)        Personal medio de la sociedad";
     |FINSI;
     aPopup21 = "19.- (Manual)        Actuaciones medioambientales";
     aPopup22 = "20.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup23 = "21.- (Automatico) Reservas de revalorizacion";
     aPopup24 = "22.- Emitir la Memoria";
     aPopup25 = "23.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup      = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu16";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu17";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu18";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu19";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu22";               |FINSI;
              |SI aAlfa = "17";
                  |SI #0#0 < 2017;
                      |SUB_EJECUTA "zregcu23";
                  |SINO;
                      |SUB_EJECUTA "zregcu31";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "20";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "21";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "22";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "23";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2016C;
     aPopup1  = nBoton1;
     aPopup2  = 26;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Activos finacieros a largo y corto plazo";
     aPopup10 = "08.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup11 = "09.- (Manual)        Empresas del grupo, multigrupo y asociadas";
     aPopup12 = "10.- (Automatico) Pasivos financieros a largo plazo y corto plazo";
     aPopup13 = "11.- (Manual)        Clasificacion por vencimientos";
     aPopup14 = "12.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup15 = "13.- (Automatico) Fondos propios. Análisis del movimiento durante el ejercicio";
     aPopup16 = "14.- (Automatico) Fondo de educación, formación y promoción";
     aPopup17 = "15.- (Automatico) Impuesto sobre beneficios";
     aPopup18 = "16.- (Automatico) Saldos con Administraciones Públicas";
     aPopup19 = "17.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup20 = "18.- (Manual)        Separación de las partidas de la cuenta de perdidas y ganancias";
     aPopup21 = "19.- (Manual)        Detalle de subvenciones, donaciones y legados";
     |SI #0#0 < 2017;
         aPopup22 = "20.- (Manual)        Sueldos, dietas y remuneraciones";
         aPopup23 = "21.- (Manual)        Personal de la sociedad";
     |SINO;
         aPopup22 = "20.- (Manual) Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
         aPopup23 = "21.- (Manual)        Personal medio de la sociedad";
     |FINSI;

     aPopup24 = "22.- (Manual)        Actuaciones medioambientales";
     aPopup25 = "23.- (Manual)        Derechos de emisión de gases de efecto invernadero";
     aPopup26 = "24.- (Automatico) Reservas de revalorizacion";
     aPopup27 = "25.- Emitir la Memoria";
     aPopup28 = "26.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAntCoop;            |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultadosCoop;               |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu02";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu04";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu05";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "12";
                  |SI #0#0 ] 2015;
                      |SUB_EJECUTA "zregcu29";
                  |SINO;
                      |SUB_EJECUTA "zregcu15";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu26";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu25";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu24";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu08";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu27";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "20";
                  |SI #0#0 < 2017;
                      |SUB_EJECUTA "zregcu11";
                  |SINO;
                      |SUB_EJECUTA "zregcu31";
                  |FINSI;
              |FINSI;
              |SI aAlfa = "21";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "22";  |SUB_EJECUTA "zregcu12";               |FINSI;
              |SI aAlfa = "23";  |SUB_EJECUTA "zregcu14";               |FINSI;
              |SI aAlfa = "24";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "25";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "26";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2018P;
     aPopup1  = nBoton1;
     aPopup2  = 18;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup10 = "08.- (Manual) Inversiones financieras valoradas a valor razonable ";
     aPopup11 = "09.- (Manual) Empresas del grupo, multigrupo y asociadas ";
     aPopup12 = "10.- (Manual) Clasificaci¢n por vencimientos ";
     aPopup13 = "11.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup14 = "12.- (Autom tico)  Reservas de revalorizacion";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Manual) Importes percibidos por el personal alta direcci¢n ";
     aPopup17 = "15.- (Autom tico) Personal medio de la sociedad";
     aPopup18 = "16.- (Manual) Detalle de subvenciones, donaciones y legados ";
     aPopup19 = "17.- Emitir la Memoria";
     aPopup20 = "18.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu32";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu33";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu29";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu31";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "17";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "18";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2018A;
     aPopup1  = nBoton1;
     aPopup2  = 19;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup10 = "08.- (Manual) Inversiones financieras valoradas a valor razonable ";
     aPopup11 = "09.- (Manual) Empresas del grupo, multigrupo y asociadas ";
     aPopup12 = "10.- (Manual)        Clasificacion por vencimientos";
     aPopup13 = "11.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup14 = "12.- (Automatico) Reservas de revalorizacion";
     aPopup15 = "13.- (Automatico) Impuesto sobre beneficios";
     aPopup16 = "14.- (Manual)        Operaciones con partes vinculadas";
     aPopup17 = "15.- (Manual)        Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
     aPopup18 = "16.- (Manual)        Personal medio de la sociedad";
     aPopup19 = "17.- (Manual)        Detalle de subvenciones, donaciones y legados";
     aPopup20 = "18.- Emitir la Memoria";
     aPopup21 = "19.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup      = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAnt;                |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultados;                   |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu16";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu32";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu33";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu29";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu22";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu31";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "18";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "19";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO MenuMemoria2018C;
     aPopup1  = nBoton1;
     aPopup2  = 21;
     aPopup3  = "01.- Carga automatica de los cuadros";
     aPopup4  = "02.- (A" + &0241 + "o anterior) Distribucion de resultados " + nNumer2;
     aPopup5  = "03.- Distribucion de resultados " + nNumer1;
     aPopup6  = "04.- (A" + &0241 + "o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2;
     aPopup7  = "05.- (Automatico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1;
     aPopup8  = "06.- (Manual)        Arrendamientos financieros";
     aPopup9  = "07.- (Automatico) Correcciones por deterioro de valor de activos a largo y corto plazo";
     aPopup10 = "08.- (Manual) Inversiones financieras valoradas a valor razonable ";
     aPopup11 = "09.- (Manual) Empresas del grupo, multigrupo y asociadas ";
     aPopup12 = "10.- (Manual)        Clasificacion por vencimientos";
     aPopup13 = "11.- (Automatico) Informacion sobre aplazamiento de pago efectuados a proveedores";
     aPopup14 = "12.- (Automatico) Fondos propios. Análisis del movimiento durante el ejercicio";
     aPopup15 = "13.- (Automatico) Reservas de revalorizacion";
     aPopup16 = "14.- (Automatico) Fondo de educación, formación y promoción";
     aPopup17 = "15.- (Automatico) Impuesto sobre beneficios";
     aPopup18 = "16.- (Manual)        Separación de las partidas de la cuenta de perdidas y ganancias";
     aPopup19 = "17.- (Manual) Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
     aPopup20 = "18.- (Manual)        Personal medio de la sociedad";
     aPopup21 = "19.- (Automatico) Detalle de la cuenta de perdidas y ganancias";
     aPopup22 = "20.- Emitir la Memoria";
     aPopup23 = "21.- Salir";

     |PARA;  |SI;  |HACIENDO;
          enEmpresa    = #2#0;
          enEjerCuadro = #0#0;

          IaPopup    = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 102;

              |SI aAlfa = "01";  |HAZ PaseCuadros;                      |FINSI;
              |SI aAlfa = "02";  |HAZ DistResultadosAntCoop;            |FINSI;
              |SI aAlfa = "03";  |HAZ DistResultadosCoop;               |FINSI;
              |SI aAlfa = "04";  enEjerCuadro = nNumer2; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "05";  enEjerCuadro = nNumer1; |SUB_EJECUTA "zregcu01";  |FINSI;
              |SI aAlfa = "06";  |SUB_EJECUTA "zregcu10";               |FINSI;
              |SI aAlfa = "07";  |SUB_EJECUTA "zregcu03";               |FINSI;
              |SI aAlfa = "08";  |SUB_EJECUTA "zregcu32";               |FINSI;
              |SI aAlfa = "09";  |SUB_EJECUTA "zregcu33";               |FINSI;
              |SI aAlfa = "10";  |SUB_EJECUTA "zregcu06";               |FINSI;
              |SI aAlfa = "11";  |SUB_EJECUTA "zregcu29";               |FINSI;
              |SI aAlfa = "12";  |SUB_EJECUTA "zregcu26";               |FINSI;
              |SI aAlfa = "13";  |SUB_EJECUTA "zregcu28";               |FINSI;
              |SI aAlfa = "14";  |SUB_EJECUTA "zregcu25";               |FINSI;
              |SI aAlfa = "15";  |SUB_EJECUTA "zregcu07";               |FINSI;
              |SI aAlfa = "16";  |SUB_EJECUTA "zregcu27";               |FINSI;
              |SI aAlfa = "17";  |SUB_EJECUTA "zregcu31";               |FINSI;
              |SI aAlfa = "18";  |SUB_EJECUTA "zregcu13";               |FINSI;
              |SI aAlfa = "19";  |SUB_EJECUTA "zregcu30";               |FINSI;
              |SI aAlfa = "20";  |HAZ CreaMemoria;  |SAL;               |FINSI;
              |SI aAlfa = "21";  |SAL;                                  |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;
|| *********************************************************************

|PROCESO Boton4Crea;
     eaTipoMemo = #2#15;

     nNumer1 = #0#0;
     nNumer2 = #0#0 - 1;

     |HAZ GetData;

     |SI #0#0 = 2008;  |HAZ MenuMemoria2008;  |FINSI;
     |SI #0#0 = 2009;  |HAZ MenuMemoria2009;  |FINSI;
     |SI #0#0 = 2010;
         |SI #2#15 = "P";  |HAZ MenuMemoria2010P;  |FINSI;
         |SI #2#15 = "A";  |HAZ MenuMemoria2010A;  |FINSI;
     |FINSI;

     |SI #0#0 ] 2011;  |Y #0#0 [ 2015;
         |SI #2#15 = "P";  |HAZ MenuMemoria2011P;  |FINSI;
         |SI #2#15 = "A";  |HAZ MenuMemoria2011A;  |FINSI;
         |SI #2#15 = "C";  |HAZ MenuMemoria2011C;  |FINSI;
     |FINSI;

     |SI #0#0 = 2016; |O #0#0 = 2017;
         |SI #2#15 = "P";  |HAZ MenuMemoria2016P;  |FINSI;
         |SI #2#15 = "A";  |HAZ MenuMemoria2016A;  |FINSI;
         |SI #2#15 = "C";  |HAZ MenuMemoria2016C;  |FINSI;
     |FINSI;

     |SI #0#0 ] 2018;
         |SI #2#15 = "P";  |HAZ MenuMemoria2018P;  |FINSI;
         |SI #2#15 = "A";  |HAZ MenuMemoria2018A;  |FINSI;
         |SI #2#15 = "C";  |HAZ MenuMemoria2018C;  |FINSI;
     |FINSI;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO Boton5Crea;
     |HAZ GetData;

     |HAZ CreaGestion;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO CreaDeposito;
     |CONFI "0000SVamos a crear los datos en el Registro Digital. Continuar";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     FSalida = 0;

     |SI #1#4 = "N";  |Y #1#8 = "N";
         |CONFI "0000NNo est  creado la Memoria ni el Informe de Gesti¢n. Continuar";
     |SINO;
         |SI #1#4 = "N";
             |CONFI "0000NNo est  creado la Memoria. Continuar";
         |FINSI;

         |SI #1#8 = "N";
             |CONFI "0000NNo est  creado el Informe de Gesti¢n. Continuar";
         |FINSI;
     |FINSI;

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ VentanaTrabajo;

     |SI #1#4 = "S";
         |HAZ MemoriaPDF;
     |FINSI;

     |SI #1#8 = "S";
         |HAZ GestionPDF;
     |FINSI;

     enEmpresa = #2#0;
     enAnyo    = #2#1;
     eaCampo3  = "N";
     eaCampo4  = "N";
     eaCampo5  = "N";
     eaCampo6  = "N";
     eaCampo7  = "N";
     eaCampo8  = "N";
     eaCampo9  = "N";
     eaCampo10 = "N";
     eaCampo11 = "S";
     eaCampo12 = #3#3;

     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 101#301=;
     |SI FSalida = 0;
         #301#90 = #2#7 - 1;
         |SI #1#4 = "S";  #301#90 = #1#6;   |FINSI;
         |SI #1#8 = "S";  #301#90 = #1#10;  |FINSI;
         |GRABA 020#301a;
         |LIBERA #301;
     |FINSI;
     |CIERRA #301;

     |SUB_EJECUTA "zhazxbrl;AUTO";

     |HAZ FinVentanaTrabajo;

     #1#14 = "S";
     #1#13 = #2#10;
     #1#12 = #2#9;
     #2#11 = "S";  |PINTA #2#11;
     #1#68 = #2#11;
     #1#69 = #2#15;
     #1#15 = #2#16;
|FPRC;

|PROCESO Boton6Crea;
     |HAZ GetData;

     aPopup1  = nBoton6;
     aPopup2  = 3;
     aPopup3  = "1.- Firmantes";
     aPopup4  = "2.- Crear datos en el deposito";
     aPopup5  = "3.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SI aAlfa = "1";  |HAZ FirmaCertificado;        |FINSI;
              |SI aAlfa = "2";  |HAZ CreaDeposito;     |SAL;  |FINSI;
              |SI aAlfa = "3";                         |SAL;  |FINSI;
          |FINSI;
     |SIGUE;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO zregfirm;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE zregfirm;
     #4#1;
     ;
     #2#0, #2#1, 01;
     #2#0, #2#1, 99;
     be;
     NULL, zregfirm;
|FIN;

|PROCESO PonCargo;
                        #4#9 = "ADMINISTRADOR";
     |SI #626#16 = 1;   #4#9 = "PRESIDENTE";     |FINSI;
     |SI #626#16 = 3;   #4#9 = "SECRETARIO";     |FINSI;
|FPRC;

|PROCESO agim0026;
     |SI nChequeo = 1;
         |SI nTipo = 1;
             aDni   = #626#3;
             aPresi = #626#4;  |QBF aPresi;
             |SI aPresi ! "";
                 aPresi = "Don/Do¤a " + aPresi;
             |FINSI;
         |FINSI;

         |ERROR10;
         |ACABA;
     |FINSI;

     |SI nTipo = 1;  |Y #2#10 = 10;
         |ABRE #4;
         #4#0   = #2#0;
         #4#1   = #2#1;
         #4#2   = 1;
         #4#3   = #626#3;
         #4#4   = "Don/Do¤a " + #626#4;
         #4#5   = #626#5;
         #4#6   = #626#6;
         #4#7   = #626#9;
         #4#8   = "U";
         |HAZ PonCargo;
         |GRABA 020#4n;
         |LIBERA #4;
         |CIERRA #4;

         |ERROR10;
         |ACABA;
     |FINSI;

     nContador = nContador + 1;

     |SI #626#16 = 3;
         #1#30 = "Secretario";
     |FINSI;

     |SI #626#13 = "U";
         #4#0   = #2#0;
         #4#1   = #2#1;
         #4#2   = nContador;
         #4#3   = #626#3;
         #4#4   = "Don/Do¤a " +  #626#4;
         #4#5   = #626#5;
         #4#6   = #626#6;
         #4#7   = #626#9;
         #4#8   = #626#13;
         |HAZ PonCargo;

         aNif1    = #626#3;
         aNombre1 = #626#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30  = "Administrador £nico";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #626#13 = "S";
         #4#0   = #2#0;
         #4#1   = #2#1;
         #4#2   = nContador;
         #4#3   = #626#3;
         #4#4   = "Don/Do¤a " +  #626#4;
         #4#5   = #626#5;
         #4#6   = #626#6;
         #4#7   = #626#9;
         #4#8   = #626#13;
         |HAZ PonCargo;

         aNif1    = #626#3;
         aNombre1 = #626#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30 = "Administrador solidario";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #626#13 = "C";
         #4#0 = #2#0;
         #4#1 = #2#1;
         #4#2 = nContador;
         #4#3 = #626#3;
         |SI nContador = 1;
             #4#4     = "Sres./as. " +  #626#4;

             aNif1    = #626#3;
             aNombre1 = #626#4;   |QBF aNombre1;
             |SI aNombre1 ! "";
                aNombre1 = "Don/Do¤a " + aNombre1;
             |FINSI;
         |SINO;
             #4#4   = #626#4;
         |FINSI;
         #4#5   = #626#5;
         #4#6   = #626#6;
         #4#7   = #626#9;
         #4#8   = #626#13;
         |HAZ PonCargo;
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30 = "Administradores mancomunados";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0026;
     #626#1;
     16, 13;
     #619#0, #619#1, 01, nTipo, aDTipo;
     #619#0, #619#1, 99, nTipo, aHTipo;
     ;
     NULL, agim0026;
|FIN;

|PROCESO agim0026_2;
     aAlfa = #626#17 < "";
     aAlfa = aAlfa - "interventor";
     |SI FSalida ! 0;
         aAlfa = #1#65;  |QBF aAlfa;
         |SI aAlfa = "";
             #1#64 = #626#3;
             #1#65 = "Don/Do¤a " + #626#4;
         |SINO;
             aAlfa = #1#67;  |QBF aAlfa;
             |SI aAlfa = "";
                 #1#66 = #626#3;
                 #1#67 = "Don/Do¤a " + #626#4;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0026_2;
     #626#1;
     ;
     #619#0, #619#1, 01;
     #619#0, #619#1, 99;
     ;
     NULL, agim0026_2;
|FIN;

|PROCESO agim0024;
     nContador = nContador + 1;
     |SI #624#18 = "U";
         #4#0  = #2#0;
         #4#1  = #2#1;
         #4#2   = nContador;
         #4#3   = #624#3;
         #4#4   = "Don/Do¤a " +  #624#4;
         #4#5   = #624#7;
         #4#6   = #624#8;
         #4#7   = #624#11;
         #4#8   = #624#18;
         #4#9   = "ADMINISTRADOR";

         aNif1    = #624#3;
         aNombre1 = #624#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30 = "Administrador £nico";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #624#18 = "S";
         #4#0  = #2#0;
         #4#1  = #2#1;
         #4#2   = nContador;
         #4#3   = #624#3;
         #4#4   = "Don/Do¤a " +  #624#4;
         #4#5   = #624#7;
         #4#6   = #624#8;
         #4#7   = #624#11;
         #4#8   = #624#18;
         #4#9   = "ADMINISTRADOR";

         aNif1    = #624#3;
         aNombre1 = #624#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30 = "Administrador solidario";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #624#18 = "C";
         #4#0  = #2#0;
         #4#1  = #2#1;
         #4#2  = nContador;
         #4#3 = #624#3;
         |SI nContador = 1;
             #4#4   = "Sres./as. " +  #624#4;

             aNif1    = #624#3;
             aNombre1 = #624#4;   |QBF aNombre1;
             |SI aNombre1 ! "";
                 aNombre1 = "Don/Do¤a " + aNombre1;
             |FINSI;
         |SINO;
             #4#4   = #624#4;
         |FINSI;
         #4#5   = #624#7;
         #4#6   = #624#8;
         #4#7   = #624#11;
         #4#8   = #624#18;
         #4#9   = "ADMINISTRADOR";
         |GRABA 020#4n;
         |LIBERA #4;

         aAlfa = #1#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #1#30 = "Administradores mancomunados";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #624#1;
     15, 18;
     #619#0, #619#1, 01, "A", aTipo;
     #619#0, #619#1, 99, "D", aTipo;
     ;
     NULL, agim0024;
|FIN;

|PROCESO CargaAutomatica;
     |ABRE #4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 1;
     |LEE 000#4];
     |SI FSalida = 0;  |Y  #4#0 = #2#0;  |Y #4#1 = #2#1;
         |CONFI "0000NYa se ha hecho la carga autom tica, quiere realizarla de nuevo";
         |SI FSalida ! 0;
            |CIERRA #4;
            |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #4;

     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 040#301=;
     |SI FSalida ! 0;  |DDEFECTO #301;  |FINSI;
     |CIERRA #301;

     |ABRE #619;
     #619#0 = #2#0;
     #619#1 = 99;
     |LEE 040#619];
     |SI FSalida = 0;
         |LEE 040#619a;
     |SINO;
         |LEE 040#619u;
     |FINSI;

     |SI FSalida ! 0;  |O #619#0 ! #2#0;
         |DDEFECTO #619;
     |FINSI;
     |CIERRA #619;

     #1#64    = "";
     #1#65    = "";
     #1#66    = "";
     #1#67    = "";
     aPresi   = "";
     aDni     = "";
     aNif1    = "";
     aNombre1 = "";

     |BUCLE zregfirm;

     |ABRE #4;

     nChequeo = 0;
     |SI #2#10 ! 10;  |Y #2#10 ! 11;  |Y #2#10 ! 12;
         nContador = 0;

                             aTipo = "U";  |BUCLE agim0024;
         |SI nContador = 0;  aTipo = "S";  |BUCLE agim0024;  |FINSI;
         |SI nContador = 0;  aTipo = "C";  |BUCLE agim0024;  |FINSI;

         |SI nContador = 0;
             nTipo = 3;   aDTipo  = " ";  aHTipo = "z"; |BUCLE agim0026;
             nTipo = 1;   aDTipo  = " ";  aHTipo = "z"; |BUCLE agim0026;

             |SI nContador = 0;
                 nTipo     = 7;
                                     aDTipo  = "U";  aHTipo = "U"; |BUCLE agim0026;
                 |SI nContador = 0;  aDTipo  = "S";  aHTipo = "S"; |BUCLE agim0026;  |FINSI;
                 |SI nContador = 0;  aDTipo  = "C";  aHTipo = "C"; |BUCLE agim0026;  |FINSI;
             |FINSI;

             |SI nContador = 0;
                 #4#0   = #2#0;
                 #4#1   = #2#1;
                 #4#2   = 1;
                 #4#3   = #301#78;
                 #4#4   = "Don/Do¤a " + #301#77;
                 #4#5   = #301#79;
                 #4#6   = #301#80;
                 #4#7   = #301#81;
                 #4#8   = "U";
                 #4#9   = "SECRETARIO";
                 aNombre1 = #301#77;   |QBF aNombre1;
                 |SI aNombre1 ! "";
                     aNombre1 = "Don/Do¤a " + aNombre1;
                 |FINSI;
                 aNif1    = #301#78;
                 |GRABA 020#4n;
                 |LIBERA #4;

                 #1#30  = "Secretario";
             |FINSI;
         |FINSI;
     |SINO;
        #4#0 = #2#0;
        #4#1 = #2#1;
        #4#2 = 2;
        #4#3 = #301#78;
        #4#4 = "Don/Do¤a " + #301#77;
        #4#5 = #301#79;
        #4#6 = #301#80;
        #4#7 = #301#81;
        #4#8 = "U";
        #4#9 = "SECRETARIO";
        aNombre1 = #301#77;   |QBF aNombre1;
        |SI aNombre1 ! "";
            aNombre1 = "Don/Do¤a " + aNombre1;
        |FINSI;
        aNif1    = #301#78;
        |GRABA 020#4n;
        |LIBERA #4;

        #1#30  = "Secretario";
     |FINSI;
     |CIERRA #4;

     aAlfa1 = #301#13;                                |QBF aAlfa1;
     aAlfa1 = aAlfa1 + ", " + #301#4 + " " + #301#5;  |QBF aAlfa1;
     aAlfa1 = aAlfa1 + ", n£mero " + #301#6;          |QBF aAlfa1;
     #1#31  = aAlfa1 % 150;
     #1#32  = aAlfa1 % 5150;

     aDTipo     = " ";
     aHTipo     = "z";
     nChequeo   = 1;
     nTipo      = 1;   |BUCLE agim0026;

     |SI aPresi ! "";
         #1#33  = aDni;
         #1#34  = aPresi;
     |SINO;
         #1#33  = aNif1;
         #1#34  = aNombre1;
     |FINSI;

     #1#35 = #301#78;

     aAlfa = #301#77;   |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = "Don/Do¤a " + aAlfa;
     |FINSI;
     #1#36 = aAlfa;

     #1#49 = #1#33;
     #1#50 = #1#34;
     #1#51 = #1#35;
     #1#52 = #1#36;

     |SI #301#32 ! "          ";
         eaAlfa = #301#32;
         |HAZ SacaFecha;
         #1#37 = eaAlfa;
     |SINO;
         #1#37 = "31 de Diciembre de " + #2#1;
     |FINSI;

     |SI #301#33 ! "          ";
         eaAlfa = #301#33;
         |HAZ SacaFecha;
         #1#40  = eaAlfa;
     |SINO;
         nNume  = #2#1 + 1;
         #1#40  = "30 de Marzo de " + nNume;
     |FINSI;

     |SI #301#83 ! "          ";
         eaAlfa = #301#83;
         |HAZ SacaFecha;
         #1#41 = eaAlfa;
     |SINO;
         nNume  = #2#1 + 1;
         #1#41  = "30 de Junio de " + nNume;
     |FINSI;

     #1#53 = #619#25;
     #1#54 = #619#59;

     |SI #2#10 ! 10;  |Y #2#10 ! 11;  |Y #2#10 ! 12;
         #1#42 = "TODOS";
         #1#43 = 100;
         #1#44 = 0;
         #1#45 = 100;
         #1#46 = "MAYORIA";
         #1#47 = 100;
         #1#48 = "   de            de ";
     |SINO;
         #1#48 = #1#41;
     |FINSI;

     |BUCLE agim0026_2;

     #1#38 = 1;
     |SI #1#6  ! 0;  #1#39 = #1#6;   |FINSI;
     |SI #1#10 ! 0;  #1#39 = #1#10;  |FINSI;

     |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 30;
           |SI nPantalla = 902;  #902nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 903;  #903nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 904;  #904nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 905;  #905nCampoD = #1nCampoH;  |FINSI;
     |SIGUE;

     |SI nPantalla = 902;  |PINDA #0#902;  |FINSI;
     |SI nPantalla = 903;  |PINDA #0#903;  |FINSI;
     |SI nPantalla = 904;  |PINDA #0#904;  |FINSI;
     |SI nPantalla = 905;  |PINDA #0#905;  |FINSI;
|FPRC;

|PROCESO PresentaCertificado;
     |SI nPantalla ! 905;
          |VENTANA 0501, 2799, -1, 16, "Datos certificado";
     |SINO;
          |VENTANA 0501, 3099, -1, 16, "Datos certificado";
     |FINSI;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 30;
           |SI nPantalla = 902;  #902nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 903;  #903nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 904;  #904nCampoD = #1nCampoH;  |FINSI;
           |SI nPantalla = 905;  #905nCampoD = #1nCampoH;  |FINSI;
     |SIGUE;

     |SI nPantalla = 905;
         #905#43 = #1#82;
         #905#44 = #1#83;
         #905#38 = #905#25 + #905#26;
         #905#39 = #905#27 + #905#28;
         #905#40 = #905#29 + #905#30;
         #905#41 = #905#31;
         #905#42 = #905#32 + #905#33;
     |FINSI;

     |SI nPantalla ! 905;
         |CONTROL_SIMPLE 0, "BOTON,{{197}} Carga automatica", 2702, 2720, CargaAutomatica;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}} Carga automatica", 3002, 3020, CargaAutomatica;
     |FINSI;
     nBotonCarga = FSalida;

     |SI nPantalla = 902;  |PINPA #0#902;  |PINDA #0#902;  |ENDATOS #1#902;  |FINSI;
     |SI nPantalla = 903;  |PINPA #0#903;  |PINDA #0#903;  |ENDATOS #1#903;  |FINSI;
     |SI nPantalla = 904;  |PINPA #0#904;  |PINDA #0#904;  |ENDATOS #1#904;  |FINSI;
     |SI nPantalla = 905;  |PINPA #0#905;  |PINDA #0#905;  |ENDATOS #1#905;  |FINSI;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 30;
               |SI nPantalla = 902;  #1nCampoH = #902nCampoD;  |FINSI;
               |SI nPantalla = 903;  #1nCampoH = #903nCampoD;  |FINSI;
               |SI nPantalla = 904;  #1nCampoH = #904nCampoD;  |FINSI;
               |SI nPantalla = 905;  #1nCampoH = #905nCampoD;  |FINSI;
         |SIGUE;
         |SI nPantalla = 905;
             #1#82 = #905#43;
             #1#83 = #905#44;
         |FINSI;

     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonCarga;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO DatosCertificado;
     |SI #1#6  ! 0;  nNume = #1#6;   |FINSI;
     |SI #1#10 ! 0;  nNume = #1#10;  |FINSI;
     |SI #1#11 = "S";
         |SI nNume ! #1#39;
             |CONFI "0000SSe ha modificado el total de p ginas en las cuentas anuales. Modifique el Certificado. Actualizar Campo S/N";
             |SI FSalida = 0;
                 #1#39 = nNume;
             |FINSI;
         |FINSI;
     |SINO;
          #1#39 = nNume;
     |FINSI;

     |SI #2#10 = 1;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 2;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 3;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 4;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 5;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 6;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 7;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 8;   nPantalla = 904;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 9;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #2#10 = 10;  nPantalla = 905;  |HAZ PresentaCertificado;  |FINSI;

     #1#13 = #2#10;
     #1#12 = #2#9;
     #1#68 = #2#11;
     #1#69 = #2#15;
     #1#15 = #2#16;
|FPRC;

|PROCESO Baja4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 1;
|FPRC;

|PROCESO Alta4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 99;
|FPRC;

|PROCESO Alta;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 99;
     |LEE 000#4];
     |SI FSalida = 0;
         |LEE 000#4a;
     |SINO;
         |LEE 000#4u;
     |FINSI;

     nLinea = 1;
     |SI FSalida = 0;  |Y  #4#0 = #2#0;  |Y  #4#1 = #2#1;
         nLinea = #4#2 + 1;
     |FINSI;

     |DDEFECTO #906;

     |VENTANA 0501, 1599, -1, 16, "Datos firmante";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#906;
     |PINDA #0#906;
     |ENDATOS #1#906;
     |SI FSalida = 0;
         #4#0 = #2#0;
         #4#1 = #2#1;
         #4#2 = nLinea;
         #4#3 = #906#3;
         #4#4 = #906#4;
         #4#5 = #906#5;
         #4#6 = #906#6;
         #4#7 = #906#7;
         #4#8 = #906#8;

         |SI #906#9 = "A";  #4#9 = "ADMINISTRADOR";  |FINSI;
         |SI #906#9 = "P";  #4#9 = "PRESIDENTE";     |FINSI;
         |SI #906#9 = "S";  #4#9 = "SECRETARIO";     |FINSI;

         |GRABA 020#4n;
         |LIBERA #4;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |LEE 101#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1599, -1, 16, "Datos firmante";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #906#3  = #4#3;
     #906#4  = #4#4;
     #906#5  = #4#5;
     #906#6  = #4#6;
     #906#7  = #4#7;
     #906#8  = #4#8;
     #906#9  = #4#9 % 101;

     |PINPA #0#906;
     |PINDA #0#906;
     |ENDATOS #1#906;
     |SI FSalida = 0;
         #4#3 = #906#3;
         #4#4 = #906#4;
         #4#5 = #906#5;
         #4#6 = #906#6;
         #4#7 = #906#7;
         #4#8 = #906#8;

         |SI #906#9 = "A";  #4#9 = "ADMINISTRADOR";  |FINSI;
         |SI #906#9 = "P";  #4#9 = "PRESIDENTE";     |FINSI;
         |SI #906#9 = "S";  #4#9 = "SECRETARIO";     |FINSI;

         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja;
     |LEE 101#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NSeguro que quiere borrar el firmante";
     |SI FSalida ! 0;  |LIBERA #4;  |ACABA;  |FINSI;

     |BORRA 020#4a;
     |LIBERA #4;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Evento4;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#4=;
         |SI FSalida = 0;
             |ESTADO_CONTROL nSubBoton2, "ENABLE";
             |ESTADO_CONTROL nSubBoton3, "ENABLE";
         |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO FirmaCertificado;
     |ABRE #4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 1;
     |LEE 000#4];
     |SI FSalida ! 0;  |O  #4#0 ! #2#0;  |O #4#1 ! #2#1;
         |HAZ CargaAutomatica;
     |FINSI;
     |CIERRA #4;

     |VENTANA 0501, 1799, -1, 16, "Firmantes del certificado";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 4 + 8 + 16 + 32 + 128;

     |ABRE #4;
     |LINEAL_SIMPLE #1#4, nRango, 0502, 1498, Baja4, Alta4, Evento4;
     nGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta ", 1564, 1574, Alta;
     nSubBoton1  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar ", 1576, 1586, Modificar;
     nSubBoton2  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 1588, 1598, Baja;
     nSubBoton3  = FSalida;

     |ESTADO_CONTROL nSubBoton2, "DISABLE";
     |ESTADO_CONTROL nSubBoton3, "DISABLE";

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #4;

     |FIN_CONTROL_WINDOWS nSubBoton1;
     |FIN_CONTROL_WINDOWS nSubBoton2;
     |FIN_CONTROL_WINDOWS nSubBoton3;

     |DESTRUYECONTROL nGrid;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Boton7Crea;
     |SI #2#10 = 0;
         |MENAV "0000Por favor introduzca un tipo de certificado.";
         |ACABA;
     |FINSI;

     |HAZ GetData;

     #1#13 = #2#10;
     #1#12 = #2#9;
     #1#68 = #2#11;
     #1#69 = #2#15;
     #1#15 = #2#16;

     aPopup1  = nBoton7;
     aPopup2  = 5;
     aPopup3  = "1.- Distribucion de resultados";
     aPopup4  = "2.- Datos del certificado";
     aPopup5  = "3.- Firmantes";
     aPopup6  = "4.- Emitir el certificado";
     aPopup7  = "5.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaPopup  = aPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aPopup;
          |SI FSalida ! 0;
              IaPopup  = aPopup3  <-;
              IaPopup  = IaPopup + (FSalida - 1);

              aAlfa = aPopup % 101;

              |SI aAlfa = "1";
                  |SI #2#15 ! "C";  |HAZ DistResultados;      |FINSI;
                  |SI #2#15 = "C";  |HAZ DistResultadosCoop;  |FINSI;
              |FINSI;

              |SI aAlfa = "2";  |HAZ DatosCertificado;        |FINSI;
              |SI aAlfa = "3";  |HAZ FirmaCertificado;        |FINSI;
              |SI aAlfa = "4";  |HAZ CreaCertificado;  |SAL;  |FINSI;
              |SI aAlfa = "5";  |SAL;  |FINSI;
          |FINSI;
     |SIGUE;

     |HAZ RefrescaLabel;
|FPRC;

|PROCESO VisualizaDeposito;
     |HAZ VentanaTrabajo;

     aAlfa = "cmd " + &34 + "/c START /WAIT " + #3#2;  |QBF aAlfa;
     aAlfa = aAlfa + &34;
     |RSYSTEM aAlfa;

     |HAZ FinVentanaTrabajo;
|FPRC;

|PROCESO LeeBalanceD;
    |ABRE #301;
    #301#0 = #2#0;
    #301#1 = #2#1;
    |LEE 041#301=;
    |SI FSalida = 0;
        #53#15 = #301#101;
        #53#16 = #301#102;
    |SINO;
        #53#15 = #619#87;
        #53#16 = #619#88;
    |FINSI;
    |CIERRA #301;
|FPRC;

|PROCESO LeeBalance;
     |ABRE #420;
     #420#0 = #2#4;
     |LEE 000#420=;
     enTBal = #420#2;
     |CIERRA #420
|FPRC;

|PROCESO LeeResultados;
     |ABRE #420;
     #420#0 = #2#5;
     |LEE 001#420=;
     enTCta = #420#2;
     |CIERRA #420
|FPRC;

|PROCESO Tipo0C3Crea; |TIPO 0;
     eNum2008 = #2#3;
     |ABRE #401;
     #401#0 = #2#3;
     |LEE 041#401=;
     eTip2008 = #401#3;
     |CIERRA #401;
|FPRC;

|PROCESO Tipo0C4Crea; |TIPO 0;
     |C_M #2#4, 0, aAlfa1;

     |HAZ LeeBalance;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;
     |SI eTip2008 = 2;
         |SI enTBal = 1; |O enTBal = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar estos Balances";
             |ERROR;
         |FINSI;
     |FINSI;

     |SI #1#4 = "N";
         |SI enTBal = 1;  #2#7 = 18;  |FINSI;
         |SI enTBal = 2;  #2#7 = 12;  |FINSI;
         |SI enTBal = 3;  #2#7 = 10;  |FINSI;
         |PINTA #2#7;
     |FINSI;
|FPRC;

|PROCESO Tipo0C5Crea; |TIPO 0;
     |C_M #2#5, 0, aAlfa1;

     |HAZ LeeResultados;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;
     |SI eTip2008 = 2;
         |SI enTCta = 1; |O enTCta = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar esta Cta de Resultados";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO DuplicaEmpresa;
     enEmpresa = #2#0;
     enAnyo    = #2#1;

     aPopup1  = 0;
     aPopup2  = 2;
     aPopup3  = "1.- Duplicar del ejercicio anterior";
     aPopup4  = "2.- De la ficha de sociedades";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;
         |SI aAlfa = "1";  |SUB_EJECUTA "maempr08";  |FINSI;
         |SI aAlfa = "2";  |SUB_EJECUTA "z0000010";  |FINSI;
     |FINSI;
     #51#0 = #2#0;

     #51#1 = #2#1;
     |LEE 040#51=;
     |SI FSalida ! 0;
          nError = 1;
     |FINSI;
|FPRC;

|PROCESO LeeEmpresa;
     #1#0 = #2#0;
     #1#1 = #2#1;
     |LEE 000#1=;
     |SI FSalida = 0;
         |MENAV  "0000La empresa ya ha sido abierta.";
         nError = 1;
         |ACABA;
     |FINSI;

     |ABRE #628;
     #628#0 = #2#0;
     |LEE 040#628=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa en la Ficha de Sociedades";
         nError = 1;
         |CIERRA #628;
         |ACABA;
     |FINSI;
     |CIERRA #628;

     #2#2 = #628#2;

     |ABRE #51;
     #51#0 = #2#0;
     #51#1 = #2#1;
     |LEE 040#51=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa con el Ejercicio seleccionado";
         |CONFI "2400NDesea crearla";
         |SI FSalida = 0;
             |HAZ DuplicaEmpresa;
         |SINO;
             nError = 1;
         |FINSI;
     |FINSI;
     |CIERRA #51;
|FPRC;

|PROCESO Tipo7C3;  |TIPO 7;
     |SI nBotonSal ! -1;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBoton1, "DISABLE";

     |HAZ DatosContabilidad;

     |SI #2#6 = "01.01.0000";
         #2#6 = ~;
     |FINSI;

     |HAZ RefrescaLabel;

     aQueBoton = "|X000";
     aID       = #2#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     aQueBoton = "|X001";
     aID       = #2#aQueBoton#;
     nBoton    = aID;
     |ESTADO_CONTROL nBoton, "HIDE";

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2888, 2898, BotonSalir;
     nBotonSal = FSalida;
|FPRC;

|PROCESO CogeDistrIS;
      |ABRE #100;
      #100#0 = #2#0;
      #100#1 = #2#1;
      |LEE 041#100=;
      |SI FSalida = 0;
          #1#16 = #100#84;
          #1#17 = #100#85;
          #1#18 = #100#86;
          #1#19 = #100#87;
          #1#20 = #100#88;

          #1#21 = #100#89;
          #1#22 = #100#90;
          #1#23 = #100#91;
          #1#24 = #100#92;
          #1#25 = #100#94 + #100#95;
          #1#26 = #100#104;
          #1#27 = #100#102;
          #1#28 = #100#93 + #100#96  + #100#97  + #100#98  + #100#99;
          #1#28 = #1#28 + #100#100 + #100#101 + #100#103;
          #1#28 = #1#28 + #100#125 + #100#126;
          #1#29 = #100#105;
      |FINSI;
      |LIBERA #100;
      |CIERRA #100;
|FPRC;

|PROCESO CogeDistrISCoop;
      |ABRE #100;
      #100#0 = #2#0;
      #100#1 = #2#1;
      |LEE 041#100=;
      |SI FSalida = 0;
          #1#16 = #100#84;
          #1#17 = #100#85;
          #1#18 = #100#86;
          #1#19 = #100#87;
          #1#20 = #100#88;

          #1#21 = #100#97;
          #1#22 = #100#92;
          #1#23 = #100#91;
          #1#24 = #100#98;
          #1#25 = #100#104;
          #1#26 = #100#103;
          #1#27 = #100#102;
          #1#29 = #100#105;
      |FINSI;
      |LIBERA #100;
      |CIERRA #100;
|FPRC;

|PROCESO PonColor;
     #zregdocu#79 = "";

     |ABRE #sodacoca;
     #sodacoca#0 = #zregdocu#0;
     #sodacoca#1 = #zregdocu#1;
     |LEE 000#sodacoca.=;
     nError1 = FSalida;
     |CIERRA #sodacoca;

     |ABRE #cuacceso;
     #cuacceso#0 = #zregdocu#0;
     #cuacceso#1 = #zregdocu#1;
     |LEE 000#53=;
     nError2 = FSalida;
     |CIERRA #53;

     |SI nError1 ! 0;  |ACABA;  |FINSI;
     |SI nError2 ! 0;  |ACABA;  |FINSI;

     |SI #zregdocu#4 = "N";
         #zregdocu#79 = eaRojo;
     |FINSI;

     |SI #zregdocu#3 = "N";  |Y #zregdocu#14 = "N";
         #zregdocu#79 = eaRojo;
     |FINSI;

     |SI #zregdocu#3 = "S";  |O #zregdocu#14 = "S";
         #zregdocu#79 = eaAzul;

         |SI #zregdocu#11 = "S";
             #zregdocu#79 = eaVerde;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO zhazcrea;
     nBotonSal = -1;
     nLabel1   = -1;
     nLabel2   = -1;
     nLabel3   = -1;
     nLabel4   = -1;
     nLabel5   = -1;

     |DDEFECTO #2;

     #2#0 = #1#0;
     #2#1 = #1#1;

     |SI enModo = 1;
         |ABRE #628;
         #628#0 = 1;
         |LEE 000#628=;
         |CONSULTA_CLAVE #1#628;
         |SI FSalida ! 0;  |CIERRA #628; |ACABA;  |FINSI;
         |CIERRA #628;

         nError = 0;
         #2#0   = #628#0;
         #2#1   = #0#0;
         |HAZ LeeEmpresa;
         |SI nError ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     #1#0 = #2#0;
     #1#1 = #2#1;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #2#0;
         #1#1 = #2#1;
         #1#2 = #2#2;

         |SI #2#1 = 2008;
             |ABRE #54;
             #54#0 = #2#0;
             |LEE 000#54=;
             |SI FSalida = 0;
                 |SI #54#123 = 0;   #1#13 = 10;  |FINSI;
                 |SI #54#123 = 1;   #1#13 = 4;   |FINSI;
                 |SI #54#123 = 2;   #1#13 = 5;   |FINSI;
                 |SI #54#123 = 3;   #1#13 = 6;   |FINSI;
                 |SI #54#123 = 4;   #1#13 = 10;  |FINSI;
                 |SI #54#123 = 5;   #1#13 = 8;   |FINSI;
                 |SI #54#123 = 6;   #1#13 = 9;   |FINSI;
                 |SI #54#123 = 7;   #1#13 = 1;   |FINSI;
                 |SI #54#123 = 8;   #1#13 = 2;   |FINSI;
                 |SI #54#123 = 9;   #1#13 = 3;   |FINSI;
             |FINSI;
             |CIERRA #54;
         |FINSI;

         |SI #2#1 ] 2009;
             nTipoCert = 0;

             #1#0 = #2#0;
             #1#1 = #2#1 - 1;
             |LEE 000#1=;
             |SI FSalida = 0;
                 nTipoCert = #1#13;
             |FINSI;

             |DDEFECTO #1;
             #1#0  = #2#0;
             #1#1  = #2#1;
             #1#2  = #2#2;
             #1#13 = nTipoCert;
         |FINSI;

         |SI #1#1 ] 2012;
             |SI #2#15 = "C";
                |HAZ CogeDistrISCoop;
             |SINO;
                 |HAZ CogeDistrIS;
             |FINSI;
         |FINSI;

         |GRABA 020#1b;
     |FINSI;

     |ABRE #53;
     #53#0 = #2#0;
     #53#1 = #2#1;
     |LEE 040#53=;
     |SI FSalida ! 0;
         |DDEFECTO #53;
         #53#0 = #2#0;
         #53#1 = #2#1;
         |HAZ LeePlan;
         |HAZ LeeBalanceD;
     |FINSI;
     |CIERRA #53;

     #2#3 = #53#14;   |PINTA #2#3;
     #2#4 = #53#15;   |PINTA #2#4;
     #2#5 = #53#16;   |PINTA #2#5;

     |HAZ LeeBalance;
     |SI #1#4 = "N";
         |SI enTBal = 1;  #1#5 = 18;  |FINSI;
         |SI enTBal = 2;  #1#5 = 12;  |FINSI;
         |SI enTBal = 3;  #1#5 = 10;  |FINSI;
     |FINSI;

     #2#0  = #1#0;
     #2#1  = #1#1;
     #2#2  = #1#2;
     #2#6  = #1#7;
     #2#7  = #1#5;
     #2#8  = #1#9;
     #2#9  = #1#12;
     #2#10 = #1#13;

     |SI #1#68 = " ";
         aAlfa = #1#15;  |QBF aAlfa;
         |SI aAlfa ! "";
             #1#68 = "S";
         |FINSI;

         |SI #1#68 = " ";
             |SI #0#0 ] 2009;
                 |SI #1#14 = "S";
                     #1#68 = "S";
                 |FINSI;
             |SINO;
                 #1#68 = "N";
             |FINSI;
         |FINSI;
     |FINSI;

     |C_M #2#15, 1, "S";
     |SI #0#0 [ 2009;
         #1#69 = "P";
         |C_M #2#15, 1, "N";
     |FINSI;

     #2#11  = #1#68;
     #2#15  = #1#69;
     #2#16  = #1#15;

     |SI #2#11 = " ";   #2#11 = "N";  |FINSI;

     aAlfa = (("00000" + #2#0) % -105) + " - " + #2#2;  |QBF aAlfa;
     aAlfa = aAlfa + "    EJERCICIO: " + #2#1;

     enEjercicio = #2#1;
     |HAZ CogeMac;

     |ABRE #3;
     #3#0 = #2#1;
     #3#1 = eaDSMAC;
     |LEE 000#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |CIERRA #3;

     |VENTANA 0501, 2899, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#2;
     nPanta = FSalida;

     || Creacion automatica de contabilidad
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 0688, 0698, Boton1Crea;
     nBoton1 = FSalida;

     || Creacion automatica de datos en cuentas anuales
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 0988, 0998, Boton2Crea;
     nBoton2 = FSalida;

     || Creacion documentos cuentas anuales para su presentación en papel
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 2288, 2298, Boton3Crea;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,VISUALIZAR", 2388, 2398, VisualizaCuentas;
     nBoton13 = FSalida;

     ||Creacion documento de la Memoria
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 1288, 1298, Boton4Crea;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,VISUALIZAR", 1388, 1398, VisualizaMemoria;
     nBoton14 = FSalida;

     ||Creacion documento Informe de Gestion
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 1688, 1698, Boton5Crea;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,VISUALIZAR", 1788, 1798, VisualizaGestion;
     nBoton15 = FSalida;

     ||Exportacion de datos al Deposito Digital
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 1988, 1998, Boton6Crea;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,VISUALIZAR", 2088, 2098, VisualizaDeposito;
     nBoton16 = FSalida;

     ||Creacion documento Certificado
     |CONTROL_SIMPLE nPanta, "BOTON,CREACION", 2588, 2598, Boton7Crea;
     nBoton7 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,VISUALIZAR", 2688, 2698, VisualizaCertificado;
     nBoton17 = FSalida;

     |ESTADO_CONTROL nBoton1,   "DISABLE";
     |ESTADO_CONTROL nBoton2,   "DISABLE";
     |ESTADO_CONTROL nBoton3,   "DISABLE";
     |ESTADO_CONTROL nBoton4,   "DISABLE";
     |ESTADO_CONTROL nBoton5,   "DISABLE";
     |ESTADO_CONTROL nBoton6,   "DISABLE";
     |ESTADO_CONTROL nBoton7,   "DISABLE";

     |ESTADO_CONTROL nBoton13,  "DISABLE";
     |ESTADO_CONTROL nBoton14,  "DISABLE";
     |ESTADO_CONTROL nBoton15,  "DISABLE";
     |ESTADO_CONTROL nBoton16,  "DISABLE";
     |ESTADO_CONTROL nBoton17,  "DISABLE";

     |PINDA #0#2;
     |ENDATOS #1#2;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;

     |FIN_CONTROL_WINDOWS nBoton13;
     |FIN_CONTROL_WINDOWS nBoton14;
     |FIN_CONTROL_WINDOWS nBoton15;
     |FIN_CONTROL_WINDOWS nBoton16;
     |FIN_CONTROL_WINDOWS nBoton17;

     |PULSATECLA;

     |FINVENTANA nVent;

     #1#69 = #2#15;
     #1#15 = #2#16;

     |HAZ PonColor;

     |GRABA 020#1a;
     |LIBERA #1;

     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 101#301=;
     |SI FSalida = 0;
         #301#90 = #2#7 - 1;
         |SI #1#4 = "S";  #301#90 = #1#6;   |FINSI;
         |SI #1#8 = "S";  #301#90 = #1#10;  |FINSI;
         |GRABA 020#301a;
         |LIBERA #301;
     |FINSI;
     |CIERRA #301;
|FPRC;
