|FICHEROS;
     isow0011;

     maempr11;
|FIN;

|VARIABLES;
     nSuma1  = 0;
     nSuma2  = 0;
     n19     = 0;
     nTope   = 0;
     nPorce2 = 0;
     nValor1 = 0;
     nValor2 = 0;

     &enEmpresa = 0;
     &enAnyo    = 0;
|FIN;

|PROCESO Tipo12w11;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     nSuma1 = (#isow0011#1 - #isow0011#2) ! 2;
     nSuma2 = (#isow0011#11 + #isow0011#22 - #isow0011#12 - #isow0011#23) ! 2;
     |SI nSuma1 ! nSuma2;
         |MENAV "0000 Descuadrado. Aumentos - Disminuciones distinto (C7 + E7 - C8 - E8)";
         |ERROR;
         |ACABA;
     |FINSI;

     nSuma1 = (#isow0011#16 + #isow0011#26) ! 2;
     nSuma2 = #isow0011#6 ! 2;
     |SI nSuma1 ! nSuma2;
         |MENAV "0000 Descuadrado. 553 + 554 = 552";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Totalw11;  |TIPO 0;
     n19   = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  n19 = 1;  |FINSI;
     |CIERRA #maempr11;

     #isow0011#10 = #isow0011#7  - #isow0011#8  - #isow0011#9  - #isow0011#31;
     #isow0011#21 = #isow0011#17 - #isow0011#18 - #isow0011#19 - #isow0011#32 + #isow0011#20;

     |SI #isow0011#11 = 0; |Y #isow0011#22 = 0;  |Y Campo ! 11;
         #isow0011#11 = #isow0011#1;
     |FINSI;

     |SI #isow0011#12 = 0; |Y #isow0011#23 = 0;  |Y Campo ! 12;
         #isow0011#12 = #isow0011#2;
     |FINSI;

     |SI #isow0011#13 = 0; |Y #isow0011#24 = 0;  |Y Campo ! 13;
         #isow0011#13 = #isow0011#3;
     |FINSI;

     #isow0011#14 = #isow0011#4;

     |SI #isow0011#15 = 0; |Y #isow0011#25 = 0;  |Y Campo ! 15;
         #isow0011#15 = #isow0011#5;
     |FINSI;

     #isow0011#24 = #isow0011#3 - #isow0011#13;
     #isow0011#25 = #isow0011#5 - #isow0011#15;

     #isow0011#16 = #isow0011#10 + #isow0011#11 - #isow0011#12 - #isow0011#13 + #isow0011#14 + #isow0011#15;
     #isow0011#26 = #isow0011#21 + #isow0011#22 - #isow0011#23 - #isow0011#24 + #isow0011#25;

     |SI enAnyo [ 2014;
         |SI n19 = 0;
             nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
         |SINO;
             nTope = 120202.41;
             |SI #isow0011#16 [ nTope;
                 nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
             |SINO;
                 |SI enAnyo [ 2014;
                                             nPorce2 = 0;
                     |SI #isow0011#27 = 20;  nPorce2 = 25;  |FINSI;
                     |SI #isow0011#27 = 25;  nPorce2 = 30;  |FINSI;
                     |SI #isow0011#27 = 30;  nPorce2 = 30;  |FINSI;
                 |FINSI;

                 |SI enAnyo [ 2015;
                                             nPorce2 = 0;
                     |SI #isow0011#27 = 20;  nPorce2 = 25;  |FINSI;
                     |SI #isow0011#27 = 25;  nPorce2 = 28;  |FINSI;
                     |SI #isow0011#27 = 30;  nPorce2 = 28;  |FINSI;
                 |FINSI;

                 |SI nPorce2 ! 0;
                     nValor1 = ((nTope % #isow0011#27) + ((#isow0011#16 - nTope) % nPorce2)) ! 3;
                 |SINO;
                     nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo ] 2015;
         nValor1 = (#isow0011#16 % #isow0011#27) ! 3;
     |FINSI;

     nValor2 = (#isow0011#26 % #isow0011#29) ! 3;

     #isow0011#28 = nValor1;
     #isow0011#30 = nValor2;

     |PINTA #isow0011#10;
     |PINTA #isow0011#11;
     |PINTA #isow0011#12;
     |PINTA #isow0011#13;
     |PINTA #isow0011#15;
     |PINTA #isow0011#21;
     |PINTA #isow0011#22;
     |PINTA #isow0011#23;
     |PINTA #isow0011#24;
     |PINTA #isow0011#25;
     |PINTA #isow0011#16;
     |PINTA #isow0011#26;
     |PINTA #isow0011#28;
     |PINTA #isow0011#30;
|FPRC;
