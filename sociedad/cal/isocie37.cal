|FICHEROS;
   isocie37 #0;
   isocie36 #1;
   isocie46 #2;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &anyo      = 0;
   &modo      = 0;
   &modelito  = 0;

   FEstado    = 0;
|FIN;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 99;
|FRUT;

|PROGRAMA;
|PINPA #0#0;
|SI modo = 1;
    |ENTLINEAL #1#0,3,1,14,0,inferior,superior;
    |HAZ liquidacio;
|FINSI;
|SI modo = 2;
    |ENTLINEAL #1#0,3,2,14,0,inferior,superior;
    |HAZ liquidacio;
|FINSI;
|SI modo = 4;
    |ENTLINEAL #1#0,3,4,14,0,inferior,superior;
|FINSI;
|FPRO;

|PROCESO tipo;
|SI anyo [ 1993;
    |SI #0#3 = 3; |O #0#3 = 4;
        |MENAV "    Solo para Impuestos superiores al a¤o 1993";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO calcular_1;
|SI #0#3 = 1; #1#27 = #1#27 + ((#0#6 - #0#7) % #0#5); |FINSI;
|SI #0#3 = 2; #1#28 = #1#28 + ((#0#6 - #0#7) % #0#5); |FINSI;
|FPRC;

|PROCESO calcular_2;
|SI #0#3 = 1; #2#30 = #2#30 + ((#0#6 - #0#7) % #0#5); |FINSI;
|SI #0#3 = 2; #2#31 = #2#31 + ((#0#6 - #0#7) % #0#5); |FINSI;
|SI #0#3 = 3; #2#28 = #2#28 + ((#0#6 - #0#7) % #0#5); |FINSI;
|SI #0#3 = 4; #2#29 = #2#29 + ((#0#6 - #0#7) % #0#5); |FINSI;
|FPRC;

|DEFBUCLE isocie37_1;
#0#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, calcular_1;
|FIN;

|DEFBUCLE isocie37_2;
#0#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, calcular_2;
|FIN;

|PROCESO liquidacio;
|SI anyo [ 1993;
    |ABRE #1;
    #1#0 = empresa;
    #1#1 = anyo;
    |LIBERA #1;
    |LEE 110#1=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #1; #1#0 = empresa; #1#1 = anyo; |FINSI;

    #1#27 = 0;
    #1#28 = 0;
    |BUCLE isocie37_1;

    |SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
    |CIERRA #1;

    |SUB_EJECUTA "ispant31.run";
|SINO;
    |SI anyo [ 1995;  |SUB_EJECUTA "isz00005.run";  |FINSI;
|FINSI;
|FPRC;
