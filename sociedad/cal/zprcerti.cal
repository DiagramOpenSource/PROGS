|FICHEROS;
     zhazdocu #0;
     zregdocu #1;
     zregfirm #4;
     zregcu12 #17;
     zhazcrea #2,MANTE;
     maempr01 #301;
     megwordc #800;
     megwordl #801;

     :/agicli/def/agim0019 #619;

     cubal802 #1802;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aAlfa4           = "";
     aIPRemoto        = "";
     aHora            = "";
     aAnyo            = "";

     nNume            = 0;
     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nAmbiente        = 0;
     nSecre           = 0;
     nResto           = 0;
     nLineaTabla      = 0;
     nLinea           = 0;

     &enUltCert       = 0;
     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &eaFichero       = "";
     &enTBal          = 0;
     &enTCta          = 0;
|FIN;

|PROCESO zregfirmI;
     |SI nSwContar = 0;
         nContador1 = nContador1 + 1;

         |SI #4#9 = "SECRETARIO               ";
             nSecre = 1;
         |FINSI;

         |ACABA;
     |FINSI;

     nContador2 = nContador2 + 1;

     nResto     = (nContador2 $ 2) ! 2;
     |SI nResto ! 0;  |Y nContador2 ! 1;
         eaAsigna    = "T}10}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna    = "T}10}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna    = "T}10}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna    = "T}10}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nLineaTabla = nLineaTabla + 2;

         nLinea      = nLineaTabla + 1;
         eaConten = " "; eaAsigna  = "T}10}" + nLinea + "}1}";  |HAZ GrabaContenido;
         eaConten = " "; eaAsigna  = "T}10}" + nLinea + "}2}";  |HAZ GrabaContenido;

         nLinea  = nLineaTabla + 2;
         eaConten = " "; eaAsigna  = "T}10}" + nLinea + "}1}";  |HAZ GrabaContenido;
         eaConten = " "; eaAsigna  = "T}10}" + nLinea + "}2}";  |HAZ GrabaContenido;
     |FINSI;

     nLinea      = nLineaTabla + 1;

     |SI nResto ! 0;
         eaAsigna    = "T}10}" + nLinea + "}1}";
     |SINO;
         eaAsigna    = "T}10}" + nLinea + "}2}";
     |FINSI;

     eaConten = #4#9;   |QBF eaConten;
     |HAZ QuitaRarosDSXML;
     |HAZ GrabaContenido;

     nLinea      = nLineaTabla + 2;

     |SI nResto ! 0;
         eaAsigna    = "T}10}" + nLinea + "}1}";
     |SINO;
         eaAsigna    = "T}10}" + nLinea + "}2}";
     |FINSI;

     eaConten = #4#4 - "Sres./as. ";
     eaConten = eaConten - "Don/Do¤a ";   |QBF eaConten;
     |HAZ QuitaRarosDSXML;
     |HAZ GrabaContenido;

     |SI #4#9 = "SECRETARIO               ";
         aAlfa1  = #4#4;                         |QBF aAlfa1;
         aAlfa1  = aAlfa1 + ", con NIF " + #4#3; |QBF aAlfa1;
     |FINSI;

     |SI nContador2 = 1;
         aAlfa  = #4#4;                          |QBF aAlfa;

         |SI nSecre = 0;
             aAlfa1  = #4#4;                         |QBF aAlfa1;
             aAlfa1  = aAlfa1 + ", con NIF " + #4#3; |QBF aAlfa1;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI nContador2 = nContador1;
         aAlfa  = aAlfa  +  " y " + #4#4;  |QBF aAlfa;

         |SI nSecre = 0;
             aAlfa1 = aAlfa1  +  " y " + #4#4;         |QBF aAlfa1;
              aAlfa1 = aAlfa1  +  ", con NIF " + #4#3;  |QBF aAlfa1;
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa  = aAlfa  + ", " + #4#4;                 |QBF aAlfa;

     |SI nSecre = 0;
         aAlfa1 = aAlfa1  + ", " + #4#4;                |QBF aAlfa1;
         aAlfa1 = aAlfa1  +  ", con NIF " + #4#3;       |QBF aAlfa1;
     |FINSI;
|FPRC;

|DEFBUCLE zregfirmI;
     #4#1;
     ;
     #2#0, #2#1, 01;
     #2#0, #2#1, 99;
     ;
     NULL, zregfirmI;
|FIN;

|PROCESO CargaVarCertif;
     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 040#301=;
     |SI FSalida ! 0;  |DDEFECTO #301;  |FINSI;
     |CIERRA #301;

     |ABRE #agim0019;
     #agim0019#0 = #zhazcrea#0;
     #agim0019#1 = 99;
     |LEE 040#agim0019.];
     |SI FSalida = 0;
         |LEE 040#agim0019.a;
     |SINO;
         |LEE 040#agim0019.u;
     |FINSI;
     |SI FSalida ! 0;  |O #agim0019#0 ! #zhazcrea#0;
         |DDEFECTO #agim0019;
     |FINSI;
     |CIERRA #agim0019;

     aAlfa       = "";
     aAlfa1      = "";
     nContador1  = 0;
     nContador2  = 0;
     nSecre      = 0;
     nLineaTabla = 0;
     nSwContar   = 0;  |BUCLE zregfirmI;
     nSwContar   = 1;  |BUCLE zregfirmI;

     eaAlfa     = aAlfa;                  |HAZ QuitaRarosDSXML;
     eaAsigna   = "V#firmante#";
     eaConten   = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa     = aAlfa1;                  |HAZ QuitaRarosDSXML;
     eaAsigna   = "V#firmantedni#";
     eaConten   = eaAlfa;
     |HAZ GrabaContenido;

     enSwTrata = 1;

     aAlfa4 = eaPlanillaTra % 0603;
     |SI eaPlanillaTra ! "cert1004.doc"; |Y aAlfa4 ! "10p";
         |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
               enCanti = #1nCampo;
               nVar    = nCampo - 15;
               |HAZ SeparaImporte;
               eaAsigna = "V#reparto" + nVar + "#";
               eaConten = eaImporte;
               |HAZ GrabaContenido;
         |SIGUE;

         |PARA nCampo = 21;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
               enCanti = #1nCampo;
               nVar    = nCampo - 20;
               |HAZ SeparaImporte;
               eaAsigna = "V#aplicacion" + nVar + "#";
               eaConten = eaImporte;
               |HAZ GrabaContenido;
         |SIGUE;
     |FINSI;

     |SI eaPlanillaTra = "cert1004.doc"; |O aAlfa4 = "10p";
         |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
               enCanti = #1nCampo;
               nVar    = nCampo - 15;
               |HAZ SeparaImporte;
               eaAsigna = "V#reparto" + nVar + "#";
               eaConten = eaImporte;
               |HAZ GrabaContenido;
         |SIGUE;

         |PARA nCampo = 70;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
               enCanti = #1nCampo;
               nVar    = nCampo - 69;
               |HAZ SeparaImporte;
               eaAsigna = "V#aplicacion" + nVar + "#";
               eaConten = eaImporte;
               |HAZ GrabaContenido;
         |SIGUE;
     |FINSI;

     eaAlfa   = #1#2;                  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#empresa#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #301#13;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#poblacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "V#poblacion firma#";
     |HAZ GrabaContenido;

     eaAlfa   = #301#14;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#provincia#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #301#4;                              |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #301#5;               |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", n. " + #301#6;           |HAZ QuitaRarosDSXML;
     eaAsigna = "V#domicilio social#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa  = #301#3;                               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#CIF#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#30;                               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#cargo#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#41;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha junta#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa = #1#12;
     |HAZ SacaFecha;
     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha firma#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#31;  |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #1#32;  |QBF eaAlfa;
     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#domicilio junta#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#48;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#aviso socio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#42;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#numero asistentes#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#43;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#asistentes personal#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#44;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#asistentes representados#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#45;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#total asistentes#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#34;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#presidente junta#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#36;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#secretario junta#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#50;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#presidente#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#52;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#secretario#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#46;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tipo acuerdo#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#47;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#voto favorable#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#1;
     eaAsigna = "V#ejercicio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#37;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha cierre ejercicio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     enCanti = #1802#7;
     |HAZ SeparaImporte;
     eaAsigna = "V#resultado#";

     |SI #1802#7 ! 0;
         eaConten = eaImporte + " euros.";
     |SINO;
         eaConten = "cero euros.";
     |FINSI;
     |HAZ GrabaContenido;

     |SI #2#11 = "N";
         eaAlfa = "se acompa¤an en hojas anexas a sta certificaci¢n numeradas de la ";
         eaAlfa = eaAlfa + "p gina " + #1#38 + " hasta la p gina " + #1#39;
     |FINSI;

     |SI #2#11 = "S";
         eaAlfa = "una copia de las mismas se presentan digitalmente en el Registro Mercantil, ";
         eaAlfa = eaAlfa + "que han generado el c¢digo alfanumrico que se consigna en el certificado de la ";
         eaAlfa = eaAlfa + "huella digital, que como anexo se acompa¤a al presente, formando parte de l.";
     |FINSI;

     |SI #2#11 = "H";
         eaAlfa = "una copia de las mismas se deposita en el Registro Mercantil de forma digital, ";
         eaAlfa = eaAlfa + "las cuales han generado la huella digital siguiente " + #2#16;
     |FINSI;

     |SI #2#11 = "T";
         eaAlfa = "una copia de las mismas han sido remitidas telem ticamente al Registro Mercantil, ";
         eaAlfa = eaAlfa + "las cuales han generado la huella digital siguiente " + #2#16;
     |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#formato cuentas#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#40;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha formulacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#38;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#pagina desde#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#39;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#pagina hasta#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#53;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#registro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#54;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#29;               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tomo#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#30;               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#libro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#31;               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#seccion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#32;               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#folio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#33;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#hoja#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#34;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#28;
     eaAsigna = "V#fecha inscripcion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#60;
     eaAsigna = "V#fecha inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#8;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#notario#";
     eaConten = eaAlfa;                     || nuevos campos 2017
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#11;
     eaAsigna = "V#fecha constitucion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "V#sth#";   eaConten = #1#55;  |HAZ GrabaContenido;
     eaAsigna = "V#stm#";   eaConten = #1#56;  |HAZ GrabaContenido;
     eaAsigna = "V#snth#";  eaConten = #1#57;  |HAZ GrabaContenido;
     eaAsigna = "V#sntm#";  eaConten = #1#58;  |HAZ GrabaContenido;
     eaAsigna = "V#sch#";   eaConten = #1#59;  |HAZ GrabaContenido;
     eaAsigna = "V#scm#";   eaConten = #1#60;  |HAZ GrabaContenido;
     eaAsigna = "V#ejh#";   eaConten = #1#61;  |HAZ GrabaContenido;
     eaAsigna = "V#tsh#";   eaConten = #1#62;  |HAZ GrabaContenido;
     eaAsigna = "V#tsm#";   eaConten = #1#63;  |HAZ GrabaContenido;

     eaAsigna = "V#totalst#";  nNume = #zregdocu#55 + #zregdocu#56; eaConten = nNume; |HAZ GrabaContenido;
     eaAsigna = "V#totalsnt#"; nNume = #zregdocu#57 + #zregdocu#58; eaConten = nNume; |HAZ GrabaContenido;
     eaAsigna = "V#totalsc#";  nNume = #zregdocu#59 + #zregdocu#60; eaConten = nNume; |HAZ GrabaContenido;
     eaAsigna = "V#totalsoc#"; nNume = #zregdocu#62 + #zregdocu#63; eaConten = nNume; |HAZ GrabaContenido;
     eaAsigna = "V#totalej#";  eaConten = #zregdocu#61; |HAZ GrabaContenido;
     eaAsigna = "V#altasoc#";  eaConten = #zregdocu#82; |HAZ GrabaContenido;
     eaAsigna = "V#bajasoc#";  eaConten = #zregdocu#83; |HAZ GrabaContenido;

     eaAlfa = "";
     aAlfa3 = "";
     aAlfa1 = #1#65;  |QBF aAlfa1;
     aAlfa2 = #1#67;  |QBF aAlfa2;
     |SI aAlfa1 ! "";  |Y aAlfa2 ! "";
         eaAlfa  = aAlfa1  +  " y " + aAlfa2;  |QBF eaAlfa;
         aAlfa3  = "interventores";
     |SINO;
         |SI aAlfa1 ! "";
             eaAlfa  = aAlfa1;
             aAlfa3  = "interventor";
         |FINSI;

         |SI aAlfa2 ! "";
             eaAlfa  = aAlfa2;
             aAlfa3  = "interventor";
         |FINSI;
     |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#interventor#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa = aAlfa3;
     |HAZ QuitaRarosDSXML;
     eaAsigna = "V#cargo interventor#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |SI enTBal ! 3;
         eaAlfa = "Que la sociedad puede formular las cuentas de forma abreviada ";
         eaAlfa = eaAlfa + "y no est  obligada a someter sus cuentas a verificación de ";
         eaAlfa = eaAlfa + "auditor ni a elaborar el Informe de Gestión,"
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#tipo cuenta1#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;

         eaAlfa = " de conformidad con los artículos 257, 258, 261 y 263 del Real Decreto ";
         eaAlfa = eaAlfa + "Legislativo 1/2010, de 2 de julio por el que se aprueba el texto ";
         eaAlfa = eaAlfa + "refundido de la Ley de Sociedades de Capital.";
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#tipo cuenta2#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;
     |SINO;
         eaAlfa = "Que la sociedad aplica el Plan General de Contabilidad PYMES, ";
         eaAlfa = eaAlfa + "conforme a lo dispuesto en el artículo 2 del R.D. 1515/2007 ";
         eaAlfa = eaAlfa + "de 16 de Noviembre.";
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#tipo cuenta1#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;

         eaAsigna = "V#tipo cuenta2#";
         eaConten = "";
         |HAZ GrabaContenido;
     |FINSI;
|FPRC;

|PROCESO CreaCertificado;
     |SI #1#11 = "S";
         |CONFI "0000NEl certificado ya est  creado, desea crearlo de nuevo";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |HAZ VentanaTrabajo;

     |ABRE #1802;
     |SELECT #3#1802;
     #1802#0  = #2#0;
     #1802#1  = #2#1;
     #1802#16 = 49500;
     |LEE 000#1802=;
     |SI FSalida ! 0;  |DDEFECTO #1802;  |FINSI;
     |CIERRA #1802;

     aAnyo = #zhazdocu#0; aAnyo = aAnyo % - 102;
     |SI #zhazcrea#10 [ 1;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "01p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "01c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "01n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0101.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0102.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0103.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 2;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "02p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "02c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "02n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0201.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0202.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0203.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 3;
         |SI #zhazdocu#0 ] 2017;
             eaPlanillaTra = "cer" + aAnyo + "03s.doc";
         |SINO;
             eaPlanillaTra = "cert0301.doc";
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 4;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "04p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "04c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "04n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0401.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0402.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0403.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 5;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "05p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "05c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "05n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0501.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0502.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0503.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 6;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "06p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "06c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "06n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0601.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0602.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0603.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 7;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "07p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "07c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "07n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0701.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0702.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0703.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 8;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "08p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "08c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "08n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cert0801.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert0802.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert0803.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 9;
         |SI #zhazdocu#0 ] 2017;
             eaPlanillaTra = "cer" + aAnyo + "09s.doc";
         |SINO;
             eaPlanillaTra = "cert0901.doc";
         |FINSI;
     |FINSI;

     |SI #zhazcrea#10 = 10;
         |SI #zhazdocu#0 ] 2017;
             |SI #cubal802#7 > 0;  eaPlanillaTra = "cer" + aAnyo + "10p.doc";  |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cer" + aAnyo + "10c.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cer" + aAnyo + "10n.doc";  |FINSI;
         |SINO;
             |SI #cubal802#7 > 0;
                 |SI #zhazcrea#1 [ 2010;  eaPlanillaTra = "cert1001.doc";  |FINSI;
                 |SI #zhazcrea#1 ] 2011;  eaPlanillaTra = "cert1004.doc";  |FINSI;
             |FINSI;
             |SI #cubal802#7 = 0;  eaPlanillaTra = "cert1002.doc";  |FINSI;
             |SI #cubal802#7 < 0;  eaPlanillaTra = "cert1003.doc";  |FINSI;
         |FINSI;
     |FINSI;

     |SI #2#10 = 11;
         eaPlanillaTra = "cert1101.doc";
     |FINSI;

     |SI #2#10 = 12;
         eaPlanillaTra = "cert1201.doc";
     |FINSI;

     |SI #2#10 = 13;
         |SI #1802#7 > 0;  eaPlanillaTra = "cert1301.doc";  |FINSI;
         |SI #1802#7 = 0;  eaPlanillaTra = "cert1302.doc";  |FINSI;
         |SI #1802#7 < 0;  eaPlanillaTra = "cert1303.doc";  |FINSI;
     |FINSI;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/actas/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wcertif.txt";
     eaFicheroTra   = "wcertif.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaModoPresenta = "";

     eaOrigen       = eaDirSerDoc  + eaPlanillaTra;
     eaDestino      = eaDirTrabajo + eaFicheroPla;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroPla;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroPla + "#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |HAZ CargaVarCertif;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     aAlfa  = eaDirTrabServi + eaFicheroTxt;
     |FBORRA aAlfa;

     |HAZ AbreWordExterno;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + "wcertif.doc";
     |HAZ RecibeFichero;

     |RFBORRA aAbre;

     aAbre = eaDirGuarda + "wcertif.doc";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     #1#11 = "S";
     #1#12 = #2#9;
     #1#13 = #2#10;
     #1#68 = #2#11;
     #1#15 = #2#16;

     |ABRE #800;
     #800#0 = #1#0;
     #800#1 = #1#1;
     |LEE 101#800=;
     |SI FSalida ! 0;
         |DDEFECTO #800;
         #800#0 = #1#0;
         #800#1 = #1#1;
         |GRABA 020#800b;
     |FINSI;

     #800#2 = #1#2;
     #800#3 = #1#5;
     #800#4 = #1#6;
     #800#5 = #1#9;
     #800#6 = #1#10;

     |GRABA 020#800a;
     |LIBERA #800;
     |CIERRA #800;

     |ABRE #801;
     #801#0 = #1#0;
     #801#1 = #1#1;
     #801#2 = "wcertif.doc";
     |LEE 101#801=;
     |SI FSalida ! 0;
         |DDEFECTO #801;
         #801#0 = #1#0;
         #801#1 = #1#1;
         #801#2 = "wcertif.doc";
         |GRABA 020#801b;
     |FINSI;

     #801#3 = "CERTIFICADO";
     #801#4 = ~;
     |HORA aHora;
     #801#5 = aHora % 102;
     #801#6 = aHora % 402;

     |GRABA 020#801a;
     |LIBERA #801;
     |CIERRA #801;

     |HAZ FinVentanaTrabajo;

     |MENAV "0000El certificado ha sido creado.";

     |PULSATECLA;
|FPRC;

|PROCESO VisualizaCertificado;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wcertif.txt";
     eaFicheroTra   = "wcertif.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |RFBORRA aAbre;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO EditaCertPatron;
     |HAZ VentanaTrabajo;

     |SI #zhazdocu#0 ] 2017;
         nNume = 0;
         aAlfa = eaFichero % 103;
         |SI aAlfa = "cer"; nNume = enUltCert; |FINSI;
         |SI #zhazdocu#0 > nNume; |Y nNume ! 0;
             aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
             |MENAV aAlfa;
             |ACABA;
         |FINSI;
         |SI nNume ! 0;
             aAlfa1 = eaFichero % 502;
             |SI aAlfa1 = "03"; |O aAlfa1 = "09";
                 aAlfa2 = "s";
             |SINO;
                 aAlfa2 = eaFichero % 702;
                 |SI aAlfa2 = "01"; |O aAlfa2 = "04"; aAlfa2 = "p"; |FINSI;
                 |SI aAlfa2 = "02"; aAlfa2 = "c"; |FINSI;
                 |SI aAlfa2 = "03"; aAlfa2 = "n"; |FINSI;
             |FINSI;
             aAnyo = #zhazdocu#0; aAnyo = aAnyo % - 102;
             eaFichero = aAlfa + aAnyo + aAlfa1 + aAlfa2 + ".doc";
         |FINSI;
     |FINSI;

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/actas/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "cer" + #0#0 + ".txt";
     eaFicheroTra   = eaFichero;
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "word/actas/";
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFichero;
     eaDestino      = eaDirTrabajo + eaFichero;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFichero;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFichero;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO CargaVarPortada;
     |ABRE #301;
     #301#0 = #2#0;
     #301#1 = #2#1;
     |LEE 040#301=;
     |SI FSalida ! 0;  |DDEFECTO #301;  |FINSI;
     |CIERRA #301;

     |ABRE #619;
     #619#0 = #2#0;
     #619#1 = 99;
     |LEE 040#619];
     |SI FSalida = 0;
         |LEE 040#619a;
     |SINO;
         |LEE 040#619u;
     |FINSI;
     |SI FSalida ! 0;  |O #619#0 ! #2#0;
         |DDEFECTO #619;
     |FINSI;
     |CIERRA #619;

     |ABRE #4;
     #4#0 = #2#0;
     #4#1 = #2#1;
     #4#2 = 1;
     |LEE 040#4];
     |SI FSalida ! 0;  |O  #4#0 ! #2#0;  |O  #4#1 ! #2#1;
         |DDEFECTO #4;
     |FINSI;
     |CIERRA #4;

     |ABRE #17;
     #17#0 = #2#0;
     #17#1 = #2#1;
     |LEE 040#17=;
     |SI FSalida ! 0;
         |DDEFECTO #17;
     |FINSI;
     |CIERRA #17;

     nAmbiente = 0;
     |PARA nCampo = 2;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
           nAmbiente = nAmbiente + #17nCampo;
     |SIGUE;

     eaAlfa   = #619#27;
     eaAsigna = "VvMERCANTILv";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#1;
     eaAsigna = "VvEJERCICIOv";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #1#2;                  |HAZ QuitaRarosDSXML;
     eaAsigna = "VvSOCIEDADv";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa  = #301#3;                               |HAZ QuitaRarosDSXML;
     eaAsigna = "VvCIFv";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #619#33; |HAZ QuitaRarosDSXML;
     eaAsigna = "VvHOJAv";  eaConten = eaAlfa;  |HAZ GrabaContenido;

     |SI nAmbiente ! 0;
          eaAlfa = "X";  eaAsigna = "VvC18v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |SINO;
          eaAlfa = " ";  eaAsigna = "VvC18v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI #1#4 = "S";
         |SI enTBal [ 2;
             eaAlfa = "X";  eaAsigna = "VvC11v";  eaConten = eaAlfa; |HAZ GrabaContenido;
             eaAlfa = " ";  eaAsigna = "VvC15v";  eaConten = eaAlfa; |HAZ GrabaContenido;
         |FINSI;

         |SI enTBal = 3;
             eaAlfa = " ";  eaAsigna = "VvC11v";  eaConten = eaAlfa; |HAZ GrabaContenido;
             eaAlfa = "X";  eaAsigna = "VvC15v";  eaConten = eaAlfa; |HAZ GrabaContenido;
         |FINSI;
     |SINO;
          eaAlfa = " ";  eaAsigna = "VvC11v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC15v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI #1#8 = "S";
          eaAlfa = "X";  eaAsigna = "VvC19v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |SINO;
          eaAlfa = " ";  eaAsigna = "VvC19v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTBal = 0;
          eaAlfa = " ";  eaAsigna = "VvC4v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC9v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC13v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = " ";  eaAsigna = "VvC7v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC12v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC16v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = " ";  eaAsigna = "VvC8v";   eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTBal = 1;
          eaAlfa = "X";  eaAsigna = "VvC4v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC9v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC13v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = "X";  eaAsigna = "VvC7v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC12v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC16v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = "X";  eaAsigna = "VvC8v";   eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTBal = 2;
          eaAlfa = "X";  eaAsigna = "VvC9v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC4v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC13v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = "X";  eaAsigna = "VvC12v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC7v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC16v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = " ";  eaAsigna = "VvC8v";   eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTBal = 3;
          eaAlfa = "X";  eaAsigna = "VvC13v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC4v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC9v";   eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = "X";  eaAsigna = "VvC16v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC7v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC12v";  eaConten = eaAlfa; |HAZ GrabaContenido;

          eaAlfa = " ";  eaAsigna = "VvC8v";   eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTCta = 0;
          eaAlfa = " ";  eaAsigna = "VvC5v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC10v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC14v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTCta = 1;
          eaAlfa = "X";  eaAsigna = "VvC5v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC10v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC14v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTCta = 2;
          eaAlfa = "X";  eaAsigna = "VvC10v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC5v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC14v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     |SI enTCta = 3;
          eaAlfa = "X";  eaAsigna = "VvC14v";  eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC5v";   eaConten = eaAlfa; |HAZ GrabaContenido;
          eaAlfa = " ";  eaAsigna = "VvC10v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     |FINSI;

     eaAlfa = " ";  eaAsigna = "VvC1v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC2v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC6v";  eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC20v"; eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC22v"; eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC23v"; eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC24v"; eaConten = eaAlfa; |HAZ GrabaContenido;
     eaAlfa = " ";  eaAsigna = "VvC25v"; eaConten = eaAlfa; |HAZ GrabaContenido;

     eaAlfa = "X";  eaAsigna = "VvC3v";  eaConten = eaAlfa;  |HAZ GrabaContenido;
     eaAlfa = "X";  eaAsigna = "VvC17v";  eaConten = eaAlfa;  |HAZ GrabaContenido;
     eaAlfa = "X";  eaAsigna = "VvC21v";  eaConten = eaAlfa;  |HAZ GrabaContenido;

     eaAlfa   = #1#41; |HAZ QuitaRarosDSXML;
     eaAsigna = "VvFECHAEXPIDEv";  eaConten = eaAlfa;  |HAZ GrabaContenido;

     eaAlfa   = #4#4; |HAZ QuitaRarosDSXML;
     eaAsigna = "VvEXPIDEv";  eaConten = eaAlfa;  |HAZ GrabaContenido;

     eaAlfa   = "ADMINISTRADOR";
     eaAsigna = "VvCARGOv";  eaConten = eaAlfa;  |HAZ GrabaContenido;
|FPRC;

|PROCESO CreaPortada;
     |HAZ VentanaTrabajo;

     eaPlanillaTra = "porta001.doc";

     |DBASE aBase;
     eaDirTrabajo   = "C:\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = "C:\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/actas/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "portada.txt";
     eaFicheroTra   = "portada.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaOrigen       = eaDirSerDoc  + eaPlanillaTra;
     eaDestino      = eaDirTrabajo + eaFicheroPla;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroPla;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroPla + "#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |HAZ CargaVarPortada;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     aAlfa  = eaDirTrabServi + eaFicheroTxt;
     |FBORRA aAlfa;

     |HAZ AbreWordExterno;

     |HAZ FinVentanaTrabajo;

     aAlfa  = eaDirTrabServi + eaFicheroTra;
     |RFBORRA aAlfa;

     |PULSATECLA;
|FPRC;
