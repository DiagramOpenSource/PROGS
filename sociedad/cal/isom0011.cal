|FICHEROS;
     isom0001;
     isom0011;
     isom0508;
     isocie70;

     maempr10;

     isow0015;
|FIN;

|VARIABLES;
      nHCas          = 0;
      nRango         = 0;
      nBotonSal      = 0;
      nBotonAnota    = -1;
      nBotonIntrod   = -1;
      nBotonAplica   = -1;
      nBotonInfor    = -1;
      nTree          = 0;
      nHandle        = 0;
      nPanta         = 0;
      nBotonLabel    = 0;
      nVentana       = 0;
      nVent          = 0;
      nGrid          = 0;
      nModo          = 0;
      nLinea         = 0;
      nAplicado      = 0;
      nAcum          = 0;
      nLimiteT       = 0;
      nTope          = 0;
      nTope1         = 0;
      nDeducido      = 0;
      nValor         = 0;
      nValor1        = 0;
      nValor2        = 0;
      nCuota         = 0;
      nDedu          = 0;
      nApli          = 0;
      nDLinea        = 0;
      nHLinea        = 0;
      nLimite10      = 0;
      nLimite15      = 0;
      nLimite25      = 0;
      nLimite35      = 0;
      nLimite50      = 0;
      nLimite60      = 0;
      nLimite70      = 0;
      nLimite90      = 0;
      nLimite100     = 0;
      nDeduci        = 0;

      aContenido     = "";
      aTexto         = "";
      aBase          = "";
      aAlfa          = "";
      aAbre          = "";
      aEsc1          = "";
      aEsc2          = "";
      aRetu          = "";
      aTecla         = "";
      aCasilla       = "";
      aCas           = "";
      aFichero       = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &eaCasilla      = "";
     &eaTitCasilla   = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaTipoColor    = "";
     &eaColor        = "";
     &enModoConsulta = 0;
|FIN;

|PROCESO AplicaPendiente;
     #isom0011#9 = #isom0011#5 - #isom0011#7;

     |SI #isom0011#4 = "918  ";  |O #isom0011#4 = "589  ";
      |O #isom0011#4 = "822  ";  |O #isom0011#4 = "232  ";
      |O #isom0011#4 = "1123 ";  |O #isom0011#4 = "1127 ";
      |O #isom0011#4 = "1426 ";  |O #isom0011#4 = "1430 ";
      |O #isom0011#4 = "1710 ";  |O #isom0011#4 = "1714 ";
      |O #isom0011#4 = "1968 ";  |O #isom0011#4 = "1972 ";
         |SI #isom0011#5 ! 0;
             nDeduci = #isom0011#5 % 80;
             |SI #isom0011#7 > nDeduci;
                 #isom0011#7 = nDeduci;
             |FINSI;

             #isom0011#9 = nDeduci - #isom0011#7;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0011A;
     #isom0011#7 = 0;

     #isom0011#9 = 0;
     |SI #isom0011#8 ! "     ";
         |HAZ AplicaPendiente;
     |FINSI;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011A;
     #isom0011#1;
     ;
     #maempr10#0, #maempr10#1, 0000;
     #maempr10#0, #maempr10#1, nHCas;
     be;
     NULL, isom0011A;
|FIN;

|PROCESO isocie70A;
     aCas = #isocie70#7;
     |SI #isocie70#7 [ 999;
         aCas = ("000" + #isocie70#7) % -103;
     |FINSI;

     #isow0015#0 = aCas;
     #isow0015#1 = #isocie70#8;
     |LEE 101#isow0015.=;
     |SI FSalida ! 0;
         |DDEFECTO #isow0015;
         #isow0015#0 = aCas;
         #isow0015#1 = #isocie70#8;
         |GRABA 020#isow0015.b;
     |FINSI;

     #isow0015#2 = #isow0015#2 + #isocie70#11;
     |GRABA 020#isow0015.a;
     |LIBERA #isow0015;
|FPRC;

|DEFBUCLE isocie70A;
     #isocie70#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isocie70A;
|FIN;

|PROCESO Deduce;
     nAplicado = 0;

     |SI nAcum = 0;    |ACABA;  |FINSI;
     |SI nLimiteT [ 0; |ACABA;  |FINSI;
     |SI nTope    = 0; |ACABA;  |FINSI;

     |SI nDeducido > nTope;
         nDeducido = nTope;
         nTope     = 0;
     |SINO;
         nTope = nTope - nDeducido;
     |FINSI;

     nAcum = nAcum - nDeducido;
     |SI nAcum ] 0
         nAplicado = nDeducido;
     |SINO;
         nAplicado = nDeducido + nAcum;
         nAcum     = 0;
     |FINSI;

     nLimiteT = nLimiteT - nAplicado;
     |SI nLimiteT < 0;
         nAplicado = nAplicado + nLimiteT;
         nLimiteT  = 0;
     |FINSI;
|FPRC;

|PROCESO Lee111;
     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = aCasilla;
     |LEE 000#isom0011.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0011;  |FINSI;

     nValor  = #isom0011#5;
     nValor1 = #isom0011#5;
     nValor2 = #isom0011#7;
|FPRC;

|PROCESO AplicaCasilla;
     |HAZ Lee111;

     nDeducido = nValor;  |HAZ Deduce;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = aCasilla;
     |LEE 101#isom0011.=;
     |SI FSalida = 0;
         #isom0011#7 = nAplicado;

         |HAZ AplicaPendiente;
         |GRABA 020#isom0011.a;
         |LIBERA #isom0011;
     |FINSI;
|FPRC;

|PROCESO AplicaCasillaE;
     |HAZ Lee111;

     nDeducido = nValor % 80;  |HAZ Deduce;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = aCasilla;
     |LEE 101#isom0011.=;
     |SI FSalida = 0;
         #isom0011#7 = nAplicado;

         |HAZ AplicaPendiente;
         |GRABA 020#isom0011.a;
         |LIBERA #isom0011;
     |FINSI;
|FPRC;

|PROCESO AplicaCasillaA;
     |HAZ Lee111;

     nDeducido = nValor1 - nValor2;  |HAZ Deduce;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = aCasilla;
     |LEE 101#isom0011.=;
     |SI FSalida = 0;
         #isom0011#7 = #isom0011#7 + nAplicado;
         |HAZ AplicaPendiente;
         |GRABA 020#isom0011.a;
         |LIBERA #isom0011;
     |FINSI;
|FPRC;

|PROCESO isom0508A;
     #isow0015#0 = #isom0508#2;
     #isow0015#1 = nDedu;
     |LEE 000#isow0015.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nTope    = #isow0015#2;
     aCasilla = #isow0015#0;

     |SI nApli = 0;  |HAZ AplicaCasilla;   |FINSI;
     |SI nApli = 1;  |HAZ AplicaCasillaA;  |FINSI;
|FPRC;

|DEFBUCLE isom0508A;
     #isom0508#1;
     ;
     enAnyo, nDLinea;
     enAnyo, nHLinea;
     ;
     NULL, isom0508A;
|FIN;

|PROCESO Aplica2008;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum     = nLimite100;
     aCasilla  = "841";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "835";  |HAZ AplicaCasilla;
     aCasilla  = "838";  |HAZ AplicaCasilla;
     aCasilla  = "932";  |HAZ AplicaCasilla;
     aCasilla  = "297";  |HAZ AplicaCasilla;
     aCasilla  = "090";  |HAZ AplicaCasilla;
     aCasilla  = "004";  |HAZ AplicaCasilla;
     aCasilla  = "031";  |HAZ AplicaCasilla;
     aCasilla  = "022";  |HAZ AplicaCasilla;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "777";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 230;
     nHLinea = 390;
     |BUCLE isom0508A;

     nAcum = nLimite35;
     nDedu   = 35;
     nApli   = 1;
     nDLinea = 230;
     nHLinea = 390;
     |BUCLE isom0508A;

     nTope  = nLimite70;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 140;
     nHLinea = 200;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 1;
     nDLinea = 140;
     nHLinea = 200;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope     = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2009;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum     = nLimite100;
     aCasilla  = "841";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "835";  |HAZ AplicaCasilla;
     aCasilla  = "838";  |HAZ AplicaCasilla;
     aCasilla  = "932";  |HAZ AplicaCasilla;
     aCasilla  = "297";  |HAZ AplicaCasilla;
     aCasilla  = "090";  |HAZ AplicaCasilla;
     aCasilla  = "004";  |HAZ AplicaCasilla;
     aCasilla  = "031";  |HAZ AplicaCasilla;
     aCasilla  = "022";  |HAZ AplicaCasilla;
     aCasilla  = "040";  |HAZ AplicaCasilla;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 230;
     nHLinea = 420;
     |BUCLE isom0508A;

     nAcum = nLimite35;
     nDedu   = 35;
     nApli   = 1;
     nDLinea = 230;
     nHLinea = 420;
     |BUCLE isom0508A;

     nTope  = nLimite70;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 140;
     nHLinea = 200;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 1;
     nDLinea = 140;
     nHLinea = 200;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope     = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2010;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum     = nLimite100;
     aCasilla  = "841";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "835";  |HAZ AplicaCasilla;
     aCasilla  = "838";  |HAZ AplicaCasilla;
     aCasilla  = "932";  |HAZ AplicaCasilla;
     aCasilla  = "297";  |HAZ AplicaCasilla;
     aCasilla  = "090";  |HAZ AplicaCasilla;
     aCasilla  = "004";  |HAZ AplicaCasilla;
     aCasilla  = "031";  |HAZ AplicaCasilla;
     aCasilla  = "022";  |HAZ AplicaCasilla;
     aCasilla  = "040";  |HAZ AplicaCasilla;
     aCasilla  = "138";  |HAZ AplicaCasilla;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 240;
     nHLinea = 465;
     |BUCLE isom0508A;

     nAcum = nLimite35;
     nDedu   = 35;
     nApli   = 1;
     nDLinea = 240;
     nHLinea = 465;
     |BUCLE isom0508A;

     nTope  = nLimite70;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 145;
     nHLinea = 210;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 1;
     nDLinea = 145;
     nHLinea = 210;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope     = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2011;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum     = nLimite100;
     aCasilla  = "841";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "835";  |HAZ AplicaCasilla;
     aCasilla  = "838";  |HAZ AplicaCasilla;
     aCasilla  = "932";  |HAZ AplicaCasilla;
     aCasilla  = "297";  |HAZ AplicaCasilla;
     aCasilla  = "090";  |HAZ AplicaCasilla;
     aCasilla  = "004";  |HAZ AplicaCasilla;
     aCasilla  = "031";  |HAZ AplicaCasilla;
     aCasilla  = "022";  |HAZ AplicaCasilla;
     aCasilla  = "040";  |HAZ AplicaCasilla;
     aCasilla  = "138";  |HAZ AplicaCasilla;
     aCasilla  = "141";  |HAZ AplicaCasilla;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 0;
     nDLinea = 250;
     nHLinea = 440;
     |BUCLE isom0508A;

     nAcum   = nLimite50;
     nDedu   = 50;
     nApli   = 1;
     nDLinea = 250;
     nHLinea = 440;
     |BUCLE isom0508A;

     nAcum = nLimite35;
     nDedu   = 35;
     nApli   = 1;
     nDLinea = 250;
     nHLinea = 440;
     |BUCLE isom0508A;

     nTope  = nLimite70;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 150;
     nHLinea = 225;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 1;
     nDLinea = 150;
     nHLinea = 225;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope     = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2012;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum     = nLimite25;
     aCasilla  = "841";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "835";  |HAZ AplicaCasilla;
     aCasilla  = "838";  |HAZ AplicaCasilla;
     aCasilla  = "932";  |HAZ AplicaCasilla;
     aCasilla  = "297";  |HAZ AplicaCasilla;
     aCasilla  = "090";  |HAZ AplicaCasilla;
     aCasilla  = "004";  |HAZ AplicaCasilla;
     aCasilla  = "031";  |HAZ AplicaCasilla;
     aCasilla  = "022";  |HAZ AplicaCasilla;
     aCasilla  = "040";  |HAZ AplicaCasilla;
     aCasilla  = "138";  |HAZ AplicaCasilla;
     aCasilla  = "141";  |HAZ AplicaCasilla;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 842 a 828
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 250;
     nHLinea = 540;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 250;
     nHLinea = 540;
     |BUCLE isom0508A;

     nTope  = nLimite70;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 150;
     nHLinea = 220;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 150;
     nHLinea = 225;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;
     aCasilla  = "993";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2013;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 188
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 65;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 65;
     |BUCLE isom0508A;

     nAcum     = nLimite35;
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 842 a 828
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 260;
     nHLinea = 525;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 260;
     nHLinea = 525;
     |BUCLE isom0508A;

     nTope  = nLimite50;
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 155;
     nHLinea = 235;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 155;
     nHLinea = 235;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite100;
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;

     nAcum     = nLimite15;
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;
     aCasilla  = "993";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2014;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 700  Hoja 16 / 1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 75;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 75;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 / 2
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 768 a 828   || Hoja 17 / 1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 290;
     nHLinea = 600;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 290;
     nHLinea = 600;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 / 3
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 175;
     nHLinea = 265;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 175;
     nHLinea = 265;
     |BUCLE isom0508A;

     nAcum     = nLimite50;
     aCasilla  = "852";  |HAZ Lee111;  nTope = nValor;
     aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum     = nLimite100;                     || Hoja 17bis / 2
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;

     nAcum     = nLimite15;                      || Hoja 18 / 1
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;
     aCasilla  = "246";  |HAZ AplicaCasilla;
     aCasilla  = "993";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2015;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 700  Hoja 16 / 1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 80;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 80;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 / 2
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 1061 a 828   || Hoja 17 / 1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 300;
     nHLinea = 625;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 300;
     nHLinea = 625;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 / 3
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "852";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 185;
     nHLinea = 280;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 185;
     nHLinea = 280;
     |BUCLE isom0508A;

     nAcum     = nLimite100;                     || Hoja 18 / 2
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;
     aCasilla  = "1123"; |HAZ AplicaCasillaE;
     aCasilla  = "1127"; |HAZ AplicaCasillaE;

     nAcum     = nLimite15;                      || Hoja 18 / 3
     aCasilla  = "598";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "929";  |HAZ AplicaCasilla;
     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;
     aCasilla  = "246";  |HAZ AplicaCasilla;
     aCasilla  = "993";  |HAZ AplicaCasilla;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2016;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 700  Hoja 16 / 2
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 85;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 85;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 / 3
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 768 a 828   || Hoja 17-1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 310;
     nHLinea = 685;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 310;
     nHLinea = 685;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 bis
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1357";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "088";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 195;
     nHLinea = 285;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 195;
     nHLinea = 285;
     |BUCLE isom0508A;

     nAcum     = nLimite100;                     || Hoja 18 / 2
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;
     aCasilla  = "1123"; |HAZ AplicaCasillaE;
     aCasilla  = "1127"; |HAZ AplicaCasillaE;
     aCasilla  = "1426"; |HAZ AplicaCasillaE;
     aCasilla  = "1430"; |HAZ AplicaCasillaE;

     aCasilla  = "598";  |HAZ Lee111;
     nAcum     = nLimite10;                      || Hoja 18 / 3
     nTope     = nValor;

     aCasilla  = "942";  |HAZ AplicaCasilla;
     aCasilla  = "294";  |HAZ AplicaCasilla;
     aCasilla  = "066";  |HAZ AplicaCasilla;
     aCasilla  = "008";  |HAZ AplicaCasilla;
     aCasilla  = "034";  |HAZ AplicaCasilla;
     aCasilla  = "201";  |HAZ AplicaCasilla;
     aCasilla  = "904";  |HAZ AplicaCasilla;
     aCasilla  = "990";  |HAZ AplicaCasilla;
     aCasilla  = "997";  |HAZ AplicaCasilla;
     aCasilla  = "246";  |HAZ AplicaCasilla;

     nAcum   = nLimite10;
     nDedu   = 10;
     nApli   = 0;
     nDLinea = 760;
     nHLinea = 815;
     |BUCLE isom0508A;

     nAcum   = nLimite15;
     nDedu   = 15;
     nApli   = 1;
     nDLinea = 760;
     nHLinea = 815;
     |BUCLE isom0508A;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2017;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 1775  Hoja 16 / 3
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 bis / 1
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 774 a 828   || Hoja 17-1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 320;
     nHLinea = 800;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 320;
     nHLinea = 800;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 bis / 2
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1357";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 205;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 205;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum     = nLimite100;                     || Hoja 18 / 2
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;
     aCasilla  = "1123"; |HAZ AplicaCasillaE;
     aCasilla  = "1127"; |HAZ AplicaCasillaE;
     aCasilla  = "1426"; |HAZ AplicaCasillaE;
     aCasilla  = "1430"; |HAZ AplicaCasillaE;
     aCasilla  = "1710"; |HAZ AplicaCasillaE;
     aCasilla  = "1714"; |HAZ AplicaCasillaE;

     aCasilla  = "598";  |HAZ Lee111;
     nAcum     = nLimite10;                      || Hoja 18 bis / 1
     nTope     = nValor;

     aCasilla  = "294";   |HAZ AplicaCasilla;
     aCasilla  = "066";   |HAZ AplicaCasilla;
     aCasilla  = "008";   |HAZ AplicaCasilla;
     aCasilla  = "034";   |HAZ AplicaCasilla;
     aCasilla  = "201";   |HAZ AplicaCasilla;
     aCasilla  = "904";   |HAZ AplicaCasilla;
     aCasilla  = "990";   |HAZ AplicaCasilla;
     aCasilla  = "997";   |HAZ AplicaCasilla;
     aCasilla  = "246";   |HAZ AplicaCasilla;
     aCasilla  = "993";   |HAZ AplicaCasilla;
     aCasilla  = "1434";  |HAZ AplicaCasilla;
     aCasilla  = "1718";  |HAZ AplicaCasilla;

     nAcum   = nLimite10;            || Hoja 18 / 2
     nDedu   = 10;
     nApli   = 0;
     nDLinea = 885;
     nHLinea = 940;
     |BUCLE isom0508A;

     nAcum   = nLimite15;
     nDedu   = 15;
     nApli   = 1;
     nDLinea = 885;
     nHLinea = 940;
     |BUCLE isom0508A;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2018;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 1838  Hoja 16 / 3
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 bis / 1
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 780 a 828   || Hoja 17-1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 335;
     nHLinea = 940;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 335;
     nHLinea = 940;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 bis / 2
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1357";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1778";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "852";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "2116";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 210;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 210;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 0;
     nDLinea = 305;
     nHLinea = 305;
     |BUCLE isom0508A;

     nAcum   = nLimite100;
     nDedu   = 100;
     nApli   = 1;
     nDLinea = 305;
     nHLinea = 305;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 0;
     nDLinea = 310;
     nHLinea = 310;
     |BUCLE isom0508A;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 1;
     nDLinea = 310;
     nHLinea = 310;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 0;
     nDLinea = 315;
     nHLinea = 315;
     |BUCLE isom0508A;

     nAcum   = nLimite100;
     nDedu   = 100;
     nApli   = 1;
     nDLinea = 315;
     nHLinea = 315;
     |BUCLE isom0508A;

     nAcum     = nLimite100;                     || Hoja 19 / 1
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;
     aCasilla  = "1123"; |HAZ AplicaCasillaE;
     aCasilla  = "1127"; |HAZ AplicaCasillaE;
     aCasilla  = "1426"; |HAZ AplicaCasillaE;
     aCasilla  = "1430"; |HAZ AplicaCasillaE;
     aCasilla  = "1710"; |HAZ AplicaCasillaE;
     aCasilla  = "1714"; |HAZ AplicaCasillaE;
     aCasilla  = "1968"; |HAZ AplicaCasillaE;
     aCasilla  = "1972"; |HAZ AplicaCasillaE;

     aCasilla  = "598";  |HAZ Lee111;
     nAcum     = nLimite10;                      || Hoja 18 bis / 1
     nTope     = nValor;

     aCasilla  = "066";   |HAZ AplicaCasilla;
     aCasilla  = "008";   |HAZ AplicaCasilla;
     aCasilla  = "034";   |HAZ AplicaCasilla;
     aCasilla  = "201";   |HAZ AplicaCasilla;
     aCasilla  = "904";   |HAZ AplicaCasilla;
     aCasilla  = "990";   |HAZ AplicaCasilla;
     aCasilla  = "997";   |HAZ AplicaCasilla;
     aCasilla  = "246";   |HAZ AplicaCasilla;
     aCasilla  = "993";   |HAZ AplicaCasilla;
     aCasilla  = "1434";  |HAZ AplicaCasilla;
     aCasilla  = "1718";  |HAZ AplicaCasilla;
     aCasilla  = "1950";  |HAZ AplicaCasilla;

     nAcum   = nLimite10;            || Hoja 18bis / 1
     nDedu   = 10;
     nApli   = 0;
     nDLinea = 1030;
     nHLinea = 1085;
     |BUCLE isom0508A;

     nAcum   = nLimite15;
     nDedu   = 15;
     nApli   = 1;
     nDLinea = 1030;
     nHLinea = 1085;
     |BUCLE isom0508A;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO Aplica2019;
     |BUCLE isocie70A;

     |SELECT #2#isom0011;

     nAcum   = nLimite50;   || Casillas 835 a 1838  Hoja 16 / 3
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 10;
     nHLinea = 90;
     |BUCLE isom0508A;

     nAcum     = nLimite35;                    || Hoja 16 bis / 1
     aCasilla  = "764";  |HAZ Lee111;
     nTope     = nValor;

     aCasilla  = "749";  |HAZ AplicaCasilla;
     aCasilla  = "752";  |HAZ AplicaCasilla;
     aCasilla  = "755";  |HAZ AplicaCasilla;
     aCasilla  = "758";  |HAZ AplicaCasilla;
     aCasilla  = "761";  |HAZ AplicaCasilla;
     aCasilla  = "744";  |HAZ AplicaCasilla;
     aCasilla  = "779";  |HAZ AplicaCasilla;

     nAcum   = nLimite50;   || Casillas 780 a 828   || Hoja 17-1
     nDedu   = 50;
     nApli   = 0;
     nDLinea = 335;
     nHLinea = 940;
     |BUCLE isom0508A;

     nAcum   = nLimite25;
     nDedu   = 25;
     nApli   = 1;
     nDLinea = 335;
     nHLinea = 940;
     |BUCLE isom0508A;

     nTope  = nLimite50;                || Hoja 16 bis / 2
     nTope1 = nTope;
     nAcum  = nLimite50;  aCasilla  = "854";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "857";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "860";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "863";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "883";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "785";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1357";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "1778";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "852";  |HAZ AplicaCasilla;

     nTope1 = nTope1 - nAplicado;  nTope = nTope1;
     nAcum  = nLimite50;  aCasilla  = "2116";  |HAZ AplicaCasilla;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 0;
     nDLinea = 210;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 1;
     nDLinea = 210;
     nHLinea = 300;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 0;
     nDLinea = 305;
     nHLinea = 305;
     |BUCLE isom0508A;

     nAcum   = nLimite100;
     nDedu   = 100;
     nApli   = 1;
     nDLinea = 305;
     nHLinea = 305;
     |BUCLE isom0508A;

     nAcum   = nLimite60;
     nDedu   = 60;
     nApli   = 0;
     nDLinea = 310;
     nHLinea = 310;
     |BUCLE isom0508A;

     nAcum   = nLimite90;
     nDedu   = 90;
     nApli   = 1;
     nDLinea = 310;
     nHLinea = 310;
     |BUCLE isom0508A;

     nAcum   = nLimite70;
     nDedu   = 70;
     nApli   = 0;
     nDLinea = 315;
     nHLinea = 315;
     |BUCLE isom0508A;

     nAcum   = nLimite100;
     nDedu   = 100;
     nApli   = 1;
     nDLinea = 315;
     nHLinea = 315;
     |BUCLE isom0508A;

     nAcum     = nLimite100;                     || Hoja 19 / 1
     aCasilla  = "517";  |HAZ Lee111;
     nTope     = nValor % 80;

     aCasilla  = "918";  |HAZ AplicaCasillaE;
     aCasilla  = "589";  |HAZ AplicaCasillaE;
     aCasilla  = "822";  |HAZ AplicaCasillaE;
     aCasilla  = "232";  |HAZ AplicaCasillaE;
     aCasilla  = "1123"; |HAZ AplicaCasillaE;
     aCasilla  = "1127"; |HAZ AplicaCasillaE;
     aCasilla  = "1426"; |HAZ AplicaCasillaE;
     aCasilla  = "1430"; |HAZ AplicaCasillaE;
     aCasilla  = "1710"; |HAZ AplicaCasillaE;
     aCasilla  = "1714"; |HAZ AplicaCasillaE;
     aCasilla  = "1968"; |HAZ AplicaCasillaE;
     aCasilla  = "1972"; |HAZ AplicaCasillaE;

     aCasilla  = "598";  |HAZ Lee111;
     nAcum     = nLimite10;                      || Hoja 18 bis / 1
     nTope     = nValor;

     aCasilla  = "066";   |HAZ AplicaCasilla;
     aCasilla  = "008";   |HAZ AplicaCasilla;
     aCasilla  = "034";   |HAZ AplicaCasilla;
     aCasilla  = "201";   |HAZ AplicaCasilla;
     aCasilla  = "904";   |HAZ AplicaCasilla;
     aCasilla  = "990";   |HAZ AplicaCasilla;
     aCasilla  = "997";   |HAZ AplicaCasilla;
     aCasilla  = "246";   |HAZ AplicaCasilla;
     aCasilla  = "993";   |HAZ AplicaCasilla;
     aCasilla  = "1434";  |HAZ AplicaCasilla;
     aCasilla  = "1718";  |HAZ AplicaCasilla;
     aCasilla  = "1950";  |HAZ AplicaCasilla;

     nAcum   = nLimite10;            || Hoja 18bis / 1
     nDedu   = 10;
     nApli   = 0;
     nDLinea = 1030;
     nHLinea = 1085;
     |BUCLE isom0508A;

     nAcum   = nLimite15;
     nDedu   = 15;
     nApli   = 1;
     nDLinea = 1030;
     nHLinea = 1085;
     |BUCLE isom0508A;

     |SELECT #1#isom0011;
|FPRC;

|PROCESO BotonAplica;
     |CONFI "0000SSeguro que quiere aplicar las deducciones autom ticamente";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aFichero = "isow0015" + Usuario;
     |NOME_DAT #isow0015#aFichero#;
     |ABRE #isow0015;  |CIERRA #isow0015;  |DELINDEX #isow0015;

     |ABRE #isow0015;

     |BUCLE isom0011A;

     |SI enAnyo = 2008;  |HAZ Aplica2008;  |FINSI;
     |SI enAnyo = 2009;  |HAZ Aplica2009;  |FINSI;
     |SI enAnyo = 2010;  |HAZ Aplica2010;  |FINSI;
     |SI enAnyo = 2011;  |HAZ Aplica2011;  |FINSI;
     |SI enAnyo = 2012;  |HAZ Aplica2012;  |FINSI;
     |SI enAnyo = 2013;  |HAZ Aplica2013;  |FINSI;
     |SI enAnyo = 2014;  |HAZ Aplica2014;  |FINSI;
     |SI enAnyo = 2015;  |HAZ Aplica2015;  |FINSI;
     |SI enAnyo = 2016;  |HAZ Aplica2016;  |FINSI;
     |SI enAnyo = 2017;  |HAZ Aplica2017;  |FINSI;
     |SI enAnyo = 2018;  |HAZ Aplica2018;  |FINSI;
     |SI enAnyo = 2019;  |HAZ Aplica2019;  |FINSI;

     |CIERRA #isow0015;

     |ABRE #isow0015;  |CIERRA #isow0015;  |DELINDEX #isow0015;

     |HAZ TotalFich111;

     aAlfa = "|IDGRID";
     aAlfa = #isom0011#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo1;  |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |HAZ Tipo1;
|FPRC;

|PROCESO Tipo0C7m11;
     |SI #isom0011#6 = "974  ";  |ACABA;  |FINSI;

     |SI #isom0011#7 > #isom0011#5;
         #isom0011#7 = #isom0011#5;
         |PINTA #isom0011#7;
     |FINSI;
|FPRC;

|PROCESO Totalm11;
     |SI #isom0011#8 = "     ";  |ACABA;  |FINSI;

     |HAZ AplicaPendiente;

     |PINTA #isom0011#9;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     #isom0508#0 = #isom0011#1;
     #isom0508#1 = #isom0011#2;
     |LEE 000#isom0508.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0508;  |FINSI;

     |SI #isom0508#6 ! "I";  |ACABA;  |FINSI;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;

     nLinea = #isom0011#2;

     |HAZ TotalFich111;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#2 = nLinea;
     |LEE 101#isom0011.=;

     aAlfa = "|IDGRID";
     aAlfa = #isom0011#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |C_M #isom0011#7,  1, "N";

     #isom0508#0 = #isom0011#1;
     #isom0508#1 = #isom0011#2;
     |LEE 000#isom0508.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0508;  |FINSI;

     |SI #isom0508#6 ! "I";  |ACABA;  |FINSI;

     |SI #isom0011#6 ! "     ";  |Y #isom0011#5 ! 0;
         |C_M #isom0011#7,  1, "S";
     |FINSI;

     |SI #isom0011#6 = "974  ";
         |C_M #isom0011#7,  1, "S";
     |FINSI;
|FPRC;

|PROCESO Evento111;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#isom0011.=;

         |SI enAnyo ] 2010;
             |ESTADO_CONTROL nBotonInfor, "DISABLE";

             |SI enAnyo = 2010;
                 |SI #isom0011#4 = "138  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;

                 |SI #isom0011#4 = "813  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;
             |FINSI;

             |SI enAnyo ] 2011;  |Y enAnyo [ 2014;
                 |SI #isom0011#4 = "141  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;

                 |SI #isom0011#4 = "792  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;
             |FINSI;

             |SI enAnyo ] 2012;
                 |SI #isom0011#4 = "096  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;
             |FINSI;

             |SI enAnyo ] 2015;
                 |SI #isom0011#4 = "700  ";  |Y #isom0011#5 > 50000;
                     |ESTADO_CONTROL nBotonInfor, "ENABLE";
                 |FINSI;
             |FINSI;

             |SI #isom0011#4 = "798  ";  |Y #isom0011#5 > 50000;
                 |ESTADO_CONTROL nBotonInfor, "ENABLE";
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO isom0508;
     #isom0011#0  = #maempr10#0;
     #isom0011#1  = #isom0508#0;
     #isom0011#2  = #isom0508#1;
     |LEE 101#isom0011.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0011;
         #isom0011#0  = #maempr10#0;
         #isom0011#1  = #isom0508#0;
         #isom0011#2  = #isom0508#1;
         |GRABA 020#isom0011.b;
     |FINSI;

     #isom0011#3  = #isom0508#5;
     #isom0011#4  = #isom0508#2;
     #isom0011#6  = #isom0508#3;
     #isom0011#8  = #isom0508#4;

     eaTipoColor = #isom0508#7;
     |HAZ CogeColor;
     #isom0011#10 = eaColor;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0508;
     #isom0508#1;
     ;
     #maempr10#1, 0000;
     #maempr10#1, 9999;
     ;
     NULL, isom0508;
|FIN;

|PROCESO MontaEstructura508;
     |BUCLE isom0508;
|FPRC;

|PROCESO isom0011;
     |SI #isom0011#5  ! 0;  |ACABA;  |FINSI;
     |SI #isom0011#7  ! 0;  |ACABA;  |FINSI;
     |SI #isom0011#9  ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011;
     #isom0011#1;
     ;
     #maempr10#0, #maempr10#1, 0000;
     #maempr10#0, #maempr10#1, 9999;
     be;
     NULL, isom0011;
|FIN;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO BotonAnota;
     |SI #isom0011#4 = "     ";  |ACABA;  |FINSI;

     eaCasilla    = #isom0011#4;     |QBF eaCasilla;
     eaTitCasilla = #isom0011#3;     |QBF eaTitCasilla;
     eaTitCasilla = eaTitCasilla + " Casilla: " + #isom0011#4;     |QBF eaTitCasilla;

     |SUB_EJECUTA "isom0499";
|FPRC;

|PROCESO isom0011B;
     #isom0011#5  = 0;
     #isom0011#9  = 0;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011B;
     #isom0011#1;
     ;
     #maempr10#0, #maempr10#1, 0000;
     #maempr10#0, #maempr10#1, nHCas;
     be;
     NULL, isom0011B;
|FIN;

|PROCESO isocie70;
     aCas = #isocie70#7;
     |SI #isocie70#7 [ 999;
         aCas = ("000" + #isocie70#7) % -103;
     |FINSI;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#4 = aCas;
     |LEE 101#isom0011.=;
     |SI FSalida = 0;
         #isom0011#5 = #isom0011#5 + #isocie70#11;

         |GRABA 020#isom0011.a;
         |LIBERA #isom0011;
     |FINSI;

     |SI aCas = "1968";  |O aCas = "1972";
         #isom0011#0 = #maempr10#0;
         #isom0011#1 = #maempr10#1;
         #isom0011#4 = "1976";
         |LEE 101#isom0011.=;
         |SI FSalida = 0;
             #isom0011#5 = #isom0011#5 + #isocie70#10;

             |GRABA 020#isom0011.a;
             |LIBERA #isom0011;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isocie70;
     #isocie70#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     be;
     NULL, isocie70;
|FIN;

|PROCESO isom0011R;
     |SI #isom0011#7 > #isom0011#5;
         #isom0011#7 = #isom0011#5;
     |FINSI;

     #isom0011#9 = 0;
     |SI #isom0011#8 ! "     ";
         |HAZ AplicaPendiente;
     |FINSI;

     |GRABA 020#isom0011.a;
     |LIBERA #isom0011;
|FPRC;

|DEFBUCLE isom0011R;
     #isom0011#1;
     ;
     #maempr10#0, #maempr10#1, 0000;
     #maempr10#0, #maempr10#1, nHCas;
     be;
     NULL, isom0011R;
|FIN;

|PROCESO BotonIntroduce;
     aAlfa =  "Deducciones (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 3499, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |SUB_EJECUTA "isow0004";

     |SI enModoConsulta = 0;
         |BUCLE isom0011B;

         |SELECT #2#isom0011;
         |BUCLE isocie70;
         |SELECT #1#isom0011;

         |BUCLE isom0011R;

         |HAZ TotalFich111;
     |FINSI;

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;

     aAlfa = "|IDGRID";
     aAlfa = #isom0011#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |PULSATECLA;
|FPRC;

|PROCESO BotonInfor;
     |SI enAnyo = 2010;
         |SI #isom0011#4 = "138  ";  |SUB_EJECUTA "isom0018";  |FINSI;
         |SI #isom0011#4 = "813  ";  |SUB_EJECUTA "isom0021";  |FINSI;
     |FINSI;

     |SI enAnyo ] 2011;  |Y enAnyo [ 2014;
         |SI #isom0011#4 = "141  ";  |SUB_EJECUTA "isom0018";  |FINSI;
         |SI #isom0011#4 = "792  ";  |SUB_EJECUTA "isom0019";  |FINSI;
     |FINSI;

     |SI enAnyo ] 2015;
         |SI #isom0011#4 = "700  ";  |SUB_EJECUTA "isom0018";  |FINSI;
     |FINSI;

     |SI #isom0011#4 = "798  ";  |SUB_EJECUTA "isom0020";  |FINSI;

     |SI enAnyo ] 2012;
         |SI #isom0011#4 = "096  ";   |SUB_EJECUTA "isom0021";  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja111;
     #isom0011#0  = #maempr10#0;
     #isom0011#1  = #maempr10#1;
     #isom0011#2  = 1;
|FPRC;

|PROCESO Alta111;
     #isom0011#0  = #maempr10#0;
     #isom0011#1  = #maempr10#1;
     #isom0011#2  = 9999;
|FPRC;

|PROGRAMA;
     |SI enAnyo ] 2019;
         |MENAV "0000Apartado desactivado. Se activar  en la versi¢n definitiva.";
         |ACABA;
     |FINSI;

     |SI enAnyo = 2008;  nHCas = 445;   |FINSI;
     |SI enAnyo = 2009;  nHCas = 480;   |FINSI;
     |SI enAnyo = 2010;  nHCas = 530;   |FINSI;
     |SI enAnyo = 2011;  nHCas = 510;   |FINSI;
     |SI enAnyo = 2012;  nHCas = 615;   |FINSI;
     |SI enAnyo = 2013;  nHCas = 625;   |FINSI;
     |SI enAnyo ] 2014;  nHCas = 9999;  |FINSI;

     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |HAZ MontaEstructura508;

     |ABRE #isom0001;
     |SELECT #2#isom0001;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#3 = "582";
     |LEE 000#isom0001.=;
     |SI FSalida = 0;
         nCuota = #isom0001#5;
     |FINSI;

     |SELECT #2#isom0001;
     #isom0001#0 = #maempr10#0;
     #isom0001#1 = #maempr10#1;
     #isom0001#3 = "552";
     |LEE 000#isom0001.=;
     |SI FSalida = 0;
         nLimite15 = (#isom0001#5 % 15) % 40;
     |FINSI;
     |SELECT #1#isom0001;
     |CIERRA #isom0001;

     nLimiteT   = nCuota;

     nLimite10  = (nCuota % 10) ! 2;
     nLimite25  = (nCuota % 25) ! 2;
     nLimite35  = (nCuota % 35) ! 2;
     nLimite50  = (nCuota % 50) ! 2;
     nLimite60  = (nCuota % 60) ! 2;
     nLimite70  = (nCuota % 70) ! 2;
     nLimite90  = (nCuota % 90) ! 2;
     nLimite100 = nCuota;

     #isom0011#0 = #maempr10#0;
     #isom0011#1 = #maempr10#1;
     #isom0011#2 = 5;
     |LEE 000#isom0011.];

     |PINPA #0#isom0011;
     nPanta = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} sali&R", 3488, 3498, BotonSalir;
     nBotonSal = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} a&Notaciones de la deducci¢n", 3302, 3420, BotonAnota;
     nBotonAnota = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} introducir &Deducciones", 3324, 3442, BotonIntroduce;
     nBotonIntrod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} a&Plicar autom ticamente", 3346, 3464, BotonAplica;
     nBotonAplica = FSalida;

     |SI enAnyo ] 2010;
         |CONTROL_SIMPLE 0, "BOTON,{{197}} in&Formaci¢n adicional", 3366, 3484, BotonInfor;
         nBotonInfor  = FSalida;

         |ESTADO_CONTROL nBotonInfor, "DISABLE";
     |FINSI;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 128 + 256;
     |SINO;
         nRango = 4 + 8 + 16 + 128 + 256;
         |ESTADO_CONTROL nBotonAplica, "DISABLE";
     |FINSI;

     |LINEAL_SIMPLE #1#isom0011, nRango, 0502, 3498, Baja111, Alta111, Evento111;

     |FIN_CONTROL_WINDOWS nBotonSal;
     |FIN_CONTROL_WINDOWS nBotonAnota;
     |FIN_CONTROL_WINDOWS nBotonIntrod;
     |FIN_CONTROL_WINDOWS nBotonAplica;

     |SI enAnyo ] 2010;
         |FIN_CONTROL_WINDOWS nBotonInfor;
     |FINSI;

     |BUCLE isom0011;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80m11;  |TIPO 80;
     |ABRET #isom0011;
     |ABRET #isom0508;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90m11;  |TIPO 90;
     |CIERRAT #isom0011;
     |CIERRAT #isom0508;
|FPRC;
