|FICHEROS;
   ism00003 #0;
|FIN;

|VARIABLES;
   nEmpresa = 0;
   nEjercicio = 0;
   nPeriodo = 0;
   nCalc  = 0;
   nCont  = 0;
   nPanta = 0;

   nModo = 0;
|FIN;

|PROCESO Recoge;
   nModo = (FEntrada / 100) ! 0;
   |SI nModo ! 1; |ACABA; |FINSI;

   nCalc = 0;
   nEmpresa   = #ism00003#0;
   nEjercicio = #ism00003#1;
   nPeriodo   = #ism00003#2;
   |SALVA_FICHA #ism00003;
   #ism00003#2 = 1;
   |LEE 000#ism00003.];
   |PARA; |SI FSalida = 0; |Y #ism00003#0 = nEmpresa; |Y #ism00003#1 = nEjercicio;
    |Y nPeriodo > #ism00003#2; |HACIENDO;
       nCalc = nCalc + #ism00003#13;
       |LEE 000#ism00003.s;
   |SIGUE;
   |REPON_FICHA #ism00003;
   #ism00003#12 = nCalc; |PINTA #ism00003#12;
|FPRC;

|PROCESO MiraAnyo;
   |SI #ism00003#1 > 2001;
      |MENAV "    Este mantenimiento es para las declaraciones anteriores al ejercicio 2002";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO Calculo;
   #ism00003#9  = #ism00003#7 % #ism00003#8; |PINTA #ism00003#9;
   |SI #ism00003#9 = 0;
      #ism00003#13 = 0;
   |SINO;
      #ism00003#13 = ((#ism00003#9 - #ism00003#10 - #ism00003#11) % #ism00003#6) - #ism00003#12;
   |FINSI;
   |PINTA #ism00003#13;
|FPRC;
