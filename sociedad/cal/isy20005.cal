|FICHEROS;
   isocie10 #1;
   isocie04 #2;
   isocie06 #4;
   isocie38 #6;
   isocie16 #7;
   isocie17 #8;
   isocie18 #9;
   isocie37 #10;
   isocie40 #13;
   isocie41 #14;

   isocie31 #21;

   isfant06 #3;
   isfant07 #12;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &anyo     = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &informe  = "";

   contador  = 0;
   importe   = "";
   impor1    = "";
   impor2    = "";
   impor3    = "";
   impor4    = "";
   len       = "";
   leng      = 0;
   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   var6      = 0;
   var7      = 0;
   periodo   = "";
   peri      = 0;
|FIN;

|PROCESO isy20005;
|HAZ hoja_03_11;
|HAZ hoja_03_12;
|FPRC;

|| **************************************************************************
||                        PROCESOS hoja_03_ 11
|| **************************************************************************

|PROCESO exencion;
contador = contador + 1;
|SI contador [ 14;
    var1 = contador - 1;
    var2 = var1 + 15; var3 = var2 + 15; var4 = var3 + 15;
    var5 = var4 + 15; var6 = var5 + 15; var7 = var6 + 15;

    |SI #2#5 = 0;
        #3var1 = "----------";
        #3var2 = "--------------";
        #3var3 = "--------------";
        #3var4 = "--------------";
    |SINO;
        #3var1  = #2#4;
        importe = #2#5; |HAZ importe; #3var2 = importe;
        importe = #2#6; |HAZ importe; #3var3 = importe;
        importe = #2#7; |HAZ importe; #3var4 = importe;
    |FINSI;

    |SI #2#9 = 0;
        #3var5 = "-";
        #3var6 = "----------";
        #3var7 = "--------------";
    |SINO;
        #3var5 = #2#3;
        #3var6 = #2#8;
        importe = #2#9; |HAZ importe; #3var7 = importe;
    |FINSI;
|FINSI;

periodo = #2#4 % -102;
peri    = periodo;

|SI peri = 93;
    #3#105 = #3#105 + #2#5;
    |SI #2#9 ! 0;
        periodo = #2#8 % -102;
        peri    = periodo;
        |SI peri = 93;  #3#106 = #3#106 + #2#9; |FINSI;
        |SI peri = 94;  #3#107 = #3#107 + #2#9; |FINSI;
        |SI peri = 95;  #3#108 = #3#108 + #2#9; |FINSI;
        |SI peri > 95;  #3#109 = #3#109 + #2#9; |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE isocie04;
#2#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, exencion;
|FIN;

|PROCESO intersoc;
|SI #8#3 = 1;
    #3#110 = #3#110 + #8#5;
    #3#114 = #3#114 + #8#6;
    #3#118 = #3#118 + #8#7;
|FINSI;

|SI #8#3 = 2;
    #3#111 = #3#111 + #8#5;
    #3#115 = #3#115 + #8#6;
    #3#119 = #3#119 + #8#7;
|FINSI;

|SI #8#3 = 3;
    #3#112 = #3#112 + #8#5;
    #3#116 = #3#116 + #8#6;
    #3#120 = #3#120 + #8#7;
|FINSI;

|SI #8#3 = 4;
    #3#113 = #3#113 + #8#5;
    #3#117 = #3#117 + #8#6;
    #3#121 = #3#121 + #8#7;
|FINSI;
|FPRC;

|DEFBUCLE isocie17;
#8#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, intersoc;
|FIN;

|PROCESO internac;
contador = contador + 1;
|SI contador [ 4;
    var1 = contador + 121;
    var2 = var1 + 4; var3 = var2 + 4; var4 = var3 + 4;
    #3var1 = #9#3; #3var2 = #9#4; #3var3 = #9#5; #3var4 = #9#6;
|FINSI;
|FPRC;

|DEFBUCLE isocie18;
#9#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, internac;
|FIN;

|PROCESO dividendos_1;
contador = contador + 1;
|SI contador [ 7;
    var1    = contador + 137;
    var2    = var1     + 7;
    var3    = var2     + 7;
    var4    = var3     + 7;
    var5    = var4     + 7;
    #3var1  = #13#4;
    #3var2  = #13#5;
    #3var3  = #13#6;
    #3var4  = #13#7;
    #3var5  = #13#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie40_1;
#13#1;
3;
empresa, anyo, 01, 1;
empresa, anyo, 99, 1;
e;
NULL, dividendos_1;
|FIN;

|PROCESO hoja_03_11;

|DDEFECTO #3;
contador = 0; |BUCLE isocie04;
              |BUCLE isocie17;
contador = 0; |BUCLE isocie18;
contador = 0; |BUCLE isocie40_1;

informe = "h9320011";  |HAZ imprime;
|FPRC;

|PROCESO importe;    || Calculo para poner las comas en el importe
len = importe % 0;
leng = len;
importe = "              " + importe;
importe = importe % -114;
      impor1 = importe % -103;
      impor2 = importe % -403;
      impor3 = importe % -703;
      impor4 = importe % -1004;
|SI leng ] 10;
    |SI impor4 ! "  -";
        importe = impor4 + "." + impor3  + "." + impor2 + "." + impor1;
    |SINO;
        importe = impor4 + impor3  + "." + impor2 + "." + impor1;
    |FINSI;
|SINO;
    |SI leng ] 7;
       |SI impor3 ! "  -";
           importe = impor3  + "." + impor2 + "." + impor1;
       |SINO;
           importe = impor3 + impor2 + "." + impor1;
       |FINSI;
    |SINO;
       |SI leng ] 4;
           |SI impor2 ! "  -";
               importe = impor2 + "." + impor1;
           |SINO;
               importe = impor2 + impor1;
           |FINSI;
       |SINO;
           importe = impor1;
       |FINSI;
    |FINSI;
|FINSI;
importe = "             " + importe;
importe = importe % -114;
|FPRC;

|| **************************************************************************
||                        PROCESOS hoja_03_ 12
|| **************************************************************************

|PROCESO dividendos_2;
contador = contador + 1;
|SI contador [ 5;
    var1    = contador - 1;
    var2    = var1     + 5;
    var3    = var2     + 5;
    var4    = var3     + 5;
    var5    = var4     + 5;
    #12var1 = #13#4;
    #12var2 = #13#5;
    #12var3 = #13#6;
    #12var4 = #13#7;
    #12var5 = #13#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie40_2;
#13#1;
3;
empresa, anyo, 01, 2;
empresa, anyo, 99, 2;
e;
NULL, dividendos_2;
|FIN;

|PROCESO bonific_3;
contador = contador + 1;
|SI contador [ 4;
    var1 = contador + 24; var2 = var1 + 4; var3 = var2 + 4; var4 = var3 + 4;
    #12var1 = #10#4; #12var2 = #10#5; #12var3 = #10#6; #12var4 = #10#7;
|FINSI;
|FPRC;

|DEFBUCLE isocie37;
#10#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, bonific_3;
|FIN;

|PROCESO anyo94;
|SI #4#3 = "AF"; #12#041 = #12#041 + #4#7; |FINSI;
|SI #4#3 = "EL"; #12#041 = #12#041 + #4#7; |FINSI;
|SI #4#3 = "GI"; #12#042 = #12#042 + #4#7; |FINSI;
|SI #4#3 = "GA"; #12#043 = #12#043 + #4#7; |FINSI;
|SI #4#3 = "PC"; #12#044 = #12#044 + #4#7; |FINSI;
|SI #4#3 = "BI"; #12#045 = #12#045 + #4#7; |FINSI;
|SI #4#3 = "AE"; #12#046 = #12#046 + #4#7; |FINSI;
|SI #4#3 = "FP"; #12#047 = #12#047 + #4#7; |FINSI;
|FPRC;

|DEFBUCLE isocie06;
#4#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, anyo94;
|FIN;

|PROCESO expo;
|SI #6#3 = "1"; |Y #6#4 = 94; #12#048 = #12#048 + #6#8; |FINSI;
|SI #6#3 = "2"; |Y #6#4 = 94; #12#049 = #12#049 + #6#8; |FINSI;
|FPRC;

|DEFBUCLE isocie38;
#6#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, expo;
|FIN;

|PROCESO ris218;
contador = contador + 1;
|SI contador [ 4;
    var1 = contador + 58; var2 = var1 + 4; var3 = var2 + 4;
    var4 = var3     + 4;  var5 = var4 + 4; var6 = var5 + 4;
    #12var1 = #7#3; #12var2 = #7#4; #12var3 = #7#5;
    #12var4 = #7#6; #12var5 = #7#7; #12var6 = #7#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie16;
#7#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ris218;
|FIN;

|PROCESO hoja_03_12;
|DDEFECTO #12;

contador = 0; |BUCLE isocie40_2;
contador = 0; |BUCLE isocie37;
              |BUCLE isocie38;
              |BUCLE isocie06;
contador = 0; |BUCLE isocie16;

|ABRE #21;
#21#0 = empresa;
#21#1 = anyo;
|LEE 040#21=;
|SI FSalida ! 0; |DDEFECTO #21; |FINSI;
|CIERRA #21;

#12#50 = #21#42;
#12#52 = #21#45;
#12#53 = #21#48;
#12#54 = #21#51;
#12#55 = #21#54;
#12#56 = #21#150;
#12#57 = #21#135;
#12#58 = #21#144;

|ABRE #1;
#1#0 = empresa;
#1#1 = anyo;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|ABRE #14;
#14#0 = empresa;
#14#1 = anyo;
|LEE 040#14=;
|SI FSalida ! 0; |DDEFECTO #14; |FINSI;
|CIERRA #14;

informe = "h9320012";  |HAZ imprime;
|FPRC;
