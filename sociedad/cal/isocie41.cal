|FICHEROS;
    isocie41 #0;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &tipo      = "";
    &modo      = 0;

    anyo_ant   = 0;
    FEstado    = 0;
    FEstad     = 0;

    anyo_1     = 0;
    anyo_2     = 0;
    anyo_3     = 0;
    anyo_4     = 0;
    anyo_5     = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;

anyo_1 = anyo;
anyo_2 = anyo - 1;
anyo_3 = anyo - 2;
anyo_4 = anyo_3 - 1900;
anyo_5 = anyo_2 - 1900;

|PINTA 1729, anyo_1;
|PINTA 1743, anyo_2;
|PINTA 1756, anyo_3;
|PINTA 1774, anyo_4;
|PINTA 1777, anyo_5;

|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta;
#0#0 = empresa;
#0#1 = anyo;
|LEE 040#0=;
|SI FSalida = 0; |PINDA #0#0; |FINSI;
|FPRC;

|PROCESO calculo;
#0#04 = #0#02 + #0#03;
#0#07 = #0#05 + #0#06;
#0#10 = #0#08 + #0#09;
#0#11 = (#0#05 + #0#08) / 2;
#0#12 = (#0#06 + #0#09) / 2;
#0#13 = (#0#07 + #0#10) / 2;
|PINTA #0#4;
|PINTA #0#7;
|PINTA #0#10;
|PINTA #0#11;
|PINTA #0#12;
|PINTA #0#13;
|FPRC;
