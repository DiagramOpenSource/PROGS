|FICHEROS;
     isocie73 #73;
     isocie70 #70;
     isocie59 #1;
|FIN;

|VARIABLES;
      &empresa   = 0;
      &anyo      = 0;
      &modo      = 0;
      &Cuota     = 0;
      &Donde     = 1;

      nCampo       = 0;
      nCampo1      = 0;
      nCampo2      = 0;
      nCampo3      = 0;

      nEsteAnyo1_1  = 0;
      nEsteAnyo2_1  = 0;
      nEsteAnyo3_1  = 0;
      nEsteAnyo4_1  = 0;
      nEsteAnyo5_1  = 0;
      nEsteAnyo6_1  = 0;
      nEsteAnyo7_1  = 0;
      nEsteAnyo8_1  = 0;
      nEsteAnyo9_1  = 0;
      nEsteAnyo10_1 = 0;
      nEsteAnyo11_1 = 0;
      nEsteAnyo12_1 = 0;
      nEsteAnyo13_1 = 0;
      nEsteAnyo14_1 = 0;
      nEsteAnyo15_1 = 0;
      nEsteAnyo16_1 = 0;
      nEsteAnyo17_1 = 0;
      nEsteAnyo18_1 = 0;
      nEsteAnyo19_1 = 0;
      nEsteAnyo20_1 = 0;
      nEsteAnyo1_2  = 0;
      nEsteAnyo2_2  = 0;
      nEsteAnyo3_2  = 0;
      nEsteAnyo4_2  = 0;
      nEsteAnyo5_2  = 0;
      nEsteAnyo6_2  = 0;
      nEsteAnyo7_2  = 0;
      nEsteAnyo8_2  = 0;
      nEsteAnyo9_2  = 0;
      nEsteAnyo10_2 = 0;
      nEsteAnyo11_2 = 0;
      nEsteAnyo12_2 = 0;
      nEsteAnyo13_2 = 0;
      nEsteAnyo14_2 = 0;
      nEsteAnyo15_2 = 0;
      nEsteAnyo16_2 = 0;
      nEsteAnyo17_2 = 0;
      nEsteAnyo18_2 = 0;
      nEsteAnyo19_2 = 0;
      nEsteAnyo20_2 = 0;
      nCartuja1_95  = 0;
      nCartuja1_96  = 0;
      nCartuja1_97  = 0;
      nCartuja1_98  = 0;
      nCartuja1_99  = 0;
      nCartuja1_00  = 0;
      nCartuja2_95  = 0;
      nCartuja2_96  = 0;
      nCartuja2_97  = 0;
      nCartuja2_98  = 0;
      nCartuja2_99  = 0;
      nCartuja2_00  = 0;
      nCanaria1_96  = 0;
      nCanaria1_97  = 0;
      nCanaria1_98  = 0;
      nCanaria1_99  = 0;
      nCanaria1_00  = 0;
      nCanaria2_96  = 0;
      nCanaria2_97  = 0;
      nCanaria2_98  = 0;
      nCanaria2_99  = 0;
      nCanaria2_00  = 0;

      nParte1      = 0;
      nParte2      = 0;
      nAcum        = 0;
      nAplicado    = 0;
      nLimiteT     = 0;
      nLimite25    = 0;
      nLimite35    = 0;
      nLimite45    = 0;
      nLimite50    = 0;
      nLimite70    = 0;
      nLimite81    = 0;
      nLimite100   = 0;
      nTope        = 0;
      nDeducido    = 0;
      nSw          = 0;
      nVarCamp     = 0;

      FEstado = 0;
      x       = 0;
      tecla   = "";
      avance  = "815";
      atras   = "814";

      &EURODB = 0;
|FIN;

|PROGRAMA;
     |SI Donde = 1;
         |ABRE #1;
         #1#0 = empresa;
         #1#1 = anyo;
         |LEE 040#1=;
         |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
         |CIERRA #1;

         Cuota = #1#69;
     |FINSI;

     |ABRE #73;
     |PINPA #0#73;
     |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
     |SI modo = 4; |HAZ consulta; |FINSI;
     |CIERRA #73;
|FPRO;

|PROCESO pidedato;
     #73#0 = empresa;
     #73#1 = anyo;
     |LEE 101#73=;
     |SI FSalida ! 0;
         |DDEFECTO #73;
         #73#0 = empresa;
         #73#1 = anyo;
         |GRABA 020#73b;
     |FINSI;

     |CONFI "2321NDesea hacer el calculo de las deducciones : ";
     |SI FSalida = 0; |HAZ Calculo; |FINSI;

     |PINPA #0#73;
     |PINDA #0#73;
     |HAZ Resultado;
     |SI modo = 1; |ENDATOS #1#73;  |FINSI;
     |SI modo = 2; |ENDATOS #2#73;  |FINSI;
     |SI FSalida = 0;
         #73#0 = empresa;
         #73#1 = anyo;
         |GRABA 020#73a;
     |FINSI;
     |LIBERA #73;
     |CIERRA #73;
|FPRC;

|PROCESO consulta;
     avance = &255 + avance;
     atras = &255 + atras;
     #73#0 = empresa;
     #73#1 = anyo;
     |LEE 040#73=;
     |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
     |PINPA #0#73;
     |PINDA #0#73;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
     |PINPA #1#73;
     |PINDA #1#73;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
     |PINPA #2#73;
     |PINDA #2#73;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
     |PINPA #3#73;
     |PINDA #3#73;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
     |PINPA #4#73;
     |PINDA #4#73;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO Resultado;  |TIPO 0;
     |SI #73Campo = Contenido; |ACABA; |FINSI;

     nSw      = 0;
     nVarCamp = Campo;
     |SI nVarCamp = 002; |O nVarCamp = 003; nCampo3 = 004; nSw = 1; |FINSI;
     |SI nVarCamp = 005; |O nVarCamp = 006; nCampo3 = 007; nSw = 1; |FINSI;
     |SI nVarCamp = 008; |O nVarCamp = 009; nCampo3 = 010; nSw = 1; |FINSI;
     |SI nVarCamp = 011; |O nVarCamp = 012; nCampo3 = 013; nSw = 1; |FINSI;
     |SI nVarCamp = 014; |O nVarCamp = 015; nCampo3 = 016; nSw = 1; |FINSI;
     |SI nVarCamp = 017; |O nVarCamp = 018; nCampo3 = 019; nSw = 1; |FINSI;
     |SI nVarCamp = 020; |O nVarCamp = 021; nCampo3 = 022; nSw = 1; |FINSI;
     |SI nVarCamp = 023; |O nVarCamp = 024; nCampo3 = 025; nSw = 1; |FINSI;
     |SI nVarCamp = 026; |O nVarCamp = 027; nCampo3 = 028; nSw = 1; |FINSI;
     |SI nVarCamp = 029; |O nVarCamp = 030; nCampo3 = 031; nSw = 1; |FINSI;

     |SI nVarCamp = 035; |O nVarCamp = 036; nCampo3 = 037; nSw = 1; |FINSI;
     |SI nVarCamp = 038; |O nVarCamp = 039; nCampo3 = 040; nSw = 1; |FINSI;
     |SI nVarCamp = 041; |O nVarCamp = 042; nCampo3 = 043; nSw = 1; |FINSI;
     |SI nVarCamp = 044; |O nVarCamp = 045; nCampo3 = 046; nSw = 1; |FINSI;
     |SI nVarCamp = 047; |O nVarCamp = 048; nCampo3 = 049; nSw = 1; |FINSI;
     |SI nVarCamp = 050; |O nVarCamp = 051; nCampo3 = 052; nSw = 1; |FINSI;
     |SI nVarCamp = 053; |O nVarCamp = 054; nCampo3 = 055; nSw = 1; |FINSI;
     |SI nVarCamp = 056; |O nVarCamp = 057; nCampo3 = 058; nSw = 1; |FINSI;
     |SI nVarCamp = 059; |O nVarCamp = 060; nCampo3 = 061; nSw = 1; |FINSI;
     |SI nVarCamp = 062; |O nVarCamp = 063; nCampo3 = 064; nSw = 1; |FINSI;
     |SI nVarCamp = 065; |O nVarCamp = 066; nCampo3 = 067; nSw = 1; |FINSI;
     |SI nVarCamp = 068; |O nVarCamp = 069; nCampo3 = 070; nSw = 1; |FINSI;
     |SI nVarCamp = 071; |O nVarCamp = 072; nCampo3 = 073; nSw = 1; |FINSI;
     |SI nVarCamp = 074; |O nVarCamp = 075; nCampo3 = 076; nSw = 1; |FINSI;
     |SI nVarCamp = 077; |O nVarCamp = 078; nCampo3 = 079; nSw = 1; |FINSI;
     |SI nVarCamp = 080; |O nVarCamp = 081; nCampo3 = 082; nSw = 1; |FINSI;
     |SI nVarCamp = 083; |O nVarCamp = 084; nCampo3 = 085; nSw = 1; |FINSI;
     |SI nVarCamp = 086; |O nVarCamp = 087; nCampo3 = 088; nSw = 1; |FINSI;
     |SI nVarCamp = 089; |O nVarCamp = 090; nCampo3 = 091; nSw = 1; |FINSI;
     |SI nVarCamp = 092; |O nVarCamp = 093; nCampo3 = 094; nSw = 1; |FINSI;

     |SI nVarCamp = 098; |O nVarCamp = 099; nCampo3 = 100; nSw = 1; |FINSI;
     |SI nVarCamp = 101; |O nVarCamp = 102; nCampo3 = 103; nSw = 1; |FINSI;
     |SI nVarCamp = 104; |O nVarCamp = 105; nCampo3 = 106; nSw = 1; |FINSI;
     |SI nVarCamp = 107; |O nVarCamp = 108; nCampo3 = 109; nSw = 1; |FINSI;
     |SI nVarCamp = 110; |O nVarCamp = 111; nCampo3 = 112; nSw = 1; |FINSI;
     |SI nVarCamp = 113; |O nVarCamp = 114; nCampo3 = 115; nSw = 1; |FINSI;

     |SI nVarCamp = 119; |O nVarCamp = 120; nCampo3 = 121; nSw = 1; |FINSI;
     |SI nVarCamp = 122; |O nVarCamp = 123; nCampo3 = 124; nSw = 1; |FINSI;
     |SI nVarCamp = 125; |O nVarCamp = 126; nCampo3 = 127; nSw = 1; |FINSI;
     |SI nVarCamp = 128; |O nVarCamp = 129; nCampo3 = 130; nSw = 1; |FINSI;
     |SI nVarCamp = 131; |O nVarCamp = 132; nCampo3 = 133; nSw = 1; |FINSI;
     |SI nVarCamp = 134; |O nVarCamp = 135; nCampo3 = 136; nSw = 1; |FINSI;
     |SI nVarCamp = 137; |O nVarCamp = 138; nCampo3 = 139; nSw = 1; |FINSI;
     |SI nVarCamp = 140; |O nVarCamp = 141; nCampo3 = 142; nSw = 1; |FINSI;
     |SI nVarCamp = 143; |O nVarCamp = 144; nCampo3 = 145; nSw = 1; |FINSI;
     |SI nVarCamp = 146; |O nVarCamp = 147; nCampo3 = 148; nSw = 1; |FINSI;
     |SI nVarCamp = 149; |O nVarCamp = 150; nCampo3 = 151; nSw = 1; |FINSI;

     |SI nVarCamp = 155; |O nVarCamp = 156; nCampo3 = 157; nSw = 1; |FINSI;

     |SI nSw = 1;
         nCampo1 = nCampo3 - 2;
         nCampo2 = nCampo3 - 1;
         #73nCampo3 = #73nCampo1 - #73nCampo2;
         |PINTA #73nCampo3;
     |FINSI;

     #73#4   = 0;
     #73#7   = 0;
     #73#10  = 0;
     #73#13  = 0;
     #73#100 = 0;
     #73#121 = 0;
     #73#157 = 0;

     #73#32 = 0;
     #73#33 = 0;
     #73#34 = 0;
     |PARA nCampo = 2;  |SI nCampo [ 29; |HACIENDO nCampo = nCampo + 1;
                                #73#32 = #73#32 + #73nCampo;
           nCampo = nCampo + 1; #73#33 = #73#33 + #73nCampo;
           nCampo = nCampo + 1; #73#34 = #73#34 + #73nCampo;
     |SIGUE;

     #73#95 = 0;
     #73#96 = 0;
     #73#97 = 0;
     |PARA nCampo = 35; |SI nCampo [ 92; |HACIENDO nCampo = nCampo + 1;
                                #73#95 = #73#95 + #73nCampo;
           nCampo = nCampo + 1; #73#96 = #73#96 + #73nCampo;
           nCampo = nCampo + 1; #73#97 = #73#97 + #73nCampo;
     |SIGUE;

     #73#116 = 0;
     #73#117 = 0;
     #73#118 = 0;
     |PARA nCampo = 98; |SI nCampo [ 113; |HACIENDO nCampo = nCampo + 1;
                                #73#116 = #73#116 + #73nCampo;
           nCampo = nCampo + 1; #73#117 = #73#117 + #73nCampo;
           nCampo = nCampo + 1; #73#118 = #73#118 + #73nCampo;
     |SIGUE;

     #73#152 = 0;
     #73#153 = 0;
     #73#154 = 0;
     |PARA nCampo = 119; |SI nCampo [ 149; |HACIENDO nCampo = nCampo + 1;
                                #73#152 = #73#152 + #73nCampo;
           nCampo = nCampo + 1; #73#153 = #73#153 + #73nCampo;
           nCampo = nCampo + 1; #73#154 = #73#154 + #73nCampo;
     |SIGUE;

     #73#158 = #73#155;
     #73#159 = #73#156;
     #73#160 = #73#157;

     |PINTA #73#32;
     |PINTA #73#33;
     |PINTA #73#34;
     |PINTA #73#95;
     |PINTA #73#96;
     |PINTA #73#97;
     |PINTA #73#116;
     |PINTA #73#117;
     |PINTA #73#118;
     |PINTA #73#152;
     |PINTA #73#153;
     |PINTA #73#154;
     |PINTA #73#158;
     |PINTA #73#159;
     |PINTA #73#160;

     Campo = nVarCamp;
|FPRC;

|| ************************************************************************
||                    CALCULOS
|| ************************************************************************

|PROCESO CogeCartuja;
     |SI #70#7 ] 773;  |Y #70#7 [ 830;
         |SI #70#8 = 35;
             |SI #70#7 = 773;  nEsteAnyo1_1  = nEsteAnyo1_1  + #70#11;  |FINSI;
             |SI #70#7 = 776;  nEsteAnyo2_1  = nEsteAnyo2_1  + #70#11;  |FINSI;
             |SI #70#7 = 779;  nEsteAnyo3_1  = nEsteAnyo3_1  + #70#11;  |FINSI;
             |SI #70#7 = 782;  nEsteAnyo4_1  = nEsteAnyo4_1  + #70#11;  |FINSI;
             |SI #70#7 = 785;  nEsteAnyo5_1  = nEsteAnyo5_1  + #70#11;  |FINSI;
             |SI #70#7 = 788;  nEsteAnyo6_1  = nEsteAnyo6_1  + #70#11;  |FINSI;
             |SI #70#7 = 791;  nEsteAnyo7_1  = nEsteAnyo7_1  + #70#11;  |FINSI;
             |SI #70#7 = 794;  nEsteAnyo8_1  = nEsteAnyo8_1  + #70#11;  |FINSI;
             |SI #70#7 = 797;  nEsteAnyo9_1  = nEsteAnyo9_1  + #70#11;  |FINSI;
             |SI #70#7 = 800;  nEsteAnyo10_1 = nEsteAnyo10_1 + #70#11;  |FINSI;
             |SI #70#7 = 803;  nEsteAnyo11_1 = nEsteAnyo11_1 + #70#11;  |FINSI;
             |SI #70#7 = 806;  nEsteAnyo12_1 = nEsteAnyo12_1 + #70#11;  |FINSI;
             |SI #70#7 = 809;  nEsteAnyo13_1 = nEsteAnyo13_1 + #70#11;  |FINSI;
             |SI #70#7 = 812;  nEsteAnyo14_1 = nEsteAnyo14_1 + #70#11;  |FINSI;
             |SI #70#7 = 815;  nEsteAnyo15_1 = nEsteAnyo15_1 + #70#11;  |FINSI;
             |SI #70#7 = 818;  nEsteAnyo16_1 = nEsteAnyo16_1 + #70#11;  |FINSI;
             |SI #70#7 = 821;  nEsteAnyo17_1 = nEsteAnyo17_1 + #70#11;  |FINSI;
             |SI #70#7 = 824;  nEsteAnyo18_1 = nEsteAnyo18_1 + #70#11;  |FINSI;
             |SI #70#7 = 827;  nEsteAnyo19_1 = nEsteAnyo19_1 + #70#11;  |FINSI;
             |SI #70#7 = 830;  nEsteAnyo20_1 = nEsteAnyo20_1 + #70#11;  |FINSI;
         |SINO;
             |SI #70#7 = 773;  nEsteAnyo1_2  = nEsteAnyo1_2  + #70#11;  |FINSI;
             |SI #70#7 = 776;  nEsteAnyo2_2  = nEsteAnyo2_2  + #70#11;  |FINSI;
             |SI #70#7 = 779;  nEsteAnyo3_2  = nEsteAnyo3_2  + #70#11;  |FINSI;
             |SI #70#7 = 782;  nEsteAnyo4_2  = nEsteAnyo4_2  + #70#11;  |FINSI;
             |SI #70#7 = 785;  nEsteAnyo5_2  = nEsteAnyo5_2  + #70#11;  |FINSI;
             |SI #70#7 = 788;  nEsteAnyo6_2  = nEsteAnyo6_2  + #70#11;  |FINSI;
             |SI #70#7 = 791;  nEsteAnyo7_2  = nEsteAnyo7_2  + #70#11;  |FINSI;
             |SI #70#7 = 794;  nEsteAnyo8_2  = nEsteAnyo8_2  + #70#11;  |FINSI;
             |SI #70#7 = 797;  nEsteAnyo9_2  = nEsteAnyo9_2  + #70#11;  |FINSI;
             |SI #70#7 = 800;  nEsteAnyo10_2 = nEsteAnyo10_2 + #70#11;  |FINSI;
             |SI #70#7 = 803;  nEsteAnyo11_2 = nEsteAnyo11_2 + #70#11;  |FINSI;
             |SI #70#7 = 806;  nEsteAnyo12_2 = nEsteAnyo12_2 + #70#11;  |FINSI;
             |SI #70#7 = 809;  nEsteAnyo13_2 = nEsteAnyo13_2 + #70#11;  |FINSI;
             |SI #70#7 = 812;  nEsteAnyo14_2 = nEsteAnyo14_2 + #70#11;  |FINSI;
             |SI #70#7 = 815;  nEsteAnyo15_2 = nEsteAnyo15_2 + #70#11;  |FINSI;
             |SI #70#7 = 818;  nEsteAnyo16_2 = nEsteAnyo16_2 + #70#11;  |FINSI;
             |SI #70#7 = 821;  nEsteAnyo17_2 = nEsteAnyo17_2 + #70#11;  |FINSI;
             |SI #70#7 = 824;  nEsteAnyo18_2 = nEsteAnyo18_2 + #70#11;  |FINSI;
             |SI #70#7 = 827;  nEsteAnyo19_2 = nEsteAnyo19_2 + #70#11;  |FINSI;
             |SI #70#7 = 830;  nEsteAnyo20_2 = nEsteAnyo20_2 + #70#11;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #70#7 ] 835;  |Y #70#7 [ 849;
         |SI #70#8 = 25;
             |SI #70#7 = 835;  nCartuja1_95 = nCartuja1_95 + #70#11;  |FINSI;
             |SI #70#7 = 837;  nCartuja1_96 = nCartuja1_96 + #70#11;  |FINSI;
             |SI #70#7 = 840;  nCartuja1_97 = nCartuja1_97 + #70#11;  |FINSI;
             |SI #70#7 = 843;  nCartuja1_98 = nCartuja1_98 + #70#11;  |FINSI;
             |SI #70#7 = 846;  nCartuja1_99 = nCartuja1_99 + #70#11;  |FINSI;
             |SI #70#7 = 849;  nCartuja1_00 = nCartuja1_00 + #70#11;  |FINSI;
         |SINO;
             |SI #70#7 = 835;  nCartuja2_95 = nCartuja2_95 + #70#11;  |FINSI;
             |SI #70#7 = 837;  nCartuja2_96 = nCartuja2_96 + #70#11;  |FINSI;
             |SI #70#7 = 840;  nCartuja2_97 = nCartuja2_97 + #70#11;  |FINSI;
             |SI #70#7 = 843;  nCartuja2_98 = nCartuja2_98 + #70#11;  |FINSI;
             |SI #70#7 = 846;  nCartuja2_99 = nCartuja2_99 + #70#11;  |FINSI;
             |SI #70#7 = 849;  nCartuja2_00 = nCartuja2_00 + #70#11;  |FINSI;
        |FINSI;
     |FINSI;

     |SI #70#7 ] 868;  |Y #70#7 [ 885;
         |SI #70#8 = 70;
             |SI #70#7 = 868;  nCanaria1_96 = nCanaria1_96 + #70#11;  |FINSI;
             |SI #70#7 = 871;  nCanaria1_97 = nCanaria1_97 + #70#11;  |FINSI;
             |SI #70#7 = 874;  nCanaria1_98 = nCanaria1_98 + #70#11;  |FINSI;
             |SI #70#7 = 882;  nCanaria1_99 = nCanaria1_99 + #70#11;  |FINSI;
             |SI #70#7 = 885;  nCanaria1_00 = nCanaria1_00 + #70#11;  |FINSI;
        |SINO;
             |SI #70#7 = 868;  nCanaria2_96 = nCanaria2_96 + #70#11;  |FINSI;
             |SI #70#7 = 871;  nCanaria2_97 = nCanaria2_97 + #70#11;  |FINSI;
             |SI #70#7 = 874;  nCanaria2_98 = nCanaria2_98 + #70#11;  |FINSI;
             |SI #70#7 = 882;  nCanaria2_99 = nCanaria2_99 + #70#11;  |FINSI;
             |SI #70#7 = 885;  nCanaria2_00 = nCanaria2_00 + #70#11;  |FINSI;
        |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isocie70;
     #70#1;
     ;
     #73#0, #73#1, 01;
     #73#0, #73#1, 99;
     ;
     NULL, CogeCartuja;
|FIN;

|PROCESO Deduce;
     nAplicado = 0;

     |SI nAcum = 0;    |ACABA;  |FINSI;
     |SI nLimiteT [ 0; |ACABA;  |FINSI;
     |SI nTope    = 0; |ACABA;  |FINSI;

     |SI nDeducido > nTope;
         nDeducido = nTope;
         nTope     = 0;
     |SINO;
         nTope = nTope - nDeducido;
     |FINSI;

     nAcum = nAcum - nDeducido;
     |SI nAcum ] 0
         nAplicado = nDeducido;
     |SINO;
         nAplicado = nDeducido + nAcum;
         nAcum     = 0;
     |FINSI;

     nLimiteT = nLimiteT - nAplicado;
     |SI nLimiteT < 0;
         nAplicado = nAplicado + nLimiteT;
         nLimiteT  = 0;
     |FINSI;
|FPRC;

|PROCESO Calculo;
     |CUADRO 1114 1664;

     |ATRI P;
     |MENSA "2330 Calculando ";
     |ATRI p;

     nEsteAnyo1_1  = 0;
     nEsteAnyo2_1  = 0;
     nEsteAnyo3_1  = 0;
     nEsteAnyo4_1  = 0;
     nEsteAnyo5_1  = 0;
     nEsteAnyo6_1  = 0;
     nEsteAnyo7_1  = 0;
     nEsteAnyo8_1  = 0;
     nEsteAnyo9_1  = 0;
     nEsteAnyo10_1 = 0;
     nEsteAnyo11_1 = 0;
     nEsteAnyo12_1 = 0;
     nEsteAnyo13_1 = 0;
     nEsteAnyo14_1 = 0;
     nEsteAnyo15_1 = 0;
     nEsteAnyo16_1 = 0;
     nEsteAnyo17_1 = 0;
     nEsteAnyo18_1 = 0;
     nEsteAnyo19_1 = 0;
     nEsteAnyo20_1 = 0;
     nEsteAnyo1_2  = 0;
     nEsteAnyo2_2  = 0;
     nEsteAnyo3_2  = 0;
     nEsteAnyo4_2  = 0;
     nEsteAnyo5_2  = 0;
     nEsteAnyo6_2  = 0;
     nEsteAnyo7_2  = 0;
     nEsteAnyo8_2  = 0;
     nEsteAnyo9_2  = 0;
     nEsteAnyo10_2 = 0;
     nEsteAnyo11_2 = 0;
     nEsteAnyo12_2 = 0;
     nEsteAnyo13_2 = 0;
     nEsteAnyo14_2 = 0;
     nEsteAnyo15_2 = 0;
     nEsteAnyo16_2 = 0;
     nEsteAnyo17_2 = 0;
     nEsteAnyo18_2 = 0;
     nEsteAnyo19_2 = 0;
     nEsteAnyo20_2 = 0;
     nCartuja1_95  = 0;
     nCartuja1_96  = 0;
     nCartuja1_97  = 0;
     nCartuja1_98  = 0;
     nCartuja1_99  = 0;
     nCartuja1_00  = 0;
     nCartuja2_95  = 0;
     nCartuja2_96  = 0;
     nCartuja2_97  = 0;
     nCartuja2_98  = 0;
     nCartuja2_99  = 0;
     nCartuja2_00  = 0;
     nCanaria1_96  = 0;
     nCanaria1_97  = 0;
     nCanaria1_98  = 0;
     nCanaria1_99  = 0;
     nCanaria1_00  = 0;
     nCanaria2_96  = 0;
     nCanaria2_97  = 0;
     nCanaria2_98  = 0;
     nCanaria2_99  = 0;
     nCanaria2_00  = 0;

     |BUCLE isocie70;

     nLimiteT = Cuota;

     nLimite25  = (Cuota % 25) ! EURODB;
     nLimite35  = (Cuota % 35) ! EURODB;
     nLimite45  = (Cuota % 45) ! EURODB;
     nLimite50  = (Cuota % 50) ! EURODB;
     nLimite70  = (Cuota % 70) ! EURODB;
     nLimite81  = (Cuota % 81) ! EURODB;
     nLimite100 = Cuota;

     nParte1   = #73#32;
     nParte2   = #73#119 + #73#122 + #73#125 + #73#128 + #73#131;

     nAcum     = nLimite35;  nTope = nParte1;
     nDeducido = #73#2;   |HAZ Deduce;  #73#3  = nAplicado;
     nDeducido = #73#5;   |HAZ Deduce;  #73#6  = nAplicado;
     nDeducido = #73#8;   |HAZ Deduce;  #73#9  = nAplicado;
     nDeducido = #73#11;  |HAZ Deduce;  #73#12 = nAplicado;
     nDeducido = #73#14;  |HAZ Deduce;  #73#15 = nAplicado;
     nDeducido = #73#17;  |HAZ Deduce;  #73#18 = nAplicado;
     nDeducido = #73#20;  |HAZ Deduce;  #73#21 = nAplicado;
     nDeducido = #73#23;  |HAZ Deduce;  #73#24 = nAplicado;
     nDeducido = #73#26;  |HAZ Deduce;  #73#27 = nAplicado;
     nDeducido = #73#29;  |HAZ Deduce;  #73#30 = nAplicado;

     nAcum = nLimite45;
     nTope = nEsteAnyo1_2;  nDeducido = #73#35; |HAZ Deduce;  #73#36 = nAplicado;
     nTope = nEsteAnyo2_2;  nDeducido = #73#38; |HAZ Deduce;  #73#39 = nAplicado;
     nTope = nEsteAnyo3_2;  nDeducido = #73#41; |HAZ Deduce;  #73#42 = nAplicado;
     nTope = nEsteAnyo4_2;  nDeducido = #73#44; |HAZ Deduce;  #73#45 = nAplicado;
     nTope = nEsteAnyo5_2;  nDeducido = #73#47; |HAZ Deduce;  #73#48 = nAplicado;
     nTope = nEsteAnyo6_2;  nDeducido = #73#50; |HAZ Deduce;  #73#51 = nAplicado;
     nTope = nEsteAnyo7_2;  nDeducido = #73#53; |HAZ Deduce;  #73#54 = nAplicado;
     nTope = nEsteAnyo8_2;  nDeducido = #73#56; |HAZ Deduce;  #73#57 = nAplicado;
     nTope = nEsteAnyo9_2;  nDeducido = #73#59; |HAZ Deduce;  #73#60 = nAplicado;
     nTope = nEsteAnyo10_2; nDeducido = #73#62; |HAZ Deduce;  #73#63 = nAplicado;
     nTope = nEsteAnyo11_2; nDeducido = #73#65; |HAZ Deduce;  #73#66 = nAplicado;
     nTope = nEsteAnyo12_2; nDeducido = #73#68; |HAZ Deduce;  #73#69 = nAplicado;
     nTope = nEsteAnyo13_2; nDeducido = #73#71; |HAZ Deduce;  #73#72 = nAplicado;
     nTope = nEsteAnyo14_2; nDeducido = #73#74; |HAZ Deduce;  #73#75 = nAplicado;
     nTope = nEsteAnyo15_2; nDeducido = #73#77; |HAZ Deduce;  #73#78 = nAplicado;
     nTope = nEsteAnyo16_2; nDeducido = #73#80; |HAZ Deduce;  #73#81 = nAplicado;
     nTope = nEsteAnyo17_2; nDeducido = #73#83; |HAZ Deduce;  #73#84 = nAplicado;
     nTope = nEsteAnyo18_2; nDeducido = #73#86; |HAZ Deduce;  #73#87 = nAplicado;
     nTope = nEsteAnyo19_2; nDeducido = #73#89; |HAZ Deduce;  #73#90 = nAplicado;
     nTope = nEsteAnyo20_2; nDeducido = #73#92; |HAZ Deduce;  #73#93 = nAplicado;

     nAcum = nLimite35;
     nTope = nEsteAnyo1_1;  nDeducido = #73#35 - #73#36; |HAZ Deduce;  #73#36 = #73#36 + nAplicado;
     nTope = nEsteAnyo2_1;  nDeducido = #73#38 - #73#39; |HAZ Deduce;  #73#39 = #73#39 + nAplicado;
     nTope = nEsteAnyo3_1;  nDeducido = #73#41 - #73#42; |HAZ Deduce;  #73#42 = #73#42 + nAplicado;
     nTope = nEsteAnyo4_1;  nDeducido = #73#44 - #73#45; |HAZ Deduce;  #73#45 = #73#45 + nAplicado;
     nTope = nEsteAnyo5_1;  nDeducido = #73#47 - #73#48; |HAZ Deduce;  #73#48 = #73#48 + nAplicado;
     nTope = nEsteAnyo6_1;  nDeducido = #73#50 - #73#51; |HAZ Deduce;  #73#51 = #73#51 + nAplicado;
     nTope = nEsteAnyo7_1;  nDeducido = #73#53 - #73#54; |HAZ Deduce;  #73#54 = #73#54 + nAplicado;
     nTope = nEsteAnyo8_1;  nDeducido = #73#56 - #73#57; |HAZ Deduce;  #73#57 = #73#57 + nAplicado;
     nTope = nEsteAnyo9_1;  nDeducido = #73#59 - #73#60; |HAZ Deduce;  #73#60 = #73#60 + nAplicado;
     nTope = nEsteAnyo10_1; nDeducido = #73#62 - #73#63; |HAZ Deduce;  #73#63 = #73#63 + nAplicado;
     nTope = nEsteAnyo11_1; nDeducido = #73#65 - #73#66; |HAZ Deduce;  #73#66 = #73#66 + nAplicado;
     nTope = nEsteAnyo12_1; nDeducido = #73#68 - #73#69; |HAZ Deduce;  #73#69 = #73#69 + nAplicado;
     nTope = nEsteAnyo13_1; nDeducido = #73#71 - #73#72; |HAZ Deduce;  #73#72 = #73#72 + nAplicado;
     nTope = nEsteAnyo14_1; nDeducido = #73#74 - #73#75; |HAZ Deduce;  #73#75 = #73#75 + nAplicado;
     nTope = nEsteAnyo15_1; nDeducido = #73#77 - #73#78; |HAZ Deduce;  #73#78 = #73#78 + nAplicado;
     nTope = nEsteAnyo16_1; nDeducido = #73#80 - #73#81; |HAZ Deduce;  #73#81 = #73#81 + nAplicado;
     nTope = nEsteAnyo17_1; nDeducido = #73#83 - #73#84; |HAZ Deduce;  #73#84 = #73#84 + nAplicado;
     nTope = nEsteAnyo18_1; nDeducido = #73#86 - #73#87; |HAZ Deduce;  #73#87 = #73#87 + nAplicado;
     nTope = nEsteAnyo19_1; nDeducido = #73#89 - #73#90; |HAZ Deduce;  #73#90 = #73#90 + nAplicado;
     nTope = nEsteAnyo20_1; nDeducido = #73#92 - #73#93; |HAZ Deduce;  #73#93 = #73#93 + nAplicado;

     nAcum = nLimite50;
     nTope = nCartuja2_95; nDeducido = #73#98;   |HAZ Deduce;  #73#99  = nAplicado;
     nTope = nCartuja2_96; nDeducido = #73#101;  |HAZ Deduce;  #73#102 = nAplicado;
     nTope = nCartuja2_97; nDeducido = #73#104;  |HAZ Deduce;  #73#105 = nAplicado;
     nTope = nCartuja2_98; nDeducido = #73#107;  |HAZ Deduce;  #73#108 = nAplicado;
     nTope = nCartuja2_99; nDeducido = #73#110;  |HAZ Deduce;  #73#111 = nAplicado;
     nTope = nCartuja2_00; nDeducido = #73#113;  |HAZ Deduce;  #73#114 = nAplicado;

     nAcum = nLimite25;
     nTope = nCartuja1_95; nDeducido = #73#98  - #73#99;   |HAZ Deduce;  #73#99  = #73#99  + nAplicado;
     nTope = nCartuja1_96; nDeducido = #73#101 - #73#102;  |HAZ Deduce;  #73#102 = #73#102 + nAplicado;
     nTope = nCartuja1_97; nDeducido = #73#104 - #73#105;  |HAZ Deduce;  #73#105 = #73#105 + nAplicado;
     nTope = nCartuja1_98; nDeducido = #73#107 - #73#108;  |HAZ Deduce;  #73#108 = #73#108 + nAplicado;
     nTope = nCartuja1_99; nDeducido = #73#110 - #73#111;  |HAZ Deduce;  #73#111 = #73#111 + nAplicado;
     nTope = nCartuja1_00; nDeducido = #73#113 - #73#114;  |HAZ Deduce;  #73#114 = #73#114 + nAplicado;

     nAcum     = nLimite70;  nTope = nParte2;
     nDeducido = #73#119;  |HAZ Deduce;  #73#120 = nAplicado;
     nDeducido = #73#122;  |HAZ Deduce;  #73#123 = nAplicado;
     nDeducido = #73#125;  |HAZ Deduce;  #73#126 = nAplicado;
     nDeducido = #73#128;  |HAZ Deduce;  #73#129 = nAplicado;
     nDeducido = #73#131;  |HAZ Deduce;  #73#132 = nAplicado;

     nAcum = nLimite81;
     nTope = nCanaria2_96; nDeducido = #73#134;  |HAZ Deduce;  #73#135 = nAplicado;
     nTope = nCanaria2_97; nDeducido = #73#137;  |HAZ Deduce;  #73#138 = nAplicado;
     nTope = nCanaria2_98; nDeducido = #73#140;  |HAZ Deduce;  #73#141 = nAplicado;
     nTope = nCanaria2_99; nDeducido = #73#143;  |HAZ Deduce;  #73#144 = nAplicado;
     nTope = nCanaria2_00; nDeducido = #73#146;  |HAZ Deduce;  #73#147 = nAplicado;

     nAcum = nLimite70;
     nTope = nCanaria1_96; nDeducido = #73#134 - #73#135;  |HAZ Deduce;  #73#135 = #73#135 + nAplicado;
     nTope = nCanaria1_97; nDeducido = #73#137 - #73#138;  |HAZ Deduce;  #73#138 = #73#138 + nAplicado;
     nTope = nCanaria1_98; nDeducido = #73#140 - #73#141;  |HAZ Deduce;  #73#141 = #73#141 + nAplicado;
     nTope = nCanaria1_99; nDeducido = #73#143 - #73#144;  |HAZ Deduce;  #73#144 = #73#144 + nAplicado;
     nTope = nCanaria1_00; nDeducido = #73#146 - #73#147;  |HAZ Deduce;  #73#147 = #73#147 + nAplicado;

     nAcum     = nLimite50;  nTope = #73#149;
     nDeducido = #73#149;  |HAZ Deduce;  #73#150 = nAplicado;

     nAcum     = nLimite100;  nTope = #73#155;
     nDeducido = #73#155;  |HAZ Deduce;  #73#156 = nAplicado;

     #73#32 = 0;
     #73#33 = 0;
     #73#34 = 0;
     |PARA nCampo = 2;  |SI nCampo [ 29; |HACIENDO nCampo = nCampo + 3;
                                 #73#32     = #73#32    + #73nCampo;
           nCampo1 = nCampo + 1; #73#33     = #73#33    + #73nCampo1;
           nCampo2 = nCampo + 2; #73nCampo2 = #73nCampo - #73nCampo1;
                                 #73#34     = #73#34    + #73nCampo2;
     |SIGUE;

     #73#95 = 0;
     #73#96 = 0;
     #73#97 = 0;
     |PARA nCampo = 35; |SI nCampo [ 92; |HACIENDO nCampo = nCampo + 3;
                                 #73#95     = #73#95    + #73nCampo;
           nCampo1 = nCampo + 1; #73#96     = #73#96    + #73nCampo1;
           nCampo2 = nCampo + 2; #73nCampo2 = #73nCampo - #73nCampo1;
                                 #73#97     = #73#97    + #73nCampo2;
     |SIGUE;

     #73#116 = 0;
     #73#117 = 0;
     #73#118 = 0;
     |PARA nCampo = 98; |SI nCampo [ 113; |HACIENDO nCampo = nCampo + 3;
                                 #73#116    = #73#116   + #73nCampo;
           nCampo1 = nCampo + 1; #73#117    = #73#117   + #73nCampo1;
           nCampo2 = nCampo + 2; #73nCampo2 = #73nCampo - #73nCampo1;
                                 #73#118    = #73#118   + #73nCampo2;
     |SIGUE;

     #73#152 = 0;
     #73#153 = 0;
     #73#154 = 0;
     |PARA nCampo = 119; |SI nCampo [ 149; |HACIENDO nCampo = nCampo + 3;
                                 #73#152    = #73#152   + #73nCampo;
           nCampo1 = nCampo + 1; #73#153    = #73#153   + #73nCampo1;
           nCampo2 = nCampo + 2; #73nCampo2 = #73nCampo - #73nCampo1;
                                 #73#154    = #73#154   + #73nCampo2;
     |SIGUE;

     #73#158 = 0;
     #73#159 = 0;
     #73#160 = 0;
     |PARA nCampo = 155; |SI nCampo [ 155; |HACIENDO nCampo = nCampo + 3;
                                 #73#158    = #73#158   + #73nCampo;
           nCampo1 = nCampo + 1; #73#159    = #73#159   + #73nCampo1;
           nCampo2 = nCampo + 2; #73nCampo2 = #73nCampo - #73nCampo1;
                                 #73#160    = #73#160   + #73nCampo2;
     |SIGUE;
|FPRC;
