|FICHEROS;
   isocie05 #0;
   isocie11 #1;
   isocie31 #2;
   isocie43 #3;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &anyo      = 0;
   &modo      = 0;
   &modelito  = 0;

   anyo_al    = "";
   anyo_nu    = 0;
   anyo_li    = 0;
   FEstado    = 0;
   xxx        = 0;
|FIN;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 99;
|FRUT;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1;
    |ENTLINEAL #1#0,3,1,14,0,inferior,superior;
|FINSI;
|SI modo = 2;
    |ENTLINEAL #1#0,3,2,14,0,inferior,superior;
|FINSI;
|SI modo = 4;
    |ENTLINEAL #1#0,3,4,14,0,inferior,superior;
|FINSI;
|FPRO;

|PROCESO pintaany; |TIPO 7;
anyo_al = anyo;
anyo_al = anyo_al % -102;
anyo_nu = anyo_al;

|SI #0#3 ! 00; |ACABA; |FINSI;
#0#3 = anyo_nu - 1;
|PINTA #0#3;
|FPRC;

|PROCESO limite; |TIPO 0;
anyo_li = anyo_nu - 5;
|SI #0#3 < anyo_li; |AVISO; |ERROR; |ACABA; |FINSI;

|SI #0#3 ] anyo_nu; |AVISO; |ERROR; |ACABA; |FINSI;

|SI #0#3 = 88; #0#4 = 20; |FINSI;
|SI #0#3 = 89; #0#4 = 20; |FINSI;
|SI #0#3 = 90; #0#4 = 25; |FINSI;
|SI #0#3 = 91; #0#4 = 25; |FINSI;
|SI #0#3 = 92; #0#4 = 25; |FINSI;
|SI #0#3 = 93; #0#4 = 25; |FINSI;
|SI #0#3 = 94; #0#4 = 25; |FINSI;
|PINTA #0#4;
|FPRC;

|PROCESO resumen; |TIPO 2;
|SI #0#1 = 1992; |HAZ isocie11; |FINSI;
|SI #0#1 = 1993; |HAZ isocie31; |FINSI;
|SI #0#1 = 1994; |HAZ isocie43; |FINSI;
|FPRC;

|PROCESO isocie11;
|ABRE #1;
#1#0 = #0#0;
#1#1 = #0#1;
|LIBERA #1;
|LEE 110#1=;
FEstado = FSalida;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;

#1#0 = #0#0;
#1#1 = #0#1;

|SI #0#3 = 88; #1#2  = #1#2  +. #0#7; #1#4  = #1#4  +. #0#7; |FINSI;
|SI #0#3 = 89; #1#8  = #1#8  +. #0#7; #1#10 = #1#10 +. #0#7; |FINSI;
|SI #0#3 = 90; #1#17 = #1#17 +. #0#7; #1#19 = #1#19 +. #0#7; |FINSI;
|SI #0#3 = 91; #1#23 = #1#23 +. #0#7; #1#25 = #1#25 +. #0#7; |FINSI;

#1#14 = #1#2 + #1#5 + #1#8  + #1#11;
#1#15 = #1#3 + #1#6 + #1#9  + #1#12;
#1#16 = #1#4 + #1#7 + #1#10 + #1#13;

#1#29 = #1#17 + #1#20 + #1#23 + #1#26;
#1#30 = #1#18 + #1#21 + #1#24 + #1#27;
#1#31 = #1#19 + #1#22 + #1#25 + #1#28;

#1#32 = #1#14 + #1#29;
#1#33 = #1#15 + #1#30;
#1#34 = #1#16 + #1#31;

|SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
|CIERRA #1;
|FPRC;

|PROCESO isocie31;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#1;
|LIBERA #2;
|LEE 110#2=;
FEstado = FSalida;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

#2#0 = #0#0;
#2#1 = #0#1;

|SI #0#3 = 88; #2#02 = #2#02 +. #0#7; #2#04 = #2#04 +. #0#7; |FINSI;
|SI #0#3 = 89; #2#08 = #2#08 +. #0#7; #2#10 = #2#10 +. #0#7; |FINSI;
|SI #0#3 = 90; #2#17 = #2#17 +. #0#7; #2#19 = #2#19 +. #0#7; |FINSI;
|SI #0#3 = 91; #2#23 = #2#23 +. #0#7; #2#25 = #2#25 +. #0#7; |FINSI;
|SI #0#3 = 92; #2#29 = #2#29 +. #0#7; #2#31 = #2#31 +. #0#7; |FINSI;

#2#014 = #2#002 + #2#005 + #2#008 + #2#011;
#2#015 = #2#003 + #2#006 + #2#009 + #2#012;
#2#016 = #2#004 + #2#007 + #2#010 + #2#013;

#2#035 = #2#017 + #2#020 + #2#023 + #2#026 + #2#029 + #2#032;
#2#036 = #2#018 + #2#021 + #2#024 + #2#027 + #2#030 + #2#033;
#2#037 = #2#019 + #2#022 + #2#025 + #2#028 + #2#031 + #2#034;

#2#038 = #2#014 + #2#035;
#2#039 = #2#015 + #2#036;
#2#040 = #2#016 + #2#037;

#2#059 = #2#041 + #2#044 + #2#047 + #2#050 + #2#053 + #2#56;
#2#060 = #2#042 + #2#045 + #2#048 + #2#051 + #2#054 + #2#57;
#2#061 = #2#043 + #2#046 + #2#049 + #2#052 + #2#055 + #2#58;

|SI FEstado = 0; |GRABA 020#2a; |SINO; |GRABA 020#2n; |FINSI;
|CIERRA #2;
|FPRC;

|PROCESO isocie43;
|ABRE #3;
#3#0 = #0#0;
#3#1 = #0#1;
|LIBERA #3;
|LEE 110#3=;
FEstado = FSalida;
|SI FSalida ! 0; |DDEFECTO #3; |FINSI;

#3#0 = #0#0;
#3#1 = #0#1;

|SI #0#3 = 89; #3#02 = #3#02 +. #0#7; #3#04 = #3#04 +. #0#7; |FINSI;
|SI #0#3 = 90; #3#11 = #3#11 +. #0#7; #3#13 = #3#13 +. #0#7; |FINSI;
|SI #0#3 = 91; #3#17 = #3#17 +. #0#7; #3#19 = #3#19 +. #0#7; |FINSI;
|SI #0#3 = 92; #3#23 = #3#23 +. #0#7; #3#25 = #3#25 +. #0#7; |FINSI;
|SI #0#3 = 93; #3#29 = #3#29 +. #0#7; #3#31 = #3#31 +. #0#7; |FINSI;

#3#008 = #3#002 + #3#005;
#3#009 = #3#003 + #3#006;
#3#010 = #3#004 + #3#007;

#3#035 = #3#011 + #3#014 + #3#017 + #3#020 + #3#023 + #3#026 + #3#029 + #3#032;
#3#036 = #3#012 + #3#015 + #3#018 + #3#021 + #3#024 + #3#027 + #3#030 + #3#033;
#3#037 = #3#013 + #3#016 + #3#019 + #3#022 + #3#025 + #3#028 + #3#031 + #3#034;

#3#038 = #3#008 + #3#035;
#3#039 = #3#009 + #3#036;
#3#040 = #3#010 + #3#037;

#3#059 = #3#041 + #3#044 + #3#047 + #3#050 + #3#053 + #3#56 + #3#62;
#3#060 = #3#042 + #3#045 + #3#048 + #3#051 + #3#054 + #3#57 + #3#63;
#3#061 = #3#043 + #3#046 + #3#049 + #3#052 + #3#055 + #3#58 + #3#64;

|SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
|CIERRA #3;
|FPRC;
