|FICHEROS;
      isoy2010 #0;
      maempr10 #200;
      maempr02 #202;
      maempr03 #203;
      maempr04 #204;
      maempr06 #206;
      maempr11 #201;

      isocie00 #1000;
      isom0000 #100;
      isom0001 #101;
      isom0002 #102;
      isom0003 #103;
      isom0004 #104;
      isom0005 #105;
      isom0006 #106;
      isom0007 #107;
      isom0008 #108;
      isom0009 #109;
      isom0011 #111;
      isom0012 #112;
      isom0016 #116;

      isom0500 #500;
      isom0501 #501;
      isom0502 #502;
      isom0503 #503;
      isom0504 #504;
      isom0505 #505;
      isom0506 #506;
      isom0507 #507;
      isom0508 #508;
      isom0509 #509;

      :/agicli/def/agim0019 #319;
      :/agicont/def/ca8m0000 #400;
      zregpres #401;

      isoh1001 #901;
      isoh0902 #902;
      isoh09di #999;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aBase          = "";
     aPathPlugins   = "";
     aDirServidor   = "";
     aDirInternet   = "";
     aDirLanza      = "";
     aDocRemoto     = "";
     aDocServidor   = "";
     aDirBase       = "";
     aIPRemoto      = "";
     aDelindex      = "";
     aFichero       = "";
     aFicheroT      = "";
     aFicheroP      = "";
     aFicheroE      = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";
     aLong          = "";
     aTecla         = "";
     aRetu          = "";
     aEsc1          = "";
     aEsc2          = "";
     aDesde         = "";
     aHasta         = "";

     nLong          = 0;
     nNume          = 0;
     nPos           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nVent200       = 0;
     nPanta         = 0;
     nCasilla       = 0;
     nFecha           = 0;
     nCampo           = 0;
     nSwPunto         = 0;
     nCaracter        = 0;
     nContaBucle      = 0;
     nContaBucleL     = 0;
     nComple          = 0;
     nPuntero         = 0;
     nDesde           = 0;
     nHasta           = 0;
     nHay             = 0;
     nTotal           = 0;
     nValor626        = 0;
     nValor627        = 0;
     nValor628        = 0;
     nValor629        = 0;
     nCanti1          = 0;
     nCanti2          = 0;
     nCanti3          = 0;
     nCanti4          = 0;
     nCantiT          = 0;
     nResto           = 0;
     nResto1          = 0;
     nResto2          = 0;
     nResto3          = 0;
     nTecla           = 0;
     nBotonCont       = 0;
     nBotonSal        = 0;
     nHandle          = 0;

     fFechaD          = @;
     fFechaH          = @;

     {1}aContiene     = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enHandle        = 0;
     &enCanti         = 0;
     &eaPagina        = "";
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaEfectivo      = "";
     &eaAdeudo        = "";
     &eaEntidad       = "";
     &eaOficina       = "";
     &eaDC             = "";
     &eaCuenta         = "";
     &enModelo         = 0;
     &enBanco          = 0;
     &enFormaPag       = 0;
     &enForzar         = 0;
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaFinLinea       = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
     &eaCasilla        = "";
     &enErrorPortal    = 0;
|FIN;

|PROCESO PonVentana;
     |VENTANA 0501, 2399, -1, 16, "Emisi¢n modelo 200";
     nVent200 = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent200;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
|FPRC;

|PROCESO QuitaVentana;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent200;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent200;
|FPRC;

|PROCESO TraeDsaeatresp;
     |DBASE aPathPlugins;  |QBT aPathPlugins;
     aPathPlugins = aPathPlugins + "planilla";
     aOrigen      = aPathPlugins   + "/dsaeatresp.exe";
     aDestino     = aDirBase + "dsaeatresp.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CopiaFichero;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO AbreSecuencial;
     |DBASE aBase;  |QBF aBase;
     aDirServidor = aBase + "tmp";   |MKDIR aDirServidor;
     aDirServidor = aBase + "tmp/";

     aDirLanza    = eaUnidadBasico + "\AEAT";                         |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200";                     |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200\" + #200#1;           |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200\" + #200#1 + "\";

     aDirBase     = eaUnidadBasico + "\AEAT\200\";

     aDirInternet = eaUnidadBasico + "/AEAT";                         |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET";                |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200";            |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200/" + #200#1;  |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200/" + #200#1 + "\";

     aFichero    = (("00000" + #200#0) % -105) + #200#1 + ".txt";
     aFicheroT   = (("00000" + #200#0) % -105) + #200#1 + "T.txt";
     aFicheroP   = "portal200.html";

     aAbre       = aDirServidor + aFicheroT;
     |XABRE "BW", aAbre, enHandle;
|FPRC;

|PROCESO GrabaPortal;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO GrabaPortalSin;
     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO PortalBorrador;
     aAbre = aDirServidor + aFicheroP;
     |XABRE "WB", aAbre, enHandle;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/l/zi22zilk0022" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "SOV0200A" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LEV" + &34 + " value=" + &34 + "000000000000" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIC" + &34 + " value=" + &34;
     |HAZ GrabaPortalSin;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFicheroP;
     aOrigen    = aDirServidor + aFichero;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "AB", aAbre, enHandle;

     eaAlfa = &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "RUT" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + "2010" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "200" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA enHandle;

     aOrigen  = aDirServidor + aFicheroP;
     aDestino = aDirLanza + aFicheroP;
     |HAZ CopiaFichero;

     eaForzExplorador = "N";
     enEjercicio      = enAnyo;
     |HAZ Explorador;

     |SI eaPathExplorador ! "";
         aAlfa = eaPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     aAlfa = aDirServidor + aFicheroP;   |FBORRA aAlfa;
     aAlfa = aDirLanza + aFicheroP;      |RFBORRA aAlfa;
|FPRC;

|PROCESO PortalValidacion;
     aFicheroE = "e" + (("00000" + #200#0) % -105) + ".html";
     aAbre     = aDirServidor + aFicheroP;
     |XABRE "WB", aAbre, enHandle;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/l/zi22zilk0022" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "SOV0200A" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LEV" + &34 + " value=" + &34 + "000000000000" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIC" + &34 + " value=" + &34;
     |HAZ GrabaPortalSin;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFicheroP;
     aOrigen    = aDirServidor + aFichero;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "AB", aAbre, enHandle;

     eaAlfa = &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "RUT" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKQW" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + "2010" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "200" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA enHandle;

     aOrigen  = aDirServidor + aFicheroP;
     aDestino = aDirLanza + aFicheroP;
     |HAZ CopiaFichero;

     enErrorPortal = 0;
     |HAZ TraeDsaeatresp;

     aAlfa = aDirLanza + aFicheroE;  |RFBORRA aAlfa;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     aAbre = aDirLanza + "ejecutaweb.bat";
     |XABRE "WBC", aAbre, nHandle;

     aAlfa = aDirBase + "dsaeatresp " + aDirLanza + aFicheroP + " " + aDirLanza + aFicheroE;
     |XGRABA nHandle, aAlfa;

     |RSYSTEM aAbre;

     aAbre = aDirLanza + aFicheroE;
     |XABRE "UC", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA; |SI; |HACIENDO;
          |XLEE nHandle, 250, aAlfa;
          |SI FSalida < 0;  |SAL;  |FINSI;

          aAlfa1 = aAlfa < "";  |QBF aAlfa1;
          aAlfa2 = aAlfa1 - "<title>";
          |SI FSalida ! 0;
              aAlfa2 = aAlfa1 - "error";
              |SI FSalida ! 0;  enErrorPortal = 1;  |SAL;  |FINSI;

              aAlfa2 = aAlfa1 - "errónea";
              |SI FSalida ! 0;  enErrorPortal = 1;  |SAL;  |FINSI;
          |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     |SI enErrorPortal = 1;
         |CONFI "0000SHay errores. Quiere consultarlos";
         |SI FSalida = 0;
             eaForzExplorador = "N";
             enEjercicio      = enAnyo;
             |HAZ Explorador;

             |SI eaPathExplorador ! "";
                 aAlfa = eaPathExplorador + " " + aDirLanza + aFicheroE;
                 aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
             |SINO;
                 aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDirLanza + aFicheroE + &34;
             |FINSI;

             |RSYSTEM aAlfa;
         |FINSI;
     |FINSI;

     aAlfa = aDirLanza + aFicheroE;         |RFBORRA aAlfa;
     aAlfa = aDirLanza + aFicheroP;         |RFBORRA aAlfa;
     aAlfa = aDirLanza + "ejecutaweb.bat";  |RFBORRA aAlfa;
|FPRC;

|PROCESO PortalImprime;
     |VENTANA 0501, 2399, -1, 16, "Generar PDF";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{10}}A continuaci¢n obtendremos el impreso.";
     aAlfa = aAlfa + " Luego se puede guardar el PDF en cualquier directorio ";
     aAlfa = aAlfa + "de la red.";
     |CONTROL_SIMPLE 0, aAlfa, 1045, 1398, NULL;

     aAlfa = "LABEL,{{10}}Es conveniente hacer un copiar al n£mero de justificante ";
     aAlfa = aAlfa + "porque luego lo pediremos.";
     |CONTROL_SIMPLE 0, aAlfa, 1445, 2698, NULL;

     |CONTROL_SIMPLE 0, "BOTON, Continuar", 1215, 1435, BotonContinuar;
     nBotonCont = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Cancelar," + nBotonCont;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "WB", aAbre, enHandle;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www2.agenciatributaria.gob.es/l/zi21zilk0021" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "SOB0200A" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "LEV" + &34 + " value=" + &34 + "000000000000" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "F01" + &34 + " value=" + &34;
     |HAZ GrabaPortalSin;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFicheroP;
     aOrigen    = aDirServidor + aFichero;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "AB", aAbre, enHandle;

     eaAlfa = &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "ANA" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + "2010" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "200" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKQV" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA enHandle;

     aOrigen  = aDirServidor + aFicheroP;
     aDestino = aDirLanza + aFicheroP;
     |HAZ CopiaFichero;

     eaForzExplorador = "N";
     enEjercicio      = #202#1;
     |HAZ Explorador;

     |SI eaPathExplorador ! "";
         aAlfa = eaPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     |VENTANA 0501, 1350, -1, 16, "N£mero de justificante obtenido";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{2}}N£mero de justificante ";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0920, NULL;

     E_inf   = "";
     E_sup   = "16";

     |PARA;  |SI;  |HACIENDO;
          eaJusti = 0922 ? 1;
          |CONFI "0000SEl n£mero introducido es correcto";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |PULSATECLA;

     eaImpre = "S";

     aAlfa = aDirLanza + aFichero;      |RFBORRA aAlfa;
     aAlfa = aDirLanza + aFicheroP;     |RFBORRA aAlfa;
|FPRC;

|PROCESO BotonContinuar;
     |PTEC 806;
|FPRC;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO MandaAInternet;
     aOrigen  = aDirServidor + aFichero;
     aDestino = aDirInternet + aFichero;
     |HAZ CopiaFichero;

     aAlfa = "0000El fichero generado est  en " + aDestino + " para su presentaci¢n.";
     |MENAV aAlfa;

     eaImpre = "S";
     eaJusti = "";
|FPRC;

|PROCESO ModoPresentacion;
     |VENTANA 0501, 2399, -1, 16, "Forma de env¡o";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{10}}A continuaci¢n elija el tipo de presentaci¢n";
     |CONTROL_SIMPLE 0, aAlfa, 1345, 2698, NULL;

     |CONTROL_SIMPLE 0, "BOTON, Internet", 1015, 1235, BotonContinuar;
     nBotonCont = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Presentaci¢n en PDF", 1415, 1635, BotonSalir;
     nBotonSal = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Cancelar," + nBotonCont;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |SI aTecla = aEsc2;
         |HAZ PortalImprime;
         |ACABA;
     |FINSI;

     |SI aTecla = aEsc1;
         |HAZ MandaAInternet;
     |FINSI;
|FPRC;

|PROCESO Portal;
     |HAZ PonVentana;

     |SI PARAMETRO = "BORRADOR";
         |HAZ PortalBorrador;
         |HAZ QuitaVentana;
         |ACABA;
     |FINSI;

     aAlfa = aDirInternet + aFichero;   |RFBORRA aAlfa;

     |HAZ PortalValidacion;

     |SI enErrorPortal = 1;
         |HAZ QuitaVentana;

         |ACABA;
     |FINSI;

     aAlfa = #200#3 % 101;
     |SI aAlfa = "A";  |O aAlfa = "B";
         |HAZ MandaAInternet;
         |HAZ QuitaVentana;
         |ACABA;
     |FINSI;

     |HAZ ModoPresentacion;

     |HAZ QuitaVentana;
|FPRC;

|PROCESO CierraSecuencial;
     |XCIERRA enHandle;

     aAbre      = aDirServidor + aFichero;

     |XABRE "BW", aAbre, enHandle;

     eaPagina  = eaPagina + "FIN";
     aLong     = eaPagina % 0;
     nLong     = aLong;
     nResto    = 600 - nLong;
     |SI nResto < 0;  nResto = 0;  |FINSI;

     nResto1 = 0;
     nResto2 = 0;
     nResto3 = 0;

     |SI nResto > 200;
         nResto1 = 200;
         nResto  = nResto - 200;
     |FINSI;

     |SI nResto > 200;
         nResto2 = 200;
         nResto  = nResto - 200;
     |FINSI;

     |SI nResto ! 0;
         nResto3 = nResto;
     |FINSI;

     eaAlfa = "<T2000" + #200#1 + "0A0000>";  |HAZ GrabaSecuencial;
     eaAlfa = "<AUX>";       |HAZ GrabaSecuencial;
     eaAlfa = " " * 70;      |HAZ GrabaSecuencial;
     eaAlfa = "1.00";        |HAZ GrabaSecuencial;
     eaAlfa = "    ";        |HAZ GrabaSecuencial;
     eaAlfa = "B53179768";   |HAZ GrabaSecuencial;
     eaAlfa = " " * 213;     |HAZ GrabaSecuencial;
     eaAlfa = "</AUX>";      |HAZ GrabaSecuencial;
     eaAlfa = "<VECTOR>";    |HAZ GrabaSecuencial;
     eaAlfa = eaPagina;      |HAZ GrabaSecuencial;
     eaAlfa = " " * nResto1; |HAZ GrabaSecuencial;
     eaAlfa = " " * nResto2; |HAZ GrabaSecuencial;
     eaAlfa = " " * nResto3; |HAZ GrabaSecuencial;
     eaAlfa = "</VECTOR>";   |HAZ GrabaSecuencial;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFichero;
     aOrigen    = aDirServidor + aFicheroT;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre      = aDirServidor + aFichero;

     |XABRE "BA", aAbre, enHandle;
     eaAlfa = "</T2000" + #200#1 + "0A0000>";  |HAZ GrabaSecuencial;

     eaAlfa = &13 + &10;  |HAZ GrabaSecuencial;
     |XCIERRA enHandle;

     |HAZ Portal;

     |SI PARAMETRO = "BORRADOR";
         aAbre = aDirServidor + aFichero;   |FBORRA aAbre;
         |ACABA;
     |FINSI;

     aAlfa = aDirServidor + aFicheroT;  |FBORRA aAlfa;
     aAlfa = aDirServidor + aFichero;   |FBORRA aAlfa;
|FPRC;

|PROCESO Lee201;
     aContenido = "0";

     #201#0 = #200#0;
     #201#1 = #200#1;
     #201#2 = nCasilla;
     |LEE 000#201=;
     |SI FSalida = 0;
         aContenido = "1";
     |FINSI;
|FPRC;

|PROCESO maempr04;
     nContaBucle = nContaBucle + 1;
     |SI nContaBucle = 1;
         #901#83 = #204#3;
         #901#84 = #204#4;
         #901#85 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#86 = #204#6;
     |FINSI;

     |SI nContaBucle = 2;
         #901#87 = #204#3;
         #901#88 = #204#4;
         #901#89 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#90 = #204#6;
     |FINSI;

     |SI nContaBucle = 3;
         #901#91 = #204#3;
         #901#92 = #204#4;
         #901#93 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#94 = #204#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #204#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr04;
|FIN;

|PROCESO Hoja1;
     eaPagina = "001";

     |DDEFECTO #901;

     #901#6  = (("00" + #200#29) % -102) + (("000" + #200#30) % -103);  || Codigo
     #901#7  = #200#31 % -104;           || Del A¤o
     #901#8  = #200#31 % 402;            || Del Mes
     #901#9  = #200#31 % 102;            || Del Dia
     #901#10 = #200#32 % -104;           || Al A¤o
     #901#11 = #200#32 % 402;            || Al Mes
     #901#12 = #200#32 % 102;            || Al Dia
     |SI #200#31 = "01.01.2010";  |Y #200#32 = "31.12.2010";
         #901#13 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #200#31;
         fFechaH = #200#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #901#13 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #901#13 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     |ABRE #319;
     #319#0 = #200#0;
     #319#1 = 99;
     |LEE 000#319];
     |SI FSalida = 0;
         |LEE 000#319a;
     |SINO;
         |LEE 000#319u;
     |FINSI;
     |CIERRA #319;

     aCNAE = "";
     |SI FSalida = 0;  |Y #319#0 = #200#0;
         aCNAE = #319#81;
     |FINSI;

     #901#14 = aCNAE;                    || CNAE
     #901#15 = #200#3;                   || NIF
     #901#16 = #200#2;                   || Razon Social
     #901#17 = #200#15;                  || Telefono 1
     #901#18 = "";                       || Telefono 2
     #901#19 = "2010";

     |ABRE #201;
     nCasilla = 1;   |HAZ Lee201;  #901#20 = aContenido;
     nCasilla = 2;   |HAZ Lee201;  #901#21 = aContenido;
     nCasilla = 3;   |HAZ Lee201;  #901#22 = aContenido;
     nCasilla = 4;   |HAZ Lee201;  #901#23 = aContenido;
     nCasilla = 5;   |HAZ Lee201;  #901#24 = aContenido;
     nCasilla = 11;  |HAZ Lee201;  #901#25 = aContenido;
     nCasilla = 13;  |HAZ Lee201;  #901#26 = aContenido;
     nCasilla = 14;  |HAZ Lee201;  #901#27 = aContenido;
     nCasilla = 17;  |HAZ Lee201;  #901#28 = aContenido;
     nCasilla = 18;  |HAZ Lee201;  #901#29 = aContenido;
     nCasilla = 19;  |HAZ Lee201;  #901#30 = aContenido;
     nCasilla = 21;  |HAZ Lee201;  #901#31 = aContenido;
     nCasilla = 23;  |HAZ Lee201;  #901#32 = aContenido;
     nCasilla = 24;  |HAZ Lee201;  #901#33 = aContenido;
     nCasilla = 25;  |HAZ Lee201;  #901#34 = aContenido;
     nCasilla = 31;  |HAZ Lee201;  #901#35 = aContenido;
     nCasilla = 32;  |HAZ Lee201;  #901#36 = aContenido;
     nCasilla = 36;  |HAZ Lee201;  #901#37 = aContenido;
     nCasilla = 48;  |HAZ Lee201;  #901#38 = aContenido;
     nCasilla = 58;  |HAZ Lee201;  #901#39 = aContenido;
     nCasilla = 6;   |HAZ Lee201;  #901#40 = aContenido;
     nCasilla = 15;  |HAZ Lee201;  #901#41 = aContenido;
     nCasilla = 22;  |HAZ Lee201;  #901#42 = aContenido;
     nCasilla = 28;  |HAZ Lee201;  #901#43 = aContenido;
     nCasilla = 47;  |HAZ Lee201;  #901#44 = aContenido;
     nCasilla = 49;  |HAZ Lee201;  #901#45 = aContenido;
     nCasilla = 29;  |HAZ Lee201;  #901#46 = aContenido;
     nCasilla = 33;  |HAZ Lee201;  #901#47 = aContenido;
     nCasilla = 34;  |HAZ Lee201;  #901#48 = aContenido;
     nCasilla = 38;  |HAZ Lee201;  #901#49 = aContenido;
     nCasilla = 46;  |HAZ Lee201;  #901#50 = aContenido;
     nCasilla = 12;  |HAZ Lee201;  #901#51 = aContenido;
     nCasilla = 57;  |HAZ Lee201;  #901#52 = aContenido;
     nCasilla = 20;  |HAZ Lee201;  #901#53 = aContenido;
     nCasilla = 56;  |HAZ Lee201;  #901#54 = aContenido;
     nCasilla = 7;   |HAZ Lee201;  #901#55 = aContenido;
     nCasilla = 8;   |HAZ Lee201;  #901#56 = aContenido;
     nCasilla = 9;   |HAZ Lee201;  #901#57 = aContenido;
     nCasilla = 10;  |HAZ Lee201;  #901#58 = aContenido;
     nCasilla = 16;  |HAZ Lee201;  #901#59 = aContenido;
     nCasilla = 26;  |HAZ Lee201;  #901#60 = aContenido;
     nCasilla = 27;  |HAZ Lee201;  #901#61 = aContenido;
     nCasilla = 30;  |HAZ Lee201;  #901#62 = aContenido;
     nCasilla = 35;  |HAZ Lee201;  #901#63 = aContenido;
     nCasilla = 37;  |HAZ Lee201;  #901#64 = aContenido;
     nCasilla = 39;  |HAZ Lee201;  #901#65 = aContenido;
     nCasilla = 43;  |HAZ Lee201;  #901#66 = aContenido;
     nCasilla = 44;  |HAZ Lee201;  #901#67 = aContenido;
     nCasilla = 45;  |HAZ Lee201;  #901#68 = aContenido;

     |ABRE #400;
     |DDEFECTO #400;
     #400#0 = #200#101;
     |LEE 000#400=;
     #901#69 = #400#2;

     #901#70 = "0";
     |SI #901#60 = "0";
         |DDEFECTO #400;
         #400#0 = #200#102;
         |LEE 000#400=;
         #901#70 = #400#2;
         |CIERRA #400;
     |FINSI;

     nCasilla = 9;  |HAZ Lee201;
     |SI #201#4 ! 0;
          aAlfa = ("000000" + #201#4) % -106;
          aAlfa = (aAlfa % 104) + "/" + (aAlfa % 502);

          #901#71 = aAlfa;
     |SINO;
          nCasilla = 10;  |HAZ Lee201;
          |SI #201#4 ! 0;
              aAlfa = ("000000" + #201#4) % -106;
              aAlfa = (aAlfa % 104) + "/" + (aAlfa % 502);

              #901#71 = aAlfa;
          |FINSI;
     |FINSI;

     |CIERRA #201;

     nNume   = #200#75 * 100;
     #901#72 = ("0000000000" + nNume) % -109;  || Empleados fijos
     nNume   = #200#76 * 100;
     #901#73 = ("0000000000" + nNume) % -109;  || Empleados si fijos

     #901#74 = "0";
     #901#75 = "0000000000000";

     |SI #200#98 = "S";
         #901#74 = "1";
         aAlfa1  = #200#99;  |QBT aAlfa1;
         aAlfa2  = #200#100; |QBT aAlfa2;
         #901#75 = ("0000000000000" + aAlfa1 + aAlfa2) % -113;  || N§ Justificante
     |FINSI;

     #901#76 = #200#77;                          || Nombre Secretario
     #901#77 = #200#78;                          || NIF    Secretario
     #901#78 = "00000000";
     |SI #901#31 = "1";
         #901#78 = (#0#1 % -104) + (#0#1 % 402) + (#0#1 % 102);
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr04;

     #901#79 = #200#13;                          || Poblacion firma
     #901#80 = aDia;                             || Dia
     #901#81 = aMes;                             || Mes
     #901#82 = aEjerc;                           || A¤o

     |SI #901#85 = "        ";  #901#85 = "00000000";  |FINSI;
     |SI #901#89 = "        ";  #901#89 = "00000000";  |FINSI;
     |SI #901#93 = "        ";  #901#93 = "00000000";  |FINSI;

     |DDEFECTO #401;
     #401#0 = #200#1;
     |LEE 000#401=;
     |CIERRA #401;

     #901#97  = #401#1;
     nNume    = #401#6;  #901#98 = (("000000000" + nNume) % -109);
     nNume    = #401#7;  #901#99 = (("000000000" + nNume) % -109);
     #901#100 = #401#8;

     |PARA nCampo = 1;  |SI nCampo [ 102;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #901nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO maempr03;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0 = ((nContaBucle / 6) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#2   = "200";
         #902#146 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 6) + 6;
     #902nPuntero = #203#3;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#4;

                        aAlfa = "0";
     |SI #203#8 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#5;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#6;

     |SI #901#31 = "1";
         nPuntero     = nPuntero + 1;
         aAlfa        = ("00" + #203#7) % -102;
         #902nPuntero = aAlfa;
     |FINSI;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr03;
     #203#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr03;
|FIN;

|PROCESO maempr06;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 4) + .49) ! 0;
     nContaBucleL = (nContaBucle + 3) - (4 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0     = ((nContaBucle / 4) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#2   = "200";
         #902#146 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 15) + 42;
     #902nPuntero = #206#3;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #206#4;

     nPuntero     = nPuntero + 1;
     aAlfa        = ("00" + #206#5) % -102;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #206#7;
     |HAZ Calcula3E2D;
     #902nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #206#6;
     |HAZ Calcula17D;
     #902nPuntero = eaAlfa;

     |PARA nCampo = 8;  |SI nCampo [ 13;  |HACIENDO nCampo = nCampo + 1;
           nPuntero  = nPuntero + 1;
           enCanti   = #206nCampo;
           |HAZ Calcula17D;
           #902nPuntero = eaAlfa;
     |SIGUE;

     |PARA nCampo = 16;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
           nPuntero  = nPuntero + 1;
           enCanti   = #206nCampo;
           |HAZ Calcula17D;
           #902nPuntero = eaAlfa;
     |SIGUE;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr06;
     #206#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr06;
|FIN;

|PROCESO maempr02;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0 = ((nContaBucle / 6) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#146 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 7) + 102;
     #902nPuntero = #202#3;

                        aAlfa = "0";
     |SI #202#9 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #202#4;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #202#5;

     nPuntero     = nPuntero + 1;
     aAlfa        = #202#6;  |QBT aAlfa;
     aAlfa        = ("00" + aAlfa) % -102;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #202#7;
     |HAZ Calcula17D;
     #902nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #202#8;
     |HAZ Calcula3E2D;
     #902nPuntero = eaAlfa;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr02;
     #202#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr02;
|FIN;

|PROCESO isoh0902;
     |PARA nCampo = 1;  |SI nCampo [ 146;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #902nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0902;
     #902#1;
     ;
     01;
     99;
     ;
     NULL, isoh0902;
|FIN;

|PROCESO Hoja2;
     aDelindex = ("h1" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #902 aDelindex;
     |ABRE #902; |CIERRA #902; |DELINDEX #902;

     |ABRE #902;
     #902#0 = 1;
     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0   = 1;
         #902#5   = "";
         #902#2   = "200";
         #902#146 = "</T200002>";

         |SI #200#73 > 100;  #200#73 = 0;  #200#74 = 0;  |FINSI;
         |SI #200#74 > 100;  #200#73 = 0;  #200#74 = 0;  |FINSI;

         |SI #902#5 = " ";
             enCanti   = #200#73;
             |HAZ Calcula3E2D;
             #902#144 = eaAlfa;

             enCanti   = #200#74;
             |HAZ Calcula3E2D;
             #902#145 = eaAlfa;
         |FINSI;

         eaPagina = eaPagina + "002";

         |GRABA 020#902n;
         |LIBERA #902;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr03;
     nContaBucle = 0;    |BUCLE maempr06;
     nContaBucle = 0;    |BUCLE maempr02;

     |CIERRA #902;

     |BUCLE isoh0902;

     |ABRE #902; |CIERRA #902; |DELINDEX #902;
|FPRC;

|PROCESO isom0501;
     |SI #501#2 = "     ";  |ACABA;  |FINSI;

     #102#0 = #200#0;
     #102#1 = #200#1;
     #102#2 = #501#1;
     |LEE 000#102=;
     |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;

     enCanti  = #102#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0501;
      #501#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0501;
|FIN;

|PROCESO Hoja3;
     eaPagina = eaPagina + "003";

     eaAlfa = "<T200003> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 15;
     nHasta = 255;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200003>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja4;
     eaPagina = eaPagina + "004";

     eaAlfa = "<T200004> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 260;
     nHasta = 415;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200004>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja5;
     eaPagina = eaPagina + "005";

     eaAlfa = "<T200005> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 455;
     nHasta = 670;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200005>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja6;
     eaPagina = eaPagina + "006";

     eaAlfa = "<T200006> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 680;
     nHasta = 800;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200006>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0502;
     |SI #502#2 = "     ";  |ACABA;  |FINSI;

     #103#0 = #200#0;
     #103#1 = #200#1;
     #103#2 = #502#1;
     |LEE 000#103=;
     |SI FSalida ! 0;  |DDEFECTO #103;  |FINSI;

     enCanti  = #103#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0502;
      #502#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0502;
|FIN;

|PROCESO Hoja7;
     eaPagina = eaPagina + "007";

     eaAlfa = "<T200007> ";  |HAZ GrabaSecuencial;

     |ABRE #103;
     nDesde = 15;
     nHasta = 260;
     |BUCLE isom0502;
     |CIERRA #103;

     eaAlfa = "</T200007>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja8;
     eaPagina = eaPagina + "008";

     eaAlfa = "<T200008> ";  |HAZ GrabaSecuencial;

     |ABRE #103;
     nDesde = 265;
     nHasta = 440;
     |BUCLE isom0502;
     |CIERRA #103;

     eaAlfa = "</T200008>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0503;
     |SI #503#2 = "     ";  |ACABA;  |FINSI;

     #104#0 = #200#0;
     #104#1 = #200#1;
     #104#2 = #503#1;
     |LEE 000#104=;
     |SI FSalida ! 0;  |DDEFECTO #104;  |FINSI;

     enCanti  = #104#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0503;
      #503#1;
      ;
      #200#1, 0000;
      #200#1, 9999;
      ;
      NULL, isom0503;
|FIN;

|PROCESO Hoja9;
     |SI #901#69 = "3";  |ACABA;  |FINSI;

     eaPagina = eaPagina + "009";

     eaAlfa = "<T200009> ";  |HAZ GrabaSecuencial;

     |ABRE #104;
     |BUCLE isom0503;
     |CIERRA #104;

     eaAlfa = "</T200009>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0504;
     |SI #504#2 = "     ";  |ACABA;  |FINSI;

     #105#0 = #200#0;
     #105#1 = #200#1;
     #105#2 = #504#1;
     |LEE 000#105=;
     |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;

     enCanti  = #105#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0504;
      #504#2;
      ;
      #200#1, "     ", nDesde;
      #200#1, "zzzzz", nHasta;
      ;
      NULL, isom0504;
|FIN;

|PROCESO Hoja10;
     eaPagina = eaPagina + "010";

     eaAlfa = "<T200010> ";  |HAZ GrabaSecuencial;

     nDesde = 5;
     nHasta = 700;

     |ABRE #105;
     |BUCLE isom0504;
     |CIERRA #105;

     eaAlfa = "</T200010>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja11;
     eaPagina = eaPagina + "011";

     eaAlfa = "<T200011> ";  |HAZ GrabaSecuencial;

     nDesde = 705;
     nHasta = 1345;

     |ABRE #105;
     |BUCLE isom0504;
     |CIERRA #105;

     eaAlfa = "</T200011>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0500;
     |SI #500#2 = "900  ";  |ACABA;  |FINSI;
     |SI #500#2 = "901  ";  |ACABA;  |FINSI;
     |SI #500#2 = "     ";  |ACABA;  |FINSI;

     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#2 = #500#1;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

     |SI #500#2 ! "558";
         enCanti  = #101#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |SINO;
         enCanti  = #101#5;  |HAZ Calcula2E2D; |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0500;
      #500#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0500;
|FIN;

|DEFBUCLE isom0500_2;
      #500#2;
      ;
      #200#1, aDesde, nDesde;
      #200#1, aHasta, nHasta;
      ;
      NULL, isom0500;
|FIN;

|PROCESO isom0505;
     #106#0 = #200#0;
     #106#1 = #200#1;
     #106#2 = #505#1;
     |LEE 000#106=;
     |SI FSalida ! 0;  |DDEFECTO #106;  |FINSI;

     |SI #505#2 ! "     ";
         enCanti  = #106#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #505#3 ! "     ";
         enCanti  = #106#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0505;
      #505#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0505;
|FIN;

|PROCESO Hoja12;
     eaPagina = eaPagina + "012";

     eaAlfa = "<T200012> ";  |HAZ GrabaSecuencial;

     nDesde = 5;
     nHasta = 25;

     |ABRE #101;
     |BUCLE isom0500;
     |CIERRA #101;

     nDesde = 5;
     nHasta = 235;

     |ABRE #106;
     |BUCLE isom0505;
     |CIERRA #106;

     eaAlfa = "</T200012>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja13;
     eaPagina = eaPagina + "013";

     eaAlfa = "<T200013> ";  |HAZ GrabaSecuencial;

     nDesde = 240;
     nHasta = 305;

     |ABRE #106;
     |BUCLE isom0505;
     |CIERRA #106;

     nDesde = 40;
     nHasta = 155;

     |ABRE #101;
     |BUCLE isom0500;
     |CIERRA #101;

     eaAlfa = "</T200013>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja14;
     eaPagina = eaPagina + "014";

     eaAlfa = "<T200014> ";  |HAZ GrabaSecuencial;


     |ABRE #101;
     nDesde = 170;  nHasta = 290;  |BUCLE isom0500;
     nDesde = 385;  nHasta = 390;  |BUCLE isom0500;

     aDesde = "599"; aHasta = "616";
     nDesde = 395;   nHasta = 535;  |BUCLE isom0500_2;

     aDesde = "633"; aHasta = "642";
     nDesde = 395;   nHasta = 535;  |BUCLE isom0500_2;

     aDesde = "617"; aHasta = "622";
     nDesde = 395;   nHasta = 535;  |BUCLE isom0500_2;
     |CIERRA #101;

     eaAlfa = "</T200014>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0507;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#2 = #507#1;
     |LEE 000#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;

     |SI #507#3 ! "     ";
         eaAlfa = #109#4;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#4 ! "     ";
        enCanti  = #109#6;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#5 ! "     ";
        enCanti  = #109#8;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#6 ! "     ";
        enCanti  = #109#10; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507;
      #507#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0507;
|FIN;

|PROCESO isom0509;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#2 = #509#1;
     |LEE 000#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;

     |SI #509#2 ! "     ";
         enCanti  = #112#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#3 ! "     ";
         |SI #509#3 ! "103  ";
             enCanti  = #112#7;  |HAZ Calcula2E2D; |HAZ GrabaSecuencial;
         |SINO;
             enCanti  = #112#7;  |HAZ Calcula3E4D; |HAZ GrabaSecuencial;
         |FINSI;
     |FINSI;

     |SI #509#4 ! "     ";
         enCanti  = #112#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#5 ! "     ";
         enCanti  = #112#11; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#6 ! "     ";
         enCanti  = #112#13; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0509;
      #509#1;
      ;
      #200#1, 0000;
      #200#1, 9999;
      ;
      NULL, isom0509;
|FIN;

|PROCESO Hoja15;
     eaCasilla = "670";  |HAZ LeeFich109;  nValor1 = #109#6;
     eaCasilla = "116";  |HAZ LeeFich112;  nValor2 = #112#5;
     eaCasilla = "131";  |HAZ LeeFich112;  nValor3 = #112#5;
     eaCasilla = "160";  |HAZ LeeFich112;  nValor4 = #112#5;
     eaCasilla = "171";  |HAZ LeeFich112;  nValor5 = #112#5;

     nSuma = nValor1 + nValor2 + nValor3 + nValor4 + nValor5
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "015";

     eaAlfa = "<T200015> ";  |HAZ GrabaSecuencial;

     |ABRE #109;
     |SELECT #1#109;
     nDesde = 5;    nHasta = 85;   |BUCLE isom0507;
     |CIERRA #109;

     |ABRE #112;
     |SELECT #1#112;
     |BUCLE isom0509;
     |CIERRA #112;

     eaAlfa = "</T200015>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0508;
     #111#0 = #200#0;
     #111#1 = #200#1;
     #111#2 = #508#1;
     |LEE 000#111=;
     |SI FSalida ! 0;  |DDEFECTO #111;  |FINSI;

     |SI #508#2 ! "     ";
         enCanti  = #111#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #508#3 ! "     ";
         enCanti  = #111#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #508#4 ! "     ";
         enCanti  = #111#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0508;
      #508#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0508;
|FIN;

|PROCESO Hoja16;
     eaCasilla = "841";  |HAZ LeeFich111;  nValor1 = #111#5;
     eaCasilla = "764";  |HAZ LeeFich111;  nValor2 = #111#5;
     eaCasilla = "886";  |HAZ LeeFich111;  nValor3 = #111#5;

     nSuma = nValor1 + nValor2 + nValor3 + #100#66;
     nSuma = nSuma   + #100#70 + #100#74 + #100#106 + #100#112;
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "016";

     eaAlfa = "<T200016> ";  |HAZ GrabaSecuencial;

     |ABRE #111;
     |SELECT #1#111;
     nDesde = 10;    nHasta = 60;    |BUCLE isom0508;
     nDesde = 75;    nHasta = 105;   |BUCLE isom0508;

     |SI #100#64 = " ";  #100#64 = "0";  |FINSI;
     |SI #100#68 = " ";  #100#68 = "0";  |FINSI;

     enCanti = #100#66;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#67;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     eaAlfa  = #100#68;                    |HAZ GrabaSecuencial;
     enCanti = #100#70;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#71;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#72;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#73;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#74;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#75;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#76;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#77;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#106; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#107; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#108; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#109; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#112; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#113; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#114; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#115; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#78;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = #100#79;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     nDesde = 120;   nHasta = 225;   |BUCLE isom0508;
     |CIERRA #111;

     eaAlfa = "</T200016>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja17;
     eaCasilla = "831";  |HAZ LeeFich111;  nValor1 = #111#5;
     eaCasilla = "598";  |HAZ LeeFich111;  nValor2 = #111#5;

     nSuma = nValor1 + nValor2;
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "017";

     eaAlfa = "<T200017> ";  |HAZ GrabaSecuencial;

     |ABRE #111;
     |SELECT #1#111;
     nDesde = 240;   nHasta = 535; |BUCLE isom0508;
     |CIERRA #111;

     eaAlfa = "</T200017>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Graba107;
     enCanti  = #107#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #107#7; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Graba108;
     #506#0  = #201#1;
     #506#1  = eaCasilla;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;

     |SI #506#2 ! "     ";
         enCanti  = #108#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #506#3 ! "     ";
         enCanti  = #108#7; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|PROCESO isom0016;
     nContaBucle  = nContaBucle + 1;

     |SI nContaBucle = 1;
         aAlfa1 = #116#3;
     |FINSI;

     |SI nContaBucle = 2;
         aAlfa2 = #116#3;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE isom0016;
     #116#1;
     ;
     #200#0, #200#1, 01;
     #200#0, #200#1, 99;
     ;
     NULL, isom0016;
|FIN;

|PROCESO Hoja18;
     eaCasilla = "417";   |HAZ LeeFich107;  nValor  = #107#5 + #107#7;
     eaCasilla = "051";   |HAZ LeeFich107;  nValor  = nValor + #107#5 + #107#7;

     |PARA nCampo = 84;  |SI nCampo [ 105;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #100nCampo;
     |SIGUE;

     |ABRE #116;
     #116#0 = #200#0;
     #116#1 = #200#1;
     #116#2 = 1;
     |LEE 000#116];
     |SI FSalida = 0;  |Y  #116#0 = #200#0;  |Y #116#1 = #200#1;
         nValor = 1;
     |FINSI;
     |CIERRA #116;

     |SI nValor = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "018";

     eaAlfa = "<T200018> ";  |HAZ GrabaSecuencial;

     enCanti  = #100#84;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#85;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#86 + #100#87;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#88;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#89 + #100#90 + #100#91 + #100#92;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#93;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#94 + #100#95;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#96;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#97;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#98;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#100; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#99 + #100#101 + #100#102 + #100#103;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#104; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#105; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "001";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "003";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "027";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "005";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "029";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "007";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "031";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "009";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "033";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "011";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "035";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "013";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "037";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "015";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "039";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "017";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "041";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "019";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "043";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "021";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "045";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "023";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "047";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "025";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "049";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "417";  |HAZ LeeFich107;  |HAZ Graba107;
     eaCasilla = "051";  |HAZ LeeFich107;  |HAZ Graba107;

     aAlfa1 = "                      ";
     aAlfa2 = "                      ";

     nContaBucle  = 0;
     |BUCLE isom0016;

     eaAlfa = aAlfa1;  |HAZ GrabaSecuencial;
     eaAlfa = aAlfa2;  |HAZ GrabaSecuencial;

     eaAlfa = "</T200018>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO HojaDID;
     |DDEFECTO #999;

     #999#7  = (("00" + #200#29) % -102) + (("000" + #200#30) % -103);  || Codigo
     #999#8  = #200#1;
     |SI #200#31 = "01.01.2010";  |Y #200#32 = "31.12.2010";
         #999#9 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #200#31;
         fFechaH = #200#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #999#9 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #999#9 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     #999#10 = "0A";                     || Periodo
     #999#11 = #200#31 % 102;            || Del Dia
     #999#12 = #200#31 % 402;            || Del Mes
     #999#13 = #200#31 % -102;           || Del Anyo
     #999#14 = #200#32 % 102;            || Al Dia
     #999#15 = #200#32 % 402;            || Al Mes
     #999#16 = #200#32 % -102;           || Al A¤o
     #999#17 = #200#3;                   || NIF
     #999#18 = #200#2;                   || Apellidos o Razon Social

     eaCasilla = "552";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#19 = eaAlfa;

     eaCasilla = "562";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#20 = eaAlfa;

     eaCasilla = "621";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#21 = eaAlfa;
     nTotal   = #101#5;

     |ABRE #1000;
     #1000#0 = #200#0;
     #1000#1 = #200#1;
     |LEE 040#1000=;
     |SI FSalida ! 0;  |DDEFECTO #1000;  |FINSI;
     |CIERRA #1000;

     |SI #901#57 = "1"; nTotal = 0; |FINSI;
     |SI #901#58 = "1"; nTotal = 0; |FINSI;

     |SI #0#2 = "S";
         #999#6 = "1";

         |SI nTotal < 0;
             #999#26 = " ";
             enCanti = -nTotal;  |HAZ Calcula17D;  #999#27 = eaAlfa;
         |FINSI;

         |SI nTotal > 0;
             #999#32  = " ";
             enCanti  = nTotal; |HAZ Calcula17D;  #999#35 = eaAlfa;
         |FINSI;
     |SINO;
         |SI nTotal < 0;
             #999#26 = "D";
             enCanti  = -nTotal;  |HAZ Calcula17D;  #999#27 = eaAlfa;
             |SI #200#34 = "S";
                 #999#26 = "R";
             |SINO;
                 aAlfa   = #1000#2;  |QBF aAlfa; #999#28 = ("0000" + aAlfa) % -104;
                 aAlfa   = #1000#3;  |QBF aAlfa; #999#29 = ("0000" + aAlfa) % -104;
                 aAlfa   = #1000#4;  |QBF aAlfa; #999#30 = ("00"   + aAlfa) % -102;
                 aAlfa   = #1000#5;  |QBF aAlfa; #999#31 = ("0000000000" + aAlfa) % -110;
             |FINSI;
         |FINSI;

         |SI nTotal > 0;
             enCanti  = nTotal; |HAZ Calcula17D;  #999#35 = eaAlfa;
             #999#32 = #0#0;
             |SI #0#0 ! "H";
                 aAlfa   = #1000#2;   |QBF aAlfa; #999#36 = ("0000" + aAlfa) % -104;
                 aAlfa   = #1000#3;   |QBF aAlfa; #999#37 = ("0000" + aAlfa) % -104;
                 aAlfa   = #1000#4;   |QBF aAlfa; #999#38 = ("00"   + aAlfa) % -102;
                 aAlfa   = #1000#5;   |QBF aAlfa; #999#39 = ("0000000000" + aAlfa) % -110;
             |FINSI;
         |FINSI;

         |SI nTotal = 0;
             #999#40 = "1";
         |FINSI;
     |FINSI;

     #999#33 = "";
     #999#34 = "";
     #999#41 = #200#13;                          || Poblacion firma
     #999#42 = aDia;                             || Dia
     #999#43 = aMes;                             || Mes
     #999#44 = aEjerc;                           || A¤o

     |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #999nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaPagina = eaPagina + "DID";
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     nTecla = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |SI nTecla = 7;  |ACABA;  |FINSI;

     aDia   = #0#1 % 102;
     aMes   = #0#1 % 402;
     aEjerc = #0#1 % -104;

     |SI aMes = "01"; aMes = "Enero     "; |FINSI;
     |SI aMes = "02"; aMes = "Febrero   "; |FINSI;
     |SI aMes = "03"; aMes = "Marzo     "; |FINSI;
     |SI aMes = "04"; aMes = "Abril     "; |FINSI;
     |SI aMes = "05"; aMes = "Mayo      "; |FINSI;
     |SI aMes = "06"; aMes = "Junio     "; |FINSI;
     |SI aMes = "07"; aMes = "Julio     "; |FINSI;
     |SI aMes = "08"; aMes = "Agosto    "; |FINSI;
     |SI aMes = "09"; aMes = "Septiembre"; |FINSI;
     |SI aMes = "10"; aMes = "Octubre   "; |FINSI;
     |SI aMes = "11"; aMes = "Noviembre "; |FINSI;
     |SI aMes = "12"; aMes = "Diciembre "; |FINSI;
     aMes = aMes > aMes;

     |ABRE #100;
     #100#0 = #200#0;
     #100#1 = #200#1;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |HAZ AbreSecuencial;
     |HAZ Hoja1;
     |HAZ Hoja2;
     |HAZ Hoja3;
     |HAZ Hoja4;
     |HAZ Hoja5;
     |HAZ Hoja6;
     |HAZ Hoja7;
     |HAZ Hoja8;
     |HAZ Hoja9;
     |HAZ Hoja10;
     |HAZ Hoja11;
     |HAZ Hoja12;
     |HAZ Hoja13;
     |HAZ Hoja14;
     |HAZ Hoja15;
     |HAZ Hoja16;
     |HAZ Hoja17;
     |HAZ Hoja18;
     |HAZ Hoja19;
     |HAZ Hoja20;
     |HAZ Hoja21;
     |HAZ Hoja22;
     |HAZ Hoja23;
     |HAZ Hoja24;
     |HAZ HojaDID;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 1899;
|FPRC;

|PROGRAMA;
||     |MENAV "0000A£n no se ha abierto el portal del 2010.";
||     |ACABA;

     eaUnidadBasico = "C:";
     eaImpre        = "N";
     eaJusti        = "";
     eaFinLinea     = &13 + &10;
     eaFinLinea     = "";

     |SI PARAMETRO ! "BORRADOR";
         |SUB_EJECUTA_NP "isoz0002;CHEQUEOEMISION";
         |SI enError ! 0;
             |MENAV "0000Hay errores graves, no puedo emitir el modelo.";
             |ACABA;
         |FINSI;

         |SI enAviso ! 0;
             |CONFI "0000SHay errores leves, quiere emitir de todas formas";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     |ABRE #200;
     #200#0 = enEmpresa;
     #200#1 = enAnyo;
     |LEE 000#200=;
     |SI FSalida ! 0;  |CIERRA #200;  |ACABA; |FINSI;
     |CIERRA #200;

     |C_M #0#0, 1, "N";
     eaCasilla = "621";  |HAZ LeeFich101;
     nTotal   = #101#5;
     |SI nTotal > 0;
         |C_M #0#0, 1, "S";

         |ABRE #1000;
         #1000#0 = #200#0;
         #1000#1 = #200#1;
         |LEE 040#1000=;
         |SI FSalida ! 0;  |DDEFECTO #1000;  |FINSI;
         |CIERRA #1000;

                                        #0#0 = "H";
         |SI #1000#5 ! "          ";    #0#0 = "I";  |FINSI;
     |FINSI;

     aAlfa =  "Emisi¢n modelo 200 (" + (("00000" + #200#0) % -105) + " / " + #200#1 + " " + #200#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 1550, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI PARAMETRO ! "BORRADOR";
         |PINPA #0#0;
         |PINDA #0#0;

         |ENDATOS #1#0;
     |SINO;
         FSalida = 0;
         |HAZ Tipo12;
     |FINSI;

     |PULSATECLA;
|FPRO;
