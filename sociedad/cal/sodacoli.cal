|FICHEROS;
   sodacoli #0;
   sodacoca #1;
   sodacuen #8;
|FIN;

|VARIABLES;
     cuenta = "";
     alfa1  = "";
     inkey  = 0;
     &enPlan = 0;
|FIN;

|PROCESO Tipo5; |TIPO 5;
  FSalida = "SINBARRA";
|FPRC;

|PROCESO cuen66; |TIPO 66;
|FPRC;

|PROCESO min8;
 #8#0 = "            ";
 #8#2 = enPlan;
|FPRC;

|PROCESO max8;
 #8#0 = "zzzzzzzzzzzz";
 #8#2 = enPlan;
|FPRC;

|PROCESO cuenta_li; |TIPO 6;
   inkey = FSalida;
   |SI inkey = 10;
       |ABRE #8;
       #8#0 = #0Campo;
       |CONSULTA_F_CLAVE #1#8, min8, max8;
       #0#3  = #8#0; |PINTA #0#3;
       #0#4  = #8#1; |PINTA #0#4;
       |CIERRA #8;
   |FINSI;

   |ABRE #8;
   #8#2 = enPlan;
   #8#0 = #0Campo;
   |LEE 001#8=;
   |SI FSalida = 0;
       #0#4 = #8#1; |PINTA #0#4;
   |SINO;
       #8#2 = enPlan;
       #8#0 = #0Campo;
       |GRABA 020#8n;
   |FINSI;
   |CIERRA #8;
|FPRC;

|PROCESO cuenta;
   |ABRE #8;
   #8#2 = enPlan;
   #8#0 = #0#3;
   |LEE 001#8=;
   |SI FSalida ! 0;
       #8#2 = enPlan;
       #8#0 = #0#3;
       #8#1 = #0#4;
       |GRABA 020#8n;
   |SINO;
       alfa1 = #8#1; |QBF alfa1;
       |SI alfa1 = "";
           #8#1 = #0#4;
          |GRABA 020#8a;
       |FINSI;
   |FINSI;
   |CIERRA #8;
|FPRC;

|PROCESO apertura; |TIPO 0;
cuenta = #0#3 % 101;
|SI cuenta = "6"; |O cuenta = "7";
    #0#5 = 0;
|SINO;
    #0#5 = #0#9;
|FINSI;
|PINTA #0#5;
|FPRC;

|PROCESO saldo; |TIPO 0;
#0#8 = #0#5 + #0#6 - #0#7;
|PINTA #0#8;
|FPRC;

|PROCESO actualiz; |TIPO 2;
  alfa1 = #0#3 % 103;
  |SI alfa1 ! "129";
      #1#3 = #1#3 +. #0#5;
      #1#7 = #1#7 +. #0#9;
  |FINSI;

  #1#4 = #1#4 +. #0#6;
  #1#5 = #1#5 +. #0#7;
  #1#6 = #1#6 +. #0#8;
  |PINTA #1#3;
  |PINTA #1#4;
  |PINTA #1#5;
  |PINTA #1#6;
  |PINTA #1#7;
|FPRC;
