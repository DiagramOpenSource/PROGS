|FICHEROS;
     mez00008 #0;

     megwordz #100;
     medeword #200;
     medgword #201;
|FIN;

|VARIABLES;
     aTipo  = "";
     aParam = "";

     nEjer = 0;
|FIN;

|| ****************************************************************

|PROCESO BorrarCapitulos;
 |BORRA 020#100a;
 |LIBERA #100;
|FPRC;

|DEFBUCLE BorrarCapitulos;
 #100#1;
 ;
 nEjer, aTipo, "      ";
 nEjer, aTipo, "zzzzzz";
 be;
 NULL, BorrarCapitulos;
|FIN;

|PROCESO CreaLinG;
     #100#0 = "G";
     #100#1 = #201#0;
     #100#2 = #201#1;
     #100#3 = "S";
     #100#4 = 0000;
     |GRABA 020#100n;
     |LIBERA #100;
|FPRC;

|DEFBUCLE medgword;
     #201#1;
     ;
     "      ";
     "zzzzzz";
     ;
     NULL, CreaLinG;
|FIN;

|PROCESO CreaGestionZ8;
     aTipo = "G";
     nEjer = 0000;
     |BUCLE BorrarCapitulos;

     |ABRE #100;
     |BUCLE medgword;
     |CIERRA #100;
|FPRC;

|PROCESO CreaLinM;
     |SI #200#3 ! 0;
         |SI nEjer < #200#3; |ACABA; |FINSI;
     |FINSI;
     |SI #200#4 ! 9999;
         |SI nEjer > #200#4; |ACABA; |FINSI;
     |FINSI;
     #100#0 = "M";
     #100#1 = #200#0;
     #100#2 = #200#1;
     #100#3 = "S";
     #100#4 = nEjer;
     |GRABA 020#100n;
     |LIBERA #100;
|FPRC;

|DEFBUCLE medeword;
     #200#1;
     ;
     "      ";
     "zzzzzz";
     ;
     NULL, CreaLinM;
|FIN;

|PROCESO CreaMemoriaZ8;

     aTipo = "M";
     nEjer = #0#1;
     |BUCLE BorrarCapitulos;

     |ABRE #100;
     |BUCLE medeword;
     |CIERRA #100;
|FPRC;

|PROCESO ElTipo3; |TIPO 3;

     |SI #0#2 = "NO"; |ACABA; |FINSI;

     nEjer = #0#1;
     |SI #0#0 ! "G";
         aTipo = "M";
         |HAZ CreaMemoriaZ8;
     |FINSI;
     |SI #0#0 ! "M";
         aTipo = "G";
         |HAZ CreaGestionZ8;
     |FINSI;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |SI aParam ! "";
         #0#0 = aParam; #0#0 = #0#0 > " ";
         |C_M #0#0,1,"N";
         |C_V #0#0,1,"N";

         |CLS;
         |PINPA #0#0;
         |SI #0#0 = "M";
             |ATRI R; |PINTA 0838, "de Memoria (Capitulos)"; |ATRI 0;
         |FINSI;
         |SI #0#0 = "G";
             |ATRI R; |PINTA 0838, "de Inf. de Gestion (Capitulos)"; |ATRI 0;
             |C_M #0#1, 1, "N";
             |C_V #0#1, 1, "N";
             #0#1 = 0000;
             |BLIN 12;
             |BLIN 13;
             |BLIN 14;
         |FINSI;
         |BLIN 10;
         |BLIN 11;
         |PINDA #0#0;
         |ENDATOS #1#0;
    |SINO;
         |MANTE #0;
    |FINSI;
|FPRO;
