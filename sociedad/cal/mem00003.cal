|FICHEROS;
    mem00003 #0;  ||  Cabec. cuentas contables a cuadros memorias.
    mem00004 #1;  ||  Lineas cuentas contables a cuadros memorias.

    mem00002 #2;  ||  Cuadro de definiciones
|FIN;

|VARIABLES;

 aAlfa1   = "";
 sw_error = 0;
 nInkey   = 0;

 nCa1 = 0;
 nCa2 = 0;
 nCa3 = 0;
 nCa4 = 0;
 nDCa1 = 0;
 nHCa1 = 0;
 nDCa2 = 0;
 nHCa2 = 0;
 nDCa3 = 0;
 nHCa3 = 0;
 nDCa4 = 0;
 nHCa4 = 0;
|FIN;

|CALCULO Tipo5; |TIPO 5;
 FSalida = "SINBARRA";
|FCAL;

|CALCULO Tipo7; |TIPO 7;
   nCa1 = #1#3;
   nCa2 = 00;
   nCa3 = 00;
   nCa4 = 00;
   |HAZ LeeCuadro;
   |C_A #2#2,1,40;
   |PINTA 1229, #2#2;
|FCAL;

|PROCESO LeeCuadro;
 sw_error = 0;
 |ABRE #2;
 #2#0 = nCa1;
 #2#1 = nCa2;
 #2#4 = nCa3;
 #2#6 = nCa4;
 |LEE 001#2=;
 |SI FSalida ! 0;
     sw_error = 1;
 |FINSI;
 |CIERRA #2;
|FPRC;

|CALCULO cuadro; |TIPO 7;
|FCAL;

|PROCESO Alta2;
 #2#0 = nDCa1;
 #2#1 = nDCa2;
 #2#4 = nDCa3;
 #2#6 = nDCa4;
|FPRC;

|PROCESO Baja2;
 #2#0 = nHCa1;
 #2#1 = nHCa2;
 #2#4 = nHCa3;
 #2#6 = nHCa4;
|FPRC;

|PROCESO ConsuCuadro;

         aAlfa1 = "Subpartida";
         nCa1 = #1#3;
         nCa2 = #1#4;
         nCa3 = #1#5;
         nCa4 = #1#6;
         |SI Campo = 3;
             aAlfa1 = "Agrupacion";
             nCa2 = 00; nCa3 = 00; nCa4 = 00;
             nDCa1 =  1; nHCa1 =  9;
             nDCa2 = 00; nHCa2 = 00;
             nDCa3 = 00; nHCa3 = 00;
             nDCa4 = 00; nHCa4 = 00;
         |FINSI;
         |SI Campo = 4;
             aAlfa1 = "Subagrupacion";
             nCa3 = 00; nCa4 = 00;
             nDCa1 = nCa1; nHCa1 = nCa1;
             nDCa2 = 00;   nHCa2 = 99;
             nDCa3 = 00;   nHCa3 = 00;
             nDCa4 = 00;   nHCa4 = 00;
         |FINSI;
         |SI Campo = 5;
             aAlfa1 = "Partida";
             nCa4 = 00;
             nDCa1 = nCa1; nHCa1 = nCa1;
             nDCa2 = nCa2; nHCa2 = nCa2;
             nDCa3 = 00;   nHCa3 = 99;
             nDCa4 = 00;   nHCa4 = 00;
         |FINSI;
         |SI Campo = 6;
             aAlfa1 = "Subpartida";
             nDCa1 = nCa1; nHCa1 = nCa1;
             nDCa2 = nCa2; nHCa2 = nCa2;
             nDCa3 = nCa3; nHCa3 = nCa3;
             nDCa4 = 00;   nHCa4 = 99;
         |FINSI;

         |ABRE #2;

         #2#0 = nCa1; #2#1 = nCa2; #2#4 = nCa3; #2#6 = nCa4;

         |CONSULTA_F_CLAVE #1#2, Alta2, Baja2;

         #1#3 = #2#0; |PINTA #1#3;
         #1#4 = #2#1; |PINTA #1#4;
         #1#5 = #2#4; |PINTA #1#5;
         #1#6 = #2#6; |PINTA #1#6;

         |CIERRA #2;
|FPRC;

|CALCULO restaura; |TIPO 0;

         nInkey = FSalida;
         |SI nInkey = 2; |ACABA; |FINSI;

         |SI nInkey = 10;
             |HAZ ConsuCuadro;
         |FINSI;

         aAlfa1 = "Subpartida";
         nCa1 = #1#3;
         nCa2 = #1#4;
         nCa3 = #1#5;
         nCa4 = #1#6;
         |SI Campo = 3; aAlfa1 = "Agrupacion";    nCa2 = 00; nCa3 = 00; nCa4 = 00; |FINSI;
         |SI Campo = 4; aAlfa1 = "Subagrupacion"; nCa3 = 00; nCa4 = 00;            |FINSI;
         |SI Campo = 5; aAlfa1 = "Partida";       nCa4 = 00;                       |FINSI;

         sw_error = 0;
         |HAZ LeeCuadro;
         |SI sw_error = 1;
             aAlfa1 = "    Error. No existe " + aAlfa1;
             |MENAV aAlfa1;
             |ERROR;
             |ACABA;
         |FINSI;
         |SI Campo = 3;
             |C_A #2#2,1,40;
             |PINTA 1229, #2#2;
         |FINSI;
         |SI Campo = 6;
             |SI #2#3 = "T"; |O #2#5 = 1;
                 aAlfa1 = "    Error, esta "  + aAlfa1 + " no se puede asignar";
                 |MENAV aAlfa1;
                 |ERROR;
            |FINSI;
        |FINSI;
|FCAL;
