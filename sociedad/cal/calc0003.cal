|INCLUYE calc9999;
|INCLUYE varbal_i;

|PROCESO GrabaCas103;
     #isom0003#0  = enEmpresa;
     #isom0003#1  = enAnyo;
     #isom0003#3  = eaCasilla;
     |LEE 101#isom0003.=;
     |SI FSalida = 0;
         #isom0003#5 = enValor;
         |GRABA 020#isom0003.a;
     |FINSI;
     |LIBERA #isom0003;
|FPRC;

|PROCESO TotalFich103;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     |SELECT #2#isom0003;

|| ... A.1 RESULTADO DE EXPLOTACION

     eaCasilla = "705"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "706"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "707"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "708"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "705"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "255"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "256"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "257"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "705"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         |SI enAnyo ] 2017;
             eaCasilla = "711"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         |FINSI;

         eaCasilla = "255"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "261"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "760"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "761"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "261"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "262"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "762"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "763"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "262"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "260"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "261"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "262"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "263"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "264"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "260"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "266"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "267"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "268"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "266"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "265"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "266"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "269"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "265"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "270"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "271"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "272"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "273"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "274"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "275"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "276"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "277"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "278"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "270"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "279"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "280"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "281"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "282"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "283"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "709"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "279"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "288"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "289"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "290"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "288"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "291"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "292"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "293"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "291"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "287"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "288"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "291"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "710"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "287"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "296"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "255"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "258"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "259"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "260"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "265"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "270"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "279"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "284"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "285"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "286"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "287"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "294"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "295"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "296"; |HAZ GrabaCas103;
     |FINSI;

|| ... A.2 RESULTADO FINANCIERO
     eaCasilla = "298"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "299"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "300"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "298"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "301"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "302"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "303"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "301"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "297"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "298"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "301"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "304"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "297"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "305"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "306"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "307"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "308"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "305"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "309"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "310"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "311"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "309"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "314"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "315"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "316"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "317"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "318"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "314"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "319"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "320"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "321"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "322"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "323"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "319"; |HAZ GrabaCas103;
     |FINSI;

     eaCasilla = "313"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "314"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "319"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "313"; |HAZ GrabaCas103;
     |FINSI;

     |SI #isom0003#1 ] 2010;
         eaCasilla = "329"; |HAZ LeeCas103;
         |SI #isom0003#7 = "T";
             enValor = 0;
             eaCasilla = "330"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
             eaCasilla = "331"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
             eaCasilla = "332"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

             eaCasilla = "329"; |HAZ GrabaCas103;
         |FINSI;
     |FINSI;

     eaCasilla = "324"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "297"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "305"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "309"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "312"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "313"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         |SI #isom0003#1 ] 2010;
             eaCasilla = "329"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         |FINSI;

         eaCasilla = "324"; |HAZ GrabaCas103;
     |FINSI;

|| ... A.3 RESULTADO ANTES DE IMPUESTO
     eaCasilla = "325"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "296"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "324"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "325"; |HAZ GrabaCas103;
     |FINSI;

|| ... A.4 RESULTADO DEL EJERCICIO PROCEDENTE OPERACIONES CONTINUADAS
     eaCasilla = "327"; |HAZ LeeCas103;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "325"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "326"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "327"; |HAZ GrabaCas103;
     |FINSI;

|| ... A.5 RESULTADO DEL EJERCICIO
     eaCasilla = "500"; |HAZ LeeCas103; enValor500 = #isom0003#5;
     |SI #isom0003#7 = "T";
         enValor = 0;
         eaCasilla = "325"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "326"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;
         eaCasilla = "328"; |HAZ LeeCas103; enValor = enValor + #isom0003#5;

         eaCasilla = "500"; |HAZ GrabaCas103; enValor500 = #isom0003#5;
     |FINSI;

|| ... Actualiza Resultado de la Cuenta de Resultados en otros apartados
      |SELECT #2#isom0004;
      |HAZ TFinalFich104;
      |SELECT #1#isom0004;

      |ABRE #isom0001;
      |HAZ TotalFich101;
      |CIERRA #isom0001;

     |SI enAnyo ] 2015;
         |ABRE #isom0006;
         |ABRE #isom0022;
         |ABRE #isom0023;
         |ABRE #isom0029;

         |HAZ Total20;

         |CIERRA #isom0006;
         |CIERRA #isom0022;
         |CIERRA #isom0023;
         |CIERRA #isom0029;
     |FINSI;

     |SI enAnyo ] 2012;  |Y enAnyo [ 2014;
         |ABRE #isom0006;
         |ABRE #isom0022;
         |ABRE #isom0023;

         |HAZ Total18Bis;

         |CIERRA #isom0006;
         |CIERRA #isom0022;
         |CIERRA #isom0023;
     |FINSI;

     |SELECT #1#isom0003;
|FPRC;
