|FICHEROS;
     isy03200 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto
     imphacie #3;               || Datos Hacienda

     maempr10 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     maempr05 #12;              || Socios Transparencia Fiscal
     maempr12 #20;              || Transparancia Fiscal
     maempr13 #21;              || Transparancia Fiscal
     maempr16 #116;             || Fichero de Paises

     isocie64 #11;              || Transparencia Fiscal
     isocie65 #13;              || Balances
     isocie59 #14;              || Liquidacion
     isocie58 #15;              || Distribucion de Resultados
     isocie81 #16;              || Resumen de Deducciones 2003
     isocie60 #17;              || Cooperativas
     isocie75 #18;              || Por Doble imposicion 2003
     isocie62 #19;              || Compensaciones
     isocie67 #22;              || Informacion adicional
     isocie72 #72;              || Materializacion y Manifestacion 2003
     isocie77 #77;              || Regimen de Entidades Navieras
     isocie78 #78;              || Art.48.1 y Art 48.3
     isocie79 #79;              || Grupo de Sociedades
     isocie80 #80;              || No Residentes con mas de un establecimiento

     isw00007 #90;
     isw00008 #99,MANTE;

     isw00070 #100;             || Hoja  1
     isw00071 #101;             || Hoja  2
     isw00072 #102;             || Hoja  3
     isw00068 #104;             || Hoja 10
     isw00073 #106;             || Hoja 12A
     isw00074 #103;             || Hoja 12B
     isw00065 #108;             || Hoja 13
     isw00057 #107;             || Hoja 15B
     isw00075 #105;             || Hoja 200 o 206

     :/agicli/def/agifigen #1000;    || Bancos
|FIN;

|VARIABLES;
     nPara        = 0;
     nPara1       = 0;
     aDia         = "";
     aMes         = "";
     aEjerc       = "";
     aGuiri       = "";
     SwHay        = 0;
     aFichero     = "";
     aNombreInf   = "";
     aCodPais     = "";
     aPais        = "";

     nContaBucle  = 0;
     nContaBucleL = 0;
     nPuntero     = 0;
     nCanti       = 0;
     nCanti1      = 0;
     nCanti2      = 0;
     nCanti3      = 0;
     nCanti4      = 0;
     nCantiT      = 0;
     nC108        = 0;
     nTotal494    = 0;
     nTotal495    = 0;
     nTotal496    = 0;
     nTotal497    = 0;
     nResto       = 0;
     nSuma        = 0;

     aDImpre      = "";
     aHImpre      = "";

     fFechaD      = @;
     fFechaH      = @;
     nFecha       = 0;
     nHay         = 0;

     aAlfa        = "";
     aAlfa0       = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAbre        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     aConver      = "";

     nHandle      = 0;
     nEspa        = 0;
     nLong        = 0;
     nCampo       = 0;
     nCampoH      = 0;
     nPos         = 0;
     nCaracter    = 0;
     nNume        = 0;
     nSwPunto     = 0;
     nDesdeClav   = 0;
     nHastaClav   = 0;
     nTotal       = 0;

     &eaMoneda    = "";
     &enCanti     = 0;
     &empresa     = 0;
     &anyo        = 0;
     &eaVacio8    = "        ";
     &en88        = 0;
     &en89        = 0;
     &en90        = 0;
     &en91        = 0;
     &en92        = 0;
     &en93        = 0;
     &en94        = 0;
     &en95        = 0;
     &en96        = 0;
     &en97        = 0;
     &en98        = 0;
     &en99        = 0;
     &en100       = 0;
     &en101       = 0;
     &en102       = 0;
     &en103       = 0;
     &en104       = 0;
     &en105       = 0;
     &en106       = 0;
     &en107       = 0;
     &en108       = 0;
     &en109       = 0;
     &en110       = 0;
     &en111       = 0;
     &en112       = 0;
     &en113       = 0;
     &en114       = 0;
     &en115       = 0;
     &en116       = 0;
     &en117       = 0;
     &en118       = 0;
     &en119       = 0;
     &en120       = 0;
     &en121       = 0;
     &en122       = 0;
     &en123       = 0;
     &en124       = 0;
     &en125       = 0;
     &en126       = 0;
     &en128       = 0;
     &en130       = 0;
     &en131       = 0;
     &en132       = 0;
     &en134       = 0;
     &en135       = 0;
     &en137       = 0;
     &en138       = 0;
     &en139       = 0;
     &en141       = 0;
     &en142       = 0;
     &en143       = 0;
     &en145       = 0;
     &en146       = 0;
     &en147       = 0;
     &en149       = 0;
     &en150       = 0;
     &eaCod       = "";
     &eaNomPais   = "";
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
     |SI empresa ! 0;  |ACABA;  |FINSI;

     |SI #0#0 = "S";
         |CAMPO_MODIFICA #0#01, 1, "S";
         |CAMPO_MODIFICA #0#02, 1, "S";

         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               #0nPara = 0; |PINTA #0nPara;
               |CAMPO_MODIFICA #0nPara, 1, "N";
         |SIGUE;
     |SINO;
         #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
         #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               |CAMPO_MODIFICA #0nPara, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO TipoImpresion;
     |C_M #0#37, 1, "S";
     |C_M #0#58, 1, "S";
     |PARA nPara = 38; |SI nPara [ 54; |HACIENDO nPara = nPara + 1;
           |C_M #0nPara, 1, "S";
     |SIGUE;

     |PARA nPara = 59; |SI nPara [ 61; |HACIENDO nPara = nPara + 1;
           |C_M #0nPara, 1, "S";
     |SIGUE;

     |SI #0#34 ! "H";
         #0#37 = 1;  |C_M #0#37, 1, "N";  |PINTA #0#37;
         |PARA nPara = 38; |SI nPara [ 54; |HACIENDO nPara = nPara + 1;
               |C_M #0nPara, 1, "N";  #0nPara = "S";  |PINTA #0nPara;
         |SIGUE;

         |PARA nPara = 59; |SI nPara [ 61; |HACIENDO nPara = nPara + 1;
               |C_M #0nPara, 1, "N";  #0nPara = "S";  |PINTA #0nPara;
         |SIGUE;
     |FINSI;

     |SI #0#34 ! "C";
         #0#58 = "N";  |C_M #0#58, 1, "N";  |PINTA #0#58;
     |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#63 = eaMoneda;

     |SI #0#63 = "PESETAS";
         |MENAV "     Moneda erronea.";
         |ERROR;
     |FINSI;

     |PINTA #0#63;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

                           || 3 Enteros y 4 Decimales
|PROCESO Calcula3E4D;
     |SI aConver = "S";
         eaMoneda = #0#63;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
|FPRC;

                           || 3 Enteros y 2 Decimales
|PROCESO Calcula3E2D;
     |SI aConver = "S";
         eaMoneda = #0#63;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula2E2D;
     |SI aConver = "S";
         eaMoneda = #0#63;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula13D;
     |SI aConver = "S";
         eaMoneda = #0#63;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     |SI nCanti ] 0;
         aAlfa = nCanti;
         aAlfa = ("0000000000000" + aAlfa) % -113;
     |SINO;
         nCanti  = -nCanti;
         aAlfa   = nCanti;
         |SI #0#34 = "I";
             aAlfa   = "N" + (("000000000000" + aAlfa) % -112);
         |SINO;
             aAlfa   = "-" + (("000000000000" + aAlfa) % -112);
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Calcula15D;
     |SI aConver = "S";
         eaMoneda = #0#63;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     |SI nCanti ] 0;
         aAlfa = nCanti;
         aAlfa = ("000000000000000" + aAlfa) % -115;
     |SINO;
         nCanti  = -nCanti;
         aAlfa   = nCanti;
         |SI #0#34 = "I";
             aAlfa   = "N" + (("00000000000000" + aAlfa) % -114);
         |SINO;
             aAlfa   = "-" + (("00000000000000" + aAlfa) % -114);
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CalculaAnyo4;
     |SI aAlfa = "  ";  aAlfa = "0000";  |ACABA;  |FINSI;

     nCanti = aAlfa;
     |SI nCanti ] 0;  |Y nCanti [ 80;
         nCanti = 2000 + nCanti;
     |SINO;
         nCanti = 1900 + nCanti;
     |FINSI;

     aAlfa = nCanti;
|FPRC;

|PROCESO LeeFich;
     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#56;
     |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |CIERRA #2;

     |ABRE #3;
     #3#0 = #2#29;
     #3#1 = #2#30;
     |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     |CIERRA #3;

     |ABRE #13;
     #13#0 = #1#0;
     #13#1 = #1#1;
     |LEE 040#13=;
     |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
     |CIERRA #13;

     |ABRE #22;
     #22#0 = #1#0;
     #22#1 = #1#1;
     |LEE 040#22=;
     |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |CIERRA #22;

     |ABRE #11;
     #11#0 = #1#0;
     #11#1 = #1#1;
     |LEE 040#11=;
     |SI FSalida ! 0;  |DDEFECTO #11;  |FINSI;
     |CIERRA #11;

     |ABRE #14;
     #14#0 = #1#0;
     #14#1 = #1#1;
     |LEE 040#14=;
     |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
     |CIERRA #14;

     |ABRE #15;
     #15#0 = #1#0;
     #15#1 = #1#1;
     |LEE 040#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
     |CIERRA #15;

     |ABRE #16;
     #16#0 = #1#0;
     #16#1 = #1#1;
     |LEE 040#16=;
     |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
     |CIERRA #16;

     |ABRE #17;
     #17#0 = #1#0;
     #17#1 = #1#1;
     |LEE 040#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
     |CIERRA #17;

     |ABRE #18;
     #18#0 = #1#0;
     #18#1 = #1#1;
     |LEE 040#18=;
     |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
     |CIERRA #18;

     |ABRE #72;
     #72#0 = #1#0;
     #72#1 = #1#1;
     |LEE 040#72=;
     |SI FSalida ! 0; |DDEFECTO #72; |FINSI;
     |CIERRA #72;

     |ABRE #77;
     #77#0 = #1#0;
     #77#1 = #1#1;
     |LEE 040#77=;
     |SI FSalida ! 0; |DDEFECTO #77; |FINSI;
     |CIERRA #77;

     aGuiri = "N";
     |ABRE #4;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = 21;
     |LEE 040#4=;
     |SI FSalida = 0;
         aGuiri = "S";
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO &LeePais;
     |ABRE #116;
     |SELECT #3#116;
     #116#2 = eaCod;
     |LEE 000#116=;
     |SI FSalida ! 0;  |DDEFECTO #116;  |FINSI;
     |CIERRA #116;

     eaNomPais = "";
     |SI eaCod ! "  ";
         eaNomPais = #116#1;
     |FINSI;
|FPRC;

|PROCESO CogePais;
     |ABRE #116;
     #116#0 = aPais;
     |LEE 000#116=;
     |SI FSalida ! 0;  |DDEFECTO #116;  |FINSI;
     |CIERRA #116;

     aCodPais = #116#2;
|FPRC;

|PROCESO Defectos;
     |DDEFECTO #100;
     |DDEFECTO #101;
     |DDEFECTO #102;
     |DDEFECTO #103;
     |DDEFECTO #104;
     |DDEFECTO #106;
     |DDEFECTO #107;
     |DDEFECTO #108;
|FPRC;

|PROCESO maempr04;
     nContaBucle = nContaBucle + 1;
     |SI nContaBucle = 1;
         #100#84 = #5#3 %  0118;
         #100#85 = #5#3 %  1918;
         #100#86 = #5#4;
         #100#87 = (#5#5 % -104) + (#5#5 % 402) + (#5#5 % 102);
         #100#88 = #5#6;
     |FINSI;

     |SI nContaBucle = 2;
         #100#89 = #5#3 %  0118;
         #100#90 = #5#3 %  1918;
         #100#91 = #5#4;
         #100#92 = (#5#5 % -104) + (#5#5 % 402) + (#5#5 % 102);
         #100#93 = #5#6;
     |FINSI;

     |SI nContaBucle = 3;
         #100#94 = #5#3 %  0118;
         #100#95 = #5#3 %  1918;
         #100#96 = #5#4;
         #100#97 = (#5#5 % -104) + (#5#5 % 402) + (#5#5 % 102);
         #100#98 = #5#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #5#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr04;
|FIN;

|PROCESO maempr03;
     nContaBucle  = nContaBucle + 1;
     #101#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;
         |SI #0#34 ! "I";
             #101#8   = "";
             #101#14  = "";
             #101#20  = "";
             #101#26  = "";
             #101#32  = "";
             #101#38  = "";
             #101#73  = "";
             #101#80  = "";
             #101#87  = "";
             #101#94  = "";
             #101#101 = "";
             #101#108 = "";
         |FINSI;
         #101#175 = &13 + &10;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 6) + 6;  #101nPuntero = #6#3;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#4;

     |SI #0#34 = "I";
         aAlfa = "0";
         |SI #6#8 = "X";  aAlfa = "1";  |FINSI;
     |SINO;
         aAlfa = #6#8;
     |FINSI;
     nPuntero = nPuntero + 1;            #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#5;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#6;

     |SI aGuiri = "S";
         nPuntero = nPuntero + 1;
         aAlfa    = ("00" + #6#7) % -102;    #101nPuntero = aAlfa;
     |FINSI;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr03;
     #6#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr03;
|FIN;

|PROCESO maempr06;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;
         |SI #0#34 ! "I";
             #101#8   = "";
             #101#14  = "";
             #101#20  = "";
             #101#26  = "";
             #101#32  = "";
             #101#38  = "";
             #101#73  = "";
             #101#80  = "";
             #101#87  = "";
             #101#94  = "";
             #101#101 = "";
             #101#108 = "";
         |FINSI;
         #101#175 = &13 + &10;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 42;  #101nPuntero = #7#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #7#4;

     nPuntero = nPuntero + 1;
     aAlfa    = ("00" + #7#5) % -102;     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #7#6;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #7#7;
     |HAZ Calcula3E2D;                    #101nPuntero = aAlfa;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr06;
     #7#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr06;
|FIN;

|PROCESO maempr02;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;
         |SI #0#34 ! "I";
             #101#8   = "";
             #101#14  = "";
             #101#20  = "";
             #101#26  = "";
             #101#32  = "";
             #101#38  = "";
             #101#73  = "";
             #101#80  = "";
             #101#87  = "";
             #101#94  = "";
             #101#101 = "";
             #101#108 = "";
         |FINSI;
         #101#175 = &13 + &10;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 7) + 72; #101nPuntero = #8#3;

     |SI #0#34 = "I";
         aAlfa = "0";
         |SI #8#9 = "X";  aAlfa = "1";  |FINSI;
     |SINO;
         aAlfa = #8#9;
     |FINSI;
     nPuntero = nPuntero + 1;            #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;            #101nPuntero = #8#4;

     nPuntero = nPuntero + 1;            #101nPuntero = #8#5;

     nPuntero = nPuntero + 1;
     nNume    = #8#6;
     aAlfa    = ("00" + nNume) % -102;   #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #8#7;
     |HAZ Calcula13D;                    #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #8#8;
     |HAZ Calcula3E2D;                   #101nPuntero = aAlfa;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr02;
     #8#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr02;
|FIN;

|PROCESO maempr14;
     nContaBucle  = nContaBucle + 1;
     #101#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;
         |SI #0#34 ! "I";
             #101#8   = "";
             #101#14  = "";
             #101#20  = "";
             #101#26  = "";
             #101#32  = "";
             #101#38  = "";
             #101#73  = "";
             #101#80  = "";
             #101#87  = "";
             #101#94  = "";
             #101#101 = "";
             #101#108 = "";
         |FINSI;
         #101#175 = &13 + &10;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 114; #101nPuntero = #9#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #9#4;

     nPuntero = nPuntero + 1;             #101nPuntero = #9#5;

     nPuntero = nPuntero + 1;
     aPais    = #9#6;  |HAZ CogePais;     #101nPuntero = aCodPais;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #9#8;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr14;
     #9#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;
         |SI #0#34 ! "I";
             #101#8   = "";
             #101#14  = "";
             #101#20  = "";
             #101#26  = "";
             #101#32  = "";
             #101#38  = "";
             #101#73  = "";
             #101#80  = "";
             #101#87  = "";
             #101#94  = "";
             #101#101 = "";
             #101#108 = "";
         |FINSI;
         #101#175 = &13 + &10;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 144; #101nPuntero = #10#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #10#4;

     nPuntero = nPuntero + 1;
     aPais    = #10#5;  |HAZ CogePais;     #101nPuntero = aCodPais;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #10#7;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #10#8;
     |HAZ Calcula3E2D;                    #101nPuntero = aAlfa;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr15;
     #10#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, maempr15;
|FIN;

|PROCESO maempr05;
     nContaBucle  = nContaBucle + 1;
     #102#0       = ((nContaBucle / 11) + .49) ! 0;
     nContaBucleL = (nContaBucle + 10) - (11 * #102#0);

     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0     = ((nContaBucle / 11) + .49) ! 0;

                          #102#5 = "";
         |SI #102#0 ! 1;  #102#5 = "C";  |FINSI;

         #102#129 = &13 + &10;

         |GRABA 020#102b;
     |FINSI;

     nPuntero = (nContaBucleL * 8) + 40;  #102nPuntero = #12#3;

     |SI #0#34 = "I";
         aAlfa = "0";
         |SI #12#10 = "X";  aAlfa = "1";  |FINSI;
     |SINO;
         aAlfa = #12#10;
     |FINSI;
     nPuntero = nPuntero + 1;             #102nPuntero = aAlfa;

     nPuntero = nPuntero + 1;             #102nPuntero = #12#4;

     nPuntero = nPuntero + 1;             #102nPuntero = #12#5;

     nPuntero = nPuntero + 1;             #102nPuntero = #12#6;

     nPuntero = nPuntero + 1;
     nNume    = #12#7;
     aAlfa    = ("00" + nNume) % -102;    #102nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #12#8;
     |HAZ Calcula13D;                     #102nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #12#9;
     |HAZ Calcula3E4D;                    #102nPuntero = aAlfa;

     |GRABA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE maempr05;
     #12#2;
     ;
     #1#0, #1#1, 999.99, 00;
     #1#0, #1#1,      0, 99;
     ;
     NULL, maempr05;
|FIN;

|PROCESO maempr13;
     nContaBucleL  = nContaBucleL + 1;

     |SI nContaBucleL ] 6;
         |ERROR10;
         |ACABA;
     |FINSI;

     nPuntero = ((((nContaBucle + 5) - (6 * #103#0)) * 9) + 9) + nContaBucleL;

     #103nPuntero = #21#4;
|FPRC;

|DEFBUCLE maempr13;
     #21#1;
     ;
     #20#0, #20#1, #20#2, 00;
     #20#0, #20#1, #20#2, 99;
     ;
     NULL, maempr13;
|FIN;

|PROCESO maempr12;
     nContaBucle  = nContaBucle + 1;
     #103#0       = ((nContaBucle / 6) + .49) ! 0;

     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0 = ((nContaBucle / 6) + .49) ! 0;

                          #103#5 = "";
         |SI #103#0 ! 1;  #103#5 = "C";  |FINSI;
         #103#62 = &13 + &10;

         nTotal = 0;
         |GRABA 020#103b;
     |FINSI;

     nPuntero = (((nContaBucle + 5) - (6 * #103#0)) * 9) + 6;
                                          #103nPuntero = #20#3;

     nPuntero = nPuntero + 1;             #103nPuntero = #20#4;

     nPuntero = nPuntero + 1;
     aPais    = #20#5 % 102;              #103nPuntero = aPais;

     nPuntero = nPuntero + 1;
     aConver  = "S";
     nCanti   = #20#6;
     |HAZ Calcula13D;                     #103nPuntero = aAlfa;

     nTotal  = nTotal + #20#6;

     aConver  = "S";
     nCanti   = nTotal;
     |HAZ Calcula13D;                     #103#60      = aAlfa;

     nContaBucleL = 0;  |BUCLE maempr13;

     |GRABA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE maempr12;
     #20#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr12;
|FIN;

|PROCESO isocie78;
     nContaBucle  = nContaBucle + 1;

     #106#0 = nContaBucle;
     |LEE 101#106=;
     |SI FSalida ! 0;
         |DDEFECTO #106;
         #106#0 = nContaBucle;

                          #106#5 = "";
         |SI #106#0 ! 1;  #106#5 = "C";  |FINSI;
         #106#71 = &13 + &10;

         |GRABA 020#106b;
     |FINSI;

     #106#61 = #78#3;
     #106#62 = #78#4;
     #106#63 = #78#5;
     #106#64 = #78#6;
     #106#65 = #78#7;
     #106#66 = (#78#8 % 102) + (#78#8 % 402) + (#78#8 % -104);

     aConver = "S";  nCanti  = #78#9;   |HAZ Calcula13D;  #106#67 = aAlfa;
     aConver = "S";  nCanti  = #78#10;  |HAZ Calcula13D;  #106#68 = aAlfa;
     aConver = "S";  nCanti  = #78#11;  |HAZ Calcula13D;  #106#69 = aAlfa;

     |GRABA 020#106a;
     |LIBERA #106;
|FPRC;

|DEFBUCLE isocie78;
     #78#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, isocie78;
|FIN;

|PROCESO isocie79;
     nContaBucle  = nContaBucle + 1;
     #107#0       = ((nContaBucle / 10) + .49) ! 0;

     |LEE 101#107=;
     |SI FSalida ! 0;
         |DDEFECTO #107;
         nContaBucleL = 6;

         #107#0 = ((nContaBucle / 10) + .49) ! 0;

                          #107#5 = "";
         |SI #107#0 ! 1;  #107#5 = "C";  |FINSI;

         |GRABA 020#107b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     #107nContaBucleL = #79#3;

     |GRABA 020#107a;
     |LIBERA #107;
|FPRC;

|DEFBUCLE isocie79;
     #79#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, isocie79;
|FIN;

|PROCESO isocie80;
     nContaBucle  = nContaBucle + 1;
     #107#0       = ((nContaBucle / 5) + .49) ! 0;

     |LEE 101#107=;
     |SI FSalida ! 0;
         |DDEFECTO #107;
         nContaBucleL = 16;

         #107#0 = ((nContaBucle / 5) + .49) ! 0;

                          #107#5 = "";
         |SI #107#0 ! 1;  #107#5 = "C";  |FINSI;

         |GRABA 020#107b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     |SI nContaBucleL > 21;  nContaBucleL = 17;  |FINSI;

     #107nContaBucleL = #80#3;

     |GRABA 020#107a;
     |LIBERA #107;
|FPRC;

|DEFBUCLE isocie80;
     #80#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, isocie80;
|FIN;

|| **************************************************************************
||                           PROCESOS DE LA CARGA DEL SECUENCIAL
|| **************************************************************************

|PROCESO AbreSecuencial;
     aAlfa      = "/AEAT";                        |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET";               |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/200";           |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/200/" + #0#56;  |RMKDIR aAlfa;

     aAbre = aAlfa + "/200" + (("00000" + #99#0) % -105) + ".TXT";
     |XABRE "CBW", aAbre, nHandle;
|FPRC;

|PROCESO QuitaRaros;
     nEspa   = 0;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCaracter = 1;  |SI nCaracter [ aLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos = (100 * nCaracter) + 1;
           aCaracter = aAlfa % nPos;
           |SI #0#0 ! 347;
               |SI aCaracter = ".";  aCaracter = " ";  |FINSI;
           |FINSI;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;

     aAlfa = aCadena;
     aAlfa = aAlfa > aAlfa;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO CierraSecuencial;
     |XCIERRA nHandle;
|FPRC;

|PROCESO Secuencial01;
     |PARA nCampo = 1;  |SI nCampo [ 102;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #100nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial02;
     |PARA nCampo = 1;  |SI nCampo [ 175;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #101nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial03;
     |PARA nCampo = 1;  |SI nCampo [ 129;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #102nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial4a;
     aAlfa = "<T20004A>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 3;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;
     aAlfa = "</T20004A>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial4b;
     aAlfa = "<T20004B>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 53;  |SI nCampo [ 65;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;
     aAlfa = "</T20004B>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial5a;
     aAlfa = "<T20005A>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 66;  |SI nCampo [ 72;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 194;  |SI nCampo [ 195;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 73;  |SI nCampo [ 106;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T20005A>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial5b;
     aAlfa = "<T20005B>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 107;  |SI nCampo [ 128;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;
     aAlfa = "</T20005B>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial06;
     aAlfa = "<T200006>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 129;  |SI nCampo [ 162;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;
     aAlfa = "</T200006>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial07;
     aAlfa = "<T200007>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;
     |PARA nCampo = 163;  |SI nCampo [ 193;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #13nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 3;    |SI nCampo [ 16;   |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #15nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T200007>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial08;
     aAlfa = "<T200008>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 2;    |SI nCampo [ 16;   |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #14nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #14#18; |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 20;   |SI nCampo [ 34;   |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #14nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #14#124; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#128; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#129; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#130; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#132; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#133; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#134; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#135; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#136; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#137; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#35;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#36;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#39;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#125; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#38;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#126; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#40;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#127; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#37;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#65;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#66;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 41;   |SI nCampo [ 46;   |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #14nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #14#131; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "N";  nCanti  = #14#47;  |HAZ Calcula2E2D; |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#48;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#49;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#50;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     aAlfa = "</T200008>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial09;
     aAlfa = "<T200009>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #14#50; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#67; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#59; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#60; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#61; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#62; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#64; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#57; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#58; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#54; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#55; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#51; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#68; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#53; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#63; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#56; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#69; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#70; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#72; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#71; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#75; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#52; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#76; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#77; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#78; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#74; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#81; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #14#82; |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 83;   |SI nCampo [ 106;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
            nCanti  = #14nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T200009>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial10;
     |PARA nCampo = 1;  |SI nCampo [ 153;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #104nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial11;
     aAlfa = "<T200011>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #16#2;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #16#3;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 5;   |SI nCampo [ 138; |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #16nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 140;  |SI nCampo [ 151;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #16nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T200011>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial12A;
     |SI  #106#33 = "0000000000000";  |Y  #106#34 = "0000000000000";
      |Y  #106#35 = "0000000000000";  |Y  #106#43 = "0000000000000";
      |Y  #106#44 = "0000000000000";  |Y  #106#54 = "0000000000000";
      |Y  #106#55 = "0000000000000";  |Y  #106#57 = "0000000000000";
      |Y  #106#58 = "0000000000000";  |Y  #106#59 = "0000000000000";
      |Y  #106#60 = "0000000000000";  |Y  #106#67 = "0000000000000";
      |Y  #106#68 = "0000000000000";  |Y  #106#69 = "0000000000000";
          |ACABA;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 71;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #106nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial12B;
     |SI  #103#60 = "0000000000000";  |ACABA;  |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #103nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial13;
     |SI #108#12 =  "00000";  |Y #108#13 =  "00000";
      |Y #108#14 =  "00000";  |Y #108#15 =  "00000";
         |ACABA;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 77;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #108nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial14;
     nSuma = 0;
     |PARA nCampo = 2;   |SI nCampo [ 5;  |HACIENDO nCampo = nCampo + 1;
           nSuma = nSuma + #22nCampo;
     |SIGUE;

     nSuma = nSuma + #22#71;

     |PARA nCampo = 6;   |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
           nSuma = nSuma + #22nCampo;
     |SIGUE;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     aAlfa = "<T200014>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 2;   |SI nCampo [ 5;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #22nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti = #22#71;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 6;   |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #22nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T200014>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial15A;
     nSuma = 0;
     |PARA nCampo = 33;   |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           nSuma = nSuma + #22nCampo;
     |SIGUE;

     nSuma = nSuma + #22#72 + #22#73;

     |PARA nCampo = 51;   |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
           nSuma = nSuma + #22nCampo;
     |SIGUE;

     |PARA nCampo = 61;   |SI nCampo [ 70;  |HACIENDO nCampo = nCampo + 1;
           nSuma = nSuma + #22nCampo;
     |SIGUE;

     |SI nSuma = 0;  |ACABA;  |FINSI;

     aAlfa = "<T20015A>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 33;   |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #22nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti = #22#72;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 51;   |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #22nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti = #22#73;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 61;   |SI nCampo [ 70;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #22nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T20015A>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;              |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial15B;
     |SI #107#6  = "0000000000000";  |Y  #107#17 = "         ";
     |Y  #107#18 = "         ";      |Y  #107#19 = "         ";
     |Y  #107#20 = "         ";      |Y  #107#21 = "         ";
         |ACABA;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 22;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #107nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = &13 + &10;    |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial200;
     |PARA nCampo = 1;  |SI nCampo [ 57;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #105nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial;
     |SI aNombreInf = "0320001";  |HAZ Secuencial01;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320002";  |HAZ Secuencial02;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320003";  |HAZ Secuencial03;  |ACABA;  |FINSI;
     |SI aNombreInf = "032004a";  |HAZ Secuencial4a;  |ACABA;  |FINSI;
     |SI aNombreInf = "032004b";  |HAZ Secuencial4b;  |ACABA;  |FINSI;
     |SI aNombreInf = "032005a";  |HAZ Secuencial5a;  |ACABA;  |FINSI;
     |SI aNombreInf = "032005b";  |HAZ Secuencial5b;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320006";  |HAZ Secuencial06;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320007";  |HAZ Secuencial07;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320008";  |HAZ Secuencial08;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320009";  |HAZ Secuencial09;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320010";  |HAZ Secuencial10;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320011";  |HAZ Secuencial11;  |ACABA;  |FINSI;
     |SI aNombreInf = "320012a";  |HAZ Secuencial12A; |ACABA;  |FINSI;
     |SI aNombreInf = "320012b";  |HAZ Secuencial12B; |ACABA;  |FINSI;
     |SI aNombreInf = "0320013";  |HAZ Secuencial13;  |ACABA;  |FINSI;
     |SI aNombreInf = "0320014";  |HAZ Secuencial14;  |ACABA;  |FINSI;
     |SI aNombreInf = "320015a";  |HAZ Secuencial15A; |ACABA;  |FINSI;
     |SI aNombreInf = "320015b";  |HAZ Secuencial15B; |ACABA;  |FINSI;
     |SI aNombreInf = "3200200";  |HAZ Secuencial200; |ACABA;  |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|PROCESO Impresion;
     |SI #0#34 = "I";
         |HAZ Secuencial;
         |ACABA;
     |FINSI;

     |SI #0#34 = "C";
         aNombreInf = "h" + aNombreInf;

         |INFOR aNombreInf;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PRINT;   |PIEINF;   |FININF;
         |ACABA;
     |FINSI;

     |ET Comienzo;
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA;  |FINSI;

         aNombreInf = "m" + aNombreInf;
         aAlfa1    = aNombreInf % -102;

         |SI aAlfa1 ! "16";
             #90#2 = "COLOQUE HOJA " + aAlfa1 + " DEL MODELO 200, <INTRO PARA IMPRIMIR>";
         |SINO;
             |SI aGuiri = "N";
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 200, <INTRO PARA IMPRIMIR>";
             |SINO;
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 206, <INTRO PARA IMPRIMIR>";
             |FINSI;
         |FINSI;

         |ATRI P; |PINTA #90#2; |ATRI 0;
         |PAUSA;

         |INFOR aNombreInf;
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

         |PRINT; |PIEINF; |FININF;  |FINIMP;

         |CONFI "2400NDesea repetir la hoja : ";
         |SI FSalida = 0;  |VETE Comienzo;  |FINSI;
|FPRC;


|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO Hoja1;
     #90#2 = "GENERANDO HOJA 01";  |PINTA #90#2;

     |DDEFECTO #100;
     #100#6  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);  || Codigo
     #100#7  = #2#31 % 102;            || Del Dia
     #100#8  = #2#31 % 402;            || Del Mes
     #100#9  = #2#31 % -104;           || Del A¤o
     #100#10 = #2#32 % 102;            || Al Dia
     #100#11 = #2#32 % 402;            || Al Mes
     #100#12 = #2#32 % -104;           || Al A¤o
     |SI #2#31 = "01.01.2003";  |Y #2#32 = "31.12.2003";
         #100#13 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #2#31;
         fFechaH = #2#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #100#13 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #100#13 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     |SI #0#55 = 1;
         aAlfa   = ((#2#17 % 102) + "00") % 102;       || CNAE
     |SINO;
         aAlfa   = ((#2#17 % -102) + "00") % 102;      || CNAE
     |FINSI;
     #100#14 = aAlfa;                                  || CNAE

     #100#15 = #2#3;                   || NIF
     #100#16 = #2#2;                   || Nombre
     #100#17 = #2#4;                   || SG
     #100#18 = #2#5;                   || Domicilio
     #100#19 = #2#6;                   || Numero
     #100#20 = #2#7;                   || Escalera
     #100#21 = #2#8;                   || Piso
     #100#22 = #2#9;                   || Puerta
     #100#23 = #2#15;                  || Telefono
     #100#24 = #2#13;                  || Municipio
     #100#25 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#26 = ("00" + #2#10) % -102;  || Provincia
     #100#27 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);   || Codigo Postal Entero
     |SI #2#98 = "S";  #100#28 = "1";  |FINSI;   || Es Complementaria
     aAlfa1  = #2#99;  |QBT aAlfa1;
     aAlfa2  = #2#100; |QBT aAlfa2;
     #100#29 = ("0000000000000" + aAlfa1 + aAlfa2) % -113;  || N§ Justificante

     |ABRE #4;
     |PARA nPara = 30;  |SI nPara [ 73;  |HACIENDO nPara = nPara + 1;
           |SI nPara [ 64;
               nPara1 = nPara - 29;
           |FINSI;

           |SI nPara = 65;  nPara1 = 37;  |FINSI;
           |SI nPara = 66;  nPara1 = 38;  |FINSI;
           |SI nPara = 67;  nPara1 = 39;  |FINSI;
           |SI nPara = 68;  nPara1 = 43;  |FINSI;
           |SI nPara = 69;  nPara1 = 44;  |FINSI;
           |SI nPara = 70;  nPara1 = 45;  |FINSI;
           |SI nPara = 71;  nPara1 = 46;  |FINSI;
           |SI nPara = 72;  nPara1 = 47;  |FINSI;
           |SI nPara = 73;  nPara1 = 48;  |FINSI;

           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = nPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #100nPara = "1";
               |SI nPara1 = 9;  |O nPara1 = 10;
                   |SI #100#74 = "      ";
                       #100#74 = #4#4;
                   |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     nNume   = #2#75 * 100;
     #100#75 = ("0000000000" + nNume) % -109;  || Empleados no fijos
     nNume   = #2#76 * 100;
     #100#76 = ("0000000000" + nNume) % -109;  || Empleados si fijos
     #100#77 = #2#77;                          || Nombre Secretario
     #100#78 = #2#78;                          || NIF    Secretario
     #100#79 = "";
     |SI aGuiri = "S";
         #100#79 = (#0#33 % -104) + (#0#33 % 402) + (#0#33 % 102);
     |FINSI;

     #100#80 = #2#13;                            || Poblacion firma
     #100#81 = aDia;                             || Dia
     #100#82 = aMes;                             || Mes
     #100#83 = aEjerc;                           || A¤o

     nContaBucle = 0;    |BUCLE maempr04;

     |SI #100#87 = "        ";  #100#87 = "00000000";  |FINSI;
     |SI #100#92 = "        ";  #100#92 = "00000000";  |FINSI;
     |SI #100#97 = "        ";  #100#97 = "00000000";  |FINSI;

     |SI #0#62 = "S";
         #100#100 = (("00000" + #2#0) % -105) + " " + #2#1;
     |FINSI;

     #100#102 = &13 + &10;

     aNombreInf = "0320001";  |HAZ Impresion;
|FPRC;

|DEFBUCLE isw00052;
     #101#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Hoja2;
     #90#2 = "GENERANDO HOJA 02";  |PINTA #90#2;

     |ABRE #101;

     nContaBucle = 0;    |BUCLE maempr03;
     nContaBucle = 0;    |BUCLE maempr06;
     nContaBucle = 0;    |BUCLE maempr02;
     nContaBucle = 0;    |BUCLE maempr14;
     nContaBucle = 0;    |BUCLE maempr15;

     |CIERRA #101;

     aNombreInf = "0320002";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00052;
|FPRC;

|DEFBUCLE isw00053;
     #102#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Hoja3;
     #90#2 = "GENERANDO HOJA 03";  |PINTA #90#2;

     |ABRE #102;

     |DDEFECTO #102;
     |SI #100#41 = "0";  |Y #100#42 = "0";  |Y #100#43 = "0";  |Y #0#34 = "I";
         |ACABA;
     |FINSI;

     #102#0 = 1;
     #102#5 = "";

     |ABRE #4;
     |PARA nPara = 6;  |SI nPara [ 8;  |HACIENDO nPara = nPara + 1;
           nPara1 = nPara + 61;
           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = nPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #102nPara = "1";
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     aConver = "N";  nCanti  = #11#2;  |HAZ Calcula3E4D; #102#9  = aAlfa;
     aConver = "S";  nCanti  = #11#3;  |HAZ Calcula13D;  #102#10 = aAlfa;
     aConver = "S";  nCanti  = #11#4;  |HAZ Calcula13D;  #102#11 = aAlfa;
     aConver = "S";  nCanti  = #11#5;  |HAZ Calcula13D;  #102#12 = aAlfa;
                                                         #102#13 = #11#6;
     aConver = "N";  nCanti  = #11#7;  |HAZ Calcula3E2D; #102#14 = aAlfa;
     aConver = "S";  nCanti  = #11#8;  |HAZ Calcula13D;  #102#15 = aAlfa;
                                                         #102#16 = #11#9;
     aConver = "N";  nCanti  = #11#10; |HAZ Calcula3E2D; #102#17 = aAlfa;
     aConver = "S";  nCanti  = #11#11; |HAZ Calcula13D;  #102#18 = aAlfa;
                                                         #102#19 = #11#12;
     aConver = "N";  nCanti  = #11#13; |HAZ Calcula3E2D; #102#20 = aAlfa;
     aConver = "S";  nCanti  = #11#14; |HAZ Calcula13D;  #102#21 = aAlfa;
                                                         #102#22 = #11#15;
     aConver = "N";  nCanti  = #11#16; |HAZ Calcula3E2D; #102#23 = aAlfa;
     aConver = "S";  nCanti  = #11#17; |HAZ Calcula13D;  #102#24 = aAlfa;
     aConver = "N";  nCanti  = #11#18; |HAZ Calcula3E2D; #102#25 = aAlfa;
     aConver = "S";  nCanti  = #11#19; |HAZ Calcula13D;  #102#26 = aAlfa;
     aConver = "N";  nCanti  = #11#20; |HAZ Calcula3E2D; #102#27 = aAlfa;
     aConver = "S";  nCanti  = #11#21; |HAZ Calcula13D;  #102#28 = aAlfa;
     aConver = "N";  nCanti  = #11#22; |HAZ Calcula3E2D; #102#29 = aAlfa;
     aConver = "S";  nCanti  = #11#23; |HAZ Calcula13D;  #102#30 = aAlfa;
     aConver = "N";  nCanti  = #11#24; |HAZ Calcula3E2D; #102#31 = aAlfa;
     aConver = "S";  nCanti  = #11#25; |HAZ Calcula13D;  #102#32 = aAlfa;
     aConver = "S";  nCanti  = #11#26; |HAZ Calcula13D;  #102#33 = aAlfa;
     aConver = "S";  nCanti  = #11#27; |HAZ Calcula13D;  #102#34 = aAlfa;
     aConver = "S";  nCanti  = #11#28; |HAZ Calcula13D;  #102#35 = aAlfa;
     aConver = "S";  nCanti  = #11#29; |HAZ Calcula13D;  #102#36 = aAlfa;
     aConver = "S";  nCanti  = #11#30; |HAZ Calcula13D;  #102#37 = aAlfa;
     aConver = "S";  nCanti  = #11#31; |HAZ Calcula13D;  #102#38 = aAlfa;
     aConver = "S";  nCanti  = #11#32; |HAZ Calcula13D;  #102#39 = aAlfa;

     #102#129 = &13 + &10;

     |GRABA 020#102n;

     nContaBucle = 0;    |BUCLE maempr05;

     |CIERRA #102;

     aNombreInf = "0320003";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00053;
|FPRC;

|PROCESO Hoja4A;
     #90#2 = "GENERANDO HOJA 04A";  |PINTA #90#2;

     aNombreInf = "032004a";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja4B;
     #90#2 = "GENERANDO HOJA 04B";  |PINTA #90#2;

     aNombreInf = "032004b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5A;
     #90#2 = "GENERANDO HOJA 05A";  |PINTA #90#2;

     aNombreInf = "032005a";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5B;
     #90#2 = "GENERANDO HOJA 05B";  |PINTA #90#2;

     aNombreInf = "032005b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja6;
     #90#2 = "GENERANDO HOJA 06";  |PINTA #90#2;

     aNombreInf = "0320006";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja7;
     #90#2 = "GENERANDO HOJA 07";  |PINTA #90#2;

     aNombreInf = "0320007";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja8;
     #90#2 = "GENERANDO HOJA 08";  |PINTA #90#2;

     aNombreInf = "0320008";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja9;
     #90#2 = "GENERANDO HOJA 09";  |PINTA #90#2;

     aNombreInf = "0320009";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja10;
     #90#2 = "GENERANDO HOJA 10";  |PINTA #90#2;

     |DDEFECTO #104;
     #104#2 = "200";
     #104#3 = "010";
     #104#5 = "";
     #104#152 = "</T200010>";

     |ABRE #19;
     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 547;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

                     aAlfa   = #19#4;  |HAZ CalculaAnyo4;  #104#6  = aAlfa;
     aConver = "S";  nCanti  = #19#9;  |HAZ Calcula13D;    #104#7  = aAlfa;
     aConver = "S";  nCanti  = #19#15; |HAZ Calcula13D;    #104#8  = aAlfa;
     aConver = "S";  nCanti  = #19#21; |HAZ Calcula13D;    #104#9  = aAlfa;

                     aAlfa   = #19#5;  |HAZ CalculaAnyo4;  #104#10 = aAlfa;
     aConver = "S";  nCanti  = #19#10; |HAZ Calcula13D;    #104#11 = aAlfa;
     aConver = "S";  nCanti  = #19#16; |HAZ Calcula13D;    #104#12 = aAlfa;
     aConver = "S";  nCanti  = #19#22; |HAZ Calcula13D;    #104#13 = aAlfa;

                     aAlfa   = #19#6;  |HAZ CalculaAnyo4;  #104#14 = aAlfa;
     aConver = "S";  nCanti  = #19#11; |HAZ Calcula13D;    #104#15 = aAlfa;
     aConver = "S";  nCanti  = #19#17; |HAZ Calcula13D;    #104#16 = aAlfa;
     aConver = "S";  nCanti  = #19#23; |HAZ Calcula13D;    #104#17 = aAlfa;

                     aAlfa   = #19#7;  |HAZ CalculaAnyo4;  #104#18 = aAlfa;
     aConver = "S";  nCanti  = #19#12; |HAZ Calcula13D;    #104#19 = aAlfa;
     aConver = "S";  nCanti  = #19#18; |HAZ Calcula13D;    #104#20 = aAlfa;
     aConver = "S";  nCanti  = #19#24; |HAZ Calcula13D;    #104#21 = aAlfa;

                     aAlfa   = #19#8;  |HAZ CalculaAnyo4;  #104#22 = aAlfa;
     aConver = "S";  nCanti  = #19#13; |HAZ Calcula13D;    #104#23 = aAlfa;
     aConver = "S";  nCanti  = #19#19; |HAZ Calcula13D;    #104#24 = aAlfa;
     aConver = "S";  nCanti  = #19#25; |HAZ Calcula13D;    #104#25 = aAlfa;

                     aAlfa   = #19#27; |HAZ CalculaAnyo4;  #104#26 = aAlfa;
     aConver = "S";  nCanti  = #19#28; |HAZ Calcula13D;    #104#27 = aAlfa;
     aConver = "S";  nCanti  = #19#29; |HAZ Calcula13D;    #104#28 = aAlfa;
     aConver = "S";  nCanti  = #19#30; |HAZ Calcula13D;    #104#29 = aAlfa;

                     aAlfa   = #19#31; |HAZ CalculaAnyo4;  #104#30 = aAlfa;
     aConver = "S";  nCanti  = #19#32; |HAZ Calcula13D;    #104#31 = aAlfa;
     aConver = "S";  nCanti  = #19#33; |HAZ Calcula13D;    #104#32 = aAlfa;
     aConver = "S";  nCanti  = #19#34; |HAZ Calcula13D;    #104#33 = aAlfa;

                     aAlfa   = #19#35; |HAZ CalculaAnyo4;  #104#34 = aAlfa;
     aConver = "S";  nCanti  = #19#36; |HAZ Calcula13D;    #104#35 = aAlfa;
     aConver = "S";  nCanti  = #19#37; |HAZ Calcula13D;    #104#36 = aAlfa;
     aConver = "S";  nCanti  = #19#38; |HAZ Calcula13D;    #104#37 = aAlfa;

                     aAlfa   = #19#39; |HAZ CalculaAnyo4;  #104#38 = aAlfa;
     aConver = "S";  nCanti  = #19#40; |HAZ Calcula13D;    #104#39 = aAlfa;
     aConver = "S";  nCanti  = #19#41; |HAZ Calcula13D;    #104#40 = aAlfa;
     aConver = "S";  nCanti  = #19#42; |HAZ Calcula13D;    #104#41 = aAlfa;

                     aAlfa   = #19#43; |HAZ CalculaAnyo4;  #104#42 = aAlfa;
     aConver = "S";  nCanti  = #19#44; |HAZ Calcula13D;    #104#43 = aAlfa;
     aConver = "S";  nCanti  = #19#45; |HAZ Calcula13D;    #104#44 = aAlfa;
     aConver = "S";  nCanti  = #19#46; |HAZ Calcula13D;    #104#45 = aAlfa;

                     aAlfa   = #19#47; |HAZ CalculaAnyo4;  #104#46 = aAlfa;
     aConver = "S";  nCanti  = #19#48; |HAZ Calcula13D;    #104#47 = aAlfa;
     aConver = "S";  nCanti  = #19#49; |HAZ Calcula13D;    #104#48 = aAlfa;
     aConver = "S";  nCanti  = #19#50; |HAZ Calcula13D;    #104#49 = aAlfa;

     aConver = "S";  nCanti  = #19#14; |HAZ Calcula13D;    #104#50 = aAlfa;
     aConver = "S";  nCanti  = #19#20; |HAZ Calcula13D;    #104#51 = aAlfa;
     aConver = "S";  nCanti  = #19#26; |HAZ Calcula13D;    #104#52 = aAlfa;

     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 561;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

                     aAlfa   = #19#4;  |HAZ CalculaAnyo4;  #104#53 = aAlfa;
     aConver = "S";  nCanti  = #19#9;  |HAZ Calcula13D;    #104#54 = aAlfa;
     aConver = "S";  nCanti  = #19#15; |HAZ Calcula13D;    #104#55 = aAlfa;
     aConver = "S";  nCanti  = #19#21; |HAZ Calcula13D;    #104#56 = aAlfa;

                     aAlfa   = #19#5;  |HAZ CalculaAnyo4;  #104#57 = aAlfa;
     aConver = "S";  nCanti  = #19#10; |HAZ Calcula13D;    #104#58 = aAlfa;
     aConver = "S";  nCanti  = #19#16; |HAZ Calcula13D;    #104#59 = aAlfa;
     aConver = "S";  nCanti  = #19#22; |HAZ Calcula13D;    #104#60 = aAlfa;

                     aAlfa   = #19#6;  |HAZ CalculaAnyo4;  #104#61 = aAlfa;
     aConver = "S";  nCanti  = #19#11; |HAZ Calcula13D;    #104#62 = aAlfa;
     aConver = "S";  nCanti  = #19#17; |HAZ Calcula13D;    #104#63 = aAlfa;
     aConver = "S";  nCanti  = #19#23; |HAZ Calcula13D;    #104#64 = aAlfa;

                     aAlfa   = #19#7;  |HAZ CalculaAnyo4;  #104#65 = aAlfa;
     aConver = "S";  nCanti  = #19#12; |HAZ Calcula13D;    #104#66 = aAlfa;
     aConver = "S";  nCanti  = #19#18; |HAZ Calcula13D;    #104#67 = aAlfa;
     aConver = "S";  nCanti  = #19#24; |HAZ Calcula13D;    #104#68 = aAlfa;

                     aAlfa   = #19#8;  |HAZ CalculaAnyo4;  #104#69 = aAlfa;
     aConver = "S";  nCanti  = #19#13; |HAZ Calcula13D;    #104#70 = aAlfa;
     aConver = "S";  nCanti  = #19#19; |HAZ Calcula13D;    #104#71 = aAlfa;
     aConver = "S";  nCanti  = #19#25; |HAZ Calcula13D;    #104#72 = aAlfa;

                     aAlfa   = #19#27; |HAZ CalculaAnyo4;  #104#73 = aAlfa;
     aConver = "S";  nCanti  = #19#28; |HAZ Calcula13D;    #104#74 = aAlfa;
     aConver = "S";  nCanti  = #19#29; |HAZ Calcula13D;    #104#75 = aAlfa;
     aConver = "S";  nCanti  = #19#30; |HAZ Calcula13D;    #104#76 = aAlfa;

                     aAlfa   = #19#31; |HAZ CalculaAnyo4;  #104#77 = aAlfa;
     aConver = "S";  nCanti  = #19#32; |HAZ Calcula13D;    #104#78 = aAlfa;
     aConver = "S";  nCanti  = #19#33; |HAZ Calcula13D;    #104#79 = aAlfa;
     aConver = "S";  nCanti  = #19#34; |HAZ Calcula13D;    #104#80 = aAlfa;

                     aAlfa   = #19#35; |HAZ CalculaAnyo4;  #104#81 = aAlfa;
     aConver = "S";  nCanti  = #19#36; |HAZ Calcula13D;    #104#82 = aAlfa;
     aConver = "S";  nCanti  = #19#37; |HAZ Calcula13D;    #104#83 = aAlfa;
     aConver = "S";  nCanti  = #19#38; |HAZ Calcula13D;    #104#84 = aAlfa;

     aConver = "S";  nCanti  = #19#14; |HAZ Calcula13D;    #104#85 = aAlfa;
     aConver = "S";  nCanti  = #19#20; |HAZ Calcula13D;    #104#86 = aAlfa;
     aConver = "S";  nCanti  = #19#26; |HAZ Calcula13D;    #104#87 = aAlfa;

     aConver = "S";  nCanti  = #18#2;   |HAZ Calcula13D;    #104#88  = aAlfa;
     aConver = "S";  nCanti  = #18#3;   |HAZ Calcula13D;    #104#89  = aAlfa;
     aConver = "S";  nCanti  = #18#4;   |HAZ Calcula13D;    #104#90  = aAlfa;
     aConver = "S";  nCanti  = #18#5;   |HAZ Calcula13D;    #104#91  = aAlfa;
     aConver = "S";  nCanti  = #18#6;   |HAZ Calcula13D;    #104#92  = aAlfa;
     aConver = "S";  nCanti  = #18#7;   |HAZ Calcula13D;    #104#93  = aAlfa;
     aConver = "S";  nCanti  = #18#8;   |HAZ Calcula13D;    #104#94  = aAlfa;
     aConver = "S";  nCanti  = #18#9;   |HAZ Calcula13D;    #104#95  = aAlfa;
     aConver = "S";  nCanti  = #18#10;  |HAZ Calcula13D;    #104#96  = aAlfa;
     aConver = "S";  nCanti  = #18#11;  |HAZ Calcula13D;    #104#97  = aAlfa;
     aConver = "S";  nCanti  = #18#12;  |HAZ Calcula13D;    #104#98  = aAlfa;
     aConver = "S";  nCanti  = #18#13;  |HAZ Calcula13D;    #104#99  = aAlfa;
     aConver = "S";  nCanti  = #18#14;  |HAZ Calcula13D;    #104#100 = aAlfa;
     aConver = "S";  nCanti  = #18#15;  |HAZ Calcula13D;    #104#101 = aAlfa;
     aConver = "S";  nCanti  = #18#16;  |HAZ Calcula13D;    #104#102 = aAlfa;
     aConver = "S";  nCanti  = #18#23;  |HAZ Calcula13D;    #104#103 = aAlfa;
     aConver = "S";  nCanti  = #18#24;  |HAZ Calcula13D;    #104#104 = aAlfa;
     aConver = "S";  nCanti  = #18#25;  |HAZ Calcula13D;    #104#105 = aAlfa;
     aConver = "S";  nCanti  = #18#26;  |HAZ Calcula13D;    #104#106 = aAlfa;
     aConver = "S";  nCanti  = #18#27;  |HAZ Calcula13D;    #104#107 = aAlfa;
     aConver = "S";  nCanti  = #18#28;  |HAZ Calcula13D;    #104#108 = aAlfa;
     aConver = "S";  nCanti  = #18#29;  |HAZ Calcula13D;    #104#109 = aAlfa;
     aConver = "S";  nCanti  = #18#30;  |HAZ Calcula13D;    #104#110 = aAlfa;
     aConver = "S";  nCanti  = #18#31;  |HAZ Calcula13D;    #104#111 = aAlfa;
     aConver = "S";  nCanti  = #18#32;  |HAZ Calcula13D;    #104#112 = aAlfa;
     aConver = "S";  nCanti  = #18#33;  |HAZ Calcula13D;    #104#113 = aAlfa;
     aConver = "S";  nCanti  = #18#34;  |HAZ Calcula13D;    #104#114 = aAlfa;
     aConver = "S";  nCanti  = #18#41;  |HAZ Calcula13D;    #104#115 = aAlfa;
     aConver = "S";  nCanti  = #18#42;  |HAZ Calcula13D;    #104#116 = aAlfa;
     aConver = "S";  nCanti  = #18#43;  |HAZ Calcula13D;    #104#117 = aAlfa;

     aConver = "S";  nCanti  = #18#17;  |HAZ Calcula13D;    #104#118 = aAlfa;
     aConver = "S";  nCanti  = #18#18;  |HAZ Calcula13D;    #104#119 = aAlfa;
     aConver = "S";  nCanti  = #18#19;  |HAZ Calcula13D;    #104#120 = aAlfa;
     aConver = "S";  nCanti  = #18#20;  |HAZ Calcula13D;    #104#121 = aAlfa;
     aConver = "S";  nCanti  = #18#21;  |HAZ Calcula13D;    #104#122 = aAlfa;
     aConver = "S";  nCanti  = #18#22;  |HAZ Calcula13D;    #104#123 = aAlfa;
     aConver = "S";  nCanti  = #18#44;  |HAZ Calcula13D;    #104#124 = aAlfa;
     aConver = "S";  nCanti  = #18#45;  |HAZ Calcula13D;    #104#125 = aAlfa;
     aConver = "S";  nCanti  = #18#46;  |HAZ Calcula13D;    #104#126 = aAlfa;

     |SI #72#21 = "X";  #104#127 = "1";  |FINSI;
     aConver = "S";  nCanti  = #72#22;  |HAZ Calcula13D;    #104#128 = aAlfa;

     |SI #72#23 = "X";  #104#129 = "1";  |FINSI;
     aConver = "S";  nCanti  = #72#24;  |HAZ Calcula13D;    #104#130 = aAlfa;

     aConver = "S";  nCanti  = #72#2;  |HAZ Calcula13D;     #104#131 = aAlfa;
     aConver = "S";  nCanti  = #72#3;  |HAZ Calcula13D;     #104#132 = aAlfa;
                                                            #104#133 = #72#4;

     aConver = "S";  nCanti  = #72#5;  |HAZ Calcula13D;     #104#134 = aAlfa;
     aConver = "S";  nCanti  = #72#6;  |HAZ Calcula13D;     #104#135 = aAlfa;
                                                            #104#136 = #72#7;
     aConver = "S";  nCanti  = #72#8;  |HAZ Calcula13D;     #104#137 = aAlfa;

     aConver = "S";  nCanti  = #72#9;  |HAZ Calcula13D;     #104#138 = aAlfa;
     aConver = "S";  nCanti  = #72#10; |HAZ Calcula13D;     #104#139 = aAlfa;
                                                            #104#140 = #72#11;
     aConver = "S";  nCanti  = #72#12; |HAZ Calcula13D;     #104#141 = aAlfa;

     aConver = "S";  nCanti  = #72#13; |HAZ Calcula13D;     #104#142 = aAlfa;
     aConver = "S";  nCanti  = #72#14; |HAZ Calcula13D;     #104#143 = aAlfa;
                                                            #104#144 = #72#15;
     aConver = "S";  nCanti  = #72#16; |HAZ Calcula13D;     #104#145 = aAlfa;

     aConver = "S";  nCanti  = #72#17; |HAZ Calcula13D;     #104#146 = aAlfa;
     aConver = "S";  nCanti  = #72#18; |HAZ Calcula13D;     #104#147 = aAlfa;
                                                            #104#148 = #72#19;
     aConver = "S";  nCanti  = #72#20; |HAZ Calcula13D;     #104#149 = aAlfa;

     aConver = "S";  nCanti  = #72#25; |HAZ Calcula13D;     #104#150 = aAlfa;
                                                            #104#151 = #72#26;

     #104#152 = "</T200010>";
     #104#153 = &13 + &10;

     |SI #104#50  = "0000000000000";  |Y #104#85  = "0000000000000";
      |Y #104#115 = "0000000000000";  |Y #104#124 = "0000000000000";
      |Y #104#128 = "0000000000000";  |Y #104#130 = "0000000000000";
      |Y #104#131 = "0000000000000";  |Y #104#134 = "0000000000000";
      |Y #104#138 = "0000000000000";  |Y #104#142 = "0000000000000";
      |Y #104#146 = "0000000000000";  |Y #104#151 = "0000000000000";
      |Y #0#34 = "I";
         |ACABA;
     |FINSI;
                           || Esto es porque el informe no aguantaba mas
                           || operaciones.

     en88  = #104#88;   en88  = en88  / 100;
     en89  = #104#88;   en89  = en89  / 100;
     en90  = #104#90;   en90  = en90  / 100;
     en91  = #104#91;   en91  = en91  / 100;
     en92  = #104#92;   en92  = en92  / 100;
     en93  = #104#93;   en93  = en93  / 100;
     en94  = #104#94;   en94  = en94  / 100;
     en95  = #104#95;   en95  = en95  / 100;
     en96  = #104#96;   en96  = en96  / 100;
     en97  = #104#97;   en97  = en97  / 100;
     en98  = #104#98;   en98  = en98  / 100;
     en99  = #104#99;   en99  = en99  / 100;
     en100 = #104#100;  en100 = en100 / 100;
     en101 = #104#101;  en101 = en101 / 100;
     en102 = #104#102;  en102 = en102 / 100;
     en103 = #104#103;  en103 = en103 / 100;
     en104 = #104#104;  en104 = en104 / 100;
     en105 = #104#105;  en105 = en105 / 100;
     en106 = #104#106;  en106 = en106 / 100;
     en107 = #104#107;  en107 = en107 / 100;
     en108 = #104#108;  en108 = en108 / 100;
     en109 = #104#109;  en109 = en109 / 100;
     en110 = #104#110;  en110 = en110 / 100;
     en111 = #104#111;  en111 = en111 / 100;
     en112 = #104#112;  en112 = en112 / 100;
     en113 = #104#113;  en113 = en113 / 100;
     en114 = #104#114;  en114 = en114 / 100;
     en115 = #104#115;  en115 = en115 / 100;
     en116 = #104#116;  en116 = en116 / 100;
     en117 = #104#117;  en117 = en117 / 100;
     en118 = #104#118;  en118 = en118 / 100;
     en119 = #104#119;  en119 = en119 / 100;
     en120 = #104#120;  en120 = en120 / 100;
     en121 = #104#121;  en121 = en121 / 100;
     en122 = #104#122;  en122 = en122 / 100;
     en123 = #104#123;  en123 = en123 / 100;
     en124 = #104#124;  en124 = en124 / 100;
     en125 = #104#125;  en125 = en125 / 100;
     en126 = #104#126;  en126 = en126 / 100;
     en128 = #104#128;  en128 = en128 / 100;
     en130 = #104#130;  en130 = en130 / 100;
     en131 = #104#131;  en131 = en131 / 100;
     en132 = #104#132;  en132 = en132 / 100;
     en134 = #104#134;  en134 = en134 / 100;
     en135 = #104#135;  en135 = en135 / 100;
     en137 = #104#137;  en137 = en137 / 100;
     en138 = #104#138;  en138 = en138 / 100;
     en139 = #104#139;  en139 = en139 / 100;
     en141 = #104#141;  en141 = en141 / 100;
     en142 = #104#142;  en142 = en142 / 100;
     en143 = #104#143;  en143 = en143 / 100;
     en145 = #104#145;  en145 = en145 / 100;
     en146 = #104#146;  en146 = en146 / 100;
     en147 = #104#147;  en147 = en147 / 100;
     en149 = #104#149;  en149 = en149 / 100;
     en150 = #104#150;  en150 = en150 / 100;

     aNombreInf = "0320010";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja11;
     #90#2 = "GENERANDO HOJA 11";  |PINTA #90#2;

     |SI #16#20  = 0;  |Y #16#110  = 0;  |Y #16#119 = 0;  |Y #16#131 = 0;
      |Y #16#134 = 0;  |Y #16#149  = 0;  |Y #0#34   = "I";
         |ACABA;
     |FINSI;

     aNombreInf = "0320011";  |HAZ Impresion;
|FPRC;

|DEFBUCLE isw00055;
     #106#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Hoja12A;
     #90#2 = "GENERANDO HOJA 12A";  |PINTA #90#2;

     |ABRE #106;

     |DDEFECTO #106;
     #106#0  = 1;
     #106#5  = "";
     #106#71 = &13 + &10;

     |PARA nCampo = 152;  |SI nCampo [ 181;  |HACIENDO nCampo = nCampo + 1;
           nCampoH = nCampo - 146;
           aConver = "S";
           nCanti  = #16nCampo;
           |HAZ Calcula13D;
           #106nCampoH = aAlfa;
     |SIGUE;

     aConver = "S";  nCanti  = #17#9;  |HAZ Calcula13D;  #106#36 = aAlfa;
     aConver = "S";  nCanti  = #17#19; |HAZ Calcula13D;  #106#37 = aAlfa;
     aConver = "S";  nCanti  = #17#10; |HAZ Calcula13D;  #106#38 = aAlfa;
     aConver = "S";  nCanti  = #17#20; |HAZ Calcula13D;  #106#39 = aAlfa;
     aConver = "S";  nCanti  = #17#11; |HAZ Calcula13D;  #106#40 = aAlfa;
     aConver = "S";  nCanti  = #17#21; |HAZ Calcula13D;  #106#41 = aAlfa;
     aConver = "S";  nCanti  = #17#22; |HAZ Calcula13D;  #106#42 = aAlfa;
     aConver = "S";  nCanti  = #17#12; |HAZ Calcula13D;  #106#43 = aAlfa;
     aConver = "S";  nCanti  = #17#23; |HAZ Calcula13D;  #106#44 = aAlfa;
     aConver = "S";  nCanti  = #17#13; |HAZ Calcula13D;  #106#45 = aAlfa;
     aConver = "S";  nCanti  = #17#24; |HAZ Calcula13D;  #106#46 = aAlfa;
     aConver = "S";  nCanti  = #17#14; |HAZ Calcula13D;  #106#47 = aAlfa;
     aConver = "S";  nCanti  = #17#25; |HAZ Calcula13D;  #106#48 = aAlfa;
     aConver = "S";  nCanti  = #17#15; |HAZ Calcula13D;  #106#49 = aAlfa;
     aConver = "S";  nCanti  = #17#26; |HAZ Calcula13D;  #106#50 = aAlfa;
     aConver = "S";  nCanti  = #17#16; |HAZ Calcula13D;  #106#51 = aAlfa;
     aConver = "S";  nCanti  = #17#17; |HAZ Calcula13D;  #106#52 = aAlfa;
     aConver = "S";  nCanti  = #17#27; |HAZ Calcula13D;  #106#53 = aAlfa;
     aConver = "S";  nCanti  = #17#18; |HAZ Calcula13D;  #106#54 = aAlfa;
     aConver = "S";  nCanti  = #17#28; |HAZ Calcula13D;  #106#55 = aAlfa;

     aAlfa   = ("0000"   + #77#14) % -104;               #106#56 = aAlfa;
     aConver = "S";  nCanti  = #77#15; |HAZ Calcula13D;  #106#57 = aAlfa;
     aConver = "S";  nCanti  = #77#16; |HAZ Calcula13D;  #106#58 = aAlfa;
     aConver = "S";  nCanti  = #77#17; |HAZ Calcula13D;  #106#59 = aAlfa;
     aConver = "S";  nCanti  = #77#18; |HAZ Calcula13D;  #106#60 = aAlfa;

     |GRABA 020#106n;

     nContaBucle = 0;    |BUCLE isocie78;

     |CIERRA #106;

     aNombreInf = "320012a";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00055;
|FPRC;

|DEFBUCLE isw00056;
     #103#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Hoja12B;
     #90#2 = "GENERANDO HOJA 12B";  |PINTA #90#2;

     |ABRE #103;

     |DDEFECTO #103;
     #103#0  = 1;
     #103#5  = "";
     #103#62 = &13 + &10;
     nTotal  = 0;

     |GRABA 020#103n;

     nContaBucle = 0;   |BUCLE maempr12;

     |CIERRA #103;

     aNombreInf = "320012b";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00056;
|FPRC;

|PROCESO Hoja13;
     #90#2 = "GENERANDO HOJA 13";  |PINTA #90#2;

     |DDEFECTO #108;

     #108#3  = "013";
     #108#5  = "";
     #108#77 = "</T200013>";

     aConver = "S";  nCanti  = #14#117; |HAZ Calcula13D;    #108#6  = aAlfa;
     aConver = "S";  nCanti  = #14#118; |HAZ Calcula13D;    #108#7  = aAlfa;
     aConver = "S";  nCanti  = #14#119; |HAZ Calcula13D;    #108#8  = aAlfa;
     aConver = "S";  nCanti  = #14#120; |HAZ Calcula13D;    #108#9  = aAlfa;
     aConver = "S";  nCanti  = #14#121; |HAZ Calcula13D;    #108#10 = aAlfa;
     aConver = "S";  nCanti  = #14#122; |HAZ Calcula13D;    #108#11 = aAlfa;

     aConver = "N";  nCanti  = #14#108;  |HAZ Calcula3E2D;  #108#12 = aAlfa;
     aConver = "N";  nCanti  = #14#109;  |HAZ Calcula3E2D;  #108#13 = aAlfa;
     aConver = "N";  nCanti  = #14#110;  |HAZ Calcula3E2D;  #108#14 = aAlfa;
     aConver = "N";  nCanti  = #14#111;  |HAZ Calcula3E2D;  #108#15 = aAlfa;
     aConver = "N";  nCanti  = #14#107;  |HAZ Calcula3E2D;  #108#16 = aAlfa;

     aConver = "S";

     nTotal  = #14#108 + #14#109 + #14#110 + #14#111;
     nC108   = 16;

     |PARA nCampo = 84;  |SI nCampo [ 106;  |HACIENDO nCampo = nCampo + 2;
           nCanti1 = ((#14nCampo * #14#108) / nTotal) ! 2;
           nCanti2 = ((#14nCampo * #14#109) / nTotal) ! 2;
           nCanti3 = ((#14nCampo * #14#110) / nTotal) ! 2;
           nCanti4 = ((#14nCampo * #14#111) / nTotal) ! 2;
           nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
           nResto  = #14nCampo - nCantiT;

           |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

           nC108 = nC108 + 1; aConver = "S";  nCanti = nCanti1;   |HAZ Calcula13D;  #108nC108 = aAlfa;
           nC108 = nC108 + 1; aConver = "S";  nCanti = nCanti2;   |HAZ Calcula13D;  #108nC108 = aAlfa;
           nC108 = nC108 + 1; aConver = "S";  nCanti = nCanti3;   |HAZ Calcula13D;  #108nC108 = aAlfa;
           nC108 = nC108 + 1; aConver = "S";  nCanti = nCanti4;   |HAZ Calcula13D;  #108nC108 = aAlfa;
           nC108 = nC108 + 1; aConver = "S";  nCanti = #14nCampo; |HAZ Calcula13D;  #108nC108 = aAlfa;

           |SI nCampo = 106;
               nTotal494 =  nCanti1;
               nTotal495 =  nCanti2;
               nTotal496 =  nCanti3;
               nTotal497 =  nCanti4;
           |FINSI;
     |SIGUE;

     aNombreInf = "0320013";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja14;
     #90#2 = "GENERANDO HOJA 14";  |PINTA #90#2;

     aNombreInf = "0320014";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja15A;
     #90#2 = "GENERANDO HOJA 15A";  |PINTA #90#2;

     aNombreInf = "320015a";  |HAZ Impresion;
|FPRC;

|DEFBUCLE isw00057;
     #107#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Impresion;
|FIN;

|PROCESO Hoja15B;
     #90#2 = "GENERANDO HOJA 15B";  |PINTA #90#2;

     |ABRE #107;

     |DDEFECTO #107;
     #107#0 = 1;
     #107#5 = "";

     |ABRE #79;
     #79#0 = #1#0;
     #79#1 = #1#1;
     #79#2 = 0;
     |LEE 040#79=;
     |SI FSalida ! 0;  |DDEFECTO #79;  |FINSI;
     |CIERRA #79;

     aConver = "S";  nCanti  = #79#4; |HAZ Calcula13D;  #107#6 = aAlfa;

     |GRABA 020#107n;

     nContaBucleL = 6;
     nContaBucle  = 0;   |BUCLE isocie79;

     nContaBucleL = 16;
     nContaBucle  = 0;   |BUCLE isocie80;

     |CIERRA #107;

     aNombreInf = "320015b";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00057;
|FPRC;

|PROCESO Hoja200;
     #90#2 = "GENERANDO HOJA DE INGRESO Y DEVOLUCION ";  |PINTA #90#2;

     |DDEFECTO #105;

     #105#7  = (("00" + #3#0) % -102) + (("000" + #3#1) % -103);  || Codigo
     #105#8  = #0#56;
     |SI #2#31 = "01.01.2003";  |Y #2#32 = "31.12.2003";
         #105#9 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #2#31;
         fFechaH = #2#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #105#9 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #105#9 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     #105#10 = "0A";                      || Periodo
     #105#11 = #2#31 % 102;            || Del Dia
     #105#12 = #2#31 % 402;            || Del Mes
     #105#13 = #2#31 % -102;           || Del Anyo
     #105#14 = #2#32 % 102;            || Al Dia
     #105#15 = #2#32 % 402;            || Al Mes
     #105#16 = #2#32 % -102;           || Al A¤o
     #105#17 = #2#3;                   || NIF
     #105#18 = #2#2;                   || Nombre
     #105#19 = #2#4;                   || SG
     #105#20 = #2#5;                   || Domicilio
     #105#21 = #2#6;                   || Numero
     #105#22 = #2#7;                   || Escalera
     #105#23 = #2#8;                   || Piso
     #105#24 = #2#9;                   || Puerta
     #105#25 = #2#15;                  || Telefono
     #105#26 = #2#13;                  || Municipio
     #105#27 = ("000" + #2#11) % -103; || Codigo Municipio
     #105#28 = #2#14;                  || Provincia
     #105#29 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);   || Codigo Postal Entero

     aConver = "S";  nCanti  = #14#41;  |HAZ Calcula13D;  #105#30 = aAlfa;
     aConver = "S";  nCanti  = #14#50;  |HAZ Calcula13D;  #105#31 = aAlfa;
     aConver = "S";  nCanti  = #14#105; |HAZ Calcula13D;  #105#32 = aAlfa;

     |SI #14#108 ! 0;
         nCanti  = nTotal494;
         aConver = "S";  |HAZ Calcula13D;  #105#33 = aAlfa;
     |FINSI;

     |SI #14#109 ! 0;
         nCanti  = nTotal495;
         aConver = "S";  |HAZ Calcula13D;  #105#34 = aAlfa;
     |FINSI;

     |SI #14#110 ! 0;
         nCanti  = nTotal496;
         aConver = "S";  |HAZ Calcula13D;  #105#35 = aAlfa;
     |FINSI;

     |SI #14#111 ! 0;
         nCanti  = nTotal497;
         aConver = "S";  |HAZ Calcula13D;  #105#36 = aAlfa;
     |FINSI;

     |ABRE #1000;
     #1000#0 = #1#0;
     |LEE 040#1000=;
     |SI FSalida ! 0;  |DDEFECTO #1000;  |FINSI;
     |CIERRA #1000;

     nTotal = #14#105;
     |SI nTotal < 0;
         nCanti  = -nTotal;
         aConver = "S";  |HAZ Calcula15D;  #105#39 = aAlfa;
         |SI #2#34 = "S";
             #105#37 = "1";
         |SINO;
             #105#38 = "1";
             aAlfa   = #1000#81;        |QBF aAlfa; #105#40 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#82;        |QBF aAlfa; #105#41 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#83;        |QBF aAlfa; #105#42 = ("00"   + aAlfa) % -102;
             aAlfa   = #1000#84 % 110;  |QBF aAlfa; #105#43 = ("0000000000" + aAlfa) % -110;
         |FINSI;
     |FINSI;

     |SI nTotal > 0;
         nCanti  = nTotal;
         aConver = "S";  |HAZ Calcula15D;  #105#46 = aAlfa;
         |SI #0#57 = "E";
             #105#44 = "1";
         |SINO;
             #105#45 = "1";
             aAlfa   = #1000#81;        |QBF aAlfa; #105#47 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#82;        |QBF aAlfa; #105#48 = ("0000" + aAlfa) % -104;
             aAlfa   = #1000#83;        |QBF aAlfa; #105#49 = ("00"   + aAlfa) % -102;
             aAlfa   = #1000#84 % 110;  |QBF aAlfa; #105#50 = ("0000000000" + aAlfa) % -110;
         |FINSI;
     |FINSI;

     |SI nTotal = 0;
         #105#51 = "1";
     |FINSI;

     #105#52 = #2#13;                            || Poblacion firma
     #105#53 = aDia;                             || Dia
     #105#54 = aMes;                             || Mes
     #105#55 = aEjerc;                           || A¤o
     #105#57 = &13 + &10;

     aNombreInf = "3200200";  |HAZ Impresion;
|FPRC;

|PROCESO HojaBlanco;
     |SI #0#34 ! "C";  |ACABA;  |FINSI;
      aNombreInf = "9620099";  |HAZ Impresion;
|FPRC;

|PROCESO ImprimeLos;
     |PINPA #0#90;

     |SI #0#34 = "I";
         |C_V #90#3, 1, "N";
         |ATRI P;
         |PINTA 1111, "Generando Fichero ASCCI ";
         |ATRI p;
         |PINTA 1162, "          ";
     |FINSI;

     #90#0 = #99#0;  |PINTA #90#0;
     #90#1 = #99#3;  |PINTA #90#1;

     |PARA nPara = 1; |SI nPara [ #99#4; |HACIENDO nPara = nPara + 1;
           |HAZ Defectos;
           |SI #0#34 ! "I";
               #90#3 = nPara;  |PINTA #90#3;
           |FINSI;

           |HAZ LeeFich;

           |SI #0#34 = "I";  |HAZ AbreSecuencial;  |FINSI;

           |SI #0#38 = "S"; |HAZ Hoja1;   |FINSI;
           |SI #0#39 = "S"; |HAZ Hoja2;   |FINSI;
           |SI #0#40 = "S"; |HAZ Hoja3;   |FINSI;
           |SI #0#41 = "S"; |HAZ Hoja4A;  |FINSI;
           |SI #0#42 = "S"; |HAZ Hoja4B;  |FINSI;
           |SI #0#43 = "S"; |HAZ Hoja5A;  |FINSI;
           |SI #0#44 = "S"; |HAZ Hoja5B;  |FINSI;
           |SI #0#45 = "S"; |HAZ Hoja6;   |FINSI;
           |SI #0#46 = "S"; |HAZ Hoja7;   |FINSI;
           |SI #0#47 = "S"; |HAZ Hoja8;   |FINSI;
           |SI #0#48 = "S"; |HAZ Hoja9;   |FINSI;
           |SI #0#49 = "S"; |HAZ Hoja10;  |FINSI;
           |SI #0#50 = "S"; |HAZ Hoja11;  |FINSI;
           |SI #0#51 = "S"; |HAZ Hoja12A; |FINSI;
           |SI #0#52 = "S"; |HAZ Hoja12B; |FINSI;
           |SI #0#53 = "S"; |HAZ Hoja13;  |FINSI;
           |SI #0#54 = "S"; |HAZ Hoja14;  |FINSI;
           |SI #0#59 = "S"; |HAZ Hoja15A; |FINSI;
           |SI #0#60 = "S"; |HAZ Hoja15B; |FINSI;

           |SI aGuiri = "N";
                |SI #0#61 = "S"; |HAZ Hoja200;    |FINSI;
                |SI #0#61 = "S"; |HAZ HojaBlanco; |FINSI;
           |SINO;
                |SI #0#61 = "S"; |HAZ HojaBlanco; |FINSI;
                |SI #0#61 = "S"; |HAZ Hoja200;    |FINSI;
           |FINSI;

           |SI #0#58 = "S"; |HAZ HojaBlanco; |FINSI;   || h9620099  Hoja en Blanco

           |SI #0#34 = "I";
               |HAZ CierraSecuencial;
               nHay = 1;
           |FINSI;

           |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
           |ABRE #102;  |CIERRA #102;  |DELINDEX #102;
           |ABRE #103;  |CIERRA #103;  |DELINDEX #103;
           |ABRE #106;  |CIERRA #106;  |DELINDEX #106;
           |ABRE #107;  |CIERRA #107;  |DELINDEX #107;
     |SIGUE;

     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#56;
     |LEE 101#1=;
     |SI FSalida = 0;
         #1#6 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
|FPRC;

|DEFBUCLE rew00001;
     #99#1;
     5;
     00000, "S";
     99999, "S";
     ;
     NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
     aDia   = #0#33 % 102;
     aMes   = #0#33 % 402;
     aEjerc = #0#33 % -104;

     |SI aMes = "01"; aMes = "Enero     "; |FINSI;
     |SI aMes = "02"; aMes = "Febrero   "; |FINSI;
     |SI aMes = "03"; aMes = "Marzo     "; |FINSI;
     |SI aMes = "04"; aMes = "Abril     "; |FINSI;
     |SI aMes = "05"; aMes = "Mayo      "; |FINSI;
     |SI aMes = "06"; aMes = "Junio     "; |FINSI;
     |SI aMes = "07"; aMes = "Julio     "; |FINSI;
     |SI aMes = "08"; aMes = "Agosto    "; |FINSI;
     |SI aMes = "09"; aMes = "Septiembre"; |FINSI;
     |SI aMes = "10"; aMes = "Octubre   "; |FINSI;
     |SI aMes = "11"; aMes = "Noviembre "; |FINSI;
     |SI aMes = "12"; aMes = "Diciembre "; |FINSI;
     aMes = aMes > aMes;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
     #99#0 = #1#0;
     #99#1 = "";
     #99#2 = "";
     #99#3 = #1#2;
     #99#4 = #0#37;
     #99#5 = "S";
     #99#6 = 1;
     #99#7 = #1#3;
     |GRABA 020#99n;
     |LIBERA #99;

     SwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
     #1#1;
     5, 6;
     #0#56, #0#1, "200", aDImpre;
     #0#56, #0#2, "200", aHImpre;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
     #99#0 = 1;
|FRUT;

|RUTINA superior;
     #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
     aFichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 aFichero;
     |ABRE #99; |CIERRA #99; |DELINDEX #99;

     |ABRE #99;
     SwHay = 0;
     |SI #0#0 = "S";
         |BUCLE isacceso;
     |SINO;
         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               |SI #0nPara ! 0;
                   #0#1 = #0nPara;
                   #0#2 = #0nPara;
                   |BUCLE isacceso;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #99;

     |SI SwHay = 0; |ACABA; |FINSI;

     |SI #0#35 = "N"; |ACABA; |FINSI;

     |ENTLINEAL #1#99, -1, 4, 22, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
     |SI FSalida ! 10; |ACABA; |FINSI;

     |LEE 101#99=;

     |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
     |PINTA #99#5;
     |GRABA 020#99a;
     |LIBERA #99;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#36 = "N";
         aDImpre = "N";
         aHImpre = "N";
     |SINO;
         aDImpre = "N";
         aHImpre = "S";
     |FINSI;

     aFichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #101 aFichero;
     |ABRE #101; |CIERRA #101; |DELINDEX #101;

     aFichero = ("04" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #102 aFichero;
     |ABRE #102; |CIERRA #102; |DELINDEX #102;

     aFichero = ("05" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #103 aFichero;
     |ABRE #103; |CIERRA #103; |DELINDEX #103;

     aFichero = ("06" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #106 aFichero;
     |ABRE #106; |CIERRA #106; |DELINDEX #106;

     aFichero = ("07" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #107 aFichero;
     |ABRE #107; |CIERRA #107; |DELINDEX #107;

     |HAZ TipoImpre;

     |SI #0#34 = "C";
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     |HAZ CargaTempo;

     |SI SwHay = 0;
         |SI #0#34 = "C";   |FINIMP;  |FINSI;
         |ABRE #99;  |CIERRA #99;  |DELINDEX #99;
         |ABRE #101; |CIERRA #101; |DELINDEX #101;
         |ABRE #102; |CIERRA #102; |DELINDEX #102;
         |ABRE #103; |CIERRA #103; |DELINDEX #103;
         |ABRE #106; |CIERRA #106; |DELINDEX #106;
         |ABRE #107; |CIERRA #107; |DELINDEX #107;
         |ACABA;
     |FINSI;

     |BUCLE rew00001;

     |SI #0#34 = "C";
         |FINIMP;
     |FINSI;

     |ABRE #99;  |CIERRA #99;   |DELINDEX #99;
     |ABRE #101; |CIERRA #101; |DELINDEX #101;
     |ABRE #102; |CIERRA #102; |DELINDEX #102;
     |ABRE #103; |CIERRA #103; |DELINDEX #103;
     |ABRE #106; |CIERRA #106; |DELINDEX #106;
     |ABRE #107; |CIERRA #107; |DELINDEX #107;
|FPRC;

|PROGRAMA;
     nHay = 0;
     |SI empresa ! 0;
         #0#0 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#1  = empresa;  |PINTA #0#1;
         #0#2  = empresa;  |PINTA #0#2;
         #0#56 = anyo;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;

     |SI nHay = 1;  |Y #0#34 = "I";
         aAlfa = "0000 Los ficheros generados estan en C:\AEAT\INTERNET\200\" + #0#56;
         |MENAV aAlfa;
     |FINSI;
|FPRO;
