|FICHEROS;
     maempr22,MANTE;
     maempz22;

     :/agicli/def/agim0003;
     :/agicli/def/agim0016;
|FIN;

|VARIABLES;
     aAlfa      = "";
     aAlfa1     = "";
     nModo      = 0;
     nCampo     = 0;
     nNume1     = 0;
     fHoy       = @;

     &aPath     = "";
     &enCalcCif = 0;
     &eaVarDni  = "";
     &eaCodPais = "";
     &eaCodNif  = "";
     &eswNif    = 0;
|FIN;

|PROCESO Tipo2; |TIPO 2;
    #maempz22#0 = #maempz22#0 +. (#maempr22#11 + #maempr22#12);
    |PINTA 2374, #maempz22#0;
|FPRC;

|PROCESO Tipo0C11; |TIPO 0;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #maempr22#11 ! 0;
||        #maempr22#12 = 0; |PINTA #maempr22#12;
        #maempr22#4  = "F";
    |FINSI;

    nNume1 = #maempz22#0 + (#maempr22#11 + #maempr22#12);
    |SI nNume1 > 100; |Y #maempr22#11 ! 0;
        |MENAV "0000Suma de Porcentaje mayor del 100%. Modificar";
        |ERROR;
    |FINSI;
|FPRC;

|PROCESO Tipo0C12; |TIPO 0;
    |SI FSalida = 2; |ACABA; |FINSI;

    |SI #maempr22#12 ! 0;
||        #maempr22#11 = 0; |PINTA #maempr22#11;
        #maempr22#4  = "J";
    |FINSI;

    nNume1 = #maempz22#0 + (#maempr22#11 + #maempr22#12);
    |SI nNume1 > 100; |Y #maempr22#12 ! 0;
        |MENAV "0000Suma de Porcentaje mayor del 100%. Modificar";
        |ERROR;
    |SINO;
        |SI #maempr22#11 = 0; |Y #maempr22#12 = 0;
            |MENAV "0000Error Porcentajes igual a 0";
            |ERROR;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempr22#Campo#;
         |HAZ CalculoDNI;
         #maempr22#Campo# = eaVarDni;
         |PINTA #maempr22#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #maempr22#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempr22#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempr22#Campo# = eaVarDni;  |PINTA #maempr22#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeePaism22; |TIPO 6;
     |PATH_DAT #agim0016#aPath#;
     |ABRE #agim0016;
     #agim0016#0 = #maempr22#Campo#;
     |LEE 041#agim0016.=;
     |SI FSalida = 0;
         nCampo = Campo + 1;
         #maempr22#nCampo# = #agim0016#1; |PINTA #maempr22#nCampo#;
     |FINSI;
     |CIERRA #agim0016;
|FPRC;

|PROCESO PonDatos;
     aAlfa1 = Contenido;
     nModo  = (FEntrada / 100) ! 0;
     aAlfa  = #maempr22#5; |QBF aAlfa;

     |SI nModo = 1; |O aAlfa = ""; |O aAlfa1 ! #maempr22#3;

         |PATH_DAT #agim0003#aPath#;
         |ABRE #agim0003;
         #agim0003#0  = #maempr22#3;
         |LEE 040#agim0003.=;
         |SI FSalida = 0;
             #maempr22#5 = #agim0003#1; |PINTA #maempr22#5;
         |FINSI;
         |CIERRA #agim0003;
     |FINSI;
|FPRC;

|PROCESO Tipo0FecNac; |TIPO 0;
     fHoy = ~;
     |SI #maempr22#10 > fHoy;    || nacimientos futuros como que no
          |HAZ PonSiglo20;       ||/se cambia sin preguntar
     |FINSI;

     |SI #maempr22#10 ] "01.01.2001"; |Y #maempr22#10 [ fHoy;  || presuntos ni¤os,
                                                                       ||/se pregunta
         aAlfa = "0000SLa fecha puede ser incorrecta. Ha introducido una persona  menor de edad. Corregir siglo?";
         |CONFI aAlfa;
         |SI FSalida = 0;
              |HAZ PonSiglo20;
         |FINSI;
     |FINSI;

|FPRC;

|PROCESO PonSiglo20;
     aAlfa1    = (#maempr22#10 % 106) + "19" + (#maempr22#10 % -102);
     #maempr22#10 = aAlfa1;
     |PINTA #maempr22#10;
|FPRC;
