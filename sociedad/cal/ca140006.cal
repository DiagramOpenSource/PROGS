|FICHEROS;
     isom0505;
|FIN;

|INCLUYE calc9999;
|INCLUYE varbal_i;

|PROCESO isom0006;
     |SI #isom0006#4 = "417  ";  |ACABA;  |FINSI;

     enValor1 = enValor1 + #isom0006#5;
     enValor2 = enValor2 + #isom0006#7;
|FPRC;

|DEFBUCLE isom0006;
     #isom0006#1;
     ;
     enEmpresa, enAnyo, 0001;
     enEmpresa, enAnyo, 9999;
     ;
     NULL, isom0006;
|FIN;

|PROCESO TotalFich106;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     enValor1 = 0;
     enValor2 = 0;
     |BUCLE isom0006;

     |SELECT #2#isom0006;
     #isom0006#0  = enEmpresa;
     #isom0006#1  = enAnyo;
     #isom0006#4  = "417";
     |LEE 101#isom0006.=;
     |SI FSalida = 0;
         #isom0006#5 = enValor1;
         #isom0006#7 = enValor2;
         |GRABA 020#isom0006.a;
     |FINSI;
     |LIBERA #isom0006;

     |SELECT #1#isom0006;
|FPRC;

|PROCESO TraeDatos;
     |ABRE #isom0003;  |SELECT #2#isom0003;

     eaCasilla = "305"; |HAZ LeeCas103; enValor = #isom0003#5;
     |SI enValor < 0;  enValor = -enValor;  |FINSI;
     eaCasilla = "305"; |HAZ GrabaCas122;

     eaCasilla = "297"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1247"; |HAZ GrabaCas122;

     eaCasilla = "296"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1250"; |HAZ GrabaCas122;

     eaCasilla = "284"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1251"; |HAZ GrabaCas122;

     eaCasilla = "285"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1252"; |HAZ GrabaCas122;

     eaCasilla = "287"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1253"; |HAZ GrabaCas122;

     eaCasilla = "298"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "1254"; |HAZ GrabaCas122;

     |CIERRA #isom0003;
|FPRC;

|PROCESO isom0022Val;
     nNume1 = #isom0022#5;
     |SI #isom0022#5  ! 0;  |ERROR10;  |ACABA;  |FINSI;
|FPRC;

|DEFBUCLE isom0022Val;
     #isom0022#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0022Val;
|FIN;

|PROCESO Fich122;
     |SI nHija = 1;
         enValor   = 0;
         eaCasilla = "175"; |HAZ GrabaCas122;
         eaCasilla = "176"; |HAZ GrabaCas122;
         eaCasilla = "177"; |HAZ GrabaCas122;
         eaCasilla = "178"; |HAZ GrabaCas122;
         eaCasilla = "179"; |HAZ GrabaCas122;
         eaCasilla = "043"; |HAZ GrabaCas122;
         eaCasilla = "049"; |HAZ GrabaCas122;
         eaCasilla = "249"; |HAZ GrabaCas122;
         eaCasilla = "252"; |HAZ GrabaCas122;
         eaCasilla = "253"; |HAZ GrabaCas122;
         eaCasilla = "254"; |HAZ GrabaCas122;
         eaCasilla = "255"; |HAZ GrabaCas122;
         eaCasilla = "258"; |HAZ GrabaCas122;
         eaCasilla = "259"; |HAZ GrabaCas122;
         eaCasilla = "260"; |HAZ GrabaCas122;

         |ACABA;
     |FINSI;

     eaCasilla = "175"; |HAZ LeeCas122_1;
     |SI #isom0022#5 = 0;
         eaCasilla = "298"; |HAZ LeeCas103; enValor = #isom0003#5;
         eaCasilla = "179"; |HAZ GrabaCas122;

         eaCasilla = "297"; |HAZ LeeCas103; enValor = #isom0003#5;
         eaCasilla = "252"; |HAZ GrabaCas122;

         eaCasilla = "305"; |HAZ LeeCas103; enValor = #isom0003#5;
         |SI enValor < 0;  enValor = -enValor;  |FINSI;
         eaCasilla = "249"; |HAZ GrabaCas122;
     |FINSI;

     eaCasilla = "305"; |HAZ LeeCas103; enValor = #isom0003#5;
     |SI enValor < 0;  enValor = -enValor;  |FINSI;
     eaCasilla = "249"; |HAZ LeeCas122_1;
     |SI #isom0022#5 > enValor;  eaCasilla = "249"; |HAZ GrabaCas122; |FINSI;

     eaCasilla = "298"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "179"; |HAZ LeeCas122_1;
     |SI #isom0022#5 > enValor;  eaCasilla = "179"; |HAZ GrabaCas122; |FINSI;

     eaCasilla = "297"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "252"; |HAZ LeeCas122_1;
     |SI #isom0022#5 > enValor;  eaCasilla = "252"; |HAZ GrabaCas122; |FINSI;

     eaCasilla = "296"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "175"; |HAZ GrabaCas122;

     eaCasilla = "284"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "176"; |HAZ GrabaCas122;

     eaCasilla = "285"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "177"; |HAZ GrabaCas122;

     eaCasilla = "287"; |HAZ LeeCas103; enValor = #isom0003#5;
     eaCasilla = "178"; |HAZ GrabaCas122;

     eaCasilla = "175"; |HAZ LeeCas122_1;  enValor = #isom0022#5;
     eaCasilla = "176"; |HAZ LeeCas122_1;  enValor = enValor - #isom0022#5;
     eaCasilla = "177"; |HAZ LeeCas122_1;  enValor = enValor - #isom0022#5;
     eaCasilla = "178"; |HAZ LeeCas122_1;  enValor = enValor - #isom0022#5;
     eaCasilla = "179"; |HAZ LeeCas122_1;  enValor = enValor + #isom0022#5;
     enValor   = enValor % 30;
     nVar2     = enValor;
     eaCasilla = "043"; |HAZ GrabaCas122;  nNume1 = enValor;

     eaCasilla = "249"; |HAZ LeeCas122_1;  enValor = #isom0022#5;
     eaCasilla = "252"; |HAZ LeeCas122_1;  enValor = enValor - #isom0022#5;
     |SI enValor < 0;  enValor = 0;  |FINSI;
     eaCasilla = "253"; |HAZ GrabaCas122;  nNume2 = enValor;

     |SI nNume1 < nNume2;
         |SI enValor > 1000000;  enValor = 1000000;  |FINSI;

         eaCasilla = "043"; |HAZ GrabaCas122;  nNume1 = enValor;
     |FINSI;

     enValor = nNume1;
     |SI enValor > nNume2;  enValor = nNume2;  |FINSI;
     eaCasilla = "254"; |HAZ GrabaCas122;  nNume3 = enValor;

     enValor = nNume2 - nNume3;
     |SI enValor < 0;  enValor = 0;  |FINSI;
     eaCasilla = "255"; |HAZ GrabaCas122;  nNume3 = enValor;

     eaCasilla = "254"; |HAZ LeeCas122_1;  nNume1 = #isom0022#5;
     eaCasilla = "258"; |HAZ LeeCas122_1;  nNume1 = nNume1 + #isom0022#5;

     |SI enAnyo ] 2014;
         eaCasilla = "955"; |HAZ LeeCas123;  enValor   = #isom0023#5;
         eaCasilla = "043"; |HAZ GrabaCas122;

                                               nVar1 = enValor;
         eaCasilla = "049"; |HAZ LeeCas122_1;  nVar1 = nVar1 + #isom0022#5;

         nVar3 = 1000000;
         |SI nVar2 > nVar3;  nVar3 = nVar2;  |FINSI;

         |SI nVar1 < nVar3;
             eaCasilla = "043"; enValor = nVar1;  |HAZ GrabaCas122;
             eaCasilla = "049"; enValor = 0;      |HAZ GrabaCas122;
         |SINO;
             eaCasilla = "043"; enValor = nVar3;          |HAZ GrabaCas122;
             eaCasilla = "049"; enValor = nVar1 - nVar3;  |HAZ GrabaCas122;
             nCas049 = nVar1 - nVar3;
         |FINSI;
     |FINSI;

     eaCasilla = "043"; |HAZ LeeCas122_1;  nNume2 = #isom0022#5;
     eaCasilla = "049"; |HAZ LeeCas122_1;  nNume2 = nNume2 + #isom0022#5;
|FPRC;

|PROCESO TotalFich122;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     nHija = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 9;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 10;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 24;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 25;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;
     |CIERRA #maempr11;

     |HAZ Fich122;

     |SELECT #1#isom0022;
|FPRC;

|PROCESO isom0023;
     enValor1 = enValor1 + #isom0023#5;
     enValor2 = enValor2 + #isom0023#7;
     enValor3 = enValor3 + #isom0023#9;
|FPRC;

|DEFBUCLE isom0023;
     #isom0023#1;
     ;
     enEmpresa, enAnyo, nDLinea;
     enEmpresa, enAnyo, nHLinea;
     ;
     NULL, isom0023;
|FIN;

|PROCESO isom0029;
     enValor1 = enValor1 + #isom0029#5;
     enValor2 = enValor2 + #isom0029#7;
     enValor3 = enValor3 + #isom0029#9;
     enValor4 = enValor4 + #isom0029#11;
     enValor5 = enValor5 + #isom0029#13;
     enValor6 = enValor6 + #isom0029#15;
|FPRC;

|DEFBUCLE isom0029;
     #isom0029#1;
     ;
     enEmpresa, enAnyo, nDLinea;
     enEmpresa, enAnyo, nHLinea;
     ;
     NULL, isom0029;
|FIN;

|PROCESO isom0023B;
     |BORRA 020#isom0023.a;
     |LIBERA #isom0023;
|FPRC;

|DEFBUCLE isom0023B;
     #isom0023#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0023B;
|FIN;

|PROCESO isom0029B;
     |BORRA 020#isom0029.a;
     |LIBERA #isom0029;
|FPRC;

|DEFBUCLE isom0029B;
     #isom0029#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0029B;
|FIN;

|PROCESO isom0511;
     #isom0023#0  = enEmpresa;
     #isom0023#1  = #isom0511#0;
     #isom0023#2  = #isom0511#1;
     |LEE 101#isom0023.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0023;
         #isom0023#0  = enEmpresa;
         #isom0023#1  = #isom0511#0;
         #isom0023#2  = #isom0511#1;
         |GRABA 020#isom0023.b;
     |FINSI;

     #isom0023#3  = #isom0511#5;
     #isom0023#4  = #isom0511#2;
     #isom0023#6  = #isom0511#3;
     #isom0023#8  = #isom0511#4;

     eaTipoColor = #isom0511#7;
     |HAZ CogeColor;
     #isom0023#10  = eaColor;

     |GRABA 020#isom0023.a;
     |LIBERA #isom0023;
|FPRC;

|DEFBUCLE isom0511;
     #isom0511#1;
     ;
     enAnyo, 0000;
     enAnyo, 0999;
     ;
     NULL, isom0511;
|FIN;

|PROCESO isom0515_29;
     #isom0029#0  = enEmpresa;
     #isom0029#1  = #isom0515#0;
     #isom0029#2  = #isom0515#1;
     |LEE 101#isom0029.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0029;
         #isom0029#0  = enEmpresa;
         #isom0029#1  = #isom0515#0;
         #isom0029#2  = #isom0515#1;
         |GRABA 020#isom0029.b;
     |FINSI;

     #isom0029#3  = #isom0515#8;
     #isom0029#4  = #isom0515#2;
     #isom0029#6  = #isom0515#3;
     #isom0029#8  = #isom0515#4;
     #isom0029#10 = #isom0515#5;
     #isom0029#12 = #isom0515#6;
     #isom0029#14 = #isom0515#7;

     eaTipoColor = #isom0515#10;
     |HAZ CogeColor;
     #isom0029#16  = eaColor;

     |GRABA 020#isom0029.a;
     |LIBERA #isom0029;
|FPRC;

|DEFBUCLE isom0515_29;
     #isom0515#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0515_29;
|FIN;

|PROCESO AplicaLim;
     #isom0029#0  = enEmpresa;
     #isom0029#1  = enAnyo;
     #isom0029#14 = eaCasilla;
     |LEE 101#isom0029.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #isom0029#5 ! 0;
         |SI nLimite1 > #isom0029#5;
             nLimite1     = nLimite1 - #isom0029#5;
             #isom0029#9  = #isom0029#5;
         |SINO;
             #isom0029#9  = nLimite1;
             nLimite1     = 0;
         |FINSI;
     |FINSI;

     |SI #isom0029#7 ! 0;
         |SI nLimite2 > #isom0029#7;
             nLimite2     = nLimite2 - #isom0029#7;
             #isom0029#11 = #isom0029#7;
         |SINO;
             #isom0029#11 = nLimite2;
             nLimite2     = 0;
         |FINSI;
     |FINSI;

     #isom0029#13 = #isom0029#5 - #isom0029#9;
     #isom0029#15 = #isom0029#7 - #isom0029#11;

     |GRABA 020#isom0029.a;
     |LIBERA #isom0029;
|FPRC;

|PROCESO GrabaLimita;
     eaCasilla = "253"; |HAZ LeeCas122_1;
     enValor1 = #isom0022#5;

     eaCasilla = "254"; |HAZ LeeCas122_1;
     enValor2  = #isom0022#5;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "266";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor1 - enValor2;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "263";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#9  = #isom0023#5 - #isom0023#7;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;
|FPRC;

|PROCESO GrabaPdte;
     eaCasilla = "175"; |HAZ LeeCas122_1;  nVar1 = #isom0022#5;
     eaCasilla = "176"; |HAZ LeeCas122_1;  nVar1 = nVar1 - #isom0022#5;
     eaCasilla = "177"; |HAZ LeeCas122_1;  nVar1 = nVar1 - #isom0022#5;
     eaCasilla = "178"; |HAZ LeeCas122_1;  nVar1 = nVar1 - #isom0022#5;
     eaCasilla = "179"; |HAZ LeeCas122_1;  nVar1 = nVar1 + #isom0022#5;
     nVar1   = nVar1 % 30;
     |SI nVar1 < 0;        nVar1 = 0;        |FINSI;
     |SI nVar1 > 1000000;  nVar1 = 1000000;  |FINSI;

     eaCasilla = "253"; |HAZ LeeCas122_1;  nVar2 = #isom0022#5;
     eaCasilla = "258"; |HAZ LeeCas122_1;  nVar2 = nVar2 + #isom0022#5;
     |SI nVar2 < 0;  nVar2 = 0;  |FINSI;

     eaCasilla = "890"; |HAZ LeeCas123;
     nVar5 = #isom0023#5;  nVar6 = #isom0023#7;

     eaCasilla = "503"; |HAZ LeeCas123;
     nVar5 = nVar5 + #isom0023#5;  nVar6 = nVar6 + #isom0023#7;

     eaCasilla = "273"; |HAZ LeeCas123;
     nVar5 = (nVar5 + #isom0023#5) ! 2;
     nVar6 = (nVar6 + #isom0023#7) ! 2;

     |SI nVar1 ] nVar2;
         |SELECT #2#isom0023;
         #isom0023#0 = enEmpresa;
         #isom0023#1 = enAnyo;
         #isom0023#8 = "957";
         |LEE 101#isom0023.=;
         |SI FSalida = 0;
             #isom0023#5  = nVar1;
             #isom0023#7  = nVar2;
             #isom0023#9  = nVar1 - nVar2;
             |GRABA 020#isom0023.a;
             |LIBERA #isom0023;
         |FINSI;
     |FINSI;

     |SI nVar1 < nVar2;  |Y nVar2 > 0;
         |SI nVar5 = 0;
             |SELECT #2#isom0023;
             #isom0023#0 = enEmpresa;
             #isom0023#1 = enAnyo;
             #isom0023#8 = "957";
             |LEE 101#isom0023.=;
             |SI FSalida = 0;
                 |SI nVar2 > 1000000;  nVar2 = 1000000;  |FINSI;
                 #isom0023#5  = nVar2;
                 #isom0023#7  = nVar2;
                 #isom0023#9  = 0;
                 |GRABA 020#isom0023.a;
                 |LIBERA #isom0023;
             |FINSI;
         |FINSI;

         |SI nVar5 ! 0;
             nVar7 = nVar5 + nVar1;
             |SI nVar7 < nVar2;
                 |SELECT #2#isom0023;
                 #isom0023#0 = enEmpresa;
                 #isom0023#1 = enAnyo;
                 #isom0023#8 = "957";
                 |LEE 101#isom0023.=;
                 |SI FSalida = 0;
                     nNume = nVar1 + (nVar2 - nVar5 - nVar1);
                     |SI nNume > 1000000;  nNume = 1000000;  |FINSI;
                     #isom0023#5  = nNume;
                     #isom0023#7  = nNume;
                     #isom0023#9  = 0;
                     |GRABA 020#isom0023.a;
                     |LIBERA #isom0023;
                 |FINSI;
             |FINSI;

             |SI nVar7 ] nVar2;
                 |SELECT #2#isom0023;
                 #isom0023#0 = enEmpresa;
                 #isom0023#1 = enAnyo;
                 #isom0023#8 = "957";
                 |LEE 101#isom0023.=;
                 |SI FSalida = 0;
                     #isom0023#5  = nVar1;
                     #isom0023#7  = nVar1;
                     #isom0023#9  = 0;
                     |GRABA 020#isom0023.a;
                     |LIBERA #isom0023;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     eaCasilla = "890"; |HAZ LeeCas123; nVar1 = #isom0023#5;  nVar2 = #isom0023#7;
     eaCasilla = "503"; |HAZ LeeCas123; nVar3 = #isom0023#5;  nVar4 = #isom0023#7;
     eaCasilla = "273"; |HAZ LeeCas123; nVar5 = #isom0023#5;  nVar6 = #isom0023#7;
     eaCasilla = "955"; |HAZ LeeCas123; nVar7 = #isom0023#5;  nVar8 = #isom0023#7;

     eaCasilla = "253"; |HAZ LeeCas122_1;  nTot1 = #isom0022#5;
     eaCasilla = "258"; |HAZ LeeCas122_1;  nTot1 = nTot1 + #isom0022#5;

     nTot2 = nVar2 + nVar4 + nVar6 + nVar8;
     |SI nTot1 [ nTot2;
         |SI nVar8 ] nTot1;
             nVar8 = nTot1;
             nVar6 = 0;
             nVar4 = 0;
             nVar2 = 0;
             nTot1 = 0;
         |SINO;
             nTot1 = nTot1 - nVar8;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;

         |SI nVar2 ] nTot1;
             nVar2 = nTot1;
             nVar6 = 0;
             nVar4 = 0;
             nTot1 = 0;
         |SINO;
             nTot1 = nTot1 - nVar2;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;

         |SI nVar4 ] nTot1;
             nVar4 = nTot1;
             nVar6 = 0;
             nTot1 = 0;
         |SINO;
             nTot1 = nTot1 - nVar4;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;

         |SI nVar6 ] nTot1;
             nVar6 = nTot1;
             nTot1 = 0;
         |SINO;
             nTot1 = nTot1 - nVar6;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     nTot2 = nVar2 + nVar4 + nVar6 + nVar8;
     |SI nTot1 ] nTot2;
         nTot1 = nTot1 - nVar8;
         |SI nTot1 < 0;  nTot1 = 0;  |FINSI;

         |SI nVar2 ] nTot1;
             nVar2 = nTot1;
             nVar6 = 0;
             nVar4 = 0;
             nTot1 = 0;
         |SINO;
             nVar2 = nVar1;
             nTot1 = nTot1 - nVar2;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;

         |SI nVar4 ] nTot1;
             nVar4 = nTot1;
             nVar6 = 0;
             nTot1 = 0;
         |SINO;
             nVar4 = nVar3;
             nTot1 = nTot1 - nVar4;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;

         |SI nVar6 ] nTot1;
             nVar6 = nTot1;
             nTot1 = 0;
         |SINO;
             nVar6 = nVar5;
             nTot1 = nTot1 - nVar6;
             |SI nTot1 < 0;  nTot1 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "892";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#7  = nVar2;
         #isom0023#9  = #isom0023#5 - #isom0023#7;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "523";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#7  = nVar4;
         #isom0023#9  = #isom0023#5 - #isom0023#7;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "537";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#7  = nVar6;
         #isom0023#9  = #isom0023#5 - #isom0023#7;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "957";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#7  = nVar8;
         #isom0023#9  = #isom0023#5 - #isom0023#7;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;
|FPRC;

|PROCESO Del2013;
     enValor = nNume1;
     |SI enValor > nNume2;  enValor = nNume2;  |FINSI;
     eaCasilla = "259"; |HAZ GrabaCas122;  nNume1 = enValor;

     eaCasilla = "249"; |HAZ LeeCas122_1; enValor = #isom0022#5;
     eaCasilla = "255"; |HAZ LeeCas122_1; enValor = enValor - #isom0022#5;
     |SI enValor < nNume1;  enValor = nNume1;  |FINSI;
     eaCasilla = "260"; |HAZ GrabaCas122;

     eaCasilla = "253"; |HAZ LeeCas122_1;
     enValor1 = #isom0022#5;

     eaCasilla = "254"; |HAZ LeeCas122_1;
     enValor2  = #isom0022#5;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "266";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor1 - enValor2;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     eaCasilla = "043"; |HAZ LeeCas122_1;  enValor1 = #isom0022#5;
     |SI enValor1 < 0;  enValor1 = 0;  |FINSI;

     eaCasilla = "254"; |HAZ LeeCas122_1;  enValor2 = #isom0022#5;
     |SI enValor2 < 0;  enValor2 = 0;  |FINSI;

     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "537";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor1 - enValor2;
         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     eaCasilla = "043"; |HAZ LeeCas122_1;  enValor1 = #isom0022#5;
     eaCasilla = "049"; |HAZ LeeCas122_1;  enValor1 = enValor1 + #isom0022#5;
     eaCasilla = "254"; |HAZ LeeCas122_1;  enValor1 = enValor1 - #isom0022#5;
     |SI enValor1 < 0;  enValor1 = 0;  |FINSI;
     nLimite1 = enValor1;

     eaCasilla = "254"; |HAZ LeeCas122_1;  enValor1 = #isom0022#5;
     eaCasilla = "043"; |HAZ LeeCas122_1;  enValor1 = enValor1 - #isom0022#5;
     |SI enValor1 < 0;  enValor1 = 0;  |FINSI;
     nLimite2 = enValor1;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "263";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#9  = #isom0023#5 - #isom0023#7;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "272";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#9  = #isom0023#5 - #isom0023#7;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     |SI enAnyo = 2012;  nDLinea  = 10;  nHLinea  = 15;  |FINSI;
     |SI enAnyo = 2013;  nDLinea  = 10;  nHLinea  = 20;  |FINSI;

     enValor1 = 0;
     enValor2 = 0;
     enValor3 = 0;
     |BUCLE isom0023;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "269";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor3;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     |SI enAnyo = 2012;  nDLinea  = 35;  nHLinea  = 40;  |FINSI;
     |SI enAnyo = 2013;  nDLinea  = 40;  nHLinea  = 50;  |FINSI;

     enValor1 = 0;
     enValor2 = 0;
     enValor3 = 0;
     |BUCLE isom0023;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "546";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor3;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     eaCasilla = "538"; |HAZ LeeCas123;    nCas049  = #isom0023#7;
     eaCasilla = "273"; |HAZ LeeCas123;    nCas049  = (nCas049 - #isom0023#7) ! 2;

     eaCasilla = "267"; |HAZ LeeCas123;    nCas258  = #isom0023#7;
     eaCasilla = "264"; |HAZ LeeCas123;    nCas258  = (nCas258 - #isom0023#7) ! 2;

     eaCasilla = "255"; |HAZ LeeCas122_1;  enValor1 = #isom0022#5;
     eaCasilla = "258"; |HAZ LeeCas122_1;  enValor2 = #isom0022#5;

     |SELECT #2#isom0006;
     #isom0006#0  = enEmpresa;
     #isom0006#1  = enAnyo;
     #isom0006#4  = "363";
     |LEE 101#isom0006.=;
     |SI FSalida = 0;
         #isom0006#5 = enValor1;
         #isom0006#7 = enValor2;
         |GRABA 020#isom0006.a;
     |FINSI;
     |LIBERA #isom0006;
     |SELECT #1#isom0006;
|FPRC;

|PROCESO Del2014;
     enValor = nNume1;
     |SI enValor > nNume2;  enValor = nNume2;  |FINSI;
     eaCasilla = "259"; |HAZ GrabaCas122;  nNume1 = enValor;

     eaCasilla = "249"; |HAZ LeeCas122_1; enValor = #isom0022#5;
     eaCasilla = "255"; |HAZ LeeCas122_1; enValor = enValor - #isom0022#5;
     |SI enValor < nNume1;  enValor = nNume1;  |FINSI;
     eaCasilla = "260"; |HAZ GrabaCas122;

     |HAZ GrabaLimita;
     |HAZ GrabaPdte;

     nDLinea  = 10;  nHLinea  = 25;

     enValor1 = 0;
     enValor2 = 0;
     enValor3 = 0;
     |BUCLE isom0023;

     |SELECT #2#isom0023
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "269";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor3;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     nDLinea  = 45;  nHLinea  = 60;

     enValor1 = 0;
     enValor2 = 0;
     enValor3 = 0;
     |BUCLE isom0023;

     |SELECT #2#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#8 = "546";
     |LEE 101#isom0023.=;
     |SI FSalida = 0;
         #isom0023#5  = enValor1;
         #isom0023#7  = enValor2;
         #isom0023#9  = enValor3;

         |GRABA 020#isom0023.a;
         |LIBERA #isom0023;
     |FINSI;

     eaCasilla = "538"; |HAZ LeeCas123;    nCas049  = #isom0023#7;
     eaCasilla = "955"; |HAZ LeeCas123;    nCas049  = (nCas049 - #isom0023#7) ! 2;

     eaCasilla = "267"; |HAZ LeeCas123;    nCas258  = #isom0023#7;
     eaCasilla = "264"; |HAZ LeeCas123;    nCas258  = (nCas258 - #isom0023#7) ! 2;

     eaCasilla = "255"; |HAZ LeeCas122_1;  enValor1 = #isom0022#5;
     eaCasilla = "258"; |HAZ LeeCas122_1;  enValor2 = #isom0022#5;

     |SELECT #2#isom0006;
     #isom0006#0  = enEmpresa;
     #isom0006#1  = enAnyo;
     #isom0006#4  = "363";
     |LEE 101#isom0006.=;
     |SI FSalida = 0;
         #isom0006#5 = enValor1;
         #isom0006#7 = enValor2;
         |GRABA 020#isom0006.a;
     |FINSI;
     |LIBERA #isom0006;
     |SELECT #1#isom0006;
|FPRC;

|PROCESO TotalFich123;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     nHija = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 9;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 10;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 24;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 25;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         nHija = 1;
     |FINSI;

     |CIERRA #maempr11;

     |SI nHija = 1;
         |BUCLE isom0023B;
         |BUCLE isom0029B;
         |ACABA;
     |FINSI;

     |SELECT #1#isom0023;
     |BUCLE isom0511;

     |SI enAnyo [ 2013;   |HAZ Del2013;  |FINSI;
     |SI enAnyo = 2014;   |HAZ Del2014;  |FINSI;

     |HAZ TotalFich106;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;
|FPRC;

|PROCESO Total18Bis;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     |SI enAnyo [ 2011;  |ACABA;  |FINSI;

     |ABRE #isom0003;  |SELECT #2#isom0003;
     |ABRE #isom0006;

     |HAZ TotalFich122;
     |HAZ TotalFich123;

     enValor   = nCas258;
     eaCasilla = "258"; |HAZ GrabaCas122;

     enValor   = nCas049;
     eaCasilla = "049"; |HAZ GrabaCas122;

     |HAZ TotalFich122;
     |HAZ TotalFich123;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;

     |CIERRA #isom0003;
     |CIERRA #isom0006;
|FPRC;

|PROCESO Total20;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     |ABRE #isom0003;  |SELECT #2#isom0003;
     |ABRE #isom0006;

     |HAZ TotalFich122;
     |HAZ TotalFich123;
     |HAZ TotalFich122;

     |SELECT #1#isom0022;
     |SELECT #1#isom0023;
     |SELECT #1#isom0029;

     |CIERRA #isom0003;
     |CIERRA #isom0006;
|FPRC;


|PROGRAMA;
     |SI PARAMETRO = "TotalFich122";
         |HAZ TotalFich122;
     |FINSI;

     |SI PARAMETRO = "TotalFich123";
         |HAZ TotalFich123;
     |FINSI;

     |SI PARAMETRO = "TraeDatos";
         |HAZ TraeDatos;
     |FINSI;

     |SI PARAMETRO = "Total18Bis";
         |HAZ Total18Bis;
     |FINSI;

     |SI PARAMETRO = "Total20";
         |HAZ Total20;
     |FINSI;

     |SI PARAMETRO = "TotalFich106";
         |HAZ TotalFich106;
     |FINSI;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |ABRET #isom0006;
     |ABRET #isom0022;
     |ABRET #isom0023;
     |ABRET #isom0505;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #isom0006;
     |CIERRAT #isom0022;
     |CIERRAT #isom0023;
     |CIERRAT #isom0505;
|FPRC;
