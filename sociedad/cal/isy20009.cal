|FICHEROS;
   isocie10 #1;      || Creacion Empreo A¤o Actual
   isocie04 #2;      || Exencion por Reinversion
   isocie06 #4;      || Deducciones A¤o Actual
   isocie38 #6;      || Deducciones Juegos Olimpicos
   isocie16 #7;      || Inversion RIS 218
   isocie17 #8;      || Doble Imposicion Intersocietaria
   isocie53 #9;      || Doble Imposicion Internacional
   isocie54 #10;     || Bonificaciones
   isocie40 #13;     || Doble Imposicion de Dividendos por socios no Residentes
   isocie41 #14;     || Gastos por investigacion y Desarrollo

   isocie52 #11;     || Resumen de Deducciones 1995

   isfant06 #3;
   isfant09 #12;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &anyo     = 0;
   &nombre   = "";
   &cif      = "";
   &impresor = "";
   &informe  = "";

   contador  = 0;
   importe   = "";
   impor1    = "";
   impor2    = "";
   impor3    = "";
   impor4    = "";
   len       = "";
   leng      = 0;
   var1      = 0;
   var2      = 0;
   var3      = 0;
   var4      = 0;
   var5      = 0;
   var6      = 0;
   var7      = 0;
   periodo   = "";
   peri      = 0;
   FechaAlfa = "";
   Pais      = "";
|FIN;

|PROCESO isy20009;
|HAZ hoja_11;
|HAZ hoja_12;
|FPRC;

|| **************************************************************************
||                        PROCESOS hoja_ 11
|| **************************************************************************

|PROCESO exencion;
contador = contador + 1;
|SI contador [ 14;
    var1 = contador - 1;
    var2 = var1 + 15; var3 = var2 + 15; var4 = var3 + 15;
    var5 = var4 + 15; var6 = var5 + 15; var7 = var6 + 15;

    |SI #2#5 = 0;
        #3var1 = "----------";
        #3var2 = "--------------";
        #3var3 = "--------------";
        #3var4 = "--------------";
    |SINO;
        FechaAlfa = (#2#4 % 106) + (#2#4 % -102);
        #3var1    = FechaAlfa;

        FechaAlfa = #2#5;
        FechaAlfa = ("          " + FechaAlfa) % -110;
        #3var2    = FechaAlfa;

        FechaAlfa = #2#6
        FechaAlfa = ("          " + FechaAlfa) % -110;
        #3var3    = FechaAlfa

        FechaAlfa = #2#7
        FechaAlfa = ("          " + FechaAlfa) % -110;
        #3var4    = FechaAlfa;
    |FINSI;

    |SI #2#9 = 0;
        #3var5 = "-";
        #3var6 = "----------";
        #3var7 = "--------------";
    |SINO;
        #3var5 = #2#3;
        FechaAlfa = (#2#8 % 106) + (#2#8 % -102);
        #3var6 = FechaAlfa;

        FechaAlfa = #2#9
        FechaAlfa = ("          " + FechaAlfa) % -110;
        #3var7    = FechaAlfa;
    |FINSI;
|FINSI;

periodo = #2#4 % -102;
peri    = periodo;

|SI peri = 95;
    #3#105 = #3#105 + #2#5;
    |SI #2#9 ! 0;
        periodo = #2#8 % -102;
        peri    = periodo;
        |SI peri = 95;  #3#106 = #3#106 + #2#9; |FINSI;
        |SI peri = 96;  #3#107 = #3#107 + #2#9; |FINSI;
        |SI peri = 97;  #3#108 = #3#108 + #2#9; |FINSI;
        |SI peri > 98;  #3#109 = #3#109 + #2#9; |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE isocie04;
#2#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, exencion;
|FIN;

|PROCESO intersoc;
|SI #8#3 = 1;
    #3#110 = #3#110 + #8#5;
    #3#114 = #3#114 + #8#6;
    #3#118 = #3#118 + #8#7;
|FINSI;

|SI #8#3 = 2;
    #3#111 = #3#111 + #8#5;
    #3#115 = #3#115 + #8#6;
    #3#119 = #3#119 + #8#7;
|FINSI;

|SI #8#3 = 3;
    #3#112 = #3#112 + #8#5;
    #3#116 = #3#116 + #8#6;
    #3#120 = #3#120 + #8#7;
|FINSI;

|SI #8#3 = 4;
    #3#113 = #3#113 + #8#5;
    #3#117 = #3#117 + #8#6;
    #3#121 = #3#121 + #8#7;
|FINSI;
|FPRC;

|DEFBUCLE isocie17;
#8#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, intersoc;
|FIN;

|PROCESO internac;
|SI Pais ! #9#8; |O contador = 0;
    Pais = #9#8;
    contador = contador + 1;
|FINSI;

|SI contador [ 4;
    var1 = contador + 121;
    var2 = var1 + 4; var3 = var2 + 4; var4 = var3 + 4; var5 = var1 + 51;
    #3var1 = #9#3;
    #3var2 = #3var2 + #9#4;
    #3var3 = #3var3 + #9#5;
    #3var4 = #3var4 + #9#6;
    #3var5 = #3var5 + #9#7;
|FINSI;
|FPRC;

|DEFBUCLE isocie53;
#9#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, NULL, NULL, NULL, NULL, internac;
#9#8;
|FIN;

|PROCESO dividendos;
contador = contador + 1;
|SI contador [ 7;
    var1    = contador + 137;
    var2    = var1     + 7;
    var3    = var2     + 7;
    var4    = var3     + 7;
    var5    = var4     + 7;
    #3var1  = #13#4;
    #3var2  = #13#5;
    #3var3  = #13#6;
    #3var4  = #13#7;
    #3var5  = #13#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie40;
#13#1;
3;
empresa, anyo, 01, 2;
empresa, anyo, 99, 2;
e;
NULL, dividendos;
|FIN;

|PROCESO hoja_11;
Pais = "";

|DDEFECTO #3;
contador = 0; |BUCLE isocie04;
              |BUCLE isocie17;
contador = 0; |BUCLE isocie53;
contador = 0; |BUCLE isocie40;

informe = "h9520011";  |HAZ imprime;
|FPRC;

|| **************************************************************************
||                        PROCESOS hoja_ 12
|| **************************************************************************

|PROCESO bonifica;
contador = contador + 1;
|SI contador [ 7;
    var1 = contador - 1;  #12var1 = #10#4;
    var2 = var1 + 7;      #12var2 = #10#5;
    var3 = var2 + 7;      #12var3 = #10#6;
    var4 = var3 + 7;      #12var4 = #10#7;
    var5 = var4 + 7;      #12var5 = #10#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie54;
#10#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, bonifica;
|FIN;

|PROCESO anyo95;
|SI #4#3 = "AF"; #12#041 = #12#041 + #4#7; |FINSI;
|SI #4#3 = "EL"; #12#041 = #12#041 + #4#7; |FINSI;
|SI #4#3 = "GI"; #12#042 = #12#042 + #4#7; |FINSI;
|SI #4#3 = "GA"; #12#043 = #12#043 + #4#7; |FINSI;
|SI #4#3 = "PC"; #12#044 = #12#044 + #4#7; |FINSI;
|SI #4#3 = "BI"; #12#045 = #12#045 + #4#7; |FINSI;
|SI #4#3 = "AE"; #12#046 = #12#046 + #4#7; |FINSI;
|SI #4#3 = "FP"; #12#047 = #12#047 + #4#7; |FINSI;
|FPRC;

|DEFBUCLE isocie06;
#4#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, anyo95;
|FIN;

|PROCESO expo;
|SI #6#3 = "1"; |Y #6#4 = 95; #12#048 = #12#048 + #6#8; |FINSI;
|SI #6#3 = "2"; |Y #6#4 = 95; #12#049 = #12#049 + #6#8; |FINSI;
|FPRC;

|DEFBUCLE isocie38;
#6#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, expo;
|FIN;

|PROCESO ris218;
contador = contador + 1;
|SI contador [ 8;
    var1 = contador + 58;   #12var1 = #7#3;
    var2 = var1 + 8;        #12var2 = #7#4;
    var3 = var2 + 8;        #12var3 = #7#5;
    var4 = var3 + 8;        #12var4 = #7#6;
    var5 = var4 + 8;        #12var5 = #7#7;
    var6 = var5 + 8;        #12var6 = #7#8;
|FINSI;
|FPRC;

|DEFBUCLE isocie16;
#7#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ris218;
|FIN;

|PROCESO hoja_12;
|DDEFECTO #12;

contador = 0; |BUCLE isocie54;
              |BUCLE isocie38;
              |BUCLE isocie06;

contador = 0; |BUCLE isocie16;

|ABRE #11;
#11#0 = empresa;
#11#1 = anyo;
|LEE 040#11=;
|SI FSalida ! 0; |DDEFECTO #11; |FINSI;
|CIERRA #11;

#12#50 = #11#36;
#12#52 = #11#39;
#12#53 = #11#42;
#12#54 = #11#48;
#12#55 = #11#45;
#12#56 = #11#51;
#12#57 = #11#123;
#12#58 = #11#138;

|ABRE #1;
#1#0 = empresa;
#1#1 = anyo;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|ABRE #14;
#14#0 = empresa;
#14#1 = anyo;
|LEE 040#14=;
|SI FSalida ! 0; |DDEFECTO #14; |FINSI;
|CIERRA #14;

informe = "h9520012";  |HAZ imprime;
|FPRC;
