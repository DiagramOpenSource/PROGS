|FICHEROS;
     mez00001 #0;
|FIN;

|VARIABLES;
     aNombreFich = "";
     aBase       = "";
     aPlantilla  = "";
     aOrigen     = "";
     aDestino    = "";
     aExtension  = "";
     aCadena1    = "";
     aCadena2    = "";
     aCapitulo   = "";
     aAlfa       = "";

     nSwMalo     = 0;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |DBASE aBase;  |QBF aBase;

     aPlantilla = aBase + "word/memoria/" + (("00000" + #0#2) % -105) + "/";
     aOrigen    = aBase + "word/memoria/" + (("00000" + #0#2) % -105) + "/";
     aExtension = ".doc";
     nSwMalo    = 0;

     |_PDIR aOrigen;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aCadena1 = aOrigen    > " ";
            aCadena2 = aExtension > " ";
            aDestino = aCadena1 - aCadena2;
            |SI aDestino ! aCadena1;
                aCadena1    = aOrigen > " ";
                aCadena2    = aPlantilla > " ";  |QBF aCadena2
                aNombreFich = aCadena1 - aCadena2;
                aCapitulo   = "m" + #0#0 + ".doc";
                aNombreFich = aNombreFich < aNombreFich;
                aCapitulo   = aCapitulo   < aCapitulo;
                |SI aNombreFich = aCapitulo;
                    nSwMalo = 1;
                |FINSI;
           |FINSI;
           |_SDIR aOrigen;
     |SIGUE;

     |SI nSwMalo = 1;
         |MENAV "      El Texto ya existe en la Empresa.";
         |ACABA;
     |FINSI;

     aOrigen    = aBase + "word/memoria/" + "m" + #0#0 + ".doc";
     aDestino   = aBase + "word/memoria/" + (("00000" + #0#2) % -105) + "/m" + #0#0 + ".doc";
     |MKDIR aPlantilla;

     |COPIA_FICHERO aOrigen, aDestino;
     |SI FSalida ! 0;
         |MENAV "       Ha habido algun error al copiar la Planilla.";
         |ACABA;
     |FINSI;

     |CONFI "2400SDesea Modificar el Texto en estos momentos";
     |SI FSalida = 0;
         aAlfa = "zmenumem;" + #0#0 + (("00000" + #0#2) % -105) + "2" + "1" + "1";
         |SUB_EJECUTA aAlfa;
     |FINSI;

     |SUB_EJECUTA "zmenumem;CREALO";
|FPRC;
