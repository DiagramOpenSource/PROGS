|FICHEROS;
      isoy2012;
      maempr10;
      maempr05;
      maempr12;
      maempr13;
      maempr14;
      maempr15;
      maempr16;
      maempr18;

      isom0000;
      isom0001;
      isom0010;
      isom0013;
      isom0014;
      isom0015;

      isom0507;

      isoh1201;
      isoh0919;
      isoh1020;
      isoh0921;
      isoh0922;
      isoh0923;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aBase          = "";
     aDirServidor   = "";
     aDirInternet   = "";
     aDirLanza      = "";
     aDelindex      = "";
     aFicheroT      = "";
     aFicheroP      = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";
     aLong          = "";
     aTecla         = "";
     aRetu          = "";
     aEsc1          = "";
     aEsc2          = "";

     nLong          = 0;
     nNume          = 0;
     nPos           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nPanta         = 0;
     nCasilla       = 0;
     nFecha         = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nContaBucle    = 0;
     nContaBucleL   = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nTotal         = 0;
     nValor626      = 0;
     nValor627      = 0;
     nValor628      = 0;
     nValor629      = 0;
     nCanti1        = 0;
     nCanti2        = 0;
     nCanti3        = 0;
     nCanti4        = 0;
     nCantiT        = 0;
     nResto         = 0;
     nTecla         = 0;
     nBotonCont     = 0;
     nBotonSal      = 0;

     fFechaD        = @;
     fFechaH        = @;


     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enHandle        = 0;
     &enCanti         = 0;
     &eaPagina        = "";
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaEfectivo      = "";
     &eaAdeudo        = "";
     &eaEntidad       = "";
     &eaOficina       = "";
     &eaDC             = "";
     &eaCuenta         = "";
     &enModelo         = 0;
     &enBanco          = 0;
     &enFormaPag       = 0;
     &enForzar         = 0;
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaFinLinea       = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
     &eaCasilla        = "";
|FIN;


|PROCESO CogePais;
     |ABRE #maempr16;
     #maempr16#0 = aPais;
     |LEE 000#maempr16.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr16;  |FINSI;
     |CIERRA #maempr16;

     aCodPais = #maempr16#2;
|FPRC;

|PROCESO maempr14;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #isoh0919#0);

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0 = ((nContaBucle / 6) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#2   = "200";
         #isoh0919#3   = "190";
         #isoh0919#89 = "</T200190>";

         eaPagina = eaPagina + "190";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nPuntero     = (nContaBucleL * 5) + 6;
     #isoh0919#nPuntero# = #maempr14#3;

     nPuntero     = nPuntero + 1;
     #isoh0919#nPuntero# = #maempr14#4;

     nPuntero     = nPuntero + 1;
     #isoh0919#nPuntero# = #maempr14#5;

     nPuntero     = nPuntero + 1;
     aPais        = #maempr14#6;  |HAZ CogePais;
     #isoh0919#nPuntero# = aCodPais;

     nPuntero     = nPuntero + 1;
     enCanti       = #maempr14#8;
     |HAZ Calcula17D;
     #isoh0919#nPuntero# = eaAlfa;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE maempr14;
     #maempr14#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     nContaBucle = nContaBucle + 1;
     #isoh0919#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #isoh0919#0);

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0     = ((nContaBucle / 6) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#2   = "200";
         #isoh0919#3   = "190";
         #isoh0919#89 = "</T200190>";

         eaPagina = eaPagina + "190";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nPuntero     = (nContaBucleL * 5) + 36;
     #isoh0919#nPuntero# = #maempr15#3;

     nPuntero     = nPuntero + 1;
     #isoh0919#nPuntero# = #maempr15#4;

     nPuntero     = nPuntero + 1;
     aPais        = #maempr15#5;
     |HAZ CogePais;
     #isoh0919#nPuntero# = aCodPais;

     nPuntero     = nPuntero + 1;
     enCanti       = #maempr15#7;
     |HAZ Calcula17D;
     #isoh0919#nPuntero# = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #maempr15#8;
     |HAZ Calcula3E2D;
     #isoh0919#nPuntero# = eaAlfa;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE maempr15;
     #maempr15#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr15;
|FIN;

|PROCESO isom0013;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0       = ((nContaBucle / 10) + .50) ! 0;

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         nContaBucleL = 66;

         #isoh0919#0 = ((nContaBucle / 10) + .50) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#3   = "190";
         #isoh0919#89 = "</T200190>";

         eaPagina = eaPagina + "190";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     |SI nContaBucleL > 75;  nContaBucleL = 67;  |FINSI;

     #isoh0919#nContaBucleL# = #isom0013#3;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE isom0013;
     #isom0013#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0013;
|FIN;

|PROCESO isom0014;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0       = ((nContaBucle / 5) + .49) ! 0;

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         nContaBucleL = 77;

         #isoh0919#0 = ((nContaBucle / 5) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#3   = "190";
         #isoh0919#89 = "</T200190>";

         eaPagina = eaPagina + "190";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     |SI nContaBucleL > 82;  nContaBucleL = 78;  |FINSI;

     #isoh0919#nContaBucleL# = #isom0014#3;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE isom0014;
     #isom0014#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0014;
|FIN;

|PROCESO isoh0919;
     |PARA nCampo = 1;  |SI nCampo [ 89;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0919#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0919;
     #isoh0919#1;
     ;
     01;
     99;
     ;
     NULL, isoh0919;
|FIN;

|PROCESO Hoja19;
     nHay = 0;

     |SI #isoh1201#42 = "0";
         |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |ABRE #maempr14;
     #maempr14#0 = #maempr10#0;
     #maempr14#1 = #maempr10#1;
     #maempr14#2 = 1;
     |LEE 000#maempr14.];
     |SI FSalida = 0;  |Y  #maempr14#0 = #maempr10#0;  |Y #maempr14#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr14;

     |ABRE #maempr15;
     #maempr15#0 = #maempr10#0;
     #maempr15#1 = #maempr10#1;
     #maempr15#2 = 1;
     |LEE 000#maempr15.];
     |SI FSalida = 0;  |Y  #maempr15#0 = #maempr10#0;  |Y #maempr15#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr15;

     |SI #isoh1201#66 = "1";
         |ABRE #isom0013;
         #isom0013#0 = #maempr10#0;
         #isom0013#1 = #maempr10#1;
         #isom0013#2 = 1;
         |LEE 000#isom0013.];
         |SI FSalida = 0;  |Y  #isom0013#0 = #maempr10#0;  |Y #isom0013#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0013;
     |FINSI;

     |SI #isoh1201#30 = "1";
         |ABRE #isom0014;
         #isom0014#0 = #maempr10#0;
         #isom0014#1 = #maempr10#1;
         #isom0014#2 = 1;
         |LEE 000#isom0014.];
         |SI FSalida = 0;  |Y  #isom0014#0 = #maempr10#0;  |Y #isom0014#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0014;
     |FINSI;

     |SI #isom0000#83 ! 0;  nHay = 1;  |FINSI;

     nValor = 0;
     |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h2" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0919#aDelindex#;
     |ABRE #isoh0919; |CIERRA #isoh0919; |DELINDEX #isoh0919;

     |ABRE #isoh0919;
     #isoh0919#0 = 1;
     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0   = 1;
         #isoh0919#5   = "";
         #isoh0919#2   = "200";
         #isoh0919#3   = "190";
         #isoh0919#89  = "</T200190>";

         |SI #isoh1201#66 = "1";
             enCanti   = #isom0000#80;  |HAZ Calcula17D;  #isoh0919#66 = eaAlfa;
         |FINSI;

         |SI #isoh1201#30 = "1";
             enCanti   = #isom0000#81;  |HAZ Calcula17D;  #isoh0919#76  = eaAlfa;
                                                     #isoh0919#77  = (("000" + #isom0000#82) % -103);
         |FINSI;

         |SI #isoh1201#21 = "1";  |O #isoh1201#22 = "1";  |O #isoh1201#32 = "1";
          |O #isoh1201#33 = "1";  |O #isoh1201#36 = "1";
             enCanti   = #isom0000#83;  |HAZ Calcula17D;  #isoh0919#83 = eaAlfa;
         |FINSI;

         eaAlfa    = (("0000" + #isom0000#2) % -104); #isoh0919#84 = eaAlfa;
         enCanti   = #isom0000#2;  |HAZ Calcula17D;
         enCanti   = #isom0000#3;  |HAZ Calcula17D;   #isoh0919#85 = eaAlfa;
         enCanti   = #isom0000#4;  |HAZ Calcula17D;   #isoh0919#86 = eaAlfa;
         enCanti   = #isom0000#5;  |HAZ Calcula17D;   #isoh0919#87 = eaAlfa;
         enCanti   = #isom0000#6;  |HAZ Calcula17D;   #isoh0919#88 = eaAlfa;

         eaPagina = eaPagina + "190";

         |GRABA 020#isoh0919.n;
         |LIBERA #isoh0919;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr14;
     nContaBucle = 0;    |BUCLE maempr15;

     |SI #isoh1201#66 = "1";
         nContaBucleL = 66;
         nContaBucle  = 0;   |BUCLE isom0013;
     |FINSI;

     |SI #isoh1201#30 = "1";
         nContaBucleL = 77;
         nContaBucle  = 0;   |BUCLE isom0014;
     |FINSI;

     |CIERRA #isoh0919;

     |BUCLE isoh0919;

     |ABRE #isoh0919; |CIERRA #isoh0919; |DELINDEX #isoh0919;
|FPRC;

|PROCESO maempr18;
     nContaBucle  = nContaBucle + 1;
     #isoh1020#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #isoh1020#0);

     |LEE 101#isoh1020.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1020;
         #isoh1020#0 = ((nContaBucle / 6) + .49) ! 0;

                          #isoh1020#5 = "";
         |SI #isoh1020#0 ! 1;  #isoh1020#5 = "C";  nComple = 1;  |FINSI;

         #isoh1020#2   = "200";
         #isoh1020#3   = "200";
         #isoh1020#132 = "</T200200>";

         eaPagina = eaPagina + "200";

         |GRABA 020#isoh1020.b;
     |FINSI;

     nPuntero     = (nContaBucleL * 9) + 6;
     #isoh1020#nPuntero# = #maempr18#3;

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = #maempr18#4;

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = #maempr18#5;

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = #maempr18#6 > " ";

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = #maempr18#7;

     nPuntero     = nPuntero + 1;
     aAlfa        = ("00" + #maempr18#8) % -102;
     #isoh1020#nPuntero# = aAlfa;

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = #maempr18#9;

                             aAlfa = "";
     |SI #maempr18#10 = "1§ a)";  aAlfa = "1A";  |FINSI;
     |SI #maempr18#10 = "1§ b)";  aAlfa = "1B";  |FINSI;
     |SI #maempr18#10 = "1§ c)";  aAlfa = "1C";  |FINSI;
     |SI #maempr18#10 = "2§ a)";  aAlfa = "2A";  |FINSI;
     |SI #maempr18#10 = "2§ b)";  aAlfa = "2B";  |FINSI;

     nPuntero     = nPuntero + 1;
     #isoh1020#nPuntero# = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #maempr18#11;
     |HAZ Calcula17D;
     #isoh1020#nPuntero# = eaAlfa;

     |GRABA 020#isoh1020.a;
     |LIBERA #isoh1020;
|FPRC;

|DEFBUCLE maempr18;
     #maempr18#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr18;
|FIN;

|PROCESO isom0507Coo;
     #isom0010#0 = #maempr10#0;
     #isom0010#1 = #maempr10#1;
     #isom0010#2 = #isom0507#1;
     |LEE 000#isom0010.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0010;  |FINSI;

     |SI #isoh1201#27 = "0";  |Y #isoh1201#28 = "0";  |Y #isoh1201#29 = "0";
         #isom0010#4  = "";
         #isom0010#6  = 0;
         #isom0010#8  = 0;
         #isom0010#10 = 0;
     |FINSI;

     |SI #isom0507#4 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#6;  |HAZ Calcula17D;  #isoh1020#nCasilla# = eaAlfa;
     |FINSI;

     |SI #isom0507#5 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#8;  |HAZ Calcula17D;  #isoh1020#nCasilla# = eaAlfa;
     |FINSI;

     |SI #isom0507#6 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#10; |HAZ Calcula17D;  #isoh1020#nCasilla# = eaAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507Coo;
      #isom0507#1;
      ;
      #maempr10#1, nDesde;
      #maempr10#1, nHasta;
      ;
      NULL, isom0507Coo;
|FIN;

|PROCESO isoh0920;
     |PARA nCampo = 1;  |SI nCampo [ 132;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1020#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0920;
     #isoh1020#1;
     ;
     01;
     99;
     ;
     NULL, isoh0920;
|FIN;

|PROCESO Hoja20;
     nHay = 0;

     |ABRE #maempr18;
     #maempr18#0 = #maempr10#0;
     #maempr18#1 = #maempr10#1;
     #maempr18#2 = 1;
     |LEE 000#maempr18.];
     |SI FSalida = 0;  |Y  #maempr18#0 = #maempr10#0;  |Y #maempr18#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr18;

     |SI #isoh1201#27 = "0";  |Y #isoh1201#28 = "0";  |Y #isoh1201#29 = "0";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |SI #isoh1201#27 ! "0";  |O #isoh1201#28 ! "0";  |O #isoh1201#29 ! "0";
         eaCasilla = "694";  |HAZ LeeFich110;  nValor  = #isom0010#6;
     |FINSI;

     |PARA nCampo = 2;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     nValor = nValor + #isom0000#110 + #isom0000#111;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h3" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh1020#aDelindex#;
     |ABRE #isoh1020; |CIERRA #isoh1020; |DELINDEX #isoh1020;

     |ABRE #isoh1020;
     #isoh1020#0 = 1;
     |LEE 101#isoh1020.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1020;
         #isoh1020#0   = 1;
         #isoh1020#5   = "";
         #isoh1020#2   = "200";
         #isoh1020#3   = "200";
         #isoh1020#132 = "</T200200>";

         enCanti   = #isom0000#7;   |HAZ Calcula17D;  #isoh1020#60 = eaAlfa;
         enCanti   = #isom0000#17;  |HAZ Calcula17D;  #isoh1020#61 = eaAlfa;
         enCanti   = #isom0000#8;   |HAZ Calcula17D;  #isoh1020#62 = eaAlfa;
         enCanti   = #isom0000#18;  |HAZ Calcula17D;  #isoh1020#63 = eaAlfa;
         enCanti   = #isom0000#9;   |HAZ Calcula17D;  #isoh1020#64 = eaAlfa;
         enCanti   = #isom0000#19;  |HAZ Calcula17D;  #isoh1020#65 = eaAlfa;
         enCanti   = #isom0000#110; |HAZ Calcula17D;  #isoh1020#66 = eaAlfa;
         enCanti   = #isom0000#111; |HAZ Calcula17D;  #isoh1020#67 = eaAlfa;
         enCanti   = #isom0000#20;  |HAZ Calcula17D;  #isoh1020#68 = eaAlfa;
         enCanti   = #isom0000#10;  |HAZ Calcula17D;  #isoh1020#69 = eaAlfa;
         enCanti   = #isom0000#21;  |HAZ Calcula17D;  #isoh1020#70 = eaAlfa;
         enCanti   = #isom0000#11;  |HAZ Calcula17D;  #isoh1020#71 = eaAlfa;
         enCanti   = #isom0000#22;  |HAZ Calcula17D;  #isoh1020#72 = eaAlfa;
         enCanti   = #isom0000#12;  |HAZ Calcula17D;  #isoh1020#73 = eaAlfa;
         enCanti   = #isom0000#23;  |HAZ Calcula17D;  #isoh1020#74 = eaAlfa;
         enCanti   = #isom0000#13;  |HAZ Calcula17D;  #isoh1020#75 = eaAlfa;
         enCanti   = #isom0000#24;  |HAZ Calcula17D;  #isoh1020#76 = eaAlfa;
         enCanti   = #isom0000#14;  |HAZ Calcula17D;  #isoh1020#77 = eaAlfa;
         enCanti   = #isom0000#15;  |HAZ Calcula17D;  #isoh1020#78 = eaAlfa;
         enCanti   = #isom0000#25;  |HAZ Calcula17D;  #isoh1020#79 = eaAlfa;
         enCanti   = #isom0000#16;  |HAZ Calcula17D;  #isoh1020#80 = eaAlfa;
         enCanti   = #isom0000#26;  |HAZ Calcula17D;  #isoh1020#81 = eaAlfa;

         |ABRE #isom0010;
         |SELECT #1#isom0010;
         nCasilla = 81;
         nDesde   = 1005;    nHasta = 1085;  |BUCLE isom0507Coo;
         |CIERRA #isom0010;

         eaPagina = eaPagina + "200";

         |GRABA 020#isoh1020.n;
         |LIBERA #isoh1020;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr18;

     |CIERRA #isoh1020;

     |BUCLE isoh0920;

     |ABRE #isoh1020; |CIERRA #isoh1020; |DELINDEX #isoh1020;
|FPRC;

|PROCESO isom0015;
     nContaBucle  = nContaBucle + 1;
     #isoh0921#0       = ((nContaBucle / 5) + .49) ! 0;
     nContaBucleL = (nContaBucle + 4) - (5 * #isoh0921#0);

     |LEE 101#isoh0921.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0921;
         #isoh0921#0 = ((nContaBucle / 5) + .49) ! 0;

                          #isoh0921#5 = "";
         |SI #isoh0921#0 ! 1;  #isoh0921#5 = "C";  nComple = 1;  |FINSI;

         #isoh0921#2   = "200";
         #isoh0921#3   = "210";
         #isoh0921#51 = "</T200210>";

         eaPagina = eaPagina + "210";

         |GRABA 020#isoh0921.b;
     |FINSI;

     nPuntero     = (nContaBucleL * 9) + 6;
     #isoh0921#nPuntero# = #isom0015#3;

     nPuntero     = nPuntero + 1;
     #isoh0921#nPuntero# = #isom0015#4;

     nPuntero     = nPuntero + 1;
     #isoh0921#nPuntero# = #isom0015#5;

     nPuntero     = nPuntero + 1;
     #isoh0921#nPuntero# = #isom0015#6;

     nPuntero     = nPuntero + 1;
     #isoh0921#nPuntero# = #isom0015#7;

     nPuntero     = nPuntero + 1;
     aAlfa        = (#isom0015#8 % -104) + (#isom0015#8 % 402) + (#isom0015#8 % 102);
     #isoh0921#nPuntero# = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #isom0015#9;
     |HAZ Calcula17D;
     #isoh0921#nPuntero# = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #isom0015#10;
     |HAZ Calcula17D;
     #isoh0921#nPuntero# = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #isom0015#11;
     |HAZ Calcula17D;
     #isoh0921#nPuntero# = eaAlfa;

     |GRABA 020#isoh0921.a;
     |LIBERA #isoh0921;
|FPRC;

|DEFBUCLE isom0015;
     #isom0015#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0015;
|FIN;

|PROCESO isoh0921;
     |PARA nCampo = 1;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0921#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0921;
     #isoh0921#1;
     ;
     01;
     99;
     ;
     NULL, isoh0921;
|FIN;

|PROCESO Hoja21;
     nHay = 0;

     |SI #isoh1201#64 = "0";  |Y #isoh1201#65 = "0";
         |ACABA;
     |FINSI;

     |ABRE #isom0015;
     #isom0015#0 = #maempr10#0;
     #isom0015#1 = #maempr10#1;
     #isom0015#2 = 1;
     |LEE 000#isom0015.];
     |SI FSalida = 0;  |Y  #isom0015#0 = #maempr10#0;  |Y #isom0015#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #isom0015;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h4" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0921#aDelindex#;
     |ABRE #isoh0921; |CIERRA #isoh0921; |DELINDEX #isoh0921;

     |ABRE #isoh0921;
     nContaBucle = 0;  |BUCLE isom0015;
     |CIERRA #isoh0921;

     |BUCLE isoh0921;

     |ABRE #isoh0921; |CIERRA #isoh0921; |DELINDEX #isoh0921;
|FPRC;

|PROCESO maempr05;
     nContaBucle  = nContaBucle + 1;
     #isoh0922#0       = ((nContaBucle / 25) + .49) ! 0;
     nContaBucleL = (nContaBucle + 24) - (25 * #isoh0922#0);

     |LEE 101#isoh0922.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0922;
         #isoh0922#0     = ((nContaBucle / 25) + .49) ! 0;

                          #isoh0922#5   = "";
         |SI #isoh0922#0 ! 1;  #isoh0922#5   = "C";  nComple = 1;  |FINSI;

         eaPagina = eaPagina + "220";

         #isoh0922#3   = "220";
         #isoh0922#234 = "</T200220>";

         |GRABA 020#isoh0922.b;
     |FINSI;

     nPuntero     = (nContaBucleL * 8) + 34;
     #isoh0922#nPuntero# = #maempr05#3;

                         aAlfa = "0";
     |SI #maempr05#10 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #isoh0922#nPuntero# = aAlfa;

     nPuntero     = nPuntero + 1;
     #isoh0922#nPuntero# = #maempr05#4;

     nPuntero     = nPuntero + 1;
     #isoh0922#nPuntero# = #maempr05#5;

     nPuntero     = nPuntero + 1;
     #isoh0922#nPuntero# = #maempr05#6;

     nPuntero     = nPuntero + 1;
     nNume        = #maempr05#7;
     aAlfa        = ("00" + nNume) % -102;
     #isoh0922#nPuntero# = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #maempr05#8;
     |HAZ Calcula17D;
     #isoh0922#nPuntero# = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #maempr05#9;
     |HAZ Calcula3E4D;
     #isoh0922#nPuntero# = eaAlfa;

     |GRABA 020#isoh0922.a;
     |LIBERA #isoh0922;
|FPRC;

|DEFBUCLE maempr05;
     #maempr05#2;
     ;
     #maempr10#0, #maempr10#1, 999.99, 00;
     #maempr10#0, #maempr10#1,      0, 99;
     ;
     NULL, maempr05;
|FIN;

|PROCESO isoh0922;
     |PARA nCampo = 1;  |SI nCampo [ 234;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0922#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0922;
     #isoh0922#1;
     ;
     01;
     99;
     ;
     NULL, isoh0922;
|FIN;

|PROCESO Hoja22;
     |SI #isoh1201#25 = "0";  |Y #isoh1201#26 = "0";
         |ACABA;
     |FINSI;

     aDelindex = ("h5" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0922#aDelindex#;
     |ABRE #isoh0922; |CIERRA #isoh0922; |DELINDEX #isoh0922;

     |ABRE #isoh0922;
     |DDEFECTO #isoh0922;

     #isoh0922#0  = 1;

     enCanti  = #isom0000#29;  |HAZ Calcula3E4D;  #isoh0922#6  = eaAlfa;
     enCanti  = #isom0000#30;  |HAZ Calcula17D;   #isoh0922#7  = eaAlfa;
     enCanti  = #isom0000#31;  |HAZ Calcula17D;   #isoh0922#8  = eaAlfa;
     enCanti  = #isom0000#32;  |HAZ Calcula17D;   #isoh0922#9  = eaAlfa;
                                             #isoh0922#10 = #isom0000#33;
     enCanti  = #isom0000#34;  |HAZ Calcula3E2D;  #isoh0922#11 = eaAlfa;
     enCanti  = #isom0000#35;  |HAZ Calcula17D;   #isoh0922#12 = eaAlfa;
                                             #isoh0922#13 = #isom0000#36;
     enCanti  = #isom0000#37;  |HAZ Calcula3E2D;  #isoh0922#14 = eaAlfa;
     enCanti  = #isom0000#38;  |HAZ Calcula17D;   #isoh0922#15 = eaAlfa;
                                             #isoh0922#16 = #isom0000#39;
     enCanti  = #isom0000#40;  |HAZ Calcula3E2D;  #isoh0922#17 = eaAlfa;
     enCanti  = #isom0000#41;  |HAZ Calcula17D;   #isoh0922#18 = eaAlfa;
                                             #isoh0922#19 = #isom0000#42;
     enCanti  = #isom0000#43;  |HAZ Calcula3E2D;  #isoh0922#20 = eaAlfa;
     enCanti  = #isom0000#44;  |HAZ Calcula17D;   #isoh0922#21 = eaAlfa;
     enCanti  = #isom0000#45;  |HAZ Calcula3E2D;  #isoh0922#22 = eaAlfa;
     enCanti  = #isom0000#46;  |HAZ Calcula17D;   #isoh0922#23 = eaAlfa;
     enCanti  = #isom0000#47;  |HAZ Calcula3E2D;  #isoh0922#24 = eaAlfa;
     enCanti  = #isom0000#48;  |HAZ Calcula17D;   #isoh0922#25 = eaAlfa;
     enCanti  = #isom0000#49;  |HAZ Calcula3E2D;  #isoh0922#26 = eaAlfa;
     enCanti  = #isom0000#50;  |HAZ Calcula17D;   #isoh0922#27 = eaAlfa;
     enCanti  = #isom0000#51;  |HAZ Calcula3E2D;  #isoh0922#28 = eaAlfa;
     enCanti  = #isom0000#52;  |HAZ Calcula17D;   #isoh0922#29 = eaAlfa;
     enCanti  = #isom0000#53;  |HAZ Calcula17D;   #isoh0922#30 = eaAlfa;
     enCanti  = #isom0000#54;  |HAZ Calcula17D;   #isoh0922#31 = eaAlfa;
     enCanti  = #isom0000#55;  |HAZ Calcula17D;   #isoh0922#32 = eaAlfa;
     enCanti  = #isom0000#56;  |HAZ Calcula17D;   #isoh0922#33 = eaAlfa;

     eaPagina = eaPagina + "220";

     #isoh0922#3   = "220";
     #isoh0922#234 = "</T200220>";

     |GRABA 020#isoh0922.n;
     |LIBERA #isoh0922;

     nContaBucle = 0;    |BUCLE maempr05;

     |CIERRA #isoh0922;
     |BUCLE isoh0922;

     |ABRE #isoh0922; |CIERRA #isoh0922; |DELINDEX #isoh0922;
|FPRC;

|PROCESO maempr13;
     nContaBucleL  = nContaBucleL + 1;

     |SI nContaBucleL ] 6;
         |ERROR10;
         |ACABA;
     |FINSI;

     nPuntero = ((((nContaBucle + 5) - (6 * #isoh0923#0)) * 9) + 9) + nContaBucleL;

     #isoh0923#nPuntero# = #maempr13#4;
|FPRC;

|DEFBUCLE maempr13;
     #maempr13#1;
     ;
     #maempr12#0, #maempr12#1, #maempr12#2, 00;
     #maempr12#0, #maempr12#1, #maempr12#2, 99;
     ;
     NULL, maempr13;
|FIN;

|PROCESO maempr12;
     nContaBucle  = nContaBucle + 1;
     #isoh0923#0       = ((nContaBucle / 6) + .49) ! 0;

     |LEE 101#isoh0923.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0923;
         #isoh0923#0 = ((nContaBucle / 6) + .49) ! 0;

                          #isoh0923#5 = "";
         |SI #isoh0923#0 ! 1;  #isoh0923#5 = "C";  nComple = 1;  |FINSI;

         |SI #isoh0923#5 = "C";  |Y #isoy2012#0 = "2";
             ||ACABA;
         |FINSI;

         nTotal = 0;
         eaPagina = eaPagina + "230";

         #isoh0923#3  = "230";
         #isoh0923#61 = "</T200230>";

         |GRABA 020#isoh0923.b;
     |FINSI;

     nPuntero     = (((nContaBucle + 5) - (6 * #isoh0923#0)) * 9) + 6;
     #isoh0923#nPuntero# = #maempr12#3;

     nPuntero     = nPuntero + 1;
     #isoh0923#nPuntero# = #maempr12#4;

     nPuntero     = nPuntero + 1;
     aPais        = #maempr12#5 % 102;
     #isoh0923#nPuntero# = aPais;

     nPuntero     = nPuntero + 1;
     enCanti      = #maempr12#6;
     |HAZ Calcula17D;
     #isoh0923#nPuntero# = eaAlfa;

     nTotal       = nTotal + #maempr12#6;

     enCanti      = nTotal;
     |HAZ Calcula17D;
     #isoh0923#60      = eaAlfa;

     nContaBucleL = 0;  |BUCLE maempr13;

     |GRABA 020#isoh0923.a;
     |LIBERA #isoh0923;
|FPRC;

|DEFBUCLE maempr12;
     #maempr12#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, maempr12;
|FIN;

|PROCESO isoh0923;
     |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0923#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0923;
     #isoh0923#1;
     ;
     01;
     99;
     ;
     NULL, isoh0923;
|FIN;

|PROCESO Hoja23;
     nHay = 0;

     |ABRE #maempr12;
     #maempr12#0 = #maempr10#0;
     #maempr12#1 = #maempr10#1;
     #maempr12#2 = 1;
     |LEE 000#maempr12.];
     |SI FSalida = 0;  |Y  #maempr12#0 = #maempr10#0;  |Y #maempr12#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr12;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h6" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0923#aDelindex#;
     |ABRE #isoh0923; |CIERRA #isoh0923; |DELINDEX #isoh0923;

     |ABRE #isoh0923;

     |DDEFECTO #isoh0923;
     #isoh0923#0   = 1;
     #isoh0923#5   = "";
     nTotal   = 0;
     eaPagina = eaPagina + "230";

     #isoh0923#3  = "230";
     #isoh0923#61 = "</T200230>";

     |GRABA 020#isoh0923.n;

     nContaBucle = 0;   |BUCLE maempr12;

     |CIERRA #isoh0923;

     |BUCLE isoh0923;

     |ABRE #isoh0923; |CIERRA #isoh0923; |DELINDEX #isoh0923;
|FPRC;

|PROCESO CalculaCas;
     nCanti1 = ((nValor * nValor626) / nTotal) ! 2;
     nCanti2 = ((nValor * nValor627) / nTotal) ! 2;
     nCanti3 = ((nValor * nValor628) / nTotal) ! 2;
     nCanti4 = ((nValor * nValor629) / nTotal) ! 2;
     nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
     nResto  = nValor - nCantiT;

     |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

     enCanti = nCanti1;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti2;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti3;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti4;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti1 + nCanti2 + nCanti3 + nCanti4;
                         |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja24;
     |SI #isoh1201#43 = "0";
         |ACABA;
     |FINSI;

     eaPagina = eaPagina + "240";

     eaAlfa = "<T200240> ";  |HAZ GrabaSecuencial;

     eaCasilla = "050";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "051";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "052";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "053";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "054";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "055";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "056";  |HAZ LeeFich101;
     enCanti  = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla  = "626";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor626 = #isom0001#5;

     eaCasilla  = "627";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor627 = #isom0001#5;

     eaCasilla  = "628";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor628 = #isom0001#5;

     eaCasilla  = "629";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor629 = #isom0001#5;

     eaCasilla  = "625";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;

     nTotal    = nValor626 + nValor627 + nValor628 + nValor629;

     eaCasilla  = "600";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "602";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "604";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "606";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "612";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "616";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "642";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "618";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "620";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "622";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;

     eaAlfa = "</T200240>";    |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;
