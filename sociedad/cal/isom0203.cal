|FICHEROS;
     isom0002;
     isom0201;
     isom0203;
     isom0512;

     maempr10;

     :/agicont/def/ca8m0000;
|FIN;

|VARIABLES;
      nRango         = 0;
      nBotonSal      = 0;
      nTree          = 0;
      nHandle        = 0;
      nPanta         = 0;
      nBotonLabel    = 0;
      nVentana       = 0;
      nVentTrab      = 0;
      nGrid          = 0;
      nModo          = 0;
      nLinea         = 0;
      nHay           = 0;

      aContenido     = "";
      aTexto         = "";
      aBase          = "";
      aAlfa          = "";
      aAbre          = "";
      aEsc1          = "";
      aEsc2          = "";
      aRetu          = "";
      aTecla         = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaTipoColor    = "";
     &eaColor        = "";
     &enModoConsulta = 0;
|FIN;

|PROCESO isom0203B;
     |BORRA 020#isom0203.a;
     |LIBERA #isom0203;
|FPRC;

|DEFBUCLE isom0203B;
     #isom0203#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0203B;
|FIN;

|PROCESO isom0002;
     #isom0203#0  = #isom0002#0;
     #isom0203#1  = #isom0002#1;
     #isom0203#2  = #isom0002#2;
     |LEE 101#isom0203.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0203;
         #isom0203#0  = #isom0002#0;
         #isom0203#1  = #isom0002#1;
         #isom0203#2  = #isom0002#2;
         |GRABA 020#isom0203.b;
     |FINSI;
     #isom0203#3  = #isom0002#3;
     #isom0203#4  = #isom0002#4;
     #isom0203#5  = #isom0002#5;
     #isom0203#6  = #isom0002#6;
     #isom0203#7  = #isom0002#7;
     #isom0203#8  = #isom0002#8;
     |GRABA 020#isom0203.a;
     |LIBERA #isom0203;
|FPRC;

|DEFBUCLE isom0002;
     #isom0002#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     ;
     NULL, isom0002;
|FIN;

|PROCESO BotonRecargar;
     |VENTANA 0501, 0540, -1, 16, "Procesando trabajo";
     nVentTrab = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;  |PULSATECLA;

     |BUCLE isom0203B;
     |BUCLE isom0002;

     |HAZ MontaEstructura501;

     #isom0203#0 = enEmpresa;
     #isom0203#1 = enAnyo;
     #isom0203#2 = 5;
     |LEE 000#isom0203.];

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentTrab;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentTrab;

     |PULSATECLA;

     aAlfa = "|IDGRID";
     aAlfa = #isom0203#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Tipo1;  |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |HAZ Tipo1;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |C_M #isom0203#5, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |GRABA 020#isom0203.a;
     |LIBERA #isom0203;

     nLinea = #isom0203#2;

     |HAZ TotalFich203;

     #isom0203#2 = nLinea;
     |LEE 101#isom0203.=;

     aAlfa = "|IDGRID";
     aAlfa = #isom0203#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |C_M #isom0203#5, 1, "N";
     |SI #isom0203#6 = "N";
         |SI #isom0203#7 = "I";
             |MENAV "0000 Casilla no operativa, no procede por la configuraci¢n de la empresa.";
         |FINSI;
     |SINO;
         |SI #isom0203#7 = "I";
             |C_M #isom0203#5, 1, "S";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Evento203;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#isom0203.=;
     |FINSI;
|FPRC;

|PROCESO isom0512;
     #isom0203#0  = enEmpresa;
     #isom0203#1  = #isom0512#0;
     #isom0203#2  = #isom0512#1;
     |LEE 101#isom0203.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0203;
         #isom0203#0  = enEmpresa;
         #isom0203#1  = #isom0512#0;
         #isom0203#2  = #isom0512#1;
         |GRABA 020#isom0203.b;
     |FINSI;

     #isom0203#3  = #isom0512#2;
     #isom0203#4  = #isom0512#3;
     #isom0203#6  = "N";

     |SI #ca8m0000#2 = 1;  #isom0203#6 = #isom0512#4;  #isom0203#7 = #isom0512#7;  |FINSI;
     |SI #ca8m0000#2 = 2;  #isom0203#6 = #isom0512#5;  #isom0203#7 = #isom0512#8;  |FINSI;
     |SI #ca8m0000#2 = 3;  #isom0203#6 = #isom0512#6;  #isom0203#7 = #isom0512#9;  |FINSI;

     eaTipoColor = #isom0512#10;
     |HAZ CogeColor;
     #isom0203#8      = eaColor;

     |GRABA 020#isom0203.a;
     |LIBERA #isom0203;
|FPRC;

|DEFBUCLE isom0512;
     #isom0512#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0512;
|FIN;

|PROCESO MontaEstructura501;
     |BUCLE isom0512;
|FPRC;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO Baja203;
     #isom0203#0  = enEmpresa;
     #isom0203#1  = enAnyo;
     #isom0203#2  = 1;
|FPRC;

|PROCESO Alta203;
     #isom0203#0  = enEmpresa;
     #isom0203#1  = enAnyo;
     #isom0203#2  = 9999;
|FPRC;


|PROCESO isom0203;
     |SI #isom0203#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0203.a;
     |LIBERA #isom0203;
|FPRC;

|DEFBUCLE isom0203;
     #isom0203#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0203;
|FIN;

|PROGRAMA;
     nHay = 0;
     |ABRE #isom0201;
     #isom0201#0 = enEmpresa;
     #isom0201#1 = enAnyo;
     #isom0201#2 = 1;
     |LEE 000#isom0201.];
     |SI FSalida = 0;  |Y #isom0201#0 = enEmpresa;  |Y  #isom0201#1 = enAnyo;
         nHay = 1;
     |FINSI;
     |CIERRA #isom0201;

     |SI nHay = 0;
         |BUCLE isom0203B;

         |MENAV "0000No hay revalorizaciones en la empresa";
         |ACABA;
     |FINSI;

     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Balance activo y pasivo";

     |VENTANA 0501, 3599, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |ABRE #ca8m0000;
     #ca8m0000#0 = #maempr10#101;
     |LEE 000#ca8m0000.=;
     |SI FSalida ! 0;  |DDEFECTO #ca8m0000;  |FINSI;
     |CIERRA #ca8m0000;

     #isom0203#0 = enEmpresa;
     #isom0203#1 = enAnyo;
     #isom0203#2 = 1;
     |LEE 000#isom0203.];
     |SI FSalida ! 0;  |O #isom0203#0 = enEmpresa;  |O #isom0203#1 = enAnyo;
         |BUCLE isom0002;
     |FINSI;

     |HAZ MontaEstructura501;

     #isom0203#0 = enEmpresa;
     #isom0203#1 = enAnyo;
     #isom0203#2 = 5;
     |LEE 000#isom0203.];

     |PINPA #0#isom0203;
     nPanta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Recargar del balance del impuesto", 0568, 0598, BotonRecargar;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} sal&Ir", 3488, 3498, BotonSalir;
     nBotonSal = FSalida;

     nRango = 1 + 4 + 8 + 16 + 128 + 256;

     |LINEAL_SIMPLE #1#isom0203, nRango, 0602, 3498, Baja203, Alta203, Evento203;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |BUCLE isom0203;

     |HAZ Chequeo;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;

     |PULSATECLA;
|FPRO;

|PROCESO Tipo80m2;  |TIPO 80;
     |ABRET #isom0203;
     |ABRET #isom0512;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90m2;  |TIPO 90;
     |CIERRAT #isom0203;
     |CIERRAT #isom0512;
|FPRC;
