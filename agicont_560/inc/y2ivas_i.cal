|FICHEROS;
    cacuenta #3;
    calibros #10;
    caivapan #11;
|FIN;

|VARIABLES;
    &entrada = 1;
    sw = 0;
    sw_pie = 0;
    contaiva = 0;
    contarec = 0;
    sw_punt = 0;
    pepe = 0;
    informe2 = "cay22vac";
    fecalf = "";
    men1   = "    NO EXISTE EMPRESA";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
    traba1 = "";
    x = 0;
    y = 0;
    z = 0;
    &varalf = "";
    &total1 = 0;
    &total2 = 0;
    &total3 = 0;
    &total4 = 0;
    &total5 = 0;
    sw_total = 0;
    &tb = 0;
    &ti = 0;
    &tr = 0;
    &tt = 0;
    &descri1 = "";
    &descri2 = "";
    &varnum1 = 0;
    &varnum2 = 0;
    &varnum3 = 0;
    &tiva1 = 0;
    &tiva3 = 0;
    &trec1 = 0;
    &trec3 = 0;
    &ttotal1 = 0;
    &ttotal3 = 0;
    &swlin = 0;

   {10}iva = 0;
   {10}baseiva = 0;
   {10}cuotiva = 0;
   {10}rec = 0;
   {10}baserec = 0;
   {10}cuotrec = 0;
   {-1}menu = "";
       menu1 = "2400";
       menu2 = "2";
       menu3 = " Elija opcion: ";
       menu4 = "IP";
       menu5 = " Impresora ";
       menu6 = " Pantalla ";
    opcion = 0;
    po = 0;
    seleccio = 0;
    mas = 0;
    detalle = 0;
    sw_fin = 0;
|FIN;

______________________________________/ POR IMPRESORA
|PROCESO imprimir;
|SI sw = 0;
        varalf = #10#1;
    |QBF varalf;
        varalf = " * INFORME DE COMPROBACION DE " + varalf + " *";
        sw = 1;
|FINSI;
    sw_pie = 1;
|HAZ leecuen;

    total1 = 0;  total2 = 0;  total3 = 0;  total4 = 0;  total5 = 0;
    sw_total = 0;

|SI #1#53 ! 0; |O #1#57 ! 0; |O #1#61 ! 0;
    total5 = #1#26;  sw_total = 1;
    |VETE yatotal;
|FINSI;

|SI #1#52 ! 0; |O #1#56 ! 0; |O #1#60 ! 0;
    total4 = #1#26;  sw_total = 1;
    |VETE yatotal;
|FINSI;

|SI #1#10 ! 0; |O #1#16 ! 0; |O #1#22 ! 0;
    total3 = #1#26;  sw_total = 1;
    |VETE yatotal;
|FINSI;

|SI #1#09 ! 0; |O #1#15 ! 0; |O #1#21 ! 0;
    total2 = #1#26;  sw_total = 1;
    |VETE yatotal;
|FINSI;

|SI #1#08 ! 0; |O #1#14 ! 0; |O #1#20 ! 0;
    total1 = #1#26;
|FINSI;

|ET yatotal;
|PRINT;

|PARA x =  8; |SI x [ 10; |HACIENDO x = x + 1;
        y = x + 6;
        z = y + 6;
        tb = tb + #1x;
        ti = ti + #1y;
        tr = tr + #1z;
|SIGUE;
|PARA x = 52; |SI x [ 53; |HACIENDO x = x + 1;
        y = x + 4;
        z = y + 4;
        tb = tb + #1x;
        ti = ti + #1y;
        tr = tr + #1z;
|SIGUE;
    tt = tt + #1#26;

|HAZ punteros;
|FPRC;

|PROCESO impre2;
|INFOR informe2;
                                  || Imprime resumen iva
    Iiva = iva1 <-;
    Ibaseiva = baseiva1 <-;
    Icuotiva = cuotiva1 <-;

    descri1 = "I.V.A.";
    descri2 = "======";
    swlin = 1;
|PRINT;

    tiva1 = 0;
    tiva3 = 0;
|PARA x = 1; |SI x [ contaiva; |HACIENDO x = x + 1;
          swlin = 2;
          varnum1 = baseiva;
          varnum2 = iva;
          varnum3 = cuotiva;
          tiva1 = tiva1 + varnum1;
          tiva3 = tiva3 + varnum3;
      |PRINT;
          Ibaseiva = Ibaseiva + 1;
          Icuotiva = Icuotiva + 1;
          Iiva = Iiva + 1;
|SIGUE;
|SI contaiva ! 0;
       swlin = 3;
    |PRINT;
|FINSI;
    ttotal3 = ttotal3 + tiva3;

|| --------------------------------------------------------
                                           || Imprime resume recargo
    Irec = rec1 <-;
    Ibaserec = baserec1 <-;
    Icuotrec = cuotrec1 <-;

    descri1 = "RECARGO DE EQUIVALENCIA";
    descri2 = "=======================";
    swlin = 1;
|PRINT;

    tiva1 = 0;
    tiva3 = 0;
|PARA x = 1; |SI x [ contarec; |HACIENDO x = x + 1;
        swlin = 2;
        varnum1 = baserec;
        varnum2 = rec;
        varnum3 = cuotrec;
        tiva1 = tiva1 + varnum1;
        tiva3 = tiva3 + varnum3;
    |PRINT;
        Ibaserec = Ibaserec + 1;
        Icuotrec = Icuotrec + 1;
        Irec = Irec + 1;
|SIGUE;
|SI contarec ! 0;
        swlin = 3;
    |PRINT;
|FINSI;
    ttotal1 = ttotal1 + tiva1;
    ttotal3 = ttotal3 + tiva3;

|PIEINF;
|FININF;
|FPRC;

|PROCESO leecuen;
|ABRE #3;
    #3#0 = #1#4;
    #3#1 = #1#5;
|LEE 001#3=;
|SI FSalida ! 0;
    |DDEFECTO #3;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO punteros;
                          || Carga el iva
|PARA x =  8; |SI x [ 10; |HACIENDO x = x + 1;         || bases 1-3
        y = x + 3;
        z = y + 3;
    |HAZ carga_iva;
|SIGUE;
|PARA x = 52; |SI x [ 53; |HACIENDO x = x + 1;         || bases 4-5
        y = x + 2;
        z = y + 2;
    |HAZ carga_iva;
|SIGUE;
                                                || Carga el recargo
|PARA x =  8; |SI x [ 10; |HACIENDO x = x + 1;         || bases 1-3
        y = x + 9;
        z = y + 3;
    |HAZ carga_rec;
|SIGUE;
|PARA x = 52; |SI x [ 53; |HACIENDO x = x + 1;         || bases 4-5
        y = x + 6;
        z = y + 2;
    |HAZ carga_rec;
|SIGUE;
|FPRC;

|PROCESO carga_iva;
|SI #1x ! 0; |O #1z ! 0;
        Iiva = iva1 <-;
        Ibaseiva = baseiva1 <-;
        Icuotiva = cuotiva1 <-;

    |SI contaiva = 0;
            baseiva = baseiva + #1x;
            iva = #1y;
            cuotiva = cuotiva + #1z;
            contaiva = contaiva + 1;
            sw_punt = 0;
    |SINO;
            sw_punt = 1;
        |PARA pepe = 1; |SI pepe [ contaiva; |HACIENDO pepe = pepe + 1;
            |SI iva = #1y;
                |SI sw_punt = 1;
                        baseiva = baseiva + #1x;
                        cuotiva = cuotiva + #1z;
                        sw_punt = 0;
                |FINSI;
            |SINO;
                    Ibaseiva = Ibaseiva + 1;
                    Icuotiva = Icuotiva + 1;
                    Iiva = Iiva + 1;
            |FINSI;
        |SIGUE;

        |SI sw_punt = 1;
                baseiva = baseiva + #1x;
                cuotiva = cuotiva + #1z;
                iva = #1y;
                contaiva = contaiva + 1;
        |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO carga_rec;
|SI #1x ! 0; |O #1z ! 0;
        Irec = rec1 <-;
        Ibaserec = baserec1 <-;
        Icuotrec = cuotrec1 <-;

    |SI contarec = 0;
            baserec = baserec + #1x;
            rec = #1y;
            cuotrec = cuotrec + #1z;
            contarec = contarec + 1;
            sw_punt = 0;
    |SINO;
            sw_punt = 1;
        |PARA pepe = 1; |SI pepe [ contarec; |HACIENDO pepe = pepe + 1;
            |SI rec = #1y;
                |SI sw_punt = 1;
                        baserec = baserec + #1x;
                        cuotrec = cuotrec + #1z;
                        sw_punt = 0;
                |FINSI;
            |SINO;
                    Ibaserec = Ibaserec + 1;
                    Icuotrec = Icuotrec + 1;
                    Irec = Irec + 1;
            |FINSI;
        |SIGUE;
        |SI sw_punt = 1;
                baserec = baserec + #1x;
                cuotrec = cuotrec + #1z;
                rec = #1y;
                contarec = contarec + 1;
        |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO borrapunt;
    Iiva = iva1 <-;
    Ibaseiva = baseiva1 <-;
    Icuotiva = cuotiva1 <-;
    Irec = rec1 <-;
    Ibaserec = baserec1 <-;
    Icuotrec = cuotrec1 <-;
|PARA x = 1; |SI x [ 10; |HACIENDO x = x + 1;
        iva = 0;
        baseiva = 0;
        cuotiva = 0;
        rec = 0;
        baserec = 0;
        cuotrec = 0;
        Ibaseiva = Ibaseiva + 1;
        Icuotiva = Icuotiva + 1;
        Iiva = Iiva + 1;
        Ibaserec = Ibaserec + 1;
        Icuotrec = Icuotrec + 1;
        Irec = Irec + 1;
|FPRC;
______________________________________/ POR PANTALLA
|PROCESO correte;
|CAMPO_POSICION #11#00,0,po; po=po+mas; |CAMPO_POSICION #11#00,1,po;
|CAMPO_POSICION #11#01,0,po; po=po+mas; |CAMPO_POSICION #11#01,1,po;
|CAMPO_POSICION #11#02,0,po; po=po+mas; |CAMPO_POSICION #11#02,1,po;
|CAMPO_POSICION #11#03,0,po; po=po+mas; |CAMPO_POSICION #11#03,1,po;
|CAMPO_POSICION #11#04,0,po; po=po+mas; |CAMPO_POSICION #11#04,1,po;
|CAMPO_POSICION #11#05,0,po; po=po+mas; |CAMPO_POSICION #11#05,1,po;
|CAMPO_POSICION #11#06,0,po; po=po+mas; |CAMPO_POSICION #11#06,1,po;
|CAMPO_POSICION #11#07,0,po; po=po+mas; |CAMPO_POSICION #11#07,1,po;
|CAMPO_POSICION #11#08,0,po; po=po+mas; |CAMPO_POSICION #11#08,1,po;
|CAMPO_POSICION #11#09,0,po; po=po+mas; |CAMPO_POSICION #11#09,1,po;
|CAMPO_POSICION #11#10,0,po; po=po+mas; |CAMPO_POSICION #11#10,1,po;
|FPRC;

|PROCESO lee_iva1;
    sw_fin = 0;
    seleccio = 1;
|HAZ leecuen;
|DDEFECTO #11;
    #11#0 = #1#2;                  || factura
    #11#1 = #1#3;                  || fecha
    #11#2 = #1#4;                  || cuenta
    #11#3 = #1#50;                 || nombre cuenta
    #11#4 = #1#7;                  || descripcion
    #11#5 = #1#08+#1#09+#1#10+#1#52+#1#53;     || base imponible
    #11#6 = #1#14+#1#15+#1#16+#1#56+#1#57;     || cuota iva
    #11#7 = #1#20+#1#21+#1#22+#1#60+#1#60;     || cuota rec.
    #11#8 = #1#23;                 || deducible
    #11#9 = #1#26;                 || total factura
    #11#10 = #1#48;                 || Inversion
|PINDA #0#11;
|SI detalle = 6;
        mas = -1200;
        detalle = 0;
    |PAUSA;
    |SI FSalida = 7;|O FSalida = 1;  sw_fin = 1;  |FINSI;
    |PINPA #0#11;
|SINO;
        mas = 200;
        detalle = detalle + 1;
|FINSI;
|HAZ correte;
|SI sw_fin ! 0;
    |ERROR10;
|FINSI;
|FPRC;
