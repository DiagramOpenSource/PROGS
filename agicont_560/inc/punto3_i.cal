|FICHEROS;
     cacuenta #69;
     cacuentp #70;
     caclipro #71;
|FIN;

|VARIABLES;
    p_lugar = 0;
    p_cuan3 = 0;
    p_cuan4 = 0;
    p_cuan5 = 0;
    p_alfa1 = "";
    p_alfa2 = "";
    p_alfa3 = "";
    p_alfa4 = "";
    &p_alfa5 = "";
    p_alfa6 = "";
    p_nume1 = 0;
    p_nume2 = 0;
    p_ceros = "";
    p_error = 0;
    p_mensa = "    LONGITUD DE CUENTA FUERA DE NIVEL!";
    cue11 = "";
    cue21 = "";
    &cue31 = "";
    sw_no1 = 0;
    varia_co1 = "";
    desde1 = "";
    hasta1 = "";
    num_campo11 = 0;
    p_nif3 = "";
|FIN;

|PROCESO punto3;               || desde calculo 'cuenta'
  |SI salidas = 18;
      num_campo11 = Campo;
      |HAZ cuet1;
      |ACABA;
  |FINSI;
  p_error = 0;
  p_lugar = 0;
  p_cuan3 = 0;
  p_cuan4 = 0;
  p_alfa3 = "";
  p_alfa4 = "";
  p_alfa4 = p_alfa1 > " ";
  p_alfa1 = p_alfa4;
  p_alfa4 = "";
  |PARA p_nume1 = 1; |SI p_nume1 [ 12; |HACIENDO p_nume1 = p_nume1 + 1;
        p_nume2 = (p_nume1 * 100) + 1;
        p_alfa2 = p_alfa1 % p_nume2;
        |SI p_alfa2 ! " ";
            |SI p_alfa2 = ".";
                p_lugar = p_nume1;
            |SINO;
                |SI p_lugar=0; p_alfa3=p_alfa3+p_alfa2; p_cuan3=p_cuan3+1; |FINSI;
                |SI p_lugar!0; p_alfa4=p_alfa4+p_alfa2; p_cuan4=p_cuan4+1; |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |SI p_lugar ! 0;
      |SI dig3 = 1;  p_cuan5 = dig4;  |FINSI;
      |SI dig3 = 2;  p_cuan5 = dig5;  |FINSI;
      |SI dig3 = 3;  p_cuan5 = dig6;  |FINSI;
      |SI dig3 = 4;  p_cuan5 = dig7;  |FINSI;
      |SI dig3 = 5;  p_cuan5 = dig8;  |FINSI;
      |SI dig3 = 6;  p_cuan5 = dig9;  |FINSI;
      p_nume1 = p_cuan5 - (p_cuan3 + p_cuan4);
      |SI p_nume1 > 0;
          cue11 = p_alfa4 % 101;
          p_ceros = "0" * p_nume1;
          p_alfa5 = p_alfa3 + p_ceros + p_alfa4;
          cue11 = p_alfa4 % 101;
          |SI cue11 = "U";  |O cue11 = "A";
              cue31 = cue11;
              |HAZ ultialt2;
          |FINSI;
          #0Campo = p_alfa5;
          |PINTA #0Campo;
      |SINO;
          |MENAV p_mensa;
          p_error = 1;
      |FINSI;
  |SINO;
      p_alfa5 = p_alfa1;
  |FINSI;
|FPRC;

|PROCESO busca_cif13;
    sw_no1 = 1;
    #70#1 = #71#1;  || nombre
    #70#2 = #71#10; || cuenta
|FPRC;

|DEFBUCLE consulta123;
 #71#4;
 ;
 #70#4;
 #70#4;
 ;
 NULL, busca_cif13;
|FIN;

|PROCESO busca_cue13;
    |SI #70#0 = "P";
        p_alfa6 = #69#0;
        p_alfa6 = p_alfa6 % 103;
        |SI p_alfa6 ! "400"; |Y p_alfa6 ! "410"; |Y p_alfa6 ! "523";
            |ACABA;
        |FINSI;
    |FINSI;
     cue31 = #69#2;
     cue31 = cue31 > cue31;
     cue21 = cue31 - cue11;
     |SI cue21 ! cue31; |Y #69#3 = "S";
          |HAZ leepornif3;
          #70#1 = #69#2;
          #70#2 = #69#0;
          #70#4 = p_nif3;
          |PINTA #70#1;
          |PINTA #70#2;
          |PINTA #70#4;
          |PAUSA;
          |SI FSalida = 1;  sw_no1 = 1;  |ERROR10;  |FINSI; ||Esc
          |SI FSalida = 7;  |ERROR10;  |FINSI;    ||Ctrl+C
     |FINSI;
|FPRC;


|DEFBUCLE consulta113;
 #69#1;
 3;
 desde1 , 0, "S";
 hasta1 , 9, "S";
 ;
 NULL, busca_cue13;
|FIN;

|PROCESO cuet1; |TIPO 0;
    sw_no1 = 0;
    |PUSHV 0501 2380;
    |DDEFECTO #70;
    |PINPA #0#70;
    |ENDATOS #1#70;
    |SI FSalida = 0;
         |SI #70#0 ! "F";
             |SI #70#0 ] "1"; |Y #70#0 [ "7";
                  desde1 = #70#0 + "           ";
                  hasta1 = #70#0 + "99999999999";
             |SINO;
                  |SI #70#0 = "C";
                       desde1 = "4300        ";
                       hasta1 = "449999999999";
                  |FINSI;
                  |SI #70#0 = "P";
                       desde1 = "4000        ";
                       hasta1 = "523999999999";
                  |FINSI;
                  |SI #70#0 = "T";
                       desde1 = "            ";
                       hasta1 = "zzzzzzzzzzzz";
                  |FINSI;
             |FINSI;
             cue11 = #70#1; |QBF cue11;
             cue11 = cue11 > cue11;
             |MENSA "0000Pulse <Return> Para Seguir, <Esc> Para Aceptar, <Ctrl+C> Para Abandonar";
             |BUCLE consulta113;
         |SINO;
             |BUCLE consulta123;
             |SI sw_no1 = 0;
                 |MENAV "    CIF no encontrado ...";
             |SINO;
                 #69#0 = #70#2;
                 |PINDA #0#70;
                 |PAUSA;
             |FINSI;
         |FINSI;
    |FINSI;
    |POPV;
    |BLIN 4;
    |SI sw_no1 = 1;
         varia_co1 = #69#0;
         |QBF varia_co1;
         #0num_campo11 = varia_co1;
    |SINO;
         #0num_campo11 = p_alfa1;
    |FINSI;
    |PINTA #0num_campo11;
    Campo = num_campo11;
    |ERROR;
|FPRC;

|PROCESO ultialt2;
  |ABRE #69;
  p_nume2 = p_alfa3;
  p_nume2 = p_nume2 + 1;
  cue11 = p_nume2;
  #69#0 = cue11;
  #69#1 = "0";
  |LEE 021#69];
  |SI FSalida ! 0;
      |LEE 021#69u;
  |SINO;
      |LEE 021#69a;
      |SI FSalida ! 0;
          |LEE 021#69p;
      |FINSI;
  |FINSI;
  cue21 = p_alfa3 % 0;
  p_nume2 = cue21;
  p_nume2 = p_nume2 + 100;
  cue11 = p_nume2;
  cue21 = #69#0 % cue11;
  |SI cue21 = p_alfa3;
      cue21 = #69#0;
      p_nume2 = cue21;
      |SI cue31 = "A";
          p_nume2 = p_nume2 + 1;
      |FINSI;
      p_alfa5 = p_nume2;
  |SINO;
      p_ceros = "0" * p_nume1;
      p_alfa5 = p_alfa3 + p_ceros + "1";
  |FINSI;
  |DDEFECTO #69;
||  |CIERRA #69;
|FPRC;

|PROCESO leepornif3;
 p_nif3 = "               ";
 p_alfa1 = #69#0; p_alfa1 = p_alfa1 % 101;
 |SI p_alfa1 ! "4"; |Y p_alfa1 ! "5";
     |ACABA;
 |FINSI;

 |ABRE #71;
 #71#23 = "C";
 #71#10 = #69#0;
 #71#11 = #69#1;
 |LEE 001#71=;
 |SI FSalida = 0;
     p_nif3 = #71#9;
 |SINO;
     #71#23 = "P";
     #71#10 = #69#0;
     #71#11 = #69#1;
     |LEE 001#71=;
     |SI FSalida = 0;
         p_nif3 = #71#9;
     |FINSI;
 |FINSI;
 |CIERRA #71;
|FPRC;
