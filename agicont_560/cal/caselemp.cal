|FICHEROS;
   caselemp #0;
   caselem1 #1;
   canempre #30;
|FIN;

|VARIABLES;
   Campo1 = 0;
   Cont = 0;
   Linea = 1;

   Directorio = "";
|FIN;

|PROCESO SelecEmp;
   |SI #0#0 = "S";
      |C_M #0#1,1,"S";
      |C_M #0#2,1,"S";
      |C_M #0#3,1,"S";
      |C_M #0#4,1,"S";
      |PARA Cont = 5; |SI Cont [ 62; |HACIENDO Cont = Cont + 3;
         Campo1 = Cont + 1;
         |C_M #0#Cont#,1,"N";
         |C_M #0#Campo1#,1,"N";
      |SIGUE;
   |SINO;
      |C_M #0#1,1,"N";
      |C_M #0#2,1,"N";
      |C_M #0#3,1,"N";
      |C_M #0#4,1,"N";
      |PARA Cont = 5; |SI Cont [ 62; |HACIENDO Cont = Cont + 3;
         Campo1 = Cont + 1;
         |C_M #0#Cont#,1,"S";
         |C_M #0#Campo1#,1,"S";
      |SIGUE;
   |FINSI;
|FPRC;


|PROCESO MiraEmp;
   |SI FSalida = 2; |ACABA; |FINSI;

   Campo1 = Campo - 1;
   |SI #0#Campo1# = 0; |Y #0#Campo# = 0; |ACABA; |FINSI;

   Campo1 = Campo - 1;
   |ABRE #canempre;
   #canempre#2 = #0#Campo1#;
   #canempre#3 = #0#Campo#;
   |LEE 010#canempre.=;
   |SI FSalida ! 0;
      |MENAV "    No existe empresa contable";
      |ERROR;
   |SINO;
      Campo1 = Campo + 1;
      #0#Campo1# = #canempre#1;
      |PINTA #0#Campo1#;
   |FINSI;
   |CIERRA #canempre;
|FPRC;

|PROCESO CreaTemp;
   |DDEFECTO #caselem1;

   #caselem1#0 = Linea;
   Linea = Linea + 1;
   #caselem1#1 = #30#2;
   #caselem1#2 = #30#3;
   |GRABA 020#caselem1.n;
|FPRC;

|DEFBUCLE CreaTemp;
#canempre#1;
;
#0#1,#0#3;
#0#2,#0#4;
;
NULL,CreaTemp;
|FIN;

|PROGRAMA;
   |PUSHV 05012380;
   |CLS;
   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |POPV; |ACABA; |FINSI;

   |DELINDEX #caselem1;
   |ABRE #caselem1;
   |ABRE #canempre;
   |SI #0#0 = "S";
      |DFICB Directorio;
      |PATH_DAT #30 Directorio;
      |BUCLE CreaTemp;
   |SINO;
      |PARA Cont = 5; |SI Cont [ 62; |HACIENDO Cont = Cont + 3;
         Campo1 = Cont + 1;
         #30#2 = #0#Cont#;
         #30#3 = #0#Campo1#;
         |SI #30#2 ! 0;
            |LEE 010#30=;
            |HAZ CreaTemp;
         |FINSI;
      |SIGUE;
   |FINSI;
   |CIERRA #canempre;
   |CIERRA #caselem1;
   |POPV;
|FPRO;
