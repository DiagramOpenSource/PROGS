|FICHEROS;
     cacom110 #00;
     caman110 #20;
|FIN;

|VARIABLES;
    mensaje = "Imprimiendo ...";
    sw = 0;
    campo = 0;
    antes = 0;
    diferen = 0;
    desdemes = 0;
    hastames = 0;
    meses = 0;
    campotB  = 0;
    campotR  = 0;
    campobas = 0;
    camporet = 0;
    campoexen = 0;
    swsuma1   = 0;
    swsuma2   = 0;
    informe   = "";
    numf      = 0;
    se_factu  = "";
    se_perio  = 0;

    mas = 0;
    campofec = 0;
    p_mes = "";
    fecsys = @;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    mensa0= "    Proceso ABORTADO !!!";
    peri  = 0;

    destra = 0;
    hastra = 0;
    d_cla = "";
    h_cla = "";
    nume0 = 0;
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    yaesta1 = 0;
    yaesta2 = 0;
    yaesta3 = 0;
    no_vale = 0;

    sw_acumula = 0;
    des_emp = 0;
    has_emp = 0;
    grupo = 0;
    atri = "";
    estado = 0;
    tiposel = "";
    CampoArchiv = 0;

   &periodo = 0;
   &perialf = "";
   &dia     = "";
   &mes     = "";
   &anyo    = "";

|FIN;

|INCLUYE acceso_i;

|| ****************************************************************
|PROCESO Mayus; |TIPO 0;
  #0Campo = #0Campo > #0Campo; |PINTA #0Campo;
|FPRC;

|PROCESO defecto; |TIPO 7; ||calcula el periodo por defecto segun fecha sistema
  #0#0   = cod1;       |PINTA #0#0;
  #0#1   = #30#1;      |PINTA #0#1;
  #0#2   = #30#26;     |PINTA #0#2;
|FPRC;

|PROCESO pintames; |TIPO 0;
  |SI #0Campo =  1;  p_mes = "1§ Trimes.";  |FINSI;
  |SI #0Campo =  2;  p_mes = "2§ Trimes.";  |FINSI;
  |SI #0Campo =  3;  p_mes = "3§ Trimes.";  |FINSI;
  |SI #0Campo =  4;  p_mes = "4§ Trimes.";  |FINSI;
  |PINTA 1539, p_mes;
|FPRC;

|PROCESO mirames; |TIPO 7; ||calcula el mes por defecto segun fecha sistema
  fecsys = ~;
  alfa1 = fecsys;
  alfa1 = alfa1 % 402;
  |SI alfa1 = "01"; #0Campo = 1; |FINSI;
  |SI alfa1 = "02"; #0Campo = 1; |FINSI;
  |SI alfa1 = "03"; #0Campo = 1; |FINSI;
  |SI alfa1 = "04"; #0Campo = 2; |FINSI;
  |SI alfa1 = "05"; #0Campo = 2; |FINSI;
  |SI alfa1 = "06"; #0Campo = 2; |FINSI;
  |SI alfa1 = "07"; #0Campo = 3; |FINSI;
  |SI alfa1 = "08"; #0Campo = 3; |FINSI;
  |SI alfa1 = "09"; #0Campo = 3; |FINSI;
  |SI alfa1 = "10"; #0Campo = 4; |FINSI;
  |SI alfa1 = "11"; #0Campo = 4; |FINSI;
  |SI alfa1 = "12"; #0Campo = 4; |FINSI;
  |PINTA #0Campo;
|FPRC;

|PROCESO mes;
  dia  = #0#4 % 102;
  mes  = #0#4 % 402;
  anyo = #0#4 % -101;

  |SI mes = "01"; mes = "Enero     "; |FINSI;
  |SI mes = "02"; mes = "Febrero   "; |FINSI;
  |SI mes = "03"; mes = "Marzo     "; |FINSI;
  |SI mes = "04"; mes = "Abril     "; |FINSI;
  |SI mes = "05"; mes = "Mayo      "; |FINSI;
  |SI mes = "06"; mes = "Junio     "; |FINSI;
  |SI mes = "07"; mes = "Julio     "; |FINSI;
  |SI mes = "08"; mes = "Agosto    "; |FINSI;
  |SI mes = "09"; mes = "Septiembre"; |FINSI;
  |SI mes = "10"; mes = "Octubre   "; |FINSI;
  |SI mes = "11"; mes = "Noviembre "; |FINSI;
  |SI mes = "12"; mes = "Diciembre "; |FINSI;
|FPRC;

|| ****************************************************************
|| **** calculos de lectura de empresa ****************************
|| ****************************************************************
|PROCESO a_imprimir;
  sw = 1;
  |PDEFECTO #0,7,16;
  desdemes = 0;
  |SI #0#5 =  3; desdemes =  1; perialf = " 1T"; |FINSI;
  |SI #0#5 =  6; desdemes =  4; perialf = " 2T"; |FINSI;
  |SI #0#5 =  9; desdemes =  7; perialf = " 3T"; |FINSI;
  |SI #0#5 = 12; desdemes = 10; perialf = " 4T"; |FINSI;

  |PARA meses = desdemes; |SI meses [ #0#5;  |HACIENDO meses = meses + 1;

        campobas = meses +  22; camporet = meses +  35;
        campotB = 0;
        |SI #20#12 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#12 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#12 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#12 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;

        campobas = meses +  48; camporet = meses +  61;
        campotB = 0;
        |SI #20#13 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#13 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#13 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#13 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;

        campobas = meses +  74; camporet = meses +  87;
        campotB = 0;
        |SI #20#14 = "G"; campotB = 7;  campotR = 8;  |FINSI;
        |SI #20#14 = "H"; campotB = 9;  campotR = 10; |FINSI;
        |SI #20#14 = "K"; campotB = 11; campotR = 12; |FINSI;
        |SI #20#14 = "L"; campotB = 13; campotR = 14; |FINSI;
        |SI campotB ! 0;
            #0campotB = #0campotB + #20campobas;
            #0campotR = #0campotR + #20camporet;
        |FINSI;
  |SIGUE;

  #0#15 = #0#8 + #0#10 + #0#12 + #0#14;
  |PRINT;
|FPRC;

|DEFBUCLE por_nif;
  #20#2;
  0,1,134;
  "               ", #0#0, #0#3, #0#2;
  "zzzzzzzzzzzzzzz", #0#0, #0#4, #0#2;
  be;
  NULL, a_imprimir;
|FIN;

|DEFBUCLE por_numero;
  #20#1;
  ;
  #0#0, #0#3, #0#2;
  #0#0, #0#4, #0#2;
  be;
  NULL, a_imprimir;
|FIN;

|| *************************************** PROGRAMA TIPO 3
|PROCESO imprime; |TIPO 3;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |INFOR "cacom110";
  |SI FSalida ! 0;
      |FINIMP;
      |ACABA;
  |FINSI;

  |SI #0#5 = 1; peri = 3;  |FINSI;
  |SI #0#5 = 2; peri = 6;  |FINSI;
  |SI #0#5 = 3; peri = 9;  |FINSI;
  |SI #0#5 = 4; peri = 12; |FINSI;

  #0#5 = peri;
  des_emp = #0#0;
  has_emp = #0#0;

  sw = 0;
  |SI #0#6 = 1;
      |BUCLE por_numero;
  |SINO;
      |BUCLE por_nif;
  |FINSI;
  |SI sw = 1; |PIEINF; |FINSI;
  |FININF;
  |FINIMP;
|FPRC;
