|FICHEROS;
  camocab2 #0;
  camocabe #2;
  camoline #1;
|FIN;

|VARIABLES;
  &fec_am = @;
  &imp_am = 0;
  &c_am = "";
  alfa1 = "";
  xx = 0;
  sw_er = 0;
  any = "";
  estado = 0;
  linea = 0;
  impcom = 0;
  p = 0;
    &entrada = 1;
    &sw_lin = 0;
    doce = "            ";
    sw = 0;
    long = 0;
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    salidas = 0;
|FIN;

|INCLUYE inicio_i;
|INCLUYE puntos_i;
|INCLUYE numamo_i;

|| .... Calculos de los campos por pantalla.
/*
|PROCESO tracodi; |TIPO 0;
  |CAMPO_MODIFICA #0#1, 1, "S";
  alfa1 = #0#0;
  alfa2 = alfa1;
  |QBF alfa2;
  |SI alfa2 = ""; |ERROR; |ACABA; |FINSI;
  #2#0 = #0#0;
  #2#1 = 00;
  |LEE 011#2=;
  |SI FSalida ! 0;
      |CAMPO_MODIFICA #0#1, 1, "N";
      #0#1 = 0;
      |PINTA #0#1;
      |ACABA;
  |FINSI;
|FPRC;
*/

|PROCESO numamo; |TIPO 6;
  x_entra = entrada;
  x_alfa1 = #0Campo;
  |HAZ x_punto;
  #0Campo = x_alfa1;
  |PINTA #0Campo;
|FPRC;

|PROCESO fecha_venta;
  #0#23 = #0#29;
  |PINTA #0#23;
|FPRC;
|| ======================================================================

|PROGRAMA;
  |HAZ inicio;
  |ABRET #2;
|ET empieza;
  |DDEFECTO #2;
  |PINPA #0#0;
 |HAZ def_campos;
       |SI sw_er = 1;
           |CIERRA #2;
           |ACABA;
       |FINSI;
  |PINDA #0#0;
  |ENDATOS #1#0;
  |SI FSalida = 0;
       |HAZ actualiza;
  |SINO;
       |CONFI "2400SINTRODUCCION NO CONFORME. ¨ Elegir otro Elemento? ";
       |SI FSalida = 0;
           |VETE empieza;
       |FINSI;
  |FINSI;
  |CIERRA #2;
|FPRO;

|PROCESO def_campos;
|ET otro;
  sw_er = 0;
  linea = 0;
  impcom = 0;
  |DDEFECTO #0;

  |ENCAMPO #0#0;
  |SI FSalida ! 0; sw_er = 1; |ACABA; |FINSI;
  |ENCAMPO #1#0;
  |SI FSalida ! 0; sw_er = 1; |ACABA; |FINSI;

  #2#0 = #0#0;
  #2#1 = #0#1;
  |LEE 011#2=;
  estado = FSalida;
  |SI FSalida ! 0;
      |MENAV "0000El Elemento NO existe";
      sw_er = 2; |VETE otro;
  |SINO;
      |HAZ tracod2;
      |SI sw_er = 1; |ACABA; |FINSI;
      |SI sw_er = 2; |VETE otro; |FINSI;
      |PARA xx = 2; |SI xx [ 23; |HACIENDO xx = xx + 1;
            #0xx = #2xx;
      |SIGUE;
  |FINSI;

  #0#23 = fec_am;

  #0#24 = linea;
  any   = #0#23 % -104; #0#25 = any;
  #0#26 = "V";
  #0#27 = imp_am;
  #0#28 = c_am;
  #0#29 = fec_am;
  #0#30 = "S";
|FPRC;

|PROCESO actualiza;
  |DDEFECTO #2;
  #0#23 = #0#29;
  |PARA xx = 0; |SI xx [ 23; |HACIENDO xx = xx + 1;
        #2xx = #0xx;
  |SIGUE;
  #2#28 = #0#31;

  |SI estado = 0;
      |GRABA 011#2a;
      |LIBERA #2;
  |SINO;
      |GRABA 011#2n;
      |LIBERA #2;
  |FINSI;

  |ABRE #1;
  #1#0 = #2#0;
  #1#1 = #2#1;
  #1#2 = #0#24;
  |LEE 000#1=;
  estado = FSalida;
    #1#0 = #2#0;  #1#1 = #2#1;  #1#2 = #0#24;
    #1#3 = #0#25; #1#4 = #0#26; #1#5 = #0#27;
    #1#6 = #0#30; #1#7 = #0#29; #1#8 = #0#28;
    #1#9 = #0#27;
  |SI estado = 0;
      |GRABA 011#1a;
      |LIBERA #1;
  |SINO;
      |GRABA 011#1n;
      |LIBERA #1;
  |FINSI;
  |CIERRA #1;
|FPRC;

|PROCESO tracod2;  || Existe
  |SI #2#23 > "00.00.0000";
      |MENAV "0000El Elemento Ya esta vendido. ";
      sw_er = 2;
      |ACABA;
  |FINSI;
/*  |CONFI "2400S¨ Elemento correcto ? ";
    |SI FSalida ! 0;
        sw_er = 1;
        |CONFI "2400S¨Introducir otro codigo de Elemento? ";
        |SI FSalida = 0;
            sw_er = 2;
        |FINSI;
        |ACABA;
     |FINSI;
*/
  |HAZ lineas;
|FPRC;

|PROCESO vercom;
  linea = #1#2;
|FPRC;

|PROCESO lineas;
  linea = 0;
  |ABRE #1;
  |BUCLELIN 0vercom#2;
  |CIERRA #1;
/*
  |PINTA 2007, #1#2;
  |PINTA 2012, #1#3;
  |PINTA 2019, #1#7;
  |PINTA 2032, #1#4;
  |PINTA 2036, #1#8;
  |PINTA 2066, #1#5;
  |PINTA 2078, #1#6;
*/
  linea = linea + 1;
/*
|CAMPO_POSICION #0#24,0,p; p=p+100; |CAMPO_POSICION #0#24,1,p;
|CAMPO_POSICION #0#25,0,p; p=p+100; |CAMPO_POSICION #0#25,1,p;
|CAMPO_POSICION #0#26,0,p; p=p+100; |CAMPO_POSICION #0#26,1,p;
|CAMPO_POSICION #0#27,0,p; p=p+100; |CAMPO_POSICION #0#27,1,p;
|CAMPO_POSICION #0#28,0,p; p=p+100; |CAMPO_POSICION #0#28,1,p;
|CAMPO_POSICION #0#29,0,p; p=p+100; |CAMPO_POSICION #0#29,1,p;
|CAMPO_POSICION #0#30,0,p; p=p+100; |CAMPO_POSICION #0#30,1,p;
*/

|FPRC;
