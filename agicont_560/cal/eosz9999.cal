|FICHEROS;
|FIN;

|VARIABLES;
     Directorio  = "";
     nCanal      = 0;
     nPara       = 0;
     aNombreIP   = "";
     aAlfa       = "";
     aFichero    = "";
     aAlfa1      = "";
     aFichOrigen = "";
     aFichDestin = "";

     aAbre       = "";
     nHandle     = 0;
     &aNomAux    = "";
     &aNombre    = "";

     &eaTipoEmi    = "";
     &eaTipoSec    = "";
     &eaEjecutable = "";
     &eaFichCol    = "";
     &eaUnidad     = "";
     &enAnyo       = 0;

     {700}&NEmpresas = "";
|FIN;

|PROCESO CopiaFichero;
     aAlfa1 = "";
     |IP_REMOTO aAlfa1;  |QBT aAlfa1;
     |SI aAlfa1 ! "";
         |ENVIA_FICHERO aFichOrigen, aFichDestin;
     |SINO;
         |COPIA_FICHERO aFichOrigen, aFichDestin;
     |FINSI;
|FPRC;

|PROCESO Validacion347;
     aFichOrigen = Directorio + "hacienda/i347pr00.exe";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/i347pr00.exe";
     |HAZ CopiaFichero;

     aAbre = "\MODELOS\" + eaTipoSec + "\imprime.bat";
     |XABRE "CW", aAbre, nHandle;

     aAlfa = "CD \MODELOS\" + eaTipoSec;
     |XGRABA nHandle, aAlfa;

     aAlfa = "i347pr00 -y";
     |XGRABA nHandle, aAlfa;

     aAlfa = "WAIT VSU347.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del \MODELOS\" + eaTipoSec + "\I347PR00.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del VSU*.*";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del UNINST.ISU";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del LEAME.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del SIGLAS.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del DELEG.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del PAISES.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del PROVINCI.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ADMON.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ERRORES.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del WAIT.EXE";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del i347pr00";
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;

     aAlfa = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO CopiaDiskette;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     |SI eaTipoSec = "190"; |O eaTipoSec = "180";
        |SI enAnyo ] 2001;
           aAlfa = "COPY /MODELOS/" + eaTipoSec + "/" + eaFichCol + " " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + eaFichCol;
           |RSYSTEM aAlfa;

           aAlfa = "COPY /MODELOS/" + eaTipoSec + "/" + eaFichCol + ".car " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + eaFichCol + ".car";
           |RSYSTEM aAlfa;
        |SINO;
           aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/" + eaFichCol;
           aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
           |HAZ CopiaFichero;

           aAlfa = "COPY /MODELOS/" + eaTipoSec + "/" + eaFichCol + " " + eaUnidad + ":";
           |RSYSTEM aAlfa;

           aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + eaFichCol;
           |RSYSTEM aAlfa;
        |FINSI;

        |ACABA;
     |FINSI;

     |SI eaTipoSec = "347"; |O eaTipoSec = "348";
         |QBF aNomAux;
         |SI aNomAux = ""; aNomAux = "auxiliar.txt"; |FINSI;
         aAlfa = "COPY /MODELOS/" + eaTipoSec + "/" + eaFichCol + " " + eaUnidad + ":";
         |RSYSTEM aAlfa;

         aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + eaFichCol;
         |RSYSTEM aAlfa;

         aAlfa = "COPY /MODELOS/" + eaTipoSec + aNomAux + " " + eaUnidad + ":";
         |RSYSTEM aAlfa;

         aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + aNomAux;
         |RSYSTEM aAlfa;

         |ACABA;
     |FINSI;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/" + eaFichCol;
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aAlfa = "COPY /MODELOS/" + eaTipoSec + "/" + eaFichCol + " " + eaUnidad + ":";
     |RSYSTEM aAlfa;

     aAlfa = "DEL /MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO Laser190;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108);
           aFichDestin = "/MODELOS/" + eaTipoSec + "/" + (NEmpresas % -108);
           |HAZ CopiaFichero;

           |SI eaTipoSec = "190"; |O eaTipoSec = "180";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108) + ".car";
               aFichDestin = "/MODELOS/" + eaTipoSec + "/" + (NEmpresas % -108) + ".car";
               |HAZ CopiaFichero;
           |FINSI;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;
|FPRC;

|PROCESO Verifica190;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol + ".car";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol + ".car";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;
|FPRC;

|PROCESO Verifica180;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     |SI enAnyo = 2001;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/i180pr01.exe";
         aFichDestin = "/MODELOS/" + eaTipoSec + "/i180pr01.exe";
         |HAZ CopiaFichero;
     |FINSI;

     |SI enAnyo = 2002;
         Directorio  = "";  |DBASE Directorio;
         aFichOrigen = Directorio + "hacienda/zpr02180.exe";
         aFichDestin = "/MODELOS/" + eaTipoSec + "/zpr02180.exe";
         |HAZ CopiaFichero;
     |FINSI;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol + ".car";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol + ".car";
     |HAZ CopiaFichero;

     aAbre = "\MODELOS\" + eaTipoSec + "\verifica.bat";
     |XABRE "CW", aAbre, nHandle;

     aAlfa = "CD \MODELOS\" + eaTipoSec;
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "I180PR01 -y";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "ZPR02180 -y";  |FINSI;
     |XGRABA nHandle, aAlfa;

     aAlfa = "WAIT vs180 /E:" + eaFichCol + " /R:" + eaFichCol + ".txt /A:" + eaFichCol + ".car";
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "del \MODELOS\" + eaTipoSec + "\I180PR01.EXE";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "del \MODELOS\" + eaTipoSec + "\ZPR02180.EXE";  |FINSI;
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.TAB";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.DLL";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del ERROR180.TXT";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.WMF";
     |XGRABA nHandle, aAlfa;

     aAlfa = "del *.EXE";
     |XGRABA nHandle, aAlfa;

     |SI enAnyo = 2001;  aAlfa = "del i180pr01";  |FINSI;
     |SI enAnyo = 2002;  aAlfa = "del zls02180";  |FINSI;
     |XGRABA nHandle, aAlfa;

     |XCIERRA nHandle;
     aAlfa1 = "/MODELOS/" + eaTipoSec + "/verifica.bat";
     |RSYSTEM aAlfa1;
|FPRC;

|PROCESO Laser;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108);
           aFichDestin = "/MODELOS/" + eaTipoSec + "/" + (NEmpresas % -108);
           |HAZ CopiaFichero;

           |SI eaTipoSec = "190"; |O eaTipoSec = "180";  |O eaTipoSec = "347";  |O eaTipoSec = "348";
               aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + (NEmpresas % -108) + ".car";
               aFichDestin = "/MODELOS/" + eaTipoSec + "/" + (NEmpresas % -108) + ".car";
               |HAZ CopiaFichero;
           |FINSI;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;


     aAlfa1 = "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;

     aAlfa1 = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |RFBORRA aAlfa1;

     aAlfa1 = "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |RFBORRA aAlfa1;

     INEmpresas = NEmpresas1 <-;
     |PARA nPara = 1; |SI nPara [ 700; |HACIENDO nPara = nPara + 1;
           |SI NEmpresas = ""; |SAL; |FINSI;

           aAlfa1 = "/MODELOS/" + eaTipoSec + "/" + (NEmpresas % -108);
           |RFBORRA aAlfa1;

           INEmpresas = INEmpresas + 1;
     |SIGUE;

     |HAZ Errores;
|FPRC;

|PROCESO Verifica347;
     aAlfa = "/MODELOS";                      |RMKDIR aAlfa;
     aAlfa = "/MODELOS/" + eaTipoSec;         |RMKDIR aAlfa;

     aAlfa = "/MODELOS/" + eaTipoSec + "/";
     aAlfa1 = "attrib " + aAlfa + "*.* -r"; |RSYSTEM aAlfa1;
     |R_PDIR aAlfa;
     |PARA; |SI FSalida = 0; |HACIENDO;
            |RFBORRA aAlfa;
            |R_SDIR aAlfa;
     |SIGUE;

     Directorio  = "";  |DBASE Directorio;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaEjecutable + ".exe";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaEjecutable + ".exe";
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + eaFichCol;
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + eaFichCol;
     |HAZ CopiaFichero;

     |QBF aNomAux;
     |SI aNomAux = ""; aNomAux = "auxiliar.txt"; |FINSI;
     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/" + aNomAux;
     aFichDestin = "/MODELOS/" + eaTipoSec + "/" + aNomAux;
     |HAZ CopiaFichero;

     aFichOrigen = Directorio + "hacienda/" + eaTipoSec + "/DIRECTA/imprime.bat";
     aFichDestin = "/MODELOS/" + eaTipoSec + "/imprime.bat";
     |HAZ CopiaFichero;

     aAlfa1 = "/MODELOS/" + eaTipoSec + "/imprime";
     |RSYSTEM aAlfa1;
|FPRC;

|PROGRAMA;
     Directorio  = "";  |DBASE Directorio;

     |SI eaTipoEmi = "COPIA";
         |HAZ CopiaDiskette;
         |ACABA;
     |FINSI;

     |SI eaTipoEmi = "ERRORES190"; |O eaTipoEmi = "ERRORES180";
         |SI enAnyo [ 1999;
             |CONFI "0000SHA TERMINADO DE IMPRIMIR TODOS LOS IMPRESOS ";
         |SINO;
             FSalida = 0;
         |FINSI;
         |SI FSalida = 0;
             |HAZ Errores;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI eaTipoEmi = "ERRORES";
         |HAZ Errores;
         |ACABA;
     |FINSI;

     |SI eaTipoSec = "190"; |O eaTipoSec = "180";
         |SI eaTipoEmi = "VERIF190";    |HAZ Verifica190;  |ACABA;  |FINSI;
         |SI eaTipoEmi = "VERIF180";    |HAZ Verifica180;  |ACABA;  |FINSI;

         |HAZ Laser190;
         |ACABA;
     |FINSI;

     |SI eaTipoSec = "347"; |O eaTipoSec = "348";
         |SI eaTipoEmi = "VERIF347";    |HAZ Verifica347;  |ACABA;  |FINSI;
     |FINSI;

     |HAZ Laser;
|FPRO;
