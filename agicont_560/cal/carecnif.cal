|FICHEROS;
    carecnif #0;
    caclipro #1;
    caivarep #2;
    caivasop #3;
    camanban #4;
    camal347 #5;
    camil347 #6;
    camal349 #7;
|FIN;

|VARIABLES;
 swnif = 0;
 xxx   = 0;
     letrasnif = "TRWAGMYFPDXBNJZSQVHLCKE";
     letra = "";
     alfa1 = "";
     alfa2 = "";
     final = "";
     x = "";
     nume1 = 0;
     nume2 = 0;
     lugar = 0;
     nifnum = 0;
     resto = 0;

    conta = 0;
    anyo = "";
    c    = 0;
    trabajo = "";
|FIN;

|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

|PROCESO letranif;
    swnif = 0;                 || inicializa el switch
    alfa1 = trabajo;           || recoge valor en variable trabajo
    |QBF alfa1;                || le quita los espacios en blanco
    final = "";                || inicializa variable de trabajo
  x = trabajo % 101;
  |SI x ! "A"; |Y x ! "B"; |Y x ! "C"; |Y x ! "D"; |Y x ! "E"; |Y x ! "F";
   |Y x ! "G"; |Y x ! "P"; |Y x ! "Q"; |Y x ! "S"; |Y x ! "X";
      final = "";
      alfa2 = alfa1 % 0;
      nume1 = alfa2;
      |PARA nume2 = 1;  |SI nume2 [ nume1;  |HACIENDO nume2 = nume2 + 1;
            lugar = (nume2 * 100) + 1;
            alfa2 = alfa1 % lugar;
            |SI alfa2 = "0"; |O alfa2 = "1";|O alfa2 = "2"; |O alfa2 = "3";
             |O alfa2 = "4"; |O alfa2 = "5";|O alfa2 = "6";
             |O alfa2 = "7"; |O alfa2 = "8";|O alfa2 = "9";
                final = final + alfa2;
            |FINSI;
      |SIGUE;
      nifnum = final;
      |SI nifnum ! 0; |Y final ! "";
          resto   = nifnum $ 23;
          resto   = resto + 1;
          lugar   = (resto * 100) + 1;
          letra   = letrasnif % lugar;
          final   = ("000000000" + final + letra) % -109;
          trabajo = final;
      |FINSI;
   |SINO;
         swnif = 1;                 || no es bueno y no graba
   |FINSI;
|FPRC;
|| *************************************************************************

|| ------------ Clientes / Proveedores
|PROCESO clipro;
 trabajo = #1#9;
 |HAZ letranif;
 |SI swnif = 0;
     #1#9 = trabajo;
     |GRABA 020#1a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #1;
|FPRC;

|DEFBUCLE caclipro;
#1#1;
;
" ", "            ", 0;
"z", "zzzzzzzzzzzz", 9;
be;
NULL, clipro;
|FIN;
|| ******************************************************************
|| ------------ IVA Repercutido
|PROCESO ivarep;
 trabajo = #2#51;
 |HAZ letranif;
 |SI swnif = 0;
     #2#51 = trabajo;
     |GRABA 020#2a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #2;
|FPRC;

|DEFBUCLE caivarep;
#2#1;
;
00, 000001, "  ";
99, 999999, "zz";
be;
NULL, ivarep;
|FIN;
|| ******************************************************************
|| ------------ IVA Soportado
|PROCESO ivasop;
 trabajo = #3#51;
 |HAZ letranif;
 |SI swnif = 0;
     #3#51 = trabajo;
     |GRABA 020#3a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #3;
|FPRC;

|DEFBUCLE caivasop;
#3#1;
;
00, 000001, "  ";
99, 999999, "zz";
be;
NULL, ivasop;
|FIN;
|| ******************************************************************
|| ------------ Bancos
|PROCESO manban;
 trabajo = #4#14;
 |HAZ letranif;
 |SI swnif = 0;
     #4#14 = trabajo;
     |GRABA 020#4a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #4;
|FPRC;

|DEFBUCLE camanban;
#4#1;
;
001;
999;
be;
NULL, manban;
|FIN;
|| ******************************************************************
|| ------------ Lineas 347
|PROCESO mal347;
 trabajo = #5#3;
 |HAZ letranif;
 |SI swnif = 0;
     #5#3 = trabajo;
     |GRABA 020#5a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #5;
|FPRC;

|DEFBUCLE camal347;
#5#1;
;
00001, 00001;
99999, 99999;
be;
NULL, mal347;
|FIN;
|| ******************************************************************
|| ------------ Lineas Inmuebles Modelo 347
|PROCESO mil347;
 trabajo = #6#2;
 |HAZ letranif;
 |SI swnif = 0;
     #6#2 = trabajo;
     |GRABA 020#6a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #6;
|FPRC;

|DEFBUCLE camil347;
#6#1;
;
00001, 00001;
99999, 99999;
be;
NULL, mil347;
|FIN;
|| ******************************************************************

|| ------------ Lineas 349
|PROCESO mal349;
 trabajo = #7#6;
 |HAZ letranif;
 |SI swnif = 0;
     #7#6 = trabajo;
     |GRABA 020#7a;
     |HAZ pinta;
 |FINSI;
 |LIBERA #7;
|FPRC;

|DEFBUCLE camal349;
#7#1;
;
00001, 00, 0, 001;
99999, 99, 9, 999;
be;
NULL, mal349;
|FIN;
|| ******************************************************************


|PROCESO pinta;
c = c + 1;

|PINTA 2226, c;
|FPRC;

|PROCESO tipo_3; |TIPO 3;
 |NOPARA;
 |SI #0#0 = "SI";
     |PINTA 2226, "         ";
     |PINTA 2126, "Clientes y Proveedores             ";  c = 0; |BUCLE caclipro;

     |PINTA 2226, "         ";
     |PINTA 2126, "Registro de IVA Repercutido        ";  c = 0; |BUCLE caivarep;

     |PINTA 2226, "         ";
     |PINTA 2126, "Registro de IVA Soportado          ";  c = 0; |BUCLE caivasop;

     |PINTA 2226, "         ";
     |PINTA 2126, "Ficha de Bancos                    ";  c = 0; |BUCLE camanban;

     |PINTA 2226, "         ";
     |PINTA 2126, "Lineas Modelo 347                  ";  c = 0; |BUCLE camal347;

     |PINTA 2226, "         ";
     |PINTA 2126, "Lineas Relacion Inmuebles 347      ";  c = 0; |BUCLE camil347;

     |PINTA 2226, "         ";
     |PINTA 2126, "Lineas Modelo 349                  ";  c = 0; |BUCLE camal349;
 |FINSI;
 |SIPARA;
|FPRC;
