|FICHEROS;
   caver390 #0;
   caivarep #1;
   caivasop #2;
   cacon300 #3;
   cama3390 #4;
   canempre #30;
|FIN;

|VARIABLES;
   Cont = 0;
   Cont1 = 0;
   Campo1 = 0;
   Campo2 = 0;

   Comodin  = "";
   Comodin1 = "";
   Pasa = 0;
   anyo = 0;

   Empresa = 0;
   Periodo = 0;
   EmpAct = 0;
   PerAct = 0;

   Emp1 = 0;
   Per1 = 0;
   Emp2 = 0;
   Per2 = 0;
   SwPrint = 0;

   Base = 0;
   Cuota = 0;

   Base104 = 0;  Base107 = 0;  Base116 = 0;     || Datos regimen ordinario
   Cuota104 = 0; Cuota107 = 0; Cuota116 = 0;

   Base204 = 0;  Base207 = 0;  Base216 = 0;     || Datos Bienes usados
   Cuota204 = 0; Cuota207 = 0; Cuota216 = 0;

   Base304 = 0;  Base307 = 0;  Base316 = 0;     || Datos Antiguedades
   Cuota304 = 0; Cuota307 = 0; Cuota316 = 0;

   Base416 = 0; Cuota416 = 0;                   || Datos Agencias de viajes

   Base504 = 0;  Base507 = 0;  Base516 = 0;     || Datos determinacion proporcional
   Cuota504 = 0; Cuota507 = 0; Cuota516 = 0;

   Base604 = 0;  Base607 = 0;  Base616 = 0;     || Datos adquisiciones intrac.
   Cuota604 = 0; Cuota607 = 0; Cuota616 = 0;

   BaseRec1 = 0;  BaseRec2 = 0;  BaseRec3 = 0;  BaseRec4 = 0;    || Datos recargo equivalencia
   CuotaRec1 = 0; CuotaRec2 = 0; CuotaRec3 = 0; CuotaRec4 = 0;

   BaseSop  = 0; CuotaSop  = 0;
   BaseSop1 = 0; CuotaSop1 = 0;
   BaseSop2 = 0; CuotaSop2 = 0;
   BaseSop3 = 0; CuotaSop3 = 0;
   BaseSop4 = 0; CuotaSop4 = 0;
   BaseSop5 = 0; CuotaSop5 = 0;
   BaseSop6 = 0; CuotaSop6 = 0;
   BaseSop7 = 0; CuotaSop7 = 0;

   &Casilla     = "";
   &DescIncid   = "";
   &CantCalculo = 0;
   &CantModelo  = 0;

|FIN;

|PROCESO Seleccion;
   |SI #caver390#0 = "S";
      |PARA Cont = 6; |SI Cont [ 63; |HACIENDO Cont = Cont + 1;
         Campo1 = Cont + 1;
         Campo2 = Cont + 2;
         |C_M #caver390#Cont#,1,"N";
         |C_M #caver390#Campo1#,1,"N";
         |C_M #caver390#Campo2#,1,"N";
      |SIGUE;
      |C_M #caver390#1,1,"S";
      |C_M #caver390#2,1,"S";
      |C_M #caver390#3,1,"S";
      |C_M #caver390#4,1,"S";
   |SINO;
      |PARA Cont = 6; |SI Cont [ 63; |HACIENDO Cont = Cont + 3;
         Campo1 = Cont + 1;
         Campo2 = Cont + 2;
         |C_M #caver390#Cont#,1,"S";
         |C_M #caver390#Campo1#,1,"S";
         |C_M #caver390#Campo2#,1,"S";
      |SIGUE;
      |C_M #caver390#1,1,"N";
      |C_M #caver390#2,1,"N";
      |C_M #caver390#3,1,"N";
      |C_M #caver390#4,1,"N";
   |FINSI;
|FPRC;

|PROCESO Repercutido;
   #cacon300#0 = #caivarep#6;
   |LEE 010#cacon300.=;
   |SI FSalida = 0;
      |SI #cacon300#2 = 2;                  || Adquisiciones intracomunitarias
         |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
            Base  = Cont1 - 3;
            Cuota = Cont1 + 3;
            |SI #caivarep#Cont1# = 16;
               Base616  = Base616  + #caivarep#Base#;
               Cuota616 = Cuota616 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI #caivarep#Cont1# = 7;
               Base607  = Base607  + #caivarep#Base#;
               Cuota607 = Cuota607 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI #caivarep#Cont1# = 4;
               Base604  = Base604  + #caivarep#Base#;
               Cuota604 = Cuota604 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI Cont1 = 13; Cont1 = 53; |FINSI;
         |SIGUE;
      |SINO;
         |SI #cacon300#4 = 1;                     || Regimen Ordinario
            |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
               Base  = Cont1 - 3;
               Cuota = Cont1 + 3;
               |SI #caivarep#Cont1# = 16;
                  Base116  = Base116  + #caivarep#Base#;
                  Cuota116 = Cuota116 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 7;
                  Base107  = Base107  + #caivarep#Base#;
                  Cuota107 = Cuota107 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 4;
                  Base104  = Base104  + #caivarep#Base#;
                  Cuota104 = Cuota104 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI Cont1 = 13; Cont1 = 53; |FINSI;
            |SIGUE;
         |FINSI;
         |SI #cacon300#4 = 2;                     || Bienes usados
            |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
               Base  = Cont1 - 3;
               Cuota = Cont1 + 3;
               |SI #caivarep#Cont1# = 16;
                  Base216  = Base216  + #caivarep#Base#;
                  Cuota216 = Cuota216 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 7;
                  Base207  = Base207  + #caivarep#Base#;
                  Cuota207 = Cuota207 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 4;
                  Base204  = Base204  + #caivarep#Base#;
                  Cuota204 = Cuota204 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI Cont1 = 13; Cont1 = 53; |FINSI;
            |SIGUE;
         |FINSI;
         |SI #cacon300#4 = 3;                     || Antiguedades
            |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
               Base  = Cont1 - 3;
               Cuota = Cont1 + 3;
               |SI #caivarep#Cont1# = 16;
                  Base216  = Base216  + #caivarep#Base#;
                  Cuota216 = Cuota216 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 7;
                  Base207  = Base207  + #caivarep#Base#;
                  Cuota207 = Cuota207 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 4;
                  Base204  = Base204  + #caivarep#Base#;
                  Cuota204 = Cuota204 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI Cont1 = 13; Cont1 = 53; |FINSI;
            |SIGUE;
         |FINSI;
         |SI #cacon300#4 = 4;                     || Agencias de viajes
            |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
               Base  = Cont1 - 3;
               Cuota = Cont1 + 3;
               |SI #caivarep#Cont1# = 16;
                  Base416  = Base416  + #caivarep#Base#;
                  Cuota416 = Cuota416 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI Cont1 = 13; Cont1 = 53; |FINSI;
            |SIGUE;
         |FINSI;
         |SI #cacon300#4 = 5;                     || Determinacion proporcional
            |PARA Cont1 = 11; |SI Cont1 [ 55; |HACIENDO Cont1 = Cont1 + 1;
               Base  = Cont1 - 3;
               Cuota = Cont1 + 3;
               |SI #caivarep#Cont1# = 16;
                  Base516  = Base516  + #caivarep#Base#;
                  Cuota516 = Cuota516 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 7;
                  Base507  = Base507  + #caivarep#Base#;
                  Cuota507 = Cuota507 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI #caivarep#Cont1# = 4;
                  Base504  = Base504  + #caivarep#Base#;
                  Cuota504 = Cuota504 + #caivarep#Cuota#;
                  |SAL;
               |FINSI;
               |SI Cont1 = 13; Cont1 = 53; |FINSI;
            |SIGUE;
         |FINSI;
      |FINSI;
      |SI #cacon300#2 = 1; |O #cacon300#2 = 0; |O #cacon300#2 = 14;
      |O #cacon300#2 = 10;                      || Recargo de equivalencia
         |PARA Cont1 = 17; |SI Cont1 [ 59; |HACIENDO Cont1 = Cont1 + 1;
            Base  = Cont1 - 3;
            Cuota = Cont1 + 3;
            |SI #caivarep#Cont1# = 0.5;
               BaseRec1  = BaseRec1  + #caivarep#Base#;
               CuotaRec1 = CuotaRec1 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI #caivarep#Cont1# = 1;
               BaseRec2  = BaseRec2  + #caivarep#Base#;
               CuotaRec2 = CuotaRec2 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI #caivarep#Cont1# = 4;
               BaseRec3  = BaseRec3  + #caivarep#Base#;
               CuotaRec3 = CuotaRec3 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI #caivarep#Cont1# = 1.75;
               BaseRec4  = BaseRec4  + #caivarep#Base#;
               CuotaRec4 = CuotaRec4 + #caivarep#Cuota#;
               |SAL;
            |FINSI;
            |SI Cont1 = 19; Cont1 = 57; |FINSI;
         |SIGUE;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Repercutido;
#caivarep#1;
28;
00,000001,"  ","S";
99,999999,"zz","S";
;
NULL,Repercutido
|FIN;

|PROCESO Soportado;
   #cacon300#0 = #caivasop#6;
   |LEE 010#cacon300.=;
   |SI FSalida = 0;
      Pasa = 0;
      |SI #cacon300#1 = 1;
         BaseSop  = BaseSop1;
         CuotaSop = CuotaSop1;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 6;
         BaseSop  = BaseSop2;
         CuotaSop = CuotaSop2;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 2;
         BaseSop  = BaseSop3;
         CuotaSop = CuotaSop3;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 7;
         BaseSop  = BaseSop4;
         CuotaSop = CuotaSop4;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 3; |Y #caivasop#48 = "N";
         BaseSop  = BaseSop5;
         CuotaSop = CuotaSop5;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 3; |Y #caivasop#48 = "S";
         BaseSop  = BaseSop6;
         CuotaSop = CuotaSop6;
         Pasa = 1;
      |FINSI;
      |SI #cacon300#1 = 4;
         BaseSop  = BaseSop7;
         CuotaSop = CuotaSop7;
         Pasa = 1;
      |FINSI;

      |SI Pasa = 0; |ACABA; |FINSI;

      |PARA Cont1 = 8; |SI Cont1 [ 53; |HACIENDO Cont1 = Cont1 + 1;
         Base  = Cont1;
         Cuota = Cont1 + 6;
         BaseSop  = BaseSop  + #caivasop#Base#;
         CuotaSop = CuotaSop + #caivasop#Cuota#;
         |SI Cont1 = 10; Cont1 = 51; |FINSI;
      |SIGUE;

      |SI #cacon300#1 = 1;
         BaseSop1  = BaseSop;
         CuotaSop1 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 6;
         BaseSop2  = BaseSop;
         CuotaSop2 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 2;
         BaseSop3  = BaseSop;
         CuotaSop3 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 7;
         BaseSop4  = BaseSop;
         CuotaSop4 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 3; |Y #caivasop#48 = "N";
         BaseSop5  = BaseSop;
         CuotaSop5 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 3; |Y #caivasop#48 = "S";
         BaseSop6  = BaseSop;
         CuotaSop6 = CuotaSop;
      |FINSI;
      |SI #cacon300#1 = 4;
         BaseSop7  = BaseSop;
         CuotaSop7 = CuotaSop;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Soportado;
#caivasop#1;
28;
00,000001,"  ","S";
99,999999,"zz","S";
;
NULL,Soportado
|FIN;

|PROCESO ProcesaEmpresa;
   |SI #caver390#0 = "S";
      Empresa = #canempre#2;
      Periodo = #canempre#3;
   |FINSI;

   anyo = #canempre#26;

   |DFICB Comodin;
   Comodin1 = "00000" + Empresa;
   Comodin1 = Comodin1 % -105;
   Comodin1 = Comodin1 + Periodo;
   Comodin = Comodin + Comodin1 + "/";

   |PATH_DAT #1 Comodin;
   |PATH_DAT #2 Comodin;
   |PATH_DAT #3 Comodin;
   |PATH_DAT #4 Comodin;

   |ABRE #cacon300;

   Base104 = 0;  Base107 = 0;  Base116 = 0;
   Cuota104 = 0; Cuota107 = 0; Cuota116 = 0;
   Base204 = 0;  Base207 = 0;  Base216 = 0;
   Cuota204 = 0; Cuota207 = 0; Cuota216 = 0;
   Base304 = 0;  Base307 = 0;  Base316 = 0;
   Cuota304 = 0; Cuota307 = 0; Cuota316 = 0;
   Base416 = 0; Cuota416 = 0;
   Base504 = 0;  Base507 = 0;  Base516 = 0;
   Cuota504 = 0; Cuota507 = 0; Cuota516 = 0;
   Base604 = 0;  Base607 = 0;  Base616 = 0;
   Cuota604 = 0; Cuota607 = 0; Cuota616 = 0;
   BaseRec1 = 0;  BaseRec2 = 0;  BaseRec3 = 0;  BaseRec4 = 0;
   CuotaRec1 = 0; CuotaRec2 = 0; CuotaRec3 = 0; CuotaRec4 = 0;

   BaseSop = 0; CuotaSop = 0;
   BaseSop1 = 0; CuotaSop1 = 0;
   BaseSop2 = 0; CuotaSop2 = 0;
   BaseSop3 = 0; CuotaSop3 = 0;
   BaseSop4 = 0; CuotaSop4 = 0;
   BaseSop5 = 0; CuotaSop5 = 0;
   BaseSop6 = 0; CuotaSop6 = 0;
   BaseSop7 = 0; CuotaSop7 = 0;

   |BUCLE Repercutido;

   |ABRE #cama3390;
   #cama3390#0 = Empresa;
   #cama3390#1 = anyo;
   |LEE 010#cama3390.=;
   |SI FSalida = 0;
      |INFOR "incidrep";
      |SI FSalida = 0;
         SwPrint = 0;
         |HAZ IncidBases;
         |SI SwPrint = 0;
            Casilla = "";
            DescIncid = "                            SIN INCIDENCIAS ";
            CantCalculo = 0;
            CantModelo  = 0;
            |PRINT;
         |FINSI;
         |PIEINF;
         |FININF;
      |FINSI;
   |FINSI;
   |CIERRA #cama3390;

   |BUCLE Soportado;

   |ABRE #cama3390;
   #cama3390#0 = Empresa;
   #cama3390#1 = anyo;
   |LEE 010#cama3390.=;
   |SI FSalida = 0;
      |INFOR "incidsop";
      |SI FSalida = 0;
         SwPrint = 0;
         |HAZ IncidDeduc;
         |SI SwPrint = 0;
            Casilla = "";
            DescIncid = "                            SIN INCIDENCIAS ";
            CantCalculo = 0;
            CantModelo  = 0;
            |PRINT;
         |FINSI;
         |PIEINF;
         |FININF;
      |FINSI;
   |FINSI;
   |CIERRA #cama3390;

   |CIERRA #cacon300;

|FPRC;

|DEFBUCLE Empresas;
#canempre#1;
;
Emp1,Per1;
Emp2,Per2;
;
NULL,ProcesaEmpresa;
|FIN;

|PROCESO IncidBases;     || Incidencias casillas regimen general (base y cuota)

||          *********** REGIMEN ORDINARIO ***********

      |SI #cama3390#33 ! Base104;
         Casilla = "01";
         DescIncid = "Importe base regimen ordinario incorrecto (IVA 4%)";
         CantModelo = #cama3390#33;
         CantCalculo = Base104;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#34 ! Cuota104;
         Casilla = "02";
         DescIncid = "Importe cuota regimen ordinario incorrecto (IVA 4%)";
         CantModelo = #cama3390#34;
         CantCalculo = Cuota104;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#35 ! Base107;
         Casilla = "03";
         DescIncid = "Importe base regimen ordinario incorrecto (IVA 7%)";
         CantModelo = #cama3390#35;
         CantCalculo = Base107;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#36 ! Cuota107;
         Casilla = "04";
         DescIncid = "Importe cuota regimen ordinario incorrecto (IVA 7%)";
         CantModelo = #cama3390#36;
         CantCalculo = Cuota107;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#37 ! Base116;
         Casilla = "05";
         DescIncid = "Importe base regimen ordinario incorrecto (IVA 16%)";
         CantModelo = #cama3390#37;
         CantCalculo = Base116;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#38 ! Cuota116;
         Casilla = "06";
         DescIncid = "Importe cuota regimen ordinario incorrecto (IVA 16%)";
         CantModelo = #cama3390#38;
         CantCalculo = Cuota116;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          ** BIENES USADOS Y ANTIGUEDADES **

      |SI #cama3390#39 ! Base204;
         Casilla = "07";
         DescIncid = "Importe base bienes usados y antiguedades incorrecto (IVA 4%)";
         CantModelo = #cama3390#39;
         CantCalculo = Base204;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#40 ! Cuota204;
         Casilla = "08";
         DescIncid = "Importe cuota bienes usados y antiguedades incorrecto (IVA 4%)";
         CantModelo = #cama3390#40;
         CantCalculo = Cuota204;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#41 ! Base207;
         Casilla = "09";
         DescIncid = "Importe base bienes usados y antiguedades incorrecto (IVA 7%)";
         CantModelo = #cama3390#41;
         CantCalculo = Base207;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#42 ! Cuota207;
         Casilla = "10";
         DescIncid = "Importe cuota bienes usados y antiguedades incorrecto (IVA 7%)";
         CantModelo = #cama3390#42;
         CantCalculo = Cuota207;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#43 ! Base216;
         Casilla = "11";
         DescIncid = "Importe base bienes usados y antiguedades incorrecto (IVA 16%)";
         CantModelo = #cama3390#43;
         CantCalculo = Base216;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#44 ! Cuota216;
         Casilla = "12";
         DescIncid = "Importe cuota bienes usados y antiguedades incorrecto (IVA 16%)";
         CantModelo = #cama3390#44;
         CantCalculo = Cuota216;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          *********** AGENCIAS DE VIAJES ***********

      |SI #cama3390#45 ! Base416;
         Casilla = "13";
         DescIncid = "Importe base regimen agencias de viajes incorrecto (IVA 16%)";
         CantModelo = #cama3390#45;
         CantCalculo = Base416;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#46 ! Cuota416;
         Casilla = "14";
         DescIncid = "Importe cuota regimen agencias de viajes incorrecto (IVA 16%)";
         CantModelo = #cama3390#46;
         CantCalculo = Cuota416;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          *********** DETERMINACION PROPORCIONAL ***********

      |SI #cama3390#47 ! Base504;
         Casilla = "15";
         DescIncid = "Importe base determinacion proporcional incorrecto (IVA 4%)";
         CantModelo = #cama3390#47;
         CantCalculo = Base504;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#48 ! Cuota504;
         Casilla = "16";
         DescIncid = "Importe cuota determinacion proporcional incorrecto (IVA 4%)";
         CantModelo = #cama3390#48;
         CantCalculo = Cuota504;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#49 ! Base507;
         Casilla = "17";
         DescIncid = "Importe base determinacion proporcional incorrecto (IVA 7%)";
         CantModelo = #cama3390#49;
         CantCalculo = Base507;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#50 ! Cuota507;
         Casilla = "18";
         DescIncid = "Importe cuota determinacion proporcional incorrecto (IVA 7%)";
         CantModelo = #cama3390#50;
         CantCalculo = Cuota507;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#51 ! Base516;
         Casilla = "19";
         DescIncid = "Importe base determinacion proporcional incorrecto (IVA 16%)";
         CantModelo = #cama3390#51;
         CantCalculo = Base516;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#52 ! Cuota516;
         Casilla = "20";
         DescIncid = "Importe cuota determinacion proporcional incorrecto (IVA 16%)";
         CantModelo = #cama3390#52;
         CantCalculo = Cuota516;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          *********** ADQUISICIONES INTRACOMUNITARIAS ***********

      |SI #cama3390#53 ! Base604;
         Casilla = "21";
         DescIncid = "Importe base adquisiciones intracomunitarias incorrecto (IVA 4%)";
         CantModelo = #cama3390#53;
         CantCalculo = Base604;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#54 ! Cuota604;
         Casilla = "22";
         DescIncid = "Importe cuota adquisiciones intracomunitarias incorrecto (IVA 4%)";
         CantModelo = #cama3390#54;
         CantCalculo = Cuota604;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#176 ! Base607;
         Casilla = "23";
         DescIncid = "Importe base adquisiciones intracomunitarias incorrecto (IVA 7%)";
         CantModelo = #cama3390#176;
         CantCalculo = Base607;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#177 ! Cuota607;
         Casilla = "24";
         DescIncid = "Importe cuota adquisiciones intracomunitarias incorrecto (IVA 7%)";
         CantModelo = #cama3390#177;
         CantCalculo = Cuota607;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#178 ! Base616;
         Casilla = "25";
         DescIncid = "Importe base adquisiciones intracomunitarias incorrecto (IVA 16%)";
         CantModelo = #cama3390#178;
         CantCalculo = Base616;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#179 ! Cuota616;
         Casilla = "26";
         DescIncid = "Importe cuota adquisiciones intracomunitarias incorrecto (IVA 16%)";
         CantModelo = #cama3390#179;
         CantCalculo = Cuota616;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          *********** RECARGO DE EQUIVALENCIA ***********

      |SI #cama3390#59 ! BaseRec1;
         Casilla = "35";
         DescIncid = "Importe base recargo de equivalencia incorrecto (REC 0.5%)";
         CantModelo = #cama3390#59;
         CantCalculo = BaseRec1;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#60 ! CuotaRec1;
         Casilla = "36";
         DescIncid = "Importe cuota recargo de equivalencia incorrecto (REC 0.5%)";
         CantModelo = #cama3390#60;
         CantCalculo = CuotaRec1;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#61 ! BaseRec2;
         Casilla = "37";
         DescIncid = "Importe base recargo de equivalencia incorrecto (REC 1%)";
         CantModelo = #cama3390#61;
         CantCalculo = BaseRec2;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#62 ! CuotaRec2;
         Casilla = "38";
         DescIncid = "Importe cuota recargo de equivalencia incorrecto (REC 1%)";
         CantModelo = #cama3390#62;
         CantCalculo = CuotaRec2;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#63 ! BaseRec3;
         Casilla = "39";
         DescIncid = "Importe base recargo de equivalencia incorrecto (REC 4%)";
         CantModelo = #cama3390#63;
         CantCalculo = BaseRec3;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#64 ! CuotaRec3;
         Casilla = "40";
         DescIncid = "Importe cuota recargo de equivalencia incorrecto (REC 4%)";
         CantModelo = #cama3390#64;
         CantCalculo = CuotaRec3;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#65 ! BaseRec4;
         Casilla = "41";
         DescIncid = "Importe base recargo de equivalencia incorrecto (REC 1.75%)";
         CantModelo = #cama3390#65;
         CantCalculo = BaseRec4;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#66 ! CuotaRec4;
         Casilla = "42";
         DescIncid = "Importe cuota recargo de equivalencia incorrecto (REC 1.75%)";
         CantModelo = #cama3390#66;
         CantCalculo = CuotaRec4;
         |PRINT;
         SwPrint = 1;
      |FINSI;

|FPRC;

|PROCESO IncidDeduc;     || Incidencias casillas regimen general (deducciones)

||          **** IVA deducible en operaciones interiores ****

      |SI #cama3390#188 ! BaseSop1;
         Casilla = "48";
         DescIncid = "Importe base IVA deducible oper.corrientes (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#188;
         CantCalculo = BaseSop1;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#68 ! CuotaSop1;
         Casilla = "49";
         DescIncid = "Importe cuota IVA deducible oper.corrientes (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#68;
         CantCalculo = CuotaSop1;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#189 ! BaseSop2;
         Casilla = "50";
         DescIncid = "Importe base IVA deducible oper.corrientes (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#189;
         CantCalculo = BaseSop2;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#69 ! CuotaSop2;
         Casilla = "51";
         DescIncid = "Importe cuota IVA deducible oper.corrientes (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#69;
         CantCalculo = CuotaSop2;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          **** IVA deducible en importaciones ****

      |SI #cama3390#190 ! BaseSop3;
         Casilla = "52";
         DescIncid = "Importe base IVA deducible importaciones (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#190;
         CantCalculo = BaseSop3;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#70 ! CuotaSop3;
         Casilla = "53";
         DescIncid = "Importe cuota IVA deducible importaciones (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#70;
         CantCalculo = CuotaSop3;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#191 ! BaseSop4;
         Casilla = "54";
         DescIncid = "Importe base IVA deducible importaciones (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#191;
         CantCalculo = BaseSop4;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#71 ! CuotaSop4;
         Casilla = "55";
         DescIncid = "Importe cuota IVA deducible importaciones (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#71;
         CantCalculo = CuotaSop4;
         |PRINT;
         SwPrint = 1;
      |FINSI;

||          **** IVA deducible en adquisiciones intracomunitarias ****

      |SI #cama3390#192 ! BaseSop5;
         Casilla = "56";
         DescIncid = "Importe base IVA deducible adqu.intracom. (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#192;
         CantCalculo = BaseSop5;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#72 ! CuotaSop5;
         Casilla = "57";
         DescIncid = "Importe cuota IVA deducible adqu.intracom. (Bienes Corrientes) incorrecto ";
         CantModelo = #cama3390#72;
         CantCalculo = CuotaSop5;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#193 ! BaseSop6;
         Casilla = "58";
         DescIncid = "Importe base IVA deducible adqu.intracom. (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#193;
         CantCalculo = BaseSop6;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#73 ! CuotaSop6;
         Casilla = "59";
         DescIncid = "Importe cuota IVA deducible adqu.intracom. (Bienes Inversion) incorrecto ";
         CantModelo = #cama3390#73;
         CantCalculo = CuotaSop6;
         |PRINT;
         SwPrint = 1;
      |FINSI;

      |SI #cama3390#194 ! BaseSop7;
         Casilla = "60";
         DescIncid = "Importe base IVA deducible Regimen A.G. y P. incorrecto ";
         CantModelo = #cama3390#194;
         CantCalculo = BaseSop7;
         |PRINT;
         SwPrint = 1;
      |FINSI;
      |SI #cama3390#74 ! CuotaSop7;
         Casilla = "61";
         DescIncid = "Importe cuota IVA deducible Regimen A.G. y P. incorrecto ";
         CantModelo = #cama3390#74;
         CantCalculo = CuotaSop7;
         |PRINT;
         SwPrint = 1;
      |FINSI;

|FPRC;

|PROGRAMA;

   |CLS;
   |CABEZA "Verificacion modelo 390";

   |PINPA #0#0;
   |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |ABRE #canempre;

   |IMPRE 0;
   |SI FSalida ! 0; |ACABA; |FINSI;

   |SI #caver390#0 = "S";
      Emp1 = #caver390#1;
      Per1 = #caver390#2;
      Emp2 = #caver390#3;
      Per2 = #caver390#4;
      |BUCLE Empresas;
   |SINO;
      |PARA Cont = 6; |SI Cont [ 63; |HACIENDO Cont = Cont + 3;
         Empresa = #caver390#Cont#;
         Cont = Cont + 1;
         Periodo = #caver390#Cont#;
         Cont = Cont - 1;
         |HAZ ProcesaEmpresa;
      |SIGUE;
   |FINSI;

   |FINIMP;

   |CIERRA #canempre;

|FPRO;
