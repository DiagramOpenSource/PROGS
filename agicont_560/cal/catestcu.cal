|FICHEROS;
    cacuenta #0;
    catestcu #2;
    cacuebal #5;
|FIN;

|VARIABLES;
    &sw_conase4 = 0;
    &entrada = 1;
    informe = "catestcu";
    &error = "";
    &arreg = "";
    &ercue = "";
    &erdes = "";
    &erniv = 0;
    men1  = "     NO EXISTE EMPRESA !";
    long = "  ";
    valo = 0;
    saber = "";
    cuini = "            ";
    cufin = "zzzzzzzzzzzz";
    niini = 0;
    nifin = 9;
    prim = 0;
    nivant = 0;
    cuante = "";
    cuante1 = "";
    pasant = "";
    cuenta = "";
    desant = "";
    uno = "";
    dos = "";
    cta = "";
    nivel = 0;
    nume1 = 0;
|FIN;

|INCLUYE acceso_i;

|PROCESO mayus;
  #2Campo = #2Campo > " ";
  |PINTA #2Campo;
|FPRC;

____________________________________/ CALCULOS DE PANTALLA
|PROCESO conase4; |TIPO 7;
|SI sw_conase4 = 1;
        #2#0 = "SI";     |PINTA #2#0;
    |PTEC 802;
    |PTEC 802;
|FINSI;
|FPRC;
____________________________________/
|PROCESO balance;
  uno = #0#0;
  |QBF uno;
  dos = uno + "000000000000";
  uno = dos % A101;
  #5#0 = uno;
  |LEE 000#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A102;
  #5#0 = uno;
  |LEE 000#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A103;
  #5#0 = uno;
  |LEE 000#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A104;
  #5#0 = uno;
  |LEE 000#5=;
  |SI FSalida = 0;
      |HAZ saca;
  |SINO;
      ercue = #0#0;
      erniv = #0#1;
      erdes = #0#2;
      error = "NO EXISTE EN BALANCES";
      arreg = "N";
      |PRINT;
  |FINSI;
|FPRC;

|PROCESO saca;
  |SI #0#4 ! #5#1; |O #0#5 ! #5#2; |O #0#6 ! #5#3;
                   |O #0#7 ! #5#4; |O #0#8 ! #5#5;
      ercue = #0#0;
      erniv = #0#1;
      erdes = #0#2;
      error = "NO CORRESPONDE CON BALANCES"
      arreg = "S";
      |PRINT;
      #0#4 = #5#1;
      #0#5 = #5#2;
      #0#6 = #5#3;
      #0#7 = #5#4;
      #0#8 = #5#5;
      |GRABA 020#0a;
  |FINSI;
|FPRC;

|PROCESO mayor;
|SI cuenta ! cuante1;
    |SI #0#1 ! 1;
            ercue = cuante1;
            erdes = "";
            erniv = #0#1 - 1;
            error = "NO EXISTE NIVEL";
            arreg = "N";
        |PRINT;
    |FINSI;
|SINO;
    |SI pasant = "S";
            ercue = cuante1;
            erdes = desant;
            erniv = nivant;
            error = "NO ES DE PASE DIRECTO";
            arreg = "N";
        |PRINT;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO igual;
|SI cuante ! cuante1;
    |SI #0#1 ! 1;
            ercue = cuante1;
            erdes = "";
            erniv = #0#1 - 1;
            error = "NO EXISTE NIVEL";
            arreg = "N";
        |PRINT;
    |SINO;
            ercue = cuante1;
            erdes = desant;
            erniv = nivant;
            error = "NO ES DE PASE DIRECTO";
            arreg = "N";
        |PRINT;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO menor;
|SI pasant = "N";
        ercue = cuenta;
        erdes = desant;
        erniv = nivant;
        error = "DEBERIA SER DE PASE DIRECTO";
        arreg = "N"
    |PRINT;
|FINSI;
|FPRC;

|PROCESO guarda;
    cuenta = #0#0;
    |QBF cuenta;
    nivant = #0#1;
    desant = #0#2;
    pasant = #0#3;
|SI #0#1 = 6;  cuante = #0#0 % dig8;  |FINSI;
|SI #0#1 = 5;  cuante = #0#0 % dig7;  |FINSI;
|SI #0#1 = 4;  cuante = #0#0 % dig6;  |FINSI;
|SI #0#1 = 3;  cuante = #0#0 % dig5;  |FINSI;
|SI #0#1 = 2;  cuante = #0#0 % dig4;  |FINSI;
|SI #0#1 = 1;  cuante = #0#0 % dig4;  |FINSI;
|FPRC;

|PROCESO guard1;
|SI #0#1 = 6;  cuante1 = #0#0 % dig8;  |FINSI;
|SI #0#1 = 5;  cuante1 = #0#0 % dig7;  |FINSI;
|SI #0#1 = 4;  cuante1 = #0#0 % dig6;  |FINSI;
|SI #0#1 = 3;  cuante1 = #0#0 % dig5;  |FINSI;
|SI #0#1 = 2;  cuante1 = #0#0 % dig4;  |FINSI;
|FPRC;

|PROCESO buscando;
 saber = "Procesando Cuenta: " + #0#0;
 |PINTA 2210,saber;

 cta = #0#0; |QBF cta; |SI cta = ""; |ACABA; |FINSI;

 |SI #0#1 > dig3;
     ercue = #0#0;
     erniv = #0#1;
     erdes = #0#2;
     error = "NIVEL NO PERMITIDO";
     arreg = "N";
     |PRINT;
 |FINSI;

 nivel = 0;
 long  = cta % 0;
 nume1 = long;
 |SI nume1 = #30#14; nivel = 1; |FINSI;
 |SI nume1 = #30#15; nivel = 2; |FINSI;
 |SI nume1 = #30#16; nivel = 3; |FINSI;
 |SI nume1 = #30#17; nivel = 4; |FINSI;
 |SI nume1 = #30#18; nivel = 5; |FINSI;
 |SI nume1 = #30#19; nivel = 6; |FINSI;

 |SI nivel = 0;
     ercue = #0#0;
     erniv = #0#1;
     erdes = #0#2;
     error = "FUERA DE NIVEL ";
     arreg = "N";
     |PRINT;
 |SINO;
     |SI nivel ! #0#1;
         ercue = #0#0;
         erniv = #0#1;
         erdes = #0#2;
         error = "NIVEL NO CORRESPONDE A LONGITUD";
         arreg = "N";
         |PRINT;
     |FINSI;
 |FINSI;

 |SI prim = 0;
     |SI #0#1 ! 1;
         ercue = #0#0;
         erniv = #0#1;
         erdes = #0#2;
         error = "NO EMPIEZA CON NIVEL 1";
         arreg = "N";
         |PRINT;
     |FINSI;
     prim = 1;
 |SINO;
    |HAZ guard1;
    |SI nivant < #0#1;  |HAZ mayor;  |FINSI;
    |SI nivant = #0#1;  |HAZ igual;  |FINSI;
    |SI nivant > #0#1;  |HAZ menor;  |FINSI;
    |SI #0#1 = dig3; |Y #0#3 = "N";
        ercue = #0#0;
        erniv = #0#1;
        erdes = #0#2;
        error = "DEBE SER DIRECTO";
        arreg = "S";
        |PRINT;
        #0#3 = "S";
        |GRABA 020#0a;
    |FINSI;
|FINSI;
|HAZ guarda;
|HAZ balance;
|FPRC;

|DEFBUCLE catestcu0;
 #0#1;
 ;
 cuini, niini;
 cufin, nifin;
 be;
 NULL, buscando;
|FIN;

|PROCESO creacion; |TIPO 3;
  |SI #2#0 = "NO"; |ACABA; |FINSI;
  |HAZ inicio;
  dig1 = #30#11;
  dig3 = #30#13;
  dig4 = 100 + #30#14;
  dig5 = 100 + #30#15;
  dig6 = 100 + #30#16;
  dig7 = 100 + #30#17;
  dig8 = 100 + #30#18;
  dig9 = 100 + #30#19;

  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |INFOR informe;
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
  |ABRE #5;
  prim = 0;
  |BUCLE catestcu0;
  |PIEINF;
  |FININF;
  |CIERRA #5;
  |FINIMP;
|FPRC;
