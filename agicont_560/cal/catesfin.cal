|FICHEROS;
     catesfin #0,MANTE;
     cacuenta #2;
     caz00001 #999;
|FIN;

|VARIABLES;
    &Fin   = 0;
     cta   = 0;
     cta_t = 0;
     dig_t = 0;
     long  = "  ";
     sw    = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROCESO CuentaT;
     cta  = #0cta_t;
     long = cta % 0;
     sw   = 0;
     |SI long = dig4; sw = 1; #0dig_t = 1; |FINSI;
     |SI long = dig5; sw = 1; #0dig_t = 2; |FINSI;
     |SI long = dig6; sw = 1; #0dig_t = 3; |FINSI;
     |SI long = dig7; sw = 1; #0dig_t = 4; |FINSI;
     |SI long = dig8; sw = 1; #0dig_t = 5; |FINSI;
     |SI long = dig9; sw = 1; #0dig_t = 6; |FINSI;

     |SI sw = 0;
         #0dig_t = 0;
         |MENAV "    Longitud de cuenta fuera de Nivel !";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Refresca;
     cta_t = 0;
     dig_t = 1;
     |HAZ CueFin;
     |GRABA 101#0a;
     |LIBERA #0;

     |SI #0#3 > 0;  #999#0 = #999#0 + #0#3;     |FINSI;
     |SI #0#3 < 0;  #999#1 = #999#1 + (-#0#3);  |FINSI;
     #999#2 = #999#0 - #999#1;
|FPRC;

|DEFBUCLE catesfinA;
     #0#1;
     ;
     "            ", 0;
     "zzzzzzzzzzzz", 9;
     be;
     NULL, Refresca;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     salidas = 0;
     |SI FSalida = 16;
         |SUB_EJECUTA "cay00001";
         |ERROR;
         |PTEC 812;
         |ACABA;
     |FINSI;

     |SI FSalida = 17;
         #999#0 = 0;
         #999#1 = 0;
         #999#2 = 0;
         |BUCLE catesfinA;
         |PINTA #999#0;
         |PINTA #999#1;
         |PINTA #999#2;
         Fin = 0;
         |PTEC 815;
         |PTEC 814;
         |PTEC 807;
     |FINSI;

     |SI FSalida = 18;
         salidas = 18;
         p_alfa1  = #0Campo;
         |HAZ punto;
         cta_t = Campo;
         dig_t = Campo + 1;
         |HAZ CuentaT;
     |FINSI;
|FPRC;

|PROCESO Cuenta; |TIPO 6;
     salidas  = 0;
     p_alfa1  = #0Campo;
     |HAZ punto;
     |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
     cta_t = Campo;
     dig_t = Campo + 1;
     |HAZ CuentaT;
|FPRC;

|PROCESO CueFin; |TIPO 0;
     |ABRE #2;
     #2#0 = #0cta_t;
     #2#1 = #0dig_t;
     |LEE 040#2=;
     |SI FSalida ! 0; |CIERRA #2; |ERROR; |ACABA; |FINSI;
     |SI #2#3 = "N";
         |CIERRA #2;
         |MENAV "      La cuenta no tiene pase DIRECTO !";
         |ERROR;
         |ACABA;
     |FINSI;
     #0#2 = #2#2;
     #0#3 = #2#53;
     #0#4 = #2#58;
     |PINTA #0#2;
     |PINTA #0#3;
     |PINTA #0#4;
     |CIERRA #2;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |SI #0#3 > 0;  #999#0 = #999#0 +. #0#3;     |FINSI;
     |SI #0#3 < 0;  #999#1 = #999#1 +. (-#0#3);  |FINSI;
     #999#2 = #999#0 - #999#1;

     |PINTA #999#0;
     |PINTA #999#1;
     |PINTA #999#2;
|FPRC;
