|FICHEROS;
   cay00001 #0;
   catesfin #1;
   cacuenta #10;
   caz00001 #999;
|FIN;

|VARIABLES;
    aPuntearD = "";
    aPuntearH = "";
    aCuenta   = "";
    aAlfa     = "";
    nDigito   = 0;
    nPosi     = 0;
    nSwPrint  = 0;

    &eAlfa    = "";
|FIN;

|INCLUYE acceso_i;

|PROCESO Imprime;
     |SI #1#3 > 0;  #999#0 = #999#0 + #1#3;     |FINSI;
     |SI #1#3 < 0;  #999#1 = #999#1 + (-#1#3);  |FINSI;
     #999#2 = #999#0 - #999#1;

     |SI #1#1 = 1;  nDigito = dig4;  |FINSI;
     |SI #1#1 = 2;  nDigito = dig4;  |FINSI;
     |SI #1#1 = 3;  nDigito = dig5;  |FINSI;
     |SI #1#1 = 4;  nDigito = dig6;  |FINSI;
     |SI #1#1 = 5;  nDigito = dig7;  |FINSI;
     |SI #1#1 = 6;  nDigito = dig8;  |FINSI;

     nPosi = 100 + nDigito
     aCuenta = #1#0 % nPosi;

     #10#0 = aCuenta;
     #10#1 = nDigito;
     |LEE 040#10=;
     |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;

     nSwPrint = 1;

     |SI #1#5 = "A";  eAlfa = "ACTIVA  ";  |FINSI;
     |SI #1#5 = "I";  eAlfa = "INACTIVA";  |FINSI;

     aAlfa = #0#5;   |QBF aAlfa;
     aAlfa = ((" " * 40) + aAlfa) % -140;
     #0#5 = aAlfa;

     aAlfa = #0#6;   |QBF aAlfa;
     aAlfa = ((" " * 25) + aAlfa) % -125;
     #0#6  = aAlfa;

     aAlfa = #0#8;   |QBF aAlfa;
     aAlfa = ((" " * 20) + ("Telefono : " + aAlfa)) % -120;
     #0#8  = aAlfa;

     aAlfa = #0#9;   |QBF aAlfa;
     aAlfa = ((" " * 10) + aAlfa) % -110;
     #0#9  = aAlfa;

     |PRINT;
|FPRC;

|DEFBUCLE catesfin;
     #1#1;
     6;
     "            ", 0, aPuntearD;
     "zzzzzzzzzzzz", 9, aPuntearH;
     ;
     NULL, Imprime;
|FIN;

|PROCESO Tipo3;|TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #0#1 = "I";  |INFOR "cay10001";  |FINSI;
     |SI #0#1 = "C";  |INFOR "cay20001";  |FINSI;

     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     aPuntearD = " ";
     aPuntearH = "z";
     |SI #0#1 = "C";
         aPuntearD = "S";
         aPuntearH = "S";
     |FINSI;

     |ABRE #10;
     |BUCLE catesfin;
     |CIERRA #10;

     |SI nSwPrint = 1;  |PIEINF;  |FINSI;
     |FININF;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |HAZ inicio;

     |CLS;
     |CABEZA "Impresion S.Tesoreria y Financiacion";
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         |GRABA 020#0b;
     |FINSI;
     |PDEFECTO #0, 1, 3;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         |GRABA 020#0a;
         |HAZ Tipo3;
     |FINSI;
     |LIBERA #0;
|FPRO;
