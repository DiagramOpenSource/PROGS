|FICHEROS;
     cacuent2 #0;
     cacuenta #1;
     cacuebal #5;
|FIN;

|VARIABLES;
     nCampo   = 0;
     aFichero = "";

     men1     = "     NO EXISTE EMPRESA !";
     men2     = "     LONGITUD DE CUENTA FUERA DE NIVEL !";
     men3     = "     CUENTA ERRONEA !!";
     error    = "     CLAVE EXISTENTE !";
     valida   = "     Conforme S/N.:";
     mascara  = "";
     digito2  = "  ";
     num      = 0;
     sw       = 0;
     mes      = "                ";
     me       = 0;
     cta      = "            ";
     ctanum   = 0;
     ctaalf   = " ";
     longalf  = " ";
     longnum  = " ";
     nivel    = 0;
     codcli   = 0;
     codpr    = 0;
     nompro   = "";
     mensa1   = "     No esta definida esta cuenta en Cuentas de Balance";
     uno = "";
     dos = "";
     nada = "";
     &entrada = 0;
     cuen1 = "";
     cuen2 = "";
     cuen3 = "";
     desdec = "";
     hastac = "";
     mesdes = "";
     meshas = "";
     modo = 0;
|FIN;

|INCLUYE acces3_i;
|INCLUYE punto2_i;

|PROCESO GrabaTempo;
     |PARA nCampo = 0;  |SI nCampo [ 59;  |HACIENDO nCampo = nCampo + 1;
           #0nCampo = #1nCampo;
     |SIGUE;
     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;

|DEFBUCLE cacuenta;
     #1#1;
     ;
     "            ", 0;
     "zzzzzzzzzzzz", 9;
     ;
     NULL, GrabaTempo;
|FIN;

|PROCESO Tipo8;  |TIPO 8;
     aFichero = ((Usuario % 810) + "zzzzzzzz") % 108;
     |NOME_DAT #0 aFichero;
     |ABRET #0;  |CIERRAT #0;  |DELINDEX #0;

     |ABRET #0;
     |BUCLE cacuenta;

     |HAZ inicio3;
|FPRC;

|PROCESO defect;
     |ABRE #5;

     uno = #0#0;  |QBF uno;
     dos = uno + "000000000000";
     uno = dos % A101;
     #5#0 = uno;
     |LEE 040#5=;
     |SI FSalida = 0;  |CIERRA #5;  |ACABA;  |FINSI;

     uno = dos % A102;
     #5#0 = uno;
     |LEE 040#5=;
     |SI FSalida = 0;  |CIERRA #5;  |ACABA;  |FINSI;

     uno = dos % A103;
     #5#0 = uno;
     |LEE 040#5=;
     |SI FSalida = 0;  |CIERRA #5;  |ACABA;  |FINSI;

     uno = dos % A104;
     #5#0 = uno;
     |LEE 040#5=;
     |SI FSalida ! 0;
         |MENAV mensa1;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO Nivel; |TIPO 0;
  p_alfa1 = #0Campo;
  |HAZ punto2;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  |SI entrada = 1;  |Y #0#0 = "            ";  |ACABA;  |FINSI;

  |HAZ defect;

  cta = #0#0;  |QBF cta;
  nada = cta % A101;

  |SI nada ! "0";
      ctanum = cta;
      ctaalf = ctanum;
      longnum = ctaalf % A0;
  |SINO;
      ctanum = 1;
      ctaalf = cta;
      longnum = ctaalf % A0;
  |FINSI;

  longalf = cta    % A0;
  |SI longnum ! longalf;|O ctanum = 0;
      |MENAV men3;
      |PINTA #0#0;
      |ERROR;
      |ACABA;
  |FINSI;

  nivel= 0;
  sw = 0;
  |SI longnum = dig4; sw = 1; nivel = 1; |FINSI;
  |SI longnum = dig5; sw = 1; nivel = 2; |FINSI;
  |SI longnum = dig6; sw = 1; nivel = 3; |FINSI;
  |SI longnum = dig7; sw = 1; nivel = 4; |FINSI;
  |SI longnum = dig8; sw = 1; nivel = 5; |FINSI;
  |SI longnum = dig9; sw = 1; nivel = 6; |FINSI;
  |SI sw = 0;
      |MENAV men2;
      |PINTA #0#0;
      |ERROR;
      |ACABA;
  |FINSI;
                         ||***** 1a Clave;
                         ||***** nivel = nivel de la cta;
  #0#1 = nivel;
|| la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
  mascara = #0#0;
  |QBF mascara;
  mascara = mascara +"zzzzzzzzzzzz";
  mascara = mascara % 112;
  #0#54    = mascara;
  #0#55    = nivel;
  #0#56 = mesdes;
  #0#57 = meshas;

  |SI #0#1 = #30#13;
      #0#3 = "S";
  |SINO;
      #0#3 = "N";
  |FINSI;
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
     |DELINDEX #0;
|FPRC;

|PROCESO Tipo1;  |TIPO 1;
     |MENAV "      De de Alta, Modifique o de de Baja por el Plan Contable.";
     |ERROR;
|FPRC;

|PROCESO Tipo4; |TIPO 4;
|PUSHV 0501 2380;
     |IMPRE 0;
     |SI FSalida = 0;
          |DDEFECTO #1;
          |ABRE #1;
          #1#0 = #0#0;
          #1#1 = #0#1;
          |LEE 020#1=;
          |CIERRA #1;

          |INFOR "cacuenta";
          |PRINT;
          |PIEINF;
          |FININF;
     |SINO;
          |MENAV "    Proceso abortado ...";
     |FINSI;
     |FINIMP;
 |POPV;
|FPRC;
