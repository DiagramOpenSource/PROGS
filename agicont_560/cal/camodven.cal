|FICHEROS;
  cavenaut #0;
  camodven #1;
|FIN;


|VARIABLES;
    cab = "Modificacion Dias ";
    error1 = "     NO EXISTE VENTAS AUTOMATICAS";
    errorfec1 = "     Fecha erronea DD/MM";
    errorfec3 = "     No existe ese dia el a¤o no es bisiesto";
    modificar = "2325S Es correcta la modificacion S/N : ";
    continuar = "2325S Continuar S/N : ";
    x = 0;
    y = 0;
    vacio = "              ";
    vac1 = "                                                                  ";
    num = 0;
    total = 0;
    varalfa = "";
    varalfa1 = "";
    varalfa2  = "";
    vardia = 0;
    varmes = 0;
    fechadesde = "";
    fechadesde1 = "";
    fechadesde2 = "";
    fechahasta = "";
    fechahasta1 = "";
    fechahasta2 = "";
    anu1 = "8512";
    anu2 = "8613";
    anu3 = "8714";
    anu4 = "8805";
    anu5 = "8917";
    anu6 = "9011";
    anu7 = "9112";
    anu8 = "9203";
    anu9 = "9315";
    anu10 = "9416";
    anu11 = "9517";
    anu12 = "9601";
    anu13 = "9713";
    anu14 = "9814";
    anu15 = "9915";
    dia1 = 0;
    dia2 = 31;
    dia3 = 60;
    dia4 = 91;
    dia5 = 121;
    dia6 = 152;
    dia7 = 182;
    dia8 = 213;
    dia9 = 244;
    dia10 = 274;
    dia11 = 305;
    dia12 = 335;
    diapri = "";
    diapri1 = 0;
    bisiesto = "";
    swbis = 1;
    anyo = "";
    mes = "";
    mesnum = 0;
    dia = "";
    dianum = 0;

    sw_exist = 0;

    cantidad = 0;
    nada = 0;

    {366}cant = 0;

    {-1}valfec = 0;
        valfec1  = 31;
        valfec2  = 29;
        valfec3  = 31;
        valfec4  = 30;
        valfec5  = 31;
        valfec6  = 30;
        valfec7  = 31;
        valfec8  = 31;
        valfec9  = 30;
        valfec10 = 31;
        valfec11 = 30;
        valfec12 = 31;
|FIN;


|PROCESO clave;  |TIPO 0;
  sw_exist = 0;
  Icant = cant1 <-;
  total = 0;
  |PARA y = 1;  |SI y [ 4;  |HACIENDO y = y + 1;
        #0#0 = 1;
        #0#1 = y;
        |LEE 040#0=;
        |SI FSalida ! 0;
            |MENAV error1;
            |DDEFECTO #0;
            sw_exist = sw_exist + 1;
        |FINSI;
        num = 1
        |PARA x = 1;  |SI x [ 92;  |HACIENDO x = x + 1;
              num = num + 1;
              cant = #0num;
              total = total + cant;
              Icant = Icant + 1;
              |SI x = 91; |Y y [ 2;
                  |SAL;
              |FINSI;
        |SIGUE;
  |SIGUE;
  |PINTA 1756,"          ";
  |PINTA 1756,total;
|FPRC;


|PROGRAMA;
  |CLS;
  |ABRE #0;
  |ABRE #1;
  |PINPA #0#1;
  |CABEZA cab;
  |DDEFECTO #1;
  |HAZ clave;
  |SI sw_exist = 4; |ACABA; |FINSI;
  |HAZ anyo;
  |PARA nada=0;  |SI nada = 0;  |HACIENDO nada=nada;
        |ENDATOS #2#1;
        |PUSHV 2301 2380;
        |CONFI continuar;
        |POPV;
        |SI FSalida ! 0;
            nada = FSalida;
        |FINSI;
  |SIGUE;
  |LIBERA #0;
  |CIERRA #0;
  |CIERRA #1;
|FPRO;

|PROCESO  fechbien;|TIPO 0;        ||Calcula si la fecha es correcta
  valfec1  = 31; valfec2  = 29; valfec3  = 31;
  valfec4  = 30; valfec5  = 31; valfec6  = 30;
  valfec7  = 31; valfec8  = 31; valfec9  = 30;
  valfec10 = 31; valfec11 = 30; valfec12 = 31;

  varalfa = #1Campo ;
  |SI varalfa = "    ";
      |ERROR; |ACABA;
  |FINSI;
  |SI varalfa = "2902";|Y swbis = 1;
      |MENAV errorfec3;
      |ERROR;
      |ACABA;
  |FINSI;
  varalfa1 = varalfa / 2;
  varalfa2 = varalfa % A302;
  vardia = varalfa1;
  varmes = varalfa2;
  |SI varmes [ 0;|O varmes > 12;
      |MENAV errorfec1;
      |ERROR;
      |ACABA;
  |FINSI;
  Ivalfec = valfec1 <-;
  Ivalfec = Ivalfec + varmes;
  Ivalfec = Ivalfec - 1;
  |SI vardia > valfec;|O vardia [ 0;
      |MENAV errorfec1;
      |ERROR;
  |FINSI;
|FPRC;


|PROCESO anyo;
  |SI #0#94 = "1985";  anyo = anu1;  |FINSI;
  |SI #0#94 = "1986";  anyo = anu2;  |FINSI;
  |SI #0#94 = "1987";  anyo = anu3;  |FINSI;
  |SI #0#94 = "1988";  anyo = anu4;  |FINSI;
  |SI #0#94 = "1989";  anyo = anu5;  |FINSI;
  |SI #0#94 = "1990";  anyo = anu6;  |FINSI;
  |SI #0#94 = "1991";  anyo = anu7;  |FINSI;
  |SI #0#94 = "1992";  anyo = anu8;  |FINSI;
  |SI #0#94 = "1993";  anyo = anu9;  |FINSI;
  |SI #0#94 = "1994";  anyo = anu10; |FINSI;
  |SI #0#94 = "1995";  anyo = anu11; |FINSI;
  |SI #0#94 = "1996";  anyo = anu12; |FINSI;
  |SI #0#94 = "1997";  anyo = anu13; |FINSI;
  |SI #0#94 = "1998";  anyo = anu14; |FINSI;
  |SI #0#94 = "1999";  anyo = anu15; |FINSI;

                          ||Calcular si es o no anyo bisiesto;
  swbis = 0;
  bisiesto = anyo % A301;
  |SI bisiesto = 1;
      swbis = 1;
  |FINSI;
|FPRC;


|PROCESO graba;
  Icant = cant1 <-;
  |PARA y = 1;  |SI y [ 4;  |HACIENDO y = y + 1;
        #0#0 = 1;
        #0#1 = y;
        |LEE 110#0=;
        num = 1;
        |PARA x = 1;  |SI x [ 92;  |HACIENDO x = x + 1;
              num = num + 1;
              #0num = cant;
              Icant = Icant + 1;
              |SI x = 91;  |Y y [ 2;
                  |SAL;
              |FINSI;
        |SIGUE;
        |GRABA 020#0a;
        |LIBERA #0;
  |SIGUE;
|FPRC;


|PROCESO dia;|TIPO 0;
  mes = #1#1 % A302;
  dia = #1#1 % A102;
  |SI mes = 01;  mesnum = dia1;  |FINSI;
  |SI mes = 02;  mesnum = dia2;  |FINSI;
  |SI mes = 03;  mesnum = dia3;  |FINSI;
  |SI mes = 04;  mesnum = dia4;  |FINSI;
  |SI mes = 05;  mesnum = dia5;  |FINSI;
  |SI mes = 06;  mesnum = dia6;  |FINSI;
  |SI mes = 07;  mesnum = dia7;  |FINSI;
  |SI mes = 08;  mesnum = dia8;  |FINSI;
  |SI mes = 09;  mesnum = dia9;  |FINSI;
  |SI mes = 10;  mesnum = dia10; |FINSI;
  |SI mes = 11;  mesnum = dia11; |FINSI;
  |SI mes = 12;  mesnum = dia12; |FINSI;
  dianum = dia;
  Icant = cant1 <-;
  Icant = Icant + dianum + mesnum;
  Icant = Icant - 1;
  cantidad = cant;
  |PINTA 1756,"          ";
  |PINTA 1756,total;
  |PINTA 1337,"             ";
  |PINTA 1337,cantidad;
|FPRC;


|PROCESO modifi;|TIPO 0;
  total = (total - cantidad) + #1#2;
  |PINTA 1756,"          ";
  |PINTA 1756,total;
  |PUSHV 2301 2380;
  |CONFI modificar;
  |POPV;
  |SI FSalida ! 0;
     total = (total - #1#2) + cantidad;
     cant = cantidad;
     |PINTA 1756,"          ";
     |PINTA 1756,total;
  |SINO;
     cant = #1#2;
     |HAZ graba;
     #1#2 = 0;
  |FINSI;
  |PTEC 13;
|FPRC;
