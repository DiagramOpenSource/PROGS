|| lee la empresa y carga niveles                 numero 4
|| duplicado para evitar duplicaciones de calculos en los programas con
   relaciones!!!

|FICHEROS;
    canempre #30;
|FIN;

|VARIABLES;
    &fec1 = @;
    &fec2 = @;
    &cod_emp1 = "";
    &cod_emp2 = "";
    &clave1 = "";
    &clave2 = "";
    &cod1 = 0;
    &cod2 = 0;
    &empresa = "";
    &dir_fich = "";
    &dig1 = 0;
    &dig3 = 0;
    &dig4 = 0;
    &dig5 = 0;
    &dig6 = 0;
    &dig7 = 0;
    &dig8 = 0;
    &dig9 = 0;
    &work1 = "";
    &tra1 = 0;
    &mes1 = "";
    &dia1 = "";
    &codcon = 0;
    &swerror = 0;
    salidas = 0;

 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|PROCESO inicio4; |TIPO 8;
  swerror = 0;
  |DFICE empresa;
  cod_emp1 = empresa  % -107;
  cod_emp2 = cod_emp1 %  106;
  clave1 = cod_emp2 %  105;
  clave2 = cod_emp2 % -101;
  cod1 = clave1;
  cod2 = clave2;
|ABRE #30;
    #30#2 = cod1;
    #30#3 = cod2;
|LEE 040#30=;
|SI FSalida ! 0;|Y #30#2 ! 0;|Y #30#3 ! 0;
    swerror = 1;
    |MENAV "    No existe Empresa !!!";
    |ACABA;
|FINSI;
    dig1 = #30#11;
    dig3 = #30#13;
    dig4 = #30#14;
    dig5 = #30#15;
    dig6 = #30#16;
    dig7 = #30#17;
    dig8 = #30#18;
    dig9 = #30#19;
|CIERRA #30;
    cod2 = #30#26;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
    tra1 = 100 + #30#11;
    mes1 = tra1 % -102;
|SI cod2 < 80;
        work1 = "01." + mes1 + ".20" + clave2;
|SINO;
        work1 = "01." + mes1 + ".19" + clave2;
|FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
|SI #30#11 > #30#12;
        cod2 = cod2 + 1;
        |SI cod2 > 99; cod2 = cod2 - 100;    |FINSI;
|FINSI;
    dia1 = "31";
|SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
|FINSI;
|SI #30#12 = 2;
        dia1 = "28";
    |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
            dia1 = "29";
    |FINSI;
|FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
|SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
|SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
|FINSI;
    fec2 = work1;

 enEmpresa = #canempre#2;
 enPeriodo = #canempre#3;
 swOperacion = 0;
 |SUB_EJECUTA "camoneda";
|FPRC;

|PROCESO leelo4;
    swerror = 0;
|ABRE #30;
    #30#2 = cod1;
    #30#3 = cod2;
|LEE 040#30=;
|SI FSalida ! 0;|Y #30#2 ! 0;|Y #30#3 ! 0;
    swerror = 1;
    |CIERRA #30;
    |MENAV "    No existe Empresa !!!";
    |ERROR;
    |ACABA;
|FINSI;

    dig1 = #30#11;
    dig3 = #30#13;
    dig4 = #30#14;
    dig5 = #30#15;
    dig6 = #30#16;
    dig7 = #30#17;
    dig8 = #30#18;
    dig9 = #30#19;
|CIERRA #30;
    cod2 = #30#26;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
    tra1 = 100 + #30#11;
    mes1 = tra1 % -102;
|SI cod2 < 80;
        work1 = "01." + mes1 + ".20" + clave2;
|SINO;
        work1 = "01." + mes1 + ".19" + clave2;
|FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
|SI #30#11 > #30#12;
        cod2 = cod2 + 1;
|FINSI;
    dia1 = "31";
|SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
|FINSI;
|SI #30#12 = 2;
        dia1 = "28";
    |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
            dia1 = "29";
    |FINSI;
|FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
|SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
|SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
|FINSI;
    fec2 = work1;

 enEmpresa = #canempre#2;
 enPeriodo = #canempre#3;
 swOperacion = 0;
 |SUB_EJECUTA "camoneda";
|FPRC;
