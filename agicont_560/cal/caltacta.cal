|FICHEROS;
  caltacta #0;
  cacuenta #1;    || cuentas
  cactrlal #11;   || control altas en otras empresas.
  canempre #30;   || Empresas
|FIN;

|VARIABLES;

 men2     = "LONGITUD DE CUENTA FUERA DE NIVEL !. NO PROCEDE ALTA ";
 mascara  = "";
 num      = 0;
 sw       = 0;
 mes      = "                ";
 mesdes = "";
 meshas = "";

 cta      = "            ";
 longnum  = " ";
 nivel    = 0;

 &raf_cue = "";
 &raf_dig = 0;
 &raf_des = "";
 &raf_pase = "";
 &raf_blo = 0;
 &raf_tipo = "";
 &raf_agru = 0;
 &raf_epi = 0;
 &raf_par = 0;
 &raf_periodo = 0;
 xx = 0;
 operac = 0;
 dir_fich = "";
 dirfich0 = "";
 alfa1 = "";
 alfa2 = "";
|FIN;
|| lee la empresa y carga niveles            || numero 0


|| *********************************************************************

|PROGRAMA;
  #0#0 = raf_cue;
  #0#1 = raf_des;
  |PINPA #0#0;
  |PINDA #0#0;
  |ATRI R; |PINTA 1410, "                                                     "; |ATRI 0;

  |ABRE #11;
  |DDEFECTO #11;
  |LEE 101#11p;
  |LIBERA #11;
  |CIERRA #11;

 |ABRE #30;
 |DBASE dir_fich;

 cta = raf_cue;
 |QBF cta;
 longnum = cta % A0;

 |PARA xx = 7;  |SI xx [ 26;  |HACIENDO xx = xx + 1;
 |ATRI R; |PINTA 1410, "                                                     "; |ATRI 0;
       |SI #11xx = 0;  |SAL;  |FINSI;
       dirfich0 = dir_fich + "fich/";

       alfa1 = #11xx;
       alfa2 = raf_periodo;
       alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
       alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
       dirfich0 = dirfich0 + alfa1 + alfa2 + "/";

|| lee empresa
        |DDEFECTO #30;
        #30#2 = #11xx;
        #30#3 = raf_periodo;
        |LEE 011#30=;
        |SI FSalida = 0;
            |HAZ haztodo;
        |FINSI;
  |SIGUE;
  |CIERRA #30;
|FPRO;

|PROCESO haztodo;
  #0#2 = #30#2;
  #0#3 = #30#1;
  |PINTA #0#2;
  |PINTA #0#3;

  nivel= 0;
  sw = 0;
  |SI longnum = #30#14; sw = 1; nivel = 1; |FINSI;
  |SI longnum = #30#15; sw = 1; nivel = 2; |FINSI;
  |SI longnum = #30#16; sw = 1; nivel = 3; |FINSI;
  |SI longnum = #30#17; sw = 1; nivel = 4; |FINSI;
  |SI longnum = #30#18; sw = 1; nivel = 5; |FINSI;
  |SI longnum = #30#19; sw = 1; nivel = 6; |FINSI;

  |SI sw = 0;
      |AVISO;
      |ATRI R;
      |PINTA 1410, men2;
      |ATRI 0;
      |PAUSA;
  |SINO;
      num = #30#11; |HAZ pinta; mesdes = mes;
      num = #30#12; |HAZ pinta; meshas = mes;
      |PATH_DAT #1  dirfich0;
      |ABRET #1;
      #1#0 = raf_cue;
      #1#1 = nivel;
      |LEE 000#1=;
      |SI FSalida ! 0;
          |ATRI R; |PINTA 1410, "ALTA CORRECTA ... "; |ATRI 0;
          |PDEFECTO #1,9,60;
          #1#0 = raf_cue;
          #1#1 = nivel;
          #1#2 = raf_des;
          #1#3 = raf_pase;
          #1#4 = raf_blo;
          #1#5 = raf_tipo;
          #1#6 = raf_agru;
          #1#7 = raf_epi;
          #1#8 = raf_par;
  || la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
          mascara = #1#0;
          |QBF mascara;
          mascara = mascara +"zzzzzzzzzzzz";
          mascara = mascara % 112;
          #1#54    = mascara;
          #1#55    = nivel;
          #1#56 = mesdes;
          #1#57 = meshas;
          |GRABA 020#1n;
          |LIBERA #1;
      |FINSI;
      |CIERRAT #1;
 |FINSI;
|FPRC;

|PROCESO pinta;
  |SI num =  1; mes = "Enero";     |ACABA;  |FINSI;
  |SI num = 12; mes = "Diciembre"; |ACABA;  |FINSI;
  |SI num =  2; mes = "Febrero";   |ACABA;  |FINSI;
  |SI num =  3; mes = "Marzo";     |ACABA;  |FINSI;
  |SI num =  4; mes = "Abril";     |ACABA;  |FINSI;
  |SI num =  5; mes = "Mayo";      |ACABA;  |FINSI;
  |SI num =  6; mes = "Junio";     |ACABA;  |FINSI;
  |SI num =  7; mes = "Julio";     |ACABA;  |FINSI;
  |SI num =  8; mes = "Agosto";    |ACABA;  |FINSI;
  |SI num =  9; mes = "Septiembre";|ACABA;  |FINSI;
  |SI num = 10; mes = "Octubre";   |ACABA;  |FINSI;
  |SI num = 11; mes = "Noviembre"; |ACABA;  |FINSI;
|FPRC;
