|FICHEROS;
     cacuenta #69;
     cacuentp #70;
     caclipro #71;
|FIN;

|VARIABLES;
    p_lugar = 0;
    p_cuan3 = 0;
    p_cuan4 = 0;
    p_cuan5 = 0;
    p_alfa1 = "";
    p_alfa2 = "";
    p_alfa3 = "";
    p_alfa4 = "";
    p_alfa5 = "";
    p_alfa6 = "";
    p_nume1 = 0;
    p_nume2 = 0;
    p_ceros = "";
    p_error = 0;
    p_mensa = "    LONGITUD DE CUENTA FUERA DE NIVEL!";
    sw_nom1 = 0;
    varia_cod1 = "";
    cuen111 = "";
    cuen211 = "";
    cuen311 = "";
    desdec11 = "";
    hastac11 = "";
    num_campo1 = 0;
    p_nif2 = "";
|FIN;

|PROCESO punto2;               || desde calculo 'cuenta'
  |SI salidas = 18;
      num_campo1 = Campo;
      |HAZ cuent11;
      |ACABA;
  |FINSI;
  p_error = 0;
  p_lugar = 0;
  p_cuan3 = 0;
  p_cuan4 = 0;
  p_alfa3 = "";
  p_alfa4 = "";
  p_alfa4 = p_alfa1 > " ";
  p_alfa1 = p_alfa4;
  p_alfa4 = "";
  |PARA p_nume1 = 1; |SI p_nume1 [ 12; |HACIENDO p_nume1 = p_nume1 + 1;
        p_nume2 = (p_nume1 * 100) + 1;
        p_alfa2 = p_alfa1 % p_nume2;
        |SI p_alfa2 ! " ";
            |SI p_alfa2 = ".";
                p_lugar = p_nume1;
            |SINO;
                |SI p_lugar=0; p_alfa3=p_alfa3+p_alfa2; p_cuan3=p_cuan3+1; |FINSI;
                |SI p_lugar!0; p_alfa4=p_alfa4+p_alfa2; p_cuan4=p_cuan4+1; |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |SI p_lugar ! 0;
      |SI dig3 = 1;  p_cuan5 = dig4;  |FINSI;
      |SI dig3 = 2;  p_cuan5 = dig5;  |FINSI;
      |SI dig3 = 3;  p_cuan5 = dig6;  |FINSI;
      |SI dig3 = 4;  p_cuan5 = dig7;  |FINSI;
      |SI dig3 = 5;  p_cuan5 = dig8;  |FINSI;
      |SI dig3 = 6;  p_cuan5 = dig9;  |FINSI;
      p_nume1 = p_cuan5 - (p_cuan3 + p_cuan4);
      |SI p_nume1 > 0;
          cuen111 = p_alfa4 % 101;
          p_ceros = "0" * p_nume1;
          p_alfa5 = p_alfa3 + p_ceros + p_alfa4;
          cuen111 = p_alfa4 % 101;
          |SI cuen111 = "U";  |O cuen111 = "A";
              cuen311 = cuen111;
              |HAZ ultialt1;
          |FINSI;
          #0Campo = p_alfa5;
          |PINTA #0Campo;
      |SINO;
          |MENAV p_mensa;
          p_error = 1;
      |FINSI;
  |SINO;
      p_alfa5 = p_alfa1;
  |FINSI;
|FPRC;

|PROCESO busca_cif12;
    sw_nom1 = 1;
    #70#1 = #71#1;  || nombre
    #70#2 = #71#10; || cuenta
|FPRC;

|DEFBUCLE consulta122;
 #71#4;
 ;
 #70#4;
 #70#4;
 ;
 NULL, busca_cif12;
|FIN;

|PROCESO busca_cuen12;
    |SI #70#0 = "P";
        p_alfa6 = #69#0;
        p_alfa6 = p_alfa6 % 103;
        |SI p_alfa6 ! "400"; |Y p_alfa6 ! "410"; |Y p_alfa6 ! "523";
            |ACABA;
        |FINSI;
    |FINSI;
     cuen311 = #69#2;
     cuen311 = cuen311 > cuen311;
     cuen211 = cuen311 - cuen111;
     |SI cuen211 ! cuen311; |Y #69#3 = "S";
          |HAZ leepornif2;
          #70#1 = #69#2;
          #70#2 = #69#0;
          #70#4 = p_nif2;
          |PINTA #70#1;
          |PINTA #70#2;
          |PINTA #70#4;
          |PAUSA;
          |SI FSalida = 1;  sw_nom1 = 1;  |ERROR10;  |FINSI; ||Esc
          |SI FSalida = 7;  |ERROR10;  |FINSI;    ||Ctrl+C
     |FINSI;
|FPRC;


|DEFBUCLE consulta112;
 #69#1;
 3;
 desdec11 , 0, "S";
 hastac11 , 9, "S";
 ;
 NULL, busca_cuen12;
|FIN;

|PROCESO cuent11; |TIPO 0;
    sw_nom1 = 0;
    |PUSHV 0501 2380;
    |DDEFECTO #70;
    |PINPA #0#70;
    |ENDATOS #1#70;
    |SI FSalida = 0;
         |SI #70#0 ! "F";
             |SI #70#0 ] "1"; |Y #70#0 [ "7";
                  desdec11 = #70#0 + "           ";
                  hastac11 = #70#0 + "99999999999";
             |SINO;
                  |SI #70#0 = "C";
                       desdec11 = "4300        ";
                       hastac11 = "449999999999";
                  |FINSI;
                  |SI #70#0 = "P";
                       desdec11 = "4000        ";
                       hastac11 = "523999999999";
                  |FINSI;
                  |SI #70#0 = "T";
                       desdec11 = "            ";
                       hastac11 = "zzzzzzzzzzzz";
                  |FINSI;
             |FINSI;
             cuen111 = #70#1; |QBF cuen111;
             cuen111 = cuen111 > cuen111;
             |MENSA "0000Pulse <Return> Para Seguir, <Esc> Para Aceptar, <Ctrl+C> Para Abandonar";
             |BUCLE consulta112;
         |SINO;
             |BUCLE consulta122;
             |SI sw_nom1 = 0;
                 |MENAV "    CIF no encontrado ...";
             |SINO;
                 #69#0 = #70#2;
                 |PINDA #0#70;
                 |PAUSA;
             |FINSI;
         |FINSI;
    |FINSI;
    |POPV;
    |BLIN 4;
    |SI sw_nom1 = 1;
         varia_cod1 = #69#0;
         |QBF varia_cod1;
         #0num_campo1 = varia_cod1;
    |SINO;
         #0num_campo1 = p_alfa1;
    |FINSI;
    |PINTA #0num_campo1;
    Campo = num_campo1;
    |ERROR;
|FPRC;

|PROCESO ultialt1;
  |ABRE #69;
  p_nume2 = p_alfa3;
  p_nume2 = p_nume2 + 1;
  cuen111 = p_nume2;
  #69#0 = cuen111;
  #69#1 = "0";
  |LEE 021#69];
  |SI FSalida ! 0;
      |LEE 021#69u;
  |SINO;
      |LEE 021#69a;
      |SI FSalida ! 0;
          |LEE 021#69p;
      |FINSI;
  |FINSI;
  cuen211 = p_alfa3 % 0;
  p_nume2 = cuen211;
  p_nume2 = p_nume2 + 100;
  cuen111 = p_nume2;
  cuen211 = #69#0 % cuen111;
  |SI cuen211 = p_alfa3;
      cuen211 = #69#0;
      p_nume2 = cuen211;
      |SI cuen311 = "A";
          p_nume2 = p_nume2 + 1;
      |FINSI;
      p_alfa5 = p_nume2;
  |SINO;
      p_ceros = "0" * p_nume1;
      p_alfa5 = p_alfa3 + p_ceros + "1";
  |FINSI;
  |DDEFECTO #69;
||  |CIERRA #69;
|FPRC;

|PROCESO leepornif2;
 p_nif2 = "               ";
 p_alfa1 = #69#0; p_alfa1 = p_alfa1 % 101;
 |SI p_alfa1 ! "4"; |Y p_alfa1 ! "5";
     |ACABA;
 |FINSI;

 |ABRE #71;
 #71#23 = "C";
 #71#10 = #69#0;
 #71#11 = #69#1;
 |LEE 001#71=;
 |SI FSalida = 0;
     p_nif2 = #71#9;
 |SINO;
     #71#23 = "P";
     #71#10 = #69#0;
     #71#11 = #69#1;
     |LEE 001#71=;
     |SI FSalida = 0;
         p_nif2 = #71#9;
     |FINSI;
 |FINSI;
 |CIERRA #71;
|FPRC;
