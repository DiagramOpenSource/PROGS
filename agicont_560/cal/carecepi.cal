|FICHEROS;
    cacuenta #0;
    cacuebal #5;
    carecepi #10;
|FIN;

|VARIABLES;
    &sw_conase4 = 0;
    &entrada = 1;
    uno = "";
    desde = "1";
    hasta = "zzzzzzzzzzzz";
    dos = " ";
    alfa1 = "";
|FIN;

|INCLUYE acceso_i;

|PROCESO mayus;  |TIPO 6;
  #10Campo = #10Campo > " ";
  |PINTA #10Campo;
|FPRC;

|PROCESO conase4; |TIPO 7;
|SI sw_conase4 = 1;
        #10#0 = "S";     |PINTA #10#0;
    |PTEC 802;
    |PTEC 802;
|FINSI;
|FPRC;

|PROCESO meses;
|SI #30#11 = 1;     #0#56 = "Enero";         |FINSI;
|SI #30#11 = 2;     #0#56 = "Febrero";       |FINSI;
|SI #30#11 = 3;     #0#56 = "Marzo";         |FINSI;
|SI #30#11 = 4;     #0#56 = "Abril";         |FINSI;
|SI #30#11 = 5;     #0#56 = "Mayo";          |FINSI;
|SI #30#11 = 6;     #0#56 = "Junio";         |FINSI;
|SI #30#11 = 7;     #0#56 = "Julio";         |FINSI;
|SI #30#11 = 8;     #0#56 = "Agosto";        |FINSI;
|SI #30#11 = 9;     #0#56 = "Septiembre";    |FINSI;
|SI #30#11 = 10;    #0#56 = "Octubre";       |FINSI;
|SI #30#11 = 11;    #0#56 = "Noviembre";     |FINSI;
|SI #30#11 = 12;    #0#56 = "Diciembre";     |FINSI;

|SI #30#12 = 1;     #0#57 = "Enero";         |FINSI;
|SI #30#12 = 2;     #0#57 = "Febrero";       |FINSI;
|SI #30#12 = 3;     #0#57 = "Marzo";         |FINSI;
|SI #30#12 = 4;     #0#57 = "Abril";         |FINSI;
|SI #30#12 = 5;     #0#57 = "Mayo";          |FINSI;
|SI #30#12 = 6;     #0#57 = "Junio";         |FINSI;
|SI #30#12 = 7;     #0#57 = "Julio";         |FINSI;
|SI #30#12 = 8;     #0#57 = "Agosto";        |FINSI;
|SI #30#12 = 9;     #0#57 = "Septiembre";    |FINSI;
|SI #30#12 = 10;    #0#57 = "Octubre";       |FINSI;
|SI #30#12 = 11;    #0#57 = "Noviembre";     |FINSI;
|SI #30#12 = 12;    #0#57 = "Diciembre";     |FINSI;
|FPRC;

|PROCESO clave_3;
    alfa1 = #0#0;
|QBF alfa1;
    alfa1 = alfa1 + "zzzzzzzzzzzz";
    alfa1 = alfa1 % 112;
    #0#54 = alfa1;  || cuenta tercera clave
    #0#55 = #0#1;   || digito tercera clave
|FPRC;

|PROCESO saca;
    #0#4 = #5#1;    || bloque
    #0#5 = #5#2;    || tipo
    #0#6 = #5#3;    || agrupacion
    #0#7 = #5#4;    || epigrafe
    #0#8 = #5#5;    || partida
|HAZ clave_3;
|HAZ meses;

|GRABA 020#0a;
|LIBERA #0;
|FPRC;

|PROCESO cuenta;
  uno = #0#0;
  |QBF uno;
  dos = uno + "000000000000";
  uno = dos % A101;
  #5#0 = uno;
  |LEE 040#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A102;
  #5#0 = uno;
  |LEE 040#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A103;
  #5#0 = uno;
  |LEE 040#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
  uno = dos % A104;
  #5#0 = uno;
  |LEE 040#5=;
  |SI FSalida = 0;  |HAZ saca;  |ACABA;  |FINSI;
|FPRC;

|DEFBUCLE cambia;
 #0#1;
 ;
 desde, 0;
 hasta, 9;
 be;
 NULL, cuenta;
|FIN;

|PROCESO carecepi; |TIPO 3;
  |SI #10#0 = "S";
      |ABRE #5;
      |BUCLE cambia;
      |CIERRA #5;
  |FINSI;
|FPRC;
