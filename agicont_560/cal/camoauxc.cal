|FICHEROS;
    camoauxc #0;
    camoauxl #1;
    caexistl #2;  || Descarga de Existencias.
    camocabe #3;  || Amortizaciones
    cacuenta #5;
|FIN;

|VARIABLES;
    &entrada = 1;
    &sw_lin = 0;
    salidas = 0;
    doce = "            ";
    sw = 0;
    long = 0;

    alfa1 = "";
    nume1 = 0;

    modo    = 0;
    inkey   = 0;
    sw_desc = 0;
    importe = 0;

  &r_emp = 0;
  &r_per = 0;
  &r_eje = 0;
  &r_nom = "";
  &cue_exis = "";
  &dig_exis = 0;
  &des_exis = "";
  &imp_exis = 0;
|FIN;

|INCLUYE inicio_i;
|INCLUYE puntos_i;

**************************************************************************
    LLAMADAS DESDE CUENTAS
**************************************************************************

|PROCESO cuenta; |TIPO 6;

  inkey = FSalida; |SI inkey = 9; |ACABA; |FINSI;
  modo = (FEntrada / 100) ! 0;

  p_alfa1 = #0Campo;
  |HAZ punto;
  |SI p_error ! 0;    |ERROR; |ACABA;  |FINSI;

  |SI #0Campo = doce; |Y modo ! 4; |ERROR; |ACABA; |FINSI;

  nume1 = Campo + 1;
  alfa1 = #0Campo;
  |QBF alfa1;
  alfa1 = alfa1 % 0;
  long = alfa1;
  sw   = 0;
  #0nume1 = 0;  || inicializa el digito
  |SI long = dig4; |Y dig4 ! 0; sw = 1; #0nume1 = 1; |FINSI;
  |SI long = dig5; |Y dig5 ! 0; sw = 1; #0nume1 = 2; |FINSI;
  |SI long = dig6; |Y dig6 ! 0; sw = 1; #0nume1 = 3; |FINSI;
  |SI long = dig7; |Y dig7 ! 0; sw = 1; #0nume1 = 4; |FINSI;
  |SI long = dig8; |Y dig8 ! 0; sw = 1; #0nume1 = 5; |FINSI;
  |SI long = dig9; |Y dig9 ! 0; sw = 1; #0nume1 = 6; |FINSI;
  |SI sw = 0;|Y long ! 0;
      |MENAV "    Longitud de Cuenta Fuera de Nivel !";
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;


|PROCESO refresca; |TIPO 0;

 inkey = FSalida;
 |SI inkey = 9;
     dig_exis = -1;
     r_emp = #30#2;
     r_per = #30#3;
     r_eje = #30#26;
     r_nom = #30#1;
     |SUB_EJECUTA "caexiaux.run";
     inkey = 0;
     |ERROR;
     |SI dig_exis ! -1;
         #0#0 = cue_exis; |PINTA #0#0;
         #0#1 = dig_exis;
         #0#2 = des_exis; |PINTA #0#2;
         #0#4 = imp_exis; |PINTA #0#4;
       ||  |PINDA #0#0;
         |PTEC 802;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #5#3 = "N";
      |MENAV "    Esta Cuenta No tiene Pase Directo";
      |ERROR;
      |ACABA;
  |FINSI;

  modo = (FEntrada / 100) ! 0;
  |SI modo = 1;
      |ABRE #3;
      |SELECT #4#3;
      #3#3 = #0#0;
      #3#4 = #0#1;
      |LEE 001#3=;
      |SI FSalida = 0;
          |MENAV "0000La cuenta YA existe en Amortizaciones";
          |ERROR;
      |FINSI;
      |SELECT #1#1;
      |CIERRA #3;
  |FINSI;
|FPRC;

|PROCESO si_esta;
 sw_desc = 1;
 importe = #2#23;
 |ERROR10;
|FPRC;

|DEFBUCLE descarga;
 #2#2;
 ;
 00, #0#0, #0#1;
 99, #0#0, #0#1;
 e;
 NULL, si_esta;
|FIN;

|PROCESO recoge; |TIPO 0;
 inkey = FSalida;
 importe = #0#4;

 |SI inkey = 10;
     importe = #5#53;
 |SINO;
      |SI inkey = 9;
          sw_desc = 0;
          |BUCLE descarga;
          |SI sw_desc = 0; |AVISO; |ERROR; |FINSI;
      |FINSI;
 |FINSI;

 #0#4 = importe;     |PINTA #0#4;
 #0#5 = #0#4 - #0#3; |PINTA #0#5;
|FPRC;
