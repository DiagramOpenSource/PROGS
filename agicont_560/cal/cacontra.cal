|FICHEROS;
   cacontra #0;
   camaasil #1;
   caconcic #2;
   caconcil #3;
   cacuenta #10;
|FIN;

|VARIABLES;
     &entrada = 1;
   sw     = 0;
   cuenta = "";
   digito = 0;
   linea  = 0;
   feini = @;
   fefin = @;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROCESO cuenta; |TIPO 0;
     salidas = FSalida;
    p_alfa1 = #0Campo;
|HAZ punto;
|SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
|FPRC;

|PROCESO grabali;
|ABRE #3;
linea = linea + 1;
#3#0 = #1#4;
#3#1 = #1#5;
#3#2 = linea;
#3#3 = 2;
#3#4 = #0#2;
#3#5 = #1#7;
|SI #1#8 = "D";
    #3#6 = #1#9;
    #3#7 = 0;
|SINO;
    #3#7 = #1#9;
    #3#6 = 0;
|FINSI;
#3#8 = " ";
|GRABA 040#3n;
|CIERRA #3;
|FPRC;

|PROCESO linea;
linea = #3#2;
|FPRC;

|DEFBUCLE mirali;
#3#1;
;
#1#4, #1#5, 001;
#1#4, #1#5, 999;
e;
NULL, linea;
|FIN;

|PROCESO pasalo;
|SI sw = 0;
    cuenta = #1#4;
    digito = #1#5;
    linea  = 0;
    |BUCLE mirali;
    sw     = 1;
|FINSI;

#2#0 = #1#4;
#2#1 = #1#5;
|LIBERA #2;
|LEE 110#2=;
|SI FSalida ! 0;
    |DDEFECTO #2;
    #2#0 = #1#4;
    #2#1 = #1#5;
    |HAZ miracuen;
    #2#3 = #0#2;
    |GRABA 020#2n;
    linea = 0;
|FINSI;

|SI cuenta ! #1#4; |O digito ! #1#5;
    cuenta = #1#4;
    digito = #1#5;
    linea  = 0;
    |BUCLE mirali;
|FINSI;

|HAZ grabali;
#1#18 = "û";
|GRABA 020#1a;
|LIBERA #1;
|FPRC;

|PROCESO miracuen;
|ABRE #10;
#10#0 = #2#0;
#10#1 = #2#1;
|LEE 040#10=;
|SI FSalida ! 0; |DDEFECTO #10; |FINSI;
#2#2 = #10#2;
|CIERRA #10;
|FPRC;

|DEFBUCLE camaasil;
#1#3;
18;
#0#0, 0, feini, 000000, " ";
#0#1, 9, fefin, 999999, " ";
be;
NULL, pasalo;
|FIN;

|PROCESO pase; |TIPO 3;
  |ABRE #2;
  feini = "01.01.1900";
  fefin = "31.12.2999";
  |BUCLE camaasil;
  |CIERRA #2;
|FPRC;
