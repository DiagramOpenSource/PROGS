|FICHEROS;
  caexiaux #0;
  caexistl #1;
|FIN;

|VARIABLES;
   &r_emp= 0;
   &r_per= 0;
   &r_eje= 0;
   &r_nom="";

   dir_fich = "";
   dirfich0 = "";
   alfa1 = "";
   alfa2 = "";

   lineas = 0;
   &cue_exis = "";
   &dig_exis = 0;
   &des_exis = "";
   &imp_exis = 0;
|FIN;

|INCLUYE i_ficher;
|| ******************************************************************

|PROCESO lee_existenci1;
  |DDEFECTO #0;
  lineas = lineas + 1;
  #0#0 = #1#0;
  #0#1 = #1#1;
  #0#2 = #1#2;
  #0#3 = #1#3;
  #0#4 = #1#4;
  #0#5 = #1#23;
  |GRABA 020#0n;
|FPRC;

|DEFBUCLE lee_existencia;
 #1#1;
 ;
 00,00;
 99,99;
 be;
 NULL,lee_existenci1;
|FIN;

|RUTINA min;
  #0#0 = 1;
  #0#1 = 1;
|FRUT;

|RUTINA max;
  #0#0 = 99;
  #0#1 = 99;
|FRUT;

|PROCESO dirfich0; || calcular el directorio base de los ficheros
  |DBASE dir_fich;
  dirfich0 = dir_fich + "fich/";
  alfa1 = r_emp;
  alfa2 = r_per;
  alfa1 = "00000" + alfa1;   alfa1 = alfa1 % -105;
  alfa2 = "0"   + alfa2;   alfa2 = alfa2 % -101;
  dirfich0 = dirfich0 + alfa1 + alfa2 + "/";

  |PATH_DAT #1 dirfich0;
|FPRC;


|PROGRAMA;
  |ATRI P;  |MENSA "    Cargando Opcion ...";  |ATRI 0;
  |HAZ fichero;
  |NOME_DAT #0 fichero;

  |HAZ dirfich0;

  |ABRE #0;
  |CIERRA #0;
  |DELINDEX #0;

  |ABRE #0;
  |BUCLE lee_existencia;
  |CIERRA #0;
  |BLIN 4;
  |PINPA #0#0;
  |ENTLINEAL #1#0, 2, 5, 20, 0, min, max;
  |DELINDEX #0;
|FPRO;

|PROCESO recoge; |TIPO 0;
  |SI FSalida = 0;
      cue_exis = #0#2;
      dig_exis = #0#3;
      des_exis = #0#4;
      imp_exis = #0#5;
  |FINSI;
|FPRC;
