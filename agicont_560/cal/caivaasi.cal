|FICHEROS;
    caivaasi #0;
    caconcep #1;
    cacuenta #4;
    calibros #10;
|FIN;

|VARIABLES;
    &entrada = 1;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    trara = "";
    sw = 0;
    men2  = "     Longitud de Cuenta Fuera de Nivel !";
    men3  = "      Esta Cuenta NO tiene Pase directo";
    men4  = "      Cuenta INEXISTENTE o no tiene Pase directo";
    long = "  ";
    cta  = 0;
    juan = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROGRAMA;
|HAZ inicio;
|CLS;
|CABEZA "Control Entrada Apu.";
|PINPA #0#0;
|ABRE #0;
|DDEFECTO #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|PROCESO recoge; |TIPO 7;
    nume1 = Campo - 2;
|ABRE #1;
    #1#0 = #0nume1;
|LEE 021#1=;
|SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
    #0Campo = #1#1;
|PINTA #0Campo;
|CIERRA #1;
|PTEC 816;
|FPRC;

|PROCESO nodepar; |TIPO 7;
|SI #30#24 = "N";
    |CAMPO_MODIFICA #0#19, 1, "N";
    |CAMPO_MODIFICA #0#20, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#19, 1, "S";
    |CAMPO_MODIFICA #0#20, 1, "S";
|FINSI;
|FPRC;

|PROCESO lee_libro;
|DDEFECTO #10;
|ABRE #10;
    #10#0 = #0Campo;
|LEE 000#10=;
|CIERRA #10;
|FPRC;

|PROCESO libro_rep; |TIPO 0;
|HAZ lee_libro;
|SI #10#2 ! "R";
    |MENAV "    ATENCION!!! Libro de I.V.A. Soportado ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO libro_sop; |TIPO 0;
|HAZ lee_libro;
|SI #10#2 ! "S";
    |MENAV "    ATENCION!!! Libro de I.V.A. Repercutido ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO mayus;
  trara = #0Campo > " ";
  #0Campo = trara;
  |PINTA #0Campo;
|FPRC;


|PROCESO cuefin; |TIPO 0;
    juan = Campo + 1;
|ABRE #4;
    #4#0 = #0Campo;
    #4#1 = #0juan;
|LEE 001#4=;
|SI FSalida = 0;
    |SI #4#3 = "N";
        |MENAV men3;
        |ERROR;
    |FINSI;
|SINO;
    |ERROR;
|FINSI;
|CIERRA #4;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  salidas = FSalida;
  p_alfa1 = #0Campo;
  |HAZ punto;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  juan = Campo + 1;
  #0juan = 0;
  alfa1 = #0Campo;
  |QBF alfa1;
  alfa2 = alfa1 % 0;
  long = alfa2;
  sw = 0;
  |SI long = dig4; sw = 1; #0juan = 1; |FINSI;
  |SI long = dig5; sw = 1; #0juan = 2; |FINSI;
  |SI long = dig6; sw = 1; #0juan = 3; |FINSI;
  |SI long = dig7; sw = 1; #0juan = 4; |FINSI;
  |SI long = dig8; sw = 1; #0juan = 5; |FINSI;
  |SI long = dig9; sw = 1; #0juan = 6; |FINSI;
  |SI long = 0;    sw = 1; #0juan = 0; |FINSI;
  |SI sw = 0;  |MENAV men2;  |ERROR;  |FINSI;
|FPRC;
