|FICHEROS;
    cacuenta #0;
    cacuebal #1;
    paagicon #2;
    caconcep #3;
    camaasil #4;
    camaasic #6;
    caclipro #7;
    calibros #9;
    caivasop #10;
    caivarep #11;
    camanban #12;
    camandia #13;
    caprovin #14;
    caconasi #15;
    camancob #16;
    camanpag #17;
    cacuepre #18;
    camocabe #19;
    camoline #20;
|FIN;

****************************
   Longitudes:
       cuentas -----> 642     cacuenta
       conceptos --->  33     caconcep
       lineas apunt.> 126     camaasil
       clientes ----> 326     caclipro
       proveedores -> 326     caclipro
       libros ------>  32     calibros
       repercutido -> 462     caivarep
       soportado ---> 461     caivasop
       bancos ------> 384     camanban
       cobros ------> 301     camancob
       pagos -------> 246     camanpag
       presupuestos > 167     cacuepre
       amortizacion > 262     camocabe
****************************

|VARIABLES;
  informe = "caliserr";
  &error = "INEXISTENTE Cuentas Balance";
  &erro = 0
  fiche="";
  traba="";
  canal= "";
  canal1= "";
  canal2= "";
  canal3= "";
  canal4= "";
  canal5= "";
  handle="";
  vari1="rb";
  espacio=" ";
  menos=-1;
  mascara = "";
  uno = "";
  dos = "";
  saber = "";
  men1  = "     NO EXISTE EMPRESA !";
  men2  = "     Longitud de Cuenta Fuera de Nivel !";
  fecalf = "";
  pepito="";
  sinnu="S/N";
  mensa1="     ERROR no existe el fichero";
  mensa2="     ERROR en la lectura del secuencial";
  mensa3="     ERROR longitud de registro invalida";
  val = 0;
  val1 = 0;
  val2 = 0;
  val3 = 0;
  val4 = 0;
  fec = @;
  linea = 0;
  trab1 = "";
  prima = @;
  long = "  ";
  parte = "";
  parte1 = "";
  ulti = "";
  feini = @;
  fefin = @;
  doini = 1;
  dofin = 999999;

    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    eixida = 0;
    trim1 = @;
    trim2 = @;
    trim3 = @;
    mayor = 0;
    pepe1 = 0;
    pepe2 = 0;
    pepe3 = 0;
    pepe4 = 0;
    pepe5 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    sw_dir = 0;
|FIN;

|INCLUYE acceso_i;

*************************************************************************
    CALCULOS DESDE CAMPOS
*************************************************************************

|PROCESO hazfiche; |TIPO 0;
    #2#1 = "scue" + #2#0;
    #2#2 = "scoa" + #2#0;
    #2#3 = "smov" + #2#0;
    #2#4 = "scli" + #2#0;
    #2#5 = "spro" + #2#0;
    #2#6 = "snat" + #2#0;
    #2#7 = "shic" + #2#0;
    #2#8 = "shiv" + #2#0;
    #2#9 = "sban" + #2#0;
    #2#10 = "scob" + #2#0;
    #2#11 = "spag" + #2#0;
    #2#12 = "spre" + #2#0;
    #2#13 = "samo" + #2#0;
|PINDA #0#2;
|FPRC;

|PROCESO def_dir; |TIPO 7;
|SI sw_dir = 0;
        alfa1 = "";
    |DIRECTORIO alfa1;
        #2#14 = alfa1;
    |PINTA #2#14;
        sw_dir = 1;
|FINSI;
|FPRC;

*************************************************************************
    ACTUALIZACION DE CABS. DE APUNTES DESDE IMPORTACION DE APUNTES
*************************************************************************

|PROCESO actuali;
|DDEFECTO #6;
    #6#0 = #4#0;
    #6#1 = #4#1;
    #6#2 = #4#2;
|LEE 101#6=;
|SI FSalida ! 0;
        #6#0 = #4#0;
        #6#1 = #4#1;
        #6#2 = #4#2;
        #6#3 = #4#2;
    |LIBERA #6;
    |GRABA 020#6c;
    |LEE 120#6=;   || la bloquea
|FINSI;
|SI #4#8 = "D";
        #6#4 = #6#4 + #4#9;
    |SI #6#09 = 0; #6#08 = #4#4; #6#09 = #4#5; |FINSI;      || contrp.HABER
|SINO;
        #6#5 = #6#5 + #4#9;
    |SI #6#11 = 0; #6#10 = #4#4; #6#11 = #4#5; |FINSI;      || contrp.DEBE
|FINSI;
    #6#6 = #6#4 - #6#5;
|GRABA 020#6a;
|LIBERA #6;
|FPRC;

|DEFBUCLE paagicon0;
 #4#1;
 ;
  0, feini, doini,    1;
 99, fefin, dofin, 9999;
 be;
 NULL, actuali;
|FIN;

*************************************************************************
       CALCULO PADRE
*************************************************************************

|PROCESO pase; |TIPO 3;
|IMPRE 0;
|SI FSalida = 0;

        alfa1 = #2#14;   |QBT alfa1;
        alfa2 = alfa1 % -101;
    |SI alfa2 ! "/";     alfa1 = alfa1 + "/";     |FINSI;
        vari1 = "rb  " + alfa1;

    |INFOR informe;
    |PARA para1 = 1; |SI para1 [ 13; |HACIENDO para1 = para1 + 1;
            alfa1 = #2para1;  |QBT alfa1;
        |SI alfa1 ! "*";|Y alfa1 ! "";
            |SI para1 = 1;    |HAZ hazcuent; |FINSI;
            |SI para1 = 2;    |HAZ hazconce; |FINSI;
            |SI para1 = 3;    |HAZ hazmovim; |FINSI;
            |SI para1 = 4;    |HAZ hazclien; |FINSI;
            |SI para1 = 5;    |HAZ hazprove; |FINSI;
            |SI para1 = 6;    |HAZ hazlibro; |FINSI;
            |SI para1 = 7;    |HAZ hazcompr; |FINSI;
            |SI para1 = 8;    |HAZ hazventa; |FINSI;
            |SI para1 = 9;    |HAZ hazbanco; |FINSI;
            |SI para1 = 10;   |HAZ hazcobro; |FINSI;
            |SI para1 = 11;   |HAZ hazpagos; |FINSI;
            |SI para1 = 12;   |HAZ hazpresu; |FINSI;
            |SI para1 = 13;   |HAZ hazamort; |FINSI;
            |PINTA 2040, "                                       ";
        |FINSI;
    |SIGUE;
    |PIEINF;
    |FININF;
|FINSI;
|FINIMP;
|FPRC;

|PROCESO hazcuent;
|ABRET #0;
|ABRET #1;
    fiche=vari1 + #2#1;
|QBF fiche;
|FABRE fiche;               ||  fichero de cuentas;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal  = handle + " 202";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 204";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                    canal2 = handle + " 236";
                |FLEE canal2;
                    eixida = FSalida;
                |SI FSalida > 0;
                    |HAZ separa;
                |FINSI;
            |FINSI;
        |FINSI;
    |SIGUE;
|FCIERRA handle;
    Pos = -1;
|FINSI;
|CIERRAT #0;
|CIERRAT #1;
|FPRC;

|PROCESO hazconce;
|ABRET #3;
    fiche=vari1 + #2#2;
|QBF fiche;
|FABRE fiche;              ||   fichero de conceptos
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 33";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
            |HAZ sepconce;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #3;
|FPRC;

|PROCESO hazmovim;
    mayor = 0;
|ABRET #3;
|ABRET #4;
|ABRET #13;
    fiche=vari1 + #2#3;           ||       FICHERO DE MOVIMIENTOS;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 126";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
            |HAZ sepdia;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #3;
|CIERRAT #4;
|CIERRAT #13;

|ABRE #6;
|CIERRA #6;
|DELINDEX #6;
|PINTA 2040," Recuperando Saldos de Cabeceras ...";
|ABRE #6;
    feini = "01.01.0000";
    fefin = "31.12.9999";
    doini = 1;
    dofin = 999999;
|BUCLE paagicon0;
|CIERRA #6;

|ABRE #15;
|LEE 001#15p;
|SI FSalida = 0;  |BORRA 020#15a;  |FINSI;
|DDEFECTO #15;
    #15#1 = mayor;
|GRABA 020#15n;
|CIERRA #15;
|FPRC;

|PROCESO hazclien;
  |ABRET #7;
  |ABRET #14;
  fiche=vari1 + #2#4;
  |QBF fiche;
  |FABRE fiche;               ||  fichero de CLIENTES;
  |SI FSalida ] 0;
      handle = FSalida;
      eixida = 1;  || para que entre en el bucle
      |PARA; |SI eixida > 0; |HACIENDO;
             canal = handle + " 186";
             |FLEE canal;
             eixida = FSalida;
             |SI FSalida > 0;
                  canal1 = handle + " 140";    ||125
                  |FLEE canal1;
                   eixida = FSalida;
                   |SI FSalida > 0;
                       |HAZ sepcli;
                   |FINSI;
             |FINSI;
      |SIGUE;
  |FINSI;
  |FCIERRA handle;
   Pos = -1;
  |CIERRAT #7;
  |CIERRAT #14;
|FPRC;

|PROCESO hazprove;
  |ABRET #7;
  |ABRET #14;
  fiche=vari1 + #2#5;
  |QBF fiche;
  |FABRE fiche;               ||  fichero de PROVEEDORES;
  |SI FSalida ] 0;
      handle = FSalida;
      eixida = 1;  || para que entre en el bucle
      |PARA; |SI eixida > 0; |HACIENDO;
             canal = handle + " 186";
             |FLEE canal;
             eixida = FSalida;
             |SI FSalida > 0;
                 canal1 = handle + " 140";
                 |FLEE canal1;
                 eixida = FSalida;
                 |SI FSalida > 0;
                     |HAZ seppro;
                 |FINSI;
             |FINSI;
      |SIGUE;
  |FINSI;
  |FCIERRA handle;
  Pos = -1;
  |CIERRAT #7;
  |CIERRAT #14;
|FPRC;

|PROCESO hazlibro;
|ABRET #9;
    fiche=vari1 + #2#6;
|QBF fiche;
|FABRE fiche;               ||  fichero de LIBROS DE IVA
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 32";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
            |HAZ seplib;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #9;
|FPRC;

|PROCESO hazcompr;
|ABRET #3;
|ABRET #9;
|ABRET #7;
|ABRET #10;
    fiche=vari1 + #2#7;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 227";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 234";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                |HAZ sepcom;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #3;
|CIERRAT #7;
|CIERRAT #9;
|CIERRAT #10;
|FPRC;

|PROCESO hazventa;
|ABRET #3;
|ABRET #7;
|ABRET #9;
|ABRET #11;
    fiche=vari1 + #2#8;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 227";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 235";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                |HAZ sepven;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
   Pos = -1;
|CIERRAT #3;
|CIERRAT #7;
|CIERRAT #9;
|CIERRAT #11;
|FPRC;

|PROCESO hazbanco;
|ABRET #12;
|ABRET #14;
    fiche=vari1 + #2#9;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 196";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 188";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                |HAZ sepban;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #11;
|CIERRAT #14;
|FPRC;

|PROCESO hazcobro;
|ABRET #16;
    fiche=vari1 + #2#10;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 222";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 79";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                |HAZ sepcob;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #16;
|FPRC;

|PROCESO hazpagos;
|ABRET #17;
    fiche=vari1 + #2#11;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 246";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
            |HAZ seppag;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #17;
|FPRC;

|PROCESO hazpresu;
|ABRET #18;
    fiche=vari1 + #2#12;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 167";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
            |HAZ seppre;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #18;
|FPRC;

|PROCESO hazamort;
|ABRET #19;
|ABRET #20;
    fiche=vari1 + #2#13;
|QBF fiche;
|FABRE fiche;
|SI FSalida ] 0;
        handle = FSalida;
        eixida = 1;  || para que entre en el bucle
    |PARA; |SI eixida > 0; |HACIENDO;
            canal = handle + " 192";
        |FLEE canal;
            eixida = FSalida;
        |SI FSalida > 0;
                canal1 = handle + " 70";
            |FLEE canal1;
                eixida = FSalida;
            |SI FSalida > 0;
                |HAZ sepamo;
            |FINSI;
        |FINSI;
    |SIGUE;
|FINSI;
|FCIERRA handle;
    Pos = -1;
|CIERRAT #19;
|CIERRAT #20;
|FPRC;

*************************************************************************
    'field' DEL PLAN CONTABLE
*************************************************************************

|PROCESO separa;
    traba = canal % 1301;
    #0#1 = traba;              || digito
|SI #0#1 = 1;  val = 100 + dig4;  |FINSI;
|SI #0#1 = 2;  val = 100 + dig5;  |FINSI;
|SI #0#1 = 3;  val = 100 + dig6;  |FINSI;
|SI #0#1 = 4;  val = 100 + dig7;  |FINSI;
|SI #0#1 = 5;  val = 100 + dig8;  |FINSI;
|SI #0#1 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 112;
    #0#0 = traba % trab1;    || cuenta
|LEE 101#0=;
|SI FSalida = 0;
    |HAZ separa1;
    |GRABA 020#0a;
|SINO;
    |DDEFECTO #0;
    |HAZ separa1;
    |GRABA 020#0n;
|FINSI;
|LIBERA #0;
    saber = " Actualizada Cuenta .: " + #0#0;
|PINTA 2040,saber;
|FPRC;

|PROCESO separa1;
    traba = canal % 1301;
    #0#1 = traba;          || digito
|SI #0#1 = 1;  val = 100 + dig4;  |FINSI;
|SI #0#1 = 2;  val = 100 + dig5;  |FINSI;
|SI #0#1 = 3;  val = 100 + dig6;  |FINSI;
|SI #0#1 = 4;  val = 100 + dig7;  |FINSI;
|SI #0#1 = 5;  val = 100 + dig8;  |FINSI;
|SI #0#1 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 112;
    #0#0 = traba % trab1;    || cuenta
    traba = canal % 1436;
    #0#2 = traba;            || descripcion
    traba = canal % 5001;
    #0#3 = traba;            || pase directo
|| la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
    mascara = #0#0;
|QBF mascara;
    mascara = mascara +"zzzzzzzzzzzz";
    mascara = mascara % 112;
    #0#54    = mascara;
    #0#55    = #0#1;
    uno = #0#0;
|QBF uno;
    dos = uno + "000000000000";
    uno = dos % A101;
    #1#0 = uno;
|LEE 040#1=;
|SI FSalida = 0;
    |HAZ saca;       || recoge bloque,tipo,agrupacion,epigrafe,partida
    |VETE findefe;
|FINSI;
    uno = dos % A102;
    #1#0 = uno;
|LEE 040#1=;
|SI FSalida = 0;
    |HAZ saca;
    |VETE findefe;
|FINSI;
    uno = dos % A103;
    #1#0 = uno;
|LEE 040#1=;
|SI FSalida = 0;
    |HAZ saca;
    |VETE findefe;
|FINSI;
  uno = dos % A104;
  #1#0 = uno;
  |LEE 040#1=;
  |SI FSalida = 0;
      |HAZ saca;
      |VETE findefe;
  |SINO;
      error = "INEXISTENTE Cuentas Balance";
      |PRINT;
  |FINSI;
|ET findefe;
|PARA nume1 =  9; |SI nume1 [ 20; |HACIENDO nume1 = nume1 + 1;
        nume2 = ( (59+ ((nume1-9)*12) ) * 100) + 12;
        alfa1 = nume2;
        traba = canal % alfa1;
        #0nume1 = traba;
|SIGUE;
|PARA nume1 = 21; |SI nume1 [ 37; |HACIENDO nume1 = nume1 + 1;
        nume2 = ( (1+ ((nume1-21)*12) ) * 100) + 12;
        alfa1 = nume2;
        traba = canal1 % alfa1;
        #0nume1 = traba;
|SIGUE;
|PARA nume1 = 38; |SI nume1 [ 53; |HACIENDO nume1 = nume1 + 1;
        nume2 = ( (1+ ((nume1-38)*12) ) * 100) + 12;
        alfa1 = nume2;
        traba = canal2 % alfa1;
        #0nume1 = traba;
|SIGUE;
    traba = canal2 % 20610;
    #0#56 = traba;
    traba = canal2 % 21610;
    #0#57 = traba;
    traba = canal2 % 22610;
    #0#58 = traba;
|FPRC;

|PROCESO saca;
  #0#4 = #1#1;
  #0#5 = #1#2;
  #0#6 = #1#3;
  #0#7 = #1#4;
  #0#8 = #1#5;
|FPRC;

*************************************************************************
    'field' DE LOS CONCEPTOS
*************************************************************************

|PROCESO sepconce;
    traba = canal % 103;
    #3#0 = traba;
|LEE 100#3=;
|SI FSalida = 0;
    |HAZ sepconc1;
    |GRABA 020#3a;
|SINO;
    |DDEFECTO #3;
    |HAZ sepconc1;
    |GRABA 020#3n;
|FINSI;
|LIBERA  #3;
    saber = " Actualizado Concepto: " + #3#0;
|PINTA 2040,saber;
|FPRC;

|PROCESO sepconc1;
    traba = canal % 103;
    #3#0 = traba;
    traba = canal % 430;
    #3#1 = traba;
|FPRC;

*************************************************************************
    'field' DE LINEAS DE APUNTES
*************************************************************************

|PROCESO sepdia;
    traba = canal %  102;
    #4#0 = traba;  || diario
    traba = canal %  310;
    #4#1 = traba;  || fecha
    traba = canal % 1306;
    #4#2 = traba;  || documento
    traba = canal % 1904;
    #4#3 = traba;  || apunte
|SI #4#1 ] fec1; |Y #4#1 [ fec2;
    |LEE 100#4=;
    |SI FSalida ! 0;
        |DDEFECTO #4;
        |HAZ sepdia1;
        |HAZ sepdia2;
        |GRABA 020#4n;
        |SI mayor < #4#2;  mayor = #4#2;  |FINSI;      || contador asientos
    |SINO;
        |HAZ sepdia1;
        |HAZ sepdia2;
    |FINSI;
    |LIBERA #4;
        saber = " Recuperando fecha ..: "+ #4#1;
    |PINTA 2040,saber;
|FINSI;
|FPRC;

|PROCESO sepdia1;
    traba = canal %  102;
    #4#0 = traba;  || diario
    traba = canal %  310;
    #4#1 = traba;  || fecha
    traba = canal % 1306;
    #4#2 = traba;  || documento
    traba = canal % 1904;
    #4#3 = traba;  || apunte
    traba = canal % 3501;
    #4#5 = traba;  || digito
|SI #4#5 = 1;  val = 100 + dig4;  |FINSI;
|SI #4#5 = 2;  val = 100 + dig5;  |FINSI;
|SI #4#5 = 3;  val = 100 + dig6;  |FINSI;
|SI #4#5 = 4;  val = 100 + dig7;  |FINSI;
|SI #4#5 = 5;  val = 100 + dig8;  |FINSI;
|SI #4#5 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 2312;
    #4#4 = traba % trab1;  || cuenta (segun digito)
    traba = canal % 3603;
    #4#6 = traba;    || concepto
|SI #4#6 = 0;  #4#6 = 999;    |FINSI;   || no se admite concepto cero
    traba = canal % 3930;
    #4#7 = traba;    || descrip. concepto
    traba = canal % 6901;
    #4#8 = traba;   || signo
    traba = canal % 7011;
    #4#9 = traba;   || importe
    traba = canal % 8112;
|SI #4#8 = "D";
        #4#16 = #4#4;
        #4#17 = #4#5;
        #4#10 = "";
        #4#11 = 0;
|SINO;
        #4#16 = "";
        #4#17 = 0;
        #4#10 = #4#4;
        #4#11 = #4#5;
|FINSI;
    traba = canal % 9401;
    #4#12 = traba;  || tipo ficha
    traba = canal % 9502;
    #4#13 = traba;  || libro
    traba = canal % 9706;
    #4#14 = traba;  || orden
    traba = canal % 10302;
    #4#15 = traba;  || serie
    traba = canal % 11801;
    #4#18 = traba;  || punteado
    traba = canal % 11901;
    #4#19 = traba;  || tipo de acumulador iva
    traba = canal % 12001;
    #4#20 = traba;  || nro. de acumulador iva
    traba = canal % 12102;
    #4#21 = traba;  || departamento
     traba = canal % 12303;
     #4#22 = traba; ||numero de recibo
     traba = canal % 12601;
     #4#23 = traba; ||Exportado
|FPRC;

|PROCESO sepdia2;  || COMPRUEBA CONCEPTOS Y ACTUALIZA DIARIO
    #3#0 = #4#6;
|LEE 000#3=;
|SI FSalida ! 0;    || si no existe el concepto lo genera con la descripcion
    |DDEFECTO #3;   ||/del apunte
        #3#0 = #4#6;
        #3#1 = #4#7;
    |GRABA 020#3n;
|FINSI;

    #13#0 = #4#0;
|LEE 100#13=;
|SI FSalida ! 0;
    |DDEFECTO #13;
        #13#0 = #4#0;
        #13#1 = "<DIARIO IMPORTACION>";
    |LIBERA #13;
    |GRABA 020#13c;
    |LEE 100#13=;
|FINSI;
|SI #4#8 = "D";  #13#2 = #13#2 + #4#9;  |FINSI;
|SI #4#8 = "H";  #13#3 = #13#3 + #4#9;  |FINSI;
|GRABA 020#13a;
|LIBERA #13;
|FPRC;

*************************************************************************
    'field' DE CLIENTES
*************************************************************************

|PROCESO sepcli;
  traba = canal % 18501;
  #7#11 = traba;        || dig. cuenta
  |SI #7#11 = 1;  val = 100 + dig4;  |FINSI;
  |SI #7#11 = 2;  val = 100 + dig5;  |FINSI;
  |SI #7#11 = 3;  val = 100 + dig6;  |FINSI;
  |SI #7#11 = 4;  val = 100 + dig7;  |FINSI;
  |SI #7#11 = 5;  val = 100 + dig8;  |FINSI;
  |SI #7#11 = 6;  val = 100 + dig9;  |FINSI;
  trab1 = val;
  traba = canal % 17312;
  #7#10 = traba % trab1;  || cta. contable (segun digito)
  #7#23 = "C";
  |LEE 100#7=;
  |SI FSalida = 0;
      |HAZ sepcli1;
      |GRABA 020#7a;
  |SINO;
      |DDEFECTO #7;
      #7#23 = "C";
      |HAZ sepcli1;
      |GRABA 020#7n;
  |FINSI;
  |LIBERA #7;
  saber = " Actualizando Cliente: " + #7#0;
  |PINTA 2040,saber;
|FPRC;

|PROCESO sepcli1;
  traba = canal % 112;
  #7#0 = traba;    || codigo cliente
  traba = canal % 1340;
  #7#1 = traba;    || razon social
  traba = canal % 5330;
  #7#2 = traba;    || direccion
  traba = canal % 8302;
  #7#3 = traba;    || codigo provincia
  traba = canal % 8503;
  #7#4 = traba;    || codigo poblacion
  #14#0 = #7#3;
  |LEE 000#14=;
  |SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;
  #7#5 = #14#1;         || provincia
  traba = canal % 10325;
  #7#6 = traba;         || poblacion
  traba = canal % 12815;
  #7#7 = traba;         || telefono
  traba = canal % 14315;
  #7#8 = traba;         || fax
  traba = canal % 15815;
  #7#9 = traba;         || cif
  traba = canal % 18501;
  #7#11 = traba;        || dig. cuenta
  |SI #7#11 = 1;  val = 100 + dig4;  |FINSI;
  |SI #7#11 = 2;  val = 100 + dig5;  |FINSI;
  |SI #7#11 = 3;  val = 100 + dig6;  |FINSI;
  |SI #7#11 = 4;  val = 100 + dig7;  |FINSI;
  |SI #7#11 = 5;  val = 100 + dig8;  |FINSI;
  |SI #7#11 = 6;  val = 100 + dig9;  |FINSI;
  trab1 = val;
  traba = canal % 17312;
  #7#10 = traba % trab1;  || cta. contable (segun digito)
  traba = canal % 18601;
  #7#12 = traba;          || grupo iva
  traba = canal1 %  130;
  #7#13 = traba;          || nombre banco
  traba = canal1 % 3130;
  #7#14 = traba;          || direccion banco
  traba = canal1 % 6102;
  #7#15 = traba;          || cod.post.1 banco
  traba = canal1 % 6303;
  #7#16 = traba;          || cod.post.2 banco
  traba = canal1 % 6620;
  #7#17 = traba;          || cta. cte.
  traba = canal1 % 8615;
  #7#18 = traba;          || C.C.C.
  traba = canal1 % 10125;
  #7#19 = traba;          || poblacion banco
|FPRC;

*************************************************************************
    'field' DE PROVEEDORES
*************************************************************************

|PROCESO seppro;
  traba = canal % 18501;
  #7#11 = traba;        || dig. cuenta
  |SI #7#11 = 1;  val = 100 + dig4;  |FINSI;
  |SI #7#11 = 2;  val = 100 + dig5;  |FINSI;
  |SI #7#11 = 3;  val = 100 + dig6;  |FINSI;
  |SI #7#11 = 4;  val = 100 + dig7;  |FINSI;
  |SI #7#11 = 5;  val = 100 + dig8;  |FINSI;
  |SI #7#11 = 6;  val = 100 + dig9;  |FINSI;
  trab1 = val;
  traba = canal % 17312;
  #7#10 = traba % trab1;  || cta. contable (segun digito)
  #7#23 = "P";
  |LEE 100#7=;
  |SI FSalida = 0;
      |HAZ sepcli1;
      |GRABA 020#7a;
  |SINO;
      |DDEFECTO #7;
      #7#23 = "P";
      |HAZ sepcli1;
      |GRABA 020#7n;
  |FINSI;
  |LIBERA #7;
  saber = " Actualizando Proveed.:" + #7#0;
  |PINTA 2040,saber;
|FPRC;


*************************************************************************
    'field' DE LIBROS
*************************************************************************

|PROCESO seplib;
    traba = canal % 102;
    #9#0 = traba;
|LEE 100#9=;
|SI FSalida = 0;
    |HAZ seplib1;
    |GRABA 020#9a;
|SINO;
    |DDEFECTO #9;
    |HAZ seplib1;
    |GRABA 020#9n;
|FINSI;
|LIBERA #9;
    saber = " Actualizado Libro ..: " + #9#0;
|PINTA 2040,saber;
|FPRC;

|PROCESO seplib1;
    traba = canal %  102;
    #9#0 = traba;        || codigo
    traba = canal %  329;
    #9#1 = traba;        || descripcion
    traba = canal % 3201;
    #9#2 = traba;        || tipo de iva
|FPRC;

*************************************************************************
    'field' DE IVA SOPORTADO
*************************************************************************

|PROCESO sepcom;
    traba = canal % 102;
    #10#0 = traba;        || libro
    traba = canal % 3306;
    #10#2 = traba;        || orden
|LEE 100#10=;
|SI FSalida = 0;
    |HAZ sepcom1;
    |HAZ sepcom2;
    |GRABA 020#10a;
|SINO;
    |DDEFECTO #10;
    |HAZ sepcom1;
    |HAZ sepcom2;
    |GRABA 020#10n;
|FINSI;
|LIBERA #10;
    saber = " Actualizado Soportado:" + #10#2;
|PINTA 2040,saber;
|FPRC;

|PROCESO sepcom1;
    traba = canal % 102;
    #10#0 = traba;       || libro
    #9#0 = #10#0;
|LEE 000#9=;
|SI FSalida = 0;
        #10#1 = #9#1;
|SINO;
        #10#1 = "IVA SOPORTADO";
|FINSI;
    traba = canal % 3306;
    #10#2 = traba;         || orden
    traba = canal % 3910;
    #10#3 = traba;         || fecha
    traba = canal % 6101;
    #10#5 = traba;         || digito
|SI #10#5 = 1;  val = 100 + dig4;  |FINSI;
|SI #10#5 = 2;  val = 100 + dig5;  |FINSI;
|SI #10#5 = 3;  val = 100 + dig6;  |FINSI;
|SI #10#5 = 4;  val = 100 + dig7;  |FINSI;
|SI #10#5 = 5;  val = 100 + dig8;  |FINSI;
|SI #10#5 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 4912;
    #10#4 = traba % trab1; || cuenta
    traba = canal % 6203;
    #10#6 = traba;         || concepto
    traba = canal % 6530;
    #10#7 = traba;         || descrip. concepto
    traba = canal % 9510;
    #10#8 = traba;         || base 1
    traba = canal % 10510;
    #10#9 = traba;         || base 2
    traba = canal % 11510;
    #10#10 = traba;        || base 3
    traba = canal % 12505;
    #10#11 = traba;        || (%) iva 1
    traba = canal % 13005;
    #10#12 = traba;        || (%) iva 2
    traba = canal % 13505;
    #10#13 = traba;        || (%) iva 3
    traba = canal % 14010;
    #10#14 = traba;        || cuota iva 1
    traba = canal % 15010;
    #10#15 = traba;        || cuota iva 2
    traba = canal % 16010;
    #10#16 = traba;        || cuota iva 3
    traba = canal % 17005;
    #10#17 = traba;        || (%) rec. 1
    traba = canal % 17505;
    #10#18 = traba;        || (%) rec. 2
    traba = canal % 18005;
    #10#19 = traba;        || (%) rec. 3
    traba = canal % 18510;
    #10#20 = traba;        || cuota rec. 1
    traba = canal % 19510;
    #10#21 = traba;        || cuota rec. 2
    traba = canal % 20510;
    #10#22 = traba;        || cuota rec. 3
    traba = canal % 21501;
    #10#23 = traba;        || deducible 1
    traba = canal % 21601;
    #10#24 = traba;        || deducible 2
    traba = canal % 21701;
    #10#25 = traba;        || deducible 3
    traba = canal1 % 101;
    #10#27 = traba;           || campo INHIBIDO!!!
    traba = canal1 % 201;
    #10#28 = traba;           || liquidada
    traba = canal1 % 301;
    #10#29 = traba;           || grupo iva 1
    traba = canal1 % 401;
    #10#30 = traba;           || grupo iva 2
    traba = canal1 % 501;
    #10#31 = traba;           || grupo iva 3
    traba = canal1 % 602;
    #10#32 = traba;           || tipo iva 1
    traba = canal1 % 802;
    #10#33 = traba;           || tipo iva 2
    traba = canal1 % 1002;
    #10#34 = traba;           || tipo iva 3
    traba = canal1 % 1212;
    #10#35 = traba;           || contrapartida 1
    nume4 = 0;
|HAZ conivas;
    #10#38 = nume4;           || digito contrapartida 1
    traba = canal1 % 2412;
    #10#36 = traba;           || contrapartida 2
    nume4 = 0;
|HAZ conivas;
    #10#39 = nume4;           || digito contrapartida 2
    traba = canal1 % 3612;
    #10#37 = traba;           || contrapartida 3
    nume4 = 0;
|HAZ conivas;
    #10#40 = nume4;           || digito contrapartida 3
    traba = canal1 % 5110;
    #10#41 = traba;           || importe dto. 1
    traba = canal1 % 6110;
    #10#42 = traba;           || importe dto. 2
    traba = canal1 % 7110;
    #10#43 = traba;           || importe dto. 3

    alfa1 = fec1;      alfa1 = alfa1 %  -104;  || saca a¤o
    alfa2 = "31.03." + alfa1;  trim1 = alfa2;  || primer trimestre
    alfa2 = "30.06." + alfa1;  trim2 = alfa2;  || segundo trimestre
    alfa2 = "30.09." + alfa1;  trim3 = alfa2;  || tercer trimestre
|SI #10#3 [ trim1;                   #10#44 = 1;  |FINSI;
|SI #10#3 > trim1;|Y #10#3 [ trim2;  #10#44 = 2;  |FINSI;
|SI #10#3 > trim2;|Y #10#3 [ trim3;  #10#44 = 3;  |FINSI;
|SI #10#3 > trim3;                   #10#44 = 4;  |FINSI;
                              || periodo (segun fecha)
    traba = canal1 % 8302;
    #10#45 = traba;           || diario
    traba = canal1 % 8510;
    #10#46 = traba;           || fecha
    traba = canal1 % 9506;
    #10#47 = traba;           || documento
    traba = canal1 % 10101;
    #10#48 = traba;           || inversion
    traba = canal1 % 10202;
    #10#49 = traba;           || departamento

    #7#23 = "P";
    #7#10 = #10#4;
    #7#11 = #10#5;
|LEE 000#7=;
|SI FSalida = 0;
        #10#50 = #7#1;
        #10#51 = #7#9;
|SINO;
        traba = canal1 % 10436;
        #10#50 = traba;           || nombre proveedor/acreedor
        traba = canal1 % 14015;
        #10#51 = traba;           || cif proveedor/acreedor
|FINSI;

    traba = canal1 % 15510;
    #10#52 = traba;           || base 4
    traba = canal1 % 16510;
    #10#53 = traba;           || base 5
    traba = canal1 % 17505;
    #10#54 = traba;           || (%) iva 4
    traba = canal1 % 18005;
    #10#55 = traba;           || (%) iva 5
    traba = canal1 % 18510;
    #10#56 = traba;           || cuota iva 4
    traba = canal1 % 19510;
    #10#57 = traba;           || cuota iva 5
    traba = canal1 % 20505;
    #10#58 = traba;           || (%) rec 4
    traba = canal1 % 21005;
    #10#59 = traba;           || (%) rec 5
    traba = canal1 % 21510;
    #10#60 = traba;           || cuota rec 4
    traba = canal1 % 22510;
    #10#61 = traba;           || cuota rec 5

    pepe1 = #10#08+#10#14+#10#20;       || total 1
    pepe2 = #10#09+#10#15+#10#21;       || total 2
    pepe3 = #10#10+#10#16+#10#22;       || total 3
    pepe4 = #10#52+#10#56+#10#60;       || total 4
    pepe5 = #10#53+#10#57+#10#61;       || total 5
    #10#26 = pepe1 + pepe2 + pepe3 + pepe4 + pepe5;
                           || total factura (recalculado!!!)
|FPRC;

|PROCESO sepcom2;
    #3#0 = #10#6;
|LEE 000#3=;
|SI FSalida ! 0;    || si no existe el concepto lo genera con la descripcion
    |DDEFECTO #3;   ||/del iva
        #3#0 = #10#6;
        #3#1 = #10#7;
    |GRABA 020#3n;
|FINSI;
|FPRC;

*************************************************************************
    'field' DE IVA REPERCUTIDO
*************************************************************************

|PROCESO sepven;
    traba = canal % 102;
    #11#0 = traba;        || libro
    traba = canal % 3306;
    #11#2 = traba;        || orden
|LEE 100#11=;
|SI FSalida = 0;
    |HAZ sepven1;
    |HAZ sepven2;
    |GRABA 020#11a;
|SINO;
    |DDEFECTO #11;
    |HAZ sepven1;
    |HAZ sepven2;
    |GRABA 020#11n;
|FINSI;
|LIBERA #11;
    saber = " Actualizado Repercut.:" + #11#2 + #11#27;
|PINTA 2040,saber;
|FPRC;

|PROCESO sepven1;
    traba = canal % 102;
    #11#0 = traba;       || libro
    #9#0 = #11#0;
|LEE 000#9=;
|SI FSalida = 0;
        #11#1 = #9#1;
|SINO;
        #11#1 = "IVA REPERCUTIDO";
|FINSI;
    traba = canal % 3306;
    #11#2 = traba;         || orden
    traba = canal % 3910;
    #11#3 = traba;         || fecha
    traba = canal % 6101;
    #11#5 = traba;         || digito
|SI #11#5 = 1;  val = 100 + dig4;  |FINSI;
|SI #11#5 = 2;  val = 100 + dig5;  |FINSI;
|SI #11#5 = 3;  val = 100 + dig6;  |FINSI;
|SI #11#5 = 4;  val = 100 + dig7;  |FINSI;
|SI #11#5 = 5;  val = 100 + dig8;  |FINSI;
|SI #11#5 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 4912;
    #11#4 = traba % trab1; || cuenta
    traba = canal % 6203;
    #11#6 = traba;         || concepto
    traba = canal % 6530;
    #11#7 = traba;         || descrip. concepto
    traba = canal % 9510;
    #11#8 = traba;         || base 1
    traba = canal % 10510;
    #11#9 = traba;         || base 2
    traba = canal % 11510;
    #11#10 = traba;        || base 3
    traba = canal % 12505;
    #11#11 = traba;        || (%) iva 1
    traba = canal % 13005;
    #11#12 = traba;        || (%) iva 2
    traba = canal % 13505;
    #11#13 = traba;        || (%) iva 3
    traba = canal % 14010;
    #11#14 = traba;        || cuota iva 1
    traba = canal % 15010;
    #11#15 = traba;        || cuota iva 2
    traba = canal % 16010;
    #11#16 = traba;        || cuota iva 3
    traba = canal % 17005;
    #11#17 = traba;        || (%) rec. 1
    traba = canal % 17505;
    #11#18 = traba;        || (%) rec. 2
    traba = canal % 18005;
    #11#19 = traba;        || (%) rec. 3
    traba = canal % 18510;
    #11#20 = traba;        || cuota rec. 1
    traba = canal % 19510;
    #11#21 = traba;        || cuota rec. 2
    traba = canal % 20510;
    #11#22 = traba;        || cuota rec. 3
    traba = canal % 21501;
    #11#23 = traba;        || deducible 1
    traba = canal % 21601;
    #11#24 = traba;        || deducible 2
    traba = canal % 21701;
    #11#25 = traba;        || deducible 3
    traba = canal1 % 102;
    #11#27 = traba;           || serie
    traba = canal1 % 301;
    #11#28 = traba;           || liquidada
    traba = canal1 % 401;
    #11#29 = traba;           || grupo iva 1
    traba = canal1 % 501;
    #11#30 = traba;           || grupo iva 2
    traba = canal1 % 601;
    #11#31 = traba;           || grupo iva 3
    traba = canal1 % 702;
    #11#32 = traba;           || tipo iva 1
    traba = canal1 % 902;
    #11#33 = traba;           || tipo iva 2
    traba = canal1 % 1102;
    #11#34 = traba;           || tipo iva 3
    traba = canal1 % 1312;
    #11#35 = traba;           || contrapartida 1
    nume4 = 0;
|HAZ conivas;
    #11#38 = nume4;           || digito contrapartida 1
    traba = canal1 % 2512;
    #11#36 = traba;           || contrapartida 2
    nume4 = 0;
|HAZ conivas;
    #11#39 = nume4;           || digito contrapartida 2
    traba = canal1 % 3712;
    #11#37 = traba;           || contrapartida 3
    nume4 = 0;
|HAZ conivas;
    #11#40 = nume4;           || digito contrapartida 3
    traba = canal1 % 5210;
    #11#41 = traba;           || importe dto. 1
    traba = canal1 % 6210;
    #11#42 = traba;           || importe dto. 2
    traba = canal1 % 7210;
    #11#43 = traba;           || importe dto. 3

    alfa1 = fec1;      alfa1 = alfa1 %  -104;  || saca a¤o
    alfa2 = "31.03." + alfa1;  trim1 = alfa2;  || primer trimestre
    alfa2 = "30.06." + alfa1;  trim2 = alfa2;  || segundo trimestre
    alfa2 = "30.09." + alfa1;  trim3 = alfa2;  || tercer trimestre
|SI #11#3 [ trim1;                   #11#44 = 1;  |FINSI;
|SI #11#3 > trim1;|Y #11#3 [ trim2;  #11#44 = 2;  |FINSI;
|SI #11#3 > trim2;|Y #11#3 [ trim3;  #11#44 = 3;  |FINSI;
|SI #11#3 > trim3;                   #11#44 = 4;  |FINSI;
                              || periodo (segun fecha)
    traba = canal1 % 8402;
    #11#45 = traba;           || diario
    traba = canal1 % 8610;
    #11#46 = traba;           || fecha
    traba = canal1 % 9606;
    #11#47 = traba;           || documento
    traba = canal1 % 10201;
    #11#48 = traba;           || inversiones
    traba = canal1 % 10302;
    #11#49 = traba;           || departamento

    #7#23 = "C";
    #7#10 = #11#4;
    #7#11 = #11#5;
|LEE 000#7=;
|SI FSalida = 0;
        #11#50 = #7#1;
        #11#51 = #7#9;
|SINO;
        traba = canal1 % 10536;
        #11#50 = traba;           || nombre cliente/deudor
        traba = canal1 % 14115;
        #11#51 = traba;           || cif cliente/deudor
|FINSI;
    traba = canal1 % 15610;
    #11#52 = traba;           || base 4
    traba = canal1 % 16610;
    #11#53 = traba;           || base 5
    traba = canal1 % 17605;
    #11#54 = traba;           || (%) iva 4
    traba = canal1 % 18105;
    #11#55 = traba;           || (%) iva 5
    traba = canal1 % 18610;
    #11#56 = traba;           || cuota iva 4
    traba = canal1 % 19610;
    #11#57 = traba;           || cuota iva 5
    traba = canal1 % 20605;
    #11#58 = traba;           || (%) rec 4
    traba = canal1 % 21105;
    #11#59 = traba;           || (%) rec 5
    traba = canal1 % 21610;
    #11#60 = traba;           || cuota rec 4
    traba = canal1 % 22610;
    #11#61 = traba;           || cuota rec 5

    pepe1 = #11#08+#11#14+#11#20;       || total 1
    pepe2 = #11#09+#11#15+#11#21;       || total 2
    pepe3 = #11#10+#11#16+#11#22;       || total 3
    pepe4 = #11#52+#11#56+#11#60;       || total 4
    pepe5 = #11#53+#11#57+#11#61;       || total 5
    #11#26 = pepe1 + pepe2 + pepe3 + pepe4 + pepe5;
                           || total factura (recalculado!!!)
|FPRC;

|PROCESO sepven2;
    #3#0 = #11#6;
|LEE 000#3=;
|SI FSalida ! 0;    || si no existe el concepto lo genera con la descripcion
    |DDEFECTO #3;   ||/del iva
        #3#0 = #11#6;
        #3#1 = #11#7;
    |GRABA 020#3n;
|FINSI;
|FPRC;

*************************************************************************
   CALCULO COMUN PARA SOPORTADO Y REPERCUTIDO (saca digito contrapartida)
*************************************************************************

|PROCESO conivas;
|QBF traba;
    long = traba % 0;
|SI long = dig4;|Y dig4 ! 0;   nume4 = 1;  |FINSI;
|SI long = dig5;|Y dig5 ! 0;   nume4 = 2;  |FINSI;
|SI long = dig6;|Y dig6 ! 0;   nume4 = 3;  |FINSI;
|SI long = dig7;|Y dig7 ! 0;   nume4 = 4;  |FINSI;
|SI long = dig8;|Y dig8 ! 0;   nume4 = 5;  |FINSI;
|SI long = dig9;|Y dig9 ! 0;   nume4 = 6;  |FINSI;
|FPRC;

*************************************************************************
    'field' DE LOS BANCOS
*************************************************************************

|PROCESO sepban;
    traba = canal % 103;
    #12#0 = traba;
|LEE 100#12=;
|SI FSalida = 0;
    |HAZ sepban1;
    |GRABA 020#12a;
|SINO;
    |DDEFECTO #12;
    |HAZ sepban1;
    |GRABA 020#12n;
|FINSI;
|LIBERA #12;
    saber = " Actualizado Bancos .: " + #12#0;
|PINTA 2040,saber;
|FPRC;

|PROCESO sepban1;
    traba = canal % 103;
    #12#0 = traba;            || codigo banco
    traba = canal % 440;
    #12#1 = traba;            || nombre
    traba = canal % 4430;
    #12#2 = traba;            || direccion
    traba = canal % 7402;
    #12#3 = traba;            || codigo provincia
    traba = canal % 7603;
    #12#4 = traba;            || codigo poblacion
    #14#0 = #12#3;
|LEE 000#14=;
|SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;
    #12#5 = #14#1;            || provincia (del fichero)
    traba = canal % 9425;
    #12#6 = traba;            || poblacion
    traba = canal % 11915;
    #12#7 = traba;            || telefono
    traba = canal % 13415;
    #12#8 = traba;            || cta.cte.
    traba = canal % 14915;
    #12#9 = traba;            || c.c.c.
    traba = canal % 17601;
    #12#11 = traba;           || digito cta. contable
|SI #12#11 = 1;  val = 100 + dig4;  |FINSI;
|SI #12#11 = 2;  val = 100 + dig5;  |FINSI;
|SI #12#11 = 3;  val = 100 + dig6;  |FINSI;
|SI #12#11 = 4;  val = 100 + dig7;  |FINSI;
|SI #12#11 = 5;  val = 100 + dig8;  |FINSI;
|SI #12#11 = 6;  val = 100 + dig9;  |FINSI;
    trab1 = val;
    traba = canal % 16412;
    #12#10 = traba % trab1;   || cuenta contable
    traba = canal % 17710;
    #12#12 = traba;           || riesgo concedido
    traba = canal % 18710;
    #12#13 = traba;           || riesgo actual
    traba = canal1 % 115;
    #12#14 = traba;           || cif
    traba = canal1 % 1615;
    #12#15 = traba;           || fax
    traba = canal1 % 3108;
    #12#16 = traba;           || comision por efecto
    traba = canal1 % 3906;
    #12#17 = traba;           || interes anual
    traba = canal1 % 4530;
    #12#18 = traba;           || persona contacto
    traba = canal1 % 7570;
    #12#19 = traba;           || observaciones
    traba = canal1 % 14503;
    #12#20 = traba;           || desde intereses 1
    traba = canal1 % 14803;
    #12#21 = traba;           || desde intereses 2
    traba = canal1 % 15103;
    #12#22 = traba;           || desde intereses 3
    traba = canal1 % 15403;
    #12#23 = traba;           || desde intereses 4
    traba = canal1 % 15703;
    #12#24 = traba;           || hasta intereses 1
    traba = canal1 % 16003;
    #12#25 = traba;           || hasta intereses 2
    traba = canal1 % 16303;
    #12#26 = traba;           || hasta intereses 3
    traba = canal1 % 16603;
    #12#27 = traba;           || hasta intereses 4
    traba = canal1 % 16905;
    #12#28 = traba;           || interes 1
    traba = canal1 % 17405;
    #12#29 = traba;           || interes 2
    traba = canal1 % 17905;
    #12#30 = traba;           || interes 3
    traba = canal1 % 18405;
    #12#31 = traba;           || interes 4
|FPRC;

*************************************************************************
    'field' DE LOS COBROS
*************************************************************************

|PROCESO sepcob;
    traba = canal % 102;
    #16#0 = traba;
    traba = canal % 306;
    #16#1 = traba;
    traba = canal % 902;
    #16#2 = traba;
    traba = canal % 1103;
    #16#3 = traba;
|LEE 100#16=;
|SI FSalida = 0;
    |HAZ sepcob1;
    |GRABA 020#16a;
|SINO;
    |DDEFECTO #16;
    |HAZ sepcob1;
    |GRABA 020#16n;
|FINSI;
|LIBERA #16;
    saber = " Actualizado Cobro: " + #16#0 + "-" + #16#1 + "-" + #16#2 + "-" + #16#3;
|PINTA 2040,saber;
|FPRC;

|PROCESO sepcob1;
    traba = canal % 102;
    #16#0 = traba;            || libro
    traba = canal % 306;
    #16#1 = traba;            || factura
    traba = canal % 902;
    #16#2 = traba;            || serie
    traba = canal % 1103;
    #16#3 = traba;            || nro.cobro
    traba = canal % 1412;
    #16#4 = traba;            || cuenta cliente
    traba = canal % 2601;
    #16#5 = traba;            || digito
    traba = canal % 2710;
    #16#6 = traba;            || fecha emision
    traba = canal % 3710;
    #16#7 = traba;            || fecha vto.
    traba = canal % 4711;
    #16#8 = traba;            || importe con impagos
    traba = canal % 5811;
    #16#9 = traba;            || gastos negociacion
    traba = canal % 6911;
    #16#10 = traba;           || gastos impagados
    traba = canal % 8002;
    #16#11 = traba;           || tipo recibo
    traba = canal % 8205;
    #16#12 = traba;           || nro. remesa
    traba = canal % 8701;
    #16#13 = traba;           || emitido S/N
    traba = canal % 8810;
    #16#14 = traba;           || vto. original
    traba = canal % 9830;
    #16#15 = traba;           || nombre banco
    traba = canal % 12830;
    #16#16 = traba;           || direccion banco
    traba = canal % 15802;
    #16#17 = traba;           || c.p. 1 banco
    traba = canal % 16003;
    #16#18 = traba;           || c.p. 2 banco
    traba = canal % 16320;
    #16#19 = traba;           || cuenta corriente
    traba = canal % 18315;
    #16#20 = traba;           || CCC
    traba = canal % 19825;
    #16#21 = traba;           || poblacion banco

    traba = canal1 % 150;
    #16#22 = traba;           || observaciones
    traba = canal1 % 5101;
    #16#23 = traba;           || liquidado S/N
    traba = canal1 % 5211;
    #16#24 = traba;           || ptas. liquidadas
    traba = canal1 % 6301;
    #16#25 = traba;           || exportado S/N
    traba = canal1 % 6411;
    #16#26 = traba;           || importe original
    traba = canal1 % 7505;
    #16#27 = traba;           || nro. impagos
|FPRC;

*************************************************************************
    'field' DE LOS PAGOS
*************************************************************************

|PROCESO seppag;
    traba = canal % 102;
    #17#0 = traba;
    traba = canal % 306;
    #17#1 = traba;
    traba = canal % 902;
    #17#2 = traba;
    traba = canal % 1103;
    #17#3 = traba;
|LEE 100#17=;
|SI FSalida = 0;
    |HAZ seppag1;
    |GRABA 020#17a;
|SINO;
    |DDEFECTO #17;
    |HAZ seppag1;
    |GRABA 020#17n;
|FINSI;
|LIBERA #17;
    saber = " Actualizado Pago: " + #17#0 + "-" + #17#1 + "-" + #17#2 + "-" + #17#3;
|PINTA 2040,saber;
|FPRC;

|PROCESO seppag1;
    traba = canal % 102;
    #17#0 = traba;            || libro
    traba = canal % 306;
    #17#1 = traba;            || orden
    traba = canal % 902;
    #17#2 = traba;            || serie
    traba = canal % 1103;
    #17#3 = traba;            || nro.pago
    traba = canal % 1412;
    #17#4 = traba;            || cuenta proveedor
    traba = canal % 2601;
    #17#5 = traba;            || digito
    traba = canal % 2710;
    #17#6 = traba;            || fecha emision
    traba = canal % 3710;
    #17#7 = traba;            || fecha vto.
    traba = canal % 4711;
    #17#8 = traba;            || importe
    traba = canal % 5811;
    #17#9 = traba;            || gastos negociacion
    traba = canal % 6911;
    #17#10 = traba;           || ~
    traba = canal % 8002;
    #17#11 = traba;           || tipo recibo
    traba = canal % 8206;
    #17#12 = traba;           || nro. pagare
    traba = canal % 8801;
    #17#13 = traba;           || emitido S/N
    traba = canal % 8930;
    #17#14 = traba;           || nombre banco
    traba = canal % 11930;
    #17#15 = traba;           || direccion banco
    traba = canal % 14902;
    #17#16 = traba;           || c.p. 1 banco
    traba = canal % 15103;
    #17#17 = traba;           || c.p. 2 banco
    traba = canal % 15420;
    #17#18 = traba;           || cuenta corriente
    traba = canal % 17415;
    #17#19 = traba;           || CCC
    traba = canal % 18925;
    #17#20 = traba;           || poblacion banco
    traba = canal % 21420;
    #17#21 = traba;           || observaciones
    traba = canal % 23401;
    #17#22 = traba;           || liquidado S/N
    traba = canal % 23511;
    #17#23 = traba;           || ptas. liquidadas
    traba = canal % 24501;
    #17#24 = traba;           || exportado S/N
|FPRC;

*************************************************************************
    'field' DE LAS FICHAS PRESUPUESTARIAS
*************************************************************************

|PROCESO seppre;
    traba = canal % 16602;
    #18#19 = traba;
    traba = canal % 112;
    #18#0 = traba;
    traba = canal % 1301;
    #18#1 = traba;
|LEE 100#18=;
|SI FSalida = 0;
    |HAZ seppre1;
    |GRABA 020#18a;
|SINO;
    |DDEFECTO #18;
    |HAZ seppre1;
    |GRABA 020#18n;
|FINSI;
|LIBERA #18;
    saber = " Actualizada Ficha: " + #18#19 + "-" + #18#0 + "-" + #18#1;
|PINTA 2040,saber;
|FPRC;

|PROCESO seppre1;
    traba = canal % 16602;
    #18#19 = traba;           || agrupacion
    traba = canal % 112;
    #18#0 = traba;            || cuenta
    traba = canal % 1301;
    #18#1 = traba;            || digito
    traba = canal % 1401;
    #18#2 = traba;            || signo
    traba = canal % 1501;
    #18#3 = traba;            || anual/mensual
    traba = canal % 1610;
    #18#4 = traba;            || mes 1
    traba = canal % 2610;
    #18#5 = traba;            || mes 2
    traba = canal % 3610;
    #18#6 = traba;            || mes 3
    traba = canal % 4610;
    #18#7 = traba;            || mes 4
    traba = canal % 5610;
    #18#8 = traba;            || mes 5
    traba = canal % 6610;
    #18#9 = traba;            || mes 6
    traba = canal % 7610;
    #18#10 = traba;           || mes 7
    traba = canal % 8610;
    #18#11 = traba;           || mes 8
    traba = canal % 9610;
    #18#12 = traba;           || mes 9
    traba = canal % 10610;
    #18#13 = traba;           || mes 10
    traba = canal % 11610;
    #18#14 = traba;           || mes 11
    traba = canal % 12610;
    #18#15 = traba;           || mes 12
    traba = canal % 13610;
    #18#16 = traba;           || presup.a¤o
    traba = canal % 14610;
    #18#17 = traba;           || desde mes
    traba = canal % 15610;
    #18#18 = traba;           || hasta mes
|FPRC;

*************************************************************************
    'field' DE LOS ELEMENTOS DE AMORTIZACION
*************************************************************************

|PROCESO sepamo;
    traba = canal % 108;
    #19#0 = traba;
    traba = canal % 902;
    #19#1 = traba;
|LEE 100#19=;
|SI FSalida = 0;
    |HAZ sepamo1;
    |GRABA 020#19a;
|SINO;
    |DDEFECTO #19;
    |HAZ sepamo1;
    |GRABA 020#19n;
|FINSI;
|LIBERA #19;
    saber = " Actualizada Ficha: " + #19#0 + "-" + #19#1;
|PINTA 2040,saber;

    #20#0 = #19#0;
    #20#1 = #19#1;
    #20#2 = 1;
|LEE 100#20=;
|SI FSalida = 0;
    |HAZ sepamo2;
    |GRABA 020#20a;
|SINO;
    |HAZ sepamo2;
    |GRABA 020#20n;
|FINSI;
|LIBERA #20;
|FPRC;

|PROCESO sepamo1;
    traba = canal % 108;
    #19#0 = traba;            || elemento
    traba = canal % 902;
    #19#1 = traba;            || nro. elemento
    traba = canal % 1140;
    #19#2 = traba;            || descripcion
    traba = canal % 5112;
    #19#3 = traba;            || cuenta
    traba = canal % 6301;
    #19#4 = traba;            || digito
    traba = canal % 6440;
    #19#5 = traba;            || proveedor
    traba = canal % 10410;
    #19#6 = traba;            || fecha compra
    traba = canal % 11410;
    #19#7 = traba;            || importe compra
    traba = canal % 12401;
    #19#8 = traba;            || nueva/usada
    traba = canal % 12540;
    #19#9 = traba;            || lugar destino
    traba = canal % 16501;
    #19#10 = traba;           || tipo amortizacion fiscal
    traba = canal % 16605;
    #19#11 = traba;           || (%) amort.fiscal
    traba = canal % 17110;
    #19#12 = traba;           || acum. amort.fiscal
    traba = canal % 18110;
    #19#13 = traba;           || valor residual amort.fiscal
    traba = canal % 19102;
    #19#14 = traba;           || a¤os amort.fiscal

    traba = canal1 % 104;
    #19#15 = traba;           || grupo amort.
    traba = canal1 % 501;
    #19#16 = traba;           || tipo amortizacion contable
    traba = canal1 % 605;
    #19#17 = traba;           || (%) amort.contable
    traba = canal1 % 1110;
    #19#18 = traba;           || acum. amort.contable
    traba = canal1 % 2110;
    #19#19 = traba;           || valor residual amort.contable
    traba = canal1 % 3102;
    #19#20 = traba;           || a¤os amort.contable
    traba = canal1 % 3301;
    #19#21 = traba;           || amortizacion a/p
    traba = canal1 % 3401;
    #19#22 = traba;           || imprimir S/N
    traba = canal1 % 3510;
    #19#23 = traba;           || fecha venta
    traba = canal1 % 4512;
    #19#24 = traba;           || ~
    traba = canal1 % 5701;
    #19#25 = traba;           || ~
    traba = canal1 % 5812;
    #19#26 = traba;           || ~
    traba = canal1 % 7001;
    #19#27 = traba;           || ~
|FPRC;

|PROCESO sepamo2;
    fec = ~;
    alfa1 = fec;
    alfa1 = alfa1 % -104;

    #20#3 = alfa1;       || a¤o
    #20#4 = "C";         || tipo (compra)
    #20#5 = #19#7;       || importe fiscal
    #20#6 = "S";         || contabilizado (SI)
    #20#7 = fec;         || fecha
    #20#8 = "";          || descripcion
    #20#9 = #20#5;       || importe contable
|FPRC;
