|FICHEROS;
|FIN;

|VARIABLES;
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     aModelos     = "";

     nEspa        = 0;
     nLong        = 0;
     nCampo       = 0;
     nPos         = 0;

     &eaMonedEmpre = "";
     &eaMoneda     = "";
     &eaFOrigen    = "";
     &eaFDestino   = "";
     &eaInternet   = "";
     &enNume       = 0;
     &eaAlfa       = "";
     &eaVarDni     = "";
     &eaDiaB       = "";
     &eaMesB       = "";
     &eaAnyoB      = "";
     &eaFechaB     = "";
     &enPor100     = 0;
     &eaTipoSec    = "";
     &enAnyo       = 0;
     &eaModelos    = "";
|FIN;

|PROCESO CopiaFicheroIP;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |ENVIA_FICHERO eaFOrigen, eaFDestino;
     |SINO;
         |COPIA_FICHERO eaFOrigen, eaFDestino;
     |FINSI;
|FPRC;

|PROCESO Conver13;
     |SI eaMonedEmpre = "P";
         |SI eaMoneda = "P";
             enNume  = enNume ! 0;
         |SINO;
             enNume = ((enNume / 166.386) ! 2) * 100;
         |FINSI;
     |SINO;
         |SI eaMoneda = "P";
             enNume = (enNume / 166.386) ! 2;
         |SINO;
             |SI enPor100 = 0;  enNume = enNume * 100;  |FINSI;
         |FINSI;
     |FINSI;

     |SI enNume ] 0;
         eaAlfa = ("0000000000000" + enNume) % -113;
     |SINO;
         enNume  = -enNume;
         eaAlfa = ("000000000000" + enNume) % -112;
         eaAlfa = "N" + eaAlfa;
     |FINSI;
|FPRC;

|PROCESO QuitaRaros;
     eaAlfa = eaAlfa > " ";
     nEspa   = 0;
     aCadena = "";
     aLong   = eaAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = ",";  aCaracter = "";   |FINSI;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena + (" " * nEspa);

     eaAlfa = eaAlfa > eaAlfa;
|FPRC;

|PROCESO QuitaRarosTfno;
     aCadena = "";
     aLong   = eaAlfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "0";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "1";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "2";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "3";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "4";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "5";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "6";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "7";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "8";  aCadena = aCadena + aCaracter;  |FINSI;
           |SI aCaracter = "9";  aCadena = aCadena + aCaracter;  |FINSI;
     |SIGUE;
     eaAlfa = aCadena;  |QBT eaAlfa;
     eaAlfa = eaAlfa > eaAlfa;
|FPRC;

|PROCESO FechaBonito;
     aAlfa1 = eaAlfa % 102;
     aAlfa2 = eaAlfa % 402;
     aAlfa3 = eaAlfa % 704;

     |SI aAlfa2 = "01";  aAlfa2 = "ENERO     ";  |FINSI;
     |SI aAlfa2 = "02";  aAlfa2 = "FEBRERO   ";  |FINSI;
     |SI aAlfa2 = "03";  aAlfa2 = "MARZO     ";  |FINSI;
     |SI aAlfa2 = "04";  aAlfa2 = "ABRIL     ";  |FINSI;
     |SI aAlfa2 = "05";  aAlfa2 = "MAYO      ";  |FINSI;
     |SI aAlfa2 = "06";  aAlfa2 = "JUNIO     ";  |FINSI;
     |SI aAlfa2 = "07";  aAlfa2 = "JULIO     ";  |FINSI;
     |SI aAlfa2 = "08";  aAlfa2 = "AGOSTO    ";  |FINSI;
     |SI aAlfa2 = "09";  aAlfa2 = "SEPTIEMBRE";  |FINSI;
     |SI aAlfa2 = "10";  aAlfa2 = "OCTUBRE   ";  |FINSI;
     |SI aAlfa2 = "11";  aAlfa2 = "NOVIEMBRE ";  |FINSI;
     |SI aAlfa2 = "12";  aAlfa2 = "DICIEMBRE ";  |FINSI;

     |QBF aAlfa2;
     eaFechaB = aAlfa1 + " de " + aAlfa2 + " de " + aAlfa3;
     eaDiaB   = aAlfa1;
     eaMesB   = aAlfa2;
     eaAnyoB  = aAlfa3;
|FPRC;

|PROCESO Copiampf;
     |DBASE aModelos;  |QBT aModelos;
     aModelos   = aModelos + "hacienda/";

     aAlfa = enAnyo;
     aAlfa = aAlfa % -102;

     eaFOrigen  = aModelos + "zls" + aAlfa + "mpf.exe";
     eaFDestino = "/MODELOS/" + eaModelos + "/zls" + aAlfa + "mpf.exe";

     |HAZ CopiaFicheroIP;
|FPRC;
