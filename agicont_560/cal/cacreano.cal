|FICHEROS;
  cacreano #0;
  cacuenta #1;
  camaasil #3;
  cacuebal #5;
  cacongru #6;
|FIN;

|VARIABLES;
  alfa1 = "";
  fich = "";
  temporal1 = "";
  temporal2 = "";
  juan = 0;
  mensa = "";
  lon = 0;
  prim = 0;
    mascara = "";
    nivel = 0;
    men2   = "     NO existe el Grupo de Conceptos";
    mensa2   = "     No esta definida esta cuenta en Cuentas de Balance";
    dos = "";
    uno = "";
    a = 0;
    b = 0;
    c = 0;
    mesac = 0;
    mesfec = 0;
    mes = "";
    fecalf = "";
    ini = 0;
    errant = "aaaaaaaaaaaa";
    cuant = "";
    iniemp = 0;
    traba = "";
    aar = "";
    aa = 0;
  sw_con = 0;
  x = 0;
  y = 0;
|FIN;

|INCLUYE  acceso_i;

|PROCESO recoge; |TIPO 7;
  #0#2 = fec1;
  #0#3 = fec2;
  |PINTA #0#2;
  |PINTA #0#3;
|FPRC;

|PROCESO mayus; |TIPO 0;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;
|FPRC;

|PROCESO fechas;
  |SI #0Campo > fec2;|O #0Campo < fec1;
      |MENAV "    Fecha fuera de Periodo ...";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO no_dep; |TIPO 7;
  alfa1 = #30#24;
  |CAMPO_MODIFICA #0#8, 1, alfa1;
  |CAMPO_MODIFICA #0#9, 1, alfa1;
|FPRC;

|PROCESO selecci2; |TIPO 0;
|SI #0#10 = "N";
    |CAMPO_MODIFICA #0#06, 1, "S";
    |CAMPO_MODIFICA #0#07, 1, "S";

    |CAMPO_MODIFICA #0#11, 1, "N";
    |CAMPO_MODIFICA #0#12, 1, "N";
    |CAMPO_MODIFICA #0#13, 1, "N";
    |CAMPO_MODIFICA #0#14, 1, "N";
        #0#11 = 0;      |PINTA #0#11;
        #0#12 = 0;      |PINTA #0#12;
        #0#13 = 0;      |PINTA #0#13;
        #0#14 = 0;      |PINTA #0#14;
|SINO;
    |CAMPO_MODIFICA #0#06, 1, "N";
    |CAMPO_MODIFICA #0#07, 1, "N";
     #0#06 = 1;      |PINTA #0#06;
     #0#07 = 999;    |PINTA #0#07;

    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S";
    |CAMPO_MODIFICA #0#14, 1, "S";
|FINSI;
|FPRC;

|PROCESO leegrupo; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;
 |SI #0Campo = 0; |ACABA; |FINSI;
 #6#0 = #0Campo;
 |LEE 001#6=;
 |SI FSalida ! 0;
     |MENAV men2;
     |ERROR;
 |FINSI;
|FPRC;

|PROCESO alentrar;  |TIPO 8;
  |HAZ inicio;
|FPRC;

|PROCESO acumulados;
  |PDEFECTO #1,9,54;
  |GRABA 020#1a;
  |LIBERA #1;
|FPRC;

|DEFBUCLE cacreano0;     || acera las cuentas
 #1#1;
 ;
 "            ", 0;
 "999999999999", 9;
 be;
 NULL, acumulados;
|FIN;

|PROCESO conceptos;
  |SI #0#10 = "N"; |ACABA; |FINSI;
  sw_con = 0;
  |PARA y = 11; |SI y [ 14; |HACIENDO y = y + 1;
        |SI #0y ! 0;
            #6#0 = #0y;
            |LEE 001#6=;
            |SI FSalida = 0;
                |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
                      |SI #6x  = #3#6;
                          sw_con = 1;
                          |SAL;
                      |FINSI;
                |SIGUE;
            |FINSI;
        |FINSI;
        |SI sw_con = 1; |SAL; |FINSI;
  |SIGUE;
|FPRC;

|PROCESO actuali;
  sw_con = 1;
  |HAZ conceptos;
  |SI sw_con = 0; |ACABA; |FINSI;
  aa = 100 + lon;
  aar = aa;
  traba = #3#4 % aar;            || coge cuenta
  iniemp = 0;
  |PARA; |SI iniemp = 0; |HACIENDO;
         iniemp = 1;
         |SI prim = 0;
             cuant = traba;
             prim = 1;
             #1#0 = cuant;
             #1#1 = juan;
             |SI #1#0 = errant;
                 prim = 0;
                 |ACABA;
             |FINSI;
             |LIBERA #1;
             |LEE 101#1=;
             |SI FSalida ! 0;
                 |LIBERA #1;
                 |DDEFECTO #1;
                 #1#0 = cuant;
                 #1#1 = juan;
                 |HAZ defect1;
                 |PUSHV 0501 1980;
                 |PINPA #0#1;
                 |PINDA #0#1;
                 |ENDATOS #1#1;
                 |SI FSalida ! 0;
                     |POPV;
                     mensa = "Recuperando nivel: " + juan + "               ";
                     |PINTA 2410,mensa;
                     errant = #1#0;
                     prim = 0;
                     |ACABA;
                 |FINSI;
                 |GRABA 020#1b;
                 |POPV;
                 mensa = "Recuperando nivel: " + juan + "               ";
                 |PINTA 2410,mensa;
             |FINSI;
         |FINSI;
         |SI cuant ! traba;
             |GRABA 020#1a;
             prim = 0;
             iniemp = 0;
         |FINSI;
  |SIGUE;
  |HAZ suma;
|FPRC;

|DEFBUCLE cacreano1;
 #3#3;
 0,6,21;
 "            ", juan, #0#2, #0#4, #0#0, #0#6, #0#8;
 "999999999999",    9, #0#3, #0#5, #0#1, #0#7, #0#9;
 be;
 NULL, actuali;
|FIN;

|PROCESO alsalir;  |TIPO 3;
  |HAZ copiando;
  |NOME_DAT #1 "cabalano";
  |PINTA 2410,"Poniendo a cero el Plan Contable";
  |BUCLE cacreano0;
  |ABRE #1;
  |ABRE #6;
  |PARA juan = 1; |SI juan [ #30#13; |HACIENDO juan = juan + 1;
        prim = 0;
        |SI juan = 1; lon = #30#14; |FINSI;
        |SI juan = 2; lon = #30#15; |FINSI;
        |SI juan = 3; lon = #30#16; |FINSI;
        |SI juan = 4; lon = #30#17; |FINSI;
        |SI juan = 5; lon = #30#18; |FINSI;
        |SI juan = 6; lon = #30#19; |FINSI;
        mensa = "Recuperando nivel: " + juan + "              ";
        |PINTA 2410,mensa;
        prim = 0;
        |BUCLE cacreano1;
        |SI prim = 1;
            |GRABA 020#1a;
        |FINSI;
  |SIGUE;
  |CIERRA #1;
  |CIERRA #6;
|FPRC;

|PROCESO copiando;
  |DFICE fich;
  temporal1 = fich + "cacuenta.ixx";
  temporal2 = fich + "cabalano.ixx";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  temporal1 = fich + "cacuenta.dat";
  temporal2 = fich + "cabalano.dat";
  |COPIA_FICHERO temporal1,temporal2;
  |SI FSalida ! 0;
      temporal2 = fich + "cabalano.ixx";
      |FBORRA temporal2;
      |ACABA;
  |FINSI;
  temporal1 = fich + "cacuenta.ddx";
  temporal2 = fich + "cabalano.ddx";
  |COPIA_FICHERO temporal1,temporal2;
|FPRC;

|PROCESO suma;
  |SI #3#1 > #1#58;
      #1#58 = #3#1;
  |FINSI;
  |SI #3#0 ! 0;|Y #3#0 ! 99;
      ini = #30#11;
      fecalf = #3#1;
      mes = fecalf % 402;
      mesfec = mes;
      mesac = (mesfec - ini) + 1;
      |SI mesac [ 0;
          mesac = (13 - ini) + mesfec;
      |FINSI;
      a = (mesac * 3) + 9;
      b = a + 1;
      c = a + 2;
      |SI #3#8 = "D";
          #1a = #1a + #3#9;
          #1#51 = #1#51 + #3#9;
          #1c = #1a - #1b;
          #1#53 = #1#51 - #1#52;
          |ACABA;
      |FINSI;
      #1b = #1b + #3#9;
      #1#52 = #1#52 + #3#9;
      #1c = #1a - #1b;
      #1#53 = #1#51 - #1#52;
      |ACABA;
  |FINSI;
  |SI #3#0 = 0;
      |SI #3#8 = "D";
          #1#9 = #1#9 + #3#9;
          #1#51 = #1#51 + #3#9;
          #1#11 = #1#9 - #1#10;
          #1#53 = #1#51 - #1#52;
          |ACABA;
      |FINSI;
      #1#10 = #1#10 + #3#9;
      #1#52 = #1#52 + #3#9;
      #1#11 = #1#9 - #1#10;
      #1#53 = #1#51 - #1#52;
      |ACABA;
  |FINSI;
  |SI #3#8 = "D";
      #1#48 = #1#48 + #3#9;
      #1#51 = #1#51 + #3#9;
      #1#50 = #1#48 - #1#49;
      #1#53 = #1#51 - #1#52;
      |ACABA;
  |FINSI;
  #1#49 = #1#49 + #3#9;
  #1#52 = #1#52 + #3#9;
  #1#50 = #1#48 - #1#49;
  #1#53 = #1#51 - #1#52;
|FPRC;

|PROCESO defect1;
  |ABRE #5;
  uno = #1#0;
  |QBF uno;
  dos = uno + "000000000000";
  uno = dos % A101;
  #5#0 = uno;
  |LEE 000#5=;
  |SI FSalida = 0;
      |HAZ saca1;
  |SINO;
      uno = dos % A102;
      #5#0 = uno;
      |LEE 000#5=;
      |SI FSalida = 0;
          |HAZ saca1;
      |SINO;
          uno = dos % A103;
          #5#0 = uno;
          |LEE 000#5=;
          |SI FSalida = 0;
              |HAZ saca1;
          |SINO;
              uno = dos % A104;
              #5#0 = uno;
              |LEE 000#5=;
              |SI FSalida = 0;
                  |HAZ saca1;
              |SINO;
                  |MENAV mensa2;
              |FINSI;
          |FINSI;
      |FINSI;
  |FINSI;
  nivel = #1#1;
|| la 3a clave esta formada por la cta + zzzz y el campo fantasma del nivel;
  mascara = #1#0;
  |QBF mascara;
  mascara = mascara +"zzzzzzzzzzzz";
  mascara = mascara % 112;
  #1#54    = mascara;
  #1#55    = nivel;
  |CIERRA #5;
|FPRC;

|PROCESO saca1;
  #1#4 = #5#1;
  #1#5 = #5#2;
  #1#6 = #5#3;
  #1#7 = #5#4;
  #1#8 = #5#5;
|FPRC;
