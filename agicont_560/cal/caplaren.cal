|FICHEROS;
    caplaren #0;
    || eosconce #1;
    || agicontr #20;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    agieos_p = "";
    agieos_f = "";
    sw_no = 0;
|FIN;

/*
|PROCESO path;
|DBASS alfa1;  |QBF alfa1;
|PATH_DAT #20 alfa1;
|ABRE #20;
|LEE 040#20p;
|SI FSalida ! 0; |DDEFECTO #20; |FINSI;
|CIERRA #20;

agieos_f = #20#3; |QBF agieos_f;
agieos_p = (agieos_f - "fich/") + "pan/";
|PATH_DAT #1 agieos_f;
|PATH_PAN #1 agieos_p;
|FPRC;
*/

|PROGRAMA;
 || |HAZ path; ... No hace falta
|CLS;
|CABEZA "Planilla a Renta";
|PINPA #0#0;
|ENTLINEAL #1#0, 1, 1, 21, 0, min, max;
|FPRO;

|RUTINA min;
    #0#0 = 1;
|FRUT;

|RUTINA max;
    #0#0 = 999;
|FRUT;

|| **************************** Calculos de Pantalla *****************
|| *******************************************************************

|PROCESO ant_pb; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Compras        ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Energia,Agua,  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Gtos.Financ.   ";
    |PINTA 1166, "Tributos       ";
    |PINTA 1266, "Repa. y Cons.  ";
    |PINTA 1366, "Trab.otr.Empr. ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FPRC;

|PROCESO top_pb; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#3 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#3 > 8;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO ant_eb; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Compras        ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Energia,Agua,  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Gtos.Financ.   ";
    |PINTA 1166, "Tributos       ";
    |PINTA 1266, "Repa. y Cons.  ";
    |PINTA 1366, "Trab.otr.Empr. ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FPRC;

|PROCESO top_eb; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#4 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#4 > 8;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO ant_pc; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Mat.Consumidos ";
    |PINTA 0766, "Coste Personal ";
    |PINTA 0866, "Int.Prestamos  ";
    |PINTA 0966, "Alqui.Locales  ";
    |PINTA 1066, "Amortizacion   ";
    |PINTA 1166, "Energia, Agua, ";
    |PINTA 1266, "Otros Gastos   ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Integros";
    |PINTA 0766, "               ";
    |PINTA 0866, "               ";
    |PINTA 0966, "               ";
    |PINTA 1066, "               ";
    |PINTA 1166, "               ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FPRC;

|PROCESO top_pc; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#5 > 1;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#5 > 7;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO ant_ec; |TIPO 7;
|ATRI R;
|SI #0#2 = "G";
    ||            123456789012345
    |PINTA 0666, "Tributos       ";
    |PINTA 0766, "Mat.Primas     ";
    |PINTA 0866, "Coste Personal ";
    |PINTA 0966, "Seg. Social    ";
    |PINTA 1066, "Planes Pensio. ";
    |PINTA 1166, "Honor.Profes.  ";
    |PINTA 1266, "Alquileres     ";
    |PINTA 1366, "Int.Prestamos  ";
    |PINTA 1466, "Amortizacion   ";
    |PINTA 1566, "Rep. y Cons.   ";
    |PINTA 1666, "Energia, Agua, ";
    |PINTA 1766, "Primas Segur.  ";
    |PINTA 1866, "Dudoso Cobro   ";
    |PINTA 1966, "Reduc.Fond.Ed. ";
    |PINTA 2066, "Fondos Rever.  ";
    |PINTA 2166, "Gtos.Admon.    ";
    |PINTA 2266, "Cuotas Corp.   ";
    |PINTA 2366, "Otros Gastos   ";
|FINSI;
|SI #0#2 = "I";
    ||            123456789012345
    |PINTA 0666, "Ingres.Ordinar.";
    |PINTA 0766, "Autoconsumo    ";
    |PINTA 0866, "Subvenciones   ";
    |PINTA 0966, "Otras Transfer.";
    |PINTA 1066, "Ingres.Financ. ";
    |PINTA 1166, "Otros Ingres.  ";
    |PINTA 1266, "               ";
    |PINTA 1366, "               ";
    |PINTA 1466, "               ";
    |PINTA 1566, "               ";
    |PINTA 1666, "               ";
    |PINTA 1766, "               ";
    |PINTA 1866, "               ";
    |PINTA 1966, "               ";
    |PINTA 2066, "               ";
    |PINTA 2166, "               ";
    |PINTA 2266, "               ";
    |PINTA 2366, "               ";
|FINSI;
|ATRI 0;
|FPRC;

|PROCESO top_ec; |TIPO 0;
    sw_no = 0;
|SI #0#2 = "I";|Y #0#6 >  6;  sw_no = 1;  |FINSI;
|SI #0#2 = "G";|Y #0#6 > 18;  sw_no = 1;  |FINSI;
|SI sw_no = 1;
    |HAZ no_dejar;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO no_dejar;
|MENAV "    ATENCION!!! Error de Entrada ...";
|FPRC;

|PROCESO limpia; |TIPO 7;
|ATRI R;
|PINTA 0666, "               ";
|PINTA 0766, "               ";
|PINTA 0866, "               ";
|PINTA 0966, "               ";
|PINTA 1066, "               ";
|PINTA 1166, "               ";
|PINTA 1266, "               ";
|PINTA 1366, "               ";
|PINTA 1466, "               ";
|PINTA 1566, "               ";
|PINTA 1666, "               ";
|PINTA 1766, "               ";
|PINTA 1866, "               ";
|PINTA 1966, "               ";
|PINTA 2066, "               ";
|PINTA 2166, "               ";
|PINTA 2266, "               ";
|PINTA 2366, "               ";
|ATRI 0;
|FPRC;

|PROCESO defec1; |TIPO 0;
  alfa2 = #0#1 % 101;
  #0#2 = "R";
  #0#7 = "D";
  |SI alfa2 = "6"; #0#2 = "G"; #0#7 = "S"; |FINSI;
  |SI alfa2 = "7"; #0#2 = "I"; #0#7 = "S"; |FINSI;
  || ............. |SI alfa2 = "2"; #0#2 = "V"; #0#7 = as; |FINSI;
  |SI alfa2 = "4"; #0#2 = "R"; #0#7 =  "D"; |FINSI;
  |PINTA #0#2;
  |PINTA #0#7;
|FPRC;

|PROCESO mayus;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;

|SI Campo = 2;
    alfa1 = "S";
    |SI #0#2 = "R";
        alfa1 = "N";
        #0#3 = 0; #0#4 = 0;
        #0#5 = 0; #0#6 = 0;
        |PINTA #0#3;
        |PINTA #0#4;
        |PINTA #0#5;
        |PINTA #0#6;
    |FINSI;
    |CAMPO_MODIFICA #0#3, 1, alfa1;
    |CAMPO_MODIFICA #0#4, 1, alfa1;
    |CAMPO_MODIFICA #0#5, 1, alfa1;
    |CAMPO_MODIFICA #0#6, 1, alfa1;
|FINSI;
|FPRC;
