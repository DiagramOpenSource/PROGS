|FICHEROS;
    caextgru #0;
    camaasil #1;
    camaasic #2;
    cacuenta #3;
    cacongru #6;
|FIN;

|VARIABLES;
    nCampo   = 0;

    &entrada = 1;

    men1   = "    NO existe Grupo de Conceptos!";
    men2  = "     Longitud de Cuenta Fuera de Nivel !";
    mensa1 = "    ERROR ESTA FECHA NO CORRESPONDE AL EJERCICIO";
    x = 0;
    xy = 0;
    informe = "caextgru";
    long = "  ";
    cta  = 0;
    num   = 0;
    swdig = 0;
    alfa1 = "";

  &cuenta = "";
  &asiento = 0;  || datos del informe por linea
  &debe = 0;
  &haber = 0;
  &saldo = 0;
  &t_debe  = 0; || totales por cuenta
  &t_haber = 0;
  &t_saldo = 0;
  &t_degru = 0;
  &t_hagru = 0;
  &grup1 = 0;
  &grup2 = "";

  t_debe1 = 0;
  t_habe1 = 0;
  t_debe2 = 0;
  t_habe2 = 0;
  t_debe3 = 0;
  t_habe3 = 0;
  t_debe4 = 0;
  t_habe4 = 0;
  t_debe5 = 0;
  t_habe5 = 0;

  &s_debe = 0;   || total general
  &s_haber = 0;
  &s_saldo = 0;
  &s_degru = 0;
  &s_hagru = 0;

  &s_debe1 = 0;
  &s_habe1 = 0;
  &s_debe2 = 0;
  &s_habe2 = 0;
  &s_debe3 = 0;
  &s_habe3 = 0;
  &s_debe4 = 0;
  &s_habe4 = 0;
  &s_debe5 = 0;
  &s_habe5 = 0;

  sw_con = 0;          || 1 = EL CONCEPTO ES BUENO
  sw_print = 0;        || 1 = NO DEBO ESCRIBIR
  sw_prim = 0;         || 0 = PRIMERA VEZ
  sw_cuen = 0;          ||1 = Hemos Leido la cuenta
  sw_pagina = 0;

  &swant = 0;
  &sw_inf = 0;
  &sw_cab = 0;
  &pagina = 0;

  cant1 = 0;
  cant2 = 0;
  cant3 = 0;
  cant4 = 0;
  cant5 = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|| *********************************************************************
||                             COMIENZO
|| *********************************************************************
|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

|PROCESO seleccio2; |TIPO 0;
|HAZ mayus;
|SI #0#22 = "N";
    |CAMPO_MODIFICA #0#23, 1, "S"; |CAMPO_MODIFICA #0#24, 1, "S";
    |CAMPO_MODIFICA #0#25, 1, "S"; |CAMPO_MODIFICA #0#26, 1, "S";
    |CAMPO_MODIFICA #0#27, 1, "S"; |CAMPO_MODIFICA #0#28, 1, "S";
    |CAMPO_MODIFICA #0#29, 1, "S"; |CAMPO_MODIFICA #0#30, 1, "S";
    |CAMPO_MODIFICA #0#31, 1, "S"; |CAMPO_MODIFICA #0#32, 1, "S";
    |CAMPO_MODIFICA #0#33, 1, "S"; |CAMPO_MODIFICA #0#34, 1, "S";
    |CAMPO_MODIFICA #0#35, 1, "S"; |CAMPO_MODIFICA #0#36, 1, "S";
    |CAMPO_MODIFICA #0#37, 1, "S";
    |CAMPO_MODIFICA #0#0, 1, "N"; |CAMPO_MODIFICA #0#1, 1, "N";
    #0#0 = "            "; #0#4 = 0; |PINTA #0#0;
    #0#1 = "            "; #0#5 = 9; |PINTA #0#1;
|SINO;
    |CAMPO_MODIFICA #0#0, 1, "S"; |CAMPO_MODIFICA #0#1, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "N"; |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N"; |CAMPO_MODIFICA #0#26, 1, "N";
    |CAMPO_MODIFICA #0#27, 1, "N"; |CAMPO_MODIFICA #0#28, 1, "N";
    |CAMPO_MODIFICA #0#29, 1, "N"; |CAMPO_MODIFICA #0#30, 1, "N";
    |CAMPO_MODIFICA #0#31, 1, "N"; |CAMPO_MODIFICA #0#32, 1, "N";
    |CAMPO_MODIFICA #0#33, 1, "N"; |CAMPO_MODIFICA #0#34, 1, "N";
    |CAMPO_MODIFICA #0#35, 1, "N"; |CAMPO_MODIFICA #0#36, 1, "N";
    |CAMPO_MODIFICA #0#37, 1, "N";
|FINSI;
|FPRC;

|PROCESO empieza; |TIPO 7;
    #0#2 = fec1;
    #0#3 = fec2;
    |PINTA #0#2;
    |PINTA #0#3;
|FPRC;

|PROCESO leegrupo; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;
 |SI #0Campo = 0; |ACABA; |FINSI;
 x = Campo + 5;
 |ABRE #6;
 #6#0 = #0Campo;
 |LEE 001#6=;
 salidas = FSalida;
 |CIERRA #6;
 |SI salidas ! 0;
     |MENAV men1;
     |ERROR;
 |SINO;
     #0x = #6#1;
     |PINTA #0x;
 |FINSI;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;  |ERROR;  |ACABA;  |FINSI;
  |SI #0Campo = "            ";  |ACABA;  |FINSI;
  |SI Campo [ 1;
      x = Campo + 4;
  |SINO;
      x = Campo + 15;
  |FINSI;
  cta  = #0Campo;
  long = cta % 0;
  swdig = 0;
  |SI long = #30#14; swdig = 1; #0x = 1; |FINSI;
  |SI long = #30#15; swdig = 1; #0x = 2; |FINSI;
  |SI long = #30#16; swdig = 1; #0x = 3; |FINSI;
  |SI long = #30#17; swdig = 1; #0x = 4; |FINSI;
  |SI long = #30#18; swdig = 1; #0x = 5; |FINSI;
  |SI long = #30#19; swdig = 1; #0x = 6; |FINSI;
  |SI swdig = 0;  |MENAV men2;  |ERROR;  |FINSI;
|FPRC;

|PROCESO fechad;
  |SI #0#2 < fec1; |O #0#2 > fec2;
      |MENAV mensa1;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO fechah;
  |SI #0#3 < fec1; |O #0#3 > fec2; |O #0#3 < #0#2;
      |MENAV mensa1;
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;
|FPRC;

|PROCESO no_dep; |TIPO 7;
    alfa1 = #30#24;
|CAMPO_MODIFICA #0#6, 1, alfa1;
|CAMPO_MODIFICA #0#7, 1, alfa1;
|FPRC;

|PROGRAMA;
  |CLS;
  |CABEZA "Extractos por Grupos ";
  |HAZ inicio;

  FSalida = 1;
  |PARA;|SI FSalida = 1; |HACIENDO;
        sw_pagina = 0;
        sw_prim   = 0;
        sw_print  = 0;
        sw_inf    = 0;
        sw_cuen   = 0;
        |DDEFECTO #0;
        |PINPA #0#0;
        |PINDA #0#0;                    || Pinta los datos por defecto
        |ENDATOS #1#0;                  || Seleccion informe
        |SI FSalida = 0;                || Si el conforme es igua a S
            |HAZ borrar;
            |HAZ impre;                 || Calculo impresion
            FSalida = 1;                || Vuelve al bucle
        |SINO;
            FSalida = 0;
        |FINSI;
  |SIGUE;
|FPRO;

|| *************************************************************************
||                               MEOLLO
|| *************************************************************************
|PROCESO cabecera;
  #2#0 = #1#0;
  #2#1 = #1#1;
  #2#2 = #1#2;
  |LEE 040#2=;
  |SI FSalida ! 0;
      |DDEFECTO #2;
  |FINSI;
  asiento = #2#3;
|FPRC;

|PROCESO congru;
  sw_con = 0;
  cant1 = 0; cant2 = 0; cant3 = 0; cant4 = 0; cant5 = 0;
  |ABRE #6;

 |ET grupo1;
  |SI #0#12 = 0; |VETE grupo2; |FINSI;
  #6#0 = #0#12;
  |LEE 001#6=;
  |SI FSalida = 0;
      |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
            |SI #6x  = #1#6;
                sw_con = 1;
                cant1 = #1#9;
                |SAL;
            |FINSI;
      |SIGUE;
  |FINSI;
 |ET grupo2;
  |SI #0#13 = 0; |VETE grupo3; |FINSI;
  #6#0 = #0#13;
  |LEE 001#6=;
  |SI FSalida = 0;
      |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
            |SI #6x  = #1#6;
                sw_con = 1;
                cant2 = #1#9;
                |SAL;
            |FINSI;
      |SIGUE;
  |FINSI;
 |ET grupo3;
  |SI #0#14 = 0; |VETE grupo4; |FINSI;
  #6#0 = #0#14;
  |LEE 001#6=;
  |SI FSalida = 0;
      |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
            |SI #6x  = #1#9;
                sw_con = 1;
                cant3 = #1#9;
                |SAL;
            |FINSI;
      |SIGUE;
  |FINSI;
  |ET grupo4;
   |SI #0#15 = 0; |VETE grupo5; |FINSI;
   #6#0 = #0#15;
   |LEE 001#6=;
   |SI FSalida = 0;
       |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
             |SI #6x  = #1#9;
                 sw_con = 1;
                 cant4 = #1#9;
                 |SAL;
             |FINSI;
       |SIGUE;
   |FINSI;
 |ET grupo5;
  |SI #0#16 = 0; |CIERRA #6; |ACABA; |FINSI;
  #6#0 = #0#16;
  |LEE 001#6=;
  |SI FSalida = 0;
      |PARA x = 2; |SI x [ 21; |HACIENDO x = x + 1;
            |SI #6x  = #1#6;
                sw_con = 1;
                cant5 = #1#9;
                |SAL;
            |FINSI;
      |SIGUE;
  |FINSI;

  |CIERRA #6;
|FPRC;

|PROCESO leecuen;
  sw_cuen = 1;
  #3#0 = #1#4;
  #3#1 = #1#5;
  |LEE 040#3=;
  |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
  swant = 0;
  t_debe = 0;
  t_haber = 0;
  t_saldo = 0;
  t_debe1 = 0;
  t_habe1 = 0;
  t_debe2 = 0;
  t_habe2 = 0;
  t_debe3 = 0;
  t_habe3 = 0;
  t_debe4 = 0;
  t_habe4 = 0;
  t_debe5 = 0;
  t_habe5 = 0;
|FPRC;

|PROCESO buclepan;
  |HAZ congru;
  |SI sw_con = 0; |ACABA;  |FINSI; || no es concepto seleccionado

  |SI sw_prim = 0;
      cuenta = #1#4;
      sw_prim  = 1;
      |HAZ leecuen;
  |FINSI;
  |SI cuenta ! #1#4;
      |SI sw_print = 0;
          |HAZ impr_totales;
      |FINSI;
      || ........... |HAZ borrar;
      cuenta = #1#4;
      |HAZ leecuen;
  |FINSI;

  |SI #1#8 = "D";
      debe = #1#9;
      haber = 0;
  |SINO;
      debe = 0;
      haber = #1#9;
  |FINSI;
  saldo = t_saldo + (debe - haber);

  |SI #1#1 < #0#2;
      |HAZ suma_totales;
      sw_print = 1;
      swant = 1;
      |ACABA;
  |FINSI;

  |SI #1#1 ] #0#2; |Y #1#1 [ #0#3;
      |HAZ cabecera;
      |SI sw_cuen = 1;
          sw_cab = 1;
          sw_inf = 0;
          |PRINT;
          sw_cab = 0;
          sw_cuen = 0;
      |FINSI;
      sw_inf = 1;
      sw_cab = 0;
      |PRINT;
      sw_cab = 0;
      sw_print = 0;
      swant = 1;
  |FINSI;
  |HAZ suma_totales;

|FPRC;

|DEFBUCLE caextrim0;
 #1#3;
 0, 21;
 #0#0, 0, fec1, 000000, #0#8, #0#6;
 #0#1, 9, #0#3, 999999, #0#9, #0#7;
 e;
 NULL, buclepan;
|FIN;

|PROCESO impre;
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |INFOR "caextgru";

  |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
  |ABRE #2;
  |ABRE #3;
  |SI #0#22 = "N";
      |PARA nCampo = 23; |SI nCampo [ 37; |HACIENDO nCampo = nCampo + 1;
            |SI #0x ! "            ";
                #0#0 = #0nCampo;
                #0#1 = #0nCampo;
                |BUCLE caextrim0;
            |FINSI;
      |SIGUE;
  |SINO;
      |BUCLE caextrim0;
  |FINSI;
  |CIERRA #2;
  |CIERRA #3;
  |SI sw_prim = 1;
      |SI sw_print = 0;
          |HAZ impr_totales;
      |FINSI;
      |PIEINF;
  |FINSI;
  |FININF;
  |FINIMP;
|FPRC;

|PROCESO borrar;
  s_debe = 0;
  s_haber = 0;
  s_saldo = 0;
  swant = 0;
  s_degru = 0;
  s_hagru = 0;
  s_debe1 = 0;
  s_habe1 = 0;
  s_debe2 = 0;
  s_habe2 = 0;
  s_debe3 = 0;
  s_habe3 = 0;
  s_debe4 = 0;
  s_habe4 = 0;
  s_debe5 = 0;
  s_habe5 = 0;
|FPRC;

|PROCESO &c_pagina;
  |SI sw_pagina = 0;
      pagina = 1;
      sw_pagina = 1;
  |SINO;
      pagina = pagina + 1;
  |FINSI;
  sw_cab = 1;
|FPRC;

|PROCESO suma_totales;
 t_debe  = t_debe  + debe;
 t_haber = t_haber + haber;
 t_saldo = t_debe - t_haber;
 s_debe  = s_debe  + debe;
 s_haber = s_haber + haber;
 s_saldo = s_debe - s_haber;
 |SI #1#8 = "D";
     t_debe1 = t_debe1 + cant1;
     t_debe2 = t_debe2 + cant2;
     t_debe3 = t_debe3 + cant3;
     t_debe4 = t_debe4 + cant4;
     t_debe5 = t_debe5 + cant5;
     s_debe1 = s_debe1 + cant1;
     s_debe2 = s_debe2 + cant2;
     s_debe3 = s_debe3 + cant3;
     s_debe4 = s_debe4 + cant4;
     s_debe5 = s_debe5 + cant5;
 |SINO;
     t_habe1 = t_habe1 + cant1;
     t_habe2 = t_habe2 + cant2;
     t_habe3 = t_habe3 + cant3;
     t_habe4 = t_habe4 + cant4;
     t_habe5 = t_habe5 + cant5;
     s_habe1 = s_habe1 + cant1;
     s_habe2 = s_habe2 + cant2;
     s_habe3 = s_habe3 + cant3;
     s_habe4 = s_habe4 + cant4;
     s_habe5 = s_habe5 + cant5;
 |FINSI;
|FPRC;

|PROCESO impr_totales;
  sw_cab = 0;
  sw_inf = 2; || linea totales
  |PRINT;
  sw_cab = 0;
  |SI #0#12 ! 0;
      grup1 = #0#12; grup2 = #0#17;
      t_degru = t_debe1; t_hagru = t_habe1;
      sw_inf = 3;
      |PRINT;
      sw_cab = 0;
  |FINSI;
  |SI #0#13 ! 0;
      grup1 = #0#13; grup2 = #0#18;
      t_degru = t_debe2; t_hagru = t_habe2;
      sw_inf = 3;
      |PRINT;
      sw_cab = 0;
  |FINSI;
  |SI #0#14 ! 0;
      grup1 = #0#14; grup2 = #0#19;
      t_degru = t_debe3; t_hagru = t_habe3;
      sw_inf = 3;
      |PRINT;
      sw_cab = 0;
  |FINSI;
  |SI #0#15 ! 0;
      grup1 = #0#15; grup2 = #0#20;
      t_degru = t_debe4; t_hagru = t_habe4;
      sw_inf = 3;
      |PRINT;
      sw_cab = 0;
  |FINSI;
  |SI #0#16 ! 0;
      grup1 = #0#16; grup2 = #0#21;
      t_degru = t_debe5; t_hagru = t_habe5;
      sw_inf = 3;
      |PRINT;
      sw_cab = 0;
  |FINSI;
  sw_inf = 4;
  |PRINT;
  sw_cab = 0;
|FPRC;
