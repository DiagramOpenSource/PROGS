|FICHEROS
 caliconb #0;
 cacuenta #1;
|FINSI;

|VARIABLES;
 &cbloque = 0;
 &clinea  = 0;
 &cdefecta = "";
 &cdefedig = 0;
 estado = 0;

    alfa1 = "";
    alfa2 = "";
    cta_t = 0;
    dig_t = 0;
    long  = 0;
    sw    = 0;
|FIN;

|INCLUYE acceso_i;
|INCLUYE puntos_i;

|PROGRAMA;
 |ABRE #0;
 |ATRI R;
 |BLIN 4;
 |ATRI 0;

 |HAZ inicio;

 |PINPA #0#0;
 #0#0 = cbloque;
 #0#1 = clinea;

 |LEE 101#0=;
 estado = FSalida;
 |SI estado ! 0;
     #0#0 = cbloque;
     #0#1 = clinea;
     #0#2 = cdefecta;
     #0#3 = cdefedig;
 |FINSI;

 |PINDA #0#0;

 |ENDATOS #2#0;
 |SI FSalida = 0;
     |SI estado = 0; |GRABA 020#0a; |FINSI;
     |SI estado ! 0; |GRABA 020#0n; |FINSI;
 |FINSI;

 |LIBERA #0;
 |CIERRA #0;
|FPRO;

|PROCESO cuefin;
  |ABRE #1;
  cta_t = Campo;
  dig_t = Campo + 1;
  #1#0 = #0cta_t
  #1#1 = #0dig_t;
  |LEE 001#1=;
  |SI FSalida ! 0;  |ERROR;  |CIERRA #1; |ACABA;  |FINSI;
  |SI #1#3 = "N";
      |MENAV "     La Cuenta NO tiene PASE DIRECTO";
      |ERROR;
  |FINSI;
  |CIERRA #1;
|FPRC;

|PROCESO cuenta; |TIPO 6;
  p_alfa1 = #0Campo;
  salidas = FSalida;
  |HAZ punto;
  |SI p_error ! 0;
      |MENAV "     ERROR EN CUENTA";
      |ERROR;
      |ACABA;
  |FINSI;
  cta_t = Campo;
  dig_t = cta_t + 1;

  alfa1 = #0cta_t;
  |QBF alfa1;
  alfa2 = alfa1 % 0;
  long = alfa2;
  sw = 0;
  |SI long = dig4;  sw = 1;  #0dig_t = 1;  |FINSI;
  |SI long = dig5;  sw = 1;  #0dig_t = 2;  |FINSI;
  |SI long = dig6;  sw = 1;  #0dig_t = 3;  |FINSI;
  |SI long = dig7;  sw = 1;  #0dig_t = 4;  |FINSI;
  |SI long = dig8;  sw = 1;  #0dig_t = 5;  |FINSI;
  |SI long = dig9;  sw = 1;  #0dig_t = 6;  |FINSI;
  |SI long = 0;     sw = 1;  #0dig_t = 0;  |FINSI;
  |SI sw = 0;
      #0dig_t = 0;
      |MENAV "      Longitud de Cuenta Fuera de Nivel ";
      |ERROR;
      |ACABA;
  |FINSI;
|FPRC;
