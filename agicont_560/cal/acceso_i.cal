|| lee la empresa y carga niveles            || numero 0

|FICHEROS;
    canempre #30;
    caconimp #99;   || configuracion impresiones
    camoneda #100;
|FIN;

|VARIABLES;
    &emEmp = 0;
    &fec1 = @;
    &fec2 = @;
    &cod_emp1 = "";
    &cod_emp2 = "";
    &clave1 = "";
    &clave2 = "";
    &cod1 = 0;
    &cod2 = 0;
    &empresa = "";
    &dir_fich = "";
    &dig1 = 0;
    &dig3 = 0;
    &dig4 = 0;
    &dig5 = 0;
    &dig6 = 0;
    &dig7 = 0;
    &dig8 = 0;
    &dig9 = 0;
    &work1 = "";
    &tra1 = 0;
    &mes1 = "";
    &dia1 = "";
    &codcon = 0;
    &swerror = 0;
    &empre = 0;
    &ejerc = 0;
    salidas = 0;

    elige_i = "";
    que_i1 = "";
    que_i2 = "";
    &fich_alta = "";

 &EURO = 1;
 &EURODB = 0;
 &EURODV = 0;
 &EUROTEXTO = "Cambio de Moneda";
 &swOperacion = 0;  || 0 = Lectura / 1 = Alta
 &enEmpresa = 0;
 &enPeriodo = 0;
 &eaMoneda  = "";
|FIN;

|PROCESO inicio; |TIPO 8;
  |HAZ configura;

  swerror = 0;
  |QBF fich_alta;
  |SI fich_alta ! "";
      empresa = fich_alta;
  |SINO;
      |DFICE empresa;
  |FINSI;
  cod_emp1 = empresa  % -107;
  cod_emp2 = cod_emp1 %  106;
  clave1 = cod_emp2 %  105;
  clave2 = cod_emp2 % -101;
  cod1 = clave1;   empre = cod1;
  cod2 = clave2;   ejerc = cod2;
  |ABRE #30;
  #30#2 = cod1;
  #30#3 = cod2;
  |LEE 040#30=;
  |SI FSalida ! 0;|Y #30#2 ! 0;|Y #30#3 ! 0;
      swerror = 1;
      |MENAV "    No existe Empresa !!!";
      |ACABA;
  |FINSI;

  dig1 = #30#11;       || desde mes
  dig3 = #30#13;       || nro. niveles
  dig4 = #30#14;       || 1 nivel
  dig5 = #30#15;       || 2 nivel
  dig6 = #30#16;       || 3 nivel
  dig7 = #30#17;       || 4 nivel
  dig8 = #30#18;       || 5 nivel
  dig9 = #30#19;       || 6 nivel
  |CIERRA #30;
  cod2 = #30#26;
  tra1 = 100 + cod2;
  clave2 = tra1 % -102;
  tra1 = 100 + #30#11;
  mes1 = tra1 % -102;
  |SI cod2 < 80;
        work1 = "01." + mes1 + ".20" + clave2;
|SINO;
        work1 = "01." + mes1 + ".19" + clave2;
|FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
|SI #30#11 > #30#12;
        cod2 = cod2 + 1;
        |SI cod2 > 99; cod2 = cod2 - 100;    |FINSI;
|FINSI;
    dia1 = "31";
|SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
|FINSI;
|SI #30#12 = 2;
        dia1 = "28";
    |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
            dia1 = "29";
    |FINSI;
|FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
|SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
|SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
|FINSI;
    fec2 = work1;

 enEmpresa = #canempre#2;
 enPeriodo = #canempre#3;
 swOperacion = 0;
 |SUB_EJECUTA "camoneda";
|FPRC;

|PROCESO leelo;
swerror = 0;
|ABRE #30;
    #30#2 = cod1;
    #30#3 = cod2;
|LEE 040#30=;
|SI FSalida ! 0;|Y #30#2 ! 0;|Y #30#3 ! 0;
    swerror = 1;
    |CIERRA #30;
    |SI emEmp = 0; |MENAV "    No existe Empresa !!!"; |FINSI;
    |ERROR;
    |ACABA;
|FINSI;

    dig1 = #30#11;
    dig3 = #30#13;
    dig4 = #30#14;
    dig5 = #30#15;
    dig6 = #30#16;
    dig7 = #30#17;
    dig8 = #30#18;
    dig9 = #30#19;
|CIERRA #30;
    cod2 = #30#26;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
    tra1 = 100 + #30#11;
    mes1 = tra1 % -102;
|SI cod2 < 80;
        work1 = "01." + mes1 + ".20" + clave2;
|SINO;
        work1 = "01." + mes1 + ".19" + clave2;
|FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
|SI #30#11 > #30#12;
        cod2 = cod2 + 1;
|FINSI;
    dia1 = "31";
|SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
|FINSI;
|SI #30#12 = 2;
        dia1 = "28";
    |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
            dia1 = "29";
    |FINSI;
|FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
|SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
|SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
|FINSI;
    fec2 = work1;

 enEmpresa = #canempre#2;
 enPeriodo = #canempre#3;
 swOperacion = 0;
 |SUB_EJECUTA "camoneda";
|FPRC;

|PROCESO configura;
|DDEFECTO #99;
|ABRE #99;
|LEE 000#99p;
|CIERRA #99;
|FPRC;

|PROCESO los_informes;
    que_i1 = "";
    que_i2 = "";
|MODULO elige_i;
 |SI elige_i = "c3getodo"; elige_i = "cabatodo"; |FINSI;
 |SI elige_i = "c3geivac"; elige_i = "cay4ivac"; |FINSI;
 |SI elige_i = "c3geivav"; elige_i = "cay4ivav"; |FINSI;
|SI #99#1 = "M";
    |SI elige_i = "cabatodo";    que_i1 = "cabatodo"; que_i2 = "cabatod1"; |FINSI;
    |SI elige_i = "cabaexpl";    que_i1 = "cabaexpl"; que_i2 = "cabaexp1"; |FINSI;
    |SI elige_i = "cabasitu";    que_i1 = "cabasitu"; que_i2 = "cabasit1"; |FINSI;
    |SI elige_i = "cabaorap";    que_i1 = "cabaorap"; que_i2 = "";         |FINSI;
    |SI elige_i = "cadiario";    que_i1 = "cadiario"; que_i2 = "";         |FINSI;
    |SI elige_i = "caextrim";    que_i1 = "caextrim"; que_i2 = "caextris"; |FINSI;
    |SI elige_i = "cavaexpl";    que_i1 = "cavaexpl"; que_i2 = "";         |FINSI;
    |SI elige_i = "caivexpl";    que_i1 = "caivexpl"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3gebsys";    que_i1 = "c3gebsys"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3gediar";    que_i1 = "c3gediar"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3geextr";    que_i1 = "c3geextr"; que_i2 = "c3geexts"; |FINSI;
    |SI elige_i = "c3gesitu";    que_i1 = "c3gesitu"; que_i2 = "c3gesit1"; |FINSI;
    |SI elige_i = "c3gexplo";    que_i1 = "c3gexplo"; que_i2 = "c3gexpl1"; |FINSI;
    |SI elige_i = "cacasitu";    que_i1 = "cacasitu"; que_i2 = "cavasitu"; |FINSI;
    |SI elige_i = "cacaexpl";    que_i1 = "cacaexpl"; que_i2 = "cacaexp1"; |FINSI;
    |SI elige_i = "cay4ivac";    que_i1 = "cay41vac"; que_i2 = "cay22vac"; |FINSI;
    |SI elige_i = "cay4ivav";    que_i1 = "cay41vav"; que_i2 = "cay22vac"; |FINSI;
    |SI elige_i = "caybalsy";    que_i1 = "caybalsy"; que_i2 = "caybals2"; |FINSI;
    |SI elige_i = "caycosy0";    que_i1 = "caycosy0"; que_i2 = "";         |FINSI;
    |SI elige_i = "cainfres";    que_i1 = "cainfres"; que_i2 = "cainfre1"; |FINSI;
    |SI elige_i = "c3geinva";    que_i1 = "c3geinva"; que_i2 = "c3geinv1"; |FINSI;
    |SI #99#4 = "N";
        |SI elige_i = "cabatodo";    que_i1 = "crbatodo"; que_i2 = "crbatod1"; |FINSI;
        |SI elige_i = "cabaexpl";    que_i1 = "crbaexpl"; que_i2 = "crbaexp1"; |FINSI;
        |SI elige_i = "cabasitu";    que_i1 = "crbasitu"; que_i2 = "crbasit1"; |FINSI;
        |SI elige_i = "cabaorap";    que_i1 = "crbaorap"; que_i2 = "";         |FINSI;
        |SI elige_i = "cadiario";    que_i1 = "crdiario"; que_i2 = "";         |FINSI;
        |SI elige_i = "caextrim";    que_i1 = "crextrim"; que_i2 = "crextris"; |FINSI;
        |SI elige_i = "cavaexpl";    que_i1 = "crvaexpl"; que_i2 = "";         |FINSI;
        |SI elige_i = "caivexpl";    que_i1 = "crivexpl"; que_i2 = "";         |FINSI;
        |SI elige_i = "c3gebsys";    que_i1 = "c3rebsys"; que_i2 = "";         |FINSI;
        |SI elige_i = "c3gediar";    que_i1 = "c3rediar"; que_i2 = "";         |FINSI;
        |SI elige_i = "c3geextr";    que_i1 = "c3reextr"; que_i2 = "c3reexts"; |FINSI;
        |SI elige_i = "c3gesitu";    que_i1 = "c3resitu"; que_i2 = "c3resit1"; |FINSI;
        |SI elige_i = "c3gexplo";    que_i1 = "c3rexplo"; que_i2 = "c3rexpl1"; |FINSI;
        |SI elige_i = "cacasitu";    que_i1 = "crcasitu"; que_i2 = "crvasitu"; |FINSI;
        |SI elige_i = "cacaexpl";    que_i1 = "crcaexpl"; que_i2 = "crcaexp1"; |FINSI;
        |SI elige_i = "cay4ivac";    que_i1 = "cry41vac"; que_i2 = "cay22vac"; |FINSI;
        |SI elige_i = "cay4ivav";    que_i1 = "cry41vav"; que_i2 = "cay22vac"; |FINSI;
        |SI elige_i = "caybalsy";    que_i1 = "crybalsy"; que_i2 = "crybals2"; |FINSI;
        |SI elige_i = "cainfres";    que_i1 = "cainfres"; que_i2 = "crinfre1"; |FINSI;
        |SI elige_i = "c3geinva";    que_i1 = "c3geinva"; que_i2 = "c3reinv1"; |FINSI;
    |FINSI;
|FINSI;
|SI #99#1 = "L";
    |SI elige_i = "cabatodo";    que_i1 = "clbatodo"; que_i2 = "clbatod1"; |FINSI;
    |SI elige_i = "cabaexpl";    que_i1 = "clbaexpl"; que_i2 = "clbaexp1"; |FINSI;
    |SI elige_i = "cabasitu";    que_i1 = "clbasitu"; que_i2 = "clbasit1"; |FINSI;
    |SI elige_i = "cabaorap";    que_i1 = "cabaorap"; que_i2 = "";         |FINSI;
    |SI elige_i = "cadiario";    que_i1 = "cldiario"; que_i2 = "";         |FINSI;
    |SI elige_i = "caextrim";    que_i1 = "clextrim"; que_i2 = "caextris"; |FINSI;
    |SI elige_i = "cavaexpl";    que_i1 = "clvaexpl"; que_i2 = "";         |FINSI;
    |SI elige_i = "caivexpl";    que_i1 = "caivexpl"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3gebsys";    que_i1 = "clybalsy"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3gediar";    que_i1 = "c3lediar"; que_i2 = "";         |FINSI;
    |SI elige_i = "c3geextr";    que_i1 = "c3leextr"; que_i2 = "c3geexts"; |FINSI;
    |SI elige_i = "cacasitu";    que_i1 = "cacasitu"; que_i2 = "clvasitu"; |FINSI;
    |SI elige_i = "c3gesitu";    que_i1 = "c3gesitu"; que_i2 = "c3gesit1"; |FINSI;
    |SI elige_i = "c3gexplo";    que_i1 = "c3gexplo"; que_i2 = "c3gexpl1"; |FINSI;
    |SI elige_i = "cacaexpl";    que_i1 = "cacaexpl"; que_i2 = "cacaexp1"; |FINSI;
    |SI elige_i = "cay4ivac";    que_i1 = "cly41vac"; que_i2 = "cly22vac"; |FINSI;
    |SI elige_i = "cay4ivav";    que_i1 = "cly41vav"; que_i2 = "cly22vac"; |FINSI;
    |SI elige_i = "caybalsy";    que_i1 = "clybalsy"; que_i2 = "clybals2"; |FINSI;
    |SI elige_i = "caycosy0";    que_i1 = "clycosy0"; que_i2 = "";         |FINSI;
    |SI elige_i = "cainfres";    que_i1 = "cainfres"; que_i2 = "cainfre1"; |FINSI;
    |SI elige_i = "c3geinva";    que_i1 = "c3geinva"; que_i2 = "c3geinv1"; |FINSI;
    |SI #99#4 = "N";
        |SI elige_i = "cabaorap";    que_i1 = "crbaorap"; que_i2 = "";         |FINSI;
        |SI elige_i = "caextrim";    que_i1 = "clextrim"; que_i2 = "crextris"; |FINSI;
        |SI elige_i = "caivexpl";    que_i1 = "crivexpl"; que_i2 = "";         |FINSI;
        |SI elige_i = "cacasitu";    que_i1 = "crcasitu"; que_i2 = "clvasitu"; |FINSI;
        |SI elige_i = "c3gesitu";    que_i1 = "c3resitu"; que_i2 = "c3resit1"; |FINSI;
        |SI elige_i = "c3gexplo";    que_i1 = "c3rexplo"; que_i2 = "c3rexpl1"; |FINSI;
        |SI elige_i = "c3geextr";    que_i1 = "c3leextr"; que_i2 = "c3reexts"; |FINSI;
        |SI elige_i = "cacaexpl";    que_i1 = "crcaexpl"; que_i2 = "crcaexp1"; |FINSI;
        |SI elige_i = "cainfres";    que_i1 = "cainfres"; que_i2 = "crinfre1"; |FINSI;
        |SI elige_i = "c3geinva";    que_i1 = "c3geinva"; que_i2 = "c3reinv1"; |FINSI;
    |FINSI;
|FINSI;
|FPRC;
