|FICHEROS;
     retotren #5;
     reactafe #23;
     reemprco #25;
     rew00001 #99;
     rew00014 #605;
|FIN;

|VARIABLES;
      XCampos     = 0;
      NSecuencial = "";
      Field       = "";
      Casilla     = 0;
      Perce       = "";
      PerceC      = "";
      Descri      = "";
      Conta       = 0;
      Conta1      = 0;
      Conta2      = 0;
      Conta3      = 0;
      Coefi       = 0;
      Resto       = 0;
      ContaAct1   = 0;
      ContaAct2   = 0;
      ContaAct    = 0;
      Total1      = 0;
      Total2      = 0;
      Total3      = 0;
      Total4      = 0;
      Total5      = 0;
      Total6      = 0;
      Total7      = 0;
      Total8      = 0;
      Total9      = 0;
      Total10     = 0;


     &Tippar      = 0;
     &Parte1      = 0;
     &Parte2      = 0;
     &Muerto      = "";
     &Fecpar      = @;
     &VEmpresa    = 0;
     &VTipo       = "";
     &NCopia      = 0;
     &VSwCarga    = 0;
     &VTemporal0  = "";
     &VTemporal5  = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_utilid;

|PROCESO CargaE3;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 2) + 0.49) ! 0) - 1;
  Resto     = (Conta + 2) $ 2;

  |SI Resto = 0; Casilla = 27;  |FINSI;
  |SI Resto = 1; Casilla = 5;   |FINSI;

  #605#0 = ContaAct1;
  |LIBERA #605;
  |LEE 140#605=;
  |SI FSalida ! 0;
      |DDEFECTO #605;
      #605#0 = ContaAct1;
      |GRABA 140#605b;
  |FINSI;

                          #605Casilla = #25#14;
  Casilla = Casilla + 1;  #605Casilla = Perce;
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#17 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#18 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + ((#25#39 + #25#40 - #25#38) % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#19 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#20 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#48 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#21 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#22 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#23 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#24 % Coefi);
  Casilla = Casilla + 3;  #605Casilla =  #605Casilla + (#25#25 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#42 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#28 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#29 % Coefi);
  Casilla = Casilla + 2;  #605Casilla =  #605Casilla + (#25#26 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#27 % Coefi);
  Casilla = Casilla + 1;  #605Casilla =  #605Casilla + (#25#32 % Coefi);

  |GRABA 140#605a;
|FPRC;

|PROCESO EmpCoefiN;
  |SI #25#4 = "X"; |O #25#4 = "P"; |ACABA; |FINSI;
  |SI #25#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #25#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #25#2 = "V";
          Coefi = #25#7 + #25#8 + #25#9 + #25#10 + #25#11 + #25#12;
          |HAZ CargaE3;
          |ACABA;
      |FINSI;
      Coefi = 100;  |HAZ CargaE3;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #25#2 = "G"; Coefi = 50;     |HAZ CargaE3; |ACABA; |FINSI;
     |SI #25#2 = "T"; Coefi = 100;    |HAZ CargaE3; |ACABA; |FINSI;
     |SI #25#2 = "V"; Coefi = #25#7;  |HAZ CargaE3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
      |SI #25#2 = "G"; Coefi = 50;      |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "C"; Coefi = 100;     |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "V"; Coefi = #25#8;   |HAZ CargaE3; |ACABA; |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "1";
      |SI #25#2 = "1"; Coefi = 100;     |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "V"; Coefi = #25#9;   |HAZ CargaE3; |ACABA; |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "2";
      |SI #25#2 = "2"; Coefi = 100;     |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "V"; Coefi = #25#10;  |HAZ CargaE3; |ACABA; |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "3";
      |SI #25#2 = "3"; Coefi = 100;     |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "V"; Coefi = #25#11;  |HAZ CargaE3; |ACABA; |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "4";
      |SI #25#2 = "4"; Coefi = 100;    |HAZ CargaE3; |ACABA; |FINSI;
      |SI #25#2 = "V"; Coefi = #25#12; |HAZ CargaE3; |ACABA; |FINSI;
      |ACABA;
  |FINSI;
|FPRC;

|PROCESO EmpCoefiP;
  |SI #25#4 = "X"; |O #25#4 = "P"; |ACABA; |FINSI;
  |SI #25#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #25#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #25#2 = "V";
          |SI Tippar = 1;
              |SI #25#43 = 0;  Coefi = (#25#7 + #25#8) * Parte2; |FINSI;
              |SI #25#43 = 1;  |ACABA;                         |FINSI;
              |SI #25#43 = 2;  Coefi = #25#7 + #25#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2;
              |SI #25#43 = 0;  Coefi = (#25#7 + #25#8) * Parte1; |FINSI;
              |SI #25#43 = 1;  Coefi = #25#7 + #25#8;            |FINSI;
              |SI #25#43 = 2;  |ACABA;                         |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #25#43 = 0;  Coefi = (#25#7 + #25#8) * Parte1; |FINSI;
              |SI #25#43 = 2;  |ACABA;                         |FINSI;
              |SI #25#43 = 1;  Coefi = #25#7 + #25#8;            |FINSI;
          |FINSI;
          |HAZ CargaE3;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #25#43 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #25#43 = 1;  |ACABA;               |FINSI;
              |SI #25#43 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #25#2 = "G";
              |SI Tippar = 2;
                  |SI #25#43 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #25#43 = 1;  Coefi = 100;          |FINSI;
                  |SI #25#43 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #25#43 = 0;
                      |SI #25#2 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                         |SI #25#2 = "C"; |Y Muerto = "C";
                             Coefi = 100;
                         |SINO;
                             Coefi = 100 * Parte1;
                         |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #25#43 = 1;  Coefi = 100;          |FINSI;
                  |SI #25#43 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #25#43 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #25#43 = 2;  |ACABA;               |FINSI;
              |SI #25#43 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaE3;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #25#2 = "G";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = 50;          |FINSI;
             |SI #25#43 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #25#43 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #25#43 = 1; Coefi = 50;          |FINSI;
                 |SI #25#43 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #25#43 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #25#43 = 1; |ACABA;                      |FINSI;
                 |SI #25#43 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;              |FINSI;
             |SI #25#43 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;

     |SI #25#2 = "T";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = 100;          |FINSI;
             |SI #25#43 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #25#43 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #25#43 = 1; |ACABA;               |FINSI;
                 |SI #25#43 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;               |FINSI;
             |SI #25#43 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;

     |SI #25#2 = "V";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = #25#7 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = #25#7;          |FINSI;
             |SI #25#43 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #25#7;             |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = #25#7 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;        |FINSI;
             |SI #25#43 = 2; Coefi = #25#7;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #25#2 = "G";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = 50;          |FINSI;
             |SI #25#43 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #25#43 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #25#43 = 1; |ACABA;              |FINSI;
                 |SI #25#43 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #25#43 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #25#43 = 1; Coefi = 50;                  |FINSI;
                 |SI #25#43 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;              |FINSI;
             |SI #25#43 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;

     |SI #25#2 = "C";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = 100;          |FINSI;
             |SI #25#43 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #25#43 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #25#43 = 1; |ACABA;               |FINSI;
                 |SI #25#43 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;               |FINSI;
             |SI #25#43 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;

     |SI #25#2 = "V";
         |SI Tippar = 1;
             |SI #25#43 = 0; Coefi = #25#8 * Parte1; |FINSI;
             |SI #25#43 = 1; Coefi = #25#8;          |FINSI;
             |SI #25#43 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #25#8;             |FINSI;
         |SI Tippar = 3;
             |SI #25#43 = 0; Coefi = #25#8 * Parte2; |FINSI;
             |SI #25#43 = 1; |ACABA;        |FINSI;
             |SI #25#43 = 2; Coefi = #25#8;          |FINSI;
         |FINSI;
         |HAZ CargaE3; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO EmpCoefi;
  |SI VSwCarga = 0;  |HAZ EmpCoefiN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ EmpCoefiP;  |FINSI;
|FPRC;

|DEFBUCLE reemprco;
  #25#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, EmpCoefi;
|FIN;

|| ********************** Activos Fijos Empresarial Directa ****************

|PROCESO CargaE4;
  #605#0 = 0;
  |LIBERA #605;
  |LEE 140#605=;
  |SI FSalida ! 0;
      |DDEFECTO #605;
      #605#0 = 0;
      |GRABA 140#605b;
  |FINSI;

  Conta = Conta + 1;
  |SI Conta [ 6;
      Casilla = Casilla + 1;  #605Casilla = #23#7;
      Casilla = Casilla + 1;  #605Casilla = #23#24;
      Casilla = Casilla + 1;  #605Casilla = #23#26;
      Casilla = Casilla + 1;  #605Casilla = #23#29;
      Casilla = Casilla + 1;  #605Casilla = #23#34;
      |SI #23#59 = "D";
          Casilla = Casilla + 1; #605Casilla = "X";
          Casilla = Casilla + 1; #605Casilla = " ";
      |SINO;
          Casilla = Casilla + 1; #605Casilla = " ";
          Casilla = Casilla + 1; #605Casilla = "X";
      |FINSI;
  |SINO;
      #605#94  = "RESTANTES";
      #605#95  = #605#95 + #23#24;
      #605#96  = #605#96 + #23#26;
      #605#97  = #605#97 + #23#29;
      #605#98  = #605#98 + #23#34;
      #605#99  = " ";
      #605#100 = " ";
  |FINSI;

  |GRABA 140#605a;
|FPRC;

|PROCESO AfectosN;
  |SI #23#29 = 0; |ACABA; |FINSI;
  |SI #23#37 = "X"; |O #23#37 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A";
      |SI #23#4 = "V";
          Coefi = #23#38 + #23#39 + #23#40 + #23#41 + #23#42 + #23#43;
          |HAZ CargaE4;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaE4;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #23#4 = "G"; Coefi = 50;     |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "T"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#38; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #23#4 = "G"; Coefi = 50;     |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "C"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#39; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #23#4 = "1"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#40; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #23#4 = "2"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#41; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #23#4 = "3"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#42; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #23#4 = "4"; Coefi = 100;    |HAZ CargaE4; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#43; |HAZ CargaE4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO AfectosP;
  |SI #23#37 = "X"; |O #23#37 = "P"; |ACABA; |FINSI;
  |SI #23#29 = 0; |ACABA; |FINSI;

  |SI #99#1 = "A";
      |SI #23#4 = "V";
          |SI Tippar = 1;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte2; |FINSI;
              |SI #23#45 = 1;  |ACABA;                         |FINSI;
              |SI #23#45 = 2;  Coefi = #23#38 + #23#39;            |FINSI;
          |FINSI;
          |SI Tippar = 2;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte1; |FINSI;
              |SI #23#45 = 1;  Coefi = #23#38 + #23#39;            |FINSI;
              |SI #23#45 = 2;  |ACABA;                         |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte1; |FINSI;
              |SI #23#45 = 2;  |ACABA;                         |FINSI;
              |SI #23#45 = 1;  Coefi = #23#38 + #23#39;            |FINSI;
          |FINSI;
          |HAZ CargaE4;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #23#45 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #23#45 = 1;  |ACABA;               |FINSI;
              |SI #23#45 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
         |SI #23#4 = "G";
              |SI Tippar = 2;
                  |SI #23#45 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #23#45 = 1;  Coefi = 100;          |FINSI;
                  |SI #23#45 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #23#45 = 0;
                      |SI #23#4 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                          |SI #23#4 = "C"; |Y Muerto = "C";
                              Coefi = 100;
                          |SINO;
                              Coefi = 100 * Parte1;
                          |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #23#45 = 1;  Coefi = 100;          |FINSI;
                  |SI #23#45 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #23#45 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #23#45 = 2;  |ACABA;               |FINSI;
              |SI #23#45 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaE4;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #23#4 = "G";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 50;          |FINSI;
             |SI #23#45 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #23#45 = 1; Coefi = 50;          |FINSI;
                 |SI #23#45 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #23#45 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #23#45 = 1; |ACABA;                      |FINSI;
                 |SI #23#45 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;              |FINSI;
             |SI #23#45 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;

     |SI #23#4 = "T";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 100;          |FINSI;
             |SI #23#45 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #23#45 = 1; |ACABA;               |FINSI;
                 |SI #23#45 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;               |FINSI;
             |SI #23#45 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;

     |SI #23#4 = "V";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = #23#38 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = #23#38;          |FINSI;
             |SI #23#45 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #23#38;             |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = #23#38 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;        |FINSI;
             |SI #23#45 = 2; Coefi = #23#38;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #23#4 = "G";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 50;          |FINSI;
             |SI #23#45 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #23#45 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #23#45 = 1; |ACABA;              |FINSI;
                 |SI #23#45 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #23#45 = 1; Coefi = 50;                  |FINSI;
                 |SI #23#45 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;              |FINSI;
             |SI #23#45 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;

     |SI #23#4 = "C";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 100;          |FINSI;
             |SI #23#45 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #23#45 = 1; |ACABA;               |FINSI;
                 |SI #23#45 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;               |FINSI;
             |SI #23#45 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;

     |SI #23#4 = "V";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = #23#39 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = #23#39;          |FINSI;
             |SI #23#45 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #23#39;             |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = #23#39 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;        |FINSI;
             |SI #23#45 = 2; Coefi = #23#39;          |FINSI;
         |FINSI;
         |HAZ CargaE4;
         |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO Afectos;
  |SI VSwCarga = 0;  |HAZ AfectosN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ AfectosP;  |FINSI;
|FPRC;

|DEFBUCLE reactafe;
  #23#1;
  2;
  #99#0, 01, "EC";
  #99#0, 99, "EC";
  e;
  NULL, Afectos;
|FIN;

|PROCESO Totales605;
  #605#4   = ContaAct;

  #605#17 = #605#8  + #605#9  + #605#10 + #605#11 + #605#12 + #605#13 + #605#14 + #605#15 + #605#16;
  #605#39 = #605#30 + #605#31 + #605#32 + #605#33 + #605#34 + #605#35 + #605#36 + #605#37 + #605#38;

  #605#18 = #605#7  - #605#17;
  #605#40 = #605#29 - #605#39;

  #605#23  = #605#20 - #605#21 - #605#22;
  #605#45  = #605#42 - #605#43 - #605#44;

  #605#102 = #99#7;
  #605#103 = #99#3;

  |GRABA 140#605a;
  |LIBERA #605;

  Total1  = #5#20;
  Total2  = Total2  + (#605#17 + #605#39);
  Total3  = Total3  + (#605#19 + #605#41);
  Total4  = Total4  + (#605#20 + #605#42);
  Total5  = Total5  + (#605#21 + #605#43);
  Total6  = Total6  + (#605#22 + #605#44);
  Total7  = Total7  + (#605#23 + #605#45);
  Total8  = Total8  + (#605#24 + #605#46);
  Total9  = Total9  + (#605#25 + #605#47);
  Total10 = #5#21;
|FPRC;

|DEFBUCLE rew00014T;
  #605#1;
  ;
  00;
  99;
  be;
  NULL, Totales605;
|FIN;

|PROCESO LeeFicheros;
  |ABRE #99;
  #99#0 = VEmpresa;
  #99#1 = VTipo;
  |LEE 040#99=;
  |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
  |CIERRA #99;

  |ABRE #5;
  #5#0   = #99#0;
  #5#141 = #99#1;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;
|FPRC;

|PROCESO CargaHoja5;
  |HAZ LeeFicheros;

  ContaAct = 0;
  Conta    = 0;
  |BUCLE reemprco;
  |SI Conta > 2;
      ContaAct = (((Conta / 2) + 0.49) ! 0) - 1;
  |SINO;
      #605#0 = 1;  |BORRA 140#605c;  |LIBERA #605;
  |FINSI;

  Conta   = 0;
  Casilla = 58;
  |BUCLE reactafe;

  Total1  = 0;  Total2  = 0;  Total3  = 0;  Total4  = 0;  Total5  = 0;
  Total6  = 0;  Total7  = 0;  Total8  = 0;  Total9  = 0;  Total10 = 0;

  |BUCLE rew00014T;

  |ABRE #605;
  #605#0 = 0;
  |LIBERA #605;
  |LEE 140#605=;
  |SI FSalida = 0;
      #605#49 = Total1;   #605#50 = Total2;   #605#51 = Total3;
      #605#52 = Total4;   #605#53 = Total5;   #605#54 = Total6;
      #605#55 = Total7;   #605#56 = Total8;   #605#57 = Total9;
      #605#58 = Total10;

     |GRABA 140#605a;
  |FINSI;
  |CIERRA #605;
|FPRC;

|PROCESO GrabaTexto605;
  |HAZ BorraCampos;

  ICampos = Campos1 <-;
  |PARA XCampos = 1;  |SI XCampos [ 101;  |HACIENDO XCampos = XCampos + 1;
        Campos  = #605XCampos;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos1  <-;                                    Campos = "100";
  ICampos = Campos2  <-;                                    Campos = "05";
  ICampos = Campos3  <-; |SI #605#0 ! 0;  Campos = "C";   |FINSI;
  ICampos = Campos101 <-; Valfa = &13 + &10;                Campos = Valfa;

  ICampos = Campos7 <-;
  |PARA XCampos = 7;  |SI XCampos [ 26;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos29 <-;
  |PARA XCampos = 29;  |SI XCampos [ 58;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos60 <-;
  |PARA XCampos = 60;  |SI XCampos [ 63;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos67 <-;
  |PARA XCampos = 67;  |SI XCampos [ 70;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos74 <-;
  |PARA XCampos = 74;  |SI XCampos [ 77;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos81 <-;
  |PARA XCampos = 81;  |SI XCampos [ 84;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos88 <-;
  |PARA XCampos = 88;  |SI XCampos [ 91;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos95 <-;
  |PARA XCampos = 95;  |SI XCampos [ 98;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;

  Pos = -1;
  NSecuencial = "r+b " + NEmpresas;
  |FABRE NSecuencial;
  |SI FSalida < 0;
      NSecuencial = "wb  " + NEmpresas;
      |FABRE NSecuencial;
  |FINSI;

  Handle = FSalida;
  |SI FSalida ] 0;
      |PARA; |SI; |HACIENDO;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
      |SIGUE;
  |FINSI;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 101; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
  |FCIERRA Handle;
|FPRC;

|DEFBUCLE rew00014G;
  #605#1;
  ;
  00;
  99;
  be;
  NULL, GrabaTexto605;
|FIN;

|PROGRAMA;
  |NOME_DAT #99  VTemporal0;
  |NOME_DAT #605 VTemporal5;

  |SI VSwCarga = 0; |O VSwCarga = 1;
      |ABRE #605;  |CIERRA #605;  |DELINDEX #605;
      |ABRE #605;
      |HAZ CargaHoja5;
      |CIERRA #605;
  |FINSI;

  |SI VSwCarga = 100;
       |BUCLE rew00014G;
  |FINSI;
|FPRO;
