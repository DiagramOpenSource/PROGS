|FICHEROS;
     reactafe #0;
     reproedi #1;
     reprofco #2;
     reempedi #3;
     reemprco #4;
     reempmod #5;
     reempagr #6;
     redifrei #7;
|FIN;

|VARIABLES;
     TipoClave    = "";
     FechaVenta   = @;
     FechaCompra  = @;
     SwFich       = 0;
     Linea        = 0;
     FEstado      = 0;
     sw           = 0;
     suma         = 0;
     valor        = 0;
     pantalla     = 0;
     _Incremento  = 0;
     Disminucion  = 0;
     Disminucioe  = 0;
     pepe         = 0;
     arte         = "";
     SwTaxi       = 0;
     rendi        = 0;
     Porce        = 0;
     Dto1         = 0;
     Dto2         = 0;
     Dto3         = 0;
     EjerN1       = 0;
     EjerN2       = 0;
     EjerT        = 0;
     EjerA1       = "";
     EjerA2       = "";
     VAlfa        = "";

     &empresa     = 0;
     &nombre      = "";
     &modo        = 0;
     &modelito    = 0;
     &tipomod     = "";
     &errorlin    = 0;
     &indivi      = "";
     &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
     &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 0;
     &numerica7   = 0;  &numerica8  = 8;   &numerica9  = 0;
     &numerica10  = 0;  &numerica11 = 8;   &numerica12 = 0;
     &numerica13  = 0;  &numerica14 = 8;   &numerica15 = 0;
     &numerica16  = 0;  &numerica17  = 0;  &numerica18  = 0;
     &numerica19  = 0;  &numerica20  = 0;  &numerica21  = 0;
     &numerica22  = 0;

     &alfanumer1  = ""; &alfanumer2 = "";  &alfanumer3 = "";
     &alfanumer4  = ""; &alfanumer5 = "";  &alfanumer6 = "";
     &alfanumer7  = ""; &alfanumer8 = "";  &alfanumer9 = "";
     &alfanumer10 = ""; &alfanumer11 = ""; &alfanumer12 = "";
     &alfanumer13 = ""; &alfanumer14 = ""; &alfanumer15 = "";
     &alfanumer16 = ""; &alfanumer17 = "";

     &fechas1     = @; &fechas2     = @;   &fechas3    = @;
     &fechas4     = @; &fechas5     = @;   &fechas6    = @;
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_activo;
|INCLUYE i_patrim;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = 99;
|FRUT;

|PROGRAMA;
  |PINPA #0#0;
  |SI modo = 1;  |ENTLINEAL #1#0,2,1,15,0,inferior,superior;  |FINSI;
  |SI modo = 2;  |ENTLINEAL #1#0,2,2,15,0,inferior,superior;  |FINSI;
  |SI modo = 4;  |ENTLINEAL #1#0,2,4,15,0,inferior,superior;  |FINSI;
  |HAZ actual;
|FPRO;

|PROCESO ayuda; |TIPO 2;
  pantalla = 0 +. 1;
  |HAZ baja_pat;
  |HAZ BajaDife;

  QueTipo    = (FEntrada / 100) ! 0;

  |SI pantalla = 1;
      |SI #0#2 = "PD"; |HAZ profdire; |FINSI;
      |SI #0#2 = "PC"; |HAZ profcoef; |FINSI;
      |SI #0#2 = "ED"; |HAZ emprdire; |FINSI;
      |SI #0#2 = "EC"; |HAZ emprcoef; |FINSI;
      |SI #0#2 = "EM"; |HAZ emprmodu; |FINSI;
      |SI #0#2 = "AG"; |HAZ agricola; |FINSI;
      |SI FEstado = 0;
          |HAZ cargadat;
      |SINO;
          |ERROR;  |ACABA;
      |FINSI;
  |FINSI;

  HContribu  = #0#0;
  HNombre    = nombre;
  HPrograma  = "(reactafe) ACTIVOS AFECTOS";
  HLinea     = #0#1;
  HPerceptor = #0#5;
  HRdto      = #0#26;

  |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
  |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
  |SI QueTipo = 3; HTipo = "BAJA FICHA";         |FINSI;

  |SI QueTipo = 3; |Y pantalla ! 1;  |HAZ AltaHistorico;  |FINSI;
  |SI QueTipo < 3; |Y pantalla = 1;  |HAZ AltaHistorico;  |FINSI;

  |HAZ alta_pat;
  |HAZ AltaDife;
|FPRC;

|PROCESO consulta; |TIPO 0;
  modelito = (FEntrada / 100) ! 0;
  |SI modelito = 4; |HAZ cargadat; |FINSI;
|FPRC;

|PROCESO cargadat;
  |HAZ carga;
  |SUB_EJECUTA "repant13.run";
  |SI errorlin = 0;
      |ERROR;
  |SINO;
      |SI modelito ! 4; |HAZ descarga; |PINTA #0#26; |FINSI;
  |FINSI;
|FPRC;

|PROCESO descarga;
  #0#7  = alfanumer1;
  #0#8  = alfanumer2;
  #0#9  = numerica1;
  #0#10 = numerica2;
  #0#11 = numerica3;
  #0#12 = fechas1;
  #0#13 = numerica4;
  #0#14 = numerica5;
  #0#15 = fechas2;
  #0#16 = fechas3;
  #0#17 = fechas4;
  #0#18 = numerica6;
  #0#19 = numerica7;
  #0#20 = numerica8;
  #0#21 = alfanumer3;
  #0#22 = alfanumer4;
  #0#23 = alfanumer5;
  #0#24 = numerica9;
  #0#25 = fechas5;
  #0#26 = numerica10;
  #0#27 = alfanumer6;
  #0#28 = alfanumer7;
  #0#29 = numerica11;
  #0#30 = fechas6;
  #0#31 = numerica12;
  #0#32 = numerica13;
  #0#33 = numerica14;
  #0#34 = numerica15;
  #0#35 = alfanumer8;
  #0#36 = alfanumer9;
  #0#44 = alfanumer10;
  #0#45 = numerica16;
  #0#46 = numerica17;
  #0#47 = numerica18;
  #0#48 = alfanumer11;
  #0#49 = alfanumer12;
  #0#50 = alfanumer13;
  #0#51 = alfanumer14;
  #0#52 = alfanumer15;
  #0#55 = numerica19;
  #0#58 = numerica20;
  #0#59 = alfanumer16;
  #0#60 = alfanumer17;
  #0#61 = numerica21;
  #0#62 = numerica22;
  npro  = 12; |HAZ sigrabo;
|FPRC;

|PROCESO carga;
  alfanumer1  = #0#7;
  alfanumer2  = #0#8;
  numerica1   = #0#9;
  numerica2   = #0#10;
  numerica3   = #0#11;
  fechas1     = #0#12;
  numerica4   = #0#13;
  numerica5   = #0#14;
  fechas2     = #0#15;
  fechas3     = #0#16;
  fechas4     = #0#17;
  numerica6   = #0#18;
  numerica7   = #0#19;
  numerica8   = #0#20;
  alfanumer3  = #0#21;
  alfanumer4  = #0#22;
  alfanumer5  = #0#23;
  numerica9   = #0#24;
  fechas5     = #0#25;
  numerica10  = #0#26;
  alfanumer6  = #0#27;
  alfanumer7  = #0#28;
  numerica11  = #0#29;
  fechas6     = #0#30;
  numerica12  = #0#31;
  numerica13  = #0#32;
  numerica14  = #0#33;
  numerica15  = #0#34;
  alfanumer8  = #0#35;
  alfanumer9  = #0#36;
  alfanumer10 = #0#44;
  numerica16  = #0#45;
  numerica17  = #0#46;
  numerica18  = #0#47;
  alfanumer11 = #0#48;
  alfanumer12 = #0#49;
  alfanumer13 = #0#50;
  alfanumer14 = #0#51;
  alfanumer15 = #0#52;
  numerica19  = #0#55;
  numerica20  = #0#58;
  alfanumer16 = #0#59;
  alfanumer17 = #0#60;
  numerica21  = #0#61;
  numerica22  = #0#62;
|FPRC;

|PROCESO profdire;
  |ABRE #1;
  #1#0 = #0#0;
  #1#1 = #0#3;
  |LIBERA #1;
  |LEE 110#1=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #1#2;
     #0#5  = #1#3;
     #0#6  = #1#15;
     #0#37 = #1#4;
     #0#38 = #1#7;
     #0#39 = #1#8;
     #0#40 = #1#9;
     #0#41 = #1#10;
     #0#42 = #1#11;
     #0#43 = #1#12;
     #0#45 = #1#35;
     #0#50 = #1#13 + #1#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro en Actividad";
     |ERROR; |ACABA;
  |FINSI;
  |LIBERA #1;
  |CIERRA #1;
|FPRC;

|PROCESO profcoef;
  |ABRE #2;
  #2#0 = #0#0;
  #2#1 = #0#3;
  |LEE 040#2=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #2#2;
     #0#5  = #2#3;
     #0#6  = #2#15;
     #0#37 = #2#4;
     #0#38 = #2#7;
     #0#39 = #2#8;
     #0#40 = #2#9;
     #0#41 = #2#10;
     #0#42 = #2#11;
     #0#43 = #2#12;
     #0#45 = #2#42;
     #0#50 = #2#13 + #2#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro Rendimiento Irregulares";
     |ERROR; |ACABA;
  |FINSI;
  |CIERRA #2;
|FPRC;

|PROCESO emprdire;
  |ABRE #3;
  #3#0 = #0#0;
  #3#1 = #0#3;
  |LEE 040#3=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #3#2;
     #0#5  = #3#3;
     #0#6  = #3#15;
     #0#37 = #3#4;
     #0#38 = #3#7;
     #0#39 = #3#8;
     #0#40 = #3#9;
     #0#41 = #3#10;
     #0#42 = #3#11;
     #0#43 = #3#12;
     #0#45 = #3#54;
     #0#50 = #3#13 + #3#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro Rendimiento Irregulares";
     |ERROR; |ACABA;
  |FINSI;
  |CIERRA #3;
|FPRC;

|PROCESO emprcoef;
  |ABRE #4;
  #4#0 = #0#0;
  #4#1 = #0#3;
  |LEE 040#4=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #4#2;
     #0#5  = #4#3;
     #0#6  = #4#15;
     #0#37 = #4#4;
     #0#38 = #4#7;
     #0#39 = #4#8;
     #0#40 = #4#9;
     #0#41 = #4#10;
     #0#42 = #4#11;
     #0#43 = #4#12;
     #0#45 = #4#43;
     #0#50 = #4#13 + #4#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro Rendimiento Irregulares";
     |ERROR; |ACABA;
  |FINSI;
  |CIERRA #4;
|FPRC;

|PROCESO emprmodu;
  |ABRE #5;
  #5#0 = #0#0;
  #5#1 = #0#3;
  |LEE 040#5=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #5#2;
     #0#5  = #5#3;
     #0#6  = #5#15;
     #0#37 = #5#4;
     #0#38 = #5#7;
     #0#39 = #5#8;
     #0#40 = #5#9;
     #0#41 = #5#10;
     #0#42 = #5#11;
     #0#43 = #5#12;
     #0#45 = #5#54;
     #0#50 = #5#13 + #5#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro Rendimiento Irregulares";
     |ERROR; |ACABA;
  |FINSI;
  |CIERRA #5;
|FPRC;

|| **************************************************************************

|PROCESO agricola;
  |ABRE #6;
  #6#0 = #0#0;
  #6#1 = #0#3;
  |LEE 040#6=;
  FEstado = FSalida;
  |SI FSalida = 0;
     #0#4  = #6#2;
     #0#5  = #6#3;
     #0#6  = #6#15;
     #0#37 = #6#4;
     #0#38 = #6#7;
     #0#39 = #6#8;
     #0#40 = #6#9;
     #0#41 = #6#10;
     #0#42 = #6#11;
     #0#43 = #6#12;
     #0#45 = #6#6;
     #0#50 = #6#13 + #6#14;
     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
  |SINO;
     |MENAV "     No existe registro Rendimiento Irregulares";
     |ERROR; |ACABA;
  |FINSI;
  |CIERRA #6;
|FPRC;

||                          PROCESO ACTUALIZACION
|| **************************************************************************

|PROCESO IncreDismi;
  |SI #0#26 > 0;
      |SI #0#59 = "D";
          |SI #0#60 = "P";
              _Incremento = _Incremento + #0#62;
          |FINSI;
      |SINO;
          _Incremento = _Incremento + (#0#26 - #0#34);
      |FINSI;
  |SINO;
      Disminucion = Disminucion + (#0#26 * -1);
  |FINSI;

  arte = #0#48 % 103;
  SwTaxi = 0;
  |SI arte = "***"; SwTaxi = 1; |FINSI;
|FPRC;

|PROCESO Acumula;
  |SI sw = 0;
      _Incremento  = 0;
      Disminucion  = 0;
      Linea        = #0#3;
      sw           = 1;
      TipoClave    = #0#52;
      FechaCompra  = #0#12;
      FechaVenta   = #0#25;
  |FINSI;

  |SI Linea ! #0#3;
      |SI SwFich = 1; |HAZ GrabaFic1; |FINSI;
      |SI SwFich = 2; |HAZ GrabaFic2; |FINSI;
      |SI SwFich = 3; |HAZ GrabaFic3; |FINSI;
      |SI SwFich = 4; |HAZ GrabaFic4; |FINSI;
      |SI SwFich = 5; |HAZ GrabaFic5; |FINSI;
      |SI SwFich = 6; |HAZ GrabaFic6; |FINSI;

      TipoClave    = #0#52;
      FechaCompra  = #0#12;
      FechaVenta   = #0#25;
      Linea        = #0#3;
      _Incremento  = 0;
      Disminucion  = 0;
      |HAZ IncreDismi;
  |SINO;
      |HAZ IncreDismi;
  |FINSI;
|FPRC;

|PROCESO GrabaFic1;
  #1#0 = empresa;
  #1#1 = Linea;
  |LIBERA #1;
  |LEE 110#1=;
  |SI FSalida = 0;
      #1#33 = _Incremento;
      #1#34 = Disminucion;
      #1#27 = #1#33 - #1#34;
      |SI #1#27 < 0; #1#27 = 0; |FINSI;
      #1#28 = #1#16 - #1#26 + #1#27;
      |GRABA 020#1a;

      HContribu  = #1#0;
      HNombre    = nombre;
      HPrograma  = "(reproedi) PROFESIONALES DIRECTA";
      HLinea     = #1#1;
      HPerceptor = #1#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #1#28;
      |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO GrabaFic2;
  #2#0 = empresa;
  #2#1 = Linea;
  |LIBERA #2;
  |LEE 110#2=;
  |SI FSalida = 0;
      #2#26 = _Incremento;
      #2#27 = Disminucion;
      #2#28 = Disminucioe;
      #2#31 = #2#26 - #2#27 - #2#28 - #2#29;
      ||   |SI #2#31 < 0; #2#31 = 0; |FINSI;  ||Preguntar
      #2#32 = #2#41 + #2#31;
      |GRABA 020#2a;

      HContribu  = #2#0;
      HNombre    = nombre;
      HPrograma  = "(reprofco) PROFESIONALES COEFICIENTE";
      HLinea     = #2#1;
      HPerceptor = #2#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #2#32;
      |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO GrabaFic3;
  #3#0 = empresa;
  #3#1 = Linea;
  |LIBERA #3;
  |LEE 110#3=;
  |SI FSalida = 0;
      #3#46 = _Incremento;
      #3#47 = Disminucion;
      #3#48 = #3#46 - #3#47;
      |SI #3#48 < 0; #3#48 = 0; |FINSI;
      #3#49 = #3#45 + #3#48;
      |GRABA 020#3a;

      HContribu  = #3#0;
      HNombre    = nombre;
      HPrograma  = "(reempedi) EMPRESARIALES DIRECTA";
      HLinea     = #3#1;
      HPerceptor = #3#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #3#49;
      |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO GrabaFic4;
  #4#0 = empresa;
  #4#1 = Linea;
  |LIBERA #4;
  |LEE 110#4=;
  |SI FSalida = 0;
      #4#26 = _Incremento;
      #4#27 = Disminucion;
      #4#28 = Disminucioe;
      #4#31 = #4#26 - #4#27 - #4#28 - #4#29;
      || |SI #4#31 < 0; #4#31 = 0; |FINSI;  || preguntar si es asi o no
      #4#32 = #4#42 + #4#31;
      |GRABA 020#4a;

      HContribu  = #4#0;
      HNombre    = nombre;
      HPrograma  = "(reemprco) EMPRESARIALES COEFICIENTE";
      HLinea     = #4#1;
      HPerceptor = #4#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #4#32;
      |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO GrabaFic5;
  #5#0 = empresa;
  #5#1 = Linea;
  |LIBERA #5;
  |LEE 110#5=;
  |SI FSalida = 0;
      |SI SwTaxi = 0; #5#45 = _Incremento; #5#68 = 0; |FINSI;
      |SI SwTaxi = 1; #5#68 = _Incremento; #5#45 = 0; |FINSI;

      #5#46 = Disminucion;
      #5#47 = Disminucioe;

      rendi = #5#44 - #5#68 - #5#47 - #5#48;

      |SI #5#59 ! 0;
          #5#60 = rendi % #5#59;
          rendi = rendi - #5#60;
      |SINO;
          #5#60 = 0;
      |FINSI;

      |SI #5#63 ! 0;
          #5#64 = rendi % #5#63;
          rendi = rendi - #5#64;
      |SINO;
          #5#64 = 0;
      |FINSI;

      rendi = rendi + #5#45 - #5#46 + #5#61;
      #5#49 = rendi;
      |SI #5#49 < 0; #5#49 = 0; |FINSI;
      |GRABA 020#5a;

      HContribu  = #5#0;
      HNombre    = nombre;
      HPrograma  = "(reempmod) EMPRESARIALES MODULOS";
      HLinea     = #5#1;
      HPerceptor = #5#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #5#49;
      |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO GrabaFic6;  || Agricolas
  #6#0 = empresa;
  #6#1 = Linea;
  |LIBERA #6;
  |LEE 140#6=;
  |SI FSalida = 0;
      #6#32 = Disminucion;
      #6#25 = Disminucioe;

      |SI TipoClave ! "F";
           #6#31 = _Incremento;
           #6#33 = 0;
      |SINO;
           #6#31 = 0;
           |HAZ Tiempo;
           Porce = EjerT * 14.28;
           |SI Porce > 99; Porce = 100; |FINSI;
           #6#33 = _Incremento - ((_Incremento * Porce) / 100);
      |FINSI;

      #6#27 = #6#24 + #6#33 - #6#25 - #6#26;
      #6#34 = #6#27;
                                   Dto1 = (#6#34 % #6#28) ! 0;
      Dto2  = 0;  |SI #6#29 = "S"; Dto2 = (#6#34 % 20)    ! 0;  |FINSI;
      Dto3  = 0;  |SI #6#30 = "S"; Dto3 = (#6#34 % 25)    ! 0;  |FINSI;
      #6#34 = #6#34 - Dto1 - Dto2 - Dto3;
      #6#34 = #6#34 + #6#31 - #6#32;

      |GRABA 140#6a;

      HContribu  = #6#0;
      HNombre    = nombre;
      HPrograma  = "(reempagr) AGRICOLAS Y GANADERAS";
      HLinea     = #6#1;
      HPerceptor = #6#3;
      HTipo      = "MODIFICACION DESDE ACTIVOS AFECTOS";
      HRdto      = #6#34;
     |HAZ AltaHistorico;
  |FINSI;
|FPRC;

|PROCESO Tiempo;
  EjerA1 = FechaVenta % -102;
  EjerA2 = FechaCompra % -102;
  EjerN1 = EjerA1;
  EjerN2 = EjerA2;
  EjerT  = EjerN1 - EjerN2;

  EjerA1 = FechaVenta % 402;
  EjerA2 = FechaCompra % 402;
  |SI EjerA1 > EjerA2; EjerT = EjerT + 1; |FINSI;

  |SI EjerA1 = EjerA2;
      EjerA1 = FechaVenta % 102;
      EjerA2 = FechaCompra % 102;
      |SI EjerA1 ] EjerA2; EjerT = EjerT + 1; |FINSI;
  |FINSI;
  EjerT = EjerT - 2;
|FPRC;

|DEFBUCLE leefic01;
  #0#2;
  ;
  empresa, "PD", 01;
  empresa, "PD", 99;
  e;
  NULL, Acumula;
|FIN;

|DEFBUCLE leefic02;
  #0#2;
  ;
  empresa, "PC", 01;
  empresa, "PC", 99;
  e;
  NULL, Acumula;
|FIN;

|DEFBUCLE leefic03;
  #0#2;
  ;
  empresa, "ED", 01;
  empresa, "ED", 99;
  e;
  NULL, Acumula;
|FIN;

|DEFBUCLE leefic04;
  #0#2;
  ;
  empresa, "EC", 01;
  empresa, "EC", 99;
  e;
  NULL, Acumula;
|FIN;

|DEFBUCLE leefic05;
  #0#2;
  ;
  empresa, "EM", 01;
  empresa, "EM", 99;
  e;
  NULL, Acumula;
|FIN;

|DEFBUCLE leefic06;
  #0#2;
  ;
  empresa, "AG", 01;
  empresa, "AG", 99;
  ;
  NULL, Acumula;
|FIN;

|PROCESO actual;
  |ABRE #1;
  SwFich = 1; sw = 0; |BUCLE leefic01;
  |SI sw = 1; |HAZ GrabaFic1; |FINSI;
  |CIERRA #1;

  |ABRE #2;
  SwFich = 2; sw = 0; |BUCLE leefic02;
  |SI sw = 1; |HAZ GrabaFic2; |FINSI;
  |CIERRA #2;

  |ABRE #3;
  SwFich = 3; sw = 0; |BUCLE leefic03;
  |SI sw = 1; |HAZ GrabaFic3; |FINSI;
  |CIERRA #3;

  |ABRE #4;
  SwFich = 4; sw = 0; |BUCLE leefic04;
  |SI sw = 1; |HAZ GrabaFic4; |FINSI;
  |CIERRA #4;

  |ABRE #5;
  SwFich = 5; sw = 0; |BUCLE leefic05;
  |SI sw = 1; |HAZ GrabaFic5; |FINSI;
  |CIERRA #5;

  |ABRE #6;
  SwFich = 6; sw = 0; |BUCLE leefic06;
  |SI sw = 1; |ABRE #0; |HAZ GrabaFic6; |CIERRA #0; |FINSI;
  |CIERRA #6;
|FPRC;

|| **************************************************************************
|| ***********************  ACTUALIZACION DEL DIFERIMIENTO ******************
|| **************************************************************************

|PROCESO BajaDife;
  |ABRE #7;
  #7#0 = #0#0;  #7#1 = 97;  #7#2 = #0#1;  |BORRA 140#7c; |LIBERA #7;
  |CIERRA #7;
|FPRC;

|PROCESO AltaDife;
  |SI #0#59 = "E"; |ACABA; |FINSI;

  |ABRE #7;
  #7#0  = #0#0;
  #7#1  = 97;
  #7#2  = #0#1;
  #7#3  = #0#24;
  #7#4  = #0#26;
  #7#5  = #0#29;
  Porce = #0#29 / #0#24;
  |SI Porce > 1; Porce = 1; |FINSI;
  #7#6 = Porce * #0#26;
  |SI #0#60 = "P";
      #7#7 = #0#61;
      #7#8 = (#7#6 * #0#61) / 100;
  |SINO;
      VAlfa = #0#61;
      VAlfa = ("00" + VAlfa) % -102;
      #7#7 = "1/" +  VAlfa;
      #7#8 = #7#6 / #0#61;
  |FINSI;
  |GRABA 140#7n;
  |LIBERA #7;

  |CIERRA #7;
|FPRC;
|| **************************************************************************
|| ***********************  ACTUALIZACION DEL PATRIMONIO ********************
|| **************************************************************************

|PROCESO baja_pat;
  patr_00 = #0#0;
  patr_01 = #0#53;
  patr_02 = #0#54;
  |HAZ borra_pat;
  patr_00 = #0#0;
  patr_01 = #0#56;
  patr_02 = #0#57;
  |HAZ borra_pat;
|FPRC;

|PROCESO alta_pat;
  |SI #0#37 = "X"; |O #0#37 = "R"; |ACABA; |FINSI;

  || TITULAR

  |SI #0#44 = "N";
      patr_09 = #0#9;
      |SI patr_09 < #0#10;  patr_09 = #0#10; |FINSI;
      |SI patr_09 < #0#11;  patr_09 = #0#11; |FINSI;
  |SINO;
      |SI #0#12 ! "01.01.1900";              || PORQUE???????????????????????
          patr_09 = #0#9;
          |SI patr_09 < #0#10;  patr_09 = #0#10; |FINSI;
          |SI patr_09 < #0#11;  patr_09 = #0#11; |FINSI;
      |FINSI;
      patr_09 = 0;   || no hay patrimonio en venta 04.06.1997
  |FINSI;

  |SI patr_09 = 0; |ACABA; |FINSI;


  |SI #0#4 ! "T";  |Y #0#4 ! "C";  |Y #0#4 ! "G";
      #0#55 = 0;
  |FINSI;

  patr_09 = (patr_09 * ((100 - #0#55) / 100)) ! 0;

  tpro_p = "P";

  |SI #0#51 = "N";
      patr_01 = "C2";
  |SINO;
      patr_01 = "C3";
  |FINSI;

  patr_00 = #0#0;
  patr_03 = #0#4;
  patr_04 = #0#5;
  patr_05 = #0#48;
  patr_07 = #0#46;
  patr_08 = #0#47;
  patr_16 = #0#49;
  patr_17 = #0#50;
  patr_18 = #0#52;

  |SI #0#4 = "G";
      patr_03 = "T";
      patr_04 = "TITULAR";
  |FINSI;

  |HAZ graba_pat;


  || CONYUGE

  #0#53 = patr_01;
  #0#54 = patr_02;

  |SI #0#55 = 0;  |ACABA;  |FINSI;

  |SI #0#44 = "N";
      patr_09 = #0#9;
      |SI patr_09 < #0#10;  patr_09 = #0#10; |FINSI;
      |SI patr_09 < #0#11;  patr_09 = #0#11; |FINSI;
  |SINO;
      |SI #0#12 ! "01.01.1900";  || PORQUE ??????????????????????????????????
          patr_09 = #0#9;
          |SI patr_09 < #0#10;  patr_09 = #0#10; |FINSI;
          |SI patr_09 < #0#11;  patr_09 = #0#11; |FINSI;
      |FINSI;
      patr_09 = 0;   || no hay patrimonio en venta 04.06.1997
  |FINSI;

  |SI patr_09 = 0; |ACABA; |FINSI;

  patr_09 = (patr_09 * (#0#55 / 100)) ! 0;

  tpro_p = "P";

  |SI #0#8 = "I";
      |SI #0#52 = "U";
          patr_01 = "A1";
      |SINO;
          patr_01 = "B1";
      |FINSI;
  |SINO;
      patr_01 = "C3";
  |FINSI;

  patr_00 = #0#0;
  patr_03 = #0#4;
  patr_04 = #0#5;
  patr_05 = #0#48;
  patr_07 = #0#46;
  patr_08 = #0#47;
  patr_15 = "P";
  patr_16 = #0#49;
  patr_17 = #0#50;
  patr_18 = #0#52;

  |SI #0#4 = "G";  |O #0#4 = "T";
      patr_03 = "C";
      patr_04 = "CONYUGE";
  |SINO;
      patr_03 = "T";
      patr_04 = "TITULAR";
  |FINSI;

  |HAZ graba_pat;

  #0#56 = patr_01;
  #0#57 = patr_02;
|FPRC;
