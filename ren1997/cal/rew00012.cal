|FICHEROS;
     retotren #5;
     reproedi #21;
     reprofco #22;
     reactafe #23;
     rew00001 #99;
     rew00012 #603;
|FIN;

|VARIABLES;
      XCampos     = 0;
      NSecuencial = "";
      Field       = "";
      Casilla     = 0;
      Perce       = "";
      PerceC      = "";
      Descri      = "";
      Conta       = 0;
      Conta1      = 0;
      Conta2      = 0;
      Coefi       = 0;
      Resto       = 0;
      ContaAct1   = 0;
      ContaAct    = 0;

      Total1      = 0;
      Total2      = 0;
      Total3      = 0;
      Total4      = 0;
      Total5      = 0;
      Total6      = 0;
      Total7      = 0;
      Total8      = 0;
      Total9      = 0;
      Total10     = 0;
      Total11     = 0;
      Total12     = 0;
      Total13     = 0;
      Total14     = 0;
      Total15     = 0;

     &VEmpresa   = 0;
     &VTipo      = "";
     &NCopia     = 0;
     &VSwCarga   = 0;
     &VTemporal0 = "";
     &VTemporal3 = "";
     &Tippar     = 0;
     &Parte1     = 0;
     &Parte2     = 0;
     &Muerto     = "";
     &Fecpar     = @;

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_utilid;

|| ********************************************
|| RENTAS NORMALES
|| ********************************************


|| ********************** Profesionales Directa ***********************

|PROCESO CargaD1;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 2) + 0.49) ! 0) - 1;
  Resto     = (Conta + 2) $ 2;

  |SI Resto = 0; Casilla = 22;   |FINSI;
  |SI Resto = 1; Casilla = 5;   |FINSI;

  #603#0 = ContaAct1;
  |LIBERA #603;
  |LEE 140#603=;
  |SI FSalida ! 0;
      |DDEFECTO #603;
      #603#0 = ContaAct1;
      |GRABA 140#603b;
  |FINSI;

                          #603Casilla = #21#14;
  Casilla = Casilla + 1;  #603Casilla = Perce;
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#16 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#19 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#18 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#20 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#21 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#22 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#23 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#24 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#25 % Coefi);
  Casilla = Casilla + 3;  #603Casilla = #603Casilla + (#21#33 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#34 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#27 % Coefi);
  Casilla = Casilla + 1;  #603Casilla = #603Casilla + (#21#28 % Coefi);
  |GRABA 140#603a;
|FPRC;

|| *********************************
|| RENTAS NORMALES
|| *********************************

|PROCESO ProfDirectaN;
  |SI #21#4 = "X"; |O #21#4 = "P"; |ACABA; |FINSI;
  |SI #21#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #21#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #21#2 = "V";
          Coefi = #21#7 + #21#8 + #21#9 + #21#10 + #21#11 + #21#12;

          |HAZ CargaD1;
          |ACABA;
      |FINSI;
      Coefi = 100;  |HAZ CargaD1;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #21#2 = "G"; Coefi = 50;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "T"; Coefi = 100;   |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#7; |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #21#2 = "G"; Coefi = 50;     |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "C"; Coefi = 100;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#8;  |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #21#2 = "1"; Coefi = 100;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#9;  |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #21#2 = "2"; Coefi = 100;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#10; |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #21#2 = "3"; Coefi = 100;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#11; |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #21#2 = "4"; Coefi = 100;    |HAZ CargaD1; |ACABA; |FINSI;
     |SI #21#2 = "V"; Coefi = #21#12; |HAZ CargaD1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|| *************************************
|| RENTAS PARTIDAS
|| *************************************

|PROCESO ProfDirectaP;
  |SI #21#4 = "X"; |O #21#4 = "P"; |ACABA; |FINSI;
  |SI #21#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #21#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #21#2 = "V";
          |SI Tippar = 1;
              |SI #21#35 = 0;  Coefi = (#21#7 + #21#8) * Parte2; |FINSI;
              |SI #21#35 = 1;  |ACABA;                           |FINSI;
              |SI #21#35 = 2;  Coefi = #21#7 + #21#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2;
              |SI #21#35 = 0; Coefi = (#21#7 + #21#8) * Parte1;  |FINSI;
              |SI #21#35 = 1; Coefi = #21#7 + #21#8;             |FINSI;
              |SI #21#35 = 2; |ACABA;                          |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #21#35 = 0;  Coefi = (#21#7 + #21#8) * Parte1; |FINSI;
              |SI #21#35 = 2;  |ACABA;                         |FINSI;
              |SI #21#35 = 1;  Coefi = #21#7 + #21#8;            |FINSI;
          |FINSI;

          |HAZ CargaD1;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #21#35 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #21#35 = 1;  |ACABA;               |FINSI;
              |SI #21#35 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #21#2 = "G";
              |SI Tippar = 2;
                  |SI #21#35 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #21#35 = 1;  Coefi = 100;          |FINSI;
                  |SI #21#35 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #21#35 = 0;
                      |SI #21#2 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                          |SI #21#2 = "C"; |Y Muerto = "C";
                              Coefi = 100;
                          |SINO;
                              Coefi = 100 * Parte1;
                          |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #21#35 = 1;  Coefi = 100;          |FINSI;
                  |SI #21#35 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #21#35 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #21#35 = 1;  Coefi = 100;          |FINSI;
              |SI #21#35 = 2;  |ACABA;               |FINSI;
          |FINSI;

          |HAZ CargaD1;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #21#2 = "G";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = 50;          |FINSI;
             |SI #21#35 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #21#35 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #21#35 = 1; Coefi = 50;          |FINSI;
                 |SI #21#35 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #21#35 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #21#35 = 1; |ACABA;                      |FINSI;
                 |SI #21#35 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;              |FINSI;
             |SI #21#35 = 2; Coefi = 50;          |FINSI;
         |FINSI;

         |HAZ CargaD1; |ACABA;
     |FINSI;

     |SI #21#2 = "T";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = 100;          |FINSI;
             |SI #21#35 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #21#35 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #21#35 = 1; |ACABA;               |FINSI;
                 |SI #21#35 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;               |FINSI;
             |SI #21#35 = 2; Coefi = 100;          |FINSI;
         |FINSI;

         |HAZ CargaD1; |ACABA;
     |FINSI;

     |SI #21#2 = "V";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = #21#7 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = #21#7;          |FINSI;
             |SI #21#35 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #21#7;             |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = #21#7 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;        |FINSI;
             |SI #21#35 = 2; Coefi = #21#7;          |FINSI;
         |FINSI;

         |HAZ CargaD1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #21#2 = "G";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = 50;          |FINSI;
             |SI #21#35 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #21#35 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #21#35 = 1; |ACABA;              |FINSI;
                 |SI #21#35 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #21#35 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #21#35 = 1; Coefi = 50;                  |FINSI;
                 |SI #21#35 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;              |FINSI;
             |SI #21#35 = 2; Coefi = 50;          |FINSI;
         |FINSI;

         |HAZ CargaD1; |ACABA;
     |FINSI;

     |SI #21#2 = "C";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = 100;          |FINSI;
             |SI #21#35 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #21#35 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #21#35 = 1; |ACABA;               |FINSI;
                 |SI #21#35 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;               |FINSI;
             |SI #21#35 = 2; Coefi = 100;          |FINSI;
         |FINSI;

         |HAZ CargaD1; |ACABA;
     |FINSI;

     |SI #21#2 = "V";
         |SI Tippar = 1;
             |SI #21#35 = 0; Coefi = #21#8 * Parte1; |FINSI;
             |SI #21#35 = 1; Coefi = #21#8;          |FINSI;
             |SI #21#35 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #21#8;             |FINSI;
         |SI Tippar = 3;
             |SI #21#35 = 0; Coefi = #21#8 * Parte2; |FINSI;
             |SI #21#35 = 1; |ACABA;        |FINSI;
             |SI #21#35 = 2; Coefi = #21#8;          |FINSI;
         |FINSI;
         |HAZ CargaD1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO ProfDirecta;
  |SI VSwCarga = 0;  |HAZ ProfDirectaN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ ProfDirectaP;  |FINSI;
|FPRC;

|DEFBUCLE reproedi;
  #21#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, ProfDirecta;
|FIN;

|| ********************** Profesionales Coeficientes ***********************

|PROCESO CargaD2;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 2) + 0.49) ! 0) - 1;
  Resto     = (Conta + 2) $ 2;

  |SI Resto = 0; Casilla = 65;  |FINSI;
  |SI Resto = 1; Casilla = 44;  |FINSI;

  #603#0 = ContaAct1;
  |LIBERA #603;
  |LEE 140#603=;
  |SI FSalida ! 0;
      |DDEFECTO #603;
      #603#0 = ContaAct1;
      |GRABA 140#603b;
  |FINSI;

                           #603Casilla = #22#14;
  Casilla = Casilla + 1;   #603Casilla = Perce;
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#17 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#18 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + ((#22#38 + #22#39 - #22#37) % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#19 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#20 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#21 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#22 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#23 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#24 % Coefi);
  Casilla = Casilla + 3;   #603Casilla = #603Casilla + (#22#25 % Coefi);
  Casilla = Casilla + 2;   #603Casilla = #603Casilla + (#22#28 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#29 % Coefi);
  Casilla = Casilla + 2;   #603Casilla = #603Casilla + (#22#26 % Coefi);
  Casilla = Casilla + 1;   #603Casilla = #603Casilla + (#22#27 % Coefi);

  |GRABA 140#603a;
|FPRC;

||********************************************
|| RENTAS NORMALES
||********************************************

|PROCESO ProfCoefiN;
  |SI #22#4 = "X"; |O #22#4 = "P"; |ACABA; |FINSI;
  |SI #22#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #22#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #22#2 = "V";
          Coefi = #22#7 + #22#8 + #22#9 + #22#10 + #22#11 + #22#12;
          |HAZ CargaD2;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaD2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #22#2 = "G"; Coefi = 50;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "T"; Coefi = 100;   |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#7; |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #22#2 = "G"; Coefi = 50;     |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "C"; Coefi = 100;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#8;  |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #22#2 = "1"; Coefi = 100;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#9;  |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #22#2 = "2"; Coefi = 100;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#10; |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #22#2 = "3"; Coefi = 100;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#11; |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #22#2 = "4"; Coefi = 100;    |HAZ CargaD2;  |ACABA; |FINSI;
     |SI #22#2 = "V"; Coefi = #22#12; |HAZ CargaD2;  |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO ProfCoefiP;
  |SI #22#4 = "X"; |O #22#4 = "P"; |ACABA; |FINSI;
  |SI #22#5 = "N"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #22#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #22#2 = "V";
          |SI Tippar = 1;
              |SI #22#42 = 0;  Coefi = (#22#7 + #22#8) * Parte2; |FINSI;
              |SI #22#42 = 1;  |ACABA;                         |FINSI;
              |SI #22#42 = 2;  Coefi = #22#7 + #22#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2;
              |SI #22#42 = 0;  Coefi = (#22#7 + #22#8) * Parte1; |FINSI;
              |SI #22#42 = 1;  Coefi = #22#7 + #22#8;            |FINSI;
              |SI #22#42 = 2;  |ACABA;                         |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #22#42 = 0;  Coefi = (#22#7 + #22#8) * Parte1; |FINSI;
              |SI #22#42 = 2;  |ACABA;                         |FINSI;
              |SI #22#42 = 1;  Coefi = #22#7 + #22#8;            |FINSI;
          |FINSI;
          |HAZ CargaD2;

          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #22#42 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #22#42 = 1;  |ACABA;               |FINSI;
              |SI #22#42 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #22#2 = "G";
              |SI Tippar = 2;
                   |SI #22#42 = 0;  Coefi = 100 * Parte1; |FINSI;
                   |SI #22#42 = 1;  Coefi = 100;          |FINSI;
                   |SI #22#42 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                   |SI #22#42 = 0;
                       |SI #22#2 = "T"; |Y Muerto = "T";
                           Coefi = 100;
                       |SINO;
                           |SI #22#2 = "C"; |Y Muerto = "C";
                               Coefi = 100;
                           |SINO;
                               Coefi = 100 * Parte1;
                           |FINSI;
                       |FINSI;
                   |FINSI;
                   |SI #22#42 = 1;  Coefi = 100;          |FINSI;
                   |SI #22#42 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #22#42 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #22#42 = 2;  |ACABA;               |FINSI;
              |SI #22#42 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaD2;

          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #22#2 = "G";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = 50;          |FINSI;
             |SI #22#42 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #22#42 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #22#42 = 1; Coefi = 50;          |FINSI;
                 |SI #22#42 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #22#42 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #22#42 = 1; |ACABA;                      |FINSI;
                 |SI #22#42 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;              |FINSI;
             |SI #22#42 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;

     |SI #22#2 = "T";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = 100;          |FINSI;
             |SI #22#42 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #22#42 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #22#42 = 1; |ACABA;               |FINSI;
                 |SI #22#42 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;               |FINSI;
             |SI #22#42 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;

     |SI #22#2 = "V";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = #22#7 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = #22#7;          |FINSI;
             |SI #22#42 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #22#7;             |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = #22#7 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;        |FINSI;
             |SI #22#42 = 2; Coefi = #22#7;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #22#2 = "G";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = 50;          |FINSI;
             |SI #22#42 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #22#42 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #22#42 = 1; |ACABA;              |FINSI;
                 |SI #22#42 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #22#42 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #22#42 = 1; Coefi = 50;                  |FINSI;
                 |SI #22#42 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;              |FINSI;
             |SI #22#42 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;

     |SI #22#2 = "C";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = 100;          |FINSI;
             |SI #22#42 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #22#42 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #22#42 = 1; |ACABA;               |FINSI;
                 |SI #22#42 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;               |FINSI;
             |SI #22#42 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;

     |SI #22#2 = "V";
         |SI Tippar = 1;
             |SI #22#42 = 0; Coefi = #22#8 * Parte1; |FINSI;
             |SI #22#42 = 1; Coefi = #22#8;          |FINSI;
             |SI #22#42 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #22#8;             |FINSI;
         |SI Tippar = 3;
             |SI #22#42 = 0; Coefi = #22#8 * Parte2; |FINSI;
             |SI #22#42 = 1; |ACABA;        |FINSI;
             |SI #22#42 = 2; Coefi = #22#8;          |FINSI;
         |FINSI;
         |HAZ CargaD2;
          |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO ProfCoefi;
  |SI VSwCarga = 0;  |HAZ ProfCoefiN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ ProfCoefiP;  |FINSI;
|FPRC;

|DEFBUCLE reprofco;
  #22#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, ProfCoefi;
|FIN;

|| ********************** Activos Fijos Profesionales **********************

|PROCESO CargaD3;
  #603#0 = 0;
  |LIBERA #603;
  |LEE 140#603=;
  |SI FSalida ! 0;
      |DDEFECTO #603;
      #603#0 = 0;
      |GRABA 140#603b;
  |FINSI;

  Conta = Conta + 1;
  |SI Conta [ 5;
      Casilla = Casilla + 1;  #603Casilla = #23#7;
      Casilla = Casilla + 1;  #603Casilla = #23#24;
      Casilla = Casilla + 1;  #603Casilla = #23#26;
      Casilla = Casilla + 1;  #603Casilla = #23#29;
      Casilla = Casilla + 1;  #603Casilla = #23#34;
      |SI #23#59 = "D";
          Casilla = Casilla + 1; #603Casilla = "X";
          Casilla = Casilla + 1; #603Casilla = " ";
      |SINO;
          Casilla = Casilla + 1; #603Casilla = " ";
          Casilla = Casilla + 1; #603Casilla = "X";
      |FINSI;
  |SINO;
      #603#124  = "RESTANTES";
      #603#125  = #603#125 + #23#24;
      #603#126  = #603#126 + #23#26;
      #603#127  = #603#127 + #23#29;
      #603#128  = #603#128 + #23#34;
      #603#129  = "";
      #603#130  = "";
  |FINSI;

  |GRABA 140#603a;
|FPRC;

|PROCESO AfectosN;
  |SI #23#29 = 0; |ACABA; |FINSI;
  |SI #23#37 = "X"; |O #23#37 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A";
      |SI #23#4 = "V";
          Coefi = #23#38 + #23#39 + #23#40 + #23#41 + #23#42 + #23#43;
          |HAZ CargaD3;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaD3;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #23#4 = "G"; Coefi = 50;     |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "T"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#38; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #23#4 = "G"; Coefi = 50;     |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "C"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#39; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #23#4 = "1"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#40; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #23#4 = "2"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#41; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #23#4 = "3"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#42; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #23#4 = "4"; Coefi = 100;    |HAZ CargaD3; |ACABA; |FINSI;
     |SI #23#4 = "V"; Coefi = #23#43; |HAZ CargaD3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO AfectosP;
  |SI #23#37 = "X"; |O #23#37 = "P"; |ACABA; |FINSI;
  |SI #23#29 = 0;                    |ACABA; |FINSI;

  |SI #99#1 = "A";
      |SI #23#4 = "V";
          |SI Tippar = 1;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte2; |FINSI;
              |SI #23#45 = 1;  |ACABA;                         |FINSI;
              |SI #23#45 = 2;  Coefi = #23#38 + #23#39;            |FINSI;
          |FINSI;
          |SI Tippar = 2;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte1; |FINSI;
              |SI #23#45 = 1;  Coefi = #23#38 + #23#39;            |FINSI;
              |SI #23#45 = 2;  |ACABA;                         |FINSI;
         |FINSI;
          |SI Tippar = 3;
              |SI #23#45 = 0;  Coefi = (#23#38 + #23#39) * Parte1; |FINSI;
              |SI #23#45 = 2;  |ACABA;                         |FINSI;
              |SI #23#45 = 1;  Coefi = #23#38 + #23#39;            |FINSI;
          |FINSI;
          |HAZ CargaD3;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #23#45 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #23#45 = 1;  |ACABA;               |FINSI;
              |SI #23#45 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #23#4 = "G";
              |SI Tippar = 2;
                  |SI #23#45 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #23#45 = 1;  Coefi = 100;          |FINSI;
                  |SI #23#45 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #23#45 = 0;
                      |SI #23#4 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                          |SI #23#4 = "C"; |Y Muerto = "C";
                              Coefi = 100;
                          |SINO;
                              Coefi = 100 * Parte1;
                          |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #23#45 = 1;  Coefi = 100;          |FINSI;
                  |SI #23#45 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #23#45 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #23#45 = 2;  |ACABA;               |FINSI;
              |SI #23#45 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaD3;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #23#4 = "G";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 50;          |FINSI;
             |SI #23#45 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #23#45 = 1; Coefi = 50;          |FINSI;
                 |SI #23#45 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #23#45 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #23#45 = 1; |ACABA;                      |FINSI;
                 |SI #23#45 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;              |FINSI;
             |SI #23#45 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;

     |SI #23#4 = "T";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 100;          |FINSI;
             |SI #23#45 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #23#45 = 1; |ACABA;               |FINSI;
                 |SI #23#45 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;               |FINSI;
             |SI #23#45 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;

     |SI #23#4 = "V";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = #23#38 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = #23#38;          |FINSI;
             |SI #23#45 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #23#38;             |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = #23#38 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;        |FINSI;
             |SI #23#45 = 2; Coefi = #23#38;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #23#4 = "G";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 50;          |FINSI;
             |SI #23#45 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #23#45 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #23#45 = 1; |ACABA;              |FINSI;
                 |SI #23#45 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #23#45 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #23#45 = 1; Coefi = 50;                  |FINSI;
                 |SI #23#45 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;              |FINSI;
             |SI #23#45 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;

     |SI #23#4 = "C";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = 100;          |FINSI;
             |SI #23#45 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             |SI #5#213 = 1;
                 |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
                 |SI #23#45 = 1; |ACABA;               |FINSI;
                 |SI #23#45 = 2; Coefi = 100;          |FINSI;
             |FINSI;
             |SI #5#213 = 2; Coefi = 100; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;               |FINSI;
             |SI #23#45 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;

     |SI #23#4 = "V";
         |SI Tippar = 1;
             |SI #23#45 = 0; Coefi = #23#39 * Parte1; |FINSI;
             |SI #23#45 = 1; Coefi = #23#39;          |FINSI;
             |SI #23#45 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #23#39;             |FINSI;
         |SI Tippar = 3;
             |SI #23#45 = 0; Coefi = #23#39 * Parte2; |FINSI;
             |SI #23#45 = 1; |ACABA;        |FINSI;
             |SI #23#45 = 2; Coefi = #23#39;          |FINSI;
         |FINSI;
         |HAZ CargaD3;
         |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO Afectos;
  |SI VSwCarga = 0;  |HAZ AfectosN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ AfectosP;  |FINSI;
|FPRC;

|DEFBUCLE reactafe;
  #23#1;
  2;
  #99#0, 01, "PC";
  #99#0, 99, "PD";
  e;
  NULL, Afectos;
|FIN;

|| ********************************************
|| RENTAS PARTIDAS
|| ********************************************


|| ***************************************************
|| REPARTO
|| ***************************************************

|PROCESO Totales603;
  #603#4   = ContaAct;
  #603#16  = #603#08 + #603#09 + #603#10 + #603#11 + #603#12 + #603#13 + #603#14 + #603#15;
  #603#33  = #603#25 + #603#26 + #603#27 + #603#28 + #603#29 + #603#30 + #603#31 + #603#32;

  #603#17  = #603#7  - #603#16;
  #603#34  = #603#24 - #603#33;

  #603#20  = #603#18 - #603#19;
  #603#37  = #603#35 - #603#36;

  #603#21  = #603#17 + #603#20;
  #603#38  = #603#34 + #603#37;

  #603#55  = #603#47 + #603#48 + #603#49 + #603#50 + #603#51 + #603#52 + #603#53 + #603#54;
  #603#76  = #603#68 + #603#69 + #603#70 + #603#71 + #603#72 + #603#73 + #603#74 + #603#75;

  #603#56  = #603#46 - #603#55;
  #603#77  = #603#67 - #603#76;

  #603#58  = #603#46 - #603#55 - #603#57;
  #603#79  = #603#67 - #603#76 - #603#78;

  #603#61  = #603#58 - #603#59 - #603#60;
  #603#82  = #603#79 - #603#80 - #603#81;

  #603#64  = #603#61 + #603#62 - #603#63;
  #603#85  = #603#82 + #603#83 - #603#84;

  #603#132 = #99#7;
  #603#133 = #99#3;

  |GRABA 140#603a;
  |LIBERA #603;

  Total1   = #5#14;
  Total2   = Total2 + (#603#16 + #603#33);
  Total3   = Total3 + (#603#17 + #603#34);
  Total4   = Total4 + (#603#20 + #603#37);
  Total5   = #5#15;

  Total6   = #5#16;
  Total7   = Total7  + (#603#55 + #603#76);
  Total8   = Total8  + (#603#57 + #603#78);
  Total9   = Total9  + (#603#58 + #603#79);
  Total10  = Total10 + (#603#59 + #603#80);
  Total11  = Total11 + (#603#60 + #603#81);
  Total12  = Total12 + (#603#61 + #603#82);
  Total13  = Total13 + (#603#62 + #603#83);
  Total14  = Total14 + (#603#63 + #603#84);
  Total15  = #5#17;
|FPRC;

|DEFBUCLE rew00012T;
  #603#1;
  ;
  00;
  99;
  be;
  NULL, Totales603;
|FIN;

|PROCESO LeeFicheros;
  |ABRE #99;
  #99#0 = VEmpresa;
  #99#1 = VTipo;
  |LEE 040#99=;
  |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
  |CIERRA #99;

  |ABRE #5;
  #5#0   = #99#0;
  #5#141 = #99#1;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;
|FPRC;

|PROCESO CargaHoja3;
  |HAZ LeeFicheros;

  ContaAct = 0;
  Conta    = 0;
  Conta1   = 0;
  |BUCLE reproedi;
  |SI Conta  > 2;  Conta1 = Conta;  |FINSI;
  |SI Conta1 = 2;  #603#0 = 1;  |BORRA 140#603c;  |LIBERA #603; |FINSI;

  Conta  = 0;
  Conta2 = 0;
  |BUCLE reprofco;
  |SI Conta > 2;  Conta2 = Conta;  |FINSI;
  |SI Conta1 [ 2; |Y Conta2 [ 2; #603#0 = 1;  |BORRA 140#603c;  |LIBERA #603; |FINSI;

  Conta   = 0;
  Casilla = 95;
  |BUCLE reactafe;

  ContaAct  = Conta1;
  |SI ContaAct < Conta2;  ContaAct = Conta2;  |FINSI;

  |SI ContaAct > 2;
      ContaAct = (((ContaAct / 2) + 0.49) ! 0) - 1;
  |SINO;
      #603#0 = 1;  |BORRA 140#603c;
  |FINSI;

  Total1  = 0;  Total2  = 0;  Total3  = 0;  Total4  = 0;  Total5  = 0;
  Total6  = 0;  Total7  = 0;  Total8  = 0;  Total9  = 0;  Total10 = 0;
  Total11 = 0;  Total12 = 0;  Total13 = 0;  Total14 = 0;  Total15 = 0;
  |BUCLE rew00012T;

  |ABRE #603;
  #603#0 = 0;
  |LIBERA #603;
  |LEE 140#603=;
  |SI FSalida = 0;
      #603#39 = Total1;   #603#40 = Total2;   #603#41 = Total3;
      #603#42 = Total4;   #603#43 = Total5;   #603#86 = Total6;
      #603#87 = Total7;   #603#88 = Total8;   #603#89 = Total9;
      #603#90 = Total10;  #603#91 = Total11;  #603#92 = Total12;
      #603#93 = Total13;  #603#94 = Total14;  #603#95 = Total15;

     |GRABA 140#603a;
  |FINSI;
  |CIERRA #603;
|FPRC;

|| ********************************************
|| GRABA SECUENCIAL
|| ********************************************

|PROCESO GrabaTexto603;
  |HAZ BorraCampos;

  ICampos = Campos1 <-;
  |PARA XCampos = 1;  |SI XCampos [ 131;  |HACIENDO XCampos = XCampos + 1;
        Campos  = #603XCampos;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos1  <-;                                    Campos = "100";
  ICampos = Campos2  <-;                                    Campos = "03";
  ICampos = Campos3  <-; |SI #603#0 ! 0;  Campos = "C";   |FINSI;
  ICampos = Campos131<-; Valfa = &13 + &10;                 Campos = Valfa;

  ICampos = Campos7 <-;
  |PARA XCampos = 7;  |SI XCampos [ 21;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos24 <-;
  |PARA XCampos = 24;  |SI XCampos [ 43;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos46 <-;
  |PARA XCampos = 46;  |SI XCampos [ 64;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos67 <-;
  |PARA XCampos = 67;  |SI XCampos [ 95;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos97 <-;
  |PARA XCampos = 97;  |SI XCampos [ 100;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos104 <-;
  |PARA XCampos = 104;  |SI XCampos [ 107;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos111 <-;
  |PARA XCampos = 111;  |SI XCampos [ 114;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos118 <-;
  |PARA XCampos = 118;  |SI XCampos [ 121;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos125 <-;
  |PARA XCampos = 125;  |SI XCampos [ 128;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;

  Pos = -1;
  NSecuencial = "r+b " + NEmpresas;
  |FABRE NSecuencial;
  |SI FSalida < 0;
      NSecuencial = "wb  " + NEmpresas;
      |FABRE NSecuencial;
  |FINSI;

  Handle = FSalida;
  |SI FSalida ] 0;
      |PARA; |SI; |HACIENDO;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
      |SIGUE;
  |FINSI;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 131; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
  |FCIERRA Handle;
|FPRC;

|DEFBUCLE rew00012G;
  #603#1;
  ;
  00;
  99;
  be;
  NULL, GrabaTexto603;
|FIN;

|| ********************************************
|| PROGRAMAS
|| ********************************************

|PROGRAMA;
  |NOME_DAT #99  VTemporal0;
  |NOME_DAT #603 VTemporal3;

  |SI VSwCarga = 0;  |O VSwCarga = 1;
      |ABRE #603;  |CIERRA #603;  |DELINDEX #603;
      |ABRE #603;
      |HAZ CargaHoja3;
      |CIERRA #603;
  |FINSI;

  |SI VSwCarga = 100;
       |BUCLE rew00012G;
  |FINSI;
|FPRO;
