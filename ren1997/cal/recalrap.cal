|FICHEROS;
   recalrap #0;
   retabla2 #1;
   retabla1 #2;
   reparame #3;
|FIN;

|VARIABLES;
   irregu   = 0;
   pepe     = 0;
   total    = 0;
   sw       = 0;
   y        = 0;
   x        = 0;
   base1    = "";
   cuota1   = "";
   porce1   = "";
   base2    = "";
   cuota2   = "";
   porce2   = "";
   n_base1  = 0;
   n_base2  = 0;
   n_cuot1  = 0;
   n_cuot2  = 0;
   n_porc1  = 0;
   n_porc2  = 0;
   basecon  = 0;
   cuotaco  = 0;
   porceco  = 0;
   baseind  = 0;
   cuotain  = 0;
   porcein  = 0.00;
   traba = 0;
|FIN;

|INCLUYE i_pausit;

|PROGRAMA;
|CLS;
|CABEZA "Calculo Rapido";
|DDEFECTO #0;
|PINPA #0#0;
|PINDA #0#0;
|HAZ cargatabla;
|HAZ parametro;
|ENDATOS #1#0;
|HAZ descarga;
|FPRO;

|PROCESO parametro;
|ABRE #3;
|LEE 040#3p;
|SI FSalida = 0;
   |SI #3#2 = "C"; |O #3#2 = "I";
       #0#140 = #3#2;
   |FINSI;
|FINSI;
|CIERRA #3;
|FPRC;

|PROCESO totales; |TIPO 0;
#0#5   = #0#1 + #0#2 + #0#4 - #0#3;
#0#8   = #0#6 - #0#7;
#0#13  = #0#10 + #0#11 - #0#12;
#0#15  = #0#14;
#0#17  = #0#16;
#0#19  = #0#18;
#0#21  = #0#20;
#0#27  = #0#5 + #0#8 + #0#9 + #0#13 + #0#15 + #0#17;
#0#27  = #0#27 + #0#19 + #0#21 + #0#22 + #0#23 + #0#24 + #0#26 + #0#143 - #0#25;
#0#30  = #0#27 - #0#28 - #0#29;
#0#32  = #0#30 - #0#31;
|SI #0#140 = "C"; |HAZ leeconj; |FINSI;   || Lee Tarifa Conjunta
|SI #0#140 = "I"; |HAZ leeindi; |FINSI;   || Lee Tarifa Individual
#0#36 = #0#34 % #0#35;
#0#38 = #0#36 + #0#49;
#0#37 = (#0#38 * 100) / #0#32;
#0#52  = #0#50 + #0#51;
#0#54  = #0#52 - #0#53;
#0#55  = #0#37;
#0#56 = #0#54 / 2;
|SI #0#140 = "C"; |HAZ cuotcon; |FINSI;   || Lee Tarifa Conjunta
|SI #0#140 = "I"; |HAZ cuotind; |FINSI;   || Lee Tarifa Individual
#0#60 = #0#58 % #0#59;
total = #0#68 + #0#60;
#0#62 = (total * 100) / #0#56;

pepe  = #0#55;
|SI #0#62 > pepe; pepe = #0#62; |FINSI;
#0#61 = #0#54 % pepe;
#0#63  = #0#61 + #0#38;

|HAZ reduintr;                || Calcula la Reduccion de la Cuota Integra
#0#67  = #0#63 - #0#66;
#0#142 = #0#67 - #0#141;

#0#81  = #0#142 - #0#80;


|HAZ ajusintr;                || Calcula Ajusta Cuota Integra
#0#83  = #0#81 - #0#82;
#0#85  = #0#83 - #0#84;
|HAZ deduccion;               || Calcula las deducciones por hijos hasta invidentes
#0#109 = 0;
|PARA x = 86; |SI x [ 108; |HACIENDO x = x + 1;
     #0#109 = #0#109 + #0x;
|SIGUE;
#0#121 = #0#85 - #0#109;
#0#125 = #0#121 - #0#122 - #0#123 - #0#124;
#0#138 = 0;
|PARA x = 130; |SI x [ 137; |HACIENDO x = x + 1;
     #0#138 = #0#138 + #0x;
|SIGUE;
#0#139 = #0#125 - #0#138;
|FPRC;

|PROCESO leeconj;
sw = 0;
#0#33 = 0;
#0#35 = 0;
#0#34 = 0;
#0#49 = 0;
|PARA x = 16; |SI x ] 1; |HACIENDO x = x - 1;
    |DEL_BUF basecon,x,base1;
    |DEL_BUF cuotaco,x,cuota1;
    |DEL_BUF porceco,x,porce1;
    n_base1 = base1;
    n_porc1 = porce1;
    n_cuot1 = cuota1;
    |SI n_base1 [ #0#32; |Y sw = 0;
        sw = 1;
        #0#33 = n_base1;
        #0#34 = #0#32 - #0#33;
        #0#35 = n_porc1;
        #0#49 = n_cuot1;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO leeindi;
sw = 0;
#0#33 = 0;
#0#34 = 0;
#0#35 = 0;
#0#49 = 0;
|PARA x = 17; |SI x ] 1; |HACIENDO x = x - 1;
    |DEL_BUF baseind,x,base2;
    |DEL_BUF cuotain,x,cuota2;
    |DEL_BUF porcein,x,porce2;
    n_base2 = base2;
    n_porc2 = porce2;
    n_cuot2 = cuota2;
    |SI n_base2 [ #0#32; |Y sw = 0;
        sw = 1;
        #0#33 = n_base2;
        #0#34 = #0#32 - #0#33;
        #0#35 = n_porc2;
        #0#49 = n_cuot2;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO cuotcon;
sw = 0;
#0#57 = 0;
#0#58 = 0;
#0#59 = 0;
#0#68 = 0;
|PARA x = 16; |SI x ] 1; |HACIENDO x = x - 1;
    |DEL_BUF basecon,x,base1;
    |DEL_BUF cuotaco,x,cuota1;
    |DEL_BUF porceco,x,porce1;
    n_base1 = base1;
    n_porc1 = porce1;
    n_cuot1 = cuota1;
    irregu  = #0#56;
    |SI n_base1 [ irregu; |Y sw = 0;
        sw = 1;
        #0#57 = n_base1;
        #0#58 = irregu - #0#57;
        #0#59 = n_porc1;
        #0#68 = n_cuot1;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO cuotind;
sw = 0;
#0#57 = 0;
#0#58 = 0;
#0#59 = 0;
#0#68 = 0;
|PARA x = 17; |SI x ] 1; |HACIENDO x = x - 1;
    |DEL_BUF baseind,x,base2;
    |DEL_BUF cuotain,x,cuota2;
    |DEL_BUF porcein,x,porce2;
    n_base2 = base2;
    n_porc2 = porce2;
    n_cuot2 = cuota2;
    irregu  = #0#56;
    |SI n_base2 [ irregu; |Y sw = 0;
        sw = 1;
        #0#57 = n_base2;
        #0#58 = irregu - #0#57;
        #0#59 = n_porc2;
        #0#68 = n_cuot2;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO reduintr;
|SI #0#35 > 35;
    #0#65 = #0#35 - 35;
    #0#66 = #0#64 % #0#65;
|FINSI;

#0#141 = 0;
|SI #0#51 ! 0; |Y #0#55 > 20;
    #0#141 = ((#0#51 * #0#61) / #0#54) - (#0#51 % 20);
    |SI #0#141 < 0; #0#141 = 0; |FINSI;
|FINSI;
|FPRC;

|PROCESO ajusintr;
pepe = (#0#32 + #0#54) % 70;
#0#82 = 0;
|SI #0#142 > pepe;
    #0#82 = #0#81 - pepe;
|FINSI;
|FPRC;

|PROCESO deduccion;
  |SI Campo  = 75;
      #0#86 = 0;
      traba = #0#75;
      |SI traba [ 2;
          #0#86 = traba * 22100;
      |SINO;
          #0#86 = 2 * 22100;
          traba = traba - 2;
          |SI traba [ 1;
              #0#86 = #0#86 + (traba * 26700);
          |SINO;
              #0#86 = #0#86 + 26700;
              traba = traba - 1;
              #0#86 = #0#86 + (traba * 31800);
          |FINSI;
      |FINSI;
  |FINSI;
  #0#87 = #0#76 * 16500;
  #0#88 = #0#77 * 32900;
  #0#89 = #0#78 * 16000;
  #0#90 = #0#79 * 56000;
|FPRC;

|PROCESO pintapa1; |TIPO 0;
|PINTA #0#5;
|PINTA #0#8;
|PINTA #0#13;
|PINTA #0#15;
|PINTA #0#17;
|FPRC;

|PROCESO pintapa2; |TIPO 0;
|PINTA #0#19;
|PINTA #0#21;
|PINTA #0#27;
|FPRC;

|PROCESO pintapa3; |TIPO 0;
|PINTA #0#30;
|PINTA #0#32;
|PINTA #0#33;
|PINTA #0#34;
|PINTA #0#35;
|PINTA #0#36;
|PINTA #0#37;
|PINTA #0#38;
|PINTA #0#49;
|PINTA #0#52;
|PINTA #0#54;
|FPRC;

|PROCESO pintapa4; |TIPO 0;
|PINTA #0#55;
|PINTA #0#56;
|PINTA #0#57;
|PINTA #0#58;
|PINTA #0#59;
|PINTA #0#60;
|PINTA #0#61;
|PINTA #0#62;
|PINTA #0#63;
|PINTA #0#65;
|PINTA #0#66;
|PINTA #0#67;
|PINTA #0#141;
|PINTA #0#142;
|PINTA #0#81;
|PINTA #0#82;
|PINTA #0#83;
|PINTA #0#85;
|FPRC;

|PROCESO pintapa5; |TIPO 0;
|PINTA #0#86;
|PINTA #0#87;
|PINTA #0#88;
|PINTA #0#89;
|PINTA #0#90;
|PINTA #0#109;
|FPRC;

|PROCESO pintapa6; |TIPO 0;
|PINTA #0#121;
|PINTA #0#125;
|PINTA #0#138;
|PINTA #0#139;
|FPRC;

|PROCESO cargatabla;
|DIMENSIONA 20, basecon, 0;
|DIMENSIONA 20, cuotaco, 0;
|DIMENSIONA 20, porceco, 0;
|DIMENSIONA 20, baseind, 0;
|DIMENSIONA 20, cuotain, 0;
|DIMENSIONA 20, porcein, 0;
|ABRE #1;
|LEE 040#1p;
|SI FSalida = 0;
   |PARA x = 1; |SI x [ 16; |HACIENDO x = x + 1;
       base1 = #1x;
       |AL_BUF basecon,x,base1;
   |SIGUE;

   |PARA x = 17; |SI x [ 32; |HACIENDO x = x + 1;
       y = x - 16;
       cuota1 = #1x;
       |AL_BUF cuotaco,y,cuota1;
   |SIGUE;

   |PARA x = 33; |SI x [ 48; |HACIENDO x = x + 1;
       y = x - 32;
       porce1 = #1x;
       |AL_BUF porceco,y,porce1;
   |SIGUE;
|SINO;
   |MENAV "    No existe Tarifa Conjunta. <INSTALAR FICHEROS APLICACION.>";
|FINSI;
|CIERRA #1;

|ABRE #2;
|LEE 040#2p;
|SI FSalida = 0;
   |PARA x = 1; |SI x [ 17; |HACIENDO x = x + 1;
       base2 = #2x;
       |AL_BUF baseind,x,base2;
   |SIGUE;

   |PARA x = 18; |SI x [ 34; |HACIENDO x = x + 1;
       y = x - 17;
       cuota2 = #2x;
       |AL_BUF cuotain,y,cuota2;
   |SIGUE;

   |PARA x = 35; |SI x [ 51; |HACIENDO x = x + 1;
       y = x - 34;
       porce2 = #2x;
       |AL_BUF porcein,y,porce2;
   |SIGUE;
|SINO;
   |MENAV "    No existe Tarifa Individual. <INSTALAR FICHEROS APLICACION.>";
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO descarga;
|DDEFECTO #0;
|FINDIM basecon;
|FINDIM cuotaco;
|FINDIM porceco;
|FINDIM baseind;
|FINDIM cuotain;
|FINDIM porcein;
|FPRC;
