|FICHEROS;
     retotren #5;
     retotrea #6;
     rerendtr #20;
     rectacor #32;
     rerendir #33;
     retransp #34;
     rew00001 #99;
     rew00021 #612;
|FIN;

|VARIABLES;
      FechaN      = 0;
      XCampos     = 0;
      NSecuencial = "";
      Field       = "";
      Casilla     = 0;
      Perce       = "";
      PerceC      = "";
      Descri1     = "";
      Descri2     = "";
      Conta       = 0;
      Conta1      = 0;
      Conta2      = 0;
      Conta3      = 0;
      Conta4      = 0;
      Coefi       = 0;
      Resto       = 0;
      ContaAct1   = 0;
      ContaAct2   = 0;
      ContaAct    = 0;
      Periodo     = 0;
      Error       = 0;
      Total1      = 0;
      Total2      = 0;
      Total3      = 0;
      Total4      = 0;
      Total5      = 0;
      Total6      = 0;
      Total7      = 0;
      Total8      = 0;
      Total9      = 0;
      Total10     = 0;
      Total11     = 0;
      Total12     = 0;
      Total13     = 0;
      Total14     = 0;
      Total15     = 0;

     &Tippar      = 0;
     &Parte1      = 0;
     &Parte2      = 0;
     &Muerto      = "";
     &Fecpar      = @;
     &VEmpresa    = 0;
     &VTipo       = "";
     &NCopia      = 0;
     &VSwCarga    = 0;
     &VTemporal0  = "";
     &VTemporal12 = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_utilid;

|PROCESO Muerto;
  Error = 0;
  |SI #5#213 = 1;
      |SI Periodo = 0; Coefi = 100 * Parte2; |FINSI;
      |SI Periodo = 1; Error = 1;            |FINSI;
      |SI Periodo = 2; Coefi = 100;          |FINSI;
      |ACABA;
  |FINSI;
  Coefi = 100;
|FPRC;

|PROCESO CargaH1a;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 5;    |FINSI;
  |SI Resto = 2;  Casilla = 16;   |FINSI;
  |SI Resto = 0;  Casilla = 27;   |FINSI;

  #612#0 = ContaAct1;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida ! 0;
      |DDEFECTO #612;
      #612#0 = ContaAct1;
      |GRABA 140#612b;
  |FINSI;

                          #612Casilla = #20#4 % 112;
  Casilla = Casilla + 1;  #612Casilla = #20#4 % 1312;
  Casilla = Casilla + 1;  #612Casilla = Perce;
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#20#23 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#20#22 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#20#24 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#20#26 % Coefi);

  CantiNum = #20#25;  |HAZ Decimales;
  Valfa1   = ("00"   + ParteEntera)  % -102;
  Valfa2   = ("0000" + ParteDecimal4) % -104;

  Casilla = Casilla + 1;  #612Casilla = Valfa1;
  Casilla = Casilla + 1;  #612Casilla = Valfa2;
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#20#27 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + ((#20#26 - #20#27) % Coefi);

  |GRABA 140#612a;
|FPRC;

|PROCESO TrabajoN;
  |SI #20#28 = "X"; |ACABA; |FINSI;
  |SI #20#22 = 0;   |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #20#3; |SINO; Perce = "TITULAR"; |FINSI;

  Coefi = 100;
  |SI #99#1 = "A"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "T"; |Y #20#2 = "T"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "C"; |Y #20#2 = "C"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "1"; |Y #20#2 = "1"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "2"; |Y #20#2 = "2"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "3"; |Y #20#2 = "3"; |HAZ CargaH1a; |ACABA; |FINSI;
  |SI #99#1 = "4"; |Y #20#2 = "4"; |HAZ CargaH1a; |ACABA; |FINSI;
|FPRC;

|PROCESO TrabajoP;
  |SI #20#28 = "X"; |ACABA; |FINSI;
  |SI #20#22 = 0;   |ACABA; |FINSI;

  Coefi = 100;
  |SI #99#1 = "A"; Perce = #20#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";     || Si es conjunta
      |SI Tippar = 1;  || Matrimonio
          |SI #20#29 = 1; |ACABA; |FINSI;
          |SI #20#29 = 0; Coefi = 100 * Parte2; |FINSI;
          |SI #20#29 = 2; Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 3; || Separada
          |SI #20#29 = 2; |ACABA; |FINSI;
          |SI #20#29 = 0; Coefi = 100 * Parte1; |FINSI;
          |SI #20#29 = 1; Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; || Muerto
          |SI #20#29 = 0;
              |SI #20#2 = "T"; |Y Muerto = "T";
                  Coefi = 100;
              |SINO;
                  |SI #20#2 = "C"; |Y Muerto = "C";
                      Coefi = 100;
                  |SINO;
                      Coefi = 100 * Parte1;
                  |FINSI;
              |FINSI;
           |SINO;
               |SI #20#29 = 1;
                   Coefi = 100;
               |SINO;
                   |ACABA;
               |FINSI;
           |FINSI;
      |FINSI;
      |HAZ CargaH1a;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";     || Si es Titular
      |SI Tippar = 1;  || Matrimonio
          |SI #20#29 = 0; Coefi = 100 * Parte1; |FINSI;
          |SI #20#29 = 1; Coefi = 100;          |FINSI;
          |SI #20#29 = 2; |ACABA;               |FINSI;
      |FINSI;
      |SI Tippar = 2;  || Muerto
          Periodo = #20#29;
          |HAZ Muerto;
          |SI Error = 1; |ACABA; |FINSI;
      |FINSI;
      |SI Tippar = 3;  || Separacion
          |SI #20#29 = 0; Coefi = 100 * Parte2; |FINSI;
          |SI #20#29 = 2; Coefi = 100;          |FINSI;
          |SI #20#29 = 1; |ACABA;               |FINSI;
      |FINSI;
      |SI #20#2 = "T"; |HAZ CargaH1a; |ACABA; |FINSI;
  |FINSI;

  |SI #99#1 = "C";     || Si es Conyuge
      |SI Tippar = 1;  || Matrimonio
          |SI #20#29 = 0; Coefi = 100 * Parte1; |FINSI;
          |SI #20#29 = 1; Coefi = 100;          |FINSI;
          |SI #20#29 = 2; |ACABA;               |FINSI;
      |FINSI;
      |SI Tippar = 2;  || Muerto
          Periodo = #20#29;
          |HAZ Muerto;
          |SI Error = 1; |ACABA; |FINSI;
      |FINSI;
      |SI Tippar = 3;  || Separacion
          |SI #20#29 = 0; Coefi = 100 * Parte2; |FINSI;
          |SI #20#29 = 2; Coefi = 100;          |FINSI;
          |SI #20#29 = 1; |ACABA;               |FINSI;
      |FINSI;
      |SI #20#2 = "C"; |HAZ CargaH1a; |ACABA; |FINSI;
  |FINSI;
|FPRC;

|PROCESO Trabajo;
  |SI VSwCarga = 0;  |HAZ TrabajoN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ TrabajoP;  |FINSI;
|FPRC;

|DEFBUCLE rerendtr;
  #20#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, Trabajo;
|FIN;

|| ********** Rendimientos del capital *************************************

|PROCESO CargaH1b;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 5;    |FINSI;
  |SI Resto = 2;  Casilla = 16;   |FINSI;
  |SI Resto = 0;  Casilla = 27;   |FINSI;

  #612#0 = ContaAct1;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida ! 0;
      |DDEFECTO #612;
      #612#0 = ContaAct1;
      |GRABA 140#612b;
  |FINSI;

                          #612Casilla = #32#14 % 112;
  Casilla = Casilla + 1;  #612Casilla = #32#14 % 1312;
  Casilla = Casilla + 1;  #612Casilla = Perce;
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#32#18 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (#32#17 % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + ((#32#21 + #32#22) % Coefi);
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + ((#32#17 - (#32#21 + #32#22)) % Coefi);

  CantiNum = #32#27;  |HAZ Decimales;
  Valfa1   = ("00" + ParteEntera)  % -102;
  Valfa2   = ("0000" + ParteDecimal4) % -104;

  Casilla = Casilla + 1;  #612Casilla = Valfa1;
  Casilla = Casilla + 1;  #612Casilla = Valfa2;
  Casilla = Casilla + 1;  #612Casilla = #612Casilla + (((#32#17 - (#32#21 + #32#22)) % Coefi)) / #32#27;

  |GRABA 140#612a;
|FPRC;

|PROCESO CapitalN;
  |SI #32#4  = "X"; |O #32#4 = "P"; |ACABA; |FINSI;
  |SI #32#26 ! "I"; |ACABA; |FINSI;
  |SI #32#5  = "N"; |ACABA;  |FINSI;

  |SI #99#1 = "A"; Perce = #32#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #32#2 = "V";
          Coefi = #32#7 + #32#8 + #32#9 + #32#10 + #32#11 + #32#12;
          |HAZ CargaH1b;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaH1b;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #32#2 = "G"; Coefi = 50;    |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "T"; Coefi = 100;   |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#7; |HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #32#2 = "G"; Coefi = 50;    |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "C"; Coefi = 100;   |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#8; |HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #32#2 = "1"; Coefi = 100;   |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#9; |HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #32#2 = "2"; Coefi = 100;   |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#10;|HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #32#2 = "3"; Coefi = 100;    |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#11; |HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #32#2 = "4"; Coefi = 100;    |HAZ CargaH1b; |ACABA; |FINSI;
     |SI #32#2 = "V"; Coefi = #32#12; |HAZ CargaH1b; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO CapitalP;
  |SI #32#4 = "X"; |O #32#4 = "P"; |ACABA; |FINSI;
  |SI #32#5 = "N"; |ACABA; |FINSI;
  |SI #32#26 ! "I"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #32#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #32#2 = "V";
          |SI Tippar = 1;
              |SI #32#25 = 0;  Coefi = #32#7 + #32#8;            |FINSI;
              |SI #32#25 = 1;  |ACABA;                         |FINSI;
              |SI #32#25 = 2;  Coefi = #32#7 + #32#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #32#25 = 0;  Coefi = #32#7 + #32#8;            |FINSI;
              |SI #32#25 = 2;  |ACABA;                         |FINSI;
              |SI #32#25 = 1;  Coefi = #32#7 + #32#8;            |FINSI;
          |FINSI;
          |HAZ CargaH1b;
          |ACABA;
      |FINSI;

      |SI #32#2 = "G";
          |SI Tippar = 1;
              |SI #32#25 = 0;  Coefi = 50;           |FINSI;
              |SI #32#25 = 1;  |ACABA;               |FINSI;
              |SI #32#25 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #32#25 = 0;  Coefi = 50;          |FINSI;
              |SI #32#25 = 2;  |ACABA;               |FINSI;
              |SI #32#25 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaH1b;
          |ACABA;
      |FINSI;

      |SI Tippar = 1;
          |SI #32#25 = 0;  Coefi = 100;          |FINSI;
          |SI #32#25 = 1;  |ACABA;               |FINSI;
          |SI #32#25 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #32#25 = 0;  Coefi = 100;          |FINSI;
          |SI #32#25 = 2;  |ACABA;               |FINSI;
          |SI #32#25 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaH1b;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #32#2 = "G";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = 25;          |FINSI;
             |SI #32#25 = 1; Coefi = 50;          |FINSI;
             |SI #32#25 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #32#25 = 0; Coefi = 50;          |FINSI;
                 |SI #32#25 = 1; Coefi = 50;          |FINSI;
                 |SI #32#25 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #32#25 = 0; Coefi = 50;          |FINSI;
                 |SI #32#25 = 1; |ACABA;              |FINSI;
                 |SI #32#25 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = 25;          |FINSI;
             |SI #32#25 = 1; |ACABA;              |FINSI;
             |SI #32#25 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;

     |SI #32#2 = "T";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = 100;          |FINSI;
             |SI #32#25 = 1; Coefi = 100;          |FINSI;
             |SI #32#25 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #32#25;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = 100;          |FINSI;
             |SI #32#25 = 1; |ACABA;               |FINSI;
             |SI #32#25 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;

     |SI #32#2 = "V";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = #32#7;          |FINSI;
             |SI #32#25 = 1; Coefi = #32#7;          |FINSI;
             |SI #32#25 = 2; |ACABA;                |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #32#7;             |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = #32#7;          |FINSI;
             |SI #32#25 = 1; |ACABA;                |FINSI;
             |SI #32#25 = 2; Coefi = #32#7;          |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #32#2 = "G";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = 25;          |FINSI;
             |SI #32#25 = 1; Coefi = 50;          |FINSI;
             |SI #32#25 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #32#25 = 0; Coefi = 100;         |FINSI;
                 |SI #32#25 = 1; |ACABA;              |FINSI;
                 |SI #32#25 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #32#25 = 0; Coefi = 50;          |FINSI;
                 |SI #32#25 = 1; Coefi = 50;          |FINSI;
                 |SI #32#25 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = 25;          |FINSI;
             |SI #32#25 = 1; |ACABA;              |FINSI;
             |SI #32#25 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;

     |SI #32#2 = "C";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = 100;          |FINSI;
             |SI #32#25 = 1; Coefi = 100;          |FINSI;
             |SI #32#25 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #32#25;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = 100;          |FINSI;
             |SI #32#25 = 1; |ACABA;               |FINSI;
             |SI #32#25 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;

     |SI #32#2 = "V";
         |SI Tippar = 1;
             |SI #32#25 = 0; Coefi = #32#8;          |FINSI;
             |SI #32#25 = 1; Coefi = #32#8;          |FINSI;
             |SI #32#25 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #32#8;             |FINSI;
         |SI Tippar = 3;
             |SI #32#25 = 0; Coefi = #32#8;         |FINSI;
             |SI #32#25 = 1; |ACABA;               |FINSI;
             |SI #32#25 = 2; Coefi = #32#8;         |FINSI;
         |FINSI;
         |HAZ CargaH1b; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO Capital;
  |SI VSwCarga = 0;  |HAZ CapitalN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ CapitalP;  |FINSI;
|FPRC;

|DEFBUCLE rectacor;
  #32#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, Capital;
|FIN;

|| ********** Rendimientos empresariales y profesionales *******************

|PROCESO CargaH2;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 41;   |FINSI;
  |SI Resto = 2;  Casilla = 53;   |FINSI;
  |SI Resto = 0;  Casilla = 65;   |FINSI;

  #612#0 = ContaAct1;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida ! 0;
      |DDEFECTO #612;
      #612#0 = ContaAct1;
      |GRABA 140#612b;
  |FINSI;

                           #612Casilla = #33#6 % 112;
  Casilla = Casilla + 1;   #612Casilla = #33#6 % 1312;
  Casilla = Casilla + 1;   #612Casilla = Perce;
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#8  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#9  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#10 % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#11 % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#12 % Coefi);

  CantiNum = #33#13;  |HAZ Decimales;
  Valfa1   = ("00" + ParteEntera)  % -102;
  Valfa2   = ("0000" + ParteDecimal4) % -104;

  Casilla = Casilla + 1;   #612Casilla = Valfa1;
  Casilla = Casilla + 1;   #612Casilla = Valfa2;
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#14 % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#33#15 % Coefi);
  |GRABA 140#612a;
|FPRC;

|PROCESO ProfEmpN;
  |SI #33#16 = "X"; |O #33#16 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #33#5; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #33#4 = "V";
          Coefi = #33#17 + #33#18 + #33#19 + #33#20 + #33#21 + #33#22;
          |HAZ CargaH2;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaH2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #33#4 = "G"; Coefi = 50;     |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "T"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#17; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #33#4 = "G"; Coefi = 50;     |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "C"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#18; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #33#4 = "1"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#19; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #33#4 = "2"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#20; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #33#4 = "3"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#21; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #33#4 = "4"; Coefi = 100;    |HAZ CargaH2; |ACABA; |FINSI;
     |SI #33#4 = "V"; Coefi = #33#22; |HAZ CargaH2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO ProfEmpP;
  |SI #33#16 = "X"; |O #33#16 = "P"; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #33#5; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #33#4 = "V";
          |SI Tippar = 1;
              |SI #33#23 = 0;  Coefi = #33#17 + #33#18;            |FINSI;
              |SI #33#23 = 1;  |ACABA;                         |FINSI;
              |SI #33#23 = 2;  Coefi = #33#17 + #33#18;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #33#23 = 0;  Coefi = #33#17 + #33#18;            |FINSI;
              |SI #33#23 = 2;  |ACABA;                         |FINSI;
              |SI #33#23 = 1;  Coefi = #33#17 + #33#18;            |FINSI;
          |FINSI;
          |HAZ CargaH2;
          |ACABA;
      |FINSI;
      |SI #33#4 = "G";
          |SI Tippar = 1;
              |SI #33#23 = 0;  Coefi = 50;          |FINSI;
              |SI #33#23 = 1;  |ACABA;               |FINSI;
              |SI #33#23 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #33#23 = 0;  Coefi = 50;          |FINSI;
              |SI #33#23 = 2;  |ACABA;               |FINSI;
              |SI #33#23 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaH2;
          |ACABA;
      |FINSI;

      |SI Tippar = 1;
          |SI #33#23 = 0;  Coefi = 100;          |FINSI;
          |SI #33#23 = 1;  |ACABA;               |FINSI;
          |SI #33#23 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #33#23 = 0;  Coefi = 100;          |FINSI;
          |SI #33#23 = 2;  |ACABA;               |FINSI;
          |SI #33#23 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaH2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #33#4 = "G";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = 25;          |FINSI;
             |SI #33#23 = 1; Coefi = 50;          |FINSI;
             |SI #33#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #33#23 = 0; Coefi = 50;          |FINSI;
                 |SI #33#23 = 1; Coefi = 50;          |FINSI;
                 |SI #33#23 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #33#23 = 0; Coefi = 50;          |FINSI;
                 |SI #33#23 = 1; |ACABA;              |FINSI;
                 |SI #33#23 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = 25;          |FINSI;
             |SI #33#23 = 1; |ACABA;              |FINSI;
             |SI #33#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;

     |SI #33#4 = "T";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = 100;          |FINSI;
             |SI #33#23 = 1; Coefi = 100;          |FINSI;
             |SI #33#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #33#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = 100;          |FINSI;
             |SI #33#23 = 1; |ACABA;               |FINSI;
             |SI #33#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;

     |SI #33#4 = "V";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = #33#17;          |FINSI;
             |SI #33#23 = 1; Coefi = #33#17;          |FINSI;
             |SI #33#23 = 2; |ACABA;                |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #33#17;             |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = #33#17;          |FINSI;
             |SI #33#23 = 1; |ACABA;                |FINSI;
             |SI #33#23 = 2; Coefi = #33#17;          |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #33#4 = "G";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = 25;          |FINSI;
             |SI #33#23 = 1; Coefi = 50;          |FINSI;
             |SI #33#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #33#23 = 0; Coefi = 100;         |FINSI;
                 |SI #33#23 = 1; |ACABA;              |FINSI;
                 |SI #33#23 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #33#23 = 0; Coefi = 50;          |FINSI;
                 |SI #33#23 = 1; Coefi = 50;          |FINSI;
                 |SI #33#23 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = 25;          |FINSI;
             |SI #33#23 = 1; |ACABA;              |FINSI;
             |SI #33#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;

     |SI #33#4 = "C";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = 100;          |FINSI;
             |SI #33#23 = 1; Coefi = 100;          |FINSI;
             |SI #33#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #33#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = 100;          |FINSI;
             |SI #33#23 = 1; |ACABA;               |FINSI;
             |SI #33#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;

     |SI #33#4 = "V";
         |SI Tippar = 1;
             |SI #33#23 = 0; Coefi = #33#18;          |FINSI;
             |SI #33#23 = 1; Coefi = #33#18;          |FINSI;
             |SI #33#23 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #33#18;             |FINSI;
         |SI Tippar = 3;
             |SI #33#23 = 0; Coefi = #33#18;         |FINSI;
             |SI #33#23 = 1; |ACABA;               |FINSI;
             |SI #33#23 = 2; Coefi = #33#18;         |FINSI;
         |FINSI;
         |HAZ CargaH2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO ProfEmp;
  |SI VSwCarga = 0;  |HAZ ProfEmpN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ ProfEmpP;  |FINSI;
|FPRC;

|DEFBUCLE rerendir;
  #33#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, ProfEmp;
|FIN;

|| ********** Imputaciones transparencia fiscal ****************************

|PROCESO CargaJ1;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 86;   |FINSI;
  |SI Resto = 2;  Casilla = 95;   |FINSI;
  |SI Resto = 0;  Casilla = 104;  |FINSI;

  #612#0 = ContaAct1;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida ! 0;
      |DDEFECTO #612;
      #612#0 = ContaAct1;
      |GRABA 140#612b;
  |FINSI;

                           #612Casilla = #34#14;
  Casilla = Casilla + 1;   #612Casilla = Perce;
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#16  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#17  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#18  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#19  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#20  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = 0;
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#21  % Coefi);
  |GRABA 140#612a;
|FPRC;

|PROCESO TranspaN;
  |SI #34#4 = "X"; |O #34#4 = "P"; |ACABA; |FINSI;
  |SI #34#5 = "N"; |ACABA; |FINSI;
  |SI #34#14 = "***         "; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #33#5; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #34#2 = "V";
          Coefi = #34#7 + #34#8 + #34#9 + #34#10 + #34#11 + #34#12;
          |HAZ CargaJ1;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaJ1;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #34#2 = "G"; Coefi = 50;     |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "T"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#7;  |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #34#2 = "G"; Coefi = 50;     |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "C"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#8;  |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #34#2 = "1"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#9;  |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #34#2 = "2"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#10; |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #34#2 = "3"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#11; |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #34#2 = "4"; Coefi = 100;    |HAZ CargaJ1; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#12; |HAZ CargaJ1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO TranspaP;
  |SI #34#4  = "X"; |O #34#4 = "P"; |ACABA; |FINSI;
  |SI #34#5  = "N"; |ACABA; |FINSI;
  |SI #34#14 = "***         "; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #34#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #34#2 = "V";
          |SI Tippar = 1;
              |SI #34#23 = 0;  Coefi = (#34#7 + #34#8) * Parte2; |FINSI;
              |SI #34#23 = 1;  |ACABA;                         |FINSI;
              |SI #34#23 = 2;  Coefi = #34#7 + #34#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #34#23 = 0;  Coefi = (#34#7 + #34#8) * Parte1; |FINSI;
              |SI #34#23 = 1;  Coefi = #34#7 + #34#8;            |FINSI;
              |SI #34#23 = 2;  |ACABA;                         |FINSI;
          |FINSI;
          |HAZ CargaJ1;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #34#23 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #34#23 = 1;  |ACABA;               |FINSI;
              |SI #34#23 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #34#2 = "G";
              |SI Tippar = 2;
                  |SI #34#23 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #34#23 = 1;  Coefi = 100;          |FINSI;
                  |SI #34#23 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #34#23 = 0;
                      |SI #34#2 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                         |SI #34#2 = "C"; |Y Muerto = "C";
                             Coefi = 100;
                         |SINO;
                             Coefi = 100 * Parte1;
                         |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #34#23 = 1;  Coefi = 100;          |FINSI;
                  |SI #34#23 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #34#23 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #34#23 = 2;  |ACABA;               |FINSI;
              |SI #34#23 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaJ1;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #34#2 = "G";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 50;          |FINSI;
             |SI #34#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #34#23 = 1; Coefi = 50;          |FINSI;
                 |SI #34#23 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #34#23 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #34#23 = 1; |ACABA;                      |FINSI;
                 |SI #34#23 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;              |FINSI;
             |SI #34#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;

     |SI #34#2 = "T";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 100;          |FINSI;
             |SI #34#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #34#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;               |FINSI;
             |SI #34#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;

     |SI #34#2 = "V";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = #34#7 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = #34#7;          |FINSI;
             |SI #34#23 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #34#7;             |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = #34#7 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;        |FINSI;
             |SI #34#23 = 2; Coefi = #34#7;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #34#2 = "G";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 50;          |FINSI;
             |SI #34#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #34#23 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #34#23 = 1; |ACABA;              |FINSI;
                 |SI #34#23 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #34#23 = 1; Coefi = 50;                  |FINSI;
                 |SI #34#23 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;              |FINSI;
             |SI #34#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;

     |SI #34#2 = "C";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 100;          |FINSI;
             |SI #34#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #34#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;               |FINSI;
             |SI #34#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;

     |SI #34#2 = "V";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = #34#8 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = #34#8;          |FINSI;
             |SI #34#23 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #34#8;             |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = #34#8 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;        |FINSI;
             |SI #34#23 = 2; Coefi = #34#8;          |FINSI;
         |FINSI;
         |HAZ CargaJ1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO Transpa;
  |SI VSwCarga = 0;  |HAZ TranspaN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ TranspaP;  |FINSI;
|FPRC;

|DEFBUCLE retransp1;
  #34#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, Transpa;
|FIN;

|| ********** Inclusiones por entidades no residentes **********************

|PROCESO CargaJ2;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 115;  |FINSI;
  |SI Resto = 2;  Casilla = 121;  |FINSI;
  |SI Resto = 0;  Casilla = 127;  |FINSI;

  #612#0 = ContaAct1;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida ! 0;
      |DDEFECTO #612;
      #612#0 = ContaAct1;
      |GRABA 140#612b;
  |FINSI;

                           #612Casilla = #34#13 % 112;
  Casilla = Casilla + 1;   #612Casilla = #34#13 % 1312;
  Casilla = Casilla + 1;   #612Casilla = Perce;
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#16  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#17  % Coefi);
  Casilla = Casilla + 1;   #612Casilla = #612Casilla + (#34#18  % Coefi);

  |GRABA 140#612a;
|FPRC;

|PROCESO InclusionN;
  |SI #34#4 = "X"; |O #34#4 = "P"; |ACABA; |FINSI;
  |SI #34#5 = "N"; |ACABA; |FINSI;
  |SI #34#14 ! "***         "; |ACABA; |FINSI;

  |SI #99#1 = "A";
      |SI #34#2 = "V";
          Coefi = #34#7 + #34#8 + #34#9 + #34#10 + #34#11 + #34#12;
          |HAZ CargaJ2;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaJ2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #34#2 = "G"; Coefi = 50;     |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "T"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#7;  |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #34#2 = "G"; Coefi = 50;     |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "C"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#8;  |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #34#2 = "1"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#9;  |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #34#2 = "2"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#10; |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #34#2 = "3"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#11; |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #34#2 = "4"; Coefi = 100;    |HAZ CargaJ2; |ACABA; |FINSI;
     |SI #34#2 = "V"; Coefi = #34#12; |HAZ CargaJ2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO InclusionP;
  |SI #34#4  = "X"; |O #34#4 = "P"; |ACABA; |FINSI;
  |SI #34#5  = "N"; |ACABA; |FINSI;
  |SI #34#14 ! "***         "; |ACABA; |FINSI;

  |SI #99#1 = "A"; Perce = #34#3; |SINO; Perce = "TITULAR"; |FINSI;

  |SI #99#1 = "A";
      |SI #34#2 = "V";
          |SI Tippar = 1;
              |SI #34#23 = 0;  Coefi = (#34#7 + #34#8) * Parte2; |FINSI;
              |SI #34#23 = 1;  |ACABA;                         |FINSI;
              |SI #34#23 = 2;  Coefi = #34#7 + #34#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #34#23 = 0;  Coefi = (#34#7 + #34#8) * Parte1; |FINSI;
              |SI #34#23 = 1;  Coefi = #34#7 + #34#8;            |FINSI;
              |SI #34#23 = 2;  |ACABA;                         |FINSI;
          |FINSI;
          |HAZ CargaJ2;
          |ACABA;
      |SINO;
          |SI Tippar = 1;
              |SI #34#23 = 0;  Coefi = 100 * Parte2; |FINSI;
              |SI #34#23 = 1;  |ACABA;               |FINSI;
              |SI #34#23 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI #34#2 = "G";
              |SI Tippar = 2;
                  |SI #34#23 = 0;  Coefi = 100 * Parte1; |FINSI;
                  |SI #34#23 = 1;  Coefi = 100;          |FINSI;
                  |SI #34#23 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |SINO;
              |SI Tippar = 2;
                  |SI #34#23 = 0;
                      |SI #34#2 = "T"; |Y Muerto = "T";
                          Coefi = 100;
                      |SINO;
                         |SI #34#2 = "C"; |Y Muerto = "C";
                             Coefi = 100;
                         |SINO;
                             Coefi = 100 * Parte1;
                         |FINSI;
                      |FINSI;
                  |FINSI;
                  |SI #34#23 = 1;  Coefi = 100;          |FINSI;
                  |SI #34#23 = 2;  |ACABA;               |FINSI;
              |FINSI;
          |FINSI;
          |SI Tippar = 3;
              |SI #34#23 = 0;  Coefi = 100 * Parte1; |FINSI;
              |SI #34#23 = 2;  |ACABA;               |FINSI;
              |SI #34#23 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaJ2;
          |ACABA;
      |FINSI;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #34#2 = "G";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 50;          |FINSI;
             |SI #34#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #34#23 = 1; Coefi = 50;          |FINSI;
                 |SI #34#23 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #34#23 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #34#23 = 1; |ACABA;                      |FINSI;
                 |SI #34#23 = 2; Coefi = 100;                 |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;              |FINSI;
             |SI #34#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;

     |SI #34#2 = "T";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 100;          |FINSI;
             |SI #34#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #34#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;               |FINSI;
             |SI #34#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;

     |SI #34#2 = "V";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = #34#7 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = #34#7;          |FINSI;
             |SI #34#23 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #34#7;             |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = #34#7 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;        |FINSI;
             |SI #34#23 = 2; Coefi = #34#7;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #34#2 = "G";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 50;          |FINSI;
             |SI #34#23 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #34#23 = 0; Coefi = 100 - (50 * Parte1); |FINSI;
                 |SI #34#23 = 1; |ACABA;              |FINSI;
                 |SI #34#23 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #34#23 = 0; Coefi = 50 * Parte1; |FINSI;
                 |SI #34#23 = 1; Coefi = 50;                  |FINSI;
                 |SI #34#23 = 2; |ACABA;                      |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 50 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;              |FINSI;
             |SI #34#23 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;

     |SI #34#2 = "C";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = 100 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = 100;          |FINSI;
             |SI #34#23 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #34#23;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = 100 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;               |FINSI;
             |SI #34#23 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;

     |SI #34#2 = "V";
         |SI Tippar = 1;
             |SI #34#23 = 0; Coefi = #34#8 * Parte1; |FINSI;
             |SI #34#23 = 1; Coefi = #34#8;          |FINSI;
             |SI #34#23 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #34#8;             |FINSI;
         |SI Tippar = 3;
             |SI #34#23 = 0; Coefi = #34#8 * Parte2; |FINSI;
             |SI #34#23 = 1; |ACABA;        |FINSI;
             |SI #34#23 = 2; Coefi = #34#8;          |FINSI;
         |FINSI;
         |HAZ CargaJ2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO Inclusion;
  |SI VSwCarga = 0;  |HAZ InclusionN;  |FINSI;
  |SI VSwCarga = 1;  |HAZ InclusionP;  |FINSI;
|FPRC;

|DEFBUCLE retransp2;
  #34#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, Inclusion;
|FIN;

|PROCESO Totales612;
  #612#4   = ContaAct;

  #612#15  = #612#11 - #612#14;
  #612#26  = #612#22 - #612#25;
  #612#37  = #612#33 - #612#36;

  #612#135 = #99#7;
  #612#136 = #99#3;

  |GRABA 140#612a;
  |LIBERA #612;

  Total1   = Total1 + (#612#8  + #612#19 + #612#30);
  Total2   = Total2 + (#612#14 + #612#25 + #612#36);
  Total3   = Total3 + (#612#15 + #612#26 + #612#37);
  Total4   = Total4 + (#612#44 + #612#56 + #612#68);
  Total5   = #5#25;
  Total6   = Total6 + (#612#51 + #612#63 + #612#75);
  Total7   = Total7 + (#612#52 + #612#64 + #612#76);
  Total8   = #5#24;
  Total10  = #6#250;
  Total11  = #5#50;
  Total13  = #5#23;
  Total14  = #5#134;
  Total15  = #5#70;
|FPRC;

|DEFBUCLE rew00021T;
  #612#1;
  ;
  00;
  99;
  be;
  NULL, Totales612;
|FIN;

|PROCESO LeeFicheros;
  |ABRE #99;
  #99#0 = VEmpresa;
  #99#1 = VTipo;
  |LEE 040#99=;
  |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
  |CIERRA #99;

  |ABRE #5;
  #5#0   = #99#0;
  #5#141 = #99#1;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;

  |ABRE #6;
  #6#0   = #99#0;
  #6#1   = #99#1;
  |LEE 040#6=;
  |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
  |CIERRA #6;
|FPRC;

|PROCESO CargaHoja12;
  |HAZ LeeFicheros;

  ContaAct = 0;
  Conta  = 0;
  Conta1 = 0;
  |BUCLE rerendtr;

  |BUCLE rectacor;
  |SI Conta > 2;  Conta1 = Conta;  |FINSI;
  |SI Conta1 [ 2;
      #612#0 = 1;  |BORRA 140#612c;  |LIBERA #612;
  |FINSI;

  Conta  = 0;
  Conta2 = 0;
  |BUCLE rerendir;
  |SI Conta > 2;  Conta2 = Conta;  |FINSI;
  |SI Conta1 [ 3; |Y Conta2 [ 3;
      #612#0 = 1;  |BORRA 140#612c;  |LIBERA #612;
  |FINSI;

  Conta   = 0;
  Conta3  = 0;
  |BUCLE retransp1;
  |SI Conta > 2;  Conta3 = Conta;  |FINSI;
  |SI Conta1 [ 3; |Y Conta2 [ 3; |Y Conta3 [ 3;
      #612#0 = 1;  |BORRA 140#612c;  |LIBERA #612;
  |FINSI;

  Conta   = 0;
  Conta4  = 0;
  |BUCLE retransp2;
  |SI Conta > 2;  Conta4 = Conta;  |FINSI;

  ContaAct  = Conta1;
  |SI ContaAct < Conta2;  ContaAct = Conta2;  |FINSI;
  |SI ContaAct < Conta3;  ContaAct = Conta3;  |FINSI;
  |SI ContaAct < Conta4;  ContaAct = Conta4;  |FINSI;

  |SI ContaAct > 2;
      ContaAct = ((((ContaAct + 1) / 3) + 0.49) ! 0) - 1;
  |SINO;
      #612#0 = 1;  |BORRA 140#612c;
  |FINSI;

  Total1  = 0;  Total2  = 0;  Total3  = 0;  Total4  = 0;  Total5  = 0;
  Total6  = 0;  Total7  = 0;  Total8  = 0;  Total9  = 0;  Total10 = 0;
  Total11 = 0;  Total12 = 0;  Total13 = 0;  Total14 = 0;  Total15 = 0;

  |BUCLE rew00021T;

  |ABRE #612;
  #612#0 = 0;
  |LIBERA #612;
  |LEE 140#612=;
  |SI FSalida = 0;
      #612#38  = Total1;   #612#39  = Total2;   #612#40  = Total3;
      #612#77  = Total4;   #612#78  = Total5;   #612#79  = Total6;
      #612#80  = Total7;   #612#81  = Total8;
      #612#83  = Total10;  #612#84  = Total11;
      #612#113 = Total13;  #612#114 = Total14;  #612#133 = Total15;

      #612#82  = #612#40 + #612#80;

      |SI #612#82 < 0;
          #612#82 = 0;
          #612#85 = -#612#82;
      |FINSI;

      |GRABA 140#612a;
  |FINSI;
  |CIERRA #612;
|FPRC;

|PROCESO GrabaTexto612;
  |HAZ BorraCampos;

  ICampos = Campos1 <-;
  |PARA XCampos = 1;  |SI XCampos [ 134;  |HACIENDO XCampos = XCampos + 1;
        Campos  = #612XCampos;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos1   <-;                                    Campos = "100";
  ICampos = Campos2   <-;                                    Campos = "12";
  ICampos = Campos3   <-; |SI #612#0 ! 0;  Campos = "C";   |FINSI;
  ICampos = Campos134 <-; Valfa = &13 + &10;                 Campos = Valfa;

  ICampos = Campos8  <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos9  <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos10 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos11 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos14 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos15 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos19 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos20 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos21 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos22 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos25 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos26 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos30 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos31 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos32 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos33 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos36 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos37 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos38 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos39 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos40 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos44 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos45 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos46 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos47 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos48 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos51 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos52 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos56 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos57 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos58 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos59 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos60 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos63 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos64 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos68 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos69 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos70 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos71 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos72 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos75 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos76 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos77 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos78 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos79 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos80 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos81 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos82 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos83 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos84 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos85 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos88 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos89 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos90 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos91 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos92 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos93 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos94 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos97 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos98 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos99 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos100 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos101 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos102 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos103 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos106 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos107 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos108 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos109 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos110 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos111 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos112 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos113 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos114 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos118 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos119 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos120 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos124 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos125 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos126 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos130 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos131 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos132 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos133 <-; CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;


  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;

  Pos = -1;
  NSecuencial = "r+b " + NEmpresas;
  |FABRE NSecuencial;
  |SI FSalida < 0;
      NSecuencial = "wb  " + NEmpresas;
      |FABRE NSecuencial;
  |FINSI;

  Handle = FSalida;
  |SI FSalida ] 0;
      |PARA; |SI; |HACIENDO;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
      |SIGUE;
  |FINSI;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 134; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
  |FCIERRA Handle;
|FPRC;

|DEFBUCLE rew00021G;
  #612#1;
  ;
  00;
  99;
  be;
  NULL, GrabaTexto612;
|FIN;

|PROGRAMA;
  |NOME_DAT #99  VTemporal0;
  |NOME_DAT #612 VTemporal12;

  |SI VSwCarga = 0;  |O VSwCarga = 1;
      |ABRE #612;  |CIERRA #612;  |DELINDEX #612;
      |ABRE #612;
      |HAZ CargaHoja12;
      |CIERRA #612;
  |FINSI;

  |SI VSwCarga = 100;
      |BUCLE rew00021G;
  |FINSI;
|FPRO;
