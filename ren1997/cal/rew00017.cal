|FICHEROS;
     retotren #5;
     retotrea #6;
     retotreb #84;
     rew00001 #99;
     rew00017 #608;
|FIN;

|VARIABLES;
      XCampos     = 0;
      NSecuencial = "";
      Field       = "";
      Suma        = 0;

     &VEmpresa   = 0;
     &VTipo      = "";
     &NCopia     = 0;
     &VSwCarga   = 0;
     &VTemporal0 = "";
     &VTemporal8 = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_utilid;

|PROCESO LeeFicheros;
  |ABRE #99;
  #99#0 = VEmpresa;
  #99#1 = VTipo;
  |LEE 040#99=;
  |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
  |CIERRA #99;

  |ABRE #5;
  #5#0   = #99#0;
  #5#141 = #99#1;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;

  |ABRE #6;
  #6#0 = #99#0;
  #6#1 = #99#1;
  |LEE 040#6=;
  |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
  |CIERRA #6;

  |ABRE #84;
  #84#0 = #99#0;
  #84#1 = #99#1;
  |LEE 040#84=;
  |SI FSalida ! 0; |DDEFECTO #84; |FINSI;
  |CIERRA #84;
|FPRC;

|PROCESO CargaHoja8;
  |HAZ LeeFicheros;

  #608#0 = 0;
  |LIBERA #608;
  |LEE 140#608=;
  |SI FSalida ! 0;
      |DDEFECTO #608;
      #608#0 = 0;
      |GRABA 140#608b;
  |FINSI;

  #608#004 = #5#46;
  #608#005 = #5#47;
  #608#006 = #5#48;
  #608#007 = #5#40;

  #608#008 = #84#002;   #608#009 = #84#003;
  #608#010 = #84#004;   #608#011 = #84#005;  #608#012 = #608#010 - #608#011;
  #608#013 = #84#006;   #608#014 = #84#007;  #608#015 = #608#013 - #608#014;
  #608#016 = #84#008;   #608#017 = #84#009;  #608#018 = #608#016 - #608#017;
  #608#019 = #84#010;   #608#020 = #84#011;  #608#021 = #608#019 - #608#020;
  #608#022 = #84#012;   #608#023 = #84#013;  #608#024 = #608#022 - #608#023;
  #608#025 = #84#014;   #608#026 = #84#015;  #608#027 = #608#025 - #608#026;
  #608#028 = #84#016;   #608#029 = #84#017;  #608#030 = #608#028 - #608#029;
  #608#031 = #84#018;   #608#032 = #84#019;  #608#033 = #608#031 - #608#032;
  #608#034 = #84#020;   #608#035 = #84#021;  #608#036 = #608#034 - #608#035;
  #608#037 = #84#022;   #608#038 = #84#023;  #608#039 = #608#037 - #608#038;
  #608#040 = #84#024;   #608#041 = #84#025;  #608#042 = #608#040 - #608#041;

  #608#43 = #608#8;
  |PARA XCampos = 10;  |SI XCampos [ 40;  |HACIENDO XCampos = XCampos + 3;
        #608#43 = #608#43 + #608XCampos;
  |SIGUE;

  #608#44 = #5#99;

  #608#45 = 0;
  |PARA XCampos = 12;  |SI XCampos [ 42;  |HACIENDO XCampos = XCampos + 3;
        #608#45 = #608#45 + #608XCampos;
  |SIGUE;

  #608#046 = #84#026;   #608#047 = #84#027;
  #608#048 = #84#028;   #608#049 = #84#029;  #608#050 = #608#048 - #608#049;
  #608#051 = #84#030;   #608#052 = #84#031;  #608#053 = #608#051 - #608#052;
  #608#054 = #84#032;   #608#055 = #84#033;  #608#056 = #608#054 - #608#055;
  #608#057 = #84#034;   #608#058 = #84#035;  #608#059 = #608#057 - #608#058;
  #608#060 = #84#036;   #608#061 = #84#037;  #608#062 = #608#060 - #608#061;
  #608#063 = #84#038;   #608#064 = #84#039;  #608#065 = #608#063 - #608#064;
  #608#066 = #84#040;   #608#067 = #84#041;  #608#068 = #608#066 - #608#067;
  #608#069 = #84#042;   #608#070 = #84#043;  #608#071 = #608#069 - #608#070;
  #608#072 = #84#044;   #608#073 = #84#045;  #608#074 = #608#072 - #608#073;
  #608#075 = #84#046;   #608#076 = #84#047;  #608#077 = #608#075 - #608#076;
  #608#078 = #84#048;   #608#079 = #84#049;  #608#080 = #608#078 - #608#079;

  #608#081 = #608#46;
  |PARA XCampos = 48;  |SI XCampos [ 78;  |HACIENDO XCampos = XCampos + 3;
        #608#81 = #608#81 + #608XCampos;
  |SIGUE;

  #608#82 = #5#100;

  #608#083 = 0;
  |PARA XCampos = 50;  |SI XCampos [ 80;  |HACIENDO XCampos = XCampos + 3;
        #608#83 = #608#83 + #608XCampos;
  |SIGUE;

  #608#084 = #84#050;   #608#085 = #84#051;  #608#086 = #608#084 - #608#085;
  #608#087 = #84#052;   #608#088 = #84#053;
  #608#089 = #84#054;   #608#090 = #84#055;  #608#091 = #608#089 - #608#090;
  #608#092 = #84#056;   #608#093 = #84#057;  #608#094 = #608#092 - #608#093;
  #608#095 = #84#058;   #608#096 = #84#059;
  #608#097 = #84#060;   #608#098 = #84#061;  #608#099 = #608#097 - #608#098;
  #608#100 = #84#062;   #608#101 = #84#063;  #608#102 = #608#100 - #608#101;
  #608#103 = #84#064;   #608#104 = #84#065;  #608#105 = #608#103 - #608#104;
  #608#106 = #84#066;   #608#107 = #84#067;  #608#108 = #608#106 - #608#107;

  #608#109 = #608#084 + #608#087 + #608#089 + #608#092 + #608#095 + #608#097;
  #608#109 = #608#109 + #608#100 + #608#103 + #608#106;

  #608#110 = #5#101;

  #608#111 = #608#086 + #608#091 + #608#094 + #608#099 + #608#102 + #608#105;
  #608#111 = #608#111 + #608#108;

  #608#112 = #84#068;   #608#113 = #84#069;
  #608#114 = #84#070;   #608#115 = #84#071;  #608#116 = #608#114 - #608#115;

  #608#117 = #608#112 + #608#114;
  #608#118 = #5#102;
  #608#119 = #608#116;

  #608#121 = #99#7;
  #608#122 = #99#3;

  |GRABA 140#608a;
|FPRC;

|PROCESO GrabaH08M100;
  |HAZ BorraCampos;

  ICampos = Campos1 <-;
  |PARA XCampos = 1;  |SI XCampos [ 120;  |HACIENDO XCampos = XCampos + 1;
        Campos = #608XCampos;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos1   <-;                                    Campos = "100";
  ICampos = Campos2   <-;                                    Campos = "08";
  ICampos = Campos120 <-; Valfa = &13 + &10;                 Campos = Valfa;

  ICampos = Campos4 <-;
  |PARA XCampos = 4;  |SI XCampos [ 119;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;

  Pos = -1;
  NSecuencial = "r+b " + NEmpresas;
  |FABRE NSecuencial;
  |SI FSalida < 0;
      NSecuencial = "wb  " + NEmpresas;
      |FABRE NSecuencial;
  |FINSI;

  Handle = FSalida;
  |SI FSalida ] 0;
      |PARA; |SI; |HACIENDO;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
      |SIGUE;
  |FINSI;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 120; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
  |FCIERRA Handle;
|FPRC;

|PROGRAMA;
  |NOME_DAT #99  VTemporal0;
  |NOME_DAT #608 VTemporal8;

  |SI VSwCarga = 0;  |O VSwCarga = 1;
      |ABRE #608;  |CIERRA #608;  |DELINDEX #608;
      |ABRE #608;
      |HAZ CargaHoja8;
      |CIERRA #608;
  |FINSI;

  |SI VSwCarga = 100;
      |ABRE #608;
      #608#0 = 0;
      |LEE 040#608=;
      |SI FSalida = 0;
          Suma = #608#44 + #608#82  + #608#110 + #608#14 + #608#118;
          Suma = Suma    + #608#4   + #608#5   + #608#6  + #608#7;
          |SI Suma ! 0;  |HAZ GrabaH08M100;  |FINSI;
      |FINSI;
      |CIERRA #608;
  |FINSI;
|FPRO;
