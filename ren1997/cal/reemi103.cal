|FICHEROS;
     reemi103 #0;
     redatcon #1;
     repartid #8;
     repant50 #90;

     rew00001 #99,MANTE;

     rew00010 #601;
     rew00011 #602;
     rew00012 #603;
     rew00013 #604;
     rew00014 #605;
     rew00015 #606;
     rew00016 #607;
     rew00017 #608;
     rew00018 #609;
     rew00019 #610;
     rew00020 #611;
     rew00021 #612;
     rew00022 #613;
     rew00023 #614;
     rew00024 #615;
     rew00025 #616;
     rew00026 #617;
|FIN;

|VARIABLES;
     CFBase      = "";
     CFAbre      = "";
     Hoja        = 0;
     NombreInf   = "";
     XCampos     = 0;
     SwEstar     = 0;
     Tempo       = "";
     Modifica    = "";
     NombreImpre = "";
     Casilla     = 0;
     DEmpre      = 0;
     HEmpre      = 0;
     Fefin       = @;
     Feini       = @;
     Dias        = 0;

     &Tippar      = 0;
     &Parte1      = 0;
     &Parte2      = 0;
     &Muerto      = "";
     &Fecpar      = @;
     &DiaInf      = "";
     &MesNum      = "";
     &MesInf      = "";
     &EjerInf     = "";

     &VEmpresa    = 0;
     &VTipo       = "";
     &NCopia      = 0;
     &VSwCarga    = 0;
     &VTemporal0  = "";
     &VTemporal1  = "";
     &VTemporal2  = "";
     &VTemporal3  = "";
     &VTemporal4  = "";
     &VTemporal5  = "";
     &VTemporal6  = "";
     &VTemporal7  = "";
     &VTemporal8  = "";
     &VTemporal9  = "";
     &VTemporal10 = "";
     &VTemporal11 = "";
     &VTemporal12 = "";
     &VTemporal13 = "";
     &VTemporal14 = "";
     &VTemporal15 = "";
     &VTemporal16 = "";
     &VTemporal17 = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_utilid;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|PROCESO Seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            #0XCampos = 0; |PINTA #0XCampos;
            |CAMPO_MODIFICA #0XCampos, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |CAMPO_MODIFICA #0XCampos, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO SelecTipo;  |TIPO 0;
  Modifica = "S";
  |SI #0Campo = "L";  Modifica = "N";  |FINSI;

  |C_M #0#38, 1, Modifica;
  |C_M #0#39, 1, Modifica;
  |C_M #0#54, 1, Modifica;
  |C_M #0#55, 1, Modifica;

  #0#37 = 1;  |PINTA #0#37;
|FPRC;

|PROCESO TipoPapel;  |TIPO 0;
  |C_M #0#56, 1, "S";
  |SI #0#34 = "L";  |Y #0#55 = "N";
      |C_M #0#56, 1, "N";
  |FINSI;
|FPRC;

||********************************
|| PROCESOS DE LECTURAS Y REPARTOS
||********************************

|PROCESO PonTemporales;
  Valfa = "";  Tempo = "";
  |DFICE Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal1  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal2  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal3  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal4  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal5  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal6  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal7  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal8  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal9  = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal10 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal11 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal12 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal13 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal14 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal15 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal16 = Tempo - Valfa;
  Tempo = "";   |TEMPO Tempo; VTemporal17 = Tempo - Valfa;
|FPRC;

|PROCESO BorraTemporales;
  Valfa = "";  Tempo = "";
  |DFICE Valfa;

  Tempo = Valfa + VTemporal1;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal1 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal1 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal1 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal2;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal2 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal2 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal2 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal3;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal3 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal4;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal4 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal5;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal5 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal6;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal6 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal7;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal7 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal8;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal8 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal8 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal8 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal9;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal9 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal10;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal10 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal11;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal11 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal11 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal11 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal12;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal12 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal13;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal13 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal13 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal13 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal14;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal14 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal14 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal14 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal15;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal15 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal15 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal15 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal16;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal16 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal16 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal16 + ".ixx";  |FBORRA Tempo;

  Tempo = Valfa + VTemporal17;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal17 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal17 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal17 + ".ixx";  |FBORRA Tempo;
|FPRC;

|PROCESO NombreSecuencial;
  Directorio = "";
  |DBASE Directorio;
  Directorio = Directorio + "hacienda";
  |MKDIR Directorio;
  Directorio = Directorio + "/";
  Valfa = Raiz + "bin/agichmod 777 " + Directorio;  |SYSTEM Valfa;

  Fichero = "ab" + (("00000" + #99#0) % -105) + #99#1;

  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;
  NEmpresas  = Directorio + Fichero;
  Tempo      = NEmpresas;
  |FBORRA Tempo;
|FPRC;

|PROCESO GrabaCliente;
  |SI XCampos > 1;  |ACABA;  |FINSI;

  HContribu  = #99#0;
  HNombre    = #99#3;
  HLinea     = 0;
  HPrograma  = "(reemi103) IMPRESION MODELO 103";
  HTipo      = "IMPRESION FICHA";
  HRdto      = #617#24;
  |SI #99#1  = "A"; HPerceptor = "CONJUNTA";    |FINSI;
  |SI #99#1  = "T"; HPerceptor = "TITULAR";     |FINSI;
  |SI #99#1  = "C"; HPerceptor = "CONYUGE";     |FINSI;
  |SI #99#1  = "1"; HPerceptor = "1§ FAMILIAR"; |FINSI;
  |SI #99#1  = "2"; HPerceptor = "2§ FAMILIAR"; |FINSI;
  |SI #99#1  = "3"; HPerceptor = "3§ FAMILIAR"; |FINSI;
  |SI #99#1  = "4"; HPerceptor = "4§ FAMILIAR"; |FINSI;
  |HAZ AltaHistorico;

  |SI #0#55 = "S";
      HPrograma  = "(reemi103) IMPRESION MODELO 102";
      HRdto      = #617#32;
      |HAZ AltaHistorico;
  |FINSI;

  |ABRE #1;
  |LIBERA #1;
  #1#0 = #99#0;
  |LEE 140#1=;
  |SI FSalida ! 0; |CIERRA #1; |ACABA; |FINSI;

  |SI #99#1 = "A";
      #1#124 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#131 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "T";
      #1#125 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#132 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "C";
      #1#126 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#133 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "1";
      #1#127 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#134 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "2";
      #1#128 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#135 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "3";
      #1#129 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#136 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |SI #99#1 = "4";
      #1#130 = "S";
      |SI #0#55 = "S";  |Y #617#22 = " ";
          #1#137 = "S";  |HAZ AltaHistorico;
      |FINSI;
  |FINSI;

  |GRABA 140#1a;
  |LIBERA #1;
  |CIERRA #1;
|FPRC;

|PROCESO CargaHojas;
  VSwCarga = 0;

  |ABRE #1;
  #1#0 = #99#0;
  |LEE 040#1=;
  |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
  |CIERRA #1;

  |SI #1#143 = "S";
      |ABRE #8;
      #8#0 = #1#0;
      |LEE 040#8=;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |CIERRA #8;

      Tippar   = #8#3;
      Muerto   = #8#5;
      |SI #8#3 = 2; Fecpar = #8#4; |SINO; Fecpar = #8#6; |FINSI;
      Feini    = "01.01.1997";
      Fefin    = Fecpar;
      Dias     = Fefin - Feini + 1;
      Parte1   = ((100 * Dias) / 36500) ! 4;
      Parte2   = 1 - Parte1;
      VSwCarga = 1;
  |FINSI;

  |SUB_EJECUTA "rew00010";
  |SUB_EJECUTA "rew00011";
  |SUB_EJECUTA "rew00012";
  |SUB_EJECUTA "rew00013";
  |SUB_EJECUTA "rew00014";
  |SUB_EJECUTA "rew00015";
  |SUB_EJECUTA "rew00016";
  |SUB_EJECUTA "rew00017";
  |SUB_EJECUTA "rew00018";
  |SUB_EJECUTA "rew00019";
  |SUB_EJECUTA "rew00020";
  |SUB_EJECUTA "rew00021";
  |SUB_EJECUTA "rew00022";
  |SUB_EJECUTA "rew00023";
  |SUB_EJECUTA "rew00024";
  |SUB_EJECUTA "rew00025";
  |SUB_EJECUTA "rew00026";
|FPRC;

|PROCESO HojaAHoja;
  |ET Comienzo;

  CFBase    = "";
  |DIRECTORIO CFBase;

  Impresora = NombreImpre;
  CFAbre = Usuario % 810;
  CFAbre = CFBase + "/spool/" + CFAbre + ".spo";
  |FBORRA CFAbre;

  ||PTEC 802;
  |PTEC 802;

  |IMPRE 0;
  |SI FSalida ! 0;
      |MENAV "      Problemas con impresora";
      |FINIMP;
      |VETE Comienzo;
  |FINSI;

  NombreInf = "m103" + "mh" + (("00" + Hoja) % -102);
  |SI Hoja = 17;  NombreInf = "m103mh03";  |FINSI;
  |SI Hoja = 18;  NombreInf = "m102mh01";  |FINSI;

  |INFOR NombreInf;
  |SI FSalida ! 0;  |FINIMP; |ACABA;  |FINSI;

  |PRINT;  |PIEINF;  |FININF;  |FINIMP;

  |CONFI "2400NDesea repetir la hoja : ";
  |SI FSalida = 0; |VETE Comienzo; |FINSI;
|FPRC;

|PROCESO Continuo;
  NombreInf = "m103" + "ch" + (("00" + Hoja) % -102);
  |SI Hoja = 17;  NombreInf = "m103ch03";  |FINSI;
  |SI Hoja = 18;  NombreInf = "m102ch01";  |FINSI;

  |INFOR NombreInf;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |PRINT;  |PIEINF;  |FININF;
|FPRC;

|PROCESO Impresion;
  |SI #0#56 = "H";  |HAZ HojaAHoja;  |FINSI;
  |SI #0#56 = "C";  |HAZ Continuo;   |FINSI;
|FPRC;

|PROCESO Papel;
  |NOME_DAT #601 VTemporal1;
  |NOME_DAT #602 VTemporal2;
  |NOME_DAT #603 VTemporal3;
  |NOME_DAT #604 VTemporal4;
  |NOME_DAT #605 VTemporal5;
  |NOME_DAT #606 VTemporal6;
  |NOME_DAT #607 VTemporal7;
  |NOME_DAT #608 VTemporal8;
  |NOME_DAT #609 VTemporal9;
  |NOME_DAT #610 VTemporal10;
  |NOME_DAT #611 VTemporal11;
  |NOME_DAT #612 VTemporal12;
  |NOME_DAT #613 VTemporal13;
  |NOME_DAT #614 VTemporal14;
  |NOME_DAT #615 VTemporal15;
  |NOME_DAT #616 VTemporal16;
  |NOME_DAT #617 VTemporal17;

  |ABRE #601; #601#0 = 0; |LEE 040#601=; |SI FSalida ! 0; |DDEFECTO #601; |FINSI; |CIERRA #601;
  |ABRE #602; #602#0 = 0; |LEE 040#602=; |SI FSalida ! 0; |DDEFECTO #602; |FINSI; |CIERRA #602;
  |ABRE #603; #603#0 = 0; |LEE 040#603=; |SI FSalida ! 0; |DDEFECTO #603; |FINSI; |CIERRA #603;
  |ABRE #604; #604#0 = 0; |LEE 040#604=; |SI FSalida ! 0; |DDEFECTO #604; |FINSI; |CIERRA #604;
  |ABRE #605; #605#0 = 0; |LEE 040#605=; |SI FSalida ! 0; |DDEFECTO #605; |FINSI; |CIERRA #605;
  |ABRE #606; #606#0 = 0; |LEE 040#606=; |SI FSalida ! 0; |DDEFECTO #606; |FINSI; |CIERRA #606;
  |ABRE #607; #607#0 = 0; |LEE 040#607=; |SI FSalida ! 0; |DDEFECTO #607; |FINSI; |CIERRA #607;
  |ABRE #608; #608#0 = 0; |LEE 040#608=; |SI FSalida ! 0; |DDEFECTO #608; |FINSI; |CIERRA #608;
  |ABRE #609; #609#0 = 0; |LEE 040#609=; |SI FSalida ! 0; |DDEFECTO #609; |FINSI; |CIERRA #609;
  |ABRE #610; #610#0 = 0; |LEE 040#610=; |SI FSalida ! 0; |DDEFECTO #610; |FINSI; |CIERRA #610;
  |ABRE #611; #611#0 = 0; |LEE 040#611=; |SI FSalida ! 0; |DDEFECTO #611; |FINSI; |CIERRA #611;
  |ABRE #612; #612#0 = 0; |LEE 040#612=; |SI FSalida ! 0; |DDEFECTO #612; |FINSI; |CIERRA #612;
  |ABRE #613; #613#0 = 0; |LEE 040#613=; |SI FSalida ! 0; |DDEFECTO #613; |FINSI; |CIERRA #613;
  |ABRE #614; #614#0 = 0; |LEE 040#614=; |SI FSalida ! 0; |DDEFECTO #614; |FINSI; |CIERRA #614;
  |ABRE #615; #615#0 = 0; |LEE 040#615=; |SI FSalida ! 0; |DDEFECTO #615; |FINSI; |CIERRA #615;
  |ABRE #616; #616#0 = 0; |LEE 040#616=; |SI FSalida ! 0; |DDEFECTO #616; |FINSI; |CIERRA #616;
  |ABRE #617; #617#0 = 0; |LEE 040#617=; |SI FSalida ! 0; |DDEFECTO #617; |FINSI; |CIERRA #617;

  #602#042 = #99#7;    #602#043 = #99#3;
  #603#132 = #99#7;    #603#133 = #99#3;
  #604#100 = #99#7;    #604#101 = #99#3;
  #605#102 = #99#7;    #605#103 = #99#3;
  #606#151 = #99#7;    #606#152 = #99#3;
  #607#171 = #99#7;    #607#172 = #99#3;
  #608#121 = #99#7;    #608#122 = #99#3;
  #609#129 = #99#7;    #609#130 = #99#3;
  #610#134 = #99#7;    #610#135 = #99#3;
  #611#053 = #99#7;    #611#054 = #99#3;
  #612#135 = #99#7;    #612#136 = #99#3;
  #613#073 = #99#7;    #613#074 = #99#3;
  #614#052 = #99#7;    #614#053 = #99#3;
  #615#063 = #99#7;    #615#064 = #99#3;
  #616#063 = #99#7;    #616#064 = #99#3;

  |SI #0#38 = "S";  Hoja = 1;   |HAZ Impresion;  |FINSI;
  |SI #0#39 = "S";  Hoja = 2;   |HAZ Impresion;  |FINSI;
  |SI #0#54 = "S";  Hoja = 17;  |HAZ Impresion;  |FINSI;
|FPRC;

|PROCESO Hoja102;
  |NOME_DAT #617 VTemporal17;
  |ABRE #617; #617#0 = 0; |LEE 040#617=; |SI FSalida ! 0; |DDEFECTO #617; |FINSI; |CIERRA #617;

  |SI #617#22 = "X";  |DDEFECTO #617;  |FINSI;
  |SI #617#39 ! 0;    |DDEFECTO #617;  |FINSI;

  Hoja = 18;  |HAZ Impresion;
|FPRC;

|PROCESO Laser;
  VSwCarga = 103;
  |SI #0#38 = "S";  |SUB_EJECUTA "rew00011";  |FINSI;
  |SI #0#39 = "S";  |SUB_EJECUTA "rew00025";  |FINSI;
  |SI #0#54 = "S";  |SUB_EJECUTA "rew00026";  |FINSI;
|FPRC;

|PROCESO ImprimeLos;
  |PINPA #0#90;
  #90#0 = #99#0;  |PINTA #90#0;
  #90#1 = #99#3;  |PINTA #90#1;

  VEmpresa = #99#0;
  VTipo    = #99#1;

  |PARA XCampos = 1; |SI XCampos [ #99#4; |HACIENDO XCampos = XCampos + 1;
        #90#3 = XCampos;  |PINTA #90#3;

        |HAZ PonTemporales;
        |HAZ CargaHojas;
        |HAZ NombreSecuencial;

        |SI #0#34 = "L";  |HAZ Laser;    |FINSI;
        |SI #0#34 = "P";  |HAZ Papel;    |FINSI;
        |SI #0#55 = "S";  |HAZ Hoja102;  |FINSI;
        |HAZ GrabaCliente;

        |HAZ  BorraTemporales;

        NCopia     = NCopia + 1;
  |SIGUE;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, " ", "S";
  99999, "z", "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO CargaFecha;
  DiaInf  = #0#33 % 102;
  MesNum  = #0#33 % 402;
  MesInf  = #0#33 % 402;
  EjerInf = #0#33 % -101;

  |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
  |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
  |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
  |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
  |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
  |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
  |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
  |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
  |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
  |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
  |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
  |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
  |SI #1#142 = "N"; |ACABA; |FINSI;

  |SI #1#103 = "A"; |Y #1#124 = #0#36;
      #99#0 = #1#0;
      #99#1 = "A";
      #99#2 = "CONJUNTA";
      #99#3 = #1#1;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#2;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#104 = "A"; |Y #1#125 = #0#36;
      #99#0 = #1#0;
      #99#1 = "T";
      #99#2 = "TITULAR";
      #99#3 = #1#1;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#2;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#105 = "A"; |Y #1#126 = #0#36;
      #99#0 = #1#0;
      #99#1 = "C";
      #99#2 = "CONYUGE";
      #99#3 = #1#28;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      #99#7 = #1#29;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#106 = "A"; |Y #1#127 = #0#36;
      #99#0 = #1#0;
      #99#1 = "1";
      #99#2 = "1. FAMILIAR";
      Casilla  = 57 + #1#98;    #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla  = 47 + #1#98;    #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#107 = "A"; |Y #1#128 = #0#36;
      #99#0 = #1#0;
      #99#1 = "2";
      #99#2 = "2. FAMILIAR";
      Casilla  = 57 + #1#99;    #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla  = 47 + #1#99;    #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#108 = "A"; |Y #1#129 = #0#36;
      #99#0 = #1#0;
      #99#1 = "3";
      #99#2 = "3. FAMILIAR";
      Casilla  = 57 + #1#100;    #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla  = 47 + #1#100;    #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;

  |SI #1#109 = "A"; |Y #1#130 = #0#36;
      #99#0 = #1#0;
      #99#1 = "4";
      #99#2 = "4. FAMILIAR";
      Casilla  = 57 + #1#101;    #99#3 = #1Casilla;
      #99#4 = #0#37;
      #99#5 = "S";
      #99#6 = 1;
      Casilla  = 47 + #1#101;    #99#7 = #1Casilla;
      |GRABA 040#99n;
      SwEstar = 1;
  |FINSI;
|FPRC;

|DEFBUCLE redatcon;
  #1#1;
  ;
  DEmpre;
  HEmpre;
  ;
  NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
  #99#1 = " ";
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
  #99#1 = "z";
|FRUT;

|PROCESO CargaTempo;
  Valfa = "";
  Tempo = "";
  |DFICE Valfa;
  |TEMPO Tempo; VTemporal0 = Tempo - Valfa; |NOME_DAT #99 VTemporal0;
  |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

  |ABRE #99;
  SwEstar = 0;
  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE redatcon;
  |SINO;
      |PARA XCampos = 3; |SI XCampos [ 32; |HACIENDO XCampos = XCampos + 1;
            |SI #0XCampos ! 0;
                DEmpre = #0XCampos;
                HEmpre = #0XCampos;
                |BUCLE redatcon;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwEstar = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |SI #0#34 = "P";  |O #0#55 = "S";
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      NombreImpre = Impresora;
      |SI #0#56 = "H";  |FINIMP;  |FINSI;
  |FINSI;

  |HAZ CargaFecha;
  |HAZ CargaTempo;

  |SI SwEstar = 0;
      |DFICE Valfa;
      Tempo = Valfa + VTemporal0;           |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".dat";  |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".ddx";  |FBORRA Tempo;
      Tempo = Valfa + VTemporal0 + ".ixx";  |FBORRA Tempo;

      |ACABA;
  |FINSI;

  |BUCLE rew00001;

  |DFICE Valfa;
  Tempo = Valfa + VTemporal0;           |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".dat";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".ddx";  |FBORRA Tempo;
  Tempo = Valfa + VTemporal0 + ".ixx";  |FBORRA Tempo;

  |SI #0#34 = "P";  |O #0#55 = "S";
      |SI #0#56 = "C";   |FINIMP;  |FINSI;
  |FINSI;

  |SI #0#34 = "L";  |HAZ CopiaDisco;  |FINSI;
|FPRC;
