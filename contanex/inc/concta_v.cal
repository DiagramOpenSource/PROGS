|FICHEROS;
   vaticuen #69;
   vaconcta #100;
|FIN;

|VARIABLES;
    &vlong  = 0;
    p_lugar = 0;
    p_cuan3 = 0;
    p_cuan4 = 0;
    p_cuan5 = 0;
    p_alfa1 = "";
    p_alfa2 = "";
    p_alfa3 = "";
    p_alfa4 = "";
    p_alfa5 = "";
    p_alfa6 = "";
    p_nume1 = 0;
    p_nume2 = 0;
    p_ceros = "";
    p_error = 0;
    p_mensa = "    LONGITUD DE CUENTA FUERA DE CONTROL!";
    cuen11 = "";
    cuen21 = "";
    cuen31 = "";
|FIN;


|CALCULO vlong; |TIPO 8;
  |ABRE #100;
  |DDEFECTO #100;
  #100#0 = 1;
  |LEE 000#100=;
  vlong = #100#1;
|FCAL;

|CALCULO punto;
  p_error = 0;
  p_lugar = 0;
  p_cuan3 = 0;
  p_cuan4 = 0;
  p_alfa3 = "";
  p_alfa4 = "";
  p_alfa4 = p_alfa1 > " ";
  p_alfa1 = p_alfa4;
  p_alfa4 = "";
  |PARA p_nume1 = 1; |SI p_nume1 [ 12; |HACIENDO p_nume1 = p_nume1 + 1;
        p_nume2 = (p_nume1 * 100) + 1;
        p_alfa2 = p_alfa1 % p_nume2;
        |SI p_alfa2 ! " ";
            |SI p_alfa2 = ".";
                p_lugar = p_nume1;
            |SINO;
                |SI p_lugar=0; p_alfa3=p_alfa3+p_alfa2; p_cuan3=p_cuan3+1; |FINSI;
                |SI p_lugar!0; p_alfa4=p_alfa4+p_alfa2; p_cuan4=p_cuan4+1; |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |SI p_lugar ! 0;
      p_cuan5 = vlong;
      p_nume1 = p_cuan5 - (p_cuan3 + p_cuan4);
      |SI p_nume1 > 0;
          cuen11 = p_alfa4 % 101;
          p_ceros = "0" * p_nume1;
          p_alfa5 = p_alfa3 + p_ceros + p_alfa4;
          cuen11 = p_alfa4 % 101;
          |SI cuen11 = "U";  |O cuen11 = "A";
              cuen31 = cuen11;
              |HAZ ultialta;
          |FINSI;
          || ....... #0Campo = p_alfa5;
          || ....... |PINTA #0Campo;
      |SINO;
          |MENAV p_mensa;
          p_error = 1;
      |FINSI;
  |SINO;
      p_alfa5 = p_alfa1;
  |FINSI;
|FCAL;

|PROCESO ultialta;
  p_nume2 = p_alfa3;
  p_nume2 = p_nume2 + 1;
  cuen11 = p_nume2;
  #69#0 = cuen11;
  |LEE 021#69];
  |SI FSalida ! 0;
      |LEE 021#69u;
  |SINO;
      |LEE 021#69a;
      |SI FSalida ! 0;
          |LEE 021#69p;
      |FINSI;
  |FINSI;
  cuen21 = p_alfa3 % 0;
  p_nume2 = cuen21;
  p_nume2 = p_nume2 + 100;
  cuen11 = p_nume2;
  cuen21 = #69#0 % cuen11;
  |SI cuen21 = p_alfa3;
      cuen21 = #69#0;
      p_nume2 = cuen21;
      |SI cuen31 = "A";
          p_nume2 = p_nume2 + 1;
      |FINSI;
      p_alfa5 = p_nume2;
  |SINO;
      p_ceros = "0" * p_nume1;
      p_alfa5 = p_alfa3 + p_ceros + "1";
  |FINSI;
  |DDEFECTO #69;
|FPRC;
