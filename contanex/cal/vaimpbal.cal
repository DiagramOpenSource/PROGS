|FICHEROS;
  vaimpbal #0;
  vabala02 #1;   || Activo
  vabala03 #2;   || Pasivo
  vabala04 #3;   || Debe
  vabala05 #4;   || Haber
  vaaccbal #5;

  va8bal02 #11;   || Activo
  va8bal03 #12;   || Pasivo
  va8bal04 #13;   || Debe
  va8bal05 #14;   || Haber
  va8accba #15;
|FIN;

|VARIABLES;

  &hoja1     = 0;
  num1       = 0;
  num2       = 0;
  informe    = "";

  alfa1    = "";
  alfa2    = "";
  fLaFecha = @;

  blancos  = "                                        ";
  nume1    = 0;

  sw_error = 0;
  x = 0;
  y = 0;
  FEstado5 = 0;
  aParam = "";
|FIN;

|INCLUYE dscnex_v;

|| *************************************************************************
||                         CALCULOS DE PANTALLA
|| *************************************************************************

|PROCESO tipo8; |TIPO 8;
 |HAZ vbase;
|FPRC;

|PROCESO Elany; |TIPO 7;
 aParam = PARAMETRO; |QBF aParam;
 enPlan = aParam;
 |SI enPlan ! 2008; enPlan = 1990; |FINSI;
 alfa1 = enPlan;
 |ATRI R; |PINTA 0839, alfa1; |ATRI 0;

 fLaFecha = ~;
 alfa1   = fLaFecha; alfa1 = alfa1 % -104;
 #0#2     = alfa1;
 |PINTA #0#2;
|FPRC;

|PROCESO mayor; |TIPO 0;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;
|FPRC;

|PROCESO leeregi; |TIPO 0;
  |SI dirfich0 ! "*";
      |ABRE #30;
      #30#2 = #0Campo;
      #30#3 = 0;
      |LEE 011#30];
      |SI FSalida ! 0;  |O #30#2 ! #0Campo;
          |MENAV "     NO Existe la Empresa Contable";
          |ERROR;
          |CIERRA #30;
          |ACABA;
      |FINSI;
      |CIERRA #30;
      #0#3 = #30#1;
      |PINTA #0#3;
  |FINSI;
|FPRC;

|CALCULO con_empr; |TIPO 0;
  |SI FSalida ! 9;  |ACABA;  |FINSI;

  |SUB_EJECUTA_NP "vaconemp";
  |ERROR;
  |SI r_emp = 0; |PTEC 808; |ACABA; |FINSI;

  #0#0 = r_emp; |PINTA #0#0;
  #0#1 = r_per;
  #0#2 = r_eje; |PINTA #0#2;
  #0#3 = r_nom; |PINTA #0#3;
  |PTEC 802;
|FCAL;


|PROCESO lee_regpan; |TIPO 0;
 |SI FSalida = 2; |ACABA; |FINSI;
 |HAZ lee_reg;
 |SI sw_error = 0;
      |SI enPlan ! 2008;
          #0#3 = #5#10;  #0#5 = #5#3;
      |SINO;
          #0#3 = #15#10; #0#5 = #15#3;
      |FINSI;
      |PINTA #0#3;
      |PINTA #0#5;
      |HAZ forzar;
 |SINO;
      |MENAV "    No existen Datos para el Balance ";
      |ERROR;
  |FINSI;
|FPRC;

|PROCESO lee_reg; |TIPO 0;
  sw_error = 0;
  |SI enPlan ! 2008;
      |ABRE #5;
      |DDEFECTO #5;
      #5#0 = #0#0;
      #5#1 = #0#2;
      #5#2 = #0#4;
      |LEE 001#5=;
      |SI FSalida = 0;
          #0#3 = #5#10;
          #0#5 = #5#3;
          fec_con = #5#4;
          fec_ant = #5#5;
          tipo = #5#7;
          periodo = #5#9;
      |SINO;
          sw_error = 1;
      |FINSI;
      |CIERRA #5;
  |SINO;
      |ABRE #15;
      |DDEFECTO #15;
      #15#0 = #0#0;
      #15#1 = #0#2;
      #15#2 = #0#4;
      |LEE 001#15=;
      |SI FSalida = 0;
          #0#3 = #15#10;
          #0#5 = #15#3;
          fec_con = #15#4;
          fec_ant = #15#5;
          tipo = #15#7;
          periodo = #15#9;
      |SINO;
          sw_error = 1;
      |FINSI;
      |CIERRA #15;
  |FINSI;
|FPRC;

|PROCESO forzar;
 |SI enPlan ! 2008;
     #0#8 = #5#8;
     |SI #5#7 = "A";
         |CAMPO_MODIFICA #0#8, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#8, 1, "S";
     |FINSI;
 |SINO;
     #0#8 = #15#8;
     |SI #15#7 = "A";
         |CAMPO_MODIFICA #0#8, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#8, 1, "S";
     |FINSI;
 |FINSI;
 |PINTA #0#8;
|FPRC;

|PROCESO repon; |TIPO 0;
 |POPV;
|FPRC;

|PROCESO cuadro; |TIPO 7;
 |C_M #0#8, 0, alfa1;
 |SI alfa1 = "N"; |ACABA; |FINSI;

 |PUSHV 1701 2380;
 |CUADRO 1726 2279;
 |ATRI R;
 |PINTA 1827, " <A> Forzar a Abreviado                             ";
 |PINTA 1927, " <E> Forzar a Extendido                             ";
 |PINTA 2027, " <B> Balance Abreviado, Perd. y Ganancias Extendido ";
 |PINTA 2127, " <P> Balance Extendido, Perd. y Ganancias Abreviado ";
 |ATRI r;
|FPRC;

|| ***********************************************************************

|PROCESO impre; |TIPO 3;
 |HAZ lee_reg;
 |SI sw_error = 1; |ACABA; |FINSI;

 empresa = #0#0;
 anyo    = #0#2;
 nombre  = #0#3;
 registr = #0#4;
 descrip = #0#5;
 fec_act = #0#6;
 fz      = #0#8;

 |IMPRE 0;
 |SI FSalida = 0;
     |HAZ lectura;
 |SINO;
     |MENAV "      Proceso Interrumpido";
 |FINSI;
 |FINIMP;

 |SI #0#7 = "S"; |HAZ graba_bal; |FINSI;

 |HAZ graba_acc;
|FPRC;


|PROCESO lectura;
 |SI enPlan ! 2008;
     |HAZ Lectura_1990;
 |SINO;
     |HAZ Lectura_2008;
 |FINSI;
|FPRC;

|PROCESO Lectura_1990;
 |ABRE #5; #5#0 = empresa; #5#1 = anyo; #5#2 = registr; |LEE 040#5=; |CIERRA #5;
 |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

 |ABRE #1; #1#0 = empresa; #1#1 = anyo; #1#2 = registr; |LEE 040#1=; |CIERRA #1;
 |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

 |ABRE #2; #2#0 = empresa; #2#1 = anyo; #2#2 = registr; |LEE 040#2=; |CIERRA #2;
 |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

 |ABRE #3; #3#0 = empresa; #3#1 = anyo; #3#2 = registr; |LEE 040#3=; |CIERRA #3;
 |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

 |ABRE #4; #4#0 = empresa; #4#1 = anyo; #4#2 = registr; |LEE 040#4=; |CIERRA #4;
 |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

 hoja1 = 1;

 |SI #5#7 = "A"; |HAZ abreviado; |FINSI;
 |SI #5#7 = "E";
    |SI #0#8 = "A"; |HAZ intermedio; |FINSI;
    |SI #0#8 = "E"; |HAZ extenso;    |FINSI;
    |SI #0#8 = "B"; |HAZ tipo_b;     |FINSI;
    |SI #0#8 = "P"; |HAZ tipo_p;     |FINSI;
 |FINSI;
|FPRC;

|PROCESO Lectura_2008;
 |ABRE #15; |DDEFECTO #15;
 #15#0 = empresa; #15#1 = anyo; #15#2 = registr; |LEE 040#15=; |CIERRA #15;

 |ABRE #11; |DDEFECTO #11;
 #11#0 = empresa; #11#1 = anyo; #11#2 = registr; |LEE 040#11=; |CIERRA #11;

 |ABRE #12; |DDEFECTO #12;
 #12#0 = empresa; #12#1 = anyo; #12#2 = registr; |LEE 040#12=; |CIERRA #12;

 |ABRE #13; |DDEFECTO #13;
 #13#0 = empresa; #13#1 = anyo; #13#2 = registr; |LEE 040#13=; |CIERRA #13;

 |ABRE #14; |DDEFECTO #14;
 #14#0 = empresa; #14#1 = anyo; #14#2 = registr; |LEE 040#14=; |CIERRA #14;

 hoja1 = 1;

 |SI #15#7 = "A"; |HAZ abreviado; |FINSI;
 |SI #15#7 = "E";
     |SI #0#8 = "A"; |HAZ intermedio; |FINSI;
     |SI #0#8 = "E"; |HAZ extenso;    |FINSI;
     |SI #0#8 = "B"; |HAZ tipo_b;     |FINSI;
     |SI #0#8 = "P"; |HAZ tipo_p;     |FINSI;
 |FINSI;
|FPRC;

|| -------------------------------------------------- CALCULOS

|PROCESO intermedio;
 |SI enPlan ! 2008;
    #3#84 = #3#84 - #3#89;
    #3#45 = #3#45 - #3#50;
    #3#6  = #3#6  - #3#11;

    #3#85 = #3#85 + #3#86 - #3#89;
    #3#46 = #3#46 + #3#47 - #3#50;
    #3#7  = #3#7  + #3#8  - #3#11;

    #4#82 = #4#82 - #4#88;
    #4#44 = #4#44 - #4#50;
    #4#6  = #4#6  - #4#12;

    #4#90 = #4#90 + #4#89;
    #4#52 = #4#52 + #4#51;
    #4#14 = #4#14 + #4#13;

    #4#83 = #4#84 + #4#90;
    #4#45 = #4#46 + #4#52;
    #4#7  = #4#8  + #4#14;

    #4#95 = #4#96  + #4#100 + #4#104;
    #4#97 = #4#97  + #4#101 + #4#105;
    #4#98 = #4#98  + #4#102 + #4#106;
    #4#107= #4#107 + #4#99  + #4#103;

    #4#57 = #4#58 + #4#62 + #4#66;
    #4#59 = #4#59 + #4#63 + #4#67;
    #4#60 = #4#60 + #4#64 + #4#68;
    #4#69 = #4#69 + #4#61 + #4#65;

    #4#19 = #4#20 + #4#24 + #4#28;
    #4#21 = #4#21 + #4#25 + #4#29;
    #4#22 = #4#22 + #4#26 + #4#30;
    #4#31 = #4#31 + #4#23 + #4#27;
 |FINSI;
 |HAZ abreviado;
|FPRC;

|PROCESO abreviado;
 |SI enPlan ! 2008;
       informe = "vainabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |SINO;
       informe = "va8iabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |FINSI;
|FPRC;

|PROCESO extenso;
 |SI enPlan ! 2008;
       informe = "vainext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext7"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext8"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext9"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |SINO;
       informe = "va8iext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

       informe = "va8iext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |FINSI;
|FPRC;

|PROCESO tipo_b;
 |SI enPlan ! 2008;
       #3#84 = #3#84 - #3#89;
       #3#45 = #3#45 - #3#50;
       #3#6  = #3#6  - #3#11;

       #3#85 = #3#85 + #3#86 - #3#89;
       #3#46 = #3#46 + #3#47 - #3#50;
       #3#7  = #3#7  + #3#8  - #3#11;

       informe = "vainabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext7"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext8"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext9"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |SINO;

       informe = "va8iabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

       informe = "va8iext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |FINSI;
|FPRC;

|PROCESO tipo_p;
 |SI enPlan ! 2008;
       #4#82 = #4#82 - #4#88;
       #4#44 = #4#44 - #4#50;
       #4#6  = #4#6  - #4#12;

       #4#90 = #4#90 + #4#89;
       #4#52 = #4#52 + #4#51;
       #4#14 = #4#14 + #4#13;

       #4#83 = #4#84 + #4#90;
       #4#45 = #4#46 + #4#52;
       #4#7  = #4#8  + #4#14;

       #4#95 = #4#96  + #4#100 + #4#104;
       #4#97 = #4#97  + #4#101 + #4#105;
       #4#98 = #4#98  + #4#102 + #4#106;
       #4#107= #4#107 + #4#99  + #4#103;

       #4#57 = #4#58 + #4#62 + #4#66;
       #4#59 = #4#59 + #4#63 + #4#67;
       #4#60 = #4#60 + #4#64 + #4#68;
       #4#69 = #4#69 + #4#61 + #4#65;

       #4#19 = #4#20 + #4#24 + #4#28;
       #4#21 = #4#21 + #4#25 + #4#29;
       #4#22 = #4#22 + #4#26 + #4#30;
       #4#31 = #4#31 + #4#23 + #4#27;

       informe = "vainext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vainabr4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |SINO;
       informe = "va8iext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8iext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

       informe = "va8iabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
 |FINSI;
|FPRC;

|| ********************************************************************
|| -------------------------- Pasar Actual a Anterior.
|PROCESO graba_bal;
 |SI enPlan ! 2008;
     |HAZ graba_bal_1990;
 |SINO;
     |HAZ graba_bal_2008;
 |FINSI;
|FPRC;

|PROCESO graba_bal_1990;
 |ABRE #1;
 #1#0 = empresa;
 #1#1 = anyo;
 #1#2 = registr;
 |LEE 040#1=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 69; |HACIENDO x = x + 1;
           y = x + 64;
           #1x = #1y;
     |SIGUE;
     #1#134 = #1#135;
     |GRABA 020#1a;
     |LIBERA #1;
 |FINSI;
 |CIERRA #1;

 |ABRE #2;
 #2#0 = empresa;
 #2#1 = anyo;
 #2#2 = registr;
 |LEE 040#2=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 78; |HACIENDO x = x + 1;
           y = x + 73;
           #2x = #2y;
     |SIGUE;
     #2#153 = #2#152; #2#155 = #2#154;
     |GRABA 020#2a;
     |LIBERA #2;
 |FINSI;
 |CIERRA #2;

 |ABRE #3;
 #3#0 = empresa;
 #3#1 = anyo;
 #3#2 = registr;
 |LEE 040#3=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 44; |HACIENDO x = x + 1;
           y = x + 39;
           #3x = #3y;
     |SIGUE;
     |GRABA 020#3a;
     |LIBERA #3;
 |FINSI;
 |CIERRA #3;

 |ABRE #4;
 #4#0 = empresa;
 #4#1 = anyo;
 #4#2 = registr;
 |LEE 040#4=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 43; |HACIENDO x = x + 1;
           y = x + 38;
           #4x = #4y;
     |SIGUE;
     |GRABA 020#4a;
     |LIBERA #4;
 |FINSI;
 |CIERRA #4;
|FPRC;

|PROCESO graba_bal_2008;
 |ABRE #11;
 #11#0 = empresa;
 #11#1 = anyo;
 #11#2 = registr;
 |LEE 040#11=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 69; |HACIENDO x = x + 1;
           y = x + 64;
           #11x = #11y;
     |SIGUE;
     |PARA x = 198; |SI x [ 207; |HACIENDO x = x + 1;
           y = x + 10;
           #11x = #11y;
     |SIGUE;
     |GRABA 020#11a;
     |LIBERA #11;
 |FINSI;
 |CIERRA #11;

 |ABRE #12;
 #12#0 = empresa;
 #12#1 = anyo;
 #12#2 = registr;
 |LEE 040#12=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 64; |HACIENDO x = x + 1;
           y = x + 59;
           #12x = #12y;
     |SIGUE;
     |GRABA 020#12a;
     |LIBERA #12;
 |FINSI;
 |CIERRA #12;

 |ABRE #13;
 #13#0 = empresa;
 #13#1 = anyo;
 #13#2 = registr;
 |LEE 040#13=;
 |SI FSalida = 0;
     |PARA x = 6; |SI x [ 60; |HACIENDO x = x + 1;
           y = x + 55;
           #13x = #13y;
     |SIGUE;
     #13#171 = #13#173;
     #13#172 = #13#174;
     |GRABA 020#13a;
     |LIBERA #13;
 |FINSI;
 |CIERRA #13;

 |ABRE #14;
 #14#0 = empresa;
 #14#1 = anyo;
 #14#2 = registr;
 |LEE 040#14=;
 |SI FSalida = 0;
     |GRABA 020#14a;
     |LIBERA #14;
 |FINSI;
 |CIERRA #14;
|FPRC;
|| ********************************************************************

|PROCESO graba_acc; || Actualizar Acceso.
   |SI #0#7 = "S";
        fec_ant = fec_act;
   |FINSI;

   |SI enPlan ! 2008;
       |ABRE #5;               || Acceso
       #5#0 = empresa;
       #5#1 = anyo;
       #5#2 = registr;
       |LEE 040#5=;
       FEstado5 = FSalida;

       #5#0 = empresa;
       #5#1 = anyo;
       #5#2 = registr;
       #5#3 = descrip;
       #5#4 = fec_con;
       #5#5 = fec_ant;
       #5#6 = fec_act;
       #5#7 = tipo;
       #5#8 = fz;
       #5#9 = periodo;
       #5#10= nombre;

       |SI FEstado5 = 0; |GRABA 020#5a; |SINO; |GRABA 020#5n; |FINSI;
       |CIERRA #5;
  |SINO;
       |ABRE #15;               || Acceso
       #15#0 = empresa;
       #15#1 = anyo;
       #15#2 = registr;
       |LEE 040#15=;
       FEstado5 = FSalida;

       #15#0 = empresa;
       #15#1 = anyo;
       #15#2 = registr;
       #15#3 = descrip;
       #15#4 = fec_con;
       #15#5 = fec_ant;
       #15#6 = fec_act;
       #15#7 = tipo;
       #15#8 = fz;
       #15#9 = periodo;
       #15#10= nombre;

       |SI FEstado5 = 0; |GRABA 020#15a; |SINO; |GRABA 020#15n; |FINSI;
       |CIERRA #15;
  |FINSI;
|FPRC;
