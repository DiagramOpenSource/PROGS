|FICHEROS;
  vaexicon #0;
|FIN;

|VARIABLES;
  desmes = 0;
  hasmes = 0;
   alfa1 = "";
   alfa2 = "";
|FIN;

|INCLUYE dscnex_v;

|CALCULO lee_existenci1;
  |DDEFECTO #vaexicon;
  #vaexicon#0  = #caexistl#1;
  #vaexicon#1  = #caexistl#2;
  #vaexicon#2  = #caexistl#3;
  #vaexicon#3  = #caexistl#4;
  #vaexicon#4  = (#caexistl#11 / enConversor) ! EURODBMOD;
  #vaexicon#5  = (#caexistl#desmes# / enConversor) ! EURODBMOD;
  #vaexicon#6  = (#caexistl#hasmes# / enConversor) ! EURODBMOD;
  |GRABA 020#vaexicon.n;
  |LIBERA #vaexicon;
|FCAL;

|DEFBUCLE lee_existencia;
 #caexistl#1;
 ;
 estru,0;
 estru,99;
 be;
 NULL,lee_existenci1;
|FIN;

|PROCESO gra_existenci1;
  #vaexicon#0 = #caexistl#1;
  |LIBERA #vaexicon;
  |LEE 140#vaexicon.=;
  #caexistl#11      = (#vaexicon#4 * enConversor) ! enRedonPaYa;
  #caexistl#desmes# = (#vaexicon#5 * enConversor) ! enRedonPaYa;
  #caexistl#hasmes# = (#vaexicon#6 * enConversor) ! enRedonPaYa;
  |GRABA 140#caexistl.a;
  |LIBERA #caexistl;
|FPRC;

|DEFBUCLE gra_existencia;
 #caexistl#1;
 ;
 estru,0;
 estru,99;
 be;
 NULL,gra_existenci1;
|FIN;

|CALCULO min;
  #vaexicon#0 = 1;
|FCAL;

|CALCULO max;
  #vaexicon#0 = 99;
|FCAL;

|PROGRAMA;

  |HAZ EnConversor;

  |ATRI P;  |MENSA "    Cargando Opcion ...";  |ATRI 0;

  |PATH_DAT #22 dirfich;
  |PATH_DAT #21 dirfich;
  |PATH_DAT #20 dirfich;

  |DELINDEX #vaexicon;
  |ABRE #vaexicon;
  desmes = d_mes + 11;
  hasmes = h_mes + 11;
  |BUCLE lee_existencia;
  |CIERRA #vaexicon;

  |ABRE #caexistc;
  |DDEFECTO #caexistc;
  #caexistc#0 = estru;
  |LEE 001#caexistc.=;
  |CIERRA #caexistc;

  |BLIN 4;
  |PINPA #0#vaexicon;
  |ATRI I;
  |PINTA 0713, r_emp;
  |PINTA 0719, r_per;
  |PINTA 0721, r_nom;
  |PINTA 0774, r_eje;
  |PINTA 0818, #caexistc#0;
  |PINTA 0822, #caexistc#1;
  |ATRI 0;
  |ENTLINEAL #1#vaexicon, -1, 4, 22, 0, min, max;
  |ABRE #vaexicon;
  |BUCLE gra_existencia;
  |CIERRA #vaexicon;
  |DELINDEX #vaexicon;
|FPRO;

|PROCESO esbaja;  |TIPO 11;
  |SI FSalida ! 9;  |ACABA;  |FINSI;
  |LIBERA #vaexicon;
  |LEE 140#vaexicon.=;
|ET campo1;
  |ENCAMPO #5#vaexicon;
  |SI FSalida = 9;
      |ENCAMPO #4#vaexicon;
      |SI FSalida = 7;
         |HAZ repinta;
         |ACABA;
      |FINSI;
      |VETE campo1;
  |FINSI;
  |SI FSalida = 10;
      |HAZ planconta;
      |VETE campo1;
  |FINSI;
  |SI FSalida = 7;
      |HAZ repinta;
      |ACABA;
  |FINSI;
  |SI FSalida = 2;  |VETE campo1;  |FINSI;
  |ENCAMPO #6#vaexicon;
  |SI FSalida = 7;
      |HAZ repinta;
      |ACABA;
  |FINSI;
  |SI FSalida = 2;  |VETE campo1;  |FINSI;
  |GRABA 140#vaexicon.a;
  |LIBERA #vaexicon;
|FPRC;

|PROCESO repinta;
  |LIBERA #vaexicon;
  |LEE 140#vaexicon.=;
  |PINTA #vaexicon#0;
  |PINTA #vaexicon#1;
  |PINTA #vaexicon#3;
  |PINTA #vaexicon#4;
  |PINTA #vaexicon#5;
  |PINTA #vaexicon#6;
|FPRC;

|PROCESO planconta;
  |ABRE #cacuenta;
  #cacuenta#0 = #vaexicon#1;
  #cacuenta#1 = #vaexicon#2;
  |LEE 140#cacuenta.=;
  #caexistl#11 = #cacuenta#9;
  #caexistl#12 = #cacuenta#12;
  #caexistl#13 = #cacuenta#15;
  #caexistl#14 = #cacuenta#18;
  #caexistl#15 = #cacuenta#21;
  #caexistl#16 = #cacuenta#24;
  #caexistl#17 = #cacuenta#27;
  #caexistl#18 = #cacuenta#30;
  #caexistl#19 = #cacuenta#33;
  #caexistl#20 = #cacuenta#36;
  #caexistl#21 = #cacuenta#39;
  #caexistl#22 = #cacuenta#42;
  #caexistl#23 = #cacuenta#45;
  #caexistl#24 = #cacuenta#48;
  #vaexicon#4  = (#caexistl#11      / enConversor) ! EURODBMOD;
  #vaexicon#5  = (#vaexicon#desmes# / enConversor) ! EURODBMOD;
  #vaexicon#6  = (#vaexicon#hasmes# / enConversor) ! EURODBMOD;
  |PINTA #vaexicon#4;
  |PINTA #vaexicon#5;
  |PINTA #vaexicon#6;
  |LIBERA #cacuenta;
  |CIERRA #cacuenta;
|FPRC;
