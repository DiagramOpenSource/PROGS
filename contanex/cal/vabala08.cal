|INCLUYE dscnex_v;
|FICHEROS;
   vabala08 #0;
   vabala02 #1;   || Activo
   vabala03 #2;   || Pasivo
   vabala04 #3;   || Debe
   vabala05 #4;   || Haber
   vaaccbal #5;
|FIN;

|VARIABLES;

  &hoja1     = 0;
  &colm      = "";
  num1       = 0;
  num2       = 0;
  informe    = "";
  alfa1      = "";
|FIN;

|PROCESO mayor;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;

|PROGRAMA;
 |DDEFECTO #0;
 |PINPA #0#0;
 |PINDA #0#0;
 |ENDATOS #1#0;
 |SI FSalida = 0;
     |HAZ impresio;
 |FINSI;
|FPRO;

|PROCESO impresio;
 |IMPRE 0;
 |SI FSalida = 0;
     |HAZ lectura;
 |SINO;
     |MENAV "      Proceso Interrumpido";
 |FINSI;
 |FINIMP;
|FPRC;

|PROCESO lectura;

 |ABRE #5; #5#0 = empresa; #5#1 = anyo; #5#2 = registr; |LEE 040#5=; |CIERRA #5;
 |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

 |ABRE #1; #1#0 = empresa; #1#1 = anyo; #1#2 = registr; |LEE 040#1=; |CIERRA #1;
 |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

 |ABRE #2; #2#0 = empresa; #2#1 = anyo; #2#2 = registr; |LEE 040#2=; |CIERRA #2;
 |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

 |ABRE #3; #3#0 = empresa; #3#1 = anyo; #3#2 = registr; |LEE 040#3=; |CIERRA #3;
 |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

 |ABRE #4; #4#0 = empresa; #4#1 = anyo; #4#2 = registr; |LEE 040#4=; |CIERRA #4;
 |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

 hoja1 = 1;
 colm = "CONTABILIDAD";
 |SI #0#0 = "A";
     |PARA num1 = 137; |SI num1 [ 200; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 131;
           #1num1 = #1num2;
     |SIGUE;
     #1#136 = #1#134;
     |PARA num1 = 158; |SI num1 [ 230; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 152;
           #2num1 = #2num2;
     |SIGUE;
     #2#156 = #2#153; #2#157 = #2#155;
     |PARA num1 = 84; |SI num1 [ 122; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 78;
           #3num1 = #3num2;
     |SIGUE;
     |PARA num1 = 82; |SI num1 [ 119; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 76;
           #4num1 = #4num2;
     |SIGUE;
     colm = " ANTERIORES ";
     #5#4 = #5#5;
 |FINSI;
 |SI #5#7 = "A"; |HAZ abreviado; |FINSI;
 |SI #5#7 = "E";
    |SI #5#8 = "A"; |HAZ intermedio; |FINSI;
    |SI #5#8 = "E"; |HAZ extenso;    |FINSI;
    |SI #5#8 = "B"; |HAZ tipo_b;     |FINSI;
    |SI #5#8 = "P"; |HAZ tipo_p;     |FINSI;
 |FINSI;
|FPRC;

|| -------------------------------------------------- CALCULOS

|PROCESO intermedio;
#3#84 = #3#84 - #3#89;
#3#45 = #3#45 - #3#50;
#3#6  = #3#6  - #3#11;

#3#85 = #3#85 + #3#86 - #3#89;
#3#46 = #3#46 + #3#47 - #3#50;
#3#7  = #3#7  + #3#8  - #3#11;

#4#82 = #4#82 - #4#88;
#4#44 = #4#44 - #4#50;
#4#6  = #4#6  - #4#12;

#4#90 = #4#90 + #4#89;
#4#52 = #4#52 + #4#51;
#4#14 = #4#14 + #4#13;

#4#83 = #4#84 + #4#90;
#4#45 = #4#46 + #4#52;
#4#7  = #4#8  + #4#14;

#4#95 = #4#96  + #4#100 + #4#104;
#4#97 = #4#97  + #4#101 + #4#105;
#4#98 = #4#98  + #4#102 + #4#106;
#4#107= #4#107 + #4#99  + #4#103;

#4#57 = #4#58 + #4#62 + #4#66;
#4#59 = #4#59 + #4#63 + #4#67;
#4#60 = #4#60 + #4#64 + #4#68;
#4#69 = #4#69 + #4#61 + #4#65;

#4#19 = #4#20 + #4#24 + #4#28;
#4#21 = #4#21 + #4#25 + #4#29;
#4#22 = #4#22 + #4#26 + #4#30;
#4#31 = #4#31 + #4#23 + #4#27;

|HAZ abreviado;
|FPRC;

|PROCESO abreviado;
       informe = "vabaabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO extenso;
       informe = "vabaext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext7"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext8"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext9"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO tipo_b;
#3#84 = #3#84 - #3#89;
#3#45 = #3#45 - #3#50;
#3#6  = #3#6  - #3#11;

#3#85 = #3#85 + #3#86 - #3#89;
#3#46 = #3#46 + #3#47 - #3#50;
#3#7  = #3#7  + #3#8  - #3#11;

       informe = "vabaabr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext7"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext8"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext9"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO tipo_p;
#4#82 = #4#82 - #4#88;
#4#44 = #4#44 - #4#50;
#4#6  = #4#6  - #4#12;

#4#90 = #4#90 + #4#89;
#4#52 = #4#52 + #4#51;
#4#14 = #4#14 + #4#13;

#4#83 = #4#84 + #4#90;
#4#45 = #4#46 + #4#52;
#4#7  = #4#8  + #4#14;

#4#95 = #4#96  + #4#100 + #4#104;
#4#97 = #4#97  + #4#101 + #4#105;
#4#98 = #4#98  + #4#102 + #4#106;
#4#107= #4#107 + #4#99  + #4#103;

#4#57 = #4#58 + #4#62 + #4#66;
#4#59 = #4#59 + #4#63 + #4#67;
#4#60 = #4#60 + #4#64 + #4#68;
#4#69 = #4#69 + #4#61 + #4#65;

#4#19 = #4#20 + #4#24 + #4#28;
#4#21 = #4#21 + #4#25 + #4#29;
#4#22 = #4#22 + #4#26 + #4#30;
#4#31 = #4#31 + #4#23 + #4#27;

       informe = "vabaext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "vabaabr5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

|FPRC;
