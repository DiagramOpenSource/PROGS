|| lee la empresa y carga niveles            || numero 0
|INCLUYE dscnex_v;

|PROCESO EjerCCAA;
    enEjerBal = #409#0;
|FPRC;

|DEFBUCLE EjerCCAA;
    #409#1;
    ;
    2008;
    enEjercicio;
    e;
    NULL, EjerCCAA;
|FIN;

|PROCESO inicio; |TIPO 8;
  swerror = 0;
  |QBF fich_alta;
  empresa = fich_alta;

  cod_emp1 = empresa  % -107;
  cod_emp2 = cod_emp1 %  106;
  clave1 = cod_emp2 %  105;
  clave2 = cod_emp2 % -101;
  cod1 = clave1;   empre = cod1;
  cod2 = clave2;   ejerc = cod2;
  |ABRE #30;
  #30#2 = cod1;
  #30#3 = cod2;
  |LEE 040#30=;
  |SI FSalida ! 0;
      swerror = 1;
      |ACABA;
  |FINSI;
  dig1 = #30#11;       || desde mes
  dig3 = #30#13;       || nro. niveles
  dig4 = #30#14;       || 1 nivel
  dig5 = #30#15;       || 2 nivel
  dig6 = #30#16;       || 3 nivel
  dig7 = #30#17;       || 4 nivel
  dig8 = #30#18;       || 5 nivel
  dig9 = #30#19;       || 6 nivel
  |CIERRA #30;
  clave2 = #30#26;
  cod2 = #30#26;
  tra1 = 100 + #30#11;
  mes1 = tra1 % -102;
  |SI cod2 < 80;
        work1 = "01." + mes1 + ".20" + clave2;
        enEjercicio = 2000 + #canempre#26;
  |SINO;
        work1 = "01." + mes1 + ".19" + clave2;
        enEjercicio = 1900 + #canempre#26;
  |FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
    |SI #30#11 > #30#12;  cod2 = cod2 + 1; |FINSI;
    dia1 = "31";
    |SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
    |FINSI;
    |SI #30#12 = 2;
        dia1 = "28";
       |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
           dia1 = "29";
       |FINSI;
    |FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
    |SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
    |SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
    |FINSI;
    fec2 = work1;

    enEmpresa   = #30#2;
    eaNombreEmp = #30#1;
    eaDepar     = #30#24;
    eaSubde     = #30#22;
    enEjerBal   = 2008;
    |BUCLE EjerCCAA;
|FPRC;

|PROCESO leelo;
swerror = 0;
|ABRE #30;
    #30#2 = cod1;
    #30#3 = cod2;
|LEE 040#30=;
|SI FSalida ! 0;
    swerror = 1;
    |CIERRA #30;
    |ERROR;
    |ACABA;
|FINSI;

    dig1 = #30#11;
    dig3 = #30#13;
    dig4 = #30#14;
    dig5 = #30#15;
    dig6 = #30#16;
    dig7 = #30#17;
    dig8 = #30#18;
    dig9 = #30#19;
|CIERRA #30;
    clave2 = #30#26;
    cod2 = #30#26;
    tra1 = 100 + #30#11;
    mes1 = tra1 % -102;
|SI cod2 < 80;
      work1 = "01." + mes1 + ".20" + clave2;
      enEjercicio = 2000 + #canempre#26;
|SINO;
      work1 = "01." + mes1 + ".19" + clave2;
      enEjercicio = 1900 + #canempre#26;
|FINSI;
    fec1 = work1;
    tra1 = 100 + #30#12;
    mes1 = tra1 % -102;
|SI #30#11 > #30#12;
        cod2 = cod2 + 1;
|FINSI;
    dia1 = "31";
|SI #30#12 = 4; |O #30#12 = 6; |O #30#12 = 9; |O #30#12 = 11;
        dia1 = "30";
|FINSI;
|SI #30#12 = 2;
        dia1 = "28";
    |SI cod2 = 88; |O cod2 = 92; |O cod2 = 96; |O cod2 = 0; |O cod2 = 4;
            dia1 = "29";
    |FINSI;
|FINSI;
    tra1 = 100 + cod2;
    clave2 = tra1 % -102;
|SI cod2 < 80;
        work1 = dia1 + "." + mes1 + ".20" + clave2;
|SINO;
        work1 = dia1 + "." + mes1 + ".19" + clave2;
|FINSI;
    fec2 = work1;

   enEmpresa   = #30#2;
   eaNombreEmp = #30#1;
   eaDepar     = #30#24;
   eaSubde     = #30#22;
   enEjerBal = 2008;
   |BUCLE EjerCCAA;
|FPRC;
