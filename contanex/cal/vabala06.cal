|FICHEROS;
   vabala04 #0;
   vabala05 #1;
|FIN;

|VARIABLES;
   FEstado1 = 0;
   FEstado2 = 0;
   el142    = 0;
|FIN;

|INCLUYE dscnex_v;

|PROGRAMA;
 |PINTA 2430, "Calculando ...";
 |HAZ  abertura;
 |PINTA 2430, "              ";
|FPRO;

|PROCESO abertura;
 |ABRE #0;
 |ABRE #1;

#0#0 = empresa; #0#1 = anyo; #0#2 = registr;
|LIBERA #0;
|LEE 110#0=;
|SI FSalida = 0;
    FEstado1 = 0;
|SINO;
    |DDEFECTO #0;
    FEstado1 = 1;
    #0#0 = empresa; #0#1 = anyo; #0#2 = registr;
|FINSI;

#1#0 = empresa; #1#1 = anyo; #1#2 = registr;
|LIBERA #1;
|LEE 110#1=;
|SI FSalida = 0;
    FEstado2 = 0;
|SINO;
    |DDEFECTO #1;
    FEstado2 = 1;
    #1#0 = empresa; #1#1 = anyo; #1#2 = registr;
|FINSI;

|HAZ calculo;

|SI FEstado1 = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
|SI FEstado2 = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
 |LIBERA #0;
 |LIBERA #1;
|CIERRA #0;
|CIERRA #1;
|FPRC;

|PROCESO calculo;

#1#056 = 0; #1#072 = 0; #1#073 = 0; #1#079 = 0; #1#080 = 0; #1#081 = 0;

|SI #0#5 = "E";
    #0#064 = #1#046 + #1#050 + #1#051 + #1#052;
|SINO;
    #0#064 = #1#045;
|FINSI;
#0#064 = #0#064 - (#0#046 + #0#047 + #0#051 + #0#054 + #0#055 + #0#059);
|SI #0#064 < 0; #1#056 = -#0#064; #0#064 = 0; |FINSI;

|SI #0#5 = "E";
    #0#072 = #1#058 + #1#062 + #1#066 + #1#071;
|SINO;
    #0#072 = #1#057 + #1#071;
|FINSI;
#0#072 = #0#072 - (#0#065 + #0#070 + #0#071);
|SI #0#072 < 0; #1#072 = -#0#072; #0#072 = 0; |FINSI;

#0#073 = #0#064 + #0#072 - #1#056 - #1#072;
|SI #0#073 < 0; #1#073 = -#0#073; #0#073 = 0; |FINSI;

#0#079 = #1#074 +  #1#075 + #1#076 + #1#077 + #1#078;
#0#079 = #0#079 - (#0#074 + #0#075 + #0#076 + #0#077 + #0#078);
|SI #0#079 < 0; #1#079 = -#0#079; #0#079 = 0; |FINSI;

#0#080 = #0#073 + #0#079 - #1#073 - #1#079;
|SI #0#080 < 0; #1#080 = -#0#080; #0#080 = 0; |FINSI;

|SI #0#081 < 0; el142 = -#0#081; |SINO; el142 = #0#081; |FINSI;

|SI #0#80 ! 0;
    #0#083 = #0#080 - #0#81 - #0#082;
    |SI #0#083 < 0; #1#81 = -#0#83; #0#083 = 0; |FINSI;
|SINO;
    #0#83 = 0;
|FINSI;

|SI #1#080 ! 0; |O #0#80 = 0;
    #1#081 = #1#080 + #0#081 + #0#082;
    |SI #1#081 < 0; #0#83 = -#1#81; #1#081 = 0; |FINSI;
|FINSI;

|FPRC;
