|FICHEROS;
   va8bal04 #0;
|FIN;

|VARIABLES;
   x        = 0;
   tecla    = "";
   ntecla   = 0;
   avance   = "815";
   atras    = "814";
   FEstado  = 0;
|FIN;

|INCLUYE dscnex_v;

|PROGRAMA;
 |ABRE #0;
 |PINPA #0#0;
 |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
 |SI modo = 4; |HAZ consulta; |FINSI;
|FPRO;

|PROCESO pidedato;
 #0#0 = empresa;
 #0#1 = anyo;
 #0#2 = registr;
 |LEE 110#0=;
 FEstado = FSalida;
 |SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; #0#2 = registr; |FINSI;
 |PINDA #0#0;
 |SI modo = 1; |HAZ nomodi; |ENDATOS #1#0; |FINSI;
 |SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;
 |SI FSalida = 0;
     #0#0 = empresa;
     #0#1 = anyo;
     #0#2 = registr;
     #0#5 = tipo;
     |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
     |LIBERA #0;
 |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
 avance = &255 + avance;
 atras  = &255 + atras;
 #0#0   = empresa;
 #0#1   = anyo;
 #0#2 = registr;
 |LEE 040#0=;
 |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
 |PINPA #0#0;
 |PINDA #0#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
 |PINPA #1#0;
 |PINDA #1#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
 |PINPA #2#0;
 |PINDA #2#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
 |PINPA #3#0;
 |PINDA #3#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
 |PINPA #4#0;
 |PINDA #4#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla6;
 |PINPA #5#0;
 |PINDA #5#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla5; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla1; |ACABA; |FINSI;
|FPRC;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************

|PROCESO nomodi;
 |SI tipo   = "A"; |HAZ nomoabre; |FINSI;
 |SI tipo   = "E"; |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO nomoabre;
 |C_M #0#063,1,"N"; |C_M #0#064,1,"N";

 |C_M #0#068,1,"N"; |C_M #0#069,1,"N";
 |C_M #0#070,1,"N"; |C_M #0#071,1,"N";

 |C_M #0#073,1,"N"; |C_M #0#074,1,"N";

 |C_M #0#076,1,"N"; |C_M #0#077,1,"N";
 |C_M #0#078,1,"N";

 |C_M #0#080,1,"N"; |C_M #0#081,1,"N";
 |C_M #0#082,1,"N"; |C_M #0#083,1,"N";

 |C_M #0#088,1,"N"; |C_M #0#089,1,"N";

 |C_M #0#092,1,"N"; |C_M #0#093,1,"N";
 |C_M #0#094,1,"N"; |C_M #0#095,1,"N";
 |C_M #0#096,1,"N"; |C_M #0#097,1,"N";

 |C_M #0#099,1,"N"; |C_M #0#100,1,"N";
 |C_M #0#101,1,"N";

 |C_M #0#103,1,"N"; |C_M #0#104,1,"N";

 |C_M #0#107,1,"N"; |C_M #0#108,1,"N";

 |C_M #0#173,1,"N";
|FPRC;

|PROCESO nomoexte;
 |C_M #0#062,1,"N"; |C_M #0#067,1,"N";
 |C_M #0#072,1,"N"; |C_M #0#075,1,"N";

 |C_M #0#079,1,"N"; |C_M #0#087,1,"N";

 |C_M #0#091,1,"N"; |C_M #0#092,1,"N";
 |C_M #0#095,1,"N";

 |C_M #0#098,1,"N"; |C_M #0#102,1,"N";
 |C_M #0#106,1,"N";

 |C_M #0#112,1,"N";
 |C_M #0#113,1,"N";
 |C_M #0#115,1,"N";
|FPRC;

|PROCESO totales; |TIPO 0;
 #0#61 = 0;
 |SI tipo = "E";
     #0#062 = #0#063 + #0#064;                   |PINTA #0#062;
     #0#067 = #0#068 + #0#069 + #0#070 + #0#071; |PINTA #0#067;
     #0#072 = #0#073 + #0#074;                   |PINTA #0#072;
     #0#075 = #0#076 + #0#077 + #0#078;          |PINTA #0#075;
     #0#079 = #0#080 + #0#081 + #0#082 + #0#083; |PINTA #0#079;
     #0#087 = #0#088 + #0#089;                   |PINTA #0#087;

     #0#092 = #0#093 + #0#094; |PINTA #0#092;
     #0#095 = #0#096 + #0#097; |PINTA #0#095;
     #0#091 = #0#092 + #0#095; |PINTA #0#091;

     #0#098 = #0#099 + #0#100 + #0#101; |PINTA #0#098;

     #0#102 = #0#103 + #0#104; |PINTA #0#102;

     #0#106 = #0#107 + #0#108; |PINTA #0#106;
 |FINSI;

 #0#090 = #0#062 + #0#065 + #0#066 + #0#067 + #0#072 + #0#075 + #0#079 + #0#084 + #0#085 + #0#086 + #0#087 + #0#0173 +  #0#174; ||A1
 #0#109 = #0#091 + #0#098 + #0#102 + #0#105 + #0#106;   ||A2-B

 #0#110 = #0#090 + #0#109;  ||A3 - C
 |PINTA #0#090;
 |PINTA #0#109;
 |PINTA #0#110;

 |SI tipo = "E";
     #0#112 = #0#110 + #0#111; |PINTA #0#112; ||A4
     #0#113 = #0#114;          |PINTA #0#113;    ||B
 |FINSI;
 #0#115 = #0#110 + #0#111; |PINTA #0#115;
|FPRC;
