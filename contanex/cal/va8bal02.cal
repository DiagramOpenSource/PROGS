|FICHEROS;
   va8bal02 #0;
   va8bal03 #1;
|FIN;

|VARIABLES;
   x        = 0;
   tecla    = "";
   ntecla   = 0;
   avance   = "815";
   atras    = "814";
   FEstado  = 0;
   impor = 0;
   sw = 0;
|FIN;

|INCLUYE dscnex_v;

|PROGRAMA;
  |ABRE #0;
  |PINPA #0#0;
  |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
  |SI modo = 4; |HAZ consulta; |FINSI;
|FPRO;

|PROCESO pidedato;
 #0#0 = empresa;
 #0#1 = anyo;
 #0#2 = registr;
 |LEE 110#0=;
 FEstado = FSalida;
 |SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; #0#2 = registr; |FINSI;
 |PINDA #0#0;
 |HAZ pin_totales;
 |SI modo = 1; |HAZ nomodi; |ENDATOS #1#0;  |FINSI;
 |SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;
 |SI FSalida = 0;
     #0#0 = empresa;
     #0#1 = anyo;
     #0#2 = registr;
     #0#5 = tipo;
     |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
     |LIBERA #0;
 |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
 avance = &255 + avance;
 atras  = &255 + atras;
 #0#0   = empresa;
 #0#1   = anyo;
 #0#2   = registr;
 |LEE 040#0=;
 |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
 |PINPA #0#0;
 |PINDA #0#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
 |PINPA #1#0;
 |PINDA #1#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
 |PINPA #2#0;
 |PINDA #2#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
 |PINPA #3#0;
 |PINDA #3#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
 |PINPA #4#0;
 |PINDA #4#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla6;
 |PINPA #5#0;
 |PINDA #5#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla5; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla7; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla7;
 |PINPA #6#0;
 |PINDA #6#0;
 |MENSA "0411  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************

|PROCESO nomodi;
 |SI tipo   = "A"; |HAZ nomoabre; |FINSI;
 |SI tipo   = "E"; |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO nomoabre;
 |C_M #0#072,1,"N"; |C_M #0#073,1,"N";
 |C_M #0#074,1,"N"; |C_M #0#075,1,"N";
 |C_M #0#076,1,"N"; |C_M #0#077,1,"N";
 |C_M #0#208,1,"N";

 |C_M #0#079,1,"N"; |C_M #0#080,1,"N";
 |C_M #0#081,1,"N";
 |C_M #0#083,1,"N"; |C_M #0#084,1,"N";

 |C_M #0#086,1,"N"; |C_M #0#087,1,"N";
 |C_M #0#088,1,"N"; |C_M #0#089,1,"N";
 |C_M #0#090,1,"N";
 |C_M #0#209,1,"N";

 |C_M #0#092,1,"N"; |C_M #0#093,1,"N";
 |C_M #0#094,1,"N"; |C_M #0#095,1,"N";
 |C_M #0#096,1,"N";
 |C_M #0#210,1,"N";

 |C_M #0#101,1,"N"; |C_M #0#102,1,"N";
 |C_M #0#212,1,"N";  || ... #0#103
 |C_M #0#213,1,"N";

 |C_M #0#214,1,"N";  || ... #0#104
 |C_M #0#215,1,"N";

 |C_M #0#105,1,"N"; |C_M #0#106,1,"N";

 |C_M #0#109,1,"N"; |C_M #0#111,1,"N";
 |C_M #0#112,1,"N"; |C_M #0#113,1,"N";

 |C_M #0#116,1,"N"; |C_M #0#117,1,"N";
 |C_M #0#118,1,"N"; |C_M #0#119,1,"N";
 |C_M #0#120,1,"N";
 |C_M #0#131,1,"N";

 |C_M #0#122,1,"N"; |C_M #0#123,1,"N";
 |C_M #0#124,1,"N"; |C_M #0#125,1,"N";
 |C_M #0#126,1,"N";
 |C_M #0#132,1,"N";

 |C_M #0#129,1,"N"; |C_M #0#130,1,"N";
|FPRC;

|PROCESO nomoexte;
 |C_M #0#071,1,"N"; |C_M #0#078,1,"N";
 |C_M #0#082,1,"N"; |C_M #0#085,1,"N";
 |C_M #0#091,1,"N"; |C_M #0#100,1,"N";
 |C_M #0#115,1,"N"; |C_M #0#121,1,"N";
 |C_M #0#128,1,"N";
|FPRC;

|PROCESO totales; |TIPO 0;

 |SI tipo = "E";

    #0#71 = 0;
    |PARA x = 72; |SI x [ 77; |HACIENDO x = x + 1;
          #0#71 = #0#71 + #0x;
    |SIGUE;
    #0#71 = #0#71 + #0#208;
    |PINTA #0#71;

    #0#78 = #0#79 + #0#80 + #0#81; |PINTA #0#78;
    #0#82 = #0#83 + #0#84;         |PINTA #0#82;

    #0#85 = 0;
    |PARA x = 86; |SI x [ 90; |HACIENDO x = x + 1;
          #0#85 = #0#85 + #0x;
    |SIGUE;
    #0#85 = #0#85 + #0#209;
    |PINTA #0#85;

    #0#91 = 0;
    |PARA x = 92; |SI x [ 96; |HACIENDO x = x + 1;
          #0#91 = #0#91 + #0x;
    |SIGUE;
    #0#91 = #0#91 + #0#210;
    |PINTA #0#91;

    #0#103 = #0#212 + #0#213; |PINTA #0#103;
    #0#104 = #0#214 + #0#215; |PINTA #0#104;

    #0#100 = 0;
    |PARA x = 101; |SI x [ 106; |HACIENDO x = x + 1;
          #0#100 = #0#100 + #0x;
    |SIGUE;
    |PINTA #0#100;

    #0#108 = #0#216 + #0#217; |PINTA #0#108;  || aqui modificacion
    #0#107 = 0;
    |PARA x = 108; |SI x [ 114; |HACIENDO x = x + 1;
          #0#107 = #0#107 + #0x;
    |SIGUE;
    |PINTA #0#107;

    #0#115 = 0;
    |PARA x = 116; |SI x [ 120; |HACIENDO x = x + 1;
          #0#115 = #0#115 + #0x;
    |SIGUE;
    #0#115 = #0#115 + #0#131;
    |PINTA #0#115;

    #0#121 = 0;
    |PARA x = 122; |SI x [ 126; |HACIENDO x = x + 1;
          #0#121 = #0#121 + #0x;
    |SIGUE;
    #0#121 = #0#121 + #0#132;
    |PINTA #0#121;

    #0#128 = #0#129 + #0#130; |PINTA #0#128;
|SINO;
    #0#108 = #0#216 + #0#217;          |PINTA #0#108;
    #0#107 = #0#108 + #0#110 + #0#114; |PINTA #0#107;
|FINSI;

    #0#70 = #0#71 + #0#78  + #0#82  + #0#85  + #0#91  + #0#97 + #0#211;
    #0#98 = #0#99 + #0#100 + #0#107 + #0#115 + #0#121 + #0#127 + #0#128;

    #0#133 = #0#70 + #0#98;

    |PINTA #0#070;
    |PINTA #0#098;
    |PINTA #0#133;

    |HAZ pin_totales;
|FPRC;


|PROCESO pin_totales;
 |SI sw = 0;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = empresa;
     #1#1 = anyo;
     #1#2 = registr;
     |LEE 110#1=;
     |CIERRA #1;
   |PINTA 0554, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ¿";
   |PINTA 0654, "³";
   |PINTA 0667, "³";
   |PINTA 0680, "³";
   |ATRI R;
   |PINTA 0655, " T. PASIVO  ";
   |PINTA 0668, " T. ACTIVO  ";
   |ATRI 0;
   |PINTA 0754, "³            ³            ³"
   sw = 1;
 |FINSI;
 |PINTA 0755, #1#123;
 |PINTA 0768, #0#133;
|FPRC;
