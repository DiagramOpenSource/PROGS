|FICHEROS;
   va8bal08 #0;
   va8bal02 #1;   || Activo
   va8bal03 #2;   || Pasivo
   va8bal04 #3;   || Debe
   va8bal05 #4;   || Haber
   va8accba #5;
|FIN;

|VARIABLES;

  &hoja1     = 0;
  &colm      = "";
  num1       = 0;
  num2       = 0;
  informe    = "";
  alfa1      = "";
|FIN;

|INCLUYE dscnex_v;

|PROCESO mayor;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;

|PROGRAMA;
 |DDEFECTO #0;
 |PINPA #0#0;
 |PINDA #0#0;
 |ENDATOS #1#0;
 |SI FSalida = 0;
     |HAZ impresio;
 |FINSI;
|FPRO;

|PROCESO impresio;
 |IMPRE 0;
 |SI FSalida = 0;
     |HAZ lectura;
 |SINO;
     |MENAV "      Proceso Interrumpido";
 |FINSI;
 |FINIMP;
|FPRC;

|PROCESO lectura;

 |ABRE #5; #5#0 = empresa; #5#1 = anyo; #5#2 = registr; |LEE 040#5=; |CIERRA #5;
 |SI FSalida ! 0; |DDEFECTO #5; |FINSI;

 |ABRE #1; #1#0 = empresa; #1#1 = anyo; #1#2 = registr; |LEE 040#1=; |CIERRA #1;
 |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

 |ABRE #2; #2#0 = empresa; #2#1 = anyo; #2#2 = registr; |LEE 040#2=; |CIERRA #2;
 |SI FSalida ! 0; |DDEFECTO #2; |FINSI;

 |ABRE #3; #3#0 = empresa; #3#1 = anyo; #3#2 = registr; |LEE 040#3=; |CIERRA #3;
 |SI FSalida ! 0; |DDEFECTO #3; |FINSI;

 |ABRE #4; #4#0 = empresa; #4#1 = anyo; #4#2 = registr; |LEE 040#4=; |CIERRA #4;
 |SI FSalida ! 0; |DDEFECTO #4; |FINSI;

 hoja1 = 1;
 colm = "CONTABILIDAD";
 |SI #0#0 = "A";
     |PARA num1 = 134; |SI num1 [ 197; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 128;
           #1num1 = #1num2;
     |SIGUE;
     |PARA num1 = 218; |SI num1 [ 227; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 20;
           #1num1 = #1num2;
     |SIGUE;

     |PARA num1 = 124; |SI num1 [ 182; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 118;
           #2num1 = #2num2;
     |SIGUE;
     |PARA num1 = 195; |SI num1 [ 200; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 12;
           #2num1 = #2num2;
     |SIGUE;

     |PARA num1 = 116; |SI num1 [ 170; |HACIENDO num1 = num1 + 1;
           num2 = num1 - 110;
           #3num1 = #3num2;
     |SIGUE;
     #3#175 = #3#171; #3#176 = #3#172;

     colm = " ANTERIORES ";
     #5#4 = #5#5;
 |FINSI;

 |SI #5#7 = "A"; |HAZ abreviado; |FINSI;
 |SI #5#7 = "E";
    |SI #5#8 = "A"; |HAZ intermedio; |FINSI;
    |SI #5#8 = "E"; |HAZ extenso;    |FINSI;
    |SI #5#8 = "B"; |HAZ tipo_b;     |FINSI;
    |SI #5#8 = "P"; |HAZ tipo_p;     |FINSI;
 |FINSI;
|FPRC;

|| -------------------------------------------------- CALCULOS

|PROCESO intermedio;
 |HAZ abreviado;
|FPRC;

|PROCESO abreviado;
       informe = "va8babr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8babr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8babr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO extenso;
       informe = "va8bext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO tipo_b;
       informe = "va8babr1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8babr2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

       informe = "va8bext5"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext6"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;

|PROCESO tipo_p;
       informe = "va8bext1"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext2"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
       informe = "va8bext4"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;

       informe = "va8babr3"; |INFOR informe; |SI FSalida = 0; |PRINT; |PIEINF; |FININF; |FINSI;
|FPRC;
