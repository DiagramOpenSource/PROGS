|FICHEROS;
   varatem1 #0;
   varatemp #1;
|FIN;

|VARIABLES;
   sw       = 0;
   &empresa = 0;
   &anyo    = 0;
   &codrati = 0;
   &codform = 0;
   &nombre  = "";
   &descrip = "";
   &fec_con = @;
   &fec_pre = @;
   &fec_ant = @;
   &periodo = 0;

   &opcion  = 0;
   &modo    = 0;
   &sw_act  = 0;
   nume1    = 0;
   para1    = 0;
   para2    = 0;
   {13}mes  = "";
|FIN;

|PROGRAMA;

 |ABRE #1;
 #1#0 = empresa;
 #1#1 = anyo;
 #1#2 = codrati;
 |LEE 040#1=;
 |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
 |CIERRA #1;

 |HAZ meses;
 #0#0  = #1#0;
 |PARA para1 = 1; |SI para1 [ 42; |HACIENDO para1 = para1 + 1;
       para2 = para1 + 14;
       #0para1 = #1para2;
 |SIGUE;
 |SI #0#42 = "00.00.0000"; |Y modo ! 4; #0#42 = ~; |FINSI;

 |PINPA #0#0;
 |PINDA #0#0;

 |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
 |SI modo = 4; |PAUSA; |FINSI;
|FPRO;

|PROCESO pidedato;
 |SI modo = 1; |ENDATOS #1#0;  |FINSI;
 |SI modo = 2; |ENDATOS #2#0;  |FINSI;
 |SI FSalida = 0;
     |ABRE #1;
     #1#0 = empresa;
     #1#1 = anyo;
     #1#2 = codrati;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = empresa;
         #1#1 = anyo;
         #1#2 = codrati;
         |GRABA 020#1b;
     |FINSI;

     |PARA para1 = 1; |SI para1 [ 42; |HACIENDO para1 = para1 + 1;
           para2 = para1 + 14;
           #1para2 = #0para1;
     |SIGUE;
     fec_pre = #0#42;
     sw_act  = 1;
     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;
 |FINSI;
|FPRC;

|PROCESO meses;
 |DDEFECTO #0;
 |SI #1#57 = 1; |ACABA; |FINSI;

 Imes = mes1 <-;
 |PARA para1 = 43; |SI para1 [ 54; |HACIENDO para1 = para1 + 1;
       mes = #0para1;
       Imes = Imes + 1;
 |SIGUE;

 Imes = mes1 <-;
 para2 = 43 + (13 - #1#57);
 |PARA para1 = 1; |SI para1 [ 12; |HACIENDO para1 = para1 + 1;
       |SI para2 = 55; para2 = 43; |FINSI;
       #0para2 = mes;
       Imes = Imes + 1;
       para2 = para2 + 1;
 |SIGUE;
|FPRC;
