|FICHEROS;
   varatem2 #0;
   varatemp #1;
   varatios #2;
|FIN;

|VARIABLES;
   sw       = 0;
   &empresa = 0;
   &anyo    = 0;
   &codrati = 0;
   &codform = 0;
   &nombre  = "";
   &descrip = "";
   &fec_con = @;
   &fec_pre = @;
   &fec_ant = @;
   &periodo = 0;

   &opcion  = 0;
   &modo    = 0;
   &sw_act  = 0;
   para1    = 0;
   para2    = 0;
   estado   = 0;
|FIN;

|PROGRAMA;
 |PINPA #0#0;
 |ABRE #1;
 #1#0 = empresa;
 #1#1 = anyo;
 #1#2 = codrati;
 |LEE 040#1=;
 |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
 |CIERRA #1;

 #0#0  = #1#0;
 |PARA para1 = 1; |SI para1 [ 10; |HACIENDO para1 = para1 + 1;
       para2 = para1 + 4;
       #0para1 = #1para2;
 |SIGUE;
 |SI modo = 1; |HAZ lec_ratio; |FINSI;

 |PINPA #0#0;
 |PINDA #0#0;

 |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
 |SI modo = 4; |PAUSA; |FINSI;
|FPRO;

|PROCESO elratio; |TIPO 0;
 |SI FSalida = 9;
     |HAZ lec_ratio;
     |PINTA #0#1; |PINTA #0#2;
     |PINTA #0#3; |PINTA #0#4;
     |PINTA #0#5;
     |PTEC 802;
     |PTEC 802;
     |PTEC 802;
     |PTEC 802;
 |FINSI;
|FPRC;

|PROCESO pidedato;
 |SI modo = 1; |ENDATOS #1#0;  |FINSI;
 |SI modo = 2; |ENDATOS #2#0;  |FINSI;
 |SI FSalida = 0;
     |ABRE #1;
     #1#0 = empresa;
     #1#1 = anyo;
     #1#2 = codrati;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = empresa;
         #1#1 = anyo;
         #1#2 = codrati;
         |GRABA 020#1b;
     |FINSI;

     |PARA para1 = 1; |SI para1 [ 10; |HACIENDO para1 = para1 + 1;
           para2 = para1 + 4;
           #1para2 = #0para1;
     |SIGUE;
     sw_act  = 1;
     |GRABA 020#1a;
     |LIBERA #1;
     |CIERRA #1;
 |FINSI;
|FPRC;

|PROCESO lec_ratio;
 |ABRE #2;
 #2#0 = #1#2;
 |LEE 001#2=;
 |SI FSalida = 0;
     #0#1 = #2#3; #0#2 = #2#4;
     #0#3 = #2#5; #0#4 = #2#6;
     #0#5 = #2#6;
 |FINSI;
 |CIERRA #2;
|FPRC;
