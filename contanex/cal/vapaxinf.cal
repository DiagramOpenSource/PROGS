|INCLUYE dscnex_v;
|FICHEROS;
 vapaxinf #0;
 vamanpax #3;
 vatr0003 #12;  || Trabajo Total Pax
|FIN;

|VARIABLES;
  inform1  = "vapaxine";
  inform2  = "vapaxina";
  informe  = "";
  alfa1    = "";
  alfa2    = "";
  alfa3    = "";
  alfa4    = "";
  alfa5    = "";
  nume1    = 0;
  nume2    = 0;
  nume3    = 0;
  nume4    = 0;
  para1    = 0;
  para2    = 0;
  para3    = 0;
  para4    = 0;
  fech1    = @;

  any   = 0;
  d_emp  = 0;
  h_emp  = 0;
  d_any  = 0;
  h_any  = 0;
  sw        = 0;
  swalgun   = 0;
  &cEmp     = 0;
  &cEmA     = "";
  &cAny     = 0;
  &cNom     = "";
  &fecha    = "";
  &titulo   = "";
  &swinf    = 0;
|FIN;

|INCLUYE i_ficher;
|INCLUYE litmes_v;

|| *************************************************************************
||                         CALCULOS DE PANTALLA
|| *************************************************************************
|CALCULO mayor; |TIPO 0;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;
|FCAL;

|CALCULO hasemp; |TIPO 0;
 |SI #0#1 < #0#0;
     |MENAV "    Error de Entrada ...";
     |ERROR;
 |FINSI;
|FCAL;

|CALCULO con_empr; |TIPO 0;
  |SI FSalida ! 9;  |ACABA;  |FINSI;
  |SI dirfich0 = "*"; |ACABA; |FINSI;

  |SUB_EJECUTA_NP "vaconemp";
  |ERROR;
  |SI r_emp = 0; |PTEC 808; |ACABA; |FINSI;
  #0Campo = r_emp;
  |PTEC 802;
|FCAL;

|| **************************************************************************
|| ********* CALCULOS PARA LANZAR LISTADO ***********************************
|PROCESO total;   || General
  |HAZ totp;
  #12#0 = 99;
  #12#26 = 1998;
  |LEE 001#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
  |FINSI;
  |PIEINF;
|FPRC;

|PROCESO totp;
  #12#0 = 01;
  #12#26 = 1998;
  |LEE 001#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
  |FINSI;
  swinf = 2;
  |PRINT;
|FPRC;

|PROCESO laccc;
  cEmp = #3#0;
  alfa1 = cEmp; cEmA = ("00000" + alfa1) % -105;
  cNom = #3#16;
  cAny = #3#1;
  #12#0 = 01;
  #12#26 = 1998;
  |LEE 101#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
      #12#0 = 01;
      #12#26 = 1998;
      elinim = #3#15;
      |HAZ l_meses;    || Literal meses
      |GRABA 020#12b;
  |FINSI;
  |PDEFECTO #12,13,26;
  |GRABA 020#12a;
  |LIBERA #12;
  swinf = 0;
|FPRC;

|PROCESO lasuma;
  #12#0 = 01;
  #12#26 = 1998;
  |LEE 101#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
      #12#0 = 01;
      #12#26 = 1998;
      elinim = #3#15;
      |HAZ l_meses;    || Literal meses
      |GRABA 020#12b;
  |FINSI;
  |HAZ sumo;

  #12#0 = 99;
  #12#26 = 1998;
  |LEE 101#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
      #12#0 = 99;
      #12#26 = 1998;
      elinim = #3#15;
      |HAZ l_meses;    || Literal meses
      |GRABA 020#12b;
  |FINSI;
  |HAZ sumo;
|FPRC;

|PROCESO sumo;
  |SI d_mes [  1;  |Y h_mes ]  1;  #12#13 = #12#13 + #3#2;  |FINSI;
  |SI d_mes [  2;  |Y h_mes ]  2;  #12#14 = #12#14 + #3#3;  |FINSI;
  |SI d_mes [  3;  |Y h_mes ]  3;  #12#15 = #12#15 + #3#4;  |FINSI;
  |SI d_mes [  4;  |Y h_mes ]  4;  #12#16 = #12#16 + #3#5;  |FINSI;
  |SI d_mes [  5;  |Y h_mes ]  5;  #12#17 = #12#17 + #3#6;  |FINSI;
  |SI d_mes [  6;  |Y h_mes ]  6;  #12#18 = #12#18 + #3#7;  |FINSI;
  |SI d_mes [  7;  |Y h_mes ]  7;  #12#19 = #12#19 + #3#8;  |FINSI;
  |SI d_mes [  8;  |Y h_mes ]  8;  #12#20 = #12#20 + #3#9;  |FINSI;
  |SI d_mes [  9;  |Y h_mes ]  9;  #12#21 = #12#21 + #3#10; |FINSI;
  |SI d_mes [ 10;  |Y h_mes ] 10;  #12#22 = #12#22 + #3#11; |FINSI;
  |SI d_mes [ 11;  |Y h_mes ] 11;  #12#23 = #12#23 + #3#12; |FINSI;
  |SI d_mes [ 12;  |Y h_mes ] 12;  #12#24 = #12#24 + #3#13; |FINSI;
  #12#25 = #12#13 + #12#14 + #12#15 + #12#16 + #12#17;
  #12#25 = #12#25 + #12#18 + #12#19 + #12#20 + #12#21;
  #12#25 = #12#25 + #12#22 + #12#23 + #12#24;
  |GRABA 020#12a;
  |LIBERA #12;
|FPRC;

|PROCESO imprime;
 |SI sw = 0;
     |HAZ laccc;
     sw = 1;
 |FINSI;

 |SI #0#4 = "E";
     |SI cEmp ! #3#0;
         |HAZ totp;
         |HAZ laccc;
     |FINSI;
 |SINO;
     |SI cAny ! #3#1;
         |HAZ totp;
         |HAZ laccc;
     |FINSI;
 |FINSI;

 |PRINT;
 swinf = 1;

 |HAZ lasuma;
 swalgun = 1;
|FPRC;

|DEFBUCLE lregistro2;
 #3#1;
 ;
 d_emp, d_any;
 h_emp, h_any;
 e;
 NULL, NULL, NULL, NULL, NULL, imprime;
 #3#1, #3#0;
|FIN;

|DEFBUCLE lregistro1;
 #3#1;
 ;
 d_emp, d_any;
 h_emp, h_any;
 e;
 NULL, imprime;
|FIN;

|| **************************************************************************
|| ********* PROCESO PARA CREAR INFORME *************************************
|| **************************************************************************
|PROCESO elproceso; |TIPO 3
  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |SI #0#4 = "E"; informe = inform1; |FINSI;
  |SI #0#4 = "A"; informe = inform2; |FINSI;

  |INFOR informe;
  |SI FSalida ! 0;
      |FINIMP;
      |ACABA;
  |FINSI;

  |HAZ fichero;
  alfa1 = ("f" + fichero) % 108;
  |NOME_DAT #12 alfa1;
  |ABRE #12;
  |CIERRA #12;
  |DELINDEX #12;

  titulo = #0#2;
  fecha  = #0#3;
  d_emp  = #0#0;
  h_emp  = #0#1;
  d_any  = #0#6;
  h_any  = #0#7;
  d_mes  = 1;
  h_mes  = 12;

  sw = 0;
  |ABRE #12;
  |SI #0#4 = "E"; |BUCLE lregistro1; |FINSI;
  |SI #0#4 = "A"; |BUCLE lregistro2; |FINSI;
  |SI sw = 1;
      |HAZ total;
  |FINSI;
  |CIERRA #12;

  |FININF;
  |FINIMP;
  |DELINDEX #12;
|FPRC;
