|FICHEROS;
   vabala05 #0;
|FIN;

|VARIABLES;
   x        = 0;
   tecla    = "";
   ntecla   = 0;
   avance   = "815";
   atras    = "814";
   FEstado  = 0;
|FIN;

|INCLUYE dscnex_v;

|PROGRAMA;
 |ABRE #0;
 |PINPA #0#0;
 |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
 |SI modo = 4; |HAZ consulta; |FINSI;
|FPRO;

|PROCESO pidedato;
 #0#0 = empresa;
 #0#1 = anyo;
 #0#2 = registr;
 |LEE 110#0=;
 FEstado = FSalida;
 |SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; #0#2 = registr; |FINSI;
 |PINDA #0#0;
 |SI modo = 1; |HAZ nomodi; |ENDATOS #1#0; |FINSI;
 |SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;
 |SI FSalida = 0;
     #0#0 = empresa;
     #0#1 = anyo;
     #0#2 = registr;
     #0#5 = tipo;
     |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
     |LIBERA #0;
 |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
 avance = &255 + avance;
 atras  = &255 + atras;
 #0#0   = empresa;
 #0#1   = anyo;
 #0#2 = registr;
 |LEE 040#0=;
 |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
 |PINPA #0#0;
 |PINDA #0#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
 |PINPA #1#0;
 |PINDA #1#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
 |PINPA #2#0;
 |PINDA #2#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
 |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
 |PINPA #3#0;
 |PINDA #3#0;
 |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
 |LEETECLA tecla;
 |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************

|PROCESO nomodi;
 |SI tipo   = "A"; |HAZ nomoabre; |FINSI;
 |SI tipo   = "E"; |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO nomoabre;
    |CAMPO_MODIFICA #0#047,1,"N"; |CAMPO_MODIFICA #0#048,1,"N";
    |CAMPO_MODIFICA #0#049,1,"N"; |CAMPO_MODIFICA #0#050,1,"N";
    |CAMPO_MODIFICA #0#051,1,"N"; |CAMPO_MODIFICA #0#053,1,"N";
    |CAMPO_MODIFICA #0#054,1,"N"; |CAMPO_MODIFICA #0#055,1,"N";
    |CAMPO_MODIFICA #0#058,1,"N"; |CAMPO_MODIFICA #0#061,1,"N";
    |CAMPO_MODIFICA #0#062,1,"N"; |CAMPO_MODIFICA #0#063,1,"N";
    |CAMPO_MODIFICA #0#064,1,"N"; |CAMPO_MODIFICA #0#065,1,"N";
    |CAMPO_MODIFICA #0#066,1,"N"; |CAMPO_MODIFICA #0#067,1,"N";
    |CAMPO_MODIFICA #0#068,1,"N";
|FPRC;

|PROCESO nomoexte;
 |CAMPO_MODIFICA #0#045,1,"N"; |CAMPO_MODIFICA #0#057,1,"N";
 |CAMPO_MODIFICA #0#046,1,"N"; |CAMPO_MODIFICA #0#052,1,"N";
|FPRC;

|PROCESO totales; |TIPO 0;
|SI tipo = "E";
    #0#045 = 0; #0#57 = 0;
    #0#046 = #0#047 + #0#048 + #0#049;                   |PINTA #0#046;
    #0#052 = #0#053 + #0#054 + #0#055;                   |PINTA #0#052;
    #0#058 = #0#059 + #0#060 + #0#061;                   |PINTA #0#058;
    #0#062 = #0#063 + #0#064 + #0#065;                   |PINTA #0#062;
    #0#066 = #0#067 + #0#068 + #0#069 + #0#70;           |PINTA #0#066;

    #0#044 = #0#046 + #0#050 + #0#051 + #0#052 + #0#058;
    #0#044 = #0#044 + #0#062 + #0#066 + #0#071 + #0#074;
    #0#044 = #0#044 + #0#075 + #0#076 + #0#077 + #0#078; |PINTA #0#044;

|SINO;
    #0#045 = #0#046 + #0#052;                            |PINTA #0#045;
    #0#057 = #0#059 + #0#060 + #0#069 + #0#70;           |PINTA #0#057;

    #0#044 = #0#045 + #0#057 + #0#071 + #0#074 + #0#075;
    #0#044 = #0#044 + #0#076 + #0#077 + #0#078;          |PINTA #0#044;

|FINSI;
|FPRC;
