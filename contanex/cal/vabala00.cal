|FICHEROS;
   vabala00 #0;
   vaplanli #1;
   vaplanca #8;
   vadacoli #2;
   vabala02 #3;
   vabala03 #4;
   vabala04 #5;
   vabala05 #6;
   vaaccbal #7;
|FIN;

|VARIABLES;

   &act_ant_con = "";
   fecact = 0;
   fecant = 0;
   feccon = 0;

     FEstado3 = 0;
     FEstado4 = 0;
     FEstado5 = 0;
     FEstado6 = 0;
     FEstado7 = 0;

     cantidad = 0;
     anyob    = 0;

     cuentad  = "";
     cuentah  = "";
     vari     = "";
     aste     = "";
     long     = "";
     numero   = "";
     longi    = 0;
     el141    = 0;
     el142    = 0;
     x        = 0;
     y        = 0;
     alfa1    = "";
     blancos  = "                              ";
|FIN;

|INCLUYE dscnex_v;
|| **************************************************************************
||                            CALCULOS DE PANTALLA
|| **************************************************************************

|PROCESO mayor;
  alfa1 = #0Campo > " ";
  #0Campo = alfa1;
  |PINTA #0Campo;
|FPRC;


|PROCESO planilla;
 |SI FSalida = 2; |ACABA; |FINSI;
 |ABRE #8;
 #8#0 = #0Campo;
 |LEE 040#8=;
 |SI FSalida ! 0;
     |PINTA 1326, blancos;
     |MENAV "      No existe Planilla.";
     |ERROR;
 |SINO;
     |ATRI I; |PINTA 1326, #8#1; |ATRI 0;
 |FINSI;
 |CIERRA #8;
|FPRC;

|PROCESO cuadro; |TIPO 7;
 |PUSHV 1501 2380;
 |SI modo ! 1;
     ||  "³ MODIFICACION ³";
     |CUADRO 1516 2171;
     |ATRI R;
     |PINTA 1617, " (S) Deja Datos ACTUALES igual a Datos CONTABILIDAD   ";
     |PINTA 1717, " (N) Pone a Cero Datos ACTUALES                       ";
     |PINTA 1817, " (D) NO modifica Datos ACTUALES                       ";
     |PINTA 1917, "------------------------------------------------------";
     |PINTA 2017, " (S) o (N) Pasa Datos ACTUALES validados a ANTERIORES ";
     |ATRI r;
  |SINO;
     ||  "³ ALTA ³";
     |CUADRO 1518 1871;
     |ATRI R;
     |PINTA 1619, " (S) Deja Datos ACTUALES igual a Datos CONTABILIDAD ";
     |PINTA 1719, " (N) o (D) Deja Datos ACTUALES a Cero               ";
     |ATRI r;
  |FINSI;
|FPRC;

|PROCESO repon; |TIPO 0;
 |POPV;
|FPRC;

|PROGRAMA;
 |SI Planilla = 0;
     |PINPA #0#0;
     |DDEFECTO #0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida ! 0; |ACABA; |FINSI;
     Planilla= #0#0;
     fec_con = #0#1;
     act_ant_con = #0#2;
 |SINO;
     #0#3 = "SI";
     empresa = empAlta;
 |FINSI;
 |SI #0#3 = "SI";
     |HAZ pase;
     sw_act = 1;
 |FINSI;
|FPRO;

|| *************************************************************************
||                        PROCESOS PARA EL ABREVIADO
|| *************************************************************************

|PROCESO abreviad2;
|SI #1#6 = 110000; #3#137 = #3#137 + cantidad; |ACABA; |FINSI;   || A
|SI #1#6 = 121000; #3#139 = #3#139 + cantidad; |ACABA; |FINSI;   || B-I
|SI #1#6 = 122000; #3#140 = #3#140 + cantidad; |ACABA; |FINSI;   || B-II
|SI #1#6 = 123000; #3#150 = #3#150 + cantidad; |ACABA; |FINSI;   || B-III
|SI #1#6 = 124000; #3#158 = #3#158 + cantidad; |ACABA; |FINSI;   || B-IV
|SI #1#6 = 125000; #3#167 = #3#167 + cantidad; |ACABA; |FINSI;   || B-V
|SI #1#6 = 126000; #3#168 = #3#168 + cantidad; |ACABA; |FINSI;   || B-VI
|SI #1#6 = 130000; #3#169 = #3#169 + cantidad; |ACABA; |FINSI;   || C
|SI #1#6 = 141000; #3#171 = #3#171 + cantidad; |ACABA; |FINSI;   || D-I
|SI #1#6 = 142000; #3#172 = #3#172 + cantidad; |ACABA; |FINSI;   || D-II
|SI #1#6 = 143000; #3#180 = #3#180 + cantidad; |ACABA; |FINSI;   || D-III
|SI #1#6 = 144000; #3#188 = #3#188 + cantidad; |ACABA; |FINSI;   || D-IV
|SI #1#6 = 145000; #3#197 = #3#197 + cantidad; |ACABA; |FINSI;   || D-V
|SI #1#6 = 146000; #3#198 = #3#198 + cantidad; |ACABA; |FINSI;   || D-VI
|SI #1#6 = 147000; #3#199 = #3#199 + cantidad; |ACABA; |FINSI;   || D-VII

|SI #1#6 = 211000; #4#159 = #4#159 + cantidad; |ACABA; |FINSI;   || A-I
|SI #1#6 = 212000; #4#160 = #4#160 + cantidad; |ACABA; |FINSI;   || A-II
|SI #1#6 = 213000; #4#161 = #4#161 + cantidad; |ACABA; |FINSI;   || A-III
|SI #1#6 = 214000; #4#162 = #4#162 + cantidad; |ACABA; |FINSI;   || A-IV
|SI #1#6 = 215000; #4#168 = #4#168 + cantidad; |ACABA; |FINSI;   || A-V
|SI #1#6 = 216000; #4#172 = #4#172 + cantidad; |ACABA; |FINSI;   || A-VI
|SI #1#6 = 217000; #4#173 = #4#173 + cantidad; |ACABA; |FINSI;   || A-VII
|SI #1#6 = 218000; #4#174 = #4#174 + cantidad; |ACABA; |FINSI;   || A-VIII
|SI #1#6 = 220000; #4#175 = #4#175 + cantidad; |ACABA; |FINSI;   || B
|SI #1#6 = 230000; #4#179 = #4#179 + cantidad; |ACABA; |FINSI;   || C
|SI #1#6 = 240000; #4#184 = #4#184 + cantidad; |ACABA; |FINSI;   || D
|SI #1#6 = 250000; #4#204 = #4#204 + cantidad; |ACABA; |FINSI;   || E
|SI #1#6 = 260000; #4#229 = #4#229 + cantidad; |ACABA; |FINSI;   || F

|SI #1#6 = 301009; #5#085 = #5#085 + cantidad; |ACABA; |FINSI;   || A-1
|SI #1#6 = 303010; #5#091 = #5#091 + cantidad; |ACABA; |FINSI;   || A-2-a
|SI #1#6 = 303020; #5#092 = #5#092 + cantidad; |ACABA; |FINSI;   || A-2-b
|SI #1#6 = 304000; #5#093 = #5#093 + cantidad; |ACABA; |FINSI;   || A-3
|SI #1#6 = 305000; #5#094 = #5#094 + cantidad; |ACABA; |FINSI;   || A-4
|SI #1#6 = 306000; #5#098 = #5#098 + cantidad; |ACABA; |FINSI;   || A-5
|SI #1#6 = 307010; #5#105 = #5#105 + cantidad; |ACABA; |FINSI;   || A-6-a
|SI #1#6 = 307020; #5#106 = #5#106 + cantidad; |ACABA; |FINSI;   || A-6-b
|SI #1#6 = 307030; #5#107 = #5#107 + cantidad; |ACABA; |FINSI;   || A-6-c
|SI #1#6 = 307040; #5#108 = #5#108 + cantidad; |ACABA; |FINSI;   || A-6-d
|SI #1#6 = 308000; #5#109 = #5#109 + cantidad; |ACABA; |FINSI;   || A-7
|SI #1#6 = 309000; #5#110 = #5#110 + cantidad; |ACABA; |FINSI;   || A-8
|SI #1#6 = 310000; #5#113 = #5#113 + cantidad; |ACABA; |FINSI;   || A-9
|SI #1#6 = 311000; #5#114 = #5#114 + cantidad; |ACABA; |FINSI;   || A-10
|SI #1#6 = 312000; #5#115 = #5#115 + cantidad; |ACABA; |FINSI;   || A-11
|SI #1#6 = 313000; #5#116 = #5#116 + cantidad; |ACABA; |FINSI;   || A-12
|SI #1#6 = 314000; #5#117 = #5#117 + cantidad; |ACABA; |FINSI;   || A-13
|SI #1#6 = 315000; #5#120 = #5#120 + cantidad; |ACABA; |FINSI;   || A-14
|SI #1#6 = 316000; #5#121 = #5#121 + cantidad; |ACABA; |FINSI;   || A-15

|SI #1#6 = 401000; #6#084 = #6#084 + cantidad; |ACABA; |FINSI;   || B-1-a
|SI #1#6 = 401029; #6#090 = #6#090 + cantidad; |ACABA; |FINSI;   || B-1-b
|SI #1#6 = 402019; #6#097 = #6#097 + cantidad; |ACABA; |FINSI;   || B-2-a
|SI #1#6 = 402029; #6#098 = #6#098 + cantidad; |ACABA; |FINSI;   || B-2-b
|SI #1#6 = 402039; #6#107 = #6#107 + cantidad; |ACABA; |FINSI;   || B-2-c
|SI #1#6 = 402040; #6#108 = #6#108 + cantidad; |ACABA; |FINSI;   || B-2-d
|SI #1#6 = 408000; #6#109 = #6#109 + cantidad; |ACABA; |FINSI;   || B-3
|SI #1#6 = 409000; #6#112 = #6#112 + cantidad; |ACABA; |FINSI;   || B-4
|SI #1#6 = 410000; #6#113 = #6#113 + cantidad; |ACABA; |FINSI;   || B-5
|SI #1#6 = 411000; #6#114 = #6#114 + cantidad; |ACABA; |FINSI;   || B-6
|SI #1#6 = 412000; #6#115 = #6#115 + cantidad; |ACABA; |FINSI;   || B-7
|SI #1#6 = 413000; #6#116 = #6#116 + cantidad; |ACABA; |FINSI;   || B-8
|FPRC;

|PROCESO pasaabr;   || Manual los dos a¤os
   |PINTA 2207, " PASANDO CUENTA: ";
   |ATRI I;
   |PINTA 2224, #2#3;
   |ATRI 0;

   cantidad = #2#8;
   |SI #1#9 = "-"; cantidad = -#2#8; |FINSI;
   |HAZ abreviad2;
|FPRC;

|DEFBUCLE liapun3;
#2#2;
;
empresa, anyo, cuentad;
empresa, anyo, cuentah;
e;
NULL, pasaabr;
|FIN;

|PROCESO bulinabr;
 |HAZ montacuen;
 |BUCLE liapun3;        || Lee las lineas apuntes para el abreviado
                        || para manual
|FPRC;

|DEFBUCLE planabre;
#1#1;
6;
#0#0, 001, 001;
#0#0, 999, 999999;
e;
NULL, bulinabr;
|FIN;

|| *************************************************************************
||                        PROCESOS PARA EL EXTENSO
|| *************************************************************************

|PROCESO extenso2;
|SI #1#5= 110000; #3#137 = #3#137 + cantidad; |ACABA; |FINSI; || A
|SI #1#5= 121000; #3#139 = #3#139 + cantidad; |ACABA; |FINSI; || B-I
|SI #1#5= 122010; #3#141 = #3#141 + cantidad; |ACABA; |FINSI; || B-II-1
|SI #1#5= 122020; #3#142 = #3#142 + cantidad; |ACABA; |FINSI; || B-II-2
|SI #1#5= 122030; #3#143 = #3#143 + cantidad; |ACABA; |FINSI; || B-II-3
|SI #1#5= 122040; #3#144 = #3#144 + cantidad; |ACABA; |FINSI; || B-II-4
|SI #1#5= 122050; #3#145 = #3#145 + cantidad; |ACABA; |FINSI; || B-II-5
|SI #1#5= 122060; #3#146 = #3#146 + cantidad; |ACABA; |FINSI; || B-II-6
|SI #1#5= 122070; #3#147 = #3#147 + cantidad; |ACABA; |FINSI; || B-II-7
|SI #1#5= 122080; #3#148 = #3#148 + cantidad; |ACABA; |FINSI; || B-II-8
|SI #1#5= 122090; #3#149 = #3#149 + cantidad; |ACABA; |FINSI; || B-II-9
|SI #1#5= 123010; #3#151 = #3#151 + cantidad; |ACABA; |FINSI; || B-III-1
|SI #1#5= 123020; #3#152 = #3#152 + cantidad; |ACABA; |FINSI; || B-III-2
|SI #1#5= 123030; #3#153 = #3#153 + cantidad; |ACABA; |FINSI; || B-III-3
|SI #1#5= 123040; #3#154 = #3#154 + cantidad; |ACABA; |FINSI; || B-III-4
|SI #1#5= 123050; #3#155 = #3#155 + cantidad; |ACABA; |FINSI; || B-III-5
|SI #1#5= 123060; #3#156 = #3#156 + cantidad; |ACABA; |FINSI; || B-III-6
|SI #1#5= 123070; #3#157 = #3#157 + cantidad; |ACABA; |FINSI; || B-III-7
|SI #1#5= 124010; #3#159 = #3#159 + cantidad; |ACABA; |FINSI; || B-IV-1
|SI #1#5= 124020; #3#160 = #3#160 + cantidad; |ACABA; |FINSI; || B-IV-2
|SI #1#5= 124030; #3#161 = #3#161 + cantidad; |ACABA; |FINSI; || B-IV-3
|SI #1#5= 124040; #3#162 = #3#162 + cantidad; |ACABA; |FINSI; || B-IV-4
|SI #1#5= 124050; #3#163 = #3#163 + cantidad; |ACABA; |FINSI; || B-IV-5
|SI #1#5= 124060; #3#164 = #3#164 + cantidad; |ACABA; |FINSI; || B-IV-6
|SI #1#5= 124070; #3#165 = #3#165 + cantidad; |ACABA; |FINSI; || B-IV-7
|SI #1#5= 124080; #3#166 = #3#166 + cantidad; |ACABA; |FINSI; || B-IV-8
|SI #1#5= 124100; #3#136 = #3#136 + cantidad; |ACABA; |FINSI; || B-IV-9
|SI #1#5= 125000; #3#167 = #3#167 + cantidad; |ACABA; |FINSI; || B-V
|SI #1#5= 126000; #3#168 = #3#168 + cantidad; |ACABA; |FINSI; || B-VI
|SI #1#5= 130000; #3#169 = #3#169 + cantidad; |ACABA; |FINSI; || C
|SI #1#5= 141000; #3#171 = #3#171 + cantidad; |ACABA; |FINSI; || D-I
|SI #1#5= 142010; #3#173 = #3#173 + cantidad; |ACABA; |FINSI; || D-II-1
|SI #1#5= 142020; #3#174 = #3#174 + cantidad; |ACABA; |FINSI; || D-II-2
|SI #1#5= 142030; #3#175 = #3#175 + cantidad; |ACABA; |FINSI; || D-II-3
|SI #1#5= 142040; #3#176 = #3#176 + cantidad; |ACABA; |FINSI; || D-II-4
|SI #1#5= 142050; #3#177 = #3#177 + cantidad; |ACABA; |FINSI; || D-II-5
|SI #1#5= 142060; #3#178 = #3#178 + cantidad; |ACABA; |FINSI; || D-II-6
|SI #1#5= 142070; #3#179 = #3#179 + cantidad; |ACABA; |FINSI; || D-II-7
|SI #1#5= 143010; #3#181 = #3#181 + cantidad; |ACABA; |FINSI; || D-III-1
|SI #1#5= 143020; #3#182 = #3#182 + cantidad; |ACABA; |FINSI; || D-III-2
|SI #1#5= 143030; #3#183 = #3#183 + cantidad; |ACABA; |FINSI; || D-III-3
|SI #1#5= 143040; #3#184 = #3#184 + cantidad; |ACABA; |FINSI; || D-III-4
|SI #1#5= 143050; #3#185 = #3#185 + cantidad; |ACABA; |FINSI; || D-III-5
|SI #1#5= 143060; #3#186 = #3#186 + cantidad; |ACABA; |FINSI; || D-III-6
|SI #1#5= 143070; #3#187 = #3#187 + cantidad; |ACABA; |FINSI; || D-III-7
|SI #1#5= 144010; #3#189 = #3#189 + cantidad; |ACABA; |FINSI; || D-IV-1
|SI #1#5= 144020; #3#190 = #3#190 + cantidad; |ACABA; |FINSI; || D-IV-2
|SI #1#5= 144030; #3#191 = #3#191 + cantidad; |ACABA; |FINSI; || D-IV-3
|SI #1#5= 144040; #3#192 = #3#192 + cantidad; |ACABA; |FINSI; || D-IV-4
|SI #1#5= 144050; #3#193 = #3#193 + cantidad; |ACABA; |FINSI; || D-IV-5
|SI #1#5= 144060; #3#194 = #3#194 + cantidad; |ACABA; |FINSI; || D-IV-6
|SI #1#5= 144070; #3#195 = #3#195 + cantidad; |ACABA; |FINSI; || D-IV-7
|SI #1#5= 144080; #3#196 = #3#196 + cantidad; |ACABA; |FINSI; || D-IV-8
|SI #1#5= 145000; #3#197 = #3#197 + cantidad; |ACABA; |FINSI; || D-V
|SI #1#5= 146000; #3#198 = #3#198 + cantidad; |ACABA; |FINSI; || D-VI
|SI #1#5= 147000; #3#199 = #3#199 + cantidad; |ACABA; |FINSI; || D-VII

|SI #1#5= 211000; #4#159 = #4#159 + cantidad; |ACABA; |FINSI; || A-I
|SI #1#5= 212000; #4#160 = #4#160 + cantidad; |ACABA; |FINSI; || A-II
|SI #1#5= 213000; #4#161 = #4#161 + cantidad; |ACABA; |FINSI; || A-III
|SI #1#5= 214010; #4#163 = #4#163 + cantidad; |ACABA; |FINSI; || A-IV-1
|SI #1#5= 214020; #4#164 = #4#164 + cantidad; |ACABA; |FINSI; || A-IV-2
|SI #1#5= 214030; #4#165 = #4#165 + cantidad; |ACABA; |FINSI; || A-IV-3
|SI #1#5= 214040; #4#166 = #4#166 + cantidad; |ACABA; |FINSI; || A-IV-4
|SI #1#5= 214050; #4#167 = #4#167 + cantidad; |ACABA; |FINSI; || A-IV-5
|SI #1#5= 215010; #4#169 = #4#169 + cantidad; |ACABA; |FINSI; || A-V-1
|SI #1#5= 215020; #4#170 = #4#170 + cantidad; |ACABA; |FINSI; || A-V-2
|SI #1#5= 215030; #4#171 = #4#171 + cantidad; |ACABA; |FINSI; || A-V-3
|SI #1#5= 216000; #4#172 = #4#172 + cantidad; |ACABA; |FINSI; || A-VI
|SI #1#5= 217000; #4#173 = #4#173 + cantidad; |ACABA; |FINSI; || A-VII
|SI #1#5= 218000; #4#174 = #4#174 + cantidad; |ACABA; |FINSI; || A-VIII
|SI #1#5= 220010; #4#176 = #4#176 + cantidad; |ACABA; |FINSI; || B-1
|SI #1#5= 220020; #4#177 = #4#177 + cantidad; |ACABA; |FINSI; || B-2
|SI #1#5= 220030; #4#178 = #4#178 + cantidad; |ACABA; |FINSI; || B-3
|SI #1#5= 220050; #4#156 = #4#156 + cantidad; |ACABA; |FINSI; || B-4
|SI #1#5= 230010; #4#180 = #4#180 + cantidad; |ACABA; |FINSI; || C-1
|SI #1#5= 230020; #4#181 = #4#181 + cantidad; |ACABA; |FINSI; || C-2
|SI #1#5= 230030; #4#182 = #4#182 + cantidad; |ACABA; |FINSI; || C-3
|SI #1#5= 230040; #4#183 = #4#183 + cantidad; |ACABA; |FINSI; || C-4
|SI #1#5= 241010; #4#186 = #4#186 + cantidad; |ACABA; |FINSI; || D-I-1
|SI #1#5= 241020; #4#187 = #4#187 + cantidad; |ACABA; |FINSI; || D-I-2
|SI #1#5= 241030; #4#188 = #4#188 + cantidad; |ACABA; |FINSI; || D-I-3
|SI #1#5= 242010; #4#190 = #4#190 + cantidad; |ACABA; |FINSI; || D-II-1
|SI #1#5= 242020; #4#191 = #4#191 + cantidad; |ACABA; |FINSI; || D-II-2
|SI #1#5= 243010; #4#193 = #4#193 + cantidad; |ACABA; |FINSI; || D-III-1
|SI #1#5= 243020; #4#194 = #4#194 + cantidad; |ACABA; |FINSI; || D-III-2
|SI #1#5= 244010; #4#196 = #4#196 + cantidad; |ACABA; |FINSI; || D-IV-1
|SI #1#5= 244020; #4#197 = #4#197 + cantidad; |ACABA; |FINSI; || D-IV-2
|SI #1#5= 244030; #4#198 = #4#198 + cantidad; |ACABA; |FINSI; || D-IV-3
|SI #1#5= 244050; #4#157 = #4#157 + cantidad; |ACABA; |FINSI; || D-IV-4
|SI #1#5= 245010; #4#200 = #4#200 + cantidad; |ACABA; |FINSI; || D-V-1
|SI #1#5= 245020; #4#201 = #4#201 + cantidad; |ACABA; |FINSI; || D-V-2
|SI #1#5= 245030; #4#202 = #4#202 + cantidad; |ACABA; |FINSI; || D-V-3
|SI #1#5= 246000; #4#203 = #4#203 + cantidad; |ACABA; |FINSI; || D-VI
|SI #1#5= 251010; #4#206 = #4#206 + cantidad; |ACABA; |FINSI; || E-I-1
|SI #1#5= 251020; #4#207 = #4#207 + cantidad; |ACABA; |FINSI; || E-I-2
|SI #1#5= 251030; #4#208 = #4#208 + cantidad; |ACABA; |FINSI; || E-I-3
|SI #1#5= 251040; #4#209 = #4#209 + cantidad; |ACABA; |FINSI; || E-I-4
|SI #1#5= 252010; #4#211 = #4#211 + cantidad; |ACABA; |FINSI; || E-II-1
|SI #1#5= 252020; #4#212 = #4#212 + cantidad; |ACABA; |FINSI; || E-II-2
|SI #1#5= 252030; #4#213 = #4#213 + cantidad; |ACABA; |FINSI; || E-II-3
|SI #1#5= 253010; #4#215 = #4#215 + cantidad; |ACABA; |FINSI; || E-III-1
|SI #1#5= 253020; #4#216 = #4#216 + cantidad; |ACABA; |FINSI; || E-III-2
|SI #1#5= 254010; #4#218 = #4#218 + cantidad; |ACABA; |FINSI; || E-IV-1
|SI #1#5= 254020; #4#219 = #4#219 + cantidad; |ACABA; |FINSI; || E-IV-2
|SI #1#5= 254030; #4#220 = #4#220 + cantidad; |ACABA; |FINSI; || E-IV-3
|SI #1#5= 255010; #4#222 = #4#222 + cantidad; |ACABA; |FINSI; || E-V-1
|SI #1#5= 255020; #4#223 = #4#223 + cantidad; |ACABA; |FINSI; || E-V-2
|SI #1#5= 255030; #4#224 = #4#224 + cantidad; |ACABA; |FINSI; || E-V-3
|SI #1#5= 255040; #4#225 = #4#225 + cantidad; |ACABA; |FINSI; || E-V-4
|SI #1#5= 255050; #4#226 = #4#226 + cantidad; |ACABA; |FINSI; || E-V-5
|SI #1#5= 256000; #4#227 = #4#227 + cantidad; |ACABA; |FINSI; || E-VI
|SI #1#5= 257000; #4#228 = #4#228 + cantidad; |ACABA; |FINSI; || E-VII
|SI #1#5= 260000; #4#229 = #4#229 + cantidad; |ACABA; |FINSI; || F

|SI #1#5= 301000; #5#085 = #5#085 + cantidad; |ACABA; |FINSI; || A-1
|SI #1#5= 302010; #5#087 = #5#087 + cantidad; |ACABA; |FINSI; || A-2-a
|SI #1#5= 302020; #5#088 = #5#088 + cantidad; |ACABA; |FINSI; || A-2-b
|SI #1#5= 302030; #5#089 = #5#089 + cantidad; |ACABA; |FINSI; || A-2-c
|SI #1#5= 303010; #5#091 = #5#091 + cantidad; |ACABA; |FINSI; || A-3-a
|SI #1#5= 303020; #5#092 = #5#092 + cantidad; |ACABA; |FINSI; || A-3-b
|SI #1#5= 304000; #5#093 = #5#093 + cantidad; |ACABA; |FINSI; || A-4
|SI #1#5= 305010; #5#095 = #5#095 + cantidad; |ACABA; |FINSI; || A-5-a
|SI #1#5= 305020; #5#096 = #5#096 + cantidad; |ACABA; |FINSI; || A-5-b
|SI #1#5= 305030; #5#097 = #5#097 + cantidad; |ACABA; |FINSI; || A-5-c
|SI #1#5= 306010; #5#099 = #5#099 + cantidad; |ACABA; |FINSI; || A-6-a
|SI #1#5= 306020; #5#100 = #5#100 + cantidad; |ACABA; |FINSI; || A-6-b
|SI #1#5= 306030; #5#101 = #5#101 + cantidad; |ACABA; |FINSI; || A-6-c
|SI #1#5= 306040; #5#102 = #5#102 + cantidad; |ACABA; |FINSI; || A-6-d
|SI #1#5= 307010; #5#105 = #5#105 + cantidad; |ACABA; |FINSI; || A-7-a
|SI #1#5= 307020; #5#106 = #5#106 + cantidad; |ACABA; |FINSI; || A-7-b
|SI #1#5= 307030; #5#107 = #5#107 + cantidad; |ACABA; |FINSI; || A-7-c
|SI #1#5= 307040; #5#108 = #5#108 + cantidad; |ACABA; |FINSI; || A-7-d
|SI #1#5= 308000; #5#109 = #5#109 + cantidad; |ACABA; |FINSI; || A-8
|SI #1#5= 309000; #5#110 = #5#110 + cantidad; |ACABA; |FINSI; || A-9
|SI #1#5= 310000; #5#113 = #5#113 + cantidad; |ACABA; |FINSI; || A-10
|SI #1#5= 311000; #5#114 = #5#114 + cantidad; |ACABA; |FINSI; || A-11
|SI #1#5= 312000; #5#115 = #5#115 + cantidad; |ACABA; |FINSI; || A-12
|SI #1#5= 313000; #5#116 = #5#116 + cantidad; |ACABA; |FINSI; || A-13
|SI #1#5= 314000; #5#117 = #5#117 + cantidad; |ACABA; |FINSI; || A-14
|SI #1#5= 315000; #5#120 = #5#120 + cantidad; |ACABA; |FINSI; || A-15
|SI #1#5= 316000; #5#121 = #5#121 + cantidad; |ACABA; |FINSI; || A-16

|SI #1#5= 401010; #6#085 = #6#085 + cantidad; |ACABA; |FINSI; || B-1-a
|SI #1#5= 401020; #6#086 = #6#086 + cantidad; |ACABA; |FINSI; || B-1-b
|SI #1#5= 401030; #6#087 = #6#087 + cantidad; |ACABA; |FINSI; || B-1-c
|SI #1#5= 402000; #6#088 = #6#088 + cantidad; |ACABA; |FINSI; || B-2
|SI #1#5= 403000; #6#089 = #6#089 + cantidad; |ACABA; |FINSI; || B-3
|SI #1#5= 404010; #6#091 = #6#091 + cantidad; |ACABA; |FINSI; || B-4-a
|SI #1#5= 404020; #6#092 = #6#092 + cantidad; |ACABA; |FINSI; || B-4-b
|SI #1#5= 404030; #6#093 = #6#093 + cantidad; |ACABA; |FINSI; || B-4-c
|SI #1#5= 405010; #6#097 = #6#097 + cantidad; |ACABA; |FINSI; || B-5-a
|SI #1#5= 405020; #6#098 = #6#098 + cantidad; |ACABA; |FINSI; || B-5-b
|SI #1#5= 405030; #6#099 = #6#099 + cantidad; |ACABA; |FINSI; || B-5-c
|SI #1#5= 406010; #6#101 = #6#101 + cantidad; |ACABA; |FINSI; || B-6-a
|SI #1#5= 406020; #6#102 = #6#102 + cantidad; |ACABA; |FINSI; || B-6-b
|SI #1#5= 406030; #6#103 = #6#103 + cantidad; |ACABA; |FINSI; || B-6-c
|SI #1#5= 407010; #6#105 = #6#105 + cantidad; |ACABA; |FINSI; || B-7-a
|SI #1#5= 407020; #6#106 = #6#106 + cantidad; |ACABA; |FINSI; || B-7-b
|SI #1#5= 407030; #6#107 = #6#107 + cantidad; |ACABA; |FINSI; || B-7-c
|SI #1#5= 407040; #6#108 = #6#108 + cantidad; |ACABA; |FINSI; || B-7-d
|SI #1#5= 408000; #6#109 = #6#109 + cantidad; |ACABA; |FINSI; || B-8
|SI #1#5= 409000; #6#112 = #6#112 + cantidad; |ACABA; |FINSI; || B-9
|SI #1#5= 410000; #6#113 = #6#113 + cantidad; |ACABA; |FINSI; || B-10
|SI #1#5= 411000; #6#114 = #6#114 + cantidad; |ACABA; |FINSI; || B-11
|SI #1#5= 412000; #6#115 = #6#115 + cantidad; |ACABA; |FINSI; || B-12
|SI #1#5= 413000; #6#116 = #6#116 + cantidad; |ACABA; |FINSI; || B-13
|FPRC;

|PROCESO pasaext;   || Manual los dos a¤os
   |PINTA 2207, " PASANDO CUENTA: ";
   |ATRI I;
   |PINTA 2224, #2#3;
   |ATRI 0;

     cantidad = #2#8;
     |SI #1#9 = "-"; cantidad = -#2#8; |FINSI;
     |HAZ extenso2;
|FPRC;

|DEFBUCLE liapun6;
#2#2;
;
empresa, anyo, cuentad;
empresa, anyo, cuentah;
e;
NULL, pasaext;
|FIN;

|PROCESO bulinext;
 |HAZ montacuen;
 |BUCLE liapun6;        || Lee las lineas apuntes para el abreviado
                        || para manual
|FPRC;

|DEFBUCLE planexten;
#1#1;
5;
#0#0, 001, 001;
#0#0, 999, 999999;
e;
NULL, bulinext;
|FIN;

|| **************************************************************************
||                        Recalculo
|| **************************************************************************

|PROCESO totales;

|| Calcula el Activo
|SI tipo = "E";
    #3#140 = #3#141 + #3#142 + #3#143 + #3#144 + #3#145 + #3#146 + #3#147 + #3#148 + #3#149;
    #3#150 = #3#151 + #3#152 + #3#153 + #3#154 + #3#155 + #3#156 + #3#157;
    #3#158 = #3#159 + #3#160 + #3#161 + #3#162 + #3#163 + #3#164 + #3#165 + #3#166 + #3#136;
    #3#172 = #3#173 + #3#174 + #3#175 + #3#176 + #3#177 + #3#178 + #3#179;
    #3#180 = #3#181 + #3#182 + #3#183 + #3#184 + #3#185 + #3#186 + #3#187;
    #3#188 = #3#189 + #3#190 + #3#191 + #3#192 + #3#193 + #3#194 + #3#195 + #3#196;
|FINSI;

#3#138 = #3#139 + #3#140 + #3#150 + #3#158 + #3#167 + #3#168;
#3#170 = #3#171 + #3#172 + #3#180 + #3#188 + #3#197 + #3#198 + #3#199;
#3#200 = #3#137 + #3#138 + #3#169 + #3#170;

|| Calcula el Pasivo
|SI tipo = "E";
    #4#162 = #4#163 + #4#164 + #4#165 + #4#166 + #4#167;
    #4#168 = #4#169 + #4#170 + #4#171;
    #4#175 = #4#176 + #4#177 + #4#178 + #4#156;
    #4#179 = #4#180 + #4#181 + #4#182 + #4#183;

    #4#185 = #4#186 + #4#187 + #4#188;
    #4#189 = #4#190 + #4#191;
    #4#192 = #4#193 + #4#194;
    #4#195 = #4#196 + #4#197 + #4#198 + #4#157;
    #4#199 = #4#200 + #4#201 + #4#202;
    #4#205 = #4#206 + #4#207 + #4#208 + #4#209;
    #4#210 = #4#211 + #4#212 + #4#213;
    #4#214 = #4#215 + #4#216;
    #4#217 = #4#218 + #4#219 + #4#220;
    #4#221 = #4#222 + #4#223 + #4#224 + #4#225 + #4#226;

    #4#184 = #4#185 + #4#189 + #4#192 + #4#195 + #4#199 + #4#203;
    #4#204 = #4#205 + #4#210 + #4#214 + #4#217 + #4#221 + #4#227 + #4#228;
|FINSI;

#4#158 = #4#159 + #4#160 + #4#161 + #4#162 + #4#168 + #4#172 + #4#173 + #4#174;
#4#230 = #4#158 + #4#175 + #4#179 + #4#184 + #4#204 + #4#229;

|| Calcula el Debe
|SI tipo = "E";
    #5#086 = #5#087 + #5#088 + #5#089;
    #5#094 = #5#095 + #5#096 + #5#097;
    #5#098 = #5#099 + #5#100 + #5#101 +#5#102;
|FINSI;

#5#090 = #5#091 + #5#092;
#5#104 = #5#105 + #5#106 + #5#107 + #5#108;

#5#084 = #5#085 + #5#086 + #5#090 + #5#093 + #5#094 + #5#098 + #5#104 + #5#109 + #5#110;
#5#084 = #5#084 + #5#113 + #5#114 + #5#115 + #5#116 + #5#117 + #5#120 + #5#121;

|| Calcula el Haber
|SI tipo = "E";
    #6#083 = 0; #6#95 = 0;

    #6#084 = #6#085 + #6#086 + #6#087;
    #6#090 = #6#091 + #6#092 + #6#093;
    #6#096 = #6#097 + #6#098 + #6#099;
    #6#100 = #6#101 + #6#102 + #6#103;
    #6#104 = #6#105 + #6#106 + #6#107 + #6#108;

    #6#082 = #6#084 + #6#088 + #6#089 + #6#090 + #6#096;
    #6#082 = #6#082 + #6#100 + #6#104 + #6#109 + #6#112;
    #6#082 = #6#082 + #6#113 + #6#114 + #6#115 + #6#116;
|SINO;
    #6#083 = #6#084 + #6#090;
    #6#095 = #6#097 + #6#098 + #6#107 + #6#108;

    #6#082 = #6#083 + #6#095 + #6#109 + #6#112 + #6#113 + #6#114 + #6#115 + #6#116;
|FINSI;

|| Calculo Debe-Haber

#6#094 = 0; #6#110 = 0; #6#111 = 0; #6#117 = 0; #6#118 = 0; #6#119 = 0;

|SI tipo = "E";
    #5#103 = #6#084 + #6#088 + #6#089 + #6#090;
|SINO;
    #5#103 = #6#083;
|FINSI;

#5#103 = #5#103 - (#5#085 + #5#086 + #5#090 + #5#093 + #5#094 + #5#098);
|SI #5#103 < 0; #6#094 = -#5#103; #5#103 = 0; |FINSI;

|SI tipo = "E";
    #5#111 = #6#096 + #6#100 + #6#104 + #6#109;
|SINO;
    #5#111 = #6#095 + #6#109;
|FINSI;

#5#111 = #5#111 - (#5#104 + #5#109 + #5#110);
|SI #5#111 < 0; #6#110 = -#5#111; #5#111 = 0; |FINSI;

#5#112 = #5#103 + #5#111 - #6#094 - #6#110;
|SI #5#112 < 0; #6#111 = -#5#112; #5#112 = 0; |FINSI;

#5#118 = #6#112 +  #6#113 + #6#114 + #6#115 + #6#116;
#5#118 = #5#118 - (#5#113 + #5#114 + #5#115 + #5#116 + #5#117);
|SI #5#118 < 0; #6#117 = -#5#118; #5#118 = 0; |FINSI;

#5#119 = #5#112 + #5#118 - #6#111 - #6#117;
|SI #5#119 < 0; #6#118 = -#5#119; #5#119 = 0; |FINSI;

|SI #5#120 < 0; el141 = -#5#120; |SINO; el141 = #5#120; |FINSI;

|SI #5#119 ! 0;
    #5#122 = #5#119 - #5#120 - #5#121;
    |SI #5#122 < 0; #6#119 = -#5#122; #5#122 = 0; |FINSI;
|SINO;
    #5#122 = 0;
|FINSI;

|SI #6#118 ! 0;
    #6#119 = #6#118 + #5#120 + #5#121;
    |SI #6#119 < 0; #5#122 = -#6#119; #6#119 = 0; |FINSI;
|FINSI;

|FPRC;

|| ********************************************************************
|| -------------------------- Pasar Actual a Anterior y borrar actual.
|PROCESO borra;
 |SI FEstado3 = 0;
     |PARA x = 6; |SI x [ 69; |HACIENDO x = x + 1;
           y = x + 64;
           |SI fecact > 0; #3x = #3y; |FINSI;
           #3y = 0;
     |SIGUE;
     |SI fecact > 0; #3#134 = #3#135; |FINSI;
     #3#135 = 0;
 |FINSI;

 |SI FEstado4 = 0;
     |PARA x = 6; |SI x [ 78; |HACIENDO x = x + 1;
           y = x + 73;
           |SI fecact > 0; #4x = #4y; |FINSI;
           #4y = 0;
     |SIGUE;
     |SI fecact > 0; #4#153 = #4#152; #4#155 = #4#154; |FINSI;
     #4#152 = 0; #4#154 = 0;
 |FINSI;

 |SI FEstado5 = 0;
     |PARA x = 6; |SI x [ 44; |HACIENDO x = x + 1;
           y = x + 39;
           |SI fecact > 0; #5x = #5y; |FINSI;
           #5y = 0;
     |SIGUE;
 |FINSI;

 |SI FEstado6 = 0;
     |PARA x = 6; |SI x [ 43; |HACIENDO x = x + 1;
           y = x + 38;
           |SI fecact > 0; #6x = #6y; |FINSI;
           #6y = 0;
     |SIGUE;
 |FINSI;
|FPRC;
|| ********************************************************************
|| -------------------------- Igual Actual a la Contabilidad.
|PROCESO igual;
     |PARA x = 70; |SI x [ 133; |HACIENDO x = x + 1;
           y = x + 67;
           #3x = #3y;
     |SIGUE;
     #3#135 = #3#136;

     |PARA x = 79; |SI x [ 151; |HACIENDO x = x + 1;
           y = x + 79;
           #4x = #4y;
     |SIGUE;
     #4#152 = #4#156; #4#154 = #4#157;

     |PARA x = 45; |SI x [ 83; |HACIENDO x = x + 1;
           y = x + 39;
           #5x = #5y;
     |SIGUE;

     |PARA x = 44; |SI x [ 81; |HACIENDO x = x + 1;
           y = x + 38;
           #6x = #6y;
     |SIGUE;
|FPRC;

|| ********************************************************************
|PROCESO montacuen;
vari   = #1#2;
|QBF vari;
aste   = vari % -101;
long   = vari % 0;
longi  = long - 1;
longi  = 100 + longi;
numero = vari % longi;
|SI aste = "*";
    cuentad = numero + "            ";
    cuentad = cuentad % 112;
    cuentah = numero + "zzzzzzzzzzzz";
    cuentah = cuentah % 112;
|SINO;
    cuentad = #1#2;
    cuentah = #1#2;
|FINSI;
|FPRC;

|PROCESO pase;
 fecact = fec_act;
 fecant = fec_ant;
 feccon = fec_con;

|| --------------------------------------------------------------------------------------
|ABRE #3;
|ABRE #4;
|ABRE #5;
|ABRE #6;

|DDEFECTO #3; |DDEFECTO #4; |DDEFECTO #5; |DDEFECTO #6;

|LIBERA #3; #3#0 = empresa; #3#1 = anyo; #3#2 = registr; |LEE 110#3=; FEstado3 = FSalida;
|LIBERA #4; #4#0 = empresa; #4#1 = anyo; #4#2 = registr; |LEE 110#4=; FEstado4 = FSalida;
|LIBERA #5; #5#0 = empresa; #5#1 = anyo; #5#2 = registr; |LEE 110#5=; FEstado5 = FSalida;
|LIBERA #6; #6#0 = empresa; #6#1 = anyo; #6#2 = registr; |LEE 110#6=; FEstado6 = FSalida;


|SI act_ant_con ! "D"; |HAZ borra; |FINSI;

#3#0 = empresa; #3#1 = anyo; #3#2 = registr; #3#5 = tipo;
#4#0 = empresa; #4#1 = anyo; #4#2 = registr; #4#5 = tipo;
#5#0 = empresa; #5#1 = anyo; #5#2 = registr; #5#5 = tipo;
#6#0 = empresa; #6#1 = anyo; #6#2 = registr; #6#5 = tipo;

|PDEFECTO #3,136,201;
|PDEFECTO #4,156,231;
|PDEFECTO #5, 84,123;
|PDEFECTO #6, 82,120;

|SI tipo = "A"; |BUCLE planabre;  |FINSI;  || Lee lineas planillas - abreviado
|SI tipo = "E"; |BUCLE planexten; |FINSI;  || Lee lineas planillas - extenso

|HAZ totales;

|SI act_ant_con = "S"; |HAZ igual; |FINSI;

|SI FEstado3 = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
|SI FEstado4 = 0; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
|SI FEstado5 = 0; |GRABA 020#5a; |SINO; |GRABA 020#5n; |FINSI;
|SI FEstado6 = 0; |GRABA 020#6a; |SINO; |GRABA 020#6n; |FINSI;
|LIBERA #3;
|LIBERA #4;
|LIBERA #5;
|LIBERA #6;


|CIERRA #3;
|CIERRA #4;
|CIERRA #5;
|CIERRA #6;

|| --------------------------------------------------------------------------

|| Actualizar Acceso.
   |SI act_ant_con ! "D";
       |SI fecact > 0; fec_ant = fec_act; |FINSI;
        fec_act = "00.00.0000";
   |FINSI;

 |ABRE #7;               || Acceso
 #7#0 = empresa;
 #7#1 = anyo;
 #7#2 = registr;
 |LEE 040#7=;
 FEstado7 = FSalida;

 #7#0 = empresa;
 #7#1 = anyo;
 #7#2 = registr;
 #7#3 = descrip;
 #7#4 = fec_con;
 #7#5 = fec_ant;
 #7#6 = fec_act;
 #7#7 = tipo;
 #7#8 = fz;
 #7#9 = periodo;
 #7#10= nombre;

 |SI FEstado7 = 0; |GRABA 020#7a; |SINO; |GRABA 020#7n; |FINSI;
 |LIBERA #7;
 |CIERRA #7;
|FPRC;
