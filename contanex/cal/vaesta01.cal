|INCLUYE dscnex_v;
|FICHEROS;
 vaesta01 #0;
 vagrempc #1;
 vagrempl #2;
 vamanpax #3;

 vadeparc #5;
 vadeparl #6;
 vadesubg #7;

 vatr0004 #11;  || Trabajo Acumulados Cuentas/Departamentos
 vatr0003 #12;  || Trabajo Total Pax
 vatr0005 #15;  || Totales

 vadetota #198;  || Grupos Totalizadores
 vatr0007 #199;  || Trabajo Grupos Totalizadores
 vatr0008 #200;  || Solo el mes
|FIN;

|VARIABLES;
  nempresa = 0;
  inform1  = "vaes01";
  inform2  = "vaesr1";
  informe  = "";
  alfa1    = "";
  alfa2    = "";
  alfa3    = "";
  alfa4    = "";
  nCampo   = 0;
  nume1    = 0;
  nume2    = 0;
  nume3    = 0;
  nume4    = 0;
  para1    = 0;
  para2    = 0;
  para3    = 0;
  para4    = 0;
  fech1    = @;

  mes      = 0;
  letrames = "";

  agrup  = 0;
  any    = 0;
  d_dep  = 0;
  h_dep  = 0;
  t_anu  = "";
  s      = 0;
  cuc    = "";
  cu     = 0;
  d_digi = 0;
  h_digi = 0;
  d_cuen = "";
  h_cuen = "";

  sw        = 0;
  swalgun   = 0;
  swAgrup   = 0;
  swEmpre   = 0;

  &tporpax  = "";
  &ccdep    = "";
  &desdep   = "";
  &grdep    = 0;
  &mpax     = 0;
  &porpax   = 0;
  &porpaxd  = 0;
  &porpaxg  = 0;
  &porpaxi  = 0;
  &fecha    = "";
  &titulo   = "";
  &elmesh   = "";
  &swinf    = 0;
   cucu     = "";
   decu     = "";
  &pah      = "";
|FIN;

|INCLUYE i_ficher;
|INCLUYE litmes_v;

|| *************************************************************************
||                         CALCULOS DE PANTALLA
|| *************************************************************************

|CALCULO mayor; |TIPO 0;
 alfa1 = #0Campo > " ";
 #0Campo = alfa1;
 |PINTA #0Campo;

 |SI Campo = 15;
     |SI #0Campo = "D";
         |C_M #0#8,  1, "S";
         |C_M #0#12, 1, "S";
         |C_M #0#13, 1, "S";
     |SINO;
         |C_M #0#8,  1, "N";
         |C_M #0#12, 1, "N";
         |C_M #0#13, 1, "N";
    |FINSI;
 |FINSI;
|FCAL;

|PROCESO tipo8; |TIPO 8;
 |HAZ vbase;
 |SI dirfich0 = "*";
     |MENAV "    NO EXISTE PROGRAMA DE CONTABILIDAD";
     |PTEC 802;
     |PTEC 815;
 |FINSI;
|FPRC;

|CALCULO defec; |TIPO 7;
 |SI dirfich0 = "*"; |ACABA; |FINSI;
 fech1 = ~;
 alfa1 = fech1 % -104;
 #0#1 = alfa1; |PINTA #0#1;
 alfa2 = fech1 % 402;
 #0#5  = alfa2; |PINTA #0#5;
 mes = #0#5;
 |HAZ mesletra;
 #0#11 = letrames; |PINTA #0#11;
|FCAL;

|PROCESO launo;
 #30#2 = #2#2;
 #30#3 = 0;
 |LEE 011#30];
 |SI FSalida = 0;  |Y #30#2 = #2#2;
     elinim = #30#11;
     |ERROR10;
 |FINSI;
|FPRC;

|CALCULO leeagrup; |TIPO 6;
 |HAZ lect_agrup;
 |ATRI I; |PINTA 0826, #1#1; |ATRI 0;
 |SI swAgrup = 1;
     |MENAV "    Error. NO EXISTE AGRUPACION !";
     |ERROR;
     |ACABA;
 |FINSI;
 |CIERRA #1;
 elinim = 1;
 |ABRE #30;
 |BUCLELIN 2launo#1;
 |CIERRA #30;
|FCAL;

|PROCESO lect_agrup;    || Lee la Agrupacion
 swAgrup = 0;
 |ABRE #1;
 |DDEFECTO #1;
 #1#0 = #0#0;
 |LEE 001#1=;
 |SI FSalida ! 0;
     swAgrup = 1;
 |FINSI;
 |CIERRA #1;
|FPRC;

|CALCULO pintames; |TIPO 0;
  |SI dirfich0 = "*"; |ACABA; |FINSI;
  |SI #0Campo ! 0; |Y #0Campo ! 13;
      mes = elinim + (#0Campo - 1);   || Operacion para saber que mes es
  |SINO;
      mes = #0Campo;
  |FINSI;
  |HAZ mesletra;
  nume1 = Campo + 6;
  #0nume1 = letrames;
  |PINTA #0nume1;
  |SI Campo = 5;   |Y #0#4  > #0#5; |MENAV "    Error de Entrada ..."; |ERROR; |FINSI;
|FCAL;

|CALCULO mesletra;
  |SI mes = 0;  letrames = "Apertura  "; |FINSI;
  |SI mes = 1;  letrames = "Enero     "; |FINSI;
  |SI mes = 2;  letrames = "Febrero   "; |FINSI;
  |SI mes = 3;  letrames = "Marzo     "; |FINSI;
  |SI mes = 4;  letrames = "Abril     "; |FINSI;
  |SI mes = 5;  letrames = "Mayo      "; |FINSI;
  |SI mes = 6;  letrames = "Junio     "; |FINSI;
  |SI mes = 7;  letrames = "Julio     "; |FINSI;
  |SI mes = 8;  letrames = "Agosto    "; |FINSI;
  |SI mes = 9;  letrames = "Septiembre"; |FINSI;
  |SI mes = 10; letrames = "Octubre   "; |FINSI;
  |SI mes = 11; letrames = "Noviembre "; |FINSI;
  |SI mes = 12; letrames = "Diciembre "; |FINSI;
  |SI mes = 13; letrames = "Cierre    "; |FINSI;
|FCAL;

|CALCULO hasdep; |TIPO 0;
 |SI #0#3 < #0#2;
     |MENAV "    Error de Entrada ...";
     |ERROR;
 |FINSI;
|FCAL;

|PROCESO alfinal; |TIPO 7;
 alfa1 = "ESTADISTICA DE ";
 alfa2 = #0#11; |QBF alfa2;
 alfa3 = #0#1; alfa3 = alfa3 % -102;
 #0#6 = alfa1 + alfa2 + "-" + alfa3;
 |PINTA #0#6;
 |PTEC 816;
|FPRC;

|| **************************************************************************
|| **************************************************************************
|| ********* CALCULOS PARA CREAR LOS FICHEROS AUXILIARES ********************

|| ............. Fichero de PAX
|PROCESO carga_pax;  || Lee las empresa de la Agrupacion
 swEmpre = 0;
 #3#0 = #2#2;
 #3#1 = any;
 |LEE 001#3=;
 |SI FSalida ! 0;
     |ACABA;
 |FINSI;

 #12#0  = agrup;  || Agrupacion
 #12#26 = any;    || Any
 |LEE 101#12=;
 |SI FSalida ! 0;
     |DDEFECTO #12;
     #12#0  = agrup;  || Agrupacion
     #12#26 = any;    || Departamento
     |HAZ l_meses;    || Literal meses
     |GRABA 020#12b;
 |FINSI;
 |SI d_mes [  1;  |Y h_mes ]  1;  #12#13 = #12#13 + #3#2;  |FINSI;
 |SI d_mes [  2;  |Y h_mes ]  2;  #12#14 = #12#14 + #3#3;  |FINSI;
 |SI d_mes [  3;  |Y h_mes ]  3;  #12#15 = #12#15 + #3#4;  |FINSI;
 |SI d_mes [  4;  |Y h_mes ]  4;  #12#16 = #12#16 + #3#5;  |FINSI;
 |SI d_mes [  5;  |Y h_mes ]  5;  #12#17 = #12#17 + #3#6;  |FINSI;
 |SI d_mes [  6;  |Y h_mes ]  6;  #12#18 = #12#18 + #3#7;  |FINSI;
 |SI d_mes [  7;  |Y h_mes ]  7;  #12#19 = #12#19 + #3#8;  |FINSI;
 |SI d_mes [  8;  |Y h_mes ]  8;  #12#20 = #12#20 + #3#9;  |FINSI;
 |SI d_mes [  9;  |Y h_mes ]  9;  #12#21 = #12#21 + #3#10; |FINSI;
 |SI d_mes [ 10;  |Y h_mes ] 10;  #12#22 = #12#22 + #3#11; |FINSI;
 |SI d_mes [ 11;  |Y h_mes ] 11;  #12#23 = #12#23 + #3#12; |FINSI;
 |SI d_mes [ 12;  |Y h_mes ] 12;  #12#24 = #12#24 + #3#13; |FINSI;

 #12#25 = #12#13 + #12#14 + #12#15 + #12#16 + #12#17;
 #12#25 = #12#25 + #12#18 + #12#19 + #12#20 + #12#21;
 #12#25 = #12#25 + #12#22 + #12#23 + #12#24;

 |GRABA 020#12a;
 |LIBERA #12;
 sw = 1;
|FPRC;
|| ...............................................................


|| ............. Fichero de Departamentos / Cuentas
|PROCESO grabar;
 cucu = #6#2;
 decu = #6#3;
 |SI #6#6 ! 0; |Y #0#13 = "S";
     |HAZ leesubgru;
 |FINSI;
 #11#0 = agrup;  || Agrupacion
 #11#1 = #6#0;   || Departamento
 #11#2 = #6#4;   || Tipo G/I;
 #11#3 = cucu;   || Cuenta
 |LEE 101#11=;
 |SI FSalida ! 0;
     |DDEFECTO #11;
     #11#0  = agrup;  || Agrupacion
     #11#1  = #6#0;   || Departamento
     #11#2  = #6#4;   || Tipo G/I;
     #11#3  = cucu;   || Cuenta
     #11#4  = decu;   || Titulo
     #11#18 = any;    || A¤o
     |GRABA 020#11b;
 |FINSI;
 s = 1; |SI #6#5 = "H"; s = -1; |FINSI;

 |SI d_mes [  1;  |Y h_mes ]  1;
     #11#5  = #11#5  + ((((s * #cacuenta#11) + (s * #cacuenta#14)) / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  2;  |Y h_mes ]  2;
     #11#6  = #11#6  + (((s * #cacuenta#17)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  3;  |Y h_mes ]  3;
     #11#7  = #11#7  + (((s * #cacuenta#20)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  4;  |Y h_mes ]  4;
     #11#8  = #11#8  + (((s * #cacuenta#23)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  5;  |Y h_mes ]  5;
     #11#9  = #11#9  + (((s * #cacuenta#26)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  6;  |Y h_mes ]  6;
     #11#10 = #11#10 + (((s * #cacuenta#29)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  7;  |Y h_mes ]  7;
     #11#11 = #11#11 + (((s * #cacuenta#32)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  8;  |Y h_mes ]  8;
     #11#12 = #11#12 + (((s * #cacuenta#35)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [  9;  |Y h_mes ]  9;
     #11#13 = #11#13 + (((s * #cacuenta#38)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [ 10;  |Y h_mes ] 10;
     #11#14 = #11#14 + (((s * #cacuenta#41)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [ 11;  |Y h_mes ] 11;
     #11#15 = #11#15 + (((s * #cacuenta#44)  / enConversor) ! EURODBMOD);
 |FINSI;

 |SI d_mes [ 12;  |Y h_mes ] 12;
     #11#16 = #11#16 + (((s * #cacuenta#47)  / enConversor) ! EURODBMOD);
 |FINSI;

 #11#17 = #11#5  + #11#6  + #11#7  + #11#8  + #11#9;
 #11#17 = #11#17 + #11#10 + #11#11 + #11#12 + #11#13;
 #11#17 = #11#17 + #11#14 + #11#15 + #11#16;

 |GRABA 020#11a;
 |LIBERA #11;
 sw = 1;
|FPRC;

|DEFBUCLE vapascon0;
 #cacuenta#1;
 3;
 d_cuen, "S";
 h_cuen, "S";
 e;
 NULL, grabar;
|FIN;

|PROCESO lee_depar;
 d_cuen = #6#2; |QBF d_cuen;
 h_cuen = (d_cuen + "zzzzzzzzzzzz") % 112;
 d_digi = 0; h_digi = 9;
 |BUCLE vapascon0;
|FPRC;

|DEFBUCLE leedepar;
 #6#1;
 ;
 d_dep, 000;
 h_dep, 999;
 e;
 NULL, lee_depar;
|FIN;

|| ...............................................................
|PROCESO encuentra_emp;
 alfa1 = ("00" + #30#26) % -102;
 alfa2 = any; alfa2 = alfa2 % -102;
 |SI alfa1 = alfa2;
     alfa3 = #30#2; alfa3 = "00000" + alfa3; alfa3 = alfa3 % -105;
     alfa4 = #30#3; alfa4 = "0"     + alfa4; alfa4 = alfa4 % -101;
     dirfich = dirfich0 + alfa3 + alfa4 + "/";
     |ERROR10;
     swEmpre = 1;
 |FINSI;
|FPRC;

|DEFBUCLE verempresa;
 #30#1;
 ;
 nempresa, 0;
 nempresa, 9;
 e;
 NULL, encuentra_emp;
|FIN;

|PROCESO carga_cta;  || Lee las empresa de la Agrupacion
 swEmpre = 0;
 nempresa = #2#2;
 |BUCLE verempresa;
 |SI swEmpre = 1;
     enEmpresa  = #30#2;
     enPerConta = #30#3;
     |HAZ EnConversor;

     |PATH_DAT #20 dirfich;
     |BUCLE leedepar;
 |FINSI;
|FPRC;
|| ...............................................................
|| ...............................................................

|| ********* CALCULOS PARA LANZAR LISTADO ***********************************
|PROCESO &grupo;         || va totalizando por grupos
|DDEFECTO #198;
|ABRE #198;
    #198#0 = grdep;
|LEE 000#198=;
|CIERRA #198;

|DDEFECTO #199;
|ABRE #199;
    #199#0 = grdep;
    #199#16 = tipo;
|LEE 101#199=;
|SI FSalida ! 0;
        #199#1 = #198#1;   || descripcion grupo
    |GRABA 020#199b;
|FINSI;
    #199#2 = #199#2 + #15#28;        || enero
    #199#3 = #199#3 + #15#29;        || febrero
    #199#4 = #199#4 + #15#30;        || marzo
    #199#5 = #199#5 + #15#31;        || abril
    #199#6 = #199#6 + #15#32;        || mayo
    #199#7 = #199#7 + #15#33;        || junio
    #199#8 = #199#8 + #15#34;        || julio
    #199#9 = #199#9 + #15#35;        || agosto
    #199#10 = #199#10 + #15#36;      || septiembre
    #199#11 = #199#11 + #15#37;      || octubre
    #199#12 = #199#12 + #15#38;      || noviembre
    #199#13 = #199#13 + #15#39;      || diciembre

    #199#14 = #199#2 + #199#3 + #199#4 + #199#5 + #199#6 + #199#7 + #199#8;
    #199#14 = #199#14 + #199#9 + #199#10 + #199#11 + #199#12 + #199#13;      || total

|SI t_anu = "S";
    |SI #12#25 ! 0;
        #199#15 = #199#14 / #12#25;
    |FINSI;
|SINO;
    |SI mpax ! 0;
            nume1 = h_mes + 1; #199#15 = #199nume1 / mpax;
    |FINSI;
|FINSI;

|GRABA 020#199a;
|LIBERA #199;
|CIERRA #199;
|FPRC;

|PROCESO totgrupo1;                     || Total por grupo
|SI #199#14 = 0;    |ACABA;   |FINSI;

|DDEFECTO #198;
|ABRE #198;
    #198#0 = #199#0;
|LEE 000#198=;
|CIERRA #198;

   swinf = 3;

   |SI #0#15 = "D";
       |PRINT;
   |SINO;
       #200#0 = desdep;
       nCampo = 1  + #0#5;   #200#1 = #199nCampo;
       nCampo = 12 + #0#5;   #200#2 = #12nCampo;
       #200#3 = #200#1 / #200#2;

       #200#4 = #199#14;
       #200#5 = #12#25;
       #200#6 = #200#4 / #200#5;
       |PRINT;
   |FINSI;
|FPRC;

|DEFBUCLE totgrupo;
 #199#1;
 ;
  0, tipo;
 99, tipo;
 ;
 NULL, totgrupo1;
|FIN;

|PROCESO totdepar;  || Total por departamento
 porpaxd = 0;
 |SI t_anu = "S";
     |SI #12#25 ! 0;
         porpaxd = #15#40 / #12#25;
     |FINSI;
 |SINO;
     |SI mpax ! 0;
         nume1 = h_mes + 27; porpaxd = #15nume1 / mpax;
     |FINSI;
 |FINSI;

 swinf = 1;
 |SI #0#15 = "D";
     |PRINT;
 |SINO;
     #200#0 = desdep;
     nCampo = 27 + #0#5;   #200#1 = #15nCampo;
     nCampo = 12 + #0#5;   #200#2 = #12nCampo;
     #200#3 = #200#1 / #200#2;

     #200#4 = #15#40;
     #200#5 = #12#25;
     #200#6 = #200#4 / #200#5;
     |PRINT;
 |FINSI;
|FPRC;

|PROCESO totgasin;  || Total Gastos o Ingresos
 porpaxg = 0;
 porpaxi = 0;
 |SI t_anu = "S";
     |SI #12#25 ! 0;
         porpaxg = #15#14 / #12#25;
         porpaxi = #15#27 / #12#25;
     |FINSI;
 |SINO;
     |SI mpax ! 0;
         nume1 = h_mes + 1;  porpaxg = #15nume1 / mpax;
         nume1 = h_mes + 14; porpaxi = #15nume1 / mpax;
     |FINSI;
 |FINSI;

 swinf = 2;
 |SI #0#15 = "D";
     |PRINT;
 |SINO;
     |SI tipo = "G";
         #200#0 = desdep;
         nCampo = 1  + #0#5;   #200#1 = #15nCampo;
         nCampo = 12 + #0#5;   #200#2 = #12nCampo;
         #200#3 = #200#1 / #200#2;

         #200#4 = #15#14;
         #200#5 = #12#25;
         #200#6 = #200#4 / #200#5;
     |SINO;
         #200#0 = desdep;
         nCampo = 14 + #0#5;   #200#1 = #15nCampo;
         nCampo = 12 + #0#5;   #200#2 = #12nCampo;
         #200#3 = #200#1 / #200#2;

         #200#4 = #15#27;
         #200#5 = #12#25;
         #200#6 = #200#4 / #200#5;
     |FINSI;

     |PRINT;
 |FINSI;
|FPRC;

|PROCESO total;   || General
 porpaxd = 0;
 |PARA para1 = 1; |SI para1 [ 13; |HACIENDO para1 = para1 + 1;
       nume1 = para1 +  1; nume2 = para1 + 14; nume3 = para1 + 27;
       #15nume3 = #15nume2 - #15nume1;
 |SIGUE;
 |SI t_anu = "S";
     |SI #12#25 ! 0;
         porpaxd = #15#40 / #12#25;
     |FINSI;
 |SINO;
     |SI mpax ! 0;
         nume1 = h_mes + 27; porpaxd = #15nume1 / mpax;
     |FINSI;
 |FINSI;

 nCampo = 27 + #0#5;   #200#1 = #15nCampo;
 nCampo = 12 + #0#5;   #200#2 = #12nCampo;
 #200#3 = #200#1 / #200#2;

 #200#4 = #15#40;
 #200#5 = #12#25;
 #200#6 = #200#4 / #200#5;

 |PIEINF;
|FPRC;

|PROCESO leedepar;
 |ABRE #5;
 |DDEFECTO #5;
 #5#0 = ccdep;
 |LEE 001#5=;
 desdep = #5#1;
 grdep = #5#3;
 porpaxd = 0;
 |CIERRA #5;
 |PDEFECTO #15,28,41;
|FPRC;

|PROCESO imprime;
 |SI sw = 0;
     ccdep = #11#1;
     |HAZ leedepar;
     sw = 1;
 |FINSI;
 |SI ccdep ! #11#1;
     |HAZ totdepar;
     ccdep = #11#1;
     |HAZ leedepar;
 |FINSI;

 porpax = 0;
 |SI t_anu = "S";  || Por Pax anual
     |SI #12#25 ! 0;
         porpax  = #11#17 / #12#25;
     |FINSI;
 |SINO;
     |SI mpax ! 0;
         nume1 = h_mes + 4;  porpax = #11nume1 / mpax;
     |FINSI;
 |FINSI;

 swinf = 0;
 |SI #0#12 = "D";
     |SI #0#15 = "D";
         |PRINT;
     |SINO;
          #200#0 = #11#4;
          nCampo = 4  + #0#5;   #200#1 = #11nCampo;
          nCampo = 12 + #0#5;   #200#2 = #12nCampo;
          #200#3 = #200#1 / #200#2;

          #200#4 = #11#17;
          #200#5 = #12#25;
          #200#6 = #200#4 / #200#5;
          |PRINT;
     |FINSI;
 |FINSI;

 |PARA para1 = 5; |SI para1 [ 17; |HACIENDO para1 = para1 + 1;
       para2 = para1 + 23; #15para2 = #15para2 + #11para1;
       |SI tipo = "G"; para2 = para1 -  3; #15para2 = #15para2 + #11para1; |FINSI;
       |SI tipo = "I"; para2 = para1 + 10; #15para2 = #15para2 + #11para1; |FINSI;
 |SIGUE;
 swalgun = 1;
|FPRC;

|DEFBUCLE lregistros;
 #11#1;
 ;
 agrup, d_dep, tipo, d_cuen;
 agrup, h_dep, tipo, h_cuen;
 e;
 NULL, imprime;
|FIN;

|| **************************************************************************
|| ********* PROCESO PARA CREAR INFORME *************************************
|| **************************************************************************
|PROCESO elproceso; |TIPO 3;
  |SI dirfich0 = "*"; |ACABA; |FINSI;

  |SI #0#14 = "S";
     pah = "1";
  |SINO;
     pah = " ";
  |FINSI;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  alfa1 = #0#5; alfa1 = ("00" + alfa1) % -102;
  |SI #0#12 = "D"; informe = inform1; |SINO; informe = inform2; |FINSI;
  informe = informe + alfa1;
  |SI #0#15 = "M";  informe = "vaesta01";  |FINSI;

  |INFOR informe;
  |SI FSalida ! 0;
      |FINIMP;
      |ACABA;
  |FINSI;

  |HAZ lect_agrup;
  |SI swAgrup = 1;
      |MENAV "    ERROR. NO EXISTE AGRUPACION! ";
  |FINSI;

  titulo = #0#6;
  alfa1  = #0#7;
  fecha  = (alfa1 % 102) + #1#2 + (alfa1 % 402) + #1#3 + (alfa1 % -104);

  agrup  = #0#0;
  any    = #0#1;
  d_dep  = #0#2;
  h_dep  = #0#3;
  d_mes  = #0#4;
  h_mes  = #0#5;
  elmesh = #0#11;
  t_anu  = #0#8;

  tporpax  = "Anual"; |SI t_anu = "N"; tporpax = "Mensual"; |FINSI;

  || ........................... Preparando Ficheros Auxiliares
  |D_CUADRO 2134, 2355;
  |ATRI P;
  |PINTA 2235, "     <TEMPORAL>     ";
  |ATRI 0;

  |HAZ fichero;
  alfa1 = ("a" + fichero) % 108;
  alfa2 = ("b" + fichero) % 108;
  alfa3 = ("c" + fichero) % 108;
  |NOME_DAT #11 alfa1;
  |NOME_DAT #12 alfa2;
  |NOME_DAT #199 alfa3;

  |DELINDEX #11;
  |DELINDEX #12;
  |DELINDEX #199;

  sw = 0;
  |ABRE #11;
  |BUCLELIN 2carga_cta#1;
  |CIERRA #11;
  |SI sw = 0;
      |MENAV "    NO EXISTEN DATOS EN LAS EMPRESAS DE LA AGRUPACION ";
      |DELINDEX #11;
      |DELINDEX #12;
      |DELINDEX #199;
      |ACABA;
  |FINSI;
  |ABRE #3;
  |ABRE #12;
  |BUCLELIN 2carga_pax#1;
  |CIERRA #3;
  |CIERRA #12;
|| *******************************************************************
  |ATRI P;
  |PINTA 2235, " <LANZANDO INFORME> ";
  |ATRI 0;

  |ABRE #12;       || Lee la agrupacion/a¤o para Pax
  |DDEFECTO #12;
  #12#0  = agrup;  || Agrupacion
  #12#26 = any;    || Any
  |LEE 000#12=;
  nume1 = h_mes + 12;
  mpax  = #12nume1;
  |CIERRA #12;

  |DDEFECTO #15;
  d_cuen = "            ";
  h_cuen = "zzzzzzzzzzzz";
  sw = 0;
  tipo = "G";
  |BUCLE lregistros;
  |SI sw = 1;
      |HAZ totdepar;
      |BUCLE totgrupo;
      |HAZ totgasin;
  |FINSI;
  sw = 0;
  tipo = "I";
  |BUCLE lregistros;
  |SI sw = 1;
      |HAZ totdepar;
      |BUCLE totgrupo;
      |HAZ totgasin;
  |FINSI;
  |SI swalgun = 1;
      |HAZ total;
  |FINSI;

  |FININF;
  |FINIMP;
  |DELINDEX #11;
  |DELINDEX #12;
  |DELINDEX #199;
|FPRC;

|PROCESO leesubgru;
     |ABRE #7;
     #7#0 = #6#0;
     #7#1 = #6#6;
     |LEE 000#7=;
     |SI FSalida = 0;
          cu =  ((1000 + (#7#0 * 10)) + #7#1);
          cuc = cu;
          cuc = cuc % -103;
          cucu = "Sub. " + cuc;
          decu = #7#2;
     |FINSI;
     |CIERRA #7;
|FPRC;
