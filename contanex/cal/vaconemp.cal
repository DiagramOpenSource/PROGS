|INCLUYE dscnex_v;
|FICHEROS;
  vaconemp #49;

||  vaaccbal #1;  || sustituir por lo que sera el fichero de empresas
|FIN;

|VARIABLES;
  linea = 0;
  dd_ff = "";
|FIN;

|INCLUYE i_ficher;

|CALCULO lee_empresas1;
  linea = linea + 1;
  |DDEFECTO #49;
  #49#0 = linea;
  #49#1 = #30#2;
  #49#2 = #30#3;
  #49#3 = #30#1;
  |SI #30#26 < 80;
      #49#4 = 2000 + #30#26;
  |SINO;
      #49#4 = 1900 + #30#26;
  |FINSI;
  |GRABA 020#49n;
  |LIBERA #49;
|FCAL;

|DEFBUCLE lee_empresas;
 #30#1;
 ;
     0, 0;
 99999, 9;
 e;
 NULL, NULL, NULL, NULL, NULL, lee_empresas1;
 #30#1, #30#2, #30#3;
|FIN;

/*  .... bucle para la empresa de esta aplicacion si lo ponemos
|CALCULO lee_empresas2;
  linea = linea + 1;
  |DDEFECTO #49;
  #49#0 = linea;
  #49#1 = #1#0;
  #49#2 = "-";
  #49#3 = #1#10;
  #49#4 = #1#1;
  |GRABA 020#49n;
  |LIBERA #49;
|FCAL;

|DEFBUCLE lee_vempr;
 #1#1;
 ;
     0, 0000, 00;
 99999, 9999, 99;
 e;
 NULL, NULL, NULL, NULL, NULL, lee_empresas2;
 #1#10,#1#0,#1#1;
|FIN;
*/

|CALCULO min;
    #49#0 = 1;
|FCAL;

|CALCULO max;
    #49#0 = 9999;
|FCAL;

|PROGRAMA;
  |ATRI P;  |MENSA "    Cargando Opcion ...";  |ATRI 0;
  |HAZ fichero;
  |NOME_DAT #49 fichero;
  |DELINDEX #49;
  |ABRE #49;

/* || si ponemos un fichero de Empresas
  |SI dirfich0 ! "*";
      |BUCLE lee_empresas;
  |SINO;
      |BUCLE lee_vempr;
  |FINSI;
*/

  |BUCLE lee_empresas;
  |CIERRA #49;
  |BLIN 4;
  |PINPA #0#49;
  |ENTLINEAL #1#49, 1, 4, 20, 0, min, max;
  |DELINDEX #49;
|FPRO;

|CALCULO recoge; |TIPO 0;
  |SI FSalida = 0;
      r_emp = #49#1;
      r_per = #49#2;
      r_nom = #49#3;
      r_eje = #49#4;
      |PTEC 807;
  |FINSI;
|FCAL;
