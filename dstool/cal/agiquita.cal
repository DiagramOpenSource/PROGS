|FICHEROS;
    agiquita #0;
    agiquitm #1;    || bloqueo de ficheros en proceso
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &quitanom = "";                          || nombre fichero
    &quitadir = "";                          || directorio del fichero

    punto_coma = "";
    topep = 0;
    dolar1 = "";
    dolar2 = "";
    pwd_sal = "";

    fabre = "";
    field = "";
    fcanl = "";
|FIN;
____________________________________/
|RUTINA pwd;
    pwd_sal = "";
|DFICE pwd_sal;
|FRUT;

|RUTINA parametros;
    alfa1 = PARAMETRO % 0;    topep = alfa1;
    dolar1 = "";
    dolar2 = "";
    elsw1 = 0;
    punto_coma = &59;
|PARA para1 = 1; |SI para1 [ topep; |HACIENDO para1 = para1 + 1;
        alfa1 = PARAMETRO % (N\para1 * 100 + 1);
    |SI alfa1 = punto_coma;
        |SI elsw1 = 0;
                elsw1 = 1;
        |SINO;
                elsw1 = 99;
            |MENAV "    Exceso de Parametros (maximo 2) ...";
        |FINSI;
    |SINO;
        |SI elsw1 = 0;   dolar1 = dolar1 + alfa1; |FINSI;
        |SI elsw1 = 1;   dolar2 = dolar2 + alfa1; |FINSI;
    |FINSI;
|SIGUE;
|FRUT;
____________________________________/
|PROCESO el_proceso;
    fabre = "rb  " + quitadir + "/" + quitanom;
|FABRE fabre;
|SI FSalida ] 0;
        fcanl = FSalida;
        field = fcanl + " 1";
    |FLEE field;
    |PARA; |SI FSalida ] 0; |HACIENDO;
            field = fcanl + " 1";
        |FLEE field;
    |SIGUE;
    |FCIERRA fcanl;
|FINSI;
|FPRC;

|PROCESO iniciar;
|QBT quitanom;
|QBT quitadir;

|SI quitadir = "";       || si el directorio no viene cargado coge el actual
    |HAZ pwd;
        quitadir = pwd_sal;
|FINSI;

    quitanom = quitanom - ".dat";  || a¤ade (si no la tiene) la extension
    quitanom = quitanom + ".dat";

    #0#0 = quitadir;           || directorio fichero
    #0#1 = quitanom + ".dat";  || nombre fichero
|PINDA #0#0;

|AVISO;
|BLIN 4;
|CONFI "0400NEste proceso exige precaucion en su uso, continuar (S/N): ";
|SI FSalida = 0;
    |ABRE #1;
        #1#0 = #0#0;
        #1#1 = #0#1;
    |LEE 000#1=;
    |SI FSalida ! 0;
            #1#2 = Usuario % 810;
        |GRABA 020#1b;
        |HAZ el_proceso;
        |BORRA 020#1a;
    |SINO;
            alfa1 = "    El usuario [" + #1#2 + "] esta procesando este fichero.";
        |MENAV alfa1;
        |MENAV "    Tendra que esperar su turno ...";
    |FINSI;
    |LIBERA #1;
    |CIERRA #1;
|FINSI;
|FPRC;

|PROGRAMA;
|CLS;
|CABEZA "Depurador .DAT";
|PINPA #0#0;
|SI quitanom ! "";            || viene con |Sub_Ejecuta
    |HAZ iniciar;
|SINO;
    |HAZ parametros;          || viene con opcion de menu
        quitanom = dolar1;
        quitadir = dolar2;
    |SI quitanom ! "";
        |HAZ iniciar;
    |SINO;
        |C_M #0#0, 1, "S";
        |C_M #0#1, 1, "S";
        |ENDATOS #1#0;
        |SI FSalida = 0;
                quitanom = #0#1;   |QBT quitanom;
            |SI quitanom ! "";
                    quitadir = #0#0;
                |HAZ iniciar;
            |FINSI;
        |FINSI;
    |FINSI;
|FINSI;
|FPRO;
