|FICHEROS;
     presu001 #1;
     presu002 #2,MANTE;
     presu003 #3,MANTE;
     &goparame@ #9;
     &gopre001@ #10;
     &gopre002@ #20;
     &gopre003@ #30;
     &gopre004@ #40;
     gomantho@ #50;
     gomantl1@ #51;
|FIN;

|VARIABLES;
     i = 0;
     aAlfa = "";
     aPathDef = "";
     aPathDat = "";
|FIN;

|PROCESO Calcugopre002;
     |HAZ Calgopre002;
|FPRC;

|DEFBUCLE Calcugopre002;
     #20#1003;
     ;
     #10#0, #10#1, 001;
     #10#0, #10#1, 999;
     ;
     NULL, Calcugopre002;
|FIN;

|PROCESO Actualiza;
     |SI #2#4 ! "*"; |ACABA; |FINSI;

     #3#0 = #2#0;
     #3#1 = #2#1;
     |LEE 020#3=;

     #10#0 = #2#0;
     #10#1 = #2#1;
     |LEE 000#10=;
     |SI FSalida ! 0;
          |PARA i = 2; |SI i [ 56; |HACIENDO i = i + 1;
               #10i = #3i;
          |SIGUE;
          |BUCLE Calcugopre002;
          |GRABA 020#10n;
     |FINSI;
|FPRC;

|DEFBUCLE Actualiza;
     #2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Actualiza;
|FIN;

|PROCESO Tecla; |TIPO;
     |SI FSalida = 0; |Y #2Campo = Contenido;
          |SI #2#4 = "*";
               #2#4 = "";
               |GRABA 020#2a;
          |SINO;
               #2#4 = "*";
               |PUSHV 0501 2380;
               |BLANCO 0901 1580;
               |DDEFECTO #3;
               |ABRE #3
               #3#0 = #2#0;
               #3#1 = #2#1;
               |LEE 101#3=;
               |SI FSalida ! 0;
                    #3#2 = #2#2;
                    #3#3 = #2#3;
                    |GRABA 020#3b;
               |FINSI;
               |PINPA #0#3;
               |PINDA #0#3;
               |ENDATOS #2#3;
               |SI FSalida = 0;
                    #2#2 = #3#2;
                    #2#3 = #3#3
                    |GRABA 020#2a;
                    |GRABA 020#3a;
               |FINSI;
               |CIERRA #3;
               |POPV;
          |FINSI;
          |LEE 000#2=;
          |PINTA #2#2;
          |PINTA #2#3;
          |PINTA #2#4;
     |FINSI;
|FPRC;

|PROCESO Min;
     #2#0 = "     ";
     #2#1 = 000001;
|FPRC;

|PROCESO Max;
     #2#0 = "zzzzz";
     #2#1 = 999999;
|FPRC;

|PROCESO gopre002;
     #10#0 = #20#0;
     #10#1 = #20#1;
     |LEE 000#10=;
     |SI FSalida = 0; |ACABA; |FINSI;

     |DDEFECTO #2;
     #2#0 = #20#0;
     #2#1 = #20#1
     |LEE 000#2=;
     |SI FSalida ! 0;
          |SELECT #3#51;
          #51#3 = #2#0;
          #51#4 = #2#1;
          |LEE 000#51=;
          |SI FSalida = 0;
               #50#0 = #51#0;
               #50#1 = #51#1;
               |LEE 000#50=;
               |SI FSalida = 0;
                    #2#2 = #50#2;
                    #2#3 = #50#8;
               |FINSI;
               |GRABA 000#2n;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE gopre002;
     #20#1003;
     ;
     "     ", 000001, 001;
     "zzzzz", 999999, 999;
     ;
     NULL, gopre002;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     aPathDef = #1#1; |QBF aPathDef;
     aPathDef = aPathDef + "def/";
     aPathDat = #1#1; |QBF aPathDat;
     aPathDat = aPathDat + "fich/" + (("00000" + #1#2) % -105) + "/";
     aAlfa = aPathDef + "gopre001"; |CARGA_DEF aAlfa, gopre001@;
     |SI FSalida ! 0;
          |MENAV "0000No existe gestion en el directorio indicado";
          |ACABA;
     |FINSI;
     aAlfa = aPathDef + "gopre002"; |CARGA_DEF aAlfa, gopre002@;
     aAlfa = aPathDef + "gopre003"; |CARGA_DEF aAlfa, gopre003@;
     aAlfa = aPathDef + "gopre004"; |CARGA_DEF aAlfa, gopre004@;
     aAlfa = aPathDef + "gomantho"; |CARGA_DEF aAlfa, gomantho@;
     aAlfa = aPathDef + "gomantl1"; |CARGA_DEF aAlfa, gomantl1@;
     aAlfa = aPathDef + "goparame"; |CARGA_DEF aAlfa, goparame@;
     |PATH_DAT #gopre001@#aPathDat#;
     |PATH_DAT #gopre002@#aPathDat#;
     |PATH_DAT #gopre003@#aPathDat#;
     |PATH_DAT #gopre004@#aPathDat#;
     |PATH_DAT #gomantho@#aPathDat#;
     |PATH_DAT #gomantl1@#aPathDat#;
     |PATH_DAT #goparame@#aPathDat#;

     |DELINDEX #2;
     |DELINDEX #3;
     |ABRE #2;
     |ABRE #50;
     |ABRE #51;
     |ABRE #10;
     |BUCLE gopre002;
     |CIERRA #10;
     |CIERRA #51;
     |CIERRA #50;
     |CIERRA #2;

     |PINPA #0#2;
     |ENTLINEAL #1#2, 1, 4, 22, 0, Min, Max;

     |CONFI "0000NActualizar gestion?";
     |SI FSalida = 0;
          |ABRE #3;
          |ABRE #10;
          |ABRE #20;
          |ABRE #30;
          |ABRE #9; |LEE 000#9p; |CIERRA #9;
          |BUCLE Actualiza;
          |CIERRA #30;
          |CIERRA #2;
          |CIERRA #1;
          |CIERRA #3;
     |FINSI;

     |DESCARGA_DEF #goparame@;
     |DESCARGA_DEF #gomantl1@;
     |DESCARGA_DEF #gomantho@;
     |DESCARGA_DEF #gopre004@;
     |DESCARGA_DEF #gopre003@;
     |DESCARGA_DEF #gopre002@;
     |DESCARGA_DEF #gopre001@;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #1;
     |LEE 101#1p;
     |SI FSalida ! 0;
          |DBASE aAlfa;
          #1#1 = aAlfa;
          |GRABA 020#1b;
     |FINSI;
     |PINPA #0#1;
     |PINDA #0#1;
     |ENDATOS #1#1;
     |SI FSalida = 0;
          |GRABA 020#1a;
     |FINSI;
     |CIERRA #1;
|FPRO;
