|FICHEROS;
     dsconver #0;
     dsconve1 #1;
     dsconve2 #2;
     zmonedas #3;

     dsconvez #10;
     fichero@ #100;
|FIN;

|VARIABLES;
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aBase        = "";
     aQueQuiero   = "";
     aTitulo      = "";
     aDefFichero  = "";
     aFicFichero  = "";
     aNumCampo    = "";
     aMinCampo    = "";
     aDef         = "";
     aDirDef      = "";
     aDirDat      = "";
     aFichDat     = "";
     aTipoCampo   = "";
     aPath        = "";
     aNombreCampo = "";
     aEsc         = "";
     aTecla       = "";
     aZip         = "";
     aSeguir      = "";
     aParametro1  = "";
     aParametro2  = "";
     aLista       = "";
     aAplica      = "";
     aEmpresa     = "";
     aCopiaOrigen = "";
     aCopiaDestin = "";
     aClave       = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     aMensaje     = "";
     aDefAntes    = "";
     aFichero     = "";
     aSalvaMoneda = "";

     nFSalida1    = 0;
     nFSalida2    = 0;
     nHandle      = 0;
     nSwHay       = 0;
     nSwGraba     = 0;
     nPesetas     = 0;
     nEuros       = 0;
     nCampo       = 0;
     nNumCampos   = 0;
     nBoton1      = 0;
     nBoton2      = 0;
     nBoton3      = 0;
     nModo        = 0;
     nNume        = 0;
     nPulso       = 0;
     nGrabaCampo  = 0;
     nOpcion      = 0;
     nValor       = 0;
     nClave       = 0;
     nContador    = 0;
     nLong        = 0;
     nPos         = 0;
     nCaracter    = 0;
     nHayDatos    = 0;
     nImprimir    = 0;
     nEspecial    = 0;
     nAplica      = 0;

     &EURO      = 1;
     &EURODB    = 0;
     &EURODV    = 0;
     &EUROTEXTO = "Cambio de Moneda";

     &eaBase        = "";
     &eaAplica      = "";
     &eaEmpresa     = "";
     &eaMoneda      = "";
     &enDesdeConver = 1;
     &enForzar      = 0;
|FIN;

|PROCESO ActMoneda;
     eaMoneda = "E";
     aPath    = #0#4;  |QBF aPath;
     |SI #0#1 = "integral  ";  |O #0#1 = "modelos   ";
      |O #0#1 = "contanex  ";  |O #0#1 = "contasoc  ";
      |O #0#1 = "basica    ";  |O #0#1 = "laboral   ";
         |DBASS aPath;   |QBT aPath;
         aPath = aPath + "basica/fich/";

         |DBASS aDef;    |QBT aDef;
         aDef  = aDef + "basica/def/zmonedas";

         |CARGA_DEF aDef, fichero@;
         |SI FSalida ! 0;  |ACABA;  |FINSI;
         |PATH_DAT #100 aPath;

         |ABRE #100;
         |LEE 141#100p;
         |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

         |SI #0#1 = "integral  ";  #100#1 = eaMoneda;  |FINSI;
         |SI #0#1 = "basica    ";  #100#3 = eaMoneda;  |FINSI;
         |SI #0#1 = "laboral   ";  #100#5 = eaMoneda;  |FINSI;
         |SI #0#1 = "contasoc  ";  #100#7 = eaMoneda;  |FINSI;
         |SI #0#1 = "modelos   ";  #100#9 = eaMoneda;  |FINSI;
         |SI #0#1 = "contanex  ";  #100#11= eaMoneda;  |FINSI;

         |GRABA 020#100a;
         |LIBERA #100;

         |CIERRA #100;

         |DESCARGA_DEF #fichero@;
     |SINO;
         |PATH_DAT #3 aPath;
         |ABRE #3;
         |LEE 141#3p;
         |SI FSalida = 0;
             #3#1 = eaMoneda;
             |GRABA 020#3a;
         |FINSI;
         |LIBERA #3;
         |CIERRA #3;
     |FINSI;

     |SI #0#1 ! "agicont   "; |Y #0#1 ! "contagen  ";
         |ACABA;
     |FINSI;

     aPath = #0#3;           |QBF aPath;
     aPath = aPath + "fich/000000/";

     aDef  = #0#3;  |QBF aDef;
     aDef  = aDef + "def/camoneda.mas";   |QBT aDef;

     |CARGA_DEF aDef, fichero@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;
     |PATH_DAT #100 aPath;

     aAlfa1 = #0#2 % 105;
     aAlfa2 = #0#2 % 601;

     |ABRE #100;
     #100#0 = aAlfa1;
     #100#1 = aAlfa2;
     |LEE 141#100=;
     |SI FSalida = 0;
         #100#2 = eaMoneda;
         |GRABA 020#100a;
     |FINSI;
     |LIBERA #100;
     |CIERRA #100;

     |DESCARGA_DEF #fichero@;
|FPRC;

|PROCESO LeeCampos2;
  #2#6 = "EURO  ";
  |GRABA 020#2a;
  |LIBERA #2;
|FPRC;

|DEFBUCLE dsconve2;
     #2#1;
     ;
     #1#0, #1#1, #1#2, #1#3, 000;
     #1#0, #1#1, #1#2, #1#3, 999;
     be;
     NULL, LeeCampos2;
|FIN;

|PROCESO LeeCampos1;
  #1#7 = "EURO  ";
  |GRABA 020#1a;
  |LIBERA #1;

  |BUCLE dsconve2;
|FPRC;

|DEFBUCLE dsconve1;
     #1#1;
     ;
     #0#0, #0#1, #0#2, "        ";
     #0#0, #0#1, #0#2, "zzzzzzzz";
     be;
     NULL, LeeCampos1;
|FIN;

|PROCESO LeeCampos;
  #0#5 = "EURO  ";
  #0#8 = #0#8 + #0#6;
  #0#9 = #0#9 + #0#7;
  #0#6 = 0;
  #0#7 = 0;
  |GRABA 020#0a;
  |LIBERA #0;

  |HAZ ActMoneda;
  |BUCLE dsconve1;
|FPRC;

|DEFBUCLE dsconver;
     #0#1;
     ;
     "                         ", "          ", "      ";
     "zzzzzzzzzzzzzzzzzzzzzzzzz", "zzzzzzzzzz", "zzzzzz";
     be;
     NULL, LeeCampos;
|FIN;

|PROCESO ElProceso;
 |BUCLE dsconver;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = "                         ";
     #0#1 = "          ";
     #0#2 = "      ";
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = "zzzzzzzzzzzzzzzzzzzzzzzzz";
     #0#1 = "zzzzzzzzzz";
     #0#2 = "zzzzzz";
|FRUT;

|PROGRAMA;

     |CABEZA "      Modificacion Configuracion Moneda";

     |PINPA #0#10;
     |PINDA #0#10;

     |C_A #0#0,1,21;
     |C_P #0#0,1,1702; |C_P #0#1,1,1724; |C_P #0#2,1,1735;
     |C_P #0#5,1,1742; |C_P #0#6,1,1749; |C_P #0#7,1,1757;
     |C_P #0#8,1,1765; |C_P #0#9,1,1773;
     |C_L #0#5,1,"S";  |C_L #0#6,1,"S"; |C_L #0#7,1,"S";
     |C_L #0#8,1,"S"; |C_L #0#9,1,"S";

     |ENTLINEAL #1#0, -1, 7, 22, 0, ClaveBaja0, ClaveAlta0;

     |ENDATOS #2#10;
     |SI FSalida = 0; |Y #10#0 = "SI";
         |HAZ ElProceso;
     |FINSI;
|FPRO;
