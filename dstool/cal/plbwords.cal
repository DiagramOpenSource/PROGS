|FICHEROS;
|FIN;

|VARIABLES;
     aLong            = "";
     aCadena          = "";
     aIPRemoto        = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aAlfa4           = "";
     aAlfa5           = "";
     aAlfa6           = "";
     aCaracter        = "";
     aLen             = "";
     aDecima          = "";
     aEntero          = "";
     aImpor1          = "";
     aImpor2          = "";
     aDocRemoto       = "";
     aDocRemotoTra    = "";
     aDocServidor     = "";
     aBase            = "";
     aBaseAqui        = "";
     aDirec           = "";
     aLogo            = "";
     aGuarda          = "";
     aAbreId1         = "";
     aAbreId2         = "";
     aAbre            = "";
     aPath            = "";
     aLongitud        = "";
     aSit             = "";
     aUsuario         = "";
     aHora            = "";
     aDirGrafico      = "";
     aFicheroResul    = "";
     aFicheroTgz      = "";
     aFicheroTra      = "";
     aFicheroLCK      = "";
     aFicheroIMA      = "";

     nSwError         = 0;
     nInstala         = 0;
     nLen             = 0;
     nLen1            = 0;
     nLongitud        = 0;
     nSer             = 0;
     nLong            = 0;
     nBarra           = 0;
     nWord            = 0;
     nCar             = 0;
     nPos             = 0;
     nCampo           = 0;
     nDecimal         = 0;
     nCaracter        = 0;
     nHandle          = 0;
     nHandleI         = 0;
     nHandleYa        = 0;
     nTope            = 0;
     nPuntero         = 0;
     nIdSalir         = 0;
     nIdSalir1        = 0;
     nIdSalir2        = 0;
     nIdSalir3        = 0;
     nIdSalir4        = 0;
     nLinea           = 0;
     nHay             = 0;
     nDeci            = 0;
     nConta           = 0;
     nPaso            = 0;
     nVeces           = 0;
     nHandleTgz       = 0;
     nCarac           = 0;
     nAscii           = 0;

     fFecha           = @;

     &eaAlfa          = "";
     &eaAlfa1         = "";
     &eaAlfa2         = "";
     &eaImporte       = "";
     &eaPathLogo      = "";
     &eaPathLogoIso   = "";
     &eaAsigna        = "";
     &eaMes           = "";
     &enWord1         = 0;
     &enWord2         = 0;
     &enHandleTxt     = 0;
     &enHandleTxt2    = 0;
     &efFecha         = @;

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirDocId2     = "";
     &eaDirTraId2     = "";
     &eaDirSerGuarda  = "";
     &eaDirSerPlan    = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaDestinoTra    = "";
     &eaFicheroTra    = "";
     &eaFicheroIma    = "";
     &eaFicheroXgz    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPdf    = "";
     &eaFicheroPlaGz  = "";
     &eaFicheroPlaMl  = "";
     &eaEtiqueta      = "";
     &eaPlanilla      = "";
     &ea16            = "";
     &eaTipoImpresion = "";
     &enConverPDF     = 0;
     &eaFichero       = "";
     &eaDocumento     = "";
     &eaGrafico       = "";
     &eaRaizDoc       = "";
     &enNumeroDoc     = 0;
     &eaRutaOrigen    = "";
     &eaRutaDestino   = "";
     &eaParametro1    = "";
     &eaParametro2    = "";
     &eaParametro3    = "";
     &eaParametro4    = "";
     &eaParametro5    = "";
     &eaInforme       = "";
     &enBorraDocu     = 0;
     &eaRuta          = "";
     &eaNomFic        = "";
     &eaUnidadBasico  = "";
     &eaImpresora     = "";

     {1}aContiene     = "";
     {1}aVersion      = "";
     {2}nNivel        = 0;
     {50}aCarac       = "";

        &enError      = 0;

     nPausa = 0;
|FIN;

|PROCESO EnviaFicheroConMD5;
     aContiene1 = eaDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = eaOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |PULSATECLA;

     |SI aDocRemoto ! aDocServidor;
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaOrigen, eaDestino;
         |SINO;
             |COPIA_FICHERO eaOrigen, eaDestino;
         |FINSI;
     |FINSI;

     |PULSATECLA;

     |SI eaDestinoTra ! "";  |Y eaDestinoTra ! eaDestino;
         aContiene1 = eaDestinoTra;
         |ESPECIFICA "REMOTOMD5", aContiene;
         aDocRemotoTra = FSalida;  |QBF aDocRemotoTra;

         |SI aDocRemoto ! aDocRemotoTra;  |O aDocRemotoTra = "";
             |RCOPIA_FICHERO eaDestino, eaDestinoTra;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EnviaFicheroSinMD5;
     |PULSATECLA;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO eaOrigen, eaDestino;
     |SINO;
         |COPIA_FICHERO eaOrigen, eaDestino;
     |FINSI;

     |SI FSalida ! 0;
         |PULSATECLA;
         |SI aIPRemoto ! "";
             |ENVIA_FICHERO eaOrigen, eaDestino;
         |SINO;
             |COPIA_FICHERO eaOrigen, eaDestino;
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO RecibeFichero;
     aContiene1 = eaDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = eaOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;
        aIPRemoto = "";
        |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

        |SI aIPRemoto ! "";
            |RECIBE_FICHERO eaDestino, eaOrigen;
        |SINO;
            |COPIA_FICHERO eaDestino, eaOrigen;
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO DescomprimeFichero;
     |SI eaFicheroPlaGz ! eaFicheroTgz;  |Y eaFicheroPlaGz ! "";
         eaOrigen  = eaDirTrabajo + eaFicheroPlaGz;
         eaDestino = eaDirTrabajo + eaFicheroTgz;
         |RRENOMBRA_FICHERO eaOrigen, eaDestino;
     |FINSI;

     aAlfa = eaDirTrabajo + eaFicheroTgz;
     Pos   = -1;
     |RDESCOMPRIME aAlfa;
     |RDETAR aAlfa, eaDirTrabajo;

     aAlfa = eaDirTrabajo + eaFicheroTgz;  |RFBORRA aAlfa;
     aAlfa = eaDirTrabajo + eaFicheroTar;  |RFBORRA aAlfa;

     |SI eaFicheroPlaMl ! eaFicheroTra;
         eaOrigen  = eaDirTrabajo + eaFicheroPlaMl;
         eaDestino = eaDirTrabajo + eaFicheroTra;
         |RRENOMBRA_FICHERO eaOrigen, eaDestino;
     |FINSI;
|FPRC;

|PROCESO ComprimeFichero;
     aAlfa = eaDirTrabajo + eaFicheroTar + " " + eaFicheroTra;
     |RATAR aAlfa, eaDirTrabajo;

     aAlfa = eaDirTrabajo + eaFicheroTar;
     |RCOMPRIME aAlfa;

     aAlfa = eaDirTrabajo + eaFicheroTar;  |RFBORRA aAlfa;

     |SI enBorraDocu = 0;  |Y enConverPDF = 0;
         aAlfa = eaDirTrabajo + eaFicheroTra;  |RFBORRA aAlfa;
     |FINSI;
|FPRC;

|PROCESO SeleccionaImpresora;
     |SI eaParametro3 ! "";
         eaOrigen       = eaParametro3 + "dsbrowserprint.exe";
         eaDestino      = eaParametro4 + "dsbrowserprint.exe";
         eaDestinoTra   = eaParametro5 + "dsbrowserprint.exe";
         |HAZ EnviaFicheroConMD5;
     |FINSI;

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaParametro1 + " " + eaParametro2 + &34;
     |RSYSTEM aAlfa;

     aAlfa = eaParametro2;
     |XABRE "CU", aAlfa, nHandleI;
     |SI FSalida < 0;
          eaImpresora = "";
     |SINO;
          |XLEE nHandleI, 250, eaImpresora;
     |FINSI;
     |XCIERRA nHandleI;

     |QBF eaImpresora;
|FPRC;

|PROCESO EjecutaDSXML;
     || eaParametro1 = Path y fichero exe
     || eaParametro2 = Path y fichero txt
     || eaParametro3 = Origen  del dsxml
     || eaParametro4 = Destino 1 del dsxml
     || eaParametro5 = Destino 2 del dsxml

     |XABRE "EC", eaParametro2, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aFicheroLCK  = eaParametro2 < "";
     aFicheroLCK  = aFicheroLCK - ".txt" + ".lck";
     aFicheroIMA  = eaParametro5 < "";
     aFicheroIMA  = aFicheroIMA + "~$" + (eaFicheroTra % 315);  |QBF aFicheroIMA;

     |SI eaParametro3 ! "";
         eaOrigen       = eaParametro3 + "dsxml.exe";
         eaDestino      = eaParametro4 + "dsxml.exe";
         eaDestinoTra   = eaParametro5 + "dsxml.exe";
         |HAZ EnviaFicheroConMD5;
     |FINSI;

     |RFBORRA aFicheroLCK;

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaParametro1 + " " + eaParametro2 + &34;
     |RSYSTEM aAlfa;

     |PARA;  |SI;  |HACIENDO;
             |PARA nPausa = 1; |SI nPausa [ 10000; |HACIENDO nPausa = nPausa + 1;
             |SIGUE;

             |XABRE "EC", aFicheroLCK, nHandle;
             |SI FSalida ] 0;
                 |SAL;
             |FINSI;

             |PULSATECLA;
     |SIGUE;

     |PARA nVeces = 0;  |SI nVeces [ 20;  |HACIENDO nVeces = nVeces + 1;
             |XABRE "EC", aFicheroIMA, nHandle;
             |SI FSalida < 0;  |SAL;  |FINSI;

             |MENSA "0000 Esperando cierre del documento.";
             |SLEEP 1;
             |PULSATECLA;
     |SIGUE;

     |RFBORRA eaParametro2;
     |RFBORRA aFicheroLCK;

     |PULSATECLA;
     |MENSA "0000  ";
|FPRC;

|PROCESO &QuitaRaros;
     |QBF eaAlfa;
     |SI eaAlfa = "";  |ACABA;  |FINSI;

     aCarac1   = "¥";
     aCarac2   = "¤";
     aCarac3   = "á";
     aCarac4   = " ";
     aCarac5   = "‚";
     aCarac6   = "¡";
     aCarac7   = "¢";
     aCarac8   = "£";
     aCarac9   = "§";
     aCarac10  = "¦";
     aCarac11  = "¨";
     aCarac12  = "€";
     aCarac13  = "‡";
     aCarac14  = "…";
     aCarac15  = "Š";
     aCarac16  = "";
     aCarac17  = "•";
     aCarac18  = "—";
     aCarac19  = &001;
     aCarac20  = &002;
     aCarac21  = &003;
     aCarac22  = &004;
     aCarac23  = &005;
     aCarac24  = &006;
     aCarac25  = &007;
     aCarac26  = &015;
     aCarac27  = &016;
     aCarac28  = &017;
     aCarac29  = &018;
     aCarac30  = &019;
     aCarac31  = &020;
     aCarac32  = &021;
     aCarac33  = &022;
     aCarac34  = &023;
     aCarac35  = &024;
     aCarac36  = &025;
     aCarac37  = &026;
     aCarac38  = &028;
     aCarac39  = &029;
     aCarac40  = "";
     aCarac41  = &008;
     aCarac42  = "ï";
     aCarac43  = "µ";
     aCarac44  = "";
     aCarac45  = "Ö";
     aCarac46  = "à";
     aCarac47  = "é";
     aCarac48  = &009;
     aCarac49  = &010;
     aCarac50  = &013;

     IaCarac = aCarac1 <-;
     nHay    = 0;
     |PARA nCampo = 1;  |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           aCaracter = eaAlfa - aCarac;
           |SI FSalida ! 0;
               nHay = 1;
               |SAL;
           |FINSI;

           IaCarac = IaCarac + 1;
     |SIGUE;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;

     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           nPaso     = 0;

           |SI aCaracter = aCarac1;  |Y nPaso = 0;  aCaracter = &0209;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac2;  |Y nPaso = 0;  aCaracter = &0241;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac3;  |Y nPaso = 0;  aCaracter = &0225;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac4;  |Y nPaso = 0;  aCaracter = &0225;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac5;  |Y nPaso = 0;  aCaracter = &0233;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac6;  |Y nPaso = 0;  aCaracter = &0237;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac7;  |Y nPaso = 0;  aCaracter = &0243;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac8;  |Y nPaso = 0;  aCaracter = &0250;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac9;  |Y nPaso = 0;  aCaracter = &0176;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac10; |Y nPaso = 0;  aCaracter = &0170;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac11; |Y nPaso = 0;  aCaracter = &0191;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac12; |Y nPaso = 0;  aCaracter = "Ç";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac13; |Y nPaso = 0;  aCaracter = &0231;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac14; |Y nPaso = 0;  aCaracter = &0224;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac15; |Y nPaso = 0;  aCaracter = &0232;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac16; |Y nPaso = 0;  aCaracter = &0236;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac17; |Y nPaso = 0;  aCaracter = &0242;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac18; |Y nPaso = 0;  aCaracter = &0249;   nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac19; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac20; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac21; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac22; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac23; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac24; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac25; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac26; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac27; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac28; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac29; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac30; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac31; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac32; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac33; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac34; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac35; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac36; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac37; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac38; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac39; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac40; |Y nPaso = 0;  aCaracter = &252;    nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac41; |Y nPaso = 0;  aCaracter = "";      nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac42; |Y nPaso = 0;  aCaracter = "´";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac43; |Y nPaso = 0;  aCaracter = "A";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac44; |Y nPaso = 0;  aCaracter = "E";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac45; |Y nPaso = 0;  aCaracter = "I";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac46; |Y nPaso = 0;  aCaracter = "O";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac47; |Y nPaso = 0;  aCaracter = "U";     nPaso = 1;  |FINSI;
           |SI aCaracter = aCarac48; |Y nPaso = 0;  aCaracter = " ";     nPaso = 1;  |FINSI;

           |SI aCaracter = aCarac49; |Y nPaso = 0;  || Un retorno de carro
               |SI nCampo < nLen;
                   aCaracter = "";
                   nPaso     = 1;
               |FINSI;
           |FINSI;

           |SI aCaracter = aCarac50; |Y nPaso = 0;  || Un retorno de carro
               nLen1 = nLen - 1;
               |SI nCampo < nLen1;
                   aCaracter = "";
                   nPaso     = 1;
               |FINSI;
           |FINSI;

           aCadena = aCadena + aCaracter;
     |SIGUE;

     eaAlfa = aCadena;
|FPRC;

|PROCESO TraeTxtComprimido;
     aAlfa = eaRutaOrigen + eaFicheroTar + " " + eaFicheroTxt;
     |ATAR aAlfa, eaRutaOrigen;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaRutaOrigen + eaFicheroTar;
          |XABRE "E", aAbre, nHandleTgz;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |PULSATECLA;
     |SIGUE;

     aAlfa = eaRutaOrigen + eaFicheroTar;
     |COMPRIME aAlfa;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaRutaOrigen + eaFicheroTgz;
          |XABRE "E", aAbre, nHandleTgz;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |PULSATECLA;
     |SIGUE;

     aAlfa = eaRutaOrigen + eaFicheroTxt;  |FBORRA aAlfa;
     aAlfa = eaRutaOrigen + eaFicheroTar;  |FBORRA aAlfa;

     eaOrigen  = eaRutaOrigen  + eaFicheroTgz;
     eaDestino = eaRutaDestino + eaFicheroTgz;

     |RFBORRA eaDestino;
     |HAZ EnviaFicheroSinMD5;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaRutaDestino + eaFicheroTgz;
          |XABRE "EC", aAbre, nHandleTgz;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |PULSATECLA;
     |SIGUE;

     Pos   = -1;
     aAlfa = eaRutaDestino + eaFicheroTgz;
     |RDESCOMPRIME aAlfa;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaRutaDestino + eaFicheroTar;
          |XABRE "EC", aAbre, nHandleTgz;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |PULSATECLA;
     |SIGUE;

     |RDETAR aAlfa, eaRutaDestino;

     |PARA;  |SI;  |HACIENDO;
          aAbre = eaRutaDestino + eaFicheroTxt;
          |XABRE "EC", aAbre, nHandleTgz;
          |SI FSalida ] 0;  |SAL;  |FINSI;

          |PULSATECLA;
     |SIGUE;

     aAlfa = eaRutaOrigen  + eaFicheroTgz;  |FBORRA aAlfa;
     aAlfa = eaRutaDestino + eaFicheroTgz;  |RFBORRA aAlfa;
     aAlfa = eaRutaDestino + eaFicheroTar;  |RFBORRA aAlfa;
|FPRC;


|PROCESO ImprimeDocPorImpresora;
     eaOrigen       = eaDirSerPlan   + "dsprint.exe";
     eaDestino      = eaDirPlantilla + "dsprint.exe";
     eaDestinoTra   = eaDirTrabajo   + "dsprint.exe";

     |HAZ EnviaFicheroConMD5;

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaDirTrabajo + "dsprint " + eaDirTrabajo + eaFicheroTra + &34;
     |RSYSTEM aAlfa;
|FPRC;

|PROCESO InstalaImpre;
     nInstala = 0;

     aAlfa = eaUnidadBasico + "\ds\dspdf\bin\puerto.exe";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  nInstala = 1;  |FINSI;

     eaOrigen       = eaDirPlantilla + "dspdf.tgz";
     eaDestino      = eaUnidadBasico + "\ds\dspdf.tgz";
     eaDestinoTra   = "";

     |HAZ EnviaFicheroConMD5;
     |SI aDocRemoto ! aDocServidor;
         nInstala = 1;
     |FINSI;

     |SI nInstala = 1;
         aAlfa = eaUnidadBasico + "\ds\dspdf.tgz";
         Pos   = -1;
         |RDESCOMPRIME aAlfa;
         aAlfa1 = eaUnidadBasico + "\ds\";
         |RDETAR aAlfa, aAlfa1;

         aAlfa = eaUnidadBasico + "\ds\dspdf.tar";  |RFBORRA aAlfa;

         aAlfa = eaUnidadBasico + "\ds\dspdf\bin\puerto.exe";
         |XABRE "EC", aAlfa, nHandle;
         |SI FSalida < 0;
             |MENAV "0000 No puedo instalar la impresora en PDF.";
             nSwError = -1; |ACABA;
         |FINSI;

         aAlfa  = "cmd " + &34 + "/c START /WAIT C:\DS\DSPDF\BIN\PUERTO.EXE" + &34;
         |RSYSTEM aAlfa;
     |FINSI;
|FPRC;

|PROCESO LeeUnidadBasico;
     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     eaUnidadBasico = (aContiene1 % 102) > "";

     aAlfa = eaUnidadBasico % -101;
     |SI aAlfa ! ":";
         eaUnidadBasico = "";
     |FINSI;
|FPRC;
