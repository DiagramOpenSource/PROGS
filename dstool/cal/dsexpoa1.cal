|VARIABLES;
     nHandle             = 0;

     aMd5Org             = "";
     aMd5Des             = "";
     aAlfa               = "";
     aOrg                = "";
     aDes                = "";
     aTxt                = "";
     aExe                = "";
     aTxtDes             = "";
     aIP                 = "";
     aBase               = "";

     {1}aContiene        = "";
     {1}aLocal           = "";

     &eaPath             = "";
     &eaNomFic           = "";
|FIN;

|PROCESO EjecutaBrowse;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "MD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |COPIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + eaPath + " " + aTxt;
     |SYSTEM aAlfa;
|FPRC;

|PROCESO EjecutaBrowseRemoto;
     aContiene = aOrg;
     |ESPECIFICA "MD5", aContiene;
     aMd5Org = FSalida;
     aContiene = aDes;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aMd5Des = FSalida;
     |SI aMd5Org ! aMd5Des; |ENVIA_FICHERO aOrg, aDes; |FINSI;
     aAlfa = aDes + " " + eaPath + " " + aTxt;
     |RSYSTEM aAlfa;
|FPRC;

Variable entrada: eaPath
Variable salida: eaNomFic
|PROCESO DsBrowse;
     eaNomFic = "";
     |SI eaPath = ""; eaPath = "\"; |FINSI;
     aExe = "dsselect.exe";
     aTxtDes = Usuario;
     |DBASE aAlfa;
     aOrg = aAlfa + "plugins/" + aExe;
     aIP = ""; |IP_REMOTO aIP; |QBF aIP;
     |SI aIP = "";
          |DBASS aBase;
          aAlfa = aBase + "bin/";
          aDes = aAlfa + aExe;
          aTxt = aBase + aTxtDes;
          |HAZ EjecutaBrowse;
          |XABRE "", aTxt, nHandle;
          |SI FSalida ] 0;
               |XLEE nHandle, 250, eaNomFic;
               |XCIERRA nHandle;
          |FINSI;
          |FBORRA aTxt;
     |SINO;
          |ESPECIFICA "RBASS", aLocal;
          aBase = aLocal;

          aAlfa = aBase + "bin/";
          aDes = aAlfa + aExe;
          aTxt = aBase + aTxtDes;
          |HAZ EjecutaBrowseRemoto;
          |DFICE aAlfa;
          aDes = aAlfa + aTxtDes;
          |XABRE "C", aTxt, nHandle;
          |SI FSalida ] 0;
               |XLEE nHandle, 250, eaNomFic;
               |XCIERRA nHandle;
          |FINSI;
          |RFBORRA aTxt;
     |FINSI;
|FPRC;
