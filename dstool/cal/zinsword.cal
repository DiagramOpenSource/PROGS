|FICHEROS;
     zinsword #0;
     zinswor1 #1,MANTE;
|FIN;

|VARIABLES;
     aFichero  = "";
     aAplica   = "";
     aDir      = "";
     aIPRemoto = "";
     aOrigen   = "";
     aDestino  = "";
     aAlfa     = "";

     nSwHay    = 0;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |LEE 101#1=;

     |SI #1#1 = "N";
         #1#1 = "S";
     |SINO;
         #1#1 = "N";
     |FINSI;
     |GRABA 020#1a;
     |LIBERA #1;

     |PINTA #1#1;
|FPRC;

|PROCESO Instalar;
     aOrigen  = aAplica + #1#0;
     aDestino = #0#1 + ":\" + #1#0;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     aFichero = aDestino;
     |RDESCOMPRIME aFichero;
     |RFBORRA aFichero;

     aFichero   = (aFichero - "tgz") + "tar";
     aAlfa      = #0#1 + ":\";
     |RDETAR aFichero, aAlfa;

     |RFBORRA aFichero;
|FPRC;

|DEFBUCLE zinswor1;
     #1#1;
     1;
     "            ", "S";
     "zzzzzzzzzzzz", "S";
     ;
     NULL, Instalar;
|FIN;

|RUTINA ClaveBaja1;
     #1#0 = "            ";
|FRUT;

|RUTINA ClaveAlta1;
     #1#0 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO Tipo3;  |TIPO 3;
     aFichero = (Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #1 aFichero;
     |ABRE #1;  |CIERRA #1;  |DELINDEX #1;

     |ABRE #1;

     |DBASS aAplica;            |QBF aAplica;
     aAplica = aAplica + #0#0;  |QBF aAplica;
     aAplica = aAplica + "/";

     nSwHay = 0;
     aDir   = aAplica + "word*.tgz";
     |_PDIR aDir;
     |PARA;  |SI FSalida ] 0; |HACIENDO;
          |DDEFECTO #0;
          #1#0 = aDir % -112;
          |GRABA 020#1n;
          |LIBERA #1;

          |_SDIR aDir;
          nSwHay = 1;
     |SIGUE;
     |CIERRA #1;

     |SI nSwHay = 0;
         |MENAV "     No hay Documentos a instalar en esta Aplicacion";
     |SINO;
         |ENTLINEAL #1#1, -1, 4, 22, 1, ClaveBaja1, ClaveAlta1;
         |MENSA "0000 Instalando, esperese un Momento.";
         |BUCLE zinswor1;
     |FINSI;

     |DELINDEX #1;
|FPRC;
