|FICHEROS;
     n43m0001;
     n43m0002;
     n43m0100;
     n43m0104;
     n43m0105;
     n43m0107;

     n43w0006;

     trabajo@;
     cacuenta@;
     caconcep@;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     nOk                 = 0;
     nCond               = 0;
     nCump               = 0;
     nCmp                = 0;
     nCmp1               = 0;
     nCmp2               = 0;
     nCmp3               = 0;
     nNume1              = 0;
     nNume2              = 0;

     aAlfa               = "";
     aAlfa1              = "";
     aAlfa2              = "";
     aFic                = "";
     aCmp                = "";
     aDef                = "";
     aMas                = "";
     aQQ                 = "";
     aTipo               = "";

     &enEmp              = 0;
     &eaEnt              = "";
     &eaOfi              = "";
     &eaCta              = "";
     &eaPaq              = "";
     &efOpe              = @;
     &enMov              = 0;
     &enDoc              = 0;
     &eaCuenta           = "";
     &eaNCuenta          = "";
     &enConcepto         = 0;
     &eaConcepto         = "";

     &eaAmarillo         = "";
     &eaAzulClaro        = "";
     &eaAzulOscuro       = "";
     &eaGris             = "";
     &eaMarengo          = "";
     &eaNegro            = "";
     &eaRojo             = "";
     &eaVerde            = "";
|FIN;

|PROCESO Condicion;
     |SI aTipo = "N";
         nNume1 = #n43m0107#nCmp3#;
         nNume2 = #trabajo@#nCmp#;

         |SI nNume1 = nNume2;
             |SI #n43m0107#nCmp2# = "coincide exactamente          ";
                 nCump = nCump + 1;
                 |ACABA;
             |FINSI;

             |SI #n43m0107#nCmp2# = "no coincide exactamente       ";
                 nCump = nCump + 1;
                 |ACABA;
             |FINSI;

             |SI #n43m0107#nCmp2# = "contiene                      ";
                 nCump = nCump + 1;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI nNume1 ! nNume2;
             |SI #n43m0107#nCmp2# = "no contiene                   ";
                 nCump = nCump + 1;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTipo ! "N";
         aAlfa1 = #trabajo@#nCmp#;   |QBF aAlfa1;
         aAlfa2 = #n43m0107#nCmp3#;  |QBF aAlfa2;

         |SI #n43m0107#nCmp2# = "coincide exactamente          ";
             |SI aAlfa1 = aAlfa2;
                 nCump = nCump + 1;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #n43m0107#nCmp2# = "no coincide exactamente       ";
             aAlfa = aAlfa1 - aAlfa2;
             |SI FSalida ! 0;
                 nCump = nCump + 1;
             |FINSI;
         |FINSI;

         |SI #n43m0107#nCmp2# = "contiene                      ";
             aAlfa = aAlfa1 - aAlfa2;
             |SI FSalida ! 0;
                 nCump = nCump + 1;
             |FINSI;
         |FINSI;

         |SI #n43m0107#nCmp2# = "no contiene                   ";
             aAlfa = aAlfa1 - aAlfa2;
             |SI FSalida = 0;
                 nCump = nCump + 1;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO RevisaCampo;
     nCond = nCond + 1;
     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;

     #n43m0100#0 = #n43m0002#9;
     |LEE 000#n43m0100.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0100;  |FINSI;

     #n43m0104#0 = #n43m0002#1;
     #n43m0104#1 = #n43m0002#11;
     |LEE 000#n43m0104.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0104;  |FINSI;

     aFic = #n43m0107#nCmp1# % 208;
     aCmp = #n43m0107#nCmp1# % 1103;

     aQQ   = ("|C" + aCmp + "TIPO") < "";
     nCmp  = aCmp;

     |SI aFic = "n43m0002";  |REFERENCIA_DEF trabajo@, #n43m0002;  |FINSI;
     |SI aFic = "n43m0100";  |REFERENCIA_DEF trabajo@, #n43m0100;  |FINSI;
     |SI aFic = "n43m0104";  |REFERENCIA_DEF trabajo@, #n43m0104;  |FINSI;

     aTipo = #trabajo@#aQQ#;

     |HAZ Condicion;
|FPRC;

|PROCESO GrabaContenido;
     nCmp2 = nCmp1 + 1;

     |SI #n43m0107#nCmp1# = "Cuenta                        ";
         |SI #n43m0002#13 = "1";
             #n43w0006#30 = "";
             #n43w0006#31 = #n43m0107#nCmp2#;

             eaCuenta     = #n43w0006#31;  |HAZ LeeCuenta;
             #n43w0006#31 = eaCuenta;
             #n43w0006#32 = eaNCuenta;
         |FINSI;

         |SI #n43m0002#13 = "2";
             #n43w0006#31 = "";
             #n43w0006#30 = #n43m0107#nCmp2#;

             eaCuenta     = #n43w0006#30;  |HAZ LeeCuenta;
             #n43w0006#30 = eaCuenta;
             #n43w0006#32 = eaNCuenta;
         |FINSI;
     |FINSI;

     |SI #n43m0107#nCmp1# = "Cuenta contrapartida          ";
         |SI #n43m0002#13 = "1";
             #n43w0006#36 = "";
             #n43w0006#35 = #n43m0107#nCmp2#;

             eaCuenta     = #n43w0006#35;  |HAZ LeeCuenta;
             #n43w0006#35 = eaCuenta;
             #n43w0006#37 = eaNCuenta;
         |FINSI;

         |SI #n43m0002#13 = "2";
             #n43w0006#35 = "";
             #n43w0006#36 = #n43m0107#nCmp2#;

             eaCuenta     = #n43w0006#36;  |HAZ LeeCuenta;
             #n43w0006#36 = eaCuenta;
             #n43w0006#37 = eaNCuenta;
         |FINSI;
     |FINSI;

     |SI #n43m0107#nCmp1# = "Concepto cuenta               ";
         #n43w0006#33 = #n43m0107#nCmp2#;

         enConcepto   = #n43w0006#33;      |HAZ LeeConcepto;
         #n43w0006#34 = eaConcepto;
     |FINSI;

     |SI #n43m0107#nCmp1# = "Concepto contrapartida        ";
         #n43w0006#38 = #n43m0107#nCmp2#;

         enConcepto   = #n43w0006#38;      |HAZ LeeConcepto;
         #n43w0006#39 = eaConcepto;
     |FINSI;

     |SI #n43m0107#nCmp1# = "Diario                        ";
         #n43w0006#27 = #n43m0107#nCmp2#;
     |FINSI;
|FPRC;

|PROCESO n43m0107;
     nCond = 0;
     nCump = 0;

     |PARA nCmp1 = 7;  |SI nCmp1 [ 34;  |HACIENDO nCmp1 = nCmp1 + 3;
           aAlfa = #n43m0107#nCmp1#;  |QBF aAlfa;
           |SI aAlfa = "";  |SAL;  |FINSI;

           |HAZ RevisaCampo;
     |SIGUE;

     |SI nCump = 0;  |ACABA;  |FINSI;
     |SI nCond = 0;  |ACABA;  |FINSI;

     nOk = 0;
     |SI #n43m0107#6 = "todas          ";
         |SI nCump = nCond;
             nOk = 1;
         |FINSI;
     |FINSI;

     |SI #n43m0107#6 = "cualquiera de  ";
         nOk = 1;
     |FINSI;

     |SI nOk = 0;  |ACABA;  |FINSI;

     |PARA nCmp1 = 37;  |SI nCmp1 [ 43;  |HACIENDO nCmp1 = nCmp1 + 2;
           aAlfa = #n43m0107#nCmp1#;  |QBF aAlfa;
           |SI aAlfa = "";  |SAL;  |FINSI;

           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|DEFBUCLE n43m0107;
     #n43m0107#2;
     ;
     #n43m0001#0, #n43m0105#0, "S", 0000;
     #n43m0001#0, #n43m0105#0, "S", 9999;
     ;
     NULL, n43m0107;
|FIN;

|PROCESO n43m0002;
     |DDEFECTO #n43w0006;
     |PARA nCmp = 0;  |SI nCmp [ 26;  |HACIENDO nCmp = nCmp + 1;
           #n43w0006#nCmp#  = #n43m0002#nCmp#;
     |SIGUE;

     #n43w0006#27  = #n43m0002#27;
     #n43w0006#28  = #n43m0002#28;
     #n43w0006#29  = #n43m0002#29;
     #n43w0006#40  = #n43m0002#38;
     #n43w0006#41  = #n43m0002#39;

     |SI #n43m0002#13 = "1";
         #n43w0006#30 = "";
         #n43w0006#31 = #n43m0002#30;
         #n43w0006#32 = #n43m0002#31;
         #n43w0006#33 = #n43m0002#32;
         #n43w0006#34 = #n43m0002#33;

         #n43w0006#35 = #n43m0002#34;
         #n43w0006#36 = "";
         #n43w0006#37 = #n43m0002#35;
         #n43w0006#38 = #n43m0002#36;
         #n43w0006#39 = #n43m0002#37;
     |FINSI;

     |SI #n43m0002#13 = "2";
         #n43w0006#31 = "";
         #n43w0006#30 = #n43m0002#30;
         #n43w0006#32 = #n43m0002#31;
         #n43w0006#33 = #n43m0002#32;
         #n43w0006#34 = #n43m0002#33;

         #n43w0006#35 = "";
         #n43w0006#36 = #n43m0002#34;
         #n43w0006#37 = #n43m0002#35;
         #n43w0006#38 = #n43m0002#36;
         #n43w0006#39 = #n43m0002#37;
     |FINSI;

     |BUCLE n43m0107;

     #n43m0002#27  = #n43w0006#27;
     #n43m0002#28  = #n43w0006#28;
     #n43m0002#29  = #n43w0006#29;

     |SI #n43m0002#13 = "1";
         #n43m0002#30 = #n43w0006#31;
         #n43m0002#31 = #n43w0006#32;
         #n43m0002#32 = #n43w0006#33;
         #n43m0002#33 = #n43w0006#34;

         #n43m0002#34 = #n43w0006#35;
         #n43m0002#35 = #n43w0006#37;
         #n43m0002#36 = #n43w0006#38;
         #n43m0002#37 = #n43w0006#39;
     |FINSI;

     |SI #n43m0002#13 = "2";
         #n43m0002#30 = #n43w0006#30;
         #n43m0002#31 = #n43w0006#32;
         #n43m0002#32 = #n43w0006#33;
         #n43m0002#33 = #n43w0006#34;

         #n43m0002#34 = #n43w0006#36;
         #n43m0002#35 = #n43w0006#37;
         #n43m0002#36 = #n43w0006#38;
         #n43m0002#37 = #n43w0006#39;
     |FINSI;

     #n43m0002#27 = #n43w0006#27;

     #n43m0002#38 = #n43w0006#40;
     #n43m0002#39 = #n43w0006#41;
     #n43m0002#40 = "";

     |GRABA 020#n43m0002.a;
     |LIBERA #n43m0002;
|FPRC;

|DEFBUCLE n43m0002;
     #n43m0002#1;
     43;
     #n43m0105#3, #n43m0105#0, #n43m0105#1, #n43m0105#2, "01.01.0000",    1, "1";
     #n43m0105#3, #n43m0105#0, #n43m0105#1, #n43m0105#2, "31.12.2999", 9999, "2";
     be;
     NULL, n43m0002;
|FIN;

|PROGRAMA;
     |BUCLE n43m0002;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |HAZ CargaColores;

     |ABRE #n43m0001;
     #n43m0001#0 = enEmp;
     |LEE 000#n43m0001.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0001;  |FINSI;
     |CIERRA #n43m0001;

     |ABRE #n43m0105;
     #n43m0105#0 = eaEnt;
     #n43m0105#1 = eaOfi;
     #n43m0105#2 = eaCta;
     |LEE 000#n43m0105.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0105;  |FINSI;
     |CIERRA #n43m0105;

     |ABRET #n43m0002;
     |ABRET #n43m0100;
     |ABRET #n43m0104;

     |DDEF aDef;  |QBF aDef;

     |VENTANA 0501, 0540, -1, 16, "Procesando informaci¢n";
     n0Vent = FSalida;
     |PTEC 802; |PAUSA;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #n43m0002;
     |CIERRAT #n43m0100;
     |CIERRAT #n43m0104;

     |FINVENTANA n0Vent;
|FPRC;
