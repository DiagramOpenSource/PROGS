|FICHEROS;
     n43w0003;

     n43m0001;
     n43m0103;
     n43m0105;

     agifigen@;
|FIN;

|VARIABLES;
     aAlfa               = "";
     aMas                = "";
     aEjec               = "";

     nConta              = 0;

     fFecha              = @;

     &eaPaq              = "";
     &eaBaseAplis        = "";
     &enPer              = 0;
     &enEje              = 0;
     &enOk               = 0;
     &eaAlfa             = "";
|FIN;

|PROCESO CreaOficina;
     #n43m0103#0 = #n43w0003#0;
     #n43m0103#1 = #n43w0003#2;
     |LEE 000#n43m0103.=;
     |SI FSalida ! 0;
         #n43m0103#0 = #n43w0003#0;
         #n43m0103#1 = #n43w0003#2;
         #n43m0103#2 = #n43w0003#3;
         #n43m0103#3 = #n43w0003#4;
         #n43m0103#4 = #n43w0003#5;
         #n43m0103#5 = #n43w0003#6;
         #n43m0103#6 = #n43w0003#7;
         #n43m0103#7 = #n43w0003#8;
         #n43m0103#8 = #n43w0003#9;
         #n43m0103#9 = #n43w0003#10;

         |GRABA 020#n43m0103.n;
         |LIBERA #n43m0103;
     |FINSI;
|FPRC;

|PROCESO T12w3;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |HAZ CreaOficina;

         |ERROR;
         |POSICIONATE #n43w0003#0;
         |ACABA;
     |FINSI;

     |SI #n43w0003#0 = "    ";  |O #n43w0003#2 = "    ";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ CreaOficina;
|FPRC;

|PROCESO T66C16w3;  |TIPO 66;
     |SI nConta = 0;
         |ACABA;
     |FINSI;

     aEjec = ":contagen/x43z0003 canempr1 " + (("00000" + #n43w0003#12) % -105) + enPer + ";T66camandia";

     eaAlfa = #n43w0003#16;
     |SUB_EJECUTA aEjec;

     #n43w0003#16 = eaAlfa;
     |PINTA #n43w0003#16;
|FPRC;

|PROCESO T0C16w3;  |TIPO 0;
     |SI nConta = 0;
         |ACABA;
     |FINSI;

     aEjec = ":contagen/x43z0003 canempr1 " + (("00000" + #n43w0003#12) % -105) + enPer + ";T00camandia";

     eaAlfa = #n43w0003#16;
     |SUB_EJECUTA aEjec;

     #n43w0003#16 = eaAlfa;

     |PINTA #n43w0003#16;

     |SI eaAlfa = "";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T66C14w3;  |TIPO 66;
     |SI nConta = 0;
         |ACABA;
     |FINSI;

     aEjec = ":contagen/x43z0003 canempr1 " + (("00000" + #n43w0003#12) % -105) + enPer + ";T66cacuenta";

     eaAlfa = #n43w0003#14;
     |SUB_EJECUTA aEjec;

     #n43w0003#14 = eaAlfa;
     |PINTA #n43w0003#14;
|FPRC;

|PROCESO T0C14w3;  |TIPO 0;
     |SI nConta = 0;
         |ACABA;
     |FINSI;

     aEjec = ":contagen/x43z0003 canempr1 " + (("00000" + #n43w0003#12) % -105) + enPer + ";T00cacuenta";

     eaAlfa = #n43w0003#14;
     |SUB_EJECUTA aEjec;

     #n43w0003#14 = eaAlfa;

     |PINTA #n43w0003#14;

     |SI eaAlfa = "";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T7C14w3;  |TIPO 7;
     #n43m0001#0 = #n43w0003#12;

     nConta = 0;
     fFecha = ~;
     aAlfa  = fFecha % 402;   enPer = aAlfa;
     aAlfa  = fFecha % -102;  enEje = aAlfa;
     |HAZ BuscaRegCanempre;
     nConta = enOk;
|FPRC;

|PROCESO T0C12w3;  |TIPO 0;
     |C_M #n43w0003#12, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI eaPaq = "BASICA";
         aMas = eaBaseAplis + "basica/def/agifigen.mas";
     |FINSI;

     |SI eaPaq = "AGICLI";
         aMas = eaBaseAplis + "agicli/def/agifigen.mas";
     |FINSI;

     |CARGA_DEF aMas, agifigen@;

     |ABRE #agifigen@;
     #agifigen@#0 = #n43w0003#12;
     |LEE 000#agifigen@.=;
     |SI FSalida ! 0;
         |CIERRA #agifigen@;
         |DESCARGA_DEF #agifigen@;

         |MENAV "0000La empresa no existe.";
         |ERROR;
         |ACABA;
     |FINSI;

     #n43w0003#13 = #agifigen@#1;
     #n43w0003#15 = #agifigen@#13;

     |CIERRA #agifigen@;
     |DESCARGA_DEF #agifigen@;

     |PINTA #n43w0003#12;
     |PINTA #n43w0003#13;
|FPRC;

|PROCESO T66C12w3;  |TIPO 66;
     |SI eaPaq = "BASICA";
         aMas = eaBaseAplis + "basica/def/agifigen.mas";
     |FINSI;

     |SI eaPaq = "AGICLI";
         aMas = eaBaseAplis + "agicli/def/agifigen.mas";
     |FINSI;

     |CARGA_DEF aMas, agifigen@;

     |ABRE #agifigen@;
     |CONSULTA_CLAVE #1#agifigen@;
     |SI FSalida = 0;
         #n43w0003#12 = #agifigen@#0;
         #n43w0003#13 = #agifigen@#1;
         #n43w0003#15 = #agifigen@#13;
     |FINSI;
     |CIERRA #agifigen@;

     |DESCARGA_DEF #agifigen@;

     |PINTA #n43w0003#12;
     |PINTA #n43w0003#13;
|FPRC;

|PROCESO T0C11w3;  |TIPO 0;
     |C_M #n43w0003#11, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #n43w0003#11;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Introduzca una cuenta corriente";
         |ERROR;
         |ACABA;
     |FINSI;

     #n43m0105#0 = #n43w0003#0;
     #n43m0105#1 = #n43w0003#2;
     #n43m0105#2 = #n43w0003#11;
     |LEE 000#n43m0105.=;
     |SI FSalida = 0;
         |MENAV "0000La cuenta corriente ya existe.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Baja103;
     #n43m0103#0 = #n43w0003#0;
     #n43m0103#1 = "";
|FPRC;

|PROCESO Alta103;
     #n43m0103#0 = #n43w0003#0;
     #n43m0103#1 = "zzzz";
|FPRC;

|PROCESO T66C2w3;  |TIPO 66;
     |CONSULTA_F_CLAVE #1#n43m0103, Baja103, Alta103;
     |SI FSalida = 0;
         #n43w0003#2  = #n43m0103#1;
         #n43w0003#3  = #n43m0103#2;
         #n43w0003#4  = #n43m0103#3;
         #n43w0003#5  = #n43m0103#4;
         #n43w0003#6  = #n43m0103#5;
         #n43w0003#7  = #n43m0103#6;
         #n43w0003#8  = #n43m0103#7;
         #n43w0003#9  = #n43m0103#8;
         #n43w0003#10 = #n43m0103#9;
     |FINSI;

     |PINTA #n43w0003#2;
     |PINTA #n43w0003#3;
     |PINTA #n43w0003#4;
     |PINTA #n43w0003#5;
     |PINTA #n43w0003#6;
     |PINTA #n43w0003#7;
     |PINTA #n43w0003#8;
     |PINTA #n43w0003#9;
     |PINTA #n43w0003#10;
|FPRC;

|PROCESO T0C2w3;
     |C_M #n43w0003#2, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #n43w0003#2 = "0000";
         |MENAV "0000Introduzca una oficina.";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #n43w0003#3,  1, "N";
     |C_M #n43w0003#4,  1, "N";
     |C_M #n43w0003#5,  1, "N";
     |C_M #n43w0003#6,  1, "N";
     |C_M #n43w0003#7,  1, "N";
     |C_M #n43w0003#8,  1, "N";
     |C_M #n43w0003#9,  1, "N";
     |C_M #n43w0003#10, 1, "N";

     #n43m0103#0 = #n43w0003#0;
     #n43m0103#1 = #n43w0003#2;
     |LEE 000#n43m0103.=;
     |SI FSalida ! 0;
         |CONFI "0000SNo existe la oficina, Quiere crearla";
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;

         |PDEFECTO #n43w0003, 3, 11;

         |C_M #n43w0003#3,  1, "S";
         |C_M #n43w0003#4,  1, "S";
         |C_M #n43w0003#5,  1, "S";
         |C_M #n43w0003#6,  1, "S";
         |C_M #n43w0003#7,  1, "S";
         |C_M #n43w0003#8,  1, "S";
         |C_M #n43w0003#9,  1, "S";
         |C_M #n43w0003#10, 1, "S";
     |SINO;
         #n43w0003#2  = #n43m0103#1;
         #n43w0003#3  = #n43m0103#2;
         #n43w0003#4  = #n43m0103#3;
         #n43w0003#5  = #n43m0103#4;
         #n43w0003#6  = #n43m0103#5;
         #n43w0003#7  = #n43m0103#6;
         #n43w0003#8  = #n43m0103#7;
         #n43w0003#9  = #n43m0103#8;
         #n43w0003#10 = #n43m0103#9;
     |FINSI;

     |PINTA #n43w0003#2;
     |PINTA #n43w0003#3;
     |PINTA #n43w0003#4;
     |PINTA #n43w0003#5;
     |PINTA #n43w0003#6;
     |PINTA #n43w0003#7;
     |PINTA #n43w0003#8;
     |PINTA #n43w0003#9;
     |PINTA #n43w0003#10;
|FPRC;
