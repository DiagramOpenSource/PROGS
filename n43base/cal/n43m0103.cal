|FICHEROS;
     n43m0102;
     n43m0103;
     n43m0105;

     n43w0002,MANTE;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nGrid102            = -1;
     nGrid103            = -1;
     nBtnNOfi            = 0;
     nBtnMOfi            = 0;
     nBtnBOfi            = 0;
     nRango              = 0;
     nHandle             = 0;
     nLong               = 0;
     nCampo              = 0;
     nCaracter           = 0;
     nPos                = 0;
     nTree               = 0;

     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aAlfa               = "";
     aPathLocal          = "";
     aFicTmp             = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &eaUnidadBasico     = "";
     &eaEnt              = "";
|FIN;

|PROCESO Baja103;
     #n43m0103#0 = #n43m0102#0;
     #n43m0103#1 = "";
|FPRC;

|PROCESO Alta103;
     #n43m0103#0 = #n43m0102#0;
     #n43m0103#1 = "zzzz";
|FPRC;

|PROCESO Evnt103;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#n43m0103.=;

         |ESTADO_CONTROL nBtnMOfi, "ENABLE";
         |ESTADO_CONTROL nBtnBOfi, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO NuevaOfi;
     |VENTANA 0501, 2399, -1, 16, "Nueva Oficina";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |DDEFECTO #n43w0002;

     #n43w0002#0 = #n43m0102#0;

     |PINPA #0#n43w0002;
     |PINDA #0#n43w0002;
     |ENDATOS #1#n43w0002;
     |SI FSalida = 0;
         #n43m0103#0 = #n43w0002#0;
         #n43m0103#1 = #n43w0002#1;
         #n43m0103#2 = #n43w0002#2;
         #n43m0103#3 = #n43w0002#3;
         #n43m0103#4 = #n43w0002#4;
         #n43m0103#5 = #n43w0002#5;
         #n43m0103#6 = #n43w0002#6;
         #n43m0103#7 = #n43w0002#7;
         #n43m0103#8 = #n43w0002#8;
         #n43m0103#9 = #n43w0002#9;

         |GRABA 020#n43m0103.n;
         |LIBERA #n43m0103;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid103;
     |FOCOTECLADO nGrid103;
|FPRC;

|PROCESO n43m0105;
     #n43m0105#7 = #n43w0002#2;

     |GRABA 020#n43m0105.a;
     |LIBERA #n43m0105;
|FPRC;

|DEFBUCLE n43m0105;
     #n43m0105#1;
     ;
     #n43m0103#0, #n43m0103#1, "          ";
     #n43m0103#0, #n43m0103#1, "zzzzzzzzzz";
     be;
     NULL, n43m0105;
|FIN;

|PROCESO ModiOfi;
     |LEE 101#n43m0103.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 2399, -1, 16, "Modificaci¢n Oficina";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |DDEFECTO #n43w0002;
     #n43w0002#0 = #n43m0103#0;
     #n43w0002#1 = #n43m0103#1;
     #n43w0002#2 = #n43m0103#2;
     #n43w0002#3 = #n43m0103#3;
     #n43w0002#4 = #n43m0103#4;
     #n43w0002#5 = #n43m0103#5;
     #n43w0002#6 = #n43m0103#6;
     #n43w0002#7 = #n43m0103#7;
     #n43w0002#8 = #n43m0103#8;
     #n43w0002#9 = #n43m0103#9;

     |C_M #n43w0002#1, 1, "N";

     |PINPA #0#n43w0002;
     |PINDA #0#n43w0002;
     |ENDATOS #1#n43w0002;
     |SI FSalida = 0;
         |SI #n43w0002#2 ! #n43m0103#2;
             |BUCLE n43m0105;
         |FINSI;

         #n43m0103#0 = #n43w0002#0;
         #n43m0103#1 = #n43w0002#1;
         #n43m0103#2 = #n43w0002#2;
         #n43m0103#3 = #n43w0002#3;
         #n43m0103#4 = #n43w0002#4;
         #n43m0103#5 = #n43w0002#5;
         #n43m0103#6 = #n43w0002#6;
         #n43m0103#7 = #n43w0002#7;
         #n43m0103#8 = #n43w0002#8;
         #n43m0103#9 = #n43w0002#9;

         |GRABA 020#n43m0103.a;
         |LIBERA #n43m0103;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid103;
     |FOCOTECLADO nGrid103;
|FPRC;

|PROCESO BorraOfi;
     |CONFI "0000NEsta seguro que quiere borrar la oficina seleccionada.";
     |SI FSalida ! 0;
         |FOCOTECLADO nGrid103;
         |ACABA;
     |FINSI;

     |LEE 101#n43m0103.=;
     |SI FSalida ! 0;
         |FOCOTECLADO nGrid103;
         |ACABA;
     |FINSI;

     |BORRA 020#n43m0103.a;
     |LIBERA #n43m0103;

     |REFRESCACONTROL nGrid103;
     |FOCOTECLADO nGrid103;

     |ESTADO_CONTROL nBtnMOfi, "DISABLE";
     |ESTADO_CONTROL nBtnBOfi, "DISABLE";
|FPRC;

|PROGRAMA;
     aAlfa = "Entidad ";
     aAlfa = aAlfa  + #n43m0102#0 + " / ";
     aAlfa = aAlfa  + " " + #n43m0102#1;  |QBF aAlfa;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     n0Vent = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Nueva", 3287, 3298, NuevaOfi;
     nBtnNOfi = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3275, 3285, ModiOfi;
     nBtnMOfi  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3263, 3273, BorraOfi;
     nBtnBOfi = FSalida;

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#n43m0103, nRango, 0602, 3198, Baja103, Alta103, Evnt103;
     nGrid103 = FSalida;

     |ESTADO_CONTROL nBtnMOfi, "DISABLE";
     |ESTADO_CONTROL nBtnBOfi, "DISABLE";

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid103;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FINVENTANA n0Vent;

     |PULSATECLA;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |ABRET #n43m0103;

     |ABRE #n43m0102;
     |SELECT #1#n43m0102;
     #n43m0102#0 = eaEnt;
     |LEE 000#n43m0102.=;
     |CIERRA #n43m0102;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #n43m0103;
|FPRC;
