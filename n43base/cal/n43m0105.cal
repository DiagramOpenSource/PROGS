|FICHEROS;
     n43m0001;
     n43m0002;
     n43m0102;
     n43m0103;
     n43m0105;

     n43w0003,MANTE;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nGrid105            = -1;
     nBtnAlt             = 0;
     nBtnCon             = 0;
     nBtnMod             = 0;
     nBtnBor             = 0;
     nBtnReg             = 0;
     nRango              = 0;
     nHandle             = 0;
     nLong               = 0;
     nCampo              = 0;
     nCaracter           = 0;
     nPos                = 0;
     nTree               = 0;

     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aAlfa               = "";
     aPathLocal          = "";
     aFicTmp             = "";
     aDEnt               = "";
     aHEnt               = "";
     aBase               = "";
     aAbre               = "";

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

     &eaUnidadBasico     = "";
     &eaEnt              = "";
     &enEmp              = 0;
|FIN;

|PROCESO Baja105;
     #n43m0105#0 = aDEnt;
     #n43m0105#1 = "";
     #n43m0105#2 = "";
|FPRC;

|PROCESO Alta105;
     #n43m0105#0 = aHEnt;
     #n43m0105#1 = "zzzz";
     #n43m0105#2 = "zzzzzzzzzz";
|FPRC;

|PROCESO Alta;
     |VENTANA 0501, 2399, -1, 16, "Nueva cuenta corriente";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     |DDEFECTO #n43w0003;

     |C_M #n43w0003#0,  1, "S";
     |C_M #n43w0003#2,  1, "S";
     |C_M #n43w0003#11, 1, "S";
     |C_M #n43w0003#12, 1, "S";

     |SI eaEnt ! "";
         |C_M #n43w0003#0, 1, "N";

         #n43w0003#0  = #n43m0102#0;
         #n43w0003#1  = #n43m0102#1;
     |FINSI;

     |PINPA #0#n43w0003;
     |PINDA #0#n43w0003;
     |ENDATOS #1#n43w0003;
     |SI FSalida = 0;
         #n43m0105#0  = #n43w0003#0;
         #n43m0105#1  = #n43w0003#2;
         #n43m0105#2  = #n43w0003#11;
         #n43m0105#3  = #n43w0003#12;
         #n43m0105#4  = #n43w0003#13;
         #n43m0105#5  = #n43w0003#14;
         #n43m0105#6  = #n43w0003#1;
         #n43m0105#7  = #n43w0003#3;
         #n43m0105#9  = #n43w0003#16;

         |GRABA 020#n43m0105.n;
         |LIBERA #n43m0105;

         #n43m0001#0 = #n43m0105#3;
         |LEE 000#n43m0001.=;
         |SI FSalida ! 0;
             |DDEFECTO #n43m0001;
             #n43m0001#0 = #n43w0003#12;
             #n43m0001#1 = #n43w0003#13;
             #n43m0001#2 = #n43w0003#15;

             |GRABA 020#n43m0001.n;
             |LIBERA #n43m0001;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid105;
     |FOCOTECLADO nGrid105;
|FPRC;

|PROCESO Consulta;
     |VENTANA 0501, 2399, -1, 16, "Consulta cuenta corriente";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     #n43m0001#0 = #n43m0105#3;
     |LEE 000#n43m0001.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0001;  |FINSI;

     #n43m0102#0 = #n43m0105#0;
     |LEE 000#n43m0102.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0102;  |FINSI;

     #n43m0103#0 = #n43m0105#0;
     #n43m0103#1 = #n43m0105#1;
     |LEE 000#n43m0103.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0103;  |FINSI;

     |DDEFECTO #n43w0003;

     #n43w0003#0  = #n43m0102#0;
     #n43w0003#1  = #n43m0102#1;
     #n43w0003#2  = #n43m0103#1;
     #n43w0003#3  = #n43m0103#2;
     #n43w0003#4  = #n43m0103#3;
     #n43w0003#5  = #n43m0103#4;
     #n43w0003#6  = #n43m0103#5;
     #n43w0003#7  = #n43m0103#6;
     #n43w0003#8  = #n43m0103#7;
     #n43w0003#9  = #n43m0103#8;
     #n43w0003#10 = #n43m0103#9;
     #n43w0003#11 = #n43m0105#2;
     #n43w0003#12 = #n43m0105#3;
     #n43w0003#13 = #n43m0105#4;
     #n43w0003#14 = #n43m0105#5;
     #n43w0003#16 = #n43m0105#9;

     |PINPA #0#n43w0003;
     |PINDA #0#n43w0003;
     |LEETECLA aTecla;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO Modificar;
     |VENTANA 0501, 2399, -1, 16, "Modificar cuenta corriente";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     #n43m0001#0 = #n43m0105#3;
     |LEE 000#n43m0001.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0001;  |FINSI;

     #n43m0102#0 = #n43m0105#0;
     |LEE 000#n43m0102.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0102;  |FINSI;

     #n43m0103#0 = #n43m0105#0;
     #n43m0103#1 = #n43m0105#1;
     |LEE 000#n43m0103.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0103;  |FINSI;

     |LEE 101#n43m0105.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DDEFECTO #n43w0003;

     #n43w0003#0  = #n43m0102#0;
     #n43w0003#1  = #n43m0102#1;
     #n43w0003#2  = #n43m0103#1;
     #n43w0003#3  = #n43m0103#2;
     #n43w0003#4  = #n43m0103#3;
     #n43w0003#5  = #n43m0103#4;
     #n43w0003#6  = #n43m0103#5;
     #n43w0003#7  = #n43m0103#6;
     #n43w0003#8  = #n43m0103#7;
     #n43w0003#9  = #n43m0103#8;
     #n43w0003#10 = #n43m0103#9;
     #n43w0003#11 = #n43m0105#2;
     #n43w0003#12 = #n43m0105#3;
     #n43w0003#13 = #n43m0105#4;
     #n43w0003#14 = #n43m0105#5;
     #n43w0003#16 = #n43m0105#9;

     |C_M #n43w0003#0,  1, "N";
     |C_M #n43w0003#2,  1, "N";
     |C_M #n43w0003#11, 1, "N";
     |C_M #n43w0003#12, 1, "N";

     |PINPA #0#n43w0003;
     |PINDA #0#n43w0003;
     |ENDATOS #2#n43w0003;
     |SI FSalida = 0;
         #n43m0105#5 = #n43w0003#14;
         #n43m0105#9 = #n43w0003#16;
         |GRABA 020#n43m0105.a;
     |FINSI;
     |LIBERA #n43m0105;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid105;
     |FOCOTECLADO nGrid105;
|FPRC;

|PROCESO Borrar;
     |LEE 101#n43m0105.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#n43m0105.a;
     |LIBERA #n43m0105;

     |ESTADO_CONTROL nBtnCon, "DISABLE";
     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";
     |ESTADO_CONTROL nBtnReg, "DISABLE";

     |REFRESCACONTROL nGrid105;
     |FOCOTECLADO nGrid105;
|FPRC;

|PROCESO Reglas;
     |SI #n43m0105#3 = 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 0501, -1, 16, "";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |PTEC 802; |PAUSA;

     eaEnt = #n43m0105#0;
     enEmp = #n43m0105#3;

     |SUB_EJECUTA "n43z0007";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |FOCOTECLADO nGrid105;
|FPRC;

|PROCESO BtnExcel;
     |VENTANA 0501, 0501, -1, 0, "";
     n1Vent = FSalida;

     |SUB_EJECUTA "n43z0004";

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid105;
     |FOCOTECLADO nGrid105;
|FPRC;

|PROCESO Evnt105;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#n43m0105.=;

         |ESTADO_CONTROL nBtnCon, "ENABLE";
         |ESTADO_CONTROL nBtnMod, "ENABLE";
         |ESTADO_CONTROL nBtnBor, "ENABLE";
         |ESTADO_CONTROL nBtnReg, "ENABLE";

         |DDEFECTO #n43m0002;
         #n43m0002#0  = #n43m0105#3;
         #n43m0002#1  = #n43m0105#0;
         #n43m0002#2  = #n43m0105#1;
         #n43m0002#3  = #n43m0105#2;
         |LEE 000#n43m0002.];
         |SI FSalida = 0;
          |Y #n43m0002#0  = #n43m0105#3;
          |Y #n43m0002#1  = #n43m0105#0;
          |Y #n43m0002#2  = #n43m0105#1;
          |Y #n43m0002#3  = #n43m0105#2;
             |ESTADO_CONTROL nBtnBor, "DISABLE";
          |FINSI;
     |FINSI;

     |SI FSalida = 4;
         |HAZ Consulta;
     |FINSI;
|FPRC;

|PROGRAMA;
     aAlfa = "Cuentas corrientes";
     aDEnt = "";
     aHEnt = "zzzz";
     |SI eaEnt ! "";
         aAlfa = "Entidad ";
         aAlfa = aAlfa  + #n43m0102#0 + " / ";
         aAlfa = aAlfa  + " " + #n43m0102#1;  |QBF aAlfa;

         aDEnt = eaEnt;
         aHEnt = eaEnt;
     |FINSI;

     |VENTANA 0501, 3599, -1, 16, aAlfa;
     n0Vent = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta", 3288, 3298, Alta;
     nBtnAlt  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Consulta", 3274, 3286, Consulta;
     nBtnCon  = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3262, 3272, Modificar;
     nBtnMod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3250, 3260, Borrar;
     nBtnBor = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Reglas", 3202, 3210, Reglas;
     nBtnReg = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Importaci¢n CSV de ctas.ctes.", 3502, 3530, BtnExcel;

     |ESTADO_CONTROL nBtnCon, "DISABLE";
     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";
     |ESTADO_CONTROL nBtnReg, "DISABLE";

     nRango   = 2 + 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#n43m0105, nRango, 0602, 3198, Baja105, Alta105, Evnt105;
     nGrid105 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nGrid105;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FINVENTANA n0Vent;

     |PULSATECLA;
|FPRO;

|PROCESO T80;  |TIPO 80;
     |HAZ DimePaquete;

     |ABRET #n43m0001;
     |ABRET #n43m0002;
     |ABRET #n43m0102;
     |ABRET #n43m0103;
     |ABRET #n43m0105;

     |SELECT #1#n43m0102;
     #n43m0102#0 = eaEnt;
     |LEE 000#n43m0102.=;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #n43m0001;
     |CIERRAT #n43m0002;
     |CIERRAT #n43m0102;
     |CIERRAT #n43m0103;
     |CIERRAT #n43m0105;
|FPRC;
