|FICHEROS;
     n43z0006;

     n43m0102;
     n43m0106;

     n43w0012;
     n43w0013;

     trabajo@;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nGrid12             = 0;
     nGrid13             = 0;
     nPanta              = 0;
     nBtn                = 0;
     nTCmp               = 0;
     nCmp                = 0;
     nCmp1               = 0;
     nCmp2               = 0;
     nCmp3               = 0;
     nLinCumple          = 0;
     nLinGraba           = 0;
     nPos1               = 0;
     nPos2               = 0;
     nRango              = 0;
     nOk                 = 0;

     aAlfa               = "";
     aPathLocal          = "";
     aPathPlugins        = "";
     aIP                 = "";
     aOri                = "";
     aDes                = "";
     aBase               = "";
     aAbre               = "";
     aVis                = "";
     aMas                = "";
     aQQ                 = "";
     aFicTmp             = "";
     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";

 {40}aPopup              = "";
 {50}nBtnCmp             = -1;

     {-1}aVent           = "";
         aVent1          = 0;
         aVent2          = 0;
         aVent3          = 0;
         aVent4          = 0;
         aVent5          = "";

 {-1}aGet                = 0;
     aGet1               = 0;
     aGet2               = 0;

     &eaEnt              = "";
     &enRegla            = 0;
     &eaUnidadBasico     = "";
|FIN;

|PROCESO LineaCumple;
     |SI nLinCumple = 12; nCmp1 = 3;  |FINSI;
     |SI nLinCumple = 13; nCmp1 = 6;  |FINSI;
     |SI nLinCumple = 14; nCmp1 = 9;  |FINSI;
     |SI nLinCumple = 15; nCmp1 = 12; |FINSI;
     |SI nLinCumple = 16; nCmp1 = 15; |FINSI;
     |SI nLinCumple = 17; nCmp1 = 18; |FINSI;
     |SI nLinCumple = 18; nCmp1 = 21; |FINSI;
     |SI nLinCumple = 19; nCmp1 = 24; |FINSI;
     |SI nLinCumple = 20; nCmp1 = 27; |FINSI;
     |SI nLinCumple = 21; nCmp1 = 30; |FINSI;

     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;

     nOk   = 1;
     aAlfa = #n43z0006#nCmp1#;  |QBT aAlfa;
     |SI aAlfa = "Campo";
         |MENAV "0000Complete la linea";
         nOk = 0;
         |ACABA;
     |FINSI;

     aAlfa = #n43z0006#nCmp2#;  |QBT aAlfa;
     |SI aAlfa = "Condici¢n";
         |MENAV "0000Complete la linea";
         nOk = 0;
         |ACABA;
     |FINSI;

     |REFERENCIA_DEF aGet1, #n43z0006;
     aGet2 = nCmp3;
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     #n43z0006#nCmp3# = FSalida;

     aAlfa = #n43z0006#nCmp3#;  |QBT aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Complete la linea";
         nOk = 0;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO LineaGraba;
     |SI nLinGraba = 29; nCmp1 = 33;  |FINSI;
     |SI nLinGraba = 30; nCmp1 = 35;  |FINSI;
     |SI nLinGraba = 31; nCmp1 = 37;  |FINSI;
     |SI nLinGraba = 32; nCmp1 = 39; |FINSI;

     nCmp2 = nCmp1 + 1;

     nOk   = 1;
     aAlfa = #n43z0006#nCmp1#;  |QBT aAlfa;
     |SI aAlfa = "Campo";
         nOk = 0;

         |MENAV "0000Complete la linea";
         |ACABA;
     |FINSI;

     |REFERENCIA_DEF aGet1, #n43z0006;
     aGet2 = nCmp2;
     IaGet = aGet1<-;
     |ESPECIFICA "GETDATACONTROL", aGet;
     #n43z0006#nCmp2# = FSalida;

     aAlfa = #n43z0006#nCmp2#;  |QBT aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Complete la linea";
         nOk = 0;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO T12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         |ERROR;
         |POSICIONATE #n43z0006#3;
         |ACABA;
     |FINSI;

     |HAZ LineaCumple;
     |SI nOk = 0;
         |ERROR;
         |POSICIONATE #n43z0006#3;
         |ACABA;
     |FINSI;

     |HAZ LineaGraba;
     |SI nOk = 0;
         |ERROR;
         |POSICIONATE #n43z0006#34;
         |ACABA;
     |FINSI;

     |SI enRegla = 0;
         #n43m0106#0 = #n43m0102#0;
         |PARA enRegla = 1;  |SI enRegla [ 9999;  |HACIENDO enRegla = enRegla + 1;
               #n43m0106#1 = enRegla;
               |LEE 000#n43m0106.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |FINSI;

     #n43m0106#0 = #n43m0102#0;
     #n43m0106#1 = enRegla;
     |LEE 101#n43m0106.=;
     |SI FSalida ! 0;
         |DDEFECTO #n43m0106;
         #n43m0106#0 = #n43m0102#0;
         #n43m0106#1 = enRegla;
         #n43m0106#3 = 9999;

         |GRABA 020#n43m0106.b;
     |FINSI;

     #n43m0106#2 = #n43z0006#1;
     #n43m0106#4 = #n43z0006#0;
     #n43m0106#5 = #n43z0006#2;

     |PARA nCmp1 = 3;  |SI nCmp1 [ 40;  |HACIENDO nCmp1 = nCmp1 + 1;
           nCmp2 = nCmp1 + 3;
           #n43m0106#nCmp2# = #n43z0006#nCmp1#;
     |SIGUE;

     |GRABA 020#n43m0106.a;
     |LIBERA #n43m0106;
|FPRC;

|PROCESO PintaCumple;
     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;

     |C_V #n43z0006#nCmp3#, 1, "S";

     aAlfa = #n43z0006#nCmp1#;  |QBF aAlfa;
     |SI aAlfa = "";
         |C_V #n43z0006#nCmp3#, 1, "N";
     |FINSI;

     |C_V #n43z0006#nCmp3#, 0, aVis;
     |C_M #n43z0006#nCmp3#, 1, "N";

     |SI aVis = "S";
         |C_M #n43z0006#nCmp3#, 1, "S";

         nLinCumple  = nLinCumple  + 1;

         aAlfa = #n43z0006#nCmp1#;  |QBF aAlfa;
         |SI aAlfa = "Campo";
             aAlfa = "BOTON,Campo";
         |SINO;
             aAlfa = "BOTON," + (#n43z0006#nCmp1# % 1620);  |QBF aAlfa;
         |FINSI;

         nPos1 = (nLinCumple * 100) + 4;
         nPos2 = (nLinCumple * 100) + 24;

         InBtnCmp = nBtnCmp1 <-;
         InBtnCmp = InBtnCmp + (nCmp1 - 1);
         |CONTROL_SIMPLE nPanta, aAlfa, nPos1, nPos2, Campos;
         nBtnCmp = FSalida;

         aAlfa = #n43z0006#nCmp2#;  |QBF aAlfa;
         |SI aAlfa = "";
             aAlfa = "BOTON,Condici¢n";
         |SINO;
             aAlfa = "BOTON," + #n43z0006#nCmp2#;  |QBF aAlfa;
         |FINSI;

         nPos1 = (nLinCumple * 100) + 26;
         nPos2 = (nLinCumple * 100) + 46;

         InBtnCmp = nBtnCmp1 <-;
         InBtnCmp = InBtnCmp + (nCmp2 - 1);
         |CONTROL_SIMPLE nPanta, aAlfa, nPos1, nPos2, Condicion;
         nBtnCmp = FSalida;
     |FINSI;

     |PINTA #n43z0006#nCmp3#;
|FPRC;

|PROCESO BorraCumple;
     InBtnCmp = nBtnCmp1 <-;
     InBtnCmp = InBtnCmp + (nCmp - 1);
     |SI nBtnCmp ! -1;
         nBtn = nBtnCmp;
         |DESTRUYECONTROL nBtn;
         nBtnCmp = -1;
     |FINSI;
|FPRC;

|PROCESO BtnCumple;
     |PARA nCmp = 3;  |SI nCmp [ 32;  |HACIENDO nCmp = nCmp + 1;
           |HAZ BorraCumple;
     |SIGUE;

     nLinCumple = 11;
     |PARA nCmp1 = 3;  |SI nCmp1 [ 30;  |HACIENDO nCmp1 = nCmp1 + 3;
           |HAZ PintaCumple;
     |SIGUE;
|FPRC;

|PROCESO PintaGraba;
     nCmp2 = nCmp1 + 1;

     |C_V #n43z0006#nCmp2#, 1, "S";

     aAlfa = #n43z0006#nCmp1#;  |QBF aAlfa;
     |SI aAlfa = "";
         |C_V #n43z0006#nCmp2#, 1, "N";
     |FINSI;

     |C_V #n43z0006#nCmp2#, 0, aVis;
     |C_M #n43z0006#nCmp2#, 1, "N";

     |SI aVis = "S";
         |C_M #n43z0006#nCmp2#, 1, "S";

         nLinGraba = nLinGraba  + 1;

         aAlfa = #n43z0006#nCmp1#;  |QBF aAlfa;
         |SI aAlfa = "Campo";
             aAlfa = "BOTON,Campo";
         |SINO;
             aAlfa = "BOTON," + #n43z0006#nCmp1#;  |QBF aAlfa;
         |FINSI;

         nPos1 = (nLinGraba * 100) + 4;
         nPos2 = (nLinGraba * 100) + 30;

         InBtnCmp = nBtnCmp1 <-;
         InBtnCmp = InBtnCmp + (nCmp1 - 1);
         |CONTROL_SIMPLE nPanta, aAlfa, nPos1, nPos2, CamposGraba;
         nBtnCmp = FSalida;
     |FINSI;

     |PINTA #n43z0006#nCmp2#;
|FPRC;

|PROCESO BorraGraba;
     InBtnCmp = nBtnCmp1 <-;
     InBtnCmp = InBtnCmp + (nCmp - 1);
     |SI nBtnCmp ! -1;
         nBtn = nBtnCmp;
         |DESTRUYECONTROL nBtn;
         nBtnCmp = -1;
     |FINSI;
|FPRC;

|PROCESO BtnGraba;
     |PARA nCmp = 33;  |SI nCmp [ 40;  |HACIENDO nCmp = nCmp + 1;
           |HAZ BorraGraba;
     |SIGUE;

     nLinGraba = 28;
     |PARA nCmp1 = 33;  |SI nCmp1 [ 40;  |HACIENDO nCmp1 = nCmp1 + 2;
           |HAZ PintaGraba;
     |SIGUE;
|FPRC;

|PROCESO Baja13;
     #n43w0013#0 = #n43w0012#0;
     #n43w0013#1 = "";
|FPRC;

|PROCESO Alta13;
     #n43w0013#0 = #n43w0012#0;
     #n43w0013#1 = "zzz";
|FPRC;

|PROCESO Evnt13;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#n43w0013.=;
     |FINSI;

     |SI FSalida = 4;
         aAlfa = "#" + #n43w0013#0 + "#" + #n43w0013#1 + "# ";
         aAlfa = aAlfa + #n43w0013#2;

         #n43z0006#nCmp# = aAlfa;

         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Evnt12;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#n43w0012.=;

         #n43w0013#0 = #n43w0012#0;
         #n43w0013#1 = "000";
         |LEE 000#n43w0013.=;

         |REFRESCACONTROL nGrid13;
     |FINSI;
|FPRC;


|PROCESO SacaCampos;
     |VENTANA 0501, 3578, -1, 16, "Selecci¢n de campos";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 4 + 8 + 16 + 32 + 128 + 256;

     |LEE 000#n43w0012.p;

     |LINEAL_SIMPLE #1#n43w0012, nRango, 0602, 2035, NULL, NULL, Evnt12;
     nGrid12 = FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#n43w0013, nRango, 0640, 3275, Baja13, Alta13, Evnt13;
     nGrid13 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid12;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |HAZ BtnCumple;
|FPRC;

|PROCESO SacaCondicion;
     aPopup1  = nBtnCmp;
     aPopup2  = 4;
     aPopup3  = "coincide exactamente";
     aPopup4  = "no coincide exactamente";
     aPopup5  = "contiene";
     aPopup6  = "no contiene";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         #n43z0006#nCmp# = aPopup;
     |FINSI;

     |HAZ BtnCumple;
|FPRC;

|PROCESO Condicion;
     nCmp     = 0;
     InBtnCmp = nBtnCmp1 <-;
     |PARA nCmp1 = 1;  |SI nCmp1 [ 32;  |HACIENDO nCmp1 = nCmp1 + 1;
           |SI nBtnCmp = FSalida;
               nCmp = nCmp1;
               |SAL;
           |FINSI;

           InBtnCmp = InBtnCmp + 1;
     |SIGUE;

     |SI nCmp = 0;  |ACABA;  |FINSI;

     |HAZ SacaCondicion;
|FPRC;

|PROCESO Campos;
     nCmp     = 0;
     InBtnCmp = nBtnCmp1 <-;
     |PARA nCmp1 = 1;  |SI nCmp1 [ 32;  |HACIENDO nCmp1 = nCmp1 + 1;
           |SI nBtnCmp = FSalida;
               nCmp = nCmp1;
               |SAL;
           |FINSI;

           InBtnCmp = InBtnCmp + 1;
     |SIGUE;

     |SI nCmp = 0;  |ACABA;  |FINSI;

     |HAZ SacaCampos;
|FPRC;

|PROCESO SacaCamposGraba;
     aPopup1  = nBtnCmp;
     aPopup2  = 5;
     aPopup3  = "Cuenta";
     aPopup4  = "Cuenta contrapartida";
     aPopup5  = "Concepto cuenta";
     aPopup6  = "Concepto contrapartida";
     aPopup7  = "Diario";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         #n43z0006#nCmp1# = aPopup;
     |FINSI;

     |HAZ BtnGraba;
|FPRC;

|PROCESO CamposGraba;
     nCmp     = 0;
     InBtnCmp = nBtnCmp1 <-;
     |PARA nCmp1 = 1;  |SI nCmp1 [ 40;  |HACIENDO nCmp1 = nCmp1 + 1;
           |SI nBtnCmp = FSalida;
               nCmp = nCmp1;
               |SAL;
           |FINSI;

           InBtnCmp = InBtnCmp + 1;
     |SIGUE;

     |SI nCmp = 0;  |ACABA;  |FINSI;

     |HAZ SacaCamposGraba;
|FPRC;

|PROCESO BtnCmp2;
     aPopup1  = nBtnCmp2;
     aPopup2  = 2;
     aPopup3  = "cualquiera de";
     aPopup4  = "todas";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         #n43z0006#2 = aPopup;

         nBtn = nBtnCmp2;
         |DESTRUYECONTROL nBtn;

         aAlfa = "BOTON," + #n43z0006#2;  |QBF aAlfa;
         |CONTROL_SIMPLE nPanta, aAlfa, 0815, 0830, BtnCmp2;
         nBtnCmp2 = FSalida;
     |FINSI;
|FPRC;

|PROCESO MasCumple;
     |SI nLinCumple = 21;  |ACABA;  |FINSI;

     |HAZ LineaCumple;
     |SI nOk = 0;  |ACABA;  |FINSI;

     nLinCumple = nLinCumple + 1;

     |SI nLinCumple = 13; nCmp1 = 6;  |FINSI;
     |SI nLinCumple = 14; nCmp1 = 9;  |FINSI;
     |SI nLinCumple = 15; nCmp1 = 12; |FINSI;
     |SI nLinCumple = 16; nCmp1 = 15; |FINSI;
     |SI nLinCumple = 17; nCmp1 = 18; |FINSI;
     |SI nLinCumple = 18; nCmp1 = 21; |FINSI;
     |SI nLinCumple = 19; nCmp1 = 24; |FINSI;
     |SI nLinCumple = 20; nCmp1 = 27; |FINSI;
     |SI nLinCumple = 21; nCmp1 = 30; |FINSI;

     nCmp2 = nCmp1 + 1;

     #n43z0006#nCmp1# = "Campo";
     #n43z0006#nCmp2# = "Condici¢n";
     |HAZ BtnCumple;
|FPRC;

|PROCESO MenosCumple;
     |SI nLinCumple = 12;  |ACABA;  |FINSI;

     |SI nLinCumple = 13; nCmp1 = 6;  |FINSI;
     |SI nLinCumple = 14; nCmp1 = 9;  |FINSI;
     |SI nLinCumple = 15; nCmp1 = 12; |FINSI;
     |SI nLinCumple = 16; nCmp1 = 15; |FINSI;
     |SI nLinCumple = 17; nCmp1 = 18; |FINSI;
     |SI nLinCumple = 18; nCmp1 = 21; |FINSI;
     |SI nLinCumple = 19; nCmp1 = 24; |FINSI;
     |SI nLinCumple = 20; nCmp1 = 27; |FINSI;
     |SI nLinCumple = 21; nCmp1 = 30; |FINSI;

     nCmp2 = nCmp1 + 1;
     nCmp3 = nCmp1 + 2;

     #n43z0006#nCmp1# = "";
     #n43z0006#nCmp2# = "";
     #n43z0006#nCmp3# = "";
     |HAZ BtnCumple;
|FPRC;

|PROCESO MasGraba;
     |SI nLinGraba = 32;  |ACABA;  |FINSI;

     |HAZ LineaGraba;
     |SI nOk = 0;  |ACABA;  |FINSI;

     nLinGraba = nLinGraba + 1;

     |SI nLinGraba = 30; nCmp1 = 35;  |FINSI;
     |SI nLinGraba = 31; nCmp1 = 37;  |FINSI;
     |SI nLinGraba = 32; nCmp1 = 39;  |FINSI;

     nCmp2 = nCmp1 + 1;

     #n43z0006#nCmp1# = "Campo";
     |HAZ BtnGraba;
|FPRC;

|PROCESO MenosGraba;
     |SI nLinGraba = 29;  |ACABA;  |FINSI;

     |SI nLinGraba = 30; nCmp1 = 35;  |FINSI;
     |SI nLinGraba = 31; nCmp1 = 37;  |FINSI;
     |SI nLinGraba = 32; nCmp1 = 39;  |FINSI;

     nCmp2 = nCmp1 + 1;

     #n43z0006#nCmp1# = "";
     #n43z0006#nCmp2# = "";
     |HAZ BtnGraba;
|FPRC;

|PROGRAMA;
     aAlfa = "Regla " + #n43m0106#4;  |QBF aAlfa;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     n0Vent = FSalida;
     |PTEC 802;  |PAUSA;

     |PINPA #0#n43z0006;  nPanta = FSalida;

     aAlfa = "BOTON," + #n43z0006#2;  |QBF aAlfa;
     |CONTROL_SIMPLE nPanta, aAlfa, 0815, 0830, BtnCmp2;
     nBtnCmp2 = FSalida;

     aAlfa = "IMAGEN," + aPathLocal + "mas.bmp";
     |CONTROL_SIMPLE nPanta, aAlfa, 1088, 1090, MasCumple;
     |CONTROL_SIMPLE nPanta, aAlfa, 2788, 2790, MasGraba;

     aAlfa = "IMAGEN," + aPathLocal + "menos.bmp";
     |CONTROL_SIMPLE nPanta, aAlfa, 1093, 1095, MenosCumple;
     |CONTROL_SIMPLE nPanta, aAlfa, 2793, 2795, MenosGraba;

     |HAZ BtnCumple;
     |HAZ BtnGraba;

     |PINDA #0#n43z0006;
     |ENDATOS #1#n43z0006;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO CreaLista;
     |DBASE aBase;
     aMas = aBase + "def/" + #n43w0012#0 + ".mas";
     |CARGA_DEF aMas, trabajo@;

     aQQ      = "|NC";
     aAlfa    = #trabajo@#aQQ#;
     nTCmp  = aAlfa;
     nTCmp  = nTCmp - 1;

     |SI #n43w0012#0 = "n43m0002";
         nTCmp  = 26;
     |FINSI;

     |PARA nCmp = 0;  |SI nCmp [ nTCmp;  |HACIENDO nCmp = nCmp + 1;
           aQQ   = "|C" + (("000" + nCmp) % -103) + "NOMBRE";
           aAlfa = (#trabajo@#aQQ# + (" " * 20)) % 120;  |QBF aAlfa;

           |SI aAlfa ! "Inhibido";
               #n43w0013#0 = #n43w0012#0;
               #n43w0013#1 = ("000" + nCmp) % -103;
               #n43w0013#2 = aAlfa;
               |GRABA 000#n43w0013.n;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CreaCmp;
     aFicTmp = "n43w0012" + Usuario;
     |NOME_DAT #n43w0012#aFicTmp#;
     |ABRE #n43w0012;  |CIERRA #n43w0012;  |DELINDEX #n43w0012;

     aFicTmp = "n43w0013" + Usuario;
     |NOME_DAT #n43w0013#aFicTmp#;
     |ABRE #n43w0013;  |CIERRA #n43w0013;  |DELINDEX #n43w0013;

     |ABRET #n43w0012;
     |ABRET #n43w0013;

     #n43w0012#0 = "n43m0100";
     #n43w0012#1 = "Conceptos comunes";
     |GRABA 000#n43w0012.n;
     |HAZ CreaLista;

     #n43w0012#0 = "n43m0104";
     #n43w0012#1 = "Conceptos propios";
     |GRABA 000#n43w0012.n;
     |HAZ CreaLista;

     #n43w0012#0 = "n43m0002";
     #n43w0012#1 = "Movimientos";
     |GRABA 000#n43w0012.n;
     |HAZ CreaLista;
|FPRC;

|PROCESO T80;  |TIPO 80;
     |HAZ CreaCmp;

     aIP      = "";
     |IP_REMOTO aIP;

     |HAZ LeeUnidadBasico;
     aPathLocal = eaUnidadBasico + "\documentos";   |RMKDIR aPathLocal;
     aPathLocal = aPathLocal + "\n43base";          |RMKDIR aPathLocal;
     aPathLocal = aPathLocal + "\";

     |DBASE aBase;
     aPathPlugins = aBase + "plugins/";

     aAbre = aPathLocal + "mas.bmp";
     |XABRE "EC", aAbre, 0;
     |SI FSalida < 0;
         aOri = aPathPlugins + "mas.bmp";
         aDes = aPathLocal + "mas.bmp";

         |SI aIP = "";
             |COPIA_FICHERO aOri, aDes;
         |SINO;
             |ENVIA_FICHERO aOri, aDes;
         |FINSI;
     |FINSI;

     aAbre = aPathLocal + "menos.bmp";
     |XABRE "EC", aAbre, 0;
     |SI FSalida < 0;
         aOri = aPathPlugins + "menos.bmp";
         aDes = aPathLocal + "menos.bmp";

         |SI aIP = "";
             |COPIA_FICHERO aOri, aDes;
         |SINO;
             |ENVIA_FICHERO aOri, aDes;
         |FINSI;
     |FINSI;

     |ABRE #n43m0102;
     #n43m0102#0 = eaEnt;
     |LEE 000#n43m0102.=;
     |SI FSalida ! 0;  |DDEFECTO #n43m0102;  |FINSI;
     |CIERRA #n43m0102;

     |ABRET #n43m0106;
     |DDEFECTO #n43z0006;

     |SI enRegla ! 0;
         #n43m0106#0 = #n43m0102#0;
         #n43m0106#1 = enRegla;
         |LEE 000#n43m0106.=;

         #n43z0006#0 = #n43m0106#4;
         #n43z0006#1 = #n43m0106#2;
         #n43z0006#2 = #n43m0106#5;

         |PARA nCmp1 = 3;  |SI nCmp1 [ 40;  |HACIENDO nCmp1 = nCmp1 + 1;
               nCmp2 = nCmp1 + 3;
               #n43z0006#nCmp1# = #n43m0106#nCmp2#;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #n43w0012;  |DELINDEX #n43w0012;
     |CIERRAT #n43w0013;  |DELINDEX #n43w0013;
     |CIERRAT #n43m0106;
|FPRC;
