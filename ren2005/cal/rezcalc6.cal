|FICHEROS;
      rew99999 #999;
      rem00019 #19;

     &refere1@ #1001;
     &refere2@ #1002;
     &referr3@ #1003;

      datfic0@ #0;
      datfic1@ #1;
      datfic2@ #2;
      datfic3@ #3;
      datfic4@ #4;
      datfic5@ #5;

      retabla1 #401;
      retabla2 #402;
      retabla5 #405;
      rem00008 #408;
|FIN;

|VARIABLES;
      aDef             = "";
      aAlfa            = "";
      aAlfa1           = "";
      aAlfa2           = "";
      aFichero         = "";
      aCaracter        = "";
      aLong            = "";
      aCalcP           = "";
      aProlon1         = "";
      aProlon2         = "";
      aProlon3         = "";
      aProlon4         = "";
      aProlon5         = "";
      aProlon6         = "";
      aMovili1         = "";
      aMovili2         = "";
      aMovili3         = "";
      aMovili4         = "";
      aMovili5         = "";
      aMovili6         = "";
      aChequeo         = "";

      nCalcP           = 0;
      nCoefi           = 0;
      nSwFich          = 0;
      nLinea           = 0;
      nCampo           = 0;
      nCampo1          = 0;
      nCampo2          = 0;
      nCampo3          = 0;
      nCampo4          = 0;
      nResta           = 0;
      nResta1          = 0;
      nResta2          = 0;
      nValor           = 0;
      nConta           = 0;
      nMinFam          = 0;
      nMinFamE         = 0;
      nEdad            = 0;
      nTHijos          = 0;
      nTotalH1         = 0;
      nTotalH2         = 0;
      nTotalH3         = 0;
      nTotalH4         = 0;
      nTotalHF         = 0;
      nHijos3          = 0;
      nHijos16         = 0;
      nHijosM33        = 0;
      nHijosM33D       = 0;
      nHijosM65        = 0;
      nTAscen          = 0;
      nTAscen75        = 0;
      nAscenM33        = 0;
      nAscenM33D       = 0;
      nAscenM65        = 0;
      nAscenEM33       = 0;
      nAscenEM33D      = 0;
      nAscenEM65       = 0;
      nImput           = 0;
      nResto           = 0;
      nAjuste          = 0;
      nAjuste15        = 0;
      nAjuste2         = 0;
      nAjuste3         = 0;
      nAjuste4         = 0;
      nLimite          = 0;
      nLimitee         = 0;
      nLimiteT         = 0;
      nAcumLimite      = 0;
      nTipoMedio       = 0;
      nTipoMedio1      = 0;
      nTipoMedio2      = 0;
      nVEstatal1       = 0;
      nVEstatal2       = 0;
      nVAutonom1       = 0;
      nVAutonom2       = 0;
      nValor1          = 0;
      nValor2          = 0;
      nValor3          = 0;
      nValor4          = 0;
      nValor5          = 0;
      nValor6          = 0;
      nValor7          = 0;
      nValor8          = 0;
      nValor9          = 0;
      nValorP          = 0;

      nValor29         = 0;
      nValor30         = 0;
      nValor35         = 0;
      nValor41         = 0;
      nValor54         = 0;
      nValor36         = 0;
      nValor55         = 0;
      nValor58         = 0;
      nValor59         = 0;
      nValor60         = 0;
      nValor91         = 0;
      nValor104        = 0;

      nValorZ          = 0;
      nValorB          = 0;
      nValorC          = 0;
      nValorD          = 0;
      nValorE          = 0;
      nValorF          = 0;
      nValorG          = 0;
      nValorH          = 0;
      nValorP1         = 0;
      nValorP2         = 0;
      nValorB3         = 0;
      nValorB4         = 0;
      nValorC1         = 0;
      nValorC2         = 0;
      nParte1          = 0;
      nParte2          = 0;
      nTipo1           = 0;
      nTipo2           = 0;
      nCuota           = 0;
      nCuota56         = 0;
      nCuotaT          = 0;
      nCuota1          = 0;
      nCuotaAnt        = 0;
      nBaseEsp         = 0;
      nAnuHijos        = 0;
      nSumaAyer        = 0;
      nSumaHoy         = 0;
      nDiferencia      = 0;
      nBase            = 0;
      nBase1           = 0;
      nBase2           = 0;
      nBaseViv         = 0;
      nPorceBase       = 0;
      nFactor          = 0;
      nValorTit        = 0;
      nValorTit1       = 0;
      nValorTit2       = 0;
      nValorTit20      = 0;
      nValorCon        = 0;
      nValorCon1       = 0;
      nValorCon2       = 0;
      nValorCon20      = 0;
      nCuotaIntegra    = 0;
      nLimite1         = 0;
      nLimite2         = 0;
      nLimite25        = 0;
      nLimite35        = 0;
      nLimite45        = 0;
      nLimite70        = 0;
      nLimite81        = 0;
      nLimite50        = 0;
      nLimite100       = 0;
      nAcum            = 0;
      nAplicado        = 0;
      nDeducido        = 0;
      nImputT          = 0;
      nImputC          = 0;
      nExceso          = 0;
      nPagadores       = 0;
      nPagadoresC      = 0;
      nTotalPag        = 0;
      nExcesoT         = 0;
      nExcesoC         = 0;
      nSwConyuge       = 0;
      nSwTitular       = 0;
      nSwBorrar1       = 0;
      nSwBorrar2       = 0;
      nConvi           = 0;
      nCas489T         = 0;
      nCas489C         = 0;
      nCas490T         = 0;
      nCas490C         = 0;
      nValenciana4     = 0;
      nValenciana10    = 0;
      nValenciana14    = 0;
      nSwConjunta      = 0;
      nSwConjuntaE     = 0;
      nCompeT          = 0;
      nCompeC          = 0;
      nLong            = 0;
      nSuma            = 0;
      nSuma1           = 0;
      nPdte            = 0;
      nDeci            = 0;
      nPosi            = 0;
      nCaracter        = 0;
      nCompar          = 0;
      nRdtoTit         = 0;
      nRdtoTit16       = 0;
      nRdtoTit17       = 0;
      nRdtoTit18       = 0;
      nRdtoTitX        = 0;
      nRdtoCon         = 0;
      nRdtoCon16       = 0;
      nRdtoCon17       = 0;
      nRdtoCon18       = 0;
      nRdtoConX        = 0;
      nPasada          = 0;
      nContaAct        = 0;
      nSwEmpresarial   = 0;
      nNume            = 0;
      nAragon          = 0;
      nCodAutonomico   = 0;
      nExceso1         = 0;
      nExceso2         = 0;
      nDeduci1         = 0;
      nDeduci2         = 0;
      nResto1          = 0;
      nResto2          = 0;
      nResto3          = 0;
      nResto4          = 0;
      nPosible         = 0;
      nMinus1          = 0;
      nMinus2          = 0;
      nNorma1          = 0;
      nNorma2          = 0;
      nNorma3          = 0;
      nNorma4          = 0;
      nSwPasar         = 0;
      n941T            = 0;
      n942T            = 0;
      n943T            = 0;
      n944T            = 0;
      n945T            = 0;
      n946T            = 0;
      n947T            = 0;
      n948T            = 0;
      n941C            = 0;
      n942C            = 0;
      n943C            = 0;
      n944C            = 0;
      n945C            = 0;
      n946C            = 0;
      n947C            = 0;
      n948C            = 0;
      nCasilla         = 0;
      nComunidad       = 0;

      nRedTrab1        = 0;
      nRedTrab2        = 0;
      nRedTrab3        = 0;
      nRedTrab4        = 0;
      nRedTrab5        = 0;
      nRedTrab6        = 0;
      nEjerMo1         = 0;
      nEjerMo2         = 0;
      nEjerMo3         = 0;
      nEjerMo4         = 0;
      nEjerMo5         = 0;
      nEjerMo6         = 0;
      nEdadAdop        = 0;
      nAnyo            = 0;
      nAnyo1           = 0;
      nAnyo2           = 0;
      nRentas1         = 0;
      nRentas2         = 0;
      nRentas3         = 0;
      nRentas4         = 0;
      nRentas5         = 0;
      nRentas6         = 0;
      nRdtosTrab       = 0;
      nRdtosTrab1      = 0;
      nRdtosTrab2      = 0;
      nRdtosTrab3      = 0;
      nRdtosTrab4      = 0;
      nRdtosTrab5      = 0;
      nRdtosTrab6      = 0;
      nRdtosTrab7      = 0;
      nActivo1         = 0;
      nActivo2         = 0;
      nActivo3         = 0;
      nActivo4         = 0;
      nActivo5         = 0;
      nActivo6         = 0;
      nCas925          = 0;
      nCas926          = 0;
      nCas927          = 0;
      nCas929          = 0;
      nCas930          = 0;
      nCas931          = 0;
      nCas931M         = 0;
      nCas932          = 0;
      nCas933          = 0;
      nCas934          = 0;
      nCas934M         = 0;
      nVal925          = 0;
      nVal926          = 0;
      nVal927          = 0;
      nVal933          = 0;
      nRemanente       = 0;
      nAporta1         = 0;
      nAporta11        = 0;
      nAporta2         = 0;
      nAporta22        = 0;
      nAporta3         = 0;
      nAporta33        = 0;
      nAporta4         = 0;
      nAporta44        = 0;
      nAporta5         = 0;
      nImporte         = 0;
      nImporte1        = 0;
      nImporte2        = 0;
      nFamiliar        = 0;
      nPorce1          = 0;
      nPorce2          = 0;
      nPorce3          = 0;
      nPorce4          = 0;
      nCatalunyaA      = 0;
      nCatalunyaB      = 0;
      nMurcia          = 0;
      nOtra            = 0;
      nPendiente       = 0;
      nTodoDirec       = 0;
      nTodoImput       = 0;
      nTodoEjerc       = 0;
      nTodoDirecT      = 0;
      nTodoImputT      = 0;
      nTodoEjercT      = 0;
      nTodoMinusT      = 0;
      nTodoDirecC      = 0;
      nTodoImputC      = 0;
      nTodoEjercC      = 0;
      nTodoMinusC      = 0;
      nLimiteGral      = 0;
      nPisos           = 0;
      nProfesional     = 0;
      nBaseT           = 0;
      nBaseC           = 0;
      nBaseLiquiT      = 0;
      nBaseLiquiC      = 0;
      nBaseLiquiTE     = 0;
      nBaseLiquiCE     = 0;
      nLiquidar        = 0;
      nLiquidarT       = 0;
      nLiquidarC       = 0;
      nParQueVieneT    = 0;
      nParQueVieneC    = 0;
      nVar1            = 0;
      nVar2            = 0;
      nVar3            = 0;
      nVar4            = 0;
      nVar5            = 0;
      nTit             = 0;
      nCon             = 0;

      fFechaNac        = @;

     &enEmpresa        = 0;
     &enComplementaria = 0;
     &eaPathDef        = "";
     &eaContri         = "";
     &enMinusvalia     = 0;
     &eaMinuAyuda      = "";
     &enBloque         = 0;
     &eaCasilla        = "";
     &enImporte        = 0;
     &enImporteA       = 0;
     &enSwAcum         = 0;
     &eaLiquida        = "";
     &enNomeDat        = 0;
     &enNomeAgr        = 0;
     &eaMuerto         = "";
     &efFechaMuerto    = @;
     &enCalcuMuerto    = 0;
|FIN;

|PROCESO CalculaF;
     nValor = 0;
     enBloque = 29; eaCasilla = "738"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "739"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "740"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "741"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "742"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "743"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "744"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "745"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "746"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "747"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "748"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "749"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;

     enSwAcum   = 0;
     enBloque   = 29;
     eaCasilla  = "750";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     nValor1 = enImporte;

     enBloque  = 28;  eaCasilla = "737"; |HAZ SacaImporte; nValor = enImporte - nValor;

     enSwAcum  = 0;
     enBloque  = 30;
     eaCasilla = "755";
     |SI nValor < 0;
          nValor2 = -nValor;
          |SI nValor2 > nValor1;
               nValor = -nValor1;
          |FINSI;
     |FINSI;
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     enBloque  = 30; eaCasilla = "756"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque  = 30; eaCasilla = "757"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque  = 30; eaCasilla = "758"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque  = 30; eaCasilla = "759"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum   = 0;
     enBloque   = 30;
     eaCasilla  = "760";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO CalculaG;
     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1012"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1026"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;

     |DDEFECTO #0;
     #0#0 = enEmpresa;
     #0#1 = enComplementaria;
     #0#2 = "          ";
     |LEE 101#0];
     |PARA; |SI FSalida = 0;  |Y #0#0 = enEmpresa;  |Y #0#1 = enComplementaria;  |HACIENDO;
            #1#0 = #0#0;
            #1#1 = #0#1;
            #1#2 = #0#2;
            |LEE 040#1=;
            |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

            #2#0 = #0#0;
            #2#1 = #0#1;
            #2#2 = #0#2;
            |LEE 040#2=;
            |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

            #0#27  = (N\ #2#16 + #0#3 + #0#7  + #0#11 + #0#39 + #0#13 + #0#14 + #0#15 + #0#17);
            #0#28  = (N\ #2#17 + #0#4 + #0#40 + #0#12 + #0#16);
            nResta = #0#27 - #0#28;
            #0#29  = nResta;
            #0#30  = 0;
            |SI nResta < 0;
                #0#30 = -nResta;
                #0#29 = 0;
            |FINSI;

            #0#31  = (N\ #1#17 + #2#18 + #0#5 + #0#41 + #0#19 + #0#20 + #0#21);
            #0#32  = (N\ #1#18 + #2#19 + #0#6 + #0#42 + #0#18 + #0#22);
            nResta = #0#31 - #0#32;
            #0#33  = nResta;
            #0#34  = 0;
            |SI nResta < 0;
                #0#34 = -nResta;
                #0#33 = 0;
            |FINSI;

            |GRABA 020#0a;
            |LIBERA #0;

            #1001#0   = #0#0;
            #1001#1   = #0#1;
            #1001#2   = #0#2;

            enSwAcum   = 0;
            enBloque   = 7;
            eaCasilla  = "470";
            enImporte  = #0#29;
            enImporteA = 0;
            |HAZ GrabaLineal;

            enBloque  = 8;
            eaCasilla = "477";
            enImporte = #0#33;
            enImporteA = 0;
            |HAZ GrabaLineal;

            |LEE 101#0s;
     |SIGUE;
     |LIBERA #0;
     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaI;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |GRABA 020#1b;
     |FINSI;

     enBloque = 7; eaCasilla = "471"; |HAZ SacaImporte; #0#4  = enImporte;

     #0#3  = #1#29;
     |SI #0#3 > 0;
         |SI #0#4 > #0#3;
             #0#7  = (N\ #0#4 - #0#3);
             #0#4  = #0#3;
         |FINSI;
     |SINO;
         #0#7  = (N\ #0#4);
         #0#4  = 0;
     |FINSI;

     #0#5     = 0;
     enBloque = 1; eaCasilla = "020"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 2; eaCasilla = "035"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 3; eaCasilla = "079"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 4; eaCasilla = "090"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 5; eaCasilla = "140"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 5; eaCasilla = "170"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 5; eaCasilla = "199"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "220"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "221"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "222"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "245"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "255"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "265"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);
     enBloque = 6; eaCasilla = "275"; |HAZ SacaImporte; #0#5 = (N\ #0#5 + enImporte);

     |SI #0#6 > #0#5;  #0#6 = #0#5;  |FINSI;
     |SI #0#6 < 0;     #0#6 = 0;     |FINSI;

     #0#8 = #1#30;
     |SI #0#5 > 0;
         nSuma  = #0#7 + #0#8;
         nValor = #0#5 % 10;
         |SI nSuma > nValor;
             nResta = nValor;
             |SI #0#7 ! 0;
                 |SI nResta ! 0;
                     |SI #0#7 ] nResta;
                         #0#7  = nResta;
                         nResta = 0;
                     |SINO;
                        nResta = nResta - #0#7;
                     |FINSI;
                  |SINO;
                     #0#7  = 0;
                  |FINSI;
             |FINSI;

             |SI #0#8 ! 0;
                 |SI nResta ! 0;
                     |SI #0#8 ] nResta;
                         #0#8 = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#8;
                     |FINSI;
                 |SINO;
                     #0#8 = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         nSuma  = #0#6 + #0#7 + #0#8;
         |SI nSuma > #0#5;
             nResta = #0#5;
             |SI #0#8 ! 0;
                 |SI nResta ! 0;
                     |SI #0#8 ] nResta;
                         #0#8  = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#8;
                     |FINSI;
                 |SINO;
                     #0#8 = 0;
                 |FINSI;
             |FINSI;

             |SI #0#7 ! 0;
                 |SI nResta ! 0;
                     |SI #0#7 ] nResta;
                         #0#7  = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#7;
                     |FINSI;
                 |SINO;
                     #0#7 = 0;
                 |FINSI;
             |FINSI;

             |SI #0#6 ! 0;
                 |SI nResta ! 0;
                     |SI #0#6 ] nResta;
                         #0#6  = nResta;
                         nResta = 0;
                     |SINO;
                         nResta = nResta - #0#6;
                     |FINSI;
                 |SINO;
                     #0#6 = 0;
                 |FINSI;
             |FINSI;
         |FINSI;

         #0#9 = #1#30 - #0#8;
     |SINO;
         #0#6 = 0;
         #0#7 = 0;
         #0#8 = 0;
         #0#9 = 0;
     |FINSI;

     #0#10  = (N\ #0#3 - #0#4 + #0#5 - #0#6 - #0#7 - #0#8);

     #0#11  = #1#33;
     #0#12  = 0;
     enBloque = 8; eaCasilla = "478"; |HAZ SacaImporte; #0#13 = enImporte;

     nSuma  = #0#12 + #0#13;
     |SI nSuma > #0#11;
         nResta = #0#11;
         |SI #0#13 ! 0;
             |SI nResta ! 0;
                 |SI #0#13 ] nResta;
                     #0#13  = nResta;
                     nResta = 0;
                 |SINO;
                     nResta = nResta - #0#13;
                 |FINSI;
             |SINO;
                 #0#13 = 0;
             |FINSI;
         |FINSI;

         |SI #0#12 ! 0;
             |SI nResta ! 0;
                 |SI #0#12 ] nResta;
                     #0#12  = nResta;
                     nResta = 0;
                 |SINO;
                     nResta = nResta - #0#12;
                 |FINSI;
             |SINO;
                 #0#12 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     #0#14  = (N\ #0#11 - #0#12 - #0#13);

     enSwAcum  = 0;
     enBloque  = 7;
     eaCasilla = "470";  enImporte = #0#3;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "472";  enImporte = #0#5;   enImporteA = 0;  |HAZ GrabaLineal;

     |SI nPasada = 1;
         eaCasilla = "471";  enImporte = #0#4;  enImporteA = 0; |HAZ GrabaLineal;
     |FINSI;

     eaCasilla = "473";  enImporte = #0#7;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "474";  enImporte = #0#8;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "476";  enImporte = #0#10;  enImporteA = 0;  |HAZ GrabaLineal;

     enBloque  = 8;
     eaCasilla = "477";  enImporte = #0#11;  enImporteA = 0;  |HAZ GrabaLineal;

     |SI nPasada = 1;
         eaCasilla = "478";  enImporte = #0#13;  enImporteA = 0; |HAZ GrabaLineal;
     |FINSI;

     eaCasilla = "479";  enImporte = #0#14;  enImporteA = 0;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;

     |CIERRA #0;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Familiar1;
     |ABRE #1;
     |DDEFECTO #1;
     #1#0 = #1001#0;
     #1#1 = 1;
     |LEE 040#1];
     |PARA; |SI FSalida = 0;  |Y #1#0 = #1001#0;  |HACIENDO;
            nImputT = 0;
            nImputC = 0;
            nCompar = #1#11 / 100;

            |SI nConta = 1;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;                   |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;                   |FINSI;
                |SI #1#7 = "3";  nImput = 0.5;  nImputT = 0.5;                 |FINSI;
                |SI #1#7 = "4";  nImput = 0;    nImputC = 0.5;                 |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 2;
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;                   |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;                   |FINSI;
                |SI #1#7 = "3";  nImput = 0;    nImputT = 0.5;                 |FINSI;
                |SI #1#7 = "4";  nImput = 0.5;  nImputC = 0.5;                 |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 8;  |Y eaMuerto = "C";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 1;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 0;    nImputC = 1;    |FINSI;
                |SI #1#7 = "3";  nImput = 0.5;  nImputT = 0.5;  |FINSI;
                |SI #1#7 = "4";  nImput = 0;    nImputC = 0.5;  |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "2";  nImput = 0;        nImputC = nCompar; |FINSI;
                    |SI #1#7 = "1";  nImput = nCompar;  nImputT = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 8;  |Y eaMuerto = "T";
                |SI #1#7 = " ";  nImput = 0.5;  nImputT = 0.5;  nImputC = 0.5; |FINSI;
                |SI #1#7 = "1";  nImput = 0;    nImputT = 1;    |FINSI;
                |SI #1#7 = "2";  nImput = 1;    nImputC = 1;    |FINSI;
                |SI #1#7 = "3";  nImput = 0;    nImputT = 0.5;  |FINSI;
                |SI #1#7 = "4";  nImput = 0.5;  nImputC = 0.5;  |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    |SI #1#7 = " ";
                        nImput  = nCompar / 2;
                        nImputT = nCompar / 2;
                        nImputC = nCompar / 2;
                    |FINSI;
                    |SI #1#7 = "1";  nImput = 0;        nImputT = nCompar; |FINSI;
                    |SI #1#7 = "2";  nImput = nCompar;  nImputC = nCompar; |FINSI;
                |FINSI;
            |FINSI;

            |SI nConta = 7;
                nImput = 1;

                |SI #1#7 = "3";  |O #1#7 = "4";
                    nImput = 1;
                |FINSI;

                |SI #1#15 = "S";  |Y #1#4 = "ASCENDIENTE ";
                    nImput = nCompar;
                |FINSI;
            |FINSI;

            |SI #1#13 = "S";  |Y  #1#4 = "DESCENDIENTE";
                nFamiliar = nFamiliar + 1;
            |FINSI;

            |SI #1#13 = "S";  |Y  #1#4 = "DESCENDIENTE";  |Y #1#11 ! -1;
             |Y nFamiliar [ 4;
                 |SI #1#5 > 0;
                     |ABRE #3;
                     #3#0 = #0#0;
                     #3#1 = #0#1;
                     |SI nFamiliar = 1;   #3#2 = "1 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 2;   #3#2 = "2 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 3;   #3#2 = "3 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 4;   #3#2 = "4 FAMILIAR";  |FINSI;
                     |LEE 000#3=;
                     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
                     |CIERRA #3;

                     |ABRE #4;
                     #4#0 = #0#0;
                     #4#1 = #0#1;
                     |SI nFamiliar = 1;   #4#2 = "1 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 2;   #4#2 = "2 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 3;   #4#2 = "3 FAMILIAR";  |FINSI;
                     |SI nFamiliar = 4;   #4#2 = "4 FAMILIAR";  |FINSI;
                     |LEE 000#4=;
                     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
                     |CIERRA #4;

                     enBloque = 3;  eaCasilla = "079"; |HAZ SacaImporte;

                     nValor  = #3#15    + #3#16 + #3#19 + #3#7 + #3#8;
                     nValor  = nValor   + #3#11 + #3#13 + #0#74;
                     nValor  = nValor   + #4#27 - #4#28 + #4#31 - #4#32;
                     nValor  = nValor   + enImporte;

                     nEdad   = 2005 - #1#5;
                     |SI nEdad < 25;  |Y nValor > 8000;
                         |SI nEdad [ 17;  |O #1#8 = "2";
                             nSwConjunta = 1;

                             |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                 nSwConjuntaE = 1;
                             |FINSI;

                             |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                 nSwConjuntaE = 1;
                             |FINSI;
                         |FINSI;
                         #1#4 = "";
                     |SINO;
                         |SI #1#6 ] 33;  |Y nValor > 8000;
                             nSwConjunta  = 1;

                             |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                 nSwConjuntaE = 1;
                             |FINSI;

                             |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                 nSwConjuntaE = 1;
                             |FINSI;
                             #1#4 = "";
                         |FINSI;
                     |FINSI;
                 |FINSI;
            |FINSI;

            |SI #1#11 = -1;
                |SI #1#4 = "DESCENDIENTE";
                    |SI #1#5 > 0;
                        nEdad   = 2005 - #1#5;

                        |SI nEdad < 25;
                            |SI nEdad [ 17;  |O #1#8 = "2";
                                nSwConjunta = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |SINO;
                            |SI #1#6 ] 33;
                                nSwConjunta  = 1;

                                |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                    nSwConjuntaE = 1;
                                |FINSI;

                                |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                    nSwConjuntaE = 1;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;

                #1#4 = "";
            |FINSI;

            |SI #1#4 = "DESCENDIENTE";
                |SI #1#5 > 0;
                    nEdad     = 2005 - #1#5;
                    |SI nEdad = 25;  |Y eaMuerto ! "";
                        |SI eaMuerto = "T";  |Y nConta = 1;
                            nEdad    = (((#2#92 - #1#17) / 365) - 0.49) ! 0;
                        |FINSI;

                        |SI eaMuerto = "C";  |Y nConta = 2;
                            nEdad    = (((#2#92 - #1#17) / 365) - 0.49) ! 0;
                        |FINSI;
                    |FINSI;

                    nEdadAdop = 0;
                    |SI #1#18 ! "01.01.0000";
                        aAlfa     = #1#18 % -104;
                        nAnyo     = aAlfa;
                        nEdadAdop = 2005 - nAnyo;
                        |SI nEdadAdop > 3;  nEdadAdop = 0;  |FINSI;
                    |FINSI;

                    |SI nEdad < 25;
                        |SI nEdad [ 17;  |O #1#8 = "2";
                            nSwConjunta = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;
                        |FINSI;

                        |SI nImput ! 0;
                            |SI #1#21 ] "01.01.2005";
                                nTotalHF = nTotalHF + nImput;
                            |SINO;
                                nTHijos  = nTHijos  + 1;
                                |SI nTHijos = 1;  nTotalH1 = nTotalH1 + nImput;  |FINSI;
                                |SI nTHijos = 2;  nTotalH2 = nTotalH2 + nImput;  |FINSI;
                                |SI nTHijos = 3;  nTotalH3 = nTotalH3 + nImput;  |FINSI;
                                |SI nTHijos ] 4;  nTotalH4 = nTotalH4 + nImput;  |FINSI;
                            |FINSI;
                        |FINSI;
                    |SINO;
                        |SI #1#6 ] 33;
                            nSwConjunta  = 1;

                            |SI eaMuerto = "T";  |Y #1#7 ! "1";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI eaMuerto = "C";  |Y #1#7 ! "2";
                                nSwConjuntaE = 1;
                            |FINSI;

                            |SI nImput ! 0;
                                |SI #1#21 ] "01.01.2005";
                                    nTotalHF = nTotalHF + nImput;
                                |SINO;
                                    nTHijos  = nTHijos  + 1;
                                    |SI nTHijos = 1;  nTotalH1 = nTotalH1 + nImput;  |FINSI;
                                    |SI nTHijos = 2;  nTotalH2 = nTotalH2 + nImput;  |FINSI;
                                    |SI nTHijos = 3;  nTotalH3 = nTotalH3 + nImput;  |FINSI;
                                    |SI nTHijos ] 4;  nTotalH4 = nTotalH4 + nImput;  |FINSI;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI #1#6 ] 65;
                        nHijosM65 = nHijosM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            nHijosM33 = nHijosM33 + nImput;
                            |SI #1#14 = "S";
                                nHijosM33D = nHijosM33D + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI nEdad < 3;
                        nHijos3 = nHijos3  + nImput;
                    |SINO;
                        |SI nEdadAdop > 0;  |Y nEdadAdop < 3;
                            nHijos3 = nHijos3  + nImput;
                        |SINO;
                            |SI nEdad < 16;
                                nHijos16 = nHijos16 + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |SI #1#4 = "ASCENDIENTE ";
                |SI #1#5 > 0;
                    nEdad   = 2005 - #1#5;

                    |SI nEdad ] 65;
                        nTAscen   = nTAscen   + nImput;
                    |SINO;
                        |SI #1#6 ] 65;
                            nAscenEM65 = nAscenEM65 + nImput;
                        |SINO;
                            |SI #1#6 ] 33;
                                nAscenEM33 = nAscenEM33 + nImput;
                                |SI #1#14 = "S";
                                    nAscenEM33D = nAscenEM33D + nImput;
                                |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI nEdad ] 75;
                        |SI #1#13 = "N";
                            nTAscen75 = nTAscen75 + nImput;
                        |SINO;
                            |ABRE #999;
                            |SELECT #3#999;
                            #999#2 = #1#3;
                            |LEE 040#999=;
                            |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
                            |CIERRA #999;

                            |SI #999#1 = "1 FAMILIAR";
                                |SI nRentas3 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "2 FAMILIAR";
                                |SI nRentas4 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "3 FAMILIAR";
                                |SI nRentas5 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;

                            |SI #999#1 = "4 FAMILIAR";
                                |SI nRentas6 < 8000;  nTAscen75 = nTAscen75 + nImput;  |FINSI;
                            |FINSI;
                        |FINSI;
                    |FINSI;

                    |SI #1#6 ] 65;
                        nAscenM65 = nAscenM65 + nImput;
                    |SINO;
                        |SI #1#6 ] 33;
                            nAscenM33 = nAscenM33 + nImput;
                            |SI #1#14 = "S";
                                nAscenM33D = nAscenM33D + nImput;
                            |FINSI;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |LEE 040#1s;
     |SIGUE;
     |CIERRA #1;
|FPRC;

|PROCESO CalculaH;
     nEdadAdop  = 0;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM65  = 0;
     nHijosM33D = 0;
     nTAscen    = 0;
     nTAscen75  = 0;
     nAscenM33  = 0;
     nAscenEM33 = 0;
     nAscenM33D = 0;
     nAscenEM33D= 0;
     nAscenM65  = 0;
     nAscenEM65 = 0;
     nTotalH1   = 0;
     nTotalH2   = 0;
     nTotalH3   = 0;
     nTotalH4   = 0;
     nTotalHF   = 0;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem00101.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1033"#;  |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |ABRE #2;
     #2#0 = #1001#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |SI #999#6 > 0;  |Y nConta < 7;
         #0#15 = #401#9;

         |SI nConta = 1;  |O nConta = 2;
             nMinFam = nMinFam + #0#15;

             |SI nConta = 1;  |Y eaMuerto = "C";
                 nMinFamE = nMinFamE + #0#15;
             |FINSI;

             |SI nConta = 2;  |Y eaMuerto = "T";
                 nMinFamE = nMinFamE + #0#15;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 7;  #0#15 = nMinFam;   |FINSI;
     |SI nConta = 8;  #0#15 = nMinFamE;  |FINSI;

     |SI nConta = 1;  |O nConta = 2;  |O nConta = 7;  |O nConta = 8;
         nFamiliar = 0;
         |HAZ Familiar1;
     |FINSI;

     |SI nConta = 1;
         |ABRE #999;
         |SELECT #2#999;
         #999#1 = "CONYUGE   ";
         |LEE 040#999=;
         |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
         |CIERRA #999;

         nConvi = 0;
         |SI #2#95 = "S";  nConvi = 1;  |FINSI;

         |SI #999#6  = 0; |Y nConvi = 0;  |Y nSwConjunta = 1;
             nMinFam = nMinFam + #401#10;
         |FINSI;
     |FINSI;

     nCodAutonomico = #2#11;
     |SI nConta = 2;         nCodAutonomico = #2#43;  |FINSI;
     |SI nCodAutonomico = 0; nCodAutonomico = #2#11;  |FINSI;

     #0#16 = (N\ #401#11 * nTotalH1) +  (N\ #401#12 * nTotalH2);
     #0#16 = (N\ #0#16) + (N\ #401#13 * nTotalH3) + (N\ #401#14 * nTotalH4);
     #0#16 = (N\ #0#16) + (N\ #401#11 * nTotalHF);

     #0#17 = (N\ #0#15 + #0#16);

     #0#18 = #0#10;
     #0#19 = #0#17;
     |SI #0#19 > #0#18;  #0#19 = #0#18;  |FINSI;
     |SI #0#19 < 0;      #0#19 = 0;      |FINSI;
     #0#20 = (N\ #0#18 - #0#19);

     #0#21 = #0#14;
     #0#22 = (N\ #0#17 - #0#19);
     |SI #0#22 > #0#21;  #0#22 = #0#21;  |FINSI;
     |SI #0#22 < 0;      #0#22 = 0;      |FINSI;
     #0#23 = (N\ #0#21 - #0#22);

     enSwAcum  = 0;
     enBloque  = 9;
     eaCasilla = "482";  enImporte = #0#17;   enImporteA = 0;  |HAZ GrabaLineal;

     enBloque  = 10;
     eaCasilla = "476";  enImporte = #0#18;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "483";  enImporte = #0#19;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "484";  enImporte = #0#20;   enImporteA = 0;  |HAZ GrabaLineal;

     enBloque  = 11;
     eaCasilla = "479";  enImporte = #0#21;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "486";  enImporte = #0#22;   enImporteA = 0;  |HAZ GrabaLineal;
     eaCasilla = "487";  enImporte = #0#23;   enImporteA = 0;  |HAZ GrabaLineal;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #datfic4@;
     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaH2;
     nEdadAdop  = 0;
     nTHijos    = 0;
     nHijos3    = 0;
     nHijos16   = 0;
     nHijosM33  = 0;
     nHijosM33D = 0;
     nHijosM65  = 0;
     nTAscen    = 0;
     nTAscen75  = 0;
     nAscenM33  = 0;
     nAscenM33D = 0;
     nAscenM65  = 0;
     nAscenEM33 = 0;
     nAscenEM33D= 0;
     nAscenEM65 = 0;
     nTotalH1   = 0;
     nTotalH2   = 0;
     nTotalH3   = 0;
     nTotalH4   = 0;
     nImporte1  = 0;
     nImporte2  = 0;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem00101.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1033"#;  |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |SI nConta = 1;  |O nConta = 2;  |O nConta = 7;  |O nConta = 8;
         nFamiliar = 0;
         |HAZ Familiar1;
     |FINSI;

     #0#27 = (N\ (nHijos3 * #401#15));

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     |SI #999#6 > 0;  |Y nConta < 7;
         nEdad = 2005 - #999#6;
         |SI #999#5 = "S";
             |SI eaMuerto = "T";  fFechaNac = #2#103;  |FINSI;
             |SI eaMuerto = "C";  fFechaNac = #2#104;  |FINSI;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1 % 0704); nAnyo1 = aAlfa1;
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0704); nAnyo2 = aAlfa2;
             nEdad  = nAnyo1 - nAnyo2;

             aAlfa1 = efFechaMuerto; |QBF aAlfa1;
             aAlfa1 = (aAlfa1  % 0402) + (aAlfa1 % 0102);
             aAlfa2 = fFechaNac;     |QBF aAlfa2;
             aAlfa2 = (aAlfa2 % 0402) + (aAlfa2 % 0102);
             |SI aAlfa1 < aAlfa2; nEdad = nEdad - 1; |FINSI;
         |FINSI;

         |SI nEdad   ] 65;
             #0#28   = #401#16;
         |FINSI;

         #0#28   = (N\ #0#28 + (nTAscen * #401#16) + (nAscenEM65 * #401#16));
         #0#28   = (N\ #0#28 + (nAscenEM33 * #401#16));
         nCas929 = nCas929 + #0#28;

         |SI nEdad   ] 75;
             #0#29 = #401#17;

             nCas930 = nCas930 + #401#17;
         |FINSI;

         |SI nTAscen75 > 0;
             #0#29   = nTAscen75 * #401#17;

             nCas930 = nCas930 + (nTAscen75 * #401#17);
         |FINSI;

         nImporte1 = 0;
         nImporte2 = 0;
         |SI #999#3  ] 33;  nImporte1 = #401#18;   |FINSI;
         |SI #999#3  ] 65;  nImporte1 = #401#19;   |FINSI;

         nRdtosTrab = 0;

         |SI nConta = 1;
             nRdtosTrab = nRdtosTrab1;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab1 ! 0;  |Y nActivo1 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab1 ! 0;  |Y nActivo1 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2; nCas933 = nImporte2;  |FINSI;
         |FINSI;

         |SI nConta = 2;
             nRdtosTrab = nRdtosTrab2;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab2 ! 0;  |Y nActivo2 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab2 ! 0;  |Y nActivo2 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2;  nCas933 = nImporte2;  |FINSI;
         |FINSI;

         |SI nConta = 3;
             nRdtosTrab = nRdtosTrab3;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab3 ! 0;  |Y nActivo3 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab3 ! 0;  |Y nActivo3 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2;  nCas933 = nImporte2;  |FINSI;
         |FINSI;

         |SI nConta = 4;
             nRdtosTrab = nRdtosTrab4;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab4 ! 0;  |Y nActivo4 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab4 ! 0;  |Y nActivo4 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2;  nCas933 = nImporte2;  |FINSI;
         |FINSI;

         |SI nConta = 5;
             nRdtosTrab = nRdtosTrab5;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab5 ! 0;  |Y nActivo5 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab5 ! 0;  |Y nActivo5 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2;  nCas933 = nImporte2;  |FINSI;
         |FINSI;

         |SI nConta = 6;
             nRdtosTrab = nRdtosTrab6;

             |SI #999#3 ] 33;  |Y #999#3 < 65;
              |Y nRdtosTrab6 ! 0;  |Y nActivo6 ! 0;
                 |SI #999#4 = "N";
                     nImporte2 = nImporte2 + #401#20;
                 |SINO;
                     nImporte2 = nImporte2 + #401#21;
                 |FINSI;
             |FINSI;

             |SI #999#3 ] 65; |Y nRdtosTrab6 ! 0;  |Y nActivo6 ! 0;
                 nImporte2 = nImporte2 + #401#21;
             |FINSI;

             |SI nCas933 < nImporte2;  nCas933 = nImporte2;  |FINSI;
         |FINSI;

         #0#30      = nImporte1;

         |SI nConta = 1;  |O nConta = 2;
             nCas931    = nCas931 + nImporte1;
             |SI eaMuerto = "T";  |Y nConta ! 1;
                 nCas931M = nCas931M + nImporte1;
             |FINSI;

             |SI eaMuerto = "C";  |Y nConta ! 2;
                 nCas931M = nCas931M + nImporte1;
             |FINSI;
         |FINSI;

         #0#32      = nImporte2;

         enImporte  = (nHijosM33 * #401#18) + (nHijosM65 * #401#19);
         enImporte  = enImporte + (nAscenM33 * #401#18) + (nAscenM65 * #401#19);
         #0#31      = enImporte;
         nCas932    = nCas932 + enImporte;

         enImporte   = 0;
         |SI #999#3  ] 33; |Y #999#4 = "S";   enImporte = #401#22;   |FINSI;
         |SI #999#3  ] 65;                    enImporte = #401#22;   |FINSI;

         #0#33      = enImporte;
         nCas934    = nCas934 + enImporte;

         |SI eaMuerto = "T";  |Y nConta ! 1;
             nCas934M = nCas934M + enImporte;
         |FINSI;

         |SI eaMuerto = "C";  |Y nConta ! 2;
             nCas934M = nCas934M + enImporte;
         |FINSI;

         enImporte  = (nHijosM33D * #401#22) + (nHijosM65 * #401#22);
         enImporte  = enImporte + (nAscenM33D * #401#22) + (nAscenM65 * #401#22);
         #0#33      = (N\ #0#33 + enImporte);
         nCas934    = nCas934  + enImporte;
         nCas934M   = nCas934M + enImporte;
     |FINSI;

     |SI nConta > 6;
         nRdtosTrab = nRdtosTrab7;
     |FINSI;

     |SI nConta = 7;
         #0#28 = nCas929;
         #0#29 = nCas930;
         #0#30 = nCas931;
         #0#31 = nCas932;
         #0#32 = nCas933;
         #0#33 = nCas934;
     |FINSI;

     |SI nConta = 8;
         #0#28 = nCas929;
         #0#29 = nCas930;
         #0#30 = nCas931M;
         #0#31 = nCas932;
         #0#32 = nCas933;
         #0#33 = nCas934M;
     |FINSI;

     nImporte = #0#24 + #0#25 + #0#26 + #0#32;
     |SI nRdtosTrab < nImporte;  nImporte = nRdtosTrab;  |FINSI;
     |SI nImporte [ 0;           nImporte = 0;           |FINSI;

     nVal925 = #0#24;
     nVal926 = #0#25;
     nVal927 = #0#26;
     nVal933 = #0#32;

     |SI nImporte > 0;
         |SI nVal925 ! 0;
             |SI nVal925 ] nImporte;
                 nVal925 = nImporte;
                 nImporte    = 0;
             |SINO;
                 nImporte = nImporte - nVal925;
             |FINSI;
         |SINO;
             nVal925 = 0;
         |FINSI;

         |SI nImporte > 0;
             |SI nVal926 ! 0;
                 |SI nVal926 ] nImporte;
                     nVal926 = nImporte;
                     nImporte    = 0;
                 |SINO;
                     nImporte = nImporte - nVal926;
                 |FINSI;
             |FINSI;
         |SINO;
             nVal926 = 0;
         |FINSI;

         |SI nImporte > 0;
             |SI nVal927 ! 0;
                 |SI nVal927 ] nImporte;
                     nVal927 = nImporte;
                     nImporte = 0;
                 |SINO;
                     nImporte = nImporte - nVal927;
                 |FINSI;
             |FINSI;
         |SINO;
             nVal927 = 0;
         |FINSI;

         |SI nImporte > 0;
             |SI nVal933 ! 0;
                 |SI nVal933 ] nImporte;
                     nVal933 = nImporte;
                 |FINSI;
             |FINSI;
         |SINO;
             nVal933 = 0;
         |FINSI;
      |SINO;
         nVal925 = 0;
         nVal926 = 0;
         nVal927 = 0;
         nVal933 = 0;
     |FINSI;

     #0#24 = (N\ nVal925);
     #0#25 = (N\ nVal926);
     #0#26 = (N\ nVal927);
     #0#32 = (N\ nVal933);

     #0#34 = (N\ #0#24 + #0#25 + #0#26 + #0#27 + #0#28 + #0#29 + #0#30);
     #0#34 = (N\ #0#34 + #0#31 + #0#32 + #0#33);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     |DESCARGA_DEF #datfic4@;
     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO LimitePlan;
     |ABRE #405;
     |LEE 040#405p;
     |SI FSalida ! 0;  |DDEFECTO #405;  |FINSI;
     |CIERRA #405;

     |SI nEdad [ 52;  nLimite = #405#1;   |FINSI;
     |SI nEdad = 53;  nLimite = #405#2;   |FINSI;
     |SI nEdad = 54;  nLimite = #405#3;   |FINSI;
     |SI nEdad = 55;  nLimite = #405#4;   |FINSI;
     |SI nEdad = 56;  nLimite = #405#5;   |FINSI;
     |SI nEdad = 57;  nLimite = #405#6;   |FINSI;
     |SI nEdad = 58;  nLimite = #405#7;   |FINSI;
     |SI nEdad = 59;  nLimite = #405#8;   |FINSI;
     |SI nEdad = 60;  nLimite = #405#9;   |FINSI;
     |SI nEdad = 61;  nLimite = #405#10;  |FINSI;
     |SI nEdad = 62;  nLimite = #405#11;  |FINSI;
     |SI nEdad = 63;  nLimite = #405#12;  |FINSI;
     |SI nEdad = 64;  nLimite = #405#13;  |FINSI;
     |SI nEdad ] 65;  nLimite = #405#14;  |FINSI;
|FPRC;

|PROCESO SacaTope;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01026.mas";
     |CARGA_DEF aDef, datfic5@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic5@#"zdat1026"#;  |FINSI;

     |ABRE #4;
     #4#0 = #1001#0;
     #4#1 = #1001#1;
     #4#2 = #1001#2;
     |LEE 040#4=;
     |SI FSalida ! 0;  |DDEFECTO #4;  |FINSI;
     |CIERRA #4;

     |ABRE #5;
     #5#0 = #1001#0;
     #5#1 = #1001#1;
     #5#2 = #1001#2;
     |LEE 040#5=;
     |SI FSalida ! 0;  |DDEFECTO #5;  |FINSI;
     |CIERRA #4;

     nValor = #4#15  + #2#7  + #2#8  + #2#11  + #2#13 + #5#12;
     |SI nValor [ 0;  nValor = 0;  |FINSI;

     |DESCARGA_DEF #datfic5@;
     |DESCARGA_DEF #datfic4@;
|FPRC;

|PROCESO CalculaPlan;
     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nEdad = 2005 - #999#6;
     |HAZ LimitePlan;

     |SI nSwPasar = 1;
         |SI #1#6  > nLimite;       #1#6  = nLimite;      |FINSI;
         |SI #1#10 > nLimite;       #1#10 = nLimite;      |FINSI;
     |FINSI;

     #1#7  = #1#5 + #1#6;
     #1#11 = #1#9 + #1#10;
     |SI #1#7  > nLimite;  #1#7  = nLimite;  |FINSI;
     |SI #1#11 > nLimite;  #1#11 = nLimite;  |FINSI;

     #1#8  = (N\ ((#1#5 + #1#6)  - nLimite));
     #1#12 = (N\ ((#1#9 + #1#10) - nLimite));
     |SI #1#8  < 0;  #1#8  = 0;  |FINSI;
     |SI #1#12 < 0;  #1#12 = 0;  |FINSI;
|FPRC;

|PROCESO CalculaPension;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef + " " + FSalida;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1037"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1033"#;  |FINSI;

     |ABRE #0;
     |ABRE #1;
     |ABRE #2;
     |ABRE #3;

     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     |SI nConta = 1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

         |SI #1#17 ! "N";  |Y aCalcP = "";
             aCalcP = #1#17;  |QBF aCalcP;
             nCalcP = #1#18;
         |FINSI;

         |HAZ CalculaPlan;

         |GRABA 020#1a;
         |LIBERA #1;

         n941T = #1#5;         || Variables para Conjunta
         n943T = #1#6;
         n945T = #1#7;
         n947T = #1#8;

         n942T = #1#9;
         n944T = #1#10;
         n946T = #1#11;
         n948T = #1#12;

         #0#35 = (N\ #1#7  + #1#11);
         #0#37 = (N\ #1#14 + #1#15 + #1#19);

         nRdtoTit16 = #1#5 + #1#9 + #1#6 + #1#10;
         nRdtoTit17 = #1#8 + #1#12;
         nRdtoTitX  = #1#7 + #1#8 + #1#11 + #1#12;

         enBloque = 3;  eaCasilla = "079"; |HAZ SacaImporte;

         nRdtoTit   = #2#15    + #2#16 + #2#19 + #2#7 + #2#8;
         nRdtoTit   = nRdtoTit + #2#11 + #2#13 + #0#74;
         nRdtoTit   = nRdtoTit + #3#27 - #3#28 + #3#31 - #3#32;
         nRdtoTit   = nRdtoTit + enImporte;

         |HAZ SacaTope;
         nValorTit  = nValor;
         |SI nValorTit > #401#23;  nValorTit = #401#23;  |FINSI;
         |SI #0#45 > nValorTit;
             #0#45 = nValorTit;
         |FINSI;
         nValorTit20 = #0#45;
     |FINSI;

     |SI nConta = 2;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |GRABA 020#1b;
         |FINSI;

         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 000#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;

         |SI #1#17 ! "N";  |Y aCalcP = "";
             aCalcP = #1#17;  |QBF aCalcP;
             nCalcP = #1#18;
         |FINSI;

         |HAZ CalculaPlan;

         |GRABA 020#1a;
         |LIBERA #1;

         n941C = #1#5;
         n943C = #1#6;
         n945C = #1#7;
         n947C = #1#8;

         n942C = #1#9;
         n944C = #1#10;
         n946C = #1#11;
         n948C = #1#12;

         #0#35 = (N\ #1#7  + #1#11);
         #0#37 = (N\ #1#14 + #1#15 + #1#19);

         nRdtoCon16 = #1#5 + #1#9 + #1#6 + #1#10;
         nRdtoCon17 = #1#8 + #1#12;
         nRdtoConX  = #1#7 + #1#8 + #1#11 + #1#12;

         enBloque   = 3;  eaCasilla = "079"; |HAZ SacaImporte;

         nRdtoCon   = #2#15    + #2#16 + #2#19 + #2#7 + #2#8;
         nRdtoCon   = nRdtoCon + #2#11 + #2#13 + #0#74;
         nRdtoCon   = nRdtoCon + #3#27 - #3#28 + #3#31 - #3#32;
         nRdtoCon   = nRdtoCon + enImporte;

         |HAZ SacaTope;
         nValorCon  = nValor;
         |SI nValorCon > #401#23;  nValorCon = #401#23;  |FINSI;
         |SI #0#45 > nValorCon;
              #0#45 = nValorCon;
         |FINSI;
         nValorCon20 = #0#45;
     |FINSI;

     |SI nConta = 7;
         #0#45  = (N\ nValorTit20 + nValorCon20);

         |SI nSwPasar = 0;
             nNorma1  = 0;
             nNorma2  = 0;
             nNorma3  = 0;
             nNorma4  = 0;
             nMinus1  = 0;
             nMinus2  = 0;

             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |LEE 101#1=;
             |SI FSalida = 0;
                 #1#5  = n941T;
                 #1#6  = n943T;
                 #1#7  = n945T;
                 #1#8  = n947T;

                 #1#9  = n942T;
                 #1#10 = n944T;
                 #1#11 = n946T;
                 #1#12 = n948T;

                 nNorma1 = #1#7  + #1#11;
                 nNorma2 = #1#8  + #1#12;
                 nMinus1 = #1#14 + #1#15 + #1#19;

                 |GRABA 020#1a;
                 |LIBERA #1;
             |FINSI;

             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |LEE 101#1=;
             |SI FSalida = 0;
                 #1#5  = n941C;
                 #1#6  = n943C;
                 #1#7  = n945C;
                 #1#8  = n947C;

                 #1#9  = n942C;
                 #1#10 = n944C;
                 #1#11 = n946C;
                 #1#12 = n948C;

                 nNorma3 = #1#7  + #1#11;
                 nNorma4 = #1#8  + #1#12;
                 nMinus2 = #1#14 + #1#15 + #1#19;

                 |GRABA 020#1a;
                 |LIBERA #1;
             |FINSI;
         |SINO;
             nNorma1  = 0;
             nNorma2  = 0;
             nNorma3  = 0;
             nNorma4  = 0;
             nMinus1  = 0;
             nMinus2  = 0;

             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |LEE 040#1=;
             |SI FSalida = 0;
                 nNorma1  = #1#7  + #1#11;
                 nNorma2  = #1#8  + #1#12;
                 nMinus1  = #1#14 + #1#15 + #1#19;
             |FINSI;

             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |LEE 040#1=;
             |SI FSalida = 0;
                 nNorma3  = #1#7  + #1#11;
                 nNorma4  = #1#8  + #1#12;
                 nMinus2  = #1#14 + #1#15 + #1#19;
             |FINSI;
         |FINSI;

         #0#91  = nNorma1;
         #0#92  = nNorma3;
         #0#35  = (N\ nNorma1 + nNorma3);
         #0#37  = (N\ nMinus1 + nMinus2);
     |FINSI;

     |SI nConta = 8;
         |SI eaMuerto = "T";
             |SI nSwPasar = 0;
                 #0#45 = (N\ nValorCon20);

                 #1#0 = #1001#0;
                 #1#1 = #1001#1;
                 #1#2 = #1001#2;
                 #1#3 = 2;
                 |LEE 101#1=;
                 |SI FSalida = 0;
                     #1#5  = n941C;
                     #1#6  = n943C;
                     #1#7  = n945C;
                     #1#8  = n947C;

                     #1#9  = n942C;
                     #1#10 = n944C;
                     #1#11 = n946C;
                     #1#12 = n948C;

                     #0#35  = (N\ #1#7  + #1#11);
                     #0#37  = (N\ #1#14 + #1#15 + #1#19);

                     |GRABA 020#1a;
                     |LIBERA #1;
                  |FINSI;
             |SINO;
                 #1#0 = #1001#0;
                 #1#1 = #1001#1;
                 #1#2 = #1001#2;
                 #1#3 = 2;
                 |LEE 101#1=;
                 |SI FSalida = 0;
                     #0#35 = (N\ #1#7  + #1#11);
                     #0#37 = (N\ #1#14 + #1#15 + #1#19);
                 |FINSI;
             |FINSI;
         |SINO;
             |SI nSwPasar = 0;
                 #0#45 = (N\ nValorTit20);

                 #1#0 = #1001#0;
                 #1#1 = #1001#1;
                 #1#2 = #1001#2;
                 #1#3 = 1;
                 |LEE 101#1=;
                 |SI FSalida = 0;
                     #1#5  = n941T;
                     #1#6  = n943T;
                     #1#7  = n945T;
                     #1#8  = n947T;

                     #1#9  = n942T;
                     #1#10 = n944T;
                     #1#11 = n946T;
                     #1#12 = n948T;

                     #0#35  = (N\ #1#7  + #1#11);
                     #0#37  = (N\ #1#14 + #1#15 + #1#19);

                     |GRABA 020#1a;
                     |LIBERA #1;
                  |FINSI;
              |SINO;
                 #1#0 = #1001#0;
                 #1#1 = #1001#1;
                 #1#2 = #1001#2;
                 #1#3 = 1;
                 |LEE 040#1=;
                 |SI FSalida = 0;
                     #0#35  = (N\ #1#7  + #1#11);
                     #0#37  = (N\ #1#14 + #1#15 + #1#19);
                 |FINSI;
              |FINSI;
         |FINSI;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;

     |CIERRA #0;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;

     enSwAcum  = 0;
     enBloque  = 12;
     eaCasilla = "550";  enImporte = #0#35;   |HAZ GrabaLineal;
     eaCasilla = "580";  enImporte = #0#37;   |HAZ GrabaLineal;
     eaCasilla = "610";  enImporte = #0#45;   |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO CalculaPlanAdicio;
     |ABRE #999;
     |SELECT #2#999;
     #999#1 = aAlfa;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nEdad = 2005 - #999#6;
     |HAZ LimitePlan;

     |SI #3#6  > nLimite;  #3#6  = nLimite;  |FINSI;
     |SI #3#10 > nLimite;  #3#10 = nLimite;  |FINSI;

     #3#7  = #3#5 + #3#6;
     #3#11 = #3#9 + #3#10;
     |SI #3#7  > nLimite;  #3#7  = nLimite;  |FINSI;
     |SI #3#11 > nLimite;  #3#11 = nLimite;  |FINSI;

     #3#8  = (N\ ((#3#5 + #3#6)  - nLimite));
     #3#12 = (N\ ((#3#9 + #3#10) - nLimite));
     |SI #3#8  < 0;  #3#8  = 0;  |FINSI;
     |SI #3#12 < 0;  #3#12 = 0;  |FINSI;
|FPRC;

|PROCESO QuitaConyuge;
     |ABRE #999;
     |SELECT #2#999;
     #999#1 = aAlfa;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nEdad = 2005 - #999#6;
     |HAZ LimitePlan;

     |SI #3#6 > nLimite;
         nValor = #3#6 - nLimite;
         |SI nValor ] nResto;
             #3#6   = (N\ #3#6 - nResto);
             nResto = 0;
         |SINO;
             nResto = nResto - nValor;
             #3#6   = (N\ #3#6 - nValor);
         |FINSI;
     |FINSI;

     |SI nResto ] 0;
         |SI #3#10 > nLimite;
             nValor = #3#10 - nLimite;
             |SI nValor ] nResto;
                 #3#10  = (N\ #3#10 - nResto);
                 nResto = 0;
             |SINO;
                 nResto = nResto - nValor;
                 #3#10  = (N\ #3#10 - nValor);
             |FINSI;
         |FINSI;
     |FINSI;

     nNorma1 = #3#5  + #3#9;
     nNorma2 = #3#6  + #3#10;

     |SI nNorma1 > 0;  |Y nResto > 0;
         |SI #3#5 ] nResto;
             #3#5   = (N\ #3#5 - nResto);
             nResto = 0;
         |SINO;
             nResto = nResto - #3#5;
             #3#5   = 0;
         |FINSI;

         |SI nResto > 0;
             |SI #3#9 ] nResto;
                 #3#9 = (N\ #3#9 - nResto);
                 nResto = 0;
             |SINO;
                 nResto = nResto - #3#9;
                  #3#9 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nNorma2 > 0;  |Y nResto > 0;
         |SI #3#6 ] nResto;
             #3#6   = (N\ #3#6 - nResto);
             nResto = 0;
         |SINO;
             nResto = nResto - #3#6;
             #3#6   = 0;
         |FINSI;

         |SI nResto > 0;
             |SI #3#10 ] nResto;
                 #3#10 = (N\ #3#10 - nResto);
                 nResto = 0;
             |SINO;
                 nResto = nResto - #3#10;
                 #3#10 = 0;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PensionAdicio;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef + " " + FSalida;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1037"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;

     ||  nLimiteGral = #0#20 + #0#23 - #0#34 - #0#35;
     nLimiteGral = #0#20 + #0#23 - #0#34;

     |SI nConta = 1;
         nSuma        = nRdtoCon16;
         nPdte        = nSuma;
         |SI nSuma ! 0;  |Y nRdtoCon < #401#27;
             |SI aCalcP = "P";
                 #0#36 = nPdte;
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "R";
                 #0#36 = (N\ nRdtoCon17);
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "M";
                 #0#36 = (N\ nCalcP);
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;

                 |SI #0#36 ] nSuma;
                     #0#36 = (N\ nSuma);
                 |FINSI;
             |FINSI;

             |SI #0#36 > nLimiteGral;  #0#36 = nLimiteGral;  |FINSI;
             |SI #0#36 < 0;            #0#36 = 0;            |FINSI;

             nRdtoCon18 = #0#36;

             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = "TITULAR   ";
             |LEE 101#0=;
             |SI FSalida = 0;
                 #0#36 = nRdtoCon18;
                 |GRABA 020#0a;
                 |LIBERA #0;
             |FINSI;

             |ABRE #3;
             #3#0 = #1001#0;
             #3#1 = #1001#1;
             #3#2 = "CONYUGE   ";
             #3#3 = 2;
             |LEE 101#3=;
             |SI FSalida = 0;
                 nResto  = nRdtoCon18;
                 aAlfa   = #3#2;
                 |HAZ QuitaConyuge;

                 |GRABA 020#3a;
                 |LIBERA #3;
             |FINSI;
             |CIERRA #3;
         |FINSI;
     |FINSI;

     |SI nConta = 2;
         nSuma        = nRdtoTit16;
         nPdte        = nSuma;
         |SI nSuma ! 0;  |Y nRdtoTit < #401#27;
             |SI aCalcP = "P";
                 #0#36 = nPdte;
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "R";
                 #0#36 = (N\ nRdtoTit17);
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;
             |FINSI;

             |SI aCalcP = "M";
                 #0#36 = (N\ nCalcP);
                 |SI #0#36 ] #401#28;
                     #0#36 = (N\ #401#28);
                 |FINSI;
                 |SI #0#36 ] nSuma;
                     #0#36 = (N\ nSuma);
                 |FINSI;
             |FINSI;

             |SI #0#36 > nLimiteGral;  #0#36 = nLimiteGral;  |FINSI;
             |SI #0#36 < 0;            #0#36 = 0;            |FINSI;

             nRdtoTit18 = #0#36;

             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = "CONYUGE   ";
             |LEE 101#0=;
             |SI FSalida = 0;
                 #0#36 = nRdtoTit18;
                 |GRABA 020#0a;
                 |LIBERA #0;
             |FINSI;

             |ABRE #3;
             #3#0 = #1001#0;
             #3#1 = #1001#1;
             #3#2 = "TITULAR   ";
             #3#3 = 1;
             |LEE 101#3=;
             |SI FSalida = 0;
                 nResto  = nRdtoTit18;
                 aAlfa   = #3#2;
                 |HAZ QuitaConyuge;

                 |GRABA 020#3a;
                 |LIBERA #3;
             |FINSI;
             |CIERRA #3;
         |FINSI;
     |FINSI;

     |SI nConta = 7;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = #1001#2;
             |GRABA 020#0b;
         |FINSI;

         |SI nRdtoTit18 ! 0;
||             nLimiteGral = #0#20 + #0#23 - #0#34 - #0#92;
         |SINO;
||             nLimiteGral = #0#20 + #0#23 - #0#34 - #0#91;
         |FINSI;

         |SI nLimiteGral > 0;  |O aCalcP = "M";
             #0#36  = (N\ nRdtoTit18  + nRdtoCon18);
         |SINO;
             #0#36      = 0;
             nRdtoTit18 = 0;
             nRdtoCon18 = 0;
         |FINSI;

         nPdte = #0#36;
         |SI nPdte > nLimiteGral;  |Y aCalcP ! "M";
             #0#36 = nLimiteGral;
             |SI #0#36 < 0;  #0#36 = 0;  |FINSI;

             nResto  = #0#36;
             |SI nResto > 0;
                 |SI nRdtoTit18 > nResto;
                     nRdtoTit18 = nResto;
                     nRdtoCon18 = 0;
                     nResto     = 0;
                 |SINO;
                     nResto = nResto - nRdtoTit18;
                 |FINSI;

                 |SI nResto > 0;
                     |SI nRdtoCon18 > nResto;
                         nRdtoCon18 = nResto;
                     |FINSI;
                 |FINSI;
             |SINO;
                 nRdtoTit18 = 0;
                 nRdtoCon18 = 0;
             |FINSI;
         |FINSI;

         |GRABA 020#0a;
         |LIBERA #0;

         |ABRE #3;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoTit18;
             aAlfa   = "TITULAR";
             |HAZ QuitaConyuge;
             |HAZ CalculaPlanAdicio;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoCon18;
             aAlfa   = "CONYUGE";
             |HAZ QuitaConyuge;
             |HAZ CalculaPlanAdicio;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         |CIERRA #3;
     |FINSI;

     |SI nConta = 8;  |Y nLimiteGral > 0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 101#0=;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = #1001#0;
             #0#1 = #1001#1;
             #0#2 = #1001#2;
             |GRABA 020#0b;
         |FINSI;

         |SI nLimiteGral > 0;
             |SI eaMuerto = "T";
                 #0#36 = (N\ nRdtoCon18);
                 nRdtoTit18 = 0;
             |SINO;
                 #0#36 = (N\ nRdtoTit18);
                 nRdtoCon18 = 0;
             |FINSI;
         |SINO;
             #0#36      = 0;
             nRdtoTit18 = 0;
             nRdtoCon18 = 0;
         |FINSI;

         nPdte = #0#36;
         |SI nPdte > nLimiteGral;
             #0#36 = nLimiteGral;
             |SI #0#36 < 0;  #0#36 = 0;  |FINSI;

             nResto  = #0#36;
             |SI nResto > 0;
                 |SI nRdtoTit18 > nResto;
                     nRdtoTit18 = nResto;
                     nRdtoCon18 = 0;
                     nResto     = 0;
                 |SINO;
                     nResto = nResto - nRdtoTit18;
                 |FINSI;

                 |SI nResto > 0;
                     |SI nRdtoCon18 > nResto;
                         nRdtoCon18 = nResto;
                     |FINSI;
                 |FINSI;
             |SINO;
                 nRdtoTit18 = 0;
                 nRdtoCon18 = 0;
             |FINSI;
         |FINSI;

         |GRABA 020#0a;
         |LIBERA #0;

         |ABRE #3;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 1;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoTit18;
             aAlfa   = "TITULAR";
             |HAZ QuitaConyuge;
             |HAZ CalculaPlanAdicio;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         #3#0 = #1001#0;
         #3#1 = #1001#1;
         #3#2 = #1001#2;
         #3#3 = 2;
         |LEE 101#3=;
         |SI FSalida = 0;
             nResto  = nRdtoCon18;
             aAlfa   = "CONYUGE";
             |HAZ QuitaConyuge;
             |HAZ CalculaPlanAdicio;

             |GRABA 020#3a;
             |LIBERA #3;
         |FINSI;

         |CIERRA #3;
     |FINSI;

     |CIERRA #0;

     |DESCARGA_DEF #datfic0@;
     |DESCARGA_DEF #datfic3@;
|FPRC;

|PROCESO rem01035;
     |SI #2#4 = "TITULAR   ";  nAporta1 = nAporta1 + #2#6 + #2#7;  |FINSI;
     |SI #2#4 = "CONYUGE   ";  nAporta2 = nAporta2 + #2#6 + #2#7;  |FINSI;
|FPRC;

|DEFBUCLE rem01035;
     #2#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01035;
|FIN;

|PROCESO CalculaJ;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1037"#;  |FINSI;

     aDef    = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1035"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     #0#34 = (N\ #0#24 + #0#25 + #0#26 + #0#27 + #0#28 + #0#29 + #0#30);
     #0#34 = (N\ #0#34 + #0#31 + #0#32 + #0#33);

     enBloque   = 12;
     eaCasilla  = "500";  enImporte = #0#34;  |HAZ GrabaLineal;

     #0#46  = #0#20;
     #0#47  = 0;
     #0#77  = 0;
     #0#48  = 0;
     #0#49  = 0;
     #0#50  = 0;
     #0#51  = 0;
     #0#52  = 0;

     |SI #0#46 > 0;
         nResta = #0#46;

         |SI #0#34 ! 0;
             |SI #0#34 [ nResta;
                 #0#47  = #0#34;
                 nResta = nResta - #0#34;
             |SINO;
                 #0#47  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI #0#75 ! 0;
             |SI #0#75 [ nResta;
                 #0#77  = #0#75;
                 nResta = nResta - #0#75;
             |SINO;
                 #0#77  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI #0#35 ! 0;
             nLiquidar = #0#35;
             |SI nConta = 7;
                 nLiquidar  = 0;
                 nBaseT     = nBaseLiquiT - #0#91;
                 nBaseC     = nBaseLiquiC - #0#92;

                 |SI nBaseLiquiT < #0#91;
                      |SI nBaseT > 0;
                          nLiquidar  = nLiquidar + #0#91;
                          nLiquidarT = #0#91;
                      |SINO;
                          nParQueVieneT = #0#91 - nBaseLiquiT;
                          nLiquidar     = nLiquidar + nBaseLiquiT;
                          nLiquidarT    = nBaseLiquiT;
                      |FINSI;
                 |SINO;
                      nLiquidar  = nLiquidar + #0#91;
                      nLiquidarT = #0#91;
                 |FINSI;

                 |SI nBaseLiquiC < #0#92;
                     |SI nBaseC > #0#92;
                         nLiquidar  = nLiquidar + #0#92;
                         nLiquidarC = #0#92;
                     |SINO;
                         nParQueVieneC = #0#92 - nBaseLiquiC;
                         nLiquidar     = nLiquidar + nBaseLiquiC;
                          nLiquidarC   = nBaseLiquiC;
                     |FINSI;
                 |SINO;
                      nLiquidar  = nLiquidar + #0#92;
                      nLiquidarC = #0#92;
                 |FINSI;

                 |SI nLiquidar < 0;  nLiquidar = 0;  |FINSI;
             |FINSI;

             |SI nLiquidar [ nResta;
                 #0#48  = nLiquidar;
                 nResta = nResta - nLiquidar;
                 |SI #0#91 ! 0;  #0#91  = #0#91 - nLiquidarT;  |FINSI;
                 |SI #0#92 ! 0;  #0#92  = #0#92 - nLiquidarC;  |FINSI;
             |SINO;
                 #0#48  = nResta;

                 |SI #0#91 ! 0;
                     |SI #0#91 [ nResta;
                         #0#91 = 0;
                     |SINO;
                         #0#91  = #0#91 - nResta;
                         nResta = nResta - #0#91;
                     |FINSI;
                 |FINSI;

                 |SI #0#92 ! 0;
                     |SI #0#92 [ nResta;
                         #0#92 = 0;
                     |SINO;
                         #0#92  = #0#92 - nResta;
                     |FINSI;
                 |FINSI;

                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI #0#36 ! 0;
             |SI #0#36 [ nResta;
                 #0#49  = #0#36;
                 nResta = nResta - #0#36;
             |SINO;
                 #0#49  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI #0#37 ! 0;
             |SI #0#37 [ nResta;
                 #0#50  = #0#37;
                 nResta = nResta - #0#37;
             |SINO;
                 #0#50  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         |SI #0#44 ! 0;
             |SI #0#44 [ nResta;
                 #0#51  = #0#44;
                 nResta = nResta - #0#44;
             |SINO;
                 #0#51  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         #0#52 = #0#45;
     |FINSI;


     #0#53 = (N\ #0#46 - #0#47 - #0#77 - #0#48 - #0#49 - #0#50 - #0#51 - #0#52);

     |SI #0#53 > 0;
         nSuma  = #0#54 + #0#55;
         |SI nSuma > #0#53;
             nResta = #0#53;
             |SI #0#54 ! 0;
                 |SI #0#54 ] nResta;
                     #0#54  = nResta;
                     nResta = 0;
                 |SINO;
                     nResta = nResta - #0#54;
                 |FINSI;
             |FINSI;

             |SI nResta ! 0;
                 |SI #0#55 ! 0;
                     |SI #0#55 ] nResta;
                         #0#55 = nResta;
                         nResta = 0;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         #0#54 = 0;
         #0#55 = 0;
     |FINSI;

     #0#56 = (N\ #0#53 - #0#55 + #0#87);

     #0#57 = #0#23;
     #0#58  = 0;
     #0#78  = 0;
     #0#59  = 0;
     #0#60  = 0;
     #0#61  = 0;
     #0#62  = 0;

     |SI #0#57 > 0;
         nResta     = #0#57;
         nRemanente = #0#34 - #0#47;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#58  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#58  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = #0#75 - #0#77;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#78  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#78  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nLiquidar  = #0#35 - #0#48;
         nRemanente = #0#35 - #0#48;
         |SI nRemanente > 0;
             |SI nConta = 7;
                 nLiquidar  = 0;
                 nBaseT     = nBaseLiquiTE - #0#91;
                 nBaseC     = nBaseLiquiCE - #0#92;

                 |SI nBaseLiquiTE < #0#91;
                      |SI nBaseT > 0;
                          nLiquidar     = nLiquidar + #0#91;
                          nParQueVieneT = 0;
                      |SINO;
                          nParQueVieneT = #0#91 - nBaseLiquiTE;
                          nLiquidar     = nLiquidar + nBaseLiquiTE;
                      |FINSI;
                 |SINO;
                      nLiquidar = nLiquidar + #0#91;
                      nParQueVieneT = 0;
                 |FINSI;

                 |SI nBaseLiquiCE < #0#92;
                     |SI nBaseC > #0#92;
                         nLiquidar     = nLiquidar + #0#92;
                         nParQueVieneC = 0;
                     |SINO;
                         nParQueVieneC = #0#92     - nBaseLiquiCE;
                         nLiquidar     = nLiquidar + nBaseLiquiCE;
                     |FINSI;
                 |SINO;
                      nLiquidar     = nLiquidar + #0#92;
                      nParQueVieneC = 0;
                 |FINSI;

                 |SI nLiquidar < 0;  nLiquidar = 0;  |FINSI;
             |FINSI;

             |SI nLiquidar > nRemanente;
                 nLiquidar     = nRemanente;
                 nParQueVieneT = 0;
                 nParQueVieneC = 0;
             |FINSI;

             |SI nLiquidar [ nResta;
                 #0#59  = nLiquidar;
                 nResta = nResta - nLiquidar;
             |SINO;
                 #0#59  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = #0#36 - #0#49;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#60  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#60  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = #0#37 - #0#50;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#61  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#61  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;

         nRemanente = #0#44 - #0#51;
         |SI nRemanente > 0;
             |SI nRemanente [ nResta;
                 #0#62  = nRemanente;
                 nResta = nResta - nRemanente;
             |SINO;
                 #0#62  = nResta;
                 nResta = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     #0#63 = (N\ #0#57 - #0#58 - #0#78 - #0#59 - #0#60 - #0#61 - #0#62 + #0#88);

     nPendiente = (#0#75 - (#0#77 + #0#78)) + #0#89 + #0#90;
     |SI nPendiente > 0;
         |SI nConta ! 7;  |Y nConta ! 8;
             #0#79 = "TITULAR";
             #0#80 = nPendiente;
         |SINO;
             nPendiente = #0#75 - (#0#77 + #0#78);
             nAporta1   = 0;
             nAporta2   = 0;
             nAporta3   = 0;
             nAporta4   = 0;
             nAporta5   = 0;
             |BUCLE rem01035;

             nAporta4 = nAporta1;
             nAporta5 = nAporta2;

             nPorce1  = (nAporta4 / (nAporta4 + nAporta5));
             nPorce2  = (nAporta5 / (nAporta5 + nAporta4));

             |SI nPendiente ! 0;
                 |SI nAporta1 ! 0;  |Y nAporta2 ! 0;
                     #0#79    = "TITULAR";
                     #0#80    = (N\ (nPendiente * nPorce1));

                     #0#81    = "CONYUGE";
                     #0#82    = (N\ (nPendiente - #0#80));

                     #0#80    = (N\ #0#80 + #0#89);
                     #0#82    = (N\ #0#82 + #0#90);
                 |SINO;
                     |SI nAporta1 ! 0;
                         #0#79    = "TITULAR";
                         #0#80    = (N\ (nPendiente + #0#89));
                     |SINO;
                         #0#79    = "CONYUGE";
                         #0#80    = (N\ (nPendiente + #0#90));
                     |FINSI;
                 |FINSI;
             |SINO;
                 |SI #0#89 ! 0;  |Y #0#90 ! 0;
                     #0#79    = "TITULAR";
                     #0#80    = (N\ #0#89);

                     #0#81    = "CONYUGE";
                     #0#82    = (N\ #0#90);
                 |SINO;
                     |SI #0#89 ! 0;
                         #0#79    = "TITULAR";
                         #0#80    = (N\ #0#89);
                     |SINO;
                         #0#79    = "CONYUGE";
                         #0#80    = (N\ #0#90);
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 1;
         nBaseLiquiT   = #0#46 - #0#47 - #0#77;
         nBaseLiquiTE  = #0#57 - #0#58 - #0#78;

         |SI nBaseLiquiT  < 0;  nBaseLiquiT  = 0;  |FINSI;
         |SI nBaseLiquiTE < 0;  nBaseLiquiTE = 0;  |FINSI;
     |FINSI;

     |SI nConta = 2;
         nBaseLiquiC   = #0#46 - #0#47 - #0#77;
         nBaseLiquiCE  = #0#57 - #0#58 - #0#78;

         |SI nBaseLiquiC  < 0;  nBaseLiquiC  = 0;  |FINSI;
         |SI nBaseLiquiCE < 0;  nBaseLiquiCE = 0;  |FINSI;
     |FINSI;

     |ABRE #1;

     |SI nConta = 1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 000#1=;
         |SI FSalida = 0;
             nPendiente = #0#35 - (#0#48 + #0#59);
             nTodoDirec = #1#6  - #1#8;
             nTodoImput = #1#10 - #1#12;
             nTodoEjerc = nTodoDirec + nTodoImput;

             |SI nPendiente > nTodoEjerc;
                 #0#65 = (N\ #1#8  + nTodoDirec);
                 #0#66 = (N\ #1#12 + nTodoImput);
             |SINO;
                 #0#65 = (N\ #1#8  + ((nPendiente * nTodoDirec) / nTodoEjerc));
                 #0#66 = (N\ #1#12 + ((nPendiente * nTodoImput) / nTodoEjerc));
             |FINSI;

             |SI #0#65 ! 0;  |O #0#66 ! 0;
                 #0#64 = "TITULAR";
             |FINSI;

             nPendiente = #0#37 - (#0#50 + #0#61);
             |SI nPendiente < 0;  nPendiente = 0;   |FINSI;

             nTodoDirec = #1#14 + #1#15;

             |SI nPendiente ] nTodoDirec;
                 #0#84 = (N\ nTodoDirec);
             |SINO;
                 #0#84 = (N\ nPendiente);
             |FINSI;

             |SI #0#84 ! 0;  #0#83 = "TITULAR";  |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 2;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 000#1=;
         |SI FSalida = 0;
             nPendiente = #0#35 - (#0#48 + #0#59);
             nTodoDirec = #1#6  - #1#8;
             nTodoImput = #1#10 - #1#12;
             nTodoEjerc = nTodoDirec + nTodoImput;

             |SI nPendiente > nTodoEjerc;
                 #0#65 = (N\ #1#8  + nTodoDirec);
                 #0#66 = (N\ #1#12 + nTodoImput);
             |SINO;
                 #0#65 = (N\ #1#8  + ((nPendiente * nTodoDirec) / nTodoEjerc));
                 #0#66 = (N\ #1#12 + ((nPendiente * nTodoImput) / nTodoEjerc));
             |FINSI;

             |SI #0#65 ! 0;  |O #0#66 ! 0;
                 #0#64 = "TITULAR";
             |FINSI;

             nPendiente = #0#37 - (#0#50 + #0#61);
             |SI nPendiente < 0;  nPendiente = 0;   |FINSI;

             nTodoDirec = #1#14 + #1#15;

             |SI nPendiente ] nTodoDirec;
                 #0#84 = (N\ nTodoDirec);
             |SINO;
                 #0#84 = (N\ nPendiente);
             |FINSI;

             |SI #0#84 ! 0;  #0#83 = "TITULAR";  |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 7;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 1;
         |LEE 000#1=;
         |SI FSalida = 0;
             nVar1       = #1#5 + #1#6  + #1#7  + #1#8;
             nVar2       = #1#9 + #1#10 + #1#11 + #1#12;
             nVar3       = nVar1 + nVar2;
             nVar4       = ((nParQueVieneT * nVar1) / nVar3) ! 2;
             nVar5       = nParQueVieneT - nVar4;

             nTodoDirecT = #1#6  - #1#8  - nVar4;
             nTodoImputT = #1#10 - #1#12 - nVar5;
             nTodoEjercT = nTodoDirecT + nTodoImputT;
             nAporta1    = #1#8  + nVar4;
             nAporta2    = #1#12 + nVar5;
             nTodoMinusT = #1#14 + #1#15;
         |FINSI;

         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         #1#3 = 2;
         |LEE 000#1=;
         |SI FSalida = 0;
             nVar1       = #1#5 + #1#6  + #1#7  + #1#8;
             nVar2       = #1#9 + #1#10 + #1#11 + #1#12;
             nVar3       = nVar1 + nVar2;
             nVar4       = ((nParQueVieneC * nVar1) / nVar3) ! 2;
             nVar5       = nParQueVieneC - nVar4;

             nTodoDirecC = #1#6  - #1#8  - nVar4;
             nTodoImputC = #1#10 - #1#12 - nVar5;
             nTodoEjercC = nTodoDirecC + nTodoImputC;
             nAporta3    = #1#8  + nVar4;
             nAporta4    = #1#12 + nVar5
             nTodoMinusC = #1#14 + #1#15;
         |FINSI;

         nPendiente = #0#35 - (#0#48 + #0#59 + nParQueVieneT + nParQueVieneC);
         nTodoEjerc = nTodoEjercT + nTodoEjercC;
         nTit       = nTodoEjercT + nAporta1 + nAporta2;
         nCon       = nTodoEjercC + nAporta3 + nAporta4;

         |SI nTit ! 0;  |Y nCon ! 0;
             |SI nPendiente > nTodoEjercT;
                 #0#65 = (N\ nAporta1 + nTodoDirecT);
                 #0#66 = (N\ nAporta2 + nTodoImputT);
             |SINO;
                 #0#65 = (N\ nAporta1 + ((nPendiente * nTodoDirecT) / nTodoEjerc));
                 #0#66 = (N\ nAporta2 + ((nPendiente * nTodoImputT) / nTodoEjerc));
             |FINSI;

             |SI #0#65 ! 0;  |O #0#66 ! 0;
                 #0#64 = "TITULAR";
             |FINSI;

             |SI nPendiente > nTodoEjercC;
                 #0#68 = (N\ nAporta3 + nTodoDirecC);
                 #0#69 = (N\ nAporta4 + nTodoImputC);
             |SINO;
                 #0#68 = (N\ nAporta3 + ((nPendiente * nTodoDirecC) / nTodoEjerc));
                 #0#69 = (N\ nAporta4 + ((nPendiente * nTodoImputC) / nTodoEjerc));
             |FINSI;

             |SI #0#68 ! 0;  |O #0#69 ! 0;
                 #0#67 = "CONYUGE";
             |FINSI;
         |SINO;
             |SI nTit ! 0;
                 |SI nPendiente > nTodoEjercT;
                     #0#65 = (N\ nAporta1 + nTodoDirecT);
                     #0#66 = (N\ nAporta2 + nTodoImputT);
                 |SINO;
                     #0#65 = (N\ nAporta1 + ((nPendiente * nTodoDirecT) / nTodoEjerc));
                     #0#66 = (N\ nAporta2 + ((nPendiente * nTodoImputT) / nTodoEjerc));
                 |FINSI;

                 |SI #0#65 ! 0;  |O #0#66 ! 0;
                     #0#64 = "TITULAR";
                 |FINSI;
             |FINSI;

             |SI nCon ! 0;
                 |SI nPendiente > nTodoEjercC;
                     #0#65 = (N\ nAporta3 + nTodoDirecC);
                     #0#66 = (N\ nAporta4 + nTodoImputC);
                 |SINO;
                     #0#65 = (N\ nAporta3 + ((nPendiente * nTodoDirecC) / nTodoEjerc));
                     #0#66 = (N\ nAporta4 + ((nPendiente * nTodoImputC) / nTodoEjerc));
                 |FINSI;

                 |SI #0#65 ! 0;  |O #0#66 ! 0;
                     #0#64 = "CONYUGE";
                 |FINSI;
             |FINSI;
         |FINSI;

         nPendiente = #0#37 - (#0#50 + #0#61);
         |SI nTodoMinusT ! 0;  |Y nTodoMinusC ! 0;  |Y nPendiente ! 0;
             nTodoEjerc = nTodoMinusT + nTodoMinusC;

             |SI nPendiente ] nTodoEjerc;
                 #0#84 = (N\ nTodoMinusT);
                 #0#86 = (N\ nTodoMinusC);
             |SINO;
                 #0#84 = (N\ ((nPendiente * nTodoMinusT) / nTodoEjerc));
                 #0#86 = (N\ ((nPendiente * nTodoMinusC) / nTodoEjerc));
             |FINSI;

             |SI #0#84 ! 0;  #0#83 = "TITULAR";  |FINSI;
             |SI #0#86 ! 0;  #0#85 = "CONYUGE";  |FINSI;
         |SINO;
             |SI nTodoMinusT ! 0;  |Y nPendiente ! 0;
                 |SI nPendiente ] nTodoEjerc;
                     #0#84 = (N\ nTodoMinusT);
                 |SINO;
                     #0#84 = (N\ nPendiente);
                 |FINSI;

                 |SI #0#84 ! 0;  #0#83 = "TITULAR";  |FINSI;
             |FINSI;

             |SI nTodoMinusC ! 0;  |Y nPendiente ! 0;
                 |SI nPendiente ] nTodoEjerc;
                     #0#84 = (N\ nTodoMinusC);
                 |SINO;
                     #0#84 = (N\ nPendiente);
                 |FINSI;

                 |SI #0#84 ! 0;  #0#83 = "CONYUGE";  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nConta = 8;
         |SI eaMuerto = "C";
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 1;
             |LEE 000#1=;
             |SI FSalida = 0;
                 nSuma = #1#8 + #1#12;
                 |SI nSuma ! 0;
                     #0#64 = "TITULAR";
                     #0#65 = (N\ #1#8);
                     #0#66 = (N\ #1#12);
                 |FINSI;

                 nPendiente = #0#37 - (#0#50 + #0#61);
                 |SI nPendiente < 0;  nPendiente = 0;   |FINSI;

                 nTodoDirec = #1#14 + #1#15;

                 |SI nPendiente ] nTodoDirec;
                     #0#84 = (N\ nTodoDirec);
                 |SINO;
                     #0#84 = (N\ nPendiente);
                 |FINSI;

                 |SI #0#84 ! 0;  #0#83 = "TITULAR";  |FINSI;
             |FINSI;
         |SINO;
             #1#0 = #1001#0;
             #1#1 = #1001#1;
             #1#2 = #1001#2;
             #1#3 = 2;
             |LEE 000#1=;
             |SI FSalida = 0;
                 nSuma = #1#8 + #1#12;
                 |SI nSuma ! 0;
                     #0#64 = "CONYUGE";
                     #0#65 = (N\ #1#8);
                     #0#66 = (N\ #1#12);
                 |FINSI;

                 nPendiente = #0#37 - (#0#50 + #0#61);
                 |SI nPendiente < 0;  nPendiente = 0;   |FINSI;

                 nTodoDirec = #1#14 + #1#15;

                 |SI nPendiente ] nTodoDirec;
                     #0#84 = (N\ nTodoDirec);
                 |SINO;
                     #0#84 = (N\ nPendiente);
                 |FINSI;

                 |SI #0#84 ! 0;  #0#83 = "CONYUGE";  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #1;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum   = 0;
     enBloque   = 12;
     enImporteA = 0;
     eaCasilla  = "517";  enImporte = #0#75;   |HAZ GrabaLineal;
     eaCasilla  = "550";  enImporte = #0#35;   |HAZ GrabaLineal;
     eaCasilla  = "555";  enImporte = #0#36;   |HAZ GrabaLineal;
     eaCasilla  = "580";  enImporte = #0#37;   |HAZ GrabaLineal;
     eaCasilla  = "600";  enImporte = #0#44;   |HAZ GrabaLineal;
     eaCasilla  = "610";  enImporte = #0#45;   |HAZ GrabaLineal;

     enBloque   = 13;
     eaCasilla  = "484";  enImporte = #0#46;   |HAZ GrabaLineal;
     eaCasilla  = "627";  enImporte = #0#53;   |HAZ GrabaLineal;
     eaCasilla  = "628";  enImporte = #0#55;   |HAZ GrabaLineal;
     eaCasilla  = "630";  enImporte = #0#56;   |HAZ GrabaLineal;

     enBloque   = 14;
     eaCasilla  = "487";  enImporte = #0#57;   |HAZ GrabaLineal;
     eaCasilla  = "640";  enImporte = #0#63;   |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Ajusta1;
     nAcumLimite = nAcumLimite + nAjuste;
     |SI nLimite < nAcumLimite;
         nAjuste     = nAjuste - (nAcumLimite - nLimite);
         nAcumLimite = nLimite;
     |FINSI;
|FPRC;

|PROCESO CalculaAnexoA;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 101#0=;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |GRABA 020#0b;
     |FINSI;

     nCatalunyaA = 0;
     nCatalunyaB = 0;
     nMurcia     = 0;

     |SI #0#89 = "S"; nMurcia     = 1;  |FINSI;
     |SI #0#90 = "1"; nCatalunyaA = 1;  |FINSI;
     |SI #0#90 = "2"; nCatalunyaB = 1;  |FINSI;

     nAcumLimite = 0;
     nLimite     = #401#32;

     nAjuste = #0#37;  |HAZ Ajusta1;  #0#37 = nAjuste;
     nAjuste = #0#39;  |HAZ Ajusta1;  #0#39 = nAjuste;
     nAjuste = #0#41;  |HAZ Ajusta1;  #0#41 = nAjuste;
     nAjuste = #0#42;  |HAZ Ajusta1;  #0#42 = nAjuste;
     nAjuste = #0#43;  |HAZ Ajusta1;  #0#43 = nAjuste;

     nAjuste  = #0#37;
     nAjuste2 = 0;
     |SI #0#37 > #401#34;
         nAjuste  = #401#34;
         nAjuste2 = #0#37 - #401#34;
     |FINSI;

     nPorce1 = 16.75;
     nPorce2 =  8.25;
     nPorce3 = 10.05;
     nPorce4 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  6.75;  nPorce4 =  3.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  9.75;  nPorce4 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  9.60;  nPorce4 =  4.95;  |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#38   = nValor1;
     #0#58   = nValor2;

     nAjuste  = #0#39;
     nAjuste2 = 0;
     nLimitee = #401#34 - #0#37;
     |SI nLimitee < 0;
         nLimitee = 0;
     |FINSI;

     |SI #0#39 > nLimitee;
         nAjuste  = nLimitee;
         nAjuste2 = #0#39 - nLimitee;
     |FINSI;

     nPorce1 = 13.40;
     nPorce2 =  6.60;
     nPorce3 = 10.05;
     nPorce4 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  5.10;  nPorce4 =  3.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  8.10;  nPorce4 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  9.60;  nPorce4 =  4.95;  |FINSI;

     nValor1 = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2 = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#40   = nValor1;
     #0#59   = nValor2;

     nPorce1 = 10.05;
     nPorce2 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  3.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  6.95;  |FINSI;

     nValor1 = (#0#41 % nPorce1) ! 2;
     nValor2 = (#0#41 % nPorce2) ! 2;
     #0#13   = nValor1;
     #0#61   = nValor2;

     nPorce1 = 10.05;
     nPorce2 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  3.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  6.95;  |FINSI;

     nValor1 = (#0#42 % nPorce1) ! 2;
     nValor2 = (#0#42 % nPorce2) ! 2;
     #0#14   = nValor1;
     #0#64   = nValor2;

     nAjuste  = #0#44;
     nAjuste2 = 0;
     |SI #0#44    > #401#35;
         nAjuste  = #401#35;
         nAjuste2 = #0#44 - #401#35;
     |FINSI;

     |SI nAjuste2 > #401#35;
         nAjuste2 = #401#35;
     |FINSI;

     nPorce1 = 16.75;
     nPorce2 =  8.25;
     nPorce3 = 10.05;
     nPorce4 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  9.75;  nPorce4 =  6.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  9.75;  nPorce4 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  8.25;  nPorce4 =  4.95;  |FINSI;

     nValor1   = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2   = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#45     = nValor1;
     #0#66     = nValor2;

     nAjuste3  = nAjuste  + nAjuste2;
     nAjuste4  = nAjuste3 + #0#46;
     |SI nAjuste4 > #401#33;
         nAjuste4 = #401#33;
     |FINSI;

     nAjuste  = nAjuste4 - nAjuste3;
     nAjuste2 = 0;

     |SI nAjuste3 > #401#35;
         nAjuste2 = nAjuste;
         nAjuste  = 0;
     |SINO;
         nValor   = #401#35 - nAjuste3;
         nAjuste2 = nAjuste - nValor;
         |SI nAjuste2 < 0;  nAjuste2 = 0;  |FINSI;
         nAjuste  = nAjuste - nAjuste2;
     |FINSI;

     nPorce1 = 13.40;
     nPorce2 =  6.60;
     nPorce3 = 10.05;
     nPorce4 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  8.10;  nPorce4 =  6.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  8.10;  nPorce4 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  6.60;  nPorce4 =  4.95;  |FINSI;

     nValor1  = ((nAjuste % nPorce1) + (nAjuste2 % nPorce3)) ! 2;
     nValor2  = ((nAjuste % nPorce2) + (nAjuste2 % nPorce4)) ! 2;
     #0#47    = nValor1;
     #0#67    = nValor2;

     nAjuste4 = nAjuste  + nAjuste2;
     nAjuste3 = nAjuste3 + nAjuste4;
     nAjuste4 = nAjuste3 + #0#48;
     |SI nAjuste4 > #401#33;
         nAjuste4 = #401#33;
     |FINSI;
     nAjuste2 = nAjuste4 - nAjuste3;
     |SI #0#48 ! 0;
         nPorce1 = 10.05;
         nPorce2 =  4.95;

         |SI nCatalunyaA ! 0;  nPorce2 =  6.45;  |FINSI;
         |SI nCatalunyaB ! 0;  nPorce2 =  6.45;  |FINSI;
         |SI nMurcia     ! 0;  nPorce2 =  4.95;  |FINSI;

         nValor1 = (nAjuste2 % nPorce1) ! 2;
         nValor2 = (nAjuste2 % nPorce2) ! 2;

         #0#29   = nValor1;
         #0#69   = nValor2;
     |FINSI;

     nPorce1 = 10.05;
     nPorce2 =  4.95;

     |SI nCatalunyaA ! 0;  nPorce2 =  3.45;  |FINSI;
     |SI nCatalunyaB ! 0;  nPorce2 =  6.45;  |FINSI;
     |SI nMurcia     ! 0;  nPorce2 =  4.95;  |FINSI;

     nValor1 = (#0#43 % nPorce1) ! 2;
     nValor2 = (#0#43 % nPorce2) ! 2;

     #0#15   = nValor1;
     #0#65   = nValor2;

     nValor  = (#0#74 % 15) ! 2;
     nValor1 = (nValor % 67) ! 2;
     nValor2 = nValor - nValor1;
     #0#75   = nValor1;
     #0#76   = nValor2;
     #0#74   = nValor1 + nValor2;

     #0#12    = (N\ #0#38 + #0#40);
     #0#60    = (N\ #0#58 + #0#59);
     #0#28    = (N\ #0#45 + #0#47);
     #0#68    = (N\ #0#66 + #0#67);

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;

     enSwAcum  = 0;
     enBloque  = 20;
     eaCasilla = "687";  enImporte = #0#12; enImporteA = #0#60;  |HAZ GrabaLineal;
     eaCasilla = "689";  enImporte = #0#13; enImporteA = #0#61;  |HAZ GrabaLineal;
     eaCasilla = "691";  enImporte = #0#14; enImporteA = #0#64;  |HAZ GrabaLineal;
     eaCasilla = "693";  enImporte = #0#15; enImporteA = #0#65;  |HAZ GrabaLineal;
     eaCasilla = "695";  enImporte = #0#28; enImporteA = #0#68;  |HAZ GrabaLineal;
     eaCasilla = "697";  enImporte = #0#29; enImporteA = #0#69;  |HAZ GrabaLineal;

     enBloque  = 23;
     eaCasilla = "707";  enImporte = #0#75; enImporteA = #0#76;  |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO Trabajo;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic4@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic4@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #3;
     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 040#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |CIERRA #3;

     |ABRE #4;
     #4#0 = #1001#0;
     #4#1 = #1001#1;
     #4#2 = #1001#2;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0 = #1001#0;
         #4#1 = #1001#1;
         #4#2 = #1001#2;
         |GRABA 020#4b;
     |FINSI;

     nValor = #2#16  + #2#17 - #2#18 + #2#19 + #2#7 + #2#8;
     nValor = nValor + #2#11 + #2#13 + #4#74;

     enBloque = 3;  eaCasilla = "079"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 6;  eaCasilla = "245"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 6;  eaCasilla = "255"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 6;  eaCasilla = "265"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque = 6;  eaCasilla = "275"; |HAZ SacaImporte; nValor = nValor + enImporte;

     nValor    = nValor + #3#29 - #3#30 + #3#33 - #3#34;

     |SI nConta = 1;  nRentas1 = nValor + #1#15;  nRdtosTrab1 = #1#15;  nActivo1 = #1#20;  |FINSI;
     |SI nConta = 2;  nRentas2 = nValor + #1#15;  nRdtosTrab2 = #1#15;  nActivo2 = #1#20;  |FINSI;
     |SI nConta = 3;  nRentas3 = nValor + #1#15;  nRdtosTrab3 = #1#15;  nActivo3 = #1#20;  |FINSI;
     |SI nConta = 4;  nRentas4 = nValor + #1#15;  nRdtosTrab4 = #1#15;  nActivo4 = #1#20;  |FINSI;
     |SI nConta = 5;  nRentas5 = nValor + #1#15;  nRdtosTrab5 = #1#15;  nActivo5 = #1#20;  |FINSI;
     |SI nConta = 6;  nRentas6 = nValor + #1#15;  nRdtosTrab6 = #1#15;  nActivo6 = #1#20;  |FINSI;
     |SI nConta > 6;                              nRdtosTrab7 = #1#15;                     |FINSI;

     #1#16     = 0;
     |SI #1#15 > #401#4; |O nValor > #401#5;
         #1#16 = #401#6;
     |SINO;
         |SI #1#15 [ #401#7;
             #1#16 = #401#8;
         |SINO;
             #1#16 = (N\ #401#8 - (0.2291 * (#1#15 - #401#7)));
         |FINSI;
     |FINSI;

     nCas925 = #1#16;
     nCas926 = 0;
     nCas927 = 0;

     |ABRE #19;

     |SI nConta = 1;
         nRedTrab1 = #1#16;

         #19#0     = #1#0;
         #19#1     = "TITULAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aProlon1 = #19#2;
         aMovili1 = #19#3;
         nEjerMo1 = #19#4;

         |SI #19#2 = "S";                    nCas926 = nRedTrab1;  |FINSI;
         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab1;  |FINSI;
     |FINSI;

     |SI nConta = 2;
         nRedTrab2 = #1#16;

         #19#0     = #1#0;
         #19#1     = "CONYUGE";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aProlon2 = #19#2;
         aMovili2 = #19#3;
         nEjerMo2 = #19#4;

         |SI #19#2 = "S";                    nCas926 = nRedTrab2;  |FINSI;
         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab2;  |FINSI;
     |FINSI;

     |SI nConta = 3;
         nRedTrab3 = #1#16;

         #19#0     = #1#0;
         #19#1     = "1 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili3 = #19#3;
         nEjerMo3 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab3;  |FINSI;
     |FINSI;

     |SI nConta = 4;
         nRedTrab4 = #1#16;

         #19#0     = #1#0;
         #19#1     = "2 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili4 = #19#3;
         nEjerMo4 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab4;  |FINSI;
     |FINSI;

     |SI nConta = 5;
         nRedTrab5 = #1#16;

         #19#0     = #1#0;
         #19#1     = "3 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili5 = #19#3;
         nEjerMo5 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab5;  |FINSI;
     |FINSI;

     |SI nConta = 6;
         nRedTrab6 = #1#16;

         #19#0     = #1#0;
         #19#1     = "4 FAMILIAR";
         |LEE 000#19=;
         |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

         aMovili6 = #19#3;
         nEjerMo6 = #19#4;

         |SI #19#3 = "S";  |Y #19#4 ] 2003;  nCas927 = nRedTrab6;  |FINSI;
     |FINSI;

     |SI nConta > 6;
         nRedTrab1 = #1#16;

         |SI aProlon1 = "S";                     nCas926  = nRedTrab1;  |FINSI;
         |SI aProlon2 = "S";                     nCas926  = nRedTrab1;  |FINSI;

         |SI aMovili1 = "S"; |Y nEjerMo1 ] 2003; nCas927  = nRedTrab1;  |FINSI;
         |SI aMovili2 = "S"; |Y nEjerMo2 ] 2003; nCas927  = nRedTrab1;  |FINSI;
         |SI aMovili3 = "S"; |Y nEjerMo3 ] 2003; nCas927  = nRedTrab1;  |FINSI;
         |SI aMovili4 = "S"; |Y nEjerMo4 ] 2003; nCas927  = nRedTrab1;  |FINSI;
         |SI aMovili5 = "S"; |Y nEjerMo5 ] 2003; nCas927  = nRedTrab1;  |FINSI;
         |SI aMovili6 = "S"; |Y nEjerMo6 ] 2003; nCas927  = nRedTrab1;  |FINSI;
     |FINSI;
     |CIERRA #19;

     #4#24 = nCas925;
     #4#25 = nCas926;
     #4#26 = nCas927;

     |GRABA 020#4a;
     |LIBERA #4;
     |CIERRA #4;

     nValenciana4 = #1#9;
     |SI #1#15 = 0;
         nValenciana4 = 0;
     |SINO;
         |SI nValenciana4 > #1#15;
             nValenciana4 = #1#15;
         |FINSI;
     |FINSI;

     enBloque = 4; eaCasilla = "085"; |HAZ SacaImporte;  nValenciana10 = enImporte;
     enBloque = 4; eaCasilla = "090"; |HAZ SacaImporte;
     |SI enImporte [ 0;
         nValenciana10 = 0;
     |SINO;
         |SI nValenciana10 > enImporte;
             nValenciana10 = enImporte;
         |FINSI;
     |FINSI;

     nValenciana14 = 0;
     enBloque = 2; eaCasilla = "033"; |HAZ SacaImporte;  nValenciana14 = nValenciana14 + enImporte;
     enBloque = 2; eaCasilla = "034"; |HAZ SacaImporte;  nValenciana14 = nValenciana14 + enImporte;
     enBloque = 2; eaCasilla = "035"; |HAZ SacaImporte;
     |SI enImporte = 0;
         nValenciana14 = 0;
     |SINO;
         |SI nValenciana14 > enImporte;
             nValenciana14 = enImporte;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #datfic4@;
     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO LeeCasillaAutonomica;
     #408#0 = nComunidad;
     #408#1 = nCasilla;
     |LEE 000#408=;
     |SI FSalida ! 0;  |DDEFECTO #408;  |FINSI;

     nCampo   = 124 + (nCasilla - 800);
     aChequeo = #1nCampo;
|FPRC;

|PROCESO Andalucia;
     nComunidad = 1;

     |SI #1#5 ! 0;
         nCasilla = 802;  |HAZ LeeCasillaAutonomica;
         |SI aChequeo = "S";
             nValor = (#408#13 % 2) ! 2;
             |SI #1#5 > nValor;  #1#5 = nValor;  |FINSI;

             |SI nConta [ 6;
                 |SI #2#20 > #408#9;  #1#5 = 0;  |FINSI;
             |SINO;
                 |SI #2#20 > #408#11; #1#5 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#6 ! 0;
         nCasilla = 803;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI #2#20 > #408#9;   #1#6 = 0;  |FINSI;
             |SINO;
                 |SI #2#20 > #408#11;  #1#6 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#9 ! 0;
         nCasilla = 806;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI #2#20 > #408#11;  #1#9 = 0;  |FINSI;
             |SINO;
                 |SI #2#20 > #408#13;  #1#9 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#10 ! 0;
         nCasilla = 807;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI #2#20 > #408#11;  #1#10 = 0;  |FINSI;
             |SINO;
                 |SI #2#20 > #408#13;  #1#10 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#11 = (N\ #1#3 + #1#4 + #1#5 + #1#6 + #1#7 + #1#8 + #1#9 + #1#10);
|FPRC;

|PROCESO Aragon;
     nComunidad = 2;

     |SI #1#12 ! 0;
         nCasilla = 808;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = 0;
             |ABRE #2;
             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "TITULAR";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = #2#20 + #2#63;

             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "CONYUGE";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = nSuma + #2#20 + #2#63;

             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "1 FAMILIAR";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = nSuma + #2#20 + #2#63;

             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "2 FAMILIAR";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = nSuma + #2#20 + #2#63;

             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "3 FAMILIAR";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = nSuma + #2#20 + #2#23;

             #2#0 = #1001#0;
             #2#1 = #1001#1;
             #2#2 = "4 FAMILIAR";
             |LEE 040#2=;
             |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

             nSuma = nSuma + #2#20 + #2#23;

             |SI nConta [ 6;
                 |SI nSuma < #408#13;
                     #1#12 = #1#122 * #408#11;
                 |FINSI;
                 nAragon = nAragon + #1#12;
             |SINO;
                 #1#12 = nAragon;
             |FINSI;

             |CIERRA #2;
         |FINSI;
     |FINSI;

     #1#14 = (N\ #1#12 + #1#13);
|FPRC;

|PROCESO Asturias;
     nComunidad = 3;

     |SI #1#15 ! 0;
         nCasilla = 810;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#15 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#15 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#16 ! 0;
         nCasilla = 811;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = (#408#9 % 3) ! 2;
             |SI #1#16 > nValor;  #1#16 = nValor;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#17 ! 0;
         nCasilla = 812;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = (#408#9 % 3) ! 2;
             |SI #1#17 > nValor;  #1#17 = nValor;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#19 ! 0;
         nCasilla = 814;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;  #1#19 = 0;  |FINSI;
             |SINO;
                 nValor = #408#11 + 200;
                 |SI nSuma > nValor;  #1#19 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#21 ! 0;
         nCasilla = 816;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;   #1#21 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11;  #1#21 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#22 ! 0;
         nCasilla = 817;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#53 % 10;
             |SI #1#22 > nSuma;  #1#22 = nSuma;  |FINSI;
         |FINSI;
     |FINSI;

     #1#23 = (N\ #1#15 + #1#16 + #1#17 + #1#18 + #1#19 + #1#20 + #1#21 + #1#22);
|FPRC;

|PROCESO Baleares;
     nComunidad = 4;

     |SI #1#24 ! 0;
         nCasilla = 818;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI #2#18 > #408#9;   #1#24 = 0;  |FINSI;
             |SINO;
                 |SI #2#21 > #408#11;  #1#24 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#25 ! 0;
         nCasilla = 819;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#25 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#25 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#26 ! 0;
         nCasilla = 820;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;   #1#26 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11;  #1#26 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#28 ! 0;
         nCasilla = 822;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#28 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#28 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#27 ! 0;
         nCasilla = 821;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;  #1#27 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11; #1#27 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#30  = (N\ #1#24  + #1#25  + #1#26  + #1#27  + #1#28  + #1#29);
|FPRC;

|PROCESO Canarias;
     nComunidad = 5;

     enBloque  = 18;  eaCasilla = "681";  |HAZ SacaImporte;

     nValor2   = enImporteA % 10;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     |SI #1#31 > nValor2;  #1#31 = nValor2;  |FINSI;
     |SI #1#32 > nValor2;  #1#32 = nValor2;  |FINSI;     |SI #1#33 > nValor2;  #1#33 = nValor2;  |FINSI;

     nValor2   = enImporteA % 40;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     nCasilla = 827;  |HAZ LeeCasillaAutonomica;
     |SI aChequeo = "S";
         |SI #1#34 > nValor2;  #1#34 = nValor2;  |FINSI;
     |FINSI;

     |SI #1#35 ! 0;
         nCasilla = 828;  |HAZ LeeCasillaAutonomica;
         |SI aChequeo = "S";
             nValor1  = 0;
             enBloque = 1;  eaCasilla = "020"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
             enBloque = 5;  eaCasilla = "140"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
             enBloque = 5;  eaCasilla = "170"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;
             enBloque = 5;  eaCasilla = "199"; |HAZ SacaImporte; nValor1 = nValor1 + enImporte;

             enBloque = 13; eaCasilla = "630"; |HAZ SacaImporte; nValor2 = enImporte;
             enBloque = 18; eaCasilla = "681"; |HAZ SacaImporte; nValor3 = enImporteA;

             nValor   = (nValor3 * nValor1) / nValor2;

             |SI #1#35 > nValor;  #1#35 = nValor;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#39 ! 0;
         nCasilla = 832;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;   #1#39 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11;  #1#39 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#40  = (N\ #1#31  + #1#32  + #1#33  + #1#34  + #1#35  + #1#36  + #1#37 + #1#38 + #1#39);
|FPRC;

|PROCESO Cantabria;
     nComunidad = 6;

     |SI #1#41 ! 0;
         nCasilla = 833;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI #2#20 > #408#9;   #1#41 = 0;  |FINSI;
             |SINO;
                 |SI #2#20 > #408#11;  #1#41 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#44  = (N\ #1#41  + #1#42  + #1#43);
|FPRC;

|PROCESO CastillaMancha;
     nComunidad = 7;

     |SI #1#45 ! 0;
         nCasilla = 836;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #2#20 > #408#11;   #1#45 = 0;   |FINSI;
             |SI #2#23 > #408#13;   #1#45 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#46 ! 0;
         nCasilla = 837;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #2#20 > #408#11;   #1#46 = 0;   |FINSI;
             |SI #2#23 > #408#13;   #1#46 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#47 ! 0;
         nCasilla = 838;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #2#20 > #408#11;   #1#47 = 0;   |FINSI;
             |SI #2#23 > #408#13;   #1#47 = 0;   |FINSI;
         |FINSI;
     |FINSI;

     #1#49  = (N\ #1#45  + #1#46  + #1#47  + #1#48);
|FPRC;

|PROCESO CastillaLeon;
     nComunidad = 8;

     |SI #1#50 ! 0;
         |SI nConta ] 7;
             nCasilla = 840;  |HAZ LeeCasillaAutonomica;

             |SI aChequeo = "S";
                 |SI #1#50 ] #408#11;  #1#50 = #1#50 - 0.01;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#53 ! 0;
         nCasilla = 843;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI #1#53 > #408#9;   #1#53 = #408#9;   |FINSI;
                 |SI nSuma > #408#13;  #1#53 = 0;        |FINSI;
             |SINO;
                 |SI #1#53 > #408#11;  #1#53 = #408#11; |FINSI;
                 |SI nSuma > #408#15;  #1#53 = 0;       |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#54 ! 0;
         nCasilla = 844;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#54 = 0;        |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#54 = 0;        |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#55 ! 0;
         nCasilla = 845;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;    #1#55 = 0;        |FINSI;
             |SINO;
                 |SI nSuma > #408#11;   #1#55 = 0;        |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#170 = "S";  |O #1#171 = "S";
         nValor1 = #1#56 + #1#57;
         nValor2 = ((#2#53 + #2#63) % 10) ! 2;
         |SI nValor1 > nValor2;
             |SI #1#56 ! 0;  |Y #1#57 ! 0;
                 |SI #1#56 > nValor2;
                     #1#56 = nValor2 % 15;
                     #1#57 = 0;
                 |SINO;
                     #1#57 = (nValor2 - #1#56) % 15;
                 |FINSI;
             |SINO;
                 |SI #1#56 ! 0;  #1#56 = nValor2 % 15;  |FINSI;
                 |SI #1#57 ! 0;  #1#57 = nValor2 % 15;  |FINSI;
             |FINSI;
         |SINO;
             |SI #1#56 ! 0;  #1#56 = #1#56 % 15;  |FINSI;
             |SI #1#57 ! 0;  #1#57 = #1#57 % 15;  |FINSI;
         |FINSI;

         |SI nValor2 < 0;
             #1#56 = 0;
             #1#57 = 0;
         |FINSI;
     |FINSI;

     #1#58  = (N\ #1#50  + #1#51  + #1#52  + #1#53  + #1#54  + #1#55  + #1#56 + #1#57);
|FPRC;

|PROCESO Catalunya;
     nComunidad = 9;

     |SI #1#61 ! 0;
         nCasilla = 850;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI #1#61 > #408#9;    #1#61 = #408#9;   |FINSI;
                 |SI nSuma > #408#11;   #1#61 = 0;        |FINSI;
             |SINO;
                 |SI #1#61 > #408#9;    #1#61 = #408#9;   |FINSI;
                 |SI nSuma > #408#13;   #1#61 = 0;        |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     enBloque  = 18;  eaCasilla = "681";  |HAZ SacaImporte;
     nValor2   = enImporteA % 10;
     |SI nValor2 < 0;  nValor2 = 0;  |FINSI;

     nCasilla = 849;  |HAZ LeeCasillaAutonomica;

     |SI aChequeo = "S";
         |SI #1#60 > nValor2;  #1#60 = nValor2;  |FINSI;
     |FINSI;

     #1#65  = (N\ #1#59  + #1#60  + #1#61  + #1#62  + #1#63  + #1#64);
|FPRC;

|PROCESO Extremadura;
     nComunidad = 10;

     nCasilla = 854;  |HAZ LeeCasillaAutonomica;

     nValor = 0;
     enBloque  = 7;  eaCasilla = "470";  |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque  = 7;  eaCasilla = "471";  |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque  = 7;  eaCasilla = "472";  |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque  = 7;  eaCasilla = "473";  |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque  = 7;  eaCasilla = "474";  |HAZ SacaImporte; nValor = nValor - enImporte;

     |SI aChequeo = "S";
         |SI nValor > #408#11;  #1#66 = 0;  |FINSI;
     |FINSI;;

     enBloque = 7;  eaCasilla = "472";  |HAZ SacaImporte;  nValor1 = enImporte;
     enBloque = 1;  eaCasilla = "020";  |HAZ SacaImporte;  nValor  = enImporte;

     nCasilla = 855;  |HAZ LeeCasillaAutonomica;

     |SI aChequeo = "S";
         nValor1  = nValor1 - nValor;
         |SI nValor > #408#9;  |O nValor1 > #408#11;
             #1#67 = 0;
         |FINSI;
     |FINSI;

     nCasilla = 856;  |HAZ LeeCasillaAutonomica;

     |SI aChequeo = "S";
         nValor = #1#68 + #1#69;
         |SI nValor > #408#9;
             |SI #1#68 > #408#9;
                 #1#68 = #408#9;
                 #1#69 = 0;
             |SINO;
                 #1#69 = #408#9 - #1#68;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#70 ! 0;
         nCasilla = 858;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;    #1#70 = 0;        |FINSI;
             |SINO;
                 |SI nSuma > #408#11;   #1#70 = 0;        |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#71 ! 0;
         nCasilla = 859;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#20 + #2#23;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;   #1#71 = 0;        |FINSI;
             |SINO;
                 |SI nSuma > #408#13;   #1#71 = 0;        |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#73  = (N\ #1#66  + #1#67  + #1#68  + #1#69  + #1#70  + #1#71  + #1#72);
|FPRC;

|PROCESO Galicia;
     nComunidad = 11;

     |SI #1#74 ! 0;  |O #1#123 ! 0;
         nCasilla = 861;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nOtra  = 0;
             nValor = #2#10 + #2#14;
             |SI nValor < #408#9;
                 nOtra = #1#123 * #408#13;
             |FINSI;

             |SI nValor ] #408#9;  |Y nValor [ #408#11;
                 nOtra = #1#123 * #408#15;
             |FINSI;

             #1#74 = #1#74 + nOtra;
         |FINSI;
     |FINSI;

     nValor = #2#53;
     |SI #1#76 ! 0;
         nCasilla = 863;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI nValor > #408#9;  #1#76 = 0;  |FINSI;
             |SINO;
                 |SI nValor > #408#11; #1#76 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor = #2#10 + #2#14;
     |SI #1#77 ! 0;
         nCasilla = 864;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI nValor > #408#9;  #1#77 = 0;  |FINSI;
             |SINO;
                 |SI nValor > #408#11; #1#77 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor = #2#10 + #2#14;
     |SI #1#79 ! 0;
         nCasilla = 866;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #1#79  > #408#9;    #1#79 = #408#9;   |FINSI;
             |SI nValor > #408#11;   #1#79 = 0;        |FINSI;
         |FINSI;
     |FINSI;

     #1#80  = (N\ #1#74 + #1#75  + #1#76  + #1#77  + #1#78  + #1#79);
|FPRC;

|PROCESO Madrid;
     nComunidad = 12;

     nSuma = #2#10 + #2#14;
     |SI #1#81 ! 0;
         nCasilla = 867;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI nSuma > #408#15;  #1#81 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#17;  #1#81 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#83 ! 0;
         nCasilla = 869;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI nSuma > #408#9;   #1#83 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11;  #1#83 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#84 ! 0;
         nCasilla = 870;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI nSuma > #408#9;  #1#84 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11; #1#84 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#85 ! 0;
         nCasilla = 871;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #1#85 > #408#9;   #1#85 = #408#9;  |FINSI;

             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#85 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#85 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#86 ! 0;
         nCasilla = 872;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nBase1 = ((#1#86 * 100) / 15);
             nValor = #3#11 - #3#4 - #3#7;

             |SI nBase1 > nValor;  #1#86 = nValor % 15;  |FINSI;
         |FINSI;
     |FINSI;

     #1#88  = (N\ #1#81  + #1#82  + #1#83  + #1#84  + #1#85  + #1#86  + #1#87);
|FPRC;

|PROCESO Murcia;
     nComunidad = 13;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #1001#2;
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;
     |CIERRA #999;

     nBase    = 0;
     |SI #1#89 ! 0;
         nCasilla = 874;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor1 = #2#53;
             nValor2 = #2#63;
             nBase   = #1#89 * 50;
             |SI nBaseViv < #408#13;
                 nLimite = #408#13 - nBaseViv;
                 |SI nLimite < 0;  nLimite = 0;  |FINSI;

                 |SI nBase > nLimite;
                      nBase = nLimite;
                 |FINSI;

                 nPorceBase = 3;
                 |SI nValor1 < #408#9;  |Y nValor2 [ #408#11;
                     #1#89 = nBase % 5;
                     nPorceBase = 5;
                 |SINO;
                     #1#89 = nBase % 3;
                 |FINSI;
             |SINO;
                 #1#89 = 0;
             |FINSI;

             |SI #1#89 > #408#15;  #1#89 = #408#15;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#90 ! 0;
         nCasilla = 875;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nBase1 = ((#1#90 * 100) / 30);
             nValor = #3#11 - #3#4 - #3#7;

             |SI nBase1 > nValor;  #1#90 = nValor % 30;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#91 ! 0;
         nCasilla = 876;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI nConta [ 6;
                 |SI #1#91 > #408#9;    #1#91 = #408#9;    |FINSI;
                 |SI #2#53 > #408#13;   #1#91 = 0;         |FINSI;
             |SINO;
                 |SI #1#91 > #408#11;   #1#91 = #408#11;   |FINSI;
                 |SI #2#53 > #408#15;   #1#91 = 0;         |FINSI;
             |FINSI;
             |SI #2#63 >  #408#17;   #1#91 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     #1#93  = (N\ #1#89  + #1#90  + #1#91  + #1#92);
|FPRC;

|PROCESO LaRioja;
     nComunidad = 16;

     |SI #1#95 ! 0;
         nCasilla = 879;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = #2#10 + #2#14;
             |SI nConta [ 6;
                 |SI nValor > #408#9;   #1#95 = 0;  |FINSI;
             |SINO;
                 |SI nValor > #408#11;  #1#95 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#98 = (N\ #1#95 + #1#96);

     |SI #1#98 ! 0;
         nCasilla = 880;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nBase1  = ((#1#95 * 100) / 3) ! 2;
             nBase2  = ((#1#96 * 100) / 7) ! 2;
             nValor  = nBase1 + nBase2;
             nLimite = #408#9 - nBaseViv;
             |SI nLimite < 0;  nLimite = 0;  |FINSI;

             |SI nValor > nLimite;
                 nValor1 = nValor - nLimite;
                 |SI nBase1 ] nValor1;
                     nBase1  = nBase1 - nValor1;
                     nValor1 = 0;
                 |SINO;
                     nValor1 = nValor1 - nBase1;
                     nBase1  = 0;
                     nBase2  = nBase2  - nValor1;
                 |FINSI;

                 #1#95 = (N\ (nBase1 % 3));
                 #1#96 = (N\ (nBase2 % 7));
                 |SI #1#96 > #408#11;  #1#96 = #408#11;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     #1#98  = (N\ #1#94  + #1#95  + #1#96  + #1#97);
|FPRC;

|PROCESO Valencia;
     nComunidad = 17;

     |SI #1#104 ! 0;
         nCasilla = 887;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             |SI #2#53 > #408#9;  #1#104 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#105 ! 0;
         nCasilla = 888;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = #2#20 + #2#23;
             |SI nValor > #408#9;
                 #1#105 = 0;
             |FINSI;

             |SI #1#2 = "TITULAR   ";  nCas489T = #1#105;                 |FINSI;
             |SI #1#2 = "CONYUGE   ";  nCas489C = #1#105;                 |FINSI;
             |SI #1#2 = "CONJUNTA  ";  #1#105    = nCas489T + nCas489C;   |FINSI;

             |SI #1#2 = "CONJUNTAE  ";
                 |SI eaMuerto = "T";
                     #1#105 = nCas489C;
                 |SINO;
                     #1#105 = nCas489T;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#106 ! 0;
         nCasilla = 889;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = #2#20 + #2#23;
             |SI nValor > #408#9;  #1#106 = 0;  |FINSI;

             |SI #1#2 = "TITULAR   ";  nCas490T = #1#106;                 |FINSI;
             |SI #1#2 = "CONYUGE   ";  nCas490C = #1#106;                 |FINSI;
             |SI #1#2 = "CONJUNTA  ";  #1#106    = nCas490T + nCas490C;   |FINSI;

             |SI #1#2 = "CONJUNTAE  ";
                 |SI eaMuerto = "T";
                     #1#106 = nCas490C;
                 |SINO;
                     #1#106 = nCas490T;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#108 ! 0;
         nCasilla = 891;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#18 + #2#21;
             |SI nConta [ 6;
                 |SI nSuma > #408#11;  #1#108 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#13;  #1#108 = 0;  |FINSI;
             |FINSI;

             |SI #1#105 ! 0;  |O #1#106 ! 0;  |O #1#92 ! 0;
                 #1#108 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#109 ! 0;
         nCasilla = 892;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#18 + #2#21;
             |SI nConta [ 6;
                 |SI nSuma > #408#9;  #1#109 = 0;  |FINSI;
             |SINO;
                 |SI nSuma > #408#11; #1#109 = 0;  |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#114 ! 0;
         nCasilla = 897;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nValor = (#2#53 + #2#63) % 20;
             |SI #1#114 > nValor;  #1#114 = nValor;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #1#116 ! 0;
         nCasilla = 899;  |HAZ LeeCasillaAutonomica;

         |SI aChequeo = "S";
             nSuma = #2#18 + #2#21;
             |SI nConta [ 6;
                 |SI #2#53 > #408#9;   #1#116 = 0;  |FINSI;
             |SINO;
                 |SI #2#53 > #408#11;  #1#116 = 0;  |FINSI;
             |FINSI;

             |SI #2#63 > #408#13;  #1#116 = 0;  |FINSI;
         |FINSI;
     |FINSI;

     #1#117 = (N\ #1#99  + #1#100 + #1#101 + #1#102 + #1#103 + #1#104 + #1#105);
     #1#117 = (N\ #1#117 + #1#106 + #1#107 + #1#108 + #1#109 + #1#110 + #1#111);
     #1#117 = (N\ #1#117 + #1#112 + #1#113 + #1#114 + #1#115 + #1#116);
|FPRC;

|PROCESO AjusteAutono;
     aDef    = eaPathDef + "rem01043.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1043"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1034"#;  |FINSI;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic3@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic3@#"zdat1041"#;  |FINSI;

     |ABRE #3;
     #3#0 = #1001#0;
     #3#1 = #1001#1;
     #3#2 = #1001#2;
     |LEE 040#3=;
     |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     |CIERRA #3;

     nBaseViv = #3#37 + #3#39 + #3#41 + #3#42 + #3#43 + #3#44 + #3#46 + #3#48;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |ABRE #408;
         |HAZ Aragon;
         |CIERRA #408;

         |ABRE #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 040#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
         |CIERRA #2;

         |ABRE #408;
         |HAZ Andalucia;
         |HAZ Asturias;
         |HAZ Baleares;
         |HAZ Canarias;
         |HAZ Cantabria;
         |HAZ CastillaMancha;
         |HAZ CastillaLeon;
         |HAZ Catalunya;
         |HAZ Extremadura;
         |HAZ Galicia;
         |HAZ Madrid;
         |HAZ Murcia;
         |HAZ LaRioja;
         |HAZ Valencia;
         |CIERRA #408;

         |GRABA 020#1a;
         |LIBERA #1;
     |FINSI;
     |CIERRA #1;

     enSwAcum  = 0;
     enImporteA = #1#11 + #1#14 + #1#23 + #1#30 + #1#40 + #1#44 + #1#49;
     enImporteA = enImporteA    + #1#58 + #1#65 + #1#73 + #1#80 + #1#88;
     enImporteA = enImporteA    + #1#93 + #1#98 + #1#117;

     enBloque   = 24;
     eaCasilla  = "709";
     enImporte  = 0;
     |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic3@;
     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO Estatal;
     |ABRE #402;
     #402#0 = 0;
     |LEE 040#402=;
     |SI FSalida ! 0;  |DDEFECTO #402;  |FINSI;
     |CIERRA #402;

     |PARA nCampo4 = 41;  |SI nCampo4 ] 5;  |HACIENDO nCampo4 = nCampo4 - 4;
           |SI #402nCampo4 ! 0;
               nCampo1 = nCampo4 - 3;
               nCampo2 = nCampo4 - 2;
               |SI nLimite1 = 0;
                   nParte1 = #402nCampo2;
                   nResta1 = #402nCampo1;
                   nTipo1  = #402nCampo4;
               |SINO;
                   nLimite2 = #402nCampo1;
                   |SI nCuotaT [ nLimite1;  |Y nCuotaT > nLimite2;
                       nParte1 = #402nCampo2;
                       nResta1 = #402nCampo1;
                       nTipo1  = #402nCampo4;
                   |FINSI;
               |FINSI;
               nLimite1 = #402nCampo1;
           |FINSI;
     |SIGUE;

     |SI nCuotaT = 0;
         nParte1 = 0;
         nResta1 = 0;
         nTipo1  = #402#5;
     |FINSI;
|FPRC;

|PROCESO Autonomica;
     |ABRE #402;
     #402#0 = nCodAutonomico;
     |LEE 040#402=;
     |SI FSalida ! 0;
         #402#0 = 99;
         |LEE 040#402=;
         |SI FSalida ! 0;  |DDEFECTO #402;  |FINSI;
     |FINSI;
     |CIERRA #402;

     |PARA nCampo4 = 41;  |SI nCampo4 ] 5;  |HACIENDO nCampo4 = nCampo4 - 4;
           |SI #402nCampo4 ! 0;
               nCampo1 = nCampo4 - 3;
               nCampo2 = nCampo4 - 2;
               |SI nLimite1 = 0;
                   nParte2 = #402nCampo2;
                   nResta2 = #402nCampo1;
                   nTipo2  = #402nCampo4;
               |SINO;
                   nLimite2 = #402nCampo1;
                   |SI nCuotaT [ nLimite1;  |Y nCuotaT > nLimite2;
                       nParte2 = #402nCampo2;
                       nResta2 = #402nCampo1;
                       nTipo2  = #402nCampo4;
                   |FINSI;
               |FINSI;
               nLimite1 = #402nCampo1;
           |FINSI;
     |SIGUE;

     |SI nCuotaT = 0;
         nParte2 = 0;
         nResta2 = 0;
         nTipo2  = #402#5;
     |FINSI;
|FPRC;

|PROCESO Tabla;
     nParte1  = 0;
     nResta1  = 0;
     nTipo1   = 0;
     nParte2  = 0;
     nResta2  = 0;
     nTipo2   = 0;
     nLimite1 = 0;   |HAZ Estatal;
     nLimite1 = 0;   |HAZ Autonomica;
|FPRC;

|PROCESO TipoMedio;
     enBloque = 15; eaCasilla = "674"; |HAZ SacaImporte; nAnuHijos = enImporte;
     enBloque = 15; eaCasilla = "673"; |HAZ SacaImporte; nCuota56  = enImporte;
     enBloque = 13; eaCasilla = "630"; |HAZ SacaImporte; nCuota    = enImporte;
     |SI nCuota < 0;  nCuota = 0;  |FINSI;

     |SI nAnuHijos = 0;  |O nAnuHijos > nCuota;
         |SI nCuota56 ! 0;
             nCuotaT = nCuota + nCuota56;
         |SINO;
             nCuotaT = nCuota;
         |FINSI;

         |HAZ Tabla;

         |SI nCuota < 0;  nCuota = 0;  |FINSI;

         enSwAcum  = 0;
         enBloque  = 16;
         eaCasilla = "675";

         nValor2   = (nParte1 + (((nCuotaT - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nValor2   = (((nValor2 * 100) / nCuotaT) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
             enImporte = nValor1 ! 2;
         |SINO;
             enImporte = nValor2;
         |FINSI;

         nValor2   = (nParte2 + (((nCuotaT - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nValor2    = (((nValor2 * 100) / nCuotaT) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1    = nCuota % nValor2;
             enImporteA = nValor1 ! 2;
         |SINO;
             enImporteA = nValor2;
         |FINSI;
         |HAZ GrabaLineal;

         nValor58 = enImporte;
         nValor59 = enImporteA;

         enSwAcum   = 0;
         enImporteA = 0;
         enBloque   = 16;
         eaCasilla  = "TM1";
         enImporte  = (((nValor58 * 100) / nCuota) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum   = 0;
         enBloque   = 16;
         eaCasilla  = "TM2";
         enImporte  = (((nValor59 * 100) / nCuota) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         |SI nAnuHijos ! 0;
             enSwAcum   = 0;
             enBloque   = 15;
             eaCasilla  = "674";
             enImporte  = 0;
             enImporteA = 0;
             |HAZ GrabaLineal;
         |FINSI;
         nAnuHijos = 0;
     |SINO;
         |SI nCuota = 0;  |ACABA; |FINSI;

         enSwAcum   = 0;
         enBloque   = 15;
         eaCasilla  = "674";
         enImporte  = nAnuHijos;
         enImporteA = 0;
         |HAZ GrabaLineal;

         enSwAcum   = 0;
         enBloque   = 16;
         eaCasilla  = "675";
         enImporteA = 0;
         enImporte  = nCuota - nAnuHijos;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         nCuota1 = enImporte;

         nCuotaAnt = nCuota;
         nCuota    = nAnuHijos;
         nCuotaT   = nAnuHijos;
         |HAZ Tabla;

         || Calcula Cuota Estatal 1 Base

         nValor1   = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nBase1   = (nAnuHijos + (nCuota56 * (nAnuHijos / nCuotaAnt))) ! 2;
             nCuotaT  = nBase1;
             |HAZ Tabla;

             nValor1   = (nParte1 + (((nBase1 - nResta1) * nTipo1) / 100)) ! 2;
             nValor2   = (((nValor1 * 100) / nBase1) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         nVEstatal1 = nValor1 ! 2;

         || Calcula Cuota Autonomica 1 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nValor1   = (nParte2 + (((nBase1 - nResta2) * nTipo2) / 100)) ! 2;
             nValor2   = (((nValor1 * 100) / nBase1) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         nVAutonom1 = nValor1 ! 2;

         || Calcula Cuota Estatal 2 Base

         nCuota   = nCuota1;
         nCuotaT  = nCuota1;
         |HAZ Tabla;

         nValor1  = (nParte1 + (((nCuota - nResta1) * nTipo1) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nBase2    = (nCuota1 + (nCuota56 * (nCuota1 / nCuotaAnt))) ! 2;
             nCuotaT   = nBase2;
             |HAZ Tabla;

             nValor1   = (nParte1 + (((nBase2 - nResta1) * nTipo1) / 100)) ! 2;
             nValor2   = (((nValor1 * 100) / nBase2) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota1 % nValor2;
         |FINSI;
         nVEstatal2 = nValor1 ! 2;

         || Calcula Cuota Autonomica 2 Base

         nValor1   = (nParte2 + (((nCuota - nResta2) * nTipo2) / 100)) ! 2;
         |SI nCuota56 ! 0;
             nValor1   = (nParte2 + (((nBase2 - nResta2) * nTipo2) / 100)) ! 2;
             nValor2   = (((nValor1 * 100) / nBase2) - 0.0049) ! 2;
             |SI nValor2 < 0;  nValor2 = 0;  |FINSI;
             nValor1   = nCuota % nValor2;
         |FINSI;
         nVAutonom2 = nValor1 ! 2;

         enSwAcum   = 0;
         enBloque   = 16;
         eaCasilla  = "675";
         enImporte  = (nVEstatal1 + nVEstatal2) ! 2;
         nValor58   = enImporte;

         enImporteA = (nVAutonom1 + nVAutonom2) ! 2;
         nValor59   = enImporteA;
         |HAZ GrabaLineal;

         enImporteA = 0;
         enSwAcum   = 0;
         enBloque   = 16;
         eaCasilla  = "TM1";
         enImporte  = (((nValor58 * 100) / nCuotaAnt) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;

         enSwAcum  = 0;
         enBloque  = 16;
         eaCasilla = "TM2";
         enImporte = (((nValor59 * 100) / nCuotaAnt) - 0.0049) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;
         |HAZ GrabaLineal;
     |FINSI;
|FPRC;

|PROCESO Deduce;
     |SI nAcum = 0;     nAplicado = 0;  |ACABA;  |FINSI;
     |SI nLimiteT [ 0;  nAplicado = 0;  |ACABA;  |FINSI;

     nAcum = nAcum - nDeducido;
     |SI nAcum ] 0
         nAplicado = nDeducido;
     |SINO;
         nAplicado = nDeducido + nAcum;
         nAcum     = 0;
     |FINSI;

     nLimiteT = nLimiteT - nAplicado;
     |SI nLimiteT < 0;
         nAplicado = nAplicado + nLimiteT;
         nLimiteT  = 0;
     |FINSI;
|FPRC;

|PROCESO AjustaGeneral;
     nValor   = 0;
     enBloque = 18; eaCasilla = "681"; |HAZ SacaImporte; nValor = nValor + enImporte;
                                                         nValor = nValor + enImporteA;
     nLimiteT = nValor;

     enBloque = 19; eaCasilla = "683"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "687"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "689"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "691"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "693"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "695"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;
     enBloque = 20; eaCasilla = "697"; |HAZ SacaImporte; nValor = nValor - enImporte;
                                                         nValor = nValor - enImporteA;

     |SI nValor < 0;  nValor = 0;  |FINSI;

     nLimite25  = (nValor % 25) ! 2;
     nLimite35  = (nValor % 35) ! 2;
     nLimite45  = (nValor % 50) ! 2;
     nLimite50  = (nValor % 50) ! 2;
     nLimite70  = (nValor % 70) ! 2;
     nLimite81  = (nValor % 90) ! 2;
     nLimite100 = nValor;

                      nAcum     = nLimite35;
     |SI #1#111 = 2;  nAcum     = nLimite45;  |FINSI;

     nDeducido = #1#4;  |HAZ Deduce;  #1#4  = nAplicado;
     nDeducido = #1#7;  |HAZ Deduce;  #1#7  = nAplicado;
     nDeducido = #1#28; |HAZ Deduce;  #1#28 = nAplicado;
     nDeducido = #1#19; |HAZ Deduce;  #1#19 = nAplicado;
     nDeducido = #1#10; |HAZ Deduce;  #1#10 = nAplicado;
     nDeducido = #1#13; |HAZ Deduce;  #1#13 = nAplicado;
     nDeducido = #1#22; |HAZ Deduce;  #1#22 = nAplicado;
     nDeducido = #1#25; |HAZ Deduce;  #1#25 = nAplicado;
     nDeducido = #1#16; |HAZ Deduce;  #1#16 = nAplicado;
     nDeducido = #1#31; |HAZ Deduce;  #1#31 = nAplicado;
     nDeducido = #1#34; |HAZ Deduce;  #1#34 = nAplicado;
     nDeducido = #1#37; |HAZ Deduce;  #1#37 = nAplicado;
     nDeducido = #1#40; |HAZ Deduce;  #1#40 = nAplicado;
     nDeducido = #1#43; |HAZ Deduce;  #1#43 = nAplicado;
     nDeducido = #1#46; |HAZ Deduce;  #1#46 = nAplicado;
     nDeducido = #1#49; |HAZ Deduce;  #1#49 = nAplicado;

     nAcum   = nLimite50;
     nDeducido = #1#114; |HAZ Deduce;  #1#114 = nAplicado;

     nAcum   = nLimite70;
     nDeducido = #1#52; |HAZ Deduce;  #1#52 = nAplicado;
     #1#51 = (N\ #1#51 + #1#113);  #1#52 = (N\ #1#52 + #1#114);

                      nAcum     = nLimite70;
     |SI #1#112 = 2;  nAcum     = nLimite81;  |FINSI;

     nDeducido = #1#52;  |HAZ Deduce;  #1#52  = nAplicado;
     nDeducido = #1#55;  |HAZ Deduce;  #1#55  = nAplicado;
     nDeducido = #1#58;  |HAZ Deduce;  #1#58  = nAplicado;
     nDeducido = #1#61;  |HAZ Deduce;  #1#61  = nAplicado;
     nDeducido = #1#64;  |HAZ Deduce;  #1#64  = nAplicado;
     nDeducido = #1#67;  |HAZ Deduce;  #1#67  = nAplicado;
     nDeducido = #1#70;  |HAZ Deduce;  #1#70  = nAplicado;
     nDeducido = #1#73;  |HAZ Deduce;  #1#73  = nAplicado;
     nDeducido = #1#76;  |HAZ Deduce;  #1#76  = nAplicado;
     nDeducido = #1#79;  |HAZ Deduce;  #1#79  = nAplicado;

     nAcum   = nLimite50;
     nDeducido = #1#82;  |HAZ Deduce;  #1#82  = nAplicado;

     nAcum   = nLimite25;
     nDeducido = #1#85;  |HAZ Deduce;  #1#85  = nAplicado;

     nAcum   = nLimite100;
     nDeducido = #1#91;  |HAZ Deduce;  #1#91  = nAplicado;
     nDeducido = #1#94;  |HAZ Deduce;  #1#94  = nAplicado;
     nDeducido = #1#98;  |HAZ Deduce;  #1#98  = nAplicado;
     nDeducido = #1#102; |HAZ Deduce;  #1#102 = nAplicado;
     nDeducido = #1#106; |HAZ Deduce;  #1#106 = nAplicado;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 84;  |HACIENDO nCampo1 = nCampo1 + 3;
           nCampo2   = nCampo1 + 1;
           nCampo3   = nCampo1 + 2;
           #1nCampo3 = (N\ #1nCampo1 - #1nCampo2);
     |SIGUE;

     #1#96  = (N\ #1#93  - #1#94);
     #1#100 = (N\ #1#97  - #1#98);
     #1#104 = (N\ #1#101 - #1#102);
     #1#108 = (N\ #1#105 - #1#106);

     nSuma = 0;
     |PARA nCampo1 = 4;  |SI nCampo1 [ 85;  |HACIENDO nCampo1 = nCampo1 + 3;
           nSuma = nSuma + #1nCampo1;
     |SIGUE;

     #1#87 = nSuma;

     nValor1 = (nSuma % 67) ! 2;
     nValor2 = nSuma - nValor1;

     #1#88  = nValor1;
     #1#89  = nValor2;

     enSwAcum   = 0;
     enBloque   = 21;
     eaCasilla  = "699";
     enImporte  = nValor1;
     enImporteA = nValor2;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO AjustaDona;
     nAjuste15 = (#2#53 + #2#63) % 15;
     nValor    = #1#91;
     |SI nValor > nAjuste15;  |Y nValor > 0;
         #1#91 = nAjuste15;
         #1#92 = (N\ #1#91 % 30);
     |FINSI;

     #1#11 = (N\ (((#2#53 + #2#63) % 10)) - #1#91 ! 2);
     |SI #1#11 < 0;  #1#11 = 0;  |FINSI;

     nExceso  = #1#11;

     nValor30 = #1#73;
     nExceso  = nExceso - #1#73;
     |SI nExceso [ 0;
         nValor30 = #1#73 + nExceso;
         nExceso  = 0;
     |FINSI;

     nValor1 = #1#53;
     nExceso = nExceso - #1#53;
     |SI nExceso [ 0;
         nValor1 = #1#53 + nExceso;
         nExceso = 0;
     |FINSI;

     nValor2 = #1#52;
     nExceso = nExceso - #1#52;
     |SI nExceso [ 0;
         nValor2 = #1#52 + nExceso;
         nExceso = 0;
     |FINSI;

     #1#4 = #1#3;
     nExceso = nExceso - #1#4;
     |SI nExceso [ 0;
         #1#4 = (N\ #1#4 + nExceso);
         nExceso = 0;
     |FINSI;

     nValor3 = #1#51;
     nExceso = nExceso - #1#51;
     |SI nExceso [ 0;
         nValor3 = #1#51 + nExceso;
         nExceso = 0;
     |FINSI;

     #1#7 = (N\ nValor1 + nValor2 + nValor3 + nValor30);
     #1#5 = (N\ (#1#4 % 15) ! 2);
     #1#9 = (N\ ((nValor1 % 25) + (nValor2 % 20) + (nValor3 % 10) + (nValor30 % 30)) ! 2);

     nValor  = #1#5;
     nValor1 = (nValor % 67) ! 2;
     nValor2 = nValor - nValor1;
     #1#54   = nValor1;
     #1#55   = nValor2;


     nValor  = #1#92 + #1#9;
     nValor1 = (nValor % 67) ! 2;
     nValor2 = nValor - nValor1;
     #1#56   = nValor1;
     #1#57   = nValor2;

     enSwAcum   = 0;
     enBloque   = 19;
     eaCasilla  = "683";
     enImporte  = #1#54;
     enImporteA = #1#55;
     |HAZ GrabaLineal;

     enSwAcum   = 0;
     enBloque   = 19;
     eaCasilla  = "685";
     enImporte  = #1#56;
     enImporteA = #1#57;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO Deducciones;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1041"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1034"#;  |FINSI;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ AjustaDona;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01042.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1042"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |HAZ AjustaGeneral;
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;

|FPRC;

|PROCESO AjustaDivid;
     enBloque = 25; eaCasilla = "710"; |HAZ SacaImporte; nLimite = enImporte + enImporteA;

     |SI #1#30 ! 0;
         #1#31 = #1#30;
         |SI #1#31 > nLimite;
             #1#31 = nLimite;
             #1#32 = (N\ #1#30 - #1#31);
             nLimite = 0;
         |SINO;
             nLimite = nLimite - #1#31;
         |FINSI;
     |FINSI;

     |SI #1#33 ! 0;
         #1#34 = #1#33;
         |SI #1#34 > nLimite;
             #1#34   = nLimite;
             #1#35   = (N\ #1#33 - #1#34);
             nLimite = 0;
         |SINO;
             nLimite = nLimite - #1#34;
         |FINSI;
     |FINSI;

     #1#36 = (N\ #1#31 + #1#34);

     enSwAcum   = 0;
     enBloque   = 28;
     eaCasilla  = "729";
     enImporte  = #1#36;
     enImporteA = 0;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO DeducDivid;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1041"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |SI #1#30 ! 0;  |O #1#33 ! 0;
             |HAZ AjustaDivid;
             |GRABA 020#1a;
         |FINSI;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO GrabaCeuta;
     enBloque  = 22;
     eaCasilla = "705";
     |HAZ SacaImporte;

     nValor1 = nCuotaIntegra % 50;
     nValor2 = enImporte + enImporteA;

     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1041"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 101#1=;
     |SI FSalida = 0;
         |SI nValor2 > nValor1;
             #1#70   = nValor1;
         |SINO;
             #1#70   = nValor2;
         |FINSI;

         nValor  = #1#70;
         nValor1 = (nValor % 67) ! 2;
         nValor2 = nValor - nValor1;

         #1#71   = nValor1;
         #1#72   = nValor2;

         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;

     enSwAcum   = 0;
     enBloque   = 22;
     eaCasilla  = "705";
     enImporte  = #1#71;
     enImporteA = #1#72;
     |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO GravamenEsp;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     enSwAcum   = 0;
     enBloque   = 17;
     eaCasilla  = "679";
     enImporte  = 0;
     enImporteA = 0;
     |HAZ GrabaLineal;

     enBloque = 14; eaCasilla = "640"; |HAZ SacaImporte; nBaseEsp = enImporte;

     |SI #1#94 = "N";
         enSwAcum   = 0;
         enBloque   = 17;
         eaCasilla  = "679";
         enImporte  = nBaseEsp % 9.06;
         enImporteA = nBaseEsp % 5.94;
         |HAZ GrabaLineal;
     |SINO;
         enSwAcum   = 0;
         enBloque   = 17;
         eaCasilla  = "679";
         enImporte  = nBaseEsp % 15;
         enImporteA = 0;
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO AdqVivienda;
     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1011"#;  |FINSI;

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic2@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1001#0;
     #2#1 = #1001#1;
     #2#2 = #1001#2;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     |SI #1#16 < "04.05.1998";  |Y #1#16 ! "01.01.0000";
         enBloque = 16; eaCasilla = "675";  |HAZ SacaImporte;
         nValor1  = enImporte;
         nValor2  = enImporteA;

         enBloque = 13; eaCasilla = "630";  |HAZ SacaImporte;

         nTipoMedio1 = (((nValor1) * 100 / enImporte) - 0.0049) ! 2;
         |SI nTipoMedio1 < 0;  nTipoMedio1 = 0;  |FINSI;

         nTipoMedio2 = (((nValor2) * 100 / enImporte) - 0.0049) ! 2;
         |SI nTipoMedio2 < 0;  nTipoMedio2 = 0;  |FINSI;

         nTipoMedio  = nTipoMedio1 + nTipoMedio2;

         nValor  = #0#49;

         nLimite = #401#36;
         |SI nConta ] 7;        nLimite = #401#37;  |FINSI;
         |SI nValor > nLimite;  nValor  = nLimite;  |FINSI;

         nValor  = (nValor + #1#14 - #1#15) % nTipoMedio;

         nValor2 = #2#53 + #2#63 + #2#17;

         nLimite    = nValor2 % 30;
         |SI nLimite < 0;  nLimite = 0;  |FINSI;

         nValorZ    = #0#50 - #0#49;
         |SI nLimite < nValorZ;  nValorZ = nLimite;  |FINSI;

         nValor1    = nValorZ % 15;

         nSumaAyer = nValor + nValor1;
         nSumaHoy  = #0#12 + #0#13 + #0#28 + #0#29;
         nSumaHoy  = nSumaHoy + #0#60 + #0#61 + #0#68 + #0#69;

         nDiferencia = nSumaAyer - nSumaHoy;
         |SI nDiferencia < 0;  nDiferencia = 0;  |FINSI;

         |SI nSumaHoy > 0;
             enSwAcum   = 0;
             enBloque   = 28;
             eaCasilla  = "735";
             enImporte  = nDiferencia;
             enImporteA = 0;
             |HAZ GrabaLineal;
         |FINSI;
     |FINSI;

     |DESCARGA_DEF #datfic2@;
     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO DobleInternacional;
     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic1@;

     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nValor = #1#70 + #1#71 + #1#72 + #1#73;
     |SI nValor ! 0;
         enBloque   = 13; eaCasilla = "630";  |HAZ SacaImporte; nValor54 = enImporte;
         enBloque   = 14; eaCasilla = "640";  |HAZ SacaImporte; nValor55 = enImporte;
         enBloque   = 16; eaCasilla = "675";  |HAZ SacaImporte; nValorZ  = enImporte;
                                                                nValorB  = enImporteA;
         enBloque   = 7; eaCasilla  = "476";  |HAZ SacaImporte; nValor35 = enImporte;
         enBloque   = 17; eaCasilla = "679";  |HAZ SacaImporte; nValorC  = enImporte;
                                                                nValorD  = enImporteA;

         nValor91  = 0;
         enBloque  = 19; eaCasilla = "683";  |HAZ SacaImporte; nValor91 = enImporte + enImporteA;
         enBloque  = 19; eaCasilla = "685";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "687";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "689";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "691";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "693";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "695";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 20; eaCasilla = "697";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 21; eaCasilla = "699";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 21; eaCasilla = "701";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 21; eaCasilla = "703";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 22; eaCasilla = "705";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 23; eaCasilla = "707";  |HAZ SacaImporte; nValor91 = nValor91  + enImporte + enImporteA;
         enBloque  = 24; eaCasilla = "709";  |HAZ SacaImporte; nValor91 = nValor91  + enImporteA;

         nValorE = nValorZ + nValorB;
         nValorF = nValorC + nValorD;
         nValorG = nValorE + nValorF;
         nValorH = nValorG - nValor91;
         |SI nValorH < 0;  nValorH = 0;  |FINSI;

         nValorP1 = ((((nValorH * (nValorE / nValorG)) * 100) / nValor54) - 0.0049) ! 2;
         nValorP2 = ((((nValorH * (nValorF / nValorG)) * 100) / nValor55) - 0.0049) ! 2;
         nValorB3 = (nValor54 * #1#70) / nValor35;

         |SI nValorB3 > nValor54;
             nValorB3 = nValor54;
         |FINSI;

         nValorC1 = #1#71;
         nValor   = ((nValorB3 % nValorP1) - 0.01) ! 2;
         |SI nValor < 0;  nValor = 0;  |FINSI;
         |SI nValor < nValorC1;
             nValorC1 = nValor;
         |FINSI;

         nValorC2 = #1#72;
         nValorB4 = #1#73;

         |SI nValorB4 > nValor55;
             nValorB4 = nValor55;
         |FINSI;

         nValor   = ((nValorB4 % nValorP2) - 0.01) ! 2;
         |SI nValor < 0;  nValor = 0;  |FINSI;
         |SI nValor < nValorC2;
             nValorC2 = nValor;
         |FINSI;

         enImporte = (nValorC1 + nValorC2) ! 2;
         |SI enImporte < 0;  enImporte = 0;  |FINSI;

         enSwAcum   = 0;
         enBloque   = 28;
         eaCasilla  = "730";
         enImporteA = 0;
         |HAZ GrabaLineal;
     |FINSI;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO CompensacionAlq;
     nValor = enImporte;

||---- Primer Condicionante

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1018"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nValor1 = #1#15 + #1#16 + #1#17 + #1#18 - #1#19 + #1#7  + #1#8;
     nValor1 = nValor1 + #1#11 - #1#13;
     nValor1 = nValor1 % 10;

     |SI #1#20 < nValor1;  nValor = 0;  |FINSI;

     |DESCARGA_DEF #datfic1@;

||---- Segundo Condicionante

     aDef    = eaPathDef + "rem01034.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1034"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nValor1 = #1#18 + #1#21 - #1#24 - #1#32;

     |SI nConta < 7;
         |SI nValor1 ] #401#29;  nValor = 0;  |FINSI;
     |SINO;
         |SI nValor1 ] #401#30;  nValor = 0;  |FINSI;
     |FINSI;

     |DESCARGA_DEF #datfic1@;

     enSwAcum   = 0;
     enBloque   = 28;
     eaCasilla  = "733";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;
|FPRC;

|PROCESO Empresarial1;
     |SI #1#5 ! "4";  |Y #1#5 ! "5";
         nSwEmpresarial = 1;
     |SINO;
         nProfesional =  nProfesional + #1#35;
     |FINSI;

     |SI #1#35 < 0;
         nSwEmpresarial = 1;
     |FINSI;
|FPRC;

|DEFBUCLE rem01014;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, Empresarial1;
|FIN;

|PROCESO Empresarial5;
     |SI #1#41 < 0;
         nSwEmpresarial = 1;
     |FINSI;
|FPRC;

|DEFBUCLE rem01019;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, Empresarial5;
|FIN;

|PROCESO Empresarial7;
     nSwEmpresarial = 1;
|FPRC;

|DEFBUCLE rem01021;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, Empresarial7;
|FIN;

|PROCESO Empresarial8;
     |SI #1#13 ! 0;
         nSwEmpresarial = 1;
     |FINSI;
|FPRC;

|DEFBUCLE rem01022;
     #1#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, Empresarial8;
|FIN;

|PROCESO rem01013_6;
     nPisos = nPisos + 1;
     nImput = nImput + #0#7;
|FPRC;

|DEFBUCLE rem01013_6;
     #0#1004;
     ;
     #1001#0, #1001#1, #1001#2, 001;
     #1001#0, #1001#1, #1001#2, 999;
     ;
     NULL, rem01013_6;
|FIN;

|PROCESO SeleccionRenta;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1010"#;  |FINSI;

     #1001#5 = "100";
     #1001#6 = "N";
     #1001#4 = "N";

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     enBloque = 29; eaCasilla = "738"; |HAZ SacaImporte;

     |SI #1#22 > #401#71;  |Y enImporte = 0;
         #1001#4 = "S";
     |FINSI;

     |SI nConta ! 7;  |Y nConta ! 8;
         |SI #1#19 > 1;
             nPagadoresC = nPagadoresC + #1#19;
         |FINSI;
     |FINSI;

     nPagadores = #1#19;
     nTotalPag  = #1#21;

     |DESCARGA_DEF #datfic1@;

     nValor = 0;
     enBloque = 12; eaCasilla = "600"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     |SI enImporte ! 0;
         |SI nConta ! 7;  |Y nConta ! 8;
             nPagadores  = nPagadores + 1;
         |SINO;
             nPagadoresC = nPagadoresC + 1;
         |FINSI;
         nTotalPag  = nTotalPag + enImporte;
     |FINSI;

     enBloque = 1; eaCasilla = "001"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "005"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 1; eaCasilla = "006"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI nConta ! 7;  |Y nConta ! 8;
         |SI nValor ] #401#70;  #1001#4 = "S";  |FINSI;

         |SI nPagadores > 1;
             |SI nTotalPag > #401#72;
                 |SI nValor > #401#71;
                     #1001#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nValor ] #401#70;  #1001#4 = "S";  |FINSI;

         |SI nPagadoresC > 1;
             |SI nTotalPag > #401#72;
                 |SI nValor > #401#71;
                     #1001#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1011"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     nSuma1 = #1#17;

     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01014.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1014"#;  |FINSI;

     nSwEmpresarial = 0;
     nProfesional   = 0;
     |BUCLE rem01014;

     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01019.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1019"#;  |FINSI;

     |BUCLE rem01019;

     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01021.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1021"#;  |FINSI;

     |BUCLE rem01021;

     |DESCARGA_DEF #datfic1@;

     aDef    = eaPathDef + "rem01022.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1022"#;  |FINSI;

     |BUCLE rem01022;

     |DESCARGA_DEF #datfic1@;

     |SI nSuma1 ] 2;
         #1001#4 = "S";
     |SINO;
         enBloque = 4; eaCasilla = "090"; |HAZ SacaImporte;
         |SI enImporte > #401#74;  #1001#4 = "S";  |FINSI;
     |FINSI;

     nContaAct = 0;

     |SI nSwEmpresarial ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     enBloque = 5; eaCasilla = "170"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     enBloque = 5; eaCasilla = "199"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1033"#;  |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     #1#1 = #1001#1;
     #1#2 = #1001#2;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#4  ! 0;  |O #1#6  ! 0;  |O #1#12 ! 0; |O #1#16 ! 0;  |O #1#18 ! 0;
      |O #1#22 ! 0;  |O #1#28 ! 0;  |O #1#30 ! 0; |O #1#32 ! 0;  |O #1#34 ! 0;
      |O #1#40 ! 0;  |O #1#42 ! 0;
         nContaAct = nContaAct + 2;
     |FINSI;

     nSuma1 = #1#3 + #1#5;

     |DESCARGA_DEF #datfic1@;

     enBloque = 7; eaCasilla = "470"; |HAZ SacaImporte; nValor29 = enImporte;
     enBloque = 8; eaCasilla = "477"; |HAZ SacaImporte; nValor36 = enImporte;
     nSuma = nValor29 + nValor36 + nProfesional;
     |SI nSuma = nSuma1;
         |SI nSuma ! 0;
             |SI nSuma > #401#76;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nSuma ! 0;
             |SI nSuma > #401#77;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor = 0;
     enBloque = 6; eaCasilla = "220"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "221"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "222"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "223"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "224"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "225"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     enBloque = 6; eaCasilla = "226"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI nValor ! 0;  nContaAct = 2;  |FINSI;

     #1001#5 = "100";
     |SI nContaAct > 1;  #1001#4 = "S";  |FINSI;

     enBloque = 3; eaCasilla = "079"; |HAZ SacaImporte;
     |SI enImporte > #401#78;  #1001#4 = "S";  |FINSI;

     enBloque = 6; eaCasilla = "245"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 6; eaCasilla = "255"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 6; eaCasilla = "265"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 6; eaCasilla = "275"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";    |FINSI;

     enBloque = 12; eaCasilla = "550"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     enBloque = 12; eaCasilla = "555"; |HAZ SacaImporte;
     |SI enImporte > 0;  #1001#4 = "S";  |FINSI;

     aDef    = eaPathDef + "rem01013.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1013"#;  |FINSI;

     nPisos = 0;
     nImput = 0;
     |BUCLE rem01013_6;
     |SI nPisos ] 2;
         nImput = #401#79 + 1;
     |FINSI;

     |DESCARGA_DEF #datfic0@;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1012"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     nValor = #0#13;
     |SI nValor > #401#73;  #1001#4 = "S";  |FINSI;

     nValor = #0#5 + #0#17 + nImput;
     |SI nValor > #401#79;  #1001#4 = "S";  |FINSI;

     |DESCARGA_DEF #datfic0@;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1018"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |SI #0#18 ! 0;
         #1001#4 = "S";
     |FINSI;

     |DESCARGA_DEF #datfic0@;

     enBloque = 4;  eaCasilla = "080"; |HAZ SacaImporte;
     |SI enImporte > 0;
         aDef    = eaPathDef + "rem01034.mas";
         |CARGA_DEF aDef, datfic0@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + aDef;
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1034"#;  |FINSI;

         aDef    = eaPathDef + "rem01018.mas";
         |CARGA_DEF aDef, datfic1@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + aDef;
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |SI enNomeDat = 1;  |NOME_DAT #datfic1@#"zdat1018"#;  |FINSI;

         aDef    = eaPathDef + "rem01033.mas";
         |CARGA_DEF aDef, datfic2@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def " + aDef;
             |MENAV aAlfa;
             |ACABA;
         |FINSI;

         |SI enNomeDat = 1;  |NOME_DAT #datfic2@#"zdat1033"#;  |FINSI;

         |ABRE #0;
         #0#0 = #1001#0;
         #0#1 = #1001#1;
         #0#2 = #1001#2;
         |LEE 040#0=;
         |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
         |CIERRA #0;

         |ABRE #1;
         #1#0 = #1001#0;
         #1#1 = #1001#1;
         #1#2 = #1001#2;
         |LEE 040#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
         |CIERRA #1;

         |ABRE #2;
         #2#0 = #1001#0;
         #2#1 = #1001#1;
         #2#2 = #1001#2;
         |LEE 040#2=;
         |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
         |CIERRA #2;

         enBloque = 3;  eaCasilla = "079"; |HAZ SacaImporte;
         nValor   = #1#15  + #1#16 + #1#19 + #1#7 + #1#8;
         nValor   = nValor + #1#11 + #1#13 + #0#74;
         nValor   = nValor + #2#27 - #2#28 + #2#31 - #2#32;
         nValor   = nValor + enImporte;

         |SI nValor > 1000;
             #1001#4 = "S";
         |FINSI;

         |DESCARGA_DEF #datfic2@;
         |DESCARGA_DEF #datfic1@;
         |DESCARGA_DEF #datfic0@;
     |FINSI;

     #1001#13 = #1001#5;
|FPRC;

|PROCESO Final;
     aDef    = eaPathDef + "rem01041.mas";
     |CARGA_DEF aDef, datfic0@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #datfic0@#"zdat1041"#;  |FINSI;

     |ABRE #0;
     #0#0 = #1001#0;
     #0#1 = #1001#1;
     #0#2 = #1001#2;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |HAZ TipoMedio;
     |HAZ GravamenEsp;

     nValor    = 0;
     nValorZ   = 0;
     enBloque  = 16; eaCasilla = "675"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
                                                          nValorZ = nValorZ + enImporteA;
     enBloque  = 17; eaCasilla = "679"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
                                                          nValorZ = nValorZ + enImporteA;

     enSwAcum   = 0;
     enBloque   = 18;
     eaCasilla  = "681";
     enImporte  = nValor  ! 2;
     enImporteA = nValorZ ! 2;
     |HAZ GrabaLineal;
     nCuotaIntegra = enImporte + enImporteA;

     |HAZ GrabaCeuta;
     |HAZ Deducciones;
     |HAZ AjusteAutono;

     nValor  = 0;
     nValorZ = 0;
     enBloque = 18; eaCasilla = "681"; |HAZ SacaImporte; nValor  = enImporte;
                                                         nValorZ = enImporteA;
     enBloque = 19; eaCasilla = "683"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 19; eaCasilla = "685"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "687"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "689"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "691"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "693"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "695"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 20; eaCasilla = "697"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 21; eaCasilla = "699"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 21; eaCasilla = "703"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 21; eaCasilla = "701"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 22; eaCasilla = "705"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 23; eaCasilla = "707"; |HAZ SacaImporte; nValor  = nValor  - enImporte;
                                                         nValorZ = nValorZ - enImporteA;
     enBloque = 24; eaCasilla = "709"; |HAZ SacaImporte; nValorZ = nValorZ - enImporteA;
     |SI nValor  < 0;  nValor  = 0;  |FINSI;
     |SI nValorZ < 0;  nValorZ = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 25;
     eaCasilla  = "710";
     enImporte  = nValor;
     enImporteA = nValorZ;
     |HAZ GrabaLineal;

     nValor  = 0;
     nValorZ = 0;
     enBloque = 25; eaCasilla = "710"; |HAZ SacaImporte; nValor  = enImporte;
                                                         nValorZ = enImporteA;
     enBloque = 26; eaCasilla = "712"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
     enBloque = 26; eaCasilla = "713"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
     enBloque = 26; eaCasilla = "714"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
                                                         nValorZ = nValorZ + enImporteA;
     enBloque = 26; eaCasilla = "715"; |HAZ SacaImporte; nValor  = nValor  + enImporte;
                                                         nValorZ = nValorZ + enImporteA;
     enBloque = 26; eaCasilla = "718"; |HAZ SacaImporte; nValorZ = nValorZ + enImporteA;
     enBloque = 26; eaCasilla = "719"; |HAZ SacaImporte; nValorZ = nValorZ + enImporteA;

     enSwAcum   = 0;
     enBloque   = 26;
     eaCasilla  = "720";
     enImporte  = nValor;
     enImporteA = nValorZ;
     |HAZ GrabaLineal;

     enSwAcum   = 0;
     enBloque   = 27;
     eaCasilla  = "722";
     enImporte  = nValor + nValorZ;
     enImporteA = 0;
     |HAZ GrabaLineal;

     |HAZ DeducDivid;
     |HAZ AdqVivienda;

     enBloque = 28; eaCasilla = "730"; |HAZ SacaImporte;
     |SI enImporte = 0;
         |HAZ DobleInternacional;
     |FINSI;

     enBloque = 28; eaCasilla = "733"; |HAZ SacaImporte;
     |SI enImporte ! 0;
         |HAZ CompensacionAlq;
     |FINSI;

     nValor = 0;
     enBloque = 27; eaCasilla = "722"; |HAZ SacaImporte; nValor = enImporte;
     enBloque = 28; eaCasilla = "729"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "730"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "731"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "732"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "733"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "735"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque = 28; eaCasilla = "736"; |HAZ SacaImporte; nValor = nValor - enImporte;
     |SI nValor < 0;  nValor = 0;  |FINSI;

     enSwAcum   = 0;
     enBloque   = 28;
     eaCasilla  = "737";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     nValor = 0;
     enBloque = 29; eaCasilla = "738"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "739"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "740"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "741"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "742"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "743"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "744"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "745"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "746"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "747"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "748"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;
     enBloque = 29; eaCasilla = "749"; |HAZ SacaImporte; nValor = (nValor + enImporte) ! 2;

     enSwAcum   = 0;
     enBloque   = 29;
     eaCasilla  = "750";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     enBloque  = 28; eaCasilla = "737"; |HAZ SacaImporte; nValor = enImporte - nValor;

     enSwAcum   = 0;
     enBloque   = 30;
     eaCasilla  = "755";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     enBloque   = 30; eaCasilla = "756"; |HAZ SacaImporte; nValor = nValor - enImporte;
     enBloque   = 30; eaCasilla = "757"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque   = 30; eaCasilla = "758"; |HAZ SacaImporte; nValor = nValor + enImporte;
     enBloque   = 30; eaCasilla = "759"; |HAZ SacaImporte; nValor = nValor + enImporte;

     enSwAcum   = 0;
     enBloque   = 30;
     eaCasilla  = "760";
     enImporte  = nValor;
     enImporteA = 0;
     |HAZ GrabaLineal;

     |DESCARGA_DEF #datfic0@;
|FPRC;

|PROCESO EsIndividual;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, datfic1@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #1;
     #1#0 = #1001#0;
     |LEE 101#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #1#40 = "    ";  #1#40 = "0000";  |FINSI;

     |SI nSwConjunta = 0;  |Y #1#40 = "0000";  |Y nConta = 7;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI nSwConjuntaE = 0;  |Y nConta = 8;
         eaLiquida = #1001#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |DESCARGA_DEF #datfic1@;
|FPRC;

|PROCESO Bloque6;
     |HAZ CalculaG;

     nMinFam = 0;

     |ABRE #999;

     |SELECT #2#999;
     #999#1 = "CONYUGE   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwConyuge = 0;
     |SI #999#6 ! 0;  nSwConyuge = 1;  |FINSI;

     |SELECT #2#999;
     #999#1 = "TITULAR   ";
     |LEE 040#999=;
     |SI FSalida  ! 0;  |DDEFECTO #999;  |FINSI;

     nSwTitular = 0;
     |SI #999#6 ! 0;  nSwTitular = 1;  |FINSI;

     |CIERRA #999;

     |DDEFECTO #1001;
     FSalida      = 0;
     #1001#0      = enEmpresa;
     #1001#1      = enComplementaria;
     nLimite1     = 0;
     nLimite2     = 0;
     nValorTit    = 0;
     nValorCon    = 0;
     nCompeT      = 0;
     nCompeC      = 0;
     nSwConjunta  = 0;
     nSwConjuntaE = 0;
     nCas489T     = 0;
     nCas489C     = 0;
     nCas490T     = 0;
     nCas490C     = 0;
     nMinFamE     = #401#10;
     nSwBorrar1   = 0;
     nSwBorrar2   = 0;
     nPagadoresC  = 0;
     aCalcP       = "";
     nCalcP       = 0;
     nRedTrab1    = 0;
     nRedTrab2    = 0;
     nRedTrab3    = 0;
     nRedTrab4    = 0;
     nRedTrab5    = 0;
     nRedTrab6    = 0;
     aProlon1     = "";
     aProlon2     = "";
     aProlon3     = "";
     aProlon4     = "";
     aProlon5     = "";
     aProlon6     = "";
     aMovili1     = "";
     aMovili2     = "";
     aMovili3     = "";
     aMovili4     = "";
     aMovili5     = "";
     aMovili6     = "";
     nEjerMo1     = 0;
     nEjerMo2     = 0;
     nEjerMo3     = 0;
     nEjerMo4     = 0;
     nEjerMo5     = 0;
     nEjerMo6     = 0;
     nRentas1     = 0;
     nRentas2     = 0;
     nRentas3     = 0;
     nRentas4     = 0;
     nRentas5     = 0;
     nRentas6     = 0;
     nRdtosTrab1  = 0;
     nRdtosTrab2  = 0;
     nRdtosTrab3  = 0;
     nRdtosTrab4  = 0;
     nRdtosTrab5  = 0;
     nRdtosTrab6  = 0;
     nRdtosTrab7  = 0;
     nActivo1     = 0;
     nActivo2     = 0;
     nActivo3     = 0;
     nActivo4     = 0;
     nActivo5     = 0;
     nActivo6     = 0;
     nRdtosTrab   = 0;
     nCas929      = 0;
     nCas930      = 0;
     nCas931      = 0;
     nCas931M     = 0;
     nCas932      = 0;
     nCas933      = 0;
     nCas934      = 0;
     nCas934M     = 0;

     nParQueVieneT = 0;
     nParQueVieneC = 0;

     |PARA nConta = 1;  |SI nConta [ 8;  |HACIENDO nConta = nConta + 1;
           |SI nConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI nConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI nConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI nConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI nConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI nConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI nConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI nConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;

           |LEE 101#1001=;
           |SI FSalida ! 0;  |Y nConta = 2;  |Y nSwConyuge = 1;
                #1001#0    = enEmpresa;
                #1001#1    = enComplementaria;
                #1001#2    = "CONYUGE   ";
                nSwBorrar2 = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida ! 0;  |Y nConta = 1;  |Y nSwTitular = 1;
                #1001#0    = enEmpresa;
                #1001#1    = enComplementaria;
                #1001#2    = "TITULAR   ";
                nSwBorrar1 = 1;
                |GRABA 020#1001b;
            |FINSI;

            |SI FSalida = 0;
                nPasada = 0;   |HAZ CalculaI;
                               |HAZ Trabajo;

                |GRABA 020#1001a;
                |LIBERA #1001;
            |FINSI;
     |SIGUE;

     |PARA nConta = 1;  |SI nConta [ 8;  |HACIENDO nConta = nConta + 1;
           |SI nConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI nConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI nConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI nConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI nConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI nConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI nConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI nConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida = 0;
                              |HAZ CalculaH2;
               nPasada  = 1;  |HAZ CalculaI;
                              |HAZ CalculaH;
               nSwPasar = 0;  |HAZ CalculaPension;
           |FINSI;
     |SIGUE;

     |PARA nConta = 1;  |SI nConta [ 8;  |HACIENDO nConta = nConta + 1;
           |SI nConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI nConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI nConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI nConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI nConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI nConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI nConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI nConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida = 0;
               |HAZ  PensionAdicio;
           |FINSI;
     |SIGUE;

     |PARA nConta = 1;  |SI nConta [ 8;  |HACIENDO nConta = nConta + 1;
           |SI nConta = 1;   #1001#2 = "TITULAR   ";  |FINSI;
           |SI nConta = 2;   #1001#2 = "CONYUGE   ";  |FINSI;
           |SI nConta = 3;   #1001#2 = "1 FAMILIAR";  |FINSI;
           |SI nConta = 4;   #1001#2 = "2 FAMILIAR";  |FINSI;
           |SI nConta = 5;   #1001#2 = "3 FAMILIAR";  |FINSI;
           |SI nConta = 6;   #1001#2 = "4 FAMILIAR";  |FINSI;
           |SI nConta = 7;   #1001#2 = "CONJUNTA  ";  |FINSI;
           |SI nConta = 8;   #1001#2 = "CONJUNTAE ";  |FINSI;
           |LEE 101#1001=;
           |SI FSalida = 0;
               nSwPasar = 1;
               |HAZ CalculaPension;
               |HAZ CalculaJ;
               |HAZ CalculaAnexoA;
               |HAZ Final;
               |HAZ CalculaF;
               |HAZ SeleccionRenta;

                enBloque  = 30; eaCasilla = "760"; |HAZ SacaImporte;
                #1001#3  = enImporte;
                #1001#15 = enImporte;
                #1001#16 = enImporte;

                |GRABA 020#1001a;
                |LIBERA #1001;

                |SI nConta ] 7;
                    |HAZ EsIndividual;
                |FINSI;
            |FINSI;

            |SI nSwBorrar1 = 1; |Y nConta = 1;
                eaLiquida = #1001#2;
                |HAZ BorraLiquidacion;
                eaLiquida = "";
            |FINSI;

            |SI nSwBorrar2 = 1; |Y nConta = 2;
                eaLiquida = #1001#2;
                |HAZ BorraLiquidacion;
                eaLiquida = "";
            |FINSI;
     |SIGUE;
|FPRC;
