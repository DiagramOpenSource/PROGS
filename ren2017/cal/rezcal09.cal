|FICHEROS;
     rem00903 #903;

     rem00100@ #110;

     rem01010@ #10;
     rem01011@ #11;
     rem01012@ #12;
     rem01014@ #14;
     rem01018@ #18;
     rem01033@ #33;
     rem01035@ #35;
     rem01037@ #37;
     rem01045@ #45;
     rem01047@ #47;
     rem01054@ #54;
     rem01055@ #55;
     rem01056@ #56;

     &refere1@ #101;
     &refere2@ #102;
     &refere3@ #103;
|FIN;

|VARIABLES;
     aDTit               = "";
     aHTit               = "";
     aCas                = "";

     nCas0402            = 0;
     nCas0413            = 0;
     nCas0403_T          = 0;
     nCas0403_C          = 0;
     nCas0403_1          = 0;
     nCas0403_2          = 0;
     nCas0403_3          = 0;
     nCas0403_4          = 0;
     nCas0406            = 0;
     nCas0416            = 0;
     nCas0424            = 0;
     nCas0407_T          = 0;
     nCas0407_C          = 0;
     nCas0407_1          = 0;
     nCas0407_2          = 0;
     nCas0407_3          = 0;
     nCas0407_4          = 0;
     nCas0415_T          = 0;
     nCas0415_C          = 0;
     nCas0415_1          = 0;
     nCas0415_2          = 0;
     nCas0415_3          = 0;
     nCas0415_4          = 0;
     nCas0415            = 0;
     nCas0444T           = 0;
     nCas0444C           = 0;
     nCas0475            = 0;

     nCas0410            = 0;
     nCas1118_T          = 0;
     nCas1118_C          = 0;
     nCas1118_1          = 0;
     nCas1118_2          = 0;
     nCas1118_3          = 0;
     nCas1118_4          = 0;
     nCas0440T           = 0;
     nCas0440C           = 0;
     nCas0441T           = 0;
     nCas0441C           = 0;
     nCas0442T           = 0;
     nCas0442C           = 0;
     nCas0438T           = 0;
     nCas0438C           = 0;
     nCas0439T           = 0;
     nCas0439C           = 0;
     nCas0447T           = 0;
     nCas0447C           = 0;
     nCas0448T           = 0;
     nCas0448C           = 0;
     nCas0449T           = 0;
     nCas0449C           = 0;
     nCas0450T           = 0;
     nCas0450C           = 0;
     nCas0454T           = 0;
     nCas0454C           = 0;
     nCas0455T           = 0;
     nCas0455C           = 0;
     nCas0463T           = 0;
     nCas0463C           = 0;
     nCas0464T           = 0;
     nCas0464C           = 0;
     nCas1081_T          = 0;
     nCas1083_T          = 0;
     nCas1086_T          = 0;
     nCas1089_T          = 0;
     nCas1094_T          = 0;
     nCas1096_T          = 0;
     nCas1099_T          = 0;
     nCas1102_T          = 0;
     nCas1107_T          = 0;
     nCas1109_T          = 0;
     nCas1112_T          = 0;
     nCas1115_T          = 0;
     nCas1213_T          = 0;
     nCas1215_T          = 0;
     nCas1218_T          = 0;
     nCas1221_T          = 0;
     nCas1081_C          = 0;
     nCas1083_C          = 0;
     nCas1086_C          = 0;
     nCas1089_C          = 0;
     nCas1094_C          = 0;
     nCas1096_C          = 0;
     nCas1099_C          = 0;
     nCas1102_C          = 0;
     nCas1107_C          = 0;
     nCas1109_C          = 0;
     nCas1112_C          = 0;
     nCas1115_C          = 0;
     nCas1213_C          = 0;
     nCas1215_C          = 0;
     nCas1218_C          = 0;
     nCas1221_C          = 0;
     nCas1081_1          = 0;
     nCas1083_1          = 0;
     nCas1086_1          = 0;
     nCas1089_1          = 0;
     nCas1094_1          = 0;
     nCas1096_1          = 0;
     nCas1099_1          = 0;
     nCas1102_1          = 0;
     nCas1107_1          = 0;
     nCas1109_1          = 0;
     nCas1112_1          = 0;
     nCas1115_1          = 0;
     nCas1213_1          = 0;
     nCas1215_1          = 0;
     nCas1218_1          = 0;
     nCas1221_1          = 0;
     nCas1081_2          = 0;
     nCas1083_2          = 0;
     nCas1086_2          = 0;
     nCas1089_2          = 0;
     nCas1094_2          = 0;
     nCas1096_2          = 0;
     nCas1099_2          = 0;
     nCas1102_2          = 0;
     nCas1107_2          = 0;
     nCas1109_2          = 0;
     nCas1112_2          = 0;
     nCas1115_2          = 0;
     nCas1213_2          = 0;
     nCas1215_2          = 0;
     nCas1218_2          = 0;
     nCas1221_2          = 0;
     nCas1081_3          = 0;
     nCas1083_3          = 0;
     nCas1086_3          = 0;
     nCas1089_3          = 0;
     nCas1094_3          = 0;
     nCas1096_3          = 0;
     nCas1099_3          = 0;
     nCas1102_3          = 0;
     nCas1107_3          = 0;
     nCas1109_3          = 0;
     nCas1112_3          = 0;
     nCas1115_3          = 0;
     nCas1213_3          = 0;
     nCas1215_3          = 0;
     nCas1218_3          = 0;
     nCas1221_3          = 0;
     nCas1081_4          = 0;
     nCas1083_4          = 0;
     nCas1086_4          = 0;
     nCas1089_4          = 0;
     nCas1094_4          = 0;
     nCas1096_4          = 0;
     nCas1099_4          = 0;
     nCas1102_4          = 0;
     nCas1107_4          = 0;
     nCas1109_4          = 0;
     nCas1112_4          = 0;
     nCas1115_4          = 0;
     nCas1213_4          = 0;
     nCas1215_4          = 0;
     nCas1218_4          = 0;
     nCas1221_4          = 0;
     nCas0               = 0;
     nCas1               = 0;
     nCas2               = 0;
     nCas3               = 0;
     nCas4               = 0;
     nCas5               = 0;
     nTot                = 0;
|FIN;

|INCLUYE i_varcal;

|PROCESO rem01055AC;
     |SI nAplica ] #rem01055@#8;
         #rem01055@#10 = #rem01055@#8;
         nAplica = nAplica - #rem01055@#8;
     |SINO;
         #rem01055@#10 = nAplica;
         nAplica       = 0;
     |FINSI;

     |SI #rem01055@#11 ! "    ";
         #rem01055@#12 = #rem01055@#8 - #rem01055@#10;
     |FINSI;

     |GRABA 020#rem01055@.a;
     |LIBERA #rem01055@;
|FPRC;

|DEFBUCLE rem01055AC;
     #rem01055@#1005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, nLinea,   1;
     #refere1@#0, #refere1@#1, #refere1@#2, nLinea, 999;
     be;
     NULL, rem01055AC;
|FIN;

|PROCESO rem01011AC;
     nLinea  = #rem01011@#3;
     nAplica = #rem01011@#22;
     |BUCLE rem01055AC;

     |SI #rem01011@#15 [  0;  |ACABA;  |FINSI;

     #rem00903#4 = "0072";
     |LEE 000#rem00903.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SELECT #1#rem01055@;
     #rem01055@#0  = #refere1@#0;
     #rem01055@#1  = #refere1@#1;
     #rem01055@#2  = #refere1@#2;
     #rem01055@#3  = #rem01011@#3;
     #rem01055@#4  = #rem00903#0;
     |LEE 101#rem01055@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01055@;
         #rem01055@#0  = #refere1@#0;
         #rem01055@#1  = #refere1@#1;
         #rem01055@#2  = #refere1@#2;
         #rem01055@#3  = #rem01011@#3;
         #rem01055@#4  = #rem00903#0;
         #rem01055@#5  = #rem01011@#4;
         #rem01055@#6  = #rem00903#1;
         #rem01055@#7  = #rem00903#2;
         #rem01055@#9  = #rem00903#3;
         #rem01055@#11 = #rem00903#4;
         #rem01055@#13 = #rem00903#5;

         |GRABA 020#rem01055@.b;
     |FINSI;

     #rem01055@#12 = #rem01011@#15;

     |GRABA 020#rem01055@.a;
     |LIBERA #rem01055@;
|FPRC;

|DEFBUCLE rem01011AC;
     #rem01011@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01011AC;
|FIN;

|PROCESO AplicaAC_1;
     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, rem01011@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01011@#"zdat1011"#;  |FINSI;

     aDef    = eaPathDef + "rem01055.mas";
     |CARGA_DEF aDef, rem01055@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01011@;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01055@#"zdat1055"#;  |FINSI;

     |ABRET #rem01055@;
     |BUCLE rem01011AC;
     |CIERRAT #rem01055@;

     |DESCARGA_DEF #rem01055@;
     |DESCARGA_DEF #rem01011@;
|FPRC;

|PROCESO GrabaApor2017;
     #rem00903#4 = aCas;
     |LEE 000#rem00903.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SELECT #1#rem01056@;
     #rem01056@#0  = #refere1@#0;
     #rem01056@#1  = #refere1@#1;
     #rem01056@#2  = #refere1@#2;
     #rem01056@#3  = aTit;
     #rem01056@#4  = #rem00903#0;
     |LEE 101#rem01056@.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem01056@;
         #rem01056@#0  = #refere1@#0;
         #rem01056@#1  = #refere1@#1;
         #rem01056@#2  = #refere1@#2;
         #rem01056@#3  = aTit;
         #rem01056@#4  = #rem00903#0;
         #rem01056@#5  = #rem00903#1;
         #rem01056@#6  = #rem00903#2;
         #rem01056@#8  = #rem00903#3;
         #rem01056@#10 = #rem00903#4;
         #rem01056@#12 = #rem00903#5;

         |GRABA 020#rem01056@.b;
     |FINSI;

     #rem01056@#11 = nAplica;

     |GRABA 020#rem01056@.a;
     |LIBERA #rem01056@;
|FPRC;

|PROCESO rem01056AC;
     |SI nAplica ] #rem01056@#7;
         #rem01056@#9 = #rem01056@#7;
         nAplica = nAplica - #rem01056@#7;
     |SINO;
         #rem01056@#9 = nAplica;
         nAplica      = 0;
     |FINSI;

     |SI #rem01056@#10 ! "    ";
         #rem01056@#11 = #rem01056@#7 - #rem01056@#9;
     |FINSI;

     |GRABA 020#rem01056@.a;
     |LIBERA #rem01056@;
|FPRC;

|DEFBUCLE rem01056AC;
     #rem01056@#2005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, aDTit, aDCas;
     #refere1@#0, #refere1@#1, #refere1@#2, aHTit, aHCas;
     be;
     NULL, rem01056AC;
|FIN;

|PROCESO AplicaAC_5_Conjunta;
     eaCasilla = "27-0411"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "27-0414"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1081_T + nCas1083_T + nCas1086_T + nCas1089_T;
     nTot = nTot + nCas1081_C + nCas1083_C + nCas1086_C + nCas1089_C;
     nTot = nTot + nCas1081_1 + nCas1083_1 + nCas1086_1 + nCas1089_1;
     nTot = nTot + nCas1081_2 + nCas1083_2 + nCas1086_2 + nCas1089_2;
     nTot = nTot + nCas1081_3 + nCas1083_3 + nCas1086_3 + nCas1089_3;
     nTot = nTot + nCas1081_4 + nCas1083_4 + nCas1086_4 + nCas1089_4;

     aDCas     = "1081";
     aHCas     = "1089";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = (((nCas1081_T + nCas1083_T + nCas1086_T + nCas1089_T) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = (((nCas1081_C + nCas1083_C + nCas1086_C + nCas1089_C) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = (((nCas1081_1 + nCas1083_1 + nCas1086_1 + nCas1089_1) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = (((nCas1081_2 + nCas1083_2 + nCas1086_2 + nCas1089_2) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = (((nCas1081_3 + nCas1083_3 + nCas1086_3 + nCas1089_3) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = (((nCas1081_4 + nCas1083_4 + nCas1086_4 + nCas1089_4) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;
|FPRC;

|PROCESO AplicaAC_5;
     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         |HAZ AplicaAC_5_Conjunta;
         |ACABA;
     |FINSI;

     aDTit     = "";
     aHTit     = "zzzzzzzzzz";

     aDCas     = "1081";
     aHCas     = "1089";
     eaCasilla = "27-0411"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "27-0414"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;

     |BUCLE rem01056AC;
|FPRC;

|PROCESO AplicaAC_6_Conjunta;
     eaCasilla = "28-0417"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0418"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;
     eaCasilla = "28-0429"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1094_T + nCas1096_T;
     nTot = nTot + nCas1094_C + nCas1096_C;
     nTot = nTot + nCas1094_1 + nCas1096_1;
     nTot = nTot + nCas1094_2 + nCas1096_2;
     nTot = nTot + nCas1094_3 + nCas1096_3;
     nTot = nTot + nCas1094_4 + nCas1096_4;

     aDCas     = "1094";
     aHCas     = "1096";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = (((nCas1094_T + nCas1096_T) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = (((nCas1094_C + nCas1096_C) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = (((nCas1094_1 + nCas1096_1) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = (((nCas1094_2 + nCas1096_2) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = (((nCas1094_3 + nCas1096_3) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = (((nCas1094_4 + nCas1096_4) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

|| -------------------------------------

     eaCasilla = "28-0419"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0430"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1099_T;
     nTot = nTot + nCas1099_C;
     nTot = nTot + nCas1099_1;
     nTot = nTot + nCas1099_2;
     nTot = nTot + nCas1099_3;
     nTot = nTot + nCas1099_4;

     aDCas     = "1099";
     aHCas     = "1099";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = ((nCas1099_T * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = ((nCas1099_C * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = ((nCas1099_1 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = ((nCas1099_2 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = ((nCas1099_3 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = ((nCas1099_4 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

|| -------------------------------------

     eaCasilla = "28-0420"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0431"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1102_T;
     nTot = nTot + nCas1102_C;
     nTot = nTot + nCas1102_1;
     nTot = nTot + nCas1102_2;
     nTot = nTot + nCas1102_3;
     nTot = nTot + nCas1102_4;

     aDCas     = "1102";
     aHCas     = "1102";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = ((nCas1102_T * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = ((nCas1102_C * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = ((nCas1102_1 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = ((nCas1102_2 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = ((nCas1102_3 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = ((nCas1102_4 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;
|FPRC;

|PROCESO AplicaAC_6;
     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         |HAZ AplicaAC_6_Conjunta;
         |ACABA;
     |FINSI;

     aDTit     = "";
     aHTit     = "zzzzzzzzzz";
     aDCas     = "1094";
     aHCas     = "1096";
     eaCasilla = "28-0417"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0418"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;
     eaCasilla = "28-0429"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;
     |BUCLE rem01056AC;

     aDCas     = "1099";
     aHCas     = "1099";
     eaCasilla = "28-0419"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0430"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;
     |BUCLE rem01056AC;

     aDCas     = "1102";
     aHCas     = "1102";
     eaCasilla = "28-0420"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0431"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;
     |BUCLE rem01056AC;
|FPRC;

|PROCESO AplicaAC_7_Conjunta;
     eaCasilla = "28-0421"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0425"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;
     eaCasilla = "28-0426"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1107_T + nCas1109_T;
     nTot = nTot + nCas1107_C + nCas1109_C;
     nTot = nTot + nCas1107_1 + nCas1109_1;
     nTot = nTot + nCas1107_2 + nCas1109_2;
     nTot = nTot + nCas1107_3 + nCas1109_3;
     nTot = nTot + nCas1107_4 + nCas1109_4;

     aDCas     = "1107";
     aHCas     = "1109";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = (((nCas1107_T + nCas1109_T) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = (((nCas1107_C + nCas1109_C) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = (((nCas1107_1 + nCas1109_1) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = (((nCas1107_2 + nCas1109_2) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = (((nCas1107_3 + nCas1109_3) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = (((nCas1107_4 + nCas1109_4) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

|| -------------------------------------

     eaCasilla = "28-0422"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0427"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1112_T;
     nTot = nTot + nCas1112_C;
     nTot = nTot + nCas1112_1;
     nTot = nTot + nCas1112_2;
     nTot = nTot + nCas1112_3;
     nTot = nTot + nCas1112_4;

     aDCas     = "1112";
     aHCas     = "1112";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = ((nCas1112_T * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = ((nCas1112_C * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = ((nCas1112_1 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = ((nCas1112_2 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = ((nCas1112_3 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = ((nCas1112_4 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

|| -------------------------------------

     eaCasilla = "28-0423"; |HAZ SacaImporte;  nTAplica = enImporte;
     eaCasilla = "28-0428"; |HAZ SacaImporte;  nTAplica = nTAplica + enImporte;

     nTot = nCas1115_T;
     nTot = nTot + nCas1115_C;
     nTot = nTot + nCas1115_1;
     nTot = nTot + nCas1115_2;
     nTot = nTot + nCas1115_3;
     nTot = nTot + nCas1115_4;

     aDCas     = "1115";
     aHCas     = "1115";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = ((nCas1115_T * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = ((nCas1115_C * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = ((nCas1115_1 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = ((nCas1115_2 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = ((nCas1115_3 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = ((nCas1115_4 * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;
|FPRC;

|PROCESO AplicaAC_7;
     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         |HAZ AplicaAC_7_Conjunta;
         |ACABA;
     |FINSI;

     aDTit     = "";
     aHTit     = "zzzzzzzzzz";
     aDCas     = "1107";
     aHCas     = "1109";

     eaCasilla = "28-0421"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0425"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;
     eaCasilla = "28-0426"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;

     |BUCLE rem01056AC;

     aDCas     = "1112";
     aHCas     = "1112";
     eaCasilla = "28-0422"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0427"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;

     |BUCLE rem01056AC;

     aDCas     = "1115";
     aHCas     = "1115";
     eaCasilla = "28-0423"; |HAZ SacaImporte;  nAplica = enImporte;
     eaCasilla = "28-0428"; |HAZ SacaImporte;  nAplica = nAplica + enImporte;

     |BUCLE rem01056AC;
|FPRC;

|PROCESO rem01037_9;
     |SI #rem01037@#4 = "TITULAR   ";
         nCas0438T = #rem01037@#5;
         nCas0439T = #rem01037@#10;
         nCas0440T = #rem01037@#6;
         nCas0441T = #rem01037@#12;
         nCas0442T = #rem01037@#7;
     |FINSI;

     |SI #rem01037@#4 = "CONYUGE   ";
         nCas0438C = #rem01037@#5;
         nCas0439C = #rem01037@#10;
         nCas0440C = #rem01037@#6;
         nCas0441C = #rem01037@#12;
         nCas0442C = #rem01037@#7;
     |FINSI;
|FPRC;

|DEFBUCLE rem01037_9;
     #rem01037@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01037_9;
|FIN;

|PROCESO rem01045_9;
     |SI #rem01045@#4 = "TITULAR   ";
         nCas0447T = #rem01045@#6;
         nCas0448T = #rem01045@#11;
         nCas0449T = #rem01045@#7;
         nCas0450T = #rem01045@#8;
     |FINSI;

     |SI #rem01045@#4 = "CONYUGE   ";
         nCas0447C = #rem01045@#6;
         nCas0448C = #rem01045@#11;
         nCas0449C = #rem01045@#7;
         nCas0450C = #rem01045@#8;
     |FINSI;
|FPRC;

|DEFBUCLE rem01045_9;
     #rem01045@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01045_9;
|FIN;

|PROCESO rem01035_9;
     |SI #rem01035@#4 = "TITULAR   ";
         nCas0454T = #rem01035@#7;
         nCas0455T = #rem01035@#6;
     |FINSI;

     |SI #rem01035@#4 = "CONYUGE   ";
         nCas0454C = #rem01035@#7;
         nCas0455C = #rem01035@#6;
     |FINSI;
|FPRC;

|DEFBUCLE rem01035_9;
     #rem01035@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01035_9;
|FIN;

|PROCESO rem01047_9;
     |SI #rem01047@#4 = "TITULAR   ";
         nCas0463T = #rem01047@#5;
         nCas0464T = #rem01047@#6;
     |FINSI;

     |SI #rem01047@#4 = "CONYUGE   ";
         nCas0463C = #rem01047@#5;
         nCas0464C = #rem01047@#6;
     |FINSI;
|FPRC;

|DEFBUCLE rem01047_9;
     #rem01047@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01047_9;
|FIN;

|PROCESO CargaVarPens;
     nCas0440T = 0;
     nCas0440C = 0;
     nCas0441T = 0;
     nCas0441C = 0;
     nCas0442T = 0;
     nCas0442C = 0;
     nCas0438T = 0;
     nCas0438C = 0;
     nCas0439T = 0;
     nCas0439C = 0;
     nCas0447T = 0;
     nCas0447C = 0;
     nCas0448T = 0;
     nCas0448C = 0;
     nCas0449T = 0;
     nCas0449C = 0;
     nCas0450T = 0;
     nCas0450C = 0;
     nCas0454T = 0;
     nCas0454C = 0;
     nCas0455T = 0;
     nCas0455C = 0;
     nCas0463T = 0;
     nCas0463C = 0;
     nCas0464T = 0;
     nCas0464C = 0;

     aDef   = eaPathDef + "rem01037.mas";
     |CARGA_DEF aDef, rem01037@;
     |SI FSalida = 0;
         |SI enNomeDat = 1;  |NOME_DAT #rem01037@#"zdat1037"#;  |FINSI;

         |BUCLE rem01037_9;

         |DESCARGA_DEF #rem01037@;
     |FINSI;

     aDef   = eaPathDef + "rem01045.mas";
     |CARGA_DEF aDef, rem01045@;
     |SI FSalida = 0;
         |SI enNomeDat = 1;  |NOME_DAT #rem01045@#"zdat1045"#;  |FINSI;

         |BUCLE rem01045_9;

         |DESCARGA_DEF #rem01045@;
     |FINSI;

     aDef   = eaPathDef + "rem01035.mas";
     |CARGA_DEF aDef, rem01035@;
     |SI FSalida = 0;
         |SI enNomeDat = 1;  |NOME_DAT #rem01035@#"zdat1035"#;  |FINSI;

         |BUCLE rem01035_9;

         |DESCARGA_DEF #rem01035@;
     |FINSI;

     aDef   = eaPathDef + "rem01047.mas";
     |CARGA_DEF aDef, rem01047@;
     |SI FSalida = 0;
         |SI enNomeDat = 1;  |NOME_DAT #rem01047@#"zdat1047"#;  |FINSI;

         |BUCLE rem01047_9;

         |DESCARGA_DEF #rem01047@;
     |FINSI;
|FPRC;

|PROCESO Punto8y9T;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nPorce = (nCas0442T * 100) / (nCas0442T + nCas0442C);
     |FINSI;

     nCas0   = ((#rem01033@#96 * nPorce) / 100) ! 2;
     nCas1   = nCas0440T - #rem01033@#134;
     nCas2   = nCas0441T - #rem01033@#136;
     nCas3   = nCas0 - (nCas1 + nCas2);
     nCas4   = ((nCas0438T * 100) / (nCas0438T + nCas0439T)) ! 2;
     nCas5   = ((nCas3 * nCas4) / 100) ! 2;

     nAplica = nCas5 + nCas0444C;

     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1120";
         aHCas    = "1131";

         |BUCLE rem01056AC;
     |FINSI;

     nAplica = nCas3 - nCas5;
     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1136";
         aHCas    = "1145";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto8y9C;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nPorce = (nCas0442C * 100) / (nCas0442T + nCas0442C);
     |FINSI;

     nCas0   = ((#rem01033@#96 * nPorce) / 100) ! 2;
     nCas1   = nCas0440C - #rem01033@#135;
     nCas2   = nCas0441C - #rem01033@#137;
     nCas3   = nCas0 - (nCas1 + nCas2);
     nCas4   = ((nCas0438C * 100) / (nCas0438C + nCas0439C)) ! 2;
     nCas5   = ((nCas3 * nCas4) / 100) ! 2;

     nAplica = nCas5 + nCas0444T;

     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1120";
         aHCas    = "1131";

         |BUCLE rem01056AC;
     |FINSI;

     nAplica = nCas3 - nCas5;
     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1136";
         aHCas    = "1145";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto10y11T;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nSuma1 = nCas0447T + nCas0448T + nCas0449T + nCas0450T;
         nSuma2 = nCas0447C + nCas0448C + nCas0449C + nCas0450C;
         nPorce = (nSuma1 * 100) / (nSuma1 + nSuma2);
     |FINSI;

     nCas0   = ((#rem01033@#98 * nPorce) / 100) ! 2;
     nCas1   = nCas0449T - #rem01033@#138;
     nCas2   = nCas0450T - #rem01033@#140;
     nCas3   = nCas0 - (nCas1 + nCas2);
     nCas4   = ((nCas0447T * 100) / (nCas0447T + nCas0448T)) ! 2;
     nCas5   = ((nCas3 * nCas4) / 100) ! 2;

     nAplica = nCas5 + nCas0444C;

     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1150";
         aHCas    = "1161";

         |BUCLE rem01056AC;
     |FINSI;

     nAplica = nCas3 - nCas5;
     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1167";
         aHCas    = "1178";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto10y11C;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nSuma1 = nCas0447C + nCas0448C + nCas0449C + nCas0450C;
         nSuma2 = nCas0447T + nCas0448T + nCas0449T + nCas0450T;
         nPorce = (nSuma1 * 100) / (nSuma1 + nSuma2);
     |FINSI;

     nCas0   = ((#rem01033@#98 * nPorce) / 100) ! 2;
     nCas1   = nCas0449C - #rem01033@#139;
     nCas2   = nCas0450C - #rem01033@#141;
     nCas3   = nCas0 - (nCas1 + nCas2);
     nCas4   = ((nCas0447C * 100) / (nCas0447C + nCas0448C)) ! 2;
     nCas5   = ((nCas3 * nCas4) / 100) ! 2;

     nAplica = nCas5;

     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1150";
         aHCas    = "1161";

         |BUCLE rem01056AC;
     |FINSI;

     nAplica = nCas3 - nCas5;
     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1167";
         aHCas    = "1178";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto12T;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nPorce = (nCas0454T * 100) / (nCas0454T + nCas0454C);
     |FINSI;

     nCas0   = ((#rem01033@#99 * nPorce) / 100) ! 2;
     nCas1   = nCas0455T - #rem01033@#142;
     nCas2   = nCas0 - nCas1;

     nAplica = nCas2;

     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1184";
         aHCas    = "1192";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto12C;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nPorce = (nCas0454C * 100) / (nCas0454T + nCas0454C);
     |FINSI;

     nCas0   = ((#rem01033@#99 * nPorce) / 100) ! 2;
     nCas1   = nCas0455C - #rem01033@#143;
     nCas2   = nCas0 - nCas1;

     nAplica = nCas2;

     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1184";
         aHCas    = "1192";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto13T;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nSuma1 = nCas0463T + nCas0464T;
         nSuma2 = nCas0463C + nCas0464C;
         nPorce = (nSuma1 * 100) / (nSuma1 + nSuma2);
     |FINSI;

     nCas0   = ((#rem01033@#101 * nPorce) / 100) ! 2;
     nCas1   = nCas0464T - #rem01033@#144;
     nCas2   = nCas0 - nCas1;

     nAplica = nCas2;

     |SI nAplica > 0;
         aDTit    = "TITULAR";
         aHTit    = "TITULAR";
         aDCas    = "1197";
         aHCas    = "1208";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO Punto13C;
     nPorce = 100;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         nSuma1 = nCas0463C + nCas0464C;
         nSuma2 = nCas0463T + nCas0464T;
         nPorce = (nSuma1 * 100) / (nSuma1 + nSuma2);
     |FINSI;

     nCas0   = ((#rem01033@#101 * nPorce) / 100) ! 2;
     nCas1   = nCas0464C - #rem01033@#145;
     nCas2   = nCas0 - nCas1;

     nAplica = nCas2;

     |SI nAplica > 0;
         aDTit    = "CONYUGE";
         aHTit    = "CONYUGE";
         aDCas    = "1197";
         aHCas    = "1208";

         |BUCLE rem01056AC;
     |FINSI;
|FPRC;

|PROCESO AplicaAC_Pens;
     |HAZ CargaVarPens;

     |HAZ Punto8y9T;
     |HAZ Punto8y9C;
     |HAZ Punto10y11T;
     |HAZ Punto10y11C;
     |HAZ Punto12T;
     |HAZ Punto12C;
     |HAZ Punto13T;
     |HAZ Punto13C;
|FPRC;

|PROCESO AplicaAC_14_Conjunta;
     eaCasilla = "35-0474"; |HAZ SacaImporte;  nTAplica = enImporte;

     nTot = nCas1213_T + nCas1215_T + nCas1218_T + nCas1221_T;
     nTot = nTot + nCas1213_C + nCas1215_C + nCas1218_C + nCas1221_C;
     nTot = nTot + nCas1213_1 + nCas1215_1 + nCas1218_1 + nCas1221_1;
     nTot = nTot + nCas1213_2 + nCas1215_2 + nCas1218_2 + nCas1221_2;
     nTot = nTot + nCas1213_3 + nCas1215_3 + nCas1218_3 + nCas1221_3;
     nTot = nTot + nCas1213_4 + nCas1215_4 + nCas1218_4 + nCas1221_4;

     aDCas     = "1213";
     aHCas     = "1221";

     aDTit     = "TITULAR";
     aHTit     = "TITULAR";
     nPorce    = (((nCas1213_T + nCas1215_T + nCas1218_T + nCas1221_T) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "CONYUGE";
     aHTit     = "CONYUGE";
     nPorce    = (((nCas1213_C + nCas1215_C + nCas1218_C + nCas1221_C) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "1 FAMILIAR";
     aHTit     = "1 FAMILIAR";
     nPorce    = (((nCas1213_1 + nCas1215_1 + nCas1218_1 + nCas1221_1) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "2 FAMILIAR";
     aHTit     = "2 FAMILIAR";
     nPorce    = (((nCas1213_2 + nCas1215_2 + nCas1218_2 + nCas1221_2) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "3 FAMILIAR";
     aHTit     = "3 FAMILIAR";
     nPorce    = (((nCas1213_3 + nCas1215_3 + nCas1218_3 + nCas1221_3) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;

     aDTit     = "4 FAMILIAR";
     aHTit     = "4 FAMILIAR";
     nPorce    = (((nCas1213_4 + nCas1215_4 + nCas1218_4 + nCas1221_4) * 100) / nTot) ! 2;
     nAplica   = nTAplica % nPorce
     |SI nAplica ] 0;  |BUCLE rem01056AC;  |FINSI;
|FPRC;

|PROCESO AplicaAC_14;
     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
         |HAZ AplicaAC_14_Conjunta;
         |ACABA;
     |FINSI;

     aDTit     = "";
     aHTit     = "zzzzzzzzzz";
     aDCas     = "1213";
     aHCas     = "1221";
     eaCasilla = "35-0474"; |HAZ SacaImporte;  nAplica = enImporte;

     |BUCLE rem01056AC;
|FPRC;

|PROCESO rem01033_9;
     |SI #rem01033@#2 = "CONJUNTA  ";  |O #rem01033@#2 = "CONJUNTAE ";
         nCas0413 = nCas0413 + #rem01033@#61;
         nCas0410 = nCas0410 + #rem01033@#57;
         nCas0416 = nCas0416 + #rem01033@#65;
         nCas0424 = nCas0424 + #rem01033@#74;

         |SI #rem01033@#94 < 0;
             nCas0475 = -#rem01033@#94;
         |FINSI;

         |ACABA;
     |FINSI;

     nCas0402 = nCas0402 + #rem01033@#50;
     nCas0406 = nCas0406 + #rem01033@#54;

     |SI #rem01033@#2 = "TITULAR   ";
         nCas0403_T = #rem01033@#51;
         nCas0407_T = #rem01033@#55;
         nCas1118_T = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_T = -#rem01033@#94;
         |FINSI;
     |FINSI;

     |SI #rem01033@#2 = "CONYUGE   ";
         nCas0403_C = #rem01033@#51;
         nCas0407_C = #rem01033@#55;
         nCas1118_C = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_C = -#rem01033@#94;
         |FINSI;
     |FINSI;

     |SI #rem01033@#2 = "1 FAMILIAR";
         nCas0403_1 = #rem01033@#51;
         nCas0407_1 = #rem01033@#55;
         nCas1118_1 = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_1 = -#rem01033@#94;
         |FINSI;
     |FINSI;

     |SI #rem01033@#2 = "2 FAMILIAR";
         nCas0403_2 = #rem01033@#51;
         nCas0407_2 = #rem01033@#55;
         nCas1118_2 = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_2 = -#rem01033@#94;
         |FINSI;
     |FINSI;

     |SI #rem01033@#2 = "3 FAMILIAR";
         nCas0403_3 = #rem01033@#51;
         nCas0407_3 = #rem01033@#55;
         nCas1118_3 = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_3 = -#rem01033@#94;
         |FINSI;
     |FINSI;

     |SI #rem01033@#2 = "4 FAMILIAR";
         nCas0403_4 = #rem01033@#51;
         nCas0407_4 = #rem01033@#55;
         nCas1118_4 = #rem01033@#57 - #rem01033@#65;

         |SI #rem01033@#94 < 0;
             nCas0415_4 = -#rem01033@#94;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01033_9;
     #rem01033@#1003;
     ;
     #refere1@#0, #refere1@#1, "          ";
     #refere1@#0, #refere1@#1, "zzzzzzzzzz";
     ;
     NULL, rem01033_9;
|FIN;

|PROCESO rem01056Pdte;
     |SI #rem01056@#6  = "    ";
      |Y #rem01056@#8  = "    ";
      |Y #rem01056@#10 = "    ";
         |ACABA;
     |FINSI;

     |SI #rem01056@#3  = "TITULAR   ";
         |SI #rem01056@#6  = "1081"; nCas1081_T =  nCas1081_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_T =  nCas1083_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_T =  nCas1086_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_T =  nCas1089_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_T =  nCas1094_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_T =  nCas1096_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_T =  nCas1099_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_T =  nCas1102_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_T =  nCas1107_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_T =  nCas1109_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_T =  nCas1112_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_T =  nCas1115_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_T =  nCas1213_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_T =  nCas1215_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_T =  nCas1218_T + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_T =  nCas1221_T + #rem01056@#7;  |FINSI;
     |FINSI;

     |SI #rem01056@#3  = "CONYUGE   ";
         |SI #rem01056@#6  = "1081"; nCas1081_C =  nCas1081_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_C =  nCas1083_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_C =  nCas1086_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_C =  nCas1089_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_C =  nCas1094_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_C =  nCas1096_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_C =  nCas1099_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_C =  nCas1102_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_C =  nCas1107_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_C =  nCas1109_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_C =  nCas1112_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_C =  nCas1115_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_C =  nCas1213_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_C =  nCas1215_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_C =  nCas1218_C + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_C =  nCas1221_C + #rem01056@#7;  |FINSI;
     |FINSI;

     |SI #rem01056@#3  = "1 FAMILIAR";
         |SI #rem01056@#6  = "1081"; nCas1081_1 =  nCas1081_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_1 =  nCas1083_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_1 =  nCas1086_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_1 =  nCas1089_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_1 =  nCas1094_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_1 =  nCas1096_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_1 =  nCas1099_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_1 =  nCas1102_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_1 =  nCas1107_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_1 =  nCas1109_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_1 =  nCas1112_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_1 =  nCas1115_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_1 =  nCas1213_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_1 =  nCas1215_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_1 =  nCas1218_1 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_1 =  nCas1221_1 + #rem01056@#7;  |FINSI;
     |FINSI;

     |SI #rem01056@#3  = "2 FAMILIAR";
         |SI #rem01056@#6  = "1081"; nCas1081_2 =  nCas1081_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_2 =  nCas1083_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_2 =  nCas1086_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_2 =  nCas1089_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_2 =  nCas1094_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_2 =  nCas1096_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_2 =  nCas1099_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_2 =  nCas1102_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_2 =  nCas1107_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_2 =  nCas1109_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_2 =  nCas1112_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_2 =  nCas1115_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_2 =  nCas1213_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_2 =  nCas1215_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_2 =  nCas1218_2 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_2 =  nCas1221_2 + #rem01056@#7;  |FINSI;
     |FINSI;

     |SI #rem01056@#3  = "3 FAMILIAR";
         |SI #rem01056@#6  = "1081"; nCas1081_3 =  nCas1081_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_3 =  nCas1083_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_3 =  nCas1086_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_3 =  nCas1089_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_3 =  nCas1094_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_3 =  nCas1096_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_3 =  nCas1099_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_3 =  nCas1102_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_3 =  nCas1107_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_3 =  nCas1109_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_3 =  nCas1112_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_3 =  nCas1115_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_3 =  nCas1213_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_3 =  nCas1215_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_3 =  nCas1218_3 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_3 =  nCas1221_3 + #rem01056@#7;  |FINSI;
     |FINSI;

     |SI #rem01056@#3  = "4 FAMILIAR";
         |SI #rem01056@#6  = "1081"; nCas1081_4 =  nCas1081_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1083"; nCas1083_4 =  nCas1083_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1086"; nCas1086_4 =  nCas1086_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1089"; nCas1089_4 =  nCas1089_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1094"; nCas1094_4 =  nCas1094_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1096"; nCas1096_4 =  nCas1096_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1099"; nCas1099_4 =  nCas1099_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1102"; nCas1102_4 =  nCas1102_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1107"; nCas1107_4 =  nCas1107_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1109"; nCas1109_4 =  nCas1109_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1112"; nCas1112_4 =  nCas1112_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1115"; nCas1115_4 =  nCas1115_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1213"; nCas1213_4 =  nCas1213_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1215"; nCas1215_4 =  nCas1215_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1218"; nCas1218_4 =  nCas1218_4 + #rem01056@#7;  |FINSI;
         |SI #rem01056@#6  = "1221"; nCas1221_4 =  nCas1221_4 + #rem01056@#7;  |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE rem01056Pdte;
     #rem01056@#1005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, "          ", 001;
     #refere1@#0, #refere1@#1, #refere1@#2, "zzzzzzzzzz", 999;
     ;
     NULL, rem01056Pdte;
|FIN;

|PROCESO Cas2017Conjunta;
     nCas0402   = 0;
     nCas0410   = 0;
     nCas0413   = 0;
     nCas0416   = 0;
     nCas0403_T = 0;
     nCas0403_C = 0;
     nCas0403_1 = 0;
     nCas0403_2 = 0;
     nCas0403_3 = 0;
     nCas0403_4 = 0;

     nCas0406   = 0;
     nCas0424   = 0;
     nCas0407_T = 0;
     nCas0407_C = 0;
     nCas0407_1 = 0;
     nCas0407_2 = 0;
     nCas0407_3 = 0;
     nCas0407_4 = 0;

     nCas1118_T = 0;
     nCas1118_C = 0;
     nCas1118_1 = 0;
     nCas1118_2 = 0;
     nCas1118_3 = 0;
     nCas1118_4 = 0;

     nCas0475   = 0;
     nCas0415_T = 0;
     nCas0415_C = 0;
     nCas0415_1 = 0;
     nCas0415_2 = 0;
     nCas0415_3 = 0;
     nCas0415_4 = 0;
     nCas0415   = 0;

     nCas1081_T = 0;
     nCas1083_T = 0;
     nCas1086_T = 0;
     nCas1089_T = 0;
     nCas1094_T = 0;
     nCas1096_T = 0;
     nCas1099_T = 0;
     nCas1102_T = 0;
     nCas1107_T = 0;
     nCas1109_T = 0;
     nCas1112_T = 0;
     nCas1115_T = 0;
     nCas1213_T = 0;
     nCas1215_T = 0;
     nCas1218_T = 0;
     nCas1221_T = 0;
     nCas1081_C = 0;
     nCas1083_C = 0;
     nCas1086_C = 0;
     nCas1089_C = 0;
     nCas1094_C = 0;
     nCas1096_C = 0;
     nCas1099_C = 0;
     nCas1102_C = 0;
     nCas1107_C = 0;
     nCas1109_C = 0;
     nCas1112_C = 0;
     nCas1115_C = 0;
     nCas1213_C = 0;
     nCas1215_C = 0;
     nCas1218_C = 0;
     nCas1221_C = 0;
     nCas1081_1 = 0;
     nCas1083_1 = 0;
     nCas1086_1 = 0;
     nCas1089_1 = 0;
     nCas1094_1 = 0;
     nCas1096_1 = 0;
     nCas1099_1 = 0;
     nCas1102_1 = 0;
     nCas1107_1 = 0;
     nCas1109_1 = 0;
     nCas1112_1 = 0;
     nCas1115_1 = 0;
     nCas1213_1 = 0;
     nCas1215_1 = 0;
     nCas1218_1 = 0;
     nCas1221_1 = 0;
     nCas1081_2 = 0;
     nCas1083_2 = 0;
     nCas1086_2 = 0;
     nCas1089_2 = 0;
     nCas1094_2 = 0;
     nCas1096_2 = 0;
     nCas1099_2 = 0;
     nCas1102_2 = 0;
     nCas1107_2 = 0;
     nCas1109_2 = 0;
     nCas1112_2 = 0;
     nCas1115_2 = 0;
     nCas1213_2 = 0;
     nCas1215_2 = 0;
     nCas1218_2 = 0;
     nCas1221_2 = 0;
     nCas1081_3 = 0;
     nCas1083_3 = 0;
     nCas1086_3 = 0;
     nCas1089_3 = 0;
     nCas1094_3 = 0;
     nCas1096_3 = 0;
     nCas1099_3 = 0;
     nCas1102_3 = 0;
     nCas1107_3 = 0;
     nCas1109_3 = 0;
     nCas1112_3 = 0;
     nCas1115_3 = 0;
     nCas1213_3 = 0;
     nCas1215_3 = 0;
     nCas1218_3 = 0;
     nCas1221_3 = 0;
     nCas1081_4 = 0;
     nCas1083_4 = 0;
     nCas1086_4 = 0;
     nCas1089_4 = 0;
     nCas1094_4 = 0;
     nCas1096_4 = 0;
     nCas1099_4 = 0;
     nCas1102_4 = 0;
     nCas1107_4 = 0;
     nCas1109_4 = 0;
     nCas1112_4 = 0;
     nCas1115_4 = 0;
     nCas1213_4 = 0;
     nCas1215_4 = 0;
     nCas1218_4 = 0;
     nCas1221_4 = 0;

     |BUCLE rem01056Pdte;
     |BUCLE rem01033_9;

     nPendiente = nCas0402 + nCas0413;

     |SI nCas0403_4 ! 0;
         |SI nCas0403_4 > nPendiente;
             nAplica    = nCas0403_4 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_4;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "4 FAMILIAR";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0403_3 ! 0;
         |SI nCas0403_3 > nPendiente;
             nAplica    = nCas0403_3 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_3;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "3 FAMILIAR";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0403_2 ! 0;
         |SI nCas0403_2 > nPendiente;
             nAplica    = nCas0403_2 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_2;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "2 FAMILIAR";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0403_1 ! 0;
         |SI nCas0403_1 > nPendiente;
             nAplica    = nCas0403_1 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_1;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "1 FAMILIAR";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0403_C ! 0;
         |SI nCas0403_C > nPendiente;
             nAplica    = nCas0403_C - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_C;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "CONYUGE";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0403_T ! 0;
         |SI nCas0403_T > nPendiente;
             nAplica    = nCas0403_T - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0403_T;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "TITULAR";
             aCas    = "1092";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     nPendiente = nCas0406 + nCas0424;

     |SI nCas0407_4 ! 0;
         |SI nCas0407_4 > nPendiente;
             nAplica    = nCas0407_4 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_4;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "4 FAMILIAR";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0407_3 ! 0;
         |SI nCas0407_3 > nPendiente;
             nAplica    = nCas0407_3 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_3;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "3 FAMILIAR";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0407_2 ! 0;
         |SI nCas0407_2 > nPendiente;
             nAplica    = nCas0407_2 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_2;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "2 FAMILIAR";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0407_1 ! 0;
         |SI nCas0407_1 > nPendiente;
             nAplica    = nCas0407_1 - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_1;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "1 FAMILIAR";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0407_C ! 0;
         |SI nCas0407_C > nPendiente;
             nAplica    = nCas0407_C - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_C;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "CONYUGE";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0407_T ! 0;
         |SI nCas0407_T > nPendiente;
             nAplica    = nCas0407_T - nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = 0;
             nPendiente = nPendiente - nCas0407_T;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "TITULAR";
             aCas    = "1105";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     nPendiente = nCas0410 + nCas0416;

     |SI nCas1118_4 ! 0;
         |SI nCas1118_4 > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_4;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "4 FAMILIAR";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas1118_3 ! 0;
         |SI nCas1118_3 > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_3;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "3 FAMILIAR";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas1118_2 ! 0;
         |SI nCas1118_2 > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_2;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "2 FAMILIAR";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas1118_1 ! 0;
         |SI nCas1118_1 > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_1;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "1 FAMILIAR";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas1118_C ! 0;
         |SI nCas1118_C > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_C;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "CONYUGE";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas1118_T ! 0;
         |SI nCas1118_T > nPendiente;
             nAplica    = nPendiente;
             nPendiente = 0;
         |SINO;
             nAplica    = nCas1118_T;
             nPendiente = nPendiente - nAplica;
         |FINSI;

         |SI nAplica > 0;
             aTit    = "TITULAR";
             aCas    = "1118";
             |HAZ GrabaApor2017;
         |FINSI;
     |FINSI;

     |SI nCas0475 [ 0;
         |ACABA;
     |FINSI;

     nCas0415 = nCas0415_T + nCas0415_C + nCas0415_1;
     nCas0415 = nCas0415   + nCas0415_2 + nCas0415_3 + nCas0415_4;

     |SI nCas0415_T > 0;
         nPorce  = (nCas0415_T * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "TITULAR";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;

     |SI nCas0415_C > 0;
         nPorce  = (nCas0415_C * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "CONYUGE";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;

     |SI nCas0415_1 > 0;
         nPorce  = (nCas0415_1 * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "1 FAMILIAR";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;

     |SI nCas0415_2 > 0;
         nPorce  = (nCas0415_2 * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "2 FAMILIAR";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;

     |SI nCas0415_3 > 0;
         nPorce  = (nCas0415_3 * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "3 FAMILIAR";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;

     |SI nCas0415_4 > 0;
         nPorce  = (nCas0415_4 * 100) / nCas0415;
         nAplica = ((nCas0475 * nPorce) / 100) ! 2;
         aTit    = "4 FAMILIAR";
         aCas    = "1224";
         |HAZ GrabaApor2017;
     |FINSI;
|FPRC;

|PROCESO Cas2017Individual;
     nResta = #rem01033@#51 - #rem01033@#61;
     aTit   = #rem01033@#2;
     |SI nResta > 0;
         aCas    = "1092";
         nAplica = nResta;
         |HAZ GrabaApor2017;
     |FINSI;

     nResta = #rem01033@#55 - #rem01033@#74;
     |SI nResta > 0;
         aCas    = "1105";
         nAplica = nResta;
         |HAZ GrabaApor2017;
     |FINSI;

     nResta = #rem01033@#57 - #rem01033@#65;
     |SI nResta > 0;
         aCas    = "1118";
         nAplica = nResta;
         |HAZ GrabaApor2017;
     |FINSI;

     nResta = -#rem01033@#104;
     |SI nResta > 0;
         aCas    = "1224";
         nAplica = nResta;
         |HAZ GrabaApor2017;
     |FINSI;
|FPRC;

|PROCESO rem01056Rec;
     |SI #rem01056@#6  ! "    ";
      |Y #rem01056@#8  ! "    ";
      |Y #rem01056@#10 ! "    ";
         #rem01056@#11 = #rem01056@#7 - #rem01056@#9;
     |FINSI;

     |GRABA 020#rem01056@.a;
     |LIBERA #rem01056@;
|FPRC;

|DEFBUCLE rem01056Rec;
     #rem01056@#1005;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, "          ", 001;
     #refere1@#0, #refere1@#1, #refere1@#2, "zzzzzzzzzz", 999;
     be;
     NULL, rem01056Rec;
|FIN;


|PROCESO CalculaAnexoC;
     |ABRE #rem00903;  |SELECT #3#rem00903;

     |HAZ AplicaAC_1;

     aDef    = eaPathDef + "rem01056.mas";
     |CARGA_DEF aDef, rem01056@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01056@#"zdat1056"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01033@#"zdat1033"#;  |FINSI;

     |ABRET #rem01056@;

     |ABRE #rem01033@;

     nCas0444T = 0;
     nCas0444C = 0;

     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = "TITULAR";
     |LEE 040#rem01033@.=;
     |SI FSalida = 0;
         nCas0444T = #rem01033@#85;
     |FINSI;

     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = "CONYUGE";
     |LEE 040#rem01033@.=;
     |SI FSalida = 0;
         nCas0444C = #rem01033@#85;
     |FINSI;

     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = #refere1@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01033@;  |FINSI;

     |CIERRA #rem01033@;

     |SI #rem01033@#134 ! 0;
         aCas    = "1134";
         aTit    = "TITULAR";
         nAplica = #rem01033@#134;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#135 ! 0;
         aCas    = "1134";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#135;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#136 ! 0;
         aCas    = "1148";
         aTit    = "TITULAR";
         nAplica = #rem01033@#136;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#137 ! 0;
         aCas    = "1148";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#137;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#138 ! 0;
         aCas    = "1164";
         aTit    = "TITULAR";
         nAplica = #rem01033@#138;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#139 ! 0;
         aCas    = "1164";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#139;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#140 ! 0;
         aCas    = "1181";
         aTit    = "TITULAR";
         nAplica = #rem01033@#140;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#141 ! 0;
         aCas    = "1181";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#141;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#142 ! 0;
         aCas    = "1195";
         aTit    = "TITULAR";
         nAplica = #rem01033@#142;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#143 ! 0;
         aCas    = "1195";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#143;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#144 ! 0;
         aCas    = "1211";
         aTit    = "TITULAR";
         nAplica = #rem01033@#144;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #rem01033@#145 ! 0;
         aCas    = "1211";
         aTit    = "CONYUGE";
         nAplica = #rem01033@#145;
         |HAZ GrabaApor2017;
     |FINSI;

     |SI #refere1@#2 = "CONJUNTA  ";  |O #refere1@#2 = "CONJUNTAE ";
          |HAZ Cas2017Conjunta;
     |SINO;
          |HAZ Cas2017Individual;
     |FINSI;

     |ABRE #rem01033@;
     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = #refere1@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01033@;  |FINSI;
     |CIERRA #rem01033@;

     |HAZ AplicaAC_5;
     |HAZ AplicaAC_6;
     |HAZ AplicaAC_7;
     |HAZ AplicaAC_Pens;
     |HAZ AplicaAC_14;

     |CIERRAT #rem01056@;

     |BUCLE rem01056Rec;

     |DESCARGA_DEF #rem01033@;
     |DESCARGA_DEF #rem01056@;

     |CIERRA #rem00903;
|FPRC;

|PROCESO EsIndividual;
     aDef    = eaPathDef + "rem00100.mas";
     |CARGA_DEF aDef, rem00100@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |ABRE #rem00100@;
     #rem00100@#0 = #refere1@#0;
     |LEE 101#rem00100@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem00100@;  |FINSI;
     |CIERRA #rem00100@;

     |SI #rem00100@#40 = "    ";  #rem00100@#40 = "0000";  |FINSI;

     |SI enSwConjunta = 0;  |Y #rem00100@#40 = "0000";  |Y enConta = 7;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI enSwConjuntaE = 0;  |Y enConta = 8;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |SI eaMuerto ! "";  |Y enConta = 7;
         eaLiquida = #refere1@#2;
         |HAZ BorraLiquidacion;
         eaLiquida = "";
     |FINSI;

     |DESCARGA_DEF #rem00100@;
|FPRC;

|PROCESO Empresarial1;
     |SI #rem01014@#5 = "4";  |O #rem01014@#5 = "5";
         nProfesional =  nProfesional + #rem01014@#35;
     |FINSI;
|FPRC;

|DEFBUCLE rem01014;
     #rem01014@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, Empresarial1;
|FIN;

|PROCESO rem01011_9;
     nImput = nImput + #rem01011@#12;
|FPRC;

|DEFBUCLE rem01011_9;
     #rem01011@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, 001;
     #refere1@#0, #refere1@#1, #refere1@#2, 999;
     ;
     NULL, rem01011_9;
|FIN;

|PROCESO rem01054_9;
     nSuma1 = nSuma1 + #rem01054@#4;
|FPRC;

|DEFBUCLE rem01054_9;
     #rem01011@#1004;
     ;
     #refere1@#0, #refere1@#1, #refere1@#2, "          ";
     #refere1@#0, #refere1@#1, #refere1@#2, "zzzzzzzzzz";
     ;
     NULL, rem01054_9;
|FIN;

|PROCESO SeleccionRenta;
     aDef    = eaPathDef + "rem01010.mas";
     |CARGA_DEF aDef, rem01010@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01010@#"zdat1010"#;  |FINSI;

     aDef    = eaPathDef + "rem01018.mas";
     |CARGA_DEF aDef, rem01018@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01018@#"zdat1018"#;  |FINSI;

     aDef    = eaPathDef + "rem01014.mas";
     |CARGA_DEF aDef, rem01014@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01014@#"zdat1014"#;  |FINSI;

     aDef    = eaPathDef + "rem01033.mas";
     |CARGA_DEF aDef, rem01033@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01033@#"zdat1033"#;  |FINSI;

     aDef    = eaPathDef + "rem01011.mas";
     |CARGA_DEF aDef, rem01011@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01033@;
         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01011@#"zdat1011"#;  |FINSI;

     aDef    = eaPathDef + "rem01012.mas";
     |CARGA_DEF aDef, rem01012@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def " + aDef;
         |MENAV aAlfa;

         |DESCARGA_DEF #rem01011@;
         |DESCARGA_DEF #rem01033@;
         |DESCARGA_DEF #rem01014@;
         |DESCARGA_DEF #rem01018@;
         |DESCARGA_DEF #rem01010@;

         |ACABA;
     |FINSI;

     |SI enNomeDat = 1;  |NOME_DAT #rem01012@#"zdat1012"#;  |FINSI;

     #refere1@#5 = "";
     #refere1@#6 = "N";
     #refere1@#4 = "N";

     |ABRE #rem01010@;
     #rem01010@#0 = #refere1@#0;
     #rem01010@#1 = #refere1@#1;
     #rem01010@#2 = #refere1@#2;
     |LEE 040#rem01010@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01010@;  |FINSI;
     |CIERRA #rem01010@;

     |ABRE #rem01018@;
     #rem01018@#0 = #refere1@#0;
     #rem01018@#1 = #refere1@#1;
     #rem01018@#2 = #refere1@#2;
     |LEE 040#rem01018@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01018@;  |FINSI;
     |CIERRA #rem01018@;

     |ABRE #rem01033@;
     #rem01033@#0 = #refere1@#0;
     #rem01033@#1 = #refere1@#1;
     #rem01033@#2 = #refere1@#2;
     |LEE 040#rem01033@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01033@;  |FINSI;
     |CIERRA #rem01033@;

     |ABRE #rem01012@;
     #rem01012@#0 = #refere1@#0;
     #rem01012@#1 = #refere1@#1;
     #rem01012@#2 = #refere1@#2;
     |LEE 040#rem01012@.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01012@;  |FINSI;
     |CIERRA #rem01012@;

     eaCasilla = "42-0558"; |HAZ SacaImporte;

     |SI #rem01010@#29 > 12000;  |Y enImporte = 0;
         #refere1@#4 = "S";
     |FINSI;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI #rem01010@#26 > 1;
             enPagadoresC = enPagadoresC + #rem01010@#26;
         |FINSI;
     |FINSI;

     enPagadores = #rem01010@#26;
     nTotalPag   = #rem01010@#28 - #rem01010@#30;

     nValor = 0;
     eaCasilla = "33-0461"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     |SI enImporte ! 0;
         |SI enConta ! 7;  |Y enConta ! 8;
             enPagadores  = enPagadores + 1;
         |SINO;
             enPagadoresC = enPagadoresC + 1;
         |FINSI;
         nTotalPag  = nTotalPag + enImporte;
     |FINSI;

     eaCasilla = "01-0002"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "01-0006"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "01-0007"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "01-0008"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI enConta ! 7;  |Y enConta ! 8;
         |SI nValor ] 22000;  #refere1@#4 = "S";  |FINSI;

         |SI enPagadores > 1;
             |SI nTotalPag > 1500;
                 |SI nValor > 12000;
                     #refere1@#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nValor ] 22000;  #refere1@#4 = "S";  |FINSI;

         |SI enPagadoresC > 1;
             |SI nTotalPag > 1500;
                 |SI nValor > 12000;
                     #refere1@#4 = "S";
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     nAlquiler = #rem01018@#17;
     nSuma1    = #rem01018@#22;

     nProfesional   = 0;
     |BUCLE rem01014;

     |SI nSuma1 ] 2;
         #refere1@#4 = "S";
     |SINO;
         eaCasilla = "04-0085"; |HAZ SacaImporte;
         |SI enImporte > 1000;  #refere1@#4 = "S";  |FINSI;
     |FINSI;

     nContaAct = 0;

     |SI #rem01033@#49 ! 0;  |O #rem01033@#53 ! 0;
         nPerd = #rem01033@#49 + #rem01033@#53;
         |SI nPerd > 500;
             nContaAct = nContaAct + 2;
         |FINSI;
     |FINSI;

     nSuma1 = 0;
     aDef   = eaPathDef + "rem01054.mas";
     |CARGA_DEF aDef, rem01054@;
     |SI FSalida = 0;
         |SI enNomeDat = 1;  |NOME_DAT #rem01054@#"zdat1054"#;  |FINSI;

         |BUCLE rem01054_9;

         |DESCARGA_DEF #rem01054@;
     |FINSI;

     eaCasilla = "27-0402"; |HAZ SacaImporte; nValor29 = enImporte;
     eaCasilla = "28-0406"; |HAZ SacaImporte; nValor36 = enImporte;
     nSuma = nValor29 + nValor36 + nProfesional;
     |SI nSuma = nSuma1;
         |SI nSuma ! 0;
             |SI nSuma > 1600;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |SINO;
         |SI nSuma ! 0;
             |SI nSuma > 1000;
                 nContaAct = nContaAct + 2;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor    = 0;
     eaCasilla = "08-0232"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0233"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0234"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0235"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0236"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0237"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0238"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0239"; |HAZ SacaImporte;  nValor = nValor + enImporte;
     eaCasilla = "08-0240"; |HAZ SacaImporte;  nValor = nValor + enImporte;

     |SI nValor ! 0;  nContaAct = 2;  |FINSI;

     nIngr = 0;
     nHay  = 0;

     eaCasilla = "04-0085"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#7;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#11;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     enImporte = #rem01018@#13;  nIngr = nIngr + enImporte;
     |SI enImporte ! 0;  nHay = nHay + 1;  |FINSI;

     eaCasilla = "24-0402"; |HAZ SacaImporte;
     nIngr   = nIngr + enImporte;
     nValor2 = enImporte;

     eaCasilla = "25-0406"; |HAZ SacaImporte;
     nIngr    = nIngr + enImporte;
     nValor2  = nValor2 + enImporte;
     nValor2  = nValor2 - nSuma1;
     |SI nValor2 ! 0;  nHay = nHay + 1;  |FINSI;

     eaCasilla = "01-0021"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "02-0036"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "03-0051"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "04-0084"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "09-0250"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "10-0255"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "11-0260"; |HAZ SacaImporte; nIngr = nIngr + enImporte;
     eaCasilla = "12-0264"; |HAZ SacaImporte; nIngr = nIngr + enImporte;

     |SI nHay ! 0;
         |SI nIngr ] 1000;
             nContaAct = 2;
         |FINSI;
     |FINSI;

     nValor2  = 0;
     eaCasilla = "24-0403"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;
     eaCasilla = "25-0407"; |HAZ SacaImporte; nValor2 = nValor2 + enImporte;

     |SI nValor2 ] 500;
         nContaAct = 2;
     |FINSI;

     #refere1@#5 = "";
     |SI nContaAct > 1;  #refere1@#4 = "S";  |FINSI;

     eaCasilla = "04-0084"; |HAZ SacaImporte;
     |SI enImporte > 1000;  #refere1@#4 = "S";  |FINSI;

     eaCasilla = "09-0250"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     eaCasilla = "10-0255"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     eaCasilla = "11-0260"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     eaCasilla = "12-0264"; |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "S";    |FINSI;

     nImput = 0;
     |BUCLE rem01011_9;

     nValor = (#rem01012@#13 + #rem01012@#27)  - #rem01012@#5;

     eaCasilla = "13-0266"; |HAZ SacaImporte;
     nValor = nValor + enImporte;

     eaCasilla = "16-0306"; |HAZ SacaImporte;
     nValor = nValor + enImporte;
     |SI nValor > 1600;  #refere1@#4 = "S";  |FINSI;

     nValor = #rem01012@#5 + nImput;
     |SI nValor > 1000;  #refere1@#4 = "S";  |FINSI;

     |SI nAlquiler > 0;
         eaCasilla = "04-0084"; |HAZ SacaImporte;
         nValor   = #rem01018@#15  + #rem01018@#16 + #rem01018@#19 + #rem01018@#7 + #rem01018@#8;
         nValor   = nValor + #rem01018@#11 + #rem01018@#13 + #rem01033@#133;
         nValor   = nValor + #rem01033@#48 - #rem01033@#49 + #rem01033@#52 - #rem01033@#53;
         nValor   = nValor + enImporte;

         |SI nValor > 1000;
             #refere1@#4 = "S";
         |FINSI;
     |FINSI;

     #refere1@#13 = #refere1@#5;

     |DESCARGA_DEF #rem01012@;
     |DESCARGA_DEF #rem01011@;
     |DESCARGA_DEF #rem01033@;
     |DESCARGA_DEF #rem01014@;
     |DESCARGA_DEF #rem01018@;
     |DESCARGA_DEF #rem01010@;

     |SI #refere1@#4 = "S";  |ACABA;  |FINSI;

     |SI nPerd ! 0;  |Y nIngr > 1000;
         #refere1@#4 = "R";
     |FINSI;

     eaCasilla = "43-0620"; |HAZ SacaImporte;
     |SI enImporte ] 0;  |ACABA;  |FINSI;

     eaCasilla = "35-0467";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "35-0468";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "35-0469";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "35-0470";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;

     eaCasilla = "39-0516";  |HAZ SacaImporte;
     |SI enImporte > 0;  #refere1@#4 = "R";  |FINSI;
|FPRC;
