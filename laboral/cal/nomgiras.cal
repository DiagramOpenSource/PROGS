|FICHEROS;
     nomgiras #0;
     nomir009 #100;
     nomgir9z #200;
|FIN;

|VARIABLES;
     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Elegir Opcion:";
     menu4 = "RAC";
     menu5 = "Revisar";
     menu6 = "Actualizar";
     menu7 = "Cancelar";
     nOpcion = 0;
     nAct = 0;
     aAlfa = "";
     aAlfa1 = "";
     nNume = 0;
     fFecha = @;
     aHora = "";
     nModo = 0;
|FIN;

|PROCESO Bloquea;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO GrabaLog;
     #200#0 = #0#0;
     #200#3 = 999999;
     |LEE 000#200];
     |SI FSalida = 0;
          |LEE 000#200a;
          |SI #200#0 = #0#0;
               nNume = #200#3 + 1;
          |SINO;
               nNume = 1;
          |FINSI;
     |SINO;
          nNume = 1;
     |FINSI;

     #200#0 = #0#0;
     #200#1 = #0#1;
     #200#2 = #0#3;
     #200#3 = nNume;
     aAlfa = Usuario % 0810; |QBF aAlfa;
     #200#4 = aAlfa;

     fFecha = ~;
     #200#5 = fFecha;

     |HORA aHora;
     |QBF aHora;
     aHora = aHora % 105;
     #200#6 = aHora;
     #200#7 = "nomgiras";

     |GRABA 101#200n;
     |LIBERA #200
|FPRC;

|PROCESO TodosACero;
     #0#3 = 0;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE TodosACero;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TodosACero;
|FIN;

|PROCESO TodosAUno;
     #0#3 = 1;
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE TodosAUno;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TodosAUno
|FIN;

|PROCESO Cambio; |TIPO 11;
     |SI FSalida = 13;
          |SI #0#3 = 0;
               #0#3 = 1;
          |SINO;
               #0#3 = 0;
          |FINSI;
          |GRABA 020#0.a;
          |LIBERA #0;
          |PINTA #0#3;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
     |SI FSalida = 14;
          |BUCLE TodosAUno;
          |LEE 000#0p;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
     |SI FSalida = 15;
          |BUCLE TodosACero;
          |LEE 000#0p;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
     |SI FSalida = 17;
          |SUB_EJECUTA "nomgir9z";
     |FINSI;
|FPRC;

|PROCESO Actualiza;
     |SI #0#2 ! #0#3;
          #nomir009#0 = #0#0;
          |LEE 101#nomir009.=;
          |SI FSalida = 0;
               #nomir009#21 = #0#3;
               |GRABA 020#nomir009.a;
               |HAZ GrabaLog;
               |LIBERA #nomir009;
               nAct = nAct + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Actualiza;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Actualiza;
|FIN;

|PROCESO nomir009;
     #0#0 = #nomir009#0;
     #0#1 = #nomir009#13;
     #0#2 = #nomir009#21;
     #0#3 = #nomir009#21;
     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;

|DEFBUCLE nomir009;
     #nomir009#1;
     ;
     00001;
     99999;
     ;
     NULL, nomir009;
|FIN;

|PROCESO minimo;
     #0#0 = 00001;
|FPRC;

|PROCESO maximo;
     #0#0 = 99999;
|FPRC;

|PROCESO Mensa; |TIPO 7;
     |MENSA "    < F5 > Activ/Desactiv empresa; < F6 > Activar Todas; < F7 > Desactivar Todas";
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;

     aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("t" + aAlfa1) % 108;
     |NOME_DAT #0 aAlfa1;
     |DELINDEX #0;
     |ABRE #0;

     |BUCLE nomir009;

     |CIERRA #0;

     |PARA; |SI; |HACIENDO;
          |ENTLINEAL #1#0, -1, 2, 22, 1, minimo, maximo;
          |MENU menu;
          nOpcion = FSalida;
          |SI nOpcion = 2;
               |ABRE #200;
               |ABRE #nomir009;
               |BUCLE Actualiza;
               |CIERRA #nomir009;
               |CIERRA #200;
               aAlfa = nAct;
               aAlfa = "    Actualizadas " + aAlfa + " empresas.";
               |MENAV aAlfa;
               |SAL;
          |FINSI;
          |SI nOpcion = 3;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRO;
