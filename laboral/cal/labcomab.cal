|FICHEROS;
    labcomab #0;
    labempre #1;
    labtraba #2;
    labcon00 #3;
    labcontr #100;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    FEstado = 0;
    seleccio = 0;

    sw_emp = 0;
    sw_tra = 0;

    dia1   = "";
    mes1   = "";
    any1   = "";
    fec    = "";
    sw     = 0;
    dia    = 0;
    mes    = 0;
    any    = 0;
    tope   = 0;
    mod    = 0;
    &locali_f = "";
|FIN;

|INCLUYE i_comun;
____________________________________/
|PROCESO empresa; |TIPO 0;
|SI #0#0 = 0;
    |SI sw_emp = 0;
            sw_emp = 1;
            #0#2 = "";        || nombre
            #0#3 = "";        || domicilio
            #0#4 = "";        || localidad
            #0#5 = 0;         || c.p.1
            #0#6 = 0;         || c.p.2
            #0#7 = "";        || provincia
            #0#18 = "";       || representante
            #0#19 = "";       || cargo
    |FINSI;
|SINO;
    |DDEFECTO #1;
    |ABRE #1;
        #1#0 = #0#0;
    |LEE 001#1=;
    |SI FSalida ! 0;
        |MENAV "    Empresa Inexistente ...";
    |SINO;
            #0#2 = #1#2;      || nombre
            alfa1 = #1#3;
        |QBF alfa1;
            #0#3 = alfa1 + " " + #1#4 + " " + #1#5;      || domicilio
            #0#4 = #1#6;      || localidad
            #0#5 = #1#7;      || c.p.1
            #0#6 = #1#8;      || c.p.2
            #0#7 = #1#9;      || provincia
            #0#18 = #1#15;    || representante
            #0#19 = #1#18;    || cargo
    |FINSI;
    |CIERRA #1;
|FINSI;
|PINDA #0#0;
|FPRC;

|PROCESO trabaja; |TIPO 0;
|SI #0#1 = 0;
    |SI sw_tra = 0;
            sw_tra = 1;
            #0#08 = "";       || nombre
            #0#09 = "";       || tipo contrato
            #0#10 = "";       || dni
            #0#11 = "";       || profesion
            #0#12 = "";       || puesto
    |FINSI;
|SINO;
    |DDEFECTO #2;
    |ABRE #2;
        #2#0 = #0#0;
        #2#1 = #0#1;
    |LEE 001#2=;
    |SI FSalida ! 0;
        |MENAV "    Trabajador Inexistente ...";
    |SINO;
            #0#08 = #2#2;     || nombre
            #0#09 = #2#45;    || tipo contrato
            #0#10 = #2#7;     || dni
            #0#11 = #2#19;    || profesion
            #0#12 = #2#238;   || puesto
        |SI #2#45 ! "087";|Y #2#45 ! "097";|Y #2#45 ! "006";|Y #2#45 ! "026";
                          |Y #2#45 ! "036";|Y #2#45 ! "096";|Y #2#45 ! "085";
                          |Y #2#45 ! "058";
            |MENAV "    AVISO! Comunicacion para Practicas, Aprendizaje y Formacion ...";
        |FINSI;
    |FINSI;
    |CIERRA #2;
|FINSI;
|PINDA #0#0;
|FPRC;

|PROCESO fechacon; |TIPO 0;
fec = #0Campo;
sw  = 0;

|SI fec = "          "; |ACABA; |FINSI;
|SI fec = ".........."; |ACABA; |FINSI;

dia1 = fec % 102;
mes1 = fec % 402;
any1 = fec % 704;

dia  = dia1;
mes  = mes1;
any  = any1;

|SI dia ! 0; |Y mes ! 0; |Y any ! 0;
    |SI mes [ 12; |Y mes ] 1;
        |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
            tope = 31;
        |SINO;
            |SI mes = 2;
                mod = any $ 4;
                |SI mod = 0; tope = 29; |SINO; tope = 28; |FINSI;
            |SINO;
                tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope; sw = 1; |FINSI;
    |FINSI;
|FINSI;

|SI sw = 0;
    |MENAV "0000ATENCION !!! Fecha erronea ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO lee_decret;
|DDEFECTO #3;
|ABRE #3;
    #3#0 = #0#9;
|LEE 001#3=;
|CIERRA #3;
|FPRC;

|PROCESO imprime; |TIPO 3;
|HAZ r_regis0;   r_emp = #0#0;  |HAZ r_regis1;

|ABRE #100; |LEE 000#100p; |CIERRA #100;
#100#60 = "N";
|SI #100#60 = "S";
     Impresora = "CrystalReport";
     |IMPRE -1;
|SINO;
     |IMPRE 0;
|FINSI;
|SI Impresora = "CrystalReport";
     |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
     |ACABA;
|FINSI;

|SI FSalida = 0;
    |HAZ lee_decret;
        locali_f = #0#4;
    |QBF locali_f;
        locali_f = "                              " + locali_f;
        locali_f = locali_f % -130;
    |PARA para1 = 1; |SI para1 [ #0#20; |HACIENDO para1 = para1 + 1;
        |INFOR "labcomab";
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;
|SINO;
    |MENAV "    Proceso Abortado ...";
|FINSI;
|FINIMP;
|FPRC;
