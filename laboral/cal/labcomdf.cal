|FICHEROS;
   labempre #0;
   labcomdf #1;
   labcontr #2;
|FIN;

|VARIABLES;
 x = 0;
 mod = 0;
    men3 = "0000ATENCION !!! Fecha erronea ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    dia = 0;
    mes = 0;
    any = 0;
    tope = 0;
    sw = 0;
    fec = "";
    blanco = "          ";
    puntos = "..........";
    informe = "labcomdf";
    men1 = "    ATENCION !!! No existe Empresa con ese codigo ...";
    men2 = "    ATENCION !!! No existen Parametros de Control ...";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    loca = "";
    loca1 = "";
    &local = "";
    &fcom = "";
    diacom = "";
    mescom = "";
    anycom = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
|FIN;

|INCLUYE i_comun;

|PROCESO leecontr; |TIPO 7;
|ABRE #2;
|LEE 040#2p;
|SI FSalida ! 0;
    |MENAV men2;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO proceso;
    fechacom = #1#13;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
  |SI mescom = 01;
    fechacom =  uno;
  |FINSI;
  |SI mescom = 02;
    fechacom =  dos ;
  |FINSI;
  |SI mescom = 03;
    fechacom = tres;
  |FINSI;
  |SI mescom = 04;
    fechacom = cuatro;
  |FINSI;
  |SI mescom = 05;
    fechacom = cinco;
  |FINSI;
  |SI mescom = 06;
    fechacom = seis;
  |FINSI;
  |SI mescom = 07;
    fechacom = siete;
  |FINSI;
  |SI mescom = 08;
    fechacom = ocho;
  |FINSI;
  |SI mescom = 09;
    fechacom = nueve;
  |FINSI;
  |SI mescom = 10;
    fechacom = diez;
  |FINSI;
  |SI mescom = 11;
    fechacom = once;
  |FINSI;
  |SI mescom = 12;
    fechacom = doce;
  |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    loca = #2#33;
    |QBF loca;
    loca1 = #2#33 - loca;
    local = loca1 + loca;
    local = local % -130;
    calle1 = #0#3;
    numca = #0#4;
    piso = #0#5;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numca;
    calle = calle + espa;
    calle = calle + piso;

        r_emp = #1#0;
    |HAZ r_regis1;
|PARA x = 1;|SI x [ #1#14;|HACIENDO x = x + 1;
    |INFOR informe;
    |PRINT;
    |PIEINF;
    |FININF;
|SIGUE;
|FPRC;

|PROCESO compru1; |TIPO 0;
|ABRE #0;
    #0#0 = #1Campo;
|LEE 040#0=;
|SI FSalida ! 0;
    |MENAV men1;
    |ERROR;
|SINO;
    |PINTA 0925, #0#2;
|FINSI;
|CIERRA #0;
|FPRC;

|PROCESO imprime; |TIPO 3;
|HAZ r_regis0;   r_emp = #0#0;  |HAZ r_regis1;

|ABRE #2; |LEE 000#2p; |CIERRA #2;
#2#60 = "N";
|SI #2#60 = "S";
     Impresora = "CrystalReport";
     |IMPRE -1;
|SINO;
     |IMPRE 0;
|FINSI;
|SI Impresora = "CrystalReport";
     |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
     |ACABA;
|FINSI;

|SI FSalida = 0;
    |HAZ proceso;
|SINO;
    |MENAV "    Proceso Abortado ...";
|FINSI;
|FINIMP;
|FPRC;

|PROCESO verifech; |TIPO 0;
        fec = #1Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
  dia1 = fec % A102;
  mes1 = fec % A402;
  any1 = fec % A704;
  dia = dia1; mes = mes1; any = any1;
  |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
     |SI mes [ 12; |Y mes ] 1;
       |SI mes = 1; |O mes = 3; |O mes = 5; |O mes = 7; |O mes = 8; |O mes = 10; |O mes = 12;
           tope = 31;
       |SINO;
           |SI mes = 2;
               mod = any $ 4;
               |SI mod = 0;
                   tope = 29;
               |SINO;
                   tope = 28;
               |FINSI;
            |SINO;
               tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope;
            sw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV men3;
    |ERROR;
|FINSI;
|FPRC;
