|FICHEROS;
     nomdic01;
     nomdic02;

     copiadef@ #500;
|FIN;

|VARIABLES;
     aQueQuiero = "";
     aNumCampos = "";
     nNumCampos = 0;
     nCampo = 0;
     aAlfa = "";
     aAlfa1 = "";

     nLineaReal = 0;
     nLineaNueva = 0;
     nInforme = 0;
     aPath = "";
     aDef = "";
     aFic = "";
|FIN;

|PROCESO NombreCampo;
     nCampo = #nomdic02#1;
     aAlfa1 = nCampo;
     |QBF aAlfa1;
     aAlfa1 = ("000" + aAlfa1) % -103;
     aAlfa1 = "|C" + aAlfa1 + "NOMBRE";
     #nomdic02#2 = #500#aAlfa1#;
     |PINTA #nomdic02#2;
|FPRC;

|PROCESO Carga; |TIPO 5;
     |SI Campo ! 4;
          |ACABA;
     |FINSI;

     |MENAV "     Carga";

     |DBASE aPath;
     aAlfa = #nomdic01#2;
     |QBF aAlfa;
     aDef = aPath + "/def/" + aAlfa;
     aFic = aPath + "/fich/";
     |CARGA_DEF aDef, copiadef@;

|FPRC;

|PROCESO Descarga; |TIPO 30;
     |MENAV "     Descarga";

     |DESCARGA_DEF #copiadef@;
|FPRC;

/*
|PROCESO CargaCampos; |TIPO 8;
     |DELINDEX #nomres03;
     |ABRE #nomres03;

     aQueQuiero = "|NC";
     aNumCampos = #nomtmpre#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;

     |PARA nCampo = 0; |SI nCampo [ nNumCampos;
     |HACIENDO nCampo = nCampo + 1;
          #nomres03#0 = nCampo;
          aAlfa1 = nCampo;
          |QBF aAlfa1;
          aAlfa1 = ("000" + aAlfa1) % -103;
          aAlfa1 = "|C" + aAlfa1 + "NOMBRE";
          #nomres03#1 = #nomtmpre#aAlfa1#;
          |GRABA 020#nomres03.n;
          |LIBERA #nomres03;
     |SIGUE;

     |CIERRA #nomres03;
|FPRC;

|PROCESO Copiado;
     #nomres02#0 = #nomres01#0;
     |GRABA 020#nomres02.n;
     |LIBERA #nomres02;
|FPRC;

|DEFBUCLE Copiado;
     #nomres02#1;
     ;
     nInforme, 01;
     nInforme, 99;
     be;
     NULL, Copiado;
|FIN;

|PROCESO Borrado;
     |BORRA 020#nomres02.a;
     |LIBERA #nomres02;
|FPRC;

|DEFBUCLE Borrado;
     #nomres02#1;
     ;
     #nomres01#0, 01;
     #nomres01#0, 99;
     be;
     NULL, Borrado;
|FIN;

|PROCESO Copia;
     |SI FSalida = 13;
          |PUSHV 13261964;
          |BLANCO 13261964;
          |CUADRO 14271863;
          |ATRI R;
                     || 901234567890123456789012345678901
          |PINTA 1529, "COPIAR COLUMNAS DESDE OTRO EXCEL ";
          |ATRI 0;
          |PINTA 1629, "Codigo de informe a copiar:    ";
          E_sup = 999; E_inf = "";
          nInforme = 1657 ? 0;

          |BUCLE Borrado;
          |BUCLE Copiado;
     |FINSI;
|FPRC;

|PROCESO Renumera; |TIPO 3;
     |ABRE #nomres02;
     nLineaReal = 0;
     nLineaNueva = 1;
     nInforme = #nomres01#0;

     #nomres02#0 = nInforme;
     #nomres02#1 = 1;
     |LEE 101#nomres02.];
     |SI FSalida ! 0; |O #nomres02#0 ! nInforme;
          |ACABA;
     |FINSI;

     |PARA; |SI; |HACIENDO nLineaNueva = nLineaNueva + 1;
          #nomres02#0 = nInforme;
          #nomres02#1 = nLineaNueva;
          |LEE 101#nomres02.];
          |SI FSalida ! 0; |O #nomres02#0 ! nInforme;
               |SAL;
          |SINO;
               |SI #nomres02#1 ! nLineaNueva;
                    nLineaReal = #nomres02#1;
                    |BORRA 020#nomres02.a;

                    #nomres02#1 = nLineaNueva;
                    |GRABA 020#nomres02.n;
                    |LIBERA #nomres02;
               |FINSI;
          |FINSI;
     |SIGUE;
     |CIERRA #nomres02;
|FPRC;
*/
