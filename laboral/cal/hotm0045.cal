|FICHEROS;
     hotm0045 #0;
     hotm0009;      || Planilla Mensual Cabs
     hotm0010;      || Planilla Mensual Lins
     hotm0012;      || Planilla Cabs
     hotm0013;      || Planilla Lins

     hotm0050;      || Planilla Resumen Cabs
     hotm0051;      || Planilla Resumen Lins
     labtraba;
     labcentr;
     labempre;
     nomauxi1;
     nomauxi2;
|FIN;

|VARIABLES;
     fFechaHoy = @;
     aFechaHoy = "";
     aMes = "";
     aAnyo = "";
|FIN;

|PROCESO defectomes; |TIPO 7;
     fFechaHoy = ~;
     aFechaHoy = fFechaHoy;
     aMes = aFechaHoy % 402;
     #0#5 = aMes;
     |PINTA #0#5;
|FPRC;

|PROCESO defectoanyo; |TIPO 7;
     fFechaHoy = ~;
     aFechaHoy = fFechaHoy;
     aAnyo = aFechaHoy % -104;
     #0#4 = aAnyo;
     |PINTA #0#4;
|FPRC;

|PROCESO paseLinsRes;
     #hotm0051#0 = #labtraba#0;   || empresa
     #hotm0051#1 = #0#4;          || anyo
     #hotm0051#2 = #0#5;          || mes
     #hotm0051#3 = #labtraba#1;   || trabajador
     |LEE 101#hotm0051.=;
     |SI FSalida ! 0;
          #hotm0051#4 = #labtraba#77;   || Centro
          #hotm0051#6 = #labtraba#62;   || Area
          #hotm0051#8 = #labtraba#63;   || Seccion
          #hotm0051#10 = #labtraba#2;   || Nombre Trabajador

          #labcentr#0 = #labtraba#0;    || Nombre Centro
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;
          #hotm0051#5 = #labcentr#2;

          #nomauxi1#0 = #labtraba#62;   || Nombre Area
          |LEE 000#nomauxi1.=;
          #hotm0051#7 = #nomauxi1#1;

          #nomauxi2#0 = #labtraba#62;   || Nombre Seccion
          #nomauxi2#1 = #labtraba#63;
          |LEE 000#nomauxi2.=;
          #hotm0051#9 = #nomauxi2#2;

          |GRABA 020#hotm0051.n;
     |FINSI;
     |LIBERA #hotm0051;
|FPRC;

|DEFBUCLE paseLinsRes;
     #labtraba#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, paseLinsRes;
|FIN;

|PROCESO paseCabsRes;
     #hotm0050#0 = #labempre#0;
     #hotm0050#1 = #0#4;
     #hotm0050#2 = #0#5;
     |LEE 101#hotm0050.=;
     |SI FSalida ! 0;
          |GRABA 020#hotm0050.n;
     |FINSI;
     |LIBERA #hotm0050;
     |BUCLE paseLinsRes;
|FPRC;

|DEFBUCLE paseCabsRes;
     #labempre#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, paseCabsRes;
|FIN;

|PROCESO paseLins;
     #hotm0010#0 = #hotm0013#0;   || empresa
     #hotm0010#1 = #hotm0013#1;   || trabajador
     #hotm0010#2 = #0#4;          || anyo
     #hotm0010#3 = #0#5;          || mes
     #hotm0010#4 = #hotm0013#2;   || linea
     |LEE 101#hotm0010.=;
     |SI FSalida ! 0;
          #hotm0010#5 = #hotm0013#3;
          #hotm0010#6 = #hotm0013#4;
          #hotm0010#7 = #hotm0013#5;
          #hotm0010#8 = #hotm0013#6;
          #hotm0010#9 = #hotm0013#7;
          #hotm0010#10 = #hotm0013#8;
          #hotm0010#11 = #hotm0013#9;
          #hotm0010#12 = #hotm0013#10;
          |GRABA 020#hotm0010.n;
     |FINSI;
     |LIBERA #hotm0010;
|FPRC;

|DEFBUCLE paseLins;
     #hotm0013#1;
     ;
     #0#0, #0#2, 001;
     #0#1, #0#3, 999;
     ;
     NULL, paseLins;
|FIN;

|PROCESO paseCabs;
     #hotm0009#0 = #hotm0012#0;
     #hotm0009#1 = #hotm0012#1;
     #hotm0009#2 = #0#4;
     #hotm0009#3 = #0#5;
     |LEE 101#hotm0009.=;
     |SI FSalida ! 0;
          #hotm0009#4 = #hotm0012#2;
          #hotm0009#5 = #hotm0012#3;
          |GRABA 020#hotm0009.n;
     |FINSI;
     |LIBERA #hotm0009;
|FPRC;

|DEFBUCLE paseCabs;
     #hotm0012#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, paseCabs;
|FIN;

|PROCESO tipo3; |TIPO 3;
     |SI FSalida = 0;
          |ABRE #labcentr;
          |ABRE #nomauxi1;
          |ABRE #nomauxi2;
          |ABRE #hotm0009;
          |ABRE #hotm0010;
          |ABRE #hotm0050;
          |ABRE #hotm0051;

          |BUCLE paseCabs;
          |BUCLE paseLins;

          |BUCLE paseCabsRes;

          |CIERRA #hotm0051;
          |CIERRA #hotm0050;
          |CIERRA #hotm0010;
          |CIERRA #hotm0009;
          |CIERRA #nomauxi2;
          |CIERRA #nomauxi1;
          |CIERRA #labcentr;
     |FINSI;
|FPRC;
