|FICHEROS;
     nomgirco #0;
     nomgircz #100;
|FIN;

|VARIABLES;
     aRegistro = "";
     aRegistro2 = "";
     aAlfa = "";
     aHora = "";
     nNume = 0;
     nCampo = 0;
     fFecha = @;
     aPassword = "";
|FIN;

|PROCESO Seguridad;
/*
     || desactivado en principio dejamos cambiarlo
     |SI #0Campo = "S";
          |SI #0Campo ! Contenido;
               |PUSHV 16181965;
               |BLANCO 1618 1965;
               |CUADRO 1618 1965;
               |PINTA 1720, "Introduzca Password : ";
               E_inf = "";
               E_sup = "20";
               aPassword = 1742 ? -1;
               |SI aPassword ! "<MYPASWD>     ";
               |Y aPassword !  "<MYPASWD>               ";
                   |MENAV "     Permiso denegado.";
                   #0Campo = "N";
               |FINSI;
               |POPV;
               |PINTA #0Campo;
          |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO GrabaHis;
     |ABRE #100;
     |LEE 000#100u;
     |SI FSalida = 0;
          nNume = #100#0 + 1;
     |SINO;
          nNume = 1;
     |FINSI;
     #100#0 = nNume;
     |PARA nCampo = 1; |SI nCampo [ 7; |HACIENDO nCampo = nCampo + 1;
          #100nCampo = #0nCampo;
     |SIGUE;
     aAlfa = Usuario % 0810; |QBF aAlfa;
     #100#8 = aAlfa;

     fFecha = ~;
     #100#9 = fFecha;

     |HORA aHora;
     |QBF aHora;
     aHora = aHora % 105;
     #100#10 = aHora;

     |GRABA 101#100n;
     |LIBERA #100
     |CIERRA #100;
|FPRC;

|PROCESO ConsultaLog;
     |SI FSalida = 17;
          |SUB_EJECUTA "nomgircz";
          |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
         |DDEFECTO #0;
         |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;
     |PINDA #0#0;

     aRegistro = "";
     |PARA nCampo = 1; |SI nCampo [ 7; |HACIENDO nCampo = nCampo + 1;
          |SI nCampo = 4; |O nCampo = 5;
               aAlfa = #0nCampo;
               |QBF aAlfa
               aAlfa = ("     " + aAlfa) % -105;
          |FINSI;
          |SI nCampo = 6; |O nCampo = 7;
               aAlfa = #0nCampo;
               |QBF aAlfa
               aAlfa = ("       " + aAlfa) % -107;
          |FINSI;
          aRegistro = aRegistro + aAlfa;
     |SIGUE;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          aRegistro2 = "";
          |PARA nCampo = 1; |SI nCampo [ 7; |HACIENDO nCampo = nCampo + 1;
               |SI nCampo = 4; |O nCampo = 5;
                    aAlfa = #0nCampo;
                    |QBF aAlfa
                    aAlfa = ("     " + aAlfa) % -105;
               |FINSI;
               |SI nCampo = 6; |O nCampo = 7;
                    aAlfa = #0nCampo;
                    |QBF aAlfa
                    aAlfa = ("       " + aAlfa) % -107;
               |FINSI;
               aRegistro2 = aRegistro2 + aAlfa;
          |SIGUE;
          |GRABA 020#0a;
          |SI aRegistro ! aRegistro2;
               |HAZ GrabaHis;
          |FINSI;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
