|FICHEROS;
    labcontr #0;
    labcenfo;
    labclean;
|FIN;

|VARIABLES;
    aAlfa = "";
    aAlfa1 = "";

    aRuta = "";
    aRuta0 = "";
    aFic = "";
    nSw = 0;
    aLon = "";
    nPos = 0;
    aDes = "";
    aPath = "";
    i = 0;

     &eaCadena = "";
     &eaCadenaSal = "";
     &eaCaracter1 = "";
     &eaCaracter2 = "";
|FIN;

|PROCESO Inicia;
     |ABRE #labclean;
     #labclean#0 = "labcontr";
     #labclean#1 = 6;
     |LEE 101#labclean.=;
     |SI FSalida ! 0;
          #labclean#0 = "labcontr";
          #labclean#1 = 6;
          #labclean#2 = "S";
          |GRABA 020#labclean.n;

          |ABRE #labcontr;
          |LEE 101#labcontr.p;
          #labcontr#6 = 0;
          |GRABA 020#labcontr.a;
          |LIBERA #labcontr;
          |CIERRA #labcontr;
     |FINSI;
     |CIERRA #labclean;
     |LIBERA #labclean;
|FPRC;

|PROGRAMA;
|HAZ Inicia;
|CLS;
|PINPA #0#0;
|CABEZA "Control Aplicacion";
|ABRE #0;
|DDEFECTO #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;

|PROCESO Duplex; |TIPO 7;
|SI #0#19 = "S";
     #0#41 = "N";
     |PINTA #0#41;
     |C_M #0#41, 1, "N";
     |C_M #0#42, 1, "N";
     |C_M #0#43, 1, "N";
|SINO;
     |C_M #0#41, 1, "S";
     |C_M #0#42, 1, "S";
     |C_M #0#43, 1, "S";
|FINSI;
     |SI #0#41 = "S";
          aAlfa = "    AVISO: Modo Duplex " + &34 + "S" + &34 + " no valido. ";
          aAlfa = aAlfa + "Pasa a modo " + &34 + "W" + &34 + ".";
          |MENAV aAlfa;
          aAlfa = "    Debera configurar su impresora de Windows para poder ";
          aAlfa = aAlfa + "imprimir en modo Duplex.";
          |MENAV aAlfa;
          #0#41 = "W";
          |PINTA #0#41;
     |FINSI;
|FPRC;

|PROCESO NoDuplex; |TIPO 7;
     |C_M #0Campo, 1, "N";
     |SI #0#41 = "S";
          |C_M #0Campo, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Pausas; |TIPO 0;
     |SI Contenido ! #0#19;|Y #0#19 = "S";
          |SI #0#41 ! "N";
               |AVISO;
               |CONFI "0000SIncompatible con modo DUPLEX. Continuar? ";
               |SI FSalida = 0;
                    #0#41 = "N";
                    |PINTA #0#41;
               |SINO;
                    #0#19 = Contenido;
                    |PINTA #0#19;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Activa66;
     |SI #labcontr#67 = "N";
          |CAMPO_MODIFICA #0#66, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#66, 1, "S";
          || ahora pueden elegir dos si esta concertada 21/04/2015
          |ABRE #labcenfo;
          #labcenfo#23 = 1820126;
          |LEE 101#labcenfo.=;
          |SI FSalida ! 0;
               #labcenfo#2 = "EDUCACION TECNICA A DISTANCIA S.L.";
               #labcenfo#23 = "1820126";
               #labcenfo#22 = "EDUCACION TECNICA A DISTANCIA S.L.";
               #labcenfo#3 = "B18032623";
               #labcenfo#38 = "RAFAEL PEREZ IBAÑEZ";
               #labcenfo#40 = "Representante";
               #labcenfo#39 = "24095074K";

               #labcenfo#4 = "POLIGONO ASEGRA, CL. ALMERIA, P.7";
               #labcenfo#21 = "PELIGROS";
               #labcenfo#19 = 18;
               #labcenfo#20 = 210;
               #labcenfo#24 = "GRANADA";
               #labcenfo#6 = "RAFAEL PEREZ IBA¤EZ";
               #labcenfo#5 = "958405152";
               #labcenfo#25 = "958405280";
               #labcenfo#26 = "contratosformacion@edutedis.com";
               |GRABA 020#labcenfo.n;
               |LIBERA #labcenfo;
          |FINSI;

          |ABRE #labcenfo;
          #labcenfo#23 = "4100000298";
          |LEE 101#labcenfo.=;
          |SI FSalida ! 0;
               #labcenfo#2 = "SYSTEM CENTROS DE FORMACION, S.L.";
               #labcenfo#23 = "4100000298";
               #labcenfo#22 = "SYSTEM CENTROS DE FORMACION, S.L.";
               #labcenfo#3 = "B41273392";
               #labcenfo#38 = "SILVIA CONDE SANCHEZ";
               #labcenfo#40 = "Representante";
               #labcenfo#39 = "28704662H";

               #labcenfo#4 = "AV. JUAN ANTONIO CAVESTANY, 10";
               #labcenfo#21 = "SEVILLA";
               #labcenfo#19 = 41;
               #labcenfo#20 = 003;
               #labcenfo#24 = "SEVILLA";
               #labcenfo#6 = "SILVIA CONDE SANCHEZ";
               #labcenfo#5 = "954502550";
               #labcenfo#26 = "gestion@systemformacion.es";
               |GRABA 020#labcenfo.n;
               |LIBERA #labcenfo;
          |FINSI;
/*
          #labcontr#66 = 1820126;
          |PINTA #labcontr#66;
          |ATRI I;
          |PINTA 2243, #labcenfo#2;
          |ATRI I;
          |CIERRA #labcenfo;
*/
     |FINSI;
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO Comp81; |TIPO 0;
     |SI #0#81 > 1;
          |SI #0#79 = 0;
              aAlfa = "    ATENCION. La impresión de varias copias sólo es posible si se ";
              aAlfa = aAlfa + "activa la emisión de contratos en un solo PDF.";
              |MENAV aAlfa;

               #0#81 = 1;
               |PINTA #0#81;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ayuda81; |TIPO 7;
     |PUSHV 10402380;
              ||   4         5         6         7         8
              ||   01234567890123456789012345678901234567890
     |ATRI R;
     |PINTA 1040, " N£mero de copias:                       ";
     |PINTA 1140, " -----------------                       ";
     |PINTA 1240, " Con esta opci¢n  indicaremos el  n£mero ";
     |PINTA 1340, " de copias  que se generar n  en la emi- ";
     |PINTA 1440, " si¢n de contratos EN UN SOLO PDF.       ";
     |PINTA 1540, " Si se activa  la impresi¢n de  la copia ";
     |PINTA 1640, " b sica, s¢lo se emitir  una copia salvo ";
     |PINTA 1740, " que se active la impresi¢n de una copia ";
     |PINTA 1840, " adicional si este existiera.            ";
     |PINTA 1940, " Esta opci¢n s¢lo se utilizar  en la im- ";
     |PINTA 2040, " presi¢n de contratos en un solo PDF, de ";
     |PINTA 2140, " otro modo el n£mero de copias  se indi- ";
     |PINTA 2240, " car  desde  el cuadro de  impresi¢n del ";
     |PINTA 2340, " Adobe Reader.                           ";
     |ATRI 0;
|FPRC;

|PROCESO Activa80; |TIPO 7;
     |SI #0#79 = 0;
          |CAMPO_MODIFICA #0#80, 1, "N";
          #0#80 = "N";
          |PINTA #0#80;
     |SINO;
          |CAMPO_MODIFICA #0#80, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Ayuda80; |TIPO 7;
     |PUSHV 10402380;
              ||   4         5         6         7         8
              ||   01234567890123456789012345678901234567890
     |ATRI R;
     |PINTA 1040, " Opciones:                               ";
     |PINTA 1140, " (S) Si el n£mero de p ginas  de cl usu- ";
     |PINTA 1240, "     las o anexos  es IMPAR, se  a¤adir  ";
     |PINTA 1340, "     una  hoja en blanco  para que en la ";
     |PINTA 1440, "     impresi¢n  a doble cara  no se mez- ";
     |PINTA 1540, "     clen  distintos  documentos  en  el ";
     |PINTA 1640, "     mismo folio. ELEGIR  ESTA OPCION SI ";
     |PINTA 1740, "     SE VAN A IMPRIMIR CONTRATOS A DOBLE ";
     |PINTA 1840, "     CARA.                               ";
     |PINTA 1940, " (N) No se a¤aden hojas en blanco. ELIJA ";
     |PINTA 2040, "     ESTA OPCION SI NO SE VAN A IMPRIMIR ";
     |PINTA 2140, "     CONTRATOS A DOBLE CARA.             ";
     |PINTA 2240, "                                         ";
     |ATRI 0;
|FPRC;

|PROCESO Comp65; |TIPO 0;
     |SI #0#65 = 0;
          |SI #0#79 = 1;
              aAlfa = "    ATENCION. Con versiones de Reader anteriores a la 8, no es posi- ble ";
              aAlfa = aAlfa + "emitir contratos en un solo PDF.";
              |MENAV aAlfa;

               #0#79 = 0;
               |PINTA #0#79;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Comp79; |TIPO 0;
     |SI #0#65 = 0;
          |SI #0#79 = 1;
              aAlfa = "    ATENCION. Esta opción no está disponible para "
              aAlfa = aAlfa + "versiones de Adobe Reader inferiores a la 8";
              |MENAV aAlfa;

               #0#79 = 0;
               |PINTA #0#79;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ayuda79; |TIPO 7;
     |PUSHV 10402380;
              ||   4         5         6         7         8
              ||   01234567890123456789012345678901234567890
     |ATRI R;
     |PINTA 1040, " Opciones:                               ";
     |PINTA 1140, " (0) Se emiten los contratos en PDF como ";
     |PINTA 1240, "     habitualmente. Cada documento en un ";
     |PINTA 1340, "     PDF diferente.                      ";
     |PINTA 1440, " (1) Todos los documentos del  contrato: ";
     |PINTA 1540, "     contrato, copia b sica, anexos, etc ";
     |PINTA 1640, "     se emiten en el mismo PDF. Este PDF ";
     |PINTA 1740, "     NO ES MODIFICABLE. No se podr n mo- ";
     |PINTA 1840, "     dificar los datos  del contrato so- ";
     |PINTA 1940, "     bre el PDF.                         ";
     |PINTA 2040, "                                         ";
     |ATRI 0;
|FPRC;

|PROCESO Ayuda54; |TIPO 7;
     |PUSHV 10402380;
              ||   4         5         6         7         8
              ||   01234567890123456789012345678901234567890
     |ATRI R;
     |PINTA 1040, " Esta opci¢n, en la impresi¢n de contra- ";
     |PINTA 1140, " tos, s¢lo  se  aplica cuando  la opci¢n ";
     |PINTA 1240, " anterior  'Tipo de impresi¢n contratos' "
     |PINTA 1340, " tiene  el valor '0' y por tanto, se im- ";
     |PINTA 1440, " men los documentos del contrato en PDFs ";
     |PINTA 1540, " separados.                              ";
     |PINTA 1640, "                                         ";
|FPRC;

|PROCESO Barras;
     eaCadena = #0#51;
     eaCaracter1 = "/";
     eaCaracter2 = "\";
     |HAZ sustituye_plb;
     #0#51 = eaCadenaSal;
     |PINTA #0#51;
|FPRC;
