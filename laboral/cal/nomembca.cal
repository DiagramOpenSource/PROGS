|FICHEROS;
     nomembca #1;
     nomembli #2,MANTE;
     nomembcf,MANTE;
     labempre;
     labtraba;
     nomcontr;
|FIN;

|VARIABLES;
     aModulo = "";
     nModo = 0;
     nCampo = 0;
     nUltimEmp = 0;
     nUltimTra = 0;
     nUltimAny = 0;
     nTipo = 0;
     enBoton = 0;
     aAlfa = "";
     swBloqueado = 0;

     aParam = "";
     aAlfa1 = "";
     aAlfa2 = "";
     nEmp = 0;
     nTra = 0;
     FEstado = 0;
|FIN;

|PROCESO Activa10;
     |SI #1#9 = "S";
          |ATRI 0;
          |CAMPO_MODIFICA #1#10, 1, "S";
          |CAMPO_VISUAL #1#10, 1, "S";
          |PINTA 0853, "Tipo emb. indem:    ³";
          |PINTA #1#10;
          |ATRI R;
     |SINO;
          |ATRI 0;
          |CAMPO_MODIFICA #1#10, 1, "N";
          |CAMPO_VISUAL #1#10, 1, "N";
          |PINTA 0853, "                    ³";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Activa07; |TIPO 7;
     |SI #1#4 = 4;
          |ATRI 0;
          |CAMPO_MODIFICA #1#7, 1, "S";
          |CAMPO_VISUAL #1#7, 1, "S";
          |PINTA 0926, "-   ";
          |PINTA #1#7;
          |ATRI R;
     |SINO;
          |ATRI 0;
          |CAMPO_MODIFICA #1#7, 1, "N";
          |CAMPO_VISUAL #1#7, 1, "N";
          #nomembca#7 = 0;
          |PINTA 0926, "    ";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Ayuda4; |TIPO 7;
     |PUSHV 09012349;
     |ATRI R;
               ||  0    1         2         3         4
               ||  6789012345678901234567890123456789012345678
     |PINTA 0906, "      - Tipos de c lculo de embargo -      ";
     |PINTA 1006, " 1. Cantidad fija todos los meses.         ";
     |PINTA 1106, " 2. Porcentaje sobre el l¡quido mensual    ";
     |PINTA 1206, " 3. C lculo autom tico seg£n normativa le- ";
     |PINTA 1306, "    gal. Se calcula seg£n c lculo anterior ";
     |PINTA 1406, "    de la AEAT, siendo inembargable un SMI ";
     |PINTA 1506, "    por paga extra,incluyendo prorrateadas ";
     |PINTA 1606, " 4. Igual que el punto 3 para embargos so- ";
     |PINTA 1706, "    bre deudores hipotecarios que han per- ";
     |PINTA 1806, "    dido su vivienda habitual.             ";
     |PINTA 1906, " 5. C lculo autom tico seg£n normativa le- ";
     |PINTA 2006, "    gal, seg£n c lculo ACTUAL de la  AEAT, ";
     |PINTA 2106, "    siendo inembargable UN SMI por mes in- ";
     |PINTA 2206, "    dependientemente de las  pagas  extras ";
     |PINTA 2306, "    que tenga el trabajador.               ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

/*

|| paso de botones de moemento

|PROCESO F5;

|FPRC;

|PROCESO NoBoton; |TIPO 11;
     |FIN_CONTROL_WINDOWS enBoton;
|FPRC;

|PROCESO Boton;
     |CONTROL_SIMPLE 0, "BOTON,F5 Conceptos", 1150, 1171, F5;
     enBoton = FSalida;
     |ESTADO_CONTROL enBoton, "ENABLE";
|FPRC;
*/

|PROCESO borra_con;
     |BORRA 020#nomembcf.a;
     |LIBERA #nomembcf;
|FPRC;

|DEFBUCLE borra_con;
     #nomembcf#1;
     ;
     #nomembca#0, #nomembca#1, 001;
     #nomembca#0, #nomembca#1, 999;
     be;
     NULL, borra_con;
|FIN;

|PROCESO Borrado; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE borra_con;
     |FINSI;
|FPRC;

|PROCESO Dto1; |TIPO 7;
     |CAMPO_MODIFICA #1#5, 1, "S";
     |SI #1#4 = 3; |O #1#4 = 4; |O #1#4 = 5;
          #1#5 = 0;
          |PINTA #1#5;
          |CAMPO_MODIFICA #1#5, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Dto2;
     |SI #1#4 = 2; |Y #1#5 > 100;
          |MENAV "    ATENCION: El porcentaje de descuento nunca puede superar el 100%";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO superior;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = 2999;
|FPRC;

|PROCESO inferior;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = 1999;
|FPRC;

|PROCESO lineal;
     |SI swBloqueado = 1;
          |ENTLINEAL #1#2, -3, 4, 22, 0, inferior, superior;
     |SINO;
          |ENTLINEAL #1#2, -3, 2, 22, 0, inferior, superior;
     |FINSI;
|FPRC;

|PROCESO tipo3auto; |TIPO 3;
     |SI FSalida = 0;
/*
          |MODULO aModulo;
          |QBF aModulo;
          |SI aModulo = "labtraba"; |O aModulo = "nomw0003";
               nModo = (FEntrada / 100) ! 0;
               |SI nModo = 1;
                    |GRABA 020#nomembca.n;
               |SINO;
                    |GRABA 020#nomembca.a;
               |FINSI;
          |FINSI;
*/

          |HAZ lineal;
     |FINSI;
|FPRC;

|PROCESO tipo8auto; |TIPO 13;
     |HAZ Activa07;
     |ENTLINEAL #1#2, -3, 7, 22, 0, inferior, superior;

/*
     |MODULO aModulo;
     |QBF aModulo;
     |SI aModulo = "labtraba"; |O aModulo = "nomw0003";
          |PDEFECTO #2, 3, 33;
          |PUSHV 11102317;
          |PINDA #0#2;
          |POPV;

          |SI aModulo = "labtraba"; |O aModulo = "nomw0003";
               #1#2 = #labempre#2;
               #1#3 = #labtraba#2;
               #1#6 = #labempre#19;
               #1#7 = #labempre#20;
               |PINTA #1#2;
               |PINTA #1#3;
               |PINTA #1#6;
               |PINTA #1#7;
          |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO borra;
     |BORRA 020#nomembli.a;
|FPRC;

|DEFBUCLE borra;
     #nomembli#1;
     ;
     #1#0, #1#1, 0000;
     #1#0, #1#1, 9999;
     be;
     NULL, borra;
|FIN;

|PROCESO borraauto; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE borra;
     |FINSI;
/*
     |MODULO aModulo;
     |QBF aModulo;
     |SI aModulo = "labtraba"; |O aModulo = "nomw0003";
          |SI nModo = 1; |O nModo = 3;
               #1#2 = #labempre#2;
               #1#3 = #labtraba#2;
               |PINTA #1#2;
               |PINTA #1#3;
          |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO Ultimo;
     nUltimEmp = #nomembli#0;
     nUltimTra = #nomembli#1;
     nUltimAny = #nomembli#2;
|FPRC;

|DEFBUCLE Ultimo;
     #nomembli#1;
     ;
     #nomembca#0, #nomembca#1, 1999;
     #nomembca#0, #nomembca#1, 2999;
     ;
     NULL, Ultimo;
|FIN;

|PROCESO superior_p;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = nUltimAny;
|FPRC;

|PROCESO inferior_p;
     #2#0 = #1#0;
     #2#1 = #1#1;
     #2#2 = nUltimAny;
|FPRC;

|PROCESO Muestra; |TIPO 14;
     |ENTLINEAL #1#2, -3, 7, 22, 1, inferior, superior;

     nUltimAny = 0;
     |ABRE #2;
     |BUCLE Ultimo;
     |SI nUltimAny ! 0;
          #2#0 = nUltimEmp;
          #2#1 = nUltimTra;
          #2#2 = nUltimAny;
          |LEE 000#2=;
          |PARA nCampo = 3; |SI nCampo [ 29; |HACIENDO nCampo = nCampo + 1;
               |PINTA #2nCampo;
          |SIGUE;
     |FINSI;
     |CIERRA #2;
     |ATRI I;
|FPRC;

|PROCESO min_con;
     #nomembcf#0 = #nomembca#0;
     #nomembcf#1 = #nomembca#1;
     #nomembcf#2 = 101;
|FPRC;

|PROCESO max_con;
     #nomembcf#0 = #nomembca#0;
     #nomembcf#1 = #nomembca#1;
     #nomembcf#2 = 999;
|FPRC;

|PROCESO Repon;
     || dos veces pon
     |SI #nomembca#4 ! 1;
          |POPV;
     |SINO;
          |SI Campo = 4;
               |POPV;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PintaConceptos; |TIPO 7;
     |SI #nomembca#4 ! 1;
          |SI Campo = 4;
               nTipo = #nomembca#4
          |FINSI;
          |PUSHV 11491671;
          |ENTLINEAL #1#nomembcf, -3, 7, 15, 1, min_con, max_con;
     |FINSI;
|FPRC;

|PROCESO IntroConceptos;
     |SI FSalida = 13; |Y #nomembca#4 ! 1;
          |ENTLINEAL #1#nomembcf, -3, 1, 15, 1, min_con, max_con;
     |FINSI;
|FPRC;

|PROCESO Comp; |TIPO 2;
     |SI #nomembli#27 = 0; |O #nomembli#29 = 0;
          aAlfa = "    ATENCION: el campo 'Total' y el campo 'Pendiente' ";
          aAlfa = aAlfa + "no pueden estar a cero.";
          |MENAV aAlfa;
          aAlfa = "    Si no se indica el importe en estos dos campos, no se ";
          aAlfa = aAlfa + "calculará el embargo";
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Bloquea;
     |DBASS aAlfa;
     |QBF aAlfa;
     |SI aAlfa = "/u/dsprofes/";
          swBloqueado = 0;
          |ACABA;
     |FINSI;

     |ABRE #nomcontr; |LEE 000#nomcontr.p; |CIERRA #nomcontr;
     |SI #nomcontr#65 = "S";
          nModo = (FEntrada / 100) ! 0;
          |SI nModo ! 4;
               swBloqueado = 1;
               aAlfa = "    ATENCION. Se encuentra activado el enlace con la ";
               aAlfa = aAlfa + "Gestión de Embargos de la Plataforma Integrada";
               |MENAV aAlfa;
               aAlfa = "    Sólo está disponible el modo consulta.";
               |MENAV aAlfa;
               |PTEC 806;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Bloquea2; |TIPO 7;
     swBloqueado = 0;
     |ABRE #nomcontr; |LEE 000#nomcontr.p; |CIERRA #nomcontr;
     |SI #nomcontr#65 = "S";
          swBloqueado = 1;
     |FINSI;
     |DBASS aAlfa;
     |QBF aAlfa;
     |SI aAlfa = "/u/dsprofes/";
          swBloqueado = 0;
     |FINSI;
     |SI swBloqueado = 1;
          |CAMPO_MODIFICA #1#4, 1, "N";
          |CAMPO_MODIFICA #1#5, 1, "N";
          |CAMPO_MODIFICA #1#6, 1, "N";
          |CAMPO_MODIFICA #1#7, 1, "N";
          aAlfa = "    Sólo se permite acceder a las líneas ";
          aAlfa = aAlfa + "en modo consulta.";
          |MENAV aAlfa;
     |FINSI;
|FPRC;
/*
|PROGRAMA;
     aParam = PARAMETRO;
     |QBF aParam;
     |SI aParam = "";
          |MANTE #1;
     |SINO;
          aAlfa1 = aParam % 105;
          aAlfa2 = aParam % -105;
          nEmp = aAlfa1;
          nTra = aAlfa2;

          |PINPA #0#nomembca;
          |DDEFECTO #nomembca;
          |ABRE #nomembca;
          #nomembca#0 = nEmp;
          #nomembca#1 = nTra;
          |LEE 101#nomembca.=;
          FEstado = FSalida;

          |PINDA #0#nomembca;
          |ENDATOS #1#nomembca;
          |SI FSalida = 0;
               |SI FEstado = 0;    |GRABA 020#nomembca.a;     |FINSI;
               |SI FEstado ! 0;    |GRABA 020#nomembca.n;     |FINSI;
          |FINSI;
          |LIBERA #nomembca;
          |CIERRA #nomembca;
     |FINSI;
|FPRO;
*/
