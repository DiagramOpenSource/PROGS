|FICHEROS;
     laboru01;
     laborw02,MANTE;

     dsam0108@;
|FIN;

|VARIABLES;
     n0Vent              = 0;
     n1Vent              = 0;
     nGrid               = 0;
     nBtnAlt             = 0;
     nBtnMod             = 0;
     nBtnBor             = 0;
     nRango              = 0;
     nPI                 = 0;

     aEsc1               = "";
     aEsc2               = "";
     aRetu               = "";
     aTecla              = "";
     aBase               = "";
     aMas                = "";

 {-1}aVent               = "";
     aVent1              = 0;
     aVent2              = 0;
     aVent3              = 0;
     aVent4              = 0;
     aVent5              = "";
|FIN;

|PROCESO Evnt;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#laboru01.=;

         |ESTADO_CONTROL nBtnMod, "ENABLE";
         |ESTADO_CONTROL nBtnBor, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO Modificar;
     |VENTANA 0501, 1765, -1, 16, "Configuraci¢n notificaci¢n";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |LEE 101#laboru01.=;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     |DDEFECTO #laborw02;
     #laborw02#0 = #laboru01#0;
     #laborw02#1 = #laboru01#1;
     #laborw02#2 = #laboru01#2;
     #laborw02#3 = #laboru01#3;
     #laborw02#4 = #laboru01#4;
     #laborw02#5 = #laboru01#5;

     |PINPA #0#laborw02;
     |PINDA #0#laborw02;

     |ENDATOS #2#laborw02;
     |SI FSalida = 0;
         #laboru01#1 = #laborw02#1;
         #laboru01#2 = #laborw02#2;
         #laboru01#3 = #laborw02#3;
         #laboru01#4 = #laborw02#4;
         #laboru01#5 = #laborw02#5;

         |GRABA 020#laboru01.a;
         |LIBERA #laboru01;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;

     |PULSATECLA;
|FPRC;

|PROCESO Alta;
     |CONSULTA_CLAVE #1#dsam0108@;
     |SI FSalida ! 0;
         |ACABA;
     |FINSI;

     #laboru01#0 = #dsam0108@#0;
     |LEE 101#laboru01.=;
     |SI FSalida ! 0;
         |DDEFECTO #laboru01;
         #laboru01#0 = #dsam0108@#0;
         #laboru01#1 = #dsam0108@#1;
         #laboru01#2 = #dsam0108@#3;
         |GRABA 020#laboru01.n;
         |LIBERA #laboru01;

         |HAZ Modificar;

         |REFRESCACONTROL nGrid;
         |FOCOTECLADO nGrid;
     |SINO;
         |LIBERA #laboru01;
         |MENAV "0000El usuario ya est  en la lista";
     |FINSI;
|FPRC;

|PROCESO Borrar;
     |LEE 101#laboru01.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NSeguro que quiere borrar el usuario seleccionado";
     |SI FSalida ! 0;
         |LIBERA #laboru01;
         |ACABA;
     |FINSI;

     |BORRA 020#laboru01.a;
     |LIBERA #laboru01;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROGRAMA;
     |SI nPI = 0;
         |MENAV "0000Opci¢n para PI";
         |ACABA;
     |FINSI;

     |CLS;
     |CABEZA "Lista usuarios avisos";

     |VENTANA 0501, 2799, -1, 1, "";
     n0Vent = FSalida;

     |CONTROL_SIMPLE 0, "LABEL,{{15}}Control de usuarios para notificaciones ", 0502, 0590, NULL;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta ", 2588, 2598, Alta;
     nBtnAlt = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Modificacion ", 2574, 2586, Modificar;
     nBtnMod = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Baja ", 2562, 2572, Borrar;
     nBtnBor = FSalida;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#laboru01, nRango, 0702, 2498, NULL, NULL, Evnt;
     nGrid = FSalida;

     |ESTADO_CONTROL nBtnMod, "DISABLE";
     |ESTADO_CONTROL nBtnBor, "DISABLE";

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBtnAlt;
     |FIN_CONTROL_WINDOWS nBtnMod;
     |FIN_CONTROL_WINDOWS nBtnBor;

     |DESTRUYECONTROL nGrid;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO T80;  |TIPO 80;
     nPI = 0;

     |DBASS aBase;
     aMas  = aBase + "integral/def/dsam0108.mas";
     |CARGA_DEF aMas, dsam0108@;
     |SI FSalida = 0;
         nPI = 1;

         |ABRET #dsam0108@;
     |FINSI;

     |ABRET #laboru01;

     FSalida = 2799;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |SI nPI = 1;
         |CIERRAT #dsam0108@;
         |DESCARGA_DEF #dsam0108@;
     |FINSI;

     |CIERRAT #laboru01;
|FPRC;
