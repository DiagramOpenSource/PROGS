|FICHEROS;
     zominf09 #0;
     labempre;
     labtraba;
     nomhicca;
     nomhicli;
|FIN;

|VARIABLES;
     nDesdeAny = 0;
     nHastaAny = 0;
     swHayAlgo = 0;
|FIN;

|PROCESO nomhicli;

     #nomhicca#0 = #nomhicli#0;
     #nomhicca#1 = #nomhicli#1;
     #nomhicca#66 = #nomhicli#12;
     #nomhicca#2 = #nomhicli#2;
     #nomhicca#3 = #nomhicli#3;
     |LEE 000#nomhicca.=;
     |SI FSalida ! 0;
          swHayAlgo = 1;

          #labempre#0 = #nomhicli#0;
          |LEE 000#labempre.=;
          |SI FSalida ! 0;
               #labempre#2 = "NO EXISTE EMPRESA";
          |FINSI;

          #labtraba#0 = #nomhicli#0;
          #labtraba#1 = #nomhicli#1;
          |LEE 000#labtraba.=;
          |SI FSalida ! 0;
               #labtraba#2 = "NO EXISTE TRABAJADOR";
          |FINSI;

          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicli;
     #nomhicli#1;
     ;
     #0#0, #0#2, nDesdeAny, #0#6, 00, 101;
     #0#1, #0#3, nHastaAny, #0#7, 20, 101;
     ;
     NULL, nomhicli;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |INFOR "zominf09";

          nDesdeAny = #0#4 - 2000;
          nHastaAny = #0#5 - 2000;

          |ABRE #labempre;
          |ABRE #labtraba;
          |ABRE #nomhicca;
          |ABRE #nomhicli;

          |BUCLE nomhicli;

          |CIERRA #nomhicli;
          |CIERRA #nomhicca;
          |CIERRA #labtraba;
          |CIERRA #labempre;

          |SI swHayAlgo = 0;
               |MENAV "    No se han encontrado trabajadores afectados";
          |FINSI;

          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRO;
