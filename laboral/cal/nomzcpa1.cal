|FICHEROS;
     nomzcpa1 #0;
     labtraba;
     nomcalca;
     nomcalli;
     nomhicca;
     nomhicli;
     nomconli #10;
     nom400eu;
|FIN;

|VARIABLES;
     nSuma = 0;
     aSuma = "";
     nSuma400 = 0;
     aSuma400 = "";
     nRemu = 0;
     aRemu = "";
     swHay400 = 0;
     &nAfectados = 0;
     &nRevisados = 0;
     &nRectificados = 0;
     product = 0;
     &aEmp = "";
     &aTra = "";
     &aMes = "";
     &aDonde = "";
     aResta = "";
     nResta = 0;
     &nProrrata = 0;
     &nCalculada = 0;
     nNume = 0;
|FIN;

|PROCESO nomhicca;
     #labtraba#0 = #nomhicca#0;
     #labtraba#1 = #nomhicca#1;
     |LEE 000#labtraba.=;

     #nom400eu#0 = #nomhicca#0;
     #nom400eu#1 = #nomhicca#1;
     #nom400eu#2 = 2008;
     #nom400eu#3 = 06;
     |LEE 000#nom400eu.=;
     |SI FSalida = 0;
          |SI #nom400eu#12 ! #nomhicca#15;
               nCalculada = #nomhicca#15;
               nProrrata = #nom400eu#12;
               aEmp = #nomhicca#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
               aTra = #nomhicca#1; aTra = "00000" + aTra; aTra = aTra % -105;
               aMes = #nomhicca#2; aMes = "00" + aMes; aMes = aMes % -102;
               aDonde = "H";
               nAfectados = nAfectados + 1;
               nRevisados = nRevisados + 1;
               |PRINT;
               |SI #0#4 = "S";
                    |SI #nomhicca#14 = #nom400eu#4;    || base 1 IRPF nomina
                         #nomhicca#13 = #nom400eu#11;  || % 1 IRPF
                         #nomhicca#15 = #nom400eu#12;  || Cuota 1
                         #nomhicca#114 = #nomhicca#114 - #nom400eu#6 + #nom400eu#12;
                         #nomhicca#151 = #nomhicca#151 + #nom400eu#6 - #nom400eu#12;
                    |FINSI;
                    |SI #nomhicca#16 = #nom400eu#7;    || base paga IRPF nomina
                         #nomhicca#129 = #nom400eu#14; || % paga IRPF
                         #nomhicca#17 = #nom400eu#15;  || Cuota Paga
                         #nomhicca#153 = #nomhicca#153 + #nom400eu#9 - #nom400eu#15;
                    |FINSI;
                    |SI #nomhicca#108 = #nom400eu#24;  || base 2 IRPF nomina
                         #nomhicca#106 = #nom400eu#28; || % 2 IRPF
                         #nomhicca#110 = #nom400eu#29; || Cuota 2
                         #nomhicca#114 = #nomhicca#114 - #nom400eu#26 + #nom400eu#29;
                         #nomhicca#151 = #nomhicca#151 + #nom400eu#26 - #nom400eu#29;
                    |FINSI;
                    |SI #nomhicca#109 = #nom400eu#30;  || base 3 IRPF nomina
                         #nomhicca#107 = #nom400eu#34; || % 3 IRPF
                         #nomhicca#111 = #nom400eu#35; || Cuota 3
                         #nomhicca#114 = #nomhicca#114 - #nom400eu#32 + #nom400eu#35;
                         #nomhicca#151 = #nomhicca#151 + #nom400eu#32 - #nom400eu#35;
                    |FINSI;
                    #nomhicca#155 = #nomhicca#151 + #nomhicca#153;

                    |GRABA 020#nomhicca.a;
                    |LIBERA #nomhicca;
                    nRectificados = nRectificados + 1;
               |FINSI;
          |SINO;
               nRevisados = nRevisados + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#2, 08, 06, 0;
     #0#1, #0#3, 08, 06, 0;
     be;
     NULL, nomhicca;
|FINSI;

|PROCESO nomcalca;
     #labtraba#0 = #nomcalca#0;
     #labtraba#1 = #nomcalca#1;
     |LEE 000#labtraba.=;

     #nom400eu#0 = #nomcalca#0;
     #nom400eu#1 = #nomcalca#1;
     #nom400eu#2 = 2008;
     #nom400eu#3 = 06;
     |LEE 000#nom400eu.=;
     |SI FSalida = 0;
          |SI #nom400eu#12 ! #nomcalca#15;
               nCalculada = #nomcalca#15;
               nProrrata = #nom400eu#12;
               aEmp = #nomcalca#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
               aTra = #nomcalca#1; aTra = "00000" + aTra; aTra = aTra % -105;
               aMes = #nomcalca#2; aMes = "00" + aMes; aMes = aMes % -102;
               aDonde = "M";
               nAfectados = nAfectados + 1;
               nRevisados = nRevisados + 1;
               |PRINT;
          |SINO;
               nRevisados = nRevisados + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #0#0, #0#2, 06, 0;
     #0#1, #0#3, 06, 0;
     ;
     NULL, nomcalca;
|FINSI;

|PROCESO Tipo3; |TIPO 3;
     |SI FSalida = 0;
          |ABRE #labtraba;
          |ABRE #nomconli;
          |ABRE #nom400eu;
          |IMPRE 0;
          |INFOR "nomzcpa1";
          ||BUCLE nomcalca;
          |BUCLE nomhicca;
          |PIEINF;
          |FININF;
          |FINIMP;
          |CIERRA #nom400eu;
          |CIERRA #nomconli;
          |CIERRA #labtraba;
     |FINSI;
|FPRC;
