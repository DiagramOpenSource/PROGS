|FICHEROS;
     nomcompe #0;
     nomir003 #1;
     labtraba #2;
     labempre #3;
|FIN;

|VARIABLES;
     fFecha      = @;
     aFecha      = "";
     nMes        = 0;
     aMes        = "";
     nAny        = 0;
     aAny        = "";
     swEntra     = 0;
     nSw         = 0;
     aParam      = "";

     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDelEjerc = 0;
     &enDTrabaja = 0;
     &enHTrabaja = 0;
|FIN;

|PROCESO Defecto; |TIPO 7;
     fFecha = ~;
     aFecha = fFecha;
     aAny   = aFecha % -104;
     nAny   = aAny;
     #0#2   = aAny;
     |PINTA #0#2;
|FPRC;

|PROCESO labempre;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;
|FPRC;

|PROCESO labtraba;
     swEntra = 0;

     #nomir003#0  = #labtraba#7;
     #nomir003#40 = #0#2;
     #nomir003#41 = #labtraba#0;
     |LEE 000#nomir003.=;
     |SI FSalida = 0;
          |SI #nomir003#12 ! 0; |O #nomir003#13 ! 0;
               swEntra = 1;
          |FINSI;
     |FINSI;

     |SI #labtraba#42 = "H";
          swEntra = 1;
     |FINSI;

     |SI swEntra = 1;
          |HAZ labempre;
          |SI nSw = 0;
              Impresora = "CrystalReport";
              |IMPRE -1;
              |INFOR "nomcompe";
          |FINSI;

          |PRINT;
          nSw = 1;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#1;
     44;
     #0#0, enDTrabaja, "A";
     #0#1, enHTrabaja, "A";
     ;
     NULL, labtraba;
|FIN;

|PROCESO Imprimir;

     |ABRE #nomir003;
     |ABRE #labempre;

     nSw = 0;
     |BUCLE labtraba;
     |SI nSw = 1;
         |PIEINF;
         |FININF;
         |FINIMP;
     |FINSI;

     |CIERRA #labempre;
     |CIERRA #nomir003;

|FPRC;

|PROGRAMA;
     aParam = PARAMETRO; |QBF aParam;

     |SI aParam = "";
          |CLS;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0;
              enDTrabaja = 00001;
              enHTrabaja = 99999;
              |HAZ Imprimir;
          |FINSI;
     |SINO;
          #0#0 = enDEmpresa;
          #0#1 = enHEmpresa;
          #0#2 = enDelEjerc;
          |HAZ Imprimir;
     |FINSI;
|FPRO;
