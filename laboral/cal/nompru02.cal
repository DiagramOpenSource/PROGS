|FICHEROS;
   nompru02 #0;
   nompru01 #1;
|FIN;

|VARIABLES;
   &eaIncid = "";

   nHandle = 0;
   nEmpre  = 0;
   nTraba  = 0;
   nMes    = 0;
   nAnyo   = 0;
   nTipoB  = 0;
   nDDia   = 0;
   nHDia   = 0;
   nHoras  = 0;
   nDesem  = 0;
   nCont   = 0;
   nCalc   = 0;

   nSwErr  = 0;
   nNulo   = 0;

   fFecha  = @;

   aTipoB  = "";
   aDto    = "";
   aHospi  = "";
   aRecai  = "";
   aAlfa    = "";
   aDestino = "";
     aAlfa1 = "";
     aAlfa2 = "";
|FIN;

|PROCESO Importacion;
     |DELINDEX #1;
     |ABRE #1;
     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;
          |MENAV "    No se puede usar agixl97.dll"; |ACABA;
     |FINSI;

     |MENSA "    Cargando documento";

     aDestino = #0#0; |QBF aDestino;
     |ALFACALLDLL "agixl97.dll", "carga_book", aDestino;
     |ALFACALLDLL "agixl97.dll", "selecciona_hoja", "Hoja1";

     |MENSA "    Ejecutando importacion";

     nNulo = 0;
     |PARA nCont = 8; |SI; |HACIENDO nCont = nCont + 1;
      aAlfa = "A" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa;
      |QBF aAlfa;
      |SI aAlfa = "";
          |SAL;
      |SINO;
          #1#0 = aAlfa;
      |FINSI;
      aAlfa = "B" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#1 = aAlfa;
      aAlfa = "C" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#2 = aAlfa;
      aAlfa = "D" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#3 = aAlfa;
      aAlfa = "E" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#4 = aAlfa;
      aAlfa = "F" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#5 = aAlfa;
      aAlfa = "G" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#6 = aAlfa;
      aAlfa = "H" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#7 = aAlfa;
      aAlfa = "I" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#8 = aAlfa;
      aAlfa = "J" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#9 = aAlfa;
      aAlfa = "K" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#10 = aAlfa;
      aAlfa = "L" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#11 = aAlfa;
      aAlfa = "M" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#12 = aAlfa;
      aAlfa = "N" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#13 = aAlfa;
      aAlfa = "O" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#14 = aAlfa;
      aAlfa = "P" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#15 = aAlfa;
      aAlfa = "Q" + nCont; |ALFACALLDLL "agixl97.dll", "peek_dato", aAlfa; #1#16 = aAlfa;
      |GRABA 020#1n;
      aAlfa1 = #1#0;
      aAlfa2 = #1#1;
      |PINTA 1327, aAlfa1;
      |PINTA 1527, "  ";
      |PINTA 1527, aAlfa2;
   |SIGUE;

   |ALFACALLDLL "agixl97.dll", "fin_book", "salva";
   |MENSA "    Cerrando documento";
   |DESCARGADLL "agixl97.dll";

   |BLIN 4;
|FPRC;

|PROCESO Browse;
     |SI FSalida = 10;
          aAlfa = "F"; |BROWSE aAlfa;
          aAlfa = aAlfa % 0299; |QBF aAlfa;
          |SI aAlfa ! "";
               #nompru02#0 = aAlfa; |PINTA #nompru02#0;
          |FINSI;
          |ERROR;
          |ACABA;
     |FINSI;

      aAlfa = #0#0; |QBF aAlfa;
      |XABRE "EC", aAlfa, nHandle;
      |SI FSalida < 0;
          |MENAV "    No encuentro el fichero"; |ERROR;
      |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Importacion Resultados";

     |PINPA #0#0; |PINDA #0#0;

     |ATRI 0; |PINTA 1138, "Cucu"; |ATRI 0;
     |ATRI R; |PINTA 1238, "Cucu"; |ATRI 0;
     |ATRI I; |PINTA 1338, "Cucu"; |ATRI 0;
     |ATRI S; |PINTA 1438, "Cucu"; |ATRI 0;
     |ATRI P; |PINTA 1538, "Cucu"; |ATRI 0;
     |ATRI A; |PINTA 1638, "Cucu"; |ATRI 0;
     |ATRI E; |PINTA 1738, "Cucu"; |ATRI 0;
     |ATRI T; |PINTA 1838, "Cucu"; |ATRI 0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ Importacion;
     |FINSI;
/*
      |IMPRE 0;
      |SI FSalida = 0;
         |INFOR "syke0005";
         |SI FSalida = 0;
            |HAZ Importacion;
            |SI nSwErr = 0;
               eaIncid = " La captura se ha efectuado sin incidencias"; |PRINT;
            |FINSI;
            |PIEINF; |FININF;
         |FINSI;
         |FINIMP;
      |FINSI;
*/

|FPRO;
