|FICHEROS;
     vipe0014 #0;
     vipe0007 #7;
|FIN;

|VARIABLES;
     fFecha = @;
     aFecha = "";
     aAny = "";
     nAny = 0;

     aMes = "";
     nMes = 0;
     nCuantos = 0;
     aAlfa = "";
     aPassword = "";
|FIN;

|PROCESO Defectos; |TIPO 7;
     fFecha = ~;
     aFecha = fFecha;
     aAny = aFecha % -104;
     nAny = aAny;

     aMes = aFecha % 402;
     nMes = aMes;

     #0#5 = nMes;
     |PINTA #0#5;
     #0#4 = nAny;
     |PINTA #0#4;
|FPRC;

|PROCESO Desactualiza;
     nCuantos = nCuantos + 1;
     |SI #vipe0007#25 = "*";
          |BORRA 020#vipe0007.a;
     |FINSI;
|FPRC;

|DEFBUCLE Desactualiza;
     #vipe0007#1;
     ;
     #0#0, #0#2, #0#4, #0#5;
     #0#1, #0#3, #0#4, #0#5;
     be;
     NULL, Desactualiza;
|FIN;

|PROGRAMA;
     |CLS;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>           ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          nCuantos = 0;
          |BUCLE Desactualiza;
          |SI nCuantos > 0;
               aAlfa = nCuantos;
               |SI nCuantos = 1;
                    aAlfa = "    Desactualizado 1 trabajador.";
               |SINO;
                    aAlfa = "    Desactualizados " + aAlfa +  " trabajadores.";
               |FINSI;
          |SINO;
               aAlfa = "    No se encontraron registros para desactualizar";
          |FINSI;
          |MENAV aAlfa;
     |FINSI;
|FPRO;
