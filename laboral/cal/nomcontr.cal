|FICHEROS;
     nomcontr #0;
     nomtmp08 #1,MANTE;
     cretam00;
|FIN;

|VARIABLES;
     aAlfaART  = "";
     aAlfaART1 = "";
     aAlfaART2 = "";
     aIP       = "";
     aNomLogo  = "";

     nBotonSubir = -1;
     nCalc = 0;
     &eaPtec = "";

     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     nume4 = 0;
     fech1 = @;
     fech2 = @;
     fech3 = @;
     fech4 = @;
     aAlfa = "";
     nTecla = 0;
     swPtec = 0;
     aLogo = "";
     swCreta = 0;
|FIN;

|RUTINA inf;
     #nomtmp08#0 = " " * 15;
|FRUT;

|RUTINA sup;
     #nomtmp08#0 = "z" * 15;
|FRUT;

|PROCESO CargaLogos;
     aAlfaART = "ww" + Usuario; |NOME_DAT #nomtmp08#aAlfaART#;
     |DELINDEX #nomtmp08;
     |ABRE #nomtmp08;

     |DBASE aAlfaART; |QBF aAlfaART; nCalc = 1;
     aAlfaART = aAlfaART + "documentos/logos/";
     aAlfaART1 = aAlfaART; aAlfaART = aAlfaART + "*";
     |_PDIR aAlfaART;
     |PARA; |SI FSalida = 0; |HACIENDO;
          aAlfaART2 = aAlfaART - aAlfaART1;

          #nomtmp08#0 = aAlfaART2;
          |LEE 000#nomtmp08.=;
          |SI FSalida ! 0;
               |DDEFECTO #nomtmp08;
               #nomtmp08#0 = aAlfaART2;
               |GRABA 020#nomtmp08.n;
          |FINSI;

          |_SDIR aAlfaART;
     |SIGUE;
     |CIERRA #nomtmp08;
|FPRC;

|PROCESO SeleccLogo;
     |SI swPtec = 1;
          #0#57 = aLogo;
          |PINTA #0#57;
     |FINSI;
     nTecla = FSalida;
     aAlfaART = "ww" + Usuario; |NOME_DAT #nomtmp08#aAlfaART#;
     |ABRE #nomtmp08;

     |SI nTecla = 11;
          |LEE 000#nomtmp08.p;
          |SI FSalida ! 0;
               |MENAV "    No hay logos guardados.";
          |SINO;
               |PUSHV 0501 2380;
               |ENTLINEAL #1#nomtmp08, 1, 4, 22, 1, inf, sup;
               |POPV;

               #nomcontr#57 = eaPtec; |PINTA #nomcontr#57;
               |ERROR;
          |FINSI;
     |FINSI;

     aAlfa = #nomcontr#57;
     |QBF aAlfa;
     |SI aAlfa ! "";
          #nomtmp08#0 = aAlfa;
          |LEE 000#nomtmp08.=;
          |SI FSalida ! 0;
               aAlfa = "    El logo seleccionado no existe.";
               |MENAV aAlfa;
               #nomcontr#57 = "";
               |PINTA #nomcontr#57;
               |ERROR;
          |FINSI;
     |FINSI;

     |CIERRA #nomtmp08;
|FPRC;

|PROCESO FinBoton;
     |FIN_CONTROL_WINDOWS nBotonSubir; nBotonSubir = -1;
|FPRC;

|PROCESO SubeLogo;
   aAlfaART = "F*.bmp";
   |BROWSE aAlfaART;
   aAlfaART = aAlfaART % 0299; |QBF aAlfaART;
   |SI aAlfaART ! "";
      || Saco el nombre del logo, sin carpeta ...
      aAlfaART1 = aAlfaART; aAlfaART2 = "";
      |PARA; |SI aAlfaART2 ! "/"; |Y aAlfaART2 ! "\"; |HACIENDO;
         aAlfaART2 = aAlfaART1 % -101; aAlfaART1 = aAlfaART1 % -299;
      |SIGUE;
      aAlfaART1 = aAlfaART1 + aAlfaART2;
      aAlfaART1 = aAlfaART - aAlfaART1; aNomLogo = aAlfaART1;

      |DBASE aAlfaART2; |QBF aAlfaART2;
      aAlfaART1 = aAlfaART2 + "documentos/logos/" + aAlfaART1;
      aIP = ""; |IP_REMOTO aIP;
      |SI aIP ! "";
         |RECIBE_FICHERO aAlfaART, aAlfaART1;
      |SINO;
         |COPIA_FICHERO aAlfaART, aAlfaART1;
      |FINSI;
      #nomcontr#57 = aNomLogo; |PINTA #nomcontr#57;
   |FINSI;
      #nomcontr#57 = aNomLogo; |PINTA #nomcontr#57;
     |ENCAMPO #57#0;
     swPtec = 1;
     aLogo = #nomcontr#57;
     |PTEC 806;
|FPRC;

|PROCESO AntesLogo; |TIPO 7;
   || Creo el boton para subir logos al servidor
   |SI nBotonSubir = -1;
      aAlfaART = "BOTON,{{197}}A¤adir logo";
      |CONTROL_SIMPLE 0, aAlfaART, 1949, 1963, SubeLogo;
      nBotonSubir = FSalida;
   |FINSI;

     |HAZ CargaLogos;
|FPRC;


|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
    |PINTA #0Campo;
|FPRC;

|PROCESO PDFsino; |TIPO 7;
     |SI #0#37 = "N";
          |CAMPO_MODIFICA #0#36, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#36, 1, "S";
     |FINSI;
|FPRC;

|PROCESO Aviso47; |TIPO 7;
     |PUSHV 11112076;
               ||  3      4         5         6         7
               ||  3456789012345678901234567890123456789012324
     |ATRI R;
     |PINTA 1133, " Opciones:                                 ";
     |PINTA 1233, " D - Imprimir solo n£mero de d¡as          ";
     |PINTA 1333, " C - Imprimir n£mero de d¡as con descuento ";
     |PINTA 1433, "     de absentismo en un concepto separado ";
     |PINTA 1533, "     La n¢mina tiene que haberse calculado ";
     |PINTA 1633, "     previamente con esta opci¢n activada. ";
     |PINTA 1733, " T - Imprimir desde-hasta d¡a (se muestran ";
     |PINTA 1833, "     horas si se han introducido horas)    ";
     |PINTA 1933, " N - No imprimir                           ";
     |PINTA 2033, "                                           ";
|FPRC;

|PROCESO Aviso49;
     |SI #0#49 = "N";
          |PUSHV 07111276;
                    ||  3      4         5         6         7
                    ||  3456789012345678901234567890123456789012324
          |ATRI R;
          |PINTA 0733, " ATENCION: Si eligen la opcion 'N' en este ";
          |PINTA 0833, " parametro, para que sea efectivo los com- ";
          |PINTA 0933, " plementos deben estar definidos en tramos ";
          |PINTA 1033, " similares a las prestaciones, es decir:   ";
          |PINTA 1133, " Lin 1: dia 0 al 3   Lin 3: dia 16 al 20   ";
          |PINTA 1233, " Lin 2: dia 4 al 15  Lin 4: dia 21 al 999  ";
          |ATRI 0;
          |PAUSA;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Aviso56; |TIPO 7;
     |PUSHV 11131874;
               ||  1      2         3         4         5         6         7
               ||  34567890123456789012345678901234567890123456789012345678901234
     |ATRI R;
     |PINTA 1113, "                                                              ";
     |PINTA 1213, " Active este par metro para que las emisiones de res£menes de "
     |PINTA 1313, " n¢minas se  guarden y puedan  ser despu‚s  emitidos desde la ";
     |PINTA 1413, " opci¢n Varios/Registro de Res£menes de N¢mina emitidos.      ";
     |PINTA 1513, " ATENCION: no est  operativo en res£menes por AREAS Y SECCIO- ";
     |PINTA 1613, " NES ni para emisiones en formato que no sea CRYSTAL.         ";
     |PINTA 1713, "                                                              ";
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO Activa61; |TIPO 7;
     |SI #0#17 = 3; |Y swCreta ! 1;
          |CAMPO_MODIFICA #0#61, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#61, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Aviso61; |TIPO 7;
     |PUSHV 13012380;
               ||           1         2         3         4         5
               ||  123456789012345678901234567890123456789012345678901234567
     |ATRI R;
     |PINTA 1403, "                                                      ";
     |PINTA 1503, " Con este par metro se controla para los trabajadores ";
     |PINTA 1603, " MENSUALES,si los d¡as del mes de FEBRERO por los que ";
     |PINTA 1703, " tenemos que  cotizar, en los que realmente no se  ha ";
     |PINTA 1803, " trabajado (2 en mes de 28 d¡as, 1 en mes de 29 d¡as) ";
     |PINTA 1903, " cuando se produce una IT, han de cotizar (y por tan- ";
     |PINTA 2003, " to cobrarse) como d¡as de IT o como d¡as trabajados. ";
     |PINTA 2103, "                                                      ";
|FPRC;

|PROCESO Ayuda64; |TIPO 7;
     |PUSHV 11302280;
     |ATRI R;
     |BLANCO 11302280;
     ||            3         4         5         6         7
     ||            01234567890123456789012345678901234567890123456789
     |PINTA 1130, " - Opciones -                                     ";
     |PINTA 1230, " (1) Seg£n las pagas que cobre el trabajador  (el ";
     |PINTA 1330, "     importe inembargable es mayor si el trabaja- ";
     |PINTA 1430, "     prorratea m s de dos pagas).                 ";
     |PINTA 1530, " (2) Teniendo en cuenta siempre DOS pagas prorra- ";
     |PINTA 1630, "     teadas (se realiza el  mismo c lculo  que en ";
     |PINTA 1730, "     la p gina web de la AEAT hasta 2018).        ";
     |PINTA 1830, " (3) No se tienen en cuenta las  pagas extras. Se ";
     |PINTA 1930, "     realiza el mismo  c lculo que  la p gina web ";
     |PINTA 2030, "     de la AEAT,siendo en todos los meses la par- ";
     |PINTA 2130, "     te inembargable UN SMI.                      ";
     |ATRI 0;
|FPRC;

|PROCESO Citricos; |TIPO 7;
     |SI #nomcontr#71 ! "S"; |Y #nomcontr#71 ! "N";
          #nomcontr#71 = "N";
          |PINTA #nomcontr#71;
     |FINSI;
|FPRC;

|PROCESO Creta;
     |ABRE #cretam00;
     |LEE 000#cretam00.p;
     |SI FSalida = 0;
          |SI #cretam00#1 = "S";
               swCreta = 1;
               |CAMPO_MODIFICA #nomcontr#17, 1, "N";
               |CAMPO_MODIFICA #nomcontr#18, 1, "N";
               |CAMPO_MODIFICA #nomcontr#61, 1, "N";
          |FINSI;
     |FINSI;
     |CIERRA #cretam00;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Control Aplicacion";
     |PINPA #0#0;
     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;
     |HAZ Creta;
     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
     |CIERRA #0;

     |SI nBotonSubir ! -1; |FIN_CONTROL_WINDOWS nBotonSubir; |FINSI;
|FPRO;
