|FICHEROS;
     labnct25 #0;
     labnct91;
|FIN;

|VARIABLES;
     &enEmpresa = 0;
     &enTrabajador = 0;

     nBotonEmp = 0;
     nBotonTra = 0;
     nBotonAse = 0;
     nNumBoton = 0;
     nNumBotonEmp = 0;
     nNumBotonTra = 0;
     nNumBotonAse = 0;
     nBotonSal = 0;
     swSal = 0;
     aAlfa = "";
     nPos1 = 0;
     nPos2 = 0;
     nPosTexto = 0;

     aTipo = "";

     nLin = 0;
     nCol = 0;
     nPosLin = 0;
     nPosCol = 0;
     nIniLin = 0;
     nIniCol = 0;
     nPosIni = 0;
     nPosFin = 0;
     aTexto = "";
     aOrden = "";
     nNume = 0;


     nBotonE01 = 0; nBotonE02 = 0; nBotonE03 = 0; nBotonE04 = 0; nBotonE05 = 0;
     nBotonE06 = 0; nBotonE07 = 0; nBotonE08 = 0; nBotonE09 = 0; nBotonE10 = 0;
     nBotonE11 = 0; nBotonE12 = 0; nBotonE13 = 0; nBotonE14 = 0; nBotonE15 = 0;
     nBotonE16 = 0; nBotonE17 = 0; nBotonE18 = 0; nBotonE19 = 0; nBotonE20 = 0;

     nBotonT01 = 0; nBotonT02 = 0; nBotonT03 = 0; nBotonT04 = 0; nBotonT05 = 0;
     nBotonT06 = 0; nBotonT07 = 0; nBotonT08 = 0; nBotonT09 = 0; nBotonT10 = 0;
     nBotonT11 = 0; nBotonT12 = 0; nBotonT13 = 0; nBotonT14 = 0; nBotonT15 = 0;
     nBotonT16 = 0; nBotonT17 = 0; nBotonT18 = 0; nBotonT19 = 0; nBotonT20 = 0;

     nBotonA01 = 0; nBotonA02 = 0; nBotonA03 = 0; nBotonA04 = 0; nBotonA05 = 0;
     nBotonA06 = 0; nBotonA07 = 0; nBotonA08 = 0; nBotonA09 = 0; nBotonA10 = 0;
     nBotonA11 = 0; nBotonA12 = 0; nBotonA13 = 0; nBotonA14 = 0; nBotonA15 = 0;
     nBotonA16 = 0; nBotonA17 = 0; nBotonA18 = 0; nBotonA19 = 0; nBotonA20 = 0;

     aTecla = "";
     aEsc = "";
     aTecla1 = "";
     aTecla2 = "";
     aHora = "";
     aSeg = "";
|FIN;

|PROCESO BorraBotonesEmp;
     |FIN_CONTROL_WINDOWS nBotonE01;
     |FIN_CONTROL_WINDOWS nBotonE02;
     |FIN_CONTROL_WINDOWS nBotonE03;
     |FIN_CONTROL_WINDOWS nBotonE04;
     |FIN_CONTROL_WINDOWS nBotonE05;
     |FIN_CONTROL_WINDOWS nBotonE06;
     |FIN_CONTROL_WINDOWS nBotonE07;
     |FIN_CONTROL_WINDOWS nBotonE08;
     |FIN_CONTROL_WINDOWS nBotonE09;
     |FIN_CONTROL_WINDOWS nBotonE10;
     |FIN_CONTROL_WINDOWS nBotonE11;
     |FIN_CONTROL_WINDOWS nBotonE12;
     |FIN_CONTROL_WINDOWS nBotonE13;
     |FIN_CONTROL_WINDOWS nBotonE14;
     |FIN_CONTROL_WINDOWS nBotonE15;
     |FIN_CONTROL_WINDOWS nBotonE16;
     |FIN_CONTROL_WINDOWS nBotonE17;
     |FIN_CONTROL_WINDOWS nBotonE18;
     |FIN_CONTROL_WINDOWS nBotonE19;
     |FIN_CONTROL_WINDOWS nBotonE20;
|FPRC;

|PROCESO BorraBotonesTra;
     |FIN_CONTROL_WINDOWS nBotonT01;
     |FIN_CONTROL_WINDOWS nBotonT02;
     |FIN_CONTROL_WINDOWS nBotonT03;
     |FIN_CONTROL_WINDOWS nBotonT04;
     |FIN_CONTROL_WINDOWS nBotonT05;
     |FIN_CONTROL_WINDOWS nBotonT06;
     |FIN_CONTROL_WINDOWS nBotonT07;
     |FIN_CONTROL_WINDOWS nBotonT08;
     |FIN_CONTROL_WINDOWS nBotonT09;
     |FIN_CONTROL_WINDOWS nBotonT10;
     |FIN_CONTROL_WINDOWS nBotonT11;
     |FIN_CONTROL_WINDOWS nBotonT12;
     |FIN_CONTROL_WINDOWS nBotonT13;
     |FIN_CONTROL_WINDOWS nBotonT14;
     |FIN_CONTROL_WINDOWS nBotonT15;
     |FIN_CONTROL_WINDOWS nBotonT16;
     |FIN_CONTROL_WINDOWS nBotonT17;
     |FIN_CONTROL_WINDOWS nBotonT18;
     |FIN_CONTROL_WINDOWS nBotonT19;
     |FIN_CONTROL_WINDOWS nBotonT20;
|FPRC;

|PROCESO BorraBotonesAse;
     |FIN_CONTROL_WINDOWS nBotonA01;
     |FIN_CONTROL_WINDOWS nBotonA02;
     |FIN_CONTROL_WINDOWS nBotonA03;
     |FIN_CONTROL_WINDOWS nBotonA04;
     |FIN_CONTROL_WINDOWS nBotonA05;
     |FIN_CONTROL_WINDOWS nBotonA06;
     |FIN_CONTROL_WINDOWS nBotonA07;
     |FIN_CONTROL_WINDOWS nBotonA08;
     |FIN_CONTROL_WINDOWS nBotonA09;
     |FIN_CONTROL_WINDOWS nBotonA10;
     |FIN_CONTROL_WINDOWS nBotonA11;
     |FIN_CONTROL_WINDOWS nBotonA12;
     |FIN_CONTROL_WINDOWS nBotonA13;
     |FIN_CONTROL_WINDOWS nBotonA14;
     |FIN_CONTROL_WINDOWS nBotonA15;
     |FIN_CONTROL_WINDOWS nBotonA16;
     |FIN_CONTROL_WINDOWS nBotonA17;
     |FIN_CONTROL_WINDOWS nBotonA18;
     |FIN_CONTROL_WINDOWS nBotonA19;
     |FIN_CONTROL_WINDOWS nBotonA20;
|FPRC;

|PROCESO Salir;
     swSal = 1;
|FPRC;

|PROCESO BotonE01;
|FPRC;

|PROCESO BotonE02;
|FPRC;

|PROCESO BotonE03;
|FPRC;

|PROCESO BotonE04;
|FPRC;

|PROCESO BotonE05;
|FPRC;

|PROCESO BotonE06;
|FPRC;

|PROCESO BotonE07;
|FPRC;

|PROCESO BotonE08;
|FPRC;

|PROCESO BotonE09;
|FPRC;

|PROCESO BotonE10;
|FPRC;

|PROCESO BotonT01;
|FPRC;

|PROCESO BotonT02;
|FPRC;

|PROCESO BotonT03;
|FPRC;

|PROCESO BotonT04;
|FPRC;

|PROCESO BotonT05;
|FPRC;

|PROCESO BotonT06;
|FPRC;

|PROCESO BotonT07;
|FPRC;

|PROCESO BotonT08;
|FPRC;

|PROCESO BotonT09;
|FPRC;

|PROCESO BotonT10;
|FPRC;

|PROCESO BotonT11;
|FPRC;

|PROCESO BotonT12;
|FPRC;

|PROCESO BotonT13;
|FPRC;

|PROCESO BotonT14;
|FPRC;

|PROCESO BotonT15;
|FPRC;

|PROCESO BotonT16;
|FPRC;

|PROCESO BotonT17;
|FPRC;

|PROCESO BotonT18;
|FPRC;

|PROCESO BotonT19;
|FPRC;

|PROCESO BotonT20;
|FPRC;

|PROCESO BotonA01;

|FPRC;

|PROCESO CreaBoton;
     |SI aTipo = "EMP";
          |SI nNumBotonEmp = 1;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE01;
               nBotonE01 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 2;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE02;
               nBotonE02 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 3;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE03;
               nBotonE03 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 4;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE04;
               nBotonE04 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 5;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE05;
               nBotonE05 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 6;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE06;
               nBotonE06 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 7;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE07;
               nBotonE07 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 8;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE08;
               nBotonE08 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 9;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE09;
               nBotonE09 = FSalida;
          |FINSI;
          |SI nNumBotonEmp = 10;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonE10;
               nBotonE10 = FSalida;
          |FINSI;
     |FINSI;

     |SI aTipo = "TRA";
          |SI nNumBotonTra = 1;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT01;
               nBotonT01 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 2;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT02;
               nBotonT02 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 3;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT03;
               nBotonT03 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 4;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT04;
               nBotonT04 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 5;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT05;
               nBotonT05 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 6;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT06;
               nBotonT06 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 7;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT07;
               nBotonT07 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 8;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT08;
               nBotonT08 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 9;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT09;
               nBotonT09 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 10;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT10;
               nBotonT10 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 11;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT11;
               nBotonT11 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 12;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT12;
               nBotonT12 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 13;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT13;
               nBotonT13 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 14;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT14;
               nBotonT14 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 15;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT15;
               nBotonT15 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 16;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT16;
               nBotonT16 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 17;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT17;
               nBotonT17 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 18;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT18;
               nBotonT18 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 19;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT19;
               nBotonT19 = FSalida;
          |FINSI;
          |SI nNumBotonTra = 20;
               |CONTROL_SIMPLE 0, aOrden, nPosIni, nPosFin, BotonT20;
               nBotonT20 = FSalida;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO PintaBotones;
     |SI aTipo = "EMP"; nNumBoton = nNumBotonEmp; |FINSI;
     |SI aTipo = "TRA"; nNumBoton = nNumBotonTra; |FINSI;

     nIniLin = ((nNumBoton / 4) - 0.49) ! 0
     nIniLin = nIniLin + 1;
     nIniCol = (nNumBoton $ 4);
     |SI nIniCol = 0;
          nIniCol = 4;
          nIniLin = nIniLin - 1;
     |FINSI;

     |PARA nLin = nIniLin; |SI nLin [ 6; |HACIENDO nLin = nLin + 1;
          |PARA nCol = nIniCol; |SI nCol [ 4; |HACIENDO nCol = nCol + 1;
               nPosLin = 10 + ((nLin - 1) * 2);
               nPosCol = 20 + ((nCol - 1) * 15) + 1;

               nPosIni = (nPosLin * 100) + nPosCol;
               nPosFin = ((nPosLin + 1) * 100) + nPosCol + 13;
               aTexto = #labnct91#2; |QBF aTexto;
               aOrden = "BOTON," + aTexto;

               |HAZ CreaBoton;

               |SI aTipo = "EMP"; nNumBotonEmp = nNumBotonEmp + 1; |FINSI;
               |SI aTipo = "TRA"; nNumBotonTra = nNumBotonTra + 1; |FINSI;

               |ACABA;
          |SIGUE;
     |SIGUE;
|FPRC;

|DEFBUCLE PintaBotones;
     #labnct91#1;
     ;
     aTipo, 01;
     aTipo, 99;
     ;
     NULL, PintaBotones;
|FIN;

|PROCESO PintaBotones2;
     |SI aTipo = "EMP"; nNumBoton = nNumBotonEmp; |FINSI;
     |SI aTipo = "TRA"; nNumBoton = nNumBotonTra; |FINSI;

     nIniCol = 1;
     nIniLin = nNumBoton;
     |SI nNumBoton > 13;
          nIniCol = 2;
          nIniLin = nNumBoton - 13;
     |FINSI;

     |PARA nCol = nIniCol; |SI nCol [ 2; |HACIENDO nCol = nCol + 1;
          |PARA nLin = nIniLin; |SI nLin [ 13; |HACIENDO nLin = nLin + 1;
               nPosLin = 9 + nLin;
               nPosCol = 21;
               |SI nNumBoton > 13;
                    nPosCol = 51;
               |FINSI;

               || el texto

               aAlfa = #labnct91#1; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
               nPosTexto = (nPosLin * 100) + 21;
               |SI nNumBoton > 13;
                    nPosTexto = (nPosLin * 100) + 51;
               |FINSI;
               |ATRI R;
               |PINTA nPosTexto, aAlfa;
               |ATRI 0;
               nPosTexto = nPosTexto + 3;
               aAlfa = #labnct91#2; |QBF aAlfa; aAlfa = aAlfa % 125
               |PINTA nPosTexto, aAlfa;

               || el boton

               nPosIni = (nPosLin * 100) + nPosCol;
               nPosFin = (nPosIni + 2);
               || nPosFin = (nPosIni + 26);

               aAlfa = #labnct91#1; |QBF aAlfa; aAlfa = ("00" + aAlfa) % -102;
               || aTexto = aAlfa + ". " + #labnct91#2 + "             ";
               aTexto = aAlfa;
               aOrden = "BOTON," + aTexto;

               |HAZ CreaBoton;

               |SI aTipo = "EMP"; nNumBotonEmp = nNumBotonEmp + 1; |FINSI;
               |SI aTipo = "TRA"; nNumBotonTra = nNumBotonTra + 1; |FINSI;

               |ACABA;
          |SIGUE;
     |SIGUE;
|FPRC;

|DEFBUCLE PintaBotones2;
     #labnct91#1;
     ;
     aTipo, 01;
     aTipo, 99;
     ;
     NULL, PintaBotones2;
|FIN;

|PROCESO ConsultasEmp;
     |BLANCO 10212279;
     |HAZ BorraBotonesTra;
     |HAZ BorraBotonesAse;

     aTipo = "EMP";
     nNumBotonEmp = 1;
     |BUCLE PintaBotones2;
|FPRC;

|PROCESO ConsultasTra;
     |BLANCO 10212279;
     |HAZ BorraBotonesEmp;
     |HAZ BorraBotonesAse;

     aTipo = "TRA";
     nNumBotonTra = 1;
     |BUCLE PintaBotones2;
|FPRC;

|PROCESO ConsultasAse;
     |BLANCO 10212279;
     |HAZ BorraBotonesEmp;
     |HAZ BorraBotonesTra;

     aAlfa = "1. Empresas autorizadas Contrat@";
     aAlfa = "BOTON," + aAlfa;
     nPos1 = 1122; nPos2 = 1235;
     |CONTROL_SIMPLE 0, aAlfa, nPos1, nPos2, BotonA01;
     nBotonA01 = FSalida;
|FPRC;

|PROCESO BotonesIzq;
     |CONTROL_SIMPLE 0, "BOTON,Consultas Online", 1102, 1217, ConsultasEmp;
     nBotonEmp = FSalida;
     |ESTADO_CONTROL nBotonEmp, "ENABLE";

     |CONTROL_SIMPLE 0, "BOTON,Consultas Online", 1602, 1717, ConsultasTra;
     nBotonTra = FSalida;
     |ESTADO_CONTROL nBotonTra, "ENABLE";

     |CONTROL_SIMPLE 0, "BOTON,Consultas Online", 2102, 2217, ConsultasAse;
     nBotonAse = FSalida;
     |ESTADO_CONTROL nBotonAse, "ENABLE";

     |CONTROL_SIMPLE 0, "BOTON,Salir", 2273, 2279, Salir;
     nBotonSal = FSalida;
     |ESTADO_CONTROL nBotonSal, "ENABLE";
|FPRC;


|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |HAZ BotonesIzq;

     aEsc = &255 + "806";
     |PARA; |SI swSal = 0; |HACIENDO;
          ||PULSATECLA;
          nNume = nNume + 1;
          |LEETECLA aTecla1;
          |HORA aHora;
          aSeg = aHora % -102;
          |HORA aHora;
          |LEETECLA aTecla2;
          aSeg = aHora % -102;
          |SI aTecla = aEsc; |SAL;  |FINSI;
          aTecla = aTecla > aTecla;
          aAlfa = "    El " + aTecla1 + aTecla2;
          |MENAV aAlfa;
     |SIGUE;
|FPRO;

|PROCESO Tipo90; |TIPO 90;
     |HAZ BorraBotonesEmp;
     |HAZ BorraBotonesTra;
     |HAZ BorraBotonesAse;
     |FIN_CONTROL_WINDOWS nBotonAse;
     |FIN_CONTROL_WINDOWS nBotonEmp;
     |FIN_CONTROL_WINDOWS nBotonTra;
     |FIN_CONTROL_WINDOWS nBotonSal;
|FPRC;
