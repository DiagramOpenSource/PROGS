|FICHEROS;
     hotm0054;
     hotm0055 #0;
|FIN;

|VARIABLES;
     nTipoSup = 0;
     nTipoInf = 0;
     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Elegir Opcion:";
     menu4 = "CET";
     menu5 = "Continuar";
     menu6 = "Eliminar";
     menu7 = "Terminar";
     nOpcion = 0;
     aAlfa = "";
     aMHATDesde = "";
     aMHATHasta = "";
     nMes = 0;
     nAny = 0;
     fFecha = @;
|FIN;

/*
|PROCESO Defecto; |TIPO 7;
     fFecha = ~;
     aAlfa = fFecha;
     aAlfa = aAlfa % 402;
     nMes = aAlfa;

     aAlfa = fFecha;
     aAlfa = aAlfa % -104;
     nAny = aAlfa;

     #0#4 = nMes;
     #0#5 = nMes;
     #0#6 = nAny;
     #0#7 = nAny;

     |PINTA #0#4;
     |PINTA #0#5;
     |PINTA #0#6;
     |PINTA #0#7;
|FPRC;
*/

|PROCESO superior;
     #hotm0054#0 = #0#1;
     #hotm0054#1 = #0#3;
     #hotm0054#2 = #0#7;
     #hotm0054#3 = #0#5;
     #hotm0054#4 = nTipoSup;
     #hotm0054#5 = aMHATHasta;
     #hotm0054#9 = 999;
|FPRC;

|PROCESO inferior;
     #hotm0054#0 = #0#0;
     #hotm0054#1 = #0#2;
     #hotm0054#2 = #0#6;
     #hotm0054#3 = #0#4;
     #hotm0054#4 = nTipoInf;
     #hotm0054#5 = aMHATDesde;
     #hotm0054#9 = 001;
|FPRC;

|PROCESO Seleccion;
     |SI #0#8 = " "; |Y #0#9 = " "; |Y #0#10 = " "; |Y #0#13 = " ";
     |Y #0#14 = " "; |Y #0#15 = " ";
          |MENAV "    Debera marcar algun tipo de nomina: Normal, Finiquito, Pagas o Acum. Pagas";
          |POSICIONATE #0#8;
     |SINO;
          |SI #0#8 = "X"; |Y #0#10 = "X";
               #0#9 = "X";
          |FINSI;
          |SI #0#13 = "X";
               #0#8 = " ";
               #0#9 = " ";
               #0#10 = " ";
               #0#14 = " ";
               #0#15 = " ";
          |FINSI;
          |SI #0#8 = "X"; |O #0#9 = "X"; |O #0#10 = "X";
               #0#13 = " ";
          |FINSI;
          |SI #0#14 = "X";
               |SI  #0#8 = "X"; |O #0#9 = "X"; |O #0#10 = "X"; |O #0#15 = "X";
                    #0#8 = " ";
                    #0#9 = " ";
                    #0#10 = " ";
                    #0#15 = " ";
               |FINSI;
          |FINSI;
          |SI #0#15 = "X";
               |SI  #0#8 = "X"; |O #0#9 = "X"; |O #0#10 = "X"; |O #0#14 = "X";
                    #0#8 = " ";
                    #0#9 = " ";
                    #0#10 = " ";
                    #0#14 = " ";
               |FINSI;
          |FINSI;

          |PINTA #0#8;
          |PINTA #0#9;
          |PINTA #0#10;
          |PINTA #0#13;
          |PINTA #0#14;
          |PINTA #0#15;
     |FINSI;
|FPRC;

|PROCESO Borra;
     |BORRA 020#hotm0054.a;
|FPRC;

|DEFBUCLE Borra;
     #hotm0054#1;
     ;
     #0#0, #0#2, #0#6, #0#4, nTipoInf, aMHATDesde, 001;
     #0#1, #0#3, #0#7, #0#5, nTipoSup, aMHATHasta, 999;
     ;
     NULL, Borra;
|FIN;

|PROCESO tipo3; |TIPO 3;
     |SI #0#11 ! "S";
          |ACABA;
     |FINSI;
     nTipoInf = 0;
     aMHATDesde = "H";
     aMHATHasta = "M";

     |SI #0#8 ! "X";
          nTipoInf = 1;
          |SI #0#9 ! "X";
               nTipoInf = 2;
          |FINSI;
     |FINSI;

     nTipoSup = 2;
     |SI #0#10 ! "X";
          nTipoSup = 1;
          |SI #0#9 ! "X";
               nTipoSup = 0;
          |FINSI;
     |FINSI;

     |SI #0#13 = "X";
          aMHATDesde = "P";
          aMHATHasta = "P";

          nTipoInf = 3;
          nTipoSup = 3;
     |FINSI;

     |SI #0#14 = "X";
          aMHATDesde = "A";
          aMHATHasta = "A";

          nTipoInf = 5;
          nTipoSup = 5;
     |FINSI;

     |SI #0#15 = "X";
          aMHATDesde = "T";
          aMHATHasta = "T";

          nTipoInf = 6;
          nTipoSup = 9;
     |FINSI;

     |PARA; |SI nOpcion ! 3; |HACIENDO;
          |ENTLINEAL #1#hotm0054, -1, 4, 19, 1, inferior, superior ;
          |MENU menu;
          nOpcion = FSalida;
          |SI nOpcion = 2;
               |COLOR 7,1;
               |ATRI I;
               |PINTA 1120, "ATENCION. Si continua, los  datos de la  seleccion";
               |PINTA 1220, "figuraran como NO PROCESADOS. Esto  solo afecta al";
               |PINTA 1320, "Registro de Movimientos generados mediante el pase";
               |PINTA 1420, "pero NO afecta de ningun modo  al Mantenimiento de";
               |PINTA 1520, "                  Calculos.                       ";
               |PINTA 1734, " ¨Desea Continuar?   ";
               |ATRI 0;
               E_sup = 1;
               E_inf = "";
               aAlfa = 1753 ? 1;
               |QBF aAlfa;
               |SI aAlfa = "S"; |O aAlfa = "s";
                    |BUCLE Borra;
                    |MENAV "    Se han borrado los registros seleccionados";
                    nOpcion = 3;
               |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |LEE 101#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;

     |SI FSalida = 0;
          |HAZ tipo3;
     |FINSI;
     |GRABA 020#0a;
     |CIERRA #0;
|FPRO;
