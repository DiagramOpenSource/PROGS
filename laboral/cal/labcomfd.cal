|FICHEROS;
     labcomfd #0;
     labempre #1;
     labtraba #2;
|FIN;

|VARIABLES;
    mod = 0;
    verrfec = "0000ATENCION Fecha erronea";
    vdia1 = "";
    vme1 = "";
    vany1 = "";
    vdia = 0;
    vme = 0;
    vany = 0;
    vtope = 0;
    vsw = 0;
    vfec = "";
    vblanco = "          ";
    vpuntos = "";
    informe = "labcomxs";
    fectraba = @;
    diasvenc = 0;
    diasdesd = 0;
    diashast = 0;
    sw = 0;
    v = 0;
    fechanum = 0;
    fechacom = "";
    fechobra = "";
    loca = "";
    loca1 = "";
    &coma = ",";
    &local = "";
    &fcom = "";
    &fobra = "";
    diacom = "";
    mescom = "";
    anycom = "";
    diaobra = "";
    mesobra = "";
    anyobra = "";
    espacio  = " "
    uno =       " enero de ";
    dos =       " febrero de ";
    tres =      " marzo de ";
    cuatro =    " abril de ";
    cinco =     " mayo de ";
    seis =      " junio de ";
    siete =     " julio de ";
    ocho =      " agosto de ";
    nueve =     " septiembre de ";
    diez =      " octubre de ";
    once =      " noviembre de ";
    doce =      " diciembre de ";
    unob = " de enero de ";
    dosb = " de febrero de ";
    tresb = " de marzo de ";
    cuatrob = " de abril de ";
    cincob = " de mayo de ";
    seisb = " de junio de ";
    sieteb = " de julio de ";
    ochob = " de agosto de ";
    nueveb = " de septiembre de ";
    diezb = " de octubre de ";
    onceb = " de noviembre de ";
    doceb = " de diciembre de ";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
    calle2 = "";
    &callet = "";
    numcat = "";
    pisot = "";
    minu = "m";
    mayu = "M";
    amayu = "A";
    aminu = "a";
    xdias = " dias";
    xmeses = " meses";
    xy = " y ";
    mesestra = 0;
    diastra = 0;
    &varal = "";

     swSigue = 0;
     aAlfa = "";
     fDesdeFecha = @;
     fHastaFecha = @;
     fFechaAlta = @;

|FIN;

|INCLUYE i_comun;

|PROCESO fechainc; |TIPO 7;
     |SI #0#10 = "A";
          |CAMPO_MODIFICA #0#11, 1, "N";
          |CAMPO_VISUAL #0#11, 1, "N";
          |PINTA 1943, "             ";
     |SINO;
          |CAMPO_MODIFICA #0#11, 1, "S";
          |CAMPO_VISUAL #0#11, 1, "S";
          |PINTA #0#11;
     |FINSI;
|FPRC;


|PROCESO fechacon; |TIPO 0;        || RUTINA DE CHEQUEO DE FECHAS
        vfec = #0Campo; vsw = 0;
|SI vfec ! vblanco; |Y vfec ! vpuntos;
  vdia1 = vfec % A102;
  vme1 = vfec % A402;
  vany1 = vfec % A704;
  vdia = vdia1; vme = vme1; vany = vany1;
  |SI vdia ! 0; |Y vme ! 0; |Y vany > 1900;
     |SI vme [ 12; |Y vme ] 1;
       |SI vme = 1; |O vme = 3; |O vme = 5; |O vme = 7; |O vme = 8; |O vme = 10; |O vme = 12;
           vtope = 31;
       |SINO;
           |SI vme = 2;
               mod = vany $ 4;
               |SI mod = 0;
                   vtope = 29;
               |SINO;
                   vtope = 28;
               |FINSI;
            |SINO;
               vtope = 30;
            |FINSI;
        |FINSI;
        |SI vdia [ vtope;
            vsw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  vsw = 1;
|FINSI;
|SI vsw = 0;
    |MENAV verrfec;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO conversi;            || RUTINA DE FORMATEO DE FECHAS Y DIRECCIONES
    fechacom = #0#9;
    |SI #0#10 = "A";
         fechobra = #labtraba#36;
    |SINO;
         fechobra = #0#11;
    |FINSI;
    |QBF fechobra;
    |SI fechobra = "";
         fechobra = "blanco";
    |FINSI;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
    diaobra = fechobra % A102;
    mesobra = fechobra % A402;
    anyobra = fechobra % A704;
  |SI mescom = 01;  fechacom =  uno;    |FINSI;
  |SI mescom = 02;  fechacom =  dos;    |FINSI;
  |SI mescom = 03;  fechacom = tres;    |FINSI;
  |SI mescom = 04;  fechacom = cuatro;  |FINSI;
  |SI mescom = 05;  fechacom = cinco;   |FINSI;
  |SI mescom = 06;  fechacom = seis;    |FINSI;
  |SI mescom = 07;  fechacom = siete;   |FINSI;
  |SI mescom = 08;  fechacom = ocho;    |FINSI;
  |SI mescom = 09;  fechacom = nueve;   |FINSI;
  |SI mescom = 10;  fechacom = diez;    |FINSI;
  |SI mescom = 11;  fechacom = once;    |FINSI;
  |SI mescom = 12;  fechacom = doce;    |FINSI;
  |SI mesobra = 01; fechobra = unob;    |FINSI;
  |SI mesobra = 02; fechobra = dosb;    |FINSI;
  |SI mesobra = 03; fechobra = tresb;   |FINSI;
  |SI mesobra = 04; fechobra = cuatrob; |FINSI;
  |SI mesobra = 05; fechobra = cincob;  |FINSI;
  |SI mesobra = 06; fechobra = seisb;   |FINSI;
  |SI mesobra = 07; fechobra = sieteb;  |FINSI;
  |SI mesobra = 08; fechobra = ochob;   |FINSI;
  |SI mesobra = 09; fechobra = nueveb;  |FINSI;
  |SI mesobra = 10; fechobra = diezb;   |FINSI;
  |SI mesobra = 11; fechobra = onceb;   |FINSI;
  |SI mesobra = 12; fechobra = doceb;   |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    fobra = diaobra + fechobra;
    fobra = fobra + anyobra;

    loca = #1#6;
    |QBF loca;
    local = loca;
    calle1 = #1#3;
    numca = #1#4;
    piso = #1#5;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numca;
    calle = calle + espa;
    calle = calle + piso;
    calle2 = #2#3;
    numcat = #2#4;
    pisot = #2#5;
    |QBF calle2;
    callet = calle2 + comaespa;
    callet = callet + numcat;
    callet = callet + espa;
    callet = callet + pisot;
|FPRC;
/*
|PROCESO litedura;              || CONSTRUYE LITERAL DURACION PARA IMPRESION
    mesestra = #3#18;
    diastra = #3#22;
    varal = "";
    |SI mesestra ! 0;
        varal = mesestra;
        varal = varal + xmeses;
    |SINO;
        varal = "";
    |FINSI;
    |SI diastra ! 0;
        |SI mesestra ! 0;
            varal = varal + xy;
        |FINSI;
        varal = varal + diastra;
        varal = varal + xdias;
    |SINO;
        varal = varal + "";
    |FINSI;
|FPRC;
*/
|PROCESO labtraba;
     swSigue = 0;
     aAlfa = #labtraba#36
     fFechaAlta = aAlfa;
     |SI fDesdeFecha [ fFechaAlta; |Y fFechaAlta [ fHastaFecha;
          swSigue = swSigue + 1;
     |FINSI;
     |SI #0#4 [ #labtraba#45; |Y #labtraba#45 [ #0#5;
          swSigue = swSigue + 1;
     |FINSI;

     |SI swSigue = 2;
          #labempre#0 = #labtraba#0;
          |LEE 000#labempre.=;         || lee empresa

          |HAZ conversi;

          |PRINT;
          |PIEINF;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#1;
     ;
     #0#0, #0#2;
     #0#1, #0#3;
     ;
     NULL, labtraba;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |BORRA 020#0a;
     |FINSI;

     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "labcomfd";

               |ABRE #1;
               |ABRE #2;

               aAlfa = #0#6;
               fDesdeFecha = aAlfa;
               aAlfa = #0#7;
               fHastaFecha = aAlfa;

               |BUCLE labtraba;

               |FININF;
               |FINIMP;

               |CIERRA #1;
               |CIERRA #2;
          |SINO;
              |MENAV "    Proceso Abortado ...";
          |FINSI;
          |FINIMP;
     |FINSI;

     |GRABA 000#0n;
     |CIERRA #0;
|FPRO;
