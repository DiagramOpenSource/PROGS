|FICHEROS;
     nominfjr #0;

     nominfho;      || estos ficheros los uso para los campos del informe
     nomcal03;
     nomcal04 #1;
     nomfical;

     labempre;
     labcentr;
     labtraba;
     nomcenes;
     nomcontr;
     nomvarca;
|FIN;

|VARIABLES;
     nCampo        = 0;
     topemes       = 0;
     nMes          = 0;
     nActivoNuevo  = 0;
     nOpcion       = 0;
     nPasada       = 0;
     nHay          = 0;

     aAlfa         = "";
     aPathTrab     = "";
     aFicPDF       = "";
     aFecha        = "";
     aMes          = "";
     aAny          = "";

     fFecha        = @;
     fFechaRef     = @;
     fIniMes       = @;
     fFinMes       = @;
     fFechaIniMes  = @;
     fFechaFinMes  = @;
     fFechaAlta    = @;
     fFechaBaja    = @;

 {-1} aMenu        = "";
      aMenu1       = "2400";
      aMenu2       = "1";
      aMenu3       = "";
      aMenu4       = "IABC";
      aMenu5       = "Imprimir ";
      aMenu6       = "Archivar ";
      aMenu7       = "amBos    ";
      aMenu8       = "Cancelar ";

     &aMesLetra       = "";
     &aFechaIniMes    = "";
     &aFechaFinMes    = "";
     &eaVengoDe       = "";
     &nArchi          = 0;
     &eaUnidadBasico  = "";
     &eaOrig          = "";
     &eaObservaciones = "";
     &enSwDesde9      = 0;
     &enEmp           = 0;
     &enTra           = 0;
     &enMes           = 0;
     &enAny           = 0;
     &enSwMeteGrupoSubTipo = 0;

     nNume = 0;

     aNombreMes = "";
     nCampo1 = 0;
     nDesde = 0;
     nHasta = 0;
     nCampoD = 0;
     nCampoH = 0;
     nCampoP = 0;
     nTDMes = 0;
     nDia = 0;
     nAny = 0;
     nPeso = 0;
     nPesoAnt = 0;
     nEmp = 0;
     nTra = 0;
     FEstado = 0;
     aAlfa0 = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     fFecha1 = @;
     fFecha2 = @;
     aDiaSemana = "";
     aDiaQueBusco = "";
     nDiaQueBusco = 0;
     aDesde = "";
     aHasta = "";
     nNPeso = 0;
     nCal = 0;
     nModo = 0;

     swError = 0;
     swHorasLoc = 0;
     aHorasSalida = "";
     aMinutosSalida = "";
     aHoras = "";
     aLon = "";
     nLon = 0;
     nCar = 0;
     nPos = 0;
     nNume1 = 0;
     nNume2 = 0;
     aLonHoras = "";
     nLonHoras = 0;
     nSuma = 0;

     nCop_6 = 0;
     nCop_7 = 0;
     aCop_8 = "";
     aCop_9 = "";
     aCop_10 = "";
     aCop_11 = "";
     aCop_15 = "";
     aCop_16 = "";
     aCop_17 = "";
     aCop_18 = "";
     swFestivo = 0;
|FIN;

|PROCESO Defectos; |TIPO 7;
     fFecha = ~;
     aAlfa = fFecha;
     aAlfa = aAlfa % -104;
     #nominfjr#4 = aAlfa;
     |PINTA #nominfjr#4;

     aAlfa = fFecha;
     aAlfa = aAlfa % 402;
     #nominfjr#5 = aAlfa;
     #nominfjr#6 = aAlfa;
     |PINTA #nominfjr#5;
     |PINTA #nominfjr#6;
|FPRC;

|PROCESO ultidia;
     topemes = 31;
     |SI nMes = 4; |O  nMes = 6; |O  nMes = 9; |O  nMes = 11;
          topemes = 30;
     |FINSI;
     |SI nMes = 2;
          topemes = 28;
          nNume = #0#4 $ 4;
          |SI nNume = 0;
               topemes = 29;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MesHasta;
     #nominfjr#6 = #nominfjr#5;
     |PINTA #nominfjr#6;
|FPRC;

|PROCESO DiasMes;
     nTDMes = 31;
     |SI nMes = 4; |O nMes = 6; |O nMes = 9; |O nMes = 11;
          nTDMes = 30;
     |SINO;
          |SI nMes = 2;
               nTDMes = 28;
               nNume = nAny $ 4;
               |SI nNume = 0;
                    nTDMes = 29;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CreaMes;
     |HAZ DiasMes;

     |PARA nDia = 1; |SI nDia [ nTDMes; |HACIENDO nDia = nDia + 1;
          |DDEFECTO #1;
          #1#0 = nEmp;         || Empresa
          #1#1 = nTra;         || Trabajador
          #1#2 = nAny;         || A¤o
          #1#3 = nMes;         || Mes
          #1#4 = nDia;         || Dia

          || 0: laborable
          || 1: festivo

          nPeso = 0;

          || busco que dia de la semana es el dia en que estoy
          aAlfa0 = nDia; |QBF aAlfa0;
          aAlfa0 = ("00" + aAlfa0) % -102;
          aAlfa1 = nMes; |QBF aAlfa1;
          aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = nAny;
          aAlfa3 = aAlfa0 + "."  + aAlfa1 + "." + aAlfa2;
          fFecha = aAlfa3;
          fFecha1 = fFecha % 1;
          aAlfa3 = fFecha1 % 1102;

          |SI aAlfa3 = "Lu"; aDiaSemana = "Lunes    "; |FINSI;
          |SI aAlfa3 = "Ma"; aDiaSemana = "Martes   "; |FINSI;
          |SI aAlfa3 = "Mi"; aDiaSemana = "Mi‚rcoles"; |FINSI;
          |SI aAlfa3 = "Ju"; aDiaSemana = "Jueves   "; |FINSI;
          |SI aAlfa3 = "Vi"; aDiaSemana = "Viernes  "; |FINSI;
          |SI aAlfa3 = "Sa"; aDiaSemana = "S bado   "; |FINSI;
          |SI aAlfa3 = "Do"; aDiaSemana = "Domingo  "; |FINSI;

          || Ahora asigno pesos segun si el dia es laborable, festivo, alta, baja o IT
          swFestivo = 0;
          nPeso = 0;     || por defecto laborale

          || Primero miro el calendario semanal

          |SI aAlfa3 = "Lu"; nPeso = #nomfical#2; |FINSI;
          |SI aAlfa3 = "Ma"; nPeso = #nomfical#3; |FINSI;
          |SI aAlfa3 = "Mi"; nPeso = #nomfical#4; |FINSI;
          |SI aAlfa3 = "Ju"; nPeso = #nomfical#5; |FINSI;
          |SI aAlfa3 = "Vi"; nPeso = #nomfical#6; |FINSI;
          |SI aAlfa3 = "Sa"; nPeso = #nomfical#7; |FINSI;
          |SI aAlfa3 = "Do"; nPeso = #nomfical#8; |FINSI;

          || despues el diario

          |PARA nCampo = 11; |SI nCampo [ 98; |HACIENDO nCampo = nCampo + 3;
               |SI #nomfical#nCampo# = 1;
                    nCampoD = nCampo - 2;
                    nCampoH = nCampo - 1;
                    aDesde = (#nomfical#nCampoD# % 302) + (#nomfical#nCampoD# % 102);
                    aHasta = (#nomfical#nCampoH# % 302) + (#nomfical#nCampoH# % 102);
                    nDesde = aDesde;

                    nHasta = aHasta;
                    aAlfa1 = nMes; |QBF aAlfa1;
                    aAlfa1 = ("00" + aAlfa1) % -102;
                    aAlfa2 = nDia; |QBF aAlfa2;
                    aAlfa2 = ("00" + aAlfa2) % -102;
                    aDiaQueBusco = aAlfa1 + aAlfa2; || (mes+dia)
                    nDiaQueBusco = aDiaQueBusco;
                    |SI nDesde [ nDiaQueBusco; |Y nDiaQueBusco [ nHasta;
                         nPeso = #nomfical#nCampo#;
                    |FINSI;
               |FINSI;
          |SIGUE;
          |PARA nCampo = 100; |SI nCampo [ 158; |HACIENDO nCampo = nCampo + 2;
               |SI #nomfical#nCampo# = 1;
                    nCampoD = nCampo - 1;
                    nCampoH = nCampo - 1;
                    aDesde = (#nomfical#nCampoD# % 302) + (#nomfical#nCampoD# % 102);
                    aHasta = (#nomfical#nCampoH# % 302) + (#nomfical#nCampoH# % 102);
                    nDesde = aDesde;

                    nHasta = aHasta;
                    aAlfa1 = nMes; |QBF aAlfa1;
                    aAlfa1 = ("00" + aAlfa1) % -102;
                    aAlfa2 = nDia; |QBF aAlfa2;
                    aAlfa2 = ("00" + aAlfa2) % -102;
                    aDiaQueBusco = aAlfa1 + aAlfa2; || (mes+dia)
                    nDiaQueBusco = aDiaQueBusco;
                    |SI nDesde [ nDiaQueBusco; |Y nDiaQueBusco [ nHasta;
                         nPeso = #nomfical#nCampo#;
                    |FINSI;
               |FINSI;
          |SIGUE;

          |SI nPeso = 1;
               swFestivo = 1;
          |FINSI;

          nNPeso = nDia + 50;

          || PESOS
          || 0: laborable
          || 1: festivo
          || 2: no esta en alta
          || 3: esta en IT

          || comprobacion de fechas de alta y baja

          fFechaAlta = #labtraba#36;
          |QBF aAlfa;
          |SI #nomvarca#16 ! "          "; |Y #nomvarca#16 ! "..........";
               aAlfa = #nomvarca#16;
          |SINO;
               aAlfa = #labtraba#37;
          |FINSI;
          |QBF aAlfa;
          |SI aAlfa = ""; |O aAlfa = "..........";
               fFechaBaja = "31.12.2999";
          |SINO;
               fFechaBaja = aAlfa;
          |FINSI;

          aAlfa1 = nDia; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #1#3; |QBF aAlfa2; aAlfa2 = ("00" + aAlfa2) % -102;
          aAlfa3 = nAny;
          aAlfa = aAlfa1 + "." + aAlfa2 + "." + aAlfa3;
          fFecha = aAlfa;
          |SI fFechaAlta [ fFecha; |Y fFecha [ fFechaBaja;
               || correcto, el trabajador esta de alta
          |SINO;
               nPeso = 2;     || TRABAJADOR EN BAJA
          |FINSI;

          || comprobacion de periodos en IT
/*
          |SI nPeso ! 2;
               |HAZ ITS;
          |FINSI;
*/
          #1#5 = aDiaSemana;

          || contemplamos posibles cambios en el calendario que ya existia
/*
          |SI FEstado = 0;
               |SI nPeso ! 0;
                    |SI #1#6 ! 0;
                         #0#5 = #0#5 - #1#6;
                         #0#7 = #0#7 - #1#6;
                         #1#6 = 0;
                         |GRABA 020#nomcal03.a;
                         |PINTA #0#5;
                         |PINTA #0#7;
                    |FINSI;
                    |SI #1#7 ! 0;
                         #0#6 = #0#6 - #1#7;
                         #0#7 = #0#7 - #1#7;
                         #1#7 = 0;
                         |GRABA 020#nomcal03.a;
                         |PINTA #0#6;
                         |PINTA #0#7;
                    |FINSI;
                    #1#8 = "";
                    #1#9 = "";
                    #1#10 = "";
                    #1#11 = "";
                    #1#15 = "";
                    #1#16 = "";
                    #1#17 = "";
                    #1#18 = "";
                    |PINTA #1#8;
                    |PINTA #1#9;
                    |PINTA #1#10;
                    |PINTA #1#11;
                    |PINTA #1#15;
                    |PINTA #1#16;
                    |PINTA #1#17;
                    |PINTA #1#18;
               |FINSI;
          |FINSI;
*/
          |SI nPeso = 1; #1#13 = "Festivo"; |FINSI;
          |SI nPeso = 2; #1#13 = "Sin alta"; |FINSI;
          |SI nPeso = 3; #1#13 = "IT     "; |FINSI;
          |SI nPeso = 4; #1#13 = "ERE    "; |FINSI;
          |SI nPeso = 5; #1#13 = "ERE TP "; |FINSI;
          |SI nPeso = 6; #1#13 = "Vacac. "; |FINSI;

          |SI nPeso = 5;
               nPeso = 0;
          |FINSI;

          |SI nPeso = 3;
               |SI swFestivo = 1;
                    #nomcal04#13 = "IT (Fes)";
               |FINSI;
          |FINSI;

          |SI nPeso = 0;
               #1#12 = 0;
          |SINO;
               #1#12 = 1;
          |FINSI;

          #1#12 = nPeso;

          |PRINT;

/*
          |SI FEstado ! 0;
               |SI nPeso = 0; |O nPeso = 3;
                    |HAZ CargaHorario;
                    |SI #1#6 ! 0;
                         #0#5 = #0#5 + #1#6;
                         #0#7 = #0#7 + #1#6;
                         |PINTA #0#5;
                         |PINTA #0#7;
                    |FINSI;
               |FINSI;
          |FINSI;

          |SI FEstado = 0;
               |GRABA 020#1a;
          |SINO;
               |GRABA 020#1n;
          |FINSI;
*/
     |SIGUE;
|FPRC;

|PROCESO Variaciones;
     |DDEFECTO #nomvarca;
     |ABRE #nomvarca;
     #nomvarca#0 = #labtraba#0;
     #nomvarca#1 = #labtraba#1;
     #nomvarca#2 = #0#5;
     #nomvarca#3 = 0;
     |LEE 000#nomvarca.=;
     |CIERRA #nomvarca;
|FPRC;

|PROCESO Calendario;
     nEmp = #labtraba#0;
     nTra = #labtraba#1;
     nAny = #0#4;
     nMes = #0#5;

     nCal = #labtraba#156;

     |ABRE #nomfical;
     #nomfical#0 = nCal;
     #nomfical#1 = nAny;
     |LEE 000#nomfical.=;
     |CIERRA #nomfical;
|FPRC;

|PROCESO Informe;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;

     |SI #labtraba#77 < #nominfjr#10;  |O #labtraba#77 > #nominfjr#11;
         |ACABA;
     |FINSI;

     #labcentr#0 = #labtraba#0;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;
     aAlfa = #labcentr#10;
     |QBF aAlfa;
     |SI aAlfa = "";
          #labcentr#10 = #labempre#13;
     |FINSI;

     || sin fecha de baja y en "B", no lo tengo que imprimir, entiendo que es
     || algo que no tiene los datos correctos y no tengo que sacarlo

     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          |SI #labtraba#44 = "B";
               |ACABA;
          |FINSI;
     |FINSI;

     |SI #labtraba#42 = "H";       || autonomos tampoco
          |ACABA;
     |FINSI;

     || comprueba fechas de alta y baja respecto al preriodo que estoy imprimiendo

     nMes = #nominfjr#5;
     aMes = nMes;
     aMes = ("00" + aMes) % -102;
     aAny = #nominfjr#4;

     aFecha = "01" + "." + aMes + "." + aAny;
     fIniMes = aFecha;

     |HAZ ultidia;
     aFecha = topemes;
     aFecha = ("00" + aFecha) % -102;
     aFecha = aFecha + "." + aMes + "." + aAny;
     fFinMes = aFecha;

     aAlfa = #labtraba#36;
     fFechaAlta = aAlfa;
     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          aAlfa = "31.12.2999";
     |FINSI;
     fFechaBaja = aAlfa;

     |SI fFechaAlta [ fFinMes; |Y fFechaBaja ] fIniMes;
          || adelante
     |SINO;
          || el trabajador esta en el Registro de Horas, aunque despues
          || resulta que la fecha de baja es anterior al periodo que se pide
          || la baja seria posterior al grabado del registro
          || no lo imprimo
          |ACABA;
     |FINSI;

     |SI #labtraba#45 = "421";
          #nomcenes#0 = #labtraba#0;
          #nomcenes#13 = #labtraba#77;
          #nomcenes#1 = 87;
          |LEE 000#nomcenes.=;
          |SI FSalida = 0;
               |PARA nCampo = 2; |SI nCampo [ 11; |HACIENDO nCampo = nCampo + 1;
                    #labcentr#Campo# = #nomcenes#Campo#;
               |SIGUE;
          |FINSI;
     |FINSI;

     |PARA nCampo = 1; |SI nCampo [ 12; |HACIENDO nCampo = nCampo + 1;
          #nominfho#nCampo# = #nominfjr#nCampo#;
     |SIGUE;

     |HAZ Calendario;
     |HAZ Variaciones;

     |PARA nDia = 1; |SI nDia [ topemes; |HACIENDO nDia = nDia + 1;
          |HAZ CreaMes;
     |SIGUE;
|FPRC;

/*
|DEFBUCLE Informe;
     #nomcal04#1;
     ;
     #nominfjr#0, #nominfjr#2, #nominfjr#4, #nominfjr#5, 01;
     #nominfjr#1, #nominfjr#3, #nominfjr#4, #nominfjr#6, 31;
     ;
     NULL, Informe;
|FIN;
*/

|DEFBUCLE Informe;
     #labtraba#1;
     ;
     #nominfjr#0, #nominfjr#2;
     #nominfjr#1, #nominfjr#3;
     ;
     NULL, Informe;
|FIN;

|PROCESO PorPantalla;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |INFOR "nominfjr";

     |BUCLE Informe;

     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO nomcal04A;
     #labempre#0 = #nomcal04#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomcal04#0;
     #labtraba#1 = #nomcal04#1;
     |LEE 000#labtraba.=;

     |SI #labtraba#77 < #nominfjr#10;  |O #labtraba#77 > #nominfjr#11;
         |ACABA;
     |FINSI;

     #labcentr#0 = #nomcal04#0;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;

     |SI #0#9 = "C";
          |SI #labtraba#42 = "X"; |O #labtraba#42 = "T"; |O #labtraba#42 = "P";
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #0#9 = "P";
          |SI #labtraba#42 ! "X"; |Y #labtraba#42 ! "T"; |Y #labtraba#42 ! "P";
               |ACABA;
          |FINSI;
     |FINSI;

     |SI nPasada = 0;
         nHay = 1;
         |ERROR10;
         |ACABA;
     |FINSI;

     || comprueba fechas de alta y baja respecto al preriodo que estoy imprimiendo

     nMes = #nomcal04#3;
     aMes = nMes;
     aMes = ("00" + aMes) % -102;
     aAny = #nomcal04#2;

     aFecha = "01" + "." + aMes + "." + aAny;
     fIniMes = aFecha;

     |HAZ ultidia;
     aFecha = topemes;
     aFecha = ("00" + aFecha) % -102;
     aFecha = aFecha + "." + aMes + "." + aAny;
     fFinMes = aFecha;

     aAlfa = #labtraba#36;
     fFechaAlta = aAlfa;
     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          aAlfa = "31.12.2999";
     |FINSI;
     fFechaBaja = aAlfa;

     |SI fFechaAlta [ fFinMes; |Y fFechaBaja ] fIniMes;
          || adelante
     |SINO;
          || el trabajador esta en el Registro de Horas, aunque despues
          || resulta que la fecha de baja es anterior al periodo que se pide
          || la baja seria posterior al grabado del registro
          || no lo imprimo
          |ACABA;
     |FINSI;

     |SI #labtraba#45 = "421";
          #nomcenes#0 = #labtraba#0;
          #nomcenes#13 = #labtraba#77;
          #nomcenes#1 = 87;
          |LEE 000#nomcenes.=;
          |SI FSalida = 0;
               |PARA nCampo = 2; |SI nCampo [ 11; |HACIENDO nCampo = nCampo + 1;
                    #labcentr#Campo# = #nomcenes#Campo#;
               |SIGUE;
          |FINSI;
     |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE nomcal04A;
     #nomcal04#1;
     ;
     #nomcal03#0, #nomcal03#1, #nomcal03#2, #nomcal03#3, 01;
     #nomcal03#0, #nomcal03#1, #nomcal03#2, #nomcal03#3, 31;
     ;
     NULL, nomcal04A;
|FIN;

|PROCESO nomcal03;


     aFicPDF = aPathTrab + "Horas" + (("00000" + #nomcal03#0) % -105);
     aFicPDF = aFicPDF +  (("00000" + #nomcal03#1) % -105);
     aFicPDF = aFicPDF +  ".pdf";

     nHay    = 0;
     nPasada = 0;
     |BUCLE nomcal04A;

     |SI nHay = 0;  |ACABA;  |FINSI;

     Impresora = "CrystalReport;" + aFicPDF;
     |IMPRE -1;
     |INFOR "nominfjr";

     nPasada = 1;
     |BUCLE nomcal04A;

     |PIEINF;
     |FININF;
     |FINIMP;

     aAlfa = aFicPDF;
     |XABRE "CE", aAlfa, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     eaVengoDe       = "nominfjr";
     enEmp           = #nomcal03#0;
     enTra           = #nomcal03#1;
     enMes           = #nomcal03#3;
     enAny           = #nomcal03#2;
     eaOrig          = aFicPDF;
     eaObservaciones = "Registro de horas";

     |HAZ Archivando;

     |PULSATECLA;
|FPRC;

|DEFBUCLE nomcal03;
     #nomcal03#1;
     ;
     #nominfjr#0, #nominfjr#2, #nominfjr#4, #nominfjr#5;
     #nominfjr#1, #nominfjr#3, #nominfjr#4, #nominfjr#6;
     ;
     NULL, nomcal03;
|FIN;

|PROCESO PonUbica;
     |SI eaUnidadBasico = "";  |HAZ LeeUnidadBasico;  |FINSI;

     aPathTrab = eaUnidadBasico  + "\DOCUMENTOS";               |RMKDIR aPathTrab;
     aPathTrab = aPathTrab + "\LABORAL";                        |RMKDIR aPathTrab;
     aPathTrab = aPathTrab + "\" + Usuario; |QBF aPathTrab;     |RMKDIR aPathTrab;
     aPathTrab = aPathTrab + "\";
|FPRC;

|PROCESO PorArchivo;
     enSwDesde9           = 1;
     enSwMeteGrupoSubTipo = 0;
     |HAZ CtrlPedirGrupoDsArchi;

     |HAZ PonUbica;
     |BUCLE nomcal03;

     aAlfa = "    Los documentos se han archivado en ";
     aAlfa = aAlfa + "la Gestión del Archivo Documental (GAD).";
     |MENAV aAlfa;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |CONFI "0000S¿ES CORRECTO?";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nOpcion = 1;
/*
     |SI nArchi = 1;
         |MENU aMenu;
         nOpcion = FSalida;
     |FINSI;
*/
     |ABRE #labempre;
     |ABRE #labcentr;
     |ABRE #labtraba;
     |ABRE #nomcenes;

     |SI nOpcion = 1;
         |HAZ PorPantalla;
     |FINSI;
/*
     |SI nOpcion = 2;
         |HAZ PorArchivo;
     |FINSI;

     |SI nOpcion = 3;
         |HAZ PorPantalla;
         |HAZ PorArchivo;
     |FINSI;
*/
     |CIERRA #nomcenes;
     |CIERRA #labtraba;
     |CIERRA #labcentr;
     |CIERRA #labempre;
|FPRC;

|PROGRAMA;
/*
     nActivoNuevo = 1;

     |SI nActivoNuevo = 1;
         eaVengoDe  = "nominfjr";
         nArchi     = 0;
         |HAZ MiraSiArchiva;
     |FINSI;
*/
     |CLS;

     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |HAZ Defectos;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;

     |PINPA #0#nominfjr;
     |PINDA #0#nominfjr;
/*
     |ABRE #nomcontr; |LEE 000#nomcontr.=; |CIERRA #nomcontr;
     |SI #nomcontr#75 = "S";
          |CAMPO_MODIFICA #0#9, 1, "S";
          |CAMPO_VISUAL #0#9, 1, "S";
          |PINTA 1924, "³ Tipo cont.:               ³";
          |PINTA #0#9;
     |SINO;
          |CAMPO_MODIFICA #0#9, 1, "N";
          |CAMPO_VISUAL #0#9, 1, "N";
          |PINTA 1924, "³                           ³";
          #0#9 = "P";
     |FINSI;
*/
     |ENDATOS #1#nominfjr;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
