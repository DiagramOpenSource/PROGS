|FICHEROS;
     labconb8 #0;
     labtraba #2;
|FIN;

|VARIABLES;
     para1=0;
     alfa1 = "";
     &space = "";
     &titulo1="";
     &titulo2="";
     &titulo3="";
     &titulo4="";
     &aCodigoC1="";
     &aCodigoC2="";
     &aCodigoC3="";
     nTipoCon = 0;
     &aCodigo = "";
     &aTipoCon1 = "";
     &aTipoCon2 = "";
     &aTipoCon3 = "";
     &aTipoCon4 = "";
     &aTipoCon5 = "";
     aAlfa = "";
     aIndefinido = "";
|FIN;

/*
|PROCESO AyudaTipos; |TIPO 7;
      |PUSHV  0606 1180;
      |BLANCO 0606 1180;
      |CUADRO 0606 1180;
      |ATRI R;
      |PINTA 0607, " Contratacion de ... ";
      |PINTA 0707, " (a) Mujeres desempleadas                                                ";
      |PINTA 0807, " (b) Mujeres desempleadas contratadas en los 24 meses siguientes al parto";
      |PINTA 0907, " (c) Mujeres desempleadas contratadas despues de 5 a¤os de inactividad   ";
      |PINTA 1007, " (d) Mayores de 45 a¤os desempleados                                     ";
      |PINTA 1107, " (e) Desempleados inscritos en la oficina de empleo al menos 6 meses in. ";
      |ATRI N;
|FPRC;
*/

|PROCESO AyudaTipos; |TIPO 7;
      |PUSHV  12291580;
      |ATRI R;
                 || 23         4         5         6         7         8
                 || 9012345678901234567890123456789012345678901234567890
      |PINTA 1229, " -Bonif. mayores 45 a¤os y 12 meses inscritos- ";
      |PINTA 1329, " (1) HOMBRES: 1200 euros/a¤o durante tres a¤os ";
      |PINTA 1429, " (2) MUJERES: 1400 euros/a¤o durante tres a¤os ";
      |ATRI 0
|FPRC;

|PROCESO PintaBonif; |TIPO 14;
     |ATRI S;
     aAlfa = #0#69;
     |QBF aAlfa;
     |SI #0#69 = "1";
          |PINTA 1529, " (1) HOMBRES: 1200 euros/a¤o durante tres a¤os ";
     |FINSI;
     |SI #0#69 = "2";
          |PINTA 1529, " (2) MUJERES: 1400 euros/a¤o durante tres a¤os ";
     |FINSI;
     |SI aAlfa = "";
          |PINTA 1529, "     -  No procede aplicar bonificación  -     ";
     |FINSI;
     |ATRI 0;
     |ATRI I;
|FPRC;

|PROCESO MuestraCampos; |TIPO 0;   ||VISUALIZA POR PANTALLA COLECTIVO O ACREDITACION DEPENDIENDO DEL TIPO DE BONIFICACION
     |POPV;
     |HAZ PintaBonif;
     /*
     |SI #0#69 = "6";
          |CAMPO_VISUAL #0#79,1,"S";
          |CAMPO_VISUAL #0#80,1,"S";
          |PINPA #1#0;
          |PINDA #1#0;
          |PINTA 1604,"Situacion acreditada por : ";
          |PINTA 1704,"Pertenece al colectivo ..: ";
          |PINTA 1804,"Autonomo:";
     |FINSI;
     |SI #0#69 = "7";
          |CAMPO_VISUAL #0#79,1,"S";
          |CAMPO_VISUAL #0#80,1,"N";
          |PINPA #1#0;
          |PINDA #1#0;
          |PINTA 1604,"Situacion acreditada por : ";
          |PINTA 1704,"                           ";
          |PINTA 1804,"Autonomo:";
     |FINSI;
     |SI #0#69 = "1"; |O #0#69 = "2";|O #0#69 = "3";|O #0#69 = "4";|O #0#69 = "5";|O #0#69 = "8";
          |CAMPO_VISUAL #0#79,1,"N";
          |CAMPO_VISUAL #0#80,1,"N";
          |PINPA #1#0;
          |PINDA #1#0;
          |PINTA 1604,"                           ";
          |PINTA 1704,"                           ";
          |PINTA 1804,"Autonomo:";
     |FINSI;
     */
|FPRC;

|PROCESO MuestraDuracion; |TIPO 0;
     |SI #0#54 ! "I";
          |SI #0#40=0; |Y #0#49=0;
               |CAMPO_VISUAL #0#27,1,"S";
               |CAMPO_VISUAL #0#42,1,"N";
               #0#27 = "HASTA QUE FINALICE LA OBRA";
               |PINTA #0#27;
          |SINO;
               |CAMPO_VISUAL #0#27,1,"N";
               |CAMPO_VISUAL #0#42,1,"S";
               |PINTA 1458,"                    ";
               |PINTA #0#42;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO QuitaSustitucion;
     #0#64="";
     || #0#65="";
     || #0#66="";
     #0#67="";
     |PINTA #0#64;
     || PINTA #0#65;
     || PINTA #0#66;
     |PINTA #0#67;
|FPRC;


|PROCESO TipoCelebracion; |TIPO 0;
     |PARA para1 = 50; |SI para1 [ 51; |HACIENDO para1 = para1 + 1;
          |SI #0Campo ! " ";|Y para1 ! Campo;
                  #0para1 = " ";
              |PINTA #0para1;
          |FINSI;
     |SIGUE;

     |PARA para1 = 64; |SI para1 [ 67; |HACIENDO para1 = para1 + 1;
          |SI #0Campo ! " ";|Y para1 ! Campo; |Y para1 ! 65;
                  #0para1 = " ";
              |PINTA #0para1;
          |FINSI;
     |SIGUE;

     |HAZ LlenaPuntos;

     |SI #0#28="C";
          |SI #0#50!" ";
               #0#0="401";
               |SI Campo=50; |HAZ lee_registro; |FINSI;
          |FINSI;
          |SI #0#51!" ";
               #0#0="402";
               |SI Campo=51; |HAZ lee_registro; |FINSI;
          |FINSI;
          |SI #0#52!" ";
               #0#0="410";
               |SI Campo=52; |HAZ lee_registro; |FINSI;
          |FINSI;
     |SINO;
          |SI #0#50!" ";
               #0#0="501";
               |SI Campo=50; |HAZ lee_registro; |FINSI;
          |FINSI;
          |SI #0#51!" ";
               #0#0="502";
               |SI Campo=51; |HAZ lee_registro; |FINSI;
          |FINSI;
          |SI #0#52!" ";
               #0#0="510";
               |SI Campo=52; |HAZ lee_registro; |FINSI;
          |FINSI;
          |SI #0#53!" ";
               #0#0="540";
               |SI Campo=53; |HAZ lee_registro; |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO TipoSustitucion; |TIPO 0;
     |PARA para1 = 64; |SI para1 [ 67; |HACIENDO para1 = para1 + 1;
          |SI #0Campo ! " ";|Y para1 ! Campo; |Y para1 ! 65;
                  #0para1 = " ";
              |PINTA #0para1;
          |FINSI;
     |SIGUE;
|FPRC;



|PROCESO TipoJornada;|TIPO 0;
     |SI #0#28="C";
          |PINTA 1332,"    1er. dia semana..:    Ult. dia semana..:  ";
          |CAMPO_VISUAL #0#77,1,"N";
          |CAMPO_VISUAL #0#31,1,"N";
          |CAMPO_VISUAL #0#33,1,"S";
          |CAMPO_VISUAL #0#34,1,"S";
          |PINTA #0#33;
          |PINTA #0#34;

          |CAMPO_MODIFICA #0#30,1,"N";
          #0#30="S";
          |PINTA #0#30;

          |CAMPO_VISUAL #0#31,1,"N";

          |CAMPO_VISUAL #0#53,1,"N";
          ||CAMPO_VISUAL #0#29,1,"N";
          |PINTA 2303,"                                                                            ";
          ||PINTA 2203,"                            ";

          |CAMPO_MODIFICA #0#55,1,"N";
          |CAMPO_MODIFICA #0#56,1,"N";
          |CAMPO_MODIFICA #0#57,1,"N";
          |CAMPO_MODIFICA #0#58,1,"N";
          |CAMPO_MODIFICA #0#59,1,"N";
          |CAMPO_MODIFICA #0#60,1,"N";
     |SINO;
          |PINTA 1331,"                                                ";
          |PINTA 1332,"Jornada inferior a:";
          |CAMPO_VISUAL #0#77,1,"S";
          |PINTA #0#77;
          |CAMPO_VISUAL #0#33,1,"N";
          |CAMPO_VISUAL #0#34,1,"N";

          |CAMPO_MODIFICA #0#30,1,"S";
          #0#30="S";
          |PINTA #0#30;

          |CAMPO_VISUAL #0#31,1,"S";
          |PINTA 1356,"Maximo Horas:";
          |PINTA #0#31;

          |CAMPO_MODIFICA #0#55,1,"S";
          |CAMPO_MODIFICA #0#56,1,"S";
          |CAMPO_MODIFICA #0#57,1,"S";
          |CAMPO_MODIFICA #0#58,1,"S";
          |CAMPO_MODIFICA #0#59,1,"S";
          |CAMPO_MODIFICA #0#60,1,"S";
     |FINSI;
|FPRC;

|PROCESO PonNombre;
     |SI #0#52="X";
          |ABRE #2;                     || EN LA RELACION CON EL FICHERO DE
              #2#0 = #0#75;              || TRABAJADORES
              #2#1 = #0#76;
          |LEE 000#2=;
          |SI FSalida = 0;
               #0#68=#2#2;
          |SINO;
               |MENAV "0000Atencion, El Trabajador no Existe!";
               #0#68="";
          |FINSI;
          |CIERRA #2;
     |FINSI;
|FPRC;


|PROCESO LlenaPuntos;
     |SI #0#50=" ";
          ||#0#61="........................................";
          ||PINTA #0#61;
     |FINSI;
     alfa1 = #0#62;
     |QBF alfa1;
     |SI alfa1="";
          ||#0#62="..................................................";
          ||PINTA #0#62;
     |FINSI;
     |SI #0#52=" ";
          ||#0#63="........................................";
          ||#0#68="........................................";
          ||PINTA #0#63;
          ||PINTA #0#68;
     |FINSI;
     |SI #0#53=" ";
          ||#0#29=0;
          ||PINTA #0#29;
     |FINSI;

|FPRC;

|PROCESO Tipo3b8; |TIPO 3;
     |HAZ Comienzo;
     |HAZ Tipocon;
|FPRC;

|PROCESO Comienzo;
     titulo3="";
     |SI #0#28="C";
          titulo1="Tiempo Completo";
          |SI #0#50!" ";
               titulo2="- Obra o Servicio Determinado";
               #0#0="401";
               aCodigoC1="4";
               aCodigoC2="0";
               aCodigoC3="1";
          |FINSI;
          |SI #0#51!" ";
               titulo2="- Eventual por circunstancias";
               titulo3="  de la produccion";
               #0#0="402";
               aCodigoC1="4";
               aCodigoC2="0";
               aCodigoC3="2";
          |FINSI;
          |SI #0#64!" ";
               titulo2="- Interinidad";
               #0#0="410";
               aCodigoC1="4";
               aCodigoC2="1";
               aCodigoC3="0";
          |FINSI;
          /*
          |SI #0#65!" ";
               titulo2="- Formaci¢n";
               #0#0="410";
               aCodigoC1="4";
               aCodigoC2="1";
               aCodigoC3="0";
          |FINSI;
          */
          |SI #0#66!" ";
               titulo2="- Pr cticas";
               #0#0="410";
               aCodigoC1="4";
               aCodigoC2="1";
               aCodigoC3="0";
          |FINSI;
          |SI #0#67!" ";
               titulo2="- Otros contratos";
               #0#0="410";
               aCodigoC1="4";
               aCodigoC2="1";
               aCodigoC3="0";
          |FINSI;
     |SINO;
          titulo1="Tiempo Parcial";
          |SI #0#50!" ";
               titulo2="- Obra o Servicio Determinado";
               #0#0="501";
               aCodigoC1="5";
               aCodigoC2="0";
               aCodigoC3="1";
          |FINSI;
          |SI #0#51!" ";
               titulo2="- Eventual por circunstancias";
               titulo3="  de la produccion";
               #0#0="502";
               aCodigoC1="5";
               aCodigoC2="0";
               aCodigoC3="2";
          |FINSI;
          |SI #0#52!" ";
               titulo2="- Interinidad";
               #0#0="510";
               aCodigoC1="5";
               aCodigoC2="1";
               aCodigoC3="0";
          |FINSI;
          |SI #0#53!" ";
               titulo2="- Situaci¢n de jubilaci¢n parcial";
               #0#0="540";
               aCodigoC1="5";
               aCodigoC2="4";
               aCodigoC3="0";
          |FINSI;

          |SI #0#30="D";
               titulo4="al d¡a";
          |FINSI;
          |SI #0#30="S";
               titulo4="a la semana";
          |FINSI;
          |SI #0#30="M";
               titulo4="al mes";
          |FINSI;
          |SI #0#30="A";
               titulo4="al a¤o";
          |FINSI;
     |FINSI;

     ||HAZ LlenaPuntos;

     |HAZ LeePaises;
|FPRC;

|PROCESO PintaPantalla;|TIPO 7;
     |HAZ TipoJornada;
|FPRC;

|PROCESO Repinta; |TIPO 7;
   |HAZ TipoJornada;
|FPRC;

|PROCESO TipoColectivoE; |TIPO 7;
     |PINTA 1427, "(1)";
     |PINTA 1527, "(2)";
     |PINTA 1627, "(3)";
     |PINTA 1459, "(4)";
     |PINTA 1559, "(5)";
|FPRC;

|PROCESO TipoColectivoS; |TIPO 0;
/*
     |ATRI R;
     |SI #0#69 = "1";    |PINTA 1427, "(1)";   |FINSI;
     |SI #0#69 = "2";    |PINTA 1527, "(2)";   |FINSI;
     |SI #0#69 = "3";    |PINTA 1627, "(3)";   |FINSI;
     |SI #0#69 = "4";    |PINTA 1459, "(4)";   |FINSI;
     |SI #0#69 = "5";    |PINTA 1559, "(5)";   |FINSI;
     |ATRI 0;
*/
|FPRC;

|PROCESO TipoLey;|TIPO 0;
     |SI #0Campo="N";
          |CAMPO_MODIFICA #0#69,1,"N";
          #0#69=" ";
          |PINTA #0#69;
     |SINO;
          || #0#69="1";
          |CAMPO_MODIFICA #0#69,1,"S";
     |FINSI;
|FPRC;

|PROCESO maximo; |TIPO 0;
     |SI #0#77 ! "C";
          |CAMPO_MODIFICA #0#31,1,"N";
     |SINO;
          |CAMPO_MODIFICA #0#31,1,"S";
     |FINSI;
|FPRC;

|PROCESO bonif; |TIPO 0;
     |SI #0#29 = "N";
          |CAMPO_MODIFICA #0#69,1,"N";
          #0#69 = " ";
          |PINTA #0#69;
/*          |CAMPO_MODIFICA #0#79,1,"N";
          #0#79 = " ";
          |PINTA #0#79;
          |CAMPO_MODIFICA #0#80,1,"N";
          #0#80 = " ";
          |PINTA #0#80;
*/

          |CAMPO_VISUAL #0#79,1,"N";
          |CAMPO_VISUAL #0#80,1,"N";
          |CAMPO_VISUAL #0#81,1,"N";
          |PINPA #1#0;
          |PINDA #1#0;
          ||PINTA 1604,"                           ";
          ||PINTA 1704,"                           ";
          ||PINTA 1804,"         ";
     |SINO;
          |CAMPO_MODIFICA #0#69,1,"S";
/*
          |CAMPO_VISUAL #0#81,1,"S";
          |PINTA 1804,"Autonomo: ";
*/
          |PINDA #1#0;
     |FINSI;
|FPRC;

|PROCESO tipobonif; |TIPO 0;
     |SI #0#29 = "S"; |Y #0#69 = " ";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO indefinido; |TIPO 0;
     |SI #0#54 = "I";
          |CAMPO_MODIFICA #0#27,1,"N";
          |CAMPO_MODIFICA #0#42,1,"N";
          |CAMPO_MODIFICA #0#40,1,"N";
          |CAMPO_MODIFICA #0#49,1,"N";
          |CAMPO_VISUAL #0#27,1,"N";
          |CAMPO_VISUAL #0#42,1,"N";
          |CAMPO_VISUAL #0#40,1,"N";
          |CAMPO_VISUAL #0#49,1,"N";
          |PINTA 1445, "                                  ";
          |CAMPO_MODIFICA #0#50,1,"N";
          |CAMPO_MODIFICA #0#51,1,"N";
          |CAMPO_MODIFICA #0#64,1,"N";
          || CAMPO_MODIFICA #0#65,1,"N";
          ||CAMPO_MODIFICA #0#66,1,"N";
          |CAMPO_MODIFICA #0#67,1,"N";
          |HAZ LlenaPuntos;
          #0#50 = " ";
          #0#51 = " ";
          #0#64 = " ";
          || #0#65 = " ";
          ||#0#66 = " ";
          #0#67 = " ";
          |PINTA #0#50;
          |PINTA #0#51;
          |PINTA #0#64;
          || PINTA #0#65;
          ||PINTA #0#66;
          |PINTA #0#67;
          |ATRI S;
          |PINTA 1231, "INDEFINIDO";
          |ATRI 0;
     |SINO;
          |CAMPO_MODIFICA #0#27,1,"S";
          |CAMPO_MODIFICA #0#42,1,"S";
          |CAMPO_MODIFICA #0#40,1,"S";
          |CAMPO_MODIFICA #0#49,1,"S";
          |CAMPO_VISUAL #0#27,1,"S";
          |CAMPO_VISUAL #0#42,1,"S";
          |CAMPO_VISUAL #0#40,1,"S";
          |CAMPO_VISUAL #0#49,1,"S";
          |PINTA #0#42;
          |CAMPO_MODIFICA #0#50,1,"S";
          |CAMPO_MODIFICA #0#51,1,"S";
          |CAMPO_MODIFICA #0#64,1,"S";
          || CAMPO_MODIFICA #0#65,1,"S";
          ||CAMPO_MODIFICA #0#66,1,"S";
          |CAMPO_MODIFICA #0#67,1,"S";
          |ATRI S;
          |PINTA 1231, "TEMPORAL";
          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO Tipocon;
     |SI #0#54 = "I";
          nTipoCon = 100;
          aTipoCon1 = "Contrato Indefinido";
          |SI #0#28 = "C";
               aTipoCon2 = "Tiempo Completo";
          |SINO;
               aTipoCon2 = "Tiempo Parcial";
               nTipoCon = nTipoCon + 100;
          |FINSI;
          |SI #0#29 = "S";
               aTipoCon3 = "Bonificado";
               nTipoCon = nTipoCon + 50;
          |SINO;
               aTipoCon3 = "No Bonificado";
          |FINSI;
     |SINO;
          aTipoCon1 = "Contrato Temporal";
          nTipoCon = 400;

          |SI #0#28 = "C";
               aTipoCon2 = "Tiempo Completo";
          |SINO;
               aTipoCon2 = "Tiempo Parcial";
               nTipoCon = nTipoCon + 100;
          |FINSI;

          |SI #0#29 = "S";
               aTipoCon3 = "Bonificado";
               nTipoCon = nTipoCon + 50;
          |SINO;
               aTipoCon3 = "No Bonificado";
          |FINSI;

          |SI #0#50!" ";
               aTipoCon4 = "Obra o Servicio Determinado";
               |SI aTipoCon3 = "No Bonificado";
                    nTipoCon = nTipoCon + 1;
               |FINSI;
          |FINSI;
          |SI #0#51!" ";
               aTipoCon4 = "Eventual por circunstancias";
               aTipoCon5 = "de la produccion";
               |SI aTipoCon3 = "No Bonificado";
                    nTipoCon = nTipoCon + 2;
               |FINSI;
          |FINSI;
          |SI #0#64!" ";
               aTipoCon4 = "Interinidad";
               |SI aTipoCon3 = "No Bonificado";
                    nTipoCon = nTipoCon + 10;
               |FINSI;
          |FINSI;
          /*
          |SI #0#65!" ";
               aTipoCon4 = "Formaci¢n";
               |SI aTipoCon3 = "No Bonificado";
                    nTipoCon = nTipoCon + 21;
               |FINSI;
          |FINSI;
          */
          |SI #0#66!" ";
               aTipoCon4 = "Pr cticas";
               |SI aTipoCon3 = "No Bonificado";
                    nTipoCon = nTipoCon + 20;
               |FINSI;
          |FINSI;
          |SI #0#67!" ";
               aTipoCon4 = "Otros Contratos";
               nTipoCon = nTipoCon + 990;
          |FINSI;
     |FINSI;
          aCodigo = nTipoCon;
          aCodigoC1 = aCodigo % 101;
          aCodigoC2 = aCodigo % 201;
          aCodigoC3 = aCodigo % 301;
|FPRC;

|PROCESO Ayuda82; |TIPO 7;
     |PUSHV  19012380;
     |ATRI R;
                || 0     1         2         3         4         5         6         7      7
                || 45678901234567890123456789012345678901234567890123456789012345678901234567
     |PINTA 1904, "El trabajador es mayor de 52 a¤os, se encuentra inscrito en el SEPE y es  ";
     |PINTA 2004, "beneficiario de cualquiera de los subsidios por desempleo:                ";
     |PINTA 2104, " (1) Recogidos en el art. 215 del Texto Refundido de la Ley General S.S.  ";
     |PINTA 2204, " (2) Eventuales incluidos en el Reg. Agrario, regulado por la Ley 43/2006 ";
     |ATRI 0;
|FPRC;

|PROCESO Marca29;
     |SI #0#85 = "S"
          #0#29 = "S";
     |SINO;
          #0#29 = "N";
     |FINSI;
|FPRC;

|PROCESO Activa86; |TIPO 7;
     |SI #0#29 = "S";
          |CAMPO_MODIFICA #0#86, 1, "S";
     |SINO;
          #0#86 = "";
          |PINTA #0#86;
          |CAMPO_MODIFICA #0#86, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Caracter; |TIPO 7;
     aIndefinido = PARAMETRO;
     aIndefinido = aIndefinido % 101;
     #0#54 = aIndefinido;
     |PINTA #0#54;
|FPRC;

|PROCESO ActivaBon; |TIPO 7;
     |SI #0#54 = "I";
          |CAMPO_MODIFICA #0#29, 1, "S";
     |SINO;
          #0#29 = "N";
          |PINTA #0#29;
          |CAMPO_MODIFICA #0#29, 1, "N";

          #0#86 = "";
          |PINTA #0#86;
          |CAMPO_MODIFICA #0#86, 1, "N";
     |FINSI;
|FPRC;
