|FICHEROS;
     hotm0003 #0;
     hotm0001 #1; || temporal trabajadores
|FIN;


|VARIABLES;
     i=0;
     nSeguir=0;
     nHandle=0;
     nContador=0;
     nExiste=0;
     aCadena="";
     aCadena1="";
     aCadena2="";
     nNumero=0;
     aPath="";
     aLinea="";

|| variables para llenar de ceros
     r_alfa = "";
     r_long = "";
     r_num  = 0;
     r_masc = "00"; || mascara para tama¤o 2
     nTam=0;
|FIN;

|PROCESO DialogoBrowse;| TIPO 0;
     |SI FSalida=13;
          aPath = "D" + "";
          |BROWSE aPath;
          aPath = (aPath % 270);
          |QBF aPath;
          |SI aPath!"";
               #0#5=aPath;
               |PINTA #0#5;
          |FINSI;
     |FINSI;
|FPRC;


|PROCESO llena_ceros;
          |QBF aCadena;
          r_alfa= aCadena;
          |QBF r_alfa;
          r_long = aCadena % A0;
          r_alfa = r_masc + r_alfa;
          r_num = -1*(100+nTam);    || para tama¤o "nTam"
          aCadena = r_alfa % r_num;
|FPRC;

|PROCESO PonEspacios;
     aLinea=#0#4;
|FPRC;

|PROCESO PGrabar;
     nContador=nContador+1;
     aLinea="";

     aCadena=#1#2;   || centro
     nTam=2;
     r_masc="00";
     |HAZ llena_ceros;
     aLinea=aLinea+aCadena;
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#3;  || area
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#4;  || centro
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#5;  || nombre
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#9;  || apellido 1
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#10; || apellido 2
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#11; || sexo
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#12; || nafss
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#13; || nif
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#14; || domicilio
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#15; || numero
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#16; || piso
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#17; || localidad
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aCadena=#1#18;   || cp1
     nTam=2;
     r_masc="00";
     |HAZ llena_ceros;
     aLinea=aLinea+aCadena;
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aCadena=#1#19;   || cp2
     nTam=3;
     r_masc="000";
     |HAZ llena_ceros;
     aLinea=aLinea+aCadena;
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#20; || provincia
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#21; || nacido en
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aCadena=#1#22;
     aLinea=aLinea+aCadena; || fecha
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aCadena=#1#23;   || edad
     nTam=3;
     r_masc="000";
     |HAZ llena_ceros;
     aLinea=aLinea+aCadena;
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#24; || telefono
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#25; || movil
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#27; || categoria
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#28; || puesto
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aCadena=#1#29;
     aLinea=aLinea+aCadena; || fecha de alta
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#40; || banco
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#42; || domicilio banco
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#43; || poblacion banco
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#44; || CCC
     |XGRABA nHandle,aLinea;

     |HAZ PonEspacios;
     aLinea=aLinea+#1#45; || Servicio militar
     |XGRABA nHandle,aLinea;

     aLinea=&10+&13;
     |XGRABA nHandle,aLinea;
|FPRC;

|DEFBUCLE BGrabar;
     #1#1;
     ;
     #0#0,#0#2;
     #0#1,#0#3;
     ;
     NULL,PGrabar;
|FIN;



|PROCESO Proceso;
     aPath=#0#5;
     |QBF aPath;

     |RMKDIR aPath;   || crear el directorio por si no existe

     aCadena=aPath % -101;
     |SI aCadena="\";
          aPath=aPath+#0#6;
     |SINO;
          aPath=aPath+"\"+#0#6;
     |FINSI;
     |QBF aPath;

     nSeguir=-1;
     nHandle=0;
     |XABRE "CE",aPath,nHandle;
     |SI FSalida=1;   || el archivo ya existe
          |XCIERRA nHandle;
          |CONFI "00000El Archivo ya Existe, deseas Sobreescribirlo?";
          |SI FSalida=0;
               nSeguir=0;
          |FINSI;
     |SINO;
          nSeguir=0;
     |FINSI;

     |SI nSeguir=0;
          |XABRE "CBW",aPath,nHandle;
          |SI FSalida=0;
               nContador=0;
               |BUCLE BGrabar;

               aCadena1=nContador;
               aCadena2="0000Grabados "+aCadena1+" Trabajadores";
               |MENAV aCadena2;

               |XCIERRA nHandle;
          |FINSI;
     |SINO;
          |ERROR;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |DDEFECTO #0;
     |LEE 101#0p;
     nExiste=FSalida;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida=0;
          |SI nExiste=0;
               |GRABA 020#0a;
          |SINO;
               |GRABA 020#0n;
          |FINSI;
          |HAZ Proceso;
     |FINSI;

     |LIBERA #0;
     |CIERRA #0;
|FPRO;
