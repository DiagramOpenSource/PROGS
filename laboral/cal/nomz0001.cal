|FICHEROS;
     nomz0001 #0;
     nomir001 #1;
     nomir003 #3;
     nomir005 #5;
     labtraba #100;
     labpadre #101;

     :/basica/def/agidanif #33;
     :/basica/def/dspase00 #200;

     &regisnif@ #712;

     refer00@ #900;     || nomir006
|FIN;

|VARIABLES;
     nEmpresa      = 0;
     nAnyo         = 0;
     nC1           = 0;
     nC2           = 0;
     nC3           = 0;
     nC4           = 0;
     nC5           = 0;
     nBlanco1      = 0;
     nBlanco2      = 0;
     nComa         = 0;
     nPara         = 0;
     nPosi         = 0;
     nLongNume     = 0;
     nChequeo      = 0;
     nLinea        = 0;
     nAnyoMas1     = 0;
     nEntrada      = 0;

     aCadena       = "";
     aCadena1      = "";
     aCadena2      = "";
     aCadena3      = "";
     aCaracter     = "";
     aLongAlfa     = "";
     aParaQuitar   = "";
     aAlfa         = "";
     aPassword     = "";
     aAlfa1        = "";
     aAlfa2        = "";

     &eaCodNif     = "";

     aDef00            = "";
     nSwAnterior       = 0;
     aPathAnterior     = "";
     aPathDefLaboral   = "";
     aPathFichLaboral  = "";
     aNif              = "";

     fFecha            = @;

     &eaPathBasica     = "";
     aPath             = "";
|FIN;

|PROCESO Nomo;
     |C_M #0#2, 1, "S";
     |SI #0#3 = 0;
         |C_M #0#2, 1, "N";  #0#2 = 0;  |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO QuitaBlanco;
     |ET aCadena;
         |QBF aParaQuitar;
         |SI aParaQuitar ! "";
             aCaracter = aParaQuitar % 101;
             |SI aCaracter = " ";
                 aParaQuitar = aParaQuitar % 240;
                 |VETE aCadena;
             |FINSI;
         |FINSI;
|FPRC;

|PROCESO SeparaNombre;
     || Busca una coma en la aCadena

     aCadena1 = "";
     aCadena2 = "";
     aCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nPara = 1; |SI nPara [ 40; |HACIENDO nPara = nPara + 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena % nPosi;

           |SI aCaracter = ","; nComa = nPara; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay coma busca el primer blanco empezando por detras

         aLongAlfa = aCadena % 0;
         nLongNume = aLongAlfa;

         |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
               nPosi = nPara * 100 + 1;
               aCaracter = aCadena % nPosi;
               |SI aCaracter = " "; nComa = nPara; |SAL; |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros aCaracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     aCadena2  = aCadena % nPosi;
     aLongAlfa = aCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nPara; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     aCadena2 = aCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     aCadena1 = aCadena % nPosi;

     || Recoge los dos primero aCaracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     aCadena3 = aCadena % nPosi;

     aParaQuitar = aCadena1; |HAZ QuitaBlanco; aCadena1 = aParaQuitar;
     aParaQuitar = aCadena2; |HAZ QuitaBlanco; aCadena2 = aParaQuitar;
     aParaQuitar = aCadena3; |HAZ QuitaBlanco; aCadena3 = aParaQuitar;

     |QBF aCadena1;
     |QBF aCadena2;
     |QBF aCadena3;
|FPRC;

|PROCESO labtraba;
     eaCodNif = #100#7;
     |HAZ LeeNifs;

     nEntrada = 0;

     |ABRE #101;
     #101#0 = #100#0;
     #101#1 = #100#1;
     |LEE 040#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     |ABRE #33;
     #33#0 = #100#7;
     #33#1 = 1;
     |LEE 040#33=;
     |SI FSalida = 0;
         |SI #0#1 ! 3;
             aAlfa1 = #100#11;    |QBF aAlfa1;
             aAlfa2 = #33#13;     |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;  |Y aAlfa1 ! "";  nEntrada = 1;  |FINSI;

             aAlfa1 = #100#111;    |QBF aAlfa1;
             aAlfa2 = #33#36;      |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;  |Y aAlfa1 ! "";  nEntrada = 1;  |FINSI;

             aAlfa1 = #101#4;      |QBF aAlfa1;
             aAlfa2 = #33#14;      |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;  |Y aAlfa1 ! "";  nEntrada = 1;  |FINSI;
         |FINSI;

         |SI #33#2 = "            ";  nEntrada = 1;  |FINSI;
     |SINO;
         nEntrada = 1;
     |FINSI;
     |CIERRA #33;

     |SI #0#1 = 1;
         aAlfa1 = #100#2;    |QBF aAlfa1;
         aAlfa2 = #712#1;    |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         |SI #712#9 ! "  ";
             aAlfa1 = #100#3;                  |QBF aAlfa1;
             aAlfa2 = #712#9 + " " + #712#2;   |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
         |SINO;
             aAlfa1 = #100#3;                  |QBF aAlfa1;
             aAlfa2 = #712#2;                  |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
         |FINSI;

         aAlfa1 = #100#4;                  |QBF aAlfa1;
         aAlfa2 = #712#3;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#5;                  |QBF aAlfa1;
         aAlfa2 = #712#10;                 |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#8;                  |QBF aAlfa1;
         aAlfa2 = #712#4;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#9;                  |QBF aAlfa1;
         aAlfa2 = #712#5;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#6;                  |QBF aAlfa1;
         aAlfa2 = #712#6;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#10;                 |QBF aAlfa1;
         aAlfa2 = #712#7;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

         aAlfa1 = #100#244;                |QBF aAlfa1;
         aAlfa2 = #712#8;                  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
     |FINSI;

     |SI nEntrada = 0;  |ACABA;  |FINSI;

     |ABRE #712;
     #712#0 = #100#7;
     |LEE 101#712=;
     |SI FSalida ! 0;
         |DDEFECTO #712;
         #712#0  = #100#7;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
         |GRABA 020#712b;
     |FINSI;

     |SI #0#1 = 1;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
     |FINSI;

     |GRABA 020#712a;
     |LIBERA #712;
     |CIERRA #712;

     |ABRE #33;
     #33#0 = #100#7;
     #33#1 = 1;
     |LEE 101#33=;
     |SI FSalida ! 0;
         |DDEFECTO #33;
         #33#0 = #100#7;
         #33#1 = 1;
         |GRABA 020#33b;
     |FINSI;

     #33#2  = "TITULAR";
     #33#8  = #33#0;
     #33#12 = #100#2;
     aAlfa  = #100#11;  |QBF aAlfa;
     |SI aAlfa ! "";  #33#13 = #100#11;  |FINSI;
     #33#24 = #712#9;
     #33#25 = #712#2;
     #33#26 = #712#3;
     #33#27 = #712#16;
     #33#28 = #712#10;
     #33#29 = #712#11;
     #33#30 = #712#4;
     #33#31 = #712#5;
     #33#32 = #712#6;
     #33#33 = #712#7;
     #33#34 = #712#8;
     aAlfa  = #101#4;  |QBF aAlfa;
     |SI aAlfa ! "";  #33#36 = #101#4;  |FINSI;
     aCadena = #33#12;
     |HAZ SeparaNombre;
     #33#9    = aCadena1;
     #33#10   = aCadena2;
     #33#11   = aCadena3;
     #33#37   = "S";

     |GRABA 020#33a;
     |LIBERA #33;
     |CIERRA #33;
|FPRC;

|DEFBUCLE labtraba;
     #100#1;
     ;
     00000, 00000;
     99999, 99999;
     ;
     NULL, labtraba;
|FIN;
|| -----------------------------------------------------------------------

|PROCESO agidanif;
     |BORRA 020#33a;
     |LIBERA #33;
|FPRC;

|DEFBUCLE agidanif;
     #33#1;
     ;
     aNif, 01;
     aNif, 99;
     be;
     NULL, agidanif;
|FIN;

|PROCESO GH;
     nLinea = nLinea + 1;

     |DDEFECTO #33;
     #33#0  = #3#0;
     #33#1  = nLinea;
     #33#2  = "DESCENDIENTE";
     #33#12 = "POR ACTUALIZAR";

     |SI #3nC3 = "S";  #33#3 = "1";  |FINSI;

     aAlfa = "01.01." + #3nC1;  #33#13 = aAlfa;

     |SI #3nC4 = "1";  #33#17 = 33;  |FINSI;
     |SI #3nC4 = "2";  #33#17 = 65;  |FINSI;

     #33#41 = #3nC2;
     #33#18 = #3nC5;

     |GRABA 020#33n;
     |LIBERA #33;
|FPRC;

|PROCESO GA;
     nLinea = nLinea + 1;

     |DDEFECTO #33;
     #33#0  = #3#0;
     #33#1  = nLinea;
     #33#2  = "ASCENDIENTE ";
     #33#3  = "1";
     #33#5  = #3nC2;
     #33#12 = "POR ACTUALIZAR";
     #33#18 = #3nC4;

     aAlfa = "01.01." + #3nC1;  #33#13 = aAlfa;

     |SI #3nC3 = "1";  #33#17 = 33;  |FINSI;
     |SI #3nC3 = "2";  #33#17 = 65;  |FINSI;

     |GRABA 020#33n;
     |LIBERA #33;
|FPRC;

|PROCESO DatosTitular;
     #712#0 = #3#0;
     |LEE 040#712=;
     |SI FSalida ! 0;  |DDEFECTO #712;  |FINSI;

     #33#0 = #3#0;
     #33#1 = 1;
     |LEE 040#33=;
     |SI FSalida ! 0;
         |DDEFECTO #33;
         #33#0  = #3#0;
         #33#1  = 1;
         #33#2  = "TITULAR";
         #33#8  = #3#0;
         #33#12 = #712#1;
         #33#19 = #712#14;
         #33#24 = #712#9;
         #33#25 = #712#2;
         #33#26 = #712#3;
         #33#28 = #712#10;
         #33#29 = #712#11;
         #33#30 = #712#4;
         #33#31 = #712#5;
         #33#32 = #712#6;
         #33#33 = #712#7;
         #33#34 = #712#8;

         aCadena = #33#12;
         |HAZ SeparaNombre;
         #33#9    = aCadena1;
         #33#10   = aCadena2;
         #33#11   = aCadena3;
         #33#37   = "S";

         |GRABA 020#33b;
     |FINSI;

     #33#13   = #100#11;
     #33#36   = #100#111;
     #33#15   = #3#3;
     #33#16   = #3#2;
     |SI #3#6 = "N";
         #33#17 = 0;
         #33#18 = "N";
     |SINO;
                          #33#17 = 65;
         |SI #3#7 = "1";  #33#17 = 33;  |FINSI;
                          #33#18 = #3#8;
     |FINSI;

                       #33#23 = "1";
     |SI #3#14 = "N";  #33#23 = "";   |FINSI;
     |SI #33#15 = 1;   #33#14 = "S";  |FINSI;
     |SI #33#15 = 2;   #33#14 = "C";  |FINSI;

     #33#38 = #3#72;
     #33#39 = #3#73;
     #33#40 = #3#74;

     #33#43 = #3#124;
     #33#44 = #3#126;

     |GRABA 020#33a;
     |LIBERA #33;
|FPRC;

|PROCESO DatosConyuge;
     #712#0 = #3#4;
     |LEE 040#712=;
     |SI FSalida ! 0;  |DDEFECTO #712;  |FINSI;

     |DDEFECTO #33;
     #33#0  = #3#0;
     #33#1  = 2;
     #33#2  = "CONYUGE";
     #33#8  = #3#4;
     #33#12 = #712#1;
     #33#19 = #712#14;
     #33#24 = #712#9;
     #33#25 = #712#2;
     #33#26 = #712#3;
     #33#28 = #712#10;
     #33#29 = #712#11;
     #33#30 = #712#4;
     #33#31 = #712#5;
     #33#32 = #712#6;
     #33#33 = #712#7;
     #33#34 = #712#8;

     aCadena = #33#12;
     |HAZ SeparaNombre;
     #33#9    = aCadena1;
     #33#10   = aCadena2;
     #33#11   = aCadena3;
     #33#14   = "C";
     #33#37   = "S";

     |GRABA 020#33n;
|FPRC;

|PROCESO DatosPersonales;
     aNif = #3#0;
     |BUCLE agidanif;

     nLinea = 2;

     |ABRE #33;

     |SI #3#20 ! 0; nC1 = 20; nC2 = 75; nC3 = 42; nC4 = 30; nC5 = 85;  |HAZ GH;  |FINSI;
     |SI #3#21 ! 0; nC1 = 21; nC2 = 76; nC3 = 43; nC4 = 31; nC5 = 86;  |HAZ GH;  |FINSI;
     |SI #3#22 ! 0; nC1 = 22; nC2 = 77; nC3 = 44; nC4 = 32; nC5 = 87;  |HAZ GH;  |FINSI;
     |SI #3#23 ! 0; nC1 = 23; nC2 = 78; nC3 = 45; nC4 = 33; nC5 = 88;  |HAZ GH;  |FINSI;
     |SI #3#24 ! 0; nC1 = 24; nC2 = 79; nC3 = 46; nC4 = 34; nC5 = 89;  |HAZ GH;  |FINSI;
     |SI #3#25 ! 0; nC1 = 25; nC2 = 80; nC3 = 47; nC4 = 35; nC5 = 90;  |HAZ GH;  |FINSI;
     |SI #3#26 ! 0; nC1 = 26; nC2 = 81; nC3 = 48; nC4 = 36; nC5 = 91;  |HAZ GH;  |FINSI;
     |SI #3#27 ! 0; nC1 = 27; nC2 = 82; nC3 = 49; nC4 = 37; nC5 = 92;  |HAZ GH;  |FINSI;
     |SI #3#28 ! 0; nC1 = 28; nC2 = 83; nC3 = 50; nC4 = 38; nC5 = 93;  |HAZ GH;  |FINSI;
     |SI #3#29 ! 0; nC1 = 29; nC2 = 84; nC3 = 51; nC4 = 39; nC5 = 94;  |HAZ GH;  |FINSI;

     |SI #3#95  ! 0; nC1 = 95;  nC2 = 52; nC3 = 62; nC4 = 105; |HAZ GA;  |FINSI;
     |SI #3#96  ! 0; nC1 = 96;  nC2 = 53; nC3 = 63; nC4 = 106; |HAZ GA;  |FINSI;
     |SI #3#97  ! 0; nC1 = 97;  nC2 = 54; nC3 = 64; nC4 = 107; |HAZ GA;  |FINSI;
     |SI #3#98  ! 0; nC1 = 98;  nC2 = 55; nC3 = 65; nC4 = 108; |HAZ GA;  |FINSI;
     |SI #3#99  ! 0; nC1 = 99;  nC2 = 56; nC3 = 66; nC4 = 109; |HAZ GA;  |FINSI;
     |SI #3#100 ! 0; nC1 = 100; nC2 = 57; nC3 = 67; nC4 = 110; |HAZ GA;  |FINSI;
     |SI #3#101 ! 0; nC1 = 101; nC2 = 58; nC3 = 68; nC4 = 111; |HAZ GA;  |FINSI;
     |SI #3#102 ! 0; nC1 = 102; nC2 = 59; nC3 = 69; nC4 = 112; |HAZ GA;  |FINSI;
     |SI #3#103 ! 0; nC1 = 103; nC2 = 60; nC3 = 70; nC4 = 113; |HAZ GA;  |FINSI;
     |SI #3#104 ! 0; nC1 = 104; nC2 = 61; nC3 = 71; nC4 = 114; |HAZ GA;  |FINSI;

     aAlfa   = #3#4;  |QBF aAlfa;
     |SI aAlfa ! "";
         |HAZ DatosConyuge;
     |FINSI;

     |HAZ DatosTitular;

     |CIERRA #33;
|FPRC;

|PROCESO nomir003R;
     #1#0 = #3#0;
     #1#2 = #3#40;
     #1#3 = #3#41;
     |LEE 040#1=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SELECT #1#100;
     #100#0 = #1#3;
     #100#1 = #1#4;
     |LEE 040#100=;
     |SI FSalida ! 0;
         |SELECT #5#100;
         #100#0 = #1#3;
         #100#7 = #1#0;
         |LEE 040#100=;
         |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |FINSI;

     #712#0 = #3#0;
     |LEE 101#712=;
     |SI FSalida ! 0;
         |DDEFECTO #712;
         #712#0 = #3#0;
         #712#1 = #100#2;
         #712#4 = #100#8;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
         |GRABA 020#712b;
      |FINSI;

     |SI #0#3 = 1;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
     |FINSI;

     |GRABA 020#712a;
     |LIBERA #712;

     |SI #0#3 = 3;
         |ABRE #33;
         #33#0 = #3#0;
         #33#1 = 1;
         |LEE 040#33];
         |SI FSalida ! 0;  |O #33#0 ! #3#0;
             |CIERRA #33;
             |HAZ DatosPersonales;
         |SINO;
             |CIERRA #33;
         |FINSI;
     |SINO;
         |HAZ DatosPersonales;
     |FINSI;
|FPRC;

|DEFBUCLE nomir003R;
     #3#1;
     ;
     "            ", #0#2, 00001;
     "zzzzzzzzzzzz", #0#2, 99999;
     be;
     NULL, nomir003R;
|FIN;

|| -------------------------------------------------------------------
|PROCESO BuscaAnterior;

     |HAZ BusquedaApli;
     aPath = eaPathBasica + "fich/";
     |PATH_DAT #200 aPath;

     nSwAnterior = 0;
     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;

     aPathDefLaboral  = aPathAnterior + "aginom/def/";
     aPathFichLaboral = aPathAnterior + "aginom/fich/";

     aDef00 = aPathDefLaboral + "nomir006.mas";
     |CARGA_DEF aDef00, refer00@;
     |SI FSalida ! 0;
         aDef00 = "";
         |ACABA;
     |FINSI;

     |PATH_DAT #900 aPathFichLaboral;
     nSwAnterior = 1;
|FPRC;

|PROCESO GH_6;
     nLinea = nLinea + 1;

     |DDEFECTO #33;
     #33#0  = #900#0;
     #33#1  = nLinea;
     #33#2  = "DESCENDIENTE";
     #33#12 = "POR ACTUALIZAR";

     |SI #900nC3 = "S";  #33#3 = "1";  |FINSI;

     aAlfa = "01.01." + #900nC1;  #33#13 = aAlfa;

     |SI #900nC4 = "1";  #33#17 = 33;  |FINSI;
     |SI #900nC4 = "2";  #33#17 = 65;  |FINSI;

     #33#41 = #900nC2;
     #33#18 = #900nC5;

     |GRABA 020#33n;
     |LIBERA #33;
|FPRC;

|PROCESO GA_6;
     nLinea = nLinea + 1;

     |DDEFECTO #33;
     #33#0  = #900#0;
     #33#1  = nLinea;
     #33#2  = "ASCENDIENTE ";
     #33#3  = "1";
     #33#5  = #900nC2;
     #33#12 = "POR ACTUALIZAR";
     #33#18 = #900nC4;

     aAlfa = "01.01." + #900nC1;  #33#13 = aAlfa;

     |SI #900nC3 = "1";  #33#17 = 33;  |FINSI;
     |SI #900nC3 = "2";  #33#17 = 65;  |FINSI;

     |GRABA 020#33n;
     |LIBERA #33;
|FPRC;

|PROCESO DatosTitular_6;
     #712#0 = #900#0;
     |LEE 040#712=;
     |SI FSalida ! 0;  |DDEFECTO #712;  |FINSI;

     #33#0 = #900#0;
     #33#1 = 1;
     |LEE 040#33=;
     |SI FSalida ! 0;
         |DDEFECTO #33;
         #33#0  = #900#0;
         #33#1  = 1;
         #33#2  = "TITULAR";
         #33#8  = #900#0;
         #33#12 = #712#1;
         #33#19 = #712#14;
         #33#24 = #712#9;
         #33#25 = #712#2;
         #33#26 = #712#3;
         #33#28 = #712#10;
         #33#29 = #712#11;
         #33#30 = #712#4;
         #33#31 = #712#5;
         #33#32 = #712#6;
         #33#33 = #712#7;
         #33#34 = #712#8;

         aCadena = #33#12;
         |HAZ SeparaNombre;
         #33#9    = aCadena1;
         #33#10   = aCadena2;
         #33#11   = aCadena3;
         #33#37   = "S";

         |GRABA 020#33b;
     |FINSI;

     #33#13   = #100#11;
     #33#36   = #100#111;
     #33#15   = #900#3;
     #33#16   = #900#2;
     |SI #900#6 = "N";
         #33#17 = 0;
         #33#18 = "N";
     |SINO;
                          #33#17 = 65;
       |SI #900#7 = "1";  #33#17 = 33;  |FINSI;
                          #33#18 = #900#8;
     |FINSI;

                         #33#23 = "";
     ||SI #900#14 = "N";  #33#23 = "";   |FINSI;
     || en el nomir006 NO existe el campo de Ceuta/Melilla, paso de momento
     |SI #33#15 = 1;     #33#14 = "S";  |FINSI;
     |SI #33#15 = 2;     #33#14 = "C";  |FINSI;

     #33#38 = #900#72;
     #33#39 = #900#73;
     #33#40 = #900#74;
     #33#43 = #900#124;
     #33#44 = #900#126;

     |GRABA 020#33a;
     |LIBERA #33;
|FPRC;

|PROCESO DatosConyuge_6;
     #712#0 = #900#4;
     |LEE 040#712=;
     |SI FSalida ! 0;  |DDEFECTO #712;  |FINSI;

     |DDEFECTO #33;
     #33#0  = #900#0;
     #33#1  = 2;
     #33#2  = "CONYUGE";
     #33#8  = #900#4;
     #33#12 = #712#1;
     #33#19 = #712#14;
     #33#24 = #712#9;
     #33#25 = #712#2;
     #33#26 = #712#3;
     #33#28 = #712#10;
     #33#29 = #712#11;
     #33#30 = #712#4;
     #33#31 = #712#5;
     #33#32 = #712#6;
     #33#33 = #712#7;
     #33#34 = #712#8;

     aCadena = #33#12;
     |HAZ SeparaNombre;
     #33#9    = aCadena1;
     #33#10   = aCadena2;
     #33#11   = aCadena3;
     #33#14   = "C";
     #33#37   = "S";

     |GRABA 020#33n;
|FPRC;

|PROCESO DatosPersonales_6;
     aNif = #900#0;
     |BUCLE agidanif;

     nLinea = 2;

     |ABRE #33;

     |SI #900#20 ! 0; nC1 = 20; nC2 = 75; nC3 = 42; nC4 = 30; nC5 = 85;  |HAZ GH_6;  |FINSI;
     |SI #900#21 ! 0; nC1 = 21; nC2 = 76; nC3 = 43; nC4 = 31; nC5 = 86;  |HAZ GH_6;  |FINSI;
     |SI #900#22 ! 0; nC1 = 22; nC2 = 77; nC3 = 44; nC4 = 32; nC5 = 87;  |HAZ GH_6;  |FINSI;
     |SI #900#23 ! 0; nC1 = 23; nC2 = 78; nC3 = 45; nC4 = 33; nC5 = 88;  |HAZ GH_6;  |FINSI;
     |SI #900#24 ! 0; nC1 = 24; nC2 = 79; nC3 = 46; nC4 = 34; nC5 = 89;  |HAZ GH_6;  |FINSI;
     |SI #900#25 ! 0; nC1 = 25; nC2 = 80; nC3 = 47; nC4 = 35; nC5 = 90;  |HAZ GH_6;  |FINSI;
     |SI #900#26 ! 0; nC1 = 26; nC2 = 81; nC3 = 48; nC4 = 36; nC5 = 91;  |HAZ GH_6;  |FINSI;
     |SI #900#27 ! 0; nC1 = 27; nC2 = 82; nC3 = 49; nC4 = 37; nC5 = 92;  |HAZ GH_6;  |FINSI;
     |SI #900#28 ! 0; nC1 = 28; nC2 = 83; nC3 = 50; nC4 = 38; nC5 = 93;  |HAZ GH_6;  |FINSI;
     |SI #900#29 ! 0; nC1 = 29; nC2 = 84; nC3 = 51; nC4 = 39; nC5 = 94;  |HAZ GH_6;  |FINSI;

     |SI #900#95  ! 0; nC1 = 95;  nC2 = 52; nC3 = 62; nC4 = 105; |HAZ GA_6;  |FINSI;
     |SI #900#96  ! 0; nC1 = 96;  nC2 = 53; nC3 = 63; nC4 = 106; |HAZ GA_6;  |FINSI;
     |SI #900#97  ! 0; nC1 = 97;  nC2 = 54; nC3 = 64; nC4 = 107; |HAZ GA_6;  |FINSI;
     |SI #900#98  ! 0; nC1 = 98;  nC2 = 55; nC3 = 65; nC4 = 108; |HAZ GA_6;  |FINSI;
     |SI #900#99  ! 0; nC1 = 99;  nC2 = 56; nC3 = 66; nC4 = 109; |HAZ GA_6;  |FINSI;
     |SI #900#100 ! 0; nC1 = 100; nC2 = 57; nC3 = 67; nC4 = 110; |HAZ GA_6;  |FINSI;
     |SI #900#101 ! 0; nC1 = 101; nC2 = 58; nC3 = 68; nC4 = 111; |HAZ GA_6;  |FINSI;
     |SI #900#102 ! 0; nC1 = 102; nC2 = 59; nC3 = 69; nC4 = 112; |HAZ GA_6;  |FINSI;
     |SI #900#103 ! 0; nC1 = 103; nC2 = 60; nC3 = 70; nC4 = 113; |HAZ GA_6;  |FINSI;
     |SI #900#104 ! 0; nC1 = 104; nC2 = 61; nC3 = 71; nC4 = 114; |HAZ GA_6;  |FINSI;

     aAlfa   = #900#4;  |QBF aAlfa;
     |SI aAlfa ! "";
         |HAZ DatosConyuge_6;
     |FINSI;

     |HAZ DatosTitular_6;

     |CIERRA #33;
|FPRC;

|PROCESO nomir006R;
     #3#0  = #900#0;
     #3#40 = #900#40;
     #3#41 = 1;
     |LEE 040#3];
     |SI FSalida = 0; |Y #3#0 = #900#0; |Y #3#40 = #900#40;
         |ACABA;
     |FINSI;

     |SELECT #2#100;
     #100#7 = #900#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     #712#0 = #900#0;
     |LEE 101#712=;
     |SI FSalida ! 0;
         |DDEFECTO #712;
         #712#0 = #900#0;
         #712#1 = #100#2;
         #712#4 = #100#8;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
         |GRABA 020#712b;
      |FINSI;

     |SI #0#3 = 1;
         #712#1  = #100#2;
         #712#2  = #100#3;
         #712#3  = #100#4;
         #712#10 = #100#5;
         #712#4  = #100#8;
         #712#5  = #100#9;
         #712#6  = #100#6;
         #712#7  = #100#10;
         #712#8  = #100#244;
     |FINSI;

     |GRABA 020#712a;
     |LIBERA #712;

     |SI #0#3 = 3;
         |ABRE #33;
         #33#0 = #900#0;
         #33#1 = 1;
         |LEE 040#33];
         |SI FSalida ! 0;  |O #33#0 ! #900#0;
             |CIERRA #33;
             |HAZ DatosPersonales_6;
         |SINO;
             |CIERRA #33;
         |FINSI;
     |SINO;
         |HAZ DatosPersonales_6;
     |FINSI;
|FPRC;

|DEFBUCLE nomir006R;
     #900#1002;
     ;
     "            ", #0#2;
     "zzzzzzzzzzzz", #0#2;
     be;
     NULL, nomir006R;
|FIN;

|| -------------------------------------------------------------------

|PROCESO Pase;
     |SI #0#3 ! 0;
         |HAZ BuscaAnterior;

         |ABRE #1;
         |ABRE #100;
         |ABRE #712;

         |BUCLE nomir003R;
         |SI nSwAnterior = 1;
             |ABRE #3;
             |BUCLE nomir006R;
             |CIERRA #3;
         |FINSI;
         |CIERRA #1;
         |CIERRA #100;
         |CIERRA #712;
    |FINSI;

    |SI #0#1 ! 0;   |BUCLE labtraba;   |FINSI;

    |SI aDef00 ! "";  |DESCARGA_DEF #refer00@;  |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>     ";
     |Y  aPassword ! "<MYPASWD>               ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     |HAZ Pase;
|FPRC;

|PROGRAMA;
    |SI PARAMETRO = "";
        |MANTE #0;
    |SINO;
        aDef00 = "";
        fFecha = ~;
        aAlfa  = fFecha % -104;
        #0#3   = 1;
        #0#2   = aAlfa;
        #0#1   = 0;
        |HAZ Pase;

        aDef00 = "";
        #0#3   = 0;
        #0#2   = 0;
        #0#1   = 1;
        |HAZ Pase;
    |FINSI;
|FPRO;
