|FICHEROS;
     nombone2 #0;

     nomtmp07 #10,MANTE;
     labempre;
     labtraba;
     nomhicca;
     nomatcon;
|FIN;

|VARIABLES;
   aAlfa  = "";
   aAlfa1 = "";
   nCambiados = 0;
   nCalc  = 0;
   nOpcion = 0;
   nNumTrab = 0;

{-1}Menu  = "";
    Menu1 = "2400";
    Menu2 = "1";
    Menu3 = "";
    Menu4 = "RAC";
    Menu5 = " Revisar ";
    Menu6 = " Actualizar ";
    Menu7 = " Cancelar ";

     nMes = 0;
     nAny = 0;
     swSal = 0;
     nNume = 0;
     nDesdeMes = 0;
     nDesdeAny = 0;
     nHastaMes = 0;
     nHastaAny = 0;
     nCuota = 0;
|FIN;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|DEFBUCLE nomtmp07;
     #nomtmp07#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Imprime;
|FIN;

|PROCESO Trabajadores;
     |DDEFECTO #nomtmp07;
     #nomtmp07#0 = #nomhicca#0;
     #nomtmp07#1 = #nomhicca#1;
     #nomtmp07#2 = #nomhicca#66 + 2000;
     #nomtmp07#3 = #nomhicca#2;

     #labempre#0 = #nomhicca#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomhicca#0;
     #labtraba#1 = #nomhicca#1;
     |LEE 000#labtraba.=;

     #nomtmp07#4 = #labempre#2;
     #nomtmp07#5 = #labtraba#2;

     #nomtmp07#6 = #nomhicca#119;                      || dias en ERE
     #nomtmp07#7 = #nomhicca#119 * #labtraba#242;      || base ERE

     #nomatcon#77 = #nomhicca#0;
     #nomatcon#78 = #nomhicca#1;
     #nomatcon#79 = #nomhicca#2;
     nNume = #nomhicca#66 + 2000;
     aAlfa = nNume;
     #nomatcon#80 = aAlfa;
     |LEE 000#nomatcon.=;

     nCuota = ((#nomtmp07#7 % #nomatcon#6) % 50);
     |SI nCuota > #nomhicca#45;
          nCuota = #nomhicca#45;
          #nomtmp07#11 = 1;                            || bonif. limitada
     |FINSI;
     #nomtmp07#8 = nCuota;                             || cuota bonif

     #nomtmp07#9 = #labtraba#7;                        || NIF
     #nomtmp07#10 = #labtraba#75;                      || NAFSS

     |GRABA 020#nomtmp07.n;
|FPRC;

|DEFBUCLE Trabajadores;
     #nomhicca#1;
     119, 167;      || dias ERE, bonif. ERE
     #0#0, #0#2, nDesdeAny, nDesdeMes, 0, 0.5, 0;
     #0#1, #0#3, nHastaAny, nHastaMes, 0, 99,  0;
     ;
     NULL, Trabajadores;
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA " ";

     |PINPA #0#0; |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          aAlfa = "04" + Usuario; |NOME_DAT #nomtmp07#aAlfa#;
          |DELINDEX #nomtmp07;
          |ABRE #nomtmp07;
          |ABRE #nomatcon;
          |ABRE #nomhicca;
          |ABRE #labempre;
          |ABRE #labtraba;

          nNumTrab = 0;

          |SI #0#6 = #0#8;
               nDesdeMes = #0#5;
               nDesdeAny = #0#6 - 2000;
               nHastaMes = #0#7;
               nHastaAny = #0#8 - 2000;
               |BUCLE Trabajadores;
          |SINO;
               nDesdeMes = #0#5;
               nHastaMes = 12;
               nDesdeAny = #0#6 - 2000;
               nHastaAny = #0#6 - 2000;
               |BUCLE Trabajadores;

               nNume = #0#8 - #0#6;
               |SI nNume > 1;
                    nDesdeMes = 1;
                    nHastaMes = 12;
                    nDesdeAny = #0#6 + 1 - 2000;
                    nHastaAny = #0#8 - 1 - 2000;
                    |BUCLE Trabajadores;
               |FINSI;

               nDesdeMes = 1;
               nHastaMes = #0#7;
               nDesdeAny = #0#8 - 2000;
               nHastaAny = #0#8 - 2000;
               |BUCLE Trabajadores;
          |FINSI;

          |CIERRA #labtraba;
          |CIERRA #labempre;
          |CIERRA #nomhicca;
          |CIERRA #nomatcon;

          Impresora = "CrystalReport";
          |IMPRE -1;
          |INFOR "nombone2";
          |BUCLE nomtmp07;
          |PIEINF;
          |FININF;
          |FINIMP;

          |CIERRA #nomtmp07;
          |DELINDEX #nomtmp07;
     |FINSI;
|FPRO;
