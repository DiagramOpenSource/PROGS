|FICHEROS;
     nomcalfi #0;
     gomcot12;
     labtraba;
     nomconli;
     nombonif;
     nomepigr;
     nombonif;
     nomconst;
     nomcalca;
     nomcalcc;
     nomvarca;
     nomvarli;
     nomhicca;
     nomcontr;
|FIN;

|VARIABLES;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     &fCFechaCot = @;
     &aCErrorCot = "";

     aAlfa = "";
     &swMensual = 0;
     &base_5 = 0;
     &acum_10 = 0;
     &dvalo_pro = 0;
     &base_A = 0; &zbase_A = 0;
     &base_B = 0; &zbase_B = 0;
     &base_C = 0; &zbase_C = 0;
     &base_D = 0;
     &base_E = 0;
     &base_F = 0; &zbase_F = 0;
     &base_M = 0;
     &bbase_A = 0;
     &bbase_B = 0;
     &bbase_C = 0;
     &basemat_B = 0;
     &base_6 = 0;
     &base_7 = 0;
     &base_8 = 0;
     &base_77 = 0;
     &base_11 = 0;
     &dacum_30 = 0;
     &dacum_31 = 0;
     &por1_cont = 0;
     &por1_dfpg = 0;
     &por1_hor1 = 0;
     &por1_hor2 = 0;
     &por2_hor1 = 0;
     &por2_hor2 = 0;
     &dcont_2 = 0;
     &prom_enf = 0;
     &prom_acc = 0;
     &coba_1 = 0;
     &cobb_2 = 0;
     &coba_3 = 0;
     &coba_4 = 0;
     &cobb_4 = 0;
     nTopeMaxMen = 0;
     nTopeMaxJor = 0;
     nume1 = 0;
     nume2 = 0;
     nNume1 = 0;
     nNume2 = 0;
     &denfe_2 = 0;
     &dacci_2 = 0;
     &dmate_2 = 0;
     &dabse_2 = 0;
     &swAjuste3 = 0;
     &dcoti_0 = 0;
     &fijo_1 = 0;
     &fijo_1_red = 0;
     &jornadasIT = 0;
     &nReduccion = 0;
     &por2_cont = 0;
     nLimiteAltaMens = 0;
     nLimiteAltaJor = 0;
     nLimiteJor = 0;
     swTabla = 0;
     swFormula = 0;
     &swJornadas = 0;
     &nBasePorJornada = 0;
     &nBasePorJornada_red = 0;
     nGrupo = 0;
     nPar1 = 0;
     nPar2 = 0;
     nDiasCotIT = 0;
     &basemat_C = 0;

     &dboni_1 = 0;
     &horasex = 0;
     &por2_dfpg = 0;
     &sw_tope = 0;
     &nBaseATEP = 0;
     &nATEP_Alta = 0;
     &base_9 = 0;
     &epig_ilt = 0;
     &epig_ims = 0;
     &pilt_enf = 0;
     &pilt_ATEP = 0;
     &nATEP_IT = 0;
     &nPorBon1 = 0;
     &nPorBon2 = 0;
     &bon_0 = 0;
     &bon_3 = 0;
     &zbase_9 = 0;
     &jornadasEA = 0;
     &bbon_0 = 0;
     &bbon_3 = 0;
     &bbon_5 = 0;
     &dboni_2 = 0;
     &zbon_0 = 0;
     &zbon_3 = 0;
     &zbon_5 = 0;
     &bbase_F = 0;
     &cbon_3 = 0;
     &nBonifFCI = 0;
     &bon_59 = 0;
     &bon_60 = 0;
     &denfe_A = 0;
     &denfe_B = 0;
     &denfe_C = 0;
     &denfe_D = 0;
     &nDiasPagoSS = 0;
     &nBasePagoSS_CC = 0;
     &nBasePagoSS_CP = 0;
     &nJornPagoSS = 0;
     &nDiasPagoSS_SinMat = 0;
     &nJornPagoSS_SinMat = 0;
     &nBasePagoSS_CC_SinMat = 0;
     &nBasePagoSS_CP_SinMat = 0;
     &guarda = 0;
     &prom_ac2 = 0;
     &nBase = 0;
     &swBaseFija = 0;
     &lin_1 = 0;
     &lin_2 = 0;
     &dto_con = 0;
     &dto_dfp = 0;
     &dto_ho1 = 0;
     &dto_ho2 = 0;
     &dilt = 0;
     &bon_1 = 0;
     &bon_2 = 0;
     &bon_5 = 0;
     nTopeMin = 0;
     nCampo = 0;
     FEstado = 0;
     aTopeadaCC = "";
     aTopeadaCP = "";
     nTipoInicialCC = 0;
     aTipoReduccion = 0;

     &nBaseAlta = 0;
     &nBaseIT = 0;

     nRedCC_Alta = 0;
     nRedCC_IT = 0;
     nRedDes_Alta = 0;
     nRedDes_IT = 0;

     &nImporteRedCC_Alta = 0;
     &nImporteRedCC_IT = 0;
     &nImporteRedDes_Alta = 0;
     &nImporteRedDes_IT = 0;

     por2_cont_alta = 0;
     por2_des_alta = 0;

     nCuotaCC_Alta = 0;
     nCuotaCC_IT = 0;
     nCuotaDes_Alta = 0;
     nCuotaDes_IT = 0;
     nCuotaFPFog = 0;

     nTipoInicialCC_Alta = 0;
     nTipoInicialCC_IT = 0;
     nTipoInicialDes = 0;
     nBaseAltaDia = 0;
     nDiasAlta = 0;

     dias_tope = 0;
     nMax_cp = 0;
     nMin_cp = 0;
     &grupo = 0;
     &propo = 0;
     nRed_CC = 0;

     &denfe_cot = 0;
     &dacci_cot = 0;
     &dmate_cot = 0;
     &nRedCCEnf = 0;
     &nRedDesEnf = 0;
     &nRedCCMat = 0;
     &nRedDesMat = 0;
     &nRedCCAcc = 0;
     &nRedDesAcc = 0;
     &nRedCCEnfEmp = 0;
     &nRedDesEnfEmp = 0;
     &nBaseITDiaJorCC = 0;
     &nBaseITDiaJorDes = 0;
     swPrevio = 0;
     &prom_enf_previo = 0;
     &prom_acc_previo = 0;
     &dcobr_0 = 0;
     nDiasEnfPagoDir = 0;
     nNume = 0;
     nJornadasEnf = 0;
     nJornadasAcc = 0;
     nJornadasMat = 0;
     swHay93X = 0;
     nConcepto = 0;
     nDesdeAny = 0;
     nHastaAny = 0;
     aNif = "";
     &nDesem = 0;
     &nJornadasERE = 0;
     &ddese_2 = 0;
     &nBonifERE = 0;
     nDtoCCTra = 0;
     nDtoCPTra = 0;
     aModulo = "";
     jornadasIT_red = 0;
     nBaseIT_red = 0;

     nBaseATEP_red = 0;
     nATEP_IT_red = 0;
     nDifJor = 0;

     nLimite = 0;
     &nElAny = 0;
     nDifCC = 0;
     nDifCP = 0;

     nCuotaCCAlta = 0;
     nLimMenG1 = 0;
     nLimMenResto = 0;

     &nJorITCotEmp = 0;
     &nJorITCotEmpTra = 0;
     &n400Cot = 0;

     &dto_sol_emp = 0;
     &dto_sol_tra = 0;
     &aDesIncid = "";
     nPropBon = 0;

     ddese_cot = 0;
     &aUltimaIT = "";
|FIN;

|PROCESO GrabaCotiz;
     |MODULO aModulo; |QBF aModulo;
     |SI aModulo = "gomcalc1";
          |ACABA;
     |FINSI;

     |ABRE #nomcalcc;
     #nomcalcc#0 = #nomcalca#0;
     #nomcalcc#1 = #nomcalca#1;
     #nomcalcc#2 = #0#9;
     #nomcalcc#3 = #0#8;
     #nomcalcc#4 = 2;
     |LEE 101#nomcalcc.=;
     |SI FSalida = 0;
          |BORRA 020#nomcalcc.a;
     |FINSI;
     |DDEFECTO #nomcalcc;

     #nomcalcc#0 = #nomcalca#0;
     #nomcalcc#1 = #nomcalca#1;
     #nomcalcc#2 = #0#9;
     #nomcalcc#3 = #0#8;
     #nomcalcc#4 = #nomcalca#3;
     #nomcalcc#5 = #nomcalca#37;             || remuneracion
     #nomcalcc#6 = #nomcalca#38;             || prorrata
     #nomcalcc#7 = #nomcalca#37 + #nomcalca#38;   || remun + prorr
     #nomcalcc#8 = aTopeadaCC;
     #nomcalcc#57 = aTopeadaCP;
     #nomcalcc#50 = #labtraba#42;
     |SI swMensual = 1;
          #nomcalcc#9 =  (#0#32 + 0.49) ! 0;
          |SI dcoti_0 ] 30; |Y nDiasCotIT = 0;
               #nomcalcc#17 = nLimiteAltaMens;
               #nomcalcc#48 = base_6;
               #nomcalcc#49 = base_6;
          |SINO;
               #nomcalcc#17 = nLimiteAltaMens;
               #nomcalcc#48 = nBaseAltaDia;
               #nomcalcc#49 = nBaseAltaDia;
          |FINSI;
          #nomcalcc#12 = nBaseAltaDia;
          #nomcalcc#51 = nDiasAlta;
          #nomcalcc#52 = nDiasCotIT + ddese_2;
     |SINO;
          #nomcalcc#9 = fijo_1 + jornadasIT;
          #nomcalcc#12 = nBasePorJornada;
          #nomcalcc#17 = nLimiteAltaJor;
          || #nomcalcc#48 = nBasePorJornada;
          || #nomcalcc#49 = nBasePorJornada;
          #nomcalcc#48 = nBasePorJornada_red;
          #nomcalcc#49 = nBasePorJornada_red;
          #nomcalcc#51 = fijo_1_red;
          #nomcalcc#52 = jornadasIT;
     |FINSI;

     #nomcalcc#10 = #nomcalca#39;             || base cc
     #nomcalcc#11 = #nomcalca#40;            || base cp
     #nomcalcc#15 = nReduccion;
     |SI #labtraba#33 = 01;
          #nomcalcc#14 = "fija";
     |SINO;
          |SI swTabla = 1;
               #nomcalcc#14 = "tabla";
          |FINSI;
          |SI swFormula = 1;
               #nomcalcc#14 = "f¢rmula";
          |FINSI;
     |FINSI;

     #nomcalcc#18 = 2.52;
     #nomcalcc#19 = 6.15;

     #nomcalcc#16 = por2_cont;
     #nomcalcc#20 = base_6 % #nomcalcc#16;   || cuota comunes
     #nomcalcc#21 = #nomconst#12;            || % desempleo
     #nomcalcc#22 = base_7 % #nomcalcc#21;   || cuota desempleo

     #nomcalcc#23 = #nomconst#14;            || % fogasa
     #nomcalcc#24 = (nATEP_Alta + nATEP_IT) % #nomcalcc#23;   || cuota fogasa
     #nomcalcc#25 = #nomconst#16;            || % FP
     #nomcalcc#26 = (nATEP_Alta + nATEP_IT) % #nomcalcc#25;   || cuota FP

     #nomcalcc#27 = epig_ilt;
     #nomcalcc#28 = ((nATEP_Alta % epig_ilt) ! 2) + ((nATEP_IT % epig_ilt) ! 2);
     #nomcalcc#29 = epig_ims;
     #nomcalcc#30 = ((nATEP_Alta % epig_ims) ! 2) + ((nATEP_IT % epig_ims) ! 2);

     #nomcalcc#32 = nBaseAlta;
     #nomcalcc#13 = por2_cont;
     #nomcalcc#20 = nCuotaCC_Alta;
     #nomcalcc#15 = nRedCC_Alta;
     #nomcalcc#42 = nImporteRedCC_Alta;
     #nomcalcc#45 = nCuotaCC_Alta - nImporteRedCC_Alta;
     #nomcalcc#21 = por2_des_alta;
     #nomcalcc#22 = nCuotaDes_Alta

     #nomcalcc#33 = nBaseIT;
     #nomcalcc#34 = por2_cont;
     #nomcalcc#39 = nCuotaCC_IT;
     #nomcalcc#36 = nRedCC_IT;
     #nomcalcc#43 = nImporteRedCC_IT;
     #nomcalcc#46 = nCuotaCC_IT - nImporteRedCC_IT;
     #nomcalcc#40 = por2_des_alta;
     #nomcalcc#41 = nCuotaDes_IT;
     #nomcalcc#37 = nRedDes_IT;
     #nomcalcc#44 = nImporteRedDes_IT
     #nomcalcc#47 = nCuotaDes_IT - nImporteRedDes_IT

     ||HAZ DesgloseDias;

     #nomcalcc#53 = nATEP_Alta;
     #nomcalcc#54 = nATEP_IT;

     || SS EMPRESA INICIAL:
     #nomcalcc#31 = #nomcalcc#45 + #nomcalcc#22;
     #nomcalcc#31 = #nomcalcc#31 + #nomcalcc#46 + #nomcalcc#47;
     #nomcalcc#31 = #nomcalcc#31 + #nomcalcc#24 + #nomcalcc#26;
     #nomcalcc#31 = #nomcalcc#31 + #nomcalcc#28 + #nomcalcc#30;

     || BONIFICACIONES
     #nomcalcc#55 = #nomcalca#63 + #nomcalca#81 + #nomcalca#64 + #nomcalca#101;
     #nomcalcc#55 = #nomcalcc#55 + #nomcalca#106 + #nomcalca#88 + #nomcalca#96;
     #nomcalcc#55 = #nomcalcc#55 + #nomcalca#133 + #nomcalca#102 + #nomcalca#125;

     || SS TOTAL EMP - BONIFICACIONES
     #nomcalcc#56 = #nomcalcc#31 - #nomcalcc#55;

     |GRABA 020#nomcalcc.n;

     |LIBERA #nomcalcc;
     |CIERRA #nomcalcc;
|FPRC;

|PROCESO LeeTopesReduc;       || proceso para leer los topes y reducciones de
                              || contingencias comunes

     alfa1 = "01";
     alfa2 = #0#8;  alfa2 = "00" + alfa2;    alfa2 = alfa2 % -102;
     alfa3 = #0#9;
     alfa4 = alfa1 + "." + alfa2 + "." + alfa3;

     |MODULO aModulo; |QBF aModulo;
     fCFechaCot = alfa4;         || primer dia de mes de calculo
     aCErrorCot = "";            || inicializo errores
     |HAZ LeeRedMaxAgr;
     |SI aCErrorCot ! ""; |Y aModulo ! "gomcalc1";
          |MENAV aCErrorCot;
     |FINSI;
|FPRC;

|PROCESO reducciones12;
     || reducciones al tipo de cotizacion que se aplica para hallar la
     || cuota empresarial segun normativa del 2012

     || por2_cont es el % que teniamos, aplicamos reduccion

     nReduccion = 0;
     swTabla = 0;
     swFormula = 0;
     nLimiteAltaMens = 0;
     nLimiteAltaJor = 0;
     || nDiasCotIT = (denfe_2 + dacci_2 + dmate_2) - swAjuste3;
     || nDiasAlta = dcoti_0 - nDiasCotIT;
     || nBaseAltaDia = nBaseAlta / nDiasAlta;
     nBaseAlta = #0#75;
     nBaseATEP = #0#93;
     nATEP_Alta = #0#93;
     nDiasCotIT = 0;
     nDiasAlta =  (#0#32 + 0.49) ! 0;
     dcoti_0 =  (#0#32 + 0.49) ! 0;
     nBaseAltaDia = nBaseAlta / nDiasAlta;
     nBasePorJornada_red = nBaseAltaDia;

     |HAZ LeeTopesReduc;

     |SI #labtraba#33 = 01;
          || para el grupo 01, de moemento a pelo
          por2_cont = 23.60;
          nTipoInicialCC = por2_cont;
          nReduccion = #gomcot12#1;
     |FINSI;
     |SI #labtraba#42 = "A";
          swMensual = 1;
     |FINSI;
     |SI #labtraba#42 = "E";
          swJornadas = 1;
     |FINSI;
     |SI #labtraba#33 ] 02;
          |SI nDesem > 0;
               nBaseAlta = nBaseAlta + nDesem;
               nBaseAltaDia = nBaseAlta / (nDiasAlta + ddese_2);
          |FINSI;

          |SI swMensual = 1;
               || limite para trabajadores mensuales para saber si aplico
               || la tabla o la formula basa en la tabla tambien
               |SI dcoti_0 ] 30; |Y nDiasCotIT = 0;
                    nLimiteAltaMens = #gomcot12#12;
                    |SI nBaseAlta [ nLimiteAltaMens;
                         swTabla = 1;
                    |SINO;
                         swFormula = 1;
                    |FINSI;
               |SINO;
                    nLimiteAltaMens = #gomcot12#12 / 30;
                    |SI nBaseAltaDia [ nLimiteAltaMens;
                         swTabla = 1;
                    |SINO;
                         swFormula = 1;
                    |FINSI;
               |FINSI;
          |FINSI;

          |SI swJornadas = 1;
               nLimiteAltaJor = #gomcot12#13;
               || SI nBasePorJornada [ nLimiteAltaJor;
               |SI nBasePorJornada_red [ nLimiteAltaJor;
                    swTabla = 1;
               |SINO;
                    swFormula = 1;
               |FINSI;
          |FINSI;

          nGrupo = #labtraba#33;
          |SI swTabla = 1;
               nReduccion = #gomcot12#nGrupo#;
          |FINSI;
          |SI swFormula = 1;
               |SI swMensual = 1;
                    |SI dcoti_0 ] 30; |Y nDiasCotIT = 0;
                         nPar1 = (nBaseAlta - nLimiteAltaMens) / base_6;
                    |SINO;
                         nPar1 = (nBaseAltaDia - nLimiteAltaMens) / nBaseAltaDia;
                    |FINSI;
                    nPar2 = 6.15 / #gomcot12#nGrupo#;
                    nReduccion = #gomcot12#nGrupo# * (1 + (nPar1 * 2.52 * nPar2));
                    nReduccion = nReduccion ! 2;
               |FINSI;
               |SI swJornadas = 1;
                    || nPar1 = (nBasePorJornada - nLimiteAltaJor) / nBasePorJornada;
                    nPar1 = (nBasePorJornada_red - nLimiteAltaJor) / nBasePorJornada_red;
                    nPar2 = 6.15 / #gomcot12#nGrupo#;
                    nReduccion = #gomcot12#nGrupo# * (1 + (nPar1 * 2.52 * nPar2));
                    nReduccion = nReduccion ! 2;
               |FINSI;
          |FINSI;
          |SI nDesem > 0;
               nBaseAlta = nBaseAlta - nDesem;
               || para que se guarde la correcta
          |FINSI;
     |FINSI;

     || paso a variables finales

     nRedCC_Alta = nReduccion;
     nGrupo = #labtraba#33;
     nCampo = nGrupo + 15;
     nRedCC_IT = #gomcot12#nCampo#;
     |SI nDesem > 0;
          nRedCC_IT = nReduccion;
     |FINSI;
     nRedDes_Alta = 0;
     |SI #nomconst#12 = 0;
          nRedDes_IT = 0;
     |SINO;
          nRedDes_IT = #gomcot12#27;
     |FINSI;
|FPRC;

|PROCESO calssemp12_1;    || CALCULA S.S. A CGO. EMPRESA
     base_A = 0;  base_B = 0;  base_C = 0;  base_F = 0;
     bbase_A = 0;  bbase_B = 0;  bbase_C = 0;  base_M = 0;
     basemat_B = 0;  basemat_C = 0;
     base_D = 0;  base_E = 0;
     zbase_A = 0; zbase_B = 0; zbase_C = 0; zbase_F = 0;

     || la base_77 para el 2012 sera la misma que la de profesionales
     || base_77 = base_7;

     || pues de momento, segun la SS no sera asi
     || base_77 = acum_10 + coba_3 + dvalo_pro;  || base cont.profesionales

     || me viene calculada y topeada del calcotiz en nATEP_Alta y nATEP_IT

     base_11 = 0;

     nTipoInicialCC = 0;
     aTipoReduccion = 0;

     nImporteRedCC_Alta = 0;
     nImporteRedCC_IT = 0;
     nImporteRedDes_Alta = 0;
     nImporteRedDes_IT = 0;

     base_8 = (dacum_30 % por2_hor1) + (dacum_31 % por2_hor2); || h.ext.
     base_11 = dcont_2 * prom_enf;

     |SI #labtraba#39 ! 0; |Y dboni_1 ! 0; |Y #nombonif#11 = "S";
          base_D = horasex * #nombonif#12;      || cuota (2) bonif. horas formacion
     |FINSI;

     nTipoInicialCC_Alta = por2_cont;
     nTipoInicialCC_IT = por2_cont;
     nTipoInicialDes = #nomconst#12;

     |HAZ reducciones12;

     nImporteRedCC_Alta = (nBaseAlta % nRedCC_Alta) ! 2;
     || nImporteRedCC_IT = (nBaseIT % nRedCC_IT) ! 2;
     nImporteRedCC_IT = (nBaseIT_red % nRedCC_IT) ! 2;
     nImporteRedDes_Alta = 0;
     nImporteRedDes_IT = (nATEP_IT_red % nRedDes_IT) ! 2;
     || nImporteRedDes_IT = (nATEP_IT % nRedDes_IT) ! 2;

     por2_cont_alta = por2_cont - nRedCC_Alta;
     por2_des_alta = nTipoInicialDes;

     |SI #nombonif#10 = 4;
          por2_des_alta = 0;
          #nomconst#12 = 0;
          #nomconst#14 = 0;
          #nomconst#16 = 0;
     |FINSI;

     |SI nElAny ] 2013;
          |SI nElAny = 2013;
               nLimMenG1 = (279 * dcoti_0) / 30;
               |SI nDiasAlta ] 30;
                    nLimMenResto = 55.21;
               |SINO;
                    nLimMenResto = (1.84 * nDiasAlta);
               |FINSI;
          |FINSI;
          |SI nElAny = 2014;
               nLimMenG1 = (279 * dcoti_0) / 30;
               |SI nDiasAlta ] 30;
                    nLimMenResto = 60.25;
               |SINO;
                    nLimMenResto = (2.01 * nDiasAlta);
               |FINSI;
          |FINSI;
          |SI nElAny ] 2015;
               nLimMenG1 = (279 * dcoti_0) / 30;
               |SI nDiasAlta ] 30;
                    nLimMenResto = 65.11;
               |SINO;
                    nLimMenResto = (2.17 * nDiasAlta);
               |FINSI;
          |FINSI;

          |SI grupo = 1;
               |SI swMensual = 1;
                    nCuotaCCAlta = (nBaseAlta % por2_cont) ! 2;
                    nNume = nCuotaCCAlta - nImporteRedCC_Alta;
                    |SI nNume > nLimMenG1;
                         nImporteRedCC_Alta = nImporteRedCC_Alta + (nNume - nLimMenG1);
                    |FINSI;
               |FINSI;
               |SI swJornadas = 1;
                    nCuotaCCAlta = (nBaseAlta % por2_cont) ! 2;
                    nNume1 = nCuotaCCAlta - nImporteRedCC_Alta;
                    |SI fijo_1_red ] 23;
                         nNume2 = 279;
                    |SINO;
                         nNume2 = 12.13 * fijo_1_red;
                    |FINSI;
                    |SI nNume1 > nNume2;
                         nImporteRedCC_Alta = nImporteRedCC_Alta + (nNume1 - nNume2);
                    |FINSI;
               |FINSI;
          |SINO;
               |SI swMensual = 1;
                    nCuotaCCAlta = (nBaseAlta % por2_cont) ! 2;
                    nNume = nCuotaCCAlta - nImporteRedCC_Alta;
                    |SI nNume < nLimMenResto;
                         nImporteRedCC_Alta = nImporteRedCC_Alta - (nLimMenResto - nNume);
                    |FINSI;
               |FINSI;
               |SI swJornadas = 1;
                    nCuotaCCAlta = (nBaseAlta % por2_cont) ! 2;
                    nNume1 = nCuotaCCAlta - nImporteRedCC_Alta;
                    |SI nElAny = 2013;
                         nNume2 = 2.40 * fijo_1_red;
                    |FINSI;
                    |SI nElAny = 2014;
                         nNume2 = 2.62 * fijo_1_red;
                    |FINSI;
                    |SI nElAny ] 2015;
                         nNume2 = 2.83 * fijo_1_red;
                    |FINSI;
                    |SI nNume1 < nNume2;
                         nImporteRedCC_Alta = nImporteRedCC_Alta - (nNume2 - nNume1);
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO calssemp12_2;    || CALCULA S.S. A CGO. EMPRESA
     nCuotaCC_Alta = (nBaseAlta % por2_cont) ! 2;
     nCuotaCC_IT = (nBaseIT % por2_cont) ! 2;

     || nCuotaDes_Alta = (nBaseAlta % por2_des_alta) ! 2;
     || nCuotaDes_IT = (nBaseIT % por2_des_alta) ! 2;

     nCuotaDes_Alta = (nATEP_Alta % por2_des_alta) ! 2;
     nCuotaDes_IT = (nATEP_IT % por2_des_alta) ! 2;

     nCuotaFPFog = (nATEP_Alta + nATEP_IT) % (#nomconst#14 + #nomconst#16);
     nCuotaFPFog = nCuotaFPFog ! 2;
/*
     nCuotaCC_Alta = nCuotaCC_Alta - nImporteRedCC_Alta;
     nCuotaCC_IT = nCuotaCC_IT - nImporteRedCC_IT;
     nCuotaDes_IT = nCuotaDes_IT - nImporteRedDes_IT;
*/

     base_8 = (nCuotaCC_Alta - nImporteRedCC_Alta);
     base_8 = base_8 + (nCuotaCC_IT - nImporteRedCC_IT);
     base_8 = base_8 + nCuotaDes_Alta;
     base_8 = base_8 + (nCuotaDes_IT - nImporteRedDes_IT);
     base_8 = base_8 + nCuotaFPFog;

     || bueno, a ver lo de topear la base de ATEP no me cuadra aqui, se supone
     || que haremos como en el regimen general y por ATEP se cotizara por la
     || misma base que la de profesionales

     || TAMBIEN, porque en los seguros sociales lo hacemos asi, hay que
     || hacerlo igual
     base_9 = (nATEP_Alta % epig_ilt) ! 2;
     base_9 = base_9 + (nATEP_Alta % epig_ims) ! 2;

     || parte en IT

     base_9 = base_9 + ((nATEP_IT % epig_ilt) ! 2);
     base_9 = base_9 + ((nATEP_IT % epig_ims) ! 2);
               || bonificacion sobre base jornadas reales en alta
     |SI #labtraba#39 ! 0; |Y dboni_1 ! 0; |Y nPorBon1 ! 0; |Y #nombonif#10 ! 4;
          || base_A = ((bon_0 % #nombonif#4) ! 2) % nPorBon1; || cuota bonif. linea 1
          || cuota bonif. linea 1:
          nNume1 = (bon_0 % #nombonif#4) ! 2;
          nNume2 = (nImporteRedCC_Alta + nImporteRedCC_IT) * nPropBon;
          base_A = nNume1 - nNume2;
          base_A = base_A % nPorBon1;
          base_A = base_A ! 2;

          || base_B = ((bon_3 % #nombonif#5) ! 2) % nPorBon1; || cuota bonif. linea 2
          || cuota bonif. linea 2:

          || si bonifico sobre todas las cont. profesionales, separo la bonif.
          || de desempleo de la de FP y FOGASA, para no reducir la base de estas
          |SI #nombonif#5 ! 0;
               nNume = #nomconst#12 + #nomconst#14 + #nomconst#16;
               |SI nNume = #nombonif#5;
                    base_B = (((bon_3 % #nomconst#12) ! 2) - (nImporteRedDes_IT * nPropBon)) % nPorBon1;
                    base_B = base_B + ((bon_3 % (#nomconst#14 + #nomconst#16) ! 2) % nPorBon1);
               |SINO;
                    || si no, todo junto
                    base_B = (((bon_3 % #nombonif#5) ! 2) - (nImporteRedDes_IT * nPropBon)) % nPorBon1;
               |FINSI;
          |FINSI;

          base_B = base_B ! 2;
          ||HAZ LimiteBonif12;
          |SI #nombonif#08 = "S";
               || zbase_9 = (acum_10 + coba_3) % (epig_ilt + epig_ims);
               zbase_9 = bon_3 % (epig_ilt + epig_ims);
               zbase_9 = zbase_9 ! 2;
               base_C = zbase_9 % nPorBon1;      || cuota bonificada accidentes
               base_C = base_C ! 2;
          |FINSI;
     |FINSI;

     || bonificacion sobre base jornadas teoricas en baja

     jornadasEA = jornadasIT;

     |SI #labtraba#39 ! 0; |Y dboni_2 ! 0; |Y nPorBon2 ! 0;
          zbase_A = ((zbon_0 % #nombonif#4)!2) % nPorBon2; || cuota bonif. linea 1
          zbase_A = zbase_A ! 2;
          zbase_B = ((zbon_3 % #nombonif#5)!2) % nPorBon2; || cuota bonif. linea 2
          zbase_B = zbase_B ! 2;
          |SI #nombonif#08 = "S";
               zbase_9 = ((zbon_3 - zbon_5) % epig_ilt) ! 2;
               zbase_9 = zbase_9 + (((zbon_3 - zbon_5) % epig_ims) ! 2);
               zbase_9 = zbase_9 + ((zbon_5 % epig_ilt) ! 2);
               zbase_9 = zbase_9 + ((zbon_5 % epig_ims) ! 2);
               zbase_9 = zbase_9 ! 2;
               zbase_C = zbase_9 % nPorBon2;     || cuota bonificada accidentes
               zbase_C = zbase_C ! 2;
          |FINSI;
     |FINSI;
     |SI #nombonif#10 = 4;
          nNume1 = (por2_cont - nReduccion);                || bonif empresa
          nNume1 = nNume1 - ((nNume1 % 6.20) ! 2);

          nNume1 = #nombonif#4;

          base_A = bon_0 % nNume1;
          base_A = base_A ! 2;

          nNume2 = ((bon_0 % por2_cont) ! 2);     || limite comunes
          nNume2 = nNume2 - base_A;
          |SI nImporteRedCC_Alta > nNume2;
               base_8 = base_8 + nImporteRedCC_Alta;
               nImporteRedCC_Alta = nNume2;
               base_8 = base_8 - nImporteRedCC_Alta;
          |FINSI;
     |FINSI;

     || empresa las cuotas de la bonificacion de la parte de baja y maternidad

     base_F = base_A + base_B + base_C;       || cuota (1) bonif. en alta
     bbase_F = bbase_A + bbase_B + bbase_C;   || cuota (1) bonif. en baja
     base_F = base_F + bbase_F + base_M;
     zbase_F = zbase_A + zbase_B + zbase_C;   || cuota (2) bonif.

     || S.Social cargo empresa:
     base_E = base_8 + base_9 + dto_sol_emp;
     base_E = base_E - (base_A + base_B + base_C);
     base_E = base_E - (zbase_A + zbase_B + zbase_C + base_D); ||SS emp.
     base_E = base_E - (bbase_A + bbase_B + bbase_C + base_M); || quito a la SS.cgo.
     base_E = base_E + cbon_3;     || a¤ado desempleo en baja

     |SI base_E < 0;
         base_E = 0;     || por si acaso sale negativa
     |FINSI;


     || base_E = base_E - nRedFija;
     || |SI base_E < 0;
     ||      nRedFija = nRedFija + base_E;
     ||      base_E = 0;
     || |FINSI;
     |SI nBonifFCI > 0;
          base_E = base_E - nBonifFCI;
          |SI base_E < 0;
               nBonifFCI = nBonifFCI + base_E;
               base_E = 0;
          |FINSI;
     |FINSI;
     |SI bon_59 > 0;
          base_E = base_E - bon_59;
          |SI base_E < 0;
               bon_59 = bon_59 + base_E;
               base_E = 0;
          |FINSI;
     |FINSI;
     |SI bon_60 > 0;
          base_E = base_E - bon_60;
          |SI base_E < 0;
               bon_60 = bon_60 + base_E;
               base_E = 0;
          |FINSI;
     |FINSI;
     |SI nBonifERE > 0;
          base_E = base_E - nBonifERE;
          |SI base_E < 0;
               nBonifERE = nBonifERE + base_E;
               base_E = 0;
          |FINSI;
     |FINSI;
     |SI #nombonif#10 = 4;
          || parte bonificacion al trabajador, sumo en el campo cuota bonif
          || pero no tiene que restar de la SS a cgo. empresa, sino no saldrian
          || los resumenes luego como deben

          || nNume2 = por1_cont - ((por1_cont % 6.20) ! 2);    || bonif trabajador
          nNume2 = #nombonif#6;

          base_A = base_A + ((bon_0 % nNume2) ! 2);
          base_F = base_F + ((bon_0 % nNume2) ! 2);
     |FINSI;
|FPRC;
