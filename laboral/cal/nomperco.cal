|FICHEROS;
     nomperco #0;
     nomlicoc;
     nomlicol;
     nomcalca;
     nomhicca;
     labtraba;
|FIN;

|VARIABLES;
     nConvenio = 0;
     nCategoria = 0;
     nBaseReal = 0;
     nBaseCot = 0;
     nAny = 0;
     nDiferencia = 0;
     aMensaje = "";
     swMensaje = 0;
     FEstado = 0;
|FIN;

|PROCESO nomhicca;
     #nomlicoc#0 = #nomhicca#0;
     #nomlicoc#1 = #0#7;
     #nomlicoc#2 = #nomhicca#2;
     |LEE 101#nomlicoc.=;
     |SI FSalida ! 0;
          |GRABA 020#nomlicoc.n;
     |FINSI;

     #nomlicol#0 = #nomhicca#0;
     #nomlicol#1 = #0#7;
     #nomlicol#2 = #nomhicca#2;
     #nomlicol#3 = #nomhicca#1;
     |LEE 101#nomlicol.=;
     FEstado = FSalida;

     |SI FEstado = 0; |Y swMensaje = 0;
          aMensaje = "    ATENCION: se han encontrado datos de atrasos en el mantenimiento. ";
          aMensaje = aMensaje + "Si continua, se sobreescribiran.";
          |MENAV aMensaje;
          aMensaje = "    SDesea continuar?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               swMensaje = 1;
          |SINO;
               swMensaje = 2;
          |FINSI;
     |FINSI;

     |SI swMensaje = 0; |O swMensaje = 1;
          #labtraba#0 = #nomhicca#0;
          #labtraba#1 = #nomhicca#1;
          |LEE 000#labtraba.=;

          #nomlicol#4 = #labtraba#2;
          #nomlicol#5 = #nomhicca#8;    || dias cotizados
          #nomlicol#10 = #nomhicca#133;  || dias efectivos
          || #nomlicol#11 = #nomcalca#132; || dias laborables IT
          #nomlicol#6 = #nomhicca#35;    || base diaria que cotiza
          #nomlicol#8 = #nomlicol#10 * #nomlicol#6;     || total cotizacion mes
          #nomlicol#12 = 2; || tipo 2 (permisos sin retribucion bomberos)
          |SI FEstado = 0;
               |GRABA 020#nomlicol.a;
          |SINO;
               |GRABA 020#nomlicol.n;
          |FINSI;
          |LIBERA #nomlicol;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     133;
     #0#0, #0#2, nAny, #0#5, 0, 1;
     #0#1, #0#3, nAny, #0#6, 0, 31;
     ;
     NULL, nomhicca;
|FIN;

|PROCESO nomcalca;
     #nomlicoc#0 = #nomcalca#0;
     #nomlicoc#1 = #0#7;
     #nomlicoc#2 = #nomcalca#2;
     |LEE 101#nomlicoc.=;
     |SI FSalida ! 0;
          |GRABA 020#nomlicoc.n;
     |FINSI;

     #nomlicol#0 = #nomcalca#0;
     #nomlicol#1 = #0#7;
     #nomlicol#2 = #nomcalca#2;
     #nomlicol#3 = #nomcalca#1;
     |LEE 101#nomlicol.=;
     FEstado = FSalida;

     |SI FEstado = 0; |Y swMensaje = 0;
          aMensaje = "    ATENCION: se han encontrado datos de atrasos en el mantenimiento. ";
          aMensaje = aMensaje + "Si continua, se sobreescribiran.";
          |MENAV aMensaje;
          aMensaje = "    SDesea continuar?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               swMensaje = 1;
          |SINO;
               swMensaje = 2;
          |FINSI;
     |FINSI;

     |SI swMensaje = 0; |O swMensaje = 1;
          #labtraba#0 = #nomcalca#0;
          #labtraba#1 = #nomcalca#1;
          |LEE 000#labtraba.=;

          #nomlicol#4 = #labtraba#2;
          #nomlicol#5 = #nomcalca#8;    || dias cotizados
          #nomlicol#10 = #nomcalca#91;  || dias efectivos
          || #nomlicol#11 = #nomcalca#132; || dias laborables IT
          #nomlicol#6 = #nomcalca#35;    || base diaria que cotiza
          #nomlicol#8 = #nomlicol#10 * #nomlicol#6;     || total cotizacion mes
          #nomlicol#12 = 2; || tipo 2 (permisos sin retribucion bomberos)
          |SI FEstado = 0;
               |GRABA 020#nomlicol.a;
          |SINO;
               |GRABA 020#nomlicol.n;
          |FINSI;
          |LIBERA #nomlicol;
     |FINSI;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     91;
     #0#0, #0#2, #0#5, 0, 1;
     #0#1, #0#3, #0#6, 0, 31;
     ;
     NULL, nomcalca;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;

     swMensaje = 0;

     |ABRE #nomcalca;
     |ABRE #nomhicca;
     |ABRE #nomlicoc;
     |ABRE #nomlicol;
     |ABRE #labtraba;
     |SI #0#4 = "M";
          |BUCLE nomcalca;
     |SINO;
          nAny = #0#7 - 2000;
          |BUCLE nomhicca;
     |FINSI;
     |CIERRA #labtraba;
     |CIERRA #nomlicol;
     |CIERRA #nomlicoc;
     |CIERRA #nomhicca;
     |CIERRA #nomcalca;
|FPRO;
