|FICHEROS;
     labcon36 #0;
     labtraba #2;
     labvaltb;
     thitiaca;
     nomir003;
|FIN;

|VARIABLES;
     &si4="";
     aMinusvalido="";
     &titulo1="";
     &titulo2="";
     &aCodigoC1="";
     &aCodigoC2="";
     &aCodigoC3="";

     &fecalf = "";
     &fech1 = @;
     &wany = 0;
     &wdia = 0;
     &wmes = 0;
     &vpuntos = "..........";
     &vblanco = "          ";
     &fech3 = @;
     &salfa1 = "";
     &fech2 = @;
     &nume0 = 0;
     &nume1 = 0;
     &nume2 = 0;
     &nume3 = 0;
     &nume4 = 0;
     &nume5 = 0;
     &nume6 = 0;
     aAlfa = "";
     aAlfa1 = "";
     nNume = 0;
     nEdad = 0;
|FIN;

|PROCESO EsMinusvalido;
     aMinusvalido=PARAMETRO;     || utilizamos codificacion antigua para este caso
     aMinusvalido=aMinusvalido % 101;
     #labcon36#69 = aMinusvalido;
|FPRC;


|PROCESO menos_bisi;
    fecalf=fech1;  |HAZ desglosa_06;  nume1=wany;    nume5 = wmes;
    fecalf=fech2;  |HAZ desglosa_06;  nume2=wany;    nume6 = wmes;
    nume5 = 0;
|PARA nume4 = nume2;|SI nume4 [ nume1; |HACIENDO nume4 = nume4 + 1;
        nume3 = nume4 $ 4;
    |SI nume2 = nume4; |Y nume5 > 2;  nume3 = 1;          |FINSI;
    |SI nume1 = nume4; |Y nume6 [ 2;  nume3 = 1;          |FINSI;
    |SI nume3 = 0;                    nume5 = nume5 + 1;  |FINSI;
|SIGUE;
    nume0 = fech1 - fech2;
    nume0 = nume0 - nume5; || menos dias bisiestos + ambos inclusive
|FPRC;



|PROCESO fin_estudios; |TIPO 0;
     fech1 = ~;
     aAlfa = fech1;
     aAlfa1 = aAlfa % 102; nume1 = aAlfa1;
     aAlfa1 = aAlfa % 402; nume2 = aAlfa1;
     aAlfa1 = aAlfa % -104; nume3 = aAlfa1;

     aAlfa = #labtraba#11;
     aAlfa1 = aAlfa % 102; nume4 = aAlfa1;
     aAlfa1 = aAlfa % 402; nume5 = aAlfa1;
     aAlfa1 = aAlfa % -104; nume6 = aAlfa1;

     nEdad = nume3 - nume6;

     || discapacitados menores de 35 no tiene que dar el aviso
     |ABRE #nomir003;
     #nomir003#0 = #labtraba#7;
     #nomir003#40 = nume3;
     #nomir003#41 = #labtraba#0;
     |LEE 000#nomir003.=;
     |SI FSalida = 0; |Y #nomir003#6 = "S";
          |SI nEdad < 35
               |CIERRA #nomir003;
               |ACABA;
          |SINO;
               |SI nEdad = 35
                    |SI nume5 ] nume2;
                         |CIERRA #nomir003;
                         |ACABA;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #nomir003;

     || menores de 30 a¤os no tiene que dar el aviso
     |SI nEdad < 30
          |ACABA;
     |SINO;
          |SI nEdad = 30
               |SI nume5 ] nume2;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

|SI #0#41!vblanco;|Y #0#41!vpuntos;|Y FSalida!2;
    |SI #2#13!vblanco;|Y #2#13!vpuntos;
            fech3 = #2#13;  nume1 = fech3;     || fin estudios
            fech3 = #2#15;  nume2 = fech3;     || inicio mili
            fech3 = #2#16;  nume3 = fech3;     || fin mili
        |SI #2#14 = "S";
                nume1 = nume1 + (nume3 - nume2);      || fin estudios sin mili
        |FINSI;
            fech1 = #0#41;             || inicio contrato
            fech2 = nume1;             || fin estudios
        |HAZ menos_bisi;               || le resta los bisiestos
        |SI nume0 > 1825;
            |MENAV "    ATENCION!!! Han pasado 5 años desde la fecha fin de estudios ...";
        |FINSI;
    |SINO;
        |MENAV "    ATENCION!!! Falta informar la fecha fin de estudios ...";
    |FINSI;
|FINSI;
|FPRC;

|PROCESO desglosa_06;    || DESGLOSA EN DIA, MES Y ANYO UNA FECHA DD.MM.AAAA
    salfa1 = fecalf %  102;   wdia = salfa1;
    salfa1 = fecalf %  402;   wmes = salfa1;
    salfa1 = fecalf % -104;   wany = salfa1;
|SI salfa1 = "....";
        wdia = 0;
        wmes = 0;
        wany = 0;
|FINSI;
|FPRC;

|PROCESO TipoJornada;|TIPO 0;
     |SI #0#28="C";
          |SI #0#86 = "S";
               #0#0="450";
          |SINO;
               #0#0="420";
          |FINSI;
          |PINTA 1228,"1er. dia semana ..:     Ult. dia semana ..:";
          |CAMPO_VISUAL #0#33,1,"S";
          |CAMPO_VISUAL #0#34,1,"S";
          |PINTA #0#33;
          |PINTA #0#34;

          |CAMPO_MODIFICA #0#30,1,"N";
          #0#30="S";
          |PINTA #0#30;

          |CAMPO_MODIFICA #0#52,1,"N";
          |CAMPO_MODIFICA #0#53,1,"N";
          |CAMPO_MODIFICA #0#54,1,"N";
          |CAMPO_MODIFICA #0#55,1,"N";
          |CAMPO_MODIFICA #0#56,1,"N";
          |CAMPO_MODIFICA #0#57,1,"N";

          |CAMPO_MODIFICA #0#61,1,"N";
          |CAMPO_VISUAL #0#61,1,"N";
          aAlfa = "³                                                                            ³";
          |PINTA 1502, aAlfa;
     |SINO;
          |SI #0#86 = "S";
               #0#0="550";
          |SINO;
               #0#0="520";
          |FINSI;
          |CAMPO_VISUAL #0#33,1,"N";
          |CAMPO_VISUAL #0#34,1,"N";
          |PINTA 1228,"                                                  ";

          |CAMPO_MODIFICA #0#61,1,"S";
          |CAMPO_VISUAL #0#61,1,"S";
          aAlfa = "³ Pacto horas complementarias .....:                                         ³";
          |PINTA 1502, aAlfa;
          |PINTA #0#61;

 || esto hace que siempre sean horas semanales en caso de tiempo parcial
          |CAMPO_MODIFICA #0#30,1,"S";
/*
          #0#30="S";
          |PINTA #0#30;
*/

          |CAMPO_MODIFICA #0#52,1,"S";
          |CAMPO_MODIFICA #0#53,1,"S";
          |CAMPO_MODIFICA #0#54,1,"S";
          |CAMPO_MODIFICA #0#55,1,"S";
          |CAMPO_MODIFICA #0#56,1,"S";
          |CAMPO_MODIFICA #0#57,1,"S";
     |FINSI;
|FPRC;

|PROCESO AlEntrar; |TIPO 7;
     |HAZ EsMinusvalido;
     |SI aMinusvalido="M";
          |PINTA 1504,"Organismo Oficial :";
          |CAMPO_VISUAL #0#58,1,"S";
          |PINTA #0#58;
     |FINSI;
|FPRC;

|PROCESO Comienzo; |TIPO 3;
     |SI #0#28="C";
          titulo1="Tiempo Completo";
          |SI #0#86 = "S";
               #0#0="450";
               aCodigoC1="4";
               aCodigoC2="5";
               aCodigoC3="0";
          |SINO;
               #0#0="420";
               aCodigoC1="4";
               aCodigoC2="2";
               aCodigoC3="0";
          |FINSI;
     |SINO;
          titulo1="Tiempo Parcial";
          |SI #0#86 = "S";
               #0#0="550";
               aCodigoC1="5";
               aCodigoC2="5";
               aCodigoC3="0";
          |SINO;
               #0#0="520";
               aCodigoC1="5";
               aCodigoC2="2";
               aCodigoC3="0";
          |FINSI;

          |SI #0#30="D";
               titulo2="al d¡a";
          |FINSI;
          |SI #0#30="S";
               titulo2="a la semana";
          |FINSI;
          |SI #0#30="M";
               titulo2="al mes";
          |FINSI;
          |SI #0#30="A";
               titulo2="al a¤o";
          |FINSI;

     |FINSI;

     |SI #0#29="S";
          si4="SI";
     |SINO;
          si4="NO";
     |FINSI;


     |HAZ LeePaises;
|FPRC;

|PROCESO PintaPantalla;|TIPO 7;
     |HAZ TipoJornada;
     |HAZ AlEntrar;
|FPRC;
/*
|PROCESO BuscaTitulacion;
     |ABRE #labvaltb;
     |DDEFECTO #labvaltb;
     #labvaltb#0 = "labtraba";
     #labvaltb#1 = 12;
     #labvaltb#5 = #labtraba#0;
     #labvaltb#6 = #labtraba#1;
     |LEE 000#labvaltb.=;
     |SI FSalida = 0;
          aAlfa = #labvaltb#4;
     |SINO;
          aAlfa = #labtraba#12;
     |FINSI;
     |QBF aAlfa;
     |CIERRA #labvaltb;

     |ABRE #thitiaca;
     |SELECT #2#thitiaca;
     #thitiaca#1 = aAlfa;
     |LEE 000#thitiaca.=;
     |SI FSalida ! 0;
          |DDEFECTO #thitiaca;
     |FINSI;
     |SELECT #1#thitiaca;
     |CIERRA #thitiaca;
     aAlfa = #thitiaca#0;
     |QBF aAlfa;
|FPRC;

|PROCESO Titulacion; |TIPO 7;
     aAlfa = #0#51;
     |QBF aAlfa;
     |SI aAlfa = "";
          aAlfa = "";
          |HAZ BuscaTitulacion;
          #0#51 = aAlfa;
          |PINTA #0#51;
     |FINSI;
|FPRC;
*/

|PROCESO Activa80; |TIPO 7;
     aAlfa = #labtraba#73;
     aAlfa = aAlfa % 102;
     nNume = aAlfa;
     |SI nNume < 33;
          |CAMPO_MODIFICA #0#80, 1, "S";
          |CAMPO_VISUAL #0#80, 1, "S";
          |PINTA 1304, "Cert. profesional.:    ";
          |PINTA #0#80;
     |SINO;
          |CAMPO_MODIFICA #0#80, 1, "N";
          |CAMPO_VISUAL #0#80, 1, "N";
          |PINTA 1304, "                       ";
     |FINSI;
|FPRC;

|PROCESO ActivaGarJuv;
     |SI #0#86 = "S";
          |CAMPO_MODIFICA #0#87, 1, "S";
          |CAMPO_MODIFICA #0#88, 1, "S";
          |CAMPO_MODIFICA #0#89, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#87, 1, "N";
          |CAMPO_MODIFICA #0#88, 1, "N";
          |CAMPO_MODIFICA #0#89, 1, "N";
          #0#87 = "";
          #0#88 = "";
          #0#89 = "";
          |PINTA #0#87;
          |PINTA #0#88;
          |PINTA #0#89;
     |FINSI;
|FPRC;

|PROCESO Ayuda87_36; |TIPO 7;
     |PUSHV 16292380;
     |ATRI R;
     |PINTA 1730, " 1 - Menor de 25 a¤os o mayor  de 25 y menores de ";
     |PINTA 1830, " 30 hasta que la tasa de desempleo baje del 20%   ";
     |PINTA 1930, " 2 - Persona con discapacidad menor de 30 a¤os    ";
     |PINTA 2030, "                                                  ";
|FPRC;

|PROCESO Ayuda89_36; |TIPO 7;
     |PUSHV 16292380;
     |ATRI R;
     |PINTA 1730, " 1 - El 50% de bonificaci¢n adicional a la reduc- ";
     |PINTA 1830, " ci¢n del 50%.                                    ";
     |PINTA 1930, " 2 - El 25% de bonificaci¢n adicional a la reduc- ";
     |PINTA 2030, " ci¢n del 75% (pr cticas no laborales).           ";
|FPRC;
