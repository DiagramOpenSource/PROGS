|FICHEROS;
    nomconta #0;
    labempre #1;         || empresas
    labempax #2;         || aux. empresas
    nomcalca #3;         || calculos cabs.
    labtraba #4;         || trabajador
    nomauxi1 #5;         || areas
    nomcontb #10;        || formato fichero enlace
    nomcontc #11;        || tmp. fichero enlace
    nomcontd #12,MANTE;  || cuentas/DNI's
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    p_mes = "";
    deven = 0;
    rirpf = 0;
    rsegu = 0;
    liqui = 0;
    antic = 0;
    espec = 0;
    eltc1 = 0;
    signe = "";
    impor = 0;
    conte = "";
    digcu = 0;
    conce = 0;
    empre = 0;
    dia1 = "";
    dia2 = "";
    mes1 = "";
    mes2 = "";
    any1 = "";
    any2 = "";
    any3 = "";
    any4 = "";
    topes = 0;
    fech = "";
    sw_d = 0;
    sw_m = 0;
    sw_a = 0;
    sw_b = 0;
    asiento = 0;
    apunte = 0;
    sep_campo = "";
    espac = "";
    carga = "";

    p_alfa1 = "";
    p_error = 0;
    p_lugar = 0;
    p_cuan3 = 0;
    p_cuan4 = 0;
    p_cuan5 = 0;
    p_alfa2 = "";
    p_alfa3 = "";
    p_alfa4 = "";
    p_alfa5 = "";
    p_nume1 = 0;
    p_nume2 = 0;
    p_ceros = "";

    fabre = "";
    field = "";
    fcanl = "";
    fgrab = "";

    numcam = 0;
    desglo = 0;
    ant_area = "";
    cuadra = 0;
|FIN;
____________________________________/
|PROGRAMA;
|CLS;
|CABEZA "Enlace Contable";
|DDEFECTO #0;
|PINPA #0#0;
|PINDA #0#0;
|ABRE #0;
|LEE 101#0p;
|SI FSalida ! 0;
    |GRABA 020#0b;
|FINSI;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
    |HAZ tipo3;
    |GRABA 020#0a;
|FINSI;
|LIBERA #0;
|CIERRA #0;
|FPRO;
____________________________________/ CALCULOS PANTALLA
|PROCESO mirames; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO pintames; |TIPO 0;
|SI #0Campo =  1;  p_mes = "ENERO     ";  |FINSI;
|SI #0Campo =  2;  p_mes = "FEBRERO   ";  |FINSI;
|SI #0Campo =  3;  p_mes = "MARZO     ";  |FINSI;
|SI #0Campo =  4;  p_mes = "ABRIL     ";  |FINSI;
|SI #0Campo =  5;  p_mes = "MAYO      ";  |FINSI;
|SI #0Campo =  6;  p_mes = "JUNIO     ";  |FINSI;
|SI #0Campo =  7;  p_mes = "JULIO     ";  |FINSI;
|SI #0Campo =  8;  p_mes = "AGOSTO    ";  |FINSI;
|SI #0Campo =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
|SI #0Campo = 10;  p_mes = "OCTUBRE   ";  |FINSI;
|SI #0Campo = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
|SI #0Campo = 12;  p_mes = "DICIEMBRE ";  |FINSI;
|ATRI I;
|PINTA 1063, p_mes;
|ATRI 0;
|FPRC;

|PROCESO desde_hasta; |TIPO 0;
|PARA para1 = 2; |SI para1 [ 11; |HACIENDO para1 = para1 + 1;
    |CAMPO_MODIFICA #0para1, 1, "S";
|SIGUE;
|CAMPO_MODIFICA #0#12, 1, "N";
|CAMPO_MODIFICA #0#13, 1, "N";

|SI #0#1 = 0;
    |PARA para1 = 2; |SI para1 [ 11; |HACIENDO para1 = para1 + 1;
        |CAMPO_MODIFICA #0para1, 1, "N";
    |SIGUE;
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#13, 1, "S";
|FINSI;
|FPRC;

|PROCESO lee_emp; |TIPO 0;
|SI #0Campo ! 0;
    |ABRE #1;
        #1#0 = #0Campo;
    |LEE 000#1=;
    |SI FSalida ! 0;
        |MENAV "    Empresa INEXISTENTE ...";
        |ERROR;
    |FINSI;
    |CIERRA #1;
|FINSI;
|FPRC;

|PROCESO pin_emp; |TIPO 7;
|DDEFECTO #1;
|SI #0Campo ! 0;
    |ABRE #1;
        #1#0 = #0Campo;
    |LEE 000#1=;
    |CIERRA #1;
|FINSI;
|ATRI I;   |PINTA 0922, #1#2;  |ATRI 0;
|FPRC;

|PROCESO min12;
    #12#0 = "            ";
|FPRC;

|PROCESO max12;
    #12#0 = "zzzzzzzzzzzz";
|FPRC;

|PROCESO asignacion; |TIPO 0;
|SI #0#44 = "S";|Y FSalida = 0;
    |PUSHV 0501 2380;
    |ENTLINEAL #1#12, 1, 3, 22, 1, min12, max12;
    |POPV;
|FINSI;
|FPRC;
____________________________________/ GRABACION DE ASIENTOS
|PROCESO grabalo;
    fgrab = fcanl + " " + fgrab;
|FGRABA fgrab;
|FPRC;

|PROCESO descrip;
|SI #10#10 ! 0;
        alfa1 = #0#33;
        nume1 = 100 + #10#10;
        espac = " " * 50;
        fgrab = ((alfa1 + espac) % nume1) + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO impor_haber;
|SI #10#9 ! 0;
    |SI signe = "H";|O #10#8 = 0;
            alfa1 = impor;
    |SINO;
            alfa1 = "0";
    |FINSI;
    |QBT alfa1;
        nume1 = (100 + #10#9) * -1;
        espac = " " * 20;
        fgrab = ((espac + alfa1) % nume1) + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO impor_debe;
|SI #10#8 ! 0;
    |SI signe = "D";|O #10#9 = 0;
            alfa1 = impor;
    |SINO;
            alfa1 = "0";
    |FINSI;
    |QBT alfa1;
        nume1 = (100 + #10#8) * -1;
        espac = " " * 20;
        fgrab = ((espac + alfa1) % nume1) + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO sign;
|SI #10#7 ! 0;
        alfa1 = signe;
    |QBT alfa1;
        nume1 = 100 + #10#7;
        fgrab = (alfa1 % nume1) + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO cuenta;
|SI #10#6 ! 0;
        p_alfa1 = conte;
        p_alfa1 = (p_alfa1 + "            ") % 112;
        p_error = 0;
        p_lugar = 0;
        p_cuan3 = 0;
        p_cuan4 = 0;
        p_alfa3 = "";
        p_alfa4 = "";
    |PARA p_nume1 = 1; |SI p_nume1 [ 12; |HACIENDO p_nume1 = p_nume1 + 1;
            p_nume2 = (p_nume1 * 100) + 1;
            p_alfa2 = p_alfa1 % p_nume2;
        |SI p_alfa2 ! " ";
            |SI p_alfa2 = ".";
                    p_lugar = p_nume1;
            |SINO;
                |SI p_lugar=0; p_alfa3=p_alfa3+p_alfa2; p_cuan3=p_cuan3+1; |FINSI;
                |SI p_lugar!0; p_alfa4=p_alfa4+p_alfa2; p_cuan4=p_cuan4+1; |FINSI;
            |FINSI;
        |FINSI;
    |SIGUE;
    |SI p_lugar ! 0;
            p_cuan5 = #10#6;
            p_nume1 = p_cuan5 - (p_cuan3 + p_cuan4);
        |SI p_nume1 > 0;
                p_ceros = "0" * p_nume1;
                p_alfa5 = p_alfa3 + p_ceros + p_alfa4;
        |SINO;
                p_error = 1;
        |FINSI;
    |SINO;
            p_alfa5 = p_alfa1;
    |FINSI;
        conte = p_alfa5;

        fgrab = conte + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO apunte;
|SI #10#5 ! 0;
        apunte = apunte + 1;
        alfa1 = apunte;
    |QBT alfa1;
        nume1 = 100 + #10#5;
        fgrab = alfa1 % nume1;
        nume1 = nume1 * -1;
        fgrab = ("0000000000" + fgrab) % nume1;
        fgrab = fgrab + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO asiento;
|SI #10#4 ! 0;
        alfa1 = asiento;
    |QBT alfa1;
        nume1 = 100 + #10#4;
        fgrab = alfa1 % nume1;
        nume1 = nume1 * -1;
        fgrab = ("0000000000" + fgrab) % nume1;
        fgrab = fgrab + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO fecha;
    alfa1 = #0#31;       || desglose de la fecha
    dia1 = alfa1 % 101;
    dia2 = alfa1 % 201;
    mes1 = alfa1 % 401;
    mes2 = alfa1 % 501;
    any1 = alfa1 % 701;
    any2 = alfa1 % 801;
    any3 = alfa1 % 901;
    any4 = alfa1 % 1001;

    alfa1 = #10#3;
|QBT alfa1;
    alfa2 = alfa1 % 0;   topes = alfa2;

    fech = ""; sw_d = 0;  sw_m = 0; sw_a = 0; sw_b = 0;

|PARA para1 = 1; |SI para1 [ topes; |HACIENDO para1 = para1 + 1;
        nume1 = (para1 * 100) + 1;
        alfa2 = alfa1 % nume1;
        carga = alfa2;
    |SI alfa2 = "D";|Y sw_d = 0; carga = dia1; alfa2 = ""; sw_d = 1; |FINSI;
    |SI alfa2 = "D";|Y sw_d = 1; carga = dia2; alfa2 = ""; sw_d = 2; |FINSI;
    |SI alfa2 = "M";|Y sw_m = 0; carga = mes1; alfa2 = ""; sw_m = 1; |FINSI;
    |SI alfa2 = "M";|Y sw_m = 1; carga = mes2; alfa2 = ""; sw_m = 2; |FINSI;
    |SI alfa2 = "A";|Y sw_a = 0; carga = any1; alfa2 = ""; sw_a = 1; |FINSI;
    |SI alfa2 = "A";|Y sw_a = 1; carga = any2; alfa2 = ""; sw_a = 2; |FINSI;
    |SI alfa2 = "A";|Y sw_a = 2; carga = any3; alfa2 = ""; sw_a = 3; |FINSI;
    |SI alfa2 = "A";|Y sw_a = 3; carga = any4; alfa2 = ""; sw_a = 4; |FINSI;
    |SI alfa2 = "a";|Y sw_b = 0; carga = any3; alfa2 = ""; sw_b = 1; |FINSI;
    |SI alfa2 = "a";|Y sw_b = 1; carga = any4; alfa2 = ""; sw_b = 2; |FINSI;
        fech = fech + carga;
|SIGUE;
    fgrab = fech + sep_campo;
|HAZ grabalo;
|FPRC;

|PROCESO diario;
|SI #10#2 ! 0;
        alfa1 = #0#30;
    |QBT alfa1;
        nume1 = 100 + #10#2;
        fgrab = alfa1 % nume1;
        nume1 = nume1 * -1;
        fgrab = ("0000000000" + fgrab) % nume1;
        fgrab = fgrab + sep_campo;
    |HAZ grabalo;
|FINSI;
|FPRC;

|PROCESO apuntes;
|SI impor ! 0;
    |SI numcam = 16;     rsegu = rsegu + impor;   |FINSI;
    |HAZ diario;
    |HAZ fecha;
    |HAZ asiento;
    |HAZ apunte;
    |HAZ cuenta;
    |HAZ sign;
    |HAZ impor_debe;
    |HAZ impor_haber;
    |HAZ descrip;

        fgrab = "";
    |SI #10#13 ! -1;     fgrab = fgrab + &#10#13; |FINSI;
    |SI #10#14 ! -1;     fgrab = fgrab + &#10#14; |FINSI;
    |SI fgrab ! "";
        |HAZ grabalo;
    |FINSI;
|FINSI;
|FPRC;
____________________________________/ LECTURA DEL TEMPORAL

________________________________________ ASIENTO 2
|PROCESO sstmp2_1;
|SI sw_rup = 0;
        sw_rup = 1;
|SINO;
    |HAZ apuntes;
        cuadra = cuadra + impor;
|FINSI;
    impor = #11#9;            || importe

    conte = #0numcam;         || cuenta
|QBF conte;
    conte = conte + #11#1;
|FPRC;

|DEFBUCLE sstmp2;          || por trabajadores
 #11#1;
 ;
 #1#0,     1;
 #1#0, 99999;
 ;
 NULL, sstmp2_1;
|FIN;

|PROCESO sstmp1_6;
|HAZ sstmp1_1;
|SI sw_rup = 0;
        sw_rup = 1;
        ant_area = #4#62;
|FINSI;
|SI ant_area ! #4#62;
    |HAZ apuntes;
        cuadra = cuadra + impor;
        ant_area = #4#62;
        impor = 0;
|FINSI;
    impor = impor + #11#9;         || importe

    conte = #0numcam;              || cuenta
|QBF conte;
    conte = conte + ant_area;
|FPRC;

|PROCESO sstmp1_1;
    #4#0 = #11#0;
    #4#1 = #11#1;
|LEE 020#4=;
|FPRC;

|DEFBUCLE sstmp1;        || por areas
 #11#1;
 ;
 #1#0,     1;
 #1#0, 99999;
 ;
 NULL, sstmp1_1, NULL, NULL, NULL, sstmp1_6;
 #4#0, #4#62, #4#1;
|FIN;

________________________________________ ASIENTO 1
|PROCESO tmp2_1;
|SI numcam ! 43;
        nume1 = numcam - 12;
|SINO;
        nume1 = 8;
|FINSI;
    impor = #11nume1;         || importe

    conte = #0numcam;         || cuenta
|QBF conte;
    conte = conte + #11#1;

|HAZ tmp1_1;
    #12#0 = #4#7;
|LEE 000#12=;
|SI FSalida = 0;|Y #0#44 = "S";
    |SI numcam = 14;|Y #12#2 ! "            ";    conte = #12#2; |FINSI;
    |SI numcam = 15;|Y #12#3 ! "            ";    conte = #12#3; |FINSI;
    |SI numcam = 16;|Y #12#4 ! "            ";    conte = #12#4; |FINSI;
    |SI numcam = 17;|Y #12#5 ! "            ";    conte = #12#5; |FINSI;
    |SI numcam = 18;|Y #12#6 ! "            ";    conte = #12#6; |FINSI;
    |SI numcam = 19;|Y #12#7 ! "            ";    conte = #12#7; |FINSI;
    |SI numcam = 43;|Y #12#8 ! "            ";    conte = #12#8; |FINSI;
|FINSI;

|HAZ apuntes;
|FPRC;

|DEFBUCLE tmp2;          || por trabajadores
 #11#1;
 ;
 #1#0,     1;
 #1#0, 99999;
 ;
 NULL, tmp2_1;
|FIN;

|PROCESO tmp1_6;
|HAZ tmp1_1;
|SI sw_rup = 0;
        sw_rup = 1;
        ant_area = #4#62;
|FINSI;
|SI ant_area ! #4#62;
    |HAZ apuntes;
        ant_area = #4#62;
        impor = 0;
|FINSI;
|SI numcam ! 43;
        nume1 = numcam - 12;
|SINO;
        nume1 = 8;
|FINSI;
    impor = impor + #11nume1;          || importe

    conte = #0numcam;                  || cuenta
|QBF conte;
    conte = conte + ant_area;
|FPRC;

|PROCESO tmp1_1;
    #4#0 = #11#0;
    #4#1 = #11#1;
|LEE 020#4=;
|FPRC;

|DEFBUCLE tmp1;          || por areas
 #11#1;
 ;
 #1#0,     1;
 #1#0, 99999;
 ;
 NULL, tmp1_1, NULL, NULL, NULL, tmp1_6;
 #4#0, #4#62, #4#1;
|FIN;

|PROCESO tmp0_5;
    conte = #0numcam;
|HAZ apuntes;
|FPRC;

|PROCESO tmp0_1;
|SI numcam ! 43;
        nume1 = numcam - 12;
|SINO;
        nume1 = 8;
|FINSI;
    impor = impor + #11nume1;
|FPRC;

|DEFBUCLE tmp0;          || global
 #11#1;
 ;
 #1#0,     1;
 #1#0, 99999;
 ;
 NULL, tmp0_1, NULL, NULL, tmp0_5;
|FIN;
____________________________________/ GRABACION DEL TEMPORAL
|PROCESO labempax1;
    eltc1 = eltc1 + #2#20;
|FPRC;

|DEFBUCLE labempax;
 #2#1;
 ;
 #1#0,  1, #0#32,  0;
 #1#0, 99, #0#32, 19;
 ;
 NULL, labempax1;
|FIN;

|PROCESO nomcalca1;
|DDEFECTO #11;
    #11#0 = #3#0;
    #11#1 = #3#1;
|LEE 101#11=;
    FEstado = FSalida;

    #11#2 = #11#2 + #3#46 + #3#47;                     || total brutos
    #11#3 = #11#3 + #3#75 + #3#17;                     || total reten. IRPF
    #11#4 = #11#4 + #3#48 + #3#49 + #3#50 + #3#51;     || total aport. S.S.
    #11#6 = #11#6 + #3#52;                             || total anticipos 1
    #11#7 = #11#7 + #3#54;                             || total en especie
    #11#8 = #11#8 + #3#53;                             || total anticipos 2
    #11#5 = #11#2 - (#11#3+#11#4+#11#6+#11#7+#11#8);   || liquido
    #11#9 = #11#9 + (#3#45 - (#3#57 + #3#58));         || ss empresa

|SI FEstado = 0;    |GRABA 020#11a;     |FINSI;
|SI FEstado ! 0;    |GRABA 020#11n;     |FINSI;
|LIBERA #11;
|FPRC;

|DEFBUCLE nomcalca;
 #3#1;
 ;
 #1#0,     1, #0#32, 0;
 #1#0, 99999, #0#32, 9;
 ;
 NULL, nomcalca1;
|FIN;

|PROCESO calcula;
|BUCLE nomcalca;
    eltc1 = 0;      || importe TC1      (DEBE/HABER)   (7-8)
|BUCLE labempax;
|FPRC;
____________________________________/ LECTURA Y CALCULOS PRINCIPALES
|PROCESO conta1;
    alfa1 = Usuario;     |QBT alfa1;
|NOME_DAT #11 alfa1;
|DELINDEX #11;

|ABRE #11;
|HAZ calcula;
|CIERRA #11;

    rsegu = 0;

    asiento = asiento + 1;
    apunte = 0;
|PARA numcam = 14; |SI numcam [ 43; |HACIENDO numcam = numcam + 1;
    |SI numcam = 20;     numcam = 43;   |FINSI;

    |SI numcam = 14;     signe = "D";   |FINSI;   || total devengado
    |SI numcam = 15;     signe = "H";   |FINSI;   || retencion IRPF
    |SI numcam = 16;     signe = "H";   |FINSI;   || retencion S.S.
    |SI numcam = 17;     signe = "H";   |FINSI;   || liquido
    |SI numcam = 18;     signe = "H";   |FINSI;   || anticipos 1
    |SI numcam = 19;     signe = "H";   |FINSI;   || en especie
    |SI numcam = 43;     signe = "H";   |FINSI;   || anticipos 2

        sw_rup = 0;
        impor = 0;
        desglo = numcam + 22;  || puntero desglose
    |SI numcam = 43;     desglo = 42;   |FINSI;   || anticipos 2

    |SI #0desglo = 0;    |BUCLE tmp0;                  |FINSI;
    |SI #0desglo = 1;    |BUCLE tmp1;   |HAZ apuntes;  |FINSI;
    |SI #0desglo = 2;    |BUCLE tmp2;                  |FINSI;
|SIGUE;

    asiento = asiento + 1;
    apunte = 0;

|PARA numcam = 20; |SI numcam [ 21; |HACIENDO numcam = numcam + 1;
        sw_rup = 0;
        impor = 0;
        cuadra = 0;
        desglo = numcam + 25;
    |SI numcam = 20;     signe = "D";   |FINSI;
    |SI numcam = 21;     signe = "H";   |FINSI;

    |SI #0desglo = 0;
            impor = eltc1 - rsegu;
            conte = #0numcam;
        |HAZ apuntes;
    |FINSI;
    |SI #0desglo = 1;
        |BUCLE sstmp1;
            impor = ((eltc1 - rsegu) - cuadra);
        |HAZ apuntes;
    |FINSI;
    |SI #0desglo = 2;
        |BUCLE sstmp2;
            impor = ((eltc1 - rsegu) - cuadra);
        |HAZ apuntes;
    |FINSI;
|SIGUE;

|DELINDEX #11;
|FPRC;

|DEFBUCLE labempre;
 #1#1;
 ;
 #0#12;
 #0#13;
 ;
 NULL, conta1;
|FIN;

|PROCESO bucles;
|SI #0#1 ! 0;
    |ABRE #1;
    |PARA empre = 1; |SI empre [ 11; |HACIENDO empre = empre + 1;
            #1#0 = #0empre;
        |LEE 000#1=;
        |SI FSalida = 0;
            |HAZ conta1;
        |FINSI;
    |SIGUE;
    |CIERRA #1;
|SINO;
    |BUCLE labempre;
|FINSI;
|FPRC;

|PROCESO tipo3; |TIPO 3;
|ABRE #10;
    #10#0 = #0#34;
|LEE 020#10=;
|SI FSalida = 0;
        fabre = #10#11;
    |QBT fabre;
        fabre = "wb  " + fabre;
    |FABRE fabre;
    |SI FSalida ] 0;
            fcanl = FSalida;

            sep_campo = #10#12;
        |SI sep_campo = " ";     sep_campo = "";  |FINSI;
            nume1 = #0#35;
            asiento = nume1 - 1;

        |ABRE #4;
        |ABRE #5;
        |ABRE #12;
        |HAZ bucles;
        |CIERRA #4;
        |CIERRA #5;
        |CIERRA #12;

        |SI #10#15 ! -1; fgrab = &#10#15;    |HAZ grabalo;  |FINSI;

        |FCIERRA fcanl;
    |SINO;
            alfa1 = "    [" + (fabre % 5) + "] no accesible ...";
        |MENAV alfa1;
    |FINSI;
        Pos = -1;
|FINSI;
|CIERRA #10;
|FPRC;
____________________________ PROCESOS DEL nomcontd
|VARIABLES;
    &bus_emp = 0;
    &bus_tra = 0;
    &bus_cla = 0;
|FIN;

|PROCESO busqueda; |TIPO 11;
    bus_emp = 0;
    bus_tra = 0;
    bus_cla = 0;
|SI FSalida =  9;  bus_cla = 1;  |FINSI;
|SI FSalida = 10;  bus_cla = 2;  |FINSI;
|SI FSalida = 11;  bus_cla = 3;  |FINSI;
|SI bus_cla ! 0;
    |SUB_EJECUTA "nombusca";
    |DDEFECTO #4;
    |ABRE #4;
        #4#0 = bus_emp;
        #4#1 = bus_tra;
    |LEE 000#4=;
    |SI FSalida = 0;
            #12#0 = #4#7;    |PINTA #12#0;
            #12#1 = #4#2;    |PINTA #12#1;
        |ERROR;
        |PTEC 802;
    |FINSI;
    |CIERRA #4;
|FINSI;
|FPRC;

|PROCESO selecciona; |TIPO 7;

|SI #0#36 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#2, 1, alfa1;
|SI alfa1="S";|Y #12#2 = "            "; alfa1=#0#14; |QBF alfa1; #12#2=alfa1+#4#1; |PINTA #12#2; |FINSI;

|SI #0#37 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#3, 1, alfa1;
|SI alfa1="S";|Y #12#3 = "            "; alfa1=#0#15; |QBF alfa1; #12#3=alfa1+#4#1; |PINTA #12#3; |FINSI;

|SI #0#38 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#4, 1, alfa1;
|SI alfa1="S";|Y #12#4 = "            "; alfa1=#0#16; |QBF alfa1; #12#4=alfa1+#4#1; |PINTA #12#4; |FINSI;

|SI #0#39 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#5, 1, alfa1;
|SI alfa1="S";|Y #12#5 = "            "; alfa1=#0#17; |QBF alfa1; #12#5=alfa1+#4#1; |PINTA #12#5; |FINSI;

|SI #0#40 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#6, 1, alfa1;
|SI alfa1="S";|Y #12#6 = "            "; alfa1=#0#18; |QBF alfa1; #12#6=alfa1+#4#1; |PINTA #12#6; |FINSI;

|SI #0#42 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#8, 1, alfa1;
|SI alfa1="S";|Y #12#8 = "            "; alfa1=#0#43; |QBF alfa1; #12#8=alfa1+#4#1; |PINTA #12#8; |FINSI;

|SI #0#41 = 2; alfa1 = "S";   |SINO;    alfa1 = "N";   |FINSI;
|C_M #12#7, 1, alfa1;
|SI alfa1="S";|Y #12#7 = "            "; alfa1=#0#19; |QBF alfa1; #12#7=alfa1+#4#1; |PINTA #12#7; |FINSI;
|FPRC;

|PROCESO comprueba; |TIPO 7;
|ABRE #4;
|SELECT #2#4;
    #4#7 = #12#0;
|LEE 000#4=;
|SI FSalida = 0;
        #12#1 = #4#2;
    |PINTA #12#1;
|SINO;
    |MENAV "    D.N.I. inaccesible o inexistente. Utilice la consulta (<F3>) ...";
    |PTEC 807;
|FINSI;
|CIERRA #4;
|FPRC;
