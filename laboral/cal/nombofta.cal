|FICHEROS;
     nombofta #0;
     nombofti,MANTE;
|FIN;

|VARIABLES;
     fFecha = @;
     aFecha = "";
     aAny = "";
     nAny = 0;
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     &nCredito = 0;
     nCreditoManual = 0;
     aInformeSN = "";
     nModo = 0;
|FIN;

|PROCESO DefectoCen; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |SI #nombofti#3 = 0;     || aun no he metido importe
               #nombofti#4 = 99;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO defany; |TIPO 7;
     fFecha = ~;
     aFecha = fFecha;
     aAny = aFecha % -104;
     nAny = aAny;
     #0#1 = nAny;
     |PINTA #0#1;
|FPRC;

|PROCESO ElInforme;
     aAlfa1 = #0#0;
     |QBF aAlfa1;
     aAlfa1 = ("00000" + aAlfa1) % -105;

     aAlfa2 = #0#1;
     |QBF aAlfa2;
     aAlfa2 = ("0000" + aAlfa2) % -104;

     aAlfa = "nominf05;" + aAlfa1 + aAlfa2 + aInformeSN;
     |SUB_EJECUTA_NP aAlfa;
|FPRC;

|PROCESO Ayuda5; |TIPO 7;
     |PUSHV 12012322;
     |ATRI R;
             ||             1         2
             ||    1234567890123456789012
     |PINTA 1201, "-TIPO DE BONIFICACION-";
     |PINTA 1301, "Introduzca 'B'  si  se";
     |PINTA 1401, "trata de una Bonifica-";
     |PINTA 1501, "ci¢n de Formaci¢n Con-";
     |PINTA 1601, "tinua habitual o  bien";
     |PINTA 1701, "introduzca 'P'  si  se";
     |PINTA 1801, "aplica un  Permiso In-";
     |PINTA 1901, "dividual de Formaci¢n.";
|FPRC;

|PROCESO Ayuda4; |TIPO 7;
     |PUSHV 12012322;
     |ATRI R;
             ||             1         2
             ||    1234567890123456789012
     |PINTA 1201, "      - CENTRO -      ";
     |PINTA 1301, "Para asignar la bonif.";
     |PINTA 1401, "a un centro espec¡fico";
     |PINTA 1501, "de la  empresa, intro-";
     |PINTA 1601, "duzca su c¢digo.      ";
     |PINTA 1701, "Introduzca  '99'  para";
     |PINTA 1801, "que la aplicaci¢n  ac-";
     |PINTA 1901, "t£e como habitualmente";
     |PINTA 2001, "asign ndola al  primer";
     |PINTA 2101, "centro de la empresa  ";
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Informe";
     |SINO;
          |SI #0#1 < 2011;
               |MENAV "    Opción disponible para el año 2011 en adelante";
          |SINO;
               aInformeSN = "S";
               |HAZ ElInforme;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Lineas;
     nCreditoManual = nCreditoManual + #nombofti#3;
|FPRC;

|DEFBUCLE Lineas;
     #nombofti#1;
     ;
     #0#0, #0#1, 01, 001, "B";
     #0#0, #0#1, 12, 999, "B";
     ;
     NULL, Lineas;
|FIN;

|PROCESO PintaCredito; |TIPO 13;
     aInformeSN = "N";
     |HAZ ElInforme;
     |CUADRO 1251 1971;
     |ATRI R;
     |PINTA 1352, " Cr‚dito formaci¢n ";
     |ATRI 0;
     aAlfa = nCredito;
     |QBF aAlfa;
     aAlfa = aAlfa + " euros       ";
     aAlfa = aAlfa % 114;
     |PINTA 1455, aAlfa;

     |HAZ SumaLineas;
|FPRC;

|PROCESO SumaLineas;
||TIPO 7;
     |SI #0#1 < 2011;
          |BLANCO 1251 2371;
          |ACABA;
     |FINSI;

     |SALVA_FICHA #nombofti;

     nCreditoManual = 0;
     |BUCLE Lineas;
     |ATRI R;
     |PINTA 1652, " Cr‚dito consumido ";
     |ATRI 0;
     aAlfa = nCreditoManual;
     |QBF aAlfa;
     aAlfa = aAlfa + " euros       ";
     aAlfa = aAlfa % 114;
     |PINTA 1755, aAlfa;

     |REPON_FICHA #nombofti;

     #nombofta#2 = nCreditoManual;
     ||PINTA #nombofta#2;

     |SI nCreditoManual > nCredito;
          |AVISO;
          |CUADRO 2051 2371;
          |ATRI S;
          |PINTA 2152, " CREDITO EXCEDIDO  ";
          |ATRI 0;
     |SINO;
          |BLANCO 2051 2371;
     |FINSI;
|FPRC;

|PROCESO Tipo3; TIPO 3;
     |HAZ PintaCredito;
     nModo = (FEntrada / 100) ! 0;
|FPRC;

|PROCESO TipoResta; TIPO 2;
     |SI #nombofti#5 = "P";
          |ACABA;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 2; |O nModo = 3;
          #nombofta#2 = #nombofta#2 - #nombofti#3;
     |FINSI;
     ||PINTA #nombofta#2;

     aAlfa = #nombofta#2;
     |QBF aAlfa;
     aAlfa = aAlfa + " euros       ";
     aAlfa = aAlfa % 114;
     |PINTA 1755, aAlfa;
|FPRC;

|PROCESO TipoSuma;
     |SI #nombofti#5 = "P";
          |ACABA;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O nModo = 2;
          #nombofta#2 = #nombofta#2 + #nombofti#3;
     |FINSI;
     ||PINTA #nombofta#2;

     aAlfa = #nombofta#2;
     |QBF aAlfa;
     aAlfa = aAlfa + " euros       ";
     aAlfa = aAlfa % 114;
     |PINTA 1755, aAlfa;
|FPRC;
