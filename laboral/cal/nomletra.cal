|FICHEROS;
    nomletra #0;
    labempre #1;
    labtraba #2;
|FIN;

|VARIABLES;
 swnif = 0;
 nume1 = 0;
 nume2 = 0;
 lugar = 0;
 nifnum = 0;
 resto = 0;
    letra = "";
    alfa1 = "";
    alfa2 = "";
    x = "";
    final = "";
    trabajo = "";
    aAlfa1 = "";

    &eaVarDni  = "";
    &enCalcCIF = 0;
|FIN;

|PROCESO RellenaCeros;
     aAlfa1 = trabajo;
     aAlfa1 = ("000000000" + aAlfa1) % -109;
     trabajo = aAlfa1;
|FPRC;

|PROCESO letranif;
   eaVarDni  = trabajo;
   enCalcCIF = 0;
   |HAZ CalculoDNI;
   trabajo = eaVarDni;

   swnif = 0;    || activa cuando es un cif
|FPRC;

|PROCESO empresas;   || viene del bucle de empresas y va a calcular
|SI #0#4 = "S";      || segun preguntas
        trabajo = #1#10;
    |HAZ letranif;
    |SI swnif = 0;  #1#10 = trabajo;  |FINSI;
|FINSI;
|SI #0#5 = "S";
        trabajo = #1#17;
    |HAZ letranif;
    |SI swnif = 0;  #1#17 = trabajo;  |FINSI;
|FINSI;
|GRABA 020#1a;
|LIBERA #1;
|FPRC;

|DEFBUCLE nomletra0;
#1#1;
;
#0#0;
#0#1;
be;
NULL, empresas;
|FIN;

|PROCESO trabajad;   || viene de bucle de trabajadores y va a calcular
|SI #0#6 = "S";     || segun preguntas
        trabajo = #2#7;
    |HAZ letranif;
    |SI swnif = 0;
        #2#7 = trabajo;
    |FINSI;
|FINSI;
|SI #0#7 = "S";
        trabajo = #2#22;
    |HAZ letranif;
    |SI swnif = 0;  #2#22 = trabajo;  |FINSI;
|FINSI;
|SI #0#8 = "S";
        trabajo = #2#26;
    |HAZ letranif;
    |SI swnif = 0;  #2#26 = trabajo;  |FINSI;
|FINSI;
|GRABA 020#2a;
|LIBERA #2;
|FPRC;

|DEFBUCLE nomletra1;
#2#1;
;
#0#0,#0#2;
#0#1,#0#3;
be;
NULL, trabajad;
|FIN;

|PROCESO impre; |TIPO 3;
|SI #0#4 = "S"; |O #0#5 = "S";
    |ATRI P;
    |MENSA "     Procesando EMPRESAS ... ";
    |ATRI 0;
    |BUCLE nomletra0;
|FINSI;
|SI #0#6 = "S"; |O #0#7 = "S"; |O #0#8 = "S";
    |ATRI P;
    |MENSA "     Procesando TRABAJADORES ... ";
    |ATRI 0;
    |BUCLE nomletra1;
|FINSI;
|FPRC;
