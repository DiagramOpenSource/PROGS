|FICHEROS;
     vipe1003 #0;
     vipe0007 #7;
|FIN;

|VARIABLES;
     aAlfa = "";
     aAlfa1 = "";
     aRutaFich = "";
     aFichero = "";
     aFecha = "";
     fFecha = @;
     aLinea = "";
     aMes = "";
     aHora = "";
     aDia = "";
     aSystem = "";
     nCanal = 0;
|FIN;

|PROCESO GrabaLog;
     aFecha = aLinea % -125
     aFecha = aFecha % 106;

     aMes = aFecha % 103;
     aDia = aFecha % 403;
     |QBT aDia;

     |SI aMes = "Jan"; aMes = "01"; |FINSI;
     |SI aMes = "Feb"; aMes = "02"; |FINSI;
     |SI aMes = "Mar"; aMes = "03"; |FINSI;
     |SI aMes = "Apr"; aMes = "04"; |FINSI;
     |SI aMes = "May"; aMes = "05"; |FINSI;
     |SI aMes = "Jun"; aMes = "06"; |FINSI;
     |SI aMes = "Jul"; aMes = "07"; |FINSI;
     |SI aMes = "Ago"; aMes = "08"; |FINSI;
     |SI aMes = "Sep"; aMes = "09"; |FINSI;
     |SI aMes = "Oct"; aMes = "10"; |FINSI;
     |SI aMes = "Nov"; aMes = "11"; |FINSI;
     |SI aMes = "Dec"; aMes = "12"; |FINSI;

     aDia = ("00" + aDia) % -102;
     aMes = ("00" + aMes) % -102;
     |QBT aDia;

     aFecha = aDia + "." + aMes + "." + "2008";

     aHora = aLinea % -112;
     aHora = aHora % 306;
     aHora = (aHora % 102) + ":" + (aHora % 302) + ":" + (aHora % 502);

     fFecha = aFecha;
     #0#0 = fFecha;
     #0#1 = aHora;

     |GRABA 020#0n;
|FPRC;

|PROGRAMA;
     aAlfa = Usuario; |QBT aAlfa; aAlfa = ("lo" + aAlfa) % 108;
     |NOME_DAT #0 aAlfa;
     |DELINDEX #0;

     |ABRE #0;
     |DFICE aRutaFich;
/*
     aFichero = aRutaFich + "gg*.dat";
     aSystem = "l " + aRutaFich + "gg*.dat > " + aRutaFich + "log.txt";
     |SYSTEM aSystem;
*/
     aFichero = aRutaFich + "log.txt";
     |QBF aFichero;

     |XABRE "U", aFichero, nCanal;
     |SI FSalida ] 0;
          |XLEE nCanal, 100, aLinea;
          |PARA; |SI FSalida > 0; |HACIENDO;
               |QBF aLinea;
               aLinea = aLinea - aRutaFich;
               |HAZ GrabaLog;
               |XLEE nCanal, 100, aLinea;
          |SIGUE;
     |FINSI;
/*
     aAlfa = aRutaFich + "log.txt";
     |FBORRA aAlfa;
*/
     |CONSULTA_CLAVE #1#0;

     |SI FSalida = 0;
          aAlfa = #0#1;
          |QBF aAlfa;
          aAlfa = aAlfa - ":" - ":";
          aAlfa = "gg" + aAlfa;
          |NOME_DAT #7 aAlfa;
          aAlfa1 = "    Pulsar SI para ver el informe o NO para ver el mto. de acumulados ";
          |CONFI aAlfa1;
          |SI FSalida = 0;
               aAlfa1 = "vipe0011.tab;" + aAlfa;
               |SUB_EJECUTA aAlfa1;
          |SINO;
               aAlfa1 = "vipe0006.tab;" + aAlfa;
               |SUB_EJECUTA aAlfa1;
          |FINSI;
     |FINSI;

     |DELINDEX #0;
     |CIERRA #0;
|FPRO;
