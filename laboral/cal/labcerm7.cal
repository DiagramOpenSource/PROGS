|FICHEROS;
     labcerm7 #0;
     labcerm1;
|FIN;

|VARIABLES;
     &aFecha = "";
     aAlfa = "";
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;

     || variables para el calculo de dig. cont. del NAFSS o de la letra del NIF
     &eaVarDni = "";
     &enCalcCif = 0;
     modo = 0;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     nNume = 0;
     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     aNAFSS = "";
     jg = 0;
     sitio = 0;
     corta = 0;
|FIN;

|PROCESO Fecha_m7;
     aFecha = #labcerm7#Campo#;
     |HAZ CompFecha_plb;
|FPRC;

|PROCESO RellenaUno;
     aAlfa = #0#7;
     |QBF aAlfa;
     |SI #0#3 = "X"; |Y aAlfa = "";
          |ABRE #labcerm1;
          #labcerm1#0 = #0#0;
          #labcerm1#1 = #0#1;
          #labcerm1#2 = #0#2;
          |LEE 000#labcerm1.=;
          |CIERRA #labcerm1;

          #0#7 = #labcerm1#23;
          #0#8 = #labcerm1#24;
          #0#9 = #labcerm1#25;
          #0#10 = #labcerm1#30;
          #0#11 = #0#2;

          |PINTA #0#7;
          |PINTA #0#8;
          |PINTA #0#9;
          |PINTA #0#10;
          |PINTA #0#11;
     |FINSI;
|FPRC;

|PROCESO RellenaDos;
     aAlfa = #0#14;
     |QBF aAlfa;
     |SI #0#13 = "X"; |Y aAlfa = "";
          |ABRE #labcerm1;
          #labcerm1#0 = #0#0;
          #labcerm1#1 = #0#1;
          #labcerm1#2 = #0#2;
          |LEE 000#labcerm1.=;
          |CIERRA #labcerm1;

          #0#14 = #labcerm1#3;
          #0#15 = #labcerm1#4;
          #0#16 = #labcerm1#5;
          #0#17 = #labcerm1#10;
          #0#18 = #0#2;

          |PINTA #0#14;
          |PINTA #0#15;
          |PINTA #0#16;
          |PINTA #0#17;
          |PINTA #0#18;
     |FINSI;

     aAlfa = #0#22;
     |QBF aAlfa;
     |SI #0#13 = "X"; |Y aAlfa = "";
          |ABRE #labcerm1;
          #labcerm1#0 = #0#0;
          #labcerm1#1 = #0#1;
          #labcerm1#2 = #0#2;
          |LEE 000#labcerm1.=;
          |CIERRA #labcerm1;

          #0#22 = #labcerm1#23;
          #0#23 = #labcerm1#24;
          #0#24 = #labcerm1#25;
          #0#25 = #labcerm1#30;
          #0#26 = #0#2;

          |PINTA #0#22;
          |PINTA #0#23;
          |PINTA #0#24;
          |PINTA #0#25;
          |PINTA #0#26;
     |FINSI;
|FPRC;

|PROCESO ActivaUno_m7;
     |SI #0nCampo = "S"; |O #0nCampo = "X";
          |CAMPO_MODIFICA #0Campo, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0Campo, 1, "N";
          nCampo1 = Campo;
          nCampo2 = Campo + 1;
          |PDEFECTO #0, nCampo1, nCampo2;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO Activa3_m7; |TIPO 7;
     nCampo = 3;
     |HAZ ActivaUno_m7;
|FPRC;

|PROCESO Activa13_m7; |TIPO 7;
     nCampo = 13;
     |HAZ ActivaUno_m7;
|FPRC;

|PROCESO NIF_m7;
     |SI FSalida = 10;
          eaVarDni = #0Campo;
          enCalcCif = 1;
          |HAZ CalculoDNI;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR;
          |ACABA;
     |FINSI;

     eaVarDni = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     |SI Campo = 26;
          eaVarDni = (eaVarDni + "               ") % 115;
     |SINO;
          eaVarDni = (eaVarDni + "             ") % 112;
     |FINSI;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
/*
     modo = (FEntrada / 100) ! 0;
     alfa1 = #0Campo;
     |QBT alfa1;

     |SI alfa1 = ""; |Y modo ! 4;
         |MENAV "    AVISO !!! Trabajador sin D.N.I. ...";
         |ERROR;
     |FINSI;
*/
|FPRC;

|PROCESO ActDes_m7;
     |SI Campo = 3;
          |SI #0#13 = "X";
               #0#3 = " ";
               |CAMPO_MODIFICA #0#3, 1, "N";
               |PINTA #0#3;
               |HAZ Activa3_m7;
          |SINO;
               |CAMPO_MODIFICA #0#3, 1, "S";
          |FINSI;
     |FINSI;
     |SI Campo = 13;
          |SI #0#3 = "X";
               #0#13 = " ";
               |CAMPO_MODIFICA #0#13, 1, "N";
               |PINTA #0#13;
               |HAZ Activa13_m7;
          |SINO;
               |CAMPO_MODIFICA #0#13, 1, "S";
          |FINSI;
     |FINSI;
     |SI Campo = 20;
          |SI #0#13 = "X";
               |SI #0#21 = "X";
                    #0#20 = " ";
                    |CAMPO_MODIFICA #0#20, 1, "N";
                    |PINTA #0#20;
               |SINO;
                    |CAMPO_MODIFICA #0#20, 1, "S";
               |FINSI;
          |SINO;
               #0#20 = " ";
               |CAMPO_MODIFICA #0#20, 1, "N";
               |PINTA #0#20;
          |FINSI;
     |FINSI;
     |SI Campo = 21;
          |SI #0#13 = "X";
               |SI #0#20 = "X";
                    #0#21 = " ";
                    |CAMPO_MODIFICA #0#21, 1, "N";
                    |PINTA #0#21;
               |SINO;
                    |CAMPO_MODIFICA #0#21, 1, "S";
               |FINSI;
          |SINO;
               #0#21 = " ";
               |CAMPO_MODIFICA #0#21, 1, "N";
               |PINTA #0#21;
          |FINSI;
     |FINSI;
     |SI Campo = 28;
          |SI #0#13 = "X";
               |SI #0#29 = "X";
                    #0#28 = " ";
                    |CAMPO_MODIFICA #0#28, 1, "N";
                    |PINTA #0#28;
               |SINO;
                    |CAMPO_MODIFICA #0#28, 1, "S";
               |FINSI;
          |SINO;
               #0#28 = " ";
               |CAMPO_MODIFICA #0#28, 1, "N";
               |PINTA #0#28;
          |FINSI;
     |FINSI;
     |SI Campo = 29;
          |SI #0#13 = "X";
               |SI #0#28 = "X";
                    #0#29 = " ";
                    |CAMPO_MODIFICA #0#29, 1, "N";
                    |PINTA #0#29;
               |SINO;
                    |CAMPO_MODIFICA #0#29, 1, "S";
               |FINSI;
          |SINO;
               #0#29 = " ";
               |CAMPO_MODIFICA #0#29, 1, "N";
               |PINTA #0#29;
          |FINSI;
     |FINSI;
|FPRC;
