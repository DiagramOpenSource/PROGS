|FICHEROS;
     labclau2;
     labclaus;
     labclau1;
     labcltmp;
     labempre;
     labcentr;
|FIN;

|VARIABLES;
     nClausula = 0;
     nCampo = 0;
     nPaso = 0;

     aAlfa = "";
|FIN;

|PROCESO CompCentro;
     |ABRE #labcentr;
     #labcentr#0 = #labclau2#0;
     #labcentr#1 = #labclau2#1;
     |LEE 000#labcentr.=;
     |SI FSalida ! 0; |Y #labclau2#1 ! 000;
          |MENAV "    El centro no está definido para esta empresa";
          |ERROR;
     |FINSI;
     |CIERRA #labcentr;

     |SI #labclau2#1 = 000;
          #labcentr#2 = "TODOS LOS CENTROS";
          |PINTA 0930, #labcentr#2;
     |FINSI;
|FPRC;

|PROCESO Descripcion;
     |SI nPaso = 1;
          #labcltmp#1 = #labclaus#2;
     |FINSI;
     |SI nPaso = 2; |O nPaso = 3;
          #labcltmp#1 = #labclau1#2;
     |FINSI;
|FPRC;

|PROCESO GrabaClaus;
     |SI nPaso = 1;
          nClausula = #labclaus#1;
     |FINSI;
     |SI nPaso = 2; |O nPaso = 3;
          nClausula = #labclau1#1;
     |FINSI;

     #labcltmp#0 = nClausula;
     |LEE 101#labcltmp.=;
     |SI FSalida = 0;
          |HAZ Descripcion;
          |GRABA 020#labcltmp.a;
     |SINO;
          |HAZ Descripcion;
          |GRABA 020#labcltmp.n;
     |FINSI;
     |LIBERA #labcltmp;
|FPRC;

|DEFBUCLE labclau1_2;
     #labclau1#1;
     ;
     #labclau2#0, #labclau2#1, 0001;
     #labclau2#0, #labclau2#1, 9999;
     ;
     NULL, GrabaClaus;
|FIN;

|DEFBUCLE labclau1;
     #labclau1#1;
     ;
     #labclau2#0, 000, 0001;
     #labclau2#0, 000, 9999;
     ;
     NULL, GrabaClaus;
|FIN;

|DEFBUCLE labclaus;
     #labclaus#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, GrabaClaus;
|FIN;

|PROCESO CargaClaus;
     |ABRE #labcltmp;

     nPaso = 1;
     |BUCLE labclaus;
     nPaso = 2;
     |BUCLE labclau1;
     nPaso = 3;
     |BUCLE labclau1_2;

     |CIERRA #labcltmp;
|FPRC;

|PROCESO CompClaus; |TIPO 0;
     |ABRE #labcltmp;
     #labcltmp#0 = #labclau2#Campo#;
     |LEE 000#labcltmp.=;
     |SI FSalida = 0;
          nCampo = Campo + 1;
          #labclau2#nCampo# = #labcltmp#1;
          |PINTA #labclau2#nCampo#;
     |SINO;
          nCampo = Campo + 1;
          #labclau2#nCampo# = "";
          |PINTA #labclau2#nCampo#;
          |SI #labclau2#Campo# ! 0000;
               |ERROR;
          |FINSI;
     |FINSI;

     |CIERRA #labcltmp;
|FPRC;

|PROCESO ConsultaClaus; |TIPO 66;
     |ABRE #labcltmp;
     |CONSULTA_CLAVE #1#labcltmp;
     |SI FSalida = 0;
          #labclau2#Campo# = #labcltmp#0;
          nCampo = Campo + 1;
          #labclau2#nCampo# = #labcltmp#1;
          |PINTA #labclau2#Campo#;
          |PINTA #labclau2#nCampo#;
     |FINSI;
     |CIERRA #labcltmp;
|FPRC;

|PROCESO Tipo80; |TIPO 80;
     aAlfa = Usuario; |QBT aAlfa; aAlfa = "tm_labcltmp_" + aAlfa;
     |NOME_DAT #labcltmp#aAlfa#;
     |DELINDEX #labcltmp;
|FPRC;

|PROCESO Tipo90; |TIPO 90;
     |DELINDEX #labcltmp;
|FPRC;
