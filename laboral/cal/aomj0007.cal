|FICHEROS;
     aomj0007 #0;
     temp0001@ #500;
     nomcateg;
|FIN;

|VARIABLES;
     aAlfa = "";
     nModo = 0;
     nPos1 = 0;
     nPos2 = 0;
|FIN;

|PROCESO Comprueba; |TIPO 0;
     |ABRE #nomcateg;
     #nomcateg#0 = #0#0;
     #nomcateg#1 = #0#1;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          #0#2 = #nomcateg#2;
          |PINTA #0#2;
     |SINO;
          aAlfa = "    ATENCION: Categoría no Definido en convenio. Pulse F5 ";
          aAlfa = aAlfa + "para consultar.";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO BuscaCat; |TIPO 11;
     |SI FSalida = 13;
          aAlfa = "SELECT nomcateg.1,nomcateg.2 FROM nomcateg INTO tm" + Usuario;
          aAlfa = aAlfa + ".def WHERE 0 == " + #aomj0007#0;
          |SQL aAlfa;
          |SI FSalida ! 0;
               |MENAV "    No hay definidas categorías en el convenio";
               |ERROR;
               |ACABA;
          |FINSI;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/tm" + Usuario + ".mas";
          |CARGA_DEF aAlfa , temp0001@;
          |SI FSalida = 0;
               aAlfa = "tm" + Usuario; |NOME_DAT #500 aAlfa;
               |ABRE #temp0001@;
               nModo = 2 + 4 + 8 + 16;
               nPos1 = 1250; nPos2 = 2380;
               |C_V #temp0001@#0, 1, "S";
               |C_V #temp0001@#1, 1, "S";
               |LINEAL_SIMPLE #1#temp0001@,nModo, nPos1, nPos2, NULL, NULL, NULL;
               |SI FSalida = 0;
                    #aomj0007#1 = #temp0001@#0;
                    |PINTA #aomj0007#1;
                    #aomj0007#2 = #temp0001@#1;
                    |PINTA #aomj0007#2;
               |SINO;
                    |ERROR;
               |FINSI;
               |CIERRA #temp0001@;
               |DELINDEX #temp0001@;
               |DESCARGA_DEF #temp0001@;
          |FINSI;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/tm" + Usuario + ".mas";
          |FBORRA aAlfa;
          |ACABA;
     |FINSI;
|FPRC;
