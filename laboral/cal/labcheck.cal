|FICHEROS;
    labcheck #0;
    labtraba #2;
    labregis #4;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    sw_dupli = 0;
    ant_emp = 0;
    ant_tra = 0;
    falta = "";
    fbaja = "";
    &merror = "";
|FIN;
____________________________________/ CALCULOS DE PANTALLA
|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;
____________________________________/ CHEQUEO
|PROCESO informe;
    #4#1 = #2#0;
    #4#2 = #2#1;
|LEE 000#4=;
|SI FSalida = 0;
    |SI #4#15 = 0;
            falta = #4#7;     fbaja = #4#8;
    |SINO;
            falta = #4#19;    fbaja = #4#20;
    |FINSI;
    |SI falta ! #2#36;|Y #0#4 = "S";
            merror = "Fechas de ALTA: AGINOM1 " + #2#36 + " - AGINOM2 " + falta;
        |PRINT;
    |FINSI;
    |SI fbaja ! #2#37;|Y #0#5 = "S";
            merror = "Fechas de BAJA: AGINOM1 " + #2#37 + " - AGINOM2 " + fbaja;
        |PRINT;
    |FINSI;
    |SI #4#4 ! #2#45;|Y #0#6 = "S";
            merror = "Tipos de CONTRATO: AGINOM1 " + #2#45 + " - AGINOM2 " + #4#4;
        |PRINT;
    |FINSI;
|SINO;
    |SI #0#7 = "S";
            merror = "Sin registro de contratos.";
        |PRINT;
    |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE lee_traba3;
 #2#2;
 0, 1;
 "            ", #0#0, #0#2;
 "zzzzzzzzzzzz", #0#1, #0#3;
 ;
 NULL, informe;
|FIN;

|DEFBUCLE lee_traba2;
 #2#3;
 0, 1;
 "                                        ", #0#0, #0#2;
 "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", #0#1, #0#3;
 ;
 NULL, informe;
|FIN;

|DEFBUCLE lee_traba1;
 #2#1;
 ;
 #0#0, #0#2;
 #0#1, #0#3;
 ;
 NULL, informe;
|FIN;
____________________________________/ COMPRUEBA DUPLICADOS
|PROCESO duplicados1;
|SI ant_emp = #4#1;|Y ant_tra = #4#2;
        sw_dupli = 1;
    |ERROR10;
|FINSI;
    ant_emp = #4#1;
    ant_tra = #4#2;
|FPRC;

|DEFBUCLE duplicados;
 #4#2;
 ;
     1,     1;
 99999, 99999;
 ;
 NULL, duplicados1;
|FIN;

|PROCESO tipo3; |TIPO 3;
|BUCLE duplicados;
|SI sw_dupli = 1;
    |MENAV "    Trabajadores duplicados: ejecute primero /Utilidades/Quitar Duplicados ...";
|SINO;
    |IMPRE 0;
    |SI FSalida = 0;
        |INFOR "labcheck";
        |ABRE #4;
        |SELECT #2#4;
        |SI #0#8 = 1;    |BUCLE lee_traba1;  |FINSI;   || por codigos
        |SI #0#8 = 2;    |BUCLE lee_traba2;  |FINSI;   || por nombre
        |SI #0#8 = 3;    |BUCLE lee_traba3;  |FINSI;   || por dni
        |CIERRA #4;
        |PIEINF;
        |FININF;
    |SINO;
        |MENAV "    Proceso abortado ...";
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;
