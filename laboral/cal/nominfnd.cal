|FICHEROS;
     nominfnd #0;
     nomcalca #1;
     nomhicca;
     labtraba #2;
     labempre #3;
|FIN;

|VARIABLES;
     fFecha = @;
     aFecha = "";
     fFechaRef = @;
     aFechaRef = "";
     fFechaBaja = @;
     aFechaBaja = "";
     nMes = 0;
     aMes = "";
     nAny = 0;
     aAny = "";
|FIN;

|PROCESO Defecto; |TIPO 7;
     fFecha = ~;
     aFecha = fFecha;
     aMes = aFecha % 402;
     aAny = aFecha % -104;
     nAny = aAny;
     nMes = aMes;

     #0#2 = nMes;
     |PINTA #0#2;

     #0#3 = nAny;
     |PINTA #0#3;
|FPRC;

|PROCESO labempre;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;
|FPRC;

|PROCESO labtraba;
     aFechaBaja = #labtraba#37;
     |QBF aFechaBaja;

     |SI aFechaBaja = "";
          |ACABA;
     |FINSI;

     fFechaBaja = aFechaBaja;

     aMes = #0#2; |QBF aMes; aMes = ("00" + aMes) % -102;
     aAny = #0#3;
     aFechaRef = "01." + aMes + "." + aAny;
     fFechaRef = aFechaRef;

     |SI fFechaBaja < fFechaRef;
          |HAZ labempre;
          #nomcalca#0 = #labtraba#0;
          #nomcalca#1 = #labtraba#1;
          #nomcalca#2 = #0#2;
          #nomcalca#3 = 0;
          |LEE 000#nomcalca.=;
          |SI FSalida = 0;
               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#1;
     ;
     #0#0, 00001;
     #0#1, 99999;
     ;
     NULL, labtraba;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |INFOR "nominfnd";
          |ABRE #nomcalca;
          |ABRE #nomhicca;
          |ABRE #labempre;
          |BUCLE labtraba;
          |CIERRA #labempre;
          |CIERRA #nomhicca;
          |CIERRA #nomcalca;
          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRO;
