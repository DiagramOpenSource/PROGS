|FICHEROS;
    nomemppc #0;
    labempre #10;
    labcentr #11;
    nomcenes #12;
     nomtrapc;
|FIN;

|INCLUYE i_coptra;

|PROCESO BuscaEmp;
     |ABRE #labempre;
     #labempre#0 = #0#1;
     |LEE 000#labempre.=;
     |SI FSalida = 0;
          aAlfa = "    ATENCION. La empresa destino ya existe. No es posible ";
          aAlfa = aAlfa + "sobreescribir una empresa existente";
          |MENAV aAlfa;
          aAlfa = "    Si desea utilizar este código, deberá eliminar la empresa destino ";
          aAlfa = aAlfa + "previamente.";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #labempre;
|FPRC;

|PROGRAMA;
|CLS;
|CABEZA "Copiar Trabaj.";
|PINPA #0#0;
|DDEFECTO #0;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0;
        emp_ori = #0#0;
        emp_des = #0#1;
        dtra_ori = 1;
        htra_ori = 99999;
        re_irpf = #0#5;
    |HAZ resto;
    |SI #0#6 = "S";
        |HAZ tipo3;      || copia de trabajadores
    |FINSI;
|FINSI;
|FPRO;

|PROCESO carga_varios;
    tra_ori = #1#1;
    tra_des = tra_ori;
|FPRC;

|PROCESO campos_varios;
|FPRC;

|PROCESO no_irpf; |TIPO 7;
    alfa1 = #0#6;
|CAMPO_MODIFICA #0#5, 1, alfa1;
|FPRC;
____________________________________/
|PROCESO empresa;
|ABRE #10;
    #10#0 = emp_ori;
|LEE 000#10=;
|SI FSalida = 0;
        #10#0 = emp_des;
    |LEE 000#10=;
    |SI FSalida = 0;
        |BORRA 020#10a;
    |FINSI;
        #10#0 = emp_ori;
    |LEE 020#10=;
        #10#0 = emp_des;
    |GRABA 000#10n;
|FINSI;
|CIERRA #10;
|FPRC;

|PROCESO centros1;
    #11#0 = emp_des;
|LEE 000#11=;                    || lee destino
    FEstado = FSalida;
|SI FEstado = 0;
    |BORRA 020#11a;              || borra destino existente
|FINSI;

    #11#0 = emp_des;
|GRABA 000#11n;                  || graba destino

    #11#0 = emp_ori;
|LEE 020#11=;                    || se vuelve a situar
|FPRC;

|DEFBUCLE centros;
 #11#1;
 ;
 emp_ori,   1;
 emp_ori, 999;
 ;
 NULL, centros1;
|FIN;

|PROCESO centros_esp1;
    #12#0 = emp_des;
|LEE 000#12=;                    || lee destino
    FEstado = FSalida;
|SI FEstado = 0;
    |BORRA 020#12a;              || borra destino existente
|FINSI;

    #12#0 = emp_des;
|GRABA 000#12n;                  || graba destino

    #12#0 = emp_ori;
|LEE 020#12=;                    || se vuelve a situar
|FPRC;

|DEFBUCLE centros_esp;
 #12#1;
 ;
 emp_ori,   1, "  ";
 emp_ori, 999, "zz";
 ;
 NULL, centros_esp1;
|FIN;

|PROCESO ActOrigen;
     || por compatibilidad con el incluye
|FPRC;

|PROCESO resto;
|HAZ empresa;
|BUCLE centros;
|BUCLE centros_esp;
|FPRC;
