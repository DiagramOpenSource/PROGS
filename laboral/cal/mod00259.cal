|FICHEROS;
     mod00259 #0;

     labempre;
     labtraba;
     nomcalca;
     nomhicca;
|FIN;

|VARIABLES;
     fFecha = @;
     aAlfa = "";
     nNume = 0;

     &aMes = "";
     &nMes = 0;
     nAnyXX = 0;

     &nLiquido = 0;
     &aTipo = "";
     &aPago = "";
     &aFuente = "";
     nBruto = 0;
     nDeducciones = 0;
|FIN;

|PROCESO Defectos;
     fFecha = ~;
     aAlfa = fFecha;
     aAlfa = aAlfa % -104;
     nNume = aAlfa;
     #0#4 = nNume;
     |PINTA #0#4;

     aAlfa = fFecha;
     aAlfa = aAlfa % 402;
     nNume = aAlfa;
     #0#5 = nNume;
     |PINTA #0#5;
     |HAZ Mes;
|FPRC;

|PROCESO Mes;
     nMes = #0#5;
     |HAZ MesLetra_plb;
     |ATRI I;
     |PINTA 1941, aMes;
     |ATRI 0;
|FPRC;

|PROCESO Historico;
     #labempre#0 = #nomhicca#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomhicca#0;
     #labtraba#1 = #nomhicca#1;
     |LEE 000#labtraba.=;

     |SI #labtraba#70 = "E";
          aPago = "Efectivo";
     |FINSI;
     |SI #labtraba#70 = "T";
          aPago = "Transferencia";
     |FINSI;
     |SI #labtraba#70 = "L";
          aPago = "Tal¢n";
     |FINSI;

     |SI #nomhicca#3 = 0;
          aTipo = "N¢mina";
     |FINSI;
     |SI #nomhicca#3 = 2;
          aTipo = "Finiquito";
     |FINSI;

     aFuente = "Hist¢rico";

     nBruto = #nomhicca#46
     nDeducciones = #nomhicca#48 + #nomhicca#49;
     nDeducciones = nDeducciones + #nomhicca#50 + #nomhicca#51;
     nDeducciones = nDeducciones + #nomhicca#52 + #nomhicca#53;
     nDeducciones = nDeducciones + #nomhicca#54;
     nDeducciones = nDeducciones + #nomhicca#15 + #nomhicca#110 + #nomhicca#111;

     nLiquido = nBruto - nDeducciones;

     |PRINT;

     |SI #nomhicca#47 ! 0;
          nLiquido = #nomhicca#47 - #nomhicca#17 - #nomhicca#128;
          aTipo = "Paga Extra";
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Historico;
     #nomhicca#1;
     ;
     #0#0, #0#2, nAnyXX, #0#5, 0;
     #0#1, #0#3, nAnyXX, #0#5, 2;
     ;
     NULL, Historico;
|FIN;

|PROCESO Mensual;
     #labempre#0 = #nomcalca#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomcalca#0;
     #labtraba#1 = #nomcalca#1;
     |LEE 000#labtraba.=;

     |SI #labtraba#70 = "E";
          aPago = "Efectivo";
     |FINSI;
     |SI #labtraba#70 = "T";
          aPago = "Transferencia";
     |FINSI;
     |SI #labtraba#70 = "L";
          aPago = "Tal¢n";
     |FINSI;

     |SI #nomcalca#3 = 0;
          aTipo = "N¢mina";
     |FINSI;
     |SI #nomcalca#3 = 2;
          aTipo = "Finiquito";
     |FINSI;

     aFuente = "Mensual";

     nBruto = #nomcalca#46
     nDeducciones = #nomcalca#48 + #nomcalca#49;
     nDeducciones = nDeducciones + #nomcalca#50 + #nomcalca#51;
     nDeducciones = nDeducciones + #nomcalca#52 + #nomcalca#53;
     nDeducciones = nDeducciones + #nomcalca#54;
     nDeducciones = nDeducciones + #nomcalca#15 + #nomcalca#71 + #nomcalca#72;

     nLiquido = nBruto - nDeducciones;

     |PRINT;

     |SI #nomcalca#47 ! 0;
          nLiquido = #nomcalca#47 - #nomcalca#17 - #nomcalca#86;
          aTipo = "Paga Extra";
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE Mensual;
     #nomcalca#1;
     ;
     #0#0, #0#2, #0#5, 0;
     #0#1, #0#3, #0#5, 2;
     ;
     NULL, Mensual;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |HAZ Defectos;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #labempre;
          |ABRE #labtraba;

          Impresora = "CrystalReport";
          |IMPRE -1;
          |INFOR "mod00259";
          |BUCLE Mensual;
          nAnyXX = #0#4 - 2000;
          |BUCLE Historico;
          |PIEINF;
          |FININF;
          |FINIMP;

          |CIERRA #labtraba;
          |CIERRA #labempre;
     |FINSI;
|FPRO;
