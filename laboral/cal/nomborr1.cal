|FICHEROS;
     labcentr #01;        || centros de trabajo
     labtraba #02;        || trabajadores
     nomtraca #03;        || trabajadores cabs.
     nomtrali #04;        || trabajadores lins.
     nomvarca #05;        || variaciones cabs.
     nomvarli #06;        || variaciones lins.
     nomcalca #07;        || calculos cabs.
     nomcalli #08;        || calculos lins.
     labempax #09;        || aux.empresas
     labemphi #10;        || aux.empresas hist.
     nomhicca #11;        || historico cabs.
     nomhicli #12;        || historico lins.
     labbasec #13;        || bases cabs.
     labbasel #14;        || bases lins.
     labempre #15;        || Empresas
     nomtraju #16;        || Conceptos excluidos del ajuste
     nomembca;
     nomembli;
     nomembcf;
     nomcal03;
     nomcal04;
     nomhortp;
|FIN;

|VARIABLES;
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;

    aAlfa    = "";

    &em_borr = 0;
    &tr_borr = 0;
    &QuePrograma = 0;
    des_tra = 0;
    has_tra = 0;
    &eaProcedencia = "";
    &nArchi        = 0;
|FIN;
____________________________________/ BASES COTIZACION
|PROCESO basescoti1;
|BORRA 020#13a;
|BUCLELIN 1NULL#13;
|FPRC;

|DEFBUCLE basescoti;
 #13#1;
 ;
 em_borr, des_tra;
 em_borr, has_tra;
 be;
 NULL, basescoti1;
|FIN;
____________________________________/ HISTORICO CALCULOS
|PROCESO historico1;
|BORRA 020#11a;
|BUCLELIN 1NULL#11;
|FPRC;

|DEFBUCLE historico;
 #11#1;
 ;
 em_borr, des_tra,  0,  0,  0;
 em_borr, has_tra, 99, 12, 99;
 be;
 NULL, historico1;
|FIN;
____________________________________/ AUX. EMPRESAS HISTORICO
|PROCESO auxemphi1;
|BORRA 020#10a;
|FPRC;

|DEFBUCLE auxemphi;
 #10#1;
 ;
 em_borr,   0,  0,  0,  0;
 em_borr, 999, 99, 12, 19;
 be;
 NULL, auxemphi1;
|FIN;
____________________________________/ CALCULOS MES
|PROCESO calculos1;
|BORRA 020#7a;
|BUCLELIN 1NULL#7;
|FPRC;

|DEFBUCLE calculos;
 #7#1;
 ;
 em_borr, des_tra,  0, 0;
 em_borr, has_tra, 12, 9;
 be;
 NULL, calculos1;
|FIN;
____________________________________/ VARIACIONES TRABAJADOR
|PROCESO vartraba1;
|BORRA 020#5a;
|BUCLELIN 1NULL#5;
|FPRC;

|DEFBUCLE vartraba;
 #5#1;
 ;
 em_borr, des_tra,  0, 0;
 em_borr, has_tra, 12, 9;
 be;
 NULL, vartraba1;
|FIN;
____________________________________/ AUX.EMPRESAS
|PROCESO auxempre1;
|BORRA 020#9a;
|FPRC;

|DEFBUCLE auxempre;
 #9#1;
 ;
 em_borr,   0,  0,  0;
 em_borr, 999, 12, 19;
 be;
 NULL, auxempre1;
|FIN;
____________________________________/ AUX.TRABAJADOR
|PROCESO auxtraba1;
|BORRA 020#3a;
|BUCLELIN 1NULL#3;
|FPRC;

|DEFBUCLE auxtraba;
 #3#1;
 ;
 em_borr, des_tra;
 em_borr, has_tra;
 be;
 NULL, auxtraba1;
|FIN;
____________________________________/ CONCEPTOS EXCLUIDOS AJUSTE
|PROCESO nomtraju;
|BORRA 020#16a;
|BUCLELIN 1NULL#16;
|FPRC;

|DEFBUCLE nomtraju;
 #16#1;
 ;
 em_borr, des_tra, 101;
 em_borr, has_tra, 499;
 be;
 NULL, nomtraju;
|FIN;

____________________________________/ EMBARGOS
|PROCESO nomembcf;
     |BORRA 020#nomembcf.a;
|FPRC;

|DEFBUCLE nomembcf;
     #nomembcf#1;
     ;
     em_borr, des_tra, 101;
     em_borr, has_tra, 999;
     be;
     NULL, nomembcf;
|FIN;

|PROCESO nomembli;
     |BORRA 020#nomembli.a;
|FPRC;

|DEFBUCLE nomembli;
     #nomembli#1;
     ;
     em_borr, des_tra, 1999;
     em_borr, has_tra, 2999;
     be;
     NULL, nomembli;
|FIN;

|PROCESO nomembca;
     |BORRA 020#nomembca.a;
|FPRC;

|DEFBUCLE nomembca;
     #nomembca#1;
     ;
     em_borr, des_tra;
     em_borr, has_tra;
     be;
     NULL, nomembca;
|FIN;

____________________________________/ HORAS TP

|PROCESO nomhortp;
     |BORRA 020#nomhortp.a;
|FPRC;

|DEFBUCLE nomhortp;
     #nomhortp#1;
     ;
     em_borr, des_tra;
     em_borr, has_tra;
     be;
     NULL, nomhortp;
|FIN;

|PROCESO nomcal04;
     |BORRA 020#nomcal04.a;
|FPRC;

|DEFBUCLE nomcal04;
     #nomcal04#1;
     ;
     em_borr, des_tra, 2000, 01, 01;
     em_borr, has_tra, 2999, 12, 99;
     be;
     NULL, nomcal04;
|FIN;

|PROCESO nomcal03;
     |BORRA 020#nomcal03.a;
|FPRC;

|DEFBUCLE nomcal03;
     #nomcal03#1;
     ;
     em_borr, des_tra, 2000, 01;
     em_borr, has_tra, 2999, 12;
     be;
     NULL, nomcal03;
|FIN;

____________________________________/ TRABAJADOR
|PROCESO trabajador1;
     |BORRA 020#2a;
     |LIBERA #labtraba;

     |SI nArchi = 1;
         || Borrado documentos del GAD;

         aAlfa = "BLAB";                                        || Accion
         aAlfa = aAlfa + ("00000" + #labtraba#0) % -105;        || Empresa
         aAlfa = aAlfa + ("00000" + #labtraba#1) % -105;        || Trabajador
         aAlfa = aAlfa + "00";                                  || Periodo
         aAlfa = aAlfa + "0000";                                || A¤o
         aAlfa = aAlfa + "-1";                                  || Tipo
         aAlfa = aAlfa + "000";                                 || Modelo
         aAlfa = "|:dsarchi/dsarz016;" + aAlfa;
         |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE trabajador;
 #2#1;
 ;
 em_borr, des_tra;
 em_borr, has_tra;
 be;
 NULL, trabajador1;
|FIN;
____________________________________/ CENTROS DE TRABAJO
|PROCESO centro1;
|BORRA 020#1a;
|FPRC;

|DEFBUCLE centro;
 #1#1;
 ;
 em_borr,   0;
 em_borr, 999;
 be;
 NULL, centro1;
|FIN;
____________________________________/ PROCESO PRINCIPAL
|PROGRAMA;
     |HAZ MiraSiArchiva;

     |SI tr_borr = 0;
          |SI eaProcedencia = "labempre";
               des_tra =       1;  has_tra = 99999;
          |SINO;
               des_tra =       0;  has_tra = 0;
          |FINSI;
     |FINSI;

     |SI tr_borr ! 0;  des_tra = tr_borr;  has_tra = tr_borr;  |FINSI;

     |SI QuePrograma = 2;
         |ABRE #15; #15#0 = em_borr; |BORRA 140#15c; |LIBERA #15; |CIERRA #15;
     |FINSI;

     |BUCLE auxtraba;                   || aux. trabajadores
     |BUCLE vartraba;                   || variaciones cabs./lins.
     |BUCLE calculos;                   || calculos cabs./lins.
     |BUCLE historico;                  || historico calculos c./l.
     |BUCLE basescoti;                  || bases cotiz. cabs./lins.
     |SI tr_borr = 0;                                       || BORRADO DE EMPRESA
          |SI eaProcedencia = "labempre";
               |BUCLE centro;                 || centros
               |BUCLE trabajador;             || trabajadores
               |BUCLE auxempre;               || aux. empresas
               |BUCLE auxemphi;               || aux. empresas hist.
          |FINSI;
     |SINO;
         |SI nArchi = 1;
               || Borrado documentos del GAD;

               aAlfa = "BLAB";                                    || Accion
               aAlfa = aAlfa + ("00000" + em_borr) % -105;        || Empresa
               aAlfa = aAlfa + ("00000" + tr_borr) % -105;        || Trabajador
               aAlfa = aAlfa + "00";                              || Periodo
               aAlfa = aAlfa + "0000";                            || A¤o
               aAlfa = aAlfa + "-1";                              || Tipo
               aAlfa = aAlfa + "000";                             || Modelo
               aAlfa = "|:dsarchi/dsarz016;" + aAlfa;
               |SUB_EJECUTA aAlfa;
          |FINSI;
     |FINSI;

     |BUCLE nomtraju;                   || conceptos excluidos ajustes
     |BUCLE nomembca;                   || embargos: cabecera
     |BUCLE nomembli;                   || embargos: lineas
     |BUCLE nomembcf;                   || embargos: configuracion
     |BUCLE nomcal03;                   || horas TP: cabecera
     |BUCLE nomcal04;                   || horas TP: lineas
     |BUCLE nomhortp;                   || horas TP: calendario
|FPRO;
