|FICHEROS;
     labacu14 #0;

     labempre #1;
     :integral/dsam0103 #2;
     nomconca #3;

     labacu16;
|FIN;

|VARIABLES;
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     nCampo1 = 0;
     nCampo2 = 0;
     nModo = 0;
     nCNAE = 0;
|FIN;

|PROCESO Activ; |TIPO 66;
     aAlfa = #0#33;
     |QBF aAlfa;
     |SI aAlfa = "";
          #0#33 = #labempre#128;
     |FINSI;
     |HAZ SacaVentana;
|FPRC;

|PROCESO Comp33;
     aAlfa = #0#33;
     |QBF aAlfa;
     |SI aAlfa = "";
          |MENAV "    Es necesario rellenar el campo Código CNAE de la actividad de la empresa.";
          |MENAV "    Elija una actividad de la tabla a continuación.";
          |HAZ Activ;
     |FINSI;
|FPRC;

|PROCESO CampoNomconca;
     aAlfa1 = #0nCampo1;
     |QBF aAlfa1;
     |SI aAlfa1 = "";
          #0nCampo1 = #nomconca#nCampo2#;
     |FINSI;
     |PINTA #0nCampo1;
|FPRC;

|PROCESO CampoLabempre;
     aAlfa1 = #0nCampo1;
     |QBF aAlfa1;
     |SI aAlfa1 = "";
          #0nCampo1 = #labempre#nCampo2#;
     |FINSI;
     |PINTA #0nCampo1;
|FPRC;

|PROCESO CampoIntegral;
     aAlfa1 = #0nCampo1;
     |QBF aAlfa1;
     |SI aAlfa1 = ""; |O aAlfa1 = "0";
          #0nCampo1 = #2nCampo2;
     |FINSI;
     |PINTA #0nCampo1;
|FPRC;

|PROCESO RellenaDatos;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;
          |ACABA;
     |FINSI;
     |ABRE #labempre;
     |ABRE #nomconca;
     |ABRE #2;

     #labempre#0 = #0#0;
     |LEE 000#labempre.=;
     |SI FSalida = 0;
          #2#0 = #labempre#10;
          |LEE 000#2=;
          |SI FSalida = 0;
               nCampo1 = 15; nCampo2 = 10; |HAZ CampoLabempre;
               nCampo1 = 16; nCampo2 = 13; |HAZ CampoLabempre;
               nCampo1 = 17; nCampo2 = 2;  |HAZ CampoLabempre;
               nCampo1 = 35; nCampo2 = 15; |HAZ CampoLabempre;
               nCampo1 = 36; nCampo2 = 17; |HAZ CampoLabempre;

               nCampo1 = 18; nCampo2 = 9; |HAZ CampoIntegral;
               nCampo1 = 19; nCampo2 = 2; |HAZ CampoIntegral;
               nCampo1 = 20; nCampo2 = 3; |HAZ CampoIntegral;
               nCampo1 = 21; nCampo2 = 16;|HAZ CampoIntegral;
               nCampo1 = 22; nCampo2 = 10;|HAZ CampoIntegral;
               nCampo1 = 23; nCampo2 = 11;|HAZ CampoIntegral;
               nCampo1 = 24; nCampo2 = 4; |HAZ CampoIntegral;
               nCampo1 = 25; nCampo2 = 5; |HAZ CampoIntegral;
               nCampo1 = 26; nCampo2 = 6; |HAZ CampoIntegral;
               nCampo1 = 27; nCampo2 = 7; |HAZ CampoIntegral;
               nCampo1 = 28; nCampo2 = 8; |HAZ CampoIntegral;
               aAlfa = #0nCampo1;
               |QBF aAlfa;
               |SI aAlfa = "";
                    nCampo1 = 28; nCampo2 = 111; |HAZ CampoLabempre;
               |FINSI;
               nCampo1 = 29; nCampo2 = 17;|HAZ CampoIntegral;

               nCampo1 = 30; nCampo2 = 130; |HAZ CampoLabempre;

               nCampo1 = 33; nCampo2 = 12; |HAZ CampoLabempre;
               aAlfa1 = #0nCampo1; |QBF aAlfa1;
               #0nCampo1 = ""; |PINTA #0nCampo1;
               nCNAE = aAlfa1;
               |SI nCNAE > 0001;
                    #0nCampo1 = aAlfa1 % 104; |PINTA #0nCampo1;
               |FINSI;

               nCampo1 = 34; nCampo2 = 12; |HAZ CampoLabempre;
               aAlfa1 = #0nCampo1; |QBF aAlfa1;
               |SI nCNAE > 0001;
                    #0nCampo1 = aAlfa1 % 799; |PINTA #0nCampo1;
               |SINO;
                    #0nCampo1 = aAlfa1; |PINTA #0nCampo1;
               |FINSI;

               #nomconca#0 = #labempre#1;
               |LEE 000#nomconca.=;
               |SI FSalida = 0;
                    nCampo1 = 31; nCampo2 = 142; |HAZ CampoNomconca;
                    nCampo1 = 32; nCampo2 = 1; |HAZ CampoNomconca;
               |FINSI;

               aAlfa = #labempre#113 % 104; #0#37 = aAlfa; |PINTA #0#37;
               aAlfa = #labempre#113 % 504; #0#38 = aAlfa; |PINTA #0#38;
               aAlfa = #labempre#113 % 902; #0#39 = aAlfa; |PINTA #0#39;
               aAlfa = #labempre#113 % 1110; #0#40 = aAlfa; |PINTA #0#40;
          |FINSI;
     |FINSI;

     |CIERRA #2;
     |CIERRA #nomconca;
     |CIERRA #labempre;
|FPRC;

|PROCESO Tipo20_14; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Imprimir";
     |SINO;
          aAlfa = #0#0; |QBF aAlfa;
          aAlfa = ("00000" + aAlfa) % -105;
          aAlfa = "labacu11;DOC" + aAlfa;
          |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|PROCESO ActivaCamposPan1; |TIPO 13;
     |DDEFECTO #labacu16;
     |ABRE #labacu16; |LEE 000#labacu16.p; |CIERRA #labacu16;
     |SI #labacu16#1 = "S";
          |CAMPO_MODIFICA #0#1, 1, "S";
          |CAMPO_VISUAL #0#1, 1, "S";
          |PINTA 0766, "Orden:      ";
          |PINTA #0#1;
     |SINO;
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_VISUAL #0#1, 1, "N";
          |PINTA 0766, "            ";
     |FINSI;
|FPRC;

|PROCESO ActivaCamposPan2; |TIPO 14;
     |DDEFECTO #labacu16;
     |ABRE #labacu16; |LEE 000#labacu16.p; |CIERRA #labacu16;
     |SI #labacu16#1 = "S";
          |ATRI R;
          |PINTA 0773, #0#1;

          |CAMPO_MODIFICA #0#9, 1, "S";
          |CAMPO_VISUAL #0#9, 1, "S";
          |ATRI 0;
          |ATRI 0;
          |PINTA 1604, "Importe cotizado por FP el a¤o anterior ....:            ";
          |ATRI R;
          |PINTA #0#9;

          |CAMPO_MODIFICA #0#10, 1, "S";
          |CAMPO_VISUAL #0#10, 1, "S";
          |ATRI 0;
          |PINTA 1704, "Plantilla media de trabajadores a¤o anterior:            ";
          |ATRI R;
          |PINTA #0#10;

          |CAMPO_MODIFICA #0#11, 1, "S";
          |CAMPO_VISUAL #0#11, 1, "S";
          |ATRI 0;
          |PINTA 1804, "Cr‚dito para la formaci¢n continua .........:            ";
          |ATRI R;
          |PINTA #0#11;

          |ATRI I;
     |SINO;
          |CAMPO_MODIFICA #0#9, 1, "N";
          |CAMPO_VISUAL #0#9, 1, "N";
          |PINTA 1604, "                                                         ";

          |CAMPO_MODIFICA #0#10, 1, "N";
          |CAMPO_VISUAL #0#10, 1, "N";
          |PINTA 1704, "                                                         ";

          |CAMPO_MODIFICA #0#11, 1, "N";
          |CAMPO_VISUAL #0#11, 1, "N";
          |PINTA 1804, "                                                         ";
     |FINSI;
|FPRC;
