|FICHEROS;
    nomactva #00;
    labtraba #01;
    nomtraca #02;  || traba.cabs.
    nomtrali #03;  || traba.lins.
    nomcatca #04;  || categ.cabs.
    nomcatli #05;  || categ.lins.
    nomtraac #06;  || traba.cabs.atrasos
    nomtraal #07;  || traba.lins.atrasos
    nomcatac #08;  || categ.cabs.atrasos
    nomcatal #09;  || categ.lins.atrasos
    nomcateg #10;  || categorias
|FIN;

|VARIABLES;
 FEstado = 0;
 nume = 0;
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    fecsys = @;
    alfa1 = "";
    alfa2 = "";
|FIN;

||************************************************************************
||                CALCULOS DESDE EL MANTENIMIENTO
||************************************************************************

|PROCESO pase; |TIPO 3;
|SI #0#0 = "T";
    |HAZ auxtrab;
|SINO;
    |HAZ auxcate;
|FINSI;
|FPRC;

|PROCESO nomodi; |TIPO 7;
|SI #0#0 = "C";
    |HAZ nomodifi;
|FINSI;
|FPRC;

|PROCESO nomodifi;             || RUTINA DE CONVERSION A NO MODIFICABLES
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;

||************************************************************************
||                ACTUALIZACION TRABAJADORES
||************************************************************************

|PROCESO cabtraba;  || Cabecera Auxiliares Trabajadores
    #2#0 = #1#0;
    #2#1 = #1#1;
|LEE 140#2=;
|SI FSalida ! 0;
        #2#0 = #1#0;
        #2#1 = #1#1;
        #2#2 = #1#2;
    |GRABA 020#2n;
|FINSI;
|LIBERA #2;
|PINTA 1466,#1#0;
|PINTA 1566,#1#1;
|PINTA 1966,#1#87;
|PINTA 2066,#1#17;
|BUCLELIN 0lintraba#6;
|FPRC;

|PROCESO lintraba;   || Linea Auxiliares Trabajadores
|SI #7#2 ] #0#10; |Y #7#2 [ #0#11; |Y #7#5 ] #0#12; |Y #7#5 [ #0#13;
        #3#0 = #7#0;
        #3#1 = #7#1;
        #3#2 = #7#2;
    |LEE 140#3=;
        FEstado = FSalida;
    |SI FSalida ! 0;   |DDEFECTO #3;   |FINSI;
        #3#0 = #7#0;
        #3#1 = #7#1;
        #3#2 = #7#2;
        nume = #3#4;
    |SI #7#3 = "+";
            nume = nume + #7#4;
    |SINO;
            nume = nume - #7#4;
    |FINSI;
        alfa1 = nume;  alfa1 = "            " + nume;  alfa1 = alfa1 % -112;
        #3#4 = alfa1;
    |SI FEstado ! 0; |GRABA 020#3n;  |FINSI;
    |SI FEstado = 0; |GRABA 020#3a;  |FINSI;
    |LIBERA #3;
|FINSI;
|LIBERA #7;
|FPRC;

|DEFBUCLE nomactva1;
#6#1;
;
#1#0,#1#1, #0#12;
#1#0,#1#1, #0#13;
e;
NULL, cabtraba;
|FIN;

|PROCESO trabajad;
|BUCLE nomactva1;
|FPRC;

|DEFBUCLE nomactva0;
#1#1;
87,17,44;
#0#1, #0#3, #0#5, #0#7, AA;
#0#2, #0#4, #0#6, #0#8, AA;
e;
NULL,trabajad;
|FIN;

|PROCESO auxtrab;  || Calculo para Auxiliares de Trabajadores
|ABRE #2;
|ABRE #3;
|ABRE #6;
|BUCLE nomactva0;
|CIERRA #2;
|CIERRA #3;
|CIERRA #6;
|FPRC;

||***********************************************************************
||                ACTUALIZACION CATEGORIAS
||************************************************************************

|PROCESO cabcate;  || Cabecera Auxiliares Categorias
    #10#0 = #8#0;
    #10#1 = #8#1;
|LEE 140#10=;
|SI FSalida = 0;
        #4#0 = #8#0;
        #4#1 = #8#1;
    |LEE 140#4=;
    |SI FSalida ! 0;
            #4#0 = #8#0;
            #4#1 = #8#1;
            #4#2 = #10#2;
        |GRABA 020#4n;
    |FINSI;
    |LIBERA #4;
    |PINTA 1666,#8#0;
    |PINTA 1766,#8#1;
    |BUCLELIN 0lincate#8;
|FINSI;
|LIBERA #10;
|FPRC;

|PROCESO lincate;   || Linea Auxiliares Categorias
|SI #9#2 ] #0#10; |Y #9#2 [ #0#11; |Y #9#5 ] #0#12; |Y #9#5 [ #0#13;
        #5#0 = #9#0;
        #5#1 = #9#1;
        #5#2 = #9#2;
    |LEE 140#5=;
        FEstado = FSalida;
    |SI FSalida ! 0;   |DDEFECTO #5;   |FINSI;
        #5#0 = #9#0;
        #5#1 = #9#1;
        #5#2 = #9#2;
        nume = #5#4;
    |SI #9#3 = "+";
            nume = nume + #9#4;
    |SINO;
            nume = nume - #9#4;
    |FINSI;
        alfa1 = nume;  alfa1 = "            " + nume;  alfa1 = alfa1 % -112;
        #5#4 = alfa1;
    |SI FEstado ! 0; |GRABA 020#5n;  |FINSI;
    |SI FEstado = 0; |GRABA 020#5a;  |FINSI;
    |LIBERA #5;
|FINSI;
|LIBERA #9;
|FPRC;

|DEFBUCLE nomactva2;
#8#1;
;
#0#5, #0#7, #0#12;
#0#6, #0#8, #0#13;
e;
NULL,cabcate;
|FIN;

|PROCESO auxcate; || Calculo para Auxiliares de Categorias
|ABRE #4;
|ABRE #5;
|ABRE #10;
|BUCLE nomactva2;
|CIERRA #4;
|CIERRA #5;
|CIERRA #10;
|FPRC;
