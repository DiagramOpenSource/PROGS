|FICHEROS;
    nomhempr #0;         || hist. empresas IRPF y TC1
|FIN;

|VARIABLES;
    nume1 = 0;
    nume2 = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    fech1 = @;

    dia1   = "";
    mes1   = "";
    any1   = "";
    fec    = "";
    sw     = 0;
    dia    = 0;
    mes    = 0;
    any    = 0;
    tope   = 0;
    mod    = 0;
|FIN;

|PROCESO defecto; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
    #0Campo = #0Campo - 1;
|PINTA #0Campo;
|FPRC;

|PROCESO verifech; |TIPO 0;
fec = #0Campo;
sw  = 0;

|SI fec = "          "; |ACABA; |FINSI;
|SI fec = ".........."; |ACABA; |FINSI;

dia1 = fec % 102;
mes1 = fec % 402;
any1 = fec % 704;

dia  = dia1;
mes  = mes1;
any  = any1;

|SI dia ! 0; |Y mes ! 0; |Y any ! 0;
    |SI mes [ 12; |Y mes ] 1;
        |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
            tope = 31;
        |SINO;
            |SI mes = 2;
                mod = any $ 4;
                |SI mod = 0; tope = 29; |SINO; tope = 28; |FINSI;
            |SINO;
                tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope; sw = 1; |FINSI;
    |FINSI;
|FINSI;

|SI sw = 0;
    |MENAV "0000ATENCION !!! Fecha erronea ...";
    |ERROR;
|FINSI;
|FPRC;
