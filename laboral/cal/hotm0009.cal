|FICHEROS;
     hotm0009 #0;
     hotm0010 #1;

     hotm0012 #2;
     hotm0013 #3;
|FIN;

|VARIABLES;
     nModo=0;
     fFecha=@;
     aCadena="";
     aAnyo="";
     aMes="";
     nDias = 0;
|FIN;


|PROCESO PonAnyoMes; |TIPO 7;
     fFecha=~;
     aCadena=fFecha;
     aAnyo=aCadena %  -104;
     aMes=aCadena %  402;
     #0#2=aAnyo;
     #0#3=aMes;
|FPRC;


|PROCESO PMeteLineas;
     |DDEFECTO #1;
     #1#0=#0#0;
     #1#1=#0#1;
     #1#2=#0#2;
     #1#3=#0#3;
     #1#4=#3#2;
     #1#5=#3#3;
     #1#6=#3#4;
     #1#7=#3#5;
     #1#8=#3#6;
     #1#9=#3#7;
     #1#10=#3#8;
     #1#11=#3#9;
     #1#12=#3#10;
     |SI #1#12 ! 0;
        #0#4 = #0#4 + #1#11; |PINTA #0#4;
        #0#5 = #2#3;
     |FINSI;

     |GRABA 020#1n;
|FPRC;

|PROCESO CuentaDias;
     nDias = nDias + #1#12
|FPRC;

|DEFBUCLE CuentaDias;
     #1#1;
     ;
     #0#0, #0#1, #0#2, #0#3, 001;
     #0#0, #0#1, #0#2, #0#3, 999;
     ;
     NULL, CuentaDias;
|FIN;

|PROCESO ActDias; |TIPO 0;
     nModo = (FEntrada/ 100) ! 0;
     |SI nModo = 2; |O nModo = 4;
     || en consulta tambien por si entraran por los botones de abajo
          nDias = 0;
          |BUCLE CuentaDias;
          |LEE 000#0=;
          |SI FSalida = 0;
               #0#5 = nDias;
               |GRABA 000#0a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE BMeteLineas;
     #3#1;
     ;
     #0#0,#0#1,000;
     #0#0,#0#1,999;
     ;
     NULL,PMeteLineas;
|FIN;

|PROCESO PonDatos; |TIPO 0; || mete por defecto los datos de planilla
     nModo = (FEntrada/100)!0;
     |SI nModo = 1;
          |ABRE #0;
          |LEE 000#0=;
          |SI FSalida!0;  || si no existen datos
               #2#0=#0#0;
               #2#1=#0#1;
               |ABRE #2;
               |LEE 000#2=;
               |SI FSalida=0;
                    #0#6=#2#2;
                    |PINTA #0#4;

                    |ABRE #1;
                    |BUCLE BMeteLineas;
                    |CIERRA #1;
               |FINSI;
               |CIERRA #2;
          |FINSI;
          |CIERRA #0;
     |FINSI;
|FPRC;
