|FICHEROS;
     nomtraca #0;
     labempre #1;
     nom900de;
     nom900dt;
     labtraba;
     nomconli;
     nomdesam;
|FIN;

|VARIABLES;
     aParam = "";
     nEmp = 0;
     nTra = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     FEstado = 0;
     &swModulo = 0;
     nConvenio = 0;
     aAlfa = "";
|FIN;

|PROCESO QuitaCero; |TIPO 7;
|SI #0#3 = 0;
    |DDEFECTO #1;
    |ABRE #1;
    #1#0 = #0#0;
    |LEE 000#1=;
    #0#3 = #1#32;
    |PINTA #0#3;
    |CIERRA #1;
|FINSI;
|FPRC;

|PROCESO Borra949;
     |ABRE #nom900de;
     #nom900de#0 = 20;
     |LEE 101#nom900de.=;
     |SI FSalida = 0;    || existe concepto 949, en el numero de orden 20
                         || solo quiero que lo vea ADADE
          |HAZ BuscaModulo;
          |SI swModulo ! 2884; |Y swModulo ! 1;
               |BORRA 020#nom900de.a;
          |FINSI;
     |FINSI;
     |LIBERA #nom900de;
     |CIERRA #nom900de;
|FPRC;

|PROCESO nomconli_900;
     |DDEFECTO #nom900dt;
     #nom900dt#0 = #nomconli#2 - 920;
     #nom900dt#1 = #nomconli#2;

     #nomdesam#0 = #nomconli#0;
     #nomdesam#1 = #nomconli#2;
     |LEE 000#nomdesam.=;
     |SI FSalida = 0;
          #nom900dt#2 = #nomdesam#2;
     |FINSI;

     #nom900dt#3 = #nomconli#6;

     |GRABA 020#nom900dt.n;
|FPRC;

|DEFBUCLE nomconli_900;
     #nomconli#1;
     ;
     nConvenio, 951;
     nConvenio, 960;
     ;
     NULL, nomconli_900;
|FIN;

|PROCESO nom900de;
     #nom900dt#0 = #nom900de#0;
     #nom900dt#1 = #nom900de#1;
     #nom900dt#2 = #nom900de#2;
     #nom900dt#3 = #nom900de#3;
     |GRABA 020#nom900dt.n;
|FPRC;

|DEFBUCLE nom900de;
     #nom900de#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, nom900de;
|FIN;

|PROCESO Carga900; |TIPO 5;
     aAlfa = Usuario; |QBT aAlfa; aAlfa = "tm_nom900dt_" + aAlfa;
     |NOME_DAT #nom900dt#aAlfa#;
     |DELINDEX #nom900dt;
     |ABRE #nom900dt;
     |ABRE #nomdesam;

     nConvenio = #labtraba#87;
     |BUCLE nom900de;
     |BUCLE nomconli_900;

     |CIERRA #nomdesam;
     |CIERRA #nom900dt;
|FPRC;

|PROGRAMA;
     |HAZ Borra949;

     aParam = PARAMETRO;
     |QBF aParam;
     |CLS;
     |SI aParam = "";
          |MANTE #0;
     |SINO;
          aAlfa1 = aParam % 105;
          aAlfa2 = aParam % -105;
          nEmp = aAlfa1;
          nTra = aAlfa2;

          |PINPA #0#nomtraca;
          |DDEFECTO #nomtraca;
          |ABRE #nomtraca;
          #nomtraca#0 = nEmp;
          #nomtraca#1 = nTra;
          |LEE 101#nomtraca.=;
          FEstado = FSalida;

          |PINDA #0#nomtraca;
          |ENDATOS #1#nomtraca;
          |SI FSalida = 0;
               |SI FEstado = 0;    |GRABA 020#nomtraca.a;     |FINSI;
               |SI FEstado ! 0;    |GRABA 020#nomtraca.n;     |FINSI;
          |FINSI;
          |LIBERA #nomtraca;
          |CIERRA #nomtraca;
     |FINSI;
|FPRO;
