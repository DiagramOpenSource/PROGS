|FICHEROS;
     nomcreaf #0;

     tsilco14,MANTE;      || tmp. parrilla empresas
     tsilco15,MANTE;      || tmp. parrilla trabajadores

     labempre #10;        || empresas
     labtraba #12;        || trabajadores
     labcentr #16;        || centros de trabajo
     nomcenes #17;        || centros de trabajo especiales

     nomcalca;            || calculos cabs. (proceso mensual)
     nomhicca #19;        || calculos cabs. (proceso historico)

     silcon06;            || empresas Sistema RED
     nomcontr #36;        || control aplicacion

     nomconca;
     silcon13;

     nomcal03;
     nomcal04;

     nomtrcal;
     gomdetjr;
     nomvarca;
|FIN;

|VARIABLES;
     fech1 = @;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     nume1 = 0;
     nume2 = 0;
     enAny = 0;
     p_mes = 0;
     traba = 0;
     nMarcarT = 0;
     nMarcarE = 0;
     sw_parrilla = 0;
     aAviso = "";
     FEstado = 0;
     clave = "";
     sw_auxil = 0;
     linea = 0;
     aRegimen = "";
     aAlfa = "";
     aAlfa0 = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     aLibre = "";
     aReser = "";
     for_fecha = "";
     for_hora = "";
     fichero = "";
     extension = "";
     indica = "";
     swStop = 0;
     nEmp = 0;
     nTra = 0;
     any_hist = 0;
     tipo_bot = 0;
     tipo_top = 0;
     nElAny = 0;
     nElMes = 0;
     enDesCen = 0;
     enHasCen = 0;
     eaFuente = "";

     ajuste1 = "";
     ajuste2 = "";
     ajuste3 = "";
     alfa = "";
     error = 0;
     ind = 0;
     long = 0;
     posi = 0;
     digito = "";
     texto = "";
     mascara = "";
     i = 0;
     j = 0;
     nCampo = 0;
     nTipo = 0;
     nTipoNominas = 0;
     descom = "";
     entero = "";
     decima = "";
     elsw1 = 0;
     para1 = 0;
     nNume = 0;
     cadena = "";
     swRepite = 0;
     aCCC = "";
     nConcepto = 0;
     nConceptoRED = 0;
     nImporte = 0;
     nConvenio = 0;
     aIndicativo = "";
     aDescripcion = "";
     aTipoPaga = "";
     nUnidades = 0;
     nUnidadesCal = 0;
     nPrecio = 0;
     nBrutoMenosPrest = 0;
     nMesAtrasos = 0;
     nDesdeMes = 0;
     nHastaMes = 0;
     nMesHist = 0;
     swSigue = 0;
     aAntNroAfil = "";
     aAntCCC ="";
     aAntCen ="";
     nNroEmpresas = 0;
     nNroTrabaj = 0;
     nAntEmp = 0;
     nBrutoTrab = 0;
     nPagasProrr = 0;

     &s_ori = "";
     &s_tat = 0;
     &s_ele = "";
     &s_any = 0;
     &s_mes = 0;
     &s_has = 0;
     &s_anyl = 0;
     &s_sel = "";
     &s_lotecra = 0;
     &s_fichcra = "";

     nNroTras = 0;
     nAntEmpCon = 0;
     nTotEmp = 0;
     nImporteFin = 0;

     aCadena = "";
     aCadenaSal = "";
     nEspacio = 0;
     aLon = "";
     nLon = 0;
     nBlancos = 0;
     nBlancosIzd = 0;
     nBlancosDer = 0;
     aBlancosIzd = "";
     aBlancosDer = "";

     &s_num = 0;
     &s_fich = "";
     topemes = 0;
     nMes = 0;
     aMes = "";
     aAny = "";
     aFecha = "";
     fIniMes = @;
     fFinMes = @;
     fFechaIniMes = @;
     fFechaFinMes = @;
     nFechaIniMes = 0;
     nFechaFinMes = 0;
     aFechaIniMes = "";
     aFechaFinMes = "";
     fFechaAlta = @;
     fFechaBaja = @;
     nFechaAlta = 0;
     nFechaBaja = 0;
     nNume1 = 0;
     nNume2 = 0;
     nDias = 0;
     nDiasAlta = 0;
     &enLote = 0;
     &eaFich = "";
     &eaExt = "";
     swPosibleError = 0;
     nDesdeTra = 0;
     nHastaTra = 0;
     swHayAlguno = 0;
     nAny = 0;
     nAnyXX = 0;
     aCentroNom = "":
     fFechaIniPer = @;
     fFechaFinPer = @;
     aFechaIniPer = "";
     aFechaFinPer = "";

     fFechaIniTramo = @;
     nFechaIniTramo = 0;
     aFechaIniTramo = "";
     fFechaFinTramo = @;
     nFechaFinTramo = 0;
     aFechaFinTramo = "";

     nBase = 0;
     nLinea = 0;
     aLinea = "";
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;
     aTipo = "";
     nDesde = 0;
     nHasta = 0;
     nCodTipo = 0;
     aDesTipo = "";
     swDesde = 0;
     swHasta = 0;
     aFechaBusca = "";
     fFechaBusca = @;
     aContrato = "";
     nGrupoCot = 0;
     nCategoria = 0;
     aOcupacion = "";
     nHoras = 0;
     aNif = "";
     nVez = 0;
     nFechaIniPer = 0;
     nFechaFinPer = 0;
     nBonifMan = 0;
     nBonifFom = 0;
     aFechaIniBon = "";
     fFechaIniBon = @;
     aFechaFinBon = "";
     fFechaFinBon = @;
     swGraba = 0;
     swGrabado = 0;
     swPrest = 0;
     fFecha = @;
     nFecha = 0;
     nUltima = 0;
     aNAFSS = "";
     nLineaAjuste = 0;
     nUltimoTramoAlta = 0;
     nUltimoTramoIT = 0;
     nCodTipoAnt = 0;
     nLineaAnt = 0;
     nDiasCot = 0;
     aFechaAlta = "";
     aFechaBaja = "";
     swMarca52 = 0;
     swRegrabado = 0;
     swHay = 0;

     nBaseComunes_Alta = 0;
     nBaseATEP_Alta = 0;
     nBaseEnfAcc = 0;
     nBaseMat = 0;
     nBasePat = 0;
     nBaseRie = 0;
     nBaseCon = 0;
     nBaseERE = 0;
     nBaseHorasFM = 0;
     nBaseHorasOtras = 0;
     nNumHorasComp = 0;
     aSituacion = "";
     nCodigo = 0;
     nUltimoCodigo = 0;

     nDiasEnf = 0;
     nDiasAcc = 0;
     nDiasMat = 0;
     nDiasPat = 0;
     nDiasRie = 0;
     nDiasCon = 0;
     nDiasERE = 0;
     nPropERE = 0;
     aUltimaIT = "";
     nAjuste = 0;
     nDiasCotAlta = 0;
     nDiasCotIT = 0;
     nPrestEnf = 0;
     nPrestAcc = 0;
     nBases = 0;
     nDiasTramo = 0;
     nDiasNatTramo = 0;
     nPropTramo = 0;
     swPrest52 = 0;
     swPrest53 = 0;
     nPromedioCC = 0;
     nPromedioATEP = 0;
     nBaseDiariaERE = 0;
     nDiasMesTrab = 0;
     nDiaIT = 0;
     nDiasAcumIT = 0;
     nDiasAcumEnf = 0;
     nDias60 = 0;
     nDias75 = 0;
     nHastaReal = 0;
     nIndicador = 0;
     nCodigoHoras = 0;
     swTopeMin = 0;
     nNumHorasFor = 0;
     aTipoHorasFor = "";
     nAcumHorasFor = 0;
     nAcumHorasComp = 0;

     swCuenta = 0;
     nTrabEmp = 0;
     nTotalTra = 0;
     aTotalTra = "";
     nNroTra = 0;
     nTotalEmp = 0;
     aTotalEmp = "";
     nNroEmp = 0;
     swFinPeriodo = 0;
     swUltimoDiaIT = 0;

     nDiasAltaNIF = 0;
     fFecha1 = @;
     fFecha2 = @;
     nFecha1 = 0;
     nFecha2 = 0;
     nNroCCCs = 0;
     nCodigoIniIT = 0;
     nCodigoFinIT = 0;

     nJornadasIT = 0;
     nPrestManEnf = 0;
     nPrestManAcc = 0;

     swDiferente = 0;
     nMesAnt = 0;
     swIniPeriodo = 0;
     swTramoUnSoloDia = 0;
     nDiasRecaida = 0;
     swCentroFormacion = 0;

     nDesdeTipo = 0;
     nHastaTipo = 0;
     nDiasVac1 = 0;
     nDiasVac2 = 0;

     nDias99 = 0;  || para las L13
     nMes99 = 0;
     nAny99 = 0;

     nBonifFormCont = 0;
     swAsignada = 0;

     nDiaDesde = 0;
     nDiaHasta = 0;
     fFechaHastaTra = @;
     fFechaHastaPer = @;
     nDiaHastaMasUno = 0;

     nEmpAnt = 0;
     nTraAnt = 0;
     red_ultimo = 0;
     &aParam = "";

     numer = 0;
     anynum = 0;
     mesnum = 0;
     bisiesto = 0;
     aAnyo = "";
     aCalendario = "";
     nDia = 0;
     nCampoDia = 0;
|FIN;

/****************************************************************************/
/****************      PROCESOS DESDE LA PANTALLA   *************************/
/****************************************************************************/

|PROCESO Mensa_21_2; |TIPO 7;
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          |MENSA "    Opciones: (N) todas las nominas calculadas en el periodo; (S) Seleccionar";
     |FINSI;
     |SI aParam = "CONVENIO";
          |MENSA "    Opciones: (N) todos los trabajadores cuyo estado sea 'A' (Alta); (S) Seleccionar";
     |FINSI;
|FPRC;

|PROCESO topemes;     || halla el ultimo dia del mes
     nume2 = 0;
     nume1 = nAny $ 4;    || a¤o historico
     |SI nume1 = 0;
          nume2 = 1;
     |FINSI;
     topemes = 31;
     |SI nMes = 2;
          topemes = 28 + nume2;
     |FINSI;
     |SI nMes = 4; |O nMes = 6; |O nMes = 9; |O nMes = 11;
          topemes = 30;
     |FINSI;
|FPRC;

|PROCESO AyudaTipos; |TIPO 7;
     |PUSHV 08552380;
     |ATRI R;
     ||            5    6         7         8
     ||            56789012345678901234567890
     |PINTA 0855, "       - Opciones -       ";
     |PINTA 0955, " 00 :Normal               ";
     |PINTA 1055, " 02 :Finiquitos           ";
     |PINTA 1155, "5-20:Atrasos              ";
     |PINTA 1255, " 98 :Salarios de tramita- ";
     |PINTA 1355, "     ci¢n                 ";
     |PINTA 1455, "                          ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura; |TIPO 0;
     |POPV;
|FPRC;

|PROCESO defectoMesAny;
     fech1 = ~;
     alfa1 = fech1;
     alfa1 = alfa1 % 402;          || MES
     nume1 = alfa1;

     alfa2 = fech1;
     alfa2 = alfa2 % -104;
     nume2 = alfa2;                || A¥O

     |SI nume1 = 1;
         #0#0 = nume2 - 1;
         #0#1 = 12;
     |SINO;
         #0#0 = nume2;
         #0#1 = nume1 - 1;
     |FINSI;
     #0#6 = #0#0;
     #0#4 = #0#1;

     |PINTA #0#0;
     |PINTA #0#1;
     ||PINTA #0#6;
     ||PINTA #0#4;

     ||HAZ mirames;
|FPRC;

|PROCESO elAnyo; |TIPO 0;
     enAny = #0#0;
|FPRC;

|PROCESO mirames;
     |SI #0#3 ! "A";|Y #0#3 ! "T"; |Y #0#3 ! "C";
          fech1 = ~;
          alfa1 = fech1;
          alfa1 = alfa1 % 402;
          nume1 = alfa1;
          alfa2 = fech1;
          alfa2 = alfa2 % -104;
          nume2 = alfa2;

          |SI nume1 = 1;
              #0#1 = 12;
              #0#4 = 12;
          |SINO;
              #0#1 = nume1 - 2;
              #0#4 = nume1 - 2;
          |FINSI;

          |PINTA #0#1;
          |PINTA #0#4;
     |FINSI;
|FPRC;

|PROCESO pintames; |TIPO 0;
     |SI #0Campo =  1;  p_mes = "ENERO     ";  |FINSI;
     |SI #0Campo =  2;  p_mes = "FEBRERO   ";  |FINSI;
     |SI #0Campo =  3;  p_mes = "MARZO     ";  |FINSI;
     |SI #0Campo =  4;  p_mes = "ABRIL     ";  |FINSI;
     |SI #0Campo =  5;  p_mes = "MAYO      ";  |FINSI;
     |SI #0Campo =  6;  p_mes = "JUNIO     ";  |FINSI;
     |SI #0Campo =  7;  p_mes = "JULIO     ";  |FINSI;
     |SI #0Campo =  8;  p_mes = "AGOSTO    ";  |FINSI;
     |SI #0Campo =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
     |SI #0Campo = 10;  p_mes = "OCTUBRE   ";  |FINSI;
     |SI #0Campo = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
     |SI #0Campo = 12;  p_mes = "DICIEMBRE ";  |FINSI;
     |PINTA 0843, p_mes;
|FPRC;

|PROCESO AnyLote;
     |SI #0#3 = "M"; |O #0#3 = "H";
          #0#6 = #0#0;
     |FINSI;
|FPRC;

|PROCESO ValorCampos;
     |SI #0#3 = "A"; |O #0#3 = "T";
          |SI #0#5 < 5;
               #0#5 = 5;
               |PINTA #0#5;
          |FINSI;
     |SINO;
          |SI #0#5 > 2;
               #0#5 = 0;
               |PINTA #0#5;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ActivaCampos;
     |SI #0#3 = "A"; |O #0#3 = "T";
          |CAMPO_MODIFICA #0#4, 1, "S";
          |CAMPO_VISUAL #0#4, 1, "S";
          |PINTA 1148, "-    ";
          |PINTA #0#4;
          |SI #0#3 = "A";
               |CAMPO_MODIFICA #0#5, 1, "N";
               #0#5 = 05;
               |PINTA #0#5;
          |SINO;
               |CAMPO_MODIFICA #0#5, 1, "S";
          |FINSI;
     |SINO;
          |CAMPO_MODIFICA #0#4, 1, "N";
          |CAMPO_VISUAL #0#4, 1, "N";
          ||PINTA 1148, "     ";

          |CAMPO_MODIFICA #0#5, 1, "S";
     |FINSI;
|FPRC;

|PROCESO PintaPantalla; |TIPO 7;
     |HAZ ActivaCampos;
|FPRC;

|PROCESO notipo;
     |SI #0#3 ! "A";
          |C_M #0#5, 1, "S";
          |SI #0#3 = "M";|O #0#3 = "H";    #0#5 = 0;     |FINSI;
          |SI #0#3 = "T";                   #0#5 = 5;     |FINSI;
          |PINTA #0#5;
     |SINO;
          |C_M #0#5, 1, "N";
          #0#5 = 5;
          |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO cheq_tipo; |TIPO 0;
     swSigue = 0;
     |SI #0#5 = 0; |O #0#5 = 2; |O #0#5 = 98;
          swSigue = 1;
     |FINSI;
     |SI 5 [ #0#5; |Y #0#5 [ 20;
          swSigue = 1;
     |FINSI;
     |SI swSigue = 0;
          |MENAV "    Tipo de nómina no permitido";
          |ERROR;
     |FINSI;

     |SI #0#3 = "M"; |O #0#3 = "H";
          |SI #0Campo ! 0; |Y #0Campo ! 2; |Y #0Campo ! 98;
               aAviso = "0000En Procesos Mensual o Histórico sólo se admiten "
               aAviso = aAviso + "los tipos 0, 2 y 98";
               |MENAV aAviso;
               |ERROR;
          |FINSI;
     |FINSI;
     |SI #0#3 = "T";
          |SI #0Campo < 5; |O #0Campo > 20;
               aAviso = "0000En Proceso Atrasos desde Histórico sólo se admiten "
               aAviso = aAviso + "los tipos del 5 al 20";
               |MENAV aAviso;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

/****************************************************************************/
/*********** PROCESOS PARA LA SELECCION DE EMPRESAS Y TRABAJADORES **********/
/****************************************************************************/

|PROCESO Repetir;
     swRepite = 0;
     |SI #0#3 = "R";
          |LEE 000#0p;
          |SI FSalida = 0;
               swRepite = 1;
               |PINDA #0#0;
               alfa1 = Usuario; |QBT alfa1;    alfa1 = ("t" + alfa1) % 108;
               alfa2 = Usuario; |QBT alfa2;    alfa2 = ("u" + alfa2) % 108;
               |NOME_DAT #tsilco14#alfa1#;
               |NOME_DAT #tsilco15#alfa2#;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO comp;
     |SI aParam = "DIASALTA";
          |SI eaFuente = "M"; nEmp = #nomcalca#0; nTra = #nomcalca#1; |FINSI;
          |SI eaFuente = "H"; nEmp = #nomhicca#0; nTra = #nomhicca#1; |FINSI;

          #labtraba#0 = nEmp;
          #labtraba#1 = nTra;
          |LEE 000#labtraba.=;
          |SI FSalida = 0;
               |SI aParam = "DIASALTA";
                    |SI #labtraba#42 = "X"; |O #labtraba#42 = "T";
                    |O #labtraba#42 = "P"; |O #labtraba#42 = "I";
                         swHayAlguno = 1;
                         |ERROR10;
                    |SINO;
                         |ACABA;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aParam = "CITRICOS";
          swHayAlguno = 1;
          |ERROR10;
     |FINSI;
     |SI aParam = "CONVENIO";
          || excluyo Rep. Comercio, Empleados del hogar y autonomos
          |SI #labtraba#247 = 121; |O #labtraba#247 = 138; |O #labtraba#42 = "H";
               |ACABA;
          |FINSI;

          || excluyo contratos a partir del 600
          nNume = #labtraba#45;
          |SI nNume > 599;
               |ACABA;
          |FINSI;

          || si no pasa ninguna de esas cosas, incluyo la empresa
          swHayAlguno = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE comp_gomdetjr;
     #gomdetjr#1;
     ;
     nEmp, nDesdeTra, #0#0, nDesdeMes;
     nEmp, nHastaTra, #0#0, nHastaMes;
     ;
     NULL, comp;
|FIN;

|DEFBUCLE comp_labtraba;
     #labtraba#8;
     ;
     "A", #labempre#0, 00001;
     "A", #labempre#0, 99999;
     ;
     NULL, comp;
|FIN;

|DEFBUCLE comp_nomhicca;
     #nomhicca#1;
     ;
     nEmp, nDesdeTra, nAnyXX, nDesdeMes, nTipo;
     nEmp, nHastaTra, nAnyXX, nHastaMes, nTipo;
     ;
     NULL, comp;
|FIN;

|DEFBUCLE comp_nomcalca;
     #nomcalca#1;
     ;
     nEmp, nDesdeTra, nDesdeMes, nTipo;
     nEmp, nHastaTra, nHastaMes, nTipo;
     ;
     NULL, comp;
|FIN;

|PROCESO CargaEmp;
     swHayAlguno = 0;
     |SI aParam = "DIASALTA";
          |SI eaFuente = "M";
               |BUCLE comp_nomcalca;
          |FINSI;
          |SI eaFuente = "H";
               |BUCLE comp_nomhicca;
          |FINSI;
     |FINSI;
     |SI aParam = "CITRICOS";
          |BUCLE comp_gomdetjr;
     |FINSI;
     |SI aParam = "CONVENIO";
          |BUCLE comp_labtraba;
     |FINSI;
|FPRC;

|PROCESO reenvio1;
     nDesdeMes = #0#1;
     |SI eaFuente = "M"; |O eaFuente = "H";
          nHastaMes = #0#1;
     |SINO;
          nHastaMes = #0#4;
     |FINSI;
     nAny = #0#0;
     nAnyXX = #0#0 - 2000;
     nTipo = #0#5;
     nDesdeTra = 00001;
     nHastaTra = 99999;

     swHayAlguno = 0;
     nEmp = #labempre#0;
     #silcon06#0 = nEmp;
     |LEE 000#silcon06.=;
     |SI FSalida = 0;
          |HAZ CargaEmp;
          |SI swHayAlguno = 1;
               |DDEFECTO #tsilco14;
               #tsilco14#0 = #labempre#0;
               #tsilco14#1 = #labempre#2;
               #tsilco14#2 = " ";
               |GRABA 020#tsilco14.n;
               |LIBERA #tsilco14;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE reenvio;
     #labempre#1;
     ;
         1;
     99999;
     ;
     NULL, reenvio1;
|FIN;

|PROCESO min14;
    #tsilco14#0 = 00001;
|FPRC;

|PROCESO max14;
    #tsilco14#0 = 99999;
|FPRC;

|PROCESO parrilla; |TIPO 0;
     |SI FSalida = 2;    || no si pulso la flecha arriba
          |ACABA;
     |FINSI;

     |SI #0#2 = "S";
          |ATRI P;   |MENSA "    Cargando seleccion ...";    |ATRI 0;
          alfa1 = Usuario; |QBT alfa1;    alfa1 = ("t" + alfa1) % 108;
          alfa2 = Usuario; |QBT alfa2;    alfa2 = ("u" + alfa2) % 108;
          alfa3 = Usuario; |QBT alfa3;    alfa3 = ("v" + alfa2) % 108;
          |NOME_DAT #tsilco14#alfa1#;
          |NOME_DAT #tsilco15#alfa2#;
          |DELINDEX #tsilco14;
          |DELINDEX #tsilco15;

          |ABRE #labempre;
          |ABRE #labtraba;
          |ABRE #tsilco14;
          |ABRE #silcon06;

          eaFuente = #0#3;
          |BUCLE reenvio;

          |CIERRA #silcon06;
          |CIERRA #labtraba;
          |CIERRA #labempre;
          |CIERRA #tsilco14;
          |ATRI R;
          |BLIN 4;
          |ATRI 0;
          sw_parrilla = 1;

          |PUSHV 0501 2380;
          |ENTLINEAL #1#tsilco14, 1, 4, 22, 1, min14, max14;
          |POPV;
     |FINSI;
|FPRC;

/*
|DEFBUCLE CuentaDias;
     #cretam04#1;
     ;
     nEmp, nAny, nMes, nTipo, aCCC, aNAFSS, 01;
     nEmp, nAny, nMes, nTipo, aCCC, aNAFSS, 99;
     ;
     NULL, CuentaDias;
|FIN;

|PROCESO DiasAltaNIF;
     aAlfa = #labtraba#36;
     fFecha1 = aAlfa;

     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          fFecha2 = "31.12.2999";
     |SINO;
          fFecha2 = aAlfa;
     |FINSI;

     |SI fFecha2 < fFechaIniMes; |O fFecha1 > fFechaFinMes;
          || no ha estado de alta en el periodo que buscamos
     |SINO;
          nFecha1 = fFecha1;
          nFecha2 = fFecha2;

          |SI fFecha1 < fFechaIniMes;
               nFecha1 = nFechaIniMes;
          |FINSI;
          |SI fFecha2 > fFechaFinMes;
               nFecha2 = nFechaFinMes;
          |FINSI;
          nDiasAltaNIF = nDiasAltaNIF + (nFecha2 - nFecha1 + 1);

          #labcentr#0 = #labtraba#0;
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;

          |SI #labcentr#10 ! aAntCCC;
               nNroCCCs = nNroCCCs + 1;
          |FINSI;
          aAntCCC = #labcentr#10;
     |FINSI;
|FPRC;

|DEFBUCLE DiasAltaNIF;
     #labtraba#2;
     ;
     aNif;
     aNif;
     ;
     NULL, DiasAltaNIF;
|FIN;

|PROCESO cta_cotizacion;
     swCentroFormacion = 0;
     aCCC = #labempre#13;          || cta.cot. de la empresa
     |SI #labtraba#45 = "085"; |O #labtraba#45 = "087"; |O #labtraba#45 = "097";
     |O #labtraba#45 = "421"; |O #labtraba#45 = "422";
          |DDEFECTO #nomcenes;
          |ABRE #nomcenes;
          #nomcenes#0 = #labtraba#0;
          #nomcenes#13 = #labtraba#77;
          #nomcenes#1 = 87;
          |LEE 000#nomcenes.=;
          |SI FSalida = 0;
               aAlfa = #nomcenes#10;      || cta.cto. del centro de trabajo especial
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aCCC = aAlfa;         || cta.cto. del centro de trabajo especial
               |FINSI;
               aCentroNom = #nomcenes#2;
               swCentroFormacion = 1;
          |FINSI;
          |CIERRA #nomcenes;
     |SINO;
          |DDEFECTO #labcentr;
          |ABRE #labcentr;
          #labcentr#0 = #labtraba#0;
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;
          |SI FSalida = 0;
               aAlfa = #labcentr#10;      || cta.cot. centro de trabajo
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aCCC = aAlfa;
               |FINSI;
               aCentroNom = #labcentr#2;
          |FINSI;
          |CIERRA #labcentr;
     |FINSI;
     |QBF aCCC;
     |SI aCCC ! "";
          aCCC = ("00000000000" + aCCC) % -111;
     |FINSI;
     aAlfa = #labtraba#247;
     |QBF aAlfa;
     aAlfa = ("0000" + aAlfa) % -104;
     |SI aCCC ! "";
          aCCC = aAlfa + aCCC;
     |FINSI;
|FPRC;
*/

/****************** PROCESOS PARA FRUTAS Y HORTALIZAS ***********************/
/********* SI NO TUVIERAN LOS DIAS CALCULADOS EN EL CALENDARIO **************/

|PROCESO ulti_dia;  || halla el ultimo dia del mes
    numer = anynum $ 4;
|SI numer = 0;
        bisiesto = 1;
|SINO;
        bisiesto = 0;
|FINSI;
|SI mesnum =  1;  topemes = 31;            |FINSI;
|SI mesnum =  2;  topemes = 28 + bisiesto; |FINSI;
|SI mesnum =  3;  topemes = 31;            |FINSI;
|SI mesnum =  4;  topemes = 30;            |FINSI;
|SI mesnum =  5;  topemes = 31;            |FINSI;
|SI mesnum =  6;  topemes = 30;            |FINSI;
|SI mesnum =  7;  topemes = 31;            |FINSI;
|SI mesnum =  8;  topemes = 31;            |FINSI;
|SI mesnum =  9;  topemes = 30;            |FINSI;
|SI mesnum = 10;  topemes = 31;            |FINSI;
|SI mesnum = 11;  topemes = 30;            |FINSI;
|SI mesnum = 12;  topemes = 31;            |FINSI;
|FPRC;

|PROCESO DiasActividad;
     nDias = 0;

     |ABRE #nomtrcal;
     aAnyo = #gomdetjr#2;
     #nomtrcal#0 = #labtraba#156;       || defecto calendario laboral
     #nomtrcal#13 = aAnyo;
     |LEE 000#nomtrcal.=;
     nMes = #gomdetjr#3;
     aCalendario = #nomtrcal#nMes#;
     |CIERRA #nomtrcal;

     anynum = #gomdetjr#2;
     mesnum = nMes;
     |HAZ ulti_dia;
     |PARA nDia = 1; |SI nDia [ topemes; |HACIENDO nDia = nDia + 1;
          nCampoDia = nDia + 3;
          |SI #gomdetjr#nCampoDia# = "X";
               nDias = nDias + 1;
          |FINSI;
          |SI #gomdetjr#nCampoDia# = "I";
               nCampo = nDia + 3;
               nNume1 = (nDia * 100) + 1;
               aAlfa1 = aCalendario % nNume1;
               |SI aAlfa1 = 1;
                    || era un dia de fiesta
               |SINO;
                    nDias = nDias + 1;
               |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

/****************************************************************************/

|PROCESO Fechas;
     #labtraba#0 = nEmp;
     #labtraba#1 = nTra;
     |LEE 000#labtraba.=;

     fFechaAlta = aFechaAlta;
     aNAFSS = #labtraba#75;
     |QBF aNAFSS;
     aAlfa1 = aNAFSS % 102;
     aAlfa2 = aNAFSS % 310;
     |QBF aAlfa2;
     aAlfa2 = ("0000000000" + aAlfa2) % -110;
     aNAFSS = aAlfa1 + aAlfa2;

     aAlfa = aFechaBaja;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          fFechaBaja = "31.12.2999";
     |SINO;
          fFechaBaja = aAlfa;
     |FINSI;

     |SI nTipo = 2;
          nFechaBaja = fFechaBaja;
          nFechaAlta = nFechaBaja + 1;
          fFechaAlta = nFechaAlta;

          nFechaBaja = fFechaAlta + nDiasVac1 - 1;
          fFechaBaja = nFechaBaja;
     |FINSI;

     nMes = nElMes;
     nAny = #0#0;
     |HAZ topemes;

     aMes = nMes; |QBF aMes; aMes = ("00" + aMes) % -102;
     aAny = nAny;

     aAlfa1 = topemes;
     aAlfa = aAlfa1 + "." + aMes + "." + aAny;
     fFechaFinPer = aAlfa;

     fFechaFinMes = aAlfa;
     nFechaFinMes = fFechaFinMes;

     aAlfa1 = "01";
     aAlfa = aAlfa1 + "." + aMes + "." + aAny;
     fFechaIniPer = aAlfa;

     fFechaIniMes = aAlfa;
     nFechaIniMes = fFechaIniMes;

     |SI fFechaAlta > fFechaIniPer;
          fFechaIniPer = fFechaAlta;
     |FINSI;

     |SI fFechaBaja < fFechaFinPer;
          fFechaFinPer = fFechaBaja;
     |FINSI;

     nNume1 = fFechaIniPer;
     nNume2 = fFechaFinPer;

     aFechaIniPer = fFechaIniPer;
     aFechaFinPer = fFechaFinPer;
     aFechaIniPer = (aFechaIniPer % -104) + (aFechaIniPer % 402) + (aFechaIniPer % 102);
     aFechaFinPer = (aFechaFinPer % -104) + (aFechaFinPer % 402) + (aFechaFinPer % 102);
|FPRC;

|PROCESO CreaMovAFI;
     |LEE 000#silcon13.u;
     |SI FSalida ! 0;
          red_ultimo = 1;
     |SINO;
          red_ultimo = #silcon13#0 + 1;
     |FINSI;

     |DDEFECTO #silcon13;
     #silcon13#0 = red_ultimo;
     |GRABA 020#silcon13.b;

     #silcon13#1 = nEmp;         || empresa
     #silcon13#2 = nTra;         || trabajador
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          #silcon13#3 = "ADT";        || accion/situac.

          #silcon13#61 = aFechaIniPer;
          #silcon13#62 = aFechaFinPer;
          #silcon13#63 = nDiasMesTrab;
     |FINSI;
     |SI aParam = "CONVENIO";
          #silcon13#3 = "ACT";        || accion/situac.
     |FINSI;

     |GRABA 020#silcon13.a;
     |LIBERA #silcon13;

     |SI nEmp ! nAntEmp;
          nNroEmpresas = nNroEmpresas + 1;
     |FINSI;
     nNroTrabaj = nNroTrabaj + 1;

     nAntEmp = nEmp;
|FPRC;

|PROCESO VarConvenio;
     |HAZ CreaMovAFI;
|FPRC;

|PROCESO VarCitricos;
/*
     #gomdetjr#0 = #labtraba#0;
     #gomdetjr#1 = #labtraba#1;
     #gomdetjr#2 = #0#0;
     #gomdetjr#3 = #0#1;
     |LEE 000#gomdetjr.=;
     |SI FSalida = 0;
          |SI #gomdetjr#35 ! 0;
               nDiasMesTrab = #gomdetjr#35;
          |SINO;
               |HAZ DiasActividad;
               nDiasMesTrab = nDias;
          |FINSI;
     |FINSI;
*/

     |SI #gomdetjr#35 ! 0;
          nDiasMesTrab = #gomdetjr#35;
     |SINO;
          |HAZ DiasActividad;
          nDiasMesTrab = nDias;
     |FINSI;

     aFechaAlta = #labtraba#36;
     aFechaBaja = #labtraba#37;
     |QBF aFechaAlta;
     |QBF aFechaBaja;
     nElMes = #0#1;

     #nomvarca#0 = #labtraba#0;
     #nomvarca#1 = #labtraba#1;
     #nomvarca#2 = #0#1;
     #nomvarca#3 = 0;
     |LEE 000#nomvarca.=;
     |SI FSalida = 0;
          aAlfa = #nomvarca#16;
          |QBF aAlfa;
          |SI aAlfa ! ""; |Y aAlfa ! "..........";
               aFechaBaja = aAlfa;
          |FINSI;
     |FINSI;
     |HAZ Fechas;

     |HAZ CreaMovAFI;
|FPRC;

|PROCESO nomcal04;
     |SI #nomcal04#12 = 0;
          |SI #nomcal04#6 ! 0; |O #nomcal04#7 ! 0;
               nDiasMesTrab = nDiasMesTrab + 1;
          |FINSI;
     |SINO;
          aAlfa = #nomcal04#13;
          |QBF aAlfa;
          |SI aAlfa = "IT"; |O aAlfa = "Vacac.";
               nDiasMesTrab = nDiasMesTrab + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE nomcal04;
     #nomcal04#1;
     ;
     #nomcal03#0, #nomcal03#1, #nomcal03#2, #nomcal03#3, 01;
     #nomcal03#0, #nomcal03#1, #nomcal03#2, #nomcal03#3, 99;
     ;
     NULL, nomcal04;
|FIN;

|PROCESO VarHistorico;
     nTipo = #nomhicca#3;
     aFechaAlta = #nomhicca#4;
     aFechaBaja = #nomhicca#5;

     |HAZ Fechas;

     nDiasMesTrab = 0;

     #nomcal03#0 = #nomhicca#0;
     #nomcal03#1 = #nomhicca#1;
     #nomcal03#2 = #0#0;
     #nomcal03#3 = #nomhicca#2;
     |LEE 000#nomcal03.=;
     |SI FSalida = 0;
          |BUCLE nomcal04;
     |FINSI;

     |HAZ CreaMovAFI;
|FPRC;

|PROCESO VarMensuales;
     nTipo = #nomcalca#3;
     aFechaAlta = #nomcalca#4;
     aFechaBaja = #nomcalca#5;

     |HAZ Fechas;

     nDiasMesTrab = 0;

     |SI aParam = "DIASALTA";
          #nomcal03#0 = #nomcalca#0;
          #nomcal03#1 = #nomcalca#1;
          #nomcal03#2 = #0#0;
          #nomcal03#3 = #nomcalca#2;
          |LEE 000#nomcal03.=;
          |SI FSalida = 0;
               |BUCLE nomcal04;
          |FINSI;
     |FINSI;

     |HAZ CreaMovAFI;
|FPRC;

|PROCESO generador;
     || comprobaciones a ver si el trabajador entra en la seleccion

     |SI aParam = "DIASALTA";
          |SI #0#3 = "M"; nEmp = #nomcalca#0; nTra = #nomcalca#1; |FINSI;
          |SI #0#3 = "H"; nEmp = #nomhicca#0; nTra = #nomhicca#1; |FINSI;

          #labtraba#0 = nEmp;
          #labtraba#1 = nTra;
          |LEE 000#labtraba.=;

          |SI FSalida = 0;
               || solo a los tiempos parciales
               |SI #labtraba#42 = "X"; |O #labtraba#42 = "T";
               |O #labtraba#42 = "P"; |O #labtraba#42 = "I";
                    || adelante
               |SINO;
                    |ACABA;
               |FINSI;
          |FINSI;

          || excluyo Rep. Comercio, Empleados hogar, autonomos y agrarios
          |SI #labtraba#247 = 121; |O #labtraba#247 = 138; |O #labtraba#42 = "H";
          |O #labtraba#42 = "A"; |O #labtraba#42 = "E";
               |ACABA;
          |FINSI;
     |FINSI;
     |SI aParam = "CONVENIO";
          nEmp = #labtraba#0;
          nTra = #labtraba#1;

          || excluyo Rep. Comercio, Empleados del hogar y autonomos
          |SI #labtraba#247 = 121; |O #labtraba#247 = 138; |O #labtraba#42 = "H";
               |ACABA;
          |FINSI;

          || excluyo contratos a partir del 600
          nNume = #labtraba#45;
          |SI nNume > 599;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI aParam = "CITRICOS";
          nEmp = #gomdetjr#0;
          nTra = #gomdetjr#1;

          #labtraba#0 = nEmp;
          #labtraba#1 = nTra;
          |LEE 000#labtraba.=;
          |SI FSalida = 0;
               |SI #labtraba#42 = "C"; |O #labtraba#42 = "F";
                    || adelante
               |SINO;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #0#2 = "S";
          |SI #tsilco14#2 = "*";
               |SI #tsilco14#3 = "*";
                    #tsilco15#0 = nEmp;
                    #tsilco15#1 = nTra;
                    |LEE 000#tsilco15.=;
                    |SI FSalida = 0; |Y #tsilco15#7 = "*";
                         || continua
                    |SINO;
                         |ACABA;
                    |FINSI;
               |SINO;
                    || continua, no hay seleccion de trabajadores
               |FINSI;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;

     |SI aParam = "DIASALTA";
          |SI #0#3 = "M";
               nElMes = #nomcalca#2;
               |HAZ VarMensuales;
          |FINSI;

          |SI #0#3 = "H";
               nElMes = #nomhicca#2;
               |HAZ VarHistorico;
          |FINSI;
     |FINSI;
     |SI aParam = "CONVENIO";
          |HAZ VarConvenio;
     |FINSI;
     |SI aParam = "CITRICOS";
          |HAZ VarCitricos;
     |FINSI;
|FPRC;

|DEFBUCLE gomdetjr;
     #gomdetjr#1;
     ;
     #labempre#0,     1, #0#0, #0#1;
     #labempre#0, 99999, #0#0, #0#1;
     ;
     NULL, generador;
|FIN;

|DEFBUCLE labtraba;
     #labtraba#8;
     ;
     "A", #labempre#0, 00001;
     "A", #labempre#0, 99999;
     ;
     NULL, generador;
|FIN;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #labempre#0,     1, nAnyXX, nDesdeMes, nDesdeTipo;
     #labempre#0, 99999, nAnyXX, nHastaMes, nHastaTipo;
     ;
     NULL, generador;
|FIN;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #labempre#0,     1, #0#1, nHastaTipo;
     #labempre#0, 99999, #0#1, nDesdeTipo;
     ;
     NULL, generador;
|FIN;

|PROCESO carga_temporal;
     nDesdeTipo = #0#5;         || limites de tipo para el bucle
     nHastaTipo = #0#5;         || si es el RED, lo que vengan del DEF

     nDesdeMes = #0#1;
     nHastaMes = nDesdeMes;

     || procesos de carga

     tipo_bot = #0#5; tipo_top = #0#5;
     nAnyXX = #0#0 - 2000;

     |SI aParam = "DIASALTA";
          |SI #0#3 = "M";    |BUCLE nomcalca;     |FINSI;
          |SI #0#3 = "H";    |BUCLE nomhicca;     |FINSI;
     |FINSI;
     |SI aParam = "CITRICOS";
          |BUCLE gomdetjr;
     |FINSI;
     |SI aParam = "CONVENIO";
          |BUCLE labtraba;
     |FINSI;
|FPRC;

|PROCESO empresas1;
     #silcon06#0 = #labempre#0;
     |LEE 000#silcon06.=;
     |SI FSalida = 0;
          |DDEFECTO #tsilco14;
          #tsilco14#0 = #labempre#0;
          |LEE 000#tsilco14.=;
          |SI #0#2 = "S";
               |SI FSalida ! 0; |O #tsilco14#2 ! "*";
                    |ACABA;
               |FINSI;
          |FINSI;

          nNroEmp = nNroEmp + 1;
          nTrabEmp = 0;
          |HAZ carga_temporal;

          |SI nTrabEmp = 0;
               nNroEmp = nNroEmp - 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE empresas;
     #labempre#1;
     ;
     00001;
     99999;
     ;
     NULL, empresas1;
|FIN;

|PROCESO CargaTramos;
     swCuenta = 0;
     |BUCLE empresas;
|FPRC;

|PROCESO Centra;
     aLon = aCadena % 0;
     nLon = aLon;
     nBlancos = nEspacio - nLon;
     nNume = nBlancos / 2;
     nBlancosIzd = nNume ! 0;
     nBlancosDer = nBlancos - nBlancosIzd;
     aBlancosIzd = " " * nBlancosIzd;
     aBlancosDer = nBlancosDer * " ";
     aCadenaSal = aBlancosIzd + aCadena + aBlancosDer;
|FPRC;

|PROCESO Mensaje;
     |ATRI R;
     |BLANCO 16142265;
     ||CUADRO 16142265;
               ||  1       2         3         4         5         6
               ||  234567890123456789012345678901234567890123456789012345678

     aLinea = "Se han generado los movimientos AFI ";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 1715, aCadenaSal;
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          aLinea = "del periodo solicitado. Se incluyen:"
     |FINSI;
     |SI aParam = "CONVENIO";
          aLinea = "de comun. de convenio. Se incluyen:"
     |FINSI;
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 1815, aCadenaSal;
     aAlfa = nNroEmpresas; |QBF aAlfa;
     aLinea = aAlfa + " empresas";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 2015, aCadenaSal;
     aAlfa = nNroTrabaj; |QBF aAlfa;
     aLinea = aAlfa + " trabajadores";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 2115, aCadenaSal;
     |PINTA 2215, "                                                  ";

     |ATRI 0;
     |PAUSA;
|FPRC;

|PROCESO tipo3;
     |ABRE #silcon06;
     |ABRE #silcon13;
     |ABRE #labempre;
     |ABRE #labtraba;
     |ABRE #tsilco14;
     |ABRE #tsilco15;
     |ABRE #labcentr;
     |ABRE #nomcenes;

     |ABRE #nomcalca;
     |ABRE #nomhicca;
     |ABRE #nomcal03;
     |ABRE #nomcal04;
     |ABRE #nomvarca;

     |SI #0#3 = "M"; |O #0#3 = "H";
          |HAZ CargaTramos;
     |FINSI;

     |CIERRA #nomvarca;
     |CIERRA #nomcal04;
     |CIERRA #nomcal03;
     |CIERRA #nomhicca;
     |CIERRA #nomcalca;
     |CIERRA #nomcenes;

     |CIERRA #labcentr;
     |CIERRA #labempre;
     |CIERRA #labtraba;
     |CIERRA #tsilco14;
     |CIERRA #tsilco15;
     |CIERRA #silcon13;
     |CIERRA #silcon06;

     |DBASS aAlfa; |QBF aAlfa;
     |SI aAlfa ! "/u/dsprofes/";
          |DELINDEX #tsilco14;      || parrilla empresas        se queda con la seleccion
          |DELINDEX #tsilco15;      || parrilla trabajadores    para volver a hacer el
     |FINSI;                                              || lote
|FPRC;

|PROCESO ElProceso;
     nElAny = #0#0;
     nElMes = #0#1;

     enDesCen = 1;
     enHasCen = 99;
     eaFuente = #0#3;
     |HAZ tipo3;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |QBF aParam;

     |CLS;
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          |CABEZA "GENERACION MOVIMIENTOS DIAS DE ALTA";
     |FINSI;
     |SI aParam = "CONVENIO";
          |CABEZA "GENERACION MOVIMIENTOS COMUNICACION CONVENIO";
     |FINSI;

     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;

     |HAZ ActivaCampos;

     |PINPA #0#0;
     |PINDA #0#0;

     |SI aParam = "DIASALTA";
          |ATRI R;
          |PINTA 0612, " Comunicaci¢n de D¡as Trabajados en Trab. a Tiempo Parcial ";
          |ATRI 0;
          |PINTA 0912, "                                                         ";
          |PINTA 0924, "³ Fuente M/H ......:          ³";
     |FINSI;
     |SI aParam = "CITRICOS";
          |ATRI R;
          |PINTA 0612, " Comunicaci¢n de D¡as Trabajados S.E. Frutas y Hortalizas ";
          |ATRI 0;
          |CAMPO_MODIFICA #0#3, 1, "N";
          |CAMPO_VISUAL #0#3, 1, "N";
          |PINTA 0912, "                                                         ";
          |PINTA 0824, "                               ";
          |PINTA 0924, "                               ";
          |PINTA 1024, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
     |FINSI;
     |SI aParam = "CONVENIO";
          |CAMPO_MODIFICA #0#3, 1, "N";
          |CAMPO_MODIFICA #0#0, 1, "N";
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_VISUAL #0#3, 1, "N";
          |CAMPO_VISUAL #0#0, 1, "N";
          |CAMPO_VISUAL #0#1, 1, "N";

          |ATRI R;
          |PINTA 0627, " Comunicaci¢n de Convenio ";
          |ATRI 0;

          |PINTA 0912, "                                                         ";
          |PINTA 0824, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
          |PINTA 0924, "³ Generaci¢n masiva  de movi- ³";
          |PINTA 1024, "³ mientos AFI para la comuni- ³";
          |PINTA 1124, "³ nicaci¢n  del  convenio. Se ³";
          |PINTA 1224, "³ incluir n  los trabajadores ³";
          |PINTA 1324, "³ cuyo estado sea 'A' (Alta). ³";
          |PINTA 1424, "ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´";
     |FINSI;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |HAZ ElProceso;
          |SI nNroEmpresas > 0; |Y nNroTrabaj > 0;
               |HAZ Mensaje;
          |SINO;
               |SI aParam = "DIASALTA";
                    aAlfa = "    No se han encontrado trabajadores con días de ";
                    aAlfa = aAlfa + "alta en el periodo solicitado";
               |FINSI;
               |SI aParam = "CONVENIO";
                    aAlfa = "    No se han encontrado trabajadores de alta con ";
                    aAlfa = aAlfa + "la selección realizada";
               |FINSI;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
