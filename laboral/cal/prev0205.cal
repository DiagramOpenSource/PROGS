|FICHEROS;
     prev0205 #0;

     prev0299 #100;

     prev0003;      || cursos realizados
     prev0102;      || maestro de cursos
     labempre;
     labtraba;
     labcentr;
|FIN;

|VARIABLES;
     aAlfa = "";
     fFechaDesde = @;
     fFechaHasta = @;
     fFechaRec = @;
     fFechaVto = @;
     swReco = 0;
|FIN;

|PROCESO impresion;
     |PRINT;
|FPRC;

|DEFBUCLE impresion;
     #100#0;
     ;
     INICIO;
     FINAL;
     ;
     NULL, impresion;
|FIN;

|PROCESO informe;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |INFOR "prev0205";

     |BUCLE impresion;

     |PIEINF;
     |FININF;
|FPRC;

|PROCESO prev0003;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;

     #labcentr#0 = #labtraba#0;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;

     #prev0102#0 = #prev0003#2;
     |LEE 000#prev0102.=;

     #100#0 = #labtraba#0;
     #100#1 = #labtraba#1;
     #100#2 = #labtraba#77;

     #100#3 = #labempre#2;
     #100#4 = #labtraba#2;
     #100#5 = #labcentr#2;

     #100#6 = #prev0003#3;    || fecha de realizacion del curso
     #100#8 = #prev0003#2;    || codigo del curso entregado
     #100#10 = #prev0102#1;   || Descripcion

     |GRABA 020#100n;
     |LIBERA #100;
|FPRC;

|DEFBUCLE prev0003;
     #prev0003#1;
     ;
     #labtraba#0, #labtraba#1, 0001, fFechaDesde;
     #labtraba#0, #labtraba#1, 9999, fFechaHasta;
     ;
     NULL, prev0003;
|FIN;

|PROCESO labtraba;
     fFechaDesde = #0#4;
     fFechaHasta = #0#5;
     |BUCLE prev0003;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#8;
     ;
     "A", #0#0, #0#2;
     "A", #0#1, #0#3;
     ;
     NULL, labtraba;
|FIN;

|PROCESO proceso;
     |BUCLE labtraba;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 000#0p;
     |SI FSalida = 0;  |BORRA 020#0a;  |FINSI;
     |PINDA #0#0;
     |ENDATOS #1#0;

     |SI FSalida = 0;
          aAlfa = Usuario;
          |QBF aAlfa;
          aAlfa = "t" +  aAlfa;
          |NOME_DAT #100 aAlfa;
          |DELINDEX #100;
          |ABRE #100;
          |ABRE #labempre;
          |ABRE #labcentr;
          |ABRE #prev0102;

          |HAZ proceso;

          |HAZ informe;

          |CIERRA #prev0102;
          |CIERRA #labcentr;
          |CIERRA #labempre;
          |DELINDEX #100;
          |CIERRA #100;
     |FINSI;

     |GRABA 000#0n;
     |CIERRA #0;
|FPRO;
