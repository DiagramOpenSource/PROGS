|FICHEROS;
   labempre #0;
   labcomtp #1;
   labcentr #2;
   labcon00 #3;
   labcontr #100;
|FIN;

|VARIABLES;
 x = 0;
    informe = "labcomtp";
    men1 = "    ATENCION !!! No existe Empresa con ese codigo ...";
    men2 = "    ATENCION !!! No existe definido contrato con ese codigo ...";
    men3 = "    ATENCION !!! No existe Centro definido para esta Empresa ...";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    loca = "";
    loca1 = "";
    &local = "";
    &fcom = "";
    diacom = "";
    mescom = "";
    anycom = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
    &domicen = "";
    dominum = "";
    defini1 = 0;
    defini2 = 0;
|FIN;

|INCLUYE i_comun;

|PROCESO proceso;
    fechacom = #1#28;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
  |SI mescom = 01;  fechacom =  uno;    |FINSI;
  |SI mescom = 02;  fechacom =  dos ;   |FINSI;
  |SI mescom = 03;  fechacom = tres;    |FINSI;
  |SI mescom = 04;  fechacom = cuatro;  |FINSI;
  |SI mescom = 05;  fechacom = cinco;   |FINSI;
  |SI mescom = 06;  fechacom = seis;    |FINSI;
  |SI mescom = 07;  fechacom = siete;   |FINSI;
  |SI mescom = 08;  fechacom = ocho;    |FINSI;
  |SI mescom = 09;  fechacom = nueve;   |FINSI;
  |SI mescom = 10;  fechacom = diez;    |FINSI;
  |SI mescom = 11;  fechacom = once;    |FINSI;
  |SI mescom = 12;  fechacom = doce;    |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    loca = #0#6;
    |QBF loca;
    loca1 = #0#6 - loca;
    local = loca1 + loca;
    calle1 = #0#3;
    numca = #0#4;
    piso = #0#5;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numca;
    calle = calle + espa;
    calle = calle + piso;
    #2#0 = #0#0;
    #2#1 = #1#1;
|LEE 040#2=;
    domicen = #2#3;
    dominum = #2#4;
    |QBF domicen;
    domicen = domicen + "," + dominum;

        r_emp = #1#0;
    |HAZ r_regis1;
|PARA x = 1;|SI x [ #1#29;|HACIENDO x = x + 1;
    |INFOR informe;
    |PRINT;
    |PIEINF;
    |FININF;
|SIGUE;
|FPRC;

|PROCESO compru1; |TIPO 0;
|ABRE #0;
    #0#0 = #1Campo;
|LEE 040#0=;
|SI FSalida ! 0;
    |MENAV men1;
    |ERROR;
|FINSI;
|CIERRA #0;
|FPRC;

|PROCESO compru2; |TIPO 0;
|ABRE #2;
    #2#0 = #0#0;
    #2#1 = #1Campo;
|LEE 040#2=;
|SI FSalida ! 0;
    |MENAV men3;
    |ERROR;
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO decretos; |TIPO 0;
|SI #1Campo ! "  ";
        defini1 = Campo + 6;
        defini2 = Campo + 12;
    |ABRE #3;
        #3#0 = #1Campo;
    |LEE 040#3=;
    |SI FSalida ! 0;
        |MENAV men2;
        |ERROR;
        #1defini1 = "";
        #1defini2 = "";
    |SINO;
        #1defini1 = #3#1;
        #1defini2 = #3#2;
    |FINSI;
    |CIERRA #3;
|FINSI;
|FPRC;

|PROCESO imprime; |TIPO 3;

|ABRE #100; |LEE 000#100p; |CIERRA #100;
#100#60 = "N";
|SI #100#60 = "S";
     Impresora = "CrystalReport";
     |IMPRE -1;
|SINO;
     |IMPRE 0;
|FINSI;
|SI Impresora = "CrystalReport";
     |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
     |ACABA;
|FINSI;

|SI FSalida = 0;
    |HAZ r_regis0;
    |ABRE #2;
    |HAZ proceso;
    |CIERRA #2;
|SINO;
    |MENAV "    Proceso Abortado ...";
|FINSI;
|FINIMP;
|FPRC;
