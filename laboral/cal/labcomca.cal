|FICHEROS;
    labcomca #0;
    labempre #1;
    labtraba #2;
    labregis #3;
    labcontr #100;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &duracion = "";
    &origen = "";
    &destin = "";
    &domic = "";
    &local = "";
    &firma = "";
|FIN;

|INCLUYE i_comun;
____________________________________/
|PROCESO origen; |TIPO 0;
|DDEFECTO #1;
|ABRE #1;
    #1#0 = #0#0;
|LEE 020#1=;
    origen = #1#2;       || nombre empresa origen
|CIERRA #1;
|FPRC;

|PROCESO destin; |TIPO 0;
|DDEFECTO #1;
|ABRE #1;
    #1#0 = #0#1;
|LEE 020#1=;
    destin = #1#2;       || nombre empresa destino
    domic = #1#3;   |QBF domic;
    domic = domic + ", " + #1#4 + "-" + #1#5;
    local = #1#6;
|CIERRA #1;
|FPRC;

|PROCESO defectos; |TIPO 0;
|ABRE #3;
|SELECT #2#3;
    #3#1 = #0#0;    || empresa
    #3#2 = #0#2;    || trabajador
|LEE 000#3=;
|SI FSalida = 0;
        alfa1 = #3#5;    |QBF alfa1;
        alfa2 = #3#6;    |QBF alfa2;
        #0#3 = alfa1 + " <> " + alfa2;       || tipo contrato
        #0#4 = #3#14;                        || nro.registro
        #0#5 = #3#11;                        || fecha presentacion
        #0#6 = #3#18;                        || meses duracion
        #0#7 = #3#22;                        || dias duracion
        #0#8 = #3#12;                        || oficina INEM
|SINO;
    |PDEFECTO #0, 3, 9;
|FINSI;
|PINDA #0#0;
|CIERRA #3;
|FPRC;
____________________________________/
|PROCESO detalles;
    duracion = "";
|SI #0#6 ! 0;
        duracion = #0#6 + " meses";
|FINSI;
|SI #0#7 ! 0;
    |SI #0#6 = 0;
            duracion = #0#7 + " dias";
    |SINO;
            duracion = duracion + " y " + #0#7 + " dias";
    |FINSI;
|FINSI;

    firma = #0#9;   |QBF firma;
    firma = ((" " * 30) + firma) % -130;
|FPRC;

|PROCESO tipo3; |TIPO 3;
|HAZ r_regis0;   r_emp = #0#0;  |HAZ r_regis1;
|ABRE #100; |LEE 000#100p; |CIERRA #100;
#100#60 = "N";
|SI #100#60 = "S";
     Impresora = "CrystalReport";
     |IMPRE -1;
|SINO;
     |IMPRE 0;
|FINSI;
|SI Impresora = "CrystalReport";
     |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
     |ACABA;
|FINSI;
|SI FSalida = 0;
    |HAZ detalles;
    |PARA para1 = 1; |SI para1 [ #0#11; |HACIENDO para1 = para1 + 1;
        |INFOR "labcomca";
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;
