|FICHEROS;
     nomconpc #0;
     nomconca #1;
     nomconli #2;
     nomconax #3;
     nomcateg #4;
     nomcatca #5;
     nomcatli #6;
     nomconat #7;
     nomantig;
     nomantil;
     nompagfe;
     nomconfi;
     nomfinca;
     nomfinli;
     nomdesam;
     nomcorca;
     nomcorli;
|FIN;

|VARIABLES;
     mensaje0 = "0000ATENCION !!! Codigo origen inexistente ...";
     FSestado = 0;
     linea = 1;
     cabecera = "REPRODUCCION CONVENIOS";
     FEstado = 0;
|FIN;

|PROGRAMA;
|CLS;
|CABEZA cabecera;
|PINPA #0#0;
|DDEFECTO #0;
|PINDA #0#0;
|ENDATOS #1#0;
|SI FSalida = 0; |Y #0#0 ! #0#1;
    |HAZ proceso;
|FINSI;
|FPRO;

|| **********************************************************************
||                              RUTINAS
|| **********************************************************************

|PROCESO nomcorli1;      || GRABA O REGRABA descripciones ampliadas
     #nomcorli#0 = #0#1;
     |LEE 040#nomcorli.=;                    || lee destino
     FSestado = FSalida;
     #nomcorli#0 = #0#0;
     |LEE 040#nomcorli.=;                    || lee origen
     #nomcorli#0 = #0#1;
     |SI FSestado = 0; |Y #0#2 = "S";
          |BORRA 040#nomcorli.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomcorli.n;                  || graba destino
|FPRC;

|DEFBUCLE nomcorli;      || DESCRIPCIONES AMPLIADAS
     #nomcorli#1;
     ;
     #0#0, 001;
     #0#0, 999;
     ;
     NULL, nomcorli1;
|FIN;

|PROCESO nomcorca1;      || GRABA O REGRABA descripciones ampliadas
     #nomcorca#0 = #0#1;
     |LEE 040#nomcorca.=;                    || lee destino
     FSestado = FSalida;
     #nomcorca#0 = #0#0;
     |LEE 040#nomcorca.=;                    || lee origen
     #nomcorca#0 = #0#1;
     |SI FSestado = 0; |Y #0#2 = "S";
          |BORRA 040#nomcorca.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomcorca.n;                  || graba destino
|FPRC;

|DEFBUCLE nomcorca;      || DESCRIPCIONES AMPLIADAS
     #nomcorca#1;
     ;
     #0#0;
     #0#0;
     ;
     NULL, nomcorca1;
|FIN;

|PROCESO nomdesam1;      || GRABA O REGRABA descripciones ampliadas
     #nomdesam#0 = #0#1;
     |LEE 040#nomdesam.=;                    || lee destino
     FSestado = FSalida;
     #nomdesam#0 = #0#0;
     |LEE 040#nomdesam.=;                    || lee origen
     #nomdesam#0 = #0#1;
     |SI FSestado = 0; |Y #0#2 = "S";
          |BORRA 040#nomdesam.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomdesam.n;                  || graba destino
|FPRC;

|DEFBUCLE nomdesam;      || DESCRIPCIONES AMPLIADAS
     #nomdesam#1;
     ;
     #0#0, 000;
     #0#0, 999;
     ;
     NULL, nomdesam1;
|FIN;

|PROCESO nomconat1;      || GRABA O REGRABA CATEGORIAS
    #7#0 = #0#1;
|LEE 040#7=;                    || lee destino
    FSestado = FSalida;
    #7#0 = #0#0;
|LEE 040#7=;                    || lee origen
    #7#0 = #0#1;
|SI FSestado = 0; |Y #0#2 = "S";
    |BORRA 040#7c;              || borra destino existente
|FINSI;
|GRABA 040#7n;                  || graba destino
|FPRC;

|DEFBUCLE nomconat;      || BUCLE DE LECTURA DE CTOS. AUTOMATICOS
 #7#1;
 ;
 #0#0, 000;
 #0#0, 999;
 ;
 NULL, nomconat1;
|FIN;

|PROCESO grablin1;    || GRABA LINEAS DE CONVENIOS (BUCLELIN)
     #2#0 = #0#1;
     |GRABA 020#2n;
|FPRC;

|DEFBUCLE grablin1;
     #2#1;
     ;
     #1#0, 001;
     #1#0, 999;
     be;
     NULL, grablin1;
|FIN;

|PROCESO borrlin1;    || BORRA LINEAS DE CONVENIOS (BUCLELIN)
     |BORRA 020#2a;
|FPRC;

|DEFBUCLE borrlin1;
     #2#1;
     ;
     #1#0, 001;
     #1#0, 999;
     be;
     NULL, borrlin1;
|FIN;

|PROCESO grabacon;    || GRABA O REGRABA CABECERAS DE CONVENIOS
    #1#0 = #0#1;
|LEE 040#1=;                    || lee destino
    FSestado = FSalida;
    #1#0 = #0#0;
|LEE 040#1=;                    || lee origen
    #1#0 = #0#1;
|SI FSestado = 0; |Y #0#2 = "S";
    ||BUCLELIN 0borrlin1#1;
    |BUCLE borrlin1;
    |BORRA 040#1c;              || borra destino existente
|FINSI;
|GRABA 040#1n;                  || graba destino
|SI FSestado ! 0; |O #0#2 = "S";
        #1#0 = #0#0;
    |LEE 040#1=;
    ||BUCLELIN 0grablin1#1;
    |BUCLE grablin1;
|FINSI;
|FPRC;

|PROCESO grabacal;    || GRABA O REGRABA AUX. DE CONVENIOS
    #3#0 = #0#1;
|LEE 040#3=;                    || lee destino
    FSestado = FSalida;
    #3#0 = #0#0;
|LEE 040#3=;                    || lee origen
    #3#0 = #0#1;
|SI FSestado = 0; |Y #0#2 = "S";
    |BORRA 040#3c;              || borra destino existente
|FINSI;
|GRABA 040#3n;                  || graba destino
|FPRC;

|PROCESO gracate1;    || GRABA O REGRABA CATEGORIAS
    #4#0 = #0#1;
|LEE 040#4=;                    || lee destino
    FSestado = FSalida;
    #4#0 = #0#0;
|LEE 040#4=;                    || lee origen
    #4#0 = #0#1;
|SI FSestado = 0; |Y #0#2 = "S";
    |BORRA 040#4c;              || borra destino existente
|FINSI;
|GRABA 040#4n;                  || graba destino
|FPRC;

|DEFBUCLE nomconpc0;      || BUCLE DE LECTURA DE CATEGORIAS
 #4#1;
 ;
 #0#0, 000;
 #0#0, 999;
 ;
 NULL, gracate1;
|FIN;

|PROCESO gracate2;    || GRABA O REGRABA AUXILIAR DE CATEGORIAS
    #5#0 = #0#1;
|LEE 040#5=;                    || lee destino
    FSestado = FSalida;
    #5#0 = #0#0;
|LEE 040#5=;                    || lee origen
    #5#0 = #0#1;
|SI FSestado = 0; |Y #0#2 = "S";
    |BUCLELIN 0borrlin2#5;
    |BORRA 040#5c;              || borra destino existente
|FINSI;
|GRABA 040#5n;                  || graba destino
|SI FSestado ! 0; |O #0#2 = "S";
        #5#0 = #0#0;
    |LEE 040#5=;
    |BUCLELIN 0grablin2#5;
|FINSI;
|FPRC;

|DEFBUCLE nomconpc1;      || BUCLE DE LECTURA DE AUXILIAR DE CATEGORIAS
 #5#1;
 ;
 #0#0, 000;
 #0#0, 999;
 ;
 NULL, gracate2;
|FIN;

|PROCESO nomconfi;      || GRABA O REGRABA CATEGORIAS
     #nomconfi#0 = #0#1;
     |LEE 040#nomconfi.=;                    || lee destino
     FEstado = FSalida;
     #nomconfi#0 = #0#0;
     |LEE 040#nomconfi.=;                    || lee origen
     #nomconfi#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nomconfi.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomconfi.n;                  || graba destino
|FPRC;

|DEFBUCLE nomconfi;      || BUCLE DE LECTURA DE CTOS. AUTOMATICOS
     #nomconfi#1;
     ;
     #0#0, 2000, "     ";
     #0#0, 2999, "zzzzz";
     ;
     NULL, nomconfi;
|FIN;

|PROCESO nomantil;      || GRABA O REGRABA CATEGORIAS
     #nomantil#0 = #0#1;
     |LEE 040#nomantil.=;                    || lee destino
     FEstado = FSalida;
     #nomantil#0 = #0#0;
     |LEE 040#nomantil.=;                    || lee origen
     #nomantil#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nomantil.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomantil.n;                  || graba destino
|FPRC;

|DEFBUCLE nomantil;      || BUCLE DE LECTURA DE CTOS. AUTOMATICOS
     #nomantil#1;
     ;
     #0#0, 000;
     #0#0, 999;
     ;
     NULL, nomantil;
|FIN;

|PROCESO nompagfe;    || GRABA O REGRABA CABECERAS DE CONVENIOS
     #nompagfe#0 = #0#1;
     |LEE 040#nompagfe.=;                    || lee destino
     FEstado = FSalida;
     #nompagfe#0 = #0#0;
     |LEE 040#nompagfe.=;                    || lee origen
     #nompagfe#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nompagfe.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nompagfe.n;                  || graba destino
|FPRC;

|PROCESO nomantig;    || GRABA O REGRABA CABECERAS DE CONVENIOS
     #nomantig#0 = #0#1;
     |LEE 040#nomantig.=;                    || lee destino
     FEstado = FSalida;
     #nomantig#0 = #0#0;
     |LEE 040#nomantig.=;                    || lee origen
     #nomantig#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nomantig.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomantig.n;                  || graba destino
|FPRC;

|PROCESO nomfinli;      || GRABA O REGRABA lineas indemnizaciones
     #nomfinli#0 = #0#1;
     |LEE 040#nomfinli.=;                    || lee destino
     FEstado = FSalida;
     #nomfinli#0 = #0#0;
     |LEE 040#nomfinli.=;                    || lee origen
     #nomfinli#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nomfinli.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomfinli.n;                  || graba destino
|FPRC;

|DEFBUCLE nomfinli;      || BUCLE DE LECTURA DE DEFINICION INDEMNIZACIONES
     #nomfinli#1;
     ;
     #0#0, 000, 000;
     #0#0, 999, 999;
     ;
     NULL, nomfinli;
|FIN;

|PROCESO nomfinca;      || GRABA O REGRABA lineas indemnizaciones
     #nomfinca#0 = #0#1;
     |LEE 040#nomfinca.=;                    || lee destino
     FEstado = FSalida;
     #nomfinca#0 = #0#0;
     |LEE 040#nomfinca.=;                    || lee origen
     #nomfinca#0 = #0#1;
     |SI FEstado = 0; |Y #0#2 = "S";
          |BORRA 040#nomfinca.c;              || borra destino existente
     |FINSI;
     |GRABA 040#nomfinca.n;                  || graba destino
|FPRC;

|DEFBUCLE nomfinca;      || BUCLE DE LECTURA DE DEFINICION INDEMNIZACIONES
     #nomfinca#1;
     ;
     #0#0, 000;
     #0#0, 999;
     ;
     NULL, nomfinca;
|FIN;

|PROCESO proceso;   || INICIA EL PROCESO
|ABRE #1;
|ABRE #3;
|ABRE #4;
|ABRE #5;
|ABRE #nomantig;
|ABRE #nompagfe;
|ABRE #nomantil;
|ABRE #nomconfi;
|ABRE #nomfinca;
|ABRE #nomfinli;
|ABRE #nomcorca;
|ABRE #nomcorli;
|ABRE #nomdesam;
    #1#0 = #0#0;
|LEE 000#1=;
|SI FSalida = 0;         || si no existe convenio origen, nada !!!
    |HAZ grabacon;                 || graba o regraba cabeceras convenios
    |HAZ grabacal;                 || graba o regraba aux. convenios
    |BUCLE nomconpc0;              || graba o regraba categorias
    |BUCLE nomconpc1;              || graba o regraba aux. categorias
    |BUCLE nomconat;               || graba o regraba ctos. automaticos
    |HAZ nomantig;
    |HAZ nompagfe;
    |BUCLE nomconfi;
    |BUCLE nomantil;
    |BUCLE nomfinca;
    |BUCLE nomfinli;
    |BUCLE nomcorca;
    |BUCLE nomcorli;
    |BUCLE nomdesam;
|SINO;
    |MENAV mensaje0;
    |ERROR;
|FINSI;
|CIERRA #1;
|CIERRA #3;
|CIERRA #4;
|CIERRA #5;
|CIERRA #nompagfe;
|CIERRA #nomantig;
|CIERRA #nomantil;
|CIERRA #nomconfi;
|CIERRA #nomfinli;
|CIERRA #nomfinca;
|CIERRA #nomdesam;
|CIERRA #nomcorca;
|CIERRA #nomcorli;
|FPRC;

|| **********************************************************************
||                           SUBRUTINAS
|| **********************************************************************


|PROCESO borrlin2;    || BORRA LINEAS DE AUX. DE CATEGORIAS (BUCLELIN)
|BORRA 020#6c;
|FPRC;

|PROCESO grablin2;    || GRABA LINEAS DE AUX. DE CATEGORIAS (BUCLELIN)
    #6#0 = #0#1;
|GRABA 020#6n;
|FPRC;
