|FICHEROS;
     program@ #0;

     labempre #1;
     labtraba #2;
     gomexplo #3;
     labcentr #4;
     labcomfp #5;
     labcomic #6;
     labcomne #7;
     labcompi #8;
     labinsec #9;
     nomw0004 #10;
     nomcenes #13;
     nomgrubl #14;
     nomw0014 #15;
     nomw0002 #16;
     nomz0001 #17;
     labtracu #18;
     laborn11 #19;
     labcenfo #20;

     labcerm1 #21;
     labcerm4 #24;

     nomdator #25;

     &poblaci@ #703;
     nompobla #704;
     :/integral/def/dsam0101 #705;

     &haciend@ #706;
     :/basica/def/agihacie #707;
     :/integral/def/dsam0102 #708;

     &bancosc@ #709;
     nombanco #710;
     :/integral/def/dsam0116 #711;

     &regisnif@ #712;
     :basica/agim0003   #713;
     :integral/dsam0103 #714;

     &bancosd@ #715;
     :/integral/def/dsam0009 #716;
|FIN;

|VARIABLES;
     aBase           = "";
     aProgAct        = "";
     aDef            = "";
     aPathReo        = "";
     aAlfa           = "";
     aVariable       = "";
     aFichero        = "";

     nCampoCodProv   = 0;
     nCampoCodPobl   = 0;
     nCampoNomProv   = 0;
     nCampoNomPobl   = 0;
     nCanal          = 0;

     &eaPrograma     = "";
     &enSw           = 0;
     &enCodProv      = 0;
     &enCodPobl      = 0;
     &enCodBanco     = 0;
     &enModoPob      = 0;
     &eaPoblacion    = "";
     &eaPoblaParri   = "";
     &eaCodNif       = "";
     &eaCodUsu       = "";
     &enCodCli       = 0;
     &enSwDeDonde    = 0;
     &eswNif         = 0;

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";
     &eaPathDsArchi  = "";

     &enCodBanLab = 0;
     &eaDesBanLab = "";
     &eaCueBanLab = "";

     aAlfa1 = "";
     aAlfa2 = "";
     &enPintaLoc = 0;
     &nCP1 = 0;
     &nCP2 = 0;
     swSigue = 0;

     &enError = "";
     aUnidadBasico = "";
     aOrigen = "";
     aDestino = "";
     nHandle = 0;
     aDirBaseLocal = "";
     {1}aContiene = "";
     aDocRemoto = "";
     aDocServidor = "";
     aIPRemoto = "";
     &eaProcedencia = "";

     &eaNomPoblacion = "";
     &eaNomProvincia = "";
|FIN;

|PROCESO Tipo88;  |TIPO 88;
     |DFICE aAlfa1;
     |DFICB aAlfa2;

     |SI aAlfa1 ! aAlfa2;
          |PATH_DAT #1 aAlfa1;
          |PATH_DAT #2 aAlfa1;
     |FINSI;

     eaPrograma = FSalida % -108;
     enSw       = 0;

     |SI eaPrograma = "labempre";  enSw = 1;  |REFERENCIA_DEF program@, #1;  |FINSI;
     |SI eaPrograma = "labtraba";  enSw = 1;  |REFERENCIA_DEF program@, #2;  |FINSI;
     |SI eaPrograma = "gomexplo";  enSw = 1;  |REFERENCIA_DEF program@, #3;  |FINSI;
     |SI eaPrograma = "labcentr";  enSw = 1;  |REFERENCIA_DEF program@, #4;  |FINSI;
     |SI eaPrograma = "nomw0007";  enSw = 1;  |REFERENCIA_DEF program@, #4;  |FINSI;
     |SI eaPrograma = "labcomfp";  enSw = 1;  |REFERENCIA_DEF program@, #5;  |FINSI;
     |SI eaPrograma = "labcomic";  enSw = 1;  |REFERENCIA_DEF program@, #6;  |FINSI;
     |SI eaPrograma = "labcomne";  enSw = 1;  |REFERENCIA_DEF program@, #7;  |FINSI;
     |SI eaPrograma = "labcompi";  enSw = 1;  |REFERENCIA_DEF program@, #8;  |FINSI;
     |SI eaPrograma = "labinsec";  enSw = 1;  |REFERENCIA_DEF program@, #9;  |FINSI;
     |SI eaPrograma = "nomw0004";  enSw = 1;  |REFERENCIA_DEF program@, #10; |FINSI;
     |SI eaPrograma = "nomcenes";  enSw = 1;  |REFERENCIA_DEF program@, #13; |FINSI;
     |SI eaPrograma = "nomw0008";  enSw = 1;  |REFERENCIA_DEF program@, #13; |FINSI;
     |SI eaPrograma = "nomgrubl";  enSw = 1;  |REFERENCIA_DEF program@, #14; |FINSI;
     |SI eaPrograma = "nomw0014";  enSw = 1;  |REFERENCIA_DEF program@, #15; |FINSI;
     |SI eaPrograma = "nomw0002";  enSw = 1;  |REFERENCIA_DEF program@, #16; |FINSI;
     |SI eaPrograma = "nomz0001";  enSw = 1;  |REFERENCIA_DEF program@, #17; |FINSI;
     |SI eaPrograma = "labtracu";  enSw = 1;  |REFERENCIA_DEF program@, #18; |FINSI;
     |SI eaPrograma = "laborn11";  enSw = 1;  |REFERENCIA_DEF program@, #19; |FINSI;
     |SI eaPrograma = "labcenfo";  enSw = 1;  |REFERENCIA_DEF program@, #20; |FINSI;
     |SI eaPrograma = "nomdator";  enSw = 1;  |REFERENCIA_DEF program@, #25; |FINSI;

     |SI eaPrograma = "labemett";  enSw = 1;  |REFERENCIA_DEF program@, #25; |FINSI;
     || no me caben mas ficheros, uso uno cualquiera, despues me llevare el
     || nombre de la provincia que es lo que busco en variables, pero necesito
     || darle algun fichero al program@ para que no pete

     |SI enSw = 0;  |ACABA;  |FINSI;

     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         ||Desactivado

         |MODO_RELACION #0, 1, "nompobla", "N", "N";
         |MODO_RELACION #0, 1, "nombanco", "N", "N";
         |MODO_RELACION #0, 1, "agim0003", "N", "N";

         |MODO_RELACION #0, 1, "nompobla", "X", "X";
         |MODO_RELACION #0, 1, "nombanco", "X", "X";
         |MODO_RELACION #0, 1, "agim0003", "X", "X";

         || Activado

         |MODO_RELACION #0, 0, "dsam0101", "X", "X";
         |MODO_RELACION #0, 0, "dsam0116", "X", "X";
         |MODO_RELACION #0, 0, "dsam0103", "X", "X";

         |MODO_RELACION #0, 1, "dsam0101", "S", "S";
         |MODO_RELACION #0, 1, "dsam0116", "S", "S";
         |MODO_RELACION #0, 1, "dsam0103", "S", "S";

         |REFERENCIA_DEF poblaci@,  #705;
         |REFERENCIA_DEF bancosc@,  #711;
         |REFERENCIA_DEF regisnif@, #714;
     |SINO;
         |MODO_RELACION #0, 1, "dsam0101", "N", "N";
         |MODO_RELACION #0, 1, "dsam0116", "N", "N";
         |MODO_RELACION #0, 1, "dsam0103", "N", "N";

         |MODO_RELACION #0, 1, "dsam0101", "X", "X";
         |MODO_RELACION #0, 1, "dsam0116", "X", "X";
         |MODO_RELACION #0, 1, "dsam0103", "X", "X";

         |MODO_RELACION #0, 0, "nompobla", "X", "X";
         |MODO_RELACION #0, 0, "nombanco", "X", "X";
         |MODO_RELACION #0, 0, "agim0003", "X", "X";

         |MODO_RELACION #0, 1, "nompobla", "S", "S";
         |MODO_RELACION #0, 1, "nombanco", "S", "S";
         |MODO_RELACION #0, 1, "agim0003", "S", "S";

         |REFERENCIA_DEF poblaci@,  #704;
         |REFERENCIA_DEF bancosc@,  #707;
         |REFERENCIA_DEF regisnif@, #713;
     |FINSI;
|FPRC;

|PROCESO ParrillaPobla;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         enCodProv   = #0nCampoCodProv;
         enCodPobl   = #0nCampoCodPobl;
         eaPoblacion = #0nCampoNomPobl;
         enModoPob   = 1;
         |SUB_EJECUTA_NP ":integral/dsaw9996;NOMEQUITESPORFA";
         swSigue = 1;
         |SI eaPrograma = "labtraba"; |O eaPrograma = "nomw0004";
              |SI enPintaLoc = 0;            || solo cuando haya sido modificado
                    swSigue = 0;
              |FINSI;
         |FINSI;
         |SI swSigue = 1;
              |SI eaPoblaParri ! "";
                  #0nCampoNomPobl = eaPoblaParri;
              |SINO;
                  #0nCampoNomPobl = #703#3;
              |FINSI;
              |PINTA #0nCampoNomPobl;
         |FINSI;
     |SINO;
         enSwDeDonde     = 0;
         |SI enPintaLoc = 1;            || solo cuando haya sido modificado
              #0nCampoNomPobl = #703#3; || el CP que si no a los que NO tienen
              |PINTA #0nCampoNomPobl;   || integrada SIEMPRE les pinta la poblacion
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeeLocalidad;
/*
     eaPrograma = Control;   |QBF eaPrograma;
     FSalida    = Control;
*/
     |MODULO aAlfa; |QBF aAlfa;
     |SI aAlfa = "nomw0003"; aAlfa = "nomw0004"; |FINSI;
     aAlfa1 = aAlfa % 106;
     |SI aAlfa1 = "labcon";             || si no, se ponia a cero la empresa
         aAlfa = "labtraba";            || en caso de dar de alta un trab.
     |FINSI;                            || desde el contrato, al pasar por el
                                        || campo poblacion del CP
     |SI aAlfa = "labcentr";
          |SI Campo = 13; |O Campo = 14;
               aAlfa = "labemett";
          |FINSI;
     |FINSI;

     eaPrograma = aAlfa;
     FSalida = aAlfa;

     |HAZ Tipo88;

     |SI eaPrograma = "nompanta";       || si no, se ponia a cero la empresa
         eaPrograma = "labtraba";       || en caso de cambio de categoria
     |FINSI;

     |SI eaPrograma = "laborn01";       || si no, se ponia a cero la empresa
         eaPrograma = "labtraba";
     |FINSI;

     |SI eaPrograma = "nomcenes"; |Y Campo = 9;   || en trab. en formacion
         eaPrograma = "labtraba";       || no lo hacia bien porque pensaba
     |FINSI;                            || que venia del nomcenes, con esto
                                        || lo soluciono
     |SI eaPrograma = "labempre";
         |REFERENCIA_DEF program@, #1;
         nCampoNomPobl = 6;
         nCampoNomProv = 9;
     |FINSI;

     |SI eaPrograma = "gomexplo"; |O eaPrograma = "nomw0014";
         |REFERENCIA_DEF program@, #3;
         nCampoNomPobl = 3;
         nCampoNomProv = 6;
     |FINSI;

     |SI eaPrograma = "labcentr"; |O eaPrograma = "nomw0007";
         |REFERENCIA_DEF program@, #4;
         nCampoNomPobl = 6;
         nCampoNomProv = 9;
     |FINSI;

     |SI eaPrograma = "labcomfp";
         |REFERENCIA_DEF program@, #5;
         nCampoNomPobl = 17;
         nCampoNomProv = -1;
     |FINSI;

     |SI eaPrograma = "labcomic";
         |REFERENCIA_DEF program@, #6;
         nCampoNomPobl = 11;
         nCampoNomProv = -1;
     |FINSI;

     |SI eaPrograma = "labcomne";
         |REFERENCIA_DEF program@, #7;
         nCampoNomPobl = 11;
         nCampoNomProv = -1;
     |FINSI;

     |SI eaPrograma = "labcompi";
         |REFERENCIA_DEF program@, #8;
         nCampoNomPobl = 9;
         nCampoNomProv = 23;
     |FINSI;

     |SI eaPrograma = "labinsec";
         |REFERENCIA_DEF program@, #9;
         nCampoNomPobl = 11;
         nCampoNomProv = 14;
     |FINSI;

     |SI eaPrograma = "labtraba"; |O eaPrograma = "nomauto1"; |O eaPrograma = "nomcal01";
     |O eaPrograma = "nomhortp";
         |REFERENCIA_DEF program@, #2;
         nCampoNomPobl = 6;
         nCampoNomProv = 10;
     |FINSI;

     |SI eaPrograma = "nomw0004";
         |REFERENCIA_DEF program@, #10;
         nCampoNomPobl = 6;
         nCampoNomProv = 10;
     |FINSI;

     |SI eaPrograma = "nomcenes"; |O eaPrograma = "nomw0008";
         |REFERENCIA_DEF program@, #13;
         nCampoNomPobl = 6;
         nCampoNomProv = 9;
     |FINSI;

     |SI eaPrograma = "laborn11";
         |REFERENCIA_DEF program@, #19;
         nCampoNomPobl = 19;
         nCampoNomProv = 20;
     |FINSI;

     |SI eaPrograma = "labcenfo";
         |REFERENCIA_DEF program@, #20;
         nCampoNomPobl = 21;
         nCampoNomProv = 24;
     |FINSI;

     |SI eaPrograma = "nomdator";
         |REFERENCIA_DEF program@, #25;
         nCampoNomPobl = 9;
         nCampoNomProv = 19;
     |FINSI;

     |SI eaPrograma = "labcerm1";
          |REFERENCIA_DEF program@, #21;
          nCampoNomPobl = Campo + 1;
          nCampoNomProv = Campo + 2;
          aAlfa = #0Campo; aAlfa = ("00000" + aAlfa) % -402;
          nCP1 = aAlfa;
          aAlfa = #0Campo; aAlfa = ("00000" + aAlfa) % -103;
          nCP2 = aAlfa;
     |FINSI;

     |SI eaPrograma = "labcerm4";
          |REFERENCIA_DEF program@, #24;
          nCampoNomPobl = Campo + 1;
          nCampoNomProv = Campo + 2;
          aAlfa = #0Campo; aAlfa = ("00000" + aAlfa) % -402;
          nCP1 = aAlfa;
          aAlfa = #0Campo; aAlfa = ("00000" + aAlfa) % -103;
          nCP2 = aAlfa;
     |FINSI;

     nCampoCodProv = Campo - 1;
     nCampoCodPobl = Campo;

     |ABRE #703;
     |SI eaPrograma = "labcerm1"; |O eaPrograma = "labcerm4";
     |O eaPrograma = "labemett";
          #703#0 = nCP1;
          #703#1 = nCP2;
     |SINO;
          #703#0 = #0nCampoCodProv;
          #703#1 = #0nCampoCodPobl;
     |FINSI;
     |LEE 040#703=;
     |SI FSalida = 0;
         |SI eaPrograma = "labemett";
              eaNomProvincia = #703#2;
              eaNomPoblacion = #703#3;
              nCampoNomProv = -1;
         |SINO;
              |HAZ ParrillaPobla;
         |FINSI;

         |SI nCampoNomProv ! -1;
             #0nCampoNomProv = #703#2;
             |PINTA #0nCampoNomProv;
         |FINSI;
     |SINO;
          |MENAV "    No existe población.";
          |ERROR;
/*
          aAlfa1 = FSalida; |QBF aAlfa1; aAlfa = "    Error: " + aAlfa1;
          aAlfa1 = eaPrograma; |QBF aAlfa1; aAlfa = aAlfa + ". Programa: " + aAlfa1;
          aAlfa1 = nCampoCodProv; |QBF aAlfa1; aAlfa = aAlfa + ". CampoPro: " + aAlfa1;
          aAlfa1 = nCampoCodPobl; |QBF aAlfa1; aAlfa = aAlfa + ". CampoPob: " + aAlfa1;
          aAlfa1 = #0nCampoCodProv; |QBF aAlfa1; aAlfa = aAlfa + ". CodPro: " + aAlfa1;
          aAlfa1 = #0nCampoCodPobl; |QBF aAlfa1; aAlfa = aAlfa + ". CodPob: " + aAlfa1;
          aAlfa1 = enSwDeDonde; |QBF aAlfa1; aAlfa = aAlfa + ". Integral: " + aAlfa1;
          |MENAV aAlfa;
*/
     |FINSI;
     |CIERRA #703;
|FPRC;

|PROCESO LeePoblacion;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF poblaci@, #705;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF poblaci@, #704;
     |FINSI;

     |ABRE #703;
     #703#0 = enCodProv; #703#1 = enCodPobl;
     |LEE 040#703=;
     |SI FSalida ! 0; |DDEFECTO #703; |FINSI;
     |CIERRA #703;
|FPRC;

|PROCESO LeeHacienda;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF haciend@, #708;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF haciend@, #707;
     |FINSI;

     |ABRE #706;
     #706#0 = enCodProv; #706#1 = enCodPobl;
     |LEE 040#706=;
     |SI FSalida ! 0; |DDEFECTO #706; |FINSI;
     |CIERRA #706;
|FPRC;

|PROCESO LeeBancos;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF bancosc@, #711;
         |REFERENCIA_DEF bancosd@, #716;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF bancosc@, #710;
     |FINSI;

     |ABRE #709;
     #709#0 = enCodBanco;
     |LEE 040#709=;
     |SI FSalida ! 0; |DDEFECTO #709; |FINSI;
     |CIERRA #709;
|FPRC;

|PROCESO BancoLab;
     enCodBanLab = 0;
     eaDesBanLab = "";
     eaCueBanLab = "";

     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         enCodBanLab = -1;                   || al final lo dejamos en que si
         ||REFERENCIA_DEF bancosd@, #716;       detectamos que hay integral no dejo
                                             || introducir el banco en el labempre
                                             || y punto
          |ACABA;
     |FINSI;

     |SI enSwDeDonde = 1;
          |ABRE #715;
          #715#0 = #labempre#0;
          #715#1 = 998;
          |LEE 040#715=;
          |SI FSalida = 0;
               enCodBanLab = #715#3;
               eaDesBanLab = #715#4;
               eaCueBanLab = #715#5 + #715#6 + #715#7 + #715#8;
          |FINSI;
          |CIERRA #715;
     |FINSI;
|FPRC;

|PROCESO LeeNifs;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF regisnif@, #714;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF regisnif@, #713;
     |FINSI;

     eswNif = 0;
     |ABRE #712;
     #712#0 = eaCodNif;
     |LEE 040#712=;
     |SI FSalida ! 0; |DDEFECTO #712;  eswNif = 1;  |FINSI;
     |CIERRA #712;
|FPRC;

|PROCESO SinBarra;  |TIPO 5;
     FSalida = "SINBARRA";
|FPRC;

|PROCESO BusquedaApli;
     eaPathBasica    = "";
     eaPathContagen  = "";
     eaPathContanex  = "";
     eaPathContasoc  = "";
     eaPathRen2000   = "";
     eaPathRen1999   = "";
     eaPathRen1998   = "";
     eaPathRen1997   = "";
     eaPathRen1996   = "";
     eaPathRen1995   = "";
     eaPathRen1994   = "";
     eaPathFacturar  = "";
     eaPathLaboral   = "";
     eaPathIntegral  = "";
     eaPathDsmodelo  = "";
     eaPathFiscal    = "";
     eaPathDsArchi   = "";

     |DBASS aBase;   |QBF aBase;

     aAlfa = aBase + "basica/def/agifigen.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathBasica = aBase + "basica/";
     |FINSI;

     aAlfa = aBase + "contagen/def/canempre.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContagen = aBase + "contagen/";
     |FINSI;

     aAlfa = aBase + "contanex/def/vamanpax.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContanex = aBase + "contanex/";
     |FINSI;

     aAlfa = aBase + "contasoc/def/maempr10.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContasoc = aBase + "contasoc/";
     |FINSI;

     aAlfa = aBase + "ren2000/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen2000   = aBase + "ren2000/";  || Cambiar por ren2000
     |FINSI;

     aAlfa = aBase + "ren1999/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1999   = aBase + "ren1999/";  || Cambiar por ren1999
     |FINSI;

     aAlfa = aBase + "ren1998/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1998   = aBase + "ren1998/";  || Cambiar por ren1998
     |FINSI;

     aAlfa = aBase + "ren1997/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1997   = aBase + "ren1997/";  || Cambiar por ren1997
     |FINSI;

     aAlfa = aBase + "ren1996/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1996   = aBase + "ren1996/";  || Cambiar por ren1996
     |FINSI;

     aAlfa = aBase + "ren1995/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1995   = aBase + "ren1995/";  || Cambiar por ren1995
     |FINSI;

     aAlfa = aBase + "ren1994/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1994   = aBase + "ren1994/";  || Cambiar por ren1994
     |FINSI;

     aAlfa = aBase + "facturar/def/asclient.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathFacturar  = aBase + "facturar/";    || Cambiar por facturar
     |FINSI;

     aAlfa = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathLaboral   = aBase + "laboral/";
     |FINSI;

     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     aAlfa = aBase + "modelos/def/dsmom001.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathDsmodelo  = aBase + "modelos/";
     |FINSI;

     aAlfa = aBase + "agieos/def/eosclien.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathFiscal = aBase + "agieos/";
     |FINSI;

     aAlfa = aBase + "dsarchi/def/dsarm005.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathDsArchi = aBase + "dsarchi/";
     |FINSI;
|FPRC;

|PROCESO Traete_dsselect;
     enError = 0;

     |DBASE aBase;   |QBF aBase;

     aOrigen = aBase + "ejecutables/dsselect.exe";
     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;  enError = 1;  |ACABA;  |FINSI;

     aContiene = "";
     |ESPECIFICA "RBASS", aContiene;
     aUnidadBasico = (aContiene1 % 102) > "";

     aDirBaseLocal = aUnidadBasico + "\DOCUMENTOS";              |RMKDIR aDirBaseLocal;
     aDestino      = aDirBaseLocal + "\dsselect.exe";

     aContiene1 = aDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aOrigen, aDestino;
         |SINO;
             |COPIA_FICHERO aOrigen, aDestino;
         |FINSI;
     |FINSI;
|FPRC;
