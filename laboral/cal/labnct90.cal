|FICHEROS;
     labnct90;
     labnct91;
|FIN;

|VARIABLES;
     aAlfa = "";

     nUltima = 0;
     nLinea = 0;
     nPosicion = 0;

     nLineaReal = 0;
     nLineaNueva = 0;
     aTipo = "";
|FIN;

|PROCESO cuenta;
     nUltima = #labnct91#1;
|FPRC;

|DEFBUCLE cuenta;
     #labnct91#1;
     ;
     #labnct90#0, 01;
     #labnct90#0, 99;
     ;
     NULL, cuenta;
|FIN;

|PROCESO InsertaLinea; |TIPO 11;
     |SI FSalida ! 13;
          |ACABA;
     |FINSI;

     nLinea = #labnct91#1;
     nPosicion = nLinea;
     |BUCLE cuenta;

     |PARA nLinea = nUltima; |SI nLinea ] nPosicion; |HACIENDO nLinea = nLinea - 1;
          #labnct91#0 = #labnct90#0;
          #labnct91#1 = nLinea;
          |LEE 101#labnct91.=;
          |SI FSalida = 0;
               #labnct91#0 = #labnct90#0;
               #labnct91#1 = nLinea + 1;
               |GRABA 020#labnct91.n;
               |LIBERA #labnct91;

               |SI nLinea ! nPosicion;
                    #labnct91#0 = #labnct90#0;
                    #labnct91#1 = nLinea;
                    |LEE 101#labnct91.=;
                    |SI FSalida = 0;
                         |BORRA 020#labnct91.a;
                         |LIBERA #labnct91;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;

     #labnct91#0 = #labnct90#0;
     #labnct91#1 = nPosicion;
     |LEE 101#labnct91.=;
     |SI FSalida = 0;
          |GRABA 020#labnct91.a;
          |LIBERA #labnct91;
          |LEE 000#labnct91.=;
     |FINSI;
     |PONCONTROL 23, "si"; |PTEC 815;
     |ERROR;
|FPRC;

|PROCESO Renumera; |TIPO 3;
     |ABRE #labnct91;
     nLineaReal = 0;
     nLineaNueva = 1;
     aTipo = #labnct90#0;

     #labnct91#0 = aTipo;
     #labnct91#1 = 1;
     |LEE 101#labnct91.];
     |SI FSalida ! 0; |O #labnct91#0 ! aTipo;
          |ACABA;
     |FINSI;

     |PARA; |SI; |HACIENDO nLineaNueva = nLineaNueva + 1;
          #labnct91#0 = aTipo;
          #labnct91#1 = nLineaNueva;
          |LEE 101#labnct91.];
          |SI FSalida ! 0; |O #labnct91#0 ! aTipo;
               |SAL;
          |SINO;
               |SI #labnct91#1 ! nLineaNueva;
                    nLineaReal = #labnct91#1;
                    |BORRA 020#labnct91.a;

                    #labnct91#1 = nLineaNueva;
                    |GRABA 020#labnct91.n;
                    |LIBERA #labnct91;
               |FINSI;
          |FINSI;
     |SIGUE;
     |CIERRA #labnct91;
|FPRC;
