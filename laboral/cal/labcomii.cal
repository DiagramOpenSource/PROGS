|FICHEROS;
     labempre #0;
     labcomii #1;
     labcontr #100;
|FIN;

|VARIABLES;
     x = 0;
     men1 = "     NO EXITE REGISTRO DE EMPRESA";
     men2 = "     NO EXITE REGISTRO DE TRABAJADORES";
     men3 = "     LA FECHA DEBE SER SUPERIOR A 15 DIAS";
     men4 = "     NO EXISTE IMPRESORA";
     fechanum = 0;
     &coma = ",";
     fechacom = "";
     &loca = "";
     loca1 = "";
     &local = "";
     &fcom = "";
     &fobra = "";
     fechobra = "";
     diacom = "";
     mescom = "";
     anycom = "";
     mesobra = 0;
     espacio  = " "
     uno =       " Enero de ";
     dos =       " Febrero de ";
     tres =      " Marzo de ";
     cuatro =    " Abril de ";
     cinco =     " Mayo de ";
     seis =      " Junio de ";
     siete =     " Julio de ";
     ocho =      " Agosto de ";
     nueve =     " Septiembre de ";
     diez =      " Octubre de ";
     once =      " Noviembre de ";
     doce =      " Diciembre de ";
     unob =       " Enero-----";
     dosb =       " Febrero---";
     tresb =      " Marzo-----";
     cuatrob =    " Abril-----";
     cincob =     " Mayo------";
     seisb =      " Junio-----";
     sieteb =     " Julio-----";
     ochob =      " Agosto----";
     nueveb =     " Septiembre";
     diezb =      " Octubre---";
     onceb =      " Noviembre-";
     doceb =      " Diciembre-";
     calle1 = "";
     &calle = "";
     numca = "";
     piso = "";
     comaespa = ", "
     espa = " ";
     calle2 = "";
     &callet = "";
     numcat = "";
     pisot = "";
     &varal = "";
     linea1 = "";
     linea2= "";
     varnum = 0;
     varnum1 = 0;
     guiones = "";
     guion = "-";
     &import = "";
     fiac = "  ";
     aponer = "  ";
     relleno = "                              ";
     alfa1 = "";
|FIN;

|INCLUYE i_comun;

|PROCESO compru1; |TIPO 0;
     |ABRE #0;
     #0#0 = #1#0;
     |LEE 000#0=;
     |SI FSalida ! 0;
          |MENAV men1;
          |ERROR;
     |SINO;
          loca = #0#6;
          |QBF loca;
          loca = "                    " + loca;
          loca = loca % -130;
     |FINSI;
     |CIERRA #0;
|FPRC;

|PROCESO impre; |TIPO 3;
|HAZ r_regis0;   r_emp = #1#0;  |HAZ r_regis1;

|ABRE #100; |LEE 000#100p; |CIERRA #100;
#100#60 = "N";
|SI #100#60 = "S";
     Impresora = "CrystalReport";
     |IMPRE -1;
|SINO;
     |IMPRE 0;
|FINSI;
|SI Impresora = "CrystalReport";
     |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
     |ACABA;
|FINSI;

|SI FSalida = 0;
    |HAZ fechafir;
    |PARA x = 1;|SI x [ #1#9;|HACIENDO x = x + 1;
        |INFOR "labcomii";
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;
|SINO;
    |MENAV "0000Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;

|PROCESO fechafir;
    fechacom = #1#2;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
    |SI mescom = 01;  fechacom =  uno;    |FINSI;
    |SI mescom = 02;  fechacom =  dos;    |FINSI;
    |SI mescom = 03;  fechacom = tres;    |FINSI;
    |SI mescom = 04;  fechacom = cuatro;  |FINSI;
    |SI mescom = 05;  fechacom = cinco;   |FINSI;
    |SI mescom = 06;  fechacom = seis;    |FINSI;
    |SI mescom = 07;  fechacom = siete;   |FINSI;
    |SI mescom = 08;  fechacom = ocho;    |FINSI;
    |SI mescom = 09;  fechacom = nueve;   |FINSI;
    |SI mescom = 10;  fechacom = diez;    |FINSI;
    |SI mescom = 11;  fechacom = once;    |FINSI;
    |SI mescom = 12;  fechacom = doce;    |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
|FPRC;
