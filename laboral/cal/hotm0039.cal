|FICHEROS;
     hotm0039;
     hotm0040;
     labtraba;      || fichero de trabajadores
     nomhicca;
|FIN;

|VARIABLES;
     aPassword = "";
     fFecha = @;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;
     aP_mes = "";

     nMes = 0;
     nAnyo = 0;
     aFechaBaja = "";
     aMesBaja = "";
     nMesBaja = 0;
     aAnyoBaja = "";
     nAnyoBaja = 0;
     aAviso = "";
|FIN;
____________________________________/ DESDE CABECERA
|PROCESO Defecto; |TIPO 7;    || calcula el a¤o por defecto segun sistema
     fFech1 = ~;
     aAlfa1 = fFech1;
     aAlfa1 = aAlfa1 % -104;
     #hotm0039#Campo# = aAlfa1;
     |PINTA #hotm0039#Campo#;
|FPRC;

|PROCESO Mirames; |TIPO 7;    || calcula el mes por defecto segun sistema
     fFech1 = ~;
     aAlfa1 = fFech1;
     aAlfa1 = aAlfa1 % 402;
     #hotm0039#Campo# = aAlfa1;
     |PINTA #hotm0039#Campo#;
|FPRC;

|PROCESO Pintames; |TIPO 0;   || pinta el nombre del mes
     |SI #hotm0039#Campo# =  1; aP_mes = "ENERO     ";  |FINSI;
     |SI #hotm0039#Campo# =  2; aP_mes = "FEBRERO   ";  |FINSI;
     |SI #hotm0039#Campo# =  3; aP_mes = "MARZO     ";  |FINSI;
     |SI #hotm0039#Campo# =  4; aP_mes = "ABRIL     ";  |FINSI;
     |SI #hotm0039#Campo# =  5; aP_mes = "MAYO      ";  |FINSI;
     |SI #hotm0039#Campo# =  6; aP_mes = "JUNIO     ";  |FINSI;
     |SI #hotm0039#Campo# =  7; aP_mes = "JULIO     ";  |FINSI;
     |SI #hotm0039#Campo# =  8; aP_mes = "AGOSTO    ";  |FINSI;
     |SI #hotm0039#Campo# =  9; aP_mes = "SEPTIEMBRE";  |FINSI;
     |SI #hotm0039#Campo# = 10; aP_mes = "OCTUBRE   ";  |FINSI;
     |SI #hotm0039#Campo# = 11; aP_mes = "NOVIEMBRE ";  |FINSI;
     |SI #hotm0039#Campo# = 12; aP_mes = "DICIEMBRE ";  |FINSI;
     |PINTA 1224, aP_mes;
|FPRC;

____________________________________/ DESDE LINEAS
|PROCESO Tipo2; |TIPO 2;
     nNume1 = 0 +. 1;

/*
     |ABRE #nomhicca;
     #nomhicca#0 = #hotm0039#0;
     #nomhicca#1 = #hotm0039#1;
     #nomhicca#66 = #hotm0039#2 - 2000;
     #nomhicca#2 = #hotm0039#3;
     #nomhicca#3 = 0;
     |LEE 000#nomhicca.=;
     |SI FSalida = 0;
          aAlfa1 = "1";
     |SINO;
          #nomhicca#0 = #hotm0039#0;
          #nomhicca#1 = #hotm0039#1;
          #nomhicca#66 = #hotm0039#2 - 2000;
          #nomhicca#2 = #hotm0039#3;
          #nomhicca#3 = 2;
          |LEE 000#nomhicca.=;
          |SI FSalida = 0;
               aAlfa1 = "1";
          |FINSI;
     |FINSI;

     |CIERRA #nomhicca;

     |SI aAlfa1 = "1";
          |SI nNume1 = -1;
               |MENAV "    Registros actualizados en la nomina. No modificable.";
          |FINSI;
          |ERROR;
          |ACABA;
     |FINSI;
*/
     nModo = (FEntrada / 100) ! 0;
     fFecha = ~;
     |SI nModo = 1;
          ||MENAV "     Alta";
          #hotm0040#10 = Usuario % 810;
          #hotm0040#12 = fFecha;
     |FINSI;
     |SI nModo = 2;
          ||MENAV "     Modificacion";
          #hotm0040#11 = Usuario % 810;
          #hotm0040#13 = fFecha;
     |FINSI;

     #hotm0039#4 = #hotm0039#4 +. #hotm0040#6;
     #hotm0039#5 = #hotm0039#5 +. #hotm0040#8;
     #hotm0039#6 = #hotm0039#6 +. #hotm0040#9;
     |PINTA #hotm0039#4;
     |PINTA #hotm0039#5;
     |PINTA #hotm0039#6;
|FPRC;

|PROCESO Concepto1; |TIPO 0;
     #hotm0040#8 = #hotm0040#6 - #hotm0040#9;
     |PINTA #hotm0040#8;
|FPRC;

|PROCESO Concepto2; |TIPO 0;
     #hotm0040#9 = #hotm0040#6 - #hotm0040#8;
     |PINTA #hotm0040#9;
|FPRC;


|PROCESO Avisa;
     aAviso = "";
     |ABRE #labtraba;
     #labtraba#0 = #hotm0039#0;
     #labtraba#1 = #hotm0039#1;
     |LEE 000#labtraba.=;
     |SI FSalida = 0;
          |SI #labtraba#48 = "S";
               aAviso = "    AVISO.- El trabajador tiene informado Finiquito "
               aAviso = aAviso + "en su ficha.";
               |MENAV aAviso;
          |FINSI;
     |FINSI;

     nMes = #hotm0039#3;
     nAnyo = #hotm0039#2;
     aFechaBaja = #labtraba#37;
     aMesBaja = aFechaBaja % 402;
     nMesBaja = aMesBaja;
     aAnyoBaja = aFechaBaja % -104;
     nAnyoBaja = aAnyoBaja;
     |SI nMes = nMesBaja; |Y nAnyo = nAnyoBaja;
          aAviso = "    AVISO.- El trabajador tiene informado este mes ";
          aAviso = aAviso + "como fecha de baja.";
          |MENAV aAviso;
     |FINSI;
     |CIERRA #labtraba;

     |ABRE #nomhicca;
     #nomhicca#0 = #hotm0039#0;
     #nomhicca#1 = #hotm0039#1;
     #nomhicca#66 = #hotm0039#2 - 2000;
     #nomhicca#2 = #hotm0039#3;
     #nomhicca#3 = 0;
     |LEE 000#nomhicca.=;
     |SI FSalida = 0;
          aAviso = "    El trabajador tiene su nomina actualizada en el historico.";
          |MENAV aAviso;
     |FINSI;

     |CIERRA #nomhicca;
|FPRC;

|PROCESO AvisaLin;
     |SI aAviso ! "";
          |PUSHV 1101 1480;
          |CUADRO 1101 1480;
          |BLANCO 1102 1479;
          |PINTA 1320, "Introduzca Password : ";
          E_inf = "";
          E_sup = "20";
          aPassword = 1342 ? -1;
          |QBF aPassword;
          |SI aPassword ! "<MYPASWD>";
              |MENAV "     Permiso denegado.";
              |ERROR;
          |FINSI;
          ||aPassword = "";
          |POPV;
     |FINSI;
|FPRC;
