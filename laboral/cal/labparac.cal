|FICHEROS;
     labparac #0;
     labempre #10;        || empresas AGINOM
     labcentr #11;        || centros
     labtraba #14;        || trabajadores AGINOM
     nomcenes #15;        || centros especiales
     nomequiv;            || tabla equivalencia contratos nuevos
     nomhicca;            || para leer bases y dias cotizacion del trabajador
     labmunic;

     labparma;           || mantenimiento partes accidente de trabajo
     labparhi;           || historico de partes emitidos (copia del labparac)
     labcontr;           || control de la aplicacion
     silcon18;
     labvaltb;
     taiclaoc;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &nombre = "";
    &apell1 = "";
    &apell2 = "";
    &ssesp = "";
    &aEsp = "";
    &aExt = "";

     &aIPF = "";
     fFecAcc = @;
     fFecAnt = @;
     nFecAcc = 0;
     nFecAnt = 0;
     nFecDif = 0;
     fFecDif = @;
     aFecDif = "";
     &nMeses = 0;
     &nDias = 0;
     &aDiaSemana = "";
     &aTestigos = "";
     &p_mes = "";

     men1 = "0000ATENCION !!! Fecha erronea";
     dia1 = "";
     mes1 = "";
     any1 = "";
     dia = 0;
     mes = 0;
     any = 0;
     tope = 0;
     sw = 0;
     fec = "";
     blanco = "          ";
     puntos = "..........";
     mod = 0;
     &aContrato = "";
     &aRegimen = "";
     BaseHE = 0;
     i = 0;

     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Elegir Opcion:";
     menu4 = "IC";
     menu5 = "Imprimir Parte";
     || menu6 = "Preparar Remesa";
     menu6 = "Cancelar";
     aAlfa1 = "";
     aAlfa2 = "";
     nOpcion = 0;

     {-1}Bmenu = "";
     Bmenu1 = "2400";
     Bmenu2 = "1";
     Bmenu3 = "Elegir Opcion:";
     Bmenu4 = "IC";
     Bmenu5 = "Imprimir Parte";
     Bmenu6 = "Cancelar";

     aNombre = "";
     aApell1 = "";
     aApell2 = "";
     nCampo = 0;
     aAlfa = "";
     nContador = 0;

     &nEmpExt = 0;
     &nTraExt = 0;
     &fFecExt = @;
     aParam = "";

     aFecha = "";
     swDupli = 0;
     swYaExiste = 0;
     aCambios = "";
     nMensaje = 0;
     nNume = 0;
     nNume2 = 0;
     swNoSigas = 0;

     &aRecExt = "";
     &aDomCentro = "";
     &aDomCentro2 = "";

     aSiNo1 = "";
     aSiNo2 = "";
     aSiNo3 = "";
     fFecha = @;
     nFecha = 0;
     aValor = "";
     aLon = "";
     nLon = 0;
|FIN;

|PROCESO Valida43;
     aAlfa = #0#43;
     |QBF aAlfa;
     aLon = aAlfa % 0;
     nLon = aLon;
     |SI nLon < 3;
               aAlfa = "    ATENCION: El Sistema Delt@ no permite para la empresa ";
               aAlfa = aAlfa + "códigos de actividad inferiores a 3 dígitos."
               |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Defectos;
     |ABRE #labempre;
     #labempre#0 = #0#1;
     |LEE 000#labempre.=;
     |SI FSalida = 0;
          aValor = #labempre#12;
          aAlfa = aValor % 101;
          nNume = &aAlfa;
          |SI nNume ] 48; |Y nNume [ 57;
               aValor = aValor - ".";
               aAlfa = FSalida;
               nNume = aAlfa;
               |SI nNume = 0;
                    aAlfa = "0140";
               |SINO;
                    nNume2 = aAlfa;
                    nNume2 = (nNume2 - 1) / 100;
                    nNume2 = 100 + nNume2;
                    aAlfa2 = aValor % nNume2;
                    nNume2 = aAlfa2;
                    #0#43 = nNume2;
                    |PINTA #0#43;

                    aAlfa = ("00" + aAlfa) % -104;
                    aAlfa = aAlfa % 102;
                    nNume = aAlfa;
                    nNume = nNume + 1;
                    aAlfa = nNume;
                    aAlfa = ("00" + aAlfa) % -102;
                    aAlfa = aAlfa + "40";
               |FINSI;
               aValor = aValor % aAlfa;
          |FINSI;
          #0#44 = aValor;
          |PINTA #0#44;
     |FINSI;
     |CIERRA #labempre;
|FPRC;

|PROCESO CambiaCampos;
     || fuera de un centro
     ||CAMPO_MODIFICA #0#111, 1, aSiNo1;
     |CAMPO_MODIFICA #0#110, 1, aSiNo1;
     |CAMPO_MODIFICA #0#53, 1, aSiNo1;
     |CAMPO_MODIFICA #0#50, 1, aSiNo1;
     |CAMPO_MODIFICA #0#51, 1, aSiNo1;
     |CAMPO_MODIFICA #0#48, 1, aSiNo1;
     |CAMPO_MODIFICA #0#49, 1, aSiNo1;
     |CAMPO_MODIFICA #0#54, 1, aSiNo1;
     |CAMPO_MODIFICA #0#55, 1, aSiNo1;
     |CAMPO_MODIFICA #0#56, 1, aSiNo1;
     |CAMPO_MODIFICA #0#57, 1, aSiNo1;
/*
     || centro principal
     ||CAMPO_MODIFICA #0#100, 1, aSiNo2;
     |CAMPO_MODIFICA #0#58, 1, aSiNo2;
     |CAMPO_MODIFICA #0#59, 1, aSiNo2;
     |CAMPO_MODIFICA #0#60, 1, aSiNo2;
*/
     || centro habitual
     ||CAMPO_MODIFICA #0#112, 1, aSiNo3;
     |CAMPO_MODIFICA #0#61, 1, aSiNo3;
     |CAMPO_MODIFICA #0#62, 1, aSiNo3;
     |CAMPO_MODIFICA #0#63, 1, aSiNo3;
     |CAMPO_MODIFICA #0#64, 1, aSiNo3;
     |CAMPO_MODIFICA #0#65, 1, aSiNo3;
     |CAMPO_MODIFICA #0#66, 1, aSiNo3;
     |CAMPO_MODIFICA #0#67, 1, aSiNo3;
     |CAMPO_MODIFICA #0#68, 1, aSiNo3;
     |CAMPO_MODIFICA #0#69, 1, aSiNo3;
     |CAMPO_MODIFICA #0#70, 1, aSiNo3;
     |CAMPO_MODIFICA #0#71, 1, aSiNo3;
     |CAMPO_MODIFICA #0#72, 1, aSiNo3;
|FPRC;

|PROCESO EnDonde;
     |SI #0#111 = "S";
          aSiNo1 = "S";
          #labparac#48 = "724";
          #labparac#49 = "ESPA¥A";
          |PINTA #labparac#48;
          |PINTA #labparac#49;
     |SINO;
          aSiNo1 = "N";
     |FINSI;

     |SI #0#100 = "S"; |O #0#112 = "S";
          aSiNo3 = "N";
     |SINO;
          aSiNo3 = "S";
     |FINSI;

     |HAZ CambiaCampos;
|FPRC;

|PROCESO SacaQuizas;
     |SI #0#100 = "N";
          |HAZ SacaVentana2;
     |FINSI;
|FPRC;

|PROCESO SacaQuizas2;
     |SI #0#111 = "S";
          |HAZ SacaVentana2;
     |FINSI;
|FPRC;

|PROCESO LeeTrab;
     |SI aParam = "MODIF";
          ||PINTA;
          |ACABA;
     |FINSI;
     |ABRE #14;
     #14#0 = #0#1;
     #14#1 = #0#2;
     |LEE 000#14=;
     |CIERRA #14;
|FPRC;

|PROCESO DatosCentro;
     |ABRE #10;
     |ABRE #11;

     #10#0 = #0#1;       || lee empresa
     |LEE 000#10=;

     #11#0 = #14#0;
     #11#1 = #14#77;     || lee centro
     |LEE 000#11=;

     |SI #0#100 = "S";
          #0#61 = #10#2;
          alfa1 = #10#3; |QBF alfa1;
          alfa2 = alfa1 + ", " + #10#4 + " - " + #10#5;
          #0#62 = alfa2;
          #0#63 = #10#7;
          alfa1 = #10#7; alfa1 = "00" + alfa1; alfa1 = alfa1 % -102;
          alfa2 = #10#8; alfa2 = "000" + alfa2; alfa2 = alfa2 % -103;
          alfa3 = alfa1 + alfa2;
          #0#67 = alfa3;
          #0#68 = #10#111;
          #0#69 = #10#14;
          #0#70 = #10#13;
          #0#71 = #10#11;
          #0#72 = #10#12;
     |FINSI;

     |SI #0#112 = "S";
          #0#61 = #11#2;
          alfa1 = #11#3; |QBF alfa1;
          alfa2 = alfa1 + ", " + #11#4 + " - " + #11#5;
          #0#62 = alfa2;
          #0#63 = #11#7;
          alfa1 = #11#7; alfa1 = "00" + alfa1; alfa1 = alfa1 % -102;
          alfa2 = #11#8; alfa2 = "000" + alfa2; alfa2 = alfa2 % -103;
          alfa3 = alfa1 + alfa2;
          #0#67 = alfa3;
          || #0#68 = #10#111;
          #0#69 = #11#11;
          #0#70 = #11#10;
          #0#71 = #10#11;
          #0#72 = #10#12;
     |FINSI;

     |SI #0#100 = "S"; |O #0#112 = "S";
          |PINTA #0#61;
          |PINTA #0#62;
          |PINTA #0#63;
          |PINTA #0#67;
          |PINTA #0#68;
          |PINTA #0#69;
          |PINTA #0#70;
          |PINTA #0#71;
          |PINTA #0#72;
     |FINSI;

     |CIERRA #11;
     |CIERRA #10;
|FPRC;

|PROCESO Ocupa; |TIPO 0;
     #labparac#96 = 0;
     |ABRE #labvaltb;
     #labvaltb#0 = "labtraba";
     #labvaltb#1 = 19;
     #labvaltb#5 = #labparac#1;
     #labvaltb#6 = #labparac#2;
     #labvaltb#7 = "";
     #labvaltb#8 = "";
     #labvaltb#9 = "";
     |LEE 000#labvaltb.=;
     |SI FSalida = 0;
          |ABRE #taiclaoc;
          |SELECT #2#taiclaoc;
          #taiclaoc#1 = #labvaltb#4;
          |LEE 000#taiclaoc.=;
          |SI FSalida = 0;
               aAlfa = #taiclaoc#0;
               || aAlfa = aAlfa % 103;
               #labparac#96 = aAlfa;
          |FINSI;
          |CIERRA #taiclaoc;
     |FINSI;
     |PINTA #labparac#96;
     |CIERRA #labvaltb;
|FPRC;

|PROCESO Campitos;
     |ABRE #labtraba;
     #labtraba#0 = #labparac#1;
     #labtraba#1 = #labparac#2;
     |LEE 000#labtraba.=;
     |SI FSalida = 0;
          aAlfa = #labtraba#76;
          aAlfa = aAlfa % 103;
          nNume = aAlfa;
          aAlfa1 = nNume;
          |SI aAlfa = aAlfa1;      || EXTRANJERO
               #labparac#94 = nNume;
               aAlfa = #labtraba#76;
               aAlfa = aAlfa % 427
               |QBF aAlfa;
               #labparac#95 = aAlfa;
          |SINO;                   || NACIDO EN ESPA¤A
               #labparac#94 = 724;
               #labparac#95 = "ESPA¥A";
          |FINSI;
     |FINSI;
     |PINTA #labparac#94;
     |PINTA #labparac#95;
     |CIERRA #labtraba;
|FPRC;

|PROCESO Max40;
     alfa1 = #0#29;
     |QBF alfa1;
     alfa2 = alfa1 % A0;
     nume1 = alfa2;
     || nume1 = alfa2 % A0;
     |SI nume1 > 40;
          |MENAV "    ATENCION: no se permiten mas de 40 caracteres en este campo";
          alfa1 = alfa1 % 140;
          #0#29 = alfa1;
          |PINTA #0#29;
     |FINSI;
|FPRC;

|PROCESO suma;
     |PARA i = 1; |SI i [ 12; |HACIENDO i = i + 1;
          #nomhicca#0 = #0#1;
          #nomhicca#1 = #0#2;
          #nomhicca#66 = nume4;     || a¤o
          #nomhicca#2 = nume1;     || mes
          #nomhicca#3 = 0;         || tipo
          |LEE 000#nomhicca.=;
          |SI FSalida = 0;
               BaseHE = BaseHE + #nomhicca#41 + #nomhicca#42;
          |FINSI;
          |SI nume1 < 12;
               nume1 = nume1 + 1;
          |SINO;
               nume1 = 1;
               nume4 = nume4 + 1;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO LeeBases; |TIPO 7;
     |SI #0#36 ! 0;
          |ACABA;
     |FINSI;
     alfa1 = #0#15;            || fecha accidente
     alfa2 = alfa1 % 402;     || mes accidente
     alfa3 = alfa1 % 704;     || a¤o accidente
     nume2 = alfa2;
     nume3 = alfa3;
     nume2 = nume2 - 1;
     |SI nume2 = 0;           || si es enero, el mes anterior es Diciembre
          nume2 = 12;         || del a¤o anterior
          nume3 = nume3 - 1;
     |FINSI;
     nume3 = nume3 - 2000;
     |ABRE #nomhicca;
     #nomhicca#0 = #0#1;
     #nomhicca#1 = #0#2;
     #nomhicca#2 = nume2;
     #nomhicca#3 = 0;
     #nomhicca#66 = nume3;
     |LEE 000#nomhicca.=;
     |SI FSalida = 0;
          #0#36 = #nomhicca#39;
          #0#37 = #nomhicca#8;
     |FINSI;
     nume1 = nume2 + 1;  || mes desde (12 meses anteriores)
     nume4 = nume3 - 1;  || a¤o desde (12 meses anteriores)
     |SI nume1 = 13;
          nume1 = 1;
          nume4 = nume4 + 1;
     |FINSI;
     |HAZ suma;
     #0#38 = BaseHE;
     |PINTA #0#36;
     |PINTA #0#37;
     |PINTA #0#38;
     |CIERRA #nomhicca;
|FPRC;

|PROCESO si5; |TIPO 0;
     |SI #0#4 = 5;
          alfa1 = "S";
     |SINO;
          alfa1 = "N";
     |FINSI;
     |C_M #0#5, 1, alfa1;
     |C_M #0#6, 1, alfa1;
     |C_M #0#7, 1, alfa1;
     |SI #0#4 = 3;
          #0#16 = 0;
          |PINTA #0#16;
     |FINSI;
     |SI #0#4 = 4;
          #0#16 = 99;
          |PINTA #0#16;
     |FINSI;
|FPRC;

|PROCESO Testigos; |TIPO 0;
     |SI #0#101 = "S";
          alfa1 = "S";
     |SINO;
          alfa1 = "N";
     |FINSI;
     |C_M #0#10, 1, alfa1;
     |C_M #0#11, 1, alfa1;
     |C_M #0#12, 1, alfa1;
|FPRC;

|PROCESO centroep1; |TIPO 7;
     |SI Campo = 100;
          |SI #0#58 = 1;
               |CAMPO_MODIFICA #0Campo, 1, "S";
          |SINO;
               |CAMPO_MODIFICA #0Campo, 1, "N";
          |FINSI;
     |SINO;
          |SI #0#58 = 1;
               |CAMPO_MODIFICA #0Campo, 1, "N";
          |SINO;
               |CAMPO_MODIFICA #0Campo, 1, "S";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO centroep2; |TIPO 0;
     |SI #0#58 = 1;
          |CAMPO_MODIFICA #0#59, 1, "N";
          |CAMPO_MODIFICA #0#60, 1, "N";
          #0#59 = "";
          #0#60 = "";
          |PINTA #0#59;
          |PINTA #0#60;
     |SINO;
          |CAMPO_MODIFICA #0#59, 1, "S";
          |CAMPO_MODIFICA #0#60, 1, "S";
     |FINSI;
|FPRC;

|PROCESO HospSiNo;
     |SI #0#35 = "N";
          |CAMPO_MODIFICA #0#34, 1, "N";
          |CAMPO_MODIFICA #0#29, 1, "N";
          #0#34 = "";
          #0#29 = "";
          |PINTA #0#34;
          |PINTA #0#29;
     |SINO;
          |CAMPO_MODIFICA #0#34, 1, "S";
          |CAMPO_MODIFICA #0#29, 1, "S";
     |FINSI;
|FPRC;

|PROCESO entidad; |TIPO 7;
     aAlfa = #0#102;
     |QBF aAlfa;
     |SI aAlfa = "";
          aAlfa = #labempre#19;
          |QBF aAlfa;
          aAlfa = ("000" + aAlfa) % -103;
          #0#102 = aAlfa;
          |PINTA #0#102;
     |FINSI;
|FPRC;

|PROCESO ElError;
     |SI swDupli = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO BuscaDupli;
     |SI aParam = "MODIF"; |ACABA; |FINSI;
     swDupli = 0;
     |ABRE #labparhi;
     #labparhi#1 = #labparac#1;
     #labparhi#2 = #labparac#2;
     #labparhi#15 = #labparac#15;
     |LEE 000#labparhi.=;
     |SI FSalida = 0;         || Atencion: el parte ya existe
          |ABRE #labparma;
          |DDEFECTO #labparma;
          #labparma#1 = #labparac#1;      || empresa
          #labparma#2 = #labparac#2;      || trabajador
          #labparma#3 = #labparac#15;      || fecha inicio baja

          |LEE 000#labparma.=;

          |SI FSalida = 0;
               swDupli = 1;
               |SI #labparma#6 = "*";
                    aAlfa = "    ATENCION. Ya se ha generado y emitido la remesa ";
                    aAlfa = aAlfa + "para este parte.";
                    |MENAV aAlfa;
                    aAlfa = "    Para volver a generarla debera dejar la remesa ";
                    aAlfa = aAlfa + "como NO EMITIDA en Consulta de Partes Enviados";
                    |MENAV aAlfa;
               |SINO;
                    aAlfa = "    ATENCION. Ya se ha generado la remesa para este ";
                    aAlfa = aAlfa + "parte.";
                    |MENAV aAlfa;
                    aAlfa = "    Si desea modificar el parte debera ir a Consulta";
                    aAlfa = aAlfa + " de partes de accidente pendientes."
                    |MENAV aAlfa;
               |FINSI;
          |FINSI;
          |CIERRA #labparma;
     |FINSI;
     |CIERRA #labparhi;

     |HAZ ElError;

     |SI swDupli = 0;
          |ABRE #silcon18;
          |SELECT #2#silcon18;
          #silcon18#0 = #labparac#1;
          #silcon18#1 = #labparac#2;
          #silcon18#7 = #labparac#15;
          #silcon18#3 = "B";
          |LEE 000#silcon18.=;
          |SI FSalida = 0; |Y #silcon18#20 = "-";
               nMensaje = 4;
               |HAZ mensajes;
               nMensaje = 6;
               |HAZ mensajes;
          |FINSI;
          |SI FSalida = 0; |Y #silcon18#20 = "*";
               nMensaje = 1;
               |HAZ mensajes;
               nMensaje = 3;
               |HAZ mensajes;
          |FINSI;
          |CIERRA #silcon18;
     |FINSI;
|FPRC;

|PROCESO FechaAcc; |TIPO 7;
     aFecha = #0#15;
     |COLOR 0,7;
     |ATRI I;
     |PINTA 1748, aFecha;
     |ATRI 0;

     fFecha = #0#15;
     nFecha = fFecha;
     nFecha = nFecha - 1;
     fFecha = nFecha;
     #0#3 = fFecha;
     |PINTA #0#3;
|FPRC;
____________________________________/
|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;
____________________________________/
|PROCESO CodigosNuevos;
     aContrato = #14#45;
     |QBF aContrato;
     aContrato = ("000" + aContrato) % -103;
     |ABRE #nomequiv;
     #nomequiv#0 = aContrato;
     |LEE 000#nomequiv.=;
     |SI FSalida = 0;
          |SI #labtraba#42 = "X";|O #labtraba#42 = "T";|O #labtraba#42 = "P";
               aContrato = #nomequiv#2;      || tiempo parcial
          |SINO;
               aContrato = #nomequiv#1;      || tiempo completo
          |FINSI;
     |FINSI;
     |CIERRA #nomequiv;
|FPRC;

|PROCESO Pais;
|SI aParam = "MODIF"; |ACABA; |FINSI;

||             NACIONALIDAD

     alfa1 = #14#7;
     alfa1 = alfa1 % 101;
     |SI alfa1 ! "X"; |Y alfa1 ! "Y"; |Y alfa1 ! "Z";
          aEsp = "X";
     |SINO;
          aExt = "X";
     |FINSI;
     |SI alfa1 ] "0";|Y alfa1 [ "9";
          aIPF = "1";            || tipo identificacion DNI
     |SINO;
          |SI alfa1 ! "X"; |Y alfa1 ! "Y"; |Y alfa1 ! "Z";
               aIPF = "6";        || tipo identificacion EXTRANJERO
          |SINO;
               |SI alfa1 ] "a";|Y alfa1 [ "z";
                    aIPF = "2";    || tipo identificacion PASAPORTE
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aExt = "X";
          #0#95 = #14#76;
          |PINTA #0#95;
     |FINSI;
|FPRC;

|PROCESO varios;

     |HAZ CodigosNuevos;

     ||   REGIMEN

     aRegimen = "";
     |SI #14#247 = 111; aRegimen = "1"; |FINSI;
     |SI #14#247 = 611; aRegimen = "6"; |FINSI;
     |SI #14#247 = 613; |O #14#247 = 163;
          aRegimen = "7";
     |FINSI;
     |SI #14#247 = 800; aRegimen = "8"; |FINSI;
     |SI #14#247 = 911; aRegimen = "9"; |FINSI;
     |SI aRegimen = ""; aRegimen = "1"; |FINSI;

     |ABRE #11;
     |DDEFECTO #11;
     #11#0 = #14#0;
     #11#1 = #14#77; || lee centro
     |LEE 000#11=;
     ||ssesp = #11#10;   || s.s. del centro
     #10#13 = #11#10;    || s.s. del centro
     #10#3 = #11#3;      || domicilio
     #10#4 = #11#4;      || numero
     #10#5 = #11#5;      || piso
     #10#6 = #11#6;      || localidad
     #10#7 = #11#7;      || c.p. provincia
     #10#8 = #11#8;      || c.p. localidad
     #10#9 = #11#9;      || provincia
     #10#14 = #11#11;    || nro. trab. centro
     |CIERRA #11;


     |SI #14#45 = "087";|O #14#45 = "097";|O #14#45 = "085";
                        |O #14#45 = "064";|O #14#45 = "065";
         |ABRE #15;
         |DDEFECTO #15;
             #15#0 = #14#0;
             #15#13= #14#77;
         |SI #14#45 = "097";|O #14#45 = "085";
                 #15#1 = "87";
         |SINO;
             |SI #14#45 = "065";
                     #15#1 = "64";
             |SINO;
                     #15#1 = #14#45 % 2;
             |FINSI;
         |FINSI;
         |LEE 000#15=;
             ssesp = #15#10;
         |CIERRA #15;
     |FINSI;

         alfa1 = #14#2;  |QBF alfa1;
         alfa2 = alfa1 % 0;   para2 = alfa2;
         elsw4 = 0;
         apell1 = "";
         apell2 = "";
         nombre = "";
     |PARA para1 = 1; |SI para1 [ para2; |HACIENDO para1 = para1 + 1;
             nume2 = (para1 * 100) + 1;
             alfa3 = alfa1 % nume2;
         |SI alfa3 = " ";|O alfa3 = ",";
             |SI apell1 ! "";
                     elsw4 = elsw4 + 1;
             |FINSI;
             |SI elsw4 ] 2;|Y nombre ! "";
                     nombre = nombre + alfa3;
             |FINSI;
         |SINO;
             |SI elsw4 = 0;  apell1 = apell1 + alfa3; |FINSI;
             |SI elsw4 = 1;  apell2 = apell2 + alfa3; |FINSI;
             |SI elsw4 ] 2;  nombre = nombre + alfa3; |FINSI;
         |FINSI;
     |SIGUE;

||        ANTIGUEDAD EN PUESTO DE TRABAJO (MESES Y DIAS)
     fFecAcc = #0#15;
     fFecAnt = #0#93;
     nFecAcc = fFecAcc;
     nFecAnt = fFecAnt;
     nFecDif = nFecAcc - nFecAnt;
     fFecDif = nFecDif;
     aFecDif = fFecDif;

     alfa1 = aFecDif % 102;
     alfa2 = aFecDif % 402;
     alfa3 = aFecDif % 704;

     nume1 = alfa1;
     nume2 = alfa2;
     nume3 = alfa3;

     nume3 = nume3 * 12;
     nMeses = nume2 + nume3 - 1;
     nDias = nume1;

     |SI nDias ] 30;
          nMeses = nMeses + 1;
          nDias = nDias - 30;
     |FINSI;

     ||        DIA DE LA SEMANA

     fech1 = #0#3;
     fech2 = fech1 % 1;
     alfa2 = fech2;
     alfa2 = alfa2 % 1102;
     |SI alfa2 = "Lu";   aDiaSemana = "Lunes";    |FINSI;
     |SI alfa2 = "Ma";   aDiaSemana = "Martes";   |FINSI;
     |SI alfa2 = "Mi";   aDiaSemana = "Miercoles";|FINSI;
     |SI alfa2 = "Ju";   aDiaSemana = "Jueves";   |FINSI;
     |SI alfa2 = "Vi";   aDiaSemana = "Viernes";  |FINSI;
     |SI alfa2 = "Sa";   aDiaSemana = "Sabado";   |FINSI;
     |SI alfa2 = "Do";   aDiaSemana = "Domingo";  |FINSI;

     ||        TESTIGOS

     aTestigos = #0#10;
     |QBF aTestigos;
     |SI aTestigos = ""; aTestigos = "N";    |FINSI;

     ||        MES EN LETRA

     fech1 = ~;
     alfa1 = fech1;
     alfa1 = alfa1 % 402;
     nume1 = alfa1;
     |SI nume1 =  1;  p_mes = "ENERO     ";  |FINSI;
     |SI nume1 =  2;  p_mes = "FEBRERO   ";  |FINSI;
     |SI nume1 =  3;  p_mes = "MARZO     ";  |FINSI;
     |SI nume1 =  4;  p_mes = "ABRIL     ";  |FINSI;
     |SI nume1 =  5;  p_mes = "MAYO      ";  |FINSI;
     |SI nume1 =  6;  p_mes = "JUNIO     ";  |FINSI;
     |SI nume1 =  7;  p_mes = "JULIO     ";  |FINSI;
     |SI nume1 =  8;  p_mes = "AGOSTO    ";  |FINSI;
     |SI nume1 =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
     |SI nume1 = 10;  p_mes = "OCTUBRE   ";  |FINSI;
     |SI nume1 = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
     |SI nume1 = 12;  p_mes = "DICIEMBRE ";  |FINSI;
|FPRC;

|PROCESO situacion; |TIPO 7;
     |PUSHV 1216 1679;
     |CUADRO 1216 1679;
     |ATRI R;
     ||             8901234567890123456789012345678901234567890123456789012345678
     |PINTA 1317, "              -     Situacion Profesional     -               ";
     |PINTA 1417, " 1 - Asalariado Sector Privado   3 - Autonomo Con Asalariados ";
     |PINTA 1517, " 2 - Asalariado Sector Publico   4 - Autonomo Sin Asalariados ";
     |ATRI N;
|FPRC;

|PROCESO modalidades; |TIPO 7;
     |PUSHV 1531 2379;
     |ATRI R;
     ||            3        4         5         6         7
     ||            123456789012345678901234567890123456789012345678
     |PINTA 1631, "  -  Modalidades de organizacion preventiva  -  ";
     |PINTA 1731, "1 - Asuncion personal por el empresario         ";
     |PINTA 1831, "2 - Servicio de prevencion propio               ";
     |PINTA 1931, "3 - Servicio de prevencio ajeno                 ";
     |PINTA 2031, "4 - Trabajador(es) designado(s)                 ";
     |PINTA 2131, "5 - Servicio de prevencion mancomunado          ";
     |PINTA 2231, "6 - Ninguna                                     ";
     |ATRI 0;
|FPRC;

|PROCESO restaura;
     |POPV;
|FPRC;

|PROCESO Pantalla; |TIPO 7;
     |SI #labcontr#53 = "N";
          |CAMPO_MODIFICA #0#104, 1, "N";
          |CAMPO_VISUAL #0#104, 1, "N";
          |CAMPO_MODIFICA #0#105, 1, "N";
          |CAMPO_VISUAL #0#105, 1, "N";
          |CAMPO_MODIFICA #0#106, 1, "N";
          |CAMPO_VISUAL #0#106, 1, "N";
          |CAMPO_MODIFICA #0#107, 1, "N";
          |CAMPO_VISUAL #0#107, 1, "N";
          |CAMPO_MODIFICA #0#108, 1, "N";
          |CAMPO_VISUAL #0#108, 1, "N";
          |CAMPO_MODIFICA #0#109, 1, "N";
          |CAMPO_VISUAL #0#109, 1, "N";
          |BLANCO 19022279;
     |FINSI;
|FPRC;

|PROCESO verifech; |TIPO 0;
     |SI aParam = "MODIF"; |ACABA; |FINSI;
     fec = #0Campo; sw = 0;
     |SI fec ! blanco; |Y fec ! puntos;
          dia1 = fec % A102;
          mes1 = fec % A402;
          any1 = fec % A704;
          dia = dia1; mes = mes1; any = any1;
          |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
               |SI mes [ 12; |Y mes ] 1;
                    |SI mes = 1; |O mes = 3; |O mes = 5; |O mes = 7; |O mes = 8; |O mes = 10; |O mes = 12;
                         tope = 31;
                    |SINO;
                         |SI mes = 2;
                              mod = any $ 4;
                                   |SI mod = 0;
                                        tope = 29;
                                   |SINO;
                                        tope = 28;
                                   |FINSI;
                         |SINO;
                              tope = 30;
                         |FINSI;
                    |FINSI;
                    |SI dia [ tope;
                         sw = 1;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          sw = 1;
     |FINSI;
     |SI sw = 0;
          |MENAV men1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO imprime;
     |IMPRE 0;
     |SI FSalida = 0;
          FEstado = FSalida;
          |HAZ varios;
          |INFOR "labparac";
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
          |SINO;
               |MENAV "    Problemas con el informe 'labparac' ...";
          |FINSI;
          |FININF;
     |SINO;
          |MENAV "    Proceso abortado ...";
     |FINSI;
     |FINIMP;
|FPRC;

|PROCESO CodProv; |TIPO 7;
     |SI #0#63 ! 0;
          aAlfa = #0#63;
          aAlfa = "00" + aAlfa; aAlfa = aAlfa % -102;
          |SI #0#67 ! 0;
              aAlfa = aAlfa + (#0#67 % -103);
          |SINO;
               aAlfa = aAlfa + "000";
          |FINSI;
          nNume = aAlfa;
          #0#67 = nNume;
          |PINTA #0#67;
     |FINSI;
|FPRC;

|PROCESO BuscaMunic2;
     |SI FSalida = 11;
          |ABRE #labmunic;
          |CONSULTA_CLAVE #2#labmunic;
          |SI FSalida = 0;
               #0#110 = #labmunic#1;
               |PINTA #0#110;

               aAlfa = #labmunic#4;         || CODIGO PROVINCIA
               |QBF aAlfa;
               aAlfa = aAlfa % 102;
               #0#50 = aAlfa;

               aAlfa1 = #labmunic#2;         || NOMBRE PROVINCIA
               |QBF aAlfa1;
               #0#51 = aAlfa1;

               aAlfa2 = #labmunic#3;
               |QBF aAlfa2;
               #0#53 = aAlfa2;

               |PINTA #0#50;
               |PINTA #0#51;
               |PINTA #0#53;
          |FINSI;
          |CIERRA #labmunic;
          |ACABA;
     |FINSI;
     |SI #0Campo ! 00000;
          |ABRE #labmunic;
          |SELECT #3#labmunic;
          aAlfa = #0#110;
          aAlfa = "00000" + aAlfa;
          aAlfa = aAlfa % -105;
          #labmunic#1 = aAlfa;
          |LEE 000#labmunic.];
          |SI FSalida = 0; |Y aAlfa = #labmunic#1;
               aAlfa = #labmunic#4;         || CODIGO PROVINCIA
               |QBF aAlfa;
               aAlfa = aAlfa % 102;
               #0#50 = aAlfa;

               aAlfa1 = #labmunic#2;         || NOMBRE PROVINCIA
               |QBF aAlfa1;
               #0#51 = aAlfa1;

               aAlfa2 = #labmunic#3;
               |QBF aAlfa2;
               #0#53 = aAlfa2;

               |PINTA #0#50;
               |PINTA #0#51;
               |PINTA #0#53;
          |SINO;
               |MENAV "    ATENCION: Codigo de municipio no encontrado";
               |ERROR;
          |FINSI;
          |CIERRA #labmunic;
     |FINSI;
|FPRC;

|PROCESO BuscaMunic;
     |SI #0Campo ! 00000;
          |ABRE #labmunic;
          |SELECT #4#labmunic;
          aAlfa = #0#67;
          aAlfa = "00000" + aAlfa;
          aAlfa = aAlfa % -105;
          #labmunic#4 = aAlfa;
          |LEE 000#labmunic.=;
          |SI FSalida = 0;
               aAlfa = "                    ";
               aAlfa1 = #labmunic#3;
               |QBF aAlfa1;
               aAlfa2 = #labmunic#2;
               |QBF aAlfa2;
               aAlfa = aAlfa1 + "(" + aAlfa2 + ")";
               aAlfa = aAlfa % 120;
               |COLOR 0,7;
               |ATRI I;
               |PINTA 1322, aAlfa;
               |ATRI 0;

               |CAMPO_MODIFICA #0#65, 1, "N";
               aAlfa = #labmunic#1;
               aAlfa = aAlfa % -103;
               nNume = aAlfa;
               #0#65 = nNume;
               |PINTA #0#65;

               |CAMPO_MODIFICA #0#66, 1, "N";
               #0#66 = #labmunic#3;
               |PINTA #0#66;
          |SINO;
               |MENAV "    ATENCION: Codigo Postal de municipio no encontrado";
               aAlfa = "                    ";
               |PINTA 1322, aAlfa;
               |ERROR;
          |FINSI;
          |CIERRA #labmunic;
     |SINO;
          aAlfa = "                    ";
          |PINTA 1322, aAlfa;
     |FINSI;
|FPRC;

/*******************     PROCESOS AYUDA CREACION REMESA     *****************/

|PROCESO separa_nom;
     alfa1 = #14#2;
     |QBF alfa1;
     alfa2 = alfa1 % 0;
     para2 = alfa2;
     elsw4 = 0;
     aApell1 = "";
     aApell2 = "";
     aNombre = "";
     |PARA para1 = 1; |SI para1 [ para2; |HACIENDO para1 = para1 + 1;
          nume2 = (para1 * 100) + 1;
          alfa3 = alfa1 % nume2;
          |SI alfa3 = " ";|O alfa3 = ",";
               |SI apell1 ! "";
                    elsw4 = elsw4 + 1;
               |FINSI;
               |SI elsw4 ] 2;|Y nombre ! "";
                    nombre = nombre + alfa3;
               |FINSI;
          |SINO;
               |SI elsw4 = 0;  apell1 = apell1 + alfa3; |FINSI;
               |SI elsw4 = 1;  apell2 = apell2 + alfa3; |FINSI;
               |SI elsw4 ] 2;  nombre = nombre + alfa3; |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;


/*******************     ******************************     *****************/
|PROCESO CambioA;
     aAlfa = Contenido;
     |SI aAlfa ! #0Campo;
          aAlfa = Campo; aAlfa = "000" + aAlfa; aAlfa = aAlfa % -103;
          aAlfa = "|C" + aAlfa + "NOMBRE"; aAlfa = #labparac#aAlfa#;
          |QBF aAlfa;
          aCambios = aCambios + ", " + aAlfa;
     |FINSI;
|FPRC;

|PROCESO CambioN;
     nNume = Contenido;
     |SI nNume ! #0Campo;
          aAlfa = Campo; aAlfa = "000" + aAlfa; aAlfa = aAlfa % -103;
          aAlfa = "|C" + aAlfa + "NOMBRE"; aAlfa = #labparac#aAlfa#;
          |QBF aAlfa;
          aCambios = aCambios + ", " + aAlfa;
     |FINSI;
|FPRC;

|PROCESO mensajes;
     |SI nMensaje = 1;
          aAlfa = "    ATENCION: ya existe un movimiento FDI ENVIADO ";
          aAlfa = aAlfa + "para el parte. Para modificarlo ha de estar PENDIENTE";
          |MENAV aAlfa;
     |FINSI;
     |SI nMensaje = 2;
          aAlfa = "    Los siguientes campos han cambiado: "
          aAlfa = aAlfa + aCambios;
          |MENAV aAlfa;
     |FINSI;
     |SI nMensaje = 3;
          aAlfa1 = #silcon18#2; aAlfa1 = "000000" + aAlfa1; aAlfa1 = aAlfa1 % -106;
          aAlfa = "    Consulte los movimientos FDI ENVIADOS: ";
          aAlfa = aAlfa + "Linea " + aAlfa1;
          |MENAV aAlfa;
     |FINSI;
     |SI nMensaje = 4;
          aAlfa = "    ATENCION: ya existe un movimiento FDI de baja PENDIENTE. ";
          aAlfa = aAlfa + "Las modificaciones se grabaran sobre este movimiento";
          |MENAV aAlfa;
     |FINSI;
     |SI nMensaje = 6;
          aAlfa1 = #silcon18#2; aAlfa1 = "000000" + aAlfa1; aAlfa1 = aAlfa1 % -106;
          aAlfa = "    Consulte los movimientos FDI PENDIENTES: ";
          aAlfa = aAlfa + "Linea " + aAlfa1;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO ElRed;
     |ABRE #silcon18;
     |SELECT #3#silcon18;
     |LEE 101#silcon18.u;
     nContador = #silcon18#2;
     nContador = nContador + 1;
     |DDEFECTO #silcon18;

     swYaExiste = 0;
     |SELECT #2#silcon18;
     #silcon18#0 = #labparac#1;
     #silcon18#1 = #labparac#2;
     #silcon18#7 = #labparac#15;
     #silcon18#3 = "B";
     |LEE 000#silcon18.=;
     |SI FSalida = 0; |Y #silcon18#20 = "*";
          |QBF aCambios;
          aCambios = aCambios - ", ";
          |SI aCambios ! "";
               nMensaje = 1;
               |HAZ mensajes;
               nMensaje = 2;
               |HAZ mensajes;
               nMensaje = 3;
               |HAZ mensajes;
          |FINSI;
     |SINO;
          |SI FSalida = 0;
               swYaExiste = 1;     || si ya existe no tengo por que aumentar
          |SINO;                   || el contador de los cojones
               #silcon18#2 = nContador;      || contador
          |FINSI;
          #silcon18#4 = "3";            || accidente de trabajo
          |SI #labparac#40 = "R";       || recaida S/N
               #silcon18#5 = "S";
          |SINO;
               #silcon18#5 = "N";
          |FINSI;
          #silcon18#6 = ~;              || fecha creacion parte
          #silcon18#14 = #labparac#37;  || dias cotizados mes
          #silcon18#16 = #labparac#36;  || base cotizacion mes anterior
          #silcon18#24 = #labparac#38;  || base cotizacion horas extras
          #silcon18#25 = #labparac#39;  || base cotizacion otros
          #silcon18#20 = "-";
          #silcon18#21 = " ";
          #silcon18#8 = #labparac#104;          || categoria
          #silcon18#9 = #labparac#105;          || dias probables baja
          #silcon18#10 = #labparac#106;         || meses probables baja
          #silcon18#11 = #labparac#107;         || nro colegiado: prov
          #silcon18#12 = #labparac#108;         || nro colegiado: num
          #silcon18#13 = #labparac#109;         || CIAS

          |SI swYaExiste = 0;
               |GRABA 020#silcon18.n;
               aAlfa2 = "    Creado ";
               aCambios = "ALTA";
          |SINO;
               |SI aCambios ! "";
                    |GRABA 020#silcon18.a;
                    aAlfa2 = "    Modificado ";
               |FINSI;
          |FINSI;
          |SI FSalida = 0; |Y aCambios ! "";
               aAlfa1 = #silcon18#2; aAlfa1 = "000000" + aAlfa1; aAlfa1 = aAlfa1 % -106;
               aAlfa = aAlfa2 + "movimiento FDI pendiente numero " + aAlfa1;
               aAlfa = aAlfa + " con exito.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |CIERRA #silcon18;
|FPRC;

|PROCESO GuardaCopia;
     || AQUI ME GUARDARE UN COPIA DEL PARTE QUE HE EMITIDO, PARA LUEGO PODER
     || CREAR LA REMESA EN XML RESPECTO DE LO QUE HE HECHO

     |ABRE #labparhi;
     #labparhi#1 = #labparac#1;
     #labparhi#2 = #labparac#2;
     #labparhi#15 = #labparac#15;
     |LEE 000#labparhi.=;
     FEstado = FSalida;
     |PARA nCampo = 4; |SI nCampo [ 112; |HACIENDO nCampo = nCampo + 1;
          #labparhi#nCampo# = #labparac#nCampo#;
     |SIGUE;

     |SI FEstado ! 0;
          #labparhi#0 = "-";
          #labparhi#99 = nContador;
          |GRABA 020#labparhi.n;
     |SINO;
          |GRABA 020#labparhi.a;
          ||        ERROR, NO DEBE PRODUCIRSE ... CONTROLADO ANTES
     |FINSI;

     |LIBERA #labparhi;
     |CIERRA #labparhi;
|FPRC;

|PROCESO Contador;
     |SELECT #3#labparma;
     |LEE 000#labparma.u;
     |SI FSalida = 0;
          nContador = #labparma#0;
          nContador = nContador + 1;
     |SINO;
          nContador = 1;
     |FINSI;
     |SELECT #1#labparma;
|FPRC;

|PROCESO Remesa;
     |ABRE #labparma;
     |HAZ Contador;

     |DDEFECTO #labparma;
     #labparma#1 = #0#1;      || empresa
     #labparma#2 = #0#2;      || trabajador
     #labparma#3 = #0#15;     || fecha inicio baja

     #labparma#0 = nContador; || numero de parte
     #labparma#4 = "PAT";     || parte de accidente
     #labparma#5 = ~;         || fecha de creacion del parte

     #labparma#6 = "-";
     #labparma#8 = " ";

     |LEE 000#labparma.=;

     |SI FSalida = 0;
          |SI #labparma#6 = "*";
               aAlfa = "    ATENCION. Ya se ha generado y emitido la remesa ";
               aAlfa = aAlfa + "para este parte.";
               |MENAV aAlfa;
               aAlfa = "    Para volver a generarla debera dejar la remesa ";
               aAlfa = aAlfa + "como NO EMITIDA en Consulta de Partes Enviados";
               |MENAV aAlfa;
          |SINO;
               aAlfa = "    ATENCION. Ya se ha generado la remesa para este ";
               aAlfa = aAlfa + "parte.";
               |MENAV aAlfa;
               aAlfa = "    Si desea modificar el parte debera ir a Consulta";
               aAlfa = aAlfa + " de partes de accidente pendientes."
               |MENAV aAlfa;
          |FINSI;
     |SINO;
          |GRABA 020#labparma.n;
          |HAZ GuardaCopia;
     |FINSI;
     |CIERRA #labparma;
|FPRC;

|PROCESO CargaModif;
     |ABRE #labparhi;
     #labparhi#1 = nEmpExt;
     #labparhi#2 = nTraExt;
     #labparhi#15 = fFecExt;
     |LEE 000#labparhi.=;
     |SI FSalida = 0;
          |PARA nCampo = 0; |SI nCampo [ 112; |HACIENDO nCampo = nCampo + 1;
               #labparac#nCampo# = #labparhi#nCampo#;
          |SIGUE;
     |SINO;
          |MENAV "    ATENCION: No existe el parte asociado";
          swNoSigas = 1;
          ||        ERROR, NO DEBE PRODUCIRSE ... CONTROLADO ANTES
     |FINSI;
     |CIERRA #labparhi;
|FPRC;

|PROCESO BuscaParam;
     |ABRE #labcontr;
     |LEE 000#labcontr.p;
     |CIERRA #labcontr;
|FPRC;

|PROCESO ElProceso;
     |SI aParam ! "MODIF";
          |HAZ BuscaParam;
          |MENU menu;         || menu impresion y remesa
          |SI FSalida = 1;
               |HAZ imprime;       || opcion 1: imprimo siempre
               |SI FEstado = 0;    || si hemos impreso guay
                    |SI #labcontr#52 = "S";
                         |HAZ Remesa;        || guardo remesa

                         aAlfa = "    Se ha guardado el parte de accidente";
                         aAlfa = aAlfa + " para la creacion de la remesa";
                         aAlfa = aAlfa + " para el Sistema Delt@.";
                         |MENAV aAlfa;
                         aAlfa = "    Para modificar este parte, debe";
                         aAlfa = aAlfa + "ra usar la opcion 'Consulta ";
                         aAlfa = aAlfa + "Partes de Accidente Pendientes'";
                         |MENAV aAlfa;
                    |SINO;
                         aAlfa = "    ATENCION: para enviar el parte ";
                         aAlfa = aAlfa + "por el Sistema Delt@ de";
                         aAlfa = aAlfa + "bera activar la opcion en el Control de ";
                         aAlfa = aAlfa + "la Aplicacion";
                         |MENAV aAlfa;
                    |FINSI;
                    ||GRABA 020#0a;
               |FINSI;
          |FINSI;
/*
               |MENU Bmenu;        || menu solo impresion
               |SI FSalida = 1;
                    |HAZ imprime;       || opcion 1: imprimo solo
                    |GRABA 020#0a;
               |FINSI;
*/
     |SINO;
          |HAZ GuardaCopia;
     |FINSI;
     |SI #labcontr#53 = "S";
          |HAZ ElRed;
     |FINSI;
|FPRC;

|PROCESO CamposInforme;
     |ABRE #labcentr;
     #labcentr#0 = #labtraba#0;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;
     |SI FSalida = 0;
          aDomCentro = #labcentr#3;
          |QBF aDomCentro;
          aDomCentro = aDomCentro + ", " + #labcentr#4 + " - " + #labcentr#5;
          aAlfa1 = #labcentr#7;
          aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #labcentr#8;
          aAlfa2 = ("000" + aAlfa2) % -103;
          aDomCentro2 = aAlfa1 + aAlfa2 + "  ";
          aAlfa1 = #labcentr#6; |QBF aAlfa1;
          aAlfa2 = #labcentr#9; |QBF aAlfa2;
          aDomCentro2 = aDomCentro2 + aAlfa1 + " (" + aAlfa2 + ")";
     |FINSI;
     |CIERRA #labcentr;

     |ABRE #labempre;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;
     #labempre#13 = #labcentr#10;
     |CIERRA #labempre;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |QBF aParam;
     |CLS;
     |CABEZA "Partes Accidente";
     |PINPA #0#0;
     |HAZ BuscaParam;
     aCambios = "";
     |SI elsw1 = 0;
          ||DELINDEX #0;
          |DDEFECTO #0;
          ||ABRE #0;
          ||LEE 101#0p;
          ||SI FSalida ! 0;    |GRABA 020#0b; |FINSI;
          |SI aParam = "MODIF";
               |HAZ CargaModif;
               |SI swNoSigas = 0;
                    |PINDA #0#0;
                    |CAMPO_MODIFICA #0#1, 1, "N";
                    |CAMPO_MODIFICA #0#2, 1, "N";
                    |CAMPO_MODIFICA #0#15, 1, "N";
                    |ENDATOS #1#0;
               |FINSI;
          |FINSI;
          |SI aParam = "";
               |PINDA #0#0;
               |ENDATOS #1#0;
          |FINSI;
          |SI FSalida = 0; |Y aParam ! "IMPRESION";
               |HAZ ElProceso;
          |FINSI;

          |SI aParam = "IMPRESION";
               #0#1 = nEmpExt;
               #0#2 = nTraExt;
               #0#15 = fFecExt;
               |SI aRecExt = "S";
                    #0#40 = "R";
               |SINO;
                    #0#40 = "A";
               |FINSI;
               |PINDA #0#0;
               |CAMPO_MODIFICA #0#1, 1, "N";
               |CAMPO_MODIFICA #0#2, 1, "N";
               |CAMPO_MODIFICA #0#15, 1, "N";
               |CAMPO_MODIFICA #0#40, 1, "N";

               |PINDA #0#0;
               |ENDATOS #1#0;
               |SI FSalida = 0;
                    aAlfa = "     Desea imprimir el informe con datos de Parte de Accidente?";
                    |CONFI aAlfa;
                    |SI FSalida = 0;
                         |HAZ CamposInforme;
                         Impresora = "CrystalReport";
                         |IMPRE -1;
                         |INFOR "labdapar";
                         |PRINT;
                         |PIEINF;
                         |FININF;
                         |FINIMP;
                    |FINSI;
               |FINSI;
          |FINSI;

          ||LIBERA #0;
          ||CIERRA #0;
     |FINSI;
|FPRO;

|PROCESO P; |TIPO 7;
     |PINTA #labparac#74;
|FPRC;
