|| recibos mensuales por impresora

|FICHEROS;
     sempascu #00;   || def de impresion
     nomcalcu #40;
|FIN;

|VARIABLES;
    &acum = 1;
    runnom = "nomyreci";
    salte_1 = 0;
    salte_2 = 0;
|FIN;

|INCLUYE i_cuadr;
|INCLUYE i_yreci;
||INCLUYE i_parri;
||INCLUYE i_verif;

*************************************************************************
          CALCULOS DESDE CAMPOS
*************************************************************************

|PROCESO pintames; |TIPO 0;
|HAZ pintames1;
|PINTA 0655, p_mes;
|FPRC;

*************************************************************************
          CALCULOS DE IMPRESION
*************************************************************************

|PROCESO imprime;
|INFOR "sempascu";
|PRINT;
|PIEINF;
|FININF;
|FPRC;

|DEFBUCLE nomyreci0;
 #4#1;
 ;
 #0#0, #0#2, #0#5, #0#10;
 #0#1, #0#3, #0#5, #0#10;
 ;
 NULL, proceso;
|FIN;

|DEFBUCLE nombres;
 #4#1;
 ;
 #0#0, #0#2, #0#5, #0#10;
 #0#1, #0#3, #0#5, #0#10;
 ;
 NULL, ordena, NULL, NULL, NULL, proceso;
 #2#0, #2#2, #2#1, #4#3;
|FIN;

|DEFBUCLE areas;
 #4#1;
 ;
 #0#0, #0#2, #0#5, #0#10;
 #0#1, #0#3, #0#5, #0#10;
 ;
 NULL, ordena, NULL, NULL, NULL, proceso;
 #2#0, #2#62, #2#63, #2#1, #4#3;
|FIN;

|DEFBUCLE centros;
 #4#1;
 ;
 #0#0, #0#2, #0#5, #0#10;
 #0#1, #0#3, #0#5, #0#10;
 ;
 NULL, ordena, NULL, NULL, NULL, proceso;
 #2#0, #2#77, #2#1, #4#3;
|FIN;

|DEFBUCLE tc2;
 #4#1;
 ;
 #0#0, #0#2, #0#5, #0#10;
 #0#1, #0#3, #0#5, #0#10;
 ;
 NULL, ordena, NULL, NULL, NULL, proceso;
 #2#0, #0#64, #102#142, #2#75, #2#1, #4#3;
|FIN;

|PROCESO impre; |TIPO 3;
    c_informe = "nomyreci";
|HAZ cuadres;
|SI sw_cuadre = 0;
    |IMPRE 0;
    |SI FSalida = 0;
        |ABRE #1;
        |ABRE #2;
        |ABRE #3;
        |ABRE #6;
        |ABRE #35;
        |ABRE #100;
        |ABRE #102;
            seleccio = 0;
        |SI #0#21 = 0;
            |SI #0#63 = 1;    |BUCLE nomyreci0;   |FINSI;
            |SI #0#63 = 2;    |BUCLE nombres;     |FINSI;
            |SI #0#63 = 3;    |BUCLE areas;       |FINSI;
            |SI #0#63 = 4;    |BUCLE centros;     |FINSI;
            |SI #0#63 = 5;    |BUCLE tc2;         |FINSI;
        |SINO;
            |HAZ salteada;
        |FINSI;
        |SI seleccio = 0;
            |MENAV "    Seleccion vacia ...";
        |FINSI;
        |CIERRA #1;
        |CIERRA #2;
        |CIERRA #3;
        |CIERRA #6;
        |CIERRA #35;
        |CIERRA #100;
        |CIERRA #102;
    |SINO;
        |MENAV "    Proceso ABORTADO !!!";
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

/********************************************************************/
/*                  EL i_parri de AGINOM                            */
/********************************************************************/

|PROCESO parrilla; |TIPO 7;
|ABRE #40;
|LEE 001#40p;
|SI FSalida ! 0;  |DDEFECTO #40;  |FINSI;
|PARA nume1 = 21; |SI nume1 [ 41; |HACIENDO nume1 = nume1 + 1;
        nume2 = nume1 + 21;
        #0nume1 = #40nume1;
        #0nume2 = #40nume2;
|SIGUE;
    #0#0 = #40#0;
    #0#1 = #40#1;        || desde/hasta empresa/trabajador
    #0#2 = #40#2;
    #0#3 = #40#3;
    #0#4 = #40#9 $ 100;  || a¤o
    #0#5 = #40#8;        || mes
|CIERRA #40;
|PINDA #0#0;
|FPRC;

|PROCESO seleccion; |TIPO 0;
|SI #0#21 = 0;
    |CAMPO_MODIFICA #0#0, 1, "S";
    |CAMPO_MODIFICA #0#1, 1, "S";
    |CAMPO_MODIFICA #0#2, 1, "S";
    |CAMPO_MODIFICA #0#3, 1, "S";
    |CAMPO_MODIFICA #0#63, 1, "S";
    |CAMPO_MODIFICA #0#22, 1, "N";
    |CAMPO_MODIFICA #0#23, 1, "N";
    |CAMPO_MODIFICA #0#24, 1, "N";
    |CAMPO_MODIFICA #0#25, 1, "N";
    |CAMPO_MODIFICA #0#26, 1, "N";
    |CAMPO_MODIFICA #0#27, 1, "N";
    |CAMPO_MODIFICA #0#28, 1, "N";
    |CAMPO_MODIFICA #0#29, 1, "N";
    |CAMPO_MODIFICA #0#30, 1, "N";
    |CAMPO_MODIFICA #0#31, 1, "N";
    |CAMPO_MODIFICA #0#32, 1, "N";
    |CAMPO_MODIFICA #0#33, 1, "N";
    |CAMPO_MODIFICA #0#34, 1, "N";
    |CAMPO_MODIFICA #0#35, 1, "N";
    |CAMPO_MODIFICA #0#36, 1, "N";
    |CAMPO_MODIFICA #0#37, 1, "N";
    |CAMPO_MODIFICA #0#38, 1, "N";
    |CAMPO_MODIFICA #0#39, 1, "N";
    |CAMPO_MODIFICA #0#40, 1, "N";
    |CAMPO_MODIFICA #0#41, 1, "N";
    |CAMPO_MODIFICA #0#42, 1, "N";
    |CAMPO_MODIFICA #0#43, 1, "N";
    |CAMPO_MODIFICA #0#44, 1, "N";
    |CAMPO_MODIFICA #0#45, 1, "N";
    |CAMPO_MODIFICA #0#46, 1, "N";
    |CAMPO_MODIFICA #0#47, 1, "N";
    |CAMPO_MODIFICA #0#48, 1, "N";
    |CAMPO_MODIFICA #0#49, 1, "N";
    |CAMPO_MODIFICA #0#50, 1, "N";
    |CAMPO_MODIFICA #0#51, 1, "N";
    |CAMPO_MODIFICA #0#52, 1, "N";
    |CAMPO_MODIFICA #0#53, 1, "N";
    |CAMPO_MODIFICA #0#54, 1, "N";
    |CAMPO_MODIFICA #0#55, 1, "N";
    |CAMPO_MODIFICA #0#56, 1, "N";
    |CAMPO_MODIFICA #0#57, 1, "N";
    |CAMPO_MODIFICA #0#58, 1, "N";
    |CAMPO_MODIFICA #0#59, 1, "N";
    |CAMPO_MODIFICA #0#60, 1, "N";
    |CAMPO_MODIFICA #0#61, 1, "N";
    |CAMPO_MODIFICA #0#62, 1, "N";
    |PARA nume1 = 21; |SI nume1 [ 62; |HACIENDO nume1 = nume1 + 1;
        #0nume1 = 0;
    |SIGUE;
    |PINDA #0#0;
|SINO;
    |CAMPO_MODIFICA #0#0, 1, "N";
    |CAMPO_MODIFICA #0#1, 1, "N";
    |CAMPO_MODIFICA #0#2, 1, "N";
    |CAMPO_MODIFICA #0#3, 1, "N";
    |CAMPO_MODIFICA #0#63, 1, "N";
    |CAMPO_MODIFICA #0#22, 1, "S";
    |CAMPO_MODIFICA #0#23, 1, "S";
    |CAMPO_MODIFICA #0#24, 1, "S";
    |CAMPO_MODIFICA #0#25, 1, "S";
    |CAMPO_MODIFICA #0#26, 1, "S";
    |CAMPO_MODIFICA #0#27, 1, "S";
    |CAMPO_MODIFICA #0#28, 1, "S";
    |CAMPO_MODIFICA #0#29, 1, "S";
    |CAMPO_MODIFICA #0#30, 1, "S";
    |CAMPO_MODIFICA #0#31, 1, "S";
    |CAMPO_MODIFICA #0#32, 1, "S";
    |CAMPO_MODIFICA #0#33, 1, "S";
    |CAMPO_MODIFICA #0#34, 1, "S";
    |CAMPO_MODIFICA #0#35, 1, "S";
    |CAMPO_MODIFICA #0#36, 1, "S";
    |CAMPO_MODIFICA #0#37, 1, "S";
    |CAMPO_MODIFICA #0#38, 1, "S";
    |CAMPO_MODIFICA #0#39, 1, "S";
    |CAMPO_MODIFICA #0#40, 1, "S";
    |CAMPO_MODIFICA #0#41, 1, "S";
    |CAMPO_MODIFICA #0#42, 1, "S";
    |CAMPO_MODIFICA #0#43, 1, "S";
    |CAMPO_MODIFICA #0#44, 1, "S";
    |CAMPO_MODIFICA #0#45, 1, "S";
    |CAMPO_MODIFICA #0#46, 1, "S";
    |CAMPO_MODIFICA #0#47, 1, "S";
    |CAMPO_MODIFICA #0#48, 1, "S";
    |CAMPO_MODIFICA #0#49, 1, "S";
    |CAMPO_MODIFICA #0#50, 1, "S";
    |CAMPO_MODIFICA #0#51, 1, "S";
    |CAMPO_MODIFICA #0#52, 1, "S";
    |CAMPO_MODIFICA #0#53, 1, "S";
    |CAMPO_MODIFICA #0#54, 1, "S";
    |CAMPO_MODIFICA #0#55, 1, "S";
    |CAMPO_MODIFICA #0#56, 1, "S";
    |CAMPO_MODIFICA #0#57, 1, "S";
    |CAMPO_MODIFICA #0#58, 1, "S";
    |CAMPO_MODIFICA #0#59, 1, "S";
    |CAMPO_MODIFICA #0#60, 1, "S";
    |CAMPO_MODIFICA #0#61, 1, "S";
    |CAMPO_MODIFICA #0#62, 1, "S";
|FINSI;
|FPRC;

|PROCESO salteada;
|ABRE #4;
|PARA salte_1 = 21; |SI salte_1 [ 41; |HACIENDO salte_1 = salte_1 + 1;
        salte_2 = salte_1 + 21;
        #4#0 = #0salte_1;     || empresa
        #4#1 = #0salte_2;     || trabajador
        #4#2 = #0#5;          || mes
        #4#3 = #0#10;         || tipo
        #4#66 = #0#4;         || a¤o (en las emisiones desde el historico)
    |LEE 001#4=;
    |SI FSalida = 0;
        |HAZ proceso;
    |FINSI;
|SIGUE;
|CIERRA #4;
|FPRC;
