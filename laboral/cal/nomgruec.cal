|FICHEROS;
    nomgruec #0;
    nomgruel #1;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    FEstado = 0;
    seleccio = 0;
    vale = 0;
    modo = 0;
    ant_grupo = -1;
    ant_empre = -1;
    nModo = 0;
    nTipo = 0;
    nNoPreguntes = 0;
    nConserva = 0;
    aConserva = "";
|FIN;
____________________________________/
|PROCESO miralo1;
     |SI #1#0 ! #0#0;
          alfa1 = "    ATENCION!!! Esta Empresa pertenece a la planilla " + #1#0;
          |MENAV alfa1;
          vale = 1;
     |FINSI;
|FPRC;

|DEFBUCLE miralo;
 #1#1;
 ;
     1, #0#0;
 99999, #0#0;
 e;
 NULL, miralo1;
|FIN;

|PROCESO comprueba; |TIPO 0;
    modo = (FEntrada / 100) ! 0;
|SI modo = 1;
        vale = 0;
    |BUCLE miralo;
    |SI vale = 1;
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO dupli1;
|SI ant_empre = #1#1;
        vale = 1;
        alfa1 = "    Empresa " + ant_empre + " en planillas " + ant_grupo + " y " + #1#0;
        |MENAV alfa1;
|SINO;
        ant_grupo = #1#0;
        ant_empre = #1#1;
|FINSI;
|FPRC;

|DEFBUCLE dupli;
 #1#2;
 ;
     1,     1;
 99999, 99999;
 ;
 NULL, dupli1;
|FIN;

|PROCESO chequea; |TIPO 9;
    vale = 0;
||CONFI "    NChequear duplicidades (S/N): ";
||SI FSalida = 0;
    |BUCLE dupli;
    |SI vale = 1;
        ||PTEC 802;
    |FINSI;
||FINSI;
|FPRC;

|PROCESO Tipo2Lins; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |SI nNoPreguntes ! #1#0;
               |MENAV "0000Alterar una planilla le obliga a recalcular acumulados ...";
               |CONFI "0000NDesea alterarlo de todas formas (S/N): ";
          |SINO;
               FSalida = 0;
          |FINSI;
          |SI FSalida = 0;
               nNoPreguntes = #1#0;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
    |SI FSalida = 1;
       nConserva = #1#1;
       aConserva = #1#2;
       |BUCLE dupli;
       #1#1 = nConserva;
       #1#2 = aConserva;
       |PINTA #1#1;
       || SI vale = 1; |MENAV "    Error"; |ERROR; |FINSI;
    |FINSI;
|FPRC;
