|FICHEROS;
     bomb0001 #1;
     bomb0002 #2,MANTE;
     nomconst #3;
     nomtrato #4;
|FIN;

|VARIABLES;
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     nNume = 0;
     inkey = 0;
     fecsys = @;
|FIN;

|PROCESO MinConst;
     #nomconst#88 = 111;
     #nomconst#79 = aAlfa1;
     #nomconst#0 = 001;
|FPRC;

|PROCESO MaxConst;
     #nomconst#88 = 111;
     #nomconst#79 = aAlfa2;
     #nomconst#0 = 999;
|FPRC;

|PROCESO ConsultaConst; |TIPO 0;
     inkey = FSalida;
     |ABRE #nomconst;
     |SI inkey = 13;
          fecsys = ~;
          aAlfa = fecsys;
          aAlfa1 = "01.01." + (aAlfa % -104);
          aAlfa2 = "31.12." + (aAlfa % -104);
          |CONSULTA_F_CLAVE #4#nomconst, MinConst, MaxConst;
          |SI FSalida = 0;
               #2#4 = #nomconst#0;
               |PINTA #2#4;
               #2#5 = #nomconst#1;
               |PINTA #2#5;
          |SINO;
               |ERROR;
          |FINSI;
     |SINO;
          |SELECT #5#nomconst;
          #nomconst#88 = 111;
          #nomconst#0 = #2#4;
          |LEE 000#nomconst.=;
          |SI FSalida ! 0;
               aAlfa = "    ERROR: Constante no encontrada en el Fichero de Constantes. ";
               aAlfa = aAlfa + "Pulse F5 para consultar disponibles."
               |MENAV aAlfa;
               |ERROR;
          |SINO;
               #2#5 = #nomconst#1;
               |PINTA #2#5;
          |FINSI;
     |FINSI;
     |CIERRA #nomconst;
|FPRC;

|PROCESO PintaContrato; |TIPO 7;
     #2#3 = #nomtrato#2;
     |PINTA #2#3;
|FPRC;

|PROCESO Min;
     #nomtrato#0 = 111;
     #nomtrato#1 = 001;
|FPRC;

|PROCESO Max;
     #nomtrato#0 = 111;
     #nomtrato#1 = 999;
|FPRC;

|PROCESO ConsultaContrato; |TIPO 11;
     |SI FSalida = 13;
          |ABRE #nomtrato;
          |CONSULTA_F_CLAVE #1#nomtrato, Min, Max;
          |SI FSalida = 0;
               #2Campo = #nomtrato#1;
               |PINTA #2Campo;
               #2#3 = #nomtrato#2;
               |PINTA #2#3;
          |SINO;
               |ERROR;
          |FINSI;
          |CIERRA #nomtrato;
     |FINSI;
|FPRC;

|PROCESO ValidaContrato;
     |ABRE #nomtrato;
     nNume = #2#2;
     #nomtrato#0 = 111;
     #nomtrato#1 = nNume;
     |LEE 000#nomtrato.=;
     |SI FSalida ! 0;
          aAlfa = nNume;
          aAlfa = "    El contrato " + aAlfa + " no existe en el Mantenimiento ";
          aAlfa = aAlfa + "de Contratos. Pulse F5 para ver los existentes."
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #nomtrato;
|FPRC;
