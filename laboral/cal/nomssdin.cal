|FICHEROS;
     nomssdin #0;
     nomcalca;
     nomhicca;
     nomssfan;

     labempre;
     labtraba;
|FIN;

|VARIABLES;
     &nSSEmpLot = 0;
     &nSSTraLot = 0;
     &nSSEmpMan = 0;
     &nSSTraMan = 0;
     nDiferencia = 0;

     &nCtoMan = 0;
     &nCteMan = 0;
     &aCNAMan = "";
     &aOcuMan = "";
|FIN;

|PROCESO nomssfan;
     nSSEmpLot = 0;
     nSSTraLot = 0;
     nSSEmpMan = 0;
     nSSTraMan = 0;

     nSSEmpLot = #nomssfan#9;
     nSSTraLot = #nomssfan#10;

     #nomcalca#0 = #nomssfan#0;
     #nomcalca#1 = #nomssfan#1;
     #nomcalca#2 = #nomssfan#3;
     #nomcalca#3 = #nomssfan#4;
     |LEE 000#nomcalca.=;
     |SI FSalida = 0;
          nSSEmpMan = #nomcalca#45;
          nSSTraMan = #nomcalca#48 + #nomcalca#49;
          nSSTraMan = nSSTraMan + #nomcalca#50 + #nomcalca#51;

          nCtoMan = #nomcalca#9;
          nCteMan = #nomcalca#163;
          aCNAMan = #nomcalca#161;
          aOcuMan = #nomcalca#162;
     |SINO;
          #nomhicca#0 = #nomssfan#0;
          #nomhicca#1 = #nomssfan#1;
          #nomhicca#66 = #nomssfan#2 - 2000;
          #nomhicca#2 = #nomssfan#3;
          #nomhicca#3 = #nomssfan#4;
          |LEE 000#nomhicca.=;
          |SI FSalida = 0;
               nSSEmpMan = #nomhicca#45;
               nSSTraMan = #nomhicca#48 + #nomhicca#49;
               nSSTraMan = nSSTraMan + #nomhicca#50 + #nomhicca#51;

               nCtoMan = #nomhicca#9;
               nCteMan = #nomhicca#205;
               aCNAMan = #nomhicca#203;
               aOcuMan = #nomhicca#204;
          |FINSI;
     |FINSI;

     #labempre#0 = #nomssfan#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomssfan#0;
     #labtraba#1 = #nomssfan#1;
     |LEE 000#labtraba.=;

     nDiferencia = nSSEmpMan + nSSTraMan - nSSEmpLot - nSSTraLot;
     |SI -0.05 [ nDiferencia; |Y nDiferencia [ 0.05;
          || diferencia entre -5 y 5 centimos
     |SINO;
          |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE nomssfan;
     #nomssfan#1;
     ;
     #0#0, #0#2, #0#4, #0#5, #0#6;
     #0#1, #0#3, #0#4, #0#5, #0#6;
     ;
     NULL, nomssfan;
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "nomssdin";

               |ABRE #labempre;
               |ABRE #labtraba;
               |ABRE #nomcalca;
               |ABRE #nomhicca;
               |BUCLE nomssfan;
               |CIERRA #nomhicca;
               |CIERRA #nomcalca;
               |CIERRA #labtraba;
               |CIERRA #labempre;

               |PIEINF;
               |FININF;
               |FINIMP;
          |FINSI;
     |FINSI;
|FPRO;
