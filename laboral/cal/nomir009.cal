|FICHEROS;
     nomir009 #0;
     nomcontr #1;
     nomir010 #2,MANTE;
     nomgir9z #100;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;
     aAlfa = "";
     aHora = "";
     nNume = 0;
     nCampo = 0;
     fFecha = @;
|FIN;

|PROCESO nomir009;
     #nomir009#7 = aAlfa1;
     |GRABA 020#nomir009.a;
     |LIBERA #nomir009;
|FPRC;

|DEFBUCLE nomir009;
     #nomir009#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, nomir009;
|FIN;

|PROCESO DesactivaJulio; |TIPO 14;
|ACABA;
|| nada, al final no hago esto, nos va a complicar la vida y puede
|| meterse en un lio mas de uno por una tonteria

     |SI FSalida = 13; |O FSalida = 14;
          |SI FSalida = 13;
               aAlfa1 = "N";
          |FINSI;
          |SI FSalida = 14;
               aAlfa1 = "S";
          |FINSI;
          |SI aAlfa1 = "N";
               aAlfa2 = " desactivará"
          |FINSI;
          |SI aAlfa1 = "S";
               aAlfa2 = " activará"
          |FINSI;
          aAlfa2 = "    ATENCION. Se " + aAlfa2 + " la regularización ";
          aAlfa2 = aAlfa2 + "en la nómina de julio para todas las empresas.";
          |MENAV aAlfa2;
          |CONFI "    S¿Está seguro de que desea continuar?";
          |SI FSalida = 0;
               nNume1 = #nomir009#0;
               |BUCLE nomir009;
               #nomir009#0 = nNume1;
               |LEE 000#nomir009.=;
               |PONCONTROL 23, "si";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaLog;
     |ABRE #100;
     #100#0 = #0#0;
     #100#3 = 999999;
     |LEE 000#100];
     |SI FSalida = 0;
          |LEE 000#100a;
          |SI #100#0 = #0#0;
               nNume = #100#3 + 1;
          |SINO;
               nNume = 1;
          |FINSI;
     |SINO;
          |SI FSalida = 110;            || EOF
               |LEE 000#100u;
               nNume = #100#3 + 1;
          |SINO;
               nNume = 1;               || el primero
          |FINSI;
     |FINSI;

     #100#0 = #0#0;
     #100#1 = #0#13;
     #100#2 = #2#7;
     #100#3 = nNume;
     aAlfa = Usuario % 0810; |QBF aAlfa;
     #100#4 = aAlfa;

     fFecha = ~;
     #100#5 = fFecha;

     |HORA aHora;
     |QBF aHora;
     aHora = aHora % 105;
     #100#6 = aHora;
     #100#7 = "nomir009";

     |GRABA 101#100n;
     |LIBERA #100

     |CIERRA #100;
|FPRC;
____________________________________/
|PROCESO Tipo2; |TIPO 2;
     nModo = 0 +. 1;
     |SI nModo ! 1; |ACABA;   |FINSI;

     |PUSHV 0501 2380;
     |DDEFECTO #2;
     |PINPA #0#2;
     #2#0 = #0#14;  || importes variaciones
     #2#1 = #0#15;  || resultados
     #2#2 = #0#16;  || actualizar (%)
     #2#3 = #0#17;  || actualizar (%)
     #2#4 = #0#18;  || importes variables
     #2#5 = #0#19;  || importes variables
     #2#6 = #0#20;  || acumulados historico
     #2#7 = #0#21;  || gestor incidencias IRPF
     |PINDA #0#2;
     |ENDATOS #1#2;
     |SI FSalida = 0;
          #0#14 = #2#0;
          #0#15 = #2#1;
          #0#16 = #2#2;
          #0#17 = #2#3;
          #0#18 = #2#4;
          #0#19 = #2#5;
          #0#20 = #2#6;
          |SI #0#21 ! #2#7;
               |HAZ GrabaLog;
          |FINSI;
          #0#21 = #2#7;
     |FINSI;
     |POPV;
     |SI #0#19 = 2; |Y #0#1 ! "S";
          aAlfa1 = "    ATENCION: Para aplicar el valor del parametro 5 se activara ";
          aAlfa1 = aAlfa1 + "la regularizacion en Enero.";
          |MENAV aAlfa1;
          #0#1 = "S";
          |PINTA #0#1;
     |FINSI;
|FPRC;

|PROCESO Alta; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |DDEFECTO #1;
          |ABRE #1;
          |LEE 000#1p;
          |CIERRA #1;

          |PARA nPara1 = 1; |SI nPara1 [ 12; |HACIENDO nPara1 = nPara1 + 1;
               nPara2 = nPara1 + 20;
               #0nPara1 = #1nPara2;
          |SIGUE;
          |PINDA #0#0;
     |FINSI;
|FPRC;

|PROCESO mayus; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO min0;
     #0#0 = 1;
|FPRC;

|PROCESO max0;
     #0#0 = 99999;
|FPRC;

|PROGRAMA;
|CLS;
|CABEZA "REGUL.AUTOMATICA";
|ABRET #0;
|ENTLINEAL #1#0, -1, 1, 21, 1, min0, max0;
|CIERRAT #0;
|FPRO;
