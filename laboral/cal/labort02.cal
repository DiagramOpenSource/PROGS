|FICHEROS;
     labort02 #0

     nomregim;
     nomtrato;
     labcentr;
     nomcateg;
     silcon06;
     silcon15;
     labempre;
     labcentr;
     nomconca;
     nomcateg;
     motibaja;

     labort03,MANTE;
     labcontr;
|FIN;

|VARIABLES;
     aHora = "";
     &eaVarDni  = "";
     &enCalcCif = 0;

     &eaDirDest  = "";
     &eaAsunto   = "";
     &eaTexto    = "";

     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     nume4 = 0;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     corta = 0;
     sitio = 0;
     jg = 0;

     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;

     aAlfa = "";
     nNume = 0;

     &eaUsuario = "";
     &eaFecha = @;
     &eaHora = "";
     &eaEstado = "";
     &aParam = "";

     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aFechaNac = "";
     fFechaHoy = @;

     aDuracion = "";
     aDiaAlta = "";
     aMesAlta = "";
     aAnyAlta = "";
     aDiaBaja = "";
     aMesBaja = "";
     aAnyBaja = "";

     nDiaAlta = 0;
     nMesAlta = 0;
     nAnyAlta = 0;
     nDiaBaja = 0;
     nMesBaja = 0;
     nAnyBaja = 0;

     &nAnys = 0;
     &nMeses = 0;
     &nDias = 0;
     aDias = "";
     aMeses = "";
     aAnys = "";
     aFechaBaja = "";

     xmesnume = 0;
     xtopemes = 0;
     xmod = 0;
     xanynume = 0;
     fech1 = @;
     fech2 = @;
     aFecha1 = "";
     aFecha2 = "";
     aFechaIni = "";
     fFechaFin = @;
     aFechaFin = "";
     nConvenio = 0;

     dia1 = "";
     mes1 = "";
     any1 = "";
     dia = 0;
     mes = 0;
     any = 0;
     tope = 0;
     sw = 0;
     fec = "";
     mod = 0;

     &eaEmpresa = "";
     &eaTrabajador = "";
     &eaAccion = "";
     &aCadena = "";
     &eaNom = "";
     &eaApel1 = "";
     &eaApel2 = "";

     swPI = 0;
     aBase = "";
     aMas = "";
     swDatosPer = 0;
     swDatosFam = 0;
     nAscendientes = 0;
     nDescendientes = 0;
     swPorDNI = 0;
     aMensaje = "";
     nEmpresas = 0;
     nCodEmp = 0;
     aNomEmp = "";

     enBoton1 = 0;
     enBoton2 = 0;

     aDia = "";
     aMes = "";
     aAny = "";
     fFecha = @;
     aFecha = "";
     &enEmpresa = 0;
     &enBoton3 = 0;
     &enHoras = 0;
     nHoras = 0;
     &swBoton3 = 0;
     &fFechaDesde = @;
     &fFechaHasta = @;
     swSigue = 0;
     swParcial = 0;

     &swCambioManReg = 0;
|FIN;

|PROCESO Defecto229;
     |SI aParam = "MODIF";
          |ACABA;
     |FINSI;
     |SI #0#199 < 400; |Y #0#199 ! 000;
          #0#229 = 1;
     |SINO;
          #0#229 = 2;
     |FINSI;

     |PINTA #0#229;
|FPRC;

|PROCESO DefectoFechas; |TIPO 7;
     aAlfa = eaUsuario;
     aAlfa1 = eaUsuario % 105;
     |QBF aAlfa;
     |SI aAlfa = "WEB"; |O aAlfa1 = "NUBEA";
          |SI #0#198 = 1900;
               #0#196 = 0; #0#197 = 0; #0#198 = 0;
               |PINTA #0#196; |PINTA #0#197; |PINTA #0#198;
          |FINSI;

          |ACABA;
     |FINSI;
     fFecha = ~;
     aFecha = fFecha;
     aDia = aFecha % 102;
     aMes = aFecha % 402;
     aAny = aFecha % -104;
     |SI #0#195 = 1900;
          #0#193 = aDia;
          #0#194 = aMes;
          #0#195 = aAny;
          |PINTA #0#193;
          |PINTA #0#194;
          |PINTA #0#195;
     |FINSI;
     |SI #0#198 = 1900;
          #0#196 = aDia;
          #0#197 = aMes;
          #0#198 = aAny;
          |PINTA #0#196;
          |PINTA #0#197;
          |PINTA #0#198;
     |FINSI;
|FPRC;

|PROCESO Pinta208;
     |SI aParam ! "MODIF"; |Y aParam ! "CONSUL";
          |ABRE #labcontr; |LEE 000#labcontr.=;  |CIERRA #labcontr;
          #0#208 = #labcontr#28;
          |PINTA #0#208;
     |FINSI;
|FPRC;

|PROCESO Pinta229;
     |ATRI I;
     |SI #0#229 = 1;
          |PINTA 1123, "General                                        ";
     |FINSI;
     |SI #0#229 = 2;
          |PINTA 1123, "Duraci¢n inferior a un a¤o                     ";
     |FINSI;
     |SI #0#229 = 3;
          |PINTA 1123, "Relaciones laborales especiales                ";
     |FINSI;
     |SI #0#229 = 4;
          |PINTA 1123, "Espor dica propia de retribuciones por peonadas";
     |FINSI;
     |ATRI 0;
|FPRC;

|PROCESO Ayuda229; |TIPO 7;
     |PUSHV 12222380;
     |ATRI R;
     |PINTA 1223, " Tipo de Relaci¢n Laboral:         ";
     |PINTA 1323, " 1. General                                        ";
     |PINTA 1423, " 2. Duraci¢n inferior a un a¤o                     ";
     |PINTA 1523, " 3. Relaciones laborales especiales de caracter de-";
     |PINTA 1623, "    pendiente (salvo penados y discapacitados)     ";
     |PINTA 1723, " 4. Espor dica propia de retribuciones por peonadas";
     |PINTA 1823, "    o jornales diarios                             ";
     |ATRI 0;
|FPRC;

|PROCESO regimen; |TIPO 66;
     |ABRE #nomregim;
     |CONSULTA_CLAVE #1#nomregim;
     |SI FSalida = 0;
          #0#228 = #nomregim#0;
          |PINTA #0#228;
          alfa1 = #nomregim#1 % 124;
          |ATRI I;  |PINTA 1423, alfa1; |ATRI 0;
     |FINSI;
     |CIERRA #nomregim;
|FPRC;

|PROCESO duracion; |TIPO 0;                 || CALCULA DURACION DE CONTRATOS
     alfa1 = #0#193; alfa1 = ("00" + alfa1) % -102;
     alfa2 = #0#194; alfa2 = ("00" + alfa2) % -102;
     alfa3 = #0#195;
     aFechaIni = alfa1 + "." + alfa2 + "." + alfa3;
     aFechaFin = "";
     nume1 = #0#203 + #0#204;
     |SI nume1 ! 0;
          nume1 = #0#203 / 1000;            || meses a sumar en formato suma
          nume2 = (#0#204 - 1) + nume1;     || fecha a sumar en formato suma
          fFechaFin = aFechaIni;
          fFechaFin = fFechaFin + nume2;
          aFechaFin = fFechaFin;
          alfa1 = aFechaFin % 102;
          alfa2 = aFechaFin % 402;
          alfa3 = aFechaFin % -104;
          #0#196 = alfa1;
          #0#197 = alfa2;
          #0#198 = alfa3;
          |PINTA #0#196;
          |PINTA #0#197;
          |PINTA #0#198;
     |FINSI;
|FPRC;

|PROCESO PintaFin;
     aAlfa = eaUsuario;
     aAlfa1 = eaUsuario % 105;
     |QBF aAlfa;
     |SI aAlfa = "WEB"; |O aAlfa1 = "NUBEA";
          |ACABA;
     |FINSI;

     nNume = #0#199;
     |SI #0#199 ] 100; |Y #0#199 < 399;
||Y #0#196 ! 0;
          |CAMPO_MODIFICA #0#204, 1, "N";
          |CAMPO_MODIFICA #0#203, 1, "N";
          |PINTA 0901, "³                                                   ";

          |PARA nCampo = 196; |SI nCampo [ 198; |HACIENDO nCampo = nCampo + 1;
               |CAMPO_MODIFICA #0nCampo, 1, "N";
               |CAMPO_VISUAL #0nCampo, 1, "N";
          |SIGUE;
          |PINTA 1001, "³                                                   ";
     |SINO;
          |CAMPO_MODIFICA #0#203, 1, "S";
          |CAMPO_MODIFICA #0#204, 1, "S";

          |CAMPO_VISUAL #0#203, 1, "S";
          |CAMPO_VISUAL #0#204, 1, "S";
          |PINTA 0901, "³Duraci¢n .....:     meses,      d¡as.      ";
          |PINTA #0#203;
          |PINTA #0#204;

          nume1 = #0#203 + #0#204;

          |PINTA 1001, "³Fecha fin ....:    /    /      ";
          |PARA nCampo = 196; |SI nCampo [ 198; |HACIENDO nCampo = nCampo + 1;
               |CAMPO_MODIFICA #0nCampo, 1, "S";
               |CAMPO_VISUAL #0nCampo, 1, "S";
          |SIGUE;
          |PINTA #0#196;
          |PINTA #0#197;
          |PINTA #0#198;

          |HAZ BajaSiNo;
     |FINSI;
|FPRC;

|PROCESO pinta_web;
     aAlfa = eaUsuario;
     aAlfa1 = eaUsuario % 105;
     |QBF aAlfa;
     |SI aAlfa ! "WEB"; |O aAlfa1 = "NUBEA";
          |ACABA;
     |FINSI;

     |ABRE #nomconca;
     #nomconca#0 = #0#201;
     |LEE 000#nomconca.=;
     |SI FSalida = 0;
          #0#213 = #nomconca#1;
          |PINTA #0#213;
     |FINSI;
     |CIERRA #nomconca;

     |ABRE #nomcateg;
     #nomcateg#0 = #0#201;
     #nomcateg#1 = #0#202;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          #0#214 = #nomcateg#2;
          |PINTA #0#214;
     |FINSI;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO pinta_cosas; |TIPO 7;
     |HAZ Pinta208;
     |HAZ Pinta229;
     |HAZ CompruebaDias;
     |HAZ Activa234;
     ||HAZ pinta_regimen;
     |HAZ ConsReg;
     |HAZ PintaFin;
     |HAZ pinta_web;
     |HAZ BajaSiNo;
     |HAZ Boton3;
|FPRC;

|PROCESO pinta_regimen;
     |SI #0Campo ! Contenido;
          swCambioManReg = 1;
     |FINSI;

     aAlfa = eaUsuario;
     |QBF aAlfa;
     swSigue = 0;
     |SI aAlfa = "WEB";
          |ABRE #labcentr;
          #labcentr#0 = enEmpresa;
          #labcentr#1 = #0#200;
          |LEE 000#labcentr.=;
          |SI FSalida = 0;
               #0#228 = #labcentr#31;
               |PINTA #0#228;
          |FINSI;
          |CIERRA #labcentr;
     |FINSI;

     |SI #0#199 = 999;
          #0#228 = 0521;
          |PINTA #0#228;
     |FINSI;

     |DDEFECTO #nomregim;
     |ABRE #nomregim;
     #nomregim#0 = #0#228;
     |LEE 000#nomregim.=;
     |SI FSalida = 0;
          alfa1 = #nomregim#1 % 124;
          |ATRI I; |PINTA 1423, alfa1; |ATRI 0;
     |SINO;
          |PINTA 1423, "                          ";
          |MENAV "    ATENCION: El régimen especificado no existe. Pulse F11 para ver los disponibles";
     |FINSI;
     |CIERRA #nomregim;
|FPRC;

|PROCESO FechaFinCero;
     aAlfa = eaUsuario;
     |QBF aAlfa;
     aAlfa1 = eaUsuario % 105;
     |SI aAlfa = "WEB"; |O aAlfa1 = "NUBEA";
          |CAMPO_MODIFICA #0#235, 1, "N";
          |CAMPO_VISUAL #0#235, 1, "N";
          #0#235 = "N";
          |PINTA 1033, "   ";
          |ACABA;
     |FINSI;
     |SI #0#199 ] 100; |Y #0#199 < 399;
          #0#196 = 0;
     |FINSI;
     |SI #0#196 = 0;
          |CAMPO_MODIFICA #0#197, 1, "N";
          |CAMPO_MODIFICA #0#198, 1, "N";

          #0#197 = 0;
          #0#198 = 0;
          |PINTA #0#197;
          |PINTA #0#198;

          #0#235 = "N";
          |PINTA 1033, "   ";
     |SINO;
          |CAMPO_MODIFICA #0#197, 1, "S";
          |CAMPO_MODIFICA #0#198, 1, "S";
     |FINSI;
|FPRC;

|PROCESO diaanter2;                          || RUTINA DEL CALCULO duracion
     |SI xmesnume = 1;
          xtopemes = 31;
     |FINSI;
     |SI xmesnume = 2;
             xmod = xanynume $ 4;
         |SI xmod = 0;
                 xtopemes = 29;
         |SINO;
                 xtopemes = 28;
         |FINSI;
     |FINSI;
     |SI xmesnume = 3;   xtopemes = 31; |FINSI;
     |SI xmesnume = 4;   xtopemes = 30; |FINSI;
     |SI xmesnume = 5;   xtopemes = 31; |FINSI;
     |SI xmesnume = 6;   xtopemes = 30; |FINSI;
     |SI xmesnume = 7;   xtopemes = 31; |FINSI;
     |SI xmesnume = 8;   xtopemes = 31; |FINSI;
     |SI xmesnume = 9;   xtopemes = 30; |FINSI;
     |SI xmesnume = 10;  xtopemes = 31; |FINSI;
     |SI xmesnume = 11;  xtopemes = 30; |FINSI;
     |SI xmesnume = 12;  xtopemes = 31; |FINSI;
|FPRC;

|PROCESO Duracion2; |TIPO 7;
     fech1 = aFecha1;
     fech2 = aFecha2;

     aDuracion = "";

     aDiaAlta = (aFecha1 % 102);
     aMesAlta = (aFecha1 % 402);
     aAnyAlta = (aFecha1 % -104);
     aDiaBaja = (aFecha2 % 102);
     aMesBaja = (aFecha2 % 402);
     aAnyBaja = (aFecha2 % -104);

     nDiaAlta = aDiaAlta;
     nMesAlta = aMesAlta;
     nAnyAlta = aAnyAlta;
     nDiaBaja = aDiaBaja;
     nMesBaja = aMesBaja;
     nAnyBaja = aAnyBaja;

     nAnys = nAnyBaja - nAnyAlta;

     nMeses = nMesBaja - nMesAlta;
     |SI nMeses [ 0;
          |SI nAnys ! 0;
               nAnys = nAnys - 1;
               nMeses = 12 + nMeses;
          |FINSI;
     |FINSI;

     nDias = nDiaBaja - nDiaAlta + 1;
     nume1 = nDiaAlta - 1;
     xmesnume = nMesBaja;
     xanynume = nAnyBaja;
     |HAZ diaanter2;
     |SI nDiaBaja = nume1;
          nDias = 0;
     |SINO;
          |SI nDiaAlta = 1; |Y nDiaBaja = xtopemes;
               nMeses = nMeses + 1;
               nDias = 0;
          |FINSI;
     |FINSI;
     |SI nDias < 0;
          xmesnume = nMesAlta;
          xanynume = nAnyAlta;
          |HAZ diaanter2;
          nDias = xtopemes - nDiaAlta + 1;
          nDias = nDias + nDiaBaja;
          nMeses = nMeses - 1;
     |FINSI;
     |SI nMeses = 12;
          nAnys = nAnys + 1;
          nMeses = 0;
     |FINSI;
|FPRC;

|PROCESO Fechas;
     aFechaNac = "";
     aAlfa = #0#13; aAlfa = ("00" + aAlfa) % -102;
     aFechaNac = aFechaNac + aAlfa;
     aAlfa = #0#14; aAlfa = ("00" + aAlfa) % -102;
     aFechaNac = aFechaNac + "." + aAlfa;
     aAlfa = #0#15;
     aFechaNac = aFechaNac + "." + aAlfa;

     aFechaIni = "";
     aAlfa = #0#193; aAlfa = ("00" + aAlfa) % -102;
     aFechaIni = aFechaIni + aAlfa;
     aAlfa = #0#194; aAlfa = ("00" + aAlfa) % -102;
     aFechaIni = aFechaIni + "." + aAlfa;
     aAlfa = #0#195;
     aFechaIni = aFechaIni + "." + aAlfa;

     aFecha1 = aFechaNac;
     aFecha2 = aFechaIni;

     fech1 = aFecha1;
     fech2 = aFecha2;

     |SI fech2 < fech1; |Y FSalida ! 2; |Y FSalida ! 4;
          aAlfa = "    ATENCION: La fecha de inicio de contrato es anterior ";
          aAlfa = aAlfa + "a la fecha de nacimiento del trabajador.";
          |MENAV aAlfa;
          |ERROR;
     |SINO;
          |HAZ Duracion2;
          |SI nAnys = 16; |Y nMeses = 0; |Y nDias = 0;
               nAnys = 15;
          |FINSI;
          |SI nAnys < 16; |Y FSalida ! 2; |Y FSalida ! 4;
               aAlfa = "    ATENCION: No se permite la contratación de trabajadores ";
               aAlfa = aAlfa + "menores de 16 años.";
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min;
     #nomtrato#0 = 111;
     #nomtrato#1 = 001;
|FPRC;

|PROCESO Max;
     #nomtrato#0 = 111;
     #nomtrato#1 = 999;
|FPRC;

|PROCESO JornadaParcial; |TIPO 0;
     swParcial = 0;
     |SI #0#199 ] 501; |Y #0#199 ! 999;
          swParcial = 1;
     |FINSI;
     |SI #0#199 ] 200; |Y #0#199 [ 299;
          swParcial = 1;
     |FINSI;
     |SI swParcial = 1;
          #0#218 = "P";
          |PINTA #0#218;
          |HAZ ActivaBoton;
     |SINO;
          #0#218 = "C";
          |PINTA #0#218;
          |HAZ ActivaBoton;
     |FINSI;
|FPRC;

|PROCESO ValidaCont; |TIPO 0;
     aAlfa = #0#199;
     |QBF aAlfa;
     aAlfa = ("000" + aAlfa) % -103;
     #0#199 = aAlfa;
     |PINTA #0#199;
     |SI aAlfa = ""; |O aAlfa = "000";
          |CAMPO_MODIFICA #0#211, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#211, 1, "N";
     |FINSI;

     |ABRE #nomtrato;
     nNume = #0#199;
     #nomtrato#0 = 111;
     #nomtrato#1 = nNume;
     |LEE 000#nomtrato.=;
     |SI FSalida ! 0; |Y nNume ! 000; |Y nNume ! 999;
          aAlfa = "    El contrato " + #0#199 + " no es un contrato valido. ";
          aAlfa = aAlfa + "Pulse F11 para ver los disponibles."
          |MENAV aAlfa;
          |ERROR;
     |SINO;
          |SI nNume ! 000; |Y nNume ! 999;
               #0#211 = #nomtrato#2;
               |PINTA #0#211;
               || #0#228 = 0111;
               || PINTA #0#228;
               || alfa1 = "R‚gimen General              ";
               || ATRI I; |PINTA 1423, alfa1; |ATRI 0;
          |FINSI;
          |SI nNume = 999;
               #0#211 = "TRABAJADOR AUTONOMO";
               |PINTA #0#211;
               #0#228 = 0521;
               |PINTA #0#228;
               alfa1 = "Trabajadores Aut¢nomos       ";
               |ATRI I; |PINTA 1423, alfa1; |ATRI 0;
          |FINSI;
     |FINSI;
     |CIERRA #nomtrato;
|FPRC;

|PROCESO ConsultaCont; |TIPO 66;
     |ABRE #nomtrato;
     |CONSULTA_F_CLAVE #1#nomtrato, Min, Max;
     |SI FSalida = 0;
          #0#199 = #nomtrato#1;
          #0#211 = #nomtrato#2;
          |PINTA #0#199;
          |PINTA #0#211;
     |FINSI;
     |CIERRA #nomtrato;
|FPRC;

|PROCESO HorasConvenio;
     aAlfa = eaUsuario;
     |QBF aAlfa;
     aAlfa1 = eaUsuario % 105;
     |SI aAlfa = "WEB"; |O aAlfa1 = "NUBEA";
          |ACABA;
     |FINSI;

     |ABRE #nomconca;
     #nomconca#0 = #0#201;
     |LEE 000#nomconca.=;
     |SI FSalida = 0; |Y #0#201 ! 000;
          |SI Contenido ! #0#201;
               #0#205 = #nomconca#162;
               |PINTA #0#205;
          |FINSI;
     |FINSI;
     |CIERRA #nomconca;
|FPRC;

|PROCESO Activa231; |TIPO 7;
     aAlfa = #0#230;
     |QBF aAlfa;
     |SI aAlfa = "";
          |CAMPO_MODIFICA #0#231, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#231, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Activa233; |TIPO 7;
     aAlfa = #0#232;
     |QBF aAlfa;
     |SI aAlfa = "";
          |CAMPO_MODIFICA #0#233, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#233, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Activa213; |TIPO 7;
     |ABRE #nomconca;
     #nomconca#0 = #0#201;
     |LEE 000#nomconca.=;
     |SI FSalida = 0; |Y #0#201 ! 000;
          |CAMPO_MODIFICA #0#213, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#213, 1, "S";
     |FINSI;
     |CIERRA #nomconca;
|FPRC;

|PROCESO Activa214; |TIPO 7;
     |ABRE #nomcateg;
     #nomcateg#0 = #0#201;
     #nomcateg#1 = #0#202;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0; |Y #0#202 ! 000;
          |CAMPO_MODIFICA #0#214, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#214, 1, "S";
     |FINSI;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO Activa234;
     |SI #0#199 = "401"; |O #0#199 = "501";
          |CAMPO_MODIFICA #0#234, 1, "S";
          |CAMPO_VISUAL #0#234, 1, "S";
          |PINTA 1201, "³Obra .........: ";
          |PINTA #0#234;
     |SINO;
          |CAMPO_MODIFICA #0#234, 1, "N";
          |CAMPO_VISUAL #0#234, 1, "N";
          #0#234 = "";
          |PINTA 1201, "³                                                              ";
     |FINSI;
|FPRC;

|PROCESO MinCen;
     #labcentr#0 = enEmpresa;
     #labcentr#1 = 001;
|FPRC;

|PROCESO MaxCen;
     #labcentr#0 = enEmpresa;
     #labcentr#1 = 999;
|FPRC;

|PROCESO Estudios; |TIPO 66;
     FSalida = 11;
     |HAZ SacaVentana2;
|FPRC;

|PROCESO Profesion; |TIPO 66;
     FSalida = 11;
     |HAZ SacaVentana2;
|FPRC;

|PROCESO Centros; |TIPO 66;
     |ABRE #labcentr;
     |CONSULTA_F_CLAVE #1#labcentr, MinCen, MaxCen;
     |SI FSalida = 0;
          #0#200 = #labcentr#1;
          #0#212 = #labcentr#2;
          |PINTA #0#200;
          |PINTA #0#212;
     |FINSI;
     |CIERRA #labcentr;
|FPRC;

|PROCESO ValidaCentro; |TIPO 0;
     |SI #0Campo ! Contenido;
          swCambioManReg = 0; || para que se vuelva a proponer regimen
     |FINSI;

     |ABRE #labcentr;
     #labcentr#0 = enEmpresa;
     #labcentr#1 = #0#200;
     |LEE 000#labcentr.=;
     |SI FSalida ! 0;
          |CAMPO_MODIFICA #0#212, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#212, 1, "N";
          #0#200 = #labcentr#1;
          #0#212 = #labcentr#2;
          |PINTA #0#200;
          |PINTA #0#212;
     |FINSI;
     |CIERRA #labcentr;
|FPRC;

|PROCESO MinCat;
     #nomcateg#0 = #0#201;
     #nomcateg#1 = 001;
|FPRC;

|PROCESO MaxCat;
     #nomcateg#0 = #0#201;
     #nomcateg#1 = 999;
|FPRC;

|PROCESO ConsultaCat; |TIPO 66;
     |ABRE #nomcateg;
     |CONSULTA_F_CLAVE #1#nomcateg, MinCat, MaxCat;
     |SI FSalida = 0;
          #0#202 = #nomcateg#1;
          #0#214 = #nomcateg#2;
     |FINSI;
     |PINTA #0#202;
     |PINTA #0#214;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO ConsReg;
     swSigue = 1;
     aAlfa = eaUsuario;
     |QBF aAlfa;
     aAlfa1 = eaUsuario % 105;
     |SI aAlfa1 = "NUBEA";     || ya me vendra cargado
          |SI #0#228 = 0000;       || no tengo que cambiarlo
               swSigue = 0;
          |FINSI;
     |FINSI;

     |SI swSigue = 1; |Y swCambioManReg = 0;
          |ABRE #silcon06;
          #silcon06#0 = enEmpresa;
          |LEE 000#silcon06.=;
          |SI FSalida = 0;
               #0#228 = #silcon06#2;
               |PINTA #0#228;
          |FINSI;
          |CIERRA #silcon06;

          |ABRE #silcon15;
          #silcon15#0 = enEmpresa;
          #silcon15#1 = #0#200;
          |LEE 000#silcon15.=;
          |SI FSalida = 0;
               #0#228 = #silcon15#2;
               |PINTA #0#228;
          |FINSI;
          |CIERRA #silcon15;
     |FINSI;

     |HAZ pinta_regimen;
|FPRC;

|PROCESO Convenio;
     |SI aParam = "MODIF";
          |ACABA;
     |FINSI;

     |ABRE #labempre;
     |ABRE #labcentr;
     |ABRE #nomconca;

     #labempre#0 = enEmpresa;
     |LEE 000#labempre.=;
     nConvenio = #labempre#1;

     #labcentr#0 = enEmpresa;
     #labcentr#1 = #0#200;
     |LEE 000#labcentr.=;
     aAlfa = #labcentr#19;
     |QBF aAlfa;
     |SI FSalida = 0; |Y aAlfa ! "";
          nConvenio = #labcentr#16;
     |FINSI;

     #nomconca#0 = nConvenio;
     |LEE 000#nomconca.=;
     |SI FSalida = 0;
          #0#201 = nConvenio;
          #0#213 = #nomconca#1;
          |PINTA #0#201;
          |PINTA #0#213;
     |FINSI;

     |CIERRA #nomconca;
     |CIERRA #labcentr;
     |CIERRA #labempre;

     |HAZ HorasConvenio;
|FPRC;

|PROCESO HorasCero; |TIPO 7;
     |SI #0#218 = "P";
          nNume = #labort03#2 + #labort03#7 + #labort03#12 + #labort03#17;
          nNume = nNume + #labort03#22 + #labort03#27 + #labort03#32;
          |SI #0#205 = 0;
               #0#205 = nNume;
               |PINTA #0#205;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Horario;
     |PUSHV 09012280;
     |PINPA #0#labort03;
     |PINDA #0#labort03;
     enEmpresa = #0#5;
     || enHoras = #0#205;
     |ESTADO_CONTROL enBoton3, "DISABLE";
     |ENDATOS #1#labort03;

     nNume = #labort03#2 + #labort03#7 + #labort03#12 + #labort03#17;
     nNume = nNume + #labort03#22 + #labort03#27 + #labort03#32;
     |SI #0#205 = 0;
          #0#205 = nNume;
     |SINO;
          |SI #0#205 ! nNume;
               aAlfa1 = #0#205; |QBF aAlfa1;
               aAlfa2 = nNume; |QBF aAlfa2;
               aAlfa = "    ATENCION: el número de horas de tiempo parcial (";
               aAlfa = aAlfa + aAlfa1 + ") no coincide con el del horario (" + aAlfa2 + ").";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
     |ESTADO_CONTROL enBoton3, "ENABLE";
     |POPV;
     |PINDA #0#0;
|FPRC;

|PROCESO Boton3;
     |SI swBoton3 = 0;
          |CONTROL_SIMPLE 0, "BOTON,Horario", 2059, 2064, Horario;
          enBoton3 = FSalida;
          |SI #0#218 = "P";
               |ESTADO_CONTROL enBoton3, "ENABLE";
          |SINO;
               |ESTADO_CONTROL enBoton3, "DISABLE";
          |FINSI;
          swBoton3 = 1;
     |FINSI;
|FPRC;

|PROCESO ActivaBoton;
     aAlfa = Contenido;
     |QBF aAlfa;
     |SI aAlfa = "P"; |Y #0#218 = "C";
          || he cambiado de parcial a completo

          #0#205 = #nomconca#162;
          |PINTA #0#205;

          |DDEFECTO #labort03;
     |FINSI;

     |SI #0#218 = "P";
          |ESTADO_CONTROL enBoton3, "ENABLE";
     |SINO;
          |ESTADO_CONTROL enBoton3, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO CompruebaHoras;
     |SI FSalida = 2;    || permite rectifcar
          |ACABA;
     |FINSI;
     |SI #0#205 > #nomconca#162;
          aAlfa = #nomconca#162;
          |QBF aAlfa;

          aAlfa1 = "    ATENCION. Las horas semanales no pueden ser ";
          aAlfa1 = aAlfa1 + "superiores a las horas del convenio (" + aAlfa + ")";
          |MENAV aAlfa1;
          |ERROR;
     |FINSI;
     |SI #0#218 = "P";
          nHoras = 0;
          |PARA nCampo = 2; |SI nCampo [ 32; |HACIENDO nCampo = nCampo + 5;
               nHoras = nHoras + #labort03#nCampo#
          |SIGUE;
          |SI nHoras = 0;
               |HAZ Horario;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CamposBaja; |TIPO 14;
     swSigue = 0;
     aAlfa = eaUsuario;
     |QBF aAlfa;
     aAlfa1 = eaUsuario % 105;
     |SI #0#235 = "S";
          |SI aAlfa ! "WEB"; |Y aAlfa1 ! "NUBEA";
               swSigue = 1;
          |FINSI;
     |FINSI;
     |SI swSigue = 1;
          |CAMPO_MODIFICA #0#236, 1, "S";
          |CAMPO_MODIFICA #0#237, 1, "S";
          |CAMPO_MODIFICA #0#238, 1, "S";
          |CAMPO_VISUAL #0#236, 1, "S";
          |CAMPO_VISUAL #0#237, 1, "S";
          |CAMPO_VISUAL #0#238, 1, "S";
          |ATRI R;
          |PINTA 0841, " Motivo Baja ...:                      ";
          |PINTA 0941, " D¡as vacaciones:                      ";
          |PINTA 1041, " Indemnizaci¢n..:                      ";
          |ATRI 0;
          |ATRI I;
          |PINTA #0#236;
          |PINTA #0#237;
          |PINTA #0#238;
          |ATRI I;
     |SINO;
          |CAMPO_MODIFICA #0#236, 1, "N";
          |CAMPO_MODIFICA #0#237, 1, "N";
          |CAMPO_MODIFICA #0#238, 1, "N";
          |CAMPO_VISUAL #0#236, 1, "N";
          |CAMPO_VISUAL #0#237, 1, "N";
          |CAMPO_VISUAL #0#238, 1, "N";
          |ATRI I;
          |PINTA 0841, "                                       ";
          |PINTA 0941, "                                       ";
          |PINTA 1041, "                                       ";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO BajaSiNo;
     aAlfa = eaUsuario;
     |QBF aAlfa;
     aAlfa1 = eaUsuario % 105;
     |SI aAlfa = "WEB"; |O aAlfa1 = "NUBEA";
          |CAMPO_MODIFICA #0#235, 1, "N";
          |CAMPO_VISUAL #0#235, 1, "N";
          #0#235 = "N";
          |PINTA 1033, "   ";
          |ACABA;
     |FINSI;
     |ATRI I;
     |SI #0#203 = 0; |Y #0#204 = 0;
          |CAMPO_MODIFICA #0#235, 1, "N";
          |CAMPO_VISUAL #0#235, 1, "N";
     |SINO;
          |CAMPO_MODIFICA #0#235, 1, "S";
          |CAMPO_VISUAL #0#235, 1, "S";

          swSigue = 0;
          |SI #0#235 = " ";
               swSigue = 1;
          |FINSI;
          nNume = Contenido;
          |SI nNume = 0; |Y #0#198 ! 0; |Y Campo = 198;
               || ha cambiado el a¤o de cero a otra cosa, solo desde el
               || campo a¤o fin claro
               swSigue = 1;
          |FINSI;
          |SI aParam = "MODIF"; |O aParam = "CONSUL";
               || para que lo pinte siempre que venga del lineal
               |ATRI I;
               |PINTA #0#235;
               |ATRI I;
          |FINSI;
          |SI swSigue = 1;
               |ATRI I;
               #0#235 = "S";
               |PINTA #0#235;
               |ATRI I;
          |FINSI;
     |FINSI;
     |HAZ CamposBaja;
|FPRC;

|PROCESO CompruebaDias;
     |SI #0#196 ! 0;
          alfa1 = #0#193; alfa1 = ("00" + alfa1) % -102;
          alfa2 = #0#194; alfa2 = ("00" + alfa2) % -102;
          alfa3 = #0#195;
          aFechaIni = alfa1 + "." + alfa2 + "." + alfa3;
          fFechaDesde = aFechaIni;
          alfa1 = #0#196; alfa1 = ("00" + alfa1) % -102;
          alfa2 = #0#197; alfa2 = ("00" + alfa2) % -102;
          alfa3 = #0#198;
          aFechaFin = alfa1 + "." + alfa2 + "." + alfa3;
          fFechaHasta = aFechaFin;

          |HAZ Periodo_plb;

          #0#203 = (nAnys * 12) + nMeses;
          #0#204 = nDias;

          |PINTA #0#203;
          |PINTA #0#204;
     |SINO;
          #0#203 = 0;
          #0#204 = 0;

          |PINTA #0#203;
          |PINTA #0#204;
     |FINSI;
|FPRC;


|PROCESO MotivoBaja; |TIPO 66;
     |ABRE #motibaja;
     |CONSULTA_CLAVE #1#motibaja;
     |SI FSalida = 0;
          aAlfa1 = #motibaja#0; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #motibaja#1;
          aAlfa = aAlfa1 + " - " + aAlfa2;
          #0Campo = aAlfa;
          |PINTA #0Campo;
     |FINSI;
     |CIERRA #motibaja;
|FPRC;

|PROCESO Chequea08; |TIPO 0;
     aAlfa = #0Campo;
     aAlfa = aAlfa % 102;
     |SI aAlfa = "08"; |O aAlfa = "09"; |O aAlfa = "10";
     |O aAlfa = "11"; |O aAlfa = "12";
          aAlfa = "    Los códigos 08, 09, 10, 11 y 12 son internos para variaciones. ";
          aAlfa = aAlfa + "No son válidos para bajas de trabajadores";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
|FPRC;
