|FICHEROS;
     hotm0012 #0;
     hotm0013 #1;

     hotm0001 #2;  || trabajadores
|FIN;


|VARIABLES;
     nExiste=0;
     Calc   = 0;
     Flag   = 0;
     UltLinea = 0;
     LineaAct = 0;
     ModoEntrada = 0;
|FIN;

|PROCESO RecalcProrrata;
   UltLinea = #hotm0013#2;
   #hotm0013#9 = #hotm0013#10 / #hotm0012#3;
   #hotm0012#2 = #hotm0012#2 + #hotm0013#9;
   |GRABA 020#hotm0013.a;
|FPRC;

|DEFBUCLE RecalcProrrata;
#hotm0013#1;
;
#hotm0012#0, #hotm0012#1, 001;
#hotm0012#0, #hotm0012#1, 999;
;
NULL,RecalcProrrata;
|FIN;

|PROCESO Acumula; |TIPO 2;
     ModoEntrada = (FEntrada / 100) ! 0;
     Flag = 0+.1;
     #hotm0012#3 = #hotm0012#3 +. #hotm0013#10;
     |SI Flag > 0;
        #hotm0012#2 = 0;
        |SI ModoEntrada = 1;
           |GRABA 020#hotm0013.b;
        |SINO;
           |GRABA 020#hotm0013.a;
        |FINSI;
        LineaAct = #hotm0013#2;
        |BUCLE RecalcProrrata;
        |SI #hotm0012#2 < 1;
           Calc = 1 - #hotm0012#2;
           #hotm0013#0 = #hotm0012#0;
           #hotm0013#1 = #hotm0012#1;
           #hotm0013#2 = UltLinea;
           |LEE 000#hotm0013.=;
           |SI FSalida = 0;
              #hotm0013#9 = #hotm0013#9 + Calc; |GRABA 020#hotm0013.a;
              #hotm0012#2 = 1;
           |FINSI;
        |FINSI;
        #hotm0013#0 = #hotm0012#0;
        #hotm0013#1 = #hotm0012#1;
        #hotm0013#2 = LineaAct;
        |LEE 000#hotm0013.=;
        |PONCONTROL 23, "si"; |PTEC 815;
     |SINO;
        #hotm0012#2 = #hotm0012#2 +. #hotm0013#9;
     |FINSI;
     |PINTA #hotm0012#2;
|FPRC;

|PROCESO Tipo3_hotm0012; |TIPO 3;
     |ABRE #2;
     #2#0=#0#0;
     #2#1=#0#1;
     |LEE 101#2=;
     nExiste=FSalida;

     #2#54=#0#2;

     |SI nExiste=0;
          |GRABA 020#2a;
     |SINO;
          |GRABA 020#2n;
     |FINSI;

     |LIBERA #2;
     |CIERRA #2;
|FPRC;

|PROCESO Calcula;
   Calc = #hotm0012#3 + #hotm0013#10;
   #hotm0013#9 = #hotm0013#10 / Calc;
|FPRC;
