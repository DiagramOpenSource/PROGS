|FICHEROS;
     hotm0041;
     nomvarca;
     nomvarli;
     hotm0038;
     hotm0039;
     hotm0040;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;

     &EURODB = 0;
     nAntes = 0;
     aP_mes = "";
     nImporte = 0;
     nCto = 0;
|FIN;
____________________________________/
|PROCESO Defecto; |TIPO 7;    || calcula el a¤o por defecto segun sistema
     fFech1 = ~;
     aAlfa1 = fFech1;
     aAlfa1 = aAlfa1 % -104;
     #hotm0041#Campo# = aAlfa1;
     |PINTA #hotm0041#Campo#;
|FPRC;

|PROCESO Mirames; |TIPO 7;    || calcula el mes por defecto segun sistema
     fFech1 = ~;
     aAlfa1 = fFech1;
     aAlfa1 = aAlfa1 % 402;
     #hotm0041#Campo# = aAlfa1;
     |PINTA #hotm0041#Campo#;
|FPRC;

|PROCESO Pintames; |TIPO 0;   || pinta el nombre del mes
     |SI #hotm0041#Campo# =  1; aP_mes = "ENERO     ";  |FINSI;
     |SI #hotm0041#Campo# =  2; aP_mes = "FEBRERO   ";  |FINSI;
     |SI #hotm0041#Campo# =  3; aP_mes = "MARZO     ";  |FINSI;
     |SI #hotm0041#Campo# =  4; aP_mes = "ABRIL     ";  |FINSI;
     |SI #hotm0041#Campo# =  5; aP_mes = "MAYO      ";  |FINSI;
     |SI #hotm0041#Campo# =  6; aP_mes = "JUNIO     ";  |FINSI;
     |SI #hotm0041#Campo# =  7; aP_mes = "JULIO     ";  |FINSI;
     |SI #hotm0041#Campo# =  8; aP_mes = "AGOSTO    ";  |FINSI;
     |SI #hotm0041#Campo# =  9; aP_mes = "SEPTIEMBRE";  |FINSI;
     |SI #hotm0041#Campo# = 10; aP_mes = "OCTUBRE   ";  |FINSI;
     |SI #hotm0041#Campo# = 11; aP_mes = "NOVIEMBRE ";  |FINSI;
     |SI #hotm0041#Campo# = 12; aP_mes = "DICIEMBRE ";  |FINSI;
     |PINTA 1535, aP_mes;
|FPRC;
____________________________________/
|PROCESO nomvarli;
     |DDEFECTO #nomvarli;
     #nomvarli#0 = #hotm0040#0;         || empresa
     #nomvarli#1 = #hotm0040#1;         || trabajador
     #nomvarli#2 = #hotm0041#5;         || mes
     #nomvarli#3 = 0;                   || tipo
     #nomvarli#4 = nCto;                || concepto
     |LEE 101#nomvarli.=;
     |SI FSalida ! 0;    |GRABA 020#nomvarli.b;   |FINSI;

     nNume1 = #nomvarli#5;
     nNume2 = #nomvarli#6;
     nAntes = (nNume1 * nNume2) ! EURODB;

     nImporte = nImporte + nAntes;

     nImporte = nImporte / #hotm0040#7;

     aAlfa1 = #hotm0040#7;
     aAlfa1 = ("          " + aAlfa1) % -110;
     #nomvarli#5 = aAlfa1;

     |SI nImporte = 0;
          #nomvarli#6 = "";
     |SINO;
          aAlfa1 = nImporte;
          aAlfa1 = ("            " + aAlfa1) % -112;
          #nomvarli#6 = aAlfa1;
     |FINSI;

     |GRABA 020#nomvarli.a;
     |LIBERA #nomvarli;
|FPRC;

|PROCESO nomvarca;
     |DDEFECTO #nomvarca;
     #nomvarca#0 = #hotm0040#0;         || empresa
     #nomvarca#1 = #hotm0040#1;         || trabajador
     #nomvarca#2 = #hotm0041#5;         || mes
     #nomvarca#3 = 0;                   || tipo
     |LEE 000#nomvarca.=;
     |SI FSalida ! 0;
          |GRABA 020#nomvarca.n;
     |FINSI;
|FPRC;

|PROCESO hotm0040;
     #hotm0039#0 = #hotm0040#0;
     #hotm0039#1 = #hotm0040#1;
     #hotm0039#2 = #hotm0040#2;
     #hotm0039#3 = #hotm0040#3;
     |LEE 000#hotm0039.=;
     |SI FSalida = 0;              || si existe la cabecera
          #hotm0038#0 = #hotm0040#4;
          |LEE 000#hotm0038.=;
          |SI FSalida = 0;
               |HAZ nomvarca;
               nCto = #hotm0038#2; nImporte = #hotm0040#8;  |HAZ nomvarli;
               nCto = #hotm0038#3; nImporte = #hotm0040#9;  |HAZ nomvarli;
               nSeleccio = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE hotm0040;
     #hotm0040#1;
     ;
     #hotm0041#0, #hotm0041#2, #hotm0041#4, #hotm0041#5, #hotm0041#6;
     #hotm0041#1, #hotm0041#3, #hotm0041#4, #hotm0041#5, #hotm0041#7;
     ;
     NULL, hotm0040;
|FIN;

|PROCESO nomvarli_1;
     |BORRA 020#nomvarli.a;
     |LIBERA #nomvarli;
|FPRC;

|DEFBUCLE nomvarli;
     #nomvarli#1;
     ;
     #hotm0041#0, #hotm0041#2, #hotm0041#5, 0, nCto;
     #hotm0041#1, #hotm0041#3, #hotm0041#5, 0, nCto;
     be;
     NULL, nomvarli_1;
|FIN;

|PROCESO hotm0038;
     nCto = #hotm0038#2; |BUCLE nomvarli;
     nCto = #hotm0038#3; |BUCLE nomvarli;
|FPRC;

|DEFBUCLE hotm0038;
     #hotm0038#1;
     ;
     #hotm0041#6;
     #hotm0041#7;
     ;
     NULL, hotm0038;
|FIN;

|PROCESO Tipo3; |TIPO 3;

     |BUCLE hotm0038;         || borra

     |ABRE #nomvarca;
     |ABRE #nomvarli;
     |ABRE #hotm0038;
     |ABRE #hotm0039;
     |BUCLE hotm0040;
     |CIERRA #nomvarca;
     |CIERRA #nomvarli;
     |CIERRA #hotm0038;
     |CIERRA #hotm0039;

     |SI nSeleccio = 0;
          |MENAV "0000Seleccion vacia.";
     |FINSI;
|FPRC;
