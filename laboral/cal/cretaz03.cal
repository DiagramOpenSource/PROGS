|FICHEROS;
     labempre;
     labcentr;
     silcon06;
     labclean;

     labtraba;
     nomhicca;
|FIN;

|VARIABLES;
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";

     nRegimenDef = 0;
     nRegimenProv = 0;

     nTrabCen = 0;
     nTrab521 = 0;
     swAdeudo = 0;
     swRegimen = 0;
|FIN;

|PROCESO nomhicca;
     nRegimenDef = #labtraba#247;
     |ERROR10;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #labtraba#0, #labtraba#1, 16, 01, 0;
     #labtraba#0, #labtraba#1, 20, 12, 0;
     ;
     NULL, nomhicca;
|FIN;

|PROCESO labtraba;
     nRegimenProv = #labtraba#247;
     |BUCLE nomhicca;
     |SI nRegimenDef ! 0000;
          nTrabCen = nTrabCen + 1;
          |SI #labtraba#247 = 0521;
               || si es autonomo sigo comprobando, por ver si hay alguno
               || mas en este regimen que no lo sea, en ese caso le pondre
               || el Regimen del no-autonomo
               nTrab521 = nTrab521 + 1;
          |SINO;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#1;
     77;
     #labcentr#0, 00001, #labcentr#1;
     #labcentr#0, 99999, #labcentr#1;
     ;
     NULL, labtraba;
|FIN;

|PROCESO labcentr;
     aAlfa1 = #labcentr#0;
     |QBF aAlfa1;
     aAlfa1 = ("00000" + aAlfa1) % -105;

     aAlfa2 = #labcentr#1;
     |QBF aAlfa2;
     aAlfa2 = ("000" + aAlfa2) % -103;

     aAlfa = "Emp: " + aAlfa1 + " - Cen: " + aAlfa2;
     |PINTA 1634, aAlfa;

     || lo del adeudo en cuenta

     |SI swAdeudo = 1;
          #labempre#0 = #labcentr#0;
          |LEE 000#labempre.=;
          |SI FSalida = 0;
               #silcon06#0 = #labempre#0;
               |LEE 000#silcon06.=;
               |SI FSalida = 0;
                    |SI #silcon06#7 = "C";
                         #labcentr#30 = "S";
                    |SINO;
                         #labcentr#30 = "N";
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     || lo del regimen

     |SI swRegimen = 1;
          nRegimenProv = 0000;
          nRegimenDef = 0000;
          nTrabCen = 0;
          nTrab521 = 0;
          |BUCLE labtraba;

          |SI nRegimenDef ! 0000;
                #labcentr#31 = nRegimenDef;
          |SINO;
                #labcentr#31 = nRegimenProv;
          |FINSI;

          |SI nRegimenDef = 0521;
               |SI nTrabCen = nTrab521;
                     #labcentr#31 = nRegimenDef;
               |FINSI;
          |FINSI;
     |FINSI;

     |GRABA 020#labcentr.a;
     |LIBERA #labcentr;
|FPRC;

|DEFBUCLE labcentr;
     #labcentr#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, labcentr;
|FIN;

|PROGRAMA;
     swAdeudo = 0;
     swRegimen = 0;

     |ABRE #labclean;

     #labclean#0 = "labcentr";
     #labclean#1 = 30;
     |LEE 101#labclean.=;
     |SI FSalida = 0; |Y #labclean#2 = "S";
          || ya esta hecho
     |SINO;
          swAdeudo = 1;
     |FINSI;

     #labclean#0 = "labcentr";
     #labclean#1 = 31;
     |LEE 101#labclean.=;
     |SI FSalida = 0; |Y #labclean#2 = "S";
          || ya esta hecho
     |SINO;
          swRegimen = 1;
     |FINSI;
     swRegimen = 0; || de moemento esto no

     |SI swRegimen = 1; |O swAdeudo = 1;
          |CLS;
          |PINTA 1327, "旼컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커"
          |PINTA 1427, "   Inicializando nuevos campos.   ";
          |PINTA 1527, " Por favor, espere unos segundos. ";
          |PINTA 1627, "                                  "
          |PINTA 1727, "                                  "
          |PINTA 1827, "읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸"


          |ABRE #labempre;
          |ABRE #labcentr;
          |ABRE #silcon06;

          |BUCLE labcentr;

          |SI swAdeudo = 1;
               #labclean#0 = "labcentr";
               #labclean#1 = 30;
               #labclean#2 = "S";
               |GRABA 020#labclean.n;
               |LIBERA #labclean;
          |FINSI;

          |SI swRegimen = 1;
               #labclean#0 = "labcentr";
               #labclean#1 = 31;
               #labclean#2 = "S";
               |GRABA 020#labclean.n;
               |LIBERA #labclean;
          |FINSI;

          |CIERRA #silcon06;
          |CIERRA #labcentr;
          |CIERRA #labempre;
     |FINSI;

     |CIERRA #labclean;
|FPRO;
