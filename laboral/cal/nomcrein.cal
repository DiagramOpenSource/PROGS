|FICHEROS;
     nomcrein #0;

     tsilco14,MANTE;      || tmp. parrilla empresas
     tsilco15,MANTE;      || tmp. parrilla trabajadores

     labempre #10;        || empresas
     labtraba #12;        || trabajadores
     labcentr #16;        || centros de trabajo
     nomcenes #17;        || centros de trabajo especiales

     nomcalca;            || calculos cabs. (proceso mensual)
     nomhicca #19;        || calculos cabs. (proceso historico)

     silcon06;            || empresas Sistema RED
     nomcontr #36;        || control aplicacion

     nomconca;
     silcon13;

     nomcal03;
     nomcal04;

     nomtrcal;
     gomdetjr;
     nomvarca;
|FIN;

|VARIABLES;
     fech1 = @;
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     nume1 = 0;
     nume2 = 0;
     enAny = 0;
     p_mes = 0;
     traba = 0;
     nMarcarT = 0;
     nMarcarE = 0;
     sw_parrilla = 0;
     aAviso = "";
     FEstado = 0;
     clave = "";
     sw_auxil = 0;
     linea = 0;
     aRegimen = "";
     aAlfa = "";
     aAlfa0 = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     aLibre = "";
     aReser = "";
     for_fecha = "";
     for_hora = "";
     fichero = "";
     extension = "";
     indica = "";
     swStop = 0;
     nEmp = 0;
     nTra = 0;
     any_hist = 0;
     tipo_bot = 0;
     tipo_top = 0;
     enDesCen = 0;
     enHasCen = 0;
     eaFuente = "";

     ajuste1 = "";
     ajuste2 = "";
     ajuste3 = "";
     alfa = "";
     error = 0;
     ind = 0;
     long = 0;
     posi = 0;
     digito = "";
     texto = "";
     mascara = "";
     i = 0;
     j = 0;
     nCampo = 0;
     nTipo = 0;
     nTipoNominas = 0;
     descom = "";
     entero = "";
     decima = "";
     elsw1 = 0;
     para1 = 0;
     nNume = 0;
     cadena = "";
     swRepite = 0;
     aCCC = "";
     nConcepto = 0;
     nConceptoRED = 0;
     nImporte = 0;
     nConvenio = 0;
     aIndicativo = "";
     aDescripcion = "";
     aTipoPaga = "";
     nUnidades = 0;
     nUnidadesCal = 0;
     nPrecio = 0;
     nBrutoMenosPrest = 0;
     nMesAtrasos = 0;
     nDesdeMes = 0;
     nHastaMes = 0;
     nMesHist = 0;
     swSigue = 0;
     aAntNroAfil = "";
     aAntCCC ="";
     aAntCen ="";
     nNroEmpresas = 0;
     nNroTrabaj = 0;
     nAntEmp = 0;
     nBrutoTrab = 0;
     nPagasProrr = 0;

     &s_ori = "";
     &s_tat = 0;
     &s_ele = "";
     &s_any = 0;
     &s_mes = 0;
     &s_has = 0;
     &s_anyl = 0;
     &s_sel = "";
     &s_lotecra = 0;
     &s_fichcra = "";

     nNroTras = 0;
     nAntEmpCon = 0;
     nTotEmp = 0;
     nImporteFin = 0;

     aCadena = "";
     aCadenaSal = "";
     nEspacio = 0;
     aLon = "";
     nLon = 0;
     nBlancos = 0;
     nBlancosIzd = 0;
     nBlancosDer = 0;
     aBlancosIzd = "";
     aBlancosDer = "";

     &s_num = 0;
     &s_fich = "";
     topemes = 0;
     aMes = "";
     aAny = "";
     aFecha = "";
     fIniMes = @;
     fFinMes = @;
     fFechaIniMes = @;
     fFechaFinMes = @;
     nFechaIniMes = 0;
     nFechaFinMes = 0;
     aFechaIniMes = "";
     aFechaFinMes = "";
     fFechaAlta = @;
     fFechaBaja = @;
     nFechaAlta = 0;
     nFechaBaja = 0;
     nNume1 = 0;
     nNume2 = 0;
     nDias = 0;
     nDiasAlta = 0;
     &enLote = 0;
     &eaFich = "";
     &eaExt = "";
     swPosibleError = 0;
     nDesdeTra = 0;
     nHastaTra = 0;
     swHayAlguno = 0;
     nAny = 0;
     nAnyXX = 0;
     aCentroNom = "":
     fFechaIniPer = @;
     fFechaFinPer = @;
     aFechaIniPer = "";
     aFechaFinPer = "";

     fFechaIniTramo = @;
     nFechaIniTramo = 0;
     aFechaIniTramo = "";
     fFechaFinTramo = @;
     nFechaFinTramo = 0;
     aFechaFinTramo = "";

     nBase = 0;
     nLinea = 0;
     aLinea = "";
     nCampo1 = 0;
     nCampo2 = 0;
     nCampo3 = 0;
     aTipo = "";
     nDesde = 0;
     nHasta = 0;
     nCodTipo = 0;
     aDesTipo = "";
     swDesde = 0;
     swHasta = 0;
     aFechaBusca = "";
     fFechaBusca = @;
     aContrato = "";
     nGrupoCot = 0;
     nCategoria = 0;
     aOcupacion = "";
     nHoras = 0;
     aNif = "";
     nVez = 0;
     nFechaIniPer = 0;
     nFechaFinPer = 0;
     nBonifMan = 0;
     nBonifFom = 0;
     aFechaIniBon = "";
     fFechaIniBon = @;
     aFechaFinBon = "";
     fFechaFinBon = @;
     swGraba = 0;
     swGrabado = 0;
     swPrest = 0;
     fFecha = @;
     nFecha = 0;
     nUltima = 0;
     aNAFSS = "";
     nLineaAjuste = 0;
     nUltimoTramoAlta = 0;
     nUltimoTramoIT = 0;
     nCodTipoAnt = 0;
     nLineaAnt = 0;
     nDiasCot = 0;
     aFechaAlta = "";
     aFechaBaja = "";
     swMarca52 = 0;
     swRegrabado = 0;
     swHay = 0;

     nBaseComunes_Alta = 0;
     nBaseATEP_Alta = 0;
     nBaseEnfAcc = 0;
     nBaseMat = 0;
     nBasePat = 0;
     nBaseRie = 0;
     nBaseCon = 0;
     nBaseERE = 0;
     nBaseHorasFM = 0;
     nBaseHorasOtras = 0;
     nNumHorasComp = 0;
     aSituacion = "";
     nCodigo = 0;
     nUltimoCodigo = 0;

     nDiasEnf = 0;
     nDiasAcc = 0;
     nDiasMat = 0;
     nDiasPat = 0;
     nDiasRie = 0;
     nDiasCon = 0;
     nDiasERE = 0;
     nPropERE = 0;
     aUltimaIT = "";
     nAjuste = 0;
     nDiasCotAlta = 0;
     nDiasCotIT = 0;
     nPrestEnf = 0;
     nPrestAcc = 0;
     nBases = 0;
     nDiasTramo = 0;
     nDiasNatTramo = 0;
     nPropTramo = 0;
     swPrest52 = 0;
     swPrest53 = 0;
     nPromedioCC = 0;
     nPromedioATEP = 0;
     nBaseDiariaERE = 0;
     nDiasMesTrab = 0;
     nDiaIT = 0;
     nDiasAcumIT = 0;
     nDiasAcumEnf = 0;
     nDias60 = 0;
     nDias75 = 0;
     nHastaReal = 0;
     nIndicador = 0;
     nCodigoHoras = 0;
     swTopeMin = 0;
     nNumHorasFor = 0;
     aTipoHorasFor = "";
     nAcumHorasFor = 0;
     nAcumHorasComp = 0;

     swCuenta = 0;
     nTrabEmp = 0;
     nTotalTra = 0;
     aTotalTra = "";
     nNroTra = 0;
     nTotalEmp = 0;
     aTotalEmp = "";
     nNroEmp = 0;
     swFinPeriodo = 0;
     swUltimoDiaIT = 0;

     nDiasAltaNIF = 0;
     fFecha1 = @;
     fFecha2 = @;
     nFecha1 = 0;
     nFecha2 = 0;
     nNroCCCs = 0;
     nCodigoIniIT = 0;
     nCodigoFinIT = 0;

     nJornadasIT = 0;
     nPrestManEnf = 0;
     nPrestManAcc = 0;

     swDiferente = 0;
     nMesAnt = 0;
     swIniPeriodo = 0;
     swTramoUnSoloDia = 0;
     nDiasRecaida = 0;
     swCentroFormacion = 0;

     nDesdeTipo = 0;
     nHastaTipo = 0;
     nDiasVac1 = 0;
     nDiasVac2 = 0;

     nDias99 = 0;  || para las L13
     nMes99 = 0;
     nAny99 = 0;

     nBonifFormCont = 0;
     swAsignada = 0;

     nDiaDesde = 0;
     nDiaHasta = 0;
     fFechaHastaTra = @;
     fFechaHastaPer = @;
     nDiaHastaMasUno = 0;

     nEmpAnt = 0;
     nTraAnt = 0;
     red_ultimo = 0;
     &aParam = "";

     numer = 0;
     anynum = 0;
     mesnum = 0;
     bisiesto = 0;
     aAnyo = "";
     aCalendario = "";
     nDia = 0;
     nCampoDia = 0;

          alfa1 = "";
          fecalf = "";
          dia = 0;
          mes = 0;
          any = 0;
          swfuera = 0;
     nMes = 0;
|FIN;

/****************************************************************************/
/****************      PROCESOS DESDE LA PANTALLA   *************************/
/****************************************************************************/

|PROCESO Mensa_21_2; |TIPO 7;
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          |MENSA "    Opciones: (N) todas las nominas calculadas en el periodo; (S) Seleccionar";
     |FINSI;
     |SI aParam = "CONVENIO";
          |MENSA "    Opciones: (N) todos los trabajadores cuyo estado sea 'A' (Alta); (S) Seleccionar";
     |FINSI;
|FPRC;

|PROCESO topemes;     || halla el ultimo dia del mes
     nume2 = 0;
     nume1 = nAny $ 4;    || a¤o historico
     |SI nume1 = 0;
          nume2 = 1;
     |FINSI;
     topemes = 31;
     |SI nMes = 2;
          topemes = 28 + nume2;
     |FINSI;
     |SI nMes = 4; |O nMes = 6; |O nMes = 9; |O nMes = 11;
          topemes = 30;
     |FINSI;
|FPRC;

|PROCESO AyudaTipos; |TIPO 7;
     |PUSHV 08552380;
     |ATRI R;
     ||            5    6         7         8
     ||            56789012345678901234567890
     |PINTA 0855, "       - Opciones -       ";
     |PINTA 0955, " 00 :Normal               ";
     |PINTA 1055, " 02 :Finiquitos           ";
     |PINTA 1155, "5-20:Atrasos              ";
     |PINTA 1255, " 98 :Salarios de tramita- ";
     |PINTA 1355, "     ci¢n                 ";
     |PINTA 1455, "                          ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura; |TIPO 0;
     |POPV;
|FPRC;

|PROCESO defectoMesAny;
     fech1 = ~;
     alfa1 = fech1;
     alfa1 = alfa1 % 402;          || MES
     nume1 = alfa1;

     alfa2 = fech1;
     alfa2 = alfa2 % -104;
     nume2 = alfa2;                || A¥O

     |SI nume1 = 1;
         #0#0 = nume2 - 1;
         #0#1 = 12;
     |SINO;
         #0#0 = nume2;
         #0#1 = nume1 - 1;
     |FINSI;
     ||#0#6 = #0#0;
     ||#0#4 = #0#1;

     |PINTA #0#0;
     |PINTA #0#1;
     ||PINTA #0#6;
     ||PINTA #0#4;

     ||HAZ mirames;
|FPRC;

|PROCESO elAnyo; |TIPO 0;
     enAny = #0#0;
|FPRC;

/****************************************************************************/
/*********** PROCESOS PARA LA SELECCION DE EMPRESAS Y TRABAJADORES **********/
/****************************************************************************/

/*
|PROCESO reenvio1;
     nDesdeMes = #0#1;
     |SI eaFuente = "M"; |O eaFuente = "H";
          nHastaMes = #0#1;
     |SINO;
          nHastaMes = #0#4;
     |FINSI;
     nAny = #0#0;
     nAnyXX = #0#0 - 2000;
     nTipo = #0#5;
     nDesdeTra = 00001;
     nHastaTra = 99999;

     swHayAlguno = 0;
     nEmp = #labempre#0;
     #silcon06#0 = nEmp;
     |LEE 000#silcon06.=;
     |SI FSalida = 0;
          |HAZ CargaEmp;
          |SI swHayAlguno = 1;
               |DDEFECTO #tsilco14;
               #tsilco14#0 = #labempre#0;
               #tsilco14#1 = #labempre#2;
               #tsilco14#2 = " ";
               |GRABA 020#tsilco14.n;
               |LIBERA #tsilco14;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE reenvio;
     #labempre#1;
     ;
         1;
     99999;
     ;
     NULL, reenvio1;
|FIN;

|PROCESO parrilla; |TIPO 0;
     |SI FSalida = 2;    || no si pulso la flecha arriba
          |ACABA;
     |FINSI;

     |SI #0#2 = "S";
          |ATRI P;   |MENSA "    Cargando seleccion ...";    |ATRI 0;
          alfa1 = Usuario; |QBT alfa1;    alfa1 = ("t" + alfa1) % 108;
          alfa2 = Usuario; |QBT alfa2;    alfa2 = ("u" + alfa2) % 108;
          alfa3 = Usuario; |QBT alfa3;    alfa3 = ("v" + alfa2) % 108;
          |NOME_DAT #tsilco14#alfa1#;
          |NOME_DAT #tsilco15#alfa2#;
          |DELINDEX #tsilco14;
          |DELINDEX #tsilco15;

          |ABRE #labempre;
          |ABRE #labtraba;
          |ABRE #tsilco14;
          |ABRE #silcon06;

          eaFuente = #0#3;
          |BUCLE reenvio;

          |CIERRA #silcon06;
          |CIERRA #labtraba;
          |CIERRA #labempre;
          |CIERRA #tsilco14;
          |ATRI R;
          |BLIN 4;
          |ATRI 0;
          sw_parrilla = 1;

          |PUSHV 0501 2380;
          |ENTLINEAL #1#tsilco14, 1, 4, 22, 1, min14, max14;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO cta_cotizacion;
     swCentroFormacion = 0;
     aCCC = #labempre#13;          || cta.cot. de la empresa
     |SI #labtraba#45 = "085"; |O #labtraba#45 = "087"; |O #labtraba#45 = "097";
     |O #labtraba#45 = "421"; |O #labtraba#45 = "422";
          |DDEFECTO #nomcenes;
          |ABRE #nomcenes;
          #nomcenes#0 = #labtraba#0;
          #nomcenes#13 = #labtraba#77;
          #nomcenes#1 = 87;
          |LEE 000#nomcenes.=;
          |SI FSalida = 0;
               aAlfa = #nomcenes#10;      || cta.cto. del centro de trabajo especial
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aCCC = aAlfa;         || cta.cto. del centro de trabajo especial
               |FINSI;
               aCentroNom = #nomcenes#2;
               swCentroFormacion = 1;
          |FINSI;
          |CIERRA #nomcenes;
     |SINO;
          |DDEFECTO #labcentr;
          |ABRE #labcentr;
          #labcentr#0 = #labtraba#0;
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;
          |SI FSalida = 0;
               aAlfa = #labcentr#10;      || cta.cot. centro de trabajo
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aCCC = aAlfa;
               |FINSI;
               aCentroNom = #labcentr#2;
          |FINSI;
          |CIERRA #labcentr;
     |FINSI;
     |QBF aCCC;
     |SI aCCC ! "";
          aCCC = ("00000000000" + aCCC) % -111;
     |FINSI;
     aAlfa = #labtraba#247;
     |QBF aAlfa;
     aAlfa = ("0000" + aAlfa) % -104;
     |SI aCCC ! "";
          aCCC = aAlfa + aCCC;
     |FINSI;
|FPRC;
*/

|PROCESO CreaMovAFI;
     |LEE 000#silcon13.u;
     |SI FSalida ! 0;
          red_ultimo = 1;
     |SINO;
          red_ultimo = #silcon13#0 + 1;
     |FINSI;

     |DDEFECTO #silcon13;
     #silcon13#0 = red_ultimo;
     |GRABA 020#silcon13.b;

     #silcon13#1 = nEmp;         || empresa
     #silcon13#2 = nTra;         || trabajador
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          #silcon13#3 = "ADT";        || accion/situac.

          #silcon13#61 = aFechaIniPer;
          #silcon13#62 = aFechaFinPer;
          #silcon13#63 = nDiasMesTrab;
     |FINSI;
     |SI aParam = "CONVENIO";
          #silcon13#3 = "ACT";        || accion/situac.
     |FINSI;

     |GRABA 020#silcon13.a;
     |LIBERA #silcon13;

     |SI nEmp ! nAntEmp;
          nNroEmpresas = nNroEmpresas + 1;
     |FINSI;
     nNroTrabaj = nNroTrabaj + 1;

     nAntEmp = nEmp;
|FPRC;
/*
|PROCESO VarConvenio;
     |HAZ CreaMovAFI;
|FPRC;

|PROCESO VarCitricos;
     |SI #gomdetjr#35 ! 0;
          nDiasMesTrab = #gomdetjr#35;
     |SINO;
          |HAZ DiasActividad;
          nDiasMesTrab = nDias;
     |FINSI;

     aFechaAlta = #labtraba#36;
     aFechaBaja = #labtraba#37;
     |QBF aFechaAlta;
     |QBF aFechaBaja;
     nMes = #0#1;

     #nomvarca#0 = #labtraba#0;
     #nomvarca#1 = #labtraba#1;
     #nomvarca#2 = #0#1;
     #nomvarca#3 = 0;
     |LEE 000#nomvarca.=;
     |SI FSalida = 0;
          aAlfa = #nomvarca#16;
          |QBF aAlfa;
          |SI aAlfa ! ""; |Y aAlfa ! "..........";
               aFechaBaja = aAlfa;
          |FINSI;
     |FINSI;

     |HAZ CreaMovAFI;
|FPRC;
*/
|DEFBUCLE tsilco15;
     #tsilco15#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CreaMovAFI;
|FIN;

|PROCESO desglosa_fec;
     alfa1 = fecalf %  102;   dia = alfa1;
     alfa1 = fecalf %  402;   mes = alfa1;
     alfa1 = fecalf % -104;   any = alfa1;
     |SI alfa1 = "....";
          dia = 0;
          mes = 0;
          any = 0;
     |FINSI;
|FPRC;

|PROCESO grabatmp;
     |SI #labtraba#42 = "H";
          |ACABA;
     |FINSI;

     swfuera = 0;

     fecalf = #labtraba#36;                           || fecha de alta
     |HAZ desglosa_fec;
     |SI any > nAny;|O any = 0;
          swfuera = 1;
     |SINO;
          |SI mes > nMes; |Y any = nAny;
               swfuera = 1;
          |SINO;
               |SI dia > nDia; |Y mes = nMes; |Y any = nAny;
                    swfuera = 1;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI swfuera = 0;
          fecalf = #labtraba#37;                       || fecha de baja
          |HAZ desglosa_fec;
          |SI any < nAny; |Y any ! 0;
               swfuera = 1;
          |SINO;
               |SI mes < nMes; |Y any = nAny; |Y mes ! 0;
                    swfuera = 1;
               |SINO;
                    |SI dia < nDia; |Y mes = nMes; |Y any = nAny; |Y dia ! 0;
                         swfuera = 1;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI swfuera = 0;
          #tsilco15#0 = #labtraba#0;
          #tsilco15#1 = #labtraba#1;
          #tsilco15#2 = #labempre#2;
          #tsilco15#3 = #labtraba#3;
          #tsilco15#4 = #labtraba#7;
          #tsilco15#5 = #labtraba#75;
          #tsilco15#6 = #labtraba#77;
          #tsilco15#7 = " ";
          #tsilco15#8 = " ";
          |GRABA 020#tsilco15.n;
          |LIBERA #tsilco15;
     |FINSI;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#1;
     ;
     #labempre#0, 00001;
     #labempre#0, 99999;
     ;
     NULL, grabatmp;
|FIN;

|PROCESO min15_nomcrein;
    #tsilco15#0 = 00001;
    #tsilco15#1 = 00001;
|FPRC;

|PROCESO max15_nomcrein;
    #tsilco15#0 = 99999;
    #tsilco15#1 = 99999;
|FPRC;

|PROCESO carga_temporal;
     |BUCLE labtraba;

     |ENTLINEAL #1#tsilco15, 1, 4, 22, 1, min15_nomcrein, max15_nomcrein;

     |HAZ CreaMovAFI;
|FPRC;

|PROCESO empresas1;
     #silcon06#0 = #labempre#0;
     |LEE 000#silcon06.=;
     |SI FSalida = 0;
/*
          |DDEFECTO #tsilco14;
          #tsilco14#0 = #labempre#0;
          |LEE 000#tsilco14.=;
          |SI #0#2 = "S";
               |SI FSalida ! 0; |O #tsilco14#2 ! "*";
                    |ACABA;
               |FINSI;
          |FINSI;
*/
          nNroEmp = nNroEmp + 1;
          nTrabEmp = 0;
          |HAZ carga_temporal;

          |SI nTrabEmp = 0;
               nNroEmp = nNroEmp - 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE empresas;
     #labempre#1;
     ;
     #0#0;
     #0#0;
     ;
     NULL, empresas1;
|FIN;

|PROCESO CargaTramos;
     swCuenta = 0;
     |BUCLE empresas;
|FPRC;

|PROCESO Centra;
     aLon = aCadena % 0;
     nLon = aLon;
     nBlancos = nEspacio - nLon;
     nNume = nBlancos / 2;
     nBlancosIzd = nNume ! 0;
     nBlancosDer = nBlancos - nBlancosIzd;
     aBlancosIzd = " " * nBlancosIzd;
     aBlancosDer = nBlancosDer * " ";
     aCadenaSal = aBlancosIzd + aCadena + aBlancosDer;
|FPRC;

|PROCESO Mensaje;
     |ATRI R;
     |BLANCO 16142265;
     ||CUADRO 16142265;
               ||  1       2         3         4         5         6
               ||  234567890123456789012345678901234567890123456789012345678

     aLinea = "Se han generado los movimientos AFI ";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 1715, aCadenaSal;
     |SI aParam = "DIASALTA"; |O aParam = "CITRICOS";
          aLinea = "del periodo solicitado. Se incluyen:"
     |FINSI;
     |SI aParam = "CONVENIO";
          aLinea = "de comun. de convenio. Se incluyen:"
     |FINSI;
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 1815, aCadenaSal;
     aAlfa = nNroEmpresas; |QBF aAlfa;
     aLinea = aAlfa + " empresas";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 2015, aCadenaSal;
     aAlfa = nNroTrabaj; |QBF aAlfa;
     aLinea = aAlfa + " trabajadores";
     aCadena = aLinea; nEspacio = 49; |HAZ Centra;
     |PINTA 2115, aCadenaSal;
     |PINTA 2215, "                                                  ";

     |ATRI 0;
     |PAUSA;
|FPRC;

|PROCESO Creacion;
     |ABRE #silcon06;
     |ABRE #silcon13;
     |ABRE #labempre;
     |ABRE #labtraba;
     aAlfa = Usuario; |QBT aAlfa; aAlfa = "tm_tsilco15_" + aAlfa;
     |NOME_DAT #tsilco15#aAlfa2#;
     |DELINDEX #tsilco15;
     |ABRE #tsilco15;
     |ABRE #labcentr;
     |ABRE #nomcenes;

     |ABRE #nomcalca;
     |ABRE #nomhicca;
     |ABRE #nomcal03;
     |ABRE #nomcal04;
     |ABRE #nomvarca;

     |HAZ CargaTramos;

     |CIERRA #nomvarca;
     |CIERRA #nomcal04;
     |CIERRA #nomcal03;
     |CIERRA #nomhicca;
     |CIERRA #nomcalca;
     |CIERRA #nomcenes;

     |CIERRA #labcentr;
     |CIERRA #labempre;
     |CIERRA #labtraba;
     |CIERRA #tsilco14;
     |CIERRA #tsilco15;
     |CIERRA #silcon13;
     |CIERRA #silcon06;

     |DELINDEX #tsilco15;      || parrilla trabajadores
|FPRC;

|PROCESO ElProceso;
     aAlfa = #0#2 % 102;
     nNume = aAlfa;
     nDia = nNume;

     aAlfa = #0#2 % 402;
     nNume = aAlfa;
     nMes = nNume;

     aAlfa = #0#2 % -104;
     nNume = aAlfa;
     nAny = aAlfa;

     |HAZ Creacion;
|FPRC;

|PROGRAMA;
     |CLS;

     |ABRE #0;
     |LEE 000#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;

     |PINPA #0#0;
     |PINDA #0#0;

     |ENDATOS #1#0;

     |SI FSalida = 0;
          |HAZ ElProceso;
          |SI nNroEmpresas > 0; |Y nNroTrabaj > 0;
               |HAZ Mensaje;
          |SINO;
               |SI aParam = "DIASALTA";
                    aAlfa = "    No se han encontrado trabajadores con días de ";
                    aAlfa = aAlfa + "alta en el periodo solicitado";
               |FINSI;
               |SI aParam = "CONVENIO";
                    aAlfa = "    No se han encontrado trabajadores de alta con ";
                    aAlfa = aAlfa + "la selección realizada";
               |FINSI;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |GRABA 020#0a;
     |LIBERA #0;
     |CIERRA #0;
|FPRO;
