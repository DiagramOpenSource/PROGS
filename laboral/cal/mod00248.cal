|FICHEROS;
    mod00248 #0;
    labempre #1;         || empresas
    labtraba #2;         || trabajadores
    mod00246 #3;         || recibos quincenales!!!
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    el_mes = 0;
    el_any = 0;
    swbaja = 0;
    esta = 0;
    fecalf = "";
    dia = 0;
    mes = 0;
    nMes = 0;
    aMes = "";
    any = 0;
    &diav = "";
    &mesv = "";
    &anyv = "";
    confi = "";
    linea = 0;
    la_linea = 0;

    Tipo = "";
    &recibi = "";
|FIN;
____________________________________/
|PROCESO mayus; |TIPO 0;
    #0Campo = #0Campo > #0Campo;
|PINTA #0Campo;
|FPRC;

|PROCESO defecto; |TIPO 7; ||calcula el a¤o por defecto segun fecha sistema
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mirames; |TIPO 7;
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mesaletra;
     |SI nMes = 1;  aMes = "Enero";          |FINSI;
     |SI nMes = 2;  aMes = "Febrero";        |FINSI;
     |SI nMes = 3;  aMes = "Marzo";          |FINSI;
     |SI nMes = 4;  aMes = "Abril";          |FINSI;
     |SI nMes = 5;  aMes = "Mayo";           |FINSI;
     |SI nMes = 6;  aMes = "Junio";          |FINSI;
     |SI nMes = 7;  aMes = "Julio";          |FINSI;
     |SI nMes = 8;  aMes = "Agosto";         |FINSI;
     |SI nMes = 9;  aMes = "Septiembre";     |FINSI;
     |SI nMes = 10; aMes = "Octubre";        |FINSI;
     |SI nMes = 11; aMes = "Noviembre";      |FINSI;
     |SI nMes = 12; aMes = "Diciembre";      |FINSI;
|FPRC;

|PROCESO Fecha;
     alfa1 = #0#16;
     alfa2 = alfa1 % 102;
     alfa3 = alfa1 % 402;
     alfa4 = alfa1 % 704;
     diav = alfa2;
     nMes = alfa3;
     |HAZ mesaletra;
     mesv = aMes;
     anyv = alfa4;
|FPRC;
____________________________________/ CALCULO LIQUIDOS
|PROCESO proceso;
    el_mes = #3#3;
|HAZ ordena;
|SI #2#70 = "L";
     #0#14 = #2#0;  |PINTA #0#14;
     #0#15 = #2#1;  |PINTA #0#15;
     |SI #3#12 ! 0;
          seleccio = 1;
          |SI #0#13 = "R";
               |INFOR "mod00248";
          |FINSI;
          |SI #0#13 = "B";
               |HAZ Fecha;
               |INFOR "mod0024a";
          |FINSI;
          |PRINT;
          |PIEINF;
          |FININF;
     |FINSI;
|FINSI;
|FPRC;

|PROCESO ordena;   || LEE EL TRABAJADOR
|DDEFECTO #2;
    #2#0 = #3#0;
    #2#1 = #3#1;
|LEE 000#2=;
|FPRC;

|DEFBUCLE recibos;
 #3#1;
 ;
 #0#0, #0#2, #0#5, #0#6, #0#1, Tipo;
 #0#0, #0#3, #0#5, #0#6, #0#1, Tipo;
 ;
 NULL, proceso;
|FIN;

|PROCESO tipo3; |TIPO 3;
    Tipo = PARAMETRO;    |QBT Tipo;

|IMPRE 0;
|SI FSalida = 0;
    |PINTA 2203, "En proceso ...";
    |CAMPO_VISUAL #0#14, 1, "S";
    |CAMPO_VISUAL #0#15, 1, "S";
        alfa1 = #0#5;   alfa1 = alfa1 % -102;
        el_any = alfa1;

        recibi = #0#16;

    |ABRE #1;
    |ABRE #2;
        #1#0 = #0#0;
    |LEE 020#1=;
    |BUCLE recibos;
    |SI seleccio = 0;
        |MENAV "    Seleccion vacia ...";
    |FINSI;
    |CIERRA #1;
    |CIERRA #2;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FPRC;

|PROCESO PintaMes;
     |ATRI S;
     |SI #0#3 = 1;
          |PINTA 1347, "ENERO     ";
     |FINSI;
     |SI #0#3 = 2;
          |PINTA 1347, "FEBRERO   ";
     |FINSI;
     |SI #0#6 = 3;
          |PINTA 1347, "MARZO     ";
     |FINSI;
     |SI #0#6 = 4;
          |PINTA 1347, "ABRIL     ";
     |FINSI;
     |SI #0#6 = 5;
          |PINTA 1347, "MAYO      ";
     |FINSI;
     |SI #0#6 = 6;
          |PINTA 1347, "JUNIO     ";
     |FINSI;
     |SI #0#6 = 7;
          |PINTA 1347, "JULIO     ";
     |FINSI;
     |SI #0#6 = 8;
          |PINTA 1347, "AGOSTO    ";
     |FINSI;
     |SI #0#6 = 9;
          |PINTA 1347, "SEPTIEMBRE";
     |FINSI;
     |SI #0#6 = 10;
          |PINTA 1347, "OCTUBRE   ";
     |FINSI;
     |SI #0#6 = 11;
          |PINTA 1347, "NOVIEMBRE ";
     |FINSI;
     |SI #0#6 = 12;
          |PINTA 1347, "DICIEMBRE ";
     |FINSI;
     |ATRI I;
|FPRC;

|PROCESO PintaTipo;
     |ATRI S;
     |SI #0#1 = 0;
          |PINTA 1447, "MENSUAL      ";
     |FINSI;
     |SI #0#1 = 1;
          |PINTA 1447, "1ra. QUINCENA";
     |FINSI;
     |SI #0#1 = 2;
          |PINTA 1447, "2da. QUINCENA";
     |FINSI;
     |ATRI I;
|FPRC;
