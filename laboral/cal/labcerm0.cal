|FICHEROS;
     labcerm0 #0;

     labcerm1,MANTE;
     labcerm2,MANTE;
     labcerm3,MANTE;
     labcerm4,MANTE;
     labcerm5,MANTE;
     labcerm6,MANTE;
     labcerm7,MANTE;

     labempre;
     labtraba;
     labcermt;

     pdfimtmp #100;
|FIN;

|VARIABLES;
 {-1}menu = "Apartados del certificado";
     menu1 = "1300";
     menu2 = "1";
     menu3 = "8";
     menu4 = "Datos personales de los progenitores";
     menu5 = "Motivo de la solicitud";
     menu6 = "Datos comunes";
     menu7 = "Otros datos de los progenitores";
     menu8 = "Alegaciones";
     menu9 = "Modalidad de cobro y firma";
     menu10 = "Descanso a favor del otro progenitor";
     menu11 = "Emisi¢n del certificado";
     nOpcion = 0;
     nCampo = 0;
     nCampo1 = 0;
     &nModo = 0;
     FEstado = 0;
     aAlfa = "";
     &enEmp = 0;
     &enTra = 0;
     &efFec = @;
     nPan = 0;
     &nCuantos = 0;
     &aArchivo = "";
     nAscii = 0;
     aCaracter = "";
     aCaracterSal = "";
     aCadenaSal = "";
     aCadena = "";
     aLongitud = "";
     nLongitud = 0;
     nPos = 0;
     nBusca = 0;
     aValor = "";
     aValorC = "";
     aCampo = "";
     nTipo = 0;
     swlabcerm1 = 0;
     swlabcerm2 = 0;
     swlabcerm3 = 0;
     swlabcerm4 = 0;
     swlabcerm6 = 0;
     swlabcerm7 = 0;
     aTipoCampo = "";
     aAlfa1 = "";
     &aListaFich = "";
     nLinea = 0;
     aLinea = "";
     &nTotalLineas = 0;
     aTexto = "";
     aLon = "";
     nLon = 0;
     nPos2 = 0;
     aValorAnt = "";
|FIN;

|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;             || el caracter  
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;             || el caracter ‚
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;             || el caracter ¡
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162; |O nAscii = 243;            || el caracter ¢
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;             || el caracter £
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;             || el caracter ¤
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 241;             || el caracter ¤ (otro codigo ¨?)
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 165;             || el caracter ¥
          aCaracterSal = "\321";
     |FINSI;
     |SI nAscii = 129;
          aCaracterSal = "\374";   || el caracter u con dieresis
     |FINSI;
     |SI nAscii = 154;
          aCaracterSal = "\334";   || el caracter U (mayuscula) con dieresis
     |FINSI;
     |SI nAscii = 167;
          aCaracterSal = "\272";   || el caracter §
     |FINSI;
     |SI nAscii = 166;
          aCaracterSal = "\252";   || el caracter ¦
     |FINSI;
     |SI aCaracter = "(";
          aCaracterSal = "\(";
     |FINSI;
     |SI aCaracter = ")";
          aCaracterSal = "\)";
     |FINSI;
|FPRC;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO GrabaTemporal;
     |SI nTipo ! 30
          |QBF aValor;
     |FINSI;
     aCadena = aValor;
     |HAZ sustituye;
     aValor = aCadenaSal;
     #pdfimtmp#0 = aCampo;
     |LEE 000#pdfimtmp.=;
     |SI FSalida ! 0;
          #pdfimtmp#1 = aValor;
          #pdfimtmp#2 = nTipo;
          |GRABA 020#pdfimtmp.n;
     |FINSI;
|FPRC;

|PROCESO GrabaAlegacion;
     nLinea = nLinea + 1
     aLinea = nLinea;
     |QBF aLinea;
     aLinea = ("00" + aLinea) % -102;
     aCampo = "LET_4.1_Alegaciones" + aLinea;
     nTipo = 30;
     |HAZ GrabaTemporal;
|FPRC;

|PROCESO PuntoyAparte;
          |QBF aTexto;
          aCaracter = aTexto % -101;
          |SI aCaracter = ".";
               aLon = aTexto % 0;
               nLon = aLon;
               |SI nLon < 100;
                    aValor = aTexto;
                    |HAZ GrabaAlegacion;
                    aValor = "";
                    aTexto = "";
               |FINSI;
          |SINO;
               aTexto = aTexto + " ";
          |FINSI;
|FPRC;

|PROCESO CargaAlegaciones;
     aCadena = #labcerm5#4;
     |QBF aCadena;

     aCadena = aCadena + " ";
     aTexto = aTexto + aCadena;
     |QBF aTexto;
     aCaracter = aTexto % 101;
     |SI aCaracter = " ";
          aTexto = aTexto - " ";
     |FINSI;

     |HAZ PuntoyAparte;

     aTexto = aTexto + " ";

     aLon = aTexto % 0;
     nLon = aLon;

     |SI nLon ] 100;
          aValor = aTexto % 199;
          |PARA nPos = 1; |SI nPos [ 99; |HACIENDO nPos = nPos + 1;
               nPos2 = (nPos * 100) + 1;
               nPos2 = (-1) * nPos2;
               aCaracter = aValor % -101;
               |SI aCaracter = " "; |O aCaracter = "."; |O aCaracter = ",";
               |O aCaracter = ";";
                    aValorAnt = aValor;
                    |HAZ GrabaAlegacion;
                    |SAL;
               |SINO;
                    nPos2 = (99 - nPos) + 100;
                    aValor = aValor % nPos2;
               |FINSI;
          |SIGUE;
          aTexto = aTexto - aValorAnt;
          |HAZ PuntoyAparte;
     |FINSI;
|FPRC;
/*
|PROCESO CargaAlegaciones;
     nLinea = nLinea + 1
     aLinea = nLinea;
     |QBF aLinea;
     aLinea = ("00" + aLinea) % -102;
     aCampo = "LET_4.1_Alegaciones" + aLinea;
     aValor = #labcerm5#4;
     nTipo = 30;
     |HAZ GrabaTemporal;
|FPRC;
*/

|DEFBUCLE CargaAlegaciones;
     #labcerm5#1;
     ;
     #0#0, #0#1, #0#2, 001;
     #0#0, #0#1, #0#2, 999;
     ;
     NULL, CargaAlegaciones;
|FIN;

|PROCESO Excepciones;
     |SI aCampo = "Apellidos1Progenitor";
          aValor = #labcerm1#3; |QBF aValor;
          aValor = aValor + " " + #labcerm1#4; |QBF aValor;
          aValor = aValor + ", " + #labcerm1#5; |QBF aValor;
     |FINSI;
     |SI aCampo = "Apellidos1Progenitor2";
          aValor = #labcerm1#23; |QBF aValor;
          aValor = aValor + " " + #labcerm1#24; |QBF aValor;
          aValor = aValor + ", " + #labcerm1#25; |QBF aValor;
     |FINSI;

     aAlfa = aCampo % -109;
     |SI aAlfa = "CodPostal";
          |QBF aValor;
          aValor = ("00000" + aValor) % -105;
     |FINSI;

     |SI #labcermt#2 = "labcerm6";
          |SI nCampo = 5; |O nCampo = 6; |O nCampo = 7;
          |O nCampo = 12; |O nCampo = 13; |O nCampo = 14;
               aValor = ("0000" + aValor) % -104;
          |FINSI;
          |SI nCampo = 8; |O nCampo = 15;
               aValor = ("00" + aValor) % -102;
          |FINSI;
          |SI nCampo = 9; |O nCampo = 16;
               aValor = ("0000000000" + aValor) % -110;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO labcermt;
     nTipo = 00;
     aValor = "";
     nCampo = #labcermt#3;
     aCampo = #labcermt#1;
     |QBF aCampo;

     |SI #labcermt#2 = "labcerm1";
          |SI swlabcerm1 = 1;
               aValor = #labcerm1#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #labcermt#2 = "labcerm2";
          |SI swlabcerm2 = 1;
               aValor = #labcerm2#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #labcermt#2 = "labcerm3";
          |SI swlabcerm3 = 1;
               aValor = #labcerm3#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #labcermt#2 = "labcerm4";
          |SI swlabcerm4 = 1;
               aValor = #labcerm4#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #labcermt#2 = "labcerm6";
          |SI swlabcerm6 = 1;
               aValor = #labcerm6#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI #labcermt#2 = "labcerm7";
          |SI swlabcerm7 = 1;
               aValor = #labcerm7#nCampo#;
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;

     |QBF aValor;

     |HAZ Excepciones;

     |SI aValor ! "";
          aTipoCampo = #labcermt#4;
          |QBF aTipoCampo;
          |SI aTipoCampo = "F";
               aValor = (aValor % 102) + "/" + (aValor % 402) + "/" + (aValor % 704);
          |FINSI;
          |SI aTipoCampo = "C";
               aValorC = #labcermt#5;
               |QBF aValorC;
               |SI aValorC ! "";
                    |SI aValor = aValorC;
                         aValor = #labcermt#6;
                    |SINO;
                         aValor = "";
                    |FINSI;
               |SINO;
                    aValor = "";
               |FINSI;
          |FINSI;
          |SI aTipoCampo = "P";
               aCampo = #labcermt#1;
               |QBF aCampo;
               nPos = #labcermt#5;
               nPos = (nPos * 100) + 1
               aValor = aValor % nPos;
          |FINSI;
          |SI aValor ! "";
               aCampo = #labcermt#1;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE labcermt;
     #labcermt#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, labcermt;
|FIN;

|PROCESO LeeFicheros;
     swlabcerm1 = 0;
     swlabcerm2 = 0;
     swlabcerm3 = 0;
     swlabcerm4 = 0;
     swlabcerm6 = 0;
     swlabcerm7 = 0;

     |ABRE #labcerm1;
     #labcerm1#0 = #0#0;
     #labcerm1#1 = #0#1;
     #labcerm1#2 = #0#2;
     |LEE 101#labcerm1.=;
     |SI FSalida = 0;
          swlabcerm1 = 1;
     |FINSI;
     |CIERRA #labcerm1;

     |ABRE #labcerm2;
     #labcerm2#0 = #0#0;
     #labcerm2#1 = #0#1;
     #labcerm2#2 = #0#2;
     |LEE 101#labcerm2.=;
     |SI FSalida = 0;
          swlabcerm2 = 1;
     |FINSI;
     |CIERRA #labcerm2;

     |ABRE #labcerm3;
     #labcerm3#0 = #0#0;
     #labcerm3#1 = #0#1;
     #labcerm3#2 = #0#2;
     |LEE 101#labcerm3.=;
     |SI FSalida = 0;
          swlabcerm3 = 1;
     |FINSI;
     |CIERRA #labcerm3;

     |ABRE #labcerm4;
     #labcerm4#0 = #0#0;
     #labcerm4#1 = #0#1;
     #labcerm4#2 = #0#2;
     |LEE 101#labcerm4.=;
     |SI FSalida = 0;
          swlabcerm4 = 1;
     |FINSI;
     |CIERRA #labcerm4;

     |ABRE #labcerm6;
     #labcerm6#0 = #0#0;
     #labcerm6#1 = #0#1;
     #labcerm6#2 = #0#2;
     |LEE 101#labcerm6.=;
     |SI FSalida = 0;
          swlabcerm6 = 1;
     |FINSI;
     |CIERRA #labcerm6;

     |ABRE #labcerm7;
     #labcerm7#0 = #0#0;
     #labcerm7#1 = #0#1;
     #labcerm7#2 = #0#2;
     |LEE 101#labcerm7.=;
     |SI FSalida = 0;
          swlabcerm7 = 1;
     |FINSI;
     |CIERRA #labcerm7;
|FPRC;

|PROCESO CargaCampos;
     |HAZ LeeFicheros;

     |BUCLE labcermt;

     nLinea = 0;
     nTotalLineas = 0;

     aCadena = "";
     aTexto = "";
     aValorAnt = "";

     |BUCLE CargaAlegaciones;
     || la ultima
     |QBF aTexto
     |SI aTexto ! "";
          aValor = aTexto;
          |HAZ GrabaAlegacion;
     |FINSI;
     nTotalLineas = nLinea;
|FPRC;

|PROCESO ImprePDF;
     aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
     |NOME_DAT #100 aAlfa1;

     |DELINDEX #pdfimtmp;
     |ABRE #pdfimtmp;         || Contrato Puesta a Disposicion

     |HAZ CargaCampos;

     nCuantos = 1;
     |CIERRA #pdfimtmp;

     aArchivo = "sol_mat_pat.pdf";

     |SUB_EJECUTA "pdfgraba";

     |SUB_EJECUTA "pdfimpre";
|FPRC;

|PROCESO Emision;
     |HAZ ImprePDF;
|FPRC;

|PROCESO borra_labcerm5;
     |BORRA 020#labcerm5.a;
|FPRC;

|DEFBUCLE borra_labcerm5;
     #labcerm5#1;
     ;
     #0#0, #0#1, #0#2, 001;
     #0#0, #0#1, #0#2, 999;
     ;
     NULL, borra_labcerm5;
|FIN;

|PROCESO Baja; |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ABRE #labcerm1;
          #labcerm1#0 = #0#0;
          #labcerm1#1 = #0#1;
          #labcerm1#2 = #0#2;
          |LEE 101#labcerm1.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm1.a;
          |FINSI;
          |CIERRA #labcerm1;

          |ABRE #labcerm2;
          #labcerm2#0 = #0#0;
          #labcerm2#1 = #0#1;
          #labcerm2#2 = #0#2;
          |LEE 101#labcerm2.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm2.a;
          |FINSI;
          |CIERRA #labcerm2;

          |ABRE #labcerm3;
          #labcerm3#0 = #0#0;
          #labcerm3#1 = #0#1;
          #labcerm3#2 = #0#2;
          |LEE 101#labcerm3.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm3.a;
          |FINSI;
          |CIERRA #labcerm3;

          |ABRE #labcerm4;
          #labcerm4#0 = #0#0;
          #labcerm4#1 = #0#1;
          #labcerm4#2 = #0#2;
          |LEE 101#labcerm4.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm4.a;
          |FINSI;
          |CIERRA #labcerm4;

          |BUCLE borra_labcerm5;

          |ABRE #labcerm6;
          #labcerm6#0 = #0#0;
          #labcerm6#1 = #0#1;
          #labcerm6#2 = #0#2;
          |LEE 101#labcerm6.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm6.a;
          |FINSI;
          |CIERRA #labcerm6;

          |ABRE #labcerm7;
          #labcerm7#0 = #0#0;
          #labcerm7#1 = #0#1;
          #labcerm7#2 = #0#2;
          |LEE 101#labcerm7.=;
          |SI FSalida = 0;
               |BORRA 020#labcerm7.a;
          |FINSI;
          |CIERRA #labcerm7;
     |FINSI;
|FPRC;


|PROCESO DescansoOtro;
     |ABRE #labcerm7;
     #labcerm7#0 = #0#0;
     #labcerm7#1 = #0#1;
     #labcerm7#2 = #0#2;
     |LEE 101#labcerm7.=;
     FEstado = FSalida;

     |PINPA #0#labcerm7;
     |PINDA #0#labcerm7;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm7;
               |PINDA #0#labcerm7;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    |BLANCO 10012373;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan [ 1;
                         |PINPA #0#labcerm7; |PINDA #0#labcerm7;
                         nPan = 1;
                    |FINSI;
                    |SI nPan ] 2;
                         |PINPA #1#labcerm7; |PINDA #1#labcerm7;
                         nPan = 2;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Las opciones de descanso a favor del otro progenitor aún no han sido creadas";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm7;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm7.a;
               |SINO;
                    |GRABA 020#labcerm7.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm7;
|FPRC;

|PROCESO ModalidadCobro;
     |ABRE #labcerm6;
     #labcerm6#0 = #0#0;
     #labcerm6#1 = #0#1;
     #labcerm6#2 = #0#2;
     |LEE 101#labcerm6.=;
     FEstado = FSalida;

     |PINPA #0#labcerm6;
     |PINDA #0#labcerm6;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm6;
               |PINDA #0#labcerm6;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    ||BLANCO 10012380;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan = 1;
                         |PINPA #0#labcerm6; |PINDA #0#labcerm6;
                         nPan = 1;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Los datos personales de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm6;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm6.a;
               |SINO;
                    |GRABA 020#labcerm6.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm6;
|FPRC;

|PROCESO Alegaciones;
     |PINPA #0#labcerm5;
     |PINDA #0#labcerm5;
/*
     |SI nModo = 4;
          |SI FEstado = 0;
          |SINO;
               |MENAV "    Los datos personales de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
*/
          enEmp = #0#0;
          enTra = #0#1;
          efFec = #0#2;
          |SUB_EJECUTA "labcermc";
     ||FINSI;
     |CIERRA #labcerm5;
|FPRC;

|PROCESO OtrosDatos;
     |ABRE #labcerm4;
     #labcerm4#0 = #0#0;
     #labcerm4#1 = #0#1;
     #labcerm4#2 = #0#2;
     |LEE 101#labcerm4.=;
     FEstado = FSalida;

     |PINPA #0#labcerm4;
     |PINDA #0#labcerm4;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm4;
               |PINDA #0#labcerm4;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    |BLANCO 10012373;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan [ 1;
                         |PINPA #0#labcerm4; |PINDA #0#labcerm4;
                         nPan = 1;
                    |FINSI;
                    |SI nPan ] 2;
                         |PINPA #1#labcerm4; |PINDA #1#labcerm4;
                         nPan = 2;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Otros datos de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm4;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm4.a;
               |SINO;
                    |GRABA 020#labcerm4.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm4;
|FPRC;

|PROCESO DatosComunes;
     |ABRE #labcerm3;
     #labcerm3#0 = #0#0;
     #labcerm3#1 = #0#1;
     #labcerm3#2 = #0#2;
     |LEE 101#labcerm3.=;
     FEstado = FSalida;

     |PINPA #0#labcerm3;
     |PINDA #0#labcerm3;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm3;
               |PINDA #0#labcerm3;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    |BLANCO 10012373;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan [ 1;
                         |PINPA #0#labcerm3; |PINDA #0#labcerm3;
                         nPan = 1;
                    |FINSI;
                    |SI nPan ] 2;
                         |PINPA #1#labcerm3; |PINDA #1#labcerm3;
                         nPan = 2;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Los datos comunes de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm3;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm3.a;
               |SINO;
                    |GRABA 020#labcerm3.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm3;
|FPRC;

|PROCESO Motivos;
     |ABRE #labcerm2;
     #labcerm2#0 = #0#0;
     #labcerm2#1 = #0#1;
     #labcerm2#2 = #0#2;
     |LEE 101#labcerm2.=;
     FEstado = FSalida;

     |PINPA #0#labcerm2;
     |PINDA #0#labcerm2;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm2;
               |PINDA #0#labcerm2;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    |BLANCO 10012373;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan [ 1;
                         |PINPA #0#labcerm2; |PINDA #0#labcerm2;
                         nPan = 1;
                    |FINSI;
                    |SI nPan ] 2;
                         |PINPA #1#labcerm2; |PINDA #1#labcerm2;
                         nPan = 2;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Los motivos de la solicitud de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm2;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm2.a;
               |SINO;
                    |GRABA 020#labcerm2.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm2;
|FPRC;

|PROCESO DatosPersonales;
     |ABRE #labcerm1;
     #labcerm1#0 = #0#0;
     #labcerm1#1 = #0#1;
     #labcerm1#2 = #0#2;
     |LEE 101#labcerm1.=;
     FEstado = FSalida;

     |PINPA #0#labcerm1;
     |PINDA #0#labcerm1;

     |SI nModo = 4;
          |SI FEstado = 0;
               |PINPA #0#labcerm1;
               |PINDA #0#labcerm1;
               nPan = 1;
               |PARA; |SI; |HACIENDO;
                    |PAUSA;
                    ||BLANCO 10012380;
                    |SI FSalida = 1;
                         |SAL;
                    |FINSI;
                    |SI FSalida = 4;
                         nPan = nPan - 1;
                    |FINSI;
                    |SI FSalida = 5;
                         nPan = nPan + 1;
                    |FINSI;
                    |SI nPan = 1;
                         |PINPA #0#labcerm1; |PINDA #0#labcerm1;
                         nPan = 1;
                    |FINSI;
               |SIGUE;
          |SINO;
               |MENAV "    Los datos personales de los progenitores aún no han sido creados";
          |FINSI;
     |SINO;
          |ENDATOS #1#labcerm1;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#labcerm1.a;
               |SINO;
                    |GRABA 020#labcerm1.n;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labcerm1;
|FPRC;

|PROCESO Defectos_m0;
     |DDEFECTO #labcerm1;
     |DDEFECTO #labcerm2;
     |DDEFECTO #labcerm3;
     |DDEFECTO #labcerm4;
     |DDEFECTO #labcerm5;
     |DDEFECTO #labcerm6;
     |DDEFECTO #labcerm7;
|FPRC;

|PROCESO Consulta_labcerm0; |TIPO 13;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 4;
          |ABRE #0;
          |LEE 000#0=;
          |SI FSalida = 0;
               |CIERRA #0;
               |HAZ Defectos_m0;
               |HAZ ElMenu;
          |SINO;
               |MENAV "    ATENCION: No se ha encontrado el certificado";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo3_labcerm0; |TIPO 3;
     |HAZ Defectos_m0;
     |HAZ ElMenu;
|FPRC;

|PROCESO PintaDes;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 4;
          |ABRE #labempre;
          #labempre#0 = #0#0;
          |LEE 000#labempre.=;
          |CIERRA #labempre;

          |ABRE #labtraba;
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;

          |ATRI I;
          |PINTA 0730, #labempre#2;
          |PINTA 0830, #labtraba#2;
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO ElMenu;
     nModo = (FEntrada / 100) ! 0;
     ||PINDA #0#0;
     ||HAZ Aviso;
     |PARA; |SI; |HACIENDO;
          |HAZ PintaDes;
          menu2 = nOpcion;
          |MENUG menu;
          nOpcion = FSalida;
          |SI nOpcion = 1;         || datos personales de los progenitores
               |PUSHV 05012380;
               |HAZ DatosPersonales;
               |POPV;
          |FINSI;
          |SI nOpcion = 2;         || motivo de la solicitud
               |PUSHV 05012380;
               |HAZ Motivos;
               |POPV;
          |FINSI;
          |SI nOpcion = 3;         || Datos comunes
               |PUSHV 05012380;
               |HAZ DatosComunes;
               |POPV;
          |FINSI;
          |SI nOpcion = 4;         || Otros datos de los progenitores
               |PUSHV 05012380;
               |HAZ OtrosDatos;
               |POPV;
          |FINSI;
          |SI nOpcion = 5;         || Alegaciones
               |PUSHV 05012380;
               |HAZ Alegaciones;
               |POPV;
          |FINSI;
          |SI nOpcion = 6;         || Modalidad de cobro y firma
               |PUSHV 05012380;
               |HAZ ModalidadCobro;
               |POPV;
          |FINSI;
          |SI nOpcion = 7;         || Descanso a favor del otro progenitor
               |PUSHV 05012380;
               |HAZ DescansoOtro
               |POPV;
          |FINSI;
          |SI nOpcion = 8;         || Emision
               |PUSHV 05012380;
               |HAZ Emision;
               |POPV;
          |FINSI;
          |SI nOpcion [ 0;
          /*
               nModo = 1;     || para que borre el aviso si es Consulta
               |HAZ Aviso;
          */
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;
