|FICHEROS;
     nomw0002 #0;
     labempre #1;
     nomconca #2;
     nomconst #3;
     silcon06 #30;
     nomcnaec;
     nomcnahi;
     nomcontr;
     labclean;
     labtraba;

     &regisnif@ #712;

     cretam00;
|FIN;

|VARIABLES;
     aFech           = "";
     aDia1           = "";
     aMes1           = "";
     aAny1           = "";
     aAlfa1          = "";
     aAlfa2          = "";
     aAlfa3          = "";
     aAlfa4          = "";
     aTecla          = "";

     nSw             = 0;
     nDia            = 0;
     nMes            = 0;
     nAny            = 0;
     nTope           = 0;
     nMod            = 0;
     nCorta          = 0;
     nNume1          = 0;
     nNume2          = 0;
     nNume3          = 0;
     nSitio          = 0;
     nJg             = 0;
     nCampoD         = 0;
     nCampoH         = 0;

     &orden          = "";
     &pasa           = "";

     &enEmpresa      = 0;
     &enModo         = 0;
     &eaCodNif       = "";
     nCampo = 0;
     nModo = 0;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     fFecha = @;
     &nElAny = 0;
     &nElMes = 0;
     aAlfa = "";
     &nOpcionPLB = 0;
     aCodPos = "";
     FEstado = 0;
     aCNAE = "";
     aDesCNAE = "";
     nOpcion = 0;
     enBoton = 0;
     &eaVengoDe = "";
     swBotonSiNo = 0;
     &eaEmail = "";
     &nArchi = 0;
     aBase = "";
     aFabre = "";
     swSigue = 0;
     aValor = "";
|FIN;

|PROCESO grabared;
     |DDEFECTO #30;
     |ABRE #30;
     #30#0 = enEmpresa;
     |LEE 000#30=;
     |SI FSalida ! 0;
          |CONFI "    NDesea dar alta de la empresa en el Sistema RED (S/N): ";
          |SI FSalida = 0;
               |PUSHV 05012380;
               |CLS;
               |PINPA #0#30;
               |PINDA #0#30;
               |ENDATOS #1#30;
               |SI FSalida = 0;
                    |GRABA 020#30n;
               |FINSI;
               |POPV;
          |FINSI;
     |FINSI;
     |CIERRA #30;
|FPRC;

|PROCESO EnBlanco; |TIPO 7;
     |SI #0Campo ! "S";|Y #0Campo ! "N";
          #0Campo = "N";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO FechaAlfa; |TIPO 0;
     aFech = #0Campo;
     nSw   = 0;
     |SI aFech ! "          "; |Y aFech ! "..........";
         aDia1 = aFech % 102;
         aMes1 = aFech % 402;
         aAny1 = aFech % 704;
         nDia  = aDia1;
         nMes  = aMes1;
         nAny  = aAny1;

         |SI nDia ! 0; |Y nMes ! 0; |Y nAny ! 0;
             |SI nMes [ 12; |Y nMes ] 1;
                 |SI nMes = 1; |O nMes = 3;  |O nMes = 5; |O nMes = 7;
                  |O nMes = 8; |O nMes = 10; |O nMes = 12;
                     nTope = 31;
                 |SINO ;
                     |SI nMes = 2;
                         nTope = 28;

                         nMod = nAny $ 4;
                         |SI nMod = 0;  nTope = 29;  |FINSI;
                      |SINO;
                         nTope = 30;
                      |FINSI;
                 |FINSI;
             |FINSI;

             |SI nDia [ nTope;   nSw = 1;   |FINSI;
         |FINSI;
     |SINO;
         nSw= 1;
     |FINSI;

     |SI nSw = 0;
         |MENAV "       ATENCION Fecha erronea";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Trunca;
    nCorta = 0;
    aAlfa1 = nNume2;
    aAlfa2 = aAlfa1 % 0;
    nNume3 = aAlfa2;
    |PARA nJg = nNume3; |SI nJg ] 1; |Y nCorta = 0; |HACIENDO nJg = nJg - 1;
          nSitio = (nJg * 100) + 1;
          aAlfa2 = aAlfa1 % nSitio;
          |SI aAlfa2 = ".";  nCorta = nJg;  |FINSI;
    |SIGUE;

    |SI nCorta ! 0;
        nSitio = 100 + nCorta - 1;
        aAlfa1 = aAlfa1 % nSitio;
    |FINSI;

    nNume3 = aAlfa1;
    nNume1 = nNume1 - (nNume3 * 97);
|FPRC;

|PROCESO Control1; |TIPO 0;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     aAlfa1 = #0Campo;
     |QBF aAlfa1;

     aAlfa2 = aAlfa1 % 102;
     aAlfa3 = aAlfa1 % -107;
     aAlfa4 = aAlfa3 % 101;

     |SI aAlfa4 = "0";
         aAlfa3 = aAlfa3 % 206;
         aAlfa1 = aAlfa2 + aAlfa3;
     |FINSI;

     nNume1 = aAlfa1;
     nNume2 = nNume1 / 97;
     |HAZ Trunca;

     |SI nNume1 ] 0; |Y nNume1 [ 99;
         aAlfa1    = #0Campo;      |QBF aAlfa1;
         aAlfa2    = nNume1;
         aAlfa2    = "00" + aAlfa2;
         aAlfa2    = aAlfa2 % -102;
         aAlfa1    = aAlfa1 + aAlfa2;
         #0Campo = aAlfa1;
         |PINTA #0Campo;
    |FINSI;
|FPRC;

|PROCESO Abreviado; |TIPO 0;
     aAlfa1 = Contenido;
     |SI #0#22 = "S";  |Y aAlfa1 ! #0Campo;
         |MENAV "    Revise las cuentas de cotizacion de los centros. Deberan ser unicas.";
     |FINSI;
|FPRC;

|PROCESO Tc1Centros; |TIPO 7;
     #0#23 = #0#22;
     |PINTA #0#23;
     |C_M #0#23, 1, "N";
|FPRC;

|PROCESO Tc1Atrasos; |TIPO 7;
     |C_M #0#25, 1, "S";
     |SI #0#24 = "2";
         #0#25 = "2";
         |PINTA #0#25;
         |C_M #0#25, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Imagenes;   |TIPO 0;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     aAlfa1 = #0#0; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = "00000";
     orden = aAlfa1 + aAlfa2;
     pasa  = "E";
     |SUB_EJECUTA "nombmp01";
|FPRC;

|PROCESO TipoIRPF; |TIPO 0;
     |SI #0#10 ! 0;|Y #0#10 ! 3;|Y #0#10 ! 4;
          |MENAV "    Error de entrada ...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO TraeCampos;
     #0#0  = #1#1;
     #0#1  = #1#11;
     #0#2  = #1#12;
     #0#3  = #1#13;
     #0#4  = #1#14;
     #0#5  = #1#19;
     #0#6  = #1#20;
     #0#7  = #1#25;
     #0#8  = #1#26;
     #0#9  = #1#27;
     #0#10 = #1#28;
     #0#11 = #1#29;
     #0#12 = #1#32;
     #0#13 = #1#34;
     #0#14 = #1#35;
     #0#15 = #1#36;
     #0#16 = #1#39;
     #0#78 = #1#15;
     #0#79 = #1#18;
     #0#77 = #1#127;
     #0#80 = #1#16;
     #0#81 = #1#110;
     #0#82 = #1#17;
     #0#83 = #1#50;
     #0#84 = #1#51;
     #0#96 = #1#128;
     #0#97 = #1#129;
     #0#98 = #1#64;
     #0#99 = #1#130;
     #0#100 = #1#131;
     #0#101 = #1#132;
     #0#102 = #1#133;
     #0#103 = #1#66;
     #0#104 = #1#67;
     #0#105 = #1#68;
     #0#106 = #1#69;

     |PARA nCampoD   = 17;  |SI nCampoD [ 26;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 23;
           #0nCampoD = #1nCampoH;
     |SIGUE;

     |PARA nCampoD   = 27;  |SI nCampoD [ 63;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 46;
           #0nCampoD = #1nCampoH;
     |SIGUE;

     |PARA nCampoD   = 64;  |SI nCampoD [ 77;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 50;
           #0nCampoD = #1nCampoH;
     |SIGUE;

     |PARA nCampoD   = 85;  |SI nCampoD [ 95;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD - 32;
           #0nCampoD = #1nCampoH;
     |SIGUE;
|FPRC;

|PROCESO LlevaCampos;
     #1#1   = #0#0;
     #1#11  = #0#1;
     #1#12  = #0#2;
     #1#13  = #0#3;
     #1#14  = #0#4;
     #1#19  = #0#5;
     #1#20  = #0#6;
     #1#25  = #0#7;
     #1#26  = #0#8;
     #1#27  = #0#9;
     #1#28  = #0#10;
     #1#29  = #0#11;
     #1#32  = #0#12;
     #1#34  = #0#13;
     #1#35  = #0#14;
     #1#36  = #0#15;
     #1#39  = #0#16;
     #1#15  = #0#78;
     #1#18  = #0#79;
     #1#127  = #0#77;
     #1#16  = #0#80;
     #1#110 = #0#81;
     #1#17  = #0#82;
     #1#50  = #0#83;
     #1#51  = #0#84;
     #1#128  = #0#96;
     #1#129  = #0#97;
     #1#64  = #0#98;
     #1#130 = #0#99;
     #1#131 = #0#100;
     #1#132 = #0#101;
     #1#133 = #0#102;
     #1#66 = #0#103;
     #1#67 = #0#104;
     #1#68 = #0#105;
     #1#69 = #0#106;

     |PARA nCampoD   = 17;  |SI nCampoD [ 26;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 23;
           #1nCampoH = #0nCampoD;
     |SIGUE;

     |PARA nCampoD   = 27;  |SI nCampoD [ 63;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 46;
           #1nCampoH = #0nCampoD;
     |SIGUE;

     |PARA nCampoD   = 85;  |SI nCampoD [ 95;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD - 32;
           #1nCampoH = #0nCampoD;
     |SIGUE;

     |PARA nCampoD   = 53;  |SI nCampoD [ 60;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH   = nCampoD + 32;
           #1nCampoH = #0nCampoD;
     |SIGUE;
|FPRC;

|PROCESO RecogeNif;
     eaCodNif = #0#82;
     |HAZ LeeNifs;
     #0#78 = #712#1;                     |PINTA #0#78;
|FPRC;

|PROCESO Rellena; |TIPO 7;
     nCampo = Campo;
     |PARA nCampo = 85; |SI nCampo [ 92; |HACIENDO nCampo = nCampo + 1;
          |SI #0nCampo = " ";
               #0nCampo = "N"
               |PINTA #0nCampo;
          |FINSI;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |ABRE #1;
     #1#0 = enEmpresa;
     |LEE 101#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
         #1#0 = enEmpresa;
         |GRABA 020#1b;
     |FINSI;

     |HAZ TraeCampos;

     |CAMPO_ANCHO #nomconca#1, 1, 43;
     |PINPA #0#0;
     |PINDA #0#0;

     |ABRE #2;
     #2#0 = #0#0;
     |LEE 040#2=;
     |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;
     |CIERRA #2;

     ||ABRE #3;
     ||#3#0 = #0#12;
     ||LEE 040#3=;
     ||SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
     ||CIERRA #3;

     |ATRI I;
     |PINTA 1037, #2#1;
     ||PINTA 1841, #3#1;

     |SI enModo = 4;
         |LEETECLA aTecla;
     |SINO;
         |ENDATOS #2#0;
         |SI FSalida = 0;
             |HAZ LlevaCampos;
             |HAZ grabared;
             |GRABA 020#1a;
         |FINSI;
     |FINSI;

     |LIBERA #1;
     |CIERRA #1;
     |HAZ FinBotonREDEmp;
|FPRO;

|PROCESO RellenaAcc;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O #0Campo ! Contenido;
          #0#8 = #nomconca#145;
          #0#9 = #nomconca#143;
          #0#20 = #nomconca#146;
          #0#21 = #nomconca#147;
     |FINSI;
|FPRC;

|PROCESO RellenaAnt; |TIPO 7;
     aAlfa1 = #0#93;
     |QBT aAlfa1;
     |SI aAlfa1 = "nticipos";
          #0#93 = "Anticipos";
          |PINTA #0#93;
     |FINSI;
     aAlfa1 = #0#94;
     |QBT aAlfa1;
     |SI aAlfa1 = "nticipos";
          #0#94 = "Anticipos";
          |PINTA #0#94;
     |FINSI;
     aAlfa1 = #0#95;
     |QBT aAlfa1;
     |SI aAlfa1 = "nticipos";
          #0#95 = "Anticipos";
          |PINTA #0#95;
     |FINSI;
|FPRC;

|PROCESO AyudaPagas; |TIPO 7;
     |ATRI R;
               ||  2 3        4         5         6
               ||  89012345678901234567890123456789012345
     |PINTA 0828, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂ"
     |PINTA 0928, "³ Configuracion del prorrateo de pa- ³";
     |PINTA 1028, "³ gas por empresa. Estos valores pa- ³";
     |PINTA 1128, "³ saran al trabajador cuando  se den ³";
     |PINTA 1228, "³ de alta pero  NO influyen directa- ³";
     |PINTA 1328, "³ mente en el calculo de nominas.    ³";
     |ATRI 0;
     |PINTA 1428, "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´"
|FPRC;

|PROCESO CambioCNAE;
     || este preoceso ya esta obsoleto, lo quito y que no se ejecute mas
     |ACABA;

     nModo = (FEntrada / 100) ! 0;
     aAlfa = #0Campo;
     |QBF aAlfa;
     |SI nModo = 2; |Y aAlfa ! aCNAE;
          |ABRE #nomcnahi;
          #nomcnahi#0 = #1#0;
          #nomcnahi#2 = 2009;
          #nomcnahi#4 = 00;
          |LEE 000#nomcnahi.=;
          FEstado = FSalida;
          aAlfa = #nomcnahi#3;
          |QBF aAlfa;
          |SI FEstado ! 0; |O aAlfa = "";
               |PUSHV 10432279;
               |ATRI R;
                         ||  4        5         6         7
                         ||  3456789012345678901234567890123456789
               |PINTA 1043, " ATENCION: la modificación del  CNAE ";
               |PINTA 1143, " para adaptarlo a las tablas de 2009 ";
               |PINTA 1243, " ha de realizarse mediante el proce- ";
               |PINTA 1343, " ceso: [Gestión de Ficheros/ Gestión  ";
               |PINTA 1443, " de Ficheros Laborales/Mantenimiento ";
               |PINTA 1543, " de Ficheros Laborales Diversos/Man- ";
               |PINTA 1643, " tenimiento de Tarifas de Cotización ";
               |PINTA 1743, " por  AT/EP/ Transformaci¢n  a  CNAE ";
               |PINTA 1843, " 2009]  para guardar los  valores de ";
               |PINTA 1943, " 2008. Si se  modifica  directamente ";
               |PINTA 2043, " este campo se pueden generar  erro- ";
               |PINTA 2143, " res al  calcular atrasos y  seguros ";
               |PINTA 2243, " sociales desde el histórico.        ";
               |ATRI 0;

               |PAUSA;
               |POPV;

               #0Campo = aCNAE;
               |PINTA #0Campo;
               #0#97 = aDesCNAE;
               |PINTA #0#97;

               aAlfa1 = #0Campo;
               aAlfa1 = aAlfa1 % 102;
               #0#1 = aAlfa1;

               |HAZ RellenaCNAE;
          |FINSI;
     |FINSI;
     |CIERRA #nomcnahi;
|FPRC;

|PROCESO CNAE;
     |ABRE #nomcnaec;
     aAlfa1 = #0Campo;
     |QBF aAlfa1;
     |SI aAlfa1 = "";
          #0#97 = "";
          |PINTA #0#97;
          aAlfa1 = "    Es obligatorio introducir el CNAE ";
          aAlfa1 = aAlfa1 + "para la correcta elaboracion de los Seguros Sociales.";
          |MENAV aAlfa1;
          |ERROR;
     |SINO;
          /*
          |SI aAlfa1 = "01";
               aAlfa1 = "    ATENCION: el codigo 01 no tiene asociada cotizacion. "
               aAlfa1 = aAlfa1 + "Debe elegir una de sus actividades asociadas";
               |MENAV aAlfa1;
               |ERROR;
          |SINO;
          */
               #nomcnaec#0 = #0#96;
               |LEE 000#nomcnaec.=;
               |SI FSalida ! 0;
                    aAlfa1 = "    ATENCION: el CNAE introducido no es válido ";
                    aAlfa1 = aAlfa1 + "o no está vigente.";
                    |MENAV aAlfa1;
                    |ERROR;
               |SINO;
                    aAlfa1 = aAlfa1 % 102;
                    #0#1 = aAlfa1;
               |FINSI;
          ||FINSI;
     |FINSI;
     |CIERRA #nomcnaec;
|FPRC;

|PROCESO RellenaCNAE; |TIPO 7;
     |ABRE #nomcnaec;
     aAlfa1 = #0#96;
     |QBF aAlfa1;
     |SI aAlfa1 = "52.";
          aAlfa1 = "52";
          #0#96 = "52";
          |PINTA #0#96;
     |FINSI;
     aCNAE = #0#96;
     |QBF aCNAE;
     aDesCNAE = #0#97;

     #nomcnaec#0 = aCNAE;
     |LEE 000#nomcnaec.=;
     |SI FSalida = 0;
          #0#96 = #nomcnaec#0;
          #0#97 = #nomcnaec#1;
          |PINTA #0#96;
          |PINTA #0#97;
     |FINSI;

/*
     || quito esta parte que con el cmabio de CNAEs de 2009 puede dar
     || problemas
     #nomcnaec#0 = aAlfa1;
     |LEE 000#nomcnaec.=;
     |SI FSalida ! 0; |O aAlfa1 = "";
          |SI #0#11 > 0; |Y #0#11 < 100;
               aAlfa1 = #0#11;
               aAlfa1 = ("000" + aAlfa1) % -102;

               #nomcnaec#0 = aAlfa1;
               |LEE 000#nomcnaec.=;
               |SI FSalida = 0;
                    #0#96 = #nomcnaec#0;
                    #0#97 = #nomcnaec#1;
                    |PINTA #0#96;
                    |PINTA #0#97;
               |FINSI;
          |FINSI;
     |FINSI;
*/
     |CIERRA #nomcnaec;
|FPRC;

|PROCESO Actividad; |TIPO 66;
     |HAZ SacaVentana;
|FPRC;

|PROCESO PintaActiv;
     alfa1 = #0#2;
     |QBF alfa1;
     |SI alfa1 = "";
          #0#2 = #0#97 % 140;
          |PINTA #0#2;
     |FINSI;
|FPRC;

|PROCESO CompActiv;
/*
     alfa1 = #0#1;      || actividad
     alfa1 = "00" + alfa1;
     alfa1 = alfa1 % -102;

     alfa2 = #0#96;     || CNAE
     alfa2 = alfa2 % 102;

     |SI alfa1 ! alfa2;
          alfa3 =  "    ATENCION: La actividad de la empresa no puede per";
          alfa3 = alfa3 + "tenecer a un grupo distinto del CNAE";
          |MENAV alfa3;
          alfa3 = "    Pulse F11 y elija una actividad del grupo especificado";
          alfa3 = alfa3 + " en el CNAE de la empresa (" + alfa2 + ")";
          |MENAV alfa3;
          |ERROR;
     |FINSI;
*/
|FPRC;

|PROCESO Tipo88emp; |TIPO 88;
     |HAZ Tipo88;
     |HAZ ITIMSemp;
     |HAZ labclean_emp;
|FPRC;

|PROCESO ITIMSemp;
     fFecha = ~;
     aAlfa = fFecha; aAlfa = aAlfa % -104;
     nElAny = aAlfa;
     aAlfa = fFecha; aAlfa = aAlfa % 402;
     nElMes = aAlfa;
     |HAZ ValoresITIMS;
|FPRC;

|PROCESO ConsultaCal1; |TIPO 66;
     aAlfa1 = #labempre#7; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa2 = #labempre#8; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
     aCodPos = aAlfa1 + aAlfa2;
     nOpcionPLB = 0;
     |HAZ ConsCalenPLB;
     |SI nOpcionPLB ! 0;
          #0Campo = nOpcionPLB;
          |PINTA #0Campo;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Activa98;
     |SI #0#77 > 0;
          |CAMPO_MODIFICA #0#98, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#98, 1, "N";
     |FINSI;
|FPRC;
/*
|PROCESO SSOnlineEmp;
     |SI nOpcion = 0;
          |ACABA;
     |FINSI;
     aAlfa1 = #labempre#0; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
     || aAlfa2 = #0#1; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;
     aAlfa2 = "00001";
     |SI nOpcion = 1;
          aAlfa = "labnct07;"+ "06" + aAlfa1 + aAlfa2;
     |FINSI;
     |SI nOpcion = 2;
          aAlfa = "labnct07;"+ "09" + aAlfa1 + aAlfa2;
     |FINSI;
     |SI nOpcion = 3;
          aAlfa = "labnct07;"+ "11" + aAlfa1 + aAlfa2;
     |FINSI;
     |SI nOpcion = 4;
          aAlfa = "labnct07;"+ "13" + aAlfa1 + aAlfa2;
     |FINSI;
     |SI nOpcion = 5;
          aAlfa = "labnct07;"+ "15" + aAlfa1 + aAlfa2;
     |FINSI;

     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO MenuREDEmp;
     eaVengoDe = "labempre";
     |VARIABLES; {20} aPopup = ""; |FINSI;
     aPopup1 = "-1";  || Si fuera -1 en la posicion
     aPopup2 = 4;
     aPopup3 = "1. Situación de la empresa";
     aPopup4 = "2. Certificado situación de cotización";
     aPopup5 = "3. Afiliados en el Cod. Cta. Coticación";
     aPopup6 = "4. Consulta de trabajadores en alta";
     aPopup7 = "5. Consulta de Convenios";
     IaPopup = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     nOpcion = FSalida;
     |HAZ SSOnlineEmp;
|FPRC;
*/
|PROCESO BotonREDEmp; |TIPO 8;
     |CONTROL_SIMPLE 0, "BOTON,Seguridad Social Online", 0563, 0580, ConectaSS;
     enBoton = FSalida;
     |ESTADO_CONTROL enBoton, "ENABLE";
     swBotonSiNo = 1;
|FPRC;

|PROCESO FinBotonREDEmp; |TIPO 9;
     |FIN_CONTROL_WINDOWS enBoton;
     |PULSATECLA;
     swBotonSiNo = 0;
|FPRC;

|PROCESO PonBotonREDEmp; |TIPO 14;
     |SI swBotonSiNo = 0;
          |HAZ BotonREDEmp;
     |FINSI;
|FPRC;

|PROCESO QuitaBotonEmp; |TIPO 14;
     |SI swBotonSiNo = 1;
          |HAZ FinBotonREDEmp;
     |FINSI;
|FPRC;

|PROCESO CompEmail_emp;
     eaEmail = #0Campo;
     |HAZ CompEmail_plb;
|FPRC;

|PROCESO CompDSArchi_emp;
     |HAZ MiraSiArchiva;
     |SI nArchi ! 1; |Y #0Campo = "S";
          aAlfa = "    Ha de tener instalada la aplicación DSARCHI y activar ";
          aAlfa = aAlfa + "la emisión de nóminas para poder usar esta opción";
          |MENAV aAlfa;

          #0Campo = "N";
          |PINTA #0Campo;
          |ACABA;
     |FINSI;
     |SI #0Campo = "S";
          nCampo = Campo - 1;
          aAlfa = #0nCampo;
          |QBF aAlfa;
          |SI aAlfa = "";
               aAlfa = "    ATENCION. La dirección de correo electrónico del ";
               aAlfa = aAlfa + "trabajador está en blanco. No se enviará la nómina.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Iniciando_emp;
     |SI #labempre#69 ! "S"; |Y #labempre#69 ! "N";
          #labempre#69 = "N";
     |FINSI;
     |GRABA 020#labempre.a;
     |LIBERA #labempre;
|FPRC;

|DEFBUCLE Iniciando_emp;
     #labempre#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Iniciando_emp;
|FIN;

|PROCESO labclean_emp;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "nomw0002";
          |ACABA;
     |FINSI;

     |PINTA 1327, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿"
     |PINTA 1427, "³   Inicializando nuevos campos.   ³";
     |PINTA 1527, "³ Por favor, espere unos segundos. ³";
     |PINTA 1627, "³                                  ³"
     |PINTA 1727, "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ"

     |ABRE #labclean;

     #labclean#0 = "labempre";
     #labclean#1 = 69;
     |LEE 101#labclean.=;
     |SI FSalida ! 0;
          |BUCLE Iniciando_emp;

          #labclean#0 = "labempre";
          #labclean#1 = 69;
          #labclean#2 = "S";
          |GRABA 020#labclean.n;
          |LIBERA #labclean;
     |FINSI;

     |CIERRA #labclean;

     |PINTA 1327, "                                    ";
     |PINTA 1427, "                                    ";
     |PINTA 1527, "                                    ";
     |PINTA 1627, "                                    ";
     |PINTA 1727, "                                    ";
|FPRC;

|PROCESO Aviso101;
     |SI #0#101 ! -1; |Y #0Campo ! Contenido;

          |PUSHV 11191768
                     || 2         3         4         5         6
                     || 012345678901234567890123456789012345678901234567
          |AVISO;
          |ATRI R;
          |PINTA 1220, " ATENCION: recuerde que para que las nóminas de ";
          |PINTA 1320, " esta empresa  se impriman con este cuadre,  en ";
          |PINTA 1420, " la emisión de los  recibos de  salario, única- ";
          |PINTA 1520, " mente deberá seleccionar  trabajadores de esta ";
          |PINTA 1620, " empresa.                                       ";
          |PAUSA;
          |POPV;
          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO e_aviso9;
     |POPV;
|FPRC;

|PROCESO Ayuda133; |TIPO 7;
     |PUSHV 09381977;
     |ATRI R;

               ||  3 4         5         6         7
               ||  8901234567890123456789012345678901234567
     |PINTA 0938, " ATENCION: este par metro  se usa  para ";
     |PINTA 1038, " EVITAR que en  trabajadores que  est n ";
     |PINTA 1138, " de alta en esta empresa Y EN OTRAS, se ";
     |PINTA 1238, " tengan en cuenta los ingresos  de esta ";
     |PINTA 1338, " empresa a la hora de regularizar.      ";
     |PINTA 1438, " SOLO si ‚sta es una empresa de pruebas ";
     |PINTA 1538, " y NO hay que tener en cuenta  sus tra- ";
     |PINTA 1638, " bajadores para el c lculo del IRPF, en ";
     |PINTA 1738, " ese caso hay que indicar 'S', para de- ";
     |PINTA 1838, " sactivar el c lculo  conjunto de  esta ";
     |PINTA 1938, " empresa en la regularizaci¢n de IRPF.  ";
|FPRC;

|PROCESO labtraba;
     #labtraba#142 = aValor;
     |GRABA 020#labtraba.a;
     |LIBERA #labtraba;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#8;
     ;
     "A", #1#0, 00001;
     "A", #1#0, 99999;
     be;
     NULL, labtraba;
|FIN;

|PROCESO IDAL;
     |SI Contenido = "N"; |Y #0#106 = "S";
          aValor = "S";
          |BUCLE labtraba;
     |FINSI;

     |SI Contenido = "S"; |Y #0#106 = "N";
          aValor = "N";
          |BUCLE labtraba;
     |FINSI;
|FPRC;
