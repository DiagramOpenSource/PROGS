|FICHEROS;
     hotm0009 #0;
     hotm0010 #1;
|FIN;

|VARIABLES;
   Flag = 0;
   Calc = 0;
   UltLinea = 0;
   LineaAct = 0;
   ModoEntrada = 0;
|FIN;

|PROCESO RecalcProrrata;
   UltLinea = #hotm0010#4;
   #hotm0010#11 = #hotm0010#12 / #hotm0009#5;
   #hotm0009#6 = #hotm0009#6 + #hotm0010#11;
   |GRABA 020#hotm0010.a;
|FPRC;

|DEFBUCLE RecalcProrrata;
#hotm0010#1;
;
#hotm0009#0, #hotm0009#1, #hotm0009#2, #hotm0009#3, 001;
#hotm0009#0, #hotm0009#1, #hotm0009#2, #hotm0009#3, 999;
;
NULL,RecalcProrrata;
|FIN;

|PROCESO Acumula; |TIPO 2;
     ModoEntrada = (FEntrada / 100) ! 0;
     Flag = 0+.1;
     #hotm0009#5 = #hotm0009#5 +. #hotm0010#12;
     |SI Flag > 0;
        #hotm0009#6 = 0;
        |SI ModoEntrada = 1;
           |GRABA 020#hotm0010.b;
        |SINO;
           |GRABA 020#hotm0010.a;
        |FINSI;
        LineaAct = #hotm0010#4;
        |BUCLE RecalcProrrata;
        |SI #hotm0009#6 < 1;
           Calc = 1 - #hotm0009#6;
           #hotm0010#0 = #hotm0009#0;
           #hotm0010#1 = #hotm0009#1;
           #hotm0010#2 = #hotm0009#2;
           #hotm0010#3 = #hotm0009#3;
           #hotm0010#4 = UltLinea;
           |LEE 000#hotm0010.=;
           |SI FSalida = 0;
              #hotm0010#11 = #hotm0010#11 + Calc; |GRABA 020#hotm0010.a;
              #hotm0009#6 = 1;
           |FINSI;
        |FINSI;
        #hotm0010#0 = #hotm0009#0;
        #hotm0010#1 = #hotm0009#1;
        #hotm0010#2 = #hotm0009#2;
        #hotm0010#3 = #hotm0009#3;
        #hotm0010#4 = LineaAct;
        |LEE 000#hotm0010.=;
        |PONCONTROL 23,"si"; |PTEC 815;
     |SINO;
        #hotm0009#6 = #hotm0009#6 +. #hotm0010#11;
     |FINSI;
     |PINTA #hotm0009#6;
|FPRC;

|PROCESO Calcula;
   |SI #1#12 ! 0;
      |C_M #1#11,1,"N";
      #hotm0010#11 = #hotm0010#12 / #hotm0009#5;
      |PINTA #1#11;
   |SINO;
      #1#11 = 1 - #0#4; |PINTA #1#11;
      |C_M #1#11,1,"S";
   |FINSI;
|FPRC;
