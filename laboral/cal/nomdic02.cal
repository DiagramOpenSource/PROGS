|FICHEROS;
     nomres02 #0;
|FIN;

|VARIABLES;
     nUltima = 0;
     nInforme = 0;
     nLinea = 0;
     nPosicion = 0;
|FIN;

|PROCESO cuenta;
     nUltima = #0#1;
|FPRC;

|DEFBUCLE cuenta;
     #0#1;
     ;
     nInforme, 01;
     nInforme, 99;
     ;
     NULL, cuenta;
|FIN;

|PROCESO InsertaLinea; |TIPO 11;
     |SI FSalida ! 13;
          |ACABA;
     |FINSI;

     nPosicion = #0#1;
     nInforme = #0#0;
     |BUCLE cuenta;

     |PARA nLinea = nUltima; |SI nLinea ] nPosicion; |HACIENDO nLinea = nLinea - 1;
          #0#0 = nInforme;
          #0#1 = nLinea;
          |LEE 101#0=;
          |SI FSalida = 0;
               #0#0 = nInforme;
               #0#1 = nLinea + 1;
               |GRABA 020#0n;
               |LIBERA #0;

               |SI nLinea ! nPosicion;
                    #0#0 = nInforme;
                    #0#1 = nLinea;
                    |LEE 101#0=;
                    |SI FSalida = 0;
                         |BORRA 020#0a;
                         |LIBERA #0;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;

     #0#0 = nInforme;
     #0#1 = nPosicion;
     |LEE 101#0=;
     |SI FSalida = 0;
          #0#2 = 0;
          #0#3 = "";
          #0#4 = "S";
          |GRABA 020#0a;
          |LIBERA #0;
          |LEE 000#0=;
     |FINSI;
     |PONCONTROL 23, "si"; |PTEC 815;
     |ERROR;
|FPRC;
