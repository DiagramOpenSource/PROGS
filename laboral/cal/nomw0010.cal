|FICHEROS;
    nomw0010 #0;
    labtraba #2;
    nomcatli #4;    || aux. categorias lins.
    nomtrali #6;    || aux. trabajadores lins.
    nomconca #9;    || convenios cabs.
    nomtrcal #20;   || calendario laboral
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    actu_any = 0;
    dias_any = 0;
    bisiesto = 0;
    tope_mes = 0;
    dias_vac = 0;
    dias_fes = 0;

    &enEmpresa = 0;
    &enModo    = 0;
|FIN;
____________________________________/
|PROCESO calcula_horas;
    nume1 = dias_any - (dias_vac + dias_fes);
    nume1 = #9#141 / nume1;
    #0#9 = nume1;
|PINTA #0#9;
|FPRC;

|RUTINA dias_del_mes;
|SI para1 = 1;   tope_mes = 31;           |FINSI;
|SI para1 = 2;   tope_mes = 28 + bisiesto;|FINSI;
|SI para1 = 3;   tope_mes = 31;           |FINSI;
|SI para1 = 4;   tope_mes = 30;           |FINSI;
|SI para1 = 5;   tope_mes = 31;           |FINSI;
|SI para1 = 6;   tope_mes = 30;           |FINSI;
|SI para1 = 7;   tope_mes = 31;           |FINSI;
|SI para1 = 8;   tope_mes = 31;           |FINSI;
|SI para1 = 9;   tope_mes = 30;           |FINSI;
|SI para1 = 10;  tope_mes = 31;           |FINSI;
|SI para1 = 11;  tope_mes = 30;           |FINSI;
|SI para1 = 12;  tope_mes = 31;           |FINSI;
|FRUT;

|PROCESO dias_festivos;
    dias_fes = 0;

|DDEFECTO #20;
|ABRE #20;
    #20#0 = #2#156;
    #20#13 = actu_any;
|LEE 000#20=;
|SI FSalida = 0;
    |PARA para1 = 1; |SI para1 [ 12; |HACIENDO para1 = para1 + 1;
        |HAZ dias_del_mes;
        |PARA para2 = 1; |SI para2 [ tope_mes; |HACIENDO para2 = para2 + 1;
                nume1 = (para2 * 100) + 1;
                alfa1 = #20para1 % nume1;
            |SI alfa1 = "1";
                    dias_fes = dias_fes + 1;
            |FINSI;
        |SIGUE;
    |SIGUE;
|SINO;
    |MENAV "    Calendario Laboral NO definido ...";
|FINSI;
|CIERRA #20;
|FPRC;

|PROCESO dias_vacacion;

    dias_vac = 30;

|ABRE #4;
    #4#0 = #2#87;
    #4#1 = #2#17;
    #4#2 = 904;
|LEE 000#4=;
|SI FSalida = 0; dias_vac = #4#3; |FINSI;
|CIERRA #4;

|ABRE #6;
    #6#0 = #2#0;
    #6#1 = #2#1;
    #6#2 = 904;
|LEE 000#6=;
|SI FSalida = 0; dias_vac = #6#3; |FINSI;
|CIERRA #6;
|FPRC;

|PROCESO dias_anyo;
    dias_any = 365;

    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -104;
    actu_any = alfa1;
    nume2 = actu_any $ 4;
|SI nume2 = 0;
        bisiesto = 1;
|SINO;
        bisiesto = 0;
|FINSI;
    dias_any = dias_any + bisiesto;
|FPRC;

|PROCESO lee_convenio;
|DDEFECTO #9;
|ABRE #9;
    #9#0 = #2#87;   || convenio
|LEE 040#9=;
|CIERRA #9;
|FPRC;

|PROCESO lee_traba;
|DDEFECTO #2;
|ABRE #2;
    #2#0 = #0#0;    || empresa
    #2#1 = #0#1;    || trabajador
|LEE 040#2=;
|CIERRA #2;
|FPRC;

|PROCESO horas_dia; |TIPO 7;
|SI #0#9 = 0;
    |ATRI P;   |MENSA "    Calculando ...";  |ATRI 0;

    |HAZ lee_traba;
    |HAZ lee_convenio;
    |HAZ dias_anyo;
    |HAZ dias_vacacion;
    |HAZ dias_festivos;
    |HAZ calcula_horas;

    |ATRI R;   |BLIN 4;                      |ATRI 0;
|FINSI;
|FPRC;

|PROCESO Tipo7;  |TIPO 7;
     |HAZ lee_traba;

     |ATRI I;
     |PINTA 0930, #2#2;
     |ATRI i;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0  = enEmpresa;
     #0#1  = 00001;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0  = enEmpresa;
     #0#1  = 99999;
|FRUT;

|PROGRAMA;
     |ENTLINEAL #1#0, -2, enModo, 22, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
