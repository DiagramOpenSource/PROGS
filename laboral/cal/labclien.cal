|FICHEROS;
    labclien #0;         || pension-1
    labclipa #1,MANTE;   || pension-2
    labsalmi #2;         || salarios minimos
    labajust #3;         || ajustes
    labminpe #4;         || cuantias minimas
|FIN;

|VARIABLES;
    edad = 0;
    totdias = 0;
    diajub = 0;
    varcampo = 0;
    desde = 0;
    hasta = 0;
    base11 = 0;
    anynum = 0;
    num = 0;
    swmes = 0;
    swany = 0;
    x = 0;
    anypan = 0;
    actu = 0;
    primero = 0;
    any_ipc = 0;
    campo_any = 0;
    ipc = 0;
    ipc_fijo = 0;
    coefi = 0;
    base1 = 0;
    topemes = 0;
    bisiesto = 0;
    nume0 = 0;
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    diaalf   = " ";
    mesalf   = " ";
    anyoalf  = " ";
    anyalf   = "      ";
    dianaci  = 0;
    mesnaci  = 0;
    anyonaci = 0;
    dd = 0;
    mm = 0;
    aa = 0;
    diapen    = 0;
    mespen    = 0;
    anyopen   = 0;
    anyjubila = 0;
    resto = 0;
    tdias = 0;
    tanos = 0;
    sumadias = 0;
    jubilames = " ";
    jubilaany = " ";
    mesnum = 0;
    cogemes = " ";
    salario = 0;
    pantalla = " < F1 > Pantalla_2 ";
    alta = 0;
    fechadia = @;
    fachafil = @;
    anodia = " ";
    anonum = 0;
    dosany = " ";
    alfa1 = "";
    modo = 0;
    inkey = 0;
|FIN;
____________________________________/ CALCULOS DE PANTALLA

|PROCESO cotiza; |TIPO 0;          || desde fecha de nacimiento
    fechadia = ~;
    anodia = fechadia % -104;
    anonum = anodia;
    diaalf  = #0#4 % 102;
    mesalf  = #0#4 % 402;
    anyoalf = #0#4 % -104;

    dianaci  = diaalf;
    mesnaci  = mesalf;
    anyonaci = anyoalf;

    edad = anonum - anyonaci;

    dd = 01 - dianaci;
    mm = 01 - mesnaci;
    aa = 1967 - anyonaci;

|SI dd < 0;
        mm = mm - 1;
    |SI mm < 0;
            aa = aa - 1;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO pregunta; |TIPO 7;        || desde cotiza antes del 01.01.1967
|SI aa < 21;        || comprueba en fecha 01.01.1967 la edad > 20
    |HAZ nopasa;    || si es menor no pregunta cotizacion
|FINSI;
|FPRC;

|PROCESO edad_cotizacion;          || desde cotiza antes del 01.01.1967
     #0#83 = 0;     || a¤os complemento
     #0#84 = 0;     || dias complemento

|SI aa ] 65; #0#83 = 30; #0#84 = 319; |FINSI;
|SI aa = 64; #0#83 = 30; #0#84 =  67; |FINSI;
|SI aa = 63; #0#83 = 29; #0#84 = 182; |FINSI;
|SI aa = 62; #0#83 = 28; #0#84 = 296; |FINSI;
|SI aa = 61; #0#83 = 28; #0#84 =  46; |FINSI;
|SI aa = 60; #0#83 = 27; #0#84 = 161; |FINSI;
|SI aa = 59; #0#83 = 26; #0#84 = 275; |FINSI;
|SI aa = 58; #0#83 = 26; #0#84 =  25; |FINSI;
|SI aa = 57; #0#83 = 25; #0#84 = 139; |FINSI;
|SI aa = 56; #0#83 = 24; #0#84 = 254; |FINSI;
|SI aa = 55; #0#83 = 24; #0#84 =   4; |FINSI;
|SI aa = 54; #0#83 = 23; #0#84 = 118; |FINSI;
|SI aa = 53; #0#83 = 22; #0#84 = 233; |FINSI;
|SI aa = 52; #0#83 = 21; #0#84 = 347; |FINSI;
|SI aa = 51; #0#83 = 21; #0#84 =  97; |FINSI;
|SI aa = 50; #0#83 = 20; #0#84 = 212; |FINSI;
|SI aa = 49; #0#83 = 19; #0#84 = 326; |FINSI;
|SI aa = 48; #0#83 = 19; #0#84 =  76; |FINSI;
|SI aa = 47; #0#83 = 18; #0#84 = 191; |FINSI;
|SI aa = 46; #0#83 = 17; #0#84 = 305; |FINSI;
|SI aa = 45; #0#83 = 17; #0#84 =  55; |FINSI;
|SI aa = 44; #0#83 = 16; #0#84 = 169; |FINSI;
|SI aa = 43; #0#83 = 15; #0#84 = 284; |FINSI;
|SI aa = 42; #0#83 = 15; #0#84 =  34; |FINSI;
|SI aa = 41; #0#83 = 14; #0#84 = 148; |FINSI;
|SI aa = 40; #0#83 = 14; #0#84 = 263; |FINSI;
|SI aa = 39; #0#83 = 13; #0#84 =  12; |FINSI;
|SI aa = 38; #0#83 = 12; #0#84 = 127; |FINSI;
|SI aa = 37; #0#83 = 11; #0#84 = 242; |FINSI;
|SI aa = 36; #0#83 = 10; #0#84 = 356; |FINSI;
|SI aa = 35; #0#83 = 10; #0#84 = 106; |FINSI;
|SI aa = 34; #0#83 =  9; #0#84 = 220; |FINSI;
|SI aa = 33; #0#83 =  8; #0#84 = 335; |FINSI;
|SI aa = 32; #0#83 =  8; #0#84 =  85; |FINSI;
|SI aa = 31; #0#83 =  7; #0#84 = 199; |FINSI;
|SI aa = 30; #0#83 =  6; #0#84 = 314; |FINSI;
|SI aa = 29; #0#83 =  6; #0#84 =  64; |FINSI;
|SI aa = 28; #0#83 =  5; #0#84 = 178; |FINSI;
|SI aa = 27; #0#83 =  4; #0#84 = 293; |FINSI;
|SI aa = 26; #0#83 =  4; #0#84 =  42; |FINSI;
|SI aa = 25; #0#83 =  3; #0#84 = 157; |FINSI;
|SI aa = 24; #0#83 =  2; #0#84 = 272; |FINSI;
|SI aa = 23; #0#83 =  2; #0#84 =  21; |FINSI;
|SI aa = 22; #0#83 =  1; #0#84 = 136; |FINSI;
|SI aa = 21; #0#83 =  0; #0#84 = 250; |FINSI;

|PINTA #0#83;
|PINTA #0#84;
|FPRC;

|PROCESO pintar; |TIPO 0;          || desde cotiza antes del 01.01.1967
|SI #0Campo = "S";            || comprueba en la tabla el coeficiente
    |HAZ edad_cotizacion;     || segun la edad > 20
|SINO;
        #0#83 = 0;  |PINTA #0#83;
        #0#84 = 0;  |PINTA #0#84;
|FINSI;
|FPRC;

|PROCESO pedir; |TIPO 7;           || desde dias o fechas
|SI #0#6 = "F";     || si pide fechas no pasa por dias a cotizar
    |HAZ nopasa;
|FINSI;
|FPRC;

|PROCESO fechas; |TIPO 7;          || desde cada fecha
|SI #0#6 = "D";     || si pide dias a cotizar no pasa por fechas
    |HAZ nopasa;
|SINO;
    |PINTA 0424,pantalla;
    |SI FSalida = 9;
        |HAZ pantalla;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO diascot; |TIPO 0;         || desde dias cotizacion
|SI #0#6 = "D";                    || calculo cuando pide dias cotizados
        totdias  = #0Campo;
        #0#82 = 0;                 || dias cotizados
        #0#85 = 0;                 || total a¤os
        #0#86 = 0;                 || total dias
        #0#87 = 0;                 || a¤os total
        #0#89 = 0;                 || %base reguladora
        resto = totdias $ 365;
     |SI resto ! 0;                          || si el resto es diferente a 0
             tdias  = (totdias - resto);     || hay a¤os y dias
             #0#82  = resto;                 || dias de la fecha
             #0#81  = tdias / 365;           || a¤os de la fecha
     |SINO;
             #0#81 = totdias / 365;          || si resto es 0 solo a¤os
             #0#82 = 0;
     |FINSI;
         #0#85 = #0#81 + #0#83;    || suma de a¤os
         #0#86 = #0#82 + #0#84;    || suma de dias
     |SI #0#86 ] 365;
             resto = #0#86 $ 365;
         |SI resto ! 0;
                 tdias = (#0#86 - resto);    || hay a¤os y dias
                 #0#86 = resto;              || suma dias
                 #0#85 = tdias / 365;        || suma a¤os
                 #0#85 = #0#85 + #0#81 + #0#83;
         |SINO;
                 #0#85 = #0#86 / 365;        || si no hay resto solo a¤os
                 #0#85 = #0#85 + #0#81 + #0#83;
                 #0#86 = 0;
         |FINSI;
     |FINSI;
         #0#87 = #0#85;                 || total de a¤os
     |SI #0#86 ! 0;                     || si hay total de dias
             #0#87 = #0#85 + 1;         || al total a¤os le sumamos uno
     |FINSI;
     |HAZ tabla_regulador;              || leemos la tabla reguladora
                                        || para sacar el %Base regimen
     |PINTA #0#81;  || a¤os Cotizacion
     |PINTA #0#82;  || dias Cotizacion
     |PINTA #0#85;  || suma a¤os
     |PINTA #0#86;  || suma Dias
     |PINTA #0#87;  || total a¤os
     |PINTA #0#89;  || %Base Regimen
|FINSI;
|FPRC;

|PROCESO jubila; |TIPO 0;          || desde fecha de jubilacion
     inkey = FSalida;

     alta = 0;
     diaalf   = #0#4 % 102;
     mesalf   = #0#4 % 402;
     anyoalf  = #0#4 % -104;

     dianaci  = diaalf;
     mesnaci  = mesalf;
     anyonaci = anyoalf;

|SI FEntrada = 202;
    |SI #0Campo ! Contenido;
            alta = 1;
    |FINSI;
|FINSI;
                              || a¤o jubilacion menos a¤o nacimiento
     diaalf   = #0#5 % 102;
     mesalf   = #0#5 % 402;
     anyoalf  = #0#5 % -104;

     diapen   = diaalf;
     diajub   = diapen;       || dia de jubilacion
     mespen   = mesalf;       || mes de jubilacion
     anyopen  = anyoalf;      || a¤o de jubilacion

     dd = diapen - dianaci;
     mm = mespen - mesnaci;
     anyjubila = anyopen - anyonaci;

|SI dd < 0;
        mm = mm - 1;
    |SI mm < 0;
            anyjubila = anyjubila - 1;
    |FINSI;
|FINSI;
|SI anyjubila < 60;
    |SI inkey ! 2;
        |MENAV "    Es menor de 60 a¤os ...";
        |ERROR;
    |FINSI;
|SINO;
        #0#90 = 0;  || tabla edad minima exigible
    |SI anyjubila [ 60; #0#90 = 0.60; |FINSI;
    |SI anyjubila = 61; #0#90 = 0.68; |FINSI;
    |SI anyjubila = 62; #0#90 = 0.76; |FINSI;
    |SI anyjubila = 63; #0#90 = 0.84; |FINSI;
    |SI anyjubila = 64; #0#90 = 0.92; |FINSI;
    |SI anyjubila > 64; #0#90 = 1;    |FINSI;
    |PINTA #0#90;
|FINSI;
|FPRC;

|PROCESO valida; |TIPO 0;               || desde campo desde fecha-1
|SI #0Campo < "01.01.1960";
    |MENAV "    La fecha debera ser mayor o igual a 01.01.1960 ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO periodo;|TIPO 0;          || desde campos hasta fecha
|SI #0#6 = "F";
        varcampo = Campo - 1;
    |SI #0Campo < #0varcampo;
        |MENAV "    Error de entrada ...";
        |ERROR;
    |SINO;
            totdias = 0;
        |PARA desde = 9;|SI desde [ 80;|HACIENDO desde = desde + 2;
                hasta = desde + 1;
                sumadias = #0hasta - #0desde;
            |SI sumadias > 0;
                    totdias = totdias + sumadias;
            |FINSI;
        |SIGUE;
            #0#82 = totdias;
            #0#85 = 0;            || total a¤os
            #0#86 = 0;            || total dias
            #0#87 = 0;            || a¤os total
            #0#89 = 0;            || %Base Reguladora
            resto = totdias $ 365;
        |SI resto ! 0;
                tdias  = (totdias - resto);
                #0#82  = resto;
                #0#81  = tdias / 365;
        |SINO;
                #0#81 = totdias / 365;
                #0#82 = 0;
        |FINSI;
            #0#85 = #0#81 + #0#83;          || total a¤os
            #0#86 = #0#82 + #0#84;          || total dias
        |SI #0#86 ] 365;
                resto = #0#86 $ 365;
            |SI resto ! 0;
                    tdias = (#0#86 - resto);     || hay a¤os y dias
                    #0#86 = resto;               || suma dias
                    #0#85 = tdias / 365;         || suma a¤os
                    #0#85 = #0#85 + #0#81 + #0#83;
            |SINO;
                    #0#85 = #0#86 / 365;         || si no hay resto solo a¤os
                    #0#85 = #0#85 + #0#81 + #0#83;
                    #0#86 = 0;
            |FINSI;
        |FINSI;
            #0#87 = #0#85;
        |SI #0#86 ! 0;
                #0#87 = #0#85 + 1;
        |FINSI;
        |HAZ tabla_regulador;
        |PINTA #0#81;    || a¤os Cotizacion
        |PINTA #0#82;    || dias Cotizacion
        |PINTA #0#85;    || total a¤os
        |PINTA #0#86;    || total dias
        |PINTA #0#87;    || total dias
        |PINTA #0#89;    || %Base Regimen
    |FINSI;
|FINSI;
|FPRC;

|PROCESO tabla_regulador;
|SI #0#87 = 15; #0#89 = 60;  |FINSI;
|SI #0#87 = 16; #0#89 = 62;  |FINSI;
|SI #0#87 = 17; #0#89 = 64;  |FINSI;
|SI #0#87 = 18; #0#89 = 66;  |FINSI;
|SI #0#87 = 19; #0#89 = 68;  |FINSI;
|SI #0#87 = 20; #0#89 = 70;  |FINSI;
|SI #0#87 = 21; #0#89 = 72;  |FINSI;
|SI #0#87 = 22; #0#89 = 74;  |FINSI;
|SI #0#87 = 23; #0#89 = 76;  |FINSI;
|SI #0#87 = 24; #0#89 = 78;  |FINSI;
|SI #0#87 = 25; #0#89 = 80;  |FINSI;
|SI #0#87 = 26; #0#89 = 82;  |FINSI;
|SI #0#87 = 27; #0#89 = 84;  |FINSI;
|SI #0#87 = 28; #0#89 = 86;  |FINSI;
|SI #0#87 = 29; #0#89 = 88;  |FINSI;
|SI #0#87 = 30; #0#89 = 90;  |FINSI;
|SI #0#87 = 31; #0#89 = 92;  |FINSI;
|SI #0#87 = 32; #0#89 = 94;  |FINSI;
|SI #0#87 = 33; #0#89 = 96;  |FINSI;
|SI #0#87 = 34; #0#89 = 98;  |FINSI;
|SI #0#87 ] 35; #0#89 = 100; |FINSI;
|FPRC;

|PROCESO nopasa;
    xxaponer = Anono;
    xxxxfiac = Control % A1001;
    Control = Control + xxxxfiac;
    Control = Control + xrelleno;
    Control = Control % A120;
    Control = Control + xxaponer;
|FPRC;

|PROCESO baja; |TIPO 1;
    modo = (FEntrada / 100) ! 0;
|SI modo = 3;
    |ABRE #1;
        #1#0 = #0#0;
    |LEE 101#1=;
    |SI FSalida = 0;
        |BORRA 020#1a;
    |FINSI;
    |LIBERA #1;
    |CIERRA #1;
|FINSI;
|FPRC;
____________________________________/ CALCULO DE LA PENSION
|PROCESO ulti_dia;
    nume0 = jubilaany $ 4;
|SI nume0 = 0; bisiesto = 1;  |FINSI;
|SI nume0 ! 0; bisiesto = 0;  |FINSI;
|SI jubilames = "01";  topemes = 31;  |FINSI;
|SI jubilames = "02";  topemes = 28 + bisiesto;  |FINSI;
|SI jubilames = "03";  topemes = 31;  |FINSI;
|SI jubilames = "04";  topemes = 30;  |FINSI;
|SI jubilames = "05";  topemes = 31;  |FINSI;
|SI jubilames = "06";  topemes = 30;  |FINSI;
|SI jubilames = "07";  topemes = 31;  |FINSI;
|SI jubilames = "08";  topemes = 31;  |FINSI;
|SI jubilames = "09";  topemes = 30;  |FINSI;
|SI jubilames = "10";  topemes = 31;  |FINSI;
|SI jubilames = "11";  topemes = 30;  |FINSI;
|SI jubilames = "12";  topemes = 31;  |FINSI;
|FPRC;

|PROCESO calfinal;
    alfa1 = #0#5;
    jubilames = alfa1 % 402;
    jubilaany = alfa1 % -102;
    anypan = jubilaany;
|HAZ ulti_dia;           || saca el ultimo mes entero cotizado
|SI diajub = topemes;              || ultimo dia natural del mes de jubilacion
        mesnum = jubilames;        || mes de jubilacion el mismo
|SINO;
        mesnum = jubilames - 1;    || mes de jubilacion anterior
|FINSI;
|SI mesnum = 0;
        mesnum = 12;
        anypan = anypan - 1;
    |SI anypan < 0;  anypan = 100 + anypan;  |FINSI;
|FINSI;

    anypan = anypan - 2;
|SI anypan < 0;  anypan = 100 + anypan; |FINSI;

    base11 = 0;
|PARA actu = 5; |SI actu [ 29; |HACIENDO actu = actu + 1;
    |SI actu ! 17;
            base11 = base11 + #1actu;
    |FINSI;
|SIGUE;

    primero = 0;
|ABRE #3;
|PARA any_ipc = 30; |SI any_ipc [ 95; |HACIENDO any_ipc = any_ipc + 13;
        campo_any = any_ipc + 1;
    |PARA desde = 108;|SI desde [ 119;|HACIENDO desde = desde + 1;
        |SI #1desde = "ENERO     "; ipc = 1;  |FINSI;
        |SI #1desde = "FEBRERO   "; ipc = 2;  |FINSI;
        |SI #1desde = "MARZO     "; ipc = 3;  |FINSI;
        |SI #1desde = "ABRIL     "; ipc = 4;  |FINSI;
        |SI #1desde = "MAYO      "; ipc = 5;  |FINSI;
        |SI #1desde = "JUNIO     "; ipc = 6;  |FINSI;
        |SI #1desde = "JULIO     "; ipc = 7;  |FINSI;
        |SI #1desde = "AGOSTO    "; ipc = 8;  |FINSI;
        |SI #1desde = "SEPTIEMBRE"; ipc = 9;  |FINSI;
        |SI #1desde = "OCTUBRE   "; ipc = 10; |FINSI;
        |SI #1desde = "NOVIEMBRE "; ipc = 11; |FINSI;
        |SI #1desde = "DICIEMBRE "; ipc = 12; |FINSI;
        |SI primero = 0;
            |DDEFECTO #3;
                #3#0 = anypan;
            |LEE 000#3=;
                ipc_fijo = #3ipc;
        |SINO;
            |SI #1desde = "DICIEMBRE ";
                    anypan = anypan - 1;
                |SI anypan < 0;  anypan = 100 + anypan; |FINSI;
            |FINSI;
        |FINSI;

        |DDEFECTO #3;
            #3#0 = anypan;
        |LEE 000#3=;
            primero = 1;

            coefi  = ipc_fijo / #3ipc;
            base1  = coefi * #1campo_any;
            base11 = base11 + base1;
            campo_any = campo_any + 1;
    |SIGUE;
|SIGUE;
|CIERRA #3;
|FPRC;

|PROCESO pantalla;
|PUSHV 0501 2380;
|ABRE #1;
|PINPA #0#1;
    #1#0 = #0#0;
|LEE 101#1=;
|SI FSalida ! 0;
        #1#1 = #0#1;
        #1#2 = #0#2;
        #1#3 = #0#3;
    |HAZ datos_pantalla;
    |PINTA #1#108;  |PINTA #1#109; |PINTA #1#110; |PINTA #1#111; |PINTA #1#112;
    |PINTA #1#113;  |PINTA #1#114; |PINTA #1#115; |PINTA #1#116; |PINTA #1#117;
    |PINTA #1#118;  |PINTA #1#119; |PINTA #1#4;   |PINTA #1#17;  |PINTA #1#30;
    |PINTA #1#43;   |PINTA #1#56;  |PINTA #1#69;  |PINTA #1#82;  |PINTA #1#95;
    |ENDATOS #1#1;
    |SI FSalida = 0;
        |GRABA 020#1n;
    |FINSI;
|SINO;
    |SI alta = 1;
        |HAZ datos_pantalla;
        |PINTA #1#108;   |PINTA #1#109; |PINTA #1#110; |PINTA #1#111;
        |PINTA #1#112;   |PINTA #1#113; |PINTA #1#114; |PINTA #1#115;
        |PINTA #1#116;   |PINTA #1#117; |PINTA #1#118; |PINTA #1#119;
        |PINTA #1#4;     |PINTA #1#17;  |PINTA #1#30;  |PINTA #1#43;
        |PINTA #1#56;    |PINTA #1#69;  |PINTA #1#82;  |PINTA #1#95;
        |ENDATOS #2#1;
        |SI FSalida = 0;
            |GRABA 020#1a;
        |FINSI;
    |SINO;
        |PINDA #0#1;
        |ENDATOS #2#1;
        |SI FSalida = 0;
            |GRABA 020#1a;
        |FINSI;
    |FINSI;
|FINSI;
|POPV;
|LIBERA #1;
|CIERRA #1;

|HAZ calfinal;
    #0#88 = base11 / 112;          || base reguladora
    #0#91 = #0#88 % #0#89;         || total base segun a¤os cotizados
|SI #0#90 ! 0;
        #0#91 = #0#91 * #0#90;     || total base segun edad jubilacion
|FINSI;

|ABRE #4;
    #4#0 = anyopen;
|LEE 000#4=;                            || cuantias minimas de pension
|SI FSalida = 0;
    |SI #0#92 = "S";|Y edad ] 65;
        |SI #0#91 < #4#1;     #0#91 = #4#1;  |FINSI;
    |FINSI;
    |SI #0#92 = "S";|Y edad < 65;
        |SI #0#91 < #4#3;     #0#91 = #4#3;  |FINSI;
    |FINSI;

    |SI #0#92 = "N";|Y edad ] 65;
        |SI #0#91 < #4#2;     #0#91 = #4#2;  |FINSI;
    |FINSI;
    |SI #0#92 = "N";|Y edad < 65;
        |SI #0#91 < #4#4;     #0#91 = #4#4;  |FINSI;
    |FINSI;
|FINSI;
|CIERRA #4;

|PINTA #0#88;
|PINTA #0#91;
|FPRC;
____________________________________/ CARGA DE LA PANTALLA DE BASES
|PROCESO busca_salario;
    salario = 0;
|DDEFECTO #2;
|ABRE #2;
|LEE 000#2p;
|SI FSalida = 0;
    |SI anynum = 1980; salario = #2#1;  dosany = "80/79"; |FINSI;
    |SI anynum = 1981; salario = #2#2;  dosany = "81/80"; |FINSI;
    |SI anynum = 1982; salario = #2#3;  dosany = "82/81"; |FINSI;
    |SI anynum = 1983; salario = #2#4;  dosany = "83/82"; |FINSI;
    |SI anynum = 1984; salario = #2#5;  dosany = "84/83"; |FINSI;
    |SI anynum = 1985; salario = #2#6;  dosany = "85/84"; |FINSI;
    |SI anynum = 1986; salario = #2#7;  dosany = "86/85"; |FINSI;
    |SI anynum = 1987; salario = #2#8;  dosany = "87/86"; |FINSI;
    |SI anynum = 1988; salario = #2#9;  dosany = "88/87"; |FINSI;
    |SI anynum = 1989; salario = #2#10; dosany = "89/88"; |FINSI;
    |SI anynum = 1990; salario = #2#11; dosany = "90/89"; |FINSI;
    |SI anynum = 1991; salario = #2#12; dosany = "91/90"; |FINSI;
    |SI anynum = 1992; salario = #2#13; dosany = "92/91"; |FINSI;
    |SI anynum = 1993; salario = #2#14; dosany = "93/92"; |FINSI;
    |SI anynum = 1994; salario = #2#15; dosany = "94/93"; |FINSI;
    |SI anynum = 1995; salario = #2#16; dosany = "95/94"; |FINSI;
    |SI anynum = 1996; salario = #2#17; dosany = "96/95"; |FINSI;
    |SI anynum = 1997; salario = #2#18; dosany = "97/96"; |FINSI;
    |SI anynum = 1998; salario = #2#19; dosany = "98/97"; |FINSI;
    |SI anynum = 1999; salario = #2#20; dosany = "99/98"; |FINSI;
    |SI anynum = 2000; salario = #2#21; dosany = "00/99"; |FINSI;
    |SI anynum = 2001; salario = #2#22; dosany = "01/00"; |FINSI;
|SINO;
    |MENAV "    Salarios minimos interprofesionales SIN DEFINIR ...";
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO salminimo;
    salario = 0;
|DDEFECTO #2;
|ABRE #2;
|LEE 000#2p;
|SI FSalida = 0;
    |SI swany = 1980; salario = #2#1;  |FINSI;
    |SI swany = 1981; salario = #2#2;  |FINSI;
    |SI swany = 1982; salario = #2#3;  |FINSI;
    |SI swany = 1983; salario = #2#4;  |FINSI;
    |SI swany = 1984; salario = #2#5;  |FINSI;
    |SI swany = 1985; salario = #2#6;  |FINSI;
    |SI swany = 1986; salario = #2#7;  |FINSI;
    |SI swany = 1987; salario = #2#8;  |FINSI;
    |SI swany = 1988; salario = #2#9;  |FINSI;
    |SI swany = 1989; salario = #2#10; |FINSI;
    |SI swany = 1990; salario = #2#11; |FINSI;
    |SI swany = 1991; salario = #2#12; |FINSI;
    |SI swany = 1992; salario = #2#13; |FINSI;
    |SI swany = 1993; salario = #2#14; |FINSI;
    |SI swany = 1994; salario = #2#15; |FINSI;
    |SI swany = 1995; salario = #2#16; |FINSI;
    |SI swany = 1996; salario = #2#17; |FINSI;
    |SI swany = 1997; salario = #2#18; |FINSI;
    |SI swany = 1998; salario = #2#19; |FINSI;
    |SI swany = 1999; salario = #2#20; |FINSI;
    |SI swany = 2000; salario = #2#21; |FINSI;
    |SI swany = 2001; salario = #2#22; |FINSI;
|SINO;
    |MENAV "    Salarios minimos interprofesionales SIN DEFINIR ...";
|FINSI;
|CIERRA #2;
|FPRC;

|PROCESO meses;
|SI num  = 1;  cogemes = "ENERO";       |FINSI;
|SI num  = 2;  cogemes = "FEBRERO";     |FINSI;
|SI num  = 3;  cogemes = "MARZO";       |FINSI;
|SI num  = 4;  cogemes = "ABRIL";       |FINSI;
|SI num  = 5;  cogemes = "MAYO";        |FINSI;
|SI num  = 6;  cogemes = "JUNIO";       |FINSI;
|SI num  = 7;  cogemes = "JULIO";       |FINSI;
|SI num  = 8;  cogemes = "AGOSTO";      |FINSI;
|SI num  = 9;  cogemes = "SEPTIEMBRE";  |FINSI;
|SI num  = 10; cogemes = "OCTUBRE";     |FINSI;
|SI num  = 11; cogemes = "NOVIEMBRE";   |FINSI;
|SI num  = 12; cogemes = "DICIEMBRE";   swmes = aa;|FINSI;
|FPRC;

|PROCESO datos_pantalla;
    alfa1 = #0#5;
    jubilames = alfa1 % 402;
    jubilaany = alfa1 % -104;
    anynum = jubilaany;
|HAZ ulti_dia;           || saca el ultimo mes entero cotizado
|SI diajub = topemes;              || ultimo dia del mes de jubilacion;
        mesnum = jubilames;        || mes de jubilacion el mismo
|SINO;
        mesnum = jubilames - 1;    || mes de jubilacion anterior
|FINSI;

|SI mesnum = 0;
        mesnum = 12;
        anynum = anynum - 1;
    |SI anynum < 0;  anynum = 100 + anynum;  |FINSI;
|FINSI;

    aa = 108;
|PARA num = mesnum; |SI num ] 1; |HACIENDO num = num - 1;
    |HAZ meses;
        #1aa = cogemes;
        aa = aa + 1;
|SIGUE;
|PARA num = 12; |SI num ] mesnum; |HACIENDO num = num - 1;
    |SI aa [ 119;
        |HAZ meses;
            #1aa = cogemes;
            aa = aa + 1;
    |FINSI;
|SIGUE;

||********************** Bucle anyos pantalla *************************;

|HAZ busca_salario;
    #1#4 = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#4 = dosany; |FINSI;

                         ||del 5 al 16;
    swmes = swmes - 107;
    mm = 4 + swmes;
    swany = anynum - 1;
|PARA x = 5; |SI x [ 16; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#17 = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#17 = dosany;     |FINSI;

                              ||del 18 al 29;
    mm = 17 + swmes;
    swany = anynum - 1;
|PARA x = 18; |SI x [ 29; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#30  = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#30 = dosany;     |FINSI;

                              ||del 31 al 42;
    mm = 30 + swmes;
    swany = anynum - 1;
|PARA x = 31; |SI x [ 42; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#43  = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#43 = dosany;     |FINSI;

                              ||del 44 al 55;
    mm = 43 + swmes;
    swany = anynum - 1;
|PARA x = 44; |SI x [ 55; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#56  = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#56 = dosany;     |FINSI;

                              ||del 57 al 68;
    mm = 56 + swmes;
    swany = anynum - 1;
|PARA x = 57; |SI x [ 68; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#69  = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#69 = dosany;     |FINSI;

                              ||del 70 al 81;
    mm = 69 + swmes;
    swany = anynum - 1;
|PARA x = 70;|SI x [ 81;|HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#82  = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#82 = dosany;     |FINSI;

                              ||del 83 al 94;
    mm = 82 + swmes;
    swany = anynum - 1;
|PARA x = 83;|SI x [ 94;|HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;

||*****************************************************************;
    anynum = anynum - 1;
|HAZ busca_salario;
    #1#95 = anynum;
|SI #1#108 ! "DICIEMBRE ";    #1#95 = dosany;     |FINSI;

                              ||del 96 al 107;
    mm = 95 + swmes;
    swany = anynum - 1;
|PARA x = 96; |SI x [ 107; |HACIENDO x = x + 1;
    |SI #1#108 ! "DICIEMBRE ";
        |SI x = mm; |HAZ salminimo;     |FINSI;
    |FINSI;
        #1x = salario;   |PINTA #1x;
|SIGUE;
|FPRC;
