|FICHEROS;
     nomw0008 #0;
|FIN;

|VARIABLES;
    nume1 = 0;
    nume2 = 0;
    corta = 0;
    nume3 = 0;
    jg = 0;
    sitio = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    modo = 0;
    &enEmpresa = 0;
    &enModo    = 0;
|FIN;

|PROCESO control3; |TIPO 0;
|SI FSalida = 9;
        alfa1 = #0Campo;
    |QBF alfa1;
        alfa2 = alfa1 % 102; alfa3 = alfa1 % -107;
        alfa4 = alfa3 % 101;
    |SI alfa4 = "0";
            alfa3 = alfa3 % 206;
            alfa1 = alfa2 + alfa3;
    |FINSI;
        nume1 = alfa1;
        nume2 = nume1 / 97;
    |HAZ trunca3;
    |SI nume1 ] 0; |Y nume1 [ 99;
            alfa1 = #0Campo;
        |QBF alfa1;
            alfa2 = nume1;
            alfa2 = "00" + alfa2;
            alfa2 = alfa2 % -102;
            alfa1 = alfa1 + alfa2;
            #0Campo = alfa1;
        |PINTA #0Campo;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO trunca3;
    corta = 0;
    alfa1 = nume2;  alfa2 = alfa1 % 0;  nume3 = alfa2;
|PARA jg = nume3; |SI jg ] 1;|Y corta = 0; |HACIENDO jg = jg - 1;
        sitio = (jg * 100) + 1;
        alfa2 = alfa1 % sitio;
    |SI alfa2 = ".";  corta = jg;  |FINSI;
|SIGUE;
|SI corta ! 0;
        sitio = 100 + corta - 1;
        alfa1 = alfa1 % sitio;
|FINSI;
    nume3 = alfa1;
    nume1 = nume1 - (nume3 * 97);
|FPRC;

|PROCESO antes; |TIPO 7;
     #0#1 = "87";
|FPRC;

|PROCESO chequea; |TIPO 0;
    modo = (FEntrada / 100) ! 0;
|SI modo ! 4;
    |SI #0#1 ! "87"; |Y #0#1 ! "64";
        |MENAV "    Codigo de Contrato no correspondiente ...";
        |ERROR;
    |FINSI;
    |SI modo = 1;|Y #0#13 ! 1;
            alfa1 = "";
            nume1 = #0#13;
            alfa2 = #0#1;
            #0#13 = 1;
        |LEE 001#0=;
        |SI FSalida = 0;|Y #0#1 = alfa2;
                alfa1 = #0#10;
        |FINSI;
            #0#1 = alfa2;
            #0#13 = nume1;
            #0#10 = alfa1;
        |PINDA #0#0;
    |FINSI;
|FINSI;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0  = enEmpresa;
     #0#13 = 01;
     #0#1  = "  ";
|FRUT;

|RUTINA ClaveAlta0;
     #0#0  = enEmpresa;
     #0#13 = 98;
     #0#1  = "zz";
|FRUT;

|PROGRAMA;
     |ENTLINEAL #1#0, -2, enModo, 18, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
