|FICHEROS;
     nomantca #0;
     nomantig;
     nomantil;
|FIN;

|VARIABLES;
     FEstado = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     nValor = 0;
     nModo = 0;
     nCalc = 0;
|FIN;

|PROCESO nonueve; |TIPO 0;
|SI #0Campo = 9;
    |MENAV "    ATENCION! El tipo -9- solo es valido en la escala porcentual ...";
    |ERROR;
        #0Campo = Contenido;
    |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO gra_nomantil;
     #nomantig#0 = #nomantca#0;
     |LEE 000#nomantig.=;
     |SI FSalida ! 0; |O #nomantig#8 ! "A";
          |ACABA;
     |FINSI;

     #nomantil#0 = #nomantca#0;
     #nomantil#1 = #nomantca#1;
     |LEE 101#nomantil.=;
     FEstado = FSalida;
     |PARA nCampo1 = 11; |SI nCampo1 [ 100; |HACIENDO nCampo1 = nCampo1 + 1;
          |SI nCampo1 ] 11; |Y nCampo1 [ 20;           || los a¤os
               nCampo2 = nCampo1 - 7;
               #nomantil#nCampo1# = #nomantca#nCampo2#;
          |FINSI;
          |SI nCampo1 ] 41; |Y nCampo1 [ 50;
               nCampo2 = nCampo1 - 17;
               #nomantil#nCampo1# = #nomantca#nCampo2#;
          |FINSI;
          |SI nCampo1 ] 71; |Y nCampo1 [ 80;
               nCampo2 = nCampo1 - 27;
               #nomantil#nCampo1# = #nomantca#nCampo2#;
          |FINSI;

          |SI nCampo1 ] 31; |Y nCampo1 [ 40;           || los importes
               nCampo2 = nCampo1 - 17;
               |SI #nomantig#8 = "A";
                    nValor = #nomantca#nCampo2#;
                    #nomantil#nCampo1# = nValor;
               |FINSI;
          |FINSI;
          |SI nCampo1 ] 61; |Y nCampo1 [ 70;
               nCampo2 = nCampo1 - 27;
               |SI #nomantig#8 = "A";
                    nValor = #nomantca#nCampo2#;
                    #nomantil#nCampo1# = nValor;
               |FINSI;
          |FINSI;
          |SI nCampo1 ] 91; |Y nCampo1 [ 100;
               nCampo2 = nCampo1 - 37;
               |SI #nomantig#8 = "A";
                    nValor = #nomantca#nCampo2#;
                    #nomantil#nCampo1# = nValor;
               |FINSI;
          |FINSI;
     |SIGUE;
     |SI FEstado = 0;
          |GRABA 020#nomantil.a;
     |SINO;
          |GRABA 020#nomantil.n;
     |FINSI;
|FPRC;

|PROCESO nomantil; |TIPO 2;
     nCalc = 0 +. 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 2; |Y nCalc = 1;
          |ABRE #nomantig;
          |ABRE #nomantil;

          |HAZ gra_nomantil;

          |CIERRA #nomantil;
          |CIERRA #nomantig;
     |FINSI;
|FPRC;
