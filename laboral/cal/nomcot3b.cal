|FICHEROS;
     nomcot3b #0;
     nomcot3c #100;
     labempre;
     labtraba;
     nomcalca;
     nomcot02;
|FIN;

|VARIABLES;
     aAlfa = "";
     nErrores = 0;
     swHayTramos = 0;
|FIN;

|PROCESO imprime;
     |PRINT;
|FPRC;

|DEFBUCLE nomcot3c;
     #nomcot3c#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, imprime;
|FIN;

|PROCESO Informe;
     |SI nErrores ! 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "nomcot3c";
               |BUCLE nomcot3c;
          |FINSI;
          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO Graba;
     #labempre#0 = #nomcalca#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #nomcalca#0;
     #labtraba#1 = #nomcalca#1;
     |LEE 000#labtraba.=;

     |SI #labtraba#42 = "H";
     |O #labtraba#247 = 0163;
     |O #labtraba#247 = 0613;
     |O #labtraba#247 = 0138;
          |ACABA;
     |FINSI;

     #nomcot3c#0 = #labtraba#0;
     #nomcot3c#1 = #labtraba#1;
     #nomcot3c#2 = #labempre#2;
     #nomcot3c#3 = #labtraba#2;
     #nomcot3c#4 = #nomcalca#184;
     #nomcot3c#5 = #nomcalca#2;
     |GRABA 020#nomcot3c.n;
     |LIBERA #nomcot3c;

     nErrores = nErrores + 1;
|FPRC;

|PROCESO nomcot02;
     swHayTramos = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE nomcot02;
     #nomcot02#1;
     ;
     #nomcalca#0, #nomcalca#184, #nomcalca#2, 0, "               ", "            ", 01, #nomcalca#1;
     #nomcalca#0, #nomcalca#184, #nomcalca#2, 0, "zzzzzzzzzzzzzzz", "zzzzzzzzzzzz", 99, #nomcalca#1;
     ;
     NULL, nomcot02;
|FIN;

|PROCESO nomcalca;
     swHayTramos = 0;
     |BUCLE nomcot02;
     |SI swHayTramos = 0;
          |HAZ Graba;
     |FINSI;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     184;
     #0#0, #0#2, #0#5, 0, #0#4;
     #0#1, #0#3, #0#5, 0, #0#4;
     ;
     NULL, nomcalca;
|FIN;

|PROGRAMA;
     |CLS;

     |PINPA #0#0;

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |BORRA 020#0a;
     |FINSI;

     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          aAlfa = Usuario; |QBT aAlfa; aAlfa = "tm_nomcot3c_" + aAlfa;
          |NOME_DAT #nomcot3c#aAlfa#;
          |DELINDEX #nomcot3c;

          |ABRE #labempre;
          |ABRE #labtraba;
          |ABRE #nomcot02;
          |ABRE #nomcot3c;
          |ABRE #nomcalca;

          |BUCLE nomcalca;

          |HAZ Informe;

          |CIERRA #nomcalca;
          |CIERRA #labtraba;
          |CIERRA #labempre;
          |CIERRA #nomcot3c;
          |CIERRA #nomcot02;
          |DELINDEX #nomcot3c;
     |FINSI;

     |GRABA 000#0n;
     |CIERRA #0;
|FPRO;
