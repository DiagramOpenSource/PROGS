|FICHEROS;
     bomb0009 #100;

     bomb0010;      || tipos de personal
     bomb0011;      || convenios
     bomb0012;      || convenios-grupos
     bomb0013;      || situaciones
     bomb0014;      || divisiones
     bomb0015;      || puestos
     bomb0016;      || motivo contratacion

     labtraba;
|FIN;

|VARIABLES;
     &nEmp = 0;
     &nTra = 0;
     &aAnt = "";
     FEstado = 0;
     &nModo = 0;
     alfa1 = "";
     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     nume4 = 0;
     aParam = "";
|FIN;

|PROCESO PintaDef14; |TIPO 14;
     |HAZ PintaAnt;
|FPRC;

|PROCESO PintaDefectos; |TIPO 7;
     |HAZ PintaTip;
     |HAZ PintaCon;
     |HAZ PintaGru;
     |HAZ PintaSit;
     |HAZ PintaPue;
     |HAZ PintaMot;
     |HAZ PintaDiv;
     |HAZ PintaAnt;
|FPRC;

|PROCESO BuscaAnt;
     |SI aParam = "";
          #100#38 = aAnt;
     |SINO;
          #100#38 = #labtraba#34;
     |FINSI;
     alfa1 = #100#8;
     |QBF alfa1;
     |SI alfa1 = "";
          #100#37 = "";
     |FINSI;
|FPRC;

|PROCESO PintaAnt;
     |SI aParam = "";
          #100#38 = aAnt;
          |PINTA #100#38;
     |SINO;
          #100#38 = #labtraba#34;
          |PINTA #100#38;
     |FINSI;
     alfa1 = #100#8;
     |QBF alfa1;
     |SI alfa1 = "";
          #100#37 = "";
          |PINTA #100#37;
     |FINSI;
|FPRC;

|PROCESO PintaMot;  |TIPO 7;
     |ABRE #bomb0016;
     #bomb0016#0 = #100#24;
     |LEE 000#bomb0016.=;
     |SI FSalida = 0;
          #100#36 = #bomb0016#1;
          |PINTA #100#36;
     |FINSI;
     |CIERRA #bomb0016;
|FPRC;

|PROCESO PintaPue;  |TIPO 7;
     |ABRE #bomb0015;
     #bomb0015#0 = #100#6;
     |LEE 000#bomb0015.=;
     |SI FSalida = 0;
          #100#35 = #bomb0015#1;
          |PINTA #100#35;
     |FINSI;
     |CIERRA #bomb0015;
|FPRC;

|PROCESO PintaDiv;  |TIPO 7;
     |ABRE #bomb0014;
     #bomb0014#0 = #100#5;
     |LEE 000#bomb0014.=;
     |SI FSalida = 0;
          #100#34 = #bomb0014#1;
          |PINTA #100#34;
     |FINSI;
     |CIERRA #bomb0014;
|FPRC;

|PROCESO PintaSit;  |TIPO 7;
     |ABRE #bomb0013;
     #bomb0013#0 = #100#3;
     |LEE 000#bomb0013.=;
     |SI FSalida = 0;
          #100#33 = #bomb0013#1;
          |PINTA #100#33;
     |FINSI;
     |CIERRA #bomb0013;
|FPRC;

|PROCESO PintaGru;  |TIPO 7;
     |HAZ PintaCon;
     |ABRE #bomb0012;
     #bomb0012#0 = #100#28;
     #bomb0012#1 = #100#29;
     |LEE 000#bomb0012.=;
     |SI FSalida = 0;
          #100#32 = #bomb0012#2;
          |PINTA #100#32;
     |FINSI;
     |CIERRA #bomb0012;
|FPRC;

|PROCESO PintaCon;  |TIPO 7;
     |ABRE #bomb0011;
     #bomb0011#0 = #100#28;
     |LEE 000#bomb0011.=;
     |SI FSalida = 0;
          #100#31 = #bomb0011#1;
          |PINTA #100#31;
     |FINSI;
     |CIERRA #bomb0011;
|FPRC;

|PROCESO PintaTip;  |TIPO 7;
     |ABRE #bomb0010;
     #bomb0010#0 = #100#2;
     |LEE 000#bomb0010.=;
     |SI FSalida = 0;
          #100#30 = #bomb0010#1;
          |PINTA #100#30;
     |FINSI;
     |CIERRA #bomb0010;
|FPRC;

|PROCESO PintaVto;
     alfa1 = #100#8 % -104;
     nume4 = alfa1;      || a¤o reconocimiento

     || se tendra en cuenta como que la fecha de reconocimiento es la fecha en que
     || el trabajador comenzo en el convenio-grupo que tiene en su ficha
     || hay que tener en cuenta los periodos ya computados en el mismo conv-gru

     |PARA nume1 = 9; |SI nume1 [ 21; |HACIENDO nume1 = nume1 + 3;
          nume2 = nume1 + 1;
          nume3 = nume1 + 2;
          ||SI #100#28 = #100nume1; |Y #100#29 = #100nume2;
               nume4 = nume4 + (#100nume3 * 3);
               ||SAL;
          ||FINSI;
     |SIGUE;

     nume4 = nume4 + 3;
     alfa1 = nume4;
     #100#37 = (#100#8 % 106) + alfa1;
     |PINTA #100#37;
|FPRC;

|PROGRAMA;
     aParam = PARAMETRO;
     |QBF aParam;

     |SI aParam ! "";
          |CLS;
          |PINPA #0#100;
          |PINDA #0#100;
          |CAMPO_MODIFICA #100#0, 1, "S";
          |CAMPO_MODIFICA #100#1, 1, "S";
          |MANTE #100;
     |SINO;
          |CLS;
          |ABRE #100;

          #100#0 = nEmp;
          #100#1 = nTra;

          |LEE 101#100=;
          FEstado = FSalida;
          |SI FSalida = 0;
               |HAZ BuscaAnt;
               |PINPA #0#100;
               |PINDA #0#100;
               |SI nModo = 4;
                    |PAUSA;
               |SINO;
                    |ENDATOS #2#100;
               |FINSI;
          |SINO;
               |HAZ BuscaAnt;
               |PINPA #0#100;
               |PINDA #0#100;
               |SI nModo = 4;
                    |PAUSA;
               |SINO;
                    |ENDATOS #1#100;
               |FINSI;
          |FINSI;
          |SI FSalida = 0;
               |SI FEstado = 0;
                    |GRABA 020#100a;
               |SINO;
                    |GRABA 020#100n;
               |FINSI;
               |LIBERA #100;
          |FINSI;
          |CIERRA #100;
     |FINSI;
|FPRO;
