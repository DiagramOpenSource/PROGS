|FICHEROS;
    nomparli #0;
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;

     nUltima = 0;
     nInforme = 0;
     nPosicion = 0;
     nLinea = 0;
     nCampo = 0;
     nLineaReal = 0;
     nLineaNueva = 0;
|FIN;

|PROCESO rellena; |TIPO 0;
    alfa1 = #0Campo;
|QBT alfa1;
    alfa2 = alfa1 % 101;
|SI alfa2 ! "M";
    |SI alfa2 ! "A";
            nume1 = alfa1;
        |SI nume1 > 39;
            |MENAV "    ATENCION!!! Rango: del 0 al 39 ...";
            |ERROR;
        |SINO;
                alfa1 = "00" + alfa1;
                #0Campo = alfa1 % -102;
                #0Campo = " " + #0Campo;
            |PINTA #0Campo;
        |FINSI;
    |SINO;
            alfa2 = alfa1 % -102;
            nume1 = alfa2;
        |SI nume1 > 37;
            |MENAV "    ATENCION!!! Rango: del A01 al A37 ...";
            |ERROR;
        |FINSI;
    |FINSI;
|SINO;
        alfa2 = alfa1 % -102;
        nume1 = alfa2;
    |SI nume1 ] #0#1;
        |MENAV "    ATENCION!!! Campo sin definir ...";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO AyudaF11; |TIPO 7;
     |PUSHV 07590879;
     |ATRI R;
     |PINTA 0759, "   PULSE F11 PARA    ";
     |PINTA 0859, " CONSULTAR CONCEPTOS ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO cuenta;
     nUltima = #0#1;
|FPRC;

|DEFBUCLE cuenta;
     #nomparli#1;
     ;
     nInforme, 01;
     nInforme, 27;
     ;
     NULL, cuenta;
|FIN;

|PROCESO InsertaLinea; |TIPO 11;
     |SI FSalida ! 13;
          |ACABA;
     |FINSI;

     nPosicion = #0#1;
     nInforme = #0#0;
     |BUCLE cuenta;

     |PARA nLinea = nUltima; |SI nLinea ] nPosicion; |HACIENDO nLinea = nLinea - 1;
          #0#0 = nInforme;
          #0#1 = nLinea;
          |LEE 101#0=;
          |SI FSalida = 0;
               #0#0 = nInforme;
               #0#1 = nLinea + 1;
               |GRABA 020#0n;
               |LIBERA #0;

               |SI nLinea ! nPosicion;
                    #0#0 = nInforme;
                    #0#1 = nLinea;
                    |LEE 101#0=;
                    |SI FSalida = 0;
                         |BORRA 020#0a;
                         |LIBERA #0;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;

     #0#0 = nInforme;
     #0#1 = nPosicion;
     |LEE 101#0=;
     |SI FSalida = 0;
          #0#2 = "";
          |PARA nCampo = 3; |SI nCampo [ 14; |HACIENDO nCampo = nCampo + 1;
               #0nCampo = " 00";
          |SIGUE;
          |PARA nCampo = 15; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 1;
               #0nCampo = "+";
          |SIGUE;
          |GRABA 020#0a;
          |LIBERA #0;
          |LEE 000#0=;
     |FINSI;
     |PONCONTROL 23, "si"; |PTEC 815;
     |ERROR;
|FPRC;
