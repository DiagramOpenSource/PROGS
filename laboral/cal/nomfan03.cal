|FICHEROS;
     nomcopat #0,MANTE;
     nomfan03;
     nomregim;
     nomconst;
|FIN;

|VARIABLES;
     aAlfa = "";
     &nRegimen = 0;
     nCampo = 0;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI FSalida = 0;
          nRegimen = #nomfan03#0;
          |ENTLINEAL #3#0, -1, 2, 22, 1, inf, sup;
     |SINO;
          |ACABA;
     |FINSI;
|FPRC;

|PROCESO PintaReg;
     |ABRE #nomregim;
     #nomregim#0 = #nomfan03#0;
     |LEE 000#nomregim.=;
     |SI FSalida = 0;
          aAlfa = #nomregim#1;
          aAlfa = aAlfa % 124;
          |ATRI R;
          |PINTA 0556, aAlfa;
          |ATRI I;
     |SINO;
          aAlfa = "    Regimen inexistente";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #nomregim;
|FPRC;

|PROCESO inf;
     #0#0 = 500;
     #0#79 = "01.01.2019";
     |SI #nomfan03#0 = 163;
          #0#88 = 613;
     |SINO;
          #0#88 = #nomfan03#0;
     |FINSI;
|FPRC;


|PROCESO sup;
     #0#0 = 999;
     #0#79 = "31.12.2020";
     |SI #nomfan03#0 = 163;
          #0#88 = 613;
     |SINO;
          #0#88 = #nomfan03#0;
     |FINSI;
|FPRC;

|PROCESO copiaconst;
     |PARA nCampo = 0; |SI nCampo [ 93; |HACIENDO nCampo = nCampo + 1;
          #nomcopat#nCampo# = #nomconst#nCampo#;
     |SIGUE;
     #nomcopat#0 = #nomconst#0 + 50;
     #nomcopat#88 = 132;
     |GRABA 020#nomcopat.n;
|FPRC;

|DEFBUCLE copiaconst;
     #nomconst#1;
     88;
     500, "01.01.2007", 111;
     999, "31.12.2999", 111;
     be;
     NULL, copiaconst;
|FIN;

|PROCESO cambia;
     |SI #nomcopat#84 = 4.79;
          #nomcopat#84 = 3.23;
          |GRABA 020#nomcopat.a;
     |FINSI;
|FPRC;

|DEFBUCLE cambia;
     #nomcopat#1;
     ;
     500, "01.01.2019";
     999, "01.01.2919";
     be;
     NULL, cambia;
|FIN;

|PROGRAMA;
     |CLS;

     || mas rapido que un listado, que no me deja meter decimales
     || usalo para lo que te haga falta
     ||BUCLE cambia;

/*
     || bueno esto lo hice cuando hubo que copiar las constantes del regimen
     || 111 al 132 para no tener que picarlas a mano, lo dejo aqui comentado
     || por si hace falta no tener que volver a hacerlo

     |CONFI "    NCopia?";
     |SI FSalida = 0;
          |ABRE #nomcopat;
          |BUCLE copiaconst;
          |CIERRA #nomcopat;
     |FINSI;
*/

     |PINPA #0#nomcopat;
     |PINPA #0#nomfan03;
     |ENDATOS #1#nomfan03;
|FPRO;
