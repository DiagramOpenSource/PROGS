|FICHEROS;
     labcomun #0;
     labempre #1;
     labtraba #2;
     labcentr #3;
     labcontr #10;        || control aplicacion
     pdfimtmp #100;
|FIN;

|VARIABLES;
    alfa0 = "";
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume0 = 0;
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    FEstado = 0;
    men1 = "0000ATENCION !!! Fecha erronea ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    fec = "";
    blanco = "          ";
    puntos = "..........";
    vblanco = "          ";
    vpuntos = "..........";
    sw = 0;
    any = 0;
    tope = 0;
    mod = 0;
    &dia = "";
    &mes = "";
    &anyo = "";
    &coma = ",";
    &letra = "";
    &sinletra = "";
    &domemp = "";
    &domcen = "";
    &provss = "";
    &numess = "";
    &contss = "";
    nombre = 0;
    docume = 0;
    nacimi = 0;
    profes = 0;
    segsoc = 0;
    estudi = 0;
    codest = 0;
    contra = 0;
    sexo = 0;
    fecini = 0;
    fecfin = 0;

    fec1 = "";
    fec2 = 0;
    meslet = "";
    direcc = "";
    numero = "";
    piso = "";
    cod1 = "";
    cod2 = "";
    locali = "";
    compactado = "";
    setenta = "";
    espa = " ";

     &aArchivo = "";
     &aListaFich = "";

     nCodigo = 0;
     nModo = 0;
     swHayAlgo = 0;
     aRegistro = "";
     aFecha1 = "";
     aFecha2 = "";
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aMuni = "";
     aCampo = "";
     aValor = "";
     &nMensajeF5 = 0;
     &aCodigoMunicipio = "";

     nAscii = 0;
     aCaracter = "";
     aCaracterSal = "";
     aCadena = "";
     aCadenaSal = "";
     nPos = 0;
     nBusca = 0;
     nTipo = 0;
     aLongitud = "";
     nLongitud = 0;

     &nContMuni = 0;
     &aCodMuni = "";
     &aCodPos = "";
     nCuantos = 0;

     aCodMuniE = "";
     nNume = 0;

     aCPED1 = "";
     aCPED2 = "";
     aCPED3 = "";
     aCPED4 = "";
     aCPED5 = "";
     codpostem1 = "";
     codpostem2 = "";
     codpostem3 = "";
     codpostem4 = "";
     codpostem5 = "";
     aRegimen = "";
     aRSSD1 = "";
     aRSSD2 = "";
     aRSSD3 = "";
     aRSSD4 = "";
     regimen1 = "";
     regimen2 = "";
     regimen3 = "";
     regimen4 = "";
     aCodCCC = "";
     aProvincia = "";
     aCPRD1 = "";
     aCPRD2 = "";
     aDigControl = "";
     aDC1 = "";
     aDC2 = "";
     aACTD1 = "";
     aACTD2 = "";
     aPaisEmpresa = "";
     aPaisCentro = "";
     aPED1 = "";
     aPED2 = "";
     aPED3 = "";
     aPCD1 = "";
     aPCD2 = "";
     aPCD3 = "";
     codpaisct1 = "";
     codpaisct2 = "";
     codpaisct3 = "";
     municen = "";
     aCodMuniC = "";
     swCuenta = 0;
     nTrabajadores = 0;
     &nTotalHojas = 0;
     &nHoja = 0;
     &aProcedencia = "labllaca";
     &nTipoSalida = 0;
     nLinea = 0;
     nTexto = 0;
     nVoyPorTrab = 0;
     &nContador = 0;
     nTrab = 0;
     aTrab = "";
     nCampo = 0;
     &aTipoID = "";
     &aDocumento = "";
|FIN;

____________________________________/ CALCULOS DESDE PANTALLA
|PROCESO leetraba; |TIPO 0;
|SI #0Campo ! 0;
    |ABRE #2;
        #2#0 = #0#0;
        #2#1 = #0Campo;
    |LEE 001#2=;
    |SI FSalida ! 0;
        |DDEFECTO #2;
            alfa1 = "N";
    |SINO;
            alfa1 = "S";
    |FINSI;
    |CIERRA #2;
        sexo = 6  + Campo;  #0sexo = #2#252;
        |SI #0sexo = "V";
            #0sexo = "H";
        |FINSI;
        fecini = 12 + Campo;  #0fecini = #2#36;
        fecfin = 18 + Campo;  #0fecfin = #2#37;
        |SI #0fecfin = "          "; |O #0fecfin = "..........";
            #0fecfin = #2#177;
        |FINSI;
        nombre = 28 + Campo;  #0nombre = #2#2;
        docume = 34 + Campo;  #0docume = #2#7;
        nacimi = 40 + Campo;  #0nacimi = #2#11;
        profes = 46 + Campo;  #0profes = #2#19;
        segsoc = 52 + Campo;  #0segsoc = #2#75;
        estudi = 58 + Campo;  #0estudi = #2#12;
        codest = 64 + Campo;  #0codest = #2#73;
        contra = 70 + Campo;  #0contra = #2#45;
        nume1 = Campo;
    |PINTA #0nombre;
    |PINTA #0sexo;
    |PINTA #0fecini;
    |PINTA #0fecfin;
        Campo = nume1;
|SINO;
        alfa1 = "N";
|FINSI;
|SI Campo = 1;  |HAZ mod_1;  |FINSI;
|SI Campo = 2;  |HAZ mod_2;  |FINSI;
|SI Campo = 3;  |HAZ mod_3;  |FINSI;
|SI Campo = 4;  |HAZ mod_4;  |FINSI;
|SI Campo = 5;  |HAZ mod_5;  |FINSI;
|SI Campo = 6;  |HAZ mod_6;  |FINSI;
|FPRC;

|PROCESO mod_1;
|CAMPO_MODIFICA #0#07, 1, alfa1;
|CAMPO_MODIFICA #0#13, 1, alfa1;
|CAMPO_MODIFICA #0#19, 1, alfa1;
|FPRC;

|PROCESO mod_2;
|CAMPO_MODIFICA #0#08, 1, alfa1;
|CAMPO_MODIFICA #0#14, 1, alfa1;
|CAMPO_MODIFICA #0#20, 1, alfa1;
|FPRC;

|PROCESO mod_3;
|CAMPO_MODIFICA #0#09, 1, alfa1;
|CAMPO_MODIFICA #0#15, 1, alfa1;
|CAMPO_MODIFICA #0#21, 1, alfa1;
|FPRC;

|PROCESO mod_4;
|CAMPO_MODIFICA #0#10, 1, alfa1;
|CAMPO_MODIFICA #0#16, 1, alfa1;
|CAMPO_MODIFICA #0#22, 1, alfa1;
|FPRC;

|PROCESO mod_5;
|CAMPO_MODIFICA #0#11, 1, alfa1;
|CAMPO_MODIFICA #0#17, 1, alfa1;
|CAMPO_MODIFICA #0#23, 1, alfa1;
|FPRC;

|PROCESO mod_6;
|CAMPO_MODIFICA #0#12, 1, alfa1;
|CAMPO_MODIFICA #0#18, 1, alfa1;
|CAMPO_MODIFICA #0#24, 1, alfa1;
|FPRC;

|PROCESO fechacon; |TIPO 0;      || chequea una fecha alfanumerica de 10 pos.
    fec = #0Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
        dia1 = fec % A102;
        mes1 = fec % A402;
        any1 = fec % A704;
        dia = dia1;
        mes = mes1;
        any = any1;
    |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
        |SI mes [ 12; |Y mes ] 1;
            |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
                    tope = 31;
            |SINO;
                |SI mes = 2;
                         mod = any $ 4;
                    |SI mod = 0;
                            tope = 29;
                    |SINO;
                            tope = 28;
                    |FINSI;
                |SINO;
                        tope = 30;
                |FINSI;
            |FINSI;
            |SI dia [ tope;
                    sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|SINO;
        sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV men1;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO leecontr; |TIPO 7;
|ABRE #10;
|LEE 001#10p;
|SI FSalida ! 0;
    |MENAV "    No existen parametros de control !!! Usando defectos ...";
|SINO;
        || #0#27 = #10#26; |PINTA #0#27;           || nro. de copias
        #0#28 = #10#27; |PINTA #0#28;           || localidad firma
|FINSI;
|CIERRA #10;
|FPRC;
____________________________________/ PROCESO PRINCIPAL
|PROCESO varios1;
    alfa1 = #1#13;
|QBF alfa1;
    alfa0 = alfa1 % 0;
    nume0 = alfa0;
    nume1 = 300 + (nume0 - 4);

    provss = alfa1 %  102;
    numess = alfa1 % nume1;
    contss = alfa1 % -102;
||***************************
    alfa1 = #1#10;
|QBF alfa1;
    alfa2 = alfa1 % 0;
    nume0 = alfa2;
    nume1 = 200 + (nume0 - 1);

    alfa0 = alfa1 % 101;
|SI alfa0 ] "A"; |Y alfa0 [ "z";
        letra = alfa0;
        sinletra = alfa1 % nume1;
|SINO;
        alfa0 = alfa1 % -101;
    |SI alfa0 ] "A"; |Y alfa0 [ "z";
            letra = alfa0;
            nume1 = nume1 * (-1);
            sinletra = alfa1 % nume1;
    |SINO;
            letra = "";
            sinletra = #1#10;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO meseslet;               || SUBRUTINA GENERAL DE TRANSFORMACION
    dia1 = fec1 % 102;           || DE FECHAS A LETRAS
    any1 = fec1 % 704;
    fec1 = fec1 % 402;
    fec2 = fec1;
|SI fec2 = 1;   meslet = "Enero ....";   |FINSI;
|SI fec2 = 2;   meslet = "Febrero ..";   |FINSI;
|SI fec2 = 3;   meslet = "Marzo ....";   |FINSI;
|SI fec2 = 4;   meslet = "Abril ....";   |FINSI;
|SI fec2 = 5;   meslet = "Mayo .....";   |FINSI;
|SI fec2 = 6;   meslet = "Junio ....";   |FINSI;
|SI fec2 = 7;   meslet = "Julio ....";   |FINSI;
|SI fec2 = 8;   meslet = "Agosto ...";   |FINSI;
|SI fec2 = 9;   meslet = "Septiembre";   |FINSI;
|SI fec2 = 10;  meslet = "Octubre ..";   |FINSI;
|SI fec2 = 11;  meslet = "Noviembre ";   |FINSI;
|SI fec2 = 12;  meslet = "Diciembre ";   |FINSI;
|FPRC;

|PROCESO fechafir;              || DESGLOSE DE FECHA DE FIRMA
    fec1 = #0#26;
|SI fec1 ! vpuntos; |Y fec1 ! vblanco;
    |HAZ meseslet;
        dia = dia1;
        mes = meslet;
        anyo = any1;
|FINSI;
|FPRC;

|PROCESO domicili;                    || RUTINA DEL CALCULO actualiz
    direcc = #1#3;                    || PARA CONSTRUCCION DOMICILIOS
    numero = #1#4;
    piso   = #1#5;
    cod1   = #1#7;
    cod2   = #1#8;
    locali = #1#6;
|HAZ compac;
    domemp = compactado;              || domicilio empresa
    direcc = #3#3;
    numero = #3#4;
    piso   = #3#5;
    cod1   = #3#7;
    cod2   = #3#8;
    locali = #3#6;
|HAZ compac;
    domcen = compactado;              || domicilio centro trabajo
|FPRC;

|PROCESO compac;                      || SUBRUTINA DE RUTINA domicili
    setenta = espa * 70;
    compactado = "";                  || DE COMPACTACION DE CAMPOS
|QBF direcc;
|QBF numero;
|QBF piso;
|QBF cod1; cod1 = "00" + cod1;   cod1 = cod1 % -102;
|QBF cod2; cod2 = "000" + cod2;  cod2 = cod2 % -103;
|QBF locali;
    compactado = direcc + coma;
    compactado = compactado + numero;
    compactado = compactado + "  ";
    compactado = compactado + piso;
    compactado = compactado + " (";
    compactado = compactado + cod1;
    compactado = compactado + cod2;
    compactado = compactado + ") ";
    compactado = compactado + locali;
    compactado = compactado + setenta;
    compactado = compactado % 170;
|FPRC;

|PROCESO carga;
|HAZ varios1;
|HAZ fechafir;
|HAZ domicili;
|FPRC;

|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;             || el caracter  
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;             || el caracter ‚
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;             || el caracter ¡
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162; |O nAscii = 243;            || el caracter ¢
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;             || el caracter £
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;             || el caracter ¤
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 241;             || el caracter ¤ (otro codigo ¨?)
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 165;             || el caracter ¥
          aCaracterSal = "\321";
     |FINSI;
     |SI nAscii = 129;
          aCaracterSal = "\374";   || el caracter u con dieresis
     |FINSI;
     |SI nAscii = 154;
          aCaracterSal = "\334";   || el caracter U (mayuscula) con dieresis
     |FINSI;
     |SI nAscii = 167;
          aCaracterSal = "\272";   || el caracter §
     |FINSI;
     |SI nAscii = 166;
          aCaracterSal = "\252";   || el caracter ¦
     |FINSI;
     |SI aCaracter = "(";
          aCaracterSal = "\(";
     |FINSI;
     |SI aCaracter = ")";
          aCaracterSal = "\)";
     |FINSI;
|FPRC;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO GrabaTemporal;
     aAlfa1 = aValor % 101;
     |SI aAlfa1 = ".";
          aValor = "";
     |FINSI;
     |QBF aValor;
     aCadena = aValor;
     |HAZ sustituye;
     aValor = aCadenaSal;
     #pdfimtmp#0 = aCampo;
     #pdfimtmp#1 = aValor;
     #pdfimtmp#2 = nTipo;
     |GRABA 020#pdfimtmp.n;
|FPRC;

|PROCESO pie;
     |HAZ fechafir;              || DESGLOSE DE FECHA DE FIRMA

     aCampo = "oficina empleo";
     aValor = #0#25;
     |HAZ GrabaTemporal;

     aCampo = "localidad";
     aValor = #0#28;
     |HAZ GrabaTemporal;

     aCampo = "dia";
     aValor = dia;
     |HAZ GrabaTemporal;

     aCampo = "mes";
     aValor = mes;
     |HAZ GrabaTemporal;

     aCampo = "anyo";
     aValor = anyo;
     |HAZ GrabaTemporal;
|FPRC;

|PROCESO cabecera;
     |ABRE #labempre;
     #labempre#0 = #0#0;
     |LEE 000#labempre.=;
     |CIERRA #labempre;

     |ABRE #labcentr;
     #labcentr#0 = #0#0;
     #labcentr#1 = #0#77;
     |LEE 000#labcentr.=;
     |CIERRA #labcentr;

     aDocumento = #labempre#10;
     |HAZ TipoID_plb;
     aCampo = "tipoid";
     aValor = aTipoID;
     |HAZ GrabaTemporal;

     aCampo = "cifnif";  || CIF empresa
     aValor = #labempre#10;
     |HAZ GrabaTemporal;

     aCampo = "nomrep";  || nombre representante empresa
     aValor = #labempre#15;
     |HAZ GrabaTemporal;

     aCampo = "dnirep";  || DNI representante
     aValor = #labempre#17;
     |HAZ GrabaTemporal;

     aCampo = "cargorep";  || cargo representante
     aValor = #labempre#18;
     |HAZ GrabaTemporal;

     aCampo = "razonsocial";   || nombre o razon social empresa
     aValor = #labempre#2;
     |HAZ GrabaTemporal;

     |HAZ domicili;
     aCampo = "domemp";   || domicilio social empresa
     aValor = domemp;
     |HAZ GrabaTemporal;

     aCodPos = (("00" + #labempre#7) % -102) + (("000" + #labempre#8) % -103);
     |HAZ CodigoMuni_plb;
     aCodMuniE = aCodMuni;

     aCampo = "muniemp";         ||  municipio empresa
     aValor = #labempre#6;
     |HAZ GrabaTemporal;

     aCampo = "codmuniemp";      || codigo municipio empresa
     aValor = aCodMuniE;
     |HAZ GrabaTemporal;

     aCampo = "codposemp";
     aValor = aCodPos;
     |HAZ GrabaTemporal;

     aCodCCC = #labcentr#10;

     || PROVINCIA CTA. COTIZACION.

     aProvincia = aCodCCC;
     |QBF aProvincia;
     aProvincia = aProvincia % 102;
     aProvincia = "00" + aProvincia;
     aProvincia = aProvincia % -102;
     aCampo = "ss1";
     aValor = aProvincia;
     |HAZ GrabaTemporal;

     || CCC

     aCampo = "ss2";  || CTA. COTIZACION
     aValor = aCodCCC % 307;
     |HAZ GrabaTemporal;

     || DIGITO CONTROL CTA.COTIZACION

     aDigControl = aCodCCC;
     |QBF aDigControl;
     aDigControl = aDigControl % 1002;
     aDigControl = "00" + aDigControl;
     aDigControl = aDigControl % -102;
     aCampo = "ss3";
     aValor = aDigControl;
     |HAZ GrabaTemporal;

     || ACTIVIDAD ECONOMICA


     aAlfa = #labempre#12;
     |QBF aAlfa;
     aAlfa = aAlfa % 102;
     nNume = aAlfa;
     |SI nNume ] 01; |Y nNume [ 99;
          aValor = aAlfa;
          aCampo = "aae"
          |HAZ GrabaTemporal;

          aAlfa = #labempre#12;
          aAlfa = aAlfa % 0753;
          aValor = aAlfa;
          aCampo = "actividad";
          |HAZ GrabaTemporal;
     |SINO;
          aAlfa = #labempre#12;
          aValor = aAlfa;
          aCampo = "actividad";
          |HAZ GrabaTemporal;
     |FINSI;

     || 3) CODIGO MUNICIPIO CENTRO DE TRABAJO
     ||_______________________________________________________________

     |HAZ domicili;
     aCampo = "domcen";   || domicilio social empresa
     aValor = domcen;
     |HAZ GrabaTemporal;

     aCampo = "municen";
     aValor = #labcentr#6;
     |HAZ GrabaTemporal;

     aCodPos = (("00" + #labcentr#7) % -102) + (("000" + #labcentr#8) % -103);
     |HAZ CodigoMuni_plb;
     aCodMuniC = aCodMuni;

     aCampo = "codposcen";
     aValor = aCodPos;
     |HAZ GrabaTemporal;

     aCampo = "codmunicen";      || codigo municipio centro
     aValor = aCodMuniC;
     |HAZ GrabaTemporal;

     aCampo = "provemp";
     aValor = #labempre#9;
     |HAZ GrabaTemporal;

     aCampo = "locemp";
     aValor = #labempre#6;
     |HAZ GrabaTemporal;

     aCampo = "provcen";
     aValor = #labcentr#9;
     |HAZ GrabaTemporal;

     aCampo = "loccen";
     aValor = #labcentr#6;
     |HAZ GrabaTemporal;

     aCampo = "trabemp";
     aValor = #labempre#14;
     |HAZ GrabaTemporal;

     aCampo = "trabcen";
     aValor = #labcentr#11;
     |HAZ GrabaTemporal;
|FPRC;

|PROCESO DatosTrabajador;
          aTrab = nTrab;
          |QBF aTrab;

          #labtraba#0 = #0#0;
          #labtraba#1 = #0nTrab;
          |LEE 000#labtraba.=;

          aCampo = "nombre" + "_" + aTrab;
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;

          aCampo = "sexo" + "_" + aTrab;
          aValor = #labtraba#252;
          |SI aValor = "V";
               aValor = "H";
          |FINSI;
          |HAZ GrabaTemporal;

          aCampo = "dni" + "_" + aTrab;
          aValor = #labtraba#7;
          |HAZ GrabaTemporal;

          aCampo = "fecnac" + "_" + aTrab;
          aValor = #labtraba#11;
          |HAZ GrabaTemporal;

          aCampo = "profesion" + "_" + aTrab;
          aValor = #labtraba#19;
          |HAZ GrabaTemporal;

          aCampo = "nafss" + "_" + aTrab;
          aValor = #labtraba#75;
          |HAZ GrabaTemporal;


          aCampo = "nivel" + "_" + aTrab;

          |SI #labtraba#73 = "11"; aValor = "Est.Prim.Incompletos"; |FINSI;
          |SI #labtraba#73 = "22"; aValor = "1ra.Etapa ESO sin Grad."; |FINSI;
          |SI #labtraba#73 = "23"; aValor = "1ra.Etapa ESO con Grad."; |FINSI;
          |SI #labtraba#73 = "32"; aValor = "Bachillerato"; |FINSI;
          |SI #labtraba#73 = "33"; aValor = "Grado medio F.P."; |FINSI;
          |SI #labtraba#73 = "51"; aValor = "Grado superior F.P."; |FINSI;
          |SI #labtraba#73 = "54"; aValor = "Universitario 1er.ciclo"; |FINSI;
          |SI #labtraba#73 = "55"; aValor = "Universitario 2do.ciclo"; |FINSI;
          |SI #labtraba#73 = "80"; aValor = "Sin estudios"; |FINSI;

          |HAZ GrabaTemporal;

          aCampo = "codnivel" + "_" + aTrab;
          aValor = #labtraba#73;
          |HAZ GrabaTemporal;

          aCampo = "contrato" + "_" + aTrab;
          aValor = #labtraba#45;
          |HAZ GrabaTemporal;

          aCampo = "fecini" + "_" + aTrab;
          nCampo = nTrab + 12;
          aValor = #0nCampo;
          |HAZ GrabaTemporal;

          aCampo = "fecfin" + "_" + aTrab;
          nCampo = nTrab + 18;
          aValor = #0nCampo;
          |HAZ GrabaTemporal;
|FPRC;

|PROCESO trabajadores;
     |ABRE #labtraba;
     |PARA nTrab = 1; |SI nTrab [ 6; |HACIENDO nTrab = nTrab + 1;
          |SI #0nTrab ! 0;
               |HAZ DatosTrabajador;
          |FINSI;
     |SIGUE;
     |CIERRA #labtraba;
|FPRC;

|PROCESO CargaCampos;
     |HAZ cabecera;
     |HAZ trabajadores;
     |HAZ pie;
|FPRC;

|PROCESO comunica; |TIPO 3;
/*
     |IMPRE 0;
     |SI FSalida = 0;
          |PARA para1 = 1; |SI para1 [ #0#27; |HACIENDO para1 = para1 + 1;
               |HAZ carga;
               |INFOR "labcomun";
               |PRINT;
               |PIEINF;
               |FININF;
          |SIGUE;
     |FINSI;
     |FINIMP;
*/

     ||PARA nHoja = 1; |SI nHoja [ nTotalHojas; |HACIENDO nHoja = nHoja + 1;
          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;

          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;         || Contrato Puesta a Disposicion

          |HAZ CargaCampos;

          nCuantos = 1;
          |CIERRA #pdfimtmp;

          |SI #labcontr#74 ] 02;
               #labcontr#74 = 00;
          |FINSI;
          aAlfa = #labcontr#74;
          |QBF aAlfa;
          aAlfa = ("00" + aAlfa) % -102;
          aArchivo = "comcon" + aAlfa + ".pdf";
          |SUB_EJECUTA "pdfgraba";
     ||SIGUE;

     |SUB_EJECUTA "pdfimpre";

|FPRC;
