|FICHEROS;
     labparta #0;
     labempre #1;   || empresas
     labtraba #2;   || trabajadores
     labregis #3;   || registro contratos
     labcentr #4;   || centros
     nomcenes #5;   || centros especiales
     labpadre #6;   || datos auxiliares (nombre padre y madre)
     nomconca #7;   || convenios cabs.
     :/basica/def/agidanif #8;
     nomir003 #9;   || datos IRPF empresa
     nomregim #10;  || descripcion regimenes Seg. Social

     silcon06 #20;  || gestion empresas AGIRED
     silcon13 #21;  || movimientos AFI AGIRED

     nomcalli #30;  || mensual, para los dias de vacaciones 24.11.03
     nomhicli #31;  || historico, para los dias de vacaciones 24.11.03
     nomequiv #101; || tabla equivalencias contratos nuevos
     labcontr;
     nomocupa;
     motibaja;

     nomcalca;
     nomhicca;
     nomtmp06;
|FIN;

|VARIABLES;
     alfa1 = "";
     alfa2 = "";
     alfa3 = "";
     alfa4 = "";
     nume1 = 0;
     nume2 = 0;
     nume3 = 0;
     nume4 = 0;
     para1 = 0;
     para2 = 0;
     para3 = 0;
     para4 = 0;
     fech1 = @;
     fech2 = @;
     fech3 = @;
     fech4 = @;
     elsw1 = 0;
     elsw2 = 0;
     elsw3 = 0;
     elsw4 = 0;
     FEstado = 0;
     seleccio = 0;
     modo = 0;
     sw_rup = 0;

     dia1   = "";
     mes1   = "";
     any1   = "";
     fec    = "";
     sw     = 0;
     dia    = 0;
     mes    = 0;
     any    = 0;
     tope   = 0;
     mod    = 0;

     &nombre = "";
     &apell1 = "";
     &apell2 = "";
     &ctacot = "";
     &codcon = "";
     &dianac = "";
     &mesnac = "";
     &anynac = "";
     &gradom = "";
     &tipodc = "";
     &diapar = "";
     &mespar = "";
     &anypar = "";
     &diasuc = "";
     &messuc = "";
     &anysuc = "";
     &diavac = "";
     &mesvac = "";
     &anyvac = "";

     informe = "";
     impre = "";
     confi_ant = "S";
     red_ultimo = 0;
     red_baja = 0;
     red_esta = 0;
     horas_a = 0;
     horas_c = 0;
     minut_a = 0;
     minut_c = 0;
     aContrato = "";
     grado2 = 0;

     aCoefper = "";
     nPartentera = 0;
     nPartedecimal = 0;
     nDiastrab = 0;
     nDiasIT = 0;
     nDiasVac = 0;
     fFechaFinVac = @;
     nFechaFinVac = 0;
     aFechaFinVac = "";
     aAlfa = "";
     aMesBaja = "";
     aAnyBaja = "";
     nMesBaja = 0;
     nAnyBaja = 0;

     &fFechaAlta = @;
     &aTipoContr = "";
     &nEmpExt = 0;
     &nTraExt = 0;
     &fFechaBaja = @;
     &nTipoVar = 0;
     &nNuevoVal = 0;
     &nNuevoAFI = 0;
     &nAntigVal = 0;
     &aNuevoVal1 = "";
     &nNuevoVal2 = 0;
     &nNuevoVal3 = 0;
     &nNuevoVal4 = 0;
     aParam = "";
     FImpre = 0;
     &aAntigOcu = "";
     &aNuevaOcu = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aTipo = "";
     swAviso = 0;
     nConcepto = 0;
     aTipoVar = "";
     &nCausaBaja = 0;
     &aCausaBaja = "";
     nNume = 0;
     nNume1 = 0;
     nNume2 = 0;

     nDesdeMes = 0;
     nHastaMes = 0;
     nAny = 0;
     aFechaAlta = "";
     aFechaBaja = "";
     nMesAlta = 0;
     nAnyAlta = 0;
     swSigue = 0;
     nFechaAlta = 0;
     nFechaBaja = 0;
     nDiasAlta = 0;

     &contador = 0;
     enCtosMasivos = 0;
     aFichTmp = "";
     nOpcion = 0;
 {-1}aMenu  = "";
     aMenu1 = "2400";
     aMenu2 = "1";
     aMenu3 = "";
     aMenu4 = "RGEC";
     aMenu5 = " Revisar ";
     aMenu6 = " Crear Movim. TA2 RED";
     aMenu7 = " Enviar por ConectaSS";
     aMenu8 = " Cancelar ";

     swMasivo = 0;
     swFechaBaja = 0;
     aOpcionFecha = "";

     &eaNom = "";
     &eaApel1 = "";
     &eaApel2 = "";
     &aCadena = "";
|FIN;
____________________________________/ CALCULOS DESDE CAMPOS
|PROCESO CompTra;
     |ABRE #labtraba
     #labtraba#0 = #0#0;
     #labtraba#1 = #0#1;
     |LEE 000#labtraba.=;
     |SI FSalida = 0; |O #0#1 = 0;
          |SI FSalida = 0;
               |PINTA 0802, #labtraba#2;
          |FINSI;
          |SI #0#1 = 0;
                         ||  1234567890123456789012345678901234567890
               |PINTA 0802, "      - Selecci¢n de trabajadores -     ";
               swMasivo = 1;
          |SINO;
               swMasivo = 0;
          |FINSI;
     |SINO;
          |MENAV "    El trabajador no existe";
          |ERROR;
     |FINSI;
     |CIERRA #labtraba;
|FPRC;

|PROCESO ConsultaTra; |TIPO 66;
     |ABRE #labtraba;
     #labtraba#0 = #0#0;
     #labtraba#1 = #0#1;
     |LEE 000#labtraba.=;
     |CONSULTA_CLAVE #1#labtraba;
     |SI FSalida = 0;
           #0Campo = #labtraba#1;
           |PINTA #0Campo;
     |SINO;
           |ERROR;
     |FINSI;
     |CIERRA #labtraba;
|FPRC;

|PROCESO Pantalla; |TIPO 7;
     |SI aParam = "AUTO";      |ACABA;      |FINSI;
     |SI aParam ! "BAJA";
          #0#22 = 00;
          |CAMPO_VISUAL #0#22, 1, "N";
          |CAMPO_MODIFICA #0#22, 1, "N";
     |FINSI;

     |PINTA 0661, "     ";
     |CAMPO_MODIFICA #0#75, 1, "N";
     |CAMPO_VISUAL #0#75, 1, "N";
     |CAMPO_MODIFICA #0#76, 1, "N";
     |CAMPO_VISUAL #0#76, 1, "N";
     |CAMPO_MODIFICA #0#77, 1, "N";
     |CAMPO_VISUAL #0#77, 1, "N";
     |CAMPO_MODIFICA #0#78, 1, "N";
     |CAMPO_VISUAL #0#78, 1, "N";
     |CAMPO_MODIFICA #0#79, 1, "N";
     |CAMPO_VISUAL #0#79, 1, "N";
     #0#75 = "   ";
     #0#76 = 0;
     #0#77 = 0;
     #0#78 = " ";
     #0#79 = " ";
     |PINTA 0743, "                                     ";
|FPRC;

|PROCESO Ayuda39; |TIPO 7;
     |ATRI R;
     |PUSHV 10021437;
     |BLANCO 10021437;
     ||                    1         2         3
     ||            234567890123456789012345678901234567
     |PINTA 1002, "1.Exclusión social                  ";
     |PINTA 1102, "2.Víctima de la violencia doméstica ";
     |PINTA 1202, "3.Víctima de la violencia de género ";
     |PINTA 1302, "4.Exclusión social-Itin. inserción  ";
     |PINTA 1402, "5.Fracaso inserción-Recaída exc.soc.";
     |ATRI 0;
|FPRC;
/*
|PROCESO AyudaCond; |TIPO 7;
     |ATRI R;
     |PUSHV 09022337;
     |BLANCO 09022337;
     ||                    1         2         3
     ||            234567890123456789012345678901234567
     |PINTA 0902, "1.Desemp. inscrito en Oficina Empleo";
     |PINTA 1002, "2.Idem. durante mas de 12 meses     ";
     |PINTA 1102, "3.Desemp. subsidio Regimen Agrario  ";
     |PINTA 1202, "4.Beneficiario prestacion + de 1 a¤o";
     |PINTA 1302, "5.Desemp. inscrito Ofi. Emp. +6 mes.";
     |PINTA 1402, "6.Benef. Desempleo al que le falta  ";
     |PINTA 1502, "  mas de 1 a¤o por percibir prestac.";
     |PINTA 1602, "7.Benef. Subsidio Desemp. > 52 a¤os ";
     |PINTA 1702, "8.Desemp.excedente Textil al que le ";
     |PINTA 1802, "  falta mas de 1 a¤o de prestacion  ";
     |PINTA 1902, "U.Desemp. +6 meses excedente textil ";
     |PINTA 2002, "T.Desempleado excedente sect. textil";
     |PINTA 2102, "9.No inscrito en Oficina de Empleo  ";
     |PINTA 2202, "A.Beneficiario prestación desempleo ";
     |PINTA 2302, "M.Desempleado contrato CTP<333      ";
     |ATRI 0;
|FPRC;
*/

|PROCESO coeficiente; |TIPO 0;
     |SI #0#7 = "P";
          nume1 = (#0#9 + (#0#64/10)) / #0#10;
          nume1 = nume1 ! 3;
          #0#14 = nume1 * 1000;
          |SI #0#14 > 1000;
               #0#14 = 0;
          |FINSI;
          |PINTA #0#14;
     |FINSI;
|FPRC;

|PROCESO jornada; |TIPO 7;
     |SI #labtraba#42 = "X";|O #labtraba#42 = "T";|O #labtraba#42 = "P";
          #0#7 = "P";
     |SINO;
          #0#7 = "C";
     |FINSI;
|FPRC;

|PROCESO contrato; |TIPO 0;
     |SI #0#7 = "P";
          alfa1 = "S";
     |SINO;
          alfa1 = "N";
          |PDEFECTO #0, 8, 11;
          |PDEFECTO #0, 14, 15;
          |PINTA #0#8;
          |PINTA #0#9;
          |PINTA #0#10;
          |PINTA #0#14;
          |PINTA #0#64;
     |FINSI;
     |C_M #0#8, 1, alfa1;
     |C_M #0#9, 1, alfa1;
     |C_M #0#10, 1, alfa1;
     |C_M #0#14, 1, alfa1;
     |C_M #0#64, 1, alfa1;
|FPRC;

|PROCESO comp_reg;
     |SI #0#1 = 0;
          |ACABA;
     |SINO;
          |ABRE #labtraba;
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;
     |FINSI;

     |SI #2#42 = "A"; |O #2#42 = "B"; |O #2#42 = "E";
          |MENAV "    El modelo TA.2 NO admite trabajadores del Regimen Agrario";
          |POSICIONATE #0#0;
     |FINSI;
|FPRC;

|PROCESO mayus; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO defecto; |TIPO 7;
     |SI #0#8 = " ";|Y #0#7 = "P";
          |HAZ CodigoConvenio;
          #0#8 = "S";    |PINTA #0#8;
          #0#9 = #labtraba#234;     |PINTA #0#9;
          #0#10 = #nomconca#162;    |PINTA #0#10;
     |FINSI;
|FPRC;

|PROCESO aviso;
     |SI #0#2 ! "B"; |ACABA; |FINSI;
     |PUSHV 09011838;
     |CUADRO 09011838;
     |ATRI I;
     ||                    1         2         3
     ||            234567890123456789012345678901234567
     |PINTA 1002, "En casos de finiquito por vacaciones";
     |PINTA 1102, "retribuidas y no disfrutadas se in- ";
     |PINTA 1202, "dicara en este campo la fecha de fin";
     |PINTA 1302, "de vacaciones (para lotes AFI y TA2).";
     |PINTA 1402, "Se recomienda calcular  la nomina de";
     |PINTA 1502, "finiquito si existe, antes de emitir";
     |PINTA 1602, "el lote AFI o el TA2 para la mecani-";
     |PINTA 1702, "       zacion de este campo.        ";
     |ATRI 0;
|FPRC;

|PROCESO restaura;
     |POPV;
|FPRC;

|PROCESO vacaciones; |TIPO 7;
     aAlfa = #0#16;
     aMesBaja = aAlfa % 402;
     aAnyBaja = aAlfa % -104;
     nMesBaja = aMesBaja;
     nAnyBaja = aAnyBaja;
     nAnyBaja = nAnyBaja -2000;

     |PARA nConcepto = 125; |SI nConcepto [ 421; |HACIENDO nConcepto = nConcepto + 296;
          |ABRE #nomcalli;
          #nomcalli#0 = #0#0;           || empresa
          #nomcalli#1 = #0#1;           || trabajador
          #nomcalli#2 = nMesBaja;       || mes
          #nomcalli#3 = 2;              || tipo (= 2, finiquitos)
          #nomcalli#4 = nConcepto;            || concepto (el 125 o el 421)
          |LEE 000#nomcalli.=;
          |SI FSalida = 0;
               |SI #nomcalli#11 > 0; |Y #nomcalli#11 < 1;
                    nDiasVac = 1;
               |SINO;
                    nDiasVac = (#nomcalli#11 + 0.49) ! 0;
               |FINSI;
          |SINO;
               |ABRE #nomhicli;
               #nomhicli#0 = #0#0;           || empresa
               #nomhicli#1 = #0#1;           || trabajador
               #nomhicli#12 = nAnyBaja;      || a¤o
               #nomhicli#2 = nMesBaja;       || mes
               #nomhicli#3 = 2;              || tipo (= 2, finiquitos)
               #nomhicli#4 = nConcepto;            || concepto (el 125 o el 421)
               |LEE 000#nomhicli.=;
               |SI FSalida = 0;
                    |SI #nomhicli#11 > 0; |Y #nomhicli#11 < 1;
                         nDiasVac = 1;
                    |SINO;
                         nDiasVac = (#nomhicli#11 + 0.49) ! 0;
                    |FINSI;
               |FINSI;
               |CIERRA #nomhicli;
          |FINSI;
          |CIERRA #nomcalli;
     |SIGUE;

     |SI nDiasVac > 0;
          fFechaFinVac = #0#16;
          nFechaFinVac = fFechaFinVac;
          nFechaFinVac = nFechaFinVac + nDiasVac;
          fFechaFinVac = nFechaFinVac;
          aFechaFinVac = fFechaFinVac;
          #0#74 = aFechaFinVac;
          |PINTA #0#74;
     |FINSI;
     |HAZ aviso;
|FPRC;

|PROCESO sistema; |TIPO 7;
     |SI #0#1 = 0; |ACABA; |FINSI;
     ||SI FSalida = 0; |Y nTipoVar = 0;
     |SI nTipoVar = 0; |Y aParam ! "BAJA";
          |ABRE #2;
          #2#0 = #0#0;
          #2#1 = #0#1;
          |LEE 020#2=;
          |CIERRA #2;
          fech1 = ~;
          |SI #0#2 = "A"; #0#16 = #2#36; |FINSI;
          |SI #0#2 = "B"; #0#16 = #2#37; |FINSI;
          |SI #0#2 = "V"; #0#16 = fech1; |FINSI;
          |PINTA #0#16;
     |FINSI;
|FPRC;

|PROCESO QueEs;
     |SI aParam = "AUTO";      |ACABA;      |FINSI;
     |ABRE #20;
     |LEE 000#20p;
     |CIERRA #20;

     |CAMPO_MODIFICA #0#74, 1, "N";
     |CAMPO_VISUAL #0#74, 1, "N";
     |PINTA 1060, "                    ³";
     |CAMPO_MODIFICA #0#75, 1, "N";
     |CAMPO_VISUAL #0#75, 1, "N";
     |CAMPO_MODIFICA #0#76, 1, "N";
     |CAMPO_VISUAL #0#76, 1, "N";
     |CAMPO_MODIFICA #0#77, 1, "N";
     |CAMPO_VISUAL #0#77, 1, "N";
     |CAMPO_MODIFICA #0#78, 1, "N";
     |CAMPO_VISUAL #0#78, 1, "N";
     |CAMPO_MODIFICA #0#79, 1, "N";
     |CAMPO_VISUAL #0#79, 1, "N";
     |PINTA 0743, "                                     ";

     |SI #0#2 = "B";
          |CAMPO_VISUAL #0#22, 1, "S";
          |CAMPO_MODIFICA #0#22, 1, "S";

          |CAMPO_MODIFICA #0#74, 1, "S";
          |CAMPO_VISUAL #0#74, 1, "S";
          |PINTA 1060, "Fecha Vac:";
          |PINTA #0#74;

          aAlfa = #labtraba#184;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aAlfa = aAlfa % 102;
               #0#22 = aAlfa;
               |PINTA #0#22;
          |FINSI;
     |FINSI;
     |SI #0#2 = "V"; |O #0#2 = "S";
          |CAMPO_POSICION #0#75, 1, 0662;
          |CAMPO_MODIFICA #0#75, 1, "S";
          |CAMPO_VISUAL #0#75, 1, "S";
          |PINTA #0#75;
     |FINSI;
     |SI #0#2 = "S";
          |CAMPO_MODIFICA #0#81, 1, "S";
          |CAMPO_VISUAL #0#81, 1, "S";
          |PINTA 1060, "Sit.Adic.Afil.:";
          |PINTA #0#81;
     |SINO;
          |CAMPO_MODIFICA #0#81, 1, "N";
          |CAMPO_VISUAL #0#81, 1, "N";
          #0#81 = "";
          |SI #0#2 ! "B";
               |PINTA 1060, "                    ³";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ayuda81; |TIPO 7;
     |PUSHV 13381580
     |ATRI R;
     ||             34         5         6         7
     ||             90123456789012345678901234567890123456789
     |PINTA 1339, " 001 - Vacaciones retribuidas y no disfr.";
     |PINTA 1439, " 002 - Situación cotizaci¢n Ley 01/04    ";
     |PINTA 1539, " 406 - Bonificación Reg. Temporal Empleo ";
     |ATRI 0;
|FPRC;

|PROCESO AyudaVaria; |TIPO 7;
     |SI #0#2 = "V";
          |PUSHV 09372380;
          |ATRI R;
                     || 34         5         6         7         8
                     || 901234567890123456789012345678901234567890
          |PINTA 1039, " Elija tipo de variacion:                ";
          |PINTA 1139, " MG - Cambio de grupo de cotizacion      ";
          |PINTA 1239, " MC - Cambio de contrato                 ";
          |PINTA 1339, " MT - Cambio de ocupacion                ";
          |ATRI 0;
     |FINSI;
     |SI #0#2 = "S";
          |PUSHV 09372380;
          |ATRI R;
                     || 34         5         6         7         8
                     || 901234567890123456789012345678901234567890
          |PINTA 1039, " Elija tipo de acción:                   ";
          |PINTA 1139, " ASA - Anotación sit. adic. cotización   ";
          |PINTA 1239, " MSA - Modificación sit. adic. cotización";
          |PINTA 1339, " ESA - Eliminación sit. adic. cotización ";
          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO TipoVariaS;
     |SI #0#2 = "S";
          aTipoVar = #0#75;
          |QBF aTipoVar;
          |SI aTipoVar ! "ASA"; |Y aTipoVar ! "MSA"; |Y aTipoVar ! "ESA";
               |ERROR;
          |FINSI;
          |PINTA 0743, "                                     ";
          |ATRI I;
          |SI aTipoVar = "ASA";
               |PINTA 0743, "Anotación situación adic. afiliac.   ";
          |FINSI;
          |SI aTipoVar = "MSA";
               |PINTA 0743, "Modificación situación adic. afiliac.";
          |FINSI;
          |SI aTipoVar = "ESA";
               |PINTA 0743, "EliminaciÐn situación adic. afiliac. ";
          |FINSI;
          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO TipoVariaV;
     |SI #0#2 = "V";
          aTipoVar = #0#75;
          |QBF aTipoVar;
          |SI aTipoVar ! "MG"; |Y aTipoVar ! "MC"; |Y aTipoVar ! "MT";
               |ERROR;
          |FINSI;
                     || 4         5         6         7
                     || 3456789012345678901234567890123456789
          |PINTA 0743, "                                     ";
          |SI aTipoVar = "MG";
               |PINTA 0743, "Cambio Gr.Cotiz:     -->";
               |SI aParam ! "AUTO";
                    #0#76 = #labtraba#33;
               |FINSI;
          |FINSI;
          |SI aTipoVar = "MC";
               |PINTA 0743, "Cambio contrato:     -->";
               |SI aParam ! "AUTO";
                    #0#76 = #labtraba#45;
               |FINSI;
          |FINSI;
          |SI aTipoVar = "MT";
               |PINTA 0743, "Cambio ocupacion:    -->";
               |SI aParam ! "AUTO";
                    #0#78 = #labtraba#204;
               |FINSI;
          |FINSI;
          |SI aTipoVar = "MG"; |O aTipoVar = "MC";
               |CAMPO_MODIFICA #0#78, 1, "N";
               |CAMPO_VISUAL #0#78, 1, "N";
               |CAMPO_MODIFICA #0#79, 1, "N";
               |CAMPO_VISUAL #0#79, 1, "N";

               |CAMPO_MODIFICA #0#76, 1, "N";
               |CAMPO_VISUAL #0#76, 1, "S";
               |PINTA #0#76;
               |SI aParam ! "AUTO";
                     |CAMPO_MODIFICA #0#77, 1, "S";
               |FINSI;
               |CAMPO_VISUAL #0#77, 1, "S";
               |PINTA #0#77;
          |FINSI;
          |SI aTipoVar = "MT";
               |CAMPO_MODIFICA #0#76, 1, "N";
               |CAMPO_VISUAL #0#76, 1, "N";
               |CAMPO_MODIFICA #0#77, 1, "N";
               |CAMPO_VISUAL #0#77, 1, "N";

               |CAMPO_MODIFICA #0#78, 1, "N";
               |CAMPO_VISUAL #0#78, 1, "S";
               |SI aParam ! "AUTO";
                     |CAMPO_MODIFICA #0#79, 1, "S";
               |FINSI;
               |CAMPO_VISUAL #0#79, 1, "S";

               |CAMPO_POSICION #0#78, 1, 0760;
               |CAMPO_POSICION #0#79, 1, 0768;

               |PINTA #0#78;
               |PINTA #0#79;
          |FINSI;
     |SINO;
          |PINTA 0743, "                                     ";
          |CAMPO_MODIFICA #0#75, 1, "N";
          |CAMPO_VISUAL #0#75, 1, "N";
          |CAMPO_MODIFICA #0#76, 1, "N";
          |CAMPO_VISUAL #0#76, 1, "N";
     |FINSI;
|FPRC;

|PROCESO MensaVaria; |TIPO 7;
     aTipoVar = #0#75;
     |QBF aTipoVar;
     |SI aTipoVar = "MG";
          |MENSA "    Introduzca nuevo grupo de cotizacion del trabajador";
     |FINSI;
     |SI aTipoVar = "MC";
          |MENSA "    Introduzca nuevo tipo de contrato (para cambio jornada rellene campos izda.)";
     |FINSI;
     |SI aTipoVar = "MT";
          |MENSA "    Introduzca nuevo epigrafe de A.T. del trabajador";
     |FINSI;
|FPRC;

|PROCESO verifech; |TIPO 0;
     fec = #0Campo;
     sw  = 0;

     |SI fec = "          "; |ACABA; |FINSI;
     |SI fec = ".........."; |ACABA; |FINSI;

     dia1 = fec % 102;
     mes1 = fec % 402;
     any1 = fec % 704;

     dia  = dia1;
     mes  = mes1;
     any  = any1;

     |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
          |SI mes [ 12; |Y mes ] 1;
              |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
                   tope = 31;
              |SINO;
                   |SI mes = 2;
                        mod = any $ 4;
                        |SI mod = 0; tope = 29; |SINO; tope = 28; |FINSI;
                   |SINO;
                        tope = 30;
                   |FINSI;
              |FINSI;
              |SI dia [ tope; sw = 1; |FINSI;
          |FINSI;
     |FINSI;

     |SI sw = 0;
          |MENAV "0000ATENCION !!! Fecha erronea ...";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO no_grupo; |TIPO 7;
     |SI #0#2 = "V";
          |CAMPO_MODIFICA #0#23, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#23, 1, "N";
     |FINSI;
|FPRC;

|PROCESO si_grupo; |TIPO 0;
     |SI #0#1 = 0; |ACABA; |FINSI;
     |SI aParam = "AUTO";      |ACABA;      |FINSI;
     |SI #0#2 = "V";|Y FSalida = 0;
          |ABRE #2;
          #2#0 = #0#0;
          #2#1 = #0#1;
          |LEE 121#2=;
          |SI FSalida = 0;|Y #2#33 ! #0#23;
               #2#33 = #0#23;           || actualiza el grupo de tarifa
               |GRABA 020#2a;
          |FINSI;
          |LIBERA #2;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO si_cambio;
     |SI #0#2 = "V";|Y FSalida = 0;
          |ABRE #2;
          #2#0 = #0#0;
          #2#1 = #0#1;
          |LEE 121#2=;
          |SI FSalida = 0;
               aTipoVar = #0#75;
               |QBF aTipoVar;
               |SI aTipoVar = "MG";
                    #labtraba#33 = #0#77;
               |FINSI;
               |SI aTipoVar = "MC";
                    |SI #0#77 ! 0;
                         #labtraba#45 = #0#77;
                    |SINO;
                         |MENAV "    ATENCION: No se ha indicado nuevo tipo de contrato";
                    |FINSI;
               |FINSI;
               |SI aTipoVar = "MT"; |Y #0#79 ! "c";
                    #labtraba#204 = #0#79;
                    #labtraba#205 = #nomocupa#1;
               |FINSI;
          |FINSI;
          |GRABA 020#2a;
          |LIBERA #2;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO Coefi;
     #0#19 = "    "; |PINTA #0#19;
     #0#84 = "  "; |PINTA #0#84;

     |SI #0#1 = 0; |ACABA; |FINSI;

     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = #0#1;
     |LEE 000#2=;
     |CIERRA #2;

     |SI #2#42 = "C";    #0#19 = "1.33";     |PINTA #0#19;  |FINSI;
     |SI #2#42 = "F";    #0#19 = "1.61";     |PINTA #0#19;  |FINSI;

     |SI #2#42 = "C"; |O #2#42 = "F";
          |SI #0#2 = "A";
               #0#84 = "32";
               |PINTA #0#84;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO nomcalca;
     nDiasIT = nDiasIT + #nomcalca#31 + #nomcalca#32 + #nomcalca#33;
     nDiasIT = nDiasIT + #nomcalca#34 + #nomcalca#65;
     nDiasAlta = nDiasAlta + #nomcalca#8;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #0#0, #0#1, nHastaMes, 0;
     #0#0, #0#1, nHastaMes, 0;
     ;
     NULL, nomcalca;
|FIN;

|PROCESO nomhicca;
     nDiasIT = nDiasIT + #nomhicca#31 + #nomhicca#32 + #nomhicca#33;
     nDiasIT = nDiasIT + #nomhicca#34 + #nomhicca#65;
     nDiasAlta = nDiasAlta + #nomhicca#8;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#1, nAny, nDesdeMes, 0;
     #0#0, #0#1, nAny, nHastaMes, 0;
     ;
     NULL, nomhicca;
|FIN;

|PROCESO BuscaDias;
     aFechaAlta = fFechaAlta;
     aFechaBaja = fFechaBaja;

     aAlfa = aFechaAlta % 402;
     nMesAlta = aAlfa;
     aAlfa = aFechaAlta % -102;
     nAnyAlta = aAlfa;

     aAlfa = aFechaBaja % 402;
     nMesBaja = aAlfa;
     aAlfa = aFechaBaja % -102;
     nAnyBaja = aAlfa;

     nDiasIT = 0;
     nDiasAlta = 0;

     |SI nAnyAlta = nAnyBaja;
          nDesdeMes = nMesAlta;
          nHastaMes = nMesBaja;
          nAny = nAnyAlta;
          |BUCLE nomhicca;

          nDesdeMes = nMesBaja;
          nHastaMes = nMesBaja;
          |BUCLE nomcalca;
     |SINO;
          nDesdeMes = nMesAlta;
          nHastaMes = 12;
          nAny = nAnyAlta;
          |BUCLE nomhicca;

          nDesdeMes = 1;
          nHastaMes = nMesBaja;
          nAny = nAnyBaja;
          |BUCLE nomhicca;

          nDesdeMes = nMesBaja;
          nHastaMes = nMesBaja;
          |BUCLE nomcalca;
     |FINSI;
|FPRC;

|PROCESO DiasCitricos;
     swSigue = 0;
     |SI #labtraba#42 = "C"; |O #labtraba#42 = "F";
          |SI #0#2 = "B";
               swSigue = 1;
          |FINSI;
     |FINSI;
     |SI swSigue = 1;
          fFechaAlta = #labtraba#36;
          fFechaBaja = #labparta#16;
          nFechaAlta = fFechaAlta;
          nFechaBaja = fFechaBaja;
          || nDiasAlta = nFechaBaja - nFechaAlta + 1
          || no, los dias en alta lo que piden son las JORNADAS

          |HAZ BuscaDias;

          #0#18 = nDiasAlta;
          #0#26 = nDiasIT;
          |PINTA #0#18;
          |PINTA #0#26;
     |FINSI;
|FPRC;

|PROCESO regimen; |TIPO 7;
     |ABRE #10;
     #10#0 = #2#247;
     |LEE 020#10=;
     |CIERRA #10;
     #0#17 = #10#1
     |PINTA #0#17;
|FPRC;

|PROCESO casilla10; |TIPO 0;
     nume1 = #0#21;
     nume2 = #0#19;
     nume3 = (nume1 / nume2) ! 0;
     |SI nume3 ! 0;
          #0#18 = nume3;
          |PINTA #0#18;
     |FINSI;
|FPRC;

|PROCESO inactiv3; |TIPO 7;
     |SI #0#2 = "B";
          #0#3 = "X";
          |CAMPO_MODIFICA #0#3, 1, "S";
     |SINO;
          #0#3 = " ";
          |CAMPO_MODIFICA #0#3, 1, "N";
     |FINSI;
     |PINTA #0#3;
|FPRC;

|PROCESO inactiv4; |TIPO 7;
     |SI #0#2 = "A";
          |CAMPO_MODIFICA #0#4, 1, "S";
     |SINO;
          #0#4 = " ";
          |CAMPO_MODIFICA #0#4, 1, "N";
     |FINSI;
     |PINTA #0#4;
|FPRC;

|PROCESO Comp80;
     aAlfa = #0#80;
     |SI aAlfa ! "  "; |Y aAlfa ! "01"; |Y aAlfa ! "02";
          |ERROR;
     |FINSI;
|FPRC;

____________________________________/ CALCULOS DE LECTURA E IMPRESION
|PROCESO DesglosaSucesiva;
     fech1 = #0#52;
     nume1 = fech1;
     |SI nume1 > 0;
          diasuc = #0#52 % 102;
          messuc = #0#52 % 402;
          anysuc = #0#52 % -104;
     |SINO;
          diasuc = "";
          messuc = "";
          anysuc = "";
     |FINSI;
|FPRC;


|PROCESO DesglosaVacaciones;
     fech1 = #0#74;
     nume1 = fech1;
     |SI nume1 > 0;
          diavac = #0#74 % 102;
          mesvac = #0#74 % 402;
          anyvac = #0#74 % -104;
     |SINO;
          diavac = "";
          mesvac = "";
          anyvac = "";
     |FINSI;
|FPRC;

|PROCESO DesglosaFecha;
     fech1 = #0#16;
     nume1 = fech1;
     |SI nume1 > 0;
          diapar = #0#16 % 102;
          mespar = #0#16 % 402;
          anypar = #0#16 % -104;
     |SINO;
          diapar = "";
          mespar = "";
          anypar = "";
     |FINSI;
|FPRC;

|PROCESO TipoDocumento;
     alfa1 = #2#7 % 101;

     tipodc = "";
     |SI alfa1 = "X"; |O alfa1 = "Y"; |O alfa1 = "Z";        || extranjero
          tipodc = "E";
     |FINSI;
     |SI alfa1 ] "A";|Y alfa1 [ "z";
     |Y alfa1 ! "X"; |Y alfa1 ! "Y"; |Y alfa1 ! "Z";        || pasaporte
          tipodc = "P";
     |FINSI;
     |SI alfa1 ] "0";|Y alfa1 [ "9";                        || espa¤ol
          tipodc = "D";
     |FINSI;
|FPRC;

|PROCESO GradoMinusvalia;
     gradom = "";
     grado2 = 0;

     fech1 = ~;     alfa1 = fech1; alfa1 = alfa1 % -104;    || ejercicio

     |ABRE #8;
     #8#0 = #labtraba#7;         || nif
     || #8#1 = alfa1;              || ejercicio
     #8#1 = 1;               || TIPO FAMILIAR
     |LEE 000#8=;
     |SI FSalida = 0;
         |SI #8#17 ] 33;
             gradom = "33-65"; grado2 = 33;
         |FINSI;
         |SI #8#17 ] 65;
             gradom = ">65  "; grado2 = 66;
         |FINSI;
     |FINSI;
     |CIERRA #8;

     |ABRE #nomir003;
     #nomir003#0 = #labtraba#7;         || nif
     #nomir003#40 = alfa1;              || ejercicio
     #nomir003#41 = #labtraba#0;        || empresa
     |LEE 000#nomir003.=;
     |SI FSalida = 0;
          gradom = "";
          |SI #nomir003#6 = "S";
               |SI #nomir003#7 = "1";   gradom = "33-65"; grado2 = 33; |FINSI;
               |SI #nomir003#7 = "2";   gradom = ">65  "; grado2 = 66; |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #nomir003;
|FPRC;

|PROCESO FechaNacimiento;
     fech1 = #labtraba#11;
     nume1 = fech1;
     |SI nume1 > 0;
          dianac = #labtraba#11 % 102;
          mesnac = #labtraba#11 % 402;
          anynac = #labtraba#11 % -104;
     |SINO;
          dianac = "";
          mesnac = "";
          anynac = "";
     |FINSI;
|FPRC;

|PROCESO ActualizaBaja;
     |SI #0#1 = 0; |ACABA; |FINSI;

     |SI #0#2 = "B";
          |SI swMasivo = 0;
               swFechaBaja = 0;
          |FINSI;
          |SI swFechaBaja = 0;
               |SI swMasivo = 0;
                    alfa1 = "    " + confi_ant + "Actualizar fecha de baja en el Trabajador y en el Registro (S/N): ";
               |SINO;
                    alfa1 = "    NActualizar fecha de baja en los Trabajadores y en el Registro (S/N): ";
               |FINSI;
               |CONFI alfa1;
               |SI FSalida = 0;
                    swFechaBaja = 1;    || actualizar la fecha: SI
               |SINO;
                    swFechaBaja = 2;    || actualizar la fecha: NO
               |FINSI;
               confi_ant = "S";
          |FINSI;
          |SI swFechaBaja = 1;
               |ABRE #2;
               #2#0 = #0#0;
               #2#1 = #0#1;
               |LEE 121#2=;
               |SI FSalida = 0;
                    #2#37 = #0#16;   || fecha baja
                    |GRABA 020#2a;
               |FINSI;
               |LIBERA #2;
               |CIERRA #2;

               |ABRE #3;
               |SELECT #2#3;
               #3#1 = #0#0;
               #3#2 = #0#1;
               |LEE 101#3=;
               |SI FSalida = 0;
                    |SI #3#15 = 0;
                         #3#8 = #0#16;           || fin contrato
                         |SI #0#16 ! "..........";|Y #0#16 ! "          ";
                              #3#24 = #0#16;
                         |FINSI;
                    |SINO;
                         #3#20 = #0#16;          || fin prorroga
                         |SI #0#16 ! "..........";|Y #0#16 ! "          ";
                              #3#26 = #0#16;
                         |FINSI;
                    |FINSI;
                    |GRABA 020#3a;
               |FINSI;
               |LIBERA #3;
               |CIERRA #3;
          |SINO;
               confi_ant = "N";
          |FINSI;

          |ABRE #labcontr;
          |LEE 000#labcontr.p;
          |SI FSalida ! 0;
               |DDEFECTO #labcontr;
          |FINSI;
          |SI #labcontr#58 = 1;
               |ABRE #2;
               #2#0 = #0#0;
               #2#1 = #0#1;
               |LEE 121#2=;
               |SI FSalida = 0;
                    aAlfa = #0#22; aAlfa = "00" + aAlfa; aAlfa = aAlfa % -102;
                    #2#184 = aAlfa + " - " + #0#5;
                    |GRABA 020#2a;
               |FINSI;
               |LIBERA #2;
               |CIERRA #2;
          |FINSI;
          |CIERRA #labcontr;
     |FINSI;
|FPRC;

|PROCESO CodigoConvenio;
     |DDEFECTO #nomconca;
     |ABRE #nomconca;
     #nomconca#0 = #labtraba#87;
     |LEE 000#nomconca.=;
     |CIERRA #nomconca;

     codcon = #nomconca#142;
|FPRC;

|PROCESO Permanencias;
     |SI #2#42 = "C"; |O #2#42 = "F";
          |SI #0#2 = "A"
               aCoefper = #0#19;
               aCoefper = aCoefper % -102;
               |SI aCoefper ! "  ";
                    nPartentera = 1;
                    nPartedecimal = aCoefper;
               |FINSI;
          |FINSI;

          |SI #0#2 = "B";
               nDiastrab = #0#18;
               nDiasIT = #0#26;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CuentaCotizacion;
     |SI #2#45 = "087";|O #2#45 = "097";|O #2#45 = "085"; |O #2#45 = "421";
                       |O #2#45 = "064";|O #2#45 = "065";
          ctacot = #5#10;
     |SINO;
          ctacot = #4#10;
     |FINSI;
|FPRC;

|PROCESO CentroEspecial;
     |DDEFECTO #5;
     |ABRE #5;
     #5#0  = #2#0;   || empresa
     #5#13 = #2#77;  || centro
     |SI #2#45 = "097";|O #2#45 = "085"; |O #2#45 = "421";
          #5#1 = "87";
     |SINO;
          |SI #2#45 = "065";
               #5#1  = "64";
          |SINO;
               #5#1  = #2#45 % 2;
          |FINSI;
     |FINSI;
     |LEE 000#5=;
     |SI FSalida ! 0;
          |SI #2#45 = "087";|O #2#45 = "097";|O #2#45 = "085";|O #2#45 = "421";
                            |O #2#45 = "064";|O #2#45 = "065";
               |MENAV "    AVISO! Centro Especial de trabajo INEXISTENTE ...";
          |FINSI;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO Centro;
     |DDEFECTO #4;
     |ABRE #4;
     #4#0 = #2#0;
     #4#1 = #2#77;
     |LEE 000#4=;
     |SI FSalida ! 0;|Y #2#45 ! "064";|Y #2#45 ! "065";
                     |Y #2#45 ! "087";|Y #2#45 ! "097";|Y #2#45 ! "085";|Y #2#45 ! "421";
          |MENAV "    AVISO! Centro de trabajo INEXISTENTE ...";
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO CodigosNuevos;
     |QBF aContrato;
     aContrato = ("000" + aContrato) % -103;
     |ABRE #nomequiv;
     #nomequiv#0 = aContrato;
     |LEE 000#nomequiv.=;
     |SI FSalida = 0;
          |SI #labtraba#42 = "X";|O #labtraba#42 = "T";|O #labtraba#42 = "P";
               aContrato = #nomequiv#2;      || tiempo parcial
          |SINO;
               aContrato = #nomequiv#1;      || tiempo completo
          |FINSI;
     |FINSI;
     |CIERRA #nomequiv;
|FPRC;

|PROCESO Trabajador;
     |DDEFECTO #2;
     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = #0#1;
     |LEE 020#2=;
     |CIERRA #2;

     #0#34 = #2#45;
     |SI #2#45 = "Z1 ";  #0#34 = "181";  |FINSI;
     |SI #2#45 = "Z2 ";  #0#34 = "182";  |FINSI;
     |SI #2#45 = "Z3 ";  #0#34 = "183";  |FINSI;
     |SI #2#45 = "Z4 ";  #0#34 = "184";  |FINSI;
     |SI #2#45 = "Z5 ";  #0#34 = "185";  |FINSI;
     aContrato = #0#34;
     |HAZ CodigosNuevos;
     #0#34 = aContrato;
|FPRC;

|PROCESO Empresa;
     |DDEFECTO #1;
     |ABRE #1;
     #1#0 = #0#0;
     |LEE 020#1=;
     |CIERRA #1;
|FPRC;

|PROCESO Desempleo;
     |SI #0#35 = "1";
          #0#35 = "X";
     |FINSI;
     |SI #0#35 = "2";
          #0#36 = "X";
     |FINSI;
     |SI #0#35 = "3";
          #0#36 = "X";
     |FINSI;
|FPRC;

|PROCESO RevDesempleo;
     |SI #0#35 = "X";
          #0#35 = "1";
     |FINSI;
|FPRC;

|PROCESO imprime;
     |HAZ Empresa;
     |HAZ Trabajador;
     |HAZ Centro;
     |HAZ CentroEspecial;

     aCadena = #labtraba#2;
     |HAZ SeparaNom_plb;
     apell1 = eaApel1;
     apell2 = eaApel2;
     nombre = eaNom;

     |HAZ CuentaCotizacion;
     |HAZ CodigoConvenio;
     |HAZ ActualizaBaja;
     |HAZ FechaNacimiento;
     |HAZ GradoMinusvalia;
     |HAZ TipoDocumento;
     |HAZ DesglosaFecha;
     |HAZ DesglosaSucesiva;
     |HAZ DesglosaVacaciones;
     |HAZ Permanencias;
     |HAZ Desempleo;

     |SI FImpre = 0; |Y swMasivo = 0;
          |SI #0#20 = 1; informe = "labparta";    |FINSI;
          |SI #0#20 = 2; informe = "labpartz";    |FINSI;
          |SI #0#20 = 3; informe = "labpart1";    |FINSI;
          |INFOR informe;
          |SI FSalida = 0;
               |PRINT;
               |PIEINF;
          |SINO;
               alfa1 = "0000Informe [" + informe + "] inaccesible.";
               |MENAV alfa1;
          |FINSI;
          |FININF;
     |FINSI;

     |HAZ RevDesempleo;

     |SI #0#24 = "S"; |O swMasivo = 1;
          |HAZ el_red;
     |FINSI;
|FPRC;

|PROCESO ElProceso;
     |HAZ si_cambio;

     |SI elsw1 ! 0;
           |PTEC 802;
     |SINO;
           elsw1 = 1;
     |FINSI;
     Impresora = impre;
     |IMPRE 0;
     FImpre = FSalida;
     |SI FSalida = 0;
          impre = Impresora;
     |FINSI;

     |HAZ imprime;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |CAMPO_MODIFICA #0#22, 1, "N";      || lo pongo aqui porque no puedo
     |CAMPO_VISUAL #0#22, 1, "N";        || dejarlo a "NO" desde el DEF
                                        || ya que el campo esta relacionado

     aParam = PARAMETRO;
     |QBF aParam;
     |CLS;
     |CABEZA "Partes TA-2/S";
     |DDEFECTO #0;
     impre = "ibm80";
     |SI aParam = "AUTO";
          #0#0 = nEmpExt;
          #0#1 = nTraExt;
          #0#2 = "V";
          |SI nTipoVar = 1;
               #0#75 = "MC ";
               #0#5 = "08 - Cambio de Contrato";
               |SI nNuevoVal4 ! 0;
                    #0#7 = "P";
                    #0#8 = aNuevoVal1;
                    #0#9 = nNuevoVal2;
                    #0#10 = nNuevoVal3
                    #0#14 = nNuevoVal4;
               |FINSI;
               #0#76 = nAntigVal;
               #0#77 = nNuevoVal;
          |FINSI;
          |SI nTipoVar = 2;        || cambio de grupo de cotizacion
               #0#75 = "MG ";
               #0#5 = "09 - Cambio de Grupo de Cotizacion";
               #0#76 = nAntigVal;
               #0#77 = nNuevoVal;
          |FINSI;
          |SI nTipoVar = 3;        || cambio de epigrafe
               #0#75 = "MT ";
               #0#5 = "10 - Cambio de ocupacion";
               #0#78 = aAntigOcu;
               #0#79 = aNuevaOcu;
          |FINSI;

          |ABRE #labtraba;         || para leer el trabajador
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;

          #0#16 = #2#36;
          |PINPA #0#0;

          |CAMPO_MODIFICA #0#0, 1, "N";
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_MODIFICA #0#2, 1, "N";
          |CAMPO_MODIFICA #0#20, 1, "N";
          |CAMPO_MODIFICA #0#22, 1, "N";
          |CAMPO_MODIFICA #0#24, 1, "N";
          |CAMPO_MODIFICA #0#75, 1, "N";
          |CAMPO_MODIFICA #0#76, 1, "N";
          |CAMPO_MODIFICA #0#77, 1, "N";
          |CAMPO_MODIFICA #0#78, 1, "N";
          |CAMPO_MODIFICA #0#79, 1, "N";

          |CAMPO_POSICION #0#75, 1, 0662;
          |CAMPO_VISUAL #0#75, 1, "S";
          |CAMPO_VISUAL #0#76, 1, "S";
          |CAMPO_VISUAL #0#77, 1, "S";
          |PINTA #0#75;
          |PINTA #0#76;
          |PINTA #0#77;
          |PINTA #0#78;
          |PINTA #0#79;

          |PINDA #0#0;

          |ENDATOS #1#0;
          |SI FSalida = 0;
               |HAZ ElProceso;
          |FINSI;
     |FINSI;
     |SI aParam = "ALTA";
          #0#0 = nEmpExt;
          #0#1 = nTraExt;
          #0#2 = "A";
          #0#24 = "S";
          #0#16 = fFechaAlta;
          #0#7  = aTipoContr;

          |ABRE #labtraba;         || para leer el trabajador
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;

          #0#16 = #2#36;
          |PINPA #0#0;

          |CAMPO_MODIFICA #0#0, 1, "N";
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_MODIFICA #0#2, 1, "N";
          |CAMPO_MODIFICA #0#20, 1, "N";
          |CAMPO_MODIFICA #0#22, 1, "N";
          |CAMPO_MODIFICA #0#24, 1, "N";
          |CAMPO_MODIFICA #0#75, 1, "N";
          |CAMPO_MODIFICA #0#76, 1, "N";
          |CAMPO_MODIFICA #0#77, 1, "N";
          |CAMPO_MODIFICA #0#78, 1, "N";
          |CAMPO_MODIFICA #0#79, 1, "N";

          |CAMPO_POSICION #0#75, 1, 0662;
          |CAMPO_VISUAL #0#75, 1, "S";
          |CAMPO_VISUAL #0#76, 1, "S";
          |CAMPO_VISUAL #0#77, 1, "S";
          |PINTA #0#75;
          |PINTA #0#76;
          |PINTA #0#77;
          |PINTA #0#78;
          |PINTA #0#79;

          |PINDA #0#0;

          |ENDATOS #1#0;
          |SI FSalida = 0;
               |HAZ ElProceso;
          |FINSI;
     |FINSI;
     |SI aParam = "BAJA";
          #0#0 = nEmpExt;
          #0#1 = nTraExt;
          #0#2 = "B";
          #0#24 = "S";
          #0#16 = fFechaBaja;
          #0#7  = aTipoContr;
          #0#22 = nCausaBaja;
          #0#5 = aCausaBaja;
          #0#3 = "X";

          |ABRE #labtraba;         || para leer el trabajador
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;

          |PINPA #0#0;

          |CAMPO_MODIFICA #0#0, 1, "N";
          |CAMPO_MODIFICA #0#1, 1, "N";
          |CAMPO_MODIFICA #0#2, 1, "N";
          |CAMPO_MODIFICA #0#20, 1, "N";
          |CAMPO_MODIFICA #0#22, 1, "N";
          |CAMPO_MODIFICA #0#24, 1, "N";
          |CAMPO_MODIFICA #0#75, 1, "N";
          |CAMPO_MODIFICA #0#76, 1, "N";
          |CAMPO_MODIFICA #0#77, 1, "N";
          |CAMPO_MODIFICA #0#78, 1, "N";
          |CAMPO_MODIFICA #0#79, 1, "N";
          |CAMPO_MODIFICA #0#7, 1, "N";

          |PINDA #0#0;

          |ENDATOS #1#0;
          |SI FSalida = 0;
               |HAZ ElProceso;
          |FINSI;
     |FINSI;
     |SI PARAMETRO = "";
          |PARA; |SI; |HACIENDO;
               |PINPA #0#0;
               |PINDA #0#0;
               |ENDATOS #1#0;
               enCtosMasivos = 0;
               |SI FSalida = 0;
                    |SI #0#1 = 0;
                         |HAZ TA2_Masivo;
                    |SINO;
                         |HAZ ElProceso;
                    |FINSI;
               |SINO;
                    |SAL;
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRO;
____________________________________/ ACTUALIZACION DE R.E.D.
|PROCESO HuelgaParcial;
     |SI #0#65 = "3";
          |CAMPO_MODIFICA #0#66, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#66, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ayuda59; |TIPO 7;
     |ABRE #20;
     |LEE 000#20p;
     |SI FSalida = 0;
          |PUSHV 08032244;
          |BLANCO 08 03 22 44;
          |CUADRO 08 03 22 44;
          |ATRI R;
          ||            0     1         2         3         4
          ||            4567890123456789012345678901234567890123
          |PINTA 0904, " -- RELACIONES LABORALES ESPECIALES --- ";
          |PINTA 1004, "                                        ";
          |PINTA 1104, " 0100 Personal Alta Direccion           ";
          |PINTA 1204, " 0300 Penados en inst. penitenciarias   ";
          |PINTA 1304, " 0304 Penados en inst. penit. -menores- ";
          |PINTA 1404, " 0401 Jugadores de futbol               ";
          |PINTA 1504, " 0402 Jugadores de baloncesto           ";
          |PINTA 1604, " 0403 Jugadores de balonmano            ";
          |PINTA 1704, " 0404 Ciclistas                         ";
          |PINTA 1804, " 0600 Minusvalidos en Centros Especiales";
          |PINTA 1904, " 0800 Artistas en espectac. publicos    ";
          |PINTA 2004, " 0900 Abogados en despachos de abogados ";
          |PINTA 2104, " 9909 Personal investigador en formacion";
          |ATRI 0;
     |FINSI;
     |CIERRA #20;
|FPRC;

|PROCESO chequea59; |TIPO 0;
     |SI #0Campo = "    ";
          |POPV;
          |ACABA;
     |FINSI;
/*
     |SI #0Campo ! "0100"; |Y #0Campo ! "0300"; |Y #0Campo ! "0304";
     |Y  #0Campo ! "0401"; |Y #0Campo ! "0402"; |Y #0Campo ! "0403";
     |Y  #0Campo ! "0404"; |Y #0Campo ! "0600"; |Y #0Campo ! "0700";
     |Y  #0Campo ! "0800"; |Y #0Campo ! "0900"; |Y #0Campo ! "9909";
          |MENAV "0000Codigo de relacion especial incorrecto";
          |ERROR;
     |SINO;
          |POPV;
     |FINSI;
*/
|FPRC;

|PROCESO ayuda60; |TIPO 7;
     |ABRE #20;
     |LEE 000#20p;
     |SI FSalida = 0;
          |PUSHV 07351676;
          |CUADRO 07 35 16 76;
          |ATRI R;
          ||            3   4         5         6         7
          ||            6789012345678901234567890123456789012345
          |PINTA 0836, " ----- CAUSAS DE SUSTITUCION ---------- ";
          |PINTA 0936, " 1 Por excedencia por cuidado familiares";
          |PINTA 1036, " 2 Por descanso por maternidad          ";
          |PINTA 1136, " 3 Jubilado anticipadamente a los 64    ";
          |PINTA 1236, " 4 Minusv lido                          ";
          |PINTA 1336, " 5 Sustituci¢n minusv lido en IT        ";
          |PINTA 1436, " 6 V¡ctimas violencia de g‚nero         ";
          |PINTA 1536, " 7 Cobertura vacante disminuci¢n e. fijo";
          |ATRI 0;
     |FINSI;
     |CIERRA #20;
|FPRC;

|PROCESO TextoBaja;
     aAlfa1 = #labtraba#184;
     |QBF aAlfa1;
     aAlfa1 = aAlfa1 % 102;
     nNume1 = aAlfa1;              || motivo baja Trabajador

     aAlfa2 = #0#22; |QBF aAlfa2;
     aAlfa2 = ("00" + aAlfa2) % -102;
     nNume2 = aAlfa2;               || motivo baja TA2

     |SI nNume1 = nNume2;
          aAlfa = #labtraba#184;
          aAlfa = aAlfa - aAlfa1;
          aAlfa = aAlfa - "-";
          |QBF aAlfa;
          |SI aAlfa ! "";
               |PARA; |SI; |HACIENDO;
                    aAlfa1 = aAlfa % 101;
                    |SI aAlfa1 = " ";
                         aAlfa = aAlfa - " ";
                    |SINO;
                         |SAL;
                    |FINSI;
               |SIGUE;
          |FINSI;
          #0#5 = aAlfa;
          |PINTA #0#5;
     |FINSI;
|FPRC;

|PROCESO Chequea22; |TIPO 0;
     |SI #0#2 ! "B";
          |ACABA;
     |FINSI;

     |SI #0Campo = 8; |O #0Campo = 9; |O #0Campo = 10;
     |O #0Campo = 11; |O #0Campo = 12;
          aAlfa = "    Los códigos  08, 09, 10, 11 y 12 son internos en la aplicación. ";
          aAlfa = aAlfa + "No son válidos para el Sistema RED";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;

     |ABRE #motibaja;
     #motibaja#0 = #0Campo;
     |LEE 000#motibaja.=;
     |SI FSalida ! 0;
          aAlfa = "    ATENCION. Es obligatorio informar una causa de baja. ";
          aAlfa = aAlfa + "Pulse F11 para consultar las opciones.";
          |AVISO;
          |MENAV aAlfa;
          |ERROR;
     |SINO;
          #0#5 = #motibaja#1;
          |PINTA #0#5;
     |FINSI;
     |CIERRA #motibaja;
|FPRC;

|PROCESO chequea60; |TIPO 0;
     |SI #0Campo = 0;    |ACABA;   |FINSI;
     |SI #0Campo = 8;
          aAlfa = "    El 08 es un codigo interno para indicar el cambio de contrato. ";
          aAlfa = aAlfa + "No es valido para el Sistema RED";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;

     |SI #0Campo ! 1;|Y #0Campo ! 2;|Y #0Campo ! 3;|Y #0Campo ! 4;|Y #0Campo ! 5;
     |Y  #0Campo ! 6;|Y #0Campo ! 7;
          |MENAV "0000Codigo de causa de sustitucion incorrecto";
     |FINSI;
|FPRC;

|PROCESO chequea70;
     |SI #0#70 = "X"; |Y #0#71 = "X";
          #0#71 = " ";
          |PINTA #0#71;
     |FINSI;
|FPRC;

|PROCESO chequea71;
     |SI #0#70 = "X"; |Y #0#71 = "X";
          #0#70 = " ";
          |PINTA #0#70;
     |FINSI;
|FPRC;

|PROCESO chequeaExt; |TIPO 7;
     alfa1 = #labtraba#7 % 101;
     |SI alfa1 = "X"; |Y #0#2 ! "B";
          |CAMPO_MODIFICA #0#72, 1, "S";
     |SINO;
          #0#72 = "   ";
          |PINTA #0#72;
          |CAMPO_MODIFICA #0#72, 1, "N";
     |FINSI;
     |SI #0#2 = "B";                    || esto para cuando cambie de pantalla
          |PINTA 1060, "Fecha Vac:";    || que no se borre si ha de estar
     |FINSI;
|FPRC;

|PROCESO chequeaExt2; |TIPO 0;
     |SI alfa1 = "X"; |Y #0#2 ! "B";
          alfa2 = #0#72;
          |QBF alfa2;
          |SI alfa2 = "";
               alfa3 = "    Trabajador extranjero. Es necesario indicar";
               alfa3 = alfa3 + " el tipo de autorizacion";
               |MENAV alfa3;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO chequeaVig; |TIPO 7;
     alfa1 = #labtraba#7 % 101;
     |SI alfa1 = "X"; |Y #0#2 ! "B";
          |CAMPO_MODIFICA #0#73, 1, "S";
     |SINO;
          #0#73 = "          ";
          |PINTA #0#73;
          |CAMPO_MODIFICA #0#73, 1, "N";
     |FINSI;
|FPRC;

|PROCESO fin_ayuda; |TIPO 0;
     red_baja = #0#22;
     |SI #0#22 = 98; red_baja = 99; |FINSI;
/*
     |SI #0#2 = "B";
          |POPV;
          |SI #0#22 = 1; red_baja = 51; |FINSI;
          |SI #0#22 = 2; red_baja = 54; |FINSI;
          |SI #0#22 = 3; red_baja = 56; |FINSI;
          |SI #0#22 = 4; red_baja = 58; |FINSI;
          |SI #0#22 = 5; red_baja = 61; |FINSI;
          |SI #0#22 = 6; red_baja = 63; |FINSI;
          |SI #0#22 = 7; red_baja = 64; |FINSI;
          |SI #0#22 = 8; red_baja = 65; |FINSI;
          |SI #0#22 = 9; red_baja = 99; |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO agired; |TIPO 7;
     |ABRE #20;
     |LEE 000#20p;
     |SI FSalida = 0;
          alfa1 = "S";
     |SINO;
          alfa1 = "N";
     |FINSI;
     |CIERRA #20;
     |C_M #0Campo, 1, alfa1;
|FPRC;

|PROCESO los_minutos;
     horas_a = #0#9  - ( ( (#0#9  * 100) $ 100) / 100);
     horas_c = #0#10 - ( ( (#0#10 * 100) $ 100) / 100);

     horas_a = horas_a ! 0;    || si no se redondean no pasan bien al fichero
     horas_c = horas_c ! 0;    || ejemplo (horas=1.66)

     minut_a = (#0#9 * 100) $ 100;
     minut_a = ((minut_a * 60) / 100) ! 0;

     minut_c = (#0#10 * 100) $ 100;
     minut_c = ((minut_c * 60) / 100) ! 0;
|FPRC;

|PROCESO borralo1;
     aAlfa1 = #21#0; aAlfa1 = "00000" + aAlfa1; aAlfa1 = aAlfa1 % -105;
     aAlfa2 = #0#16;

     swAviso = 0;
     |SI #0#2 = "A"; |Y #21#3 = "MA ";
          aTipo = "movimiento de alta";
          swAviso = 1;
     |FINSI;
     |SI #0#2 = "B"; |Y #21#3 = "MB ";
          aTipo = "movimiento de baja";
          swAviso = 1;
     |FINSI;
     |SI #0#2 = "V";
          alfa4 = #21#3;
          |QBF alfa4;
          |SI alfa4 = #0#75;
               |SI #21#3 = "MC "; aTipo = "cambio de contrato"; |FINSI;
               |SI #21#3 = "MG "; aTipo = "cambio de grup.cot."; |FINSI;
               |SI #21#3 = "MT "; aTipo = "cambio de ocupación"; |FINSI;
               swAviso = 1;
          |FINSI;
     |FINSI;
     |SI swAviso = 1;
          aAlfa = "    ATENCION. Existe un " + aTipo + " pendiente de envío ";
          aAlfa = aAlfa + " para este trabajador: " + aAlfa1 + " - " + aAlfa2;
          |MENAV aAlfa;
          aAlfa = "    S¿Desea sustituir el movimiento anterior por este?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |BORRA 020#21a;
               |LIBERA #21;
               aAlfa = "    Eliminado movimiento de alta " + aAlfa1 + ".";
               |MENAV aAlfa;
          |SINO;
               |MENAV "    Se creará un nuevo movimiento pendiente."
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE borralo;
     #21#2;
     14;
     #2#0, #2#1, 0;
     #2#0, #2#1, 0;
     be;
     NULL, borralo1;
|FIN;

|PROCESO el_red;
     |ABRE #20;
     #20#0 = #2#0;
     |LEE 000#20=;
     |SI FSalida = 0;

          |DDEFECTO #labpadre;
          |ABRE #labpadre;
          #labpadre#0 = #labtraba#0;
          #labpadre#1 = #labtraba#1;
          |LEE 000#labpadre.=;
          |CIERRA #labpadre;

          nNuevoAFI = 0;

          |ABRE #21;
          |LEE 000#21u;
          |SI FSalida ! 0;
               red_ultimo = 1;
          |SINO;
               red_ultimo = #21#0 + 1;
          |FINSI;
          |CIERRA #21;

          |BUCLE borralo;

          |ABRE #21;
          |DDEFECTO #21;
          #21#0 = red_ultimo;
          |GRABA 020#21b;

          #21#1 = #2#0;         || empresa
          #21#2 = #2#1;         || trabajador
          |SI #0#2 = "A"; #21#3 = "MA"; #21#4 = "01";     |FINSI; || accion/situac.
          |SI #0#2 = "B"; #21#3 = "MB"; #21#4 = red_baja; |FINSI;
          |SI #0#2 = "V"; |O #0#2 = "S"; #21#3 = #0#75; #21#4 = "00";     |FINSI;
          |SI #2#45 ] "014";|Y #2#45 [ "017";   #21#5 = #2#45; |FINSI;
          #21#6 = #0#8;         || calif. per. horas
          |HAZ los_minutos;
          #21#7 = horas_a;      || nro. horas contrato (A)
          #21#8 = horas_c;      || nro. horas empresa/convenio (B)

          #21#5 = #0#52;           || fecha inicio contrato
          |SI #0#31 = "X";
               #21#9 = "S";        || FIC especifico
          |SINO;
               alfa1 = #0#52; |QBF alfa1;
               |SI alfa1 ! "";
                    #21#9 = "N";
               |SINO;
                    #21#9 = " ";
               |FINSI;
          |FINSI;

          #21#10 = #0#30;       || colectivo

          |SI #0#14 ] 1000;
               #21#12 = 0;
          |SINO;
               #21#12 = #0#14;
          |FINSI;
          #21#13 = #0#16;     || fecha incidencia
          #21#14 = 0;         || nro. de lote
          #21#15 = minut_a;   || nro. minutos contrato (A)
          #21#16 = minut_c;   || nro. minutos empresa/convenio (B)
          || #21#17 = #labpadre#2;    || nombre padre
          || #21#18 = #labpadre#3;    || nombre madre
          #21#17 = #labtraba#249;    || nombre padre
          #21#18 = #labtraba#250;    || nombre madre
          #21#19 = #labtraba#244;  || telefono

                           || desempleado: no inscrito
/*
          |SI #0#35 = " ";
               #21#20 = "0";
          |SINO;
               #21#20 = #0#35;
          |FINSI;  || desempleado:
*/
          #21#20 = #0#35;

          #21#21 = "N";
          |SI #0#38 ! " "; #21#21 = "S"; |FINSI;  || mujer subrepresentada
          #21#22 = "N";
          |SI #0#41 ! " "; #21#22 = "S"; |FINSI;  || incapac.readmitido
          #21#23 = "N";
          |SI #0#40 ! " "; #21#23 = "S"; |FINSI;  || 1er.trabaj.autonomo
          #21#24 = grado2;                        || grado minusvalia
          #21#25 = " ";
          |SI #0#39 ! " "; #21#25 = #0#39; |FINSI;  || excl.soc./violen.domest.
          #21#27 = #0#59;                         || cod.relacion especial
          #21#28 = #0#43;                         || NAFSS sustituido
          #21#29 = #0#60;                         || cod.causa sustitucion
          #21#30 = "N";
          |SI #0#61 ! " "; #21#30 = "S"; |FINSI;   || renta activa insercion
          #21#31 = "N";
          |SI #0#62 ! " "; #21#31 = "S"; |FINSI;   || trab.contrat.24meses parto
          #21#32 = #0#63;                          || coef.reductor edad jubil.

          #21#33 = nPartentera;        || parte entera coeficiente (sit.esp. reg 0132)
          #21#34 = nPartedecimal;      || parte decimal coeficiente (sit.esp. reg 0132)
          #21#35 = nDiastrab;          || dias de trabajo (sit.esp. reg 0132)
          #21#36 = nDiasIT;            || dias en IT (sit.esp. reg 0132)

          #21#38 = 0;         || exclusion desempleo solo agrarios
          |SI #0#65 ! " ";    || Inactividad
               #21#37 = #0#65;
          |SINO;
               #21#37 = " ";
          |FINSI;

          |SI #0#65 = "3";      || Coef. Huelga Parcial en caso de
               #21#43 = #0#66;  || Tipo Inactividad = 3
          |FINSI;

          #21#44 = #0#67;          || relevo (DAM)
          #21#45 = #0#68;          || fecha desde (DAM)
          #21#46 = #0#69;          || fecha hasta (DAM)

          #21#47 = " ";
          |SI #0#70 = "X";
               #21#47 = "S";
          |FINSI;
          |SI #0#71 = "X";
               #21#47 = "2";
          |FINSI;

          alfa1 = #0#72;           || Tipo Autorizacion trabajo extranjeros
          |QBF alfa1;
          |SI alfa1 ! "";
               #21#48 = alfa1;
          |FINSI;
          alfa1 = #0#73;           || Vigencia Autorizacion trabajo extranjeros
          |QBF alfa1;
          |SI alfa1 ! "";
               alfa1 = alfa1 - ".";
               alfa1 = alfa1 - ".";
               #21#49 = alfa1;
          |FINSI;
          alfa1 = #0#74;           || Fecha fin vacaciones
          |QBF alfa1;
          |SI alfa1 ! "";
               #21#50 = (alfa1 % -104) + (alfa1 % 402) + (alfa1 % 102);
          |FINSI;
          |SI #0#2 = "A"; |Y #labtraba#204 ! " ";
               #0#79 = #labtraba#204;
          |FINSI;
          #21#52 = #0#79;
          #21#53 = #0#80;
          #21#55 = #0#81;
          #21#57 = #0#82;
          #21#58 = #0#83;
          |SI #0#2 ! "B";
               #21#65 = #0#84;
          |FINSI;
          |GRABA 020#21a;
          |SI FSalida = 0;
               nNuevoAFI = red_ultimo;
          |FINSI;
          |LIBERA #21;
          |CIERRA #21;
     |FINSI;
     |CIERRA #20;
|FPRC;


/****************************************************************************/
/*************************       TA2 MASIVO       ***************************/
/****************************************************************************/
/*
|PROCESO labtraba_parta;
     |SI #labtraba#247 = 0163; |O #labtraba#247 = 0613;
          |ACABA;
     |FINSI;
     |SI #0#84 = "32";
          |SI #labtraba#42 = "C"; |O #labtraba#42 = "F";
               || adelante
          |SINO;
               |ACABA;
          |FINSI;
     |FINSI;

     #nomtmp06#0 = #labtraba#0;
     #nomtmp06#1 = #labtraba#1;
     #nomtmp06#2 = #labtraba#2;
     #nomtmp06#4 = " ";
     |GRABA 020#nomtmp06.n;
     |LIBERA #nomtmp06;
|FPRC;
*/

|PROCESO labtraba_parta;
     |SI #labtraba#247 = 0163; |O #labtraba#247 = 0613;
          |ACABA;
     |FINSI;
     #nomtmp06#0 = #labtraba#0;
     #nomtmp06#1 = #labtraba#1;
     #nomtmp06#2 = #labtraba#2;
     #nomtmp06#4 = "*";
     |SI #labparta#2 = "A";
          |SI aOpcionFecha = "1";
               #nomtmp06#6 = #labtraba#36;
          |SINO;
               #nomtmp06#6 = #labparta#16;
          |FINSI;
     |FINSI;
     |SI #labparta#2 = "B";
          |SI aOpcionFecha = "1";
               #nomtmp06#6 = #labtraba#37;
          |SINO;
               #nomtmp06#6 = #labparta#16;
          |FINSI;
     |FINSI;
     #nomtmp06#7 = #labparta#22;
     #nomtmp06#8 = 00;
     #nomtmp06#9 = "";
     |GRABA 020#nomtmp06.n;
     |LIBERA #nomtmp06;
|FPRC;

|DEFBUCLE labtraba_parta;
     #labtraba#1;
     44;
     #0#0, 00001, "A";
     #0#0, 99999, "A";
     ;
     NULL, labtraba_parta;
|FIN;

|PROCESO Bajatmp6;
   #nomtmp06#0 = 00000;
   #nomtmp06#1 = 00000;
|FPRC;

|PROCESO Altatmp6;
   #nomtmp06#0 = 99999;
   #nomtmp06#1 = 99999;
|FPRC;

|PROCESO MasivoCitricos;
     |SI #0#2 = "A"
          |SI #2#42 = "C";
               #0#19 = "1.33";
          |FINSI;
          |SI #2#42 = "F";
               #0#19 = "1.61";
          |FINSI;
     |FINSI;
     |SI #0#2 = "B";
          |HAZ DiasCitricos;
     |FINSI;
|FPRC;

|PROCESO nomtmp06;
     |SI #nomtmp06#4 ! "*";
         |BORRA 020#nomtmp06.a;
         |LIBERA #nomtmp06;

         |ACABA;
     |FINSI;

     |ABRE #labtraba;
     #labtraba#0 = #nomtmp06#0;
     #labtraba#1 = #nomtmp06#1;
     |LEE 000#labtraba.=;
     |CIERRA #labtraba;

     #0#0 = #labtraba#0;
     #0#1 = #labtraba#1;

     |SALVA_DATOS #labparta;

     |HAZ MasivoCitricos;

     |HAZ imprime;

     |REPON_DATOS #labparta;

     #nomtmp06#5 = contador;
     |GRABA 020#nomtmp06.a;
     |LIBERA #nomtmp06;

     |PULSATECLA;

     contador = contador + 1;
|FPRC;

|DEFBUCLE nomtmp06;
     #nomtmp06#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, nomtmp06;
|FIN;

|PROCESO TA2_Masivo;
     contador = 0;
     enCtosMasivos = 1;

     aFichTmp = "nomtmp06" + Usuario;  |NOME_DAT #nomtmp06#aFichTmp#;
     |ABRE #nomtmp06;  |CIERRA #nomtmp06;  |DELINDEX #nomtmp06;

     |PUSHV 11152170;
     |PINTA 1130, "                     ";
     |ATRI R;
               ||  3         4         5         6
               ||  0123456789012345678901234567890123
     |PINTA 1230, " Obtener la fecha de ";
     |SI #labparta#2 = "A";
          |PINTA 1330, "       alta de:      ";
     |FINSI;
     |SI #labparta#2 = "B";
          |PINTA 1330, "       baja de:      ";
     |FINSI;
     |ATRI 0;
     |PINTA 1430, " Obtener la fecha de ";
     |PINTA 1430, " (1) Trabajador      ";
     aAlfa = #labparta#16;
     aAlfa = " (2) TA2(" + aAlfa + ") ";
     |PINTA 1530, aAlfa;

     |PINTA 1630, "                     ";
     |PINTA 1730, "      Opci¢n:        ";
     |ATRI R;
     |PINTA 1431, "(1)";
     |PINTA 1531, "(2)";
     |ATRI 0;
     |CUADRO 11301850;

     E_sup = 1;
     E_inf = "";
     aAlfa = "1";
     aAlfa = 1745 ? 1;
     |QBF aAlfa;
     aOpcionFecha = aAlfa;
     |POPV;

     |ABRE #nomtmp06;
     |BUCLE labtraba_parta;
     |CIERRA #nomtmp06;

     |C_V #nomtmp06#3, 1, "N";
     |C_V #nomtmp06#5, 1, "N";

     |SI #labparta#2 = "A";
          |CAMPO_VISUAL #nomtmp06#6, 1, "S";
          |CAMPO_VISUAL #nomtmp06#7, 1, "N";
          |CAMPO_VISUAL #nomtmp06#8, 1, "N";
          |CAMPO_VISUAL #nomtmp06#9, 1, "N";
          |CAMPO_VISUAL #nomtmp06#10, 1, "S";

          |CAMPO_MODIFICA #nomtmp06#6, 1, "S";
          |CAMPO_MODIFICA #nomtmp06#7, 1, "N";
          |CAMPO_MODIFICA #nomtmp06#8, 1, "N";
          |CAMPO_MODIFICA #nomtmp06#9, 1, "N";
          |CAMPO_MODIFICA #nomtmp06#10, 1, "S";
     |FINSI;
     |SI #labparta#2 = "B";
          |CAMPO_VISUAL #nomtmp06#6, 1, "S";
          |CAMPO_VISUAL #nomtmp06#7, 1, "S";
          |CAMPO_VISUAL #nomtmp06#8, 1, "S";
          |CAMPO_VISUAL #nomtmp06#9, 1, "S";
          |CAMPO_VISUAL #nomtmp06#10, 1, "N";

          |CAMPO_MODIFICA #nomtmp06#6, 1, "S";
          |CAMPO_MODIFICA #nomtmp06#7, 1, "S";
          |CAMPO_MODIFICA #nomtmp06#8, 1, "S";
          |CAMPO_MODIFICA #nomtmp06#9, 1, "S";
          |CAMPO_MODIFICA #nomtmp06#10, 1, "N";
     |FINSI;

     |PUSHV 0501 2380;

     |PINPA #0#nomtmp06;
     |SI #labparta#2 = "A";
          |PINTA 0760, "                ³";
          |ATRI R;
          |PINTA 0761, "COE";
          |ATRI 0;
     |FINSI;
     |SI #labparta#2 = "B";
          |PINTA 0760, "                ³";
          |ATRI R;
          |PINTA 0760, "CA";
          |PINTA 0763, "VA";
          |PINTA 0766, "FECHA VAC.";
          |ATRI 0;
     |FINSI;

     ||aAlfa = " " * 80;
     ||PINTA 0501, aAlfa;
     ||PINTA 0601, aAlfa;
     ||PINTA 0863, "      ";

     |PARA;  |SI;  |HACIENDO;
          |ENTLINEAL #1#nomtmp06, -2, 2, 21, 0, Bajatmp6, Altatmp6;

          |MENU aMenu;
          nOpcion = FSalida;
          |SI nOpcion = 2;  |SAL;  |FINSI;
          |SI nOpcion = 3;  |SAL;  |FINSI;
          |SI nOpcion = 4;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |SI nOpcion = 2;
          |BUCLE nomtmp06;
     |FINSI;

     |SI nOpcion = 3;
          |HAZ BajaOnline;
     |FINSI;

     |C_V #nomtmp06#5, 1, "S";

     |DELINDEX #nomtmp06;

     aAlfa = contador;
     |QBF aAlfa;
     |SI contador = 0;
          |SI nOpcion = 2;
               |MENAV "    No se han generado movimientos para el AFI de alta";
          |SINO;
               |SI nOpcion = 3;
                    |MENAV "    No se han generado movimientos para ConectaSS";
               |SINO;
                    |MENAV "    No se han generado movimientos";
               |FINSI;
          |FINSI;
     |SINO;
          |SI nOpcion = 2;
               aAlfa = contador; |QBF aAlfa;
               aAlfa = "    Se han generado " + aAlfa + " movimientos AFI de ";
               |SI #0#2 = "A";
                    aAlfa = aAlfa + "alta";
               |FINSI;
               |SI #0#2 = "B";
                    aAlfa = aAlfa + "baja";
               |FINSI;
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;


/*
|PROCESO TA2_Masivo;
     contador = 0;
     enCtosMasivos = 1;

     aFichTmp = "nomtmp06" + Usuario;  |NOME_DAT #nomtmp06#aFichTmp#;
     |ABRE #nomtmp06;  |CIERRA #nomtmp06;  |DELINDEX #nomtmp06;

     |ABRE #nomtmp06;
     |BUCLE labtraba_parta;
     |CIERRA #nomtmp06;

     |C_V #nomtmp06#3, 1, "N";
     |C_V #nomtmp06#5, 1, "N";

     |PUSHV 0501 2380;

     |PINPA #0#nomtmp06;
     aAlfa = " " * 80;
     |PINTA 0501, aAlfa;
     |PINTA 0601, aAlfa;
     |PINTA 0863, "      ";
     |ATRI R;
     |PINTA 0869, "MARCA";
     |ATRI 0;

     |PARA;  |SI;  |HACIENDO;
          |ENTLINEAL #1#nomtmp06, -2, 4, 21, 0, Bajatmp6, Altatmp6;

          |MENU aMenu;
          nOpcion = FSalida;
          |SI nOpcion = 2;  |SAL;  |FINSI;
          |SI nOpcion = 3;  |SAL;  |FINSI;
     |SIGUE;
     |POPV;

     |SI nOpcion = 2;
         |BUCLE nomtmp06;
     |FINSI;

     |C_V #nomtmp06#4, 1, "N";
     |C_V #nomtmp06#5, 1, "S";

     |DELINDEX #nomtmp06;

     aAlfa = contador;
     |QBF aAlfa;
     |SI contador = 0;
          |MENAV "    No se han generado movimientos AFI de alta";
     |SINO;
          aAlfa = "    Se han generado " + aAlfa + " movimientos AFI ";
          aAlfa = aAlfa + "pendientes de ";

          |SI #0#2 = "A"; aAlfa = aAlfa + "alta"; |FINSI;
          |SI #0#2 = "B"; aAlfa = aAlfa + "baja"; |FINSI;
          |SI #0#2 = "V"; aAlfa = aAlfa + "variación"; |FINSI;

          |MENAV aAlfa;
     |FINSI;
|FPRC;
*/
