|VARIABLES;
     xmesnume = 0;
     xtopemes = 0;
     aFecha = "";
     &fFechaDesde = @;
     aDiaAlta = "";
     aMesAlta = "";
     aAnyAlta = "";

     &fFechaHasta = @;
     aDiaBaja = "";
     aMesBaja = "";
     aAnyBaja = "";

     nDiaAlta = 0;
     nMesAlta = 0;
     nAnyAlta = 0;
     nDiaBaja = 0;
     nMesBaja = 0;
     nAnyBaja = 0;

     &nAnys = 0;
     &nMeses = 0;
     &nDias = 0;

     nume1 = 0;
     aAnys = "";
     aMeses = "";
     aDias = "";

     xmod = 0;
     xanynume = 0;
|FIN;

|PROCESO diaanter;
     |SI xmesnume = 1;
          xtopemes = 31;
     |FINSI;
     |SI xmesnume = 2;
          xmod = xanynume $ 4;
          |SI xmod = 0;
               xtopemes = 29;
          |SINO;
               xtopemes = 28;
          |FINSI;
     |FINSI;
     |SI xmesnume = 3;   xtopemes = 31; |FINSI;
     |SI xmesnume = 4;   xtopemes = 30; |FINSI;
     |SI xmesnume = 5;   xtopemes = 31; |FINSI;
     |SI xmesnume = 6;   xtopemes = 30; |FINSI;
     |SI xmesnume = 7;   xtopemes = 31; |FINSI;
     |SI xmesnume = 8;   xtopemes = 31; |FINSI;
     |SI xmesnume = 9;   xtopemes = 30; |FINSI;
     |SI xmesnume = 10;  xtopemes = 31; |FINSI;
     |SI xmesnume = 11;  xtopemes = 30; |FINSI;
     |SI xmesnume = 12;  xtopemes = 31; |FINSI;
|FPRC;

|PROCESO Periodo_Dur;
     aFecha = fFechaDesde;
     aDiaAlta = (aFecha % 102);
     aMesAlta = (aFecha % 402);
     aAnyAlta = (aFecha % -104);

     aFecha = fFechaHasta;
     aDiaBaja = (aFecha % 102);
     aMesBaja = (aFecha % 402);
     aAnyBaja = (aFecha % -104);

     nDiaAlta = aDiaAlta;
     nMesAlta = aMesAlta;
     nAnyAlta = aAnyAlta;
     nDiaBaja = aDiaBaja;
     nMesBaja = aMesBaja;
     nAnyBaja = aAnyBaja;

     nAnys = nAnyBaja - nAnyAlta;

     nMeses = nMesBaja - nMesAlta;
     |SI nMeses [ 0;
          |SI nAnys ! 0;
               nAnys = nAnys - 1;
               nMeses = 12 + nMeses;
          |FINSI;
     |FINSI;

     nDias = nDiaBaja - nDiaAlta + 1;
     nume1 = nDiaAlta - 1;
     xmesnume = nMesBaja;
     xanynume = nAnyBaja;
     |HAZ diaanter;
     |SI nDiaBaja = nume1;
          || nMeses = nMeses + 1;
          nDias = 0;
     |SINO;
          |SI nDiaAlta = 1; |Y nDiaBaja = xtopemes;
               nMeses = nMeses + 1;
               nDias = 0;
          |FINSI;
     |FINSI;
     |SI nDias < 0;
          xmesnume = nMesAlta;
          xanynume = nAnyAlta;
          |HAZ diaanter;
          nDias = xtopemes - nDiaAlta + 1;
          nDias = nDias + nDiaBaja;
          nMeses = nMeses - 1;
     |FINSI;
     |SI nMeses = 12;
          nAnys = nAnys + 1;
          nMeses = 0;
     |FINSI;

     aAnys = nAnys;
     aMeses = nMeses;
     aDias = nDias;
|FPRC;
