|FICHEROS;
   labcodcl #0,MANTE;
   labcodco #1;
   labcodcw #2;

   Referen@ #3;
|FIN;

|VARIABLES;
     ModoEntrada = 0;
     nTecla      = 0;
     nCalc       = 0;
     nCont       = 0;

     aAlfa       = "";
     aAntDes = "";
     aAntDef = "";
|FIN;

|PROCESO CampoNuevo; |TIPO 7;
   nTecla = FSalida;

   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 1;
      aAlfa = "tc" + Usuario; |NOME_DAT #labcodcw#aAlfa#;
      |DELINDEX #labcodcw; |ABRE #labcodcw;
      |DDEF aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + (#labcodco#3 % 108); |QBF aAlfa;
      aAlfa = aAlfa + ".mas";
      |CARGA_DEF aAlfa, Referen@;
      |SI FSalida = 0;
         aAlfa = "|NC"; aAlfa = #Referen@#aAlfa#;
         nCalc = aAlfa; nCalc = nCalc - 1;
         |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
            |DDEFECTO #labcodcw;
            #labcodcw#0 = nCont;
            aAlfa = "|C" + (("000" + nCont) % -103) + "NOMBRE"; aAlfa = #Referen@#aAlfa#;
            #labcodcw#1 = aAlfa;
            aAlfa = "|C" + (("000" + nCont) % -103) + "TIPO"; aAlfa = #Referen@#aAlfa#;
            #labcodcw#2 = aAlfa;
            |GRABA 020#labcodcw.n;
         |SIGUE;
      |FINSI;
      |SI nTecla = 10;
         |CONSULTA_CLAVE #1#labcodcw;
         |SI FSalida = 0;
             #labcodcl#1 = #labcodcw#0; |PINTA #labcodcl#1;
             #labcodcl#2 = #labcodcw#1; |PINTA #labcodcl#2;
             #labcodcl#3 = #labcodcw#2; |PINTA #labcodcl#3;
         |FINSI;
      |FINSI;
      #labcodcw#0 = #labcodcl#1;
      |LEE 000#labcodcw.=;
      |SI FSalida = 0;
          #labcodcl#2 = #labcodcw#1; |PINTA #labcodcl#2;
          #labcodcl#3 = #labcodcw#2; |PINTA #labcodcl#3;
      |SINO;
         |MENAV "    El campo no existe"; |ERROR;
      |FINSI;
   |FINSI;

   |C_M #labcodcl#7, 1, "N"; |C_V #labcodcl#7, 1, "N";
   |C_M #labcodcl#4, 1, "N"; |C_V #labcodcl#4, 1, "N";
   |C_M #labcodcl#5, 1, "N"; |C_V #labcodcl#5, 1, "N";
   |C_M #labcodcl#6, 1, "N"; |C_V #labcodcl#6, 1, "N";
   |SI #labcodcl#3 = "A";
      |C_M #labcodcl#4, 1, "S";
      |C_V #labcodcl#4, 1, "S";
   |FINSI;
   |SI #labcodcl#3 = "N";
      |C_M #labcodcl#5, 1, "S";
      |C_V #labcodcl#5, 1, "S";
   |FINSI;
   |SI #labcodcl#3 = "F";
      |C_M #labcodcl#6, 1, "S";
      |C_V #labcodcl#6, 1, "S";
   |FINSI;
|FPRC;

|PROCESO TrasValor;
   |SI Campo = 4;
      |C_M #labcodcl#4, 1, "N"; |C_V #labcodcl#4, 1, "N";
   |FINSI;
   |SI Campo = 5;
      |C_M #labcodcl#5, 1, "N"; |C_V #labcodcl#5, 1, "N";
   |FINSI;
   |SI Campo = 6;
      |C_M #labcodcl#6, 1, "N"; |C_V #labcodcl#6, 1, "N";
      |C_M #labcodcl#7, 1, "S"; |C_V #labcodcl#7, 1, "S";
   |FINSI;

   |SI #labcodcl#3 = "A";
      #labcodcl#7 = #labcodcl#4;
   |FINSI;
   |SI #labcodcl#3 = "N";
      #labcodcl#7 = #labcodcl#5;
   |FINSI;
   |SI #labcodcl#3 = "F";
      #labcodcl#7 = #labcodcl#6;
   |FINSI;
   |PINTA #labcodcl#7;

   |PONCONTROL 23, "si";
|FPRC;

|PROCESO GuardaValores; |TIPO 3;
     aAntDes = #labcodco#2;
     aAntDef = #labcodco#3;
|FPRC;

|PROCESO RescataValores;
     aAlfa = #labcodco#Campo#;
     |QBF aAlfa;
     |SI aAlfa = "";
          |SI Campo = 2;
               #labcodco#2 = aAntDes;
               |PINTA #labcodco#2;
          |FINSI;
          |SI Campo = 3;
               #labcodco#3 = aAntDef;
               |PINTA #labcodco#3;
          |FINSI;
     |FINSI;
|FPRC;
