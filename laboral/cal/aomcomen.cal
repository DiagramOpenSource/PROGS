|FICHEROS;
     aomcomen #6;
|FIN;
------------------------------------------------------------------------------
|VARIABLES;
     aDirectorio    = "";
     aNFichero      = "";
     aVariableCarga = "";
     aFichero       = "";
     aAlfa          = "";

     nVariable      = 0;
     nBaffer        = 0;
     nTotalLinea    = 0;
     nTope          = 0;
     nVari1         = 0;
     nVari2         = 0;
     nCodigo        = 0;

     || &eaSerie       = "";
     &eaCodigo      = "";
     &cDesc         = "";
     &eaTipoCodigo  = "";
     &eaNombreList  = "";

     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;
     &enTotalVaria  = 0;

{100}&epPuntEdita   = "";

     cMensa         = "";
     cNumero        = "";

     &eaSerie = "";
     &enNumero = 0;
     &efFecha = @;
     &enLinea = 0;
     &aPathDef= "";
     &aPathDat = "";

     aDef = "";
     &enEmpresa = 0;
     &enTrabaj = 0;
|FIN;
------------------------------------------------------------------------------
|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     enModoEdita = enModoEdita + 100;
     |EDITA nBaffer, 0, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     enModoEdita = enModoEdita $ 100;
|FPRC;
------------------------------------------------------------------------------
|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;
------------------------------------------------------------------------------
|PROCESO Edita;
     |PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;
     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
     |POPV;
|FPRC;
------------------------------------------------------------------------------
|PROGRAMA;
     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 1121;
     enCuadroFin   = 1580;
     enCampoAncho  = 60;
     enModoEdita   = 0;

     |ABRE #6;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           nCodigo = eaCodigo;
           #6#0 = eaSerie;
           #6#1 = enNumero;
           #6#2 = efFecha;
           #6#3 = enEmpresa;
           #6#4 = enTrabaj;
           #6#5 = nVariable;
           |LEE 101#6=;
           |SI FSalida ! 0;
               ||SI nVariable = 1;
               ||     epPuntEdita  = ".";
               ||SINO;
                    epPuntEdita  = "";
               ||FINSI;
           |SINO;
               epPuntEdita  = #6#6;
               |BORRA 020#6a;
           |FINSI;
           |LIBERA #6;
     |SIGUE;

/*
     |PUSHV  0501 2380;
     |COLOR 0, 2; |ATRI 0;
     |BLANCO 0502 2279;
     cNumero = "000000" + eaCodigo;
     cNumero = cNumero % -106;
     |QBF eaSerie;
     cNumero = eaSerie + "/" + cNumero;
     |QBF cNumero;
     |QBF cDesc;
     cDesc = cNumero + " - " + cDesc;
     cNumero = " "*60;
     cDesc = cDesc + cNumero;
     cDesc = cDesc % 148;
     |COLOR 0,7;|ATRI N;
     |PINTA 0611, "Presupuesto: ";
     |COLOR 9, 7;|ATRI N;
     |PINTA 0624, cDesc;
     |COLOR 14,2;|ATRI N;
     |PINTA 0803, "Anexo de condiciones:";
     |ATRI 0;
*/
     |HAZ Edita;
     ||POPV;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #6;
           #6#0 = eaSerie;
           #6#1 = enNumero;
           #6#2 = efFecha;
           #6#3 = enEmpresa;
           #6#4 = enTrabaj;
           #6#5 = nVariable;

           || #6#0 = eaSerie;
           || #6#1 = nCodigo;
           || #6#2 = nVariable;

           |LEE 101#6=;
           |SI FSalida ! 0;  |GRABA 020#6b;  |FINSI;
           #6#6 = epPuntEdita;
           |GRABA 020#6a;
           |LIBERA #6;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #6#0 = eaSerie;
           #6#1 = enNumero;
           #6#2 = efFecha;
           #6#3 = enEmpresa;
           #6#4 = enTrabaj;
           #6#5 = nVariable;
           |LEE 101#6=;
           aAlfa = #6#6;  |QBF aAlfa;

           |SI aAlfa ! "";  |SAL;  |FINSI;

           |BORRA 020#6a;
           |LIBERA #6;
     |SIGUE;
     |CIERRA #6;
|FPRO;
------------------------------------------------------------------------------
