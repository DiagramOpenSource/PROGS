|FICHEROS;
     adade002 #0;
     labempre;
     labcentr;
     labtraba;
     nomcalca;
     nomcalli;
     nomhicca;
     nomhicli;

     gomdetjr;
|FIN;

|VARIABLES;
     nAnyXX = 0;
     nEmp = 0;
     nTra = 0;
     aFuente = "";
     &nJornadas = 0;
     &nHoras = 0;
     &nLiquido = 0;
     &nAny = 0;
     &nMes = 0;
     &aMes = "";
     &nTopemes = 0;
     aAlfa = "";
     nCampo = 0;
|FIN;

|PROCESO PintaMes; |TIPO 14;
     nMes = #0#4;
     nAny = #0#5;
     |HAZ MesLetra_plb;
     |ATRI I;
     |PINTA 1445, aMes;
|FPRC;

|PROCESO datos;
     |SI aFuente = "M";
          nEmp = #nomcalca#0;
          nTra = #nomcalca#1;
     |FINSI;
     |SI aFuente = "H";
          nEmp = #nomhicca#0;
          nTra = #nomhicca#1;
     |FINSI;

     #labempre#0 = nEmp;
     |LEE 000#labempre.=;

     #labtraba#0 = nEmp;
     #labtraba#1 = nTra;
     |LEE 000#labtraba.=;

     #labcentr#0 = nEmp;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;

     |SI #labtraba#42 ! "E"; |Y #labtraba#42 ! "C";
          |ACABA;
     |FINSI;

     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI #0#7 = "A"; |Y aAlfa ! "";
          |ACABA;
     |FINSI;

     |SI aFuente = "M";
          |SI #labtraba#42 = "E";
               nJornadas = #nomcalca#11;
               nHoras = 0;

               #nomcalli#0 = #nomcalca#0;
               #nomcalli#1 = #nomcalca#1;
               #nomcalli#2 = #nomcalca#2;
               #nomcalli#3 = #nomcalca#3;
               #nomcalli#4 = 101;
               |LEE 000#nomcalli.=;
               |SI FSalida = 0;
                    nHoras = #nomcalli#11;
               |FINSI;
          |FINSI;
          |SI #labtraba#42 = "C";
               nJornadas = #nomcalca#10;

               |DDEFECTO #gomdetjr;
               #gomdetjr#0 = nEmp;
               #gomdetjr#1 = nTra;
               #gomdetjr#2 = #0#5;
               #gomdetjr#3 = #0#4;
               |LEE 000#gomdetjr.=;

               |PARA nCampo = 4; |SI nCampo [ 34; |HACIENDO nCampo = nCampo + 1;
                    |SI #gomdetjr#nCampo# = "D"; |O #gomdetjr#nCampo# = "x";
                         #gomdetjr#nCampo# = " ";
                    |FINSI;
               |SIGUE;
          |FINSI;
          nLiquido = #nomcalca#109;
     |FINSI;
     |SI aFuente = "H";
          |SI #labtraba#42 = "E";
               nJornadas = #nomhicca#11;

               #nomhicli#0 = #nomhicca#0;
               #nomhicli#1 = #nomhicca#1;
               #nomhicli#12 = #nomhicca#66;
               #nomhicli#2 = #nomhicca#2;
               #nomhicli#3 = #nomhicca#3;
               #nomhicli#4 = 101;
               |LEE 000#nomhicli.=;
               |SI FSalida = 0;
                    nHoras = #nomhicli#11;
               |FINSI;
          |FINSI;
          |SI #labtraba#42 = "C";
               nJornadas = #nomhicca#10;

               |DDEFECTO #gomdetjr;
               #gomdetjr#0 = nEmp;
               #gomdetjr#1 = nTra;
               #gomdetjr#2 = #0#5;
               #gomdetjr#3 = #0#4;
               |LEE 000#gomdetjr.=;

               |PARA nCampo = 4; |SI nCampo [ 34; |HACIENDO nCampo = nCampo + 1;
                    |SI #gomdetjr#nCampo# = "D"; |O #gomdetjr#nCampo# = "x";
                         #gomdetjr#nCampo# = " ";
                    |FINSI;
               |SIGUE;
          |FINSI;
          nLiquido = #nomhicca#151;
     |FINSI;

     nMes = #0#4;
     nAny = #0#5;
     |HAZ topemes_plb;


     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa ! ""; |Y aAlfa ! "..........";
          aAlfa = aAlfa % 102;
          nTopemes = aAlfa;
     |FINSI;

     |PRINT;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#2, nAnyXX, #0#4, 0;
     #0#1, #0#3, nAnyXX, #0#4, 0;
     ;
     NULL, datos;
|FIN;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #0#0, #0#2, #0#4, 0;
     #0#1, #0#3, #0#4, 0;
     ;
     NULL, datos;
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA "Emision del documento de salario y dias/jornadas trabajados";

     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |GRABA 020#0a;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "adade002";

               |ABRE #labempre;
               |ABRE #labcentr;
               |ABRE #labtraba;
               |ABRE #gomdetjr;
               |ABRE #nomcalli;
               |ABRE #nomhicli;

               nAnyXX = #0#5 - 2000;
               aFuente = "M";
               |BUCLE nomcalca;
               aFuente = "H";
               |BUCLE nomhicca;

               |CIERRA #nomhicli;
               |CIERRA #nomcalli;
               |CIERRA #gomdetjr;
               |CIERRA #labtraba;
               |CIERRA #labcentr;
               |CIERRA #labempre;

               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;

     |LIBERA #0;
     |CIERRA #0;
|FPRO;
