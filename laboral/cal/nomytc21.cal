|FICHEROS;
     gomyytc2 #0;    || emision TC2/1
     labempax #2;    || aux. empresas
     nomcalca #6;    || calculos cabs.
|FIN;

|VARIABLES;
     &Desde_emp = 0;
     &Hasta_emp = 0;
     &Mes = 0;
     &Anyo = 0;
|FIN;

|INCLUYE i_cuadr;
|INCLUYE i_recog;
||INCLUYE i_reco1;
|INCLUYE i_1tc21;
____________________________________/ CALCULOS DE PANTALLA
|PROCESO Tipo88; |TIPO 88;
     |HAZ LeeEURODB;
|FPRC;

|PROCESO defecto; |TIPO 7; ||calcula el periodo por defecto segun fecha sistema
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
    #0Campo = #0Campo - menos;
|SI #0Campo < 0;
        #0Campo = 99;
|FINSI;
|PINTA #0Campo;
|FPRC;

|PROCESO pintames; |TIPO 0;
|SI #0Campo =  1;  p_mes = "ENERO     "; |FINSI;
|SI #0Campo =  2;  p_mes = "FEBRERO   "; |FINSI;
|SI #0Campo =  3;  p_mes = "MARZO     "; |FINSI;
|SI #0Campo =  4;  p_mes = "ABRIL     "; |FINSI;
|SI #0Campo =  5;  p_mes = "MAYO      "; |FINSI;
|SI #0Campo =  6;  p_mes = "JUNIO     "; |FINSI;
|SI #0Campo =  7;  p_mes = "JULIO     "; |FINSI;
|SI #0Campo =  8;  p_mes = "AGOSTO    "; |FINSI;
|SI #0Campo =  9;  p_mes = "SEPTIEMBRE"; |FINSI;
|SI #0Campo = 10;  p_mes = "OCTUBRE   "; |FINSI;
|SI #0Campo = 11;  p_mes = "NOVIEMBRE "; |FINSI;
|SI #0Campo = 12;  p_mes = "DICIEMBRE "; |FINSI;
|PINTA 1330, p_mes;
|FPRC;

|PROCESO mirames; |TIPO 7; ||calcula el mes por defecto segun fecha sistema
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
    #0Campo = #0Campo - 1;
|SI #0Campo = 0;
        #0Campo = 12;
        menos = 1;
|SINO;
        menos = 0;
|FINSI;
|PINTA #0Campo;
|FPRC;
____________________________________/ CALCULO PRINCIPAL Y LECTURA CALCULOS
|PROCESO temporal1;
|HAZ temporal;
|FPRC;

|PROCESO meslite1;
|HAZ meslite;
|FPRC;

|DEFBUCLE gra_tempo;
 #6#1;
 ;
 #0#0,     0, #0#2, 0;
 #0#1, 99999, #0#2, 2;
 ;
 meslite1, temporal1;
|FIN;

|DEFBUCLE ini_auxiliar;
 #2#1;
 ;
 #0#0, 000, #0#2,  0;
 #0#1, 999, #0#2, 19;
 be;
 NULL, ini_auxil;
|FIN;

|PROCESO temporal0;
|BUCLE ini_auxiliar;
|BUCLE gra_tempo;
|FPRC;

|PROCESO ulti_dia;  || halla el ultimo dia del mes
    nume2 = 0;
    nume1 = #0#3 $ 4;
|SI nume1 = 0;|Y #36#9 = "S";
        nume2 = 1;
|FINSI;

    topemes = 31;
|SI #0#2 = 2;
        topemes = 28 + nume2;
|FINSI;
|SI #0#2 = 4;|O #0#2 = 6;|O #0#2 = 9;|O #0#2 = 11;
        topemes = 30;
|FINSI;
|FPRC;

|PROCESO control;
|DDEFECTO #36;
|ABRE #36;
|LEE 000#36p;
|SI FSalida ! 0;
    |MENAV "    No existe control, usando defectos ...";
|FINSI;
|CIERRA #36;
|FPRC;

|PROCESO tipo3;
|HAZ control;
|HAZ ulti_dia;
    runnom = "nomytc21";
    anyonum = #0#3;
|HAZ impre;
|FPRC;

|PROGRAMA;
#0#0 = Desde_emp;
#0#1 = Hasta_emp;
#0#2 = Mes;
#0#3 = Anyo;
#0#6 = "T";
|HAZ tipo3;
|FPRO;
