|FICHEROS;
     cretaz04 #0;
     labempre #100;
|FIN;

|VARIABLES;
     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Elegir Opcion:";
     menu4 = "RIAC";
     menu5 = "Revisar";
     menu6 = "Informe";
     menu7 = "Actualizar";
     menu8 = "Cancelar";
     nOpcion = 0;
     nAct = 0;
     aAlfa = "";
     aAlfa1 = "";
     nNume = 0;
     fFecha = @;
     aHora = "";
     nModo = 0;
|FIN;

|PROCESO cretaz04;
     |PRINT;
|FPRC;

|DEFBUCLE cretaz04;
     #cretaz04#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, cretaz04;
|FIN;

|PROCESO Bloquea;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO TodosACero;
     #0#3 = "N";
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE TodosACero;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TodosACero;
|FIN;

|PROCESO TodosAUno;
     #0#3 = "S";
     |GRABA 020#0a;
     |LIBERA #0;
|FPRC;

|DEFBUCLE TodosAUno;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, TodosAUno
|FIN;

|PROCESO Cambio; |TIPO 11;
     |SI FSalida = 13;
          |SI #0#3 ="N";
               #0#3 = "S";
          |SINO;
               #0#3 = "N";
          |FINSI;
          |GRABA 020#0.a;
          |LIBERA #0;
          |PINTA #0#3;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
     |SI FSalida = 14;
          |BUCLE TodosAUno;
          |LEE 000#0p;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
     |SI FSalida = 15;
          |BUCLE TodosACero;
          |LEE 000#0p;
          |PONCONTROL 23, "si";
          |ACABA;
     |FINSI;
|FPRC;

|PROCESO Actualiza;
     |SI #0#2 ! #0#3;
          #labempre#0 = #0#0;
          |LEE 101#labempre.=;
          |SI FSalida = 0;
               #labempre#67 = #0#3;
               |GRABA 020#labempre.a;
               |LIBERA #labempre;
               nAct = nAct + 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE Actualiza;
     #0#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Actualiza;
|FIN;

|PROCESO labempre;
     #0#0 = #labempre#0;
     #0#1 = #labempre#2;
     #0#2 = #labempre#67;
     #0#3 = #labempre#67;
     |GRABA 020#0n;
     |LIBERA #0;
|FPRC;

|DEFBUCLE labempre;
     #labempre#1;
     ;
     00001;
     99999;
     ;
     NULL, labempre;
|FIN;

|PROCESO minimo;
     #0#0 = 00001;
|FPRC;

|PROCESO maximo;
     #0#0 = 99999;
|FPRC;

|PROCESO Mensa; |TIPO 7;
     |MENSA "    < F5 > Activ/Desactiv empresa; < F6 > Activar Todas; < F7 > Desactivar Todas";
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;

     aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("t" + aAlfa1) % 108;
     |NOME_DAT #0 aAlfa1;
     |DELINDEX #0;
     |ABRE #0;

     |BUCLE labempre;

     |CIERRA #0;

     |PARA; |SI; |HACIENDO;
          |ENTLINEAL #1#0, -1, 2, 22, 1, minimo, maximo;
          |MENU menu;
          nOpcion = FSalida;
          |SI nOpcion = 2;
               Impresora = "CrystalReport";
               |IMPRE -1;
               |SI FSalida = 0;
                    |INFOR "cretaz04";
                    |BUCLE cretaz04;
                    |PIEINF;
                    |FININF;
               |FINSI;
               |FINIMP;
          |FINSI;
          |SI nOpcion = 3;
               |ABRE #labempre;
               |BUCLE Actualiza;
               |CIERRA #labempre;
               aAlfa = nAct;
               aAlfa = "    Actualizadas " + aAlfa + " empresas.";
               |MENAV aAlfa;
               |SAL;
          |FINSI;
          |SI nOpcion = 4;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRO;
