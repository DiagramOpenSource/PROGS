|FICHEROS;
     nomzcpag #0;
     labtraba;
     nomcalca;
     nomcalli;
     nomhicca;
     nomhicli;
     nomconli #10;
|FIN;

|VARIABLES;
     nSuma = 0;
     aSuma = "";
     nSuma400 = 0;
     aSuma400 = "";
     nRemu = 0;
     aRemu = "";
     swHay400 = 0;
     &nAfectados = 0;
     &nRevisados = 0;
     product = 0;
     &aEmp = "";
     &aTra = "";
     &aMes = "";
     &aDonde = "";
     aResta = "";
     nResta = 0;
     &nProrrata = 0;
     &nCalculada = 0;
|FIN;

|PROCESO nomhicli;
     product = (#nomhicli#9 * #nomhicli#10);
     nProrrata = nProrrata + product;
|FPRC;

|DEFBUCLE nomhicli;
     #nomhicli#1;
     ;
     #nomhicca#0, #nomhicca#1, #nomhicca#66, #nomhicca#2, 0, 201;
     #nomhicca#0, #nomhicca#1, #nomhicca#66, #nomhicca#2, 0, 208;
     ;
     NULL, nomhicli;
|FINSI;

|PROCESO nomhicca;
     #labtraba#0 = #nomhicca#0;
     #labtraba#1 = #nomhicca#1;
     |LEE 000#labtraba.=;

     nProrrata = 0;
     nCalculada = #nomhicca#38;
     |BUCLE nomhicli;
     nProrrata = nProrrata ! 2;
     nResta = nCalculada - nProrrata;
     aResta = nResta;
     |SI nResta < -0.05; |O nResta > 0.05;
          aEmp = #nomhicca#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #nomhicca#1; aTra = "00000" + aTra; aTra = aTra % -105;
          aMes = #nomhicca#2; aMes = "00" + aMes; aMes = aMes % -102;
          aDonde = "H";
          nAfectados = nAfectados + 1;
          nRevisados = nRevisados + 1;
          |PRINT;
     |SINO;
          nRevisados = nRevisados + 1;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#2, 08, 06, 0;
     #0#1, #0#3, 08, 06, 0;
     ;
     NULL, nomhicca;
|FINSI;

|PROCESO nomcalli;
     product = (#nomcalli#9 * #nomcalli#10) ! 2;
     nProrrata = nProrrata + product;
|FPRC;

|DEFBUCLE nomcalli;
     #nomcalli#1;
     ;
     #nomcalca#0, #nomcalca#1, #nomcalca#2, 0, 201;
     #nomcalca#0, #nomcalca#1, #nomcalca#2, 0, 208;
     ;
     NULL, nomcalli;
|FINSI;

|PROCESO nomcalca;
     #labtraba#0 = #nomcalca#0;
     #labtraba#1 = #nomcalca#1;
     |LEE 000#labtraba.=;

     nProrrata = 0;
     nCalculada = #nomcalca#38;
     |BUCLE nomcalli;
     nProrrata = nProrrata ! 2;
     nResta = nProrrata - nCalculada;
     aResta = nResta;
     |SI nResta < -0.05; |O nResta > 0.05;
          aEmp = #nomcalca#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #nomcalca#1; aTra = "00000" + aTra; aTra = aTra % -105;
          aMes = #nomcalca#2; aMes = "00" + aMes; aMes = aMes % -102;
          aDonde = "M";
          nAfectados = nAfectados + 1;
          nRevisados = nRevisados + 1;
          |PRINT;
     |SINO;
          nRevisados = nRevisados + 1;
     |FINSI;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #0#0, #0#2, 06, 0;
     #0#1, #0#3, 06, 0;
     ;
     NULL, nomcalca;
|FINSI;

|PROCESO Tipo3; |TIPO 3;
     |ABRE #labtraba;
     |ABRE #nomconli;
     |IMPRE 0;
     |INFOR "nomzcpag";
     |BUCLE nomcalca;
     |BUCLE nomhicca;
     |PIEINF;
     |FININF;
     |FINIMP;
     |CIERRA #nomconli;
     |CIERRA #labtraba;
|FPRC;
