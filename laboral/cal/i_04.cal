|INCLUYE i_fiche;
|INCLUYE i_varia;

|FICHEROS;
    labaux01 #100,MANTE;
|FIN;

|VARIABLES;
    para1 = 0;
    &xhoraa = "";
    &segun = "";
|FIN;

|PROCESO jornada; |TIPO 0;         || CONTRATOS 64, 14, 24, 03, 23
|SI #0#0 = "64";    |ACABA;   |FINSI;

    jorna = ((#0#32*100)/#0#34) ! 0;
|HAZ JornadaMax;
|FPRC;

|PROCESO JornadaMax; |TIPO 0;
|SI Campo ! 63;
        #0#63 = jorna;  |PINTA #0#63;
|SINO;
        jorna = #0#63;
|FINSI;
|SI jorna > 77;
    |MENAV "    Jornada maxima excedida (77%) ...";
|FINSI;
|FPRC;

|PROCESO tipoh; |TIPO 0;
|SI #0#33 = "D";  xhoraa = "diarias  "; |FINSI;
|SI #0#33 = "S";  xhoraa = "semanales"; |FINSI;
|SI #0#33 = "M";  xhoraa = "mensuales"; |FINSI;
|SI #0#33 = "A";  xhoraa = "anuales  "; |FINSI;
|FPRC;

|PROCESO sino; |TIPO 0;
|SI #0Campo = "S";  si4 = "si";  |FINSI;
|SI #0Campo = "N";  si4 = "no";  |FINSI;
|FPRC;

|PROCESO tipo_cto; |TIPO 0;
|PARA para1 = 50; |SI para1 [ 54; |HACIENDO para1 = para1 + 1;
     |SI #0Campo ! " ";|Y para1 ! Campo;
             #0para1 = " ";
         |PINTA #0para1;
     |FINSI;
|SIGUE;

|C_M #0#61, 1, "N";
|C_M #0#62, 1, "N";
|C_M #0#64, 1, "N";
|C_M #0#65, 1, "N";
|C_M #0#66, 1, "N";

|SI #0#50 ! " ";
    |C_M #0#61, 1, "S";
|FINSI;
|SI #0#51 ! " ";
    |C_M #0#62, 1, "S";
|FINSI;
|SI #0#52 ! " ";
    |C_M #0#64, 1, "S";
    |C_M #0#65, 1, "S";
    |C_M #0#66, 1, "S";
|FINSI;
|FPRC;

|PROCESO pacto; |TIPO 0;
|SI #0#61 = "S";|Y FSalida = 0;
    |PUSHV 0501 2380;
    |PINPA #0#100;
    |PINDA #0#100;
    |ENDATOS #1#100;
    |POPV;
|FINSI;
|FPRC;

|PROCESO trimestres; |TIPO 0;
     #100#2 = #100#0 / 4;
     #100#3 = #100#0 / 4;
     #100#4 = #100#0 / 4;
     #100#5 = #100#0 - (#100#2 + #100#3 + #100#4);
|PINDA #0#100;
|FPRC;

|PROCESO TipoActividad; |TIPO 0;
     |SI #0#28 = "F";
          |C_M #0#55, 1, "S";
          |C_M #0#56, 1, "S";
          |C_M #0#57, 1, "S";
          |C_M #0#59, 1, "S";
          |C_M #0#60, 1, "S";
          |C_M #0#29, 1, "N";
          |PDEFECTO #0, 29, 30;
          |PINTA #0#29;
     |SINO;
          |C_M #0#55, 1, "N";
          |C_M #0#56, 1, "N";
          |C_M #0#57, 1, "N";
          |C_M #0#59, 1, "N";
          |C_M #0#60, 1, "N";
          |C_M #0#29, 1, "S";
          |PDEFECTO #0, 55, 58;
          |PDEFECTO #0, 59, 61;
          |PINTA #0#55;
          |PINTA #0#56;
          |PINTA #0#57;
          |PINTA #0#59;
          |PINTA #0#60;
     |FINSI;
|FPRC;

|PROCESO NoCausa; |TIPO 0;
     alfa1 = #0#28;
     |C_M #0#27, 1, alfa1;
     |SI alfa1 = "N";
          |PDEFECTO #0, 27, 28;
          |PINTA #0#27;
     |FINSI;
|FPRC;

|PROCESO Vigencia; |TIPO 0;
     |SI #0#53 = "..........";|O #0#53 = "          "; |ACABA;   |FINSI;
     |SI #0#54 = "..........";|O #0#54 = "          "; |ACABA;   |FINSI;

     fech1 = #0#53;
     fech2 = #0#54;

     |SI fech1 [ fech2;
          |SI fech1 > "28.11.1998";|O fech2 < "28.11.1998";
               |MENAV "    El Convenio debera estar vigente el 28 de noviembre de 1998 ...";
          |FINSI;
     |SINO;
          |MENAV "    Error de entrada ...";
     |FINSI;
|FPRC;

|PROCESO jornada11; |TIPO 0;
    jorna = ((#0#27*100)/#0#29) ! 0;
|HAZ JornadaMax;
|FPRC;

|PROCESO TipoConversion; |TIPO 0;
     |ATRI I;  |PINTA 2004, "-Tiempo Parcial-";   |ATRI 0;
     |ATRI I;  |PINTA 2044, "-Tiempo Completo-";  |ATRI 0;
     |SI #0#57 = "1";|O #0#57 = "2";         || tiempo completo
          alfa1 = "N";
          alfa2 = "S";
          |PDEFECTO #0, 27, 30;
          |PDEFECTO #0, 64, 70;
          #0#61 = "N";
          |SI #0#57 = "1"; #0#58 = "109";    |FINSI;
          |SI #0#57 = "2"; #0#58 = "109";    |FINSI;
          |ATRI R;  |PINTA 2044, "-Tiempo Completo-";  |ATRI 0;
     |FINSI;
     |SI #0#57 = "3";                        || tiempo parcial
          alfa1 = "S";
          alfa2 = "N";
          |PDEFECTO #0, 32, 35;
          |SI #0#57 = "3"; #0#58 = "209";    |FINSI;
          |ATRI R;  |PINTA 2004, "-Tiempo Parcial-";   |ATRI 0;
     |FINSI;
     |PINTA #0#58;
     |C_M #0#27, 1, alfa1;    |PINTA #0#27;
     |C_M #0#28, 1, alfa1;    |PINTA #0#28;
     |C_M #0#29, 1, alfa1;    |PINTA #0#29;
     |C_M #0#61, 1, alfa1;    |PINTA #0#61;
     |C_M #0#63, 1, alfa1;    |PINTA #0#63;
     |C_M #0#64, 1, alfa1;    |PINTA #0#64;
     |C_M #0#65, 1, alfa1;    |PINTA #0#65;
     |C_M #0#66, 1, alfa1;    |PINTA #0#66;
     |C_M #0#67, 1, alfa1;    |PINTA #0#67;
     |C_M #0#68, 1, alfa1;    |PINTA #0#68;
     |C_M #0#69, 1, alfa1;    |PINTA #0#69;

     |C_M #0#32, 1, alfa2;    |PINTA #0#32;
     |C_M #0#33, 1, alfa2;    |PINTA #0#33;
     |C_M #0#34, 1, alfa2;    |PINTA #0#34;
|FPRC;

|PROCESO TipoConversion09; |TIPO 0;
     |ATRI I;  |PINTA 2004, "-Tiempo Parcial-";   |ATRI 0;
     |ATRI I;  |PINTA 2044, "-Tiempo Completo-";  |ATRI 0;
     |SI #0Campo = "1";                          || tiempo completo
          alfa1 = "N";
          alfa2 = "S";
          |PDEFECTO #0, 27, 30;
          |PDEFECTO #0, 55, 61;
          #0#66 = 0;
          |SI #0#61 = "S";
               |MENAV "    Se anula el pacto de horas complementarias ...";
          |FINSI;
          #0#61 = "N";
          |ATRI R;  |PINTA 2044, "-Tiempo Completo-";  |ATRI 0;
     |FINSI;
     |SI #0Campo = "2";                        || tiempo parcial
          alfa1 = "S";
          alfa2 = "N";
          |PDEFECTO #0, 32, 35;
          |ATRI R;  |PINTA 2004, "-Tiempo Parcial-";   |ATRI 0;
     |FINSI;
     |C_M #0#27, 1, alfa1;    |PINTA #0#27;
     |C_M #0#28, 1, alfa1;    |PINTA #0#28;
     |C_M #0#29, 1, alfa1;    |PINTA #0#29;
     |C_M #0#61, 1, alfa1;    |PINTA #0#61;
     |C_M #0#63, 1, alfa1;    |PINTA #0#63;
     |C_M #0#55, 1, alfa1;    |PINTA #0#55;
     |C_M #0#56, 1, alfa1;    |PINTA #0#56;
     |C_M #0#57, 1, alfa1;    |PINTA #0#57;
     |C_M #0#58, 1, alfa1;    |PINTA #0#58;
     |C_M #0#59, 1, alfa1;    |PINTA #0#59;
     |C_M #0#60, 1, alfa1;    |PINTA #0#60;
     |C_M #0#66, 1, alfa1;    |PINTA #0#66;

     |C_M #0#32, 1, alfa2;    |PINTA #0#32;
     |C_M #0#33, 1, alfa2;    |PINTA #0#33;
     |C_M #0#34, 1, alfa2;    |PINTA #0#34;
|FPRC;

|PROCESO TipoConversionb5; |TIPO 0;
     |ATRI I;  |PINTA 0804, "-Tiempo Parcial-";   |ATRI 0;
     |ATRI I;  |PINTA 0844, "-Tiempo Completo-";  |ATRI 0;
     |SI #0Campo = "1";                          || tiempo completo
          alfa1 = "N";
          alfa2 = "S";
          |PDEFECTO #0, 27, 30;
          |PDEFECTO #0, 55, 61;
          #0#28 = "";
          #0#66 = 0;
          |SI #0#61 = "S";
               |MENAV "    Se anula el pacto de horas complementarias ...";
          |FINSI;
          #0#61 = "N";
          |ATRI R;  |PINTA 0844, "-Tiempo Completo-";  |ATRI 0;
     |FINSI;
     |SI #0Campo = "2";                        || tiempo parcial
          alfa1 = "S";
          alfa2 = "N";
          |PDEFECTO #0, 32, 35;
          #0#32 = 0;
          #0#33 = "";
          #0#34 = "";
          |ATRI R;  |PINTA 0804, "-Tiempo Parcial-";   |ATRI 0;
     |FINSI;
     |C_M #0#27, 1, alfa1;    |PINTA #0#27;
     |C_M #0#28, 1, alfa1;    |PINTA #0#28;
     |C_M #0#29, 1, alfa1;    |PINTA #0#29;
     |C_M #0#61, 1, alfa1;    |PINTA #0#61;
     |C_M #0#63, 1, alfa1;    |PINTA #0#63;
     |C_M #0#55, 1, alfa1;    |PINTA #0#55;
     |C_M #0#56, 1, alfa1;    |PINTA #0#56;
     |C_M #0#57, 1, alfa1;    |PINTA #0#57;
     |C_M #0#58, 1, alfa1;    |PINTA #0#58;
     |C_M #0#59, 1, alfa1;    |PINTA #0#59;
     |C_M #0#60, 1, alfa1;    |PINTA #0#60;
     |C_M #0#66, 1, alfa1;    |PINTA #0#66;

     |C_M #0#32, 1, alfa2;    |PINTA #0#32;
     |C_M #0#33, 1, alfa2;    |PINTA #0#33;
     |C_M #0#34, 1, alfa2;    |PINTA #0#34;
|FPRC;

|PROCESO TipoActividadZ5; |TIPO 0;
     |SI #0#28 = "F";
          |C_M #0#64, 1, "S";
          |C_M #0#65, 1, "S";
          |C_M #0#66, 1, "S";
          |C_M #0#68, 1, "S";
          |C_M #0#69, 1, "S";

          |C_M #0#29, 1, "N";
          |C_M #0#59, 1, "N";
          |C_M #0#60, 1, "N";
          |C_M #0#67, 1, "N";

          |PDEFECTO #0, 29, 30;
          |PDEFECTO #0, 59, 61;
          |PDEFECTO #0, 67, 68;
          |PINTA #0#59;
          |PINTA #0#60;
          |PINTA #0#67;
     |SINO;
          |C_M #0#64, 1, "N";
          |C_M #0#65, 1, "N";
          |C_M #0#66, 1, "N";
          |C_M #0#68, 1, "N";
          |C_M #0#69, 1, "N";

          |C_M #0#29, 1, "S";
          |C_M #0#59, 1, "S";
          |C_M #0#60, 1, "S";
          |C_M #0#67, 1, "S";

          |PDEFECTO #0, 64, 67;
          |PDEFECTO #0, 68, 70;
          |PINTA #0#64;
          |PINTA #0#65;
          |PINTA #0#66;
          |PINTA #0#68;
          |PINTA #0#69;
     |FINSI;
|FPRC;

|PROCESO Subvencion09; |TIPO 7;
     #0#66 = 650000 * #0#63;
     #0#66= #0#66/100;
     |PINTA #0#66;
|FPRC;

|PROCESO edad; |TIPO 7;
|SI #2#11 ! vblanco; |Y #2#11 ! vpuntos;
        fechtra = #2#11;
    |HAZ edadanyo;
    #0#67 = edadxxx;
|FINSI;
|FPRC;

|PROCESO antidato; |TIPO 0;      || CALCULO CUOTAS IMPRESO DE
|PINTA 1469, vblanco;            || ANTICIPO DE DATOS/ CONTRATOS 08 Y 09
|PINTA 1769, vblanco;
|PINTA 2069, vblanco;
|PINTA 2269, vblanco;
    cuota4 = 0;
    cuota1 = #0#50 % #0#49;        cuota1 = cuota1 ! 0;
    cuota2 = #0#52 % #0#51;        cuota2 = cuota2 ! 0;
    cuota3 = #0#54 % #0#53;        cuota3 = cuota3 ! 0;
    cuota4 = cuota1 + cuota2;
    cuota4 = cuota4 + cuota3;
|PINTA 1469, cuota1;
|PINTA 1769, cuota2;
|PINTA 2069, cuota3;
|PINTA 2269, cuota4;
|PAUSA;
|FPRC;
