|FICHEROS;
     labcentr;
     nomauxi1;
     nomauxi2;
     nomparca #30;
     nomxpara #32;
|FIN;

|VARIABLES;
     aRaizMacro = "";
     aNombreMacro = "";
     nLinea = 0;
     aValor = "";
     aHojaExcel = "";
     aBase = "";
     aOrigen = "";
     aDestino = "";
     aDestinoTrab = "";
     aIPRemoto = "";
     aPath = "";
     {1}aVersion = "";
     aLongitud = "";
     nLongitud = 0;
     aPos = "";
     nPos = 0;
     nCaracter = 0;
     aCaracter = "";
     nCampo = 0;
     aHoja = "";
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     nNume = 0;
     fFecha = @;
     nCol = 0;
     &enColumnas = 0;
     &enInforme = 0;
     &dmes = 0;
     &hmes = 0;
     &peri = 0;
     &linea = 0;
     aResultado = "";
|FIN;

|PROCESO ExtraePath;
     aPath     = aVersion1;
     aLongitud = aPath % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
           nCaracter = (nPos * 100) + 1;
           aCaracter = aPath % nCaracter;
           |SI aCaracter = ",";
               nPos = nLongitud - nPos;
               nPos = nPos + 100;
               nPos = (-1) * nPos;
               aPath = aPath % nPos;
               |SAL;
          |FINSI;
     |SIGUE;

     aPath = aPath - "[";
     aPath = aPath - "]";
     |QBF aPath;
|FPRC;

|PROCESO Lineas_Macro;
     aAlfa = "A" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "B" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "C" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "D" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "E" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "F" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "G" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     aAlfa = "H" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
     nCol = 1;
     |SI nCol [ enColumnas;
          aAlfa = "I" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "J" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "K" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "L" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "M" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "N" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "O" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "P" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Q" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "R" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "S" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "T" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "U" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "V" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "W" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "X" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Y" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Z" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AA" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AB" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AC" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AD" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AE" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AF" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AG" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AH" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AI" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AJ" + nLinea + "," + aRaizMacro + aNombreMacro; |ALFACALLDLL "agixl97.dll","ejecuta_celda", aAlfa;
          nCol = nCol + 1;
     |FINSI;
|FPRC;

|PROCESO TotalesSUBRAYADO;
     || Subrayado

     aRaizMacro = "Módulo1.";
     aNombreMacro = "Subrayado";

     |HAZ Lineas_Macro;
|FPRC;

|PROCESO TotalesNEG;
     || totales en Negrita, las lineas del total

     aRaizMacro = "Módulo1.";
     aNombreMacro = "Negrita";

     |HAZ Lineas_Macro;
|FPRC;

|PROCESO TotalesGRISNEG;
     || totales en Gris y negrita, las lineas del total

     aRaizMacro = "Módulo1.";
     aNombreMacro = "Gris_Negrita";

     |HAZ Lineas_Macro;
|FPRC;

|PROCESO Cabecera;
     || linea 1 de la cabecera

     |ABRE #30;
     #30#0 = enInforme;
     |LEE 000#30=;
     |SI FSalida = 0;
          aValor = #30#2;
     |FINSI;
     |CIERRA #30;

     aAlfa = "A1, " + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aAlfa1 = dmes; aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa2 = hmes; aAlfa2 = ("00" + aAlfa2) % -102;
     nNume = peri + 2000;
     aAlfa3 = nNume;
     aValor = "Periodo: " + aAlfa1 + "/" + aAlfa2 + " - " + aAlfa3;
     aAlfa = "D1, " + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     fFecha = ~;
     aValor = fFecha;
     aValor = "Fecha: " + aValor;
     aAlfa = "H1, " + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nLinea = 1;
|FPRC;

|PROCESO Cabecera_Emp;
     || linea 3 de la cabecera

     nLinea = nLinea + 2;

     |HAZ TotalesGRISNEG;

     aAlfa1 = #32#0; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = #32#1;
     aValor = "EMPRESA: " + aAlfa1 + " - " + aAlfa2;
     aAlfa = "A" + nLinea + ", " + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     || linea 5 de la cabecera

     nLinea = nLinea + 2;

     |HAZ TotalesNEG;
     |HAZ TotalesSUBRAYADO;

     aValor = "Codigo";
     aAlfa = "A" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "Nombre Trabajador";
     aAlfa = "B" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "Periodo";
     aAlfa = "C" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "Horas";
     aAlfa = "D" + nLinea + ","  + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     aValor = "NIF";
     aAlfa = "E" + nLinea + ","  + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "NAFSS";
     aAlfa = "F" + nLinea + ","  + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "Categoría";
     aAlfa = "G" + nLinea + ","  + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     aValor = "Antigüedad";
     aAlfa = "H" + nLinea + ","  + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;

     nCampo = 156;
     aAlfa = "I" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "J" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "K" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "L" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "M" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "N" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "O" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "P" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "Q" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "R" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "S" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "T" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "U" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "V" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "W" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "X" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "Y" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "Z" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AA" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AB" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AC" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AD" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AE" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AF" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AG" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AH" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AI" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     nCampo = nCampo + 1;
     aAlfa = "AJ" + nLinea + "," + #32nCampo; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
|FPRC;

|PROCESO Linea_Excel;
     |SI linea = 0;
          nLinea = nLinea + 1;          || linea normal
     |SINO;
          nLinea = nLinea + 1;          || linea totales
     |FINSI;
|| xxxxxxxxxxx

     |SI linea = 0; nCampo = 6; |FINSI;
     |SI linea = 1; nCampo = 36; |FINSI;
     |SI linea = 2; nCampo = 66; |FINSI;
     |SI linea = 3; nCampo = 96; |FINSI;
     |SI linea = 4; nCampo = 186; |FINSI;

     |SI linea = 0;
          aValor = #32#2; aValor = ("00000" + aValor) % -105;
          aAlfa = "A" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "B" + nLinea + "," + #32#3; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "C" + nLinea + "," + #32#4; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "D" + nLinea + "," + #32#5; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "E" + nLinea + "," + #32#217; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "F" + nLinea + "," + #32#218; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "G" + nLinea + "," + #32#219; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          aAlfa = "H" + nLinea + "," + #32#220; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;
     |SI linea = 1;
          |HAZ TotalesGRISNEG;
          aValor = "TOTAL EMPRESA:";
          aAlfa = "B" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;
     |SI linea = 2;
          |HAZ TotalesNEG;
          aValor = #labcentr#1;
          aValor = (("00" + aValor) % -102) + " - " + #labcentr#2;
          |QBF aValor;
          aValor = "TOTAL CENTRO: " + aValor;
          aAlfa = "B" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;
     |SI linea = 3;
          |HAZ TotalesNEG;
          aValor = #nomauxi1#0;
          aValor = aValor + " - " + #nomauxi1#1;
          |QBF aValor;
          aValor = "TOTAL AREA: " + aValor;
          aAlfa = "B" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;
     |SI linea = 4;
          aValor = #nomauxi2#0;
          aValor = aValor + " - " + #nomauxi2#1;
          |QBF aValor;
          aValor = "TOTAL SECCION: " + aValor + " " + #nomauxi2#2;
          aAlfa = "B" + nLinea + "," + aValor; |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     nCol = 1;

     |SI nCol [ enColumnas;
         aAlfa = "I" + nLinea + "," + #32nCampo;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         nCampo = nCampo + 1;
         nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "J" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "K" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "L" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "M" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "N" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "O" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "P" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Q" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "R" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "S" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "T" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "U" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "V" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
         aAlfa = "W" + nLinea + "," + #32nCampo;
         |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
         nCampo = nCampo + 1;
         nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "X" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Y" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "Z" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AA" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AB" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AC" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AD" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AE" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AF" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AG" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AH" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AI" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
          nCampo = nCampo + 1;
          nCol = nCol + 1;
     |FINSI;
     |SI nCol [ enColumnas;
          aAlfa = "AJ" + nLinea + "," + #32nCampo;
          |ALFACALLDLL "agixl97.dll","poke_dato", aAlfa;
     |FINSI;

     |SI linea ! 0;
          nLinea = nLinea + 1;          || linea totales
     |FINSI;
|FPRC;

|PROCESO Excel_Inicio;
     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;
          |MENAV "0000No se puede usar la DLL de Excel.";
          |ACABA;
     |FINSI;

     aHojaExcel = "informe_parametrizado.xls";

     |DBASE aBase;  |QBF aBase;
     aOrigen = aBase + "documentos/" + aHojaExcel;
     aDestinoTrab = "C:\DOCUMENTOS";         |RMKDIR aDestinoTrab;
     aDestino = aDestinoTrab + "\trabajo.xls";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;
     |SI aIPRemoto ! "";
          |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
          |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |ALFACALLDLL "agixl97.dll", "carga_book", aDestino;

     aHoja = "Hoja1";
     |ALFACALLDLL "agixl97.dll", "selecciona_hoja", aHoja;

     |HAZ Cabecera;
|FPRC;

|PROCESO Excel_Fin;
     aAlfa   = aDestinoTrab + "\" + aHojaExcel;
     |RFBORRA aAlfa;

     |ALFACALLDLL "agixl97.dll", "fichero_destino", aAlfa;
     aResultado = aAlfa;

     |ALFACALLDLL "agixl97.dll", "fin_book", "salva";
     |DESCARGADLL "agixl97.dll";

     aDestino   = aDestinoTrab + "\trabajo.xls";
     |RFBORRA aDestino;
         aVersion1 = "Excel.Sheet";
         |ESPECIFICA "VERSION_PROGRAMA", aVersion;
         |HAZ ExtraePath;
         |SI aPath = "NO LOCALIZADO";
             |MENAV "    ATENCION. No se ha encontrado la hoja Excel.";
             |ACABA;
         |FINSI;

         |QBF aPath;

     ||aAlfa  = "cmd " + &34 + "/c START /WAIT " + aPath + " " + aAlfa + &34;
     aAlfa  = "cmd " + &34 + "/c START /WAIT " + aResultado + &34;
     |RSYSTEM aAlfa;
|FPRC;
