|FICHEROS;
     mod00268 #0;
     mod00265;
     mod00267;

     mod00244;

     labempre;
     labtraba;
|FIN;

|VARIABLES;
     fFechaDesde = @;
     fFechaHasta = @;

     nTopeMes = 0;
     nMes = 0;
     nAny = 0;
     nDia = 0;
     fFecha = @;
     nAntEmp = 0;
     nAntTra = 0;

     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     nNume = 0;
     swLlega = 0;
     nCalendario = 0;
     nMargen = 0;
     nMargen1 = 0;
     nMargen2 = 0;
     nMinutos = 0;
     nDescuadre = 0;
|FIN;

|PROCESO impresion;
     #labempre#0 = #mod00244#0;
     |LEE 000#labempre.=;

     #labtraba#0 = #mod00244#0;
     #labtraba#1 = #mod00244#1;
     |LEE 000#labtraba.=;

     |PRINT;
|FPRC;

|DEFBUCLE impresion;
     #mod00267#1;
     ;
     #0#0, #0#2, #0#4, #0#5, fFechaDesde;
     #0#1, #0#3, #0#4, #0#5, fFechaHasta;
     ;
     NULL, impresion;
|FIN;

|PROCESO topemes;
     nTopeMes = 31;
     |SI nMes = 4; |O nMes = 6; |O nMes = 9; |O nMes = 11;
          nTopeMes = 30;
     |FINSI;
     |SI nMes = 2;
          nTopeMes = 28;
          nNume = nAny $ 4;
          |SI nNume = 0;
               nTopeMes = 29;
          |FINSI;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Informe Horas Trabajadas";
     |PINPA #0#0;
     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;
     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |INFOR "mod00266";

          |ABRE #labempre;
          |ABRE #labtraba;

          |ABRE #mod00267;

          nAny = #0#4;
          nMes = #0#5;
          |HAZ topemes;

          aAlfa1 = "01";
          aAlfa2 = nMes; |QBF aAlfa2; aAlfa2 = ("00" + aAlfa2) % -102;
          aAlfa3 = nAny;
          aAlfa = aAlfa1 + "." + aAlfa2 + "." + aAlfa3;
          fFechaDesde = aAlfa;

          aAlfa1 = nTopeMes;
          aAlfa = aAlfa1 + "." + aAlfa2 + "." + aAlfa3;
          fFechaHasta = aAlfa;

          |BUCLE impresion;

          |CIERRA #mod00267
          |CIERRA #mod00265;
          |CIERRA #labtraba;
          |CIERRA #labempre;

          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;

     |GRABA 020#0a;

     |LIBERA #0;
     |CIERRA #0;
|FPRO;
