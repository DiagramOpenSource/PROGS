|FICHEROS;
     nomfan04 #0;
     nomfan05 #5,MANTE;
     nomcatca;
     nomcateg;
|FIN;

|VARIABLES;
     &nModo = 0;
     nModo2 = 0;
     nForma = 0;
     FEstado = 0;
     &nConvenio = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     aMensa = "";
|FIN;

|PROCESO RecargaCat;
     #nomcatca#0 = #nomcateg#0;
     #nomcatca#1 = #nomcateg#1;
     |LEE 000#nomcatca.=;
     |SI FSalida ! 0;
          #nomcatca#0 = #nomcateg#0;
          #nomcatca#1 = #nomcateg#1;
          #nomcatca#2 = #nomcateg#2;
          #nomcatca#3 = #nomcateg#9;
          |GRABA 020#nomcatca.n;
          |LIBERA #nomcatca;
     |FINSI;
|FPRC;

|DEFBUCLE RecargaCat;
     #nomcateg#1;
     ;
     nConvenio, 001;
     nConvenio, 999;
     be;
     NULL, RecargaCat;
|FIN;

|PROCESO RegrabaCat;
     #nomcateg#0 = #nomcatca#0;
     #nomcateg#1 = #nomcatca#1;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          |SI #nomcatca#2 ! #nomcateg#2;
               #nomcatca#2 = #nomcateg#2;
               |GRABA 020#nomcatca.a;
          |FINSI;
          |SI #nomcatca#3 ! #nomcateg#9;
               #nomcatca#3 = #nomcateg#9;
               |GRABA 020#nomcatca.a;
          |FINSI;
     |SINO;
          aAlfa1 = #nomcatca#1; aAlfa1 = "000" + aAlfa1; aAlfa1 = aAlfa1 % -103;
          aAlfa2 = #nomcatca#2;
          |QBF aAlfa2;
          |SI aAlfa2 ! "";
               aAlfa2 = " - " + aAlfa2;
          |FINSI;
          aMensa = "    ATENCION: La categoria " + aAlfa1 + aAlfa2 + " no existe en ";
          aMensa = aMensa + "las categorias del convenio."
          |MENAV aMensa;
          aMensa = "    SDesea borrarla de Importes por Categoria?";
          |CONFI aMensa;
          |SI FSalida = 0;
               |BORRA 020#nomcatca.a;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RegrabaCat;
     #nomcatca#1;
     ;
     nConvenio, 001;
     nConvenio, 999;
     be;
     NULL, RegrabaCat;
|FIN;

|PROCESO minimoCon;
     #nomfan05#0 = #nomfan04#0;
     #nomfan05#1 = #nomfan04#1;
     #nomfan05#2 = 101;
|FPRC;

|PROCESO maximoCon;
     #nomfan05#0 = #nomfan04#0;
     #nomfan05#1 = #nomfan04#1;
     #nomfan05#2 = 999;
|FPRC;

|PROCESO PintaConceptos; |TIPO 7;
     |ENTLINEAL #1#nomfan05, -3, 7, 22, 1, minimoCon, maximoCon;
|FPRC;

|PROCESO Borrado;
     |BORRA 020#nomfan05.a;
|FPRC;

|DEFBUCLE Borrado;
     #nomfan05#1;
     ;
     #nomfan04#0, #nomfan04#1, 101;
     #nomfan04#0, #nomfan04#1, 999;
     be;
     NULL, Borrado;
|FIN;

|PROCESO Tipo2; |TIPO 2;
     nForma = 0 +. 1;
     nModo2 = (FEntrada / 100) ! 0;

     |SI nModo2 = 3;
          |BUCLE Borrado;
          |ACABA;
     |FINSI;

     |SI nForma = 1;
          |ENTLINEAL #1#nomfan05, -3, 2, 22, 1, minimoCon, maximoCon;
     |FINSI;
|FPRC;

|PROCESO minimo;
     #nomfan04#0 = nConvenio;
     #nomfan04#1 = 001;
|FPRC;

|PROCESO maximo;
     #nomfan04#0 = nConvenio;
     #nomfan04#1 = 999;
|FPRC;

|PROGRAMA;
     |ABRE #nomcateg;
     |ABRE #nomcatca;
     |BUCLE RegrabaCat;
     |BUCLE RecargaCat;
     |CIERRA #nomcatca;
     |CIERRA #nomcateg;
     |SI nModo = 4;
          |ENTLINEAL #1#nomfan04, 2, 4, 22, 1, minimo, maximo;
     |SINO;
          |ENTLINEAL #1#nomfan04, 2, 1, 22, 1, minimo, maximo;
     |FINSI;
|FPRO;
