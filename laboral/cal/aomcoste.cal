|FICHEROS;
    aomcoste #0;
    labtraba #1;
    aontraem #2;
    aomparam #3;
|FIN;

|VARIABLES;
    nume1 = 0;
    fecsys = @;
    alfa1 = "";
    meses = "";
    meses1 = "ENERO     FEBRERO   MARZO     ABRIL     MAYO      JUNIO     ";
    meses2 = "JULIO     AGOSTO    SEPTIEMBREOCTUBRE   NOVIEMBRE DICIEMBRE ";

     &enForma = 0;
     &efFecha = @;
     &enUni = 0;
     &enHora = 0;
     &enObra = 0;
     &enSubobra = 0;
     &enTraba = 0;
     &enEmpre = 0;
     &enCoste = 0;
     &eaSerPre = "";
     &enNumPre = 0;
     &eaNivel = "";
     &eaCapitulo = "";
     &eaPartida = "";
     &eaDesParti = "";
     fFecha = @;
     aAlfa = "";
     aMes = "";
     nNume = 0;
     nModo = 0;
|FIN;

*****************************************************************************
   RUTINAS DE LA PANTALLA
*****************************************************************************

|PROCESO defecto; |TIPO 7;  || CARGA EL A¥O DE LA FECHA DEL SISTEMA
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % -102;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;

|PROCESO mirames; |TIPO 7;  || CARGA EL MES DE LA FECHA DEL SISTEMA
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
    |PINTA #0Campo;
/*
    meses = meses1 + meses2;
    nume1 = ((#0Campo - 1) * 10) + 1;
    nume1 = (nume1 * 100) + 10;
    alfa1 = nume1;
    alfa1 = meses % alfa1;
    |PINTA 0844, alfa1;
*/
|FPRC;

|PROCESO pintames; |TIPO 0;    || PINTA EL MES EN LETRA
    meses = meses1 + meses2;
    nume1 = ((#0Campo - 1) * 10) + 1;
    nume1 = (nume1 * 100) + 10;
    alfa1 = nume1;
    alfa1 = meses % alfa1;
|PINTA 0944, alfa1;
|FPRC;

|PROCESO primero; |TIPO 7;     || LEE EL PRIMER TRABAJADOR
|DDEFECTO #1;
|ABRE #1;
|LEE 000#1p;
|CIERRA #1;
    #0#3 = #1#0;  |PINTA #0#3;
    #0#4 = #1#1;  |PINTA #0#4;
|FPRC;


|PROCESO Fecha; || Saca el ultimo dia del mes
     fFecha = ~;
     aAlfa = "27." + (("00"+#1#1)%-102) + "." + fFecha % -104;
     fFecha = aAlfa;
     aMes = fFecha % 402;
     |PARA; |SI; |HACIENDO;
          aAlfa = fFecha % 402;
          |SI aAlfa ! aMes; |SAL; |FINSI;
          fFecha = fFecha + 1;
     |SIGUE;
     nNume = fFecha;
     nNume = nNume - 1;
     fFecha = nNume;
|FPRC;

|PROCESO Tipo2; |TIPO 2;
     #0#20 = (#0#5+#0#9+#0#11+#0#17+#0#18)/#0#10;
     |PINTA #0#20;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3; |Y #0#19 = "S";
          |ABRE #2;
          #2#0 = #0#3;
          |LEE 000#2=;
          |SI FSalida = 0;
               enForma = -1;
               |HAZ Fecha;
               efFecha = fFecha;
               enUni = #0#10;
               enHora = 1;
               enObra = #0#2;
               enSubobra = #0#14;
               enEmpre = #0#3;
               enTraba = #0#4 + #2#2;
               enCoste = #0#20;
               eaSerPre = #0#22;
               enNumPre = #0#23;
               eaNivel = #0#25;
               eaCapitulo = #0#26;
               eaPartida = #0#28;
               eaDesParti = #0#29;
               |HAZ ActGestion;
          |FINSI;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO DefParam; |TIPO 7;
     |ABRE #3; |LEE 000#3p; |CIERRA #3;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          #0#25 = #3#4;
          |PINTA #0#25;
     |FINSI;
     |C_M #0#22, 1, "N";
     |C_M #0#23, 1, "N";
     |C_M #0#26, 1, "N";
     |C_M #0#28, 1, "N";
     |SI #3#4 = "C"; |O #3#4 = "P";
          |C_M #0#22, 1, "S";
          |C_M #0#23, 1, "S";
          |C_M #0#26, 1, "S";
     |FINSI;
     |SI #3#4 = "P";
          |C_M #0#28, 1, "S";
     |FINSI;
|FPRC;
