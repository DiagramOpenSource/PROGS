|FICHEROS;
     mod00273 #0;

     mod00261;
     mod00262;

     nomvarca;
     nomvarli;

     gomdetjr;
|FIN;

|VARIABLES;
     nJornadas = 0;
     nTrab = 0;
     aAlfa = "";
     swExistia = 0;
     nCampo = 0;
     FEstado = 0;

     &nAny = 0;
     &nMes = 0;
     &nTopemes = 0;
|FIN;

|PROCESO jornadas;
     |SI #mod00262#5 ! 0;
          nCampo = #mod00262#4;
          nCampo = nCampo + 3;
          #gomdetjr#nCampo# = "X";
     |FINSI;
|FPRC;

|DEFBUCLE jornadas;
     #mod00262#1;
     ;
     #mod00261#0, #mod00261#1, #mod00261#2, #mod00261#3, 01;
     #mod00261#0, #mod00261#1, #mod00261#2, #mod00261#3, 31;
     ;
     NULL, jornadas;
|FIN;

|PROCESO calendario;
     |ABRE #gomdetjr;

     |DDEFECTO #gomdetjr;
     #gomdetjr#0 = #mod00261#0;
     #gomdetjr#1 = #mod00261#1;
     #gomdetjr#2 = #mod00261#2;
     #gomdetjr#3 = #mod00261#3;
     |LEE 101#gomdetjr.=;
     FEstado = FSalida;
     |SI FSalida = 0;
          |PARA nCampo = 4; |SI nCampo [ 34; |HACIENDO nCampo = nCampo + 1;
               #gomdetjr#nCampo# = "";
          |SIGUE;
     |FINSI;

     |BUCLE jornadas;

     |SI FEstado = 0;
          |GRABA 020#gomdetjr.a;
     |SINO;
          |GRABA 020#gomdetjr.n;
     |FINSI;
     |LIBERA #gomdetjr;

     |CIERRA #gomdetjr;
|FPRC;

|PROCESO variaciones;
          #nomvarca#0 = #mod00261#0;
          #nomvarca#1 = #mod00261#1;
          #nomvarca#2 = #mod00261#3;
          #nomvarca#3 = 0;
          |LEE 101#nomvarca.=;
          |SI FSalida ! 0;
               |GRABA 020#nomvarca.n;
          |FINSI;

          aAlfa = nJornadas;
          |QBF aAlfa;
          aAlfa = ("          " + aAlfa) % -110;

          #nomvarli#0 = #mod00261#0;
          #nomvarli#1 = #mod00261#1;
          #nomvarli#2 = #mod00261#3;
          #nomvarli#3 = 0;
          #nomvarli#4 = 903;
          |LEE 101#nomvarli.=;
          |SI FSalida ! 0;
               #nomvarli#5 = aAlfa;
               #nomvarli#6 = "Jornadas";
               |GRABA 020#nomvarli.n;
               nTrab = nTrab + 1;
          |SINO;
               swExistia = 1;
               #nomvarli#5 = aAlfa;
               #nomvarli#6 = "Jornadas";
               |SI #0#7 = "T";
                    |GRABA 020#nomvarli.a;
                    nTrab = nTrab + 1;
               |FINSI;
          |FINSI;

          #nomvarli#0 = #mod00261#0;
          #nomvarli#1 = #mod00261#1;
          #nomvarli#2 = #mod00261#3;
          #nomvarli#3 = 0;
          #nomvarli#4 = 101;
          |LEE 101#nomvarli.=;
          |SI FSalida ! 0;
               #nomvarli#5 = aAlfa;
               #nomvarli#6 = "";
               |GRABA 020#nomvarli.n;
          |SINO;
               #nomvarli#5 = aAlfa;
               #nomvarli#6 = "";
               |SI #0#7 = "T";
                    |GRABA 020#nomvarli.a;
               |FINSI;
          |FINSI;

          |LIBERA #nomvarca;
          |LIBERA #nomvarli;
|FPRC;

|PROCESO mod00262;
     nJornadas = nJornadas + 1;
|FPRC;

|DEFBUCLE mod00262;
     #mod00262#1;
     ;
     #mod00261#0, #mod00261#1, #mod00261#2, #mod00261#3, 01;
     #mod00261#0, #mod00261#1, #mod00261#2, #mod00261#3, 31;
     ;
     NULL, mod00262;
|FIN;

|PROCESO mod00261;
     nJornadas = 0;
     |BUCLE mod00262;

     |SI nJornadas ! 0;
          swExistia = 0;
          |HAZ variaciones;
          |SI swExistia = 0; |O #0#7 = "T";
                |HAZ calendario;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE mod00261;
     #mod00261#1;
     ;
     #0#0, #0#2, #0#4, #0#5;
     #0#1, #0#3, #0#4, #0#5;
     ;
     NULL, mod00261;
|FIN;

|PROGRAMA;
     |CLS;
     |CABEZA "Pase de jornadas a variaciones";
     |PINPA #0#0;
     |ABRE #0;
     |LEE 001#0p;
     |SI FSalida ! 0;
          |DDEFECTO #0;
          |GRABA 020#0n;
     |FINSI;
     |LEE 101#0=;
     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #mod00261;
          |ABRE #mod00262;

          |ABRE #nomvarca;
          |ABRE #nomvarli;

          nAny = #0#4;
          nMes = #0#5;
          |HAZ topemes_plb;

          |BUCLE mod00261;

          |SI nTrab ! 0;
               aAlfa = nTrab;
               |QBF aAlfa;
               aAlfa = "    Se ha realizado el pase a variaciones de " + aAlfa;
               aAlfa = aAlfa + " trabajador";
               |SI nTrab > 1;
                    aAlfa = aAlfa + "es";
               |FINSI;
               |MENAV aAlfa;
          |SINO;
               |MENAV "    No se ha encontrado ningún trabajador para realizar el pase de jornadas";
          |FINSI;

          |CIERRA #nomvarli;
          |CIERRA #nomvarca;

          |CIERRA #mod00262;
          |CIERRA #mod00261;
     |FINSI;

     |GRABA 020#0a;

     |LIBERA #0;
     |CIERRA #0;
|FPRO;
