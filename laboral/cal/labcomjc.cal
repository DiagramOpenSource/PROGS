|FICHEROS;
   labempre #0;
   labtraba #1;
   labcomjc #2;
   labcon00 #3;
   labregis #4;
   labcontr #5;
   nomconca;
|FIN;

|VARIABLES;
 x = 0;
    informe = "labcomjc";
    men1 = "     NO EXISTE REGISTRO DE EMPRESA";
    men2 = "     NO EXISTE REGISTRO DE TRABAJADORES";
    men3 = "     LA FECHA DEBE SER SUPERIOR A 15 DIAS";
    men4 = "     NO EXISTE IMPRESORA";
    men5 = "     ATENCION!!! El contrato registrado no permite ampliacion de jornada ...";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    loca = "";
    loca1 = "";
    &local = "";
    &fcom = "";
    diacom = "";
    mescom = "";
    anycom = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
    calle2 = "";
    &callet = "";
    numcat = "";
    pisot = "";
    &varal = "";
    linea1 = "";
    linea2= "";
    varnum = 0;
    varnum1 = 0;
    guiones = "";
    guion = "-";
    &import = "";
    pueblo = "";

    &desdedia = "";
    &hastadia = "";
    &tipohora = "";
    &pobemp = "";
    &pobtra = "";
    &locafir = "";
    &fechafin = "";
    fFecha1 = @;
    fFecha2 = @;
     aAlfa = "";
     aParam = "";
     nNume = 0;
     &enJorAnt = 0;
     nModo = 0;
|FIN;

|INCLUYE i_comun;

|PROCESO control; |TIPO 7;
|ABRE #5;
|LEE 040#5p;
|CIERRA #5;
    #2#08 = #5#27;
    #2#11 = #5#26;
|PINTA #2#8;
|PINTA #2#11;
|FPRC;

|PROCESO compru1;|TIPO 0;
|ABRE #0;
    #0#0 = #2#0;
     |LEE 040#0=;
       |SI FSalida ! 0;
          |PINTA 0725, "                                        ";
          |MENAV men1;
          |ERROR;
       |SINO;
          |PINTA 0725, #0#2;
       |FINSI;
|CIERRA #0;
|FPRC;

|PROCESO compru2;|TIPO 0;
     |ABRE #1;
     |ABRE #3;
     |ABRE #4;
     #1#0 = #2#0;
     #1#1 = #2#1;
     |LEE 000#1=;
     |SI FSalida ! 0;
          #2#13 = " 1991 / 84";
          #2#14 = "TRABAJO A TIEMPO PARCIAL";
          #2#15 = "";
          |PINTA 0825, "                                        ";
          |MENAV men2;
          |ERROR;
     |SINO;
          |PINTA 0825, #1#2;

          #2#2 = #1#36; |PINTA #2#2;
          #2#12 = #1#34; |PINTA #2#12;

          #2#10 = #1#234;
          |SI #2#10 = 0;
               |ABRE #nomconca;
               #nomconca#0 = #labtraba#87;
               |LEE 000#nomconca.=;
               |SI FSalida ! 0; |O #nomconca#162 = 0;
                    #nomconca#162 = 40;
               |FINSI;
               #2#10 = #nomconca#162;;
               |CIERRA #nomconca;
          |FINSI;
          |PINTA #2#10;

          #2#3 = #2#10; |PINTA #2#3;

          |SI 100 [ #1#45; |Y #1#45 [ 399;
               #2#7 = "TERCERA";
          |SINO;
               #2#7 = "SEGUNDA";
          |FINSI;
          |PINTA #2#7;

          |SELECT #2#4;
          #4#1 = #1#0;
          #4#2 = #1#1;
          |LEE 040#4=;
          |SI FSalida = 0;
               #3#0  = #4#4;
               #2#15 = #4#13;
               #2#31 = #4#14; |PINTA #2#31;
               |LEE 040#3=;
               |SI FSalida = 0;
                    #2#13 = #3#2;
                    #2#14 = #3#1;
               |SINO;
                    #2#13 = " 1991 / 84";
                    #2#14 = "TRABAJO A TIEMPO PARCIAL";
               |FINSI;
               |SELECT #1#4;
          |SINO;
               #2#13 = " 1991 / 84";
               #2#14 = "TRABAJO A TIEMPO PARCIAL";
               #2#15 = "";
          |FINSI;
     |FINSI;
     |PINTA #2#13;
     |PINTA #2#14;
     |PINTA #2#15;



     |CIERRA #1;
     |CIERRA #3;
     |CIERRA #4;
|FPRC;

|PROCESO TextoCambio;
     |SI #labcomjc#3 > #labcomjc#10;
          #labcomjc#17 = "Que debido a la mejor¡a sensible en cuanto al ";
          #labcomjc#18 = "incremento de actividad producida en esta Empresa, es";
          #labcomjc#19 = "necesaria la prestaci¢n de servicios por parte del";
          #labcomjc#20 = "trabajador/a, durante toda la jornada de trabajo.";
     |SINO;
          #labcomjc#17 = "Que debido a un sensible decrecimiento de la actividad";
          #labcomjc#18 = "producida en esta Empresa, es necesaria la reducci¢n";
          #labcomjc#19 = "de horas de trabajo efectivas, adecuando as¡ la ";
          #labcomjc#20 = "prestaci¢n de servicios por parte del trabajador/a";
     |FINSI;
|FPRC;

|PROCESO varios;
    fechacom = #2#9;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
|SI mescom = 01;  fechacom =  uno;    |FINSI;
|SI mescom = 02;  fechacom =  dos;   |FINSI;
|SI mescom = 03;  fechacom = tres;    |FINSI;
|SI mescom = 04;  fechacom = cuatro;  |FINSI;
|SI mescom = 05;  fechacom = cinco;   |FINSI;
|SI mescom = 06;  fechacom = seis;    |FINSI;
|SI mescom = 07;  fechacom = siete;   |FINSI;
|SI mescom = 08;  fechacom = ocho;    |FINSI;
|SI mescom = 09;  fechacom = nueve;   |FINSI;
|SI mescom = 10;  fechacom = diez;    |FINSI;
|SI mescom = 11;  fechacom = once;    |FINSI;
|SI mescom = 12;  fechacom = doce;    |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;

|SI #2#4 = "S"; tipohora = "semanales"; |FINSI;
|SI #2#4 = "D"; tipohora = "diarias  "; |FINSI;
|SI #2#4 = "M"; tipohora = "mensuales"; |FINSI;

|SI #2#5 = "L"; desdedia = "lunes    "; |FINSI;
|SI #2#5 = "M"; desdedia = "martes   "; |FINSI;
|SI #2#5 = "X"; desdedia = "miercoles"; |FINSI;
|SI #2#5 = "J"; desdedia = "jueves   "; |FINSI;
|SI #2#5 = "V"; desdedia = "viernes  "; |FINSI;
|SI #2#5 = "S"; desdedia = "sabado   "; |FINSI;
|SI #2#5 = "D"; desdedia = "domingo  "; |FINSI;


|SI #2#6 = "L"; hastadia = "lunes    "; |FINSI;
|SI #2#6 = "M"; hastadia = "martes   "; |FINSI;
|SI #2#6 = "X"; hastadia = "miercoles"; |FINSI;
|SI #2#6 = "J"; hastadia = "jueves   "; |FINSI;
|SI #2#6 = "V"; hastadia = "viernes  "; |FINSI;
|SI #2#6 = "S"; hastadia = "sabado   "; |FINSI;
|SI #2#6 = "D"; hastadia = "domingo  "; |FINSI;

    pobemp = "";
    pueblo = #0#6; |QBF pueblo;
    pobemp = pueblo;
    pueblo = #0#9; |QBF pueblo;
    pobemp = pobemp + " /" + pueblo + "                              ";
    pobemp = pobemp % 130;

    pobtra = "";
    pueblo = #1#6; |QBF pueblo;
    pobtra = pueblo;
    pueblo = #1#10; |QBF pueblo;
    pobtra = pobtra + " /" + pueblo;

    pueblo = #2#8; |QBF pueblo;
    pueblo = "               " + pueblo;
    locafir = pueblo % -115;

    fFecha1 = #4#8;
    fFecha2 = #4#20;

    |SI fFecha2 > fFecha1;
         fechafin = #4#20;
    |SINO;
         fechafin = #4#8;
    |FINSI;
|FPRC;

|PROCESO impre;
||TIPO 3;
     |HAZ r_regis0;   r_emp = #2#0;  |HAZ r_regis1;
     Impresora = "CrystalReport"
     |IMPRE -1;
     |SI FSalida = 0;
          |HAZ varios;
          |SI Impresora = "CrystalReport"
               #2#11 = 1;
          |FINSI;
          |PARA x = 1;|SI x [ #2#11;|HACIENDO x = x + 1;
               |INFOR informe;
               |PRINT;
               |PIEINF;
               |FININF;
          |SIGUE;
     |SINO;
          |MENAV men4;
     |FINSI;
     |FINIMP;
|FPRC;

|PROCESO tipo3; |TIPO 12;
     |SI FSalida = 7; |ACABA; |FINSI;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O nModo = 2; |O enJorAnt ! 0;
          |CONFI "    S¿Desea imprimir el documento de cambio de jornada?";
          |SI FSalida = 0;
               |HAZ impre;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Impresion; |TIPO 20;
     aAlfa = FSalida;
     |SI FSalida = "OPCION";
          FSalida = "Imprimir";
     |SINO;
          |HAZ impre;
     |FINSI;
|FPRC;

/*
|PROGRAMA;
     aParam = PARAMETRO;
     |QBF aParam;
     |SI aParam ! "";
          |CAMPO_MODIFICA #2#0, 1, "N";
          |CAMPO_MODIFICA #2#1, 1, "N";

          aAlfa = aParam % 105;
          nNume = aAlfa;
          #2#0 = nNume;

          aAlfa = aParam % -105;
          nNume = aAlfa;
          #2#1 = nNume;

          |HAZ compru1;
          |HAZ compru2;
          |HAZ control;

          #2#10 = enJorAnt;
     |FINSI;

     |CLS;
     |PINPA #0#2;
     |PINDA #0#2;

     |ENDATOS #1#2;

     |SI FSalida = 0;
          |HAZ impre;
     |FINSI;
|FPRO;
*/
