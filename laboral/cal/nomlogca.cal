|FICHEROS;
     nomlogca #0;
     nomlogli #100;
|FIN;

|VARIABLES;
     swGraba = 0;
     nNume = 0;
     aAlfa1 = "";
     nOpcion = 0;
     nHasta = 0;
     {-1}menu = "";
     menu1 = "2400";
     menu2 = "1";
     menu3 = "Elegir Opcion:";
     menu4 = "ASETC";
     menu5 = "Anterior";
     menu6 = "Siguiente";
     menu7 = "Informe Errores";
     menu8 = "Informe Todos";
     menu9 = "Cancelar";
     &nContLog = 0;
|FIN;

|PROCESO Imprime;
     |PRINT;
|FPRC;

|DEFBUCLE InformeLog;
     #nomlogli#1;
     ;
     #nomlogca#0, 00001, 00001, 001, 00, 0;
     #nomlogca#0, 99999, 99999, nHasta, 12, 9;
     ;
     NULL, Imprime;
|FIN;

|PROCESO InformeLog;
     |IMPRE 0;
     |SI FSalida = 0;
          |INFOR "nomcalog";
          |SI nOpcion = 3;
               nHasta = 998;
          |SINO;
               nHasta = 999;
          |FINSI;
          |BUCLE InformeLog;
          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRC;

|PROCESO min;
     #100#0 = #0#0;
     #100#1 = 1;
     #100#2 = 1;
     #100#3 = 001;
     #100#5 = 00;
     #100#6 = 0;
|FPRC;

|PROCESO max;
     #100#0 = #0#0;
     #100#1 = 99999;
     #100#2 = 99999;
     |SI PARAMETRO ! "";      || desde nomina
          #100#3 = 998;
     |SINO;
          #100#3 = 999;
     |FINSI;
     #100#5 = 12;
     #100#6 = 9;
|FPRC;

|PROCESO DesdeNomina;
     #0#0 = nContLog;
     |PINPA #0#0;
     |LEE 000#0=;
     |SI FSalida = 0;
          menu1 = "2400";
          menu2 = "1";
          menu3 = "Elegir Opcion:";
          menu4 = "ETS";
          menu5 = "Informe Errores";
          menu6 = "Informe Todos";
          menu7 = "Salir";
          menu8 = "";
          menu9 = "";

          |PINDA #0#0;
          |PARA; |SI; |HACIENDO;
               |ENTLINEAL #1#nomlogli,2,4,22,1,min,max;
               |MENU menu;
               nOpcion = FSalida;
               |SI FSalida = 1; |O FSalida = 2;
                    nOpcion = FSalida;
                    nOpcion = nOpcion + 2;
                    |HAZ InformeLog;
               |FINSI;
               |SI FSalida = 3;
                    |SAL;
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #0;
     |SI PARAMETRO ! "";
          |HAZ DesdeNomina;
          |ACABA;
     |FINSI;
     |PINPA #0#0; |PINDA #0#0;
     |ET Empieza;
     |ENCAMPO #0#0;
     |SI FSalida = 1; |O FSalida = 7;
          |ACABA;
     |FINSI;
     |LEE 101#0=;
     |SI FSalida ! 0;
          |MENAV "    Registro no existe";
          nOpcion = 0;
          |VETE Empieza;
     |SINO;
          |PARA; |SI FSalida = 0; |HACIENDO;
               |ET ElMenu;
               |SI FSalida = 0;
                    |PINDA #0#0;
                    |ENTLINEAL #1#nomlogli,2,4,22,1,min,max;
                    |MENU menu;
                    nOpcion = FSalida;

                    |SI nOpcion = 1;
                         |LEE 101#0a;
                         menu2 = "1";
                         |VETE ElMenu;
                    |FINSI;
                    |SI nOpcion = 2;
                         |LEE 101#0s;
                         menu2 = "2";
                         |VETE ElMenu;
                    |FINSI;
                    |SI FSalida = 3; |O FSalida = 4;
                         |HAZ InformeLog;
                    |FINSI;
                    |SI FSalida = 5;
                         |VETE Empieza;
                    |FINSI;
               |SINO;
                    |SI nOpcion = 1;
                         |MENAV "    Primer Registro";
                    |SINO;
                         |SI nOpcion = 2;
                              |MENAV "    Ultimo Registro";
                         |SINO;
                              |MENAV "    Registro no encontrado";
                         |FINSI;
                    |FINSI;
                    |VETE Empieza;
               |FINSI;
          |SIGUE;
     |FINSI;
     |CIERRA #0;
|FPRO;
