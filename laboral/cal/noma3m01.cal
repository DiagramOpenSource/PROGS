|FICHEROS;
     noma3m01 #0;
     noma3m02,MANTE;
     labtraba;
     nomcateg;
|FIN;

|VARIABLES;
     &nModo = 0;
     nModo2 = 0;
     nForma = 0;
     FEstado = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     aMensa = "";
|FIN;

|PROCESO RecargaCat;
     #nomcateg#0 = #0#0;
     #nomcateg#1 = #labtraba#17;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          |DDEFECTO #noma3m02;
          #noma3m02#0 = #nomcateg#0;
          #noma3m02#1 = #nomcateg#1;
          |LEE 000#noma3m02.=;
          |SI FSalida ! 0;
               #noma3m02#0 = #nomcateg#0;
               #noma3m02#1 = #nomcateg#1;
               #noma3m02#2 = #nomcateg#2;
               #noma3m02#3 = 000;
               #noma3m02#4 = #0#1;
               |GRABA 020#noma3m02.n;
               |LIBERA #noma3m02;
          |FINSI;
     |FINSI;
|FPRC;
/*
|DEFBUCLE RecargaCat;
     #nomcateg#1;
     ;
     #0#0, 000;
     #0#0, 999;
     be;
     NULL, RecargaCat;
|FIN;
*/

|DEFBUCLE RecargaCat;
     #labtraba#8;
     87;
     "A", 00001, 00001, #0#0;
     "A", 99999, 99999, #0#0;
     be;
     NULL, RecargaCat;
|FIN;

|PROCESO RegrabaCat;
     #nomcateg#0 = #noma3m02#0;
     #nomcateg#1 = #noma3m02#1;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          |SI #noma3m02#2 ! #nomcateg#2;
               #noma3m02#2 = #nomcateg#2;
               |GRABA 020#noma3m02.a;
          |FINSI;
     |SINO;
          aAlfa1 = #noma3m02#1; aAlfa1 = "000" + aAlfa1; aAlfa1 = aAlfa1 % -103;
          aAlfa2 = #noma3m02#2;
          |QBF aAlfa2;
          |SI aAlfa2 ! "";
               aAlfa2 = " - " + aAlfa2;
          |FINSI;
          aMensa = "    ATENCION: La categoría " + aAlfa1 + aAlfa2 + " no existe en ";
          aMensa = aMensa + "las categorías del convenio."
          |MENAV aMensa;
          aMensa = "    Será eliminada de este mantenimiento";
          |MENAV aMensa;
          ||CONFI aMensa;
          ||SI FSalida = 0;
               |BORRA 020#noma3m02.a;
          ||FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE RegrabaCat;
     #noma3m02#1;
     ;
     #0#0, 000;
     #0#0, 999;
     be;
     NULL, RegrabaCat;
|FIN;

|PROCESO Recarga;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #noma3m02;
          |ABRE #nomcateg;
          |BUCLE RecargaCat;
          |CIERRA #nomcateg;
          |CIERRA #noma3m02;
     |FINSI;
/*
     |SI nModo = 2;
          |ABRE #noma3m02;
          |BUCLE RegrabaCat;
          |CIERRA #noma3m02;
     |FINSI;
*/
|FPRC;
