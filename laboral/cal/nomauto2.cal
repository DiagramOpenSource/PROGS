|FICHEROS;
     nomauto2 #2;
|FIN;

|VARIABLES;
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     nBase = 0;
     nCuota = 0;
     nMes = 0;
     nAny = 0;
     nMesVigor = 0;
     nCampoVigor = 0;
     nNuevaCuota = 0;
     nNuevaBase = 0;
     fFecha = @;
     aFecha = "";
     aAny = "";
     nModo = 0;
     &nCuotaAuto = 0;
|FIN;

|PROCESO Totales; |TIPO 2;
     #2#31 = 0;
     #2#32 = 0;
     |PARA nCampo = 3; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 2;
          nCampo1 = nCampo;
          nCampo2 = nCampo + 1;
          #2#31 = #2#31 + #2nCampo1
          #2#32 = #2#32 + #2nCampo2
     |SIGUE;
     |PINTA #2#31;
     |PINTA #2#32;
     nCuotaAuto = #2#32;
|FPRC;

|PROCESO Copia; |TIPO 0;
     |SI FSalida ! 13; |Y FSalida ! 14;
          |ACABA;
     |FINSI;
     #2#31 = 0;
     #2#32 = 0;
     nAny = #2#2;

     |SI FSalida = 14;
          |SALVA_FICHA #2;
          nMesVigor = 0;
          nCampoVigor = 0;
          nNuevaBase = 0;
          nNuevaCuota = 0;
          #2#2 = #2#2 - 1;
          |LEE 000#2=;
          |SI FSalida = 0;
               nBase = #2#25;
               nCuota = #2#26;
               |SI #2#30 = nAny;
                    |SI #2#29 ! 0;
                         nMesVigor = #2#29;
                         |SI nMesVigor ! 0;
                              nCampoVigor = (nMesVigor * 2) + 1;
                              nNuevaBase = #2#27;
                              nNuevaCuota = #2#28;
                         |FINSI;
                    |FINSI;
               |FINSI;
          |FINSI;
          |REPON_FICHA #2;
     |SINO;
          |SI Campo = 3;
               nCampo1 = Campo;
               nCampo2 = Campo + 1;
          |SINO;
               nCampo1 = Campo - 1;
               nCampo2 = Campo;
          |FINSI;
          nBase = #2nCampo1;
          nCuota = #2nCampo2;
     |FINSI;

     |SI Campo = 3;
          nCampo1 = Campo;
          nCampo2 = Campo + 1;
     |SINO;
          nCampo1 = Campo - 1;
          nCampo2 = Campo;
     |FINSI;


     |PARA nCampo = 3; |SI nCampo [ 26; |HACIENDO nCampo = nCampo + 2;
          nCampo1 = nCampo;
          nCampo2 = nCampo + 1;
          |SI nCampoVigor ! 0; |Y nCampo ] nCampoVigor;
               #2nCampo1 = nNuevaBase;
               #2nCampo2 = nNuevaCuota;
          |SINO;
               #2nCampo1 = nBase;
               #2nCampo2 = nCuota;
          |FINSI;
          #2#31 = #2#31 + #2nCampo1;
          #2#32 = #2#32 + #2nCampo2;
          |PINTA #2nCampo1;
          |PINTA #2nCampo2;
     |SIGUE;
     |PINTA #2#31;
     |PINTA #2#32;
     nCuotaAuto = #2#32;
|FPRC;
