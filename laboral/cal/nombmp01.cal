|FICHEROS;
     nombmp01 #0;
     nombmp02 #1;
     labtraba #2;
|FIN;

|VARIABLES;
     &pasa     = "";
     &orden    = "";
     &tem      = "";
     &p1       = 0;
     &p2       = 0;
     orden1    = "";
     orden2    = "";
     es        = "";
     base      = "";
     alfa      = "";
     sistema   = "";
     fichero   = "";
     modo      = 0;
|FIN;
||---------------------------------------------------------------------------
|PROCESO tecla; |TIPO 11;
     || EDITAR IMAGEN........................................................
     |SI FSalida = 15;
          |DBASE base;
          fichero = base + "imagenes/";
          |MKDIR fichero;
          fichero = fichero + #0#2;
          |QBF fichero;

          |SI #1#3 = "S"; |HAZ desco; |FINSI;     || DESCOMPRIME IMAGEN.

          alfa = #1#4;
          |QBF alfa;
          alfa = alfa + " " + fichero;
          |QBF alfa;
          |SYSTEM alfa;

          |SI #1#3 = "S"; |HAZ compr; |FINSI;     || COMPRIME IMAGEN.

          |ERROR;
     |FINSI;
     || VER IMAGEN...........................................................
     |SI FSalida = 16;
          p1 = #0#4;
          p2 = #0#5;
          tem = #0#2;
          |QBF tem;
          |SUB_EJECUTA "nombmp00";

          |SI p1 ! 0; #0#4 = p1; |FINSI;
          |SI p2 ! 0; #0#5 = p2; |FINSI;
          |GRABA 020#0a;

          |ERROR;
     |FINSI;
|FPRC;

||---------------------------------------------------------------------------

|PROCESO mini;
     #0#0 = orden1;
     #0#1 = 001;
|FPRC;

|PROCESO maxi;
     #0#0 = orden2;
     #0#1 = 999;
|FPRC;

|PROGRAMA;
     |DDEFECTO #1;
     |ABRE #1;
     #1#0 = 1;
     |LEE 000#1=;
     |SI FSalida ! 0;
          |MENAV "    <Utilidades/Configurar Imagenes> sin definir, aplicando predeterminados";
     |FINSI;
     |CIERRA #1;

     es = pasa;
     |SI pasa = "E";
          orden1 = (orden % 105) + "00000";
          orden2 = (orden % 105) + "99999";
     |FINSI;
     |SI pasa = "T";          || trabajadores
          orden1 = orden;
          orden2 = orden;
     |FINSI;

     |ENTLINEAL #1#0, 2, 2, 12, 1, mini, maxi;
|FPRO;

||---------------------------------------------------------------------------

|PROCESO ccc; |TIPO 6;
     |SI p1 ! 0; #0#4 = p1; |FINSI;
     |SI p2 ! 0; #0#5 = p2; |FINSI;
     #0#6 = es;
|FPRC;

|PROCESO nombre; |TIPO 7;
     alfa = #0#2;
     |QBF alfa;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1;|Y alfa = "";
          |ABRE #2;
          alfa = #0#0 % 105;  #2#0 = alfa;
          alfa = #0#0 % 605;  #2#1 = alfa;
          |LEE 000#2=;
          |CIERRA #2;
          #0#2 = #2#7;   |PINTA #0#2;
          #0#3 = #2#2;   |PINTA #0#3;
     |FINSI;
     |SI modo = 1;
          #0#4 = #1#1;
          #0#5 = #1#2;
     |FINSI;
|FPRC;

||---------------------------------------------------------------------------
|| COMPRIME Y DESCOMPRIME LAS IMAGENES.
||---------------------------------------------------------------------------
|PROCESO compr;
     |COMPRIME fichero;
     |SI FSalida = 0;
          |FBORRA fichero;
     |SINO;
          |MENAV "0000No se pudo comprimir el fichero de la imagen ...";
     |FINSI;
|FPRC;

|PROCESO desco;
     |DESCOMPRIME fichero;
     alfa = fichero + ".bmp";
     |COPIA_FICHERO fichero, alfa;
     |FBORRA fichero;
|FPRC;
