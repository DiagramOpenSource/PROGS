|FICHEROS;
     zominf03 #0;
     nomcalca #1;
     nomhicca;
     labtraba #2;
     labempre #3;
     labcentr;
|FIN;

|VARIABLES;
     &aDesde = "";
     &nBase1 = 0;
     &nBase2 = 0;
     &nBase3 = 0;
     &nTipo1 = 0;
     &nTipo2 = 0;
     &nTipo3 = 0;
     &nTipo = 0;

     nDesdeMes = 0;
     nHastaMes = 0;
     nDesdeAny = 0;
     nHastaAny = 0;

     &nAny = 0;
     &nMes = 0;
     &nDiasERE = 0;
     &nDiasEREBon = 0;
     &nBonifERE = 0;

     nNume = 0;
     nEmp = 0;
     nTra = 0;
|FIN;

/*
|PROCESO imprime;
     |SI aDesde = "M";
          nBase1 = #nomcalca#14;
          nBase2 = #nomcalca#69;
          nBase3 = #nomcalca#70;
          nTipo1 = #nomcalca#13;
          nTipo2 = #nomcalca#67;
          nTipo3 = #nomcalca#68;
          nTipo = #nomcalca#3;
          |SI #nomcalca#69 ! 0;
               |SI #nomcalca#67 ! #nomcalca#13;
                    #labtraba#0 = #nomcalca#0;
                    #labtraba#1 = #nomcalca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
          |SI #nomcalca#70 ! 0;
               |SI #nomcalca#68 ! #nomcalca#13;
                    #labtraba#0 = #nomcalca#0;
                    #labtraba#1 = #nomcalca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aDesde = "H";
          nBase1 = #nomhicca#14;
          nBase2 = #nomhicca#108;
          nBase3 = #nomhicca#109;
          nTipo1 = #nomhicca#13;
          nTipo2 = #nomhicca#106;
          nTipo3 = #nomhicca#107;
          nTipo = #nomhicca#3;

          |SI #nomhicca#108 ! 0;
               |SI #nomhicca#106 ! #nomhicca#13;
                    #labtraba#0 = #nomhicca#0;
                    #labtraba#1 = #nomhicca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
          |SI #nomhicca#109 ! 0;
               |SI #nomhicca#107 ! #nomhicca#13;
                    #labtraba#0 = #nomhicca#0;
                    #labtraba#1 = #nomhicca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;
*/

|PROCESO imprime;
     |SI aDesde = "M";
          nEmp = #nomcalca#0;
          nTra = #nomcalca#1;
     |FINSI;
     |SI aDesde = "H";
          nEmp = #nomhicca#0;
          nTra = #nomhicca#1;
     |FINSI;

     |SI nEmp = 601;
          |SI nTra = 11; |O nTra = 25; |O nTra = 37; |O nTra = 71; |O nTra = 76;
          |O nTra = 20011; |O nTra = 80011; |O nTra = 90005; |O nTra = 90026;
          |O nTra = 90027; |O nTra = 90029;
               |ACABA;
          |FINSI;
     |FINSI;

     |SI nEmp = 602;
          |SI nTra = 40; |O nTra = 45; |O nTra = 71; |O nTra = 73; |O nTra = 75;
          |O nTra = 76;
               |ACABA;
          |FINSI;
     |FINSI;

     |SI aDesde = "M";
          nBase1 = #nomcalca#14;
          nBase2 = #nomcalca#69;
          nBase3 = #nomcalca#70;
          nTipo1 = #nomcalca#13;
          nTipo2 = #nomcalca#67;
          nTipo3 = #nomcalca#68;
          nTipo = #nomcalca#3;
          |SI #nomcalca#69 ! 0;
               |SI #nomcalca#67 ! #nomcalca#13;
                    #labtraba#0 = #nomcalca#0;
                    #labtraba#1 = #nomcalca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
          |SI #nomcalca#70 ! 0;
               |SI #nomcalca#68 ! #nomcalca#13;
                    #labtraba#0 = #nomcalca#0;
                    #labtraba#1 = #nomcalca#1;
                    |LEE 000#labtraba.=;
                    |PRINT;
                    |ACABA;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aDesde = "H";
          nBase1 = #nomhicca#14;
          nBase2 = #nomhicca#108;
          nBase3 = #nomhicca#109;
          nTipo1 = #nomhicca#13;
          nTipo2 = #nomhicca#106;
          nTipo3 = #nomhicca#107;
          nTipo = #nomhicca#3;

          nDiasERE = #nomhicca#119;
          nDiasEREBon = #nomhicca#168;
          nBonifERE = #nomhicca#167;

          nAny = #nomhicca#66 + 2000;
          nMes = #nomhicca#2;

          #labempre#0 = #nomhicca#0;
          |LEE 000#labempre.=;

          #labtraba#0 = #nomhicca#0;
          #labtraba#1 = #nomhicca#1;
          |LEE 000#labtraba.=;

          #labcentr#0 = #labtraba#0;
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;

          |SI nDiasERE > 0;
               |PRINT;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#2, nDesdeAny, nDesdeMes, 0;
     #0#1, #0#3, nHastaAny, nHastaMes, 0;
     ;
     NULL, imprime;
|FIN;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #0#0, #0#2, #0#4, 0;
     #0#1, #0#3, #0#5, 0;
     ;
     NULL, imprime;
|FIN;

|PROCESO Busca;
     aDesde = "M";
     ||BUCLE nomcalca;

     aDesde = "H";

     |SI #0#6 ! #0#7;
          nDesdeAny = #0#6 - 2000;
          nHastaAny = #0#6 - 2000;
          nDesdeMes = #0#4;
          nHastaMes = 12;
          |BUCLE nomhicca;

          nNume = #0#7 - #0#6;
          |SI nNume ! 1;
               nDesdeAny = #0#6 - 2000 + 1;
               nHastaAny = #0#7 - 2000 - 1;
               nDesdeMes = 01;
               nHastaMes = 12;
               |BUCLE nomhicca;
          |FINSI;

          nDesdeAny = #0#7 - 2000;
          nHastaAny = #0#7 - 2000;
          nDesdeMes = 01;
          nHastaMes = #0#5;
          |BUCLE nomhicca;
     |SINO;
          nDesdeAny = #0#6 - 2000;
          nHastaAny = #0#7 - 2000;
          nDesdeMes = #0#4;
          nHastaMes = #0#5;
          |BUCLE nomhicca;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          Impresora = "CrystalReport";
          |IMPRE -1;
          |SI FSalida = 0;
               |INFOR "zominf03";
               |ABRE #nomcalca;
               |ABRE #nomhicca;
               |ABRE #labempre;
               |ABRE #labtraba;
               |ABRE #labcentr;
               |HAZ Busca;
               |CIERRA #labcentr;
               |CIERRA #labtraba;
               |CIERRA #labempre;
               |CIERRA #nomhicca;
               |CIERRA #nomcalca;
               |PIEINF;
               |FININF;
          |FINSI;
          |FINIMP;
     |FINSI;
|FPRO;
