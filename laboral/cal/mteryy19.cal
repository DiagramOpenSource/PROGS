|FICHEROS;
    mteryy19 #0;    || emision TC1
    labempax #2;    || aux. empresas
    nomtepig #4;    || aux. epigrafes
    mter0001;       || Datos Local de Actuacion
|FIN;

|VARIABLES;
    menos = 0;
    &aCC = "";
|FIN;

|INCLUYE i_tempo;
|INCLUYE i_cuadr;
|INCLUYE i_reco1;
||INCLUYE i_verif;
||INCLUYE i_seguim;
|INCLUYE i_1ytc1;
____________________________________/ CALCULOS DE PANTALLA
|PROCESO defecto; |TIPO 7;
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % -104;
    #0Campo = alfa1;
    #0Campo = #0Campo - menos;
|PINTA #0Campo;
|FPRC;

|PROCESO pintames; |TIPO 0;
|SI #0Campo =  1;  p_mes = "ENERO     ";  |FINSI;
|SI #0Campo =  2;  p_mes = "FEBRERO   ";  |FINSI;
|SI #0Campo =  3;  p_mes = "MARZO     ";  |FINSI;
|SI #0Campo =  4;  p_mes = "ABRIL     ";  |FINSI;
|SI #0Campo =  5;  p_mes = "MAYO      ";  |FINSI;
|SI #0Campo =  6;  p_mes = "JUNIO     ";  |FINSI;
|SI #0Campo =  7;  p_mes = "JULIO     ";  |FINSI;
|SI #0Campo =  8;  p_mes = "AGOSTO    ";  |FINSI;
|SI #0Campo =  9;  p_mes = "SEPTIEMBRE";  |FINSI;
|SI #0Campo = 10;  p_mes = "OCTUBRE   ";  |FINSI;
|SI #0Campo = 11;  p_mes = "NOVIEMBRE ";  |FINSI;
|SI #0Campo = 12;  p_mes = "DICIEMBRE ";  |FINSI;
|PINTA 1236, p_mes;
|FPRC;

|PROCESO mirames; |TIPO 7; ||calcula el mes por defecto segun fecha sistema
    fecsys = ~;
    alfa1 = fecsys;
    alfa1 = alfa1 % 402;
    #0Campo = alfa1;
    #0Campo = #0Campo - 1;
    menos = 0;
|SI #0Campo = 0;
        #0Campo = 12;
        menos = 1;
|FINSI;
|PINTA #0Campo;
|FPRC;

____________________________________/ DATOS DEL LOCAL DE ACTUACION Y INFORME
|PROCESO DatosLocal;
     |ABRE #mter0001;
     #mter0001#0 = #labempre#0;
     |LEE 000#mter0001.=;
     |CIERRA #mter0001;
     c_informe = "mtertc19";
|FPRC;

____________________________________/ ACTUALIZACION IMPORTES TC1 EMPRESA
|PROCESO graba_tc12;
    #1#0 = emp_ant;
|LEE 101#1=;
|SI FSalida = 0;
        nume1 = #0#2 + 113;
        #1nume1 = total;
    |GRABA 020#1a;
|FINSI;
|LIBERA #1;

    total = 0;
    emp_ant = #2#0;
|FPRC;

|PROCESO graba_tc11;
|SI #2#2 !  5;|Y #2#2 !  6;|Y #2#2 !  7;     || solo los del mes
 |Y #2#2 ! 15;|Y #2#2 ! 16;|Y #2#2 ! 17;

    |SI emp_ant = -1;   emp_ant = #2#0;     |FINSI;

    |SI emp_ant ! #2#0;
        |HAZ graba_tc12;
    |FINSI;
        total = total + #2#20;

|FINSI;
|FPRC;

|PROCESO graba_tc10;
    emp_ant = -1;
    total = 0;
|FPRC;

|DEFBUCLE graba_tc1;
 #2#1;
 ;
 #0#0,  0, #0#2,  0;
 #0#1, 99, #0#2, 19;
 ;
 graba_tc10, graba_tc11, NULL, NULL, graba_tc12;
|FIN;

|PROCESO actua_empresa;
|ABRE #1;
|BUCLE graba_tc1;
|CIERRA #1;
|FPRC;
____________________________________/ CALCULO PRINCIPAL DE LECTURA DE AUX.
|DEFBUCLE auxiliar;
 #2#1;
 50;
 #0#0, #0#4, #0#2, tip3, "G";
 #0#1, #0#5, #0#2, tip3, "G";
 ;
 NULL, empresa, NULL, NULL, sacalo;
|FIN;

|PROCESO lecturas;
|PARA tip2 = 0; |SI tip2 [ 10; |HACIENDO tip2 = tip2 + 10;
    |SI tip2 = 0;   liqu = #0#6;   |FINSI;
    |SI tip2 = 10;  liqu = #0#9;   |FINSI;
    |SI #0#10 = "T";|O #0#10 = "R";
        emp_ant = -1;   cen_ant = -1;
        tip = 0;    tip3 = tip + tip2;
        aCC = "";
        hay_algo = 0;   |BUCLE auxiliar;     || todos
    |FINSI;

    |SI #0#10 = "T";|O #0#10 = "F";
        emp_ant = -1;   cen_ant = -1;
        tip = 2;    tip3 = tip + tip2;
        |SI tip3 = 2;
            aCC = "4 1 5";
        |SINO;
            aCC = "";
        |FINSI;
        hay_algo = 0;   |BUCLE auxiliar;     || finiquitos
    |FINSI;

    |SI #0#10 = "T";|O #0#10 = "A";
        emp_ant = -1;   cen_ant = -1;
        tip = 8;    tip3 = tip + tip2;
        aCC = "";
        hay_algo = 0;   |BUCLE auxiliar;     || aprendizaje
    |FINSI;

    |SI #0#10 = "T";|O #0#10 = "P";
        emp_ant = -1;   cen_ant = -1;
        tip = 9;    tip3 = tip + tip2;
        aCC = "";
        hay_algo = 0;   |BUCLE auxiliar;     || tiempo parcial
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO impre; |TIPO 3;
|MODULO runnom;
    el_period = #0#3 $ 100;
|HAZ principal;
|FPRC;
____________________________________/ LECTURA DE EPIGRAFES
|DEFBUCLE nomyytc11;
 #4#1;
 ;
 #2#0, #2#18, #0#2,   0, tip3;
 #2#0, #2#18, #0#2, 999, tip3;
 ;
 losseis1, losseis2, NULL, NULL, losseis3;
|FIN;

|PROCESO leepitrab;
|HAZ DatosLocal;
|BUCLE nomyytc11;
|HAZ LaCuota;
|FPRC;
