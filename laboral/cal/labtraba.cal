|FICHEROS;
     labtraba #0;
     labempre #1;         || empresas
     labcentr #2;         || centros
     nomcateg #3;         || categorias
     nomcenes #5;         || centros especiales
     nomregim #6;         || regimenes
     nompanta #50;        || pantallas de avisos
     nomconst;
     nomconli,MANTE;
     temp0001@ #500;
     temp0002@ #501
     nomtraju,MANTE;
     nombotra #51,MANTE;

     :/modelos/def/dsmom073;        || claves perceptoras
     :/basica/def/agidanif #200;

     &bancosc@  #709;
     &regisnif@ #712;
     nomconca;

     labtabla #100;
     labtmpct #101;
     tdpmunic #102;
     labmunic #104;
     labvaltb;
     nomauto1,MANTE;
     nomhicca;
     labclean;
     labtraba;
     labtracu;
     nomcnaec;
     nomocupa;
     taiclaoc;
     labor001;
     labpadre;

     || nomcatli;
     nomcal01,MANTE;
     ett00002,MANTE;

     nombonif;
     nomir003;
     nomcontr;

     nomtrata;            || constantes por contrato cab
     nomtrato;            || constantes por contrato lin
     nomtrap1;            || constantes por contrato cab PATRONES
     nomtrap2;            || constantes por contrato lin PATRONES
     labprafo,MANTE;
     motibaja;
     nomw0021,MANTE;
     nomhortp,MANTE;

     nomvarca;
     model111@;   || modelo 111
|FIN;

|VARIABLES;
    nfEntrada = 0;
    nEntrada  = 0;
    nFEntradaReal = 0;

    dias18 = 0;
    mod = 0;
    anterior = 0;
    xx = 0;
    irpf = 0;
    rete = 0;
    dtos = 0;
    exen = 0;
    nume2 = 0;
    lugar = 0;
    nifnum = 0;
    resto = 0;
    corta = 0;
    nume3 = 0;
    jg = 0;
    sitio = 0;
    anynac2 = 0;
    mesnac2 = 0;
    dianac2 = 0;
    anyact2 = 0;
    mesact2 = 0;
    diaact2 = 0;
    edadxxx = 0;
    baja = 0;
    fiac = "  ";
    aponer = "  ";
    relleno = "                              ";
    men1 = "0000ATENCION !!! Fecha erronea";
    men2 = "0000Debera cumplimentar este campo !!!";
    men3 = "0000ATENCION !!! Centro de Trabajo asignado inexistente ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    dia = 0;
    mes = 0;
    any = 0;
    tope = 0;
    sw = 0;
    fec = "";
    blanco = "          ";
    puntos = "..........";
    fecsys = @;
    fecnum = 0;
    nacnum = 0;
    edanum = 0;
    espaci = "               ";
    alfa   = "";
    alfa1  = "";
    alfa2  = "";
    alfa3  = "";
    alfa4  = "";
    alfa5  = "";
    alfa6  = "";
    fechtra = "";
    sistema = @;
    anynac1 = "";
    anyact1 = "";
    mesnac1 = "";
    mesact1 = "";
    dianac1 = "";
    diaact1 = "";
    guarda = "";
    nume1 = 9999999999;
    s_t = 0;
    &em_borr = 0;
    &tr_borr = 0;
    modo = 0;
    modito = 0;
    FEstado = 0;
    sw_clave = 0;
    inkey = 0;
    sw_abrevia = 0;
    aAlfa1 = "";
    aAlfa2 = "";
    aAlfa3 = "";
    aAlfa4 = "";
    &orden = "";
    &pasa = "";
    aFabre = "";
     aDef = "";

     nClave = 0;
     nSubCl = 0;
     nEnEsp = 0;
     nReper = 0;
     &nModo  = 0;
     &nModoReal = 0;

     &enCodBanco = 0;
     &eaVarDni   = "";
     &enCalcCif  = 0;
     &eaCodNif   = "";
     nNume = 0;
     nPos1 = 0;
     nPos2 = 0;
     nCampo = 0;
     nCampo1 = 0;
     nAntes = 0;
     aEmp_borr   = "";
     aTra_borr   = "";
     &eaVengoDe = "";
     &nTecla = 0;
     nPulsado = 0;
     nSwUno = 0;
     &aCodPos = "";
     aCodigoMunicipio = "";
     aLong = "";
     nCalc = 0;
     nCalc1 = 0;
     nCalc2 = 0;
     aAlfa = "";
     swExisteHco = 0;
     &swModulo = 0;
     nContrato = 0;
     nConstante = 0;
     &nEmp = 0;
     &nTra = 0;
     &aAnt = "";
     &nEnEmpresa = 0;
     &nBonif = 0;

     swExiste = 0;
     aNacidoEn = "";
     aSexo = "";
     aPadre = "";
     aMadre = "";
     aNroAfi = "";
     nBanco = 000;
     aCuenta = "";
     aCuentaTra = "";
     aFormaPago = "";
     aTrab = "";

     &enEmpresa    = 0;
     &enTrabajador = 0;
     fFecha = @;
     &nElAny = 0;
     &nElMes = 0;

     &nOpcionPLB = 0;
     FArchivo = "";
     swSigue = 0;
     &swConsulta = 0;
     &enPintaLoc = 0;
     aAntLoc = "";
     &eaEmail = "";
     &nArchi = 0;
     fFechaAnt = @;
     fFechaAlta = @;
     fFechaFor = @;

     &enEmp = 0;
     &enTra = 0;
     &enNom = "";
     &eaNIF = "";
     &eaAlta = "";
     &eaBaja = "";
     &eaContrato = "";
     &enOpcion = 0;
     &nMedia90 = 0;
     &nAltaFechaRef = 0;
     &enParada = 0;
     enBoton = 0;
     enBotonOpt = 0;
     enBotonHis = 0;
     &enCambiaEmp = 0;
     &enCambiaTra = 0;
     &nOpcion = 0;
     swBotonSiNo = 0;
     &eaProcedencia = "labtraba";
     &eaNif = "";
     nAny = 0;
     nAnyHis = 0;
     swAviso = 0;
     nMes110 = 0;
     nTipo110 = 0;
     swUnoIgual = 0;
     swPush = 0;
     swF5 = 0;
     aAntes = "";
     nDesdeEmp = 0;
     nHastaEmp = 0;
     nDesdeTra = 0;
     nHastaTra = 0;
     aMas      = "";
     nAntCat = 0;

     &eaCta   = "";
     &eaIBAN  = "";
     &eaPais  = "";

     {20} aPopup = "";

     swProduccion = 0;
     &eaNombre = "";
     &nLabornet = 0;
     &nTecla3430 = 0;

     &aFechaAlta = "";
     aMensa = "";

     &eaCampo71  = "";
     &eaCampo72  = "";
     &eaCampo153 = "";
     &eaCampo154 = "";
     &eaCampo155 = "";
     &enEjerIRPF = 0;
     &eaBloqueo  = "";

     fFechaNuevo = @;
     nRelacion = 0;
     nEstimacion = 0;
     swAlgunoMas = 0;
     swFacturacion = 0
     swIDAL = 0

     sw902 = 0;
     nDiasInd = 0;
     aFechaBaja = "";
     nMesBaja = 0;
     nMotivo = 0;

     aTipo = "";
     aFecha = "";
     nDia = 0;
     nMes = 0;
     aMes = "";
     nCampoD = 0;
     nCampoH = 0;
     nDesde = 0;
     nHasta = 0;
|FIN;

||INCLUYE i_busqu;

|PROCESO ConsultaAlta; |TIPO 0;
     |SI FSalida = 18;
          enEmpresa = #0#0;
          enTrabajador = #0#1;
          |HAZ EnAlta_plb;
          |SI enTrabajador ! 0;
               #0#0 = enEmpresa;
               #0#1 = enTrabajador;
               |PINTA #0#0;
               |PINTA #0#1;
               |PTEC 802;
               |PTEC 802;
          |SINO;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO HorasTP;
     nModo = (nfEntrada / 100) ! 0;
     ||SI nModo = 1; |O #0Campo ! Contenido; |O #0#234 ! 0;
     |SI #0Campo ! Contenido;
          |SI #0#42 = "T"; |O #0#42 = "X"; |O #0#234 ! 0;
               #0#47 = #0#234 / 7;
               |PINTA #0#47;
          |FINSI;
     |FINSI;

     |SI #0#42 = "T"; |O #0#42 = "X";
          |SI #0Campo = 0;
               aAlfa = "    ATENCION. En trabajadores a tiempo parcial es necesario ";
               aAlfa = aAlfa + "indicar el número de horas semanales";
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO SiBomberos;
     nEnEmpresa = #labtraba#0;
     |HAZ BuscaModulo;
|FPRC;

|PROCESO CambiaDNI; |TIPO 0;
     nModo = (nfEntrada / 100) ! 0;

     |SI nModo = 1;
         eaCodNif = #0#7;
         |HAZ LeeNifs;
         #0#2 = #712#1;                     |PINTA #0#2;
         aAlfa1 = #712#9 + " " + #712#2; aAlfa1 = aAlfa1 % 130; |QBF aAlfa1;
         aAlfa2 = #0#3; |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;
              #0#3 = #712#9 + " " + #712#2;      |PINTA #0#3;
         |FINSI;
         #0#4 = #712#3;                     |PINTA #0#4;
         #0#5 = #712#10;                    |PINTA #0#5;
         #0#8 = #712#4;                     |PINTA #0#8;
         #0#9 = #712#5;                     |PINTA #0#9;
         #0#6 = #712#6;                     |PINTA #0#6;
         #0#10 = #712#7;                    |PINTA #0#10;
         #0#244 = #712#8;                   |PINTA #0#244;

         |ABRE #200;
         #200#0 = #0#7;
         #200#1 = 1;
         |LEE 040#200=;
         |SI FSalida = 0;
             #0#11  = #200#13;  |PINTA #0#11;
             #0#72 = #200#22;
             #0#251 = #200#14;                  |PINTA #0#251;
         |FINSI;
         |CIERRA #200;
     |FINSI;

     |SI nModo ! 2; |ACABA;   |FINSI;

     eaCodNif = #0#7;
     |HAZ LeeNifs;

     aAlfa1 = Contenido;
     |SI #0Campo ! aAlfa1;
         #0#2 = #712#1;                     |PINTA #0#2;
         aAlfa1 = #712#9 + " " + #712#2; aAlfa1 = aAlfa1 % 130; |QBF aAlfa1;
         aAlfa2 = #0#3; |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;
              #0#3 = #712#9 + " " + #712#2;      |PINTA #0#3;
         |FINSI;
         #0#4 = #712#3;                     |PINTA #0#4;
         #0#5 = #712#10;                    |PINTA #0#5;
         #0#8 = #712#4;                     |PINTA #0#8;
         #0#9 = #712#5;                     |PINTA #0#9;
         #0#6 = #712#6;                     |PINTA #0#6;
         #0#10 = #712#7;                     |PINTA #0#10;
         #0#244 = #712#8;                     |PINTA #0#244;

         |ABRE #200;
         #200#0 = #0#7;
         #200#1 = 1;
         |LEE 040#200=;
         |SI FSalida = 0;
             #0#11  = #200#13;  |PINTA #0#11;
             #0#251 = #200#14;                  |PINTA #0#251;
         |FINSI;
         |CIERRA #200;
     |FINSI;

     nEntrada = 0;

     |ABRE #200;
     #200#0 = #0#7;
     #200#1 = 1;
     |LEE 040#200=;
     |SI FSalida = 0;
         aAlfa1 = #0#11;    |QBF aAlfa1;
         aAlfa2 = #200#13;  |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

          aAlfa1 = #0#251;                   |QBF aAlfa1;
          aAlfa2 = #200#14;                |QBF aAlfa2;
          |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
     |FINSI;
     |CIERRA #200;

     aAlfa1 = #0#2;    |QBF aAlfa1;
     aAlfa2 = #712#1;  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     |SI #712#9 ! "  ";
         aAlfa1 = #0#3; |QBF aAlfa1;
         aAlfa2 = #712#9 + " " + #712#2; aAlfa2 = aAlfa2 % 130; |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
     |SINO;
         aAlfa1 = #0#3;       |QBF aAlfa1;
         aAlfa2 = #712#2;     |QBF aAlfa2;
         |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;
     |FINSI;

     aAlfa1 = #0#4;                        |QBF aAlfa1;
     aAlfa2 = #712#3;                  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#5;                    |QBF aAlfa1;
     aAlfa2 = #712#10;                 |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#8;                    |QBF aAlfa1;
     aAlfa2 = #712#4;                  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#9;                    |QBF aAlfa1;
     aAlfa2 = #712#5;                  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#6;                    |QBF aAlfa1;
     aAlfa2 = #712#6;                  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#10;                   |QBF aAlfa1;
     aAlfa2 = #712#7;                  |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     aAlfa1 = #0#244;                   |QBF aAlfa1;
     aAlfa2 = #712#8;                   |QBF aAlfa2;
     |SI aAlfa1 ! aAlfa2;  nEntrada = 1;  |FINSI;

     |SI nEntrada = 1;
         |CONFI "0000SLos Datos del Trabajador no son igual al del NIF, Desea Actualizarlos";
         |SI FSalida = 0;
             #0#2  = #712#1;                     |PINTA #0#2;

             |SI #712#9 ! "  ";
                 aAlfa1 = #712#9 + " " + #712#2; aAlfa1 = aAlfa1 % 130;
                 |QBF aAlfa1;
             |SINO;
                 aAlfa1 = #712#2; |QBF aAlfa1;
             |FINSI;
             aAlfa2 = #0#3; |QBF aAlfa2;
             |SI aAlfa1 ! aAlfa2;
                  #0#3 = #712#9 + " " + #712#2;      |PINTA #0#3;
             |FINSI;

             #0#4 = #712#3;                     |PINTA #0#4;
             #0#5 = #712#10;                    |PINTA #0#5;
             #0#8 = #712#4;                     |PINTA #0#8;
             #0#9 = #712#5;                     |PINTA #0#9;
             #0#6 = #712#6;                     |PINTA #0#6;
             #0#10 = #712#7;                     |PINTA #0#10;
             #0#244 = #712#8;                     |PINTA #0#244;
             #0#251 = #712#14;                  |PINTA #0#251;

             |ABRE #200;
             #200#0 = #0#7;
             #200#1 = 1;
             |LEE 040#200=;
             |SI FSalida = 0;
                 #0#11  = #200#13; |PINTA #0#11;
                 #0#251 = #200#14; |PINTA #0#251;
             |FINSI;
             |CIERRA #200;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo7Dni;  |TIPO 7;
     |SI #0#7 = "            ";
         nfEntrada = 101;
     |SINO;
         nfEntrada = 202;
     |FINSI;
     enEmpresa = #0#0;
     enTrabajador = #0#1;

     || si usamos los botones de SS Online o de Hco Contratos, el FEntrada
     || se pierde, y se vuelve un "1". Esto da problemas despues para saber
     || en que modo estamos.
     || estas dos variables me guardaran el modo real en que estoy para te-
     || nerlo todo el tiempo que este en la ficha, y despues se pondran
     || a cero en el tipo 2 (cuando salga de la ficha diciendo correcto SI
     || o NO o con Escape)

     nFEntradaReal = FEntrada;
     nModoReal = (FEntrada / 100) ! 0;
|FPRC;

/*
|PROCESO imagenes; |TIPO 0;
     eaVengoDe = "labtraba";
     |SI FSalida = 13;
          aAlfa1 = #0#0; aAlfa1 = ("00000" + aAlfa1) % -105;
          aAlfa2 = #0#1; aAlfa2 = ("00000" + aAlfa2) % -105;
          orden = aAlfa1 + aAlfa2;
          pasa = "T";
          |SUB_EJECUTA "nombmp01";
     |FINSI;
|FPRC;
*/

|PROCESO siono; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|SI Campo ! 30;
    |SI #0#14 = An; |O #0#14 = AN;
        |HAZ nopasar;
    |FINSI;
|SINO;
    |SI #0#29 = 0;
        |HAZ nopasar;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO nomodif; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

    fecsys = #0#11;
    nacnum = fecsys;
    fecsys = ~;
    fecnum = fecsys;
    dias18 = 18 * 365; dias18 = dias18 + 4; || cuatro dias por 4 a¤os bisiestos
    edanum = fecnum - nacnum;
|SI edanum ] dias18;
        alfa1 = "N";
|SINO;
        alfa1 = "S";
|FINSI;
|C_M #0#20, 1, alfa1;
|C_M #0#21, 1, alfa1;
|C_M #0#22, 1, alfa1;
|C_M #0#23, 1, alfa1;
|FPRC;

|PROCESO veri1; |TIPO 7;
     aAlfa = #0Campo;
     |QBF aAlfa;
     aAlfa = aAlfa % 0;
     nNume = aAlfa;
     |SI nNume ! 0; |Y nNume ! 10;
          #0Campo = "";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO tope;
       |SI mes = 1; |O mes = 3; |O mes = 5; |O mes = 7; |O mes = 8; |O mes = 10; |O mes = 12;
           tope = 31;
       |SINO;
           |SI mes = 2;
               mod = any $ 4;
               |SI mod = 0;
                   tope = 29;
               |SINO;
                   tope = 28;
               |FINSI;
            |SINO;
               tope = 30;
            |FINSI;
        |FINSI;
|FPRC;

|PROCESO verifech; |TIPO 0;
nTecla = FSalida;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

        fec = #0Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
  dia1 = fec % A102;
  mes1 = fec % A402;
  any1 = fec % A704;
  dia = dia1; mes = mes1; any = any1;
  |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
     |SI mes [ 12; |Y mes ] 1;
          |HAZ tope;
        |SI dia [ tope;
            sw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV men1;
    |ERROR;
|FINSI;

|SI Campo = 11;     |HAZ menor;    |FINSI;
|SI Campo = 11;     |HAZ nomodif;  |FINSI;

|SI Campo = 253;
     nTecla3430 = 0;
     |SI nTecla = 0; |O nTecla = 3;
          |HAZ Mod003430;
     |FINSI;
     |SI nTecla3430 = 2;
          |ENCAMPO #253#0;
     |FINSI;
|FINSI;

     |SI Campo = 132;
          |SI fec ! blanco; |Y fec ! puntos;
               fFecha = fec;
               |SI fFecha < "13.05.2020";
                    aAlfa = "    No se admiten fechas de renuncia al ERTE ";
                    aAlfa = aAlfa + "por fuerza mayor anteriores a 13.05.2020";
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
          |FINSI;
     |FINSI;

|FPRC;

|PROCESO nopasar;
    aponer = Anono;
    fiac = Control % A1001;
    Control = Control + fiac;
    Control = Control + relleno;
    Control = Control % A120;
    Control = Control + aponer;
|FPRC;

|PROCESO antes; |TIPO 7;
     nume2 = #0Campo;
|FPRC;

|PROCESO lee_centr; |TIPO 0;
     |SI FSalida = 13;
          aAlfa = "SELECT * FROM labcentr INTO tm" + Usuario;
          aAlfa = aAlfa + " WHERE 0 == " + #labtraba#0;
          |SQL aAlfa;
          |SI FSalida ! 0;
               |MENAV "    No hay registros"; |ERROR; |ACABA;
          |FINSI;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/labcentr.mas";
          |CARGA_DEF aAlfa , temp0001@;
          |SI FSalida = 0;
               aAlfa = "tm" + Usuario; |NOME_DAT #500 aAlfa;
               |ABRE #temp0001@;
               nModo = 2 + 4 + 8 + 16;
               nPos1 = 1723; nPos2 = 2380;
               |LINEAL_SIMPLE #1#temp0001@,nModo, nPos1, nPos2, NULL, NULL, NULL;
               |SI FSalida = 0;
                    #labtraba#77 = #temp0001@#1;
                    ||PINTA 1523, #temp0001@#2;
               |FINSI;
               |CIERRA #temp0001@; |DESCARGA_DEF #temp0001@;
          |FINSI;
          |ERROR;
          |ACABA;
     |FINSI;

     |ABRE #labcentr;
     #labcentr#0 = #0#0;
     #labcentr#1 = #0#77;
     |LEE 000#labcentr.=;
     |SI FSalida = 0; |Y #labcentr#15 ! 0;
          nume1 = #labcentr#15;
          nModo = (FEntrada / 100) ! 0;
          |SI #0#156 ! nume1; |Y #0Campo ! nume2;
               #0#156 = nume1;
               |PINTA #0#156;
          |FINSI;
          |SI #0#156 ! nume1; |Y nModo = 1;
               #0#156 = nume1;
               |PINTA #0#156;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO nifletra; |TIPO 6;  || CALCULA LETRA NIF CUANDO SE PULSA -F1-
     nTecla = FSalida;
     |SI FSalida = 10;
         eaVarDni  = #0Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     |SI Campo = 26;
          eaVarDni = (eaVarDni + "               ") % 115;
     |SINO;
          eaVarDni = (eaVarDni + "             ") % 112;
     |FINSI;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     modo = (FEntrada / 100) ! 0;
     alfa1 = #0Campo;
     |QBT alfa1;

     |SI alfa1 = ""; |Y modo ! 4;
         |MENAV "    AVISO !!! Trabajador sin D.N.I. ...";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO control2; |TIPO 0;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |SI FSalida = 9;
          alfa1 = #0Campo;
          |QBF alfa1;

          aAlfa = alfa1 % 0;            || si mide mas de 10 digitos y me piden
          nNume = aAlfa;                || que calcule el digito de control
          |SI nNume > 10;               || quito el que me hubieran introducido
               alfa1 = alfa1 % 110;
               #0Campo = alfa1;
          |FINSI;

          alfa2 = alfa1 % 102; alfa3 = alfa1 % -108;
          alfa4 = alfa3 % 101;
          |SI alfa4 = "0";
               alfa3 = alfa3 % 207;
               alfa1 = alfa2 + alfa3;
          |FINSI;
          nume1 = alfa1;
          nume2 = nume1 / 97;
          |HAZ trunca2;
          |SI nume1 ] 0; |Y nume1 [ 99;
               alfa1 = #0Campo;
               |QBF alfa1;
               alfa2 = nume1;
               alfa2 = "00" + alfa2;
               alfa2 = alfa2 % -102;
               alfa1 = alfa1 + alfa2;
               #0Campo = alfa1;
               |PINTA #0Campo;
          |FINSI;
     |FINSI;

     aAlfa1 = #0Campo;
     |QBF aAlfa1;

     aAlfa = #0Campo;
     |QBF aAlfa;
     aAlfa = aAlfa % 0;
     nNume = aAlfa;
     aAlfa = "    ATENCION. El número de afiliación a la Seg. Social ";
     aAlfa = aAlfa + "ha de contener 12 dígitos."
     |SI aAlfa1 ! ""; |Y nNume ! 12;
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO trunca2;
    corta = 0;
    alfa1 = nume2;  alfa2 = alfa1 % 0;  nume3 = alfa2;
|PARA jg = nume3; |SI jg ] 1;|Y corta = 0; |HACIENDO jg = jg - 1;
        sitio = (jg * 100) + 1;
        alfa2 = alfa1 % sitio;
    |SI alfa2 = ".";  corta = jg;  |FINSI;
|SIGUE;
|SI corta ! 0;
        sitio = 100 + corta - 1;
        alfa1 = alfa1 % sitio;
|FINSI;
    nume3 = alfa1;
    nume1 = nume1 - (nume3 * 97);
|FPRC;

|PROCESO CalculaEdad;
     sistema = ~;
     fechtra = #0#11;
     anynac1 = fechtra % -104;    || desglosa fecha nacimiento en a¤os
     anynac2 = anynac1;
     mesnac1 = fechtra %  402;    || meses
     mesnac2 = mesnac1;
     dianac1 = fechtra %  102;    || y dias
     dianac2 = dianac1;
     fechtra = sistema;
     anyact1 = fechtra % -104;    || desglosa fecha actual en a¤os
     anyact2 = anyact1;
     mesact1 = fechtra %  402;    || meses
     mesact2 = mesact1;
     diaact1 = fechtra %  102;    || y dias
     diaact2 = diaact1;
     edadxxx = anyact2 - anynac2; || halla los a¤os
     |SI mesnac2 > mesact2;
          edadxxx = edadxxx - 1;   || resta un a¤o si aun no ha llegado el mes
     |FINSI;
     |SI mesnac2 = mesact2; |Y dianac2 > diaact2; ||o si aun no ha llegado el dia
          edadxxx = edadxxx - 1;
     |FINSI;
|FPRC;

|PROCESO menor; |TIPO 0;       || HALLA EDAD A PARTIR DE FECHA NACIMIENTO
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;
     edadxxx = -1;

     |SI #0Campo ! blanco; |Y #0Campo ! puntos;
          |HAZ CalculaEdad;
     |SINO;
          edadxxx = -1;
     |FINSI;
     |SI edadxxx < 16; |Y edadxxx ! -1;
          |MENAV "    AVISO !!! El trabajador es menor de 16 años ...";
     |FINSI;
|FPRC;

|PROCESO CompEdad;
     |SI #0#135 = "S";
          edadxxx = -1;
          |HAZ CalculaEdad;
          |SI edadxxx < 60;
               aAlfa = "    ATENCION: El trabajador es menor de 60 años. Confirme ";
               aAlfa = aAlfa + "que desea activar la Jubilación Parcial.";
               |MENAV aAlfa;
          |FINSI;
          |CAMPO_MODIFICA #0#220, 1, "S";
     |SINO;
          #0#220 = 0;
          |PINTA #0#220;
          |CAMPO_MODIFICA #0#220, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ayuda1; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|PUSHV 07302371;
||CUADRO 07 30 23 71;
|ATRI R;   || 3        4         5         6         7
||            1234567890123456789012345678901234567890
|PINTA 0731, " ----- CLAVES DE SALARIO POSIBLES ----- ";
|PINTA 0831, " (M) cotizacion mensual                 ";
|PINTA 0931, " (D) cotizacion diaria                  ";
|PINTA 1031, " (I) cotizacion irregular por dias      ";
|PINTA 1131, " (P) cotizacion irregular por horas     ";
|PINTA 1231, " (T) tiempo parcial cotizacion diaria   ";
|PINTA 1331, " (X) tiempo parcial cotizacion mensual  ";
|PINTA 1431, " (A) R.Agrario, Sistema General         ";
|PINTA 1531, " (E) R.Agrario, Jornadas Reales         ";
|PINTA 1631, " (e) R.Agrario, Jornadas-Extranj.Contin.";
|PINTA 1731, " (C) r.citricos, lunes/sabado   (1.33)  ";
|PINTA 1831, " (F) r.citricos, lunes/viernes  (1.61)  ";
|PINTA 1931, " (H) gerentes/cooperativistas autonomos ";
|PINTA 2031, " (L) funcionario Administracion Local   ";
|PINTA 2131, " (N) funcionario sin exencion Seg.Social";
|ATRI 0;
|FPRC;

|PROCESO ayuda2; |TIPO 0;
nTecla = FSalida;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|POPV;
|SI Campo = 42;     |HAZ def_regimen;   |FINSI;
|SI Campo = 97;     |HAZ no_ajuste;     |FINSI;
|FPRC;

|PROCESO ayuda3; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|PUSHV 12322173;
|CUADRO 12 32 21 73;
|ATRI R;
||            9012345678901234567890123456789012345678
|PINTA 1333, " -----  TIPOS DE AJUSTE POSIBLES ------ ";
|PINTA 1433, " (0) Sin ajuste                         ";
|PINTA 1533, " (1) A brutos   (no cotiza -407-)       ";
|PINTA 1633, " (2) A brutos   (cotiza -120-)          ";
|PINTA 1733, " (3) A liquidos (no cotiza -407-)       ";
|PINTA 1833, " (4) A liquidos (cotiza -120-)          ";
|PINTA 1933, " (5) A brutos   (no cot./no IRPF -411-) ";
|PINTA 2033, " (6) A liquidos (no cot./no IRPF -411-) ";
|ATRI 0;
|FPRC;

|PROCESO notipov; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

    nume2 = Campo - 8;
|SI #0nume2 = "V";
    |SI Campo = 165;  |CAMPO_MODIFICA #0#165, 1, "N";  |FINSI;
    |SI Campo = 166;  |CAMPO_MODIFICA #0#166, 1, "N";  |FINSI;
    |SI Campo = 167;  |CAMPO_MODIFICA #0#167, 1, "N";  |FINSI;
    |SI Campo = 168;  |CAMPO_MODIFICA #0#168, 1, "N";  |FINSI;
    |SI Campo = 169;  |CAMPO_MODIFICA #0#169, 1, "N";  |FINSI;
    |SI Campo = 170;  |CAMPO_MODIFICA #0#170, 1, "N";  |FINSI;
    |SI Campo = 171;  |CAMPO_MODIFICA #0#171, 1, "N";  |FINSI;
    |SI Campo = 172;  |CAMPO_MODIFICA #0#172, 1, "N";  |FINSI;
|SINO;
    |SI Campo = 165;  |CAMPO_MODIFICA #0#165, 1, "S";  |FINSI;
    |SI Campo = 166;  |CAMPO_MODIFICA #0#166, 1, "S";  |FINSI;
    |SI Campo = 167;  |CAMPO_MODIFICA #0#167, 1, "S";  |FINSI;
    |SI Campo = 168;  |CAMPO_MODIFICA #0#168, 1, "S";  |FINSI;
    |SI Campo = 169;  |CAMPO_MODIFICA #0#169, 1, "S";  |FINSI;
    |SI Campo = 170;  |CAMPO_MODIFICA #0#170, 1, "S";  |FINSI;
    |SI Campo = 171;  |CAMPO_MODIFICA #0#171, 1, "S";  |FINSI;
    |SI Campo = 172;  |CAMPO_MODIFICA #0#172, 1, "S";  |FINSI;
|FINSI;
|FPRC;

|PROCESO desigual; |TIPO 0;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|SI #0Campo ! "E";|Y #0Campo ! " ";
    |SI Campo = 148;
        |SI #0Campo = #0#228; |O #0Campo = #0#229;
            |MENAV "    ATENCION!!! Claves iguales ...";
            |ERROR;
        |FINSI;
    |FINSI;
    |SI Campo = 228;
        |SI #0Campo = #0#148; |O #0Campo = #0#229;
            |MENAV "    ATENCION!!! Claves iguales ...";
            |ERROR;
        |FINSI;
    |FINSI;
    |SI Campo = 229;
        |SI #0Campo = #0#148; |O #0Campo = #0#228;
            |MENAV "    ATENCION!!! Claves iguales ...";
            |ERROR;
        |FINSI;
    |FINSI;
|SINO;
    |SI #0Campo = "E";
        |MENAV "    ATENCION!!! Clave gestionada con conceptos 41? ...";
        |ERROR;
    |FINSI;
|FINSI;

|SI Campo = 228;    |HAZ noentra2; |FINSI;
|SI Campo = 229;    |HAZ noentra3; |FINSI;
|FPRC;

|PROCESO defanti; |TIPO 7;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |SI #0Campo = "          ";
          #0Campo = #0#34;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO timeparc; |TIPO 7;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |SI #0#42 = "X";|O #0#42 = "T"; |O #0#42 = "P";
     |O #0#129 = "G";
          |CAMPO_MODIFICA #0#234, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#234, 1, "N";
     |FINSI;
|FPRC;

|PROCESO pluriem; |TIPO 0;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |SI #0#237 = "S";
          |DBASE aAlfa;
          |QBF aAlfa;
          aAlfa = aAlfa + "def/nompluri.mas";
          |CARGA_DEF aAlfa, temp0001@;

          |DBASE aAlfa;
          |QBF aAlfa;
          aAlfa = aAlfa + "fich/";
          |PATH_DAT #temp0001@#aAlfa#;

          |SI FSalida = 0;
               |ABRE #temp0001@;
               #temp0001@#0 = #0#0;
               #temp0001@#1 = #0#1;
               |LEE 101#temp0001@.=;
               |SI FSalida ! 0;
                    aMensa = "    ATENCION. Es necesario definir la proporción en pluriempleo ";
                    aMensa = aMensa + "para los topes de contingencias.";
                    |MENAV aMensa;
                    aMensa = "    Opción: Maestros / Complementarios I / Definición de Topes ";
                    aMensa = aMensa + "de Pluriempleo por Trabajador";
                    |MENAV aMensa;
               |FINSI;
               |CIERRA #temp0001@;
               |DESCARGA_DEF #temp0001@;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pluriem2; |TIPO 0;
|ACABA;
     |SI #0#237 = "S"; |Y #0#236 = 0;
          aAlfa1 = "    En Pluriempleo es necesario indicar el grupo mayor de ";
          aAlfa1 = aAlfa1 + "cotizacion.";
          |MENAV aAlfa1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO noentra2; |TIPO 0;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

    alfa1 = #0#228;
|QBF alfa1;
|SI alfa1 = "";  alfa2 = "N";  |FINSI;
|SI alfa1 ! "";  alfa2 = "S";  |FINSI;
|CAMPO_MODIFICA #0#176, 1, alfa2;
|CAMPO_MODIFICA #0#177, 1, alfa2;
|CAMPO_MODIFICA #0#179, 1, alfa2;
|CAMPO_MODIFICA #0#180, 1, alfa2;
|CAMPO_MODIFICA #0#181, 1, alfa2;
|CAMPO_MODIFICA #0#182, 1, alfa2;
|CAMPO_MODIFICA #0#183, 1, alfa2;
|CAMPO_MODIFICA #0#184, 1, alfa2;
|CAMPO_MODIFICA #0#185, 1, alfa2;
|CAMPO_MODIFICA #0#186, 1, alfa2;
|CAMPO_MODIFICA #0#187, 1, alfa2;
|CAMPO_MODIFICA #0#188, 1, alfa2;
|CAMPO_MODIFICA #0#189, 1, alfa2;
|CAMPO_MODIFICA #0#190, 1, alfa2;
|CAMPO_MODIFICA #0#191, 1, alfa2;
|CAMPO_MODIFICA #0#192, 1, alfa2;
|CAMPO_MODIFICA #0#193, 1, alfa2;
|CAMPO_MODIFICA #0#194, 1, alfa2;
|CAMPO_MODIFICA #0#195, 1, alfa2;
|CAMPO_MODIFICA #0#196, 1, alfa2;
|CAMPO_MODIFICA #0#197, 1, alfa2;
|CAMPO_MODIFICA #0#198, 1, alfa2;
|CAMPO_MODIFICA #0#199, 1, alfa2;
|CAMPO_MODIFICA #0#230, 1, alfa2;
|CAMPO_MODIFICA #0#231, 1, alfa2;
|FPRC;

|PROCESO noentra3; |TIPO 0;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

    alfa1 = #0#229;
|QBF alfa1;
|SI alfa1 = "";  alfa2 = "N";  |FINSI;
|SI alfa1 ! "";  alfa2 = "S";  |FINSI;
|CAMPO_MODIFICA #0#200, 1, alfa2;
|CAMPO_MODIFICA #0#201, 1, alfa2;
|CAMPO_MODIFICA #0#202, 1, alfa2;
|CAMPO_MODIFICA #0#203, 1, alfa2;
|CAMPO_MODIFICA #0#204, 1, alfa2;
|CAMPO_MODIFICA #0#205, 1, alfa2;
|CAMPO_MODIFICA #0#206, 1, alfa2;
|CAMPO_MODIFICA #0#207, 1, alfa2;
|CAMPO_MODIFICA #0#208, 1, alfa2;
|CAMPO_MODIFICA #0#209, 1, alfa2;
|CAMPO_MODIFICA #0#210, 1, alfa2;
|CAMPO_MODIFICA #0#211, 1, alfa2;
|CAMPO_MODIFICA #0#212, 1, alfa2;
|CAMPO_MODIFICA #0#213, 1, alfa2;
|CAMPO_MODIFICA #0#214, 1, alfa2;
|CAMPO_MODIFICA #0#215, 1, alfa2;
|CAMPO_MODIFICA #0#216, 1, alfa2;
|CAMPO_MODIFICA #0#217, 1, alfa2;
|CAMPO_MODIFICA #0#218, 1, alfa2;
|CAMPO_MODIFICA #0#219, 1, alfa2;
|CAMPO_MODIFICA #0#220, 1, alfa2;
|CAMPO_MODIFICA #0#221, 1, alfa2;
|CAMPO_MODIFICA #0#222, 1, alfa2;
|CAMPO_MODIFICA #0#223, 1, alfa2;
|CAMPO_MODIFICA #0#232, 1, alfa2;
|CAMPO_MODIFICA #0#233, 1, alfa2;
|FPRC;

|PROCESO clave_cot; |TIPO 7;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |CAMPO_MODIFICA #0#64, 1, "S";
     |SI #0#42 ! "M";|Y #0#42 ! "D";
      |Y #0#42 ! "X";|Y #0#42 ! "T";
      |Y #0#42 ! "I";|Y #0#42 ! "P";
      |Y #0#42 ! "H";
          #0#64 = #0#42;
          |CAMPO_MODIFICA #0#64, 1, "N";
     |SINO;
          |SI #0#64 ! "M";|Y #0#64 ! "D";
               |SI #0#42 = "D";|O #0#42 = "T";
                    #0#64 = "D";
               |SINO;
                    #0#64 = "M";
               |FINSI;
          |FINSI;
     |FINSI;
     |PINTA #0#64;
|FPRC;

|PROCESO clave_cot_verif;
     |SI #0#42 = "A"; |O #0#42 = "E"; |O #0#42 = "C"; |O #0#42 = "F";
     |O #0#42 = "L"; |O #0#42 = "N";
          |ACABA;
     |SINO;
          |SI #0#64 ! "M"; |Y #0#64 ! "D";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO no240; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|SI #0#239 = "D";
        alfa1 = "S";
|SINO;
        alfa1 = "N";
|FINSI;
|CAMPO_MODIFICA #0#240, 1, alfa1;
|FPRC;

|PROCESO no_ajuste; |TIPO 0;
     |SI #0#97 = 0;
          alfa1 = "N";
          #0#98 = 0;
          |PINTA #0#98;
          #0#207 = "M";
          |PINTA #0#207;
          #0#182 = "N";
          |PINTA #0#182;
          #0#183 = "N";
          |PINTA #0#183;
     |SINO;
          alfa1 = "S";
     |FINSI;
     |CAMPO_MODIFICA #0#98, 1, alfa1;
     |CAMPO_MODIFICA #0#61, 1, alfa1;
     |CAMPO_MODIFICA #0#213, 1, alfa1;
     |CAMPO_MODIFICA #0#207, 1, alfa1;
     |CAMPO_MODIFICA #0#182, 1, alfa1;
     |CAMPO_MODIFICA #0#183, 1, alfa1;
|FPRC;

|PROCESO solo_liquido; |TIPO 7;
|SI #0#97 ! 3;|Y #0#97 ! 4;|Y #0#97 ! 6;
        #0#246 = "N";
    |PINTA #0#246;
    |CAMPO_MODIFICA #0#246, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#246, 1, "S";
|FINSI;
|FPRC;

|PROCESO comp_reg;
     |SI #0#247 = 121; |Y #0#33 ! 5;
          aAlfa = "    ATENCION: El Regimen de Representantes de Comercio solo ";
          aAlfa = aAlfa + "admite el Grupo de Cotizacion 05."
          |MENAV aAlfa;
          aAlfa = "    Se cambiara automaticamente."
          |MENAV aAlfa;
          #0#33 = 5;
          |PINTA #0#33;
     |FINSI;
     |SI #0#247 = 121;
          #0#32 = 102;
          |PINTA #0#32;
     |FINSI;
     |SI #0#247 = 521;
          #0#45 = 999;
          #0#248 = 500;
          |PINTA #0#45;
          |PINTA #0#248;
     |FINSI;

     swSigue = 0;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1; |Y #0#247 = 138;
          swSigue = 1;
     |FINSI;
     |SI #0#247 = 138; |Y #0Campo ! Contenido;
          swSigue = 1;
     |FINSI;
     |SI swSigue = 1;
          #0#29 = 0;
          #0#30 = 0;
          #0#174 = 0;
          #0#175 = 0;
          |PINTA #0#29;
          |PINTA #0#30;
          |PINTA #0#174;
          |PINTA #0#175;
     |FINSI;
|FPRC;

|PROCESO IRPFHogar;
     |SI #0#247 = 138;
          |SI #0#29 ! 0; |O #0#30 ! 0; |O #0#174 ! 0; |O #0#175 ! 0;
               aAlfa = "    ATENCION. El trabajador pertenece al Régimen de ";
               aAlfa = aAlfa + "Trabajadores del Hogar";
               |MENAV aAlfa;
               aAlfa = "    Compruebe si la regularización o deducción por IRPF ";
               aAlfa = aAlfa + "es aplicable.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO min_reg;
    #6#0 = 1;
|FPRC;

|PROCESO max_reg;
    #6#0 = 9999;
|FPRC;

|PROCESO regimen; |TIPO 0;
     |SI FSalida = 5; |O FSalida = 4;
          |ACABA;
     |FINSI;
     inkey = FSalida;
     |SI inkey = 9;
          |PUSHV 0501 2380;
          |ENTLINEAL #1#6, 1, 4, 21, 1, min_reg, max_reg;
          |POPV;
     |FINSI;
     |HAZ pinta_regimen;
     |SI inkey = 9;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO def_regimen;
    modo = (FEntrada / 100) ! 0;
|SI modo = 1;
    ||PDEFECTO #0, 247, 248;
    |SI #0#42 = "H";                                   #0#247 = 521;  |FINSI;
    |SI #0#42 = "A";|O #0#42 = "B";|O #0#42 = "E";|O #0#42 = "e";
    /*
         fFecha = ~;
         aAlfa = fFecha;
    */
         aAlfa = #0#36;
         aAlfa = aAlfa % -104;
         nume1 = aAlfa;
         |SI nume1 ] 2012; |O nume1 = 0;
              #0#247 = 163;
         |SINO;
              #0#247 = 613;
         |FINSI;
    |FINSI;
    |PINTA #0#247;
    ||HAZ pinta_regimen;
|FINSI;
|FPRC;

|PROCESO pinta_regimen; |TIPO 7;
|SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

|DDEFECTO #6;
|ABRE #6;
    #6#0 = #0#247;
|LEE 000#6=;
|CIERRA #6;
|PINTA #0#247;
    alfa1 = #6#1 % 124;
|ATRI I;  |PINTA 1034, alfa1; |ATRI 0;
|FPRC;

|PROCESO pincat; |TIPO 0;
     nAntCat = Contenido;
     nume1 = Contenido;
     |SI nume1 ! #0Campo;
          #0#18 = #3#2;
          |PINTA #0#18;
     |FINSI;
|FPRC;

|PROCESO abrevia_antes; |TIPO 7;
     aAntes = #0Campo;
|FPRC;

|PROCESO abrevia; |TIPO 0;
     modo = (FEntrada / 100) ! 0;
     |SI modo = 1;  |ACABA;   |FINSI;        || en alta no!

     |SI Campo ! 204;
          aAntes = Contenido;
     |FINSI;

     |SI #0Campo ! aAntes;
          |PUSHV 0501 2380;
          |AVISO;
          |PINPA #2#50;
          |PAUSA;
          |POPV;
     |FINSI;
|FPRC;
____________________________________/ BORRADO DE RELACIONES
|PROCESO borrando; |TIPO 2;
     baja = FEntrada / 100;
     baja = baja ! 0;
     |SI baja = 3;
          |HAZ aviso_tr;
          em_borr = #0#0;
          tr_borr = #0#1;
          /*
          |SI tr_borr = 0;
               aAlfa = "    ATENCION: borrando el trabajador 00000 se borrarán ";
               aAlfa = aAlfa + "TODOS los trabajadores de la empresa.";
               |MENAV aAlfa;
               aAlfa = "    N¿Está seguro de que desea continuar con el proceso?";
               |CONFI aAlfa;
               |SI FSalida ! 0;
                    |POPV;
                    |ACABA;
               |FINSI;
          |FINSI;
          */
          eaProcedencia = "labtraba";
          |SUB_EJECUTA "nomborr1.run";
          eaProcedencia = "labtraba";
          |SUB_EJECUTA "nomborr2.run";
          |HAZ t_aviso9;
          |SI swModulo = 1; |Y #0#0 = 112; swModulo = 3145; |FINSI;
          |SI swModulo = 3145;
               |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/bomb0009.mas";
               |CARGA_DEF aAlfa, temp0001@;
               |SI FSalida = 0;
                    |ABRE #temp0001@;
                    #temp0001@#0 = #0#0;
                    #temp0001@#1 = #0#1;
                    |LEE 101#temp0001@.=;
                    |SI FSalida = 0;
                         |BORRA 020#temp0001@.a;
                    |FINSI;
                    |CIERRA #temp0001@;
               |FINSI;
               |DESCARGA_DEF #temp0001@;
          |FINSI;
          |HAZ Bor003430;
     |FINSI;

     nFEntradaReal = 0;
     nModoReal = 0;
|FPRC;

|PROCESO aviso_tr;
|PUSHV 05012380;
|HAZ t_color_f;
|CUADRO 09 30 11 71;
||            1234567890123456789012345678901234567890
|HAZ t_color_c;
|PINTA 1031, "         Borrando Relaciones ...        ";
|ATRI 0;
|FPRC;

|PROCESO t_color_c;        || activa el color caracter en avisos
|COLOR 14, 0;
|ATRI 0;
|FPRC;

|PROCESO t_color_f;        || activa el color graficos en avisos
|COLOR 4, 0;
|ATRI 0;
|FPRC;

|PROCESO t_aviso9;         || desde calculo 'descuadre', 'modbaj'
|POPV;
|FPRC;
____________________________________/ DATOS APRENDIZAJE/TIEMPO PARCIAL
|PROCESO modo; |TIPO 0;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa = "labtraba";
         enEmpresa = #labtraba#0;
         |HAZ MiraBloqueo;
         |SI eaBloqueo = "3";
             |ERROR;
             |PTEC 807;
         |FINSI;
     |FINSI;

     nAltaFechaRef = 0;
     nMedia90 = 0;

     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     modito = (FEntrada / 100) ! 0;      || se perdia en el 'ENDATOS'
     |HAZ idioma;
|FPRC;

|PROCESO coti_cent;
|ACABA;
     |ABRE #5;
     |DDEFECTO #5;
     #5#0 = #0#0;
     #5#13 = #0#77;
     #5#1 = "87";
     |LEE 000#5=;
     |SI FSalida ! 0;
          aAlfa = #0#77; |QBF aAlfa; aAlfa = ("000" + aAlfa) % -103;
          aAlfa = "    SEl centro " + aAlfa + " no tiene asignado centro de ";
          aAlfa = aAlfa + "formación. ¿Desea crearlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               |PUSHV 05012380;
               |ABRE #2;
               |DDEFECTO #2;
               #2#0 = #0#0;
               #2#1 = #0#77;
               |LEE 020#2=;
               |CIERRA #2;

               #5#3 = #2#3;     || calle
               #5#4 = #2#4;     || numero
               #5#5 = #2#5;     || piso
               #5#6 = #2#6;     || localidad
               #5#7 = #2#7;     || cod.postal 1
               #5#8 = #2#8;     || cod.postal 2
               #5#9 = #2#9;     || provincia
               #5#10 = "";      || NAFSS
               #5#11 = 1;       || nro.trabajadores
               #5#14 = #2#13;   || clave entidad
               #5#15 = #2#14;   || entidad

               |PINPA #0#5;
               |PINDA #0#5;
               |ENDATOS #1#5;
               |SI FSalida = 0;
                    |GRABA 020#5n;
               |FINSI;
               |POPV;
          |FINSI;
     |FINSI;
     |CIERRA #5;
|FPRC;

|PROCESO cotizacion; |TIPO 0;
     |SI FSalida = 5;|O FSalida = 4;    |ACABA;   |FINSI;

     |SI Campo = 45;
          |HAZ pintacons;

          |SI #labtraba#45 = 421; |O #labtraba#45 = 422;
               |HAZ coti_cent;                  || centros especiales
               /*
               || siempre, por que solo si cambia?
               modo = modito;
               |SI #0#45 ! Contenido; modo = 1; |FINSI;
               |SI modo = 1;
                    |HAZ coti_cent;                  || centros especiales
               |FINSI;
               */
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Hist;
     swExisteHco = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE Historico;
     #nomhicca#1;
     ;
     #0#0, #0#1, 00, 01, 00;
     #0#0, #0#1, 99, 12, 99;
     ;
     NULL, Hist;
|FIN;

|PROCESO constante;
     nModo = (FEntrada / 100) ! 0;

     |SI #0Campo ! Contenido; |Y nModo = 2;
          || cambia la constante, si tengo calculado algo en Hco. aviso
          swExisteHco = 0;
          |BUCLE Historico;
          |SI swExisteHco = 1;
               aAlfa1 = #nomhicca#2; aAlfa1 = ("00" + aAlfa1) % -102;
               aAlfa2 = #nomhicca#66; aAlfa2 = ("00" + aAlfa2) % -102;
               aAlfa = "    ATENCION: Este trabajador tiene nominas calculadas ";
               aAlfa = aAlfa + "en el historico: mes " + aAlfa1 + ", a" + &241 + "o " + aAlfa2;
               |MENAV aAlfa;
               aAlfa = "    Si desea cambiar el tipo de cotizacion es necesario crear ";
               aAlfa = aAlfa + "una nueva ficha";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pintacons; |TIPO 0;
     |SI #0Campo ! Contenido;
          |ABRE #nomtrato;
          nNume = #0#45;
          #nomtrato#0 = #0#247;
          #nomtrato#1 = nNume;
          |LEE 000#nomtrato.=;
          |SI FSalida = 0;
               #0#248 = #nomtrato#3;
               |SI #0#247 = 163; |O #0#247 = 613;
                    |SI nNume ] 300; |Y nNume [ 399;
                         |SI #0#42 = "A";
                              #0#248 = 700;
                         |FINSI;
                         |SI #0#42 = "E";
                              #0#248 = 701;
                         |FINSI;
                    |FINSI;
               |FINSI;
               |PINTA #0#248;
          |FINSI;
          |CIERRA #nomtrato;
     |FINSI;
|FPRC;

|PROCESO MinimoDef; |TIPO 7;
     aFabre = "";
     |DIRECTORIO aFabre;
     aFabre = "rt  " + aFabre + "laboral/bin/gafi0001.tab";
     |FABRE aFabre;
     |SI FSalida ] 0;
          |FCIERRA FSalida;
          |DDEF aDef;
          |QBF aDef;
          aAlfa = aDef % 0111;
          |SI aAlfa = "/u/dsprofes";    || estoy en produccion
               |ACABA;             || no me compruebes nada
          |FINSI;
          aDef = aDef + "gafi0001";
          |CARGA_DEF aDef, temp0001@;
          |SI FSalida = 0;
               |ABRE #500;
               |LEE 000#500.p;
               |SI FSalida = 0;
                    |SI nModo = 1; |Y #500#2 = "S"; |Y #0Campo = 0;
                         #0Campo = #500#1;
                         |PINTA #0Campo;
                    |FINSI;
               |FINSI;
               |CIERRA #500;
          |FINSI;
          |DESCARGA_DEF #temp0001@;
     |FINSI;
|FPRC;

|PROCESO Minimo; |TIPO 0;
     aFabre = "";
     |DIRECTORIO aFabre;
     aFabre = "rt  " + aFabre + "laboral/bin/gafi0001.tab";
     |FABRE aFabre;
     |SI FSalida ] 0;
          |FCIERRA FSalida;
          |DDEF aDef;
          |QBF aDef;
          aAlfa = aDef % 0111;
          |SI aAlfa = "/u/dsprofes";    || estoy en produccion
               |ACABA;             || no me compruebes nada
          |FINSI;
          aDef = aDef + "gafi0001";
          |CARGA_DEF aDef, temp0001@;
          |SI FSalida = 0;
               |ABRE #500;
               |LEE 000#500.p;
               |SI FSalida = 0;
                    |SI #0Campo < #500#1; |Y #500#3 = "N";
                         alfa1 = #500#1;
                         alfa1 = "    Se aplicara la retencion minima definida (" + alfa1;
                         alfa1 = alfa1 + "%).";
                         |MENAV alfa1
                         #0Campo = #500#1;
                         |PINTA #0Campo;
                    |FINSI;
               |FINSI;
               |CIERRA #500;
          |FINSI;
          |DESCARGA_DEF #temp0001@;
     |FINSI;
|FPRC;

|PROCESO modulo; |TIPO 0;
     |SI #0#42 = "L";|O #0#42 = "N";
          aFabre = "";
          |DIRECTORIO aFabre;
          aFabre = "rt  " + aFabre + "laboral/bin/noyprepa.tab";
          |FABRE aFabre;
          |SI FSalida ] 0;
               |FCIERRA FSalida;
          |SINO;
               |MENAV "    Modulo especial requerido no instalado ...";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja73Ftraba;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73Ftraba;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO ConsClavePerc; |TIPO 66;
     |SI Campo = 99; |O Campo = 100; |O Campo = 101;
          nClave = Campo;
          nSubCl = Campo + 3;
     |FINSI;
     |SI Campo = 102; |O Campo = 103; |O Campo = 104;
          nClave = Campo - 3;
          nSubCl = Campo;
     |FINSI;

     enEjerIRPF = 2999;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #labtraba#nClave#;
     #dsmom073#2 = #labtraba#nSubCl#;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73Ftraba, Alta73Ftraba;
     |SI FSalida = 0;
          #labtraba#nClave# = #dsmom073#1;
          #labtraba#nSubCl# = #dsmom073#2;
          |PINTA #labtraba#nClave#;
          |PINTA #labtraba#nSubCl#;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO CompClavePerc; |TIPO 0;
     |SI #labtraba#42 = "e";  |O #labtraba#122 = "e";
                              || dejamos pasar la clave "e" y que pongan
          |ACABA;             || lo que quieran
     |FINSI;
     nClave = Campo - 3;
     nSubCl = Campo;
     nEnEsp = Campo + 3;
     nReper = Campo + 6;
     |SI #labtraba#nClave# = " "; |Y #labtraba#nSubCl# = "  ";
          #labtraba#nEnEsp# = "N";
          #labtraba#nReper# = "N";
          |PINTA #labtraba#nEnEsp#;
          |PINTA #labtraba#nReper#;
          |ACABA;
     |FINSI;

     enEjerIRPF = 2999;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #labtraba#nClave#;
     #dsmom073#2 = #labtraba#nSubCl#;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |ERROR;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO EnEspecie; |TIPO 7;
     nClave = Campo - 6;
     nSubCl = Campo - 3;
     nEnEsp = Campo;
     nReper = Campo + 3;

     |C_M #labtraba#nEnEsp#, 1, "S";
     |C_M #labtraba#nReper#, 1, "S";

     |SI #labtraba#42 = "e";  |O #labtraba#122 = "e";
                              || dejamos pasar la clave "e" y que pongan
          |ACABA;             || lo que quieran
     |FINSI;

     enEjerIRPF = 2999;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #labtraba#nClave#;
     #dsmom073#2 = #labtraba#nSubCl#;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;  |O #dsmom073#5 = "N";
          #labtraba#nEnEsp# = "N";
          #labtraba#nReper# = "N";
          |PINTA #labtraba#nEnEsp#;
          |PINTA #labtraba#nReper#;
          |C_M #labtraba#nEnEsp#, 1, "N";
          |C_M #labtraba#nReper#, 1, "N";
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO Repercute; |TIPO 7;
     nEnEsp = Campo - 3;
     nReper = Campo;
     aAlfa1 = #labtraba#nEnEsp#;
     |C_M #labtraba#nReper#, 1, aAlfa1;
     |SI aAlfa1 = "N";
          #labtraba#nReper# = "N";
          |PINTA #labtraba#nReper#;
     |FINSI;
|FPRC;

|PROCESO TipoRelacion; |TIPO 7;
     |SI #labtraba#99 = "A";|O #labtraba#100 = "A";|O #labtraba#101 = "A";
          |C_M #labtraba#111, 1, "S";
     |SINO;
          |C_M #labtraba#111, 1, "N";
          #labtraba#111 = 0;
          |PINTA #labtraba#111;
     |FINSI;
|FPRC;

|PROCESO GrabaTRelacion; |TIPO 0;
     |HAZ Grabanomir003;
|FPRC;

|PROCESO BuscaDNI_3;
     aAlfa = #0#36;
     fFechaNuevo = aAlfa;
     |SI fFechaNuevo > fFecha;
          fFecha = fFechaNuevo;
          nRelacion = #0#111;
          nEstimacion = #0#130;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaDNI_3;
     #0#7
     ;
     #0#7, #0#0, 00001;
     #0#7, #0#0, 99999;
     ;
     NULL, BuscaDNI_3;
|FIN;

|PROCESO Grabanomir003;
     fFecha = ~;
     aAlfa = fFecha;
     aAlfa = aAlfa % -104;
     nume1 = aAlfa;

     |SALVA_FICHA #labtraba;
     fFecha = "01.01.1900";
     |BUCLE BuscaDNI_3;

     |REPON_FICHA #labtraba;

     |HAZ BuscaDNI_3;

     |ABRE #nomir003;
     #nomir003#0 = #0#7;
     #nomir003#40 = nume1;
     #nomir003#41 = #0#0;
     |LEE 101#nomir003.=;
     |SI FSalida = 0;
          || #nomir003#5 = #0#111;
          || #nomir003#121 = #0#130;
          #nomir003#5 = nRelacion;
          #nomir003#121 = nEstimacion;
          |GRABA 020#nomir003.a;
          |LIBERA #nomir003;
     |FINSI;
     |CIERRA #nomir003;
|FPRC;

|PROCESO CambiaAlgo; |TIPO 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 2; |O nLabornet = 1; |ACABA;   |FINSI;

     aAlfa1 = Contenido;
     |SI #labtraba#Campo# ! aAlfa1;
          |MENAV "    ATENCION. Si se modifica el valor de este campo, ES OBLIGATORIO calcular acumulados.";
          |CONFI "0000N¿Está seguro de que desea modificarlo? (S/N): ";
          |SI FSalida ! 0;
               #labtraba#Campo# = aAlfa1;
               |PINTA #labtraba#Campo#;
          |SINO;
               |SI Campo ] 99;|Y Campo [ 101;
                    |SI #labtraba#Campo# = "L";
                         |MENAV "0000La clave para bases exentas es automatica ...";
                         |MENAV "0000No necesita informarla aqui ...";
                         |ERROR;
                    |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO RellenaContrato; |TIPO 0;
     nTecla = FSalida;
     aAlfa1 = #labtraba#45;
     |QBF aAlfa1;
     aAlfa1 = ("000" + aAlfa1) % -103;
     #labtraba#45 = aAlfa1;
     |PINTA #labtraba#45;
|FPRC;

|PROCESO Comp212; |TIPO 0;
     swSigue = 0;
     |SI #0#212 ] 1; |Y #0#212 [ 6;
          swSigue = 1;
     |FINSI;
     |SI #0#212 ] 13; |Y #0#212 [ 16;
          swSigue = 1;
     |FINSI;
     |SI #0#212 = 9; |O #0#212 = 11;
          swSigue = 1;
     |FINSI;
     |SI swSigue = 0;
          |ERROR;
     |FINSI;
     |SI #0#212 = 9;
          #0#211 = 0;
          |PINTA #0#211;
     |FINSI;
|FPRC;

|PROCESO PintaBancoT;  |TIPO 14;
     enCodBanco = #0#71;
     |HAZ LeeBancos;

     |ATRI I;  |PINTA 2239, #709#1;  |ATRI I;
|FPRC;

|PROCESO Avisa112; |TIPO 0;
     |SI Contenido ! " ";
          |SI #0#112 ! Contenido;
               aAlfa = "    Es necesario volver a calcular la nómina ";
               aAlfa = aAlfa + "para que la SS Empresa sea la correcta tras este cambio";
               |MENAV aAlfa;
          |FINSI;
     |SINO;
          |SI #0#112 = "S";
               aAlfa = "    Es necesario volver a calcular la nómina ";
               aAlfa = aAlfa + "para que la SS Empresa sea la correcta tras este cambio";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Min;
     #nomtrato#0 = #labtraba#247;
     #nomtrato#1 = 000;
|FPRC;

|PROCESO Max;
     #nomtrato#0 = #labtraba#247;
     #nomtrato#1 = 999;
|FPRC;

|PROCESO ValidaContrato;
     |SI FSalida = 13;
          |ABRE #nomtrato;
          |CONSULTA_F_CLAVE #1#nomtrato, Min, Max;
          |SI FSalida = 0;
               #0Campo = #nomtrato#1;
          |FINSI;
          |HAZ RellenaContrato;
          |CIERRA #nomtrato;
     |SINO;
          |SI #labtraba#247 = "0112";
               |ACABA;
          |FINSI;
          aAlfa = #labtraba#45;
          |QBF aAlfa;
          /*
          |SI aAlfa = ""; |O aAlfa = "000";
               aAlfa = "    El Codigo de Contrato del trabajador no puede estar vacio";
               |MENAV aAlfa;
               |ERROR;
               |ACABA;
          |FINSI;
          */

          ||SI nModo = 1;
               |ABRE #nomtrato;
               nNume = #labtraba#45;
               #nomtrato#0 = #labtraba#247;
               #nomtrato#1 = nNume;
               |LEE 000#nomtrato.=;
               |SI FSalida ! 0;
||O nNume = 0;
                    aAlfa = "    El contrato " + #labtraba#45 + " no existe en el Mantenimiento ";
                    aAlfa = aAlfa + "de Contratos. Pulse F5 para ver los existentes."
                    |MENAV aAlfa;
                    |ERROR;
               |FINSI;
               |CIERRA #nomtrato;
          ||FINSI;
     |FINSI;
|FPRC;

|PROCESO BuscaCat;
     |ABRE #nomcateg;
     #nomcateg#0 = #0#87;
     #nomcateg#1 = #0#17;
     |LEE 000#nomcateg.=;
     |SI FSalida = 0;
          |SI nModo = 1; |O #0Campo ! nAntCat;
               |SI #labtraba#42 ! "X"; |Y #labtraba#42 ! "T";
                    |SI nModo = 2; |Y #labtraba#42 ! #nomcateg#4;
                         aAlfa = "    ATENCION. Se cambiará la clave de salario de ";
                         aAlfa = aAlfa + #labtraba#42 + " a " + #nomcateg#4;
                         aAlfa = aAlfa + " debido al cambio de Categoría";
                         |MENAV aAlfa;
                    |FINSI;
                    #labtraba#42 = #nomcateg#4;
                    #labtraba#64 = #nomcateg#5;
                    |PINTA #labtraba#42;
                    |PINTA #labtraba#64;
               |FINSI;
               #labtraba#33 = #nomcateg#3;
               |PINTA #labtraba#33;
          |FINSI;
     |FINSI;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO MinCat;
     #nomcateg#0 = #0#87;
     #nomcateg#1 = 001;
|FPRC;

|PROCESO MaxCat;
     #nomcateg#0 = #0#87;
     #nomcateg#1 = 999;
|FPRC;

|PROCESO ConsultaCat; |TIPO 66;
     |ABRE #nomcateg;
     |CONSULTA_F_CLAVE #1#nomcateg, MinCat, MaxCat;
     |SI FSalida = 0;
          #0Campo = #nomcateg#1;
     |FINSI;
     |PINTA #0Campo;
     |CIERRA #nomcateg;
|FPRC;

|PROCESO MinConst;
     |SI #0#247 = 132;
          #nomconst#88 = 111;
     |SINO;
          |SI #0#247 = 163;
               #nomconst#88 = 613;
          |SINO;
               #nomconst#88 = #0#247;
          |FINSI;
     |FINSI;
     #nomconst#79 = aAlfa1;
     #nomconst#0 = 001;
|FPRC;

|PROCESO MaxConst;
     |SI #0#247 = 132;
          #nomconst#88 = 111;
     |SINO;
          |SI #0#247 = 163;
               #nomconst#88 = 613;
          |SINO;
               #nomconst#88 = #0#247;
          |FINSI;
     |FINSI;
     #nomconst#79 = aAlfa2;
     #nomconst#0 = 999;
|FPRC;

|PROCESO ConsultaConst; |TIPO 0;
     inkey = FSalida;
     |ABRE #nomconst;
     |SI inkey = 13;
          fecsys = ~;
          aAlfa = fecsys;
          aAlfa1 = "01.01." + (aAlfa % -104);
          aAlfa2 = "31.12." + (aAlfa % -104);
          |CONSULTA_F_CLAVE #4#nomconst, MinConst, MaxConst;
          |SI FSalida = 0;
               #0Campo = #nomconst#0;
          |FINSI;
          |PINTA #0Campo;
     |SINO;
          |SELECT #5#nomconst;
          |SI #0#247 = 132;
               #nomconst#88 = 111;
          |SINO;
               |SI #0#247 = 163;
                    #nomconst#88 = 613;
               |SINO;
                    #nomconst#88 = #0#247;
               |FINSI;
          |FINSI;
          #nomconst#0 = #0Campo;
          |LEE 000#nomconst.=;
          |SI FSalida ! 0; |Y #0#247 ! 521; |Y #0#247 ! 112; |Y #0#247 ! 138;
               aAlfa = "    ERROR: Constante no encontrada en el Fichero de Constantes. ";
               aAlfa = aAlfa + "Pulse F5 para consultar disponibles."
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
     |FINSI;
     |CIERRA #nomconst;
|FPRC;

|PROCESO Avisa35;
     |SI #0Campo ! Contenido;
          aAlfa1 = "    ATENCION: Este porcentaje se actualiza automaticamente";
          aAlfa1 = aAlfa1 + " al calcular la nomina segun normativa legal";
          |MENAV aAlfa1;
          aAlfa1 = "     Esta seguro de que desea cambiarlo manualmente?"
          |CONFI aAlfa1;
          |SI FSalida ! 0;
               #0Campo = Contenido;
               |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO AltaCat; |TIPO 0;
     |SI nModo = 1;
          |SI #0#36 ! #0#253;
               aAlfa = "     ATENCION: Fecha de alta NO coincide con Fecha ";
               aAlfa = aAlfa + "de ingreso en categoria. Rectificar?";
               |CONFI aAlfa;
               |SI FSalida = 0;
                    #0#253 = #0#36;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ProrrPagas;
     |SI nModo = 1; |Y #0#0 = #labempre#0; |Y #labempre#0 ! 00000;
          |PARA nCampo = 113; |SI nCampo [ 120; |HACIENDO nCampo = nCampo + 1;
               nCampo1 = nCampo - 60;
               |SI #labtraba#nCampo# ! "S";
                    || para asegurarme de que en modo alta nunca se cambie de
                    || "N" a "S" por el problema de que se ponga la empresa
                    || a cero que no reproducimos. Si ya se ha puesto a "S"
                    || dando el alta, que no se pueda cambiar.
                    #labtraba#nCampo# = #labempre#nCampo1#;
               |FINSI;
               |SI #labtraba#nCampo# = " ";
                    #labtraba#nCampo# = "N";
               |FINSI;
          |SIGUE;
     |FINSI;
|FPRC;

|PROCESO DefectoCon; |TIPO 7;
     |SI #0Campo > 0; |Y #0Campo < 101;
          #0Campo = 0;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO BuscaCon_labtraba; |TIPO 0;
     |SI FSalida = 13;
          aAlfa = "SELECT nomconli.2,nomconli.6 FROM nomconli INTO tm" + Usuario;
          aAlfa = aAlfa + ".def WHERE 0 == " + #labtraba#87;
          |SQL aAlfa;
          |SI FSalida ! 0;
               |MENAV "    No hay definidos conceptos en el convenio";
               |ERROR;
               |ACABA;
          |FINSI;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/tm" + Usuario + ".mas";
          |CARGA_DEF aAlfa , temp0001@;
          |SI FSalida = 0;
               aAlfa = "tm" + Usuario; |NOME_DAT #500 aAlfa;
               |ABRE #temp0001@;
               nModo = 2 + 4 + 8 + 16;
               nPos1 = 1723; nPos2 = 2380;
               |C_V #temp0001@#0, 1, "S";
               |C_V #temp0001@#1, 1, "S";
               |LINEAL_SIMPLE #1#temp0001@,nModo, nPos1, nPos2, NULL, NULL, NULL;
               |SI FSalida = 0;
                    #labtraba#213 = #temp0001@#0;
                    |PINTA #labtraba#213;
               |SINO;
                    #labtraba#213 = 000;
                    |PINTA #labtraba#213;
               |FINSI;
               |CIERRA #temp0001@;
               |DELINDEX #temp0001@;
               |DESCARGA_DEF #temp0001@;
          |FINSI;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/tm" + Usuario + ".mas";
          |FBORRA aAlfa;
          |ACABA;
     |FINSI;
     |SI FSalida = 14;
          |HAZ SinAjuste;
     |FINSI;
|FPRC;

|PROCESO ConsultaCon;
     |SI #0Campo ! 0;
          |ABRE #nomconli;
          #nomconli#0 = #labtraba#87;
          #nomconli#2 = #labtraba#213;
          |LEE 000#nomconli.=;
          |SI FSalida ! 0;
               |MENAV "    El concepto no esta definido en el convenio.";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ConsultaCal; |TIPO 66;
     aAlfa1 = #0#8; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa2 = #0#9; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
     aCodPos = aAlfa1 + aAlfa2;
     nOpcionPLB = 0;
     |HAZ ConsCalenPLB;
     |SI nOpcionPLB ! 0;
          #0Campo = nOpcionPLB;
          |PINTA #0Campo;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Calendario; |TIPO 7;
     nModo = (nfEntrada / 100) ! 0;

     |SI nModo = 1;
          |ABRE #labcentr;
          #labcentr#0 = #0#0;
          #labcentr#1 = #0#77;
          |LEE 000#labcentr.=;
          |SI FSalida = 0; |Y #labcentr#15 ! 0;
               nume1 = #labcentr#15;
          |SINO;
               |ABRE #labempre;
               #labempre#0 = #0#0;
               |LEE 000#labempre.=;
               |SI FSalida = 0;
                    nume1 = #labempre#34;
               |FINSI;
               |CIERRA #labempre;
          |FINSI;
          |SI #0Campo ! nume1; |Y #0Campo = 1;
               #0#156 = nume1;
               |PINTA #0#156;
          |FINSI;
     |FINSI;
/*
     |SI nume1 ! #0#156;
          alfa1 = "     ATENCION. El Calendario Laboral del Trababador no es ";
          alfa1 = alfa1 + "el mismo que el del centro. Desea asignar el del centro?";
          |CONFI alfa1;
          |SI FSalida = 0;
               #0#156 = #labcentr#15;
               |PINTA #0#156;
          |FINSI;
     |FINSI;
     |CIERRA #labcentr;
*/
|FPRC;

|PROCESO ConvCentr; |TIPO 7;
     nModo = (nfEntrada / 100) ! 0;

     |SI nModo = 1;
          |ABRE #labcentr;
          #labcentr#0 = #0#0;
          #labcentr#1 = #0#77;
          |LEE 000#labcentr.=;
          alfa1 = #labcentr#19;
          |QBF alfa1;
          |SI FSalida = 0; |Y alfa1 ! "";
               #0#87 = #labcentr#16;
               |PINTA #0#87;
               |ABRE #nomconca;
               #nomconca#0 = #0#87;
               |LEE 000#nomconca.=;
               |SI FSalida = 0;
                    #0#25 = #nomconca#1;
               |FINSI;
               |CIERRA #nomconca;
          |FINSI;
          |CIERRA #labcentr;
     |FINSI;
|FPRC;

|PROCESO Convenio;
     |ABRE #nomconca;
     #nomconca#0 = #labtraba#87;
     |LEE 000#nomconca.=;
     |SI FSalida ! 0;
          aAlfa = "    ATENCION: El convenio no esta definido. Pulse F5 ";
          aAlfa = aAlfa + "para consultar los convenios exstentes";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |CIERRA #nomconca;
|FPRC;

|PROCESO MinCon;
     #nomconca#0 = 1;
|FPRC;

|PROCESO MaxCon;
     #nomconca#0 = 999;
|FPRC;

|PROCESO ListaConv;
     |SI FSalida = 13;
          |ABRE #nomconca;
          |CONSULTA_F_CLAVE #1#nomconca, MinCon, MaxCon;
          |SI FSalida = 0;
               #labtraba#87 = #nomconca#0;
               |PINTA #labtraba#87;
          |FINSI;
          |CIERRA #nomconca;
     |FINSI;
|FPRC;

|PROCESO ImporteAjus; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; || solo en modo alta esta ayuda
          |SI #0#97 ! 0;
               |SI #0#98 [ 100;
                    #0#207 = "D";
               |SINO;
                    #0#207 = "M";
               |FINSI;
          |SINO;
               #0#207 = " ";
          |FINSI;
     |FINSI;
     |PINTA #0#207;
|FPRC;

|PROCESO minaju;
     #nomtraju#0 = #0#0;
     #nomtraju#1 = #0#1;
     #nomtraju#2 = 000;
|FPRC;

|PROCESO maxaju;
     #nomtraju#0 = #0#0;
     #nomtraju#1 = #0#1;
     #nomtraju#2 = 499;
|FPRC;

|PROCESO SinAjuste;
     |PUSHV 13342338;
     |SI #0#97 ! 0;
          |ENTLINEAL #1#nomtraju, 3, 1, 22, 1, minaju, maxaju;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO SinAjusteVer; |TIPO 7;
     |SI #0#97 ! 0;
          |ENTLINEAL #1#nomtraju, 3, 7, 22, 1, minaju, maxaju;
     |FINSI;
|FPRC;

|PROCESO SAFin;
     |PINTA 1333, "  ³ÀÄÂ";
     |PINTA 1433, "ÄÄÙ  ³";
     |PINTA 1533, "     Ú";
     |PINTA 1633, "     ³";
     |PINTA 1733, "     ³";
     |PINTA 1833, "     ³";
     |PINTA 1933, "     ³";
     |PINTA 2033, "     ³";
     |PINTA 2133, "     ³";
     |PINTA 2233, "     ³";
|FPRC;

|PROCESO EspBruto; |TIPO 7;
|ACABA;
     |SI #0#176 ! "S"; |Y #0#176 ! "N";
          #0#176 = "N";
          |PINTA #0#176;
     |FINSI;

     |SI #0#97 = 3; |O #0#97 = 4; |O #0#97 = 6;
          |CAMPO_MODIFICA #0#176, 1, "S";
          |CAMPO_MODIFICA #0#214, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#176, 1, "N";
          |CAMPO_MODIFICA #0#214, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ImpBruto; |TIPO 7;
|ACABA;
     |SI #0#176 = "S";
          |CAMPO_MODIFICA #0#214, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#214, 1, "N";
          #0#214 = 0;
          |PINTA #0#214;
     |FINSI;
|FPRC;

|PROCESO labvaltb;
     |BORRA 020#labvaltb.a;
|FPRC;

|DEFBUCLE labvaltb;
     #labvaltb#1;
     ;
     "labtraba", 000, aEmp_borr, aTra_borr, blanco, blanco, blanco;
     "labtraba", 999, aEmp_borr, aTra_borr, blanco, blanco, blanco;
     be;
     NULL, labvaltb;
|FIN;

|PROCESO labpadre_R;
|| lo quito, a partir de ahora que nos muestre lo que hay en el labtraba
|| y si no que usen el proceso de pase del labpadre al labtraba
|| salvo en alta o en modificacion, ahi s¡ mira

     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa = "labtraba";
         enEmpresa = #labtraba#0;
         |HAZ MiraBloqueo;
         |SI eaBloqueo = "3";
             |ERROR;
             |PTEC 807;
         |FINSI;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3; |O nModo = 4;
          |ACABA;
     |FINSI;

     |ABRE #labpadre;
     #labpadre#0 = #0#0;
     #labpadre#1 = #0#1;
     |LEE 101#labpadre.=;
     |SI FSalida = 0;
          aAlfa = #labtraba#249; |QBF aAlfa;
          |SI aAlfa = "";
               #labtraba#249 = #labpadre#2;
          |FINSI;
          aAlfa = #labtraba#250; |QBF aAlfa;
          |SI aAlfa = "";
               #labtraba#250 = #labpadre#3;
          |FINSI;
          aAlfa = #labtraba#251; |QBF aAlfa;
          |SI aAlfa = "";
               #labtraba#251 = #labpadre#4;
          |FINSI;
          aAlfa = #labtraba#252; |QBF aAlfa;
          |SI aAlfa = "";
               #labtraba#252 = #labpadre#5;
          |FINSI;

          #0#249 = #labtraba#249;
          #0#250 = #labtraba#250;
          #0#251 = #labtraba#251;
          #0#252 = #labtraba#252;
          |PINTA #0#249;
          |PINTA #0#250;
          |PINTA #0#251;
          |PINTA #0#252;
     |FINSI;
     |CIERRA #labpadre;
|FPRC;

|PROCESO labpadre_R2; |TIPO 7;
     |HAZ labpadre_R;

     |SI nLabornet = 1;
          |SI #labtraba#0 = 1;
               || la empresa 00001 por ser la empresa por defecto no la pinta
               || cosas del basico
               |ABRE #labempre;
               #labempre#0 = #labtraba#0;
               |LEE 000#labempre.=;
               |SI FSalida = 0;
                    |PINTA 0638, #labempre#2;
               |FINSI;
               |CIERRA #labempre;
          |FINSI;

          #labtraba#18 = #3#2;
          |PINTA #labtraba#18;
     |FINSI;
|FPRC;

|PROCESO NetContrata;
     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/labcontr.mas";
     |CARGA_DEF aAlfa, temp0001@;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #temp0001@#aAlfa#;

     |SI FSalida = 0;
          |ABRE #temp0001@;
          |LEE 000#temp0001@.p;
          aAlfa = #temp0001@#61;
          |CIERRA #temp0001@;
     |FINSI;
     |DESCARGA_DEF #temp0001@;

     |SI aAlfa ! "S";
          |ACABA;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     aAlfa = Usuario % 0810;
     |QBF aAlfa;
     |SI nModo = 1; || solo en alta
          |GRABA 020#labtraba.a;
          aAlfa1 = #labtraba#0; aAlfa1 = ("00000" + aAlfa1) % -105;
          aAlfa2 = #labtraba#1; aAlfa2 = ("00000" + aAlfa2) % -105;
          aTrab = aAlfa1 + aAlfa2;
          aAlfa = "labnct02;" + aTrab;
          |SUB_EJECUTA aAlfa;
     |FINSI;
|FPRC;

|PROCESO labpadre_G; |TIPO 3;
     |ABRE #labpadre;
     #labpadre#0 = #labtraba#0;
     #labpadre#1 = #labtraba#1;
     |LEE 101#labpadre.=;
     FEstado = FSalida;
     |SI FEstado = 0;
          #labpadre#2 = #labtraba#249;
          #labpadre#3 = #labtraba#250;
          #labpadre#4 = #labtraba#251;
          #labpadre#5 = #labtraba#252;
          |GRABA 020#labpadre.a;
     |SINO;
          #labpadre#0 = #labtraba#0;
          #labpadre#1 = #labtraba#1;
          #labpadre#2 = #labtraba#249;
          #labpadre#3 = #labtraba#250;
          #labpadre#4 = #labtraba#251;
          #labpadre#5 = #labtraba#252;
          |GRABA 020#labpadre.n;
     |FINSI;
     |CIERRA #labpadre;

     |HAZ NetContrata;
     |HAZ Grabanomir003;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O nLabornet = 1;
          || para traerse importes del dsam0017, que son los embargos introducidos
          || por el asistente de embargos, para casos de trabajadores que tuvieran
          || embargos alli introducidos antes de darlos de alta en laboral
          aAlfa1 = #0#0; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
          aAlfa2 = #0#1; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;
          aAlfa3 = #0#7;
          aFechaAlta = #labtraba#36;
          aAlfa = "nomembin;" + aAlfa1 + aAlfa2 + aAlfa3;
          |SUB_EJECUTA aAlfa;
     |FINSI;

     aAlfa = #labtraba#184;
     aAlfa = aAlfa % 102;
     nNume = aAlfa;
     |SI sw902 = 1;
     |Y nNume = nMotivo; || para comprobar que no se ha salido con Ctrl+Q
                         || o Correcto NO ... pensaba que esto lo haria
                         || el TIPO 3, pero he visto que no
          |HAZ Variacion;
     |FINSI;
|FPRC;
/*
|PROCESO CB; |TIPO 12;
     |SI FSalida ! 0; |Y FSalida ! 1; |Y FSalida ! 5; |Y nModo = 1;
          aTra_borr = #labtraba#1;
          aTra_borr = aTra_borr + blanco - "     ";
          aEmp_borr = #labtraba#0;
          aEmp_borr = aEmp_borr + blanco - "     ";
          |BUCLE labvaltb;
     |FINSI;
     |SI FSalida = 1; |O FSalida = 5;
          |CONFI "     ES CORRECTO?";
          |SI FSalida ! 0;
               |ERROR;
               |PTEC 807;
          |FINSI;
     |FINSI;
|FPRC;
*/
|PROCESO MiraCP;
   nTecla = FSalida;

   |ABRE #labmunic; |DDEFECTO #labmunic;

   aAlfa = (("00" + #labtraba#8) % -102) + (("000" + #labtraba#9) % -103);
   #labmunic#4 = aAlfa;
   |LEE 000#labmunic.];
   |SI FSalida = 0; |Y #labmunic#4 = aAlfa;
      |SALVA_FICHA #labmunic;
      |LEE 000#labmunic.s;
      |SI FSalida = 0; |Y #labmunic#4 = aAlfa;
         nSwUno = 0;
      |SINO;
         nSwUno = 1;
      |FINSI;
      |REPON_FICHA #labmunic;
      |SI nSwUno = 0;
         |SI nTecla = 11;
            aCodPos = #labmunic#4;
            |SUB_EJECUTA "labmunic.tab";
            #labmunic#1 = aCodigoMunicipio;
            #labmunic#4 = aCodPos;
            |LEE 000#labmunic.=;
            |SI FSalida ! 0; |DDEFECTO #labmunic; |FINSI;
            #labtraba#6 = #labmunic#3; |PINTA #labtraba#6;
         |SINO;
            aAlfa = (("00" + #labtraba#8) % -102) + (("000" + #labtraba#9) % -103);
            #labmunic#4 = aAlfa;
            |LEE 000#labmunic.];
            |PARA; |SI FSalida = 0; |Y #labmunic#4 = aAlfa; |HACIENDO;
               aAlfa1 = #labmunic#3; |QBF aAlfa1; aLong = aAlfa1 % 0; nCalc1 = aLong;
               aAlfa2 = #labtraba#6; |QBF aAlfa2; aLong = aAlfa2 % 0; nCalc2 = aLong;
               |SI nCalc1 ] nCalc2;
                  nCalc = 100 + nCalc2; aAlfa = aAlfa % nCalc;
               |SINO;
                  nCalc = 100 + nCalc1; aAlfa1 = aAlfa1 % nCalc;
               |FINSI;
               |SI aAlfa1 = aAlfa2; |SAL; |FINSI;
               |LEE 000#labmunic.s;
            |SIGUE;
            |SI aAlfa1 ! aAlfa2;
               aCodPos = (("00" + #labtraba#8) % -102) + (("000" + #labtraba#9) % -103);
               |SUB_EJECUTA "labmunic.tab";
               #labmunic#1 = aCodigoMunicipio;
               #labmunic#4 = aCodPos;
               |LEE 000#labmunic.=;
               |SI FSalida ! 0; |DDEFECTO #labmunic; |FINSI;
               #labtraba#6 = #labmunic#3; |PINTA #labtraba#6;
            |FINSI;
         |FINSI;
      |FINSI;
      |SI nSwUno = 1;
         #labtraba#6 = #labmunic#3; |PINTA #labtraba#6;
      |FINSI;
   |SINO;
      |MENAV "    No se encuentra el codigo postal en la tabla de municipios"; |ERROR;
   |FINSI;
   |CIERRAT #tdpmunic; |CIERRA #labmunic;
|FPRC;

|PROCESO ActCP;
   |ABRE #tdpmunic; |ABRE #labmunic;
   |SELECT #2#tdpmunic; |SELECT #3#labmunic;
   #tdpmunic#1 = #labtraba#6;
   |LEE 000#tdpmunic.=;
   |SI FSalida = 0;
      aAlfa = #tdpmunic#0; |QBF aAlfa;
      #labmunic#1 = #tdpmunic#0;
      |LEE 000#labmunic.];
      |PARA; |SI FSalida = 0; |Y #labmunic#1 = aAlfa; |HACIENDO;
         aAlfa1 = #labmunic#3; |QBF aAlfa1; aLong = aAlfa1 % 0; nCalc1 = aLong;
         aAlfa2 = #labtraba#6; |QBF aAlfa2; aLong = aAlfa2 % 0; nCalc2 = aLong;
         |SI nCalc1 ] nCalc2;
            nCalc = 100 + nCalc2; aAlfa1 = aAlfa1 % nCalc;
         |SINO;
            nCalc = 100 + nCalc1; aAlfa2 = aAlfa2 % nCalc;
         |FINSI;
         |SI aAlfa1 = aAlfa2; |SAL; |FINSI;
         |LEE 000#labmunic.s;
      |SIGUE;
      |SI aAlfa1 = aAlfa2;
         aAlfa = #labmunic#4;
         aAlfa1 = aAlfa % 0102; #labtraba#8 = aAlfa1; |PINTA #labtraba#8;
         aAlfa1 = aAlfa % 0303; #labtraba#9 = aAlfa1; |PINTA #labtraba#9;
      |FINSI;
   |FINSI;
   |CIERRA #tdpmunic; |CIERRA #labmunic;
|FPRC;

|PROCESO RellenaDias; |TIPO 7;
     swSigue = 0;

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          swSigue = 1;
     |FINSI;
     |SI #0Campo ! "N"; |Y #0Campo ! "L";
          swSigue = 1;
     |FINSI;

     |SI swSigue = 1;
          |ABRE #nomconca;
          #nomconca#0 = #0#87;
          |LEE 000#nomconca.=;
          |SI FSalida = 0;
               #0#126 = #nomconca#160;
               |PINTA #0#126;
          |FINSI;
          |CIERRA #nomconca;
     |FINSI;
|FPRC;

|PROCESO RellenaSi; |TIPO 7;
     |SI #0Campo ! "N";|Y #0Campo ! "S";
          #0Campo = "S";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO RellenaNo; |TIPO 7;
     |SI #0Campo ! "N";|Y #0Campo ! "S";
          #0Campo = "N";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO RellenaCero; |TIPO 7;
     |SI #0Campo ! "0";|Y #0Campo ! "2"; |Y #0Campo ! "4";
          #0Campo = "0";
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO AjusVac; |TIPO 0;
     |SI #0#180 ! "0"
          |CAMPO_MODIFICA #0#215, 1, "S";
          |CAMPO_MODIFICA #0#181, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0#215, 1, "N";
          |CAMPO_MODIFICA #0#181, 1, "N";
          #0#181 = "M";
          |PINTA #0#181;
          #0#215 = 0;
          |PINTA #0#215;
     |FINSI;
|FPRC;

|PROCESO CompEpig;
     |SI #0Campo = 0; |Y #0#42 ! "H"; |Y #0#45 ! "421"; |Y #0#45 ! "422";
          aAlfa = "    ATENCION: En necesario indicar el epigrafe del trabajador.";
          |MENAV aAlfa;
          |ERROR;
     |FINSI;
     |SI #0Campo ! 0; |Y #0#42 = "H";
          aAlfa = "    ATENCION: En trabajadores autonomos (clave H) ";
          aAlfa = aAlfa + " no se tendra en cuenta el epigrafe del trabajador.";
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO BuscaDNI;
     aNacidoEn = #labtraba#76;
     aSexo = #labtraba#252;
     aPadre = #labtraba#249;
     aMadre = #labtraba#250;
     aNroAfi = #labtraba#75;
     aFormaPago = #labtraba#70;
     nBanco = #labtraba#71;
     aCuenta = #labtraba#72;
     swExiste = 1;
     |SI swFacturacion = 1;
          swAlgunoMas = 1;
     |FINSI;
     aAlfa1 = #labtraba#0; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = #labtraba#1; aAlfa2 = ("00000" + aAlfa2) % -105;
     aTrab = aAlfa1 + "." + aAlfa2;
     |ERROR10;
|FPRC;

|DEFBUCLE BuscaDNI_2;
     #labtraba#2;
     ;
     #0#7;
     #0#7;
     ;
     NULL, BuscaDNI;
|FIN;

|DEFBUCLE BuscaDNI_1;
     #labtraba#5;
     ;
     #0#0, #0#7;
     #0#0, #0#7;
     ;
     NULL, BuscaDNI;
|FIN;

|PROCESO BuscaDatos;
     || Busca Datos para no tener que repetir en la ficha caso de que
     || ya exista el DNI

     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          swExiste = 0;
          aNacidoEn = "";
          aSexo = "";
          aPadre = "";
          aMadre = "";
          aNroAfi = "";
          nBanco = 000;
          aCuenta = "";
          swSigue = 0;
          aTrab = "";
          aFormaPago = "";
          swAlgunoMas = 0;    || para el facurable S/N despues

          |SALVA_FICHA #labtraba;
          |BUCLE BuscaDNI_1;
          |REPON_FICHA #labtraba;

          |SI swExiste ! 0;
               |HAZ TraeDatos;
          |SINO;
               |SI swFacturacion = 1;
                    |SI swAlgunoMas = 0;    || para el facturable S/N despues
                         #0#143 = "S";
                    |SINO;
                         #0#143 = "N";
                    |FINSI;
                    |PINTA #labtraba#143;
               |FINSI;

               |SALVA_FICHA #labtraba;
               |BUCLE BuscaDNI_2;
               |REPON_FICHA #labtraba;
               |SI swExiste ! 0;
                    |HAZ TraeDatos;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI swFacturacion = 1; |Y nLabornet = 1;
          #0#143 = "S";
          |PINTA #labtraba#143;
     |FINSI;
|FPRC;

|PROCESO TraeDatos;
     |QBF aNacidoEn;
     |QBF aSexo;
     |QBF aPadre;
     |QBF aMadre;
     |QBF aNroAfi;
     |QBF aCuenta;

     |SI aNacidoEn ! "";
          #0#76 = aNacidoEn;
     |FINSI;
     |SI aSexo ! "";
          #0#252 = aSexo;
     |FINSI;
     |SI aPadre ! "";
          #0#249 = aPadre;
     |FINSI;
     |SI aMadre ! "";
          #0#250 = aMadre;
     |FINSI;
     |SI aNroAfi ! "";
          #0#75 = aNroAfi;
     |FINSI;
     |SI nBanco ! 000;
          #0#71 = nBanco;
     |FINSI;
     aCuentaTra = #0#72;
     swSigue = 0;
     |QBF aCuentaTra;
     |SI aCuenta ! "";
          #0#70 = aFormaPago;
          #0#72 = aCuenta;
          swSigue = 1;
     |FINSI;
     |PINTA #0#76;
     |PINTA #0#252;
     |PINTA #0#249;
     |PINTA #0#250;
     |PINTA #0#75;

     |SI swSigue = 1;
          aAlfa = "    ATENCION: los datos bancarios se han actualizado según ";
          aAlfa = aAlfa + "los del código con mismo NIF " + aTrab;
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Autonomos;
     |SI nTecla = 13; |Y #0Campo = "H";
          |PUSHV 05012380;

          |ABRE #nomauto1;
          #nomauto1#0 = #0#0;
          #nomauto1#1 = #0#1;

          |CLS;
          |PINPA #0#nomauto1;
          |PINDA #0#nomauto1;

          |LEE 000#nomauto1.=;
          |SI FSalida = 0;
               |ENDATOS #2#nomauto1;
          |SINO;
               |ENDATOS #1#nomauto1;
          |FINSI;
          |CIERRA #nomauto1;

          |POPV;
     |FINSI;
|FPRC;

|PROCESO Irregulares;
|ACABA;
     |SI nTecla = 13; |Y #0Campo = "P";
          |SALVA_DATOS #labtraba;

          |PUSHV 05012380;

          fFecha = ~;
          aAlfa = fFecha; aAlfa = aAlfa % -104;
          nNume = aAlfa;

          |ABRE #nomcal01;
          #nomcal01#0 = #0#0;
          #nomcal01#1 = #0#1;
          #nomcal01#2 = nNume;

          |CLS;
          |PINPA #0#nomcal01;
          |PINDA #0#nomcal01;

          |LEE 000#nomcal01.=;
          |SI FSalida = 0;
               |ENDATOS #2#nomcal01;
          |SINO;
               |ENDATOS #1#nomcal01;
          |FINSI;
          |CIERRA #nomcal01;

          |REPON_DATOS #labtraba;

          |POPV;
     |FINSI;
|FPRC;

|PROCESO bomberos2;
     nNume = nNume + 1;
     nContrato = #500#2;
     nConstante = #500#4;
|FPRC;

|DEFBUCLE bomberos2;
     #500#1003;
     ;
     #labtraba#0, #labtraba#77, 001;
     #labtraba#0, #labtraba#77, 999;
     ;
     NULL, bomberos2;
|FIN;

|PROCESO bomberos1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;
          |ACABA;
     |FINSI;
     |SI swModulo = 1; |Y #0#0 = 112; swModulo = 3145; |FINSI;
     |SI swModulo = 3145;
          |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/bomb0002.mas";
          |CARGA_DEF aAlfa, temp0001@;
          |SI FSalida = 0;
               nNume = 0;
               |BUCLE bomberos2;
          |FINSI;
          |DESCARGA_DEF #temp0001@;
          |SI nNume = 1;
               #labtraba#45 = nContrato;
               #labtraba#248 = nConstante;
               |PINTA #labtraba#45;
               |PINTA #labtraba#248;
          |FINSI;
          |SI nNume > 1; |Y Campo ! 77;
               aAlfa = "SELECT * FROM bomb0002 INTO tm" + Usuario;
               aAlfa = aAlfa + " WHERE 0 == " + #labtraba#0;
               aAlfa = aAlfa + " AND 1 == " + #labtraba#77;
               |SQL aAlfa;
               |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/bomb0002.mas";
               |CARGA_DEF aAlfa , temp0001@;
               |SI FSalida = 0;
                    aAlfa = "tm" + Usuario; |NOME_DAT #500 aAlfa;
                    |ABRE #temp0001@;
                    nModo = 2 + 4 + 8 + 16;
                    nPos1 = 1334; nPos2 = 2380;
                    |LINEAL_SIMPLE #1#temp0001@,nModo, nPos1, nPos2, NULL, NULL, NULL;
                    |SI FSalida = 0;
                         #labtraba#45 = #temp0001@#2;
                         |PINTA #labtraba#45;
                         #labtraba#248 = #temp0001@#4;
                         |PINTA #labtraba#248;
                         |POSICIONATE #labtraba#32;
                    |FINSI;
                    |CIERRA #temp0001@;
               |FINSI;
               |DESCARGA_DEF #temp0001@;
               |ACABA;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO bomberos3;
     |SI swModulo = 1; |Y #0#0 = 112; swModulo = 3145; |FINSI;
     |SI Campo = 244;
          |SI FSalida = 2; |O FSalida = 4;
               |ACABA;
          |FINSI;
     |FINSI;
     |SI swModulo = 3145;
          nEmp = #0#0;
          nTra = #0#1;
          aAnt = #0#34;
          |SUB_EJECUTA "bomb0009";
     |FINSI;
|FPRC;

|PROCESO bomberos4; |TIPO 14;
     nModo = (FEntrada / 100) ! 0;
     nEnEmpresa = #0#0;
     |HAZ BuscaModulo;
     |SI swModulo = 3145; |Y nModo = 4;
          nEmp = #0#0;
          nTra = #0#1;
          aAnt = #0#34;
          |SUB_EJECUTA "bomb0009";
     |FINSI;
     |SI swModulo = 3145;
          |ATRI 0;
          |PINTA 1861, " %Solicitado:      ³";
          |CAMPO_MODIFICA #labtraba#175, 1, "N";
          |CAMPO_VISUAL #labtraba#175, 1, "N";

          |CAMPO_MODIFICA #labtraba#216, 1, "S";
          |CAMPO_POSICION #labtraba#216, 1, 1875;
          |CAMPO_VISUAL #labtraba#216, 1, "S";
          |PINTA #labtraba#216;
     |FINSI;
|FPRC;

|| BORRADO BONIFICACIONES FOMENTO EMPLEO

|PROCESO BorraBonFomEmp;
     |BORRA 020#nombotra.a;
     |LIBERA #nombotra;
|FPRC;

|DEFBUCLE BorraBonFomEmp;
     #nombotra#1;
     ;
     #labtraba#0, #labtraba#1, 001;
     #labtraba#0, #labtraba#1, 999;
     be;
     NULL, BorraBonFomEmp;
|FIN;

|PROCESO BuscaBonFomEmp;
     swExiste = 1;
|FPRC;

|DEFBUCLE BuscaBonFomEmp;
     #nombotra#1;
     ;
     #labtraba#0, #labtraba#1, 001;
     #labtraba#0, #labtraba#1, 999;
     ;
     NULL, BuscaBonFomEmp;
|FIN;

|PROCESO BoniFomComp;
     |SI Contenido = "N"; |O Contenido = " ";
          |SI #0Campo = "S"; |O #0Campo = "T";
               FSalida = 13;
               |HAZ BoniFom;
          |FINSI;
     |FINSI;
     |SI Contenido = "S"; |O Contenido = "T";
          |SI #0Campo = "N";
               |POPV;
               |BUCLE BorraBonFomEmp;

/*
               |ABRE #nombotra;
               |DDEFECTO #nombotra;
               #nombotra#0 = #0#0;
               #nombotra#1 = #0#1;

               |LEE 101#nombotra.=;
               |SI FSalida = 0;
                    |BORRA 020#nombotra.a;
               |FINSI;
               |LIBERA #nombotra;
               |CIERRA #nombotra;
*/
          |FINSI;
     |FINSI;
     |SI Contenido = "S"; |O Contenido = "T";
          |SI #0Campo = "S"; |O #0Campo = "T";
               |SI FSalida = 13;
                    |HAZ BoniFom;
               |FINSI;
               |POPV;
          |FINSI;
     |FINSI;
     |SI Contenido = "S"; |Y #0Campo = "T";
          FSalida = 13;
          |HAZ BoniFom;
     |FINSI;
     |SI Contenido = "T"; |Y #0Campo = "S";
          FSalida = 13;
          |HAZ BoniFom;
     |FINSI;
     |SI #0#121 = "S"; |O #0#121 = "T";
          swExiste = 0;
          |BUCLE BuscaBonFomEmp;
          |SI swExiste = 0;
               #0#121 = "N";
               |PINTA #0#121;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO BoniFomPinta; |TIPO 7;
     |SI #0#121 ! "S"; |Y #0#121 ! "N"; |Y #0#121 ! "T";
          #0#121 = "N";
          |PINTA #0#121;
     |FINSI;
     |SI #0#121 = "S"; |O #0#121 = "T";
          |PUSHV 17322380;
          |ENTLINEAL #1#nombotra, 3, 7, 20, 1, min_bon, max_bon;

          |ABRE #nombotra;
          |DDEFECTO #nombotra;
          #nombotra#0 = #0#0;
          #nombotra#1 = #0#1;
          #nombotra#2 = 101;
          |LEE 000#nombotra.];
          |SI FSalida = 0; |Y #nombotra#0 = #0#0; |Y #nombotra#1 = #0#1;
               |PINTA #nombotra#4;
               |PINTA #nombotra#5;
               |PINTA #nombotra#6;
               |PINTA #nombotra#7;
          |FINSI;

          |CIERRA #nombotra;

/*
          |ABRE #nombotra;
          |DDEFECTO #nombotra;
          #nombotra#0 = #0#0;
          #nombotra#1 = #0#1;

          |LEE 000#nombotra.=;
          |SI FSalida = 0;
               |PINPA #0#nombotra;
               |PINDA #0#nombotra;
          |FINSI;
          |CIERRA #nombotra;
*/
     |FINSI;
|FPRC;

|PROCESO max_bon;
     #nombotra#0 = #labtraba#0;
     #nombotra#1 = #labtraba#1;
     #nombotra#2 = 999;
|FPRC;

|PROCESO min_bon;
     #nombotra#0 = #labtraba#0;
     #nombotra#1 = #labtraba#1;
     #nombotra#2 = 101;
|FPRC;

|PROCESO BoniFom;
     |PUSHV 17322380;
/*
     |ABRE #nombotra;
     |DDEFECTO #nombotra;
     #nombotra#0 = #0#0;
     #nombotra#1 = #0#1;

     |LEE 101#nombotra.=;
     |SI FSalida = 0;
          |PINPA #0#nombotra;
          |PINDA #0#nombotra;
          |ENDATOS #2#nombotra;
*/

          |ENTLINEAL #1#nombotra, 3, -1, 20, 1, min_bon, max_bon;
          ||GRABA 020#nombotra.a;
/*
     |SINO;
          |DDEFECTO #nombotra;
          #nombotra#0 = #labtraba#0;
          #nombotra#1 = #labtraba#1;

          #nombotra#4 = #0#36;
          |PINPA #0#nombotra;
          |PINDA #0#nombotra;
          |ENDATOS #1#nombotra;
          |SI nBonif ! -1;
               |GRABA 020#nombotra.n;
          |SINO;
              #0#121 = "N";
              |PINTA #0#121;
          |FINSI;
     |FINSI;
*/

     || esto esta por retocar
     |SI #nombotra#2 ] 101; |Y #nombotra#2 [ 299; |Y #0#121 ! "S";
          #0#121 = "S";
          |PINTA #0#121;
     |FINSI;
     |SI #nombotra#2 ] 301; |Y #0#121 ! "T";
          #0#121 = "T";
          |PINTA #0#121;
     |FINSI;

     |LIBERA #nombotra;
     |CIERRA #nombotra;
     |POPV;

     |SI #0#121 = "S"; |O #0#121 = "T";
          swExiste = 0;
          |BUCLE BuscaBonFomEmp;
          |SI swExiste = 0;
               #0#121 = "N";
               |PINTA #0#121;
          |FINSI;
     |FINSI;

     |SI #0#121 = "N";
          swExiste = 0;
          |BUCLE BuscaBonFomEmp;
          |SI swExiste = 1;
               #0#121 = "N";
               |BUCLE BorraBonFomEmp;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ayuda122; |TIPO 7;
     |SI #0#122 ! " "; |Y #0#122 ! "1"; |Y #0#122 ! "2"; |Y #0#122 ! "3";
     |Y #0#122 ! "e";
          #0#122 = " ";
          |PINTA #0#122;
     |FINSI;
     |PUSHV 18272267;
     |ATRI R;
     ||            2  3         4         5         6
     ||            78901234567890123456789012345678901234567
     |PINTA 1827, " 1. Personal de alta direccion          ";
     |PINTA 1927, " 2. Deportistas profesionales           ";
     |PINTA 2027, " 3. Abogados en despacho de abogados    ";
     |PINTA 2127, " -------------------------------------- ";
     |PINTA 2227, " e. Agrarios no residentes (Mod. 216)   ";
|FPRC;

|PROCESO Ayuda212; |TIPO 7;
     |SI #0#212 ! 1; |Y #0#212 ! 2; |Y #0#212 ! 3; |Y #0#212 ! 4;
     |Y #0#212 ! 5; |Y #0#212 ! 6; |Y #0#212 ! 9;
     |Y #0#212 ! 13; |Y #0#212 ! 14; |Y #0#212 ! 15; |Y #0#212 ! 16;
     |Y #0#212 ! 11;
          #0#212 = 1;
          |PINTA #0#212;
     |FINSI;
     |PUSHV 08312380;
     ||            3       4         5         6         7         8
     ||            2345678901234567890123456789012345678901234567890
     |ATRI R;
     |PINTA 0833,  "         - Sin colectivo incentivado -         ";
     |ATRI 0;
     |PINTA 0933,  "01. Fecha de antigüedad                        ";
     |PINTA 1033,  "02. Fecha de alta                              ";
     |PINTA 1133,  "11. Fecha distinta de las anteriores           ";
     |ATRI R;
     |PINTA 1233,  "   - Colectivos industriales incentivados -    ";
     |ATRI 0;
     |PINTA 1333,  "03. Fecha de antigüedad (sector textil).       ";
     |PINTA 1433,  "04. Fecha de alta (sector textil).             ";
     |PINTA 1533,  "05. Fecha de antigüedad (sector calzado).      ";
     |PINTA 1633,  "06. Fecha de alta (sector calzado).            ";
     |PINTA 1733,  "13. Fecha de antigüedad (sector juguete).      ³";
     |PINTA 1833,  "14. Fecha de alta (sector juguete).            ³";
     |PINTA 1933,  "15. Fecha de antigüedad (sector mueble).       ³";
     |PINTA 2033,  "16. Fecha de alta (sector mueble).             ³";
     |PINTA 2132, "³-----------------------------------------------";
     |PINTA 2232, "³09. NO aplicar esta bonificación.              ";
     |PINTA 2332, "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";
     |ATRI 0;
     |ATRI R;
     |PINTA 0933, "01.";
     |PINTA 1033, "02.";
     |PINTA 1133, "11.";
     |PINTA 1333, "03.";
     |PINTA 1433, "04.";
     |PINTA 1533, "05.";
     |PINTA 1633, "06.";
     |PINTA 1733, "13.";
     |PINTA 1833, "14.";
     |PINTA 1933, "15.";
     |PINTA 2033, "16.";
     |PINTA 2233, "09.";
     |ATRI 0;
|FPRC;

|PROCESO Ocup;
     aAlfa1 = #0Campo;
     |QBF aAlfa1;
     |SI aAlfa1 = "";
          aAlfa1 = "Se asumen tipos de cotizacion de la actividad de la empresa";
          #0#205 = aAlfa1;
          |PINTA #0#205;
     |FINSI;

     nModo = (FEntrada / 100) ! 0;
     |SI aAlfa1 = "e"; |Y nModo = 1;
          aAlfa = "    ATENCION. La ocupación 'e' no está en vigor a partir de 2013.";
          aAlfa = aAlfa + " El trabaja- dor cotizará según el CNAE empresa."
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO Iniciando;
     || al iniciar el 144, inicio tambien el 132 y el 189 (tema COVID-19)
     #labtraba#144 = 1;
     |SI #labtraba#219 = 75;
          #labtraba#144 = "2";
     |FINSI;
     #labtraba#132 = "";
     #labtraba#189 = "";

     |GRABA 020#labtraba.a;
     |LIBERA #labtraba;
|FPRC;

|DEFBUCLE Iniciando;
     #labtraba#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, Iniciando;
|FIN;

|PROCESO labclean;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     |PINTA 1327, "ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿"
     |PINTA 1427, "³   Inicializando nuevos campos.   ³";
     |PINTA 1527, "³ Por favor, espere unos segundos. ³";
     |PINTA 1627, "³                                  ³"
     |PINTA 1727, "ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ"

     |ABRE #labclean;

     #labclean#0 = "labtraba";
     #labclean#1 = 144;
     |LEE 101#labclean.=;
     FEstado = FSalida;
     |SI FEstado ! 0;
          |BUCLE Iniciando;

          #labclean#0 = "labtraba";
          #labclean#1 = 144;
          #labclean#2 = "S";
          |SI FEstado = 0;
               |GRABA 020#labclean.a;
          |SINO;
               |GRABA 020#labclean.n;
          |FINSI;
          |LIBERA #labclean;
     |FINSI;

     |CIERRA #labclean;

     |PINTA 1327, "                                    ";
     |PINTA 1427, "                                    ";
     |PINTA 1527, "                                    ";
     |PINTA 1627, "                                    ";
     |PINTA 1727, "                                    ";
|FPRC;

|PROCESO no72; |TIPO 0;
     |PINTA 2416, "                                                     ";
     |SI #0#70 ! "T"; |ACABA; |FINSI;

     nTecla = FSalida;
|FPRC;

|PROCESO AyudaDatosBanco; |TIPO 7;
     |SI #0#70 = "T";
          |ATRI R;
          |PINTA 2416, " - Pulse ENTER para introducir los datos bancarios - ";
          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO EntraLABTRACU;
     enEmpresa    = #labtraba#0;
     enTrabajador = #labtraba#1;
     eaCampo71    = #labtraba#71;
     eaCampo72    = #labtraba#72;
     eaCampo153   = #labtraba#153;
     eaCampo154   = #labtraba#154;
     eaCampo155   = #labtraba#155;
     |SUB_EJECUTA_NP "labtracu";

     |ABRE #labtracu;
     #labtracu#0 = #labtraba#0;
     #labtracu#1 = #labtraba#1;
     #labtracu#2 = 1;
     |LEE 000#labtracu.=;
     |SI FSalida = 0;
         |C_M #labtraba#71, 1, "N";

         #labtraba#71 = #labtracu#3;
         |PINTA #labtraba#71#;

         #labtraba#72  = #labtracu#5 + #labtracu#6 + #labtracu#8 + #labtracu#7;
         #labtraba#153 = #labtracu#11;
         #labtraba#154 = #labtracu#12;
         #labtraba#155 = #labtracu#13;

         |PINTA #labtraba#72;
     |FINSI;
     |CIERRA #labtracu;
|FPRC;

|PROCESO EntraNOMW0021;
     |PUSHV 0501 2080;

     #nomw0021#0 = #labtraba#72 % 104;
     #nomw0021#1 = #labtraba#72 % 504;
     #nomw0021#2 = #labtraba#72 % 1110;
     #nomw0021#3 = #labtraba#72 % 902;
     |SI #labtraba#153 = " S "; #labtraba#153 = "ES"; |FINSI;
     #nomw0021#4 = #labtraba#153;
     #nomw0021#5 = #labtraba#154;
     #nomw0021#6 = #labtraba#155;

     |PINPA #0#nomw0021;
     |PINDA #0#nomw0021;

     |ENDATOS #1#nomw0021;
     |SI FSalida = 0;
         #labtraba#72  = #nomw0021#0 + #nomw0021#1 + #nomw0021#3 + #nomw0021#2;
         #labtraba#153 = #nomw0021#4;
         #labtraba#154 = #nomw0021#5;
         #labtraba#155 = #nomw0021#6;
         |PINTA #labtraba#72;
     |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipo7C72;  |TIPO 7;
     nPulsado = FSalida;

     |SI nTecla = 10;
         nPulsado = 0;
     |FINSI;

     |C_M #labtraba#71,  1, "N";

     |SI #labtraba#70 ! "T";  |ACABA;  |FINSI;

     |ABRE #labtracu;
     #labtracu#0 = #labtraba#0;
     #labtracu#1 = #labtraba#1;
     #labtracu#2 = 1;
     |LEE 000#labtracu.];
     |SI FSalida = 0;  |Y #labtracu#0 = #labtraba#0;  |Y #labtracu#1 = #labtraba#1;
         nTecla = 10;
     |FINSI;
     |CIERRA #labtracu;

     |C_M #labtraba#71,  1, "S";

     |SI nPulsado ! 0;
          |ACABA;
     |FINSI;

     |SI nTecla = 10;
         |HAZ EntraLABTRACU;
     |SINO;
         |HAZ EntraNOMW0021;
     |FINSI;

     nTecla = 0;
|FPRC;

|PROCESO CompOcupa;
     |SI #0#204 ! "b";
          |ACABA;
     |FINSI;

     |ABRE #labempre;
     #1#0 = #0#0;
     |LEE 000#labempre.=;
     |CIERRA #labempre;

     |ABRE #nomcnaec;
     #nomcnaec#0 = #1#128;
     |LEE 000#nomcnaec.=;
     |CIERRA #nomcnaec;

     |ABRE #nomocupa;
     #nomocupa#0 = #0#204;
     |LEE 000#nomocupa.=;
     |CIERRA #nomocupa;

     nume1 = #nomcnaec#2 + #nomcnaec#3;
     nume2 = #nomocupa#2 + #nomocupa#3;
     ||SI #nomcnaec#2 > #nomocupa#2; |O #nomcnaec#3 > #nomocupa#3;
     |SI nume1 > nume2;
          aAlfa = "    El tipo de cotización del CNAE de la empresa es superior ";
          aAlfa = aAlfa + "al de la ocupación (b) del trabajador.";
          |MENAV aAlfa;
          /*
          aAlfa = "    Rectifique la ocupación o déjela en blanco para asumir ";
          aAlfa = aAlfa + "la del CNAE de la empresa";
          |MENAV aAlfa;
          |ERROR;
          */
     |FINSI;
|FPRC;

|PROCESO MensaETT; |TIPO 7;
     aFabre = "";
     |DIRECTORIO aFabre;
     aFabre = "rt  " + aFabre + "laboral/bin/semacumu.tab";
     |FABRE aFabre;
     |SI FSalida ] 0;
          |MENSA "    Solo si la cotizacion es distinta de la empresa (F5 - ETT) (F11-Consulta)";
          |FCIERRA FSalida;
     |SINO;
          |MENSA "    Indicar ocupacion si la cotizacion es distinta de la empresa (F11-Consulta)";
     |FINSI;
|FPRC;

|PROCESO OcupETT;
     nTecla = FSalida;
     aFabre = "";
     |DIRECTORIO aFabre;
     aFabre = "rt  " + aFabre + "laboral/bin/semacumu.tab";
     |FABRE aFabre;
     |SI FSalida ] 0; |Y nTecla = 13;
          FArchivo = FSalida;

          |SALVA_FICHA #0;
          |PUSHV 05012380;
          |ABRE #ett00002;

          #ett00002#0 = #0#0;
          #ett00002#1 = #0#1;
          |LEE 000#ett00002.=;

          |CLS;
          |PINPA #0#ett00002;
          |PINDA #0#ett00002;

          FEstado = FSalida;
          |SI FSalida = 0;
               |ENDATOS #2#ett00002;
          |SINO;
               |ENDATOS #1#ett00002;
          |FINSI;
          |SI FSalida = 0;
               |SI FEstado = 0; |GRABA 020#ett00002.a; |FINSI;
               |SI FEstado ! 0; |GRABA 020#ett00002.n; |FINSI;
          |FINSI;
          |CIERRA #ett00002;

          |POPV;

          |FCIERRA FArchivo;
          |REPON_FICHA #0;

          #0#204 = #ett00002#4;
          #0#205 = #ett00002#6;
          |PINTA #0#204;
          |PINTA #0#205;
     |FINSI;
     |FCIERRA FArchivo;
|FPRC;

|PROCESO nomtrap2;
     #nomtrato#0 = #nomtrap2#0;
     #nomtrato#1 = #nomtrap2#1;
     |LEE 101#nomtrato.=;
     |SI FSalida ! 0;
          #nomtrato#0 = #nomtrap2#0;
          #nomtrato#1 = #nomtrap2#1;
          #nomtrato#2 = #nomtrap2#2;
          #nomtrato#3 = #nomtrap2#3;
          |GRABA 020#nomtrato.n;
     |FINSI;
     |LIBERA #nomtrato;
|FPRC;

|DEFBUCLE nomtrap2;
     #nomtrap2#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, nomtrap2;
|FIN;

|PROCESO nomtrap1;
     #nomtrata#0 = #nomtrap1#0;
     |LEE 101#nomtrata.=;
     |SI FSalida ! 0;
          #nomtrata#0 = #nomtrap1#0;
          #nomtrata#1 = #nomtrap1#1;
          |GRABA 020#nomtrata.n;
     |FINSI;
     |LIBERA #nomtrata;
|FPRC;

|DEFBUCLE nomtrap1;
     #nomtrap1#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, nomtrap1;
|FIN;

|PROCESO nomtrato;
     |ABRE #nomtrata;
     |ABRE #nomtrato;
     |BUCLE nomtrap1;
     |BUCLE nomtrap2;
     |CIERRA #nomtrato;
     |CIERRA #nomtrata;
|FPRC;

|PROCESO ActualizaBonif;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     |SUB_EJECUTA "nomboact";
|FPRC;

|PROCESO ActualizaConstantes;
     eaVengoDe = "labtraba";
     |ABRE #nomconst;
     #nomconst#0 = 726;
     #nomconst#79 = "01.01.2014";
     |LEE 000#nomconst.=;
     |SI FSalida ! 0; |O #nomconst#6 ! 16.85;
          |SUB_EJECUTA "nomfan02;ACTUALIZACION";
     |FINSI;
     |CIERRA #nomconst;
|FPRC;

|PROCESO Limpia;
     |BORRA 020#labtraba.a;
     |LIBERA #labtraba;
|FPRC;

|DEFBUCLE Limpia;
    #labtraba#1;
    ;
    nDesdeEmp, nDesdeTra;
    nHastaEmp, nHastaTra;
    ;
    NULL, Limpia;
|FIN;

|PROCESO LimpiaCero;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     nDesdeEmp = 00000;
     nHastaEmp = 00000;
     nDesdeTra = 00000;
     nHastaTra = 00000;
     |BUCLE Limpia;

     nDesdeEmp = 00000;
     nHastaEmp = 99999;
     nDesdeTra = 00000;
     nHastaTra = 00000;
     |BUCLE Limpia;
|FPRC;

|PROCESO EnProduccion;
     |DDEF aDef;
     |QBF aDef;
     aAlfa = aDef % 0111;
     |SI aAlfa = "/u/dsprofes";    || estoy en produccion
          swProduccion = 1;
     |FINSI;
|FPRC;
/*
|PROCESO InformeConFor;
     |SI swProduccion = 1;
          |SUB_EJECUTA "labconfo;AUTO";
     |FINSI;
|FPRC;
*/
|PROCESO Tipo88tra; |TIPO 88;
     |HAZ Tipo88;
     |HAZ ITIMStra;
     |HAZ nomtrato;
     |HAZ labclean;
     ||HAZ ActualizaConstantes;
     |HAZ ActualizaBonif;
     ||HAZ LimpiaCero;
     |HAZ EnProduccion;
     ||HAZ InformeConFor;
     |HAZ BuscaModulo;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/nomcont1.mas";
     |CARGA_DEF aAlfa, temp0001@;

     nNume = 0
     |SI FSalida = 0;
          |ABRE #temp0001@; |LEE 000#temp0001@.p; |CIERRA #temp0001@;
          nNume = #temp0001@#9;
     |FINSI;
     |DESCARGA_DEF #temp0001@;

     |SI nNume = 5632;
          swFacturacion = 1;
     |FINSI;

     sw902 = 0;
     nMotivo = 0;
     nDiasInd = 0;
|FPRC;

|PROCESO ITIMStra;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     fFecha = ~;
     aAlfa = fFecha; aAlfa = aAlfa % -104;
     nElAny = aAlfa;
     aAlfa = fFecha; aAlfa = aAlfa % 402;
     nElMes = aAlfa;
     |HAZ ValoresITIMS;
|FPRC;

|PROCESO PintaLoc1; |TIPO 7;
     aAntLoc = #0Campo;
|FPRC;

|PROCESO PintaLoc2;
     enPintaLoc = 0;
     aAlfa = #0#6; |QBF aAlfa;
     |SI #0Campo ! aAntLoc; |O aAlfa = "";
          enPintaLoc = 1;
     |FINSI;
|FPRC;

|PROCESO Activa138; |TIPO 14;
     |SI #0#241 = "N"; |O #0#241 = "X";
          |ATRI 0;
          |PINTA 1673, " Car:  ³";
          |ATRI I;
          |CAMPO_VISUAL #0#138, 1, "S";
          |CAMPO_MODIFICA #0#138, 1, "S";
          |ATRI I;
          |PINTA #0#138;
          |ATRI I;
     |SINO;
          |ATRI 0;
          |PINTA 1773, "       ³";
          |ATRI I;
          |CAMPO_VISUAL #0#138, 1, "N";
          |CAMPO_MODIFICA #0#138, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Limite; |TIPO 14;
     |ABRE #nombonif;
     #nombonif#0 = #0#39
     |LEE 000#nombonif.=;
     |SI FSalida = 0; |Y #nombonif#26 = "S";
          |CAMPO_VISUAL #0#217, 1, "S";
          |CAMPO_MODIFICA #0#217, 1, "S";
          |PINTA #0#217;
          |ATRI I;
     |SINO;
          |ATRI I;
          #0#217 = 0;
          |CAMPO_VISUAL #0#217, 1, "N";
          |CAMPO_MODIFICA #0#217, 1, "N";
          |PINTA 1524, "        ³";
     |FINSI;
     |CIERRA #nombonif;
|FPRC;

|PROCESO PintaCon; |TIPO 14;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 0;
          |PINTA 1123, #nomconca#1;
          |ACABA;
     |FINSI;
     |ABRE #nomconca;
     #nomconca#0 = #labtraba#87;
     |LEE 000#nomconca.=;

     |ATRI I;
     |PINTA 1123, #nomconca#1;
     |ATRI I;
     |CIERRA #nomconca;
|FPRC;

|PROCESO PintaCen; |TIPO 14;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 0;
          |PINTA 1023, #labcentr#2;
          |ACABA;
     |FINSI;
     |ABRE #labcentr;
     #labcentr#0 = #labtraba#0;
     #labcentr#1 = #labtraba#77;
     |LEE 000#labcentr.=;
     |ATRI I;
     |PINTA 1023, #labcentr#2;
     |CIERRA #labcentr;
|FPRC;

|PROCESO CompEmail;
     eaEmail = #0Campo;
     |HAZ CompEmail_plb;
|FPRC;

|PROCESO CompDSArchi;
     |HAZ MiraSiArchiva;
     |SI nArchi ! 1; |Y #0Campo = "S";
          aAlfa = "    Ha de tener instalada la aplicación DSARCHI y activar ";
          aAlfa = aAlfa + "la emisión de nóminas para poder usar esta opción";
          |MENAV aAlfa;

          #0Campo = "N";
          |PINTA #0Campo;
          |ACABA;
     |FINSI;
     |SI #0Campo = "S";
          nCampo = Campo - 1;
          aAlfa = #0nCampo;
          |QBF aAlfa;
          |SI aAlfa = "";
               aAlfa = "    ATENCION. La dirección de correo electrónico del ";
               aAlfa = aAlfa + "trabajador está en blanco. No se enviará la nómina.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ForDesBon;
     |SI #0#45 ! "421"; |Y #0#45 ! "085";
          |ACABA;
     |FINSI;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1; |O #0Campo ! Contenido;
          fFechaFor = "18.06.2010";
          fFechaAlta = #0#36;
          |SI fFechaAlta ] fFechaFor;
               #0#190 = "S";
               |PINTA #0#190;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CompDesForm;
     |SI #0#45 ! "421"; |Y #0#45 ! "085";
          |ACABA;
     |FINSI;
     nTecla = FSalida;
     fFechaFor = "18.06.2010";
     fFechaAnt = #0#34;
     fFechaAlta = #0#36;
     |SI #0#190 = "S"; |Y fFechaAlta < fFechaFor; |Y fFechaAnt < fFechaFor;
          aAlfa = "    ATENCION. La fecha de antigüedad y la de alta ";
          aAlfa = aAlfa + "son anteriores al inicio de la cotización por desempleo.";
          |MENAV aAlfa;

          aAlfa = "    Verifique que realmente el contrato de formación introducido ";
          aAlfa = aAlfa + "ha de cotizar por desempleo.";
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO MediaForm;
     |SI #0#45 ! "421"; |Y #0#45 ! "085";
          |ACABA;
     |FINSI;
     swSigue = 0;
     |SI enParada = 1;
          swSigue = 1;
     |SINO;
          |SI nAltaFechaRef > 0; |O nMedia90 > 0;
               swSigue = 0;
          |SINO;
               swSigue = 1;
          |FINSI;
     |FINSI;
     |SI swSigue = 0;
          |ACABA;
     |FINSI;

     nNume = #0#0;
     aAlfa = nNume; |QBF aAlfa; aAlfa = ("00000" + aAlfa) % -105;
     aAlfa1 = aAlfa;

     aAlfa = #0#36;
     aAlfa1 = aAlfa1 + aAlfa;
     aAlfa1 = "nomcalme;" + aAlfa1;

     enEmp = #0#0;
     enTra = #0#1;
     enNom = #0#2;
     eaNIF = #0#7;
     eaAlta = #0#36;
     eaBaja = #0#37;
     eaContrato = #0#45;
     enOpcion = 2;
     |SUB_EJECUTA aAlfa1;
|FPRC;

|PROCESO CalcMedia;
     nTecla = FSalida;
     |SI FSalida = 18;
          enParada = 1;
          |HAZ MediaForm;
     |FINSI;
|FPRC;

|PROCESO ayuda188; |TIPO 7;
     |PUSHV 13582380;
     |ATRI R;
     ||            5 6         7         8
     ||            89012345678901234567890
     |PINTA 1358, " - Un s¢lo ERE/ERTE - ";
     |PINTA 1458, " S: Con exoneraci¢n   ";
     |PINTA 1558, " N: Sin exoneraci¢n   ";
     |PINTA 1658, "                      ";
     |PINTA 1758, "  - Dos ERES/ERTES -  ";
     |PINTA 1858, "  - (Concepto 948) -  ";
     |PINTA 1958, " S: 1er ERE exonerado ";
     |PINTA 2058, " 2: 2do ERE exonerado ";
     |PINTA 2158, " A: Ambos exonerados  ";
     |PINTA 2258, " N: Ninguno exonerado ";
     |ATRI 0;
|FPRC;

|PROCESO PorcBonDes;
     |SI #0#188 = "S"; |O #0#188 = "1"; |O #0#188 = "2"; |O #0#188 = "A";
          |SI #0#219 = 0; |O #0#219 = 50; |O #0#219 = 80;
               #0#219 = 100;
          |FINSI;
          |CAMPO_MODIFICA #0#219, 1, "S";
          |CAMPO_MODIFICA #0#144, 1, "S";
          |CAMPO_MODIFICA #0#132, 1, "S";
          |CAMPO_MODIFICA #0#189, 1, "S";
     |SINO;
          #0#219 = 0; |PINTA #0#219; |CAMPO_MODIFICA #0#219, 1, "N";
          #0#144 = "1"; |PINTA #0#144; |CAMPO_MODIFICA #0#144, 1, "N";
          #0#132 = ""; |PINTA #0#132; |CAMPO_MODIFICA #0#132, 1, "N";
          #0#189 = ""; |PINTA #0#189; |CAMPO_MODIFICA #0#189, 1, "N";
     |FINSI;
|FPRC;

|PROCESO TrabAlta;
     |SI #0#219 = 100; |O #0#219 = 0;
          #0#144 = 1;
     |SINO;
          #0#144 = 2;
     |FINSI;
     |PINTA #0#144;
|FPRC;

|| migue: boton opciones
/*
|PROCESO MenuOpciones;
     eaVengoDe = "labtraba";
     ||VARIABLES; {20} aPopup = ""; |FINSI;
     aPopup1 = "-1";  || Si fuera -1 en la posicion
     aPopup2 = 3;
     aPopup3 = "1. Importes por trabajador";
     aPopup4 = "2. Embargos";
     aPopup5 = "3. Mas ... ";
     IaPopup = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     nOpcion = FSalida;

     |SALVA_DATOS #labtraba;
     |HAZ OpcionesTrabajador;
     |REPON_DATOS #labtraba;
|FPRC;
*/

|PROCESO PintaCenCon;
               |ABRE #labcentr;
               #labcentr#0 = #labtraba#0;
               #labcentr#1 = #labtraba#77;
               |LEE 000#labcentr.=;
               |ATRI I;
               |PINTA 1023, #labcentr#2;
               |ATRI 0;
               |CIERRA #labcentr;

               |ABRE #nomconca;
               #nomconca#0 = #labtraba#87;
               |LEE 000#nomconca.=;
               |ATRI I;
               |PINTA 1123, #nomconca#1;
               |ATRI 0;
               |CIERRA #nomconca;
|FPRC;

|PROCESO BotonHistorico;
     aAlfa1 = #labtraba#0; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = #labtraba#1; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;

     aAlfa = "nomtrahi;" + aAlfa1 + aAlfa2;

     |SALVA_DATOS #labtraba;
     |SUB_EJECUTA aAlfa;
     |REPON_DATOS #labtraba;

     |SI enCambiaEmp ! 0; |Y enCambiaTra ! 0;
          |SI nModoReal = 0; |O nModoReal = 4;
               #0#0 = enCambiaEmp;
               #0#1 = enCambiaTra;
               |LEE 101#labtraba.=;
               |PINDA #0#0;
               |HAZ PintaCenCon;
          |FINSI;
     |FINSI;

     FEntrada = nFEntradaReal;
|FPRC;

|PROCESO SSOnline;
     |SI nOpcion = 0;
          |ACABA;
     |FINSI;
     aAlfa1 = #0#0; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = #0#1; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;
     aAlfa = aAlfa1 + aAlfa2;
     |SI nOpcion = 1;
          aAlfa = "labnct07;"+ "01" + aAlfa;
     |FINSI;
     |SI nOpcion = 2;
          aAlfa = "labnct07;"+ "02" + aAlfa;
     |FINSI;
     |SI nOpcion = 3;
          aAlfa = "labnct07;"+ "03" + aAlfa;
     |FINSI;
     |SI nOpcion = 4;
          aAlfa = "labnct07;"+ "04" + aAlfa;
     |FINSI;
     |SI nOpcion = 5;
          aAlfa = "labnct07;"+ "05" + aAlfa;
     |FINSI;
     |SI nOpcion = 6;
          aAlfa = "labnct07;"+ "07" + aAlfa;
     |FINSI;
     |SI nOpcion = 7;
          aAlfa = "labnct07;"+ "08" + aAlfa;
     |FINSI;
     |SI nOpcion = 8;
          aAlfa = "labnct07;"+ "25" + aAlfa;
     |FINSI;

     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO MenuRED;
     eaVengoDe = "labtraba";
     ||VARIABLES; {20} aPopup = ""; |FINSI;
     aPopup1 = "-1";  || Si fuera -1 en la posicion
     aPopup2 = 8;
     aPopup3 = "1. Enviar alta del trabajador";
     aPopup4 = "2. Enviar baja del trabajador";
     aPopup5 = "3. Cambio de grupo de tarifa";
     aPopup6 = "4. Cambio de contrato";
     aPopup7 = "5. Consulta de situación del afiliado";
     aPopup8 = "6. Consulta del número de afiliación";
     aPopup9 = "7. Duplicado de documentos TA";
     aPopup10 = "8. Consulta de Vida Laboral del Trabajador";
     IaPopup = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     nOpcion = FSalida;
     |SALVA_DATOS #labtraba;
     |HAZ SSOnline;
     |REPON_DATOS #labtraba;
|FPRC;

|PROCESO BotonRED; |TIPO 8;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     |CAMPO_ANCHO #nomconca#1, 1, 21;
     |HAZ PinM003430;

     ||CONTROL_SIMPLE 0, "BOTON,Seguridad Social Online", 0860, 0877, MenuRED;
     |CONTROL_SIMPLE 0, "BOTON,Seguridad Social Online", 0860, 0877, ConectaSS;
     enBoton = FSalida;
     |ESTADO_CONTROL enBoton, "ENABLE";

     || boton historico

     |CONTROL_SIMPLE 0, "BOTON,Historial Fichas Trabajador", 0960, 0977, BotonHistorico;
     enBotonHis = FSalida;
     |ESTADO_CONTROL enBotonHis, "ENABLE";

     swBotonSiNo = 1;
|FPRC;

|PROCESO FinBotonRED; |TIPO 9;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     |FIN_CONTROL_WINDOWS enBoton;

     || migue: boton opciones
     ||FIN_CONTROL_WINDOWS enBotonOpt;

     ||SI swProduccion = 1;
          |FIN_CONTROL_WINDOWS enBotonHis;
     ||FINSI;

     |PULSATECLA;
     swBotonSiNo = 0;
|FPRC;

|PROCESO PonBotonRED; |TIPO 14;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI aAlfa ! "labtraba";
          |ACABA;
     |FINSI;

     |SI swBotonSiNo = 0;
          |HAZ BotonRED;
     |FINSI;
|FPRC;

|PROCESO QuitaBoton; |TIPO 14;
     |SI swBotonSiNo = 1;
          |HAZ FinBotonRED;
     |FINSI;
|FPRC;

|PROCESO DatosIRPF;
     |SI nTecla = 18;
          eaNif = #0#7;
          |QBF eaNif;
          |SI eaNif = "";
               |ACABA;
          |FINSI;

          eaProcedencia = "labtraba";
          enEmpresa = #0#0;
          enTrabajador = #0#1;
          |SUB_EJECUTA ":basica/agidanif";
     |FINSI;
|FPRC;

|PROCESO Relacion2; |TIPO 14;
     |SI #0#111 = 2;
          |CAMPO_MODIFICA #0#130, 1, "S";
          |CAMPO_VISUAL #0#130, 1, "S";
          |PINTA #0#130;
     |SINO;
          |CAMPO_MODIFICA #0#130, 1, "N";
          |CAMPO_VISUAL #0#130, 1, "N";
          |ATRI 0;
          |PINTA 1964, "   ";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Ayuda130; |TIPO 7;
     |PUSHV 13261880;
     |ATRI R;
     |PINTA 1330, " Tipo de cálculo para contratos menores de un a¤o: ";
     |PINTA 1430, " 1. Estimar ingresos hasta la fecha de fin de con- ";
     |PINTA 1530, "    trato indicada o hasta final de a¤o.           ";
     |PINTA 1630, " 2. Tener en cuenta lo ingresado hasta el periodo  ";
     |PINTA 1730, "    que estamos calculando.                        ";
     |ATRI 0;
|FPRC;

|PROCESO RestauraL;
     |POPV;
     |ATRI 0;
|FPRC;

|PROCESO AyudaTipoL; |TIPO 7;
     |PUSHV 11261880;
     |ATRI R;
     |PINTA 1130, " Tipo de Relación Laboral:         ";
     |PINTA 1230, " 1. General                                        ";
     |PINTA 1330, " 2. Duración inferior a un a¤o                     ";
     |PINTA 1430, " 3. Relaciones laborales especiales de carácter de-"
     |PINTA 1530, "    pendiente (salvo penados y discapacitados)     ";
     |PINTA 1630, " 4. Esporádica propia de retribuciones por peonadas";
     |PINTA 1730, "    o jornales diarios                             ";
     |ATRI 0;
|FPRC;

|PROCESO Aviso131;
     |SI #0#131 = "S"; |Y #0#111 ! 1;
          aAlfa = "    ATENCION: Para una transformación en indefinido es ";
          aAlfa = aAlfa + "obligatoria la relación laboral tipo 1";
          |MENAV aAlfa;
          aAlfa = "    Se ha cambiado la relación laboral a tipo 1. Revise ";
          aAlfa = aAlfa + "sus datos si es necesario.";
          |MENAV aAlfa;
          #0#111 = 1;
          |PINTA #0#111;
     |FINSI;
|FPRC;

|PROCESO Aviso110;
     |PUSHV 08211770;
     |ATRI R;
     |BLANCO 08211770;
     |CUADRO 08211770;
               ||  2      3         4         5         6       6
               ||  3456789012345678901234567890123456789012345678;
     |PINTA 0923, "ATENCION. El trabajador tiene declarados en el";
     |PINTA 1023, "Registro del Modelo 110 importes  con el  tipo";
     |PINTA 1123, "de relaci¢n laboral XXX en el mes XX.         ";
     |PINTA 1223, "Al ser distinto el tipo de relaci¢n laboral en";
     |PINTA 1323, "en la ficha del trabajador, es  necesario cam-";
     |PINTA 1423, "biarlo tambin en el  Registro de Trabajo  del";
     |PINTA 1523, "modelo 110 con  la tecla F6, para  que  no  se";
     |PINTA 1623, "produzcan diferencias al regularizar.         ";

     aAlfa1 = nTipo110;             |QBF aAlfa1;
     aAlfa1 = " " + aAlfa1 + " ";
     aAlfa2 = nMes110;              |QBF aAlfa2;
     aAlfa2 = ("00" + aAlfa2) % -102;
     |PINTA 1143, aAlfa1;
     |PINTA 1157, aAlfa2;
     |AVISO;
     |ATRI 0;
     |PAUSA;
     |POPV;
|FPRC;

|PROCESO model111;
     |SI #model111@#11 ! 0;
          |SI #0#111 ! #model111@#11;
               nTipo110 = #model111@#11;
               nMes110 = #model111@#8;
               swAviso = 1;
          |FINSI;
          |SI #0#111 = #model111@#11;
               swUnoIgual = 1;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE model111;
     #model111@#1012;
     ;
     #0#0, nAny, 00, 110, 00, 01, #labtraba#7, 0000, #nomhicca#2, " ", "  ", 0;
     #0#0, nAny, 99, 110, 98, 98, #labtraba#7, 0000, #nomhicca#2, "z", "zz", 4;
     ;
     NULL, model111;
|FIN;

|PROCESO nomhicca;
     |DBASS aMas;
     |SI nAny [ 2015;
         aMas = aMas + "modelos/def/dsmoc111.mas";
     |FINSI;

     |SI nAny ] 2016;
         aMas = aMas + "modelos/def/dsm11101.mas";
     |FINSI;

     |CARGA_DEF aMas, model111@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     swAviso = 0;
     nMes110 = 0;
     nTipo110 = 0;
     swUnoIgual = 0;
     |BUCLE model111;
     |SI swAviso = 1; |Y swUnoIgual = 0;
          |HAZ Aviso110;
     |FINSI;

     |DESCARGA_DEF #model111@;
|FPRC;

|DEFBUCLE nomhicca;
     #nomhicca#1;
     ;
     #0#0, #0#1, nAnyHis, 01, 0;
     #0#0, #0#1, nAnyHis, 12, 0;
     ;
     NULL, nomhicca;
|FIN;

|PROCESO Comprueba110;
     ||SI #0Campo ! Contenido;     || siempre
          |ABRE #nomhicca;

          fFecha = ~;
          aAlfa = fFecha;
          aAlfa = aAlfa % -104;
          nAny = aAlfa;
          nAnyHis = nAny - 2000;

          |BUCLE nomhicca;

          |CIERRA #nomhicca;
     || FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = " GAD ";
     |SINO;
          eaVengoDe = "labtraba";
          |HAZ MiraSiArchiva;
          |SI nArchi ! 1;
               aAlfa = "    Es necesario tener instalada la Gestión del Archivo ";
               aAlfa = aAlfa + "Documental (GAD) para acceder a sus funciones.";
               |MENAV aAlfa;
               || aAlfa = "    Póngase en contacto con su distribuidor ";
          |SINO;
               aAlfa = #labtraba#7;
               |QBF aAlfa;
               aAlfa = "|:dsarchi/dsarm005;"+ aAlfa + "laboral";
               ||SUB_EJECUTA_NP "|:dsarchi/dsarm005;14151514Mlaboral";
               |SUB_EJECUTA_NP aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Activa133; |TIPO 14;
     |ABRE #nomcontr; |LEE 000#nomcontr.p; |CIERRA #nomcontr;
     |SI #0#60 = "C"; |Y #nomcontr#62 = "S";
          |CAMPO_MODIFICA #0#133, 1, "S";
          |CAMPO_VISUAL #0#133, 1, "S";
          |ATRI 0;
          |PINTA 1309, "³Origen Control IT ..:    ³";
          |ATRI I;
          |PINTA #0#133;
          |ATRI I;
     |SINO;
          |CAMPO_MODIFICA #0#133, 1, "N";
          |CAMPO_VISUAL #0#133, 1, "N";
          |ATRI 0;
          |PINTA 1309, "³                         ³";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Activa134; |TIPO 14; || proteccion cese de actividad regimen del mar

     || no se usa de momento, no hara falta este campo
     || estaba declarado en el campo 247 por si volviera a hacer falta

     |SI #0#247 = 0821;
          |CAMPO_MODIFICA #0#134, 1, "S";
          |CAMPO_VISUAL #0#134, 1, "S";
          |ATRI I;
          |PINTA #0#134;
          |ATRI I;
     |SINO;
          |CAMPO_MODIFICA #0#134, 1, "N";
          |CAMPO_VISUAL #0#134, 1, "N";
          |ATRI 0;
          |PINTA 0957, "   ³";
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Mensa208; |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI #labtraba#45 = 420; |O #labtraba#45 = 520;
          aAlfa = "    Proporcionar salario según 1er. o 2do. año?";
     |SINO;
          aAlfa = "    Proporcionar salario según 1er. o 2do. año? <F6> HORAS";
     |FINSI;
     |SI #0#232 ! 0; |Y #0#233 ! 0;
          aAlfa = aAlfa + " <F5> Proporción";
     |FINSI;
     |MENSA aAlfa;
|FPRC;

|PROCESO MuestraProp; |TIPO 7;
     swPush = 0;
     |SI Campo = 208; |Y #0#208 = "S";
          swPush = 1;
          |PUSHV 08632380;
          #labprafo#0 = #0#232;
          #labprafo#1 = #0#233;
          |PINPA #0#labprafo;
          |PINDA #0#labprafo;
          |SI #0#45 = 421;
               |ATRI 0;
               |PINTA 1065, "2do./3er.:"
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO DefPractica;
     nTecla = FSalida;
     |SI swPush = 1;
          |POPV;
          swPush = 0;
     |FINSI;
     |SI Campo = 208; |Y #0#208 = "S";
          swSigue = 0;
          |SI #0#232 = 0; |Y #0#233 = 0;
               swSigue = 1;
          |FINSI;
          |SI #0Campo = "S"; |Y Contenido = "N";
               swSigue = 1;
          |FINSI;
          |SI FSalida = 13; |O swSigue = 1;
               |PUSHV 05012380;
               |PINPA #0#labprafo;
               #labprafo#0 = #0#232;
               #labprafo#1 = #0#233;
               |PINDA #0#labprafo;
               |ENDATOS #2#labprafo;
               |SI FSalida = 0;
                    #0#232 = #labprafo#0;
                    #0#233 = #labprafo#1;
               |FINSI;
               |POPV;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO RecConv; |TIPO 0;
     |SI #0#45 = "420"; |O #0#45 = "520";
          |SI FSalida = 13;
               |ABRE #nomconca;
               #nomconca#0 = #0#87;
               |LEE 000#nomconca.=;
               |SI FSalida = 0;
                    #0#232 = #nomconca#150;
                    #0#233 = #nomconca#151;
                    |PINTA #0#232;
                    |PINTA #0#233;
                    |ERROR;
               |FINSI;
               |CIERRA #nomconca;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Desactiva23X;
     |CAMPO_MODIFICA #0#232, 1, "N";
     |CAMPO_MODIFICA #0#233, 1, "N";
     |CAMPO_VISUAL #0#232, 1, "N";
     |CAMPO_VISUAL #0#233, 1, "N";
     |ATRI 0;
     |PINTA 2058, "³                     ³";
     |ATRI I;
|FPRC;

|PROCESO Activa23X; |TIPO 14;
     |SI #0#208 ! "S";
          |HAZ Desactiva23X;
          |ACABA;
     |FINSI;
     |SI #0#45 = "420"; |O #0#45 = "520"; |O #0#45 = "421";
          |CAMPO_MODIFICA #0#232, 1, "S";
          |CAMPO_MODIFICA #0#233, 1, "S";
          |CAMPO_VISUAL #0#232, 1, "S";
          |CAMPO_VISUAL #0#233, 1, "S";
          |ATRI 0;
          |SI #0#45 = "420"; |O #0#45 = "520";
               |PINTA 2058, "³%Pr cticas.:         ³";
          |SINO;
               |PINTA 2058, "³%Formaci¢n.:         ³";
          |FINSI;

          |ATRI I;
          |PINTA #0#232;
          |PINTA #0#233;
          |ATRI I;
     |SINO;
          |HAZ Desactiva23X;
     |FINSI;
|FPRC;

|PROCESO Mensa232; |TIPO 7;
     |SI #0#45 = "420"; |O #0#45 = "520";
          aAlfa = "    Porcentaje de salario durante el 1er. a¤o para cont. prácticas (F5-Convenio)";
     |SINO;
          aAlfa = "    Porcentaje de salario durante el 1er. a¤o para contratos de formación";
     |FINSI;
     |MENSA aAlfa;
|FPRC;

|PROCESO Mensa233; |TIPO 7;
     |SI #0#45 = "420"; |O #0#45 = "520";
          aAlfa = "    Porcentaje de salario durante el 2do. a¤o para contratos en prácticas";
     |SINO;
          aAlfa = "    Porcentaje de salario durante el 2do. y 3er. a¤o para contratos de formación";
     |FINSI;
     |MENSA aAlfa;
|FPRC;

|PROCESO EnP14; |TIPO 14;
     |CAMPO_VISUAL #0#190, 1, "N";
     |CAMPO_MODIFICA #0#190, 1, "N";
     |CAMPO_VISUAL #0#191, 1, "N";
     |CAMPO_MODIFICA #0#191, 1, "N";
     |CAMPO_VISUAL #0#208, 1, "N";
     |CAMPO_MODIFICA #0#208, 1, "N";

     |ATRI 0;
     |PINTA 1157, "   ³";
     |ATRI I;

     nModo = (FEntrada / 100) ! 0;

     |SI #0#45 = "420"; |O #0#45 = "520"; |O #0#45 = "421"; |O #0#45 = "085";
     |O #0#45 = "422";
          |SI #0#45 = "420"; |O #0#45 = "520";
               |CAMPO_VISUAL #0#190, 1, "N";
               |CAMPO_MODIFICA #0#190, 1, "N";
               |CAMPO_VISUAL #0#191, 1, "N";
               |CAMPO_MODIFICA #0#191, 1, "N";
               |CAMPO_VISUAL #0#208, 1, "S";
               |CAMPO_MODIFICA #0#208, 1, "S";
               |CAMPO_POSICION #0#208, 1, 1157;
               |SI #0#208 ! "S"; |Y #0#208 ! "N";
                    #0#208 = "S";
               |FINSI;

               |ATRI 0;
               |PINTA 0857,  "ÄÄÄÂÄÄÄ";
               |PINTA 0957,  "   ³ Finiquito..:";
               |PINTA 1057,  "   ³ Calendario :";
               |PINTA 1156, "    ³ Dur. <= 5d.:";
               |PINTA 1257,  "   ³            :";
               |ATRI I;
               |PINTA #0#208;
               |ATRI I;
          |FINSI;
          |SI #0#45 = "085"; |O #0#45 = "421"; |O #0#45 = "422";
               |ATRI I;

               |CAMPO_VISUAL #0#191, 1, "S";
               |CAMPO_MODIFICA #0#191, 1, "S";
               |PINTA #0#191;

               |SI #0#45 ! "422";
                    |CAMPO_POSICION #0#190, 1, 1157;
                    |CAMPO_VISUAL #0#190, 1, "S";

                    fFechaFor = "18.06.2010";
                    fFechaAlta = #0#36;

                    |SI fFechaAlta ] fFechaFor;
                         |CAMPO_MODIFICA #0#190, 1, "S";
                         |SI nModo = 1;      || solo en modo alta
                              #0#190 = "S";
                         |FINSI;
                    |SINO;
                         |CAMPO_MODIFICA #0#190, 1, "S";
                    |FINSI;
                    |PINTA #0#190;
               |SINO;
                    |CAMPO_VISUAL #0#190, 1, "N";
                    |CAMPO_MODIFICA #0#190, 1, "N";
               |FINSI;

               |ATRI 0;
               |PINTA 0860, "ÄÄÄÂ";
               |PINTA 0960, "   ³Finiquito:";
               |PINTA 1060, "   ³Calendari:";
               |PINTA 1160, "   ³Dur<=5d..:";
               |PINTA 1260, "ÚÄÄÙ          ";

               |SI #0#45 ! "422";
                    |CAMPO_VISUAL #0#208, 1, "S";
                    |CAMPO_MODIFICA #0#208, 1, "S";
                    |CAMPO_POSICION #0#208, 1, 1161;
                    |SI #0#208 ! "S"; |Y #0#208 ! "N";
                         #0#208 = "N";
                    |FINSI;
                    |ATRI I;
                    |PINTA #0#208;
                    |ATRI I;
               |FINSI;

               |ATRI I;
          |FINSI;
     |SINO;
          |CAMPO_VISUAL #0#208, 1, "N";
          |CAMPO_MODIFICA #0#208, 1, "N";
          |CAMPO_VISUAL #0#190, 1, "N";
          |CAMPO_MODIFICA #0#190, 1, "N";
          |CAMPO_VISUAL #0#191, 1, "N";
          |CAMPO_MODIFICA #0#191, 1, "N";
          |ATRI 0;
          |PINTA 0857,  "ÄÄÄÂÄÄÄ";
          |PINTA 0957,  "   ³ Finiquito..:";
          |PINTA 1057,  "   ³ Calendario.:";
          |PINTA 1156, "    ³ Dur. <= 5d.:";
          |PINTA 1257,  "   ³   ";
          |ATRI I;
          #0#190 = "N";
          #0#191 = "N";
     |FINSI;
     |ATRI I;
     |PINTA #0#247;
     |ATRI I;
|FPRC;

|PROCESO BuscaRepetidas;
     swF5 = 1;
     |SI FSalida = 13;
          |HAZ Repetidas;
     |FINSI;
     swF5 = 0;
|FPRC;

|PROCESO Repetidas; |TIPO 7;
     |MENSA "    Localidad";

     aAlfa = "SELECT nomporep.2 FROM nomporep INTO tm" + Usuario;
     aAlfa = aAlfa + ".def WHERE 0 == " + #labtraba#8;
     |SQL aAlfa;
     |SI FSalida ! 0;
          |ACABA;
     |FINSI;

     aAlfa1 = FSalida;
     aAlfa1 = aAlfa1 - "0 Seleccionados:";
     |QBF aAlfa1;
     nNume = aAlfa1;
     |SI nNume = 0;
          |ACABA;
     |FINSI;


     |MENSA "    Localidad. Existe más de una en este Código Postal. Pulse F5 para selección.";

     |SI swF5 = 0;
          aAlfa1 = #labtraba#6;
          |QBF aAlfa1;
          |SI aAlfa1 ! ""; |Y enPintaLoc = 0;
               |ACABA;
          |FINSI;
     |FINSI;

     |DBASE aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "def/tm" + Usuario + ".mas";
     |CARGA_DEF aAlfa , temp0001@;
     |SI FSalida = 0;
          aAlfa = "tm" + Usuario;
          |NOME_DAT #500 aAlfa;
          |ABRE #temp0001@;
          nModo = 2 + 4 + 8 + 16;
          nPos1 = 1723; nPos2 = 2376;
          |MENSA "    Localidad. Existe más de una en este Código Postal. Elija la que corresponde";
          |LINEAL_SIMPLE #1#temp0001@,nModo, nPos1, nPos2, NULL, NULL, NULL;
          |SI FSalida = 0;
               #labtraba#6 = #temp0001@#2;
               |PINTA #labtraba#6;
               enPintaLoc = 0;
          |FINSI;
          |CIERRA #temp0001@; |DESCARGA_DEF #temp0001@;
     |FINSI;
     |ERROR;
     |ACABA;
|FPRC;

|PROCESO DefectoRel;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |SI #0Campo ! Contenido;
               nNume = #0#45;
               |SI nNume < 399;
                    #labtraba#111 = 1;
               |SINO;
                    #labtraba#111 = 2;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MotivoBaja; |TIPO 66;
     |ABRE #motibaja;
     |CONSULTA_CLAVE #1#motibaja;
     |SI FSalida = 0;
          aAlfa1 = #motibaja#0; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #motibaja#1;
          aAlfa = aAlfa1 + " - " + aAlfa2;
          #0Campo = aAlfa;
          |PINTA #0Campo;
     |FINSI;
     |CIERRA #motibaja;
|FPRC;

|PROCESO Activa135; |TIPO 14;
     |SI #0#45 = "420"; |O #0#45 = "520"; |O #0#45 = "421";
          |CAMPO_MODIFICA #0#135, 1, "N";
          |CAMPO_VISUAL #0#135, 1, "N";
          |CAMPO_MODIFICA #0#220, 1, "N";
          |CAMPO_VISUAL #0#220, 1, "N";
          |CAMPO_POSICION #0#135, 1, 2078;
          |ATRI 0;
          |PINTA 2080, "³";
          |ATRI I;
          || Asumo que no me van a hacer una jubilacion parcial a un contrato
          || en formacion o practicas, si se da el caso ya veremos
     |SINO;
          |CAMPO_MODIFICA #0#135, 1, "S";
          |CAMPO_VISUAL #0#135, 1, "S";
          |CAMPO_VISUAL #0#220, 1, "S";
          |CAMPO_POSICION #0#135, 1, 2071;
          |ATRI 0;
          |PINTA 2058, "³Jubil.Par.:         ³";
          |ATRI I;
          |PINTA #0#135;
          |PINTA #0#220;

          |SI #0#135 = "S";
               |CAMPO_MODIFICA #0#220, 1, "S";
          |FINSI;

          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Mensa191; |TIPO 7;
     |SI #0#45 ! "422";
          |MENSA "    (S) Bonif. 100% (T) Bonif. 75% (N) No bonif; <F10> Media; <F6> HORAS";
     |SINO;
          |MENSA "    (S) Bonificado 100% -RDL 8/2014- (N) No bonificado; <F6> HORAS ";
     |FINSI;
|FPRC;

|PROCESO HorarioSemanalTP;
     |ABRE #nomcontr; |LEE 000#nomcontr.p; |CIERRA #nomcontr;
     |SI #0Campo = "P"; |O #0Campo = "X"; |O #0Campo = "T";
          |PUSHV 05012380;

          fFecha = ~;
          aAlfa = fFecha; aAlfa = aAlfa % -104;
          nNume = aAlfa;
          eaNombre = #labtraba#2;

          |SALVA_FICHA #labtraba;

          |ABRE #nomhortp;
          |DDEFECTO #nomhortp;
          #nomhortp#0 = #0#0;
          #nomhortp#1 = #0#1;
          |LEE 000#nomhortp.=;
          FEstado = FSalida;

          |SI FSalida ! 0; |Y #nomcontr#73 = "S";
               |CLS;
               |PINPA #0#nomhortp;
               |PINDA #0#nomhortp;
               |ENDATOS #1#nomhortp;
               |SI FSalida = 0;
                    |GRABA 020#nomhortp.n;
                    |LIBERA #nomhortp;
               |FINSI;
          |SINO;
               |SI nTecla = 13;
                    |CLS;
                    |PINPA #0#nomhortp;
                    |PINDA #0#nomhortp;
                    |ENDATOS #1#nomhortp;
                    |SI FSalida = 0;
                         |GRABA 020#nomhortp.a;
                         |LIBERA #nomhortp;
                    |FINSI;
               |FINSI;
          |FINSI;
          |CIERRA #nomhortp;
          |REPON_FICHA #labtraba;
          |POPV;
     |FINSI;
|FPRC;

|PROCESO Mensa42; |TIPO 7;
     |SI #0#42 = "H";
          |MENSA "    Pulse < F5 > para Autonomos: BASES Y CUOTAS.";
     |FINSI;
     |SI #0#42 = "X"; |O #0#42 = "T"; |O #0#42 = "P";
          |MENSA "    Pulse < F5 > para Tiempo Parcial o Irregulares: HORARIO TIEMPO PARCIAL";
     |FINSI;
|FPRC;

|PROCESO CeroHoras;
     |SI #0#42 ! "X"; |Y #0#42 ! "T"; |Y #0#42 ! "P";
     |Y #0#42 ! "C"; |Y #0#42 ! "F";
     |Y #0#129 ! "G";
          #0#234 = 0;
          #0#47 = 0;
     |FINSI;
     |SI nTecla = 2; |HAZ Mod003430; |FINSI;
|FPRC;

|PROCESO AvisoHoras;
     |SI #0#42 = "L"; |Y #0#129 = "G";
          |SI #0#243 = 0;
               aAlfa = "    En trabajadores con clave 'L' en Guarda Legal, es necesario ";
               aAlfa = aAlfa + "indicar la jornada.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ConsultaIdi; |TIPO 66;
     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/nomlinom.mas";
     |CARGA_DEF aAlfa, temp0001@;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #temp0001@#aAlfa#;

     |SI FSalida = 0;
          |ABRE #temp0001@;
          |CONSULTA_CLAVE #1#temp0001@;
          |SI FSalida = 0;
               #0Campo = #temp0001@#0;
               |PINTA #0Campo;
               |ERROR;
          |FINSI;
          |CIERRA #temp0001@;
     |FINSI;

     |DESCARGA_DEF #temp0001@;
|FPRC;

|PROCESO ValidaIdi;
     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/nomlinom.mas";
     |CARGA_DEF aAlfa, temp0001@;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #temp0001@#aAlfa#;

     |SI FSalida = 0;
          |ABRE #temp0001@;
          #temp0001@#0 = #0#136;
          |LEE 000#temp0001@.=;
          |SI FSalida ! 0;
               aAlfa = #temp0001@#0;
               |QBF aAlfa;
               |SI aAlfa = "";
                    aAlfa = "    ATENCION. Debe seleccionar el idioma del recibo de nómina. ";
               |SINO;
                    aAlfa = "    ATENCION. Idioma no encontrado. ";
               |FINSI;
               aAlfa = aAlfa + "Pulse F11 para consultar disponibles";
               |MENAV aAlfa;
               |ERROR;
          |FINSI;
          |CIERRA #temp0001@;
     |FINSI;

     |DESCARGA_DEF #temp0001@;
|FPRC;

|PROCESO ActivaIDAL; |TIPO 14;
     swIDAL = 0;
     |ABRE #labempre;
     #labempre#0 = #labtraba#0;
     |LEE 000#labempre.=;
     |SI #labempre#69 = "S";
          swIDAL = 1;
     |FINSI;
     |CIERRA #labempre;

     |C_M #0#142, 1, "N";
     |C_V #0#142, 1, "N";
     |ATRI I;
     |PINTA 1060, "                   ";
     |ATRI I;
     |SI swIDAL = 1;
          |ATRI I;
          |PINTA 1064, "Enlace IDAL:";
          |ATRI R;
          |ATRI 0;
          |C_M #0#142, 1, "S";
          |C_V #0#142, 1, "S";
          |ATRI I;
          nModo = (FEntrada / 100) ! 0;
          |SI nModo = 1;
               #0#142 = "S";
          |FINSI;
          |PINTA #0#142;
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Activa142; |TIPO 14;
     |CAMPO_MODIFICA #0#143, 1, "N";
     |CAMPO_VISUAL #0#143, 1, "N";
     |ATRI I;
     |PINTA 1160, "                   ";
     |ATRI I;
     |SI swFacturacion = 1;
          |ATRI I;
          |PINTA 1164, "Facturable.:";
          |ATRI R;
          |ATRI 0;
          |CAMPO_MODIFICA #0#143, 1, "S";
          |CAMPO_VISUAL #0#143, 1, "S";
          |ATRI I;
          |PINTA #0#143;
          |ATRI I;
     |FINSI;
|FPRC;

|PROCESO Variacion;
     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/nomvarca.mas";
     |CARGA_DEF aAlfa, temp0001@;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "def/nomvarli.mas";
     |CARGA_DEF aAlfa, temp0002@;

     |DBASE aAlfa;
     |QBF aAlfa;
     aAlfa = aAlfa + "fich/";
     |PATH_DAT #temp0001@#aAlfa#;
     |PATH_DAT #temp0002@#aAlfa#;

     |ABRE #500;
     #500#0 = #labtraba#0;
     #500#1 = #labtraba#1;
     #500#2 = nMesBaja;
     #500#3 = 0;
     |LEE 000#500=;
     FEstado = FSalida;
     #500#16 = #0#37;
     #500#46 = nMotivo;
     |SI FEstado = 0;
          |GRABA 020#500a;
     |SINO;
          |GRABA 020#500n;
     |FINSI;
     |CIERRA #500;

     |ABRE #501;
     #501#0 = #labtraba#0;
     #501#1 = #labtraba#1;
     #501#2 = nMesBaja;
     #501#3 = 0;
     #501#4 = 902;
     |LEE 101#501=;
     |SI FSalida = 0;
          || si ya existia borro el 902 que hubiera
          |BORRA 020#501.a;
     |FINSI;
     aAlfa = nDiasInd; |QBF aAlfa;
     |QBF aAlfa;
     aAlfa = ("          " + aAlfa) % -110;

     #501#5 = aAlfa;
     #501#6 = "Indemniz.A¤o";
     |GRABA 020#501n;
     |LIBERA #501;
     |CIERRA #501;

     |DESCARGA_DEF #temp0002@;
     |DESCARGA_DEF #temp0001@;

     sw902 = 0;
|FPRC;

|PROCESO Indemnizacion;
     |SI Contenido = #0Campo;
          |ACABA;
     |FINSI;

     || creacion automatica de la linea 902 en variaciones
     sw902 = 0;
     nDiasInd = 0;

     aAlfa = #labtraba#184;
     |QBF aAlfa;
     aAlfa = aAlfa % 102;
     nMotivo = aAlfa;

     nMesBaja = 0;
     aFechaBaja = #labtraba#37;
     |QBF aFechaBaja;
     |SI aFechaBaja ! ""; |Y aFechaBaja ! "..........";
          aAlfa = aFechaBaja % 402;
          nMesBaja = aAlfa;
     |FINSI;

     |SI nMotivo ! 0;
     |Y nMesBaja ! 0;
          |ABRE #motibaja;
          #motibaja#0 = nMotivo;
          |LEE 000#motibaja.=;
          |SI FSalida = 0;
               nDiasInd = #motibaja#2;
          |FINSI;

          |SI nDiasInd ! 0;
          |Y nMotivo ! 93;
               aAlfa = "    Este motivo de baja tiene asociada una indemnización de ";
               aAlfa1 = nDiasInd; |QBF aAlfa1;
               |SI nMotivo = 98;
                    aAlfa4 = #labtraba#34;
                    fFecha = aAlfa4;
                    |SI fFecha < "12.02.2012";
                         aAlfa1 = "45 ó 33";
                    |SINO;
                         aAlfa1 = "33";
                         nDiasInd = 33;
                    |FINSI;
                    aAlfa = aAlfa + aAlfa1 + " días por año trab. ";
               |SINO;
                    aAlfa = aAlfa + aAlfa1 + " días por año trabajado ";
               |FINSI;
               aAlfa2 = #motibaja#3; |QBF aAlfa2;
               aAlfa1 = "(máx. " + aAlfa2 + " meses)";
               |SI nMotivo = 93;
                    aAlfa1 = "";
               |FINSI;
               |SI nMotivo = 98;
                    aAlfa4 = #labtraba#34;
                    fFecha = aAlfa4;
                    |SI fFecha < "12.02.2012";
                         aAlfa1 = "(máx. 42 ó 24 meses)";
                    |SINO;
                         aAlfa1 = "(máx. 24 meses)";
                    |FINSI;
               |FINSI;
               aAlfa = aAlfa + aAlfa1;
               |MENAV aAlfa;
               aAlfa = "    S¿Desea crear la variación con el concepto 902 correspondiente?";
               |CONFI aAlfa;
               |SI FSalida = 0;
                    sw902 = 1;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;
