|FICHEROS;
     nometiqu #0;
     labempre #1;
     copiadef@ #500;
|FIN;

|VARIABLES;
 y = 0;
 x = 0;
    informe1    = "nometiq1";
    informe2    = "nometiq2";

    informe3    = "nometiq3";
    informe4    = "nometiq4";
    desde = "                                        ";
    hasta = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
    codialfa   = "";

    &codigo1   = "";
    &nombre1   = "";
    &direc1    = "";
    &codipo1_1 = "";
    &codipo2_1 = "";
    &pobla1    = "";
    &provi1    = "";

    &codigo2   = "";
    &nombre2   = "";
    &direc2    = "";
    &codipo1_2 = "";
    &codipo2_2 = "";
    &pobla2    = "";
    &provi2    = "";

    {-1}menu = "";
        menu1 = "2400";
        menu2 = "1";
        menu3 = "Elija ordenaci¢n : ";
        menu4 = "CN";
        menu5 = "  C¢digo  ";
        menu6 = "  Nombre  ";

    alfa1 = "";
    alfa2 = "";
    alfa3 = "";

     aMas = "";
     aFabre = "";
     aFich = "";
     aAlfa = "";
     aBase = "";
|FIN;

***************************************************************************
     LECTURA E IMPRESION
***************************************************************************

|PROCESO integral;
     aFabre = "";
     |DIRECTORIO aFabre;
     aFabre = "rt  " + aFabre + "integral/bin/dsam0005.tab";
     |FABRE aFabre;
     |SI FSalida ] 0;
          |FCIERRA FSalida;
          |DBASS aBase;  |QBF aBase;
          aMas  = aBase + "integral/def/dsam0005.mas";
          aFich = aBase + "integral/fich/";

          |CARGA_DEF aMas, copiadef@;
          |SI FSalida ! 0;
              aAlfa = "0000 No puedo cargar el Def " + aMas;
              |MENAV aAlfa;
              |ACABA;
          |FINSI;

          |ABRE #500;
          #500#0 = #1#0;
          #500#1 = 99;
          |LEE 000#500=;
          |SI FSalida = 0;
               #1#0 = #500#0;           || codigo
               ||#1#2 = #500#2;           || nombre
               alfa1 = #500#3; |QBF alfa1; alfa1 = alfa1 + " ";  || tipo via
               alfa1 = alfa1 + #500#4;           || domicilio empresa
               |QBF alfa1
               #1#3 = alfa1;           || domicilio empresa
               #1#4 = #500#5;           || numero
               alfa1 = #500#7 + " - " + #500#8;           || piso - puerta
               #1#5 = alfa1;
               #1#6 = #500#11;          || poblacion
               #1#7 = #500#9;           || cod. provincia
               #1#8 = #500#10;          || cod. poblacion
               #1#9 = #500#12;          || provincia
          |FINSI;
          |CIERRA #500;
          |DESCARGA_DEF #copiadef@;
     |FINSI;
|FPRC;

|PROCESO elegir;
     |SI #0#4 = "S";
          |HAZ integral;
     |FINSI;
     |SI #0#3 = 1;
          |HAZ columna1;
     |SINO;
          |HAZ columna2;
     |FINSI;
|FPRC;

|DEFBUCLE nometiqu0;
 #1#1;
 41;
 #0#0, "S";
 #0#1, "S";
 ;
 NULL, elegir;
|FIN;

|DEFBUCLE nometiqu1;
 #1#2;
 0, 41;
 desde, #0#0, "S";
 hasta, #0#1, "S";
 ;
 NULL, elegir;
|FIN;

|PROCESO impre;|TIPO 3;
     |SI #0#5 = "N";
         informe1 = informe3;
         informe2 = informe4;
     |FINSI;
     y = 0;
     |IMPRE 0;
     |SI FSalida = 0;
          |MENU menu;
          menu2 = FSalida;
          |SI menu2 = 1; |O menu2 = 2;
               |SI menu2 = 1;
                    |BUCLE nometiqu0;
               |SINO;
                    |BUCLE nometiqu1;
               |FINSI;
               |SI y = 1;
                    |INFOR informe2;
                    |SI FSalida = 0;
                         |HAZ vacio;
                         |PRINT;
                         |PIEINF;
                         |FININF;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          |MENAV "    ATENCION !!! Proceso abortado ...";
     |FINSI;
     |FINIMP;
|FPRC;

***************************************************************************
     RUTINAS
***************************************************************************

|PROCESO columna1;
    alfa1 = #1#3;  |QBF alfa1;
    alfa2 = #1#4;  |QBF alfa2;
    alfa3 = #1#5;  |QBF alfa3;
    direc1 = alfa1 + " " + alfa2 + " " + alfa3;
    alfa1 = #1#7;
    codipo1_1 = "00" + alfa1;
    codipo1_1 = codipo1_1 % -102;
    alfa1 = #1#8;
    codipo2_1 = "000" + alfa1;
    codipo2_1 = codipo2_1 % -103;
|PARA x = 1;|SI x [ #0#2;|HACIENDO x = x + 1;
    |INFOR informe1;
    |PRINT;
    |PIEINF;
    |FININF;
|SIGUE;
|FPRC;

|PROCESO columna2;
|SI y = 1;
    |HAZ eti2;
|FINSI;
|PARA x = 1;|SI x [ #0#2;|HACIENDO x = x + 1;
        y = y + 1;
    |SI y = 2;
        |INFOR informe2;
        |HAZ eti2;
        |PRINT;
        |PIEINF;
        |FININF;
            y = 0;
    |SINO;
        |HAZ eti1;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO eti1;
    alfa1 = #1#0; codigo1 = "00000" + alfa1; codigo1 = codigo1 % -105;
    nombre1 = #1#2;
    alfa1 = #1#3; |QBF alfa1;
    alfa2 = #1#4; |QBF alfa2;
    alfa3 = #1#5; |QBF alfa3;
    direc1 = alfa1 + " " + alfa2 + " " + alfa3;
    alfa1 = #1#7;
    codipo1_1 = "00" + alfa1;
    codipo1_1 = codipo1_1 % -102;
    alfa1 = #1#8;
    codipo2_1 = "000" + alfa1;
    codipo2_1 = codipo2_1 % -103;
    pobla1 = #1#6;
    provi1 = #1#9;
|FPRC;

|PROCESO eti2;
    alfa1 = #1#0; codigo2 = "00000" + alfa1; codigo2 = codigo2 % -105;
    nombre2 = #1#2;
    alfa1 = #1#3; |QBF alfa1;
    alfa2 = #1#4; |QBF alfa2;
    alfa3 = #1#5; |QBF alfa3;
    direc2 = alfa1 + " " + alfa2 + " " + alfa3;
    alfa1 = #1#7;
    codipo1_2 = "00" + alfa1;
    codipo1_2 = codipo1_2 % -102;
    alfa1 = #1#8;
    codipo2_2 = "000" + alfa1;
    codipo2_2 = codipo2_2 % -103;
    pobla2 = #1#6;
    provi2 = #1#9;
|FPRC;

***************************************************************************
     SUBRUTINAS
***************************************************************************

|PROCESO vacio;
    codigo2   = "";
    nombre2   = "";
    direc2    = "";
    codipo1_2 = "";
    codipo2_2 = "";
    pobla2    = "";
    provi2    = "";
|FPRC;
