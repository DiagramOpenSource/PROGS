|FICHEROS;
     nom900de #0;
|FIN;

|VARIABLES;
     aAlfa = "";

     nUltima = 0;
     nLinea = 0;
     nPosicion = 0;
|FIN;

|PROCESO cuenta;
     nUltima = #0#0;
|FPRC;

|DEFBUCLE cuenta;
     #nom900de#1;
     ;
     001;
     999;
     ;
     NULL, cuenta;
|FIN;

|PROCESO InsertaLinea; |TIPO 11;
     |SI FSalida ! 13;
          |ACABA;
     |FINSI;

     nLinea = #0#0;
     nPosicion = nLinea;
     |BUCLE cuenta;

     |PARA nLinea = nUltima; |SI nLinea ] nPosicion; |HACIENDO nLinea = nLinea - 1;
          #0#0 = nLinea;
          |LEE 101#0=;
          |SI FSalida = 0;
               #0#0 = nLinea + 1;
               |GRABA 020#0n;
               |LIBERA #0;

               |SI nLinea ! nPosicion;
                    #0#0 = nLinea;
                    |LEE 101#0=;
                    |SI FSalida = 0;
                         |BORRA 020#0a;
                         |LIBERA #0;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;

     #0#0 = nPosicion;
     |LEE 101#0=;
     |SI FSalida = 0;
          |GRABA 020#0a;
          |LIBERA #0;
          |LEE 000#0=;
     |FINSI;
     |PONCONTROL 23, "si"; |PTEC 815;
     |ERROR;
|FPRC;

|PROCESO inferior;
     #nom900de#0 = 001;
|FPRC;

|PROCESO superior;
     #nom900de#0 = 999;
|FPRC;

|PROGRAMA;
     |CLS;

     aAlfa = "    Ojo, si el campo ORDEN, que es la clave está no visual, ";
     aAlfa = aAlfa + "hay que activarlo para poder entrar";
     |MENAV aAlfa;
     aAlfa = "    Si es así, ahora tendrás que matar la tarea. No te olvides de ponerlo ";
     aAlfa = aAlfa + "no visual cuando acabes";
     |MENAV aAlfa;

     |ABRE #nom900de;
     |CAMPO_VISUAL #nom900de#0, 1, "S";
     |ENTLINEAL #1#nom900de, -1, 2, 20, 1, inferior, superior;
     |CAMPO_VISUAL #nom900de#0, 1, "N";
     ||CONSULTA_CLAVE #1#nom900de;
     |CIERRA #nom900de;
|FPRO;
