|FICHEROS;
     laborn20 #0;
     labort10;
     labort09;

     laborn01;
     laborn02;
     laborn03;
     laborn04;
     laborn05;
     laborn07;
     laborn08;
     laborn09;
     laborn0a;
     laborb02;
     laborb03;

     labempre;
     labtraba;
|FIN;

|VARIABLES;
     aEstado = "";
     aAlfa = "";
     aDia = "";
     aMes = "";
     aAny = "";
     &eaParam = "";
     aParamOri = "";
     &enFSalida = 0;
     &eaUsuario = "";
     &eaEstado = "";
     &efFecha = @;
     &eaHora = "";
     nFecha = 0;
     fFecha = @;

     nModo = 0;
     nPos1 = 0;
     nPos2 = 0;
     nCampo = 0;
     &enBoton4 = 0;
     &enBoton5 = 0;
     &enBoton6 = 0;
     &enBoton7 = 0;
     &enBoton9 = 0;

     &enBorrado = 0;
     &enActualizado = 0;

     fClave0 = @;
     aClave1 = "";
     aClave2 = "";
     aClave3 = "";
     aClave4 = "";

     aAzul  = "18,28,245;255,255,255";
     aVerde = "0,185,0;255,255,255";
     aRojo  = "0,0,0;255,80,80";
     aRosa  = "215,120,210;255,255,255";

     aAlfa1 = "";
     aAlfa2 = "";
     nDesdeEmp = 0;
     nHastaEmp = 0;
     swUsuario = 0;
     &nLabornet = 1;
     &eaOperacion = "";

     aDesdeEstado = "";
     aHastaEstado = "";
|FIN;

|PROCESO Hasta;
     aAlfa = #laborn20#0;
     |QBF aAlfa;
     |SI aAlfa ! "";
          #laborn20#1 = aAlfa;
          |PINTA #laborn20#1;
     |FINSI;
|FPRC;

|PROCESO labort10;
     |PRINT;
|FPRC;

|DEFBUCLE labort10;
     #labort10#1;
     ;
     "A", #laborn20#0, #laborn20#2, "        ";
     "Z", #laborn20#1, #laborn20#3, "zzzzzzzz";
     ;
     NULL, labort10;
|FIN;

|PROCESO laborb02;
     |DDEFECTO #labort10;

     #labort10#0 = "D";               || codigo operacion
     #labort10#1 = "Cambio Datos";    || descripcion operacion

     #labort10#2 = #laborb02#27;      || usuario
     #labort10#3 = #laborb02#54;      || cod. empresa
     #labort10#6 = #laborb02#55;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     || #labort10#4 = #laborb02#8;      || nombre empresa
     #labort10#7 = #laborb02#2;      || nombre trabajador

     fFecha = #laborb02#25;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #laborb02#1;      || NIF trabajador

     #labort10#9  = #laborb02#25;     || fecha
     #labort10#10 = #laborb02#26;     || hora
     #labort10#11 = #laborb02#24;     || estado

     #labort10#12 = #laborb02#30;    || usuario que actualizo
     #labort10#13 = #laborb02#28;    || fecha de actualizacion
     #labort10#14 = #laborb02#29;    || hora de actualizacion

     #labort10#16 = #laborb02#56;   || contador

     |SI #laborb02#24 = "R";
         #labort10#19 = #laborb02#62 % 150;
         #labort10#20 = #laborb02#62 % 5150;
         #labort10#21 = #laborb02#62 % 10150;
         #labort10#22 = #laborb02#62 % 15150;
         #labort10#23 = #laborb02#62 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborb02;
     #laborb02#2;
     ;
     aDesdeEstado, #laborn20#2, "00:00:00";
     aHastaEstado, #laborn20#3, "23:59:59";
     ;
     NULL, laborb02;
|FIN;

|PROCESO laborb03;
     |DDEFECTO #labort10;

     #labort10#0 = "F";                         || codigo operacion
     #labort10#1 = "Datos personales IRPF";     || descripcion operacion
     #labort10#2 = #laborb03#7;                 || usuario
     #labort10#3 = #laborb03#2;                 || cod. empresa
     #labort10#6 = #laborb03#3;                 || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#7 = #labtraba#2;                 || nombre trabajador

     fFecha = #laborb03#5;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #laborb03#1;      || NIF trabajador

     #labort10#9  = #laborb03#5;      || fecha
     #labort10#10 = #laborb03#6;      || hora
     #labort10#11 = #laborb03#4;      || estado

     #labort10#12 = #laborb03#11;    || usuario que actualizo
     #labort10#13 = #laborb03#9;     || fecha de actualizacion
     #labort10#14 = #laborb03#10;    || hora de actualizacion

     #labort10#16 = #laborb03#13;   || contador

     |SI #laborb03#4 = "R";
         #labort10#19 = #laborb03#14 % 150;
         #labort10#20 = #laborb03#14 % 5150;
         #labort10#21 = #laborb03#14 % 10150;
         #labort10#22 = #laborb03#14 % 15150;
         #labort10#23 = #laborb03#14 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborb03;
     #laborb03#2;
     ;
     aDesdeEstado, #laborn20#2, "00:00:00";
     aHastaEstado, #laborn20#3, "23:59:59";
     ;
     NULL, laborb03;
|FIN;

|PROCESO laborn0a;
     |DDEFECTO #labort10;

     #labort10#0 = "R";              || codigo operacion
     #labort10#1 = "Retenciones";     || descripcion operacion
     #labort10#2 = #laborn0a#1;      || usuario
     #labort10#3 = #laborn0a#5;      || cod. empresa
     #labort10#6 = #laborn0a#6;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #labempre#2;      || nombre empresa
     #labort10#7 = #labtraba#2;      || nombre trabajador

     fFecha = #laborn0a#3;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #laborn0a#7;      || NIF trabajador

     #labort10#9  = #laborn0a#3;      || fecha
     #labort10#10 = #laborn0a#4;     || hora
     #labort10#11 = #laborn0a#0;     || estado

     #labort10#12 = #laborn0a#21;    || usuario que actualizo
     #labort10#13 = #laborn0a#22;    || fecha de actualizacion
     #labort10#14 = #laborn0a#23;    || hora de actualizacion

     #labort10#16 = #laborn0a#24;   || contador

     |SI #laborn08#0 = "R";
         #labort10#19 = #laborn0a#25 % 150;
         #labort10#20 = #laborn0a#25 % 5150;
         #labort10#21 = #laborn0a#25 % 10150;
         #labort10#22 = #laborn0a#25 % 15150;
         #labort10#23 = #laborn0a#25 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn0a;
     #laborn0a#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn0a;
|FIN;

|PROCESO laborn09;
     |DDEFECTO #labort10;

     #labort10#0 = "E";            || codigo operacion
     #labort10#1 = "Embargos";     || descripcion operacion
     #labort10#2 = #laborn09#1;    || usuario
     #labort10#3 = #laborn09#5;    || cod. empresa
     #labort10#6 = #laborn09#6;    || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #labempre#2;      || nombre empresa
     #labort10#7 = #labtraba#2;      || nombre trabajador

     fFecha = #laborn09#3;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #laborn09#7;      || NIF trabajador

     #labort10#9  = #laborn09#3;      || fecha
     #labort10#10 = #laborn09#4;     || hora
     #labort10#11 = #laborn09#0;     || estado

     #labort10#12 = #laborn09#18;    || usuario que actualizo
     #labort10#13 = #laborn09#19;    || fecha de actualizacion
     #labort10#14 = #laborn09#20;    || hora de actualizacion

     #labort10#16 = #laborn09#21;   || contador

     |SI #laborn09#0 = "R";
         #labort10#19 = #laborn09#22 % 150;
         #labort10#20 = #laborn09#22 % 5150;
         #labort10#21 = #laborn09#22 % 10150;
         #labort10#22 = #laborn09#22 % 15150;
         #labort10#23 = #laborn09#22 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn09;
     #laborn09#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn09;
|FIN;

|PROCESO laborn08;
     |DDEFECTO #labort10;

     #labort10#0 = "C";              || codigo operacion
     #labort10#1 = "Correcci¢n";     || descripcion operacion
     #labort10#2 = #laborn08#1;      || usuario
     #labort10#3 = #laborn08#5;      || cod. empresa
     #labort10#6 = #laborn08#6;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #laborn08#8;      || nombre empresa
     #labort10#7 = #laborn08#9;      || nombre trabajador

     fFecha = #laborn08#3;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #laborn08#7;      || NIF trabajador

     #labort10#9  = #laborn08#3;      || fecha
     #labort10#10 = #laborn08#4;     || hora
     #labort10#11 = #laborn08#0;     || estado

     #labort10#12 = #laborn08#26;    || usuario que actualizo
     #labort10#13 = #laborn08#27;    || fecha de actualizacion
     #labort10#14 = #laborn08#28;    || hora de actualizacion

     #labort10#16 = #laborn08#29;   || contador

     |SI #laborn08#0 = "R";
         #labort10#19 = #laborn08#30 % 150;
         #labort10#20 = #laborn08#30 % 5150;
         #labort10#21 = #laborn08#30 % 10150;
         #labort10#22 = #laborn08#30 % 15150;
         #labort10#23 = #laborn08#30 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn08;
     #laborn08#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn08;
|FIN;

|PROCESO laborn05;
     |DDEFECTO #labort10;

     #labort10#0 = "P";              || codigo operacion
     #labort10#1 = "Pr¢rroga";       || descripcion operacion
     #labort10#2 = #laborn05#1;      || usuario
     #labort10#3 = #laborn05#5;      || cod. empresa
     #labort10#6 = #laborn05#6;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #labempre#2;      || nombre empresa
     #labort10#7 = #labtraba#2;      || nombre trabajador

     fFecha = #laborn05#9;
     nFecha = fFecha;
     nFecha = nFecha + 1;
     fFecha = nFecha;
     #labort10#5 = fFecha;           || fecha operacion

     #labort10#8 = #labtraba#7;      || NIF trabajador

     #labort10#9 = #laborn05#3;      || fecha
     #labort10#10 = #laborn05#4;     || hora
     #labort10#11 = #laborn05#0;     || estado

     #labort10#12 = #laborn05#19;    || usuario que actualizo
     #labort10#13 = #laborn05#20;    || fecha de actualizacion
     #labort10#14 = #laborn05#21;    || hora de actualizacion

     #labort10#16 = #laborn05#22;    || contador

     |SI #laborn05#0 = "R";
         #labort10#19 = #laborn05#23 % 150;
         #labort10#20 = #laborn05#23 % 5150;
         #labort10#21 = #laborn05#23 % 10150;
         #labort10#22 = #laborn05#23 % 15150;
         #labort10#23 = #laborn05#23 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn05;
     #laborn05#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn05;
|FIN;

|PROCESO laborn04;
     |DDEFECTO #labort10;

     #labort10#0 = "I";              || codigo operacion
     #labort10#1 = "Incidencia";     || descripcion operacion
     #labort10#2 = #laborn04#1;      || usuario
     #labort10#3 = #laborn04#5;      || cod. empresa
     #labort10#6 = #laborn04#6;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #labempre#2;      || nombre empresa
     #labort10#7 = #labtraba#2;      || nombre trabajador

     aDia = "01";
     aMes = #laborn04#7;
     aAny = #laborn04#102;
     |QBF aDia;
     |QBF aMes;
     |QBF aAny;
     aDia = ("00" + aDia) % -102;
     aMes = ("00" + aMes) % -102;
     aAlfa = aDia + "." + aMes + "." + aAny;
     #labort10#5 = aAlfa;            || fecha operacion

     #labort10#8 = #labtraba#7;      || NIF trabajador

     #labort10#9 = #laborn04#3;      || fecha
     #labort10#10 = #laborn04#4;     || hora
     #labort10#11 = #laborn04#0;     || estado

     #labort10#12 = #laborn04#147;   || usuario que actualizo
     #labort10#13 = #laborn04#148;   || fecha de actualizacion
     #labort10#14 = #laborn04#149;   || hora de actualizacion

     #labort10#16 = #laborn04#150;   || contador

     |SI #laborn04#0 = "R";
         #labort10#19 = #laborn04#151 % 150;
         #labort10#20 = #laborn04#151 % 5150;
         #labort10#21 = #laborn04#151 % 10150;
         #labort10#22 = #laborn04#151 % 15150;
         #labort10#23 = #laborn04#151 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn04;
     #laborn04#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn04;
|FIN;

|PROCESO laborn03;
     |DDEFECTO #labort10;

     #labort10#0 = "V";              || codigo operacion
     #labort10#1 = "Variaci¢n ";      || descripcion operacion
     |SI #laborn03#7 = 1; #labort10#1 = #labort10#1 + "contrato"; |FINSI;
     |SI #laborn03#7 = 2; #labort10#1 = #labort10#1 + "categor¡a"; |FINSI;
     |SI #laborn03#7 = 3; #labort10#1 = #labort10#1 + "ocupaci¢n"; |FINSI;
     #labort10#2 = #laborn03#1;      || usuario
     #labort10#3 = #laborn03#5;      || cod. empresa
     #labort10#6 = #laborn03#6;      || codigo trabajador

     #labempre#0 = #labort10#3;
     |LEE 000#labempre.=;

     #labtraba#0 = #labort10#3;
     #labtraba#1 = #labort10#6;
     |LEE 000#labtraba.=;

     #labort10#4 = #labempre#2;      || nombre empresa
     #labort10#7 = #labtraba#2;      || nombre trabajador

     #labort10#5 = #laborn03#30;     || fecha operacion

     #labort10#8 = #labtraba#7;      || NIF trabajador

     #labort10#9 = #laborn03#3;      || fecha
     #labort10#10 = #laborn03#4;     || hora
     #labort10#11 = #laborn03#0;     || estado

     #labort10#12 = #laborn03#34;    || usuario que actualizo
     #labort10#13 = #laborn03#35;    || fecha de actualizacion
     #labort10#14 = #laborn03#36;    || hora de actualizacion

     #labort10#16 = #laborn03#37;   || contador

     |SI #laborn03#0 = "R";
         #labort10#19 = #laborn03#39 % 150;
         #labort10#20 = #laborn03#39 % 5150;
         #labort10#21 = #laborn03#39 % 10150;
         #labort10#22 = #laborn03#39 % 15150;
         #labort10#23 = #laborn03#39 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn03;
     #laborn03#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn03;
|FIN;

|PROCESO laborn02;
     |DDEFECTO #labort10;

     #labort10#0 = "B";              || codigo operacion
     #labort10#1 = "Baja";           || descripcion operacion
     #labort10#2 = #laborn02#1;      || usuario
     #labort10#3 = #laborn02#5;      || cod. empresa
     #labort10#4 = #laborn02#15;     || nombre empresa

     #labort10#5 = #laborn02#8;      || fecha operacion
     #labort10#6 = #laborn02#6;      || codigo trabajador
     #labort10#7 = #laborn02#16;     || nombre trabajador

     #labort10#8 = #laborn02#7;      || NIF trabajador

     #labort10#9 = #laborn02#3;      || fecha
     #labort10#10 = #laborn02#4;     || hora
     #labort10#11 = #laborn02#0;         || estado

     #labort10#12 = #laborn02#19;    || usuario que actualizo
     #labort10#13 = #laborn02#20;    || fecha de actualizacion
     #labort10#14 = #laborn02#21;    || hora de actualizacion
     #labort10#15 = aRojo;           || COLOR

     #labort10#16 = #laborn02#23;   || contador

     |SI #laborn02#0 = "R";
         #labort10#19 = #laborn02#24 % 150;
         #labort10#20 = #laborn02#24 % 5150;
         #labort10#21 = #laborn02#24 % 10150;
         #labort10#22 = #laborn02#24 % 15150;
         #labort10#23 = #laborn02#24 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn02;
     #laborn02#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn02;
|FIN;

|PROCESO laborn01;
     |DDEFECTO #labort10;

     #labort10#0 = "A";              || codigo operacion
     #labort10#1 = "Alta";           || descripcion operacion
     #labort10#2 = #laborn01#1;      || usuario
     #labort10#3 = #laborn01#5;      || cod. empresa
     #labort10#4 = #laborn01#210;    || nombre empresa
     |SI #laborn01#0 ! "A";  |Y #laborn01#0 ! "P";  |Y #laborn01#0 ! "R";
           |ACABA;
           || #labort10#0 = #laborn01#0;
           || #labort10#1 = #laborn01#0;
     |FINSI;
     aDia = #laborn01#193;
     aMes = #laborn01#194;
     aAny = #laborn01#195;
     |QBF aDia;
     |QBF aMes;
     |QBF aAny;
     aDia = ("00" + aDia) % -102;
     aMes = ("00" + aMes) % -102;
     aAlfa = aDia + "." + aMes + "." + aAny;
     #labort10#5 = aAlfa;            || fecha operacion
     #labort10#6 = #laborn01#215;    || codigo trabajador

     aAlfa = #laborn01#7; |QBF aAlfa;
     aAlfa = aAlfa + " " + #laborn01#8; |QBF aAlfa;
     aAlfa = aAlfa + ", " + #laborn01#6; |QBF aAlfa;
     #labort10#7 = aAlfa;            || nombre trabajador

     #labort10#8 = #laborn01#9;      || NIF trabajador

     #labort10#9  = #laborn01#3;     || fecha
     #labort10#10 = #laborn01#4;     || hora
     #labort10#11 = #laborn01#0;     || estado

     #labort10#12 = #laborn01#235;   || usuario que actualizo
     #labort10#13 = #laborn01#236;   || fecha de actualizacion
     #labort10#14 = #laborn01#237;   || hora de actualizacion

     #labort10#16 = #laborn01#242;   || contador

     |SI #laborn01#0 = "R";
         #labort10#19 = #laborn01#244 % 150;
         #labort10#20 = #laborn01#244 % 5150;
         #labort10#21 = #laborn01#244 % 10150;
         #labort10#22 = #laborn01#244 % 15150;
         #labort10#23 = #laborn01#244 % 20150;
     |FINSI;

     |GRABA 020#labort10.n;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE laborn01;
     #laborn01#2;
     ;
     aDesdeEstado, nDesdeEmp, #laborn20#2, "          ", "          ", "00:00:00";
     aHastaEstado, nHastaEmp, #laborn20#3, "zzzzzzzzzz", "zzzzzzzzzz", "23:59:59";
     ;
     NULL, laborn01;
|FIN;

|PROCESO Impresion;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "laborn20";

          |BUCLE labort10;

          |PIEINF;
          |FININF;
     |FINSI;

     |FINIMP;
|FPRC;

|PROCESO CargaSolicitudes;
     |SI swUsuario = 1;
          nDesdeEmp = #labort09#0;
          nHastaEmp = #labort09#0;
     |SINO;
          nDesdeEmp = 00001;
          nHastaEmp = 99999;
     |FINSI;

     |BUCLE laborn01;
     |BUCLE laborn02;
     |BUCLE laborn03;
     |BUCLE laborn04;
     |BUCLE laborn05;
     |BUCLE laborn08;
     |BUCLE laborn09;
     |BUCLE laborn0a;
     |BUCLE laborb02;
     |BUCLE laborb03;
|FPRC;

|DEFBUCLE CargaSolicitudes;
     #labort09#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, CargaSolicitudes;
|FIN;

|PROCESO carga_empresas;
     #labort09#0 = #labempre#0;
     |LEE 101#labort09.=;
     |SI FSalida ! 0;
          |GRABA 020#labort09.n;
     |FINSI;
     |LIBERA #labort09;
|FPRC;

|DEFBUCLE carga_empresas;
     #labempre#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, carga_empresas;
|FIN;

|PROCESO BorraLineal;
     |BORRA 020#labort10.a;
     |LIBERA #labort10;
|FPRC;

|DEFBUCLE BorraLineal;
     #labort10#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, BorraLineal;
|FIN;

|PROCESO RecargaLineal;
     fClave0 = #labort10#5;
     aClave1 = #labort10#0;
     aClave2 = #labort10#2;
     aClave3 = #labort10#9;
     aClave4 = #labort10#10;

     |BUCLE BorraLineal;

     |SI swUsuario = 1;
          || entrada de USUARIO, primero genero un temporal con las empresas
          || a las que tengo acceso, realizando la carga desde el labempre
          || que con el DFICE y DFICB tengo controlado el labempre
          |BUCLE carga_empresas;
     |FINSI;

     aDesdeEstado = "A";
     aHastaEstado = "R";

     |SI swUsuario = 1;
          || carga solo de las empresas a las que tiene acceso
          |BUCLE CargaSolicitudes;
     |SINO;
          || ADMINISTRADOR, directamente el proceso
          |HAZ CargaSolicitudes;
     |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;

     |PINPA #0#laborn20;
     |PINDA #0#laborn20;

     |ENDATOS #1#laborn20;

     |SI FSalida = 0;
          |DFICE aAlfa1;
          |DFICB aAlfa2;

          swUsuario = 0;
          |SI aAlfa1 ! aAlfa2;
               |PATH_DAT #labempre#aAlfa1#;
               swUsuario = 1;
          |FINSI;

          |ABRE #labempre;
          |ABRE #labtraba;

          aAlfa = "labort10" + Usuario;
          |NOME_DAT #labort10#aAlfa#;
          |DELINDEX #labort10;
          |ABRE #labort10;

          aAlfa = "labort09" + Usuario;
          |NOME_DAT #labort09#aAlfa#;
          |DELINDEX #labort09;
          |ABRE #labort09;

          |HAZ RecargaLineal;

          |HAZ Impresion;

          |CIERRA #labtraba;
          |CIERRA #labempre;
          |CIERRA #labort09;
          |CIERRA #labort10;

          |DELINDEX #labort09;
          |DELINDEX #labort10;

          |DFICE aAlfa1;
          |DFICB aAlfa2;

          |SI aAlfa1 ! aAlfa2;
               |PATH_DAT #labempre#aAlfa2#;
          |FINSI;
     |FINSI;
|FPRO;
