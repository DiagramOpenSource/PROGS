|FICHEROS;
     cretai05 #0;

     cretam31;
     cretam33;
     cretam00;
|FIN;

|VARIABLES;
     &nError = 0;
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     FEstado = 0;
     aAlfa = "";
     aAntCCC = "";

     fFecha = @;
     aFecha = "";
     nMes = 0;
     nAny = 0;
     aReferencia = "";
     nNume = 0;
     nTramos = 0;
     nImpresion = 0;

     nMesDesde = 0;
     nMesHasta = 0;
     nAnyDesde = 0;
     nAnyHasta = 0;
|FIN;

|PROCESO Defectos;
     fFecha = ~;
     aFecha = fFecha;
     aAlfa = aFecha % -104;
     nAny = aAlfa;

     aAlfa = aFecha % 402;
     nMes = aAlfa;
     nMes = nMes - 1;
     |SI nMes = 0;
          nMes = 12;
          nAny = nAny - 1;
     |FINSI;

     #0#2 = nAny;
     #0#3 = nMes;
     |PINTA #0#2;
     |PINTA #0#3;
|FPRC;

|PROCESO AvisoTipos;
     |SI #0Campo = 01;
          aAlfa = "    ATENCION: con la selección 'Desde tipo 01'";
          aAlfa = aAlfa + " no se incluyen las liquidaciones L00";
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO AyudaTipos; |TIPO 7;
     |PUSHV 08622380;
     |ATRI R;
     ||            6         7
     ||            34567890123456789
     |PINTA 0863, "  - Opciones -   ";
     |PINTA 0963, " 00 :Normal      ";
     |PINTA 1063, " 02 :Finiquitos  ";
     |PINTA 1163, "5-20:Atrasos     ";
     |PINTA 1263, " 90 :Complement. ";
     |PINTA 1363, "                 ";
     |PINTA 1463, "                 ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO ElIMPRE;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "cretai05";
     |FINSI;
|FPRC;

|PROCESO ElFINIMP;
     |FININF;

     |FINIMP;
|FPRC;

|PROCESO cretam33;
     |SI nImpresion = 0;
          |HAZ ElIMPRE;
     |FINSI;
     |PRINT;
     nImpresion = nImpresion + 1;
|FPRC;

|DEFBUCLE cretam33;
     #cretam33#1;
     ;
     #cretam31#0, nAnyDesde, nMesDesde, #cretam31#3, #cretam31#4, "            ", 01, 000;
     #cretam31#0, nAnyHasta, nMesHasta, #cretam31#3, #cretam31#4, "zzzzzzzzzzzz", 99, 999;
     ;
     NULL, cretam33;
|FIN;

|PROCESO cretam31;
     |SI #cretam31#3 < 05; |O #cretam31#3 = 90;
          nMesDesde = #cretam31#2;
          nMesHasta = #cretam31#2;
          nAnyDesde = #cretam31#1;
          nAnyHasta = #cretam31#1;
     |SINO;
          nMesDesde = #cretam31#17;
          nMesHasta = #cretam31#19;
          nAnyDesde = #cretam31#18;
          nAnyHasta = #cretam31#20;
     |FINSI;
     |BUCLE cretam33;
     |PIEINF;
|FPRC;

|DEFBUCLE cretam31_L90;
     #cretam31#3;
     ;
     #0#0, #0#2, #0#3, #0#6, "               ";
     #0#1, #0#2, #0#3, #0#7, "zzzzzzzzzzzzzzz";
     ;
     NULL, cretam31;
|FIN;

|DEFBUCLE cretam31;
     #cretam31#1;
     ;
     #0#0, #0#2, #0#3, #0#6, "               ", 0000;
     #0#1, #0#2, #0#3, #0#7, "zzzzzzzzzzzzzzz", 2999;
     ;
     NULL, cretam31;
|FIN;

|PROCESO Seleccion;
     |BUCLE cretam31;
     |BUCLE cretam31_L90;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |BORRA 020#0a;
     |SINO;
          |HAZ Defectos;
     |FINSI;

     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #cretam00; |LEE 000#cretam00.p; |CIERRA #cretam00;

          |ABRE #cretam31;
          |ABRE #cretam33;

          |HAZ Seleccion;

          |CIERRA #cretam33;
          |CIERRA #cretam31;


          |SI nImpresion ! 0;
               |HAZ ElFINIMP;
          |SINO;
               aAlfa = "    No se han encontrado datos de RNT para imprimir ";
               aAlfa = aAlfa + "con la selección realizada.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |GRABA 000#0n;
     |CIERRA #0;
|FPRO;
