|FICHEROS;
     cretai07 #0;

     cretam36;
     cretam37;
|FIN;

|VARIABLES;
     &nError = 0;
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     FEstado = 0;
     aAlfa = "";
     aAntCCC = "";

     fFecha = @;
     aFecha = "";
     nMes = 0;
     nAny = 0;
     aReferencia = "";
     nNume = 0;
     nTramos = 0;
     nImpresion = 0;
|FIN;

|PROCESO Defectos;
     fFecha = ~;
     aFecha = fFecha;
     aAlfa = aFecha % -104;
     nAny = aAlfa;

     aAlfa = aFecha % 402;
     nMes = aAlfa;
     nMes = nMes - 1;
     |SI nMes = 0;
          nMes = 12;
          nAny = nAny - 1;
     |FINSI;

     #0#2 = nAny;
     #0#3 = nMes;
     |PINTA #0#2;
     |PINTA #0#3;
|FPRC;

|PROCESO AvisoTipos;
     |SI #0Campo = 01;
          aAlfa = "    ATENCION: con la selección 'Desde tipo 01'";
          aAlfa = aAlfa + " no se incluyen las liquidaciones L00";
          |MENAV aAlfa;
     |FINSI;
|FPRC;

|PROCESO AyudaTipos; |TIPO 7;
     |PUSHV 08622380;
     |ATRI R;
     ||            6         7
     ||            34567890123456789
     |PINTA 0863, "  - Opciones -   ";
     |PINTA 0963, " 00 :Normal      ";
     |PINTA 1063, " 02 :Finiquitos  ";
     |PINTA 1163, "5-20:Atrasos     ";
     |PINTA 1263, " 90 :Complement. ";
     |PINTA 1363, "                 ";
     |PINTA 1463, "                 ";
     |ATRI 0;
|FPRC;

|PROCESO Restaura;
     |POPV;
|FPRC;

|PROCESO ElIMPRE;
     Impresora = "CrystalReport";
     |IMPRE -1;
     |SI FSalida = 0;
          |INFOR "cretai07";
     |FINSI;
|FPRC;

|PROCESO ElFINIMP;
     |FININF;

     |FINIMP;
|FPRC;

|PROCESO cretam37;
     |SI nImpresion = 0;
          |HAZ ElIMPRE;
     |FINSI;

     |PRINT;
     nImpresion = nImpresion + 1;
|FPRC;

|DEFBUCLE cretam37;
     #cretam37#1;
     ;
     #cretam36#0, #cretam36#1, #cretam36#2, #cretam36#3, #cretam36#4, 000, #cretam36#58;
     #cretam36#0, #cretam36#1, #cretam36#2, #cretam36#3, #cretam36#4, 999, #cretam36#58;
     ;
     NULL, cretam37;
|FIN;

|PROCESO cretam36;
     |BUCLE cretam37;
     |PIEINF;
|FPRC;

|DEFBUCLE cretam36_L90;
     #cretam36#3;
     ;
     #0#0, #0#2, #0#3, #0#6, "               ";
     #0#1, #0#2, #0#3, #0#7, "zzzzzzzzzzzzzzz";
     ;
     NULL, cretam36;
|FIN;

|DEFBUCLE cretam36;
     #cretam36#1;
     ;
     #0#0, #0#2, #0#3, #0#6, "               ", 0000;
     #0#1, #0#2, #0#3, #0#7, "zzzzzzzzzzzzzzz", 2999;
     ;
     NULL, cretam36;
|FIN;

|PROCESO Seleccion;
     |BUCLE cretam36;
     |BUCLE cretam36_L90;
|FPRC;

|PROGRAMA;
     |CLS;
     |PINPA #0#0;

     |ABRE #0;
     |DDEFECTO #0;
     |LEE 000#0p;
     |SI FSalida = 0;
          |BORRA 020#0a;
     |SINO;
          |HAZ Defectos;
     |FINSI;

     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |ABRE #cretam36;
          |ABRE #cretam37;

          |HAZ Seleccion;

          |CIERRA #cretam37;
          |CIERRA #cretam36;


          |SI nImpresion ! 0;
               |HAZ ElFINIMP;
          |SINO;
               aAlfa = "    No se han encontrado datos del RLC para imprimir ";
               aAlfa = aAlfa + "con la selección realizada.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;

     |GRABA 000#0n;
     |CIERRA #0;
|FPRO;
