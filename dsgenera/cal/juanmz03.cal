|FICHEROS;
     juanmz03 #0;
|FIN;

|VARIABLES;
     aAbre         = "";
     aAbre1        = "";
     aAbre2        = "";
     aGuarda       = "";
     aGraba        = "";
     aCampo        = "";
     aCampoAnt     = "";
     aAlfa         = "";
     aCaracter     = "";
     aCaracterSal  = "";
     aCaracter10   = "";
     aCaracter13   = "";
     aValor        = "";
     aCadena       = "";
     aCadenaSal    = "";
     aLinea        = "";
     aArchivoPdf   = "";
     aID           = "";
     aBase         = "";
     aIP           = "";
     aOrigen       = "";
     aDestino      = "";
     aLongitud     = "";
     aRefer        = "";

     nHandle     = 0;
     nHandle1    = 0;
     nHandle2    = 0;
     nAscii      = 0;
     nLongitud   = 0;
     nPos        = 0;
     nBusca      = 0;
     nConta      = 0;
|FIN;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162;
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;
          aCaracterSal = "\361";
     |FINSI;
|FPRC;

|PROCESO Cabecera;
     aLinea = "%FDF-1.2";
     |XGRABA nHandle, aLinea;
     aLinea = "%‚„œ”";
     |XGRABA nHandle, aLinea;
     aLinea = "1 0 obj";
     |XGRABA nHandle, aLinea;
     aLinea = "<< /FDF ";
     |XGRABA nHandle, aLinea;
     aLinea = "<< /Fields [ ";
     |XGRABA nHandle, aLinea;
|FPRC;

|PROCESO Lineas;
     |DFICE aAbre;  |QBF aGuarda;
     aAbre = aAbre + "mod036.txt";

     |XABRE "AB", aAbre, nHandle2;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA;  |SI;  |HACIENDO;
         |XLEE nHandle2, 15, aAlfa;
         |SI  FSalida [ 0;  |SAL;  |FINSI;

         aCampo = aAlfa % 113;           || nombre del campo
         aValor = "";              || valor
         |SI aCampo = "cabecera.1   ";
             aValor = "ALICANTE";              || valor
         |FINSI;
         |SI aCampo = "cabecera.2   ";
             aValor = "ALCOY";              || valor
         |FINSI;
         |SI aCampo = "cabecera.3   ";
             aValor = "03009";              || valor
         |FINSI;
         |SI aCampo = "dato.a.nif.1 ";
             aValor = "21650924N";              || valor
         |FINSI;
         |SI aCampo = "dato.1       ";
             aValor = "JUAN MANUEL GRANADOS GARCIA";              || valor
         |FINSI;
         |QBF aCampo;
         |QBF aValor;
         aLinea = "<< /V (" + aValor + ")/T (" + aCampo + ")>> ";
         aCadena = aLinea;
         |HAZ sustituye;
         aLinea = aCadenaSal;
         |XGRABA nHandle, aLinea;
     |SIGUE;

     |XCIERRA nHandle2;
|FPRC;

|PROCESO Pie;
     aLinea = "] ";
     |XGRABA nHandle, aLinea;
     aLinea = "/F (C:/cajon/hacienda/modelo036/mod036e.pdf)";
     |XGRABA nHandle, aLinea;
     |QBF aID;
     aLinea = "/ID [ " + aID + "] >>";
     |XGRABA nHandle, aLinea;
     aLinea = ">> ";
     |XGRABA nHandle, aLinea;
     aLinea = "endobj";
     |XGRABA nHandle, aLinea;
     aLinea = "trailer";
     |XGRABA nHandle, aLinea;
     aLinea = "<</Root 1 0 R >>";
     |XGRABA nHandle, aLinea;
     aLinea = "%%EOF";
     |XGRABA nHandle, aLinea;
|FPRC;

|PROGRAMA;
     |DBASE aAbre;  |QBF aAbre;
     aAbre1 = aAbre + "basura/campos.txt";
     aAbre2 = aAbre + "basura/camposb.txt";

     |XABRE "WB", aAbre2, nHandle1;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aCampoAnt   = "";
     aCaracter10 = &10;
     aCaracter13 = &13;
     nConta      = 0;
     |XABRE "AB", aAbre1, nHandle2;
     |SI FSalida ] 0;
          |PARA;  |SI;  |HACIENDO;
                  |XLEE nHandle2, 1, aAlfa;
                  |SI  FSalida [ 0;  |SAL;  |FINSI;

                  |SI aAlfa = aCaracter10;
                      aRefer = aCampo % 113;
                      |SI aRefer ! aCampoAnt;
                          nConta = nConta + 1;
                          aGraba = (("00000" + nConta) % -105) + "  " + aCampo + &13 + &10;
                          ||aGraba = ((aRefer + "             ") % 113) + &13 + &10;
                          |XGRABA nHandle1, aGraba;
                      |FINSI;

                      aCampoAnt = aRefer;
                      aCampo    = "";
                  |SINO;
                      |SI aAlfa ! aCaracter13;
                          aCampo = aCampo + aAlfa;
                      |FINSI;
                  |FINSI;
          |SIGUE;
     |FINSI;
     |XCIERRA nHandle1;
     |XCIERRA nHandle2;

/*

     |DBASE aBase;  |QBF aBase;
     aArchivoPdf = aBase + "pdf";  |MKDIR aArchivoPdf;
     aArchivoPdf = aArchivoPdf + "/mod036e.fdf";

     |XABRE "W", aArchivoPdf, nHandle;

     |HAZ Cabecera;
     |HAZ Lineas;
     |HAZ Pie;

     |XCIERRA nHandle;

     aIP = "";
     |IP_REMOTO aIP;

     aOrigen  = aArchivoPdf;
     aDestino = "C:\CAJON\hacienda\Modelo036\mod036e.fdf";
     |QBF aOrigen;
     |QBF aDestino;
     |SI aIP ! "";
          |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
          |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;

     |RSYSTEM aDestino;
*/
|FPRO;
