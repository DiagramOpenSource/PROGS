|FICHEROS;
     juanma01 #0;

     referen@ #100;
|FIN;

|VARIABLES;
     aBase      = "";
     aAbre      = "";
     aAlfa      = "";
     aCarga     = "";
     aDef       = "";
     aMensa     = "";
     aRelacion  = "";
     aTitulo    = "";
     aQueQuiero = "";

     nHandle   = 0;
     nContador = 0;
     nSwPrint  = 0;
|FIN;

|PROCESO Base;  |TIPO 7;
     |DBASS aBase;               |QBF aBase;
     #0#0 = aBase;
     |PINTA #0#0;
|FPRC;

|PROCESO PonPuntoDir;  |TIPO 7;
     #0#4 = #0#1;
     |PINTA #0#4;
|FPRC;

|PROCESO MiraRelacion;
     aCarga = aDef + aAlfa + ".mas";  |QBT aCarga;

     aMensa = "      Cargando Def " + aCarga;
     |MENSA aMensa;

     |CARGA_DEF aCarga, referen@;
     |SI FSalida = 0;
         |MODO_RELACION #100, 1, aRelacion, "N", "N";
         |SI FSalida ] 0;
             aQueQuiero = "|TITULO";
             aTitulo    = #100#aQueQuiero#;

             #0#3 = aCarga + " " + aTitulo;
             |PRINT;
             nSwPrint = 1;
         |FINSI;
     |SINO;
         aMensa = "     No puedo cargar el Def : " + aAlfa;
         |MENAV aMensa;
     |FINSI;

     |DESCARGA_DEF #referen@;
|FPRC;

|PROCESO Busqueda;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "juanma01";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     aRelacion = #0#2;  |QBT aRelacion;

     aBase = #0#0;               |QBF aBase;
     aBase = aBase + #0#1;       |QBF aBase;
     aDef  = aBase + "/def/";
     aBase = aBase + "/fich/";   |QBF aBase;

     aAbre = aBase + #0#4;       |QBF aAbre;
     aAbre = aAbre + ".dir";

     nContador = 0;
     |XABRE "U", aAbre, nHandle;
     |SI FSalida ] 0;
         |PARA;  |SI FSalida ] 0;  |HACIENDO;
              nContador = nContador + 1;
              |XLEE nHandle, 255, aAlfa;
              |QBT aAlfa;
              |SI nContador = 1;  |Y aAlfa ! "";
                  |HAZ MiraRelacion;
              |FINSI;
              |SI nContador = 5;  nContador = 0;  |FINSI;
         |SIGUE;
     |FINSI;
     |XCIERRA nHandle;

     |SI nSwPrint ! 0;
         |PIEINF;
     |SINO;
         |MENAV "     No encotrada Relaciones en la Aplicacion ";
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Busqueda de Relaciones";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
         |HAZ Busqueda;
     |FINSI;
|FPRO;
