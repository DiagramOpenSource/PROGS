|FICHEROS;
     juanmw10;

     :/ren2011/def/rem00101;
|FIN;

|VARIABLES;
     nOk        = 0;
     nNumCampos = 0;
     i          = 0;
     nLonCam    = 0;
     nCamClave  = 0;
     nPosCam    = 0;
     nNume      = 0;
     aValor = "";
     aCamClave = "";
     aValClave = "";
     aCampo = "";
     aBase = "";
     aPath = "";
     aDes = "";
     aFic = "";
     aAlfa = "";
     aOrg = "";
     aEmpAnt = "";
     aDefAnt = "";
     aEmp = "";
     aDef = "";
     aLon = "";
     aPathApli1 = "";
     aPathApli2 = "";
     aFicDef = "";
     nCarga = 0;
     aQueQuiero = "";
     aTipoAnt   = "";
     aAbre     = "";
     aGraba     = "";
     nHandle    = 0;

     aLong     = "";
     nLong     = 0;
     aTab      = "";
     aCadena   = "";
     nCampo    = 0;
     nPos      = 0;
     nCarac    = 0;
     aCaracter = "";
     nRegis    = 0;

     aFichero      = "";
     aAlfa1        = "";
     aAlfa2        = "";
|FIN;

|PROCESO Log;
     nOk = 0;
     |SI #juanmw10#3 = "C";
         |SI aTipoAnt ! "R32"; nOk = 1; |FINSI;
     |FINSI;

     |SI #juanmw10#3 = "R";
         |SI #juanmw10#4 = "32";
             nOk = 1;
         |FINSI;

         aTipoAnt = #juanmw10#3 + #juanmw10#4;
     |FINSI;

     |SI nOk = 0; |ACABA; |FINSI;

     aAlfa1 = #juanmw10#7 % 105;
     aAlfa2 = #juanmw10#7 % 702;

     #rem00101#0 = aAlfa1;
     #rem00101#1 = aAlfa2;
     |LEE 101#rem00101.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem00101;
         #rem00101#0 = aAlfa1;
         #rem00101#1 = aAlfa2;
         |GRABA 020#rem00101.b;
     |FINSI;

     |SI #juanmw10#3 = "C";               || Modifica campo
         aAlfa1 = #juanmw10#12;  |QBF aAlfa1;
         |SI aAlfa1 ! "";
             nCampo            = #juanmw10#6;
             #rem00101#nCampo# = #juanmw10#12;

             aAlfa1 = #rem00101#17 % -104;
             #rem00101#5 = aAlfa1;

             |GRABA 020#rem00101.a;
         |FINSI;
     |FINSI;

     |SI #juanmw10#3 = "R"; |Y #juanmw10#4 = "32";
          |BORRA 020#rem00101.a;
     |FINSI;

     |LIBERA #rem00101;
|FPRC;

|DEFBUCLE Log;
     #juanmw10#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, Log;
|FIN;

|PROCESO Indexa;
     aLong   = aAlfa % 0;
     nLong   = aLong;
     aTab    = &9;
     aCadena = "";
     nCampo  = 0;

     aAlfa1  = aAlfa % 110;
     #juanmw10#0 = aAlfa1;

     aAlfa1  = (aAlfa % 1702) + "." + (aAlfa % 1502) + "." + (aAlfa % 1104);
     #juanmw10#1 = aAlfa1;

     |SI #juanmw10#1 < "18.06.2012";
         |ACABA;
     |FINSI;

     aAlfa1      = aAlfa % 1908;
     #juanmw10#2 = aAlfa1;

     aAlfa1      = aAlfa % 2701;
     #juanmw10#3 = aAlfa1;

     aAlfa1      = aAlfa % 2802;
     #juanmw10#4 = aAlfa1;

     aAlfa1      = aAlfa % 3012;
     #juanmw10#5 = aAlfa1;

     aAlfa1      = aAlfa % 4203;
     #juanmw10#6 = aAlfa1;

     aAlfa1      = aAlfa % 4550;
     #juanmw10#7 = aAlfa1;

     aAlfa1      = aAlfa % 9517;
     #juanmw10#8 = aAlfa1;

     aAlfa1      = aAlfa % 11210;
     #juanmw10#9 = aAlfa1;

     aAlfa1       = aAlfa % 12250;
     #juanmw10#10 = aAlfa1;

     aAlfa1       = aAlfa % 17230;
     #juanmw10#11 = aAlfa1;

     aAlfa1       = aAlfa % 20230;
     #juanmw10#12 = aAlfa1;

     nRegis        = nRegis + 1;
     #juanmw10#14  = nRegis;

     |GRABA 020#juanmw10.n;
     |LIBERA #juanmw10;
|FPRC;

|PROCESO IndexaTxt;
     nRegis = 0;
     aAbre  = aPath + "logger.txt";  |QBF aAbre;
     |XABRE "U", aAbre, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |PARA; |SI; |HACIENDO;
          |XLEE nHandle, 250, aAlfa;
          |SI FSalida < 0;  |SAL;  |FINSI;
          |QBF aAlfa;

          |HAZ Indexa;
     |SIGUE;

     |XCIERRA nHandle;
|FPRC;

|PROGRAMA;
     |DFICE aPath;
     |PATH_DAT #juanmw10#aPath#;
     aFichero = "luislopez";
     |NOME_DAT #juanmw10#aFichero#;
     |ABRE #juanmw10;  |CIERRA #juanmw10;  |DELINDEX #juanmw10;

     |ABRE #juanmw10;
     |HAZ IndexaTxt;
     |CONSULTA_CLAVE #1#juanmw10;
     |CIERRA #juanmw10;

     nCarga  = 0;

     |PATH_DAT #rem00101#aPath#;
     |ABRE #rem00101;
     |BUCLE Log;
     |CIERRA #rem00101;
|FPRO;
