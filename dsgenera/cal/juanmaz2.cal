|FICHEROS;
     juanmz02 #0;
     refer@   #100;
|FIN;

|VARIABLES;
     aDef      = "";
     aFich     = "";
     aBase     = "";

     aAlfa   = "";
     aAlfa1  = "";
     nGraba    = 0;
     nCaracter = 0;
     nHandle = 0;
     nPosi   = 0;
     nNumero = 0;
     nNume   = 0;
     nLong   = 0;
     nBorrados = 0;
|FIN;

|PROCESO SacaInfo;
     |SI FSalida = 2; |ACABA; |FINSI;
     aBase = #0#0;  |QBT aBase;
     aDef  = aBase + "def/"  + #0#1 + ".mas";           |QBT aDef;
     aAlfa = aBase + "fich/";                           |QBT aAlfa;
     |LEEDEDEF aDef, aAlfa;
     |SI FSalida < 0;
        |MENAV "    Imposible determinar datos del def indicado";
        |ERROR;
     |SINO;
        aAlfa = FSalida % 3315; #0#2 = aAlfa;
     |FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;

     aBase = #0#0;  |QBT aBase;
     aFich = aBase + "fich/" + #0#1 + ".dat";           |QBT aFich;

     |XABRE "BU", aFich, nHandle;
     nLong = #0#2 + 1;
     |PARA nPosi = #0#2; |SI; |HACIENDO nPosi = nPosi + nLong;
           |XPOSICION nHandle, nPosi, 0;

           nNume     = 0;
           nCaracter = 0;
           |XLEE_NUMERO nHandle, nNume, nCaracter;
           |SI FSalida [ 0;  |SAL;  |FINSI;

           |SI nCaracter = 0;
               |XPOSICION nHandle, nPosi, 0;
               nNume     = 0;
               nCaracter = 10;
               |XGRABA_NUMERO nHandle, nNume, nCaracter;

               nBorrados = nBorrados + 1;
           |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     aDef = aBase + "/def/" + #0#1 + ".mas";  |QBT aDef;
     |CARGA_DEF aDef, refer@;
     |ABRE #100;  |CIERRA #100;
     |DESCARGA_DEF #refer@;

     aAlfa1 = "0000Registros borrados [" + nBorrados + "]";
     |MENAV aAlfa1;
|FPRC;
