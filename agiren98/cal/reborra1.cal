|FICHEROS;
   redatcon #0;
   rerendtr #1;
   recapinm #2;
   reanuali #3;
   rejerant #4;
   reliquid #5;
   retotren #6;
   retotrea #7;
   reprogra #8;
   reacceso #9;
   retotreb #10;
   retotrec #11;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &emp_actu  = 0;
   &emp_nuev  = 0;
   &que_hacer = 0;
   &nombre    = "";
   &QuePrograma = 0;

   &HContribu  = 0;
   &HRefer     = 0;
   &HNombre    = "";
   &HTipo      = "";
   &HPrograma  = "";
   &HLinea     = 0;
   &HPerceptor = "";
   &HRdto      = 0;
|FIN;

|PROCESO fich_01_1;
|SI que_hacer = 0;
    |BORRA 020#1a; |LIBERA #1;

    HContribu  = #1#0;
    HNombre    = nombre;
    HPrograma  = "(rerendtr) RENDIMIENTOS DEL TRABAJO";
    HLinea     = #1#1;
    HPerceptor = #1#3;
    HRdto      = #1#5;
    HTipo      = "BAJA FICHA";
    |HAZ AltaHistorico;
|SINO;
    #1#0 = emp_nuev;
    |GRABA 140#1n;
    |LIBERA #1;

    HContribu  = #1#0;
    HNombre    = nombre;
    HPrograma  = "(rerendtr) RENDIMIENTOS DEL TRABAJO";
    HLinea     = #1#1;
    HPerceptor = #1#3;
    HRdto      = #1#5;
    HTipo      = "MODIFICACION FICHA (CAMBIO DE CODIGO)";
    |HAZ AltaHistorico;

    #1#0 = emp_actu;
    |LIBERA #1;
    |LEE 140#1=;
|FINSI;
|FPRC;

|PROCESO fich_01_2;
|SI que_hacer = 0;
    |BORRA 020#2a; |LIBERA #2;

    HContribu  = #2#0;
    HNombre    = nombre;
    HPrograma  = "(recapinm) CAPITAL INMOBILIARIO";
    HLinea     = #2#1;
    HPerceptor = #2#3;
    HRdto      = #2#47;
    HTipo      = "BAJA FICHA";
    |HAZ AltaHistorico;
|SINO;
    #2#0 = emp_nuev;
    |GRABA 140#2n;
    |LIBERA #2;

    HContribu  = #2#0;
    HNombre    = nombre;
    HPrograma  = "(recapinm) CAPITAL INMOBILIARIO";
    HLinea     = #2#1;
    HPerceptor = #2#3;
    HRdto      = #2#47;
    HTipo      = "MODIFICACION FICHA (CAMBIO DE CODIGO)";
    |HAZ AltaHistorico;

    #2#0 = emp_actu;
    |LIBERA #2;
    |LEE 140#2=;
|FINSI;
|FPRC;

|PROCESO fich_01_3;
|SI que_hacer = 0;
    |BORRA 020#3a; |LIBERA #3;

    HContribu  = #3#0;
    HNombre    = nombre;
    HPrograma  = "(reanuali) ANUALIDADES POR ALIMENTOS";
    HLinea     = #3#1;
    HPerceptor = #3#3;
    HRdto      = #3#5;
    HTipo      = "BAJA FICHA";
    |HAZ AltaHistorico;
|SINO;
    #3#0 = emp_nuev;
    |GRABA 140#3n;
    |LIBERA #3;

    HContribu  = #3#0;
    HNombre    = nombre;
    HPrograma  = "(reanuali) ANUALIDADES POR ALIMENTOS";
    HLinea     = #3#1;
    HPerceptor = #3#3;
    HRdto      = #3#5;
    HTipo      = "MODIFICACION FICHA (CAMBIO DE CODIGO)";
    |HAZ AltaHistorico;

    #3#0 = emp_actu;
    |LIBERA #3;
    |LEE 140#3=;
|FINSI;
|FPRC;

|PROCESO fich_01_4;
|SI que_hacer = 0;
    |BORRA 020#4a; |LIBERA #4;

    HContribu  = #4#0;
    HNombre    = nombre;
    HPrograma  = "(rejerant) RENDIMIENTOS NETOS EJERCICIOS ANTERIORES";
    HLinea     = #4#1;
    HPerceptor = #4#3;
    HRdto      = #4#7;
    HTipo      = "BAJA FICHA";
    |HAZ AltaHistorico;
|SINO;
    #4#0 = emp_nuev;
    |GRABA 140#4n;
    |LIBERA #4;

    HContribu  = #4#0;
    HNombre    = nombre;
    HPrograma  = "(rejerant) RENDIMIENTOS NETOS EJERCICIOS ANTERIORES";
    HLinea     = #4#1;
    HPerceptor = #4#3;
    HRdto      = #4#7;
    HTipo      = "MODIFICACION FICHA (CAMBIO DE CODIGO)";
    |HAZ AltaHistorico;

    #4#0 = emp_actu;
    |LIBERA #4;
    |LEE 140#4=;
|FINSI;
|FPRC;

|PROCESO fich_01_6;
|SI que_hacer = 0;
    |BORRA 020#6a; |LIBERA #6;
|SINO;
    #6#0 = emp_nuev;
    |GRABA 140#6n;
    |LIBERA #6;

    #6#0 = emp_actu;
    |LIBERA #6;
    |LEE 140#6=;
|FINSI;
|FPRC;

|PROCESO fich_01_7;
|SI que_hacer = 0;
    |BORRA 020#7a; |LIBERA #7;
|SINO;
    #7#0 = emp_nuev;
    |GRABA 140#7n;
    |LIBERA #7;

    #7#0 = emp_actu;
    |LIBERA #7;
    |LEE 140#7=;
|FINSI;
|FPRC;

|PROCESO fich_01_10;
|SI que_hacer = 0;
    |BORRA 020#10a; |LIBERA #10;
|SINO;
    #10#0 = emp_nuev;
    |GRABA 140#10n;
    |LIBERA #10;

    #10#0 = emp_actu;
    |LIBERA #10;
    |LEE 140#10=;
|FINSI;
|FPRC;

|PROCESO fich_01_11;
|SI que_hacer = 0;
    |BORRA 020#11a; |LIBERA #11;
|SINO;
    #11#0 = emp_nuev;
    |GRABA 140#11n;
    |LIBERA #11;

    #11#0 = emp_actu;
    |LIBERA #11;
    |LEE 140#11=;
|FINSI;
|FPRC;

|DEFBUCLE rerendtr;
#1#1;
;
empresa, 01;
empresa, 99;
be;
NULL, fich_01_1;
|FIN;

|DEFBUCLE recapinm;
#2#1;
;
empresa, 01;
empresa, 99;
be;
NULL, fich_01_2;
|FIN;

|DEFBUCLE reanuali;
#3#1;
;
empresa, 01;
empresa, 99;
be;
NULL, fich_01_3;
|FIN;

|DEFBUCLE rejerant;
#4#1;
;
empresa, 01;
empresa, 99;
be;
NULL, fich_01_4;
|FIN;

|DEFBUCLE retotren;
#6#1;
;
empresa, " ";
empresa, "z";
be;
NULL, fich_01_6;
|FIN;

|DEFBUCLE retotrea;
#7#1;
;
empresa, " ";
empresa, "z";
be;
NULL, fich_01_7;
|FIN;

|DEFBUCLE retotreb;
#10#1;
;
empresa, " ";
empresa, "z";
be;
NULL, fich_01_10;
|FIN;

|DEFBUCLE retotrec;
#11#1;
;
empresa, " ";
empresa, "z";
be;
NULL, fich_01_11;
|FIN;

|PROGRAMA;
|SI que_hacer = 0;
    |ABRE #0;
    #0#0 = empresa;
    |LIBERA #0;
    |LEE 140#0=;
    |SI FSalida = 0;
        |BORRA 101#0a;

        HContribu  = #0#0;
        HNombre    = #0#1;
        HPrograma  = "(redatcon) DATOS DEL CONTRIBUYENTE";
        HLinea     = 0;
        HPerceptor = "TITULAR";
        HRdto      = 0;
        HTipo      = "BAJA FICHA";
        |HAZ AltaHistorico;
    |FINSI;
    |CIERRA #0;

    |ABRE #5;
    #5#0 = empresa;
    |LIBERA #5;
    |LEE 140#5=;
    |SI FSalida = 0;
        |BORRA 101#5a;

        HContribu  = #5#0;
        HNombre    = #5#1;
        HPrograma  = "(reliquid) ACCESO LIQUIDACION";
        HLinea     = 0;

        HTipo      = "BAJA CALCULO RENTA";
        |SI #5#8  ! 0; HPerceptor = "CONJUNTA";    HRdto = #5#8;  |HAZ AltaHistorico; |FINSI;
        |SI #5#9  ! 0; HPerceptor = "TITULAR";     HRdto = #5#9;  |HAZ AltaHistorico; |FINSI;
        |SI #5#10 ! 0; HPerceptor = "CONYUGE";     HRdto = #5#10; |HAZ AltaHistorico; |FINSI;
        |SI #5#11 ! 0; HPerceptor = "1§ FAMILIAR"; HRdto = #5#11; |HAZ AltaHistorico; |FINSI;
        |SI #5#12 ! 0; HPerceptor = "2§ FAMILIAR"; HRdto = #5#12; |HAZ AltaHistorico; |FINSI;
        |SI #5#13 ! 0; HPerceptor = "3§ FAMILIAR"; HRdto = #5#13; |HAZ AltaHistorico; |FINSI;
        |SI #5#14 ! 0; HPerceptor = "4§ FAMILIAR"; HRdto = #5#14; |HAZ AltaHistorico; |FINSI;

        HTipo      = "BAJA CALCULO PATRIMONIO";
        |SI #5#35 ! 0; HPerceptor = "TITULAR";     HRdto = #5#35; |HAZ AltaHistorico; |FINSI;
        |SI #5#36 ! 0; HPerceptor = "CONYUGE";     HRdto = #5#36; |HAZ AltaHistorico; |FINSI;
        |SI #5#37 ! 0; HPerceptor = "1§ FAMILIAR"; HRdto = #5#37; |HAZ AltaHistorico; |FINSI;
        |SI #5#38 ! 0; HPerceptor = "2§ FAMILIAR"; HRdto = #5#38; |HAZ AltaHistorico; |FINSI;
        |SI #5#39 ! 0; HPerceptor = "3§ FAMILIAR"; HRdto = #5#39; |HAZ AltaHistorico; |FINSI;
        |SI #5#40 ! 0; HPerceptor = "4§ FAMILIAR"; HRdto = #5#40; |HAZ AltaHistorico; |FINSI;
    |FINSI;
    |CIERRA #5;

    |ABRE #8; #8#0 = empresa; |BORRA 101#8c; |LIBERA #8; |CIERRA #8;

    |SI QuePrograma = 2;
        |ABRE #9; #9#0 = empresa; |BORRA 101#9c; |LIBERA #8; |CIERRA #9;
    |FINSI;
|SINO;
    |ABRE #0;
    #0#0 = emp_actu;
    |LIBERA #0;
    |LEE 140#0=;
    |SI FSalida = 0;
        #0#0 = emp_nuev;
        |GRABA 140#0n;

        HContribu  = #0#0;
        HNombre    = #0#1;
        HPrograma  = "(redatcon) DATOS DEL CONTRIBUYENTE";
        HLinea     = 0;
        HPerceptor = "TITULAR";
        HRdto      = 0;
        HTipo      = "MODIFICACION FICHA (CAMBIO DE CODIGO)";
        |HAZ AltaHistorico;
    |FINSI;
    |CIERRA #0;

    |ABRE #5;
    #5#0 = emp_actu;
    |LIBERA #5;
    |LEE 140#5=;
    |SI FSalida = 0;
        #5#0 = emp_nuev;
        |GRABA 140#5n;

        HContribu  = #5#0;
        HNombre    = #5#1;
        HPrograma  = "(reliquid) ACCESO LIQUIDACION";
        HLinea     = 0;

        HTipo      = "MODIFICACION CALCULO RENTA (CAMBIO DE CODIGO)";
        |SI #5#8  ! 0; HPerceptor = "CONJUNTA";    HRdto = #5#8;  |HAZ AltaHistorico; |FINSI;
        |SI #5#9  ! 0; HPerceptor = "TITULAR";     HRdto = #5#9;  |HAZ AltaHistorico; |FINSI;
        |SI #5#10 ! 0; HPerceptor = "CONYUGE";     HRdto = #5#10; |HAZ AltaHistorico; |FINSI;
        |SI #5#11 ! 0; HPerceptor = "1§ FAMILIAR"; HRdto = #5#11; |HAZ AltaHistorico; |FINSI;
        |SI #5#12 ! 0; HPerceptor = "2§ FAMILIAR"; HRdto = #5#12; |HAZ AltaHistorico; |FINSI;
        |SI #5#13 ! 0; HPerceptor = "3§ FAMILIAR"; HRdto = #5#13; |HAZ AltaHistorico; |FINSI;
        |SI #5#14 ! 0; HPerceptor = "4§ FAMILIAR"; HRdto = #5#14; |HAZ AltaHistorico; |FINSI;

        HTipo      = "MODIFICACION CALCULO PATRIMONIO (CAMBIO DE CODIGO)";
        |SI #5#35 ! 0; HPerceptor = "TITULAR";     HRdto = #5#35; |HAZ AltaHistorico; |FINSI;
        |SI #5#36 ! 0; HPerceptor = "CONYUGE";     HRdto = #5#36; |HAZ AltaHistorico; |FINSI;
        |SI #5#37 ! 0; HPerceptor = "1§ FAMILIAR"; HRdto = #5#37; |HAZ AltaHistorico; |FINSI;
        |SI #5#38 ! 0; HPerceptor = "2§ FAMILIAR"; HRdto = #5#38; |HAZ AltaHistorico; |FINSI;
        |SI #5#39 ! 0; HPerceptor = "3§ FAMILIAR"; HRdto = #5#39; |HAZ AltaHistorico; |FINSI;
        |SI #5#40 ! 0; HPerceptor = "4§ FAMILIAR"; HRdto = #5#40; |HAZ AltaHistorico; |FINSI;
    |FINSI;
    |CIERRA #5;

    |ABRE #8;
    #8#0 = emp_actu;
    |LIBERA #8;
    |LEE 140#8=;
    |SI FSalida = 0;
        #8#0 = emp_nuev;
        |GRABA 140#8n;
    |FINSI;
    |CIERRA #8;
|FINSI;

|BUCLE rerendtr;
|BUCLE recapinm;
|BUCLE reanuali;
|BUCLE rejerant;
|BUCLE retotren;
|BUCLE retotrea;
|BUCLE retotreb;
|BUCLE retotrec;

|HAZ reborra2;
|HAZ reborra3;
|HAZ reborra4;
|HAZ reborra5;
|FPRO;
