|FICHEROS;
    rey00103 #0;
    redatcon #1;    || datos contribuyentes
    rem00002 #2;    || inmuebles
    rem00004 #3;    || modelo 212
    rehacien #4;    || datos hacienda

    rew00009 #11;   || tmp.comprobacion
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &Temporal = "";
    &Cliente01 = 0;
    &Cliente02 = 0;
    &Cliente03 = 0;
    &Cliente04 = 0;
    &Cliente05 = 0;
    &Cliente06 = 0;
    &Cliente07 = 0;
    &Cliente08 = 0;
    &Cliente09 = 0;
    &Cliente10 = 0;
    &Cliente11 = 0;
    &Cliente12 = 0;
    &Cliente13 = 0;
    &Cliente14 = 0;
    &Cliente15 = 0;
    &Cliente16 = 0;
    &Cliente17 = 0;
    &Cliente18 = 0;

    &Firma = "";

    Empresa = 0;
|FIN;

|INCLUYE i_consul;
____________________________________/
|PROCESO Fichero;
|DDEFECTO #11;
    #11#0 = #3#0;
    #11#8 = 1;
|LEE 101#11=;
    FEstado = FSalida;

    #11#1 = "T";    || tipo TC1234 (siempre titular!)
    #11#2 = #3#7;   || NIF
    #11#3 = #3#9;   || nombre
    #11#6 = #3#79;  || cuota 212
    #11#11 = #3#84; || impreso S/N

|SI FEstado = 0;    |GRABA 020#11a;     |FINSI;
|SI FEstado ! 0;    |GRABA 020#11n;     |FINSI;
|LIBERA #11;
|FPRC;

|PROCESO Impresora;
|INFOR "m212h001";   |PRINT;   |PIEINF;  |FININF;
|INFOR "m212h002";   |PRINT;   |PIEINF;  |FININF;
|FPRC;

|PROCESO Modelo;

    Firma = #3#15;  |QBT Firma;
    Firma = (#3#15 - Firma) + Firma;         || ajusta a la derecha

|SI Temporal = "";
    |HAZ Impresora;
|SINO;
    |HAZ Fichero;
|FINSI;
|FPRC;

|PROCESO Emite1;
    #3#0 = #2#0;
    #3#1 = #2#1;
|LEE 101#3=;                  || lee modelo 212 (rem00004)
|SI FSalida ! 0;
    |ACABA;
|SINO;
    |SI Temporal = "";
            #3#84 = "S";           || impreso SI
        |GRABA 020#3a;
    |FINSI;
|FINSI;
|LIBERA #3;

    seleccio = 1;

|DDEFECTO #4;
    #4#0 = #1#40;
    #4#1 = #1#41;
|LEE 000#4=;        || datos hacienda

|HAZ Modelo;
|FPRC;

|DEFBUCLE Emite;
 #2#1;
 ;
 #1#0,  1;
 #1#0, 99;
 ;
 NULL, Emite1;
|FIN;

|PROCESO Tipo3;
|ABRE #1;       || datos contribuyentes
|ABRE #3;       || modelo 212
|ABRE #4;       || datos hacienda
|PARA Empresa = 0; |SI Empresa [ 17; |HACIENDO Empresa = Empresa + 1;
    |SI #0Empresa ! 0;
            #1#0 = #0Empresa;
        |LEE 000#1=;
        |SI FSalida = 0;|Y #1#4 = "N";
            |BUCLE Emite;
        |FINSI;
    |FINSI;
|SIGUE;
|SI seleccio = 0;|Y Temporal = "";
    |MENAV "    Seleccion vacia ...";
|FINSI;
|CIERRA #1;
|CIERRA #3;
|CIERRA #4;
|FPRC;

|PROGRAMA;
|SI Temporal = "";
    |CLS;
    |CABEZA "Impresion 212";
    |PINPA #0#0;
    |DDEFECTO #0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |IMPRE 0;
        |SI FSalida = 0;
            |HAZ Tipo3;
        |SINO;
            |MENAV "    Proceso abortado ...";
        |FINSI;
        |FINIMP;
    |FINSI;
|SINO;
        #0#0 = Cliente01;     #0#1 = Cliente02;   #0#2 = Cliente03;
        #0#3 = Cliente04;     #0#4 = Cliente05;   #0#5 = Cliente06;
        #0#6 = Cliente07;     #0#7 = Cliente08;   #0#8 = Cliente09;
        #0#9 = Cliente10;     #0#10 = Cliente11;  #0#11 = Cliente12;
        #0#12 = Cliente13;    #0#13 = Cliente14;  #0#14 = Cliente15;
        #0#15 = Cliente16;    #0#16 = Cliente17;  #0#17 = Cliente18;
    |NOME_DAT #11 Temporal;
    |ABRE #11;
    |HAZ Tipo3;
    |CIERRA #11;
|FINSI;
|FPRO;
