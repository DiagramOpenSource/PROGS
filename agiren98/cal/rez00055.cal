|FICHEROS;
     rez00055 #0;
     reactafe #1;
     recapinm #2;
     rectacor #3;
     rem00014 #4;
     rem00012 #5;
     reempmod #6;
     rem00013 #7;
     rem00002 #8;
     rem00010 #9;
     rem00011 #10;
     revalono #11;
     revalore #12;
     redatcon #13;
     repatrim #99;
|FIN;

|VARIABLES;
     Hectarea1 = 0;
     Hectarea2 = 0;
     Descri    = "";
     Valor   = 0;
     Valor1  = 0;
     Valor2  = 0;
     Valor3  = 0;
     CodPat1 = 0;
     CodPat2 = "";
     CodPat3 = 0;
     SwPrint = 0;
     Linea   = 0;
     Programa = "";

     &Mpresora = "";
     &Variable = "";
|FIN;

|PROCESO Imprime;
      |SI CodPat2 = "A1"; Variable = "A1"; |FINSI;
      |SI CodPat2 = "B1"; Variable = "B1"; |FINSI;
      |SI CodPat2 = "C1"; Variable = "C1"; |FINSI;
      |SI CodPat2 = "C2"; Variable = "C2"; |FINSI;
      |SI CodPat2 = "C3"; Variable = "D1"; |FINSI;
      |SI CodPat2 = "D1"; Variable = "E1"; |FINSI;
      |SI CodPat2 = "E1"; Variable = "F1"; |FINSI;
      |SI CodPat2 = "E2"; Variable = "F2"; |FINSI;
      |SI CodPat2 = "F1"; Variable = "G1"; |FINSI;
      |SI CodPat2 = "F2"; Variable = "G2"; |FINSI;
      |SI CodPat2 = "F3"; Variable = "G3"; |FINSI;
      |SI CodPat2 = "F4"; Variable = "G4"; |FINSI;
      |SI CodPat2 = "F5"; Variable = "H1"; |FINSI;
      |SI CodPat2 = "F6"; Variable = "H2"; |FINSI;
      |SI CodPat2 = "G1"; Variable = "I1"; |FINSI;
      |SI CodPat2 = "H1"; Variable = "J1"; |FINSI;
      |SI CodPat2 = "I1"; Variable = "K1"; |FINSI;
      |SI CodPat2 = "J1"; Variable = "L1"; |FINSI;
      |SI CodPat2 = "K1"; Variable = "M1"; |FINSI;
      |SI CodPat2 = "L1"; Variable = "N1"; |FINSI;
      |SI CodPat2 = "M1"; Variable = "O1"; |FINSI;
      |SI CodPat2 = "N1"; Variable = "P1"; |FINSI;
      |SI CodPat2 = "O1"; Variable = "Q1"; |FINSI;
      |SI CodPat2 = "U1"; Variable = "U1"; |FINSI;
      |SI CodPat2 = "V1"; Variable = "V1"; |FINSI;
      |SI CodPat2 = "V2"; Variable = "V2"; |FINSI;
      |SI CodPat2 = "V3"; Variable = "V3"; |FINSI;
      |SI CodPat2 = "V4"; Variable = "V4"; |FINSI;

      Variable = Variable + "  LINEA  " + CodPat3 + "   Valor : " + (("            " + Valor) % -112) + "  " + Programa + Linea;
      |PRINT;
      SwPrint = 1;
|FPRC;

|PROCESO LeePatrim;
  #99#0 = CodPat1;
  #99#1 = CodPat2;
  #99#2 = CodPat3;
  |LEE 040#99=;
  |SI FSalida ! 0;
      |HAZ Imprime;
      |ACABA;
  |FINSI;

  |SI #99#5 ! Descri;  |Y #99#9 ! Valor; |Y #99#1 ! "B1";
      |HAZ Imprime;
      |ACABA;
  |FINSI;

  |SI #99#1 = "B1";  |Y #99#9 ! Valor;  |Y Hectarea1 ! #99#11;  |Y Hectarea2 ! #99#12;
      |HAZ Imprime;
  |FINSI;
|FPRC;

|PROCESO Lee01;
  |SI #1#37 = "R";  |O  #1#37 = "X";
      |ACABA;
  |FINSI;

  Valor = 0;
  |SI #1#44 = "N";
      Valor = #1#9;
      |SI Valor < #1#10;  Valor = #1#10; |FINSI;
      |SI Valor < #1#11;  Valor = #1#11; |FINSI;
  |SINO;
      |SI #1#12 ! "01.01.1900";
          Valor = #1#9;
          |SI Valor < #1#10;  Valor = #1#10; |FINSI;
          |SI Valor < #1#11;  Valor = #1#11; |FINSI;
      |FINSI;
  |FINSI;

  |SI Valor = 0; |ACABA; |FINSI;

  |SI #1#53 ! "  ";  |Y #1#54 ! 0;
      Linea   = #1#1;
      CodPat1 = #1#0;
      CodPat2 = #1#53;
      CodPat3 = #1#54;
      Descri  = #1#48 % 128;
      |HAZ LeePatrim;
  |FINSI;

  |SI #1#56 ! "  ";  |Y #1#57 ! 0;
      Linea   = #1#1;
      CodPat1 = #1#0;
      CodPat2 = #1#56;
      CodPat3 = #1#57;
      Descri  = #1#48 % 128;
      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE reactafe;
  #1#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee01;
|FIN;

|PROCESO Lee02;
  |SI #2#48 = "R";  |O  #2#48 = "X";
      |ACABA;
  |FINSI;

  Valor = #2#8;
  |SI Valor < #2#17;  Valor = #2#17; |FINSI;
  |SI Valor < #2#19;  Valor = #2#19; |FINSI;

  |SI Valor = 0; |ACABA; |FINSI;

  |SI #2#73 ! "  ";  |Y #2#74 ! 0;
      Linea   = #2#1;
      CodPat1 = #2#0;
      CodPat2 = #2#73;
      CodPat3 = #2#74;
      |SI CodPat2 = "A1";
          Descri = #2#5 % 128;
      |SINO;
          Hectarea1 = #2#11;
          Hectarea2 = #2#12;
      |FINSI;

      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE recapinm;
  #2#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee02;
|FIN;

|PROCESO Lee3;
  |SI #3#4 = "R";  |O  #3#4 = "X";
      |ACABA;
  |FINSI;

  |SI #3#29 = "J1";
      |SI #3#13 ! "RV"; |Y #3#13 ! "RT"; |ACABA; |FINSI;
  |FINSI;

  Valor = #3#19;
  |SI Valor < #3#20;  Valor = #3#20; |FINSI;

  |SI Valor = 0; |ACABA; |FINSI;

  |SI #3#29 ! "  ";  |Y #3#30 ! 0;
      Linea   = #3#1;
      CodPat1 = #3#0;
      |SI #3#29 = "E1";   CodPat2 = "D1";     |FINSI;
      |SI #3#29 = "F1";   CodPat2 = "E1";     |FINSI;
      |SI #3#29 = "F2";   CodPat2 = "E2";     |FINSI;
      |SI #3#29 = "G1";   CodPat2 = "F1";     |FINSI;
      |SI #3#29 = "G2";   CodPat2 = "F2";     |FINSI;
      |SI #3#29 = "G3";   CodPat2 = "F3";     |FINSI;
      |SI #3#29 = "G4";   CodPat2 = "F4";     |FINSI;
      |SI #3#29 = "H1";   CodPat2 = "F5";     |FINSI;
      |SI #3#29 = "H2";   CodPat2 = "F6";     |FINSI;
      CodPat3 = #3#30;
      Descri  = #3#14 % 128;
      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE rectacor;
  #3#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee3;
|FIN;

|PROCESO Lee4;
  |SI #4#4 = "R";  |O  #4#4 = "X";
      |ACABA;
  |FINSI;

  |SI #4#16 = 0; |ACABA; |FINSI;

  |SI #4#42 ! "  ";  |Y #4#43 ! 0;
      Linea   = #4#1;
      CodPat1 = #4#0;
      CodPat2 = #4#42;
      CodPat3 = #4#43;
      Descri  = #4#15 % 128;
      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE rem00014;
  #4#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee4;
|FIN;

|PROCESO Lee5;
     |SI #5#4 = "R";  |O  #5#4 = "X";
         |ACABA;
     |FINSI;

     |SI #5#18 = 0; |ACABA; |FINSI;

     |SI #5#46 ! "  ";  |Y #5#47 ! 0;
         Linea   = #5#1;
         CodPat1 = #5#0;
         CodPat2 = #5#46;
         CodPat3 = #5#47;
         Descri  = #5#15 % 128;
         |HAZ LeePatrim;
     |FINSI;
|FPRC;

|DEFBUCLE rem00012;
     #5#1;
     ;
     #13#0, 00;
     #13#0, 99;
     ;
     NULL, Lee5;
|FIN;

|PROCESO Lee6;
     |SI #6#4 = "R";  |O  #6#4 = "X";
         |ACABA;
     |FINSI;

     |SI #6#12 = 0; |ACABA; |FINSI;

     |SI #6#131 ! "  ";  |Y #6#132 ! 0;
         Linea   = #6#1;
         CodPat1 = #6#0;
         CodPat2 = #6#131;
         CodPat3 = #6#132;
         Descri  = #6#15 % 128;
         |HAZ LeePatrim;
     |FINSI;
|FPRC;

|DEFBUCLE reempmod;
  #6#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee6;
|FIN;

|PROCESO Lee7;
     |SI #7#4 = "R";  |O  #7#4 = "X";
         |ACABA;
     |FINSI;

     |SI #7#18 = 0; |ACABA; |FINSI;

     |SI #7#47 ! "  ";  |Y #7#48 ! 0;
         Linea   = #7#1;
         CodPat1 = #7#0;
         CodPat2 = #7#47;
         CodPat3 = #7#48;
         Descri  = #7#15 % 128;
         |HAZ LeePatrim;
     |FINSI;
|FPRC;

|DEFBUCLE rem00013;
     #7#1;
     ;
     #13#0, 00;
     #13#0, 99;
     ;
     NULL, Lee7;
|FIN;

|PROCESO Lee9;
     |SI #9#4 = "R";  |O  #9#4 = "X";
         |ACABA;
     |FINSI;

     |SI #9#18 = 0; |ACABA; |FINSI;

     |SI #9#35 ! "  ";  |Y #9#36 ! 0;
         Linea   = #9#1;
         CodPat1 = #9#0;
         CodPat2 = #9#35;
         CodPat3 = #9#36;
         Descri  = #9#15 % 128;
         |HAZ LeePatrim;
     |FINSI;
|FPRC;

|DEFBUCLE rem00010;
     #9#1;
     ;
     #13#0, 00;
     #13#0, 99;
     ;
     NULL, Lee9;
|FIN;

|PROCESO Lee10;
     |SI #10#4 = "R";  |O  #10#4 = "X";
         |ACABA;
     |FINSI;

     |SI #10#18 = 0; |ACABA; |FINSI;

     |SI #10#38 ! "  ";  |Y #10#39 ! 0;
         Linea   = #10#1;
         CodPat1 = #10#0;
         CodPat2 = #10#38;
         CodPat3 = #10#39;
         Descri  = #10#15 % 128;
         |HAZ LeePatrim;
     |FINSI;
|FPRC;

|DEFBUCLE rem00011;
     #10#1;
     ;
     #13#0, 00;
     #13#0, 99;
     ;
     NULL, Lee10;
|FIN;

|PROCESO Lee11;
  |SI #11#4 = "R";  |O  #11#4 = "X";
      |ACABA;
  |FINSI;

  |SI #11#43 ! 0;
      Valor = #11#43;
  |SINO;
     |SI #11#30 = "S";
         Valor = #11#32 * (#11#16 - #11#25 - #11#26);
     |SINO;
        Valor1 = #11#46 * (#11#16 - #11#25 - #11#26);
        Valor2 = #11#31 * (#11#16 - #11#25 - #11#26);
        Valor3 = #11#32 * (#11#16 - #11#25 - #11#26);
        Valor  = Valor1;
        |SI Valor < Valor2; Valor = Valor2; |FINSI;
        |SI Valor < Valor3; Valor = Valor3; |FINSI;
     |FINSI;

     |SI #11#29 = "F";
         Valor = (#11#17 * #11#16) - #11#35 - #11#36;
     |FINSI;
  |FINSI;

  |SI Valor = 0; |ACABA; |FINSI;

  |SI #11#45 ! "  ";  |Y #11#47 ! 0;
      Linea   = #11#1;
      CodPat1 = #11#0;
      |SI #11#45 = "E1";   CodPat2 = "D1";     |FINSI;
      |SI #11#45 = "F1";   CodPat2 = "E1";     |FINSI;
      |SI #11#45 = "F2";   CodPat2 = "E2";     |FINSI;
      |SI #11#45 = "G1";   CodPat2 = "F1";     |FINSI;
      |SI #11#45 = "G2";   CodPat2 = "F2";     |FINSI;
      |SI #11#45 = "G3";   CodPat2 = "F3";     |FINSI;
      |SI #11#45 = "G4";   CodPat2 = "F4";     |FINSI;
      |SI #11#45 = "H1";   CodPat2 = "F5";     |FINSI;
      |SI #11#45 = "H2";   CodPat2 = "F6";     |FINSI;
      CodPat3    = #11#47;
      Descri     = #11#14 % 128;
      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE revalono;
  #11#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee11;
|FIN;

|PROCESO Lee12;
  |SI #12#4 = "R";  |O  #12#4 = "X";
      |ACABA;
  |FINSI;

  |SI #12#41 ! 0;
      Valor = #12#41;
  |SINO;
      Valor = #12#19 * (#12#16 - #12#27 - #12#28 - #12#29);
  |FINSI;

  |SI Valor = 0; |ACABA; |FINSI;

  |SI #12#43 ! "  ";  |Y #12#44 ! 0;
      Linea   = #12#1;
      CodPat1 = #12#0;
      |SI #12#43 = "E1";   CodPat2 = "D1";     |FINSI;
      |SI #12#43 = "F1";   CodPat2 = "E1";     |FINSI;
      |SI #12#43 = "F2";   CodPat2 = "E2";     |FINSI;
      |SI #12#43 = "G1";   CodPat2 = "F1";     |FINSI;
      |SI #12#43 = "G2";   CodPat2 = "F2";     |FINSI;
      |SI #12#43 = "G3";   CodPat2 = "F3";     |FINSI;
      |SI #12#43 = "G4";   CodPat2 = "F4";     |FINSI;
      |SI #12#43 = "H1";   CodPat2 = "F5";     |FINSI;
      |SI #12#43 = "H2";   CodPat2 = "F6";     |FINSI;
      CodPat3 = #12#44;
      Descri  = #12#14 % 128;
      |HAZ LeePatrim;
  |FINSI;
|FPRC;

|DEFBUCLE revalore;
  #12#1;
  ;
  #13#0, 00;
  #13#0, 99;
  ;
  NULL, Lee12;
|FIN;

|PROCESO Reparte;
  Hectarea1 = 0;  Hectarea2 = 0;
  Programa = "Act.Afectos  Linea : ";  |BUCLE reactafe;
  Programa = "Cap.Inmobil. Linea : ";  |BUCLE recapinm;

  Hectarea1 = 0;  Hectarea2 = 0;
  Programa = "Ctas.Ctes.   Linea : ";  |BUCLE rectacor;
  Programa = "Agricolas    Linea : ";  |BUCLE rem00014;
  Programa = "Emp.Normal   Linea : ";  |BUCLE rem00012;
  Programa = "Modulos      Linea : ";  |BUCLE reempmod;
  Programa = "Emp.Simplif. Linea : ";  |BUCLE rem00013;
  Programa = "Prof.Normal  Linea : ";  |BUCLE rem00010;
  Programa = "Prof.Simpli. Linea : ";  |BUCLE rem00011;
  Programa = "Val.no bolsa Linea : ";  |BUCLE revalono;
  Programa = "Val.bolsa    Linea : ";  |BUCLE revalore;
|FPRC;

|DEFBUCLE redatcon;
  #13#1;
  ;
  00000;
  99999;
  ;
  NULL, Reparte;
|FIN;

|PROGRAMA;
  |CLS;
  |CABEZA "Incidencias Patrimonio";
  |PINPA #0#0;

  Impresora = Mpresora;
  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;

  |INFOR "rez00053";
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

  |ABRE #99;
  |BUCLE redatcon;
  |CIERRA #99;

  |SI SwPrint = 1;  |PIEINF;  |FINSI;

  |FININF;
  |FINIMP;
|FPRO;
