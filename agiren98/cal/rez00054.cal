|FICHEROS;
     rez00054 #0;
     recapinm #1;
     redatcon #2;
     repoblac #6;
     rerenpre #7;
     retabla3 #9;

     reparame #14;
     retotpat #10;

     rem00002 #4;
     rem00003 #900;
     rem00005 #904;
|FIN;

|VARIABLES;
     Tecla   = 0;
     SwHay   = 0;
     Fichero = "";
     FInicio = @;
     Valfa   = "";
     Campo1  = 0;
     Campo2  = 0;
     Campo3  = 0;
|FIN;

|PROCESO CreaTemporal;
  #0#0 = #1#0;
  #0#1 = #1#1;
  #0#2 = #2#1;

  #4#0 = #1#0;
  #4#1 = #1#1;
  |LEE 040#4=;
  |SI FSalida = 0;
      #0#3 = "SI";
      #0#4 = "210";
      #0#5 = "A";
      #0#6 = "N";

      #900#0 = #0#0;
      #900#1 = #0#1;
      |LEE 040#900=;
      |SI FSalida = 0;
          #0#4 = "210";
          |SI #900#95  = "X";  #0#5 = "A";  |FINSI;
          |SI #900#99  = "X";  |ACABA;      |FINSI;
          |SI #900#104 = "X";  |ACABA;      |FINSI;
      |FINSI;

      #904#0 = #0#0;
      #904#1 = #0#1;
      |LEE 040#904=;
      |SI FSalida = 0;
          #0#4 = "214";
          #0#5 = " ";
      |FINSI;
  |SINO;
      #0#3 = "NO";
      #0#4 = "210";
      #0#5 = "A";
      #0#6 = "S";
  |FINSI;

  |GRABA 140#0n;

  SwHay = 1;
|FPRC;

|DEFBUCLE recapinm;
  #1#1;
  13, 31;
  #2#0, 00, "H", "N";
  #2#0, 99, "H", "N";
  ;
  NULL, CreaTemporal;
|FIN;

|PROCESO LeeInmueble;
  |BUCLE recapinm;
|FPRC;

|DEFBUCLE redatcon;
  #2#1;
  4;
  00000, "N";
  99999, "N";
  ;
  NULL, LeeInmueble;
|FIN;

|PROCESO Modelo210A;
  #900#0 = #0#0;
  #900#1 = #0#1;
  |LIBERA #900;
  |LEE 140#900=;
  |SI FSalida ! 0;
      |GRABA 140#900b;
  |FINSI;
  |DDEFECTO #900;

  #900#0  = #0#0;
  #900#1  = #0#1;
  #900#2  = "X";
  #900#3  = ~;
  #900#4  = "X";
  #900#5  = "X";
  #900#9  = 100;
  #900#14 = "R";

  #900#15 = #2#2;
  #900#16 = #2#192;
  #900#17 = #2#1;
  #900#18 = #2#6;
  #900#19 = #2#7;
  #900#20 = #2#8;
  #900#21 = #2#9;
  #900#22 = #2#10;
  #900#23 = #2#11;
  #900#24 = #2#15;
  #900#25 = #2#12;
  #900#26 = #2#13;
  #900#27 = #2#14;

  #6#0 = #900#25;
  #6#1 = #900#26;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  #900#28 = #6#2;
  #900#29 = #900#15;
  #900#30 = #900#16;
  #900#31 = #900#17;
  #900#33 = #2#148;
  #900#34 = #2#193;
  #900#35 = #2#7;
  #900#36 = #2#14;

  #900#37 = #2#46;
  #900#38 = "F";
  #900#39 = #2#45;
  #900#41 = #7#3;
  #900#42 = #7#4;
  #900#46 = #7#9;
  #900#47 = #7#5;
  #900#48 = #7#6;
  #900#49 = #7#7;
  #900#50 = #7#8;

  #900#95  = "X";
  #900#96  = "02";
  #900#97  = #1#72;
  #900#98  = #1#47;
  #900#113 = 25;
  #900#114 = (#900#98 * #900#113) / 100;
  #900#117 = #900#114;

  |GRABA 140#900a;
  |LIBERA #900;
|FPRC;

|PROCESO Patri214;
  |ABRE #9;
  |LEE 040#9p;
  |SI FSalida ! 0;  |DDEFECTO #9;  |FINSI;
  |CIERRA #9;

  |SI #14#15 = "S";
      |ABRE #10;
      |SI #1#2 = "G";
          #10#0  = #0#0;
          #10#28 = "T";
          |LEE 040#10=;
          |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;

          #904#20 = #10#18;
          #904#21 = #10#19;

          #10#0  = #0#0;
          #10#28 = "C";
          |LEE 040#10=;
          |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;

          #904#59 = #10#18;
          #904#60 = #10#19;
          #904#61 = 1;
      |SINO;
          #10#0  = #0#0;
          #10#28 = #1#2;
          |LEE 040#10=;
          |SI FSalida ! 0;  |DDEFECTO #10;  |FINSI;
          |CIERRA #10;

          #904#20 = #10#18;
          #904#21 = #10#19;
          #904#61 = 0;
      |FINSI;
  |SINO;
      #904#20 = #1#8;
      |SI #904#20 < #1#17;  #904#20 = #1#17; |FINSI;
      |SI #904#20 < #1#19;  #904#20 = #1#19; |FINSI;
      |SI #904#20 = 0; |ACABA; |FINSI;
      #904#21 = #1#10 + #1#14 + #1#20;
  |FINSI;

  #904#22 = #904#20 - #904#21;
  |PARA Campo1 = 8;  |SI Campo1 ] 1; |HACIENDO  Campo1 = Campo1 - 1;
        Campo2 = Campo1 + 8;
        Campo3 = Campo1 + 16;
        |SI #904#22 > #9Campo1;
            #904#23 = #9Campo1;
            #904#25 = #9Campo2;
            #904#27 = #9Campo3;
            #904#24 = #904#22 - #904#23;
            #904#26 = #904#24 % #904#27;
            #904#28 = #904#25 + #904#26;
            |SAL;
        |FINSI;
  |SIGUE;
|FPRC;

|PROCESO Renta214;
  Valfa   = "01.01." + #904#2;
  FInicio = Valfa;
  |SI FInicio < #1#18;
      #904#29 = ((365 - (#1#18 - FInicio)) * #1#8) / 365;
  |SINO;
      #904#29 = #1#8;
  |FINSI;

  |SI #1#71 = "N";
      #904#29 = #904#29 % 2;
  |SINO;
      #904#29 = #904#29 % 1.1;
  |FINSI;

  #904#30 = 25;
  #904#31 = #904#29 % 25;
|FPRC;

|PROCESO Modelo214;
  #904#0 = #0#0;
  #904#1 = #0#1;
  |LIBERA #904;
  |LEE 140#904=;
  |SI FSalida ! 0;
      |GRABA 140#904b;
  |FINSI;
  |DDEFECTO #904;

  #904#0  = #0#0;
  #904#1  = #0#1;
  #904#3  = "X";
  #904#4  = "X";
  #904#5  = "X";

  #904#6  = #2#2;
  #904#7  = #2#1;
  #904#9  = #2#6;
  #904#10 = #2#7;
  #904#11 = #2#8;
  #904#12 = #2#9;
  #904#13 = #2#10;
  #904#14 = #2#11;
  #904#15 = #2#15;
  #904#16 = #2#12;
  #904#17 = #2#13;
  #904#18 = #2#14;

  #6#0 = #904#16;
  #6#1 = #904#17;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;

  #904#19 = #6#2;

  |SI #4#2 = "A";  |O #4#2 = "R";  |HAZ Renta214;  |FINSI;
  |SI #4#2 = "A";  |O #4#2 = "P";  |HAZ Patri214;  |FINSI;

  #904#32 = #904#28 + #904#31;
  #904#34 = #1#5;
  #904#40 = #1#6;
  #904#41 = #1#7;

  #6#0    = #904#40;
  #6#1    = #904#41;
  |LEE 040#6=;
  |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
  #904#42 = #6#3;
  #904#43 = #6#2;
  #904#44 = #1#72;

  #904#45 = #2#46;
  #904#46 = #2#45;
  #904#48 = #7#3;
  #904#49 = #7#4;
  #904#53 = #7#9;
  #904#54 = #7#5;
  #904#55 = #7#6;
  #904#56 = #7#7;
  #904#57 = #7#8;

  |GRABA 140#904a;
  |LIBERA #904;
|FPRC;

|PROCESO GrabaModelo;
  #1#0 = #0#0;
  #1#1 = #0#1;
  |LEE 040#1=;
  |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

  #2#0 = #0#0;
  |LEE 040#2=;
  |SI FSalida ! 0;  |DDEFECTO #2;  |FINSI;

  #7#0 = #2#44;
  |LEE 040#7=;
  |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;

  #4#0 = #0#0;
  #4#1 = #0#1;
  |LEE 040#4=;
  |SI FSalida ! 0;
      |DDEFECTO #4;
      #4#0 = #0#0;
      #4#1 = #0#1;
      |GRABA 020#4b;
  |FINSI;

  #4#2  = #1#48;
  #4#3  = #1#2;
  #4#4  = #1#3;
  #4#5  = #1#5;
  #4#6  = "S";
  #4#7  = "VIVIENDA";
  #4#8  = #1#49;
  #4#9  = #1#50;
  #4#10 = #1#51;
  #4#11 = #1#52;
  #4#12 = #1#53;
  #4#13 = #1#54;
  |GRABA 020#4a;
  |LIBERA #4;

  |SI #0#4 = "210";  |HAZ Modelo210A;  |FINSI;
  |SI #0#4 = "214";  |HAZ Modelo214;   |FINSI;
|FPRC;

|DEFBUCLE rez00054;
  #0#1;
  6;
      0,  0, "S";
  99999, 99, "S";
  ;
  NULL, GrabaModelo;
|FIN;

|RUTINA ClaveBaja;
  #0#0 = 0;
  #0#1 = 0;
|FRUT;

|RUTINA ClaveAlta;
  #0#0 = 99999;
  #0#1 = 99;
|FRUT;

|PROGRAMA;
  Fichero = ("54" + Usuario + "zzzzzzzz") % 108;
  |NOME_DAT #0 Fichero;
  |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

  |ABRE #0;
  |ABRE #4;
  |ABRE #900;
  |ABRE #904;
  |BUCLE redatcon;
  |CIERRA #0;
  |CIERRA #4;
  |CIERRA #900;
  |CIERRA #904;

  |SI SwHay = 0;
      |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
      |ACABA;
  |FINSI;

  |CLS;
  |CABEZA "Pase Extranjeros";
  |ENTLINEAL #1#0, 2, 4, 20, 1, ClaveBaja, ClaveAlta;

  |ABRE #14;
  |LEE 040#14p;
  |SI FSalida ! 0;  |DDEFECTO #14;  |FINSI;
  |CIERRA #14;

  |ABRE #1;
  |ABRE #2;
  |ABRE #4;
  |ABRE #6;
  |ABRE #7;
  |ABRE #900;
  |ABRE #904;

  |BUCLE rez00054;

  |CIERRA #1;
  |CIERRA #2;
  |CIERRA #4;
  |CIERRA #6;
  |CIERRA #7;
  |CIERRA #900;
  |CIERRA #904;

  |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
|FPRO;


|PROCESO Tipo11;  |TIPO 11;
  Tecla = FSalida;

  |SI Tecla > 14;  |ACABA;  |FINSI;
  |SI Tecla < 9;   |ACABA;  |FINSI;

  |LIBERA #0;
  |LEE 140#0=;

  |SI Tecla = 9;
      #0#4 = "210";  |PINTA #0#4;
      #0#5 = "A";    |PINTA #0#5;
      #0#6 = "S";    |PINTA #0#6;
  |FINSI;

  |SI Tecla = 10;
      #0#4 = "214";  |PINTA #0#4;
      #0#5 = " ";    |PINTA #0#5;
      #0#6 = "S";    |PINTA #0#6;
  |FINSI;

  |SI Tecla = 11;
      |SI #0#6 = "S";
          #0#6 = "N";
      |SINO;
          #0#6 = "S";
      |FINSI;
      |PINTA #0#6;
  |FINSI;

  |GRABA 140#0a;

  |ERROR;
|FPRC;
