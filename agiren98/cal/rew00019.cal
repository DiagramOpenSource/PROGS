|FICHEROS;
     retotren #5;
     retotrea #6;
     retotrec #85;
     reincire #30;
     reincpen #31;
     rew00001 #99;
     rew00019 #610;
|FIN;

|VARIABLES;
      FechaN      = 0;
      XCampos     = 0;
      NSecuencial = "";
      Field       = "";
      Casilla     = 0;
      Perce       = "";
      PerceC      = "";
      Descri1     = "";
      Descri2     = "";
      Conta       = 0;
      Conta1      = 0;
      Conta2      = 0;
      Conta3      = 0;
      Conta4      = 0;
      Coefi       = 0;
      Resto       = 0;
      ContaAct1   = 0;
      ContaAct    = 0;
      Periodo     = 0;
      Error       = 0;
      aTipo       = "";
      aDeclarante = "";

     &Tippar      = 0;
     &Parte1      = 0;
     &Parte2      = 0;
     &Muerto      = "";
     &Fecpar      = @;
     &VEmpresa   = 0;
     &VTipo      = "";
     &NCopia     = 0;
     &VSwCarga   = 0;
     &VTemporal0 = "";
     &VTemporal10 = "";

{200}&NEmpresas  = "";
|FIN;

|INCLUYE i_utilid;

|PROCESO Muerto;
  Error = 0;
  |SI #5#213 = 1;
      |SI Periodo = 0; Coefi = 100 * Parte2; |FINSI;
      |SI Periodo = 1; Error = 1;            |FINSI;
      |SI Periodo = 2; Coefi = 100;          |FINSI;
      |ACABA;
  |FINSI;
  Coefi = 100;
|FPRC;

|PROCESO CargaG3;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 5;    |FINSI;
  |SI Resto = 2;  Casilla = 18;   |FINSI;
  |SI Resto = 0;  Casilla = 31;   |FINSI;

  #610#0 = ContaAct1;
  |LIBERA #610;
  |LEE 140#610=;
  |SI FSalida ! 0;
      |DDEFECTO #610;
      #610#0 = ContaAct1;
      |GRABA 140#610b;
  |FINSI;

                          #610Casilla = #30#13 % 112;
  Casilla = Casilla + 1;  #610Casilla = #30#13 % 1312;
  Casilla = Casilla + 1;  #610Casilla = Perce;
  Casilla = Casilla + 1;  #610Casilla = #30#28;
  Casilla = Casilla + 1;  #610Casilla = #30#29;
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#14 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#31 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#17 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#25 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#16 % Coefi);

  CantiNum = #30#18 ! 0;
  Valfa1   = ("00" + CantiNum)  % -102;

  Casilla = Casilla + 1;  #610Casilla = Valfa1;
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#20 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#24 % Coefi);

  |GRABA 140#610a;
|FPRC;

|PROCESO IrregularG3N;
  |SI #30#4 = "X"; |O #30#4 = "P"; |ACABA; |FINSI;

  FechaN = #30#29 - #30#28;
  |SI FechaN [ 731;  |ACABA;  |FINSI;
  |SI #30#26 ! "3";  |ACABA;  |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #30#2 = "T"; Perce = "2"; |FINSI;
     |SI #30#2 = "C"; Perce = "3"; |FINSI;
     |SI #30#2 = "G"; Perce = "1"; |FINSI;
     |SI #30#2 = "1"; Perce = "4"; |FINSI;
     |SI #30#2 = "2"; Perce = "5"; |FINSI;
     |SI #30#2 = "3"; Perce = "6"; |FINSI;
     |SI #30#2 = "4"; Perce = "7"; |FINSI;
     |SI #30#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #30#2 = "V";
          Coefi = #30#7 + #30#8 + #30#9 + #30#10 + #30#11 + #30#12;
          |HAZ CargaG3;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaG3;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #30#2 = "G"; Coefi = 50;    |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "T"; Coefi = 100;   |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#7; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #30#2 = "G"; Coefi = 50;    |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "C"; Coefi = 100;   |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#8; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #30#2 = "1"; Coefi = 100;   |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#9; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #30#2 = "2"; Coefi = 100;    |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#10; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #30#2 = "3"; Coefi = 100;    |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#11; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #30#2 = "4"; Coefi = 100;    |HAZ CargaG3; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#12; |HAZ CargaG3; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO IrregularG3P;
  |SI #30#4 = "X"; |O #30#4 = "P"; |ACABA; |FINSI;

  FechaN = #30#29 - #30#28;
  |SI FechaN [ 731;  |ACABA;  |FINSI;
  |SI #30#26 ! "3";  |ACABA;  |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #30#2 = "T"; Perce = "2"; |FINSI;
     |SI #30#2 = "C"; Perce = "3"; |FINSI;
     |SI #30#2 = "G"; Perce = "1"; |FINSI;
     |SI #30#2 = "1"; Perce = "4"; |FINSI;
     |SI #30#2 = "2"; Perce = "5"; |FINSI;
     |SI #30#2 = "3"; Perce = "6"; |FINSI;
     |SI #30#2 = "4"; Perce = "7"; |FINSI;
     |SI #30#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #30#2 = "V";
          |SI Tippar = 1;
              |SI #30#27 = 0;  Coefi = #30#7 + #30#8;            |FINSI;
              |SI #30#27 = 1;  |ACABA;                         |FINSI;
              |SI #30#27 = 2;  Coefi = #30#7 + #30#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #30#27 = 0;  Coefi = #30#7 + #30#8;            |FINSI;
              |SI #30#27 = 2;  |ACABA;                         |FINSI;
              |SI #30#27 = 1;  Coefi = #30#7 + #30#8;            |FINSI;
          |FINSI;
          |HAZ CargaG3;
          |ACABA;
      |FINSI;
      |SI #30#2 = "G";
          |SI Tippar = 1;
              |SI #30#27 = 0;  Coefi = 50;           |FINSI;
              |SI #30#27 = 1;  |ACABA;               |FINSI;
              |SI #30#27 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #30#27 = 0;  Coefi = 50;           |FINSI;
              |SI #30#27 = 2;  |ACABA;               |FINSI;
              |SI #30#27 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaG3;
          |ACABA;
      |FINSI;
      |SI Tippar = 1;
          |SI #30#27 = 0;  Coefi = 100;          |FINSI;
          |SI #30#27 = 1;  |ACABA;               |FINSI;
          |SI #30#27 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #30#27 = 0;  Coefi = 100;          |FINSI;
          |SI #30#27 = 2;  |ACABA;               |FINSI;
          |SI #30#27 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaG3;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #30#2 = "G";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; Coefi = 50;          |FINSI;
             |SI #30#27 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; Coefi = 50;          |FINSI;
                 |SI #30#27 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; |ACABA;              |FINSI;
                 |SI #30#27 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; |ACABA;              |FINSI;
             |SI #30#27 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;

     |SI #30#2 = "T";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; Coefi = 100;          |FINSI;
             |SI #30#27 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #30#27;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;

     |SI #30#2 = "V";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 1; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 2; |ACABA;                |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #30#7;             |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 1; |ACABA;                |FINSI;
             |SI #30#27 = 2; Coefi = #30#7;          |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #30#2 = "G";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; Coefi = 50;          |FINSI;
             |SI #30#27 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #30#27 = 0; Coefi = 100;         |FINSI;
                 |SI #30#27 = 1; |ACABA;              |FINSI;
                 |SI #30#27 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; Coefi = 50;          |FINSI;
                 |SI #30#27 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; |ACABA;              |FINSI;
             |SI #30#27 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;

     |SI #30#2 = "C";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; Coefi = 100;          |FINSI;
             |SI #30#27 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #30#27;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;

     |SI #30#2 = "V";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = #30#8;          |FINSI;
             |SI #30#27 = 1; Coefi = #30#8;          |FINSI;
             |SI #30#27 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #30#8;             |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = #30#8;         |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = #30#8;         |FINSI;
         |FINSI;
         |HAZ CargaG3; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO IrregularG3;
  |SI VSwCarga = 0;  |HAZ IrregularG3N;  |FINSI;
  |SI VSwCarga = 1;  |HAZ IrregularG3P;  |FINSI;
|FPRC;

|DEFBUCLE reincire1;
  #30#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, IrregularG3;
|FIN;

|PROCESO CargaPdte1;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 46;   |FINSI;
  |SI Resto = 2;  Casilla = 50;   |FINSI;
  |SI Resto = 0;  Casilla = 54;   |FINSI;

  #610#0 = ContaAct1;
  |LIBERA #610;
  |LEE 140#610=;
  |SI FSalida ! 0;
      |DDEFECTO #610;
      #610#0 = ContaAct1;
      |GRABA 140#610b;
  |FINSI;

  |SI #31#18 = "I";
                              #610Casilla = #610Casilla + (#31#15 % Coefi);
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#16 % Coefi);
      Casilla = Casilla + 1;
      Casilla = Casilla + 1;
  |SINO;
      Casilla = Casilla + 1;
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#15 % Coefi);
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#16 % Coefi);
  |FINSI;

 |GRABA 140#610a;
|FPRC;

|PROCESO APlazosT2N;
  |SI #31#4 = "X"; |O #31#4 = "P"; |ACABA; |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #31#2 = "T"; Perce = "2"; |FINSI;
     |SI #31#2 = "C"; Perce = "3"; |FINSI;
     |SI #31#2 = "G"; Perce = "1"; |FINSI;
     |SI #31#2 = "1"; Perce = "4"; |FINSI;
     |SI #31#2 = "2"; Perce = "5"; |FINSI;
     |SI #31#2 = "3"; Perce = "6"; |FINSI;
     |SI #31#2 = "4"; Perce = "7"; |FINSI;
     |SI #31#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #31#2 = "V";
          Coefi = #31#7 + #31#8 + #31#9 + #31#10 + #31#11 + #31#12;
          |HAZ CargaPdte1;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaPdte1;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #31#2 = "G"; Coefi = 50;    |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "T"; Coefi = 100;   |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#7; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #31#2 = "G"; Coefi = 50;    |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "C"; Coefi = 100;   |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#8; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #31#2 = "1"; Coefi = 100;   |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#9; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #31#2 = "2"; Coefi = 100;    |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#10; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #31#2 = "3"; Coefi = 100;    |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#11; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #31#2 = "4"; Coefi = 100;    |HAZ CargaPdte1; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#12; |HAZ CargaPdte1; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO APlazosT2P;
  |SI #31#4 = "X"; |O #31#4 = "P"; |ACABA; |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #31#2 = "T"; Perce = "2"; |FINSI;
     |SI #31#2 = "C"; Perce = "3"; |FINSI;
     |SI #31#2 = "G"; Perce = "1"; |FINSI;
     |SI #31#2 = "1"; Perce = "4"; |FINSI;
     |SI #31#2 = "2"; Perce = "5"; |FINSI;
     |SI #31#2 = "3"; Perce = "6"; |FINSI;
     |SI #31#2 = "4"; Perce = "7"; |FINSI;
     |SI #31#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #31#2 = "V";
          |SI Tippar = 1;
              |SI #31#29 = 0;  Coefi = #31#7 + #31#8;            |FINSI;
              |SI #31#29 = 1;  |ACABA;                         |FINSI;
              |SI #31#29 = 2;  Coefi = #31#7 + #31#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #31#29 = 0;  Coefi = #31#7 + #31#8;            |FINSI;
              |SI #31#29 = 2;  |ACABA;                         |FINSI;
              |SI #31#29 = 1;  Coefi = #31#7 + #31#8;            |FINSI;
          |FINSI;
          |HAZ CargaPdte1;
          |ACABA;
      |FINSI;

      |SI #31#2 = "G";
          |SI Tippar = 1;
              |SI #31#29 = 0;  Coefi = 50;           |FINSI;
              |SI #31#29 = 1;  |ACABA;               |FINSI;
              |SI #31#29 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #31#29 = 0;  Coefi = 50;          |FINSI;
              |SI #31#29 = 2;  |ACABA;               |FINSI;
              |SI #31#29 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaPdte1;
          |ACABA;
      |FINSI;
      |SI Tippar = 1;
          |SI #31#29 = 0;  Coefi = 100;          |FINSI;
          |SI #31#29 = 1;  |ACABA;               |FINSI;
          |SI #31#29 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #31#29 = 0;  Coefi = 100;          |FINSI;
          |SI #31#29 = 2;  |ACABA;               |FINSI;
          |SI #31#29 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaPdte1;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #31#2 = "G";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; Coefi = 50;          |FINSI;
             |SI #31#29 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; Coefi = 50;          |FINSI;
                 |SI #31#29 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; |ACABA;              |FINSI;
                 |SI #31#29 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; |ACABA;              |FINSI;
             |SI #31#29 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;

     |SI #31#2 = "T";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; Coefi = 100;          |FINSI;
             |SI #31#29 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #31#29;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;

     |SI #31#2 = "V";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 1; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 2; |ACABA;                 |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #31#7;              |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 1; |ACABA;                 |FINSI;
             |SI #31#29 = 2; Coefi = #31#7;          |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #31#2 = "G";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; Coefi = 50;          |FINSI;
             |SI #31#29 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #31#29 = 0; Coefi = 100;         |FINSI;
                 |SI #31#29 = 1; |ACABA;              |FINSI;
                 |SI #31#29 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; Coefi = 50;          |FINSI;
                 |SI #31#29 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; |ACABA;              |FINSI;
             |SI #31#29 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;

     |SI #31#2 = "C";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; Coefi = 100;          |FINSI;
             |SI #31#29 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #31#29;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;

     |SI #31#2 = "V";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = #31#8;          |FINSI;
             |SI #31#29 = 1; Coefi = #31#8;          |FINSI;
             |SI #31#29 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #31#8;             |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = #31#8;         |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = #31#8;         |FINSI;
         |FINSI;
         |HAZ CargaPdte1; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO APlazosT2;
  |SI VSwCarga = 0;  |HAZ APlazosT2N;  |FINSI;
  |SI VSwCarga = 1;  |HAZ APlazosT2P;  |FINSI;
|FPRC;

|DEFBUCLE reincpen1;
  #31#1;
  30, 31;
  #99#0, 01, "I", 2;
  #99#0, 99, "I", 2;
  e;
  NULL, APlazosT2;
|FIN;

|PROCESO CargaG4;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 67;   |FINSI;
  |SI Resto = 2;  Casilla = 82;   |FINSI;
  |SI Resto = 0;  Casilla = 97;   |FINSI;

  #610#0 = ContaAct1;
  |LIBERA #610;
  |LEE 140#610=;
  |SI FSalida ! 0;
      |DDEFECTO #610;
      #610#0 = ContaAct1;
      |GRABA 140#610b;
  |FINSI;

                          #610Casilla = #30#13 % 112;
  Casilla = Casilla + 1;  #610Casilla = #30#13 % 1312;
  Casilla = Casilla + 1;  #610Casilla = Perce;
  Casilla = Casilla + 1;  #610Casilla = #30#28;
  Casilla = Casilla + 1;  #610Casilla = #30#29;
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#14 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#31 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#17 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#25 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#16 % Coefi);

  CantiNum = #30#18 ! 0;
  Valfa1   = ("00" + CantiNum)  % -102;

  Casilla = Casilla + 1;  #610Casilla = Valfa1;
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#20 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#22 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#23 % Coefi);
  Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#30#24 % Coefi);

  |GRABA 140#610a;
|FPRC;

|PROCESO IrregularG4N;
  |SI #30#4 = "X"; |O #30#4 = "P"; |ACABA; |FINSI;

  FechaN = #30#29 - #30#28;
  |SI FechaN [ 731;  |ACABA;  |FINSI;
  |SI #30#26 = "3";  |ACABA;  |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #30#2 = "T"; Perce = "2"; |FINSI;
     |SI #30#2 = "C"; Perce = "3"; |FINSI;
     |SI #30#2 = "G"; Perce = "1"; |FINSI;
     |SI #30#2 = "1"; Perce = "4"; |FINSI;
     |SI #30#2 = "2"; Perce = "5"; |FINSI;
     |SI #30#2 = "3"; Perce = "6"; |FINSI;
     |SI #30#2 = "4"; Perce = "7"; |FINSI;
     |SI #30#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #30#2 = "V";
          Coefi = #30#7 + #30#8 + #30#9 + #30#10 + #30#11 + #30#12;
          |HAZ CargaG4;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaG4;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #30#2 = "G"; Coefi = 50;    |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "T"; Coefi = 100;   |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#7; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #30#2 = "G"; Coefi = 50;    |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "C"; Coefi = 100;   |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#8; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #30#2 = "1"; Coefi = 100;   |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#9; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #30#2 = "2"; Coefi = 100;    |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#10; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #30#2 = "3"; Coefi = 100;    |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#11; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #30#2 = "4"; Coefi = 100;    |HAZ CargaG4; |ACABA; |FINSI;
     |SI #30#2 = "V"; Coefi = #30#12; |HAZ CargaG4; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO IrregularG4P;
  |SI #30#4 = "X"; |O #30#4 = "P"; |ACABA; |FINSI;

  FechaN = #30#29 - #30#28;
  |SI FechaN [ 731;  |ACABA;  |FINSI;
  |SI #30#26 = "3";  |ACABA;  |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #30#2 = "T"; Perce = "2"; |FINSI;
     |SI #30#2 = "C"; Perce = "3"; |FINSI;
     |SI #30#2 = "G"; Perce = "1"; |FINSI;
     |SI #30#2 = "1"; Perce = "4"; |FINSI;
     |SI #30#2 = "2"; Perce = "5"; |FINSI;
     |SI #30#2 = "3"; Perce = "6"; |FINSI;
     |SI #30#2 = "4"; Perce = "7"; |FINSI;
     |SI #30#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #30#2 = "V";
          |SI Tippar = 1;
              |SI #30#27 = 0;  Coefi = #30#7 + #30#8;            |FINSI;
              |SI #30#27 = 1;  |ACABA;                         |FINSI;
              |SI #30#27 = 2;  Coefi = #30#7 + #30#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #30#27 = 0;  Coefi = #30#7 + #30#8;            |FINSI;
              |SI #30#27 = 2;  |ACABA;                         |FINSI;
              |SI #30#27 = 1;  Coefi = #30#7 + #30#8;            |FINSI;
          |FINSI;
          |HAZ CargaG4;
          |ACABA;
      |FINSI;
      |SI #30#2 = "G";
          |SI Tippar = 1;
              |SI #30#27 = 0;  Coefi = 50;           |FINSI;
              |SI #30#27 = 1;  |ACABA;               |FINSI;
              |SI #30#27 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #30#27 = 0;  Coefi = 50;           |FINSI;
              |SI #30#27 = 2;  |ACABA;               |FINSI;
              |SI #30#27 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaG4;
          |ACABA;
      |FINSI;
      |SI Tippar = 1;
          |SI #30#27 = 0;  Coefi = 100;          |FINSI;
          |SI #30#27 = 1;  |ACABA;               |FINSI;
          |SI #30#27 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #30#27 = 0;  Coefi = 100;          |FINSI;
          |SI #30#27 = 2;  |ACABA;               |FINSI;
          |SI #30#27 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaG4;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #30#2 = "G";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; Coefi = 50;          |FINSI;
             |SI #30#27 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; Coefi = 50;          |FINSI;
                 |SI #30#27 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; |ACABA;              |FINSI;
                 |SI #30#27 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; |ACABA;              |FINSI;
             |SI #30#27 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;

     |SI #30#2 = "T";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; Coefi = 100;          |FINSI;
             |SI #30#27 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #30#27;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;

     |SI #30#2 = "V";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 1; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 2; |ACABA;                |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #30#7;             |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = #30#7;          |FINSI;
             |SI #30#27 = 1; |ACABA;                |FINSI;
             |SI #30#27 = 2; Coefi = #30#7;          |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #30#2 = "G";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; Coefi = 50;          |FINSI;
             |SI #30#27 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #30#27 = 0; Coefi = 100;         |FINSI;
                 |SI #30#27 = 1; |ACABA;              |FINSI;
                 |SI #30#27 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #30#27 = 0; Coefi = 50;          |FINSI;
                 |SI #30#27 = 1; Coefi = 50;          |FINSI;
                 |SI #30#27 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 25;          |FINSI;
             |SI #30#27 = 1; |ACABA;              |FINSI;
             |SI #30#27 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;

     |SI #30#2 = "C";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; Coefi = 100;          |FINSI;
             |SI #30#27 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #30#27;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = 100;          |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;

     |SI #30#2 = "V";
         |SI Tippar = 1;
             |SI #30#27 = 0; Coefi = #30#8;          |FINSI;
             |SI #30#27 = 1; Coefi = #30#8;          |FINSI;
             |SI #30#27 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #30#8;             |FINSI;
         |SI Tippar = 3;
             |SI #30#27 = 0; Coefi = #30#8;         |FINSI;
             |SI #30#27 = 1; |ACABA;               |FINSI;
             |SI #30#27 = 2; Coefi = #30#8;         |FINSI;
         |FINSI;
         |HAZ CargaG4; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO IrregularG4;
  |SI VSwCarga = 0;  |HAZ IrregularG4N;  |FINSI;
  |SI VSwCarga = 1;  |HAZ IrregularG4P;  |FINSI;
|FPRC;

|DEFBUCLE reincire2;
  #30#1;
  ;
  #99#0, 01;
  #99#0, 99;
  e;
  NULL, IrregularG4;
|FIN;

|PROCESO CargaPdte2;
  Conta     = Conta + 1;
  ContaAct1 = (((Conta / 3) + 0.49) ! 0) - 1;
  Resto     = (Conta + 3) $ 3;

  |SI Resto = 1;  Casilla = 114;   |FINSI;
  |SI Resto = 2;  Casilla = 118;   |FINSI;
  |SI Resto = 0;  Casilla = 122;   |FINSI;

  #610#0 = ContaAct1;
  |LIBERA #610;
  |LEE 140#610=;
  |SI FSalida ! 0;
      |DDEFECTO #610;
      #610#0 = ContaAct1;
      |GRABA 140#610b;
  |FINSI;

  |SI #31#18 = "I";
                              #610Casilla = #610Casilla + (#31#15 % Coefi);
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#16 % Coefi);
      Casilla = Casilla + 1;
      Casilla = Casilla + 1;
  |SINO;
      Casilla = Casilla + 1;
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#15 % Coefi);
      Casilla = Casilla + 1;  #610Casilla = #610Casilla + (#31#16 % Coefi);
  |FINSI;

 |GRABA 140#610a;
|FPRC;

|PROCESO APlazosT3N;
  |SI #31#4 = "X"; |O #31#4 = "P"; |ACABA; |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #31#2 = "T"; Perce = "2"; |FINSI;
     |SI #31#2 = "C"; Perce = "3"; |FINSI;
     |SI #31#2 = "G"; Perce = "1"; |FINSI;
     |SI #31#2 = "1"; Perce = "4"; |FINSI;
     |SI #31#2 = "2"; Perce = "5"; |FINSI;
     |SI #31#2 = "3"; Perce = "6"; |FINSI;
     |SI #31#2 = "4"; Perce = "7"; |FINSI;
     |SI #31#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #31#2 = "V";
          Coefi = #31#7 + #31#8 + #31#9 + #31#10 + #31#11 + #31#12;
          |HAZ CargaPdte2;
          |ACABA;
      |FINSI;
      Coefi = 100; |HAZ CargaPdte2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #31#2 = "G"; Coefi = 50;    |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "T"; Coefi = 100;   |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#7; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #31#2 = "G"; Coefi = 50;    |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "C"; Coefi = 100;   |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#8; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "1";
     |SI #31#2 = "1"; Coefi = 100;   |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#9; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "2";
     |SI #31#2 = "2"; Coefi = 100;    |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#10; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "3";
     |SI #31#2 = "3"; Coefi = 100;    |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#11; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "4";
     |SI #31#2 = "4"; Coefi = 100;    |HAZ CargaPdte2; |ACABA; |FINSI;
     |SI #31#2 = "V"; Coefi = #31#12; |HAZ CargaPdte2; |ACABA; |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO APlazosT3P;
  |SI #31#4 = "X"; |O #31#4 = "P"; |ACABA; |FINSI;

  Perce = "0";
  |SI #99#1 ! "A";
      Perce = "2";
  |SINO;
     |SI #31#2 = "T"; Perce = "2"; |FINSI;
     |SI #31#2 = "C"; Perce = "3"; |FINSI;
     |SI #31#2 = "G"; Perce = "1"; |FINSI;
     |SI #31#2 = "1"; Perce = "4"; |FINSI;
     |SI #31#2 = "2"; Perce = "5"; |FINSI;
     |SI #31#2 = "3"; Perce = "6"; |FINSI;
     |SI #31#2 = "4"; Perce = "7"; |FINSI;
     |SI #31#2 = "V"; Perce = "2"; |FINSI;
  |FINSI;

  |SI #99#1 = "A";
      |SI #31#2 = "V";
          |SI Tippar = 1;
              |SI #31#29 = 0;  Coefi = #31#7 + #31#8;            |FINSI;
              |SI #31#29 = 1;  |ACABA;                         |FINSI;
              |SI #31#29 = 2;  Coefi = #31#7 + #31#8;            |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #31#29 = 0;  Coefi = #31#7 + #31#8;            |FINSI;
              |SI #31#29 = 2;  |ACABA;                         |FINSI;
              |SI #31#29 = 1;  Coefi = #31#7 + #31#8;            |FINSI;
          |FINSI;
          |HAZ CargaPdte2;
          |ACABA;
      |FINSI;

      |SI #31#2 = "G";
          |SI Tippar = 1;
              |SI #31#29 = 0;  Coefi = 50;           |FINSI;
              |SI #31#29 = 1;  |ACABA;               |FINSI;
              |SI #31#29 = 2;  Coefi = 100;          |FINSI;
          |FINSI;
          |SI Tippar = 2; |O Tippar = 3;
              |SI #31#29 = 0;  Coefi = 50;          |FINSI;
              |SI #31#29 = 2;  |ACABA;               |FINSI;
              |SI #31#29 = 1;  Coefi = 100;          |FINSI;
          |FINSI;
          |HAZ CargaPdte2;
          |ACABA;
      |FINSI;
      |SI Tippar = 1;
          |SI #31#29 = 0;  Coefi = 100;          |FINSI;
          |SI #31#29 = 1;  |ACABA;               |FINSI;
          |SI #31#29 = 2;  Coefi = 100;          |FINSI;
      |FINSI;
      |SI Tippar = 2; |O Tippar = 3;
          |SI #31#29 = 0;  Coefi = 100;          |FINSI;
          |SI #31#29 = 2;  |ACABA;               |FINSI;
          |SI #31#29 = 1;  Coefi = 100;          |FINSI;
      |FINSI;
      |HAZ CargaPdte2;
      |ACABA;
  |FINSI;

  |SI #99#1 = "T";
     |SI #31#2 = "G";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; Coefi = 50;          |FINSI;
             |SI #31#29 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; Coefi = 50;          |FINSI;
                 |SI #31#29 = 2; |ACABA;              |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; |ACABA;              |FINSI;
                 |SI #31#29 = 2; Coefi = 100;         |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; |ACABA;              |FINSI;
             |SI #31#29 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;

     |SI #31#2 = "T";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; Coefi = 100;          |FINSI;
             |SI #31#29 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #31#29;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;

     |SI #31#2 = "V";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 1; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 2; |ACABA;                 |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #31#7;              |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = #31#7;          |FINSI;
             |SI #31#29 = 1; |ACABA;                 |FINSI;
             |SI #31#29 = 2; Coefi = #31#7;          |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;

  |SI #99#1 = "C";
     |SI #31#2 = "G";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; Coefi = 50;          |FINSI;
             |SI #31#29 = 2; |ACABA;              |FINSI;
         |FINSI;
         |SI Tippar = 2;
             |SI Muerto = "T";
                 |SI #31#29 = 0; Coefi = 100;         |FINSI;
                 |SI #31#29 = 1; |ACABA;              |FINSI;
                 |SI #31#29 = 2; Coefi = 100;         |FINSI;
             |FINSI;
             |SI Muerto = "C";
                 |SI #31#29 = 0; Coefi = 50;          |FINSI;
                 |SI #31#29 = 1; Coefi = 50;          |FINSI;
                 |SI #31#29 = 2; |ACABA;              |FINSI;
             |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 25;          |FINSI;
             |SI #31#29 = 1; |ACABA;              |FINSI;
             |SI #31#29 = 2; Coefi = 50;          |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;

     |SI #31#2 = "C";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; Coefi = 100;          |FINSI;
             |SI #31#29 = 2; |ACABA;               |FINSI;
         |FINSI;
         |SI Tippar = 2;  || Muerto
             Periodo = #31#29;
             |HAZ Muerto;
             |SI Error = 1; |ACABA; |FINSI;
         |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = 100;          |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = 100;          |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;

     |SI #31#2 = "V";
         |SI Tippar = 1;
             |SI #31#29 = 0; Coefi = #31#8;          |FINSI;
             |SI #31#29 = 1; Coefi = #31#8;          |FINSI;
             |SI #31#29 = 2; |ACABA;        |FINSI;
         |FINSI;
         |SI Tippar = 2; Coefi = #31#8;             |FINSI;
         |SI Tippar = 3;
             |SI #31#29 = 0; Coefi = #31#8;         |FINSI;
             |SI #31#29 = 1; |ACABA;               |FINSI;
             |SI #31#29 = 2; Coefi = #31#8;         |FINSI;
         |FINSI;
         |HAZ CargaPdte2; |ACABA;
     |FINSI;
     |ACABA;
  |FINSI;
|FPRC;

|PROCESO APlazosT3;
  |SI VSwCarga = 0;  |HAZ APlazosT3N;  |FINSI;
  |SI VSwCarga = 1;  |HAZ APlazosT3P;  |FINSI;
|FPRC;

|DEFBUCLE reincpen2;
  #31#1;
  30, 31;
  #99#0, 01, "I", 3;
  #99#0, 99, "I", 3;
  e;
  NULL, APlazosT3;
|FIN;

|PROCESO PonDeclarante;
     aDeclarante = "";

     |SI aTipo = "0";  aDeclarante = "          ";  |FINSI;
     |SI aTipo = "1";  aDeclarante = "COMUNES   ";  |FINSI;
     |SI aTipo = "2";  aDeclarante = "DECLARANTE";  |FINSI;
     |SI aTipo = "3";  aDeclarante = "CONYUGE   ";  |FINSI;
     |SI aTipo = "4";  aDeclarante = "HIJO 1    ";  |FINSI;
     |SI aTipo = "5";  aDeclarante = "HIJO 2    ";  |FINSI;
     |SI aTipo = "6";  aDeclarante = "HIJO 3    ";  |FINSI;
     |SI aTipo = "7";  aDeclarante = "HIJO 4    ";  |FINSI;
|FPRC;

|PROCESO Totales610;
  #610#4   = ContaAct;

  #610#44  = #6#27;
  #610#45  = #6#26;

  #610#58  = #5#225;
  #610#59  = #5#226;

  #610#60  = #610#45 + #610#58;
  #610#61  = #85#35;
  #610#62  = #85#38;
  #610#63  = #610#60 - #610#61 - #610#62;
  |SI #610#63 < 0;  #610#63 = 0;  |FINSI;
  #610#64  = #610#44 + #610#59;
  #610#65  = #85#5;
  #610#66  = #85#6;

  #610#112 = #6#42;
  #610#113 = #6#41;
  #610#126 = #5#227;
  #610#127 = #5#228;
  #610#129 = #99#7;
  #610#130 = #99#3;

  aTipo = #610#7;   |HAZ PonDeclarante;  #610#131 = aDeclarante;
  aTipo = #610#20;  |HAZ PonDeclarante;  #610#132 = aDeclarante;
  aTipo = #610#33;  |HAZ PonDeclarante;  #610#133 = aDeclarante;
  aTipo = #610#69;  |HAZ PonDeclarante;  #610#134 = aDeclarante;
  aTipo = #610#84;  |HAZ PonDeclarante;  #610#135 = aDeclarante;
  aTipo = #610#99;  |HAZ PonDeclarante;  #610#136 = aDeclarante;

  |GRABA 140#610a;
  |LIBERA #610;
|FPRC;

|DEFBUCLE rew00019T;
  #610#1;
  ;
  00;
  99;
  be;
  NULL, Totales610;
|FIN;

|PROCESO LeeFicheros;
  |ABRE #99;
  #99#0 = VEmpresa;
  #99#1 = VTipo;
  |LEE 040#99=;
  |SI FSalida ! 0; |DDEFECTO #99; |FINSI;
  |CIERRA #99;

  |ABRE #5;
  #5#0   = #99#0;
  #5#141 = #99#1;
  |LEE 040#5=;
  |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
  |CIERRA #5;

  |ABRE #6;
  #6#0  = #99#0;
  #6#1  = #99#1;
  |LEE 040#6=;
  |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
  |CIERRA #6;

  |ABRE #85;
  #85#0  = #99#0;
  #85#1  = #99#1;
  |LEE 040#85=;
  |SI FSalida ! 0; |DDEFECTO #85; |FINSI;
  |CIERRA #85;
|FPRC;

|PROCESO CargaHoja10;
  |HAZ LeeFicheros;

  ContaAct = 0;
  Conta  = 0;
  Conta1 = 0;
  |BUCLE reincire1;
  |SI Conta > 2;  Conta1 = Conta;  |FINSI;
  |SI Conta1 [ 2;
      #610#0 = 1;  |BORRA 140#610c;  |LIBERA #610;
  |FINSI;

  Conta   = 0;
  Conta2  = 0;
  |BUCLE reincpen1;
  |SI Conta > 2;  Conta2 = Conta;  |FINSI;
  |SI Conta1 [ 2; |Y Conta2 [ 2;
      #610#0 = 1;  |BORRA 140#610c;  |LIBERA #610;
  |FINSI;

  Conta  = 0;
  Conta3 = 0;
  |BUCLE reincire2;
  |SI Conta > 2;  Conta3 = Conta;  |FINSI;
  |SI Conta1 [ 3; |Y Conta2 [ 3; |Y Conta3 [ 3;
      #610#0 = 1;  |BORRA 140#610c;  |LIBERA #610;
  |FINSI;

  Conta   = 0;
  Conta4  = 0;
  |BUCLE reincpen2;
  |SI Conta > 2;  Conta4 = Conta;  |FINSI;

  ContaAct  = Conta1;
  |SI ContaAct < Conta2;  ContaAct = Conta2;  |FINSI;
  |SI ContaAct < Conta3;  ContaAct = Conta3;  |FINSI;
  |SI ContaAct < Conta4;  ContaAct = Conta4;  |FINSI;

  |SI ContaAct > 2;
      ContaAct = (((ContaAct / 3) + 0.49) ! 0) - 1;
  |SINO;
      #610#0 = 1;  |BORRA 140#610c;
  |FINSI;

  |BUCLE rew00019T;
|FPRC;

|PROCESO GrabaTexto610;
  |HAZ BorraCampos;

  ICampos = Campos1 <-;
  |PARA XCampos = 1;  |SI XCampos [ 128;  |HACIENDO XCampos = XCampos + 1;
        Campos  = #610XCampos;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos1  <-;                                    Campos = "100";
  ICampos = Campos2  <-;                                    Campos = "10";
  ICampos = Campos3  <-; |SI #610#0 ! 0;  Campos = "C";   |FINSI;
  ICampos = Campos128<-; Valfa = &13 + &10;                 Campos = Valfa;

  ICampos = Campos10 <-;
  |PARA XCampos = 10;  |SI XCampos [ 14;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos16 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos17 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos23 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos24 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos25 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos26 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos27 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos29 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos30 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos36 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos37 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos38 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos39 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos40 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos42 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos43 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;

  ICampos = Campos44 <-;
  |PARA XCampos = 44;  |SI XCampos [ 66;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  ICampos = Campos72 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos73 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos74 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos75 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos76 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos78 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos79 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos80 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos81 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos87 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos88 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos89 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos90 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos91 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos93 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos94 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos95 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos96 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos102 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos103 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos104 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos105 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
  ICampos = Campos106 <-;  CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;

  ICampos = Campos108 <-;
  |PARA XCampos = 108;  |SI XCampos [ 127;  |HACIENDO XCampos = XCampos + 1;
        CantiNum = Campos;  |HAZ CambiCantiD10;  Campos = CantiAlfa;
        ICampos = ICampos + 1;
  |SIGUE;

  INEmpresas = NEmpresas1 <-;
  INEmpresas = INEmpresas + NCopia;

  Pos = -1;
  NSecuencial = "r+b " + NEmpresas;
  |FABRE NSecuencial;
  |SI FSalida < 0;
      NSecuencial = "wb  " + NEmpresas;
      |FABRE NSecuencial;
  |FINSI;

  Handle = FSalida;
  |SI FSalida ] 0;
      |PARA; |SI; |HACIENDO;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
      |SIGUE;
  |FINSI;

  ICampos = Campos1 <-;
  |PARA XPara = 1; |SI XPara [ 128; |HACIENDO XPara = XPara + 1;
        Variable = Handle + " " + Campos;
        |FGRABA Variable;
        ICampos  = ICampos + 1;
  |SIGUE;
  |FCIERRA Handle;
|FPRC;

|DEFBUCLE rew00019G;
  #610#1;
  ;
  00;
  99;
  be;
  NULL, GrabaTexto610;
|FIN;

|PROGRAMA;
  |NOME_DAT #99  VTemporal0;
  |NOME_DAT #610 VTemporal10;

  |SI VSwCarga = 0;  |O VSwCarga = 1;
      |ABRE #610;  |CIERRA #610;  |DELINDEX #610;
      |ABRE #610;
      |HAZ CargaHoja10;
      |CIERRA #610;
  |FINSI;

  |SI VSwCarga = 100;
       |BUCLE rew00019G;
  |FINSI;
|FPRO;
