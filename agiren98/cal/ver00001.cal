|FICHEROS;
     ver00001 #0;

     reproedi #100;    rem00010 #10;
     reprofco #101;    rem00011 #11;
     reempedi #102;    rem00012 #12;
     reemprco #103;    rem00013 #13;
     reempagr #104;    rem00014 #14;
     reempag1 #105;    rem00015 #15;
                       reempmod #16;

     redatcon #17;
     reeleact #30;
     reelea97 #31;
     rem00504 #504;
     rem00506 #506;
|FIN;

|INCLUYE i_camver;

|VARIABLES;
     nCampo    = 0;
     nContador = 0;
     nCanti1   = 0;
     nCanti2   = 0;
     nRdto97   = 0;
     nPorce    = 0;
     nPara     = 0;
     nEsDe     = 0;
     nNaci     = 0;
     nTPar     = 0;
     nMinu     = 0;
     nAnyoFam  = 0;
     nCoefi1   = 0;
     nCoefi2   = 0;


     nPorce1      = 0;
     nPorce2      = 0;
     nPorceL1     = 0;
     nPorceL2     = 0;
     nResto       = 0;
     nDife        = 0;
     nDifer       = 0;
     nCanti       = 0;
     nSwAsala2    = 0;
     nCampoRdto   = 0;
     aAlfa        = "";
|FIN;

|PROCESO Mayus;
     #0Campo = #0Campo >  #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO Graba10;
     |DDEFECTO #10;
     #10#0  = #100#0;
     #10#1  = #100#1;
     #10#2  = #100#2;
     #10#3  = #100#3;
     #10#4  = #100#4;
     #10#5  = #100#7;
     #10#6  = #100#8;
     #10#7  = #100#9;
     #10#8  = #100#10;
     #10#9  = #100#11;
     #10#10 = #100#12;
     #10#11 = #100#35;
     #10#12 = #100#13;
     #10#13 = #100#14;
     #10#14 = #100#15;
     #10#15 = #100#39;
     #10#16 = #100#37;
     #10#17 = #100#38;
     #10#18 = #100#17;
     #10#19 = #100#16;
     #10#31 = #100#33;
     #10#32 = #100#34;
     #10#35 = #100#40;
     #10#36 = #100#41;

     nCampo = #504#1 + 19;   #10nCampo = #10nCampo + #100#19;
     nCampo = #504#2 + 19;   #10nCampo = #10nCampo + #100#18;
     nCampo = #504#3 + 19;   #10nCampo = #10nCampo + #100#20;
     nCampo = #504#4 + 19;   #10nCampo = #10nCampo + #100#21;
     nCampo = #504#5 + 19;   #10nCampo = #10nCampo + #100#22;
     nCampo = #504#6 + 19;   #10nCampo = #10nCampo + #100#23;
     nCampo = #504#7 + 19;   #10nCampo = #10nCampo + #100#24;

     #10#29 = #10#20 + #10#21 + #10#22 + #10#23 + #10#24 + #10#25 + #10#26 + #10#27 + #10#28;
     #10#30 = #10#19 - #10#29;
     #10#33 = #10#31 - #10#32;
     #10#34 = #10#30 + #10#33;


     |GRABA 020#10n;
     |LIBERA #10;
|FPRC;

|PROCESO CambioPN;
     nContador = 0;
     |ABRE #100;
     |LEE 040#100p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1468, nContador;
             |HAZ Graba10;
             |LEE 040#100s;
     |SIGUE;
     |CIERRA #100;
|FPRC;

|PROCESO Graba11;
     |DDEFECTO #11;
     #11#0  = #101#0;
     #11#1  = #101#1;
     #11#2  = #101#2;
     #11#3  = #101#3;
     #11#4  = #101#4;
     #11#5  = #101#7;
     #11#6  = #101#8;
     #11#7  = #101#9;
     #11#8  = #101#10;
     #11#9  = #101#11;
     #11#10 = #101#12;
     #11#11 = #101#42;
     #11#12 = #101#13;
     #11#13 = #101#14;
     #11#14 = #101#15;
     #11#15 = #101#46;
     #11#16 = #101#44;
     #11#17 = #101#45;
     #11#18 = #101#16;
     #11#19 = #101#17;
     #11#20 = #101#37;
     #11#21 = #101#38;
     #11#34 = #101#26;
     #11#35 = #101#27 + #101#28 + #101#29;
     #11#38 = #101#47;
     #11#39 = #101#48;

     nCampo = #504#8  + 21;   #11nCampo = #11nCampo + #101#18;
     nCampo = #504#9  + 21;   #11nCampo = #11nCampo + #101#39;
     nCampo = #504#10 + 21;   #11nCampo = #11nCampo + #101#19;
     nCampo = #504#11 + 21;   #11nCampo = #11nCampo + #101#20;
     nCampo = #504#12 + 21;   #11nCampo = #11nCampo + #101#21;
     nCampo = #504#13 + 21;   #11nCampo = #11nCampo + #101#22;
     nCampo = #504#14 + 21;   #11nCampo = #11nCampo + #101#23;
     nCampo = #504#15 + 21;   #11nCampo = #11nCampo + #101#24;

     #11#30 = #11#21 + #11#22 + #11#23 + #11#24 + #11#25 + #11#26 + #11#27 + #11#28 + #11#29 - #11#20;
     #11#31 = #11#19 - #11#30;
     #11#32 = #11#31 % 5;      |SI #11#32 < 0;  #11#32 = 0;  |FINSI;
     #11#33 = #11#31 - #11#32;
     #11#36 = #11#34 - #11#35;
     #11#37 = #11#33 + #11#36;

     |GRABA 020#11n;
     |LIBERA #11;
|FPRC;

|PROCESO CambioPS;
     nContador = 0;
     |ABRE #101;
     |LEE 040#101p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1568, nContador;
             |HAZ Graba11;
             |LEE 040#101s;
     |SIGUE;
     |CIERRA #101;
|FPRC;

|PROCESO Graba12;
     |DDEFECTO #12;
     #12#0  = #102#0;
     #12#1  = #102#1;
     #12#2  = #102#2;
     #12#3  = #102#3;
     #12#4  = #102#4;
     #12#5  = #102#7;
     #12#6  = #102#8;
     #12#7  = #102#9;
     #12#8  = #102#10;
     #12#9  = #102#11;
     #12#10 = #102#12;
     #12#11 = #102#54;
     #12#12 = #102#13;
     #12#13 = #102#14;
     #12#14 = #102#15;
     #12#15 = #102#57;
     #12#16 = #102#55;
     #12#17 = #102#56;
     #12#18 = #102#16;
     #12#19 = #102#17;
     #12#20 = #102#18;
     #12#21 = #102#19 + #102#20;
     #12#22 = #102#21 + #102#22;
     #12#42 = #102#46;
     #12#43 = #102#47;
     #12#46 = #102#58;
     #12#47 = #102#59;

     nCampo = #504#16 + 23;   #12nCampo = #12nCampo + #102#25;
     nCampo = #504#17 + 23;   #12nCampo = #12nCampo + #102#26;
     nCampo = #504#18 + 23;   #12nCampo = #12nCampo + #102#27;
     nCampo = #504#19 + 23;   #12nCampo = #12nCampo + #102#28;
     nCampo = #504#20 + 23;   #12nCampo = #12nCampo + #102#29;
     nCampo = #504#21 + 23;   #12nCampo = #12nCampo + #102#31;
     nCampo = #504#22 + 23;   #12nCampo = #12nCampo + #102#35;
     nCampo = #504#23 + 23;   #12nCampo = #12nCampo + #102#24;
     nCampo = #504#24 + 23;   #12nCampo = #12nCampo + #102#30;
     nCampo = #504#25 + 23;   #12nCampo = #12nCampo + #102#33;
     nCampo = #504#26 + 23;   #12nCampo = #12nCampo + #102#32;
     nCampo = #504#27 + 23;   #12nCampo = #12nCampo + #102#36;
     nCampo = #504#28 + 23;   #12nCampo = #12nCampo + #102#40;
     nCampo = #504#29 + 23;   #12nCampo = #12nCampo + (#102#34 + #102#37 + #102#38 + #102#39 + #102#41);

     #12#23 = #12#19 + #12#20 + #12#21 + #12#22;
     #12#40 = #12#24 + #12#25 + #12#26 + #12#27 + #12#28 + #12#29 + #12#30 + #12#31;
     #12#40 = #12#40 + #12#32 + #12#33 + #12#34 + #12#35 + #12#36 + #12#37 + #12#38 + #12#39;
     #12#41 = #12#23 - #12#40;
     #12#44 = #12#42 - #12#43;
     #12#45 = #12#41 + #12#44;

     |GRABA 020#12n;
     |LIBERA #12;
|FPRC;

|PROCESO CambioEN;
     nContador = 0;
     |ABRE #102;
     |LEE 040#102p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1668, nContador;
             |HAZ Graba12;
             |LEE 040#102s;
     |SIGUE;
     |CIERRA #102;
|FPRC;

|PROCESO Graba13;
     |DDEFECTO #13;
     #13#0  = #103#0;
     #13#1  = #103#1;
     #13#2  = #103#2;
     #13#3  = #103#3;
     #13#4  = #103#4;
     #13#5  = #103#7;
     #13#6  = #103#8;
     #13#7  = #103#9;
     #13#8  = #103#10;
     #13#9  = #103#11;
     #13#10 = #103#12;
     #13#11 = #103#42;
     #13#12 = #103#13;
     #13#13 = #103#14;
     #13#14 = #103#15;
     #13#15 = #103#46;
     #13#16 = #103#44;
     #13#17 = #103#45;
     #13#18 = #103#16;
     #13#19 = #103#17;
     #13#24 = #103#38;
     #13#25 = #103#39;
     #13#43 = #103#26;
     #13#44 = #103#27 + #103#28 + #103#29;
     #13#47 = #103#49;
     #13#48 = #103#50;

     nCampo = #504#30 + 25;   #13nCampo = #13nCampo + #103#18;
     nCampo = #504#31 + 25;   #13nCampo = #13nCampo + #103#40;
     nCampo = #504#32 + 25;   #13nCampo = #13nCampo + #103#19;
     nCampo = #504#33 + 25;   #13nCampo = #13nCampo + #103#20;
     nCampo = #504#34 + 25;   #13nCampo = #13nCampo + #103#48;
     nCampo = #504#35 + 25;   #13nCampo = #13nCampo + #103#21;
     nCampo = #504#36 + 25;   #13nCampo = #13nCampo + #103#22;
     nCampo = #504#37 + 25;   #13nCampo = #13nCampo + #103#23;
     nCampo = #504#38 + 25;   #13nCampo = #13nCampo + #103#24;

     #13#23 = #13#19 + #13#20 + #13#21 + #13#22;
     #13#39 = #13#25 + #13#26 + #13#27 + #13#28 + #13#29 + #13#30 + #13#31 + #13#32;
     #13#39 = #13#39 + #13#33 + #13#34 + #13#35 + #13#36 + #13#37 + #13#38 - #13#24;
     #13#40 = #13#23 - #13#39;
     #13#41 = #13#40 % 5;      |SI #13#41 < 0;  #13#41 = 0;  |FINSI;
     #13#42 = #13#40 - #13#41;
     #13#45 = #13#43 - #13#44;
     #13#46 = #13#42 + #13#45;

     |GRABA 020#13n;
     |LIBERA #13;
|FPRC;

|PROCESO CambioES;
     nContador = 0;
     |ABRE #103;
     |LEE 040#103p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1768, nContador;
             |HAZ Graba13;
             |LEE 040#103s;
     |SIGUE;
     |CIERRA #103;
|FPRC;

|PROCESO Graba15;
     |DDEFECTO #15;
     #15#0 = #105#0;
     #15#1 = #105#1;
     #15#2 = #105#2;
     #15#6 = #105#7;

     |SI #105#3 = 1;  #15#3 = 1;  #15#4 = 3;  |FINSI;

     |SI #105#3 = 2;
         |SI #105#4 = "G";
             #15#3 = 4;
             #15#4 = 1;
         |SINO;
             #15#3 = 3;
             #15#4 = 1;
             |SI #105#5 = "A";  #15#4 = 2;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #105#3 = 3;
         |SI #105#4 = "G";
             #15#3 = 7;
             #15#4 = 3;
         |SINO;
             #15#3 = 6;
             #15#4 = 1;
             |SI #105#5 = "A";  #15#4 = 2;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #105#3 = 4;
         |SI #105#4 = "G";
             #15#3 = 9;
             #15#4 = 1;
         |SINO;
             #15#3 = 8;
             #15#4 = 1;
             |SI #105#5 = "A";  #15#4 = 2;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #105#3 = 5;
         |SI #105#4 = "G";
             #15#3 = 11;
             #15#4 = 1;
         |SINO;
             #15#3 = 10;
             #15#4 = 1;
             |SI #105#5 = "A";  #15#4 = 2;  |FINSI;
         |FINSI;
     |FINSI;

     |SI #105#3 = 6;  #15#3 = 13;  #15#4 = 1;  |FINSI;

     #506#0 = #15#3;
     #506#1 = #15#4;
     |LEE 040#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;

     #15#5  = #506#3;
     #15#7  = #15#6 * #15#5;
     #15#8  = #506#4;
     #15#9  = #506#5;
     #15#10 = #506#6;
     #15#11 = #15#6 * #15#10;
     |GRABA 020#15n;
     |LIBERA #15;

     |SI #15#8 = "N";
         #14#19 = #14#19 + #15#7;
         #14#44 = #14#44 + #15#11;
     |SINO;
         #14#20 = #14#20 + #15#7;
         #14#45 = #14#45 + #15#11;
     |FINSI;
|FPRC;

|DEFBUCLE reempag1;
    #105#1;
    ;
    #104#0, #104#1, 01;
    #104#0, #104#1, 99;
    ;
    NULL, Graba15;
|FIN;

|PROCESO Graba14;
     |DDEFECTO #14;
     #14#0  = #104#0;
     #14#1  = #104#1;
     #14#2  = #104#2;
     #14#3  = #104#3;
     #14#4  = #104#4;
     #14#5  = #104#7;
     #14#6  = #104#8;
     #14#7  = #104#9;
     #14#8  = #104#10;
     #14#9  = #104#11;
     #14#10 = #104#12;
     #14#11 = #104#6;
     #14#12 = #104#13;
     #14#13 = #104#14;
     #14#14 = #104#15;
     #14#15 = #104#16;
     #14#16 = #104#17;
     #14#17 = #104#18;
     #14#18 = #104#37;
     #14#32 = #104#33 - #104#25;
     #14#33 = #104#26;
     #14#35 = #104#28;
     #14#38 = #104#31;
     #14#39 = #104#32;
     #14#41 = #104#20;

     |SI #104#21 = "S";  #14#24 = 0.75;  |FINSI;

     |SI #14#24 ! 0;
         nPorce = (#14#41 / #14#18) * 100;

         #14#25 = 1;
         |SI nPorce ] 10; #14#25 = 0.90; |FINSI;
         |SI nPorce ] 20; #14#25 = 0.85; |FINSI;
         |SI nPorce ] 30; #14#25 = 0.80; |FINSI;
         |SI nPorce ] 40; #14#25 = 0.75; |FINSI;
     |FINSI;

     |SI #104#23 = "S";  #14#27 = 0.80;  |FINSI;
     |SI #104#30 = "S";  #14#36 = 25;    |FINSI;

     #14#19 = 0;
     #14#20 = 0;
     #14#44 = 0;
     #14#45 = 0;

     |ABRE #15;
     |BUCLE reempag1;
     |CIERRA #15;

     #14#21 = #14#19 + #14#20;
     #14#23 = #14#21 - #14#22;

     nCanti1 = #14#44;
     |SI #14#24 ! 0;  nCanti1 = nCanti1 * #14#24;  |FINSI;
     |SI #14#25 ! 0;  nCanti1 = nCanti1 * #14#25;  |FINSI;
     |SI #14#27 ! 0;  nCanti1 = nCanti1 * #14#27;  |FINSI;

     nCanti2 = #14#45;
     |SI #14#24 ! 0;  nCanti2 = nCanti2 * #14#24;  |FINSI;
     |SI #14#25 ! 0;  nCanti2 = nCanti2 * #14#25;  |FINSI;
     |SI #14#26 ! 0;  nCanti2 = nCanti2 * #14#26;  |FINSI;
     |SI #14#27 ! 0;  nCanti2 = nCanti2 * #14#27;  |FINSI;

     nRdto97 = (nCanti1 + nCanti2) * 1.05;

     nCanti1 = #14#19 - #14#46;
     |SI #14#24 ! 0;  nCanti1 = nCanti1 * #14#24;  |FINSI;
     |SI #14#25 ! 0;  nCanti1 = nCanti1 * #14#25;  |FINSI;
     |SI #14#27 ! 0;  nCanti1 = nCanti1 * #14#27;  |FINSI;
     |SI #14#28 ! 0;  nCanti1 = nCanti1 * #14#28;  |FINSI;

     nCanti2 = #14#20 - #14#47;
     |SI #14#24 ! 0;  nCanti2 = nCanti2 * #14#24;  |FINSI;
     |SI #14#25 ! 0;  nCanti2 = nCanti2 * #14#25;  |FINSI;
     |SI #14#26 ! 0;  nCanti2 = nCanti2 * #14#26;  |FINSI;
     |SI #14#27 ! 0;  nCanti2 = nCanti2 * #14#27;  |FINSI;
     |SI #14#28 ! 0;  nCanti2 = nCanti2 * #14#28;  |FINSI;

     #14#29 = nCanti1 + nCanti2;

     #14#31 = #14#29;
     |SI nRdto97 < #14#31;  |Y nRdto97 ! 0;
         #14#31 = nRdto97;
     |FINSI;
     #14#30 = #14#29 - #14#31;

     #14#34 = #14#31 + #14#32 - #14#33;
     |SI #14#34 < 0;  #14#34 = 0;  |FINSI;

     nCanti1 = #14#34 % #14#35;
     nCanti2 = #14#34 % #14#36;
     #14#37 = #14#34 - nCanti1 - nCanti2;
     |SI #14#37 < 0;  #14#37 = 0;  |FINSI;

     #14#40 = #14#37 + #14#38 - #14#39;

     |GRABA 020#14n;
     |LIBERA #14;
|FPRC;

|PROCESO CambioAG;
     nContador = 0;
     |ABRE #506;
     |ABRE #104;
     |LEE 040#104p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1868, nContador;
             |HAZ Graba14;
             |LEE 040#104s;
     |SIGUE;
     |CIERRA #104;
     |CIERRA #506;
|FPRC;

|PROCESO Incentivo97;
     nPorce1 = 0;
     |SI nDifer > 0;  nPorce1 = nDifer * .60;  |FINSI;

     nPorce2 = 0;
     |SI #16#48 = "I";
         |SI nResto > 8;
             nPorce  = nResto - 8;
             nPorce2 = nPorce2 + (nPorce * 0.70);
             nResto  = 8;
         |FINSI;

         |SI nResto > 5;
             nPorce  = nResto - 5;
             nPorce2 = nPorce2 + (nPorce * 0.75);
             nResto  = 5;
         |FINSI;

         |SI nResto > 3;
             nPorce  = nResto - 3;
             nPorce2 = nPorce2 + (nPorce * 0.80);
             nResto  = 3;
         |FINSI;

         |SI nResto > 1;
             nPorce  = nResto - 1;
             nPorce2 = nPorce2 + (nPorce * 0.85);
             nResto  = 1;
         |FINSI;

         |SI nResto > 0;
             nPorce2 = nPorce2 + (nResto * 0.90);
         |FINSI;
     |FINSI;

     |SI #16#48 = "P";
         |SI nResto > 0;    |Y nResto [ 1;  nPorce2 = 0.90;  |FINSI;
         |SI nResto ] 1.01; |Y nResto [ 3;  nPorce2 = 0.85;  |FINSI;
         |SI nResto ] 3.01; |Y nResto [ 5;  nPorce2 = 0.80;  |FINSI;
         |SI nResto ] 5.01; |Y nResto [ 8;  nPorce2 = 0.75;  |FINSI;
         |SI nResto > 8;                    nPorce2 = 0.70;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO Incentivo98;
     nPorce1 = 0;
     |SI nDifer > 0;  nPorce1 = nDifer * .40;  |FINSI;

     nPorce2 = 0;
     |SI #16#48 = "I";
         |SI nResto > 8;
             nPorce  = nResto - 8;
             nPorce2 = nPorce2 + (nPorce * 0.30);
             nResto  = 8;
         |FINSI;

         |SI nResto > 5;
             nPorce  = nResto - 5;
             nPorce2 = nPorce2 + (nPorce * 0.25);
             nResto  = 5;
         |FINSI;

         |SI nResto > 3;
             nPorce  = nResto - 3;
             nPorce2 = nPorce2 + (nPorce * 0.20);
             nResto  = 3;
         |FINSI;

         |SI nResto > 1;
             nPorce  = nResto - 1;
             nPorce2 = nPorce2 + (nPorce * 0.15);
             nResto  = 1;
         |FINSI;

         |SI nResto > 0;
             nPorce2 = nPorce2 + (nResto * 0.10);
         |FINSI;
     |FINSI;

     |SI #16#48 = "P";
         |SI nResto > 0;    |Y nResto [ 1;  nPorce2 = 0.10;  |FINSI;
         |SI nResto ] 1.01; |Y nResto [ 3;  nPorce2 = 0.15;  |FINSI;
         |SI nResto ] 3.01; |Y nResto [ 5;  nPorce2 = 0.20;  |FINSI;
         |SI nResto ] 5.01; |Y nResto [ 8;  nPorce2 = 0.25;  |FINSI;
         |SI nResto > 8;                    nPorce2 = 0.30;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO TotalMod;
     #31#0 = #16#16;
     #31#1 = #16#17;
     #31#2 = #16#18;
     |LEE 040#31=;
     |SI FSalida ! 0;  |DDEFECTO #31;  |FINSI;

     nResto  = #16#49;
     nPorce1 = 0;
     nPorce2 = 0;
     nDifer  = #16#50 - #16#49;
     |SI nDifer < 0;  nResto = #16#50;  |FINSI;
     |HAZ Incentivo97;
     nPorceL1 = nPorce1 + nPorce2;

     nResto   = #16#54;
     nPorce1 = 0;
     nPorce2 = 0;
     nDifer  = #16#55 - #16#54;
     |SI nDifer < 0;  nResto = #16#55;  |FINSI;
     |HAZ Incentivo97;
     nPorceL2 = nPorce1 + nPorce2;

     |SI #16#54 = 0;  |Y #16#55 =  0;
         #16#97 = nPorceL1 * #31#6;
         #16#97 = #16#97 + (#16#30  * #31#9);
     |SINO;
         #16#97 = nPorceL1 * #31#6;
         #16#97 = #16#97 + (nPorceL2 * #31#9);
     |FINSI;
     #16#97 = #16#97 + (#16#31  * #31#12);
     #16#97 = #16#97 + (#16#32  * #31#15);
     #16#97 = #16#97 + (#16#33  * #31#18);
     #16#97 = #16#97 + (#16#34  * #31#21);
     #16#97 = #16#97 + (#16#35  * #31#24);

     #16#113 = #31#25 % #16#116;

     #16#105 = #16#97;
     |SI #16#98  ! 0;  #16#105 = #16#105 * #16#98;   |FINSI;
     |SI #16#100 ! 0;  #16#105 = #16#105 * #16#100;  |FINSI;

     #16#102 = 0;
     nDife  = #16#105 - #16#113;
     nCanti = #16#113 + (nDife * 1.30);
     |SI nDife < 0;  nCanti = 0;  |FINSI;
     |SI #31#25 = 0; nCanti = 0;  |FINSI;
     |SI nCanti ! 0; #16#105 = nCanti;  #16#102 = 1.30;  |FINSI;

     #16#115 = #16#105 * 1.10;

     || CALCULO DEL RENDIMIENTO EN 1998

     #30#0 = #16#16;
     #30#1 = #16#17;
     #30#2 = #16#18;
     |LEE 040#30=;
     |SI FSalida ! 0;  |DDEFECTO #30;  |FINSI;

     nSwAsala2 = 0;
     aAlfa     = #30#1 % 103;
     |SI aAlfa = "644";  nSwAsala2 = 1;  |FINSI;

     #16#47 =         (#16#29 * #16#38);
     #16#47 = #16#47 + (#16#30 * #16#39);
     #16#47 = #16#47 + (#16#31 * #16#40);
     #16#47 = #16#47 + (#16#32 * #16#41);
     #16#47 = #16#47 + (#16#33 * #16#42);
     #16#47 = #16#47 + (#16#34 * #16#43);
     #16#47 = #16#47 + (#16#35 * #16#44);
     #16#47 = #16#47 + (#16#36 * #16#45);
     #16#47 = #16#47 + (#16#37 * #16#46);

     #16#50 = #16#29;
     #16#52 = #16#38;
     #16#55 = 0;
     #16#57 = 0;
     |SI nSwAsala2 = 1;  #16#55 = #16#30;  #16#57 = #16#39;  |FINSI;

     || Minoracion de Empleo

     nResto  = #16#49;
     #16#51   = 0;
     #16#53   = 0;
     nPorce1 = 0;
     nPorce2 = 0;
     nDifer  = #16#50 - #16#49;
     |SI nDifer < 0;  nResto = #16#50;  |FINSI;
     |HAZ Incentivo98;
     #16#51   = nPorce1 + nPorce2;
     #16#53   = #16#52 * #16#51;

     nResto   = #16#54;
     #16#56   = 0;
     #16#58   = 0;
     nPorce1 = 0;
     nPorce2 = 0;
     nDifer  = #16#55 - #16#54;
     |SI nDifer < 0;  nResto = #16#55;  |FINSI;
     |HAZ Incentivo98;
     #16#56  = nPorce1 + nPorce2;
     #16#58  = #16#57 * #16#56;
     #16#59  = #16#53 + #16#58;

     || Minoracion Inversion

     #16#73 = #16#60 + #16#63 + #16#66 + #16#69 + #16#72;

     ||  Rdto Neto Minorado

     #16#74 = #16#47 - #16#59 - #16#73;
     |SI #16#74 < 0;  #16#74 = 0;  |FINSI;

     ||  Quioscos

     #16#76 = #16#74 * #16#75;
     |SI #30#32 = "N";  #16#76 = 0;  |FINSI;
     |SI #16#76 < 0;    #16#76 = 0;  |FINSI;

     ||  Taxis

     #16#78 = #16#74 * #16#77;
     |SI #30#33 = "N";  #16#78 = 0;  |FINSI;
     |SI #16#78 < 0;    #16#78 = 0;  |FINSI;

     ||  Urbanos

     #16#80 = #16#74 * #16#79;
     |SI #30#35 = "N";  #16#80 = 0;  |FINSI;
     |SI #16#80 < 0;    #16#80 = 0;  |FINSI;

     ||  Mercancias

     #16#82 = #16#74 * #16#81;
     |SI #30#34 = "N";  #16#82 = 0;  |FINSI;
     |SI #16#50 ! 0;     #16#82 = 0;  |FINSI;
     |SI #16#55 ! 0;     #16#82 = 0;  |FINSI;
     |SI #16#82 < 0;     #16#82 = 0;  |FINSI;

     ||  Empresas Peque¤as dimensiones

     nCampoRdto = 74;
     |SI #16#76 ! 0;  nCampoRdto = 76;  |FINSI;

     #16#84 = #16nCampoRdto * #16#83;
     |SI #16#78 ! 0; |O #16#80 ! 0; |O #16#82 ! 0;
         #16#84 = 0;
     |FINSI;
     |SI #16#84 < 0;  #16#84 = 0;  |FINSI;

     ||  Temporada

     nCampoRdto = 74;
     |SI #16#76 ! 0;  nCampoRdto = 76;  |FINSI;
     |SI #16#78 ! 0;  nCampoRdto = 78;  |FINSI;
     |SI #16#80 ! 0;  nCampoRdto = 80;  |FINSI;
     |SI #16#82 ! 0;  nCampoRdto = 82;  |FINSI;
     |SI #16#84 ! 0;  nCampoRdto = 84;  |FINSI;

     #16#87 = #16nCampoRdto * #16#86;
     |SI #16#87 < 0;  #16#87 = 0;  |FINSI;

     || Exceso

     nCampoRdto = 74;
     |SI #16#76 ! 0;  nCampoRdto = 76;  |FINSI;
     |SI #16#78 ! 0;  nCampoRdto = 78;  |FINSI;
     |SI #16#80 ! 0;  nCampoRdto = 80;  |FINSI;
     |SI #16#82 ! 0;  nCampoRdto = 80;  |FINSI;
     |SI #16#84 ! 0;  nCampoRdto = 84;  |FINSI;
     |SI #16#87 ! 0;  nCampoRdto = 87;  |FINSI;

     #16#114 = #30#31 % #16#116;
     #16#88  = #16nCampoRdto - #16#114;
     #16#89  = #16#114 + (#16#88 * 1.30);
     |SI #16#88 < 0;  #16#89 = 0;  |FINSI;
     |SI #30#31 = 0;  #16#89 = 0;  |FINSI;
     |SI #16#84 ! 0;  #16#89 = 0;  |FINSI;

     || Nueva Actividad

     nCampoRdto = 74;
     |SI #16#76 ! 0;  nCampoRdto = 76;  |FINSI;
     |SI #16#78 ! 0;  nCampoRdto = 78;  |FINSI;
     |SI #16#80 ! 0;  nCampoRdto = 80;  |FINSI;
     |SI #16#82 ! 0;  nCampoRdto = 82;  |FINSI;
     |SI #16#84 ! 0;  nCampoRdto = 84;  |FINSI;
     |SI #16#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #16#89 ! 0;  nCampoRdto = 89;  |FINSI;

     #16#91 = #16nCampoRdto * #16#90;
     |SI #16#87 ! 0;  #16#91 = 0;  |FINSI;
     |SI #16#91 < 0;  #16#91 = 0;  |FINSI;

     || Rendimiento Neto Modulos Ajustado

     nCampoRdto = 74;
     |SI #16#76 ! 0;  nCampoRdto = 76;  |FINSI;
     |SI #16#78 ! 0;  nCampoRdto = 78;  |FINSI;
     |SI #16#80 ! 0;  nCampoRdto = 80;  |FINSI;
     |SI #16#82 ! 0;  nCampoRdto = 82;  |FINSI;
     |SI #16#84 ! 0;  nCampoRdto = 84;  |FINSI;
     |SI #16#87 ! 0;  nCampoRdto = 87;  |FINSI;
     |SI #16#89 ! 0;  nCampoRdto = 89;  |FINSI;
     |SI #16#91 ! 0;  nCampoRdto = 91;  |FINSI;

     #16#106 = #16nCampoRdto;

     #16#108 = #16#106;
     |SI #16#115 < #16#108;  |Y #16#115 ! 0;
         #16#108 = #16#115;
     |FINSI;

     #16#107 = #16#106 - #16#108;

     || Rendimiento Neto Calculado

     #16#111 = #16#108 + #16#109 - #16#110;

     || Reduccion Ley 66/97

     #16#93 = #16#111;
     |SI #16#92 ! 0;
         #16#93 = #16#93 < #16#92;
         |SI #16#93 < 0;  #16#93 = 0;  |FINSI;
     |FINSI;

     || Rdto Neto

     #16#96 = #16#93 + #16#95 - #16#104 + #16#94;
|FPRC;

|PROCESO Graba16;
     |SI #16#95 > 0;
         #16#104 = 0;
     |SINO;
         #16#104 = -#16#95;
         #16#95  = 0;
     |FINSI;

     #16#97  = 0;
     #16#99  = 0;
     #16#101 = 0;
     #16#103 = 0;
     #16#105 = 0;
     #16#106 = 0;
     #16#107 = 0;
     #16#108 = 0;
     #16#109 = 0;
     #16#111 = 0;
     #16#112 = 0;
     #16#113 = 0;
     #16#114 = 0;
     #16#115 = 0;

     |HAZ TotalMod;

     |GRABA 020#16a;
     |LIBERA #16;
|FPRC;

|PROCESO CambioEM;
     nContador = 0;
     |ABRE #16;
     |ABRE #30;
     |ABRE #31;
     |LEE 040#16p;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
             nContador = nContador + 1;
             |PINTA 1868, nContador;
             |HAZ Graba16;
             |LEE 040#16s;
     |SIGUE;
     |CIERRA #16;
     |CIERRA #30;
     |CIERRA #31;
|FPRC;

|PROCESO ArreglaHijos;
     #17#181 = 0;
     #17#182 = 0;
     #17#202 = 0;
     #17#203 = 0;
     #17#204 = 0;
     #17#205 = 0;
     #17#206 = 0;
     #17#207 = 0;

     |PARA nPara = 1; |SI nPara [ 10; |HACIENDO nPara = nPara + 1;
           nEsDe = 153 + nPara;
           nNaci = 67  + nPara;
           nTPar = 163 + nPara;
           nMinu = 87  + nPara;

           |SI #17nNaci ! "    ";
               nAnyoFam  = 1998 - #17nNaci;
               |SI #17nEsDe = "A";  nCoefi1 = 0.5;  nCoefi2 = 0.5;  |FINSI;
               |SI #17nEsDe = "T";  nCoefi1 = 1;    nCoefi2 = 0;    |FINSI;
               |SI #17nEsDe = "C";  nCoefi1 = 0;    nCoefi2 = 1;    |FINSI;
               |SI #17nTPar = "H"; |O #17nTPar = "D";      || Si son Descendiente o Hijos.
                   |SI #17nEsDe = "A";
                       #17#181 = #17#181 + 1;
                       #17#182 = #17#182 + 1;
                   |FINSI;
                   |SI #17nEsDe = "T";
                       #17#181 = #17#181 + 1;
                   |FINSI;
                   |SI #17nEsDe = "C";
                       #17#182 = #17#182 + 1;
                   |FINSI;
                   |SI nAnyoFam < 30;                   || Si son Menores de 30 a¤os.
                       |SI #17#181 [ 1; #17#202 = #17#202 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 [ 1; #17#203 = #17#203 + (1 * nCoefi2); |FINSI;
                       |SI #17#181 = 2; #17#204 = #17#204 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 = 2; #17#205 = #17#205 + (1 * nCoefi2); |FINSI;
                       |SI #17#181 ] 3; #17#206 = #17#206 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 ] 3; #17#207 = #17#207 + (1 * nCoefi2); |FINSI;
                   |FINSI;

                   |SI nAnyoFam ] 30; |Y #17nMinu = "S";  || Si son Mayores a 30 y nMinus.
                       |SI #17#181 [ 1; #17#202 = #17#202 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 [ 1; #17#203 = #17#203 + (1 * nCoefi2); |FINSI;
                       |SI #17#181 = 2; #17#204 = #17#204 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 = 2; #17#205 = #17#205 + (1 * nCoefi2); |FINSI;
                       |SI #17#181 ] 3; #17#206 = #17#206 + (1 * nCoefi1); |FINSI;
                       |SI #17#182 ] 3; #17#207 = #17#207 + (1 * nCoefi2); |FINSI;
                   |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;

     #17#181 = #17#202 + #17#204 + #17#206;
     #17#182 = #17#203 + #17#205 + #17#207;

     |GRABA 140#17a;
     |LIBERA #17;
|FPRC;

|DEFBUCLE redatcon;
     #17#1;
     ;
     00000;
     99999;
     be;
     NULL, ArreglaHijos;
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI #0#1 = "NO";  |ACABA;  |FINSI;

     |ABRE #504;
     |LEE 040#504p;
     |SI FSalida ! 0;
         |MENAV "       No existe la Planilla del Cambio de Version";
         |ACABA;
     |FINSI;
     |CIERRA #504;

     |ABRE #506;
     |LEE 040#506p;
     |SI FSalida ! 0;
         |MENAV "       Instale Ficheros Patrones.";
         |ACABA;
     |FINSI;
     |CIERRA #506;

     |ABRE #10;
     |LEE 040#10p;
     |SI FSalida ! 0;  |HAZ CambioPN;  |FINSI;
     |CIERRA #10;

     |ABRE #11;
     |LEE 040#11p;
     |SI FSalida ! 0;  |HAZ CambioPS;  |FINSI;
     |CIERRA #11;

     |ABRE #12;
     |LEE 040#12p;
     |SI FSalida ! 0;  |HAZ CambioEN;  |FINSI;
     |CIERRA #12;

     |ABRE #13;
     |LEE 040#13p;
     |SI FSalida ! 0;  |HAZ CambioES;  |FINSI;
     |CIERRA #13;

     |ABRE #14;
     |LEE 040#14p;
     |SI FSalida ! 0;  |HAZ CambioAG;  |FINSI;
     |CIERRA #14;

                       |HAZ CambioEM;

     |BUCLE redatcon;

     |HAZ gra_version;
|FPRC;
