|FICHEROS;
     rerendir #0;
     rem00010 #1;
     rem00011 #2;
     rem00012 #3;
     rem00013 #4;
     reempmod #5;
     rem00014 #6;
|FIN;

|VARIABLES;
     FEstado      = 0;
     suma         = 0;
     valor        = 0;
     pantalla     = 0;

     &empresa     = 0;
     &nombre      = "";
     &modo        = 0;
     &modelito    = 0;
     &tipomod     = "";
     &errorlin    = 0;

     &numerica1   = 0;  &numerica2  = 0;   &numerica3  = 0;
     &numerica4   = 0;  &numerica5  = 0;   &numerica6  = 00.00;
     &numerica7   = 0;  &numerica8  = 8;
|FIN;

|INCLUYE i_husuar;
|INCLUYE i_activo;

|RUTINA inferior;
    #0#0 = empresa;
    #0#1 = 1;
|FRUT;

|RUTINA superior;
    #0#0 = empresa;
    #0#1 = 99;
|FRUT;

     |PROGRAMA;
     |PINPA #0#0;
     |SI modo = 1;  |ENTLINEAL #1#0,2,1,15,0,inferior,superior;  |FINSI;
     |SI modo = 2;  |ENTLINEAL #1#0,2,2,15,0,inferior,superior;  |FINSI;
     |SI modo = 4;  |ENTLINEAL #1#0,2,4,15,0,inferior,superior;  |FINSI;
|FPRO;

|PROCESO ayuda; |TIPO 2;
     pantalla = 0 +. 1;

     QueTipo    = (FEntrada / 100) ! 0;

     |SI pantalla = 1;
        |SI #0#2 = "PD"; |HAZ ProfNormal; |FINSI;
        |SI #0#2 = "PC"; |HAZ ProfSimpli; |FINSI;
        |SI #0#2 = "ED"; |HAZ EmprNormal; |FINSI;
        |SI #0#2 = "EC"; |HAZ EmprSimpli; |FINSI;
        |SI #0#2 = "EM"; |HAZ emprmodu;   |FINSI;
        |SI #0#2 = "AG"; |HAZ agricola;   |FINSI;
        |SI FEstado = 0;
            |HAZ cargadat;
        |SINO;
            |ERROR;  |ACABA;
        |FINSI;
     |FINSI;

     HContribu  = #0#0;
     HNombre    = nombre;
     HPrograma  = "(rerendir) RENDIMIENTOS IRREGULARES";
     HLinea     = #0#1;
     HPerceptor = #0#5;
     HRdto      = #0#7;

     |SI QueTipo = 1; HTipo = "ALTA FICHA";         |FINSI;
     |SI QueTipo = 2; HTipo = "MODIFICACION FICHA"; |FINSI;
     |SI QueTipo = 3; HTipo = "BAJA FICHA";         |FINSI;

     |SI QueTipo = 3; |Y pantalla ! 1;  |HAZ AltaHistorico;  |FINSI;
     |SI QueTipo < 3; |Y pantalla = 1;  |HAZ AltaHistorico;  |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
     modelito = (FEntrada / 100) ! 0;
     |SI modelito = 4; |HAZ cargadat; |FINSI;
|FPRC;

|PROCESO cargadat;
     numerica1  = #0#8;
     numerica2  = #0#9;
     numerica3  = #0#10;
     numerica4  = #0#11;
     numerica5  = #0#12;
     numerica6  = #0#13;
     numerica7  = #0#14;
     numerica8  = #0#15;

     |SUB_EJECUTA "repant08.run";
     |SI errorlin = 0; |ERROR; |SINO; |HAZ carga; |FINSI;
|FPRC;

|PROCESO carga;
     |SI modelito ! 4;
        #0#8   = numerica1;
        #0#9   = numerica2;
        #0#10  = numerica3;
        #0#11  = numerica4;
        #0#12  = numerica5;
        #0#13  = numerica6;
        #0#14  = numerica7;
        #0#15  = numerica8;
        npro   = 13; |HAZ sigrabo;
        |PINTA #0#7;
     |FINSI;
|FPRC;

|PROCESO ProfNormal;
     |ABRE #1;
     #1#0 = #0#0;
     #1#1 = #0#3;
     |LEE 040#1=;
     FEstado = FSalida;
     |SI FSalida = 0;
         |PINTA #0#4;
         |PINTA #0#5;
         |PINTA #0#6;
         |PINTA #0#7;
     |SINO;
         |MENAV "     No existe registro Rendimiento Irregulares";
         |ERROR; |ACABA;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
|FPRC;

|PROCESO ProfSimpli;
     |ABRE #2;
     #2#0 = #0#0;
     #2#1 = #0#3;
     |LEE 040#2=;
     FEstado = FSalida;
     |SI FSalida = 0;
         #0#4  = #2#2;
         #0#5  = #2#3;
         #0#6  = #2#14;
         #0#7  = #2#37;
         #0#16 = #2#4;
         #0#17 = #2#5;
         #0#18 = #2#6;
         #0#19 = #2#7;
         #0#20 = #2#8;
         #0#21 = #2#9;
         #0#22 = #2#10;
         #0#23 = #2#11;
         |PINTA #0#4;
         |PINTA #0#5;
         |PINTA #0#6;
         |PINTA #0#7;
     |SINO;
        |MENAV "     No existe registro Rendimiento Irregulares";
        |ERROR; |ACABA;
     |FINSI;
     |CIERRA #2;
|FPRC;

|PROCESO EmprNormal;
     |ABRE #3;
     #3#0 = #0#0;
     #3#1 = #0#3;
     |LEE 040#3=;
     FEstado = FSalida;
     |SI FSalida = 0;
         |PINTA #0#4;
         |PINTA #0#5;
         |PINTA #0#6;
         |PINTA #0#7;
     |SINO;
        |MENAV "     No existe registro Rendimiento Irregulares";
        |ERROR; |ACABA;
     |FINSI;
     |CIERRA #3;
|FPRC;

|PROCESO EmprSimpli;
     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = #0#3;
     |LEE 040#4=;
     FEstado = FSalida;
     |SI FSalida = 0;
         #0#4  = #4#2;
         #0#5  = #4#3;
         #0#6  = #4#14;
         #0#7  = #4#46;
         #0#16 = #4#4;
         #0#17 = #4#5;
         #0#18 = #4#6;
         #0#19 = #4#7;
         #0#20 = #4#8;
         #0#21 = #4#9;
         #0#22 = #4#10;
         #0#23 = #4#11;
         |PINTA #0#4;
         |PINTA #0#5;
         |PINTA #0#6;
         |PINTA #0#7;
     |SINO;
        |MENAV "     No existe registro Rendimiento Irregulares";
        |ERROR; |ACABA;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO emprmodu;
|ABRE #5;
#5#0 = #0#0;
#5#1 = #0#3;
|LEE 040#5=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #5#2;
   #0#5  = #5#3;
   #0#6  = #5#19;
   #0#7  = #5#96;
   #0#16 = #5#4;
   #0#17 = #5#5;
   #0#18 = #5#6;
   #0#19 = #5#7;
   #0#20 = #5#8;
   #0#21 = #5#9;
   #0#22 = #5#10;
   #0#23 = #5#11;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #5;
|FPRC;

|PROCESO agricola;
|ABRE #6;
#6#0 = #0#0;
#6#1 = #0#3;
|LEE 040#6=;
FEstado = FSalida;
|SI FSalida = 0;
   #0#4  = #6#2;
   #0#5  = #6#3;
   #0#6  = #6#14;
   #0#7  = #6#40;
   #0#16 = #6#4;
   #0#17 = #6#5;
   #0#18 = #6#6;
   #0#19 = #6#7;
   #0#20 = #6#8;
   #0#21 = #6#9;
   #0#22 = #6#10;
   #0#23 = #6#11;
   |PINTA #0#4;
   |PINTA #0#5;
   |PINTA #0#6;
   |PINTA #0#7;
|SINO;
   |MENAV "     No existe registro Rendimiento Irregulares";
   |ERROR; |ACABA;
|FINSI;
|CIERRA #6;
|FPRC;
