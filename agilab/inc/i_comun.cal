|FICHEROS;
   labregtm #40;    || datos tipos
   labregcc #41;    || registro comun. cabs.
   labregcl #42;    || registro comun. lins.
   labcontr #43;    || control aplicacion
|FIN;

|VARIABLES;
    r_emp = 0;
    r_sw1 = 0;
    r_sw2 = 0;
    r_lin = 0;
|FIN;

|PROCESO r_regis5;
|ABRE #42;
|DDEFECTO #42;
    #42#0 = #41#0;
    #42#1 = #41#1;
    #42#2 = #41#2;
    #42#3 = r_lin;
    #42#4 = #40#3;
    #42#5 = 1;
    #42#6 = "N";
|GRABA 020#42n;
|CIERRA #42;
|FPRC;

|PROCESO r_regis4;
    r_lin = #42#3;
|FPRC;

|PROCESO r_regis3;
|SI #42#6 = "N";
        #42#5 = #42#5 + 1;
    |GRABA 020#42a;
    r_sw1 = 1;
|FINSI;
|LIBERA #42;
|FPRC;

|DEFBUCLE r_regis2;
 #42#2;
 ;
 #41#0, #41#1, #41#2, #40#3;
 #41#0, #41#1, #41#2, #40#3;
 be;
 NULL, r_regis3;
|FIN;

|PROCESO r_regis1;
|DDEFECTO #43; |ABRE #43;     |LEE 000#43=;  |CIERRA #43;

|SI r_emp ! 0;|Y r_sw2 ! 0;|Y #43#40 = "S";
    |ABRE #41;
        #41#0 = r_emp;
        #41#1 = #40#1;
        #41#2 = #40#2;
    |LEE 000#41=;
    |SI FSalida ! 0;
        |GRABA 020#41n;            || graba la cabecera
    |FINSI;
        r_sw1 = 0;
    |BUCLE r_regis2;               || regraba linea
    |SI r_sw1 = 0;
            r_lin = 0;
        |BUCLELIN 2r_regis4#41;    || graba linea
            r_lin = r_lin + 1;
        |HAZ r_regis5;
    |FINSI;
    |CIERRA #41;
|FINSI;
|FPRC;

|PROCESO r_regis0;
|DDEFECTO #43; |ABRE #43;     |LEE 000#43=;  |CIERRA #43;

|SI #43#40 = "S";
        r_sw2 = 0;
    |PUSHV 05012380;
    |DDEFECTO #40;
    |PINPA #0#40;
    |PINDA #0#40;
    |ENDATOS #1#40;
    |SI FSalida = 0;
            r_sw2 = 1;
    |FINSI;
    |POPV;
|FINSI;
|FPRC;
