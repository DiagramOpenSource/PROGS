|FICHEROS;
     labjusti #0;
     labempre #1;
     labtraba #2;
     labregis #3;
     labcontr #10;
|FIN;

|VARIABLES;
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nNume4 = 0;
     nPara1 = 0;
     nPara2 = 0;
     nPara3 = 0;
     nPara4 = 0;
     fFech1 = @;
     fFech2 = @;
     fFech3 = @;
     fFech4 = @;
     nFEstado = 0;
     nSeleccio = 0;
     nModo = 0;
|FIN;
____________________________________/
|VARIABLES;
    dia1   = "";
    mes1   = "";
    any1   = "";
    fec    = "";
    sw     = 0;
    dia    = 0;
    mes    = 0;
    any    = 0;
    tope   = 0;
    mod    = 0;
|FIN;

|PROCESO verifech; |TIPO 0;
fec = #0Campo;
sw  = 0;

|SI fec = "          "; |ACABA; |FINSI;
|SI fec = ".........."; |ACABA; |FINSI;

dia1 = fec % 102;
mes1 = fec % 402;
any1 = fec % 704;

dia  = dia1;
mes  = mes1;
any  = any1;

|SI dia ! 0; |Y mes ! 0; |Y any ! 0;
    |SI mes [ 12; |Y mes ] 1;
        |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
            tope = 31;
        |SINO;
            |SI mes = 2;
                mod = any $ 4;
                |SI mod = 0; tope = 29; |SINO; tope = 28; |FINSI;
            |SINO;
                tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope; sw = 1; |FINSI;
    |FINSI;
|FINSI;

|SI sw = 0;
    |MENAV "0000ATENCION !!! Fecha erronea ...";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO mayus; |TIPO 0;
     #0Campo = #0Campo > #0Campo;
     |PINTA #0Campo;
|FPRC;

|PROCESO Solo1; |TIPO 7;
     |SI #0#10 ! " ";
          |C_M #0Campo, 1, "S";
     |SINO;
          #0Campo = 0;
          |PINTA #0Campo;
          |C_M #0Campo, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Solo2; |TIPO 7;
     |SI #0#12 ! " ";
          |C_M #0Campo, 1, "S";
     |SINO;
          #0Campo = "";
          |PINTA #0Campo;
          |C_M #0Campo, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Solo3; |TIPO 7;
     |SI #0#14 ! " ";
          |C_M #0Campo, 1, "S";
     |SINO;
          #0Campo = "";
          |PINTA #0Campo;
          |C_M #0Campo, 1, "N";
     |FINSI;
|FPRC;
____________________________________/
|PROCESO LeeVarios;
     |DDEFECTO #1;  #1#0 = #0#1;                  |LEE 000#1=;
     |DDEFECTO #2;  #2#0 = #0#1;   #2#1 = #0#2;   |LEE 000#2=;
     |DDEFECTO #3;  #3#1 = #0#1;   #3#2 = #0#2;   |LEE 000#3=;
|FPRC;

|PROCESO Tipo3;
     aAlfa1 = #10#44;
     |QBF aAlfa1;
     Impresora = aAlfa1;
     |IMPRE 0;
     |SI FSalida = 0;
          |ABRE #1;
          |ABRE #2;
          |ABRE #3;
          |SELECT #2#3;
          |HAZ LeeVarios;
          |PARA nPara1 = 1; |SI nPara1 [ #0#5; |HACIENDO nPara1 = nPara1 + 1;
               |INFOR "labjust1"; |PRINT;    |PIEINF;  |FININF;
               |SI #10#19 = "S";
                    |MENAV "    A imprimir reverso ...";
               |FINSI;
               |INFOR "labjust2"; |PRINT;    |PIEINF;  |FININF;
               |SI nPara1 < #0#5;
                    |SI #10#19 = "S";
                         |MENAV "    A imprimir anverso ...";
                    |FINSI;
               |FINSI;
          |SIGUE;
          |CIERRA #1;
          |CIERRA #2;
          |CIERRA #3;
     |SINO;
          |MENAV "    Proceso abortado ...";
     |FINSI;
     |FINIMP;
|FPRC;

|PROGRAMA;
     |CLS;
     |CABEZA "Justif.Bonificacion";
     |PINPA #0#0;

     |ABRE #10;
     |LEE 000#10p;
     |SI FSalida ! 0;
          |MENAV "    No existen parametros de control !!! Usando defectos ...";
     |FINSI;
     |CIERRA #10;

     |DDEFECTO #0;
     |ABRE #0;

     |LEE 101#0p;
     |SI FSalida = 0;
          |BORRA 020#0a;
     |FINSI;
     |LIBERA #0;

     aAlfa1 = #0#4;
     aAlfa2 = #0#5;
     aAlfa3 = #0#29;
     |DDEFECTO #0;
     #0#4 = aAlfa1;
     #0#5 = aAlfa2;
     #0#29 = aAlfa3;
     |PINDA #0#0;

     |ENDATOS #1#0;
     |SI FSalida = 0;
          |PARA; |SI; |HACIENDO;
               |HAZ Tipo3;
               |CONFI "    NRepetir emision (S/N): ";
               |SI FSalida ! 0;
                    |SAL;
               |FINSI;
          |SIGUE;
     |FINSI;

     |GRABA 020#0n;
     |CIERRA #0;
|FPRO;
