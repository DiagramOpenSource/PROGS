|FICHEROS;
     tsilco15 #0;
     tsilco14;
     tsilco16,MANTE;

     labcentr;
|FIN;

|VARIABLES;
     nume1 = 0;
     aMarca = "";
     aTmpCentros = "";
|FIN;

|PROCESO tipo7_15; |TIPO 7;
     ||               1        2         3         4         5         6         7
     ||      123456789023456789012345678901234567890123456789012345678901234567890123456

     |MENSA "     < F5 > Seleccionar trabajador  < F10 > Marcar todos los trabajadores";
     |PINTA 0501, "                                                                           ";
|FPRC;

|PROCESO MarcaTrabCen;
     #tsilco15#7 = "*";
     |GRABA 020#tsilco15.a;
|FPRC;

|DEFBUCLE MarcaTrabCen;
     #tsilco15#1;
     6;
     #tsilco16#0, 00001, #tsilco16#1;
     #tsilco16#0, 99999, #tsilco16#1;
     be;
     NULL, MarcaTrabCen;
|FIN;

|PROCESO LeeCentros;
     |BUCLE MarcaTrabCen;
|FPRC;

|DEFBUCLE LeeCentros;
     #tsilco16#1;
     3;
     #tsilco15#0, 001, "*";
     #tsilco15#0, 999, "*";
     ;
     NULL, LeeCentros;
|FIN;

|PROCESO minCen;
     #tsilco16#0 = 00001;
     #tsilco16#1 = 01;
|FPRC;

|PROCESO maxCen;
     #tsilco16#0 = 99999;
     #tsilco16#1 = 99;
|FPRC;

|PROCESO labcentr;
     #tsilco16#0 = #0#0;
     #tsilco16#1 = #labcentr#1;
     #tsilco16#2 = #labcentr#2;
     #tsilco16#3 = " ";
     #tsilco16#4 = #labcentr#10;
     |LEE 000#tsilco16.=;
     |SI FSalida ! 0;
          |GRABA 020#tsilco16.n;
     |SINO;
          |GRABA 020#tsilco16.a;
     |FINSI;
|FPRC;

|DEFBUCLE labcentr;
     #labcentr#1;
     ;
     #tsilco15#0, 001;
     #tsilco15#0, 999;
     ;
     NULL, labcentr;
|FIN;

|PROCESO MarcaTodosTrab;
     #0#7 = aMarca;
     |PINTA #0#7;
     |GRABA 020#tsilco15.a;
|FPRC;

|DEFBUCLE MarcaTodosTrab;
     #tsilco15#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, MarcaTodosTrab;
|FIN;

|PROCESO Selecciona_15;
     |SI FSalida = 0; |O FSalida = 13;
          |SI #0#7 = "*";
               #0#7 = " ";
          |SINO;
               #0#7 = "*";
          |FINSI;
          |PINTA #0#7;
          |GRABA 020#0a;
          |LIBERA #0;
     |FINSI;
     |SI FSalida = 18;
          |SI #tsilco14#4 = "*"
               aMarca = " ";

               #tsilco14#4 = " ";
               |GRABA 020#tsilco14.a;
               |LIBERA #tsilco14;
          |SINO;
               aMarca = "*";

               #tsilco14#4 = "*";
               |GRABA 020#tsilco14.a;
               |LIBERA #tsilco14;
          |FINSI;

          |BUCLE MarcaTodosTrab;

          |LEE 000#tsilco15.p;

          |PONCONTROL 23, "si";
     |FINSI;
     |SI FSalida = 16;
          |PUSHV 05012380;
          aTmpCentros = Usuario; |QBT aTmpCentros; aTmpCentros = ("v" + aTmpCentros) % 108;
          |NOME_DAT #tsilco16#aTmpCentros#;
          |DELINDEX #tsilco16;
          |ABRE #tsilco16;

          |BUCLE labcentr;

          |ENTLINEAL #1#tsilco16, 2, 4, 22, 1, minCen, maxCen;

          |BUCLE LeeCentros;

          |CIERRA #tsilco16;
          |DELINDEX #tsilco16;

          |POPV;

          |LEE 000#tsilco15.p;
          |PONCONTROL 23, "si";
          |PTEC 808;
     |FINSI;
|FPRC;

|PROCESO tipo11_15; |TIPO 11;
     |HAZ Selecciona_15;
|FPRC;

|PROCESO tipo0_15; |TIPO 0;
     nume1 = Contenido;
     |SI nume1 = #0Campo;
          |HAZ Selecciona_15;
     |FINSI;
|FPRC;
