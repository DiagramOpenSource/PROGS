|| en este PLB pondremos los contratos que vayan saliendo ya que no se puede
|| hacer mas grande el zpdfdocs

|FICHEROS;
     contrato;
     labacue2,MANTE;
     labempre;
     labtraba;
     labcontr;
|FIN;

|VARIABLES;
     &aArchivo = "";
     &aCampo = "";
     &nSwContrato = 0;
     &swAnexoRelevo = 0;
     &aValor = "";
     adisthoras1 = "";
     aAlfa = "";
     nNume = 0;
     &aCadena = "";
     &aMiCaracter = "";
     &nPorDonde = -1;
     &nPos = 0;
     aAlfa1 = "";
     aAlfa2 = "";
     &aCodPos = "";
     &nContMuni = 0;
     &aCodMuni = "";
     aEmp = "";
     aTra = "";
     aCon = "";
     &contador = 0;

     &eaNom   = "";
     &eaApel1 = "";
     &eaApel2 = "";
|FIN;

|PROCESO pe230;     || nuevo anexo de formacion mar/2012  ANEXO I
     |SI aCampo = "nrocentro1";
          aValor = #labacue2#23;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "certsi";
          |SI #labacue2#52 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "certno";
          |SI #labacue2#52 = " ";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "titfpsi";
          |SI #labacue2#53 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "titfpno";
          |SI #labacue2#53 = " ";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "centrosi";
          |SI #labacue2#80 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "centrono";
          |SI #labacue2#80 = " ";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe229;     || nuevo anexo de formacion mar/2012  ANEXO II
     |SI aCampo = "grado medio";
          |SI #labacue2#81 = "M";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "grado superior";
          |SI #labacue2#81 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "acrepar";
          |SI #labacue2#80 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "forcomp";
          |SI #labacue2#79 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "centro1";
          |SI #labacue2#67 = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "nrocentro1";
          |SI #labacue2#67 = 1;
               aValor = #labacue2#23;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "centro2";
          |SI #labacue2#67 = 2;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "nrocentro2";
          |SI #labacue2#67 = 2;
               aValor = #labacue2#23;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "centro3";
          |SI #labacue2#67 = 3;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "nrocentro3";
          |SI #labacue2#67 = 3;
               aValor = #labacue2#23;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Comunes229_230;     || nuevo anexo de formacion mar/2012
     |SI aCampo = "tel centro";
          aValor = #labacue2#5;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia centro";
          aValor = #labacue2#24;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechainifor";
          aValor = #labacue2#68;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechafinfor";
          aValor = #labacue2#69;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horariofor";
          aValor = #labacue2#70;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "comunidad";
          aValor = #labacue2#71;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas11";
          aValor = #labacue2#72;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas12";
          aValor = #labacue2#73;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas21";
          aValor = #labacue2#74;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas22";
          aValor = #labacue2#75;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "email centro";
          aValor = #labacue2#26;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cifempresa";
          aValor = #labempre#10;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "telempresa";
          aValor = #labempre#111;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "emailempresa";
          aValor = #labempre#130;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechafincontrato";
          aValor = #labacue2#66;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "puesto";
          |SI #labcontr#67 = "S";
               aValor = #labacue2#13;
          |SINO;
               aValor = #labtraba#19;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CNO";
          |SI #labcontr#67 = "S";
               aValor = #labacue2#27;
          |SINO;
               aValor = #labtraba#185;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombrerepempresa";
          aValor = #labacue2#45;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nifrepempresa";
          aValor = #labacue2#46;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cargorepempresa";
          aValor = #labacue2#47;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "razonsocialempresa";
          aValor = #labempre#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombre trab";
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "DNI trab";
          aValor = #labtraba#7;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "idcontrato";
          aAlfa1 = "";
          aAlfa = #labacue2#28; |QBF aAlfa; aAlfa1 = aAlfa;
          aAlfa = #labacue2#29; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa;
          aAlfa = #labacue2#31; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa;
          aAlfa = #labacue2#32; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa;
          aAlfa = #labacue2#33; |QBF aAlfa;
          |SI aAlfa ! "";
               aAlfa1 = aAlfa1 + aAlfa;
          |FINSI;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechacontrato";
          ||SI #labacue2#49 = "X";
               aValor = #labacue2#50;
          ||FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombrerepcentro";
          aValor = #labacue2#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nifrepcentro";
          aValor = #labacue2#8;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cargorepcentro";
          aValor = #labacue2#51;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombre centro";
          aValor = #labacue2#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CIF centro";
          aValor = #labacue2#3;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Direccion centro";
          aValor = #labacue2#4;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CP centro";
          aAlfa1 = #labacue2#19; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #labacue2#20; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          aValor = aAlfa1 + aAlfa2; |QBF aValor;
          aCodPos = aValor;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad centro";
          aValor = #labacue2#21;
          |HAZ GrabaTemporal;
     |FINSI;
     || mando aCodPos
     |SI aCampo = "codmuni centro";
          |HAZ CodigoMuni;
          |SI nContMuni = 0;
               |MENAV "0000Codigo de municipio del trabajador inaccesible.";
               aValor = "00000";
          |SINO;
               aValor = aCodMuni;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "certprof";
          |SI #labacue2#52 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "titfp";
          |SI #labacue2#53 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "eso";
          |SI #labacue2#54 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "denom certprof"; |Y #labacue2#52 = "X";
          aValor = #labacue2#55;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "codigo certprof"; |Y #labacue2#52 = "X";
          aValor = #labacue2#56;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "RD certprof"; |Y #labacue2#52 = "X";
          aValor = #labacue2#57;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas certprof"; |Y #labacue2#52 = "X";
          aValor = #labacue2#58;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "denom titfp"; |Y #labacue2#53 = "X";
          aValor = #labacue2#59;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "RD titfp"; |Y #labacue2#53 = "X";
          aValor = #labacue2#60;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas titfp"; |Y #labacue2#53 = "X";
          aValor = #labacue2#61;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "presencial";
          |SI #labacue2#18 = "P";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "a distancia";
          |SI #labacue2#18 = "D";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mixta";
          |SI #labacue2#18 = "M";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "teleformacion";
          |SI #labacue2#18 = "T";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad";
          aValor = #labacue2#62;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "dia";
          aValor = #labacue2#63;
          |QBF aValor;
          |SI aValor = "0"; aValor = ""; |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mes";
          aValor = #labacue2#64;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "a\361o";
          aValor = #labacue2#65;
          |QBF aValor;
          |SI aValor = "0"; aValor = ""; |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "registro acuerdo";
          aEmp = #contrato#1; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #contrato#2; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe171;
|FPRC;

|PROCESO pe172;
|FPRC;

|PROCESO pe151;
     |SI #contrato#27 = "C"; |Y #contrato#78 = "S";
          nSwContrato = 150;
     |FINSI;
     |SI #contrato#27 = "C"; |Y #contrato#78 = "N";
          nSwContrato = 100;
     |FINSI;
     |SI #contrato#27 = "P"; |Y #contrato#78 = "S";
          nSwContrato = 250;
     |FINSI;
     |SI #contrato#27 = "P"; |Y #contrato#78 = "N";
          nSwContrato = 200;
     |FINSI;
     |SI #contrato#27 = "F"; |Y #contrato#78 = "S";
          nSwContrato = 350;
     |FINSI;
     |SI #contrato#27 = "F"; |Y #contrato#78 = "N";
          nSwContrato = 300;
     |FINSI;
|FPRC;

|PROCESO DatosPagoSystem;
     |SI aCampo = "direccion empresa";
          aValor = #labempre#3;
          |QBF aValor;
          aAlfa = #labempre#4;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + ", " + aAlfa;
          |FINSI;
          aAlfa = #labempre#5;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + " - " + aAlfa;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad empresa";
          aValor = #labempre#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia empresa";
          aValor = #labempre#9;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CP empresa";
          aAlfa1 = #labempre#7; |QBF aAlfa1; aAlfa1 = ("00" + aAlfa1) % -102;
          aAlfa2 = #labempre#8; |QBF aAlfa2; aAlfa2 = ("000" + aAlfa2) % -103;
          aValor = aAlfa1 + aAlfa2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ENTIDADRow1";
          aValor = #labacue2#38;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "OFICINARow1";
          aValor = #labacue2#39;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "DCRow1_2";
          aValor = #labacue2#40;
          |QBF aValor;
          aValor = ("00" + aValor) % -102;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "N CUENTARow1";
          aValor = #labacue2#41;
          |QBF aValor;
          aValor = ("0000000000" + aValor) % -110;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Fdo";
          aValor = #labacue2#42;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "DNI titular";
          aValor = #labacue2#83;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "banco";
          aValor = #labacue2#84;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "domicilio banco";
          aValor = #labacue2#85;
          |HAZ GrabaTemporal;
     |FINSI;

     aCadena = #labtraba#2;
     |HAZ SeparaNom_plb;

     |SI aCampo = "apellidos trab pago";
          aValor = eaApel1 + " " + eaApel2;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "nombre trab pago";
          aValor = eaNom;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO DatosPagoEdutedis;
     |SI aCampo = "CIFUSUARIO";
          aValor = #labcontr#69;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "NOMBREUSUARIO";
          aValor = #labcontr#68;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "direccion empresa";
          aValor = #labempre#3;
          |QBF aValor;
          aAlfa = #labempre#4;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + ", " + aAlfa;
          |FINSI;
          aAlfa = #labempre#5;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + " - " + aAlfa;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad empresa";
          aValor = #labempre#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia empresa";
          aValor = #labempre#9;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ENTIDADRow1";
          aValor = #labacue2#38;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "OFICINARow1";
          aValor = #labacue2#39;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "DCRow1_2";
          aValor = #labacue2#40;
          |QBF aValor;
          aValor = ("00" + aValor) % -102;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "N CUENTARow1";
          aValor = #labacue2#41;
          |QBF aValor;
          aValor = ("0000000000" + aValor) % -110;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Fdo";
          aValor = #labacue2#42;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO Contratos_plb;
     |ABRE #labcontr; |LEE 000#labcontr.p; |CIERRA #labcontr;
     |SI aArchivo = "pe-151.pdf"; |O aArchivo = "pe-151cb.pdf";
          |HAZ pe151;
     |FINSI;
     |SI aArchivo = "pe-171.pdf"; |O aArchivo = "pe-171cb.pdf";
          |HAZ pe171;
     |FINSI;
     |SI aArchivo = "pe-172.pdf"; |O aArchivo = "pe-172cb.pdf";
          |HAZ pe172;
     |FINSI;
     |SI aArchivo = "pe-229.pdf"; |O aArchivo = "pe-229cb.pdf";
     |O aArchivo = "pe-230.pdf"; |O aArchivo = "pe-230cb.pdf";
     |O aArchivo = "AnexoEdutedis12.pdf"; |O aArchivo = "AnexoEdutedis12cb.pdf";
     |O aArchivo = "AnexoSystem.pdf"; |O aArchivo = "AnexoSystemcb.pdf";
          |HAZ Comunes229_230;
     |FINSI;
     |SI aArchivo = "pe-229.pdf"; |O aArchivo = "pe-229cb.pdf";
          |HAZ pe229;
     |FINSI;
     |SI aArchivo = "pe-230.pdf"; |O aArchivo = "pe-230cb.pdf";
          |HAZ pe230;
     |FINSI;
     |SI aArchivo = "AnexoEdutedis12.pdf"; |O aArchivo = "AnexoEdutedis12cb.pdf";
          |HAZ pe230;
          |HAZ DatosPagoEdutedis;
     |FINSI;
     |SI aArchivo = "AnexoSystem.pdf"; |O aArchivo = "AnexoSystemcb.pdf";
          |HAZ pe230;
          |HAZ DatosPagoSystem;
     |FINSI;
|FPRC;
