|FICHEROS;
   labempre #0;
   labtraba #1;
   labcombv #2;
   labregis #3;
   labcontr #10;
|FIN;

|VARIABLES;
 x = 0;
 mod = 0;
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    informe = "labcombv";
    men1 = "     No existe empresa !!!";
    men2 = "     No existe trabajador !!!";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    loca = "";
    loca1 = "";
    &local = "";
    diacom = "";
    mescom = "";
    anycom = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    &calle = "";
    piso = "";
    numpiso = "";
    comaespa = ", ";
    calle1 = "";
    &fcom = "";
    fcomsys = @;
    fcombaj = @;
    mensaje1 = "0000ATENCION !!! Fecha erronea ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    dia = 0;
    mes = 0;
    any = 0;
    tope = 0;
    sw = 0;
    fec = "";
    blanco = "          ";
    puntos = "..........";
|FIN;

|INCLUYE i_comun;
____________________________________/ CALCULOS DE PANTALLA
|PROCESO fecha;|TIPO 0;
    fcomsys = #2#11;
    fcombaj = #2#12;
    fechanum = fcombaj - fcomsys;
|SI fechanum < 15;
    |MENAV "     NOTA: comunicacion de baja con anticipacion menor a 15 dias.";
|FINSI;
|FPRC;

|PROCESO fechacon; |TIPO 0;
        fec = #2Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
  dia1 = fec % A102;
  mes1 = fec % A402;
  any1 = fec % A704;
  dia = dia1; mes = mes1; any = any1;
  |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
     |SI mes [ 12; |Y mes ] 1;
       |SI mes = 1; |O mes = 3; |O mes = 5; |O mes = 7; |O mes = 8; |O mes = 10; |O mes = 12;
           tope = 31;
       |SINO;
           |SI mes = 2;
               mod = any $ 4;
               |SI mod = 0;
                   tope = 29;
               |SINO;
                   tope = 28;
               |FINSI;
            |SINO;
               tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope;
            sw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV mensaje1;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO compru1; |TIPO 0;
|ABRE #0;
    #0#0 = #2#0;
|LEE 000#0=;
|SI FSalida ! 0; |Y #2#0 ! 0;
    |MENAV men1;
    |ERROR;
|SINO;
        #2#1 = #0#2;  |PINTA #2#1;
        #2#2 = #0#3;  |PINTA #2#2;
        #2#3 = #0#4;  |PINTA #2#3;
        #2#4 = #0#5;  |PINTA #2#4;
        #2#5 = #0#6;  |PINTA #2#5;
        #2#6 = #0#7;  |PINTA #2#6;
        #2#7 = #0#8;  |PINTA #2#7;
    |DDEFECTO #0;
|FINSI;
|CIERRA #0;
|FPRC;

|PROCESO compru2; |TIPO 0;
|ABRE #1;
    #1#0 = #2#0;
    #1#1 = #2#8;
|LEE 000#1=;
|SI FSalida ! 0; |Y #2#8 ! 0;
    |MENAV men2;
    |ERROR;
|SINO;
        #2#9 = #1#2;  |PINTA #2#9;
        #2#10 = #1#7;  |PINTA #2#10;
    |DDEFECTO #1;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO noentres; |TIPO 7;
|SI #2#0 ! 0;
        xxaponer = Anono;
        xxxxfiac = Control % A1001;
        Control = Control + xxxxfiac;
        Control = Control + xrelleno;
        Control = Control % A120;
        Control = Control + xxaponer;
|SINO;
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;

|PROCESO nopases; |TIPO 7;
|SI #2#8 ! 0;
        xxaponer = Anono;
        xxxxfiac = Control % A1001;
        Control = Control + xxxxfiac;
        Control = Control + xrelleno;
        Control = Control % A120;
        Control = Control + xxaponer;
|SINO;
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;

|PROCESO no_actualiza; |TIPO 7;
|SI #2#0 = 0;|O #2#8 = 0;
     #2#14 = "N";
|SINO;
     |ABRE #10;
     |LEE 001#10p;
     |SI FSalida = 0;
          |SI #10#5 = 0;
                  #2#14 = "N";
          |SINO;
                  #2#14 = "S";
          |FINSI;
     |SINO;
          #2#14 = "N";
     |FINSI;
     |CIERRA #10;
|FINSI;
|PINTA #2#14;
|FPRC;

|PROCESO mayus; |TIPO 0;
    #2Campo = #2Campo > #2Campo;
|PINTA #2Campo;
|FPRC;
____________________________________/
|PROCESO actualiza;
|ABRE #1;
    #1#0 = #2#0;
    #1#1 = #2#8;
|LEE 101#1=;
|SI FSalida = 0;
        #1#37 = #2#12;   || fecha baja
    |GRABA 020#1a;
|FINSI;
|LIBERA #1;
|CIERRA #1;

|ABRE #3;
|SELECT #2#3;
    #3#1 = #2#0;
    #3#2 = #2#8;
|LEE 101#3=;
|SI FSalida = 0;
    |SI #3#15 = 0;
            #3#8 = #2#12;          || contrato
    |SINO;
            #3#20 = #2#12;         || prorroga
    |FINSI;
    |GRABA 020#3a;
|FINSI;
|LIBERA #3;
|CIERRA #3;
|FPRC;

|PROCESO varios;
    fechacom = #2#11;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
|SI mescom = 01;    fechacom =  uno;    |FINSI;
|SI mescom = 02;    fechacom =  dos;    |FINSI;
|SI mescom = 03;    fechacom = tres;    |FINSI;
|SI mescom = 04;    fechacom = cuatro;  |FINSI;
|SI mescom = 05;    fechacom = cinco;   |FINSI;
|SI mescom = 06;    fechacom = seis;    |FINSI;
|SI mescom = 07;    fechacom = siete;   |FINSI;
|SI mescom = 08;    fechacom = ocho;    |FINSI;
|SI mescom = 09;    fechacom = nueve;   |FINSI;
|SI mescom = 10;    fechacom = diez;    |FINSI;
|SI mescom = 11;    fechacom = once;    |FINSI;
|SI mescom = 12;    fechacom = doce;    |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    loca = #2#5;
|QBF loca;
    loca1 = #2#5 - loca;
    local = loca1 + loca;
    calle1 = #2#2;
    numpiso = #2#3;
    piso = #2#4;
|QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numpiso;
    calle = calle + espacio;
    calle = calle + piso;
|FPRC;

|PROCESO tipo3; |TIPO 3;
|HAZ r_regis0;   r_emp = #2#0;  |HAZ r_regis1;
|IMPRE 0;
|SI FSalida = 0;
    |HAZ varios;
    |PARA x = 1; |SI x [ #2#13; |HACIENDO x = x + 1;
        |INFOR informe;
        |PRINT;
        |PIEINF;
        |FININF;
        |SI #2#14 = "S";
            |HAZ actualiza;
        |FINSI;
    |SIGUE;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;
