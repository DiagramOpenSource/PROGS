|FICHEROS;
    labcomxs #0;
    labempre #1;
    labtraba #2;
    labregis #3;
|FIN;

|VARIABLES;
 mod = 0;
    verrfec = "0000ATENCION Fecha erronea";
    vdia1 = "";
    vme1 = "";
    vany1 = "";
    vdia = 0;
    vme = 0;
    vany = 0;
    vtope = 0;
    vsw = 0;
    vfec = "";
    vblanco = "          ";
    vpuntos = "..........";
    informe = "labcomxs";
    fectraba = @;
    diasvenc = 0;
    diasdesd = 0;
    diashast = 0;
    sw = 0;
    v = 0;
    fechanum = 0;
    fechacom = "";
    fechobra = "";
    loca = "";
    loca1 = "";
    &coma = ",";
    &local = "";
    &fcom = "";
    &fobra = "";
    diacom = "";
    mescom = "";
    anycom = "";
    diaobra = "";
    mesobra = "";
    anyobra = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    unob =       " Enero-----";
    dosb =       " Febrero---";
    tresb =      " Marzo-----";
    cuatrob =    " Abril-----";
    cincob =     " Mayo------";
    seisb =      " Junio-----";
    sieteb =     " Julio-----";
    ochob =      " Agosto----";
    nueveb =     " Septiembre";
    diezb =      " Octubre---";
    onceb =      " Noviembre-";
    doceb =      " Diciembre-";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
    calle2 = "";
    &callet = "";
    numcat = "";
    pisot = "";
    minu = "m";
    mayu = "M";
    amayu = "A";
    aminu = "a";
    xdias = " dias";
    xmeses = " meses";
    xy = " y ";
    mesestra = 0;
    diastra = 0;
    &varal = "";
|FIN;

|INCLUYE i_comun;

|PROCESO checkeo;
|SI #3#15 = 0;
    fectraba = #3#8;
    diasvenc = fectraba;
|SINO;
    fectraba = #3#20;
    diasvenc = fectraba;
|FINSI;
   sw = 1;
|SI diasvenc > diashast; sw = 0; |FINSI;
|SI diasvenc < diasdesd; sw = 0; |FINSI;
|SI sw = 1;
        #1#0 = #3#1;
    |LEE 000#1=;         || lee empresa
        #2#0 = #3#1;
        #2#1 = #3#2;
    |LEE 000#2=;         || lee trabajador
    |HAZ conversi;
    |HAZ litedura;
        r_emp = #1#0;
    |HAZ r_regis1;
    |PARA v = 1; |SI v [ #0#8; |HACIENDO v = v + 1;
        |INFOR informe;
        |PRINT;
        |PIEINF;
    |FININF;
    |SIGUE;
|FINSI;
|FPRC;

|DEFBUCLE labcomxs0;
 #3#2;
 4;
 #0#0, #0#2, #0#4;
 #0#1, #0#3, #0#5;
 ;
 NULL,checkeo;
|FIN;

|PROCESO fechacon; |TIPO 0;        || RUTINA DE CHEQUEO DE FECHAS
        vfec = #0Campo; vsw = 0;
|SI vfec ! vblanco; |Y vfec ! vpuntos;
  vdia1 = vfec % A102;
  vme1 = vfec % A402;
  vany1 = vfec % A704;
  vdia = vdia1; vme = vme1; vany = vany1;
  |SI vdia ! 0; |Y vme ! 0; |Y vany > 1900;
     |SI vme [ 12; |Y vme ] 1;
       |SI vme = 1; |O vme = 3; |O vme = 5; |O vme = 7; |O vme = 8; |O vme = 10; |O vme = 12;
           vtope = 31;
       |SINO;
           |SI vme = 2;
               mod = vany $ 4;
               |SI mod = 0;
                   vtope = 29;
               |SINO;
                   vtope = 28;
               |FINSI;
            |SINO;
               vtope = 30;
            |FINSI;
        |FINSI;
        |SI vdia [ vtope;
            vsw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  vsw = 1;
|FINSI;
|SI vsw = 0;
    |MENAV verrfec;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO impresio; |TIPO 3;
|IMPRE 0;
|SI FSalida = 0;
    |HAZ r_regis0;
    |ABRE #1;
    |ABRE #2;
    |ABRE #3;
        fectraba = #0#6;
        diasdesd = fectraba;       || convierte fechas a numero de dias
        fectraba = #0#7;           || para comparar posteriormente
        diashast = fectraba;
    |BUCLE labcomxs0;
    |CIERRA #1;
    |CIERRA #2;
    |CIERRA #3;
|SINO;
    |MENAV "    Proceso Abortado ...";
|FINSI;
|FINIMP;
|FPRC;

|PROCESO conversi;            || RUTINA DE FORMATEO DE FECHAS Y DIRECCIONES
    fechacom = #0#9;
    fechobra = fectraba;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
    diaobra = fechobra % A102;
    mesobra = fechobra % A402;
    anyobra = fechobra % A704;
  |SI mescom = 01;  fechacom =  uno;    |FINSI;
  |SI mescom = 02;  fechacom =  dos ;   |FINSI;
  |SI mescom = 03;  fechacom = tres;    |FINSI;
  |SI mescom = 04;  fechacom = cuatro;  |FINSI;
  |SI mescom = 05;  fechacom = cinco;   |FINSI;
  |SI mescom = 06;  fechacom = seis;    |FINSI;
  |SI mescom = 07;  fechacom = siete;   |FINSI;
  |SI mescom = 08;  fechacom = ocho;    |FINSI;
  |SI mescom = 09;  fechacom = nueve;   |FINSI;
  |SI mescom = 10;  fechacom = diez;    |FINSI;
  |SI mescom = 11;  fechacom = once;    |FINSI;
  |SI mescom = 12;  fechacom = doce;    |FINSI;
  |SI mesobra = 01; fechobra = unob;    |FINSI;
  |SI mesobra = 02; fechobra = dosb;    |FINSI;
  |SI mesobra = 03; fechobra = tresb;   |FINSI;
  |SI mesobra = 04; fechobra = cuatrob; |FINSI;
  |SI mesobra = 05; fechobra = cincob;  |FINSI;
  |SI mesobra = 06; fechobra = seisb;   |FINSI;
  |SI mesobra = 07; fechobra = sieteb;  |FINSI;
  |SI mesobra = 08; fechobra = ochob;   |FINSI;
  |SI mesobra = 09; fechobra = nueveb;  |FINSI;
  |SI mesobra = 10; fechobra = diezb;   |FINSI;
  |SI mesobra = 11; fechobra = onceb;   |FINSI;
  |SI mesobra = 12; fechobra = doceb;   |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    fobra = diaobra + fechobra;
    loca = #1#6;
    |QBF loca;
    loca1 = #1#6 - loca;
    local = loca1 + loca;
    calle1 = #1#3;
    numca = #1#4;
    piso = #1#5;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numca;
    calle = calle + espa;
    calle = calle + piso;
    calle2 = #2#3;
    numcat = #2#4;
    pisot = #2#5;
    |QBF calle2;
    callet = calle2 + comaespa;
    callet = callet + numcat;
    callet = callet + espa;
    callet = callet + pisot;
|FPRC;

|PROCESO litedura;              || CONSTRUYE LITERAL DURACION PARA IMPRESION
    mesestra = #3#18;
    diastra = #3#22;
    varal = "";
    |SI mesestra ! 0;
        varal = mesestra;
        varal = varal + xmeses;
    |SINO;
        varal = "ú...........";
    |FINSI;
    |SI diastra ! 0;
        |SI mesestra ! 0;
            varal = varal + xy;
        |FINSI;
        varal = varal + diastra;
        varal = varal + xdias;
    |SINO;
        varal = varal + "............";
    |FINSI;
|FPRC;
