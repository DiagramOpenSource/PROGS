|FICHEROS;
     labcer01 #0;
     labcer02 #2,MANTE;
     labcer03 #3,MANTE;

     labtraba;
|FIN;

|VARIABLES;
     nModo = 0;
     &swAlgo = 0;
     aAlfa = "";

     fFechaAlta = @;
     fFechaBaja = @;
     fFechaIni = @;
     fFechaFin = @;

     aEmpresa = "";
     aCampanya = "";
     nPrimerTra = 0;
|FIN;

|PROCESO Borra03_cer01;
     |BORRA 020#3a;
|FPRC;

|DEFBUCLE Borra03_cer01;
     #3#1;
     ;
     #0#0, #0#1, 00001, 0000;
     #0#0, #0#1, 99999, 9999;
     ;
     NULL, Borra03_cer01;
|FIN;

|PROCESO Borra02_cer01;
     |BORRA 020#2a;
|FPRC;

|DEFBUCLE Borra02_cer01;
     #2#1;
     ;
     #0#0, #0#1, 00001;
     #0#0, #0#1, 99999;
     ;
     NULL, Borra02_cer01;
|FIN;

|PROCESO Tipo2_cer01; |TIPO 2;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |BUCLE Borra02_cer01;
          |BUCLE Borra03_cer01;
     |FINSI;
|FPRC;

|PROCESO HayAlgo;
     swAlgo = 1;
     nPrimerTra = #2#5;
     |ERROR10;
|FPRC;

|DEFBUCLE HayAlgo;
     #2#1;
     ;
     #0#0, #0#1, 0001;
     #0#0, #0#1, 9999;
     ;
     NULL, HayAlgo;
|FIN;

|PROCESO inferior_cer03;
     #3#0 = #0#0;
     #3#1 = #0#1;
     #3#5 = nPrimerTra;
     #3#7 = 0000;
|FPRC;

|PROCESO superior_cer03;
     #3#0 = #0#0;
     #3#1 = #0#1;
     #3#5 = nPrimerTra;
     #3#7 = 9999;
|FPRC;

|PROCESO inferior_cer02;
     #2#0 = #0#0;
     #2#1 = #0#1;
     #2#5 = 00001;
|FPRC;

|PROCESO superior_cer02;
     #2#0 = #0#0;
     #2#1 = #0#1;
     #2#5 = 99999;
|FPRC;

|PROCESO Carga;
     fFechaAlta = #labtraba#36;
     aAlfa = #labtraba#37;
     |QBF aAlfa;
     |SI aAlfa = ""; |O aAlfa = "..........";
          fFechaBaja = "31.12.2999";
     |SINO;
          fFechaBaja = #labtraba#37;
     |FINSI;

     fFechaIni = #0#3;
     fFechaFin = #0#4;

     |SI fFechaAlta [ fFechaFin; |Y fFechaBaja ] fFechaIni;
          #2#0 = #0#0;
          #2#1 = #0#1;
          #2#2 = #0#2;
          #2#3 = #0#3;
          #2#4 = #0#4;
          #2#5 = #labtraba#1;
          #2#6 = #labtraba#2;
          |GRABA 020#2n;

          #3#0 = #0#0;
          #3#1 = #0#1;
          #3#2 = #0#2;
          #3#3 = #0#3;
          #3#4 = #0#4;
          #3#5 = #labtraba#1;
          #3#6 = #labtraba#2;
          #3#7 = 0000;
          #3#8 = #2#3;
          #3#9 = #2#4;
          #3#10 = 00;
          #3#11 = "Inicio/fin campa¤a trabajador";
          #3#12 = " ";
          |GRABA 020#3n;
     |FINSI;
|FPRC;

|DEFBUCLE Carga;
     #labtraba#1;
     45;
     #0#0, 00001, "300";
     #0#0, 99999, "399";
     ;
     NULL, Carga;
|FIN;

|PROCESO CargaInicial;
     aAlfa = "    SDesea realizar una carga inicial de trabajadores con contratos ";
     aAlfa = aAlfa + " fijos discontinuos?";
     |CONFI aAlfa;
     |SI FSalida = 0;
          |ABRE #2;
          |ABRE #3;
          |BUCLE Carga;
          |CIERRA #3;
          |CIERRA #2;
     |FINSI;
|FPRC;

|PROCESO Muestra; |TIPO 14;
     |ENTLINEAL #1#2, -3, 7, 20, 0, inferior_cer02, superior_cer02;
     |ATRI I;

     nPrimerTra = 0;
     |BUCLE HayAlgo;
     |ENTLINEAL #1#3, -4, 7, 20, 0, inferior_cer03, superior_cer03;
     |ATRI I;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     swAlgo = 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |HAZ CargaInicial;
     |FINSI;
     |BUCLE HayAlgo;
     |ENTLINEAL #1#2, -3, 2, 20, 0, inferior_cer02, superior_cer02;
|FPRC;

|PROCESO Envio;

     aEmpresa = #0#0;
     |QBF aEmpresa;
     aEmpresa = ("00000" + aEmpresa) % -105;

     aCampanya = #0#1;
     |QBF aCampanya;
     aCampanya = ("00000" + aCampanya) % -105;

     aAlfa = "labcer04;"+ aEmpresa + aCampanya;
     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Envio XML";
     |SINO;
          nModo = FEntrada;
          |SI nModo = 0;
               aAlfa = "    ATENCION. Ha de entrar en una campaña para poder generar el fichero.";
               |MENAV aAlfa;
          |SINO;
               |HAZ Envio;
          |FINSI;
     |FINSI;
|FPRC;
