|FICHEROS;
     dsmom073;
     eosm0032;
     eosm0034;
     eosm0035;
|FIN;

|VARIABLES;
     nEjer        = 0;
     nSw          = 0;
     nHayIRPF     = 0;

     &enEjerIRPF  = 0;
     &eaExtension = "";
     &eaPrograma  = "";
|FIN;

|PROCESO BuscaEjerIRPF;
     nEjer       = enEjerIRPF;
     enEjerIRPF  = 0;

     |ABRE #dsmom073;
     #dsmom073#0 = nEjer;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
     |LEE 000#dsmom073.];
     |SI FSalida = 0;
         |SI #dsmom073#0 > nEjer;
             |LEE 000#dsmom073.a;
             |SI FSalida = 0;
                 |SI #dsmom073#0 < nEjer;
                     enEjerIRPF = #dsmom073#0;
                 |FINSI;
             |FINSI;
         |SINO;
             enEjerIRPF = #dsmom073#0;
         |FINSI;
     |SINO;
         |LEE 000#dsmom073.a;
         |SI FSalida = 0;
             enEjerIRPF = #dsmom073#0;
         |FINSI;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;

|PROCESO PatronM073;
     nHayIRPF = 0;
     |ABRE #eosm0032;
     |SELECT #3#eosm0032;
     #eosm0032#1 = 2016;
     #eosm0032#0 = 1;
     |LEE 000#eosm0032.];
     |SI FSalida = 0;  |Y #eosm0032#1 = 2016;
         nHayIRPF = 1;
     |FINSI;
     |CIERRA #eosm0032;

     |SI nHayIRPF = 0;
         |ABRE #eosm0034;
         |SELECT #2#eosm0034;
         #eosm0034#1 = 2016;
         #eosm0034#0 = 1;
         |LEE 000#eosm0034.];
         |SI FSalida = 0;  |Y #eosm0034#1 = 2016;
             nHayIRPF = 1;
         |FINSI;
         |CIERRA #eosm0034;
     |FINSI;

     |SI nHayIRPF = 1;
         |MENAV "0000Se han detectado registros con la version de ejercicio anterior.";
         |MENAV "0000Se va a proceder a su conversion. No interrumpir el proceso";
         |SUB_EJECUTA "eosz0074";
     |FINSI;
|FPRC;
