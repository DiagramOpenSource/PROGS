|FICHEROS;
     labnct18 #0;
|FIN;

|VARIABLES;
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     &swEnviado = 0;
     &eaOpcion = "";
     &eaVengoDe = "";
|FIN;

|PROCESO Tipo13; |TIPO 13;
     |SI eaOpcion = "A";
          |ATRI R;
          |PINTA 0530, "altas";

          |ATRI I;
          |PINTA 0636, "el alta";

          |ATRI R;
          |PINTA 0966, "alta";

          |ATRI 0;
     |FINSI;
     |SI eaOpcion = "B";
          |ATRI R;
          |PINTA 0530, "bajas";

          |ATRI I;
          |PINTA 0636, "la baja";

          |ATRI R;
          |PINTA 0966, "baja";

          |ATRI 0;
     |FINSI;
|FPRC;

|PROCESO Mensa; |TIPO 7;
     |SI eaOpcion = "A";
          |MENSA "    Pulse < F5 > para enviar el alta del trabajador seleccionado ";
     |FINSI;
|FPRC;

|PROCESO Envia; |TIPO 0;
     |SI FSalida = 13;
          aAlfa1 = #0#0; |QBF aAlfa1; aAlfa1 = ("00000" + aAlfa1) % -105;
          aAlfa2 = #0#1; |QBF aAlfa2; aAlfa2 = ("00000" + aAlfa2) % -105;
          aAlfa = aAlfa1 + aAlfa2;
          |SI eaOpcion = "A";
               aAlfa = "labnct07;"+ "01" + aAlfa;
          |FINSI;
          |SI eaOpcion = "B";
               aAlfa = "labnct07;"+ "02" + aAlfa;
          |FINSI;
          eaVengoDe = "labnct08";

          |SUB_EJECUTA aAlfa;

          |SI swEnviado = 1;
               #0#6 = "*";
               |PINTA #0#6;
               |GRABA 000#0a;

               |LEE 000#0p;
               |PONCONTROL 23, "si";
          |FINSI;
     |FINSI;
|FPRC;
