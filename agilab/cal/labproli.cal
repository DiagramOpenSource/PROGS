|FICHEROS;
    labproli #0;
    labempre #1;
    labtraba #2;
    labcentr #3;
    labregis #4;
    labclaus #5;
    nomregim #6;
    labcontr #10;
    labpanta #11;
    labproco #12;
    labacuer #87;
    labdicoc #89;
    labdicol #90;

     labhisto #500;
     labmunic #8;
     nomcenes #13;
     nomcalca;
     pdfdocca;
     pdfdocli;
     pdfimtmp #100;
     labclafi;
|FIN;

|VARIABLES;
     nAcuerdo = 0;
     &nTipoSalida = 0;
     &nTipoImpre  = 0;
     &nNroCopias  = 0;

 {-1}histo = "";
     histo1 = "2318";
     histo2 = "1";
     histo3 = "";
     histo4 = "VIG";
     histo5 = " Vista Previa ";
     histo6 = " Imprimir     ";
     histo7 = " Guardar      ";

     &enNumRegis = 0;
     &eaNumProrr = 0;
     aCodigoC1   = "";
     aCodigoC2   = "";
     aCodigoC3   = "";

     aTmp = "";
     nclaus = 0;
     nCuantos = 0;
     nLimiteClau = 0;
     &swAnexoClaus = 0;
     &topeclaus = 0;
     nNume = 0;
     aNume = "";
     nLimReal = 0;
     nCampo = 0;
     aParaI = "";
     ParaI = 0;
     &nContador = 0;
     &nVoypor = 0;
     nNCA = 0;
     aEmp = "";
     aTra = "";
     aCon = "";
     registro = "";
     aProcedencia = "";

     &aListaFich = "";
     nAscii = 0;
     aCaracter = "";
     aCaracterSal =  "";
     aLongitud = "";
     nLongitud = 0;
     nPos = 0;
     nBusca = 0;
     aCadena = "";
     aCadenaSal = "";
     &ctacot = "";
     &infor_pro = "";
     &nPaisTrabaja = 0;
     nTipo = 0;
     aCampo = "";
     aValor = "";
     aAlfa = "";
     aAlfa1 = "";
     nPais = 0;
     &nLabHisto = 0;
     &swCopia = 0;
     nOpcion = 0;
     nCalc = 0;
     nCont = 0;
     nCont1 = 0;
     &aArchivo = "";

     aPaisEmpresa = "";
     &nPaisEmpresa = 0;
     aPaisCentro = "";
     &nPaisCentro = 0;
     aPaisTrabaja = "";
     aPED1 = "";
     aPED2 = "";
     aPED3 = "";
     aPCD1 = "";
     aPCD2 = "";
     aPCD3 = "";
     aPTD1 = "";
     aPTD2 = "";
     aPTD3 = "";
     aProvincia = "";
     &aCodCCC = "";
     aCPRD1 = "";
     aCPRD2 = "";
     aDigControl = "";
     aDC1 = "";
     aDC2 = "";

     aCodPostal1 = "";
     aCodPostal2 = "";
     aAlfa2 = "";
     aMuni  = "";
     nContMuni = 0;
     &nMensajeF5 = 0;
     &aCodigoMunicipio = "";
     aCodMuni = "";
     &aCodPos = "";
     aCPED1 = "";
     aCPED2= "";
     aCPED3= "";
     aCPED4= "";
     aCPED5= "";
     aCodMuniE = "";
     aCodMuniT = "";
     aCodMuniC = "";
     aRegimen = "";


    teclado = 0;
    nume1 = 0;
    nume2 = 0;
    fecinic = @;
    mod = 0;
    diasfin = 0;
    verrfec = "0000ATENCION Fecha erronea";
    vdia1 = "";
    vme1 = "";
    vany1 = "";
    vdia = 0;
    vme = 0;
    vany = 0;
    vtope = 0;
    vsw = 0;
    vfec = "";
    vblanco = "          ";
    vpuntos = "..........";
    informe = "labproli";
    informe1 = "labplli1";
    informe2 = "labplli2";
    informe3 = "labplli3";
    mensa1 = "    No existe empresa";
    mensa2 = "    No existe trabajador";
    mensa3 = "    No existe centro trabajo";
    mensa6 = "    AVISO !!! Periodo acumulado superior a 48 meses o datos erroneos ...";
    mensa8 = "    No existe clausula";
    mensa9 = "    Tipo de contrato improrrogable ...";
    mensa0 = "    Prorroga no efectiva sobre contrato 57 ...";
    mensaA = "    ATENCION! Dato erroneo, centro de trabajo distinto al del trabajador ...";
    &contador = 0;
    fecreal = @;
    fecnume = 0;
    fecalfa = "";
    fectope = "";
    diaalfa = "";
    mesalfa = "";
    anyalfa = "";
    dianume = 0;
    mesnume = 0;
    anynume = 0;
    topemes = 0;
    diashas = 0;
    diastop = 0;
    diaprimer = 0;
    mesprimer = 0;
    duracio = 0;
    nada = "";
    z = 0;
    &coma = ",";
    &dia = "";             || fecha presentacion desglosada
    &mes = "";
    &anyo = "";
    dia1 = "";            || variables trabajo fecha
    any1 = "";
    fec1 = "";
    fec2 = 0;
    &prorro = "";
    &duracion = "";
    &contra = " ";
    and = " y ";
    c = "";
    &dura = "";
    direcc = "";
    numero = "";
    piso = "";
    cod1 = "";
    cod2 = "";
    locali = "";
    &domemp = "";
    &domtra = "";
    &domcen = "";
    linepunt = "";
    punt = ".";
    barra = "  /";
    compactado = "";
    check = 0;
    menos = 0;
    mensaB = "    No existen parametros de control !!! Usando defectos ...";
    mensaC = "    A IMPRIMIR PLAN DE FORMACION (HOJA 1) ...";
    mensaD = "    A IMPRIMIR PLAN DE FORMACION (HOJA 2) ...";
    mensaE = "    A IMPRIMIR PLAN DE FORMACION (HOJA 3) ...";
    mensaF = "    No existe Plan de Formacion !!!";
    mensaG = "    Registro de contrato de este trabajador YA EXISTENTE !!";
    aponer = "";
    fiac = "";
    relleno = "                                                 ";
    sistema = @;
    hojaplan = 0;
    &edadalum = 0;
    diasini = 0;
    diasven = 0;
    diasdur = 0;
    razon = 0;
    nacitra = 0;
    actutra = 0;
    edadtra = 0;
    anyotra = 0;
    fechtra = "";
    &x1 = "";
    &x2 = "";
    &x3 = "";
    &x4 = "";
    durdia = 0;
    durmes = 0;
    durini = "";
    durfin = "";
    tranum = 0;
    alfa1 = "";
    &sconvenio = "";
    FEstado = 0;
    inkey = 0;
    &des87 = @;
    &has87 = @;
    &tipo87 = "";
     nLon = 0;
     aLon = "";
     nLon2 = 0;
     aLon2 = "";
     swError = 0;
|FIN;

|INCLUYE pastil_i;

|PROCESO CompNroINEM;      || compruebo que sea numerico
     swError = 0;
     aAlfa = #0Campo;
     |QBF aAlfa;
     aLon = aAlfa % 0;
     nLon = aLon;
     nNume = #0Campo;
     |SI nNume = 0; |Y aLon ! 0;
          swError = 1;
     |FINSI;

     aAlfa = nNume;
     aAlfa2 = #0Campo;
     |PARA; |SI; |HACIENDO;
          alfa1 = aAlfa2 % 101;
          |SI alfa1 = "0";
               aAlfa = "0" + aAlfa;
               aAlfa2 = aAlfa2 - "0";
          |SINO;
               |SAL;
          |FINSI;
     |SIGUE;
     aLon2 = aAlfa % 0;
     nLon2 = aLon2;
     |SI nLon ! nLon2; |Y nNume ! 0;
          swError = 1;
     |FINSI;

     |SI swError = 1;
          |MENAV "    ATENCION: Nro. de Contrato NO valido. Ha de ser un valor numerico";
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO tipo8; |TIPO 8;
                    || si 'infor_pro' viene cargada prevalece
                    ||/sobre el PARAMETRO
                    || en D.O.S. y con SUB_EJECUTA (agiett) el PARAMETRO
                    ||/no funciona
|SI infor_pro = "";
        alfa1 = PARAMETRO;
    |QBF alfa1;
    |SI alfa1 = "";
            infor_pro = "labproli";
    |SINO;
            infor_pro = alfa1;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO AnexoClaus;
     |SI #0#31 ! 0;
          |ABRE #5;
          #5#1 = #0#31;
          |LEE 000#5=;
          |SI FSalida = 0;
               nTipo = 0;
               |PARA ParaI = 1; |SI ParaI [ 18; |HACIENDO ParaI = ParaI + 1;
                    aParaI = ParaI;
                    aParaI = "00" + aParaI;
                    aAlfa = aParaI % -102;
                    aCampo = "clausula" + aAlfa;
                    aAlfa = aCampo % 108;
                    |SI aAlfa = "clausula";
                         aAlfa = aCampo % -102;
                         nNume = aAlfa;
                         |SI nNume [ 18; |Y nVoypor = 1;    || pa que coja las 1as. 18
                              |SI nNume [ 5;
                                   nCampo = nNume + 24;
                                   aValor = #0#nCampo#;   || clausulas del def
                              |SINO;
                                   nCampo = nNume + 2;
                                   aValor = #5#nCampo#;   || clausulas del def
                              |FINSI;
                              |SI aValor = "";
                                   aValor = "......";
                              |FINSI;
                              |HAZ GrabaTemporal;           || por si algo cambia
                         |SINO;
                              #labclafi#0 = nNume + (40 * (nVoypor - 1));
                              |LEE 000#labclafi.=;
                              |SI FSalida = 0;
                                   aValor = #labclafi#1;
                                   |HAZ GrabaTemporal;
                              |FINSI;
                         |FINSI;
                    |FINSI;
               |SIGUE;
          |FINSI;
          |CIERRA #5;
     |FINSI;


     aCampo = "localidad";  || Localidad firma
          aValor = #0#21;
          |HAZ GrabaTemporal;
      aCampo = "dia";  || DIA FIRMA
          aValor = dia;
          |HAZ GrabaTemporal;
      aCampo = "mes";  || MES FIRMA
          aValor = mes ;
          |HAZ GrabaTemporal;
      aCampo = "anyo";  || ANYO FIRMA
          aValor = anyo ;
          |HAZ GrabaTemporal;
      aCampo = "pagina";  || PAGINA
          aAlfa1 = nVoypor;
          aAlfa2 = nNCA;
          aValor = "P\341gina " + aAlfa1 + " de " + aAlfa2;
          |HAZ GrabaTemporal;
      aCampo = "registro";
          aEmp = #0#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #0#1; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;
      swCopia = 1;
           aCampo = "trabajador";  || NOMBRE DEL TRABAJADOR TRABAJADOR
               aValor = #labtraba#2;
               |HAZ GrabaTemporal;
           aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
               aValor = #labtraba#20;
               |HAZ GrabaTemporal;

          ||AML
           aCampo = "repre_emp";  || NOMBRE REPRESENTANTE EMPRESA
               aValor = #labempre#15;
               |HAZ GrabaTemporal;
          ||FIN AML

          aCampo = "copiabasica";
               aValor = "";
               |HAZ GrabaTemporal;
           aCampo = "firma1";
               aValor = "El/la trabajador/a";
               |HAZ GrabaTemporal;
           aCampo = "firma2";
               aValor = "El/la representante de la empresa";
               |HAZ GrabaTemporal;
           aCampo = "firma3";
               aValor = "El/la representante legal del menor, si procede";
               |HAZ GrabaTemporal;

|FPRC;

|PROCESO ImpresionAnx;

          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;
          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;
          |ABRE #pdfdocca;
          |ABRE #pdfdocli;
          |ABRE #labclafi;

          aArchivo = "anexoclaus.pdf";

          |HAZ AnexoClaus;

          |CIERRA #labclafi;
          |CIERRA #pdfimtmp;
          |CIERRA #pdfdocca;
          |CIERRA #pdfdocli;

          |SUB_EJECUTA "pdfgraba";
|FPRC;




|PROCESO CuentaMunicipio;
     nContMuni = nContMuni + 1;
     aCodMuni = #labmunic#1;
|FPRC;

|DEFBUCLE CuentaMunicipio;
     #8#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,CuentaMunicipio;
|FIN;

|PROCESO BuscaMunicipio;
     aAlfa2 = #8#3;            || aAlfa2 = municipio de labmunic
     |QBT aAlfa2;
     aMuni = #labempre#6;   || aMuniEmp = municipio de labempre
     aMuni = aMuni > "";
     |QBT aMuni;

     aAlfa = aMuni - aAlfa2;
     |SI aAlfa ! aMuni;
          ||aAlfa2 esta en aMuni
          aCodMuni = #8#1;
          nContMuni = nContMuni + 1;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaMunicipio;
     #8#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,BuscaMunicipio;
|FIN;



|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;             || el caracter  
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;             || el caracter ‚
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;             || el caracter ¡
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162; |O nAscii = 243;            || el caracter ¢
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;             || el caracter £
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;             || el caracter ¤
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 241;             || el caracter ¤ (otro codigo ¨?)
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 165;             || el caracter ¥
          aCaracterSal = "\321";
     |FINSI;
     |SI nAscii = 129;
          aCaracterSal = "\374";   || el caracter u con dieresis
     |FINSI;
     |SI nAscii = 154;
          aCaracterSal = "\334";   || el caracter U (mayuscula) con dieresis
     |FINSI;
     |SI nAscii = 167;
          aCaracterSal = "\272";   || el caracter §
     |FINSI;
     |SI nAscii = 166;
          aCaracterSal = "\252";   || el caracter ¦
     |FINSI;
     |SI aCaracter = "(";
          aCaracterSal = "\(";
     |FINSI;
     |SI aCaracter = ")";
          aCaracterSal = "\)";
     |FINSI;
|FPRC;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO CodigoMuni;
     nContMuni = 0;
     |BUCLE CuentaMunicipio;

     |SI nContMuni > 1;
          nContMuni = 0;
          |BUCLE BuscaMunicipio;
          |SI nContMuni > 1;
               nMensajeF5 = 1;
               aCodigoMunicipio = "";
               |SUB_EJECUTA "labmunic";
               |SI aCodigoMunicipio ! "";
                    aCodMuni = aCodigoMunicipio;
                    nContMuni = 1;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI nContMuni = 0;
          nMensajeF5 = 1;
          aCodigoMunicipio = "";
          |SUB_EJECUTA "labmunic";
          |SI aCodigoMunicipio ! "";
               aCodMuni = aCodigoMunicipio;
               nContMuni = 1;
          |FINSI;
     |FINSI;
     ||ahora se supone que en aCodMuni tenemos el codigo del municipio
|FPRC;


|PROCESO GrabaTemporal;
     aAlfa1 = aValor % 101;
     |SI aAlfa1 = ".";
          aValor = "";
     |FINSI;
     |QBF aValor;
     aCadena = aValor;
     |HAZ sustituye;
     aValor = aCadenaSal;
     #pdfimtmp#0 = aCampo;
     #pdfimtmp#1 = aValor;
     #pdfimtmp#2 = nTipo;
     |GRABA 020#pdfimtmp.n;
|FPRC;

|PROCESO CentroEspecial;
     |DDEFECTO #13;
     |ABRE #13;
     #13#0  = #2#0;   || empresa
     #13#13 = #2#77;  || centro
     |SI #2#45 = "097";|O #2#45 = "085";|O #2#45 = "421";
          #13#1 = "87";
     |SINO;
          |SI #2#45 = "065";
               #13#1  = "64";
          |SINO;
               #13#1  = #2#45 % 2;
          |FINSI;
     |FINSI;
     |LEE 000#13=;
     |SI FSalida ! 0;
          |SI #2#45 = "087";|O #2#45 = "097";|O #2#45 = "085";|O #2#45 = "421";
                            |O #2#45 = "064";|O #2#45 = "065";
               |MENAV "    AVISO! Centro Especial de trabajo INEXISTENTE ...";
          |FINSI;
     |FINSI;
     |CIERRA #13;
|FPRC;

|PROCESO Centro;
     |DDEFECTO #3;
     |ABRE #3;
     #3#0 = #2#0;
     #3#1 = #2#77;
     |LEE 000#3=;
     |SI FSalida ! 0;|Y #2#45 ! "064";|Y #2#45 ! "065";
                     |Y #2#45 ! "087";|Y #2#45 ! "097";|Y #2#45 ! "085";|Y #2#45 ! "421";
          |MENAV "    AVISO! Centro de trabajo INEXISTENTE ...";
     |FINSI;
     |CIERRA #3;
|FPRC;


|PROCESO CuentaCotizacion;
     |SI #2#45 = "087";|O #2#45 = "097";|O #2#45 = "085";|O #2#45 = "421";
                       |O #2#45 = "064";|O #2#45 = "065";
          ctacot = #13#10;
     |SINO;
          ctacot = #3#10;
     |FINSI;
|FPRC;

|PROCESO CodigosMunicipio;
     aCodPos = aCPED1 + aCPED2 + aCPED3 + aCPED4 + aCPED5;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio de la empresa inaccesible.";
          aCodMuniE = "00000";
     |SINO;
          aCodMuniE = aCodMuni;
     |FINSI;

     aAlfa1 = #labtraba#8;    aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa = #labtraba#9;     aAlfa = ("000" + aAlfa) % -103;
     aCodPos = aAlfa1 + aAlfa;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio del trabajador inaccesible.";
          aCodMuniT = "00000";
     |SINO;
          aCodMuniT = aCodMuni;
     |FINSI;

     aAlfa1 = #labcentr#7;    aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa = #labcentr#8;     aAlfa = ("000" + aAlfa) % -103;
     aCodPos = aAlfa1 + aAlfa;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio del centro inaccesible.";
          aCodMuniC = "00000";
     |SINO;
          aCodMuniC = aCodMuni;
     |FINSI;
|FPRC;


|PROCESO varios1;
     |DDEFECTO #3;
     |ABRE #3;
     #3#0 = #0#0;
     #3#1 = #0#2;
     |LEE 000#3=;
     |SI FSalida ! 0;
         |MENAV "    Centro de Trabajo inexistente ...";
     |FINSI;
     |CIERRA #3;
     aCodCCC = #3#10;

     |SI #0#14 = "087";|O #0#14 = "064";|O #0#14 = "085";|O #0#14 = "065";|O #0#14 = "421";
         |ABRE #13;
         |DDEFECTO #13;
             #13#0 = #2#0;         || empresa
             #13#13 = #2#77;       || centro
         |SI #0#14 = "085"; |O #0#14 = "421"; #13#1 = "87"; |FINSI;
         |SI #0#14 = "064"; #13#1 = "64"; |FINSI;
         |SI #0#14 = "065"; #13#1 = "64"; |FINSI;
         |LEE 000#13=;
         |SI FSalida ! 0;
                 alfa1 = "    Centro Especial de Contratacion [" + #13#1 + "] inexistente ...";
             |MENAV alfa1;
         |FINSI;
         |CIERRA #13;
         aCodCCC = #13#10;
     |FINSI;
|FPRC;



|PROCESO CargaCampos;
     nTipo = 5;
     aCampo = "clausadici";
     aAlfa = aCampo;
     nLimiteClau = 5;
     |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
          nCampo = nNume + 24;
          aValor = #0#nCampo#;
          |QBF aValor;
          |SI aValor = "";
               nNume = nNume - 1;
               |SI nNume > nLimiteClau;
                    swAnexoClaus = 1;
               |FINSI;
               |SAL;
          |FINSI;
          |SI nCampo = 29;
               |SI aValor ! ""
                    swAnexoClaus = 1;
               |FINSI;
          |FINSI;
     |SIGUE;
     |SI swAnexoClaus = 0;
          nLimReal = nNume;
          |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
               aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
               aCampo = aAlfa + aNume;
               nCampo = nNume + 24;
               aValor = #0#nCampo#;
               |QBF aValor;
               |HAZ GrabaTemporal;
          |SIGUE;
     |SINO;                    ||PONEMOS EL MENSAJE DE VER EN HOJA ADJUNTA Y TODAS LAS CLAUSULAS EN BLANCO->""
          nLimReal = nNume;
          |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
               aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
               aCampo = aAlfa + aNume;
               nCampo = nNume + 24;
               |SI nNume = 1;
                    aValor = "                                 .- Ver en hoja adjunta.";
               |SINO;
                    aValor = "";
                    |QBF aValor;
               |FINSI;
               |HAZ GrabaTemporal;
          |SIGUE;
     |FINSI;

     aCampo = "Identificador";
     aAlfa = #0#17;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;

     nTipo = 0;
     |HAZ varios1;
     || PROVINCIA CTA. COTIZACION.

     aProvincia = aCodCCC;
     |QBF aProvincia;
     aProvincia = aProvincia % 102;
     aProvincia = "00" + aProvincia;
     aProvincia = aProvincia % -102;
     aCPRD1 = aProvincia % 101;
     aCPRD2 = aProvincia % 201;

     || DIGITO CONTROL CTA.COTIZACION

     aDigControl = aCodCCC;
     |QBF aDigControl;
     aDigControl = aDigControl % 1002;
     aDigControl = "00" + aDigControl;
     aDigControl = aDigControl % -102;
     aDC1 = aDigControl % 101;
     aDC2 = aDigControl % 201;

     aCampo = "comentarios1";
     aAlfa = #0#43;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;

     aCampo = "comentarios2";
     aAlfa = #0#44;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios3";
     aAlfa = #0#45;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios4";
     aAlfa = #0#46;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios5";
     aAlfa = #0#47;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios6";
     aAlfa = #0#48;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios7";
     aAlfa = #0#49;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios8";
     aAlfa = #0#50;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     aCampo = "comentarios9";
     aAlfa = #0#51;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;





     aCampo = "provniss1";
     aValor = aCPRD1;
     |HAZ GrabaTemporal;

     aCampo = "provniss2";
     aValor = aCPRD2;
     |HAZ GrabaTemporal;

     aCampo = "digcon1";
     aValor = aDC1;
     |HAZ GrabaTemporal;

     aCampo = "digcon2";
     aValor = aDC2;
     |HAZ GrabaTemporal;

     aCampo = "numniss";
     aValor = aCodCCC % 307;
     |HAZ GrabaTemporal;

     || Codigo de Pais de Empresa, Centro y Trabajador

     aPaisEmpresa = nPaisEmpresa;
     || aPaisEmpresa = "000" + aPaisEmpresa;
     aPaisEmpresa = "724";
     aPaisEmpresa = aPaisEmpresa % -103;

     aPaisCentro = nPaisCentro;
     || aPaisCentro = "000" + aPaisCentro;
     aPaisCentro = "724";
     aPaisCentro = aPaisCentro % -103;

     aAlfa = #labtraba#7; aAlfa = aAlfa % 0101;
     |SI aAlfa = "X"; |O aAlfa = "Y"; |O aAlfa = "Z";
           aAlfa = #labtraba#76; aAlfa = aAlfa % 0103;
           nPaisTrabaja = aAlfa;
     |SINO;
           nPaisTrabaja = 724;
     |FINSI;

     aPaisTrabaja = nPaisTrabaja;
     || aPaisTrabaja = "000" + aPaisTrabaja;
     aPaisTrabaja = "724" + aPaisTrabaja;
     aPaisTrabaja = aPaisTrabaja % -103;

     aPED1 = aPaisEmpresa % 101;   || pais empresa digito 1
     aPED2 = aPaisEmpresa % 201;   || pais empresa digito 2
     aPED3 = aPaisEmpresa % 301;   || pais empresa digito 3
     aPCD1 = aPaisCentro % 101;    || pais centro digito 1
     aPCD2 = aPaisCentro % 201;    || pais centro digito 2
     aPCD3 = aPaisCentro % 301;    || pais centro digito 3
     aPTD1 = aPaisTrabaja % 101;    || pais trabajador digito 1
     aPTD2 = aPaisTrabaja % 201;    || pais trabajador digito 2
     aPTD3 = aPaisTrabaja % 301;    || pais trabajador digito 3

     aCampo = "codpaisem1";
     aValor = aPED1;
     |HAZ GrabaTemporal;

     aCampo = "codpaisem2";
     aValor = aPED2;
     |HAZ GrabaTemporal;

     aCampo = "codpaisem3";
     aValor = aPED3;
     |HAZ GrabaTemporal;

     aCampo = "codpaisct1";
     aValor = aPCD1;
     |HAZ GrabaTemporal;

     aCampo = "codpaisct2";
     aValor = aPCD2;
     |HAZ GrabaTemporal;

     aCampo = "codpaisct3";
     aValor = aPCD3;
     |HAZ GrabaTemporal;

     aCampo = "codnactra1";
     aValor = aPTD1;
     |HAZ GrabaTemporal;

     aCampo = "codnactra2";
     aValor = aPTD2;
     |HAZ GrabaTemporal;

     aCampo = "codnactra3";
     aValor = aPTD3;
     |HAZ GrabaTemporal;

     aCampo = "codpaisdomtr1";
     aValor = "7";
     |HAZ GrabaTemporal;

     aCampo = "codpaisdomtra2";
     aValor = "2";
     |HAZ GrabaTemporal;

     aCampo = "codpaisdomtr3";
     aValor = "4";
     |HAZ GrabaTemporal;

     |SI nLabHisto = 1;
          |HAZ litedura;
     |FINSI;
     aCampo = "mesesdurapro";
     aValor = duracion;
     |HAZ GrabaTemporal;

     aCampo = "munifirma";
     aValor = #0#21;
     |HAZ GrabaTemporal;

     aCampo = "registro";
     aAlfa1 = #0#0;
     aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa = aAlfa1 + " / ";
     aAlfa1 = #0#1;
     aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa = aAlfa + aAlfa1 + " / ";
     aAlfa1 = contador;
     aAlfa1 = ("000000" + aAlfa1) % -106;
     aAlfa = aAlfa + aAlfa1;
     aValor = aAlfa;
     |HAZ GrabaTemporal;

     aCampo = "modelocont";
     aValor = #0#12;
     |HAZ GrabaTemporal;

     aCampo = "rdcont";
     aValor = #0#13;
     |HAZ GrabaTemporal;

     aCampo = "nombsepe";
     aValor = #0#3;
     |HAZ GrabaTemporal;

     aCampo = "fechainipro";
     aValor = #0#7;
     |HAZ GrabaTemporal;

     aCampo = "fechaterpro";
     aValor = #0#8;
     |HAZ GrabaTemporal;

     aCampo = "fechainicont";
     aValor = #0#9;
     |HAZ GrabaTemporal;

     aCampo = "oecomcont";
     aValor = #0#15;
     |HAZ GrabaTemporal;

     aCampo = "fecharegcont";
     aValor = #0#16;
     |HAZ GrabaTemporal;

     aCampo = "idcontconv";
     aValor = #0#17;
     |HAZ GrabaTemporal;

    |SI FSalida = 0;
        |ABRE #2;
            #2#0 = #0#0;
            #2#1 = #0#1;
        |LEE 101#2=;
        |SI FSalida = 0;
            |ABRE #nomcalca;
            |SI #4#20 ! "          "; |Y #4#20 ! "..........";
                #2#37 = #4#20;    || actualiza fecha de baja
                ||BUCLE nomcalca;  || actualiza fecha baja nomcalca
            ||GRABA 020#2a;
            |FINSI;
            aCampo = "nomtrab";
            aValor = #2#2;
            |HAZ GrabaTemporal;

            aCampo = "codnivaca1";
            aValor = #2#73; |QBF aValor; aValor = "00" + aValor;
            aValor = aValor % -201;
            |HAZ GrabaTemporal;

            aCampo = "codnivaca2";
            aValor = #2#73; |QBF aValor; aValor = "00" + aValor;
            aValor = aValor % -101;
            |HAZ GrabaTemporal;

            aCampo = "nombdtosempresa";
            aValor = #2#20;
            |HAZ GrabaTemporal;

            aCampo = "nifempresa";
            aValor = #2#22;
            |HAZ GrabaTemporal;

            aCampo = "repre empresa";
            aValor = #2#23;
            |HAZ GrabaTemporal;

            aCampo = "trabajador";
            aValor = #2#2;
            |HAZ GrabaTemporal;

            aCampo = "repre_legal";
            aValor = #2#20;
            |HAZ GrabaTemporal;

            aCampo = "dnitra";
            aValor = #2#7;
            |HAZ GrabaTemporal;

            aCampo = "fechanac";
            aValor = #2#11;
            |HAZ GrabaTemporal;

            aCampo = "numafinss";
            aValor = #2#75;
            |HAZ GrabaTemporal;

            aCampo = "litnivaca";
            aValor = #2#12;
            |HAZ GrabaTemporal;


        |FINSI;
        |LIBERA #2;
        |CIERRA #2;
        ||LIBERA #nomcalca;
        |CIERRA #nomcalca;
    |FINSI;
    |LIBERA #4;
    |CIERRA #4;

    |HAZ Centro;        || conocer la cuenta cotizacion, esto es el cambio
    |HAZ CentroEspecial;
    |HAZ CuentaCotizacion;

    |HAZ domicili;
    |HAZ decodifi;
    |HAZ diasmese;
    |HAZ lee_regimen;

     aRegimen = aAlfa;
     aRegimen = "00" + aRegimen;
     aRegimen = aRegimen % -104;

     aCampo = "regimen1";
     aAlfa = aRegimen % 101;
     aValor = aAlfa;
     |HAZ GrabaTemporal;

     aCampo = "regimen2";
     aAlfa = aRegimen % 201;
     aValor = aAlfa;
     |HAZ GrabaTemporal;

     aCampo = "regimen3";
     aAlfa = aRegimen % 301;
     aValor = aAlfa;
     |HAZ GrabaTemporal;

     aCampo = "regimen4";
     aAlfa = aRegimen % 401;
     aValor = aAlfa;
     |HAZ GrabaTemporal;

        p_imp = #0#7;
    |HAZ pastilla;
    |SI p_cen = 0;
        |PARA z = 1; |SI z [ #0#20; |HACIENDO z = z + 1;
            ||INFOR infor_pro;
            |SI FSalida = 0;
                ||PRINT;
                ||PIEINF;
                ||FININF;
            |SINO;
                    alfa1 = "    Informe [" + infor_pro + "] inaccesible ...";
                |MENAV alfa1;
            |FINSI;
        |SIGUE;
        |HAZ el_acuerdo;
    |FINSI;
        alfa1 = #3#12;
    |QBF alfa1;
    |SI alfa1 ! "NO EXISTE"; |Y alfa1 ! "";
        |PINPA #2#11;
        |AVISO;
        |PAUSA;
    |FINSI;
|HAZ CodigosMunicipio;
aCampo = "codmuniem1";
aValor = aCodMuniE % 101;
|HAZ GrabaTemporal;

aCampo = "codmuniem2";
aValor = aCodMuniE % 201;
|HAZ GrabaTemporal;

aCampo = "codmuniem3";
aValor = aCodMuniE % 301;
|HAZ GrabaTemporal;


aCampo = "codmuniem4";
aValor = aCodMuniE % 401;
|HAZ GrabaTemporal;

aCampo = "codmuniem5";
aValor = aCodMuniE % 501;
|HAZ GrabaTemporal;

aCampo = "codmunitra1";
aValor = aCodMuniT % 101;
|HAZ GrabaTemporal;

aCampo = "codmunitra2";
aValor = aCodMuniT % 201;
|HAZ GrabaTemporal;

aCampo = "codmunitra3";
aValor = aCodMuniT % 301;
|HAZ GrabaTemporal;

aCampo = "codmunitra4";
aValor = aCodMuniT % 401;
|HAZ GrabaTemporal;

aCampo = "codmunitra5";
aValor = aCodMuniT % 501;
|HAZ GrabaTemporal;

aCampo = "codmunict1";
aValor = aCodMuniC % 101;
|HAZ GrabaTemporal;

aCampo = "codmunict2";
aValor = aCodMuniC % 201;
|HAZ GrabaTemporal;

aCampo = "codmunict3";
aValor = aCodMuniC % 301;
|HAZ GrabaTemporal;

aCampo = "codmunict4";
aValor = aCodMuniC % 401;
|HAZ GrabaTemporal;

aCampo = "codmunict5";
aValor = aCodMuniC % 501;
|HAZ GrabaTemporal;


|FPRC;

|PROCESO ImpreAcuerdo;
  |DDEFECTO #87;
       #87#14 = #0#3;   || oficina empleo contrato
       #87#15 = #0#21;  || localidad contrato

  |ABRE #87;
       #87#0 = #0#0;
       #87#1 = #0#1;
  |LEE 101#87=;
  |SI FSalida = 0;
     nTipo = 0;
     aCampo = "razonsocialempresa";
          aValor = #labempre#2;
          |HAZ GrabaTemporal;
     aCampo = "cIF empresa";
          aValor = #labempre#10;
          |HAZ GrabaTemporal;
     aCampo = "direccion empresa";
          aValor = #labempre#3;
          |HAZ GrabaTemporal;
     aCampo = "localidad empresa";
          aValor = #labempre#6;
          |HAZ GrabaTemporal;
     aCampo = "C.P. empresa";
         || aAlfa1 = #labacuer#19; aAlfa1 = "000" + aAlfa1; aAlfa1 = aAlfa1 % -103;
         || aAlfa2 = #labacuer#20; aAlfa2 = "00" + aAlfa2; aAlfa2 = aAlfa2 % -102;

          aAlfa1 = #labempre#7; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
          aAlfa2 = #labempre#8; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

          aAlfa = aAlfa1 + aAlfa2;
          aValor = aAlfa
          |HAZ GrabaTemporal;
     aCampo = "provincia empresa";
          aValor = #labempre#9;
          |HAZ GrabaTemporal;
     aCampo = "persona contacto empresa";
          aValor = #labacuer#35;
          |HAZ GrabaTemporal;
     aCampo = "telefono empresa";
          aValor = #labempre#111;
          |HAZ GrabaTemporal;
     aCampo = "fax empresa";
          aValor = #labacuer#36;
          |HAZ GrabaTemporal;
     aCampo = "e-mail empresa";
          aValor = #labacuer#37;
          |HAZ GrabaTemporal;
     aCampo = "nombre centro";
          aValor = #labacuer#2;
          |HAZ GrabaTemporal;
     aCampo = "identif centro1";
          aValor = #labacuer#23 % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif centro2";
          aValor = #labacuer#23 % 201;
          |HAZ GrabaTemporal;
     aCampo = "identif centro3";
          aValor = #labacuer#23 % 301;
          |HAZ GrabaTemporal;
     aCampo = "identif centro4";
          aValor = #labacuer#23 % 401;
          |HAZ GrabaTemporal;
     aCampo = "identif centro5";
          aValor = #labacuer#23 % 501;
          |HAZ GrabaTemporal;
     aCampo = "identif centro6";
          aValor = #labacuer#23 % 601;
          |HAZ GrabaTemporal;
     aCampo = "identif centro7";
          aValor = #labacuer#23 % 701;
          |HAZ GrabaTemporal;
     aCampo = "razon social centro";
          aValor = #labacuer#22;
          |HAZ GrabaTemporal;
     aCampo = "CIF centro";
          aValor = #labacuer#3;
          |HAZ GrabaTemporal;
     aCampo = "Direccion centro";
          aValor = #labacuer#4;
          |HAZ GrabaTemporal;
     aCampo = "localidad centro";
          aValor = #labacuer#21;
          |HAZ GrabaTemporal;
     aCampo = "CP centro";
          aAlfa1 = #labacuer#19; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
          aAlfa2 = #labacuer#20; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

         || aAlfa1 = #labacuer#19;
         || aAlfa2 = #labacuer#20;
          aAlfa = aAlfa1 + aAlfa2;
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     aCampo = "provincia centro";
          aValor = #labacuer#24;
          |HAZ GrabaTemporal;
     aCampo = "persona contacto centro";
          aValor = #labacuer#6;
          |HAZ GrabaTemporal;
     aCampo = "telefono centro";
          aValor = #labacuer#5;
          |HAZ GrabaTemporal;
     aCampo = "fax centro";
          aValor = #labacuer#25;
          |HAZ GrabaTemporal;
     aCampo = "e-mail centro";
          aValor = #labacuer#26;
          |HAZ GrabaTemporal;
     aCampo = "nombre trab";
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     aCampo = "fecha nacimi. traba";
          aValor = #labtraba#11;
          |HAZ GrabaTemporal;
     aCampo = "DNI trab";
          aValor = #labtraba#7;
          |HAZ GrabaTemporal;
     aCampo = "domicilio trab";
          aValor = #labtraba#3;
          |QBF aValor;
          aValor = aValor + ", " + #labtraba#4;
          |HAZ GrabaTemporal;
     aCampo = "telefono trabaj";
          aValor = #labtraba#244;
          |HAZ GrabaTemporal;
     aCampo = "localidad trabaj";
          aValor = #labtraba#6;
          |HAZ GrabaTemporal;
     aCampo = "CP trabaja";
          aAlfa1 = #labtraba#8; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
          aAlfa2 = #labtraba#9; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

          ||aAlfa1 = #labtraba#8;
          ||aAlfa2 = #labtraba#9;
          aAlfa = aAlfa1 + aAlfa2;
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     aCampo = "provincia trabj";
          aValor = #labtraba#10;
          |HAZ GrabaTemporal;
     aCampo = "ocupacion";
          aValor = #labacuer#13;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac1";
          aValor = #labacuer#27 % 101;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac2";
          aValor = #labacuer#27 % 201;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac3";
          aValor = #labacuer#27 % 301;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac4";
          aValor = #labacuer#27 % 401;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac5";
          aValor = #labacuer#27 % 501;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac6";
          aValor = #labacuer#27 % 601;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac7";
          aValor = #labacuer#27 % 701;
          |HAZ GrabaTemporal;
     aCampo = "codig oaupac8";
          aValor = #labacuer#27 % 801;
          |HAZ GrabaTemporal;
     aCampo = "fechacomienzo";
          aAlfa = #0#7;
          aValor = aAlfa % 102;
          |HAZ GrabaTemporal;
     aCampo = "fechacomienzo1";
          aAlfa = #0#7;
          aValor = aAlfa % 402;
          |HAZ GrabaTemporal;
     aCampo = "fechacomienzo2";
          aAlfa = #0#7;
          aValor = aAlfa % -104;
          |HAZ GrabaTemporal;
     aCampo = "fechafin";
          aAlfa = #0#8;
          aValor = aAlfa % 102;
          |HAZ GrabaTemporal;
     aCampo = "fechafin1";
          aAlfa = #0#8;
          aValor = aAlfa % 402;
          |HAZ GrabaTemporal;
     aCampo = "fechafin2";
          aAlfa = #0#8;
          aValor = aAlfa % -104;
          |HAZ GrabaTemporal;
     |SI #labacuer#18 = "P";
           aCampo = "presencial";
           aValor = "Si";
          |HAZ GrabaTemporal;
          aValor = "";
     |FINSI;
     |SI #labacuer#18 = "D";
           aCampo = "a distancia";
           aValor = "Si";
          |HAZ GrabaTemporal;
          aValor = "";
     |FINSI;
     aCampo = "horario";
          aAlfa1 = #labacuer#11; |QBF aAlfa1;
          aAlfa2 = #labacuer#12; |QBF aAlfa2;
          aValor = aAlfa1 + " " + aAlfa2;
          |HAZ GrabaTemporal;
     aCampo = "localidad";
          aValor = #labacuer#15;
          |HAZ GrabaTemporal;
     aCampo = "dia";
          aValor = dia;
          |HAZ GrabaTemporal;
     aCampo = "mes";
          aValor = mes;
          |HAZ GrabaTemporal;
     aCampo = "a\361o";
          aValor = anyo;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato1";
          aValor = #labacuer#28;
          aValor = aValor % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato2";
          aValor = #labacuer#29;
          aValor = aValor % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato3";
          aValor = #labacuer#29;
          aValor = aValor % 201;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato4";
          aValor = #labacuer#31;
          aValor = aValor % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato5";
          aValor = #labacuer#31;
          aValor = aValor % 201;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato6";
          aValor = #labacuer#31;
          aValor = aValor % 301;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato7";
          aValor = #labacuer#31;
          aValor = aValor % 401;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato8";
          aValor = #labacuer#34;
          aValor = aValor % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato9";
          aValor = #labacuer#34;
          aValor = aValor % 201;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato10";
          aValor = #labacuer#34;
          aValor = aValor % 301;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato11";
          aValor = #labacuer#34;
          aValor = aValor % 401;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato12";
          aValor = #labacuer#34;
          aValor = aValor % 501;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato13";
          aValor = #labacuer#34;
          aValor = aValor % 601;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato14";
          aValor = #labacuer#34;
          aValor = aValor % 701;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato15";
          aValor = #labacuer#33;
          aValor = aValor % 101;
          |HAZ GrabaTemporal;
     aCampo = "identif contrato16";
          aValor = #labacuer#33;
          aValor = aValor % 201;
          |HAZ GrabaTemporal;
     aCampo = "trabajador";  || NOMBRE DEL TRABAJADOR TRABAJADOR
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
          aValor = #labtraba#20;
          |HAZ GrabaTemporal;
     aCampo = "registro";
          aEmp = #0#0; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #0#1; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;

  |FINSI;
|FPRC;



|PROCESO ImprePDF;
          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;
          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;
          |ABRE #pdfdocca;
          |ABRE #pdfdocli;

          swCopia = 1;

          aArchivo="pe-191.pdf"
          |HAZ CargaCampos;

          |CIERRA #pdfimtmp;
          |CIERRA #pdfdocca;
          |CIERRA #pdfdocli;

          |SUB_EJECUTA "pdfgraba";

     nTipo = 5;
     aCampo = "clausadici";
     aAlfa = aCampo;
     nLimiteClau = 5;
     |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
          nCampo = nNume + 24;
          aValor = #0#nCampo#;
          |QBF aValor;
          |SI aValor = "";
               nNume = nNume - 1;
               |SI nNume > nLimiteClau;
                    swAnexoClaus = 1;
               |FINSI;
               |SAL;
          |FINSI;
          |SI nCampo = 29;
               |SI aValor ! ""
                    swAnexoClaus = 1;
               |FINSI;
          |FINSI;
     |SIGUE;
     |SI swAnexoClaus = 0;
          nLimReal = nNume;
          |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
               aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
               aCampo = aAlfa + aNume;
               nCampo = nNume + 24;
               aValor = #0#nCampo#;
               |QBF aValor;
          |SIGUE;
     |SINO;                    ||PONEMOS EL MENSAJE DE VER EN HOJA ADJUNTA Y TODAS LAS CLAUSULAS EN BLANCO->""
          nLimReal = nNume;
          |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
               aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
               aCampo = aAlfa + aNume;
               nCampo = nNume + 24;
               |SI nNume = 1;
                    aValor = "                                 .- Ver en hoja adjunta.";
               |SINO;
                    aValor = "";
                    |QBF aValor;
               |FINSI;
          |SIGUE;
     |FINSI;
     |SI swAnexoClaus = 1;
          nNCA = registro / 40;       || registro:nro total claus,40=max/pag.
          nNCA = nNCA + 0.5;          || Numero de paginas de clausulas adic.
          nNCA = nNCA ! 0;            || que tengo que sacar (trunco)
          |PARA nVoypor = 1; |SI nVoypor [ nNCA; |HACIENDO nVoypor = nVoypor + 1;
               aProcedencia = "AnexoClaus";
               |HAZ ImpresionAnx;  || Anexo Clausulas
               nCuantos = nCuantos + 2;
          |SIGUE;
     |FINSI;
     |SI nAcuerdo = 1;
          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;
          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;
          |ABRE #pdfdocca;
          |ABRE #pdfdocli;


          aArchivo = "anexoformacion.pdf"
          |HAZ ImpreAcuerdo;

          |CIERRA #pdfimtmp;
          |CIERRA #pdfdocca;
          |CIERRA #pdfdocli;


          |SUB_EJECUTA "pdfgraba";
     |FINSI;



          |SUB_EJECUTA "pdfimpre";

|FPRC;


|PROCESO leeempre;|TIPO 0;    || CALCULO PARA ASEGURAR EFECTIVIDAD
|ABRET #1;                    || DE LA RELACION CON EL FICHERO DE
        #1#0 = #0#0;          || EMPRESAS
|LEE 040#1=;
|SI FSalida = 0;
    |PINTA 0725,#1#2;
|SINO;
    |MENAV mensa1;
        #0#0 = 0;
    |ERROR;
|FINSI;
|CIERRAT #1;
|FPRC;

|PROCESO leetraba;|TIPO 0;    || CALCULO PARA ASEGURAR EFECTIVIDAD
|ABRET #2;                    || EN LA RELACION CON EL FICHERO DE
    #2#0 = #0#0;              || TRABAJADORES
    #2#1 = #0#1;
|LEE 040#2=;
|SI FSalida = 0;
    |PINTA 0825,#2#2;
    |ABRE #4;
    |SELECT #2#4;
       #4#1 = #0#0;
       #4#2 = #0#1;
    |LEE 040#4=;
    |SI FSalida = 0;
        |MENAV mensaG;
        |ERROR;
    |SINO;
        |HAZ carga_comentario;
    |FINSI;
    |SELECT #1#4;
    |CIERRA #4;
|SINO;
    |MENAV mensa2;
        #0#1 = 0;
    |ERROR;
|FINSI;
|CIERRAT #2;
|FPRC;

|PROCESO dispo; |TIPO 6;
    inkey = FSalida;
|SI inkey = 18;
    |DDEFECTO #2;
    |ABRE #2;
        #2#0 = #0#0;
        #2#1 = #0#1;
    |LEE 000#2=;
    |CIERRA #2;
    |HAZ disposicion;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO carga_comentario;
|ABRE #12;
    #12#0 = #2#87;
|LEE 000#12=;
|SI FSalida = 0;
        #0#43 = #12#1;
        #0#44 = #12#2;
        #0#45 = #12#3;
        #0#46 = #12#4;
        #0#47 = #12#5;
        #0#48 = #12#6;
        #0#49 = #12#7;
        #0#50 = #12#8;
        #0#51 = #12#9;
|FINSI;
|CIERRA #12;
|FPRC;

|PROCESO leecentr;|TIPO 0;     || CALCULO PARA ASEGURAR EFECTIVIDAD
|ABRET #3;                     || EN LA RELACION CON EL FICHERO DE
    #3#0 = #0#0;               || CENTROS DE TRABAJO
    #3#1 = #0#2;
|LEE 040#3=;
|SI FSalida = 0;
    |PINTA 0927,#3#2;
|SINO;
    |MENAV mensa3;
        #0#2 = 0;
    |ERROR;
|FINSI;
|CIERRAT #3;
|SI #0#2 ! #2#77;
    |MENAV mensaA;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO lee_regimen;
|DDEFECTO #6;
|ABRE #6;
    #6#0 = #2#247;
|LEE 000#6=;
|SI FSalida ! 0;
        alfa1 = "    Regimen de Cotizacion [" + #6#0 + "] inexistente ...";
    |MENAV alfa1;
|FINSI;
|CIERRA #6;
|FPRC;

|PROCESO leecontr; |TIPO 7;
|ABRE #10;
|LEE 040#10p;
|SI FSalida ! 0;
    |MENAV mensaB;
|SINO;
    #0#20 = #10#26; |PINTA #0#20;  || nro de copias
    #0#21 = #10#27; |PINTA #0#21;  || localidad firma
|FINSI;
|CIERRA #10;

|SI nLabHisto = 1;
   aAlfa = "|NC";
   nCalc = #0#aAlfa#;
   |ABRE #labhisto;
   #labhisto#100 = enNumRegis;
   #labhisto#103 = eaNumProrr;
   |LEE 000#labhisto.=;
   |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
      |SI nCont [ 99;
         #0#nCont# = #labhisto#nCont#;
      |SINO;
         nCont1 = nCont + 20;
         #0#nCont# = #labhisto#nCont1#;
      |FINSI;
   |SIGUE;
   #labhisto#102 = "S"; |GRABA 020#labhisto.a;
   |CIERRA #labhisto;
   |PINDA #0#0; |HAZ leeempre; |HAZ leetraba; |HAZ leecentr;
   aCodigoC3 = #0#0; |QBF aCodigoC3;
   aCodigoC1 = aCodigoC3 % 0101;
   aCodigoC2 = aCodigoC3 % 0201;
   aCodigoC3 = aCodigoC3 % 0301;
   |HAZ actual99; |PTEC 807;
|FINSI;






|FPRC;

|PROCESO carga;
|SI Campo = 7;
        durdia = #0#06;
        durmes = #0#05;
        durini = #0#07;
        durfin = #0#08;
|SINO;
        durdia = #0#11;
        durmes = #0#10;
        durini = #0#09;
        durfin = #0#42;
|FINSI;
|FPRC;

|PROCESO fechas; |TIPO 0;
    teclado = FSalida;
|HAZ carga;

    check = durmes + durdia;         || chequea valores por si son nulos
|SI check ! 0; |Y durini ! vpuntos; |Y durini ! vblanco;
        nume1 = durmes / 1000;            || meses a sumar en formato suma
        nume2 = (durdia - 1) + nume1;     || fecha a sumar en formato suma
        fecreal = durini;
        fecreal = fecreal + nume2;
        durfin = fecreal;

        nume2 = (-1) + (4 / 1000000);  || suma 4 a¤os para saber el tope
        fecreal = #0#9;
        fecreal = fecreal + nume2;
        nume1 = fecreal;   || dias hasta (tope)
        fecreal = durfin;
        nume2 = fecreal;   || dias hasta
    |SI nume2 > nume1;|Y teclado ! 2;  || evita el segundo mensaje
        ||MENAV mensa6;      || chequea los 4 a¤os (INHIBIDO!!!)
    |FINSI;
|SINO;
        durfin = "..........";
|FINSI;
|HAZ litedura;
|SI Campo = 7;
    #0#8 = durfin;
|SINO;
    #0#42 = durfin;
|FINSI;
|PINDA #0#0;
|FPRC;

|PROCESO lit_segun; |TIPO 0;
|SI #0#52 = "S";
        sconvenio = "seg£n convenio";
|SINO;
        sconvenio = "..............";
|FINSI;
|FPRC;

|PROCESO litedura;
    #0#18 = #0#5 + #0#10;
    #0#22 = #0#6 + #0#11;
    duracion = "";
|SI #0#5 ! 0;
        duracion = #0#5;
        duracion = duracion + " mes";
    |SI #0#5 > 1;
            duracion = duracion + "es";
    |FINSI;
|SINO;
        duracion = "";
|FINSI;
|SI #0#6 ! 0;
    |SI #0#5 ! 0;
            duracion = duracion + and;
    |FINSI;
        duracion = duracion + #0#6;
        duracion = duracion + " dia";
    |SI #0#6 > 1;
            duracion = duracion + "s";
    |FINSI;
|SINO;
        duracion = duracion + "";
|FINSI;
|FPRC;

|PROCESO fechabaja;
     #nomcalca#5 = #4#20;
     |GRABA 020#nomcalca.a;
|FPRC;

|DEFBUCLE nomcalca;
     #nomcalca#1;
     ;
     #2#0, #2#1,  1, 0;
     #2#0, #2#1, 12, 9;
     e;
     NULL, fechabaja;
|FIN;


|PROCESO Guarda;
    |ABRE #4;
    |SELECT #1#4;
    |LEE 040#4u;
        contador = #4#00 + 1;
        #4#00 = contador;
        #4#01 = #0#00;          || codigo empresa
        #4#02 = #0#01;          || codigo trabajador
        #4#03 = #2#07;          || d.n.i. trabajador
        #4#04 = #0#14;          || codigo contrato
        #4#05 = #0#12;          || definicion decreto
        #4#06 = #0#13;          || real decreto
        #4#07 = #0#09;          || fecha inicio 1er. contrato
        #4#08 = #0#42;          || fecha fin 1er. contrato
        #4#09 = #0#10;          || meses duracion 1er. contrato
        #4#10 = #0#11;          || dias duracion 1er. contrato
        #4#11 = #0#16;          || fecha ultima presentacion
        #4#12 = #0#15;          || oficina presentacion 1er. contrato
        #4#13 = #0#21;          || localida oficina
        #4#14 = #0#17;          || nro. en el INEM del contrato
        #4#15 = #0#04;          || nro. prorroga
        #4#16 = #0#05;          || duracion prorroga meses
        #4#17 = #0#06;          || duracion prorroga dias
        #4#18 = #0#18;          || acumulado meses
        #4#22 = #0#22;          || acumulado dias
        #4#19 = #0#07;          || fecha inicio prorroga
        #4#20 = #0#08;          || fecha fin prorroga
        #4#21 = ~;              || fecha alta registro
    |HAZ recarga;
    |GRABA 020#4n;
    |SI FSalida = 0;|Y #10#3 = 1;
        |ABRE #2;
            #2#0 = #0#0;
            #2#1 = #0#1;
        |LEE 101#2=;
        |SI FSalida = 0;
            |SI #4#20 ! "          "; |Y #4#20 ! "..........";;
                #2#37 = #4#20;    || actualiza fecha de baja
                |GRABA 020#2a;
            |FINSI;
        |FINSI;
        |LIBERA #2;
        |CIERRA #2;
    |FINSI;
    |CIERRA #4;
    ||HAZ domicili;
    ||HAZ decodifi;
    ||HAZ diasmese;
    |HAZ lee_regimen;
        p_imp = #0#7;
    |HAZ pastilla;
    |SI p_cen = 0;
        |PARA z = 1; |SI z [ #0#20; |HACIENDO z = z + 1;
            ||INFOR informe;
            ||PRINT;
            ||PIEINF;
            ||FININF;
        |SIGUE;
        |HAZ el_acuerdo;
    |FINSI;
        alfa1 = #3#12;
    |QBF alfa1;
    |SI alfa1 ! "NO EXISTE"; |Y alfa1 ! "";
        |PINPA #2#11;
        |AVISO;
        |PAUSA;
    |FINSI;



    |SI nLabHisto ! 1;
       |ABRE #labhisto;
       #labhisto#100 = contador;
       #labhisto#103 = #0#4;
       |LEE 101#labhisto.=;
       |SI FSalida = 0;
          |BORRA 020#labhisto.a; |LIBERA #labhisto;
       |FINSI;
       |CIERRA #labhisto;
    |FINSI;

    |SI FSalida = 0;|Y #10#3 = 1;
        |ABRE #2;
            #2#0 = #0#0;
            #2#1 = #0#1;
        |LEE 101#2=;
        |SI FSalida = 0;
                |ABRE #nomcalca;
                #2#37 = #4#20;    || actualiza fecha de baja
                |BUCLE nomcalca;  || actualiza fecha baja nomcalca
            |GRABA 020#2a;
        |FINSI;
        |LIBERA #2;
        |CIERRA #2;
        ||LIBERA #nomcalca;
        |CIERRA #nomcalca;
    |FINSI;
    |LIBERA #4;
    |CIERRA #4;

      |ABRE #labhisto;
      #labhisto#100 = contador;
      #labhisto#103 = #0#4;           || N§ de prorroga
      |LEE 000#labhisto.=;
      |SI FSalida ! 0;
         |DDEFECTO #labhisto;
         #labhisto#100 = contador;
         |SI #0#4 = 0;
            #labhisto#103 = "";
         |SINO;
            #labhisto#103 = #0#4;           || N§ de prorroga
         |FINSI;
         |MODULO aAlfa;
         #labhisto#101 = aAlfa;
         |SI nOpcion = 2;
            #labhisto#102 = "N";
         |SINO;
            #labhisto#102 = "S";
         |FINSI;
         aAlfa = "|NC";
         nCalc = #0#aAlfa#; nCalc = nCalc - 1;
         |PARA nCont = 0; |SI nCont [ nCalc; |HACIENDO nCont = nCont + 1;
            |SI nCont [ 99;
               #labhisto#nCont# = #0#nCont#;
            |SINO;
               nCont1 = nCont + 20;
               #labhisto#nCont1# = #0#nCont#;
            |FINSI;
         |SIGUE;
         |GRABA 020#labhisto.n;
      |FINSI;
      |CIERRA #labhisto;


|FPRC;


|PROCESO actual99; |TIPO 3;
||alfa1 = #10#44;
||QBF alfa1;
||Impresora = alfa1;
||IMPRE 0;

|MENU histo;
nOpcion = FSalida;
|SI nOpcion < 1; |O nOpcion > 3; |ERROR; |ACABA; |FINSI;
   |SI nLabHisto ! 1;
     |HAZ Guarda;
   |FINSI;
   |SI nOpcion = 1; |O nOpcion = 2;
          |SI nOpcion = 2;
               nTipoSalida = 1;    || nNroCopias: = numero de copias ...
               nTipoImpre = 1;     || de momento por defecto Presentamos cuadro de impresion
               |CONFI "     Impresora Predeterminada?";
               |SI FSalida = 0;
                    nTipoImpre = 0;
                    |PUSHV 1425 1954;
                    |BLANCO 1425 1954;
                    |CUADRO 1425 1954;
                    |ATRI R; |PINTA 1630 , " Nro de Copias: "; |ATRI N;
                    E_sup  = 99;
                    E_inf  = 1;
                    nNroCopias = #0#20;
                    nNroCopias = 1649 ? 1;
                    |POPV;
               |SINO;
                    aAlfa = "    AVISO: Debera especificar el numero de copias en ";
                    aAlfa = aAlfa + "el cuadro de impresion de Acrobat Reader.";
                    |MENAV aAlfa;
               |FINSI;
         |FINSI;
         |HAZ ImprePDF;
     |FINSI;
/*
|SI FSalida = 0;
    |ABRE #4;
    |SELECT #1#4;
    |LEE 040#4u;
        #4#00 = #4#00 + 1;
        #4#01 = #0#00;          || codigo empresa
        #4#02 = #0#01;          || codigo trabajador
        #4#03 = #2#07;          || d.n.i. trabajador
        #4#04 = #0#14;          || codigo contrato
        #4#05 = #0#12;          || definicion decreto
        #4#06 = #0#13;          || real decreto
        #4#07 = #0#09;          || fecha inicio 1er. contrato
        #4#08 = #0#42;          || fecha fin 1er. contrato
        #4#09 = #0#10;          || meses duracion 1er. contrato
        #4#10 = #0#11;          || dias duracion 1er. contrato
        #4#11 = #0#16;          || fecha ultima presentacion
        #4#12 = #0#15;          || oficina presentacion 1er. contrato
        #4#13 = #0#21;          || localida oficina
        #4#14 = #0#17;          || nro. en el INEM del contrato
        #4#15 = #0#04;          || nro. prorroga
        #4#16 = #0#05;          || duracion prorroga meses
        #4#17 = #0#06;          || duracion prorroga dias
        #4#18 = #0#18;          || acumulado meses
        #4#22 = #0#22;          || acumulado dias
        #4#19 = #0#07;          || fecha inicio prorroga
        #4#20 = #0#08;          || fecha fin prorroga
        #4#21 = ~;              || fecha alta registro
    |HAZ recarga;
    |GRABA 020#4n;
    |SI FSalida = 0;|Y #10#3 = 1;
        |ABRE #2;
            #2#0 = #0#0;
            #2#1 = #0#1;
        |LEE 101#2=;
        |SI FSalida = 0;
                #2#37 = #4#20;    || actualiza fecha de baja
            |GRABA 020#2a;
        |FINSI;
        |LIBERA #2;
        |CIERRA #2;
    |FINSI;
    |CIERRA #4;
    ||HAZ domicili;
    ||HAZ decodifi;
    ||HAZ diasmese;
    |HAZ lee_regimen;
        p_imp = #0#7;
    |HAZ pastilla;
    |SI p_cen = 0;
        |PARA z = 1; |SI z [ #0#20; |HACIENDO z = z + 1;
            ||INFOR informe;
            ||PRINT;
            ||PIEINF;
            ||FININF;
        |SIGUE;
        |HAZ el_acuerdo;
    |FINSI;
        alfa1 = #3#12;
    |QBF alfa1;
    |SI alfa1 ! "NO EXISTE"; |Y alfa1 ! "";
        |PINPA #2#11;
        |AVISO;
        |PAUSA;
    |FINSI;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
||FINIMP;*/
|FPRC;

|PROCESO fechacon; |TIPO 0;
        vfec = #0Campo; vsw = 0;
|SI vfec ! vblanco; |Y vfec ! vpuntos; |Y vfec ! Aindefinido;
  vdia1 = vfec % A102;
  vme1 = vfec % A402;
  vany1 = vfec % A704;
  vdia = vdia1; vme = vme1; vany = vany1;
  |SI vdia ! 0; |Y vme ! 0; |Y vany ! 0;
     |SI vme [ 12; |Y vme ] 1;
       |SI vme = 1; |O vme = 3; |O vme = 5; |O vme = 7; |O vme = 8; |O vme = 10; |O vme = 12;
           vtope = 31;
       |SINO;
           |SI vme = 2;
               mod = vany $ 4;
               |SI mod = 0;
                   vtope = 29;
               |SINO;
                   vtope = 28;
               |FINSI;
            |SINO;
               vtope = 30;
            |FINSI;
        |FINSI;
        |SI vdia [ vtope;
            vsw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  vsw = 1;
|FINSI;
|SI vsw = 0;
    |MENAV verrfec;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO checcont; |TIPO 0;
|SI    #0Campo=A01;|O #0Campo=A18;
    |O #0Campo=A03;|O #0Campo=A23;|O #0Campo=A08;
    |O #0Campo=A09;|O #0Campo=A28;|O #0Campo=A49;
    |O #0Campo=A69;|O #0Campo=A70;|O #0Campo=A71;
    |O #0Campo=A72;|O #0Campo=A73;
    |MENAV mensa9;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO CuentaClaus;
     |PARA ParaI = 3; |SI ParaI [ 20; |HACIENDO ParaI = ParaI + 1;
          aTmp = #5#ParaI#;
          |QBF aTmp;
          |SI aTmp ! "";
               nclaus = nclaus + 1;
          |FINSI;
     |SIGUE;
|FPRC;


|PROCESO siexiste; |TIPO 0;
|SI #0#31 ! 0;
    |ABRET #5;
        #5#1 = #0#31;
    |LEE 040#5=;
    |SI FSalida = 0;
            nclaus = 0;
            |HAZ CuentaClaus;
            #0#25 = #5#3;
            #0#26 = #5#4;
            #0#27 = #5#5;
            #0#28 = #5#6;
            #0#29 = #5#7;
        |PINTA #0#25;
        |PINTA #0#26;
        |PINTA #0#27;
        |PINTA #0#28;
        |PINTA #0#29;
    |SINO;
            #0#25 = "";
            #0#26 = "";
            #0#27 = "";
            #0#28 = "";
            #0#29 = "";
            nclaus = 0;
        |PINTA #0#25;
        |PINTA #0#26;
        |PINTA #0#27;
        |PINTA #0#28;
        |PINTA #0#29;
        |MENAV mensa8;
        |ERROR;
    |FINSI;
    |CIERRA #5;
|SINO;
        #0#25 = "";
        #0#26 = "";
        #0#27 = "";
        #0#28 = "";
        #0#29 = "";
    |PINTA #0#25;
    |PINTA #0#26;
    |PINTA #0#27;
    |PINTA #0#28;
    |PINTA #0#29;
|FINSI;
|FPRC;

|PROCESO decodifi;             || RUTINA DE DEGLOSE FECHA PRESENTACION
|SI #0#19 ! vpuntos; |Y #0#19 ! vblanco;
        fec1 = #0#19;
        dia1 = fec1 % 102;
        dia  = dia1;
        any1 = fec1 % 704;
        anyo = any1;
        fec1 = fec1 % 402;
        fec2 = fec1;
    |SI fec2 = 1;   mes = "Enero ....";   |FINSI;
    |SI fec2 = 2;   mes = "Febrero ..";   |FINSI;
    |SI fec2 = 3;   mes = "Marzo ....";   |FINSI;
    |SI fec2 = 4;   mes = "Abril ....";   |FINSI;
    |SI fec2 = 5;   mes = "Mayo .....";   |FINSI;
    |SI fec2 = 6;   mes = "Junio ....";   |FINSI;
    |SI fec2 = 7;   mes = "Julio ....";   |FINSI;
    |SI fec2 = 8;   mes = "Agosto ...";   |FINSI;
    |SI fec2 = 9;   mes = "Septiembre";   |FINSI;
    |SI fec2 = 10;  mes = "Octubre ..";   |FINSI;
    |SI fec2 = 11;  mes = "Noviembre ";   |FINSI;
    |SI fec2 = 12;  mes = "Diciembre ";   |FINSI;
|SINO;
    dia = "..";
    mes = vpuntos;
    anyo = "....";
|FINSI;

aCampo = "diafirma";
aValor = dia;
|HAZ GrabaTemporal;

aCampo = "mesfirma";
aValor = mes;
|HAZ GrabaTemporal;

aCampo = "anyofirma";
aValor = anyo % -102;
|HAZ GrabaTemporal;

|SI #0#4 = 1;   prorro = "primera";   |FINSI;
|SI #0#4 = 2;   prorro = "segunda";   |FINSI;
|SI #0#4 = 3;   prorro = "tercera";   |FINSI;
|SI #0#4 = 4;   prorro = "cuarta";    |FINSI;
|SI #0#4 = 5;   prorro = "quinta";    |FINSI;
|SI #0#4 = 6;   prorro = "sexta";     |FINSI;
|SI #0#4 = 7;   prorro = "s‚ptima";   |FINSI;
|SI #0#4 = 8;   prorro = "octava";    |FINSI;
|SI #0#4 = 9;   prorro = "novena";    |FINSI;
|SI #0#4 = 10;  prorro = "d‚cima";    |FINSI;
|SI #0#4 = 11;  prorro = "und‚cima";  |FINSI;
|SI #0#4 = 12;  prorro = "duod‚cima"; |FINSI;

aCampo = "numproga";
aValor = prorro;
|HAZ GrabaTemporal;

    contra = "";
|SI #0#10 ! 0;
        contra = #0#10;
        contra = contra + " mes";
    |SI #0#10 > 1;
        contra = contra + "es";
    |FINSI;
|SINO;
        contra = "...........";
|FINSI;
|SI #0#11 ! 0;
    |SI #0#10 ! 0;
            contra = contra + and;
    |FINSI;
        contra = contra + #0#11;
        contra = contra + " dia";
    |SI #0#11 > 1;
            contra = contra + "s";
    |FINSI;
|SINO;
        contra = contra + "............";
|FINSI;
aCampo = "mesesduracont";
aValor = contra;
|HAZ GrabaTemporal;

|FPRC;



|PROCESO diasmese;              || RUTINA PARA MONTAR ALFANUMERICO
    dura = "";                  || DE DURACION
    |SI #0#18 ! 0;
        dura = #0#18;
        dura = dura + " mes";
        |SI #0#18 > 1;
            dura = dura + "es";
        |FINSI;
    |SINO;
        dura = "...........";
    |FINSI;
    |SI #0#22 ! 0;
        |SI #0#18 ! 0;
            dura = dura + and;
        |FINSI;
        dura = dura + #0#22;
        dura = dura + " dia";
        |SI #0#22 > 1;
            dura = dura + "s";
        |FINSI;
    |SINO;
        dura = dura + "............";
    |FINSI;
    aCampo = "totaldura";
    aValor = dura;
    |HAZ GrabaTemporal;
|FPRC;

|PROCESO domicili;                    || RUTINA DEL CALCULO actualiz
    direcc = #1#3;                    || PARA CONSTRUCCION DOMICILIOS
    numero = #1#4;
    piso   = #1#5;
    cod1   = #1#7;
    cod2   = #1#8;
    locali = #1#6;
|HAZ compac;
    domemp = compactado;              || domicilio empresa
    aCampo = "domsocialem";
    aValor = domemp;
    |HAZ GrabaTemporal;

     aCodPostal1 = #labempre#7;
     aCodPostal1 = "00" + aCodPostal1;
     aCodPostal1 = aCodPostal1 % -102;
     aCodPostal2 = #labempre#8;
     aCodPostal2 = "00" + aCodPostal2;
     aCodPostal2 = aCodPostal2 % -103;
     aCPED1 = aCodPostal1 % 101;
     aCPED2 = aCodPostal1 % 201;
     aCPED3 = aCodPostal2 % 101;
     aCPED4 = aCodPostal2 % 201;
     aCPED5 = aCodPostal2 % 301;

     aCampo = "codpostem1";
     aValor = aCPED1;
     |HAZ GrabaTemporal;

     aCampo = "codpostem2";
     aValor = aCPED2;
     |HAZ GrabaTemporal;

     aCampo = "codpostem3";
     aValor = aCPED3;
     |HAZ GrabaTemporal;

     aCampo = "codpostem4";
     aValor = aCPED4;
     |HAZ GrabaTemporal;

     aCampo = "codpostem5";
     aValor = aCPED5;
     |HAZ GrabaTemporal;

    aCampo = "codacteco1";
    aAlfa = #1#11;
    aValor = aAlfa % -201;
    |HAZ GrabaTemporal;

    aCampo = "codacteco2";
    aAlfa = #1#11;
    aValor = aAlfa % -101;
    |HAZ GrabaTemporal;

    aCampo = "cif";
    aValor = #1#10;
    |HAZ GrabaTemporal;

    aCampo = "nomrepr";
    aValor = #1#15;
    |HAZ GrabaTemporal;

    aCampo = "repre_emp";
    aValor = #1#15;
    |HAZ GrabaTemporal;

    aCampo = "dnirep";
    aValor = #1#17;
    |HAZ GrabaTemporal;

    aCampo = "cargorep";
    aValor = #1#18;
    |HAZ GrabaTemporal;

    aCampo = "razsoc";
    aValor = #1#2;
    |HAZ GrabaTemporal;

    aCampo = "litacteco";
    aValor = #1#12;
    |HAZ GrabaTemporal;


    direcc = #2#3;
    numero = #2#4;
    piso   = #2#5;
    cod1   = #2#8;
    cod2   = #2#9;
    locali = #2#6;
|HAZ compac;
    domtra = compactado;              || domicilio trabajador

    direcc = #3#3;
    numero = #3#4;
    piso   = #3#5;
    cod1   = #3#7;
    cod2   = #3#8;
    locali = #3#6;
|HAZ compac;
    domcen = compactado;              || domicilio centro trabajo
    locali = #0#21;
    |QBF locali;
    locali = "                         " + locali;
    locali = locali % -125;
    #0#21 = locali;
|FPRC;


|PROCESO compac;                      || SUBRUTINA DE RUTINA domicili
    compactado = "";                  || DE COMPACTACION DE CAMPOS
    |QBF direcc;                      || USADA TAMBIEN EN CONT. 05 Y 25
    |QBF numero;
    |QBF piso;
    |QBF cod1; cod1 = "00" + cod1; cod1 = cod1 % -102;
    |QBF cod2; cod2 = "000" + cod2; cod2 = cod2 % -103;
    |QBF locali;
    compactado = direcc + coma;
    compactado = compactado + numero;
    compactado = compactado + "  ";
    compactado = compactado + piso;
    ||compactado = compactado + " (";
    ||compactado = compactado + cod1;
    ||compactado = compactado + cod2;
    ||compactado = compactado + ") ";
    ||compactado = compactado + locali;
    punt = " ";
    linepunt = punt * 70;
    compactado = compactado + linepunt;
    compactado = compactado % 170;
|FPRC;

|PROCESO nomodif2; |TIPO 7;     || CONVIERTE A NO MODIFICABLES CAMPOS DE
|SI #0#31 = 0;                  || LAS CLAUSULAS ADICIONALES
    |HAZ nopasa;
|FINSI;
|FPRC;

|PROCESO nopasa;                   || SUBRUTINA PARA HACER <no modificable>
    aponer = Anono;                || LLAMADA EN EL <nomodif>
    fiac = Control % A1001;
    Control = Control + fiac;
    Control = Control + relleno;
    Control = Control % A120;
    Control = Control + aponer;
|FPRC;

|PROCESO edadanyo;              || CALCULA EDAD EN BASE A UNA FECHA
|SI fechtra ! vblanco; |Y fechtra ! vpuntos;
    sistema = fechtra;
    nacitra = sistema;
    sistema = ~;
    actutra = sistema;
    edadtra = actutra - nacitra;
    anyotra = edadtra $ 365;
    edadtra = edadtra - anyotra;
    anyotra = edadtra / 365;
|SINO;
    anyotra = 0;
|FINSI;
|FPRC;

|PROCESO masuno; |TIPO 7;
|SI #0#42 ! "          "; |Y #0#42 ! "..........";
    fecreal = #0#42;
    tranum = fecreal;
    tranum = tranum + 1;
    fecreal = tranum;
    #0#7 = fecreal;
|PINTA #0#7;
|FINSI;
|FPRC;

|PROCESO recarga;
|SI #4#07 ! "..........";|Y #4#07 ! "          ";
        #4#23 = #4#07;
|SINO;
        #4#23 = "00.00.0000";
|FINSI;
|SI #4#08 ! "..........";|Y #4#08 ! "          ";
        #4#24 = #4#08;
|SINO;
        #4#24 = "00.00.0000";
|FINSI;
|SI #4#19 ! "..........";|Y #4#19 ! "          ";
        #4#25 = #4#19;
|SINO;
        #4#25 = "00.00.0000";
|FINSI;
|SI #4#20 ! "..........";|Y #4#20 ! "          ";
        #4#26 = #4#20;
|SINO;
        #4#26 = "00.00.0000";
|FINSI;
|FPRC;

|PROCESO acuerdo; |TIPO 0;
|SI FSalida = 0;|O FSalida = 3;
    |SI #0#14 = "087";|O #0#14 = "097";|O #0#14 = "085";|O #0#14 = "421";
        |PUSHV 0501 2380;
        |PINPA #0#87;
        |DDEFECTO #87;
        |ABRE #87;
            #87#0 = #0#0;
            #87#1 = #0#1;
        |LEE 101#87=;
            FEstado = FSalida;

        |CAMPO_MODIFICA #87#16, 1, "S";
        |CAMPO_MODIFICA #87#17, 1, "S";

        |PINDA #0#87;
        |ENDATOS #1#87;
        |SI FSalida = 0;
            |SI FEstado = 0;    |GRABA 020#87a;     |FINSI;
            |SI FEstado ! 0;    |GRABA 020#87n;     |FINSI;
        |FINSI;
        |LIBERA #87;
        |CIERRA #87;
        |POPV;

        |ABRE #2;
            #2#0 = #0#0;
            #2#1 = #0#1;
        |LEE 020#2=;          || vuelve a leer el trabajador contratado
        |CIERRA #2;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO el_acuerdo;
|SI #0#14 = "087";|O #0#14 = "097";|O #0#14 = "085";|O #0#14 = "421";
     nAcuerdo = 1;
    |DDEFECTO #87;
        #87#14 = #0#3;       || oficina empleo contrato
        #87#15 = #0#21;      || localidad contrato
    |ABRE #87;
        #87#0 = #0#0;
        #87#1 = #0#1;
    |LEE 101#87=;
    |SI FSalida = 0;
            #87#14 = #0#3;       || oficina empleo contrato
            #87#15 = #0#21;      || localidad contrato
        |GRABA 020#87a;
    |FINSI;
    |LIBERA #87;
    |CIERRA #87;
        des87 = #0#7;
        has87 = #0#8;
    |SI #0#4 = 1;
             tipo87 = 2;
    |SINO;
             tipo87 = 3;
    |FINSI;
   /* |PARA z = 1; |SI z [ #0#20; |HACIENDO z = z + 1;
        |INFOR "labacuer";
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;*/
|FINSI;
|FPRC;

|PROCESO min90;
    #90#0 = #89#0;
    #90#1 = 1;
|FPRC;

|PROCESO max90;
    #90#0 = #89#0;
    #90#1 = 999;
|FPRC;

|PROCESO disposicion;
|ABRE #89;
    #89#0 = #2#87;
|LEE 101#89=;
|SI FSalida ! 0;    |GRABA 020#89n;     |FINSI;

|PUSHV 0501 2380;
|PINPA #0#89;
|PINDA #0#89;
|ENTLINEAL #1#90, 2, 3, 22, 0, min90, max90;
|POPV;

|CIERRA #89;
|FPRC;
