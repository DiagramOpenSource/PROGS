|FICHEROS;
    labcomun #0;
    labempre #1;
    labtraba #2;
    labcentr #3;
    labcontr #10;        || control aplicacion
|FIN;

|VARIABLES;
    alfa0 = "";
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume0 = 0;
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    FEstado = 0;
    men1 = "0000ATENCION !!! Fecha erronea ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    fec = "";
    blanco = "          ";
    puntos = "..........";
    vblanco = "          ";
    vpuntos = "..........";
    sw = 0;
    any = 0;
    tope = 0;
    mod = 0;
    &dia = "";
    &mes = "";
    &anyo = "";
    &coma = ",";
    &letra = "";
    &sinletra = "";
    &domemp = "";
    &domcen = "";
    &provss = "";
    &numess = "";
    &contss = "";
    nombre = 0;
    docume = 0;
    nacimi = 0;
    profes = 0;
    segsoc = 0;
    estudi = 0;
    codest = 0;
    contra = 0;
    fec1 = "";
    fec2 = 0;
    meslet = "";
    direcc = "";
    numero = "";
    piso = "";
    cod1 = "";
    cod2 = "";
    locali = "";
    compactado = "";
    setenta = "";
    espa = " ";
|FIN;
____________________________________/ CALCULOS DESDE PANTALLA
|PROCESO leetraba; |TIPO 0;
|SI #0Campo ! 0;
    |ABRE #2;
        #2#0 = #0#0;
        #2#1 = #0Campo;
    |LEE 001#2=;
    |SI FSalida ! 0;
        |DDEFECTO #2;
            alfa1 = "N";
    |SINO;
            alfa1 = "S";
    |FINSI;
    |CIERRA #2;
        nombre = 28 + Campo;  #0nombre = #2#2;
        docume = 34 + Campo;  #0docume = #2#7;
        nacimi = 40 + Campo;  #0nacimi = #2#11;
        profes = 46 + Campo;  #0profes = #2#19;
        segsoc = 52 + Campo;  #0segsoc = #2#75;
        estudi = 58 + Campo;  #0estudi = #2#12;
        codest = 64 + Campo;  #0codest = #2#73;
        contra = 70 + Campo;  #0contra = #2#45;
        nume1 = Campo;
    |PINTA #0nombre;
        Campo = nume1;
|SINO;
        alfa1 = "N";
|FINSI;
|SI Campo = 1;  |HAZ mod_1;  |FINSI;
|SI Campo = 2;  |HAZ mod_2;  |FINSI;
|SI Campo = 3;  |HAZ mod_3;  |FINSI;
|SI Campo = 4;  |HAZ mod_4;  |FINSI;
|SI Campo = 5;  |HAZ mod_5;  |FINSI;
|SI Campo = 6;  |HAZ mod_6;  |FINSI;
|FPRC;

|PROCESO mod_1;
|CAMPO_MODIFICA #0#07, 1, alfa1;
|CAMPO_MODIFICA #0#13, 1, alfa1;
|CAMPO_MODIFICA #0#19, 1, alfa1;
|FPRC;

|PROCESO mod_2;
|CAMPO_MODIFICA #0#08, 1, alfa1;
|CAMPO_MODIFICA #0#14, 1, alfa1;
|CAMPO_MODIFICA #0#20, 1, alfa1;
|FPRC;

|PROCESO mod_3;
|CAMPO_MODIFICA #0#09, 1, alfa1;
|CAMPO_MODIFICA #0#15, 1, alfa1;
|CAMPO_MODIFICA #0#21, 1, alfa1;
|FPRC;

|PROCESO mod_4;
|CAMPO_MODIFICA #0#10, 1, alfa1;
|CAMPO_MODIFICA #0#16, 1, alfa1;
|CAMPO_MODIFICA #0#22, 1, alfa1;
|FPRC;

|PROCESO mod_5;
|CAMPO_MODIFICA #0#11, 1, alfa1;
|CAMPO_MODIFICA #0#17, 1, alfa1;
|CAMPO_MODIFICA #0#23, 1, alfa1;
|FPRC;

|PROCESO mod_6;
|CAMPO_MODIFICA #0#12, 1, alfa1;
|CAMPO_MODIFICA #0#18, 1, alfa1;
|CAMPO_MODIFICA #0#24, 1, alfa1;
|FPRC;

|PROCESO fechacon; |TIPO 0;      || chequea una fecha alfanumerica de 10 pos.
    fec = #0Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
        dia1 = fec % A102;
        mes1 = fec % A402;
        any1 = fec % A704;
        dia = dia1;
        mes = mes1;
        any = any1;
    |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
        |SI mes [ 12; |Y mes ] 1;
            |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
                    tope = 31;
            |SINO;
                |SI mes = 2;
                         mod = any $ 4;
                    |SI mod = 0;
                            tope = 29;
                    |SINO;
                            tope = 28;
                    |FINSI;
                |SINO;
                        tope = 30;
                |FINSI;
            |FINSI;
            |SI dia [ tope;
                    sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|SINO;
        sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV men1;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO leecontr; |TIPO 7;
|ABRE #10;
|LEE 001#10p;
|SI FSalida ! 0;
    |MENAV "    No existen parametros de control !!! Usando defectos ...";
|SINO;
        #0#27 = #10#26; |PINTA #0#27;           || nro. de copias
        #0#28 = #10#27; |PINTA #0#28;           || localidad firma
|FINSI;
|CIERRA #10;
|FPRC;
____________________________________/ PROCESO PRINCIPAL
|PROCESO varios1;
    alfa1 = #1#13;
|QBF alfa1;
    alfa0 = alfa1 % 0;
    nume0 = alfa0;
    nume1 = 300 + (nume0 - 4);

    provss = alfa1 %  102;
    numess = alfa1 % nume1;
    contss = alfa1 % -102;
||***************************
    alfa1 = #1#10;
|QBF alfa1;
    alfa2 = alfa1 % 0;
    nume0 = alfa2;
    nume1 = 200 + (nume0 - 1);

    alfa0 = alfa1 % 101;
|SI alfa0 ] "A"; |Y alfa0 [ "z";
        letra = alfa0;
        sinletra = alfa1 % nume1;
|SINO;
        alfa0 = alfa1 % -101;
    |SI alfa0 ] "A"; |Y alfa0 [ "z";
            letra = alfa0;
            nume1 = nume1 * (-1);
            sinletra = alfa1 % nume1;
    |SINO;
            letra = "";
            sinletra = #1#10;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO meseslet;               || SUBRUTINA GENERAL DE TRANSFORMACION
    dia1 = fec1 % 102;           || DE FECHAS A LETRAS
    any1 = fec1 % 704;
    fec1 = fec1 % 402;
    fec2 = fec1;
|SI fec2 = 1;   meslet = "Enero ....";   |FINSI;
|SI fec2 = 2;   meslet = "Febrero ..";   |FINSI;
|SI fec2 = 3;   meslet = "Marzo ....";   |FINSI;
|SI fec2 = 4;   meslet = "Abril ....";   |FINSI;
|SI fec2 = 5;   meslet = "Mayo .....";   |FINSI;
|SI fec2 = 6;   meslet = "Junio ....";   |FINSI;
|SI fec2 = 7;   meslet = "Julio ....";   |FINSI;
|SI fec2 = 8;   meslet = "Agosto ...";   |FINSI;
|SI fec2 = 9;   meslet = "Septiembre";   |FINSI;
|SI fec2 = 10;  meslet = "Octubre ..";   |FINSI;
|SI fec2 = 11;  meslet = "Noviembre ";   |FINSI;
|SI fec2 = 12;  meslet = "Diciembre ";   |FINSI;
|FPRC;

|PROCESO fechafir;              || DESGLOSE DE FECHA DE FIRMA
    fec1 = #0#26;
|SI fec1 ! vpuntos; |Y fec1 ! vblanco;
    |HAZ meseslet;
        dia = dia1;
        mes = meslet;
        anyo = any1;
|SINO;
    dia = "..";
    mes = "..........";
    anyo = "....";
|FINSI;
|FPRC;

|PROCESO domicili;                    || RUTINA DEL CALCULO actualiz
    direcc = #1#3;                    || PARA CONSTRUCCION DOMICILIOS
    numero = #1#4;
    piso   = #1#5;
    cod1   = #1#7;
    cod2   = #1#8;
    locali = #1#6;
|HAZ compac;
    domemp = compactado;              || domicilio empresa
    direcc = #3#3;
    numero = #3#4;
    piso   = #3#5;
    cod1   = #3#7;
    cod2   = #3#8;
    locali = #3#6;
|HAZ compac;
    domcen = compactado;              || domicilio centro trabajo
|FPRC;

|PROCESO compac;                      || SUBRUTINA DE RUTINA domicili
    setenta = espa * 70;
    compactado = "";                  || DE COMPACTACION DE CAMPOS
|QBF direcc;
|QBF numero;
|QBF piso;
|QBF cod1; cod1 = "00" + cod1;   cod1 = cod1 % -102;
|QBF cod2; cod2 = "000" + cod2;  cod2 = cod2 % -103;
|QBF locali;
    compactado = direcc + coma;
    compactado = compactado + numero;
    compactado = compactado + "  ";
    compactado = compactado + piso;
    compactado = compactado + " (";
    compactado = compactado + cod1;
    compactado = compactado + cod2;
    compactado = compactado + ") ";
    compactado = compactado + locali;
    compactado = compactado + setenta;
    compactado = compactado % 170;
|FPRC;

|PROCESO carga;
|HAZ varios1;
|HAZ fechafir;
|HAZ domicili;
|FPRC;

|PROCESO comunica; |TIPO 3;
|IMPRE 0;
|SI FSalida = 0;
    |PARA para1 = 1; |SI para1 [ #0#27; |HACIENDO para1 = para1 + 1;
        |HAZ carga;
        |INFOR "labcomun";
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;
|FINSI;
|FINIMP;
|FPRC;
