|FICHEROS;
    labconal #0;
    labempre #1;    || empresas
    labtraba #2;    || trabajadores
    nomhicca #3;    || historico cabs.
    labcontm #10;   || tmp. informe
|FIN;

|VARIABLES;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
    alfa4 = "";
    nume1 = 0;
    nume2 = 0;
    nume3 = 0;
    nume4 = 0;
    para1 = 0;
    para2 = 0;
    para3 = 0;
    para4 = 0;
    fech1 = @;
    fech2 = @;
    fech3 = @;
    fech4 = @;
    elsw1 = 0;
    elsw2 = 0;
    elsw3 = 0;
    elsw4 = 0;
    FEstado = 0;
    seleccio = 0;
    modo = 0;
    sw_rup = 0;

    &m1 = "";
    &m2 = "";
    &m3 = "";
    &m4 = "";
    &m5 = "";
    &m6 = "";
    &m7 = "";
    &m8 = "";
    &m9 = "";
    &m10 = "";
    &m11 = "";
    &m12 = "";
    &a1 = 0;
    &a2 = 0;
    &a3 = 0;
    &a4 = 0;
    &a5 = 0;
    &a6 = 0;
    &a7 = 0;
    &a8 = 0;
    &a9 = 0;
    &a10 = 0;
    &a11 = 0;
    &a12 = 0;
    tope = 0;
    busca = 0;
    el_mes = 0;
    &sw_lin = 0;
    emp_ant = 0;
    cuenta = 0;
|FIN;
____________________________________/
|PROCESO defecto; |TIPO 7; ||calcula el a¤o por defecto segun fecha sistema
    fech1 = ~;
    alfa1 = fech1;
    alfa1 = alfa1 % -102;
    #0Campo = alfa1;
|PINTA #0Campo;
|FPRC;
____________________________________/ LECTURA TEMPORAL
|PROCESO lee_tmp1;
|SI sw_rup = 0;
        emp_ant = #10#0; #1#0 = emp_ant;     |LEE 000#1=;
        sw_rup = 1;
|FINSI;

|SI emp_ant ! #10#0;
        emp_ant = #10#0; #1#0 = emp_ant;     |LEE 000#1=;
        FSalida = "PAGINA";
        sw_lin = 99;
    |PRINT;
        a1 = 0;     a2 = 0;   a3 = 0;   a4 = 0;   a5 = 0;   a6 = 0;
        a7 = 0;     a8 = 0;   a9 = 0;   a10 = 0;  a11 = 0;  a12 = 0;
|FINSI;

    #2#0 = #10#0;
    #2#1 = #10#1;
|LEE 000#2=;
|SI FSalida = 0;
        a1 = a1 + #10#2;     || mes 1
        a2 = a2 + #10#3;     || mes 2
        a3 = a3 + #10#4;     || mes 3
        a4 = a4 + #10#5;     || mes 4
        a5 = a5 + #10#6;     || mes 5
        a6 = a6 + #10#7;     || mes 6
        a7 = a7 + #10#8;     || mes 7
        a8 = a8 + #10#9;     || mes 8
        a9 = a9 + #10#10;     || mes 9
        a10 = a10 + #10#11;     || mes 10
        a11 = a11 + #10#12;     || mes 11
        a12 = a12 + #10#13;     || mes 12
        sw_lin = 0;
    |PRINT;
        seleccio = 1;
|FINSI;
|FPRC;

|DEFBUCLE lee_tmp;
 #10#1;
 ;
    1,     1;
 9999, 99999;
 ;
 NULL, lee_tmp1;
|FIN;
____________________________________/ GRABACION TEMPORAL
|PROCESO busca_mes;
    elsw1 = 0;
    el_mes = 0;
    busca = (#3#66 * 100) + #3#2;

    tope = (#0#3 * 100) + #0#5;
|PARA para1 = (#0#3*100)+#0#4; |SI para1[tope; |HACIENDO para1=para1+1;

        el_mes = el_mes + 1;

        nume1 = para1 $ 100;
    |SI nume1 = 13; para1 = para1 + 88; |FINSI;

    |SI para1 = busca;
            elsw1 = 1;
        |SAL;
    |FINSI;
|SIGUE;
|FPRC;

|PROCESO lee_histo1;
|HAZ busca_mes;
|SI elsw1 = 1;
        el_mes = el_mes + 1;

    |DDEFECTO #10;
        #10#0 = #3#0;   || empresa
        #10#1 = #3#1;   || trabajador
    |LEE 101#10=;
        FEstado = FSalida;

        #10el_mes = 1;  || marca el mes

    |SI FEstado ! 0;     |GRABA 020#10n;     |FINSI;
    |SI FEstado = 0;     |GRABA 020#10a;     |FINSI;
    |LIBERA #10;
|FINSI;
|FPRC;

|DEFBUCLE lee_histo;
 #3#1;
 ;
 #0#0,     1, #0#3,  1, 0;
 #0#1, 99999, #0#3, 12, 0;
 ;
 NULL, lee_histo1;
|FIN;

|PROCESO gra_tmp;
    alfa1 = Usuario;     |QBT alfa1;    alfa1 = (alfa1 + "zzzzzzzz") % 108;
|NOME_DAT #10 alfa1;
|DELINDEX #10;
|ABRE #10;
|BUCLE lee_histo;
|CIERRA #10;
|FPRC;
____________________________________/ CALCULO PRINCIPAL
|PROCESO literal;
    tope = (#0#3 * 100) + #0#5;
    cuenta = 0;

|PARA para1 = (#0#3*100)+#0#4; |SI para1[tope; |HACIENDO para1=para1+1;

        cuenta = cuenta + 1;

        nume1 = para1 $ 100;
    |SI nume1 = 13; para1 = para1 + 88; |FINSI;

        nume1 = para1 $ 100;            alfa1 = nume1; alfa1 = ("00" + alfa1) % -102;
        nume2 = (para1 - nume1) / 100;  alfa2 = nume2;
    |SI cuenta = 1;  m1 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 2;  m2 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 3;  m3 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 4;  m4 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 5;  m5 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 6;  m6 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 7;  m7 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 8;  m8 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 9;  m9 = alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 10; m10= alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 11; m11= alfa1 + "-" + alfa2;     |FINSI;
    |SI cuenta = 12; m12= alfa1 + "-" + alfa2;     |FINSI;
|SIGUE;
|FPRC;

|PROCESO tipo3; |TIPO 3;
|IMPRE 0;
|SI FSalida = 0;
    |HAZ literal;
    |HAZ gra_tmp;
    |INFOR "labconal";
    |ABRE #1;
    |ABRE #2;
    |BUCLE lee_tmp;
    |CIERRA #1;
    |CIERRA #2;
    |SI seleccio ! 0;
        |PIEINF;
    |SINO;
        |MENAV "    Seleccion vacia ...";
    |FINSI;
    |FININF;
    |DELINDEX #10;
|SINO;
    |MENAV "    Proceso abortado ...";
|FINSI;
|FINIMP;
|FPRC;
