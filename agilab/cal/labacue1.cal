|FICHEROS;
     labtraba #2;
     labacue1 #87;
     labcontr;
     labcenfo;
     labempre;
     labcon86;
|FIN;

|VARIABLES;
     aValorOri = "";
     nIdCentro = 0;
     aIdCentro = "";
     aAlfa = "";
     aAlfa1 = "";
     nModo = 0;
     &nMes = 0;
     &aMes = "";
     nNume = 0;
|FIN;

|PROCESO MesLetra;
     |SI nMes = 1;  aMes = "Enero";      |FINSI;
     |SI nMes = 2;  aMes = "Febrero";    |FINSI;
     |SI nMes = 3;  aMes = "Marzo";      |FINSI;
     |SI nMes = 4;  aMes = "Abril";      |FINSI;
     |SI nMes = 5;  aMes = "Mayo";       |FINSI;
     |SI nMes = 6;  aMes = "Junio";      |FINSI;
     |SI nMes = 7;  aMes = "Julio";      |FINSI;
     |SI nMes = 8;  aMes = "Agosto";     |FINSI;
     |SI nMes = 9;  aMes = "Septiembre"; |FINSI;
     |SI nMes = 10; aMes = "Octubre";    |FINSI;
     |SI nMes = 11; aMes = "Noviembre";  |FINSI;
     |SI nMes = 12; aMes = "Diciembre";  |FINSI;
|FPRC;

|PROCESO PintaTipoForm_acuer_1; |TIPO 7;
     #87#45 = #labempre#15;    || nombre representante empresa
     |PINTA #87#45;
     #87#46 = #labempre#17;    || nombre representante empresa
     |PINTA #87#46;
     #87#47 = #labempre#18;    || nombre representante empresa
     |PINTA #87#47;

     |ABRE #labcontr; |LEE 000#labcontr.p; |CIERRA #labcontr;
     |ABRE #labcenfo;
     #labcenfo#23 = #labcontr#66;
     |LEE 000#labcenfo.=;
     |SI FSalida = 0;
          #87#23 = #labcenfo#23;   || codigo centro formacion
          #87#2 = #labcenfo#2;
          #87#3 = #labcenfo#3;
          #87#6 = #labcenfo#38;    || nombre representante centro
          #87#8 = #labcenfo#39;    || nif representante centro
          #87#51 = #labcenfo#40;   || cargo representante centro
          #87#4 = #labcenfo#4;     || direccion  centro
          #87#19 = #labcenfo#19;   || CP 1 centro
          #87#20 = #labcenfo#20;   || CP 2 centro
          #87#21 = #labcenfo#21;   || poblacion centro
          #87#50 = #labcon86#47;   || fecha firma

          |PINTA #87#23;
          |PINTA #87#2;
          |PINTA #87#3;
          |PINTA #87#6;
          |PINTA #87#8;
          |PINTA #87#51;
          |PINTA #87#4;
          |PINTA #87#19;
          |PINTA #87#20;
          |PINTA #87#21;
          |PINTA #87#50;

          #87#62 = #labcon86#46;   || localidad firma
          #87#63 = #labcon86#47 % 102;   || dia firma
          aAlfa = #labcon86#47 % 402;   || mes firma
          nMes = aAlfa;
          |HAZ MesLetra;
          #87#64 = aMes;   || mes firma
          aAlfa = #labcon86#47 % -104;   || a¤o firma
          #87#65 = aAlfa;                || a¤o firma

          |PINTA #87#62;
          |PINTA #87#63;
          |PINTA #87#64;
          |PINTA #87#65;
     |FINSI;
     |CIERRA #labcenfo;


     |ACABA;

     || de momento este acuerdo no lo uso para nada relacionado con lo de
     || Edutedis, si es necesario habra que tocar este punto y la pantalla
     || para construir la pantalla

     || pinto una pantalla u otra segun si la formacion esta concertada
     || o no con Edutedis

     |ABRE #labcontr; |LEE 000#labcontr.p; |CIERRA #labcontr;
     |SI #labcontr#67 = "S";
          || pinta el campo tercero del numero de registro de contrato
          || y fuerza el primero a uno

          |PINTA 1738, "                               ";
          |CAMPO_POSICION #labacue1#31, 1, 1749;
          |CAMPO_POSICION #labacue1#34, 1, 1754;
          |CAMPO_POSICION #labacue1#33, 1, 1762;

          |CAMPO_MODIFICA #labacue1#30, 1, "S";
          |CAMPO_VISUAL #labacue1#30, 1, "S";
          |CAMPO_POSICION #labacue1#30, 1, 1743;

          #labacue1#28 = "1";
          |CAMPO_MODIFICA #labacue1#28, 1, "N";

          |CAMPO_MODIFICA #labacue1#13, 1, "N";

          |PINTA #labacue1#28;
          |PINTA #labacue1#29;
          |PINTA #labacue1#30;
          |PINTA #labacue1#31;
          |PINTA #labacue1#34;
          |PINTA #labacue1#33;

          || datos de la empresa concertada (Edutedis)

          |CAMPO_MODIFICA #labacue1#2, 1, "N";
          |CAMPO_MODIFICA #labacue1#23, 1, "N";
          |CAMPO_MODIFICA #labacue1#22, 1, "N";
          |CAMPO_MODIFICA #labacue1#3, 1, "N";
          |CAMPO_MODIFICA #labacue1#4, 1, "N";
          |CAMPO_MODIFICA #labacue1#21, 1, "N";
          |CAMPO_MODIFICA #labacue1#19, 1, "N";
          |CAMPO_MODIFICA #labacue1#20, 1, "N";
          |CAMPO_MODIFICA #labacue1#24, 1, "N";
          |CAMPO_MODIFICA #labacue1#6, 1, "N";
          |CAMPO_MODIFICA #labacue1#5, 1, "N";
          |CAMPO_MODIFICA #labacue1#25, 1, "N";
          |CAMPO_MODIFICA #labacue1#26, 1, "N";

          || habilita la cuenta bancaria y la persona que firma
          || si es edutedis

          |CAMPO_MODIFICA #labacue1#38, 1, "S";
          |CAMPO_MODIFICA #labacue1#39, 1, "S";
          |CAMPO_MODIFICA #labacue1#40, 1, "S";
          |CAMPO_MODIFICA #labacue1#41, 1, "S";
          |CAMPO_MODIFICA #labacue1#42, 1, "S";

          |CAMPO_VISUAL #labacue1#38, 1, "S";
          |CAMPO_VISUAL #labacue1#39, 1, "S";
          |CAMPO_VISUAL #labacue1#40, 1, "S";
          |CAMPO_VISUAL #labacue1#41, 1, "S";
          |CAMPO_VISUAL #labacue1#42, 1, "S";
          |PINTA 2111, "CCC domiciliaci¢n recibos:";
          |PINTA 2211, "Firmado .................:";

          aAlfa1 = #labempre#113;
          aAlfa = aAlfa1 % 104;
          #labacue1#38 = aAlfa;
          aAlfa = aAlfa1 % 504;
          #labacue1#39 = aAlfa;
          aAlfa = aAlfa1 % 902;
          #labacue1#40 = aAlfa;
          aAlfa = aAlfa1 % 1110;
          #labacue1#41 = aAlfa;

          #labacue1#42 = #labempre#15;

          |PINTA #labacue1#38;
          |PINTA #labacue1#39;
          |PINTA #labacue1#40;
          |PINTA #labacue1#41;
          |PINTA #labacue1#42;

          #labacue1#18 = "D";
          |CAMPO_MODIFICA #labacue1#18, 1, "N";
          |PINTA #labacue1#18;
     |SINO;
          || no pinta el campo tercero del numero de registro de contrato
          || y no fuerza el primero a uno

          |PINTA 1738, "                               ";
          |CAMPO_POSICION #labacue1#31, 1, 1743;
          |CAMPO_POSICION #labacue1#34, 1, 1748;
          |CAMPO_POSICION #labacue1#33, 1, 1756;

          |CAMPO_MODIFICA #labacue1#30, 1, "N";
          |CAMPO_VISUAL #labacue1#30, 1, "N";
          |CAMPO_POSICION #labacue1#30, 1, 1774;

          |CAMPO_MODIFICA #labacue1#13, 1, "S";
          |CAMPO_MODIFICA #labacue1#28, 1, "S";

          |PINTA #labacue1#28;
          |PINTA #labacue1#29;
          |PINTA #labacue1#30;
          |PINTA #labacue1#31;
          |PINTA #labacue1#34;
          |PINTA #labacue1#33;

          || datos de la empresa concertada (NO Edutedis)

          |CAMPO_MODIFICA #labacue1#2, 1, "S";
          |CAMPO_MODIFICA #labacue1#23, 1, "S";
          |CAMPO_MODIFICA #labacue1#22, 1, "S";
          |CAMPO_MODIFICA #labacue1#3, 1, "S";
          |CAMPO_MODIFICA #labacue1#4, 1, "S";
          |CAMPO_MODIFICA #labacue1#21, 1, "S";
          |CAMPO_MODIFICA #labacue1#19, 1, "S";
          |CAMPO_MODIFICA #labacue1#20, 1, "S";
          |CAMPO_MODIFICA #labacue1#24, 1, "S";
          |CAMPO_MODIFICA #labacue1#6, 1, "S";
          |CAMPO_MODIFICA #labacue1#5, 1, "S";
          |CAMPO_MODIFICA #labacue1#25, 1, "S";
          |CAMPO_MODIFICA #labacue1#26, 1, "S";

          || deshabilita la cuenta bancaria y la persona que firma
          || si no es edutedis

          |CAMPO_MODIFICA #labacue1#38, 1, "N";
          |CAMPO_MODIFICA #labacue1#39, 1, "N";
          |CAMPO_MODIFICA #labacue1#40, 1, "N";
          |CAMPO_MODIFICA #labacue1#41, 1, "N";
          |CAMPO_MODIFICA #labacue1#42, 1, "N";

          |CAMPO_VISUAL #labacue1#38, 1, "N";
          |CAMPO_VISUAL #labacue1#39, 1, "N";
          |CAMPO_VISUAL #labacue1#40, 1, "N";
          |CAMPO_VISUAL #labacue1#41, 1, "N";
          |CAMPO_VISUAL #labacue1#42, 1, "N";
          |PINTA 2111, "                                                                     ";
          |PINTA 2211, "                                                                     ";

          |CAMPO_MODIFICA #labacue1#18, 1, "S";
     |FINSI;
|FPRC;

|PROCESO PintaCentro_acuer_1; |TIPO 7;
|ACABA;
     |ABRE #labcontr; |LEE 000#labcontr.p; |CIERRA #labcontr;
     nModo = (FEntrada / 100) ! 0;
     |MODULO aAlfa;
     |QBF aAlfa;
     |SI nModo ! 1;
||O #labcontr#67 ! "S";
          |ACABA;
     |FINSI;

     ||Y aAlfa ! "labcon85";

     aAlfa = #labcontr#66;
     |QBF aAlfa;
     |SI aAlfa ! "";
          #87#23 = aAlfa;
          |PINTA #87#23;
          |ABRE #labcenfo;
          #labcenfo#23 = aAlfa;
          |LEE 000#labcenfo.=;
          |SI FSalida = 0;
               #87#2 = #labcenfo#2;
               #87#22 = #labcenfo#22;
               #87#3 = #labcenfo#3;
               #87#4 = #labcenfo#4;
               #87#5 = #labcenfo#5;
               #87#6 = #labcenfo#6;
               #87#19 = #labcenfo#19;
               #87#20 = #labcenfo#20;
               #87#21 = #labcenfo#21;
               #87#24 = #labcenfo#24;
               #87#25 = #labcenfo#25;
               #87#26 = #labcenfo#26;
               |PINTA #87#2; |PINTA #87#22; |PINTA #87#3; |PINTA #87#4;
               |PINTA #87#5; |PINTA #87#6; |PINTA #87#19; |PINTA #87#20;
               |PINTA #87#21; |PINTA #87#24; |PINTA #87#25; |PINTA #87#26;
          |FINSI;
          |CIERRA #labcenfo;
     |FINSI;
|FPRC;

|PROCESO encarga_acuer_1; |TIPO 0;
|SI #87#16 ! 0;
    |SI #87#16 ! #87#1;
            #87#17 = "";
        |ABRE #2;
            #2#0 = #87#0;
            #2#1 = #87#16;
        |LEE 001#2=;
        |SI FSalida ! 0;
            |MENAV "    Trabajador inexistente ...";
            |ERROR;
        |SINO;
                #87#17 = #2#2;      || nombre
        |FINSI;
        |CIERRA #2;
        |PINTA #87#17;
    |SINO;
        |MENAV "    ATENCION!!! Es el mismo trabajador ...";
        |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO IdCentro_acuer_1;
     aValorOri = #87Campo;
     |QBF aValorOri;
     |SI aValorOri ! "";
          nIdCentro = #87Campo;
          aIdCentro = nIdCentro;
          aAlfa = aValorOri % 101;
          |SI aValorOri ! aIdCentro; |Y aAlfa ! "0";
               |MENAV "0000Valor no valido para el identificador del centro";
               |ERROR;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Ayuda27_1; |TIPO 7;
/*
     |SI #labcontr#67 = "S";
          |MENSA "    Codigo de ocupacion. Pulse < F3 > para elegir de la lista";
     |SINO;
          |MENSA "    Codigo de ocupacion.";
     |FINSI;
*/
|FPRC;

|PROCESO Chequea4849;
     |SI Campo = 48; |Y #87#48 = "X";
          |SI #87#49 = "X";
               #87#49 = " ";
               |PINTA #87#49;
          |FINSI;
     |FINSI;
     |SI Campo = 49; |Y #87#49 = "X";
          |SI #87#48 = "X";
               #87#48 = " ";
               |PINTA #87#48;
          |FINSI;
     |FINSI;
     |SI Campo = 49;
          |SI #87#48 = " "; |Y #87#49 = " ";
               aAlfa = "    ATENCION: es necesario marcar una de las dos ";
               aAlfa = aAlfa + "casillas para completar el acuerdo de formación.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ActivaIDFecha; |TIPO 7;
     |SI #87#49 = "X";
          |CAMPO_MODIFICA #87Campo, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #87Campo, 1, "N";
          #87Campo = "";
          |PINTA #87Campo;
     |FINSI;
|FPRC;

|PROCESO Chequea5253;
     |SI Campo = 52; |Y #87#52 = "X";
          |SI #87#53 = "X";
               #87#53 = " ";
               |PINTA #87#53;
          |FINSI;
     |FINSI;
     |SI Campo = 53; |Y #87#53 = "X";
          |SI #87#52 = "X";
               #87#52 = " ";
               |PINTA #87#52;
          |FINSI;
     |FINSI;
     |SI Campo = 53;
          |SI #87#52 = " "; |Y #87#53 = " ";
               aAlfa = "    ATENCION: es necesario marcar una de las dos ";
               aAlfa = aAlfa + "casillas para completar el acuerdo de formación.";
               |MENAV aAlfa;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO ActivaCamposCertProf; |TIPO 7;
     |SI #87#52 = "X";
          |CAMPO_MODIFICA #87Campo, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #87Campo, 1, "N";
          #87Campo = "";
          |PINTA #87Campo;
     |FINSI;
|FPRC;

|PROCESO ActivaCamposTitFP; |TIPO 7;
     |SI #87#53 = "X";
          |CAMPO_MODIFICA #87Campo, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #87Campo, 1, "N";
          #87Campo = "";
          |PINTA #87Campo;
     |FINSI;
|FPRC;
