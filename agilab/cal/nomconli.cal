|FICHEROS;
     nomconli #0;   || convenios lins.
     nomcorf1,MANTE;      || convenios lins.
|FIN;

|VARIABLES;
     nModo = 0;
|FIN;

|INCLUYE i_conli;

|PROCESO pdesam; |TIPO 13;
     |DDEFECTO #4;
     |ABRE #4;
     #4#0 = #0#0;     || convenio
     #4#1 = #0#2;     || concepto
     |LEE 000#4=;
     |CIERRA #4;

     |ATRI I;
     |PINTA 2238, #4#2;
     |ATRI 0;

|| migue

     |DDEFECTO #nomcorf1;
     |ABRE #nomcorf1;
     #nomcorf1#0 = #0#0;     || convenio
     #nomcorf1#1 = #0#2;     || concepto
     |LEE 000#nomcorf1.=;
     |CIERRA #nomcorf1;

     |PINPA #0#nomcorf1;
     |PINDA #0#nomcorf1;

|FPRC;

|PROCESO desam; |TIPO 3;
     |SI FSalida = 1;|O FSalida = 7;    |ACABA;   |FINSI;

     |ATRI R;  |MENSA "    Descripcion ampliada del concepto.";  |ATRI 0;

     |DDEFECTO #4;
     |ABRE #4;
     #4#0 = #0#0;     || convenio
     #4#1 = #0#2;     || concepto
     |LEE 101#4=;
     FEstado = FSalida;

     ampli = #4#2;

     E_sup = 25;
     E_inf = "";
     ampli = 2238 ? 1;
     |SI FSalida ! 7;
          |QBF ampli;
          #4#2 = ampli;
     |FINSI;

     |SI FEstado = 0;     |GRABA 020#4a; |FINSI;
     |SI FEstado ! 0;     |GRABA 020#4n; |FINSI;
     |LIBERA #4;
     |CIERRA #4;

     |ATRI R;
     |BLIN 4;
     |ATRI 0;

|| migue

     |ABRE #nomcorf1;
     #nomcorf1#0 = #0#0;
     #nomcorf1#1 = #0#2;
     |LEE 101#nomcorf1.=;
     FEstado = FSalida;
     |SI FSalida = 0;
          |HAZ DatosConcepto; || recoge descripciones por si cambiaron

          |PINPA #0#nomcorf1;
          |PINDA #0#nomcorf1;
          |ENDATOS #2#nomcorf1;
     |SINO;
          || ALTA DE CONCEPTO

          #nomcorf1#0 = #nomconli#0;
          #nomcorf1#1 = #nomconli#2;
          |HAZ DatosConcepto; || recoge descripciones para dar de alta

          |PINPA #0#nomcorf1;
          |PINDA #0#nomcorf1;
          |ENDATOS #1#nomcorf1;
     |FINSI;
     |SI FSalida = 0;
          |SI FEstado = 0;
               |GRABA 020#nomcorf1.a;
          |SINO;
               |GRABA 020#nomcorf1.n;
          |FINSI;
     |FINSI;
     |LIBERA #nomcorf1;
     |CIERRA #nomcorf1;

|FPRC;

|PROCESO DatosConcepto;
          #nomcorf1#2 = #nomconli#6;
          #nomcorf1#3 = ampli;
          |SI #nomconli#2 < 400;
               #nomcorf1#4 = "S";
          |SINO;
               |SI #nomconli#2 ] 400; |Y #nomconli#2 [ 499;
                    |SI #nomconli#11 = "S"; |Y #nomconli#12 = "7";
                         #nomcorf1#4 = "S";
                    |SINO;
                         #nomcorf1#4 = "N";
                    |FINSI;
               |SINO;
                    #nomcorf1#4 = "S";
               |FINSI;
          |FINSI;
|FPRC;

|PROCESO Borrado; |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ABRE #nomcorf1;
          #nomcorf1#0 = #0#0;
          #nomcorf1#1 = #0#2;
          |LEE 101#nomcorf1.=;
          |SI FSalida = 0;
               |BORRA 020#nomcorf1.a;
          |FINSI;
          |LIBERA #nomcorf1;
          |CIERRA #nomcorf1;
     |FINSI;
|FPRC;
