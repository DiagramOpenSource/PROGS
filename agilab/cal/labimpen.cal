|FICHEROS;
    labimpen #0;
    labclien #1;
    labclipa #2;
    labajust #3;
    labmeses #4;
|FIN;

|VARIABLES;
 varcampo = 0;
 xx = 0;
 yy = 0;
 primero = 0;
 base11 = 0;
 varmes = 0;
 diajub = 0;
 mesnum = 0;
 anojub = 0;
 anyipc = 0;
 any_ipc = 0;
 mescolum = 0;
 campo_any = 0;
 impcolum = 0;
 ipc = 0;
 acucot = 0;
 ipc_fijo = 0;
 bisiesto = 0;
 topemes = 0;
 nume0 = 0;
    mensaje1 = "    NO EXISTE IMPRESORA !";
    mensaje2 = "    NO EXISTE INFORME !";
    informe1 = "labimpen";
    informe2 = "labimpe2";
    &raya    = "           ";
    &desde   = "           ";
    &hasta   = "           ";
    vacio    = "           ";
    &suma = 0;
    anyalf   = "";
    anyalfcol   = "";
    anynum   = 0;
    jubilaany = "  ";
    jubilames = " ";
    contmes = 0;
    campo = 0;
    &mes   = "          ";
    &ano   = 0;
    &coti  = 0;
    &reg   = 0;
    &total = 0;
    &mess = "           ";
    &ano2 = 0;
    &coti2 = 0;
    &reg2 = 0;
    &total2 = 0;
    &lin = 0;
    alfa1 = "";
    alfa2 = "";
    alfa3 = "";
|FIN;

|PROCESO imprimir;
|INFOR informe1;
    raya  = "           ";
    desde = "           ";
    hasta = "           ";
|SI #1#6 = "F";
    |ABRE #4;
        raya  = "===========";
        desde = "DESDE FECHA";
        hasta = "HASTA FECHA";
        varcampo = 0;
    |PARA xx = 9;|SI xx [ 80;|HACIENDO xx = xx + 2;
            yy = xx + 1;
        |SI #1xx ! #1yy;
                #4varcampo = #1xx;
                varcampo = varcampo + 1;
                #4varcampo = #1yy;
                varcampo = varcampo + 1;
        |FINSI;
    |SIGUE;
    |PRINT;
    |PIEINF;
    |FININF;
    |CIERRA #4;
    |HAZ pantalla_2;
|SINO;
    |PRINT;
    |PIEINF;
    |FININF;
    |HAZ pantalla_2;
|FINSI;
|FPRC;

|DEFBUCLE labimpen0;
#1#1;
;
#0#0;
#0#1;
e;
NULL, imprimir;
|FIN;

|PROCESO impre;|TIPO 3;
|IMPRE 0;
|SI FSalida = 0;
    |BUCLE labimpen0;
    |FINIMP;
|SINO;
    |MENAV mensaje1;
|FINSI;
|FPRC;

|PROCESO pantalla_2;
|INFOR informe2;
|ABRE #2;
|ABRE #3;
|DDEFECTO #2;
    #2#0 = #1#0;
|LEE 040#2=;
    primero = 0;
    base11  = 0;
    campo   = 0;
    varmes  = 0;

    alfa1 = #1#5;
    alfa2 = alfa1 %  102;   diajub = alfa2;
    alfa2 = alfa1 % -102;   jubilaany = alfa2;
    alfa2 = alfa1 %  402;   jubilames = alfa2;
|HAZ ulti_dia;
|SI diajub ! topemes;
        mesnum = jubilames - 1;
|SINO;
        mesnum = jubilames;
|FINSI;

     anojub = jubilaany;
     ano = anojub;

|SI mesnum = 0;
        ano = anojub - 1;
    |SI ano < 0;  ano = 100 + ano;  |FINSI;
        mesnum = 12;
|FINSI;

    ano2   = ano - 4;
|SI ano2 < 0;  ano2 = 100 + ano2;  |FINSI;
    anynum = ano;
    anyipc = ano - 2;
|SI anyipc < 0;  anyipc = 100 + anyipc; |FINSI;
|PARA any_ipc = 4;|SI any_ipc [ 55;|HACIENDO any_ipc = any_ipc + 13;
        mescolum  = any_ipc + 52;
     campo_any = any_ipc + 1;
        impcolum  = mescolum + 1;
    |PARA contmes = 108;|SI contmes [ 119;|HACIENDO contmes = contmes + 1;
     |SI #2contmes = "ENERO     ";ipc = 1; |VETE suma;|FINSI;
     |SI #2contmes = "FEBRERO   ";ipc = 2; |VETE suma;|FINSI;
     |SI #2contmes = "MARZO     ";ipc = 3; |VETE suma;|FINSI;
     |SI #2contmes = "ABRIL     ";ipc = 4; |VETE suma;|FINSI;
     |SI #2contmes = "MAYO      ";ipc = 5; |VETE suma;|FINSI;
     |SI #2contmes = "JUNIO     ";ipc = 6; |VETE suma;|FINSI;
     |SI #2contmes = "JULIO     ";ipc = 7; |VETE suma;|FINSI;
     |SI #2contmes = "AGOSTO    ";ipc = 8; |VETE suma;|FINSI;
     |SI #2contmes = "SEPTIEMBRE";ipc = 9; |VETE suma;|FINSI;
     |SI #2contmes = "OCTUBRE   ";ipc = 10;|VETE suma;|FINSI;
     |SI #2contmes = "NOVIEMBRE ";ipc = 11;|VETE suma;|FINSI;
     |SI #2contmes = "DICIEMBRE ";ipc = 12;|FINSI;
        |ET suma;

        |SI primero = 1;
            |SI #2contmes = "DICIEMBRE ";
                    ano = ano - 1;
                |SI ano < 0;  ano = 100 + ano;  |FINSI;
                    anynum = anynum - 1;
                |SI anynum < 0;  anynum = 100 + anynum;  |FINSI;
                    ano2 = ano2 - 1;
                |SI ano2 < 0;  ano2 = 100 + ano2;  |FINSI;
            |FINSI;
        |SINO;
            |HAZ ipc;
        |FINSI;

     |DDEFECTO #3;
            #3#0 = anynum;
     |LEE 040#3=;
        |SI campo_any [ 30;
                acucot = acucot + #2campo_any;
        |FINSI;
        |SI campo_any ] 31;
                reg = ipc_fijo / #3ipc;
                total = reg * #2campo_any;
        |FINSI;
            mes  = #2contmes;
            coti = #2campo_any;
         campo_any = campo_any + 1;
        |SI campo_any = 100;  campo_any = 0;  |FINSI;
        |HAZ columna2;
         suma = suma + total + total2;
        |PRINT;
            primero = 1;
     |SIGUE;
    |SIGUE;
        lin = 1;
        suma = suma + acucot;
    |PRINT;
    |PIEINF;
    |FININF;
|CIERRA #2;
|CIERRA #3;
|FPRC;

|PROCESO columna2;
|DDEFECTO #3;
    #3#0 = ano2;
|LEE 040#3=;
|SI #2contmes = "ENERO     ";ipc = 1; |VETE suma2;|FINSI;
|SI #2contmes = "FEBRERO   ";ipc = 2; |VETE suma2;|FINSI;
|SI #2contmes = "MARZO     ";ipc = 3; |VETE suma2;|FINSI;
|SI #2contmes = "ABRIL     ";ipc = 4; |VETE suma2;|FINSI;
|SI #2contmes = "MAYO      ";ipc = 5; |VETE suma2;|FINSI;
|SI #2contmes = "JUNIO     ";ipc = 6; |VETE suma2;|FINSI;
|SI #2contmes = "JULIO     ";ipc = 7; |VETE suma2;|FINSI;
|SI #2contmes = "AGOSTO    ";ipc = 8; |VETE suma2;|FINSI;
|SI #2contmes = "SEPTIEMBRE";ipc = 9; |VETE suma2;|FINSI;
|SI #2contmes = "OCTUBRE   ";ipc = 10;|VETE suma2;|FINSI;
|SI #2contmes = "NOVIEMBRE ";ipc = 11;|VETE suma2;|FINSI;
|SI #2contmes = "DICIEMBRE ";ipc = 12;|FINSI;
|ET suma2;
    reg2 = ipc_fijo / #3ipc;
    total2 = reg2 * #2impcolum;
    mess  = #2contmes;
    coti2 = #2impcolum;
    impcolum = impcolum + 1;
|FPRC;

|PROCESO ipc;
|DDEFECTO #3;
    #3#0 = anyipc;
|LEE 040#3=;
    ipc_fijo = #3ipc;
|FPRC;

|PROCESO ulti_dia;
    nume0 = jubilaany $ 4;
|SI nume0 = 0; bisiesto = 1;  |FINSI;
|SI nume0 ! 0; bisiesto = 0;  |FINSI;
|SI jubilames =  1;  topemes = 31;  |FINSI;
|SI jubilames =  2;  topemes = 28 + bisiesto;  |FINSI;
|SI jubilames =  3;  topemes = 31;  |FINSI;
|SI jubilames =  4;  topemes = 30;  |FINSI;
|SI jubilames =  5;  topemes = 31;  |FINSI;
|SI jubilames =  6;  topemes = 30;  |FINSI;
|SI jubilames =  7;  topemes = 31;  |FINSI;
|SI jubilames =  8;  topemes = 31;  |FINSI;
|SI jubilames =  9;  topemes = 30;  |FINSI;
|SI jubilames = 10;  topemes = 31;  |FINSI;
|SI jubilames = 11;  topemes = 30;  |FINSI;
|SI jubilames = 12;  topemes = 31;  |FINSI;
|FPRC;
