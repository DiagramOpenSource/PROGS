|FICHEROS;
   labempre #0;
   labtraba #1;
   labcomed #2;
   labcentr #3;
   labpadre #4;
   labcontr #100;
|FIN;

|VARIABLES;
 x = 0;
 mod = 0;
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    mensaje1 = "0000ATENCION !!! Fecha erronea ...";
    dia1 = "";
    mes1 = "";
    any1 = "";
    dia = 0;
    mes = 0;
    any = 0;
    tope = 0;
    sw = 0;
    fec = "";
    blanco = "          ";
    puntos = "..........";
    men1 = "     NO EXITE REGISTRO DE EMPRESA";
    men2 = "     NO EXITE REGISTRO DE TRABAJADORES";
    men3 = "     LA FECHA DEBE SER SUPERIOR A 15 DIAS";
    men4 = "     NO EXISTE IMPRESORA";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    loca = "";
    loca1 = "";
    &local = "";
    &fcom = "";
    diacom = "";
    mescom = "";
    anycom = "";
    diaobra = "";
    mesobra = "";
    anyobra = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    guion = ".";
    guiones = "";
    varnum = 0;
    varnum1 = 0;
    varalfa1 = "";
    varalfa2 = "";
    &nombret = "";
    &localit = "";
    &domicit = "";
    &nombremp = "";
    &domiemp = "";
    &localemp = "";
    &categ = "";
    &centro = "";
    &activi = "";
    &conveni = "";
    &comunic = "";
    &motivo = "";
    &suplica = "";
    &dnit = "";
    &sgut = "";
    &sguemp = "";
    &import = "";
    &numt = "";
    &nuemp = "";
    &salario = "";
    casado = "CASADO ";
    soltero = "SOLTERO";
    minu = "m";
    mayu = "M";
    mensual = "MENSUAL";
    diario =  "DIARIO ";
    naci = "";
    actu = "";
    naci1 = 0;
    actu1 = 0;
    edad = 0;
    edad1 = 0;
    mesn = "";
    mesac = "";
    mesn1 = 0;
    mesac1 = 0;
    diac = "";
    dian = "";
    diac1 = 0;
    dian1 = 0;
    ed = "";
    ed1 = "";
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     aAlfa4 = "";
     aAlfa5 = "";
     aAlfa6 = "";
     aAlfa7 = "";
     fFechaHoy = @;
     &nEdad = 0;
     nNume1 = 0;
     nNume2 = 0;
     FEstado = 0;
|FIN;

|INCLUYE i_comun;

|PROCESO campos; |TIPO 0;
|SI #2#32 = "C";
    |CAMPO_MODIFICA #2#33, 1, "S";
    |CAMPO_MODIFICA #2#34, 1, "S";
    |CAMPO_MODIFICA #2#36, 1, "S";
    |CAMPO_MODIFICA #2#37, 1, "S";
    |CAMPO_MODIFICA #2#38, 1, "S";
    |CAMPO_MODIFICA #2#39, 1, "S";
    |CAMPO_MODIFICA #2#40, 1, "S";
    |CAMPO_MODIFICA #2#41, 1, "S";

    |CAMPO_MODIFICA #2#7, 1, "N";
    |CAMPO_MODIFICA #2#8, 1, "N";
    |CAMPO_MODIFICA #2#9, 1, "N";
    |CAMPO_MODIFICA #2#10, 1, "N";
    |CAMPO_MODIFICA #2#30, 1, "N";
    |CAMPO_MODIFICA #2#31, 1, "N";
|FINSI;
|FPRC;

|PROCESO compru1;|TIPO 0;
|ABRE #0;
    #0#0 = #2#12;
|LEE 040#0=;
|SI FSalida ! 0; |Y #2#12 ! 0;
    |MENAV men1;
    |ERROR;
|SINO;
    #2#0 = #0#36;  |PINTA #2#0;
    #2#35 = #0#10; |PINTA #2#35;
    #2#13 = #0#2;  |PINTA #2#13;
    #2#14 = #0#3;  |PINTA #2#14;
    #2#15 = #0#4;  |PINTA #2#15;
    #2#16 = #0#6;  |PINTA #2#16;
    #2#17 = #0#13; |PINTA #2#17;
    #2#5 = #0#12;  |PINTA #2#5;

     aAlfa1 = #0#7; aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa2 = #0#8; aAlfa2 = ("000" + aAlfa2) % -103;
     aAlfa = aAlfa1 + aAlfa2;
     #2#42 = aAlfa; |PINTA #2#42;
     #2#43 = #0#14; |PINTA #2#43;
|FINSI;
|CIERRA #0;
|DDEFECTO #0;
|FPRC;


|PROCESO compru2;|TIPO 0;
|ABRE #1;
|ABRE #3;
|ABRE #4;
    #1#0 = #2#12;
    #1#1 = #2#18;
|LEE 000#1=;
|SI FSalida ! 0; |Y #2#18 ! 0;
    |MENAV men2;
    |ERROR;
|FINSI;
    #2#1 = #1#18;
    #2#2 = #1#42;
    #2#6 = #1#25;
    #2#19 = #1#2;
    #2#20 = #1#11;
    #2#22 = #1#7;
    #2#23 = #1#75;
    #2#24 = #1#6;
    #2#25 = #1#3;
    #2#26 = #1#4;
    #2#27 = #1#8;
    #2#28 = #1#9;
    #2#0 = #1#36;

    #3#0 = #2#12;
    #3#1 = #1#77;
|LEE 000#3=;

    #4#0 = #1#0;
    #4#1 = #1#1;
|LEE 000#4=;
|SI #4#4 = "S";
       #2#21 = soltero;
|SINO;
       #2#21 = casado;
|FINSI;

    #2#4 = #3#2;
/*
|SI #1#11 = ".........."; |O #1#11 = "          ";
    #2#20 = "";
    |VETE termina;
|FINSI;
 naci = #1#11 % A704;
 actu = #2#11 % A704;
 naci1 = naci;
 actu1 = actu;
 edad = actu - naci;
 edad1 = edad - 1;
 ed = edad;
 ed1 = edad1;
 mesn = #1#11 % A402;
 mesac = #2#11 % A402;
 mesn1 = mesn;
 mesac1 = mesac;
 diac = #2#11 % A102;
 dian = #1#11 % A102;
 diac1 = diac;
 dian1 = dian;
|SI mesac1 > mesn1;
     #2#20 = ed;
    |VETE termina;
|FINSI;
|SI mesac1 = mesn1;|Y diac1 ] dian1;
     #2#20 = ed;
    |VETE termina;
|FINSI;
     #2#20 = ed1;
*/

|ET termina;
|CIERRA #1;
|CIERRA #3;
|CIERRA #4;
|DDEFECTO #1;
|PINDA #0#2;
|FPRC;



|PROCESO estado;|TIPO 7;
     |PINTA #2#21;
|FPRC;


|PROCESO edad;|TIPO 7;
     |PINTA #2#20;
|FPRC;


|PROCESO varios;
|| *************************************************************************
|| ********************* PASAR VARIABLES A FORMATO INFORME  ****************
|| *************************************************************************

 varalfa1 = #2#19;            || nombre del trabajador;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 40 - varnum1;
    guiones = guion * varnum;
    nombret = varalfa1 + guiones;

 varalfa1 = #2#24;            || localidad trabajador;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 13 - varnum1;
    guiones = guion * varnum;
    localit = varalfa1 + guiones;

 varalfa1 = #2#25;            ||  domicilio trabajador
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 32 - varnum1;
    guiones = guion * varnum;
    domicit = varalfa1 + guiones;

     aAlfa1 = #2#20;          || EDAD DEL TRABAJADOR
     fFechaHoy = ~;
     aAlfa2 = fFechaHoy;
     aAlfa1 = aAlfa1 % -104;
     aAlfa2 = aAlfa2 % -104;
     nNume1 = aAlfa1;
     nNume2 = aAlfa2;
     nEdad = nNume2 - nNume1;

     aAlfa1 = #2#20;
     aAlfa2 = fFechaHoy;
     aAlfa1 = aAlfa1 % 402;
     aAlfa2 = aAlfa2 % 402;
     nNume1 = aAlfa1;
     nNume2 = aAlfa2;
     |SI nNume1 ] nNume2;
          |SI nNume1 > nNume2;
               nEdad = nEdad - 1;
          |SINO;
               aAlfa1 = #2#20;
               aAlfa2 = fFechaHoy;
               aAlfa1 = aAlfa1 % 102;
               aAlfa2 = aAlfa2 % 102;
               nNume1 = aAlfa1;
               nNume2 = aAlfa2;
               |SI nNume1 > nNume2;
                    nEdad = nEdad - 1;
               |FINSI;
          |FINSI;
     |FINSI;

 varalfa1 = #2#13;            ||nombre empresa;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 35 - varnum1;
    guiones = guion * varnum;
    nombremp = varalfa1 + guiones;

 varalfa1 = #2#14;            ||  domicilio empresa;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 35 - varnum1;
    guiones = guion * varnum;
    domiemp = varalfa1 + guiones;

 varalfa1 = #2#16;             ||localidad  empresa;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 32 - varnum1;
    guiones = guion * varnum;
    localemp = varalfa1 + guiones;

 varalfa1 = #2#1;               ||   categoria;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 20 - varnum1;
    guiones = guion * varnum;
    categ = varalfa1 + guiones;

 varalfa1 = #2#4;                ||   centro;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 20 - varnum1;
    guiones = guion * varnum;
    centro = varalfa1 + guiones;

 varalfa1 = #2#5;                ||  actividad;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 40 - varnum1;
    guiones = guion * varnum;
    activi = varalfa1 + guiones;

 varalfa1 = #2#6;                 ||   convenio;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 65 - varnum1;
    guiones = guion * varnum;
    conveni = varalfa1 + guiones;

 varalfa1 = #2#7;                 ||comunicacion
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 10 - varnum1;
    guiones = guion * varnum;
    comunic = varalfa1 + guiones;

 varalfa1 = #2#9;                 ||   motivo;
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 60 - varnum1;
    guiones = guion * varnum;
    motivo = varalfa1 + guiones;

 varalfa1 = #2#10;                 ||  suplica
 |QBF varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 60 - varnum1;
    guiones = guion * varnum;
    suplica = varalfa1 + guiones;

 varalfa1 = #2#22;                 || D.N.I. trabajador;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 10 - varnum1;
    guiones = guion * varnum;
    dnit = guiones + varalfa1;

 varalfa1 = #2#23;                  || numero seguridad social trabajador;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 12 - varnum1;
    guiones = guion * varnum;
    sgut = guiones + varalfa1;

 varalfa1 = #2#17;                   ||numero seg.social empresa;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 12 - varnum1;
    guiones = guion * varnum;
    sguemp = guiones + varalfa1;

 varalfa1 = #2#3;                     ||  importe;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 9 - varnum1;
    guiones = guion * varnum;
    import = guiones + varalfa1;

 |SI #2#2 = minu;|O #2#2 = mayu;
        salario = mensual;
 |SINO;
        salario = diario;
 |FINSI;

 varalfa1 = #2#26;                    ||   numero del trabajador;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 3 - varnum1;
    guiones = guion * varnum;
    numt = guiones + varalfa1;

 varalfa1 = #2#15;                    ||numero de la empresa;
 |QBT varalfa1;
    varalfa2 = varalfa1 % A0;
    varnum1 = varalfa2;
    varnum = 3 - varnum1;
    guiones = guion * varnum;
    nuemp = guiones + varalfa1;

|| **********************************************************************
|| ******************************* FECHA EN LETRAS **********************
|| **********************************************************************

fechacom = #2#11;
diacom = fechacom % A102;
mescom = fechacom % A402;
anycom = fechacom % A704;
  |SI mescom = 01;  fechacom =  uno;    |FINSI;
  |SI mescom = 02;  fechacom =  dos ;   |FINSI;
  |SI mescom = 03;  fechacom = tres;    |FINSI;
  |SI mescom = 04;  fechacom = cuatro;  |FINSI;
  |SI mescom = 05;  fechacom = cinco;   |FINSI;
  |SI mescom = 06;  fechacom = seis;    |FINSI;
  |SI mescom = 07;  fechacom = siete;   |FINSI;
  |SI mescom = 08;  fechacom = ocho;    |FINSI;
  |SI mescom = 09;  fechacom = nueve;   |FINSI;
  |SI mescom = 10;  fechacom = diez;    |FINSI;
  |SI mescom = 11;  fechacom = once;    |FINSI;
  |SI mescom = 12;  fechacom = doce;    |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    loca = #2#24;
    |QBF loca;
    local = loca + " ," + fcom;
||    loca1 = #2#24 - loca;
||    local = loca1 + loca;
|FPRC;

|PROCESO checfech; |TIPO 0;
        fec = #2Campo; sw = 0;
|SI fec ! blanco; |Y fec ! puntos;
  dia1 = fec % A102;
  mes1 = fec % A402;
  any1 = fec % A704;
  dia = dia1; mes = mes1; any = any1;
  |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
     |SI mes [ 12; |Y mes ] 1;
       |SI mes = 1; |O mes = 3; |O mes = 5; |O mes = 7; |O mes = 8; |O mes = 10; |O mes = 12;
           tope = 31;
       |SINO;
           |SI mes = 2;
               mod = any $ 4;
               |SI mod = 0;
                   tope = 29;
               |SINO;
                   tope = 28;
               |FINSI;
            |SINO;
               tope = 30;
            |FINSI;
        |FINSI;
        |SI dia [ tope;
            sw = 1;
        |FINSI;
     |FINSI;
  |FINSI;
|SINO;
  sw = 1;
|FINSI;
|SI sw = 0;
    |MENAV mensaje1;
    |ERROR;
|FINSI;
|FPRC;

|PROCESO noentres; |TIPO 7;
|SI #2#12 ! 0;
        xxaponer = Anono;
        xxxxfiac = Control % A1001;
        Control = Control + xxxxfiac;
        Control = Control + xrelleno;
        Control = Control % A120;
        Control = Control + xxaponer;
|SINO;
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;

|PROCESO nopases; |TIPO 7;
|SI #2#18 ! 0;
        xxaponer = Anono;
        xxxxfiac = Control % A1001;
        Control = Control + xxxxfiac;
        Control = Control + xrelleno;
        Control = Control % A120;
        Control = Control + xxaponer;
|SINO;
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;

|PROCESO impre;
     |HAZ r_regis0;   r_emp = #2#12;  |HAZ r_regis1;

     |ABRE #100; |LEE 000#100p; |CIERRA #100;
     #100#60 = "N";
     |SI #100#60 = "S";
          Impresora = "CrystalReport";
          |IMPRE -1;
     |SINO;
          |IMPRE 0;
     |FINSI;
     |SI Impresora = "CrystalReport";
          |MENAV "    ATENCION: Informe no disponible en formato Crystal Reports";
          |ACABA;
     |FINSI;

     |SI FSalida = 0;
          |HAZ varios;
          |PARA x = 1;|SI x [ #2#29;|HACIENDO x = x + 1;
               |SI #2#32 = "D"; |INFOR "labcomed";  |FINSI;
               |SI #2#32 = "C"; |INFOR "labcome1";  |FINSI;
               |PRINT;
               |PIEINF;
               |FININF;
          |SIGUE;
     |SINO;
          |MENAV men4;
     |FINSI;
     |FINIMP;
|FPRC;

|PROCESO PintaSuplica;
     |SALVA_DATOS #2;
     #2#44 = #2#32;
     |LEE 000#2=;
     FEstado = FSalida;
     |SI FEstado = 0;
          aAlfa1 = #2#10;
          aAlfa2 = #2#31;

          aAlfa3 = #2#37;
          aAlfa4 = #2#38;
          aAlfa5 = #2#39;
          aAlfa6 = #2#40;
          aAlfa7 = #2#41;
     |FINSI;
     |REPON_DATOS #2;
     #2#10 = aAlfa1;
     #2#31 = aAlfa2;
     |PINTA #2#10;
     |PINTA #2#31;

     #2#37 = aAlfa3;
     #2#38 = aAlfa4;
     #2#39 = aAlfa5;
     #2#40 = aAlfa6;
     #2#41 = aAlfa7;
     |PINTA #2#37;
     |PINTA #2#38;
     |PINTA #2#39;
     |PINTA #2#40;
     |PINTA #2#41;
|FPRC;

|PROGRAMA;
     |CLS;
     |ABRE #2;
     |DDEFECTO #2;

     |PINPA #0#2
     |PINDA #0#2;

     |ENDATOS #1#2;

     |SI FSalida = 0;
          |HAZ impre;
     |FINSI;

     #2#44 = #2#32;
     |SI FEstado = 0;
          |GRABA 000#2a;
     |SINO;
          |GRABA 000#2n;
     |FINSI;

     |CIERRA #2;
|FPRO;
