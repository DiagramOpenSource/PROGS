|FICHEROS;
   labempre #0;
   labtraba #1;
   labcomel #2;
   labregis #3;
|FIN;


|VARIABLES;
 x = 0;
    puntos = "";
    trabalf = "";
    xxxxfiac = "  ";
    xxaponer = "  ";
    xrelleno = "                              ";
    informe1 = "labcomel";
    informe2 = "labcome2";
    men1 = "     NO EXITE REGISTRO DE EMPRESA";
    men2 = "     NO EXITE REGISTRO DE TRABAJADORES";
    men3 = "     AVISO!!! La fecha es INFERIOR a 15 dias ...";
    men4 = "     NO EXISTE IMPRESORA";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    fechobra = "";
    loca = "";
    loca1 = "";
    &local = "";
    &fcom = "";
    &fobra = "";
    diacom = "";
    mescom = "";
    anycom = "";
    diaobra = "";
    mesobra = "";
    anyobra = "";
    espacio  = " "
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    unob =       " Enero.....";
    dosb =       " Febrero...";
    tresb =      " Marzo.....";
    cuatrob =    " Abril.....";
    cincob =     " Mayo......";
    seisb =      " Junio.....";
    sieteb =     " Julio.....";
    ochob =      " Agosto....";
    nueveb =     " Septiembre";
    diezb =      " Octubre...";
    onceb =      " Noviembre.";
    doceb =      " Diciembre.";
    calle1 = "";
    &calle = "";
    numca = "";
    piso = "";
    comaespa = ", "
    espa = " ";
    calle2 = "";
    &callet = "";
    numcat = "";
    pisot = "";
    minu = "m";
    mayu = "M";
    amayu = "A";
    aminu = "a";
    xdias = " dias";
    xmeses = " meses";
    xy = " y ";
    mesestra = 0;
    diastra = 0;
    &varal = "";
    &repre = "";
    &cargo = "";
    &activ = "";
    &afili = "";
|FIN;

|INCLUYE i_comun;

|PROCESO defregis;        || carga los campos desde Registro de Contratos
|ABRE #3;
|SELECT #2#3;
   #3#1 = #2#0;
   #3#2 = #2#10;
|LEE 040#3=;
|SI FSalida = 0;
    |SI #3#15 = 0;
        #2#9 = #3#8;             || iguala a fecha fin contrato
    |SINO;
        #2#9 = #3#20;            || iguala a fecha fin prorroga
    |FINSI;
    fechanum = #2#9;             || calcula fecha comunicacion
    fechanum = fechanum - 15;
    #2#8 = fechanum;
    #2#18 = #3#18;               || iguala acumulado meses
    #2#19 = #3#22;               || iguala acumulado dias
|SINO;
    #2#9 = ~;
    fechanum = #2#9;
    fechanum = fechanum - 15;
    #2#8 = fechanum;
    #2#18 = 0;
    #2#19 = 0;
|FINSI;
|PINTA #2#8;
|PINTA #2#9;
|PINTA #2#18;
|PINTA #2#19;
|CIERRA #3;
|FPRC;

|PROCESO fecha;|TIPO 0;
|SI FSalida ! 2;
        fechanum = #2#9 - #2#8;
    |SI fechanum < 15;
        |MENAV men3;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO varios;
    fechacom = #2#8;
    fechobra = #2#9;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
    diaobra = fechobra % A102;
    mesobra = fechobra % A402;
    anyobra = fechobra % A704;
  |SI mescom = 01;
    fechacom =  uno;
  |FINSI;
  |SI mescom = 02;
    fechacom =  dos ;
  |FINSI;
  |SI mescom = 03;
    fechacom = tres;
  |FINSI;
  |SI mescom = 04;
    fechacom = cuatro;
  |FINSI;
  |SI mescom = 05;
    fechacom = cinco;
  |FINSI;
  |SI mescom = 06;
    fechacom = seis;
  |FINSI;
  |SI mescom = 07;
    fechacom = siete;
  |FINSI;
  |SI mescom = 08;
    fechacom = ocho;
  |FINSI;
  |SI mescom = 09;
    fechacom = nueve;
  |FINSI;
  |SI mescom = 10;
    fechacom = diez;
  |FINSI;
  |SI mescom = 11;
    fechacom = once;
  |FINSI;
  |SI mescom = 12;
    fechacom = doce;
  |FINSI;
  |SI mesobra = 01;
    fechobra = unob;
  |FINSI;
  |SI mesobra = 02;
    fechobra = dosb;
  |FINSI;
  |SI mesobra = 03;
    fechobra = tresb;
  |FINSI;
  |SI mesobra = 04;
    fechobra = cuatrob;
  |FINSI;
  |SI mesobra = 05;
    fechobra = cincob;
  |FINSI;
  |SI mesobra = 06;
    fechobra = seisb;
  |FINSI;
  |SI mesobra = 07;
    fechobra = sieteb;
  |FINSI;
  |SI mesobra = 08;
    fechobra = ochob;
  |FINSI;
  |SI mesobra = 09;
    fechobra = nueveb;
  |FINSI;
  |SI mesobra = 10;
    fechobra = diezb;
  |FINSI;
  |SI mesobra = 11;
    fechobra = onceb;
  |FINSI;
  |SI mesobra = 12;
    fechobra = doceb;
  |FINSI;
    fcom = diacom + fechacom;
    fcom = fcom + anycom;
    fobra = diaobra + fechobra;
    loca = #2#5;
    |QBF loca;
    loca1 = #2#5 - loca;
    local = loca1 + loca;
    calle1 = #2#2;
    numca = #2#3;
    piso = #2#4;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numca;
    calle = calle + espa;
    calle = calle + piso;
    calle2 = #2#12;
    numcat = #2#13;
    pisot = #2#14;
    |QBF calle2;
    callet = calle2 + comaespa;
    callet = callet + numcat;
    callet = callet + espa;
    callet = callet + pisot;
    trabalf = #0#18; |QBF trabalf; trabalf = trabalf + puntos; #0#18 = trabalf;
    trabalf = #0#02; |QBF trabalf; trabalf = trabalf + puntos; #0#02 = trabalf;
    trabalf = #0#12; |QBF trabalf; trabalf = trabalf + puntos; #0#12 = trabalf;
    trabalf = #1#18; |QBF trabalf; trabalf = trabalf + puntos; #1#18 = trabalf;
    trabalf = #0#13; |QBF trabalf; trabalf = trabalf + puntos; #0#13 = trabalf;
    trabalf = #0#15; |QBF trabalf; trabalf = trabalf + puntos; #0#15 = trabalf;
||  trabalf = #2#11; |QBF trabalf; trabalf = trabalf + puntos; #2#11 = trabalf;
||  trabalf = callet;|QBF trabalf; trabalf = trabalf + puntos; callet= trabalf;
|HAZ litedura;
|FPRC;

|PROCESO impre;|TIPO 3;
|HAZ r_regis0;   r_emp = #2#0;  |HAZ r_regis1;
|IMPRE 0;
|SI FSalida = 0;
    |HAZ varios;
    |PARA x = 1;|SI x [ #2#20;|HACIENDO x = x + 1;
        |SI #2#21 = "A"; |O #2#21 = "a"; |INFOR informe1; |FINSI;
        |SI #2#21 = "B"; |O #2#21 = "b"; |INFOR informe2; |FINSI;
        |PRINT;
        |PIEINF;
        |FININF;
    |SIGUE;
|SINO;
    |MENAV men4;
|FINSI;
|FINIMP;
|FPRC;

|PROCESO litedura;              || CONSTRUYE LITERAL DURACION PARA IMPRESION
    mesestra = #2#18;
    diastra = #2#19;
    varal = "";
    |SI mesestra ! 0;
        varal = mesestra;
        varal = varal + xmeses;
    |SINO;
        varal = "...........";
    |FINSI;
    |SI diastra ! 0;
        |SI mesestra ! 0;
            varal = varal + xy;
        |FINSI;
        varal = varal + diastra;
        varal = varal + xdias;
    |SINO;
        varal = varal + "............";
    |FINSI;
|FPRC;

|PROCESO modelo; |TIPO 7;
|CAMPO_MODIFICA #2#22, 1, "S";
|CAMPO_MODIFICA #2#23, 1, "S";
|SI #2#21 = "A"; |O #2#21 = "a";
    |CAMPO_MODIFICA #2#22, 1, "N";
    |CAMPO_MODIFICA #2#23, 1, "N";
|FINSI;
|FPRC;

|PROCESO compru1;|TIPO 0;
|ABRE #0;
    #0#0 = #2#0;
     |LEE 040#0=;
       |SI FSalida ! 0; |Y #2#0 ! 0;
          |MENAV men1;
          |ERROR;
       |SINO;
              #2#1 = #0#2;  |PINTA #2#1;
              #2#2 = #0#3;  |PINTA #2#2;
              #2#3 = #0#4;  |PINTA #2#3;
              #2#4 = #0#5;  |PINTA #2#4;
              #2#5 = #0#6;  |PINTA #2#5;
              #2#6 = #0#7;  |PINTA #2#6;
              #2#7 = #0#8;  |PINTA #2#7;
              repre = #0#15;
              cargo = #0#18;
              activ = #0#12;
              afili = #0#13;
          |DDEFECTO #0;
       |FINSI;
|CIERRA #0;
|FPRC;


|PROCESO compru2;|TIPO 0;
|ABRE #1;
    #1#0 = #2#0;
    #1#1 = #2#10;
     |LEE 040#1=;
       |SI FSalida ! 0; |Y #2#10 ! 0;
          |MENAV men2;
          |ERROR;
       |SINO;
          |SI #2#0 ! 0; |Y #2#10 ! 0;
              |HAZ defregis;
          |FINSI;
          #2#11 = #1#2;  |PINTA #2#11;
          #2#12 = #1#3;  |PINTA #2#12;
          #2#13 = #1#4;  |PINTA #2#13;
          #2#14 = #1#5;  |PINTA #2#14;
          #2#15 = #1#6;  |PINTA #2#15;
          #2#16 = #1#8;  |PINTA #2#16;
          #2#17 = #1#9;  |PINTA #2#17;
          #2#24 = #1#75;
          #2#25 = #1#18;
          #2#26 = #1#7;
          |DDEFECTO #1;
       |FINSI;
|CIERRA #1;
|FPRC;


|PROCESO noentres; |TIPO 7;
|SI #2#0 ! 0;
    |CAMPO_MODIFICA #2Campo, 1, "N";
|SINO;
    |CAMPO_MODIFICA #2Campo, 1, "S";
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;

|PROCESO nopases; |TIPO 7;
|SI #2#10 ! 0;
    |CAMPO_MODIFICA #2Campo, 1, "N";
|SINO;
    |CAMPO_MODIFICA #2Campo, 1, "S";
        #2Campo = "";
    |PINTA #2Campo;
|FINSI;
|FPRC;
