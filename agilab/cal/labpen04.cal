|FICHEROS;
     labpen04;
|FIN;

|VARIABLES;
     aRuta = "";
     aFichero = "";
     aOrigen = "";
     aDestino = "";
     aAviso = "";
     aRutaOri = "";
|FIN;

|PROGRAMA;
     |CLS;
     |PINPA #0#labpen04;
     |PINDA #0#labpen04;
     |ENDATOS #4#labpen04;
     |SI FSalida ! -1;
          |SI #labpen04#0 = "S";
               |HAZ comun;
          |FINSI;
     |FINSI;
|FPRO;

|PROCESO comun;
     aFichero = "labpen51";
     |HAZ Copiatablas;
     aFichero = "labpen52";
     |HAZ Copiatablas;
     aFichero = "labpen53";
     |HAZ Copiatablas;
     aFichero = "labpen54";
     |HAZ Copiatablas;
     aFichero = "labpen55";
     |HAZ Copiatablas;
     aFichero = "labpen56";
     |HAZ Copiatablas;
|FPRC;

|PROCESO Copiatablas;
     |DBASE aRutaOri;
     |DFICE aRuta;

     aOrigen  = aRutaOri + "tablas/" + aFichero + ".ddd";
     aDestino = aRuta + aFichero + ".dat";
     |COPIA_FICHERO aOrigen,aDestino;
     |HAZ error;
     |SI aAviso ! "";    |ACABA;   |FINSI;

     aOrigen  = aRutaOri + "tablas/" + aFichero + ".iii";
     aDestino = aRuta + aFichero + ".ixx";
     |COPIA_FICHERO aOrigen,aDestino;
     |HAZ error;
     |SI aAviso ! "";    |ACABA;   |FINSI;

     aOrigen  = aRutaOri + "tablas/" + aFichero + ".xxx";
     aDestino = aRuta + aFichero + ".ddx";
     |COPIA_FICHERO aOrigen,aDestino;
     |HAZ error;
     |SI aAviso ! "";    |ACABA;   |FINSI;
|FPRC;

|PROCESO error;
     |SI FSalida ! 0;
          aAviso = "    Error en la copia de ficheros: " + aDestino;
          aAviso = aAviso + ". Proceso cancelado.";
          |MENAV aAviso;
     |FINSI;
|FPRC;
