|FICHEROS;
     eosm0032;
     dsmom073;

     labtraba;

     nomir003;
     nomir006;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nSituaVieja = 0;
     nSituaNueva = 0;
     nModo       = 0;

     aAlfa       = "";

     &enEjerIRPF = 0;
|FIN;

|PROCESO T0ImportesF32;
     |SI #eosm0032#Campo# ! Contenido;
         nCampo1    = Campo - 1;
         nCampo2    = Campo + 1;
         #eosm0032#nCampo2# = #eosm0032#nCampo1# % #eosm0032#Campo#;
         |PINTA #eosm0032#nCampo2#;
     |FINSI;
|FPRC;

|PROCESO T7C7F32;  |TIPO 7;
     enEjerIRPF = #eosm0032#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0032#3;
     #dsmom073#2 = #eosm0032#4;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;

     |C_M #eosm0032#10, 1, "S";
     |C_M #eosm0032#11, 1, "S";
     |C_M #eosm0032#12, 1, "S";
     |C_M #eosm0032#13, 1, "S";
     |C_M #eosm0032#8,  1, "S";
     |C_M #eosm0032#9,  1, "S";
     |C_M #eosm0032#15, 1, "S";

     |SI #dsmom073#5 = "N";        || en especie
         |C_M #eosm0032#10, 1, "N";  #eosm0032#10 = 0;    |PINTA #eosm0032#10;
         |C_M #eosm0032#11, 1, "N";  #eosm0032#11 = 0;    |PINTA #eosm0032#11;
         |C_M #eosm0032#12, 1, "N";  #eosm0032#12 = 0;    |PINTA #eosm0032#12;
         |C_M #eosm0032#13, 1, "N";  #eosm0032#13 = "N";  |PINTA #eosm0032#13;
     |FINSI;

     |SI #dsmom073#6 = "S";        || exenta
         |C_M #eosm0032#8, 1, "N";  #eosm0032#8 = 0;    |PINTA #eosm0032#8;
         |C_M #eosm0032#9, 1, "N";  #eosm0032#9 = 0;    |PINTA #eosm0032#9;
         |C_M #eosm0032#15, 1, "N"; #eosm0032#15 = 0;   |PINTA #eosm0032#15;
     |FINSI;
|FPRC;

|PROCESO T0C6F32;  |TIPO 0;
     |SI #eosm0032#6 > 12; |Y #eosm0032#6 [ 1990; |Y #eosm0032#6 ! 998; |Y #eosm0032#6 ! 999;
         |MENAV "     Periodo incorrecto.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T7C5F32;  |TIPO 7;
     |SI #eosm0032#3 ! "A";
         |C_M #eosm0032#5, 1, "N";
         #eosm0032#5 = 0;  |PINTA #eosm0032#5;
         |ACABA;
     |FINSI;

     |SI #eosm0032#5 ! 0;  |ACABA;  |FINSI;

     |ABRE #nomir003;
     #nomir003#0 = #eosm0032#2;     || nif
     #nomir003#40 = #eosm0032#1;    || a¤o
     #nomir003#41 = #eosm0032#0;    || empresa
     |LEE 000#nomir003.=;
     |SI FSalida ! 0;
          |ABRE #labtraba;
          |SELECT #2#labtraba;
          #labtraba#7 = #eosm0032#2;
          |LEE 000#labtraba.=;
          |SI FSalida ! 0;
               |ABRE #nomir006;
               #nomir006#0 = #eosm0032#2;     || nif
               #nomir006#1 = #eosm0032#1;     || ejercicio
               |LEE 000#nomir006.=;
               |SI FSalida = 0;
                    #eosm0032#5 = #nomir006#5;
               |FINSI;
               |CIERRA #nomir006;
          |SINO;
               #eosm0032#5 = #labtraba#111;
          |FINSI;
     |SINO;
          #eosm0032#5 = #nomir003#5;
     |FINSI;
     |CIERRA #nomir003;

     |PINTA #eosm0032#5;
|FPRC;

|PROCESO T0C5F32;  |TIPO 0;
     |SI #eosm0032#3 = "A";  |Y #eosm0032#5 = 0;
         |MENAV "     Introduzca Tipo de Relacion.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T11C3F32;  |TIPO 11;
     |SI FSalida ! 10;    |ACABA;  |FINSI;
     |SI #eosm0032#3   ! "A";   |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |CUADRO 0956 1278;
     |BLANCO 1057 1177;
     |PINTA 1057, "Situacion Actual :   ";
     |PINTA 1157, "Situacion Nueva .:   ";
     |PINTA 1076, #eosm0032#5;

     nSituaVieja = #eosm0032#5;

     E_inf       = 1;
     E_sup       = 3;
     nSituaNueva = 1176 ? 1;
     |POPV;

     |SI nSituaNueva = #eosm0032#5;
         |MENAV "     La Nueva Situacion es la misma a la anterior.";
         |ACABA;
     |FINSI;

     #eosm0032#5 = nSituaNueva;
     |LEE 101#eosm0032.=;
     |SI FSalida = 0;
         |MENAV "     La Nueva Situacion ya existe.";
         |ACABA;
     |SINO;
         #eosm0032#5 = nSituaVieja;
         |LEE 101#eosm0032.=;
         |SI FSalida = 0;
             #eosm0032#5 = nSituaNueva;
             |GRABA 020#eosm0032.n;
             |LIBERA #eosm0032;
         |FINSI;
     |FINSI;
     |LIBERA #eosm0032;

     #eosm0032#5 = nSituaVieja;
     |BORRA 020#eosm0032.c;
     |LIBERA #eosm0032;

     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 815;
|FPRC;

|PROCESO Baja73F32;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73F32;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO T66ClaveF32; |TIPO 66;
     enEjerIRPF = #eosm0032#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0032#3;
     #dsmom073#2 = #eosm0032#4;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73F32, Alta73F32;
     |SI FSalida = 0;
          #eosm0032#3 = #dsmom073#1;    |PINTA #eosm0032#3;
          #eosm0032#4 = #dsmom073#2;    |PINTA #eosm0032#4;
     |FINSI;
     |CIERRA #dsmom073;

     |ERROR;
|FPRC;

|PROCESO T0C4F32; |TIPO 6;
     nModo = (FEntrada / 100) ! 0;

     enEjerIRPF = #eosm0032#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0032#3;
     #dsmom073#2 = #eosm0032#4;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;
