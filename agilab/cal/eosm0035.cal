|FICHEROS;
     eosm0032,MANTE;
     eosm0035,MANTE;
     dsmom073;

     labtraba;

     nomir003,MANTE;
     nomir006,MANTE;
|FIN;

|VARIABLES;
     nCampo1 = 0;
     nCampo2 = 0;
     nSituaVieja = 0;
     nSituaNueva = 0;
     nModo       = 0;
     nSw         = 0;

     aAlfa       = "";

     &enEjerIRPF = 0;
|FIN;

|PROCESO T0ImportesF35;
     |SI #eosm0035#Campo# ! Contenido;
         nCampo1    = Campo - 1;
         nCampo2    = Campo + 1;
         #eosm0035#nCampo2# = #eosm0035#nCampo1# % #eosm0035#Campo#;
         |PINTA #eosm0035#nCampo2#;
     |FINSI;
|FPRC;

|PROCESO CalnSw110;
     nSw = 0;
     |SI #eosm0035#3 ! "A";  |Y #eosm0035#3 ! "B"; |Y #eosm0035#3 ! "C";
          |Y #eosm0035#3 ! "E"; |Y #eosm0035#3 ! "M";
          nSw = 1;
     |FINSI;
     |SI #eosm0035#3 = "L";
         |SI #eosm0035#4 = "05"; |O #eosm0035#4 = "10"; |O #eosm0035#4 = "27";
             nSw = 2;
         |FINSI;
     |FINSI;
     |SI #eosm0035#3 = "E";
         nSw = 2;
         |SI #eosm0035#4 ! "01"; |Y #eosm0035#4 ! "02";
              nSw = 1;
         |FINSI;
     |FINSI;
     |SI #eosm0035#3 = "B"; |Y #eosm0035#4 = "02";
         nSw = 1;
     |FINSI;
|FPRC;

|PROCESO T7C7F35;  |TIPO 7;
     enEjerIRPF = #eosm0035#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0035#3;
     #dsmom073#2 = #eosm0035#4;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;

     |C_M #eosm0035#10, 1, "S";
     |C_M #eosm0035#11, 1, "S";
     |C_M #eosm0035#12, 1, "S";
     |C_M #eosm0035#13, 1, "S";
     |C_M #eosm0035#8,  1, "S";
     |C_M #eosm0035#9,  1, "S";
     |C_M #eosm0035#15, 1, "S";
     |C_M #eosm0035#20, 1, "S";
     |C_M #eosm0035#21, 1, "S";
     |C_M #eosm0035#22, 1, "S";
     |C_M #eosm0035#23, 1, "S";
     |C_M #eosm0035#24, 1, "S";
     |C_M #eosm0035#25, 1, "S";
     |C_M #eosm0035#26, 1, "S";

     |SI #dsmom073#5 = "N";        || en especie
         |C_M #eosm0035#10, 1, "N";  #eosm0035#10 = 0;    |PINTA #eosm0035#10;
         |C_M #eosm0035#11, 1, "N";  #eosm0035#11 = 0;    |PINTA #eosm0035#11;
         |C_M #eosm0035#12, 1, "N";  #eosm0035#12 = 0;    |PINTA #eosm0035#12;
         |C_M #eosm0035#13, 1, "N";  #eosm0035#13 = "N";  |PINTA #eosm0035#13;
         |C_M #eosm0035#23, 1, "N";  #eosm0035#23 = 0;    |PINTA #eosm0035#23;
         |C_M #eosm0035#24, 1, "N";  #eosm0035#24 = 0;    |PINTA #eosm0035#24;
         |C_M #eosm0035#25, 1, "N";  #eosm0035#25 = 0;    |PINTA #eosm0035#25;
         |C_M #eosm0035#26, 1, "N";  #eosm0035#26 = "N";  |PINTA #eosm0035#26;
     |FINSI;

     |SI #dsmom073#6 = "S";        || exenta
         |C_M #eosm0035#8,  1, "N";  #eosm0035#8  = 0;    |PINTA #eosm0035#8;
         |C_M #eosm0035#9,  1, "N";  #eosm0035#9  = 0;    |PINTA #eosm0035#9;
         |C_M #eosm0035#21, 1, "N";  #eosm0035#21 = 0;    |PINTA #eosm0035#21;
         |C_M #eosm0035#22, 1, "N";  #eosm0035#22 = 0;    |PINTA #eosm0035#22;
     |FINSI;

     |HAZ CalnSw110;
     |SI nSw = 1;
         |C_M #eosm0035#15, 1, "N";  #eosm0035#15 = 0;    |PINTA #eosm0035#15;
     |FINSI;
|FPRC;

|PROCESO T0C6F35;  |TIPO 0;
     |SI #eosm0035#6 > 12; |Y #eosm0035#6 [ 1990; |Y #eosm0035#6 ! 998; |Y #eosm0035#6 ! 999;
         |MENAV "     Periodo incorrecto.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T7C5F35;  |TIPO 7;
     |SI #eosm0035#3 ! "A";
         |C_M #eosm0035#5, 1, "N";
         #eosm0035#5 = 0;  |PINTA #eosm0035#5;
         |ACABA;
     |FINSI;

     |SI #eosm0035#5 ! 0;  |ACABA;  |FINSI;

     |ABRE #nomir003;
     #nomir003#0  = #eosm0035#2;     || nif
     #nomir003#40 = #eosm0035#1;    || a¤o
     #nomir003#41 = #eosm0035#0;    || empresa
     |LEE 000#nomir003.=;
     |SI FSalida ! 0;
          |ABRE #labtraba;
          |SELECT #2#labtraba;
          #labtraba#7 = #eosm0035#2;
          |LEE 000#labtraba.=;
          |SI FSalida ! 0;
               |ABRE #nomir006;
               #nomir006#0 = #eosm0035#2;     || nif
               #nomir006#1 = #eosm0035#1;     || ejercicio
               |LEE 000#nomir006.=;
               |SI FSalida = 0;
                    #eosm0035#5 = #nomir006#5;
               |FINSI;
               |CIERRA #nomir006;
          |SINO;
               #eosm0035#5 = #labtraba#111;
          |FINSI;
     |SINO;
          #eosm0035#5 = #nomir003#5;
     |FINSI;
     |CIERRA #nomir003;

     |PINTA #eosm0035#5;
|FPRC;

|PROCESO T0C5F35;  |TIPO 0;
     |SI #eosm0035#3 = "A";  |Y #eosm0035#5 = 0;
         |MENAV "     Introduzca Tipo de Relacion.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO T11C3F35;  |TIPO 11;
     |SI FSalida ! 10;    |ACABA;  |FINSI;
     |SI #eosm0035#3   ! "A";   |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |CUADRO 0956 1278;
     |BLANCO 1057 1177;
     |PINTA 1057, "Situacion Actual :   ";
     |PINTA 1157, "Situacion Nueva .:   ";
     |PINTA 1076, #eosm0035#5;

     nSituaVieja = #eosm0035#5;

     E_inf       = 1;
     E_sup       = 3;
     nSituaNueva = 1176 ? 1;
     |POPV;

     |SI nSituaNueva = #eosm0035#5;
         |MENAV "     La Nueva Situacion es la misma a la anterior.";
         |ACABA;
     |FINSI;

     #eosm0035#5 = nSituaNueva;
     |LEE 101#eosm0035.=;
     |SI FSalida = 0;
         |MENAV "     La Nueva Situacion ya existe.";
         |ACABA;
     |SINO;
         #eosm0035#5 = nSituaVieja;
         |LEE 101#eosm0035.=;
         |SI FSalida = 0;
             #eosm0035#5 = nSituaNueva;
             |GRABA 020#eosm0035.n;
             |LIBERA #eosm0035;
         |FINSI;
     |FINSI;
     |LIBERA #eosm0035;

     #eosm0035#5 = nSituaVieja;
     |BORRA 020#eosm0035.c;
     |LIBERA #eosm0035;

     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 814;
     |PTEC 815;
|FPRC;

|PROCESO Baja73F35;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "";
     #dsmom073#2 = "";
|FPRC;

|PROCESO Alta73F35;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = "z";
     #dsmom073#2 = "zz";
|FPRC;

|PROCESO T66ClaveF35; |TIPO 66;
     enEjerIRPF = #eosm0035#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0035#3;
     #dsmom073#2 = #eosm0035#4;
     |LEE 000#dsmom073.];

     |CONSULTA_F_CLAVE #1#dsmom073, Baja73F35, Alta73F35;
     |SI FSalida = 0;
          #eosm0035#3 = #dsmom073#1;    |PINTA #eosm0035#3;
          #eosm0035#4 = #dsmom073#2;    |PINTA #eosm0035#4;
     |FINSI;
     |CIERRA #dsmom073;

     |ERROR;
|FPRC;

|PROCESO T0C4F35; |TIPO 6;
     nModo = (FEntrada / 100) ! 0;

     enEjerIRPF = #eosm0035#1;
     |HAZ BuscaEjerIRPF;

     |ABRE #dsmom073;
     #dsmom073#0 = enEjerIRPF;
     #dsmom073#1 = #eosm0035#3;
     #dsmom073#2 = #eosm0035#4;
     |LEE 000#dsmom073.=;
     |SI FSalida ! 0;
         aAlfa = "0000Clave no correcta en el ejercicio " + enEjerIRPF;
         |MENAV aAlfa;
         |SI nModo = 1;  |ERROR;  |FINSI;
     |FINSI;
     |CIERRA #dsmom073;
|FPRC;
