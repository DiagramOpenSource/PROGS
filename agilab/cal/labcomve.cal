|FICHEROS;
   labempre #0;
   labtraba #1;
   labcomve #2;
   labregis #3;
   labcontr #4;
|FIN;

|VARIABLES;
 x = 0;
    informe = "labcomve";
    men1 = "     NO EXITE REGISTRO DE EMPRESA";
    men2 = "     NO EXITE REGISTRO DE TRABAJADORES";
    men4 = "     NO EXISTE IMPRESORA";
    men5 = "     ATENCION !!! Fichero de parametros de control vacio ...";
    fechanum = 0;
    &coma = ",";
    fechacom = "";
    fechobra = "";
    loca = "";
    loca1 = "";
    &local = "";
    diacom = "";
    mescom = "";
    anycom = "";
    uno =       " Enero de ";
    dos =       " Febrero de ";
    tres =      " Marzo de ";
    cuatro =    " Abril de ";
    cinco =     " Mayo de ";
    seis =      " Junio de ";
    siete =     " Julio de ";
    ocho =      " Agosto de ";
    nueve =     " Septiembre de ";
    diez =      " Octubre de ";
    once =      " Noviembre de ";
    doce =      " Diciembre de ";
    &fechaven = @;
    cero = 0;
    &num = 0;
    sw = 0;
    empresa = 0;
    comaespa = ", ";
    espa = " ";
    &calle = "";
    calle1 = "";
    piso = "";
    numpis = "";
    &fcom = "";

    fFecha = @;
    nFecha = 0;
|FIN;

|INCLUYE i_comun;

|PROCESO fecha;|TIPO 0;
    fechacom = #2#4;
    diacom = fechacom % A102;
    mescom = fechacom % A402;
    anycom = fechacom % A704;
  |SI mescom = 01;  fechacom =  uno;    |FINSI;
  |SI mescom = 02;  fechacom =  dos ;   |FINSI;
  |SI mescom = 03;  fechacom = tres;    |FINSI;
  |SI mescom = 04;  fechacom = cuatro;  |FINSI;
  |SI mescom = 05;  fechacom = cinco;   |FINSI;
  |SI mescom = 06;  fechacom = seis;    |FINSI;
  |SI mescom = 07;  fechacom = siete;   |FINSI;
  |SI mescom = 08;  fechacom = ocho;    |FINSI;
  |SI mescom = 09;  fechacom = nueve;   |FINSI;
  |SI mescom = 10;  fechacom = diez;    |FINSI;
  |SI mescom = 11;  fechacom = once;    |FINSI;
  |SI mescom = 12;  fechacom = doce;    |FINSI;
   fcom = diacom + fechacom;
   fcom = fcom + anycom;
|FPRC;


|PROCESO lectura;
    |SI #3#15 = cero;
        fechaven = #3#8;
    |SINO;
        fechaven = #3#20;
    |FINSI;
    |SI fechaven < #2#2; |ACABA;   |FINSI;
    |SI fechaven > #2#3; |ACABA;   |FINSI;

    #0#0 = #3#1;
    |LEE 000#0=;
    loca = #4#33;
    |QBF loca;
    loca1 = #4#33 - loca;
    local = loca1 + loca;
    local = local % -130;
    numpis = #0#4;
    piso = #0#5;
    calle1 = #0#3;
    |QBF calle1;
    calle = calle1 + comaespa;
    calle = calle + numpis;
    calle = calle + espa;
    calle = calle + piso;

    #1#0 = #3#1;
    #1#1 = #3#2;
    |LEE 000#1=;
    num = num + 1;

    |SI sw = 0;
        empresa = #3#1;
        sw = 1;
    |FINSI;
    |SI empresa ! #3#1;
        |PIEINF;
        empresa = #3#1;
    |FINSI;

        r_emp = #0#0;
    |HAZ r_regis1;

    |PRINT;
|FPRC;

|PROCESO ordena;
    |SI #3#15 = cero;
        fechaven = #3#8;
    |SINO;
        fechaven = #3#20;
    |FINSI;
|FPRC;

|DEFBUCLE labcomve1;
 #3#2;
 ;
 #2#0, #2#6;
 #2#1, #2#7;
 ;
 NULL, ordena, NULL, NULL, NULL, lectura;
 fechaven, #3#1, #3#2;
|FIN;

|DEFBUCLE labcomve0;
 #3#2;
 ;
 #2#0, #2#6;
 #2#1, #2#7;
 ;
 NULL, lectura;
|FIN;

|PROCESO proceso;|TIPO 3;
|IMPRE 0;
|SI FSalida = 0;
    |ABRE #0;
    |ABRE #1;
    |HAZ r_regis0;
    |PARA x = 1;|SI x [ #2#5;|HACIENDO x = x + 1;
        |INFOR informe;
        |SI #2#8 = 1;    |BUCLE labcomve0;   |FINSI;
        |SI #2#8 = 2;    |BUCLE labcomve1;   |FINSI;
            num = 0;
        |PIEINF;
        |FININF;
    |SIGUE;
    |CIERRA #0;
    |CIERRA #1;
|SINO;
    |MENAV men4;
|FINSI;
|FINIMP;
|FPRC;

|PROCESO leecontr; |TIPO 7;
|ABRE #4;
|LEE 000#4p;
|SI FSalida ! 0;
    |MENAV men5;
|FINSI;
|CIERRA #4;
|HAZ PonFechaHasta;

|FPRC;


|PROCESO PonFechaHasta;
     fFecha = ~;
     nFecha = fFecha;
     nFecha= nFecha + 30;
     fFecha = nFecha;
     #2#3 = fFecha;
     |PINTA #2#3;
|FPRC;
