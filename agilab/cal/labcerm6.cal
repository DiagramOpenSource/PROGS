|FICHEROS;
     labcerm6 #0;
     labcerm1;
     labtraba;
     labempre;
     :/basica/def/agidanif;
|FIN;

|VARIABLES;
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     aAlfa = "";
     aAlfa1 = "";
     swLeido = 0;
     aNif = "";
     aTipo = "";
     &aMes = "";
     &nMes = 0;
|FIN;

|PROCESO lee_agidanif_m6;
     |SI #agidanif#2 = aTipo;
          swLeido = 1;
          |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE lee_agidanif_m6;
     #agidanif#1;
     ;
     aNif, 00;
     aNif, 99;
     ;
     NULL, lee_agidanif_m6;
|FIN;

|PROCESO agidanif_m6;
     swLeido = 0;
     |BUCLE lee_agidanif_m6;
|FPRC;

|PROCESO CuentaUno;
     |SI #0#4 ! "X"; |O #0#6 ! 0000;
          |ACABA;
     |FINSI;

     |ABRE #labcerm1;
     #labcerm1#0 = #0#0;
     #labcerm1#1 = #0#1;
     #labcerm1#2 = #0#2;
     |LEE 000#labcerm1.=;
     |CIERRA #labcerm1;

     aAlfa = "";
     |ABRE #labtraba;
     #labtraba#0 = #0#0;
     #labtraba#1 = #0#1;
     |LEE 000#labtraba.=;
     |SI FSalida = 0;
          aAlfa = #labtraba#72;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aAlfa1 = aAlfa % 104;
               #0#6 = aAlfa1;
               aAlfa1 = aAlfa % 504;
               #0#7 = aAlfa1;
               aAlfa1 = aAlfa % 1902;
               #0#8 = aAlfa1;
               aAlfa1 = aAlfa % 910;
               #0#9 = aAlfa1;
          |FINSI;
     |FINSI;
     |SI aAlfa = "";
          aTipo = "TITULAR     ";
          aNif = #labcerm1#10;
          |HAZ agidanif_m6;
          |SI swLeido = 1;
               aAlfa = #agidanif#22;
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aAlfa1 = aAlfa % 0104;
                    #0#6 = aAlfa1;
                    aAlfa1 = aAlfa % 0504;
                    #0#7 = aAlfa1;
                    aAlfa1 = aAlfa % 0902;
                    #0#8 = aAlfa1;
                    aAlfa1 = aAlfa % 1110;
                    #0#9 = aAlfa1;
               |FINSI;
          |FINSI;
     |FINSI;
     |CIERRA #labtraba;
     |PINTA #0#6;
     |PINTA #0#7;
     |PINTA #0#8;
     |PINTA #0#9;
|FPRC;

|PROCESO CuentaOtro;
     |SI #0#11 ! "X"; |O #0#13 ! 0000;
          |ACABA;
     |FINSI;

     |ABRE #labcerm1;
     #labcerm1#0 = #0#0;
     #labcerm1#1 = #0#1;
     #labcerm1#2 = #0#2;
     |LEE 000#labcerm1.=;
     |CIERRA #labcerm1;

     aAlfa = "";
     |SI aAlfa = "";
          aTipo = "TITULAR     ";
          aNif = #labcerm1#30;
          |HAZ agidanif_m6;
          |SI swLeido = 1;
               aAlfa = #agidanif#22;
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aAlfa1 = aAlfa % 0104;
                    #0#13 = aAlfa1;
                    aAlfa1 = aAlfa % 0504;
                    #0#14 = aAlfa1;
                    aAlfa1 = aAlfa % 0902;
                    #0#15 = aAlfa1;
                    aAlfa1 = aAlfa % 1110;
                    #0#16 = aAlfa1;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aAlfa = "";
          aTipo = "CONYUGE     ";
          aNif = #labcerm1#10;
          |HAZ agidanif_m6;
          |SI swLeido = 1;
               aAlfa = #agidanif#22;
               |QBF aAlfa;
               |SI aAlfa ! "";
                    aAlfa1 = aAlfa % 0104;
                    #0#13 = aAlfa1;
                    aAlfa1 = aAlfa % 0504;
                    #0#14 = aAlfa1;
                    aAlfa1 = aAlfa % 0902;
                    #0#15 = aAlfa1;
                    aAlfa1 = aAlfa % 1110;
                    #0#16 = aAlfa1;
               |FINSI;
          |FINSI;
     |FINSI;
     |PINTA #0#13;
     |PINTA #0#14;
     |PINTA #0#15;
     |PINTA #0#16;
|FPRC;

|PROCESO Firma_m6; |TIPO 7;
     aAlfa = #0#17;
     |QBF aAlfa;
     |SI aAlfa ! "";
          |ACABA;
     |FINSI;

     |ABRE #labempre;
     #labempre#0 = #0#0;
     |LEE 000#labempre.=;

     #0#17 = #labempre#6;
     aAlfa = #0#2;
     aAlfa1 = aAlfa % 102;
     #0#18 = aAlfa1;

     aAlfa1 = aAlfa % 402;
     nMes = aAlfa1;
     |HAZ MesLetra_plb;
     #0#19 = aMes;

     aAlfa1 = aAlfa % -104;
     #0#20 = aAlfa1;

     #0#21 = #labempre#9;

     |CIERRA #labempre;

     |PINTA #0#17;
     |PINTA #0#18;
     |PINTA #0#19;
     |PINTA #0#20;
     |PINTA #0#21;
|FPRC;

|PROCESO ActivaUno_m6;
     |SI #0nCampo = "S"; |O #0nCampo = "X";
          |CAMPO_MODIFICA #0Campo, 1, "S";
     |SINO;
          |CAMPO_MODIFICA #0Campo, 1, "N";
          nCampo1 = Campo;
          nCampo2 = Campo + 1;
          |PDEFECTO #0, nCampo1, nCampo2;
          |PINTA #0Campo;
     |FINSI;
|FPRC;

|PROCESO Activa4_m6; |TIPO 7;
     nCampo = 4;
     |HAZ ActivaUno_m6;
|FPRC;

|PROCESO Activa11_m6; |TIPO 7;
     nCampo = 11;
     |HAZ ActivaUno_m6;
|FPRC;
