|FICHEROS;
   labtmpdt #0;
   labvaltb #10;
   labprovi #11;
   labtraba #12;
   labmunic #13;

   Referen@ #1000;
   Refere1@ #1001;
|FIN;

|VARIABLES;
   &aCodPos = "";
   &aCodigoMunicipio = "";

   &aCadena = "";
   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aMod   = "";
   aTabla = "";
   aTitulo = "";

   nNumCmps = 0;
   nPos1  = 0;
   nPos2  = 0;
   nCalc  = 0;
   nCalc1 = 0;
   nCalc2 = 0;
   nCampo = 0;
   nCmp   = 0;
   nModo  = 0;
   nCont  = 0;
   nSalida = 0;

   &eaDatoExt = "";
|FIN;

|PROCESO PideDato;
   |SI #labtmpdt#1 = "labtraba"; |Y #labtmpdt#2 = 6;
      |ABRE #labtraba;
      #labtraba#0 = #labtmpdt#3;
      #labtraba#1 = #labtmpdt#4;
      |LEE 101#labtraba.=;
      |SI FSalida = 0;
         |ABRE #labmunic;

         aCodPos = #labtmpdt#5;
         |SELECT #4#labmunic;
         #labmunic#4 = aCodPos;
         |LEE 000#labmunic.=;
         |SI FSalida ! 0; aCodPos = ""; |FINSI;
         |SELECT #1#labmunic;
         |SUB_EJECUTA "labmunic";

         #labmunic#1 = aCodigoMunicipio;
         #labmunic#4 = aCodPos;
         |LEE 000#labmunic.=;
         |SI FSalida ! 0; |DDEFECTO #labmunic; |FINSI;
         |CIERRA #labmunic;

         #labtraba#6 = #labmunic#3; |PINTA #labtraba#6;
         |GRABA 020#labtraba.a; |LIBERA #labtraba;
      |FINSI;
      |ACABA;
   |FINSI;

   aMod = #labtmpdt#1; |QBF aMod; nCampo = #labtmpdt#2;
   aTabla = ""; nNumCmps = 0; nPos1 = 1140; nPos2 = 2380;
   |SI aMod = "labtraba";
      |SI nCampo = 6;
         aTabla = "tdpmunic.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione la poblacion ";
      |FINSI;
      |SI nCampo = 12;
         || aTabla = "stiacatc.txt"; nNumCmps = 2; nCmp = 1;
         aTabla = "thitiaca.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione la titulacion ";
      |FINSI;
      |SI nCampo = 19;
         || aTabla = "socupatc.txt"; nNumCmps = 2; nCmp = 1;
         aTabla = "taiclaoc.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione la ocupacion ";
      |FINSI;
      |SI nCampo = 33;
         aTabla = "tfggrcot.txt"; nNumCmps = 4; nCmp = 0;
         aTitulo = " Seleccione el grupo de cotizacion ";
      |FINSI;
      |SI nCampo = 73;
         aTabla = "tbonvfor.txt"; nNumCmps = 2; nCmp = 0;
         aTitulo = " Seleccione el nivel de formacion   ";
      |FINSI;
      |SI nCampo = 76;
         aTabla = "spaisxtc.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione el pais de nacimiento";
      |FINSI;
   |FINSI;
   |SI aMod = "labempre";
      |SI nCampo = 12;
         aTabla = "sacecotc.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione la actividad ";
      |FINSI;
      |SI nCampo = 22;
         aTabla = "tdpmunic.txt"; nNumCmps = 2; nCmp = 1;
         aTitulo = " Seleccione la Administracion de hacienda publica";
      |FINSI;
   |FINSI;
   |SI aMod = "labpadre";
      |SI nCampo = 5;
         aTabla = "ssexoxtc.txt"; nNumCmps = 2; nCmp = 0;
         aTitulo = " Seleccione el sexo";
      |FINSI;
   |FINSI;

   aAlfa1 = aTabla; |QBF aAlfa1; aAlfa1 = aAlfa1 - ".txt";
   |DBASE aAlfa; aAlfa = aAlfa + "def/" + aAlfa1 + ".mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |DBASE aAlfa; aAlfa = aAlfa + "def/" + aMod + ".mas";
      |CARGA_DEF aAlfa, Refere1@;

      |ABRE #Referen@; |ABRE #Refere1@; |ABRE #labvaltb;
      |DDEFECTO #Refere1@;
      aAlfa = "|K000"; aAlfa = #Refere1@#aAlfa#; nCont = 3;
      aAlfa = aAlfa % 0499;
      |PARA; |SI aAlfa ! ""; |HACIENDO;
         aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499; nCalc1 = aAlfa1;
         #Refere1@#nCalc1# = #labtmpdt#nCont#;
         nCont = nCont + 1;
      |SIGUE;
      |LEE 101#Refere1@.=;
      |SI FSalida = 0;
         |DDEFECTO #labvaltb;
         #labvaltb#0 = aMod;
         #labvaltb#1 = nCampo;
         aAlfa = "|K000"; nCont = 5; aAlfa = #Referen@#aAlfa#;
         aAlfa = aAlfa % 0499;
         |PARA; |SI aAlfa ! ""; |HACIENDO;
            aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499; nCalc1 = aAlfa1;
            #labvaltb#nCont# = #Refere1@#nCalc1#;
            nCont = nCont + 1;
         |SIGUE;
         |LEE 101#labvaltb.=;
         |SI FSalida = 0;
            |SI nCmp = 0; |SELECT #1#Referen@; |FINSI;
            |SI nCmp = 1; |SELECT #2#Referen@; |FINSI;
            #Referen@#nCmp# = #labvaltb#4;
         |SINO;
            |SI nCmp = 0; |SELECT #1#Referen@; |FINSI;
            |SI nCmp = 1; |SELECT #2#Referen@; |FINSI;
            |SI aMod = "labtraba"; |Y nCampo = 76;
               aAlfa = #Refere1@#nCampo#;
               aAlfa = aAlfa % 0599;
               #Referen@#nCmp# = aAlfa;
            |SINO;
               #Referen@#nCmp# = #Refere1@#nCampo#;
            |FINSI;
         |FINSI;
         |LEE 000#Referen@.];
         nCalc = (nPos1 * 10000) + nPos2;
         |PUSHV nCalc;
         |ATRI R; |PINTA nPos1, aTitulo; |ATRI N; nPos1 = nPos1 + 100;
         nModo = 4 + 8 + 16 + 32;
         ||LINEAL_SIMPLE #1#Referen@, nModo, nPos1, nPos2, NULL, NULL, NULL;
         |CONSULTA_CLAVE #1#Referen@;
         nSalida = FSalida;
         |POPV;
         |SI nSalida = 0;
            aCadena = #Referen@#nCmp#; |HAZ QuitaRaros; #Referen@#nCmp# = aCadena;
            #labtmpdt#5 = #Referen@#nCmp#; |PINTA #labtmpdt#5;
            |GRABA 020#labtmpdt.a;

            #labvaltb#0 = aMod;
            #labvaltb#1 = nCampo;
            aAlfa = "|K000"; aAlfa = #Refere1@#aAlfa#; nCont = 5;
            aAlfa = aAlfa % 0499;
            |PARA; |SI aAlfa ! ""; |HACIENDO;
               aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499; nCalc1 = aAlfa1;
               #labvaltb#nCont# = #Refere1@#nCalc1#;
               nCont = nCont + 1;
            |SIGUE;
            |LEE 101#labvaltb.=;
            |SI FSalida ! 0;
               |DDEFECTO #labvaltb;
               #labvaltb#0 = aMod;
               #labvaltb#1 = nCampo;
               aAlfa = "|K000"; nCont = 5; aAlfa = #Refere1@#aAlfa#;
               aAlfa = aAlfa % 0499;
               |PARA; |SI aAlfa ! ""; |HACIENDO;
                  aAlfa1 = aAlfa % 0103; aAlfa = aAlfa % 0499; nCalc1 = aAlfa1;
                  #labvaltb#nCont# = #Refere1@#nCalc1#;
                  nCont = nCont + 1;
               |SIGUE;
               |GRABA 020#labvaltb.b;
            |FINSI;
            aAlfa = "|C" + (("000" + nCampo) % -103) + "TIPO";     aAlfa = #Refere1@#aAlfa#;
            #labvaltb#2 = aAlfa;
            aAlfa = "|C" + (("000" + nCampo) % -103) + "LONGITUD"; aAlfa = #Refere1@#aAlfa#;
            #labvaltb#3 = aAlfa;
            #labvaltb#4 = #Referen@#nCmp#;
            |GRABA 020#labvaltb.a; |LIBERA #labvaltb;
            #Refere1@#nCampo# = #Referen@#nCmp#;
            |SI aMod = "labempre";
               |SI nCampo = 12; #Refere1@#11 = #Referen@#0; |FINSI;
               |SI nCampo = 22;
                  #Refere1@#21 = #Referen@#0; |PINTA #Refere1@#21;
                  |ABRE #labprovi;
                  aAlfa = #Referen@#0; |QBF aAlfa;
                  aAlfa = ("00000" + aAlfa) % -105; aAlfa = aAlfa % 0102;
                  #labprovi#0 = aAlfa;
                  |LEE 000#labprovi.=;
                  |SI FSalida ! 0; |DDEFECTO #labprovi; |FINSI;
                  #Refere1@#24 = #labprovi#1;
                  |CIERRA #labprovi;
               |FINSI;
            |FINSI;
            |SI aMod = "labtraba";
               |SI nCampo = 76;
                  aAlfa = #Referen@#nCmp#; |QBF aAlfa;
                  |SI aAlfa ! "ESPAÑA";
                     aAlfa1 = #Referen@#0; |QBF aAlfa1;
                     aAlfa = (("000" + aAlfa1) % -103) + " " + aAlfa;
                     #Refere1@#nCampo# = aAlfa;
                  |FINSI;
               |FINSI;
            |FINSI;
         |SINO;
            |ERROR;
         |FINSI;
         |CIERRA #labvaltb;
         |GRABA 020#Refere1@.a; |LIBERA #Refere1@;
         |CIERRA #Refere1@; |DESCARGA_DEF #Refere1@;
      |FINSI;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;
