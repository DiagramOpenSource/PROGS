|FICHEROS;
     labfictr #0;
     labtraba #1;
     labempre #2;
     nombonif #3;
     labpadre #4;
     labcentr #5;
     nomcenes #6;
|FIN;

|VARIABLES;
     sw = 0;
     dia = 0;
     mes = 0;
     any = 0;
     tope = 0;
     mod = 0;
     men1 = "0000ATENCION !!! Fecha erronea ...";
     dia1 = "";
     mes1 = "";
     any1 = "";
     fec = "";
     blanco = "          ";
     puntos = "..........";
     &eaCtaCot = "";
|FIN;

|PROCESO fechacon; |TIPO 0;      || chequea una fecha alfanumerica de 10 pos.
     fec = #0Campo; sw = 0;
     |SI fec ! blanco; |Y fec ! puntos;
          dia1 = fec % A102;
          mes1 = fec % A402;
          any1 = fec % A704;
          dia = dia1;
          mes = mes1;
          any = any1;
          |SI dia ! 0; |Y mes ! 0; |Y any ! 0;
               |SI mes [ 12; |Y mes ] 1;
                    |SI mes=1;|O mes=3;|O mes=5;|O mes=7;|O mes=8;|O mes=10;|O mes=12;
                         tope = 31;
                    |SINO;
                         |SI mes = 2;
                              mod = any $ 4;
                              |SI mod = 0;
                                   tope = 29;
                              |SINO;
                                   tope = 28;
                              |FINSI;
                         |SINO;
                              tope = 30;
                         |FINSI;
                    |FINSI;
                    |SI dia [ tope;
                         sw = 1;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SINO;
          sw = 1;
     |FINSI;

     |SI sw = 0;
          |MENAV men1;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO estado; |TIPO 0;
     |ABRE #4;
     #4#0 = #0#0;
     #4#1 = #0#1;
     |LEE 000#4=;
     |SI FSalida = 0;
          #0#16 = #4#4;    |PINTA #0#16;
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO hijos; |TIPO 0;
     #0#17 = #1#29 - 1;
     |SI #0#17 < 0;  #0#17 = 0;  |FINSI;
     |PINTA #0#17;
|FPRC;

|PROCESO emite; |TIPO 3;
     |IMPRE 0;
     |SI FSalida = 0;
          |DDEFECTO #2;
          |ABRE #2;
          #2#0 = #0#0;
          |LEE 000#2=;
          |SI FSalida = 0;
               eaCtaCot = #2#13;
          |FINSI;
          |CIERRA #2;

          |DDEFECTO #3;
          |ABRE #3;
          #3#0 = #0#21;
          |LEE 000#3=;
          #0#34 = #3#1;
          |CIERRA #3;

          |DDEFECTO #labtraba;
          |ABRE #labtraba;
          #labtraba#0 = #0#0;
          #labtraba#1 = #0#1;
          |LEE 000#labtraba.=;
          |CIERRA #labtraba;

          |DDEFECTO #labcentr;
          |ABRE #labcentr;
          #labcentr#0 = #labtraba#0;
          #labcentr#1 = #labtraba#77;
          |LEE 000#labcentr.=;
          |SI FSalida = 0;
               eaCtaCot = #labcentr#10;
          |FINSI;
          |CIERRA #labcentr;

          |SI #0#24 = "087";|O #0#24 = "085";|O #0#24 = "097";|O #2#45 = "421";
           |O #0#24 = "064";|O #0#24 = "065";
               |DDEFECTO #nomcenes;
               |ABRE #nomcenes;
               #nomcenes#0 = #labtraba#0;
               #nomcenes#13 = #labtraba#77;
               |SI #0#24 = "087";|O #0#24 = "085";|O #0#24 = "097";|O #2#45 = "421";
                    #nomcenes#1 = "87";
               |FINSI;
               |SI #0#24 = "064";|O #0#24 = "065";
                    #nomcenes#1 = "64";
               |FINSI;
               |LEE 000#nomcenes.=;
               |SI FSalida = 0;
                    eaCtaCot = #nomcenes#10;
               |FINSI;
               |CIERRA #nomcenes;
          |FINSI;

          |INFOR "labfictr";
          |PRINT;
          |PIEINF;
          |FININF;
     |FINSI;
     |FINIMP;
|FPRC;
