|FICHEROS;
     labcatip #0;
     lablitip #1;
     labtraba #2;
     labpadre;
|FIN;

|VARIABLES;
     ejercicio = "";
     fechasys = @;
     anyo = "";
     alfa = "";
     ini_fecha = @;
     anyobaja = "";
     anyoalta = "";
     anyohasta = @;
     anyodesde = @;
     aAlfa = "";
     FEstado = 0;
     feclim = @;
|FIN;

|PROCESO Valida12;
     aAlfa = #1#12;
     aAlfa = aAlfa % 101;
     |SI aAlfa = "s";
          aAlfa = "S";
     |FINSI;
     |SI aAlfa = "n";
          aAlfa = "N";
     |FINSI;
     |SI aAlfa ! "S"; |Y aAlfa ! "N";
          |ERROR;
     |SINO;
          #1#12 = aAlfa;
          |PINTA #1#12;
     |FINSI;
|FPRC;

|PROCESO fechab; |TIPO 0;
    anyoalta = #1#6 % -102;
    anyobaja = #1#7 % -102;
    ejercicio = #0#1;
    ejercicio = ("00" + ejercicio) % -102;

    |SI ejercicio > 80;
            alfa = "01.01.19" + ejercicio;
    |SINO;
            alfa = "01.01.20" + ejercicio;
    |FINSI;

    |SI #1#6 < alfa;
        anyodesde = alfa;
    |SINO;
        anyodesde = #1#6;
    |FINSI;

    |SI ejercicio > 80;
            alfa = "31.12.19" + ejercicio;
    |SINO;
            alfa = "31.12.20" + ejercicio;
    |FINSI;

    |SI #1#7 > alfa;
        anyohasta = alfa;
    |SINO;
        anyohasta = #1#7;
    |FINSI;

     feclim = #1#7;
     |SI feclim = "31.12.2999";
          aAlfa = "31.12.20" + ejercicio;
          feclim = aAlfa;
     |FINSI;

    #1#8 = (feclim - #1#6) + 1;
    #1#9 = (anyohasta - anyodesde) + 1;
    #1#10 = #1#9 / #0#3;

    |ABRE #labtraba;
    #2#0 = #1#0  ;  || Codigo empresa                                         º
    #2#1 = #1#5  ;  || Codigo trabajador                                      º
    |LEE 000#2=;

    |SI #2#42 = "X";|O #2#42 = "T";
        |SI #2#234 ! 0;|Y #2#234 ! 40;
            #1#11 = "Tiempo parcial: proporcion " + #2#234 + "/40";
            #1#10 = #1#10 * (#2#234 / 40);
        |FINSI;
    |FINSI;
    |CIERRA #labtraba;

    |PINTA #1#8;
    |PINTA #1#9;
    |PINTA #1#10;
|FPRC;

|PROCESO Sexo;
     aAlfa = #1#14;
     |QBF aAlfa;
     |SI aAlfa ! "";
          |ABRE #labpadre;
          #labpadre#0 = #1#0;
          #labpadre#1 = #1#5;
          |LEE 101#labpadre.=;
          FEstado = FSalida;

          |SI #1#14 = "H";
               #labpadre#5 = "V";
          |FINSI;
          |SI #1#14 = "M";
               #labpadre#5 = "M";
          |FINSI;

          #labpadre#0 = #1#0;
          #labpadre#1 = #1#5;
          |SI FEstado = 0;
               |GRABA 020#labpadre.a;
          |SINO;
               |GRABA 020#labpadre.n;
          |FINSI;
          |LIBERA #labpadre;
          |CIERRA #labpadre;
     |FINSI;
|FPRC;
