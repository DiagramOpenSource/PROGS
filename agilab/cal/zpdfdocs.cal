|FICHEROS;
     contrato;
     labempre;
     labtraba;
     labcentr;
     labcontr;
     nomregim;
     labacuer;
     labconre;
     labaux01;
     labclafi #8;
     labcotmp #1000;
     labpadre #1001;
     nomconca #1002;
     labenvcc #1003;
     labenvcl #1004;
     nomconca #1005;
     labregis #1006;

     pdfdocca;
     pdfdocli;

     pdfimtmp #100;
     labtmpdt #2000,MANTE;
     Referen@ #2001;
     tdpmunic #2002;

     labmunic #6;
     labvaltb;
     labco224;
     || labacue1,MANTE;
     labacue2,MANTE;
|FIN;

|VARIABLES;
     &enNumRegis = 0;
     &eaNumProrr = "";
     &aCadena    = "";

     &enRegis1 = 0;
     &enRegis2 = 0;
     &enRegis3 = 0;

     &aProcedencia = "";
     &aContrProc   = "";
     &aArchivo = "";
     swCarga = 0;
     &aValor = "";
     &aCampo = "";
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "";
     &aID = "";
     &enTipoEmision = 0;

     &domemp = "";
     &nPaisEmpresa = 0;
     &nPaisCentro = 0;
     &nPaisTrabaja = 0;
     aPaisEmpresa = "";
     &aPaisCentro = "";
     aPaisTrabaja = "";
     aPED1 = "";    || pais empresa digito 1
     aPED2 = "";    || pais empresa digito 2
     aPED3 = "";    || pais empresa digito 3
     aPCD1 = "";    || pais centro digito 1
     aPCD2 = "";    || pais centro digito 2
     aPCD3 = "";    || pais centro digito 3
     aPTD1 = "";    || pais trabajador digito 1
     aPTD2 = "";    || pais trabajador digito 2
     aPTD3 = "";    || pais trabajador digito 3
     aCodPostal1 = "";
     aCodPostal2 = "";
     aCPED1 = "";   || Codigo Postal Empresa digito 1
     aCPED2 = "";   || Codigo Postal Empresa digito 2
     aCPED3 = "";   || Codigo Postal Empresa digito 3
     aCPED4 = "";   || Codigo Postal Empresa digito 4
     aCPED5 = "";   || Codigo Postal Empresa digito 5
     aCPTD1 = "";   || Codigo Postal Trabajador digito 1
     aCPTD2 = "";   || Codigo Postal Trabajador digito 2
     aCPTD3 = "";   || Codigo Postal Trabajador digito 3
     aCPTD4 = "";   || Codigo Postal Trabajador digito 4
     aCPTD5 = "";   || Codigo Postal Trabajador digito 5
     aRegimen = "";
     aRSSD1 = "";   || Regimen Seg.Social Digito 1
     aRSSD2 = "";   || Regimen Seg.Social Digito 2
     aRSSD3 = "";   || Regimen Seg.Social Digito 3
     aRSSD4 = "";   || Regimen Seg.Social Digito 4
     aProvincia = "";
     aCPRD1 = "";   || Provincia Cta. Cotizacion Digito 1
     aCPRD2 = "";   || Provincia Cta. Cotizacion Digito 2
     aDigControl = "";
     aDC1 = "";     || Digito Control Cta. Cotizacion Digito 1
     aDC2 = "";     || Digito Control Cta. Cotizacion Digito 2
     aACTD1 = "";   || Actividad Economica Digito 1
     aACTD2 = "";   || Actividad Economica Digito 2
     &domcen = "";  || Domicilio Centro de Trabajo
     &domcen2 = "";  || Domicilio Centro de Trabajo
     &des = "";
     &has = "";
     &tiporet = ""; || Tipo Retribucion
     &dia = "";     || dia firma
     &mes = "";     || mes firma
     &anyo = "";    || a¤o firma

     nAscii = 0;
     aCaracter = "";
     aCaracterSal = "";
     aCadenaSal = "";
     aLongitud = "";
     nLongitud = 0;
     &nPos = 0;
     nBusca = 0;
     nCaracter = 0;
     &aMiCaracter = "";
     &nPorDonde = 0;

     nNumero   = 0;
     nNumLote  = 0;
     nLin      = 0;
     nSw       = 0;

     &titulo1 = "";
     &titulo2 = "";
     &titulo3 = "";
     &titulo4 = "";
     &dura = "";
     nCampo = 0;
     nCampo1 = 0;
     nCampo2 = 0;
     aTipoJorn = "";
     &nSwContrato = 0;
     nSwParcial = 0;
     &nHayCopiaBas = 0;
     &aSwMinus = "";

     &hora2 = 0;
     &swCopia = 0;
     nume = 0;
     nNume = 0;
     nNume1 = 0;
     nNume2 = 0;
     nNume3 = 0;
     nLinea = 0;
     aNume = "";
     nLimiteClau = 0;
     &swAnexoClaus = 0;
     &swDondeEstoy = 0;
     &aListaFich = "";
     nLimReal = 0;
     &swAnexoHoras = 0;     || flag  si 1 -> se hace anexo de horas complementarias para el cto. indef. a T/P sobre pacto de horas compl.
     &swAnexoRelevo = 0;    || flag  si 1 -> se hace anexo del contrato de relevo
     &swAnexoFormacion = 0; || flag  si 1 -> se hace anexo del contrato de formacion
     &swAnexoRedCuotas = 0; || flag  si 1 -> se hace anexo de reduccion de cuotas
     &swCopiaBasica = 2;    || flag  si 1 -> no se hace copia basica;  si 2 -> se hace copia basica
     &aTipoContr = "";      || tipo de contrato del anexo de relevo
     nTipo = 0;
     &topeclaus = 0;
     &cod1 = "";
     &cod2 = "";
     &des87 = @;
     &has87 = @;

     aMuni = "";
     &nContMuni = 0;
     &aCodPos = "";

     &aCodMuni = "";
     &aCodMuniE = "";
     &aCodMuniT = "";
     &aCodMuniC = "";

     &aCodigoMunicipio = "";
     &nMensajeF5 = 0;
     &nLabHisto = 0;
     aTmp = "";
     &nVoypor = 0;
     &nNCA = 0;
     &contador = 0;
     aEmp = "";
     aTra = "";
     aCon = "";
     &nSwTrans = 0;

     nHoras     = 0;
     nHorasConv = 0;
     nHandle    = 0;

     &aCodCCC = "";      || variables para datos de trabajador relevado
     &trabanom = "";     || en contrato de relevo
     &trabafec = "";
     &centrnom = "";
     &trabapro = "";

     aNom   = "";
     aApel1 = "";
     aApel2 = "";
     aClv1  = ""; aClv2  = "";
     nInd   = 1;  aLong = "";  nLong = 0;
     SwSalir = 0;
     nCalc   = 0;
     &nLey122001 = 0;
     &aCodColDesp = "";
     &fFechaFin   = @;
     &fFechaIni   = @;
     &fFechaIniCto = @;
     aIndDisc    = "";
     nHayComa    = 0;
     &registro = 0;
     aCampoClau = "";
     &swNetContrata = 0;
     aCausa1 = "";
     aProcedencia2 = "";
     &swAvisado = 0;
     &aValor1 = "";
|FIN;

|PROCESO CuentaMunicipio;
     nContMuni = nContMuni + 1;
     aCodMuni = #6#1;
|FPRC;

|DEFBUCLE CuentaMunicipio;
     #6#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,CuentaMunicipio;
|FIN;

|PROCESO BuscaMunicipio;
     aAlfa2 = #6#3;            || aAlfa2 = municipio de labmunic
     |QBT aAlfa2;
     aMuni = #labempre#6;   || aMuniEmp = municipio de labempre
     aMuni = aMuni > "";
     |QBT aMuni;

     aAlfa = aMuni - aAlfa2;
     |SI aAlfa ! aMuni;
          ||aAlfa2 esta en aMuni
          aCodMuni = #6#1;
          nContMuni = nContMuni + 1;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaMunicipio;
     #6#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,BuscaMunicipio;
|FIN;

|PROCESO min_labmunic;
     #6#4 = aCodPos;
     #6#1 = "00000";
|FPRC;

|PROCESO max_labmunic;
     #6#4 = aCodPos;
     #6#1 = "99999";
|FPRC;

|PROCESO CodigoMuni;
     nContMuni = 0;
     |BUCLE CuentaMunicipio;

     |SI nContMuni > 1;
          nContMuni = 0;
          |BUCLE BuscaMunicipio;
          |SI nContMuni > 1;
               nMensajeF5 = 1;
               aCodigoMunicipio = "";
               |SUB_EJECUTA "labmunic";
               |SI aCodigoMunicipio ! "";
                    aCodMuni = aCodigoMunicipio;
                    nContMuni = 1;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI nContMuni = 0;
          nMensajeF5 = 1;
          aCodigoMunicipio = "";
          |SUB_EJECUTA "labmunic";
          |SI aCodigoMunicipio ! "";
               aCodMuni = aCodigoMunicipio;
               nContMuni = 1;
          |FINSI;
     |FINSI;
     ||ahora se supone que en aCodMuni tenemos el codigo del municipio
|FPRC;

|PROCESO CodigosMunicipio;
     aCodPos = aCPED1 + aCPED2 + aCPED3 + aCPED4 + aCPED5;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio de la empresa inaccesible.";
          aCodMuniE = "00000";
     |SINO;
          aCodMuniE = aCodMuni;
     |FINSI;

     aAlfa1 = #labtraba#8;    aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa = #labtraba#9;     aAlfa = ("000" + aAlfa) % -103;
     aCodPos = aAlfa1 + aAlfa;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio del trabajador inaccesible.";
          aCodMuniT = "00000";
     |SINO;
          aCodMuniT = aCodMuni;
     |FINSI;

     aAlfa1 = #labcentr#7;    aAlfa1 = ("00" + aAlfa1) % -102;
     aAlfa = #labcentr#8;     aAlfa = ("000" + aAlfa) % -103;
     aCodPos = aAlfa1 + aAlfa;
     |HAZ CodigoMuni;
     |SI nContMuni = 0;
          |MENAV "0000Codigo de municipio del centro inaccesible.";
          aCodMuniC = "00000";
     |SINO;
          aCodMuniC = aCodMuni;
     |FINSI;
|FPRC;

|PROCESO BuscaArchivo;
     |SI #labcontr#37 ] 1;
          swCopiaBasica = 2;
     |SINO;
          swCopiaBasica = 1;
     |FINSI;
     |SI aProcedencia = "labconb5";     || CONV. TEMPORAL EN INDEFINIDO MINUS.
          aArchivo = "pe-166.pdf";
     |FINSI;
     |SI aProcedencia = "labcon01";     || INDEFINIDO ORDINARIO
          |SI #contrato#40 = " ";
               aArchivo = "pe-170.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 100; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 200; |FINSI;
               |SI #contrato#28 = "F"; nSwContrato = 300; |FINSI;
          |FINSI;
          |SI #contrato#40 = "A";
               aArchivo = "pe-170a.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 150; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 250; |FINSI;
               |SI #contrato#28 = "F"; nSwContrato = 350; |FINSI;
          |FINSI;
          |SI #contrato#40 = "B";
               aArchivo = "pe-170b.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 100; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 200; |FINSI;
               |SI #contrato#28 = "F"; nSwContrato = 300; |FINSI;
          |FINSI;
          |SI #contrato#40 = "C";
               aArchivo = "pe-170c.pdf";
          |FINSI;
          |SI #contrato#40 = "D";
               aArchivo = "pe-170d.pdf";
          |FINSI;
          |SI #contrato#40 = "E";
               aArchivo = "pe-170e.pdf";
          |FINSI;
          |SI #contrato#40 = "F";
               aArchivo = "pe-170f.pdf";
          |FINSI;
          |SI #contrato#40 = "C"; |O #contrato#40 = "D";
          |O #contrato#40 = "E"; |O #contrato#40 = "F";
               |SI #contrato#28 = "C"; nSwContrato = 150; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 250; |FINSI;
               |SI #contrato#28 = "F"; nSwContrato = 350; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon54";     || INDEFINIDO SOC. TRAB. O COOP. O SOC.
          aArchivo = "pe-239.pdf";      || LAB. CON DES. MENORES DE 30 A¤OS
          nSwContrato = 150;
     |FINSI;
     |SI aProcedencia = "labconb1";     || INDEFINIDO ORDINARIO
          aArchivo = "pe-221.pdf";
          nSwContrato = 100;
     |FINSI;
     |SI aProcedencia = "labcon95";     || DESEMPLEADOS ARTICULO 47 PUNTO 1.1.3
          |SI #contrato#28 = "I";
               aArchivo = "pe-174i.pdf";
               |SI #contrato#27 = "C"; nSwContrato = 150; |FINSI;
               |SI #contrato#27 = "P"; nSwContrato = 250; |FINSI;
               |SI #contrato#27 = "F"; nSwContrato = 350; |FINSI;
          |FINSI;
          |SI #contrato#28 = "T";
               aArchivo = "pe-174t.pdf";
               |SI #contrato#27 = "C"; nSwContrato = 450; |FINSI;
               |SI #contrato#27 = "P"; nSwContrato = 550; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon55";     || CONTRATO A TP CON VINCULACION
          |SI #contrato#28 = "I";
               aArchivo = "pe-238i.pdf";      || FORMATIVA
               |SI #contrato#27 = "P"; nSwContrato = 200; |FINSI;
               |SI #contrato#27 = "F"; nSwContrato = 300; |FINSI;
          |FINSI;
          |SI #contrato#28 = "T";
               aArchivo = "pe-238t.pdf";      || FORMATIVA
               |SI #contrato#27 = "1"; nSwContrato = 501; |FINSI;
               |SI #contrato#27 = "2"; nSwContrato = 502; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon9a";     || DESEMPLEADOS CONTRATADOS EMPRESAS
          |SI #contrato#28 = "I";
               aArchivo = "pe-218i.pdf";      || INSERCION
               |SI #contrato#27 = "C"; nSwContrato = 150; |FINSI;
               |SI #contrato#27 = "P"; nSwContrato = 250; |FINSI;
               |SI #contrato#27 = "F"; nSwContrato = 350; |FINSI;
          |FINSI;
          |SI #contrato#28 = "T";
               aArchivo = "pe-218t.pdf";      || INSERCION
               |SI #contrato#27 = "C"; |Y #contrato#29 = "1"; nSwContrato = 450; |FINSI;
               |SI #contrato#27 = "C"; |Y #contrato#29 = "2"; nSwContrato = 452; |FINSI;
               |SI #contrato#27 = "P"; |Y #contrato#29 = "1"; nSwContrato = 550; |FINSI;
               |SI #contrato#27 = "P"; |Y #contrato#29 = "2"; nSwContrato = 552; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon85";     || FORMACION
          aArchivo = "pe-175.pdf";
          nSwContrato = 421;
     |FINSI;
     |SI aProcedencia = "labcon36";     || PRACTICAS
          |SI #contrato#28 = "C"; nSwContrato = 420; |FINSI;
          |SI #contrato#28 = "P"; nSwContrato = 520; |FINSI;
          aArchivo = "pe-176.pdf";
     |FINSI;
     |SI aProcedencia = "labconb7";     || DE DURACION DETERMINADA
          |SI #contrato#50 = "X";            || OBRA O SERVICIO
               aArchivo = "pe-177a.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 401; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 501; |FINSI;
          |FINSI;
          |SI #contrato#51 = "X";            || EVENTUAL CRIC. PRODUCCION
               aArchivo = "pe-177b.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 402; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 502; |FINSI;
          |FINSI;
          |SI #contrato#52 = "X";            || INTERINIDAD
               aArchivo = "pe-177c.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 410; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 510; |FINSI;
          |FINSI;
          |SI #contrato#84 = "X";            || PRIMER EMPLEO JOVEN
               aArchivo = "pe-177d.pdf";
               |SI #contrato#28 = "C"; nSwContrato = 402; |FINSI;
               |SI #contrato#28 = "P"; nSwContrato = 502; |FINSI;
          |FINSI;
          |SI #contrato#53 = "X";            || DE RELEVO
               aArchivo = "pe-177e.pdf";
               nSwContrato = 540;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon75";     || DE INTERINIDAD BONIFICADO SUSTITUCION
          aArchivo = "pe-179.pdf";
     |FINSI;
     |SI aProcedencia = "labconb3";     || FIJOS DISCONTINUOS
          aArchivo = "pe-181.pdf";
          nSwContrato = 300;
     |FINSI;
     |SI aProcedencia = "labcon05";     || DE RELEVO
          aArchivo = "pe-182.pdf";
          |SI #contrato#56 = "C"; nSwContrato = 441; |FINSI;
          |SI #contrato#56 = "P"; nSwContrato = 551; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcona5";     || COMUNICACION CONVERSION DE TEMPORAL EN INDEFINIDO
          aArchivo = "pe-183.pdf";
          |SI #contrato#57 = "C";
               |SI #contrato#85 = "S"; nSwContrato = 139; |FINSI;
               |SI #contrato#60 = "S"; nSwContrato = 109; |FINSI;
               |SI #contrato#60 = "N"; nSwContrato = 189; |FINSI;
          |FINSI;
          |SI #contrato#57 = "P";
               |SI #contrato#85 = "S"; nSwContrato = 239; |FINSI;
               |SI #contrato#60 = "S"; nSwContrato = 209; |FINSI;
               |SI #contrato#60 = "N"; nSwContrato = 289; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcona6";     || COMUNICACION CONVERSION DE TEMPORAL EN INDEFINIDO PARA TRABAJOS FIJOS DISCONTINUOS
          aArchivo = "pe-185.pdf";
          |SI #contrato#87 = "S"; nSwContrato = 339; |FINSI;
          |SI #contrato#57 = "S"; nSwContrato = 309; |FINSI;
          |SI #contrato#57 = "N"; nSwContrato = 389; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon09";     || INDEFINIDO MINUSVALIDO RD 1451/1983
          aArchivo = "pe-186.pdf";
          |SI #contrato#64 = "C"; nSwContrato = 130; |FINSI;
          |SI #contrato#64 = "P"; nSwContrato = 230; |FINSI;
          |SI #contrato#64 = "F"; nSwContrato = 330; |FINSI;
     |FINSI;
     |SI aProcedencia = "labconx4";     || INDEFINIDO MINUSVALIDO RD 1451/1983
          aArchivo = "pe-187.pdf";
          |SI #contrato#28 = "C"; nSwContrato = 430; |FINSI;
          |SI #contrato#28 = "C"; nSwContrato = 530; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon39";     || CARACT. ESPECIAL MINUSVALIDOS EN CTROS. ESPECIALES DE EMPLEO
          |SI #contrato#28= "I";
               aArchivo = "pe-190i.pdf";
               |SI #contrato#27 = "C"; nSwContrato = 130; |FINSI;
               |SI #contrato#27 = "P"; nSwContrato = 230; |FINSI;
          |FINSI;
          |SI #contrato#28= "T";
               aArchivo = "pe-190t.pdf";
               |SI #contrato#27 = "C";
                    |SI #contrato#29 = "1"; nSwContrato = 401; |FINSI;
                    |SI #contrato#29 = "2"; nSwContrato = 402; |FINSI;
                    |SI #contrato#29 = "3"; nSwContrato = 410; |FINSI;
                    |SI #contrato#29 = "4"; nSwContrato = 430; |FINSI;
                    |SI #contrato#29 = "6"; nSwContrato = 441; |FINSI;
                    |SI #contrato#29 = "7"; nSwContrato = 990; |FINSI;
               |FINSI;
               |SI #contrato#27 = "P";
                    |SI #contrato#29 = "1"; nSwContrato = 501; |FINSI;
                    |SI #contrato#29 = "2"; nSwContrato = 502; |FINSI;
                    |SI #contrato#29 = "3"; nSwContrato = 510; |FINSI;
                    |SI #contrato#29 = "4"; nSwContrato = 530; |FINSI;
                    |SI #contrato#29 = "5"; nSwContrato = 540; |FINSI;
                    |SI #contrato#29 = "6"; nSwContrato = 541; |FINSI;
                    |SI #contrato#29 = "7"; nSwContrato = 990; |FINSI;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon99";     || DE INSERCION
          aArchivo = "pe-199.pdf";
     |FINSI;
     |SI aProcedencia = "labconb8";     || DESEMPLEADOS>52 BENEFICIARIOS SUBSIDIOS
          |SI #contrato#54 = "I";
               aArchivo = "pe-202i.pdf";
               |SI #contrato#28 = "C";
                    |SI #contrato#29 = "S"; nSwContrato = 150; |FINSI;
                    |SI #contrato#29 = "N"; nSwContrato = 100; |FINSI;
               |FINSI;
          |FINSI;
          |SI #contrato#54 = "T";
               aArchivo = "pe-202t.pdf";
               |SI #contrato#50 = "X"; nSwContrato = 401; |FINSI;
               |SI #contrato#51 = "X"; nSwContrato = 402; |FINSI;
               |SI #contrato#64 = "X"; nSwContrato = 410; |FINSI;
               |SI #contrato#67 = "X"; nSwContrato = 990; |FINSI;
          |FINSI;
     |FINSI;
     |SI aProcedencia = "labconb9";     || DUR.DET. INTERES SOCIAL/FOMENTO EMPLEO AGRARIO
          aArchivo = "pe-206.pdf";
     |FINSI;
     |SI aProcedencia = "AnexoClaus";   || ANEXO CLAUSULAS ADICIONALES
          aArchivo = "anexoclaus.pdf";
     |FINSI;
     |SI aProcedencia = "labcon86";     || IFORMACION Y APRENDIZAJE (NUEVO AGO-2011)
          aArchivo = "pe-226.pdf";
          nSwContrato = 421;
     |FINSI;
     |SI aProcedencia = "labconre";     || ANEXO CONTRATO DE RELEVO
          aArchivo = "pe-197.pdf";
          swCopiaBasica = 1;   || no sacamos copia basica del anexo
     |FINSI;
     |SI aProcedencia = "labanetp";     || ANEXO CONTRATO DE HORAS COMPLEMENTARIAS PARA EL CTO. INDEF. A T/P
          aArchivo = "pe-200.pdf";
          swCopiaBasica = 1;   || no sacamos copia basica del anexo
     |FINSI;
     |SI aProcedencia = "labacuer";     || ANEXO CONTRATO DE FORMACION
          |SI #labcontr#67 = "N";
               aArchivo = "anexoformacion.pdf";
          |SINO;
               |SI #contrato#57 = "S";
                    aArchivo = "anexoformacion1.pdf";
               |SINO;
                    aArchivo = "anexoformacion2.pdf";
               |FINSI;
          |FINSI;
          swCopiaBasica = 1;   || no sacamos copia basica del anexo
     |FINSI;
     |SI aProcedencia = "labacue2";     || ANEXO CONTRATO DE FORMACION
          |SI #labcontr#67 = "N";
               || aArchivo = "pe-227.pdf";
               |SI #labacue2#82 = "S";
                    aArchivo = "pe-229.pdf";
               |SINO;
                    aArchivo = "pe-230.pdf";
               |FINSI;
          |SINO;
               aAlfa = #labcontr#66;
               |QBF aAlfa;
               |SI aAlfa = "1800020126"; |O aAlfa = "1820126";
                    aArchivo = "AnexoEdutedis12.pdf";
               |FINSI;
               |SI aAlfa = "4100000298"; |O aAlfa = "4100298";
                    aArchivo = "AnexoSystem.pdf";
               |FINSI;
          |FINSI;
          swCopiaBasica = 1;   || no sacamos copia basica del anexo
     |FINSI;
     |SI aProcedencia = "labcona8";     || BENAGUACIL
          aArchivo = "pe-177_Bena.pdf";
     |FINSI;
     |SI aProcedencia = "anexoclausBena";     || ANEXO CLAUSULAS BENAGUACIL
          aArchivo = "anexoclaus_Bena.pdf";
     |FINSI;
     |SI aProcedencia = "ComunDatos";   || COMUNICACION DATOS CONTRATACION
          aArchivo = "comdatoscontr.pdf";
          swCopiaBasica = 1;
     |SINO;
          aContrProc = aProcedencia;
     |FINSI;
     |SI aProcedencia = "clauconf";   || CLUSULAS CONFIDENCIALIDAD
          aArchivo = "clauconf.pdf";
          swCopiaBasica = 1;
     |SINO;
          aContrProc = aProcedencia;
     |FINSI;
     |SI aProcedencia = "labcon13";     || IND.TRAB.PROCEDENTES DEL TEXTIL
          aArchivo = "pe-213.pdf";
     |FINSI;
     |SI aProcedencia = "labcon02";     || INDEFINIDO ORDINARIO
          aArchivo = "pe-222.pdf";
     |FINSI;
     aAlfa = aProcedencia % -108;
     |SI aAlfa = "anexored";     || INDEFINIDO ORDINARIO
          aArchivo = "pe-224.pdf";
          swCopiaBasica = 1;   || no sacamos copia basica del anexo
     |FINSI;
     |SI aProcedencia = "labcon51";     || IND. DE APOYO A LOS EMPRENDEDORES
          aArchivo = "pe-151.pdf";
          |SI #contrato#27 = "C"; |Y #contrato#78 = "N"; nSwContrato = 100; |FINSI;
          |SI #contrato#27 = "C"; |Y #contrato#78 = "S"; nSwContrato = 150; |FINSI;
          |SI #contrato#27 = "P"; |Y #contrato#78 = "N"; nSwContrato = 200; |FINSI;
          |SI #contrato#27 = "P"; |Y #contrato#78 = "S"; nSwContrato = 250; |FINSI;
          |SI #contrato#27 = "F"; |Y #contrato#78 = "N"; nSwContrato = 300; |FINSI;
          |SI #contrato#27 = "F"; |Y #contrato#78 = "S"; nSwContrato = 350; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon21";     || IND. DEL SERVICIO DE HOGAR FAMILIAR
          aArchivo = "pe-171.pdf";
          |SI #contrato#28 = "C"; nSwContrato = 100; |FINSI;
          |SI #contrato#28 = "C"; nSwContrato = 200; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon22";     || DUR. DET. DEL SERVICIO DE HOGAR FAMILIAR
          aArchivo = "pe-172.pdf";
          |SI #contrato#28 = "C"; |Y #contrato#67 = "1"; nSwContrato = 401; |FINSI;
          |SI #contrato#28 = "C"; |Y #contrato#67 = "2"; nSwContrato = 410; |FINSI;
          |SI #contrato#28 = "P"; |Y #contrato#67 = "1"; nSwContrato = 501; |FINSI;
          |SI #contrato#28 = "P"; |Y #contrato#67 = "2"; nSwContrato = 510; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon87";     || FORMACION ESCUELAS TALLER, CASAS
          aArchivo = "pe-228.pdf";      || OFICIO, TALLERES DE EMPLEO
     |FINSI;
     |SI aProcedencia = "labcon52";     || INDEFINIDO DE UN JOVEN POR
          aArchivo = "pe-232.pdf";      || MICROEMPRESAS Y EMPRESARIOS AUTONOMOS
          |SI #contrato#28 = "C"; nSwContrato = 100; |FINSI;
          |SI #contrato#28 = "P"; nSwContrato = 200; |FINSI;
     |FINSI;
     |SI aProcedencia = "labcon53";     || INDEFINIDO DE NUEVO PROYECTO DE
          aArchivo = "pe-237.pdf";      || EMPRENDIMIENTO JOVEN
          |SI #contrato#64 = "C"; nSwContrato = 100; |FINSI;
          |SI #contrato#64 = "P"; nSwContrato = 200; |FINSI;
          |SI #contrato#64 = "F"; nSwContrato = 300; |FINSI;
     |FINSI;
|FPRC;

|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;             || el caracter  
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;             || el caracter ‚
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;             || el caracter ¡
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162; |O nAscii = 243;            || el caracter ¢
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;             || el caracter £
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;             || el caracter ¤
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 241;             || el caracter ¤ (otro codigo ¨?)
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 165;             || el caracter ¥
          aCaracterSal = "\321";
     |FINSI;
     |SI nAscii = 129;
          aCaracterSal = "\374";   || el caracter u con dieresis
     |FINSI;
     |SI nAscii = 154;
          aCaracterSal = "\334";   || el caracter U (mayuscula) con dieresis
     |FINSI;
     |SI nAscii = 167;
          aCaracterSal = "\272";   || el caracter §
     |FINSI;
     |SI nAscii = 166;
          aCaracterSal = "\252";   || el caracter ¦
     |FINSI;
     |SI aCaracter = "(";
          aCaracterSal = "\(";
     |FINSI;
     |SI aCaracter = ")";
          aCaracterSal = "\)";
     |FINSI;
     |SI aCaracter = "€";       || la C-edilla o C trencada mayuscula
          aCaracterSal = "Ç";
     |FINSI;
     |SI aCaracter = "‡";       || la c-edilla o c trencada minuscula
          aCaracterSal = "ç";
     |FINSI;
|FPRC;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO CargaPrevia;
     |SI aArchivo = "anexoclaus.pdf";    || ANEXO CLAUSULAS ADICIONALES
          |ACABA;                        || NO ENTRA AQUI
     |FINSI;

     || Codigo de Pais de Empresa, Centro y Trabajador

     aPaisEmpresa = nPaisEmpresa;
     || aPaisEmpresa = "000" + aPaisEmpresa;
     aPaisEmpresa = "724";
     aPaisEmpresa = aPaisEmpresa % -103;

     aPaisCentro = nPaisCentro;
     || aPaisCentro = "000" + aPaisCentro;
     aPaisCentro = "724";
     aPaisCentro = aPaisCentro % -103;

     aPaisTrabaja = nPaisTrabaja;
     aPaisTrabaja = "000" + aPaisTrabaja;
     || aPaisTrabaja = "724" + aPaisTrabaja;
     aPaisTrabaja = aPaisTrabaja % -103;

     aPED1 = aPaisEmpresa % 101;   || pais empresa digito 1
     aPED2 = aPaisEmpresa % 201;   || pais empresa digito 2
     aPED3 = aPaisEmpresa % 301;   || pais empresa digito 3
     aPCD1 = aPaisCentro % 101;    || pais centro digito 1
     aPCD2 = aPaisCentro % 201;    || pais centro digito 2
     aPCD3 = aPaisCentro % 301;    || pais centro digito 3
     aPTD1 = aPaisTrabaja % 101;    || pais trabajador digito 1
     aPTD2 = aPaisTrabaja % 201;    || pais trabajador digito 2
     aPTD3 = aPaisTrabaja % 301;    || pais trabajador digito 3

     || CODIGO POSTAL

     aCodPostal1 = #labempre#7;
     aCodPostal1 = "00" + aCodPostal1;
     aCodPostal1 = aCodPostal1 % -102;
     aCodPostal2 = #labempre#8;
     aCodPostal2 = "00" + aCodPostal2;
     aCodPostal2 = aCodPostal2 % -103;
     aCPED1 = aCodPostal1 % 101;
     aCPED2 = aCodPostal1 % 201;
     aCPED3 = aCodPostal2 % 101;
     aCPED4 = aCodPostal2 % 201;
     aCPED5 = aCodPostal2 % 301;

     || REGIMEN

     aRegimen = #nomregim#0;
     aRegimen = "00" + aRegimen;
     aRegimen = aRegimen % -104;
     aRSSD1 = aRegimen % 101;
     aRSSD2 = aRegimen % 201;
     aRSSD3 = aRegimen % 301;
     aRSSD4 = aRegimen % 401;

     || PROVINCIA CTA. COTIZACION.

     aProvincia = aCodCCC;
     |QBF aProvincia;
     aProvincia = aProvincia % 102;
     aProvincia = "00" + aProvincia;
     aProvincia = aProvincia % -102;
     aCPRD1 = aProvincia % 101;
     aCPRD2 = aProvincia % 201;

     || DIGITO CONTROL CTA.COTIZACION

     aDigControl = aCodCCC;
     |QBF aDigControl;
     aDigControl = aDigControl % 1002;
     aDigControl = "00" + aDigControl;
     aDigControl = aDigControl % -102;
     aDC1 = aDigControl % 101;
     aDC2 = aDigControl % 201;

     || ACTIVIDAD ECONOMICA

     aAlfa = #labcentr#15;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aACTD1 = aAlfa % 101;
          aACTD2 = aAlfa % 201;
     |SINO;
          aACTD1 = #labempre#11 % -201;
          aACTD2 = #labempre#11 % -101;
     |FINSI;
|FPRC;

|PROCESO QuitaPuntos;
     nNume1 = 0;
     nNume2 = 1;
     |PARA; |SI nNume1 ! nNume2; |HACIENDO;
          aAlfa = aValor % 0;
          nNume1 = aAlfa;
          aValor = aValor - "..";
          aAlfa = aValor % 0;
          nNume2 = aAlfa;
     |SIGUE;
|FPRC;

|PROCESO BuscaCaracter;
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nCaracter = ((nPos * 100) + 1) * nPorDonde;
          aCaracter = aCadena % nCaracter;
          |SI aCaracter = aMiCaracter;
               |SAL;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO SacaValor;
     aValor = #pdfdocli#4;
     |QBF aValor;
     |SI aValor = "SI"; |O aValor = "si";
          aValor = "Si";
     |FINSI;
     |SI aValor ! "";
          |SI aValor ! "Si";
               nCampo = aValor;
               aValor = #contrato#nCampo#;
          |SINO;
               aValor = "Si";
          |FINSI;
     |FINSI;

     || Ya tengo el Valor, ahora miro si hay condiciones

     aAlfa = #pdfdocli#5;
     |QBF aAlfa;
     |SI aAlfa ! "";
          nCampo1 = aAlfa;
          aValor1 = #pdfdocli#6;
          |QBF aValor1;
          |SI #contrato#nCampo1# ! aValor1;
               aValor = "";
          |FINSI;
     |FINSI;

     aAlfa = #pdfdocli#7;
     |QBF aAlfa;
     |SI aAlfa ! "";
          nCampo1 = aAlfa;
          aValor1 = #pdfdocli#8;
          |QBF aValor1;
          |SI #contrato#nCampo1# ! aValor1;
               aValor = "";
          |FINSI;
     |FINSI;

     aAlfa = #pdfdocli#9;
     |QBF aAlfa;
     |SI aAlfa ! "";
          nCampo1 = aAlfa;
          aValor1 = #pdfdocli#10;
          |QBF aValor1;
          |SI #contrato#nCampo1# ! aValor1;
               aValor = "";
          |FINSI;
     |FINSI;

     aAlfa = #pdfdocli#11;
     |QBF aAlfa;
     |SI aAlfa ! "";
          nCampo1 = aAlfa;
          aValor1 = #pdfdocli#12;
          |QBF aValor1;
          |SI #contrato#nCampo1# ! aValor1;
               aValor = "";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Cabecera;
     ||COGEMOS LOS CODIGOS DE LOS MUNICIPIOS:


     || 1) CODIGO MUNICIPIO EMPRESAS
     ||_______________________________________________________________

     |SI aCampo = "codmuniem1";      || codigo municipio empresa 1
          aValor = aCodMuniE % 101;
     |FINSI;
     |SI aCampo = "codmuniem2";      || codigo municipio empresa 1
          aValor = aCodMuniE % 201;
     |FINSI;
     |SI aCampo = "codmuniem3";      || codigo municipio empresa 2
          aValor = aCodMuniE % 301;
     |FINSI;
     |SI aCampo = "codmuniem4";      || codigo municipio empresa 3
          aValor = aCodMuniE % 401;
     |FINSI;
     |SI aCampo = "codmuniem5";      || codigo municipio empresa 4
          aValor = aCodMuniE % 501;
     |FINSI;


     || 2) CODIGO MUNICIPIO TRABAJADOR
     ||_______________________________________________________________

     |SI swCopia = 1;     || SI NO SE TRATA DEL FICHERO DE LA COPIA BASICA

          |SI aCampo = "codmunitra1";      || codigo municipio trabajador 1
               aValor = aCodMuniT % 101;
          |FINSI;
          |SI aCampo = "codmunitra2";      || codigo municipio trabajador 1
               aValor = aCodMuniT % 201;
          |FINSI;
          |SI aCampo = "codmunitra3";      || codigo municipio trabajador 2
               aValor = aCodMuniT % 301;
          |FINSI;
          |SI aCampo = "codmunitra4";      || codigo municipio trabajador 3
               aValor = aCodMuniT % 401;
          |FINSI;
          |SI aCampo = "codmunitra5";      || codigo municipio trabajador 4
               aValor = aCodMuniT % 501;
          |FINSI;

     |FINSI;


     || 3) CODIGO MUNICIPIO CENTRO DE TRABAJO
     ||_______________________________________________________________

     |SI aCampo = "codmunict1";      || codigo municipio centro 1
          aValor = aCodMuniC % 101;
     |FINSI;
     |SI aCampo = "codmunict2";      || codigo municipio centro 1
          aValor = aCodMuniC % 201;
     |FINSI;
     |SI aCampo = "codmunict3";      || codigo municipio centro 2
          aValor = aCodMuniC % 301;
     |FINSI;
     |SI aCampo = "codmunict4";      || codigo municipio centro 3
          aValor = aCodMuniC % 401;
     |FINSI;
     |SI aCampo = "codmunict5";      || codigo municipio centro 4
          aValor = aCodMuniC % 501;
     |FINSI;
     |SI aCampo = "cif";  || CIF empresa
          aValor = #labempre#10;
     |FINSI;
/*
     swVariosAdm = 0;
     |ABRE #labadmma;
     #labadmma#0 = #labempre#0;
     |LEE 000#labadmma.=;
     |SI FSalida = 0;
          swVariosAdm = 1;
     |FINSI;
     |CIERRA #labadmma;
*/

     |SI aCampo = "repre_emp";  || NOMBRE REPRESENTANTE EMPRESA
          ||SI swVariosAdm = 0;
               aValor = #labempre#15;
          /*
          |SINO;
               aAlfa1 = #labadmma#2; |QBF aAlfa1;
               aAlfa2 = #labadmma#4; |QBF aAlfa2;
               |SI aAlfa2 ! "";
                    aValor = aAlfa1 + " - " + aAlfa2;
               |SINO;
                    aValor = aAlfa1;
               |FINSI;
          |FINSI;
          */
     |FINSI;
     |SI aCampo = "nomrepr";  || nombre representante empresa
          ||SI swVariosAdm = 0;
               aValor = #labempre#15;
          /*
          |SINO;
               aAlfa1 = #labadmma#2; |QBF aAlfa1;
               aAlfa2 = #labadmma#4; |QBF aAlfa2;
               |SI aAlfa2 ! "";
                    aValor = aAlfa1 + " - " + aAlfa2;
               |SINO;
                    aValor = aAlfa1;
               |FINSI;
          |FINSI;
          */
     |FINSI;
     |SI aCampo = "dnirep";  || DNI representante
          ||SI swVariosAdm = 0;
               aValor = #labempre#17;
          /*
          |SINO;
               aAlfa1 = #labadmma#3; |QBF aAlfa1;
               aAlfa2 = #labadmma#5; |QBF aAlfa2;
               |SI aAlfa2 ! "";
                    aValor = aAlfa1 + " - " + aAlfa2;
               |SINO;
                    aValor = aAlfa1;
               |FINSI;
          |FINSI;
          */
     |FINSI;
     |SI aCampo = "cargorep";  || cargo representante
          ||SI swVariosAdm = 0;
               aValor = #labempre#18;
          /*
          |SINO;
               aValor = #labadmma#1;
          |FINSI;
          */
     |FINSI;

     |SI aCampo = "razsoc";   || nombre o razon social empresa
          aValor = #labempre#2;
     |FINSI;
     |SI aCampo = "domsocialem";   || domicilio social empresa
          aValor = domemp;
     |FINSI;
     |SI aCampo = "codpaisem1";  || codigo pais digito 1
          aValor = aPED1;
     |FINSI;
     |SI aCampo = "codpaisem2";  || codigo pais digito 2
          aValor = aPED2;
     |FINSI;
     |SI aCampo = "codpaisem3";  || codigo pais digito 3
          aValor = aPED3;
     |FINSI;
     |SI aCampo = "codpostem1"; |O aCampo = "codpostalem1"; |O aCampo = "codpostem1";  || CODIGO POSTAL EMPRESA DIGITO 1
          aValor = aCPED1;
     |FINSI;
     |SI aCampo = "codpostem2"; |O aCampo = "codpostalemp2"; |O aCampo = "codpostem2";  || CODIGO POSTAL EMPRESA DIGITO 2
          aValor = aCPED2;
     |FINSI;
     |SI aCampo = "codpostem3"; |O aCampo = "codpostalempr3"; |O aCampo = "codpostem3";  || CODIGO POSTAL EMPRESA DIGITO 3
          aValor = aCPED3;
     |FINSI;
     |SI aCampo = "codpostem4"; |O aCampo = "codpostalempr4"; |O aCampo = "codpostem4";  || CODIGO POSTAL EMPRESA DIGITO 4
          aValor = aCPED4;
     |FINSI;
     |SI aCampo = "codpostem5"; |O aCampo = "codpostalemp5"; |O aCampo = "codpostem5";  || CODIGO POSTAL EMPRESA DIGITO 5
          aValor = aCPED5;
     |FINSI;
     |SI aCampo = "regimen1";  || REGIMEN SEG. SOCIAL DIGITO 1
          aValor = aRSSD1;
     |FINSI;
     |SI aCampo = "regimen2";  || REGIMEN SEG. SOCIAL DIGITO 2
          aValor = aRSSD2;
     |FINSI;
     |SI aCampo = "regimen3";  || REGIMEN SEG. SOCIAL DIGITO 3
          aValor = aRSSD3;
     |FINSI;
     |SI aCampo = "regimen4";  || REGIMEN SEG. SOCIAL DIGITO 4
          aValor = aRSSD4;
     |FINSI;
     |SI aCampo = "provniss1";  || PROVINCIA CTA.COTIZACION DIGITO 1
          aValor = aCPRD1;
     |FINSI;
     |SI aCampo = "provniss2";  || PROVINCIA CTA.COTIZACION DIGITO 2
          aValor = aCPRD2;
     |FINSI;
     |SI aCampo = "numniss";  || CTA. COTIZACION
          aValor = aCodCCC % 307;
     |FINSI;
     |SI aCampo = "digcon1";   || DIGITO CONTROL CTA.COTIZACION DIGITO 1
          aValor = aDC1;
     |FINSI;
     |SI aCampo = "digcon2";    || DIGITO CONTROL CTA.COTIZACION DIGITO 2
          aValor = aDC2;
     |FINSI;
     |SI aCampo = "litacteco";  || ACTIVIDAD ECONOMICA LITERAL
          aAlfa = #labcentr#23;
          |QBF aAlfa;
          |SI #labcentr#17 ! 0; |Y aAlfa ! "";
                aValor = #labcentr#23;
          |SINO;
               aValor = #labempre#12;
               aAlfa = aValor % 101;
               nNume = &aAlfa;
               |SI nNume ] 48; |Y nNume [ 57;
                    aValor = aValor - ".";
                    aAlfa = FSalida;
                    nNume = aAlfa;
                    |SI nNume = 0;
                         aAlfa = "0160";
                    |SINO;
                         aAlfa = ("00" + aAlfa) % -104;
                         aAlfa = aAlfa % 102;
                         nNume = aAlfa;
                         nNume = nNume + 1;
                         aAlfa = nNume;
                         aAlfa = ("00" + aAlfa) % -102;
                         aAlfa = aAlfa + "60";
                    |FINSI;
                    aValor = aValor % aAlfa;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "codacteco1"; |O aCampo = "codACECO1";  || ACTIVIDAD ECONOMICA DIGITO 1
          aValor = aACTD1;
          |QBF aValor;
          |SI aValor = ""; aValor = "0"; |FINSI;
     |FINSI;
     |SI aCampo = "codacteco2"; |O aCampo = "codACTECO2";  || ACTIVIDAD ECONOMICA DIGITO 2
          aValor = aACTD2;
          |QBF aValor;
          |SI aValor = ""; aValor = "0"; |FINSI;
     |FINSI;
     |SI aCampo = "codpaisct1";  || codigo pais CENTRO digito 1
          aValor = aPCD1;
     |FINSI;
     |SI aCampo = "codpaisct2";  || codigo pais CENTRO digito 2
          aValor = aPCD2;
     |FINSI;
     |SI aCampo = "codpaisct3";  || codigo pais CENTRO digito 3
          aValor = aPCD3;
     |FINSI;

     |SI aCampo = "nomtrab";     || NOMBRE TRABAJADOR
          aValor = #labtraba#2;
     |FINSI;


     |SI swCopia = 1;     || SI NO SE TRATA DEL FICHERO DE LA COPIA BASICA
          |SI aCampo = "dnitra";     || DNI TRABAJADOR
               aValor = #labtraba#7;
          |FINSI;
          |SI aCampo = "fechanac";   || FECHA NACIMIENTO TRABAJADOR
               aValor = #labtraba#11;
          |FINSI;
          |SI aCampo = "numafinss";     || NUMERO AFILIACION S.S.
               aValor = #labtraba#75;
          |FINSI;
          |SI aCampo = "litnivaca";     || NIVEL FORMATIVO
               aValor = #labtraba#12;
          |FINSI;
          |SI aCampo = "codnivaca1"; |O aCampo = "codniveaca1";  || CODIGO NIVEL FORMATIVO DIGITO 2
               aValor = #labtraba#73;
               |QBF aValor;
               aValor = aValor % 101;
          |FINSI;
          |SI aCampo = "codnivaca2"; |O aCampo = "codniveaca2";    || CODIGO NIVEL FORMATIVO DIGITO 1
               aValor = #labtraba#73;
               |QBF aValor;
               aValor = aValor % 201;
          |FINSI;
          |SI aCampo = "codnactra1";     || NACIONALIDAD TRABAJADOR CODIGO 1
               aValor = aPTD1;
          |FINSI;
          |SI aCampo = "codnactra2";     || NACIONALIDAD TRABAJADOR CODIGO 2
               aValor = aPTD2;
          |FINSI;
          |SI aCampo = "codnactra3";     || NACIONALIDAD TRABAJADOR CODIGO 3
               aValor = aPTD3;
          |FINSI;
          |SI aCampo = "codpaisdomtr1"; |O aCampo = "codpaistra1"; |O aCampo = "codnpaistra1"; |O aCampo = "paisdom1";   || PAIS TRABAJADOR CODIGO 1
              || aValor = aPTD1;
               aValor = "7";
          |FINSI;
          |SI aCampo = "codpaisdomtr2"; |O aCampo = "codpaisdomtra2"; |O aCampo = "codpaistra2"; |O aCampo = "codnpaistra2"; |O aCampo = "paisdom2";   || PAIS TRABAJADOR CODIGO 2
              || aValor = aPTD2;
               aValor = "2";
          |FINSI;
          |SI aCampo = "codpaisdomtr3"; |O aCampo = "codpaistra3"; |O aCampo = "codnpaistra3"; |O aCampo = "codpaisra3"; |O aCampo = "paisdom3";  || PAIS TRABAJADOR CODIGO 3
              || aValor = aPTD3;
               aValor = "4";
          |FINSI;
          |SI aCampo = "copiabasica";
               aValor = "";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma1";
               aValor = "El/la trabajador/a";
          |FINSI;
          |SI aCampo = "firma2";
               aValor = "El/la representante de la empresa";
          |FINSI;
          |SI aCampo = "firma3";
               aValor = "El/la representante legal del menor, si procede";
          |FINSI;
          |SI aCampo = "trabajador";  || NOMBRE DEL TRABAJADOR TRABAJADOR
               aValor = #labtraba#2;
          |FINSI;
          |SI aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
               aValor = #labtraba#20;
          |FINSI;
     |FINSI;

     |SI swCopia = 2;
          |SI aCampo = "copiabasica";
               aValor = "(COPIA B\301SICA)";
          |FINSI;
          |SI aCampo = "firma1";
               aValor = "El/la representante sindical";
          |FINSI;
          |SI aCampo = "firma2";
               aValor = "El/la representante de la empresa";
          |FINSI;
          |SI aCampo = "firma3";
               aValor = "";
          |FINSI;
          |SI aCampo = "trabajador";  || NOMBRE DEL REPRESENTANTE SINDICAL
               aValor = #labcentr#12;
          |FINSI;
          |SI aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
               aValor = "";
          |FINSI;
     |FINSI;

     |SI aCampo = "nomreptra"; |O aCampo = "nomreptra1"; |O aCampo = "aleg"; |O aCampo = "asislegal";      || REPRESENTANTE TRABAJADOR
          |SI aArchivo ! "pe-199.pdf"; |O aCampo ! "nomreptra1";  ||arreglo para que saque nomreptra1 en el pe-199
               aValor = #labtraba#20;
          |FINSI;
     |FINSI;
     |SI aCampo = "dnireptra";|O aCampo = "dnni";      || DNI REPRESENTANTE
          aValor = #labtraba#22;
     |FINSI;
     |SI aCampo = "calireptra1"; |O aCampo = "calireptra"; |O aCampo = "cali"; |O aCampo = "domtrarep";   || EN CALIDAD DE
          aValor = #labtraba#23;
     |FINSI;
     |SI aCampo = "profetraba"; |O aCampo = "cl1"; |O aCampo = "profesion";     || PROFESION TRABAJADOR
          |SI aArchivo ! "pe-197.pdf"; |Y aArchivo ! "pe-226.pdf";
               aValor = #labtraba#19;
          |FINSI;
     |FINSI;
     |SI aCampo = "catetraba"; |O aCampo = "catetrabajp";|O aCampo = "clniv"; |O aCampo = "categoria"; |O aCampo = "grupoprofesional";     || CATEGORIA
          |SI aArchivo ! "pe-197.pdf"; |Y aArchivo ! "pe-226.pdf";
               aValor = #labtraba#18;
          |FINSI;
     |FINSI;
     |SI aCampo = "ubicact"; |O aCampo = "ubicact2"; |O aCampo = "ubicacioncentrotrabajo2";     || UBICACION CENTRO
          aValor = domcen;
     |FINSI;
     |SI aCampo = "ubicen";
          aValor = domcen2;
          |SI aProcedencia = "labcon01"; |Y #contrato#94 = "S";
               aValor = "";   || a distancia
          |FINSI;
          |SI aProcedencia = "labconb7"; |Y #contrato#96 = "S";
               aValor = "";   || a distancia
          |FINSI;
     |FINSI;
     |SI aArchivo = "pe-226.pdf"; |Y aCampo = "ubicen1";
          aValor = domcen2;
     |FINSI;
     |SI aArchivo = "pe-226.pdf"; |Y aCampo = "ubicen2";
          aValor = domcen2;
     |FINSI;
     |SI aCampo = "convcole1";     || solo fijos discontinuos
          |SI nSwContrato ] 300; |Y nSwContrato [ 399;
               aValor = #labtraba#25;
          |FINSI;
     |FINSI;
     |SI aCampo = "convcole2";
          aValor = #labtraba#25;
     |FINSI;
|FPRC;

|PROCESO Cuerpo;

/****************************************************************************/
/*      A PARTIR DE AQUI COMIENZAN LOS CAMPOS PROPIOS DE CADA CONTRATO      */
/*                    LO INTENTAMOS POR EL SISTEMA NUEVO                    */
/****************************************************************************/

     |HAZ SacaValor;

     |SI aCampo = "horainicio";   || HORAS TIEMPO COMPLETO
          |SI aValor ! "";           || en este caso toma el valor de una va-
               aValor = des;         || riable (la misma para todos los cont.)
          |FINSI;                    || asi que compruebo la cond. y si se da
     |FINSI;                         || (aValor viene distinto de blanco), la cojo

     |SI aCampo = "horafin";     || HORAS TIEMPO COMPLETO
          |SI aValor ! "";           || en este caso toma el valor de una va-
               aValor = has;         || riable (la misma para todos los cont.)
          |FINSI;                    || asi que compruebo la cond. y si se da
     |FINSI;                         || (aValor viene distinto de blanco), la cojo

     |SI aCampo = "sel_adjhhcc1";     || HORAS COMPLEMENTARIAS
          |SI aValor = "Si";
               swAnexoHoras = 1;
          |FINSI;
     |FINSI;

     |SI aCampo = "sel_ctorel1";     || CONTRATO DE RELEVO
          |SI aValor = "Si";
               swAnexoRelevo = 1;
          |FINSI;
     |FINSI;

     |SI aCampo = "perioretri";
          |SI aValor ! "";
              aValor = tiporet;
          |FINSI;
     |FINSI;

     |SI aCampo = "concepsala";
          |SI aValor ! "";
               |QBF aValor;
               aAlfa1 = #contrato#38; |QBF aAlfa1;
               aValor = aValor + " " + aAlfa1;
               aAlfa1 = #contrato#39; |QBF aAlfa1;
               aValor = aValor + " " + aAlfa1;
               |HAZ QuitaPuntos;
          |FINSI;
     |FINSI;

     |SI aCampo = "diafirma";      || DIA FIRMA
          |SI aValor ! "";
               aValor = dia;
          |FINSI;
     |FINSI;
     |SI aCampo = "mesfirma";      || MES FIRMA
          |SI aValor ! "";
               aValor = mes;
          |FINSI;
     |FINSI;
     |SI aCampo = "a\361ofirma";      || A¤O FIRMA
          |SI aValor ! "";
               |SI aArchivo = "pe-200.pdf";
                    aValor = anyo % -101;
               |SINO;
                    aValor = anyo % -102;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aCampo = "tipohoras";
          |SI aValor = "D";  || DIARIAS
               aValor = "diarias";
          |FINSI;
          |SI aValor = "S";  || SEMANALES
               aValor = "semanales";
          |FINSI;
          |SI aValor = "M";  || MENSUALES
               aValor = "mensuales";
          |FINSI;
          |SI aValor = "A";  || ANUALES
               aValor = "anuales";
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO comunes;
     |ABRE #nomconca;
     #nomconca#0 = #labtraba#87;
     |LEE 000#nomconca.=;
     |SI FSalida ! 0; |DDEFECTO #nomconca; |FINSI;
     |CIERRA #nomconca;

     |ABRE #labconre; |DDEFECTO #labconre;
     #labconre#18 = #labregis#0;
     #labconre#19 = #labregis#1;
     #labconre#20 = #labregis#2;
     #labconre#21 = "";
     |LEE 000#labconre.=;
     |SI FSalida ! 0; |DDEFECTO #labconre; |FINSI;
     |CIERRA #labconre;

     |SI aArchivo = "anexoclaus.pdf"; |O aArchivo = "anexoformacion.pdf";
     |O aArchivo = "anexoformacion1.pdf"; |O aArchivo = "anexoformacion2.pdf";
          |ACABA;
     |FINSI;

     ||TITULOS PARA  SI SE HACE EL ANEXO DE RELEVO

     |SI aProcedencia = "labcon01"; aTipoContr = "ordinario por tiempo indefinido                                        "; |FINSI;
     |SI aProcedencia = "labconb1"; aTipoContr = "indefinido a tiempo completo celebrado al amparo de la Ley 12/2001     "; |FINSI;
     |SI aProcedencia = "labcon95"; aTipoContr = "para desempleados contempla.en el apart.uno punto 1.3 Art.4 Ley 12/2001"; |FINSI;
     |SI aProcedencia = "labcon55"; aTipoContr = "a tiempo parcial con vinculacion formativa (RDL 4/2013)                "; |FINSI;
     |SI aProcedencia = "labcon9a"; aTipoContr = "para desempleados contratados por empresas de insercion (Ley 44/2007)  "; |FINSI;
     |SI aProcedencia = "labcona5"; aTipoContr = "comunicaci¢n de conversi¢n de contrato temporal en indefinido          "; |FINSI;
     |SI aProcedencia = "labconb2"; aTipoContr = "indefinido a tiempo parcial celebrado al amparo de la Ley 12/2001      "; |FINSI;
     |SI aProcedencia = "labcona6"; aTipoContr = "comunicaci¢n conver. de cont. temp. en indef. para trab. fijos discontinuos"; |FINSI;
     |SI aProcedencia = "labcon09"; aTipoContr = "indefinido para trab. minusv., al amparo del R.D.1451/1983, de 11 de Mayo"; |FINSI;
     |SI aProcedencia = "labconb5"; aTipoContr = "comunicaci¢n conver. en indefinido del cont. temp. para trab. minusvalidos"; |FINSI;
     |SI aProcedencia = "labcon39"; aTipoContr = "relaci¢n laboral de minusvalidos que trabajen en centros especiales"; |FINSI;
     |SI aProcedencia = "labconb8"; aTipoContr = "para trab. desempl. mayores de 52 beneficiarios de subsidios por desempleo"; |FINSI;
     |SI aProcedencia = "labcon13"; aTipoContr = "indefinido bonificado para trabajadores procedentes del textil y confec."; |FINSI;
     |SI aProcedencia = "labcon02"; aTipoContr = "indefinido bonificado para trabajadores beneficiarios de prest. desemp."; |FINSI;
     |SI aProcedencia = "labcon52"; aTipoContr = "indefinido de un joven por microempresas y empresarios autonomos"; |FINSI;
     |SI aProcedencia = "labcon54"; aTipoContr = "indefinido para soc. trab. o de trab. de coop. o soc. lab. con des. < 30"; |FINSI;

||aaaa

     aAlfa = #pdfdocli#4;
     |QBF aAlfa;
     |SI aAlfa = "";
          |HAZ Cabecera;      || datos de la cabecera, comunes a TODOS
                              || los contratos
     |SINO;
          |HAZ Cuerpo;        || Datos del Contrato, segun el valor del def
                              || por el nuevo sistema
     |FINSI;

     |SI aCampo = "duracion";  || Duracion contrato
          |SI aArchivo = "pe-174i.pdf"; |O aArchivo = "pe-174t.pdf";
          |O aArchivo ="pe-199.pdf";
          |O aArchivo ="pe-218i.pdf"; |O aArchivo ="pe-218t.pdf";
          |O aArchivo ="pe-238i.pdf"; |O aArchivo ="pe-238t.pdf";
              aValor = titulo2;
          |SINO;
              |SI aArchivo ! "pe-190i.pdf"; |Y aArchivo ! "pe-190t.pdf";
                   aValor = dura ;
              |FINSI;
          |FINSI;
     |FINSI;

     |SI aCampo = "clausadici"; |O aCampo = "clausulas";   || CLAUSULAS
          || aqui no hare el GrabaTemporal del final
          |SI #labcontr#59 = "S";
               swAnexoClaus = 1;
          |FINSI;
          aCampoClau = aCampo;
          ||nLimiteClau = #pdfdocli#3;
          nLimiteClau = topeclaus;
          |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
               nCampo = nNume + 8;
               aValor = #contrato#nCampo#;
               |QBF aValor;
               |SI aValor = "";
                    nNume = nNume - 1;
                    |SI nNume > nLimiteClau;
                         swAnexoClaus = 1;
                    |FINSI;
                    |SI #labcontr#75 = "S"; |Y nNume ! 0;
                         swAnexoClaus = 1;
                    |FINSI;
                    |HAZ Direccion;
                    |SAL;
               |FINSI;
               |SI nCampo = 26;
                    |SI aValor ! "";
                         swAnexoClaus = 1;
                         |HAZ Direccion;
                    |FINSI;
               |FINSI;
          |SIGUE;
          |SI swAnexoClaus = 0;
               nLimReal = nNume;
               |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
                    aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
                    aCampo = aCampoClau + aNume;
                    nCampo = nNume + 8;
                    aValor = #contrato#nCampo#;
                    |QBF aValor;
                    |HAZ GrabaTemporal;
               |SIGUE;
          |SINO;                    ||PONEMOS EL MENSAJE DE VER EN HOJA ADJUNTA Y TODAS LAS CLAUSULAS EN BLANCO->""
               nLimReal = nNume;
               |PARA nNume = 1; |SI nNume [ nTipo; |HACIENDO nNume = nNume + 1;
                    aNume = nNume;  aNume = "00" + aNume; aNume = aNume % -102;
                    aCampo = aCampoClau + aNume;
                    nCampo = nNume + 8;
                    |SI nNume = 1;
                         aValor = "                                 .- Ver en hoja adjunta.";
                    |SINO;
                         aValor = "";
                        |QBF aValor;
                    |FINSI;
                    |HAZ GrabaTemporal;
               |SIGUE;
          |FINSI;
     |FINSI;

     |SI aCampo = "requird";  || R.D. Ley
          aValor = #contrato#52 ;
     |FINSI;
     |SI aCampo = "modalrd1";
           aValor = titulo1 + ", " + titulo2;
     |FINSI;
     |SI aCampo = "registro";
          aEmp = #contrato#1; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #contrato#2; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
     |FINSI;

     |SI aCampo = "documento"; |Y aArchivo ! "pe-181.pdf";
          nCampo = 102;
          aValor = #contrato#nCampo#;
     |FINSI;

     |SI aCampo = "Identificador";
          |ABRE #labregis;
          #labregis#0 = contador;
          |LEE 000#labregis.=;
          |SI FSalida = 0;
               aValor = #labregis#14;
          |FINSI;
          |CIERRA #labregis;
     |FINSI;

     |SI aCampo ! "clausadici"; |Y aCampo ! "clausulas";   || CLAUSULAS
          |QBF aValor;
          |SI aValor ! "";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Direccion;
     |SI #labcontr#59 ! "S"; |ACABA; |FINSI;
     |SI swCopia = 2; |ACABA; |FINSI;
     aAlfa1 = "* El trabajador manifiesta que su domicilio de residencia y notificaciones";
     aAlfa2 = #labtraba#3; |QBF aAlfa2;
     aAlfa2 = aAlfa2 + ", " + #labtraba#4; |QBF aAlfa2;
     aAlfa2 = aAlfa2 + " - " + #labtraba#5; |QBF aAlfa2;
     aAlfa2 = aAlfa2 + " (" + #labtraba#6; |QBF aAlfa2;
     aAlfa2 = "es: " + aAlfa2 + ").";
     aAlfa3 = "";
     |PARA nume = 1; |SI nume [ 3; |HACIENDO nume = nume + 1;
          |SI nCampo < 26;    || me cabe en los 18 primeros
               nCampo = nCampo + 1;
               |SI nume = 1; #contrato#nCampo# = aAlfa1; |FINSI;
               |SI nume = 2; #contrato#nCampo# = aAlfa2; |FINSI;
               |SI nume = 3; #contrato#nCampo# = aAlfa3; |FINSI;
          |SINO;              || he de meterlo en el labclafi
               |PARA nCampo1 = 19; |SI nCampo1 [ 150; |HACIENDO nCampo1 = nCampo1 + 1;
                    #labclafi#0 = nCampo1;
                    |LEE 101#labclafi.=;
                    |SI FSalida ! 0;
                         |SAL;
                    |FINSI;
               |SIGUE;

               |SI registro = 41; |Y nume = 1;
                     #labclafi#0 = nCampo1;
                     #labclafi#1 = " ";
                     |GRABA 020#labclafi.n;
                     nCampo1 = nCampo1 + 1;
               |FINSI;

               #labclafi#0 = nCampo1;
               |SI nume = 1; #labclafi#1 = aAlfa1; |FINSI;
               |SI nume = 2; #labclafi#1 = aAlfa2; |FINSI;
               |SI nume = 3; #labclafi#1 = aAlfa3; |FINSI;

               |GRABA 020#labclafi.n;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO pe170;
/*
     |SI aCampo = "ind_ord";    || CONTRATO INDEFINIDO ORDINARIO
          aValor = "Si";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "sel_adj1";    || TRABAJOS FIJOS DISCONTINUOS SI
          |SI #contrato#28 = "P"; |Y #contrato#101 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_adj2";    || TRABAJOS FIJOS DISCONTINUOS NO
          |SI #contrato#28 = "P"; |Y #contrato#101 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_rd520011";  || LEY 12/2001 -> Si
          |SI #contrato#62 = "S";
                nLey122001 = 1;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_rd520012";  || LEY 12/2001 -> No
          |SI #contrato#62 = "N";
                nLey122001 = 0;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO pe166;
          || se usa para el 166 y para el 237
          |SI aArchivo = "pe-166.pdf";
               aSwMinus = "S";
          |FINSI;
          |SI aCampo = "sel_tipo1";     || Jornada completa
               |SI #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    |SI aArchivo = "pe-166.pdf"; nSwContrato = 139; |FINSI;
                    |SI aArchivo = "pe-237.pdf"; nSwContrato = 100; |FINSI;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tipo2";     || Jornada parcial
               |SI #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    |SI aArchivo = "pe-166.pdf"; nSwContrato = 239; |FINSI;
                    |SI aArchivo = "pe-237.pdf"; nSwContrato = 200; |FINSI;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tipo3";     || Fijo discontinuo
               |SI #contrato#64 = "F";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    |SI aArchivo = "pe-166.pdf"; nSwContrato = 339; |FINSI;
                    |SI aArchivo = "pe-237.pdf"; nSwContrato = 300; |FINSI;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn1";     || Jornada completa
               |SI #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn2";     || Jornada parcial
               |SI #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "nombsepe";      || Nombre Servicio Publico de Empleo
               aValor = #contrato#45;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechaconver";   || Fecha de conversion
               aValor = #contrato#41;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "tpcontem";      || Tiempo parcial del contrato temporal
              aValor = #contrato#31;
              || aValor= "COMUNICACION DE CORVERSION EN INDEFINIDO, PARA TRABAJADORES MINUSVALIDOS"
              |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechacelecv";   || Fecha celebracion
               aValor = #contrato#69;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "oecomconv1";    || Oficina de empleo
               aValor = #contrato#68;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fecharegcv";    || Fecha registro
               aValor = #contrato#42;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "idcontconv";    || Numero de registro
               aValor = #contrato#75;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "organcerti1";   || Organo certificador
               aValor = #contrato#65;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "prestservi";    || Presta sus servicios como
               aValor = #labtraba#19;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "horasjorna1";   || Horas de la jornada
               |SI #contrato#64 = "C";
                    aValor = #contrato#32;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horasjorna2";   || Horas de la jornada 2
               |SI #contrato#64 = "P";
                    aValor = #contrato#32;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horasjornafd";   || Horas de la jornada fijos disc.
               |SI #contrato#64 = "F";
                    aValor = #contrato#32;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horainicio";    || Desde
               |SI #contrato#64 = "C";
                    aValor = des;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horafin";       || Hasta
               |SI #contrato#64 = "C";
                    aValor = has;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "tipojorntp1";    || Jornada parcial horas Dia
               |SI #contrato#64 = "P"; |Y #contrato#28 = "D";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "tipojorntp2";    || Jornada parcial horas Semana
               |SI #contrato#64 = "P"; |Y #contrato#28 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "tipojorntp3";    || Jornada parcial horas Mes
               |SI #contrato#64 = "P"; |Y #contrato#28 = "M";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "tipojorntp4";    || Jornada parcial horas A¤o
               |SI #contrato#64 = "P"; |Y #contrato#28 = "A";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn21";    || Jornada parcial inferior a "A"
               |SI #contrato#64 = "P"; |Y #contrato#77 = "A";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn22";    || Jornada parcial inferior a "B"
               |SI #contrato#64 = "P"; |Y #contrato#77 = "B";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn23";    || Jornada parcial inferior a "C"
               |SI #contrato#64 = "P"; |Y #contrato#77 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "id7";           || Horas de tiempo parcial
               |SI #contrato#64 = "P"; |Y #contrato#77 = "C";
                    aValor = #contrato#29;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "pactohorascom1";           || Pacto horas complementarias -> Si
               |SI #contrato#64 = "P"; |Y #contrato#61 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    swAnexoHoras = 1;
               |FINSI;
          |FINSI;
          |SI aCampo = "pactohorascom2";           || Pacto horas complementarias -> No
               |SI #contrato#64 = "P"; |Y #contrato#61 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "fechatercera";  || A partir de la fecha
               aValor = #contrato#69;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "formmocto1";    || Contrato de relevo -> Si
               |SI #contrato#78 = "S";
                    swAnexoRelevo = 1;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "formmodcto2";   || Contrato de relevo -> No
               |SI #contrato#78 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontc1";   || % Bonificacion Hombre a t. completo -> 70% menor de 45
               |SI #contrato#27 = "H"; |Y #contrato#67 < 45; |Y #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontc2";   || % Bonificacion Mujer a t. completo -> 90% menor de 45
               |SI #contrato#27 = "M"; |Y #contrato#67 < 45; |Y #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontp1";   || % Bonificacion Hombre a t. completo -> 70% mayor 45
               |SI #contrato#27 = "H"; |Y #contrato#67 ] 45; |Y #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontp2";   || % Bonificacion Mujer a t. completo -> 90% mayor 45
               |SI #contrato#27 = "M"; |Y #contrato#67 ] 45; |Y #contrato#64 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;

          |SI aCampo = "selporcbontc1b";   || % Bonificacion a t. parcial -> 70% Hombre menor 45
               |SI #contrato#27 = "H"; |Y #contrato#67 < 45; |Y #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontc2b";   || % Bonificacion a t. parcial -> 90% Mujer menor 45
               |SI #contrato#27 = "M"; |Y #contrato#67 < 45; |Y #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontp1b";   || % Bonificacion Hombre a t. parcial -> 70% mayor 45
               |SI #contrato#27 = "H"; |Y #contrato#67 ] 45; |Y #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "selporcbontp2b";   || % Bonificacion Mujer a t. parcial -> 90% mayor 45
               |SI #contrato#27 = "M"; |Y #contrato#67 ] 45; |Y #contrato#64 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;

          |SI aCampo = "subven";        || Subvencion que solicita la empresa
               |SI #contrato#64 = "P";
                    aValor = #contrato#66;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "convcolec2";        || Subvencion que solicita la empresa
               aValor = #labtraba#25;
               |HAZ GrabaTemporal;
          |FINSI;
     |SI aCampo = "form1";    || TRABAJOS FIJOS DISCONTINUOS SI
          |SI #contrato#64 = "P"; |Y #contrato#101 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "form2";    || TRABAJOS FIJOS DISCONTINUOS NO
          |SI #contrato#64 = "P"; |Y #contrato#101 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "horatraba1";   || distribucion tiempo t.completo y t.parcial
          |SI #contrato#64 = "C"; |O #contrato#64 = "P";
               aValor = #contrato#59;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI #contrato#64 = "F";
          |SI aCampo = "horatrabafd";   || distribucion tiempo fijos discontinuos
               aValor = #contrato#59;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "convcolecfd";    || convenio
               aValor = #labtraba#25;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "act_tra";    || actividad trabajador
               aValor = #contrato#79;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "act_emp";    || actividad empresa
               aValor = #contrato#81;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "dur_tra";    || duracion actividad trabajador
               aValor = #contrato#80;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "dur_emp";    || duracion actividad empresa
               aValor = #contrato#82;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe237;
     |SI #contrato#64 = "C"; nSwContrato = 100; |FINSI;
     |SI #contrato#64 = "P"; nSwContrato = 200; |FINSI;
     |SI #contrato#64 = "F"; nSwContrato = 300; |FINSI;
|FPRC;

|PROCESO pe174;
     |SI #contrato#28 = "I"; |Y #contrato#27 = "C";
          nSwContrato = 150;
     |FINSI;
     |SI #contrato#28 = "I"; |Y #contrato#27 = "P";
           nSwContrato = 250;
     |FINSI;
     |SI #contrato#28 = "I"; |Y #contrato#27 = "F";
           nSwContrato = 350;
     |FINSI;
     |SI aProcedencia = "labcon9a"; |Y #contrato#29 = 4;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 4;
               nSwContrato = 551;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 4;
               nSwContrato = 552;
          |FINSI;
     |SINO;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C";
               nSwContrato = 450;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P";
               nSwContrato = 550;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO DatosFormacion;
     |SI #contrato#67 = "S";
          |SI aCampo = "razsoccf";      || CIF DEL CTRO DE FORMACION
               aValor = #labacuer#2;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "cifcf2";      || CIF DEL CTRO DE FORMACION
               aValor = #labacuer#3;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "numecf";      || IDENTIF. CTRO. NUMERO
               aValor = #labacuer#23;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codprovcf";      || COD. PROVINCIA CTRO FORM.
               aAlfa = "00" + #labacuer#19;
               aAlfa = aAlfa % -102;
               aValor = aAlfa;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "municf";      || POBLACION DEL CTRO DE FORMACION
               aValor = #labacuer#21;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "modadocp";      || MODALIDAD DOCENTE="P"
               |SI #labacuer#18 = "P"; |O #labacuer#18 = "p";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "modadocd";      || MODALIDAD DOCENTE="D"
               |SI #labacuer#18 = "D"; |O #labacuer#18 = "d";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |SINO;
          |SI aCampo = "razsoccf";      || CIF DEL CTRO DE FORMACION
               aValor = #labacue2#2;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "cifcf2";      || CIF DEL CTRO DE FORMACION
               aValor = #labacue2#3;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "numecf";      || IDENTIF. CTRO. NUMERO
               aValor = #labacue2#23;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codprovcf";      || COD. PROVINCIA CTRO FORM.
               aAlfa = "00" + #labacue2#19;
               aAlfa = aAlfa % -102;
               aValor = aAlfa;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "municf";      || POBLACION DEL CTRO DE FORMACION
               aValor = #labacue2#21;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "modadocp";      || MODALIDAD DOCENTE="P"
               |SI #labacue2#18 = "P";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "modadocd";      || MODALIDAD DOCENTE="D"
               |SI #labacue2#18 = "D";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe238;
     |SI #contrato#28 = "I";
          |SI #contrato#27 = "P"; nSwContrato = "200"; |FINSI;
          |SI #contrato#27 = "F"; nSwContrato = "300"; |FINSI;
     |FINSI;
     |SI #contrato#28 = "T";
          |SI #contrato#27 = "1"; nSwContrato = "501"; |FINSI;
          |SI #contrato#27 = "2"; nSwContrato = "502"; |FINSI;
     |FINSI;
     |SI aCampo = "Opcion7";
          aAlfa = #contrato#75;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Opcion8";
          aAlfa = #contrato#76;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe175;
          nSwContrato = 421;

          |DDEFECTO #labacuer;
          |ABRE #labacuer;
          #labacuer#0 = #contrato#1;
          #labacuer#1 = #contrato#2;
          |LEE 000#labacuer.=;
          |CIERRA #labacuer;

          |SI aCampo = "bonifsi";      || BONIFICADO
               |SI #contrato#82 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "bonifno";      || NO BONIFICADO
               |SI #contrato#82 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |HAZ DatosFormacion;
          |SI aCampo = "esosi";      || ESCOLARIDAD OBLIGATORIA="SI"
               |SI #contrato#57 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "esono";      || ESCOLARIDAD OBLIGATORIA="NO"
               |SI #contrato#57 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "estatuto_si";      || AMP.DURAC. ESTATUTO TRABAJADORES
               |SI #contrato#30 = "S";
                    aCampo = "estatuto_si"; ||pq se debe tachar la que no proceda
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "estatuto_no";      || ESCOLARIDAD OBLIGATORIA="NO"
               |SI #contrato#30 = "N";
                    aCampo = "estatuto_no"; ||pq se debe tachar la que no proceda
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          /*
          |SI aCampo = "entre16y25";      || MAYOR QUE 16 Y MENOR QUE 25 A¤OS
               |SI #contrato#53 = "X";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          */
          |SI aCampo = "desem2a";      || hasta 24 a¤os
               |SI #contrato#76 = "X";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          /*
          |SI aCampo = "desemexso";    || sin limite
               |SI #contrato#76 = "X";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "desem24";
               |SI #contrato#77 = "X";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          */
          |SI aCampo = "numctosfor";    || N§ DE CONTRATOS PARA FORMACION
               aValor = #contrato#55;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "nctosformin";    || N§ DE CTOS PARA FORM. MINUSVAL.
               aValor = #contrato#56;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "nomtutor";    || NOMBRE DEL TUTOR
               aValor = #contrato#27;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "catetutor";    || CUALIFICACION PROFESIONAL
               aValor = #contrato#28;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "horasjorna";    || HORAS JORNADA
               aValor = #contrato#32;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "horasforma";    || HORAS FORMACION
               aValor = #contrato#50;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "porcforma";    || PORCENTAJE FORMACION
               aValor = #contrato#31;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "trabefec";    || TIEMPO TRABAJO EFECTIVO
               aValor = #contrato#29;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "trabefec2";    || TIEMPO TRABAJO EFECTIVO 2§ LINEA
               aValor = #contrato#52;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "calenform";    || CALENDARIO FORMACION
               aValor = #contrato#38;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "calenform2";    || CALENDARIO FORMACION 2§ LINEA
               aValor = #contrato#39;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "in_ccolec";    || CONV COLEC. PERMITE DURACION MAYOR
               nCampo1 = 80;
               |SI #contrato#nCampo1# = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
|FPRC;

|PROCESO pe226;
     nSwContrato = 421;

     |DDEFECTO #labacue2;
     |ABRE #labacue2;
     #labacue2#0 = #contrato#1;
     #labacue2#1 = #contrato#2;
     |LEE 000#labacue2.=;
     |CIERRA #labacue2;
|FPRC;

|PROCESO AnexoFormacion2;
     |SI aCampo = "representante";
          aValor = #labempre#15;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "dni representante";
          aValor = #labempre#17;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CIFUSUARIO";
          aValor = #labcontr#69;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "NOMBREUSUARIO";
          aValor = #labcontr#68;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "IDCONTRATO";
          aValor = #labacuer#29 + "-" + #labacuer#30 + "-" + #labacuer#31 + "-";
          aValor = aValor + #labacuer#34 + "-" + #labacuer#33;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia";
          aValor = #labacuer#15;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO AnexoFormacion1;
     || campos especiales acuerdo formacion edutedis CON GRADUADO ESCOLAR

     |SI aCampo = "Prov";
          aValor = #labacuer#29;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Codigo OE";
          aValor = #labacuer#30;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Anyo Reg Contrato";
          aValor = #labacuer#31;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Num Reg Contrato";
          aValor = #labacuer#34;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Prorr";
          aValor = #labacuer#33;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "codigo ocupacion";
          aValor = #labacuer#27;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "ENTIDADRow1";
          aValor = #labacuer#38;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "OFICINARow1";
          aValor = #labacuer#39;
          |QBF aValor;
          aValor = ("0000" + aValor) % -104;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "DCRow1_2";
          aValor = #labacuer#40;
          |QBF aValor;
          aValor = ("00" + aValor) % -102;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "N CUENTARow1";
          aValor = #labacuer#41;
          |QBF aValor;
          aValor = ("0000000000" + aValor) % -110;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Desde Fecha";
          aValor = #contrato#41;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Hasta Fecha";
          aValor = #contrato#42;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "Fdo";
          aValor = #labacuer#42;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aArchivo = "anexoformacion2.pdf";
          |HAZ AnexoFormacion2;
     |FINSI;
|FPRC;

|PROCESO AnexoFormacion0;
     || el de toda la vida;
          || Identificador del contrato

          |SI aCampo = "identif contrato1";
               aValor = #labacuer#28;
               aValor = aValor % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato2";
               aValor = #labacuer#29;
               aValor = aValor % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato3";
               aValor = #labacuer#29;
               aValor = aValor % 201;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato4";
               aValor = #labacuer#31;
               aValor = aValor % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato5";
               aValor = #labacuer#31;
               aValor = aValor % 201;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato6";
               aValor = #labacuer#31;
               aValor = aValor % 301;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato7";
               aValor = #labacuer#31;
               aValor = aValor % 401;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato8";
               aValor = #labacuer#34;
               aValor = aValor % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato9";
               aValor = #labacuer#34;
               aValor = aValor % 201;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato10";
               aValor = #labacuer#34;
               aValor = aValor % 301;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato11";
               aValor = #labacuer#34;
               aValor = aValor % 401;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato12";
               aValor = #labacuer#34;
               aValor = aValor % 501;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato13";
               aValor = #labacuer#34;
               aValor = aValor % 601;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato14";
               aValor = #labacuer#34;
               aValor = aValor % 701;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato15";
               aValor = #labacuer#33;
               aValor = aValor % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif contrato16";
               aValor = #labacuer#33;
               aValor = aValor % 201;
               |HAZ GrabaTemporal;
          |FINSI;

          || codigo ocupacion y fechas desde y hasta de duracion de la formacion
          || y casilla de formacion presencial o a distancia

          |SI aCampo = "codig oaupac1";
               aValor = #labacuer#27 % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac2";
               aValor = #labacuer#27 % 201;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac3";
               aValor = #labacuer#27 % 301;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac4";
               aValor = #labacuer#27 % 401;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac5";
               aValor = #labacuer#27 % 501;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac6";
               aValor = #labacuer#27 % 601;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac7";
               aValor = #labacuer#27 % 701;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "codig oaupac8";
               aValor = #labacuer#27 % 801;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechacomienzo";
               aAlfa = #contrato#41;
               aValor = aAlfa % 102;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechacomienzo1";
               aAlfa = #contrato#41;
               aValor = aAlfa % 402;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechacomienzo2";
               aAlfa = #contrato#41;
               aValor = aAlfa % -104;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechafin";
               aAlfa = #contrato#42;
               aValor = aAlfa % 102;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechafin1";
               aAlfa = #contrato#42;
               aValor = aAlfa % 402;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechafin2";
               aAlfa = #contrato#42;
               aValor = aAlfa % -104;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "presencial";
               |SI #labacuer#18 = "P";
                    aValor = "Si";
               |FINSI;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "a distancia";
               |SI #labacuer#18 = "D";
                    aValor = "Si";
               |FINSI;
               |HAZ GrabaTemporal;
          |FINSI;

          || datos del centro

          |SI aCampo = "nombre centro";
               aValor = #labacuer#2;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro1";
               aValor = #labacuer#23 % 101;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro2";
               aValor = #labacuer#23 % 201;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro3";
               aValor = #labacuer#23 % 301;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro4";
               aValor = #labacuer#23 % 401;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro5";
               aValor = #labacuer#23 % 501;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro6";
               aValor = #labacuer#23 % 601;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "identif centro7";
               aValor = #labacuer#23 % 701;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "razon social centro";
               aValor = #labacuer#22;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "CIF centro";
               aValor = #labacuer#3;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "Direccion centro";
               aValor = #labacuer#4;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "localidad centro";
               aValor = #labacuer#21;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "CP centro";
               aAlfa1 = #labacuer#19; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
               aAlfa2 = #labacuer#20; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

              || aAlfa1 = #labacuer#19;
              || aAlfa2 = #labacuer#20;
               aAlfa = aAlfa1 + aAlfa2;
               aValor = aAlfa;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "provincia centro";
               aValor = #labacuer#24;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "persona contacto centro";
               aValor = #labacuer#6;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "telefono centro";
               aValor = #labacuer#5;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fax centro";
               aValor = #labacuer#25;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "e-mail centro";
               aValor = #labacuer#26;
               |HAZ GrabaTemporal;
          |FINSI;
|FPRC;

|PROCESO anexoformacion;
     |SI aCampo = "razonsocialempresa";
          aValor = #labempre#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cIF empresa";
          aValor = #labempre#10;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "direccion empresa";
          aValor = #labempre#3;
          |QBF aValor;
          aAlfa = #labempre#4;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + ", " + aAlfa;
          |FINSI;
          aAlfa = #labempre#5;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + " - " + aAlfa;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad empresa";
          aValor = #labempre#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "C.P. empresa";
         || aAlfa1 = #labacuer#19; aAlfa1 = "000" + aAlfa1; aAlfa1 = aAlfa1 % -103;
         || aAlfa2 = #labacuer#20; aAlfa2 = "00" + aAlfa2; aAlfa2 = aAlfa2 % -102;

          aAlfa1 = #labempre#7; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
          aAlfa2 = #labempre#8; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

          aAlfa = aAlfa1 + aAlfa2;
          aValor = aAlfa
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia empresa";
          aValor = #labempre#9;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "persona contacto empresa";
          aValor = #labacuer#35;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "telefono empresa";
          aValor = #labempre#111;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fax empresa";
          aValor = #labacuer#36;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "e-mail empresa";
          aValor = #labacuer#37;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "nombre trab";
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fecha nacimi. traba";
          aValor = #labtraba#11;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "DNI trab";
          aValor = #labtraba#7;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "domicilio trab";
          aValor = #labtraba#3;
          |QBF aValor;
          aAlfa = #labtraba#4;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + ", " + aAlfa;
          |FINSI;
          aAlfa = #labtraba#5;
          |QBF aAlfa;
          |SI aAlfa ! "";
               aValor = aValor + " - " + aAlfa;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "telefono trabaj";
          aValor = #labtraba#244;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad trabaj";
          aValor = #labtraba#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CP trabaja";
          aAlfa1 = #labtraba#8; aAlfa1 = "00000"+ aAlfa1; aAlfa1 = aAlfa1 % -102;
          aAlfa2 = #labtraba#9; aAlfa2 = "00000"+ aAlfa2; aAlfa2 = aAlfa2 % -103;

          ||aAlfa1 = #labtraba#8;
          ||aAlfa2 = #labtraba#9;
          aAlfa = aAlfa1 + aAlfa2;
          aValor = aAlfa;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "provincia trabj";
          aValor = #labtraba#10;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ocupacion";
          aValor = #labacuer#13;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "e-mail trabaj";
          aValor = #labtraba#127;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "horario";
          aAlfa1 = #labacuer#11; |QBF aAlfa1;
          aAlfa2 = #labacuer#12; |QBF aAlfa2;
          aValor = aAlfa1 + " " + aAlfa2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad";
          aValor = #contrato#46;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "dia";
          aValor = dia;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mes";
          aValor = mes;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "a\361o";
          aValor = anyo;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "trabajador";  || NOMBRE DEL TRABAJADOR TRABAJADOR
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
          aValor = #labtraba#20;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "registro";
          aEmp = #contrato#1; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #contrato#2; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aArchivo = "anexoformacion.pdf";
          |HAZ AnexoFormacion0;
     |FINSI;
     |SI aArchivo = "anexoformacion1.pdf"; |O aArchivo = "anexoformacion2.pdf";
          |HAZ AnexoFormacion1;
     |FINSI;
|FPRC;
/*
|PROCESO pe227;     || nuevo anexo de formacion ago/2011
     |SI aCampo = "nombrerepempresa";
          aValor = #labacue1#45;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nifrepempresa";
          aValor = #labacue1#46;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cargorepempresa";
          aValor = #labacue1#47;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "razonsocialempresa";
          aValor = #labempre#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombre trab";
          aValor = #labtraba#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "DNI trab";
          aValor = #labtraba#7;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "celebran";
          |SI #labacue1#48 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "hancelebrado";
          |SI #labacue1#49 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "idcontrato";
          |SI #labacue1#49 = "X";
               aAlfa1 = "";
               aAlfa = #labacue1#28; |QBF aAlfa; aAlfa1 = aAlfa + "-";
               aAlfa = #labacue1#29; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa + "-";
               aAlfa = #labacue1#31; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa + "-";
               aAlfa = #labacue1#32; |QBF aAlfa; aAlfa1 = aAlfa1 + aAlfa;
               aAlfa = #labacue1#33; |QBF aAlfa;
               |SI aAlfa ! "";
                    aAlfa1 = aAlfa1 + "-" + aAlfa;
               |FINSI;
               aValor = aAlfa1;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechacontrato";
          |SI #labacue1#49 = "X";
               aValor = #labacue1#50;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombrerepcentro";
          aValor = #labacue1#6;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nifrepcentro";
          aValor = #labacue1#8;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "cargorepcentro";
          aValor = #labacue1#51;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "nombre centro";
          aValor = #labacue1#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CIF centro";
          aValor = #labacue1#3;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Direccion centro";
          aValor = #labacue1#4;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "CP centro";
          aAlfa1 = #labacue1#19; |QBF aAlfa1;
          aAlfa2 = #labacue1#20; |QBF aAlfa2;
          aValor = aAlfa1 + aAlfa2; |QBF aValor;
          aCodPos = aValor;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "localidad centro";
          aValor = #labacue1#21;
          |HAZ GrabaTemporal;
     |FINSI;
     || mando aCodPos
     |SI aCampo = "codmuni centro";
          |HAZ CodigoMuni;
          |SI nContMuni = 0;
               |MENAV "0000Codigo de municipio del trabajador inaccesible.";
               aValor = "00000";
          |SINO;
               aValor = aCodMuni;
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "certprof";
          |SI #labacue1#52 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "titfp";
          |SI #labacue1#53 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "eso";
          |SI #labacue1#54 = "X";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "denom certprof"; |Y #labacue1#52 = "X";
          aValor = #labacue1#55;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "codigo certprof"; |Y #labacue1#52 = "X";
          aValor = #labacue1#56;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "RD certprof"; |Y #labacue1#52 = "X";
          aValor = #labacue1#57;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas certprof"; |Y #labacue1#52 = "X";
          aValor = #labacue1#58;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "denom titfp"; |Y #labacue1#53 = "X";
          aValor = #labacue1#59;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "RD titfp"; |Y #labacue1#53 = "X";
          aValor = #labacue1#60;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horas titfp"; |Y #labacue1#53 = "X";
          aValor = #labacue1#61;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "presencial";
          |SI #labacue1#18 = "P";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "a distancia";
          |SI #labacue1#18 = "D";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mixta";
          |SI #labacue1#18 = "M";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "calendario1";
          aValor = #labacue1#11;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "calendario2";
          aValor = #labacue1#12;
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "localidad";
          aValor = #labacue1#62;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "dia";
          aValor = #labacue1#63;
          |QBF aValor;
          |SI aValor = "0"; aValor = ""; |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mes";
          aValor = #labacue1#64;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "a\361o";
          aValor = #labacue1#65;
          |QBF aValor;
          |SI aValor = "0"; aValor = ""; |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "registro acuerdo";
          aEmp = #contrato#1; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #contrato#2; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;
*/

|PROCESO anexoreduccion;
     |DDEFECTO #labco224;
     |ABRE #labco224;
     #labco224#0 = #contrato#1;
     #labco224#1 = #contrato#2;
     |LEE 000#labco224.=;
     |CIERRA #labco224;

     aAlfa1 = "";
     aAlfa2 = "";
     aAlfa3 = "No";

     aProcedencia2 = aProcedencia - "anexored";

     |SI aProcedencia2 = "labcon01";
          aAlfa1 = "INDEFINIDO ORDINARIO";
          aAlfa2 = "Ind";
          |SI #contrato#62 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;
     |SI aProcedencia2 = "labconb1";
          aAlfa1 = "INDEFINIDO";
          aAlfa2 = "Ind";
          |SI #contrato#58 = "X"; |O #contrato#60 = "X";
               aAlfa3 = "Si";
          |FINSI;
          |SI #contrato#59 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;
     |SI aProcedencia2 = "labcon09";
          aAlfa1 = "PARA PERSONAS CON DISCAPACIDAD R.D. 1451/1983 Y LEY 43/2006";
          aAlfa2 = "Ind";
          |SI #contrato#62 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;
     |SI aProcedencia2 = "labcon95"; |O aProcedencia2 = "labcon9a";
          aAlfa1 = "PARA DESEMPLEADOS, LEY 44/2007";
          |SI #contrato#28 = "I";
               aAlfa2 = "Ind";
          |SINO;
               aAlfa2 = "Tem";
          |FINSI;
          |SI #contrato#79 = "X"; |O #contrato#80 = "X";
               aAlfa3 = "Si";
          |FINSI;
          |SI #contrato#62 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;
     |SI aProcedencia2 = "labcon36";
          aAlfa1 = "EN PRACTICAS";
          aAlfa2 = "Tem";
     |FINSI;
     |SI aProcedencia2 = "labconb7";
          aAlfa1 = "DE DURACION DETERMINADA"
          aAlfa2 = "Tem";
     |FINSI;
     |SI aProcedencia2 = "labconb3";
          aAlfa1 = "PARA TRABAJOS FIJOS DISCONTINUOS";
          aAlfa2 = "Ind";
          |SI #contrato#57 = "X"; |O #contrato#58 = "X";
               aAlfa3 = "Si";
          |FINSI;
          |SI #contrato#62 = "S"; |O #contrato#81 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;
     |SI aProcedencia2 = "labconx4";
          aAlfa1 = "TEMPORAL FOMENTO EMPLEO PERSONAS CON DISCAPACIDAD";
          aAlfa2 = "Tem";
          |SI #contrato#51 = "S";
               aAlfa3 = "Si";
          |FINSI;
     |FINSI;

     |SI #labco224#6 ! "S"; |Y #labco224#6 ! "N";
          || eso es porque estaba el contrato grabado y no se ha usado
          || lo de entrar por el campo nuevo
          || en este caso cojo lo que hubiera cogido antes segun cada contrato
          || la bonificacion que tuviera
     |SINO;
          |SI #labco224#6 = "S";
               aAlfa3 = "Si";
          |SINO;
               aAlfa3 = "No";
          |FINSI;
     |FINSI;

     |SI aCampo = "Texto7";
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Texto8";
          aValor = #labco224#2;
          |QBF aValor;
          aValor = aValor + "%";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Indefinido";
          |SI aAlfa2 = "Ind";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Temporal";
          |SI aAlfa2 = "Tem";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Casilla1";
          aValor = "Si";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Texto10";
          aValor = #labco224#3;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Casilla11";
          |SI #labco224#4 = 1; |O #labco224#4 = 3;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Casilla12";
          |SI #labco224#4 = 2; |O #labco224#4 = 3;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Casilla2";
          aValor = "Si";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Casilla21";
          |SI #labco224#5 = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Casilla22";
          |SI #labco224#5 = 2;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "Casilla3";
          |SI aAlfa3 = "Si";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "Casilla4";
          |SI aAlfa3 = "No";
               aValor = "Si";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe176;
     |SI #contrato#61 = "S";
          swAnexoHoras = 1;
     |FINSI;
|FPRC;

|PROCESO pe177;
     |SI #contrato#94 = "S";
          swAnexoHoras = 1;
     |FINSI;
     fFechaIni = #contrato#41;
     fFechaFin = #contrato#42;
     |SI #contrato#28 = "C"; |Y #contrato#50 = "X";
               nSwContrato = 401;
     |FINSI;
     |SI #contrato#28 = "C"; |Y #contrato#51 = "X";
               nSwContrato = 402;
     |FINSI;
     |SI #contrato#28 = "C"; |Y #contrato#52 ="X";
               nSwContrato = 410;
     |FINSI;
     |SI #contrato#28 = "C"; |Y #contrato#53 ="X";
               nSwContrato = 441;
     |FINSI;
     |SI #contrato#28 = "P"; |Y #contrato#50 = "X";
               nSwContrato = 501;
     |FINSI;
     |SI #contrato#28 = "P"; |Y #contrato#51 = "X";
               nSwContrato = 502;
     |FINSI;
     |SI #contrato#28 = "P"; |Y #contrato#52 = "X";
               nSwContrato = 510;
     |FINSI;
     |SI #contrato#28 = "P"; |Y #contrato#53 = "X";
               nSwContrato = 541;
     |FINSI;
|FPRC;

|PROCESO pe206;
     |SI aCampo = "sel_tipo1com";    || T.C. OBRA O SERV. DETERMINADO
          nCampo = 83;
          |SI #contrato#nCampo# = 1; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 401;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo2com";    || EVENTUAL
          nCampo = 83;
          |SI #contrato#nCampo# = 2; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 402;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo3com";    || INTERINIDAD
          nCampo = 83;
          |SI #contrato#nCampo# = 3; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 410;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo4com";    || PRACTICAS
          nCampo = 83;
          |SI #contrato#nCampo# = 4; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 420;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo5com";    || FORMACION
          nCampo = 83;
          |SI #contrato#nCampo# = 5; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 421;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo6com";    || EXCLUSION SOCIAL
          nCampo = 83;
          |SI #contrato#nCampo# = 6; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 450;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo8com";    || OTROS
          nCampo = 83;
          |SI #contrato#nCampo# = 7; |Y #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 990;
          |FINSI;
     |FINSI;

     |SI aCampo = "sel_tipo1parcial";    || T.C. OBRA O SERV. DETERMINADO
          nCampo = 83;
          |SI #contrato#nCampo# = 1; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 501;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo2parcial";    || EVENTUAL
          nCampo = 83;
          |SI #contrato#nCampo# = 2; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 502;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo3parcial";    || INTERINIDAD
          nCampo = 83;
          |SI #contrato#nCampo# = 3; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 510;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo4parcial";    || PRACTICAS
          nCampo = 83;
          |SI #contrato#nCampo# = 4; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 520;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo5parcial";    || EXCLUSION SOCIAL
          nCampo = 83;
          |SI #contrato#nCampo# = 6; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 550;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo6parcial";    || OTROS
          nCampo = 83;
          |SI #contrato#nCampo# = 7; |Y #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 990;
          |FINSI;
     |FINSI;

     || el contrato se realiza para:

     |SI aCampo = "interessocial";    || INTERES SOCIAL
          nCampo = 84;
          |SI #contrato#nCampo# = "I";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "fomempleoagra";    || FOMENTO EMPLEO AGRARIO
          nCampo = 84;
          |SI #contrato#nCampo# = "F";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;

     || el empleador es:

     |SI aCampo = "cooplocal";        || CORPORACION LOCAL
          nCampo = 85;
          |SI #contrato#nCampo# = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "orgadmingralestado"; || ORGANOS LA ADMINISTRACION DEL ESTADO
          nCampo = 85;
          |SI #contrato#nCampo# = 2;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "CCAA";        || COMUNIDAD AUTONOMA
          nCampo = 85;
          |SI #contrato#nCampo# = 3;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "entsinlucro";        || ENTIDAD SIN ANIMO DE LUCRO
          nCampo = 85;
          |SI #contrato#nCampo# = 4;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "universid";        || UNIVERSIDAD
          |SI #contrato#nCampo# = 5;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;

     |HAZ pe177;
|FPRC;

|PROCESO pe177Bena;
     |SI aCampo = "campanya";  || DESC. DE LAS EXIGENCIAS DEL MERCADO
          aValor = #contrato#78;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO anexoclaus_Bena;
     |SI aCampo = "dia";  || dia firma
          aValor = dia;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mes";  || mes firma
          aValor = mes;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "anyo";  || anyo firma
          aValor = anyo;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe179;
          |SI aCampo = "sel_causinter1";    || MATERNIDAD
               |SI #contrato#50 = 1;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_causinter2";    || ADOPCION
               |SI #contrato#50 = 2;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_causinter3";    || ACOGIMIENTO
               |SI #contrato#50 = 3;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_causinter4";    || RIESGO EMBARAZO
               |SI #contrato#50 = 4;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_causinter5";    || PATERNIDAD
               |SI #contrato#50 = 5;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_causinter6";    || RIESGO LACTANCIA
               |SI #contrato#50 = 6;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "activsust";    || ACTIVIDAD DE SUSTITUCION
               aValor =  #contrato#78;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "activcicli";    || ACTIVIDAD CICLICA
               aValor =  #contrato#76;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "duractcicli";    || DURACION ACTIVIDAD CICLICA
               aValor =  #contrato#77;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "nomtrasust";    || NOMBRE DEL TRABAJADOR A SUSTITUIR
               aValor =  #contrato#56;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "dnitrasus";    || DNI DEL TRABAJADOR A SUSTITUIR
               aValor =  #contrato#57;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "oecomusus";    || OFICINA DE EMPLEO TRABAJADOR A SUSTITUIR
               aValor =  #contrato#58;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fecharegsus";    || FECHA DE REGISTRO EN LA O.E. TRABAJADOR A SUSTITUIR
               aValor =  #contrato#59;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "idcontsus";    || ID DEL REGISTRO EN LA O.E. TRABAJADOR A SUSTITUIR
               aValor =  #contrato#60;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "puestodesem";    || PUESTO A DESEMPE¤AR
               aValor =  #contrato#61;
               |HAZ GrabaTemporal;
          |FINSI;

|FPRC;

|PROCESO pe181;
     aCodColDesp = #contrato#65;
/*
     |SI aCampo = "ind_ord";    || CONTRATO INDEFINIDO ORDINARIO
          aValor = "Si";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fijodiscontinuo";    || FIJOS DISCONTINUOS
          aValor = "Si";
          |HAZ GrabaTemporal;
     |FINSI;

     |SI aCampo = "sel_tpcon1";    || BONIFICADO
          |SI #contrato#78 = "S";
               nSwContrato = 350;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tpcon2";    || NO BONIFICADO
          |SI #contrato#78 = "N";
               nSwContrato = 300;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "activtrab";    || ACTIVIDAD DEL TRABAJADOR
          aValor = #contrato#52;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "duractiv";    || DURACION DE LA ACTIVIDAD DEL TRABAJADOR
          aValor = #contrato#63;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "activcicli";    || ACTIVIDAD CICLICA INTERMITENTE
          aValor = #contrato#53;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "duraestima";    || DURACION ESTIMADA
          aValor = #contrato#60;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "distrihora";    || DISTRIBUCION HORARIA
          aValor = #contrato#67;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "horasconv1";    || HORAS ESTIMADAS
          aValor = #contrato#66;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "sel_tpconv1";    || CC PERMITE MODALIDAD DE TIEMPO PARCIAL
          |SI #contrato#30 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tpconv2";    || CC NO PERMITE MODALIDAD DE TIEMPO PARCIAL
          |SI #contrato#30 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI #contrato#28 = "C";
          |SI aCampo = "horasjornacom";   || HORAS TIEMPO COMPLETO
               aValor = #contrato#32 + " horas";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI #contrato#28 = "P";
          |SI aCampo = "horasjornapar";   || HORAS TIEMPO PARCIAL
               aValor = #contrato#32
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "horas10";  || N§ DE HORAS MAXIMO LEGAL
           |SI #contrato#28 = "P"; |Y #contrato#77 = "C";
              aValor = #contrato#31;
              |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "octavasi";    || SI CONTRATO DE RELEVO
          |SI #contrato#49 = "S";
               swAnexoRelevo = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "octavano";    || NO CONTRATO DE RELEVO
          |SI #contrato#49 = "N";
               swAnexoRelevo = 0;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "tipohoras";
          |SI #contrato#29 = "D";  || DIARIAS
               aValor = "diarias";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI #contrato#29 = "S";  || SEMANALES
               aValor = "semanales";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI #contrato#29 = "M";  || MENSUALES
               aValor = "mensuales";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI #contrato#29 = "A";  || ANUALES
               aValor = "anuales";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "horatraba1";         || DISTRIBUCION JORNADA LINEA 1
          aAlfa = #contrato#56;
          |QBF aAlfa;
          aAlfa = aAlfa % 0;
          nNume = aAlfa;
          |SI nNume [ 40;
               aAlfa = #contrato#55;
               |QBF aAlfa;
               aAlfa = aAlfa + " " + #contrato#56;
               |QBF aAlfa;
               aValor = aAlfa;
               |HAZ GrabaTemporal;
          |SINO;
               aAlfa = #contrato#56;
               |QBF aAlfa;
               aAlfa = aAlfa % 4101;
               |SI aAlfa = " ";
                    aAlfa = #contrato#56;
                    aAlfa = aAlfa % 140;
                    |QBF aAlfa;
                    aValor = #contrato#55;
                    |QBF aValor;
                    aValor = aValor + " " + aAlfa;
                    |HAZ GrabaTemporal;
               |SINO;
                    aAlfa = #contrato#56;
                    aAlfa = aAlfa % 140;
                    aCadena = aAlfa;
                    aMiCaracter = " ";
                    nPorDonde = -1;
                    |HAZ BuscaCaracter;
                    nPos = nPos - 1;
                    nPos = 40 - nPos;
                    nPos = nPos + 100;
                    aAlfa = aAlfa % nPos;

                    aValor = #contrato#55;
                    |QBF aValor;
                    aValor = aValor + " " + aAlfa;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "horatraba2";         || DISTRIBUCION JORNADA LINEA 2
          aAlfa = #contrato#56;
          |QBF aAlfa;
          aAlfa = aAlfa % 0;
          nNume = aAlfa;
          |SI nNume [ 40;
               || no grabes nada
          |SINO;
               aAlfa = #contrato#56;
               |QBF aAlfa;
               aAlfa = aAlfa % 4101;
               |SI aAlfa = " ";
                    aAlfa = #contrato#56;
                    aAlfa = aAlfa % -130;
                    |QBF aAlfa;
                    aValor = aAlfa;
                    |HAZ GrabaTemporal;
               |SINO;
                    aAlfa = #contrato#56;
                    aAlfa = aAlfa % 140;
                    aCadena = aAlfa;
                    aMiCaracter = " ";
                    nPorDonde = -1;
                    |HAZ BuscaCaracter;
                    nPos = nPos - 1;
                    nPos = nPos + 100;
                    nPos = -1 * nPos;
                    aAlfa = aAlfa % nPos;
                    |QBF aAlfa;

                    aValor = #contrato#56;
                    aValor = aValor % -130;
                    aValor = aAlfa + aValor;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "casilla1";
          |SI #contrato#57 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla2";
          |SI #contrato#59 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla3";
          |SI #contrato#64 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla4";
          |SI #contrato#58 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla5";
          |SI #contrato#89 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla6";
          |SI #contrato#90 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla7";
          |SI #contrato#87 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI aCampo = "casilla8";
          |SI #contrato#88 = "X"; aValor = "Si"; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
*/
|FPRC;

|PROCESO pe182;
     swAnexoRelevo = 1;
     |SI aCampo = "nomtrabjp";     || NOMBRE TRABAJADOR
          aValor = trabanom;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechanacjp";     || FECHA NACIMIENTO TRABAJADOR
          aValor = trabafec;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "domsocialctjp";  || domicilio social empresa
          aValor = centrnom;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "profetrabajp";     || PROFESION TRABAJADOR
          aValor = trabapro;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe183;
/*
     aValor = "";
     fFechaIni = #contrato#41;
     fFechaFin = #contrato#55;

     |SI aCampo = "ind_conv_tem"; || TRANSFORMACION A INDEFINIDO
          aValor = "Si";
     |FINSI;

     |SI #contrato#57 = "C";
          |SI aCampo = "casilla_tc";
               |SI #contrato#57 = "C";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tc_bon";
               |SI #contrato#60 = "S";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tc_nobon";
               |SI #contrato#60 = "N";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tc_nobon_red";
               |SI #contrato#60 = "N"; |Y #contrato#58 = "S";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tc_nobon_nored";
               |SI #contrato#60 = "N"; |Y #contrato#58 = "N";
                    aValor = "Si";
               |FINSI;
          |FINSI;
     |FINSI;

     |SI #contrato#57 = "P";
          |SI aCampo = "casilla_tp";
               |SI #contrato#57 = "P";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tp_bon";
               |SI #contrato#60 = "S";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tp_nobon";
               |SI #contrato#60 = "N";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tp_nobon_red";
               |SI #contrato#60 = "N"; |Y #contrato#58 = "S";
                    aValor = "Si";
               |FINSI;
          |FINSI;
          |SI aCampo = "casilla_tp_nobon_nored";
               |SI #contrato#60 = "N"; |Y #contrato#58 = "N";
                    aValor = "Si";
               |FINSI;
          |FINSI;
     |FINSI;

     |SI aCampo = "nombsepe";   || SERVICIO PUBLICO DE EMPLEO
          aValor = #contrato#45;
     |FINSI;
     |SI aCampo = "anterior";   || CONTRATO ANTERIOR
          aValor = #contrato#51;
     |FINSI;
     |SI aCampo = "fechaconver";   || FECHA DE CONVERSION
          aValor = #contrato#41;
     |FINSI;
     |SI aCampo = "sel_tipocv1";   || CONVERSION EN TEMPORAL COMPLETO O PARCIAL
          |SI  #contrato#57 = "C"; |O  #contrato#57 = "P";
               aValor = "Si";
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipocv2";   || CONVERSION EN TEMPORAL FIJO DISC.
          |SI  #contrato#57 = "F";
               aValor = "Si";
          |FINSI;
     |FINSI;
     |SI aCampo = "fechacelecv";   || FECHA CELEBRACION
          aValor = #contrato#53;
     |FINSI;
     |SI aCampo = "oecomconv";   || SERVICIO PUBLICO DE EMPLEO
          aValor = #contrato#54;
     |FINSI;
     |SI aCampo = "fecharegcv";   || FECHA DE REGISTRO
          aValor = #contrato#55;
     |FINSI;
     |SI aCampo = "idcontconv";   || CON EL NUMERO
          aValor = #contrato#56;
     |FINSI;

     |SI aValor ! "";
          |HAZ GrabaTemporal;
     |FINSI;
*/
|FPRC;

|PROCESO pe185;
/*
          |SI aCampo = "sel_tpcon1";   || BONIFICADO
               |SI #contrato#57 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    nSwContrato = 309;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpcon2";   || NO BONIFICADO
               |SI #contrato#57 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
                    nSwContrato = 389;
               |FINSI;
          |FINSI;
          |SI aCampo = "bonif32012";
               |SI #contrato#83 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;

          |SI aCampo = "nombsepe";   || SERVICIO PUBLICO DE EMPLEO
               aValor = #contrato#45;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechaconver";   || CON FECHA
               aValor = #contrato#41;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "tipoctotem";   || TIPO CONTRATO TEMPORAL
               aValor = #contrato#30;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fechacelecv";   || FECHA CELEBRACION
               aValor = #contrato#53;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "oecomconv";   || SERVICIO PUBLICO DE EMPLEO
               aValor = #contrato#54;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "fecharegcv";   || EN FECHA
               aValor = #contrato#55;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "idcontconv";   || CON EL NUMERO
               aValor = #contrato#56;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "activtrab";   || ACTIVIDAD DEL TRABAJADOR
               aValor = #contrato#27;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "activcicli";   || ACTIVIDAD CICLICA EMP
               aValor = #contrato#38;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "duractiv";   || DURACION ACTIVIDAD
               aValor = #contrato#39;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "duraestima";   || DURACION ESTIMADA
               aValor = #contrato#60;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "horasjorna";   || HORAS JORNADA ESTIMADA
               aValor = #contrato#75;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "distrihora1";   || DISTR. HORARIA1
               |SI #contrato#76 = "D";  || DIARIAS
                    aValor = "diarias";
                    |HAZ GrabaTemporal;
               |FINSI;
               |SI #contrato#76 = "S";  || SEMANALES
                    aValor = "semanales";
                    |HAZ GrabaTemporal;
               |FINSI;
               |SI #contrato#76 = "M";  || MENSUALES
                    aValor = "mensuales";
                    |HAZ GrabaTemporal;
               |FINSI;
               |SI #contrato#76 = "A";  || ANUALES
                    aValor = "anuales";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "distrihora2";   || DISTR. HORARIA2
               aAlfa1 = #contrato#59;
               |QBF aAlfa1;
               aAlfa2 = #contrato#49;
               |QBF aAlfa2;

               aValor = aAlfa1 + " a " + aAlfa2;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "sel_tpconv1";   || TIEMPO PARCIAL -> SI
               |SI #contrato#28 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpconv2";   || TIEMPO PARCIAL -> NO
               |SI #contrato#28 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn1";   || JORNADA COMPLETA
               |SI #contrato#29 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn2";   || JORNADA PARCIAL
               |SI #contrato#29 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horasjorna_tp";
               |SI #contrato#29 = "S";
                    aValor = #contrato#32;
               |FINSI;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "sel_tpjorn21";   || JORNADA PARCIAL -> OPC. A
               |SI #contrato#29 = "S"; |Y #contrato#77 = "A";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn22";   || JORNADA PARCIAL -> OPC. B
               |SI #contrato#29 = "S"; |Y #contrato#77 = "B";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn23";   || JORNADA PARCIAL -> OPC. C
               |SI #contrato#29 = "S"; |Y #contrato#77 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horas\(8\)";   || HORAS DE JORNADA MAXIMA LEGAL
               |SI #contrato#29 = "S"; |Y #contrato#77 = "C";
                    aValor = #contrato#34;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "parcionretri";   || QUINTA (9)
               aValor = tiporet;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "salarioycomple";   || CONCEPTOS SALARIALES
               aValor = #contrato#33 + #contrato#40 + #contrato#42;
               |HAZ QuitaPuntos;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "sel_aplird1";   || CONTRATO DE RELEVO -> SI
               |SI #contrato#37 = "S";
                    swAnexoRelevo = 1;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_aplird2";   || CONTRATO DE RELEVO -> NO
               |SI #contrato#37 = "N";
                    swAnexoRelevo = 0;
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
*/
|FPRC;

|PROCESO pe186;
          aSwMinus = "S";
          |SI #contrato#64 = "C";
               nSwContrato = 130;
          |FINSI;
          |SI #contrato#64 = "P";
               nSwContrato = 230;
          |FINSI;
          |SI #contrato#64 = "F";
               nSwContrato = 330;
          |FINSI;

          |SI #contrato#64 = "P"; |Y #contrato#61 = "S";
               swAnexoHoras = 1;
          |FINSI;
          |SI #contrato#63 = "S";
               swAnexoRelevo = 1;
          |FINSI;
          |SI #contrato#62 = "S";
               nLey122001 = 1;
          |FINSI;
|FPRC;

|PROCESO pe187;
|FPRC;

|PROCESO pe190;
          aSwMinus = "C";
          |SI #contrato#28 = "I"; |Y #contrato#27 = "C";
                    nSwContrato = 150;
          |FINSI;
          |SI #contrato#28 = "I"; |Y #contrato#27 = "P";
                    nSwContrato = 250;
          |FINSI;
          |SI #contrato#28 = "I"; |Y #contrato#27 = "D";
                    nSwContrato = 350;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 1;
                    nSwContrato = 401;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 2;
                    nSwContrato = 402;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 3;
                    nSwContrato = 410;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 4;
                    nSwContrato = 430;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 5;
                    nSwContrato = 420;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 6;
                    nSwContrato = 421;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 7;
                    nSwContrato = 441;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "C"; |Y #contrato#29 = 8;
                    nSwContrato = 990;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 1;
                    nSwContrato = 501;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 2;
                    nSwContrato = 502;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 3;
                    nSwContrato = 510;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 4;
                    nSwContrato = 530;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 5;
                    nSwContrato = 520;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 6;
                    nSwContrato = 540;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 7;
                    nSwContrato = 541;
          |FINSI;
          |SI #contrato#28 = "T"; |Y #contrato#27 = "P"; |Y #contrato#29 = 8;
                    nSwContrato = 990;
          |FINSI;
          |SI #contrato#86 = "S";
                    swAnexoRelevo = 1;
          |FINSI;
          |SI #contrato#62 = "S";
                    nLey122001 = 1;
          |FINSI;
|FPRC;

|| CONTRATO INDEFINIDO BONIFICADO
|| ANTES ERAN DOS, EL pe172 y el pe194, AHORA LO HAN CAMBIADO AL PE-221,
|| QUE HACE LOS DOS EN UNO, COMO ES LOGICO

|PROCESO pe221;
     |SI aCampo = "sel_tipo1"; |O aCampo = "sel_tipo11";     || Jornada completa
          |SI #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo2"; |O aCampo = "sel_tipo22";    || Jornada parcial
          |SI #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "inicio";     || DESDE TIEMPO COMPLETO
          |SI #contrato#28 = "C";
               aValor = des;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "fin";     || DESDE TIEMPO COMPLETO
          |SI #contrato#28 = "C";
               aValor = has;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     aCodColDesp = #contrato#62;
     |SI #contrato#28 = "P";
          |SI aCampo = "sel_tpjorn1";    || AL DIA
               |SI #contrato#29 = "D";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn2";    || A LA SEMANA
               |SI #contrato#29 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn3";    || AL MES
               |SI #contrato#29 = "M";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_tpjorn4";    || AL A¤O
               |SI #contrato#29 = "A";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn1";   ||JORNADA MENOR T.C COMPARABLE
               |SI #contrato#77 = "A";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn2";   ||JORNADA MENOR JORN CONV COLEC
               |SI #contrato#77 = "B";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "sel_jorn3";   ||JORNADA MAXIMA LEGAL
               |SI #contrato#77 = "C";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "horas5";   || NUMERO DE HORAS
               |SI #contrato#77 = "C";
                    aValor = #contrato#31;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_l1220011";    || SI LEY 12/2001
          |SI #contrato#59 = "S";
               nLey122001 = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_l1220012";    || NO LEY 12/2001
          |SI #contrato#59 = "N";
               nLey122001 = 0;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_adj1";    || TRABAJOS FIJOS DISCONTINUOS SI
          |SI #contrato#101 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_adj2";    || TRABAJOS FIJOS DISCONTINUOS NO
          |SI #contrato#101 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi1";
          |SI #contrato#58 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi2";
          |SI #contrato#58 = "X"; |Y #contrato#63 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi3";
          |SI #contrato#58 = "X"; |Y #contrato#64 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi4";
          |SI #contrato#60 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi5";
          |SI #contrato#60 = "X"; |Y #contrato#63 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_requi6";
          |SI #contrato#60 = "X"; |Y #contrato#64 = "X";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe199;
     |SI aCampo = "tiempocompleto";    || TIEMPO COMPLETO
          |SI #contrato#27 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 403;
          |FINSI;
     |FINSI;
     |SI aCampo = "tiempooparcial";    || TIEMPO PARCIAL
          |SI #contrato#27 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
               nSwContrato = 503;
          |FINSI;
     |FINSI;

     |SI aCampo = "empleador1";    || EMPLEADOR -> CORPORACION LOCAL
          |SI #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "empleador2";    || EMPLEADOR -> ORGANOS ADMINISTRACION
          |SI #contrato#28 = "O";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "empleador3";    || EMPLEADOR -> COMUNIDAD AUTONOMA
          |SI #contrato#28 = "A";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "empleador4";    || EMPLEADOR -> ENTIDAD SIN ANIMO DE LUCRO
          |SI #contrato#28 = "E";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "empleador5";    || EMPLEADOR -> UNIVERSIDAD
          |SI #contrato#28 = "U";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "ejercpresupuestario1"; || PRIMER DIGITO DEL EJERCICIO PRESUPUESTARIO
          aAlfa = #contrato#67;
          aAlfa1 = aAlfa % 101;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ejercpresupuestario2"; || SEGUNDO DIGITO DEL EJERCICIO PRESUPUESTARIO
          aAlfa = #contrato#67;
          aAlfa1 = aAlfa % 201;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ejercpresupuestario3"; || TERCER DIGITO DEL EJERCICIO PRESUPUESTARIO
          aAlfa = #contrato#67;
          aAlfa1 = aAlfa % 301;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "ejercpresupuestario4"; || CUARTO DIGITO DEL EJERCICIO PRESUPUESTARIO
          aAlfa = #contrato#67;
          aAlfa1 = aAlfa % 401;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "entidad colaboradora";    || ENTIDAD
          |SI #contrato#68 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "actuacion1";    ||PRIMER CODIGO DE ACTUACION
          aAlfa = #contrato#69;
          aAlfa1 = aAlfa % 101;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "actuacion2";    ||SEGUNDO CODIGO DE ACTUACION
          aAlfa = #contrato#69;
          aAlfa1 = aAlfa % 201;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "actuacion3";    ||TERCER CODIGO DE ACTUACION
          aAlfa = #contrato#69;
          aAlfa1 = aAlfa % 301;
          aValor = aAlfa1;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "n\272ss";      || NUMERO S.S.
          aValor = #labtraba#33;
          aCadena = aCampo;
          |HAZ sustituye;
          aCampo = aCadenaSal;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "tiemcomple";    || TIEMPO COMPLETO
          |SI #contrato#27 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "tiemparc";   || TIEMPO PARCIAL
          |SI #contrato#27 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "hora1";       ||HORA DESDE
          |SI #contrato#27 = "C";
               aValor = des;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "hora2";       ||HORA HASTA
          |SI #contrato#27 = "C";
               aValor = has;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "duracto";    || DURACION DE LA JORNADA
          ||aValor =  titulo2;
          aValor = #contrato#40 + " meses";
          |SI #contrato#49 ! 0;
               aValor = aValor + " y " + #contrato#49 + " dias";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "jornadatra";    || JORNADA TIEMPO COMPLETO
          |SI #contrato#27 = "C";
               aValor =  #contrato#32;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "jornada";    || JORNADA TIEMPO PARCIAL
          |SI #contrato#27 = "P";
               aValor =  #contrato#32;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "distempo1";   || DISRIBUCION DEL TIEMPO DE TRAB. 1
          aValor = #contrato#57;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "distempo2";   || DISRIBUCION DEL TIEMPO DE TRAB. 2
          aValor = #contrato#59;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "desde";   || EL CONTRATO SE EXTIENDE DESDE
          aValor = #contrato#41;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "hasta";   || HASTA
          aValor = #contrato#42;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "retrib8";
          aValor = tiporet;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "sexta";
          nCampo1 = 88;
          aValor = #contrato#nCampo1#;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "servpubl";
          aValor = #contrato#45;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe202;
     |SI #contrato#54 = "I";
          |SI #contrato#28 = "C"; |Y #contrato#29 = "S";
               nSwContrato = 150;
          |FINSI;
          |SI #contrato#28 = "C"; |Y #contrato#29 = "N";
               nSwContrato = 100;
          |FINSI;
          |SI #contrato#28 = "F"; |Y #contrato#29 = "S";
               nSwContrato = 350;
          |FINSI;
          |SI #contrato#28 = "F"; |Y #contrato#29 = "N";
               nSwContrato = 300;
          |FINSI;
     |FINSI;
     |SI #contrato#54 = "T";
          |SI #contrato#50 = "X";
               nSwContrato = 401;
          |FINSI;
          |SI #contrato#51 = "X";
               nSwContrato = 402;
          |FINSI;
          |SI #contrato#64 = "X";
               nSwContrato = 410;
          |FINSI;
          |SI #contrato#67 = "X";
               nSwContrato = 990;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO anexoclaus;
     aAlfa = aCampo % 108;
     |SI aAlfa = "clausula";
          aAlfa = aCampo % -102;
          nNume = aAlfa;
          |SI nNume [ 18; |Y nVoypor = 1;    || pa que coja las 1as. 18
               nCampo = nNume + 8;
               aValor = #contrato#nCampo#;   || clausulas del def
               |HAZ GrabaTemporal;           || por si algo cambia
          |SINO;
               #labclafi#0 = nNume + (40 * (nVoypor - 1));
               |LEE 000#labclafi.=;
               |SI FSalida = 0;
                    aValor = #labclafi#1;
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "localidad";  || Localidad firma
          aValor = #contrato#46;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "dia";  || DIA FIRMA
          aValor = dia;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "mes";  || MES FIRMA
          aValor = mes ;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "anyo";  || ANYO FIRMA
          aValor = anyo ;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "pagina";  || PAGINA
          aAlfa1 = nVoypor;
          aAlfa2 = nNCA;
          aValor = "P\341gina " + aAlfa1 + " de " + aAlfa2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "registro";
          aEmp = #contrato#1; aEmp = "00000" + aEmp; aEmp = aEmp % -105;
          aTra = #contrato#2; aTra = "00000" + aTra; aTra = aTra % -105;
          aCon = contador; aCon = "000000" + aCon; aCon = aCon % -105;
          aValor = aEmp + " / " + aTra + " / " + aCon;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI swCopia = 1;
          |SI aCampo = "trabajador";  || NOMBRE DEL TRABAJADOR TRABAJADOR
               aValor = #labtraba#2;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
               aValor = #labtraba#20;
               |HAZ GrabaTemporal;
          |FINSI;

          ||AML
          |SI aCampo = "repre_emp";  || NOMBRE REPRESENTANTE EMPRESA
               aValor = #labempre#15;
               |HAZ GrabaTemporal;
          |FINSI;
          ||FIN AML

          |SI aCampo = "copiabasica";
               aValor = "";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma1";
               aValor = "El/la trabajador/a";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma2";
               aValor = "El/la representante de la empresa";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma3";
               aValor = "El/la representante legal del menor, si procede";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;    ||FIN FICHERO COPIA BASICA

     |SI swCopia = 2;
          |SI aCampo = "trabajador";  || NOMBRE DEL REPRESENTANTE SINDICAL
               aValor = #labcentr#12;
               |HAZ GrabaTemporal;
          |FINSI;

          ||AML
          |SI aCampo = "repre_emp";  || NOMBRE REPRESENTANTE EMPRESA
               aValor = #labempre#15;
               |HAZ GrabaTemporal;
          |FINSI;
          ||FIN AML

          |SI aCampo = "repre_legal";  || NOMBRE REPRESENTANTE LEGAL DEL MENOR SI PROCEDE
               aValor = "";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "copiabasica";
               aValor = "(COPIA B\301SICA)";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma1";
               aValor = "El/la representante sindical";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma2";
               aValor = "El/la representante de la empresa";
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "firma3";
               aValor = "";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe197;
     |SI aCampo = "denomtpcon";  || TIPO DE CONTRATO
         aValor = aTipoContr;
          ||aValor = #contrato#31;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "codtrab1";  || TRAB EN DESEMPLEO
          |SI #labconre#0 = "A";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "codtrab2";  || TRAB CON CTO. DE DURACION DETERMINADA
          |SI #labconre#0 = "B";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "oecomu";        ||OFICINA DE EMPLEO
          |SI #labconre#0 = "B";
               aValor = #labconre#1;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "idcont";        ||N§ REGISTRO EN LA OFICINA DE EMPLEO
          |SI #labconre#0 = "B";
               aValor = #labconre#2;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "fecharegcont";  ||FECHA DE REGISTRO EN LA OFICINA DE EMPLEO
          |SI #labconre#0 = "B";
               aValor = #labconre#3;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "oeinscri";      ||OFICINA DE EMPLEO
         |SI #labconre#0 = "A";
               aValor = #labconre#1;
               |HAZ GrabaTemporal;
         |FINSI;
     |FINSI;
     |SI aCampo = "nomtrab_jp";    ||NOMBRE DEL TRABAJADOR
          aValor = #labconre#17;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechanac_jp";   ||FECHA NAC. DEL TRABAJADOR
          aValor = #labconre#13;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "domsocialct";   ||DOMICILIO SOCIAL DEL CENTRO DE TRABAJO
          aValor = #labconre#14;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "profetraba";    ||PROFESION
          aValor = #labconre#15;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "catetraba";     ||CATEGORIA PROFESIONAL
          aValor = #labconre#16;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "poredjp";       ||PORCENTAJE DE REDUCCION
          aValor = #labconre#6 + "%";
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechajpdd";     ||SUSCRITO CON FECHA DESDE
          aValor = #labconre#7;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechajphh";     ||SUSCRITO CON FECHA HASTA
          aValor = #labconre#8;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "oecomu_jp";     ||SERVICIO PUBLICO DE EMPLEO
          aValor = #labconre#9;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "idcont_jp";       ||N§ REGISTRO EN EL SERVICIO PUBLICO DE EMPLEO
          aValor = #labconre#10;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fecharegcont_jp"; ||FECHA REGITRO EN EL SERVICIO PUBLICO DE EMPLEO
          aValor = #labconre#11;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "puestotrabrl";    ||PUESTO DE TRABAJO DEL TRABAJADOR
          aValor = #labconre#12;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "profetrabarl";    ||PROFESION DEL TRABAJADOR
          aValor = #labconre#15;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "catetrabarl";     ||CATEGORIA PROFESIONAL DEL TRABAJADOR
          aValor = #labconre#16;
          |HAZ GrabaTemporal;
     |FINSI;


|FPRC;

|PROCESO pe200;
     |DDEFECTO #labaux01;
     |ABRE #labaux01;
     #labaux01#0 = #contrato#1;
     #labaux01#1 = #contrato#2;
     |LEE 000#labaux01.=;
     |CIERRA #labaux01;

     |SI aCampo = "numhormax";   || NUMERO DE HORAS MAXIMAS
          aValor = #labaux01#2;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "voluntarias";   || NUMERO DE HORAS VOLUNTARIAS
          |SI #labaux01#11 ! 0;
               aValor = #labaux01#11;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "porchorpac";  || PORCENTAJE HORAS PACTADAS
          aValor = #labaux01#3;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "fechaini";    || PORCENTAJE HORAS PACTADAS
          aValor = #contrato#47;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "oereg";       || FECHA DEL CONTRATO
          aValor = #contrato#45;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "numdiasant";  || NUMERO DIAS ANTELACION
          aValor = #labaux01#4;
          |HAZ GrabaTemporal;
     |FINSI;
|FPRC;

|PROCESO pe213;
     |SI aCampo = "sector1";
          |SI #contrato#49 = "1";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sector2";
          |SI #contrato#49 = "2";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sector3";
          |SI #contrato#49 = "3";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sector";
          |SI #contrato#49 = "1";
               aValor = "Calzado, Curtidos y Marroquineria";
          |FINSI;
          |SI #contrato#49 = "2";
               aValor = "Juguete";
          |FINSI;
          |SI #contrato#49 = "3";
               aValor = "Mueble";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "normativa";
          |SI #contrato#49 = "1";
               aValor = "Real Decreto 100/2009";
          |FINSI;
          |SI #contrato#49 = "2";
               aValor = "Real Decreto 1678/2009";
          |FINSI;
          |SI #contrato#49 = "3";
               aValor = "Real Decreto 1679/2009";
          |FINSI;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI aCampo = "sel_tipo0";
          |SI #contrato#28 = "C";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo1";
          |SI #contrato#28 = "P";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_tipo2";
          |SI #contrato#28 = "F";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     /*
     |SI aCampo = "menor55";
          |SI #contrato#49 = "1";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "mayor55";
          |SI #contrato#49 = "2";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     */
     |SI aCampo = "horasjorna";   || JORNADA ORDINARIA
          |SI #contrato#28 = "C";
               aValor = #contrato#32;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "horasjorna1";   || JORNADA ORDINARIA
          |SI #contrato#28 = "P";
               aValor = #contrato#32;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "horas5";   || JORNADA MAXIMA
          |SI #contrato#28 = "P"; |Y #contrato#30 = "C";
               aValor = #contrato#31;
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "comp1";   || JORNADA MAXIMA
          |SI #contrato#28 = "P"; |Y #contrato#30 = "C"; |Y #contrato#40 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "comp2";   || JORNADA MAXIMA
          |SI #contrato#28 = "P"; |Y #contrato#30 = "C"; |Y #contrato#40 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "si1";    || TRABAJOS FIJOS DISCONTINUOS SI
          |SI #contrato#28 = "P"; |O #contrato#28 = "F";
               |SI #contrato#101 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "no1";    || TRABAJOS FIJOS DISCONTINUOS NO
          |SI #contrato#28 = "P"; |O #contrato#28 = "F";
               |SI #contrato#101 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_l1220011";    || SI LEY 12/2001
          |SI #contrato#59 = "S";
               nLey122001 = 1;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_l1220012";    || NO LEY 12/2001
          |SI #contrato#59 = "N";
               nLey122001 = 0;
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO pe222;
     |SI aCampo = "sel_rd520011";  || LEY 12/2001 -> Si
          |SI #contrato#62 = "S";
                nLey122001 = 1;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_rd520012";  || LEY 12/2001 -> No
          |SI #contrato#62 = "N";
                nLey122001 = 0;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "fijodiscontinuo";  || fijo discontinuo
          |SI #contrato#75 = "F";
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "contributiva";
          |SI #contrato#79 = 1;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "subsidio";
          |SI #contrato#79 = 2;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "rentaactiva";
          |SI #contrato#79 = 3;
                aValor = "Si";
                |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "prestacion";
          aValor = #contrato#80;
          |HAZ GrabaTemporal;
     |FINSI;
     |SI #contrato#28 = "P";
          |SI aCampo = "porjornada"; aValor = #contrato#93; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "horasanuales"; aValor = #contrato#92; |HAZ GrabaTemporal; |FINSI;
     |FINSI;
     |SI #contrato#75 = "F";
          |SI aCampo = "Texto73"; aValor = #contrato#81; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto74"; aValor = #contrato#83; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto75"; aValor = #contrato#84; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto76"; aValor = #contrato#82; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto77"; aValor = #contrato#85; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto78"; aValor = #contrato#86; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "Texto79";
               |SI #contrato#87 = "D";  aValor = "diarias";  |FINSI;
               |SI #contrato#87 = "S";  aValor = "semanales"; |FINSI;
               |SI #contrato#87 = "M";  aValor = "mensuales"; |FINSI;
               |SI #contrato#87 = "A";  aValor = "anuales"; |FINSI;
               |HAZ GrabaTemporal;
          |FINSI;
          |SI aCampo = "Texto80"; aValor = #contrato#88; |HAZ GrabaTemporal; |FINSI;
          |SI aCampo = "distpsi";
               |SI #contrato#89 = "S";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
          |SI aCampo = "distpno";
               |SI #contrato#89 = "N";
                    aValor = "Si";
                    |HAZ GrabaTemporal;
               |FINSI;
          |FINSI;
     |FINSI;
     |SI aCampo = "RD"; aValor = #contrato#90; |HAZ GrabaTemporal; |FINSI;
     |SI aCampo = "BOE"; aValor = #contrato#91; |HAZ GrabaTemporal; |FINSI;
     |SI aCampo = "sel_adj1";    || TRABAJOS FIJOS DISCONTINUOS SI
          |SI #contrato#75 = "P"; |Y #contrato#101 = "S";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
     |SI aCampo = "sel_adj2";    || TRABAJOS FIJOS DISCONTINUOS NO
          |SI #contrato#75 = "P"; |Y #contrato#101 = "N";
               aValor = "Si";
               |HAZ GrabaTemporal;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaCampos;
     aValor = "";
     aCampo = #pdfdocli#2;
     |QBF aCampo;
     aCadena = aCampo;
     |HAZ sustituye;
     aCampo = aCadenaSal;
     nTipo = #pdfdocli#3;
     aCodColDesp = "";
     aIndDisc    = ""; aSwMinus = "";
     |SI aArchivo = "pe-170.pdf"; |O aArchivo = "pe-232.pdf";
        |SI #contrato#28 = "C"; nSwContrato = 100; |FINSI;
        |SI #contrato#28 = "P"; nSwContrato = 200; |FINSI;
     |FINSI;
     |SI aArchivo = "pe-239.pdf";
        |SI #contrato#28 = "C"; nSwContrato = 150; |FINSI;
        |SI #contrato#28 = "P"; nSwContrato = 250; |FINSI;
     |FINSI;
     |SI aArchivo = "pe-222.pdf";
        |SI #contrato#75 = "C"; nSwContrato = 150; |FINSI;
        |SI #contrato#75 = "P"; nSwContrato = 250; |FINSI;
        |SI #contrato#75 = "F"; nSwContrato = 350; |FINSI;
     |FINSI;
     |HAZ comunes;

     |SI aArchivo = "pe-170.pdf"; |O aArchivo = "pe-170cb.pdf";
          ||HAZ pe170;
     |FINSI;

     |SI aArchivo = "pe-181.pdf"; |O aArchivo = "pe-181cb.pdf";
          ||HAZ pe181;
     |FINSI;

     |SI aArchivo = "pe-183.pdf"; |O aArchivo = "pe-183cb.pdf";
     |O aArchivo = "pe-209.pdf"; |O aArchivo = "pe-209cb.pdf";
          ||HAZ pe183;
          fFechaIni = #contrato#41;
          fFechaFin = #contrato#55;
     |FINSI;

     |SI aArchivo = "pe-185.pdf"; |O aArchivo = "pe-185cb.pdf";
     |O aArchivo = "pe-210.pdf"; |O aArchivo = "pe-210cb.pdf";
          ||HAZ pe185;
     |FINSI;

     |SI aArchivo = "pe-174i.pdf"; |O aArchivo = "pe-174icb.pdf";
     |O aArchivo = "pe-174t.pdf"; |O aArchivo = "pe-174tcb.pdf";
          |HAZ pe174;
     |FINSI;

     |SI aArchivo = "pe-166.pdf"; |O aArchivo = "pe-166cb.pdf";
          |HAZ pe166;
     |FINSI;

     |SI aArchivo = "pe-237.pdf"; |O aArchivo = "pe-237cb.pdf";
          |HAZ pe237;
     |FINSI;

     |SI aArchivo = "pe-239.pdf"; |O aArchivo = "pe-239cb.pdf";
          |HAZ pe170;
     |FINSI;

     |SI aArchivo = "pe-218i.pdf"; |O aArchivo = "pe-218icb.pdf";
     |O aArchivo = "pe-218t.pdf"; |O aArchivo = "pe-218tcb.pdf";
          |HAZ pe174;    || (tambien, es casi igual al pe-174)
     |FINSI;

     |SI aArchivo = "pe-238i.pdf"; |O aArchivo = "pe-238icb.pdf";
     |O aArchivo = "pe-238t.pdf"; |O aArchivo = "pe-238tcb.pdf";
          |HAZ pe238;    || sus campos propios
     |FINSI;

     |SI aArchivo = "pe-175.pdf"; |O aArchivo = "pe-175cb.pdf";
     |O aArchivo = "pe-228.pdf"; |O aArchivo = "pe-228cb.pdf";
          swAnexoFormacion = 1
          |HAZ pe175;
     |FINSI;

     |SI aArchivo = "anexoformacion.pdf";
     |O aArchivo = "anexoformacion1.pdf";
     |O aArchivo = "anexoformacion2.pdf";
          |HAZ anexoformacion;
     |FINSI;

     |SI aArchivo = "pe-224.pdf";       || anexo contrato reduccion cuotas
          |HAZ anexoreduccion;
     |FINSI;

     |SI aArchivo = "pe-176.pdf"; |O aArchivo = "pe-176cb.pdf";
          |HAZ pe176;
     |FINSI;

     |SI aArchivo = "pe-177a.pdf"; |O aArchivo = "pe-177acb.pdf";
     |O aArchivo = "pe-177b.pdf"; |O aArchivo = "pe-177bcb.pdf";
     |O aArchivo = "pe-177c.pdf"; |O aArchivo = "pe-177ccb.pdf";
     |O aArchivo = "pe-177d.pdf"; |O aArchivo = "pe-177dcb.pdf";
     |O aArchivo = "pe-177e.pdf"; |O aArchivo = "pe-177ecb.pdf";
          |HAZ pe177;
     |FINSI;

     |SI aArchivo = "pe-177_Bena.pdf"; |O aArchivo = "pe-177_Benacb.pdf";
          |HAZ pe177Bena;
     |FINSI;

     |SI aArchivo = "pe-206.pdf"; |O aArchivo = "pe-206cb.pdf";
          |HAZ pe206;
     |FINSI;

     |SI aArchivo = "pe-179.pdf"; |O aArchivo = "pe-179cb.pdf";
          |HAZ pe179;
     |FINSI;

     |SI aArchivo = "pe-151.pdf"; |O aArchivo = "pe-151cb.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "pe-171.pdf"; |O aArchivo = "pe-171cb.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "pe-172.pdf"; |O aArchivo = "pe-172cb.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "pe-182.pdf"; |O aArchivo = "pe-182cb.pdf";
          |HAZ pe182;
     |FINSI;

     |SI aArchivo = "pe-186.pdf"; |O aArchivo = "pe-186cb.pdf";
          |HAZ pe186;
     |FINSI;

     |SI aArchivo = "pe-187.pdf"; |O aArchivo = "pe-187cb.pdf";
          |HAZ pe187;
     |FINSI;

     |SI aArchivo = "pe-190i.pdf"; |O aArchivo = "pe-190icb.pdf";
     |O aArchivo = "pe-190t.pdf"; |O aArchivo = "pe-190tcb.pdf";
          |HAZ pe190;
     |FINSI;

     |SI aArchivo = "pe-221.pdf"; |O aArchivo = "pe-221cb.pdf";
          |HAZ pe221;
     |FINSI;

     |SI aArchivo = "pe-199.pdf"; |O aArchivo = "pe-199cb.pdf";
          |HAZ pe199;
     |FINSI;

     |SI aArchivo = "pe-202i.pdf"; |O aArchivo = "pe-202icb.pdf";
     |O aArchivo = "pe-202t.pdf"; |O aArchivo = "pe-202tcb.pdf";
          |HAZ pe202;
     |FINSI;

     |SI aArchivo = "pe-232.pdf"; |O aArchivo = "pe-232cb.pdf";
          |HAZ pe170;    || NO HAGO PROCESO pe232, seria igual que el pe170
     |FINSI;

     |SI aArchivo = "pe-222.pdf"; |O aArchivo = "pe-222cb.pdf";
          |HAZ pe222;
     |FINSI;

     |SI aArchivo = "anexoclaus.pdf";
          |HAZ anexoclaus;
     |FINSI;

     |SI aArchivo = "pe-197.pdf";
          |HAZ pe197;
     |FINSI;

     |SI aArchivo = "pe-200.pdf";
          |HAZ pe200;
     |FINSI;

     |SI aArchivo = "pe-213.pdf"; |O aArchivo = "pe-213cb.pdf";
          |HAZ pe213;
     |FINSI;

     |SI aArchivo = "anexoclaus_Bena.pdf";
          |HAZ anexoclaus_Bena;
     |FINSI;

     |SI aArchivo = "pe-226.pdf";
          swAnexoFormacion = 1
          |HAZ pe226;
     |FINSI;

     |SI aArchivo = "pe-228.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "pe-229.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "pe-230.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aArchivo = "AnexoEdutedis12.pdf"; |O aArchivo = "AnexoSystem.pdf";
          |HAZ Contratos_plb;
     |FINSI;

     |SI aSwMinus = "";
        |SI nSwContrato = 430; |O nSwContrato = 530; aSwMinus = "S"; |FINSI;
        |SI nSwContrato = 421; |Y #contrato#69 ! " "; aSwMinus = "S"; |FINSI;
        |SI nSwContrato = 420; |Y #contrato#69 ! " "; aSwMinus = "S"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaTemporal;
     |QBF aValor;
     aCadena = aValor;
     |HAZ sustituye;
     aValor = aCadenaSal;
     aAlfa1 = aValor % 101;
     |SI aAlfa1 = ".";
          aValor = "";
     |FINSI;
     #pdfimtmp#0 = aCampo;
     #pdfimtmp#1 = aValor;
     #pdfimtmp#2 = nTipo;
     |GRABA 020#pdfimtmp.n;
|FPRC;

|DEFBUCLE GrabaTemporal;
     #pdfdocli#1;
     ;
     aArchivo,   1;
     aArchivo, 999;
     ;
     NULL, CargaCampos;
|FIN;

|PROCESO CargaTemporal;
     |SI aArchivo = "comdatoscontr.pdf";     || este no esta en el mantemiento
          |ACABA;
     |FINSI;
     #pdfdocca#0 = aArchivo;
     |LEE 000#pdfdocca.=;
     |SI FSalida ! 0;
          aAlfa1 = "    Archivo " + aArchivo + " no encontrado en el Mantenimiento ";
          aAlfa1 = aAlfa1 + "de ficheros PDF.";
          |MENAV aAlfa1;
          |ACABA;
          swCarga = 0;
     |SINO;
          aID = #pdfdocca#2;
     |FINSI;
|FPRC;

|PROCESO TmpClaus;
     aTmp = Usuario;
     |QBF aTmp;
     aTmp = aTmp + "zzzzzzzzzz";
     aTmp = aTmp % 107;
     aTmp = "t" + aTmp;
     |NOME_DAT #8 aTmp;
|FPRC;

|PROCESO ImpresionPDF;

     |SI enTipoEmision = 1;
        |SI aProcedencia = "ComunDatos"; |ACABA; |FINSI;
        |SI aProcedencia = "clauconf"; |ACABA; |FINSI;
     |FINSI;
                              || swCopia = 1 -> Estamos en Copia Normal
                              || swCopia = 2 -> Estamos en Copia Basica

     |||si swCopiaBasica = 2 -> haremos copia basica
     |||si swCopiaBasica = 1 -> no haremos copia basica

     |PARA swCopia = 1; |SI swCopia [ swCopiaBasica; |HACIENDO swCopia = swCopia + 1;
          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;
          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;
          |ABRE #pdfdocca;
          |ABRE #pdfdocli;
          |ABRE #labclafi;

          |HAZ BuscaArchivo;     ||asigna a aArchivo el nombre del pdf
          |HAZ CargaTemporal;    ||mira a ver si esta el pdf en el mantenimiento
          |HAZ CargaPrevia;      ||datos para la cabecera

          |SI PARAMETRO = "CONTRAT@";
             nHayCopiaBas = 0;
             |SI swCopiaBasica = 2; nHayCopiaBas = 1; |FINSI;
             swCopiaBasica = 1;
          |FINSI;
          |SI swCopia = 1; |Y swAnexoClaus = 0; |Y swAnexoRelevo = 0;
            |Y swAnexoHoras = 0 ; |Y swAnexoFormacion = 0;
||Y nLabHisto ! 1;
            || SI NO SE TRATA DEL FICHERO DE LA COPIA BASICA
               |HAZ CodigosMunicipio;
                    ||Carga en la variable aCodMuniE el codigo municipio empresa
                    ||Carga en la variable aCodMuniT el dodigo municipio trabajador
                    ||Carga en la variable aCodMuniC el dodigo municipio centro
          |FINSI;

          |SI aProcedencia ! "ComunDatos";
             fFechaIni   = "00.00.0000"; fFechaFin   = "00.00.0000";
             nLey122001 = 0;
             |BUCLE GrabaTemporal;
          |SINO;
             |HAZ ComunicacionDatos;
          |FINSI;

          |SI aProcedencia ! "ComunDatos";
               |HAZ ClausulasConf;
          |FINSI;

          |CIERRA #labclafi;
          |CIERRA #pdfimtmp;
          |CIERRA #pdfdocca;
          |CIERRA #pdfdocli;

          |SI enTipoEmision = 2;
               |SI aProcedencia ! "ComunDatos";
               |Y aProcedencia ! "clauconf";
                    |ACABA;
               |FINSI;
          |FINSI;

          |SI PARAMETRO ! "CONTRAT@";
             |SUB_EJECUTA "pdfgraba";
          |SINO;
             |HAZ Contrata;
          |FINSI;
     |SIGUE;
|FPRC;

|PROCESO ClausulasConf;
      aCampo = "Titulo";
      aValor = "ANEXO AL CONTRATO DE TRABAJO";
      |HAZ GrabaTemporal;
|FPRC;

|PROCESO ComunicacionDatos;
   nTipo = 0;

   |ABRE #labpadre;
   #labpadre#0 = #labtraba#0;
   #labpadre#1 = #labtraba#1;
   |LEE 000#labpadre.=;
   |SI FSalida ! 0; |DDEFECTO #labpadre; |FINSI;
   |CIERRA #labpadre;

   |ABRE #nomconca;
   #nomconca#0 = #labtraba#87;
   |LEE 000#nomconca.=;
   |SI FSalida ! 0; |DDEFECTO #nomconca; |FINSI;
   |CIERRA #nomconca;

   |SI nSwContrato = "100"; aCampo = "el100"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "109";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo completo bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "109";                                         |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "130"; aCampo = "el130"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "139";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo completo minusvalidos"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "139";                                           |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "150"; aCampo = "el150"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "189";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo completo no bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "189";                                            |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "200"; aCampo = "el200"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "209";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo parcial bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "209";                                        |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "230"; aCampo = "el230"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "239";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo parcial minusvalidos"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "239";                                          |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "250"; aCampo = "el250"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "289";
      aCampo = "modcontr"; aValor = "Transformacion a tiempo parcial no bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "289";                                           |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "300"; aCampo = "el300"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "309";
      aCampo = "modcontr"; aValor = "Transformacion a fijo discontinuo bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "309";                                          |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "330";
      aCampo = "modcontr"; aValor = "Minusvalido fijo discontinuo"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "330";                          |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "350"; aCampo = "el350"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "389";
      aCampo = "modcontr"; aValor = "Transformacion a fijo discontinuo no bonificada"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "389";                                             |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "401"; aCampo = "el401"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "402"; aCampo = "el402"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "403";
      aCampo = "modcontr"; aValor = "Inserci¢n a tiempo completo";  |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "403";                          |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "410"; aCampo = "el410"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "420"; aCampo = "el420"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "421"; aCampo = "el421"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "430";
      aCampo = "modcontr"; aValor = "Temporal minusvalido a tiempo completo";  |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "430";                                     |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "441"; aCampo = "el441"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "450";
      aCampo = "modcontr"; aValor = "Situacion de exclusion social a tiempo completo"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "450";                                             |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "501"; aCampo = "el501"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "502"; aCampo = "el502"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "503";
      aCampo = "modcontr"; aValor = "Inserci¢n a tiempo parcial"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "503";                        |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "510"; aCampo = "el510"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "520"; aCampo = "el520"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "530";
      aCampo = "modcontr"; aValor = "Temporal minusv lido a tiempo parcial"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "530";                                   |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "540";
      aCampo = "modcontr"; aValor = "Jubilacion parcial"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "540";                |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "550";
      aCampo = "modcontr"; aValor = "Situacion de exclusion social a tiempo parcial"; |HAZ GrabaTemporal;
      aCampo = "codigo";   aValor = "550";                                            |HAZ GrabaTemporal;
   |FINSI;
   |SI nSwContrato = "541"; aCampo = "el541"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "980"; aCampo = "el980"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;
   |SI nSwContrato = "990"; aCampo = "el990"; aValor = "X"; |HAZ GrabaTemporal; |FINSI;

   aCampo = "nombrerep";  aValor = #labempre#15;   |HAZ GrabaTemporal;
   aCampo = "nifrep";     aValor = #labempre#17;   |HAZ GrabaTemporal;
   aCampo = "conceptode"; aValor = #labempre#18;   |HAZ GrabaTemporal;
   aCampo = "nombreemp";  aValor = #labempre#2;    |HAZ GrabaTemporal;
   aCampo = "nifemp";     aValor = #labempre#10;   |HAZ GrabaTemporal;
   aCampo = "calleemp";   aValor = #labempre#3;    |HAZ GrabaTemporal;
   aCampo = "numeroemp";  aValor = #labempre#4;    |HAZ GrabaTemporal;
   aCampo = "poblemp";    aValor = #labempre#6;    |HAZ GrabaTemporal;
   aCampo = "cpemp";
   aValor = (("00" + #labempre#7) % -102) + (("000" + #labempre#8) % -103);
   |HAZ GrabaTemporal;
   aCampo = "provemp";    aValor = #labempre#9;    |HAZ GrabaTemporal;
   aCampo = "pobtremp";   aValor = #labcentr#6;    |HAZ GrabaTemporal;
   aCampo = "cptremp";
   aValor = (("00" + #labcentr#7) % -102) + (("000" + #labcentr#8) % -103);
   |HAZ GrabaTemporal;

   aCampo = "provtremp";  aValor = #labcentr#9;    |HAZ GrabaTemporal;
   aCampo = "ctass1a";    aValor = aRSSD1;         |HAZ GrabaTemporal;
   aCampo = "ctass2a";    aValor = aRSSD2;         |HAZ GrabaTemporal;
   aCampo = "ctass3a";    aValor = aRSSD3;         |HAZ GrabaTemporal;
   aCampo = "ctass4a";    aValor = aRSSD4;         |HAZ GrabaTemporal;
   aCampo = "ctass1b";    aValor = aCPRD1;         |HAZ GrabaTemporal;
   aCampo = "ctass2b";    aValor = aCPRD2;         |HAZ GrabaTemporal;
   aCampo = "ctass1c";    aValor = aCodCCC % 0301; |HAZ GrabaTemporal;
   aCampo = "ctass2c";    aValor = aCodCCC % 0401; |HAZ GrabaTemporal;
   aCampo = "ctass3c";    aValor = aCodCCC % 0501; |HAZ GrabaTemporal;
   aCampo = "ctass4c";    aValor = aCodCCC % 0601; |HAZ GrabaTemporal;
   aCampo = "ctass5c";    aValor = aCodCCC % 0701; |HAZ GrabaTemporal;
   aCampo = "ctass6c";    aValor = aCodCCC % 0801; |HAZ GrabaTemporal;
   aCampo = "ctass7c";    aValor = aCodCCC % 0901; |HAZ GrabaTemporal;
   aCampo = "ctass1d";    aValor = aDC1;           |HAZ GrabaTemporal;
   aCampo = "ctass2d";    aValor = aDC2;           |HAZ GrabaTemporal;

   aCampo = "activ";       aValor = #labempre#12;  |HAZ GrabaTemporal;
   aCampo = "nombretra";   aValor = #labtraba#2;   |HAZ GrabaTemporal;
   |SI #labpadre#5 = "V";  aValor = "Varon";  |FINSI;
   |SI #labpadre#5 = "M";  aValor = "Mujer";  |FINSI;
   aCampo = "sexotra";     |HAZ GrabaTemporal;
   aCampo = "niftra";      aValor = #labtraba#7;   |HAZ GrabaTemporal;
   aCampo = "fechanactra"; aValor = #labtraba#11;  |HAZ GrabaTemporal;
   aCampo = "naciontra";
   aAlfa = #labtraba#76 % 103;
   nNume = aAlfa;
   |SI nNume ] 001; |Y nNume [ 999;
       aAlfa = #labtraba#76 - aAlfa;
       aValor = aAlfa;
   |SINO;
       aValor = "ESPA¥A";
   |FINSI;
   |HAZ GrabaTemporal;
   aCampo = "numafiltra";  aValor = #labtraba#75;  |HAZ GrabaTemporal;
   aCampo = "paistra";     aValor = "ESPA¥A";      |HAZ GrabaTemporal;
   aCampo = "poblrestra";  aValor = #labtraba#6;   |HAZ GrabaTemporal;
   aCampo = "convactiv";   aValor = #nomconca#1;   |HAZ GrabaTemporal;

   aCampo = "profesion";   aValor = #labtraba#19;  |HAZ GrabaTemporal;
   aCampo = "titulacion";  aValor = #labtraba#12;  |HAZ GrabaTemporal;
   aCampo = "fechaini";    aValor = #contrato#41;  |HAZ GrabaTemporal;
   aCampo = "fechafin";    aValor = #contrato#42;  |HAZ GrabaTemporal;

   nSwParcial = 0;
   |SI aContrProc = "labcon01"; |O aContrProc = "labconb3";
    |O aContrProc = "labcon36"; |O aContrProc = "labconb7";
    |O aContrProc = "labcon75"; |O aContrProc = "labconb8";
    |O aContrProc = "labcon02"; |O aContrProc = "labcon52";
    |O aContrProc = "labcon54";
      |SI #contrato#28 = "P"; nSwParcial = 1; |FINSI;
   |FINSI;
   |SI aContrProc = "labcon95"; |O aContrProc = "labcon99";
    |O aContrProc = "labcon39"; |O aContrProc = "labcon9a";
    |O aContrProc = "labcon55";
      |SI #contrato#28 = "P"; nSwParcial = 1; |FINSI;
   |FINSI;
   |SI aContrProc = "labconb2"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labcona5"; |Y #contrato#57 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labcona6"; |Y #contrato#29 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labcon05"; |Y #contrato#56 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labcon09"; |Y #contrato#64 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labconx4"; |Y #contrato#32 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labconb5"; |Y #contrato#56 = "P"; nSwParcial = 1; |FINSI;
   |SI aContrProc = "labcon53"; |Y #contrato#56 = "P"; nSwParcial = 1; |FINSI;

   |SI nSwParcial = 1;
      aCampo = "horas";       aValor = #contrato#32;  |HAZ GrabaTemporal;
      |SI aTipoJorn = "D";
         aCampo = "dia";         aValor = "X";        |HAZ GrabaTemporal;
         aCampo = "semana";      aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "mes";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "anyo";        aValor = "Off";      |HAZ GrabaTemporal;
      |FINSI;
      |SI aTipoJorn = "S";
         aCampo = "dia";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "semana";      aValor = "X";        |HAZ GrabaTemporal;
         aCampo = "mes";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "anyo";        aValor = "Off";      |HAZ GrabaTemporal;
      |FINSI;
      |SI aTipoJorn = "M";
         aCampo = "dia";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "semana";      aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "mes";         aValor = "X";        |HAZ GrabaTemporal;
         aCampo = "anyo";        aValor = "Off";      |HAZ GrabaTemporal;
      |FINSI;
      |SI aTipoJorn = "A";
         aCampo = "dia";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "semana";      aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "mes";         aValor = "Off";      |HAZ GrabaTemporal;
         aCampo = "anyo";        aValor = "X";        |HAZ GrabaTemporal;
      |FINSI;
      aCampo = "horasconv";      aValor = #nomconca#141; |HAZ GrabaTemporal;
   |FINSI;
   |SI aContrProc = "labcon75";
      aCampo = "bonif"; aValor = "X";  |HAZ GrabaTemporal;
   |FINSI;
   |SI aContrProc = "labcona5"; |O aContrProc = "labcona6";
    |O aContrProc = "labconb5";
       |SI #contrato#62 = "S";
          aCampo = "ley12201s"; aValor = "X";    |HAZ GrabaTemporal;
          aCampo = "ley12201n"; aValor = "Off";  |HAZ GrabaTemporal;
       |SINO;
          aCampo = "ley12201n"; aValor = "X";    |HAZ GrabaTemporal;
          aCampo = "ley12201s"; aValor = "Off";  |HAZ GrabaTemporal;
       |FINSI;
   |FINSI;
   |SI nSwContrato = 421;
       aCampo = "horasforma"; aValor = #contrato#50; |HAZ GrabaTemporal;
   |FINSI;

   |SI #labcontr#37 ! 0;
      aCampo = "copbasno"; aValor = "Off";  |HAZ GrabaTemporal;
      aCampo = "copbassi"; aValor = "X";    |HAZ GrabaTemporal;
      aAlfa = #labcentr#12; |QBF aAlfa;
      |SI aAlfa = "NO EXISTE"; |O aAlfa = "";
         aCampo = "copbasfirm";  aValor = "Off";  |HAZ GrabaTemporal;
         aCampo = "copbasnorep"; aValor = "X";    |HAZ GrabaTemporal;
      |SINO;
         aCampo = "copbasfirm";  aValor = "X";    |HAZ GrabaTemporal;
         aCampo = "copbasnorep"; aValor = "Off";  |HAZ GrabaTemporal;
      |FINSI;
   |SINO;
      aCampo = "copbasno"; aValor = "X";       |HAZ GrabaTemporal;
      aCampo = "copbassi"; aValor = "Off";     |HAZ GrabaTemporal;
      aCampo = "copbasfirm";  aValor = "Off";  |HAZ GrabaTemporal;
      aCampo = "copbasnorep"; aValor = "Off";  |HAZ GrabaTemporal;
   |FINSI;

   aCampo = "fechalugar";     aValor = #contrato#46;  |HAZ GrabaTemporal;
   aCampo = "fechadia";       aValor = dia;           |HAZ GrabaTemporal;
   aCampo = "fechames";       aValor = mes;           |HAZ GrabaTemporal;
   aCampo = "fechaanyo";      aValor = anyo;          |HAZ GrabaTemporal;
|FPRC;

|| **************************************************************************
|| *****     PROCESOS PARA LA EMISION DE CONTRATOS EN FICHEROS XML      *****
|| **************************************************************************

|PROCESO Contrata;
   aAlfa = "    Opcion en desarrollo (" + nSwContrato + ")";
   ||MENAV aAlfa; |ACABA;

   |ABRE #labpadre; |ABRE #labcotmp;
   |ABRE #labenvcc; |ABRE #labenvcl;
   #labpadre#0 = #labtraba#0;
   #labpadre#1 = #labtraba#1;
   |LEE 000#labpadre.=;
   |SI FSalida ! 0; |DDEFECTO #labpadre; |FINSI;

   |SI nSwContrato = 109; |O nSwContrato = 139; |O nSwContrato = 189;
    |O nSwContrato = 209; |O nSwContrato = 239; |O nSwContrato = 289;
    |O nSwContrato = 309; |O nSwContrato = 389;
      nSwTrans = 1;
   |SINO;
      nSwTrans = 0;
   |FINSI;

   nNumero = 1;
   |LEE 000#labenvcc.p;
   |PARA; |SI FSalida = 0; |HACIENDO;
      |SI #labenvcc#3 = "          ";
         |SI eaNumProrr = "  ";
            |SI nSwTrans = 0;
               |SI #labenvcc#5 = "C"; |Y #labenvcc#6 = #labtraba#0; |SAL; |FINSI;
            |SINO;
               |SI #labenvcc#5 = "T"; |Y #labenvcc#6 = #labtraba#0; |SAL; |FINSI;
            |FINSI;
         |SINO;
            |SI #labenvcc#5 = "P"; |SAL; |FINSI;
         |FINSI;
      |FINSI;
      |SI #labenvcc#6 = #labtraba#0; nNumero = #labenvcc#0 + 1; |FINSI;
      |LEE 000#labenvcc.s;
   |SIGUE;

   |SI eaNumProrr = "  ";
      |SI nSwTrans = 0;
         aAlfa = "C";
      |SINO;
         aAlfa = "T";
      |FINSI;
   |SINO;
      aAlfa = "P";
   |FINSI;

   |SI #labenvcc#5 = " "; |O #labenvcc#5 ! aAlfa; |O #labenvcc#3 ! "          "; |O #labenvcc#6 ! #labtraba#0;
      |DDEFECTO #labenvcc;
      #labenvcc#0 = nNumero;
      #labenvcc#5 = aAlfa;
      #labenvcc#6 = #labtraba#0;
      |GRABA 020#labenvcc.c;
   |FINSI;

   |DDEFECTO #labenvcl;
   #labenvcl#0 = #labenvcc#0;
   #labenvcl#1 = 99;
   #labenvcl#2 = #labtraba#0;
   |LEE 000#labenvcl.];
   |SI FSalida = 0;
      |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labtraba#0;
         |LEE 000#labenvcl.a;
         |SI FSalida = 0;
            |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labtraba#0;
               nLin = 1;
            |SINO;
               nLin = #labenvcl#1 + 1;
            |FINSI;
         |SINO;
            nLin = 1;
         |FINSI;
      |FINSI;
   |SINO;
      |LEE 000#labenvcl.u;
      |SI FSalida = 0;
         |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labtraba#0;
            nLin = 1;
         |SINO;
            nLin = #labenvcl#1 + 1;
         |FINSI;
      |SINO;
         nLin = 1;
      |FINSI;
   |FINSI;

   |ABRE #labregis;
   #labregis#0 = enNumRegis;
   |LEE 000#labregis.=;
   |SI FSalida ! 0; |DDEFECTO #labregis; |FINSI;
   |CIERRA #labregis;

   enRegis1 = #labregis#0;
   enRegis2 = #labregis#1;
   enRegis3 = #labregis#2;

   |DDEFECTO #labenvcl;
   #labenvcl#0 = #labenvcc#0;
   #labenvcl#1 = nLin;
   #labenvcl#2 = #labregis#1;
   #labenvcl#3 = #labregis#2;
   #labenvcl#4 = #labregis#4;
   #labenvcl#5 = #labregis#21;
   #labenvcl#6 = #labempre#2;
   #labenvcl#7 = #labtraba#2;
   #labenvcl#8 = "E" + (("00" + #labtraba#8) % -102) + "0" + (("000000" + #labregis#0) % -106);
   #labenvcl#9 = #labregis#0;
   #labenvcl#10 = eaNumProrr;
   |SI eaNumProrr = "  ";
      |SI nSwTrans = 0;
         #labenvcl#11 = "C";
      |SINO;
         #labenvcl#11 = "T";
      |FINSI;
   |SINO;
      #labenvcl#11 = "P";
   |FINSI;

   |SI nHayCopiaBas = 1;
      #labenvcl#12 = "S";
   |SINO;
      #labenvcl#12 = "N";
   |FINSI;
   |SI swNetContrata ! 1;
      |GRABA 020#labenvcl.n;
   |FINSI;

   |SI eaNumProrr = "  ";
      fFechaIni = #contrato#41;
      fFechaFin = #contrato#42;
      fFechaIniCto = #contrato#55;
      |SI fFechaFin = "..........";
         fFechaFin = "00.00.0000";
      |FINSI;
      |HAZ Contrato;
   |FINSI;

/*
   |SI nHayCopiaBas = 1;
      nNumero = 1;
      |LEE 000#labenvcc.p;
      |PARA; |SI FSalida = 0; |HACIENDO;
         |SI #labenvcc#3 = "          ";
            |SI #labenvcc#5 = "O"; |Y #labenvcc#6 = #labtraba#0; |SAL; |FINSI;
         |FINSI;
         |LEE 000#labenvcc.s;
         |SI #labenvcc#6 = #labtraba#0; nNumero = #labenvcc#0 + 1; |FINSI;
      |SIGUE;
      |SI #labenvcc#5 = " "; |O #labenvcc#5 ! "O"; |O #labenvcc#3 ! "          "; |O #labenvcc#6 ! #labtraba#0;
         |DDEFECTO #labenvcc;
         #labenvcc#0 = nNumero;
         #labenvcc#5 = "O";
         #labenvcc#6 = #labtraba#0;
         |GRABA 020#labenvcc.c;
      |FINSI;

      |DDEFECTO #labenvcl;
      #labenvcl#0 = #labenvcc#0;
      #labenvcl#1 = 99;
      #labenvcl#2 = #labregis#1;
      |LEE 000#labenvcl.];
      |SI FSalida = 0;
         |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labregis#1;
            |LEE 000#labenvcl.a;
            |SI FSalida = 0;
               |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labregis#1;
                  nLin = 1;
               |SINO;
                  nLin = #labenvcl#1 + 1;
               |FINSI;
            |SINO;
               nLin = 1;
            |FINSI;
         |FINSI;
      |SINO;
         |LEE 000#labenvcl.u;
         |SI FSalida = 0;
            |SI #labenvcl#0 ! #labenvcc#0; |O #labenvcl#2 ! #labregis#1;
               nLin = 1;
            |SINO;
               nLin = #labenvcl#1 + 1;
            |FINSI;
         |SINO;
            nLin = 1;
         |FINSI;
      |FINSI;

      |DDEFECTO #labenvcl;
      #labenvcl#0 = #labenvcc#0;
      #labenvcl#1 = nLin;
      #labenvcl#2 = #labregis#1;
      #labenvcl#3 = #labregis#2;
      #labenvcl#4 = #labregis#4;
      #labenvcl#5 = #labregis#21;
      #labenvcl#6 = #labempre#2;
      #labenvcl#7 = #labtraba#2;
      #labenvcl#8 = "E" + (("00" + #labtraba#8) % -102) + "0" + (("000000" + #labregis#0) % -106);
      #labenvcl#9 = #labregis#0;
      #labenvcl#10 = eaNumProrr;
      #labenvcl#11 = "O";
      #labenvcl#12 = "N";
      |GRABA 020#labenvcl.n;

      |HAZ CopiaBasica;
   |FINSI;
*/
   |CIERRA #labpadre; |CIERRA #labcotmp;
   |CIERRA #labenvcc; |CIERRA #labenvcl;
|FPRC;
