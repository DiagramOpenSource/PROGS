|FICHEROS;
     labcerm5,MANTE; || Cabecera
     labcerm6,MANTE; || Lineas
|FIN;

|VARIABLES;
     Puntero = 0;
     DocRecibo = 0;
     Comodin = "";

     nBaffer = 0;
     nTotalLinea = 0; nTope = 0; nVari1 = 0; nVari2 = 0;

     &enModoEdita  = 0;
     &enTotalVaria = 0;
     &enCampoAncho = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;

{100}&epPuntEdita   = "";

     &aAlojamiento = "";
     aAlfa = "";
     aCodigo = "";
     nCodigo = 0;
     aAny = "";
     nModo = 0;
|FIN;

|PROCESO GrabaSecuencial;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |AL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edicion;
     nTope  = nTotalLinea - 1;
     nVari1 = 0;
     nVari2 = 0;
     |SI enModoEdita < 100;
          enModoEdita = enModoEdita + 100;
     |FINSI;
     |EDITA nBaffer, 1, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     || enModoEdita = 300;
     || EDITA nBaffer, 1, nTope, enCuadroIni, enCuadroFin, enModoEdita, eaNombreList, enCampoAncho, nVari1, nVari2;
     || PTEC 807;
     enModoEdita = enModoEdita $ 100;
|FPRC;

|PROCESO CogePuntero;
     IepPuntEdita  = epPuntEdita1 <-;
     |PARA nTotalLinea = 0;  |SI nTotalLinea [ enTotalVaria;  |HACIENDO nTotalLinea = nTotalLinea + 1;
          |DEL_BUF nBaffer, nTotalLinea, epPuntEdita;
          IepPuntEdita = IepPuntEdita + 1;
     |SIGUE;
|FPRC;

|PROCESO Edita;
     ||PUSHV 0501 2380;
     |DIMENSIONA  200, nBaffer, 0;

     |HAZ GrabaSecuencial;

     |HAZ Edicion;
     |HAZ CogePuntero;

     |FINDIM nBaffer;
|FPRC;

|PROCESO comentario;
     || si el comentario es nuevo voy inicializando las lineas del array
     || epPuntEdita, si ya existia pongo a cero los campos del registro
     || y me los meto en el array epPuntEdita

     |ABRE #labcerm6;
     |PARA Puntero = 1; |SI Puntero [ 5; |HACIENDO Puntero = Puntero + 1;

          IepPuntEdita  = epPuntEdita1 <-;
          IepPuntEdita = IepPuntEdita + (Puntero - 1);

          nCodigo = #labcerm5#0;

          #labcerm6#0 = #labcerm5#0;
          #labcerm6#1 = #labcerm5#1;
          #labcerm6#2 = #labcerm5#2;
          #labcerm6#3 = Puntero;
          |LEE 101#labcerm6.=;
          |SI FSalida ! 0;
               epPuntEdita  = "";
          |SINO;
               epPuntEdita  = #labcerm6#4
               |BORRA 020#labcerm6.a;
               |LIBERA #labcerm6;
          |FINSI;
     |SIGUE;
     |CIERRA #labcerm6;

     ||PUSHV 0501 2080;

     |HAZ Edita;

     ||POPV;

     |ABRE #labcerm6;
     |PARA Puntero = 1;  |SI Puntero [ 5;  |HACIENDO Puntero = Puntero + 1;
          IepPuntEdita  = epPuntEdita1 <-;
          IepPuntEdita = IepPuntEdita + (Puntero - 1);

          |DDEFECTO #labcerm6;
          #labcerm6#0 = #labcerm5#0;
          #labcerm6#1 = #labcerm5#1;
          #labcerm6#2 = #labcerm5#2;
          #labcerm6#3 = Puntero;
          |LEE 101#labcerm6.=;
          |SI FSalida ! 0;
               Comodin = epPuntEdita; |QBF Comodin;
               |SI Comodin ! "";
                    #labcerm6#4 = epPuntEdita;
                    |GRABA 020#labcerm6.n;
               |FINSI;
          |SINO;
               Comodin = epPuntEdita; |QBF Comodin;
               |SI Comodin ! "";
                    #labcerm6#4 = epPuntEdita;
                    |GRABA 020#labcerm6.a;
               |FINSI;
          |FINSI;
     |SIGUE;
     |CIERRA #labcerm6;
|FPRC;

|PROCESO borrame; |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 3;
          |ABRE #labcerm6;
          |PARA Puntero = 1; |SI Puntero [ 5; |HACIENDO Puntero = Puntero + 1;
               || IepPuntEdita  = epPuntEdita1 <-;
               || IepPuntEdita = IepPuntEdita + (Puntero - 1);

               nCodigo = #labcerm5#0;

               #labcerm6#0 = #labcerm5#0;
               #labcerm6#1 = #labcerm5#1;
               #labcerm6#2 = #labcerm5#2;
               #labcerm6#3 = Puntero;
               |LEE 101#labcerm6.=;
               |SI FSalida = 0;
                    || epPuntEdita  = "";
               || SINO;
                    || epPuntEdita  = #labcerm6#4;
                    |BORRA 020#labcerm6.a;
                    |LIBERA #labcerm6;
               |FINSI;
          |SIGUE;
          |CIERRA #labcerm6;
     |FINSI;
|FPRC;

|PROCESO modifica; |TIPO 0;
     enModoEdita = 0;
     |HAZ comentario;
|FPRC;

|PROCESO muestra;
     enModoEdita = 300;
     |HAZ comentario;
|FPRC;

|PROCESO destruye; |TIPO 11;
     enModoEdita = 400;
     |HAZ comentario;
|FPRC;

|PROCESO Programa;
     enTotalVaria = 100;
     enModoEdita = 0;
     enCampoAncho = 76;
     eaNombreList = "";
     enCuadroIni = 1303;
     enCuadroFin = 1777;
|DEBUG;
     |HAZ modifica;
|FPRC;
