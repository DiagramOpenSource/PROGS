|FICHEROS;
     labllaca #0;
     labllali #1,MANTE;
     labtraba;
     labempre;
     labcentr;
     labregis;
     pdfimtmp #100;
     labmunic;
|FIN;

|VARIABLES;
     &aArchivo = "";
     &aListaFich = "";

     nCodigo = 0;
     nModo = 0;
     swHayAlgo = 0;
     aRegistro = "";
     aFecha1 = "";
     aFecha2 = "";
     aAlfa = "";
     aAlfa1 = "";
     aAlfa2 = "";
     aMuni = "";
     aCampo = "";
     aValor = "";
     &nMensajeF5 = 0;
     &aCodigoMunicipio = "";

     nAscii = 0;
     aCaracter = "";
     aCaracterSal = "";
     aCadena = "";
     aCadenaSal = "";
     nPos = 0;
     nBusca = 0;
     coma = ",";
     nTipo = 0;
     aLongitud = "";
     nLongitud = 0;

     nContMuni = 0;
     aCodMuni = "";
     aCodPos = "";
     nCuantos = 0;

     direcc = "";
     numero = "";
     piso = "";
     cod1 = "";
     cod2 = "";
     locali = "";
     domemp = "";
     compactado = "";

     aCodMuniE = "";
     nNume = 0;

     aCPED1 = "";
     aCPED2 = "";
     aCPED3 = "";
     aCPED4 = "";
     aCPED5 = "";
     codpostem1 = "";
     codpostem2 = "";
     codpostem3 = "";
     codpostem4 = "";
     codpostem5 = "";
     aRegimen = "";
     aRSSD1 = "";
     aRSSD2 = "";
     aRSSD3 = "";
     aRSSD4 = "";
     regimen1 = "";
     regimen2 = "";
     regimen3 = "";
     regimen4 = "";
     aCodCCC = "";
     aProvincia = "";
     aCPRD1 = "";
     aCPRD2 = "";
     aDigControl = "";
     aDC1 = "";
     aDC2 = "";
     aACTD1 = "";
     aACTD2 = "";
     aPaisEmpresa = "";
     aPaisCentro = "";
     aPED1 = "";
     aPED2 = "";
     aPED3 = "";
     aPCD1 = "";
     aPCD2 = "";
     aPCD3 = "";
     codpaisct1 = "";
     codpaisct2 = "";
     codpaisct3 = "";
     municen = "";
     aCodMuniC = "";
     swCuenta = 0;
     nTrabajadores = 0;
     &nTotalHojas = 0;
     &nHoja = 0;
     &aProcedencia = "labllaca";
     &nTipoSalida = 0;
     nLinea = 0;
     nTexto = 0;
     nVoyPorTrab = 0;
     &nContador = 0;
     &nOpcion = 0;

     &enEmpresa = 0;
     &enCentro = 0;
     &efFechaIni = @;
     &efFechaFin = @;
     &enCodLlama = 0;
|FIN;

|PROCESO Tipo5_1; |TIPO 5;
     #labllali#11 = "S";
     |LINEAS_BI_ATRI #labllali#11, S, I, -1;
|FPRC;

|PROCESO Mensa1; |TIPO 7;
     |MENSA "    Pulse < F5 > para marcar el trabajador como enviado o no enviado";
|FPRC;

|PROCESO Func1; |TIPO 11;
     |SI FSalida = 13;
          |SI #labllali#11 = "S";
               #labllali#11 = "N";
          |SINO;
               #labllali#11 = "S";
          |FINSI;
          |PINTA #labllali#11;
          |GRABA 020#labllali.a;
          |LIBERA #labllali;
          |ERROR;
     |FINSI;
|FPRC;

|PROCESO Codigo; |TIPO 7;
     nCodigo = 0;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |ABRE #labllaca;
          |SALVA_DATOS #labllaca;
          #labllaca#0 = #labllaca#0;
          #labllaca#1 = #labllaca#1;
          #labllaca#2 = #labllaca#2;
          #labllaca#3 = #labllaca#3;
          #labllaca#4 = #labllaca#4;
          |LEE 000#labllaca.=
          |SI FSalida = 0;
               nCodigo = #labllaca#4 + 1;
          |FINSI;
          |REPON_DATOS #labllaca;

          |SI nCodigo ! 0;
               #labllaca#4 = nCodigo;
               |PINTA #labllaca#4;
          |FINSI;
          |CIERRA #labllaca;
     |FINSI;
|FPRC;

|PROCESO labregis;
     swHayAlgo = 1;
     aFecha1 = #labregis#7;
     aFecha2 = #labllali#8;
     |SI aFecha1 = aFecha2;
          aRegistro = #labregis#14;
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          |ERROR10;
     |SINO;
          aRegistro = #labregis#14;
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
          aRegistro = aRegistro - "-";
     |FINSI;
|FPRC;

|DEFBUCLE labregis;
     #labregis#2;
     ;
     #labllali#0, #labllali#5;
     #labllali#0, #labllali#5;
     ;
     NULL, labregis;
|FIN;

|PROCESO Registro; |TIPO 7;
     aRegistro = #labllali#10;
     |QBF aRegistro;
     |SI aRegistro ! "";
          |ACABA;
     |FINSI;

     |ABRE #labregis;
     |BUCLE labregis;
     |CIERRA #labregis;
     #labllali#10 = aRegistro;
     aRegistro = aRegistro - "-";
     aRegistro = aRegistro - "-";
     aRegistro = aRegistro - "-";
     aRegistro = aRegistro - "-";
     aRegistro = aRegistro - "-";
     |PINTA #labllali#10;
|FPRC;

|| PARA BUSCAR EL CODIGO DE MUNICIPIO

|PROCESO CuentaMunicipio;
     nContMuni = nContMuni + 1;
     aCodMuni = #labmunic#1;
|FPRC;

|DEFBUCLE CuentaMunicipio;
     #labmunic#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,CuentaMunicipio;
|FIN;

|PROCESO BuscaMunicipio;
     aAlfa2 = #labmunic#3;            || aAlfa2 = municipio de labmunic
     |QBT aAlfa2;
     aMuni = #labempre#6;   || aMuniEmp = municipio de labempre
     aMuni = aMuni > "";
     |QBT aMuni;

     aAlfa = aMuni - aAlfa2;
     |SI aAlfa ! aMuni;
          ||aAlfa2 esta en aMuni
          aCodMuni = #labmunic#1;
          nContMuni = nContMuni + 1;
     |FINSI;
|FPRC;

|DEFBUCLE BuscaMunicipio;
     #labmunic#1;
     ;
     aCodPos, "00000";
     aCodPos, "99999";
     ;
     NULL,BuscaMunicipio;
|FIN;

|PROCESO min_labmunic;
     #labmunic#4 = aCodPos;
     #labmunic#1 = "00000";
|FPRC;

|PROCESO max_labmunic;
     #labmunic#4 = aCodPos;
     #labmunic#1 = "99999";
|FPRC;

|PROCESO CodigoMuni;
     nContMuni = 0;
     |BUCLE CuentaMunicipio;

     |SI nContMuni > 1;
          nContMuni = 0;
          |BUCLE BuscaMunicipio;
          |SI nContMuni > 1;
               nMensajeF5 = 1;
               aCodigoMunicipio = "";
               |SUB_EJECUTA "labmunic";
               |SI aCodigoMunicipio ! "";
                    aCodMuni = aCodigoMunicipio;
                    nContMuni = 1;
               |FINSI;
          |FINSI;
     |FINSI;

     |SI nContMuni = 0;
          nMensajeF5 = 1;
          aCodigoMunicipio = "";
          |SUB_EJECUTA "labmunic";
          |SI aCodigoMunicipio ! "";
               aCodMuni = aCodigoMunicipio;
               nContMuni = 1;
          |FINSI;
     |FINSI;
     ||ahora se supone que en aCodMuni tenemos el codigo del municipio
|FPRC;

|PROCESO sustituye2;
     nAscii = & aCaracter;
     aCaracterSal = aCaracter;
     |SI nAscii = 160;             || el caracter  
          aCaracterSal = "\341";
     |FINSI;
     |SI nAscii = 130;             || el caracter ‚
          aCaracterSal = "\351";
     |FINSI;
     |SI nAscii = 161;             || el caracter ¡
          aCaracterSal = "\355";
     |FINSI;
     |SI nAscii = 162; |O nAscii = 243;            || el caracter ¢
          aCaracterSal = "\363";
     |FINSI;
     |SI nAscii = 163;             || el caracter £
          aCaracterSal = "\372";
     |FINSI;
     |SI nAscii = 164;             || el caracter ¤
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 241;             || el caracter ¤ (otro codigo ¨?)
          aCaracterSal = "\361";
     |FINSI;
     |SI nAscii = 165;             || el caracter ¥
          aCaracterSal = "\321";
     |FINSI;
     |SI nAscii = 129;
          aCaracterSal = "\374";   || el caracter u con dieresis
     |FINSI;
     |SI nAscii = 154;
          aCaracterSal = "\334";   || el caracter U (mayuscula) con dieresis
     |FINSI;
     |SI nAscii = 167;
          aCaracterSal = "\272";   || el caracter §
     |FINSI;
     |SI nAscii = 166;
          aCaracterSal = "\252";   || el caracter ¦
     |FINSI;
     |SI aCaracter = "(";
          aCaracterSal = "\(";
     |FINSI;
     |SI aCaracter = ")";
          aCaracterSal = "\)";
     |FINSI;
|FPRC;

|PROCESO sustituye;
     aCadenaSal = "";
     aLongitud = aCadena % 0;
     nLongitud = aLongitud;
     |PARA nPos = 1; |SI nPos [ nLongitud; |HACIENDO nPos = nPos + 1;
          nBusca = (nPos * 100) + 1;
          aCaracter = aCadena % nBusca;
          |HAZ sustituye2;
          aCadenaSal = aCadenaSal + aCaracterSal;
     |SIGUE;
|FPRC;

|PROCESO GrabaTemporal;
     aAlfa1 = aValor % 101;
     |SI aAlfa1 = ".";
          aValor = "";
     |FINSI;
     |QBF aValor;
     aCadena = aValor;
     |HAZ sustituye;
     aValor = aCadenaSal;
     #pdfimtmp#0 = aCampo;
     #pdfimtmp#1 = aValor;
     #pdfimtmp#2 = nTipo;
     |GRABA 020#pdfimtmp.n;
|FPRC;

|PROCESO regimen;
     aRegimen = #labtraba#247;
|FPRC;

|DEFBUCLE regimen;
     #labllali#1;
     ;
     #labllaca#0, #labllaca#1, #labllaca#2, #labllaca#3, #labllaca#4, 00001;
     #labllaca#0, #labllaca#1, #labllaca#2, #labllaca#3, #labllaca#4, 99999;
     ;
     NULL, regimen;
|FIN;

|PROCESO compac2;                      || SUBRUTINA DE RUTINA domicili
     compactado = "";                  || DE COMPACTACION DE CAMPOS
     |QBF direcc;                      || PARA EL DOMICILIO DE LA EMPRESA
     |QBF numero;
     |QBF piso;
     |SI direcc ! "";
          compactado = direcc + coma + " ";
     |FINSI;
     compactado = compactado + numero;
     compactado = compactado + "  ";
     compactado = compactado + piso;
     compactado = compactado % 170;
|FPRC;

|PROCESO domicili;                      || RUTINA DEL CALCULO actualiz
     direcc = #labempre#3;                     || PARA CONSTRUCCION DOMICILIOS
     numero = #labempre#4;
     piso   = #labempre#5;
     cod1   = #labempre#7;
     cod2   = #labempre#8;
     locali = #labempre#6;
     |HAZ compac2;
     domemp = compactado;              || domicilio empresa
|FPRC;

|PROCESO cabecera;
     |ABRE #labempre;
     #labempre#0 = #labllaca#0;
     |LEE 000#labempre.=;
     |CIERRA #labempre;

     |ABRE #labcentr;
     #labcentr#0 = #labllaca#0;
     #labcentr#1 = #labllaca#1;
     |LEE 000#labcentr.=;
     |CIERRA #labcentr;

     aCampo = "cif";  || CIF empresa
     aValor = #labempre#10;
     |HAZ GrabaTemporal;

     aCampo = "nomrepr";  || nombre representante empresa
     aValor = #labempre#15;
     |HAZ GrabaTemporal;

     aCampo = "dnirep";  || DNI representante
     aValor = #labempre#17;
     |HAZ GrabaTemporal;

     aCampo = "cargorep";  || cargo representante
     aValor = #labempre#18;
     |HAZ GrabaTemporal;

     aCampo = "razsoc";   || nombre o razon social empresa
     aValor = #labempre#2;
     |HAZ GrabaTemporal;

     |HAZ domicili;
     aCampo = "domsocialem";   || domicilio social empresa
     aValor = domemp;
     |HAZ GrabaTemporal;

     aPaisEmpresa = "724";
     aPED1 = aPaisEmpresa % 101;   || pais empresa digito 1
     aPED2 = aPaisEmpresa % 201;   || pais empresa digito 2
     aPED3 = aPaisEmpresa % 301;   || pais empresa digito 3
     aCampo = "codpaisem1";  || codigo pais digito 1
     aValor = aPED1;
     |HAZ GrabaTemporal;
     aCampo = "codpaisem2";  || codigo pais digito 2
     aValor = aPED2;
     |HAZ GrabaTemporal;
     aCampo = "codpaisem3";  || codigo pais digito 3
     aValor = aPED3;
     |HAZ GrabaTemporal;

     aCampo = "pais";        ||  pais
     aValor = "ESPA¥A";
     |HAZ GrabaTemporal;

     aCodPos = (("00" + #labempre#7) % -102) + (("000" + #labempre#8) % -103);
     |HAZ CodigoMuni;
     aCodMuniE = aCodMuni;

     aCampo = "muniemp";         ||  municipio empresa
     aValor = #labempre#6;
     |HAZ GrabaTemporal;
     aCampo = "codmuniem1";      || codigo municipio empresa 1
     aValor = aCodMuniE % 101;
     |HAZ GrabaTemporal;
     aCampo = "codmuniem2";      || codigo municipio empresa 1
     aValor = aCodMuniE % 201;
     |HAZ GrabaTemporal;
     aCampo = "codmuniem3";      || codigo municipio empresa 2
     aValor = aCodMuniE % 301;
     |HAZ GrabaTemporal;
     aCampo = "codmuniem4";      || codigo municipio empresa 3
     aValor = aCodMuniE % 401;
     |HAZ GrabaTemporal;
     aCampo = "codmuniem5";      || codigo municipio empresa 4
     aValor = aCodMuniE % 501;
     |HAZ GrabaTemporal;

     || CODIGO POSTAL

     aCPED1 = aCodPos % 101;
     aCPED2 = aCodPos % 201;
     aCPED3 = aCodPos % 301;
     aCPED4 = aCodPos % 401;
     aCPED5 = aCodPos % 501;
     aCampo = "codpostem1"; aValor = aCPED1; |HAZ GrabaTemporal;
     aCampo = "codpostem2"; aValor = aCPED2; |HAZ GrabaTemporal;
     aCampo = "codpostem3"; aValor = aCPED3; |HAZ GrabaTemporal;
     aCampo = "codpostem4"; aValor = aCPED4; |HAZ GrabaTemporal;
     aCampo = "codpostem5"; aValor = aCPED5; |HAZ GrabaTemporal;

     |BUCLE regimen;
     |QBF aRegimen;
     aRegimen = ("0000" + aRegimen) % -104;

     aRSSD1 = aRegimen % 101;
     aRSSD2 = aRegimen % 201;
     aRSSD3 = aRegimen % 301;
     aRSSD4 = aRegimen % 401;
     aCampo = "regimen1"; aValor = aRSSD1; |HAZ GrabaTemporal;
     aCampo = "regimen2"; aValor = aRSSD2; |HAZ GrabaTemporal;
     aCampo = "regimen3"; aValor = aRSSD3; |HAZ GrabaTemporal;
     aCampo = "regimen4"; aValor = aRSSD4; |HAZ GrabaTemporal;

     aCodCCC = #labcentr#10;

     || PROVINCIA CTA. COTIZACION.

     aProvincia = aCodCCC;
     |QBF aProvincia;
     aProvincia = aProvincia % 102;
     aProvincia = "00" + aProvincia;
     aProvincia = aProvincia % -102;
     aCPRD1 = aProvincia % 101;
     aCPRD2 = aProvincia % 201;


     || DIGITO CONTROL CTA.COTIZACION

     aDigControl = aCodCCC;
     |QBF aDigControl;
     aDigControl = aDigControl % 1002;
     aDigControl = "00" + aDigControl;
     aDigControl = aDigControl % -102;
     aDC1 = aDigControl % 101;
     aDC2 = aDigControl % 201;

     || ACTIVIDAD ECONOMICA

     aAlfa = #labcentr#22;
     |QBF aAlfa;
     |SI aAlfa ! "";
          aACTD1 = aAlfa % 101;
          aACTD2 = aAlfa % 201;
     |SINO;
          aACTD1 = #labempre#11 % -201;
          aACTD2 = #labempre#11 % -101;
     |FINSI;

     aCampo = "provniss1";  || PROVINCIA CTA.COTIZACION DIGITO 1
     aValor = aCPRD1;
     |HAZ GrabaTemporal;
     aCampo = "provniss2";  || PROVINCIA CTA.COTIZACION DIGITO 2
     aValor = aCPRD2;
     |HAZ GrabaTemporal;
     aCampo = "numniss";  || CTA. COTIZACION
     aValor = aCodCCC % 307;
     |HAZ GrabaTemporal;
     aCampo = "digcon1";   || DIGITO CONTROL CTA.COTIZACION DIGITO 1
     aValor = aDC1;
     |HAZ GrabaTemporal;
     aCampo = "digcon2";    || DIGITO CONTROL CTA.COTIZACION DIGITO 2
     aValor = aDC2;
     |HAZ GrabaTemporal;

     aCampo = "litacteco";  || ACTIVIDAD ECONOMICA LITERAL
     aAlfa = #labcentr#23;
     |QBF aAlfa;
     |SI #labcentr#17 ! 0; |Y aAlfa ! "";
           aValor = #labcentr#23;
     |SINO;
           aValor = #labempre#12;
           aAlfa = aValor % 101;
           nNume = &aAlfa;
           |SI nNume ] 48; |Y nNume [ 57;
               aValor = aValor - ".";
               aAlfa = FSalida;
               nNume = aAlfa;
               |SI nNume = 0;
                    aAlfa = "0160";
               |SINO;
                    aAlfa = ("00" + aAlfa) % -104;
                    aAlfa = aAlfa % 102;
                    nNume = aAlfa;
                    nNume = nNume + 1;
                    aAlfa = nNume;
                    aAlfa = ("00" + aAlfa) % -102;
                    aAlfa = aAlfa + "60";
               |FINSI;
               aValor = aValor % aAlfa;
          |FINSI;
     |FINSI;
     |HAZ GrabaTemporal;

     aCampo = "codacteco1";   || ACTIVIDAD ECONOMICA DIGITO 1
     aValor = aACTD1;
     |QBF aValor;
     |SI aValor = ""; aValor = "0"; |FINSI;
     |HAZ GrabaTemporal;

     aCampo = "codacteco2";   || ACTIVIDAD ECONOMICA DIGITO 2
     aValor = aACTD2;
     |QBF aValor;
     |SI aValor = ""; aValor = "0"; |FINSI;
     |HAZ GrabaTemporal;

     || 3) CODIGO MUNICIPIO CENTRO DE TRABAJO
     ||_______________________________________________________________

     aPaisCentro = "724";
     aPaisCentro = aPaisCentro % -103;

     aPCD1 = aPaisCentro % 101;    || pais centro digito 1
     aPCD2 = aPaisCentro % 201;    || pais centro digito 2
     aPCD3 = aPaisCentro % 301;    || pais centro digito 3
     aCampo = "codpaisct1"; aValor = aPCD1; |HAZ GrabaTemporal;
     aCampo = "codpaisct2"; aValor = aPCD2; |HAZ GrabaTemporal;
     aCampo = "codpaisct3"; aValor = aPCD3; |HAZ GrabaTemporal;

     aCampo = "municen";
     aValor = #labcentr#6;
     |HAZ GrabaTemporal;

     aCodPos = (("00" + #labcentr#7) % -102) + (("000" + #labcentr#8) % -103);
     |HAZ CodigoMuni;
     aCodMuniC = aCodMuni;

     aCampo = "codmunict1";      || codigo municipio centro 1
     aValor = aCodMuniC % 101;
     |HAZ GrabaTemporal;
     aCampo = "codmunict2";      || codigo municipio centro 1
     aValor = aCodMuniC % 201;
     |HAZ GrabaTemporal;
     aCampo = "codmunict3";      || codigo municipio centro 2
     aValor = aCodMuniC % 301;
     |HAZ GrabaTemporal;
     aCampo = "codmunict4";      || codigo municipio centro 3
     aValor = aCodMuniC % 401;
     |HAZ GrabaTemporal;
     aCampo = "codmunict5";      || codigo municipio centro 4
     aValor = aCodMuniC % 501;
     |HAZ GrabaTemporal;

     aCampo = "Renglon1";      || codigo municipio centro 4
     aValor = #labllaca#6;
     |HAZ GrabaTemporal;
     aCampo = "Renglon2";      || codigo municipio centro 4
     aValor = #labllaca#7;
     |HAZ GrabaTemporal;
|FPRC;

|PROCESO Firma;
     aCampo = "Renglon3";
     aValor = #labllaca#8;
     |HAZ GrabaTemporal;

     aCampo = "Renglon4";
     aValor = #labllaca#9;
     |HAZ GrabaTemporal;

     aCampo = "Renglon5";
     aValor = #labllaca#10;
     |HAZ GrabaTemporal;

     aCampo = "Renglon6";
     aValor = #labllaca#11;
     |HAZ GrabaTemporal;
|FPRC;

|PROCESO lineas;
     |SI swCuenta = 1;
          nTrabajadores = nTrabajadores + 1;
     |SINO;
          nLinea = nLinea + 1;

          nTexto = ((nLinea - 1) * 5) + 13;
          aCampo = nTexto;
          aCampo = "Texto" + aCampo;
          aValor = #labllali#6;
          |HAZ GrabaTemporal;

          nTexto = nTexto + 1;
          aCampo = nTexto;
          aCampo = "Texto" + aCampo;
          aValor = #labllali#7;
          |HAZ GrabaTemporal;

          nTexto = nTexto + 1;
          aCampo = nTexto;
          aCampo = "Texto" + aCampo;
          aValor = #labllali#8;
          |QBF aValor;
          |SI aValor ! ""; |Y aValor ! "01.01.0000";
               aValor = (aValor % 102) + "/" + (aValor % 402) + "/" + (aValor % 704);
               |HAZ GrabaTemporal;
          |FINSI;

          nTexto = nTexto + 1;
          aCampo = nTexto;
          aCampo = "Texto" + aCampo;
          aValor = #labllali#9;
          |QBF aValor;
          |SI aValor ! ""; |Y aValor ! "01.01.0000";
               aValor = (aValor % 102) + "/" + (aValor % 402) + "/" + (aValor % 704);
               |HAZ GrabaTemporal;
          |FINSI;

          nTexto = nTexto + 1;
          aCampo = nTexto;
          aCampo = "Texto" + aCampo;
          aValor = #labllali#10;
          |HAZ GrabaTemporal;

          |SI nLinea = 10;
               nVoyPorTrab = #labllali#5 + 1;
               |ERROR10;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE lineas;
     #labllali#1;
     ;
     #labllaca#0, #labllaca#1, #labllaca#2, #labllaca#3, #labllaca#4, nVoyPorTrab;
     #labllaca#0, #labllaca#1, #labllaca#2, #labllaca#3, #labllaca#4, 99999;
     ;
     NULL, lineas;
|FIN;


|PROCESO trabajadores;
     swCuenta = 0;
     nLinea = 0;
     |BUCLE lineas;
|FPRC;

|PROCESO CargaCampos;
     |HAZ cabecera;
     |HAZ trabajadores;
     |HAZ Firma;
|FPRC;

|PROCESO ImprePDF;
     |PARA nHoja = 1; |SI nHoja [ nTotalHojas; |HACIENDO nHoja = nHoja + 1;
          aAlfa1 = Usuario; |QBT aAlfa1;    aAlfa1 = ("c" + aAlfa1) % 108;
          |NOME_DAT #100 aAlfa1;

          |DELINDEX #pdfimtmp;
          |ABRE #pdfimtmp;         || Contrato Puesta a Disposicion

          |HAZ CargaCampos;

          nCuantos = 1;
          |CIERRA #pdfimtmp;

          aArchivo = "pe-192.pdf";
          |SUB_EJECUTA "pdfgraba";
     |SIGUE;

     |SUB_EJECUTA "pdfimpre";
|FPRC;

|PROCESO Informe;
     nContador = 0;
     nVoyPorTrab = 00001;
     swCuenta = 1;
     nTrabajadores = 0;
     |BUCLE lineas;

     nTotalHojas = nTrabajadores / 10;
     nTotalHojas = (nTotalHojas + 0.49) ! 0
     |HAZ ImprePDF;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;
          |CONFI "    S¿Desea emitir el certificado?";
          |SI FSalida = 0;
               |HAZ Informe;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo20; |TIPO 20;
     |SI FSalida = "OPCION";
          FSalida = "Emisión";
     |SINO;
          ||HAZ Informe;
          enEmpresa = #0#0;
          enCentro = #0#1;
          efFechaIni = #0#2;
          efFechaFin = #0#3;
          enCodLlama = #0#4;
          |SUB_EJECUTA "labllxml";
          |SI nOpcion = 1;
               |HAZ Informe;
          |FINSI;

          |LEE 000#labllaca.=;
          |PINDA #0#labllaca;
     |FINSI;
|FPRC;
