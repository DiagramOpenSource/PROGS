|FICHEROS;
     labconfo #0;
     labempre;
     labtraba;
     labregis;
|FIN;

|VARIABLES;
     aFechaDesde = "";
     aFechaHasta = "";
     aFechaAlta = "";

     fFechaDesde = @;
     fFechaHasta = @;
     fFechaAlta = @;

     &nContratos = 0;
     &aEmpresa = "";

     swImpresion = 0;
     aPassword = "";
|FIN;

|PROCESO labregis;
     aFechaDesde = #0#4;
     aFechaHasta = #0#5;

     aFechaAlta = #labregis#7;

     fFechaDesde = aFechaDesde;
     fFechaHasta = aFechaHasta;
     fFechaAlta = aFechaAlta;

     |SI fFechaDesde [ fFechaAlta; |Y fFechaAlta [ fFechaHasta;
          |SI swImpresion = 0;
               nContratos = nContratos + 1;
          |FINSI;

          |SI swImpresion = 1;
               |DDEFECTO #labempre;
               #labempre#0 = #labregis#1;
               |LEE 000#labempre.=;

               |DDEFECTO #labtraba;
               #labtraba#0 = #labregis#1;
               #labtraba#1 = #labregis#2;
               |LEE 000#labtraba.=;

               aEmpresa = "";
               |SI Impresora = "CrystalReport";
                    aEmpresa = #labempre#0; |QBF aEmpresa; aEmpresa = ("00000" + aEmpresa) % -105;
                    aEmpresa = aEmpresa + " - " + #labempre#2;
               |FINSI;

               |PRINT;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE labregis;
     #labregis#1;
     1, 2, 4;
     000001, #0#0, #0#2, "421";
     999999, #0#1, #0#3, "421";
     ;
     NULL, labregis;
|FIN;


|PROGRAMA;
     |CLS;

     |CUADRO 1218 1565;
     |PINTA 1320, "Introduzca contrase¤a:";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>            ";
          |MENAV "     Permiso denegado.";
          |ACABA;
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
          |IMPRE 0;
          |INFOR "labconfo";

          |ABRE #labtraba;
          |ABRE #labempre;

          swImpresion = 0;
          |BUCLE labregis;

          swImpresion = 1;
          |BUCLE labregis;

          |CIERRA #labtraba;
          |CIERRA #labempre;

          |PIEINF;
          |FININF;
          |FINIMP;
     |FINSI;
|FPRO;
