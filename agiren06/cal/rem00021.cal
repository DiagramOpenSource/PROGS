|FICHEROS;
     reparame #1;
     rem00021 #20;
     rem00038 #38;
     rem00041 #41;
     rem00100 #100;
     rem00102 #102;
     retabla1 #401;
     retabla7 #407;
     rem99999 #666;

     rew00601 #1001,MANTE;
     rew00602 #1002,MANTE;
     rew00603 #1003,MANTE;
     rew99998 #900,MANTE;
     rew99999 #999;
     espejo@  #99;
|FIN;

|VARIABLES;
     &eaExtr = "";

     aPathRenta    = "";
     aDef          = "";
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aEscape       = "";
     aAvance       = "";
     aRetroceso    = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aLong         = "";
     aDescri       = "";
     Comodin       = "";
     Comodin1      = "";
     aTecla        = "";

     nPanta        = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nCampos       = 0;
     nModo         = 0;
     nEntrada      = 0;
     nFactor       = 0;
     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nCampo        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nDLinea       = 0;
     nHLinea       = 0;
     nContenido    = 0;
     nSwContenido  = 0;
     nNume         = 0;
     nAnyoAmor     = 0;
     nError        = 0;
     n73           = 0;
     nFallecido    = 0;

     nCampo15      = 0;
     nCampo16      = 0;
     nCampo17      = 0;
     nCampo20      = 0;
     nCampo27      = 0;
     nImputable    = 0;
     nLineaViv     = 0;

     nDesde        = 0;
     nTecla        = 0;
     nValor        = 0;
     nPorce        = 0;
     nTotal        = 0;
     nTotalDias    = 0;
     nTotalDias2   = 0;
     nCanti1       = 0;
     nCanti2       = 0;
     nCanti3       = 0;
     nCanti4       = 0;
     nCanti5       = 0;
     nDias         = 0;
     nAnyoCompra   = 0;
     nAnyoVenta    = 0;
     nDiferencia   = 0;
     nCoefi        = 0;
     nResta        = 0;
     nAmortiza     = 0;
     nMejoras      = 0;
     nLinea        = 0;
     nDiasHT       = 0;
     nDiasHC       = 0;
     nDiasH1       = 0;
     nDiasH2       = 0;
     nDiasH3       = 0;
     nDiasH4       = 0;
     nTodosDias    = 0;
     nParciDias    = 0;

     fFecha        = @;
     fFecha1       = @;
     fFecha2       = @;
     fFecha3       = @;
     fFechaBue     = @;
     fFechaAdq     = @;
     fFechaTra     = @;
     fFechaLim     = @;

     &enEmpresa    = 0;
     &enLineal     = 0;
     &enModo       = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";
     &eaPatr22     = "";
     &eaPatr23     = "";
|FIN;

|PROCESO Tipo12w98;  |TIPO 12;
|FPRC;

|PROCESO Tipow12;  |TIPO 12;
|FPRC;

|| ************************************************************************
|| PROCESOS DE CONSULTA DE PANTALLAS NORMALES
|| ************************************************************************

|PROCESO AyudaSituacionFm21;  |TIPO 0;
     |C_M #20#14, 1, "S";
     |SI #20#125 > 2;
         |C_M #20#14, 1, "N";  #20#14 = "";  |PINTA #20#14;
     |FINSI;

     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |PUSHV  0501 2380;
     |BLANCO 1019 2080;
     |CUADRO 1019 2080;
     |ATRI I;
     |PINTA 1120, "1 .- Vivienda o plaza de garaje situada en cualquier punto  ";
     |PINTA 1220, "     del territorio espa¤ol, con excepcion del Pais Vasco y ";
     |PINTA 1320, "     Navarra.                                               ";
     |PINTA 1420, "2 .- Vivienda o plaza de garaje situada en el Pais Vasco y  ";
     |PINTA 1520, "     Navarra.                                               ";
     |PINTA 1620, "3 .- Vivienda o plaza de garaje situada en cualquier punto  ";
     |PINTA 1720, "     del territorio espa¤ol, pero sin tener asignada        ";
     |PINTA 1820, "     referencia catastral.                                  ";
     |PINTA 1920, "4 .- Vivienda o plaza de garaje situada en el extranjero.   ";
     |ATRI i;

     |LEETECLA aTecla;
     |POPV;
     |ERROR;
|FPRC;

|PROCESO Catastral;
     aAlfa = #20#14;  |QBF aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     aAlfa = aAlfa % 0;
     |SI aAlfa ! "20";
         |MENAV "0000 La longitud de la Referencia Catastral deberia ser de 20 Caracteres.";
     |FINSI;
|FPRC;

|PROCESO Compensacion;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     #1001Campo = #1001#60;
     #1001#54   = "P";

     |PINTA #1001Campo;
     |PINTA #1001#54;
|FPRC;

|PROCESO Automatico;
     nValor = #20#31 + #20#34;

     |C_M #1001#37, 1, "S";
     |C_M #1001#39, 1, "S";
     |C_M #1001#41, 1, "S";
     |C_M #1001#43, 1, "S";
     |C_M #1001#46, 1, "S";
     |C_M #1001#48, 1, "S";
     |C_M #1001#49, 1, "S";
     |C_M #1001#50, 1, "S";
     |C_M #1001#52, 1, "S";
     |C_M #1001#54, 1, "S";
     |C_M #1001#56, 1, "S";
     |C_M #1001#59, 1, "S";

     |SI nTotalDias = nValor; |Y nTotalDias = 365;
         |C_M #1001#37, 1, "N"; #1001#37 = "A";
         |C_M #1001#39, 1, "N"; #1001#39 = "A";
         |C_M #1001#41, 1, "N"; #1001#41 = "A";
         |C_M #1001#43, 1, "N"; #1001#43 = "A";
         |C_M #1001#46, 1, "N"; #1001#46 = "A";
         |C_M #1001#48, 1, "N"; #1001#48 = "A";
         |C_M #1001#49, 1, "N"; #1001#49 = "A";
         |C_M #1001#50, 1, "N"; #1001#50 = "A";
         |C_M #1001#52, 1, "N"; #1001#52 = "A";
         |C_M #1001#54, 1, "N"; #1001#54 = "A";
         |C_M #1001#56, 1, "N"; #1001#56 = "A";
         |C_M #1001#59, 1, "N"; #1001#59 = "A";
     |SINO;
         |SI #1001#37 = " ";  #1001#37 = "P";  |FINSI;
         |SI #1001#39 = " ";  #1001#39 = "P";  |FINSI;
         |SI #1001#41 = " ";  #1001#41 = "P";  |FINSI;
         |SI #1001#43 = " ";  #1001#43 = "P";  |FINSI;
         |SI #1001#46 = " ";  #1001#46 = "P";  |FINSI;
         |SI #1001#48 = " ";  #1001#48 = "P";  |FINSI;
         |SI #1001#49 = " ";  #1001#49 = "P";  |FINSI;
         |SI #1001#50 = " ";  #1001#50 = "P";  |FINSI;
         |SI #1001#52 = " ";  #1001#52 = "P";  |FINSI;
         |SI #1001#54 = " ";  #1001#54 = "P";  |FINSI;
         |SI #1001#56 = " ";  #1001#56 = "P";  |FINSI;
         |SI #1001#59 = " ";  #1001#59 = "P";  |FINSI;
     |FINSI;

     |PINTA #1001#37;
     |PINTA #1001#39;
     |PINTA #1001#41;
     |PINTA #1001#43;
     |PINTA #1001#46;
     |PINTA #1001#48;
     |PINTA #1001#49;
     |PINTA #1001#50;
     |PINTA #1001#52;
     |PINTA #1001#54;
     |PINTA #1001#56;
     |PINTA #1001#59;
|FPRC;

|PROCESO PonCobrado;
     |SI #1002#108 = 0;
         #1002#108 = #1002Campo;
         |PINTA #1002#108;
     |FINSI;
|FPRC;

|PROCESO VentanaReinv;  |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 1939 2380;
     |BLANCO 2040 2279;
     |PINTA 2040, " Reinversion Ejercicio .....: ";
     |PINTA 2140, " Reinv. 2 A¤os Siguientes ..: ";
     |PINTA 2240, " Capital Pdte.Amortizacion .: ";

     |C_P #1002#109, 1, 2070;  |C_V #1002#109, 1, "S";  |C_M #1002#109, 1, "S";
     |C_P #1002#110, 1, 2170;  |C_V #1002#110, 1, "S";  |C_M #1002#110, 1, "S";
     |C_P #1002#111, 1, 2270;  |C_V #1002#111, 1, "S";  |C_M #1002#111, 1, "S";

     |PINTA #1002#109;
     |PINTA #1002#110;
     |PINTA #1002#111;

     |ET C1002;
         |ENCAMPO #109#1002;
     |ET C1003;
         |ENCAMPO #110#1002;
         |SI FSalida = 2;  |VETE C1002;  |FINSI;

         |ENCAMPO #111#1002;
         |SI FSalida = 2;  |VETE C1003;  |FINSI;

     #1002#107 = #1002#109 + #1002#110;

     |C_V #1002#109, 1, "N";  |C_M #1002#109, 1, "N";
     |C_V #1002#109, 1, "N";  |C_M #1002#109, 1, "N";

     |POPV;
     |PINTA #1002#107;
|FPRC;

|PROCESO Tipo7C18;  |TIPO 7;
     |PUSHV 0501 2380;
     |BLANCO 1335 2076;
     |CUADRO 1335 2076;

     |ATRI R;
     |PINTA 1436, "     RECORDATORIO PARA ALQUILERES       ";
     |PINTA 1536, "----------------------------------------";
     |ATRI r;

     |ATRI I;
     |PINTA 1636, " U - Urbano alquilado (reduccion 50%)   ";
     |PINTA 1736, " L - Local alquilado  (no hay reduccion)";
     |PINTA 1836, " O - Otro urbano      (no hay reduccion)";
     |ATRI i;
|FPRC;

|PROCESO Tipo0C18;  |TIPO 0;
     |POPV;

     |PINTA #20#18;

     |C_M #20#19, 1, "S";
     |C_M #20#20, 1, "S";
     |SI #20#18 ! "R";
         |C_M #20#19, 1, "N";  #20#19 = 0;  |PINTA #20#19;
         |C_M #20#20, 1, "N";  #20#20 = 0;  |PINTA #20#20;
     |FINSI;
|FPRC;

|PROCESO Totalw601;
     nCanti1 = #1001#15 - #1001#28;
     nPorce  = 80;
     |SI nCanti1 ! 0;  nPorce = (nCanti1 * 100) / #1001#15;  |FINSI;

     |SI #1#16 = "N";
         ||nCanti2 = (#1001#26 % nPorce) + #1001#29;
         nCanti2 = (#1001#26 + #1001#29) % nPorce;
     |SINO;
         nCanti2 = #1001#26 % nPorce;
     |FINSI;

                            nCanti4 = nCanti2;
     |SI nCanti4 < nCanti1; nCanti4 = nCanti1; |FINSI;

     |SI #1001#113 ! 0;
         #1001#114 = #1001#112 % #1001#113;
     |FINSI;

     |SI #1001#58 ! 0;
         #1001#115  = nCanti4 % #1001#58;

          #1001#59  = "P";
          nDias = #1001#31 + #1001#34;
          #1001#115 = #1001#115 * (nDias / 365);
     |FINSI;

     #1001#60 = #1001#114 + #1001#115;

     |SI #1001#60 < 0;  #1001#60 = 0;  |FINSI;

     #1001#122 = 0;
     #1001#123 = 0;
     #1001#61  = 0;

     nValor = #1001#38;
     |SI #1001#37 = "A"; nValor = #1001#38 * (nDias / 365);  |FINSI;
     #1001#122 = #1001#122 + nValor;

     nValor = #1001#40;
     |SI #1001#39 = "A"; nValor = #1001#40 * (nDias / 365);  |FINSI;
     #1001#122 = #1001#122 + nValor;

     nValor = #1001#42;
     |SI #1001#41 = "A"; nValor = #1001#42 * (nDias / 365);  |FINSI;
     #1001#122 = #1001#122 + nValor;

     nValor = #1001#44;
     |SI #1001#43 = "A"; nValor = #1001#44 * (nDias / 365);  |FINSI;
     #1001#122 = #1001#122 + nValor;

     nValor = #1001#22;
     |SI #1001#48 = "A"; nValor = #1001#22 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#21;
     |SI #1001#49 = "A"; nValor = #1001#21 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#51;
     |SI #1001#50 = "A"; nValor = #1001#51 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#53;
     |SI #1001#52 = "A"; nValor = #1001#53 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#55;
     |SI #1001#54 = "A"; nValor = #1001#55 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#57;
     |SI #1001#56 = "A"; nValor = #1001#57 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     nValor = #1001#60;
     |SI #1001#59 = "A"; nValor = #1001#60 * (nDias / 365);  |FINSI;
     #1001#123 = #1001#123 + nValor;

     #1001#61  = #1001#122 - #1001#123;

     |PINTA #1001#114;
     |PINTA #1001#115;
     |PINTA #1001#59;
     |PINTA #1001#60;
     |PINTA #1001#61;
     |PINTA #1001#122;
     |PINTA #1001#123;
|FPRC;

|PROCESO TraeCoefi;
     |ABRE #407;
     #407#0 = 2006;
     #407#1 = nAnyoAmor;
     |LEE 040#407=;
     |SI FSalida ! 0;  |DDEFECTO #407;  |FINSI;
     |CIERRA #407;
|FPRC;

|PROCESO Amortiza;
     fFecha   = "30.12.1994";
     nResta   = (fFecha - fFechaBue) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1994;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "31.12.1994";  fFecha2 = "31.12.1994";  |FINSI;

     fFecha1  = "31.12.1995";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1995;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.1996";  fFecha2 = "01.01.1996";  |FINSI;

     fFecha1  = "31.12.1996";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1996;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.1997";  fFecha2 = "01.01.1997";  |FINSI;

     fFecha1  = "31.12.1997";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1997;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.1998";  fFecha2 = "01.01.1998";  |FINSI;

     fFecha1  = "31.12.1998";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1998;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.1999";  fFecha2 = "01.01.1999";  |FINSI;

     fFecha1  = "31.12.1999";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 1999;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2000";  fFecha2 = "01.01.2000";  |FINSI;

     fFecha1  = "31.12.2000";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2000;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2001";  fFecha2 = "01.01.2001";  |FINSI;

     fFecha1  = "31.12.2001";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2001;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2002";  fFecha2 = "01.01.2002";  |FINSI;

     fFecha1  = "31.12.2002";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2002;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2003";  fFecha2 = "01.01.2003";  |FINSI;

     fFecha1  = "31.12.2003";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2003;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2004";  fFecha2 = "01.01.2004";  |FINSI;

     fFecha1  = "31.12.2004";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2004;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);

     fFecha2 = fFechaBue;
     |SI fFechaBue < "01.01.2005";  fFecha2 = "01.01.2005";  |FINSI;

     fFecha1  = "31.12.2005";
     nResta   = (fFecha1 - fFecha2) + 1;
     |SI nResta < 0;
         nPorce = 0;
     |SINO;
         nAnyoAmor = 2005;   |HAZ TraeCoefi;
         nPorce    = #407#2 * (nResta / 365);
     |FINSI;

     nAmortiza    = nAmortiza + ((nValor % #1002#65) * nPorce);
|FPRC;

|PROCESO Coeficiente;
     aAlfa1      = fFecha1 % -104;
     aAlfa2      = fFecha2 % -104;
     nAnyoCompra = aAlfa1;
     ||nDiferencia = (fFecha2 - fFecha1) + 1;
     nDiferencia = fFecha2 - fFecha1;

     |SI fFecha1 < "31.12.1994";  nAnyoCompra = 1994;  |FINSI;
     |SI fFecha1 = "31.12.1994";  nAnyoCompra = 1995;  |FINSI;

     |ABRE #407;
     |SI eaExtr = "S";
        #407#0 = aAlfa2;
     |SINO;
        #407#0 = 2006;
     |FINSI;
     #407#1 = nAnyoCompra;
     |LEE 040#407=;
     |SI FSalida ! 0;  |DDEFECTO #407;  |FINSI;
     |CIERRA #407;

     nCoefi = #407#2;

     |SI nDiferencia [ 365;
         nCoefi = 1;
     |FINSI;

     nAnyoCompra = aAlfa1;
|FPRC;

|PROCESO nContenido;
     nSwContenido = 0;
     nContenido = Contenido;
     |SI nContenido ! #1002Campo;
         nSwContenido = 1;
     |FINSI;
|FPRC;

|PROCESO Totalw602;
     |SI Campo = 76;  |ACABA;  |FINSI;

     nCampo  = Campo;
     nValor  = #1002#26;
     |SI #1#16 = "N";
         nValor  = #1002#26 + #1002#29;
     |FINSI;

     fFecha1 = #1002#25;
     fFecha2 = #1002#68;
     |HAZ Coeficiente;
     #1002#63 = nCoefi;

     #1002#64 = nValor * #1002#63;

|| ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  Venta

     nValor    = #1002#26 - #1002#29 - #1002#28;
     |SI #1#16 = "N";
         nValor    = #1002#26 - #1002#28;
     |FINSI;

     nAmortiza = 0;
     fFechaBue = #1002#25;
     |HAZ Amortiza;
     |SI #1002#66 = 0;  |O nSwContenido = 1;
         #1002#66  = nAmortiza;
     |FINSI;

     nValor    = #1002#26;
     |SI #1#16 = "N";
         nValor    = #1002#26 + #1002#29;
     |FINSI;

     fFecha1   = #1002#25;
     fFecha2   = #1002#68;
     |HAZ Coeficiente;
     #1002#63  = nCoefi;
     #1002#64  = nValor * #1002#63;


|| ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  Mejora 1

     nValor    = #1002#79 - #1002#80;
     nAmortiza = 0;
     fFechaBue = #1002#77;
     |HAZ Amortiza;
     |SI #1002#81 = 0;  |O nSwContenido = 1;
         #1002#81  = nAmortiza;
     |FINSI;

     nValor    = #1002#79;
     fFecha1   = #1002#77
     fFecha2   = #1002#68;
     |HAZ Coeficiente;
     #1002#82  = (nValor * nCoefi) - #1002#81;

|| ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  Mejora 2

     nValor    = #1002#85 - #1002#86;
     nAmortiza = 0;
     fFechaBue = #1002#83;
     |HAZ Amortiza;
     |SI #1002#87 = 0;  |O nSwContenido = 1;
         #1002#87  = nAmortiza;
     |FINSI;

     nValor    = #1002#85;
     fFecha1   = #1002#83
     fFecha2   = #1002#68;
     |HAZ Coeficiente;
     #1002#88  = (nValor * nCoefi) - #1002#87;

|| ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  Mejora 3

     nValor    = #1002#91 - #1002#92;
     nAmortiza = 0;
     fFechaBue = #1002#89;
     |HAZ Amortiza;
     |SI #1002#93 = 0;  |O nSwContenido = 1;
         #1002#93  = nAmortiza;
     |FINSI;

     nValor    = #1002#91;
     fFecha1   = #1002#89
     fFecha2   = #1002#68;
     |HAZ Coeficiente;
     #1002#94  = (nValor * nCoefi) - #1002#93;

     #1002#67    = #1002#64 - #1002#66;
     nMejoras    = #1002#82 + #1002#88 + #1002#94;
     #1002#71    = (#1002#69 - #1002#70) * (#1002#67 / (#1002#67 + nMejoras));
     aAlfa1      = #1002#25 % -104;
     aAlfa2      = #1002#25 % 0105;
     nAnyoCompra = aAlfa1;

     |SI aAlfa2 = "31.12";   nAnyoCompra = nAnyoCompra + 1;  |FINSI;

     nValor      = #1002#71 - #1002#67;
     #1002#72    = 0;
     |SI nValor  ] 0;
         |C_M #1002#74,  1, "S";
         |C_M #1002#75,  1, "S";
         |C_M #1002#108, 1, "S";

         #1002#72 = (1996 - nAnyoCompra) + 1;

         |SI #1002#72 < 0;  #1002#72 = 0;  |FINSI;

         nCoefi      = 0;
         |SI #1002#72 ] 3;
             nCoefi = (#1002#72 - 2) * 11.11;
             |SI nCoefi > 99; nCoefi = 100; |FINSI;

             nCanti1    = #1002#71 - #1002#67;
             nCanti2    = 0;
             fFechaLim  = "20.01.2006";
             |SI #1002#68 > fFechaLim;
                 nTodosDias = (#1002#68  - #1002#25);
                 nParciDias = (fFechaLim - #1002#25);

                 nCanti1    = (((#1002#71 - #1002#67) / nTodosDias) * nParciDias) ! 2;
                 nCanti2    = (#1002#71 - #1002#67) - nCanti1;
             |FINSI;

             #1002#73 = (nCanti1 % (100 - nCoefi)) + nCanti2;
         |SINO;
             #1002#73 = #1002#71 - #1002#67;
         |FINSI;

         #1002#74 = (#1002#73 * #1002#107) / (#1002#69 - #1002#111);
         |SI #1002#74 > #1002#73;  #1002#74 = #1002#73;  |FINSI;

         #1002#75 = #1002#73 - #1002#74;
         #1002#76 = (#1002#75 * #1002#108) / #1002#69;
         |SI #1002#76 > #1002#73;  #1002#76 = #1002#73;  |FINSI;
         |SI #1002#76 > #1002#75;  #1002#76 = #1002#75;  |FINSI;
     |SINO;
         |C_M #1002#74,  1, "N";
         |C_M #1002#75,  1, "N";
         |C_M #1002#108, 1, "N";
         n73       = #1002#73;
         #1002#73  = nValor;
         #1002#74  = 0;
         #1002#75  = 0;
         #1002#107 = 0;
         #1002#108 = 0;
         #1002#75  = 0;
         |SI #1002#76 = 0;  |O #1002#73 ! n73;
             #1002#76  = #1002#73;
         |FINSI;
     |FINSI;

     |PINTA #1002#63;
     |PINTA #1002#64;
     |PINTA #1002#66;
     |PINTA #1002#67;
     |PINTA #1002#71;
     |PINTA #1002#72;
     |PINTA #1002#73;
     |PINTA #1002#74;
     |PINTA #1002#75;
     |PINTA #1002#76;
     |PINTA #1002#81;
     |PINTA #1002#82;
     |PINTA #1002#87;
     |PINTA #1002#88;
     |PINTA #1002#93;
     |PINTA #1002#94;

     nSwContenido = 0;
|FPRC;

|PROCESO Mejoras;
     nCampo1 = nCampo + 1;
     nCampo2 = nCampo + 2;
     nCampo3 = nCampo + 3;
     nCampo4 = nCampo + 4;
     nCampo5 = nCampo + 5;

     |C_M #1002nCampo1, 1, "S";
     |C_M #1002nCampo2, 1, "S";
     |C_M #1002nCampo3, 1, "S";

     |SI #1002Campo = "01.01.0000";
         |C_M #1002nCampo1, 1, "N";  #1002nCampo1 = "";  |PINTA #1002nCampo1;
         |C_M #1002nCampo2, 1, "N";  #1002nCampo2 = 0;   |PINTA #1002nCampo2;
         |C_M #1002nCampo3, 1, "N";  #1002nCampo3 = 0;   |PINTA #1002nCampo3;
                                     #1002nCampo4 = 0;   |PINTA #1002nCampo4;
                                     #1002nCampo5 = 0;   |PINTA #1002nCampo5;
     |FINSI;
|FPRC;

|PROCESO nContenidoDias;
     |SI Contenido ! #20Campo;
         #20#30 = 0;  |PINTA #20#30;
         #20#31 = 0;  |PINTA #20#31;
         #20#32 = 0;  |PINTA #20#32;
         #20#33 = 0;  |PINTA #20#33;
         #20#34 = 0;  |PINTA #20#34;
         #20#35 = 0;  |PINTA #20#36;
     |FINSI;
|FPRC;

|PROCESO Tipo0C25Fm21;
     |SI #20#24 ! "S";           |ACABA;  |FINSI;
     |SI #20#25 ] "31.12.1994";  |ACABA;  |FINSI;

     |SI #20#2 = "GANANCIAL ";  |O #20#2 = "VARIOS    ";
         nFallecido = 0;

         |ABRE #999;
         |SELECT #2#999;
         #999#1 = "TITULAR   ";
         |LEE 000#999=;
         |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;
         |SI #999#5 = "S";  nFallecido = 1;  |FINSI;

         |SELECT #2#999;
         #999#1 = "CONYUGE   ";
         |LEE 000#999=;
         |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;
         |SI #999#5 = "S";  nFallecido = 1;  |FINSI;

         |SELECT #1#999;
         |CIERRA #999;

         |SI nFallecido = 1;
             |MENAV "0000 Venta con un fallecido con fecha de adquisicion inferior a 31.12.1994, por favor introduzcalos individuales";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Venta;
     |C_M #20#68, 1, "S";
     |SI #20#24 = "N";
         #20#68 = "01.01.0000";
         |C_M #20#68, 1, "N";
         |PINTA #20#68;
     |SINO;
         |SI #20#68 = "01.01.0000";
             #20#68 = "01.01.2006";
         |FINSI;
     |FINSI;

     |PINTA #20#68;
|FPRC;

|PROCESO Inversion;
     |SI FSalida = 10;
         |ABRE #999;
         |SELECT #2#999;
         #999#1 = #20#2;
         |LEE 000#999=;
         |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;
         |SELECT #1#999;
         |CIERRA #999;

         |C_M #1003#119, 1, "N";
         |C_M #1003#120, 1, "N";
         |C_M #1003#121, 1, "N";

         |SI #999#7 = 13;  |C_M #1003#119, 1, "S";  |FINSI;

         |SI #999#7 = 9;
             |SI #20#2 ! "GANANCIAL ";
                 |C_M #1003#120, 1, "S";
             |SINO;
                 |C_M #1003#120, 1, "S";
                 |C_M #1003#121, 1, "S";
             |FINSI;
         |FINSI;

         |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
               #1003nCampos = #20nCampos;
         |SIGUE;

         |PUSHV 0501 2380;
         |PINPA #0#1003;
         |PINDA #0#1003;
         |ENDATOS #1#1003;
         |SI FSalida = 0;
             |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                   #20nCampos = #1003nCampos;
             |SIGUE;
         |FINSI;

         |SI #999#7 = 9;
             |SI #20#2 ! "GANANCIAL ";
                 |SI #20#120 = " ";
                     |MENAV "0000 No ha informado del tipo de Regimen a Aplicar en las Deducciones de Vivienda.";
                 |FINSI;
             |SINO;
                 |SI #20#120 = " ";  |O #20#121 = " ";
                     |MENAV "0000 No ha informado del tipo de Regimen a Aplicar en las Deducciones de Vivienda.";
                 |FINSI;
             |FINSI;
         |FINSI;

         |POPV;

         |PTEC 809;
     |FINSI;

     #20#23 = #20#95 + #20#96 + #20#97 + #20#98 + #20#99 + #20#100 + #20#101 + #20#102;
     |PINTA #20#23;
|FPRC;

|PROCESO DatosAdicionales;  |TIPO 7;
     |C_M #20#124, 1, "S";

     |SI #20#30 = 0;
          |C_M #20#124, 1, "N";  #20#124 = "N";  |PINTA #20#124;
     |FINSI;

     |SI #20#104 ! "P";  |Y #20#104 ! "U";
          |C_M #20#124, 1, "N";  #20#124 = "N";  |PINTA #20#124;
     |FINSI;
|FPRC;

|PROCESO TotalDias;  |TIPO 7;
     |ABRE #100;
     #100#0 = #20#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     nTotalDias  = 0;
     nTotalDias2 = 0;

     |SI #100#92 ! "01.01.0000"; |Y #100#91 = "T";  |Y #20#2 = "TITULAR   ";
         fFecha = #100#92;
         |SI #20#24 = "N";  |Y #20#25 [ "01.01.2006";
             fFecha     = #100#92;
             fFecha1    = "01.01.2006";
             nTotalDias = (fFecha - fFecha1) + 1;
         |SINO;
             |SI #20#24 = "S";
                 |SI #20#25 < "01.01.2006";
                     fFecha = "01.01.2006";
                     |SI #20#68 < #100#92;
                         nTotalDias = (#20#68 - fFecha) + 1;
                     |SINO;
                         nTotalDias = (#100#92 - fFecha) + 1;
                     |FINSI;
                 |SINO;
                     |SI #20#68 < #100#92;
                         nTotalDias = (#20#68 - #20#25) + 1;
                     |SINO;
                         nTotalDias = (#100#92 - #20#25) + 1;
                      |FINSI;
                 |FINSI;
             |SINO;
                 fFecha     = #100#92;
                 nTotalDias = (fFecha - #20#25) + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #100#92 ! "01.01.0000"; |Y #100#91 = "C";  |Y #20#2 = "CONYUGE   ";
         fFecha = #100#92;
         |SI #20#24 = "N";  |Y #20#25 [ "01.01.2006";
             fFecha     = #100#92;
             fFecha1    = "01.01.2006";
             nTotalDias = (fFecha - fFecha1) + 1;
         |SINO;
             |SI #20#24 = "S";
                 |SI #20#25 < "01.01.2006";
                     fFecha = "01.01.2006";
                     |SI #20#68 < #100#92;
                         nTotalDias = (#20#68 - fFecha) + 1;
                     |SINO;
                         nTotalDias = (#100#92 - fFecha) + 1;
                     |FINSI;
                 |SINO;
                     |SI #20#68 < #100#92;
                         nTotalDias = (#20#68 - #20#25) + 1;
                     |SINO;
                         nTotalDias = (#100#92 - #20#25) + 1;
                      |FINSI;
                 |FINSI;
             |SINO;
                 fFecha     = #100#92;
                 nTotalDias = (fFecha - #20#25) + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #100#92 ! "01.01.0000";
         |SI #20#2 = "GANANCIAL ";  |O #20#2 = "VARIOS    ";
             fFecha = #100#92;
             |SI #20#24 = "N";  |Y #20#25 [ "01.01.2006";
                 fFecha     = #100#92;
                 fFecha1    = "01.01.2006";
                 nTotalDias = (fFecha - fFecha1) + 1;

                 fFecha      = #100#92;
                 fFecha1     = "31.12.2006";
                 nTotalDias2 = (fFecha1 - (fFecha + 1)) + 1;
             |SINO;
                 |SI #20#24 = "S";
                     |SI #20#25 < "01.01.2006";
                         |SI #20#68 < #100#92;
                             fFecha = "01.01.2006";
                             nTotalDias = (#20#68 - fFecha) + 1;
                         |SINO;
                             fFecha      = "01.01.2006";
                             nTotalDias  = (#100#92 - fFecha) + 1;
                             nTotalDias2 = (#20#68 - (#100#92 + 1) + 1);
                         |FINSI;
                     |SINO;
                         |SI #20#25 < #100#92;
                             |SI #20#68 > #100#92;
                                 nTotalDias  = (#100#92 - #20#25) + 1;
                                 nTotalDias2 = (#20#68 - (#100#92 + 1)) + 1;
                             |SINO;
                                 nTotalDias = (#20#68 - #20#25) + 1;
                             |FINSI;
                         |SINO;
                              nTotalDias2 = (#20#68 - #20#25) + 1;
                         |FINSI;
                     |FINSI;
                 |SINO;
                     |SI #20#25 < #100#92;
                         fFecha      = #100#92;
                         nTotalDias  = (fFecha - #20#25) + 1;
                         fFecha      = "31.12.2006";
                         nTotalDias2 = (fFecha - (#100#92 + 1)) + 1;
                     |SINO;
                         fFecha      = "31.12.2006";
                         nTotalDias2 = (fFecha - #20#25) + 1;
                     |FINSI;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTotalDias = 0;  |Y nTotalDias2 = 0;
         |SI #20#24 = "N";  |Y #20#25 [ "01.01.2006";
             nTotalDias = 365;
         |SINO;
             |SI #20#24 = "S";
                ||SI PARAMETRO = "Extranjeros";
                |SI eaExtr = "S";
                    Comodin  = #20#68; |QBF Comodin;
                    Comodin1 = #20#25; |QBF Comodin;
                    |SI Comodin ! Comodin1;
                       Comodin = "01.01." + (Comodin % -104);
                       fFecha = Comodin;
                    |SINO;
                       fFecha = #20#25;
                    |FINSI;
                    nTotalDias = (#20#68 - fFecha) + 1;
                |SINO;
                    |SI #20#25 < "01.01.2006";
                       fFecha = "01.01.2006";
                       nTotalDias = (#20#68 - fFecha) + 1;
                    |SINO;
                       nTotalDias = (#20#68 - #20#25) + 1;
                    |FINSI;
                 |FINSI;
             |SINO;
                 ||SI PARAMETRO = "Extranjeros";
                 |SI eaExtr = "S";
                    Comodin = #20#25; |QBF Comodin;
                    Comodin = "31.12." + (Comodin % -104);
                    fFecha = Comodin;
                 |SINO;
                    fFecha = "31.12.2006";
                 |FINSI;
                 nTotalDias = (fFecha - #20#25) + 1;
             |FINSI;
         |FINSI;
     |FINSI;

     nValor = #20#30 + #20#31 + #20#32 + #20#33 + #20#34 + #20#35;
     |SI nValor = 0;
         |SI #20#18 ! "S";
             #20#30 = nTotalDias;
             #20#33 = nTotalDias2;
         |SINO;
             #20#32 = nTotalDias;
             #20#35 = nTotalDias2;
         |FINSI;
         |PINTA #20#30;
         |PINTA #20#32;
         |PINTA #20#33;
         |PINTA #20#35;
     |FINSI;

     |SI nTotalDias2 = 0;
         |C_M #20#33, 1, "N";  #20#33 = 0;  |PINTA #20#33;
         |C_M #20#34, 1, "N";  #20#34 = 0;  |PINTA #20#34;
         |C_M #20#35, 1, "N";  #20#35 = 0;  |PINTA #20#35;
     |FINSI;
|FPRC;

|PROCESO Dias;
     nValor = #20#30 + #20#31 + #20#32 + #20#33 + #20#34 + #20#35;
     nTotal = nTotalDias + nTotalDias2;
     |SI nValor > nTotal; |Y #20#104 ! "M";
         aAlfa = "    Excedidos el numeros de dias, Total de dias = " + nTotal;

         |MENAV aAlfa;

         |SI #20#30 ! 0;  #20#30 = nTotal;  #20#31 = 0;  #20#32 = 0;  |FINSI;
         |SI #20#31 ! 0;  #20#31 = nTotal;  #20#30 = 0;  #20#32 = 0;  |FINSI;
         |SI #20#32 ! 0;  #20#32 = nTotal;  #20#30 = 0;  #20#31 = 0;  |FINSI;
         |SI #20#33 ! 0;  #20#33 = nTotal;  #20#34 = 0;  #20#35 = 0;  |FINSI;
         |SI #20#34 ! 0;  #20#34 = nTotal;  #20#33 = 0;  #20#35 = 0;  |FINSI;
         |SI #20#35 ! 0;  #20#35 = nTotal;  #20#33 = 0;  #20#34 = 0;  |FINSI;

         |PINTA #20#30;
         |PINTA #20#31;
         |PINTA #20#32;
         |PINTA #20#33;
         |PINTA #20#34;
         |PINTA #20#35;

         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo7C128;  |TIPO 7;
     |C_M #20#128, 1, "S";
     |SI #20#32 = 0;  |Y #20#35 = 0;
         #20#128 = "D";  |PINTA #20#128;
         |C_M #20#128, 1, "N";
     |FINSI;
|FPRC;

|PROCESO Tipo0C128;  |TIPO 0;
     nDias = #20#30 + #20#31 + #20#33 + #20#34;
     |SI #20#128 = "A";  |Y #20#3 ! "R";  |Y nDias = 0;
         |MENAV "0000 ATENCION un bien afectos a actidades solo puede ser el tipo de calculo <R> Renta";
         |MENAV "0000 Se ha cambiando automaticamente a <R>, introduzca manualmente el bien en patrimonio.";
         #20#3 = "R";   |PINTA #20#3;
     |FINSI;
|FPRC;

|PROCESO SonLosDias;  |TIPO 7;
     nValor = #20#30 + #20#31 + #20#33 + #20#34;
     |SI nValor = 0;  |Y #20#128 = "P";
         |ACABA;
     |FINSI;

     nValor = #20#30 + #20#31 + #20#32 + #20#33 + #20#34 + #20#35;
     nTotal = nTotalDias + nTotalDias2;
     |SI nValor ! nTotal; |Y #20#104 ! "M";
         aAlfa = "     Numeros de dias incompletos deben ser " + nTotal;
         |MENAV aAlfa;
         |PTEC 808;
     |FINSI;
|FPRC;

|PROCESO VTerreno;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     nValor = #20#15;
     |SI #20#103 ! 0;
         nPorce = 100 - ((#20#103 / #20#15) * 100);

         #20#28 = nValor % nPorce;
     |SINO;

         #20#28 = nValor % #1#14;
     |FINSI;

     |PINTA #20#28;
|FPRC;

|PROCESO Usufructuario;
     |C_M #20#16, 1, "S";
     |SI #20#104 ! "N";
         |C_M #20#16, 1, "N";  #20#16 = 0;  |PINTA #20#16;
     |FINSI;
|FPRC;

|PROCESO Varios;  |TIPO 0;
     |SI #20#2 ! "VARIOS    ";
         #20#5  = 0;
         #20#6  = 0;
         #20#7  = 0;
         #20#8  = 0;
         #20#9  = 0;
         #20#10 = 0;
         |ACABA;
     |FINSI;

     |C_M #900#0,  1, "N";
     |C_M #900#1,  1, "N";
     |C_M #900#2,  1, "N";
     |C_M #900#3,  1, "N";
     |C_M #900#4,  1, "N";
     |C_M #900#5,  1, "N";

     aAlfa = eaSwVarios;
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPosi = (100 * nCaracter) + 1;
           aAlfa1 = aAlfa % nPosi;
           |SI aAlfa1 = "T";  |C_M #900#0,  1, "S";  |FINSI;
           |SI aAlfa1 = "C";  |C_M #900#1,  1, "S";  |FINSI;
           |SI aAlfa1 = "1";  |C_M #900#2,  1, "S";  |FINSI;
           |SI aAlfa1 = "2";  |C_M #900#3,  1, "S";  |FINSI;
           |SI aAlfa1 = "3";  |C_M #900#4,  1, "S";  |FINSI;
           |SI aAlfa1 = "4";  |C_M #900#5,  1, "S";  |FINSI;
     |SIGUE;

     #900#0 = #20#5;
     #900#1 = #20#6;
     #900#2 = #20#7;
     #900#3 = #20#8;
     #900#4 = #20#9;
     #900#5 = #20#10;

     |PUSHV 0501 2380;

     |PINPA #0#900;
     |PINDA #0#900;
     |ENDATOS #1#900;
     |SI FSalida = 0;
         #20#5  = #900#0;
         #20#6  = #900#1;
         #20#7  = #900#2;
         #20#8  = #900#3;
         #20#9  = #900#4;
         #20#10 = #900#5;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO Totalm20;
|FPRC;

|RUTINA ClaveBaja20;
     #20#0 = enEmpresa;
     #20#1 = nDLinea;
|FRUT;

|RUTINA ClaveAlta20;
     #20#0 = enEmpresa;
     #20#1 = nHLinea;
|FRUT;

|PROCESO PonDeclarante;  |TIPO 7;
     eaDeclarante = #20#2;
     enComunes    = 1;
     |HAZ SacaDeclarantes;
     #20#2 = eaDeclarante;
     |PINTA #20#2;
|FPRC;

|PROCESO Fallece;  |TIPO 7;
     |SI eaFallece = "S";
         |C_M #20#4,  1, "S";
         |C_M #20#33, 1, "S";
         |C_M #20#34, 1, "S";
         |C_M #20#35, 1, "S";
     |SINO;
         |C_M #20#4,  1, "N";  #20#4  = 0;  |PINTA #20#4;
         |C_M #20#33, 1, "N";  #20#33 = 0;  |PINTA #20#33;
         |C_M #20#34, 1, "N";  #20#34 = 0;  |PINTA #20#34;
         |C_M #20#35, 1, "N";  #20#35 = 0;  |PINTA #20#35;
     |FINSI;
|FPRC;

|PROCESO Total38;
     nValor = #38#15 - #38#16;
     |SI nValor < 0;
         #38#17 = -nValor;
         #38#18 = -nImputable;
         |SI #38#18 = 0;  #38#18 = #38#17;  |FINSI;
     |SINO;
         #38#19 = nValor;
         #38#21 = #38#19 - #38#20;
         #38#22 = nImputable;
         |SI #38#20 > #38#19;
             #38#20 = #38#19;
             #38#21 = 0;
             #38#22 = 0;
         |FINSI;

         |SI #38#22 = 0;  #38#22 = #38#21;  |FINSI;
      |FINSI;
|FPRC;

|PROCESO El38;
     #38#0 = #20#0;
     #38#1 = 99;
     |LEE 040#38];
     |SI FSalida = 0;
         |LEE 040#38a;
     |SINO;
         |LEE 040#38u;
     |FINSI;

     |SI FSalida = 0; |Y #38#0 = #20#0;
         nLinea = #38#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #38;
     #38#0  = #20#0;
     #38#1  = nLinea;
     |PARA nCampo = 2;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           #38nCampo = #20nCampo;
     |SIGUE;
     #38#3  = "R";
     |SI #20#3 = "X";  #38#3 = "X";  |FINSI;
     #38#11 = aDescri;
     #38#12 = "3";
     #38#13 = fFechaAdq;
     #38#14 = fFechaTra;
     #38#15 = nCampo15;
     #38#16 = nCampo16;
     #38#20 = nCampo20;
     #38#29 = #20#125;
     #38#30 = #20#14;

     |HAZ Total38;

     #38#27 = "B1";
     #38#28 = #20#1;
     |GRABA 020#38n;
     |LIBERA #38;

     eaPrograma   = "rem00038";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO Calculo411;
     |SI #41#14 ] "31.12.1994";  |ACABA;  |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #41#2;
     |LEE 000#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

     |SELECT #1#999;
     |CIERRA #999;

     |SI #999#5 = "S";
         #41#39 = #41#24;
         |ACABA;
     |FINSI;

     |SI #41#41 < #41#16;
         #41#39 = #41#41 - #41#21;
     |SINO;
         #41#39 = #41#24;
     |FINSI;
|FPRC;

|PROCESO FechaLimite;
     fFechaLim  = "20.01.2006";

     |SI #41#15 [ fFechaLim;  |ACABA;  |FINSI;

     |ABRE #999;
     |SELECT #2#999;
     #999#1 = #41#2;
     |LEE 000#999=;
     |SI FSalida ! 0;  |DDEFECTO #999;  |FINSI;

     |SELECT #1#999;
     |CIERRA #999;

     |SI #999#5 = "S";
         #41#39 = #41#24;
         |ACABA;
     |FINSI;

     nTodosDias = (#41#15    - #41#14);
     nParciDias = (fFechaLim - #41#14);

     #41#39     = ((#41#24 / nTodosDias) * nParciDias) ! 2;
|FPRC;

|PROCESO Total41;
     aAlfa1      = #41#14 % -104;
     aAlfa3      = #41#14 % 0105;
     aAlfa2      = #41#15 % -104;
     nAnyoCompra = aAlfa1;
     nAnyoVenta  = aAlfa2;
     nDiferencia = #41#15 - #41#14

     |SI #41#12 = "1";  |O #41#12 = "2";
         |SI #41#14      < "01.01.1984";    nAnyoCompra = 1983;  |FINSI;

         |ABRE #407;
         #407#0 = 2006;
         #407#1 = nAnyoCompra;
         |LEE 040#407=;
         |SI FSalida ! 0;  |DDEFECTO #407;  |FINSI;
         |CIERRA #407;

         #41#18 = #407#3;

         |SI nDiferencia < 365;             #41#18 = 1;      |FINSI;
         |SI #41#13      ! "I";             #41#18 = 1;      |FINSI;
     |FINSI;

     |SI #41#12 = "3";
         |SI #41#14      < "31.12.1994";    nAnyoCompra = 1994;  |FINSI;
         |SI #41#14      = "31.12.1994";    nAnyoCompra = 1995;  |FINSI;

         |ABRE #407;
         #407#0 = 2006;
         #407#1 = nAnyoCompra;
         |LEE 040#407=;
         |SI FSalida ! 0;  |DDEFECTO #407;  |FINSI;
         |CIERRA #407;

         #41#18 = #407#2;
         |SI nDiferencia [ 365;             #41#18 = 1;      |FINSI;
         |SI #41#13      ! "I";             #41#18 = 1;      |FINSI;
     |FINSI;

     |SI #41#12 = "4";  |O #41#12 = "5";  |O #41#12 = "6";  |O #41#12 = "7";
         #41#18 = 1;
     |FINSI;

     nAnyoCompra = aAlfa1;
     |SI aAlfa3 = "31.12";  nAnyoCompra = nAnyoCompra + 1;  |FINSI;

     #41#19 = #41#17 * #41#18;
     #41#21 = #41#19 - #41#20;
     #41#40 = 0;

     nValor = #41#16 - #41#21;
     |SI nValor < 0;
         #41#22 = -nValor;
         #41#23 = -nImputable;
         |SI #41#23 = 0;  #41#23 = #41#22;  |FINSI;

         |PARA nCampo = 24;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               #41nCampo = 0;
         |SIGUE;

         #41#38 = "N";
         #41#39 = 0;
         #41#40 = 0;
     |SINO;
         #41#22 = 0;
         #41#23 = 0;

         #41#24 = nValor;

         |SI #41#12 ! "1";  |Y #41#12 ! "2";
             #41#25 = (1996 - nAnyoCompra) + 1;
             |SI #41#25 < 0;  #41#25 = 0;  |FINSI;

             nCoefi     = 0;
             |SI #41#25 ] 3;
                 |SI #41#13 = "I";  nCoefi = (#41#25 - 2) * 11.11; |FINSI;
                 |SI #41#13 = "O";  nCoefi = (#41#25 - 2) * 14.28;  |FINSI;

                 |SI #41#13 = "A";
                                      nCoefi = (#41#25 - 2) * 25;
                     |SI #41#12 = 4;  nCoefi = (#41#25 - 2) * 11.11;  |FINSI;
                 |FINSI;
             |FINSI;

             |SI nCoefi > 99; nCoefi = 100; |FINSI;

             #41#39     = #41#24;

             |SI #41#12 ! "6";
                 |SI #41#12 = "4";  |Y #41#13 = "A";
                     |HAZ Calculo411;
                 |SINO;
                     |HAZ FechaLimite;
                 |FINSI;
             |SINO;
                 |HAZ Calculo411;
             |FINSI;

             |SI #41#14 ] "31.12.1994";
                 #41#39 = 0;
             |FINSI;

             |SI #41#39 < 0;  #41#39 = 0;  |FINSI;

             #41#40 = #41#39 % nCoefi;
             #41#26 = #41#24 - #41#40;

             |SI #41#27 > #41#26;
                 #41#27 = #41#26;
             |FINSI;

             #41#28 = #41#26 - #41#27;
             #41#29 = nImputable;
             |SI #41#29 = 0;  #41#29 = #41#28;  |FINSI;

             |PARA nCampo = 30;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
                   #41nCampo = 0;
             |SIGUE;
         |SINO;
             #41#31 = #41#24 - #41#30;
             #41#32 = #41#31;
             #41#33 = #41#31 - #41#32;

             |PARA nCampo = 25;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
                   #41nCampo = 0;
             |SIGUE;

             #41#38 = "N";
             #41#39 = 0;
             #41#40 = 0;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO El41;
     #41#0 = #20#0;
     #41#1 = 99;
     |LEE 040#41];
     |SI FSalida = 0;
         |LEE 040#41a;
     |SINO;
         |LEE 040#41u;
     |FINSI;

     |SI FSalida = 0; |Y #41#0 = #20#0;
         nLinea = #41#1 + 1;
     |SINO;
         nLinea = 1;
     |FINSI;

     |DDEFECTO #41;
     #41#0  = #20#0;
     #41#1  = nLinea;

     |PARA nCampo = 2;  |SI nCampo [ 10;  |HACIENDO nCampo = nCampo + 1;
           #41nCampo = #20nCampo;
     |SIGUE;

                       #41#3  = "R";
     |SI #20#3 = "X";  #41#3  = "X";  |FINSI;
     #41#11 = aDescri;
     #41#12 = "3";
     #41#13 = "I";
     #41#14 = fFechaAdq;
     #41#15 = fFechaTra;
     #41#16 = nCampo16;
     #41#17 = nCampo17;
     #41#20 = nCampo20;
     #41#27 = nCampo27;

     |HAZ Total41;

     #41#34 = "B1";
     #41#35 = #20#1;
     #41#36 = #20#125;
     #41#37 = #20#14;

     |GRABA 020#41n;
     |LIBERA #41;

     eaPrograma   = "rem00041";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|PROCESO PuntosG;
     |SI #20#24 ! "S";  |ACABA;  |FINSI;

     nDias    = #20#68 - #20#25;
     |SI nDias [ 365;
         fFechaAdq  = #20#25;
         fFechaTra  = #20#68;
         nCampo15   = #20#71;
         nCampo16   = #20#67;
         nCampo20   = #20#74;
         nImputable = #20#76;
         aDescri    = #20#13;
         |HAZ El38;

         |SI #20#77 ! "01.01.0000";
              aDescri    = #20#78;
              fFechaAdq  = #20#77;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo15   = (#20#69 - #20#70) * (#20#82 / (#20#67 + nMejoras));
              nCampo16   = #20#82;
              nCampo20   = (#20#74 * nCampo15) / #20#71;
              nImputable = 0;
              |HAZ El38;
         |FINSI;

         |SI #20#83 ! "01.01.0000";
              aDescri    = #20#84;
              fFechaAdq  = #20#83;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo15   = (#20#69 - #20#70) * (#20#88 / (#20#67 + nMejoras));
              nCampo16   = #20#88;
              nCampo20   = (#20#74 * nCampo15) / #20#71;
              nImputable = 0;
              |HAZ El38;
         |FINSI;

         |SI #20#89 ! "01.01.0000";
              aDescri    = #20#90;
              fFechaAdq  = #20#89;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo15   = (#20#69 - #20#70) * (#20#94 / (#20#67 + nMejoras));
              nCampo16   = #20#94;
              nCampo20   = (#20#74 * nCampo15) / #20#71;
              nImputable = 0;
              |HAZ El38;
         |FINSI;
     |SINO;
         nMejoras   = 0;
         fFechaAdq  = #20#25;
         fFechaTra  = #20#68;
         nCampo16   = #20#71;
         nCampo17   = #20#26;
         |SI #1#16 = "N";
             nCampo17   = #20#26 + #20#29;
         |FINSI;
         nCampo20   = #20#66;
         nCampo27   = #20#74;
         nImputable = #20#76;
         aDescri    = #20#13;
         |HAZ El41;

         |SI #20#77 ! "01.01.0000";
              aDescri    = #20#78;
              fFechaAdq  = #20#77;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo16   = (#20#69 - #20#70) * (#20#82 / (#20#67 + nMejoras));
              nCampo17   = #20#79;
              nCampo20   = #20#81;
              nImputable = 0;
              |HAZ El41;
         |FINSI;

         |SI #20#83 ! "01.01.0000";
              aDescri    = #20#84;
              fFechaAdq  = #20#83;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo16   = (#20#69 - #20#70) * (#20#88 / (#20#67 + nMejoras));
              nCampo17   = #20#85;
              nCampo20   = #20#87;
              nImputable = 0;
              |HAZ El41;
         |FINSI;

         |SI #20#89 ! "01.01.0000";
              aDescri    = #20#90;
              fFechaAdq  = #20#89;
              fFechaTra  = #20#68;

              nMejoras   = #1002#82 + #1002#88 + #1002#94;
              nCampo16   = (#20#69 - #20#70) * (#20#94 / (#20#67 + nMejoras));
              nCampo17   = #20#94;
              nCampo20   = #20#93;
              nImputable = 0;
              |HAZ El41;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Borra38;
     |BORRA 020#38a;
     |LIBERA #38;

     eaPrograma   = "rem00038";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00038;
     #38#1;
     27, 28;
     #20#0, 01, "B1", #20#1;
     #20#0, 99, "B1", #20#1;
     be;
     NULL, Borra38;
|FIN;

|PROCESO Borra41;
     |BORRA 020#41a;
     |LIBERA #41;

     eaPrograma   = "rem00041";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRC;

|DEFBUCLE rem00041;
     #41#1;
     34, 35;
     #20#0, 01, "B1", #20#1;
     #20#0, 99, "B1", #20#1;
     be;
     NULL, Borra41;
|FIN;

|PROCESO Patrimonio;
     |SI #20#3  = "R";           |ACABA;  |FINSI;
     |SI #20#3  = "X";           |ACABA;  |FINSI;

     |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;

     |SI #20#129 ! 0;
         |HAZ LimpiaPatrim;
         eaLetra    = "U1";
         eaDeDonde  = "B1";
         eaPatr20   = #20#5;
         eaPatr21   = #20#6;
         eaLinDonde = #20#1;
         eaAnyoUsu  = #20#16;
         eaPatr06   = #20#13;
         eaPatr10   = #20#129;

         |HAZ GrabaPatrimonio;
     |FINSI;

     |SI #20#24 = "S";           |ACABA;  |FINSI;

     |HAZ LimpiaPatrim;

     eaDeDonde  = "B1";
     eaLinDonde = #20#1;
     eaAnyoUsu  = #20#16;
     eaPatr08   = #20#105;
     eaPatr09   = #20#106;
     eaPatr16   = #20#104;
     eaPatr17   = #20#14;
     nValor     = #20#26;

     |ABRE #100;
     #100#0 = #20#0;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |SI #1#16 = "N";  |Y #1#17 = "S";
         nValor = #20#26 + #20#29;
     |FINSI;

     |SI nValor < #20#27;  nValor = #20#27;  |FINSI;
     |SI nValor < #20#15;  nValor = #20#15;  |FINSI;

     eaPatr10   = nValor;

     |SI #20#18 = "R";
         eaLetra    = "B1";
         eaPatr11   = #20#19;
         eaPatr12   = #20#20;
     |SINO;
         eaLetra    = "A1";
         eaPatr06   = #20#13;
         eaPatr19   = "V";
         eaPatr22   = "N";
         eaPatr23   = "0";
         |SI #20#18 = "L";  eaPatr19   = "L";  |FINSI;
         |SI #20#18 = "O";  eaPatr19   = "O";  |FINSI;
         |SI #20#18 = "S";  eaPatr19   = "O";  |FINSI;
         |SI #20#30 ! 0;  |O #20#33 ! 0;
             eaPatr22 = "S";
             nNume    = #401#90;
             |SI #20#2 = "GANANCIAL ";
                 nNume    = #401#91;
             |FINSI;
             |SI nNume > nValor;
                 nNume = nValor;
             |FINSI;
             |SI #100#94 = "S";  nNume = 0;  |FINSI;
             eaPatr23 = nNume;
         |FINSI;
     |FINSI;

     |SI #20#104 = "U";  |Y #20#30 = 0;  |Y #20#33 = 0;
         eaLetra    = "M1";
         eaPatr06   = "";
         eaPatr15   = #20#13;
         eaPatr14   = nValor;
     |FINSI;

     eaPatr20 = #20#5;
     eaPatr21 = #20#6;

     |HAZ GrabaPatrimonio;
|FPRC;

|PROCESO Tipo2m20;  |TIPO 2;
     nModo = (FEntrada / 100) ! 0;

     nEntrada = 0 +. 1;
     |SI nEntrada ! 1;
         |BUCLE rem00038;
         |BUCLE rem00041;

                             eaDeDonde  = "B1";
                             eaLinDonde = #20#1;
                             eaLetra    = "A1";
         |SI #20#18  = "R";  eaLetra    = "B1";  |FINSI;
         |SI #20#104 = "U";  |Y #20#30 = 0;  |Y #20#33 = 0;
                             eaLetra    = "M1";
         |FINSI;

         |HAZ BorraPatrimonio;
     |FINSI;

     |SI nModo = 3;
         enSwRetorno  = 1;

         |SI #20#124 = "S";
             |ABRE #102;
             |SELECT #2#102;
             #102#0  = #20#0;
             #102#12 = #20#1;
             |LEE 101#102=;
             |SI FSalida = 0;
                 |BORRA 020#102a;
                 |LIBERA #102;
             |FINSI;
             |CIERRA #102;

             eaPrograma   = "rem00102";
             eaPunto      = "  ";
             |HAZ ProgramaActivo;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI nEntrada ! 1;
         |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
               #99nCampo = #20nCampo;
         |SIGUE;
     |SINO;
         |SI #20#18 = "S";  |O #20#18 = "R";
             |SI #20#115 = 0;
                 #20#58  = 0;
             |FINSI;
         |FINSI;

         |SI #20#31 ! 0;  |O #20#34 ! 0;
             |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                   #1001nCampos = #20nCampos;
             |SIGUE;
             |PUSHV 0501 2380;
             |PINPA #0#1001;

             |HAZ Totalw601;

             |PINDA #0#1001;
             |ENDATOS #1#1001;
             |SI FSalida = 0;
                 |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                       #20nCampos = #1001nCampos;
                 |SIGUE;
             |FINSI;
             |POPV;
         |SINO;
             |PDEFECTO #20, 36, 62;
         |FINSI;

         |SI #20#24 = "S";
             |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                   #1002nCampos = #20nCampos;
             |SIGUE;
             |PUSHV 0501 2380;
             |PINPA #0#1002;
             |PINDA #0#1002;
             |ENDATOS #1#1002;
             |SI FSalida = 0;
                 |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                       #20nCampos = #1002nCampos;
                 |SIGUE;
             |FINSI;
             |POPV;
         |SINO;
             |PDEFECTO #20, 62, 95;
         |FINSI;

         |SI nModo ! 1;
             |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
                   |SI #99nCampo ! #20nCampo;
                       enSwRetorno  = 1;
                   |FINSI;
             |SIGUE;
         |SINO;
             enSwRetorno  = 1;
         |FINSI;

         |ABRE #38;
         |ABRE #41;
         |HAZ PuntosG;
         |CIERRA #38;
         |CIERRA #41;

         |HAZ Patrimonio;

         |ABRE #102;
         |SI #20#124 = "S";
             |SELECT #2#102;
             #102#0  = #20#0;
             #102#12 = #20#1;
             |LEE 101#102=;
             |SI FSalida = 0;
                 nLineaViv = #102#1;
             |SINO;
                 nLineaViv = 1;
                 |SELECT #1#102;
                  #102#0  = #20#0;
                  #102#1  = 999;
                  |LEE 000#102];
                  |SI FSalida = 0;
                      |LEE 000#102a;
                  |SINO;
                      |LEE 000#102u;
                  |FINSI;
                  |SI FSalida = 0;  |Y #102#0 = #20#0;
                      nLineaViv = #102#1 + 1;
                  |FINSI;
             |FINSI;

             |SELECT #1#102;
             |DDEFECTO #102;
             #102#0 = #20#0;
             #102#1 = nLineaViv;
             |LEE 101#102=;
             |SI FSalida ! 0;
                 #102#0 = #20#0;
                 #102#1 = nLineaViv;
                 |GRABA 020#102b;
             |FINSI;

             #102#2  = #20#2;
             #102#3  = #20#5;
             #102#4  = #20#6;
             #102#5  = #20#7;
             #102#6  = #20#8;
             #102#7  = #20#9;
             #102#8  = #20#10;

             |SI #20#104 = "P";
                 #102#9  = "1";
                 #102#10 = "EN PROPIEDAD";
             |FINSI;

             |SI #20#104 = "U";
                 #102#9 = "2";
                 #102#10 = "EN USUFRUCTO";
             |FINSI;

             #102#11 = #20#14;
             #102#12 = #20#1;
             #102#14 = #20#125;

             |GRABA 020#102a;
             |LIBERA #102;
         |SINO;
             |SELECT #2#102;
             #102#0  = #20#0;
             #102#12 = #20#1;
             |LEE 101#102=;
             |SI FSalida = 0;
                 |BORRA 020#102a;
                 |LIBERA #102;
             |FINSI;
         |FINSI;
         |CIERRA #102;

         eaPrograma   = "rem00102";
         eaPunto      = "  ";
         |HAZ ProgramaActivo;
     |FINSI;
|FPRC;

|PROCESO Tipo11m20;  |TIPO 11;
     nTecla = FSalida;
     |SI nTecla < 10;  |O nTecla > 14;
         |ACABA;
     |FINSI;

     |PUSHV 0501 2380;
     |SI nTecla = 10;
         |SI #20#31 ! 0;  |O #20#34 ! 0;
             |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
                   #1001nCampos = #20nCampos;
             |SIGUE;
             |PINPA #0#1001;

             |HAZ Totalw601;

             |PINDA #0#1001;
             |LEETECLA aAlfa;
         |FINSI;
     |FINSI;

     |SI nTecla = 11;  |Y #20#24 = "S";
         |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
               #1002nCampos = #20nCampos;
         |SIGUE;
         |PINPA #0#1002;
         |PINDA #0#1002;
         |LEETECLA aAlfa;
     |FINSI;

     |SI nTecla = 12;  |Y #20#23 ! 0;
         |PARA nCampos = 0;  |SI nCampos [ nNumCampos;  |HACIENDO nCampos = nCampos + 1;
               #1003nCampos = #20nCampos;
         |SIGUE;
         |PINPA #0#1003;
         |PINDA #0#1003;
         |LEETECLA aAlfa;
     |FINSI;

     |SI nTecla = 13;
         |HAZ Rendimientos;
     |FINSI;

     |SI FSalida = 14;  |Y #20#2 = "VARIOS    ";
         #900#0 = #20#5;
         #900#1 = #20#6;
         #900#2 = #20#7;
         #900#3 = #20#8;
         #900#4 = #20#9;
         #900#5 = #20#10;

         |PINPA #0#900;
         |PINDA #0#900;
         |LEETECLA aTecla;
     |FINSI;

     |POPV;
     |ERROR;
|FPRC;

|PROCESO rem00021;
     |SI #20#2 = "TITULAR   ";
         nDiasHT = nDiasHT + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "CONYUGE   ";
         nDiasHC = nDiasHC + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "GANANCIAL ";
         nDiasHT = nDiasHT + #20#30 + #20#33;
         nDiasHC = nDiasHC + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "VARIOS    ";
         |SI #20#5  ! 0;  nDiasHT = nDiasHT + #20#30 + #20#33;  |FINSI;
         |SI #20#6  ! 0;  nDiasHC = nDiasHC + #20#30 + #20#33;  |FINSI;
         |SI #20#7  ! 0;  nDiasH1 = nDiasH1 + #20#30 + #20#33;  |FINSI;
         |SI #20#8  ! 0;  nDiasH2 = nDiasH2 + #20#30 + #20#33;  |FINSI;
         |SI #20#9  ! 0;  nDiasH3 = nDiasH3 + #20#30 + #20#33;  |FINSI;
         |SI #20#10 ! 0;  nDiasH4 = nDiasH4 + #20#30 + #20#33;  |FINSI;
     |FINSI;

     |SI #20#2 = "1 FAMILIAR";
         nDiasH1 = nDiasH1 + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "2 FAMILIAR";
         nDiasH2 = nDiasH2 + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "3 FAMILIAR";
         nDiasH3 = nDiasH3 + #20#30 + #20#33;
     |FINSI;

     |SI #20#2 = "4 FAMILIAR";
         nDiasH4 = nDiasH4 + #20#30 + #20#33;
     |FINSI;
|FPRC;

|DEFBUCLE rem00021;
     #20#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, rem00021;
|FIN;

|PROCESO rem00021Cheq;
     |SI #20#30 = 0;  |ACABA;  |FINSI;

     nError = 0;
     |ERROR10;
|FPRC;

|DEFBUCLE rem00021Cheq;
     #20#1;
     14;
     enEmpresa, 01, #102#11;
     enEmpresa, 99, #102#11;
     ;
     NULL, rem00021Cheq;
|FIN;

|PROCESO rem00102;
     nError = 1;
     |BUCLE rem00021Cheq;

     |SI nError = 0;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;
     |BLANCO 0501 2380;
     |CUADRO 1115 1576;

     |ATRI I;
     aAlfa = "No existe la Referencia Catastral: " + #102#11;
     |PINTA 1216, aAlfa;
     |PINTA 1316, "informada en los Datos Adicionales de la Vivienda Habitual";
     |PINTA 1416, "en el Inmobiliario. Por favor informelo.                  ";
     |ATRI i;

     |LEETECLA  aAlfa;

     |POPV;
|FPRC;

|DEFBUCLE rem00102;
     #102#1;
     9;
     enEmpresa, 01, "1";
     enEmpresa, 99, "2";
     ;
     NULL,  rem00102;
|FIN;

|PROGRAMA;
     |ABRE #401;
     |LEE 040#401p;
     |SI FSalida ! 0;  |DDEFECTO #401;  |FINSI;
     |CIERRA #401;

     |ABRE #1;
     |LEE 040#1p;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI enModo = 3;
         |ABRE #20;
         #20#0 = enEmpresa;
         #20#1 = enLineal;
         |LEE 101#20=;
         |SI FSalida = 0;
             |BUCLE rem00038;
             |BUCLE rem00041;

             |BORRA 020#20a;
             |LIBERA #20;

             eaPrograma   = "rem00021";
             eaPunto      = "  ";
             |HAZ ProgramaActivo;
         |FINSI;
         |CIERRA #20;
         |ACABA;
     |FINSI;

     aQueQuiero = "|NP";
     aNumPanta  = #20#aQueQuiero#;
     nNumPanta  = aNumPanta;
     nNumPanta  = nNumPanta - 1;

     aQueQuiero = "|NC";
     aNumCampos = #20#aQueQuiero#;
     nNumCampos = aNumCampos;
     nNumCampos = nNumCampos - 1;

     |DBASE aPathRenta;  |QBT aPathRenta;
     aDef = aPathRenta + "def/rem00021.mas";
     |CARGA_DEF aDef, espejo@;
     |SI FSalida ! 0;
         aAlfa = "     Error en cargar el Def rem00021.mas";
         |MENAV aAlfa;
         |ERROR;
     |FINSI;

     nDLinea = 1;
     nHLinea = 99;
     |SI enLineal ! 0;
         nDLinea  = enLineal;
         nHLinea  = enLineal;
     |FINSI;

     |ENTLINEAL #1#20, -2, enModo, 22, 1, ClaveBaja20, ClaveAlta20;

     nDiasHT = 0;
     nDiasHC = 0;
     nDiasH1 = 0;
     nDiasH2 = 0;
     nDiasH3 = 0;
     nDiasH4 = 0;

     |BUCLE rem00021;

     |SI nDiasHT > 365;
         |MENAV "     Los dias de la Vivienda Habitual del Titular exceden de 365. ";
     |FINSI;

     |SI nDiasHC > 365;
         |MENAV "     Los dias de la Vivienda Habitual del Conyuge exceden de 365. ";
     |FINSI;

     |SI nDiasH1 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 1 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH2 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 2 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH3 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 3 FAMILIAR exceden de 365. ";
     |FINSI;

     |SI nDiasH4 > 365;
         |MENAV "     Los dias de la Vivienda Habitual del 4 FAMILIAR exceden de 365. ";
     |FINSI;

     |BUCLE rem00102;

     |DESCARGA_DEF #espejo@;

     eaPrograma   = "rem00021";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
