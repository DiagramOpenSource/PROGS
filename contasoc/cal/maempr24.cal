|FICHEROS;
    maempr24;

    &regisnif@ #709;
    &sgpaises@ #718;
|FIN;

|VARIABLES;
     &empresa   = 0;
     &anyo      = 0;
     &modo      = 0;

     SwError    = 0;
     nSalir     = 0;
     aAlfa      = "";
     aAlfa1     = "";
     aAlfa2     = "";
     aAlfa3     = "";
     nModo      = 0;
     nCampo     = 0;
     nNume1     = 0;
     nNume3     = 0;
     &enCalcCif = 0;
     &eaVarDni  = "";
     &eaCodPais = "";
     &eaCodNif  = "";
     &eswNif    = 0;
|FIN;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempr24#Campo#;
         |HAZ CalculoDNI;
         #maempr24#Campo# = eaVarDni;
         |PINTA #maempr24#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #maempr24#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempr24#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempr24#Campo# = eaVarDni;  |PINTA #maempr24#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeePaism24; |TIPO 6;
     eaCodPais = #maempr24#Campo#;
     |HAZ eLeePais;
     nCampo = Campo + 1;
     #maempr24#nCampo# = #718#1; |PINTA #maempr24#nCampo#;
|FPRC;

|PROCESO Tipo0C3; |TIPO 0;
/*
     SwError = 0;
     |SI #maempr24#4 = "F"; |Y #maempr24#3 = 1;
         SwError = 1;
     |FINSI;
     |SI #maempr24#4 = "J"; |Y #maempr24#3 ! 1;
         SwError = 1;
     |FINSI;
     |SI SwError = 1;
         |MENAV "0000Revise si es correcto el Nivel introducido";
     |FINSI;
*/
|FPRC;

|PROCESO PonDatos;
     aAlfa1 = Contenido;
     nModo  = (FEntrada / 100) ! 0;
     aAlfa  = #maempr24#6; |QBF aAlfa;

     |SI nModo = 1; |O aAlfa = ""; |O aAlfa1 ! #maempr24#5;

         eaCodNif  = #maempr24#5;
         |HAZ LeeNifs;

         #maempr24#6  = #709#1;  |PINTA #maempr24#6;

         aAlfa  = #709#2; |QBF aAlfa;
         aAlfa1 = #709#3; |QBF aAlfa1;
         |SI aAlfa1 ! "";
             |SI aAlfa ! ""; aAlfa = aAlfa + ", "; |FINSI;
             aAlfa = aAlfa + aAlfa1;
         |FINSI;
         aAlfa1 = #709#6; |QBF aAlfa1;
         |SI aAlfa1 ! ""; aAlfa = aAlfa + " " + aAlfa1; |FINSI;
         aAlfa1 = #709#7; |QBF aAlfa1;
         |SI aAlfa1 ! "";
             aAlfa2 = aAlfa + " (" + aAlfa1 + ")";
             aAlfa3 = aAlfa2 % 0; nNume3 = aAlfa3;
             |SI nNume3 > 50;
                 aAlfa2 = aAlfa + " " + aAlfa1;
             |FINSI;
             aAlfa = aAlfa2;
         |FINSI;
         #maempr24#7 = aAlfa; |PINTA #maempr24#7;

         aAlfa = #maempr24#5 % 101; aAlfa = aAlfa > " ";
         |SI aAlfa < "0"; |O aAlfa > "9";
             |SI aAlfa ! "X"; |Y aAlfa ! "Y"; |Y aAlfa ! "Z";
                 #maempr24#4 = "J";
             |FINSI;
         |FINSI;
         |PINTA #maempr24#4;
     |FINSI;

|FPRC;

|PROCESO inferior;
     #maempr24#0 = empresa;
     #maempr24#1 = anyo;
     #maempr24#2 = 01;
|FPRC;

|PROCESO superior;
     #maempr24#0 = empresa;
     #maempr24#1 = anyo;
     #maempr24#2 = 99;
|FPRC;

|PROGRAMA;

     |PINPA #0#maempr24;
     |SI modo = 4;
         |ENTLINEAL #1#maempr24, -3, 4, 21, 0, inferior, superior;
     |SINO;
         |ENTLINEAL #1#maempr24, -3, 2, 21, 0, inferior, superior;
     |FINSI;
|FPRO;
