|FICHEROS;
    :/contagen/def/ca8cumay #410;  || Control de Balances

     soda8w04 #4;
     soda8w05 #5;
     :/contagen/def/ca8m0001 #401;
     :/contagen/def/ca8m0002 #402;
     :/contagen/def/ca8m0021 #421;
     :/contagen/def/ca8m0022 #422;

     :/contasoc/def/soda8m02 #431;
     :/contasoc/def/soda8m03 #432;
     :/contasoc/def/soda8m22 #441;
     :/contasoc/def/soda8m23 #442;
|FIN;

|VARIABLES;
 &eNum2008   = 0;
 &nBalance   = 0;
 &aCuenta    = "";
 &aAPR       = "";
 &enCampo0   = 0;
 aCtaM       = "";
 nSI         = 0;
 nLinea      = 0;
 aSigno      = "";
 aCondi      = "";
 nTiImp      = 0;
 nTipEjer    = 0;
 aCasilla    = "";
 nCasilla    = 0;
 nCol        = 0;
 nNume1      = 0;
 nNume2      = 0;
 &enEjerBal = 0;
|FIN;


|PROCESO MSigno_sLeo;
  #410#12 = enEjerBal;
  #410#0  = aCtaM;
  #410#10 = eNum2008;
  |LEE 001#410=;
  |SI FSalida = 0;
      nSI  = 1;
      aAPR = #410#3;
  |FINSI;
|FPRC;

|PROCESO MSigno08_s;
  |ABRE #410;
  nSI = 0;
  aCtaM = aCuenta % 105;
  |HAZ MSigno_sLeo;
  |SI nSI = 1; |ACABA; |FINSI;

  aCtaM = aCuenta % 104;
  |HAZ MSigno_sLeo;
  |SI nSI = 1; |ACABA; |FINSI;

  aCtaM = aCuenta % 103;
  |HAZ MSigno_sLeo;
  |SI nSI = 1; |ACABA; |FINSI;

  aCtaM = aCuenta % 102;
  |HAZ MSigno_sLeo;

  |CIERRA #410;
|FPRC;

|PROCESO GrabaReg;
     #4#0 = enCampo0;
     #4#1 = nBalance;
     #4#2 = aCasilla;
     #4#3 = nLinea;
     #4#4 = aCuenta;
     #4#5 = aSigno;
     #4#6 = aCondi;
     #4#7 = nTiImp;
     #4#8 = nTipEjer;
     |GRABA 040#4n;
|FPRC;

|PROCESO BorroAnterior;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE BorroAnterior;
     #4#1;
     ;
     enCampo0, nBalance, aCasilla, 001;
     enCampo0, nBalance, aCasilla, 999;
     ;
     NULL, BorroAnterior;
|FIN;

|PROCESO LeoCa8m0022;
     nLinea  = #422#8;
     aCuenta = #422#9;
     aSigno  = #422#10;
     aCondi  = #422#11;
     nTiImp  = #422#12;
     |HAZ GrabaReg;
|FPRC;

|DEFBUCLE LeoCa8m0022;
     #422#1;
     ;
     #421#14, #421#0, #421#1, #421#2, #421#3, #421#4, #421#5, #421#6, #421#7, #421#10, 001;
     #421#14, #421#0, #421#1, #421#2, #421#3, #421#4, #421#5, #421#6, #421#7, #421#10, 999;
     ;
     NULL, LeoCa8m0022;
|FIN;

|PROCESO LeoCa8m0021;
    |SI #421#12 ! 0;
        aCasilla = #421#12;
        |BUCLE BorroAnterior;
        |SI #421#8 = "C";
            |ABRE #4;
            |BUCLE LeoCa8m0022;
            |CIERRA #4;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE LeoCa8m0021;
   #421#1;
   ;
   enEjerBal, enCampo0, nBalance, 0, " ", 00, 0, 00, 00, 0;
   enEjerBal, enCampo0, nBalance, 9, "z", 99, 9, 99, 99, 9;
   ;
   NULL, LeoCa8m0021;
|FIN;

|PROCESO LeoCa8m0002;
  nLinea  = #402#8;
  aCuenta = #402#9;
  aSigno  = #402#10;
  aCondi  = #402#11;
  nTiImp  = #402#12;
  |HAZ GrabaReg;
|FPRC;

|DEFBUCLE LeoCa8m0002;
   #402#1;
   ;
   #401#14, #401#0, #401#1, #401#2, #401#3, #401#4, #401#5, #401#6, #401#7, #401#10, 001;
   #401#14, #401#0, #401#1, #401#2, #401#3, #401#4, #401#5, #401#6, #401#7, #401#10, 999;
   ;
   NULL, LeoCa8m0002;
|FIN;

|PROCESO LeoCa8m0001;
   |SI #401#12 ! 0;
       aCasilla = #401#12;
       |SI #401#8 = "C";
           |BUCLE LeoCa8m0002;
       |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LeoCa8m0001;
   #401#1;
   ;
   enEjerBal, enCampo0, nBalance, 0, " ", 00, 0, 00, 00, 0;
   enEjerBal, enCampo0, nBalance, 9, "z", 99, 9, 99, 99, 9;
   ;
   NULL, LeoCa8m0001;
|FIN;

|PROCESO LeoSoda8m23;
  nLinea  = #442#3;
  aCuenta = #442#4;
  aSigno  = #442#5;
  aCondi  = " ";
  nTiImp  = #442#6;
  |HAZ GrabaReg;
|FPRC;

|DEFBUCLE LeoSoda8m23;
     #442#1;
     ;
     #441#34, #441#0, #441#1, nCol, 001;
     #441#34, #441#0, #441#1, nCol, 999;
     ;
     NULL, LeoSoda8m23;
|FIN;

|PROCESO LeoSoda8m22;
   nTipEjer = #441#4;
   |PARA nCol = 1; |SI nCol [ 13; |HACIENDO nCol = nCol + 1;
         nNume1 = nCol + 20; nNume2 = nCol + 6;
         |SI #441nNume1 ! 0;
             aCasilla = #441nNume1;
             |BUCLE BorroAnterior;
             |SI #441nNume2 = "C";
                 |ABRE #4;
                 |BUCLE LeoSoda8m23;
                 |CIERRA #4;
             |FINSI;
        |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE LeoSoda8m22;
   #441#1;
   ;
   enEjerBal, enCampo0, 001;
   enEjerBal, enCampo0, 999;
   ;
   NULL, LeoSoda8m22;
|FIN;

|PROCESO LeoSoda8m03;
  nLinea  = #432#3;
  aCuenta = #432#4;
  aSigno  = #432#5;
  aCondi  = " ";
  nTiImp  = #432#6;
  |HAZ GrabaReg;
|FPRC;

|DEFBUCLE LeoSoda8m03;
   #432#1;
   ;
   #431#34, #431#0, #431#1, nCol, 001;
   #431#34, #431#0, #431#1, nCol, 999;
   ;
   NULL, LeoSoda8m03;
|FIN;

|PROCESO LeoSoda8m02;
   nTipEjer = #431#4;
   |PARA nCol = 1; |SI nCol [ 13; |HACIENDO nCol = nCol + 1;
         nNume1 = nCol + 20; nNume2 = nCol + 6;
         |SI #431nNume1 ! 0; |Y #431nNume2 = "C";
             aCasilla = #431nNume1;
             |BUCLE LeoSoda8m03;
        |FINSI;
   |SIGUE;
|FPRC;

|DEFBUCLE LeoSoda8m02;
   #431#1;
   ;
   enEjerBal, enCampo0, 001;
   enEjerBal, enCampo0, 999;
   ;
   NULL, LeoSoda8m02;
|FIN;

|PROCESO MontaEstPase;

  nTipEjer = 3;
  |DELINDEX #4;
  |SI nBalance = 0; |O nBalance = 1; |O nBalance = 2;
      |ABRE #4;
      |BUCLE LeoCa8m0001;
      |CIERRA #4;
      |BUCLE LeoCa8m0021;
  |FINSI;

  |SI nBalance = 3;
      |ABRE #4;
      |BUCLE LeoSoda8m02;
      |CIERRA #4;
      |BUCLE LeoSoda8m22;
  |FINSI;
|FPRC;

|PROCESO Grabow05;
 aCasilla = nCasilla;

 #5#0 = enCampo0;
 #5#1 = nBalance;
 #5#2 = #401#12;
 #5#3 = aCasilla;
 #5#4 = #401#11;
 |GRABA 040#5n;
|FPRC;

|PROCESO BuscaDesglose;
  |PARA; |SI FSalida = 0; |HACIENDO;
         |LEE 041#421s;
         |SI FSalida = 0;
             |SI #421#8 = "C";
                 nCasilla = #421#12;
                 |SAL;
             |FINSI;
         |FINSI;
  |SIGUE;
|FPRC;

|PROCESO LeoCa8mCCAA1;

  #421#14 =  #401#14;
  #421#0  =  #401#0;
  #421#1  =  #401#1;
  #421#12 =  #401#12;
  |LEE 041#421=;
  |SI FSalida = 0;
      nCasilla = #421#12;
      |SI #401#8 = "C"; |Y #421#8 = "T";
          |HAZ BuscaDesglose;
      |FINSI;
      |SI #401#12 ! nCasilla;
          |HAZ Grabow05;
      |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE LeoCa8mCCAA1;
   #401#3;
   ;
   enEjerBal, enCampo0, nBalance, 00001;
   enEjerBal, enCampo0, nBalance, 99999;
   ;
   NULL, LeoCa8mCCAA1;
|FIN;

|PROCESO LeoCa8mCCAA421;
  #421#14 =  #401#14;
  #421#0  =  #401#0;
  #421#1  =  #401#1;
  #421#11 =  #401#11;
  |LEE 041#421=;
  |SI FSalida = 0;
      |SI #401#12 ! #421#12;
          nNume1   = #401#12;
          nCasilla = #421#12;
          #401#12  = #421#12;
          |HAZ Grabow05;
          #401#12  = nNume1;
      |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE LeoCa8mCCAA421;
   #401#2;
   ;
   enEjerBal, enCampo0, nBalance, 000001;
   enEjerBal, enCampo0, nBalance, 999999;
   ;
   NULL, LeoCa8mCCAA421;
|FIN;

|PROCESO MontaEstCCAA;

  |DELINDEX #5;
  |ABRE #5;
  |ABRE #421;
  |SELECT #3#421;
  |BUCLE LeoCa8mCCAA1;

  |SELECT #2#421;
  |BUCLE LeoCa8mCCAA421;

  |SELECT #1#421;
  |CIERRA #421;
  |CIERRA #5;

|FPRC;
