|FICHEROS;
     zhazdocu #0;
     zregdocu #1;
     zregfirm #4;
     zhazcrea #2,MANTE;
     maempr01 #301;

     megwordc #800;
     megwordl #801;

     cubal801 #1801;
     cubal802 #1802;

     zw000010 #910;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAbreTxt         = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aIPRemoto        = "";
     aCuenta          = "";
     aAste            = "";
     aLong            = "";
     aCuentaD         = "";
     aCuentaH         = "";
     aHora            = "";
     aPag             = "";
     aPag1            = "";
     aPag2            = "";
     &eaPag1          = "";
     &eaPag2          = "";
     aCarac10         = "";
     aCarac13         = "";
     aQueQuiero       = "";
     aCNAE            = "";
     aTipo            = "";

     nLong            = 0;
     nSubPanta        = 0;
     nVentana         = 0;
     nNume            = 0;
     nNume1           = 0;
     nNume2           = 0;
     nNume3           = 0;
     nNume4           = 0;
     nRango           = 0;
     nBotonSal        = 0;
     nImporte         = 0;
     nEjer            = 0;
     nCampo1          = 0;
     nCampo2          = 0;
     nCampo3          = 0;
     nCampo4          = 0;
     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nConta           = 0;
     nTributa         = 0;
     nC1              = 0;
     nC2              = 0;
     nC3              = 0;
     nC4              = 0;
     nC5              = 0;
     nC6              = 0;
     nCT              = 0;
     nCE              = 0;
     nCasilla         = 0;
     nImporte1        = 0;
     nImporte2        = 0;
     nImporte3        = 0;
     nImporte4        = 0;
     nImporte5        = 0;
     nImporte6        = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &enPersonaliza   = 0;
     &eaUnidadBasico = "";
     &enMensa        = 0;

     &EURODB          = 0;
|FIN;

|PROCESO LeeCuenta;
     nImporte = 0;

     |SI nCasilla = 0;  |ACABA;  |FINSI;

     #1801#0  = #2#0;
     #1801#1  = #2#1;
     #1801#16 = nCasilla;
     |LEE 000#1801=;
     |SI FSalida = 0;
         nImporte = #1801nCE;
         |ACABA;
     |FINSI;

     #1802#0  = #2#0;
     #1802#1  = #2#1;
     #1802#16 = nCasilla;
     |LEE 000#1802=;
     |SI FSalida = 0;
         nImporte = #1802nCE;
     |FINSI;
|FPRC;

|PROCESO Formula;
     nImporte1 = 0;
     nImporte2 = 0;
     nImporte3 = 0;
     nImporte4 = 0;
     nImporte5 = 0;
     nImporte6 = 0;

     nCasilla  = nC1;  |HAZ LeeCuenta;  nImporte1 = nImporte;
     nCasilla  = nC2;  |HAZ LeeCuenta;  nImporte2 = nImporte;
     nCasilla  = nC3;  |HAZ LeeCuenta;  nImporte3 = nImporte;
     nCasilla  = nC4;  |HAZ LeeCuenta;  nImporte4 = nImporte;
     nCasilla  = nC5;  |HAZ LeeCuenta;  nImporte5 = nImporte;
     nCasilla  = nC6;  |HAZ LeeCuenta;  nImporte6 = nImporte;
|FPRC;

|PROCESO Formulas;
     |ABRE #1801;
     |ABRE #1802;
     |SELECT #3#1801;
     |SELECT #3#1802;

     |DDEFECTO #910;

     nCT = 0; nCE = 6;
     nC1 = 40100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1;

     nCT = 1; nCE = 6;
     nC1 = 40400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1;

     #910#2 = #910#0 + #910#1;

     nCT = 3; nCE = 7;
     nC1 = 40100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1;

     nCT = 4; nCE = 7;
     nC1 = 40400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1;

     #910#5 = #910#3 + #910#4;
     #910#6 = ((#910#3 - #910#0) * 100) / #910#0;
     #910#7 = ((#910#4 - #910#1) * 100) / #910#1;
     #910#8 = ((#910#5 - #910#2) * 100) / #910#2;

     nCT = 9; nCE = 6;
     nC1 = 40100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 10; nCE = 6;
     nC1 = 40200;  nC2 = 40400; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 11; nCE = 6;
     nC1 = 40500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 12; nCE = 6;
     nC1 = 40600;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 13; nCE = 6;
     nC1 = 40700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 14; nCE = 6;
     nC1 = 40800;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 15; nCE = 6;
     nC1 = 40900;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 16; nCE = 6;
     nC1 = 41000;  nC2 = 41100; nC3 = 41200; nC4 = 41300; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 17; nCE = 6;
     nC1 = 49100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 18; nCE = 6;
     nC1 = 41400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 19; nCE = 6;
     nC1 = 41500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 20; nCE = 6;
     nC1 = 41700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 21; nCE = 6;
     nC1 = 41600;  nC2 = 41800; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 22; nCE = 6;
     nC1 = 49300;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 23; nCE = 7;
     nC1 = 40100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 24; nCE = 7;
     nC1 = 40200;  nC2 = 40400; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 25; nCE = 7;
     nC1 = 40500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 26; nCE = 7;
     nC1 = 40600;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 27; nCE = 7;
     nC1 = 40700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 28; nCE = 7;
     nC1 = 40800;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 29; nCE = 7;
     nC1 = 40900;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 30; nCE = 7;
     nC1 = 41000;  nC2 = 41100; nC3 = 41200; nC4 = 41300; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 31; nCE = 7;
     nC1 = 49100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 32; nCE = 7;
     nC1 = 41400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 33; nCE = 7;
     nC1 = 41500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 34; nCE = 7;
     nC1 = 41700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 35; nCE = 7;
     nC1 = 41600;  nC2 = 41800; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 36; nCE = 7;
     nC1 = 49300;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 40100;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     |PARA nCampo3 = 37;  |SI nCampo3 [ 50;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1 = nCampo3 - 28;
           nCampo2 = nCampo3 - 14;
           #910nCampo3 = #910nCampo2 - #910nCampo1;
     |SIGUE;

     nCT = 51; nCE = 6;
     nC1 = 11100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 52; nCE = 6;
     nC1 = 11200;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 53; nCE = 6;
     nC1 = 11300;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 54; nCE = 6;
     nC1 = 11400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 55; nCE = 6;
     nC1 = 11500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 56; nCE = 6;
     nC1 = 11600;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 57; nCE = 6;
     nC1 = 11700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 58; nCE = 6;
     nC1 = 12200;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 59; nCE = 6;
     nC1 = 12300;  nC2 = 12400; nC3 = 12500; nC4 = 12600; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 60; nCE = 6;
     nC1 = 12700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 61; nCE = 6;
     nC1 = 10000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 62; nCE = 6;
     nC1 = 20000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 63; nCE = 6;
     nC1 = 31000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 64; nCE = 6;
     nC1 = 32000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 65; nCE = 6;
     nC1 = 30000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 66; nCE = 7;
     nC1 = 11100;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 67; nCE = 7;
     nC1 = 11200;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 68; nCE = 7;
     nC1 = 11300;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 69; nCE = 7;
     nC1 = 11400;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 70; nCE = 7;
     nC1 = 11500;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 71; nCE = 7;
     nC1 = 11600;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 72; nCE = 7;
     nC1 = 11700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 73; nCE = 7;
     nC1 = 12200;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 74; nCE = 7;
     nC1 = 12300;  nC2 = 12400; nC3 = 12500; nC4 = 12600; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 75; nCE = 7;
     nC1 = 12700;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 76; nCE = 7;
     nC1 = 10000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 10000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 77; nCE = 7;
     nC1 = 20000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 78; nCE = 7;
     nC1 = 31000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 79; nCE = 7;
     nC1 = 32000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     nCT = 80; nCE = 7;
     nC1 = 30000;  nC2 = 0; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 30000;
     |HAZ Formula;
     #910nCT = ((nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) * 100) / nImporte6;

     |PARA nCampo3 = 81;  |SI nCampo3 [ 95;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1 = nCampo3 - 30;
           nCampo2 = nCampo3 - 15;
           #910nCampo3 = #910nCampo2 - #910nCampo1;
     |SIGUE;

     nCT = 96; nCE = 6;
     nC1 = 11000;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 97; nCE = 7;
     nC1 = 11000;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#98 = #910#97 - #910#96;

     nCT = 99; nCE = 6;
     nC1 = 12000;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 100; nCE = 7;
     nC1 = 12000;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#101 = #910#100 - #910#99;

     nCT = 102; nCE = 6;
     nC1 = 11000;  nC2 = 20000; nC3 = 31000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     nCT = 103; nCE = 7;
     nC1 = 11000;  nC2 = 20000; nC3 = 31000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     #910#104 = #910#103 - #910#102;

     nCT = 105; nCE = 6;
     nC1 = 12000;  nC2 = 32000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 106; nCE = 7;
     nC1 = 12000;  nC2 = 32000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#107 = #910#106 - #910#105;

     nCT = 108; nCE = 6;
     nC1 = 12300;  nC2 = 12400; nC3 = 12500; nC4 = 12600; nC5 = 12700; nC6 = 32000;
     |HAZ Formula;
     #910nCT = (nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) / nImporte6;

     nCT = 109; nCE = 7;
     nC1 = 12300;  nC2 = 12400; nC3 = 12500; nC4 = 12600; nC5 = 12700; nC6 = 32000;
     |HAZ Formula;
     #910nCT = (nImporte1 + nImporte2 + nImporte3 + nImporte4 + nImporte5) / nImporte6;

     #910#110 = #910#109 - #910#108;

     nCT = 111; nCE = 6;
     nC1 = 12310;  nC2 = 12380; nC3 = 40100; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (((nImporte1 + nImporte2) * 365) / nImporte3) ! 0;

     nCT = 112; nCE = 7;
     nC1 = 12310;  nC2 = 12380; nC3 = 40100; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (((nImporte1 + nImporte2) * 365) / nImporte3) ! 0;

     #910#113 = #910#112 - #910#111;

     nCT = 114; nCE = 6;
     nC1 = 32510;  nC2 = 32580; nC3 = 40200; nC4 = 40400; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (((nImporte1 + nImporte2) * 365) / ((nImporte3 + nImporte4) * -1)) ! 0;

     nCT = 115; nCE = 7;
     nC1 = 32510;  nC2 = 32580; nC3 = 40200; nC4 = 40400; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (((nImporte1 + nImporte2) * 365) / ((nImporte3 + nImporte4) * -1)) ! 0;

     #910#116 = #910#115 - #910#114;

     nCT = 117; nCE = 6;
     nC1 = 12000;  nC2 = 32000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 - nImporte2;

     nCT = 118; nCE = 7;
     nC1 = 12000;  nC2 = 32000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 - nImporte2;

     #910#119 = #910#118 - #910#117;

     nCT = 120; nCE = 6;
     nC1 = 31000;  nC2 = 32000; nC3 = 30000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (nImporte1 + nImporte2) / nImporte3;

     nCT = 121; nCE = 7;
     nC1 = 31000;  nC2 = 32000; nC3 = 30000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (nImporte1 + nImporte2) / nImporte3;

     #910#122 = #910#121 - #910#120;

     nCT = 123;  nCE = 6;
     nC1 = 32000;  nC2 = 31000; nC3 = 32000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     nCT = 124;  nCE = 7;
     nC1 = 32000;  nC2 = 31000; nC3 = 32000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     #910#125 = #910#124 - #910#123;

     nCT = 126;  nCE = 6;
     nC1 = 10000;  nC2 = 31000; nC3 = 32000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     nCT = 127;  nCE = 7;
     nC1 = 10000;  nC2 = 31000; nC3 = 32000; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / (nImporte2 + nImporte3);

     #910#128 = #910#127 - #910#126;

     nCT = 129;  nCE = 6;
     nC1 = 10000;  nC2 = 20000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 130;  nCE = 7;
     nC1 = 10000;  nC2 = 20000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#131 = #910#130 - #910#129;

     nCT = 132;  nCE = 6;
     nC1 = 49500;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 133;  nCE = 7;
     nC1 = 49500;  nC2 = 10000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#134 = #910#133 - #910#132;

     nCT = 135;  nCE = 6;
     nC1 = 49500;  nC2 = 20000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     nCT = 136;  nCE = 7;
     nC1 = 49500;  nC2 = 20000; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = nImporte1 / nImporte2;

     #910#137 = #910#136 - #910#135;

     nCT = 138;  nCE = 6;
     nC1 = 41500;  nC2 = 40100; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (nImporte1 * -1) / nImporte2;

     nCT = 139;  nCE = 7;
     nC1 = 41500;  nC2 = 40100; nC3 = 0; nC4 = 0; nC5 = 0; nC6 = 0;
     |HAZ Formula;
     #910nCT = (nImporte1 * -1) / nImporte2;

     #910#140 = #910#139 - #910#138;

     |CIERRA #1801;
     |CIERRA #1802;
|FPRC;

|PROCESO CargaVarGestion;
     eaAsigna   = "P" + #2#8;
     eaConten   = eaDirTrabajo + "paginas.txt";
     |HAZ GrabaContenido;

     nNume  = #2#1 - 1;

     eaAsigna = "V#ante#";
     eaConten = nNume;
     |HAZ GrabaContenido;

     eaAsigna = "V#actu#";
     eaConten = #2#1;
     |HAZ GrabaContenido;

     eaAsigna = "C#ejercicio#";
     |HAZ GrabaContenido;

     eaAlfa   = #2#2;       |HAZ QuitaRarosDSXML;
     eaAsigna = "C#empresa#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     aQueQuiero = "|NC";
     aAlfa      = #910#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     enSwTrata = 1;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #910#aQueQuiero#;  |QBF eaAsigna;
           |SI #910nCampo ! 0;
               |SI nCampo ] 111;  |Y nCampo [ 116;
                   eaConten = #910nCampo;
               |SINO;
                   enCanti  = #910nCampo;
                   |HAZ SeparaImporte;
                   eaConten = eaImporte;  |QBT eaConten;
               |FINSI;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO CreaGestion;
     |SI enMensa = 0;
         |SI #1#8 = "S";
             |CONFI "0000NEl informe de gesti¢n ya est  creado, desea crearlo de nuevo";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;

         |PINTA #2#8;

         nNume = #1#6 + 1;
         |SI nNume ! #2#8;
             |CONFI "0000SPrimer N£m. P g. no es consecutivo con las p ginas de la Memoria. Modificar S/N";
             |SI FSalida = 0;
                 #2#8 = nNume; |PINTA #2#8;
             |FINSI;
         |FINSI;
     |SINO;
          #2#8 = #1#6 + 1;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     aAlfa = aBase + "word/gestion/" + (("00000" + #2#0) % -105) + "/" + "gesti001.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;
         eaDirSerDoc    = aBase  + "word/gestion/" + (("00000" + #2#0) % -105) + "/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/gestion/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaPlanillaTra  = "gesti001.doc";
     eaFicheroTxt   = "wgestio.txt";
     eaFicheroTra   = "wgestio.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaModoPresenta = "";

     eaOrigen       = eaDirSerDoc  + eaPlanillaTra;
     eaDestino      = eaDirTrabajo + eaFicheroPla;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroPla;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |SI enMensa = 0;
             aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
             |MENAV aAlfa;
         |FINSI;

         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroPla + "#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |HAZ Formulas;
     |HAZ CargaVarGestion;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     aAlfa = eaDirTrabServi + eaFicheroTxt;
     |FBORRA aAlfa;

     |HAZ AbreWordExterno;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + "wgestio.doc";
     |HAZ RecibeFichero;

     |RFBORRA aAbre;

     aAbre = eaDirGuarda + "wgestio.doc";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aCarac10 = &10;
     aCarac13 = &13;
     aPag     = "";
     aPag1    = "";
     aPag2    = "";

     aAbre = eaDirTrabajo + "paginas.txt";
     |XABRE "ABC", aAbre, nHandle;
     |PARA;  |SI  FSalida ] 0;  |HACIENDO;
          |XLEE nHandle, 1, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          |SI aAlfa = aCarac10;  |O aAlfa = aCarac13;
              |SI aPag ! "";
                  |SI aPag1 = "";
                      aPag1 = aPag;
                  |SINO;
                      aPag2 = aPag;
                  |FINSI;
              |FINSI;
              aPag = "";
          |SINO;
              aPag = aPag + aAlfa;
         |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     |RFBORRA aAbre;

     #1#8  = "S";
     #1#9  = aPag1;
     #1#10 = aPag2;

     |ABRE #800;
     #800#0 = #1#0;
     #800#1 = #1#1;
     |LEE 101#800=;
     |SI FSalida ! 0;
         |DDEFECTO #800;
         #800#0 = #1#0;
         #800#1 = #1#1;
         |GRABA 020#800b;
     |FINSI;

     #800#2 = #1#2;
     #800#3 = #1#5;
     #800#4 = #1#6;
     #800#5 = #1#9;
     #800#6 = #1#10;

     |GRABA 020#800a;
     |LIBERA #800;
     |CIERRA #800;

     |ABRE #801;
     #801#0 = #1#0;
     #801#1 = #1#1;
     #801#2 = "wgestio.doc";
     |LEE 101#801=;
     |SI FSalida ! 0;
         |DDEFECTO #801;
         #801#0 = #1#0;
         #801#1 = #1#1;
         #801#2 = "wgestio.doc";
         |GRABA 020#801b;
     |FINSI;

     #801#3 = "INFORME DE GESTION";
     #801#4 = ~;
     |HORA aHora;
     #801#5 = aHora % 102;
     #801#6 = aHora % 402;

     |GRABA 020#801a;
     |LIBERA #801;
     |CIERRA #801;

     |HAZ FinVentanaTrabajo;

     |SI enMensa = 0;
         |MENAV "0000El informe de gesti¢n ha sido creado.";
     |FINSI;

     |SI #1#11 = "S";
         nNume = #1#39;
         |SI #1#6  ! 0;  nNume = #1#6;   |FINSI;
         |SI #1#10 ! 0;  nNume = #1#10;  |FINSI;
         |SI enMensa = 0;
             |SI nNume ! #1#39;
                 |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
             |FINSI;
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO VisualizaGestion;
     |PINTA #2#8;
     nNume = #1#6 + 1;
     |SI nNume ! #2#8;
         |CONFI "0000SPrimer N£m. P g. no es consecutivo con las p ginas de la Memoria. Modificar S/N";
         |SI FSalida = 0;
             #2#8 = nNume; |PINTA #2#8;
         |FINSI;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wgestio.txt";
     eaFicheroTra   = "wgestio.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaPag1 = ""; |SI #2#8 ! #1#9; eaPag1 = #2#8; |FINSI;
     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     eaPag1 = #2#8;
     |HAZ QuentaPagDocumento;
     #1#9  = eaPag1;
     #1#10 = eaPag2;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |RFBORRA aAbre;

     |HAZ FinVentanaTrabajo;

     eaPag1 = "";
     eaPag2 = "";

     |SI #1#11 = "S";
         nNume = #1#39;
         |SI #1#6  ! 0;  nNume = #1#6;   |FINSI;
         |SI #1#10 ! 0;  nNume = #1#10;  |FINSI;
         |SI nNume ! #1#39;
             |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO GestionPDF;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #2#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wgestio.txt";
     eaFicheroTra   = "wgestio.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #2#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #2#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "I#2#dspdf#2";

     |HAZ InstalaDSPDF;

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + "#" + eaDirTrabajo + "GESTION.DOC" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |XCIERRA enHandleTxt;

     eaOrigen       = eaDirTrabServi + eaFicheroTxt;
     eaDestino      = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |HAZ FinVentanaTrabajo;

     aAlfa = eaDirTrabajo + eaFicheroTra;   |RFBORRA aAlfa;
     aAlfa = eaDirTrabajo + "GESTION.DOC";  |RFBORRA aAlfa;

     |PULSATECLA;
|FPRC;

|PROCESO EditaGestiPatron;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/gestion/";
         eaDirGuarda    = aBase  + "word/gestion/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/gestion/" + (("00000" + #2#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/gestion/" + (("00000" + #2#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "gesti001.txt";
     eaFicheroTra   = "gesti001.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO PersonalizaGestion;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/gestion/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "gesti001.txt";
     eaFicheroTra   = "gesti001.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "word/gestion/";
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAlfa     = aBase  + "word/gestion/" + (("00000" + #2#0) % -105);
     |MKDIR aAlfa;

     eaDirGuarda = aBase  + "word/gestion/" + (("00000" + #2#0) % -105) + "/";
     eaOrigen    = aAbre;
     eaDestino   = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;
