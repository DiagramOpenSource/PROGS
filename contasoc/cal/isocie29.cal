|FICHEROS;
     isocie29 #0;
     isocie46 #1;
     isocie59 #5;
     isom0001 #101;
     isw00002 #2,MANTE;
     isw00003 #3,MANTE;
     isw00004 #4,MANTE;
     isw00001 #6,MANTE;
|FIN;

|VARIABLES;
     aTecla     = "";

     Modo       = 0;
     Error      = 0;
     CampoBase  = 0;
     CampoResul = 0;
     CampoHasta = 0;
     CampoResto = 0;
     CampoPorc1 = 0;
     CampoPorc2 = 0;
     nTope      = 0;
     nCampo1    = 0;
     nCampo2    = 0;
     nCampo3    = 0;
     nCampo4    = 0;
     nCampo5    = 0;

     &empresa   = 0;
     &anyo      = 0;
     &modo      = 4;
     &EURODB    = 0;
|FIN;

|PROCESO TipoA;
     |PINPA #0#2;

     #2#0  = #0#3;    || Base 1§ Pago
     #2#1  = #0#4;    || Base 2§ Pago
     #2#2  = #0#5;    || Base 3§ Pago
     #2#3  = #0#6;    || A Ingresar 1§ Pago
     #2#4  = #0#7;    || A Ingresar 2§ Pago
     #2#5  = #0#8;    || A Ingresar 3§ Pago
     #2#6  = #0#9;    || Fecha Ingreso 1§ Pago
     #2#7  = #0#10;   || Fecha Ingreso 2§ Pago
     #2#8  = #0#11;   || Fecha Ingreso 3§ Pago
     #2#9  = #0#32;   || Porcentaje 1§ Pago
     #2#10 = #0#33;   || Porcentaje 2§ Pago
     #2#11 = #0#34;   || Porcentaje 3§ Pago
     #2#12 = #0#65;   || Justificante Anterior  1§ Pago
     #2#13 = #0#66;   || Justificante Anterior  2§ Pago
     #2#14 = #0#67;   || Justificante Anterior  3§ Pago
     #2#15 = #0#50;   || Declaracion Anterior   1§ Pago
     #2#16 = #0#51;   || Declaracion Anterior   2§ Pago
     #2#17 = #0#52;   || Declaracion Anterior   3§ Pago

     |PINDA #0#2;

     |SI Modo ! 4;
         |ENDATOS #1#2;
         |SI FSalida = 0;
             #0#3  = #2#0;    || Base 1§ Pago
             #0#4  = #2#1;    || Base 2§ Pago
             #0#5  = #2#2;    || Base 3§ Pago
             #0#6  = #2#3;    || A Ingresar 1§ Pago
             #0#7  = #2#4;    || A Ingresar 2§ Pago
             #0#8  = #2#5;    || A Ingresar 3§ Pago
             #0#9  = #2#6;    || Fecha Ingreso 1§ Pago
             #0#10 = #2#7;    || Fecha Ingreso 2§ Pago
             #0#11 = #2#8;    || Fecha Ingreso 3§ Pago
             #0#32 = #2#9;    || Porcentaje 1§ Pago
             #0#33 = #2#10;   || Porcentaje 2§ Pago
             #0#34 = #2#11;   || Porcentaje 3§ Pago
             #0#65 = #2#12;   || Justificante Anterior  1§ Pago
             #0#66 = #2#13;   || Justificante Anterior  2§ Pago
             #0#67 = #2#14;   || Justificante Anterior  3§ Pago
             #0#50 = #2#15;   || Declaracion Anterior   1§ Pago
             #0#51 = #2#16;   || Declaracion Anterior   2§ Pago
             #0#52 = #2#17;   || Declaracion Anterior   3§ Pago
         |SINO;
             Error = 1;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
|FPRC;

|PROCESO TipoB1;
     |PINPA #0#3;

     #3#0  = #0#12;    || Base 1§ Pago
     #3#1  = #0#13;    || Base 2§ Pago
     #3#2  = #0#14;    || Base 3§ Pago
     #3#3  = #0#15;    || Resultado 1§ Pago
     #3#4  = #0#16;    || Resultado 2§ Pago
     #3#5  = #0#17;    || Resultado 3§ Pago
     #3#6  = #0#18;    || Retenciones 1§ Pago
     #3#7  = #0#19;    || Retenciones 2§ Pago
     #3#8  = #0#20;    || Retenciones 3§ Pago
     #3#9  = #0#21;    || Pagos Anteriores 1§ Pago
     #3#10 = #0#22;    || Pagos Anteriores 2§ Pago
     #3#11 = #0#23;    || Pagos Anteriores 3§ Pago
     #3#12 = #0#24;    || A Ingresar 1§ Pago
     #3#13 = #0#25;    || A Ingresar 2§ Pago
     #3#14 = #0#26;    || A Ingresar 3§ Pago
     #3#15 = #0#27;    || Fecha Emision 1§ Pago
     #3#16 = #0#28;    || Fecha Emision 2§ Pago
     #3#17 = #0#29;    || Fecha Emision 3§ Pago
     #3#18 = #0#32;    || Porcentaje 1§ Pago
     #3#19 = #0#33;    || Porcentaje 2§ Pago
     #3#20 = #0#34;    || Porcentaje 3§ Pago
     #3#21 = #0#65;    || Justificante Anterior  1§ Pago
     #3#22 = #0#66;    || Justificante Anterior  2§ Pago
     #3#23 = #0#67;    || Justificante Anterior  3§ Pago
     #3#24 = #0#47;    || Bonificaciones         1§ Pago
     #3#25 = #0#48;    || Bonificaciones         2§ Pago
     #3#26 = #0#49;    || Bonificaciones         3§ Pago
     #3#27 = #0#50;    || Declaracion Anterior   1§ Pago
     #3#28 = #0#51;    || Declaracion Anterior   2§ Pago
     #3#29 = #0#52;    || Declaracion Anterior   3§ Pago

     |PINDA #0#3;

     |SI Modo ! 4;
         |ENDATOS #1#3;
         |SI FSalida = 0;
             #0#12 = #3#00;    || Base 1§ Pago
             #0#13 = #3#01;    || Base 2§ Pago
             #0#14 = #3#02;    || Base 3§ Pago
             #0#15 = #3#03;    || Resultado 1§ Pago
             #0#16 = #3#04;    || Resultado 2§ Pago
             #0#17 = #3#05;    || Resultado 3§ Pago
             #0#18 = #3#06;    || Retenciones 1§ Pago
             #0#19 = #3#07;    || Retenciones 2§ Pago
             #0#20 = #3#08;    || Retenciones 3§ Pago
             #0#21 = #3#09;    || Pagos Anteriores 1§ Pago
             #0#22 = #3#10;    || Pagos Anteriores 2§ Pago
             #0#23 = #3#11;    || Pagos Anteriores 3§ Pago
             #0#24 = #3#12;    || A Ingresar 1§ Pago
             #0#25 = #3#13;    || A Ingresar 2§ Pago
             #0#26 = #3#14;    || A Ingresar 3§ Pago
             #0#27 = #3#15;    || Fecha Emision 1§ Pago
             #0#28 = #3#16;    || Fecha Emision 2§ Pago
             #0#29 = #3#17;    || Fecha Emision 3§ Pago
             #0#32 = #3#18;    || Porcentaje 1§ Pago
             #0#33 = #3#19;    || Porcentaje 2§ Pago
             #0#34 = #3#20;    || Porcentaje 3§ Pago
             #0#65 = #3#21;    || Justificante Anterior  1§ Pago
             #0#66 = #3#22;    || Justificante Anterior  2§ Pago
             #0#67 = #3#23;    || Justificante Anterior  3§ Pago
             #0#47 = #3#24;    || Bonificaciones         1§ Pago
             #0#48 = #3#25;    || Bonificaciones         2§ Pago
             #0#49 = #3#26;    || Bonificaciones         3§ Pago
             #0#50 = #3#27;    || Declaracion Anterior   1§ Pago
             #0#51 = #3#28;    || Declaracion Anterior   2§ Pago
             #0#52 = #3#29;    || Declaracion Anterior   3§ Pago
         |SINO;
             Error = 1;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
|FPRC;

|PROCESO TipoB2;
     |PINPA #0#4;

     |SI #0#1 ] 2007;
         |PINTA 1322, "17";
         |PINTA 1522, "21";
     |FINSI;

     #4#0  = #0#12;    || Base 1§ Pago
     #4#1  = #0#13;    || Base 2§ Pago
     #4#2  = #0#14;    || Base 3§ Pago
     #4#3  = #0#15;    || Resultado 1§ Pago
     #4#4  = #0#16;    || Resultado 2§ Pago
     #4#5  = #0#17;    || Resultado 3§ Pago
     #4#6  = #0#18;    || Retenciones 1§ Pago
     #4#7  = #0#19;    || Retenciones 2§ Pago
     #4#8  = #0#20;    || Retenciones 3§ Pago
     #4#9  = #0#21;    || Pagos Anteriores 1§ Pago
     #4#10 = #0#22;    || Pagos Anteriores 2§ Pago
     #4#11 = #0#23;    || Pagos Anteriores 3§ Pago
     #4#12 = #0#24;    || A Ingresar 1§ Pago
     #4#13 = #0#25;    || A Ingresar 2§ Pago
     #4#14 = #0#26;    || A Ingresar 3§ Pago
     #4#15 = #0#27;    || Fecha Emision 1§ Pago
     #4#16 = #0#28;    || Fecha Emision 2§ Pago
     #4#17 = #0#29;    || Fecha Emision 3§ Pago
     #4#18 = #0#35;    || Hasta 1§ Pago
     #4#19 = #0#36;    || Hasta 2§ Pago
     #4#20 = #0#37;    || Hasta 3§ Pago
     #4#21 = #0#38;    || % 21  1§ Pago
     #4#22 = #0#39;    || % 21  2§ Pago
     #4#23 = #0#40;    || % 21  3§ Pago
     #4#24 = #0#41;    || Resto 1§ Pago
     #4#25 = #0#42;    || Resto 2§ Pago
     #4#26 = #0#43;    || Resto 3§ Pago
     #4#27 = #0#44;    || % 25  1§ Pago
     #4#28 = #0#45;    || % 25  1§ Pago
     #4#29 = #0#46;    || % 25  1§ Pago
     #4#30 = #0#65;    || Justificante Anterior  1§ Pago
     #4#31 = #0#66;    || Justificante Anterior  2§ Pago
     #4#32 = #0#67;    || Justificante Anterior  3§ Pago
     #4#33 = #0#47;    || Bonificaciones         1§ Pago
     #4#34 = #0#48;    || Bonificaciones         2§ Pago
     #4#35 = #0#49;    || Bonificaciones         3§ Pago
     #4#36 = #0#50;    || Declaracion Anterior   1§ Pago
     #4#37 = #0#51;    || Declaracion Anterior   2§ Pago
     #4#38 = #0#52;    || Declaracion Anterior   3§ Pago

     |PINDA #0#4;
     |SI Modo ! 4;
         |ENDATOS #1#4;
         |SI FSalida = 0;
             #0#12 = #4#00;    || Base 1§ Pago
             #0#13 = #4#01;    || Base 2§ Pago
             #0#14 = #4#02;    || Base 3§ Pago
             #0#15 = #4#03;    || Resultado 1§ Pago
             #0#16 = #4#04;    || Resultado 2§ Pago
             #0#17 = #4#05;    || Resultado 3§ Pago
             #0#18 = #4#06;    || Retenciones 1§ Pago
             #0#19 = #4#07;    || Retenciones 2§ Pago
             #0#20 = #4#08;    || Retenciones 3§ Pago
             #0#21 = #4#09;    || Pagos Anteriores 1§ Pago
             #0#22 = #4#10;    || Pagos Anteriores 2§ Pago
             #0#23 = #4#11;    || Pagos Anteriores 3§ Pago
             #0#24 = #4#12;    || A Ingresar 1§ Pago
             #0#25 = #4#13;    || A Ingresar 2§ Pago
             #0#26 = #4#14;    || A Ingresar 3§ Pago
             #0#27 = #4#15;    || Fecha Emision 1§ Pago
             #0#28 = #4#16;    || Fecha Emision 2§ Pago
             #0#29 = #4#17;    || Fecha Emision 3§ Pago
             #0#35 = #4#18;    || Hasta 1§ Pago
             #0#36 = #4#19;    || Hasta 2§ Pago
             #0#37 = #4#20;    || Hasta 3§ Pago
             #0#38 = #4#21;    || % 21  1§ Pago
             #0#39 = #4#22;    || % 21  2§ Pago
             #0#40 = #4#23;    || % 21  3§ Pago
             #0#41 = #4#24;    || Resto 1§ Pago
             #0#42 = #4#25;    || Resto 2§ Pago
             #0#43 = #4#26;    || Resto 3§ Pago
             #0#44 = #4#27;    || % 25  1§ Pago
             #0#45 = #4#28;    || % 25  1§ Pago
             #0#46 = #4#29;    || % 25  1§ Pago
             #0#65 = #4#30;    || Justificante Anterior  1§ Pago
             #0#66 = #4#31;    || Justificante Anterior  2§ Pago
             #0#67 = #4#32;    || Justificante Anterior  3§ Pago
             #0#47 = #4#33;    || Bonificaciones         1§ Pago
             #0#48 = #4#34;    || Bonificaciones         2§ Pago
             #0#49 = #4#35;    || Bonificaciones         3§ Pago
             #0#50 = #4#36;    || Declaracion Anterior   1§ Pago
             #0#51 = #4#37;    || Declaracion Anterior   2§ Pago
             #0#52 = #4#38;    || Declaracion Anterior   3§ Pago
         |SINO;
             Error = 1;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
|FPRC;

|PROCESO TipoB3;
     |PINPA #0#6;

     |SI #0#1 ] 2007;
         |PINTA 1522, "12";
     |FINSI;

     #6#0  = #0#53;    || Parte General 1§ Pago
     #6#1  = #0#54;    || Parte General 2§ Pago
     #6#2  = #0#55;    || Parte General 3§ Pago
     #6#3  = #0#56;    || Porcentaje 28 % 1§ Pago
     #6#4  = #0#57;    || Porcentaje 28 % 2§ Pago
     #6#5  = #0#58;    || Porcentaje 28 % 3§ Pago
     #6#6  = #0#59;    || Parte Especial 1§ Pago
     #6#7  = #0#60;    || Parte Especial 2§ Pago
     #6#8  = #0#61;    || Parte Especial 3§ Pago
     #6#9  = #0#62;    || Porcentaje 10 % 1§ Pago
     #6#10 = #0#63;    || Porcentaje 10 % 2§ Pago
     #6#11 = #0#64;    || Porcentaje 10 % 3§ Pago
     #6#12 = #0#68;    || Resultado B3    1§ Pago
     #6#13 = #0#69;    || Resultado B3    1§ Pago
     #6#14 = #0#70;    || Resultado B3    1§ Pago
     #6#15 = #0#47;    || Bonificaciones         1§ Pago
     #6#16 = #0#48;    || Bonificaciones         2§ Pago
     #6#17 = #0#49;    || Bonificaciones         3§ Pago
     #6#18 = #0#18;    || Retenciones 1§ Pago
     #6#19 = #0#19;    || Retenciones 2§ Pago
     #6#20 = #0#20;    || Retenciones 3§ Pago
     #6#21 = #0#50;    || Declaracion Anterior   1§ Pago
     #6#22 = #0#51;    || Declaracion Anterior   2§ Pago
     #6#23 = #0#52;    || Declaracion Anterior   3§ Pago
     #6#24 = #0#21;    || Pagos Anteriores 1§ Pago
     #6#25 = #0#22;    || Pagos Anteriores 2§ Pago
     #6#26 = #0#23;    || Pagos Anteriores 3§ Pago
     #6#27 = #0#24;    || A Ingresar 1§ Pago
     #6#28 = #0#25;    || A Ingresar 2§ Pago
     #6#29 = #0#26;    || A Ingresar 3§ Pago
     #6#30 = #0#27;    || Fecha Emision 1§ Pago
     #6#31 = #0#28;    || Fecha Emision 2§ Pago
     #6#32 = #0#29;    || Fecha Emision 3§ Pago
     #6#33 = #0#65;    || Justificante Anterior  1§ Pago
     #6#34 = #0#66;    || Justificante Anterior  2§ Pago
     #6#35 = #0#67;    || Justificante Anterior  3§ Pago

     |PINDA #0#6;
     |SI Modo ! 4;
         |ENDATOS #1#6;
         |SI FSalida = 0;
             #0#53 = #6#0;    || Parte General 1§ Pago
             #0#54 = #6#1;    || Parte General 2§ Pago
             #0#55 = #6#2;    || Parte General 3§ Pago
             #0#56 = #6#3;    || Porcentaje 28 % 1§ Pago
             #0#57 = #6#4;    || Porcentaje 28 % 2§ Pago
             #0#58 = #6#5;    || Porcentaje 28 % 3§ Pago
             #0#59 = #6#6;    || Parte Especial 1§ Pago
             #0#60 = #6#7;    || Parte Especial 2§ Pago
             #0#61 = #6#8;    || Parte Especial 3§ Pago
             #0#62 = #6#9;    || Porcentaje 10 % 1§ Pago
             #0#63 = #6#10;   || Porcentaje 10 % 2§ Pago
             #0#64 = #6#11;   || Porcentaje 10 % 3§ Pago
             #0#68 = #6#12;   || Resultado B3    1§ Pago
             #0#69 = #6#13;   || Resultado B3    1§ Pago
             #0#70 = #6#14;   || Resultado B3    1§ Pago
             #0#47 = #6#15;   || Bonificaciones         1§ Pago
             #0#48 = #6#16;   || Bonificaciones         2§ Pago
             #0#49 = #6#17;   || Bonificaciones         3§ Pago
             #0#18 = #6#18;   || Retenciones 1§ Pago
             #0#19 = #6#19;   || Retenciones 2§ Pago
             #0#20 = #6#20;   || Retenciones 3§ Pago
             #0#50 = #6#21;   || Declaracion Anterior   1§ Pago
             #0#51 = #6#22;   || Declaracion Anterior   2§ Pago
             #0#52 = #6#23;   || Declaracion Anterior   3§ Pago
             #0#21 = #6#24;   || Pagos Anteriores 1§ Pago
             #0#22 = #6#25;   || Pagos Anteriores 2§ Pago
             #0#23 = #6#26;   || Pagos Anteriores 3§ Pago
             #0#24 = #6#27;   || A Ingresar 1§ Pago
             #0#25 = #6#28;   || A Ingresar 2§ Pago
             #0#26 = #6#29;   || A Ingresar 3§ Pago
             #0#27 = #6#30;   || Fecha Emision 1§ Pago
             #0#28 = #6#31;   || Fecha Emision 2§ Pago
             #0#29 = #6#32;   || Fecha Emision 3§ Pago
             #0#65 = #6#33;   || Justificante Anterior  1§ Pago
             #0#66 = #6#34;   || Justificante Anterior  2§ Pago
             #0#67 = #6#35;   || Justificante Anterior  3§ Pago
         |SINO;
             Error = 1;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
|FPRC;

|PROCESO TiposConsul;  |TIPO 13;
     |SI #0#0 = 1; |Y #0#1 = 1900; |ACABA; |FINSI;
     Modo = (FEntrada / 100) ! 0;
     |SI Modo ! 4; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |ATRI I;
     |PINTA #0#0;
     |PINTA #0#1;
     |PINTA #0#2;
     |PINTA #0#30;
     |ATRI 0;
     |SI #0#30 = 1;  |HAZ TipoA;   |FINSI;
     |SI #0#30 = 2;  |HAZ TipoB1;  |FINSI;
     |SI #0#30 = 3;  |HAZ TipoB2;  |FINSI;
     |SI #0#30 = 4;  |HAZ TipoB3;  |FINSI;
     |POPV;
|FPRC;

|PROCESO Tipos; |TIPO 12;
     |SI FSalida = 1; |O FSalida = 7;  |ACABA;  |FINSI;

     Modo = (FEntrada / 100) ! 0;
     |SI Modo = 4; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |SI Error = 1;  Error = 0;  |ACABA;  |FINSI;
     Error = 0;
     |SI #0#30 = 1;  |HAZ TipoA;   |FINSI;
     |SI #0#30 = 2;  |HAZ TipoB1;  |FINSI;
     |SI #0#30 = 3;  |HAZ TipoB2;  |FINSI;
     |SI #0#30 = 4;  |HAZ TipoB3;  |FINSI;
     |SI Error = 1;  |ERROR;  |FINSI;
     |POPV;
|FPRC;

|PROCESO NoTocar; |TIPO 7;
     Modo = (FEntrada / 100) ! 0;
     |C_M #0#30, 1, "S";
     |SI Modo ! 1;  |C_M #0#30, 1, "N";  |FINSI;
|FPRC;

******************** Procesos del isw00002

|PROCESO CalcuTipoA;
     |SI Campo = 9;  |O Campo = 15;
         nCampo1  = 12;
         nCampo2  = 0;
         nCampo3  = 9;
         nCampo4  = 15;
         nCampo5  = 3;
     |FINSI;

     |SI Campo = 10;  |O Campo = 16;
         nCampo1  = 13;
         nCampo2  = 1;
         nCampo3  = 10;
         nCampo4  = 16;
         nCampo5  = 4;
     |FINSI;

     |SI Campo = 11;  |O Campo = 17;
         nCampo1  = 14;
         nCampo2  = 2;
         nCampo3  = 11;
         nCampo4  = 17;
         nCampo5  = 5;
     |FINSI;

     |SI #2nCampo1 = "                ";
         |C_M #2nCampo4, 1, "N";
         #2nCampo4 = 0;
     |SINO;
         |C_M #2nCampo4, 1, "S";
     |FINSI;

     #2nCampo5 = (#2nCampo2 % #2nCampo3) - #2nCampo4;

     |PINTA #2nCampo4;
     |PINTA #2nCampo5;
|FPRC;

******************** Procesos del isw00003

|PROCESO PonPorce;  |TIPO 7;
     |SI Modo ! 1;    |ACABA;  |FINSI;
     |SI #0#1 < 1995; |ACABA;  |FINSI;

     |SI #0#1 [ 2007;
         |SI #0#1 [ 1996;
             |ABRE #1;
             #1#0 = #0#0;
             #1#1 = #0#1 - 1;
             |LEE 040#1=;
             |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
             |CIERRA #1;

             |SI #3#18 = 0;  #3#18 = (#1#14 * 4) / 7;  |FINSI;
             |SI #3#19 = 0;  #3#19 = (#1#14 * 4) / 7;  |FINSI;
             |SI #3#20 = 0;  #3#20 = (#1#14 * 4) / 7;  |FINSI;
         |SINO;
             |ABRE #5;
             #5#0 = #0#0;
             #5#1 = #0#1 - 1;
             |LEE 040#5=;
             |SI FSalida ! 0; |DDEFECTO #5; |FINSI;
             |CIERRA #5;

             |SI #3#18 = 0;  #3#18 = (#5#47 * 4) / 7;  |FINSI;
             |SI #3#19 = 0;  #3#19 = (#5#47 * 4) / 7;  |FINSI;
             |SI #3#20 = 0;  #3#20 = (#5#47 * 4) / 7;  |FINSI;
         |FINSI;
    |SINO;
         |ABRE #101;
         |SELECT #2#101;
         #101#0 = #0#0;
         #101#1 = #0#1 - 1;
         #101#3 = "558";
         |LEE 040#101=;
         |SI FSalida ! 0; |DDEFECTO #101; |FINSI;
         |CIERRA #101;

         |SI #3#18 = 0;  #3#18 = (#101#5 * 4) / 7;  |FINSI;
         |SI #3#19 = 0;  #3#19 = (#101#5 * 4) / 7;  |FINSI;
         |SI #3#20 = 0;  #3#20 = (#101#5 * 4) / 7;  |FINSI;
    |FINSI;

    |PINTA #3#18;
    |PINTA #3#19;
    |PINTA #3#20;
|FPRC;

|PROCESO CalcuTipoB1;
     CampoBase  = Campo - 18;
     CampoResul = Campo - 15;
     #3CampoResul = #3CampoBase % #3Campo;

     |C_M #3#27, 1, "S";
     |C_M #3#28, 1, "S";
     |C_M #3#29, 1, "S";

     |SI #3#21 = "                ";  |C_M #3#27, 1, "N";  #3#27 = 0;  |FINSI;
     |SI #3#22 = "                ";  |C_M #3#28, 1, "N";  #3#28 = 0;  |FINSI;
     |SI #3#23 = "                ";  |C_M #3#29, 1, "N";  #3#29 = 0;  |FINSI;

     |PINTA #3CampoResul;
     |PINTA #3#27;
     |PINTA #3#28;
     |PINTA #3#29;
|FPRC;

|PROCESO ResulTipoB1;
     #3#12 = #3#3 - #3#24 - #3#6 - #3#27 - #3#9;
     |SI #3#12 < 0;  #3#12 = 0;  |FINSI;
     |PINTA #3#12;

     #3#10 = #3#12; |PINTA #3#10;

     #3#13 = #3#4 - #3#25 - #3#7 - #3#28 - #3#10;
     |SI #3#13 < 0;  #3#13 = 0;  |FINSI;
     |PINTA #3#13;

     #3#11 = #3#12 + #3#13;        |PINTA #3#11;

     #3#14 = #3#5 - #3#26 - #3#8 - #3#29 - #3#11;
     |SI #3#14 < 0;  #3#14 = 0;  |FINSI;
     |PINTA #3#14;
|FPRC;

******************** Procesos del isw00004

|PROCESO Reparte;  |TIPO 0;
     |SI Campo [ 2;
         CampoBase  = Campo;
         CampoHasta = Campo + 18;
         CampoResto = Campo + 24;
         CampoPorc1 = Campo + 21;
         CampoPorc2 = Campo + 27;
         CampoResul = Campo + 3;
     |SINO;
         CampoBase  = Campo - 18;
         CampoHasta = Campo;
         CampoResto = Campo + 6;
         CampoPorc1 = Campo + 3;
         CampoPorc2 = Campo + 9;
         CampoResul = Campo - 15;
     |FINSI;

     anyo = #0#1;
     nTope = 15000000; |SI anyo ] 2005; nTope = 20000000; |FINSI;
     |SI EURODB ! 0;
         nTope = (nTope / 166.386) ! EURODB;
         |SI anyo ] 2005; nTope = nTope - 0.01; |FINSI;
     |FINSI;

     |SI #4CampoHasta = 0; |O Campo = CampoBase;
         nTope = 15000000; |SI anyo ] 2005; nTope = 20000000; |FINSI;
         |SI EURODB ! 0;
             nTope = (nTope / 166.386) ! EURODB;
            |SI anyo ] 2005; nTope = nTope - 0.01; |FINSI;
         |FINSI;
     |SINO;
         nTope = #4CampoHasta;
     |FINSI;

     |SI #4CampoBase > nTope;
         #4CampoHasta = nTope;
         #4CampoResto = #4CampoBase - nTope;
     |SINO;
         #4CampoHasta = #4CampoBase;
         #4CampoResto = 0;
     |FINSI;

     |SI anyo [ 2006;
         #4CampoPorc1 = #4CampoHasta % 21;
         #4CampoPorc2 = #4CampoResto % 25;
     |SINO;
         #4CampoPorc1 = #4CampoHasta % 17;
         #4CampoPorc2 = #4CampoResto % 21;
     |FINSI;

     #4CampoResul = #4CampoPorc1 + #4CampoPorc2;

     |C_M #4#36, 1, "S";
     |C_M #4#37, 1, "S";
     |C_M #4#38, 1, "S";

     |SI #4#30 = "                ";  |C_M #4#36, 1, "N";  #4#36 = 0;  |FINSI;
     |SI #4#31 = "                ";  |C_M #4#37, 1, "N";  #4#37 = 0;  |FINSI;
     |SI #4#32 = "                ";  |C_M #4#38, 1, "N";  #4#38 = 0;  |FINSI;

     |PINTA #4CampoBase;
     |PINTA #4CampoHasta;
     |PINTA #4CampoResto;
     |PINTA #4CampoPorc1;
     |PINTA #4CampoPorc2;
     |PINTA #4CampoResul;
     |PINTA #4#36;
     |PINTA #4#37;
     |PINTA #4#38;
|FPRC;

|PROCESO ResulTipoB2;
     #4#12 = #4#3 - #4#33 - #4#6 - #4#36 - #4#9;
     |SI #4#12 < 0;  #4#12 = 0;  |FINSI;
     #4#10 = #4#12;

     #4#13 = #4#4 - #4#34 - #4#7 - #4#37 - #4#10;
     |SI #4#13 < 0;  #4#13 = 0;  |FINSI;
     #4#11 = #4#12 + #4#13;

     #4#14 = #4#5 - #4#35 - #4#8 - #4#38 - #4#11;
     |SI #4#14 < 0;  #4#14 = 0;  |FINSI;

     |PINTA #4#10;
     |PINTA #4#11;
     |PINTA #4#12;
     |PINTA #4#13;
     |PINTA #4#14;
|FPRC;

******************** Procesos del isw00001

|PROCESO ResulTipoB3;
     |C_M #6#21, 1, "S";
     |C_M #6#22, 1, "S";
     |C_M #6#23, 1, "S";

     |SI #6#33 = "                ";  |C_M #6#21, 1, "N";  #6#21 = 0;  |FINSI;
     |SI #6#34 = "                ";  |C_M #6#22, 1, "N";  #6#22 = 0;  |FINSI;
     |SI #6#35 = "                ";  |C_M #6#23, 1, "N";  #6#23 = 0;  |FINSI;

     #6#3  = #6#0 % 28;
     #6#4  = #6#1 % 28;
     #6#5  = #6#2 % 28;

     |SI #0#1 [ 2006;
         |C_M #6#9,   1, "N";
         |C_M #6#10,  1, "N";
         |C_M #6#11,  1, "N";

         #6#9  = #6#6 % 10;
         #6#10 = #6#7 % 10;
         #6#11 = #6#8 % 10;
     |SINO;
         |C_M #6#9,  1, "S";
         |C_M #6#10, 1, "S";
         |C_M #6#11, 1, "S";

         |SI #6#9  = 0;  #6#9  = #6#6 % 12;  |FINSI;
         |SI #6#10 = 0;  #6#10 = #6#7 % 12;  |FINSI;
         |SI #6#11 = 0;  #6#11 = #6#8 % 12;  |FINSI;
     |FINSI;

     #6#12 = #6#3 + #6#9;
     #6#13 = #6#4 + #6#10;
     #6#14 = #6#5 + #6#11;

     #6#27 = #6#12 - #6#15 - #6#18 - #6#21 - #6#24;
     |SI #6#27 < 0;  #6#27 = 0;  |FINSI;

     #6#25 = #6#27;

     #6#28 = #6#13 - #6#16 - #6#19 - #6#22 - #6#25;
     |SI #6#28 < 0;  #6#28 = 0;  |FINSI;

     #6#26 = #6#27 + #6#28;

     #6#29 = #6#14 - #6#17 - #6#20 - #6#23 - #6#26;
     |SI #6#29 < 0;  #6#29 = 0;  |FINSI;

     |PINDA #0#6;
|FPRC;

******************** Procesos Comunes del isw00002, isw00003, isw00004, isw00001

|PROCESO PantaLiqui; |TIPO 0;
     |SI FSalida ! 9; |ACABA; |FINSI;

     empresa = #0#0;
     anyo    = #0#1;
     |SUB_EJECUTA "ispant32.run";
     |PTEC 808;
|FPRC;
