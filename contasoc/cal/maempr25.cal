E|FICHEROS;
     maempr25;
|FIN;

|VARIABLES;
     nOk       = 0;
     nEstado   = 0;
     aAlfa     = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nNume1    = 0;
     nVariable = 0;
     nInkey    = 0;

  {30}aPopup        = "";
     aContenido     = "";
     aID            = "";
     nID            = 0;

     &empresa   = 0;
     &anyo      = 0;
     &modo      = 0;

     &enTotalVaria  = 0;
     &eaNombreList  = "";
     &enCuadroIni   = 0;
     &enCuadroFin   = 0;
     &enCampoAncho  = 0;
     &enModoEdita   = 0;

{101}&epPuntEdita   = "";
|FIN;

|CALCULO Tipo0C2; |TIPO 0;
     |SI #maempr25#2 = "S";
         aAlfa = "S";
     |SINO;
         aAlfa = "N";
         |PDEFECTO #maempr25, 3,19;
     |FINSI;
     |C_M #maempr25#3,  1, aAlfa; |PINTA #maempr25#3;
                                  |PINTA #maempr25#4;
     |C_M #maempr25#5,  1, aAlfa; |PINTA #maempr25#5;
     |C_M #maempr25#6,  1, aAlfa; |PINTA #maempr25#6;
     |C_M #maempr25#7,  1, aAlfa; |PINTA #maempr25#7;
     |C_M #maempr25#8,  1, aAlfa; |PINTA #maempr25#8;
     |C_M #maempr25#9,  1, aAlfa; |PINTA #maempr25#9;
     |C_M #maempr25#10, 1, aAlfa; |PINTA #maempr25#10;
     |C_M #maempr25#11, 1, aAlfa; |PINTA #maempr25#11;
     |C_M #maempr25#12, 1, aAlfa; |PINTA #maempr25#12;
     |C_M #maempr25#13, 1, aAlfa; |PINTA #maempr25#13;
     |C_M #maempr25#14, 1, aAlfa; |PINTA #maempr25#14;
     |C_M #maempr25#15, 1, aAlfa; |PINTA #maempr25#15;
     |C_M #maempr25#16, 1, aAlfa; |PINTA #maempr25#16;
     |C_M #maempr25#17, 1, aAlfa; |PINTA #maempr25#17;
     |C_M #maempr25#18, 1, aAlfa; |PINTA #maempr25#18;
|FCAL;

|CALCULO Tipo66C3; |TIPO 66;
     aAlfa = "|C003WID";
     aID   = #maempr25#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 6;
     aPopup3  = "                  ";
     aPopup4  = "1 - Municipal     ";
     aPopup5  = "2 - Provincial    ";
     aPopup6  = "3 - Autonomico    ";
     aPopup7  = "4 - Nacional      ";
     aPopup8  = "5 - Internacional ";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;  #maempr25#3 = aAlfa;
         aAlfa = aPopup % 580;  #maempr25#4 = aAlfa;
     |FINSI;

     |PINTA #maempr25#3;
     |PINTA #maempr25#4;
|FCAL;

|CALCULO Tipo0C3; |TIPO 0;
     |C_M #maempr25#Campo#,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     nOk = 0;
     |SI #maempr25#3 = "1"; #maempr25#4 = "Municipal     "; nOk = 1; |FINSI;
     |SI #maempr25#3 = "2"; #maempr25#4 = "Provincial    "; nOk = 1; |FINSI;
     |SI #maempr25#3 = "3"; #maempr25#4 = "Autonomico    "; nOk = 1; |FINSI;
     |SI #maempr25#3 = "4"; #maempr25#4 = "Nacional      "; nOk = 1; |FINSI;
     |SI #maempr25#3 = "5"; #maempr25#4 = "Internacional "; nOk = 1; |FINSI;

     |SI nOk = 0;
         |MENAV "0000 Opcion incorrecta";
         |ERROR;
     |SINO;
         |PINTA #maempr25#4;
     |FINSI;

     |C_M #maempr25#5, 1, "N";
     |C_M #maempr25#6, 1, "N";
     |C_M #maempr25#7, 1, "N";
     |SI #maempr25#3 = 5;
         |C_M #maempr25#5, 1, "S";
         #maempr25#6 = ""; |PINTA #maempr25#6;
         #maempr25#7 = ""; |PINTA #maempr25#7;
     |FINSI;
     |SI #maempr25#3 = 2;
         |C_M #maempr25#6, 1, "S";
         #maempr25#5 = ""; |PINTA #maempr25#5;
         #maempr25#7 = ""; |PINTA #maempr25#7;
     |FINSI;
     |SI #maempr25#3 = 3; |O #maempr25#3 = 4;
         #maempr25#5 = ""; |PINTA #maempr25#5;
         #maempr25#6 = ""; |PINTA #maempr25#6;
         #maempr25#7 = ""; |PINTA #maempr25#7;
     |FINSI;
     |SI #maempr25#3 = 1;
         |C_M #maempr25#7, 1, "S";
         #maempr25#5 = ""; |PINTA #maempr25#5;
         #maempr25#6 = ""; |PINTA #maempr25#6;
     |FINSI;
|FCAL;

|CALCULO Tipo0C9; |TIPO 0;
     |C_M #maempr25#Campo#,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     aAlfa = "S";
     |SI #maempr25#9 = "S";
         aAlfa = "N";
         |PDEFECTO #maempr25, 10,19;
     |FINSI;
     |C_M #maempr25#10, 1, aAlfa; |PINTA #maempr25#10;
     |C_M #maempr25#11, 1, aAlfa; |PINTA #maempr25#11;
     |C_M #maempr25#12, 1, aAlfa; |PINTA #maempr25#12;
     |C_M #maempr25#13, 1, aAlfa; |PINTA #maempr25#13;
     |C_M #maempr25#14, 1, aAlfa; |PINTA #maempr25#14;
     |C_M #maempr25#15, 1, aAlfa; |PINTA #maempr25#15;
     |C_M #maempr25#16, 1, aAlfa; |PINTA #maempr25#16;
     |C_M #maempr25#17, 1, aAlfa; |PINTA #maempr25#17;
     |C_M #maempr25#18, 1, aAlfa; |PINTA #maempr25#18;
|FCAL;

|CALCULO Tipo0C10; |TIPO 0;
     |C_M #maempr25#Campo#,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     aAlfa = "S";
     |SI #maempr25#10 = "X";
         aAlfa = "N";
         #maempr25#11 = 0; |PINTA #maempr25#11;
         #maempr25#12 = 0; |PINTA #maempr25#12;
     |FINSI;
     |C_M #maempr25#11, 1, aAlfa;
     |C_M #maempr25#12, 1, aAlfa;
|FCAL;

|CALCULO Tipo0C11y12; |TIPO 0;
     |C_M #maempr25#Campo#,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI FSalida = 2; |ACABA; |FINSI;

     |SI #maempr25#Campo# = 0;
         |MENAV "0000Debe informar los dos importes o marcar la casilla Incuantificable";
         |ERROR;
     |FINSI;
|FCAL;

|CALCULO Tipo7C5a7; |TIPO 7;
     |C_M #maempr25#Campo#,0,aAlfa;
     |SI aAlfa = "N"; |ACABA; |FINSI;

     |SI Campo = 7; aAlfa = "MUNICIPIOS"; |FINSI;
     |SI Campo = 6; aAlfa = "PROVINCIAS"; |FINSI;
     |SI Campo = 5; aAlfa = "PAISES";     |FINSI;

     |HAZ HazEdita;
     #maempr25#Campo# = aAlfa;
     |PINTA #maempr25#Campo#;
     |SI nInkey = 2;
         |PTEC 808;
         nInkey = 0;
     |SINO;
         |PTEC 802;
     |FINSI;
|FCAL;

|CALCULO Tipo0C5a7; |TIPO 0;
     |SI FSalida = 2; |ACABA; |FINSI;

     nOk = 0;
     aAlfa= #maempr25#Campo#; |QBF aAlfa;
     |SI Campo = 5; |Y aAlfa = ""; |Y #maempr25#3 = 5; nOk = 1; |FINSI;
     |SI Campo = 6; |Y aAlfa = ""; |Y #maempr25#3 = 2; nOk = 1; |FINSI;
     |SI Campo = 7; |Y aAlfa = ""; |Y #maempr25#3 = 1; nOk = 1; |FINSI;
     |SI nOk = 1;
         |MENAV "0000Campo Obligatorio. Rellene los datos";
         |ERROR;
     |FINSI;
|FCAL;

|CALCULO Tipo0C8; |TIPO 0;
     |SI FSalida = 2;
         nInkey = 2;
     |SINO;
         nInkey = 0;
     |FINSI;
|FCAL;

|PROCESO HazEdita;
     enTotalVaria  = 5;
     eaNombreList  = "";
     enCuadroIni   = 1129;
     enCuadroFin   = 1678;
     enCampoAncho  = 50;
     enModoEdita   = 0;

     aAlfa1 = #maempr25#Campo#;
     |PARA nVariable = 1;  |SI nVariable [ 5;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           nNume1 = (1 + 50 * (nVariable - 1));
           nNume1 = nNume1 * 100 + 50;
           aAlfa2 = aAlfa1 % nNume1; |QBF aAlfa2;
           epPuntEdita  = aAlfa2;
     |SIGUE;

     |PUSHV  0501 2380;
     |BLANCO 0928 1779;
     |CUADRO 0928 1779;
     |ATRI S;  |PINTA 1030, aAlfa;  |ATRI s;

     |HAZ Edita;
     |POPV;

     aAlfa = "";
     |PARA nVariable = 1;  |SI nVariable [ 5;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           aAlfa = aAlfa + epPuntEdita;
     |SIGUE;
|FPRC;

|PROGRAMA;
     |ABRE #maempr25;
     |DDEFECTO #maempr25;
     #maempr25#0 = empresa;
     #maempr25#1 = anyo;
     |LEE 141#maempr25.=;
     nEstado = FSalida;

     #maempr25#0 = empresa;
     #maempr25#1 = anyo;
     |SI modo = 4; |Y  nEstado ! 0;
         |MENAV "0000No existen datos";
         |LIBERA #maempr25;
         |CIERRA #maempr25;
         |ACABA;
     |FINSI;

     |PINPA #0#maempr25;
     |PINDA #0#maempr25;
     |SI modo ! 4;
         |ENDATOS #2#maempr25;
     |SINO;
         |PAUSA;
     |FINSI;
     |SI FSalida = 0;
         |SI nEstado = 0; |GRABA 020#maempr25.a; |FINSI;
         |SI nEstado ! 0; |GRABA 020#maempr25.n; |FINSI;
     |FINSI;
     |LIBERA #maempr25;
     |CIERRA #maempr25;
|FPRO;
