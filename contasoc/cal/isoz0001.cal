|FICHEROS;
     isoz0001 #0;
     maempr10 #200;
     maempr11 #201;
     cuacceso #10;
     sodacoca #52;

     isom0001 #101;
     isom0002 #102;
     isom0003 #103;
     isom0004 #104;
     isom0005 #105;
     isom0009 #109;
     isom0010 #110;
     isom0012 #112;
     isom0022 #122;

     isom0500 #500;
     isom0501 #501;
     isom0502 #502;
     isom0503 #503;
     isom0504 #504;

     isocie70 #70;

     :/contagen/def/ca8m0000 #400;
     :/contagen/def/ca8m0001 #401;
     :/contagen/def/ca8m0002 #402;
     :/contagen/def/ca8m0021 #421;
     :/contagen/def/ca8m0022 #422;
     :/contasoc/def/soda8m02 #431;
     :/contasoc/def/soda8m03 #432;
     :/contasoc/def/soda8m22 #441;
     :/contagen/def/canempre #408;
     :/contagen/def/caconi08 #428;
     :/contagen/def/caconi15 #429;
|FIN;

|VARIABLES;
     &enEmpresa   = 0;
     &enAnyo      = 0;
     &enCooperativa = 0;
     &eaCasilla   = "";
     &enValor     = 0;

     eNum2008A    = 0;
     nSwBona      = 0;
     nNume        = 0;
     nSwCCAA      = 0;
     nVent        = 0;
     nVentana     = 0;

     aAlfa        = "";
     &empAlta     = 0;
     &empre       = 0;
     &perio       = 0;
     &plani       = 0;
     &siono       = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enSwDis        = 0;
     &enPlan         = 0;
|FIN;

|INCLUYE varbal_i;
|INCLUYE lospat_i;

|PROCESO isom0504;
     #105#0  = enEmpresa;
     #105#1  = #504#0;
     #105#2  = #504#1;
     |LEE 101#105=;
     |SI FSalida ! 0;
         |DDEFECTO #105;
         #105#0  = enEmpresa;
         #105#1  = #504#0;
         #105#2  = #504#1;
         |GRABA 020#105b;
     |FINSI;

     #105#3  = #504#2;
     #105#4  = #504#3;
     #105#5  = 0;
     #105#6  = "N";

     |SI enTBal = 1;  #105#6 = #504#4;  #105#7 = #504#7;  |FINSI;
     |SI enTBal = 2;  #105#6 = #504#5;  #105#7 = #504#8;  |FINSI;
     |SI enTBal = 3;  #105#6 = #504#6;  #105#7 = #504#9;  |FINSI;

     |GRABA 020#105a;
     |LIBERA #105;
|FPRC;

|DEFBUCLE isom0504;
     #504#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0504;
|FIN;

|PROCESO isom0005_b;
     |BORRA 020#105a;
     |LIBERA #105;
|FPRC;

|DEFBUCLE isom0005_b;
     #105#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0005_b;
|FIN;

|PROCESO MontaEstructura504;
     |BUCLE isom0005_b;
     |ABRE #105;
     |BUCLE isom0504;
     |CIERRA #105;
|FPRC;

|PROCESO isom0503;
     #104#0  = enEmpresa;
     #104#1  = #503#0;
     #104#2  = #503#1;
     |LEE 101#104=;
     |SI FSalida ! 0;
         |DDEFECTO #104;
         #104#0  = enEmpresa;
         #104#1  = #503#0;
         #104#2  = #503#1;
         |GRABA 020#104b;
     |FINSI;

     #104#3  = #503#2;
     #104#4  = #503#3;
     #104#5  = 0;
     #104#6  = "N";

     |SI enTBal = 1;  #104#6 = #503#4;  #104#7 = #503#7;  |FINSI;
     |SI enTBal = 2;  #104#6 = #503#5;  #104#7 = #503#8;  |FINSI;
     |SI enTBal = 3;  #104#6 = #503#6;  #104#7 = #503#9;  |FINSI;

     |GRABA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE isom0503;
     #503#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0503;
|FIN;

|PROCESO isom0004_b;
     |BORRA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE isom0004_b;
     #104#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0004_b;
|FIN;

|PROCESO MontaEstructura503;
     |BUCLE isom0004_b;
     |ABRE #104;
     |BUCLE isom0503;
     |CIERRA #104;
|FPRC;

|PROCESO isom0502;
     #103#0  = enEmpresa;
     #103#1  = #502#0;
     #103#2  = #502#1;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0  = enEmpresa;
         #103#1  = #502#0;
         #103#2  = #502#1;
         |GRABA 020#103b;
     |FINSI;

     #103#3  = #502#2;
     #103#4  = #502#3;
     #103#5  = 0;
     #103#6  = "N";

     |SI enTCta = 1;  #103#6 = #502#4;  #103#7 = #502#7;  |FINSI;
     |SI enTCta = 2;  #103#6 = #502#5;  #103#7 = #502#8;  |FINSI;
     |SI enTCta = 3;  #103#6 = #502#6;  #103#7 = #502#9;  |FINSI;

     |GRABA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE isom0502;
     #502#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0502;
|FIN;

|PROCESO isom0003_b;
     |BORRA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE isom0003_b;
     #103#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0003_b;
|FIN;

|PROCESO MontaEstructura502;
     |BUCLE isom0003_b;
     |ABRE #103;
     |BUCLE isom0502;
     |CIERRA #103;
|FPRC;

|PROCESO isom0501;
     #102#0  = enEmpresa;
     #102#1  = #501#0;
     #102#2  = #501#1;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0  = enEmpresa;
         #102#1  = #501#0;
         #102#2  = #501#1;
         |GRABA 020#102b;
     |FINSI;

     #102#3  = #501#2;
     #102#4  = #501#3;
     #102#5  = 0;
     #102#6  = "N";

     |SI enTBal = 1;  #102#6 = #501#4;  #102#7 = #501#7;  |FINSI;
     |SI enTBal = 2;  #102#6 = #501#5;  #102#7 = #501#8;  |FINSI;
     |SI enTBal = 3;  #102#6 = #501#6;  #102#7 = #501#9;  |FINSI;

     |GRABA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE isom0501;
     #501#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0501;
|FIN;

|PROCESO isom0002_b;
     |BORRA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE isom0002_b;
     #102#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0002_b;
|FIN;

|PROCESO MontaEstructura501;
     |BUCLE isom0002_b;
     |ABRE #102;
     |BUCLE isom0501;
     |CIERRA #102;
|FPRC;

|PROCESO isom0500;
     #101#0  = enEmpresa;
     #101#1  = #500#0;
     #101#2  = #500#1;
     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0  = enEmpresa;
         #101#1  = #500#0;
         #101#2  = #500#1;
         |GRABA 020#101b;
     |FINSI;

     #101#3  = #500#2;
     #101#4  = #500#3;
     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE isom0500;
     #500#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0500;
|FIN;


|PROCESO MontaEstructura500;
     |ABRE #101;
     |SELECT #1#101;
     |BUCLE isom0500;
     |CIERRA #101;
|FPRC;

|PROCESO isom0005;
     |SI #105#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#105a;
     |LIBERA #105;
|FPRC;

|DEFBUCLE isom0005;
     #105#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0005;
|FIN;

|PROCESO isom0004;
     |SI #104#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#104a;
     |LIBERA #104;
|FPRC;

|DEFBUCLE isom0004;
     #104#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0004;
|FIN;

|PROCESO isom0003;
     |SI #103#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE isom0003;
     #103#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0003;
|FIN;

|PROCESO isom0002;
     |SI #102#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE isom0002;
     #102#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0002;
|FIN;

|PROCESO isom0001;
     |SI #101#5 = 0;
         |BORRA 020#101a;
     |FINSI;
     |LIBERA #101;
|FPRC;

|DEFBUCLE isom0001;
     #101#1;
     ;
     enEmpresa, enAnyo, 0000;
     enEmpresa, enAnyo, 9999;
     be;
     NULL, isom0001;
|FIN;

|PROCESO CreaBalance;
     aAlfa = #0#9;
     aAlfa = aAlfa % -102;

     |ABRE #408;
     |SELECT #4#408;
     perio   = -1;
     #408#2  = #0#8;
     #408#26 = aAlfa;
     |LEE 000#408=;
     |SI FSalida = 0; perio = #408#3;  |FINSI;
     |SELECT #1#408;
     |CIERRA #408;

     |SI perio = -1;  |ACABA;  |FINSI;

     empAlta = #0#8;
     empre   = #0#8;
     plani   = 1;
     siono   = "SI";
     |SUB_EJECUTA "soagico1;AUTO";
     |SI enHay129 = 1;
         |MENAV "0000La Cta 129 tiene Saldo. Debe hacer la Distribucion Resultado antes del pase al Impuesto";
     |FINSI;
|FPRC;

|PROCESO PaseConta;
  |ABRE #52;
  #52#0 = #0#8;
  #52#1 = #0#9;
  |LEE 040#52=;
  |SI FSalida ! 0;
      |CIERRA #52;
      |HAZ CreaBalance;
      |SI enHay129 = 1; |ACABA; |FINSI;
  |SINO;
      |CIERRA #52;
  |FINSI;

  |HAZ MontaEstructura500;

  |ABRE #122;
  eaCasilla = "175"; enValor = 0;
  |HAZ GrabaCas122;
  |CIERRA #122;

   nBalNum = #0#0;
   nCtaNum = #0#2;

|| .... Balance de Situacion
   nBalance = 0;
   |HAZ MontaEstructura501;
   |HAZ Pase_isom0002;
   |SI enErrorW17 = 1;
       || "    Pase abortado. Descuadre con cuentas del grupo 8 y 9 ";
   |FINSI;
   |BUCLE isom0002;

|| .... Balance de Cuenta de Resultado
   nBalance = 1;
   |HAZ MontaEstructura502;
   |HAZ Pase_isom0003;
   |BUCLE isom0003;

|| .... Ingresos y Gastos
   |SI enTBal = 1; |O enTBal = 2;    ||Normal o abreviado
       nBalance = 2;
       |HAZ MontaEstructura503;
       |SI #0#25 = "S";
           |HAZ Pase_isom0004;
       |FINSI;
   |FINSI;
   |BUCLE isom0004;

|| .... Estado de Cambios del Patrimonio Neto
   nBalance = 3;
   |HAZ MontaEstructura504;
   |SI #0#25 = "S";
       |HAZ Pase_isom0005;
   |FINSI;
   |BUCLE isom0005;
|FPRC;

|PROCESO PasedesdeCCAA;
   |HAZ MontaEstructura500;

   |ABRE #122;
   eaCasilla = "175"; enValor = 0;
   |HAZ GrabaCas122;
   |CIERRA #122;

   nBalNum = #0#0;
   nCtaNum = #0#2;

|| .... Balance de Situacion
   nBalance = 0;
   |HAZ MontaEstructura501;
   |HAZ CCAA_isom0002;   || por CCAA

   |BUCLE isom0002;


|| .... Balance de Cuenta de Resultado
   nBalance = 1;
   |HAZ MontaEstructura502;
   |HAZ CCAA_isom0003;   || por CCAA
   |BUCLE isom0003;


|| .... Ingresos y Gastos
   |SI enTBal = 1; |O enTBal = 2;    ||Normal o abreviado
       nBalance = 2;
       |HAZ MontaEstructura503;
       |SI #0#25 = "S";
           |HAZ CCAA_isom0004;
       |FINSI;
   |FINSI;
   |BUCLE isom0004;


|| .... Estado de Cambios del Patrimonio Neto
   nBalance = 3;
   |HAZ MontaEstructura504;
   |SI #0#25 = "S";
       |HAZ CCAA_isom0005;
   |FINSI;
   |BUCLE isom0005;
|FPRC;

|PROCESO OtrosPases;
   |HAZ MontaEstructura500;
   || .... Pase de Amortizaciones y retenciones

   |SI #0#15 = "S"; |HAZ PaseAmortiza;    |FINSI;
   |SI #0#16 = "S"; |HAZ PaseRetencion;   |FINSI;
   |SI #0#18 = "S"; |HAZ PaseDiferencias; |FINSI;
   |SI #0#21 = "S"; |HAZ PaseProv35;      |FINSI;
   |SI #0#23 = "S"; |HAZ PaseProv33;      |FINSI;
|FPRC;

|PROCESO VentanaTrabajo;
     |VENTANA 0501, 0540, -1, 16, "Realizando trabajo";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;  |PTEC 802;  |PAUSA;
     |PULSATECLA;
|FPRC;

|PROCESO FinVentanaTrabajo;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;
         |DDEFECTO #0;
         |ACABA;
     |FINSI;

     |CONFI "0000SSeguro que quiere realizar el pase en estos momentos";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI nSwCCAA = 1; |Y #0#10 = "1";
         |SI #0#0 ! #10#15; |O #0#2 ! #10#16;
             |CONFI "0000SNo coinciden las estructuras elegidas con las informadas en CCAA. Continuar ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     |HAZ VentanaTrabajo;
     |SI #0#10 = "1";  |O #0#10 = "2";
         |ABRE #200;
         #200#0 = enEmpresa;
         #200#1 = enAnyo;
         |LEE 101#200=;
         |SI FSalida = 0;
             #200#101 = #0#0;
             #200#102 = #0#2;
             #200#116 = #0#25;
             |GRABA 020#200a;
             |LIBERA #200;
         |FINSI;
         |CIERRA #200;

         |SI #0#10 = "1";
             |HAZ PaseConta;
             |SI enHay129 = 1;
                 |HAZ FinVentanaTrabajo;
                 |ACABA;
             |FINSI;
         |FINSI;
         |SI #0#10 = "2";  |HAZ PasedesdeCCAA;  |FINSI;
     |FINSI;

     |SI #0#15 = "S"; |O #0#16 = "S";
          |O #0#18 = "S"; |O #0#21 = "S"; |O #0#23 = "S";
         |HAZ OtrosPases;
     |FINSI;

     |SI #0#15 = "S"; |O #0#16 = "S"; |O #0#17 = "S";
          |O #0#18 = "S"; |O #0#21 = "S"; |O #0#23 = "S";
         |HAZ PaseTipoGravamen;
     |FINSI;

     |SI #0#10 = "1";  |O #0#10 = "2";  |O #0#15 = "S";  |O #0#16 = "S";
          |O #0#18 = "S"; |O #0#21 = "S"; |O #0#23 = "S";
         |ABRE #101;
         |HAZ TotalFich101;
         |CIERRA #101;

         |BUCLE isom0001;
     |FINSI;

     |SI #0#11 = "S";
         |SI #200#1 = 2008;  |HAZ BasesNegativas2008;    |FINSI;
         |SI #200#1 ] 2009;  |HAZ BasesNegativasActual;  |FINSI;
     |FINSI;

     |SI #0#12 = "S";
         |SI #200#1 = 2008;  |HAZ CuotasNegativas2008;    |FINSI;
         |SI #200#1 ] 2009;  |HAZ CuotasNegativasActual;  |FINSI;
     |FINSI;

     |SI #0#17 = "S";
         |SI #200#1 ] 2009;  |HAZ ImporteAplicar;  |FINSI;
     |FINSI;

     enSwDis = 0;
     |SI #0#19 = "S";
         |SI #200#1 ] 2010;  |HAZ ImporteDistribuir;  |FINSI;
     |FINSI;
     |SI enSwDis = 0; |HAZ ImpDist199; |FINSI;

     |SI #0#13 = "S";
         |SI #200#1 = 2008;  |HAZ Imposicion2008;    |FINSI;
         |SI #200#1 ] 2009;  |HAZ ImposicionActual;  |FINSI;
     |FINSI;

     |SI #0#14 = "S";
         |SI #200#1 = 2008;  |HAZ Deduc2008;          |FINSI;
         |SI #200#1 ] 2009;  |HAZ DeduccionesActual;  |FINSI;
     |FINSI;

     |SI #0#11 = "S";   |O #0#12 = "S";  |O #0#13 = "S";  |O #0#14 = "S";
         |SI #200#1 = 2009;
             |HAZ Pase415;     ||Solo en 2009
         |FINSI;
     |FINSI;

     |HAZ FinVentanaTrabajo;
|FPRC;

|PROCESO LeeBalance;
     |ABRE #400;
     |DDEFECTO #400;
     #400#0 = #0#0;
     |LEE 000#400=;
     #0#1   = #400#1;
     enTBal = #400#2;  || Tipo Balance 1=N,2=A,3=P

     |DDEFECTO #400;
     #400#0 = #0#2;
     |LEE 000#400=;
     #0#3 = #400#1;
     enTCta = #400#2;  || Tipo Ctas 1=N,2=A,3=P
     |CIERRA #400;

     eNum2008 = eNum2008A;
     |SI eNum2008 = -1;
         eNum2008 = 0;
         |SI nCtaNum = 0;  |O nCtaNum = 6;
          |O nCtaNum = 7;  |O nCtaNum = 10; eNum2008 = 0;  |FINSI;
         |SI nCtaNum = 1;  |O nCtaNum = 5;  eNum2008 = 1;  |FINSI;
         |SI nCtaNum = 30; |O nCtaNum = 32; eNum2008 = 30; |FINSI;
         |SI nCtaNum = 31;                  eNum2008 = 31; |FINSI;
         |SI nCtaNum = 40; |O nCtaNum = 42; eNum2008 = 40; |FINSI;
         |SI nCtaNum = 41;                  eNum2008 = 41; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C18;  |TIPO 0;
     aAlfa = #0Campo;
     |SI Campo = 18; |C_M #0#20, 1, aAlfa; |FINSI;
     |SI Campo = 21; |C_M #0#22, 1, aAlfa; |FINSI;
     |SI Campo = 23; |C_M #0#24, 1, aAlfa; |FINSI;
|FPRC;

|PROCESO Tipo0C20; |TIPO 0;
     |SI #0#18 = "S";
         nNume   = #0#20;

         nSwBona = 0;
         |SI nNume < 305; |O nNume > 416;
             nSwBona = 1;
             |SI nNume = 503; |O nNume = 504; |O nNume = 505;
                 |O nNume = 517; |O nNume = 250; |O nNume = 251;
                 nSwBona = 0;
             |FINSI;
         |SINO;
             |SI nNume = 340; |O nNume = 344; |O nNume = 351; |O nNume = 353;
                 |O nNume = 364; |O nNume = 366; |O nNume = 368; |O nNume = 371;
                    |O nNume = 395; |O nNume = 397; |O nNume = 399; |O nNume = 401;
                       |O nNume = 402; |O nNume = 408;
                 nSwBona = 1;
             |FINSI;
         |FINSI;
         |SI nSwBona = 1;
             aAlfa = "    La Casilla " + #0#20 + " NO es correcta";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C24; |TIPO 0;
     |SI #0#23 = "S";
         nNume   = #0#24;
         nSwBona = 1;
         |SI nNume = 331; |O nNume = 332; |O nNume = 325; |O nNume = 328;
             nSwBona = 0;
         |FINSI;
         |SI nSwBona = 1;
             aAlfa = "    La Casilla " + #0#24 + " NO es correcta";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C22; |TIPO 0;
     |SI #0#21 = "S";
         nNume   = #0#22;

         nSwBona = 1;
         |SI nNume = 415; |O nNume = 211; |O nNume = 416; |O nNume = 543;
             nSwBona = 0;
         |FINSI;
         |SI nSwBona = 1;
             aAlfa = "    La Casilla " + #0#22 + " NO es correcta";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C10;  |TIPO 0;
     aAlfa = Contenido;

     |C_M #0#0, 1, "N";
     |C_M #0#2, 1, "N";
     |SI #0#10 = "1";
         |C_M #0#0, 1, "S";
         |C_M #0#2, 1, "S";
     |FINSI;
     |SI #0#10 ! " "; |Y aAlfa ! #0#10;
         |HAZ LeoBalCCAA;
         |HAZ LeeBalance;
         |PINTA #0#0; |PINTA #0#1;
         |PINTA #0#2; |PINTA #0#3;
     |FINSI;

     |C_M #0#25,1,"N";
     |SI #0#10 ! 0; |Y enTBal ! 1;
         |C_M #0#25,1,"S";
     |FINSI;
|FPRC;

|PROCESO Tipo7C25;  |TIPO 7;
     |C_M #0#25,1,"N";
     |SI #0#10 ! 0; |Y enTBal ! 1;
         |C_M #0#25,1,"S";
     |FINSI;
|FPRC;

|PROCESO Tipo0C0;  |TIPO 0;
     |HAZ LeeBalance;
     |PINTA #0#1;
|FPRC;

|PROCESO Tipo0C2;  |TIPO 0;
     |HAZ LeeBalance;
     |PINTA #0#3;
|FPRC;

|PROCESO Tipo80;   |TIPO 80;
     FSalida = 2399;
|FPRC;

|PROCESO LosPatrones;

     |ABRE #428;
     |DDEFECTO #428;
     |LEE 101#428p;
     |CIERRA #428;
     |ABRE #429;
     |DDEFECTO #429;
     |LEE 101#429p;
     |CIERRA #429;

     |HAZ VerPatrones;
|FPRC;

|PROCESO LeoBalCCAA;
  eNum2008A = -1;
  nSwCCAA  = 0;
  |ABRE #10;
  #10#0 = #200#0;
  #10#1 = #200#1;
  |LEE 041#10=;
  |SI FSalida = 0;
      nSwCCAA = 1;
      eNum2008A = #10#14;
      |SI #0#10 ! " ";
          #0#0 = #10#15;
          #0#2 = #10#16;
      |FINSI;
  |FINSI;
  |CIERRA #10;

  |SI nSwCCAA = 0; |O #0#10 = " ";
      |ABRE #sodacoca;
      #sodacoca#0 = #200#0;
      #sodacoca#1 = #200#1;
      |LEE 041#sodacoca.=;
      |SI FSalida = 0;
          eNum2008A = #sodacoca#8;
      |FINSI;
      |CIERRA #sodacoca;
  |FINSI;
|FPRC;

|PROGRAMA;
     |SI enModoConsulta = 1;
         |ACABA;
     |FINSI;

     |HAZ LosPatrones;
     |HAZ eHazEjerCCAA;

     |ABRE #200;
     #200#0 = enEmpresa;
     #200#1 = enAnyo;
     |LEE 000#200=;
     |SI FSalida ! 0;  |DDEFECTO #200;  #200#0 = enEmpresa; #200#1 = enAnyo; |FINSI;
     |CIERRA #200;

     aAlfa =  "Carga de datos (" + (("00000" + #200#0) % -105) + " / " + #200#1 + " " + #200#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 2399, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #0#8 = #200#0;
     #0#9 = #200#1;
     #0#0 = #200#101;
     #0#2 = #200#102;

     #0#10 = "1";
     #0#11 = "S";
     #0#12 = "S";
     #0#13 = "S";
     #0#14 = "S";
     #0#15 = "N";
     #0#16 = "N";
     #0#17 = "N";
     #0#18 = "N";
     #0#19 = "N";
     #0#21 = "N";
     #0#23 = "N";
     |SI enAnyo < 2015;
         #0#20 = #428#72;
         |C_M #0#21, 1, "N";
         |C_M #0#22, 1, "N";
         |C_M #0#23, 1, "N";
         |C_M #0#24, 1, "N";
     |SINO;
         #0#20 = #429#72;
         #0#22 = #429#95;
         #0#24 = #429#76;
     |FINSI;

     |ABRE #101;
     |SELECT #2#101;
     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#3 = "500";
     |LEE 000#101=;
     |SI FSalida = 0;  #0#10 = " ";  |FINSI;
     |CIERRA #101;

     |HAZ LeoBalCCAA;
     |HAZ LeeBalance;

     #0#25 = "N";
     |SI enTBal = 1; #0#25 = "S"; |FINSI;

     |ABRE #109;
     |SELECT #2#109;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#5 = "670";
     |LEE 000#109=;
     |SI FSalida = 0;  #0#11 = "N";  |FINSI;
     |CIERRA #109;

     |ABRE #110;
     |SELECT #2#110;
     #110#0 = #200#0;
     #110#1 = #200#1;
     #110#5 = "694";
     |LEE 000#110=;
     |SI FSalida = 0;  #0#12 = "N";  |FINSI;
     |CIERRA #110;

     |ABRE #112;
     |SELECT #2#112;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#5 = "";
     |LEE 000#112];
     |SI FSalida = 0;  |Y #112#0 = #200#0;  |Y  #112#1 = #200#1;
         #0#13 = "N";
     |FINSI;
     |CIERRA #112;

     |ABRE #70;
     #70#0 = #200#0;
     #70#1 = #200#1;
     #70#2 = 1;
     |LEE 000#70];
     |SI FSalida = 0;  |Y #70#0 = #200#0;  |Y  #70#1 = #200#1;
         #0#14 = "N";
     |FINSI;
     |CIERRA #70;

     enCooperativa = 0;

     |ABRE #201;
     #201#0 = enEmpresa;
     #201#1 = enAnyo;
     #201#2 = 17;
     |LEE 000#201=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #201#0 = enEmpresa;
     #201#1 = enAnyo;
     #201#2 = 18;
     |LEE 000#201=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #201#0 = enEmpresa;
     #201#1 = enAnyo;
     #201#2 = 19;
     |LEE 000#201=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     |CIERRA #201;

     |SI enCooperativa = 0;
         #0#12 = "N";
         |C_M #0#12, 1, "N";
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;

     |ENDATOS #1#0;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVent;

     |PULSATECLA;

     |SI #0#10 = "1";  |O #0#10 = "2";
         |SUB_EJECUTA_NP "isoz0002;PANTALLA";
     |FINSI;
|FPRO;
