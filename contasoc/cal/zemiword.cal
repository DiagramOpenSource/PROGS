|FICHEROS;
     zemiword #0;
     megwordc #500;
     megwordl #501;
|FIN;

|VARIABLES;
     nCampo    = 0;
     nSwPasada = 0;
     nImpresio = 0;
     nCopias   = 0;

     aAlfa     = "";

     fFecha    = @;
|FIN;

|PROCESO Anyo7;  |TIPO 7;
     fFecha = ~;
     aAlfa  = fFecha % -104;
     #0#0   = aAlfa - 1;
     |PINTA #0#0;
|FPRC;

|PROCESO ModiCopia;
     |C_M #0#49, 1, "S";
     |C_M #0#50, 1, "S";
     |C_M #0#51, 1, "S";
     |C_M #0#52, 1, "S";
     |C_M #0#53, 1, "S";

     |SI #0#43 = "N";  |C_M #0#49, 1, "N";  |FINSI;
     |SI #0#44 = "N";  |C_M #0#50, 1, "N";  |FINSI;
     |SI #0#45 = "N";  |C_M #0#51, 1, "N";  |FINSI;
     |SI #0#46 = "N";  |C_M #0#52, 1, "N";  |FINSI;
     |SI #0#47 = "N";  |C_M #0#53, 1, "N";  |FINSI;
|FPRC;

|PROCESO Parrilla;
     |SI #0#1 = 0;
         #0#1 = 0;  |PINTA #0#1;
         #0#2 = 0;  |PINTA #0#2;  |C_M #0#2, 1, "N";
         |PARA nCampo = 3;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |SINO;
         |C_M #0#1, 1, "S";
         |C_M #0#2, 1, "S";
         |PARA nCampo = 3;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
               #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO LeeEmpresas;
     |SI #0Campo = 0;  |ACABA;  |FINSI;

     |ABRE #500;
     |SELECT #1#500;
     #500#0 = #0Campo;
     #500#1 = #0#0;
     |LEE 040#500=;
     |SI FSalida ! 0;
         |MENAV "      No existen Documentos Creados en esta Empresa.";
         |ERROR;
     |FINSI;
     |CIERRA #500;
|FPRC;

|PROCESO Baja500;
     #500#0 = 1;
     #500#1 = #0#0;
|FPRC;

|PROCESO Alta500;
     #500#0 = 99999;
     #500#1 = #0#0;
|FPRC;

|PROCESO Tipo66;  |TIPO 66;
     |ABRE #500;
     |SELECT #1#500;
     #500#0 = #0Campo;
     #500#1 = #0#0;
     |LEE 040#500=;

     |CONSULTA_F_CLAVE #3#500, Baja500, Alta500;
     |SI FSalida = 0;
         #0Campo = #500#0;
         |PINTA #0Campo;
     |FINSI;
     |CIERRA #500;

     |SELECT #1#500;
|FPRC;

|PROCESO Emite;
     |SI #501#7 = "S";            |Y #0#48 = "N";  |ACABA;  |FINSI;
     |SI #501#2 = "wcertif.doc";  |Y #0#46 = "N";  |ACABA;  |FINSI;
     |SI #501#2 = "wcuenta.doc";  |Y #0#43 = "N";  |ACABA;  |FINSI;
     |SI #501#2 = "wgestio.doc";  |Y #0#45 = "N";  |ACABA;  |FINSI;
     |SI #501#2 = "winstan.doc";  |Y #0#47 = "N";  |ACABA;  |FINSI;
     |SI #501#2 = "wmemori.doc";  |Y #0#44 = "N";  |ACABA;  |FINSI;

     |SI #501#2 = "wcertif.doc";  nCopias = #0#52; |FINSI;
     |SI #501#2 = "wcuenta.doc";  nCopias = #0#49; |FINSI;
     |SI #501#2 = "wgestio.doc";  nCopias = #0#51; |FINSI;
     |SI #501#2 = "winstan.doc";  nCopias = #0#53; |FINSI;
     |SI #501#2 = "wmemori.doc";  nCopias = #0#50; |FINSI;

     |PARA nImpresio = 1;  |SI nImpresio [ nCopias;  |HACIENDO nImpresio = nImpresio + 1;
           |SI nSwPasada = 0;
               aAlfa = "zmenumem;" + (#501#2 % 206) + (("00000" + #501#0) % -105) + "6" + "3" + "1" + #501#1;
           |SINO;
               aAlfa = "zmenumem;" + (#501#2 % 206) + (("00000" + #501#0) % -105) + "6" + "4" + "1" + #501#1;
           |FINSI;
           nSwPasada = 1;

           |SUB_EJECUTA aAlfa;
     |SIGUE;

     #501#7 = "S";
     |GRABA 020#501a;
     |LIBERA #501;
|FPRC;

|DEFBUCLE megwordl;
     #501#1;
     ;
     #0#1, #0#0, "           ";
     #0#2, #0#0, "zzzzzzzzzzz";
     be;
     NULL, Emite;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     nSwPasada = 0;
     |SI #0#1 ! 0;
         |BUCLE megwordl;
     |SINO;
         |PARA nCampo = 3;  |SI nCampo [ 42;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#1 = #0nCampo;
                   #0#2 = #0nCampo;
                   |BUCLE megwordl;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;
