|FICHEROS;
     maempr19;
     maempr20,MANTE;
|FIN;

|VARIABLES;
     Modo       = 0;
     Forma      = 0;
     SwSalir    = 0;
     nID        = 0;

     aID        = "";
     aAlfa      = "";
     aTecla     = "";

     {20}aPopup = "";

     &empresa   = 0;
     &anyo      = 0;
     &modo      = 0;
     &enCalcCif = 0;
     &eaVarDni  = "";
|FIN;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempr20#Campo#;
         |HAZ CalculoDNI;
         #maempr20#Campo# = eaVarDni;
         |PINTA #maempr20#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #maempr20#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempr20#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempr20#Campo# = eaVarDni;  |PINTA #maempr20#Campo#;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tv2014;
     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 12;
     aPopup3  = "a) Una entidad y sus socios o part¡cipes";
     aPopup4  = "b) Una entidad y sus consejeros o administradores";
     aPopup5  = "c) Una entidad y los cónyuges o personas unidas por relaciones de parentesco ...";
     aPopup6  = "d) Dos entidades que pertenezcan a un grupo";
     aPopup7  = "e) Una entidad y los socios o part¡cipes de otra entidad, cuando ambas pertenezcan a un grupo";
     aPopup8  = "f) Una entidad y los consejeros o adm. de otra entidad, cuando ambas pertenezcan a un grupo";
     aPopup9  = "g) Una entidad y los cónyuges o personas unidas por relaciones, cuando ambas pertenezcan a un grupo";
     aPopup10 = "h) Una entidad y otra participada por la 1a. indirectamente en, al memos, el 25% del cap.social o de los fondos propios";
     aPopup11 = "i) Dos entidades en las cuales los mismos socios, part., o  cónyuges ... participen en, al menos, el 25% ";
     aPopup12 = "j) Una entidad residente en territorio espa¤ol y sus establecimientos permanentes en el extranjero";
     aPopup13 = "k) Una entidad no residente en territorio espa¤ol y sus establecimientos permanentes en el mencionado territorio";
     aPopup14 = "l) Dos entidades que formen parte de un grupo que tribute en régimen de los grupos de sociedades cooperativas";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #maempr20#8 = aAlfa;
     |FINSI;
     |PINTA #maempr20#8;
|FPRC;

|PROCESO Tv2015;
     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 8;
     aPopup3  = "a) Una entidad y sus socios o part¡cipes";
     aPopup4  = "b) Una entidad y sus consejeros o administradores";
     aPopup5  = "c) Una entidad y los cónyuges o personas unidas por relaciones de parentesco ...";
     aPopup6  = "d) Dos entidades que pertenezcan a un grupo";
     aPopup7  = "e) Una entidad y los consejeros o adm. de otra entidad, cuando ambas pertenezcan a un grupo";
     aPopup8  = "f) Una entidad y otra participada por la 1a. indirectamente en, al memos, el 25% del cap.social o de los fondos propios";
     aPopup9  = "g) Dos entidades en las cuales los mismos socios, part., o  cónyuges ... participen en, al menos, el 25% ";
     aPopup10 = "h) Una entidad no residente en territorio espa¤ol y sus establecimientos permanentes en el mencionado territorio";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #maempr20#8 = aAlfa;
     |FINSI;
     |PINTA #maempr20#8;
|FPRC;

|PROCESO Tipo66C08;  |TIPO 66;
     aAlfa = "|C006WID";
     aID   = #maempr20#aAlfa#;
     nID   = aID;

     |SI #maempr20#1 [ 2014;
         |HAZ Tv2014;
     |FINSI;

     |SI #maempr20#1 ] 2015;
         |HAZ Tv2015;
     |FINSI;
|FPRC;

|PROCESO Tipo0C08; |TIPO 0;
     |SI #maempr20#1 [ 2014;
         |SI #maempr20#8 < "a"; |O #maempr20#8 > "l";
             |MENAV "    Valor no admitido";
             |ERROR;
         |FINSI;
     |FINSI;

     |SI #maempr20#1 ] 2015;
         |SI #maempr20#8 < "a"; |O #maempr20#8 > "h";
             |MENAV "    Valor no admitido";
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|RUTINA ClaveBaja0;
    #maempr19#0 = empresa;
    #maempr19#1 = anyo;
    #maempr19#5 = 0;
    #maempr19#2 = 1;
|FRUT;

|RUTINA ClaveAlta0;
    #maempr19#0 = empresa;
    #maempr19#1 = anyo;
    #maempr19#5 = 0;
    #maempr19#2 = 99;
|FRUT;

|PROGRAMA;

  |ENTLINEAL #1#maempr19, -4, 1, 14, modo, ClaveBaja0, ClaveAlta0;

|FPRO;

|RUTINA ClaveBaja1;
  #maempr20#0  = #maempr19#0;
  #maempr20#1  = #maempr19#1;
  #maempr20#10 = #maempr19#5;
  #maempr20#2  = #maempr19#2;
  #maempr20#3  = 1;
|FRUT;

|RUTINA ClaveAlta1;
  #maempr20#0  = #maempr19#0;
  #maempr20#1  = #maempr19#1;
  #maempr20#10 = #maempr19#5;
  #maempr20#2  = #maempr19#2;
  #maempr20#3  = 99;
|FRUT;

|PROCESO Borra01;
  |BORRA 140#maempr20.a;
  |LIBERA #maempr20;
|FPRC;

|DEFBUCLE maempr20;
  #maempr20#1;
  ;
  #maempr19#0, #maempr19#1, #maempr19#5, #maempr19#2, 00;
  #maempr19#0, #maempr19#1, #maempr19#5, #maempr19#2, 99;
  be;
  NULL, Borra01;
|FIN;

|PROCESO VeteAl19;  |TIPO 2;
  Modo  = (FEntrada / 100) ! 0;
  |SI Modo = 3;
      |BUCLE maempr20;
      |ACABA;
  |FINSI;

  Forma = 0 +. 1;
  |SI Forma ! 1;  |ACABA;  |FINSI;

  |ENTLINEAL #1#maempr20, -5, 2, 21, 0, ClaveBaja1, ClaveAlta1;
|FPRC;

|PROCESO Tipo7F0; |TIPO 7;
  SwSalir = 1;
  |ENTLINEAL #1#maempr20, -5, 4, 21, 0, ClaveBaja1, ClaveAlta1;
  SwSalir = 0;
|FPRC;

|PROCESO Tipo7F1;  |TIPO 7;
  |SI SwSalir = 0;  |ACABA;  |FINSI;

  |PTEC 807;
|FPRC;
