|FICHEROS;
     zmenumem #99;
     medgword #100;
     meempmem #101;
     maempr01 #6;

     cuacceso #200;

     cubala02 #102;
     cubala03 #103;
     cubala04 #104;
     cubala05 #105;

     cubala22 #122;
     cubala23 #123;
     cubala24 #124;
     cubala25 #125;

     mew00004 #98;

     megwordc #500;
     megwordl #501;
     megwordz #502;
     maempr10 #510;
|FIN;

|VARIABLES;
     aOrigen1      = "";
     aDestino1     = "";
     aDestino      = "";
     aOrigen       = "";
     aBase         = "";
     aValfa        = "";
     aAlfa         = "";
     aPathCliente  = "";
     aPathSociedad = "";
     aPathbasica   = "";
     aCapitulo     = "";
     aPrograma     = "";
     aParametro    = "";
     aEmpresa      = "";
     aTipo         = "";
     aOpcion       = "";
     aExiste       = "";
     aPagina       = "";
     aConta        = "";
     aAnyo         = "";
     aHora         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aAlfa4        = "";
     aLen          = "";
     aImporte1     = "";
     aImporte2     = "";
     aImporte3     = "";
     aImporte4     = "";
     aCuenta       = "";
     aDescri       = "";
     aDesde        = "";
     aHasta        = "";
     aAster        = "";
     aAbre         = "";
     aNumero       = "";
     aVariable     = "";
     aUltPagina    = "";
     aIdenti       = "";

     nWord         = 0;
     nWordAnt      = 0;
     nEmpresa      = 0;
     nConta        = 0;
     nConta1       = 0;
     nConta2       = 0;
     nCampo        = 0;
     nLen          = 0;
     nHandle       = 0;
     nSwCuenta     = 0;
     nSwFinal      = 0;
     nSwImpre      = 0;
     nSwMovi       = 0;
     nMas          = 0;
     nMenos        = 0;
     nIni          = 0;
     nTotal        = 0;
     nCapitulo     = 0;
     nSwPrimero    = 0;
     nNume         = 0;
     nSwAsignar    = 0;
     nSwEmpresa    = 0;
     nNumero21     = 0;
     nNumero22     = 0;
     nNumero1      = 0;
     nNumero2      = 0;
     nPagina       = 0;

     nCanti1  = 0; nCanti2  = 0; nCanti3  = 0; nCanti4  = 0; nCanti5  = 0;
     nCanti6  = 0; nCanti7  = 0; nCanti8  = 0; nCanti9  = 0; nCanti10 = 0;
     nCanti11 = 0; nCanti12 = 0; nCanti13 = 0; nCanti14 = 0; nCanti15 = 0;
     nCanti16 = 0; nCanti17 = 0; nCanti18 = 0; nCanti19 = 0; nCanti20 = 0;
     nCanti21 = 0; nCanti22 = 0; nCanti23 = 0; nCanti24 = 0; nCanti25 = 0;
     nCanti26 = 0; nCanti27 = 0; nCanti28 = 0; nCanti29 = 0; nCanti30 = 0;
     nCanti31 = 0; nCanti32 = 0; nCanti33 = 0; nCanti34 = 0; nCanti35 = 0;
     nCanti36 = 0; nCanti37 = 0; nCanti38 = 0; nCanti39 = 0; nCanti40 = 0;
     nCanti41 = 0; nCanti42 = 0; nCanti43 = 0; nCanti44 = 0; nCanti45 = 0;
     nCanti46 = 0; nCanti47 = 0; nCanti48 = 0; nCanti49 = 0; nCanti50 = 0;
     nCanti51 = 0; nCanti52 = 0; nCanti53 = 0; nCanti54 = 0; nCanti55 = 0;
     nCanti56 = 0; nCanti57 = 0; nCanti58 = 0; nCanti59 = 0; nCanti60 = 0;

     nImpor1  = 0; nImpor2  = 0; nImpor3  = 0; nImpor4  = 0; nImpor5  = 0;
     nImpor6  = 0; nImpor7  = 0; nImpor8  = 0; nImpor9  = 0; nImpor10 = 0;
     nImpor11 = 0; nImpor12 = 0; nImpor13 = 0; nImpor14 = 0; nImpor15 = 0;
     nImpor16 = 0; nImpor17 = 0; nImpor18 = 0; nImpor19 = 0; nImpor20 = 0;

     &eaImporte    = "";
     &eaOrigen     = "";
     &eaDestino    = "";
     &eaContador   = "";
     &eaAlfa       = "";
     &eaUnidadBasico = "";

     {300}apExterna = "";
|FIN;

|PROCESO LeeTempoGest;
     nSwEmpresa = 0;
     |ABRE #98;
     aAlfa = ("00000" + #101#0) % -105;
     #98#0 = #100#0;
     #98#1 = aAlfa;
     |LEE 040#98=;
     |SI FSalida = 0;  nSwEmpresa = 1;  |FINSI;
     |CIERRA #98;
|FPRC;

|PROCESO PortadaGes;
     |ABRE #6;
     #6#0 = #101#0;
     #6#1 = #101#5;
     |LEE 040#6=;
     |SI FSalida ! 0;  |DDEFECTO #6;  |FINSI;
     |CIERRA #6;

     aAlfa = #6#2;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #6#3;  |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     nNume = #101#5 - 1;
     aAlfa = nNume;
     |WORD_ASIGNA_CAMPO nWord, "&EJERANT",  aAlfa;

     aAlfa = #101#5;
     |WORD_ASIGNA_CAMPO nWord, "&EJERACT",  aAlfa;

     aAlfa = "30 de marzo de 1.999.";
     |WORD_ASIGNA_CAMPO nWord, "&FECHA",  aAlfa;
|FPRC;

|PROCESO CuadroGes1;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;


     |SI #200#13 = "N";
         nImpor1 = #105#8;
         nImpor2 = #105#46;
         nCanti1 = (((#105#46 - #105#8) / #105#8) * 100) ! 3;

         nImpor3 = #104#7;
         nImpor4 = #104#46;
         nCanti2 = (((#104#46 - #104#7) / #104#7) * 100) ! 3;

         nImpor5 = nImpor1 - nImpor3;
         nImpor6 = nImpor2 - nImpor4;
         nCanti3 = (((nImpor6 - nImpor5) / nImpor5) * 100) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = #125#8;
         nImpor2 = #125#50;
         nCanti1 = (((#125#50 - #125#8) / #125#8) * 100) ! 3;

         nImpor3 = #124#7;
         nImpor4 = #124#52;
         nCanti2 = (((#124#52 - #124#7) / #124#7) * 100) ! 3;

         nImpor5 = nImpor1 - nImpor3;
         nImpor6 = nImpor2 - nImpor4;
         nCanti3 = (((nImpor6 - nImpor5) / nImpor5) * 100) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaImporte = nImpor1; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaImporte = nImpor2; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     eaImporte = nImpor3; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaImporte = nImpor4; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#7",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#8", aAlfa;

     eaImporte = nImpor5; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#9",  aAlfa;

     eaImporte = nImpor6; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#10",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO CuadroGes2;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     nCanti1 = 100;
     nCanti2 = 100;
     nCanti3 = 0;

     |SI #200#13 = "N";
         nCanti4 = ((#104#07 / #105#08) * 100) ! 3;
         nCanti5 = ((#104#46 / #105#46) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = (((#104#13 + #104#14) / #105#08) * 100) ! 3;
         nCanti8 = (((#104#52 + #104#53) / #105#46) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = ((#104#15 / #105#08) * 100) ! 3;
         nCanti11 = ((#104#54 / #105#46) * 100) ! 3;
         nCanti12 = (nCanti11 - nCanti10) ! 3;

         nCanti13 = ((#104#16 / #105#08) * 100) ! 3;
         nCanti14 = ((#104#55 / #105#46) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = ((#104#20 / #105#08) * 100) ! 3;
         nCanti17 = ((#104#59 / #105#46) * 100) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         nCanti19 = ((#105#14 / #105#08) * 100) ! 3;
         nCanti20 = ((#105#52 / #105#46) * 100) ! 3;
         nCanti21 = (nCanti20 - nCanti19) ! 3;

         nCanti22 = (nCanti1 - nCanti4 - nCanti7 - nCanti10 - nCanti13 - nCanti16 + nCanti19) ! 3;
         nCanti23 = (nCanti2 - nCanti5 - nCanti8 - nCanti11 - nCanti14 - nCanti17 + nCanti20) ! 3;
         nCanti24 = (nCanti23 - nCanti22) ! 3;

         nCanti25 = (((#105#21 + #105#22 + #105#31 + #105#32) / #105#08) * 100) ! 3;
         nCanti26 = (((#105#59 + #105#60 + #105#69 + #105#70) / #105#46) * 100) ! 3;
         nCanti27 = (nCanti26 - nCanti25) ! 3;

         nCanti28 = (((#104#27 + #104#28 + #104#29 + #104#30) / #105#08) * 100) ! 3;
         nCanti29 = (((#104#66 + #104#67 + #104#68 + #104#69) / #105#46) * 100) ! 3;
         nCanti30 = (nCanti29 - nCanti28) ! 3;

         nCanti31 = ((#105#33 / #105#08) * 100) ! 3;
         nCanti32 = ((#105#71 / #105#46) * 100) ! 3;
         nCanti33 = (nCanti32 - nCanti31);

         nCanti34 = ((#104#32 / #105#08) * 100) ! 3;
         nCanti35 = ((#104#71 / #105#46) * 100) ! 3;
         nCanti36 = (nCanti35 - nCanti34) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti4 = ((#124#07 / #125#08) * 100) ! 3;
         nCanti5 = ((#124#52 / #125#50) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = (((#124#13 + #124#14) / #125#08) * 100) ! 3;
         nCanti8 = (((#124#58 + #124#59) / #125#50) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = ((#124#18 / #125#08) * 100) ! 3;
         nCanti11 = ((#124#63 / #125#50) * 100) ! 3;
         nCanti12 = (nCanti11 - nCanti10) ! 3;

         nCanti13 = ((#124#19 / #125#08) * 100) ! 3;
         nCanti14 = ((#124#64 / #125#50) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = ((#124#23 / #125#08) * 100) ! 3;
         nCanti17 = ((#124#68 / #125#50) * 100) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         nCanti19 = ((#125#14 / #125#08) * 100) ! 3;
         nCanti20 = ((#125#56 / #125#50) * 100) ! 3;
         nCanti21 = (nCanti20 - nCanti19) ! 3;

         nCanti22 = (nCanti1 - nCanti4 - nCanti7 - nCanti10 - nCanti13 - nCanti16 + nCanti19) ! 3;
         nCanti23 = (nCanti2 - nCanti5 - nCanti8 - nCanti11 - nCanti14 - nCanti17 + nCanti20) ! 3;
         nCanti24 = (nCanti23 - nCanti22) ! 3;

         nCanti25 = (((#125#22 + #125#23 + #125#33 + #125#34) / #125#08) * 100) ! 3;
         nCanti26 = (((#125#64 + #125#65 + #125#75 + #125#76) / #125#50) * 100) ! 3;
         nCanti27 = (nCanti26 - nCanti25) ! 3;

         nCanti28 = (((#124#30 + #124#31 + #124#32 + #124#33) / #125#08) * 100) ! 3;
         nCanti29 = (((#124#75 + #124#76 + #124#77 + #124#78) / #125#50) * 100) ! 3;
         nCanti30 = (nCanti29 - nCanti28) ! 3;

         nCanti31 = ((#125#35 / #125#08) * 100) ! 3;
         nCanti32 = ((#125#77 / #125#50) * 100) ! 3;
         nCanti33 = (nCanti32 - nCanti31);

         nCanti34 = ((#124#35 / #125#08) * 100) ! 3;
         nCanti35 = ((#124#80 / #125#50) * 100) ! 3;
         nCanti36 = (nCanti35 - nCanti34) ! 3;
     |FINSI;

     nCanti37 = (nCanti22 + nCanti25 - nCanti28 + nCanti31 - nCanti34) ! 3;
     nCanti38 = (nCanti23 + nCanti26 - nCanti29 + nCanti32 - nCanti35) ! 3;
     nCanti39 = (nCanti38 - nCanti37) ! 3;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#5",  aAlfa;

     eaAlfa = nCanti4;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaAlfa = nCanti5;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#7",  aAlfa;

     eaAlfa = nCanti6;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#8",  aAlfa;

     eaAlfa = nCanti7;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#9",  aAlfa;

     eaAlfa = nCanti8;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#10", aAlfa;

     eaAlfa = nCanti9;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;

     eaAlfa = nCanti10; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#12", aAlfa;

     eaAlfa = nCanti11; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#13", aAlfa;

     eaAlfa = nCanti12; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#14", aAlfa;

     eaAlfa = nCanti13; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#15", aAlfa;

     eaAlfa = nCanti14; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#16", aAlfa;

     eaAlfa = nCanti15; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#17", aAlfa;

     eaAlfa = nCanti16; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#18", aAlfa;

     eaAlfa = nCanti17; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#19", aAlfa;

     eaAlfa = nCanti18; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#20", aAlfa;

     eaAlfa = nCanti19; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#21", aAlfa;

     eaAlfa = nCanti20; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#22", aAlfa;

     eaAlfa = nCanti21; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#23", aAlfa;

     eaAlfa = nCanti22; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#24", aAlfa;

     eaAlfa = nCanti23; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#25", aAlfa;

     eaAlfa = nCanti24; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#26", aAlfa;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#27", aAlfa;

     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#28", aAlfa;

     eaAlfa = nCanti25; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#29",  aAlfa;

     eaAlfa = nCanti26; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#30",  aAlfa;

     eaAlfa = nCanti27; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#31",  aAlfa;

     eaAlfa = nCanti28; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#32",  aAlfa;

     eaAlfa = nCanti29; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#33",  aAlfa;

     eaAlfa = nCanti30; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#34",  aAlfa;

     eaAlfa = nCanti31; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#35",  aAlfa;

     eaAlfa = nCanti32; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#36",  aAlfa;

     eaAlfa = nCanti33; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#37",  aAlfa;

     eaAlfa = nCanti34; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#38",  aAlfa;

     eaAlfa = nCanti35; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#39",  aAlfa;

     eaAlfa = nCanti36; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#40",  aAlfa;

     eaAlfa = nCanti37; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#41",  aAlfa;

     eaAlfa = nCanti38; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#42",  aAlfa;

     eaAlfa = nCanti39; |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#43",  aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO CuadroGes3;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         |SI #104#34 ! 0; nNumero21 = #104#34; |SINO; nNumero21 = #105#35; |FINSI;
         |SI #104#73 ! 0; nNumero22 = #104#73; |SINO; nNumero22 = #105#73; |FINSI;

         nCanti1 = ((nNumero21 / #104#41) * 100) ! 3;
         nCanti2 = ((nNumero22 / #104#80) * 100) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;

         nCanti4 = (((#105#36 + #105#37 + #105#39 + #105#40) / #104#41) * 100) ! 3;
         nCanti5 = (((#105#74 + #105#75 + #105#77 + #105#78) / #104#80) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = ((#105#38 / #104#41) * 100) ! 3;
         nCanti8 = ((#105#76 / #104#80) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = (((#104#36 + #104#37 + #104#38 + #104#39) / #104#41) * 100) ! 3;
         nCanti11 = (((#104#75 + #104#76 + #104#77 + #104#78) / #104#80) * 100) ! 3;
         nCanti12 = (nCanti11 - nCanti10) ! 3;

         nCanti13 = ((#104#42 / #104#41) * 100) ! 3;
         nCanti14 = ((#104#81 / #104#80) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = (100 - nCanti13) ! 3;
         nCanti17 = (100 - nCanti14) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         |SI #104#41 [ 0; |Y #104#80 [ 0;
             nCanti1  = 0;   nCanti2  = 0;   nCanti3  = 0;   nCanti4  = 0;
             nCanti5  = 0;   nCanti6  = 0;   nCanti7  = 0;   nCanti8  = 0;
             nCanti9  = 0;   nCanti10 = 0;   nCanti11 = 0;   nCanti12 = 0;
             nCanti13 = 0;   nCanti14 = 0;   nCanti15 = 0;   nCanti16 = 0;
             nCanti17 = 0;   nCanti18 = 0;
         |FINSI;
     |FINSI;

     |SI #200#13 = "S";
         |SI #124#37 ! 0; nNumero21 = #124#37; |SINO; nNumero21 = #125#37; |FINSI;
         |SI #124#82 ! 0; nNumero22 = #124#82; |SINO; nNumero22 = #125#79; |FINSI;

         nCanti1 = ((nNumero21 / #124#44) * 100) ! 3;
         nCanti2 = ((nNumero22 / #124#89) * 100) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;

         nCanti4 = (((#125#38 + #125#39 + #125#41 + #125#42) / #124#44) * 100) ! 3;
         nCanti5 = (((#125#80 + #125#81 + #125#83 + #125#84) / #124#89) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = ((#125#40 / #124#44) * 100) ! 3;
         nCanti8 = ((#125#82 / #124#89) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = (((#124#39 + #124#40 + #124#41 + #124#42) / #124#44) * 100) ! 3;
         nCanti11 = (((#124#84 + #124#85 + #124#86 + #124#87) / #124#89) * 100) ! 3;
         nCanti12 = (nCanti11 - nCanti10) ! 3;

         nCanti13 = ((#124#45 / #124#44) * 100) ! 3;
         nCanti14 = ((#124#90 / #124#89) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = (100 - nCanti13) ! 3;
         nCanti17 = (100 - nCanti14) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         |SI #124#44 [ 0; |Y #124#89 [ 0;
             nCanti1  = 0;   nCanti2  = 0;   nCanti3  = 0;   nCanti4  = 0;
             nCanti5  = 0;   nCanti6  = 0;   nCanti7  = 0;   nCanti8  = 0;
             nCanti9  = 0;   nCanti10 = 0;   nCanti11 = 0;   nCanti12 = 0;
             nCanti13 = 0;   nCanti14 = 0;   nCanti15 = 0;   nCanti16 = 0;
             nCanti17 = 0;   nCanti18 = 0;
         |FINSI;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#5",  aAlfa;

     eaAlfa = nCanti4;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaAlfa = nCanti5;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#7",  aAlfa;

     eaAlfa = nCanti6;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#8",  aAlfa;

     eaAlfa = nCanti7;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#9",  aAlfa;

     eaAlfa = nCanti8;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#10", aAlfa;

     eaAlfa = nCanti9;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;

     eaAlfa = nCanti10;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#12", aAlfa;

     eaAlfa = nCanti11;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#13", aAlfa;

     eaAlfa = nCanti12;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#14", aAlfa;

     aAlfa = ("       " +    "100") % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#15", aAlfa;
     aAlfa = ("       " +    "100") % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#16", aAlfa;
     aAlfa = ("       " +      "0") % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#17", aAlfa;

     eaAlfa = nCanti13;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#18", aAlfa;

     eaAlfa = nCanti14;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#19", aAlfa;

     eaAlfa = nCanti15;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#20", aAlfa;

     eaAlfa = nCanti16;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#21", aAlfa;

     eaAlfa = nCanti17;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#22", aAlfa;

     eaAlfa = nCanti18;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %"; |WORD_ASIGNA_CAMPO nWord, "#23", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO CuadroGes4;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = ((#102#06 / #102#069) * 100) ! 3;
         nCanti2 = ((#102#70 / #102#133) * 100) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;

         nCanti4 = ((#102#08 / #102#069) * 100) ! 3;
         nCanti5 = ((#102#72 / #102#133) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = (((#102#09 + #102#19 + #102#27) / #102#069) * 100) ! 3;
         nCanti8 = (((#102#73 + #102#83 + #102#91) / #102#133) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = ((#102#036 / #102#069) * 100) ! 3;
         nCanti11 = ((#102#100 / #102#133) * 100) ! 3;
         nCanti12 = (nCanti11 - nCanti10) ! 3;

         nCanti13 = ((#102#038 / #102#069) * 100) ! 3;
         nCanti14 = ((#102#102 / #102#133) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = ((#102#041 / #102#069) * 100) ! 3;
         nCanti17 = ((#102#105 / #102#133) * 100) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         nCanti19 = (((#102#049 + #102#057 + #102#066 + #102#068) / #102#069) * 100) ! 3;
         nCanti20 = (((#102#113 + #102#121 + #102#130 + #102#132) / #102#133) * 100) ! 3;
         nCanti21 = (nCanti20 - nCanti19) ! 3;

         nCanti22 = ((#102#067 / #102#069) * 100) ! 3;
         nCanti23 = ((#102#131 / #102#133) * 100) ! 3;
         nCanti24 = (nCanti23 - nCanti22) ! 3;

         nCanti25 = ((#103#06 / #103#078) * 100) ! 3;
         nCanti26 = ((#103#79 / #103#151) * 100) ! 3;
         nCanti27 = (nCanti26 - nCanti25) ! 3;

         nCanti28 = ((#103#23 / #103#078) * 100) ! 3;
         nCanti29 = ((#103#96 / #103#151) * 100) ! 3;
         nCanti30 = (nCanti29 - nCanti28) ! 3;

         nCanti31 = (((#103#027 + #103#032) / #103#078) * 100) ! 3;
         nCanti32 = (((#103#100 + #103#105) / #103#151) * 100) ! 3;
         nCanti33 = (nCanti32 - nCanti31) ! 3;

         nCanti34 = ((#103#052 / #103#078) * 100) ! 3;
         nCanti35 = ((#103#125 / #103#151) * 100) ! 3;
         nCanti36 = (nCanti35 - nCanti34) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = ((#122#06 / #122#071) * 100) ! 3;
         nCanti2 = ((#122#72 / #122#137) * 100) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;

         nCanti4 = ((#122#08 / #122#071) * 100) ! 3;
         nCanti5 = ((#122#74 / #122#137) * 100) ! 3;
         nCanti6 = (nCanti5 - nCanti4) ! 3;

         nCanti7 = (((#122#09 + #122#18 + #122#26) / #122#071) * 100) ! 3;
         nCanti8 = (((#122#75 + #122#84 + #122#92) / #122#137) * 100) ! 3;
         nCanti9 = (nCanti8 - nCanti7) ! 3;

         nCanti10 = 0;
         nCanti11 = 0;
         nCanti12 = 0;

         nCanti13 = ((#122#037 / #122#071) * 100) ! 3;
         nCanti14 = ((#122#103 / #122#137) * 100) ! 3;
         nCanti15 = (nCanti14 - nCanti13) ! 3;

         nCanti16 = ((#122#040 / #122#071) * 100) ! 3;
         nCanti17 = ((#122#106 / #122#137) * 100) ! 3;
         nCanti18 = (nCanti17 - nCanti16) ! 3;

         nCanti19 = (((#122#048 + #122#058 + #122#070) / #122#071) * 100) ! 3;
         nCanti20 = (((#122#114 + #122#124 + #122#136) / #122#137) * 100) ! 3;
         nCanti21 = (nCanti20 - nCanti19) ! 3;

         nCanti22 = ((#122#069 / #122#071) * 100) ! 3;
         nCanti23 = ((#122#135 / #122#137) * 100) ! 3;
         nCanti24 = (nCanti23 - nCanti22) ! 3;

         nCanti25 = ((#123#06 / #123#078) * 100) ! 3;
         nCanti26 = ((#123#79 / #123#151) * 100) ! 3;
         nCanti27 = (nCanti26 - nCanti25) ! 3;

         nCanti28 = ((#123#23 / #123#078) * 100) ! 3;
         nCanti29 = ((#123#96 / #123#151) * 100) ! 3;
         nCanti30 = (nCanti29 - nCanti28) ! 3;

         nCanti31 = (((#123#026 + #123#031) / #123#078) * 100) ! 3;
         nCanti32 = (((#123#099 + #123#104) / #123#151) * 100) ! 3;
         nCanti33 = (nCanti32 - nCanti31) ! 3;

         nCanti34 = ((#123#051 / #123#078) * 100) ! 3;
         nCanti35 = ((#123#124 / #123#151) * 100) ! 3;
         nCanti36 = (nCanti35 - nCanti34) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#5",  aAlfa;

     eaAlfa = nCanti4;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaAlfa = nCanti5;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#7",  aAlfa;

     eaAlfa = nCanti6;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#8",  aAlfa;

     eaAlfa = nCanti7;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#9",  aAlfa;

     eaAlfa = nCanti8;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#10", aAlfa;

     eaAlfa = nCanti9;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %";  |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;

     eaAlfa = nCanti10;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#12", aAlfa;

     eaAlfa = nCanti11;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#13", aAlfa;

     eaAlfa = nCanti12;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#14", aAlfa;

     eaAlfa = nCanti13;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#15", aAlfa;

     eaAlfa = nCanti14;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#16", aAlfa;

     eaAlfa = nCanti15;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#17", aAlfa;

     eaAlfa = nCanti16;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#18", aAlfa;

     eaAlfa = nCanti17;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#19", aAlfa;

     eaAlfa = nCanti18;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#20", aAlfa;

     eaAlfa = nCanti19;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#21", aAlfa;

     eaAlfa = nCanti20;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#22", aAlfa;

     eaAlfa = nCanti21;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#23", aAlfa;

     eaAlfa = nCanti22;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#24", aAlfa;

     eaAlfa = nCanti23;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#25", aAlfa;

     eaAlfa = nCanti24;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#26", aAlfa;

     aAlfa = ("       " +    "100") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#27", aAlfa;
     aAlfa = ("       " +    "100") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#28", aAlfa;
     aAlfa = ("       " +      "0") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#29", aAlfa;

     eaAlfa = nCanti25;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#30",  aAlfa;

     eaAlfa = nCanti26;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#31",  aAlfa;

     eaAlfa = nCanti27;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#32",  aAlfa;

     eaAlfa = nCanti28;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#33",  aAlfa;

     eaAlfa = nCanti29;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#34",  aAlfa;

     eaAlfa = nCanti30;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#35",  aAlfa;

     eaAlfa = nCanti31;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#36",  aAlfa;

     eaAlfa = nCanti32;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#37",  aAlfa;

     eaAlfa = nCanti33;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#38",  aAlfa;

     eaAlfa = nCanti34;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#39",  aAlfa;

     eaAlfa = nCanti35;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#40",  aAlfa;

     eaAlfa = nCanti36;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107  + " %"; |WORD_ASIGNA_CAMPO nWord, "#41",  aAlfa;

     aAlfa = ("       " +    "100") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#42", aAlfa;
     aAlfa = ("       " +    "100") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#43", aAlfa;
     aAlfa = ("       " +      "0") % -107 + " %";  |WORD_ASIGNA_CAMPO nWord, "#44", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO CuadroGes5;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = #102#131; nCanti2 = #102#67;
         |SI nCanti1 ] nCanti2;
             nCanti3 = nCanti1 - nCanti2;
             nCanti4 = 0;
         |SINO;
             nCanti4 = nCanti2 - nCanti1;
             nCanti3 = 0;
         |FINSI;

         nCanti5 = #102#104 + #102#113 + #102#121 + #102#130 + #102#132;
         nCanti6 = #102#040 + #102#049 + #102#057 + #102#066 + #102#068;
         |SI nCanti5 ] nCanti6;
             nCanti7 = nCanti5 - nCanti6;
             nCanti8 = 0;
         |SINO;
             nCanti8 = nCanti6 - nCanti5;
             nCanti7 = 0;
         |FINSI;

         nCanti9 = #102#105; nCanti10 = #102#41;
         |SI nCanti9 ] nCanti10;
             nCanti11 = nCanti9 - nCanti10;
             nCanti12 = 0;
         |SINO;
             nCanti12 = nCanti10 - nCanti9;
             nCanti11 = 0;
         |FINSI;

         nCanti13 = #103#125; nCanti14 = #103#52;
         |SI nCanti13 [ nCanti14;
             nCanti15 = nCanti14 - nCanti13;
             nCanti16 = 0;
         |SINO;
             nCanti16 = nCanti13 - nCanti14;
             nCanti15 = 0;
         |FINSI;

         nNumero1 = nCanti3 + nCanti7 + nCanti11 + nCanti15;
         nNumero2 = nCanti4 + nCanti8 + nCanti12 + nCanti16;
         |SI nNumero1 [ nNumero2;
             nCanti17 = nNumero2 - nNumero1;
             nCanti18 = 0;
         |SINO;
             nCanti17 = 0;
             nCanti18 = nNumero1 - nNumero2;
         |FINSI;
         nCanti19 = nCanti17 + nNumero1;
         nCanti20 = nCanti18 + nNumero2;

         nCanti21 = #102#70; nCanti22 = #102#6;
         |SI nCanti21 ] nCanti22;
             nCanti23 = nCanti21 - nCanti22;
             nCanti24 = 0;
         |SINO;
             nCanti24 = nCanti22 - nCanti21;
             nCanti23 = 0;
         |FINSI;

         nCanti25 = #102#72; nCanti26 = #102#8;
         |SI nCanti25 ] nCanti26;
             nCanti27 = nCanti25 - nCanti26;
             nCanti28 = 0;
         |SINO;
             nCanti28 = nCanti26 - nCanti25;
             nCanti27 = 0;
         |FINSI;

         nCanti29 = #102#73; nCanti30 = #102#9;
         |SI nCanti29 ] nCanti30;
             nCanti31 = nCanti29 - nCanti30;
             nCanti32 = 0;
         |SINO;
             nCanti32 = nCanti30 - nCanti29;
             nCanti31 = 0;
         |FINSI;

         nCanti33 = #102#83; nCanti34 = #102#19;
         |SI nCanti33 ] nCanti34;
             nCanti35 = nCanti33 - nCanti34;
             nCanti36 = 0;
         |SINO;
             nCanti36 = nCanti34 - nCanti33;
             nCanti35 = 0;
         |FINSI;

         nCanti37 = #102#91; nCanti38 = #102#27;
         |SI nCanti37 ] nCanti38;
             nCanti39 = nCanti37 - nCanti38;
             nCanti40 = 0;
         |SINO;
             nCanti40 = nCanti38 - nCanti37;
             nCanti39 = 0;
         |FINSI;

         nCanti41 = #102#100; nCanti42 = #102#36;
         |SI nCanti41 ] nCanti42;
             nCanti43 = nCanti41 - nCanti42;
             nCanti44 = 0;
         |SINO;
             nCanti44 = nCanti42 - nCanti41;
             nCanti43 = 0;
         |FINSI;

         nCanti45 = #102#102; nCanti46 = #102#38;
         |SI nCanti45 ] nCanti46;
             nCanti47 = nCanti45 - nCanti46;
             nCanti48 = 0;
         |SINO;
             nCanti48 = nCanti46 - nCanti45;
             nCanti47 = 0;
         |FINSI;

         nCanti49 = #103#96 + #103#100 + #103#105;
         nCanti50 = #103#23 + #103#027 + #103#032;
         |SI nCanti49 [ nCanti50;
             nCanti51 = nCanti50 - nCanti49;
             nCanti52 = 0;
         |SINO;
             nCanti52 = nCanti49 - nCanti50;
             nCanti51 = 0;
         |FINSI;

         nCanti53 = #103#80 + #103#81 + #103#82 + #103#83 + #103#89 + #103#93 + #103#94;
         nCanti54 = #103#07 + #103#08 + #103#09 + #103#10 + #103#16 + #103#20 + #103#21;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = #122#135; nCanti2 = #122#69;
         |SI nCanti1 ] nCanti2;
             nCanti3 = nCanti1 - nCanti2;
             nCanti4 = 0;
         |SINO;
             nCanti4 = nCanti2 - nCanti1;
             nCanti3 = 0;
         |FINSI;

         nCanti5 = #122#105 + #122#114 + #122#124 + #122#136;
         nCanti6 = #122#039 + #122#048 + #122#058 + #122#070;
         |SI nCanti5 ] nCanti6;
             nCanti7 = nCanti5 - nCanti6;
             nCanti8 = 0;
         |SINO;
             nCanti8 = nCanti6 - nCanti5;
             nCanti7 = 0;
         |FINSI;

         nCanti9 = #122#106; nCanti10 = #122#40;
         |SI nCanti9 ] nCanti10;
             nCanti11 = nCanti9 - nCanti10;
             nCanti12 = 0;
         |SINO;
             nCanti12 = nCanti10 - nCanti9;
             nCanti11 = 0;
         |FINSI;

         nCanti13 = #123#124; nCanti14 = #123#51;
         |SI nCanti13 [ nCanti14;
             nCanti15 = nCanti14 - nCanti13;
             nCanti16 = 0;
         |SINO;
             nCanti16 = nCanti13 - nCanti14;
             nCanti15 = 0;
         |FINSI;

         nNumero1 = nCanti3 + nCanti7 + nCanti11 + nCanti15;
         nNumero2 = nCanti4 + nCanti8 + nCanti12 + nCanti16;
         |SI nNumero1 [ nNumero2;
             nCanti17 = nNumero2 - nNumero1;
             nCanti18 = 0;
         |SINO;
             nCanti17 = 0;
             nCanti18 = nNumero1 - nNumero2;
         |FINSI;
         nCanti19 = nCanti17 + nNumero1;
         nCanti20 = nCanti18 + nNumero2;

         nCanti21 = #122#72; nCanti22 = #122#6;
         |SI nCanti21 ] nCanti22;
             nCanti23 = nCanti21 - nCanti22;
             nCanti24 = 0;
         |SINO;
             nCanti24 = nCanti22 - nCanti21;
             nCanti23 = 0;
         |FINSI;

         nCanti25 = #122#74; nCanti26 = #122#8;
         |SI nCanti25 ] nCanti26;
             nCanti27 = nCanti25 - nCanti26;
             nCanti28 = 0;
         |SINO;
             nCanti28 = nCanti26 - nCanti25;
             nCanti27 = 0;
         |FINSI;

         nCanti29 = #122#75; nCanti30 = #122#9;
         |SI nCanti29 ] nCanti30;
             nCanti31 = nCanti29 - nCanti30;
             nCanti32 = 0;
         |SINO;
             nCanti32 = nCanti30 - nCanti29;
             nCanti31 = 0;
         |FINSI;

         nCanti33 = #122#84; nCanti34 = #122#18;
         |SI nCanti33 ] nCanti34;
             nCanti35 = nCanti33 - nCanti34;
             nCanti36 = 0;
         |SINO;
             nCanti36 = nCanti34 - nCanti33;
             nCanti35 = 0;
         |FINSI;

         nCanti37 = #122#92; nCanti38 = #122#26;
         |SI nCanti37 ] nCanti38;
             nCanti39 = nCanti37 - nCanti38;
             nCanti40 = 0;
         |SINO;
             nCanti40 = nCanti38 - nCanti37;
             nCanti39 = 0;
         |FINSI;

         nCanti41 = 0; nCanti42 = 0;
         |SI nCanti41 ] nCanti42;
             nCanti43 = nCanti41 - nCanti42;
             nCanti44 = 0;
         |SINO;
             nCanti44 = nCanti42 - nCanti41;
             nCanti43 = 0;
         |FINSI;

         nCanti45 = #122#103; nCanti46 = #122#37;
         |SI nCanti45 ] nCanti46;
             nCanti47 = nCanti45 - nCanti46;
             nCanti48 = 0;
         |SINO;
             nCanti48 = nCanti46 - nCanti45;
             nCanti47 = 0;
         |FINSI;

         nCanti49 = #123#94 + #123#099 + #123#104;
         nCanti50 = #123#21 + #123#026 + #123#031;
         |SI nCanti49 [ nCanti50;
             nCanti51 = nCanti50 - nCanti49;
             nCanti52 = 0;
         |SINO;
             nCanti52 = nCanti49 - nCanti50;
             nCanti51 = 0;
         |FINSI;

         nCanti53 = #123#80 + #123#81 + #123#82 + #123#87 + #123#91 + #123#92 + #123#93;
         nCanti54 = #123#07 + #123#08 + #123#09 + #123#14 + #123#18 + #123#19 + #123#20;
     |FINSI;

     |SI nCanti53 [ nCanti54;
         nCanti55 = nCanti54 - nCanti53;
         nCanti56 = 0;
     |SINO;
         nCanti56 = nCanti53 - nCanti54;
         nCanti55 = 0;
     |FINSI;

     nNumero1 = nCanti23 + nCanti27 + nCanti31 + nCanti35 + nCanti39 + nCanti43 + nCanti47;
     nNumero1 = nNumero1 + nCanti51 + nCanti55;
     nNumero2 = nCanti24 + nCanti28 + nCanti32 + nCanti36 + nCanti40 + nCanti44 + nCanti48;
     nNumero2 = nNumero2 + nCanti52 + nCanti56;
     |SI nNumero1 [ nNumero2;
         nCanti57 = nNumero2 - nNumero1;
         nCanti58 = 0;
     |SINO;
         nCanti57 = 0;
         nCanti58 = nNumero1 - nNumero2;
     |FINSI;
     nCanti59 = nCanti57 + nNumero1;
     nCanti60 = nCanti58 + nNumero2;

     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaImporte = nCanti1; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;
     eaImporte = nCanti2; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;
     eaImporte = nCanti3; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#5",  aAlfa;
     eaImporte = nCanti4; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaImporte = nCanti5; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#7",  aAlfa;
     eaImporte = nCanti6; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#8",  aAlfa;
     eaImporte = nCanti7; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#9",  aAlfa;
     eaImporte = nCanti8; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#10", aAlfa;

     eaImporte = nCanti9;  |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;
     eaImporte = nCanti10; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#12", aAlfa;
     eaImporte = nCanti11; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#13", aAlfa;
     eaImporte = nCanti12; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#14", aAlfa;

     eaImporte = nCanti13; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#15", aAlfa;
     eaImporte = nCanti14; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#16", aAlfa;
     eaImporte = nCanti15; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#17", aAlfa;
     eaImporte = nCanti16; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#18", aAlfa;

     eaImporte = nCanti17; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#19", aAlfa;
     eaImporte = nCanti18; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#20", aAlfa;

     eaImporte = nCanti19; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#21", aAlfa;
     eaImporte = nCanti20; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#22", aAlfa;

     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#23", aAlfa;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#24", aAlfa;

     eaImporte = nCanti21; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#25", aAlfa;
     eaImporte = nCanti22; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#26", aAlfa;
     eaImporte = nCanti23; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#27", aAlfa;
     eaImporte = nCanti24; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#28", aAlfa;

     eaImporte = nCanti25; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#29",  aAlfa;
     eaImporte = nCanti26; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#30",  aAlfa;
     eaImporte = nCanti27; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#31",  aAlfa;
     eaImporte = nCanti28; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#32",  aAlfa;

     eaImporte = nCanti29; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#33",  aAlfa;
     eaImporte = nCanti30; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#34",  aAlfa;
     eaImporte = nCanti31; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#35",  aAlfa;
     eaImporte = nCanti32; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#36",  aAlfa;

     eaImporte = nCanti33; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#37",  aAlfa;
     eaImporte = nCanti34; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#38",  aAlfa;
     eaImporte = nCanti35; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#39",  aAlfa;
     eaImporte = nCanti36; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#40",  aAlfa;

     eaImporte = nCanti37; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#41",  aAlfa;
     eaImporte = nCanti38; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#42",  aAlfa;
     eaImporte = nCanti39; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#43",  aAlfa;
     eaImporte = nCanti40; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#44",  aAlfa;

     eaImporte = nCanti41; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#45",  aAlfa;
     eaImporte = nCanti42; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#46",  aAlfa;
     eaImporte = nCanti43; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#47",  aAlfa;
     eaImporte = nCanti44; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#48",  aAlfa;

     eaImporte = nCanti45; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#49",  aAlfa;
     eaImporte = nCanti46; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#50",  aAlfa;
     eaImporte = nCanti47; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#51",  aAlfa;
     eaImporte = nCanti48; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#52",  aAlfa;

     eaImporte = nCanti49; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#53",  aAlfa;
     eaImporte = nCanti50; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#54",  aAlfa;
     eaImporte = nCanti51; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#55",  aAlfa;
     eaImporte = nCanti52; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#56",  aAlfa;

     eaImporte = nCanti53; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#57",  aAlfa;
     eaImporte = nCanti54; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#58",  aAlfa;
     eaImporte = nCanti55; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#59",  aAlfa;
     eaImporte = nCanti56; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#60",  aAlfa;

     eaImporte = nCanti57; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#61",  aAlfa;
     eaImporte = nCanti58; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#62",  aAlfa;

     eaImporte = nCanti59; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#63",  aAlfa;
     eaImporte = nCanti60; |HAZ Importe; aAlfa = eaImporte; |WORD_ASIGNA_CAMPO nWord, "#64",  aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO CuadroGes6;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1  = #105#46 + #105#52;
         nCanti2  = 100;

         nCanti3  = #104#46;
         nCanti4  = ((nCanti3  / nCanti1) * 100) ! 3;

         nCanti5  = 0;
         nCanti6  = 0;

         nCanti7  = nCanti1 - nCanti3 - nCanti5;
         nCanti8  = ((nCanti7  / nCanti1) * 100) ! 3;

         nCanti9  = #104#52 + #104#53;
         nCanti10 = ((nCanti9  / nCanti1) * 100) ! 3;

         nCanti11 = #104#54;
         nCanti12 = ((nCanti11 / nCanti1) * 100) ! 3;

         nCanti13 = #104#55 + #104#59;
         nCanti14 = ((nCanti13 / nCanti1) * 100) ! 3;

         nCanti15 = nCanti9 + nCanti11 + nCanti13;
         nCanti16 = ((nCanti15 / nCanti1) * 100) ! 3;


         nCanti17 = #104#68 - #105#69;
         nCanti18 = ((nCanti17 / nCanti1) * 100) ! 3;

         nCanti19 = nCanti15 + nCanti17;
         nCanti20 = ((nCanti19 / nCanti1) * 100) ! 3;

         nCanti21 = (nCanti19 / (nCanti7 / nCanti1)) ! 0;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1  = #125#50 + #125#56;
         nCanti2  = 100;

         nCanti3  = #124#52;
         nCanti4  = ((nCanti3  / nCanti1) * 100) ! 3;

         nCanti5  = 0;
         nCanti6  = 0;

         nCanti7  = nCanti1 - nCanti3 - nCanti5;
         nCanti8  = ((nCanti7  / nCanti1) * 100) ! 3;

         nCanti9  = #124#58 + #124#59;
         nCanti10 = ((nCanti9  / nCanti1) * 100) ! 3;

         nCanti11 = #124#63;
         nCanti12 = ((nCanti11 / nCanti1) * 100) ! 3;

         nCanti13 = #124#64 + #124#68;
         nCanti14 = ((nCanti13 / nCanti1) * 100) ! 3;

         nCanti15 = nCanti9 + nCanti11 + nCanti13;
         nCanti16 = ((nCanti15 / nCanti1) * 100) ! 3;

         nCanti17 = #124#77 - #125#75;
         nCanti18 = ((nCanti17 / nCanti1) * 100) ! 3;

         nCanti19 = nCanti15 + nCanti17;
         nCanti20 = ((nCanti19 / nCanti1) * 100) ! 3;

         nCanti21 = (nCanti19 / (nCanti7 / nCanti1)) ! 0;
     |FINSI;

     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;

     eaImporte = nCanti1; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#2",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#3", aAlfa;

     eaImporte = nCanti3; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti4;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     eaImporte = nCanti5; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#6",  aAlfa;

     eaAlfa = nCanti6;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#7", aAlfa;

     eaImporte = nCanti7; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#8",  aAlfa;

     eaAlfa = nCanti8;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#9", aAlfa;

     eaImporte = nCanti9; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#10",  aAlfa;

     eaAlfa = nCanti10;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#11", aAlfa;

     eaImporte = nCanti11; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#12",  aAlfa;

     eaAlfa = nCanti12;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#13", aAlfa;

     eaImporte = nCanti13; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#14",  aAlfa;

     eaAlfa = nCanti14;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#15", aAlfa;

     eaImporte = nCanti15; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#16",  aAlfa;

     eaAlfa = nCanti16;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#17", aAlfa;

     eaImporte = nCanti17; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#18",  aAlfa;

     eaAlfa = nCanti18;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#19", aAlfa;

     eaImporte = nCanti19; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#20",  aAlfa;

     eaAlfa = nCanti20;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + " %";
     |WORD_ASIGNA_CAMPO nWord, "#21", aAlfa;

     eaImporte = nCanti21; |HAZ Importe; aAlfa = eaImporte;
     |WORD_ASIGNA_CAMPO nWord, "#22",  aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes1;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nImpor1 = ((#103#027 + #103#032 + #103#052) / #103#078) ! 3;
         nImpor2 = ((#103#100 + #103#105 + #103#125) / #103#151) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = ((#123#026 + #123#031 + #123#051) / #123#078) ! 3;
         nImpor2 = ((#123#099 + #123#104 + #123#124) / #123#151) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nImpor1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nImpor2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes2;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nImpor1 = ((#103#052 / (#103#027 + #103#032 + #103#052))) ! 3;
         nImpor2 = ((#103#125 / (#103#100 + #103#105 + #103#125))) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = ((#123#051 / (#123#026 + #123#031 + #123#051))) ! 3;
         nImpor2 = ((#123#124 / (#123#099 + #123#104 + #123#124))) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nImpor1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nImpor2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes3;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nImpor1 = ((#102#040+#102#041+#102#049+#102#057+#102#066+#102#067+#102#068)/#103#052) ! 3;
         nImpor2 = ((#102#104+#102#105+#102#113+#102#121+#102#130+#102#131+#102#132)/#103#125) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = ((#122#039+#122#040+#122#048+#122#058+#122#069+#122#070)/#123#051) ! 3;
         nImpor2 = ((#122#105+#122#106+#122#114+#122#124+#122#135+#122#136)/#123#124) ! 3;
     |FINSI;

     nCanti1 = (nImpor2 - nImpor1) ! 3;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nImpor1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nImpor2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes4;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nImpor1 = ((#102#049 * 365) / #105#07) ! 3;
         nImpor2 = ((#102#113 * 365) / #105#45) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = ((#122#048 * 365) / #125#07) ! 3;
         nImpor2 = ((#122#114 * 365) / #125#49) ! 3;
         nCanti1 = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nImpor1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nImpor2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes5;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nImpor1 = ((#103#052 * 365) / #104#06) ! 3;
         nImpor2 = ((#103#125 * 365) / #104#45) ! 3;
         nCanti1  = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nImpor1 = ((#123#051 * 365) / #124#06) ! 3;
         nImpor2 = ((#123#124 * 365) / #124#51) ! 3;
         nCanti1  = (nImpor2 - nImpor1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nImpor1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nImpor2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes6;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = (#102#069 / (#103#027 + #103#032 + #103#052)) ! 3;
         nCanti2 = (#102#133 / (#103#100 + #103#105 + #103#125)) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = (#122#071 / (#123#026 + #123#031 + #123#051)) ! 3;
         nCanti2 = (#122#137 / (#123#099 + #123#104 + #123#124)) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes7;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = ((#102#040 + #102#049 + #102#057 + #102#066 + #102#067 + #102#068) / #103#052) ! 3;
         nCanti2 = ((#102#104 + #102#113 + #102#121 + #102#130 + #102#131 + #102#132) / #103#125) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = ((#122#039 + #122#048 + #122#058 + #122#069 + #122#070) / #123#051) ! 3;
         nCanti2 = ((#122#105 + #122#114 + #122#124 + #122#135 + #122#136) / #123#124) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;


     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes8;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = ((#102#006 + #102#007 + #102#038) / (#103#006 + #103#023 + #103#027 + #103#032)) ! 3;
         nCanti2 = ((#102#070 + #102#071 + #102#102) / (#103#079 + #103#096 + #103#100 + #103#105)) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = ((#122#006 + #122#007 + #122#037) / (#123#006 + #123#021 + #123#026 + #123#031)) ! 3;
         nCanti2 = ((#122#072 + #122#073 + #122#103) / (#123#079 + #123#094 + #123#099 + #123#104)) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;


     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes9;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
        nCanti1 = (#103#006 / #102#069) ! 3;
        nCanti2 = (#103#079 / #102#133) ! 3;
        nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
        nCanti1 = (#123#006 / #122#071) ! 3;
        nCanti2 = (#123#079 / #122#137) ! 3;
        nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO RatioGes10;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #200#13 = "N";
         nCanti1 = (#103#020 / #103#006) ! 3;
         nCanti2 = (#103#093 / #103#079) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     |SI #200#13 = "S";
         nCanti1 = (#123#018 / #123#006) ! 3;
         nCanti2 = (#123#091 / #123#079) ! 3;
         nCanti3 = (nCanti2 - nCanti1) ! 3;
     |FINSI;

     nNume = #101#5 - 1;
     aAlfa = nNume;  |WORD_ASIGNA_CAMPO nWord, "#1", aAlfa;
     aAlfa = #101#5; |WORD_ASIGNA_CAMPO nWord, "#2", aAlfa;

     eaAlfa = nCanti1;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#3",  aAlfa;

     eaAlfa = nCanti2;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#4",  aAlfa;

     eaAlfa = nCanti3;  |HAZ PonComas;
     aAlfa = ("       " + eaAlfa) % -107 + "  ";
     |WORD_ASIGNA_CAMPO nWord, "#5", aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO EjercicioG;
     eaAlfa = "Abro el documento " + aDestino1;
     |HAZ GeneraLog;

     nWord = 2;
     |WORD_ABRE nWord, aDestino1;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     nNume = #101#5 - 1;
     aAlfa = nNume;
     |WORD_ASIGNA_CAMPO nWord, "&EJERANT",  aAlfa;


     aAlfa = #101#5;
     |WORD_ASIGNA_CAMPO nWord, "&EJERACT",  aAlfa;

     aAlfa = "30 de marzo de 1.999.";
     |WORD_ASIGNA_CAMPO nWord, "&FECHA",  aAlfa;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|PROCESO LeeBalance;
     |ABRE #200;
     #200#0 = #101#0;
     #200#1 = #101#5;
     |LEE 000#200=;
     |SI FSalida ! 0;  |DDEFECTO #200;  |FINSI;
     |CIERRA #200;

     |SI #200#13 = "N";
         |ABRE #102;
         #102#0 = #101#0;
         #102#1 = #101#5;
         |LEE 040#102=;
         |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;
         |CIERRA #102;

         |ABRE #103;
         #103#0 = #101#0;
         #103#1 = #101#5;
         |LEE 040#103=;
         |SI FSalida ! 0;  |DDEFECTO #103;  |FINSI;
         |CIERRA #103;

         |ABRE #104;
         #104#0 = #101#0;
         #104#1 = #101#5;
         |LEE 040#104=;
         |SI FSalida ! 0;  |DDEFECTO #104;  |FINSI;
         |CIERRA #104;

         |ABRE #105;
         #105#0 = #101#0;
         #105#1 = #101#5;
         |LEE 040#105=;
         |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;
         |CIERRA #105;
     |FINSI;

     |SI #200#13 = "S";
         |ABRE #122;
         #122#0 = #101#0;
         #122#1 = #101#5;
         |LEE 040#122=;
         |SI FSalida ! 0;  |DDEFECTO #122;  |FINSI;
         |CIERRA #122;

         |ABRE #123;
         #123#0 = #101#0;
         #123#1 = #101#5;
         |LEE 040#123=;
         |SI FSalida ! 0;  |DDEFECTO #123;  |FINSI;
         |CIERRA #123;

         |ABRE #124;
         #124#0 = #101#0;
         #124#1 = #101#5;
         |LEE 040#124=;
         |SI FSalida ! 0;  |DDEFECTO #124;  |FINSI;
         |CIERRA #124;

         |ABRE #125;
         #125#0 = #101#0;
         #125#1 = #101#5;
         |LEE 040#125=;
         |SI FSalida ! 0;  |DDEFECTO #125;  |FINSI;
         |CIERRA #125;
     |FINSI;
|FPRC;

|PROCESO CapitulosG;
     #502#0 = "G";
     #502#1 = #100#0;
     #502#4 = 0000; || Ejercicio a Imprimir
     |LEE 040#502=;
     |SI FSalida ! 0;   |ACABA;  |FINSI;
     |SI #502#3 = "N";  |ACABA;  |FINSI;

     nSwAsignar = 1;
     |SI nSwPrimero = 0;
         |HAZ LeeTempoGest;
         |SI nSwEmpresa = 0;
             aOrigen = aBase + "word/gestion/g" + #100#0 + ".doc";
         |SINO;
             aOrigen = aBase + "word/gestion/" + (("00000" + #101#0) % -105) + "/g" + #100#0 + ".doc";
         |FINSI;
         aDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/wgestio.doc";

         eaOrigen  = aOrigen;
         eaDestino = aDestino;
         |HAZ EnviaFichero;

         |ATRI S;  |PINTA 1320, "   ABRIENDO EL DOCUMENTO, WGESTIO.DOC   "; |ATRI s;

         eaAlfa = "Abro el documento " + aDestino;
         |HAZ GeneraLog;

         nWord = 1;
         |WORD_ABRE nWord, aDestino;
         |WORD_PROPIEDADES nWord, "Visible", "NO";

         eaAlfa = "Asigno variables en el documento";
         |HAZ GeneraLog;
     |FINSI;

     aAlfa = "   ASIGNANDO EL CAPITULO : " + "G" + #100#0 + ".DOC";
     |ATRI S;  |PINTA 1220, aAlfa;  |ATRI s;
     |ATRI S;  |PINTA 1320, "                                        "; |ATRI s;
     |ATRI S;  |PINTA 1420, "                                        "; |ATRI s;

     |SI #100#2 = "PORTADA        ";
         |HAZ PortadaGes;
         |SI nSwPrimero = 0;  nSwPrimero = 1;  |FINSI;
         |ACABA;
     |FINSI;

     |SI nSwPrimero = 0;  nSwPrimero = 1;  |ACABA;  |FINSI;

     |HAZ LeeTempoGest;
     |SI nSwEmpresa = 0;
         aOrigen1 = aBase + "word/gestion/g" + #100#0 + ".doc";
     |SINO;
         aOrigen1 = aBase + "word/gestion/" + (("00000" + #101#0) % -105) + "/g" + #100#0 + ".doc";
     |FINSI;
     aDestino1 = eaUnidadBasico + "/MODELOS/MEMORIAS/g" + #100#0 + ".doc";

     eaOrigen  = aOrigen1;
     eaDestino = aDestino1;
     |HAZ EnviaFichero;

     nWordAnt = nWord;

     |SI #100#2 = "CUADRO1        ";  |HAZ CuadroGes1;     |FINSI;
     |SI #100#2 = "CUADRO2        ";  |HAZ CuadroGes2;     |FINSI;
     |SI #100#2 = "CUADRO3        ";  |HAZ CuadroGes3;     |FINSI;
     |SI #100#2 = "CUADRO4        ";  |HAZ CuadroGes4;     |FINSI;
     |SI #100#2 = "CUADRO5        ";  |HAZ CuadroGes5;     |FINSI;
     |SI #100#2 = "CUADRO6        ";  |HAZ CuadroGes6;     |FINSI;
     |SI #100#2 = "RATIO1         ";  |HAZ RatioGes1;      |FINSI;
     |SI #100#2 = "RATIO2         ";  |HAZ RatioGes2;      |FINSI;
     |SI #100#2 = "RATIO3         ";  |HAZ RatioGes3;      |FINSI;
     |SI #100#2 = "RATIO4         ";  |HAZ RatioGes4;      |FINSI;
     |SI #100#2 = "RATIO5         ";  |HAZ RatioGes5;      |FINSI;
     |SI #100#2 = "RATIO6         ";  |HAZ RatioGes6;      |FINSI;
     |SI #100#2 = "RATIO7         ";  |HAZ RatioGes7;      |FINSI;
     |SI #100#2 = "RATIO8         ";  |HAZ RatioGes8;      |FINSI;
     |SI #100#2 = "RATIO9         ";  |HAZ RatioGes9;      |FINSI;
     |SI #100#2 = "RATIO10        ";  |HAZ RatioGes10;     |FINSI;
     |SI #100#2 = "EJERCICIOS     ";  |HAZ EjercicioG;     |FINSI;

     nWord    = nWordAnt;

     |SI nSwAsignar = 1;
         |WORD_CARGA_TEXTO nWord, "!<<PEGAR>>", aDestino1;

         |RFBORRA aDestino1;
     |SINO;
         |RFBORRA aDestino1;
     |FINSI;

     eaAlfa = "Borro el documento " + aDestino1;
     |HAZ GeneraLog;
|FPRC;

|DEFBUCLE medgword;
     #100#1;
     ;
     "000000";
     "zzzzzz";
     ;
     NULL, CapitulosG;
|FIN;

|PROCESO AsignaRef1;
     |PARA;  |SI;  |HACIENDO;
          |WORD_ASIGNA_TEXTO nWord,  aIdenti, aAlfa;
          |SI FSalida ! 0;  |SAL;  |FINSI;
     |SIGUE;
|FPRC;

|PROCESO CreaGestion;
     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;

     aParametro = PARAMETRO;
     aCapitulo  = aParametro % 106;     || Nombre Texto
     aEmpresa   = aParametro % 705;     || Codigo de Empresa
     aTipo      = aParametro % 1201;    || Memoria o Informe de Gestion
     aOpcion    = aParametro % 1301;    || Que se hace
     aExiste    = aParametro % 1401;    || Existe el Documento (1 si) (0 no)
     aPagina    = aParametro % 1904;    || Numero de Pagina
     nEmpresa   = aEmpresa;
     eaContador = "1,3,2";

     |HAZ CreaTempoGes;

     |ABRE #101;
     #101#0 = nEmpresa;
     |LEE 101#101=;
     |SI FSalida ! 0;
         |MENAV "    No esta Definida la Empresa de Memoria";
         |CIERRA #101;
         |ACABA;
     |FINSI;

     |PINPA #0#99;
     aAlfa = "Empresa : " + #101#1;  |QBF aAlfa;
     aAlfa = aAlfa + " Ejercicio : " + #101#5;

     |ATRI S;  |PINTA 0812, aAlfa;                                 |ATRI s;
     |ATRI P;  |PINTA 1926, "GENERANDOSE EL INFORME DE GESTION";   |ATRI p;

     aAnyo = #101#5;

     |DBASE aBase;  |QBF aBase;
     |HAZ LeeBalance;

     |ABRE #502;
     |BUCLE medgword;
     |CIERRA #502;

     aAlfa   = "(" + (("00000" + #101#0) % -105) + ")";
     aAlfa   = aAlfa + " " + #101#1;     |QBF aAlfa;
     aAlfa   = aAlfa + " / Ejercicio: " + #101#5;
     aIdenti = "!#REFERENCIA#";    |HAZ AsignaRef1;
     aIdenti = "!!@#REFERENCIA#";   |HAZ AsignaRef1;

     |WORD_PROPIEDADES nWord, "limpiafinal", "";
     |WORD_PROPIEDADES nWord, "Paginacion", aPagina;
     aUltPagina = "0000" + FSalida;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;

     aOrigen   = eaUnidadBasico + "/MODELOS/MEMORIAS/wgestio.doc";
     aDestino  = aBase + "emisiones/" + aEmpresa + "/" + aAnyo;  |MKDIR aDestino;
     aDestino  = aDestino + "/" + "wgestio.doc"

     eaOrigen  = aOrigen;
     eaDestino = aDestino;
     |HAZ RecibeFichero;

     |RFBORRA aOrigen;

     eaAlfa = "Borro el documento " + aOrigen;
     |HAZ GeneraLog;

     |ABRE #500;
     #500#0 = nEmpresa;
     #500#1 = #101#5;
     |LEE 101#500=;
     |SI FSalida ! 0;
         #500#0 = nEmpresa;
         #500#1 = #101#5;
         #500#2 = #101#1;
         |GRABA 020#500b;
     |FINSI;

     aAlfa   = aPagina % 203;
     nPagina = aUltPagina;
     #500#5  = aAlfa;
     #500#6  = nPagina - 1;
     |GRABA 020#500a;
     |LIBERA #500;
     |CIERRA #500;

     |ABRE #501;
     #501#0 = nEmpresa;
     #501#1 = #101#5;
     #501#2 = "wgestio.doc";
     |LEE 101#501=;
     |SI FSalida ! 0;
         #501#0 = nEmpresa;
         #501#1 = #101#5;
         #501#2 = "wgestio.doc";
         |GRABA 020#501b;
     |FINSI;
     #501#3 = "INFORME DE GESTION";
     #501#4 = ~;
     |HORA aHora;
     #501#5 = aHora % 102;
     #501#6 = aHora % 402;
     |GRABA 020#501a;
     |LIBERA #501;
     |CIERRA #501;

     |SI #500#7 = "S";
         #101#134 = #500#6;
     |SINO;
         #101#134 = #500#4;
     |FINSI;
     |GRABA 020#101a;
     |LIBERA #101;
     |CIERRA #101;
     |CIERRA #101;

     |ABRE #510;
     #510#0 = #101#0;
     #510#1 = #101#5;
     |LEE 101#510=;
     |SI FSalida = 0;
         |SI #500#7 = "S";
             #510#90 = #500#6;
         |SINO;
             #510#90 = #500#4;
         |FINSI;
         |GRABA 020#510a;
     |FINSI;
     |LIBERA #510;
     |CIERRA #510;

     |DELINDEX #98;
|FPRC;
