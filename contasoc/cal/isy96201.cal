|FICHEROS;
     isy96201 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto
     maempr01 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     isocie61 #11;              || Transparencia Fiscal
     maempr05 #12;              || Socios Transparencia Fiscal
     isocie57 #13;              || Balances
     isocie59 #14;              || Liquidacion
     isocie58 #15;              || Distribucion de Resultados
     isocie55 #16;              || Resumen de Deducciones
     isocie60 #17;              || Cooperativas
     isocie63 #18;              || Por Doble imposicion
     isocie62 #19;              || Compensaciones
     isyycasi #22;              || Casillas del 201

     isw00007 #90;
     isw00008 #99,MANTE;
     isw00009 #100;
     isw00010 #101;
     isw00011 #102;
     isw00012 #103;
     isw00013 #104;

     &haciend@ #706;
|FIN;

|VARIABLES;
     ZPara       = 0;
     ZPara1      = 0;
     XPara       = 0;
     Dia         = "";
     Mes         = "";
     _Anyo       = "";
     SwHay       = 0;
     DEmpre      = 0;
     HEmpre      = 0;
     Fichero     = "";
     VAlfa1      = "";
     VAlfa2      = "";
     _Informe    = "";
     ContaBucle  = 0;
     ContaBucleL = 0;
     Puntero     = 0;
     Puntar1     = 0;
     Puntar2     = 0;

     &enCodProv = 0;
     &enCodPobl = 0;

 {450}TablaN     = 0;
 {450}TablaA     = 0;

 {-1} Hojas      = "";
      Hojas1     = "2400";
      Hojas2     = "1";
      Hojas3     = "Elija impresion : ";
      Hojas4     = "CH";
      Hojas5     = "  papel Continuo  ";
      Hojas6     = "  papel Hoja a Hoja  ";
|FIN;


|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            #0XPara = 0; |PINTA #0XPara;
            |CAMPO_MODIFICA #0XPara, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            |CAMPO_MODIFICA #0XPara, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

|PROCESO CargaExplo;
  ITablaA = TablaA1 <-;

  Puntero = #22#0 - 1;
  ITablaA = ITablaA + Puntero;

  |PARA ZPara = 1; |SI ZPara [ 16; |HACIENDO ZPara = ZPara + 1;
        |SI #22ZPara ! 0;
             ITablaN = TablaN1 <-;
             Puntero = #22ZPara - 1;
             ITablaN = ITablaN + Puntero;
             ZPara1  = ZPara + 16;
             Puntar1 = TablaA;
             Puntar2 = TablaN;
             |SI #22ZPara1 = "+";
                 #104Puntar1 = #104Puntar1 + #13Puntar2;
             |SINO;
                 #104Puntar1 = #104Puntar1 - #13Puntar2;
             |FINSI;
        |FINSI;
  |SIGUE;
|FPRC;

|DEFBUCLE isyycasi;
  #22#1;
  ;
  1996, 000;
  1996, 999;
  ;
  NULL, CargaExplo;
|FIN;

|PROCESO LeeFich;
  |ABRE #1;
  #1#0 = #99#0;
  #1#1 = 1996;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
  |CIERRA #1;

  |ABRE #2;
  #2#0 = #1#0;
  #2#1 = #1#1;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
  |CIERRA #2;

  enCodProv = #2#29;
  enCodPobl = #2#30;
  |HAZ LeeHacienda;

  |ABRE #13;
  #13#0 = #1#0;
  #13#1 = #1#1;
  |LEE 040#13=;
  |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
  |CIERRA #13;

  |ABRE #11;
  #11#0 = #1#0;
  #11#1 = #1#1;
  |LEE 040#11=;
  |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
  |CIERRA #11;

  |ABRE #14;
  #14#0 = #1#0;
  #14#1 = #1#1;
  |LEE 040#14=;
  |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
  |CIERRA #14;

  |ABRE #15;
  #15#0 = #1#0;
  #15#1 = #1#1;
  |LEE 040#15=;
  |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
  |CIERRA #15;

  |ABRE #16;
  #16#0 = #1#0;
  #16#1 = #1#1;
  |LEE 040#16=;
  |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
  |CIERRA #16;

  |ABRE #17;
  #17#0 = #1#0;
  #17#1 = #1#1;
  |LEE 040#17=;
  |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
  |CIERRA #17;

  |ABRE #18;
  #18#0 = #1#0;
  #18#1 = #1#1;
  |LEE 040#18=;
  |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
  |CIERRA #18;

  |BUCLE isyycasi;
|FPRC;

|PROCESO Defectos;
  |DDEFECTO #100;
  |DDEFECTO #101;
  |DDEFECTO #102;
  |DDEFECTO #103;
  |DDEFECTO #104;
|FPRC;

|PROCESO Representante;
  ContaBucle = ContaBucle + 1;
  |SI ContaBucle = 1;
      #100#66 = #5#3 %  120;
      #100#67 = #5#3 % -120;
      #100#68 = #5#4;
      #100#69 = #5#5;
      #100#70 = #5#6;
  |FINSI;

  |SI ContaBucle = 2;
      #100#71 = #5#3 %  120;
      #100#72 = #5#3 % -120;
      #100#73 = #5#4;
      #100#74 = #5#5;
      #100#75 = #5#6;
  |FINSI;

  |SI ContaBucle = 3;
      #100#76 = #5#3 %  120;
      #100#77 = #5#3 % -120;
      #100#78 = #5#4;
      #100#79 = #5#5;
      #100#80 = #5#6;
  |FINSI;
|FPRC;

|DEFBUCLE maempr04;
  #5#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, Representante;
|FIN;

|PROCESO PuntoA;
  |SI ContaBucle ] 6;
      #101#27 = "";
      #101#28 = "";
      #101#29 = "Segun relaci¢n adjunta.";
      #101#30 = "";
      #101#31 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 5) + 2;  #101Puntero = #6#3;
  Puntero = Puntero + 1;           #101Puntero = #6#4;
  Puntero = Puntero + 1;           #101Puntero = #6#5;
  Puntero = Puntero + 1;           #101Puntero = #6#6;
  Puntero = Puntero + 1;           #101Puntero = #6#7;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr03;
  #6#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, PuntoA;
|FIN;

|PROCESO PuntoB1;
  |SI ContaBucle ] 6;
      #101#57 = "";
      #101#58 = "Segun relaci¢n adjunta.";
      #101#59 = 0;
      #101#60 = 0;
      #101#61 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 5) + 32; #101Puntero = #7#3;
  Puntero = Puntero + 1;           #101Puntero = #7#4;
  Puntero = Puntero + 1;           #101Puntero = #7#5;
  Puntero = Puntero + 1;           #101Puntero = #7#6;
  Puntero = Puntero + 1;           #101Puntero = #7#7;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr06;
  #7#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, PuntoB1;
|FIN;

|PROCESO PuntoB2;
  |SI ContaBucle ] 6;
      #101#92 = "";
      #101#93 = "";
      #101#94 = "Segun relaci¢n adjunta.";
      #101#95 = 0;
      #101#96 = 0;
      #101#97 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 6) + 62; #101Puntero = #8#3;
  Puntero = Puntero + 1;           #101Puntero = #8#4;
  Puntero = Puntero + 1;           #101Puntero = #8#5;
  Puntero = Puntero + 1;           #101Puntero = #8#6;
  Puntero = Puntero + 1;           #101Puntero = #8#7;
  Puntero = Puntero + 1;           #101Puntero = #8#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr02;
  #8#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  ;
  NULL, PuntoB2;
|FIN;

|PROCESO PuntoC1;
  |SI ContaBucle ] 6;
      #101#128 = "";
      #101#129 = "Segun relaci¢n adjunta.";
      #101#130 = "";
      #101#131 = "";
      #101#132 = "";
      #101#133 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 6) + 98; #101Puntero = #9#3;
  Puntero = Puntero + 1;           #101Puntero = #9#4;
  Puntero = Puntero + 1;           #101Puntero = #9#5;
  Puntero = Puntero + 1;           #101Puntero = #9#6;
  Puntero = Puntero + 1;           #101Puntero = #9#7;
  Puntero = Puntero + 1;           #101Puntero = #9#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr14;
  #9#1;
  ;
  #1#0, #1#1, 00, 00;
  #1#0, #1#1, 00, 99;
  ;
  NULL, PuntoC1;
|FIN;

|PROCESO PuntoC2;
  |SI ContaBucle ] 6;
      #101#164 = "";
      #101#165 = "Segun relaci¢n adjunta.";
      #101#166 = "";
      #101#167 = "";
      #101#168 = 0;
      #101#169 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 6) + 134; #101Puntero = #10#3;
  Puntero = Puntero + 1;            #101Puntero = #10#4;
  Puntero = Puntero + 1;            #101Puntero = #10#6;
  Puntero = Puntero + 1;            #101Puntero = #10#5;
  Puntero = Puntero + 1;            #101Puntero = #10#7;
  Puntero = Puntero + 1;            #101Puntero = #10#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr15;
  #10#1;
  ;
  #1#0, #1#1, 00, 00;
  #1#0, #1#1, 00, 99;
  ;
  NULL, PuntoC2;
|FIN;

|PROCESO PuntoE;
  |SI ContaBucle ] 13;
      #102#109 = "";
      #102#110 = "";
      #102#111 = "";
      #102#112 = "Segun relaci¢n adjunta.";
      #102#113 = 0;
      #102#114 = 0;
      #102#115 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 7) + 25;  #102Puntero = #12#3;
  Puntero = Puntero + 1;            #102Puntero = #12#4;
  Puntero = Puntero + 1;            #102Puntero = #12#5;
  Puntero = Puntero + 1;            #102Puntero = #12#6;
  Puntero = Puntero + 1;            #102Puntero = #12#7;
  Puntero = Puntero + 1;            #102Puntero = #12#8;
  Puntero = Puntero + 1;            #102Puntero = #12#9;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr05;
  #12#2;
  ;
  #1#0, #1#1, 999.99, 00;
  #1#0, #1#1,      0, 99;
  ;
  NULL, PuntoE;
|FIN;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|PROCESO Impresion;
  |SI Hojas2 = 1;
      _Informe = "h" + _Informe;
      |INFOR _Informe;
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |PRINT;   |PIEINF;   |FININF;
      |ACABA;
  |FINSI;

  |ET Comienzo;
      VAlfa1 = _Informe % -102;

      |SI VAlfa1 ! "11";
          #90#2 = "COLOQUE HOJA " + VAlfa1 + " DEL MODELO 201, <INTRO PARA IMPRIMIR>";
      |SINO;
          #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 201, <INTRO PARA IMPRIMIR>";
      |FINSI;

      |ATRI P; |PINTA #90#2; |ATRI 0;
      |PAUSA;

      _Informe = "m" + _Informe;
      |INFOR _Informe;
      |SI FSalida = 0;
          |PRINT; |PIEINF; |FININF;
          |CONFI "2400NDesea repetir la hoja : ";
          |SI FSalida = 0;  |VETE Comienzo;  |FINSI;
      |FINSI;
|FPRC;


|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO Hoja1;
  #100#0  = #706#2;                   || Delegacion
  #100#1  = #706#3;                   || Administracion
  VAlfa1  = #706#0;
  VAlfa2  = #706#1;
  #100#2  = (("00" + VAlfa1) % -102) + (("000" + VAlfa2) % -103);  || Codigo
  #100#3  = #2#31 % 102;            || Del Dia
  #100#4  = #2#31 % 402;            || Del Mes
  #100#5  = #2#31 % 902;            || Del A¤o
  #100#6  = #2#32 % 102;            || Al Dia
  #100#7  = #2#32 % 402;            || Al Mes
  #100#8  = #2#32 % 902;            || Al A¤o
  #100#9  = #2#16;                  || Ejercicio
  #100#10 = #2#17;                  || CNAE
  #100#11 = #2#3;                   || NIF
  #100#12 = #2#2;                   || Nombre
  #100#13 = #2#4;                   || SG
  #100#14 = #2#5;                   || Domicilio
  #100#15 = #2#6;                   || Numero
  #100#16 = #2#7;                   || Escalera
  #100#17 = #2#8;                   || Piso
  #100#18 = #2#9;                   || Puerta
  #100#19 = #2#15;                  || Telefono
  #100#20 = #2#13;                  || Municipio
  #100#21 = #2#10;                  || Codigo Provincia
  #100#22 = #2#14;                  || Provincia
  VAlfa1  = #2#10;
  VAlfa2  = #2#11;
  #100#23 = (("00" + VAlfa1) % -102) + (("000" + VAlfa2) % -103);  || Codigo
  |SI #2#98 = "S";  #100#24 = "X";  |FINSI;   || Es Complementaria
  #100#25 = #2#99;                  || N§ Justificante
  #100#26 = #2#100;                 || Digito N§ Justificante

  |ABRE #4;
  |PARA ZPara = 27;  |SI ZPara [ 54;  |HACIENDO ZPara = ZPara + 1;
        ZPara1 = ZPara - 26;
        #4#0 = #1#0;
        #4#1 = #1#1;
        #4#2 = ZPara1;
        |LEE 040#4=;
        |SI FSalida = 0;
            #100ZPara = "X";
            |SI ZPara1 = 9;  |O ZPara1 = 10;
                |SI #100#34 = 0;  #100#55 = #4#4;  |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |CIERRA #4;

  #100#56 = #2#75;                         || Empleados no fijos
  #100#57 = #2#76;                         || Empleados si fijos
  #100#58 = " ";
  |SI #2#34 = "S";  #100#58 = "X";  |FINSI;   || Renuncia
  #100#59 = #2#77;                         || Nombre Secretario
  #100#60 = #2#78;                         || NIF    Secretario
  #100#61 = #2#77;                         || Nombre Secretario
  #100#62 = #2#13;                         || Poblacion firma
  #100#63 = Dia;                           || Dia
  #100#64 = Mes;                           || Mes
  #100#65 = _Anyo;                         || A¤o

  ContaBucle = 0;    |BUCLE maempr04;

  _Informe = "9620101";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja2;
  #101#0 = #1#3;
  #101#1 = #1#2;

  ContaBucle = 0;    |BUCLE maempr03;
  ContaBucle = 0;    |BUCLE maempr06;
  ContaBucle = 0;    |BUCLE maempr02;
  ContaBucle = 0;    |BUCLE maempr14;
  ContaBucle = 0;    |BUCLE maempr15;

  _Informe = "9620102";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja3;
  #102#0 = #1#3;
  #102#1 = #1#2;

  |PARA ZPara = 2;  |SI ZPara [ 24;  |HACIENDO ZPara = ZPara + 1;
        #102ZPara = #11ZPara;
  |SIGUE;

  ContaBucle = 0;    |BUCLE maempr05;

  _Informe = "9620103";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja4;
  _Informe = "9620104";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5;
  _Informe = "9620105";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja6;
  _Informe = "9620106";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja7;
  _Informe = "9620107";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja8;
  |ABRE #19;
  #19#0 = #1#0;
  #19#1 = #1#1;
  #19#2 = 547;
  |LEE 040#19=;
  |SI FSalida = 0;
      |PARA ZPara = 4; |SI ZPara [ 26; |HACIENDO ZPara = ZPara + 1;
            ZPara1 = ZPara + 133;
            #102ZPara1 = #19ZPara;
      |SIGUE;
  |FINSI;

  #19#0 = #1#0;
  #19#1 = #1#1;
  #19#2 = 561;
  |LEE 040#19=;
  |SI FSalida = 0;
      |PARA ZPara = 4; |SI ZPara [ 26; |HACIENDO ZPara = ZPara + 1;
            ZPara1 = ZPara + 156;
            #102ZPara1 = #19ZPara;
      |SIGUE;
  |FINSI;
  |CIERRA #19;

  _Informe = "9620108";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja9;
  _Informe = "9620109";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja10;
  _Informe = "9620110";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja11;
  #100#0  = #706#2;                   || Delegacion
  #100#1  = #706#3;                   || Administracion
  VAlfa1  = #706#0;
  VAlfa2  = #706#1;
  #100#2  = (("00" + VAlfa1) % -102) + (("000" + VAlfa2) % -103);  || Codigo
  #100#3  = #2#31 % 102;            || Del Dia
  #100#4  = #2#31 % 402;            || Del Mes
  #100#5  = #2#31 % 902;            || Del A¤o
  #100#6  = #2#32 % 102;            || Al Dia
  #100#7  = #2#32 % 402;            || Al Mes
  #100#8  = #2#32 % 902;            || Al A¤o
  #100#9  = #2#16;                  || Ejercicio
  #100#10 = #2#17;                  || CNAE
  #100#11 = #2#3;                   || NIF
  #100#12 = #2#2;                   || Nombre
  #100#13 = #2#4;                   || SG
  #100#14 = #2#5;                   || Domicilio
  #100#15 = #2#6;                   || Numero
  #100#16 = #2#7;                   || Escalera
  #100#17 = #2#8;                   || Piso
  #100#18 = #2#9;                   || Puerta
  #100#19 = #2#15;                  || Telefono
  #100#20 = #2#13;                  || Municipio
  #100#21 = #2#10;                  || Codigo Provincia
  #100#22 = #2#14;                  || Provincia
  #100#62 = #2#13;                         || Poblacion firma
  #100#63 = Dia;                           || Dia
  #100#64 = Mes;                           || Mes
  #100#65 = _Anyo;                         || A¤o
  _Informe = "9620111";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja12;
  |SI Hojas2 ! 1;  |ACABA;  |FINSI;
  _Informe = "9620099";  |HAZ Impresion;
|FPRC;

|PROCESO ImprimeLos;
  |PINPA #0#90;
  #90#0 = #99#0;  |PINTA #90#0;
  #90#1 = #99#3;  |PINTA #90#1;

  |PARA XPara = 1; |SI XPara [ #99#4; |HACIENDO XPara = XPara + 1;
        |HAZ Defectos;
        #90#3 = XPara;  |PINTA #90#3;
        |HAZ LeeFich;
        |SI #0#38 = "S"; |HAZ Hoja1;  |FINSI;   || h9620101
        |SI #0#39 = "S"; |HAZ Hoja2;  |FINSI;   || h9620102
        |SI #0#40 = "S"; |HAZ Hoja3;  |FINSI;   || h9620103
        |SI #0#41 = "S"; |HAZ Hoja4;  |FINSI;   || h9620104
        |SI #0#42 = "S"; |HAZ Hoja5;  |FINSI;   || h9620105
        |SI #0#43 = "S"; |HAZ Hoja6;  |FINSI;   || h9620106
        |SI #0#44 = "S"; |HAZ Hoja7;  |FINSI;   || h9620107
        |SI #0#45 = "S"; |HAZ Hoja8;  |FINSI;   || h9620108
        |SI #0#46 = "S"; |HAZ Hoja9;  |FINSI;   || h9620109
        |SI #0#47 = "S"; |HAZ Hoja10; |FINSI;   || h9620110
        |SI #0#48 = "S"; |HAZ Hoja11; |FINSI;   || h9620111
        |SI #0#49 = "S"; |HAZ Hoja12; |FINSI;   || h9620099
  |SIGUE;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, "S";
  99999, "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
  |MENU Hojas;
  Hojas2 = FSalida;
  |SI Hojas2 ! 1; |Y Hojas2 ! 2; |ACABA; |FINSI;

  Dia   = #0#33 % 102;
  Mes   = #0#33 % 402;
  _Anyo = #0#33 % -101;

  |SI Mes = "01"; Mes = "Enero     "; |FINSI;
  |SI Mes = "02"; Mes = "Febrero   "; |FINSI;
  |SI Mes = "03"; Mes = "Marzo     "; |FINSI;
  |SI Mes = "04"; Mes = "Abril     "; |FINSI;
  |SI Mes = "05"; Mes = "Mayo      "; |FINSI;
  |SI Mes = "06"; Mes = "Junio     "; |FINSI;
  |SI Mes = "07"; Mes = "Julio     "; |FINSI;
  |SI Mes = "08"; Mes = "Agosto    "; |FINSI;
  |SI Mes = "09"; Mes = "Septiembre"; |FINSI;
  |SI Mes = "10"; Mes = "Octubre   "; |FINSI;
  |SI Mes = "11"; Mes = "Noviembre "; |FINSI;
  |SI Mes = "12"; Mes = "Diciembre "; |FINSI;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
  #99#0 = #1#0;
  #99#1 = "";
  #99#2 = "";
  #99#3 = #1#2;
  #99#4 = #0#37;
  #99#5 = "S";
  #99#6 = 1;
  #99#7 = #1#3;
  |GRABA 040#99n;

  SwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
  #1#1;
  4;
  1996, DEmpre, "A";
  1996, HEmpre, "A";
  ;
  NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
  Fichero = Usuario % 108;  |QBT Fichero;
  Fichero = ("01" + Fichero + "zzzzzzzz") % 108;
  |NOME_DAT #99 Fichero;
  |ABRE #99; |CIERRA #99; |DELINDEX #99;

  |ABRE #99;
  SwHay = 0;
  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE isacceso;
  |SINO;
      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            |SI #0XPara ! 0;
                DEmpre = #0XPara;
                HEmpre = #0XPara;
                |BUCLE isacceso;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwHay = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO CargaTabla;
  Pos = -1;
  ITablaN = TablaN101 <-;
  |PARA ZPara = 101; |SI ZPara [ 190; |HACIENDO ZPara = ZPara + 1;
        |SI ZPara [ 112;                 ZPara1  = ZPara - 98;  TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 114; |Y ZPara [ 131; ZPara1  = ZPara - 99;  TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 134; |Y ZPara [ 151; ZPara1  = ZPara - 101; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 154; |Y ZPara [ 158; ZPara1  = ZPara - 103; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 161; |Y ZPara [ 170; ZPara1  = ZPara - 105; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 173; |Y ZPara [ 186; ZPara1  = ZPara - 107; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 188; |Y ZPara [ 190; ZPara1  = ZPara - 108; TablaN  = ZPara1; |FINSI;

        ITablaN = ITablaN + 1;
  |SIGUE;

  ITablaN = TablaN201 <-;
  |PARA ZPara = 201; |SI ZPara [ 262; |HACIENDO ZPara = ZPara + 1;
        |SI ZPara [ 209;                 ZPara1  = ZPara - 118; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 211; |Y ZPara [ 213; ZPara1  = ZPara - 119; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 215; |Y ZPara [ 225; ZPara1  = ZPara - 120; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 227; |Y ZPara [ 231; ZPara1  = ZPara - 121; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 234; |Y ZPara [ 240; ZPara1  = ZPara - 123; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 242; |Y ZPara [ 256; ZPara1  = ZPara - 124; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 260; |Y ZPara [ 262; ZPara1  = ZPara - 127; TablaN  = ZPara1; |FINSI;

        ITablaN = ITablaN + 1;
  |SIGUE;

  ITablaN = TablaN301 <-;
  |PARA ZPara = 301; |SI ZPara [ 351; |HACIENDO ZPara = ZPara + 1;
        |SI ZPara [ 305;                 ZPara1  = ZPara - 165; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 307; |Y ZPara [ 311; ZPara1  = ZPara - 166; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 314; |Y ZPara [ 317; ZPara1  = ZPara - 168; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 320; |Y ZPara [ 323; ZPara1  = ZPara - 170; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 326; |Y ZPara [ 330; ZPara1  = ZPara - 172; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 333; |Y ZPara [ 337; ZPara1  = ZPara - 174; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 340; |Y ZPara [ 351; ZPara1  = ZPara - 176; TablaN  = ZPara1; |FINSI;

        ITablaN = ITablaN + 1;
  |SIGUE;

  ITablaN = TablaN401 <-;
  |PARA ZPara = 401; |SI ZPara [ 441; |HACIENDO ZPara = ZPara + 1;
        |SI ZPara [ 407;                 ZPara1  = ZPara - 225; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 410; |Y ZPara [ 413; ZPara1  = ZPara - 227; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 416; |Y ZPara [ 419; ZPara1  = ZPara - 229; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 422; |Y ZPara [ 425; ZPara1  = ZPara - 231; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 428; |Y ZPara [ 432; ZPara1  = ZPara - 233; TablaN  = ZPara1; |FINSI;
        |SI ZPara ] 434; |Y ZPara [ 441; ZPara1  = ZPara - 234; TablaN  = ZPara1; |FINSI;

        ITablaN = ITablaN + 1;
  |SIGUE;

  ITablaA = TablaA101 <-;   TablaA = 0;  ITablaA = TablaA102 <-;   TablaA = 1;
  ITablaA = TablaA114 <-;   TablaA = 2;  ITablaA = TablaA134 <-;   TablaA = 3;
  ITablaA = TablaA154 <-;   TablaA = 4;  ITablaA = TablaA155 <-;   TablaA = 5;
  ITablaA = TablaA156 <-;   TablaA = 6;  ITablaA = TablaA157 <-;   TablaA = 7;
  ITablaA = TablaA158 <-;   TablaA = 8;  ITablaA = TablaA163 <-;   TablaA = 9;
  ITablaA = TablaA170 <-;   TablaA = 10; ITablaA = TablaA185 <-;   TablaA = 11;
  ITablaA = TablaA186 <-;   TablaA = 12; ITablaA = TablaA188 <-;   TablaA = 13;
  ITablaA = TablaA189 <-;   TablaA = 14; ITablaA = TablaA190 <-;   TablaA = 15;

  ITablaA = TablaA201 <-;   TablaA = 16; ITablaA = TablaA202 <-;   TablaA = 17;
  ITablaA = TablaA203 <-;   TablaA = 18; ITablaA = TablaA204 <-;   TablaA = 19;
  ITablaA = TablaA210 <-;   TablaA = 20; ITablaA = TablaA214 <-;   TablaA = 21;
  ITablaA = TablaA215 <-;   TablaA = 22; ITablaA = TablaA216 <-;   TablaA = 23;
  ITablaA = TablaA217 <-;   TablaA = 24; ITablaA = TablaA220 <-;   TablaA = 25;
  ITablaA = TablaA225 <-;   TablaA = 26; ITablaA = TablaA231 <-;   TablaA = 27;
  ITablaA = TablaA240 <-;   TablaA = 28; ITablaA = TablaA247 <-;   TablaA = 29;
  ITablaA = TablaA249 <-;   TablaA = 30; ITablaA = TablaA250 <-;   TablaA = 31;
  ITablaA = TablaA257 <-;   TablaA = 32; ITablaA = TablaA260 <-;   TablaA = 33;
  ITablaA = TablaA261 <-;   TablaA = 34; ITablaA = TablaA262 <-;   TablaA = 35;

  ITablaA = TablaA306 <-;   TablaA = 36; ITablaA = TablaA307 <-;   TablaA = 37;
  ITablaA = TablaA308 <-;   TablaA = 38; ITablaA = TablaA309 <-;   TablaA = 39;
  ITablaA = TablaA310 <-;   TablaA = 40; ITablaA = TablaA311 <-;   TablaA = 41;
  ITablaA = TablaA314 <-;   TablaA = 42; ITablaA = TablaA320 <-;   TablaA = 43;
  ITablaA = TablaA326 <-;   TablaA = 44; ITablaA = TablaA333 <-;   TablaA = 45;
  ITablaA = TablaA340 <-;   TablaA = 46; ITablaA = TablaA341 <-;   TablaA = 47;
  ITablaA = TablaA342 <-;   TablaA = 48; ITablaA = TablaA343 <-;   TablaA = 49;
  ITablaA = TablaA344 <-;   TablaA = 50; ITablaA = TablaA345 <-;   TablaA = 51;
  ITablaA = TablaA346 <-;   TablaA = 52; ITablaA = TablaA347 <-;   TablaA = 53;
  ITablaA = TablaA348 <-;   TablaA = 54; ITablaA = TablaA349 <-;   TablaA = 55;
  ITablaA = TablaA350 <-;   TablaA = 56; ITablaA = TablaA351 <-;   TablaA = 57;

  ITablaA = TablaA405 <-;   TablaA = 58; ITablaA = TablaA414 <-;   TablaA = 59;
  ITablaA = TablaA415 <-;   TablaA = 60; ITablaA = TablaA433 <-;   TablaA = 61;
  ITablaA = TablaA434 <-;   TablaA = 62; ITablaA = TablaA435 <-;   TablaA = 63;
  ITablaA = TablaA436 <-;   TablaA = 64; ITablaA = TablaA437 <-;   TablaA = 65;
  ITablaA = TablaA438 <-;   TablaA = 66; ITablaA = TablaA439 <-;   TablaA = 67;
  ITablaA = TablaA440 <-;   TablaA = 68; ITablaA = TablaA441 <-;   TablaA = 69;
  Pos = -1;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |HAZ PreparaInformes;
  |HAZ CargaTabla;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;

  |HAZ TipoImpre;     |SI Hojas2 ! 1; |Y Hojas2 ! 2; |ACABA; |FINSI;
  |HAZ CargaTempo;

  |SI SwHay = 0; |ACABA; |FINSI;

  |BUCLE rew00001;

  |FINIMP;
  |ABRE #99; |CIERRA #99; |DELINDEX #99;
|FPRC;
