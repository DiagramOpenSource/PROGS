|FICHEROS;
     maempr05,MANTE;
     maempr02;
     maempr10;
|FIN;

|VARIABLES;
|FIN;

|VARIABLES;
     n0Vent         = 0;
     nRango         = 0;
     nGrid          = 0;

     aAlfa          = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &enEmpresa = 0;
     &enAnyo    = 0;
     &enModoConsulta = 0;
|FIN;

|PROCESO Baja05;
     #maempr05#0  = enEmpresa;
     #maempr05#1  = enAnyo;
     #maempr05#2  = 1;
|FPRC;

|PROCESO Alta05;
     #maempr05#0  = enEmpresa;
     #maempr05#1  = enAnyo;
     #maempr05#2  = 99;
|FPRC;

|PROGRAMA;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Relaci¢n de socios";
     |VENTANA 0501, 3399, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#maempr05, nRango, 0502, 3199, Baja05, Alta05, NULL;
     nGrid = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO maempr02;
     |DDEFECTO #maempr05;
     #maempr05#0  = #maempr02#0;
     #maempr05#1  = #maempr02#1;
     #maempr05#2  = #maempr02#2;
     #maempr05#3  = #maempr02#3;
     #maempr05#4  = #maempr02#4;
     #maempr05#6  = #maempr02#5;
     #maempr05#7  = #maempr02#6;
     #maempr05#10 = #maempr02#9;
     |GRABA 020#maempr05.n;
     |LIBERA #maempr05;
|FPRC;

|DEFBUCLE maempr02;
     #maempr02#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, maempr02;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     aAlfa  = PARAMETRO % 104;  enAnyo    = aAlfa;
     aAlfa  = PARAMETRO % 505;  enEmpresa = aAlfa;

     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |ABRET #maempr05;

     |SI enModoConsulta = 1; |ACABA; |FINSI;

     #maempr05#0 = enEmpresa;
     #maempr05#1 = enAnyo;
     #maempr05#2 = 1;
     |LEE 000#maempr05.];
     |SI FSalida ! 0;  |O  #maempr05#0 ! enEmpresa;   |O #maempr05#1 ! enAnyo;
         |CONFI "0000 No existen socios en Transparencia Fiscal, quiere recogerlos del fichero de Socios";
         |SI FSalida = 0;
             |BUCLE maempr02;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #maempr05;
|FPRC;
