|FICHEROS;
     zw000011,MANTE;
     zregpres,MANTE;

     zhazdocu;
     zregdocu;
     zhazcrea;
     zhazmasi;
     zregubic;
     zregfirm;
     zregasis;
     zpcuadro;
     zocuadro;
     zqcuadro;

     maacceso;
     sodacoca;
     cuacceso;
     cubal802;

     megwordl;

     :/contagen/def/canempre;

     :/integral/def/dsam0001;
     :/basica/def/agim0028;

     zcuadros@;
|FIN;

|VARIABLES;
     fFecha     = @;

     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aEsc1       = "";
     aEsc2       = "";
     aRetu       = "";
     aTecla      = "";
     aRuta       = "";
     aLong       = "";
     aIPRemoto   = "";
     aBase       = "";
     aDirPatron  = "";
     aDirInsta   = "";
     aOrigen     = "";
     aDestino    = "";
     aFichero    = "";
     aTipoInstala = "";
     aAbre        = "";
     aBuscar      = "";
     aRefresca    = "";
     aContenido   = "";
     aCarac       = "";
     aDef         = "";
     aMas         = "";

     nNume1     = 0;
     nCuadro    = 0;
     nLong      = 0;
     nCarac     = 0;
     nPos       = 0;
     nGrid20    = 0;
     nRango     = 0;
     nPanta0    = 0;
     nPanta3    = 0;
     nPanta107  = 0;
     nBoton1    = 0;
     nBoton2    = 0;
     nBoton3    = 0;
     nBoton4    = 0;
     nBoton5    = 0;
     nBoton6    = 0;
     nBoton7    = 0;
     nBoton8    = 0;
     nBtnEmi    = 0;
     nBotonDep1 = -1;
     nBotonDep2 = -1;
     nBotonSal  = 0;
     nSalir     = 0;
     nVent      = 0;
     nVentana   = 0;
     nSubVent   = 0;
     nHandle    = 0;
     nMensa     = 0;
     nDelindex  = 0;
     nCampo     = 0;
     nContab    = 0;
     nModo      = 0;
     nRefresca  = 0;
     nEjer      = 0;
     n1Vent     = 0;
     nConta1    = 0;
     nConta2    = 0;
     nConta3    = 0;
     nConta4    = 0;
     nTree      = 0;
     nCargar    = 0;
     nPosi      = 0;

     fFechaChequeo = @;
     fFechaDisol   = @;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     {-1}sTree        = 0;
     sT_nID           = 0;
     sT_nOper         = 0;
     sT_aData         = "";

     &enGrid          = 0;
     &enEmpresa       = 0;
     &enError         = 0;
     &enModo          = 0;
     &eaFichero       = "";
     &enPersonaliza   = 0;
     &eaPathIntegral  = "";
     &eaUnidadBasico  = "";
     &enCuadros       = 0;
     &empAlta         = 0;
     &empresa         = 0;
     &empre           = 0;
     &perio           = 0;
     &plani           = 0;
     &cuent           = ""
     &siono           = "";
     &anyo            = 0;
     &eNum2008        = 0;
     &enTBal          = 0;
     &enTCta          = 0;
     &enMensa         = 0;
     &efFechaMemoria  = @;
     &efFechaCertif   = @;
     &enEjercicio     = 0;
     &eaDSMAC         = "";
     &eaModoPresenta  = "";
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;
     &enUltCoop       = 0;
     &enUltActa       = 0;
     &enUltCert       = 0;
     &enEjerCuadro    = 0;
     &eaRutaOrigen    = "";
     &eaRutaDestino   = "";
     &eaFicheroTxt    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     aAnyo            = "";
     nInstalo         = 0;
     &enAnyo          = 0;
     &enEjerBal       = 0;
     &enSwRegraba     = 0;
     &enSalir         = 0;
|FIN;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO CopiaPatron;
     aOrigen    = aDirPatron + aFichero;
     aDestino   = aDirInsta  + aFichero;
     |COPIA_FICHERO aOrigen, aDestino;
|FPRC;

|PROCESO InstalaMemoriaP;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     |SI #zhazdocu#0 = 2008;
         aFichero   = "memor001.doc";  |HAZ CopiaPatron;
         |ACABA;
     |FINSI;

     |SI #zhazdocu#0 = 2009;
         aFichero   = "memo2009.doc";  |HAZ CopiaPatron;
         |ACABA;
     |FINSI;

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltMemP; nEjer = enUltMemP;  |FINSI;

     aFichero   = "mem" + nEjer + "p.doc";  |HAZ CopiaPatron;
     aFichero   = "mec" + nEjer + "p.doc";  |HAZ CopiaPatron;
                             || m = castella, c = catalan, v = valencia
                             || g = gallego,  e = euskera
     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaMemoriaA;
     |SI #zhazdocu#0 [ 2009;  |ACABA;  |FINSI;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltMemA; nEjer = enUltMemA;  |FINSI;

     aFichero   = "mem" + nEjer + "a.doc";  |HAZ CopiaPatron;
     aFichero   = "mec" + nEjer + "a.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaMemoriaC;
     |SI #zhazdocu#0 [ 2010;  |ACABA;  |FINSI;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento de la memoria ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/memoria";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltMemC; nEjer = enUltMemC;  |FINSI;

     aFichero   = "mem" + nEjer + "c.doc";  |HAZ CopiaPatron;
     aFichero   = "mec" + nEjer + "c.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaGestion;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento del informe de gesti¢n ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/gestion";        |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "gesti001.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaCerti;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de los certificados ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "cert0101.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0102.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0103.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0201.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0202.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0203.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0301.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0401.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0402.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0403.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0501.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0502.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0503.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0601.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0602.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0603.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0701.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0702.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0703.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0800.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0801.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0802.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0803.doc";  |HAZ CopiaPatron;
     aFichero   = "cert0901.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1001.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1002.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1003.doc";  |HAZ CopiaPatron;
     aFichero   = "cert1004.doc";  |HAZ CopiaPatron;

     |SI aTipoInstala ! "CERTI16";
         aAnyo = "17"; |HAZ InsCertiAnyo;
         aAnyo = "18"; |HAZ InsCertiAnyo;
         aAnyo = "19"; |HAZ InsCertiAnyo;
     |FINSI;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InstalaCertiAny;

     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de los certificados ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltCert; nEjer = enUltCert;  |FINSI;
     |SI nEjer < 2017; |ACABA; |FINSI;

     aAnyo = nEjer; aAnyo = aAnyo % -102;
     |HAZ InsCertiAnyo;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InsCertiAnyo;
     aFichero   = "veract03.txt";  |HAZ CopiaPatron;

     aFichero   = "cer" + aAnyo + "01p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "01c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "01n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "02n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "03s.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "04n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "05n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "06n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "07n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "08n.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "09s.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10p.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10c.doc";  |HAZ CopiaPatron;
     aFichero   = "cer" + aAnyo + "10n.doc";  |HAZ CopiaPatron;
|FPRC;

|PROCESO InstalaActas;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de las actas de aprobaci¢n de cuentas, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "veract02.txt";  |HAZ CopiaPatron;
     aFichero   = "acta0101.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0102.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0103.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0201.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0202.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0203.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0301.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0401.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0402.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0403.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0501.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0502.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0503.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0601.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0602.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0603.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0701.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0702.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0703.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0800.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0801.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0802.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0803.doc";  |HAZ CopiaPatron;
     aFichero   = "acta0901.doc";  |HAZ CopiaPatron;
     aFichero   = "acta1001.doc";  |HAZ CopiaPatron;
     aFichero   = "acta1002.doc";  |HAZ CopiaPatron;
     aFichero   = "acta1003.doc";  |HAZ CopiaPatron;
     aFichero   = "acta1004.doc";  |HAZ CopiaPatron;

     |SI aTipoInstala ! "ACTAS16";
         aAnyo = "17"; |HAZ InsActasAnyo;
         aAnyo = "18"; |HAZ InsActasAnyo;
         aAnyo = "19"; |HAZ InsActasAnyo;
     |FINSI;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InstalaActaAny;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de las actas de aprobaci¢n de cuentas, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltActa; nEjer = enUltActa;  |FINSI;
     |SI nEjer < 2017; |ACABA; |FINSI;

     aAnyo  = nEjer; aAnyo = aAnyo % -102;
     |HAZ InsActasAnyo;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InsActasAnyo;
     aFichero   = "veract03.txt";  |HAZ CopiaPatron;

     aFichero   = "act" + aAnyo + "01p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "01c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "01n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "02p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "02c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "02n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "03s.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "04p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "04c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "04n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "05p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "05c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "05n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "06p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "06c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "06n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "07p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "07c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "07n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "08p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "08c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "08n.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "09s.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "10p.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "10c.doc";  |HAZ CopiaPatron;
     aFichero   = "act" + aAnyo + "10n.doc";  |HAZ CopiaPatron;
|FPRC;

|PROCESO InstalaCuadroP;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zpcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroA;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zocuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroC;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zqcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCooperativa;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLos documentos de las cuentas anuales de cooperativas ya est n instalados, quiere reinstalarlos de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/cuentas";         |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

     |SI nEjer < 2012;
         |SI nEjer [ 2010;
             aFichero   = "cacoop21.doc";  |HAZ CopiaPatron;
             aFichero   = "cacoop22.doc";  |HAZ CopiaPatron;
         |SINO;
             aFichero   = nEjer + "cp21.doc";  |HAZ CopiaPatron;
             aFichero   = nEjer + "cp22.doc";  |HAZ CopiaPatron;
         |FINSI;
     |FINSI;

     aFichero   = nEjer + "cp31.doc";  |HAZ CopiaPatron;
     aFichero   = nEjer + "cp32.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documentos instalados.";
     |FINSI;
|FPRC;

|PROCESO InstalaCarpeta;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NEl documento Formulario carpeta Registro ya est  instalado, quiere reinstalarlo de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "word";                |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/actas";          |MKDIR aDirInsta;
     aDirInsta  = aDirInsta + "/";

     aFichero   = "porta001.doc";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Documento instalado.";
     |FINSI;
|FPRC;

|PROCESO InstalaTodo;
     nMensa     = 0;

     |HAZ InstalaMemoriaP;
     |HAZ InstalaMemoriaA;
     |HAZ InstalaMemoriaC;
     |HAZ InstalaGestion;
     |HAZ InstalaCerti;
     |HAZ InstalaActas;
     |HAZ InstalaCuadroP;
     |HAZ InstalaCuadroA;
     |HAZ InstalaCuadroC;
     |HAZ InstalaCooperativa;
     |HAZ InstalaCarpeta;
|FPRC;

|PROCESO InstalaPatrones;
     |DBASE aBase;  |QBF aBase;
     aDirPatron = aBase + "planilla/";
     aFichero   = aDirPatron + "dcpatron.tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + "dcpatron.tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |SI aTipoInstala = "TODO";          |HAZ InstalaTodo;          |FINSI;
     |SI aTipoInstala = "MEMORIAP";      |HAZ InstalaMemoriaP;      |FINSI;
     |SI aTipoInstala = "MEMORIAA";      |HAZ InstalaMemoriaA;      |FINSI;
     |SI aTipoInstala = "MEMORIAC";      |HAZ InstalaMemoriaC;      |FINSI;
     |SI aTipoInstala = "GESTION";       |HAZ InstalaGestion;       |FINSI;
     |SI aTipoInstala = "CERTI";         |HAZ InstalaCerti;         |FINSI;
     |SI aTipoInstala = "CERTI16";       |HAZ InstalaCerti;         |FINSI;
     |SI aTipoInstala = "CERTIANY";      |HAZ InstalaCertiAny;      |FINSI;
     |SI aTipoInstala = "ACTAS";         |HAZ InstalaActas;         |FINSI;
     |SI aTipoInstala = "ACTAS16";       |HAZ InstalaActas;         |FINSI;
     |SI aTipoInstala = "ACTASANY";      |HAZ InstalaActaAny;       |FINSI;
     |SI aTipoInstala = "CUADROP";       |HAZ InstalaCuadroP;       |FINSI;
     |SI aTipoInstala = "CUADROA";       |HAZ InstalaCuadroA;       |FINSI;
     |SI aTipoInstala = "CUADROC";       |HAZ InstalaCuadroC;       |FINSI;
     |SI aTipoInstala = "COOPERATIVA";   |HAZ InstalaCooperativa;   |FINSI;
     |SI aTipoInstala = "CARPETA";       |HAZ InstalaCarpeta;       |FINSI;

     aAlfa = aDirPatron + "memor001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "memo2009.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2018p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2018a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2019p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2019a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0101.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0102.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0103.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0201.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0202.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0203.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0301.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0401.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0402.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0403.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0501.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0502.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0503.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0601.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0602.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0603.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0701.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0702.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0703.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0800.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0801.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0802.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0803.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0901.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1002.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1003.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1004.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0101.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0102.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0103.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0201.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0202.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0203.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0301.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0302.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0303.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0401.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0402.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0403.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0501.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0502.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0503.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0601.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0602.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0603.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0701.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0702.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0703.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0800.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0801.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0802.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0803.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0901.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1002.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1003.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1004.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "gesti001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "porta001.doc";  |FBORRA aAlfa;

     aAnyo = "17"; |HAZ BActayCerti;
     aAnyo = "18"; |HAZ BActayCerti;
     aAnyo = "19"; |HAZ BActayCerti;

     |PULSATECLA;
|FPRC;

|PROCESO  BActayCerti;
     aAlfa = aDirPatron + "cer" + aAnyo + "01p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "03s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "09s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10n.doc";  |FBORRA aAlfa;

     aAlfa = aDirPatron + "act" + aAnyo + "01p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "01c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "01n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "03s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "09s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10n.doc";  |FBORRA aAlfa;
|FPRC;

|PROCESO EventoGrid;
     |SI nRefresca = 1;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#zregdocu.=;

         |ESTADO_CONTROL nBoton3, "ENABLE";
         |ESTADO_CONTROL nBoton7, "ENABLE";
         |ESTADO_CONTROL nBtnEmi, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
         |HAZ Boton3;
     |FINSI;
|FPRC;

|PROCESO zregfirmB;
     |BORRA 020#zregfirm.a;
     |LIBERA #zregfirm;
|FPRC;

|DEFBUCLE zregfirmB;
     #zregfirm#1;
     ;
     #zregdocu#0, #zregdocu#1, 01;
     #zregdocu#0, #zregdocu#1, 99;
     ;
     NULL, zregfirmB;
|FIN;

|PROCESO zregasisB;
     |BORRA 020#zregasis.a
     |LIBERA #zregasis;
|FPRC;

|DEFBUCLE zregasisB;
     #zregasis#1;
     ;
     #zregdocu#0, #zregdocu#1, 01;
     #zregdocu#0, #zregdocu#1, 99;
     ;
     NULL, zregasisB;
|FIN;

|PROCESO megwordlB;
     |DBASE aAlfa;   |QBT aAlfa;
     aAlfa = aAlfa + "emisiones/" + (("00000" + #megwordl#0) % -105) + "/" + #megwordl#1;
     aAlfa = aAlfa + "/" + #megwordl#2;  |QBT aAlfa;
     |FBORRA aAlfa;

     |BORRA 020#megwordl.a;
     |LIBERA #megwordl;
|FPRC;

|DEFBUCLE megwordlB;
     #megwordl#1;
     ;
     #zregdocu#0, #zregdocu#1, "           ";
     #zregdocu#0, #zregdocu#1, "zzzzzzzzzzz";
     ;
     NULL, megwordlB;
|FIN;

|PROCESO BorraRegCuadro;
     |DDEF aDef;
     aDef = aDef + aMas;
     |CARGA_DEF aDef, zcuadros@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #zcuadros@;
     #zcuadros@#0 = #zregdocu#0;
     #zcuadros@#1 = #zregdocu#1;
     #zcuadros@#2 = 1;
     |LEE 101#zcuadros@.];
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #zcuadros@#0 ! #zregdocu#0;  |O #zcuadros@#1 ! #zregdocu#1;
              |SAL;
          |FINSI;

          |BORRA 000#zcuadros@.a;
          |LIBERA #zcuadros@;

          |LEE 101#zcuadros@.s;
     |SIGUE;
     |CIERRA #zcuadros@;

     |DESCARGA_DEF #zcuadros@;
|FPRC;

|PROCESO BorraCuadros;
     |PARA nCuadro = 1;  |SI nCuadro [ 33;  |HACIENDO nCuadro = nCuadro + 1;
           aMas = "zregcu" + (("00" + nCuadro) % -102);
           |HAZ BorraRegCuadro;
     |SIGUE;
|FPRC;

|PROCESO Boton7;
     |LEE 101#zregdocu.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NEst  seguro que quiere el borrar el registro seleccionado";
     |SI FSalida ! 0;  |LIBERA #zregdocu;  |ACABA;  |FINSI;

     |HAZ BorraCuadros;

     |BUCLE zregfirmB;
     |BUCLE zregasisB;
     |BUCLE megwordlB;

     |BORRA 020#zregdocu.a;
     |LIBERA #zregdocu;

     |PULSATECLA;
     |REFRESCACONTROL enGrid;
     |FOCOTECLADO enGrid;
|FPRC;

|PROCESO Boton6;
     |VENTANA 0501, 1799, -1, 16, "Datos presentante";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |ABRE #zregpres;
     #zregpres#0 = #zhazdocu#0;
     |LEE 101#zregpres.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregpres;
         #zregpres#0 = #zhazdocu#0;
         |GRABA 020#zregpres.b;
     |FINSI;

     |PINPA #0#zregpres;
     nPanta107 = FSalida;

     |PINDA #0#zregpres;
     |ENDATOS #1#zregpres;
     |SI FSalida = 0;
         |GRABA 020#zregpres.a;
     |FINSI;
     |LIBERA #zregpres;
     |CIERRA #zregpres;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVent;

     |PULSATECLA;
     |REFRESCACONTROL enGrid;
|FPRC;

|PROCESO Baja5;
     #zpcuadro#0 = #zhazdocu#0;
     #zpcuadro#1 = 1;
|FPRC;

|PROCESO Alta5;
     #zpcuadro#0 = #zhazdocu#0;
     #zpcuadro#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroP;
     |SI #zhazdocu#0 > enUltMemP;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros PYME";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #zpcuadro;
     |LINEAL_SIMPLE #1#zpcuadro, nRango, 0502, 2159, Baja5, Alta5, NULL;
     |CIERRA #zpcuadro;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Baja6;
     #zocuadro#0 = #zhazdocu#0;
     #zocuadro#1 = 1;
|FPRC;

|PROCESO Alta6;
     #zocuadro#0 = #zhazdocu#0;
     #zocuadro#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroA;
     |SI #zhazdocu#0 > enUltMemA;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros abreviada";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #zocuadro;
     |LINEAL_SIMPLE #1#zocuadro, nRango, 0502, 2159, Baja6, Alta6, NULL;
     |CIERRA #zocuadro;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO Baja7;
     #zqcuadro#0 = #zhazdocu#0;
     #zqcuadro#1 = 1;
|FPRC;

|PROCESO Alta7;
     #zqcuadro#0 = #zhazdocu#0;
     #zqcuadro#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroC;
     |SI #zhazdocu#0 > enUltMemC;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 2360, -1, 16, "Plantilla carga autom tica de los cuadros de cooperativas";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #zqcuadro;
     |LINEAL_SIMPLE #1#zqcuadro, nRango, 0502, 2159, Baja7, Alta7, NULL;
     |CIERRA #zqcuadro;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRC;

|PROCESO GrabaArbol;
     aAlfa = aAlfa1 + aAlfa2 + aAlfa3 + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO PatronesMemoria;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Memoria";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Memoria PYME";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Documento word";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar documento ";
     aAlfa3  = "{{InsDocPYME}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{EdiDocPYME}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Cuadros";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar plantilla ";
     aAlfa3  = "{{InsCuaPYME}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar plantilla ";
     aAlfa3  = "{{EdiCuaPYME}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  ="Memoria Abreviada";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Documento word";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar documento ";
     aAlfa3  = "{{InsDocABRE}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{EdiDocABRE}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Cuadros";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar plantilla ";
     aAlfa3  = "{{InsCuaABRE}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar plantilla ";
     aAlfa3  = "{{EdiCuaABRE}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Memoria Cooperativas";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Documento word";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar documento ";
     aAlfa3  = "{{InsDocCOOP}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{EdiDocCOOP}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Cuadros";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Instalar plantilla ";
     aAlfa3  = "{{InsCuaCOOP}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar plantilla ";
     aAlfa3  = "{{EdiCuaCOOP}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesGestion;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Informe de gesti¢n";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Instalar documento ";
     aAlfa3  = "{{InsDocIGES}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{EdiDocIGES}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesCertificados;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Certificados";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Instalar documentos ";
     aAlfa3  = "{{InsDocCERT}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "--------------------------------------------------";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta no universal ";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada-PYMES";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0101}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0102}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0103}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0201}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0202}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0203}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Sin aprobaci¢n";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{CERTIF0301}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta universal ";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada-PYMES";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0401}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0402}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0403}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0501}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0502}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0503}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Sin aprobaci¢n";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{CERTIF0901}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta universal transparencia";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0601}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0602}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0603}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0701}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0702}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0703}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta Universal Unipersonal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{CERTIF0801}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF0802}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF0803}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta asamblea de cooperativas";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     |SI #zhazdocu#0 [ 2010; aAlfa3 = "{{CERTIF1001}}";  |FINSI;
     |SI #zhazdocu#0 ] 2011; aAlfa3 = "{{CERTIF1004}}";  |FINSI;
     |SI #zhazdocu#0 ] 2017; aAlfa3 = "{{CERTIF1001}}";  |FINSI;
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{CERTIF1002}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{CERTIF1003}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesActas;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Actas aprobaci¢n de cuentas";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Instalar documentos ";
     aAlfa3  = "{{InsDocACTA}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "--------------------------------------------------";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta no universal ";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada-PYMES";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0101}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0102}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0103}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0201}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0202}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0203}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Sin aprobaci¢n";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{ACTASA0301}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta universal ";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada-PYMES";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0401}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0402}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0403}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0501}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0502}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0503}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Sin aprobaci¢n";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{ACTASA0901}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta universal transparencia";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Abreviada";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0601}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0602}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0603}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     nConta4 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Normal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0701}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0702}}";
     |HAZ GrabaArbol;

     nConta4 = nConta4 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + "," + nConta4 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0703}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta Universal Unipersonal";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA0801}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA0802}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA0803}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Junta asamblea de cooperativas";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con beneficio ";
     aAlfa3  = "{{ACTASA1001}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con resultado igual a cero ";
     aAlfa3  = "{{ACTASA1002}}";
     |HAZ GrabaArbol;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Editar documento con prdidas ";
     aAlfa3  = "{{ACTASA1003}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesCuentas;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Cuentas anuales cooperativas";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Instalar documento de la aplicacion ";
     aAlfa3  = "{{InsDocCUEN}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "-------------------------------------------";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Editar documento PYMES - Balance 31 ";
     aAlfa3  = "{{CUENTA0031}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Editar documento Abreviadas - Balance 32 ";
     aAlfa3  = "{{CUENTA0032}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO PatronesPortadas;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Formulario carpeta Registro";
     aAlfa3  = "";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Instalar documento ";
     aAlfa3  = "{{InsDocPORT}}";
     |HAZ GrabaArbol;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Editar documento ";
     aAlfa3  = "{{EdiDocPORT}}";
     |HAZ GrabaArbol;

     |PULSATECLA;
|FPRC;

|PROCESO EvntTree;
     aContenido = Contenido % -110;

     |SI FEntrada = 0;  |ACABA;  |FINSI;

     enPersonaliza = 0;
     nMensa        = 1;

     |SI aContenido = "_____Salir";
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocPYME";
         aTipoInstala = "MEMORIAP";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiDocPYME";
         |SI #zhazdocu#0 < 2017;
             #zhazcrea#18 = "M";
         |SINO;
             #zhazcrea#15 = "P";
             |HAZ ConfiIdioma;
             |SI enSalir = 1; |ACABA; |FINSI;
         |FINSI;
         |HAZ EditaMemoPatronPYME;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocABRE";
         aTipoInstala = "MEMORIAA";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiDocABRE";
         |SI #zhazdocu#0 < 2017;
             #zhazcrea#18 = "M";
         |SINO;
             #zhazcrea#15 = "A";
             |HAZ ConfiIdioma;
             |SI enSalir = 1; |ACABA; |FINSI;
         |FINSI;
         |HAZ EditaMemoPatronAbreviada;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocCOOP";
         aTipoInstala = "MEMORIAC";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiDocCOOP";
         |HAZ EditaMemoPatronCooperativa;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsCuaPYME";
         aTipoInstala = "CUADROP";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiCuaPYME";
         |HAZ PlantillaCuadroP;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsCuaABRE";
         aTipoInstala = "CUADROA";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiCuaABRE";
         |HAZ PlantillaCuadroA;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsCuaCOOP";
         aTipoInstala = "CUADROC";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiCuaCOOP";
         |HAZ PlantillaCuadroC;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocIGES";
         aTipoInstala = "GESTION";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiDocIGES";
         |HAZ EditaGestiPatron;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocCERT";
         |SI #zhazdocu#0 ] 2017;
             aTipoInstala = "CERTIANY";
         |SINO;
              aTipoInstala = "CERTI16";
         |FINSI;
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocACTA";
         |SI #zhazdocu#0 ] 2017;
             aTipoInstala = "ACTASANY";
         |SINO;
             aTipoInstala = "ACTAS16";
         |FINSI;
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocCUEN";
         aTipoInstala = "COOPERATIVA";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "InsDocPORT";
         aTipoInstala = "CARPETA";
         |HAZ InstalaPatrones;
         |ACABA;
     |FINSI;

     |SI aContenido = "EdiDocPORT";
         eaFichero  = "porta001.doc";
         |HAZ EditaCertPatron;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "CERTIF";
     |SI FSalida ! 0;
         eaFichero  = "cert" + aAlfa + ".doc";
         |HAZ EditaCertPatron;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "ACTASA";
     |SI FSalida ! 0;
         eaFichero  = "acta" + aAlfa + ".doc";
         |HAZ EditaCertPatron;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "CUENTA";
     |SI FSalida ! 0;
         nEjer = #zhazdocu#0;
         |SI nEjer > enUltCoop; nEjer = enUltCoop;  |FINSI;

         eaFichero  = nEjer + "cp" + (aAlfa % -102) + ".doc";
         |HAZ EditaCtasPatron;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Boton5;
     |VENTANA 0501, 0540, -1, 16, "Procesando trabajo";
     n1Vent = FSalida;

     |PTEC 802;  |PAUSA;


     eaFicheroTxt  = "zhazdocu1" + Usuario + ".txt";
     eaFicheroTgz  = "zhazdocu1" + Usuario + ".tgz";
     eaFicheroTar  = "zhazdocu1" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     |XABRE "WB", aAbre, nHandle;

     nConta1 = 0;

     |HAZ PatronesMemoria;
     |HAZ PatronesGestion;
     |HAZ PatronesCertificados;
     |HAZ PatronesActas;
     |HAZ PatronesCuentas;
     |HAZ PatronesPortadas;

     nConta1 = nConta1 + 1;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Salir ";
     aAlfa3  = "{{_____Salir}}";
     |HAZ GrabaArbol;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     |FINVENTANA n1Vent;

     |VENTANA 0501, 3499, -1, 16, "Documentos patrones";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     aAlfa = "TREECTRL,Documentos patrones {{" + aAlfa + "}}";

     |CONTROL_SIMPLE 0, aAlfa, 0602, 3298, EvntTree;
     nTree = FSalida;

     eaFicheroTxt  = "zhazdocu1" + Usuario + ".txt";

     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     |SI aBuscar ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBuscar;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         |SI FSalida ] 0;
             aRefresca = ":" + FSalida;
         |SINO;
             aRefresca = "1:";
         |FINSI;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;
     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}Salir," + nTree;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |PULSATECLA;

     |FOCOTECLADO enGrid;
|FPRC;

|PROCESO BotonDep1;
     aRuta = "F" + #zregubic#2;  |QBF aRuta;
     |SI aRuta = "F";
         aRuta = "F*.exe";  |QBF aRuta;
     |FINSI;

     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "F";  |ACABA;  |FINSI;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos = (nCarac * 100) + 1;
           aRuta = aRuta + (aAlfa % nPos);
     |SIGUE;

     #zregubic#2 = aRuta;  |PINTA #zregubic#2;
|FPRC;

|PROCESO BotonDep2;
     aRuta = "D";
     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "D";  |ACABA;  |FINSI;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos = (nCarac * 100) + 1;
           aRuta = aRuta + (aAlfa % nPos);
     |SIGUE;

     #zregubic#3 = aRuta;  |PINTA #zregubic#3;
|FPRC;

|PROCESO Boton4;
     enEjercicio = #zhazdocu#0;
     |HAZ CogeMac;

     aAlfa = "Ubicaciones Dep¢sito Digital MAC: " + eaDSMAC;
     |VENTANA 1001, 1799, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |ABRE #zregubic;
     #zregubic#0 = #zhazdocu#0;
     #zregubic#1 = eaDSMAC;
     |LEE 101#zregubic.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregubic;
         #zregubic#0 = #zhazdocu#0;
         #zregubic#1 = eaDSMAC;
         |GRABA 020#zregubic.b;
     |FINSI;

     |PINPA #0#zregubic;
     nPanta3 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,{{163}}", 0703, 0705, BotonDep1;
     nBotonDep1 = FSalida;

     |CONTROL_SIMPLE nPanta3, "BOTON,{{163}}", 1003, 1005, BotonDep2;
     nBotonDep2 = FSalida;

     |PINDA #0#zregubic;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir";
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |GRABA 020#zregubic.a;
     |LIBERA #zregubic;
     |CIERRA #zregubic;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FIN_CONTROL_WINDOWS nBotonDep1;
     |FIN_CONTROL_WINDOWS nBotonDep2;

     |PULSATECLA;

     |FINVENTANA nVent;

     |PULSATECLA;

     |FOCOTECLADO enGrid;
|FPRC;

|PROCESO Boton3;
     enModo = 2;
     |HAZ zhazcrea;

     |PULSATECLA;
     |REFRESCACONTROL enGrid;
     |FOCOTECLADO enGrid;
|FPRC;

|PROCESO Boton2;
     enModo = 1;
     |HAZ zhazcrea;

     |PULSATECLA;
     |REFRESCACONTROL enGrid;
     |FOCOTECLADO enGrid;
|FPRC;

|PROCESO Baja1;
     #zregdocu#0 = 00001;
     #zregdocu#1 = #zhazdocu#0;
|FPRC;

|PROCESO Alta1;
     #zregdocu#0 = 99999;
     #zregdocu#1 = #zhazdocu#0;
|FPRC;

|PROCESO Boton1;
     |ENCAMPO #0#zhazdocu;

     |PULSATECLA;
     |REFRESCACONTROL enGrid;
     |FOCOTECLADO enGrid;

     nSalir = 1;
|FPRC;

|PROCESO CompAvisos;
     |DBASE aBase;  |QBF aBase;
     aAlfa = #zhazdocu#0;
     aAlfa = aBase + "word/memoria/mem" + aAlfa + "a.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         |SI #zhazdocu#0 [ enUltMemA;
             aAlfa = #zhazdocu#0;
             |SI #zhazdocu#0 = enUltMemA;
                  aAlfa1 = "    Error en la Instalacion de";
             |SINO;
                  aAlfa1 = "    Error, no existen";
             |FINSI;
             aAlfa1 = aAlfa1 + " los Documentos Patrones Ejercicio " + aAlfa;
             |MENAV aAlfa1;
             |MENAV "    Pongase en contacto con su distribuidor";
         |FINSI;

         |SI #zhazdocu#0 > enUltMemA;
             aAlfa = #zhazdocu#0;
             aAlfa1 = "    No existen los Documentos Patrones Ejercicio " + aAlfa;
             |MENAV aAlfa1;

             aAlfa1 = "    Los Textos se emitiran con el patron del Ejercicio " + enUltMemA;
             |MENAV aAlfa1;
         |FINSI;

         |PULSATECLA;
     |FINSI;

     |SI #zhazdocu#0 ] 2017;
         aAlfa = #zhazdocu#0;
         aAlfa = aAlfa % -102;
         aAlfa = aBase + "word/actas/cer" + aAlfa + "10p.doc";
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida < 0;
             |SI #zhazdocu#0 [ enUltCert;
                 aAlfa = #zhazdocu#0;
                 |SI #zhazdocu#0 = enUltCert;
                      aAlfa1 = "    Error en la Instalacion de";
                 |SINO;
                      aAlfa1 = "    Error, no existen";
                 |FINSI;
                 aAlfa1 = aAlfa1 + " las Actas/Certificados Patrones Ejercicio " + aAlfa;
                 |MENAV aAlfa1;
                 |MENAV "    Pongase en contacto con su distribuidor";
             |FINSI;

             |SI #zhazdocu#0 > enUltCert;
                 aAlfa = #zhazdocu#0;
                 aAlfa1 = "    No existen las Actas/Certificados Patrones Ejercicio " + aAlfa;
                 |MENAV aAlfa1;

                 aAlfa1 = "    Las Actas/Certificados se emitiran con el patron del Ejercicio " + enUltCert;
                 |MENAV aAlfa1;
             |FINSI;

             |PULSATECLA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |HAZ BusquedaApli;

     |ABRE #zregpres;
     #zregpres#0 = #zhazdocu#0;
     |LEE 000#zregpres.=;
     |SI FSalida ! 0;
         #zregpres#0 = #zhazdocu#0 - 1;
         |LEE 000#zregpres.=;
         |SI FSalida = 0;
             #zregpres#0 = #zhazdocu#0;
             |GRABA 020#zregpres.n;
             |LIBERA #zregpres;
         |SINO;
             |SI eaPathIntegral ! "";
                 |ABRE #dsam0001;
                 |LEE 000#dsam0001.p;
                 |SI FSalida = 0;
                     #zregpres#0  = #zhazdocu#0;
                     #zregpres#1  = #dsam0001#1;
                     #zregpres#2  = #dsam0001#2;
                     #zregpres#3  = #dsam0001#3;
                     #zregpres#4  = #dsam0001#4;
                     #zregpres#5  = #dsam0001#5;
                     #zregpres#6  = #dsam0001#6;
                     #zregpres#7  = #dsam0001#7;
                     #zregpres#8  = #dsam0001#8;
                     #zregpres#9  = #dsam0001#9;
                     #zregpres#10 = #dsam0001#10;
                     |GRABA 020#zregpres.n;
                     |LIBERA #zregpres;
                 |FINSI;
                 |CIERRA #dsam0001;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #zregpres;


     |ESTADO_CONTROL nBoton8, "ENABLE";

     |SI #zhazdocu#0 [ 2008;
         |ESTADO_CONTROL nBoton8, "DISABLE";
     |FINSI;

     |SI #zhazdocu#0 > 2009;
         |HAZ CompAvisos;
     |FINSI;
|FPRC;

|PROCESO Carga20;
     #zhazcrea#0 = #agim0028#0;
     #zhazcrea#1 = #zhazdocu#0;

     #zhazmasi#2  = "1";  |C_M #zw000011#2,  1, "S";
     #zhazmasi#3  = 0;    |C_M #zw000011#3,  1, "S";
     #zhazmasi#5  = 0;    |C_M #zw000011#5,  1, "S";
     #zhazmasi#7  = 0;    |C_M #zw000011#7,  1, "S";
     #zhazmasi#9  = "1";
     #zhazmasi#10 = "1";
     #zhazmasi#13 = "2";

     |DDEFECTO #cuacceso;

     #zregdocu#0 = #zhazmasi#0;
     #zregdocu#1 = #zhazdocu#0;
     |LEE 000#zregdocu.=;
     |SI FSalida ! 0;
         #zregdocu#0 = #zhazmasi#0;
         #zregdocu#1 = #zhazdocu#0 - 1;
         |LEE 000#zregdocu.=;
         |SI FSalida = 0;
             #zhazmasi#16 = #zregdocu#13;
             #zhazmasi#19 = #zregdocu#69;
         |FINSI;

         |DDEFECTO #zregdocu;
     |SINO;
         #zhazmasi#16 = #zregdocu#13;
         #zhazmasi#19 = #zregdocu#69;
     |FINSI;

     |ABRE #cuacceso;
     #cuacceso#0 = #zhazmasi#0;
     #cuacceso#1 = #zhazdocu#0;
     |LEE 000#cuacceso.=;
     |SI FSalida = 0;
         #zhazmasi#2 = "2";      |C_M #zw000011#2, 1, "N";
         #zhazmasi#3  = #cuacceso#14;  |C_M #zw000011#3, 1, "N";
         #zhazmasi#5  = #cuacceso#15;  |C_M #zw000011#5, 1, "N";
         #zhazmasi#7  = #cuacceso#16;  |C_M #zw000011#7, 1, "N";
     |SINO;
         #cuacceso#0 = #zhazmasi#0;
         #cuacceso#1 = #zhazdocu#0 - 1;
         |LEE 000#cuacceso.=;
         |SI FSalida = 0;
             #zhazmasi#3  = #cuacceso#14;
             #zhazmasi#5  = #cuacceso#15;
             #zhazmasi#7  = #cuacceso#16;
         |FINSI;
     |FINSI;
     |CIERRA #cuacceso;

     |HAZ VerificaCuadros;

     |SI enCuadros = 0;
         #zhazmasi#9  = "2";
     |FINSI;

     |SI #zregdocu#4 = "S";
         #zhazmasi#9  = "2";
         #zhazmasi#10 = "2";
         #zhazmasi#11 = #zregdocu#7;
         #zhazmasi#12 = #zregdocu#5;
     |FINSI;

     |SI #zregdocu#8 = "S";
         #zhazmasi#13 = "2";
     |FINSI;

     |SI #zhazmasi#11 = "01.01.0000";  #zhazmasi#11 = efFechaMemoria;  |FINSI;
     |SI #zhazmasi#15 = "01.01.0000";  #zhazmasi#15 = efFechaCertif;   |FINSI;
|FPRC;

|PROCESO Pide20;
     |PARA nCampo = 0;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
           #zw000011#nCampo# = #zhazmasi#nCampo#;
     |SIGUE;

     aAlfa = (("00000" + #zhazmasi#0) % -105) + "/" + #zhazdocu#0 + " " + #zhazmasi#1;  |QBF aAlfa;

     |VENTANA 0501, 2799, -1, 16, aAlfa;
     nSubVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#zw000011;
     |PINDA #0#zw000011;
     |ENDATOS #1#zw000011;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
               #zhazmasi#nCampo# = #zw000011#nCampo#;
         |SIGUE;

         |GRABA 020#zhazmasi.a;
     |SINO;
         |SI nModo = 1;
             |BORRA 020#zhazmasi.a;
         |FINSI;
     |FINSI;
     |LIBERA #zhazmasi;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;

     |REFRESCACONTROL nGrid20;
|FPRC;

|PROCESO BotonMasivo1;
     |ABRE #agim0028;
     #agim0028#0 = 1;
     |LEE 000#agim0028.=;
     |CONSULTA_CLAVE #1#agim0028;
     |SI FSalida ! 0;  |CIERRA #agim0028; |ACABA;  |FINSI;
     |CIERRA #agim0028;

     #zhazmasi#0 = #agim0028#0;
     #zhazmasi#1 = #zhazdocu#0;
     |LEE 101#zhazmasi.=;
     |SI FSalida = 0;
         |MENAV "0000La empresa ya est  en la bandeja. Pulse doble click en la linea para modificarla.";
         |ACABA;
     |FINSI;

     enError       =0;
     enEmpresa     = #agim0028#0;
     aAlfa         = "01.01." + #zhazdocu#0;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;

     |SI enError = 1;
         |CONFI "0000NEmpresa INACTIVA. Continuar.";
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enError = 2;
         aAlfa = "0000NEmpresa con fecha disolucion " + fFechaDisol + ". Continuar.";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;
     |FINSI;

     |ABRE #maacceso;
     #maacceso#0 = #agim0028#0;
     #maacceso#1 = #zhazdocu#0;
     |LEE 040#maacceso.=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa con el Ejercicio seleccionado";
         |CONFI "2400NDesea crearla";
         |SI FSalida = 0;
             #zhazcrea#0 = #agim0028#0;
             #zhazcrea#1 = #zhazdocu#0;
             |HAZ DuplicaEmpresa;
         |FINSI;
     |FINSI;

     #maacceso#0 = #agim0028#0;
     #maacceso#1 = #zhazdocu#0;
     |LEE 040#maacceso.=;
     |SI FSalida ! 0;
         |CIERRA #maacceso;
         |ACABA;
     |FINSI;
     |CIERRA #maacceso;

     #zhazmasi#0 = #agim0028#0;
     #zhazmasi#1 = #zhazdocu#0;
     |LEE 101#zhazmasi.=;
     |SI FSalida ! 0;
         |DDEFECTO #zhazmasi;
         #zhazmasi#0 = #agim0028#0;
         #zhazmasi#1 = #agim0028#2;
         |GRABA 020#zhazmasi.b;
     |FINSI;

     nModo = 1;
     |HAZ Carga20;
     |HAZ Pide20;
|FPRC;

|PROCESO BotonMasivo2;
     |LEE 101#zhazmasi.=;
     |SI FSalida = 0;
         |BORRA 020#zhazmasi.a;
         |LIBERA #zhazmasi;

         |REFRESCACONTROL nGrid20;
     |FINSI;
|FPRC;

|PROCESO Evento20;
     |SI nRefresca = 1;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#zhazmasi.=;
     |FINSI;

     |SI FSalida = 4;
         |LEE 101#zhazmasi.=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nModo = 2;
         |HAZ Pide20;
     |FINSI;
|FPRC;

|PROCESO PaseConta;
     aAlfa = #zhazcrea#1;
     aAlfa = aAlfa % -102;

     |ABRE #canempre;
     |SELECT #4#canempre;

     perio = -1;
     #canempre#2  = #zhazcrea#0;
     #canempre#26 = aAlfa;
     |LEE 000#canempre.=;
     |SI FSalida = 0; perio = #canempre#3;  |FINSI;
     |CIERRA #canempre;

     |SI perio = -1;  |ACABA;  |FINSI;

     |HAZ VentanaTrabajo;

     empresa = #zhazcrea#0;
     empAlta = empresa;
     empre   = #zhazcrea#0;
     plani   = 1;
     siono   = "SI";
     |SUB_EJECUTA "soagico1;AUTO";

     |HAZ FinVentanaTrabajo;
|FPRC;

|PROCESO zhazmasi;
     #zhazcrea#0  = #zhazmasi#0;
     #zhazcrea#1  = #zhazdocu#0;
     #zhazcrea#2  = #zhazmasi#1;
     #zhazcrea#3  = #zhazmasi#3;
     #zhazcrea#4  = #zhazmasi#5;
     #zhazcrea#5  = #zhazmasi#7;
     #zhazcrea#6  = #zhazmasi#11;
     #zhazcrea#7  = #zhazmasi#12;
     #zhazcrea#9  = #zhazmasi#15;
     #zhazcrea#10 = #zhazmasi#16;
     #zhazcrea#12 = #zhazmasi#4;
     #zhazcrea#13 = #zhazmasi#6;
     #zhazcrea#14 = #zhazmasi#8;
     #zhazcrea#15 = #zhazmasi#19;
     #zhazcrea#17 = #zhazmasi#22;
     #zhazcrea#18 = #zhazmasi#24;

     #zregdocu#0 = #zhazcrea#0;
     #zregdocu#1 = #zhazcrea#1;
     |LEE 101#zregdocu.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregdocu;
         #zregdocu#0 = #zhazcrea#0;
         #zregdocu#1 = #zhazcrea#1;
         #zregdocu#2 = #zhazmasi#1;
         |HAZ CogeDistrIS;
         |GRABA 020#zregdocu.b;
     |FINSI;

     #zregdocu#69 = #zhazcrea#15;

     nContab = 0;
     |ABRE #sodacoca;
     #sodacoca#0 = #zhazcrea#0;
     #sodacoca#1 = #zhazcrea#1;
     |LEE 000#sodacoca.=;
     |SI FSalida ! 0;
         nContab = 1;
     |FINSI;
     |CIERRA #sodacoca;

     |SI nContab = 1;
         |HAZ PaseConta;
     |FINSI;

     |ABRE #sodacoca;
     #sodacoca#0 = #zhazcrea#0;
     #sodacoca#1 = #zhazcrea#1;
     |LEE 000#sodacoca.=;
     |SI FSalida ! 0;
         |CIERRA #sodacoca;

         |BORRA 020#zhazmasi.a;
         |LIBERA #zhazmasi;

         |REFRESCACONTROL enGrid;
         |REFRESCACONTROL nGrid20;

         |PULSATECLA;
         |ACABA;
     |FINSI;
     |CIERRA #sodacoca;

     |SI #zhazmasi#2 = "1";
         |HAZ VentanaTrabajo;
         empresa   = #zhazmasi#0;
         anyo      = #zhazdocu#0;
         eNum2008  = #zhazmasi#3;
         enTBal    = #zhazmasi#5;
         enTCta    = #zhazmasi#7;

         |SUB_EJECUTA "cuacceso;AUTO";

         |HAZ FinVentanaTrabajo;
     |FINSI;

     |ABRE #cubal802;
     |SELECT #3#cubal802;
     #cubal802#0  = #zhazcrea#0;
     #cubal802#1  = #zhazcrea#1;
     #cubal802#16 = 49500;
     |LEE 000#cubal802.=;
     |SI FSalida ! 0;  |DDEFECTO #cubal802;  |FINSI;
     |CIERRA #cubal802;

     |SI #cubal802#7 > 0;
         #zregdocu#16 = #cubal802#7;
     |FINSI;

     #zregdocu#20 = #zregdocu#16 + #zregdocu#17 + #zregdocu#18 + #zregdocu#19;
     #zregdocu#29 = #zregdocu#21 + #zregdocu#22 + #zregdocu#23 + #zregdocu#24 + #zregdocu#25 + #zregdocu#26 + #zregdocu#27 + #zregdocu#28;

     |SI #zhazmasi#9 = "1";
         enEjerCuadro = #zhazdocu#0;
         |HAZ PaseCuadros;
     |FINSI;

     |SI #zhazmasi#10 = "1";
         |HAZ CreaMemoria;
     |FINSI;

     |SI #zhazmasi#13 = "1";
         |HAZ CreaGestion;
     |FINSI;

     |SI #zhazmasi#14 = "1";
         enSwRegraba = 0;
         |HAZ CargaAutomatica;

                                  #zhazcrea#11 = "N";
         |SI #zhazmasi#17 = "S";  #zhazcrea#11 = "S";  |FINSI;

         #zregdocu#12 = #zhazcrea#9;
         #zregdocu#13 = #zhazcrea#10;
         #zregdocu#68 = #zhazcrea#11;
         #zregdocu#69 = #zhazcrea#15;
         |HAZ ActuaMaempr01;
         #zregdocu#81 = #zhazcrea#17;

         |SI #zhazmasi#23 = "S";
             enSwRegraba = 1;
             |HAZ CargaAutomatica;
             enSwRegraba = 0;
         |FINSI;

         eaModoPresenta = "";

         |SI #zhazmasi#20 = "S";
             eaModoPresenta = "I";
         |FINSI;

         |HAZ CreaCertificado;
         |HAZ CreaActaAprobacion;
     |FINSI;

     |SI #zhazmasi#18 = "1";
         |HAZ CreaDeposito;

         #zregdocu#14 = "S";
     |FINSI;

     |SI #zhazmasi#21 = "1";
         eaModoPresenta = "I";
         |HAZ CreaPortada;
     |FINSI;

     |HAZ PonColor;

     |GRABA 020#zregdocu.a;
     |LIBERA #zregdocu;

     |BORRA 020#zhazmasi.a;
     |LIBERA #zhazmasi;

     |REFRESCACONTROL enGrid;
     |REFRESCACONTROL nGrid20;

     |PULSATECLA;
|FPRC;

|DEFBUCLE zhazmasi;
     #zhazmasi#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, zhazmasi;
|FIN;

|PROCESO Masivo;
     enMensa         = 1;
     efFechaMemoria  = ~;
     efFechaCertif   = ~;

     |VENTANA 0501, 2360, -1, 16, "Creaci¢n masiva de documentos";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aFichero = ("20" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #zhazmasi#aFichero#;
     |ABRE #zhazmasi;  |CIERRA #zhazmasi;  |DELINDEX #zhazmasi;

     nRango    = 4 + 8 + 16 + 32 + 128;
     nDelindex = 0;

     |CONTROL_SIMPLE 0, "BOTON,{{206}}Nueva Empresa", 2202, 2216, BotonMasivo1;
     nBotonDep1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{207}}Quitar Empresa", 2218, 2232, BotonMasivo2;
     nBotonDep2 = FSalida;

     |ABRE #zhazmasi;
     |LINEAL_SIMPLE #1#zhazmasi, nRango, 0502, 2159, NULL, NULL, Evento20;
     nGrid20 = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{230}}Continuar," + nGrid20;
         |LEETECLA aTecla;

         |SI aTecla = aEsc1;  |O aTecla = aEsc2;  |O aTecla = aRetu;
             |LEE 000#zhazmasi.p;
             |SI FSalida ! 0;  nDelindex = 1;  |SAL;  |FINSI;

             |SI  aTecla = aEsc2;
                  nDelindex = 1;
                  |SAL;
             |SINO;
                  |CONFI "0000NProcedemos a la creaci¢n masiva.";
                  |SI FSalida = 0;
                      |SAL;
                  |FINSI;
             |FINSI;
         |FINSI;
     |SIGUE;

     |CIERRA #zhazmasi;

     |FIN_CONTROL_WINDOWS nBotonDep1;
     |FIN_CONTROL_WINDOWS nBotonDep2;

     |SI nDelindex = 0;
         nRefresca = 1;
         |BUCLE zhazmasi;
         nRefresca = 0;
     |FINSI;

     |DELINDEX #zhazmasi;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
     |PULSATECLA;

     |REFRESCACONTROL enGrid;

     enMensa = 0;
|FPRC;

|PROCESO AyudaColores;
     |VENTANA 0502, 1260, -1, 16, "Ayuda colores GRID";
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |CONTROL_SIMPLE 0, "LABEL,{{16}}Negro", 0603, 0610, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Datos por procesar", 0612, 0659, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Rojo", 0703, 0710, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Falta la memoria o el dep¢sito o las cuentas en papel", 0712, 0759, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Azul", 0803, 0810, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Falta el certificado", 0812, 0859, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Verde", 903, 910, NULL;
     |CONTROL_SIMPLE 0, "LABEL,{{16}}Todo creado", 0912, 0959, NULL;

     |PAUSA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO MiroCuadro;
   |SI #zpcuadro#6 = "-"
       nInstalo = 1;
       |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE MiroCuadro;
   #zpcuadro#1;
   2,3,4;
   2016,    1, 9, 30, "407         ";
   2016, 9999, 9, 30, "407zzzzzzzzz";
   e;
   NULL, MiroCuadro;
|FIN;

|PROGRAMA;
     fFecha      = ~;
     aAlfa       = fFecha % -104;
     #zhazdocu#0 = aAlfa;
     #zhazdocu#0 = #zhazdocu#0 - 1;

     enUltMemA = 2019;
     enUltMemP = 2019;
     enUltMemC = 2019;
     enUltCoop = 2019;
     enUltActa = 2019;
     enUltCert = 2019;

|| Instalacion inicial de documentos para el a¤o actual

     |DBASE aBase;  |QBF aBase;

     aAlfa = aBase + "word/memoria/mem" + enUltMemA + "a.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAA";
         |HAZ InstalaPatrones;
     |FINSI;
     |SI enUltMemA ] 2018;
         aAlfa = aBase + "word/memoria/mec" + enUltMemA + "a.doc";
         |XABRE "E", aAlfa, nHandle;
         |SI FSalida < 0;
             nMensa       = 0;
             aTipoInstala = "MEMORIAA";
             |HAZ InstalaPatrones;
         |FINSI;
     |FINSI;

     aAlfa = aBase + "word/memoria/mem" + enUltMemP + "p.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAP";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/memoria/mem" + enUltMemC + "c.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "MEMORIAC";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/cuentas/" + enUltCoop + "cp31.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "COOPERATIVA";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "word/actas/veract03.txt";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "ACTAS";
         |HAZ InstalaPatrones;

         aTipoInstala = "CERTI";
         |HAZ InstalaPatrones;
     |FINSI;

     aAnyo  = enUltCert; aAnyo = aAnyo % -102;
     aAlfa = aBase + "word/actas/cer" + aAnyo + "01c.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "CERTIANY";
         |HAZ InstalaPatrones;
     |FINSI;

     aAnyo  = enUltActa; aAnyo = aAnyo % -102;
     aAlfa = aBase + "word/actas/act" + aAnyo + "01c.doc";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "ACTASANY";
         |HAZ InstalaPatrones;
     |FINSI;

     aAlfa = aBase + "fich/zqcuadro.dat";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;
     |FINSI;

     nInstalo = 0;
     |ABRE #zpcuadro;
     #zpcuadro#0 = enUltMemA;
     #zpcuadro#1 = 1;
     |LEE 041#zpcuadro.];
     |SI FSalida ! 0; |O #zpcuadro#0 ! enUltMemA;
         nInstalo = 1;
     |SINO;
         |CIERRA #zpcuadro;
         |BUCLE MiroCuadro;
         |ABRE #zpcuadro;
     |FINSI;
     |CIERRA #zpcuadro;

     |SI nInstalo = 1;
         nMensa       = 0;
         aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;
     |FINSI;

     |HAZ Tipo0;

     |PINPA #0#zhazdocu;
     nPanta0 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Ayuda colores", 0550, 0565, AyudaColores;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Cambio de ejercicio", 0520, 0540, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta0, "BOTON,{{197}}Creaci¢n masiva", 0580, 0598, Masivo;
     nBoton8 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Nuevo registro", 3102, 3213, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Abrir registro", 3116, 3227, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{207}}Borrar registro", 3130, 3244, Boton7;
     nBoton7 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{136}}Ubicaciones Dep¢sito Digital", 3147, 3266, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Datos presentante", 3169, 3280, Boton6;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{137}}Documentos patrones", 3183, 3298, Boton5;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{205}}Emisi¢n masiva", 3402, 3420, EmiMasiva;
     nBtnEmi = FSalida;

     |ESTADO_CONTROL nBoton3, "DISABLE";
     |ESTADO_CONTROL nBoton7, "DISABLE";
     |ESTADO_CONTROL nBoton8, "ENABLE";
     |ESTADO_CONTROL nBtnEmi, "DISABLE";

     |SI #zhazdocu#0 [ 2008;
         |ESTADO_CONTROL nBoton8, "DISABLE";
     |FINSI;

     |PINDA #0#zhazdocu;

     enAnyo = #zhazdocu#0; |HAZ eHazEjerCCAA;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#zregdocu, nRango, 0702, 3398, Baja1, Alta1, EventoGrid;
     enGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + enGrid;
         nSalir  = 0;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu;  |Y nSalir = 0;  |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton7;
     |FIN_CONTROL_WINDOWS nBoton8;
     |FIN_CONTROL_WINDOWS nBtnEmi;
|FPRO;

|PROCESO zregdocuColor;
     |HAZ PonColor;

     |GRABA 020#zregdocu.a;
     |LIBERA #zregdocu;
|FPRC;

|DEFBUCLE zregdocuColor;
     #zregdocu#1;
     ;
     INICIO;
     FINAL;
     be;
     NULL, zregdocuColor;
|FIN;

|PROCESO Tipo80;  |TIPO 80;
     |HAZ CargaColores;

     |HAZ LeeUnidadBasico;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "documentos";      |MKDIR aAlfa;
     aAlfa = aBase + "modelos/tmp";     |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "modelos/tmp/";

     eaRutaDestino = eaUnidadBasico + "\modelos";      |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\modelos\tmp";  |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\modelos\tmp\";

     |ABRE #zregdocu;
     |SELECT #2#zregdocu;
     |LEE 000#zregdocu.u;
     |SI FSalida ! 0;  |DDEFECTO #zregdocu;  |FINSI;
     |CIERRA #zregdocu;

     aAlfa = #zregdocu#79;  |QBF aAlfa;
     |SI aAlfa = "";
         |BUCLE zregdocuColor;
     |FINSI;

     |ABRET #zregdocu;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #zregdocu;
|FPRC;
