|FICHEROS;
     isy05225 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto

     maempr10 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     maempr16 #116;             || Fichero de Paises

     isocie65 #13;              || Balances
     isocie58 #15;              || Distribucion de Resultados
     isocie83 #16;              || Resumen de Deducciones 2005
     isocie75 #18;              || Por Doble imposicion
     isocie62 #19;              || Compensaciones
     isocie67 #22;              || Informacion adicional
     isocie72 #72;              || Materializacion y Manifestacion
     isocie79 #79;              || Grupo de Sociedades
     isocie91 #91;              || Liquidacion
     isocie92 #92;              || Rentas Inmobiliarias
     isocie93 #93;              || Otras Rentas
     isocie94 #94;              || Atribucion de Rentas
     isyycasi #23;

     isw00007 #90;
     isw00008 #99,MANTE;

     isw00076 #100;             || Hoja  1
     isw00081 #101;             || Hoja  2
     isw00021 #105;             || Hoja  3 y 4
     isw00077 #102;             || Hoja  6
     isw00089 #103;             || Hoja  7
     isw00097 #107;             || Hoja  10
     isw00064 #106;             || Hoja de Ingreso y Devolucion

     isw00023 #999;                  || Carga Casillas Abreviadas Balance

     &haciend@  #706;
     &clientes@ #715;
|FIN;

|VARIABLES;
     nPara        = 0;
     nPara1       = 0;
     aDia         = "";
     aMes         = "";
     aEjerc       = "";
     aGuiri       = "";
     aFichero     = "";
     aNombreInf   = "";
     aCodPais     = "";
     aPais        = "";

     nContaBucle  = 0;
     nContaBucleL = 0;
     nPuntero     = 0;
     nPuntero1    = 0;
     nPuntero2    = 0;
     nCanti       = 0;
     nCanti1      = 0;
     nCanti2      = 0;
     nCanti3      = 0;
     nCanti4      = 0;
     nCantiT      = 0;
     nTotal494    = 0;
     nTotal495    = 0;
     nTotal496    = 0;
     nTotal497    = 0;
     nResto       = 0;
     nAnyo        = 0;
     aDImpre      = "";
     aHImpre      = "";

     fFechaD      = @;
     fFechaH      = @;
     nFecha       = 0;
     nSwHay       = 0;
     nCodigo      = 0;
     nSuma        = 0;
     nSwCoopera   = 0;
     nHay         = 0;

     aAlfa        = "";
     aAlfa0       = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAbre        = "";
     aCadena      = "";
     aLong        = "";
     aCaracter    = "";
     aConver      = "";
     aBase        = "";
     aFichOrigen  = "";
     aFichDestin  = "";
     aFich        = "";

     nHandle      = 0;
     nHandle1     = 0;
     nEspa        = 0;
     nLong        = 0;
     nCampo       = 0;
     nCampoH      = 0;
     nPos         = 0;
     nCaracter    = 0;
     nNume        = 0;
     nSwPunto     = 0;
     nDesdeClav   = 0;
     nHastaClav   = 0;
     nTotal       = 0;

     &eaImpresora = "";
     &eaTipoCola  = "";
     &eaCopia     = "";
     &enAnyo      = 0;
     &eaMoneda    = "";
     &enCanti     = 0;
     &empresa     = 0;
     &anyo        = 0;
     &enCodProv   = 0;
     &enCodPobl   = 0;
     &enCodCli    = 0;
     &enSwDeDonde = 0;
     &eaEfectivo  = "";
     &eaAdeudo    = "";
     &eaEntidad   = "";
     &eaOficina   = "";
     &eaDC        = "";
     &eaCuenta    = "";
     &enModelo    = 0;
     &enBanco     = 0;
     &enFormaPag  = 0;
     &enForzar    = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
     |SI empresa ! 0;  |ACABA;  |FINSI;

     |SI #0#0 = "S";
         |CAMPO_MODIFICA #0#01, 1, "S";
         |CAMPO_MODIFICA #0#02, 1, "S";

         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               #0nPara = 0; |PINTA #0nPara;
               |CAMPO_MODIFICA #0nPara, 1, "N";
         |SIGUE;
     |SINO;
         #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
         #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               |CAMPO_MODIFICA #0nPara, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 0;
     |HAZ PintaMoneda;
     #0#45 = eaMoneda;

     |SI #0#45 = "PESETAS";
         |MENAV "     Moneda erronea.";
         |ERROR;
     |FINSI;

     |PINTA #0#45;
|FPRC;

|| **************************************************************************
|| UTILIDADES
|| **************************************************************************

                           || 3 Enteros y 4 Decimales
|PROCESO Calcula3E4D;
     |SI aConver = "S";
         eaMoneda = #0#45;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
|FPRC;

                           || 3 Enteros y 2 Decimales
|PROCESO Calcula3E2D;
     |SI aConver = "S";
         eaMoneda = #0#45;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

                           || 2 Enteros y 2 Decimales
|PROCESO Calcula2E2D;
     |SI aConver = "S";
         eaMoneda = #0#45;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     aAlfa     = (nCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     aAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula13D;
     |SI aConver = "S";
         eaMoneda = #0#45;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     |SI nCanti ] 0;
         aAlfa = nCanti;
         aAlfa = ("0000000000000" + aAlfa) % -113;
     |SINO;
         nCanti  = -nCanti;
         aAlfa   = nCanti;
         aAlfa   = "N" + (("000000000000" + aAlfa) % -112);
     |FINSI;
|FPRC;

|PROCESO Calcula15D;
     |SI aConver = "S";
         eaMoneda = #0#45;
         enCanti  = nCanti;
         |HAZ ConverMoneda;
         nCanti   = enCanti;
     |FINSI;

     |SI nCanti ] 0;
         aAlfa = nCanti;
         aAlfa = ("000000000000000" + aAlfa) % -115;
     |SINO;
         nCanti  = -nCanti;
         aAlfa   = nCanti;
         aAlfa   = "N" + (("00000000000000" + aAlfa) % -114);
     |FINSI;
|FPRC;

|PROCESO CalculaAnyo4;
     |SI aAlfa = "  ";  aAlfa = "0000";  |ACABA;  |FINSI;

     nCanti = aAlfa;
     |SI nCanti ] 0;  |Y nCanti [ 80;
         nCanti = 2000 + nCanti;
     |SINO;
         nCanti = 1900 + nCanti;
     |FINSI;

     aAlfa = nCanti;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

|PROCESO CogePais;
     |ABRE #116;
     #116#0 = aPais;
     |LEE 000#116=;
     |SI FSalida ! 0;  |DDEFECTO #116;  |FINSI;
     |CIERRA #116;

     aCodPais = #116#2;
|FPRC;

|PROCESO CargaExplo;
     #999#0 = #23#0;
     #999#1 = "A";
     |LEE 040#999=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nPuntero1 = #999#2;

     |PARA nPara = 1; |SI nPara [ 16; |HACIENDO nPara = nPara + 1;
           |SI #23nPara ! 0;
                nPara1  = nPara + 16;
                #999#0 = #23nPara;
                #999#1 = "N";
                |LEE 040#999=;
                |SI FSalida = 0;
                    nPuntero2 = #999#2;
                    |SI #23nPara1 = "+";
                        #105nPuntero1 = #105nPuntero1 + #13nPuntero2;
                    |SINO;
                        #105nPuntero1 = #105nPuntero1 - #13nPuntero2;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE isyycasi;
     #23#1;
     ;
     #0#36, 000;
     #0#36, 999;
     ;
     NULL, CargaExplo;
|FIN;

|PROCESO LeeFich;
     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#36;
     |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |CIERRA #2;

     enCodProv = #2#29;
     enCodPobl = #2#30;
     |HAZ LeeHacienda;

     |ABRE #13;
     #13#0 = #1#0;
     #13#1 = #1#1;
     |LEE 040#13=;
     |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
     |CIERRA #13;

     |ABRE #22;
     #22#0 = #1#0;
     #22#1 = #1#1;
     |LEE 040#22=;
     |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |CIERRA #22;

     |ABRE #91;
     #91#0 = #1#0;
     #91#1 = #1#1;
     |LEE 040#91=;
     |SI FSalida ! 0; |DDEFECTO #91; |FINSI;
     |CIERRA #91;

     |ABRE #15;
     #15#0 = #1#0;
     #15#1 = #1#1;
     |LEE 040#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
     |CIERRA #15;

     |ABRE #16;
     #16#0 = #1#0;
     #16#1 = #1#1;
     |LEE 040#16=;
     |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
     |CIERRA #16;

     |ABRE #18;
     #18#0 = #1#0;
     #18#1 = #1#1;
     |LEE 040#18=;
     |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
     |CIERRA #18;

     |ABRE #72;
     #72#0 = #1#0;
     #72#1 = #1#1;
     |LEE 040#72=;
     |SI FSalida ! 0; |DDEFECTO #72; |FINSI;
     |CIERRA #72;

     |ABRE #999;
     |BUCLE isyycasi;
     |CIERRA #999;

     aGuiri = "N";
     |ABRE #4;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = 21;
     |LEE 040#4=;
     |SI FSalida = 0;
         aGuiri = "S";
     |FINSI;
     |CIERRA #4;

     #105#32 = #22#29;
     #105#52 = #22#33;
     #105#53 = #22#34;
     #105#54 = #22#35;
     #105#55 = #22#36;
     #105#56 = #22#37;
     #105#71 = #22#72;
     #105#72 = #22#73;
     #105#73 = #22#64;
|FPRC;

|PROCESO Defectos;
     |DDEFECTO #100;
     |DDEFECTO #101;
     |DDEFECTO #102;
     |DDEFECTO #105;
|FPRC;

|PROCESO Representante;
     nContaBucle = nContaBucle + 1;
     |SI nContaBucle = 1;
         #100#45 = #5#3 %  118;
         #100#46 = #5#3 %  1918;
         #100#47 = #5#4;
         #100#48 = (#5#5 % -104) + (#5#5 % 402) +  (#5#5 % 102);
         #100#49 = #5#6;
     |FINSI;

     |SI nContaBucle = 2;
         #100#50 = #5#3 %  118;
         #100#51 = #5#3 %  1918;
         #100#52 = #5#4;
         #100#53 = (#5#5 % -104) + (#5#5 % 402) +  (#5#5 % 102);
         #100#54 = #5#6;
     |FINSI;

     |SI nContaBucle = 3;
         #100#55 = #5#3 %  118;
         #100#56 = #5#3 %  1918;
         #100#57 = #5#4;
         #100#58 = (#5#5 % -104) + (#5#5 % 402) +  (#5#5 % 102);
         #100#59 = #5#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #5#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, Representante;
|FIN;

|PROCESO maempr03;
     nContaBucle  = nContaBucle + 1;
     #101#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 6) + 6;  #101nPuntero = #6#3;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#4;

     aAlfa = "0";
     |SI #6#8 = "X";  aAlfa = "1";  |FINSI;
     nPuntero = nPuntero + 1;            #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#5;

     nPuntero = nPuntero + 1;            #101nPuntero = #6#6;

     |SI aGuiri = "S";
         nPuntero = nPuntero + 1;
         aAlfa    = ("00" + #6#7) % -102;    #101nPuntero = aAlfa;
     |FINSI;

     #101#177 = &13 + &10;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr03;
     #6#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr03;
|FIN;

|PROCESO maempr06;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 42;  #101nPuntero = #7#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #7#4;

     nPuntero = nPuntero + 1;
     aAlfa    = ("00" + #7#5) % -102;     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #7#6;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #7#7;
     |HAZ Calcula3E2D;                    #101nPuntero = aAlfa;

     #101#177 = &13 + &10;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr06;
     #7#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr06;
|FIN;

|PROCESO maempr02;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 7) + 72; #101nPuntero = #8#3;

     aAlfa = "0";
     |SI #8#9 = "X";  aAlfa = "1";  |FINSI;
     nPuntero = nPuntero + 1;            #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;            #101nPuntero = #8#4;

     nPuntero = nPuntero + 1;            #101nPuntero = #8#5;

     nPuntero = nPuntero + 1;
     nNume    = #8#6;
     aAlfa    = ("00" + nNume) % -102;   #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #8#7;
     |HAZ Calcula13D;                    #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #8#8;
     |HAZ Calcula3E2D;                   #101nPuntero = aAlfa;

     #101#177 = &13 + &10;

     |SI #101#5 = " ";
         aConver = "N";
         nCanti  = #2#73;
         |HAZ Calcula3E2D;
         #101#114 = aAlfa;

         nCanti  = #2#74;
         |HAZ Calcula3E2D;
         #101#115 = aAlfa;
     |FINSI;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr02;
     #8#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, maempr02;
|FIN;

|PROCESO maempr14;
     nContaBucle  = nContaBucle + 1;
     #101#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0 = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 116; #101nPuntero = #9#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #9#4;

     nPuntero = nPuntero + 1;             #101nPuntero = #9#5;

     nPuntero = nPuntero + 1;
     aPais    = #9#6;  |HAZ CogePais;     #101nPuntero = aCodPais;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #9#8;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     #101#177 = &13 + &10;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr14;
     #9#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     nContaBucle  = nContaBucle + 1;
     #101#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #101#0);

     |LEE 101#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((nContaBucle / 6) + .49) ! 0;

                          #101#5 = "";
         |SI #101#0 ! 1;  #101#5 = "C";  |FINSI;

         |GRABA 020#101b;
     |FINSI;

     nPuntero = (nContaBucleL * 5) + 146; #101nPuntero = #10#3;

     nPuntero = nPuntero + 1;             #101nPuntero = #10#4;

     nPuntero = nPuntero + 1;
     nNume    = #10#5;
     aPais    = #10#5;  |HAZ CogePais;    #101nPuntero = aCodPais;

     nPuntero = nPuntero + 1;
     aConver = "S";
     nCanti  = #10#7;
     |HAZ Calcula13D;                     #101nPuntero = aAlfa;

     nPuntero = nPuntero + 1;
     aConver = "N";
     nCanti  = #10#8;
     |HAZ Calcula3E2D;                    #101nPuntero = aAlfa;

     #101#177 = &13 + &10;

     |GRABA 020#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr15;
     #10#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, maempr15;
|FIN;

|PROCESO isocie92;
     nContaBucle  = nContaBucle + 1;
     #102#0       = ((nContaBucle / 4) + .49) ! 0;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0       = ((nContaBucle / 4) + .49) ! 0;

                          #102#5 = "";
         |SI #102#0 ! 0;  #102#5 = "C";  |FINSI;
         nContaBucleL = 5;

         |GRABA 020#102b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     aAlfa            = ("000" + #92#3) % -103;
     #102nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     #102nContaBucleL = #92#4;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #92#5;   |HAZ Calcula13D;
     #102nContaBucleL = aAlfa;

     #102#52 = &13 + &10;

     |GRABA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE isocie92;
     #92#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, isocie92;
|FIN;

|PROCESO isocie93;
     nContaBucle  = nContaBucle + 1;
     #102#0       = ((nContaBucle / 3) + .49) ! 0;
     |LEE 101#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0       = ((nContaBucle / 3) + .49) ! 0;

                          #102#5 = "";
         |SI #102#0 ! 0;  #102#5 = "C";  |FINSI;
         nContaBucleL = 18;

         |GRABA 020#102b;
     |FINSI;

     |SI nContaBucleL ] 30;  nContaBucleL = 18;  |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     #102nContaBucleL = #93#2;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #93#3;   |HAZ Calcula13D;
     #102nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #93#4;   |HAZ Calcula13D;
     #102nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #93#5;   |HAZ Calcula13D;
     #102nContaBucleL = aAlfa;

     #102#52 = &13 + &10;

     |GRABA 020#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE isocie93;
     #93#1;
     ;
     #1#0, #1#1, "         ";
     #1#0, #1#1, "zzzzzzzzz";
     ;
     NULL, isocie93;
|FIN;

|PROCESO isocie94;
     nContaBucle  = nContaBucle + 1;
     #103#0       = ((nContaBucle / 3) + .49) ! 0;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0       = ((nContaBucle / 3) + .49) ! 0;

                          #103#5 = "";
         |SI #103#0 ! 0;  #103#5 = "C";  |FINSI;
         nContaBucleL = 5;

         |GRABA 020#103b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     #103nContaBucleL = #94#2;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "N";  nCanti  = #94#3;   |HAZ Calcula3E2D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#4;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#5;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#6;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#7;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#8;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#9;   |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#10;  |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     nContaBucleL     = nContaBucleL + 1;
     aConver = "S";  nCanti  = #94#11;  |HAZ Calcula13D;
     #103nContaBucleL = aAlfa;

     #103#57 = &13 + &10;

     |GRABA 020#103a;
     |LIBERA #103;
|FPRC;

|DEFBUCLE isocie94;
     #94#1;
     ;
     #1#0, #1#1, "         ";
     #1#0, #1#1, "zzzzzzzzz";
     ;
     NULL, isocie94;
|FIN;

|PROCESO isocie79;
     nContaBucle  = nContaBucle + 1;
     #107#0       = ((nContaBucle / 10) + .49) ! 0;
     |LEE 101#107=;
     |SI FSalida ! 0;
         |DDEFECTO #107;
         #107#0       = ((nContaBucle / 10) + .49) ! 0;

                          #107#5 = "";
         |SI #107#0 ! 0;  #107#5 = "C";  |FINSI;
         nContaBucleL = 5;

         |GRABA 020#107b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     #107nContaBucleL = #79#3;

     #107#132 = &13 + &10;

     |GRABA 020#107a;
     |LIBERA #107;
|FPRC;

|DEFBUCLE isocie79;
     #79#1;
     ;
     #1#0, #1#1, 01;
     #1#0, #1#1, 99;
     ;
     NULL, isocie79;
|FIN;

|| **************************************************************************
||                           PROCESOS DE LA CARGA DEL SECUENCIAL
|| **************************************************************************

|PROCESO AbreSecuencial;
     aAlfa      = "/AEAT";                        |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET";               |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/225";           |RMKDIR aAlfa;
     aAlfa      = "/AEAT/INTERNET/225/" + #0#36;  |RMKDIR aAlfa;

     aAbre = aAlfa + "/225" + (("00000" + #99#0) % -105) + ".TXT";

     |XABRE "CBW", aAbre, nHandle;
|FPRC;

|PROCESO QuitaRaros;
     nEspa   = 0;
     aCadena = "";
     aLong   = aAlfa % 0;
     nLong   = aLong;
     |PARA nCaracter = 1;  |SI nCaracter [ aLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos = (100 * nCaracter) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;

     aAlfa = aCadena;
     aAlfa = aAlfa > aAlfa;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO CierraSecuencial;
     |XCIERRA nHandle;
|FPRC;

|PROCESO Secuencial01;
     |PARA nCampo = 1;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #100nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial02;
     #101#2   = "225";
     #101#176 = "</T225002>";

     |PARA nCampo = 1;  |SI nCampo [ 177;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo ! 8;   |Y nCampo ! 14;  |Y nCampo ! 20;
           |Y  nCampo ! 26;  |Y nCampo ! 32;  |Y nCampo ! 38;
               aAlfa = #101nCampo;  |HAZ GrabaSecuencial;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Secuencial03;
     aAlfa = "<T225003>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 1;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #105nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #105#69;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #105#70;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 20;  |SI nCampo [ 31;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #105nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T225003>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial04;
     aAlfa = "<T225004>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 33;  |SI nCampo [ 51;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #105nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 57;  |SI nCampo [ 68;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #105nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA nCampo = 52;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #105nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #105#73;  |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     |PARA nCampo = 3;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #15nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T225004>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial05;
     nHay = 0;
     |PARA nCampo = 2;    |SI nCampo [ 35;   |HACIENDO nCampo = nCampo + 1;
           |SI #91nCampo ! 0;  nHay = 1;  |FINSI;
     |SIGUE;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aAlfa = "<T225005>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 2;    |SI nCampo [ 35;   |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #91nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T225005>";      |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;         |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial06;
     |PARA nCampo = 1;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #102nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial07;
     |PARA nCampo = 1;  |SI nCampo [ 57;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo ! 52;  |Y nCampo ! 53;
            |Y nCampo ! 54;  |Y nCampo ! 55;
               aAlfa = #103nCampo;  |HAZ GrabaSecuencial;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Secuencial08;
     aAlfa = "<T225008>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     aConver = "S";
     nCanti  = #91#73;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#67;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#144; |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#145; |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#74;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#75;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#76;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#71;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#147; |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#77;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#78;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#76;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#79;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#78;  |HAZ Calcula13D; |HAZ GrabaSecuencial;
     nCanti  = #91#80;  |HAZ Calcula13D; |HAZ GrabaSecuencial;

     |PARA nCampo = 81;  |SI nCampo [ 93;  |HACIENDO nCampo = nCampo + 1;
           aConver = "S";
           nCanti  = #91nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aAlfa = "</T225008>";   |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;      |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial09;
     aAlfa = "<T225009>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     |PARA nCampo = 94;  |SI nCampo [ 124;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo ! 111;  |Y nCampo ! 112;
           |Y  nCampo ! 113;  |Y nCampo ! 114;
               aConver     = "S";
               nCanti      = #91nCampo;
               |HAZ Calcula13D;
               |HAZ GrabaSecuencial;
           |FINSI;
     |SIGUE;

     |ABRE #19;
     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 653;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;

                     aAlfa   = #19#4;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#9;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#15; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#21; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#5;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#10; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#16; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#22; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#6;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#11; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#17; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#23; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#7;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#12; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#18; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#24; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #19#14; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#20; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#26; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #91#125; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#126; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 694;
     |LEE 040#19=;
     |SI FSalida ! 0;  |DDEFECTO #19;  |FINSI;
     |CIERRA #19;

                     aAlfa   = #19#4;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#9;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#15; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#21; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#5;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#10; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#16; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#22; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#6;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#11; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#17; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#23; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#7;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#12; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#18; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#24; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#8;  |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#13; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#19; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#25; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#27; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#28; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#29; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#30; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#31; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#32; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#33; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#34; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#35; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#36; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#37; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#38; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#39; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#40; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#41; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#42; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#43; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#44; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#45; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#46; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

                     aAlfa   = #19#47; |HAZ CalculaAnyo4;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#48; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#49; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#50; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #19#14; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#20; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #19#26; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #91#127; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#128; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aAlfa = "</T225009>";      |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;         |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial10;
     |SI #107#6   = "0000000000000";  |Y #107#7   = "         ";
      |Y #107#17  = "0000000000000";  |Y #107#128 = "0000000000000";
         |ACABA;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 132;  |HACIENDO nCampo = nCampo + 1;
           aAlfa = #107nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
|FPRC;

|PROCESO Secuencial11;
     nHay = 0;
     |PARA nCampo = 168;  |SI nCampo [ 221;  |HACIENDO nCampo = nCampo + 1;
           |SI #16nCampo ! 0;  nHay = 1;  |SAL;  |FINSI;
     |SIGUE;

     |SI #91#130 ! 0;  nHay = 1;  |FINSI;
     |SI #72#2   ! 0;  nHay = 1;  |FINSI;
     |SI #72#5   ! 0;  nHay = 1;  |FINSI;
     |SI #72#9   ! 0;  nHay = 1;  |FINSI;
     |SI #72#13  ! 0;  nHay = 1;  |FINSI;
     |SI #72#17  ! 0;  nHay = 1;  |FINSI;
     |SI #72#25  ! 0;  nHay = 1;  |FINSI;
     |SI #91#84  ! 0;  nHay = 1;  |FINSI;
     |SI #18#41  ! 0;  nHay = 1;  |FINSI;
     |SI #18#44  ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aAlfa = "<T225011>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #16#168; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #16#169; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #16#170; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #16#171; |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #16#172; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";
     |PARA nCampo = 174;  |SI nCampo [ 221;  |HACIENDO nCampo = nCampo + 1;
           nCanti  = #16nCampo;
           |HAZ Calcula13D;
           |HAZ GrabaSecuencial;
     |SIGUE;

     aConver = "S";  nCanti  = #91#130; |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#2;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#3;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#4;                       |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#5;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#6;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#7;                       |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#8;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#9;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#10;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#11;                      |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#12;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#13;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#14;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#15;                      |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#16;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#17;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#18;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#19;                      |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #72#20;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #72#25;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
                     aAlfa   = #72#26;                      |HAZ GrabaSecuencial;

     nCanti  = #72#3 + #72#6 + #72#10 + #72#14 + #72#18 + #72#25;
     aConver = "S";                     |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #91#84;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #18#2;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#3;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#5;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#6;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#7;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#8;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#9;   |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#10;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#11;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#12;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#13;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#14;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#15;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#16;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#23;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#24;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#25;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#26;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#27;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#28;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#29;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#30;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#31;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#32;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#33;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#34;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#35;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#36;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#37;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#38;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#39;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#40;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#41;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#42;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#43;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #18#17;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#18;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#19;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#20;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#21;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#44;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#45;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #18#46;  |HAZ Calcula13D;    |HAZ GrabaSecuencial;

     aAlfa = "</T225011>";      |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;         |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial12;
     aAlfa = "<T225012>";           |HAZ GrabaSecuencial;
     aAlfa = " ";                   |HAZ GrabaSecuencial;

     aConver = "S";  nCanti  = #91#131; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#132; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#133; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#134; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#135; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
     aConver = "S";  nCanti  = #91#136; |HAZ Calcula13D;  |HAZ GrabaSecuencial;
                     nCanti  = #91#131 - #91#132 - #91#133 - #91#134 - #91#135 - #91#136;
     aConver = "S";                     |HAZ Calcula13D;  |HAZ GrabaSecuencial;

     aConver = "N";  nCanti  = #91#137;  |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     aConver = "N";  nCanti  = #91#138;  |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     aConver = "N";  nCanti  = #91#139;  |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     aConver = "N";  nCanti  = #91#140;  |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     aConver = "N";  nCanti  = #91#141;  |HAZ Calcula3E2D; |HAZ GrabaSecuencial;

     aConver = "S";

     nTotal  = #91#137 + #91#138 + #91#139 + #91#140;

     |PARA nCampo = 104;  |SI nCampo [ 124;  |HACIENDO nCampo = nCampo + 2;
           nCanti1 = ((#91nCampo * #91#137) / nTotal) ! 2;
           nCanti2 = ((#91nCampo * #91#138) / nTotal) ! 2;
           nCanti3 = ((#91nCampo * #91#139) / nTotal) ! 2;
           nCanti4 = ((#91nCampo * #91#140) / nTotal) ! 2;
           nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
           nResto  = #91nCampo - nCantiT;

           |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
           |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

           |SI nCampo ! 112;  |Y nCampo ! 114;
               aConver = "S";  nCanti = nCanti1;   |HAZ Calcula13D;  |HAZ GrabaSecuencial;
               aConver = "S";  nCanti = nCanti2;   |HAZ Calcula13D;  |HAZ GrabaSecuencial;
               aConver = "S";  nCanti = nCanti3;   |HAZ Calcula13D;  |HAZ GrabaSecuencial;
               aConver = "S";  nCanti = nCanti4;   |HAZ Calcula13D;  |HAZ GrabaSecuencial;
           |FINSI;

           |SI nCampo = 124;
               nTotal494 =  nCanti1;
               nTotal495 =  nCanti2;
               nTotal496 =  nCanti3;
               nTotal497 =  nCanti4;
           |FINSI;
     |SIGUE;

     aAlfa = "</T225012>";           |HAZ GrabaSecuencial;
     aAlfa = &13 + &10;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial200;
     |PARA nCampo = 1;  |SI nCampo [ 68;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo ! 7;
               aAlfa = #106nCampo;  |HAZ GrabaSecuencial;
               |SI nCampo = 5;  |O nCampo = 18;
                   aAlfa = "0";         |HAZ GrabaSecuencial;
               |FINSI;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Secuencial;
     nSwHay = 1;

     |SI aNombreInf = "0522501";  |HAZ Secuencial01;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522502";  |HAZ Secuencial02;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522503";  |HAZ Secuencial03;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522504";  |HAZ Secuencial04;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522505";  |HAZ Secuencial05;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522506";  |HAZ Secuencial06;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522507";  |HAZ Secuencial07;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522508";  |HAZ Secuencial08;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522509";  |HAZ Secuencial09;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522510";  |HAZ Secuencial10;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522511";  |HAZ Secuencial11;  |ACABA;  |FINSI;
     |SI aNombreInf = "0522512";  |HAZ Secuencial12;  |ACABA;  |FINSI;
     |SI aNombreInf = "5225200";  |HAZ Secuencial200; |ACABA;  |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|DEFBUCLE isw00077;
     #102#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Secuencial;
|FIN;

|DEFBUCLE isw00078;
     #103#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Secuencial;
|FIN;

|DEFBUCLE isw00067;
     #101#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Secuencial;
|FIN;

|DEFBUCLE isw00061;
     #102#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Secuencial;
|FIN;

|DEFBUCLE isw00097;
     #107#1;
     ;
     nDesdeClav;
     nHastaClav;
     ;
     NULL, Secuencial;
|FIN;

|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO CargaCaracter;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = nCodigo;
     |LEE 040#4=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #100nCampo = "1";
|FPRC;

|PROCESO Hoja1;
     #90#2 = "GENERANDO HOJA 01";  |PINTA #90#2;

     |DDEFECTO #100;

     #100#6  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
     #100#7  = (#2#31 % -104) + (#2#31 % 402) + (#2#31 % 102);    || Del Dia
     #100#8  = (#2#32 % -104) + (#2#32 % 402) + (#2#32 % 102);    || Al Dia

     |SI #2#31 = "01.01.2005";  |Y #2#32 = "31.12.2005";
         #100#9 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #2#31;
         fFechaH = #2#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #100#9 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #100#9 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     #100#10 = "";                     || CNAE
     #100#11 = #2#3;                   || NIF
     #100#12 = #2#2;                   || Nombre
     #100#13 = #2#4;                   || SG
     #100#14 = #2#5;                   || Domicilio
     #100#15 = #2#6;                   || Numero
     #100#16 = #2#7;                   || Escalera
     #100#17 = #2#8;                   || Piso
     #100#18 = #2#9;                   || Puerta
     #100#19 = #2#15;                  || Telefono
     #100#20 = #2#13;                  || Municipio
     #100#21 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#22 = ("00"  + #2#10) % -102; || Codigo Provincia
     #100#23 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);   || Codigo Postal Entero
     |SI #2#98 = "S";  #100#24 = "1";  |FINSI;   || Es Complementaria
     aAlfa1  = #2#99;  |QBT aAlfa1;
     aAlfa2  = #2#100; |QBT aAlfa2;
     #100#25 = ("0000000000000" + aAlfa1 + aAlfa2) % -113;  || N§ Justificante

     |ABRE #4;
     nCodigo = 57;  nCampo = 26;  |HAZ CargaCaracter;
     nCodigo = 58;  nCampo = 27;  |HAZ CargaCaracter;
     nCodigo = 06;  nCampo = 28;  |HAZ CargaCaracter;
     nCodigo = 20;  nCampo = 29;  |HAZ CargaCaracter;
     nCodigo = 26;  nCampo = 30;  |HAZ CargaCaracter;
     nCodigo = 27;  nCampo = 31;  |HAZ CargaCaracter;
     nCodigo = 28;  nCampo = 32;  |HAZ CargaCaracter;
     nCodigo = 59;  nCampo = 33;  |HAZ CargaCaracter;
     nCodigo = 29;  nCampo = 34;  |HAZ CargaCaracter;
     nCodigo = 45;  nCampo = 35;  |HAZ CargaCaracter;
     nCodigo = 39;  nCampo = 36;  |HAZ CargaCaracter;
     |CIERRA #4;

     nNume   = #2#75 * 100;
     #100#37 = ("0000000000" + nNume) % -109;  || Empleados no fijos
     nNume   = #2#76 * 100;
     #100#38 = ("0000000000" + nNume) % -109;  || Empleados si fijos
     #100#39 = #2#77;                          || Nombre Secretario
     #100#40 = #2#78;                          || NIF    Secretario
     #100#41 = #2#13;                            || Poblacion firma
     #100#42 = aDia;                             || Dia
     #100#43 = aMes;                             || Mes
     #100#44 = aEjerc;                           || A¤o

     nContaBucle = 0;    |BUCLE maempr04;

     |SI #0#39 = "S";
         #100#58 = (("00000" + #2#0) % -105) + " " + #2#1;
     |FINSI;

     #100#64 = &13 + &10;

     aNombreInf = "0522501";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja2;
     #90#2 = "GENERANDO HOJA 02";  |PINTA #90#2;

     |ABRE #101;

     nContaBucle = 0;    |BUCLE maempr03;
     nContaBucle = 0;    |BUCLE maempr06;
     nContaBucle = 0;    |BUCLE maempr02;
     nContaBucle = 0;    |BUCLE maempr14;
     nContaBucle = 0;    |BUCLE maempr15;

     |CIERRA #101;

     aNombreInf = "0522502";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00067;

     |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
|FPRC;

|PROCESO Hoja3;
     #90#2 = "GENERANDO HOJA 03";  |PINTA #90#2;

     aNombreInf = "0522503";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja4;
     #90#2 = "GENERANDO HOJA 04";  |PINTA #90#2;

     aNombreInf = "0522504";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja5;
     #90#2 = "GENERANDO HOJA 05";  |PINTA #90#2;

     aNombreInf = "0522505";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja6;
     #90#2 = "GENERANDO HOJA 06";  |PINTA #90#2;

     nHay = 0;
     |PARA nCampo = 36;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           |SI #91nCampo ! 0;  nHay = 1;  |FINSI;
     |SIGUE;

     |SI nHay = 0;  |ACABA;  |FINSI;

     |ABRE #102;
     |DDEFECTO #102;

     aConver = "S";
     nCanti  = #91#36;
     |HAZ Calcula13D;
     #102#18 = aAlfa;

     |PARA nCampo = 37;  |SI nCampo [ 56;  |HACIENDO nCampo = nCampo + 1;
           nCampoH     = nCampo - 6;
           aConver     = "S";
           nCanti      = #91nCampo;
           |HAZ Calcula13D;
           #102nCampoH = aAlfa;
     |SIGUE;
     #102#52 = &13 + &10;

     |GRABA 020#102n;
     |LIBERA #102;

     nContaBucleL = 5;
     nContaBucle  = 0;   |BUCLE isocie92;

     nContaBucleL = 18;
     nContaBucle  = 0;   |BUCLE isocie93;
     |CIERRA #102;

     aNombreInf = "0522506";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00077;

     |ABRE #102;  |CIERRA #102;  |DELINDEX #102;
|FPRC;

|PROCESO Hoja7;
     #90#2 = "GENERANDO HOJA 07";  |PINTA #90#2;

     nHay = 0;
     |PARA nCampo = 57;  |SI nCampo [ 72;  |HACIENDO nCampo = nCampo + 1;
           |SI #91nCampo ! 0;  nHay = 1;  |FINSI;
     |SIGUE;

     |SI nHay = 0;  |ACABA;  |FINSI;

     |ABRE #103;
     |DDEFECTO #103;
     |PARA nCampo = 57;  |SI nCampo [ 72;  |HACIENDO nCampo = nCampo + 1;
           nCampoH     = nCampo - 21;
           aConver     = "S";
           nCanti      = #91nCampo;
           |HAZ Calcula13D;
           #103nCampoH = aAlfa;
     |SIGUE;

     #103#57 = &13 + &10;

     |GRABA 020#103n;
     |LIBERA #103;

     nContaBucleL = 5;
     nContaBucle  = 0;   |BUCLE isocie94;

     |CIERRA #103;

     aNombreInf = "0522507";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00078;

     |ABRE #103;  |CIERRA #103;  |DELINDEX #103;
|FPRC;

|PROCESO Hoja8;
     #90#2 = "GENERANDO HOJA 08";  |PINTA #90#2;

     aNombreInf = "0522508";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja9;
     #90#2 = "GENERANDO HOJA 09";  |PINTA #90#2;

     aNombreInf = "0522509";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja10;
     #90#2 = "GENERANDO HOJA 10";  |PINTA #90#2;

     |ABRE #107;
     |DDEFECTO #107;
     |PARA nCampo = 20;  |SI nCampo [ 133;  |HACIENDO nCampo = nCampo + 1;
           nCampoH     = nCampo - 3;
           aConver     = "S";
           nCanti      = #16nCampo;
           |HAZ Calcula13D;
           #107nCampoH = aAlfa;
     |SIGUE;

     #107#132 = &13 + &10;

     |GRABA 020#107n;
     |LIBERA #107;

     nContaBucleL = 5;
     nContaBucle  = 0;   |BUCLE isocie79;

     |CIERRA #107;

     aNombreInf = "0522510";

     nDesdeClav = 01;  nHastaClav = 99;

     |BUCLE isw00097;

     |ABRE #107;  |CIERRA #107;  |DELINDEX #107;
|FPRC;

|PROCESO Hoja11;
     #90#2 = "GENERANDO HOJA 11";  |PINTA #90#2;

     aNombreInf = "0522511";  |HAZ Secuencial;
|FPRC;

|PROCESO Hoja12;
     #90#2 = "GENERANDO HOJA 12";  |PINTA #90#2;

     aNombreInf = "0522512";  |HAZ Secuencial;
|FPRC;

|PROCESO CargaVarBanco;
     |SI enSwDeDonde = 1;
         enModelo = 201;  enForzar = 1;  |HAZ CogeDatosBancos;

         aAlfa1  = "";
         aAlfa   = eaEntidad; |QBF aAlfa; aAlfa1 = ("0000" + aAlfa) % -104;
         aAlfa   = eaOficina; |QBF aAlfa; aAlfa1 = aAlfa1 + ("0000" + aAlfa) % -104;
         aAlfa   = eaDC;      |QBF aAlfa; aAlfa1 = aAlfa1 + ("00"   + aAlfa) % -102;
         aAlfa   = eaCuenta;  |QBF aAlfa; aAlfa1 = aAlfa1 + ("0000000000" + aAlfa) % -110;
     |SINO;
         aAlfa1  = "";
         aAlfa   = #715#81;       |QBF aAlfa; aAlfa1 = ("0000" + aAlfa) % -104;
         aAlfa   = #715#82;       |QBF aAlfa; aAlfa1 = aAlfa1 + ("0000" + aAlfa) % -104;
         aAlfa   = #715#83;       |QBF aAlfa; aAlfa1 = aAlfa1 + ("00"   + aAlfa) % -102;
         aAlfa   = #715#84 % 110; |QBF aAlfa; aAlfa1 = aAlfa1 + ("0000000000" + aAlfa) % -110;
     |FINSI;
|FPRC;

|PROCESO Hoja200;
     #90#2 = "GENERANDO HOJA DE INGRESO Y DEVOLUCION ";  |PINTA #90#2;

     |DDEFECTO #106;
     #106#2 = "225";
     #106#3 = "013";

     aConver = "S";  nCanti  = #91#81;  |HAZ Calcula13D;  #106#6  = aAlfa;
     aConver = "S";  nCanti  = #91#123; |HAZ Calcula13D;  #106#8  = aAlfa;

     |SI #91#137 ! 0;
         nCanti  = nTotal494;
         aConver = "S";  |HAZ Calcula13D;  #106#9 = aAlfa;
     |FINSI;

     |SI #91#138 ! 0;
         nCanti  = nTotal495;
         aConver = "S";  |HAZ Calcula13D;  #106#10 = aAlfa;
     |FINSI;

     |SI #91#139 ! 0;
         nCanti  = nTotal496;
         aConver = "S";  |HAZ Calcula13D;  #106#11 = aAlfa;
     |FINSI;

     |SI #91#140 ! 0;
         nCanti  = nTotal497;
         aConver = "S";  |HAZ Calcula13D;  #106#12 = aAlfa;
     |FINSI;

     enCodCli = #1#0;
     |HAZ LeePersona;

     nTotal  = #91#123;
     |SI nTotal < 0;
         nCanti  = -nTotal;
         aConver = "S";  |HAZ Calcula13D;  #106#13 = aAlfa;
         |SI #2#34 = "S";
             #106#14 = "1";
         |SINO;
             #106#15 = "1";

             |HAZ CargaVarBanco;

             #106#16 = aAlfa1;
         |FINSI;
     |FINSI;

     |SI nTotal > 0;
         nCanti  = nTotal;
         aConver = "S";  |HAZ Calcula13D;  #106#19 = aAlfa;
         |SI #0#37 = "E";
             #106#17 = "1";
         |SINO;
             #106#18 = "1";

             |HAZ CargaVarBanco;

             #106#20 = aAlfa1;
         |FINSI;
     |FINSI;

     |SI nTotal = 0;
         #106#21 = "1";
     |FINSI;

     |SI #91#137 ! 0;
         nTotal  = nTotal494;
         |SI nTotal < 0;
             nCanti  = -nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#22 = aAlfa;
             |SI #2#34 = "S";
                 #106#23 = "1";
             |SINO;
                 #106#24 = "1";

                 |HAZ CargaVarBanco;

                 #106#25 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal > 0;
             nCanti  = nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#28 = aAlfa;
             |SI #0#37 = "E";
                 #106#26 = "1";
             |SINO;
                 #106#27 = "1";

                 |HAZ CargaVarBanco;

                 #106#29 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal = 0;
             #106#30 = "1";
         |FINSI;
     |FINSI;

     |SI #91#138 ! 0;
         nTotal  = nTotal495;
         |SI nTotal < 0;
             nCanti  = -nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#31 = aAlfa;
             |SI #2#34 = "S";
                 #106#32 = "1";
             |SINO;
                 #106#33 = "1";

                 |HAZ CargaVarBanco;

                 #106#34 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal > 0;
             nCanti  = nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#37 = aAlfa;
             |SI #0#37 = "E";
                 #106#35 = "1";
             |SINO;
                 #106#36 = "1";

                 |HAZ CargaVarBanco;

                 #106#38 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal = 0;
             #106#39 = "1";
         |FINSI;
     |FINSI;

     |SI #91#139 ! 0;
         nTotal  = nTotal496;
         |SI nTotal < 0;
             nCanti  = -nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#40 = aAlfa;
             |SI #2#34 = "S";
                 #106#41 = "1";
             |SINO;
                 #106#42 = "1";

                 |HAZ CargaVarBanco;

                 #106#43 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal > 0;
             nCanti  = nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#46 = aAlfa;
             |SI #0#37 = "E";
                 #106#44 = "1";
             |SINO;
                 #106#45 = "1";

                 |HAZ CargaVarBanco;

                 #106#47 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal = 0;
             #106#48 = "1";
         |FINSI;
     |FINSI;

     |SI #91#140 ! 0;
         nTotal  = nTotal497;
         |SI nTotal < 0;
             nCanti  = -nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#49 = aAlfa;
             |SI #2#34 = "S";
                 #106#50 = "1";
             |SINO;
                 #106#51 = "1";

                 |HAZ CargaVarBanco;

                 #106#52 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal > 0;
             nCanti  = nTotal;
             aConver = "S";  |HAZ Calcula13D;  #106#55 = aAlfa;
             |SI #0#37 = "E";
                 #106#53 = "1";
             |SINO;
                 #106#54 = "1";

                 |HAZ CargaVarBanco;

                 #106#56 = aAlfa1;
             |FINSI;
         |FINSI;

         |SI nTotal = 0;
             #106#57 = "1";
         |FINSI;
     |FINSI;

     #106#58 = #2#13;                            || Poblacion firma
     #106#59 = aDia;                             || Dia
     #106#60 = aMes;                             || Mes
     #106#61 = aEjerc;                           || A¤o

     #106#67 = "</T225013>";
     #106#68 = &13 + &10;

     aNombreInf = "5225200";  |HAZ Secuencial;
|FPRC;

|PROCESO ImprimeLos;
     |PINPA #0#90;
     |C_V #90#3, 1, "N";
     |ATRI P;
     |PINTA 1111, "Generando Fichero ASCCI ";
     |ATRI p;
     |PINTA 1162, "          ";

     #90#0 = #99#0;  |PINTA #90#0;
     #90#1 = #99#3;  |PINTA #90#1;

     |HAZ Defectos;
     |HAZ LeeFich;

     |HAZ AbreSecuencial;

     |HAZ Hoja1;
     |HAZ Hoja2;
     |HAZ Hoja3;
     |HAZ Hoja4;
     |HAZ Hoja5;
     |HAZ Hoja6;
     |HAZ Hoja7;
     |HAZ Hoja8;
     |HAZ Hoja9;
     |HAZ Hoja10;
     |HAZ Hoja11;
     |HAZ Hoja12;
     |HAZ Hoja200;

     |HAZ CierraSecuencial;

     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#36;
     |LEE 101#1=;
     |SI FSalida = 0;
         #1#6 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
|FPRC;

|DEFBUCLE rew00001;
     #99#1;
     5;
     00000, "S";
     99999, "S";
     ;
     NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
     aDia   = #0#33 % 102;
     aMes   = #0#33 % 402;
     aEjerc = #0#33 % -104;

     |SI aMes = "01"; aMes = "ENERO     "; |FINSI;
     |SI aMes = "02"; aMes = "FEBRERO   "; |FINSI;
     |SI aMes = "03"; aMes = "MARZO     "; |FINSI;
     |SI aMes = "04"; aMes = "ABRIL     "; |FINSI;
     |SI aMes = "05"; aMes = "MAYO      "; |FINSI;
     |SI aMes = "06"; aMes = "JUNIO     "; |FINSI;
     |SI aMes = "07"; aMes = "JULIO     "; |FINSI;
     |SI aMes = "08"; aMes = "AGOSTO    "; |FINSI;
     |SI aMes = "09"; aMes = "SEPTIEMPRE"; |FINSI;
     |SI aMes = "10"; aMes = "OCTUBRE   "; |FINSI;
     |SI aMes = "11"; aMes = "NOVIEMBRE "; |FINSI;
     |SI aMes = "12"; aMes = "DICIEMBRE "; |FINSI;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
     #99#0 = #1#0;
     #99#1 = "";
     #99#2 = "";
     #99#3 = #1#2;
     #99#4 = 1;
     #99#5 = "S";
     #99#6 = 1;
     #99#7 = #1#3;
     |GRABA 040#99n;

     nSwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
     #1#1;
     5, 6;
     #0#36, #0#1, "225", aDImpre;
     #0#36, #0#2, "225", aHImpre;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
     #99#0 = 1;
|FRUT;

|RUTINA superior;
     #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
     aFichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 aFichero;
     |ABRE #99; |CIERRA #99; |DELINDEX #99;

     |ABRE #99;
     nSwHay = 0;
     |SI #0#0 = "S";
         |BUCLE isacceso;
     |SINO;
         |PARA nPara = 3; |SI nPara [ 32; |HACIENDO nPara = nPara + 1;
               |SI #0nPara ! 0;
                   #0#1 = #0nPara;
                   #0#2 = #0nPara;
                   |BUCLE isacceso;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #99;

     |SI nSwHay = 0; |ACABA; |FINSI;

     |SI #0#34 = "N"; |ACABA; |FINSI;

     |ENTLINEAL #1#99, -1, 4, 22, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
     |SI FSalida ! 10; |ACABA; |FINSI;

     |LIBERA #99;
     |LEE 140#99=;

     |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
     |PINTA #99#5;
     |GRABA 140#99a;
|FPRC;

|PROCESO CargaTabla;
     aFichero = ("02" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 aFichero;

     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;

     |ABRE #999;
     |PARA nPara = 101; |SI nPara [ 190; |HACIENDO nPara = nPara + 1;
           #999#0 = nPara;  #999#1 = "N";  #999#2 = 0;

           |SI nPara [ 111;                 nPara1  = nPara - 98;   |FINSI;
           |SI nPara = 114;                 nPara1  = 14;           |FINSI;
           |SI nPara ] 120; |Y nPara [ 126; nPara1  = nPara - 105;  |FINSI;
           |SI nPara ] 134; |Y nPara [ 143; nPara1  = nPara - 112;  |FINSI;
           |SI nPara ] 154; |Y nPara [ 173; nPara1  = nPara - 122;  |FINSI;
           |SI nPara ] 175; |Y nPara [ 183; nPara1  = nPara - 123;  |FINSI;
           |SI nPara ] 185; |Y nPara [ 186; nPara1  = nPara - 124;  |FINSI;
           |SI nPara ] 188; |Y nPara [ 190; nPara1  = nPara - 125;  |FINSI;

           #999#2 = nPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA nPara = 201; |SI nPara [ 273; |HACIENDO nPara = nPara + 1;
           #999#0 = nPara;  #999#1 = "N";  #999#2 = 0;

           |SI nPara [ 202;                 nPara1  = nPara - 135;  |FINSI;
           |SI nPara = 203;                 nPara1  = 194;          |FINSI;
           |SI nPara ] 204; |Y nPara [ 209; nPara1  = nPara - 136;  |FINSI;
           |SI nPara ] 211; |Y nPara [ 213; nPara1  = nPara - 137;  |FINSI;
           |SI nPara ] 215; |Y nPara [ 217; nPara1  = nPara - 138;  |FINSI;
           |SI nPara = 218;                 nPara1  = 195;          |FINSI;
           |SI nPara ] 220; |Y nPara [ 225; nPara1  = nPara - 140;  |FINSI;
           |SI nPara ] 227; |Y nPara [ 246; nPara1  = nPara - 141;  |FINSI;
           |SI nPara ] 248; |Y nPara [ 248; nPara1  = nPara - 142;  |FINSI;
           |SI nPara ] 251; |Y nPara [ 256; nPara1  = nPara - 144;  |FINSI;
           |SI nPara ] 258; |Y nPara [ 273; nPara1  = nPara - 145;  |FINSI;

           #999#2 = nPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA nPara = 301; |SI nPara [ 351; |HACIENDO nPara = nPara + 1;
           #999#0 = nPara;  #999#1 = "N";  #999#2 = 0;

           |SI nPara ] 301; |Y nPara [ 315; nPara1  = nPara - 172;   |FINSI;
           |SI nPara ] 312; |Y nPara [ 314; nPara1  = nPara - 178;   |FINSI;
           |SI nPara ] 320; |Y nPara [ 323; nPara1  = nPara - 183;   |FINSI;
           |SI nPara ] 326; |Y nPara [ 330; nPara1  = nPara - 185;   |FINSI;
           |SI nPara ] 333; |Y nPara [ 337; nPara1  = nPara - 187;   |FINSI;
           |SI nPara ] 340; |Y nPara [ 351; nPara1  = nPara - 189;   |FINSI;

           #999#2 = nPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA nPara = 401; |SI nPara [ 441; |HACIENDO nPara = nPara + 1;
           #999#0 = nPara;  #999#1 = "N";  #999#2 = 0;

           |SI nPara = 408;                 nPara1  = 163;          |FINSI;
           |SI nPara ] 403; |Y nPara [ 407; nPara1  = nPara - 239;  |FINSI;
           |SI nPara ] 410; |Y nPara [ 413; nPara1  = nPara - 241;  |FINSI;
           |SI nPara ] 416; |Y nPara [ 419; nPara1  = nPara - 243;  |FINSI;
           |SI nPara ] 422; |Y nPara [ 425; nPara1  = nPara - 245;  |FINSI;
           |SI nPara ] 428; |Y nPara [ 432; nPara1  = nPara - 247;  |FINSI;
           |SI nPara ] 434; |Y nPara [ 441; nPara1  = nPara - 248;  |FINSI;

           #999#2 = nPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     #999#0 = 101;  #999#1 = "A";  #999#2 = 1;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 102;  #999#1 = "A";  #999#2 = 2;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 114;  #999#1 = "A";  #999#2 = 3;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 134;  #999#1 = "A";  #999#2 = 4;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 154;  #999#1 = "A";  #999#2 = 5;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 155;  #999#1 = "A";  #999#2 = 6;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 156;  #999#1 = "A";  #999#2 = 7;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 157;  #999#1 = "A";  #999#2 = 8;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 158;  #999#1 = "A";  #999#2 = 9;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 166;  #999#1 = "A";  #999#2 = 10; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 175;  #999#1 = "A";  #999#2 = 11; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 185;  #999#1 = "A";  #999#2 = 12; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 186;  #999#1 = "A";  #999#2 = 13; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 188;  #999#1 = "A";  #999#2 = 14; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 189;  #999#1 = "A";  #999#2 = 15; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 190;  #999#1 = "A";  #999#2 = 16; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 201;  #999#1 = "A";  #999#2 = 17; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 202;  #999#1 = "A";  #999#2 = 18; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 203;  #999#1 = "A";  #999#2 = 69; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 204;  #999#1 = "A";  #999#2 = 19; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 210;  #999#1 = "A";  #999#2 = 20; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 214;  #999#1 = "A";  #999#2 = 21; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 215;  #999#1 = "A";  #999#2 = 22; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 216;  #999#1 = "A";  #999#2 = 23; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 217;  #999#1 = "A";  #999#2 = 24; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 218;  #999#1 = "A";  #999#2 = 70; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 220;  #999#1 = "A";  #999#2 = 25; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 225;  #999#1 = "A";  #999#2 = 26; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 231;  #999#1 = "A";  #999#2 = 27; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 248;  #999#1 = "A";  #999#2 = 28; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 271;  #999#1 = "A";  #999#2 = 29; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 272;  #999#1 = "A";  #999#2 = 30; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 273;  #999#1 = "A";  #999#2 = 31; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 306;  #999#1 = "A";  #999#2 = 33; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 312;  #999#1 = "A";  #999#2 = 34; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 313;  #999#1 = "A";  #999#2 = 35; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 314;  #999#1 = "A";  #999#2 = 36; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 320;  #999#1 = "A";  #999#2 = 37; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 326;  #999#1 = "A";  #999#2 = 38; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 333;  #999#1 = "A";  #999#2 = 39; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 340;  #999#1 = "A";  #999#2 = 40; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 341;  #999#1 = "A";  #999#2 = 41; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 342;  #999#1 = "A";  #999#2 = 42; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 343;  #999#1 = "A";  #999#2 = 43; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 344;  #999#1 = "A";  #999#2 = 44; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 345;  #999#1 = "A";  #999#2 = 45; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 346;  #999#1 = "A";  #999#2 = 46; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 347;  #999#1 = "A";  #999#2 = 47; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 348;  #999#1 = "A";  #999#2 = 48; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 349;  #999#1 = "A";  #999#2 = 49; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 350;  #999#1 = "A";  #999#2 = 50; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 351;  #999#1 = "A";  #999#2 = 51; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 405;  #999#1 = "A";  #999#2 = 57; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 414;  #999#1 = "A";  #999#2 = 58; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 415;  #999#1 = "A";  #999#2 = 59; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 433;  #999#1 = "A";  #999#2 = 60; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 434;  #999#1 = "A";  #999#2 = 61; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 435;  #999#1 = "A";  #999#2 = 62; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 436;  #999#1 = "A";  #999#2 = 63; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 437;  #999#1 = "A";  #999#2 = 64; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 438;  #999#1 = "A";  #999#2 = 65; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 439;  #999#1 = "A";  #999#2 = 66; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 440;  #999#1 = "A";  #999#2 = 67; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 441;  #999#1 = "A";  #999#2 = 68; |GRABA 140#999n;  |LIBERA #999;

     |CIERRA #999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     enAnyo  = #0#36;
     nAnyo   = #0#36;
     |SI #0#38 = "N";
         aDImpre = "N";
         aHImpre = "N";
     |SINO;
         aDImpre = "N";
         aHImpre = "S";
     |FINSI;

     aFichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #101 aFichero;
     |ABRE #101;  |CIERRA #101;  |DELINDEX #101;

     aFichero = ("04" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #102 aFichero;
     |ABRE #102;  |CIERRA #102;  |DELINDEX #102;

     aFichero = ("05" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #103 aFichero;
     |ABRE #103;  |CIERRA #103;  |DELINDEX #103;

     aFichero = ("07" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #107 aFichero;
     |ABRE #107;  |CIERRA #107;  |DELINDEX #107;

     |HAZ TipoImpre;
     |HAZ CargaTabla;
     |HAZ CargaTempo;

     |SI nSwHay = 0;
         |ABRE #99;   |CIERRA #99;   |DELINDEX #99;
         |ABRE #999;  |CIERRA #999;  |DELINDEX #999;
         |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
         |ABRE #102;  |CIERRA #102;  |DELINDEX #102;
         |ABRE #103;  |CIERRA #103;  |DELINDEX #103;
         |ABRE #107;  |CIERRA #107;  |DELINDEX #107;

         |MENAV "0000 Seleccion Vacia.";

         |ACABA;
     |FINSI;

     nSwHay = 0;
     |BUCLE rew00001;

     |ABRE #99;   |CIERRA #99;   |DELINDEX #99;
     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;
     |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
     |ABRE #102;  |CIERRA #102;  |DELINDEX #102;
     |ABRE #103;  |CIERRA #103;  |DELINDEX #103;
     |ABRE #107;  |CIERRA #107;  |DELINDEX #107;
|FPRC;

|PROCESO Copiando;
     |DFICE aFich;  |QBF aFich;
     aFichOrigen  = aFich + aAlfa + ".ddd";
     aFichDestin  = aFich + aAlfa + ".dat";
     |COPIA_FICHERO aFichOrigen, aFichDestin;

     aFichOrigen = aFich + aAlfa + ".ddx";
     |FBORRA aFichOrigen;

     aFichOrigen = aFich + aAlfa + ".ixx";
     |FBORRA aFichOrigen;
|FPRC;

|PROGRAMA;
     |ABRE #23;
     #23#33 = #0#36;
     #23#0  = 1;
     |LEE 040#23];
     |SI FSalida ! 0;  |O  #23#33 ! #0#36;
         |CIERRA #23;
         aAlfa = "isyycasi";
         |HAZ Copiando;
     |FINSI;
     |CIERRA #23;

     |ABRE #23;
     #23#33 = #0#36;
     #23#0  = 1;
     |LEE 040#23];
     |SI FSalida ! 0;  |O  #23#33 ! #0#36;
         aAlfa = "     Instale casillas Balance del " + #0#36 + " para la Impresion.";
         |MENAV aAlfa;
         |CIERRA #23;
         |ACABA;
     |FINSI;
     |CIERRA #23;

     |SI empresa ! 0;
         #0#0 = "S";
         |PARA nCampo = 0;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";
         |SIGUE;
         #0#1  = empresa;  |PINTA #0#1;
         #0#2  = empresa;  |PINTA #0#2;
         #0#36 = anyo;
         |PINPA #0#0;
         |PINDA #0#0;
         |ENDATOS #1#0;
     |SINO;
         |MANTE #0;
     |FINSI;

     |SI nSwHay = 1;
         aAlfa = "0000 Los ficheros generados estan en C:\AEAT\INTERNET\225\" + #0#36;
         |MENAV aAlfa;
     |FINSI;
|FPRO;
