|FICHEROS;
     z0000014 #0;
     zpcuadro #5;
     zocuadro #6;
     zqcuadro #7;
|FIN;

|VARIABLES;
     aDirPatron   = "";
     aOrigen      = "";
     aDestino     = "";
     aBase        = "";
     aDirInsta    = "";
     aFichero     = "";
     aTipoInstala = "";
     aAlfa        = "";
     nMensa       = 0;
     aAlfa1       = "";
     aAnyo        = "";
     nHandle      = 0;

     &enPersonaliza = 0;
     aID            = "";
     nID            = 0;
     nRango         = 0;
     nBotonSal      = 0;
     {40} aSubPopup = "";

     fFecha         = @;
     nEjer          = 0;
     nSw            = 0;
|FIN;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO CopiaPatron;
     aOrigen    = aDirPatron + aFichero;
     aDestino   = aDirInsta  + aFichero;
     |COPIA_FICHERO aOrigen, aDestino;
|FPRC;

|PROCESO InstalaCuadroP;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zpcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zpcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroA;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zocuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zocuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaCuadroC;
     FSalida = 0;
     |SI nMensa = 1;
         |CONFI "2400NLa plantilla ya est  instalada, quiere reinstalarla de nuevo";
     |FINSI;

     |SI FSalida ! 0;   |ACABA;   |FINSI;

     aDirInsta  = aBase + "fich/";

     aFichero   = "zqcuadro.dat";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ddx";  |HAZ CopiaPatron;
     aFichero   = "zqcuadro.ixx";  |HAZ CopiaPatron;

     |SI nMensa = 1;
         |MENAV "0000 Plantilla instalada.";
     |FINSI;
|FPRC;

|PROCESO InstalaPatrones;
     |DBASE aBase;  |QBF aBase;
     aDirPatron = aBase + "planilla/";
     aFichero   = aDirPatron + "dcpatron.tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + "dcpatron.tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |SI aTipoInstala = "CUADROP";       |HAZ InstalaCuadroP;       |FINSI;
     |SI aTipoInstala = "CUADROA";       |HAZ InstalaCuadroA;       |FINSI;
     |SI aTipoInstala = "CUADROC";       |HAZ InstalaCuadroC;       |FINSI;

     aAlfa = aDirPatron + "memor001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "memo2009.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2010a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2011c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2012c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2013c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2014c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2015c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2016c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2017c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2018p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2018a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2018c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2019p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mec2019a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019a.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "mem2019c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0101.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0102.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0103.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0201.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0202.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0203.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0301.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0401.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0402.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0403.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0501.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0502.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0503.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0601.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0602.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0603.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0701.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0702.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0703.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0800.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0801.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0802.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0803.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert0901.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1002.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1003.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cert1004.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0101.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0102.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0103.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0201.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0202.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0203.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0301.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0302.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0303.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0401.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0402.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0403.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0501.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0502.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0503.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0601.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0602.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0603.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0701.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0702.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0703.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0800.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0801.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0802.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0803.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta0901.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1002.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1003.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "acta1004.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "gesti001.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zpcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zocuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.dat";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ddx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "zqcuadro.ixx";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cacoop22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp21.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp22.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2011cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2012cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2013cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2014cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2015cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2016cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2017cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2018cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp31.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "2019cp32.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "porta001.doc";  |FBORRA aAlfa;

     aAnyo = "17"; |HAZ BActayCerti;
     aAnyo = "18"; |HAZ BActayCerti;
     aAnyo = "19"; |HAZ BActayCerti;

     |PULSATECLA;
|FPRC;

|PROCESO  BActayCerti;
     aAlfa = aDirPatron + "cer" + aAnyo + "01p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "01n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "02n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "03s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "04n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "05n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "06n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "07n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "08n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "09s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "cer" + aAnyo + "10n.doc";  |FBORRA aAlfa;

     aAlfa = aDirPatron + "act" + aAnyo + "01p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "01c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "01n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "02n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "03s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "04n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "05n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "06n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "07n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "08n.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "09s.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10p.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10c.doc";  |FBORRA aAlfa;
     aAlfa = aDirPatron + "act" + aAnyo + "10n.doc";  |FBORRA aAlfa;
|FPRC;

|PROCESO Baja5;
     #5#0 = #0#0;
     #5#1 = 1;
|FPRC;

|PROCESO Alta5;
     #5#0 = #0#0;
     #5#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroP;
     |PUSHV 0501 2380;
     aAlfa = "Plantilla carga autom tica de los cuadros PYME. Ejercicio " + #0#0;
     |ATRI S; |PINTA 0502, aAlfa; |ATRI 0;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #5;
     |LINEAL_SIMPLE #1#5, nRango, 0602, 2159, Baja5, Alta5, NULL;
     |CIERRA #5;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |PULSATECLA;
     |POPV;
|FPRC;

|PROCESO Baja6;
     #6#0 = #0#0;
     #6#1 = 1;
|FPRC;

|PROCESO Alta6;
     #6#0 = #0#0;
     #6#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroA;
     |PUSHV 0501 2380;
     aAlfa = "Plantilla carga autom tica de los cuadros abreviada. Ejercicio " + #0#0;
     |ATRI S; |PINTA 0502, aAlfa; |ATRI 0;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #6;
     |LINEAL_SIMPLE #1#6, nRango, 0602, 2159, Baja6, Alta6, NULL;
     |CIERRA #6;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |PULSATECLA;
     |POPV;
|FPRC;

|PROCESO Baja7;
     #7#0 = #0#0;
     #7#1 = 1;
|FPRC;

|PROCESO Alta7;
     #7#0 = #0#0;
     #7#1 = 9999;
|FPRC;

|PROCESO PlantillaCuadroC;
     |PUSHV 0501 2380;

     aAlfa = "Plantilla carga autom tica de los cuadros de cooperativas. Ejercicio " + #0#0;
     |ATRI S; |PINTA 0502, aAlfa; |ATRI 0;

     nRango = 1 + 4 + 8 + 16;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 2351, 2359, BotonSalir;
     nBotonSal = FSalida;

     |ABRE #7;
     |LINEAL_SIMPLE #1#7, nRango, 0602, 2159, Baja7, Alta7, NULL;
     |CIERRA #7;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBotonSal;

     |PULSATECLA;
     |POPV;
|FPRC;

|PROCESO zpcuadro;
    #5#0 = #0#0;
    |GRABA 020#5n;
|FPRC;

|DEFBUCLE zpcuadro;
    #5#1;
    ;
    nEjer, 0001;
    nEjer, 9999;
    e;
    NULL, zpcuadro;
|FIN;

|PROCESO zocuadro;
    #6#0 = #0#0;
    |GRABA 020#6n;
|FPRC;

|DEFBUCLE zocuadro;
    #6#1;
    ;
    nEjer, 0001;
    nEjer, 9999;
    e;
    NULL, zocuadro;
|FIN;

|PROCESO zqcuadro;
    #7#0 = #0#0;
    |GRABA 020#7n;
|FPRC;

|DEFBUCLE zqcuadro;
    #7#1;
    ;
    nEjer, 0001;
    nEjer, 9999;
    e;
    NULL, zqcuadro;
|FIN;

|PROCESO  CopiaPlantilla;
     nEjer = #0#0 - 1;

     nSw = 0;
     |ABRE #5;
     #5#0 = #0#0;
     #5#1 = 1;
     |LEE 041#5];
     |SI FSalida = 0; |Y #5#0 = #0#0;
         aAlfa = "    Hay datos de Cuadros PYME del Ejercicio " + #0#0 + ". No se copia";
         nSw   = 1;
         |MENAV aAlfa;
     |FINSI;
     |CIERRA #5;
     |SI nSw = 0; |BUCLE zpcuadro; |FINSI;

     nSw = 0;
     |ABRE #6;
     #6#0 = #0#0;
     #6#1 = 1;
     |LEE 041#6];
     |SI FSalida = 0; |Y #6#0 = #0#0;
         aAlfa = "    Hay datos de Cuadros Abreviada del Ejercicio " + #0#0 + ". No se copia";
         nSw   = 1;
         |MENAV aAlfa;
     |FINSI;
     |CIERRA #6;
     |SI nSw = 0; |BUCLE zocuadro; |FINSI;

     nSw = 0;
     |ABRE #7;
     #7#0 = #0#0;
     #7#1 = 1;
     |LEE 041#7];
     |SI FSalida = 0; |Y #7#0 = #0#0;
         aAlfa = "    Hay datos de Cuadros Cooperativa del Ejercicio " + #0#0 + ". No se copia";
         nSw   = 1;
         |MENAV aAlfa;
     |FINSI;
     |CIERRA #7;
     |SI nSw = 0; |BUCLE zqcuadro; |FINSI;
|FPRC;

|PROCESO PatronesMemoria;
     aAlfa = "|C001WID";
     aID   = #z0000014#aAlfa#;
     nID   = aID;

     aSubPopup1 = nID;
     aSubPopup2 = 08
     aSubPopup3 = "01.- Instalar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup4 = "02.- Instalar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup5 = "03.- Instalar plantilla de la carga automatica de los cuadros de cooperativas";
     aSubPopup6 = "04.- Editar plantilla de la carga automatica de los cuadros PYME";
     aSubPopup7 = "05.- Editar plantilla de la carga automatica de los cuadros abreviada";
     aSubPopup8 = "06.- Editar plantilla de la carga automatica de los cuadros de cooperativas";
     aSubPopup9 = "07.- Copiar plantilla de cuadros al ejercicio informado ";
     aSubPopup10 = "08.- Salir";

     |PARA;  |SI;  |HACIENDO;
          IaSubPopup  = aSubPopup1  <-;
          |ESPECIFICA "TRACKPOPUP", aSubPopup;
          |SI FSalida ! 0;
              IaSubPopup  = aSubPopup3  <-;
              IaSubPopup  = IaSubPopup + (FSalida - 1);

              aAlfa1        = aSubPopup % 102;
              enPersonaliza = 0;
              nMensa        = 1;

              |SI aAlfa1 = "01";  aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "02";  aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "03";  aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;  |FINSI;
              |SI aAlfa1 = "04";  |HAZ PlantillaCuadroP;                           |FINSI;
              |SI aAlfa1 = "05";  |HAZ PlantillaCuadroA;                           |FINSI;
              |SI aAlfa1 = "06";  |HAZ PlantillaCuadroC;                           |FINSI;
              |SI aAlfa1 = "07";  |HAZ CopiaPlantilla;                             |FINSI;
              |SI aAlfa1 = "08";  |SAL;                                            |FINSI;

              |PULSATECLA;
          |FINSI;
     |SIGUE;

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
     |SI #0#1 = "S";
||         |HAZ PatronesMemoria;
         |HAZ CopiaPlantilla;
     |FINSI;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     fFecha    = ~;
     aAlfa     = fFecha % -104;
     #0#0      = aAlfa;
     #0#0      = #0#0 - 1;

|| Instalacion inicial de documentos para el a¤o actual
     |DBASE aBase;  |QBF aBase;

     aAlfa = aBase + "fich/zqcuadro.dat";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         nMensa       = 0;
         aTipoInstala = "CUADROP"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROA"; |HAZ InstalaPatrones;
         aTipoInstala = "CUADROC"; |HAZ InstalaPatrones;
     |FINSI;

     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
|FPRO;
