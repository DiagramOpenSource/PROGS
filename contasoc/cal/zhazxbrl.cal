|FICHEROS;
     zhazxbrl #0;

     :contagen/ca8m0000 #1;
     :basica/agifigen;
     :basica/agim0135   #135;

     maempr10 #2;
     maempr22;
     maempr23;
     maempr24;
     maempr25;

     cuacceso #100;
     cubal801 #101;
     cubal802 #102;
     cubal803 #103;
     cubal804 #104;
     cubal805 #105;
     zregcu12 #106;
     zregpres #107;
     zregcu29;

     zregdocu;
     zregfirm #204;

     :/basica/def/agim0019 #319;
     :/basica/def/agim0038 #338;
     :/basica/def/agim0039 #339;
     :/basica/def/agim0040 #340;
     :/basica/def/agim0041 #341;
     :/basica/def/agim0042 #342;
     :/basica/def/agim0043 #343;
     :/basica/def/agim0044 #344;
     :/basica/def/agim0045 #345;
     :/basica/def/agim0046 #346;
     :/basica/def/agim0035 #309;

     :integral/dsam0000;
|FIN;

|VARIABLES;
     aBase            = "";
     aDirXBRLServidor = "";
     aDirXBRLLocal    = "";
     aDirAPILocal     = "";
     aDirDEPOLocal    = "";
     aDirDOCULocal    = "";
     aXMLServidor     = "";
     aXMLLocal        = "";
     aXMLDEPO         = "";
     aBATLocal        = "";
     aIPRemoto        = "";
     aAlfa            = "";
     aAlfa1           = "";
     aRaiz            = "";
     aHora            = "";
     aTipoInforme     = "";
     aTipoD2          = "";
     aDecimals        = "";
     aSigno           = "";
     aDTipo           = "";
     aHTipo           = "";
     aTipoF           = "";
     aTipoI           = "";
     aRuta            = "";
     aLong            = "";
     aCodigo          = "";
     aValor           = "";
     aAbre            = "";
     aOrigen          = "";
     aDestino         = "";
     aQueQuiero       = "";
     aMail            = "";

     nHandle          = 0;
     nHandleXML       = 0;
     nHandleBAT       = 0;
     nTipoBal         = 0;
     nTipoPyG         = 0;
     nEjer            = 0;
     nImporte         = 0;
     nPaso            = 0;
     nPasada          = 0;
     nHay             = 0;
     nNume            = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nRow             = 0;
     nXBRL            = 0;
     nLong            = 0;
     nCarac           = 0;
     nPos             = 0;
     nPanta           = 0;
     nColumna         = 0;
     nBoton1          = -1;
     nSw22            = 0;
     nSw23            = 0;
     nSw339           = 0;
     nSw340           = 0;
     nSw341           = 0;
     nSw342           = 0;
     nSw343           = 0;
     nSw344           = 0;
     nSw345           = 0;
     nSuma            = 0;
     nConta           = 0;
     nAmbiente        = 0;
     fFecha           = @;

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enMensa         = 0;
     &eaAlfa          = 0;
     &eaCampo3        = "";
     &eaCampo4        = "";
     &eaCampo5        = "";
     &eaCampo6        = "";
     &eaCampo7        = "";
     &eaCampo8        = "";
     &eaCampo9        = "";
     &eaCampo10       = "";
     &eaCampo11       = "";
     &eaCampo12       = "";
     &eaUnidadBasico  = "";
     &eaPathIntegral  = "";
|FIN;

|PROCESO GrabaXML;
     eaAlfa = aAlfa;  |HAZ QuitaRarosXBRL;

     aAlfa = eaAlfa + &13 + &10;
     |XGRABA nHandleXML, aAlfa;
|FPRC;

|PROCESO GrabaBAT;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandleBAT, aAlfa;
|FPRC;

|PROCESO AbreFicheroXml;
     |XABRE "BW", aXMLServidor, nHandleXML;

     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "UTF-8" + &34 + "?>";
     |HAZ GrabaXML;

     aAlfa = "<report xmlns=" + &34 + "http://www.inteco.es/xbrl/pgc07/interfazES" + &34;
     |HAZ GrabaXML;

     aAlfa = "    xmlns:xsi=" + &34 + "http://www.w3.org/2001/XMLSchema-instance" + &34;
     |HAZ GrabaXML;

     aAlfa = "    xsi:schemaLocation=" + &34 + "http://www.inteco.es/xbrl/pgc07/interfazES http://www.inteco.es/xbrl/pgc07/interfazES/pgc07-io-interface.xsd" + &34;
     |HAZ GrabaXML;

     fFecha = ~;
     |HORA aHora;

     aAlfa = fFecha;
     aAlfa = (aAlfa % -104) + "-" + (aAlfa % 402) + "-" + (aAlfa % 102);
     aAlfa = aAlfa + "T" + aHora;
     aAlfa = "    id=" + &34 + aTipoInforme + &34 + " date=" + &34 + aAlfa + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "    <entity id=" + &34 + #2#2;  |QBF aAlfa;
     aAlfa = aAlfa + &34 + " uri=" + &34 + " " + &34 + "/>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0100000;
     aAlfa = "        <record id=" + &34 + "0100000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0101001" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>NIF</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01010" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + #2#3 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa1 = #2#3 % 101;
     |SI aAlfa1 = "A";
         aAlfa = "             <item id=" + &34 + "01011" + &34 + ">";
         |HAZ GrabaXML;

         |SI nXBRL = 0;
             aAlfa = "                  <value>X</value>";
         |SINO;
             aAlfa = "                  <value>01</value>";
         |FINSI;
         |HAZ GrabaXML;

         aAlfa = "            </item>";
         |HAZ GrabaXML;
     |FINSI;

     |SI aAlfa1 = "B";
         aAlfa = "             <item id=" + &34 + "01012" + &34 + ">";
         |HAZ GrabaXML;

         |SI nXBRL = 0;
             aAlfa = "                  <value>X</value>";
         |SINO;
             aAlfa = "                  <value>23</value>";
         |FINSI;
         |HAZ GrabaXML;

         aAlfa = "            </item>";
         |HAZ GrabaXML;
     |FINSI;

     |SI aAlfa1 ! "A";  |Y aAlfa1 ! "B";
         aAlfa = "             <item id=" + &34 + "01013" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                  <value>" + #319#5;  |QBF aAlfa;
         aAlfa = aAlfa + "</value>";
         |HAZ GrabaXML;

         aAlfa = "            </item>";
         |HAZ GrabaXML;
     |FINSI;

     aAlfa = "            <item id=" + &34 + "0102000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>DS</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01020" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + #2#2;  |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0102200" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>01</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01022" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa1 = #2#4 + " " + #2#5;  |QBF aAlfa1;
     |SI #2#6 ! "    ";
         aAlfa1 = aAlfa1 + ", Num:" + #2#6;  |QBF aAlfa1;
     |FINSI;
     |SI #2#7 ! "   ";
         aAlfa1 = aAlfa1 + " Esc:" + #2#7;  |QBF aAlfa1;
     |FINSI;
     |SI #2#8 ! "  ";
         aAlfa1 = aAlfa1 + " Piso:" + #2#8;  |QBF aAlfa1;
     |FINSI;
     |SI #2#9 ! "  ";
         aAlfa1 = aAlfa1 + " Pta:" + #2#9;  |QBF aAlfa1;
     |FINSI;

     aAlfa = "                  <value>" + aAlfa1 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01023" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + #2#13;  |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01025" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + #2#14;  |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01024" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + (("00" + #2#10) % -102);
     aAlfa = aAlfa + (("000" + #2#11) % -103) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0103001" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>TE</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01030" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                  <value>" + #2#15;  |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0103000;
     aAlfa1 = #100#17 + #100#18 + #100#19 + #100#20;  |QBF aAlfa1;
     |SI aAlfa1 = "";  |ACABA;  |FINSI;

     aAlfa = "        <record id=" + &34 + "0103000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa1 = #100#17 + #100#18;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = "            <record id=" + &34 + "0103100" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                <item id=" + &34 + "0104000" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                     <value>03</value>";
         |HAZ GrabaXML;

         aAlfa = "                </item>";
         |HAZ GrabaXML;

         aAlfa = "                <record id=" + &34 + "0103300" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "0104001" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>NIF</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "01040" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>" + #100#17;  |QBF aAlfa;
         aAlfa = aAlfa + "</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "0104100" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>DS</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "01041" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>" + #100#18;  |QBF aAlfa;
         aAlfa = aAlfa + "</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                </record>";
         |HAZ GrabaXML;

         aAlfa = "            </record>";
         |HAZ GrabaXML;
     |FINSI;

     aAlfa1 = #100#19 + #100#20;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa = "            <record id=" + &34 + "0103200" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                <item id=" + &34 + "0106000" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                     <value>04</value>";
         |HAZ GrabaXML;

         aAlfa = "                </item>";
         |HAZ GrabaXML;

         aAlfa = "                <record id=" + &34 + "0103300" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "0106001" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>NIF</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "01060" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>" + #100#19;  |QBF aAlfa;
         aAlfa = aAlfa + "</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "0106100" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>DS</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                    <item id=" + &34 + "01061" + &34 + ">";
         |HAZ GrabaXML;

         aAlfa = "                         <value>" + #100#20;  |QBF aAlfa;
         aAlfa = aAlfa + "</value>";
         |HAZ GrabaXML;

         aAlfa = "                    </item>";
         |HAZ GrabaXML;

         aAlfa = "                </record>";
         |HAZ GrabaXML;

         aAlfa = "            </record>";
         |HAZ GrabaXML;
     |FINSI;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0200000;
     |ABRE #135;
     #135#0 = #2#17;
     |LEE 000#135=;
     |SI FSalida ! 0;  |DDEFECTO #135;  |FINSI;
     |CIERRA #135;

     aAlfa = "        <record id=" + &34 + "0200000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "02009" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                <value>" + #135#1;  |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <record id=" + &34 + "02001" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                <item id=" + &34 + "Xcode_ACC.CNAE." + #2#17 + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                     <value>" + #2#17 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "                </item>";
     |HAZ GrabaXML;

     aAlfa = "            </record>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0400000_1;
     aAlfa = "        <record id=" + &34 + "0400000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04001" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#86 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04002" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#88 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04010" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#103 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04120" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#105 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04121" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#107 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04122" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#109 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04123" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#111 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0110000_1;
     aAlfa = "        <record id=" + &34 + "0110000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110010" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#31 % -104) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110020" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#31 % 402) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110030" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#31 % 102) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110040" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#32 % -104) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110050" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#32 % 402) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110060" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (#2#32 % 102) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01901" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#90 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "01903" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#91;  |QBF aAlfa;
     aAlfa = aAlfa + " " + #2#92;               |QBF aAlfa;
     aAlfa = aAlfa + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0900000;
     aAlfa = "        <record id=" + &34 + "0900000" + &34 + ">";
     |HAZ GrabaXML;

     |SI #2#93 = 1;
         aAlfa = "            <item id=" + &34 + "09001" + &34 + ">";
         |HAZ GrabaXML;

         |SI nXBRL = 0;
             aAlfa = "                  <value>X</value>";
         |SINO;
             aAlfa = "                  <value>01</value>";
         |FINSI;
         |HAZ GrabaXML;
     |SINO;
         aAlfa = "            <item id=" + &34 + "09002" + &34 + ">";
         |HAZ GrabaXML;

         |SI nXBRL = 0;
             aAlfa = "                  <value>X</value>";
         |SINO;
             aAlfa = "                  <value>02</value>";
         |FINSI;
         |HAZ GrabaXML;
     |FINSI;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado0_EsteAnyo;
     aAlfa = "    <module id=" + &34 + "apartado0" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     |HAZ Apartado_0100000;
     |HAZ Apartado_0103000;    || Falta desarrollar
     |HAZ Apartado_0200000;
     |HAZ Apartado_0400000_1;
     |HAZ Apartado_0110000_1;
     |HAZ Apartado_0900000;


     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0400000_2;
     aAlfa = "        <record id=" + &34 + "0400000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04001" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#87 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04002" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#89 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04010" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#104 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04120" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#106 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04121" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#108 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04122" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#110 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        <item id=" + &34 + "04123" + &34;
     aAlfa = aAlfa + " sign=" + &34 + "+" + &34 + " unit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + "0" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + #2#112 + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado_0110000_2;
     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "        <record id=" + &34 + "0110000" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110010" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % -104) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110020" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % 402) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110030" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % 102) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "            <item id=" + &34 + "0110040" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % -104) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110050" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % 402) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "            <item id=" + &34 + "0110060" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "               <value>" + (aAlfa1 % 102) + "</value>";
     |HAZ GrabaXML;

     aAlfa = "            </item>";
     |HAZ GrabaXML;

     aAlfa = "        </record>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO Apartado0_AnyoAnterior;
     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "apartado0" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "pure" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     |HAZ Apartado_0400000_2;
     |HAZ Apartado_0110000_2;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO DatosGenerales;
     aDecimals = "0";

     |HAZ Apartado0_EsteAnyo;
     |HAZ Apartado0_AnyoAnterior;
|FPRC;

|PROCESO cubal801;
     |SI #101#8  = "A";  |ACABA;  |FINSI;
     |SI #101#16 = 0;
         aAlfa = #101#3;  |QBF aAlfa;
         |SI aAlfa = "TOTAL ACTIVO";
             #101#16 = "10000";
         |FINSI;

         |SI aAlfa = "TOTAL PASIVO";
             #101#16 = "30000";
         |FINSI;
     |FINSI;

     |SI #101#16 = 0;   |ACABA;   |FINSI;

     |SI nEjer = #100#1;  nImporte = #101#7;  |FINSI;
     |SI nEjer ! #100#1;  nImporte = #101#6;  |FINSI;

     |SI #2#93 = 2;
         nImporte = nImporte * 1000;
     |FINSI;

                        aSigno = &34 + "+" + &34;
     |SI nImporte < 0;  aSigno = &34 + "-" + &34;  nImporte = nImporte * -1; |FINSI;

     aAlfa = "        <item id=" + &34 + #101#16 + &34;
     aAlfa = aAlfa + " sign=" + aSigno + " unit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + aDecimals + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <value>" + nImporte + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     nPaso = 1;
|FPRC;

|DEFBUCLE cubal801;
     #101#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal801;
|FIN;

|PROCESO BAL_EsteAnyo;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #101;
     #101#0 = #100#0;
     #101#1 = #100#1;
     #101#2 = 1;
     |LEE 000#101];
     |SI FSalida ! 0;  |O #101#0 ! #100#0;  |O #101#1 ! #100#1;
         |CIERRA #101;
         |ACABA;
     |FINSI;
     |CIERRA #101;

     aAlfa = "    <module id=" + &34 + "bal" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1;  |BUCLE cubal801;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO BAL_AnyoAnterior;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #101;
     #101#0 = #100#0;
     #101#1 = #100#1;
     #101#2 = 1;
     |LEE 000#101];
     |SI FSalida ! 0;  |O #101#0 ! #100#0;  |O #101#1 ! #100#1;
         |CIERRA #101;
         |ACABA;
     |FINSI;
     |CIERRA #101;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "bal" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1 - 1;  |BUCLE cubal801;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO cubal802;
     |SI #102#8  = "A";  |ACABA;  |FINSI;
     |SI #102#16 = 0;    |ACABA;  |FINSI;

     |SI nEjer = #100#1;  nImporte = #102#7;  |FINSI;
     |SI nEjer ! #100#1;  nImporte = #102#6;  |FINSI;

     |SI #2#93 = 2;
         nImporte = nImporte * 1000;
     |FINSI;

                        aSigno = &34 + "+" + &34;
     |SI nImporte < 0;  aSigno = &34 + "-" + &34;  nImporte = nImporte * -1; |FINSI;

     aAlfa = "        <item id=" + &34 + #102#16 + &34;
     aAlfa = aAlfa + " sign=" + aSigno + " unit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + aDecimals + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <value>" + nImporte + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     nPaso = 1;
|FPRC;

|DEFBUCLE cubal802;
     #102#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal802;
|FIN;

|PROCESO PYG_EsteAnyo;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #102;
     #102#0 = #100#0;
     #102#1 = #100#1;
     #102#2 = 1;
     |LEE 000#102];
     |SI FSalida ! 0;  |O #102#0 ! #100#0;  |O #102#1 ! #100#1;
         |CIERRA #102;
         |ACABA;
     |FINSI;
     |CIERRA #102;

     aAlfa = "    <module id=" + &34 + "pyg" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1;  |BUCLE cubal802;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO PYG_AnyoAnterior;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #102;
     #102#0 = #100#0;
     #102#1 = #100#1;
     #102#2 = 1;
     |LEE 000#102];
     |SI FSalida ! 0;  |O #102#0 ! #100#0;  |O #102#1 ! #100#1;
         |CIERRA #102;
         |ACABA;
     |FINSI;
     |CIERRA #102;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "pyg" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1 - 1;  |BUCLE cubal802;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO cubal803;
     |SI #103#8  = "A";  |ACABA;  |FINSI;
     |SI #103#16 = 0;    |ACABA;  |FINSI;

     |SI nEjer = #100#1;  nImporte = #103#7;  |FINSI;
     |SI nEjer ! #100#1;  nImporte = #103#6;  |FINSI;

     |SI #2#93 = 2;
         nImporte = nImporte * 1000;
     |FINSI;

                        aSigno = &34 + "+" + &34;
     |SI nImporte < 0;  aSigno = &34 + "-" + &34;  nImporte = nImporte * -1; |FINSI;

     aAlfa = "        <item id=" + &34 + #103#16 + &34;
     aAlfa = aAlfa + " sign=" + aSigno + " unit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + aDecimals + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <value>" + nImporte + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     nPaso = 1;
|FPRC;

|DEFBUCLE cubal803;
     #103#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal803;
|FIN;

|PROCESO PATNETA_EsteAnyo;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #103;
     #103#0 = #100#0;
     #103#1 = #100#1;
     #103#2 = 1;
     |LEE 000#103];
     |SI FSalida ! 0;  |O #103#0 ! #100#0;  |O #103#1 ! #100#1;
         |CIERRA #103;
         |ACABA;
     |FINSI;
     |CIERRA #103;

     aAlfa = "    <module id=" + &34 + "patnetA" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1;  |BUCLE cubal803;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO PATNETA_AnyoAnterior;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #103;
     #103#0 = #100#0;
     #103#1 = #100#1;
     #103#2 = 1;
     |LEE 000#103];
     |SI FSalida ! 0;  |O #103#0 ! #100#0;  |O #103#1 ! #100#1;
         |CIERRA #103;
         |ACABA;
     |FINSI;
     |CIERRA #103;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "patnetA" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1 - 1;  |BUCLE cubal803;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO cubal804;
     |SI #104nCampo = 0;  |ACABA;  |FINSI;

     |SI nPasada = 0;
         nHay = 1;

         |ERROR10;
         |ACABA;
     |FINSI;

     nImporte = #104nCampo;
     |SI #2#93 = 2;
         nImporte = nImporte * 1000;
     |FINSI;

                        aSigno = &34 + "+" + &34;
     |SI nImporte < 0;  aSigno = &34 + "-" + &34;  nImporte = nImporte * -1; |FINSI;

     aAlfa = "                <item id=" + &34 + #104#4 + &34;
     aAlfa = aAlfa + " sign=" + aSigno + " unit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + aDecimals + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "                    <value>" + nImporte + "</value>";
     |HAZ GrabaXML;

     aAlfa = "                </item>";
     |HAZ GrabaXML;

     nPaso = 1;
|FPRC;

|DEFBUCLE cubal804;
     #104#1;
     3;
     #100#0, #100#1, 001, aDTipo;
     #100#0, #100#1, 999, aHTipo;
     ;
     NULL, cubal804;
|FIN;

|PROCESO GrabaRow;
     nHay    = 0;
     nPasada = 0;
     |BUCLE cubal804;
     |SI nHay = 0;  |ACABA;  |FINSI;

     nRow = nCampo - 5;
     aAlfa = "            <row id=" + &34 + (("00" + nRow) % -102) + &34 + ">";
     |HAZ GrabaXML;

     nPasada = 1;
     |BUCLE cubal804;

     aAlfa = "            </row>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO PATNETB_EsteAnyo;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #104;
     #104#0 = #100#0;
     #104#1 = #100#1;
     #104#2 = 1;
     |LEE 000#104];
     |SI FSalida ! 0;  |O #104#0 ! #100#0;  |O #104#1 ! #100#1;
         |CIERRA #104;
         |ACABA;
     |FINSI;
     |CIERRA #104;

     aAlfa = "    <module id=" + &34 + "patnetB" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     aAlfa = "        <table id=" + &34 + "CambiosPatrimonioNetoDimension" + &34 + ">";
     |HAZ GrabaXML;

     nEjer  = #100#1;
     aDTipo = "C";
     aHTipo = "E";
     nCampo = 6;       |HAZ GrabaRow;
     nCampo = 7;       |HAZ GrabaRow;
     nCampo = 8;       |HAZ GrabaRow;
     nCampo = 9;       |HAZ GrabaRow;
     nCampo = 10;      |HAZ GrabaRow;
     nCampo = 11;      |HAZ GrabaRow;
     nCampo = 12;      |HAZ GrabaRow;
     nCampo = 13;      |HAZ GrabaRow;
     nCampo = 14;      |HAZ GrabaRow;
     nCampo = 15;      |HAZ GrabaRow;
     nCampo = 16;      |HAZ GrabaRow;
     nCampo = 17;      |HAZ GrabaRow;
     nCampo = 18;      |HAZ GrabaRow;

     aAlfa = "        </table>";
     |HAZ GrabaXML;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO PATNETB_AnyoAnterior;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #104;
     #104#0 = #100#0;
     #104#1 = #100#1;
     #104#2 = 1;
     |LEE 000#104];
     |SI FSalida ! 0;  |O #104#0 ! #100#0;  |O #104#1 ! #100#1;
         |CIERRA #104;
         |ACABA;
     |FINSI;
     |CIERRA #104;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "patnetB" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     aAlfa = "        <table id=" + &34 + "CambiosPatrimonioNetoDimension" + &34 + ">";
     |HAZ GrabaXML;

     nEjer  = #100#1 - 1;
     aDTipo = "A";
     aHTipo = "B";
     nCampo = 6;       |HAZ GrabaRow;
     nCampo = 7;       |HAZ GrabaRow;
     nCampo = 8;       |HAZ GrabaRow;
     nCampo = 9;       |HAZ GrabaRow;
     nCampo = 10;      |HAZ GrabaRow;
     nCampo = 11;      |HAZ GrabaRow;
     nCampo = 12;      |HAZ GrabaRow;
     nCampo = 13;      |HAZ GrabaRow;
     nCampo = 14;      |HAZ GrabaRow;
     nCampo = 15;      |HAZ GrabaRow;
     nCampo = 16;      |HAZ GrabaRow;
     nCampo = 17;      |HAZ GrabaRow;
     nCampo = 18;      |HAZ GrabaRow;

     aAlfa = "        </table>";
     |HAZ GrabaXML;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO cubal805;
     |SI #105#8  = "A";  |ACABA;  |FINSI;
     |SI #105#16 = 0;    |ACABA;  |FINSI;

     |SI nEjer = #100#1;  nImporte = #105#7;  |FINSI;
     |SI nEjer ! #100#1;  nImporte = #105#6;  |FINSI;

     |SI #2#93 = 2;
         nImporte = nImporte * 1000;
     |FINSI;

                        aSigno = &34 + "+" + &34;
     |SI nImporte < 0;  aSigno = &34 + "-" + &34;  nImporte = nImporte * -1; |FINSI;

     aAlfa = "        <item id=" + &34 + #105#16 + &34;
     aAlfa = aAlfa + " sign=" + aSigno + " unit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " decimals=" + &34 + aDecimals + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "            <value>" + nImporte + "</value>";
     |HAZ GrabaXML;

     aAlfa = "        </item>";
     |HAZ GrabaXML;

     nPaso = 1;
|FPRC;

|DEFBUCLE cubal805;
     #105#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal805;
|FIN;

|PROCESO FLUJEFEC_EsteAnyo;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #105;
     #105#0 = #100#0;
     #105#1 = #100#1;
     #105#2 = 1;
     |LEE 000#105];
     |SI FSalida ! 0;  |O #105#0 ! #100#0;  |O #105#1 ! #100#1;
         |CIERRA #105;
         |ACABA;
     |FINSI;
     |CIERRA #105;

     aAlfa = "    <module id=" + &34 + "flujefec" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (#2#31 % -104) + "-" + (#2#31 % 402) + "-" + (#2#31 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (#2#32 % -104) + "-" + (#2#32 % 402) + "-" + (#2#32 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1;  |BUCLE cubal805;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO FLUJEFEC_AnyoAnterior;
     |SI #2#93 = 1;
         aDecimals = "2";
     |SINO;
         aDecimals = "-3";
     |FINSI;

     |ABRE #105;
     #105#0 = #100#0;
     #105#1 = #100#1;
     #105#2 = 1;
     |LEE 000#105];
     |SI FSalida ! 0;  |O #105#0 ! #100#0;  |O #105#1 ! #100#1;
         |CIERRA #105;
         |ACABA;
     |FINSI;
     |CIERRA #105;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aAlfa = "    <module id=" + &34 + "flujefec" + &34 + " reportingDateStart=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     |HAZ GrabaXML;

     aAlfa1 = (#2#32 % 106) + nEjer;

     aAlfa = "        reportingDateEnd=" + &34;
     aAlfa = aAlfa + (aAlfa1 % -104) + "-" + (aAlfa1 % 402) + "-" + (aAlfa1 % 102) + &34;
     aAlfa = aAlfa + " baseUnit=" + &34 + "euro" + &34;
     aAlfa = aAlfa + " baseDecimals=" + &34 + aDecimals + &34 + ">";

     |HAZ GrabaXML;

     nEjer = #100#1 - 1;  |BUCLE cubal805;

     aAlfa = "    </module>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO CierraFicheroXml;
     aAlfa = "</report>";
     |HAZ GrabaXML;

     |XCIERRA nHandleXML;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aXMLServidor, aXMLLocal;
     |SINO;
         |COPIA_FICHERO aXMLServidor, aXMLLocal;
     |FINSI;

     |FBORRA aXMLServidor;
|FPRC;

|PROCESO Imprime;
     aBATLocal = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".BAT";

     |XABRE "BWC", aBATLocal, nHandleBAT;

     aAlfa = "CD " + aDirAPILocal;
     |HAZ GrabaBAT;

     aAlfa = "PGCCommandSelector.bat -xmltohtml -i ";
     aAlfa = aAlfa + &34 + aXMLLocal + &34;
     aAlfa = aAlfa + " -e " + &34 + aRaiz + "err.xml" + &34;
     aAlfa = aAlfa + " -o " + &34 + aRaiz + aTipoF + ".html" + &34;
     aAlfa = aAlfa + " -m " + &34 + aTipoI + &34;

     |HAZ GrabaBAT;
     |XCIERRA nHandleBAT;

     |RSYSTEM aBATLocal;
     |RFBORRA aBATLocal;

     aBATLocal = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".BAT";
     |XABRE "BWC", aBATLocal, nHandleBAT;

     aAlfa = "CD " + aDirXBRLLocal;
     |HAZ GrabaBAT;

     aAlfa = aRaiz + aTipoF + ".html";
     |HAZ GrabaBAT;
     |XCIERRA nHandleBAT;

     |RSYSTEM aBATLocal;
     |RFBORRA aBATLocal;
|FPRC;

|PROCESO ConvertirXBRL;
     aBATLocal = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".BAT";

     |XABRE "BWC", aBATLocal, nHandleBAT;

     aAlfa = "CD " + aDirAPILocal;
     |HAZ GrabaBAT;

     aAlfa = "PGCCommandSelector.bat -xmltoxbrl -i ";
     aAlfa = aAlfa + &34 + aXMLLocal + &34;
     aAlfa = aAlfa + " -e " + &34 + aRaiz + "err.xml" + &34;
     aAlfa = aAlfa + " -v " + &34 + aRaiz + "val.xml" + &34;
     aAlfa = aAlfa + " -o " + &34 + aRaiz + ".xbrl" + &34 + " -l";

     |HAZ GrabaBAT;
     |XCIERRA nHandleBAT;

     |RSYSTEM aBATLocal;
     |RFBORRA aBATLocal;
|FPRC;

|PROCESO Presentacion;
     nPaso = 0;
     nXBRL = 0;

     |HAZ AbreFicheroXml;
     |HAZ DatosGenerales;
     |HAZ BAL_EsteAnyo;
     |HAZ BAL_AnyoAnterior;
     |HAZ PYG_EsteAnyo;
     |HAZ PYG_AnyoAnterior;
     |HAZ PATNETA_EsteAnyo;
     |HAZ PATNETA_AnyoAnterior;
     |HAZ PATNETB_EsteAnyo;
     |HAZ PATNETB_AnyoAnterior;
     |HAZ FLUJEFEC_EsteAnyo;
     |HAZ FLUJEFEC_AnyoAnterior;
     |HAZ CierraFicheroXml;

     |SI nPaso = 0;
         |RFBORRA aXMLLocal;
         |MENAV "0000 Seleccion vacia";
         |ACABA;
     |FINSI;

     |SI #0#4 = "S";  aTipoI = "apartado0";  aTipoF = "por";      |HAZ Imprime;  |FINSI;
     |SI #0#5 = "S";  aTipoI = "bal";        aTipoF = "bal";      |HAZ Imprime;  |FINSI;
     |SI #0#6 = "S";  aTipoI = "pyg";        aTipoF = "pyg";      |HAZ Imprime;  |FINSI;
     |SI #0#7 = "S";  aTipoI = "patnetA";    aTipoF = "patnetA";  |HAZ Imprime;  |FINSI;
     |SI #0#8 = "S";  aTipoI = "patnetB";    aTipoF = "patnetB";  |HAZ Imprime;  |FINSI;
     |SI #0#9 = "S";  aTipoI = "flujefec";   aTipoF = "flujefec"; |HAZ Imprime;  |FINSI;
|FPRC;

|PROCESO FicheroXBRL;
     nXBRL = 1;

     |HAZ AbreFicheroXml;
     |HAZ DatosGenerales;
     |HAZ BAL_EsteAnyo;
     |HAZ BAL_AnyoAnterior;
     |HAZ PYG_EsteAnyo;
     |HAZ PYG_AnyoAnterior;
     |HAZ PATNETA_EsteAnyo;
     |HAZ PATNETA_AnyoAnterior;
     |HAZ PATNETB_EsteAnyo;
     |HAZ PATNETB_AnyoAnterior;
     |HAZ FLUJEFEC_EsteAnyo;
     |HAZ FLUJEFEC_AnyoAnterior;
     |HAZ CierraFicheroXml;
     |HAZ ConvertirXBRL;
|FPRC;

|PROCESO AbreXMLD2;
     |XABRE "BW", aXMLServidor, nHandleXML;

     aAlfa = "ï»¿<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "utf-8" + &34 + "?>";
     |HAZ GrabaXML;

     aAlfa = "<Esquema xmlns:xsi=" + &34 + "http://www.w3.org/2001/XMLSchema-instance" + &34 + ">";
     |HAZ GrabaXML;

     aAlfa = "  <Cabecera>";
     |HAZ GrabaXML;

     aAlfa = "    <CIF>" + #2#3;  |QBF aAlfa;
     aAlfa = aAlfa + "</CIF>";
     |HAZ GrabaXML;

     aAlfa = "    <RazonSocial>" + #2#2;  |QBF aAlfa;
     aAlfa = aAlfa + "</RazonSocial>";
     |HAZ GrabaXML;

     aAlfa = "    <Descripcion>" + #2#2;  |QBF aAlfa;
     aAlfa = aAlfa + "</Descripcion>";
     |HAZ GrabaXML;

     aAlfa = "    <TipoCuestionario>" + aTipoD2 + "</TipoCuestionario>";
     |HAZ GrabaXML;

     aAlfa = "    <IdiomaCuestionario>Castellano</IdiomaCuestionario>";
     |HAZ GrabaXML;

     aAlfa = "    <MemoriaNormalizada>False</MemoriaNormalizada>";
     |HAZ GrabaXML;

     aAlfa = "    <Ejercicio>" + #0#2 + "</Ejercicio>";
     |HAZ GrabaXML;

     aAlfa = "  </Cabecera>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO MontaClave;
     |QBF aValor;
     aAlfa  = aValor;  |HAZ QuitaRarosXBRL;
     aValor = aAlfa;

     aAlfa = "    <Clave>";
     |HAZ GrabaXML;

     aAlfa = "      <Codigo>" + aCodigo + "</Codigo>";
     |HAZ GrabaXML;

     aAlfa = "      <Valor>" + aValor + "</Valor>";
     |HAZ GrabaXML;

     aAlfa = "    </Clave>";
     |HAZ GrabaXML;
|FPRC;

|PROCESO PortadaD2;
     aMail = "";
     |SI eaPathIntegral  ! "";
         |ABRE #dsam0000;
         #dsam0000#0 = #maempr10#0;
         |LEE 000#dsam0000.=;
         |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
         |CIERRA #dsam0000;

         aMail = #dsam0000#71;
     |FINSI;

     aAlfa = "  <Claves>";
     |HAZ GrabaXML;

     aCodigo = "1010";  aValor = #2#3;  |HAZ MontaClave;

     aAlfa1 = #2#3 % 101;
     |SI aAlfa1 = "A";
         aCodigo = "1011";  aValor = "1";     |HAZ MontaClave;
     |FINSI;

     |SI aAlfa1 = "B";
         aCodigo = "1012";  aValor = "1";     |HAZ MontaClave;
     |FINSI;

     |SI aAlfa1 ! "A";  |Y aAlfa1 ! "B";
         aCodigo = "1013";  aValor = #319#5;     |HAZ MontaClave;
     |FINSI;

     aCodigo = "1020";  aValor = #2#2;  |HAZ MontaClave;
     aCodigo = "1022";
     aValor = #2#4 + " " + #2#5;  |QBF aValor;
     |SI #2#6 ! "    ";
         aValor = aValor + ", Num:" + #2#6;  |QBF aValor;
     |FINSI;
     |SI #2#7 ! "   ";
         aValor = aValor + " Esc:" + #2#7;  |QBF aValor;
     |FINSI;
     |SI #2#8 ! "  ";
         aValor = aValor + " Piso:" + #2#8;  |QBF aValor;
     |FINSI;
     |SI #2#9 ! "  ";
         aValor = aValor + " Pta:" + #2#9;  |QBF aValor;
     |FINSI;
     aValor = aValor;
     |HAZ MontaClave;

     aCodigo = "1023";  aValor = #2#13;  |HAZ MontaClave;
     aCodigo = "1025";  aValor = (("00" + #2#10) % -102);  |HAZ MontaClave;
     aCodigo = "1024";  aValor = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);  |HAZ MontaClave;
     aCodigo = "1031";  aValor = #2#15;  |HAZ MontaClave;
     aCodigo = "1037";  aValor = aMail;  |HAZ MontaClave;
     aCodigo = "1009";  aValor = #2#114; |HAZ MontaClave;

     |ABRE #135;
     #135#0 = #2#17;
     |LEE 000#135=;
     |SI FSalida ! 0;  |DDEFECTO #135;  |FINSI;
     |CIERRA #135;

     aCodigo = "1041";   aValor = #100#18;        |HAZ MontaClave;
     aCodigo = "1040";   aValor = #100#17;        |HAZ MontaClave;
     aCodigo = "1061";   aValor = #100#20;        |HAZ MontaClave;
     aCodigo = "1060";   aValor = #100#19;        |HAZ MontaClave;
     aCodigo = "2001";   aValor = #2#17;          |HAZ MontaClave;
     aCodigo = "2009";   aValor = #135#1;         |HAZ MontaClave;
     aCodigo = "4001";   aValor = #2#86;          |HAZ MontaClave;
     aCodigo = "4002";   aValor = #2#88;          |HAZ MontaClave;
     aCodigo = "40019";  aValor = #2#87;          |HAZ MontaClave;
     aCodigo = "40029";  aValor = #2#89;          |HAZ MontaClave;
     aCodigo = "4010";   aValor = #2#103;         |HAZ MontaClave;
     aCodigo = "40109";  aValor = #2#104;         |HAZ MontaClave;
     aCodigo = "4120";   aValor = #2#105;         |HAZ MontaClave;
     aCodigo = "41209";  aValor = #2#106;         |HAZ MontaClave;
     aCodigo = "4121";   aValor = #2#107;         |HAZ MontaClave;
     aCodigo = "41219";  aValor = #2#108;         |HAZ MontaClave;
     aCodigo = "4122";   aValor = #2#109;         |HAZ MontaClave;
     aCodigo = "41229";  aValor = #2#110;         |HAZ MontaClave;
     aCodigo = "4123";   aValor = #2#111;         |HAZ MontaClave;
     aCodigo = "41239";  aValor = #2#112;         |HAZ MontaClave;

     aCodigo = "1102";   aValor = #2#31;          |HAZ MontaClave;
     aCodigo = "11021";  aValor = #2#31 % -104;   |HAZ MontaClave;
     aCodigo = "11022";  aValor = #2#31 % 402;    |HAZ MontaClave;
     aCodigo = "11023";  aValor = #2#31 % 102;    |HAZ MontaClave;

     aCodigo = "1101";   aValor = #2#32;          |HAZ MontaClave;
     aCodigo = "11011";  aValor = #2#32 % -104;   |HAZ MontaClave;
     aCodigo = "11012";  aValor = #2#32 % 402;    |HAZ MontaClave;
     aCodigo = "11013";  aValor = #2#32 % 102;    |HAZ MontaClave;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#31 % 106) + nEjer;

     aCodigo = "11029";   aValor = aAlfa1;          |HAZ MontaClave;
     aCodigo = "110219";  aValor = aAlfa1 % -104;   |HAZ MontaClave;
     aCodigo = "110229";  aValor = aAlfa1 % 402;    |HAZ MontaClave;
     aCodigo = "110239";  aValor = aAlfa1 % 102;    |HAZ MontaClave;

     nEjer  = #100#1 - 1;
     aAlfa1 = (#2#32 % 106) + nEjer;

     aCodigo = "11019";   aValor = aAlfa1;          |HAZ MontaClave;
     aCodigo = "110119";  aValor = aAlfa1 % -104;   |HAZ MontaClave;
     aCodigo = "110129";  aValor = aAlfa1 % 402;    |HAZ MontaClave;
     aCodigo = "110139";  aValor = aAlfa1 % 102;    |HAZ MontaClave;

     aCodigo = "1901";    aValor = #2#90;           |HAZ MontaClave;
     aCodigo = "1902";    aValor = 0;               |HAZ MontaClave;
     aCodigo = "1903";    aValor = #2#91;           |QBF aValor;
     aValor  = aValor + #2#92;                      |HAZ MontaClave;

     |SI #2#93 = 1;
         aCodigo = "9001";    aValor = "1";         |HAZ MontaClave;
     |SINO;
         aCodigo = "9002";    aValor = "2";         |HAZ MontaClave;
     |FINSI;
|FPRC;

|PROCESO cubal801_D2;
     |SI #101#8  = "A";  |ACABA;  |FINSI;
     |SI #101#16 = 0;
         aAlfa = #101#3;  |QBF aAlfa;
         |SI aAlfa = "TOTAL ACTIVO";
             #101#16 = "10000";
         |FINSI;

         |SI aAlfa = "TOTAL PASIVO";
             #101#16 = "30000";
         |FINSI;
     |FINSI;

     |SI #101#16 = 0;   |ACABA;   |FINSI;

     |SI #101#7 ! 0;
         aCodigo = #101#16;   aValor = #101#7;   |HAZ MontaClave;
     |FINSI;

     |SI #101#6 ! 0;
         aAlfa   = #101#16;
         aCodigo = aAlfa + "9";   aValor = #101#6;   |HAZ MontaClave;
     |FINSI;

     aAlfa1 = #101#5;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa   = #101#16;
         aCodigo = aAlfa + "98";   aValor = aAlfa1;   |HAZ MontaClave;
     |FINSI;
|FPRC;

|DEFBUCLE cubal801_D2;
     #101#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal801_D2;
|FIN;

|PROCESO cubal802_D2;
     |SI #102#8  = "A";  |ACABA;  |FINSI;
     |SI #102#16 = 0;    |ACABA;  |FINSI;

     |SI #102#7 ! 0;
         aCodigo = #102#16;   aValor = #102#7;   |HAZ MontaClave;
     |FINSI;

     |SI #102#6 ! 0;
         aAlfa   = #102#16;
         aCodigo = aAlfa + "9";   aValor = #102#6;   |HAZ MontaClave;
     |FINSI;

     aAlfa1 = #102#5;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa   = #102#16;
         aCodigo = aAlfa + "98";   aValor = aAlfa1;   |HAZ MontaClave;
     |FINSI;
|FPRC;

|DEFBUCLE cubal802_D2;
     #102#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal802_D2;
|FIN;

|PROCESO cubal803_D2;
     |SI #103#8  = "A";  |ACABA;  |FINSI;
     |SI #103#16 = 0;    |ACABA;  |FINSI;

     |SI #103#7 ! 0;
         aCodigo = #103#16;   aValor = #103#7;   |HAZ MontaClave;
     |FINSI;

     |SI #103#6 ! 0;
         aAlfa   = #103#16;
         aCodigo = aAlfa + "9";   aValor = #103#6;   |HAZ MontaClave;
     |FINSI;

     aAlfa1 = #103#5;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa   = #103#16;
         aCodigo = aAlfa + "98";   aValor = aAlfa1;   |HAZ MontaClave;
     |FINSI;
|FPRC;

|DEFBUCLE cubal803_D2;
     #103#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal803_D2;
|FIN;

|PROCESO cubal804_D2;
     |PARA nCampo = 6;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           |SI #104nCampo ! 0;
               nColumna = nCampo - 5;
               aValor   = #104nCampo;
               aAlfa    = #104#4;
               aCodigo  = aAlfa + (("00" + nColumna) % -102);
               |SI #104#3 = "A";  |O #104#3 = "B";
                   aCodigo = aCodigo + "9";
               |FINSI;

               |HAZ MontaClave;
           |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE cubal804_D2;
     #104#1;
     ;
     #100#0, #100#1, 001;
     #100#0, #100#1, 999;
     ;
     NULL, cubal804_D2;
|FIN;

|PROCESO cubal805_D2;
     |SI #105#8  = "A";  |ACABA;  |FINSI;
     |SI #105#16 = 0;    |ACABA;  |FINSI;

     |SI #105#7 ! 0;
         aCodigo = #105#16;   aValor = #105#7;   |HAZ MontaClave;
     |FINSI;

     |SI #105#6 ! 0;
         aAlfa   = #105#16;
         aCodigo = aAlfa + "9";   aValor = #105#6;   |HAZ MontaClave;
     |FINSI;

     aAlfa1 = #105#5;  |QBF aAlfa1;
     |SI aAlfa1 ! "";
         aAlfa   = #105#16;
         aCodigo = aAlfa + "98";   aValor = aAlfa1;   |HAZ MontaClave;
     |FINSI;
|FPRC;

|DEFBUCLE cubal805_D2;
     #105#1;
     ;
     #100#0, #100#1, 0001;
     #100#0, #100#1, 9999;
     ;
     NULL, cubal805_D2;
|FIN;


|PROCESO NueDistribucion;
     |ABRE #zregdocu;
     #zregdocu#0 = #0#1;
     #zregdocu#1 = #0#2;
     |LEE 000#zregdocu.=;
     |SI FSalida ! 0;  |DDEFECTO #zregdocu;  |FINSI;

     aCodigo = "91000";   aValor = #zregdocu#16;   |HAZ MontaClave;
     aCodigo = "91001";   aValor = #zregdocu#17;   |HAZ MontaClave;
     aCodigo = "91002";   aValor = #zregdocu#18;   |HAZ MontaClave;
     aCodigo = "91003";   aValor = #zregdocu#19;   |HAZ MontaClave;
     aCodigo = "91004";   aValor = #zregdocu#20;   |HAZ MontaClave;

     nSuma = #zregdocu#22 + #zregdocu#27 + #zregdocu#28;
     aCodigo = "91005";   aValor = #zregdocu#21;   |HAZ MontaClave;
     aCodigo = "91007";   aValor = #zregdocu#23;   |HAZ MontaClave;
     aCodigo = "91008";   aValor = #zregdocu#24;   |HAZ MontaClave;
     aCodigo = "91009";   aValor = #zregdocu#25;   |HAZ MontaClave;
     aCodigo = "91010";   aValor = nSuma;          |HAZ MontaClave;
     aCodigo = "91011";   aValor = #zregdocu#26;   |HAZ MontaClave;
     aCodigo = "91012";   aValor = #zregdocu#29;   |HAZ MontaClave;

     #zregdocu#0 = #0#1;
     #zregdocu#1 = #0#2 - 1;
     |LEE 000#zregdocu.=;
     |SI FSalida ! 0;  |DDEFECTO #zregdocu;  |FINSI;

     aCodigo = "910009";  aValor = #zregdocu#16;   |HAZ MontaClave;
     aCodigo = "910019";  aValor = #zregdocu#17;   |HAZ MontaClave;
     aCodigo = "910029";  aValor = #zregdocu#18;   |HAZ MontaClave;
     aCodigo = "910039";  aValor = #zregdocu#19;   |HAZ MontaClave;
     aCodigo = "910049";  aValor = #zregdocu#20;   |HAZ MontaClave;

     nSuma = #zregdocu#22 + #zregdocu#27 + #zregdocu#28;
     aCodigo = "910059";  aValor = #zregdocu#21;   |HAZ MontaClave;
     aCodigo = "910079";  aValor = #zregdocu#23;   |HAZ MontaClave;
     aCodigo = "910089";  aValor = #zregdocu#24;   |HAZ MontaClave;
     aCodigo = "910099";  aValor = #zregdocu#25;   |HAZ MontaClave;
     aCodigo = "910109";  aValor = nSuma;          |HAZ MontaClave;
     aCodigo = "910119";  aValor = #zregdocu#26;   |HAZ MontaClave;
     aCodigo = "910129";  aValor = #zregdocu#29;   |HAZ MontaClave;

     |CIERRA #zregdocu;

     |ABRE #zregcu29;
     #zregcu29#0 = #0#1;
     #zregcu29#1 = #0#2;
     |LEE 000#zregcu29.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu29;  |FINSI;
     |CIERRA #zregcu29;

     aCodigo = "94705";   aValor = #zregcu29#2;   |HAZ MontaClave;
     aCodigo = "947059";  aValor = #zregcu29#3;   |HAZ MontaClave;
|FPRC;

|PROCESO MedioAmbiente;
     |ABRE #106;
     #106#0 = #0#1;
     #106#1 = #0#2;
     |LEE 000#106=;
     |SI FSalida ! 0;  |DDEFECTO #106;  |FINSI;
     |CIERRA #106;

     aQueQuiero = "|NC";
     aAlfa      = #106#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;
     nAmbiente  = 0;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           |SI #106nCampo ! 0;
               nAmbiente = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nAmbiente = 0;
         aCodigo = "8099000";   aValor = "1";   |HAZ MontaClave;
     |SINO;
         aCodigo = "8099010";   aValor = "1";   |HAZ MontaClave;
     |FINSI;
|FPRC;

|PROCESO maempr24;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8210" + aAlfa1;   aValor = #maempr24#11;  |HAZ MontaClave;
     aCodigo = "8211" + aAlfa1;   aValor = #maempr24#3;   |HAZ MontaClave;
     aCodigo = "8212" + aAlfa1;   aValor = #maempr24#6;   |HAZ MontaClave;
     aCodigo = "8213" + aAlfa1;   aValor = #maempr24#5;   |HAZ MontaClave;
     aCodigo = "8214" + aAlfa1;   aValor = #maempr24#8;   |HAZ MontaClave;
     aCodigo = "8215" + aAlfa1;   aValor = #maempr24#7;   |HAZ MontaClave;
     aCodigo = "8216" + aAlfa1;   aValor = #maempr24#10;  |HAZ MontaClave;

     nConta = nConta + 1;
     |SI #0#11 = "P";
         |SI nConta = 24; |ERROR10; |FINSI;
     |SINO;
         |SI nConta = 60; |ERROR10; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE maempr24;
     #maempr24#1;
     ;
     #0#1, #0#2, 01;
     #0#1, #0#2, 99;
     ;
     NULL, maempr24;
|FIN;

|PROCESO maempr23;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8210" + aAlfa1;   aValor = #maempr23#5;   |HAZ MontaClave;
     aCodigo = "8211" + aAlfa1;   aValor = #maempr23#3;   |HAZ MontaClave;
     |SI #maempr23#10 > "01.01.0000";
         aCodigo = "8212" + aAlfa1;   aValor = #maempr23#10;  |HAZ MontaClave;
     |FINSI;

     aCodigo = "8213" + aAlfa1;   aValor = #maempr23#6;   |HAZ MontaClave;
     aCodigo = "8214" + aAlfa1;   aValor = #maempr23#8;   |HAZ MontaClave;

     nConta = nConta + 1;
     |SI #0#11 = "P";
         |SI nConta = 9;  |ERROR10; |FINSI;
     |SINO;
         |SI nConta = 20; |ERROR10; |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE maempr23;
     #maempr23#1;
     ;
     #0#1, #0#2, 01;
     #0#1, #0#2, 99;
     ;
     NULL, maempr23;
|FIN;

|PROCESO maempr22;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8210" + aAlfa1;   aValor = #maempr22#5;   |HAZ MontaClave;
     aCodigo = "8211" + aAlfa1;   aValor = #maempr22#3;   |HAZ MontaClave;
     |SI #maempr22#10 > "01.01.0000";
         aCodigo = "8212" + aAlfa1;   aValor = #maempr22#10;  |HAZ MontaClave;
     |FINSI;

     aCodigo = "8213" + aAlfa1;   aValor = #maempr22#6;   |HAZ MontaClave;
     aCodigo = "8214" + aAlfa1;   aValor = #maempr22#8;   |HAZ MontaClave;

     |SI #maempr22#11 ! 0;
         aCodigo = "8215" + aAlfa1;   aValor = #maempr22#11;   |HAZ MontaClave;
     |SINO;
         |SI #maempr22#12 ! 0;
             aCodigo = "8216" + aAlfa1;   aValor = #maempr22#12;   |HAZ MontaClave;
         |FINSI;
     |FINSI;

     nConta = nConta + 1;
     |SI nConta = 5; |ERROR10; |FINSI;
|FPRC;

|DEFBUCLE maempr22;
     #maempr22#1;
     ;
     #0#1, #0#2, 001;
     #0#1, #0#2, 999;
     ;
     NULL, maempr22;
|FIN;

|PROCESO TitularReal;
    nSw22 = 0;
    nSw23 = 0;
    |ABRE #maempr22;
    #maempr22#0 = #0#1;
    #maempr22#1 = #0#2;
    #maempr22#2 = 001;
    |LEE 041#maempr22.];
    |SI FSalida = 0; |Y #maempr22#0 = #0#1; |Y #maempr22#1 = #0#2;
        nSw22 = 1;
    |FINSI;
    |CIERRA #maempr22;

    |SI nSw22 = 0;
        |ABRE #maempr23;
        #maempr23#0 = #0#1;
        #maempr23#1 = #0#2;
        #maempr23#2 = 01;
        |LEE 041#maempr23.];
        |SI FSalida = 0; |Y #maempr23#0 = #0#1; |Y #maempr23#1 = #0#2;
            nSw23 = 1;
        |FINSI;
        |CIERRA #maempr23;
     |FINSI;

     aCodigo = "8080829";   aValor = "1";   |HAZ MontaClave;
     aCodigo = "8080828";   || 700000 10508
     aValor  = "2";
     |SI #maempr10#115 = "S"; aValor = "1"; |FINSI;
     |HAZ MontaClave;

     |SI #maempr10#115 = "S";
         |SI nSw22 ! 0;  nConta = 0;  |BUCLE maempr22;  |FINSI;
         |SI nSw23 ! 0;  nConta = 5;  |BUCLE maempr23;  |FINSI;
         nConta = 20;  |BUCLE maempr24;
     |FINSI;
|FPRC;

|PROCESO PrestaServicios;
    |ABRE #maempr25;
    |DDEFECTO #maempr25;
    #maempr25#0 = #0#1;
    #maempr25#1 = #0#2;
    |LEE 041#maempr25.=;
    |CIERRA #maempr25;

    aValor = "0"; |SI #maempr25#2 = "S"; aValor = "1"; |FINSI;
    aCodigo = "8080831";   |HAZ MontaClave;

    |SI #maempr25#2 = "S";
        aCodigo = "831001";  aValor  = #maempr25#3; |HAZ MontaClave;
        aCodigo = "831002";  aValor  = #maempr25#7; |HAZ MontaClave;
        aCodigo = "831003";  aValor  = #maempr25#6; |HAZ MontaClave;
        aCodigo = "831005";  aValor  = #maempr25#5; |HAZ MontaClave;

        aValor = "2"; |SI #maempr25#8 = "S"; aValor = "1"; |FINSI;
        aCodigo = "831004"; |HAZ MontaClave;

        aValor = "2"; |SI #maempr25#9 = "S"; aValor = "1"; |FINSI;
        aCodigo = "831006"; |HAZ MontaClave;

        |SI #maempr25#9 = "N";
            aValor = "0"; |SI #maempr25#10 = "X"; aValor = "1"; |FINSI;
            aCodigo = "831071"; |HAZ MontaClave;
            |SI #maempr25#10 ! "X";
                aCodigo = "831070";  aValor  = #maempr25#11; |HAZ MontaClave;
                aCodigo = "8310709"; aValor  = #maempr25#12; |HAZ MontaClave;
            |FINSI;
            aCodigo = "831011"; aValor  = #maempr25#13; |HAZ MontaClave;
            aCodigo = "831021"; aValor  = #maempr25#14; |HAZ MontaClave;
            aCodigo = "831031"; aValor  = #maempr25#15; |HAZ MontaClave;
            aCodigo = "831041"; aValor  = #maempr25#16; |HAZ MontaClave;
            aCodigo = "831051"; aValor  = #maempr25#17; |HAZ MontaClave;
            aCodigo = "831061"; aValor  = #maempr25#18; |HAZ MontaClave;
        |FINSI;
    |FINSI;
|FPRC;

|PROCESO agim0039;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8001" + aAlfa1;   aValor = #339#3;   |HAZ MontaClave;
     aCodigo = "8002" + aAlfa1;   aValor = #339#4;   |HAZ MontaClave;
     aCodigo = "8003" + aAlfa1;   aValor = #339#5;   |HAZ MontaClave;
     aCodigo = "8004" + aAlfa1;   aValor = #339#6;   |HAZ MontaClave;
     aCodigo = "8005" + aAlfa1;   aValor = #339#7;   |HAZ MontaClave;
     aCodigo = "8006" + aAlfa1;   aValor = #339#8;   |HAZ MontaClave;
     aCodigo = "8007" + aAlfa1;   aValor = #339#9;   |HAZ MontaClave;
     aCodigo = "8008" + aAlfa1;   aValor = #339#10;  |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0039;
     #339#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0039;
|FIN;

|PROCESO agim0040;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8021" + aAlfa1;   aValor = #340#3;   |HAZ MontaClave;
     aCodigo = "8022" + aAlfa1;   aValor = #340#4;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0040;
     #340#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0040;
|FIN;

|PROCESO agim0041;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8031" + aAlfa1;   aValor = #341#3;   |HAZ MontaClave;
     aCodigo = "8032" + aAlfa1;   aValor = #341#4;   |HAZ MontaClave;
     aCodigo = "8033" + aAlfa1;   aValor = #341#5;   |HAZ MontaClave;
     aCodigo = "8034" + aAlfa1;   aValor = #341#6;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0041;
     #341#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0041;
|FIN;

|PROCESO agim0042;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8041" + aAlfa1;   aValor = #342#3;   |HAZ MontaClave;
     aCodigo = "8042" + aAlfa1;   aValor = #342#4;   |HAZ MontaClave;
     aCodigo = "8043" + aAlfa1;   aValor = #342#5;   |HAZ MontaClave;
     aCodigo = "8044" + aAlfa1;   aValor = #342#6;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0042;
     #342#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0042;
|FIN;

|PROCESO agim0043;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8051" + aAlfa1;   aValor = #343#3;   |HAZ MontaClave;
     aCodigo = "8052" + aAlfa1;   aValor = #343#4;   |HAZ MontaClave;
     aCodigo = "8053" + aAlfa1;   aValor = #343#5;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0043;
     #343#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0043;
|FIN;

|PROCESO agim0044;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8061" + aAlfa1;   aValor = #344#3;   |HAZ MontaClave;
     aCodigo = "8062" + aAlfa1;   aValor = #344#4;   |HAZ MontaClave;
     aCodigo = "8063" + aAlfa1;   aValor = #344#5;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0044;
     #344#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0044;
|FIN;

|PROCESO agim0045;
     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8071" + aAlfa1;   aValor = #345#3;   |HAZ MontaClave;
     aCodigo = "8072" + aAlfa1;   aValor = #345#4;   |HAZ MontaClave;
     aCodigo = "8073" + aAlfa1;   aValor = #345#5;   |HAZ MontaClave;
     aCodigo = "8074" + aAlfa1;   aValor = #345#6;   |HAZ MontaClave;
     aCodigo = "8075" + aAlfa1;   aValor = #345#7;   |HAZ MontaClave;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE agim0045;
     #345#1;
     ;
     #319#0, #319#1, 01;
     #319#0, #319#1, 99;
     ;
     NULL, agim0045;
|FIN;

|PROCESO Informacion;
     nSuma = nSw339 + nSw340 + nSw341 + nSw342 + nSw343 + nSw344 + nSw345;

     |SI nSuma = 0;
         aCodigo = "8009050";   aValor = "1";          |HAZ MontaClave;
         |ACABA;
     |FINSI;

     |SI #338#2 ! 0;
         aCodigo = "8009020";   aValor = #338#2;       |HAZ MontaClave;
     |FINSI;

     |SI #338#3 ! 0;
         aCodigo = "8009040";   aValor = #338#3;       |HAZ MontaClave;
     |FINSI;

     |SI #338#4 ! 0;
         aCodigo = "8009010";   aValor = #338#4;       |HAZ MontaClave;
     |FINSI;

     |SI #338#5 ! 0;
         aCodigo = "8009030";   aValor = #338#5;       |HAZ MontaClave;
     |FINSI;

     |SI nSw339 ! 0;  nConta = 0;  |BUCLE agim0039;  |FINSI;
     |SI nSw340 ! 0;  nConta = 0;  |BUCLE agim0040;  |FINSI;
     |SI nSw341 ! 0;  nConta = 0;  |BUCLE agim0041;  |FINSI;
     |SI nSw342 ! 0;  nConta = 0;  |BUCLE agim0042;  |FINSI;
     |SI nSw343 ! 0;  nConta = 0;  |BUCLE agim0043;  |FINSI;
     |SI nSw344 ! 0;  nConta = 0;  |BUCLE agim0044;  |FINSI;
     |SI nSw345 ! 0;  nConta = 0;  |BUCLE agim0045;  |FINSI;
|FPRC;

|PROCESO Instancia;

     |SI #100#21 ! "     ";
         nNume   = #100#21;
         aValor  = nNume;
         aCodigo = "8081001"; |HAZ MontaClave;
     |FINSI;

     aCodigo = "8081002";   aValor = #100#6;       |HAZ MontaClave;
     aCodigo = "8081003";   aValor = #100#9;       |HAZ MontaClave;
     aCodigo = "8081004";   aValor = #100#10;      |HAZ MontaClave;

     |ABRE #107;
     #107#0 = #0#2;
     |LEE 000#107=;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;

     aCodigo = "8081201";   aValor = #107#1;         |HAZ MontaClave;
     aCodigo = "8081202";   aValor = #107#9;         |HAZ MontaClave;
     aCodigo = "8081203";   aValor = #107#3;         |HAZ MontaClave;
     aCodigo = "8081204";   aValor = #107#4;         |HAZ MontaClave;
     aCodigo = "8081205";   aValor = #107#10;        |HAZ MontaClave;
     aCodigo = "8081206";   aValor = #107#10 % 102;  |HAZ MontaClave;
     aCodigo = "8081207";   aValor = #107#7;         |HAZ MontaClave;
     aCodigo = "8081208";   aValor = #107#6;         |HAZ MontaClave;
     aCodigo = "8081209";   aValor = #107#8;         |HAZ MontaClave;
|FPRC;

|PROCESO zregfirm;
     nConta  = nConta + 1;
     aAlfa   = #204#4;
     aAlfa   = aAlfa -  "Sr./a. ";
     aAlfa   = aAlfa -  "Sres./as. ";
     aAlfa   = aAlfa -  "Don/Do¤a ";

     aAlfa1 = ("000" + nConta) % -103;

     aCodigo = "8091" + aAlfa1;   aValor = aAlfa;   |HAZ MontaClave;
|FPRC;

|DEFBUCLE zregfirm;
     #204#1;
     ;
     #0#1, #0#2, 01;
     #0#1, #0#2, 99;
     ;
     NULL, zregfirm;
|FIN;

|PROCESO Certificacion;
     nConta = 0;
     |BUCLE zregfirm;
|FPRC;

|PROCESO  CierraXMLD2;
     aAlfa = "  </Claves>";
     |HAZ GrabaXML;

     aAlfa = "</Esquema>";
     |HAZ GrabaXML;

     |XCIERRA nHandleXML;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;
     |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |ENVIA_FICHERO aXMLServidor, aXMLDEPO;
     |SINO;
         |COPIA_FICHERO aXMLServidor, aXMLDEPO;
     |FINSI;

     |FBORRA aXMLServidor;
|FPRC;

|PROCESO Deposito;
     aDirDEPOLocal = #0#12;              |QBF aDirDEPOLocal;
     aDirDEPOLocal = aDirDEPOLocal + "/" + (("00000" + #0#1) % -105) + "_" + (("0000" + #0#2) % -102);
     |RMKDIR aDirDEPOLocal;
     aDirDEPOLocal = aDirDEPOLocal + "/";
     aXMLDEPO      = aDirDEPOLocal + "DEPOSITO.XML";

     |HAZ AbreXMLD2;
     |HAZ PortadaD2;
     |BUCLE cubal801_D2;
     |BUCLE cubal802_D2;
     |BUCLE cubal803_D2;
     |BUCLE cubal804_D2;
     |BUCLE cubal805_D2;
     |HAZ NueDistribucion;
     |HAZ MedioAmbiente;
     |SI #0#2 ] 2017;
         |HAZ TitularReal;
     |FINSI;
     |SI #0#2 ] 2019;
         |HAZ PrestaServicios;
     |FINSI;
     |HAZ Informacion;
     |HAZ Instancia;
     |HAZ Certificacion;
     |HAZ CierraXMLD2;

     aDirDOCULocal = aDirDEPOLocal + "Documentos";  |RMKDIR aDirDOCULocal;
     aDirDOCULocal = aDirDEPOLocal + "Documentos/";

     aAbre = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#2 + "\MEMORIA.pdf";
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida ] 0;
         aOrigen  = aAbre;
         aDestino = aDirDOCULocal + "MEMORIA.pdf";
         |RCOPIA_FICHERO aOrigen, aDestino;
         |RFBORRA aOrigen;
     |FINSI;

     aAbre = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#2 + "\GESTION.pdf";
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida ] 0;
         aOrigen  = aAbre;
         aDestino = aDirDOCULocal + "GESTION.pdf";
         |RCOPIA_FICHERO aOrigen, aDestino;
         |RFBORRA aOrigen;
     |FINSI;
|FPRC;

|PROCESO CuentasPdf;
     aDirDEPOLocal = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #0#2 + "\";
     aXMLDEPO      = aDirDEPOLocal + "DEPOSITO.XML";

     |HAZ AbreXMLD2;
     |HAZ PortadaD2;
     |BUCLE cubal801_D2;
     |BUCLE cubal802_D2;
     |BUCLE cubal803_D2;
     |BUCLE cubal804_D2;
     |BUCLE cubal805_D2;
     |HAZ NueDistribucion;
     |HAZ MedioAmbiente;
     |SI #0#2 ] 2017;
         |HAZ TitularReal;
     |FINSI;
||      |SI #0#2 ] 2019;  |HAZ PrestaServicios; |FINSI;
     |HAZ Informacion;
     |HAZ Instancia;
     |HAZ Certificacion;
     |HAZ CierraXMLD2;
|FPRC;

|PROCESO LeeSociedad;
     |ABRE #319;
     #319#0 = #0#1;
     #319#1 = 99;
     |LEE 040#319];
     |SI FSalida = 0;
         |LEE 040#319a;
     |SINO;
         |LEE 040#319u;
     |FINSI;

     |SI FSalida ! 0;  |O #319#0 ! #0#1;
         |DDEFECTO #319;
     |FINSI;
     |CIERRA #319;

     |ABRE #338;
     #338#0 = #319#0;
     #338#1 = #319#1;
     |LEE 040#338=;
     |SI FSalida ! 0;  |DDEFECTO #338;  |FINSI;
     |CIERRA #338;

     nSw339 = 0;
     nSw340 = 0;
     nSw341 = 0;
     nSw342 = 0;
     nSw343 = 0;
     nSw344 = 0;
     nSw345 = 0;

     |ABRE #339;
     #339#0 = #319#0;
     #339#1 = #319#1;
     #339#2 = 1;
     |LEE 040#339];
     |SI FSalida = 0; |Y  #339#0 = #319#0; |Y #339#1 = #319#1;
         nSw339 = 1;
     |FINSI;
     |CIERRA #339;

     |ABRE #340;
     #340#0 = #319#0;
     #340#1 = #319#1;
     #340#2 = 1;
     |LEE 040#340];
     |SI FSalida = 0; |Y  #340#0 = #319#0; |Y #340#1 = #319#1;
         nSw340 = 1;
     |FINSI;
     |CIERRA #340;

     |ABRE #341;
     #341#0 = #319#0;
     #341#1 = #319#1;
     #341#2 = 1;
     |LEE 040#341];
     |SI FSalida = 0; |Y  #341#0 = #319#0; |Y #341#1 = #319#1;
         nSw341 = 1;
     |FINSI;
     |CIERRA #341;

     |ABRE #342;
     #342#0 = #319#0;
     #342#1 = #319#1;
     #342#2 = 1;
     |LEE 040#342];
     |SI FSalida = 0; |Y  #342#0 = #319#0; |Y #342#1 = #319#1;
         nSw342 = 1;
     |FINSI;
     |CIERRA #342;

     |ABRE #343;
     #343#0 = #319#0;
     #343#1 = #319#1;
     #343#2 = 1;
     |LEE 040#343];
     |SI FSalida = 0; |Y  #343#0 = #319#0; |Y #343#1 = #319#1;
         nSw343 = 1;
     |FINSI;
     |CIERRA #343;

     |ABRE #344;
     #344#0 = #319#0;
     #344#1 = #319#1;
     #344#2 = 1;
     |LEE 040#344];
     |SI FSalida = 0; |Y  #344#0 = #319#0; |Y #344#1 = #319#1;
         nSw344 = 1;
     |FINSI;
     |CIERRA #344;

     |ABRE #345;
     #345#0 = #319#0;
     #345#1 = #319#1;
     #345#2 = 1;
     |LEE 040#345];
     |SI FSalida = 0; |Y  #345#0 = #319#0; |Y #345#1 = #319#1;
         nSw345 = 1;
     |FINSI;
     |CIERRA #345;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |ABRE #2;
     #2#0 = #0#1;
     #2#1 = #0#2;
     |LEE 000#2=;
     |SI FSalida ! 0;
         |CIERRA #2;
         |MENAV "0000 No existen los datos empresa del ejercicio";
         |ACABA;
     |FINSI;
     |CIERRA #2;

     aAlfa = #2#31;  |QBF aAlfa;
     |SI aAlfa = "";
         |SI enMensa = 0;
             |MENAV "0000No est  introducida la fecha inicio a las que van referidas las cuentas";
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa = #2#32;  |QBF aAlfa;
     |SI aAlfa = "";
         |SI enMensa = 0;
             |MENAV "0000No est  introducida la fecha final a las que van referidas las cuentas";
         |FINSI;
         |ACABA;
     |FINSI;

     |ABRE #100;
     #100#0 = #0#1;
     #100#1 = #0#2;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |ABRE #1;
     #1#0 = #100#15;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;

     nTipoBal = #1#2;

     #1#0 = #100#16;
     |LEE 000#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |HAZ LeeSociedad;

     nTipoPyG = #1#2;

     |SI nTipoBal ! nTipoPyG;
         aTipoInforme = "pgc07mixto";
         aTipoD2      = "Mixto";
     |SINO;
         |SI nTipoBal = 1;  aTipoInforme = "pgc07normal";     aTipoD2 = "Normal";     |FINSI;
         |SI nTipoBal = 2;  aTipoInforme = "pgc07abreviado";  aTipoD2 = "Abreviado";  |FINSI;
         |SI nTipoBal = 3;  aTipoInforme = "pgc07pymes";      aTipoD2 = "Pymes";      |FINSI;
     |FINSI;

     |DBASE aBase;
     aDirXBRLServidor = aBase + "xbrl";   |MKDIR aDirXBRLServidor;
     aDirXBRLServidor = aBase + "/";

     aDirXBRLLocal    = "\MODELOS";                           |RMKDIR aDirXBRLLocal;
     aDirXBRLLocal    = "\MODELOS\XBRL";                      |RMKDIR aDirXBRLLocal;
     aDirXBRLLocal    = "\MODELOS\XBRL\EJERCICIO_" + #0#2;    |RMKDIR aDirXBRLLocal;
     aDirXBRLLocal    = "\MODELOS\XBRL\EJERCICIO_" + #0#2 + "\";

     aDirAPILocal     = "\MODELOS\XBRL\API";                  |RMKDIR aDirAPILocal;

     aXMLServidor     = aDirXBRLServidor + (("00000" + #0#1) % -105) + #0#2 + ".xml";
     aXMLLocal        = aDirXBRLLocal    + (("00000" + #0#1) % -105) + #0#2 + ".xml";
     aRaiz            = aDirXBRLLocal    + (("00000" + #0#1) % -105) + #0#2;

     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "err.xml";       |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "val.xml";       |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "por.html";      |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "bal.html";      |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "pyg.html";      |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "patnetA.html";  |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "patnetB.html";  |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + "flujefec.html"; |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".xml";          |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".html";         |RFBORRA aAlfa;
     aAlfa = aDirXBRLLocal + (("00000" + #0#1) % -105) + #0#2 + ".xbrl";         |RFBORRA aAlfa;

     |SI #0#4 = "S";  |O #0#5 = "S";  |O #0#6 = "S";  |O #0#7 = "S";
      |O #0#8 = "S";  |O #0#9 = "S";
         |HAZ Presentacion;
     |FINSI;

     |SI #0#10 = "S";
         |HAZ FicheroXBRL;
     |FINSI;

     |SI #0#11 = "S";
         aAlfa = #0#12;  |QBF aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Consigne el directorio de trabajo del dep¢sito digital";
             |ERROR;
             |ACABA;
         |FINSI;

         |HAZ Deposito;
     |FINSI;

     |SI #0#11 = "P";
         |HAZ CuentasPdf;
     |FINSI;
|FPRC;

|PROCESO Boton1;
     aRuta = "D";
     |BROWSE aRuta;  |QBF aRuta;
     |SI aRuta = "D";  |ACABA;  |FINSI;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 2;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos = (nCarac * 100) + 1;
           aRuta = aRuta + (aAlfa % nPos);
     |SIGUE;

     #0#12 = aRuta;  |PINTA #0#12;
|FPRC;

|PROCESO Tipo13;  |TIPO 14;
     |SI nBoton1 ! -1;
         |ESTADO_CONTROL nBoton1, "ENABLE";
         |SI #0#11 = "N";
             |ESTADO_CONTROL nBoton1, "DISABLE";
         |FINSI;

         |ACABA;
     |FINSI;

     |CONTROL_SIMPLE nPanta, "BOTON,{{163}}", 2112, 2114, Boton1;
     nBoton1 = FSalida;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 2499;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;
     |HAZ BusquedaApli;

     |SI PARAMETRO = "";
         |ABRE #0;
         #0#0 = Usuario % 810;
         |LEE 101#0p;
         |SI FSalida ! 0;
             |DDEFECTO #0;
             #0#0 = Usuario % 810;
             |GRABA 020#0b;
         |FINSI;

         |CLS;
         |PINPA #0#0;
         nPanta = FSalida;

         |PINDA #0#0;
         |ENDATOS #1#0;
         |SI FSalida = 0;
             |GRABA 020#0a;
         |FINSI;
         |LIBERA #0;
         |CIERRA #0;
     |SINO;
         |DDEFECTO #0;
         #0#1  = enEmpresa;
         #0#2  = enAnyo;
         #0#3  = eaCampo3;
         #0#4  = eaCampo4;
         #0#5  = eaCampo5;
         #0#6  = eaCampo6;
         #0#7  = eaCampo7;
         #0#8  = eaCampo8;
         #0#9  = eaCampo9;
         #0#10 = eaCampo10;
         #0#11 = eaCampo11;
         #0#12 = eaCampo12;
         |HAZ Tipo12;
     |FINSI;
|FPRO;
