|FICHEROS;
     isy00200 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto

     maempr10 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     maempr05 #12;              || Socios Transparencia Fiscal
     maempr12 #20;              || Transparancia Fiscal
     maempr13 #21;              || Transparancia Fiscal

     isocie64 #11;              || Transparencia Fiscal
     isocie65 #13;              || Balances
     isocie59 #14;              || Liquidacion
     isocie58 #15;              || Distribucion de Resultados
     isocie73 #16;              || Resumen de Deducciones 2000
     isocie60 #17;              || Cooperativas
     isocie63 #18;              || Por Doble imposicion
     isocie62 #19;              || Compensaciones
     isocie67 #22;              || Informacion adicional
     isocie71 #71;              || Materializacion y Manifestacion

     isw00007 #90;
     isw00008 #99,MANTE;
     isw00031 #100;             || Hoja  1
     isw00025 #101;             || Hoja  2
     isw00026 #102;             || Hoja  3
     isw00032 #104;             || Hoja 10
     isw00012 #103;             || Hoja 13

     &haciend@  #706;
     &clientes@ #715;
|FIN;

|VARIABLES;
     ZPara       = 0;
     ZPara1      = 0;
     XPara       = 0;
     Dia         = "";
     Mes         = "";
     Ejerc       = "";
     aGuiri      = "";
     SwHay       = 0;
     DEmpre      = 0;
     HEmpre      = 0;
     Fichero     = "";
     Valfa       = "";
     Valfa1      = "";
     Valfa2      = "";
     NombreInf   = "";
     NombreImpre = "";
     ContaBucle  = 0;
     ContaBucleL = 0;
     Puntero     = 0;
     nCanti      = 0;
     aDImpre     = "";
     aHImpre     = "";

     &enCodProv   = 0;
     &enCodPobl   = 0;
     &enCodCli    = 0;
     &enSwDeDonde = 0;

     &eaEfectivo  = "";
     &eaAdeudo    = "";
     &eaEntidad   = "";
     &eaOficina   = "";
     &eaDC        = "";
     &eaCuenta    = "";
     &enModelo    = 0;
     &enBanco     = 0;
     &enFormaPag  = 0;
     &enForzar    = 0;
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
     |SI #0#0 = "S";
         |CAMPO_MODIFICA #0#01, 1, "S";
         |CAMPO_MODIFICA #0#02, 1, "S";

         |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
               #0XPara = 0; |PINTA #0XPara;
               |CAMPO_MODIFICA #0XPara, 1, "N";
         |SIGUE;
     |SINO;
         #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
         #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

         |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
               |CAMPO_MODIFICA #0XPara, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO TipoImpresion;
     |C_M #0#37, 1, "S";
     |C_M #0#58, 1, "S";
     |PARA XPara = 38; |SI XPara [ 54; |HACIENDO XPara = XPara + 1;
           |C_M #0XPara, 1, "S";
     |SIGUE;

     |SI #0#34 = "C";
         #0#37 = 1;  |C_M #0#37, 1, "N";  |PINTA #0#37;
         |PARA XPara = 38; |SI XPara [ 54; |HACIENDO XPara = XPara + 1;
               |C_M #0XPara, 1, "N";  #0XPara = "S";  |PINTA #0XPara;
         |SIGUE;
     |FINSI;

     |SI #0#34 = "H";
         #0#58 = "N";  |C_M #0#58, 1, "N";  |PINTA #0#58;
     |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

|PROCESO LeeFich;
     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#56;
     |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |CIERRA #2;

     enCodProv = #2#29;
     enCodPobl = #2#30;
     |HAZ LeeHacienda;

     |ABRE #13;
     #13#0 = #1#0;
     #13#1 = #1#1;
     |LEE 040#13=;
     |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
     |CIERRA #13;

     |ABRE #22;
     #22#0 = #1#0;
     #22#1 = #1#1;
     |LEE 040#22=;
     |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |CIERRA #22;

     |ABRE #11;
     #11#0 = #1#0;
     #11#1 = #1#1;
     |LEE 040#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
     |CIERRA #11;

     |ABRE #14;
     #14#0 = #1#0;
     #14#1 = #1#1;
     |LEE 040#14=;
     |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
     |CIERRA #14;

     |ABRE #15;
     #15#0 = #1#0;
     #15#1 = #1#1;
     |LEE 040#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
     |CIERRA #15;

     |ABRE #16;
     #16#0 = #1#0;
     #16#1 = #1#1;
     |LEE 040#16=;
     |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
     |CIERRA #16;

     |ABRE #17;
     #17#0 = #1#0;
     #17#1 = #1#1;
     |LEE 040#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
     |CIERRA #17;

     |ABRE #18;
     #18#0 = #1#0;
     #18#1 = #1#1;
     |LEE 040#18=;
     |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
     |CIERRA #18;

     |ABRE #71;
     #71#0 = #1#0;
     #71#1 = #1#1;
     |LEE 040#71=;
     |SI FSalida ! 0; |DDEFECTO #71; |FINSI;
     |CIERRA #71;

     aGuiri = "N";
     |ABRE #4;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = 21;
     |LEE 040#4=;
     |SI FSalida = 0;
         aGuiri = "S";
     |FINSI;
     |CIERRA #4;
|FPRC;

|PROCESO Defectos;
     |DDEFECTO #100;
     |DDEFECTO #101;
     |DDEFECTO #102;
     |DDEFECTO #103;
     |DDEFECTO #104;
|FPRC;

|PROCESO Representante;
     ContaBucle = ContaBucle + 1;
     |SI ContaBucle = 1;
         #100#72 = #5#3 %  118;
         #100#73 = #5#3 %  1918;
         #100#74 = #5#4;
         #100#75 = #5#5;
         #100#76 = #5#6;
     |FINSI;

     |SI ContaBucle = 2;
         #100#77 = #5#3 %  118;
         #100#78 = #5#3 %  1918;
         #100#79 = #5#4;
         #100#80 = #5#5;
         #100#81 = #5#6;
     |FINSI;

     |SI ContaBucle = 3;
         #100#82 = #5#3 %  118;
         #100#83 = #5#3 %  1918;
         #100#84 = #5#4;
         #100#85 = #5#5;
         #100#86 = #5#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #5#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, Representante;
|FIN;

|PROCESO PuntoA;
     |SI ContaBucle ] 6;
         #101#34 = "";
         #101#35 = "";
         #101#36 = "";
         #101#37 = "HOJA COMPLEMENTARIA";
         #101#38 = "";
         #101#39 = "";
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 6) + 4;  #101Puntero = #6#3;
     Puntero = Puntero + 1;           #101Puntero = #6#4;
     Puntero = Puntero + 1;           #101Puntero = #6#8;
     Puntero = Puntero + 1;           #101Puntero = #6#5;
     Puntero = Puntero + 1;           #101Puntero = #6#6;
     Puntero = Puntero + 1;           #101Puntero = #6#7;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr03;
     #6#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, PuntoA;
|FIN;

|PROCESO PuntoB1;
     |SI ContaBucle ] 6;
         #101#65 = "";
         #101#66 = "HOJA COMPLEMENTARIA";
         #101#67 = "";
         #101#68 = 0;
         #101#69 = "";
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 5) + 40; #101Puntero = #7#3;
     Puntero = Puntero + 1;           #101Puntero = #7#4;
     Puntero = Puntero + 1;           #101Puntero = #7#5;
     Puntero = Puntero + 1;           #101Puntero = #7#6;
     Puntero = Puntero + 1;           #101Puntero = #7#7;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr06;
     #7#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, PuntoB1;
|FIN;

|PROCESO PuntoB2;
     |SI ContaBucle ] 6;
         #101#105  = "";
         #101#106 = "";
         #101#107 = "";
         #101#108 = "HOJA COMPLEMENTARIA";
         #101#109 = "";
         #101#110 = 0;
         #101#111 = "";
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 7) + 70; #101Puntero = #8#3;
     Puntero = Puntero + 1;           #101Puntero = #8#9;
     Puntero = Puntero + 1;           #101Puntero = #8#4;
     Puntero = Puntero + 1;           #101Puntero = #8#5;
     Puntero = Puntero + 1;           #101Puntero = #8#6;
     Puntero = Puntero + 1;           #101Puntero = #8#7;
     Puntero = Puntero + 1;           #101Puntero = #8#8;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr02;
     #8#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, PuntoB2;
|FIN;

|PROCESO PuntoC1;
     |SI ContaBucle ] 6;
         #101#142 = "";
         #101#143 = "HOJA COMPLEMENTARIA";
         #101#144 = "";
         #101#145 = "";
         #101#146 = "";
         #101#147 = 0;
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 6) + 112; #101Puntero = #9#3;
     Puntero = Puntero + 1;            #101Puntero = #9#4;
     Puntero = Puntero + 1;            #101Puntero = #9#5;
     Puntero = Puntero + 1;            #101Puntero = #9#6;
     Puntero = Puntero + 1;            #101Puntero = #9#7;
     Puntero = Puntero + 1;            #101Puntero = #9#8;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr14;
     #9#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, PuntoC1;
|FIN;

|PROCESO PuntoC2;
     |SI ContaBucle ] 6;
         #101#178 = "";
         #101#179 = "HOJA COMPLEMENTARIA";
         #101#180 = "";
         #101#181 = "";
         #101#182 = 0;
         #101#183 = "";
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 6) + 148; #101Puntero = #10#3;
     Puntero = Puntero + 1;            #101Puntero = #10#4;
     Puntero = Puntero + 1;            #101Puntero = #10#6;
     Puntero = Puntero + 1;            #101Puntero = #10#5;
     Puntero = Puntero + 1;            #101Puntero = #10#7;
     Puntero = Puntero + 1;            #101Puntero = #10#8;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr15;
     #10#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, PuntoC2;
|FIN;

|PROCESO PuntoE;
     |SI ContaBucle ] 11;
         #102#118 = "";
         #102#119 = "";
         #102#120 = "";
         #102#121 = "";
         #102#122 = "HOJA COMPLEMENTARIA";
         #102#123 = "";
         #102#124 = 0;
         #102#125 = "";
         |ERROR10;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 8) + 38;  #102Puntero = #12#3;
     Puntero = Puntero + 1;            #102Puntero = #12#10;
     Puntero = Puntero + 1;            #102Puntero = #12#4;
     Puntero = Puntero + 1;            #102Puntero = #12#5;
     Puntero = Puntero + 1;            #102Puntero = #12#6;
     Puntero = Puntero + 1;            #102Puntero = #12#7;
     Puntero = Puntero + 1;            #102Puntero = #12#8;
     Puntero = Puntero + 1;            #102Puntero = #12#9;

     ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr05;
     #12#2;
     ;
     #1#0, #1#1, 999.99, 00;
     #1#0, #1#1,      0, 99;
     ;
     NULL, PuntoE;
|FIN;

|PROCESO El21;
     |SI ContaBucleL ] 5;
         Puntero = (ContaBucle * 24) - 2;  #103Puntero = "HOJA COMPLEMENTARIA";
         Puntero = Puntero + 1;            #103Puntero = "";
         Puntero = Puntero + 1;            #103Puntero = "";
         Puntero = Puntero + 1;            #103Puntero = #103Puntero + #21#7;
         |ACABA;
     |FINSI;

     Puntero = (((ContaBucle * 24) - 2) - 16) + (ContaBucleL * 4);
                                       #103Puntero = #21#4;
     Puntero = Puntero + 1;            #103Puntero = #21#5;
     Puntero = Puntero + 1;            #103Puntero = #21#6;
     Puntero = Puntero + 1;            #103Puntero = #21#7;

     ContaBucleL = ContaBucleL + 1;
|FPRC;

|DEFBUCLE maempr13;
     #21#1;
     ;
     #20#0, #20#1, #20#2, 00;
     #20#0, #20#1, #20#2, 99;
     ;
     NULL, El21;
|FIN;

|PROCESO El20;
     #103#146 = #103#146 + #20#6;
     |SI ContaBucle ] 6;
         #103#122 = "HOJA COMPLEMENTARIA";
         #103#123 = "";
         #103#124 = "";
         #103#125 = #103#125 + #20#6;

         |PARA ZPara = 125; |SI ZPara [ 142; |HACIENDO;
               ZPara = ZPara + 1;  #103ZPara = "";
               ZPara = ZPara + 1;  #103ZPara = "";
               ZPara = ZPara + 1;  #103ZPara = "";
               ZPara = ZPara + 1;  #103ZPara = 0;
         |SIGUE;
         |ACABA;
     |FINSI;

     Puntero = (ContaBucle * 24) + 2;  #103Puntero = #20#3;
     Puntero = Puntero + 1;            #103Puntero = #20#4;
     Puntero = Puntero + 1;            #103Puntero = #20#5;
     Puntero = Puntero + 1;            #103Puntero = #20#6;

     ContaBucle = ContaBucle + 1;

     ContaBucleL = 0;  |BUCLE maempr13;
|FPRC;

|DEFBUCLE maempr12;
     #20#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, El20;
|FIN;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|PROCESO Impresion;
     |SI #0#34 = "C";
         NombreInf = "h" + NombreInf;
         |INFOR NombreInf;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PRINT;   |PIEINF;   |FININF;
         |ACABA;
     |FINSI;

     |ET Comienzo;
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA;  |FINSI;

         NombreInf = "m" + NombreInf;
         Valfa1    = NombreInf % -102;

         |SI Valfa1 ! "16";
             #90#2 = "COLOQUE HOJA " + Valfa1 + " DEL MODELO 200, <INTRO PARA IMPRIMIR>";
         |SINO;
             |SI aGuiri = "N";
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 200, <INTRO PARA IMPRIMIR>";
             |SINO;
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 206, <INTRO PARA IMPRIMIR>";
             |FINSI;
         |FINSI;

         |ATRI P; |PINTA #90#2; |ATRI 0;
         |PAUSA;

         |INFOR NombreInf;
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

         |PRINT; |PIEINF; |FININF;  |FINIMP;

         |CONFI "2400NDesea repetir la hoja : ";
         |SI FSalida = 0;  |VETE Comienzo;  |FINSI;
|FPRC;


|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO Hoja1;
     #100#2  = #706#2;                   || Delegacion
     #100#3  = #706#3;                   || Administracion
     #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
     #100#5  = #2#31 % 102;            || Del Dia
     #100#6  = #2#31 % 402;            || Del Mes
     #100#7  = #2#32 % 102;            || Al Dia
     #100#8  = #2#32 % 402;            || Al Mes
     #100#9  = #2#32 % -104;           || Al A¤o
     #100#10 = #2#16 % -101;           || Ejercicio
     |SI #0#55 = 1;
         #100#11 = #2#17 % 102;            || CNAE
     |SINO;
         #100#11 = #2#17 % -102;           || CNAE
     |FINSI;
     #100#12 = #2#3;                   || NIF
     #100#13 = #2#2;                   || Nombre
     #100#14 = #2#4;                   || SG
     #100#15 = #2#5;                   || Domicilio
     #100#16 = #2#6;                   || Numero
     #100#17 = #2#7;                   || Escalera
     #100#18 = #2#8;                   || Piso
     #100#19 = #2#9;                   || Puerta
     #100#20 = #2#15;                  || Telefono
     #100#21 = #2#13;                  || Municipio
     #100#22 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
     #100#24 = #100#23 + #100#22;      || Codigo Postal Entero
     |SI #2#98 = "S";  #100#25 = "X";  |FINSI;   || Es Complementaria
     Valfa1  = #2#99;  |QBT Valfa1;
     Valfa2  = #2#100; |QBT Valfa2;
     #100#26 = ("0000000000000" + Valfa1 + Valfa2) % -113;  || N§ Justificante

     |ABRE #4;
     |PARA ZPara = 27;  |SI ZPara [ 60;  |HACIENDO ZPara = ZPara + 1;
           ZPara1 = ZPara - 26;
           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = ZPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #100ZPara = "X";
               |SI ZPara1 = 9;  |O ZPara1 = 10;
                   |SI #100#61 = 0;  #100#61 = #4#4;  |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     #100#62 = #2#75;                         || Empleados no fijos
     #100#63 = #2#76;                         || Empleados si fijos
     #100#64 = " ";
     |SI #2#34 = "S";  #100#64 = "X";  |FINSI;   || Renuncia
     #100#65 = #2#77;                            || Nombre Secretario
     #100#66 = #2#78;                            || NIF    Secretario
     #100#67 = #2#77;                            || Nombre Secretario
     #100#68 = #2#13;                            || Poblacion firma
     #100#69 = Dia;                              || Dia
     #100#70 = Mes;                              || Mes
     #100#71 = Ejerc;                            || A¤o

     ContaBucle = 0;    |BUCLE maempr04;

     NombreInf = "0020001";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja2;
     #101#1 = #1#3;
     #101#2 = #1#2;

     ContaBucle = 0;    |BUCLE maempr03;
     ContaBucle = 0;    |BUCLE maempr06;
     ContaBucle = 0;    |BUCLE maempr02;
     ContaBucle = 0;    |BUCLE maempr14;
     ContaBucle = 0;    |BUCLE maempr15;

     NombreInf = "0020002";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja3;
     #102#1 = #1#3;
     #102#2 = #1#2;

     |ABRE #4;
     |PARA ZPara = 4;  |SI ZPara [ 6;  |HACIENDO ZPara = ZPara + 1;
           ZPara1 = ZPara + 63;
           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = ZPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #102ZPara = "X";
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     |PARA ZPara = 7;  |SI ZPara [ 37;  |HACIENDO ZPara = ZPara + 1;
           ZPara1    = ZPara - 5;
           #102ZPara = #11ZPara1;
     |SIGUE;

     ContaBucle = 0;    |BUCLE maempr05;

     NombreInf = "0020003";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja4;
     NombreInf = "002004a";  |HAZ Impresion;
     NombreInf = "002004b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5;
     NombreInf = "002005a";  |HAZ Impresion;
     NombreInf = "002005b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja6;
     NombreInf = "0020006";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja7;
     NombreInf = "0020007";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja8;
     NombreInf = "0020008";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja9;
     NombreInf = "0020009";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja10;
     |ABRE #19;
     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 547;
     |LEE 040#19=;
     |SI FSalida = 0;
         #104#01 = #19#4;   #104#02 = #19#9;   #104#03 = #19#15;  #104#04 = #19#21;
         #104#05 = #19#5;   #104#06 = #19#10;  #104#07 = #19#16;  #104#08 = #19#22;
         #104#09 = #19#6;   #104#10 = #19#11;  #104#11 = #19#17;  #104#12 = #19#23;
         #104#13 = #19#7;   #104#14 = #19#12;  #104#15 = #19#18;  #104#16 = #19#24;
         #104#17 = #19#8;   #104#18 = #19#13;  #104#19 = #19#19;  #104#20 = #19#25;
         #104#21 = #19#27;  #104#22 = #19#28;  #104#23 = #19#29;  #104#24 = #19#30;
         #104#25 = #19#31;  #104#26 = #19#32;  #104#27 = #19#33;  #104#28 = #19#34;
         #104#29 = #19#35;  #104#30 = #19#36;  #104#31 = #19#37;  #104#32 = #19#38;
                            #104#33 = #19#14;  #104#34 = #19#20;  #104#35 = #19#26;
     |FINSI;

     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 561;
     |LEE 040#19=;
     |SI FSalida = 0;
         #104#36 = #19#4;   #104#37 = #19#9;   #104#38 = #19#15;  #104#39 = #19#21;
         #104#40 = #19#5;   #104#41 = #19#10;  #104#42 = #19#16;  #104#43 = #19#22;
         #104#44 = #19#6;   #104#45 = #19#11;  #104#46 = #19#17;  #104#47 = #19#23;
         #104#48 = #19#7;   #104#49 = #19#12;  #104#50 = #19#18;  #104#51 = #19#24;
         #104#52 = #19#8;   #104#53 = #19#13;  #104#54 = #19#19;  #104#55 = #19#25;
         #104#56 = #19#27;  #104#57 = #19#28;  #104#58 = #19#29;  #104#59 = #19#30;
         #104#60 = #19#31;  #104#61 = #19#32;  #104#62 = #19#33;  #104#63 = #19#34;
                            #104#64 = #19#14;  #104#65 = #19#20;  #104#66 = #19#26;
     |FINSI;
     |CIERRA #19;

     NombreInf = "0020010";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja11;
     NombreInf = "0020011";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja12;
     NombreInf = "0020012";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja13;
     #103#0 = #1#3;
     #103#1 = #1#2;
     ContaBucle = 0;  |BUCLE maempr12;
     NombreInf = "0020013";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja14;
     NombreInf = "0020014";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja15;
     NombreInf = "0020015";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja16;
     #100#2  = #706#2;                   || Delegacion
     #100#3  = #706#3;                   || Administracion
     #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
     #100#5  = #2#31 % 102;            || Del Dia
     #100#6  = #2#31 % 402;            || Del Mes
     #100#7  = #2#32 % 102;            || Al Dia
     #100#8  = #2#32 % 402;            || Al Mes
     #100#9  = #2#32 % -104;           || Al A¤o
     #100#10 = #2#16 % -101;           || Ejercicio
     |SI #0#55 = 1;
         #100#11 = #2#17 % 102;            || CNAE
     |SINO;
         #100#11 = #2#17 % -102;           || CNAE
     |FINSI;

     #100#12 = #2#3;                   || NIF
     #100#13 = #2#2;                   || Nombre
     #100#14 = #2#4;                   || SG
     #100#15 = #2#5;                   || Domicilio
     #100#16 = #2#6;                   || Numero
     #100#17 = #2#7;                   || Escalera
     #100#18 = #2#8;                   || Piso
     #100#19 = #2#9;                   || Puerta
     #100#20 = #2#15;                  || Telefono
     #100#21 = #2#13;                  || Municipio
     #100#22 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
     #100#24 = #100#23 + #100#22;      || Codigo Postal Entero
     #100#68 = #2#13;                  || Poblacion firma
     #100#69 = Dia;                    || Dia
     #100#70 = Mes;                    || Mes
     #100#71 = Ejerc;                  || A¤o

     nCanti = #14#105 + #14#106;
     |SI nCanti < 0;
         |SI #2#34 = "S";
             #100#87 = "X";
         |SINO;
             #100#88 = "X";
         |FINSI;
     |FINSI;

     enCodCli = #1#0;
     |HAZ LeePersona;

     #100#89 = "0000";
     #100#90 = "0000";
     #100#91 = "00";
     #100#92 = "0000000000";

     nCanti = #14#105 + #14#106;
     |SI #100#88 = "X";
         |SI enSwDeDonde = 1;
             enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;

             #100#89 = eaEntidad;
             #100#90 = eaOficina;
             #100#91 = eaDC;
             #100#92 = eaCuenta;
         |SINO;
             #100#89 = #715#81;
             #100#90 = #715#82;
             #100#91 = #715#83;
             #100#92 = #715#84 % 110;
         |FINSI;
     |FINSI;

     |SI nCanti > 0;
         |SI #0#57 = "A";
             #100#94 = "X";
         |SINO;
             #100#93 = "X";
         |FINSI;
     |FINSI;

     #100#95 = "0000";
     #100#96 = "0000";
     #100#97 = "00";
     #100#98 = "0000000000";

     |SI #100#94 = "X";
         |SI enSwDeDonde = 1;
             enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;
             #100#95 = eaEntidad;
             #100#96 = eaOficina;
             #100#97 = eaDC;
             #100#98 = eaCuenta;
         |SINO;
             #100#95 = #715#81;
             #100#96 = #715#82;
             #100#97 = #715#83;
             #100#98 = #715#84 % 110;
         |FINSI;
     |FINSI;

     NombreInf = "0020016";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja17;
     |SI #0#34 ! "C";  |ACABA;  |FINSI;
      NombreInf = "9620099";  |HAZ Impresion;
|FPRC;

|PROCESO ImprimeLos;
     |PINPA #0#90;
     #90#0 = #99#0;  |PINTA #90#0;
     #90#1 = #99#3;  |PINTA #90#1;

     |PARA XPara = 1; |SI XPara [ #99#4; |HACIENDO XPara = XPara + 1;
           |HAZ Defectos;
           #90#3 = XPara;  |PINTA #90#3;
           |HAZ LeeFich;
           |SI #0#38 = "S"; |HAZ Hoja1;  |FINSI;   || h0020001
           |SI #0#39 = "S"; |HAZ Hoja2;  |FINSI;   || h0020002
           |SI #0#40 = "S"; |HAZ Hoja3;  |FINSI;   || h0020003
           |SI #0#41 = "S"; |HAZ Hoja4;  |FINSI;   || h0020004
           |SI #0#42 = "S"; |HAZ Hoja5;  |FINSI;   || h0020005
           |SI #0#43 = "S"; |HAZ Hoja6;  |FINSI;   || h0020006
           |SI #0#44 = "S"; |HAZ Hoja7;  |FINSI;   || h0020007
           |SI #0#45 = "S"; |HAZ Hoja8;  |FINSI;   || h0020008
           |SI #0#46 = "S"; |HAZ Hoja9;  |FINSI;   || h0020009
           |SI #0#47 = "S"; |HAZ Hoja10; |FINSI;   || h0020010
           |SI #0#48 = "S"; |HAZ Hoja11; |FINSI;   || h0020011
           |SI #0#49 = "S"; |HAZ Hoja12; |FINSI;   || h0020012
           |SI #0#50 = "S"; |HAZ Hoja13; |FINSI;   || h0020013
           |SI #0#51 = "S"; |HAZ Hoja14; |FINSI;   || h0020014
           |SI #0#52 = "S"; |HAZ Hoja15; |FINSI;   || h0020015
           |SI aGuiri = "N";
                |SI #0#53 = "S"; |HAZ Hoja16; |FINSI;   || h0020016
                |SI #0#54 = "S"; |HAZ Hoja17; |FINSI;   || h9620099  Hoja en Blanco
           |SINO;
                |SI #0#53 = "S"; |HAZ Hoja17; |FINSI;   || h9620099  Hoja en Blanco
                |SI #0#54 = "S"; |HAZ Hoja16; |FINSI;   || h0020016
           |FINSI;
           |SI #0#58 = "S"; |HAZ Hoja17; |FINSI;   || h9620099  Hoja en Blanco
     |SIGUE;

     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#56;
     |LEE 101#1=;
     |SI FSalida = 0;
         #1#6 = "S";
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
     |CIERRA #1;
|FPRC;

|DEFBUCLE rew00001;
     #99#1;
     5;
     00000, "S";
     99999, "S";
     ;
     NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
     Dia   = #0#33 % 102;
     Mes   = #0#33 % 402;
     Ejerc = #0#33 % -104;

     |SI Mes = "01"; Mes = "Enero     "; |FINSI;
     |SI Mes = "02"; Mes = "Febrero   "; |FINSI;
     |SI Mes = "03"; Mes = "Marzo     "; |FINSI;
     |SI Mes = "04"; Mes = "Abril     "; |FINSI;
     |SI Mes = "05"; Mes = "Mayo      "; |FINSI;
     |SI Mes = "06"; Mes = "Junio     "; |FINSI;
     |SI Mes = "07"; Mes = "Julio     "; |FINSI;
     |SI Mes = "08"; Mes = "Agosto    "; |FINSI;
     |SI Mes = "09"; Mes = "Septiembre"; |FINSI;
     |SI Mes = "10"; Mes = "Octubre   "; |FINSI;
     |SI Mes = "11"; Mes = "Noviembre "; |FINSI;
     |SI Mes = "12"; Mes = "Diciembre "; |FINSI;
     Mes = Mes > Mes;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
     #99#0 = #1#0;
     #99#1 = "";
     #99#2 = "";
     #99#3 = #1#2;
     #99#4 = #0#37;
     #99#5 = "S";
     #99#6 = 1;
     #99#7 = #1#3;
     |GRABA 040#99n;

     SwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
     #1#1;
     5, 6;
     #0#56, DEmpre, "200", aDImpre;
     #0#56, HEmpre, "200", aHImpre;
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
     #99#0 = 1;
|FRUT;

|RUTINA superior;
     #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
     Fichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 Fichero;
     |ABRE #99; |CIERRA #99; |DELINDEX #99;

     |ABRE #99;
     SwHay = 0;
     |SI #0#0 = "S";
         DEmpre = #0#1;
         HEmpre = #0#2;
         |BUCLE isacceso;
     |SINO;
         |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
               |SI #0XPara ! 0;
                   DEmpre = #0XPara;
                   HEmpre = #0XPara;
                   |BUCLE isacceso;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #99;

     |SI SwHay = 0; |ACABA; |FINSI;

     |SI #0#35 = "N"; |ACABA; |FINSI;

     |ENTLINEAL #1#99, -1, 4, 22, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
     |SI FSalida ! 10; |ACABA; |FINSI;

     |LIBERA #99;
     |LEE 140#99=;

     |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
     |PINTA #99#5;
     |GRABA 140#99a;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |SI #0#36 = "N";
         aDImpre = "N";
         aHImpre = "N";
     |SINO;
         aDImpre = "N";
         aHImpre = "S";
     |FINSI;

     |HAZ TipoImpre;

     |SI #0#34 = "C";
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     |HAZ CargaTempo;

     |SI SwHay = 0;
         |SI #0#34 = "C";   |FINIMP;  |FINSI;
         |ABRE #99; |CIERRA #99; |DELINDEX #99;
         |ACABA;
     |FINSI;

     |BUCLE rew00001;

     |SI #0#34 = "C";
         |FINIMP;
     |FINSI;

     |ABRE #99; |CIERRA #99; |DELINDEX #99;
|FPRC;
