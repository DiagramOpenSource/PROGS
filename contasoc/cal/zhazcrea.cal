|FICHEROS;
     zw000001,MANTE;
     zw000002,MANTE;
     zw000003,MANTE;
     zw000004,MANTE;
     zw000005,MANTE;
     zw000007,MANTE;
     zw000008,MANTE;
     zw000009,MANTE;
     zw000016,MANTE;
     zw000017,MANTE;
     zw000021,MANTE;
     zw000023,MANTE;
     zw000028,MANTE;

     zhazdocu;
     zregdocu;
     zhazcrea;
     zregubic;
     zregfirm;
     zregasis;

     maacceso;
     sodacoca;
     cuacceso;
     meempmem;

     isom0000;
     maempr01;
     maempr02;

     megwordc;
     megwordl;

     cubal802;

     :/basica/def/agim0028;
     :/basica/def/agim0019;
     :/basica/def/agim0024;
     :/basica/def/agim0026;

     :/contagen/def/canempre;
     :/contagen/def/ca8ctrle;
     :/contagen/def/ca8comay;
     :/contagen/def/ca8m0000;

     imagen@;
|FIN;

|VARIABLES;
     nNumer1          = 0;
     nNumer2          = 0;
     nBtnCarga        = 0;
     n1Btn1           = 0;
     n1Btn2           = 0;
     n1Btn3           = 0;
     n1Vent           = 0;
     n2Vent           = 0;
     nVent            = 0;
     nVentTrab        = 0;
     nError           = 0;
     nError1          = 0;
     nError2          = 0;
     nCampo           = 0;
     nCampoD          = 0;
     nCampoH          = 0;
     nID              = 0;
     nTipo            = 0;
     nContador        = 0;
     nConta1          = 0;
     nConta2          = 0;
     nConta3          = 0;
     nConta4          = 0;
     nPantalla        = 0;
     nNume            = 0;
     nHandle          = 0;
     nPanta           = 0;
     nSubPanta        = 0;
     nGrid            = 0;
     nLinea           = 0;
     nTipoCert        = 0;
     nChequeo         = 0;
     nSuma            = 0;
     nContinua        = 0;
     nAnyo            = 0;

     nRango           = -1;
     nEjer            = -1;

     nTree            = -1;

     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aID              = "";
     aQueBoton        = "";
     aIPRemoto        = "";
     aDni             = "";
     aPresi           = "";
     aNombre1         = "";
     aDTipo           = "";
     aHTipo           = "";
     aTipo            = "";
     aNif1            = "";
     aAbre            = "";
     aBase            = "";
     aHora            = "";
     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aMas             = "";
     aCab             = "";
     aBuscar          = "";
     aRefresca        = "";
     aContenido       = "";
     aDef             = "";
     aMarca           = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     {-1}sTree        = 0;
     sT_nID           = 0;
     sT_nOper         = 0;
     sT_aData         = "";

     {5}aPopup        = "";

      &enModo         = 0;
      &enEmpresa      = 0;
      &empresa        = 0;
      &anyo           = 0;
      &enAnyo         = 0;
      &enError        = 0;
      &fFechaChequeo  = @;
      &fFechaDisol    = @;
      &empAlta        = 0;
      &empre          = 0;
      &perio          = 0;
      &plani          = 0;
      &cuent          = ""
      &siono          = "";
      &eaCampo3       = "";
      &eaCampo4       = "";
      &eaCampo5       = "";
      &eaCampo6       = "";
      &eaCampo7       = "";
      &eaCampo8       = "";
      &eaCampo9       = "";
      &eaCampo10      = "";
      &eaCampo11      = "";
      &eaCampo12      = "";
      &enPersonaliza  = 0;
      &eaAlfa         = "";
      &eaDirTrabajo   = "";
      &eaDirGuarda    = "";
      &eaDirSerPlan   = "";
      &eaFicheroTra   = "";
      &eaDirSerDoc    = "";
      &eaOrigen       = "";
      &eaDestino      = "";
     &enCoopera      = 0;
     &eaUnidadBasico = "";
     &eaModoPresenta = "";
     &enMensa        = 0;
     &enEjerCuadro   = 0;
     &enEjercicio    = 0;
     &eaDSMAC        = "";
     &enUltMemA      = 0;
     &enUltMemP      = 0;
     &enUltMemC      = 0;
     &eaTipoMemo      = "";
     &eaRutaOrigen    = "";
     &eaRutaDestino   = "";
     &eaFicheroTxt    = "";
     &eaFicheroTgz    = "";
     &eaFicheroTar    = "";
     &enSwRegraba     = 0;
     &eaBloqueo       = "";
     &enSalir         = 0;
|FIN;

|INCLUYE varbal_i;

|PROCESO MiraBloqueo;
     |DBASS aBase;
     aAbre = aBase + "integral/def/dsam0021.mas";
     |XABRE "E", aAbre, 0;
     |SI FSalida ] 0;
         aAlfa = ":integral/dsam0021;" + (("00000" + #zregdocu#0) % -105);
         aAlfa = aAlfa + "CHEQUEO";
         |SUB_EJECUTA aAlfa;

         |SI eaBloqueo ! "1";
             aAlfa = "|:integral/dsam0021;" + (("00000" + #zregdocu#0) % -105);
             aAlfa = aAlfa + "PANTALLA";
             |SUB_EJECUTA aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO LeePlan;
     |ABRE #sodacoca;
     #sodacoca#0 = #zhazcrea#0;
     #sodacoca#1 = #zhazcrea#1;
     |LEE 041#sodacoca.=;
     |SI FSalida = 0; |Y #sodacoca#8 ! -1;
         eNum2008 = #sodacoca#8;
         #zhazcrea#3 = eNum2008;
     |FINSI;
     |CIERRA #sodacoca;

     aAlfa = #zhazcrea#1;
     aAlfa = aAlfa % -102;
     |ABRE #canempre;
     |SELECT #4#canempre;

     perio = -1;
     #canempre#2  = #zhazcrea#0;
     #canempre#26 = aAlfa;
     |LEE 000#canempre.=;
     |SI FSalida = 0; perio = #canempre#3;  |FINSI;
     |CIERRA #canempre;

     |SI perio = -1;
         |MENAV "0000 No existe la contabilidad de la empresa.";
         |ACABA;
     |FINSI;

     |ABRE #ca8ctrle;
     |DDEFECTO #ca8ctrle;
     #ca8ctrle#0 = #canempre#2;
     #ca8ctrle#1 = #canempre#3;
     |LEE 000#ca8ctrle.=;
     |SI FSalida = 0;
         eNum2008 = #ca8ctrle#2;
         #zhazcrea#3 = eNum2008;
     |FINSI;
     |CIERRA #ca8ctrle;
|FPRC;

|PROCESO DatosCuentas;
     |ABRE #cuacceso;
     #cuacceso#0 = #zhazcrea#0;
     #cuacceso#1 = #zhazcrea#1;
     |LEE 040#cuacceso.=;
     nError2 = FSalida;
     |SI FSalida ! 0;
         |HAZ LeePlan;
         #cuacceso#14 = #zhazcrea#3;
         |HAZ LeeBalanceD;
     |SINO;
         #zhazcrea#3 = #cuacceso#14;
         #zhazcrea#4 = #cuacceso#15;
         #zhazcrea#5 = #cuacceso#16;
     |FINSI;
     |CIERRA #cuacceso;
|FPRC;

|PROCESO DatosContabilidad;
     |ABRE #sodacoca;
     #sodacoca#0 = #zhazcrea#0;
     #sodacoca#1 = #zhazcrea#1;
     |LEE 040#sodacoca.=;
     nError1 = FSalida;
     |SI FSalida = 0;
         |HAZ DatosCuentas;
     |FINSI;
     |CIERRA #sodacoca;
|FPRC;

|PROCESO PorXbrl;
     |HAZ VentanaTrabajo;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1 + "\";

     enEmpresa = #zhazcrea#0;
     enAnyo    = #zhazcrea#1;
     eaCampo3  = "N";
     eaCampo4  = "N";
     eaCampo5  = "N";
     eaCampo6  = "N";
     eaCampo7  = "N";
     eaCampo8  = "N";
     eaCampo9  = "N";
     eaCampo10 = "N";
     eaCampo11 = "P";
     eaCampo12 = "";

     |SUB_EJECUTA "zhazxbrl;AUTO";

     enAnyo = #zhazcrea#1;
     |HAZ EjecutaDSFDF;

     |HAZ FinVentanaTrabajo;

     aAlfa = eaDirTrabajo + "wcuenta.fdf";
     |XABRE "EC", aAlfa, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |DBASE aBase;  |QBF aBase;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #zhazcrea#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #zhazcrea#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaOrigen       = aAlfa;
     eaDestino      = eaDirGuarda + "wcuenta.fdf";
     |HAZ RecibeFichero;

     |RFBORRA eaOrigen;

     |ABRE #megwordc;
     #megwordc#0 = #zregdocu#0;
     #megwordc#1 = #zregdocu#1;
     |LEE 101#megwordc.=;
     |SI FSalida ! 0;
         |DDEFECTO #megwordc;
         #megwordc#0 = #zregdocu#0;
         #megwordc#1 = #zregdocu#1;
         |GRABA 020#megwordc.b;
     |FINSI;

     #megwordc#2 = #zregdocu#2;
     #megwordc#3 = #zregdocu#5;
     #megwordc#4 = #zregdocu#6;
     #megwordc#5 = #zregdocu#9;
     #megwordc#6 = #zregdocu#10;

     |GRABA 020#megwordc.a;
     |LIBERA #megwordc;
     |CIERRA #megwordc;

     |ABRE #megwordl;
     #megwordl#0 = #zregdocu#0;
     #megwordl#1 = #zregdocu#1;
     #megwordl#2 = "wcuenta.fdf";
     |LEE 101#megwordl.=;
     |SI FSalida ! 0;
         |DDEFECTO #megwordl;
         #megwordl#0 = #zregdocu#0;
         #megwordl#1 = #zregdocu#1;
         #megwordl#2 = "wcuenta.fdf";
         |GRABA 020#megwordl.b;
     |FINSI;

     #megwordl#3 = "CUENTAS ANUALES";
     #megwordl#4 = ~;
     |HORA aHora;
     #megwordl#5 = aHora % 102;
     #megwordl#6 = aHora % 402;

     |GRABA 020#megwordl.a;
     |LIBERA #megwordl;
     |CIERRA #megwordl;

     #zregdocu#3 = "S";
|FPRC;

|PROCESO DistResultadosAnt;
     aAlfa = "Distribuci¢n de resultados ejercicio " + nNumer2;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |DBASE aMas;
     aMas = aMas + "def/zregdocu.mas";
     |CARGA_DEF aMas, imagen@;

     |ABRE #imagen@;
     #imagen@#0 = #zregdocu#0;
     #imagen@#1 = #zregdocu#1 - 1;
     |LEE 101#imagen@.=;
     |SI FSalida ! 0;
         |DDEFECTO #imagen@;
         #imagen@#0 = #zregdocu#0;
         #imagen@#1 = #zregdocu#1 - 1;
         #imagen@#2 = #zregdocu#2;
         |GRABA 020#imagen@.b;
     |FINSI;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 16;
           #zw000001#nCampoD# = #imagen@#nCampoH#;
           #zw000021#nCampoD# = #imagen@#nCampoH#;
     |SIGUE;
     #zw000021#12 = #zw000021#12 + #zw000021#6;
     #zw000021#6  = 0;

     |ABRE #cubal802;
     |SELECT #3#cubal802;
     #cubal802#0  = #zhazcrea#0;
     #cubal802#1  = #zhazcrea#1 - 1;
     #cubal802#16 = 49500;
     |LEE 000#cubal802.=;
     |SI FSalida ! 0;  |DDEFECTO #cubal802;  |FINSI;
     |CIERRA #cubal802;

     |SI #cubal802#7 > 0;
         #zw000001#0 = #cubal802#7;
         #zw000021#0 = #cubal802#7;
     |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |PINPA #0#zw000021;
         |PINDA #0#zw000021;
         |ENDATOS #1#zw000021;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #imagen@#nCampoH# = #zw000021#nCampoD#;
             |SIGUE;
         |FINSI;
     |SINO;
         |PINPA #0#zw000001;
         |PINDA #0#zw000001;
         |ENDATOS #1#zw000001;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #imagen@#nCampoH# = #zw000001#nCampoD#;
             |SIGUE;
         |FINSI;
     |FINSI;

     |GRABA 020#imagen@.a;
     |LIBERA #imagen@;
     |CIERRA #imagen@;

     |DESCARGA_DEF #imagen@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO DistResultados;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 16;
           #zw000001#nCampoD# = #zregdocu#nCampoH#;
           #zw000021#nCampoD# = #zregdocu#nCampoH#;
     |SIGUE;
     #zw000021#12 = #zw000021#12 + #zw000021#6;
     #zw000021#6  = 0;

     |ABRE #cubal802;
     |SELECT #3#cubal802;
     #cubal802#0  = #zhazcrea#0;
     #cubal802#1  = #zhazcrea#1;
     #cubal802#16 = 49500;
     |LEE 000#cubal802.=;
     |SI FSalida ! 0;  |DDEFECTO #cubal802;  |FINSI;
     |CIERRA #cubal802;

     |SI #cubal802#7 > 0;
         #zw000001#0 = #cubal802#7;
         #zw000021#0 = #cubal802#7;
     |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |PINPA #0#zw000021;
         |PINDA #0#zw000021;
         |ENDATOS #1#zw000021;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #zregdocu#nCampoH# = #zw000021#nCampoD#;
             |SIGUE;
         |FINSI;
     |SINO;
         |PINPA #0#zw000001;
         |PINDA #0#zw000001;
         |ENDATOS #1#zw000001;
         |SI FSalida = 0;
             |PARA nCampoD = 0;  |SI nCampoD [ 13;  |HACIENDO nCampoD = nCampoD + 1;
                   nCampoH   = nCampoD + 16;
                   #zregdocu#nCampoH# = #zw000001#nCampoD#;
             |SIGUE;
         |FINSI;
     |FINSI;
     #zregdocu#13 = #zhazcrea#10;
     #zregdocu#12 = #zhazcrea#9;
     #zregdocu#68 = #zhazcrea#11;
     #zregdocu#69 = #zhazcrea#15;
     #zregdocu#15 = #zhazcrea#16;
     #zregdocu#81 = #zhazcrea#17;
     #zregdocu#84 = #zhazcrea#18;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |PULSATECLA;
|FPRC;

|PROCESO DistResultadosAntCoop;
     aAlfa = "Distribuci¢n de resultados ejercicio " + nNumer2;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     |DBASE aMas;
     aMas = aMas + "def/zregdocu.mas";
     |CARGA_DEF aMas, imagen@;

     |ABRE #imagen@;
     #imagen@#0 = #zregdocu#0;
     #imagen@#1 = #zregdocu#1 - 1;
     |LEE 101#imagen@.=;
     |SI FSalida ! 0;
         |DDEFECTO #imagen@;
         #imagen@#0 = #zregdocu#0;
         #imagen@#1 = #zregdocu#1 - 1;
         #imagen@#2 = #zregdocu#2;
         |GRABA 020#imagen@.b;
     |FINSI;

     nSuma = #imagen@#70 + #imagen@#71 + #imagen@#72 + #imagen@#73;
     nSuma = nSuma + #imagen@#74 + #imagen@#75 + #imagen@#76 + #imagen@#77 + #imagen@#78;
     |SI nSuma = 0;
         #imagen@#70 = #imagen@#21;
         #imagen@#71 = #imagen@#24;
         #imagen@#73 = #imagen@#25;
         #imagen@#74 = #imagen@#26;
         #imagen@#76 = #imagen@#22 + #imagen@#23 + #imagen@#27 + #imagen@#28;
         #imagen@#78 = #imagen@#70 + #imagen@#71 + #imagen@#72 + #imagen@#73;
         #imagen@#78 = #imagen@#78 + #imagen@#74 + #imagen@#75 + #imagen@#76 + #imagen@#77;
     |FINSI;

     #zw000016#0  = #imagen@#16;
     #zw000016#1  = #imagen@#17;
     #zw000016#2  = #imagen@#18;
     #zw000016#3  = #imagen@#19;
     #zw000016#4  = #imagen@#20;
     #zw000016#5  = #imagen@#70;
     #zw000016#6  = #imagen@#71;
     #zw000016#7  = #imagen@#72;
     #zw000016#8  = #imagen@#73;
     #zw000016#9  = #imagen@#74;
     #zw000016#10 = #imagen@#75;
     #zw000016#11 = #imagen@#76;
     #zw000016#12 = #imagen@#77;
     #zw000016#13 = #imagen@#78;

     |ABRE #cubal802;
     |SELECT #3#cubal802;
     #cubal802#0  = #zhazcrea#0;
     #cubal802#1  = #zhazcrea#1 - 1;
     #cubal802#16 = 49500;
     |LEE 000#cubal802.=;
     |SI FSalida ! 0;  |DDEFECTO #cubal802;  |FINSI;
     |CIERRA #cubal802;

     |SI #cubal802#7 > 0;
         #zw000016#0 = #cubal802#7;
     |FINSI;

     |PINPA #0#zw000016;
     |PINDA #0#zw000016;
     |ENDATOS #1#zw000016;
     |SI FSalida = 0;
         #imagen@#16 = #zw000016#0;
         #imagen@#17 = #zw000016#1;
         #imagen@#18 = #zw000016#2;
         #imagen@#19 = #zw000016#3;
         #imagen@#20 = #zw000016#4;
         #imagen@#70 = #zw000016#5;
         #imagen@#71 = #zw000016#6;
         #imagen@#72 = #zw000016#7;
         #imagen@#73 = #zw000016#8;
         #imagen@#74 = #zw000016#9;
         #imagen@#75 = #zw000016#10;
         #imagen@#76 = #zw000016#11;
         #imagen@#77 = #zw000016#12;
         #imagen@#78 = #zw000016#13;
     |FINSI;

     |GRABA 020#imagen@.a;
     |LIBERA #imagen@;
     |CIERRA #imagen@;

     |DESCARGA_DEF #imagen@;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;

     |PULSATECLA;
|FPRC;

|PROCESO DistResultadosCoop;
     |VENTANA 1001, 2399, -1, 16, "Distribuci¢n de resultados";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802; |PAUSA;

     #zw000016#0  = #zregdocu#16;
     #zw000016#1  = #zregdocu#17;
     #zw000016#2  = #zregdocu#18;
     #zw000016#3  = #zregdocu#19;
     #zw000016#4  = #zregdocu#20;
     #zw000016#5  = #zregdocu#70;
     #zw000016#6  = #zregdocu#71;
     #zw000016#7  = #zregdocu#72;
     #zw000016#8  = #zregdocu#73;
     #zw000016#9  = #zregdocu#74;
     #zw000016#10 = #zregdocu#75;
     #zw000016#11 = #zregdocu#76;
     #zw000016#12 = #zregdocu#77;
     #zw000016#13 = #zregdocu#78;

     |ABRE #cubal802;
     |SELECT #3#cubal802;
     #cubal802#0  = #zhazcrea#0;
     #cubal802#1  = #zhazcrea#1;
     #cubal802#16 = 49500;
     |LEE 000#cubal802.=;
     |SI FSalida ! 0;  |DDEFECTO #cubal802;  |FINSI;
     |CIERRA #cubal802;

     |SI #cubal802#7 > 0;
         #zw000016#0 = #cubal802#7;
     |FINSI;

     |PINPA #0#zw000016;
     |PINDA #0#zw000016;
     |ENDATOS #1#zw000016;
     |SI FSalida = 0;
         #zregdocu#16 = #zw000016#0;
         #zregdocu#17 = #zw000016#1;
         #zregdocu#18 = #zw000016#2;
         #zregdocu#19 = #zw000016#3;
         #zregdocu#20 = #zw000016#4;
         #zregdocu#70 = #zw000016#5;
         #zregdocu#71 = #zw000016#6;
         #zregdocu#72 = #zw000016#7;
         #zregdocu#73 = #zw000016#8;
         #zregdocu#74 = #zw000016#9;
         #zregdocu#75 = #zw000016#10;
         #zregdocu#76 = #zw000016#11;
         #zregdocu#77 = #zw000016#12;
         #zregdocu#78 = #zw000016#13;
     |FINSI;

     #zregdocu#13 = #zhazcrea#10;
     #zregdocu#12 = #zhazcrea#9;
     #zregdocu#68 = #zhazcrea#11;
     #zregdocu#69 = #zhazcrea#15;
     #zregdocu#15 = #zhazcrea#16;
     #zregdocu#81 = #zhazcrea#17;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO CreaDeposito;
     |SI enMensa = 0;
         |CONFI "0000SVamos a crear los datos en el Registro Digital. Continuar";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         FSalida = 0;

         |SI #zregdocu#4 = "N";  |Y #zregdocu#8 = "N";
             |CONFI "0000NNo est  creado la Memoria ni el Informe de Gesti¢n. Continuar";
         |SINO;
             |SI #zregdocu#4 = "N";
                 |CONFI "0000NNo est  creado la Memoria. Continuar";
             |FINSI;

             |SI #zregdocu#8 = "N";
                 |CONFI "0000NNo est  creado el Informe de Gesti¢n. Continuar";
             |FINSI;
         |FINSI;

         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     |HAZ VentanaTrabajo;

     |SI #zregdocu#4 = "S";
         |HAZ MemoriaPDF;
     |FINSI;

     |SI #zregdocu#8 = "S";
         |HAZ GestionPDF;
     |FINSI;

     enEmpresa = #zhazcrea#0;
     enAnyo    = #zhazcrea#1;
     eaCampo3  = "N";
     eaCampo4  = "N";
     eaCampo5  = "N";
     eaCampo6  = "N";
     eaCampo7  = "N";
     eaCampo8  = "N";
     eaCampo9  = "N";
     eaCampo10 = "N";
     eaCampo11 = "S";
     eaCampo12 = #zregubic#3;

     |ABRE #maempr01;
     #maempr01#0 = #zhazcrea#0;
     #maempr01#1 = #zhazcrea#1;
     |LEE 101#maempr01.=;
     |SI FSalida = 0;
         #maempr01#90 = #zhazcrea#7 - 1;
         |SI #zregdocu#4 = "S";  #maempr01#90 = #zregdocu#6;   |FINSI;
         |SI #zregdocu#8 = "S";  #maempr01#90 = #zregdocu#10;  |FINSI;
         |GRABA 020#maempr01.a;
         |LIBERA #maempr01;
     |FINSI;
     |CIERRA #maempr01;

     |SUB_EJECUTA "zhazxbrl;AUTO";

     |HAZ FinVentanaTrabajo;

     #zregdocu#14 = "S";
     #zregdocu#13 = #zhazcrea#10;
     #zregdocu#12 = #zhazcrea#9;
     #zhazcrea#11 = "S";
     #zregdocu#68 = #zhazcrea#11;
     #zregdocu#69 = #zhazcrea#15;
     #zregdocu#15 = #zhazcrea#16;
     #zregdocu#81 = #zhazcrea#17;
|FPRC;

|PROCESO zregfirm;
     |BORRA 020#zregfirm.a;
     |LIBERA #zregfirm;
|FPRC;

|DEFBUCLE zregfirm;
     #zregfirm#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 01;
     #zhazcrea#0, #zhazcrea#1, 99;
     be;
     NULL, zregfirm;
|FIN;

|PROCESO zregasis;
     |BORRA 020#zregasis.a;
     |LIBERA #zregasis;
|FPRC;

|DEFBUCLE zregasis;
     #zregasis#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     be;
     NULL, zregasis;
|FIN;

|PROCESO PonCargo;
                             #zregfirm#9 = "ADMINISTRADOR";
     |SI #agim0026#16 = 1;   #zregfirm#9 = "PRESIDENTE";     |FINSI;
     |SI #agim0026#16 = 3;   #zregfirm#9 = "SECRETARIO";     |FINSI;
|FPRC;

|PROCESO agim0026;
     |SI nChequeo = 1;
         |SI nTipo = 1;
             aDni   = #agim0026#3;
             aPresi = #agim0026#4;  |QBF aPresi;
             |SI aPresi ! "";
                 aPresi = "Don/Do¤a " + aPresi;
             |FINSI;
         |FINSI;

         |ERROR10;
         |ACABA;
     |FINSI;

     |SI nTipo = 1;  |Y #zhazcrea#10 = 10;
         |ABRE #zregfirm;
         #zregfirm#0   = #zhazcrea#0;
         #zregfirm#1   = #zhazcrea#1;
         #zregfirm#2   = 1;
         #zregfirm#3   = #agim0026#3;
         #zregfirm#4   = "Don/Do¤a " + #agim0026#4;
         #zregfirm#5   = #agim0026#5;
         #zregfirm#6   = #agim0026#6;
         #zregfirm#7   = #agim0026#9;
         #zregfirm#8   = "U";
         |HAZ PonCargo;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;
         |CIERRA #zregfirm;

         |ERROR10;
         |ACABA;
     |FINSI;

     nContador = nContador + 1;

     |SI #agim0026#16 = 3;
         #zregdocu#30 = "Secretario";
     |FINSI;

     |SI #agim0026#13 = "U";
         #zregfirm#0   = #zhazcrea#0;
         #zregfirm#1   = #zhazcrea#1;
         #zregfirm#2   = nContador;
         #zregfirm#3   = #agim0026#3;
         #zregfirm#4   = "Don/Do¤a " +  #agim0026#4;
         #zregfirm#5   = #agim0026#5;
         #zregfirm#6   = #agim0026#6;
         #zregfirm#7   = #agim0026#9;
         #zregfirm#8   = #agim0026#13;
         |HAZ PonCargo;

         aNif1    = #agim0026#3;
         aNombre1 = #agim0026#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30  = "Administrador £nico";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #agim0026#13 = "S";
         #zregfirm#0   = #zhazcrea#0;
         #zregfirm#1   = #zhazcrea#1;
         #zregfirm#2   = nContador;
         #zregfirm#3   = #agim0026#3;
         #zregfirm#4   = "Don/Do¤a " +  #agim0026#4;
         #zregfirm#5   = #agim0026#5;
         #zregfirm#6   = #agim0026#6;
         #zregfirm#7   = #agim0026#9;
         #zregfirm#8   = #agim0026#13;
         |HAZ PonCargo;

         aNif1    = #agim0026#3;
         aNombre1 = #agim0026#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30 = "Administrador solidario";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #agim0026#13 = "C";
         #zregfirm#0 = #zhazcrea#0;
         #zregfirm#1 = #zhazcrea#1;
         #zregfirm#2 = nContador;
         #zregfirm#3 = #agim0026#3;
         |SI nContador = 1;
             #zregfirm#4     = "Sres./as. " +  #agim0026#4;

             aNif1    = #agim0026#3;
             aNombre1 = #agim0026#4;   |QBF aNombre1;
             |SI aNombre1 ! "";
                aNombre1 = "Don/Do¤a " + aNombre1;
             |FINSI;
         |SINO;
             #zregfirm#4   = #agim0026#4;
         |FINSI;
         #zregfirm#5   = #agim0026#5;
         #zregfirm#6   = #agim0026#6;
         #zregfirm#7   = #agim0026#9;
         #zregfirm#8   = #agim0026#13;
         |HAZ PonCargo;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30 = "Administradores mancomunados";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0026;
     #agim0026#1;
     16, 13;
     #agim0019#0, #agim0019#1, 01, nTipo, aDTipo;
     #agim0019#0, #agim0019#1, 99, nTipo, aHTipo;
     ;
     NULL, agim0026;
|FIN;

|PROCESO agim0026_2;
     aAlfa = #agim0026#17 < "";
     aAlfa = aAlfa - "interventor";
     |SI FSalida ! 0;
         aAlfa = #zregdocu#65;  |QBF aAlfa;
         |SI aAlfa = "";
             #zregdocu#64 = #agim0026#3;
             #zregdocu#65 = "Don/Do¤a " + #agim0026#4;
         |SINO;
             aAlfa = #zregdocu#67;  |QBF aAlfa;
             |SI aAlfa = "";
                 #zregdocu#66 = #agim0026#3;
                 #zregdocu#67 = "Don/Do¤a " + #agim0026#4;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0026_2;
     #agim0026#1;
     ;
     #agim0019#0, #agim0019#1, 01;
     #agim0019#0, #agim0019#1, 99;
     ;
     NULL, agim0026_2;
|FIN;

|PROCESO agim0024;
     nContador = nContador + 1;
     |SI #agim0024#18 = "U";
         #zregfirm#0  = #zhazcrea#0;
         #zregfirm#1  = #zhazcrea#1;
         #zregfirm#2   = nContador;
         #zregfirm#3   = #agim0024#3;
         #zregfirm#4   = "Don/Do¤a " +  #agim0024#4;
         #zregfirm#5   = #agim0024#7;
         #zregfirm#6   = #agim0024#8;
         #zregfirm#7   = #agim0024#11;
         #zregfirm#8   = #agim0024#18;
         #zregfirm#9   = "ADMINISTRADOR";

         aNif1    = #agim0024#3;
         aNombre1 = #agim0024#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30 = "Administrador £nico";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #agim0024#18 = "S";
         #zregfirm#0  = #zhazcrea#0;
         #zregfirm#1  = #zhazcrea#1;
         #zregfirm#2   = nContador;
         #zregfirm#3   = #agim0024#3;
         #zregfirm#4   = "Don/Do¤a " +  #agim0024#4;
         #zregfirm#5   = #agim0024#7;
         #zregfirm#6   = #agim0024#8;
         #zregfirm#7   = #agim0024#11;
         #zregfirm#8   = #agim0024#18;
         #zregfirm#9   = "ADMINISTRADOR";

         aNif1    = #agim0024#3;
         aNombre1 = #agim0024#4;   |QBF aNombre1;
         |SI aNombre1 ! "";
             aNombre1 = "Don/Do¤a " + aNombre1;
         |FINSI;
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30 = "Administrador solidario";
         |FINSI;

         |ERROR10;
     |FINSI;

     |SI #agim0024#18 = "C";
         #zregfirm#0  = #zhazcrea#0;
         #zregfirm#1  = #zhazcrea#1;
         #zregfirm#2  = nContador;
         #zregfirm#3 = #agim0024#3;
         |SI nContador = 1;
             #zregfirm#4   = "Sres./as. " +  #agim0024#4;

             aNif1    = #agim0024#3;
             aNombre1 = #agim0024#4;   |QBF aNombre1;
             |SI aNombre1 ! "";
                 aNombre1 = "Don/Do¤a " + aNombre1;
             |FINSI;
         |SINO;
             #zregfirm#4   = #agim0024#4;
         |FINSI;
         #zregfirm#5   = #agim0024#7;
         #zregfirm#6   = #agim0024#8;
         #zregfirm#7   = #agim0024#11;
         #zregfirm#8   = #agim0024#18;
         #zregfirm#9   = "ADMINISTRADOR";
         |GRABA 020#zregfirm.n;
         |LIBERA #zregfirm;

         aAlfa = #zregdocu#30;  |QBF aAlfa;
         |SI aAlfa ! "Secretario";
             #zregdocu#30 = "Administradores mancomunados";
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#1;
     15, 18;
     #agim0019#0, #agim0019#1, 01, "A", aTipo;
     #agim0019#0, #agim0019#1, 99, "D", aTipo;
     ;
     NULL, agim0024;
|FIN;

|PROCESO maempr02;
     #zregasis#0 = #maempr02#0;
     #zregasis#1 = #maempr02#1;
     #zregasis#2 = #maempr02#2;
     #zregasis#3 = #maempr02#3;
     #zregasis#4 = #maempr02#5;
     #zregasis#5 = #maempr02#8;

     |GRABA 020#zregasis.n;
     |LIBERA #zregasis;
|FPRC;

|DEFBUCLE maempr02;
     #maempr02#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, maempr02;
|FIN;

|PROCESO CargaAutomatica;
     |ABRE #zregfirm;
     #zregfirm#0 = #zhazcrea#0;
     #zregfirm#1 = #zhazcrea#1;
     #zregfirm#2 = 1;
     |LEE 000#zregfirm.];
     |SI FSalida = 0;  |Y  #zregfirm#0 = #zhazcrea#0;  |Y #zregfirm#1 = #zhazcrea#1;
         |SI enMensa = 0;
             |CONFI "0000NYa se ha hecho la carga autom tica, quiere realizarla de nuevo";
             |SI FSalida ! 0;
                 |CIERRA #zregfirm;
                 |ACABA;
             |FINSI;
         |SINO;
             |SI enSwRegraba = 0;
                 |CIERRA #zregfirm;
                 |ACABA;
             |FINSI;
         |FINSI;
     |FINSI;
     |CIERRA #zregfirm;

     |ABRE #maempr01;
     #maempr01#0 = #zhazcrea#0;
     #maempr01#1 = #zhazcrea#1;
     |LEE 040#maempr01.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr01;  |FINSI;
     |CIERRA #maempr01;

     |ABRE #agim0019;
     #agim0019#0 = #zhazcrea#0;
     #agim0019#1 = 99;
     |LEE 040#agim0019.];
     |SI FSalida = 0;
         |LEE 040#agim0019.a;
     |SINO;
         |LEE 040#agim0019.u;
     |FINSI;

     |SI FSalida ! 0;  |O #agim0019#0 ! #zhazcrea#0;
         |DDEFECTO #agim0019;
     |FINSI;
     |CIERRA #agim0019;

     #zregdocu#64 = "";
     #zregdocu#65 = "";
     #zregdocu#66 = "";
     #zregdocu#67 = "";
     aNombre1     = "";
     aNif1        = "";
     aPresi       = "";
     aDni         = "";

     |BUCLE zregfirm;
     |BUCLE zregasis;

     |ABRE #zregfirm;

     nChequeo = 0;
     |SI #zhazcrea#10 ! 10;  |Y #zhazcrea#10 ! 11;  |Y #zhazcrea#10 ! 12;
         nContador = 0;

                             aTipo = "U";  |BUCLE agim0024;
         |SI nContador = 0;  aTipo = "S";  |BUCLE agim0024;  |FINSI;
         |SI nContador = 0;  aTipo = "C";  |BUCLE agim0024;  |FINSI;

         |SI nContador = 0;
             nTipo = 3;   aDTipo  = " ";  aHTipo = "z"; |BUCLE agim0026;
             nTipo = 1;   aDTipo  = " ";  aHTipo = "z"; |BUCLE agim0026;

             |SI nContador = 0;
                 nTipo     = 7;
                                     aDTipo  = "U";  aHTipo = "U"; |BUCLE agim0026;
                 |SI nContador = 0;  aDTipo  = "S";  aHTipo = "S"; |BUCLE agim0026;  |FINSI;
                 |SI nContador = 0;  aDTipo  = "C";  aHTipo = "C"; |BUCLE agim0026;  |FINSI;
             |FINSI;

             |SI nContador = 0;
                 #zregfirm#0   = #zhazcrea#0;
                 #zregfirm#1   = #zhazcrea#1;
                 #zregfirm#2   = 1;
                 #zregfirm#3   = #maempr01#78;
                 #zregfirm#4   = "Don/Do¤a " + #maempr01#77;
                 #zregfirm#5   = #maempr01#79;
                 #zregfirm#6   = #maempr01#80;
                 #zregfirm#7   = #maempr01#81;
                 #zregfirm#8   = "U";
                 #zregfirm#9   = "SECRETARIO";

                 aNombre1 = #maempr01#77;   |QBF aNombre1;
                 |SI aNombre1 ! "";
                     aNombre1 = "Don/Do¤a " + aNombre1;
                 |FINSI;
                 aNif1    = #maempr01#78;
                 |GRABA 020#zregfirm.n;
                 |LIBERA #zregfirm;

                 #zregdocu#30  = "Secretario";
             |FINSI;
         |FINSI;
     |SINO;
        #zregfirm#0 = #zhazcrea#0;
        #zregfirm#1 = #zhazcrea#1;
        #zregfirm#2 = 2;
        #zregfirm#3 = #maempr01#78;
        #zregfirm#4 = "Don/Do¤a " + #maempr01#77;
        #zregfirm#5 = #maempr01#79;
        #zregfirm#6 = #maempr01#80;
        #zregfirm#7 = #maempr01#81;
        #zregfirm#8 = "U";
        #zregfirm#9 = "SECRETARIO";
        aNombre1 = #maempr01#77;   |QBF aNombre1;
        |SI aNombre1 ! "";
            aNombre1 = "Don/Do¤a " + aNombre1;
        |FINSI;
        aNif1    = #maempr01#78;
        |GRABA 020#zregfirm.n;
        |LIBERA #zregfirm;

        #zregdocu#30  = "Secretario";
     |FINSI;
     |CIERRA #zregfirm;

     aAlfa1 = #maempr01#13;                                |QBF aAlfa1;
     aAlfa1 = aAlfa1 + ", " + #maempr01#4 + " " + #maempr01#5;  |QBF aAlfa1;
     aAlfa1 = aAlfa1 + ", n£mero " + #maempr01#6;          |QBF aAlfa1;
     #zregdocu#31  = aAlfa1 % 150;
     #zregdocu#32  = aAlfa1 % 5150;

     aDTipo     = " ";
     aHTipo     = "z";
     nChequeo   = 1;
     nTipo      = 1;   |BUCLE agim0026;

     |SI aPresi ! "";
         #zregdocu#33  = aDni;
         #zregdocu#34  = aPresi;
     |SINO;
         #zregdocu#33  = aNif1;
         #zregdocu#34  = aNombre1;
     |FINSI;

     #zregdocu#35 = #maempr01#78;

     aAlfa = #maempr01#77;   |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = "Don/Do¤a " + aAlfa;
     |FINSI;
     #zregdocu#36 = aAlfa;

     #zregdocu#49 = #zregdocu#33;
     #zregdocu#50 = #zregdocu#34;
     #zregdocu#51 = #zregdocu#35;
     #zregdocu#52 = #zregdocu#36;

     |SI #maempr01#32 ! "          ";
         eaAlfa = #maempr01#32;
         |HAZ SacaFecha;
         #zregdocu#37 = eaAlfa;
     |SINO;
         #zregdocu#37 = "31 de Diciembre de " + #zhazcrea#1;
     |FINSI;

     |SI #maempr01#33 ! "          ";
         eaAlfa = #maempr01#33;
         |HAZ SacaFecha;
         #zregdocu#40  = eaAlfa;
     |SINO;
         nNume  = #zhazcrea#1 + 1;
         #zregdocu#40  = "30 de Marzo de " + nNume;
     |FINSI;

     |SI #maempr01#83 ! "          ";
         eaAlfa = #maempr01#83;
         |HAZ SacaFecha;
         #zregdocu#81 = #maempr01#83;
         #zhazcrea#17 = #maempr01#83;
         #zregdocu#41 = eaAlfa;
     |SINO;
         nNume  = #zhazcrea#1 + 1;
         #zregdocu#41  = "30 de Junio de " + nNume;
     |FINSI;

     #zregdocu#53 = #agim0019#25;
     #zregdocu#54 = #agim0019#59;

     |SI #zhazcrea#10 ! 10;  |Y #zhazcrea#10 ! 11;  |Y #zhazcrea#10 ! 12;
         #zregdocu#42 = "TODOS";
         #zregdocu#43 = 100;
         #zregdocu#44 = 0;
         #zregdocu#45 = 100;
         #zregdocu#46 = "MAYORIA";
         #zregdocu#47 = 100;
         #zregdocu#48 = "   de            de ";
     |SINO;
         #zregdocu#48 = #zregdocu#41;
     |FINSI;

     |BUCLE agim0026_2;

     #zregdocu#38 = 1;
     |SI #zregdocu#6  ! 0;  #zregdocu#39 = #zregdocu#6;   |FINSI;
     |SI #zregdocu#10 ! 0;  #zregdocu#39 = #zregdocu#10;  |FINSI;

     |SI enMensa = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH     = nCampoD + 30;
               |SI nPantalla = 902;  #zw000002#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
               |SI nPantalla = 903;  #zw000003#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
               |SI nPantalla = 904;  #zw000004#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
               |SI nPantalla = 905;  #zw000005#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
         |SIGUE;

         |SI nPantalla = 902;  |PINDA #0#zw000002;  |FINSI;
         |SI nPantalla = 903;  |PINDA #0#zw000003;  |FINSI;
         |SI nPantalla = 904;  |PINDA #0#zw000004;  |FINSI;
         |SI nPantalla = 905;  |PINDA #0#zw000005;  |FINSI;
     |FINSI;

     |SI #zhazcrea#10 ! 8;
         aAlfa  = #maempr01#3 % 101;
         |SI aAlfa = "B";
             |ABRE #zregasis;
             |BUCLE maempr02;
             |CIERRA #zregasis;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PresentaCertificado;
     |SI nPantalla ! 905;
          |VENTANA 0501, 2799, -1, 16, "Datos certificado";
     |SINO;
          |VENTANA 0501, 3099, -1, 16, "Datos certificado";
     |FINSI;
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
           nCampoH     = nCampoD + 30;
           |SI nPantalla = 902;  #zw000002#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
           |SI nPantalla = 903;  #zw000003#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
           |SI nPantalla = 904;  #zw000004#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
           |SI nPantalla = 905;  #zw000005#nCampoD# = #zregdocu#nCampoH#;  |FINSI;
     |SIGUE;

     |SI nPantalla = 905;
         #zw000005#43 = #zregdocu#82;
         #zw000005#44 = #zregdocu#83;
         #zw000005#38 = #zw000005#25 + #zw000005#26;
         #zw000005#39 = #zw000005#27 + #zw000005#28;
         #zw000005#40 = #zw000005#29 + #zw000005#30;
         #zw000005#41 = #zw000005#31;
         #zw000005#42 = #zw000005#32 + #zw000005#33;
     |FINSI;

     |SI nPantalla ! 905;
         |CONTROL_SIMPLE 0, "BOTON,{{197}} Carga automatica", 2702, 2720, CargaAutomatica;
     |SINO;
         |CONTROL_SIMPLE 0, "BOTON,{{197}} Carga automatica", 3002, 3020, CargaAutomatica;
     |FINSI;
     nBtnCarga = FSalida;

     |SI nPantalla = 902;  |PINPA #0#zw000002;  |PINDA #0#zw000002;  |ENDATOS #1#zw000002;  |FINSI;
     |SI nPantalla = 903;  |PINPA #0#zw000003;  |PINDA #0#zw000003;  |ENDATOS #1#zw000003;  |FINSI;
     |SI nPantalla = 904;  |PINPA #0#zw000004;  |PINDA #0#zw000004;  |ENDATOS #1#zw000004;  |FINSI;
     |SI nPantalla = 905;  |PINPA #0#zw000005;  |PINDA #0#zw000005;  |ENDATOS #1#zw000005;  |FINSI;
     |SI FSalida = 0;
         |PARA nCampoD = 0;  |SI nCampoD [ 37;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 30;
               |SI nPantalla = 902;  #zregdocu#nCampoH# = #zw000002#nCampoD#;  |FINSI;
               |SI nPantalla = 903;  #zregdocu#nCampoH# = #zw000003#nCampoD#;  |FINSI;
               |SI nPantalla = 904;  #zregdocu#nCampoH# = #zw000004#nCampoD#;  |FINSI;
               |SI nPantalla = 905;  #zregdocu#nCampoH# = #zw000005#nCampoD#;  |FINSI;
         |SIGUE;
         |SI nPantalla = 905;
             #zregdocu#82 = #zw000005#43;
             #zregdocu#83 = #zw000005#44;
         |FINSI;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FIN_CONTROL_WINDOWS nBtnCarga;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO DatosCertificado;
     |SI #zregdocu#6  ! 0;  nNume = #zregdocu#6;   |FINSI;
     |SI #zregdocu#10 ! 0;  nNume = #zregdocu#10;  |FINSI;
     |SI #zregdocu#11 = "S";  |Y enMensa = 0;
         |SI nNume ! #zregdocu#39;
             |CONFI "0000SSe ha modificado el total de p ginas en las cuentas anuales. Modifique el Certificado. Actualizar Campo S/N";
             |SI FSalida = 0;
                 #zregdocu#39 = nNume;
             |FINSI;
         |FINSI;
     |SINO;
          #zregdocu#39 = nNume;
     |FINSI;

     |SI #zhazcrea#10 = 1;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 2;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 3;   nPantalla = 902;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 4;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 5;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 6;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 7;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 8;   nPantalla = 904;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 9;   nPantalla = 903;  |HAZ PresentaCertificado;  |FINSI;
     |SI #zhazcrea#10 = 10;  nPantalla = 905;  |HAZ PresentaCertificado;  |FINSI;

     #zregdocu#13 = #zhazcrea#10;
     #zregdocu#12 = #zhazcrea#9;
     #zregdocu#68 = #zhazcrea#11;
     #zregdocu#69 = #zhazcrea#15;
     #zregdocu#15 = #zhazcrea#16;
     #zregdocu#81 = #zhazcrea#17;
|FPRC;

|PROCESO ActuaAutomatica;
     |ABRE #zregfirm;
     #zregfirm#0 = #zhazcrea#0;
     #zregfirm#1 = #zhazcrea#1;
     #zregfirm#2 = 1;
     |LEE 000#zregfirm.];
     |SI FSalida ! 0;  |O  #zregfirm#0 ! #zhazcrea#0;  |O #zregfirm#1 ! #zhazcrea#1;
         |HAZ CargaAutomatica;
     |FINSI;
     |CIERRA #zregfirm;
|FPRC;

|PROCESO ActuaMaempr01;
     |SI #zregdocu#81 ! #zhazcrea#17;
         #zregdocu#81 = #zhazcrea#17;
         |ABRE #maempr01;
         #maempr01#0 = #zhazcrea#0;
         #maempr01#1 = #zhazcrea#1;
         |LEE 141#maempr01.=;
         |SI FSalida = 0;
             #maempr01#83 = #zregdocu#81;
             |GRABA 020#maempr01.a;
         |FINSI;
         |LIBERA #maempr01;
         |CIERRA #maempr01;
     |FINSI;
|FPRC;

|PROCESO FirmaCertificado;
     |ABRE #zregfirm;
     #zregfirm#0 = #zhazcrea#0;
     #zregfirm#1 = #zhazcrea#1;
     #zregfirm#2 = 1;
     |LEE 000#zregfirm.];
     |SI FSalida ! 0;  |O  #zregfirm#0 ! #zhazcrea#0;  |O #zregfirm#1 ! #zhazcrea#1;
         |HAZ CargaAutomatica;
     |FINSI;
     |CIERRA #zregfirm;

     |VENTANA 0501, 0501, -1, -1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enEmpresa = #zhazcrea#0;
     enAnyo    = #zhazcrea#1;
     |SUB_EJECUTA "zregfirm";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
     |PULSATECLA;
|FPRC;

|PROCESO AsistentesActa;
     |ABRE #zregasis;
     #zregasis#0 = #zhazcrea#0;
     #zregasis#1 = #zhazcrea#1;
     #zregasis#2 = 1;
     |LEE 000#zregasis.];
     |SI FSalida ! 0;  |O  #zregasis#0 ! #zhazcrea#0;  |O #zregasis#1 ! #zhazcrea#1;
         |BUCLE maempr02;
     |FINSI;
     |CIERRA #zregasis;

     |VENTANA 0501, 0501, -1, -1, "";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enEmpresa = #zhazcrea#0;
     enAnyo    = #zhazcrea#1;
     |SUB_EJECUTA "zregasis";

     |PULSATECLA;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n2Vent;
     |PULSATECLA;
|FPRC;

|PROCESO VisualizaDeposito;
     |HAZ VentanaTrabajo;

     aAlfa = "cmd " + &34 + "/c START /WAIT " + #zregubic#2;  |QBF aAlfa;
     aAlfa = aAlfa + &34;
     |RSYSTEM aAlfa;

     |HAZ FinVentanaTrabajo;
|FPRC;

|PROCESO LeeBalanceD;
    |ABRE #maempr01;
    #maempr01#0 = #zhazcrea#0;
    #maempr01#1 = #zhazcrea#1;
    |LEE 041#maempr01.=;
    |SI FSalida = 0;
        #cuacceso#15 = #maempr01#101;
        #cuacceso#16 = #maempr01#102;
    |SINO;
        #cuacceso#15 = #agim0019#87;
        #cuacceso#16 = #agim0019#88;
    |FINSI;
    |CIERRA #maempr01;
|FPRC;

|PROCESO LeeBalance;
     |ABRE #ca8m0000;
     #ca8m0000#0 = #zhazcrea#4;
     |LEE 000#ca8m0000.=;
     enTBal = #ca8m0000#2;
     |CIERRA #ca8m0000

     #zhazcrea#13 = #ca8m0000#1;
|FPRC;

|PROCESO LeeResultados;
     |ABRE #ca8m0000;
     #ca8m0000#0 = #zhazcrea#5;
     |LEE 001#ca8m0000.=;
     enTCta = #ca8m0000#2;
     |CIERRA #ca8m0000

     #zhazcrea#14 = #ca8m0000#1;
|FPRC;

|PROCESO LeePlanCble; |TIPO 0;
     eNum2008 = #zhazcrea#3;
     |ABRE #ca8comay;
     #ca8comay#0 = #zhazcrea#3;
     |LEE 041#ca8comay.=;
     eTip2008 = #ca8comay#3;
     |CIERRA #ca8comay;

     #zhazcrea#12 = #ca8comay#1;
|FPRC;

|PROCESO DuplicaEmpresa;
     enEmpresa = #zhazcrea#0;
     enAnyo    = #zhazcrea#1;

     aPopup1  = 0;
     aPopup2  = 2;
     aPopup3  = "1.- Duplicar del ejercicio anterior";
     aPopup4  = "2.- De la ficha de sociedades";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;
         |SI aAlfa = "1";  |SUB_EJECUTA "maempr08";  |FINSI;
         |SI aAlfa = "2";  |SUB_EJECUTA "z0000010";  |FINSI;
     |FINSI;

     #maacceso#0 = #zhazcrea#0;
     #maacceso#1 = #zhazcrea#1;
     |LEE 040#maacceso.=;
     |SI FSalida ! 0;
          nError = 1;
     |FINSI;
|FPRC;

|PROCESO LeeEmpresa;
     #zregdocu#0 = #zhazcrea#0;
     #zregdocu#1 = #zhazcrea#1;
     |LEE 000#zregdocu.=;
     |SI FSalida = 0;
         |MENAV  "0000La empresa ya ha sido abierta.";
         nError = 1;
         |ACABA;
     |FINSI;

     |ABRE #agim0028;
     #agim0028#0 = #zhazcrea#0;
     |LEE 040#agim0028.=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa en la Ficha de Sociedades";
         nError = 1;
         |CIERRA #agim0028;
         |ACABA;
     |FINSI;
     |CIERRA #agim0028;

     #zhazcrea#2 = #agim0028#2;

     enEmpresa     = #zhazcrea#0;
     aAlfa         = "01.01." + #zhazcrea#1;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;

     |SI enError = 1;
         |CONFI "0000NEmpresa INACTIVA. Continuar.";
         |SI FSalida ! 0;
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enError = 2;
         aAlfa = "0000NEmpresa con fecha disolucion " + fFechaDisol + ". Continuar.";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             nError = 1;
             |ACABA;
         |FINSI;
     |FINSI;

     |ABRE #maacceso;
     #maacceso#0 = #zhazcrea#0;
     #maacceso#1 = #zhazcrea#1;
     |LEE 040#maacceso.=;
     |SI FSalida ! 0;
         |MENAV  "      No existe Empresa con el Ejercicio seleccionado";
         |CONFI "2400NDesea crearla";
         |SI FSalida = 0;
             |HAZ DuplicaEmpresa;
         |SINO;
             nError = 1;
         |FINSI;
     |FINSI;
     |CIERRA #maacceso;
|FPRC;

|PROCESO CogeDistrIS;
      |ABRE #isom0000;
      #isom0000#0 = #zhazcrea#0;
      #isom0000#1 = #zhazcrea#1;
      |LEE 041#isom0000.=;
      |SI FSalida = 0;
          #zregdocu#16 = #isom0000#84;
          #zregdocu#17 = #isom0000#85;
          #zregdocu#18 = #isom0000#86;
          #zregdocu#19 = #isom0000#87;
          #zregdocu#20 = #isom0000#88;

          #zregdocu#21 = #isom0000#89;
          #zregdocu#22 = #isom0000#90;
          #zregdocu#23 = #isom0000#91;
          #zregdocu#24 = #isom0000#92;
          #zregdocu#25 = #isom0000#94 + #isom0000#95;
          #zregdocu#26 = #isom0000#104;
          #zregdocu#27 = #isom0000#102;
          #zregdocu#28 = #isom0000#93 + #isom0000#96  + #isom0000#97  + #isom0000#98  + #isom0000#99;
          #zregdocu#28 = #zregdocu#28 + #isom0000#100 + #isom0000#101 + #isom0000#103 + #isom0000#125 + #isom0000#126;
          #zregdocu#29 = #isom0000#105;
      |FINSI;
      |LIBERA #isom0000;
      |CIERRA #isom0000;
|FPRC;

|PROCESO CogeDistrISCoop;
      |ABRE #isom0000;
      #isom0000#0 = #zhazcrea#0;
      #isom0000#1 = #zhazcrea#1;
      |LEE 041#isom0000.=;
      |SI FSalida = 0;
          #zregdocu#16 = #isom0000#84;
          #zregdocu#17 = #isom0000#85;
          #zregdocu#18 = #isom0000#86;
          #zregdocu#19 = #isom0000#87;
          #zregdocu#20 = #isom0000#88;

          #zregdocu#21 = #isom0000#97;
          #zregdocu#22 = #isom0000#92;
          #zregdocu#23 = #isom0000#91;
          #zregdocu#24 = #isom0000#98;
          #zregdocu#25 = #isom0000#104;
          #zregdocu#26 = #isom0000#103;
          #zregdocu#27 = #isom0000#102;
          #zregdocu#29 = #isom0000#105;
      |FINSI;
      |LIBERA #isom0000;
      |CIERRA #isom0000;
|FPRC;

|PROCESO PonColor;
     #zregdocu#79 = "";

     |ABRE #sodacoca;
     #sodacoca#0 = #zregdocu#0;
     #sodacoca#1 = #zregdocu#1;
     |LEE 000#sodacoca.=;
     nError1 = FSalida;
     |CIERRA #sodacoca;

     |ABRE #cuacceso;
     #cuacceso#0 = #zregdocu#0;
     #cuacceso#1 = #zregdocu#1;
     |LEE 000#cuacceso.=;
     nError2 = FSalida;
     |CIERRA #cuacceso;

     |SI nError1 ! 0;  |ACABA;  |FINSI;
     |SI nError2 ! 0;  |ACABA;  |FINSI;

     |SI #zregdocu#4 = "N";
         #zregdocu#79 = eaRojo;
     |FINSI;

     |SI #zregdocu#3 = "N";  |Y #zregdocu#14 = "N";
         #zregdocu#79 = eaRojo;
     |FINSI;

     |SI #zregdocu#3 = "S";  |O #zregdocu#14 = "S";
         #zregdocu#79 = eaAzul;

         |SI #zregdocu#11 = "S";
             #zregdocu#79 = eaVerde;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO TraeConta;
     aAlfa = #zhazcrea#1;
     aAlfa = aAlfa % -102;

     |ABRE #canempre;
     |SELECT #4#canempre;

     perio = -1;
     #canempre#2  = #zhazcrea#0;
     #canempre#26 = aAlfa;
     |LEE 000#canempre.=;
     |SI FSalida = 0; perio = #canempre#3;  |FINSI;
     |CIERRA #canempre;

     |SI perio = -1;
         |MENAV "0000 No existe la contabilidad de la empresa.";
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     empAlta = empresa;
     empre   = #zhazcrea#0;
     plani   = 1;
     siono   = "SI";
     |SUB_EJECUTA "soagico1;AUTO";

     |HAZ FinVentanaTrabajo;

     |SI enHay129 = 1;
         |MENAV "0000La Cta 129 tiene Saldo. Debe hacer la Distribucion Resultado antes del pase al Impuesto";
         |ACABA;
     |FINSI;

     |HAZ DatosContabilidad;
     |SI nError1 = 0;
         |MENAV "0000 Generados datos de contabilidad";
     |FINSI;

     nContinua = 1;
     |PTEC 807;
|FPRC;

|PROCESO MeteEstructura;
     |VENTANA 0501, 1199, -1, 16, "Estructuras";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #zw000007#0  = #zhazcrea#3;
     #zw000007#1  = #zhazcrea#4;
     #zw000007#2  = #zhazcrea#5;
     #zw000007#3  = #zhazcrea#12;
     #zw000007#4  = #zhazcrea#13;
     #zw000007#5  = #zhazcrea#14;

     |PINPA #0#zw000007;
     |PINDA #0#zw000007;
     |ENDATOS #1#zw000007;
     nError = FSalida;
     |SI FSalida = 0;
         #zhazcrea#3  = #zw000007#0;
         #zhazcrea#4  = #zw000007#1;
         #zhazcrea#5  = #zw000007#2;
         #zhazcrea#12 = #zw000007#3;
         #zhazcrea#13 = #zw000007#4;
         #zhazcrea#14 = #zw000007#5;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO TraeCuenta;
     |HAZ MeteEstructura;
     |SI nError ! 0;  |ACABA;  |FINSI;

     |CONFI "0000SHa introducido bien las estructuras";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |HAZ LeePlanCble;
     |HAZ LeeBalance;

     |SI eTip2008 = 2;
         |SI enTBal = 1; |O enTBal = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar estos Balances";
             |ACABA;
         |FINSI;
     |FINSI;

     |HAZ LeeResultados;
     |SI eTip2008 = 2;
         |SI enTCta = 1; |O enTCta = 2;
             |MENAV "    Error. Plan Contable de Empresa PYME, NO puede realizar esta Cta de Resultados";
             |ACABA;
         |FINSI;
     |FINSI;


     |HAZ VentanaTrabajo;
     empresa   = #zhazcrea#0;
     anyo      = #zhazcrea#1;
     eNum2008  = #zhazcrea#3;
     enTBal    = #zhazcrea#4;
     enTCta    = #zhazcrea#5;

     |SUB_EJECUTA "cuacceso;AUTO";

     |SI #zregdocu#1 ] 2012;
         |SI #zhazcrea#15 = "C";
             |HAZ CogeDistrISCoop;
         |SINO;
             |HAZ CogeDistrIS;
         |FINSI;
     |FINSI;

     |HAZ FinVentanaTrabajo;

     |HAZ LeeBalance;
     |HAZ LeeResultados;
     |HAZ DatosCuentas;

     |SI nError2 = 0;
         |MENAV "0000 Generados datos en cuentas anuales";
     |FINSI;

     nContinua = 1;
     |PTEC 807;
|FPRC;

|PROCESO ConfiIdioma;
     |VENTANA 0501, 1342, -1, 16, " ";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     enSalir = 0;
     |SI #zhazcrea#15 = "P"; #zw000028#0  = "PYME"; |FINSI;
     |SI #zhazcrea#15 = "A"; #zw000028#0  = "ABREVIADA"; |FINSI;
     #zw000028#1  = #zhazdocu#0;
     #zw000028#2  = #zhazcrea#18;
     |PINPA #0#zw000028;
     |PINDA #0#zw000028;
     |ENDATOS #1#zw000028;
     |SI FSalida ! 0;
         enSalir = 1;
     |FINSI;
     #zhazcrea#18 = #zw000028#2;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO MeteConfiMemor;
     |VENTANA 0501, 1445, -1, 16, "Configuraci¢n memoria";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #zw000008#0  = #zhazcrea#15;
     #zw000008#1  = #zhazcrea#7;
     #zw000023#0  = #zhazcrea#15;
     #zw000023#1  = #zhazcrea#7;
     #zw000023#2  = #zhazcrea#18;
     |SI #zhazcrea#1 < 2018;
         |PINPA #0#zw000008;
         |PINDA #0#zw000008;
         |ENDATOS #1#zw000008;
     |SINO;
         |SI #zw000023#2 = " ";  #zw000023#2 = "M"; |FINSI;
         aAlfa = "S";
         |SI #zw000023#0 = "C"; aAlfa = "N"; |FINSI;
         |C_M #zw000023#2, 1, aAlfa;

         |PINPA #0#zw000023;
         |PINDA #0#zw000023;
         |ENDATOS #1#zw000023;
     |FINSI;
     nError = FSalida;
     |SI FSalida = 0;
         |SI #zhazcrea#1 < 2018;
             #zw000023#0 = #zw000008#0;
             #zw000023#1 = #zw000008#1;
             #zw000023#2 = " ";
         |FINSI;
         #zhazcrea#7   = #zw000023#1;
         #zhazcrea#18  = #zw000023#2;

         |SI #zhazcrea#15 ! #zw000023#0;
             #zhazcrea#15  = #zw000023#0;
             |SI #zhazcrea#15 = "C";
                 |HAZ CogeDistrISCoop;
                 #zhazcrea#10 = 10;
             |SINO;
                 |HAZ CogeDistrIS;
             |FINSI;
         |FINSI;
         #zregdocu#13 = #zhazcrea#10;
         #zregdocu#69 = #zhazcrea#15;
         #zregdocu#84 = #zhazcrea#18;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO ConfiMemor;  |TIPO 0;
     |HAZ MeteConfiMemor;
     |SI nError ! 0;  |ACABA;  |FINSI;

     nContinua = 1;
     |PTEC 807;
|FPRC;

|PROCESO BorraMemoria;
     |CONFI "0000SSeguro que quiere quitar la memoria personalizada de esta empresa";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aAlfa;  |QBF aAlfa;

     |SI #zhazdocu#0 = 2008;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "memor001.doc";
     |FINSI;

     |SI #zhazdocu#0 = 2009;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "memo2009.doc";
     |FINSI;

     |SI #zhazdocu#0 ] 2010;
          |SI #zhazcrea#15 = "P";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "p.doc";
          |FINSI;

          |SI #zhazcrea#15 = "A";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "a.doc";
          |FINSI;

          |SI #zhazcrea#15 = "C";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     |FBORRA aAlfa;
|FPRC;

|PROCESO MeteConfiInfGes;
     |VENTANA 0501, 1445, -1, 16, "Configuraci¢n informe de gesti¢n";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #zw000009#0  = #zhazcrea#8;

     |PINPA #0#zw000009;
     |PINDA #0#zw000009;
     |ENDATOS #1#zw000009;
     nError = FSalida;
     |SI FSalida = 0;
         #zhazcrea#8 = #zw000009#0;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO ConfiInfGes;  |TIPO 0;
     |HAZ MeteConfiInfGes;
     |SI nError ! 0;  |ACABA;  |FINSI;

     nContinua = 1;
     |PTEC 807;
|FPRC;

|PROCESO BorraInfGes;
     |CONFI "0000SSeguro que quiere quitar el informe de gesti¢n personalizado de esta empresa";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DBASE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "word/gestion/" + (("00000" + #zhazcrea#0) % -105) + "/" + "gesti001.doc";

     |FBORRA aAlfa;
|FPRC;

|PROCESO CreaCtasPapel;
     enCoopera = 0;
     |SI #zhazcrea#4 = 21;  |O #zhazcrea#4 = 22;
      |O #zhazcrea#4 = 31;  |O #zhazcrea#4 = 32;
         enCoopera = 1;
     |FINSI;

     |SI #zregdocu#3 = "S";
         |CONFI "0000NLas cuentas anuales ya est n creadas, desea crearlas de nuevo";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |SINO;
         |SI enCoopera = 0;
             |CONFI "0000SVamos a crear los datos en el documento PDF. Continuar";
         |SINO;
             |CONFI "0000SVamos a crear los datos en el documento WORD. Continuar";
         |FINSI;
     |FINSI;

     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI enCoopera = 0;
         |HAZ PorXbrl;
     |SINO;
         |HAZ CreaCtasCoop;
     |FINSI;

     |MENAV "0000Las cuentas han sido creadas.";
|FPRC;

|PROCESO MeteCertificado;
     |VENTANA 0501, 1685, -1, 16, "Configuraci¢n certificado";
     n2Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #maempr01;
     #maempr01#0 = #zhazcrea#0;
     #maempr01#1 = #zhazcrea#1;
     |LEE 040#maempr01.=;
     |SI FSalida = 0; |Y #maempr01#83 ! "          ";
         #zhazcrea#17 = #maempr01#83;
     |FINSI;
     |CIERRA #maempr01;

     #zw000017#0  = #zhazcrea#9;
     #zw000017#1  = #zhazcrea#10;
     #zw000017#2  = #zhazcrea#11;
     #zw000017#3  = #zhazcrea#16;
     #zw000017#4  = #zhazcrea#17;

     |PINPA #0#zw000017;
     |PINDA #0#zw000017;
     |ENDATOS #1#zw000017;
     nError = FSalida;
     |SI FSalida = 0;
         #zhazcrea#9  = #zw000017#0;
         #zhazcrea#10 = #zw000017#1;
         #zhazcrea#11 = #zw000017#2;
         #zhazcrea#16 = #zw000017#3;
         #zhazcrea#17 = #zw000017#4;
         |HAZ ActuaMaempr01;
         |HAZ ActuaAutomatica;

         #zregdocu#13 = #zhazcrea#10;
         #zregdocu#12 = #zhazcrea#9;
         #zregdocu#68 = #zhazcrea#11;
         #zregdocu#69 = #zhazcrea#15;
         #zregdocu#15 = #zhazcrea#16;
         #zregdocu#81 = #zhazcrea#17;
         #zregdocu#84 = #zhazcrea#18;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n2Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n2Vent;
|FPRC;

|PROCESO ConfiCertificado;  |TIPO 0;
     |HAZ MeteCertificado;
     |SI nError ! 0;  |ACABA;  |FINSI;

     nContinua = 1;
     |PTEC 807;
|FPRC;

|PROCESO ProcesosTree;
     aContenido = Contenido % 110;

     |SI FEntrada = 0;  |ACABA;  |FINSI;

     |SI aContenido = "_____Salir";
         nContinua = 0;
         |PTEC 807;
         |ACABA;
     |FINSI;

     enEmpresa    = #zhazcrea#0;
     enEjerCuadro = #zhazdocu#0;
     eaTipoMemo   = #zhazcrea#15;
     nNumer1      = #zhazdocu#0;
     nNumer2      = #zhazdocu#0 - 1;
     aBuscar      = aContenido;

     |SI aContenido = "TraeConta";
         |HAZ TraeConta;
         |ACABA;
     |FINSI;

     |SI aContenido = "TraeCuenta";
         |HAZ TraeCuenta;
         |ACABA;
     |FINSI;

     |SI aContenido = "ConfiMemor";
         |HAZ ConfiMemor;
         |ACABA;
     |FINSI;

     |SI aContenido = "PaseCuadro";
         |HAZ PaseCuadros;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "CreaMemori";
         |HAZ CreaMemoria;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "VisuMemori";
         |HAZ VisualizaMemoria;

         |ACABA;
     |FINSI;

     aAlfa = aContenido - "DisResul";
     |SI FSalida ! 0;
         aTipo  = aContenido % 902;

         |SI aTipo = "An";
             |SI #zhazcrea#15 ! "C";
                 |HAZ DistResultadosAnt;
             |SINO;
                 |HAZ DistResultadosAntCoop;
             |FINSI;
         |FINSI;

         |SI aTipo = "Ac";
             |SI #zhazcrea#15 ! "C";
                 |HAZ DistResultados;
             |SINO;
                 |HAZ DistResultadosCoop;
             |FINSI;
         |FINSI;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "zregcu";
     |SI FSalida ! 0;
         aTipo  = aContenido % 902;
         aDef   = aContenido % 108;

         |SI aTipo = "Ac";  enEjerCuadro = nNumer1;  |FINSI;
         |SI aTipo = "An";  enEjerCuadro = nNumer2;  |FINSI;

         |SUB_EJECUTA aDef;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "PerMemor";
     |SI FSalida ! 0;
         aTipo  = aContenido % 902;

         |SI aTipo = "Cr";
             aAlfa =  "0000NUsamos esta opci¢n para personalizar la plantilla general de la memoria solo para esta empresa, ";
             aAlfa = aAlfa + "no es obligado. Seguro? ";
             |CONFI aAlfa;
             |SI FSalida ! 0;  |ACABA;  |FINSI;

             |HAZ PersonalizaMemoria;
             aBuscar  = "PerMemorEd";
         |FINSI;

         |SI aTipo = "Ed";
             enPersonaliza = 1;

             |SI #zhazcrea#15 = "P";  |HAZ EditaMemoPatronPYME;        |FINSI;
             |SI #zhazcrea#15 = "A";  |HAZ EditaMemoPatronAbreviada;   |FINSI;
             |SI #zhazcrea#15 = "C";  |HAZ EditaMemoPatronCooperativa; |FINSI;
         |FINSI;

         |SI aTipo = "Qu";
             aBuscar  = "PerMemorCr";
             |HAZ BorraMemoria;
         |FINSI;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "ConfiInfGe";
         |HAZ ConfiInfGes;
         |ACABA;
     |FINSI;

     aAlfa = aContenido - "PerInfGe";
     |SI FSalida ! 0;
         aTipo  = aContenido % 902;

         |SI aTipo = "Cr";
             aAlfa =  "0000NUsamos esta opci¢n para personalizar la plantilla general del informe de gesti¢n  solo para esta empresa, ";
             aAlfa = aAlfa + "no es obligado. Seguro? ";
             |CONFI aAlfa;
             |SI FSalida ! 0;  |ACABA;  |FINSI;

             |HAZ PersonalizaGestion;
             aBuscar  = "PerInfGeEd";
         |FINSI;

         |SI aTipo = "Ed";
             enPersonaliza = 1;

             |HAZ EditaGestiPatron;
         |FINSI;

         |SI aTipo = "Qu";
             aBuscar  = "PerInfGeCr";
             |HAZ BorraInfGes;
         |FINSI;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "CreaInfGes";
         |HAZ CreaGestion;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "VisuInfGes";
         |HAZ VisualizaGestion;

         |ACABA;
     |FINSI;

     |SI aContenido = "DeposFirma";
         |HAZ FirmaCertificado;

         |ACABA;
     |FINSI;

     |SI aContenido = "DeposExpor";
         |HAZ CreaDeposito;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "DeposAbrir";
         |HAZ VisualizaDeposito;

         |ACABA;
     |FINSI;

     |SI aContenido = "FormuPapel";
         eaModoPresenta = "P";
         |HAZ CreaPortada;

         |ACABA;
     |FINSI;

     |SI aContenido = "FormuImpre";
         eaModoPresenta = "I";
         |HAZ CreaPortada;

         |ACABA;
     |FINSI;

     |SI aContenido = "CtasPapCre";
         |HAZ CreaCtasPapel;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "CtasPapVis";
         |HAZ VisualizaCuentas;

         |ACABA;
     |FINSI;

     |SI aContenido = "CertiConfi";

         |HAZ ConfiCertificado;

         |ACABA;
     |FINSI;

     |SI aContenido = "CertiDistr";
         |SI #zhazcrea#15 ! "C";  |HAZ DistResultados;      |FINSI;
         |SI #zhazcrea#15 = "C";  |HAZ DistResultadosCoop;  |FINSI;

         |ACABA;
     |FINSI;

     |SI aContenido = "CertiDatos";
         |HAZ DatosCertificado;

         |ACABA;
     |FINSI;

     |SI aContenido = "CertiFirma";
         |HAZ FirmaCertificado;

         |ACABA;
     |FINSI;

     |SI aContenido = "ActasAsist";
         |HAZ AsistentesActa;

         |ACABA;
     |FINSI;

     |SI aContenido = "CertiCrear";
         |HAZ CreaCertificado;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "CertiVisua";
         |HAZ VisualizaCertificado;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "ActasCrear";
         |HAZ CreaActaAprobacion;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;

     |SI aContenido = "ActasVisua";
         |HAZ VisualizaActaAprobacion;

         nContinua = 1;
         |PTEC 807;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO PonMarca;
     |DBASE aMas;
     aMas = aMas + "def/" + aDef + ".mas";
     |CARGA_DEF aMas, imagen@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

                        nAnyo = nNumer1;
     |SI aTipo = "An";  nAnyo = nNumer2;  |FINSI;

     |ABRE #imagen@;
     #imagen@#0 = #zregdocu#0;
     #imagen@#1 = nAnyo;
     |LEE 101#imagen@.];
     |SI FSalida = 0;  |Y #imagen@#0 = #zregdocu#0;  |Y #imagen@#1 = nAnyo;
         aMarca = " (*) ";
     |FINSI;
     |CIERRA #imagen@;

     |DESCARGA_DEF #imagen@;
|FPRC;

|PROCESO GrabaTree;
     aMarca = "";

     aContenido = aAlfa3 - "zregcu";
     |SI FSalida ! 0;
         aDef       = aAlfa3 % 308;
         aTipo      = aAlfa3 % 1102;
         |HAZ PonMarca;
     |FINSI;

     aAlfa = aAlfa1 + aAlfa2 + aMarca + aAlfa3 +  &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Rama1;
     |ABRE #sodacoca;
     #sodacoca#0 = #zhazcrea#0;
     #sodacoca#1 = #zhazcrea#1;
     |LEE 000#sodacoca.=;
     |SI FSalida ! 0;
         nConta1 = nConta1 + 1;
         aAlfa1  = nConta1 + ":";
         aAlfa2  = "Creaci¢n autom tica datos contabilidad";
         aAlfa3  = "{{TraeConta}}";
         |HAZ GrabaTree;
     |FINSI;
     |CIERRA #sodacoca;
|FPRC;

|PROCESO Rama2;
     |ABRE #cuacceso;
     #cuacceso#0 = #zhazcrea#0;
     #cuacceso#1 = #zhazcrea#1;
     |LEE 000#cuacceso.=;
     |SI FSalida ! 0;
         |HAZ LeePlan;
         #cuacceso#14 = #zhazcrea#3;
         |HAZ LeeBalanceD;

         nConta1 = nConta1 + 1;
         aAlfa1  = nConta1 + ":";
         aAlfa2  = "Creaci¢n autom tica datos cuentas anuales ";
         aAlfa3  = "{{TraeCuenta}}";
         |HAZ GrabaTree;
     |SINO;
         #zhazcrea#3 = #cuacceso#14;
         #zhazcrea#4 = #cuacceso#15;
         #zhazcrea#5 = #cuacceso#16;
     |FINSI;
     |CIERRA #cuacceso;

     |HAZ LeePlanCble;
     |HAZ LeeBalance;
     |HAZ LeeResultados;

     aAlfa = "P.Ctble: " + (("00" + #zhazcrea#3) % -102);
     aAlfa = aAlfa +  " " + #zhazcrea#12;  |QBF aAlfa;
     aAlfa = aAlfa % 0131;
     aAlfa = "LABEL,{{15}}" + aAlfa;
     |CONTROL_SIMPLE 0, aAlfa, 0501, 0532, NULL;

     aAlfa = "Balance: " + (("00" + #zhazcrea#4) % -102);
     aAlfa = aAlfa +  " " + #zhazcrea#13;  |QBF aAlfa;
     aAlfa = aAlfa % 0131;
     aAlfa = "LABEL,{{15}}" + aAlfa;
     |CONTROL_SIMPLE 0, aAlfa, 0534, 0565, NULL;

     aAlfa = "Cta.Result.: " + (("00" + #zhazcrea#5) % -102);
     aAlfa = aAlfa +  " " + #zhazcrea#14;  |QBF aAlfa;
     aAlfa = aAlfa % 0131;
     aAlfa = "LABEL,{{15}}" + aAlfa;
     |CONTROL_SIMPLE 0, aAlfa, 0567, 0598, NULL;
|FPRC;

|PROCESO TreeMem2008;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu02  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu04  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu05  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
     aAlfa3  = "{{zregcu08  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu09  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
     aAlfa3  = "{{zregcu11  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Personal de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2009;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu02  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu04  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu05  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
     aAlfa3  = "{{zregcu08  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu09  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
     aAlfa3  = "{{zregcu11  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Personal de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emision de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2010P;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu02  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu04  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu05  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     aAlfa3  = "{{zregcu15  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
     aAlfa3  = "{{zregcu08  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu09  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
     aAlfa3  = "{{zregcu11  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Personal de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emisión de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2010A;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu16  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu17  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu18  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu19  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     aAlfa3  = "{{zregcu15  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
     aAlfa3  = "{{zregcu20  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu21  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Operaciones con partes vinculadas ";
     aAlfa3  = "{{zregcu22  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
     aAlfa3  = "{{zregcu23  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Personal de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emisión de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2011P;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Automatico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu02  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu04  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu05  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     |SI #zhazdocu#0 ] 2015;
         aAlfa3  = "{{zregcu29  }}";
     |SINO;
         aAlfa3  = "{{zregcu15  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Saldos con Administraciones P£blicas ";
     aAlfa3  = "{{zregcu24  }}";
     |HAZ GrabaTree;

     |SI #zhazdocu#0 [ 2015;
         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
         aAlfa3  = "{{zregcu08  }}";
         |HAZ GrabaTree;
     |FINSI;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 ] 2016;
         aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu30  }}";
     |SINO;
         aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu09  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 < 2017;
         aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
         aAlfa3  = "{{zregcu11  }}";
     |SINO;
         aAlfa2  = "(Manual) Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
         aAlfa3  = "{{zregcu31  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 [ 2012;
         aAlfa2  = "(Manual) Personal de la sociedad";
     |SINO;
         |SI #zhazdocu#0 < 2017;
             aAlfa2  = "(Autom tico) Personal de la sociedad";
         |SINO;
             aAlfa2  = "(Autom tico) Personal medio de la sociedad";
         |FINSI;
     |FINSI;
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emisión de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizacion";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2011A;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu16  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu17  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu18  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu19  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     |SI #zhazdocu#0 ] 2015;
         aAlfa3  = "{{zregcu29  }}";
     |SINO;
         aAlfa3  = "{{zregcu15  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Saldos con Administraciones P£blicas ";
     aAlfa3  = "{{zregcu24  }}";
     |HAZ GrabaTree;

     |SI #zhazdocu#0 [ 2015;
         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
         aAlfa3  = "{{zregcu20  }}";
         |HAZ GrabaTree;
     |FINSI;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 ] 2016;
         aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu30  }}";
     |SINO;
         aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu21  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Operaciones con partes vinculadas ";
     aAlfa3  = "{{zregcu22  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 < 2017;
         aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
         aAlfa3  = "{{zregcu23  }}";
     |SINO;
         aAlfa2  = "(Manual) Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
         aAlfa3  = "{{zregcu31  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 [ 2012;
         aAlfa2  = "(Manual) Personal de la sociedad";
     |SINO;
         |SI #zhazdocu#0 < 2017;
             aAlfa2  = "(Autom tico) Personal de la sociedad";
         |SINO;
             aAlfa2  = "(Autom tico) Personal medio de la sociedad";
         |FINSI;
     |FINSI;
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emisión de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizacion";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2011C;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Activos finacieros a largo y corto plazo ";
     aAlfa3  = "{{zregcu02  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu04  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Pasivos financieros a largo plazo y corto plazo ";
     aAlfa3  = "{{zregcu05  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     |SI #zhazdocu#0 ] 2015;
         aAlfa3  = "{{zregcu29  }}";
     |SINO;
         aAlfa3  = "{{zregcu15  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Fondos propios. An lisis del movimiento durante el ejercicio ";
     aAlfa3  = "{{zregcu26  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Fondo de educaci¢n, formaci¢n y promoci¢n ";
     aAlfa3  = "{{zregcu25  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Saldos con Administraciones P£blicas ";
     aAlfa3  = "{{zregcu24  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Detalle de la cuenta de prdidas y ganancias ";
     aAlfa3  = "{{zregcu08  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Separaci¢n de las partidas de la cuenta de perdidas y ganancias ";
     aAlfa3  = "{{zregcu27  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 ] 2016;
         aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu30  }}";
     |SINO;
         aAlfa2  = "(Autom tico) Detalle de subvenciones, donaciones y legados ";
         aAlfa3  = "{{zregcu09  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 < 2017;
         aAlfa2  = "(Manual) Sueldos, dietas y remuneraciones ";
         aAlfa3  = "{{zregcu11  }}";
     |SINO;
         aAlfa2  = "(Manual) Importes recibidos personal alta direcci¢n y ¢rganos administraci¢n";
         aAlfa3  = "{{zregcu31  }}";
     |FINSI;
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Actuaciones medioambientales";
     aAlfa3  = "{{zregcu12  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     |SI #zhazdocu#0 [ 2012;
         aAlfa2  = "(Manual) Personal de la sociedad";
     |SINO;
         |SI #zhazdocu#0 < 2017;
             aAlfa2  = "(Autom tico) Personal de la sociedad";
         |SINO;
             aAlfa2  = "(Autom tico) Personal medio de la sociedad";
         |FINSI;
     |FINSI;
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Derechos de emisión de gases de efecto invernadero";
     aAlfa3  = "{{zregcu14  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizacion";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2018P;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Inversiones financieras valoradas a valor razonable ";
     aAlfa3  = "{{zregcu32  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu33  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     aAlfa3  = "{{zregcu29  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizacion";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Importes percibidos por el personal alta direcci¢n ";
     aAlfa3  = "{{zregcu31  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Personal medio de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu30  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2018A;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu16  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Inversiones financieras valoradas a valor razonable ";
     aAlfa3  = "{{zregcu32  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu33  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     aAlfa3  = "{{zregcu29  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizacion";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Operaciones con partes vinculadas ";
     aAlfa3  = "{{zregcu22  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Importes percibidos por el personal alta direcci¢n ";
     aAlfa3  = "{{zregcu31  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Personal medio de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu30  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO TreeMem2018C;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Carga autom tica de los cuadros ";
     aAlfa3  = "{{PaseCuadro}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Distribuci¢n de resultados " + nNumer2 + " ";
     aAlfa3  = "{{DisResulAn}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Distribuci¢n de resultados " + nNumer1 + " ";
     aAlfa3  = "{{DisResulAc}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(A¤o anterior) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer2 + " ";
     aAlfa3  = "{{zregcu01An}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Inmovilizado intangible, material e inversiones inmobiliarias " + nNumer1 + " ";
     aAlfa3  = "{{zregcu01Ac}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Arrendamientos financieros ";
     aAlfa3  = "{{zregcu10  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Correcciones por deterioro de valor de activos a largo y corto plazo ";
     aAlfa3  = "{{zregcu03  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Inversiones financieras valoradas a valor razonable ";
     aAlfa3  = "{{zregcu32  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Empresas del grupo, multigrupo y asociadas ";
     aAlfa3  = "{{zregcu33  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Clasificaci¢n por vencimientos ";
     aAlfa3  = "{{zregcu06  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Informaci¢n sobre aplazamiento de pago efectuados a proveedores ";
     aAlfa3  = "{{zregcu29  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Fondos propios. An lisis del movimiento durante el ejercicio ";
     aAlfa3  = "{{zregcu26  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico)  Reservas de revalorizaci¢n";
     aAlfa3  = "{{zregcu28  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Fondo de educaci¢n, formaci¢n y promoci¢n ";
     aAlfa3  = "{{zregcu25  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Impuesto sobre beneficios ";
     aAlfa3  = "{{zregcu07  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Separaci¢n de las partidas de la cuenta de perdidas y ganancias ";
     aAlfa3  = "{{zregcu27  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Importes percibidos por el personal alta direcci¢n ";
     aAlfa3  = "{{zregcu31  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Autom tico) Personal medio de la sociedad";
     aAlfa3  = "{{zregcu13  }}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "(Manual) Detalle de subvenciones, donaciones y legados ";
     aAlfa3  = "{{zregcu30  }}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO RamaCuaMemoria;
     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Datos cuadros";
     aAlfa3  = "";
     |HAZ GrabaTree;

     eaTipoMemo = #zhazcrea#15;
     nNumer1    = #zhazdocu#0;
     nNumer2    = #zhazdocu#0 - 1;

     |SI #zhazdocu#0 = 2008;  |HAZ TreeMem2008;  |FINSI;
     |SI #zhazdocu#0 = 2009;  |HAZ TreeMem2009;  |FINSI;

     |SI #zhazdocu#0 = 2010;
         |SI #zhazcrea#15 = "P";  |HAZ TreeMem2010P;  |FINSI;
         |SI #zhazcrea#15 = "A";  |HAZ TreeMem2010A;  |FINSI;
     |FINSI;

     |SI #zhazdocu#0 ] 2011; |Y #zhazdocu#0 [ 2017;
         |SI #zhazcrea#15 = "P";  |HAZ TreeMem2011P;  |FINSI;
         |SI #zhazcrea#15 = "A";  |HAZ TreeMem2011A;  |FINSI;
         |SI #zhazcrea#15 = "C";  |HAZ TreeMem2011C;  |FINSI;
     |FINSI;

     |SI #zhazdocu#0 ] 2018;
         |SI #zhazcrea#15 = "P";  |HAZ TreeMem2018P;  |FINSI;
         |SI #zhazcrea#15 = "A";  |HAZ TreeMem2018A;  |FINSI;
         |SI #zhazcrea#15 = "C";  |HAZ TreeMem2018C;  |FINSI;
     |FINSI;
|FPRC;

|PROCESO RamaPerMemoria;
     |DBASE aAlfa;  |QBF aAlfa;

     |SI #zhazdocu#0 = 2008;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "memor001.doc";
     |FINSI;

     |SI #zhazdocu#0 = 2009;
         aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "memo2009.doc";
     |FINSI;

     |SI #zhazdocu#0 ] 2010;
          |SI #zhazcrea#15 = "P";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "p.doc";
          |FINSI;

          |SI #zhazcrea#15 = "A";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "a.doc";
          |FINSI;

          |SI #zhazcrea#15 = "C";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              aAlfa = aAlfa + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + "mem" + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     nConta2 = nConta2 + 1;
     nConta3 = 0;

     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Personalizar memoria patr¢n para esta empresa";
         aAlfa3  = "";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Personalizar";
         aAlfa3  = "{{PerMemorCr}}";
         |HAZ GrabaTree;
     |SINO;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Memoria personalizada (editar o quitar)";
         aAlfa3  = "";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Editar";
         aAlfa3  = "{{PerMemorEd}}";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Quitar";
         aAlfa3  = "{{PerMemorQu}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama3;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Memoria ";
     |SI #zhazcrea#15 = "P";  aAlfa2 = aAlfa2 + "Pyme";         |FINSI;
     |SI #zhazcrea#15 = "A";  aAlfa2 = aAlfa2 + "Abreviada";    |FINSI;
     |SI #zhazcrea#15 = "C";  aAlfa2 = aAlfa2 + "Cooperativa";  |FINSI;

     |SI #zregdocu#4 = "S";
         aAlfa2 = aAlfa2 + "  (DOCUMENTO CREADO)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DOCUMENTO NO CREADO)";
     |FINSI;
     aAlfa3 = "";

     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Configuraci¢n de la memoria";
     aAlfa3 = "{{ConfiMemor}}";
     |HAZ GrabaTree;

     |HAZ RamaPerMemoria;
     |HAZ RamaCuaMemoria;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Crear documento";
     aAlfa3 = "{{CreaMemori}}";
     |HAZ GrabaTree;

     |SI #zregdocu#4 = "S";
         nConta2 = nConta2 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + ":";
         aAlfa2 = "Visualizar documento";
         aAlfa3 = "{{VisuMemori}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO RamaPerInfGest;
     |DBASE aAlfa;  |QBF aAlfa;

     |DBASE aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "word/gestion/" + (("00000" + #zhazcrea#0) % -105) + "/" + "gesti001.doc";

     nConta2 = nConta2 + 1;
     nConta3 = 0;

     |XABRE "E", aAlfa, nHandle;
     |SI FSalida < 0;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Personalizar informe gesti¢n patr¢n para esta empresa";
         aAlfa3  = "";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Personalizar";
         aAlfa3  = "{{PerInfGeCr}}";
         |HAZ GrabaTree;
     |SINO;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Informe de gesti¢n personalizado (editar o quitar)";
         aAlfa3  = "";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Editar";
         aAlfa3  = "{{PerInfGeEd}}";
         |HAZ GrabaTree;

         nConta3 = nConta3 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2  = "Quitar";
         aAlfa3  = "{{PerInfGeQu}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama4;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Informe de gesti¢n ";

     |SI #zregdocu#8 = "S";
         aAlfa2 = aAlfa2 + "  (DOCUMENTO CREADO)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DOCUMENTO NO CREADO)";
     |FINSI;
     aAlfa3 = "";

     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Configuraci¢n del informe de gesti¢n";
     aAlfa3 = "{{ConfiInfGe}}";
     |HAZ GrabaTree;

     |HAZ RamaPerInfGest;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Crear documento";
     aAlfa3 = "{{CreaInfGes}}";
     |HAZ GrabaTree;

     |SI #zregdocu#8 = "S";
         nConta2 = nConta2 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + ":";
         aAlfa2 = "Visualizar documento";
         aAlfa3 = "{{VisuInfGes}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama5;
     aAlfa = #zregubic#3;  |QBT aAlfa;
     |SI aAlfa = "";   |ACABA;  |FINSI;

     |SI #zhazcrea#4 = 20;  |ACABA;  |FINSI;
     |SI #zhazcrea#4 = 21;  |ACABA;  |FINSI;
     |SI #zhazcrea#4 = 22;  |ACABA;  |FINSI;
     |SI #zhazcrea#4 = 30;  |ACABA;  |FINSI;
     |SI #zhazcrea#4 = 31;  |ACABA;  |FINSI;
     |SI #zhazcrea#4 = 32;  |ACABA;  |FINSI;

     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Dep¢sito digital ";

     |SI #zregdocu#14 = "S";
         aAlfa2 = aAlfa2 + "  (DATOS EXPORTADOS)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DATOS SIN EXPORTAR)";
     |FINSI;
     aAlfa3 = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Firmantes";
     aAlfa3 = "{{DeposFirma}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Exportar datos";
     aAlfa3 = "{{DeposExpor}}";
     |HAZ GrabaTree;

     |SI #zregdocu#14 = "S";
         nConta2 = nConta2 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + ":";
         aAlfa2 = "Abrir el dep¢sito";
         aAlfa3 = "{{DeposAbrir}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama6;
     |SI enTBal = 1;  |ACABA;  |FINSI;

     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Cuentas anuales para su presentaci¢n en papel ";

     |SI #zregdocu#3 = "S";
         aAlfa2 = aAlfa2 + "  (DOCUMENTO CREADO)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DOCUMENTO NO CREADO)";
     |FINSI;
     aAlfa3 = "";

     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Crear documento";
     aAlfa3 = "{{CtasPapCre}}";
     |HAZ GrabaTree;

     |SI #zregdocu#3 = "S";
         nConta2 = nConta2 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + ":";
         aAlfa2 = "Visualizar documento";
         aAlfa3 = "{{CtasPapVis}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama7;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Certificado y Actas aprobaci¢n de cuentas";
     aAlfa3 = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Configuraci¢n";
     aAlfa3 = "{{CertiConfi}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Distribuci¢n de resultados";
     aAlfa3 = "{{CertiDistr}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Datos de la reuni¢n";
     aAlfa3 = "{{CertiDatos}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Firmantes";
     aAlfa3 = "{{CertiFirma}}";
     |HAZ GrabaTree;

     |SI #zhazcrea#10 ! 8;
         |ABRE #maempr01;
         #maempr01#0 = #zhazcrea#0;
         #maempr01#1 = #zhazcrea#1;
         |LEE 040#maempr01.=;
         |SI FSalida ! 0;  |DDEFECTO #maempr01;  |FINSI;
         |CIERRA #maempr01;

         aAlfa  = #maempr01#3 % 101;
         |SI aAlfa = "B";|O aAlfa = "A";
             nConta2 = nConta2 + 1;
             nConta3 = 0;
             aAlfa1 = nConta1 + "," + nConta2 + ":";
             aAlfa2 = "Asistentes a la reuni¢n";
             aAlfa3 = "{{ActasAsist}}";
             |HAZ GrabaTree;
         |FINSI;
     |FINSI;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Acta de aprobaci¢n de cuentas";
     |SI #zregdocu#80 = "S";
         aAlfa2 = aAlfa2 + "  (DOCUMENTO CREADO)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DOCUMENTO NO CREADO)";
     |FINSI;
     aAlfa3 = "";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2 = "Crear documento";
     aAlfa3 = "{{ActasCrear}}";
     |HAZ GrabaTree;

     |SI #zregdocu#80 = "S";
         nConta3 = nConta3 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2 = "Visualizar documento";
         aAlfa3 = "{{ActasVisua}}";
         |HAZ GrabaTree;
     |FINSI;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Certificado";
     |SI #zregdocu#11 = "S";
         aAlfa2 = aAlfa2 + "  (DOCUMENTO CREADO)";
     |SINO;
         aAlfa2 = aAlfa2 + " (DOCUMENTO NO CREADO)";
     |FINSI;
     aAlfa3 = "";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2 = "Crear documento";
     aAlfa3 = "{{CertiCrear}}";
     |HAZ GrabaTree;

     |SI #zregdocu#11 = "S";
         nConta3 = nConta3 + 1;
         aAlfa1 = nConta1 + "," + nConta2 + "," + nConta3 + ":";
         aAlfa2 = "Visualizar documento";
         aAlfa3 = "{{CertiVisua}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Rama9;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Formulario carpeta registro ";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Formulario carpeta del registro por pantalla";
     aAlfa3 = "{{FormuPapel}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1 = nConta1 + "," + nConta2 + ":";
     aAlfa2 = "Formulario carpeta del registro por impresora";
     aAlfa3 = "{{FormuImpre}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO CreaArbol;
     |VENTANA 0501, 3499, -1, 16, aCab;
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     eaFicheroTxt  = "zhazdocu2" + Usuario + ".txt";
     eaFicheroTgz  = "zhazdocu2" + Usuario + ".tgz";
     eaFicheroTar  = "zhazdocu2" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     |XABRE "WB", aAbre, nHandle;

     nConta1 = 0;

     |HAZ Rama1;
     |SI nConta1 = 0;
         |HAZ Rama2;
     |FINSI;

     |SI nConta1 = 0;
         |HAZ Rama3;
         |HAZ Rama4;
         |HAZ Rama5;
         |HAZ Rama6;
         |HAZ Rama7;
         |HAZ Rama9;
     |FINSI;

     nConta1 = nConta1 + 1;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Salir ";
     aAlfa3  = "{{_____Salir}}";
     |HAZ GrabaTree;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     aAlfa = "TREECTRL,Datos de la empresa {{" + aAlfa + "}}";

     |CONTROL_SIMPLE 0, aAlfa, 0602, 3298, ProcesosTree;
     nTree = FSalida;

     eaFicheroTxt  = "zhazdocu2" + Usuario + ".txt";

     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     |SI aBuscar ! "";
         sT_nID   = nTree;
         sT_nOper = 3;
         sT_aData = "[" + aBuscar;
         |ESPECIFICA "COMMANDCONTROL", sTree;
         |SI FSalida ] 0;
             aRefresca = ":" + FSalida;
         |SINO;
             aRefresca = "1:";
         |FINSI;
     |FINSI;

     sT_nID   = nTree;
     sT_nOper = 2;
     |SI aRefresca = "";
         sT_aData = "1:";
     |SINO;
         sT_aData = aRefresca;
     |FINSI;
     |ESPECIFICA "COMMANDCONTROL", sTree;
|FPRC;

|PROCESO GrabaRegistro;
     #zregdocu#15 = #zhazcrea#16;
     #zregdocu#84 = #zhazcrea#18;

     |HAZ PonColor;

     |GRABA 020#zregdocu.a;
     |LIBERA #zregdocu;

     |ABRE #maempr01;
     #maempr01#0 = #zhazcrea#0;
     #maempr01#1 = #zhazcrea#1;
     |LEE 101#maempr01.=;
     |SI FSalida = 0;
         #maempr01#90 = #zhazcrea#7 - 1;
         |SI #zregdocu#4 = "S";  #maempr01#90 = #zregdocu#6;   |FINSI;
         |SI #zregdocu#8 = "S";  #maempr01#90 = #zregdocu#10;  |FINSI;
         |GRABA 020#maempr01.a;
         |LIBERA #maempr01;
     |FINSI;
     |CIERRA #maempr01;
|FPRC;

|PROCESO EntradaPorArbol;

     |PARA;  |SI;  |HACIENDO;
          nContinua = 0;
          |HAZ CreaArbol;

          aEsc1  = &255 + "806";
          aEsc2  = &255 + "807";
          aRetu  = &255 + "802";
          |PARA; |SI;  |HACIENDO;
               FSalida = "::{{001}}Salir," + nTree;
               |LEETECLA aTecla;
               |SI aTecla = aEsc1; |SAL;  |FINSI;
               |SI aTecla = aEsc2; |SAL;  |FINSI;
               |SI aTecla = aRetu; |SAL;  |FINSI;
          |SIGUE;

         aVent1 = -1;
         aVent2 = -1;
         aVent3 = 0;
         aVent4 = n1Vent;
         aVent5 = "MODELESS";
         |ESPECIFICA "ESTADO_VENTANA", aVent;

         |FINVENTANA n1Vent;

         |HAZ GrabaRegistro;

         |SI nContinua = 0;  |SAL;  |FINSI;

         |LEE 101#zregdocu.=;

         |PULSATECLA;
     |SIGUE;
|FPRC;

|PROCESO zhazcrea;
     |SI enModo ! 1;
         |HAZ MiraBloqueo;
         |SI eaBloqueo = "3";
             |ACABA;
         |FINSI;
     |FINSI;

     |DDEFECTO #zhazcrea;

     #zhazcrea#0  = #zregdocu#0;
     #zhazcrea#1  = #zregdocu#1;

     |SI enModo = 1;
         |ABRE #agim0028;
         #agim0028#0 = 1;
         |LEE 000#agim0028.=;
         |CONSULTA_CLAVE #1#agim0028;
         |SI FSalida ! 0;  |CIERRA #agim0028; |ACABA;  |FINSI;
         |CIERRA #agim0028;

         nError = 0;
         #zhazcrea#0   = #agim0028#0;
         #zhazcrea#1   = #zhazdocu#0;
         |HAZ LeeEmpresa;
         |SI nError ! 0;
             |ACABA;
         |FINSI;

         |HAZ MiraBloqueo;
         |SI eaBloqueo = "3";
             |ACABA;
         |FINSI;
     |FINSI;

     #zregdocu#0 = #zhazcrea#0;
     #zregdocu#1 = #zhazcrea#1;
     |LEE 101#zregdocu.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregdocu;
         #zregdocu#0 = #zhazcrea#0;
         #zregdocu#1 = #zhazcrea#1;
         #zregdocu#2 = #zhazcrea#2;

         |SI #zhazcrea#1 = 2008;
             |ABRE #meempmem;
             #meempmem#0 = #zhazcrea#0;
             |LEE 000#meempmem.=;
             |SI FSalida = 0;
                 |SI #meempmem#123 = 0;   #zregdocu#13 = 10;  |FINSI;
                 |SI #meempmem#123 = 1;   #zregdocu#13 = 4;   |FINSI;
                 |SI #meempmem#123 = 2;   #zregdocu#13 = 5;   |FINSI;
                 |SI #meempmem#123 = 3;   #zregdocu#13 = 6;   |FINSI;
                 |SI #meempmem#123 = 4;   #zregdocu#13 = 10;  |FINSI;
                 |SI #meempmem#123 = 5;   #zregdocu#13 = 8;   |FINSI;
                 |SI #meempmem#123 = 6;   #zregdocu#13 = 9;   |FINSI;
                 |SI #meempmem#123 = 7;   #zregdocu#13 = 1;   |FINSI;
                 |SI #meempmem#123 = 8;   #zregdocu#13 = 2;   |FINSI;
                 |SI #meempmem#123 = 9;   #zregdocu#13 = 3;   |FINSI;
             |FINSI;
             |CIERRA #meempmem;
         |FINSI;

         |SI #zhazcrea#1 ] 2009;
             nTipoCert = 0;

             #zregdocu#0 = #zhazcrea#0;
             #zregdocu#1 = #zhazcrea#1 - 1;
             |LEE 000#zregdocu.=;
             |SI FSalida = 0;
                 nTipoCert = #zregdocu#13;
             |FINSI;

             |DDEFECTO #zregdocu;
             #zregdocu#0  = #zhazcrea#0;
             #zregdocu#1  = #zhazcrea#1;
             #zregdocu#2  = #zhazcrea#2;
             #zregdocu#13 = nTipoCert;
         |FINSI;

         |SI #zregdocu#1 ] 2012;
             |SI #zhazcrea#15 = "C";
                |HAZ CogeDistrISCoop;
             |SINO;
                 |HAZ CogeDistrIS;
             |FINSI;
         |FINSI;

         |GRABA 020#zregdocu.b;
     |FINSI;

     |ABRE #cuacceso;
     #cuacceso#0 = #zhazcrea#0;
     #cuacceso#1 = #zhazcrea#1;
     |LEE 040#cuacceso.=;
     |SI FSalida ! 0;
        |DDEFECTO #cuacceso;
        #cuacceso#0 = #zhazcrea#0;
        #cuacceso#1 = #zhazcrea#1;
        |HAZ LeePlan;
        #cuacceso#14 = #zhazcrea#3;
        |HAZ LeeBalanceD;
     |FINSI;
     |CIERRA #cuacceso;

     #zhazcrea#3 = #cuacceso#14;
     #zhazcrea#4 = #cuacceso#15;
     #zhazcrea#5 = #cuacceso#16;

     |HAZ LeeBalance;
     |SI #zregdocu#4 = "N";
         |SI enTBal = 1;  #zregdocu#5 = 18;  |FINSI;
         |SI enTBal = 2;  #zregdocu#5 = 12;  |FINSI;
         |SI enTBal = 3;  #zregdocu#5 = 10;  |FINSI;
     |FINSI;

     #zhazcrea#0   = #zregdocu#0;
     #zhazcrea#1   = #zregdocu#1;
     #zhazcrea#2   = #zregdocu#2;
     #zhazcrea#6   = #zregdocu#7;
     #zhazcrea#7   = #zregdocu#5;
     #zhazcrea#8   = #zregdocu#9;
     #zhazcrea#9   = #zregdocu#12;
     #zhazcrea#10  = #zregdocu#13;
     #zhazcrea#17  = #zregdocu#81;
     #zhazcrea#18  = #zregdocu#84;

     |SI #zregdocu#68 = " ";
         aAlfa = #zregdocu#15;  |QBF aAlfa;
         |SI aAlfa ! "";
             #zregdocu#68 = "S";
         |FINSI;

         |SI #zregdocu#68 = " ";
             |SI #zhazdocu#0 ] 2009;
                 |SI #zregdocu#14 = "S";
                     #zregdocu#68 = "S";
                 |FINSI;
             |SINO;
                 #zregdocu#68 = "N";
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #zhazdocu#0 [ 2009;
         #zregdocu#69 = "P";
     |FINSI;

     #zhazcrea#11  = #zregdocu#68;
     #zhazcrea#15  = #zregdocu#69;
     #zhazcrea#16  = #zregdocu#15;

     |SI #zhazcrea#11 = " ";   #zhazcrea#11 = "N";  |FINSI;

     aCab = (("00000" + #zhazcrea#0) % -105) + " - " + #zhazcrea#2;  |QBF aCab;
     aCab = aCab + "    EJERCICIO: " + #zhazcrea#1;

     enEjercicio = #zhazcrea#1;
     |HAZ CogeMac;

     |ABRE #zregubic;
     #zregubic#0 = #zhazcrea#1;
     #zregubic#1 = eaDSMAC;
     |LEE 000#zregubic.=;
     |SI FSalida ! 0;  |DDEFECTO #zregubic;  |FINSI;
     |CIERRA #zregubic;

     nTree = -1;
     |HAZ EntradaPorArbol;

     #zregdocu#69 = #zhazcrea#15;
|FPRC;
