|FICHEROS;
     medeword #200;
     medeword #100;
     zmenumem #99;
     mew00004 #98;
     meempmem #101;
|FIN;

|VARIABLES;
     nSwOper     = 0;
     nSwPaso     = 0;
     aSAnte      = "";
     nSAnte      = 0;
     aVersion    = "";
     aCaract     = "";
     aLongi      = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aNombreFich = "";
     aBase       = "";
     aPlantilla  = "";
     aDirMenu    = "";
     aOrigen     = "";
     aDestino    = "";
     aExtension  = "";
     aCadena1    = "";
     aCadena2    = "";
     aHandle     = "";
     aFichero    = "";
     aMenu       = "";
     aCapituloA  = "";
     aCapitulo   = "";
     aPrograma   = "";
     aParametro  = "";
     aEmpresa    = "";
     aTipo       = "";
     aOpcion     = "";
     aExiste     = "";
     aPagina     = "";
     aCampos     = "";
     aAnyo       = "";
     aAbre       = "";
     aPrincipio  = "";

     nLongi      = 0;
     nPara       = 0;
     nPosic      = 0;
     nSwVersion  = 0;
     nVersion    = 0;
     nSwBueno    = 0;
     nContador1  = 0;
     nContador2  = 0;
     nContador3  = 0;
     nContador4  = 0;
     nContaPuntero = 0;
     nConta        = 0;
     nEmpresas     = 0;
     nWord         = 1;
     nCanal        = 0;
     nCampos       = 0;
     nTCampos      = 0;
     nHandle       = 0;

     &eaContador   = "";
     &eaSalida     = "";
     &eaOrigen     = "";
     &eaDestino    = "";
     &eaPagina     = "";
     &efFecha      = @;
     &enintegral   = 0;
     &eaAlfa       = "";
     &eaPath       = "";
     &eaUnidadBasico = "";

 {500}npEmpresas = 0;
 {300}&epExterna = "";
|FIN;

|PROCESO QueVersion;
     nSwVersion = 0;

     |VERSIONRTME aVersion;
     |SI aVersion ] "9.09S";  nSwVersion = 1;  |ACABA;  |FINSI;

     aLongi = aVersion % 0;
     nLongi = aLongi;
     aAlfa  = "";
     |PARA nPara = 1;  |SI nPara [ nLongi;  |HACIENDO nPara = nPara + 1;
           nPosic  = (100 * nPara) + 1;
           aCaract = aAlfa % nPosic;
           |SI aCaract = ".";  |SAL;  |FINSI;

           aVersion = aVersion + aCaract;
     |SIGUE;

     nVersion = aVersion;

     |SI nVersion ] 10;  nSwVersion = 1; |FINSI;
|FPRC;

|PROCESO LosLim;
         aAlfa2 = #98#2; |QBF aAlfa2;
         aAlfa1 = "";
         aAlfa3 = "";

         |SI #98#3 ! 0; |O #98#4 ! 9999;
             aAlfa2 = aAlfa2 + "  (";
             |SI #98#3 ! 0;
                 aAlfa1 = #98#3;
                 aAlfa1 = " Desde " + aAlfa1;
             |FINSI;
             |SI #98#4 ! 9999;
                 aAlfa3 = #98#4;
                 aAlfa3 = " Hasta " + aAlfa3;
             |FINSI;
             aAlfa2 = aAlfa2 + aAlfa1 + aAlfa3 +")";
        |FINSI;
|FPRC;

|PROCESO CreaMenu;
     aCapitulo = #98#0 % 102; nSAnte = 0;
     |SI nSwOper = 0; aSAnte = #98#0 % 401; nSAnte = aSAnte; |FINSI;
     |SI aCapituloA ! aCapitulo;
         nContador1  = nContador1 + 1;
         nContador2  = 1;
         nContador3  = 1;
         nContador4  = 1;
         aCapituloA  = aCapitulo;
         |HAZ LosLim;
         aAlfa = aHandle + " " + eaContador + "," + nContador1 + ": [" + #98#0 + "] " + aAlfa2 + &13 + &10;
         |FGRABA aAlfa;
         nSwPaso = 0;
     |SINO;
         |SI aCapitulo > "10";
             |SI nSAnte ] 5; |Y nSwPaso = 0;
                 nContador1  = nContador1 + 1;
                 nContador2  = 1;
                 nContador3  = 1;
                 nContador4  = 1;
                 aCapituloA  = aCapitulo;
                 |HAZ LosLim;
                 aAlfa = aHandle + " " + eaContador + "," + nContador1 + ": [" + #98#0 + "] " + aAlfa2 + &13 + &10;
                 |FGRABA aAlfa;
                 nSwPaso = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #98#1 ! "00000";
         |ABRE #101;
         #101#0 = #98#1;
         |LEE 040#101=;
         |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
         |CIERRA #101;

         nContador4 = nContador4 + 1;

         |SI nContador4 = 1;
             nContador3 = nContador3 + 1;
             aAlfa      = aHandle + " " + eaContador + "," + nContador1 + "," + nContador2;
             aAlfa      = aAlfa + "," + nContador3 + ": PARTICULARES" + &13 + &10;
             |FGRABA aAlfa;
         |FINSI;

         aPrograma = " {{" + aPrincipio + "zmenumem;" + #98#0 + #98#1 + aTipo + "1" + "1" + "}}" + &13 + &10;
         aAlfa = aHandle + " " + eaContador + "," + nContador1 + "," + nContador2;
         aAlfa = aAlfa + "," + nContador3 + "," + nContador4 + ": " + #101#1 + aPrograma;
         |FGRABA aAlfa;
     |SINO;
         nContador3 = nContador3 + 1;
         nContador4 = 0;
         nContador2 = nContador2 + 1;
         aAlfa = aHandle + " " + eaContador + "," + nContador1 + "," + nContador2 + ": [" + #98#0 + "] " + #98#2 + &13 + &10;
         |FGRABA aAlfa;

         aPrograma = " {{" + aPrincipio + "zmenumem;" + #98#0 + #98#1 + aTipo + "1" + "1" + "}}" + &13 + &10;
         aAlfa = aHandle + " " + eaContador + "," + nContador1 + "," + nContador2 + "," + nContador3 + ": " + "PLANILLA" + aPrograma;
         |FGRABA aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE mew00004;
     #98#1;
     ;
     "      ", "     ";
     "zzzzzz", "zzzzz";
     ;
     NULL, CreaMenu;
|FIN;

|PROCESO Memoria;
     nSwOper = 0;
     |HAZ CreaTempoMem;

     |BUCLE mew00004;

     |DELINDEX #98;
|FPRC;

|PROCESO Gestion;
     nSwOper = 1;
     |HAZ CreaTempoGes;

     |BUCLE mew00004;

     |DELINDEX #98;
|FPRC;

|PROCESO MenuCertificados;
     aAlfa = aHandle + " 1,4:Certificados" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,1:JUNTA UNIVERSAL CUENTAS ABREVIADAS" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,1,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "010100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,1,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "010200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,1,3:CON PERDIDAS   {{" + aPrincipio + "zmenumem;" + "010300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,2:JUNTA UNIVERSAL CUENTAS ORDINARIAS" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,2,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "020100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,2,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "020200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,2,3:CON PERDIDAS   {{" + aPrincipio + "zmenumem;" + "020300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,3:JUNTA UNIVERSAL (TRANSPARENCIA)" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,3,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "030100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,3,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "030200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,3,3:CON PERDIDAS   {{" + aPrincipio + "zmenumem;" + "030300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,4:JUNTA UNIVERSAL (COOPERATIVAS)" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,4,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "040100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,4,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "040200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,4,3:CON PERDIDAS   {{" + aPrincipio + "zmenumem;" + "040300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,5:JUNTA UNIVERSAL (UNIPERSONAL)" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,5,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "050100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,5,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "050200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,5,3:CON PERDIDAS {{" + aPrincipio + "zmenumem;" + "050300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,6:JUNTA UNIVERSAL (NO APROBACION DE CUENTAS) {{" + aPrincipio + "zmenumem;" + "060100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,7:JUNTA NO UNIVERSAL (CUENTAS ABREVIADAS)" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,7,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "070100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,7,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "070200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,7,3:CON PERDIDAS {{" + aPrincipio + "zmenumem;" + "070300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,8:JUNTA NO UNIVERSAL (CUENTAS ORDINARIAS)" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,8,1:CON BENEFICIOS {{" + aPrincipio + "zmenumem;" + "080100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,8,2:RESULTADO CERO {{" + aPrincipio + "zmenumem;" + "080200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,8,3:CON PERDIDAS {{" + aPrincipio + "zmenumem;" + "080300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,9:JUNTA NO UNIVERSAL (NO APROBACION DE CUENTAS) {{" + aPrincipio + "zmenumem;" + "090100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,10:COOPERATIVAS (CERTIFICADO Y SOLICITUD DE DEPOSITO) {{" + aPrincipio + "zmenumem;" + "100100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,11:TEXTO PARA CERTIFICAR LAS ACTUACIONES MEDIOAMBIENTALES " + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,11,1:TEXTO PARA CERTIFICAR QUE NO EXISTEN ACTUACIONES MEDIOAMBIENTALES   {{" + aPrincipio + "zmenumem;" + "990500" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,11,2:TEXTO PARA CERTIFICAR QUE EXISTEN ACTUACIONES MEDIOAMBIENTALES   {{" + aPrincipio + "zmenumem;" + "990510" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,12:TEXTO PARA CERTIFICAR UNA SOCIEDAD ANONIMA SIN ACCIONES PROPIAS  {{" + aPrincipio + "zmenumem;" + "990520" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,13:FECHA Y FIRMA DEL CERTIFICADO " + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,13,1:FECHA Y FIRMA DEL CERTIFICADO {{" + aPrincipio + "zmenumem;" + "990100" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,13,2:FECHA Y FIRMA DEL CERTIFICADO MAS DOY FE DEL NOTARIO (UN SOLO FIRMANTE) {{" + aPrincipio + "zmenumem;" + "990200" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;

     aAlfa = aHandle + " 1,4,13,3:FECHA Y FIRMA DEL CERTIFICADO MAS DOY FE DEL NOTARIO (VARIOS FIRMANTES) {{" + aPrincipio + "zmenumem;" + "990300" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
     |FGRABA aAlfa;
|FPRC;

|PROCESO Creacion;
     |HAZ QueVersion;
     |SI nSwVersion = 0;
         |MENAV "     La version del Basico debe ser 9.09S5 o superior";
         |ACABA;
     |FINSI;

     |ABRE #98;  |CIERRA #98;  |DELINDEX #98;

     aMenu = "";
     |SI enintegral = 1;
         |DBASS aBase;   |QBF aBase;
         aMenu      = aBase + "integral/" + "memorias.men";
         aPrincipio = ":contasoc/";
     |SINO;
         |DBASE aBase;   |QBF aBase;
         aMenu      = aBase + "memorias.men";
         aPrincipio = "";
     |FINSI;
     |DBASE aBase;   |QBF aBase;

     |FBORRA aMenu;

     Pos = -1;
     aFichero = "wb  " + aMenu;
     |FABRE aFichero;
     aHandle = FSalida;
     |SI aHandle ] 0;
          aAlfa = aHandle + " #:Textos Emisiones Word" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1:Maestros Documentos en Word" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1:Maestros" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,1:Datos Empresas  {{" + aPrincipio + "meempmem}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,2:Datos Notarios  {{" + aPrincipio + "megwordn}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3:Datos Cuadros" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,1:Inmovilizado" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,1,1:Inmaterial {{" + aPrincipio + "mem5inma}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,1,2:Material {{" + aPrincipio + "mem5mate}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,1,3:Financiero {{" + aPrincipio + "mem5fina}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,2:Empresas del Grupo y Asociadas {{" + aPrincipio + "mem8cabe}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,3:Gastos {{" + aPrincipio + "mem9gtos}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,4:Informacion sobre el medio ambiente {{" + aPrincipio + "mem10amb}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,5:Cuadro de Financiacion              {{" + aPrincipio + "mem11fic}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,6:Utilidades" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,6,1:Descripcion apartados del Cuadro de Financiacion {{" + aPrincipio + "mem00002}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,6,2:Definir Cuentas a Cuadro de Financiacion         {{" + aPrincipio + "mem00003}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,6,3:Definir Cuentas a Cuadros {{" + aPrincipio + "ctacuadc}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,1,3,6,4:Pase desde Apuntes a Cuadros {{" + aPrincipio + "pasecuad}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2:Memorias" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2,1:Descripciones Textos Memorias {{" + aPrincipio + "medeword}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2,2:Documentos Memoria" + &13 + &10;
          |FGRABA aAlfa;
          aTipo = "2";  eaContador = "1,2,2";  |HAZ Memoria;

          aAlfa = aHandle + " 1,2,3:Utilidades" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2,3,1:Crear Texto Nuevo Memoria {{" + aPrincipio + "mez00002}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2,3,2:Personalizar Texto Memoria {{" + aPrincipio + "mez00001}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,2,3,3:Reorganizar Documentos Word de Memoria (Capitulos) {{" + aPrincipio + "mez00008;m}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3:Informe de Gestion" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3,1:Descripciones Textos {{" + aPrincipio + "medgword}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3,2:Documentos Informe de Gestion" + &13 + &10;
          |FGRABA aAlfa;
          aTipo = "3";  eaContador = "1,3,2";  |HAZ Gestion;

          aAlfa = aHandle + " 1,3,3:Utilidades" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3,3,1:Crear Texto Nuevo {{" + aPrincipio + "mez00004}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3,3,2:Personalizar Texto {{" + aPrincipio + "mez00003}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,3,3,3:Reorganizar Documentos Word de Gestion (Capitulos) {{" + aPrincipio + "mez00008;g}}" + &13 + &10;
          |FGRABA aAlfa;

          |HAZ MenuCertificados;

          aAlfa = aHandle + " 1,5:Cuentas Anuales " + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,1:Cuentas Anuales Abreviadas {{" + aPrincipio + "zmenumem;" + "cuenta" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,2:Cuentas Anuales Extensas {{" + aPrincipio + "zmenumem;" + "cuente" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,3:Cuentas Anuales Abreviadas EUROS {{" + aPrincipio + "zmenumem;" + "cuenea" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,4:Cuentas Anuales Extensas EUROS {{" + aPrincipio + "zmenumem;" + "cuenee" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,5:Cuentas Anuales Abreviadas de Cooperativas  {{" + aPrincipio + "zmenumem;" + "cuecea" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,5,6:Cuentas Anuales Extensas de Cooperativas {{" + aPrincipio + "zmenumem;" + "cuecee" + "00000" + "1" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,6:Planilla Instancia al Registrador {{" + aPrincipio + "zmenumem;" + "500000" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 1,7:Instalar Documentos Patrones {{" + aPrincipio + "mez00005}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 2:Creacion de Documentos {{" + aPrincipio + "zhazword}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 3:Visualizacion e Impresion de Documentos  {{" + aPrincipio + "megwordc}}" + &13 + &10;
          |FGRABA aAlfa;

          aAlfa = aHandle + " 4:Emision de Documentos  {{" + aPrincipio + "zemiword}}" + &13 + &10;
          |FGRABA aAlfa;

          aAbre = aBase + "word/graficos/dsgese.xls";
          |XABRE "E", aAbre, nHandle;
          |SI FSalida ] 0;
              aAlfa = aHandle + " 5:Emision de Graficos 5 Ejercicios {{" + aPrincipio + "zemigraf}}" + &13 + &10;
              |FGRABA aAlfa;
          |FINSI;

          aAbre = aBase + "bin/zhazdepo.tab";
          |XABRE "E", aAbre, nHandle;
          |SI FSalida ] 0;
             aAlfa = aHandle + " 6:Depositos Digitales" + &13 + &10;
             |FGRABA aAlfa;

             aAlfa = aHandle + " 6,1:Creacion Formato de los Depositos Digitales {{" + aPrincipio + "zhazdepo}}" + &13 + &10;
             |FGRABA aAlfa;

             aAlfa = aHandle + " 6,2:Exportacion/Ejecucion Programa del Registro Mercantil {{" + aPrincipio + "zhazeld2}}" + &13 + &10;
             |FGRABA aAlfa;

             aAlfa = aHandle + " 6,3:Emision de Etiquetas Diskette para el Deposito Digital {{" + aPrincipio + "zhazetiq}}" + &13 + &10;
             |FGRABA aAlfa;

             aAlfa = aHandle + " 6,4:Planilla Etiquetas para el Deposito {{" + aPrincipio + "zmenumem;" + "etique" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
             |FGRABA aAlfa;

             aAlfa = aHandle + " 6,5:Planilla Para la Carpeta del Deposito de Cuentas {{" + aPrincipio + "zmenumem;" + "510000" + "00000" + "8" + "1" + "1" + "}}" + &13 + &10;
             |FGRABA aAlfa;
         |FINSI;
     |FINSI;

     |FCIERRA aHandle;
     |DELINDEX #98;
|FPRC;

|PROCESO Paginacion;
     |ATRI S;  |PINTA 1320, "PAGINANDO DOCUMENTO,   ESPERE UN MOMENTO "; |ATRI s;

     |WORD_PROPIEDADES nWord, "Visible", "NO";
     |WORD_PROPIEDADES nWord, "Paginacion", aPagina;
     eaPagina = "0000" + FSalida;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;
|FPRC;

|PROCESO Edita;
     |SI aTipo = 6; |Y aPagina ! "";
         |SI aCapitulo = "memori";  |HAZ Paginacion;  |FINSI;
         |SI aCapitulo = "gestio";  |HAZ Paginacion;  |FINSI;
     |SINO;
         |WORD_PROPIEDADES nWord, "Visible", "SI";

         FSalida = "NO";
         |PARA;  |SI FSalida = "NO";  |HACIENDO;
                 |PULSATECLA;
                 |WORD_PROPIEDADES nWord, "Quit", "";
         |SIGUE;

         eaAlfa = "Cierro el documento " + aDestino;
         |HAZ GeneraLog;

         |SI aTipo = 6;
             |SI aCapitulo = "memori"; |O aCapitulo = "gestio";
                 eaAlfa = "Abro el documento " + aDestino;
                 |HAZ GeneraLog;

                 |WORD_ABRE nWord, aDestino;
                 |HAZ Paginacion;
             |FINSI;
         |FINSI;
     |FINSI;

     |PINPA #0#99;
     |ATRI S;  |PINTA 1320, "CERRANDO EL DOCUMENTO, ESPERE UN MOMENTO "; |ATRI s;

     eaOrigen  = aDestino;
     eaDestino = aOrigen;
     |HAZ RecibeFichero;
|FPRC;

|PROCESO Imprime;
     aAlfa        = eaUnidadBasico + "\MODELOS\MEMORIAS\wait dsprintword " + aDestino + " 0";
     |RSYSTEM aAlfa;

/*
     |WORD_PROPIEDADES nWord, "Visible", "NO";
     |WORD_IMPRIME nWord, "Dialogo";
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |SLEEP 30;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;
*/
|FPRC;

|PROCESO ImprimeMasivo;
     |HAZ Imprime;

/*
     |WORD_PROPIEDADES nWord, "Visible", "NO";
     |SI aOpcion = "3";  |WORD_IMPRIME nWord, "Dialogo";  |FINSI;
     |SI aOpcion = "4";  |WORD_IMPRIME nWord, "";         |FINSI;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |SLEEP 30;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;
*/
|FPRC;

|PROCESO SiExDocumento;
     eaOrigen  = aOrigen;
     eaDestino = aDestino;
     |HAZ EnviaFichero;
|FPRC;

|PROCESO NoExDocumento;
     eaAlfa = "Abro el documento " + aDestino;
     |HAZ GeneraLog;

     |WORD_ABRE nWord, "";
     |WORD_PROPIEDADES nWord, "Visible", "";
     |WORD_SALVA nWord, aDestino;

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;
|FPRC;

|PROCESO EditaEmpresa;
     |DBASE aBase;   |QBF aBase;

     |SI aOpcion ! "1";
         eaPath = eaUnidadBasico + "/MODELOS/MEMORIAS/";
         |HAZ TraeDsPrintWord;
     |FINSI;

     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;
     nWord = 1;

     aOrigen = aBase + "emisiones/" + aEmpresa + "/" + aAnyo + "/w" + aCapitulo + ".doc";
     aDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/w" + aCapitulo + ".doc";

     |HAZ SiExDocumento;

     |SI aOpcion ! "1";
         eaAlfa = "Abro el documento para imprimir " + aDestino;
     |SINO;
         |PUSHV 0501 2380;
         |PINPA #0#99;
         |ATRI S;  |PINTA 1320, "ABRIENDO EL DOCUMENTO, ESPERE UN MOMENTO "; |ATRI s;
         eaAlfa = "Abro el documento para editar " + aDestino;
     |FINSI;

     |HAZ GeneraLog;

     |SI aOpcion = "1";
         |WORD_ABRE nWord, aDestino;
         |PINPA #0#99;
         |ATRI S;  |PINTA 1320, "          DOCUMENTO ABIERTO              "; |ATRI s;
     |FINSI;

     |SI aOpcion = "1";  |HAZ Edita;          |POPV;   |FINSI;
     |SI aOpcion = "2";  |HAZ Imprime;                 |FINSI;
     |SI aOpcion = "3";  |HAZ ImprimeMasivo;           |FINSI;
     |SI aOpcion = "4";  |HAZ ImprimeMasivo;           |FINSI;

     |RFBORRA aDestino;

     eaAlfa = "Borro el documento " + aDestino;
     |HAZ GeneraLog;
|FPRC;

|PROCESO Edicion;
     |DBASE aBase;   |QBF aBase;

     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;
     nWord = 1;

     aDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/w" + aCapitulo + ".doc";

     |SI aEmpresa = "00000";
         |SI aTipo = "2";
             aOrigen = aBase + "word/memoria/m" + aCapitulo + ".doc";
         |FINSI;
         |SI aTipo = "3";
             aOrigen = aBase + "word/gestion/g" + aCapitulo + ".doc";
         |FINSI;
         |SI aTipo = "1";
             aOrigen = aBase + "word/cuentas/c" + aCapitulo + ".doc";
         |FINSI;
         |SI aTipo = "8";
             |SI aCapitulo = "etique";
                 aOrigen = aBase + "word/etiqueta/etiquet.doc";
             |SINO;
                 aOrigen = aBase + "word/actas/a" + aCapitulo + ".doc";
             |FINSI;
         |FINSI;
     |SINO;
         |SI aTipo = "2";
             aOrigen = aBase + "word/memoria/" + aEmpresa + "/m" + aCapitulo + ".doc";
         |FINSI;
         |SI aTipo = "3";
             aOrigen = aBase + "word/gestion/" + aEmpresa + "/g" + aCapitulo + ".doc";
         |FINSI;
     |FINSI;

     |SI aExiste = "0";  |HAZ NoExDocumento;  |FINSI;
     |SI aExiste = "1";  |HAZ SiExDocumento;  |FINSI;

     |PUSHV 0501 2380;

     |PINPA #0#99;
     |ATRI S;  |PINTA 1320, "ABRIENDO EL DOCUMENTO, ESPERE UN MOMENTO "; |ATRI s;

     eaAlfa = "Abro el documento " + aDestino;
     |HAZ GeneraLog;

     |WORD_ABRE nWord, aDestino;

     |PINPA #0#99;
     |ATRI S;  |PINTA 1320, "          DOCUMENTO ABIERTO              "; |ATRI s;

     |SI aOpcion = "1";  |HAZ Edita;          |FINSI;
     |SI aOpcion = "2";  |HAZ Imprime;        |FINSI;
     |POPV;

     |RFBORRA aDestino;

     eaAlfa = "Borro el documento " + aDestino;
     |HAZ GeneraLog;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     aParametro = PARAMETRO;

     |SI aParametro = "memorias.men"; |O enintegral = 1; |O aParametro = "CREALO";
         |ABRE #99;
         |LEE 101#99p;
         |SI FSalida ! 0;
             |DDEFECTO #99;
             |GRABA 020#99b;
         |FINSI;

         |HAZ Creacion;

         |LIBERA #99;
         |CIERRA #99;
     |SINO;
         aCapitulo = aParametro % 106;     || Nombre Texto
         aEmpresa  = aParametro % 705;     || Codigo de Empresa
         aTipo     = aParametro % 1201;    || Tipo de Proceso
         aOpcion   = aParametro % 1301;    || Que se hace
         aExiste   = aParametro % 1401;    || Existe el Documento (1 si) (0 no)
         aAnyo     = aParametro % 1504;    || A¤o del Documento
         aPagina   = aParametro % 1904;    || Paginacion

         |SI aTipo = "4";  |HAZ CreaCuentas;   |ACABA; |FINSI;
         |SI aTipo = "5";  |HAZ CreaMemoria;   |ACABA; |FINSI;
         |SI aTipo = "6";  |HAZ EditaEmpresa;  |ACABA; |FINSI;
         |SI aTipo = "7";  |HAZ CreaGestion;   |ACABA; |FINSI;
         |SI aTipo = "9";  |HAZ CreaActas;     |ACABA; |FINSI;
         |SI aTipo = "0";  |HAZ CreaInstancia; |ACABA; |FINSI;

         |HAZ Edicion;
     |FINSI;
|FPRO;
