|FICHEROS;
   sodacoli #0;
   sodacoca #1;
   sodacuen #8;

  :/contagen/def/canempre #30;
  :/contagen/def/cacuenta #4;
  :/basica/def/agiconpa   #2;      || control pases (basica)
   sodaesj@  #900;
|FIN;

|VARIABLES;
     path     = "";
     cuenta   = "";
     alfa1    = "";
     alfa2    = "";
     inkey    = 0;
     aMas     = "";
     aDef     = "";
     nError   = 0;
     nEmpresa = 0;
     nume1    = 0;
|FIN;

|INCLUYE varcon_i;

|PROCESO agiconpa12;
    nEmpresa = #2#5;
|FPRC;

|DEFBUCLE agiconpa2;
    #2#1;
    2;
    #0#0,  1, "I1";
    #0#0, 99, "I1";
    ;
    NULL, agiconpa12;
|FIN;

|PROCESO Tipo5; |TIPO 5;
  FSalida = "SINBARRA";

  enPerConta = -1;
  |SI eaPathContagen ! "";
      nEmpresa = #0#0;
      |BUCLE agiconpa2;
      nume1 = #0#1 $ 100;

      |ABRE #30;
      |SELECT #4#30;
      #30#2  = nEmpresa;
      #30#26 = nume1;
      |LEE 041#30=;
      |SI FSalida = 0;
          enPerConta = #30#3;
      |FINSI;
      |SELECT #1#30;
      |CIERRA #30;

      |SI enPerConta ! -1;
          alfa1 = nEmpresa; alfa1 = ("00000" + alfa1) % -105;
          alfa1 = alfa1 + enPerConta;

          path = eaPathContagen + "fich/" + alfa1 +  "/";
          |PATH_DAT #4 path;
     |FINSI;
  |FINSI;
|FPRC;

|PROCESO cuen66; |TIPO 66;
|FPRC;

|PROCESO min8;
 #8#0 = "            ";
 #8#2 = enPlan;
|FPRC;

|PROCESO max8;
 #8#0 = "zzzzzzzzzzzz";
 #8#2 = enPlan;
|FPRC;

|PROCESO min4;
 #4#0 = "            ";
 #4#3 = "S";
|FPRC;

|PROCESO max4;
 #4#0 = "zzzzzzzzzzzz";
 #4#3 = "S";
|FPRC;

|PROCESO cuenta_li; |TIPO 6;

   alfa1 = Contenido;

   inkey = FSalida;
   |SI inkey = 10;

       |SI enPerConta = -1;
           |ABRE #8;
           #8#0 = #0Campo;
           |CONSULTA_F_CLAVE #1#8, min8, max8;
           #0Campo    = #8#0;
           |CIERRA #8;
       |SINO;
           |ABRE #4;
           #4#0 = #0Campo;
           |CONSULTA_F_CLAVE #6#4, min4, max4;
           #0Campo    = #4#0;
           |CIERRA #4;
       |FINSI;
   |FINSI;

   emCta = 1;        || Dar mensajes de error
   eaCuenta = #0Campo;
   salidas  = FSalida;
   |HAZ FiltraPuntos;
   #0Campo = eaCuenta;
   |PINTA #0Campo;

   |HAZ SacaNivel;

   alfa1 = #0Campo; |QBF alfa1;
   alfa2 = alfa1 % 0;
   nume1 = alfa2;

|SI alfa1 ! #0Campo;
   |SI enPerConta = -1;
       |HAZ BuscaAnt;
       |SI nError = 1;
           |ABRE #8;
           #8#2 = enPlan;
           #8#0 = #0Campo;
           |LEE 001#8=;
           |SI FSalida = 0;
               #0#4 = #8#1; |PINTA #0#4;
           |SINO;
               #8#2 = enPlan;
               #8#0 = #0Campo;
               |SI nume1 [ 4; |GRABA 020#8n; |FINSI;
           |FINSI;
           |CIERRA #8;
        |FINSI;
   |SINO;
       |ABRE #4;
       #4#0 = #0Campo;
       |LEE 001#4=;
       |SI FSalida = 0;
           #0#4 = #4#2; |PINTA #0#4;
       |FINSI;
       |CIERRA #4;
   |FINSI;
|FINSI;

|FPRC;

|PROCESO  BuscaAnt;
   nError = 1;
   |DBASE aMas;
   aDef = aMas + "def/sodacoli";
   |CARGA_DEF aDef, sodaesj@;
   |SI FSalida ! 0; |ACABA; |FINSI;
   |ABRE #900;
   |SELECT #2#900;
   #900#0 = #0#0;
   #900#1 = #0#1 - 1;
   #900#3 = #0#3;
   |LEE 041#900=;
   |SI FSalida = 0;
       nError = 0;
       #0#4 = #900#4;
   |FINSI;
   |SELECT #1#900;
   |CIERRA #900;
   |DESCARGA_DEF #sodaesj@;
|FPRC;

|PROCESO cuenta;
   alfa1 = #0#3; |QBF alfa1;
   alfa2 = alfa1 % 0;
   nume1 = alfa2;

   |ABRE #8;
   #8#2 = enPlan;
   #8#0 = #0#3;
   |LEE 001#8=;
   |SI FSalida ! 0;
       #8#2 = enPlan;
       #8#0 = #0#3;
       #8#1 = #0#4;
       |SI nume1 [ 4; |GRABA 020#8n; |FINSI;
   |FINSI;
   |CIERRA #8;
|FPRC;

|PROCESO apertura; |TIPO 0;
 cuenta = #0#3 % 101;
 |SI cuenta = "6"; |O cuenta = "7";
     #0#5 = 0;
 |SINO;
     #0#5 = #0#9;
 |FINSI;
 |PINTA #0#5;
|FPRC;

|PROCESO saldo; |TIPO 0;
 #0#8 = #0#5 + #0#6 - #0#7;
 |PINTA #0#8;
|FPRC;

|PROCESO actualiz; |TIPO 2;
    alfa1 = #0#3 % 103;
    #1#4 = #1#4 +. #0#6;
    #1#5 = #1#5 +. #0#7;
    #1#6 = #1#6 +. #0#8;
    |SI alfa1 ! "129";
        #1#3 = #1#3 +. #0#5;
        #1#7 = #1#7 +. #0#9;
    |FINSI;

    |PINTA #1#3;
    |PINTA #1#4;
    |PINTA #1#5;
    |PINTA #1#6;
    |PINTA #1#7;
|FPRC;
