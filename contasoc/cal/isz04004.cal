|FICHEROS;
     isz00004 #0;
     isocie30 #3;
     isocie06 #4;
     isocie09 #7;
     isocie10 #8;
     isocie38 #9;
     isocie52 #10;
     isocie55 #11;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &tipo    = 0;

     xxx      = 0;
     total    = 0;
     tipo_b   = "";
     linea    = 0;
     total_de = 0;
     l_linea  = 0;
     anyo_ant = 0;
     anyo_ded = 0;
     tipo_p   = "";
     tipo_n   = 0;
     casilla_p = 0;
     casilla_a = 0;
|FIN;

||**************************************************************************
||                      PROCESO DE IMPORTACION A¥O 96
||**************************************************************************

|PROCESO resumen_96;
#11#0 = empresa;
#11#1 = anyo;
|LIBERA #11;
|LEE 140#11=;
|SI FSalida ! 0; |DDEFECTO #11; #11#0 = empresa;  #11#1 = anyo; |FINSI;

casilla_p    = casilla_a    + 2;
#11casilla_a = #11casilla_a + total;
#11casilla_p = #11casilla_p + total;
|HAZ calcula_11_96;

|SI FSalida ! 0; |GRABA 140#11n; |SINO; |GRABA 140#11a; |FINSI;
|FPRC;

|PROCESO calcula_11_96;
#11#44 = 0;
#11#45 = 0;
#11#46 = 0;
|PARA xxx = 2; |SI xxx [ 41; |HACIENDO xxx = xxx + 1;
                     #11#44 = #11#44 + #11xxx;
      xxx = xxx + 1; #11#45 = #11#45 + #11xxx;
      xxx = xxx + 1; #11#46 = #11#46 + #11xxx;
|SIGUE;

#11#71 = 0;
#11#72 = 0;
#11#73 = 0;
|PARA xxx = 50; |SI xxx [ 68; |HACIENDO xxx = xxx + 1;
                     #11#71 = #11#71 + #11xxx;
      xxx = xxx + 1; #11#72 = #11#72 + #11xxx;
      xxx = xxx + 1; #11#73 = #11#73 + #11xxx;
|SIGUE;

#11#95 = 0;
#11#96 = 0;
#11#97 = 0;
|PARA xxx = 74; |SI xxx [ 92; |HACIENDO xxx = xxx + 1;
                     #11#95 = #11#95 + #11xxx;
      xxx = xxx + 1; #11#96 = #11#96 + #11xxx;
      xxx = xxx + 1; #11#97 = #11#97 + #11xxx;
|SIGUE;

#11#116 = 0;
#11#117 = 0;
#11#118 = 0;
|PARA xxx = 98; |SI xxx [ 110; |HACIENDO xxx = xxx + 1;
                     #11#116 = #11#116 + #11xxx;
      xxx = xxx + 1; #11#117 = #11#117 + #11xxx;
      xxx = xxx + 1; #11#118 = #11#118 + #11xxx;
|SIGUE;

#11#134 = 0;
#11#135 = 0;
#11#136 = 0;
|PARA xxx = 119; |SI xxx [ 131; |HACIENDO xxx = xxx + 1;
                     #11#134 = #11#134 + #11xxx;
      xxx = xxx + 1; #11#135 = #11#135 + #11xxx;
      xxx = xxx + 1; #11#136 = #11#136 + #11xxx;
|SIGUE;

#11#152 = 0;
#11#153 = 0;
#11#154 = 0;
|PARA xxx = 137; |SI xxx [ 149; |HACIENDO xxx = xxx + 1;
                     #11#152 = #11#152 + #11xxx;
      xxx = xxx + 1; #11#153 = #11#153 + #11xxx;
      xxx = xxx + 1; #11#154 = #11#154 + #11xxx;
|SIGUE;
|FPRC;

|PROCESO el96_30;
|SI total_de = 0; |ACABA; |FINSI;

|SI #3#7 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #3#7;
    #3#1 = anyo;
    #3#2 = linea;
    |GRABA 140#3n;
    |LIBERA #3;
|SINO;
    linea    = linea + 1;
    #3#1 = anyo;
    #3#2 = linea;
    #3#7 = total_de;
    |GRABA 140#3n;
    |LIBERA #3;
    total_de = 0;
|FINSI;

total = #3#7;
|SI anyo_ded = 91; casilla_a = 2;  |FINSI;
|SI anyo_ded = 92; casilla_a = 8;  |FINSI;
|SI anyo_ded = 93; casilla_a = 14; |FINSI;

|SI anyo_ded = 94;
    |SI #3#9 = 1; casilla_a = 20; |FINSI;
    |SI #3#9 = 2; casilla_a = 23; |FINSI;
    |SI #3#9 = 3; casilla_a = 26; |FINSI;
|FINSI;

|SI anyo_ded = 95;
    |SI #3#9 = 1; casilla_a = 32; |FINSI;
    |SI #3#9 = 2; casilla_a = 35; |FINSI;
    |SI #3#9 = 3; casilla_a = 38; |FINSI;
|FINSI;

|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie30_96s;
#3#1;
3, 8, 9;
empresa, anyo_ant, 001, anyo_ded, "S", tipo_n;
empresa, anyo_ant, 999, anyo_ded, "S", tipo_n;
be;
NULL, el96_30;
|FIN;

|DEFBUCLE isocie30_96n;
#3#1;
3, 8, 9;
empresa, anyo_ant, 001, anyo_ded, "N", tipo_n;
empresa, anyo_ant, 999, anyo_ded, "N", tipo_n;
be;
NULL, el96_30;
|FIN;

|PROCESO ficher96_30;
|ABRE #3;
|BUCLE isocie30_96s;
|BUCLE isocie30_96n;
|CIERRA #3;
|FPRC;

|PROCESO el96_06;
|SI total_de = 0; |ACABA; |FINSI;

|SI #4#8 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #4#8;
    #3#0     = empresa;
    #3#1     = anyo;
    #3#2     = linea;
    #3#3     = 95;
    #3#4     = 35;
    #3#5     = #4#5;
    #3#6     = 0;
    #3#7     = #4#8;
    #3#8     = #4#9;
    #3#9     = 1;
    |SI #4#3 = "AE"; #3#9 = 2; #3#4 = 25; |FINSI;
    |SI #4#3 = "FP"; #3#9 = 3; #3#4 = 25; |FINSI;
    |GRABA 140#3n;
    |LIBERA #3;
|SINO;
    linea    = linea + 1;
    #3#0     = empresa;
    #3#1     = anyo;
    #3#2     = linea;
    #3#3     = 95;
    #3#4     = 25;
    #3#5     = #4#5;
    #3#6     = 0;
    #3#7     = total_de;
    #3#8     = #4#9;
    #3#9     = 1;
    |SI #4#3 = "AE"; #3#9 = 2; #3#4 = 25; |FINSI;
    |SI #4#3 = "FP"; #3#9 = 3; #3#4 = 25; |FINSI;
    |GRABA 140#3n;
    |LIBERA #3;
    total_de = 0;
|FINSI;

total     = #3#7;
casilla_a = 32;
|SI #4#3  = "AE"; casilla_a = 35; |FINSI;
|SI #4#3  = "FP"; casilla_a = 38; |FINSI;
|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie06_96s;
#4#1;
3, 9;
empresa, anyo_ant, 001, tipo_p, "S";
empresa, anyo_ant, 999, tipo_p, "S";
be;
NULL, el96_06;
|FIN;

|DEFBUCLE isocie06_96n;
#4#1;
3, 9;
empresa, anyo_ant, 001, tipo_p, "N";
empresa, anyo_ant, 999, tipo_p, "N";
be;
NULL, el96_06;
|FIN;

|PROCESO ficher96_06;
|ABRE #3;
|BUCLE isocie06_96s;
|BUCLE isocie06_96n;
|CIERRA #3;
|FPRC;

|PROCESO el96_38;
|SI total_de = 0; |ACABA; |FINSI;
l_linea = #9#2;
|SI #9#9 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #9#9;
    #9#1 = anyo;
    #9#2 = linea;
    |GRABA 140#9n;
    |LIBERA #9;
|SINO;
    linea    = linea + 1;
    #9#1 = anyo;
    #9#2 = linea;
    #9#9 = total_de;
    |GRABA 140#9n;
    |LIBERA #9;
    total_de = 0;
|FINSI;
total = #9#9;

|SI #9#3 = "E";
    |SI #9#4 = 91; casilla_a = 74; |FINSI;
    |SI #9#4 = 92; casilla_a = 77; |FINSI;
|FINSI;

|SI #9#3 = "J";
    |SI #9#4 = 91; casilla_a = 80; |FINSI;
    |SI #9#4 = 92; casilla_a = 83; |FINSI;
|FINSI;

|SI #9#3 = "M";
    |SI #9#4 = 91; casilla_a = 86; |FINSI;
    |SI #9#4 = 92; casilla_a = 89; |FINSI;
|FINSI;

|SI #9#3 = "1";
    |SI #9#4 = 92; casilla_a = 119; |FINSI;
    |SI #9#4 = 93; casilla_a = 122; |FINSI;
    |SI #9#4 = 94; casilla_a = 125; |FINSI;
    |SI #9#4 = 95; casilla_a = 128; |FINSI;
|FINSI;

|SI #9#3 = "2";
    |SI #9#4 = 92; casilla_a = 137; |FINSI;
    |SI #9#4 = 93; casilla_a = 140; |FINSI;
    |SI #9#4 = 94; casilla_a = 143; |FINSI;
    |SI #9#4 = 95; casilla_a = 146; |FINSI;
|FINSI;

|SI #9#3 = "3";
    |SI #9#4 = 93; casilla_a = 92; |FINSI;
|FINSI;

|HAZ resumen_96;

#9#0 = empresa;
#9#1 = anyo_ant;
#9#2 = l_linea;
|LIBERA #9;
|LEE 140#9=;
|FPRC;

|DEFBUCLE isocie38_96s;
#9#1;
3, 4, 10;
empresa, anyo_ant, 001, tipo_p, anyo_ded, "S";
empresa, anyo_ant, 999, tipo_p, anyo_ded, "S";
be;
NULL, el96_38;
|FIN;

|DEFBUCLE isocie38_96n;
#9#1;
3, 4, 10;
empresa, anyo_ant, 001, tipo_p, anyo_ded, "N";
empresa, anyo_ant, 999, tipo_p, anyo_ded, "N";
be;
NULL, el96_38;
|FIN;

|PROCESO ficher96_38;
|BUCLE isocie38_96s;
|BUCLE isocie38_96n;
|FPRC;

|PROCESO el96_09;
|SI total_de = 0; |ACABA; |FINSI;
l_linea = #7#2;
|SI #7#6 [ total_de;
    linea    = linea + 1;
    total_de = total_de - #7#6;
    #7#1 = anyo;
    #7#2 = linea;
    |GRABA 140#7n;
    |LIBERA #7;
|SINO;
    linea    = linea + 1;
    #7#1 = anyo;
    #7#2 = linea;
    #7#6 = total_de;
    |GRABA 140#7n;
    |LIBERA #7;
    total_de = 0;
|FINSI;

total = #7#6;
|SI #7#3 = 91; casilla_a = 98;  |FINSI;
|SI #7#3 = 92; casilla_a = 101; |FINSI;
|SI #7#3 = 93; casilla_a = 103; |FINSI;
|SI #7#3 = 94; casilla_a = 107; |FINSI;
|HAZ resumen_96;

#7#0 = empresa;
#7#1 = anyo_ant;
#7#2 = l_linea;
|LIBERA #7;
|LEE 140#7=;
|FPRC;

|DEFBUCLE isocie09_96s;
#7#1;
3, 7;
empresa, anyo_ant, 001, anyo_ded, "S";
empresa, anyo_ant, 999, anyo_ded, "S";
be;
NULL, el96_09;
|FIN;

|DEFBUCLE isocie09_96n;
#7#1;
3, 7;
empresa, anyo_ant, 001, anyo_ded, "N";
empresa, anyo_ant, 999, anyo_ded, "N";
be;
NULL, el96_09;
|FIN;

|PROCESO ficher96_09;
|BUCLE isocie09_96s;
|BUCLE isocie09_96n;
|FPRC;

|PROCESO ficher96_10;
|ABRE #7;
|ABRE #8;
linea = linea + 1;
#8#0 = empresa;
#8#1 = anyo_ant;
|LEE 040#8=;
|SI FSalida = 0;
    #7#0 = empresa;
    #7#1 = anyo;
    #7#2 = linea;
    #7#3 = 95;
    #7#4 = "CREACION EMPLEO 1995";
    #7#6 = total_de;
    #7#7 = "S";
    |GRABA 140#7n;
    |LIBERA #7;

    total     = #7#6;
    casilla_a = 110;
    |HAZ resumen_96;
|FINSI;
|CIERRA #8;
|CIERRA #7;
|FPRC;

|PROCESO importa_96;
anyo_ant = anyo - 1

|ABRE #10;
|ABRE #11;
#10#0 = empresa;
#10#1 = anyo_ant;
|LEE 040#10=;
|SI FSalida ! 0; |CIERRA #10; |ACABA; |FINSI;

linea  = 0;
tipo_n = 0;
|SI #10#010 ! 0; total_de = #10#010; anyo_ded = 91;   |HAZ ficher96_30; |FINSI;
|SI #10#016 ! 0; total_de = #10#016; anyo_ded = 92;   |HAZ ficher96_30; |FINSI;
|SI #10#022 ! 0; total_de = #10#022; anyo_ded = 93;   |HAZ ficher96_30; |FINSI;
anyo_ded = 94;
|SI #10#028 ! 0; total_de = #10#028; tipo_n   = 1;    |HAZ ficher96_30; |FINSI;
|SI #10#145 ! 0; total_de = #10#145; tipo_n   = 2;    |HAZ ficher96_30; |FINSI;
|SI #10#148 ! 0; total_de = #10#148; tipo_n   = 3;    |HAZ ficher96_30; |FINSI;

|SI #10#037 ! 0; total_de = #10#037; tipo_p   = "AF"; |HAZ ficher96_06; |FINSI;
|SI #10#037 ! 0;                     tipo_p   = "EL"; |HAZ ficher96_06; |FINSI;
|SI #10#040 ! 0; total_de = #10#040; tipo_p   = "GI"; |HAZ ficher96_06; |FINSI;
|SI #10#040 ! 0;                     tipo_p   = "GA"; |HAZ ficher96_06; |FINSI;
|SI #10#046 ! 0; total_de = #10#046; tipo_p   = "AE"; |HAZ ficher96_06; |FINSI;
|SI #10#049 ! 0; total_de = #10#049; tipo_p   = "BI"; |HAZ ficher96_06; |FINSI;
|SI #10#052 ! 0; total_de = #10#052; tipo_p   = "FP"; |HAZ ficher96_06; |FINSI;
|SI #10#043 ! 0; total_de = #10#043; tipo_p   = "PC"; |HAZ ficher96_06; |FINSI;

linea  = 0;
tipo_p = "E";
|SI #10#064 ! 0; total_de = #10#064; anyo_ded = 91; |HAZ ficher96_38; |FINSI;
|SI #10#067 ! 0; total_de = #10#067; anyo_ded = 92; |HAZ ficher96_38; |FINSI;

tipo_p = "J";
|SI #10#073 ! 0; total_de = #10#073; anyo_ded = 91; |HAZ ficher96_38; |FINSI;
|SI #10#076 ! 0; total_de = #10#076; anyo_ded = 92; |HAZ ficher96_38; |FINSI;

tipo_p = "M";
|SI #10#082 ! 0; total_de = #10#082; anyo_ded = 91; |HAZ ficher96_38; |FINSI;
|SI #10#085 ! 0; total_de = #10#085; anyo_ded = 92; |HAZ ficher96_38; |FINSI;

tipo_p = "1";
|SI #10#115 ! 0; total_de = #10#115; anyo_ded = 92; |HAZ ficher96_38; |FINSI;
|SI #10#118 ! 0; total_de = #10#118; anyo_ded = 93; |HAZ ficher96_38; |FINSI;
|SI #10#121 ! 0; total_de = #10#121; anyo_ded = 94; |HAZ ficher96_38; |FINSI;
|SI #10#124 ! 0; total_de = #10#124; anyo_ded = 95; |HAZ ficher96_38; |FINSI;

tipo_p = "2";
|SI #10#130 ! 0; total_de = #10#130; anyo_ded = 92; |HAZ ficher96_38; |FINSI;
|SI #10#133 ! 0; total_de = #10#133; anyo_ded = 93; |HAZ ficher96_38; |FINSI;
|SI #10#136 ! 0; total_de = #10#136; anyo_ded = 94; |HAZ ficher96_38; |FINSI;
|SI #10#139 ! 0; total_de = #10#139; anyo_ded = 95; |HAZ ficher96_38; |FINSI;

tipo_p = "3";
|SI #10#088 ! 0; total_de = #10#088; anyo_ded = 93; |HAZ ficher96_38; |FINSI;

linea = 0;
|SI #10#097 ! 0; total_de = #10#097; anyo_ded = 91; |HAZ ficher96_09; |FINSI;
|SI #10#100 ! 0; total_de = #10#100; anyo_ded = 92; |HAZ ficher96_09; |FINSI;
|SI #10#103 ! 0; total_de = #10#103; anyo_ded = 93; |HAZ ficher96_09; |FINSI;
|SI #10#106 ! 0; total_de = #10#106; anyo_ded = 94; |HAZ ficher96_09; |FINSI;
|SI #10#109 ! 0; total_de = #10#109; anyo_ded = 95; |HAZ ficher96_10; |FINSI;

|CIERRA #10;
|CIERRA #11;
|FPRC;
