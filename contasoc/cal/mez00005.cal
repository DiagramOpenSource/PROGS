|FICHEROS;
     medeword #1;
     medgword #2;
     megwordz #98;
     mew00005 #99,MANTE;
|FIN;

|VARIABLES;
     aBase        = "";
     aDirPatron   = "";
     aFichero     = "";
     aFicheroD    = "";
     aFicheroH    = "";
     aNombreFich  = "";
     aNombreTexto = "";
     aCadena1     = "";
     aCadena2     = "";
     aQueEs       = "";
     aOrigen      = "";
     aDirTexto    = "";
     aExtension   = "";
     aDestino     = "";
     aNoSi        = "";
     aDirWord     = "";
     aDirMemoria  = "";
     aDirGestion  = "";
     aDirCuentas  = "";
     aDirActas    = "";
     aDirGrafico  = "";
     aDirEtiquet  = "";
     aAlfa        = "";
     aCapitulo    = "";

     nSwBueno     = 0;

     &eaExtension = "";
     &eaPrograma  = "";
|FIN;

|PROCESO Tipo11z05;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |LEE 101#99=;

     |SI #99#2 = "S";
         #99#2 = "N";
     |SINO;
         #99#2 = "S";
     |FINSI;

     |GRABA 020#99a;
     |LIBERA #99;

     |PINTA #99#2;

     |PTEC 809;
|FPRC;

|PROCESO CreaTexto;
     aNoSi = "N";
     |ABRE #1;
     |LEE 040#1p;
     |SI FSalida ! 0;
         eaExtension = "soc";
         eaPrograma  = "medeword";
         |SUB_EJECUTA_NP ":basica/dspatron";

         |ABRE #98; |CIERRA #98; |DELINDEX #98;
     |FINSI;

     |ABRE #2;
     |LEE 040#2p;
     |SI FSalida ! 0;
         |CIERRA #2;
         eaExtension = "soc";
         eaPrograma  = "medgword";
         |SUB_EJECUTA_NP ":basica/dspatron";
     |FINSI;
|FPRC;

|PROCESO LeeTexto;
     nSwBueno  = 0;
     aCapitulo = (aNombreFich % 107) < "";
     aQueEs    = aNombreFich % 101 < "";
     |SI aQueEs = "m";
         |ABRE #1;
         #1#0 = aNombreFich % 206;
         |LEE 040#1=;
         |SI FSalida = 0;
             aNombreTexto = #1#1;
             nSwBueno = 1;
         |FINSI;
         |CIERRA #1;
     |FINSI;

     |SI aQueEs = "g";
         |ABRE #2;
         #2#0 = aNombreFich % 206;
         |LEE 040#2=;
         |SI FSalida = 0;
             aNombreTexto = #2#1;
             nSwBueno = 1;
         |FINSI;
         |CIERRA #2;
     |FINSI;

     |SI aQueEs = "c";
         nSwBueno = 1;
         |SI aCapitulo = "ccuenta";
             aNombreTexto = "CUENTAS ANUALES ABREVIADAS PESETAS";
         |FINSI;
         |SI aCapitulo = "ccuenta";
             aNombreTexto = "CUENTAS ANUALES EXTENSAS PESETAS";
         |FINSI;
         |SI aCapitulo = "ccuenea";
             aNombreTexto = "CUENTAS ANUALES ABREVIADAS EUROS";
         |FINSI;
         |SI aCapitulo = "ccuenee";
             aNombreTexto = "CUENTAS ANUALES EXTENSAS EUROS";
         |FINSI;
         |SI aCapitulo = "ccuecea";
             aNombreTexto = "CUENTAS ANUALES ABREVIADAS COOPERATIVAS";
         |FINSI;
         |SI aCapitulo = "ccuecee";
             aNombreTexto = "CUENTAS ANUALES EXTENSAS COOPETATIVAS";
         |FINSI;
     |FINSI;

     |SI aQueEs = "a";
         |SI aCapitulo = "a010100";
             aNombreTexto =  "JUNTA UNIVERSAL CUENTAS ABREVIADAS CON BENEFICIOS";
         |FINSI;
         |SI aCapitulo = "a010200";
             aNombreTexto =  "JUNTA UNIVERSAL CUENTAS ABREVIADAS RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a010300";
             aNombreTexto = "JUNTA UNIVERSAL CUENTAS ABREVIADAS CON PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a020100";
             aNombreTexto = "JUNTA UNIVERSAL CUENTAS ORDINARIAS CON BENEFICIOS";
         |FINSI;
         |SI aCapitulo = "a020200";
             aNombreTexto = "JUNTA UNIVERSAL CUENTAS ORDINARIAS RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a020300";
             aNombreTexto = "JUNTA UNIVERSAL CUENTAS ORDINARIAS CON PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a030100";
             aNombreTexto =  "JUNTA UNIVERSAL (TRANSPARENCIA) CON BENEFICIOS";
         |FINSI;
         |SI aCapitulo = "a030200";
             aNombreTexto = "JUNTA UNIVERSAL (TRANSPARENCIA) RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a030300";
             aNombreTexto = "JUNTA UNIVERSAL (TRANSPARENCIA) CON PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a040100";
             aNombreTexto = "JUNTA UNIVERSAL (COOPERATIVAS) CON BENEFICIO";
         |FINSI;
         |SI aCapitulo = "a040200";
             aNombreTexto = "JUNTA UNIVERSAL (COOPERATIVAS) RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a040300";
             aNombreTexto = "JUNTA UNIVERSAL (COOPERATIVAS) CON PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a050100";
             aNombreTexto = "JUNTA UNIVERSAL (UNIPERSONAL) CON BENEFICIO";
         |FINSI;
         |SI aCapitulo = "a050200";
             aNombreTexto = "JUNTA UNIVERSAL (UNIPERSONAL) RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a050300";
             aNombreTexto = "JUNTA UNIVERSAL (UNIPERSONAL) CON PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a060100";
             aNombreTexto = "JUNTA UNIVERSAL (NO APROBACION DE CUENTAS)";
         |FINSI;
         |SI aCapitulo = "a070100";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ABREVIADAS) CON BENEFICIOS";
         |FINSI;
         |SI aCapitulo = "a070200";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ABREVIADAS) RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a070300";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ABREVIADAS) PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a080100";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ORDINARIAS) CON BENEFICIOS";
         |FINSI;
         |SI aCapitulo = "a080200";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ORDINARIAS) RESULTADO CERO";
         |FINSI;
         |SI aCapitulo = "a080300";
             aNombreTexto = "JUNTA NO UNIVERSAL (CUENTAS ORDINARIAS) PERDIDAS";
         |FINSI;
         |SI aCapitulo = "a090100";
             aNombreTexto = "JUNTA NO UNIVERSAL (NO APROBACION DE CUENTAS)";
         |FINSI;
         |SI aCapitulo = "a100100";
             aNombreTexto = "COOPERATIVAS (CERTIFICADO Y SOLICITUD DE DEPOSITO.)";
         |FINSI;
         |SI aCapitulo = "a500000";
             aNombreTexto = "INSTANCIA AL REGISTRADOR MERCANTIL";
         |FINSI;
         |SI aCapitulo = "a510000";
             aNombreTexto = "CARPETA DEL DEPOSITO DE CUENTAS";
         |FINSI;
         |SI aCapitulo = "a990100";
             aNombreTexto = "FECHA Y FIRMA DEL CERTIFICADO";
         |FINSI;
         |SI aCapitulo = "a990200";
             aNombreTexto = "FECHA Y FIRMA DEL CERTIFICADO MAS DOY FE DEL NOTARIO (UN SOLO FIRMANTE)";
         |FINSI;
         |SI aCapitulo = "a990300";
             aNombreTexto = "FECHA Y FIRMA DEL CERTIFICADO MAS DOY FE DEL NOTARIO (VARIOS FIRMANTES)";
         |FINSI;
         |SI aCapitulo = "a990500";
             aNombreTexto = "TEXTOS PARA CERTIFICAR QUE NO EXISTEN ACT.AMBIENTALES ";
         |FINSI;
         |SI aCapitulo = "a990501";
             aNombreTexto = "CONTINUACION TEXTOS PARA CERTIFICAR QUE NO EXISTEN ACT.AMBIENTALES ";
         |FINSI;
         |SI aCapitulo = "a990510";
             aNombreTexto = "TEXTOS PARA CERTIFICAR QUE EXISTEN ACT.AMBIENTALES ";
         |FINSI;
         |SI aCapitulo = "a990520";
             aNombreTexto = "TEXTOS PARA CERTIFICAR UNA SOC. ANONIMA SIN ACCIONES PROPIAS ";
         |FINSI;
         nSwBueno = 1;
     |FINSI;

     |SI aQueEs = "i";
         aNombreTexto = "DOCUMENTO EXCEL GRAFICOS CINCO EJERCICIOS";
         |SI aCapitulo = "infgese";
             aNombreTexto = "DOCUMENTO EXCEL GRAFICOS CINCO EJERCICIOS EUROS";
         |FINSI;
         nSwBueno = 1;
     |FINSI;

     |SI aQueEs = "e";
         aNombreTexto = "ETIQUETAS DISKETTE PARA EL DEPOSITO DE CUENTAS";
         nSwBueno = 1;
     |FINSI;
|FPRC;

|PROCESO CopiaFicheros;
     |SI #99#0 = "00000000   ";
         |SI #99#2 = "S";
             eaExtension = "soc";
             eaPrograma  = "medeword";
             |SUB_EJECUTA_NP ":basica/dspatron";
             |ABRE #98; |CIERRA #98; |DELINDEX #98;
         |FINSI;
         |ACABA;
     |FINSI;

     |SI #99#0 = "00000001   ";
         |SI #99#2 = "S";
             eaExtension = "soc";
             eaPrograma  = "medeword";
             |SUB_EJECUTA_NP ":basica/dspatron";
         |FINSI;
         |ACABA;
     |FINSI;

     aQueEs    = #99#0 % 101 < "";
     aFicheroD = aDirPatron  + #99#0;
     aFicheroH = "";

     |SI #99#2 = "S";
         |SI aQueEs = "m";  aFicheroH = aDirMemoria + #99#0;  |FINSI;
         |SI aQueEs = "g";  aFicheroH = aDirGestion + #99#0;  |FINSI;
         |SI aQueEs = "c";  aFicheroH = aDirCuentas + #99#0;  |FINSI;
         |SI aQueEs = "a";  aFicheroH = aDirActas   + #99#0;  |FINSI;
         |SI aQueEs = "i";  aFicheroH = aDirGrafico + #99#0;  |FINSI;
         |SI aQueEs = "e";  aFicheroH = aDirEtiquet + #99#0;  |FINSI;
     |FINSI;

     |SI aFicheroH ! "";
         |QBF aFicheroD;
         |QBF aFicheroH;
         aAlfa = "     Instalando Fichero " + #99#0;
         |MENSA aAlfa;
         |COPIA_FICHERO aFicheroD, aFicheroH;
     |FINSI;

     |QBF aFicheroD;
     |FBORRA aFicheroD;
|FPRC;

|DEFBUCLE mew00005;
     #99#1;
     ;
     "           ";
     "zzzzzzzzzzz";
     ;
     NULL, CopiaFicheros;
|FIN;

|RUTINA ClaveBaja99;
     #99#0 = "           ";
|FRUT;

|RUTINA ClaveAlta99;
     #99#0 = "zzzzzzzzzzz";
|FRUT;

|PROGRAMA;
     |DBASE aBase;

     |HAZ CreaTexto;

     aDirPatron = aBase + "planilla/";
     aFichero   = aDirPatron + "wpatron.tgz";
     |DESCOMPRIME aFichero;

     aFichero   = aDirPatron + "wpatron.tar";
     |DETAR aFichero, aDirPatron;

     |FBORRA aFichero;

     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;

     |ABRE #99;

     |DDEFECTO #99;
     #99#0 = "00000000";
     #99#1 = "FICHERO TEXTOS DE LA MEMORIA.";
     #99#2 = "N";
     |GRABA 020#99n;
     |LIBERA #99;

     #99#0 = "00000001";
     #99#1 = "FICHERO TEXTOS DEL INFORME DE GESTION";
     #99#2 = "N";
     |GRABA 020#99n;
     |LIBERA #99;

     aOrigen    = aDirPatron;
     aExtension = ".doc";

     |_PDIR aOrigen;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aCadena1 = aOrigen    > " ";
            aCadena2 = aExtension > " ";
            aDestino = aCadena1 - aCadena2;
            |SI aDestino ! aCadena1;
                aCadena1    = aOrigen > " ";
                aCadena2    = aDirPatron > " ";  |QBF aCadena2
                aNombreFich = aCadena1 - aCadena2;
                |HAZ LeeTexto;
                |SI nSwBueno = 1;
                    #99#0 = aNombreFich < "";
                    #99#1 = aNombreTexto;
                    #99#2 = aNoSi;
                    |GRABA 020#99n;
                    |LIBERA #99;
                |FINSI;
            |FINSI;

            |_SDIR aOrigen;
     |SIGUE;

     aOrigen    = aDirPatron;
     aExtension = ".xls";

     |_PDIR aOrigen;
     |PARA; |SI FSalida = 0; |HACIENDO;
            aCadena1 = aOrigen    > " ";
            aCadena2 = aExtension > " ";
            aDestino = aCadena1 - aCadena2;
            |SI aDestino ! aCadena1;
                aCadena1    = aOrigen > " ";
                aCadena2    = aDirPatron > " ";  |QBF aCadena2
                aNombreFich = aCadena1 - aCadena2;
                |HAZ LeeTexto;
                |SI nSwBueno = 1;
                    #99#0 = aNombreFich < "";
                    #99#1 = aNombreTexto;
                    #99#2 = aNoSi;
                    |GRABA 020#99n;
                    |LIBERA #99;
                |FINSI;
            |FINSI;

            |_SDIR aOrigen;
     |SIGUE;

     |CIERRA #99;

     |ENTLINEAL #1#99, -1, 4, 22, 1, ClaveBaja99, ClaveAlta99;


     aDirWord    = aBase + "word";               |MKDIR aDirWord;
     aDirMemoria = aBase + "word/" + "memoria";  |MKDIR aDirMemoria;
     aDirGestion = aBase + "word/" + "gestion";  |MKDIR aDirGestion;
     aDirCuentas = aBase + "word/" + "cuentas";  |MKDIR aDirCuentas;
     aDirActas   = aBase + "word/" + "actas";    |MKDIR aDirActas;
     aDirGrafico = aBase + "word/" + "graficos"; |MKDIR aDirGrafico;
     aDirEtiquet = aBase + "word/" + "etiqueta"; |MKDIR aDirEtiquet;

     aDirMemoria = aBase + "word/" + "memoria/";
     aDirGestion = aBase + "word/" + "gestion/";
     aDirCuentas = aBase + "word/" + "cuentas/";
     aDirActas   = aBase + "word/" + "actas/";
     aDirGrafico = aBase + "word/" + "graficos/";
     aDirEtiquet = aBase + "word/" + "etiqueta/";

     |BUCLE mew00005;

     |DELINDEX #99;

     |SUB_EJECUTA "zmenumem;CREALO";
|FPRO;
