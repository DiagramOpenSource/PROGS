|FICHEROS;
      maempr10;
      maempr05;
      maempr12;
      maempr13;
      maempr16;
      maempr21;

      isom0000;
      isom0001;
      isom0006;
      isom0010;
      isom0013;
      isom0014;
      isom0015;
      isom0016;
      isom0022;
      isom0023;
      isom0026;
      isom0029;
      isom0030;
      isom0031;
      isom0032;
      isom0033;

      isom0507;
      isom0510;
      isom0511;
      isom0515;
      isom0516;
      isom0517;
      isom0518;
      isom0519;
      isom0520;

      isoh1801;
      isoh1821;
      isoh1623;
      isoh1824;
      isoh1625;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aAlfa3         = "";
     aAlfa4         = "";
     aBase          = "";
     aDirServidor   = "";
     aDirInternet   = "";
     aDirLanza      = "";
     aDelindex      = "";
     aFicheroT      = "";
     aFicheroP      = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";
     aLong          = "";
     aTecla         = "";
     aRetu          = "";
     aEsc1          = "";
     aEsc2          = "";

     nLong          = 0;
     nNume          = 0;
     nPos           = 0;
     nVal           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nVent          = 0;
     nPanta         = 0;
     nCasilla       = 0;
     nFecha         = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nContaBucle    = 0;
     nContaBucleL   = 0;
     nComple        = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nTotal         = 0;
     nValor626      = 0;
     nValor627      = 0;
     nValor628      = 0;
     nValor629      = 0;
     nCanti1        = 0;
     nCanti2        = 0;
     nCanti3           = 0;
     nCanti4           = 0;
     nCantiT           = 0;
     nResto            = 0;
     nTecla            = 0;
     nBotonCont        = 0;
     nBotonSal         = 0;
     nPasada           = 0;
     nImpor264         = 0;
     nImpor265         = 0;
     nImpor266         = 0;
     nImpor1741        = 0;
     nImpor1742        = 0;
     nImpor1743        = 0;
     nImpor1738        = 0;
     nImpor1739        = 0;
     nImpor1740        = 0;

     fFechaD        = @;
     fFechaH        = @;


     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enHandle        = 0;
     &enCanti         = 0;
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaEfectivo      = "";
     &eaAdeudo        = "";
     &eaEntidad       = "";
     &eaOficina       = "";
     &eaDC             = "";
     &eaCuenta         = "";
     &enModelo         = 0;
     &enBanco          = 0;
     &enFormaPag       = 0;
     &enForzar         = 0;
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaFinLinea       = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
     &eaCasilla        = "";
|FIN;

|PROCESO isom0510;
     #isom0022#0 = #maempr10#0;
     #isom0022#1 = #maempr10#1;
     #isom0022#2 = #isom0510#1;
     |LEE 000#isom0022.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0022;  |FINSI;

     |SI #isom0510#2 = "305  ";  |ACABA;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0022#5 ! 0;
             nHay = 1;
             |ERROR10;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0510#2 ! "     ";
         enCanti  = #isom0022#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0510;
      #isom0510#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0510;
|FIN;

|PROCESO isom0515;
     #isom0029#0 = #maempr10#0;
     #isom0029#1 = #maempr10#1;
     #isom0029#2 = #isom0515#1;
     |LEE 000#isom0029.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0029;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0029#2 = 35;  |ACABA;  |FINSI;
         |SI #isom0029#5 = 0;   |ACABA;  |FINSI;

         |SI #isom0515#7 = "1740 ";
             |SI #isom0029#13 = 0;  |Y #isom0029#15 = 0;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #isom0029#5  ! 0;  |O #isom0029#7  ! 0;
          |O #isom0029#9  ! 0;  |O #isom0029#11 ! 0;
          |O #isom0029#13 ! 0;  |O #isom0029#15 ! 0;
             nHay = 1;
             |ERROR10;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0515#7 = "1740 ";
         nImpor1738 = #isom0029#9;
         nImpor1739 = #isom0029#13;
         nImpor1740 = #isom0029#15;

         |SI #isom0029#13 = 0;  |Y #isom0029#15 = 0;
             #isom0029#9 = 0;
         |FINSI;
     |FINSI;

     |SI #isom0515#2 = "1212 ";
         |SI nImpor1739 = 0;  |Y nImpor1740 = 0;
             #isom0029#9  = #isom0029#9  - nImpor1738;
             #isom0029#13 = #isom0029#13 - nImpor1739;
             #isom0029#15 = #isom0029#15 - nImpor1740;
         |FINSI;
     |FINSI;

     |SI #isom0515#2 ! "     ";
         enCanti  = #isom0029#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#3 ! "     ";
         enCanti  = #isom0029#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#5 ! "     ";
         enCanti  = #isom0029#9 + #isom0029#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#6 ! "     ";
         enCanti  = #isom0029#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#7 ! "     ";
         enCanti  = #isom0029#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0515;
      #isom0515#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0515;
|FIN;

|PROCESO isom0511;
     #isom0023#0 = #maempr10#0;
     #isom0023#1 = #maempr10#1;
     #isom0023#2 = #isom0511#1;
     |LEE 000#isom0023.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0023;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0023#2 = 35;  |ACABA;  |FINSI;
         |SI #isom0023#5 = 0;   |ACABA;  |FINSI;

         |SI #isom0511#2 = "1741";
             |SI #isom0023#9 = 0;  |ACABA;  |FINSI;
         |FINSI;

         nHay = 1;
         |ERROR10;

         |ACABA;
     |FINSI;

     |SI #isom0511#2 = "1741 ";
         nImpor1741 = #isom0023#5;
         nImpor1742 = #isom0023#7;
         nImpor1743 = #isom0023#9;

         |SI #isom0023#9 = 0;
             #isom0023#5 = 0;
             #isom0023#7 = 0;
         |FINSI;
     |FINSI;

     |SI #isom0511#2 = "538  ";
         |SI nImpor1743 = 0;
             #isom0023#5 = #isom0023#5 - nImpor1741;
             #isom0023#7 = #isom0023#7 - nImpor1742;
         |FINSI;
     |FINSI;

     |SI #isom0511#2 ! "     ";
         enCanti  = #isom0023#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0511#3 ! "     ";
         enCanti  = #isom0023#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0511#4 ! "     ";
         enCanti  = #isom0023#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |SINO;
         |SI #isom0511#2 = "890  ";
             enCanti  = 0;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isom0511;
      #isom0511#1;
      ;
      #maempr10#1, 0010;
      #maempr10#1, 9999;
      ;
      NULL, isom0511;
|FIN;

|PROCESO Hoja20;
     |SI #isoh1801#61 = "1";  |ACABA;  |FINSI;
     |SI #isoh1801#62 = "1";  |ACABA;  |FINSI;

     nHay    = 0;
     nPasada = 0;
     |ABRE #isom0022;  |SELECT #1#isom0022;
     |ABRE #isom0023;  |SELECT #1#isom0023;
     |ABRE #isom0029;  |SELECT #1#isom0029;

     |SI nHay = 0;  |BUCLE isom0510;     |FINSI;
     |SI nHay = 0;  |BUCLE isom0515;     |FINSI;
     |SI nHay = 0;  |BUCLE isom0511;     |FINSI;

     |CIERRA #isom0022;
     |CIERRA #isom0023;
     |CIERRA #isom0029;

     |SI nHay = 0;  |ACABA;  |FINSI;

     eaAlfa = "<T20020000> ";  |HAZ GrabaSecuencial;

     nPasada = 1;

     |ABRE #isom0022; |SELECT #1#isom0022; |BUCLE isom0510; |CIERRA #isom0022;
     |ABRE #isom0029; |SELECT #1#isom0029; |BUCLE isom0515; |CIERRA #isom0029;

     |ABRE #isom0023; |SELECT #1#isom0023; |BUCLE isom0511; |CIERRA #isom0023;

     eaAlfa = " " * 200;       |HAZ GrabaSecuencial;
     eaAlfa = "</T20020000>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0516_02;
     #isom0026#0 = #maempr10#0;
     #isom0026#1 = #maempr10#1;
     #isom0026#2 = #isom0516#1;
     |LEE 000#isom0026.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0026;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0026#5  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0026#7  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0026#9  ! 0;  nHay = 1;  |ERROR10;  |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0516#3 ! "     ";
         enCanti  = #isom0026#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0516#4 ! "     ";
         enCanti  = #isom0026#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0516#5 ! "     ";
         enCanti  = #isom0026#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0516_02;
      #isom0516#1;
      ;
      #maempr10#1, nDesde;
      #maempr10#1, nHasta;
      ;
      NULL, isom0516_02;
|FIN;

|PROCESO isom0517;
     #isom0030#0 = #maempr10#0;
     #isom0030#1 = #maempr10#1;
     #isom0030#2 = #isom0517#1;
     |LEE 000#isom0030.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0030;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0030#5  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#7  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#9  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#10 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#12 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#13 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#15 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0030#17 ! 0;  nHay = 1;  |ERROR10;  |FINSI;

         |ACABA;
      |FINSI;

     |SI #isom0517#3 ! "     ";
         enCanti  = #isom0030#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0517#4 ! "     ";
         enCanti  = #isom0030#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0517#5 ! "     ";
         enCanti  = #isom0030#9 + #isom0030#10;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0517#6 ! "     ";
         enCanti  = #isom0030#12 + #isom0030#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0517#7 ! "     ";
         enCanti  = #isom0030#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0517#8 ! "     ";
         enCanti  = #isom0030#17;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0517;
      #isom0517#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0517;
|FIN;

|PROCESO Hoja20B;
     nHay    = 0;
     nPasada = 0;
     |ABRE #isom0026;  |SELECT #1#isom0026;
     |ABRE #isom0030;  |SELECT #1#isom0030;

     nHay      = #isom0000#128;
     eaCasilla = "1518";  |HAZ LeeFich106;  nHay = nHay + #isom0006#5 + #isom0006#7;
     eaCasilla = "333";   |HAZ LeeFich106;  nHay = nHay + #isom0006#5 + #isom0006#7;

     |SI nHay = 0;
         nDesde = 15;   nHasta = 45;  |BUCLE isom0516_02;
     |FINSI;

     |SI nHay = 0;
         |BUCLE isom0517;
     |FINSI;

     |CIERRA #isom0026;
     |CIERRA #isom0030;

     |SI nHay = 0;  |ACABA;  |FINSI;

     eaAlfa = "<T20020B00> ";  |HAZ GrabaSecuencial;

     nPasada = 1;

     |ABRE #isom0026; |SELECT #1#isom0026;
     nDesde = 15;   nHasta = 45;  |BUCLE isom0516_02;
     |CIERRA #isom0026;

     |ABRE #isom0030; |SELECT #1#isom0030;
     |BUCLE isom0517;
     |CIERRA #isom0030;

     enCanti  = #isom0000#127;
     |SI enCanti ] 10;  enCanti = 9;  |FINSI;
     eaAlfa = enCanti;
     |HAZ GrabaSecuencial;

     enCanti  = #isom0000#128;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     nVal = #isom0000#128;

     eaCasilla = "1518";  |HAZ LeeFich106;  enCanti = #isom0006#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     nVal = nVal - #isom0006#5;

     eaCasilla = "333";  |HAZ LeeFich106;   enCanti = #isom0006#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     nVal = nVal - #isom0006#5;

     enCanti  = nVal;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaAlfa = " " * 200;       |HAZ GrabaSecuencial;
     eaAlfa = "</T20020B00>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0518;
     #isom0031#0 = #maempr10#0;
     #isom0031#1 = #maempr10#1;
     #isom0031#2 = #isom0518#1;
     |LEE 000#isom0031.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0031;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0031#5  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#7  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#9  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#10 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#12 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#13 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#15 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#17 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0031#19 ! 0;  nHay = 1;  |ERROR10;  |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0518#3 ! "     ";
         enCanti  = #isom0031#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#4 ! "     ";
         enCanti  = #isom0031#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#5 ! "     ";
         enCanti  = #isom0031#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#6 ! "     ";
         enCanti  = #isom0031#11; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#7 ! "     ";
         enCanti  = #isom0031#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#8 ! "     ";
         enCanti  = #isom0031#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#9 ! "     ";
         enCanti  = #isom0031#17;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0518#10 ! "     ";
         enCanti  = #isom0031#19;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0518;
      #isom0518#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0518;
|FIN;

|PROCESO isom0519;
     #isom0032#0 = #maempr10#0;
     #isom0032#1 = #maempr10#1;
     #isom0032#2 = #isom0519#1;
     |LEE 000#isom0032.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0032;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0032#5  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#7  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#9  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#10 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#12 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#13 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#15 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#17 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#19 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#21 ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0032#23 ! 0;  nHay = 1;  |ERROR10;  |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0519#3 ! "     ";
         enCanti  = #isom0032#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#4 ! "     ";
         enCanti  = #isom0032#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#5 ! "     ";
         enCanti  = #isom0032#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#6 ! "     ";
         enCanti  = #isom0032#11; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#7 ! "     ";
         enCanti  = #isom0032#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#8 ! "     ";
         enCanti  = #isom0032#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#9 ! "     ";
         enCanti  = #isom0032#17;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#10 ! "     ";
         enCanti  = #isom0032#19;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#11 ! "     ";
         enCanti  = #isom0032#21;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0519#12 ! "     ";
         enCanti  = #isom0032#23;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0519;
      #isom0519#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0519;
|FIN;

|PROCESO isom0520;
     #isom0033#0 = #maempr10#0;
     #isom0033#1 = #maempr10#1;
     #isom0033#2 = #isom0520#1;
     |LEE 000#isom0033.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0033;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0033#5  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0033#7  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0033#9  ! 0;  nHay = 1;  |ERROR10;  |FINSI;
         |SI #isom0033#10 ! 0;  nHay = 1;  |ERROR10;  |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0520#3 ! "     ";
         enCanti  = #isom0033#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0520#4 ! "     ";
         enCanti  = #isom0033#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0520#5 ! "     ";
         enCanti  = #isom0033#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0520#6 ! "     ";
         enCanti  = #isom0033#11; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0520;
      #isom0520#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0520;
|FIN;

|PROCESO Hoja20C;
     |SI #isoh1801#61 = "1";  |ACABA;  |FINSI;
     |SI #isoh1801#62 = "1";  |ACABA;  |FINSI;

     nHay    = 0;
     nPasada = 0;
     |ABRE #isom0031;  |SELECT #1#isom0031;
     |ABRE #isom0032;  |SELECT #1#isom0032;
     |ABRE #isom0033;  |SELECT #1#isom0033;

     nHay      = #isom0000#121;
     eaCasilla = "1020";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1021";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1043";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1044";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;

     |SI nHay = 0;  |BUCLE isom0518;  |FINSI;
     |SI nHay = 0;  |BUCLE isom0519;  |FINSI;
     |SI nHay = 0;  |BUCLE isom0520;  |FINSI;

     |CIERRA #isom0031;
     |CIERRA #isom0032;
     |CIERRA #isom0033;

     |SI nHay = 0;  |ACABA;  |FINSI;

     eaAlfa = "<T20020C00> ";  |HAZ GrabaSecuencial;

     nPasada = 1;

     |ABRE #isom0031; |SELECT #1#isom0031;
     |BUCLE isom0518;
     |CIERRA #isom0031;

     |ABRE #isom0032; |SELECT #1#isom0032;
     |BUCLE isom0519;
     |CIERRA #isom0032;

     enCanti  = #isom0000#121;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "1020";  |HAZ LeeFich101;  enCanti = #isom0001#5;
     eaCasilla = "1043";  |HAZ LeeFich101;  enCanti = enCanti + #isom0001#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "1021";  |HAZ LeeFich101;  enCanti = #isom0001#5;
     eaCasilla = "1044";  |HAZ LeeFich101;  enCanti = enCanti + #isom0001#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     |ABRE #isom0033; |SELECT #1#isom0033;
     |BUCLE isom0520;
     |CIERRA #isom0033;

     eaAlfa = " " * 200;       |HAZ GrabaSecuencial;
     eaAlfa = "</T20020C00>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO CogePais;
     |ABRE #maempr16;
     #maempr16#0 = aPais;
     |LEE 000#maempr16.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr16;  |FINSI;
     |CIERRA #maempr16;

     aCodPais = #maempr16#2;
|FPRC;

|PROCESO isom0013;
     nContaBucle  = nContaBucle + 1;
     #isoh1821#0  = ((nContaBucle / 12) + .49) ! 0;

     |LEE 101#isoh1821.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1821;
         nContaBucleL = 6;

         #isoh1821#0  = ((nContaBucle / 12) + .49) ! 0;

                               #isoh1821#5 = "";
         |SI #isoh1821#0 ! 1;  #isoh1821#5 = "C";  nComple = 1;  |FINSI;

         #isoh1821#3   = "21000";
         #isoh1821#62 = "</T20021000>";

         |GRABA 020#isoh1821.b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     #isoh1821#nContaBucleL# = #isom0013#3;

     nContaBucleL = nContaBucleL + 2;
     #isoh1821#nContaBucleL# = #isom0013#4;

     |GRABA 020#isoh1821.a;
     |LIBERA #isoh1821;
|FPRC;

|DEFBUCLE isom0013;
     #isom0013#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0013;
|FIN;

|PROCESO isom0014;
     nContaBucle  = nContaBucle + 1;
     #isoh1821#0  = ((nContaBucle / 5) + .49) ! 0;

     |LEE 101#isoh1821.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1821;
         nContaBucleL = 44;

         #isoh1821#0 = ((nContaBucle / 5) + .49) ! 0;

                               #isoh1821#5 = "";
         |SI #isoh1821#0 ! 1;  #isoh1821#5 = "C";  nComple = 1;  |FINSI;

         #isoh1821#3   = "21000";
         #isoh1821#62 = "</T20021000>";

         |GRABA 020#isoh1821.b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;

     #isoh1821#nContaBucleL# = #isom0014#3;

     |GRABA 020#isoh1821.a;
     |LIBERA #isoh1821;
|FPRC;

|DEFBUCLE isom0014;
     #isom0014#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0014;
|FIN;

|PROCESO isom0016;
     |SI #isom0016#2 = 1;  #isoh1821#56 = #isom0016#3;        |FINSI;
     |SI #isom0016#2 = 2;  #isoh1821#57 = #isom0016#3;        |FINSI;
     |SI #isom0016#2 = 3;  #isoh1821#58 = #isom0016#3;        |FINSI;
     |SI #isom0016#2 = 4;  #isoh1821#59 = #isom0016#3 % 113;  |FINSI;
     |SI #isom0016#2 = 5;  #isoh1821#60 = #isom0016#3 % 113;  |FINSI;
|FPRC;

|DEFBUCLE isom0016;
     #isom0016#1;
     ;
     #maempr10#0, #maempr10#1, 1;
     #maempr10#0, #maempr10#1, 5;
     ;
     NULL, isom0016;
|FIN;

|PROCESO isoh1821;
     |PARA nCampo = 1;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1821#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1821;
     #isoh1821#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, isoh1821;
|FIN;

|PROCESO Hoja21;
     nHay = 0;

     |SI #isoh1801#45 = "0";
         |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |ABRE #isom0016;
     #isom0016#0 = #maempr10#0;
     #isom0016#1 = #maempr10#1;
     #isom0016#2 = 1;
     |LEE 000#isom0016.];
     |SI FSalida = 0;  |Y  #isom0016#0 = #maempr10#0;  |Y #isom0016#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #isom0016;

     |SI #isoh1801#67 = "1";
         |ABRE #isom0013;
         #isom0013#0 = #maempr10#0;
         #isom0013#1 = #maempr10#1;
         #isom0013#2 = 1;
         |LEE 000#isom0013.];
         |SI FSalida = 0;  |Y  #isom0013#0 = #maempr10#0;  |Y #isom0013#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0013;
     |FINSI;

     |SI #isoh1801#32 = "1";
         |ABRE #isom0014;
         #isom0014#0 = #maempr10#0;
         #isom0014#1 = #maempr10#1;
         #isom0014#2 = 1;
         |LEE 000#isom0014.];
         |SI FSalida = 0;  |Y  #isom0014#0 = #maempr10#0;  |Y #isom0014#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0014;
     |FINSI;

     nValor = 0;
     |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |SI #isom0000#83 ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = "isoh1821" + Usuario;
     |NOME_DAT #isoh1821#aDelindex#;
     |ABRE #isoh1821; |CIERRA #isoh1821; |DELINDEX #isoh1821;

     |ABRE #isoh1821;
     #isoh1821#0 = 1;
     |LEE 101#isoh1821.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1821;
         #isoh1821#0   = 1;
         #isoh1821#5   = "";
         #isoh1821#2   = "200";
         #isoh1821#3   = "21000";
         #isoh1821#62  = "</T20021000>";

         |SI #isoh1801#67 = "1";
             enCanti   = #isom0000#80;  |HAZ Calcula17D;  #isoh1821#6 = eaAlfa;
         |FINSI;

         |SI #isoh1801#32 = "1";
             enCanti   = #isom0000#81;  |HAZ Calcula17D;  #isoh1821#43  = eaAlfa;
                                                          #isoh1821#44  = (("000" + #isom0000#82) % -103);
         |FINSI;

         |SI #isoh1801#23 = "1";  |O #isoh1801#22 = "1";  |O #isoh1801#32 = "1";
          |O #isoh1801#35 = "1";  |O #isoh1801#38 = "1";
             enCanti   = #isom0000#83;  |HAZ Calcula17D;  #isoh1821#50 = eaAlfa;
         |FINSI;

         eaAlfa    = (("0000" + #isom0000#2) % -104); #isoh1821#51 = eaAlfa;
         enCanti   = #isom0000#2;  |HAZ Calcula17D;
         enCanti   = #isom0000#3;  |HAZ Calcula17D;   #isoh1821#52 = eaAlfa;
         enCanti   = #isom0000#4;  |HAZ Calcula17D;   #isoh1821#53 = eaAlfa;
         enCanti   = #isom0000#5;  |HAZ Calcula17D;   #isoh1821#54 = eaAlfa;
         enCanti   = #isom0000#6;  |HAZ Calcula17D;   #isoh1821#55 = eaAlfa;

         |BUCLE isom0016;

         |GRABA 020#isoh1821.n;
         |LIBERA #isoh1821;
     |FINSI;

     |SI #isoh1801#67 = "1";
         nContaBucleL = 6;
         nContaBucle  = 0;   |BUCLE isom0013;
     |FINSI;

     |SI #isoh1801#32 = "1";
         nContaBucleL = 44;
         nContaBucle  = 0;   |BUCLE isom0014;
     |FINSI;

     |CIERRA #isoh1821;

     |BUCLE isoh1821;

     |ABRE #isoh1821; |CIERRA #isoh1821; |DELINDEX #isoh1821;
|FPRC;

|PROCESO isom0507Coo;
     #isom0010#0 = #maempr10#0;
     #isom0010#1 = #maempr10#1;
     #isom0010#2 = #isom0507#1;
     |LEE 000#isom0010.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0010;  |FINSI;

     |SI #isoh1801#29 = "0";  |Y #isoh1801#30 = "0";  |Y #isoh1801#31 = "0";
         #isom0010#4  = "";
         #isom0010#6  = 0;
         #isom0010#8  = 0;
         #isom0010#10 = 0;
     |FINSI;

     |SI #isom0507#4 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#6;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0507#5 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#8;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0507#6 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#10;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507Coo;
      #isom0507#1;
      ;
      #maempr10#1, nDesde;
      #maempr10#1, nHasta;
      ;
      NULL, isom0507Coo;
|FIN;

|PROCESO Hoja22;
     nHay   = 0;
     nValor = 0;

     |SI #isoh1801#29 = "0";  |Y #isoh1801#30 = "0";  |Y #isoh1801#31 = "0";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |SI #isoh1801#29 ! "0";  |O #isoh1801#30 ! "0";  |O #isoh1801#31 ! "0";
         eaCasilla = "694";   |HAZ LeeFich110;  nValor  = #isom0010#6;
         eaCasilla = "1225";  |HAZ LeeFich110;  nValor  = nValor + #isom0010#6;
     |FINSI;

     |PARA nCampo = 2;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     nValor = nValor + #isom0000#70  + #isom0000#74 + #isom0000#106;
     nValor = nValor + #isom0000#112 + #isom0000#116;
     nValor = nValor + #isom0000#110 + #isom0000#111;

     |SI nValor = 0;  |ACABA;  |FINSI;

     eaAlfa = "<T20022000> ";  |HAZ GrabaSecuencial;

     enCanti   = #isom0000#70;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#71;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#72;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#74;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#75;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#76;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#77;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#106; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#107; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#108; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#109; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#112; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#113; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#114; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#115; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#116; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#117; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#118; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#119; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#78;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#79;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     enCanti   = #isom0000#7;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#17;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#8;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#18;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#9;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#19;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#110; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#111; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#20;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#10;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#21;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#22;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#12;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#23;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#24;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#14;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#25;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#16;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti   = #isom0000#26;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     |ABRE #isom0010;
     |SELECT #1#isom0010;
     nCasilla = 5;
     nDesde   = 1005;    nHasta = 1105;  |BUCLE isom0507Coo;
     |CIERRA #isom0010;

     eaAlfa = " " * 200;       |HAZ GrabaSecuencial;
     eaAlfa = "</T20022000>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0015;
     nContaBucle  = nContaBucle + 1;
     #isoh1623#0  = ((nContaBucle / 5) + .49) ! 0;

     |SI #isoh1801#29 ! "0";  |O #isoh1801#30 ! "0";  |O #isoh1801#31 ! "0";
         eaCasilla = "694";  |HAZ LeeFich110;  nValor  = #isom0010#6;
     |FINSI;

     |LEE 101#isoh1623.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1623;
         #isoh1623#0 = ((nContaBucle / 3) + .49) ! 0;

                               #isoh1623#5 = "";
         |SI #isoh1623#0 ! 1;  #isoh1623#5 = "C";  nComple = 1;  |FINSI;

         #isoh1623#2   = "200";
         #isoh1623#3   = "23000";
         #isoh1623#52 = "</T20023000>";

         nCampo = 5;
         |GRABA 020#isoh1623.b;
     |FINSI;

     nCampo            = nCampo + 1;
     #isoh1623#nCampo# = #isom0015#3;

     nCampo            = nCampo + 1;
     #isoh1623#nCampo# = #isom0015#4;

     nCampo            = nCampo + 1;
     #isoh1623#nCampo# = #isom0015#5;

     nCampo            = nCampo + 1;
     #isoh1623#nCampo# = #isom0015#6;

     nCampo            = nCampo + 1;
     #isoh1623#nCampo# = #isom0015#7;

     nCampo            = nCampo + 1;
     aAlfa             = (#isom0015#8 % -104) + (#isom0015#8 % 402) + (#isom0015#8 % 102);
     #isoh1623#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#9;
     |HAZ Calcula17D;
     #isoh1623#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#10;
     |HAZ Calcula17D;
     #isoh1623#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#11;
     |HAZ Calcula17D;
     #isoh1623#nCampo# = eaAlfa;

     |GRABA 020#isoh1623.a;
     |LIBERA #isoh1623;
|FPRC;

|DEFBUCLE isom0015;
     #isom0015#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0015;
|FIN;

|PROCESO isoh1623;
     |PARA nCampo = 1;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1623#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1623;
     #isoh1623#1;
     ;
     01;
     99;
     ;
     NULL, isoh1623;
|FIN;

|PROCESO Hoja23;
     nHay = 0;

     |ABRE #isom0015;
     #isom0015#0 = #maempr10#0;
     #isom0015#1 = #maempr10#1;
     #isom0015#2 = 1;
     |LEE 000#isom0015.];
     |SI FSalida = 0;  |Y  #isom0015#0 = #maempr10#0;  |Y #isom0015#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #isom0015;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = "isoh1623" + Usuario;
     |NOME_DAT #isoh1623#aDelindex#;
     |ABRE #isoh1623; |CIERRA #isoh1623; |DELINDEX #isoh1623;

     |ABRE #isoh1623;
     |DDEFECTO #isoh1623;
     #isoh1623#0 = 1;

     #isoh1623#2   = "200";
     #isoh1623#3   = "23000";
     #isoh1623#5 = "";
     #isoh1623#52 = "</T20023000>";

     nContaBucle = 0;  |BUCLE isom0015;

     |CIERRA #isoh1623;

     |BUCLE isoh1623;

     |ABRE #isoh1623; |CIERRA #isoh1623; |DELINDEX #isoh1623;
|FPRC;

|PROCESO maempr05;
     nContaBucle  = nContaBucle + 1;
     #isoh1824#0  = ((nContaBucle / 10) + .49) ! 0;

     |LEE 101#isoh1824.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1824;
         #isoh1824#0     = ((nContaBucle / 10) + .49) ! 0;

                               #isoh1824#5   = "";
         |SI #isoh1824#0 ! 1;  #isoh1824#5   = "C";  nComple = 1;  |FINSI;

         #isoh1824#3   = "24000";
         #isoh1824#167 = "</T20024000>";
         nContaBucleL  = 0;

         |GRABA 020#isoh1824.b;
     |FINSI;

     nCampo = (nContaBucleL * 8) + 26;

     #isoh1824#nCampo# = #maempr05#3;

                              aAlfa = "0";
     |SI #maempr05#10 = "X";  aAlfa = "1";  |FINSI;

     nCampo            = nCampo + 1;
     #isoh1824#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     #isoh1824#nCampo# = #maempr05#4;

     nCampo            = nCampo + 1;
     #isoh1824#nCampo# = #maempr05#5;

     nCampo            = nCampo + 1;
     #isoh1824#nCampo# = #maempr05#6;

     nCampo            = nCampo + 1;
     nNume             = #maempr05#7;
     aAlfa             = ("00" + nNume) % -102;
     #isoh1824#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr05#8;
     |HAZ Calcula17D;
     #isoh1824#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr05#9;
     |HAZ Calcula3E4D;
     #isoh1824#nCampo# = eaAlfa;

     |GRABA 020#isoh1824.a;
     |LIBERA #isoh1824;

     nContaBucleL = nContaBucleL + 1;
|FPRC;

|DEFBUCLE maempr05;
     #maempr05#2;
     ;
     #maempr10#0, #maempr10#1, 999.99, 00;
     #maempr10#0, #maempr10#1,      0, 99;
     ;
     NULL, maempr05;
|FIN;

|PROCESO maempr21;
     nContaBucle  = nContaBucle + 1;
     #isoh1824#0  = ((nContaBucle / 10) + .49) ! 0;

     |LEE 101#isoh1824.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1824;
         #isoh1824#0     = ((nContaBucle / 11) + .49) ! 0;

                               #isoh1824#5   = "";
         |SI #isoh1824#0 ! 1;  #isoh1824#5   = "C";  nComple = 1;  |FINSI;

         #isoh1824#3   = "24000";
         #isoh1824#167 = "</T20024000>";

         nContaBucleL  = 0;

         |GRABA 020#isoh1824.b;
     |FINSI;

     nCampo            = (nContaBucleL * 6) + 106;
     #isoh1824#nCampo# = #maempr21#3;

     nCampo            = nCampo + 1;
     #isoh1824#nCampo# = #maempr21#4;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#5;  |HAZ Calcula17D;
     #isoh1824#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#6;  |HAZ Calcula17D;
     #isoh1824#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#7;  |HAZ Calcula17D;
     #isoh1824#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#8;  |HAZ Calcula17D;
     #isoh1824#nCampo# = eaAlfa;

     |GRABA 020#isoh1824.a;
     |LIBERA #isoh1824;

     nContaBucleL = nContaBucleL + 1;
|FPRC;

|DEFBUCLE maempr21;
     #maempr21#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, maempr21;
|FIN;

|PROCESO isoh1824;
     |PARA nCampo = 1;  |SI nCampo [ 167;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1824#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1824;
     #isoh1824#1;
     ;
     01;
     99;
     ;
     NULL, isoh1824;
|FIN;

|PROCESO Hoja24;
     |SI #isoh1801#27 = "0";  |Y #isoh1801#28 = "0";
         |ACABA;
     |FINSI;

     aDelindex = "isoh1824" + Usuario;
     |NOME_DAT #isoh1824#aDelindex#;
     |ABRE #isoh1824; |CIERRA #isoh1824; |DELINDEX #isoh1824;

     |ABRE #isoh1824;
     |DDEFECTO #isoh1824;

     #isoh1824#0  = 1;

     enCanti  = #isom0000#29;  |HAZ Calcula3E4D;  #isoh1824#6  = eaAlfa;

     eaCasilla = "500";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1824#7  = eaAlfa;

     eaCasilla = "1227";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1824#8  = eaAlfa;

     eaCasilla = "1228";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1824#9  = eaAlfa;

     eaCasilla = "552";   |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1824#10 = eaAlfa;

     eaCasilla = "1330";   |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1824#11 = eaAlfa;

     enCanti  = #isom0000#44;  |HAZ Calcula17D;   #isoh1824#12 = eaAlfa;
     enCanti  = #isom0000#45;  |HAZ Calcula3E2D;  #isoh1824#13 = eaAlfa;
     enCanti  = #isom0000#46;  |HAZ Calcula17D;   #isoh1824#14 = eaAlfa;
     enCanti  = #isom0000#47;  |HAZ Calcula3E2D;  #isoh1824#15 = eaAlfa;
     enCanti  = #isom0000#48;  |HAZ Calcula17D;   #isoh1824#16 = eaAlfa;
     enCanti  = #isom0000#49;  |HAZ Calcula3E2D;  #isoh1824#17 = eaAlfa;
     enCanti  = #isom0000#50;  |HAZ Calcula17D;   #isoh1824#18 = eaAlfa;
     enCanti  = #isom0000#51;  |HAZ Calcula3E2D;  #isoh1824#19 = eaAlfa;
     enCanti  = #isom0000#52;  |HAZ Calcula17D;   #isoh1824#20 = eaAlfa;
     enCanti  = #isom0000#53;  |HAZ Calcula17D;   #isoh1824#21 = eaAlfa;
     enCanti  = #isom0000#54;  |HAZ Calcula17D;   #isoh1824#22 = eaAlfa;
     enCanti  = #isom0000#55;  |HAZ Calcula17D;   #isoh1824#23 = eaAlfa;
     enCanti  = #isom0000#56;  |HAZ Calcula17D;   #isoh1824#24 = eaAlfa;
     enCanti  = #isom0000#57;  |HAZ Calcula17D;   #isoh1824#25 = eaAlfa;

     #isoh1824#3   = "24000";
     #isoh1824#167 = "</T20024000>";

     |GRABA 020#isoh1824.n;
     |LIBERA #isoh1824;

     nContaBucle = 0;  nContaBucleL = 0;  |BUCLE maempr05;
     nContaBucle = 0;  nContaBucleL = 0;  |BUCLE maempr21;

     |CIERRA #isoh1824;

     |BUCLE isoh1824;

     |ABRE #isoh1824; |CIERRA #isoh1824; |DELINDEX #isoh1824;
|FPRC;

|PROCESO maempr13;
     nContaBucleL  = nContaBucleL + 1;

     |SI nContaBucleL ] 6;
         |ERROR10;
         |ACABA;
     |FINSI;

     nCampo = ((((nContaBucle + 5) - (6 * #isoh1625#0)) * 9) + 9) + nContaBucleL;

     #isoh1625#nCampo# = #maempr13#4;
|FPRC;

|DEFBUCLE maempr13;
     #maempr13#1;
     ;
     #maempr12#0, #maempr12#1, #maempr12#2, 00;
     #maempr12#0, #maempr12#1, #maempr12#2, 99;
     ;
     NULL, maempr13;
|FIN;

|PROCESO maempr12;
     nContaBucle  = nContaBucle + 1;
     #isoh1625#0       = ((nContaBucle / 6) + .49) ! 0;

     |LEE 101#isoh1625.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1625;
         #isoh1625#0 = ((nContaBucle / 6) + .49) ! 0;

                               #isoh1625#5 = "";
         |SI #isoh1625#0 ! 1;  #isoh1625#5 = "C";  nComple = 1;  |FINSI;

         nTotal = 0;

         #isoh1625#3  = "25000";
         #isoh1625#62 = "</T20025000>";

         |GRABA 020#isoh1625.b;
     |FINSI;

     nCampo     = (((nContaBucle + 5) - (6 * #isoh1625#0)) * 9) + 6;
     #isoh1625#nCampo# = #maempr12#3;

     nCampo     = nCampo + 1;
     #isoh1625#nCampo# = #maempr12#4;

     nCampo     = nCampo + 1;
     aPais        = #maempr12#5 % 102;
     #isoh1625#nCampo# = aPais;

     nCampo     = nCampo + 1;
     enCanti      = #maempr12#6;
     |HAZ Calcula17D;
     #isoh1625#nCampo# = eaAlfa;

     nTotal       = nTotal + #maempr12#6;

     enCanti      = nTotal;
     |HAZ Calcula17D;
     #isoh1625#60      = eaAlfa;

     nContaBucleL = 0;  |BUCLE maempr13;

     |GRABA 020#isoh1625.a;
     |LIBERA #isoh1625;
|FPRC;

|DEFBUCLE maempr12;
     #maempr12#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, maempr12;
|FIN;

|PROCESO isoh1625;
     |PARA nCampo = 1;  |SI nCampo [ 62;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1625#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1625;
     #isoh1625#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, isoh1625;
|FIN;

|PROCESO Hoja25;
     nHay = 0;

     |ABRE #maempr12;
     #maempr12#0 = #maempr10#0;
     #maempr12#1 = #maempr10#1;
     #maempr12#2 = 1;
     |LEE 000#maempr12.];
     |SI FSalida = 0;  |Y  #maempr12#0 = #maempr10#0;  |Y #maempr12#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr12;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = "isoh1625" + Usuario;
     |NOME_DAT #isoh1625#aDelindex#;
     |ABRE #isoh1625; |CIERRA #isoh1625; |DELINDEX #isoh1625;

     |ABRE #isoh1625;

     |DDEFECTO #isoh1625;
     #isoh1625#0   = 1;
     #isoh1625#5   = "";
     nTotal        = 0;

     #isoh1625#3  = "25000";
     #isoh1625#62 = "</T20025000>";

     |GRABA 020#isoh1625.n;

     nContaBucle = 0;   |BUCLE maempr12;

     |CIERRA #isoh1625;

     |BUCLE isoh1625;

     |ABRE #isoh1625; |CIERRA #isoh1625; |DELINDEX #isoh1625;
|FPRC;

|PROCESO CalculaCas;
     nCanti1 = ((nValor * nValor626) / nTotal) ! 2;
     nCanti2 = ((nValor * nValor627) / nTotal) ! 2;
     nCanti3 = ((nValor * nValor628) / nTotal) ! 2;
     nCanti4 = ((nValor * nValor629) / nTotal) ! 2;
     nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
     nResto  = nValor - nCantiT;

     |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

     enCanti = nCanti1;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti2;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti3;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti4;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti1 + nCanti2 + nCanti3 + nCanti4;
                         |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja26;
     |SI #isoh1801#46 = "0";
         |ACABA;
     |FINSI;

     eaAlfa    = "<T20026000> ";  |HAZ GrabaSecuencial;

     eaCasilla = "050";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "051";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "052";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "053";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "054";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "055";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "056";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla  = "626";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor626  = #isom0001#5;

     eaCasilla  = "627";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor627  = #isom0001#5;

     eaCasilla  = "628";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor628  = #isom0001#5;

     eaCasilla  = "629";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor629  = #isom0001#5;

     eaCasilla  = "625";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;

     nTotal     = nValor626 + nValor627 + nValor628 + nValor629;

     eaCasilla  = "600";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "602";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "604";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "606";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "612";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "616";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "642";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "618";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "620";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1332"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1333"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "622";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1043"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1044"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;

     eaAlfa = " " * 200;         |HAZ GrabaSecuencial;
     eaAlfa = "</T20026000>";    |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;
