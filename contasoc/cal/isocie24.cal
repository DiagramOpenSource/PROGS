|FICHEROS;
    isocie24 #0;
    isocie22 #1;
    maempr01 #2;
    isocie36 #3;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &modo      = 0;

    suma    = 0;
    FEstado = 0;
    varcamp = 0;
    sw_estar = 0;
|FIN;

|PROGRAMA;
|ABRE #2;
#2#0 = empresa;
#2#1 = anyo;
|LEE 040#2=;
|SI FSalida ! 0; |DDEFECTO #2; |FINSI;

|SI #2#36 = " "; |Y #2#37 = " ";
    |MENAV "     La empresa no es una Cooperativa";
    |ACABA;
|FINSI;
|CIERRA #2;

|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|HAZ liquidacio;
|SI FEstado ! 0; #0#8 = #0#2; |FINSI;
|SI sw_estar = 0;
    |PINDA #0#0;
    |SI modo = 1; |ENDATOS #1#0;  |FINSI;
    |SI modo = 2; |ENDATOS #2#0;  |FINSI;
    |SI FSalida = 0;
        #0#0 = empresa;
        #0#1 = anyo;
        |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
        |LIBERA #0;
        |HAZ grabaliq;
    |FINSI;
|SINO;
    |MENAV "     No existe liquidacion";
|FINSI;
|FPRC;

|PROCESO consulta;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0;
     |PINPA #0#0;
     |PINDA #0#0;
     |PAUSA;
  |FINSI;
|FPRC;

|PROCESO liquidacio; |TIPO 0;
sw_estar = 0;
|SI anyo = 1992;
    |ABRE #1;
    #1#0 = #0#0;
    #1#1 = #0#1;
    |LEE 040#1=;
    |SI FSalida = 0;
        #0#2 = #1#2;
        #0#3 = #1#3;
        #0#4 = #1#4;
        #0#5 = #1#6;
        #0#6 = #1#7;
        #0#7 = #1#8;
    |SINO;
        sw_estar = 1;
    |FINSI;
    |CIERRA #1;
|FINSI;

|SI anyo = 1993;
    |ABRE #3;
    #3#0 = #0#0;
    #3#1 = #0#1;
    |LEE 040#3=;
    |SI FSalida = 0;
        #0#2 = #3#2;
        #0#3 = #3#3;
        #0#4 = #3#4;
        #0#5 = #3#6;
        #0#6 = #3#7;
        #0#7 = #3#8;
    |SINO;
        sw_estar = 1;
    |FINSI;
    |CIERRA #3;
|FINSI;
|FPRC;

|PROCESO resultado; |TIPO 0;
varcamp = Campo;
#0#11 =  ((#0#8 + #0#17) - (#0#9 + #0#18) - (#0#10 + #0#19) + #0#20);
|SI #0#11 > #0#2;
    |MENAV "     El Resultado supera al resultado de la liquidacion";
|FINSI;
|PINTA #0#11;
Campo = varcamp;
|FPRC;

|PROCESO campo11; |TIPO 0;
|SI #0#11 [ #0#2;
    #0#21 = #0#2 - #0#11;
    |PINTA #0#21;
|FINSI;
|FPRC;

|PROCESO campo12; |TIPO 0;
|SI #0#12 [ #0#3;
    #0#22 = #0#3 -  #0#12;
    |PINTA #0#22;
|FINSI;
|FPRC;

|PROCESO campo13; |TIPO 0;
|SI #0#13 [ #0#4;
    #0#23 = #0#4 - #0#13;
    |PINTA #0#23;
|FINSI;
|FPRC;

|PROCESO campo15; |TIPO 0;
|SI #0#15 [ #0#6;
    #0#25 = #0#6 - #0#15;
    |PINTA #0#25;
|FINSI;
|FPRC;

|PROCESO calculo; |TIPO 0;
varcamp = Campo;
#0#14 = #0#11 + #0#12 - #0#13;
#0#24 = #0#21 + #0#22 - #0#23;
#0#16 = #0#14 - #0#15;
#0#26 = #0#24 - #0#25;
|PINTA #0#14;
|PINTA #0#24;
|PINTA #0#16;
|PINTA #0#26;
Campo = varcamp;
|SI #0#11 > #0#2;
    |MENAV "     El Resultado supera al resultado de la liquidacion";
    |ERROR;
    |ACABA;
|FINSI;
|SI #0#12 > #0#3;
    |MENAV "     El Resultado supera al resultado de la liquidacion";
    |ERROR;
    |ACABA;
|FINSI;
|SI #0#13 > #0#4;
    |MENAV "     El Resultado supera al resultado de la liquidacion";
    |ERROR;
    |ACABA;
|FINSI;
|SI #0#15 > #0#6;
    |MENAV "     El Resultado supera al resultado de la liquidacion";
    |ERROR;
    |ACABA;
|FINSI;
|FPRC;

|PROCESO grabaliq;
|SI anyo = 1992;
    |ABRE #1;
    #1#0 = #0#0;
    #1#1 = #0#1;
    |LIBERA #1;
    |LEE 110#1=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #1; #1#0 = #0#0; #1#1 = #0#1; |FINSI;

    #1#9  = #0#16;
    #1#10 = #0#26;
    |SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
    |CIERRA #1;
|FINSI;

|SI anyo = 1993;
    |ABRE #3;
    #3#0 = #0#0;
    #3#1 = #0#1;
    |LIBERA #3;
    |LEE 110#3=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #3; #3#0 = #0#0; #3#1 = #0#1; |FINSI;

    #3#9  = #0#16;
    #3#10 = #0#26;
    |SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
    |CIERRA #3;
|FINSI;

|SUB_EJECUTA "ispant31.run";
|FPRC;
