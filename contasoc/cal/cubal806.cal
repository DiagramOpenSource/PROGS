|FICHEROS;
     cubal806 #0;
     cuacceso #100;
     cubal801 #1;
     cubal802 #2;
     cubal803 #3;
     cubal805 #5;
|FIN;

|VARIABLES;
   &empresa  = 0;
   &anyo     = 0;
   nCasilla  = 0;   ||Casilla Ctas Anuales
   nCampo9   = 0;   ||bloque
   aCampo10  = "";  ||tipo
   nCampo11  = 0;   ||agrupacion
   nCampo12  = 0;   ||subagrupacion
   nCampo13  = 0;   ||epigrafe
   nCampo14  = 0;   ||partida
   nCampo15  = 0;   ||subpartida
   nExis     = 0;
|FIN;

|PROCESO LeoSit;
     |DDEFECTO #1;
     #1#0  = empresa;
     #1#1  = anyo;
     #1#9  = nCampo9;
     #1#10 = aCampo10;
     #1#11 = nCampo11;
     #1#12 = nCampo12;
     #1#13 = nCampo13;
     #1#14 = nCampo14;
     #1#15 = nCampo15;
     |LEE 040#1=;
|FPRC;

|PROCESO LeoResul;
     |DDEFECTO #2;
     #2#0 = empresa;
     #2#1 = anyo;
     #2#16 = nCasilla;
     |LEE 040#2=;
     |SI nCasilla = 049504; |Y FSalida = 0;
         nExis = 1;
     |FINSI;
|FPRC;

|PROCESO Normal;
     |ABRE #1;
     |SELECT #2#1;

  || ... Total Activo
     nCampo9   = 0;
     aCampo10 = "A";
     nCampo11 = 99;
     nCampo12 = 0;
     nCampo13 = 0;
     nCampo14 = 0;
     nCampo15 = 0;
     |HAZ LeoSit;
     #0#15 = #1#7;
     #0#1  = #1#6;

     aCampo10 = "P";
     |HAZ LeoSit;
     #0#16 = #1#7;
     #0#2  = #1#6;

     |SELECT #1#1;
     |CIERRA #1;

     nExis = 0;
     |ABRE #2;
     |SELECT #3#2;
     nCasilla = 049100;
     |HAZ LeoResul;
     #0#17 = #2#7;
     #0#3  = #2#6;

     nCasilla = 049200;
     |HAZ LeoResul;
     #0#18 = #2#7;
     #0#4  = #2#6;

     nCasilla = 049300;
     |HAZ LeoResul;
     #0#19 = #2#7;
     #0#5  = #2#6;

     nCasilla = 041900;
     |HAZ LeoResul;
     #0#20 = #2#7;
     #0#6  = #2#6;

     nCasilla = 049400;
     |HAZ LeoResul;
     #0#21 = #2#7;
     #0#7  = #2#6;

     nCasilla = 049500;
     |HAZ LeoResul;
     #0#22 = #2#7;
     #0#8  = #2#6;

     nCasilla = 049504;
     |HAZ LeoResul;
     #0#23 = #2#7;
     #0#9  = #2#6;

     |SELECT #1#2;
     |CIERRA #2;

     #0#27 = #0#15 - #0#16;
     #0#13 = #0#1  - #0#2;

     |SI nExis = 0;
         |SI #0#22 > 0; #0#24 = #0#22; |SINO; #0#25 = -#0#22; |FINSI;
         |SI #0#8  > 0; #0#10 = #0#8;  |SINO; #0#11 = -#0#8;  |FINSI;
     |SINO;
         |SI #0#23 > 0; #0#24 = #0#23; |SINO; #0#25 = -#0#23; |FINSI;
         |SI #0#9  > 0; #0#10 = #0#9;  |SINO; #0#11 = -#0#9;  |FINSI;
     |FINSI;

    |SI nExis = 1;
        |ATRI I; |PINTA 2008, "D-A6)"; |ATRI 0;
        |PINTA 2013, " EXCEDENTE DE LA COOPERATIVA ............";
        |C_V #0#23,1, "S"; |C_V #0#9,1,"S";

        |ATRI P; |PINTA 2108, "BENEFICIOS";
        |PINTA 2208, "PERDIDAS"; |ATRI 0;
        |PINTA 2214, "..............................";
        |C_P #0#24, 1, 2155; |C_P #0#10,1,2168;
        |C_P #0#25, 1, 2255; |C_P #0#11,1,2268;
    |FINSI;
|FPRC;

|PROGRAMA;

     |PINPA #0#0;

     |ABRE #100;
     #100#0 = empresa;
     #100#1 = anyo;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |HAZ Normal;

     #0#0  = anyo - 1;
     #0#14 = anyo;

     |PINDA #0#0;

     |SI #0#27 = 0; |Y #0#13 = 0;
         |CUADRO 2125 2348;
         |ATRI R;
         |ATRI P;
         |PINTA 2226, "   C U A D R A D O    ";
         |ATRI 0;
     |SINO;
         |CUADRO 2125 2349;
         |ATRI R;
         |ATRI P;
         |PINTA 2226, " D E S C U A D R A D O ";
         |ATRI 0;
     |FINSI;

     |PAUSA;
|FPRO;
