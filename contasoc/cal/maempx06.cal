|FICHEROS;
     maempx06;
     maempr06;
     maempr10;
|FIN;

|VARIABLES;
     n0Vent         = 0;
     nEstado        = 0;
     nPan           = 0;
     nBtnAlt        = 0;
     nBtnMod        = 0;
     nBtnBor        = 0;
     nGrid          = 0;
     nRango         = 0;
     nIdSalir       = 0;
     nCampo         = 0;
     nModo          = 0;
     nPtec          = 0;

     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";
     aAlfa          = "";

     fFecha         = @;

     {2}nNivel      = 0;

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &enModoConsulta = 0;
     &enCalcCif      = 0;
     &eaVarDni       = "";
|FIN;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI nPtec = 1;
         |POSICIONATE #maempx06#3;
         |ERROR;
     |FINSI;

     nPtec = 0;
|FPRC;

|PROCESO PtecFinal;  |TIPO 0;
     nPtec = 1;
     |PTEC 806;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempx06#Campo#;
         |HAZ CalculoDNI;
         #maempx06#Campo# = eaVarDni;
         |PINTA #maempx06#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  =  #maempx06#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempx06#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempx06#Campo# = eaVarDni;  |PINTA #maempx06#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO PonModi;
                                  |PINTA #maempx06#2;
     |C_M #maempx06#03, 1, "S";   |PINTA #maempx06#3;
     |C_M #maempx06#04, 1, "S";   |PINTA #maempx06#4;
     |C_M #maempx06#05, 1, "S";   |PINTA #maempx06#5;
     |C_M #maempx06#06, 1, "S";   |PINTA #maempx06#6;
     |C_M #maempx06#07, 1, "S";   |PINTA #maempx06#7;
     |C_M #maempx06#08, 1, "S";   |PINTA #maempx06#8;
     |C_M #maempx06#21, 1, "S";   |PINTA #maempx06#21;
     |C_M #maempx06#09, 1, "S";   |PINTA #maempx06#9;
     |C_M #maempx06#10, 1, "S";   |PINTA #maempx06#10;
     |C_M #maempx06#11, 1, "S";   |PINTA #maempx06#11;
     |C_M #maempx06#20, 1, "S";   |PINTA #maempx06#20;
     |C_M #maempx06#22, 1, "S";   |PINTA #maempx06#22;
     |C_M #maempx06#23, 1, "S";   |PINTA #maempx06#23;
     |C_M #maempx06#12, 1, "S";   |PINTA #maempx06#12;
     |C_M #maempx06#13, 1, "S";   |PINTA #maempx06#13;
     |C_M #maempx06#16, 1, "S";   |PINTA #maempx06#16;
     |C_M #maempx06#17, 1, "S";   |PINTA #maempx06#17;
     |C_M #maempx06#18, 1, "S";   |PINTA #maempx06#18;
     |C_M #maempx06#19, 1, "S";   |PINTA #maempx06#19;
|FPRC;

|PROCESO PonNoModi;
                                  |PINTA #maempx06#2;
     |C_M #maempx06#03, 1, "N";   |PINTA #maempx06#3;
     |C_M #maempx06#04, 1, "N";   |PINTA #maempx06#4;
     |C_M #maempx06#05, 1, "N";   |PINTA #maempx06#5;
     |C_M #maempx06#06, 1, "N";   |PINTA #maempx06#6;
     |C_M #maempx06#07, 1, "N";   |PINTA #maempx06#7;
     |C_M #maempx06#08, 1, "N";   |PINTA #maempx06#8;
     |C_M #maempx06#21, 1, "N";   |PINTA #maempx06#21;
     |C_M #maempx06#09, 1, "N";   |PINTA #maempx06#9;
     |C_M #maempx06#10, 1, "N";   |PINTA #maempx06#10;
     |C_M #maempx06#11, 1, "N";   |PINTA #maempx06#11;
     |C_M #maempx06#20, 1, "N";   |PINTA #maempx06#20;
     |C_M #maempx06#22, 1, "N";   |PINTA #maempx06#22;
     |C_M #maempx06#23, 1, "N";   |PINTA #maempx06#23;
     |C_M #maempx06#12, 1, "N";   |PINTA #maempx06#12;
     |C_M #maempx06#13, 1, "N";   |PINTA #maempx06#13;
     |C_M #maempx06#16, 1, "N";   |PINTA #maempx06#16;
     |C_M #maempx06#17, 1, "N";   |PINTA #maempx06#17;
     |C_M #maempx06#18, 1, "N";   |PINTA #maempx06#18;
     |C_M #maempx06#19, 1, "N";   |PINTA #maempx06#19;
|FPRC;

|PROCESO Evnt06;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#maempr06.=;

         |PARA nCampo = 0;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #maempx06#nCampo# = #maempr06#nCampo#;
         |SIGUE;

         |HAZ PonNoModi;

         |SI enModoConsulta = 0;
             |ESTADO_CONTROL nBtnMod, "ENABLE";
             |ESTADO_CONTROL nBtnBor, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Alta;
     nModo     = 1;
     nIdSalir  = 0;
     InNivel   = nNivel1<-;
     nNivel1   = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;

     nIdSalir = nNivel2;
     |ESTADO_CONTROL nIdSalir, "HIDE";

     |ESTADO_CONTROL nBtnAlt,   "DISABLE";
     |ESTADO_CONTROL nBtnMod,   "DISABLE";
     |ESTADO_CONTROL nBtnBor,   "DISABLE";
     |ESTADO_CONTROL nGrid,     "DISABLE";

     |DDEFECTO #maempx06;

     #maempr06#0 = enEmpresa;
     #maempr06#1 = enAnyo;
     #maempr06#2 = 99;
     |LEE 000#maempr06.];
     |SI FSalida = 0;
         |LEE 000#maempr06.a;
     |SINO;
         |LEE 000#maempr06.u;
     |FINSI;

     #maempx06#0 = enEmpresa;
     #maempx06#1 = enAnyo;
     #maempx06#2 = 1;
     |SI FSalida = 0;  |Y  #maempr06#0 = enEmpresa;  |Y  #maempr06#1 = enAnyo;
          #maempx06#2 = #maempr06#2 + 1;
     |FINSI;

     |HAZ PonModi;

     |ENDATOS #1#maempx06;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #maempr06#nCampo# = #maempx06#nCampo#;
         |SIGUE;
         |GRABA 020#maempr06.n;
         |LIBERA #maempr06;
     |FINSI;

     |ESTADO_CONTROL nBtnAlt,   "ENABLE";
     |ESTADO_CONTROL nBtnMod,   "ENABLE";
     |ESTADO_CONTROL nBtnBor,   "ENABLE";
     |ESTADO_CONTROL nGrid,     "ENABLE";

     |REFRESCACONTROL nGrid;  |PULSATECLA;

     nModo     = 0;

     |FOCOTECLADO nGrid;

     |ESTADO_CONTROL nIdSalir, "SHOW";

     |PULSATECLA;
|FPRC;

|PROCESO Modificar;
     |LEE 101#maempr06.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     nModo     = 1;
     nIdSalir  = 0;
     InNivel   = nNivel1<-;
     nNivel1   = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;

     nIdSalir = nNivel2;
     |ESTADO_CONTROL nIdSalir, "HIDE";

     |ESTADO_CONTROL nBtnAlt,   "DISABLE";
     |ESTADO_CONTROL nBtnMod,   "DISABLE";
     |ESTADO_CONTROL nBtnBor,   "DISABLE";
     |ESTADO_CONTROL nGrid,     "DISABLE";

     |DDEFECTO #maempx06;

     |PARA nCampo = 0;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
           #maempx06#nCampo# = #maempr06#nCampo#;
     |SIGUE;

     |HAZ PonModi;

     |ENDATOS #2#maempx06;
     |SI FSalida = 0;
         |PARA nCampo = 0;  |SI nCampo [ 23;  |HACIENDO nCampo = nCampo + 1;
               #maempr06#nCampo# = #maempx06#nCampo#;
         |SIGUE;
         |GRABA 020#maempr06.a;
         |LIBERA #maempr06;
     |FINSI;

     |ESTADO_CONTROL nBtnAlt,   "ENABLE";
     |ESTADO_CONTROL nBtnMod,   "ENABLE";
     |ESTADO_CONTROL nBtnBor,   "ENABLE";
     |ESTADO_CONTROL nGrid,     "ENABLE";

     |REFRESCACONTROL nGrid;  |PULSATECLA;

     nModo     = 0;

     |FOCOTECLADO nGrid;

     |ESTADO_CONTROL nIdSalir, "SHOW";

     |PULSATECLA;
|FPRC;

|PROCESO Baja;
     |CONFI "0000NSeguro que quiere BORRAR el registro";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#maempr06.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#maempr06.a;
     |LIBERA #maempr06;

     |ESTADO_CONTROL nBtnMod,   "DISABLE";
     |ESTADO_CONTROL nBtnBor,   "DISABLE";

     FSalida = "SKIPDEFAULT";

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
     |PULSATECLA;
|FPRC;

|PROCESO Baja06;
     #maempr06#0  = enEmpresa;
     #maempr06#1  = enAnyo;
     #maempr06#2  = 1;
|FPRC;

|PROCESO Alta06;
     #maempr06#0  = enEmpresa;
     #maempr06#1  = enAnyo;
     #maempr06#2  = 99;
|FPRC;

|PROGRAMA;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Relaci¢n participaciones en otras empresas";
     |VENTANA 0501, 3399, -1, 16, aAlfa;
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PINPA #0#maempx06;  nPan = FSalida;
     |PINDA #0#maempx06;

     |SI enModoConsulta = 0;
         |CONTROL_SIMPLE nPan, "BOTON,{{193}}&Alta ", 1364, 1374, Alta;
         nBtnAlt  = FSalida;

         |CONTROL_SIMPLE nPan, "BOTON,{{197}}&Modificar ", 1376, 1386, Modificar;
         nBtnMod  = FSalida;

         |CONTROL_SIMPLE nPan, "BOTON,{{199}}&Borrar", 1388, 1398, Baja;
         nBtnBor  = FSalida;

         |ESTADO_CONTROL nBtnMod, "DISABLE";
         |ESTADO_CONTROL nBtnBor, "DISABLE";
     |FINSI;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#maempr06, nRango, 0502, 1298, Baja06, Alta06, Evnt06;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::{{001}}sal&Ir," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;
          |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |SI enModoConsulta = 0;
         |FIN_CONTROL_WINDOWS nBtnAlt;
         |FIN_CONTROL_WINDOWS nBtnMod;
         |FIN_CONTROL_WINDOWS nBtnBor;
     |FINSI;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO Tipo80;  |TIPO 80;
     aAlfa  = PARAMETRO % 104;  enAnyo    = aAlfa;
     aAlfa  = PARAMETRO % 505;  enEmpresa = aAlfa;

     |ABRE #maempr10;
     #maempr10#0 = enEmpresa;
     #maempr10#1 = enAnyo;
     |LEE 000#maempr10.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
     |CIERRA #maempr10;

     |ABRET #maempr06;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     |CIERRAT #maempr06;
|FPRC;
