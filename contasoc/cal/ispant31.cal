|FICHEROS;
    isocie22 #0;
    maempr01 #1;
    isocie36 #2;
    isocie46 #3;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;

    FEstado = 0;
    suma         = 0;
|FIN;

|PROGRAMA;
|ABRE #1;
#1#0 = empresa;
#1#1 = anyo;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|SI anyo = 1992; |HAZ anyo_1992; |FINSI;
|SI anyo = 1993; |HAZ anyo_1993; |FINSI;
|SI anyo ] 1994; |HAZ anyo_1994; |FINSI;
|FPRO;

|| *************************************************************************
||                        LIQUIDACION A¥O 1992
|| *************************************************************************

|PROCESO anyo_1992;
|ABRE #0;
#0#0 = empresa;
#0#1 = anyo;
|LIBERA #0;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|HAZ calculo_92;
|SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
|CIERRA #0;
|FPRC;
|FPRC;

|PROCESO calculo_92;
#0#5  = #0#3 - #0#4;
#0#6  = #0#2 + #0#5;
|SI #1#36 = "X"; |O #1#37 = "X";
    #0#7 = #0#6 % 50;
|FINSI;
#0#8  = #0#6 - #0#7;
|HAZ cuota_92;
#0#17 = #0#14 + #0#15;
#0#19 = #0#17 - #0#18;
#0#26 = #0#19 - #0#20 - #0#21 - #0#22 - #0#23 - #0#24 - #0#25;
|SI #0#26 < 0; #0#26 = 0; |FINSI;
#0#30 = #0#26 - #0#27 - #0#28 - #0#29;
|SI #0#30 < 0; #0#30 = 0; |FINSI;
#0#40 = #0#30 - #0#31 - #0#32 - #0#33 - #0#34 - #0#35 - #0#36;
#0#40 = #0#40 - #0#37 - #0#38 - #0#39;
|SI #0#40 < 0; #0#40 = 0; |FINSI;
#0#61 = 100 - #0#62 - #0#63 - #0#64 - #0#65;
#0#43 = (#0#61 / 100) * (#0#40 - #0#41);
#0#44 = ((#0#62 + #0#63 + #0#64 + #0#65) / 100) * (#0#40 - #0#41);
#0#51 = #0#43 - #0#45 - #0#47 - #0#49;
#0#52 = #0#44 - #0#46 - #0#48 - #0#50;
#0#55 = (#0#51 + #0#53) % #0#66;
#0#56 = (#0#52 + #0#54) % #0#66;
#0#59 = #0#51 + #0#53 + #0#55 + #0#57;
#0#60 = #0#52 + #0#54 + #0#56 + #0#58;
|FPRC;

|PROCESO cuota_92; |TIPO 0;
|SI #0#9 ! 0; |O #0#10 ! 0;
    #0#12 = 35;
    #0#13 = 20;
    |SI #0#9  = 0; #0#12 = 0; |FINSI;
    |SI #0#10 = 0; #0#13 = 0; |FINSI;

    #0#14 = #0#9  % #0#12;
    |SI #0#14 < 0; #0#14 = 0; |FINSI;

    #0#15 = #0#10 % #0#13;
    |SI #0#15 < 0; #0#15 = 0; |FINSI;

    |SI #0#9 ! 0;
        #0#11 = #0#12;
    |SINO;
        #0#11 = #0#13;
    |FINSI;
|SINO;
    #0#12 = 0;
    #0#14 = 0;
    #0#13  = 35;
    #0#15  = #0#8 % #0#13;
    |SI #0#15 < 0; #0#15 = 0; |FINSI;

    #0#11 = #0#13;
|FINSI;
|FPRC;

|| *************************************************************************
||                        LIQUIDACION A¥O 1993
|| *************************************************************************

|PROCESO anyo_1993;
|ABRE #2;
#2#0 = empresa;
#2#1 = anyo;
|LIBERA #2;
|LEE 110#2=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #2; #2#0 = empresa; #2#1 = anyo; |FINSI;
|HAZ calculo_93;
|SI FEstado = 0; |GRABA 020#2a; |SINO; |GRABA 020#2n; |FINSI;
|CIERRA #2;
|FPRC;

|PROCESO calculo_93;
#2#5  = #2#3 - #2#4;
#2#6  = #2#2 + #2#5;
|SI #1#36 = "X"; |O #1#37 = "X";
    |SI #2#6 > 0;
        #2#7 = #2#6 % 50;
    |SINO;
        #2#7 = 0;
    |FINSI;
|FINSI;
#2#8  = #2#6 - #2#7;
|HAZ cuota_93;
#2#17 = #2#14 + #2#15;
#2#19 = #2#17 - #2#18;
#2#26 = #2#19 - #2#20 - #2#21 - #2#22 - #2#23 - #2#24 - #2#25;
|SI #2#26 < 0; #2#26 = 0; |FINSI;

#2#30 = #2#26 - #2#27 - #2#28;
|SI #2#30 < 0; #2#30 = 0; |FINSI;

#2#40 = #2#30 - #2#31 - #2#32 - #2#33 - #2#34 - #2#29 - #2#35 - #2#36;
#2#40 = #2#40 - #2#37 - #2#38 - #2#39;
|SI #2#40 < 0; #2#40 = 0; |FINSI;

#2#61 = 100 - #2#62 - #2#63 - #2#64 - #2#65;

#2#43 = (#2#61 / 100) * (#2#40 - #2#41);
#2#44 = ((#2#62 + #2#63 + #2#64 + #2#65) / 100) * (#2#40 - #2#41);

#2#51 = #2#43 - #2#45 - #2#47 - #2#49;
#2#52 = #2#44 - #2#46 - #2#48 - #2#50;

#2#55 = (#2#51 + #2#53) % #2#66;
#2#56 = (#2#52 + #2#54) % #2#66;

#2#59 = #2#51 + #2#53 + #2#55 + #2#57;
#2#60 = #2#52 + #2#54 + #2#56 + #2#58;
|FPRC;

|PROCESO cuota_93; |TIPO 0;
|SI #2#9 ! 0; |O #2#10 ! 0;
    #2#12 = 35;
    #2#13 = 20;
    |SI #2#9  = 0; #2#12 = 0; |FINSI;
    |SI #2#10 = 0; #2#13 = 0; |FINSI;

    #2#14 = #2#9  % #2#12;
    |SI #2#14 < 0; #2#14 = 0; |FINSI;

    #2#15 = #2#10 % #2#13;
    |SI #2#15 < 0; #2#15 = 0; |FINSI;

    |SI #2#9 ! 0;
        #2#11 = #2#12;
    |SINO;
        #2#11 = #2#13;
    |FINSI;
|SINO;
    #2#12 = 0;
    #2#14 = 0;
    #2#13  = 35;
    #2#15  = #2#8 % #2#13;
    |SI #2#15 < 0; #2#15 = 0; |FINSI;

    #2#11 = #2#13;
|FINSI;
|FPRC;

|| *************************************************************************
||                        LIQUIDACION A¥O 1994
|| *************************************************************************

|PROCESO anyo_1994;
|ABRE #3;
#3#0 = empresa;
#3#1 = anyo;
|LIBERA #3;
|LEE 110#3=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #3; #3#0 = empresa; #3#1 = anyo; |FINSI;
|HAZ calculo_94;
|SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
|CIERRA #3;
|FPRC;

|PROCESO calculo_94;
#3#5  = #3#2 + (#3#3 - #3#4);
#3#7  = 0;

|SI #1#36 = "X"; |O #1#37 = "X";
    |SI #3#5 > 0; #3#7 = #3#5 % 50; |FINSI;
|FINSI;

#3#9  = #3#5 - (#3#6 + #3#7 + #3#8);

|HAZ cuota_94;

#3#18 = #3#15 + #3#16;
#3#20 = #3#18 - #3#19;
#3#27 = #3#20 - #3#21 - #3#22 - #3#23 - #3#24 - #3#25 - #3#26;
|SI #3#27 < 0; #3#27 = 0; |FINSI;

#3#32 = #3#27 - #3#28 - #3#29 - #3#30 - #3#31;
|SI #3#32 < 0; #3#32 = 0; |FINSI;

#3#40 = #3#32 - #3#33 - #3#34 - #3#35 - #3#36 - #3#37 - #3#38 - #3#39;
|SI #3#40 < 0; #3#40 = 0; |FINSI;

#3#42 = #3#40 - #3#41;

#3#63 = 100 - #3#64 - #3#65 - #3#66 - #3#67;

#3#45 = (#3#63 / 100) * (#3#42 - #3#43);
#3#46 = ((#3#64 + #3#65 + #3#66 + #3#67) / 100) * (#3#42 - #3#43);

#3#53 = #3#45 - #3#47 - #3#49 - #3#51;
#3#54 = #3#46 - #3#48 - #3#50 - #3#52;

#3#57 = (#3#53 + #3#55) % #3#68;
#3#58 = (#3#54 + #3#56) % #3#68;

#3#61 = #3#53 + #3#55 + #3#57 + #3#59;
#3#62 = #3#54 + #3#56 + #3#58 + #3#60;
|FPRC;

|PROCESO cuota_94; |TIPO 0;
#3#13 = 0;
#3#14 = 35;
#3#15 = 0;
#3#16 = #3#9 % #3#14;
|SI #3#16 < 0; #3#16 = 0; |FINSI;
#3#12 = #3#14;

|SI #3#10 = 0; |Y #3#11 = 0; |ACABA; |FINSI;

#3#13 = 35;
#3#14 = 20;

|SI #3#10 = 0; #3#13 = 0; |FINSI;
|SI #3#11 = 0; #3#14 = 0; |FINSI;

#3#15 = #3#10 % #3#13;
|SI #3#15 < 0; #3#15 = 0; |FINSI;

#3#16 = #3#11 % #3#14;
|SI #3#16 < 0; #3#16 = 0; |FINSI;

|SI #3#10 ! 0;
    #3#12 = #3#13;
|SINO;
    #3#12 = #3#14;
|FINSI;
|FPRC;
