|FICHEROS;
     isoy0001 #0;

||     :/integral/def/dsam0000 #2;   ||Clientes
     :/basica/def/agifigen #99;
     :/basica/def/agicen14 #114;
     :/basica/def/agim0019 #119;  || Registro de Sociedades
     :/basica/def/agim0025 #125;  || Registro de Socios

      isacceso #201;   ||Acceso a Impuesto
      maempr02 #202;
      maempr03 #203;
      maempr10 #210;
      maempr11 #211;
      maempr14 #214;
      maempr15 #215;
      maempr18 #218;

      isom0001 #101;
      isom0002 #102;
      isom0003 #103;
      isom0004 #104;
      isom0005 #105;
      isom0006 #106; || Correcciones
      isom0007 #107; || otras correcciones
      isom0009 #109; || compensaciones
      isom0010 #110; || compensaciones cooperativas
      isom0011 #111;  || deducciones
      isom0012 #112;  || imposiciones
      isom0000 #600;

      isom0500 #500;
      isom0501 #501;
      isom0502 #502;
      isom0503 #503;
      isom0504 #504;
      isom0505 #505;
      isom0506 #506;
      isom0507 #507;
      isom0508 #508;
      isom0509 #509;

      :/contagen/def/ca8m0000 #800;
      isw00100 #900;        ||Datos Empresa para Imprimir
      isw00101 #901;
|FIN;

|VARIABLES;
   &enEmpresa = 0;
   &enAnyo    = 0;
   aCasilla   = "";

   inform1    = "isoy0001";
   inform2    = "isoy1001";
   inform3    = "isoy2001";
   inform4    = "isoy3001";
   inform5    = "isoy4001";
   inform6    = "isoy5001";
   inform7    = "isoy6001";

   aCeros    = "";
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   sw        = 0;

   &eaTitol   = "";
   &nSwPrint  = 0;
   &swImp     = 0;
   &eaTexto   = "";
   &eaCasilla = "";
   &eaCasill1 = "";
   &eaCasill2 = "";
   &eaCasill3 = "";
   &eaCasill4 = "";
   &enImporte = 0;
   &enImport1 = 0;
   &enImport2 = 0;
   &enImport3 = 0;
   &enImport4 = 0;

     &SwPrim  = 0;
     &Hoja    = 0;
     &nPagina = 0;
     &enSwInf = 0;
     &eaCas   = "";
     &eaTexA  = "";
     &eaTex0  = "";
     &eaTex1  = "";
     &eaTex2  = "";
     &eaTex3  = "";
     &eaTex4  = "";
     &eaTex5  = "";
     &eaTex6  = "";
     &eaTex7  = "";
     &eaTex8  = "";
     &enNum1  = 0;
     &enNum2  = 0;
     &enNum3  = 0;

     nPin1  = "";
     aPin1  = "";
     nPin2  = "";
     aPin2  = "";
     nPin3  = "";
     aPin3  = "";
     fPn10  = @;
     fPn11  = @;
     efPn10 = @;
     efPn11 = @;
     SwTranspa = 0;
     swExiste = 0;
     nRegis   = 0;
     nSuma    = 0;
     nTAccion = 0;
     nPvp     = 0;

     &ea050 = "";
     &ea053 = "";
     efDFecha = @;
     efHFecha = @;

    enCooperativa = 0;
    nDesde        = 0;
    nHasta        = 0;
    nAnyo         = 0;
    aAnyo         = "";
    nSwValor      = 0;
|FIN;

|INCLUYE varbal_i;

|| ************************************************* Datos Empresa
|PROCESO LeeDatosEmpresa;

  |DDEFECTO #900;

  #900#0 = enEmpresa;
  nPin1 = 0;
  aPin1 = "";
  efPn10 = "01.01.0000";
  efPn11 = "01.01.0000";

  || Lee Primera Actividad
    |ABRE #agicen14;
    #agicen14#0 = #900#0; || Empresa
    #agicen14#1 = 00;
    |LEE 041#agicen14.];
    |SI FSalida = 0; |Y #agicen14#0 = #900#0;
        #900#5 = #agicen14#9;
        #900#6 = #agicen14#10;
        #900#7 = #agicen14#7;
        #900#8 = #agicen14#8;
        efPn10 = #agicen14#5;
        efPn11 = #agicen14#6;

        #900#15 = #agicen14#1;   ||Act.
        #900#16 = #agicen14#2;   ||Tipo Epig.
        #900#17 = #agicen14#3;   ||Epigrafe
        #900#18 = #agicen14#4;   ||Descripcion Actividad
        #900#19 = #agicen14#5;   ||Fecha Inicio
        #900#20 = #agicen14#6;   ||Fecha Fin
        #900#21 = #agicen14#11;  ||Sector actividad
        #900#22 = #agicen14#12;  ||Sector actividad
        #900#23 = #agicen14#16;  ||Tipo Actividad
        #900#24 = #agicen14#17;  ||Descripcion Tipo Actividad
        #900#51 = #agicen14#20;  ||CNAE
    |FINSI;
    |CIERRA #agicen14;

 || Lee Ficha Sociedades
    swExiste = 0;
    nRegis   = 0;
    |ABRE #agim0019;
    #agim0019#0 = #900#0; || Empresa
    #agim0019#1 = 99;
    |LEE 041#agim0019.];
    |SI FSalida = 0;
        |LEE 040#agim0019.a;
    |SINO;
        |LEE 040#agim0019.u;
    |FINSI;
    |SI FSalida = 0; |Y #agim0019#0 = #900#0;
        swExiste = 1;
    |FINSI;
    |SI swExiste = 1;
        nRegis = #agim0019#1;  ||Registre
        nPin1 = #agim0019#4;
        aPin1 = #agim0019#5;
        fPn10 = #agim0019#7;      || Fecha Activa
        fPn11 = #agim0019#55;     || Fecha Inactiva
        nSuma = 0;
        |SI #agim0019#15 ! 0; nTAccion = #agim0019#15; nPvp = #agim0019#16; nSuma = 1; |FINSI;
        |SI #agim0019#19 ! 0; nTAccion = #agim0019#19; nPvp = #agim0019#20; nSuma = 2; |FINSI;
        |SI #agim0019#23 ! 0; nTAccion = #agim0019#23; nPvp = #agim0019#24; nSuma = 3; |FINSI;
        |SI enAnyo [ 2008;
            #900#51 = #agim0019#81;  ||CNAE
            #900#53 = #agim0019#82;  ||CNAE
        |SINO;
            #900#51 = #agim0019#40;  ||CNAE
            #900#53 = #agim0019#41;  ||CNAE
        |FINSI;
    |FINSI;
    |CIERRA #agim0019;

    |ABRE #agifigen;
    #agifigen#0 = #900#0; || Empresa
    |LEE 041#agifigen.=;
    |SI FSalida = 0;
        efPn10  = #agifigen#93;
        efPn11  = #agifigen#94;
        nPin1   = #agifigen#87;
        aPin1   = #agifigen#88;
        #900#1 = #agifigen#13;  || Nif
        #900#2 = #agifigen#1;   || Nombre
    |FINSI;
    |CIERRA #agifigen;
    |SI efPn10 [ "01.01.1900"; efPn10 = "01.01.0000"; |FINSI;
    |SI efPn11 [ "01.01.1900"; efPn11 = "01.01.0000"; |FINSI;
    #900#3 = nPin1;
    #900#4 = aPin1;
    #900#9 = efPn10;
    #900#10 = efPn11;

    #900#11 = "INACTIVA";
    |SI efPn11 [ "01.01.1000"; #900#11 = "ACTIVA"; |FINSI;
    #900#12 = enAnyo;                                   || Ejercicio
    #900#13 = efDFecha;
    #900#14 = efHFecha;

    |SI #210#31 > efDFecha; |Y #210#31 [ efHFecha; #900#13 = #210#31; |FINSI;
    |SI #210#32 < efHFecha; |Y #210#32 ] efDFecha; #900#14 = #210#32; |FINSI;
    #900#50 = "INFORME DE COMPROBACION DEL IMPUESTO DE SOCIEDADES DEL EJERCICIO ";
|FPRC;

|PROCESO MiroSiesCoop;
  enCooperativa = 0;
  |ABRE #211;
  #211#0 = enEmpresa;
  #211#1 = enAnyo;
  #211#2 = 17;
  |LEE 000#211=;
  |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

  #211#0 = enEmpresa;
  #211#1 = enAnyo;
  #211#2 = 18;
  |LEE 000#211=;
  |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

  #211#0 = enEmpresa;
  #211#1 = enAnyo;
  #211#2 = 19;
  |LEE 000#211=;
  |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

  |CIERRA #211;
|FPRC;

|| //////////////////////////////////////////////////////////////////////////

|| ...........................................Balances
|PROCESO isom0504;
     |DDEFECTO #105;
     #105#0  = enEmpresa;
     #105#1  = #504#0;
     #105#2  = #504#1;
     |LEE 001#105=;

     #105#6  = "N";
     |SI enTBal = 1;  #105#6 = #504#4;  #105#7 = #504#7;  |FINSI;
     |SI enTBal = 2;  #105#6 = #504#5;  #105#7 = #504#8;  |FINSI;
     |SI enTBal = 3;  #105#6 = #504#6;  #105#7 = #504#9;  |FINSI;

     eaTexto = #504#3;
     eaCasilla = "";
     |SI #504#2 ! "     "; eaCasilla = #504#2; |FINSI;
     |QBF eaCasilla;
     enImporte = #105#5;

    |QBF eaTexto;
    |SI eaTexto = "";
        nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
        |ACABA;
    |FINSI;

    |SI #105#6 = "S";
        |SI eaCasilla ] "632"; |Y eaCasilla [ "645";
            nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;
        |SINO;
            |SI eaCasilla = "";
                |SI #105#6 = "S";
                    nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
               |FINSI;
            |SINO;
                |SI enImporte ! 0; |O aCeros = "S";
                     nSwPrint = 1; |PRINT; SwPrim = 1; sw = 1;
               |FINSI;
            |FINSI;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE isom0504;
     #504#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0504;
|FIN;

|PROCESO LeoIsom0005;
  |SI #105#5 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0005;
  #105#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0005;
|FIN;

|PROCESO Imprimir_4;

 |SI aCeros = "N";
     nSwValor = 0;
     |BUCLE LeoIsom0005;
     |SI nSwValor = 0; |ACABA; |FINSI;
 |FINSI;

 nBalance = 4;
 eaTitol = "  ECPN (II): ESTADO DE CAMBIOS DEL PATRIMONIO NETO";

 SwPrim = 0;
 sw     = 0;
 |ABRE #105;
 |BUCLE isom0504;
 |SI sw = 1;
     |PIEINF;
     nPagina = nPagina + 1;
 |FINSI;
 |CIERRA #105;
|FPRC;


|PROCESO isom0503;

     |DDEFECTO #104;
     #104#0  = enEmpresa;
     #104#1  = #503#0;
     #104#2  = #503#1;
     |LEE 001#104=;

     #104#6  = "N";
     |SI enTBal = 1;  #104#6 = #503#4;  #104#7 = #503#7;  |FINSI;
     |SI enTBal = 2;  #104#6 = #503#5;  #104#7 = #503#8;  |FINSI;
     |SI enTBal = 3;  #104#6 = #503#6;  #104#7 = #503#9;  |FINSI;

     eaTexto = #503#3;
     eaCasilla = "";
     |SI #503#2 ! "     ";  eaCasilla = #503#2; |FINSI;
     |QBF eaCasilla;
     enImporte = #104#5;

     |SI eaCasilla = "355";
          nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
     |SINO;
         |SI eaCasilla = "";
             nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
         |SINO;
             aAlfa1 = eaTexto % 103;
             nSwPrint = 1; |SI aAlfa1 = "   "; nSwPrint = 2; |FINSI;
             |SI enImporte ! 0;
                 |PRINT; SwPrim = 1; sw = 1;
             |SINO;
                 |SI #104#6 = "S"; |Y aCeros = "S";
                     |PRINT; SwPrim = 1; sw = 1;
                |FINSI;
            |FINSI;
        |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE isom0503;
     #503#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0503;
|FIN;

|PROCESO LeoIsom0004;
  |SI #104#5 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0004;
  #104#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0004;
|FIN;

|PROCESO Imprimir_3;

 |SI aCeros = "N";
     nSwValor = 0;
     |BUCLE LeoIsom0004;
     |SI nSwValor = 0; |ACABA; |FINSI;
 |FINSI;

 nBalance = 2;
 eaTitol = "  ECPN (I): ESTADO DE INGRESOS Y GASTOS RECONOCIDOS EN EL EJERCICIO";

 SwPrim = 0;
 sw     = 0;
 |ABRE #104;
 |BUCLE isom0503;
 |SI sw = 1;
     |PIEINF;
     nPagina = nPagina + 1;
 |FINSI;
 |CIERRA #104;

|FPRC;

|PROCESO isom0502;

     |DDEFECTO #103;
     #103#0  = enEmpresa;
     #103#1  = #502#0;
     #103#2  = #502#1;
     |LEE 001#103=;

     #103#6  = "N";
     |SI enTCta = 1;  #103#6 = #502#4;  #103#7 = #502#7;  |FINSI;
     |SI enTCta = 2;  #103#6 = #502#5;  #103#7 = #502#8;  |FINSI;
     |SI enTCta = 3;  #103#6 = #502#6;  #103#7 = #502#9;  |FINSI;

     eaTexto = #502#3;
     eaCasilla = "";
     |SI #502#2 ! "     ";  eaCasilla = #502#2; |FINSI;
     |QBF eaCasilla;
     enImporte = #103#5;

     |SI eaCasilla = "500";
          nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
     |SINO;
          |SI eaCasilla = "";
              nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
          |SINO;
              aAlfa1 = eaTexto % 103;
              nSwPrint = 1; |SI aAlfa1 = "   "; nSwPrint = 2; |FINSI;
              |SI enImporte ! 0;
                  |PRINT; SwPrim = 1; sw = 1;
              |SINO;
                  |SI #103#6 = "S"; |Y aCeros = "S";
                      |PRINT; SwPrim = 1; sw = 1;
                  |FINSI;
              |FINSI;
          |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isom0502;
     #502#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0502;
|FIN;

|PROCESO LeoIsom0003;
  |SI #103#5 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0003;
  #103#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0003;
|FIN;

|PROCESO Imprimir_2;

 |SI aCeros = "N";
     nSwValor = 0;
     |BUCLE LeoIsom0003;
     |SI nSwValor = 0; |ACABA; |FINSI;
 |FINSI;

 nBalance = 1;
 eaTitol = "  C U E N T A   D E   P E R D I D A S   Y   G A N A N C I A S ";

 SwPrim = 0;
 sw     = 0;
 |ABRE #103;
 |BUCLE isom0502;
 |SI sw = 1;
     |PIEINF;
     nPagina = nPagina + 1;
 |FINSI;
 |CIERRA #103;
|FPRC;

|PROCESO isom0501;

     |DDEFECTO #102;
     #102#0  = enEmpresa;
     #102#1  = #501#0;
     #102#2  = #501#1;
     |LEE 001#102=;

     #102#6  = "N";
     |SI enTBal = 1;  #102#6 = #501#4;  #102#7 = #501#7;  |FINSI;
     |SI enTBal = 2;  #102#6 = #501#5;  #102#7 = #501#8;  |FINSI;
     |SI enTBal = 3;  #102#6 = #501#6;  #102#7 = #501#9;  |FINSI;

     eaTexto = #501#3;
     eaCasilla = "";
     |SI #501#2 ! "     "; eaCasilla = #501#2; |FINSI;
     |QBF eaCasilla;
     enImporte = #102#5;

     |SI eaCasilla = "180"; |O eaCasilla = "252";
         nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
         |SI eaCasilla = "180";
             |PIEINF;
         |FINSI;
     |SINO;
         |SI eaCasilla = "";
             nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
         |SINO;
             aAlfa1 = eaTexto % 103;
             nSwPrint = 1; |SI aAlfa1 = "   "; nSwPrint = 2; |FINSI;
            |SI enImporte ! 0;
                |PRINT; SwPrim = 1; sw = 1;
            |SINO;
                |SI #102#6 = "S"; |Y aCeros = "S";
                    |PRINT; SwPrim = 1; sw = 1;
                |FINSI;
            |FINSI;
         |FINSI;
      |FINSI;
|FPRC;

|DEFBUCLE isom0501;
     #501#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0501;
|FIN;

|PROCESO LeoIsom0002;
  |SI #102#5 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0002;
  #102#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0002;
|FIN;

|PROCESO Imprimir_1;
 |SI aCeros = "N";
     nSwValor = 0;
     |BUCLE LeoIsom0002;
     |SI nSwValor = 0; |ACABA; |FINSI;
 |FINSI;

 nBalance = 0;
 eaTitol  = "       B A L A N C E:   A C T I V O   Y   P A S I V O";

 SwPrim = 0;
 sw     = 0;
 |ABRE #102;
 |BUCLE isom0501;
 |SI sw = 1;
     |PIEINF;
     nPagina = nPagina + 1;
 |FINSI;
 |CIERRA #102;
|FPRC;

|PROCESO Balance;

         |INFOR inform1;
         |SI FSalida ! 0;
             |MENAV "    No existe Informe. No impreso balance";
             |ACABA;
         |FINSI;
         |HAZ Imprimir_1;
         |HAZ Imprimir_2;

         |SI enTBal ! 3;
             |HAZ Imprimir_3;
         |FINSI;

         |HAZ Imprimir_4;

         |FININF;
|FPRC;
||///////////////////////////////////////////////////////////////

|| ................................ Liquidacion
|PROCESO isom0500;

     |DDEFECTO #101;
     #101#0  = enEmpresa;
     #101#1  = #500#0;
     #101#2  = #500#1;
     |LEE 001#101=;

     #101#3  = #500#2;
     #101#4  = #500#3;

     eaTexto = #101#4;
     eaCasilla = "";
     |SI #101#3 ! "     "; eaCasilla = #101#3; |FINSI;
     |QBF eaCasilla;
     enImporte = #101#5;

     |SI eaCasilla = "500"; |O eaCasilla = "562";
         nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
     |SINO;
         |SI eaCasilla = "";
             nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
         |SINO;
             aAlfa1 = eaTexto % 103;
             nSwPrint = 1; |SI aAlfa1 = "   "; nSwPrint = 2; |FINSI;
             |SI enImporte ! 0; |O aCeros = "S";
                 |PRINT; SwPrim = 1; sw = 1;
            |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isom0500;
     #500#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0500;
|FIN;

|PROCESO Liquidacion;

   eaTitol = "       L I Q U I D A C I O N ";
  |INFOR inform1;
  |SI FSalida ! 0; |ACABA; |FINSI;

  SwPrim  = 0;
  sw      = 0;
  |ABRE #101;
  |BUCLE isom0500;
  |SI sw = 1;
      |PIEINF;
      nPagina = nPagina + 1;
   |FINSI;

   |CIERRA #101;
   |FININF;
|FPRC;
||//////////////////////////////////////////////////////////////////////////

|| ............................................ Correcciones
|PROCESO isom0505;
      |DDEFECTO #106;
      #106#0  = enEmpresa;
      #106#1  = #505#0;
      #106#2  = #505#1;
      |LEE 001#106=;

      #106#3  = #505#4;
      #106#4  = #505#2;
      #106#6  = #505#3;

    eaTexto = #106#3;
    eaCasilla = ""; eaCasill1 = "";
    |SI #106#4 ! "     "; eaCasilla = #106#4; |FINSI;
    |SI #106#6 ! "     "; eaCasill1 = #106#6; |FINSI;

    |QBF eaCasilla; |QBF eaCasill1;
    enImporte = #106#5; enImport1 = #106#7;

    |SI eaCasilla = "417";
        nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
    |SINO;
        |SI eaCasilla = ""; |Y eaCasill1 = "";
            nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
        |SINO;
            nSwPrint = 1;
            |SI enImporte ! 0; |O enImport1 ! 0; |O aCeros = "S";
                |PRINT; SwPrim = 1; sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE isom0505;
     #505#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0505;
|FIN;

|PROCESO LeoIsom0006;
  |SI #106#5 ! 0; |O #106#7 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0006;
  #106#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0006;
|FIN;

|PROCESO Correcciones;

  nSwValor = 0;
  |BUCLE LeoIsom0006;
  |SI nSwValor = 0; |ACABA; |FINSI;

   eaTitol = "       DETALLE DE LAS CORRECCIONES AL RESULTADO ";
  |INFOR inform4;
  |SI FSalida ! 0; |ACABA; |FINSI;

   SwPrim = 0;
   sw     = 0;
  |ABRE #106;
  |BUCLE isom0505;
   |SI sw = 1;
       |PIEINF;
       nPagina = nPagina + 1;
   |FINSI;
   |CIERRA #106;

   |FININF;
|FPRC;
|| ///////////////////////////////

|| ............................................. Compensaciones
|PROCESO isom0507;

  |SI nDesde = 0;

      |DDEFECTO #109;
      #109#0  = enEmpresa;
      #109#1  = #507#0;
      #109#2  = #507#1;
      |LEE 001#109=;

      #109#3  = #507#7;
      #109#4  = #507#2;
      #109#5  = #507#4;
      #109#7  = #507#5;
      #109#9  = #507#6;

      eaTexto = #109#3; |QBF eaTexto;
      eaTexto = eaTexto + " " + #507#2 + " " + ".................................";
      eaTexto = eaTexto % 150;

      eaCasilla = ""; eaCasill1 = ""; eaCasill2 = "";
      |SI #109#5 ! "     "; eaCasilla = #109#5; |FINSI;
      |SI #109#7 ! "     "; eaCasill1 = #109#7; |FINSI;
      |SI #109#9 ! "     "; eaCasill2 = #109#9; |FINSI;

      |QBF eaCasilla; |QBF eaCasill1; |QBF eaCasill2;
      enImporte = #109#6; enImport1 = #109#8; enImport2 = #109#10;

      |SI eaCasilla = "670";
          nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
      |SINO;
          |SI eaCasilla = ""; |Y eaCasill1 = ""; |Y eaCasill2 = "";
              nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
          |SINO;
              nSwPrint = 1;
              |SI enImporte ! 0; |O enImport1 ! 0; |O enImport2 ! 0; |O aCeros = "S";
                  |PRINT; SwPrim = 1; sw = 1;
              |FINSI;
          |FINSI;
      |FINSI;

 |SINO;

      |DDEFECTO #110;
      #110#0  = enEmpresa;
      #110#1  = #507#0;
      #110#2  = #507#1;
      |LEE 101#110=;

      #110#3  = #507#7;
      #110#5  = #507#4;
      #110#7  = #507#5;
      #110#9  = #507#6;

      eaTexto = #110#3; |QBF eaTexto;
      eaTexto = eaTexto + " " + #507#2 + " " + ".................................";
      eaTexto = eaTexto % 150;
      eaCasilla = ""; eaCasill1 = ""; eaCasill2 = "";
      |SI #110#5 ! "     "; eaCasilla = #110#5; |FINSI;
      |SI #110#7 ! "     "; eaCasill1 = #110#7; |FINSI;
      |SI #110#9 ! "     "; eaCasill2 = #110#9; |FINSI;

      |QBF eaCasilla; |QBF eaCasill1; |QBF eaCasill2;
      enImporte = #110#6; enImport1 = #110#8; enImport2 = #110#10;

      |SI eaCasilla = "694";
          nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
      |SINO;
          |SI eaCasilla = ""; |Y eaCasill1 = ""; |Y eaCasill2 = "";
              nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
          |SINO;
              nSwPrint = 1;
              |SI enImporte ! 0; |O enImport1 ! 0; |O enImport2 ! 0; |O aCeros = "S";
                  |PRINT; SwPrim = 1; sw = 1;
              |FINSI;
          |FINSI;
      |FINSI;

 |FINSI;
|FPRC;

|DEFBUCLE isom0507;
     #507#1;
     ;
     enAnyo, nDesde;
     enAnyo, nHasta;     || Del 1 al 999 es el isom0009
     ;
     NULL, isom0507;
|FIN;

|PROCESO LeoIsom0010;
  |SI #110#6 ! 0; |O #110#8 ! 0; |O #110#10 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0010;
  #110#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0010;
|FIN;

|PROCESO LeoIsom0009;
  |SI #109#6 ! 0; |O #109#8 ! 0; |O #109#10 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0009;
  #109#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0009;
|FIN;

|PROCESO Compensacion;

  |HAZ MiroSiesCoop;
  |SI aCeros = "N";
      nSwValor = 0;
      |SI enCooperativa = 0;
          |BUCLE LeoIsom0009;
      |SINO;
          |BUCLE LeoIsom0010;
      |FINSI;
      |SI nSwValor = 0; |ACABA; |FINSI;
  |FINSI;

   eaTitol = " DETALLE DE LA COMPENSACION DE BASES IMPONIBLES NEGATIVAS";
  |INFOR inform6;
  |SI FSalida ! 0; |ACABA; |FINSI;

  eaTex1 = "Pendiente de  aplicacion a";
  eaTex2 = "                          ";
  eaTex3 = "Pendiente de aplicacion en";
  eaTex4 = "  principio del periodo   ";
  eaTex5 = "Aplic. en esta liquidacion";
  eaTex6 = "    periodos futuros      ";

  SwPrim = 0;
  sw     = 0;
  |SI enCooperativa = 0;
        nDesde = 0;
        nHasta = 999;

        |ABRE #109;
        |BUCLE isom0507;
        |CIERRA #109;
  |SINO;
        nDesde = 1000;
        nHasta = 9999;

        |ABRE #110;
        |BUCLE isom0507;
        |CIERRA #110;
  |FINSI;
   |SI sw = 1;
       |PIEINF;
       nPagina = nPagina + 1;
   |FINSI;

   |FININF;
|FPRC;
|| ///////////////////////////////

|| ................................................... Deducciones
|PROCESO isom0508;
      |DDEFECTO #111;
      #111#0  = enEmpresa;
      #111#1  = #508#0;
      #111#2  = #508#1;
      |LEE 001#111=;

      #111#3  = #508#5;
      #111#4  = #508#2;
      #111#6  = #508#3;
      #111#8  = #508#4;

      eaTexto = #111#3;
      eaCasilla = ""; eaCasill1 = ""; eaCasill2 = "";
      |SI #111#4  ! "     "; eaCasilla = #111#4;  |FINSI;
      |SI #111#6  ! "     "; eaCasill1 = #111#6;  |FINSI;
      |SI #111#8  ! "     "; eaCasill2 = #111#8;  |FINSI;

      |QBF eaCasilla; |QBF eaCasill1; |QBF eaCasill2;
      enImporte = #111#5;  enImport1 = #111#7; enImport2 = #111#9;

    |SI eaCasilla = "841"; |O eaCasilla = "764"; |O eaCasilla = "886";
       |O eaCasilla = "831";  |O eaCasilla = "598";
           nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
    |SINO;
        |SI eaCasilla = ""; |Y eaCasill1 = ""; |Y eaCasill2 = "";
            nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
        |SINO;
            nSwPrint = 1;
            |SI enImporte ! 0; |O enImport1 ! 0; |O enImport2 ! 0;|O aCeros = "S";
                |PRINT; SwPrim = 1; sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE isom0508;
     #508#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0508;
|FIN;

|PROCESO LeoIsom0011;
  |SI #111#5 ! 0; |O #111#7 ! 0; |O #111#9 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0011;
  #111#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0011;
|FIN;

|PROCESO isom0509;
      |DDEFECTO #112;
      #112#0  = enEmpresa;
      #112#1  = #509#0;
      #112#2  = #509#1;
      |LEE 001#112=;

      #112#3  = #509#7;
      #112#4  = #509#2;
      #112#6  = #509#3;
      #112#8  = #509#4;
      #112#10 = #509#5;
      #112#12 = #509#6;

      eaTexto = #112#3;
      eaCasilla = ""; eaCasill1 = ""; eaCasill2 = "";
      eaCasill3 = ""; eaCasill4 = "";
      |SI #112#4  ! "     "; eaCasilla = #112#4;  |FINSI;
      |SI #112#6  ! "     "; eaCasill1 = #112#6;  |FINSI;
      |SI #112#8  ! "     "; eaCasill2 = #112#8;  |FINSI;
      |SI #112#10 ! "     "; eaCasill3 = #112#10; |FINSI;
      |SI #112#12 ! "     "; eaCasill4 = #112#12; |FINSI;

      |QBF eaCasilla; |QBF eaCasill1;
      |QBF eaCasill2; |QBF eaCasill3;
      |QBF eaCasill4;
      enImporte = #112#5;  enImport1 = #112#7;
      enImport2 = #112#9;  enImport3 = #112#11;
      enImport4 = #112#13;

    |SI eaCasilla = "116"; |O eaCasill1 = "103"; |O eaCasilla = "131";
        |O eaCasilla = "160"; |O eaCasilla = "171";
           nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
    |SINO;
        |SI eaCasilla = ""; |Y eaCasill1 = ""; |Y eaCasill2 = ""; |Y eaCasill3 = ""; |Y eaCasill4 = "";
            nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
        |SINO;
            nSwPrint = 1;
            |SI enImporte ! 0; |O enImport1 ! 0; |O enImport2 ! 0;
                 |O enImport3 ! 0; |O enImport4 ! 0; |O aCeros = "S";
                |PRINT; SwPrim = 1; sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE isom0509;
     #509#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0509;
|FIN;

|PROCESO LeoIsom0012;
  |SI #112#5 ! 0; |O #112#9 ! 0; |O #112#11 ! 0; |O #112#13 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0012;
  #112#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0012;
|FIN;

|PROCESO Deducciones

  nSwValor = 1;
  |SI aCeros = "N";
      nSwValor = 0;
      |BUCLE LeoIsom0012;
  |FINSI;

  |SI nSwValor ! 0;

      eaTitol = "       DEDUCCIONES DOBLE IMPOSICION ";
     |INFOR inform7;
     |SI FSalida ! 0; |ACABA; |FINSI;

      SwPrim = 0;
      sw     = 0;
     |ABRE #112;
     |BUCLE isom0509;
     |SI sw = 1;
         |PIEINF;
         nPagina = nPagina + 1;
     |FINSI;
     |CIERRA #112;

     |FININF;
  |FINSI;

  nSwValor = 1;
  |SI aCeros = "N";
      nSwValor = 0;
      |BUCLE LeoIsom0011;
  |FINSI;

  |SI nSwValor ! 0;

      eaTitol = "       DEDUCCIONES ";
     |INFOR inform6;
     |SI FSalida ! 0; |ACABA; |FINSI;

     eaTex1 = "Per. ant. Deducc.pendiente";
     eaTex4 = "Per.actual Deducc.generada";
     eaTex2 = "                          ";
     eaTex5 = "Aplic. en esta liquidacion";
     eaTex3 = "Pendiente de aplicacion en";
     eaTex6 = "    periodos futuros      ";

      SwPrim = 0;
      sw     = 0;
     |ABRE #111;
     |BUCLE isom0508;
     |SI sw = 1;
         |PIEINF;
         nPagina = nPagina + 1;
     |FINSI;
     |CIERRA #111;

     |FININF;
  |FINSI;

|FPRC;
||///////////////////////////////////////////////////////////////

|PROCESO isom0506;
      |DDEFECTO #107;
      #107#0  = enEmpresa;
      #107#1  = #505#0;
      #107#2  = #505#1;
      |LEE 001#107=;

      #107#3  = #506#4;
      #107#4  = #506#2;
      #107#6  = #506#3;

    eaTexto = #107#3;
    eaCasilla = ""; eaCasill1 = "";
    |SI #107#4 ! "     "; eaCasilla = #107#4; |FINSI;
    |SI #107#6 ! "     "; eaCasill1 = #107#6; |FINSI;

    |QBF eaCasilla; |QBF eaCasill1;
    enImporte = #107#5; enImport1 = #107#7;

    |SI eaCasilla = "417";
        nSwPrint = 3; |PRINT; SwPrim = 1; sw = 1;    ||aunque se han cero
    |SINO;
        |SI eaCasilla = ""; |Y eaCasill1 = "";
            nSwPrint = 0; |PRINT; SwPrim = 1; sw = 1;
        |SINO;
            nSwPrint = 1;
            |SI enImporte ! 0; |O enImport1 ! 0; |O aCeros = "S";
                |PRINT; SwPrim = 1; sw = 1;
            |FINSI;
        |FINSI;
    |FINSI;
|FPRC;

|DEFBUCLE isom0506;
     #506#1;
     ;
     enAnyo, 0000;
     enAnyo, 9999;
     ;
     NULL, isom0506;
|FIN;

|PROCESO LeoIsom0007;
  |SI #107#5 ! 0; |O #107#7 ! 0;
      nSwValor = 1;
      |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE LeoIsom0007;
  #107#1;
  ;
  enEmpresa, enAnyo, 0001;
  enEmpresa, enAnyo, 9999;
  e;
  NULL, LeoIsom0007;
|FIN;

|PROCESO OtrasCorrecciones;

  nSwValor = 0;
  |BUCLE LeoIsom0007;
  |SI nSwValor = 0; |ACABA; |FINSI;

   eaTitol = "       DETALLE DE LAS CORRECCIONES AL RESULTADO ";
  |INFOR inform4;
  |SI FSalida ! 0; |ACABA; |FINSI;

   SwPrim = 0;
   sw     = 0;
  |ABRE #107;
  |BUCLE isom0506;
   |SI sw = 1;
       |PIEINF;
       nPagina = nPagina + 1;
   |FINSI;
   |CIERRA #107;

   |FININF;
|FPRC;
||///////////////////////////////////////////////////////////////
|| ******************************************************************
|| ..................................................... Distribucion
|PROCESO Distribucion;

  |INFOR inform3;
  |SI FSalida ! 0; |ACABA; |FINSI;

  SwPrim = 0;
  |ABRE #600;
  #600#0 = enEmpresa;
  #600#1 = enAnyo;
  |LEE 001#600=;
  |SI FSalida = 0;
      |DDEFECTO #901;
      #901#0 = #600#0;
      #901#1 = #600#1;
      #901#3 = #600#84;
      #901#4 = #600#85;
      #901#5 = #600#86 + #600#87;
      #901#6 = #600#88;

      #901#10 = #600#89 + #600#90 + #600#91 + #600#92;
      #901#10 = #901#10 + #600#125 + #600#126;
      #901#11 = #600#93;
      #901#12 = #600#94;
      #901#13 = #600#95;
      #901#14 = #600#96;
      #901#15 = #600#97;
      #901#16 = #600#98;
      #901#17 = #600#99;
      #901#18 = #600#100;
      #901#19 = #600#101;
      #901#20 = #600#102 + #600#103;
      #901#21 = #600#104;
      #901#22 = #600#105;
      |PRINT;
      |PIEINF;
      nPagina = nPagina + 1;
  |FINSI;
  |CIERRA #600;
  |FININF;
|FPRC;

||********************************** Imprimir Comprobacion
|| ..................................................... Imprimir Portada
|PROCESO Vinculadas0;
 eaTex1 = #218#3;
 eaTex2 = #218#4;
 eaTex3 = #218#5;
 eaTex4 = #218#6;
 eaTex5 = #218#7;
 eaTex6 = #218#8;
 eaTex7 = #218#9;
 eaTex8 = #218#10;
 enNum1 = #218#11;
 |PRINT; SwPrim = 1;
 enSwInf = 15;
|FPRC;

|DEFBUCLE Vinculadas;
  #218#1;
  ;
  enEmpresa, enAnyo, 00, 01;
  enEmpresa, enAnyo, 00, 99;
  e;
  NULL, Vinculadas0;
|FIN;

|PROCESO ValorParaisos0;
 eaTex1 = #215#3;
 eaTex2 = #215#4;
 eaTex3 = #215#6;
 eaTex4 = #215#5;
 enNum1 = #215#7;
 enNum2 = #215#8;
 |PRINT; SwPrim = 1;
 enSwInf = 9;
|FPRC;

|DEFBUCLE ValorParaisos;
  #215#1;
  ;
  enEmpresa, enAnyo, 00, 01;
  enEmpresa, enAnyo, 00, 99;
  e;
  NULL, ValorParaisos0;
|FIN;


|PROCESO Paraisos0;
 eaTex1 = #214#3;
 eaTex2 = #214#4;
 eaTex3 = #214#5;
 eaTex4 = #214#6;
 eaTex5 = #214#7;
 enNum1 = #214#8; || Porcentaje
 |PRINT; SwPrim = 1;
 enSwInf = 7;
|FPRC;

|DEFBUCLE Paraisos;
  #214#1;
  ;
  enEmpresa, enAnyo, 00, 01;
  enEmpresa, enAnyo, 00, 99;
  e;
  NULL, Paraisos0;
|FIN;

|PROCESO Socios0;
 eaTex1 = #202#3;
 eaTex2 = #202#4;
 eaTex3 = #202#5;
 eaTex4 = #202#6;
 enNum1 = #202#7; || Nominal
 enNum2 = #202#8; || Porcentaje
 |PRINT; SwPrim = 1;
 enSwInf = 5;
|FPRC;

|DEFBUCLE Socios;
  #202#1;
  ;
  enEmpresa, enAnyo, 001;
  enEmpresa, enAnyo, 999;
  e;
  NULL, Socios0;
|FIN;

|PROCESO Adminis0;
 eaTex1 = #203#3;
 eaTex2 = #203#4;
 eaTex3 = #203#5;
 eaTex4 = #203#6;
 eaTex5 = #203#7;
 |PRINT; SwPrim = 1;
 enSwInf = 3;
|FPRC;

|DEFBUCLE Adminis;
 #203#1;
 ;
 enEmpresa, enAnyo, 00;
 enEmpresa, enAnyo, 99;
 e;
 NULL, Adminis0;
|FIN;

|PROCESO ElCaracter0;
 eaTex1 = #211#3; |QBF eaTex1;
 |SI eaTex1 ! "";
     |PRINT; SwPrim = 1;
     enSwInf = 1;
 |FINSI;
|FPRC;

|DEFBUCLE ElCaracter;
 #211#1;
 ;
 enEmpresa, enAnyo, 000;
 enEmpresa, enAnyo, 059;
 e;
 NULL, ElCaracter0;
|FIN;

|PROCESO LaPortada;

 SwPrim  = 0;
 |INFOR inform2;
 |SI FSalida ! 0; |ACABA; |FINSI;

 |SI enTBal = 1; ea050 = "Balance y ECPN. Mod. Normal";    |FINSI;
 |SI enTBal = 2; ea050 = "Balance y ECPN. Mod. abreviado"; |FINSI;
 |SI enTBal = 3; ea050 = "Balance y ECPN. Mod. PYMES";     |FINSI;

 |SI enTCta = 1; ea053 = "Perdidas y Ganancias Mod. Normal";    |FINSI;
 |SI enTCta = 2; ea053 = "Perdidas y Ganancias Mod. abreviado"; |FINSI;
 |SI enTCta = 3; ea053 = "Perdidas y Ganancias Mod. PYMES";     |FINSI;

 eaTex0  = "Caracter de la declaracion";
 eaTexA  = "";
 enSwInf = 0;
 |BUCLE ElCaracter;

 eaTex0  = "Relacion de Administradores";
 eaTexA  = "N.I.F.         F/J  Apellidos y nombre                        Domicilio Fiscal     C.P. ";
 enSwInf = 2;
 |BUCLE Adminis;

 eaTex0  = "Participaciones de personas o entidades en la entidad declarante";
 eaTexA  = "N.I.F.         F/J  Apellidos y nombre                               Nominal  Porcentaje  C.P.";
 enSwInf = 4;
 |BUCLE Socios;
 |SI enSwInf = 5;
     |SI #210#73 ! 0; |O #210#74 ! 0;
         enNum1 = #210#73;
         enNum2 = #210#74;
         enSwInf = 10;
         |PRINT; SwPrim = 1;
     |FINSI;
 |FINSI;

 eaTex0  = "Operaciones con Personas o entidades Vinculadas";
 eaTexA  = "N.I.F.        F/J  Apellidos y nombre                       T.Vin.  CP  T.Op. I/P  Met.Valor.         Importe"
 enSwInf = 14;
 |BUCLE Vinculadas;

 eaTex0  = "Operaciones relacionadas con Paises o territorios calificados reglamentariamente como Paraisos Fiscales";
 eaTexA  = "Descripcion de la Operacion  Persona o entidad residente  F/J  Clave  Pais o territorio              Importe";
 enSwInf = 6;
 |BUCLE Paraisos;

 eaTex0  = "Tendencia de Valores relacionados con Paises o territorios calificados reglamentariamente como Paraisos Fiscales";
 eaTexA  = "Tipo Entidad Participada o emisora  Pais o territorio         Clave  Valor Adquisicion  % Participacion";
 enSwInf = 8;
 |BUCLE ValorParaisos;

 |SI SwPrim = 0;
     enSwInf = 0; |PRINT; SwPrim = 1;
 |FINSI;
 |PIEINF;
 nPagina = nPagina + 1;
 |FININF;
|FPRC;

|PROGRAMA;

   |ABRE #210;
   #210#0 = enEmpresa;
   #210#1 = enAnyo;
   |LEE 000#210=;
   |SI FSalida ! 0;  |DDEFECTO #210;  |FINSI;
   |CIERRA #210;

   |ABRE #800;
   #800#0 = #210#101;
   |LEE 000#800=;
   |SI FSalida ! 0;  |DDEFECTO #800;  |FINSI;
   enTBal = #800#2;

   #800#0 = #210#102;
   |LEE 000#800=;
   |SI FSalida ! 0;  |DDEFECTO #800;  |FINSI;
   enTCta = #800#2;
   |CIERRA #800;

   aCeros = "N";
   |CONFI "    SImprimir Partidas con Valor <0>: ";
   |SI FSalida = 0;
       aCeros = "S";
   |FINSI;

   aAlfa1 = enAnyo;
   aAlfa2 = "01.01."+ aAlfa1;
   aAlfa3 = "31.12."+ aAlfa1;
   efDFecha = aAlfa2;
   efHFecha = aAlfa3;

   |IMPRE 0;
   |SI FSalida ! 0;
       |MENAV "      Proceso Interrumpido"
       |ACABA;
   |FINSI;
   |HAZ LeeDatosEmpresa;
   nPagina = 1;

   |HAZ LaPortada;
   |HAZ Balance;
   |HAZ Liquidacion;

   |HAZ Correcciones;
   |HAZ Compensacion;
   |HAZ Deducciones;
   |HAZ Distribucion;
   |HAZ OtrasCorrecciones;

   |FINIMP;
|FPRO;
