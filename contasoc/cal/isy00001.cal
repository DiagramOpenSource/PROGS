|FICHEROS;
     isy00001 #0;
     isacceso #100;
     isocie59 #159;
     isocie91 #191;

     isw00900 #900;

     :/basica/def/agim0030 #630;
     :/basica/def/agim0019 #619;
|FIN;

|VARIABLES;
     aBase            = "";
     aPathFichBasica  = "";
     aDModelo         = "";
     aHModelo         = "";
     aDImpreso        = "";
     aHImpreso        = "";
     aFichero         = "";

     nSwHay           = 0;
     nResultado       = 0;
     nTipo            = 0;

     &anyo            = 0;
|FIN;

|PROCESO isacceso;
     #619#0 = #100#0;
     #619#1 = 99;
     |LEE 040#619];
     |SI FSalida = 0;
         |LEE 040#619a;
     |SINO;
         |LEE 040#619u;
     |FINSI;

     |SI FSalida ! 0;  |O #619#0 ! #100#0;
         |DDEFECTO #619;
         #619#4  = 99;
         #619#54 = " ";
     |FINSI;

     |SI #619#4 < #0#1;  |O #619#4 > #0#2;
         |ACABA;
     |FINSI;

     |SI #0#0 ! "T";
         |SI #619#54 ! #0#0;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #100#5 ! "225";
         #159#0 = #100#0;
         #159#1 = #100#1;
         |LEE 040#159=;
         |SI FSalida ! 0;  |DDEFECTO #159;  |FINSI;

         nResultado = #159#105;
     |SINO;
         #191#0 = #100#0;
         #191#1 = #100#1;
         |LEE 040#191=;
         |SI FSalida ! 0;  |DDEFECTO #191;  |FINSI;

         nResultado = #191#123;
     |FINSI;

     |SI #0#3 ! "T";
         |SI #0#3 = "N";
             |SI nResultado ] 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #0#3 = "P";
             |SI nResultado [ 0;  |ACABA;  |FINSI;
         |FINSI;

         |SI #0#3 = "C";
             |SI nResultado ! 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     #630#0  = #619#4;
     |LEE 000#630=;
     |SI FSalida ! 0;
         #630#1 = "NO EXISTE FICHA DE SOCIEDADES EN EL CLIENTE";
     |FINSI;

     #900#0  = #619#4;
     #900#1  = #100#0;
     #900#2  = #630#1;
     #900#3  = #100#2;
     #900#4  = #100#3;
     #900#5  = #619#6;
     #900#6  = #619#7;
     #900#7  = #619#55;
     #900#8  = #100#5;
     #900#10 = nResultado;
     #900#9  = "NO";
     |SI #100#6 = "S";  #900#9  = "SI";  |FINSI;

     |GRABA 020#900n;
     |LIBERA #900;

     nSwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
     #100#1;
     5, 6;
     anyo, 00001, aDModelo, aDImpreso;
     anyo, 99999, aHModelo, aHImpreso;
     ;
     NULL, isacceso;
|FIN;

|PROCESO isw00900;
     |SI nTipo ! #900#0;  |Y nTipo ! 0;
         |PIEINF;
     |FINSI;

     |PRINT;

     nTipo = #900#0;
|FPRC;

|DEFBUCLE isw00900;
     #900#1;
     ;
     INICIO;
     FINAL;
     ;
     NULL, isw00900;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "isy00001";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     aFichero = ("90" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #900 aFichero;
     |ABRE #900;  |CIERRA #900;  |DELINDEX #900;

     aDModelo = "   ";
     aHModelo = "zzz";

     |SI #0#5 = "0";   aDModelo = "200";  aHModelo = "200";  |FINSI;
     |SI #0#5 = "1";   aDModelo = "201";  aHModelo = "201";  |FINSI;
     |SI #0#5 = "5";   aDModelo = "225";  aHModelo = "225";  |FINSI;

     aDImpreso = " ";
     aHImpreso = "z";

     |SI #0#4 ! "T";
         aDImpreso = #0#4;
         aHImpreso = #0#4;
     |FINSI;

     |ABRE #619;
     |ABRE #630;
     |ABRE #159;
     |ABRE #191;
     |ABRE #900;
     |BUCLE isacceso;
     |CIERRA #159;
     |CIERRA #191;
     |CIERRA #619;
     |CIERRA #630;
     |CIERRA #900;

     |SI nSwHay = 0;
         |MENAV "0000 Seleccion vacia";
         |DELINDEX #900;
         |FININF;
         |FINIMP;
         |ACABA;
     |FINSI;

     nTipo = 0;
     |BUCLE isw00900;

     |PIEINF;
     |FININF;
     |FINIMP;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |DBASS aBase; |QBF aBase;
     aPathFichBasica = aBase + "basica/fich/";
     |PATH_DAT #630 aPathFichBasica;
|FPRC;
