|FICHEROS;
     isom0016;
|FIN;

|VARIABLES;
     nVentana       = 0;
     nRango         = 0;
     nGrid          = 0;
     nHasta         = 0;
     nLinea         = 0;

     aAlfa          = "";
     aEsc1          = "";
     aEsc2          = "";
     aRetu          = "";
     aTecla         = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     &enEmpresa = 0;
     &enAnyo    = 0;
     &enModoConsulta = 0;
|FIN;

|PROCESO Baja116;
     #isom0016#0  = enEmpresa;
     #isom0016#1  = enAnyo;
     #isom0016#2  = 1;
|FPRC;

|PROCESO Alta116;
     #isom0016#0  = enEmpresa;
     #isom0016#1  = enAnyo;
     #isom0016#2  = nHasta;
|FPRC;

|PROCESO Entra2014;
     nHasta = 9999;
     aAlfa  = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Registro electr¢nico";
     |VENTANA 0501, 2036, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #isom0016;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#isom0016, nRango, 0602, 1833, Baja116, Alta116, NULL;
     nGrid = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #isom0016;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO isom0016B;
     aAlfa = #isom0016#3;  |QBF aAlfa;
     |SI aAlfa ! "";  |ACABA;  |FINSI;

     |BORRA 020#isom0016.a;
     |LIBERA #isom0016;
|FPRC;

|DEFBUCLE isom0016B;
     #isom0016;
     ;
     enEmpresa, enAnyo, 1;
     enEmpresa, enAnyo, nHasta;
     be;
     NULL, isom0016B;
|FIN;

|PROCESO GrabaLinea;
     #isom0016#0 = enEmpresa;
     #isom0016#1 = enAnyo;
     #isom0016#2 = nLinea;
     |LEE 000#isom0016.=;
     |SI FSalida = 0;  |ACABA;  |FINSI;

     |DDEFECTO #isom0016;
     #isom0016#0 = enEmpresa;
     #isom0016#1 = enAnyo;
     #isom0016#2 = nLinea;
     |GRABA 020#isom0016.n;
     |LIBERA #isom0016;
|FPRC;

|PROCESO Entra2015;
     nHasta = 4;
     aAlfa  = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Registro electr¢nico";
     |VENTANA 0501, 2099, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{11}}1.- Consigne el N£mero de Referencia de Sociedades (NRS) ";
     aAlfa = aAlfa + "de la documentaci¢n presentada por el Anexo III (Ajustes y deducciones)";
     |CONTROL_SIMPLE 0, aAlfa, 0602, 0765, NULL;

     aAlfa = "LABEL,{{11}}2.- Consigne el N£mero de justificante identificativo de la ";
     aAlfa = aAlfa + "declaraci¢n informativa de ayudas Régimen Econ¢mico y Fiscal de Canarias";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 1065, NULL;

     aAlfa = "LABEL,{{11}}3.- Consigne el N£mero de Referencia de Sociedades (NRS) ";
     aAlfa = aAlfa + "de la documentación presentada por el Anexo IV (Personal investigador)";
     |CONTROL_SIMPLE 0, aAlfa, 1202, 1365, NULL;

     aAlfa = "LABEL,{{11}}4.- Consigne el N£mero de Referencia de Sociedades (NRS) ";
     aAlfa = aAlfa + "del documento normalizado presentada por el Anexo V";
     |CONTROL_SIMPLE 0, aAlfa, 1502, 1665, NULL;

     |ABRE #isom0016;

     |PARA nLinea = 1;  |SI nLinea [ 4;  |HACIENDO nLinea = nLinea + 1;
           |HAZ GrabaLinea;
     |SIGUE;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#isom0016, nRango, 0668, 1898, Baja116, Alta116, NULL;
     nGrid = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #isom0016;

     |BUCLE isom0016B;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Entra2016;
     nHasta = 5;
     aAlfa  = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Registro electr¢nico";
     |VENTANA 0501, 2099, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{13}}Consigne el N£mero de Referencia de Sociedades (NRS) ";
     |CONTROL_SIMPLE 0, aAlfa, 0602, 0665, NULL;

     aAlfa = "LABEL,{{11}}1.- Documentaci¢n presentada por el Anexo III (Ajustes y deducciones)";
     |CONTROL_SIMPLE 0, aAlfa, 0702, 0765, NULL;

     aAlfa = "LABEL,{{11}}2.- Documentación presentada por el Anexo IV (Personal investigador)";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0965, NULL;

     aAlfa = "LABEL,{{11}}3.- Documento normalizado presentada por el Anexo V";
     |CONTROL_SIMPLE 0, aAlfa, 1102, 1165, NULL;

     aAlfa = "LABEL,{{11}}4.- N£mero de justificante identificativo de la ";
     aAlfa = aAlfa + "declaraci¢n informativa de ayudas Régimen Econ¢mico y Fiscal de Canarias";
     |CONTROL_SIMPLE 0, aAlfa, 1302, 1465, NULL;

     aAlfa = "LABEL,{{11}}5.- N£mero de justificante identificativo autoliquidaci¢n ";
     aAlfa = aAlfa + "de la presentaci¢n patrimonial por conversi¢n de activos (DA 13¦LIS)";
     |CONTROL_SIMPLE 0, aAlfa, 1602, 1765, NULL;

     |ABRE #isom0016;

     |PARA nLinea = 1;  |SI nLinea [ 5;  |HACIENDO nLinea = nLinea + 1;
           |HAZ GrabaLinea;
     |SIGUE;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#isom0016, nRango, 0668, 1898, Baja116, Alta116, NULL;
     nGrid = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #isom0016;

     |BUCLE isom0016B;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROCESO Entra2017;
     nHasta = 5;
     aAlfa  = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Registro electr¢nico";
     |VENTANA 0501, 2099, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{13}}Consigne el N£mero de Referencia de Sociedades (NRS) ";
     |CONTROL_SIMPLE 0, aAlfa, 0602, 0665, NULL;

     aAlfa = "LABEL,{{11}}1.- Documentaci¢n presentada por el Anexo III (Ajustes y deducciones)";
     |CONTROL_SIMPLE 0, aAlfa, 0702, 0765, NULL;

     aAlfa = "LABEL,{{11}}2.- Documentación presentada por el Anexo IV (Personal investigador)";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0965, NULL;

     aAlfa = "LABEL,{{11}}3.- Documento normalizado presentado por el Anexo V ";
     aAlfa = aAlfa + "Orden HAP/871/2016 (Art. 16.4 RIS)";
     |CONTROL_SIMPLE 0, aAlfa, 1102, 1265, NULL;

     aAlfa = "LABEL,{{11}}4.- N£mero de justificante identificativo de la ";
     aAlfa = aAlfa + "declaraci¢n informativa de ayudas Régimen Econ¢mico y Fiscal de Canarias";
     |CONTROL_SIMPLE 0, aAlfa, 1402, 1565, NULL;

     aAlfa = "LABEL,{{11}}5.- N£mero de justificante identificativo autoliquidaci¢n ";
     aAlfa = aAlfa + "de la presentaci¢n patrimonial por conversi¢n de activos (DA 13¦LIS)";
     |CONTROL_SIMPLE 0, aAlfa, 1702, 1865, NULL;

     |ABRE #isom0016;

     |PARA nLinea = 1;  |SI nLinea [ 5;  |HACIENDO nLinea = nLinea + 1;
           |HAZ GrabaLinea;
     |SIGUE;

     |SI enModoConsulta = 0;
         nRango = 1 + 2 + 4 + 8 + 16 + 32;
     |SINO;
         nRango = 4 + 8 + 16 + 32;
     |FINSI;

     |LINEAL_SIMPLE #1#isom0016, nRango, 0668, 1898, Baja116, Alta116, NULL;
     nGrid = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #isom0016;

     |BUCLE isom0016B;

     |DESTRUYECONTROL nGrid;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
|FPRC;

|PROGRAMA;
     |SI enAnyo [ 2014;  |HAZ Entra2014;  |FINSI;
     |SI enAnyo = 2015;  |HAZ Entra2015;  |FINSI;
     |SI enAnyo = 2016;  |HAZ Entra2016;  |FINSI;
     |SI enAnyo ] 2017;  |HAZ Entra2017;  |FINSI;
|FPRO;
