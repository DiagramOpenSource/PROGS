|FICHEROS;
     program@ #0;

     maempr01 #1;
     maempr22 #22;
     maempr23 #23;
     maempr24 #24;

     &poblaci@ #703;
      maprovin #704;
     :/integral/def/dsam0101 #705;

     &haciend@ #706;
      imphacie #707;
     :/integral/def/dsam0102 #708;

     &regisnif@ #709;
     :/basica/def/agim0003   #710;
     :/integral/def/dsam0103 #711;

     &clientes@ #715;
     :/basica/def/agifigen   #716;
     :/integral/def/dsam0000 #717;

     :/basica/def/agim0019   #19;

     &sgpaises@ #718;
     :/basica/def/agim0016   #719;
     :/integral/def/dsam0104 #720;
|FIN;

|VARIABLES;
     aBase           = "";
     aProgAct        = "";
     aDef            = "";
     aPathReo        = "";
     aAlfa           = "";
     aVariable       = "";
     aFichero        = "";
     aIPRemoto       = "";
     aUsuario        = "";

     nCampoCodProv   = 0;
     nCampoCodPobl   = 0;
     nCampoNomProv   = 0;
     nCampoNomPobl   = 0;
     nCanal          = 0;

     &eaPrograma     = "";
     &enSw           = 0;
     &enCodProv      = 0;
     &enCodPobl      = 0;
     &enModoPob      = 0;
     &eaPoblacion    = "";
     &eaPoblaParri   = "";
     &eaCodNif       = "";
     &eswNif         = 0;
     &eaCodUsu       = "";
     &enCodCli       = 0;
     &enSwDeDonde    = 0;
     &enEmpresa      = 0;
     &fFechaChequeo  = @;
     &enError        = 0;
     &enSaltaError   = 0;
     &fFechaDisol    = @;
     &eaCodPais      = "";

     &eaPathBasica   = "";
     &eaPathContagen = "";
     &eaPathContanex = "";
     &eaPathContasoc = "";
     &eaPathRen2000  = "";
     &eaPathRen1999  = "";
     &eaPathRen1998  = "";
     &eaPathRen1997  = "";
     &eaPathRen1996  = "";
     &eaPathRen1995  = "";
     &eaPathRen1994  = "";
     &eaPathFacturar = "";
     &eaPathLaboral  = "";
     &eaPathIntegral = "";
     &eaPathDsmodelo = "";
     &eaPathFiscal   = "";

     &eaAzul         = "";
     &eaVerde        = "";
     &eaRojo         = "";
     &eaGris         = "";
|FIN;

|PROCESO Tipo88;  |TIPO 88;
     eaPrograma = FSalida % -108;
     enSw       = 0;

     |SI eaPrograma = "maempr01";  enSw = 1;  |REFERENCIA_DEF program@, #1;     |FINSI;
     |SI eaPrograma = "maempr10";  enSw = 1;  |REFERENCIA_DEF program@, #1;     |FINSI;
     |SI eaPrograma = "maempr22";  enSw = 1;  |REFERENCIA_DEF program@, #22;    |FINSI;
     |SI eaPrograma = "maempr23";  enSw = 1;  |REFERENCIA_DEF program@, #23;    |FINSI;
     |SI eaPrograma = "maempr24";  enSw = 1;  |REFERENCIA_DEF program@, #24;    |FINSI;

     |SI enSw = 0;  |ACABA;  |FINSI;

     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         ||Desactivado

         |MODO_RELACION #0, 1, "maprovin", "N", "N";
         |MODO_RELACION #0, 1, "imphacie", "N", "N";
         |MODO_RELACION #0, 1, "agim0016", "N", "N";
         |MODO_RELACION #0, 1, "agim0003", "N", "N";

         |MODO_RELACION #0, 1, "maprovin", "X", "X";
         |MODO_RELACION #0, 1, "imphacie", "X", "X";
         |MODO_RELACION #0, 1, "agim0016", "X", "X";
         |MODO_RELACION #0, 1, "agim0003", "X", "X";
         || Activado

         |MODO_RELACION #0, 0, "dsam0101", "X", "X";
         |MODO_RELACION #0, 0, "dsam0102", "X", "X";
         |MODO_RELACION #0, 0, "dsam0104", "X", "X";
         |MODO_RELACION #0, 0, "dsam0103", "X", "X";

         |MODO_RELACION #0, 1, "dsam0101", "S", "S";
         |MODO_RELACION #0, 1, "dsam0102", "S", "S";
         |MODO_RELACION #0, 1, "dsam0104", "S", "S";
         |MODO_RELACION #0, 1, "dsam0103", "N", "N";

         |REFERENCIA_DEF poblaci@,  #705;
         |REFERENCIA_DEF haciend@,  #708;
         |REFERENCIA_DEF regisnif@, #711;
         |REFERENCIA_DEF sgpaises@, #720;
     |SINO;
         |MODO_RELACION #0, 1, "dsam0101", "N", "N";
         |MODO_RELACION #0, 1, "dsam0102", "N", "N";
         |MODO_RELACION #0, 1, "dsam0104", "N", "N";
         |MODO_RELACION #0, 1, "dsam0103", "N", "N";

         |MODO_RELACION #0, 1, "dsam0101", "X", "X";
         |MODO_RELACION #0, 1, "dsam0102", "X", "X";
         |MODO_RELACION #0, 1, "dsam0104", "X", "X";
         |MODO_RELACION #0, 1, "dsam0103", "X", "X";

         |MODO_RELACION #0, 0, "maprovin", "X", "X";
         |MODO_RELACION #0, 0, "imphacie", "X", "X";
         |MODO_RELACION #0, 0, "agim0016", "X", "X";
         |MODO_RELACION #0, 0, "agim0003", "X", "X";

         |MODO_RELACION #0, 1, "maprovin", "S", "S";
         |MODO_RELACION #0, 1, "imphacie", "S", "S";
         |MODO_RELACION #0, 1, "agim0016", "S", "S";
         |MODO_RELACION #0, 1, "agim0003", "N", "N";

         |REFERENCIA_DEF poblaci@,  #704;
         |REFERENCIA_DEF haciend@,  #707;
         |REFERENCIA_DEF regisnif@, #710;
         |REFERENCIA_DEF sgpaises@, #719;
     |FINSI;
|FPRC;

|PROCESO ParrillaPobla;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         enCodProv   = #0nCampoCodProv;
         enCodPobl   = #0nCampoCodPobl;
         eaPoblacion = #0nCampoNomPobl;
         enModoPob   = 1;
         |SUB_EJECUTA_NP ":integral/dsaw9996";
         |SI eaPoblaParri ! "";
             #0nCampoNomPobl = eaPoblaParri;
         |SINO;
             #0nCampoNomPobl = #703#3;
         |FINSI;
         |PINTA #0nCampoNomPobl;
     |SINO;
         enSwDeDonde     = 0;
         #0nCampoNomPobl = #703#3;
     |FINSI;

     |PINTA #0nCampoNomPobl;
|FPRC;

|PROCESO LeeLocalidad;
     eaPrograma = Control;

     |SI eaPrograma = "maempr01";
         |REFERENCIA_DEF program@, #1;
         nCampoNomPobl = 13;
         nCampoNomProv = 14;
     |FINSI;

     |SI eaPrograma = "maempr10";
         |REFERENCIA_DEF program@, #1;
         nCampoNomPobl = 13;
         nCampoNomProv = 14;
     |FINSI;

     |ABRE #703;
     nCampoCodProv = Campo - 1;
     nCampoCodPobl = Campo;
     #703#0 = #0nCampoCodProv;
     #703#1 = #0nCampoCodPobl;
     |LEE 040#703=;
     |SI FSalida = 0;
         |HAZ ParrillaPobla;

         |SI nCampoNomProv ! -1;
             #0nCampoNomProv = #703#2;
             |PINTA #0nCampoNomProv;
         |FINSI;
     |SINO;
         |MENAV "    No existe Poblacion.";
         |ERROR;
     |FINSI;
     |CIERRA #703;
|FPRC;

|PROCESO LeePoblacion;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF poblaci@, #705;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF poblaci@, #704;
     |FINSI;

     |ABRE #703;
     #703#0 = enCodProv; #703#1 = enCodPobl;
     |LEE 040#703=;
     |SI FSalida ! 0; |DDEFECTO #703; |FINSI;
     |CIERRA #703;
|FPRC;

|PROCESO LeeHacienda;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF haciend@, #708;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF haciend@, #707;
     |FINSI;

     |ABRE #706;
     #706#0 = enCodProv; #706#1 = enCodPobl;
     |LEE 040#706=;
     |SI FSalida ! 0; |DDEFECTO #706; |FINSI;
     |CIERRA #706;
|FPRC;

|PROCESO LeeNifs;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF regisnif@, #711;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF regisnif@, #710;
     |FINSI;

     eswNif = 0;
     |ABRE #709;
     #709#0 = eaCodNif;
     |LEE 040#709=;
     |SI FSalida ! 0; |DDEFECTO #709; eswNif = 1;  |FINSI;
     |CIERRA #709;
|FPRC;

|PROCESO PreparaInformes;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
     |SINO;
         enSwDeDonde = 0;
     |FINSI;

     |DBASS aBase;   |QBT aBase;

     aFichero = aBase + "contasoc/def/hacienda.ref";
     |XABRE "W", aFichero, nCanal;
     |SI enSwDeDonde = 1;
         aVariable = ":/integral/def/dsam0102" + &13 + &10;
     |SINO;
         aVariable = "imphacie" + &13 + &10;
     |FINSI;
     |XGRABA nCanal, aVariable;
     |XCIERRA nCanal;
|FPRC;

|PROCESO LeePersona;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
          enSwDeDonde = 1;
          |REFERENCIA_DEF clientes@, #717;
     |SINO;
          enSwDeDonde = 0;
         |REFERENCIA_DEF clientes@, #716;
     |FINSI;

     |ABRE #715;
     #715#0 = enCodCli;
     |LEE 040#715=;
     |SI FSalida ! 0; |DDEFECTO #715; |FINSI;
     |CIERRA #715;
|FPRC;

|PROCESO eLeePais;
     |DBASS aBase;   |QBT aBase;
     aBase = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aBase, nCanal;
     |SI FSalida ] 0;
         enSwDeDonde = 1;
         |REFERENCIA_DEF sgpaises@, #720;
     |SINO;
         enSwDeDonde = 0;
         |REFERENCIA_DEF sgpaises@, #719;
     |FINSI;

     |ABRE #718;
     #718#0 = eaCodPais;
     |LEE 040#718=;
     |SI FSalida ! 0; |DDEFECTO #718; |FINSI;
     |CIERRA #718;
|FPRC;

|PROCESO SinBarra;  |TIPO 5;
     FSalida = "SINBARRA";
|FPRC;

|PROCESO BusquedaApli;
     eaPathBasica    = "";
     eaPathContagen  = "";
     eaPathContanex  = "";
     eaPathContasoc  = "";
     eaPathRen2000   = "";
     eaPathRen1999   = "";
     eaPathRen1998   = "";
     eaPathRen1997   = "";
     eaPathRen1996   = "";
     eaPathRen1995   = "";
     eaPathRen1994   = "";
     eaPathFacturar  = "";
     eaPathLaboral   = "";
     eaPathIntegral  = "";
     eaPathDsmodelo  = "";
     eaPathFiscal    = "";

     |DBASS aBase;   |QBF aBase;

     aAlfa = aBase + "basica/def/agifigen.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathBasica = aBase + "basica/";
     |FINSI;

     aAlfa = aBase + "contagen/def/canempre.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContagen = aBase + "contagen/";
     |FINSI;

     aAlfa = aBase + "contanex/def/vamanpax.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContanex = aBase + "contanex/";
     |FINSI;

     aAlfa = aBase + "contasoc/def/maempr10.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathContasoc = aBase + "contasoc/";
     |FINSI;

     aAlfa = aBase + "ren2000/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen2000   = aBase + "ren2000/";  || Cambiar por ren2000
     |FINSI;

     aAlfa = aBase + "ren1999/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1999   = aBase + "ren1999/";  || Cambiar por ren1999
     |FINSI;

     aAlfa = aBase + "ren1998/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1998   = aBase + "ren1998/";  || Cambiar por ren1998
     |FINSI;

     aAlfa = aBase + "ren1997/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1997   = aBase + "ren1997/";  || Cambiar por ren1997
     |FINSI;

     aAlfa = aBase + "ren1996/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1996   = aBase + "ren1996/";  || Cambiar por ren1996
     |FINSI;

     aAlfa = aBase + "ren1995/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1995   = aBase + "ren1995/";  || Cambiar por ren1995
     |FINSI;

     aAlfa = aBase + "ren1994/def/reacceso.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathRen1994   = aBase + "ren1994/";  || Cambiar por ren1994
     |FINSI;

     aAlfa = aBase + "facturar/def/asclient.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathFacturar  = aBase + "facturar/";    || Cambiar por facturar
     |FINSI;

     aAlfa = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathLaboral   = aBase + "laboral/";
     |FINSI;

     aAlfa = aBase + "integral/def/dsam0000.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathIntegral  = aBase + "integral/";
     |FINSI;

     aAlfa = aBase + "modelos/def/dsmom001.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathDsmodelo  = aBase + "modelos/";
     |FINSI;

     aAlfa = aBase + "fiscal/def/eosclien.mas";
     |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathFiscal = aBase + "fiscal/";
     |FINSI;
|FPRC;

|PROCESO agim0019;
     |SI #19#3 > fFechaChequeo;
         |ACABA;
     |FINSI;

     enError = 0;

     |SI #19#54 = "I";
         |SI #19#55 < fFechaChequeo;
             enError = 1;
         |FINSI;
     |FINSI;

     |SI #19#12 > "01.01.0000";  |Y #19#12 < fFechaChequeo;
         enError     = 2;
         fFechaDisol = #19#12;
     |FINSI;
|FPRC;

|DEFBUCLE agim0019;
     #19#1;
     ;
     enEmpresa, 01;
     enEmpresa, 99;
     ;
     NULL, agim0019;
|FIN;

|PROCESO ChequeaEmpresa;
     enError = 0;
     |BUCLE agim0019;
|FPRC;

|PROCESO SaltaError;
     enSaltaError = 0;

     |IP_REMOTO aIPRemoto;
     aUsuario = Usuario % 810;  |QBF aUsuario;
     |SI aIPRemoto = "192.168.10.42";  |Y aUsuario = "JUANMA";
         enSaltaError = 1;
     |FINSI;
|FPRC;

|PROCESO CargaColores;
     eaAzul  = "18,28,245;255,255,255";
     eaVerde = "0,185,0;255,255,255";
     eaRojo  = "255,80,80;255,255,255";
     eaGris  = "90,90,90;255,255,255";
|FPRC;
