|FICHEROS;
     isom9000;
     isodi202;
|FIN;

|INCLUYE 9001vari;

|PROCESO Emision;
     eaImpre = "N";
     eaJusti = "";

     |HAZ AbreSecuencial;

     |SI aQuePeriodo [ "20121P";
         |HAZ P90012010;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo [ "20132P";
         |HAZ P90012013;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo [ "20143P";
         |HAZ P90012014;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo [ "20153P";
         |HAZ P90012015;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo = "20161P";
         |HAZ P90012016_1P;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo [ "20163P";
         |HAZ P90012016_3P;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo [ "20181P";
         |HAZ P90012017_1P;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;

     |SI aQuePeriodo ] "20182P";
         |HAZ P90012018_2P;
         |HAZ CierraSecuencial;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO EmisionManual;
     |HAZ Emision;

     #isom9000#8 = eaImpre;
     #isom9000#9 = eaJusti;
     |GRABA 020#isom9000.a;
     |LIBERA #isom9000;
|FPRC;

|PROCESO PermisoPortal;
     enPortal = 1;

/*
     enPortal = 0;

     |DBASS aBase;  |QBF aBase;

     aArchivo = aBase + "integral/integral.ini";

     |XABRE "U", aArchivo, nHandle;
     |SI FSalida ] 0;
         |PARA; |SI; |HACIENDO;
               |XLEE nHandle, 250, aCadena;
               |SI FSalida < 0;  |SAL;  |FINSI;
               |QBF aCadena;

               |SI aCadena = "PORTAL";
                    enPortal = 1;
                    |SAL;
               |FINSI;
          |SIGUE;
          |XLEE nHandle, 100, aLinea;
     |FINSI;
     |XCIERRA nHandle;

     |SI enPortal = 0;
          aAlfa = "0000Esta opción requiere tener instalado ";
          aAlfa = aAlfa + "el Portal Asesor DsElephant.";
          aAlfa = aAlfa + "Consulte con su comercial.";
          |MENAV aAlfa;
     |FINSI;

     |PULSATECLA;
*/
|FPRC;

|PROCESO EmisionDirecta;
     |HAZ PermisoPortal;
     |SI enPortal = 0;
         |ACABA;
     |FINSI;

     eaImpre = "N";
     eaJusti = "";

     |HAZ AbreSecuencial;

     |SI aQuePeriodo ] "20182P";
         |HAZ P90012018_2P;
     |FINSI;

     |XCIERRA enHandle;

     aOrigen  = eaDirServidor + eaFicheroTxt;
     aDestino = eaDirLanza + eaFicheroTxt;
     |HAZ CopiaFichero;

     aFic = "isodi202" + Usuario;
     |NOME_DAT #isodi202#aFic#;

     |ABRE #isodi202;  |CIERRA #isodi202;  |DELINDEX #isodi202;

     |ABRE #isodi202;
     #isodi202#0  = 1;
     #isodi202#2  = eaDirServidor;
     #isodi202#3  = eaDirLanza;
     #isodi202#4  = eaDirLanza;
     #isodi202#5  = eaDirLanza;
     #isodi202#6  = eaPathExplorador;
     #isodi202#7  = eaFicheroTxt;
     #isodi202#10 = #isom9000#4;
     #isodi202#11 = #isom9000#5;
     #isodi202#12 = "202";
     #isodi202#13 = enAnyo;
     #isodi202#14 = eaX002_14;
     #isodi202#15 = eaX002_15;
     #isodi202#16 = eaX002_16;
     #isodi202#17 = eaX002_17;
     #isodi202#18 = eaX002_18;
     #isodi202#19 = eaX002_19;
     #isodi202#20 = eaX002_20;
     #isodi202#21 = "ES";

     |GRABA 020#isodi202.n;
     |LIBERA #isodi202;
     |CIERRA #isodi202;

     |SUB_EJECUTA "isodi202";

     aAbre = eaDirServidor + Usuario + ".ok";
     |XABRE "E", aAbre, 0;
     |SI FSalida ] 0;
         eaImpre = "S";
     |FINSI;

     #isom9000#8 = eaImpre;
     #isom9000#9 = eaJusti;
     |GRABA 020#isom9000.a;
     |LIBERA #isom9000;

     |DELINDEX #isodi202;

     |PULSATECLA;
|FPRC;

|PROGRAMA;
     |ABRE #isom9000;
     #isom9000#0 = enEmpresa;
     #isom9000#1 = enAnyo;
     #isom9000#2 = eaPeriodo;
     #isom9000#3 = enCompl;
     |LEE 101#isom9000.=;
     |SI FSalida ! 0;
         |CIERRA #isom9000;
         |ACABA;
     |FINSI;

     aQuePeriodo = #isom9000#1 + #isom9000#2;
     |SI aQuePeriodo ] "20182P";
         aPopup1  = -1;
         aPopup2  = 2;
         aPopup3  = "Presentacion MANUAL";
         aPopup4  = "Presentacion DIRECTA";

         IaPopup  = aPopup1  <-;
         |ESPECIFICA "TRACKPOPUP", aPopup;

         |SI FSalida = 1;  |HAZ EmisionManual;   |FINSI;
         |SI FSalida = 2;  |HAZ EmisionDirecta;  |FINSI;
     |SINO;
         |HAZ EmisionManual;
     |FINSI;

     |CIERRA #isom9000;
|FPRO;
