|FICHEROS;
      isoy2015;
      maempr10;
      maempr05;
      maempr12;
      maempr13;
      maempr14;
      maempr15;
      maempr16;
      maempr18;
      maempr19;
      maempr20;
      maempr21;

      isom0000;
      isom0001;
      isom0010;
      isom0013;
      isom0014;
      isom0015;
      isom0022;
      isom0023;
      isom0025;
      isom0029;

      isom0507;
      isom0510;
      isom0511;
      isom0513;
      isom0515;

      isoh1501;
      isoh0919;
      isoh1522;
      isoh1523;
      isoh1524;
      isoh0923;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aAlfa3         = "";
     aAlfa4         = "";
     aBase          = "";
     aDirServidor   = "";
     aDirInternet   = "";
     aDirLanza      = "";
     aDelindex      = "";
     aFicheroT      = "";
     aFicheroP      = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";
     aLong          = "";
     aTecla         = "";
     aRetu          = "";
     aEsc1          = "";
     aEsc2          = "";

     nLong          = 0;
     nNume          = 0;
     nPos           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nPanta         = 0;
     nCasilla       = 0;
     nFecha         = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nContaBucle    = 0;
     nContaBucleL   = 0;
     nComple        = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nTotal         = 0;
     nValor626      = 0;
     nValor627      = 0;
     nValor628      = 0;
     nValor629      = 0;
     nCanti1        = 0;
     nCanti2        = 0;
     nCanti3           = 0;
     nCanti4           = 0;
     nCantiT           = 0;
     nResto            = 0;
     nTecla            = 0;
     nBotonCont        = 0;
     nBotonSal         = 0;
     nPasada           = 0;
     nImpor264         = 0;
     nImpor265         = 0;
     nImpor266         = 0;
     nImpor1217        = 0;
     nImpor1218        = 0;
     nImpor1219        = 0;
     nImpor1209        = 0;
     nImpor1210        = 0;
     nImpor1211        = 0;

     fFechaD        = @;
     fFechaH        = @;


     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enHandle        = 0;
     &enCanti         = 0;
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaEfectivo      = "";
     &eaAdeudo        = "";
     &eaEntidad       = "";
     &eaOficina       = "";
     &eaDC             = "";
     &eaCuenta         = "";
     &enModelo         = 0;
     &enBanco          = 0;
     &enFormaPag       = 0;
     &enForzar         = 0;
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaFinLinea       = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
     &eaCasilla        = "";
|FIN;

|PROCESO isom0510;
     #isom0022#0 = #maempr10#0;
     #isom0022#1 = #maempr10#1;
     #isom0022#2 = #isom0510#1;
     |LEE 000#isom0022.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0022;  |FINSI;

     |SI #isom0510#2 = "305  ";  |ACABA;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0022#5 ! 0;
             nHay = 1;
             |ERROR10;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0510#2 ! "     ";
         enCanti  = #isom0022#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0510;
      #isom0510#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0510;
|FIN;

|PROCESO isom0515;
     #isom0029#0 = #maempr10#0;
     #isom0029#1 = #maempr10#1;
     #isom0029#2 = #isom0515#1;
     |LEE 000#isom0029.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0029;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0029#2 = 30;  |ACABA;  |FINSI;
         |SI #isom0029#5 = 0;   |ACABA;  |FINSI;

         |SI #isom0515#7 = "1211 ";
             |SI #isom0029#13 = 0;  |Y #isom0029#15 = 0;
                 |ACABA;
             |FINSI;
         |FINSI;

         |SI #isom0029#5  ! 0;  |O #isom0029#7  ! 0;
          |O #isom0029#9  ! 0;  |O #isom0029#11 ! 0;
          |O #isom0029#13 ! 0;  |O #isom0029#15 ! 0;
             nHay = 1;
             |ERROR10;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0515#7 = "1211 ";
         nImpor1209 = #isom0029#9;
         nImpor1210 = #isom0029#13;
         nImpor1211 = #isom0029#15;

         |SI #isom0029#13 = 0;  |Y #isom0029#15 = 0;
             #isom0029#9 = 0;
         |FINSI;
     |FINSI;

     |SI #isom0515#2 = "1212 ";
         |SI nImpor1210 = 0;  |Y nImpor1211 = 0;
             #isom0029#9  = #isom0029#9  - nImpor1209;
             #isom0029#13 = #isom0029#13 - nImpor1210;
             #isom0029#15 = #isom0029#15 - nImpor1211;
         |FINSI;
     |FINSI;

     |SI #isom0515#2 ! "     ";
         enCanti  = #isom0029#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#3 ! "     ";
         enCanti  = #isom0029#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#5 ! "     ";
         enCanti  = #isom0029#9 + #isom0029#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#6 ! "     ";
         enCanti  = #isom0029#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0515#7 ! "     ";
         enCanti  = #isom0029#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0515;
      #isom0515#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0515;
|FIN;

|PROCESO isom0511;
     #isom0023#0 = #maempr10#0;
     #isom0023#1 = #maempr10#1;
     #isom0023#2 = #isom0511#1;
     |LEE 000#isom0023.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0023;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0023#2 = 30;  |ACABA;  |FINSI;
         |SI #isom0023#5 = 0;   |ACABA;  |FINSI;

         |SI #isom0511#2 = "1217";
             |SI #isom0023#9 = 0;  |ACABA;  |FINSI;
         |FINSI;

         nHay = 1;
         |ERROR10;

         |ACABA;
     |FINSI;

     |SI #isom0511#2 = "1217 ";
         nImpor1217 = #isom0023#5;
         nImpor1218 = #isom0023#7;
         nImpor1219 = #isom0023#9;
     |FINSI;

     |SI #isom0511#2 = "1217 ";
         |SI #isom0023#9 = 0;    || No se emiten datos sin no queda nada
             #isom0023#5 = 0;    || para a¤os posteriores
             #isom0023#7 = 0;
         |FINSI;
     |FINSI;

     |SI #isom0511#2 = "538  ";
         |SI nImpor1219 = 0;
             #isom0023#5 = #isom0023#5 - nImpor1217;
             #isom0023#7 = #isom0023#7 - nImpor1218;
         |FINSI;
     |FINSI;

     |SI #isom0511#2 ! "     ";
         enCanti  = #isom0023#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0511#3 ! "     ";
         enCanti  = #isom0023#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0511#4 ! "     ";
         enCanti  = #isom0023#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0511;
      #isom0511#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0511;
|FIN;

|PROCESO isom0513;
     #isom0025#0 = #maempr10#0;
     #isom0025#1 = #maempr10#1;
     #isom0025#2 = #isom0513#1;
     |LEE 000#isom0025.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0025;  |FINSI;

     |SI nPasada = 0;
         |SI #isom0025#5 ! 0;  |O #isom0025#7  ! 0;
          |O #isom0025#9 ! 0;  |O #isom0025#11 ! 0;
             nHay = 1;
             |ERROR10;
         |FINSI;

         |ACABA;
     |FINSI;

     |SI #isom0513#3 ! "     ";
         enCanti  = #isom0025#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0513#4 ! "     ";
         enCanti  = #isom0025#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0513#5 ! "     ";
         enCanti  = #isom0025#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #isom0513#6 ! "     ";
         enCanti  = #isom0025#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0513;
      #isom0513#1;
      ;
      #maempr10#1, 0000;
      #maempr10#1, 9999;
      ;
      NULL, isom0513;
|FIN;

|PROCESO Hoja20;
     nHay    = 0;
     nPasada = 0;
     |ABRE #isom0022;  |SELECT #1#isom0022;
     |ABRE #isom0023;  |SELECT #1#isom0023;
     |ABRE #isom0025;  |SELECT #1#isom0025;
     |ABRE #isom0029;  |SELECT #1#isom0029;

     nHay      = #isom0000#121;
     eaCasilla = "1020";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1021";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1043";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;
     eaCasilla = "1044";  |HAZ LeeFich101;  nHay = nHay + #isom0001#5;

     |SI nHay = 0;  |BUCLE isom0510;     |FINSI;
     |SI nHay = 0;  |BUCLE isom0515;     |FINSI;
     |SI nHay = 0;  |BUCLE isom0511;     |FINSI;
     |SI nHay = 0;  |BUCLE isom0513;     |FINSI;

     |CIERRA #isom0022;
     |CIERRA #isom0023;
     |CIERRA #isom0025;
     |CIERRA #isom0029;

     |SI nHay = 0;  |ACABA;  |FINSI;

     eaAlfa = "<T200200> ";  |HAZ GrabaSecuencial;

     nPasada = 1;

     |ABRE #isom0022; |SELECT #1#isom0022; |BUCLE isom0510; |CIERRA #isom0022;
     |ABRE #isom0029; |SELECT #1#isom0029; |BUCLE isom0515; |CIERRA #isom0029;
     |ABRE #isom0023; |SELECT #1#isom0023; |BUCLE isom0511; |CIERRA #isom0023;
     |ABRE #isom0025; |SELECT #1#isom0025; |BUCLE isom0513; |CIERRA #isom0025;

     enCanti  = #isom0000#121;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "1020";  |HAZ LeeFich101;  enCanti = #isom0001#5;
     eaCasilla = "1043";  |HAZ LeeFich101;  enCanti = enCanti + #isom0001#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "1021";  |HAZ LeeFich101;  enCanti = #isom0001#5;
     eaCasilla = "1044";  |HAZ LeeFich101;  enCanti = enCanti + #isom0001#5;
     |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaAlfa = "</T200200>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO CogePais;
     |ABRE #maempr16;
     #maempr16#0 = aPais;
     |LEE 000#maempr16.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr16;  |FINSI;
     |CIERRA #maempr16;

     aCodPais = #maempr16#2;
|FPRC;

|PROCESO maempr14;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0  = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #isoh0919#0);

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0 = ((nContaBucle / 6) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#2   = "200";
         #isoh0919#3   = "210";
         #isoh0919#89 = "</T200210>";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nCampo            = (nContaBucleL * 5) + 6;
     #isoh0919#nCampo# = #maempr14#3;

     nCampo            = nCampo + 1;
     #isoh0919#nCampo# = #maempr14#4;

     nCampo            = nCampo + 1;
     #isoh0919#nCampo# = #maempr14#5;

     nCampo            = nCampo + 1;
     aPais             = #maempr14#6;  |HAZ CogePais;
     #isoh0919#nCampo# = aCodPais;

     nCampo            = nCampo + 1;
     enCanti           = #maempr14#8;
     |HAZ Calcula17D;
     #isoh0919#nCampo# = eaAlfa;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE maempr14;
     #maempr14#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     nContaBucle = nContaBucle + 1;
     #isoh0919#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #isoh0919#0);

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0     = ((nContaBucle / 6) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#2   = "200";
         #isoh0919#3   = "210";
         #isoh0919#89 = "</T200210>";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nCampo            = (nContaBucleL * 5) + 36;
     #isoh0919#nCampo# = #maempr15#3;

     nCampo            = nCampo + 1;
     #isoh0919#nCampo# = #maempr15#4;

     nCampo            = nCampo + 1;
     aPais             = #maempr15#5;
     |HAZ CogePais;
     #isoh0919#nCampo# = aCodPais;

     nCampo            = nCampo + 1;
     enCanti           = #maempr15#7;
     |HAZ Calcula17D;
     #isoh0919#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr15#8;
     |HAZ Calcula3E2D;
     #isoh0919#nCampo# = eaAlfa;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE maempr15;
     #maempr15#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr15;
|FIN;

|PROCESO isom0013;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0       = ((nContaBucle / 10) + .50) ! 0;

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         nContaBucleL = 66;

         #isoh0919#0 = ((nContaBucle / 10) + .50) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#3   = "210";
         #isoh0919#89 = "</T200210>";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     |SI nContaBucleL > 75;  nContaBucleL = 67;  |FINSI;

     #isoh0919#nContaBucleL# = #isom0013#3;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE isom0013;
     #isom0013#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0013;
|FIN;

|PROCESO isom0014;
     nContaBucle  = nContaBucle + 1;
     #isoh0919#0       = ((nContaBucle / 5) + .49) ! 0;

     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         nContaBucleL = 77;

         #isoh0919#0 = ((nContaBucle / 5) + .49) ! 0;

                          #isoh0919#5 = "";
         |SI #isoh0919#0 ! 1;  #isoh0919#5 = "C";  nComple = 1;  |FINSI;

         #isoh0919#3   = "210";
         #isoh0919#89 = "</T200210>";

         |GRABA 020#isoh0919.b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     |SI nContaBucleL > 82;  nContaBucleL = 78;  |FINSI;

     #isoh0919#nContaBucleL# = #isom0014#3;

     |GRABA 020#isoh0919.a;
     |LIBERA #isoh0919;
|FPRC;

|DEFBUCLE isom0014;
     #isom0014#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0014;
|FIN;

|PROCESO isoh0919;
     |PARA nCampo = 1;  |SI nCampo [ 89;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0919#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0919;
     #isoh0919#1;
     ;
     01;
     99;
     ;
     NULL, isoh0919;
|FIN;

|PROCESO Hoja21;
     nHay = 0;

     |SI #isoh1501#43 = "0";
         |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |ABRE #maempr14;
     #maempr14#0 = #maempr10#0;
     #maempr14#1 = #maempr10#1;
     #maempr14#2 = 1;
     |LEE 000#maempr14.];
     |SI FSalida = 0;  |Y  #maempr14#0 = #maempr10#0;  |Y #maempr14#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr14;

     |ABRE #maempr15;
     #maempr15#0 = #maempr10#0;
     #maempr15#1 = #maempr10#1;
     #maempr15#2 = 1;
     |LEE 000#maempr15.];
     |SI FSalida = 0;  |Y  #maempr15#0 = #maempr10#0;  |Y #maempr15#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr15;

     |SI #isoh1501#66 = "1";
         |ABRE #isom0013;
         #isom0013#0 = #maempr10#0;
         #isom0013#1 = #maempr10#1;
         #isom0013#2 = 1;
         |LEE 000#isom0013.];
         |SI FSalida = 0;  |Y  #isom0013#0 = #maempr10#0;  |Y #isom0013#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0013;
     |FINSI;

     |SI #isoh1501#30 = "1";
         |ABRE #isom0014;
         #isom0014#0 = #maempr10#0;
         #isom0014#1 = #maempr10#1;
         #isom0014#2 = 1;
         |LEE 000#isom0014.];
         |SI FSalida = 0;  |Y  #isom0014#0 = #maempr10#0;  |Y #isom0014#1 = #maempr10#1;
             nHay = 1;
         |FINSI;
         |CIERRA #isom0014;
     |FINSI;

     |SI #isom0000#83 ! 0;  nHay = 1;  |FINSI;

     nValor = 0;
     |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h2" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0919#aDelindex#;
     |ABRE #isoh0919; |CIERRA #isoh0919; |DELINDEX #isoh0919;

     |ABRE #isoh0919;
     #isoh0919#0 = 1;
     |LEE 101#isoh0919.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0919;
         #isoh0919#0   = 1;
         #isoh0919#5   = "";
         #isoh0919#2   = "200";
         #isoh0919#3   = "210";
         #isoh0919#89  = "</T200210>";

         |SI #isoh1501#66 = "1";
             enCanti   = #isom0000#80;  |HAZ Calcula17D;  #isoh0919#66 = eaAlfa;
         |FINSI;

         |SI #isoh1501#30 = "1";
             enCanti   = #isom0000#81;  |HAZ Calcula17D;  #isoh0919#76  = eaAlfa;
                                                     #isoh0919#77  = (("000" + #isom0000#82) % -103);
         |FINSI;

         |SI #isoh1501#21 = "1";  |O #isoh1501#22 = "1";  |O #isoh1501#32 = "1";
          |O #isoh1501#33 = "1";  |O #isoh1501#36 = "1";
             enCanti   = #isom0000#83;  |HAZ Calcula17D;  #isoh0919#83 = eaAlfa;
         |FINSI;

         eaAlfa    = (("0000" + #isom0000#2) % -104); #isoh0919#84 = eaAlfa;
         enCanti   = #isom0000#2;  |HAZ Calcula17D;
         enCanti   = #isom0000#3;  |HAZ Calcula17D;   #isoh0919#85 = eaAlfa;
         enCanti   = #isom0000#4;  |HAZ Calcula17D;   #isoh0919#86 = eaAlfa;
         enCanti   = #isom0000#5;  |HAZ Calcula17D;   #isoh0919#87 = eaAlfa;
         enCanti   = #isom0000#6;  |HAZ Calcula17D;   #isoh0919#88 = eaAlfa;

         |GRABA 020#isoh0919.n;
         |LIBERA #isoh0919;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr14;
     nContaBucle = 0;    |BUCLE maempr15;

     |SI #isoh1501#66 = "1";
         nContaBucleL = 66;
         nContaBucle  = 0;   |BUCLE isom0013;
     |FINSI;

     |SI #isoh1501#30 = "1";
         nContaBucleL = 77;
         nContaBucle  = 0;   |BUCLE isom0014;
     |FINSI;

     |CIERRA #isoh0919;

     |BUCLE isoh0919;

     |ABRE #isoh0919; |CIERRA #isoh0919; |DELINDEX #isoh0919;
|FPRC;

|PROCESO GrabaNuevo22;
     #isoh1522#0  = nContaBucle;
     |LEE 101#isoh1522.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1522;
         #isoh1522#0  = nContaBucle;

         #isoh1522#5 = "";
         |SI #isoh1522#0 ! 1;  #isoh1522#5 = "C";  nComple = 1;  |FINSI;

         #isoh1522#2   = "200";
         #isoh1522#3   = "220";
         #isoh1522#27  = #maempr19#3;
         #isoh1522#28  = #maempr19#4;
         #isoh1522#105 = "</T200220>";

         |GRABA 020#isoh1522.b;
     |SINO;
         #isoh1522#27  = #maempr19#3;
         #isoh1522#28  = #maempr19#4;
     |FINSI;
|FPRC;

|PROCESO maempr20;
     nContaBucleL  = nContaBucleL + 1;
     |SI nContaBucleL = 4;
         |GRABA 020#isoh1522.a;
         |LIBERA #isoh1522;

         nContaBucle  = nContaBucle + 1;
         |HAZ GrabaNuevo22;

         nContaBucleL  = 1;
     |FINSI;

     nCampo            = (nContaBucleL * 6) + 23;
     #isoh1522#nCampo# = #maempr20#4;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr20#5;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr20#6 > " ";

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr20#7;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr20#8 > " ";

     nCampo            = nCampo + 1;
     enCanti           = #maempr20#9;
     |HAZ Calcula17D;
     #isoh1522#nCampo# = eaAlfa;
|FPRC;

|DEFBUCLE maempr20;
     #maempr20#1;
     ;
     #maempr19#0, #maempr19#1, #maempr19#5, #maempr19#2, 00;
     #maempr19#0, #maempr19#1, #maempr19#5, #maempr19#2, 99;
     ;
     NULL, maempr20;
|FIN;

|PROCESO maempr19;
     nContaBucle  = nContaBucle + 1;
     |HAZ GrabaNuevo22;

     nContaBucleL = 0;
     |BUCLE maempr20;

     |GRABA 020#isoh1522.a;
     |LIBERA #isoh1522;
|FPRC;

|DEFBUCLE maempr19;
     #maempr19#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr19;
|FIN;

|PROCESO maempr18;
     nContaBucle  = nContaBucle + 1;
     #isoh1522#0  = ((nContaBucle / 4) + .49) ! 0;
     nContaBucleL = (nContaBucle + 3) - (4 * #isoh1522#0);

     |LEE 101#isoh1522.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1522;
         #isoh1522#0  = ((nContaBucle / 4) + .49) ! 0;

         #isoh1522#5 = "";
         |SI #isoh1522#0 ! 1;  #isoh1522#5 = "C";  nComple = 1;  |FINSI;

         #isoh1522#2   = "200";
         #isoh1522#3   = "220";
         #isoh1522#105 = "</T200220>";

         |GRABA 020#isoh1522.b;
     |FINSI;

     nCampo            = (nContaBucleL * 9) + 47;
     #isoh1522#nCampo# = #maempr18#3;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr18#4;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr18#5;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr18#6 > " ";

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr18#7;

     nCampo            = nCampo + 1;
     aAlfa             = ("00" + #maempr18#8) % -102;
     #isoh1522#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = #maempr18#9;

                                  aAlfa = "";
     |SI #maempr18#10 = "1§ a)";  aAlfa = "1A";  |FINSI;
     |SI #maempr18#10 = "1§ b)";  aAlfa = "1B";  |FINSI;
     |SI #maempr18#10 = "1§ c)";  aAlfa = "1C";  |FINSI;
     |SI #maempr18#10 = "2§ a)";  aAlfa = "2A";  |FINSI;
     |SI #maempr18#10 = "2§ b)";  aAlfa = "2B";  |FINSI;

     nCampo            = nCampo + 1;
     #isoh1522#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr18#11;
     |HAZ Calcula17D;
     #isoh1522#nCampo# = eaAlfa;

     |GRABA 020#isoh1522.a;
     |LIBERA #isoh1522;
|FPRC;

|DEFBUCLE maempr18;
     #maempr18#1;
     ;
     #maempr10#0, #maempr10#1, 00, 00;
     #maempr10#0, #maempr10#1, 00, 99;
     ;
     NULL, maempr18;
|FIN;

|PROCESO isoh1522;
     |PARA nCampo = 1;  |SI nCampo [ 105;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1522#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1522;
     #isoh1522#1;
     ;
     01;
     99;
     ;
     NULL, isoh1522;
|FIN;

|PROCESO Hoja22;
     nHay = 0;

     |ABRE #maempr19;
     #maempr19#0 = #maempr10#0;
     #maempr19#1 = #maempr10#1;
     #maempr19#2 = 1;
     |LEE 000#maempr19.];
     |SI FSalida = 0;  |Y  #maempr19#0 = #maempr10#0;  |Y #maempr19#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr19;

     |ABRE #maempr18;
     #maempr18#0 = #maempr10#0;
     #maempr18#1 = #maempr10#1;
     #maempr18#2 = 1;
     |LEE 000#maempr18.];
     |SI FSalida = 0;  |Y  #maempr18#0 = #maempr10#0;  |Y #maempr18#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr18;

     |SI #isoh1501#27 = "0";  |Y #isoh1501#28 = "0";  |Y #isoh1501#29 = "0";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #isom0000#nCampo# = 0;
         |SIGUE;
     |FINSI;

     |PARA nCampo = 2;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #isom0000#nCampo#;
     |SIGUE;

     nValor = nValor + #isom0000#70  + #isom0000#74 + #isom0000#106;
     nValor = nValor + #isom0000#112 + #isom0000#116;
     nValor = nValor + #isom0000#110 + #isom0000#111;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h3" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh1522#aDelindex#;
     |ABRE #isoh1522; |CIERRA #isoh1522; |DELINDEX #isoh1522;

     |ABRE #isoh1522;
     #isoh1522#0 = 1;
     |LEE 101#isoh1522.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1522;
         #isoh1522#0   = 1;
         #isoh1522#5   = "";
         #isoh1522#2   = "200";
         #isoh1522#3   = "220";
         #isoh1522#105 = "</T200220>";

         enCanti   = #isom0000#70;  |HAZ Calcula17D;  #isoh1522#6   = eaAlfa;
         enCanti   = #isom0000#71;  |HAZ Calcula17D;  #isoh1522#7   = eaAlfa;
         enCanti   = #isom0000#72;  |HAZ Calcula17D;  #isoh1522#8   = eaAlfa;
         enCanti   = #isom0000#74;  |HAZ Calcula17D;  #isoh1522#9   = eaAlfa;
         enCanti   = #isom0000#75;  |HAZ Calcula17D;  #isoh1522#10  = eaAlfa;
         enCanti   = #isom0000#76;  |HAZ Calcula17D;  #isoh1522#11  = eaAlfa;
         enCanti   = #isom0000#77;  |HAZ Calcula17D;  #isoh1522#12  = eaAlfa;
         enCanti   = #isom0000#106; |HAZ Calcula17D;  #isoh1522#13  = eaAlfa;
         enCanti   = #isom0000#107; |HAZ Calcula17D;  #isoh1522#14  = eaAlfa;
         enCanti   = #isom0000#108; |HAZ Calcula17D;  #isoh1522#15  = eaAlfa;
         enCanti   = #isom0000#109; |HAZ Calcula17D;  #isoh1522#16  = eaAlfa;
         enCanti   = #isom0000#112; |HAZ Calcula17D;  #isoh1522#17  = eaAlfa;
         enCanti   = #isom0000#113; |HAZ Calcula17D;  #isoh1522#18  = eaAlfa;
         enCanti   = #isom0000#114; |HAZ Calcula17D;  #isoh1522#19  = eaAlfa;
         enCanti   = #isom0000#115; |HAZ Calcula17D;  #isoh1522#20  = eaAlfa;
         enCanti   = #isom0000#116; |HAZ Calcula17D;  #isoh1522#21  = eaAlfa;
         enCanti   = #isom0000#117; |HAZ Calcula17D;  #isoh1522#22  = eaAlfa;
         enCanti   = #isom0000#118; |HAZ Calcula17D;  #isoh1522#23  = eaAlfa;
         enCanti   = #isom0000#119; |HAZ Calcula17D;  #isoh1522#24  = eaAlfa;
         enCanti   = #isom0000#78;  |HAZ Calcula17D;  #isoh1522#25  = eaAlfa;
         enCanti   = #isom0000#79;  |HAZ Calcula17D;  #isoh1522#26  = eaAlfa;

         enCanti   = #isom0000#7;   |HAZ Calcula17D;  #isoh1522#83  = eaAlfa;
         enCanti   = #isom0000#17;  |HAZ Calcula17D;  #isoh1522#84  = eaAlfa;
         enCanti   = #isom0000#8;   |HAZ Calcula17D;  #isoh1522#85  = eaAlfa;
         enCanti   = #isom0000#18;  |HAZ Calcula17D;  #isoh1522#86  = eaAlfa;
         enCanti   = #isom0000#9;   |HAZ Calcula17D;  #isoh1522#87  = eaAlfa;
         enCanti   = #isom0000#19;  |HAZ Calcula17D;  #isoh1522#88  = eaAlfa;
         enCanti   = #isom0000#110; |HAZ Calcula17D;  #isoh1522#89  = eaAlfa;
         enCanti   = #isom0000#111; |HAZ Calcula17D;  #isoh1522#90  = eaAlfa;
         enCanti   = #isom0000#20;  |HAZ Calcula17D;  #isoh1522#91  = eaAlfa;
         enCanti   = #isom0000#10;  |HAZ Calcula17D;  #isoh1522#92  = eaAlfa;
         enCanti   = #isom0000#21;  |HAZ Calcula17D;  #isoh1522#93  = eaAlfa;
         enCanti   = #isom0000#11;  |HAZ Calcula17D;  #isoh1522#94  = eaAlfa;
         enCanti   = #isom0000#22;  |HAZ Calcula17D;  #isoh1522#95  = eaAlfa;
         enCanti   = #isom0000#12;  |HAZ Calcula17D;  #isoh1522#96  = eaAlfa;
         enCanti   = #isom0000#23;  |HAZ Calcula17D;  #isoh1522#97  = eaAlfa;
         enCanti   = #isom0000#13;  |HAZ Calcula17D;  #isoh1522#98  = eaAlfa;
         enCanti   = #isom0000#24;  |HAZ Calcula17D;  #isoh1522#99  = eaAlfa;
         enCanti   = #isom0000#14;  |HAZ Calcula17D;  #isoh1522#100 = eaAlfa;
         enCanti   = #isom0000#15;  |HAZ Calcula17D;  #isoh1522#101 = eaAlfa;
         enCanti   = #isom0000#25;  |HAZ Calcula17D;  #isoh1522#102 = eaAlfa;
         enCanti   = #isom0000#16;  |HAZ Calcula17D;  #isoh1522#103 = eaAlfa;
         enCanti   = #isom0000#26;  |HAZ Calcula17D;  #isoh1522#104 = eaAlfa;

         |GRABA 020#isoh1522.n;
         |LIBERA #isoh1522;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr19;
     nContaBucle = 0;    |BUCLE maempr18;

     |CIERRA #isoh1522;

     |BUCLE isoh1522;

     |ABRE #isoh1522; |CIERRA #isoh1522; |DELINDEX #isoh1522;
|FPRC;

|PROCESO isom0507Coo;
     #isom0010#0 = #maempr10#0;
     #isom0010#1 = #maempr10#1;
     #isom0010#2 = #isom0507#1;
     |LEE 000#isom0010.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0010;  |FINSI;

     |SI #isoh1501#27 = "0";  |Y #isoh1501#28 = "0";  |Y #isoh1501#29 = "0";
         #isom0010#4  = "";
         #isom0010#6  = 0;
         #isom0010#8  = 0;
         #isom0010#10 = 0;
     |FINSI;

     |SI #isom0507#4 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#6;  |HAZ Calcula17D;  #isoh1523#nCasilla# = eaAlfa;
     |FINSI;

     |SI #isom0507#5 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#8;  |HAZ Calcula17D;  #isoh1523#nCasilla# = eaAlfa;
     |FINSI;

     |SI #isom0507#6 ! "     ";
         nCasilla = nCasilla + 1;
         enCanti  = #isom0010#10; |HAZ Calcula17D;  #isoh1523#nCasilla# = eaAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507Coo;
      #isom0507#1;
      ;
      #maempr10#1, nDesde;
      #maempr10#1, nHasta;
      ;
      NULL, isom0507Coo;
|FIN;

|PROCESO isom0015;
     nContaBucle  = nContaBucle + 1;
     #isoh1523#0  = ((nContaBucle / 3) + .49) ! 0;
     nContaBucleL = (nContaBucle + 2) - (3 * #isoh1523#0);

     |SI #isoh1501#27 ! "0";  |O #isoh1501#28 ! "0";  |O #isoh1501#29 ! "0";
         eaCasilla = "694";  |HAZ LeeFich110;  nValor  = #isom0010#6;
     |FINSI;

     |LEE 101#isoh1523.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1523;
         #isoh1523#0 = ((nContaBucle / 3) + .49) ! 0;

                               #isoh1523#5 = "";
         |SI #isoh1523#0 ! 1;  #isoh1523#5 = "C";  nComple = 1;  |FINSI;

         #isoh1523#2   = "200";
         #isoh1523#3   = "230";
         #isoh1523#86 = "</T200230>";

         |GRABA 020#isoh1523.b;
     |FINSI;

     nCampo            = (nContaBucleL * 9) + 59;
     #isoh1523#nCampo# = #isom0015#3;

     nCampo            = nCampo + 1;
     #isoh1523#nCampo# = #isom0015#4;

     nCampo            = nCampo + 1;
     #isoh1523#nCampo# = #isom0015#5;

     nCampo            = nCampo + 1;
     #isoh1523#nCampo# = #isom0015#6;

     nCampo            = nCampo + 1;
     #isoh1523#nCampo# = #isom0015#7;

     nCampo            = nCampo + 1;
     aAlfa             = (#isom0015#8 % -104) + (#isom0015#8 % 402) + (#isom0015#8 % 102);
     #isoh1523#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#9;
     |HAZ Calcula17D;
     #isoh1523#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#10;
     |HAZ Calcula17D;
     #isoh1523#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #isom0015#11;
     |HAZ Calcula17D;
     #isoh1523#nCampo# = eaAlfa;

     |GRABA 020#isoh1523.a;
     |LIBERA #isoh1523;
|FPRC;

|DEFBUCLE isom0015;
     #isom0015#1;
     ;
     #maempr10#0, #maempr10#1, 01;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, isom0015;
|FIN;

|PROCESO isoh1523;
     |PARA nCampo = 1;  |SI nCampo [ 86;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1523#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1523;
     #isoh1523#1;
     ;
     01;
     99;
     ;
     NULL, isoh1523;
|FIN;

|PROCESO Hoja23;
     nHay = 0;

     |SI #isoh1501#27 ! "0";  |O #isoh1501#28 ! "0";  |O #isoh1501#29 ! "0";
         eaCasilla = "694";   |HAZ LeeFich110;  nValor  = #isom0010#6;
         eaCasilla = "1225";  |HAZ LeeFich110;  nValor  = nValor + #isom0010#6;
     |FINSI;

     |SI nValor ! 0;  nHay = 1;  |FINSI;

     |ABRE #isom0015;
     #isom0015#0 = #maempr10#0;
     #isom0015#1 = #maempr10#1;
     #isom0015#2 = 1;
     |LEE 000#isom0015.];
     |SI FSalida = 0;  |Y  #isom0015#0 = #maempr10#0;  |Y #isom0015#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #isom0015;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h4" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh1523#aDelindex#;
     |ABRE #isoh1523; |CIERRA #isoh1523; |DELINDEX #isoh1523;

     |ABRE #isoh1523;
     |DDEFECTO #isoh1523;
     #isoh1523#0 = 1;

                           #isoh1523#5 = "";
     |SI #isoh1523#0 ! 1;  #isoh1523#5 = "C";  nComple = 1;  |FINSI;

     #isoh1523#2   = "200";
     #isoh1523#3   = "230";
     #isoh1523#86 = "</T200230>";

     |ABRE #isom0010;
     |SELECT #1#isom0010;
     nCasilla = 5;
     nDesde   = 1005;    nHasta = 1090;  |BUCLE isom0507Coo;
     |CIERRA #isom0010;

     |GRABA 020#isoh1523.n;
     |LIBERA #isoh1523;

     nContaBucle = 0;  |BUCLE isom0015;
     |CIERRA #isoh1523;

     |BUCLE isoh1523;

     |ABRE #isoh1523; |CIERRA #isoh1523; |DELINDEX #isoh1523;
|FPRC;

|PROCESO maempr05;
     nContaBucle  = nContaBucle + 1;
     #isoh1524#0  = ((nContaBucle / 11) + .49) ! 0;
     nContaBucleL = (nContaBucle + 10) - (11 * #isoh1524#0);

     |LEE 101#isoh1524.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1524;
         #isoh1524#0     = ((nContaBucle / 11) + .49) ! 0;

                               #isoh1524#5   = "";
         |SI #isoh1524#0 ! 1;  #isoh1524#5   = "C";  nComple = 1;  |FINSI;

         #isoh1524#3   = "240";
         #isoh1524#180 = "</T200240>";

         |GRABA 020#isoh1524.b;
     |FINSI;

     nCampo            = (nContaBucleL * 8) + 26;
     #isoh1524#nCampo# = #maempr05#3;

                              aAlfa = "0";
     |SI #maempr05#10 = "X";  aAlfa = "1";  |FINSI;

     nCampo            = nCampo + 1;
     #isoh1524#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     #isoh1524#nCampo# = #maempr05#4;

     nCampo            = nCampo + 1;
     #isoh1524#nCampo# = #maempr05#5;

     nCampo            = nCampo + 1;
     #isoh1524#nCampo# = #maempr05#6;

     nCampo            = nCampo + 1;
     nNume             = #maempr05#7;
     aAlfa             = ("00" + nNume) % -102;
     #isoh1524#nCampo# = aAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr05#8;
     |HAZ Calcula17D;
     #isoh1524#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr05#9;
     |HAZ Calcula3E4D;
     #isoh1524#nCampo# = eaAlfa;

     |GRABA 020#isoh1524.a;
     |LIBERA #isoh1524;
|FPRC;

|DEFBUCLE maempr05;
     #maempr05#2;
     ;
     #maempr10#0, #maempr10#1, 999.99, 00;
     #maempr10#0, #maempr10#1,      0, 99;
     ;
     NULL, maempr05;
|FIN;

|PROCESO maempr21;
     nContaBucle  = nContaBucle + 1;
     #isoh1524#0  = ((nContaBucle / 11) + .49) ! 0;
     nContaBucleL = (nContaBucle + 10) - (11 * #isoh1524#0);

     |LEE 101#isoh1524.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh1524;
         #isoh1524#0     = ((nContaBucle / 11) + .49) ! 0;

                               #isoh1524#5   = "";
         |SI #isoh1524#0 ! 1;  #isoh1524#5   = "C";  nComple = 1;  |FINSI;

         #isoh1524#3   = "240";
         #isoh1524#180 = "</T200240>";

         |GRABA 020#isoh1524.b;
     |FINSI;

     nCampo            = (nContaBucleL * 6) + 114;
     #isoh1524#nCampo# = #maempr21#3;

     nCampo            = nCampo + 1;
     #isoh1524#nCampo# = #maempr21#4;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#5;  |HAZ Calcula17D;
     #isoh1524#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#6;  |HAZ Calcula17D;
     #isoh1524#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#7;  |HAZ Calcula17D;
     #isoh1524#nCampo# = eaAlfa;

     nCampo            = nCampo + 1;
     enCanti           = #maempr21#8;  |HAZ Calcula17D;
     #isoh1524#nCampo# = eaAlfa;

     |GRABA 020#isoh1524.a;
     |LIBERA #isoh1524;
|FPRC;

|DEFBUCLE maempr21;
     #maempr21#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, maempr21;
|FIN;

|PROCESO isoh1524;
     |PARA nCampo = 1;  |SI nCampo [ 180;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh1524#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh1524;
     #isoh1524#1;
     ;
     01;
     99;
     ;
     NULL, isoh1524;
|FIN;

|PROCESO Hoja24;
     |SI #isoh1501#25 = "0";  |Y #isoh1501#26 = "0";
         |ACABA;
     |FINSI;

     aDelindex = ("h5" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh1524#aDelindex#;
     |ABRE #isoh1524; |CIERRA #isoh1524; |DELINDEX #isoh1524;

     |ABRE #isoh1524;
     |DDEFECTO #isoh1524;

     #isoh1524#0  = 1;

     enCanti  = #isom0000#29;  |HAZ Calcula3E4D;  #isoh1524#6  = eaAlfa;

     eaCasilla = "500";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1524#7  = eaAlfa;

     eaCasilla = "1227";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1524#8  = eaAlfa;

     eaCasilla = "1228";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1524#9  = eaAlfa;

     eaCasilla = "552";   |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1524#10 = eaAlfa;

     eaCasilla = "1330";   |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;    #isoh1524#11 = eaAlfa;

     enCanti  = #isom0000#44;  |HAZ Calcula17D;   #isoh1524#12 = eaAlfa;
     enCanti  = #isom0000#45;  |HAZ Calcula3E2D;  #isoh1524#13 = eaAlfa;
     enCanti  = #isom0000#46;  |HAZ Calcula17D;   #isoh1524#14 = eaAlfa;
     enCanti  = #isom0000#47;  |HAZ Calcula3E2D;  #isoh1524#15 = eaAlfa;
     enCanti  = #isom0000#48;  |HAZ Calcula17D;   #isoh1524#16 = eaAlfa;
     enCanti  = #isom0000#49;  |HAZ Calcula3E2D;  #isoh1524#17 = eaAlfa;
     enCanti  = #isom0000#50;  |HAZ Calcula17D;   #isoh1524#18 = eaAlfa;
     enCanti  = #isom0000#51;  |HAZ Calcula3E2D;  #isoh1524#19 = eaAlfa;
     enCanti  = #isom0000#52;  |HAZ Calcula17D;   #isoh1524#20 = eaAlfa;
     enCanti  = #isom0000#53;  |HAZ Calcula17D;   #isoh1524#21 = eaAlfa;
     enCanti  = #isom0000#54;  |HAZ Calcula17D;   #isoh1524#22 = eaAlfa;
     enCanti  = #isom0000#55;  |HAZ Calcula17D;   #isoh1524#23 = eaAlfa;
     enCanti  = #isom0000#56;  |HAZ Calcula17D;   #isoh1524#24 = eaAlfa;
     enCanti  = #isom0000#57;  |HAZ Calcula17D;   #isoh1524#25 = eaAlfa;

     #isoh1524#3   = "240";
     #isoh1524#180 = "</T200240>";

     |GRABA 020#isoh1524.n;
     |LIBERA #isoh1524;

     nContaBucle = 0;    |BUCLE maempr05;
     nContaBucle = 0;    |BUCLE maempr21;

     |CIERRA #isoh1524;

     |BUCLE isoh1524;

     |ABRE #isoh1524; |CIERRA #isoh1524; |DELINDEX #isoh1524;
|FPRC;

|PROCESO maempr13;
     nContaBucleL  = nContaBucleL + 1;

     |SI nContaBucleL ] 6;
         |ERROR10;
         |ACABA;
     |FINSI;

     nCampo = ((((nContaBucle + 5) - (6 * #isoh0923#0)) * 9) + 9) + nContaBucleL;

     #isoh0923#nCampo# = #maempr13#4;
|FPRC;

|DEFBUCLE maempr13;
     #maempr13#1;
     ;
     #maempr12#0, #maempr12#1, #maempr12#2, 00;
     #maempr12#0, #maempr12#1, #maempr12#2, 99;
     ;
     NULL, maempr13;
|FIN;

|PROCESO maempr12;
     nContaBucle  = nContaBucle + 1;
     #isoh0923#0       = ((nContaBucle / 6) + .49) ! 0;

     |LEE 101#isoh0923.=;
     |SI FSalida ! 0;
         |DDEFECTO #isoh0923;
         #isoh0923#0 = ((nContaBucle / 6) + .49) ! 0;

                               #isoh0923#5 = "";
         |SI #isoh0923#0 ! 1;  #isoh0923#5 = "C";  nComple = 1;  |FINSI;

         nTotal = 0;

         #isoh0923#3  = "250";
         #isoh0923#61 = "</T200250>";

         |GRABA 020#isoh0923.b;
     |FINSI;

     nCampo     = (((nContaBucle + 5) - (6 * #isoh0923#0)) * 9) + 6;
     #isoh0923#nCampo# = #maempr12#3;

     nCampo     = nCampo + 1;
     #isoh0923#nCampo# = #maempr12#4;

     nCampo     = nCampo + 1;
     aPais        = #maempr12#5 % 102;
     #isoh0923#nCampo# = aPais;

     nCampo     = nCampo + 1;
     enCanti      = #maempr12#6;
     |HAZ Calcula17D;
     #isoh0923#nCampo# = eaAlfa;

     nTotal       = nTotal + #maempr12#6;

     enCanti      = nTotal;
     |HAZ Calcula17D;
     #isoh0923#60      = eaAlfa;

     nContaBucleL = 0;  |BUCLE maempr13;

     |GRABA 020#isoh0923.a;
     |LIBERA #isoh0923;
|FPRC;

|DEFBUCLE maempr12;
     #maempr12#1;
     ;
     #maempr10#0, #maempr10#1, 00;
     #maempr10#0, #maempr10#1, 99;
     ;
     NULL, maempr12;
|FIN;

|PROCESO isoh0923;
     |PARA nCampo = 1;  |SI nCampo [ 61;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #isoh0923#nCampo#;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0923;
     #isoh0923#1;
     ;
     01;
     99;
     ;
     NULL, isoh0923;
|FIN;

|PROCESO Hoja25;
     nHay = 0;

     |ABRE #maempr12;
     #maempr12#0 = #maempr10#0;
     #maempr12#1 = #maempr10#1;
     #maempr12#2 = 1;
     |LEE 000#maempr12.];
     |SI FSalida = 0;  |Y  #maempr12#0 = #maempr10#0;  |Y #maempr12#1 = #maempr10#1;
         nHay = 1;
     |FINSI;
     |CIERRA #maempr12;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h6" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #isoh0923#aDelindex#;
     |ABRE #isoh0923; |CIERRA #isoh0923; |DELINDEX #isoh0923;

     |ABRE #isoh0923;

     |DDEFECTO #isoh0923;
     #isoh0923#0   = 1;
     #isoh0923#5   = "";
     nTotal        = 0;

     #isoh0923#3  = "250";
     #isoh0923#61 = "</T200250>";

     |GRABA 020#isoh0923.n;

     nContaBucle = 0;   |BUCLE maempr12;

     |CIERRA #isoh0923;

     |BUCLE isoh0923;

     |ABRE #isoh0923; |CIERRA #isoh0923; |DELINDEX #isoh0923;
|FPRC;

|PROCESO CalculaCas;
     nCanti1 = ((nValor * nValor626) / nTotal) ! 2;
     nCanti2 = ((nValor * nValor627) / nTotal) ! 2;
     nCanti3 = ((nValor * nValor628) / nTotal) ! 2;
     nCanti4 = ((nValor * nValor629) / nTotal) ! 2;
     nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
     nResto  = nValor - nCantiT;

     |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

     enCanti = nCanti1;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti2;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti3;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti4;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti1 + nCanti2 + nCanti3 + nCanti4;
                         |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja26;
     |SI #isoh1501#44 = "0";
         |ACABA;
     |FINSI;

     eaAlfa    = "<T200260> ";  |HAZ GrabaSecuencial;

     eaCasilla = "050";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "051";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "052";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "053";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "054";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "055";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla = "056";  |HAZ LeeFich101;
     enCanti   = #isom0001#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaCasilla  = "626";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor626  = #isom0001#5;

     eaCasilla  = "627";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor627  = #isom0001#5;

     eaCasilla  = "628";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor628  = #isom0001#5;

     eaCasilla  = "629";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor629  = #isom0001#5;

     eaCasilla  = "625";  |HAZ LeeFich101;
     enCanti    = #isom0001#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;

     nTotal     = nValor626 + nValor627 + nValor628 + nValor629;

     eaCasilla  = "600";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "602";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "604";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "606";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "612";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "616";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "642";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "618";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "620";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1332"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1333"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "622";  |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1043"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;
     eaCasilla  = "1044"; |HAZ LeeFich101;  nValor = #isom0001#5; |HAZ CalculaCas;

     eaAlfa = "</T200260>";    |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;
