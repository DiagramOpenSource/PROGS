|FICHEROS;
     zhazdocu;
     zregdocu;

     zhazcrea;
     maempr01;

     megwordc;
     megwordl;

     cubal801;

     :/basica/def/agicen14;
     :/basica/def/agim0019;
     :/basica/def/agim0049;

     imagen@;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAbreTxt         = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aIPRemoto        = "";
     aCuenta          = "";
     aAste            = "";
     aLong            = "";
     aCuentaD         = "";
     aCuentaH         = "";
     aHora            = "";
     aPag             = "";
     aPag1            = "";
     aPag2            = "";
     aTipoMemoria     = "";
     aTipo            = "";
     aIdioma          = "";

     aCarac10         = "";
     aCarac13         = "";
     aQueQuiero       = "";
     &aCNAE           = "";
     &nSwPaseAnt      = 0;

     nLong            = 0;
     nSubPanta        = 0;
     nVentana         = 0;
     nNume            = 0;
     nNume1           = 0;
     nNume2           = 0;
     nNume3           = 0;
     nNume4           = 0;
     nRango           = 0;
     nBotonSal        = 0;
     nImporte         = 0;
     nCta4            = 0;
     nCta6            = 0;
     nEjer            = 0;
     nCampo1          = 0;
     nCampo2          = 0;
     nCampo3          = 0;
     nCampo4          = 0;

     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nConta           = 0;
     nTributa         = 0;
     nCasilla         = 0;
     nCuadro          = 0;
     nHay             = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &enPersonaliza   = 0;
     &eaUnidadBasico  = "";
     &enCuadros       = 0;
     &enMensa         = 0;
     &enTBal          = 0;
     &eaPag1          = "";
     &eaPag2          = "";
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;

     &EURODB          = 0;
     any              = 0;
     aCondi           = "";
     aSigno           = "";
     aFichero         = "";
     aMas             = "";
     aDef             = "";
     nEstado900       = 0;
     nSw              = 0;

     &enEmpresa       = 0;
     &enEjerCuadro    = 0;
|FIN;

|PROCESO DesImagen_memor;
    |SI aDef = "";  |ACABA;  |FINSI;

    |CIERRA #imagen@;
    |DESCARGA_DEF #imagen@; aDef = "";
|FPRC;

|PROCESO CarImagen_memor;
     |HAZ DesImagen_memor;

     |DBASE aMas;
     aDef = aMas + "def/" + aFichero;
     |CARGA_DEF aDef, imagen@;
     |SI FSalida ! 0;
         aDef = "";
         |ACABA;
     |FINSI;

     |SI aFichero = "zregcu04";   |ACABA;   |FINSI;

     |ABRE #imagen@;
     #imagen@#0 = #zhazcrea#0;
     #imagen@#1 = nEjer;
     |LEE 000#imagen@.=;
     nEstado900 = FSalida;
|FPRC;

|PROCESO CargaVarDistr;
     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #zregdocu#nCampo#;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 21;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #zregdocu#nCampo#;
           nVar    = nCampo - 20;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |SI #zhazcrea#1 [ 2008;  |ACABA;  |FINSI;

     aDef     = "";
     aFichero = "zregdocu";
     |HAZ CarImagen_memor;

     |ABRE #imagen@;
     #imagen@#0 = #zhazcrea#0;
     #imagen@#1 = #zhazcrea#1 - 1;
     |LEE 040#imagen@.=;
     |SI FSalida ! 0;  |DDEFECTO #imagen@;  |FINSI;

     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #imagen@#nCampo#;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 21;  |SI nCampo [ 29;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #imagen@#nCampo#;
           nVar    = nCampo - 20;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |HAZ DesImagen_memor;
|FPRC;

|PROCESO CargaVarDistrCoop;
     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #zregdocu#nCampo#;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 70;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #zregdocu#nCampo#;
           nVar    = nCampo - 69;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     aDef     = "";
     aFichero = "zregdocu";
     |HAZ CarImagen_memor;

     |ABRE #imagen@;
     #imagen@#0 = #zhazcrea#0;
     #imagen@#1 = #zhazcrea#1 - 1;
     |LEE 040#imagen@.=;
     |SI FSalida ! 0;  |DDEFECTO #imagen@;  |FINSI;

     enSwTrata = 1;
     |PARA nCampo = 16;  |SI nCampo [ 20;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #imagen@#nCampo#;
           nVar    = nCampo - 15;
           |HAZ SeparaImporte;
           eaAsigna = "V#reparto" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |PARA nCampo = 70;  |SI nCampo [ 78;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #imagen@#nCampo#;
           nVar    = nCampo - 69;
           |HAZ SeparaImporte;
           eaAsigna = "V#aplicacion" + nVar + "A#";
           eaConten = eaImporte;  |QBT eaConten;
           |HAZ GrabaContenido;
     |SIGUE;

     |HAZ DesImagen_memor;
|FPRC;

|PROCESO CargaVarMemoriaPYME;
     |HAZ CargaVarDistr;
     |HAZ Carga_zregcu01;
     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu02;
     |FINSI;

     |HAZ Carga_zregcu03;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu04;
         |HAZ Carga_zregcu05;
     |FINSI;

     |HAZ Carga_zregcu06;
     |HAZ Carga_zregcu07;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu24;
     |FINSI;

     |HAZ Carga_zregcu08;
     |HAZ Carga_zregcu09;
     |HAZ Carga_zregcu10;
     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu11;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;
     |HAZ Carga_zregcu12;
     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu28;

     |SI #zhazcrea#1 = 2008;
         |ABRE #cubal801;
         |SELECT #3#cubal801;
         #cubal801#0  = #zhazcrea#0;
         #cubal801#1  = #zhazcrea#1;
         #cubal801#16 = 30000;
         |LEE 000#cubal801.=;
         |SI FSalida ! 0;  |DDEFECTO #cubal801;  |FINSI;
         |CIERRA #cubal801;

         eaConten = "[B]";
         |SI #cubal801#6 ! 0;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}2}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}2}1}+A"; |HAZ GrabaContenido;
         |SINO;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}1}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}1}1}+A"; |HAZ GrabaContenido;
         |FINSI;

         |ACABA;
     |FINSI;

     |HAZ Carga_zregcu14;

     |SI #zhazcrea#1 ] 2010;
         |SI #zhazcrea#1 [ 2014;
             |HAZ Carga_zregcu15;
         |SINO;
             |HAZ Carga_zregcu29;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaVarMemoriaAbrev;
     |HAZ CargaVarDistr;
     |HAZ Carga_zregcu01;
     |HAZ Carga_zregcu16;
     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu17;
         |HAZ Carga_zregcu18;
     |FINSI;
     |HAZ Carga_zregcu03;

     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu19;
     |FINSI;

     |HAZ Carga_zregcu06;

     |SI #zhazcrea#1 [ 2014;
         |HAZ Carga_zregcu15;
     |SINO;
         |SI #zhazcrea#1 [ 2017;
             |HAZ Carga_zregcu29;
         |FINSI;
     |FINSI;

     |HAZ Carga_zregcu07;
     |SI #zhazcrea#1 < 2018;
         |HAZ Carga_zregcu24;
     |FINSI;
     |HAZ Carga_zregcu20;
     |HAZ Carga_zregcu21;
     |HAZ Carga_zregcu22;

     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu23;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;

     |SI #zhazcrea#1 [ 2017;
         |HAZ Carga_zregcu12;
     |FINSI;

     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu14;
     |HAZ Carga_zregcu28;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO CargaVarMemoriaCooper;
     |HAZ CargaVarDistrCoop;
     |HAZ Carga_zregcu01;
     |HAZ Carga_zregcu02;
     |HAZ Carga_zregcu03;
     |HAZ Carga_zregcu04;
     |HAZ Carga_zregcu05;
     |HAZ Carga_zregcu06;
     |HAZ Carga_zregcu26;
     |HAZ Carga_zregcu25;
     |HAZ Carga_zregcu07;
     |HAZ Carga_zregcu24;
     |HAZ Carga_zregcu08;
     |HAZ Carga_zregcu27;
     |HAZ Carga_zregcu09;
     |HAZ Carga_zregcu10;
     |SI #zhazcrea#1 [ 2016;
         |HAZ Carga_zregcu11;
     |SINO;
         |HAZ Carga_zregcu31;
     |FINSI;
     |HAZ Carga_zregcu12;
     |HAZ Carga_zregcu13;
     |HAZ Carga_zregcu28;

     |SI #zhazcrea#1 ] 2018;
         |HAZ Carga_zregcu32;
         |HAZ Carga_zregcu33;
     |SINO;
         |HAZ Carga_zregcu17;
         |HAZ Carga_zregcu18;
     |FINSI;
     |SI #zhazcrea#1 = 2008;
         |ABRE #cubal801;
         |SELECT #3#cubal801;
         #cubal801#0  = #zhazcrea#0;
         #cubal801#1  = #zhazcrea#1;
         #cubal801#16 = 30000;
         |LEE 000#cubal801.=;
         |SI FSalida ! 0;  |DDEFECTO #cubal801;  |FINSI;
         |CIERRA #cubal801;

         eaConten = "[B]";
         |SI #cubal801#6 ! 0;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}2}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}2}1}+A"; |HAZ GrabaContenido;
         |SINO;
             eaAsigna = "T}4}3}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}4}1}1}+A"; |HAZ GrabaContenido;
             eaAsigna = "T}5}1}1}+A"; |HAZ GrabaContenido;
         |FINSI;

         |ACABA;
     |FINSI;

     |HAZ Carga_zregcu14;

     |SI #zhazcrea#1 [ 2014;
         |HAZ Carga_zregcu15;
     |SINO;
         |HAZ Carga_zregcu29;
     |FINSI;

     |SI #zhazcrea#1 ] 2016;
         |HAZ Carga_zregcu30;
     |FINSI;

     |SI #zhazcrea#1 < 2017;
         |SI enTBal ! 1;
             eaConten = "";
             eaAsigna = "T}4}1}1}+B"; |HAZ GrabaContenido;
         |SINO;
            eaConten = "";
            eaAsigna = "T}5}1}1}+B"; |HAZ GrabaContenido;
         |FINSI;
    |FINSI;
|FPRC;

|PROCESO agicen14;
     |SI #agicen14#6 ! "01.01.0000";  |ACABA;  |FINSI;

     |SI nConta = 1;
         |SI #agicen14#5 = nTributa;  |ACABA;  |FINSI;
     |FINSI;

     nConta = nConta + 1;
     |SI nConta = 1;
         aCNAE  = #agicen14#20;     |HAZ eLeeCNAE;
         |SI aCNAE = "";
             aCNAE  = #agicen14#4;  |QBF aCNAE;
         |FINSI;

         eaAlfa = #agicen14#20 + " - " + aCNAE;    |QBF eaAlfa;
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#actividad 1#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;
     |FINSI;

     |SI nConta = 2;
         aCNAE  = #agicen14#20;     |HAZ eLeeCNAE;
         |SI aCNAE = "";
             aCNAE  = #agicen14#4;  |QBF aCNAE;
         |FINSI;

         eaAlfa = #agicen14#20 + " - " + aCNAE;    |QBF eaAlfa;
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#actividad 2#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;
     |FINSI;

     nTributa = #agicen14#5;
|FPRC;

|DEFBUCLE agicen14;
     #agicen14#1;
     ;
     #zhazcrea#0, 00;
     #zhazcrea#0, 99;
     ;
     NULL, agicen14;
|FIN;

|PROCESO agim0049;
     eaAlfa = #agim0049#3;  |HAZ QuitaRarosDSXML;
     |XGRABA nHandle, eaAlfa;

     eaAlfa = " ";
     |XGRABA nHandle, eaAlfa;
|FPRC;

|DEFBUCLE agim0049;
     #agim0049#1;
     ;
     #agim0019#0, #agim0019#1, 1;
     #agim0019#0, #agim0019#1, 6;
     ;
     NULL, agim0049;
|FIN;

|PROCESO ObjetoSocial;
     aAbreTxt = eaDirTrabajo + "objetosocial.txt";

     eaAsigna  = "T}3}1}1}+A";
     eaConten  = "[M]" + aAbreTxt + " [F]Arial [S]10 [A]0 [L]3";
     |HAZ GrabaContenido;

     |XABRE "WBC", aAbreTxt, nHandle;
     |BUCLE agim0049;
     |XCIERRA nHandle;
|FPRC;

|PROCESO CargaVarMemoria;
     |ABRE #maempr01;
     #maempr01#0 = #zhazcrea#0;
     #maempr01#1 = #zhazcrea#1;
     |LEE 040#maempr01.=;
     |SI FSalida ! 0;  |DDEFECTO #maempr01;  |FINSI;
     |CIERRA #maempr01;

     |SI #maempr01#33 ! "          ";
         eaAlfa = #maempr01#33;
         |HAZ SacaFecha;
         #zregdocu#40 = eaAlfa;
     |SINO;
         nNume  = #zhazcrea#1 + 1;
         #zregdocu#40  = "30 de Marzo de " + nNume;
     |FINSI;

     eaAsigna   = "P" + #zhazcrea#7;
     eaConten   = eaDirTrabajo + "paginas.txt";
     |HAZ GrabaContenido;

     nNume  = #zhazcrea#1 - 1;

     eaAsigna = "V#ante#";
     eaConten = nNume;
     |HAZ GrabaContenido;

     eaAsigna = "V#actu#";
     eaConten = #zhazcrea#1;
     |HAZ GrabaContenido;

     eaAsigna = "C#ejercicio#";
     |HAZ GrabaContenido;

     eaAlfa   = #zregdocu#40;  |HAZ QuitaRarosDSXML;
     eaAsigna = "V#fecha formulacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zhazcrea#12;       |HAZ QuitaRarosDSXML;
     eaAsigna = "V#pgc#";
     eaConten = eaAlfa;;
     |HAZ GrabaContenido;

     eaAlfa   = #zhazcrea#2;       |HAZ QuitaRarosDSXML;
     eaAsigna = "C#empresa#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa  = #maempr01#3;                               |HAZ QuitaRarosDSXML;
     eaAsigna = "V#CIF#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #maempr01#13;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#poblacion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #maempr01#14;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#provincia#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #maempr01#4;                              |QBF eaAlfa;
     eaAlfa   = eaAlfa + " " + #maempr01#5;               |QBF eaAlfa;
     eaAlfa   = eaAlfa + ", n. " + #maempr01#6;           |HAZ QuitaRarosDSXML;
     eaAsigna = "V#domicilio social#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |ABRE #agim0019;
     #agim0019#0 = #zhazcrea#0;
     #agim0019#1 = 99;
     |LEE 040#agim0019.];
     |SI FSalida = 0;
         |LEE 040#agim0019.a;
     |SINO;
         |LEE 040#agim0019.u;
     |FINSI;
     |SI FSalida ! 0;  |O #agim0019#0 ! #zhazcrea#0;
         |DDEFECTO #agim0019;
     |FINSI;
     |CIERRA #agim0019;

     nConta = 0;  |BUCLE agicen14;
     |SI nConta = 0;
         aCNAE  = #agim0019#40;     |HAZ eLeeCNAE;
         |SI aCNAE = "";
             aCNAE  = #agim0019#2;  |QBF aCNAE;
         |FINSI;

         eaAlfa = #agim0019#40 + " - " + aCNAE;    |QBF eaAlfa;
         |HAZ QuitaRarosDSXML;
         eaAsigna = "V#actividad 1#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;

         eaAlfa   = "";
         eaAsigna = "V#actividad 2#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;

         eaAsigna = "V#cnae 2#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;
     |FINSI;

     |SI nConta = 1;
         eaAlfa   = "";
         eaAsigna = "V#actividad 2#";
         eaConten = eaAlfa;
         |HAZ GrabaContenido;
     |FINSI;

     eaAlfa   = #agim0019#5;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tipo sociedad#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#25;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#registro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#28;
     eaAsigna = "V#fecha inscripcion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#29;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#tomo#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#30;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#libro#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#31;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#seccion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#32;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#folio#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#33;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#hoja#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#34;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#59;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#60;
     eaAsigna = "V#fecha inscripcion coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#61;
     eaAsigna = "V#aportacion minima coop#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#8;                |HAZ QuitaRarosDSXML;
     eaAsigna = "V#notario#";
     eaConten = eaAlfa;                     || nuevos campos 2017
     |HAZ GrabaContenido;

     eaAlfa   = #agim0019#11;
     eaAsigna = "V#fecha constitucion#";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |HAZ ObjetoSocial;

     nNume1 = #agim0019#14;
     nNume2 = #agim0019#16;
     nNume3 = #agim0019#20;
     nNume4 = #agim0019#24;

     |SI EURODB = 0;  |Y #agim0019#51 = "E";
         nNume1  = (#agim0019#14 * 166.386) ! EURODB;
         nNume2  = (#agim0019#16 * 166.386) ! EURODB;
         nNume3  = (#agim0019#20 * 166.386) ! EURODB;
         nNume4  = (#agim0019#24 * 166.386) ! EURODB;
     |FINSI;

     |SI EURODB ! 0;  |Y #agim0019#51 = "P";
         nNume1  = (#agim0019#14 / 166.386) ! EURODB;
         nNume2  = (#agim0019#16 / 166.386) ! EURODB;
         nNume3  = (#agim0019#20 / 166.386) ! EURODB;
         nNume4  = (#agim0019#24 / 166.386) ! EURODB;
     |FINSI;

     eaAsigna = "V#capital social#";
     eaConten = nNume1 + " euros";
     |HAZ GrabaContenido;

     aAlfa1 = "";
     aAlfa2 = "";
     |SI #agim0019#15 ! 0;
         aAlfa1 = #agim0019#15 + " acciones nominativas";
         aAlfa2 = nNume2;
     |FINSI;

     |SI #agim0019#19 ! 0;
         |SI aAlfa1 = "";
             aAlfa1 = #agim0019#19 + " acciones al portador";
             aAlfa2 = nNume3;
         |SINO;
             |SI #agim0019#23 ! 0;
                 aAlfa1 = aAlfa1 + ", " + #agim0019#19 + " acciones al portador";
                 aAlfa2 = aAlfa2 + ", " + nNume3;
             |SINO;
                 aAlfa1 = aAlfa1 + " y " + #agim0019#19 + " acciones al portador";
                 aAlfa2 = aAlfa2 + " y " + nNume3;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #agim0019#23 ! 0;
         |SI aAlfa1 = "";
             aAlfa1 = #agim0019#23 + " participaciones socios";
             aAlfa2 = nNume4;
         |SINO;
             aAlfa1 = aAlfa1 + " y " + #agim0019#23 + " participaciones socios";
             aAlfa2 = aAlfa2 + " y " + nNume4;
         |FINSI;
     |FINSI;

     eaAsigna = "V#literalacciones#";
     eaConten = aAlfa1;
     |HAZ GrabaContenido;

     eaAsigna = "V#nominal#";
     eaConten = aAlfa2 + " euros";
     |HAZ GrabaContenido;

     |SI #zhazcrea#15 = "P";  |HAZ CargaVarMemoriaPYME;   |FINSI;
     |SI #zhazcrea#15 = "A";  |HAZ CargaVarMemoriaAbrev;  |FINSI;
     |SI #zhazcrea#15 = "C";  |HAZ CargaVarMemoriaCooper; |FINSI;
|FPRC;

|PROCESO CreaMemoria;
     |SI enMensa = 0;
         |SI #zregdocu#4 = "S";
             |CONFI "0000NLa memoria ya est  creada, desea crearla de nuevo";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;

         |PINTA #zhazcrea#7;
     |FINSI;

     |HAZ VentanaTrabajo;

     |SI #zhazdocu#0 = 2008;  eaPlanillaTra  = "memor001.doc";  |FINSI;
     |SI #zhazdocu#0 = 2009;  eaPlanillaTra  = "memo2009.doc";  |FINSI;
     |SI #zhazdocu#0 ] 2010;
          aIdioma = "m";
          |SI #zhazdocu#0 ] 2018; |Y #zhazcrea#15 ! "C";
              aIdioma = #zhazcrea#18 < "";
              |SI aIdioma = " "; aIdioma = "m"; |FINSI;
          |FINSI;
          |SI #zhazcrea#15 = "P";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

              eaPlanillaTra  = "me" + aIdioma + nEjer + "p.doc";
          |FINSI;

          |SI #zhazcrea#15 = "A";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

              eaPlanillaTra  = "me" + aIdioma + nEjer + "a.doc";
          |FINSI;

          |SI #zhazcrea#15 = "C";
              nEjer = #zhazdocu#0;
              |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

              eaPlanillaTra  = "me" + aIdioma + nEjer + "c.doc";
          |FINSI;
     |FINSI;

     |DBASE aBase;
     aAlfa = aBase + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/" + eaPlanillaTra;
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #zhazcrea#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #zhazcrea#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "";

     eaOrigen       = eaDirSerDoc  + eaPlanillaTra;
     eaDestino      = eaDirTrabajo + eaFicheroPla;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroPla;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |SI enMensa = 0;
             aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
             |MENAV aAlfa;
         |FINSI;

         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroPla + "#" + eaDirTrabajo + eaFicheroTra + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[LIMPIA FINAL]" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;

     |SI aIPRemoto = "192.168.10.42";
         aAlfa = "[ERROR]" + &13 + &10;
         |XGRABA enHandleTxt, aAlfa;
     |FINSI;

     |HAZ CargaVarMemoria;

     |XCIERRA enHandleTxt;

     eaOrigen  = eaDirTrabServi + eaFicheroTxt;
     eaDestino = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     aAlfa = eaDirTrabServi + eaFicheroTxt;
     |FBORRA aAlfa;

     |HAZ AbreWordExterno;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + "wmemori.doc";
     |HAZ RecibeFichero;

     |RFBORRA aAbre;

     aAbre = eaDirGuarda + "wmemori.doc";
     |XABRE "E", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aCarac10 = &10;
     aCarac13 = &13;
     aPag     = "";
     aPag1    = "";
     aPag2    = "";

     aAbre = eaDirTrabajo + "paginas.txt";
     |XABRE "ABC", aAbre, nHandle;
     |PARA;  |SI  FSalida ] 0;  |HACIENDO;
          |XLEE nHandle, 1, aAlfa;
          |SI FSalida [ 0;  |SAL;  |FINSI;

          |SI aAlfa = aCarac10;  |O aAlfa = aCarac13;
              |SI aPag ! "";
                  |SI aPag1 = "";
                      aPag1 = aPag;
                  |SINO;
                      aPag2 = aPag;
                  |FINSI;
              |FINSI;
              aPag = "";
          |SINO;
              aPag = aPag + aAlfa;
         |FINSI;
     |SIGUE;
     |XCIERRA nHandle;

     |RFBORRA aAbre;

     aAlfa = eaDirTrabajo + "objetosocial.txt";
     |RFBORRA aAlfa;

     #zregdocu#4  = "S";
     #zregdocu#5  = aPag1;
     #zregdocu#6  = aPag2;
     #zregdocu#7  = #zhazcrea#6;

     |SI #zregdocu#8 = "N";
         #zregdocu#9 = #zregdocu#6 + 1;
         #zhazcrea#8 = #zregdocu#9;
     |FINSI;

     |SI #zregdocu#8 = "S";
         nNume = #zregdocu#6 + 1;
         |SI nNume ! #zregdocu#9;
             |SI enMensa = 0;
                 |CONFI "0000NEl n£mero de P ginas de la Memoria ha cambiado. Desea Renumerar el Informe de Gestion";
                 |SI FSalida = 0;
                     |HAZ RenumerarGestion;
                 |FINSI;
             |SINO;
                 |HAZ RenumerarGestion;
             |FINSI;
         |FINSI;
     |FINSI;

     |ABRE #megwordc;
     #megwordc#0 = #zregdocu#0;
     #megwordc#1 = #zregdocu#1;
     |LEE 101#megwordc.=;
     |SI FSalida ! 0;
         |DDEFECTO #megwordc;
         #megwordc#0 = #zregdocu#0;
         #megwordc#1 = #zregdocu#1;
         |GRABA 020#megwordc.b;
     |FINSI;

     #megwordc#2 = #zregdocu#2;
     #megwordc#3 = #zregdocu#5;
     #megwordc#4 = #zregdocu#6;
     #megwordc#5 = #zregdocu#9;
     #megwordc#6 = #zregdocu#10;

     |GRABA 020#megwordc.a;
     |LIBERA #megwordc;
     |CIERRA #megwordc;

     |ABRE #megwordl;
     #megwordl#0 = #zregdocu#0;
     #megwordl#1 = #zregdocu#1;
     #megwordl#2 = "wmemori.doc";
     |LEE 101#megwordl.=;
     |SI FSalida ! 0;
         |DDEFECTO #megwordl;
         #megwordl#0 = #zregdocu#0;
         #megwordl#1 = #zregdocu#1;
         #megwordl#2 = "wmemori.doc";
         |GRABA 020#megwordl.b;
     |FINSI;

     #megwordl#3 = "MEMORIA";
     #megwordl#4 = ~;
     |HORA aHora;
     #megwordl#5 = aHora % 102;
     #megwordl#6 = aHora % 402;

     |GRABA 020#megwordl.a;
     |LIBERA #megwordl;
     |CIERRA #megwordl;

     |HAZ FinVentanaTrabajo;

     |SI enMensa = 0;
         |MENAV "0000La memoria ha sido creada.";
         |PINTA #zhazcrea#8;
     |FINSI;

     |SI #zregdocu#11 = "S";
         nNume = #zregdocu#39;
         |SI #zregdocu#6  ! 0;  nNume = #zregdocu#6;   |FINSI;
         |SI #zregdocu#10 ! 0;  nNume = #zregdocu#10;  |FINSI;
         |SI nNume ! #zregdocu#39;  |Y enMensa = 1;
             |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO VisualizaMemoria;
     |PINTA #zhazcrea#7;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #zhazcrea#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #zhazcrea#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaPag1 = ""; |SI #zhazcrea#7 ! #zregdocu#5;  eaPag1 = #zhazcrea#7; |FINSI;
     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     eaPag1 = #zhazcrea#7;
     |HAZ QuentaPagDocumento;

     #zregdocu#5  = eaPag1;
     #zregdocu#6  = eaPag2;
     |SI #zregdocu#8 = "N";
         #zregdocu#9 = #zregdocu#6 + 1;
         #zhazcrea#8 = #zregdocu#9;
         |PINTA #zhazcrea#8;
     |FINSI;
     |SI #zregdocu#8 = "S";
         nNume = #zregdocu#6 + 1;
         |SI nNume ! #zregdocu#9;
             |CONFI "0000NEl n£mero de P ginas de la Memoria ha cambiado. Desea Renumerar el Informe de Gestion";
             |SI FSalida = 0;
                 |HAZ RenumerarGestion;
             |FINSI;
         |FINSI;
     |FINSI;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |RFBORRA aAbre;

     eaPag1 = "";
     eaPag2 = "";

     |HAZ FinVentanaTrabajo;

     |SI #zregdocu#11 = "S";
         nNume = #zregdocu#39;
         |SI #zregdocu#6  ! 0;  nNume = #zregdocu#6;   |FINSI;
         |SI #zregdocu#10 ! 0;  nNume = #zregdocu#10;  |FINSI;
         |SI nNume ! #zregdocu#39;
             |MENAV "0000Se ha modificado el total de p ginas de las Cuentas Anuales. Modifique el Certificado";
         |FINSI;
     |FINSI;

     |PULSATECLA;
|FPRC;

|PROCESO MemoriaPDF;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";      |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wmemori.txt";
     eaFicheroTra   = "wmemori.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #zhazcrea#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #zhazcrea#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "I#zhazcrea#dspdf#2";

     |HAZ InstalaDSPDF;

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAbre = eaDirTrabServi + eaFicheroTxt;
     |XABRE "WB", aAbre, enHandleTxt;

     aAlfa = "[FICHERO]#" + eaDirTrabajo + eaFicheroTra + "#" + eaDirTrabajo + "MEMORIA.DOC" + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     aAlfa = "[IMPRESORA]#" + eaModoPresenta + &13 + &10;
     |XGRABA enHandleTxt, aAlfa;

     |XCIERRA enHandleTxt;

     eaOrigen       = eaDirTrabServi + eaFicheroTxt;
     eaDestino      = eaDirTrabajo   + eaFicheroTxt;
     |HAZ EnviaFicheroSinMD5;

     |FBORRA eaOrigen;

     |HAZ AbreWordExterno;

     |HAZ FinVentanaTrabajo;

     aAlfa = eaDirTrabajo + eaFicheroTra;   |RFBORRA aAlfa;
     aAlfa = eaDirTrabajo + "MEMORIA.DOC";  |RFBORRA aAlfa;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronPYME;
     |SI #zhazdocu#0 > enUltMemP;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     |SI #zhazdocu#0 = 2008;
         eaFicheroTxt   = "memor001.txt";
         eaFicheroTra   = "memor001.doc";
     |FINSI;

     |SI #zhazdocu#0 = 2009;
         eaFicheroTxt   = "memo2009.txt";
         eaFicheroTra   = "memo2009.doc";
     |FINSI;

     aIdioma = #zhazcrea#18 < " ";
     |SI aIdioma = " "; aIdioma = "m"; |FINSI;

     |SI #zhazdocu#0 ] 2010;
         nEjer = #zhazdocu#0;
         |SI nEjer > enUltMemP; nEjer = enUltMemP; |FINSI;

         eaFicheroTxt   = "me" + aIdioma + nEjer + "p.txt";
         eaFicheroTra   = "me" + aIdioma + nEjer + "p.doc";
     |FINSI;

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronAbreviada;
     |SI #zhazdocu#0 > enUltMemA;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltMemA; nEjer = enUltMemA; |FINSI;

     aIdioma = #zhazcrea#18 < " ";
     |SI aIdioma = " "; aIdioma = "m"; |FINSI;

     eaFicheroTxt   = "me" + aIdioma + nEjer + "a.txt";
     eaFicheroTra   = "me" + aIdioma + nEjer + "a.doc";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO EditaMemoPatronCooperativa;
     |SI #zhazdocu#0 > enUltMemC;
         aAlfa = "    Patrones del ejercicio " + #zhazdocu#0 + ". Modifiquelos por la entrada de ese año"
         |MENAV aAlfa;
         |ACABA;
     |FINSI;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     |SI enPersonaliza = 0;
         eaDirSerDoc    = aBase  + "word/memoria/";
         eaDirGuarda    = aBase  + "word/memoria/";
     |SINO;
         eaDirSerDoc    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
         eaDirGuarda    = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
     |FINSI;

     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     nEjer = #zhazdocu#0;
     |SI nEjer > enUltMemC; nEjer = enUltMemC; |FINSI;

     eaFicheroTxt   = "mem" + nEjer + "c.txt";
     eaFicheroTra   = "mem" + nEjer + "c.doc";

     eaFicheroPla   = eaPlanillaTra;
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO PersonalizaMemoria;
     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazdocu#0 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirSerDoc    = aBase  + "word/memoria/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";

     aIdioma = #zhazcrea#18 < " ";
     |SI aIdioma = " "; |O #zhazcrea#15 ! "P"; |O #zhazdocu#0 < 2017;
         aIdioma = "m";
     |FINSI;
     |SI #zhazcrea#15 = "P";
         |SI #zhazdocu#0 = 2008;
             eaFicheroTxt   = "memor001.txt";
             eaFicheroTra   = "memor001.doc";
         |FINSI;

         |SI #zhazdocu#0 = 2009;
             eaFicheroTxt   = "memo2009.txt";
             eaFicheroTra   = "memo2009.doc";
         |FINSI;

         |SI #zhazdocu#0 ] 2010;
             nEjer = #zhazdocu#0;
             |SI nEjer > enUltMemP;  nEjer = enUltMemP;  |FINSI;

             eaFicheroTxt   = "me" + aIdioma + nEjer + "p.txt";
             eaFicheroTra   = "me" + aIdioma + nEjer + "p.doc";
         |FINSI;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         nEjer = #zhazdocu#0;
         |SI nEjer > enUltMemA;  nEjer = enUltMemA;  |FINSI;

         eaFicheroTxt   = "me" + aIdioma + nEjer + "a.txt";
         eaFicheroTra   = "me" + aIdioma + nEjer + "a.doc";
     |FINSI;

     |SI #zhazcrea#15 = "C";
         nEjer = #zhazdocu#0;
         |SI nEjer > enUltMemC;  nEjer = enUltMemC;  |FINSI;

         eaFicheroTxt   = "me" + aIdioma + nEjer + "c.txt";
         eaFicheroTra   = "me" + aIdioma + nEjer + "c.doc";
     |FINSI;

     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "word/memoria/";
     eaModoPresenta = "P";

     eaOrigen       = eaDirGuarda + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     |HAZ EditaDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     aAlfa     = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105);
     |MKDIR aAlfa;

     eaDirGuarda = aBase  + "word/memoria/" + (("00000" + #zhazcrea#0) % -105) + "/";
     eaOrigen    = aAbre;
     eaDestino   = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     |HAZ FinVentanaTrabajo;

     |PULSATECLA;
|FPRC;

|PROCESO RenumerarGestion;
     #zhazcrea#8 = #zregdocu#6 + 1; |PINTA #zhazcrea#8;

     |HAZ VentanaTrabajo;

     |DBASE aBase;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS";                          |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS";                 |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1;         |RMKDIR eaDirTrabajo;
     eaDirTrabajo   = eaUnidadBasico + "\MODELOS\MEMORIAS\" + #zhazcrea#1 + "\";
     eaDirSerPlan   = aBase  + "planilla/";
     eaDirTrabServi = aBase  + "tmp";                        |MKDIR eaDirTrabServi;
     eaDirTrabServi = aBase  + "tmp/";
     eaFicheroTxt   = "wgestio.txt";
     eaFicheroTra   = "wgestio.doc";
     eaFicheroPla   = eaPlanillaTra;
     eaDirGuarda    = aBase  + "emisiones";    |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + (("00000" + #zhazcrea#0) % -105);  |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/" + #zhazcrea#1;                       |MKDIR eaDirGuarda;
     eaDirGuarda    = eaDirGuarda + "/";
     eaDirSerDoc    = eaDirGuarda;
     eaModoPresenta = "";

     eaOrigen       = eaDirGuarda  + eaFicheroTra;
     eaDestino      = eaDirTrabajo + eaFicheroTra;
     |HAZ EnviaFicheroConMD5;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         aAlfa   = "0000 El Documento " + aAbre + " no esta instalado. Consulte con su administrador.";
         |MENAV aAlfa;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaPag1 = #zhazcrea#8;
     |HAZ QuentaPagDocumento;

     aAbre = eaDirTrabajo + eaFicheroTra;
     |XABRE "EC", aAbre, nHandle;
     |SI FSalida < 0;
         |HAZ FinVentanaTrabajo;
         |ACABA;
     |FINSI;

     eaOrigen  = aAbre;
     eaDestino = eaDirGuarda + eaFicheroTra;
     |HAZ RecibeFichero;

     aAbre = eaDirTrabajo + eaFicheroTra;

     #zregdocu#9  = eaPag1;
     #zregdocu#10 = eaPag2;

     |RFBORRA aAbre;

     |HAZ FinVentanaTrabajo;

     eaPag1 = "";
     eaPag2 = "";

     |PULSATECLA;
|FPRC;

|PROCESO Tipo12Cuadros;  |TIPO 12;
|FPRC;
