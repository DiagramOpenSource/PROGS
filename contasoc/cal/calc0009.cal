|INCLUYE calc9999;
|INCLUYE varbal_i;

|PROCESO Bucle109;
     enValor1 = enValor1 + #isom0009#6;
     enValor2 = enValor2 + #isom0009#8;
     enValor3 = enValor3 + #isom0009#10;
|FPRC;

|DEFBUCLE Bucle109;
     #isom0009#1;
     ;
     enEmpresa, enAnyo, nDLinea;
     enEmpresa, enAnyo, nHLinea;
     ;
     NULL, Bucle109;
|FIN;

|PROCESO Calcula1048;
     #isom0009#0 = enEmpresa;
     #isom0009#1 = enAnyo;
     #isom0009#5 = "1048";
     |LEE 101#isom0009.=;
     |SI FSalida ! 0;
         |SELECT #1#isom0009;
         #isom0009#0 = enEmpresa;
         #isom0009#1 = enAnyo;
         #isom0009#3 = "Compensaci¢n base";
         #isom0009#5 = "1048";
         #isom0009#7 = "";
         #isom0009#9 = "1049";

         |SI enAnyo = 2017;
             #isom0009#2 = 115;                     ||Linea en el 2017;
             #isom0009#4 = "2017";
         |FINSI;

         |SI enAnyo = 2018;
             #isom0009#2 = 120;                     ||Linea en el 2018;
             #isom0009#4 = "2018";
         |FINSI;

         |SI enAnyo = 2019;
             #isom0009#2 = 125;                     ||Linea en el 2019;
             #isom0009#4 = "2019";
         |FINSI;

         |GRABA 020#isom0009.b;
     |FINSI;

     nOk = 1;
     |ABRE #maempr11;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 9;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  nOk = 0;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 10;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  nOk = 0;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 13;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;
         |ABRE #isom0000;
         #isom0000#0 = #maempr10#0;
         #isom0000#1 = #maempr10#1;
         |LEE 000#isom0000.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;
         |CIERRA #isom0000;

         |SI #isom0000#29 = 100;
             nOk = 0;
         |FINSI;
     |FINSI;
     |CIERRA #maempr11;

     #isom0009#6  = 0;
     #isom0009#8  = 0;
     #isom0009#10 = 0;

     |SI nOk = 1;
         eaCasilla = "552";  |HAZ LeeCas101; nVal = #isom0001#5;
         eaCasilla = "1033"; |HAZ LeeCas101; nVal = nVal + #isom0001#5;
         |SI nVal > 0;  nVal = 0;  |FINSI;

         #isom0009#6  = -nVal;
         #isom0009#8  = 0;
         #isom0009#10 = -nVal;
     |FINSI;

     |GRABA 020#isom0009.a;
     |LIBERA #isom0009;
|FPRC;

|PROCESO TotalFich109;
     nDLinea   = 0;
     nHLinea   = 80;

     |SI enAnyo = 2014;  nHLinea   = 90;  |FINSI;
     |SI enAnyo = 2015;  nHLinea   = 95;  |FINSI;
     |SI enAnyo = 2016;  nHLinea   = 100; |FINSI;
     |SI enAnyo = 2017;  nHLinea   = 105; |FINSI;
     |SI enAnyo = 2018;  nHLinea   = 110; |FINSI;
     |SI enAnyo ] 2019;  nHLinea   = 115; |FINSI;

     enValor1  = 0;
     enValor2  = 0;
     enValor3  = 0;
     |BUCLE Bucle109;

     |ABRE #isom0009;
     |SELECT #2#isom0009;
     #isom0009#0 = enEmpresa;
     #isom0009#1 = enAnyo;
     #isom0009#5 = "670";
     |LEE 101#isom0009.=;
     |SI FSalida = 0;
         #isom0009#6  = enValor1;
         #isom0009#8  = enValor2;
         #isom0009#10 = enValor3;
         |GRABA 020#isom0009.a;
     |FINSI;
     |LIBERA #isom0009;

     enVal1509 = 0;
     #isom0009#0 = enEmpresa;
     #isom0009#1 = enAnyo;
     #isom0009#5 = "1509";
     |LEE 101#isom0009.=;
     |SI FSalida = 0;
         enVal1509 = #isom0009#6;
     |FINSI;

     |SI enAnyo ] 2017;
         |HAZ Calcula1048;
     |SINO;
         |SELECT #1#isom0009;
         #isom0009#0 = enEmpresa;
         #isom0009#1 = enAnyo;
         #isom0009#2 = 115;
         |LEE 000#isom0009.=;
         |SI FSalida = 0
             |BORRA 020#isom0009.a;
             |LIBERA #isom0009;
         |FINSI;
     |FINSI;

     |SELECT #1#isom0009;
     |CIERRA #isom0009;
|FPRC;
