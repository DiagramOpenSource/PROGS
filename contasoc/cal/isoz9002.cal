|FICHEROS;
     isoz9002;

     isom9232;
     maempr18;
     maempr19;
     maempr20;
     maempr14;
     maempr15;

     maacceso;
|FIN;

|VARIABLES;
     nGrid               = -1;
     nTree               = -1;
     nBtnSal             = -1;
     nBtn                = -1;
     nBtnNue             = -1;
     nBtnBor             = -1;
     nBtnEmi             = -1;
     nBtnJus             = -1;
     nLbl                = -1;
     nCopiar             = 0;
     nRango              = 0;
     nPanta              = 0;
     nVent               = 0;
     nID                 = 0;
     nAnyo               = 0;
     nEje                = 0;
     nCompleO            = 0;
     nOpcion             = 0;
     nHandle             = 0;
     nRama1              = 0;
     aDef                = "";

     aQQ                 = "";
     aID                 = "";
     aBase               = "";
     aAlfa               = "";
     aAbre               = "";
     aRama               = "";
     aTexto              = "";
     aOpcion             = "";
     aContenido          = "";
     aJusti              = "";
     aTipo               = "";

     fFecha              = @;
     nNume               = 0;

 {-1}sTree               = 0;
     sT_nID              = 0;
     sT_nOper            = 0;
     sT_aData            = "";

 {-1}aVent               = "";
     aVent1              = 0;
     aVent2              = 0;
     aVent3              = 0;
     aVent4              = 0;
     aVent5              = "";

     nEjerOrig   = 0;
     nCompOrig   = 0;
     nOk         = 0;

 {50}aPopup              = "";

     &eaRutaOrigen       = "";
     &eaRutaDestino      = "";
     &eaUnidadBasico     = "";
     &eaFicheroTxt       = "";
     &eaFicheroTgz       = "";
     &eaFicheroTar       = "";
     &eaAlfa             = "";
     &eaBloqueo          = "";
     &enModoConsulta     = 0;
     &enEmpresa          = 0;
     &enAnyo             = 0;
     &enComple           = 0;
     &enError            = 0;
     &fFechaChequeo      = @;
     &fFechaDisol        = @;
     &enEjercicio        = 0;
     &eaForzExplorador   = "";

     &eaImpre            = "";
     &eaJusti            = "";

     &eaAzul             = "";
     &eaVerde            = "";
     &eaRojo             = "";
|FIN;

|PROCESO MiraBloqueo;
     |DBASS aBase;
     aAbre = aBase + "integral/def/dsam0021.mas";
     |XABRE "E", aAbre, 0;
     |SI FSalida ] 0;
         aAlfa = ":integral/dsam0021;" + (("00000" + #isom9232#0) % -105);
         aAlfa = aAlfa + "CHEQUEO";
         |SUB_EJECUTA aAlfa;

         |SI eaBloqueo ! "1";
             aAlfa = "|:integral/dsam0021;" + (("00000" + #isom9232#0) % -105);
             aAlfa = aAlfa + "PANTALLA";
             |SUB_EJECUTA aAlfa;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Baja232;
     #isom9232#0 = 00001;
     #isom9232#1 = #isoz9002#0;
     #isom9232#2 = 0;
|FPRC;

|PROCESO Alta232;
     #isom9232#0 = 99999;
     #isom9232#1 = #isoz9002#0;
     #isom9232#2 = 99;
|FPRC;

|PROCESO Evnt232;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#isom9232.=;

         |ESTADO_CONTROL nTree, "ENABLE";
         |ESTADO_CONTROL nBtnBor, "ENABLE";
         |ESTADO_CONTROL nBtnEmi, "ENABLE";

         |ESTADO_CONTROL nBtnJus, "DISABLE";
         |SI #isom9232#6 = "S";
             |ESTADO_CONTROL nBtnJus, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO EvntTree;
     aContenido = Contenido % -108;

     |SI FEntrada = 0;
         aTexto  = Contenido;
         |ACABA;
     |FINSI;

     enModoConsulta = 0;

     |LEE 000#isom9232.=;

     enEmpresa = #isom9232#0;
     enAnyo    = #isom9232#1;
     enComple  = #isom9232#2;

     |ESTADO_CONTROL nGrid, "DISABLE";
     |ESTADO_CONTROL nTree, "DISABLE";

     |SI #isom9232#6 = "S";  |Y aContenido ! "";
         enModoConsulta = 0;

         |CONFI "0000NEl modelo est  impreso. Quiere dejarlo no impreso y modificar los datos";
         |SI FSalida = 0;
             |LEE 101#isom9232.=;
             |SI FSalida = 0;
                 #isom9232#6  = "N";
                 #isom9232#7  = "01.01.0000";
                 #isom9232#8  = "";
                 #isom9232#10 = "";
                 |GRABA 020#isom9232.a;
                 |LIBERA #isom9232;
             |FINSI;
         |SINO;
             |MENAV "0000Se entrar  en MODO CONSULTA";
             enModoConsulta = 1;
         |FINSI;
     |FINSI;

     |SUB_EJECUTA aContenido;

     |ESTADO_CONTROL nGrid, "ENABLE";
     |ESTADO_CONTROL nTree, "ENABLE";

     |REFRESCACONTROL nGrid;  |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Baja100;
     #maacceso#0 = 1;
     #maacceso#1 = #isoz9002#0;
|FPRC;

|PROCESO Alta100;
     #maacceso#0 = 99999;
     #maacceso#1 = #isoz9002#0;
|FPRC;

|PROCESO maempr18A;
     #maempr18#1  = #isom9232#1;
     #maempr18#12 = #isom9232#2;

     |GRABA 000#maempr18.n;
     |LIBERA #maempr18;
|FPRC;

|DEFBUCLE maempr18A;
     #maempr18#1;
     ;
     #isom9232#0, nEjerOrig, nCompOrig, 00;
     #isom9232#0, nEjerOrig, nCompOrig, 99;
     be;
     NULL, maempr18A;
|FIN;

|PROCESO maempr19A;
     #maempr19#1 = #isom9232#1;
     #maempr19#5 = #isom9232#2;

     |GRABA 000#maempr19.n;
     |LIBERA #maempr19;
|FPRC;

|DEFBUCLE maempr19A;
     #maempr19#1;
     ;
     #isom9232#0, nEjerOrig, nCompOrig, 00;
     #isom9232#0, nEjerOrig, nCompOrig, 99;
     be;
     NULL, maempr19A;
|FIN;

|PROCESO maempr20A;
     #maempr20#1  = #isom9232#1;
     #maempr20#10 = #isom9232#2;

     |GRABA 000#maempr20.n;
     |LIBERA #maempr20;
|FPRC;

|DEFBUCLE maempr20A;
     #maempr20#1;
     ;
     #isom9232#0, nEjerOrig, nCompOrig, 00, 00;
     #isom9232#0, nEjerOrig, nCompOrig, 99, 99;
     be;
     NULL, maempr20A;
|FIN;

|PROCESO maempr14A;
     #maempr14#1 = #isom9232#1;
     #maempr14#9 = #isom9232#2;

     |GRABA 000#maempr14.n;
     |LIBERA #maempr14;
|FPRC;

|DEFBUCLE maempr14A;
     #maempr14#1;
     ;
     #isom9232#0, nEjerOrig, nCompOrig, 00;
     #isom9232#0, nEjerOrig, nCompOrig, 99;
     be;
     NULL, maempr14A;
|FIN;

|PROCESO maempr15A;
     #maempr15#1 = #isom9232#1;
     #maempr15#9 = #isom9232#2;

     |GRABA 000#maempr15.n;
     |LIBERA #maempr15;
|FPRC;

|DEFBUCLE maempr15A;
     #maempr15#1;
     ;
     #isom9232#0, nEjerOrig, nCompOrig, 00;
     #isom9232#0, nEjerOrig, nCompOrig, 99;
     be;
     NULL, maempr15A;
|FIN;

|PROCESO maempr18;
     #maempr18#12 = #isom9232#2;

     |GRABA 000#maempr18.n;
     |LIBERA #maempr18;
|FPRC;

|DEFBUCLE maempr18;
     #maempr18#1;
     ;
     #isom9232#0, #isom9232#1, nCompleO, 00;
     #isom9232#0, #isom9232#1, nCompleO, 99;
     be;
     NULL, maempr18;
|FIN;

|PROCESO maempr19;
     #maempr19#5 = #isom9232#2;

     |GRABA 000#maempr19.n;
     |LIBERA #maempr19;
|FPRC;

|DEFBUCLE maempr19;
     #maempr19#1;
     ;
     #isom9232#0, #isom9232#1, nCompleO, 00;
     #isom9232#0, #isom9232#1, nCompleO, 99;
     be;
     NULL, maempr19;
|FIN;

|PROCESO maempr20;
     #maempr20#10 = #isom9232#2;

     |GRABA 000#maempr20.n;
     |LIBERA #maempr20;
|FPRC;

|DEFBUCLE maempr20;
     #maempr20#1;
     ;
     #isom9232#0, #isom9232#1, nCompleO, 00, 00;
     #isom9232#0, #isom9232#1, nCompleO, 99, 99;
     be;
     NULL, maempr20;
|FIN;

|PROCESO maempr14;
     #maempr14#9 = #isom9232#2;

     |GRABA 000#maempr14.n;
     |LIBERA #maempr14;
|FPRC;

|DEFBUCLE maempr14;
     #maempr14#1;
     ;
     #isom9232#0, #isom9232#1, nCompleO, 00;
     #isom9232#0, #isom9232#1, nCompleO, 99;
     be;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     #maempr15#9 = #isom9232#2;

     |GRABA 000#maempr15.n;
     |LIBERA #maempr15;
|FPRC;

|DEFBUCLE maempr15;
     #maempr15#1;
     ;
     #isom9232#0, #isom9232#1, nCompleO, 00;
     #isom9232#0, #isom9232#1, nCompleO, 99;
     be;
     NULL, maempr15;
|FIN;

|PROCESO Nuevo;
     |ABRE #maacceso;
     #maacceso#0 = #isom9232#0;
     #maacceso#1 = #isom9232#1;
     |LEE 000#maacceso.=;
     |CONSULTA_F_CLAVE #5#maacceso, Baja100, Alta100;
     |SI FSalida ! 0;  |CIERRA #maacceso; |ACABA;  |FINSI;
     |CIERRA #maacceso;

     enEmpresa     = #maacceso#0;
     |HAZ MiraBloqueo;
     |SI eaBloqueo = "3";
         |ACABA;
     |FINSI;

     enEmpresa     = #maacceso#0;
     aAlfa         = "01.01." + #isoz9002#0;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;
     |SI enError = 2;
         aAlfa = "0000NEmpresa con fecha disolucion " + fFechaDisol + ". Continuar.";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     nOk       = 0;
     nNume     = 0;
     nCompOrig = 0;
     nEjerOrig = #maacceso#1 - 1;
     |PARA;  |SI;  |HACIENDO;
          #isom9232#0 = #maacceso#0;
          #isom9232#1 = nEjerOrig;
          #isom9232#2 = nNume;
          |LEE 000#isom9232.=;
          |SI FSalida ! 0;  |SAL;  |FINSI;

          nCompOrig = nNume;
          nNume     = nNume + 1;
          nOk       = 1;
    |SIGUE;

     enComple = 0;
     aJusti  = "";
     aTipo   = "";

     #isom9232#0   = #maacceso#0;
     #isom9232#1   = #maacceso#1;
     #isom9232#2   = 0;
     |LEE 000#isom9232.=;
     |SI FSalida = 0;
         |SI #isom9232#6 = "S";
             |MENAV "0000Ya existe datos del modelo con esta empresa y est  impresa.";
             |CONFI "0000NQuiere crear una complementaria o sustitutoria";
             |SI FSalida ! 0;  |ACABA;  |FINSI;

             aTipo = "S";
             |CONFI "0000SEs complementaria";
             |SI FSalida = 0;  aTipo = "C";  |FINSI;

             |PARA;  |SI;  |HACIENDO;
                  #isom9232#0 = #maacceso#0;
                  #isom9232#1 = #isoz9002#0;
                  #isom9232#2 = enComple;
                  |LEE 000#isom9232.=;
                  |SI FSalida ! 0;  |SAL;  |FINSI;

                  aJusti   = #isom9232#8;
                  enComple = enComple + 1;
             |SIGUE;
         |SINO;
             |MENAV  "0000La empresa ya ha sido abierta y no est  impresa.";
             |ACABA;
         |FINSI;
     |FINSI;

     |DDEFECTO #isom9232;
     #isom9232#0 = #maacceso#0;
     #isom9232#1 = #isoz9002#0;
     #isom9232#2 = enComple;
     #isom9232#3 = #maacceso#3;
     #isom9232#4 = #maacceso#2;
     #isom9232#5 = aTipo;
     #isom9232#9 = aJusti;
     |GRABA 020#isom9232.n;
     |LIBERA #isom9232;

     |SI aTipo = "S";
         nCompleO = enComple - 1;

         |BUCLE maempr18;
         |BUCLE maempr19;
         |BUCLE maempr20;
         |BUCLE maempr14;
         |BUCLE maempr15;
     |FINSI;

     |SI aTipo = ""; |Y nOk = 1;
         |CONFI "0000SRecoger Datos Declaracion Ejercicio Anterior";
         |SI FSalida = 0;
             |BUCLE maempr18A;
             |BUCLE maempr19A;
             |BUCLE maempr20A;
             |BUCLE maempr14A;
             |BUCLE maempr15A;
         |FINSI;
         FSalida = 0;
     |FINSI;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO maempr18B;
     |BORRA 020#maempr18.a;
     |LIBERA #maempr18;
|FPRC;

|DEFBUCLE maempr18B;
     #maempr18#1;
     ;
     #isom9232#0, #isom9232#1, #isom9232#2, 00;
     #isom9232#0, #isom9232#1, #isom9232#2, 99;
     be;
     NULL, maempr18B;
|FIN;

|PROCESO maempr19B;
     |BORRA 020#maempr19.a;
     |LIBERA #maempr19;
|FPRC;

|DEFBUCLE maempr19B;
     #maempr19#1;
     ;
     #isom9232#0, #isom9232#1, #isom9232#2, 00;
     #isom9232#0, #isom9232#1, #isom9232#2, 99;
     be;
     NULL, maempr19B;
|FIN;

|PROCESO maempr20B;
     |BORRA 020#maempr20.a;
     |LIBERA #maempr20;
|FPRC;

|DEFBUCLE maempr20B;
     #maempr20#1;
     ;
     #isom9232#0, #isom9232#1, #isom9232#2, 00, 00;
     #isom9232#0, #isom9232#1, #isom9232#2, 99, 99;
     be;
     NULL, maempr20B;
|FIN;

|PROCESO maempr14B;
     |BORRA 020#maempr14.a;
     |LIBERA #maempr14;
|FPRC;

|DEFBUCLE maempr14B;
     #maempr14#1;
     ;
     #isom9232#0, #isom9232#1, #isom9232#2, 00;
     #isom9232#0, #isom9232#1, #isom9232#2, 99;
     be;
     NULL, maempr14B;
|FIN;

|PROCESO maempr15B;
     |BORRA 020#maempr15.a;
     |LIBERA #maempr15;
|FPRC;

|DEFBUCLE maempr15B;
     #maempr15#1;
     ;
     #isom9232#0, #isom9232#1, #isom9232#2, 00;
     #isom9232#0, #isom9232#1, #isom9232#2, 99;
     be;
     NULL, maempr15B;
|FIN;

|PROCESO Borrar;
     |LEE 000#isom9232.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |CONFI "0000NEst  seguro que quiere borrar el registro seleccionado.";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#isom9232.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BUCLE maempr18B;
     |BUCLE maempr19B;
     |BUCLE maempr20B;
     |BUCLE maempr14B;
     |BUCLE maempr15B;

     |BORRA 020#isom9232.a;
     |LIBERA #isom9232;

     |ESTADO_CONTROL nBtnBor, "DISABLE";
     |ESTADO_CONTROL nBtnEmi, "DISABLE";
     |ESTADO_CONTROL nBtnJus, "DISABLE";

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|| ///////////////////////////////////////////////////////////

|PROCESO Emision232;
     |SI #isom9232#6 = "S";
         |CONFI "0000NEl modelo est  impreso. Quiere dejarlo como no impreso y volverlo a emitir";
         |SI FSalida ! 0; |ACABA;  |FINSI;
     |FINSI;

     eaImpre      = "N";
     eaJusti      = "";
     enEmpresa    = #isom9232#0;
     enAnyo       = #isom9232#1;
     |SUB_EJECUTA "isoz9003";

     |LEE 101#isom9232.=;
     |SI FSalida = 0;
         |HAZ CargaColores;

         #isom9232#6  = eaImpre;
         #isom9232#7  = "01.01.0000";
         #isom9232#8  = "";
         #isom9232#10 = "";
         |SI #isom9232#6  = "S";
             #isom9232#7  = ~;
             #isom9232#8  = eaJusti;
             #isom9232#10 = eaVerde;
         |FINSI;

         |GRABA 020#isom9232.a;
         |LIBERA #isom9232;

         |REFRESCACONTROL nGrid;
     |FINSI;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Justifi232;
     |LEE 101#isom9232.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1350, -1, 16, "N£mero de justificante obtenido";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{2}}N£mero de justificante ";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0920, NULL;

     eaJusti = #isom9232#8;
     E_inf   = "";
     E_sup   = "16";

     |PARA;  |SI;  |HACIENDO;
          eaJusti = 0922 ? 1;
          |CONFI "0000SEl n£mero introducido es correcto";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |PULSATECLA;

     #isom9232#8 = eaJusti;
     |GRABA 020#isom9232.a;
     |LIBERA #isom9232;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO CargaArbol;
     eaAlfa = aRama + ":" + aTexto + " " + aOpcion + &13 + &10;
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO T12;  |TIPO 12;
     |SI FSalida = 7;
         |ACABA;
     |FINSI;

     |REFRESCACONTROL nGrid;

     |POSICIONATE #isoz9002#0;
     |ERROR;
|FPRC;

|PROCESO BtnSal;
     |PTEC 807;
|FPRC;

|PROCESO T0C0;  |TIPO 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |PTEC 806;
|FPRC;

|PROCESO T66C0;  |TIPO 66;
     fFecha = ~;
     aAlfa  = fFecha % -104;  nEje = aAlfa;

     aAlfa = "|C000WID";
     aID   = #isoz9002#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion

     nEje = nEje + 1;

     IaPopup  = aPopup3 <-;
     nOpcion  = 0;
     |PARA nAnyo = 2016;  |SI nAnyo [ nEje;  |HACIENDO nAnyo = nAnyo + 1;
           nOpcion = nOpcion + 1;
           aPopup  = nAnyo;

           IaPopup  = IaPopup + 1;
     |SIGUE;

     aPopup2  = nOpcion;
     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         #isoz9002#0 = aPopup;
     |FINSI;

     |PINTA #isoz9002#0;

     |PTEC 806;
|FPRC;

|PROCESO T7C0;  |TIPO 7;
     |SI nBtnSal ! -1;
         |ACABA;
     |FINSI;

     aQQ   = "|X000";
     aID   = #isoz9002#aQQ#;
     nBtn  = aID;
     |ESTADO_CONTROL nBtn, "HIDE";

     aQQ   = "|X001";
     aID   = #isoz9002#aQQ#;
     nBtn  = aID;
     |ESTADO_CONTROL nBtn, "HIDE";

     |CONTROL_SIMPLE 0, "BOTON,{{197}} Salir", 3488, 3498, BtnSal;
     nBtnSal = FSalida;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO CreaTree;
     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";      |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     eaRutaDestino = eaUnidadBasico + "\MODELOS";            |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP";        |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP\";
     eaFicheroTxt  = "isoz9002" + Usuario + ".txt";
     eaFicheroTgz  = "isoz9002" + Usuario + ".tgz";
     eaFicheroTar  = "isoz9002" + Usuario + ".tar";

     sT_nID   = nTree;
     sT_nOper = 0;

     aAbre = eaRutaOrigen + eaFicheroTxt;
     |XABRE "WB", aAbre, nHandle;

     nRama1  = 1;
     aRama   = nRama1;
     aTexto  = "Informaci¢n de operaciones con personas o entidades vinculadas (art.13.4 RIS)";
     aOpcion = "{{maempx18}}";
     |HAZ CargaArbol;

     nRama1  = nRama1 + 1;
     aRama   = nRama1;
     aTexto  = "Operaciones con personas o entidades vinculadas (art.23 y DT.20 LIS)";
     aOpcion = "{{maempx19}}";
     |HAZ CargaArbol;

     nRama1  = nRama1 + 1;
     aRama   = nRama1;
     aTexto  = "Operaciones relacionadas con países calificados como para¡sos fiscales";
     aOpcion = "{{maempx14}}";
     |HAZ CargaArbol;

     nRama1  = nRama1 + 1;
     aRama   = nRama1;
     aTexto  = "Tenencia de valores relacionados con países calificados como para¡sos fiscales";
     aOpcion = "{{maempx15}}";
     |HAZ CargaArbol;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL, Tabla de contenidos de la empresa seleccionada {{" + aAlfa + "}}";
     |CONTROL_SIMPLE nPanta, eaAlfa, 2702, 3398, EvntTree;
     nTree = FSalida;

     |ESTADO_CONTROL nTree, "DISABLE";

     eaFicheroTxt  = "isoz9002" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;
|FPRC;

|PROCESO ExploraPred;
     eaForzExplorador = "S";
     enEjercicio      = #isoz9002#0;
     |HAZ Explorador;
|FPRC;

|PROCESO Copiar;
     |CONFI "0000NDesea recoger Datos Ejercicio Anterior";
     |SI FSalida = 0;
         aAlfa = "|:contasoc/isoz9004;" + (("0000" + #isoz9002#0) % -104);
         |SUB_EJECUTA aAlfa;

         |HAZ T12;
         |HAZ T0C0;
     |FINSI;
     |PULSATECLA;
     FSalida = 0;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     |PINPA #0#isoz9002;  nPanta = FSalida;
     |PINDA #0#isoz9002;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}Nuevo registro", 2568, 2582, Nuevo;
     nBtnNue = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{207}}Borrar registro", 2584, 2598, Borrar;
     nBtnBor = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Emisi¢n modelo 232", 2502, 2520, Emision232;
     nBtnEmi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}Justificante", 2522, 2535, Justifi232;
     nBtnJus = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Explorador predeterminado", 3302, 3416, ExploraPred;
     |CONTROL_SIMPLE 0, "BOTON,{{197}}Copiar A¤o Anterior", 3371, 3485, Copiar;

     |ESTADO_CONTROL nBtnBor, "DISABLE";
     |ESTADO_CONTROL nBtnEmi, "DISABLE";
     |ESTADO_CONTROL nBtnJus, "DISABLE";

     |HAZ CreaTree;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#isom9232, nRango, 0802, 2498, Baja232, Alta232, Evnt232;
     nGrid = FSalida;

     |ENDATOS #1#isoz9002;

|FPRO;

|PROCESO T80;  |TIPO 80;
     |ABRET #isom9232;
     FSalida = 3499;
|FPRC;

|PROCESO T90;  |TIPO 90;
     |CIERRAT #isom9232;
|FPRC;
