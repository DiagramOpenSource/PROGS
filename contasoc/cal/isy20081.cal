|FICHEROS;
      isoy2008 #0;
      maempr10 #200;
      maempr02 #202;
      maempr03 #203;
      maempr04 #204;
      maempr05 #205;
      maempr06 #206;
      maempr14 #214;
      maempr15 #215;
      maempr16 #216;
      maempr18 #218;
      maempr11 #201;

      isom0000 #100;
      isom0001 #101;
      isom0002 #102;
      isom0003 #103;
      isom0004 #104;
      isom0005 #105;
      isom0006 #106;
      isom0007 #107;
      isom0008 #108;
      isom0009 #109;
      isom0010 #110;
      isom0011 #111;
      isom0012 #112;
      isom0013 #113;
      isom0014 #114;
      isom0015 #115;

      isom0500 #500;
      isom0501 #501;
      isom0502 #502;
      isom0503 #503;
      isom0504 #504;
      isom0505 #505;
      isom0506 #506;
      isom0507 #507;
      isom0508 #508;
      isom0509 #509;

      :/basica/def/agim0019 #319;
      :/contagen/def/ca8m0000 #400;
      zregpres #401;

      isoh0801 #901;
      isoh0802 #902;
      isoh0819 #919;
      isoh0821 #921;
      isoh08di #999;

     &clientes@ #715;
|FIN;

|VARIABLES;
     aCasilla       = "";
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aBase          = "";
     aDirServidor   = "";
     aDirInternet   = "";
     aDirLanza      = "";
     aDelindex      = "";
     aFichero       = "";
     aFicheroT      = "";
     aFicheroP      = "";
     aAbre          = "";
     aOrigen        = "";
     aDestino       = "";
     aContenido     = "";
     aCNAE          = "";
     aDia           = "";
     aMes           = "";
     aEjerc         = "";
     aPais          = "";
     aCodPais       = "";
     aLong          = "";
     aTecla         = "";
     aRetu          = "";
     aEsc1          = "";
     aEsc2          = "";

     nLong          = 0;
     nNume          = 0;
     nPos           = 0;
     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor4        = 0;
     nValor5        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nPanta         = 0;
     nCasilla       = 0;
     nFecha         = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nContaBucle    = 0;
     nContaBucleL   = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;
     nTotal         = 0;
     nValor626      = 0;
     nValor627      = 0;
     nValor628      = 0;
     nValor629      = 0;
     nCanti1        = 0;
     nCanti2        = 0;
     nCanti3        = 0;
     nCanti4        = 0;
     nCantiT        = 0;
     nResto         = 0;
     nTecla         = 0;
     nBotonCont     = 0;
     nBotonSal      = 0;

     fFechaD        = @;
     fFechaH        = @;


     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa       = 0;
     &enAnyo          = 0;
     &enNavieras      = 0;
     &enCooperativa   = 0;
     &enTranspa       = 0;
     &enZEC           = 0;
     &enPeqDimen      = 0;
     &enForales       = 0;
     &enError         = 0;
     &enAviso         = 0;
     &eaError         = "";
     &eaAlfa          = "";
     &enHandle        = 0;
     &enCanti         = 0;
     &eaPagina        = "";
     &enCodCli        = 0;
     &enSwDeDonde     = 0;
     &eaEfectivo      = "";
     &eaAdeudo        = "";
     &eaEntidad       = "";
     &eaOficina       = "";
     &eaDC             = "";
     &eaCuenta         = "";
     &enModelo         = 0;
     &enBanco          = 0;
     &enFormaPag       = 0;
     &enForzar         = 0;
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaFinLinea       = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
|FIN;

|PROCESO CopiaFichero;
     aAlfa = "";
     |IP_REMOTO aAlfa;  |QBT aAlfa;
     |SI aAlfa ! "";
         |ENVIA_FICHERO aOrigen, aDestino;
     |SINO;
         |COPIA_FICHERO aOrigen, aDestino;
     |FINSI;
|FPRC;

|PROCESO LeeFich101;
     |ABRE #101;
     |SELECT #2#101;
     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#3 = aCasilla;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;
|FPRC;

|PROCESO LeeFich107;
     |ABRE #107;
     |SELECT #2#107;
     #107#0 = #200#0;
     #107#1 = #200#1;
     #107#4 = aCasilla;
     |LEE 000#107=;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;
|FPRC;

|PROCESO LeeFich108;
     |ABRE #108;
     |SELECT #1#108;
     #108#0 = #200#0;
     #108#1 = #200#1;
     #108#2 = aCasilla;
     |LEE 000#108=;
     |SI FSalida ! 0;  |DDEFECTO #108;  |FINSI;
     |CIERRA #108;
|FPRC;

|PROCESO LeeFich109;
     |ABRE #109;
     |SELECT #2#109;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#5 = aCasilla;
     |LEE 000#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;
     |CIERRA #109;
|FPRC;

|PROCESO LeeFich110;
     |ABRE #110;
     |SELECT #2#110;
     #110#0 = #200#0;
     #110#1 = #200#1;
     #110#5 = aCasilla;
     |LEE 000#110=;
     |SI FSalida ! 0;  |DDEFECTO #110;  |FINSI;
     |CIERRA #110;
|FPRC;

|PROCESO LeeFich111;
     |ABRE #111;
     |SELECT #2#111;
     #111#0 = #200#0;
     #111#1 = #200#1;
     #111#4 = aCasilla;
     |LEE 000#111=;
     |SI FSalida ! 0;  |DDEFECTO #111;  |FINSI;
     |CIERRA #111;
|FPRC;

|PROCESO LeeFich112;
     |ABRE #112;
     |SELECT #2#112;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#4 = aCasilla;
     |LEE 000#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;
     |CIERRA #112;
|FPRC;

|PROCESO AbreSecuencial;
     |DBASE aBase;  |QBF aBase;
     aDirServidor = aBase + "tmp";   |MKDIR aDirServidor;
     aDirServidor = aBase + "tmp/";

     aDirLanza    = eaUnidadBasico + "\AEAT";                         |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200";                     |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200\" + #200#1;           |RMKDIR aDirLanza;
     aDirLanza    = eaUnidadBasico + "\AEAT\200\" + #200#1 + "\";

     aDirInternet = eaUnidadBasico + "/AEAT";                         |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET";                |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200";            |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200/" + #200#1;  |RMKDIR aDirInternet;
     aDirInternet = eaUnidadBasico + "/AEAT/INTERNET/200/" + #200#1 + "\";

     aFichero    = (("00000" + #200#0) % -105) + #200#1 + ".txt";
     aFicheroT   = (("00000" + #200#0) % -105) + #200#1 + "T.txt";
     aFicheroP   = "portal200.html";

     aAbre       = aDirServidor + aFicheroT;
     |XABRE "BW", aAbre, enHandle;
|FPRC;

|PROCESO GrabaPortal;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO GrabaPortalSin;
     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO PortalBorrador;
     aAbre = aDirServidor + aFicheroP;
     |XABRE "WB", aAbre, enHandle;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www5.aeat.es/l/zi22zilk0022" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "SOV8200A" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIC" + &34 + " value=" + &34;
     |HAZ GrabaPortalSin;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFicheroP;
     aOrigen    = aDirServidor + aFichero;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "AB", aAbre, enHandle;

     eaAlfa = &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "RUT" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + "2008" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "200" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA enHandle;

     aOrigen  = aDirServidor + aFicheroP;
     aDestino = aDirLanza + aFicheroP;
     |HAZ CopiaFichero;

     eaForzExplorador = "N";
     enEjercicio      = enAnyo;
     |HAZ Explorador;

     |SI eaPathExplorador ! "";
         aAlfa = eaPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     aAlfa = aDirServidor + aFicheroP;   |FBORRA aAlfa;
     aAlfa = aDirLanza + aFicheroP;      |RFBORRA aAlfa;
|FPRC;

|PROCESO PortalValidacion;
     aAbre = aDirServidor + aFicheroP;
     |XABRE "WB", aAbre, enHandle;

     eaAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     eaAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<html>";
     |HAZ GrabaPortal;

     eaAlfa = "<head>";
     |HAZ GrabaPortal;

     eaAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     eaAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "</head>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     function carga()";
     |HAZ GrabaPortal;

     eaAlfa = "     {";
     |HAZ GrabaPortal;

     eaAlfa = "          document.form1.submit();";
     |HAZ GrabaPortal;

     eaAlfa = "     }";
     |HAZ GrabaPortal;

     eaAlfa = "</script>";
     |HAZ GrabaPortal;

     eaAlfa = "";
     |HAZ GrabaPortal;

     eaAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "<form method=" + &34 + "POST" + &34 + " action=" + &34 + "https://www5.aeat.es/l/zi22zilk0022" + &34 + " name=" + &34 + "form1" + &34 + " id=" + &34 + "form1" + &34 + ">";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "HID" + &34 + " value=" + &34 + "SOV8200A" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "IDI" + &34 + " value=" + &34 + "ES" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIC" + &34 + " value=" + &34;
     |HAZ GrabaPortalSin;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFicheroP;
     aOrigen    = aDirServidor + aFichero;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre = aDirServidor + aFicheroP;
     |XABRE "AB", aAbre, enHandle;

     eaAlfa = &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "RUT" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "PRG" + &34 + " value=" + &34 + "EWLINKIX" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "FIN" + &34 + " value=" + &34 + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "EJF" + &34 + " value=" + &34 + "2008" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "     <input type=" + &34 + "hidden" + &34 + " name=" + &34 + "MOD" + &34 + " value=" + &34 + "200" + &34 + " />";
     |HAZ GrabaPortal;

     eaAlfa = "";  |HAZ GrabaPortal;
     eaAlfa = "";  |HAZ GrabaPortal;

     eaAlfa = "</form>";   |HAZ GrabaPortal;
     eaAlfa = "</body>";   |HAZ GrabaPortal;
     eaAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA enHandle;

     aOrigen  = aDirServidor + aFicheroP;
     aDestino = aDirLanza + aFicheroP;
     |HAZ CopiaFichero;

     eaForzExplorador = "N";
     enEjercicio      = enAnyo;
     |HAZ Explorador;

     |SI eaPathExplorador ! "";
         aAlfa = eaPathExplorador + " " + aDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     aAlfa = aDirServidor + aFicheroP;   |FBORRA aAlfa;
     aAlfa = aDirLanza + aFicheroP;      |RFBORRA aAlfa;
|FPRC;

|PROCESO PortalImprime;
     |VENTANA 0501, 2399, -1, 16, "Generar PDF";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{10}}A continuaci¢n se abrir  una ventana con el resumen ";
     aAlfa = aAlfa + "del fichero generado. Pulsaremos en Generar PDF y obtendremos ";
     aAlfa = aAlfa + "el impreso. Luego se puede guardar el PDF en cualquier directorio ";
     aAlfa = aAlfa + "de la red.";
     |CONTROL_SIMPLE 0, aAlfa, 1045, 1398, NULL;

     aAlfa = "LABEL,{{10}}Es conveniente hacer un copiar al n£mero de justificante ";
     aAlfa = aAlfa + "porque luego lo pediremos.";
     |CONTROL_SIMPLE 0, aAlfa, 1445, 2698, NULL;

     |CONTROL_SIMPLE 0, "BOTON, Continuar", 1215, 1435, BotonContinuar;
     nBotonCont = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Cancelar," + nBotonCont;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     aOrigen  = aDirServidor + aFichero;
     aDestino = aDirLanza + aFichero;
     |HAZ CopiaFichero;

     aAlfa = eaPathExplorador + " https://www5.aeat.es/es13/h/ie82000b.html?fic=";
     aAlfa = aAlfa + aDirLanza + aFichero;
     aAlfa = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |RSYSTEM aAlfa;

     |VENTANA 0501, 1350, -1, 16, "N£mero de justificante obtenido";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{2}}N£mero de justificante ";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0920, NULL;

     E_inf   = "";
     E_sup   = "16";

     |PARA;  |SI;  |HACIENDO;
          eaJusti = 0922 ? 1;
          |CONFI "0000SEl n£mero introducido es correcto";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |PULSATECLA;

     eaImpre = "S";

     aAlfa = aDirLanza + aFichero;      |RFBORRA aAlfa;
|FPRC;

|PROCESO BotonContinuar;
     |PTEC 806;
|FPRC;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO MandaAInternet;
     aOrigen  = aDirServidor + aFichero;
     aDestino = aDirInternet + aFichero;
     |HAZ CopiaFichero;

     aAlfa = "0000El fichero generado est  en " + aDestino + " para su presentaci¢n.";
     |MENAV aAlfa;

     eaImpre = "S";
     eaJusti = "";
|FPRC;

|PROCESO ModoPresentacion;
     |VENTANA 0501, 2399, -1, 16, "Forma de env¡o";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{10}}A continuaci¢n elija el tipo de presentaci¢n";
     |CONTROL_SIMPLE 0, aAlfa, 1345, 2698, NULL;

     |CONTROL_SIMPLE 0, "BOTON, Internet", 1015, 1235, BotonContinuar;
     nBotonCont = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Presentaci¢n en PDF", 1415, 1635, BotonSalir;
     nBotonSal = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Cancelar," + nBotonCont;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |SI aTecla = aEsc2;
         |HAZ PortalImprime;
         |ACABA;
     |FINSI;

     |SI aTecla = aEsc1;
         |HAZ MandaAInternet;
     |FINSI;
|FPRC;

|PROCESO Portal;
     |SI PARAMETRO = "BORRADOR";
         |HAZ PortalBorrador;
         |ACABA;
     |FINSI;

     aAlfa = aDirInternet + aFichero;   |RFBORRA aAlfa;

     |HAZ PortalValidacion;

     |VENTANA 0501, 2399, -1, 16, "Resultado de la validaci¢n";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{10}}Nuestra aplicaci¢n no puede detectar autom ticamente ";
     aAlfa = aAlfa + "si la declaraci¢n ha sido correcta o no. Sabemos si la ";
     aAlfa = aAlfa + "respuesta de hacienda ha sido positiva si nos ha generado ";
     aAlfa = aAlfa + "el documento PDF ";
     |CONTROL_SIMPLE 0, aAlfa, 1040, 1398, NULL;

     aAlfa = "LABEL,{{10}}Pulse en el bot¢n de continuar SOLO si la respuesta ha sido positiva ";
     aAlfa = aAlfa + "en caso contrario pulse el bot¢n cancelar, ya que de otro modo a la ";
     aAlfa = aAlfa + "hora de presentar la declaraci¢n generada ser¡a rechazada por Hacienda.";
     |CONTROL_SIMPLE 0, aAlfa, 1440, 2498, NULL;

     |CONTROL_SIMPLE 0, "BOTON, Continuar", 1015, 1235, BotonContinuar;
     nBotonCont = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, Cancelar", 1415, 1635, BotonSalir;
     nBotonSal = FSalida;

     |PULSATECLA;
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Cancelar," + nBotonCont;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |SI aTecla = aEsc2;
         |ACABA;
     |FINSI;

     aAlfa = #200#3 % 101;
     |SI aAlfa = "A";  |O aAlfa = "B";
         |HAZ MandaAInternet;
         |ACABA;
     |FINSI;

     |SI aTecla = aEsc1;
         |HAZ ModoPresentacion;
     |FINSI;
|FPRC;

|PROCESO CierraSecuencial;
     |XCIERRA enHandle;

     aAbre      = aDirServidor + aFichero;

     |XABRE "BW", aAbre, enHandle;

     eaPagina  = eaPagina + "FIN";
     aLong     = eaPagina % 0;
     nLong     = aLong;
     nResto    = 300 - nLong;
     |SI nResto < 0;  nResto = 0;  |FINSI;

     eaAlfa = "<T2000" + #200#1 + "0A0000>";  |HAZ GrabaSecuencial;
     eaAlfa = "<AUX>";       |HAZ GrabaSecuencial;
     eaAlfa = " " * 70;      |HAZ GrabaSecuencial;
     eaAlfa = "1.00";        |HAZ GrabaSecuencial;
     eaAlfa = "    ";        |HAZ GrabaSecuencial;
     eaAlfa = "B53179768";   |HAZ GrabaSecuencial;
     eaAlfa = " " * 213;     |HAZ GrabaSecuencial;
     eaAlfa = "</AUX>";      |HAZ GrabaSecuencial;
     eaAlfa = "<VECTOR>";    |HAZ GrabaSecuencial;
     eaAlfa = eaPagina;      |HAZ GrabaSecuencial;
     eaAlfa = " " * nResto;  |HAZ GrabaSecuencial;
     eaAlfa = "</VECTOR>";   |HAZ GrabaSecuencial;
     |XCIERRA enHandle;

     aDestino   = aDirServidor + aFichero;
     aOrigen    = aDirServidor + aFicheroT;

     |AFEGIR_FICHERO aOrigen, aDestino;

     aAbre      = aDirServidor + aFichero;

     |XABRE "BA", aAbre, enHandle;
     eaAlfa = "</T2000" + #200#1 + "0A0000>";  |HAZ GrabaSecuencial;

     eaAlfa = &13 + &10;  |HAZ GrabaSecuencial;
     |XCIERRA enHandle;

     |HAZ Portal;

     |SI PARAMETRO = "BORRADOR";
         aAbre = aDirServidor + aFichero;   |FBORRA aAbre;
         |ACABA;
     |FINSI;

     aAlfa = aDirServidor + aFicheroT;  |FBORRA aAlfa;
     aAlfa = aDirServidor + aFichero;   |FBORRA aAlfa;
|FPRC;

|PROCESO Lee201;
     aContenido = "0";

     #201#0 = #200#0;
     #201#1 = #200#1;
     #201#2 = nCasilla;
     |LEE 000#201=;
     |SI FSalida = 0;
         aContenido = "1";
     |FINSI;
|FPRC;

|PROCESO maempr04;
     nContaBucle = nContaBucle + 1;
     |SI nContaBucle = 1;
         #901#79 = #204#3;
         #901#80 = #204#4;
         #901#81 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#82 = #204#6;
     |FINSI;

     |SI nContaBucle = 2;
         #901#83 = #204#3;
         #901#84 = #204#4;
         #901#85 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#86 = #204#6;
     |FINSI;

     |SI nContaBucle = 3;
         #901#87 = #204#3;
         #901#88 = #204#4;
         #901#89 = (#204#5 % -104) + (#204#5 % 402) + (#204#5 % 102);
         #901#90 = #204#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #204#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr04;
|FIN;

|PROCESO Hoja1;
     eaPagina = "001";

     |DDEFECTO #901;

     #901#6  = (("00" + #200#29) % -102) + (("000" + #200#30) % -103);  || Codigo
     #901#7  = #200#31 % -104;           || Del A¤o
     #901#8  = #200#31 % 402;            || Del Mes
     #901#9  = #200#31 % 102;            || Del Dia
     #901#10 = #200#32 % -104;           || Al A¤o
     #901#11 = #200#32 % 402;            || Al Mes
     #901#12 = #200#32 % 102;            || Al Dia
     |SI #200#31 = "01.01.2008";  |Y #200#32 = "31.12.2008";
         #901#13 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #200#31;
         fFechaH = #200#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #901#13 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #901#13 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     |ABRE #319;
     #319#0 = #200#0;
     #319#1 = 99;
     |LEE 000#319];
     |SI FSalida = 0;
         |LEE 000#319a;
     |SINO;
         |LEE 000#319u;
     |FINSI;
     |CIERRA #319;

     aCNAE = "";
     |SI FSalida = 0;  |Y #319#0 = #200#0;
         aCNAE = #319#81 % 102;
     |FINSI;

     #901#14 = aCNAE;                    || CNAE
     #901#15 = #200#3;                   || NIF
     #901#16 = #200#2;                   || Razon Social
     #901#17 = #200#15;                  || Telefono 1
     #901#18 = "";                       || Telefono 2
     #901#19 = "2008";

     |ABRE #201;
     nCasilla = 1;   |HAZ Lee201;  #901#20 = aContenido;
     nCasilla = 2;   |HAZ Lee201;  #901#21 = aContenido;
     nCasilla = 3;   |HAZ Lee201;  #901#22 = aContenido;
     nCasilla = 4;   |HAZ Lee201;  #901#23 = aContenido;
     nCasilla = 5;   |HAZ Lee201;  #901#24 = aContenido;
     nCasilla = 11;  |HAZ Lee201;  #901#25 = aContenido;
     nCasilla = 13;  |HAZ Lee201;  #901#26 = aContenido;
     nCasilla = 14;  |HAZ Lee201;  #901#27 = aContenido;
     nCasilla = 17;  |HAZ Lee201;  #901#28 = aContenido;
     nCasilla = 18;  |HAZ Lee201;  #901#29 = aContenido;
     nCasilla = 19;  |HAZ Lee201;  #901#30 = aContenido;
     nCasilla = 21;  |HAZ Lee201;  #901#31 = aContenido;
     nCasilla = 23;  |HAZ Lee201;  #901#32 = aContenido;
     nCasilla = 24;  |HAZ Lee201;  #901#33 = aContenido;
     nCasilla = 25;  |HAZ Lee201;  #901#34 = aContenido;
     nCasilla = 31;  |HAZ Lee201;  #901#35 = aContenido;
     nCasilla = 32;  |HAZ Lee201;  #901#36 = aContenido;
     nCasilla = 48;  |HAZ Lee201;  #901#37 = aContenido;
     nCasilla = 6;   |HAZ Lee201;  #901#38 = aContenido;
     nCasilla = 15;  |HAZ Lee201;  #901#39 = aContenido;
     nCasilla = 22;  |HAZ Lee201;  #901#40 = aContenido;
     nCasilla = 28;  |HAZ Lee201;  #901#41 = aContenido;
     nCasilla = 47;  |HAZ Lee201;  #901#42 = aContenido;
     nCasilla = 49;  |HAZ Lee201;  #901#43 = aContenido;
     nCasilla = 29;  |HAZ Lee201;  #901#44 = aContenido;
     nCasilla = 33;  |HAZ Lee201;  #901#45 = aContenido;
     nCasilla = 34;  |HAZ Lee201;  #901#46 = aContenido;
     nCasilla = 38;  |HAZ Lee201;  #901#47 = aContenido;
     nCasilla = 46;  |HAZ Lee201;  #901#48 = aContenido;
     nCasilla = 12;  |HAZ Lee201;  #901#49 = aContenido;
     nCasilla = 20;  |HAZ Lee201;  #901#50 = aContenido;
     nCasilla = 7;   |HAZ Lee201;  #901#51 = aContenido;
     nCasilla = 8;   |HAZ Lee201;  #901#52 = aContenido;
     nCasilla = 9;   |HAZ Lee201;  #901#53 = aContenido;
     nCasilla = 10;  |HAZ Lee201;  #901#54 = aContenido;
     nCasilla = 16;  |HAZ Lee201;  #901#55 = aContenido;
     nCasilla = 26;  |HAZ Lee201;  #901#56 = aContenido;
     nCasilla = 27;  |HAZ Lee201;  #901#57 = aContenido;
     nCasilla = 30;  |HAZ Lee201;  #901#58 = aContenido;
     nCasilla = 35;  |HAZ Lee201;  #901#59 = aContenido;
     nCasilla = 37;  |HAZ Lee201;  #901#60 = aContenido;
     nCasilla = 39;  |HAZ Lee201;  #901#61 = aContenido;
     nCasilla = 43;  |HAZ Lee201;  #901#62 = aContenido;
     nCasilla = 44;  |HAZ Lee201;  #901#63 = aContenido;
     nCasilla = 45;  |HAZ Lee201;  #901#64 = aContenido;

     |ABRE #400;
     |DDEFECTO #400;
     #400#0 = #200#101;
     |LEE 000#400=;
     #901#65 = #400#2;

     |DDEFECTO #400;
     #400#0 = #200#102;
     |LEE 000#400=;
     #901#66 = #400#2;
     |CIERRA #400;

     nCasilla = 9;  |HAZ Lee201;
     |SI #201#4 ! 0;
          aAlfa = ("000000" + #201#4) % -106;
          aAlfa = (aAlfa % 104) + "/" + (aAlfa % 502);

          #901#67 = aAlfa;
     |SINO;
          nCasilla = 10;  |HAZ Lee201;
          |SI #201#4 ! 0;
              aAlfa = ("000000" + #201#4) % -106;
              aAlfa = (aAlfa % 104) + "/" + (aAlfa % 502);

              #901#67 = aAlfa;
          |FINSI;
     |FINSI;

     |CIERRA #201;

     nNume   = #200#75 * 100;
     #901#68 = ("0000000000" + nNume) % -109;  || Empleados fijos
     nNume   = #200#76 * 100;
     #901#69 = ("0000000000" + nNume) % -109;  || Empleados si fijos

     #901#70 = "0";
     #901#71 = "0000000000000";

     |SI #200#98 = "S";
         #901#70 = "1";
         aAlfa1  = #200#99;  |QBT aAlfa1;
         aAlfa2  = #200#100; |QBT aAlfa2;
         #901#71 = ("0000000000000" + aAlfa1 + aAlfa2) % -113;  || N§ Justificante
     |FINSI;

     #901#72 = #200#77;                          || Nombre Secretario
     #901#73 = #200#78;                          || NIF    Secretario
     #901#74 = "00000000";
     |SI #901#31 = "1";
         #901#74 = (#0#1 % -104) + (#0#1 % 402) + (#0#1 % 102);
     |FINSI;


     nContaBucle = 0;    |BUCLE maempr04;

     #901#75 = #200#13;                          || Poblacion firma
     #901#76 = aDia;                             || Dia
     #901#77 = aMes;                             || Mes
     #901#78 = aEjerc;                           || A¤o

     |SI #901#81 = "        ";  #901#81 = "00000000";  |FINSI;
     |SI #901#85 = "        ";  #901#85 = "00000000";  |FINSI;
     |SI #901#89 = "        ";  #901#89 = "00000000";  |FINSI;

     |DDEFECTO #401;
     #401#0 = #200#1;
     |LEE 000#401=;
     |CIERRA #401;

     #901#93 = #401#1;
     nNume   = #401#6;  #901#94 = (("000000000" + nNume) % -109);
     nNume   = #401#7;  #901#95 = (("000000000" + nNume) % -109);
     #901#96 = #401#8;

     |PARA nCampo = 1;  |SI nCampo [ 98;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #901nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;
     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO maempr03;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0 = ((nContaBucle / 6) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#2   = "200";
         #902#154 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 6) + 6;
     #902nPuntero = #203#3;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#4;

                        aAlfa = "0";
     |SI #203#8 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#5;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #203#6;

     |SI #901#31 = "1";
         nPuntero     = nPuntero + 1;
         aAlfa        = ("00" + #203#7) % -102;
         #902nPuntero = aAlfa;
     |FINSI;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr03;
     #203#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr03;
|FIN;

|PROCESO maempr06;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 4) + .49) ! 0;
     nContaBucleL = (nContaBucle + 3) - (4 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0     = ((nContaBucle / 4) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#2   = "200";
         #902#154 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 17) + 42;
     #902nPuntero = #206#3;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #206#4;

     nPuntero     = nPuntero + 1;
     aAlfa        = ("00" + #206#5) % -102;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #206#7;
     |HAZ Calcula3E2D;
     #902nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #206#6;
     |HAZ Calcula17D;
     #902nPuntero = eaAlfa;

     |PARA nCampo = 8;  |SI nCampo [ 19;  |HACIENDO nCampo = nCampo + 1;
           nPuntero  = nPuntero + 1;
           enCanti   = #206nCampo;
           |HAZ Calcula17D;
           #902nPuntero = eaAlfa;
     |SIGUE;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr06;
     #206#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr06;
|FIN;

|PROCESO maempr02;
     nContaBucle  = nContaBucle + 1;
     #902#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #902#0);

     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0 = ((nContaBucle / 6) + .49) ! 0;

                          #902#5 = "";
         |SI #902#0 ! 1;  #902#5 = "C";  nComple = 1;  |FINSI;

         #902#154 = "</T200002>";

         eaPagina = eaPagina + "002";

         |GRABA 020#902b;
     |FINSI;

     nPuntero     = (nContaBucleL * 7) + 110;
     #902nPuntero = #202#3;

                        aAlfa = "0";
     |SI #202#9 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #202#4;

     nPuntero     = nPuntero + 1;
     #902nPuntero = #202#5;

     nPuntero     = nPuntero + 1;
     aAlfa        = #202#6;  |QBT aAlfa;
     aAlfa        = ("00" + aAlfa) % -102;
     #902nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #202#7;
     |HAZ Calcula17D;
     #902nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #202#8;
     |HAZ Calcula3E2D;
     #902nPuntero = eaAlfa;

     |GRABA 020#902a;
     |LIBERA #902;
|FPRC;

|DEFBUCLE maempr02;
     #202#1;
     ;
     #200#0, #200#1, 00;
     #200#0, #200#1, 99;
     ;
     NULL, maempr02;
|FIN;

|PROCESO isoh0802;
     |PARA nCampo = 1;  |SI nCampo [ 154;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #902nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0802;
     #902#1;
     ;
     01;
     99;
     ;
     NULL, isoh0802;
|FIN;

|PROCESO Hoja2;
     aDelindex = ("h1" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #902 aDelindex;
     |ABRE #902; |CIERRA #902; |DELINDEX #902;

     |ABRE #902;
     #902#0 = 1;
     |LEE 101#902=;
     |SI FSalida ! 0;
         |DDEFECTO #902;
         #902#0   = 1;
         #902#5   = "";
         #902#2   = "200";
         #902#154 = "</T200002>";

         |SI #200#73 > 100;  #200#73 = 0;  #200#74 = 0;  |FINSI;
         |SI #200#74 > 100;  #200#73 = 0;  #200#74 = 0;  |FINSI;

         |SI #902#5 = " ";
             enCanti   = #200#73;
             |HAZ Calcula3E2D;
             #902#152 = eaAlfa;

             enCanti   = #200#74;
             |HAZ Calcula3E2D;
             #902#153 = eaAlfa;
         |FINSI;

         eaPagina = eaPagina + "002";

         |GRABA 020#902n;
         |LIBERA #902;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr03;
     nContaBucle = 0;    |BUCLE maempr06;
     nContaBucle = 0;    |BUCLE maempr02;

     |CIERRA #902;

     |BUCLE isoh0802;

     |ABRE #902; |CIERRA #902; |DELINDEX #902;
|FPRC;

|PROCESO isom0501;
     |SI #501#2 = "     ";  |ACABA;  |FINSI;

     #102#0 = #200#0;
     #102#1 = #200#1;
     #102#2 = #501#1;
     |LEE 000#102=;
     |SI FSalida ! 0;  |DDEFECTO #102;  |FINSI;

     enCanti  = #102#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0501;
      #501#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0501;
|FIN;

|PROCESO Hoja3;
     eaPagina = eaPagina + "003";

     eaAlfa = "<T200003> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 15;
     nHasta = 255;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200003>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja4;
     eaPagina = eaPagina + "004";

     eaAlfa = "<T200004> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 260;
     nHasta = 415;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200004>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja5;
     eaPagina = eaPagina + "005";

     eaAlfa = "<T200005> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 455;
     nHasta = 670;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200005>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja6;
     eaPagina = eaPagina + "006";

     eaAlfa = "<T200006> ";  |HAZ GrabaSecuencial;

     |ABRE #102;
     nDesde = 680;
     nHasta = 800;
     |BUCLE isom0501;
     |CIERRA #102;

     eaAlfa = "</T200006>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0502;
     |SI #502#2 = "     ";  |ACABA;  |FINSI;

     #103#0 = #200#0;
     #103#1 = #200#1;
     #103#2 = #502#1;
     |LEE 000#103=;
     |SI FSalida ! 0;  |DDEFECTO #103;  |FINSI;

     enCanti  = #103#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0502;
      #502#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0502;
|FIN;

|PROCESO Hoja7;
     eaPagina = eaPagina + "007";

     eaAlfa = "<T200007> ";  |HAZ GrabaSecuencial;

     |ABRE #103;
     nDesde = 15;
     nHasta = 260;
     |BUCLE isom0502;
     |CIERRA #103;

     eaAlfa = "</T200007>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja8;
     eaPagina = eaPagina + "008";

     eaAlfa = "<T200008> ";  |HAZ GrabaSecuencial;

     |ABRE #103;
     nDesde = 265;
     nHasta = 415;
     |BUCLE isom0502;
     |CIERRA #103;

     eaAlfa = "</T200008>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0503;
     |SI #503#2 = "     ";  |ACABA;  |FINSI;

     #104#0 = #200#0;
     #104#1 = #200#1;
     #104#2 = #503#1;
     |LEE 000#104=;
     |SI FSalida ! 0;  |DDEFECTO #104;  |FINSI;

     enCanti  = #104#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0503;
      #503#1;
      ;
      #200#1, 0000;
      #200#1, 9999;
      ;
      NULL, isom0503;
|FIN;

|PROCESO Hoja9;
     |SI #901#65 = "3";  |ACABA;  |FINSI;

     eaPagina = eaPagina + "009";

     eaAlfa = "<T200009> ";  |HAZ GrabaSecuencial;

     |ABRE #104;
     |BUCLE isom0503;
     |CIERRA #104;

     eaAlfa = "</T200009>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0504;
     |SI #504#2 = "     ";  |ACABA;  |FINSI;

     #105#0 = #200#0;
     #105#1 = #200#1;
     #105#2 = #504#1;
     |LEE 000#105=;
     |SI FSalida ! 0;  |DDEFECTO #105;  |FINSI;

     enCanti  = #105#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0504;
      #504#2;
      ;
      #200#1, "     ", nDesde;
      #200#1, "zzzzz", nHasta;
      ;
      NULL, isom0504;
|FIN;

|PROCESO Hoja10;
     eaPagina = eaPagina + "010";

     eaAlfa = "<T200010> ";  |HAZ GrabaSecuencial;

     nDesde = 5;
     nHasta = 700;

     |ABRE #105;
     |BUCLE isom0504;
     |CIERRA #105;

     eaAlfa = "</T200010>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja11;
     eaPagina = eaPagina + "011";

     eaAlfa = "<T200011> ";  |HAZ GrabaSecuencial;

     nDesde = 705;
     nHasta = 1345;

     |ABRE #105;
     |BUCLE isom0504;
     |CIERRA #105;

     eaAlfa = "</T200011>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0500;
     |SI #500#2 = "900  ";  |ACABA;  |FINSI;
     |SI #500#2 = "901  ";  |ACABA;  |FINSI;
     |SI #500#2 = "     ";  |ACABA;  |FINSI;


     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#2 = #500#1;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

     |SI #500#2 ! "558";
         enCanti  = #101#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |SINO;
         enCanti  = #101#5;  |HAZ Calcula2E2D; |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0500;
      #500#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0500;
|FIN;

|DEFBUCLE isom0500_2;
      #500#2;
      ;
      #200#1, "     ", nDesde;
      #200#1, "zzzzz", nHasta;
      ;
      NULL, isom0500;
|FIN;

|PROCESO isom0505;
     #106#0 = #200#0;
     #106#1 = #200#1;
     #106#2 = #505#1;
     |LEE 000#106=;
     |SI FSalida ! 0;  |DDEFECTO #106;  |FINSI;

     |SI #505#2 ! "     ";
        enCanti  = #106#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #505#3 ! "     ";
        enCanti  = #106#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0505;
      #505#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0505;
|FIN;

|PROCESO Hoja12;
     eaPagina = eaPagina + "012";

     eaAlfa = "<T200012> ";  |HAZ GrabaSecuencial;

     nDesde = 5;
     nHasta = 25;

     |ABRE #101;
     |BUCLE isom0500;
     |CIERRA #101;

     nDesde = 5;
     nHasta = 230;

     |ABRE #106;
     |BUCLE isom0505;
     |CIERRA #106;

     eaAlfa = "</T200012>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja13;
     eaPagina = eaPagina + "013";

     eaAlfa = "<T200013> ";  |HAZ GrabaSecuencial;

     nDesde = 235;
     nHasta = 290;

     |ABRE #106;
     |BUCLE isom0505;
     |CIERRA #106;

     nDesde = 35;
     nHasta = 155;

     |ABRE #101;
     |BUCLE isom0500;
     |CIERRA #101;

     eaAlfa = "</T200013>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja14;
     eaPagina = eaPagina + "014";

     eaAlfa = "<T200014> ";  |HAZ GrabaSecuencial;


     |ABRE #101;
     nDesde = 170;  nHasta = 290;  |BUCLE isom0500;
     nDesde = 385;  nHasta = 390;  |BUCLE isom0500;
     nDesde = 395;  nHasta = 535;  |BUCLE isom0500_2;
     |CIERRA #101;

     eaAlfa = "</T200014>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0507;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#2 = #507#1;
     |LEE 000#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;

     |SI #507#3 ! "     ";
         eaAlfa = #109#4;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#4 ! "     ";
        enCanti  = #109#6;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#5 ! "     ";
        enCanti  = #109#8;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#6 ! "     ";
        enCanti  = #109#10; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507;
      #507#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0507;
|FIN;

|PROCESO isom0509;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#2 = #509#1;
     |LEE 000#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;

     |SI #509#2 ! "     ";
         enCanti  = #112#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#3 ! "     ";
         |SI #509#3 ! "103  ";
             enCanti  = #112#7;  |HAZ Calcula2E2D; |HAZ GrabaSecuencial;
         |SINO;
             enCanti  = #112#7;  |HAZ Calcula5E2D; |HAZ GrabaSecuencial;
         |FINSI;
     |FINSI;

     |SI #509#4 ! "     ";
         enCanti  = #112#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#5 ! "     ";
         enCanti  = #112#11; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #509#6 ! "     ";
         enCanti  = #112#13; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0509;
      #509#1;
      ;
      #200#1, 0000;
      #200#1, 9999;
      ;
      NULL, isom0509;
|FIN;


|PROCESO Hoja15;
     aCasilla = "670";  |HAZ LeeFich109;  nValor1 = #109#6;
     aCasilla = "116";  |HAZ LeeFich112;  nValor2 = #112#5;
     aCasilla = "131";  |HAZ LeeFich112;  nValor3 = #112#5;
     aCasilla = "160";  |HAZ LeeFich112;  nValor4 = #112#5;
     aCasilla = "171";  |HAZ LeeFich112;  nValor5 = #112#5;

     nSuma = nValor1 + nValor2 + nValor3 + nValor4 + nValor5
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "015";

     eaAlfa = "<T200015> ";  |HAZ GrabaSecuencial;

     |ABRE #109;
     |SELECT #1#109;
     nDesde = 5;    nHasta = 85;   |BUCLE isom0507;
     |CIERRA #109;

     |ABRE #112;
     |SELECT #1#112;
     |BUCLE isom0509;
     |CIERRA #112;

     eaAlfa = "</T200015>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO isom0508;
     #111#0 = #200#0;
     #111#1 = #200#1;
     #111#2 = #508#1;
     |LEE 000#111=;
     |SI FSalida ! 0;  |DDEFECTO #111;  |FINSI;

     |SI #508#2 ! "     ";
         enCanti  = #111#5;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #508#3 ! "     ";
         enCanti  = #111#7;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #508#4 ! "     ";
         enCanti  = #111#9;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0508;
      #508#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0508;
|FIN;

|PROCESO Hoja16;
     aCasilla = "841";  |HAZ LeeFich111;  nValor1 = #111#5;
     aCasilla = "764";  |HAZ LeeFich111;  nValor2 = #111#5;
     aCasilla = "886";  |HAZ LeeFich111;  nValor3 = #111#5;

     nSuma = nValor1 + nValor2 + nValor3 + #100#59 + #100#62 + #100#66;
     nSuma = nSuma   + #100#70 + #100#74 + #100#78;
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "016";

     eaAlfa = "<T200016> ";  |HAZ GrabaSecuencial;

     |ABRE #111;
     |SELECT #1#111;
     nDesde = 10;    nHasta = 50;   |BUCLE isom0508;
     nDesde = 65;    nHasta = 95;   |BUCLE isom0508;

     |PARA nCampo = 59;  |SI nCampo [ 79;  |HACIENDO nCampo = nCampo + 1;
            |SI nCampo = 61;  |O  nCampo = 64;  |O  nCampo = 68;
                |SI #100nCampo = " ";  #100nCampo = "0";  |FINSI;
                eaAlfa = #100nCampo;  |HAZ GrabaSecuencial;
            |SINO;
                enCanti  = #100nCampo;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
            |FINSI;
     |SIGUE;

     nDesde = 115;   nHasta = 215;   |BUCLE isom0508;
     |CIERRA #111;

     eaAlfa = "</T200016>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja17;
     aCasilla = "831";  |HAZ LeeFich111;  nValor1 = #111#5;
     aCasilla = "598";  |HAZ LeeFich111;  nValor2 = #111#5;

     nSuma = nValor1 + nValor2;
     |SI nSuma = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "017";

     eaAlfa = "<T200017> ";  |HAZ GrabaSecuencial;

     |ABRE #111;
     |SELECT #1#111;
     nDesde = 230;   nHasta = 450; |BUCLE isom0508;
     |CIERRA #111;

     eaAlfa = "</T200017>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Graba107;
     enCanti  = #107#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #107#7; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Graba108;
     #506#0  = #201#1;
     #506#1  = aCasilla;
     |LEE 000#506=;
     |SI FSalida ! 0;  |DDEFECTO #506;  |FINSI;

     |SI #506#2 ! "     ";
         enCanti  = #108#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #506#3 ! "     ";
         enCanti  = #108#7; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|PROCESO Hoja18;
     aCasilla = "417";   |HAZ LeeFich107;  nValor  = #107#5 + #107#7;
     aCasilla = "051";   |HAZ LeeFich107;  nValor  = nValor + #107#5 + #107#7;
     aCasilla = "1045";  |HAZ LeeFich108;  nValor  = nValor + #108#5 + #108#7;
     aCasilla = "1055";  |HAZ LeeFich108;  nValor  = nValor + #108#5 + #108#7;
     aCasilla = "1060";  |HAZ LeeFich108;  nValor  = nValor + #108#5 + #108#7;
     aCasilla = "1065";  |HAZ LeeFich108;  nValor  = nValor + #108#5 + #108#7;

     |PARA nCampo = 84;  |SI nCampo [ 105;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #100nCampo;
     |SIGUE;

     |SI nValor = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "018";

     eaAlfa = "<T200018> ";  |HAZ GrabaSecuencial;

     enCanti  = #100#84;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#85;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#86 + #100#87;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#88;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#89 + #100#90 + #100#91 + #100#92;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#93;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#94;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#95;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#96;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#97;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#98;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#99;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#100; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#101; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#102 + #100#103;
                          |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#104; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#105; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "001";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "003";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "027";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "005";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "029";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "007";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "031";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "009";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "033";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "011";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "035";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "013";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "037";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "015";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "039";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "017";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "041";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "019";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "043";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "021";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "045";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "023";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "047";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "025";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "049";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "417";  |HAZ LeeFich107;  |HAZ Graba107;
     aCasilla = "051";  |HAZ LeeFich107;  |HAZ Graba107;

     |ABRE #506;
     aCasilla = "1005";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1010";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1015";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1020";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1025";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1030";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1035";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1040";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1045";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1050";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1055";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1060";  |HAZ LeeFich108;  |HAZ Graba108;
     aCasilla = "1065";  |HAZ LeeFich108;  |HAZ Graba108;
     |CIERRA #506;

     eaAlfa = "</T200018>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO maempr18;
     nContaBucle  = nContaBucle + 1;
     #919#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #919#0);

     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         #919#0 = ((nContaBucle / 6) + .49) ! 0;

                          #919#5 = "";
         |SI #919#0 ! 1;  #919#5 = "C";  nComple = 1;  |FINSI;

         #919#2   = "200";
         #919#138 = "</T200019>";

         eaPagina = eaPagina + "019";

         |GRABA 020#919b;
     |FINSI;

     nPuntero     = (nContaBucleL * 9) + 6;
     #919nPuntero = #218#3;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #218#4;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #218#5;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #218#6 > " ";

     nPuntero     = nPuntero + 1;
     #919nPuntero = #218#7;

     nPuntero     = nPuntero + 1;
     aAlfa        = ("00" + #218#8) % -102;
     #919nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #218#9;

                             aAlfa = "";
     |SI #218#10 = "1§ a)";  aAlfa = "1A";  |FINSI;
     |SI #218#10 = "1§ b)";  aAlfa = "1B";  |FINSI;
     |SI #218#10 = "1§ c)";  aAlfa = "1C";  |FINSI;
     |SI #218#10 = "2§ a)";  aAlfa = "2A";  |FINSI;
     |SI #218#10 = "2§ b)";  aAlfa = "2B";  |FINSI;

     nPuntero     = nPuntero + 1;
     #919nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti       = #218#11;
     |HAZ Calcula17D;
     #919nPuntero = eaAlfa;

     |GRABA 020#919a;
     |LIBERA #919;
|FPRC;

|DEFBUCLE maempr18;
     #218#1;
     ;
     #200#0, #200#1, 00, 00;
     #200#0, #200#1, 00, 99;
     ;
     NULL, maempr18;
|FIN;

|PROCESO CogePais;
     |ABRE #216;
     #216#0 = aPais;
     |LEE 000#216=;
     |SI FSalida ! 0;  |DDEFECTO #216;  |FINSI;
     |CIERRA #216;

     aCodPais = #216#2;
|FPRC;

|PROCESO maempr14;
     nContaBucle  = nContaBucle + 1;
     #919#0       = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #919#0);

     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         #919#0 = ((nContaBucle / 6) + .49) ! 0;

                          #919#5 = "";
         |SI #919#0 ! 1;  #919#5 = "C";  nComple = 1;  |FINSI;

         #919#2   = "200";
         #919#138 = "</T200019>";

         eaPagina = eaPagina + "019";

         |GRABA 020#919b;
     |FINSI;

     nPuntero     = (nContaBucleL * 5) + 60;
     #919nPuntero = #214#3;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #214#4;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #214#5;

     nPuntero     = nPuntero + 1;
     aPais        = #214#6;  |HAZ CogePais;
     #919nPuntero = aCodPais;

     nPuntero     = nPuntero + 1;
     enCanti       = #214#8;
     |HAZ Calcula17D;
     #919nPuntero = eaAlfa;

     |GRABA 020#919a;
     |LIBERA #919;
|FPRC;

|DEFBUCLE maempr14;
     #214#1;
     ;
     #200#0, #200#1, 00, 00;
     #200#0, #200#1, 00, 99;
     ;
     NULL, maempr14;
|FIN;

|PROCESO maempr15;
     nContaBucle = nContaBucle + 1;
     #919#0      = ((nContaBucle / 6) + .49) ! 0;
     nContaBucleL = (nContaBucle + 5) - (6 * #919#0);

     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         #919#0     = ((nContaBucle / 6) + .49) ! 0;

                          #919#5 = "";
         |SI #919#0 ! 1;  #919#5 = "C";  nComple = 1;  |FINSI;

         #919#2   = "200";
         #919#138 = "</T200019>";

         eaPagina = eaPagina + "019";

         |GRABA 020#919b;
     |FINSI;

     nPuntero     = (nContaBucleL * 5) + 90;
     #919nPuntero = #215#3;

     nPuntero     = nPuntero + 1;
     #919nPuntero = #215#4;

     nPuntero     = nPuntero + 1;
     aPais        = #215#5;
     |HAZ CogePais;
     #919nPuntero = aCodPais;

     nPuntero     = nPuntero + 1;
     enCanti       = #215#7;
     |HAZ Calcula17D;
     #919nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #215#8;
     |HAZ Calcula3E2D;
     #919nPuntero = eaAlfa;

     |GRABA 020#919a;
     |LIBERA #919;
|FPRC;

|DEFBUCLE maempr15;
     #215#1;
     ;
     #200#0, #200#1, 00, 00;
     #200#0, #200#1, 00, 99;
     ;
     NULL, maempr15;
|FIN;

|PROCESO isom0013;
     nContaBucle  = nContaBucle + 1;
     #919#0       = ((nContaBucle / 10) + .50) ! 0;

     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         nContaBucleL = 120;

         #919#0 = ((nContaBucle / 10) + .50) ! 0;

                          #919#5 = "";
         |SI #919#0 ! 1;  #919#5 = "C";  nComple = 1;  |FINSI;

         #919#138 = "</T200019>";

         eaPagina = eaPagina + "019";

         |GRABA 020#919b;
     |FINSI;

     nContaBucleL     = nContaBucleL + 1;
     #919nContaBucleL = #113#3;

     |GRABA 020#919a;
     |LIBERA #919;
|FPRC;

|DEFBUCLE isom0013;
     #113#1;
     ;
     #200#0, #200#1, 01;
     #200#0, #200#1, 99;
     ;
     NULL, isom0013;
|FIN;

|PROCESO isom0014;
     nContaBucle  = nContaBucle + 1;
     #919#0       = ((nContaBucle / 5) + .49) ! 0;

     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         nContaBucleL = 131;

         #919#0 = ((nContaBucle / 5) + .49) ! 0;

                          #919#5 = "";
         |SI #919#0 ! 1;  #919#5 = "C";  nComple = 1;  |FINSI;

         #919#138 = "</T200019>";

         eaPagina = eaPagina + "019";

         |GRABA 020#919b;
     |FINSI;

     nContaBucleL = nContaBucleL + 1;
     |SI nContaBucleL > 136;  nContaBucleL = 132;  |FINSI;

     #919nContaBucleL = #114#3;

     |GRABA 020#919a;
     |LIBERA #919;
|FPRC;

|DEFBUCLE isom0014;
     #114#1;
     ;
     #200#0, #200#1, 01;
     #200#0, #200#1, 99;
     ;
     NULL, isom0014;
|FIN;

|PROCESO isoh0819;
     |PARA nCampo = 1;  |SI nCampo [ 138;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #919nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0819;
     #919#1;
     ;
     01;
     99;
     ;
     NULL, isoh0819;
|FIN;

|PROCESO Hoja19;
     nHay = 0;

     |ABRE #218;
     #218#0 = #200#0;
     #218#1 = #200#1;
     #218#2 = 1;
     |LEE 000#218];
     |SI FSalida = 0;  |Y  #218#0 = #200#0;  |Y #218#1 = #200#1;
         nHay = 1;
     |FINSI;
     |CIERRA #218;

     |ABRE #214;
     #214#0 = #200#0;
     #214#1 = #200#1;
     #214#2 = 1;
     |LEE 000#214];
     |SI FSalida = 0;  |Y  #214#0 = #200#0;  |Y #214#1 = #200#1;
         nHay = 1;
     |FINSI;
     |CIERRA #214;

     |ABRE #215;
     #215#0 = #200#0;
     #215#1 = #200#1;
     #215#2 = 1;
     |LEE 000#215];
     |SI FSalida = 0;  |Y  #215#0 = #200#0;  |Y #215#1 = #200#1;
         nHay = 1;
     |FINSI;
     |CIERRA #215;

     |SI #901#61 = "1";
         |ABRE #113;
         #113#0 = #200#0;
         #113#1 = #200#1;
         #113#2 = 1;
         |LEE 000#113];
         |SI FSalida = 0;  |Y  #113#0 = #200#0;  |Y #113#1 = #200#1;
             nHay = 1;
         |FINSI;
         |CIERRA #113;
     |FINSI;

     |SI #901#31 = "1";
         |ABRE #114;
         #114#0 = #200#0;
         #114#1 = #200#1;
         #114#2 = 1;
         |LEE 000#114];
         |SI FSalida = 0;  |Y  #114#0 = #200#0;  |Y #114#1 = #200#1;
             nHay = 1;
         |FINSI;
         |CIERRA #114;
     |FINSI;

     |SI #100#83 ! 0;  nHay = 1;  |FINSI;

     |SI nHay = 0;  |ACABA;  |FINSI;

     aDelindex = ("h2" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #919 aDelindex;
     |ABRE #919; |CIERRA #919; |DELINDEX #919;

     |ABRE #919;
     #919#0 = 1;
     |LEE 101#919=;
     |SI FSalida ! 0;
         |DDEFECTO #919;
         #919#0   = 1;
         #919#5   = "";
         #919#2   = "200";
         #919#138 = "</T200019>";

         |SI #901#61 = "1";
             enCanti   = #100#80;  |HAZ Calcula17D;  #919#120 = eaAlfa;
         |FINSI;

         |SI #901#31 = "1";
             enCanti   = #100#81;  |HAZ Calcula17D;  #919#130 = eaAlfa;
                                                     #919#131 = (("000" + #100#82) % -103);
         |FINSI;

         |SI #901#22 = "1";  |O #901#23 = "1";  |O #901#33 = "1";  |O #901#34 = "1";
             enCanti   = #100#83;  |HAZ Calcula17D;  #919#137 = eaAlfa;
         |FINSI;

         eaPagina = eaPagina + "019";

         |GRABA 020#919n;
         |LIBERA #919;
     |FINSI;

     nContaBucle = 0;    |BUCLE maempr18;
     nContaBucle = 0;    |BUCLE maempr14;
     nContaBucle = 0;    |BUCLE maempr15;

     |SI #901#61 = "1";
         nContaBucleL = 120;
         nContaBucle  = 0;   |BUCLE isom0013;
     |FINSI;

     |SI #901#31 = "1";
         nContaBucleL = 131;
         nContaBucle  = 0;   |BUCLE isom0014;
     |FINSI;

     |CIERRA #919;

     |BUCLE isoh0819;

     |ABRE #919; |CIERRA #919; |DELINDEX #919;
|FPRC;

|PROCESO isom0507Coo;
     #110#0 = #200#0;
     #110#1 = #200#1;
     #110#2 = #507#1;
     |LEE 000#110=;
     |SI FSalida ! 0;  |DDEFECTO #110;  |FINSI;

     |SI #901#28 = "0";  |Y #901#29 = "0";  |Y #901#30 = "0";
         #110#4  = "";
         #110#6  = 0;
         #110#8  = 0;
         #110#10 = 0;
     |FINSI;

     |SI #507#3 ! "     ";
         |SI #110#4 = "    ";
             eaAlfa = "0000";  |HAZ GrabaSecuencial;
         |SINO;
             eaAlfa = #110#4;  |HAZ GrabaSecuencial;
         |FINSI;
     |FINSI;

     |SI #507#4 ! "     ";
         enCanti  = #110#6;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#5 ! "     ";
         enCanti  = #110#8;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;

     |SI #507#6 ! "     ";
         enCanti  = #110#10; |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     |FINSI;
|FPRC;

|DEFBUCLE isom0507Coo;
      #507#1;
      ;
      #200#1, nDesde;
      #200#1, nHasta;
      ;
      NULL, isom0507Coo;
|FIN;

|PROCESO isom0015;
     nContaBucle  = nContaBucle + 1;

     |SI nContaBucle > 1;
         eaPagina = eaPagina + "020";

         eaAlfa = "<T200020>C";  |HAZ GrabaSecuencial;

         eaAlfa = "0" * 200;     |HAZ GrabaSecuencial;
         eaAlfa = "0" * 200;     |HAZ GrabaSecuencial;
         eaAlfa = "0" * 200;     |HAZ GrabaSecuencial;
         eaAlfa = "0" * 200;     |HAZ GrabaSecuencial;
         eaAlfa = "0" * 200;     |HAZ GrabaSecuencial;
         eaAlfa = "0" * 178;     |HAZ GrabaSecuencial;
     |FINSI;

     eaAlfa = #115#3;          |HAZ GrabaSecuencial;
     eaAlfa = #115#4 % 109;    |HAZ GrabaSecuencial;
     eaAlfa = #115#5;          |HAZ GrabaSecuencial;
     eaAlfa = #115#6 % 109;    |HAZ GrabaSecuencial;
     eaAlfa = #115#7;          |HAZ GrabaSecuencial;
     eaAlfa = (#115#8 % -104) + (#115#8 % 402) + (#115#8 % 102);
                               |HAZ GrabaSecuencial;

     enCanti  = #115#9;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #115#10;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #115#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     eaAlfa = "</T200020>";  |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isom0015;
     #115#1;
     ;
     #200#0, #200#1, 01;
     #200#0, #200#1, 99;
     ;
     NULL, isom0015;
|FIN;

|PROCESO Hoja20;
     |SI #901#28 = "0";  |Y #901#29 = "0";  |Y #901#30 = "0";
         |PARA nCampo = 7;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
               #100nCampo = 0;
         |SIGUE;
     |FINSI;

     |SI #901#40 = "0";
         |PARA nCampo = 2;  |SI nCampo [ 6;  |HACIENDO nCampo = nCampo + 1;
               #100nCampo = 0;
         |SIGUE;
     |FINSI;

     |SI #901#28 ! "0";  |O #901#29 ! "0";  |O #901#30 ! "0";
         aCasilla = "694";  |HAZ LeeFich110;  nValor  = #110#6;
     |FINSI;

     |PARA nCampo = 2;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 1;
           nValor = nValor + #100nCampo;
     |SIGUE;

     |SI #901#59 = "1";  |O #901#60 = "1";
         |ABRE #115;
         #115#0 = #200#0;
         #115#1 = #200#1;
         #115#2 = 1;
         |LEE 000#115];
         |SI FSalida = 0;  |Y  #115#0 = #200#0;  |Y #115#1 = #200#1;
             nValor = 1;
         |FINSI;
         |CIERRA #115;
     |FINSI;

     |SI nValor = 0;  |ACABA;  |FINSI;

     eaPagina = eaPagina + "020";

     eaAlfa = "<T200020> ";  |HAZ GrabaSecuencial;

     enCanti  = #100#7;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#17;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#8;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#18;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#9;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#19;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#20;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#10;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#21;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#11;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#22;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#12;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#23;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#13;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#24;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#14;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#15;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#25;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#16;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#26;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     |ABRE #110;
     |SELECT #1#110;
     nDesde = 1005;    nHasta = 1070;   |BUCLE isom0507Coo;
     |CIERRA #110;

     eaAlfa  = (("0000" + #100#2) % -104);  |HAZ GrabaSecuencial;
     enCanti  = #100#3;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#4;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#5;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti  = #100#6;   |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     |SI #901#59 = "1";  |O #901#60 = "1";
         |ABRE #115;
         #115#0 = #200#0;
         #115#1 = #200#1;
         #115#2 = 1;
         |LEE 000#115];
         |SI FSalida ! 0;  |O  #115#0 ! #200#0;  |O #115#1 ! #200#1;
             eaAlfa = " ";  |HAZ GrabaSecuencial;
             eaAlfa = " " * 9;   |HAZ GrabaSecuencial;
             eaAlfa = " " * 40;  |HAZ GrabaSecuencial;
             eaAlfa = " " * 9;   |HAZ GrabaSecuencial;
             eaAlfa = " " * 40;  |HAZ GrabaSecuencial;
             eaAlfa = "0" * 8;   |HAZ GrabaSecuencial;
             eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;
             eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;
             eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;

             eaAlfa = "</T200020>";  |HAZ GrabaSecuencial;

             eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
         |SINO;
             nContaBucle = 0;
             |BUCLE isom0015;
         |FINSI;
     |SINO;
         eaAlfa = " ";       |HAZ GrabaSecuencial;
         eaAlfa = " " * 9;   |HAZ GrabaSecuencial;
         eaAlfa = " " * 40;  |HAZ GrabaSecuencial;
         eaAlfa = " " * 9;   |HAZ GrabaSecuencial;
         eaAlfa = " " * 40;  |HAZ GrabaSecuencial;
         eaAlfa = "0" * 8;   |HAZ GrabaSecuencial;
         eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;
         eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;
         eaAlfa = "0" * 17;  |HAZ GrabaSecuencial;

         eaAlfa = "</T200020>";  |HAZ GrabaSecuencial;

         eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
     |FINSI;

     |CIERRA #115;
|FPRC;

|PROCESO maempr05;
     nContaBucle  = nContaBucle + 1;
     #921#0       = ((nContaBucle / 25) + .49) ! 0;
     nContaBucleL = (nContaBucle + 24) - (25 * #921#0);

     |LEE 101#921=;
     |SI FSalida ! 0;
         |DDEFECTO #921;
         #921#0     = ((nContaBucle / 25) + .49) ! 0;

                          #921#5   = "";
         |SI #921#0 ! 1;  #921#5   = "C";  nComple = 1;  |FINSI;

         eaPagina = eaPagina + "021";

         |GRABA 020#921b;
     |FINSI;

     nPuntero     = (nContaBucleL * 8) + 34;
     #921nPuntero = #205#3;

                         aAlfa = "0";
     |SI #205#10 = "X";  aAlfa = "1";  |FINSI;

     nPuntero     = nPuntero + 1;
     #921nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     #921nPuntero = #205#4;

     nPuntero     = nPuntero + 1;
     #921nPuntero = #205#5;

     nPuntero     = nPuntero + 1;
     #921nPuntero = #205#6;

     nPuntero     = nPuntero + 1;
     nNume        = #205#7;
     aAlfa        = ("00" + nNume) % -102;
     #921nPuntero = aAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #205#8;
     |HAZ Calcula17D;
     #921nPuntero = eaAlfa;

     nPuntero     = nPuntero + 1;
     enCanti      = #205#9;
     |HAZ Calcula3E4D;
     #921nPuntero = eaAlfa;

     |GRABA 020#921a;
     |LIBERA #921;
|FPRC;

|DEFBUCLE maempr05;
     #205#2;
     ;
     #200#0, #200#1, 999.99, 00;
     #200#0, #200#1,      0, 99;
     ;
     NULL, maempr05;
|FIN;

|PROCESO isoh0821;
     |PARA nCampo = 1;  |SI nCampo [ 234;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #921nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|DEFBUCLE isoh0821;
     #921#1;
     ;
     01;
     99;
     ;
     NULL, isoh0821;
|FIN;

|PROCESO Hoja21;
     |SI #901#26 = "0";  |Y #901#27 = "0";
         |ACABA;
     |FINSI;

     aDelindex = ("h3" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #921 aDelindex;
     |ABRE #921; |CIERRA #921; |DELINDEX #921;

     |ABRE #921;
     |DDEFECTO #921;

     #921#0  = 1;

     enCanti  = #100#29;  |HAZ Calcula3E4D;  #921#6  = eaAlfa;
     enCanti  = #100#30;  |HAZ Calcula17D;   #921#7  = eaAlfa;
     enCanti  = #100#31;  |HAZ Calcula17D;   #921#8  = eaAlfa;
     enCanti  = #100#32;  |HAZ Calcula17D;   #921#9  = eaAlfa;
                                             #921#10 = #100#33;
     enCanti  = #100#34;  |HAZ Calcula3E2D;  #921#11 = eaAlfa;
     enCanti  = #100#35;  |HAZ Calcula17D;   #921#12 = eaAlfa;
                                             #921#13 = #100#36;
     enCanti  = #100#37;  |HAZ Calcula3E2D;  #921#14 = eaAlfa;
     enCanti  = #100#38;  |HAZ Calcula17D;   #921#15 = eaAlfa;
                                             #921#16 = #100#39;
     enCanti  = #100#40;  |HAZ Calcula3E2D;  #921#17 = eaAlfa;
     enCanti  = #100#41;  |HAZ Calcula17D;   #921#18 = eaAlfa;
                                             #921#19 = #100#42;
     enCanti  = #100#43;  |HAZ Calcula3E2D;  #921#20 = eaAlfa;
     enCanti  = #100#44;  |HAZ Calcula17D;   #921#21 = eaAlfa;
     enCanti  = #100#45;  |HAZ Calcula3E2D;  #921#22 = eaAlfa;
     enCanti  = #100#46;  |HAZ Calcula17D;   #921#23 = eaAlfa;
     enCanti  = #100#47;  |HAZ Calcula3E2D;  #921#24 = eaAlfa;
     enCanti  = #100#48;  |HAZ Calcula17D;   #921#25 = eaAlfa;
     enCanti  = #100#49;  |HAZ Calcula3E2D;  #921#26 = eaAlfa;
     enCanti  = #100#50;  |HAZ Calcula17D;   #921#27 = eaAlfa;
     enCanti  = #100#51;  |HAZ Calcula3E2D;  #921#28 = eaAlfa;
     enCanti  = #100#52;  |HAZ Calcula17D;   #921#29 = eaAlfa;
     enCanti  = #100#53;  |HAZ Calcula17D;   #921#30 = eaAlfa;
     enCanti  = #100#54;  |HAZ Calcula17D;   #921#31 = eaAlfa;
     enCanti  = #100#55;  |HAZ Calcula17D;   #921#32 = eaAlfa;
     enCanti  = #100#56;  |HAZ Calcula17D;   #921#33 = eaAlfa;

     eaPagina = eaPagina + "021";

     |GRABA 020#921n;
     |LIBERA #921;

     nContaBucle = 0;    |BUCLE maempr05;

     |CIERRA #921;
     |BUCLE isoh0821;

     |ABRE #921; |CIERRA #921; |DELINDEX #921;
|FPRC;

|PROCESO CalculaCas;
     nCanti1 = ((nValor * nValor626) / nTotal) ! 2;
     nCanti2 = ((nValor * nValor627) / nTotal) ! 2;
     nCanti3 = ((nValor * nValor628) / nTotal) ! 2;
     nCanti4 = ((nValor * nValor629) / nTotal) ! 2;
     nCantiT = nCanti1 + nCanti2 + nCanti3 + nCanti4;
     nResto  = nValor - nCantiT;

     |SI nResto ! 0;  |Y nCanti1 ! 0;  nCanti1 = nCanti1 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti2 ! 0;  nCanti2 = nCanti2 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti3 ! 0;  nCanti3 = nCanti3 + nResto;  nResto  = 0;  |FINSI;
     |SI nResto ! 0;  |Y nCanti4 ! 0;  nCanti4 = nCanti4 + nResto;  nResto  = 0;  |FINSI;

     enCanti = nCanti1;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti2;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti3;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti4;  |HAZ Calcula17D;  |HAZ GrabaSecuencial;
     enCanti = nCanti1 + nCanti2 + nCanti3 + nCanti4;
                         |HAZ Calcula17D;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Hoja23;
     |SI #901#41 = "0";
         |ACABA;
     |FINSI;

     eaPagina = eaPagina + "023";

     eaAlfa = "<T200023> ";  |HAZ GrabaSecuencial;

     aCasilla = "050";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "051";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "052";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "053";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "054";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "055";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla = "056";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  |HAZ GrabaSecuencial;

     aCasilla  = "626";  |HAZ LeeFich101;
     enCanti   = #101#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor626 = #101#5;

     aCasilla  = "627";  |HAZ LeeFich101;
     enCanti   = #101#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor627 = #101#5;

     aCasilla  = "628";  |HAZ LeeFich101;
     enCanti   = #101#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor628 = #101#5;

     aCasilla  = "629";  |HAZ LeeFich101;
     enCanti   = #101#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;
     nValor629 = #101#5;

     aCasilla  = "625";  |HAZ LeeFich101;
     enCanti   = #101#5; |HAZ Calcula3E2D; |HAZ GrabaSecuencial;

     nTotal    = nValor626 + nValor627 + nValor628 + nValor629;

     aCasilla  = "600";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "602";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "604";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "606";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "612";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "616";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "618";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "620";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;
     aCasilla  = "622";  |HAZ LeeFich101;  nValor = #101#5; |HAZ CalculaCas;

     eaAlfa = "</T200023>";    |HAZ GrabaSecuencial;

     eaAlfa = eaFinLinea;  |HAZ GrabaSecuencial;
|FPRC;

|PROCESO HojaDID;
     |DDEFECTO #999;

     #999#7  = (("00" + #200#29) % -102) + (("000" + #200#30) % -103);  || Codigo
     #999#8  = #200#1;
     |SI #200#31 = "01.01.2008";  |Y #200#32 = "31.12.2008";
         #999#9 = "1";                    || Todo el Ejercicio
     |SINO;
         fFechaD = #200#31;
         fFechaH = #200#32;
         nFecha  = (fFechaH - fFechaD) + 1;
         |SI nFecha ] 365;
             #999#9 = "2";                || No coincide con el A¤o Natural
         |SINO;
             #999#9 = "3";                || No todo el Ejercicio
         |FINSI;
     |FINSI;

     #999#10 = "0A";                     || Periodo
     #999#11 = #200#31 % 102;            || Del Dia
     #999#12 = #200#31 % 402;            || Del Mes
     #999#13 = #200#31 % -102;           || Del Anyo
     #999#14 = #200#32 % 102;            || Al Dia
     #999#15 = #200#32 % 402;            || Al Mes
     #999#16 = #200#32 % -102;           || Al A¤o
     #999#17 = #200#3;                   || NIF
     #999#18 = #200#2;                   || Apellidos o Razon Social

     aCasilla = "552";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#19 = eaAlfa;

     aCasilla = "562";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#20 = eaAlfa;

     aCasilla = "621";  |HAZ LeeFich101;
     enCanti  = #101#5; |HAZ Calcula17D;  #999#21 = eaAlfa;
     nTotal   = #101#5;

     enCodCli = #200#0;
     |HAZ LeePersona;

     |SI #901#54 = "1"; nTotal = 0; |FINSI; ||tique 72_393

     |SI nTotal < 0;
         #999#26 = "D";
         enCanti  = -nTotal;  |HAZ Calcula17D;  #999#27 = eaAlfa;
         |SI #200#34 = "S";
             #999#26 = "R";
         |SINO;
             |SI enSwDeDonde = 1;
                 enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;

                 aAlfa   = eaEntidad;       |QBF aAlfa; #999#28 = ("0000" + aAlfa) % -104;
                 aAlfa   = eaOficina;       |QBF aAlfa; #999#29 = ("0000" + aAlfa) % -104;
                 aAlfa   = eaDC;            |QBF aAlfa; #999#30 = ("00"   + aAlfa) % -102;
                 aAlfa   = eaCuenta;        |QBF aAlfa; #999#31 = ("0000000000" + aAlfa) % -110;
             |SINO;
                 aAlfa   = #715#81;         |QBF aAlfa; #999#28 = ("0000" + aAlfa) % -104;
                 aAlfa   = #715#82;         |QBF aAlfa; #999#29 = ("0000" + aAlfa) % -104;
                 aAlfa   = #715#83;         |QBF aAlfa; #999#30 = ("00"   + aAlfa) % -102;
                 aAlfa   = #715#84 % 110;   |QBF aAlfa; #999#31 = ("0000000000" + aAlfa) % -110;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTotal > 0;
         enCanti  = nTotal; |HAZ Calcula17D;  #999#35 = eaAlfa;
         #999#32 = #0#0;
         |SI #0#0 ! "H";
             |SI enSwDeDonde = 1;
                 enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;

                 aAlfa   = eaEntidad;  |QBF aAlfa; #999#36 = ("0000" + aAlfa) % -104;
                 aAlfa   = eaOficina;  |QBF aAlfa; #999#37 = ("0000" + aAlfa) % -104;
                 aAlfa   = eaDC;       |QBF aAlfa; #999#38 = ("00"   + aAlfa) % -102;
                 aAlfa   = eaCuenta;   |QBF aAlfa; #999#39 = ("0000000000" + aAlfa) % -110;
             |SINO;
                 aAlfa   = #715#81;       |QBF aAlfa; #999#36 = ("0000" + aAlfa) % -104;
                 aAlfa   = #715#82;       |QBF aAlfa; #999#37 = ("0000" + aAlfa) % -104;
                 aAlfa   = #715#83;       |QBF aAlfa; #999#38 = ("00"   + aAlfa) % -102;
                 aAlfa   = #715#84 % 110; |QBF aAlfa; #999#39 = ("0000000000" + aAlfa) % -110;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI nTotal = 0;
         #999#40 = "1";
     |FINSI;

     #999#33 = "";
     #999#34 = "";
     #999#41 = #200#13;                            || Poblacion firma
     #999#42 = aDia;                             || Dia
     #999#43 = aMes;                             || Mes
     #999#44 = aEjerc;                           || A¤o

     |PARA nCampo = 1;  |SI nCampo [ 45;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #999nCampo;  |HAZ GrabaSecuencial;
     |SIGUE;

     eaPagina = eaPagina + "DID";
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     nTecla = FSalida;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |SI nTecla = 7;  |ACABA;  |FINSI;

     aDia   = #0#1 % 102;
     aMes   = #0#1 % 402;
     aEjerc = #0#1 % -104;

     |SI aMes = "01"; aMes = "Enero     "; |FINSI;
     |SI aMes = "02"; aMes = "Febrero   "; |FINSI;
     |SI aMes = "03"; aMes = "Marzo     "; |FINSI;
     |SI aMes = "04"; aMes = "Abril     "; |FINSI;
     |SI aMes = "05"; aMes = "Mayo      "; |FINSI;
     |SI aMes = "06"; aMes = "Junio     "; |FINSI;
     |SI aMes = "07"; aMes = "Julio     "; |FINSI;
     |SI aMes = "08"; aMes = "Agosto    "; |FINSI;
     |SI aMes = "09"; aMes = "Septiembre"; |FINSI;
     |SI aMes = "10"; aMes = "Octubre   "; |FINSI;
     |SI aMes = "11"; aMes = "Noviembre "; |FINSI;
     |SI aMes = "12"; aMes = "Diciembre "; |FINSI;
     aMes = aMes > aMes;

     |ABRE #100;
     #100#0 = #200#0;
     #100#1 = #200#1;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     |HAZ AbreSecuencial;
     |HAZ Hoja1;
     |HAZ Hoja2;
     |HAZ Hoja3;
     |HAZ Hoja4;
     |HAZ Hoja5;
     |HAZ Hoja6;
     |HAZ Hoja7;
     |HAZ Hoja8;
     |HAZ Hoja9;
     |HAZ Hoja10;
     |HAZ Hoja11;
     |HAZ Hoja12;
     |HAZ Hoja13;
     |HAZ Hoja14;
     |HAZ Hoja15;
     |HAZ Hoja16;
     |HAZ Hoja17;
     |HAZ Hoja18;
     |HAZ Hoja19;
     |HAZ Hoja20;
     |HAZ Hoja21;
     |HAZ Hoja22;
     |HAZ Hoja23;
     |HAZ HojaDID;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 1899;
|FPRC;

|PROGRAMA;
     |HAZ LeeUnidadBasico;

     eaImpre    = "N";
     eaJusti    = "";
     eaFinLinea = &13 + &10;
     eaFinLinea = "";

     |SI PARAMETRO ! "BORRADOR";
         |SUB_EJECUTA_NP "isoz0002;CHEQUEO";
         |SI enError ! 0;
             |MENAV "0000Hay errores graves, no puedo emitir el modelo.";
             |ACABA;
         |FINSI;

         |SI enAviso ! 0;
             |CONFI "0000SHay errores leves, quiere emitir de todas formas";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;
     |FINSI;

     |ABRE #200;
     #200#0 = enEmpresa;
     #200#1 = enAnyo;
     |LEE 000#200=;
     |SI FSalida ! 0;  |CIERRA #200;  |ACABA; |FINSI;
     |CIERRA #200;

     |C_M #0#0, 1, "N";
     aCasilla = "621";  |HAZ LeeFich101;
     nTotal   = #101#5;
     |SI nTotal > 0;
         |C_M #0#0, 1, "S";

         enCodCli = #200#0;
         |HAZ LeePersona;
         |SI enSwDeDonde = 1;
              enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;
                                     #0#0 = "H";
              |SI enFormaPag = 2;    #0#0 = "I";  |FINSI;
              |SI enFormaPag = 3;    #0#0 = "U";  |FINSI;
          |FINSI;
     |FINSI;

     aAlfa =  "Emisi¢n modelo 200 (" + (("00000" + #200#0) % -105) + " / " + #200#1 + " " + #200#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";
     |VENTANA 0501, 1350, -1, 16, aAlfa;
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SI PARAMETRO ! "BORRADOR";
         |PINPA #0#0;
         |PINDA #0#0;

         |ENDATOS #1#0;
     |SINO;
         FSalida = 0;
         |HAZ Tipo12;
     |FINSI;

     |PULSATECLA;
|FPRO;
