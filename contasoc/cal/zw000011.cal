|FICHEROS;
     zhazdocu #0;
     zw000011 #911;

     zregdocu #1;
     zregubic #3;

     :/contagen/def/ca8m0000 #420;
|FIN;

|VARIABLES;
     aAlfa           = "";
     aIPRemoto       = "";

     {30} aPopup     = "";

     &enCuadros      = 0;
     &efFechaMemoria = @;
     &efFechaCertif  = @;
     &enEjercicio    = 0;
     &eaDSMAC        = "";
|FIN;

|PROCESO Tipo0C5Fw11;  |TIPO 0;
     |ABRE #420;
     #420#0 = #911#5;
     |LEE 000#420=;
     |CIERRA #420

     |SI #420#2 = 1;  #911#12 = 18;  |FINSI;
     |SI #420#2 = 2;  #911#12 = 12;  |FINSI;
     |SI #420#2 = 3;  #911#12 = 10;  |FINSI;

     |PINTA #911#12;
|FPRC;

|PROCESO Tipo0C9Fw11;  |TIPO 0;
     |SI FSalida = 2;  |ACABA;  |FINSI;
     |SI FSalida = 3;  |ACABA;  |FINSI;

     |SI #911#9 = "1";
         |SI enCuadros = 0;
             |CONFI "0000NLos cuadros en la empresa ya existen, desea crearlos de nuevo";
             |SI FSalida ! 0;
                 #911#9 = "2";  |PINTA #911#9;
             |FINSI;
             |POSICIONATE #911#10;
         |FINSI;
     |FINSI;

     |PINTA #911#9;
|FPRC;

|PROCESO Tipo0C10Fw11;  |TIPO 0;
     |SI FSalida = 2;  |ACABA;  |FINSI;
     |SI FSalida = 3;  |ACABA;  |FINSI;

     |SI #911#10 = "1";
         |SI #1#4 = "S";
             |CONFI "0000NLa Memoria en la empresa ya existe, desea crearla de nuevo";
             |SI FSalida ! 0;
                 #911#10 = "2";
                 |POSICIONATE #911#13;
             |SINO;
                 |POSICIONATE #911#12;
             |FINSI;
         |FINSI;
     |FINSI;

     |C_M #911#12, 1, "S";
     |SI #911#10 = "2";
         |C_M #911#12, 1, "N";
     |FINSI;

     |PINTA #911#10;
     |PINTA #911#12;
|FPRC;

|PROCESO Tipo0C13Fw11;  |TIPO 0;
     |SI FSalida = 2;  |ACABA;  |FINSI;
     |SI FSalida = 3;  |ACABA;  |FINSI;

     |SI #911#13 = "1";
         |SI #1#8 = "S";
             |CONFI "0000NEl Informe de Gesti¢n en la empresa ya existe, desea crearlo de nuevo";
             |SI FSalida ! 0;
                 #911#13 = "2";
             |FINSI;
             |POSICIONATE #911#14;
         |FINSI;
     |FINSI;

     |PINTA #911#13;
|FPRC;

|PROCESO Tipo0C14Fw11;  |TIPO 0;
     |C_M #911#15, 1, "S";
     |C_M #911#16, 1, "S";
     |C_M #911#17, 1, "S";
     |C_M #911#20, 1, "S";
     |C_M #911#22, 1, "S";
     |C_M #911#23, 1, "S";

     |SI #911#14 = "2";
         |C_M #911#15, 1, "N";
         |C_M #911#16, 1, "N";
         |C_M #911#17, 1, "N";
         |C_M #911#20, 1, "N";  #911#20 = "N";
         |C_M #911#22, 1, "N";
         |C_M #911#23, 1, "N";  #911#23 = "N";
     |FINSI;

     |PINTA #911#15;
     |PINTA #911#16;
     |PINTA #911#17;
     |PINTA #911#20;
     |PINTA #911#22;
     |PINTA #911#23;
|FPRC;

|PROCESO Tipo0C18Fw11;  |TIPO 0;
     |SI #911#18 = "1";
         enEjercicio = #0#0;
         |HAZ CogeMac;

         |ABRE #3;
         #3#0 = #0#0;
         #3#1 = eaDSMAC;
         |LEE 000#3=;
         |SI FSalida ! 0;  |DDEFECTO #3;  |FINSI;
         |CIERRA #3;

         aAlfa = #3#3;  |QBT aAlfa;
         |SI aAlfa = "";
             |MENAV "0000Ubicaci¢n del deposito para el ejercicio no configurado.";
             #911#18 = "2";  |PINTA #911#18;
         |FINSI;

         |SI #911#5 = 20;  |O #911#4 = 21; |O #911#5 = 22;
             |MENAV "0000Empresa de cooperativa, no puede mandarse al registro digital";
             #911#18 = "2";  |PINTA #911#18;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C19Fw11;  |TIPO 0;
     |SI #0#0 [ 2010;
         |SI #911#19 = "C";
             |MENAV "0000No procede esta memoria. A partir del 2011";
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI #911#19 = "C";
         #911#16 = 10;  |PINTA #911#16;
     |FINSI;

     aAlfa = "N";
     |SI #0#0 ] 2018;
         aAlfa = "S";
         |SI #911#19 = "C";
             aAlfa = "N";
        |FINSI;
     |FINSI;
     |SI aAlfa = "N";
         #911#24 = "M";
         |PINTA #911#24;
     |FINSI;
    |C_M #911#24, 1, aAlfa;
|FPRC;

|PROCESO Tipo7C24Fw11; |TIPO 7;
    |HAZ Tipo0C19Fw11;
|FPRC;

|PROCESO Tipo66C16Crea;  |TIPO 66;
     aPopup1  = 0;
     aPopup2  = 10;
     aPopup3  = "01.- JUNTA NO UNIVERSAL ABREVIADA";
     aPopup4  = "02.- JUNTA NO UNIVERSAL NORMAL";
     aPopup5  = "03.- JUNTA NO UNIVERSAL SIN APROBACION";
     aPopup6  = "04.- JUNTA UNIVERSAL ABREVIADA";
     aPopup7  = "05.- JUNTA UNIVERSAL NORMAL";
     aPopup8  = "06.- JUNTA UNIVERSAL TRANSPARENCIA FISCAL ABREVIADA";
     aPopup9  = "07.- JUNTA UNIVERSAL TRANSPARENCIA FISCAL NORMAL";
     aPopup10 = "08.- JUNTA UNIVERSAL UNIPERSONAL ABREVIADA";
     aPopup11 = "09.- JUNTA UNIVERSAL SIN APROBACION";
     aPopup12 = "10.- ASAMBLEA COOPERATIVAS";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 102;

         #911#16 = aAlfa;  |PINTA #911#16;
     |FINSI;
|FPRC;

|PROCESO Tipo12Fw11;  |TIPO 12;
     |SI #911#11 ! "01.01.0000";  efFechaMemoria = #911#11;  |FINSI;
     |SI #911#15 ! "01.01.0000";  efFechaCertif  = #911#15;  |FINSI;
|FPRC;
