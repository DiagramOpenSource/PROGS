|FICHEROS;
     isom9000;
     isow9024,MANTE;

     trabajo@;
|FIN;

|VARIABLES;
     nNume        = 0;
     nPer         = 0;
     nPorce       = 0;
     nCampo       = 0;
     nContenido   = 0;
     nAdicio      = 0;

     aAlfa        = "";
     aBase        = "";
     aMas         = "";
|FIN;

|PROCESO Tipo12F9024;  |TIPO 12;
|FPRC;

|PROCESO TotalT7F9024;  |TIPO 7;
     nContenido = #isow9024#Campo#;
|FPRC;

|PROCESO Calcula9024;
     |SI #isow9024#75 = "N";
         nPorce = 23;
         |SI #isow9024#43 = "30   ";
             nPorce = 25;
         |FINSI;

         |SI Campo ! 52;
             nAdicio = #isow9024#76 + #isow9024#77 + #isow9024#78;
             nAdicio = nAdicio + #isow9024#79 + #isow9024#80 + #isow9024#81;
             nAdicio = nAdicio + #isow9024#82 + #isow9024#83 + #isow9024#84;

             #isow9024#52 = (#isow9024#15 - #isow9024#73 + #isow9024#74 - nAdicio) % nPorce;

             |SI #isow9024#31 ! 100;
                 #isow9024#52 = (#isow9024#52 % #isow9024#31) ! 2;
             |FINSI;

             #isow9024#52 = #isow9024#52 - #isow9024#32 - #isow9024#33;

             |SI #isow9024#52 < 0;
                 #isow9024#52 = 0;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #isow9024#43 = "00   ";
      |O #isow9024#43 = "01   ";
      |O #isow9024#43 = "10   ";
      |O #isow9024#61 = "S";
      |O #isow9024#38 = "0";
         |C_M #isow9024#52, 1, "N";  #isow9024#52 = 0;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 75;  |HACIENDO nCampo = nCampo + 1;
           #isom9000#nCampo# = #isow9024#nCampo#;
     |SIGUE;

     |HAZ Total202;

     |PARA nCampo = 0;  |SI nCampo [ 75;  |HACIENDO nCampo = nCampo + 1;
           #isow9024#nCampo# = #isom9000#nCampo#;
     |SIGUE;
|FPRC;

|PROCESO TotalF9024;  |TIPO 0;
     |SI nContenido = #isow9024#Campo#;
         |ACABA;
     |FINSI;

     |C_M #isow9024#52, 1, "S";

     |HAZ Calcula9024;

     |PINDA #0#isow9024;
|FPRC;

|PROCESO Tipo0C34F9024;  |TIPO 0;
     |POSICIONATE #isow9024#15;
|FPRC;

|PROCESO trabajo9024;
    #isow9024#33 = #isow9024#33 + #trabajo@#34;
|FPRC;

|DEFBUCLE trabajo9024;
     #trabajo@#1004;
     ;
     #isow9024#0, #isow9024#1, aAlfa, 00;
     #isow9024#0, #isow9024#1, aAlfa, 99;
     ;
     NULL, trabajo9024;
|FIN;

|PROCESO Tipo7C15F9024;  |TIPO 7;
     nContenido = #isow9024#Campo#;

     |C_M #isow9024#52, 1, "S";

     |SI #isow9024#2 = "1P";  |ACABA;  |FINSI;

     #isow9024#33 = 0;

     |DBASE aBase;  |QBF aBase;
     aMas = aBase + "def/isom9000.mas";
     |CARGA_DEF aMas, trabajo@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa   = #isow9024#2 % 102;
     nPer    = aAlfa;
     nPer    = nPer - 1;

     |PARA nNume = 1; |SI nNume [ nPer; |HACIENDO nNume = nNume + 1;
           aAlfa = nNume + "P";
           |BUCLE trabajo9024;
     |SIGUE;

     |DESCARGA_DEF #trabajo@;

     |PINTA #isow9024#33;
     |PINTA #isow9024#58;
     |PINTA #isow9024#59;
|FPRC;
