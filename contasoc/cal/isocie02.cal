|FICHEROS;
    isocie02 #0;
    isocie22 #1;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &tipo      = "";
    &modo      = 0;
    &clave     = 0;
    &clave1    = "";
    &numerica  = 0;
    &tecla     = 0;

    FEstado = 0;
    varcamp = 0;
    x       = 0;
    tecla_p   = "";
    avance  = "815";
    atras   = "814";
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    #0#2 = tipo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |HAZ liquidacio;
|FINSI;
|FPRC;

|PROCESO consulta;
  avance = &255 + avance;
  atras = &255 + atras;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
  |PINPA #0#0;
  |PINDA #0#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla_p;
  |SI tecla_p = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
  |PINPA #1#0;
  |PINDA #1#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla_p;
  |SI tecla_p = atras; |HAZ pantalla1; |ACABA; |FINSI;
|FPRC;

|PROCESO extenso; |TIPO 0;
|SI FSalida ! 9; |Y  #0Campo = Contenido; |Y |ACABA; |FINSI;

varcamp = Campo;
tecla   = FSalida;

|SI Campo = 17; |O Campo = 18; |HAZ linea1; |FINSI;
|SI Campo = 19; clave1 = "A"; |HAZ linea2;  |FINSI;
|SI Campo = 20; |HAZ linea3;  |FINSI;
|SI Campo = 21; clave1 = "B"; |HAZ linea2;  |FINSI;
|SI Campo = 22; |HAZ linea5;  |FINSI;
|SI Campo = 23; |HAZ linea6;  |FINSI;
|SI Campo = 24; |O Campo = 25; |HAZ linea7; |FINSI;
|SI Campo = 26; |O Campo = 27; |HAZ linea8; |FINSI;
|SI Campo = 28; |HAZ linea9;  |FINSI;
|SI Campo = 29; |HAZ linea10; |FINSI;
|SI Campo = 30; |HAZ linea11; |FINSI;
|SI Campo = 31; |O Campo = 32; clave1 = "C"; |HAZ linea2;  |FINSI;
|SI Campo = 33; |O Campo = 34; |HAZ linea13; |FINSI;
|SI Campo = 35; |O Campo = 36; |HAZ linea14; |FINSI;

|HAZ calculo;
Campo = varcamp;
|FPRC;

|PROCESO linea1;
clave = 701;
|SUB_EJECUTA "isocie03.run";
|SI numerica ] 0;
    #0#17 = numerica;
    #0#18 = 0;
|SINO;
    #0#18 = -numerica;
    #0#17 = 0;
|FINSI;
|PINTA #0#17;
|PINTA #0#18;
|FPRC;

|PROCESO linea2;
|SUB_EJECUTA "isocie12.run";
|SI Campo = 31; |O Campo = 32;
    |SI numerica > 0;
        #0#31 = numerica;
        #0#32 = 0;
        |PINTA #0#31;
        |PINTA #0#32;
    |SINO;
        #0#31 = 0;
        #0#32 = -numerica;
        |PINTA #0#31;
        |PINTA #0#32;
    |FINSI;
|SINO;
    #0Campo = numerica;
    |PINTA #0Campo;
|FINSI;
|FPRC;

|PROCESO linea3;
clave = 704;
|SUB_EJECUTA "isocie03.run";
#0#20 = numerica;
|PINTA #0#20;
|FPRC;

|PROCESO linea4;
clave = 705;
|SUB_EJECUTA "isocie03.run";
#0#21 = numerica;
|PINTA #0#21;
|FPRC;

|PROCESO linea5;
|SUB_EJECUTA "isocie14.run";
#0#22 = numerica;
|PINTA #0#22;
|FPRC;

|PROCESO linea6;
|SUB_EJECUTA "isocie15.run";
#0#23 = numerica;
|PINTA #0#23;
|FPRC;

|PROCESO linea7;
|SUB_EJECUTA "isocie13.run";
|SI numerica ] 0;
    #0#24 = numerica;
    #0#25 = 0;
|SINO;
    #0#24 = 0;
    #0#25 = -numerica;
|FINSI;
|PINTA #0#24;
|PINTA #0#25;
|FPRC;

|PROCESO linea8;
clave = 710;
|SUB_EJECUTA "isocie03.run";
|SI numerica ] 0;
    #0#26 = numerica;
    #0#27 = 0;
|SINO;
    #0#27 = -numerica;
    #0#26 = 0;
|FINSI;
|PINTA #0#26;
|PINTA #0#27;
|FPRC;

|PROCESO linea9;
clave = 712;
|SUB_EJECUTA "isocie03.run";
#0#28 = numerica;
|PINTA #0#28;
|FPRC;

|PROCESO linea10;
clave = 713;
|SUB_EJECUTA "isocie03.run";
#0#29 = numerica;
|PINTA #0#29;
|FPRC;

|PROCESO linea11;
|SUB_EJECUTA "isocie04.run";
#0#30 = numerica;
|PINTA #0#30;
|FPRC;
|FPRC;

|PROCESO linea12;
clave = 715;
|SUB_EJECUTA "isocie03.run";
|SI numerica ] 0;
    #0#31 = numerica;
    #0#32 = 0;
|SINO;
   #0#32 = -numerica;
   #0#31 = 0;
|FINSI;
|PINTA #0#31;
|PINTA #0#32;
|FPRC;

|PROCESO linea13;
clave = 717;
|SUB_EJECUTA "isocie03.run";
|SI numerica ] 0;
    #0#33 = numerica;
    #0#34 = 0;
|SINO;
    #0#34 = -numerica;
    #0#33 = 0;
|FINSI;
|PINTA #0#33;
|PINTA #0#34;
|FPRC;

|PROCESO linea14;
clave = 719;
|SUB_EJECUTA "isocie03.run";
|SI numerica ] 0;
    #0#35 = numerica;
    #0#36 = 0;
|SINO;
   #0#36 = -numerica;
   #0#35 = 0;
|FINSI;
|PINTA #0#35;
|PINTA #0#36;
|FPRC;

|PROCESO calculo; |TIPO 0;
#0#7  = #0#3  + #0#4  + #0#5  + #0#6;
|PINTA #0#7;

#0#16 = #0#8  + #0#9  + #0#10 + #0#11 + #0#12 + #0#13 + #0#14 + #0#15;
|PINTA #0#16;

#0#37 = #0#17 + #0#19 + #0#20 + #0#23 + #0#24 + #0#26 + #0#28 + #0#29 + #0#31 + #0#33 + #0#35;

#0#38 = #0#18 + #0#21 + #0#22 + #0#25 + #0#27 + #0#30 + #0#32 + #0#34 + #0#36;

|FPRC;

|PROCESO liquidacio;
|ABRE #1;
#1#0 = #0#0;
#1#1 = #0#1;
|LIBERA #1;
|LEE 110#1=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #1; #1#0 = #0#0; #1#1 = #0#1; |FINSI;

#1#3 = #0#37;
#1#4 = #0#38;
#1#5 = #1#3 - #1#4;

|SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
|CIERRA #1;
|SUB_EJECUTA "ispant31.run";
|FPRC;
