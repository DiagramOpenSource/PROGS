|FICHEROS;
    isocie52 #0;
    isocie46 #1;
    isocie30 #2;
    isocie06 #3;
    isocie38 #4;
    isocie09 #5;
    isocie10 #6;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &modo      = 0;

    porce   = 0;
    sw      = 0;
    campo1  = 0;
    campo2  = 0;
    campo3  = 0;
    FEstado = 0;
    varcamp = 0;
    x       = 0;
    tecla   = "";
    avance  = "815";
    atras   = "814";

    trab1 = 0;
    trab2 = 0;
    trab3 = 0;
    trab4 = 0;
    trab5 = 0;
    acum1 = 0;
    acum2 = 0;
    acum3 = 0;
    importe  = 0;
    resto  = 0;
    var   = 0;
    hasta = 0;
    xxx   = 0;

    p_d1  = 0;
    p_d2  = 0;
    p_d3  = 0;
    p_d4  = 0;
    p_d5  = 0;
    p_d6  = 0;
    p_d7  = 0;
    p_d8  = 0;
    p_d9  = 0;
    p_d10 = 0;
    p_d11 = 0;
    p_d12 = 0;
    p_d13 = 0;
    p_d14 = 0;
    p_d15 = 0;

    dedu1  = 0;
    dedu2  = 0;
    dedu3  = 0;
    dedu4  = 0;
    dedu5  = 0;
    dedu6  = 0;
    dedu7  = 0;
    dedu8  = 0;
    dedu9  = 0;
    dedu10 = 0;
    dedu11 = 0;
    dedu12 = 0;
    dedu13 = 0;
    dedu14 = 0;
    dedu15 = 0;

    &EURODB = 0;
|FIN;

|PROGRAMA;
|HAZ LeeEURODB;

|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|CONFI "2321NDesea hacer el calculo de las deducciones : ";
|SI FSalida = 0; |HAZ ajustando; |FINSI;

|PINPA #0#0;
|PINTA 2301,"лл";
|PINDA #0#0;
|HAZ resultad;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |CIERRA #0;
    |HAZ liquidacio;
|FINSI;
|FPRC;

|PROCESO consulta;
  avance = &255 + avance;
  atras = &255 + atras;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
  |PINPA #0#0;
  |PINDA #0#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
  |PINPA #1#0;
  |PINDA #1#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
  |PINPA #2#0;
  |PINDA #2#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
  |PINPA #3#0;
  |PINDA #3#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
  |PINPA #4#0;
  |PINDA #4#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO resultad; |TIPO 0;
|SI #0Campo = Contenido; |ACABA; |FINSI;

sw      = 0;
varcamp = Campo;
|SI varcamp = 002; |O varcamp = 003; campo3 = 004; sw = 1; |FINSI;
|SI varcamp = 005; |O varcamp = 006; campo3 = 007; sw = 1; |FINSI;
|SI varcamp = 008; |O varcamp = 009; campo3 = 010; sw = 1; |FINSI;
|SI varcamp = 011; |O varcamp = 012; campo3 = 013; sw = 1; |FINSI;
|SI varcamp = 014; |O varcamp = 015; campo3 = 016; sw = 1; |FINSI;
|SI varcamp = 017; |O varcamp = 018; campo3 = 019; sw = 1; |FINSI;
|SI varcamp = 020; |O varcamp = 021; campo3 = 022; sw = 1; |FINSI;
|SI varcamp = 023; |O varcamp = 024; campo3 = 025; sw = 1; |FINSI;
|SI varcamp = 026; |O varcamp = 027; campo3 = 028; sw = 1; |FINSI;
|SI varcamp = 029; |O varcamp = 030; campo3 = 031; sw = 1; |FINSI;
|SI varcamp = 035; |O varcamp = 036; campo3 = 037; sw = 1; |FINSI;
|SI varcamp = 038; |O varcamp = 039; campo3 = 040; sw = 1; |FINSI;
|SI varcamp = 041; |O varcamp = 042; campo3 = 043; sw = 1; |FINSI;
|SI varcamp = 044; |O varcamp = 045; campo3 = 046; sw = 1; |FINSI;
|SI varcamp = 047; |O varcamp = 048; campo3 = 049; sw = 1; |FINSI;
|SI varcamp = 050; |O varcamp = 051; campo3 = 052; sw = 1; |FINSI;
|SI varcamp = 053; |O varcamp = 054; campo3 = 055; sw = 1; |FINSI;
|SI varcamp = 059; |O varcamp = 060; campo3 = 061; sw = 1; |FINSI;
|SI varcamp = 062; |O varcamp = 063; campo3 = 064; sw = 1; |FINSI;
|SI varcamp = 065; |O varcamp = 066; campo3 = 067; sw = 1; |FINSI;
|SI varcamp = 068; |O varcamp = 069; campo3 = 070; sw = 1; |FINSI;
|SI varcamp = 071; |O varcamp = 072; campo3 = 073; sw = 1; |FINSI;
|SI varcamp = 074; |O varcamp = 075; campo3 = 076; sw = 1; |FINSI;
|SI varcamp = 077; |O varcamp = 078; campo3 = 079; sw = 1; |FINSI;
|SI varcamp = 080; |O varcamp = 081; campo3 = 082; sw = 1; |FINSI;
|SI varcamp = 083; |O varcamp = 084; campo3 = 085; sw = 1; |FINSI;
|SI varcamp = 086; |O varcamp = 087; campo3 = 088; sw = 1; |FINSI;
|SI varcamp = 092; |O varcamp = 093; campo3 = 094; sw = 1; |FINSI;
|SI varcamp = 095; |O varcamp = 096; campo3 = 097; sw = 1; |FINSI;
|SI varcamp = 098; |O varcamp = 099; campo3 = 100; sw = 1; |FINSI;
|SI varcamp = 101; |O varcamp = 102; campo3 = 103; sw = 1; |FINSI;
|SI varcamp = 104; |O varcamp = 105; campo3 = 106; sw = 1; |FINSI;
|SI varcamp = 107; |O varcamp = 108; campo3 = 109; sw = 1; |FINSI;
|SI varcamp = 113; |O varcamp = 114; campo3 = 115; sw = 1; |FINSI;
|SI varcamp = 116; |O varcamp = 117; campo3 = 118; sw = 1; |FINSI;
|SI varcamp = 119; |O varcamp = 120; campo3 = 121; sw = 1; |FINSI;
|SI varcamp = 122; |O varcamp = 123; campo3 = 124; sw = 1; |FINSI;
|SI varcamp = 128; |O varcamp = 129; campo3 = 130; sw = 1; |FINSI;
|SI varcamp = 131; |O varcamp = 132; campo3 = 133; sw = 1; |FINSI;
|SI varcamp = 134; |O varcamp = 135; campo3 = 136; sw = 1; |FINSI;
|SI varcamp = 137; |O varcamp = 138; campo3 = 139; sw = 1; |FINSI;

|SI sw = 1;
    campo1 = campo3 - 2;
    campo2 = campo3 - 1;
    #0campo3 = #0campo1 - #0campo2;
    |PINTA #0campo3;
|FINSI;

#0#32 = 0;
#0#33 = 0;
#0#34 = 0;
|PARA xxx = 2; |SI xxx [ 29; |HACIENDO xxx = xxx + 1;
                     #0#32 = #0#32 + #0xxx;
      xxx = xxx + 1; #0#33 = #0#33 + #0xxx;
      xxx = xxx + 1; #0#34 = #0#34 + #0xxx;
|SIGUE;

#0#32 = #0#32 + #0#143 + #0#146;
#0#33 = #0#33 + #0#144 + #0#147;
#0#34 = #0#34 + #0#145 + #0#148;

#0#56 = 0;
#0#57 = 0;
#0#58 = 0;
|PARA xxx = 35; |SI xxx [ 53; |HACIENDO xxx = xxx + 1;
                     #0#56 = #0#56 + #0xxx;
      xxx = xxx + 1; #0#57 = #0#57 + #0xxx;
      xxx = xxx + 1; #0#58 = #0#58 + #0xxx;
|SIGUE;

#0#89 = 0;
#0#90 = 0;
#0#91 = 0;
|PARA xxx = 59; |SI xxx [ 86; |HACIENDO xxx = xxx + 1;
                     #0#89 = #0#89 + #0xxx;
      xxx = xxx + 1; #0#90 = #0#90 + #0xxx;
      xxx = xxx + 1; #0#91 = #0#91 + #0xxx;
|SIGUE;

#0#110 = 0;
#0#111 = 0;
#0#112 = 0;
|PARA xxx = 92; |SI xxx [ 107; |HACIENDO xxx = xxx + 1;
                     #0#110 = #0#110 + #0xxx;
      xxx = xxx + 1; #0#111 = #0#111 + #0xxx;
      xxx = xxx + 1; #0#112 = #0#112 + #0xxx;
|SIGUE;

#0#125 = 0;
#0#126 = 0;
#0#127 = 0;
|PARA xxx = 113; |SI xxx [ 122; |HACIENDO xxx = xxx + 1;
                     #0#125 = #0#125 + #0xxx;
      xxx = xxx + 1; #0#126 = #0#126 + #0xxx;
      xxx = xxx + 1; #0#127 = #0#127 + #0xxx;
|SIGUE;

#0#140 = 0;
#0#141 = 0;
#0#142 = 0;
|PARA xxx = 128; |SI xxx [ 137; |HACIENDO xxx = xxx + 1;
                     #0#140 = #0#140 + #0xxx;
      xxx = xxx + 1; #0#141 = #0#141 + #0xxx;
      xxx = xxx + 1; #0#142 = #0#142 + #0xxx;
|SIGUE;

|PINTA #0#32;
|PINTA #0#33;
|PINTA #0#34;
|PINTA #0#56;
|PINTA #0#57;
|PINTA #0#58;
|PINTA #0#89;
|PINTA #0#90;
|PINTA #0#91;
|PINTA #0#110;
|PINTA #0#111;
|PINTA #0#112;
|PINTA #0#125;
|PINTA #0#126;
|PINTA #0#127;
|PINTA #0#140;
|PINTA #0#141;
|PINTA #0#142;

Campo = varcamp;
|FPRC;

|PROCESO liquidacio;
|SUB_EJECUTA "isz00005.run";
|FPRC;

|| ************************************************************************
||                    CALCULOS
|| ************************************************************************

|PROCESO ficher2;
|SI #2#8 = "S";
    |SI #2#3 = 90; #0#149 = #0#149 + #2#7; p_d1 = #2#4; |FINSI;
    |SI #2#3 = 91; #0#150 = #0#150 + #2#7; p_d2 = #2#4; |FINSI;
    |SI #2#3 = 92; #0#151 = #0#151 + #2#7; p_d3 = #2#4; |FINSI;
    |SI #2#3 = 93; #0#152 = #0#152 + #2#7; p_d4 = #2#4; |FINSI;
    |SI #2#3 = 94;
        #0#153 = #0#153 + #2#7;
        |SI #2#9 = 1; p_d5  = #2#4; |FINSI;
        |SI #2#9 = 2; p_d12 = #2#4; |FINSI;
        |SI #2#9 = 3; p_d13 = #2#4; |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO ficher3;
|SI #3#9 = "S";
    |SI #3#4 = 35; #0#154 = #0#154 + #3#8; |FINSI;
    |SI #3#4 = 25; #0#166 = #0#166 + #3#8; |FINSI;

    |SI #3#3 = "AF"; p_d6  = #3#4; |FINSI;
    |SI #3#3 = "EL"; p_d6  = #3#4; |FINSI;
    |SI #3#3 = "GA"; p_d7  = #3#4; |FINSI;
    |SI #3#3 = "GI"; p_d7  = #3#4; |FINSI;
    |SI #3#3 = "PC"; p_d8  = #3#4; |FINSI;
    |SI #3#3 = "BI"; p_d9  = #3#4; |FINSI;
    |SI #3#3 = "AE"; p_d10 = #3#4; |FINSI;
    |SI #3#3 = "FP"; p_d11 = #3#4; |FINSI;
|FINSI;
|FPRC;

|PROCESO ficher4;
|SI #4#10 = "S";
    |SI #4#3 = "E"; #0#155 = #0#155 + #4#9; |FINSI;
    |SI #4#3 = "J"; #0#156 = #0#156 + #4#9; |FINSI;
    |SI #4#3 = "M"; #0#157 = #0#157 + #4#9; |FINSI;
    |SI #4#3 = "3"; #0#158 = #0#158 + #4#9; |FINSI;
    |SI #4#3 = "1"; #0#159 = #0#159 + #4#9; |FINSI;
    |SI #4#3 = "2"; #0#167 = #0#167 + #4#9; |FINSI;
    |SI #4#3 = "1";
        |SI #4#4 = 94; p_d14  = #4#5; |FINSI;
        |SI #4#4 = 95; p_d15  = #4#5; |FINSI;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO ficher5;
|SI #5#7 = "S";
    |SI #5#3 = 90; #0#160 = #0#160 + #5#6; |FINSI;
    |SI #5#3 = 91; #0#161 = #0#161 + #5#6; |FINSI;
    |SI #5#3 = 92; #0#162 = #0#162 + #5#6; |FINSI;
    |SI #5#3 = 93; #0#163 = #0#163 + #5#6; |FINSI;
    |SI #5#3 = 94; #0#164 = #0#164 + #5#6; |FINSI;
|FINSI;
|FPRC;

|PROCESO ficher6;
#0#165 = #0#165 + #6#17;
|FPRC;

|DEFBUCLE isocie05;
#2#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ficher2;
|FIN;

|DEFBUCLE isocie06;
#3#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ficher3;
|FIN;

|DEFBUCLE isocie38;
#4#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ficher4;
|FIN;

|DEFBUCLE isocie09;
#5#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, ficher5;
|FIN;

|DEFBUCLE isocie10;
#6#1;
;
empresa, anyo;
empresa, anyo;
e;
NULL, ficher6;
|FIN;

|PROCESO ajustando;
|CUADRO 1114 1664;
|ATRI R;
|PINTA 1215, " Revisar los limites de deduccion del aЄo actual ";
|PINTA 1315, " ya que antes ponia el 25% en algunos conceptos  ";
|PINTA 1415, " cuando podria ser el 35% o el 25% segun que     ";
|PINTA 1515, " conceptos.                                      ";
|ATRI r;
|PAUSA;

|ATRI P;
|MENSA "2330 Calculando ";
|ATRI p;

|PARA xxx = 149; |SI xxx [ 167; |HACIENDO xxx = xxx + 1;
      #0xxx = 0;
|SIGUE;

|BUCLE  isocie05;
|BUCLE  isocie06;
|BUCLE  isocie38;
|BUCLE  isocie09;
|BUCLE  isocie10;

|ABRE #1;
#1#0 = empresa; #1#1 = anyo;
|LEE 040#1=;
|SI FSalida = 0; |Y #1#32 > 0;
  trab1 = (#1#32 % 25) ! EURODB;
  trab2 = (#1#32 % 20) ! EURODB;
  trab3 = #1#32;
  trab4 = (#1#32 % 55) ! EURODB;
  trab5 = (#1#32 % 35) ! EURODB;

  |SI p_d1  = 0; p_d1  = 25; |FINSI;
  |SI p_d2  = 0; p_d2  = 25; |FINSI;
  |SI p_d3  = 0; p_d3  = 25; |FINSI;
  |SI p_d4  = 0; p_d4  = 25; |FINSI;
  |SI p_d5  = 0; p_d5  = 35; |FINSI;
  |SI p_d6  = 0; p_d6  = 35; |FINSI;
  |SI p_d7  = 0; p_d7  = 35; |FINSI;
  |SI p_d8  = 0; p_d8  = 35; |FINSI;
  |SI p_d9  = 0; p_d9  = 35; |FINSI;
  |SI p_d10 = 0; p_d10 = 25; |FINSI;
  |SI p_d11 = 0; p_d11 = 25; |FINSI;
  |SI p_d12 = 0; p_d12 = 25; |FINSI;
  |SI p_d13 = 0; p_d13 = 25; |FINSI;
  |SI p_d14 = 0; p_d14 = 55; |FINSI;
  |SI p_d15 = 0; p_d15 = 55; |FINSI;

  dedu1  = (#1#32 % p_d1)  ! EURODB;
  dedu2  = (#1#32 % p_d2)  ! EURODB;
  dedu3  = (#1#32 % p_d3)  ! EURODB;
  dedu4  = (#1#32 % p_d4)  ! EURODB;
  dedu5  = (#1#32 % p_d5)  ! EURODB;
  dedu6  = (#1#32 % p_d6)  ! EURODB;
  dedu7  = (#1#32 % p_d7)  ! EURODB;
  dedu8  = (#1#32 % p_d8)  ! EURODB;
  dedu9  = (#1#32 % p_d9)  ! EURODB;
  dedu10 = (#1#32 % p_d10) ! EURODB;
  dedu11 = (#1#32 % p_d11) ! EURODB;
  dedu12 = (#1#32 % p_d12) ! EURODB;
  dedu13 = (#1#32 % p_d13) ! EURODB;
  dedu14 = (#1#32 % p_d14) ! EURODB;
  dedu15 = (#1#32 % p_d15) ! EURODB;

  acum1 = 0; acum2 = 0; acum3 = 0;

  sw = 0;

  || AЄo 90

  campo1 = 2;     importe = dedu1; hasta = #0#149; |HAZ ajusta1;

  || AЄo 91

  campo1 = 8;     importe = dedu2; hasta = #0#150; |HAZ ajusta1;

  || AЄo 92

  campo1 = 14;    importe = dedu3; hasta = #0#151; |HAZ ajusta1;

  || AЄo 93

  campo1 = 20;    importe = dedu4; hasta = #0#152; |HAZ ajusta1;

  || AЄo 94

  campo1 = 26;    importe = dedu5; hasta = #0#153; |HAZ ajusta1;
  campo1 = 143;   importe = dedu12;                |HAZ ajusta1;
  campo1 = 146;   importe = dedu13;                |HAZ ajusta1;

  || AЄo 95

  campo1 = 35;    importe = dedu6;  hasta = #0#154; |HAZ ajusta1;
  campo1 = 38;    importe = dedu7;                  |HAZ ajusta1;
  campo1 = 41;    importe = dedu8;                  |HAZ ajusta1;
  campo1 = 47;    importe = dedu9;                  |HAZ ajusta1;

  acum1  = 0;
  campo1 = 44;    importe = dedu10; hasta = #0#166; |HAZ ajusta1;

  acum1  = 0;
  campo1 = 50;    importe = dedu11;                 |HAZ ajusta1;

  || Creacion de empleo

  campo1 = 92;   importe = trab3; hasta = #0#160; |HAZ ajusta2;
  campo1 = 95;   importe = trab3; hasta = #0#161; |HAZ ajusta2;
  campo1 = 98;   importe = trab3; hasta = #0#162; |HAZ ajusta2;
  campo1 = 101;  importe = trab3; hasta = #0#163; |HAZ ajusta2;
  campo1 = 104;  importe = trab3; hasta = #0#164; |HAZ ajusta2;
  campo1 = 107;  importe = trab3; hasta = #0#165; |HAZ ajusta2;

  || Deducciones Expo

  acum1  = 0;
  campo1 = 59;    importe = trab1; hasta = #0#155; |HAZ ajusta1;
  campo1 = 62;    importe = trab1;                 |HAZ ajusta1;
  campo1 = 65;    importe = trab1;                 |HAZ ajusta1;

  || Deducciones JJOO

  acum1 = 0;
  campo1 = 68;    importe = trab1; hasta = #0#156; |HAZ ajusta1;
  campo1 = 71;    importe = trab1;                 |HAZ ajusta1;
  campo1 = 74;    importe = trab1;                 |HAZ ajusta1;

  || Deducciones Madrid

  acum1 = 0;
  campo1 = 77;    importe = trab1; hasta = #0#157; |HAZ ajusta1;
  campo1 = 80;    importe = trab1;                 |HAZ ajusta1;
  campo1 = 83;    importe = trab1;                 |HAZ ajusta1;

  || Deducciones AЄo Santo

  acum1 = 0;
  campo1 = 86;    importe = trab1; hasta = #0#158; |HAZ ajusta1;

  || Deducciones Canarias

  acum1 = 0;
  campo1 = 113;   importe = trab4;  hasta = #0#159; |HAZ ajusta1;
  campo1 = 116;   importe = trab4;                  |HAZ ajusta1;
  campo1 = 119;   importe = dedu14;                 |HAZ ajusta1;
  campo1 = 122;   importe = dedu15;                 |HAZ ajusta1;

  || Deducciones Cartuja

  acum1  = 0;
  campo1 = 128;   importe = trab1; hasta = #0#167; |HAZ ajusta1;
  campo1 = 131;   importe = trab1;                 |HAZ ajusta1;
  campo1 = 134;   importe = trab1;                 |HAZ ajusta1;
  campo1 = 137;   importe = trab1;                 |HAZ ajusta1;
|FINSI;

|CIERRA #1;
|FPRC;

|PROCESO ajusta1;
campo2   = campo1 + 1;
campo3   = campo1 + 2;
#0campo3 = #0campo1;
#0campo2 = 0;
resto    = importe - acum1;
var      = #1#32   - acum1;

|SI resto    > var;      resto = var; |FINSI;
|SI hasta    [ 0;        |ACABA;      |FINSI;
|SI resto    [ 0;        |ACABA;      |FINSI;
|SI #0campo1 = 0;        |ACABA;      |FINSI;
|SI hasta    < #0campo1; |ACABA;      |FINSI;

|SI #0campo1 ] resto;
    #0campo2 = resto;
    #0campo3 = #0campo1 - #0campo2;
    acum1    = acum1 + #0campo2;
    acum3    = acum3 + #0campo2;
|SINO;
    #0campo2 = #0campo1;
    #0campo3 = 0;
    acum1    = acum1 + #0campo1;
    acum3    = acum3 + #0campo1;
|FINSI;

hasta = hasta - #0campo1;
|SI hasta < 0; hasta = 0; |FINSI;
|FPRC;

|PROCESO ajusta2;
campo2   = campo1 + 1;
campo3   = campo1 + 2;
#0campo3 = #0campo1;
#0campo2 = 0;
resto    = importe - (acum2 + acum3);

|SI hasta    [ 0;        |ACABA;      |FINSI;
|SI resto    [ 0;        |ACABA;      |FINSI;
|SI #0campo1 = 0;        |ACABA;      |FINSI;
|SI hasta    < #0campo1; |ACABA;      |FINSI;

|SI #0campo1 ] resto;
    #0campo2 = resto;
    #0campo3 = #0campo1 - #0campo2;
    acum2    = acum2 + #0campo2;
|SINO;
    #0campo2 = #0campo1;
    #0campo3 = #0campo1 - #0campo2;
    acum2    = acum2 + #0campo2;
|FINSI;

hasta = hasta - #0campo2;
|SI hasta < 0; hasta = 0; |FINSI;
|FPRC;
