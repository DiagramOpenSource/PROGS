|FICHEROS;
    isocie21 #0;
    isocie29 #1;
    isocie22 #2;
    isocie36 #3;
    isocie46 #4;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &modo      = 0;

    FEstado = 0;
    varcamp = 0;
    x       = 0;
    suma    = 0;
    resta   = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |HAZ isocie29; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |CIERRA #0;
    |HAZ liquidacio;
|FINSI;
|FPRC;

|PROCESO consulta;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0;
     |PINPA #0#0;
     |PINDA #0#0;
     |PAUSA;
  |FINSI;
|FPRC;

|PROCESO modificar; |TIPO 0;
|SI #0#2 = "S";
    |CAMPO_MODIFICA #0#7,  1, "S";
    |CAMPO_MODIFICA #0#8,  1, "S";
    |CAMPO_MODIFICA #0#9,  1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#15, 1, "S";
    |CAMPO_MODIFICA #0#16, 1, "S";
    |CAMPO_MODIFICA #0#17, 1, "S";
    |CAMPO_MODIFICA #0#18, 1, "S";
    |CAMPO_MODIFICA #0#19, 1, "S";
    |CAMPO_MODIFICA #0#20, 1, "S";
|SINO;
    |CAMPO_MODIFICA #0#7,  1, "N"; #0#07 = 0; |PINTA #0#7;
    |CAMPO_MODIFICA #0#8,  1, "N"; #0#08 = 0; |PINTA #0#8;
    |CAMPO_MODIFICA #0#9,  1, "N"; #0#09 = 0; |PINTA #0#9;
    |CAMPO_MODIFICA #0#11, 1, "N"; #0#11 = 0; |PINTA #0#11;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = 0; |PINTA #0#13;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = 0; |PINTA #0#15;
    |CAMPO_MODIFICA #0#16, 1, "N"; #0#16 = 0; |PINTA #0#16;
    |CAMPO_MODIFICA #0#17, 1, "N"; #0#17 = 0; |PINTA #0#17;
    |CAMPO_MODIFICA #0#18, 1, "N"; #0#18 = 0; |PINTA #0#18;
    |CAMPO_MODIFICA #0#19, 1, "N"; #0#19 = 0; |PINTA #0#19;
    |CAMPO_MODIFICA #0#20, 1, "N"; #0#20 = 0; |PINTA #0#20;
|FINSI;
|FPRC;

|PROCESO filtro;
|SI #0#16 > #0#15;
    |MENAV "     No puede ser superior al volumen total de operaciones";
    |ERROR;
|FINSI;
suma = #0#17 + #0#18 + #0#19 + #0#20;
resta = #0#15 - #0#16;
|SI suma > resta;
    |MENAV "     No puede ser superior al volumen total - extranjeros";
    |ERROR;
|FINSI;
|FPRC;

|PROCESO isocie29;
|ABRE #1;
#1#0 = #0#0;
#1#1 = #0#1;
|LEE 040#1=;
|SI FSalida = 0;
    #0#4 = #1#6;
    #0#5 = #1#7;
    #0#6 = #1#8;
|FINSI;
|CIERRA #1;
|FPRC;

|PROCESO liquidacio;
|SI anyo = 1992;
    |ABRE #2;
    #2#0 = #0#0;
    #2#1 = #0#1;
    |LIBERA #2;
    |LEE 110#2=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #2; #2#0 = #0#0; #2#1 = #0#1; |FINSI;

    |SI #0#3 = "R"; #2#16 = "X"; |SINO; #2#16 = " "; |FINSI;
    |SI #0#2 = "S"; #2#42 = "X"; |SINO; #2#42 = " "; |FINSI;
    #2#66 = #0#14;
    #2#62 = (#0#17 / (#0#15 - #0#16)) * 100;
    #2#63 = (#0#18 / (#0#15 - #0#16)) * 100;
    #2#64 = (#0#19 / (#0#15 - #0#16)) * 100;
    #2#65 = (#0#20 / (#0#15 - #0#16)) * 100;
    #2#61 = 100 - #2#62 - #2#63 - #2#64 - #2#65;
    #2#43 = (#2#61 / 100) * (#2#40 - #2#41);
    #2#44 = ((#2#62 + #2#63 + #2#64 + #2#65) / 100) * (#2#40 - #2#41);
    #2#45 = #0#4;
    #2#47 = #0#5;
    #2#49 = #0#6;
    #2#46 = #0#7;
    #2#48 = #0#8;
    #2#50 = #0#9;
    #2#51 = #2#43 - #2#45 - #2#47 - #2#49;
    #2#52 = #2#44 - #2#46 - #2#48 - #2#50;
    #2#53 = #0#10;
    #2#54 = #0#11;
    #2#55 = (#2#51 + #2#53) % #0#14;
    #2#56 = (#2#52 + #2#54) % #0#14;
    #2#57 = #0#12;
    #2#58 = #0#13;

    |SI FEstado = 0; |GRABA 020#2a; |SINO; |GRABA 020#2n; |FINSI;
    |CIERRA #2;

    |SUB_EJECUTA "ispant31.run";
|FINSI;

|SI anyo = 1993;
    |ABRE #3;
    #3#0 = #0#0;
    #3#1 = #0#1;
    |LIBERA #3;
    |LEE 110#3=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #3; #3#0 = #0#0; #3#1 = #0#1; |FINSI;

    |SI #0#3 = "R"; #3#16 = "X"; |SINO; #3#16 = " "; |FINSI;
    |SI #0#2 = "S"; #3#42 = "X"; |SINO; #3#42 = " "; |FINSI;
    #3#66 = #0#14;
    #3#62 = (#0#17 / (#0#15 - #0#16)) * 100;
    #3#63 = (#0#18 / (#0#15 - #0#16)) * 100;
    #3#64 = (#0#19 / (#0#15 - #0#16)) * 100;
    #3#65 = (#0#20 / (#0#15 - #0#16)) * 100;
    #3#61 = 100 - #3#62 - #3#63 - #3#64 - #3#65;
    #3#43 = (#3#61 / 100) * (#3#40 - #3#41);
    #3#44 = ((#3#62 + #3#63 + #3#64 + #3#65) / 100) * (#3#40 - #3#41);
    #3#45 = #0#4;
    #3#47 = #0#5;
    #3#49 = #0#6;
    #3#46 = #0#7;
    #3#48 = #0#8;
    #3#50 = #0#9;
    #3#51 = #3#43 - #3#45 - #3#47 - #3#49;
    #3#52 = #3#44 - #3#46 - #3#48 - #3#50;
    #3#53 = #0#10;
    #3#54 = #0#11;
    #3#55 = (#3#51 + #3#53) % #0#14;
    #3#56 = (#3#52 + #3#54) % #0#14;
    #3#57 = #0#12;
    #3#58 = #0#13;

    |SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
    |CIERRA #3;

    |SUB_EJECUTA "ispant31.run";
|FINSI;

|SI anyo ] 1994; |Y anyo < 1996; |SUB_EJECUTA "isz00005"; |FINSI;
|FPRC;
