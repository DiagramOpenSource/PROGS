|FICHEROS;
     isoz0002;

     isacceso;
     maempr10;
     maempr11;

     isom0000;
     isom0001;
     isom0002;
     isom0003;
     isom0004;
     isom0005;
     isom0006;
     isom0009;
     isom0010;
     isom0011;
     isom0016;
     isom0017;
     isom0018;
     isom0019;
     isom0020;
     isom0021;
     isom0022;
     isom0023;
     isom0026;
     isom0027;
     isom0028;
     isom0205;
     zregdocu;

     isozw001;
|FIN;

|INCLUYE incca8m0;

|VARIABLES;
     aCasilla       = "";
     aAlfa          = "";

     nValor         = 0;
     nValor1        = 0;
     nValor2        = 0;
     nValor3        = 0;
     nValor520      = 0;
     nValor521      = 0;
     nValor523      = 0;
     nValor552      = 0;
     nImpor1        = 0;
     nImpor2        = 0;
     nImpor3        = 0;
     nExiste        = 0;
     nSuma          = 0;
     nVent          = 0;
     nPanta         = 0;
     nHayECPNII     = 0;
     nHayAdicional  = 0;
     nResta         = 0;
     nPorce         = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &enNavieras     = 0;
     &enCooperativa  = 0;
     &enTranspa      = 0;
     &enZEC          = 0;
     &enSOCIMI       = 0;
     &enPeqDimen     = 0;
     &enNovaCrea     = 0;
     &enForales      = 0;
     &enInactiva     = 0;
     &enError        = 0;
     &enAviso        = 0;
     &eaError        = "";
     &enSwLinea      = 0;
     &eaSwLinea      = "";
     nCError         = 0;
     nCAviso         = 0;

     aError          = "";
     nError          = 0;
     aFichero        = "";
     nGraba          = 0;
     nCas049         = 0;
     nCas258         = 0;
|FIN;

|INCLUYE varbal_i;

|PROCESO PonColorBandeja;
     |ABRE #isacceso;
     #isacceso#0  = enEmpresa;
     #isacceso#1  = enAnyo;
     |LEE 101#isacceso.=;
     |SI FSalida ! 0;
         |CIERRA #isacceso;
         |ACABA;
     |FINSI;

                            #isacceso#9 = "";
     |SI enAviso ! 0;       #isacceso#9 = eaAzul;  |FINSI;
     |SI enError ! 0;       #isacceso#9 = eaRojo;  |FINSI;
     |SI #isacceso#6 = "S"; #isacceso#9 = eaVerde;  |FINSI;

     |ABRE #isom0001;
     |SELECT #2#isom0001;
     #isom0001#0 = #isacceso#0;
     #isom0001#1 = #isacceso#1;
     #isom0001#3 = "621";
     |LEE 000#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
     |CIERRA #isom0001;

     #isacceso#8 = #isom0001#5;

     |GRABA 020#isacceso.a;
     |LIBERA #isacceso;

     |CIERRA #isacceso;
|FPRC;

|PROCESO LeeCas101;
     #isom0001#0  = enEmpresa;
     #isom0001#1  = enAnyo;
     #isom0001#3  = aCasilla;
     |LEE 040#isom0001.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0001;  |FINSI;
|FPRC;

|PROCESO LeeCas102;
     #isom0002#0  = enEmpresa;
     #isom0002#1  = enAnyo;
     #isom0002#3  = aCasilla;
     |LEE 040#isom0002.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0002;  |FINSI;

     |SI #isom0002#6 ! "S"; #isom0002#5 = 0; #isom0002#7 = " ";  |FINSI;
|FPRC;

|PROCESO LeeCas103;
     #isom0003#0  = enEmpresa;
     #isom0003#1  = enAnyo;
     #isom0003#3  = aCasilla;
     |LEE 040#isom0003.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0003;  |FINSI;

     |SI #isom0003#6 ! "S"; #isom0003#5 = 0; #isom0003#7 = " "; |FINSI;
|FPRC;

|PROCESO LeeCas104;
     #isom0004#0  = enEmpresa;
     #isom0004#1  = enAnyo;
     #isom0004#3  = aCasilla;
     |LEE 040#isom0004.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0004;  |FINSI;

     |SI #isom0004#6 ! "S"; #isom0004#5 = 0; #isom0004#7 = " "; |FINSI;
|FPRC;

|PROCESO LeeCas105;
     #isom0005#0  = enEmpresa;
     #isom0005#1  = enAnyo;
     #isom0005#3  = aCasilla;
     |LEE 040#isom0005.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0005;  |FINSI;

     |SI #isom0005#6 ! "S"; #isom0005#5 = 0; #isom0005#7 = " "; |FINSI;
|FPRC;

|PROCESO LeeCas106;
     |ABRE #isom0006;
     |SELECT #2#isom0006;
     #isom0006#0  = enEmpresa;
     #isom0006#1  = enAnyo;
     #isom0006#4  = aCasilla;
     |LEE 040#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     |CIERRA #isom0006;
|FPRC;

|PROCESO LeeCas122;
     #isom0022#0  = enEmpresa;
     #isom0022#1  = enAnyo;
     #isom0022#3  = aCasilla;
     |LEE 040#isom0022.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0022;  |FINSI;
|FPRC;

|PROCESO LeeCas123;
     |SELECT #3#isom0023;
     #isom0023#0 = enEmpresa;
     #isom0023#1 = enAnyo;
     #isom0023#4 = aCasilla;
     |LEE 000#isom0023.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0023;  |FINSI;
|FPRC;

|PROCESO LeeCas109;
     |SELECT #2#isom0009;
     #isom0009#0  = enEmpresa;
     #isom0009#1  = enAnyo;
     #isom0009#5  = aCasilla;
     |LEE 040#isom0009.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0009;  |FINSI;
|FPRC;

|PROCESO LeeCas110;
     |SELECT #2#isom0010;
     #isom0010#0  = enEmpresa;
     #isom0010#1  = enAnyo;
     #isom0010#5  = aCasilla;
     |LEE 040#isom0010.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0010;  |FINSI;
|FPRC;

|PROCESO LeeCas111;
     |SELECT #2#isom0011;
     #isom0011#0  = enEmpresa;
     #isom0011#1  = enAnyo;
     #isom0011#4  = aCasilla;
     |LEE 040#isom0011.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0011;  |FINSI;
|FPRC;

|PROCESO BaseReparto;
    |DDEFECTO #zregdocu;
    #zregdocu#0 = enEmpresa;
    #zregdocu#1 = enAnyo;
    |LEE 101#zregdocu.=;
    |SI FSalida = 0;
        #isoz0002#16 = #zregdocu#16; ||Base reparto 1
    |SINO;
        |DDEFECTO #isom0000;
        #isom0000#0 = enEmpresa;
        #isom0000#1 = enAnyo;
        |LEE 041#isom0000.=;
        #isoz0002#16 = #isom0000#84; ||Base reparto 1
    |FINSI;
    |LIBERA #zregdocu;
|FPRC;

|PROCESO HayECPNII;
    |SI #isom0005#5 ! 0;
        nHayECPNII=1;
        |ERROR10;
    |FINSI;
|FPRC;

|DEFBUCLE HayECPNII;
   #isom0005#1;
   ;
   enEmpresa, enAnyo, 0001;
   enEmpresa, enAnyo, 9999;
   e;
   NULL, HayECPNII;
|FIN;

|PROCESO VerHayECPNII;
   nHayECPNII = 0;
   |SELECT #1#isom0005; |CIERRA #isom0005;
   |BUCLE HayECPNII;
   |ABRE #isom0005; |SELECT #2#isom0005;
|FPRC;

|PROCESO Totales2008;
   |ABRE #isom0001; |SELECT #2#isom0001;
   |ABRE #isom0002; |SELECT #2#isom0002;
   |ABRE #isom0003; |SELECT #2#isom0003;
   |ABRE #isom0004; |SELECT #2#isom0004;
   |ABRE #isom0005; |SELECT #2#isom0005;
   |ABRE #isom0000;
   |ABRE #zregdocu;

    aCasilla = "180"; |HAZ LeeCas102; #isoz0002#1 = #isom0002#5;
    aCasilla = "252"; |HAZ LeeCas102; #isoz0002#2 = #isom0002#5;
    #isoz0002#3 = #isoz0002#1 - #isoz0002#2;
    aCasilla = "199"; |HAZ LeeCas102; #isoz0002#4 = #isom0002#5;

    aCasilla = "296"; |HAZ LeeCas103; #isoz0002#5  = #isom0003#5;
    aCasilla = "324"; |HAZ LeeCas103; #isoz0002#6  = #isom0003#5;
    aCasilla = "325"; |HAZ LeeCas103; #isoz0002#7  = #isom0003#5;
    aCasilla = "326"; |HAZ LeeCas103; #isoz0002#8  = #isom0003#5;
    aCasilla = "327"; |HAZ LeeCas103; #isoz0002#9  = #isom0003#5;
    |SI enTCta = 1;
        aCasilla = "328"; |HAZ LeeCas103; #isoz0002#10 = #isom0003#5;
    |SINO;
        #isoz0002#10 = 0; |C_V #isoz0002#10, 1, "N";
    |FINSI;
    aCasilla = "500"; |HAZ LeeCas103; #isoz0002#11 = #isom0003#5;

    |SI enTBal = 1;  ||  |O enTBal = 2;
        aCasilla = "500"; |HAZ LeeCas104; #isoz0002#12 =  #isom0004#5;
        aCasilla = "355"; |HAZ LeeCas104; #isoz0002#13 =  #isom0004#5;
    |SINO;
        #isoz0002#12 = 0; #isoz0002#13 = 0;
        |C_V #isoz0002#12, 1, "N"; |C_V #isoz0002#13, 1, "N";
    |FINSI;

    aCasilla = "639"; |HAZ LeeCas105; #isoz0002#14 = #isom0005#5;
    aCasilla = "645"; |HAZ LeeCas105; #isoz0002#15 = #isom0005#5;
   ||  |HAZ VerHayECPNII;

    |HAZ BaseReparto;

    aCasilla = "500"; |HAZ LeeCas101; #isoz0002#17 = #isom0001#5;

   |SI #isoz0002#3 ! 0;
       aError = "Diferencia entre (180) Activo y (252) Pasivo";
   |FINSI;
   |SI #isoz0002#4 ! #isoz0002#11;
       aError = "Revisar Resultado del Ejercicio de (500) Cuenta de Perdidas y Ganancias";
   |FINSI;
   |SI #isoz0002#16 ! #isoz0002#4; |Y #isoz0002#4 > 0;
       aError = "Revisar Resultado del Ejercicio con (650) Base de Reparto";
   |FINSI;
   |SI #isoz0002#16 ! 0; |Y #isoz0002#4 [ 0;
       aError = "Revisar Resultado del Ejercicio con (650) Base de Reparto";
   |FINSI;
   |SI #isoz0002#17 ! #isoz0002#4;
       aError = "Revisar Resultado del Ejercicio con (500) Liquidacion";
   |FINSI;
   |SI #isoz0002#14 ! #isoz0002#4; |Y enTBal = 1;
       aError = "Revisar Resultado del Ejercicio con (639) ECPN II";
   |FINSI;

   |CIERRA #zregdocu;
   |CIERRA #isom0000;
   |SELECT #1#isom0005; |CIERRA #isom0005;
   |SELECT #1#isom0004; |CIERRA #isom0004;
   |SELECT #1#isom0003; |CIERRA #isom0003;
   |SELECT #1#isom0002; |CIERRA #isom0002;
   |SELECT #1#isom0001; |CIERRA #isom0001;
|FPRC;

|PROCESO LeeEmpresa;
   |ABRE #maempr10;
   #maempr10#0 = enEmpresa;
   #maempr10#1 = enAnyo;
   |LEE 000#maempr10.=;
   |SI FSalida ! 0;  |DDEFECTO #maempr10;  |FINSI;
   |CIERRA #maempr10;

   |ABRE #ca8m0000;
   #ca8m0000#0 = #maempr10#102;
   |LEE 000#ca8m0000.=;
   |SI FSalida ! 0;  |DDEFECTO #ca8m0000;  |FINSI;
   enTCta = #ca8m0000#2;

   #ca8m0000#0 = #maempr10#101;
   |LEE 000#ca8m0000.=;
   |SI FSalida ! 0;  |DDEFECTO #ca8m0000;  |FINSI;
   enTBal = #ca8m0000#2;
   |CIERRA #ca8m0000;
|FPRC;

|PROCESO Pantalla;
   |DDEFECTO #isoz0002;
   #isoz0002#0  = enAnyo;
   |SI #isoz0002#0 ] 2008;
       |HAZ Totales2008;
   |FINSI;

   aAlfa =  "Pantalla Totales (" + (("00000" + #maempr10#0) % -105) + " / " + #maempr10#1 + " " + #maempr10#2;
   |QBF aAlfa;
   aAlfa = aAlfa + ")";
   |VENTANA 0501, 2799, -1, 16, aAlfa;
   nVent = FSalida;

   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent;
   aVent5 = "MODAL";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |HAZ Chequeo;

   |PINPA #0#isoz0002;  nPanta = FSalida;
   |PINDA #0#isoz0002;

   nError = 1;
   aAlfa = "LABEL,{{9}} D E S C U A D R A D O";

   |SI #isoz0002#3 = 0;  |Y enTBal = 1;
       |Y #isoz0002#11 = #isoz0002#4;
       |Y #isoz0002#16 = #isoz0002#4;
       |Y #isoz0002#17 = #isoz0002#4;
       |Y #isoz0002#14 = #isoz0002#4;
          aAlfa = "LABEL,{{9}} C U A D R A D O";
          nError = 0;
   |FINSI;

   |SI #isoz0002#3 = 0;  |Y enTBal ! 1;
       |Y #isoz0002#11 = #isoz0002#4;
       |Y #isoz0002#16 = #isoz0002#4;
       |Y #isoz0002#17 = #isoz0002#4;
          aAlfa = "LABEL,{{9}} C U A D R A D O";
          nError = 0;
   |FINSI;

   |SI #isoz0002#3 = 0;  |Y enTBal = 1;
       |Y #isoz0002#11 = #isoz0002#4;
       |Y #isoz0002#17 = #isoz0002#4;
       |Y #isoz0002#14 = #isoz0002#4;
       |Y #isoz0002#16 = 0; |Y #isoz0002#4 < 0;
          aAlfa = "LABEL,{{9}} C U A D R A D O";
          nError = 0;
   |FINSI;

   |SI #isoz0002#3 = 0; |Y enTBal ! 1;
       |Y #isoz0002#11 = #isoz0002#4;
       |Y #isoz0002#17 = #isoz0002#4;
       |Y #isoz0002#16 = 0; |Y #isoz0002#4 < 0;
          aAlfa = "LABEL,{{9}} C U A D R A D O";
          nError = 0;
   |FINSI;


   |CONTROL_SIMPLE nPanta, aAlfa, 2056, 2188, NULL;

   aAlfa = "LABEL,{{3}}" + aError;
   |CONTROL_SIMPLE nPanta, aAlfa, 2353, 2598, NULL;

   |ATRI 0;
   |PAUSA;

   aVent1 = -1;
   aVent2 = -1;
   aVent3 = 0;
   aVent4 = nVent;
   aVent5 = "MODELESS";
   |ESPECIFICA "ESTADO_VENTANA", aVent;

   |PULSATECLA;

   |FINVENTANA nVent;

|FPRC;

|PROCESO isom0017C;
     nSuma         = nSuma + #isom0017#4;
     nHayAdicional = 1;
|FPRC;

|DEFBUCLE isom0017C;
     #isom0017#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, isom0017C;
|FIN;

|PROCESO isom0017B;
     |BORRA 020#isom0017.a;
     |LIBERA #isom0017;
|FPRC;

|DEFBUCLE isom0017B;
     #isom0017#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isom0017B;
|FIN;

|PROCESO isom0018C;
     nSuma         = nSuma + #isom0018#5;
     nHayAdicional = 1;
|FPRC;

|DEFBUCLE isom0018C;
     #isom0018#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, isom0018C;
|FIN;

|PROCESO isom0018B;
     |BORRA 020#isom0018.a;
     |LIBERA #isom0018;
|FPRC;

|DEFBUCLE isom0018B;
     #isom0018#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isom0018B;
|FIN;

|PROCESO isom0019C;
     nSuma         = nSuma + #isom0019#4;
     nHayAdicional = 1;
|FPRC;

|DEFBUCLE isom0019C;
     #isom0019#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, isom0019C;
|FIN;

|PROCESO isom0019B;
     |BORRA 020#isom0019.a;
     |LIBERA #isom0019;
|FPRC;

|DEFBUCLE isom0019B;
     #isom0019#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isom0019B;
|FIN;

|PROCESO isom0020C;
     nSuma         = nSuma + #isom0020#4;
     nHayAdicional = 1;
|FPRC;

|DEFBUCLE isom0020C;
     #isom0020#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, isom0020C;
|FIN;

|PROCESO isom0020B;
     |BORRA 020#isom0020.a;
     |LIBERA #isom0020;
|FPRC;

|DEFBUCLE isom0020B;
     #isom0020#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isom0020B;
|FIN;

|PROCESO isom0021C;
     nSuma         = nSuma + #isom0021#4;
     nHayAdicional = 1;
|FPRC;

|DEFBUCLE isom0021C;
     #isom0021#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     ;
     NULL, isom0021C;
|FIN;

|PROCESO isom0021B;
     |BORRA 020#isom0021.a;
     |LIBERA #isom0021;
|FPRC;

|DEFBUCLE isom0021B;
     #isom0021#1;
     ;
     enEmpresa, enAnyo, 01;
     enEmpresa, enAnyo, 99;
     be;
     NULL, isom0021B;
|FIN;

|PROCESO ChequeoInforAdional;
     |SI enAnyo [ 2009;  |ACABA;  |FINSI;

     |ABRE #isom0006;
     |SELECT #3#isom0006;
     #isom0006#0 = enEmpresa;
     #isom0006#1 = enAnyo;
     #isom0006#6 = 414;
     |LEE 000#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     |CIERRA #isom0006;

     nSuma = 0;
     |BUCLE isom0017C;
     |SI #isom0006#7 > 50000;
         |SI nSuma ! #isom0006#7;
             enError = 1;
             eaError = "0000La casilla 414 de la liquidaci¢n supera los 50.000 Euros ";
             eaError = eaError + "y no hay informaci¢n adicional introducida";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |SINO;
         |BUCLE isom0017B;
     |FINSI;

     |ABRE #isom0011;
     |SI enAnyo = 2010;
         aCasilla = "138"; |HAZ LeeCas111;
     |FINSI;

     |SI enAnyo ] 2011;  aCasilla = "141"; |HAZ LeeCas111;  |FINSI;
     |SI enAnyo ] 2015;  aCasilla = "700"; |HAZ LeeCas111;  |FINSI;

     nSuma = 0;
     |BUCLE isom0018C;
     |SI #isom0011#5 > 50000;
         |SI nSuma ! #isom0011#5;
             enError = 1;
             eaError = "0000La casilla " + aCasilla + " de las deducciones supera los 50.000 Euros ";
             eaError = eaError + "y no hay informaci¢n adicional introducida";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |SINO;
         |BUCLE isom0018B;
     |FINSI;

     |SI enAnyo [ 2014;
         aCasilla = "792"; |HAZ LeeCas111;
         nSuma = 0;
         |BUCLE isom0019C;
         |SI #isom0011#5 > 50000;
             |SI nSuma ! #isom0011#5;
                 enError = 1;
                 eaError = "0000La casilla 792 de las deducciones supera los 50.000 Euros ";
                 eaError = eaError + "y no hay informaci¢n adicional introducida";
                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaError;
             |FINSI;
         |SINO;
             |BUCLE isom0019B;
         |FINSI;
     |FINSI;

     aCasilla = "798"; |HAZ LeeCas111;
     nSuma = 0;
     |BUCLE isom0020C;
     |SI #isom0011#5 > 50000;
         |SI nSuma ! #isom0011#5;
             enError = 1;
             eaError = "0000La casilla 798 de las deducciones supera los 50.000 Euros ";
             eaError = eaError + "y no hay informaci¢n adicional introducida";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |SINO;
         |BUCLE isom0020B;
     |FINSI;

     |SI enAnyo = 2010;
         aCasilla = "813"; |HAZ LeeCas111;
         nSuma = 0;
         |BUCLE isom0021C;
         |SI #isom0011#5 > 50000;
             |SI nSuma ! #isom0011#5;
                 enError = 1;
                 eaError = "0000La casilla 813 de las deducciones supera los 50.000 Euros ";
                 eaError = eaError + "y no hay informaci¢n adicional introducida";
                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaError;
             |FINSI;
         |SINO;
             |BUCLE isom0021B;
         |FINSI;
         |CIERRA #isom0011;
     |FINSI;

     |SI enAnyo ] 2012;
         aCasilla = "096"; |HAZ LeeCas111;
         nSuma = 0;
         |BUCLE isom0021C;
         |SI #isom0011#5 > 50000;
             |SI nSuma ! #isom0011#5;
                 enError = 1;
                 eaError = "0000La casilla 096 de las deducciones supera los 50.000 Euros ";
                 eaError = eaError + "y no hay informaci¢n adicional introducida";
                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaError;
             |FINSI;
         |SINO;
             |BUCLE isom0021B;
         |FINSI;
         |CIERRA #isom0011;
     |FINSI;
|FPRC;

|PROCESO ChequeaAmortiza;
     |SI enPeqDimen ! 0;  |ACABA;  |FINSI;
     |SI enAnyo ] 2015;   |ACABA;  |FINSI;

     aCasilla = "284"; |HAZ LeeCas103; nValor1 = #isom0003#5;
     |SI nValor1 = 0;  |ACABA;  |FINSI;

     |ABRE #isom0006;
     |SELECT #2#isom0006;
     #isom0006#0 = enEmpresa;
     #isom0006#1 = enAnyo;
     #isom0006#4 = "504";
     |LEE 000#isom0006.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
     |CIERRA #isom0006;

     |SI #isom0006#5 = 0;  |Y #isom0006#7 = 0;
         enAviso = 1;
         eaError = "0000No hay ajustes en la casilla 504 y la empresa no es de reducida dimensi¢n. Revise dicha casilla";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaAviso;
     |FINSI;

     |SI #isom0006#5 ! 0;
         nValor2 = nValor1 % 30;
         |SI nValor2 < 0;  nValor2 = -nValor2;  |FINSI;

         nValor3 = #isom0006#5 + #isom0006#7;
         |SI nValor3 < 0;  nValor3 = -nValor3;  |FINSI;

         nResta  = nValor2 - nValor3;
         |SI nResta < 0;  nResta = -nResta;  |FINSI;

         |SI nResta > 2;
             enAviso = 1;
             eaError = "0000El importe del ajuste de la casilla 504 puede no ser correcto. Revise dicha casilla";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaAviso;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Chequeo;
     enNavieras    = 0;
     enCooperativa = 0;
     enTranspa     = 0;
     enZEC         = 0;
     enSOCIMI      = 0;
     enPeqDimen    = 0;
     enNovaCrea    = 0;
     enForales     = 0;
     enInactiva    = 0;

     |ABRE #maempr11;
     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 22;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enNavieras = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 17;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 18;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 19;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enCooperativa = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 12;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enSOCIMI = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 13;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enTranspa = 13;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 14;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enTranspa = 14;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 15;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enZEC = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 6;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enPeqDimen = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 63;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enNovaCrea = 1;  |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 28;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enForales = 1;  |FINSI;

     |SI enCooperativa ! 0;
         enTranspa = 0;
         enZEC     = 0;
     |FINSI;

     #maempr11#0 = enEmpresa;
     #maempr11#1 = enAnyo;
     #maempr11#2 = 26;
     |LEE 000#maempr11.=;
     |SI FSalida = 0;  enInactiva = 1;  |FINSI;

     |CIERRA #maempr11;

     enError = 0;  eaError = "";
     enAviso = 0;
     nCError = 0;
     nCAviso = 0;

     |ABRE #isom0002;
     |ABRE #isom0001; |SELECT #2#isom0001;
     |ABRE #isom0003; |SELECT #2#isom0003;
     |ABRE #isom0004; |SELECT #2#isom0004;
     |ABRE #isom0005; |SELECT #2#isom0005;
     |ABRE #isom0022; |SELECT #2#isom0022;
     |ABRE #isom0023;
     |ABRE #isom0000;
     |ABRE #zregdocu;

     #isom0000#0 = enEmpresa;
     #isom0000#1 = enAnyo;
     |LEE 000#isom0000.=;
     |SI FSalida ! 0;  |DDEFECTO #isom0000;  |FINSI;

     |SI enAnyo [ 2015;
                                   nPorce = 100;
         |SI #isom0000#120 = "2";  nPorce = 50;  |FINSI;
         |SI #isom0000#120 = "3";  nPorce = 25;  |FINSI;
     |FINSI;

     |SI enAnyo = 2016;
                                   nPorce = 60;
         |SI #isom0000#120 = "2";  nPorce = 50;  |FINSI;
         |SI #isom0000#120 = "3";  nPorce = 25;  |FINSI;
     |FINSI;

     |SI enAnyo ] 2017;
                                   nPorce = 70;
         |SI #isom0000#120 = "2";  nPorce = 50;  |FINSI;
         |SI #isom0000#120 = "3";  nPorce = 25;  |FINSI;
     |FINSI;

     #isom0002#0 = enEmpresa;
     #isom0002#1 = enAnyo;
     #isom0002#2 = 0001;
     |LEE 001#isom0002.];
     |SI FSalida = 0; |Y #isom0002#0 = enEmpresa; |Y #isom0002#1 = enAnyo;
         nExiste = 1;
     |FINSI;

     |SI nExiste = 0;
         enError = 1;
         eaError = "0000No ha cumplimentado datos en balance";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;

     |SELECT #2#isom0002;

     |HAZ ChequeaAmortiza;

     |SI enInactiva = 1;
         aCasilla = "296"; |HAZ LeeCas103; nValor1 = #isom0003#5;
         aCasilla = "324"; |HAZ LeeCas103; nValor1 = #isom0003#5;
         aCasilla = "325"; |HAZ LeeCas103; nValor1 = nValor1 + #isom0003#5;
         aCasilla = "326"; |HAZ LeeCas103; nValor1 = nValor1 + #isom0003#5;
         aCasilla = "327"; |HAZ LeeCas103; nValor1 = nValor1 + #isom0003#5;
         aCasilla = "328"; |HAZ LeeCas103; nValor1 = nValor1 + #isom0003#5;
         aCasilla = "500"; |HAZ LeeCas103; nValor1 = nValor1 + #isom0003#5;

         |SI nValor1 ! 0;
             enAviso = 1;
             eaError = "0000Entidad inactiva con datos en las Cuentas de p‚rdidas y ganancias.";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaAviso;
         |FINSI;
     |FINSI;

     aCasilla = "180"; |HAZ LeeCas102; nValor1 = #isom0002#5;
     aCasilla = "252"; |HAZ LeeCas102; nValor2 = #isom0002#5;

     |SI nValor1 ! nValor2;
         enError = 1;
         eaError = "0000Total activo (180) y Total PN y pasivo (252) deben ser iguales";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;

     aCasilla = "199"; |HAZ LeeCas102; nValor1 = #isom0002#5;
     aCasilla = "500"; |HAZ LeeCas103; nValor2 = #isom0003#5;

     |SI nValor1 ! nValor2;
         enError = 1;
         eaError = "0000Casilla 199 (Pasivo) distinta a la Casilla 500 (Cta Resultados)";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;

     |SI enTBal = 1;  || ... |O enTBal = 2; 12.07.2017 solo obligado Normal
         aCasilla = "500"; |HAZ LeeCas104; nValor1 = #isom0004#5;
         |SI nValor1 ! nValor2;
             enError = 1;
             eaError = "0000Casilla 500 (Cta Resultados) distinta a la Casilla 500 (ECPN I)";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
        |FINSI;
     |FINSI;

     aCasilla = "500"; |HAZ LeeCas101; nValor1 = #isom0001#5;
     |SI nValor1 ! nValor2;
         enError = 1;
         eaError = "0000Casilla 500 (Cta Resultados) distinta a la Casilla 500 (Liquidacion)";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;

     |SI #ca8m0000#2 = 1;
         aCasilla = "639"; |HAZ LeeCas105; nValor2 = #isom0005#5;
         |SI nValor1 ! nValor2;
             enAviso = 1;
             eaError = "0000Casilla 639 (ECPN II) distinta a la Casilla 500 (Liquidacion)";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaAviso;
         |FINSI;
     |FINSI;

     aCasilla = "199"; |HAZ LeeCas102;   nValor1 = #isom0002#5;
     #isoz0002#16 = 0; |HAZ BaseReparto; nValor2 = #isoz0002#16;

     |SI nValor1 ! nValor2; |Y nValor1 > 0;
         enAviso = 1;
         eaError = "0000Revisar Resultado del Ejercicio con (650) Base de Reparto";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaAviso;
     |FINSI;
     |SI nValor2 ! 0; |Y nValor1 [ 0;
         enAviso = 1;
         eaError = "0000Revisar Resultado del Ejercicio con (650) Base de Reparto";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaAviso;
     |FINSI;

     aCasilla = "302"; |HAZ LeeCas101; nValor1 = #isom0001#5 ! 2;
     aCasilla = "301"; |HAZ LeeCas101; nValor1 = (nValor1 - #isom0001#5) ! 2;
     aCasilla = "326"; |HAZ LeeCas103; nValor2 = #isom0003#5 ! 2;

     |SI nValor1 ! nValor2;
         enError = 1;
         eaError = "0000Casilla (301 - 302) Liquidacion  distinta a la Casilla 326 (Cta Resultados)";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;

     |SI enAnyo ] 2012;  |Y enAnyo [ 2014;
         || ... Chequeos 18bis

          aCasilla = "249"; |HAZ LeeCas122; nValor1 = #isom0022#5;
          aCasilla = "305"; |HAZ LeeCas103; nValor2 = #isom0003#5;
          |SI nValor2 < 0;  nValor2 = -nValor2;  |FINSI;

          |SI nValor1 ! nValor2;
              enAviso = 1;
              eaError = "0000Casilla 249 (pag.18bis) es distinta a los gastos financieros de la Cta PyG.(casilla 305). Revise el importe";
              |SI nGraba = 0;
                  |MENAV eaError;
              |FINSI;
              |HAZ GrabaAviso;
          |FINSI;

          aCasilla = "179"; |HAZ LeeCas122; nValor1 = #isom0022#5;
          aCasilla = "298"; |HAZ LeeCas103; nValor2 = #isom0003#5;
          |SI nValor1 ! nValor2;
              enAviso = 1;
              eaError = "0000Casillas 179 distintas a los ingresos financieros Emp.Grupo de Cta PyG.(298). Revise el importe";
              |SI nGraba = 0;
                  |MENAV eaError;
              |FINSI;
              |HAZ GrabaAviso;
          |FINSI;

          aCasilla = "252"; |HAZ LeeCas122; nValor1 = #isom0022#5;
          aCasilla = "297"; |HAZ LeeCas103; nValor2 = #isom0003#5;
          |SI nValor1 ! nValor2;
              enAviso = 1;
              eaError = "0000Casillas 252(pag.18bis) distintas a los ingresos financieros de Cta PyG.(297). Revise el importe";
              |SI nGraba = 0;
                  |MENAV eaError;
              |FINSI;
              |HAZ GrabaAviso;
          |FINSI;

          aCasilla = "538"; |HAZ LeeCas123;    nCas049  = #isom0023#7;

          |SI enAnyo = 2013;
              aCasilla = "273"; |HAZ LeeCas123;    nCas049  = (nCas049 - #isom0023#7) ! 2;
          |FINSI;

          aCasilla = "267"; |HAZ LeeCas123;    nCas258  = #isom0023#7;
          aCasilla = "264"; |HAZ LeeCas123;    nCas258  = (nCas258 - #isom0023#7) ! 2;

          aCasilla = "258"; |HAZ LeeCas122;
          |SI #isom0022#5 ! nCas258;
              enError = 1;
              eaError = "0000Casilla 258 (pag.18bis) es distinta a la casilla 268. Revise el importe";
              |SI nGraba = 0;
                  |MENAV eaError;
              |FINSI;
              |HAZ GrabaError;
          |FINSI;
     |FINSI;

     |SI enCooperativa ! 0;
         aCasilla = "552"; |HAZ LeeCas101; nValor1 = #isom0001#5;
         aCasilla = "553"; |HAZ LeeCas101; nValor2 = #isom0001#5;
         aCasilla = "554"; |HAZ LeeCas101; nValor3 = #isom0001#5;
         nSuma    = (nValor2 + nValor3) ! 2;
         |SI nSuma ! nValor1;
             enError = 1;
             eaError = "0000Casilla (553 + 554) Liquidaci¢n distinta a la Casilla 552 Liquidaci¢n";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;

         aCasilla = "547"; |HAZ LeeCas101; nValor1 = #isom0001#5;
         |SI nValor1 ! 0;
             enError = 1;
             eaError = "0000La empresa es de Cooperativas tiene contenido la Casilla 547";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |FINSI;

     |SI enTranspa ! 0;
         aCasilla = "555"; |HAZ LeeCas101; nValor2 = #isom0001#5;
         aCasilla = "556"; |HAZ LeeCas101; nValor3 = #isom0001#5;

         |SI enAnyo [ 2014;
             aCasilla = "552"; |HAZ LeeCas101; nValor1 = #isom0001#5;
         |FINSI;

         |SI enAnyo ] 2015;
             aCasilla = "1330"; |HAZ LeeCas101; nValor1 = #isom0001#5;
         |FINSI;

         nSuma    = (nValor2 + nValor3) ! 2;
         |SI nSuma ! nValor1;
             enError = 1;
             eaError = "0000Casilla (555 + 556) Liquidaci¢n distinta a la Casilla " + aCasilla + " Liquidaci¢n";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |FINSI;

     |SI enCooperativa = 0;
         |ABRE #isom0009;
         aCasilla = "552"; |HAZ LeeCas101;
         aCasilla = "670"; |HAZ LeeCas109;
         |SI #isom0001#5 > 0;
             |SI #isom0009#6 > 0;
                 |SI #isom0009#8 = 0;
                     enAviso = 1;
                     eaError = "0000Hay bases imponibles negativas sin aplicar.";
                     |SI nGraba = 0;
                         |MENAV eaError;
                     |FINSI;
                     |HAZ GrabaAviso;
                 |FINSI;
             |FINSI;
         |FINSI;

         aCasilla = "550"; |HAZ LeeCas101;
         |SI #isom0001#5 < #isom0009#8;  |Y #isom0001#5 > 0;
             enError = 1;
             eaError = "0000Hay aplicadas bases imponibles negativas con importe superior a la casilla 552";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;

         |SI #isom0001#5 < 0;  |Y #isom0009#8 ! 0;
             enError = 1;
             eaError = "0000Hay aplicadas bases imponibles negativas y la casilla 550 es negativa.";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;

         |CIERRA #isom0009;
     |FINSI;

     |SI enCooperativa ! 0;
         |ABRE #isom0010;
         aCasilla = "562"; |HAZ LeeCas101;
         aCasilla = "694"; |HAZ LeeCas110;
         |SI #isom0001#5 > 0;
             |SI #isom0010#6 > 0;
                 |SI #isom0010#8 = 0;
                     enAviso = 1;
                     eaError = "0000Hay compensaciones de cuotas de cooperativas sin aplicar.";
                     |SI nGraba = 0;
                         |MENAV eaError;
                     |FINSI;
                     |HAZ GrabaAviso;
                 |FINSI;
             |FINSI;
         |FINSI;

         aCasilla = "560"; |HAZ LeeCas101;
         |SI #isom0001#5 < #isom0010#8;  |Y #isom0001#5 > 0;
             enError = 1;
             eaError = "0000Hay aplicadas cuotas de cooperativas con importe superior a la casilla 560";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;

         |SI #isom0001#5 < 0;  |Y #isom0010#8 ! 0;
             enError = 1;
             eaError = "0000Hay aplicadas cuotas de cooperativas y la 560 es negativa";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;

         |CIERRA #isom0010;
     |FINSI;

     |SI enSOCIMI ! 0;
         aCasilla = "520"; |HAZ LeeCas101;  nValor520 = #isom0001#5;
         aCasilla = "521"; |HAZ LeeCas101;  nValor521 = #isom0001#5;
         aCasilla = "523"; |HAZ LeeCas101;  nValor523 = #isom0001#5;
         aCasilla = "552"; |HAZ LeeCas101;  nValor552 = #isom0001#5;

         nValor = nValor520 + nValor521 - nValor523;
         |SI nValor552 ! nValor;
             enError = 1;
             eaError = "0000Sociedad SOCIMIS. La casilla [520 + 521 - 523] debe ser igual a la casilla [552]";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
     |FINSI;

     |SI enAnyo = 2015;
         |ABRE #isom0028;
         |SELECT #2#isom0028;
         #isom0028#0 = enEmpresa;
         #isom0028#1 = enAnyo;
         #isom0028#4 = "1170";
         |LEE 000#isom0028.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0028;  |FINSI;
         |CIERRA #isom0028;

         |SI #isom0028#5 ! 0;
             |ABRE #isom0006;
             |SELECT #3#isom0006;
             #isom0006#0 = enEmpresa;
             #isom0006#1 = enAnyo;
             #isom0006#6 = 505;
             |LEE 000#isom0006.=;
             |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
             |CIERRA #isom0006;

             |SI #isom0028#5 ! #isom0006#7;
                 enAviso = 1;
                 eaError = "0000Deben coincidir las casillas (505) con la (1170) Punto 1040";

                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaAviso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo = 2016;
         |ABRE #isom0028;
         |SELECT #2#isom0028;
         #isom0028#0 = enEmpresa;
         #isom0028#1 = enAnyo;
         #isom0028#4 = "1442";
         |LEE 000#isom0028.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0028;  |FINSI;
         |CIERRA #isom0028;

         |SI #isom0028#5 = 0;
             |ABRE #isom0006;
             |SELECT #3#isom0006;
             #isom0006#0 = enEmpresa;
             #isom0006#1 = enAnyo;
             #isom0006#6 = 505;
             |LEE 000#isom0006.=;
             |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
             |CIERRA #isom0006;

             |SI #isom0028#5 = 0;  |Y #isom0006#7 ! 0;
                 enAviso = 1;
                 eaError = "0000Hay contenido en la casilla (505) y no hay contenido en la casilla (1442) Punto 1040";

                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaAviso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo = 2017;
         |ABRE #isom0028;
         |SELECT #2#isom0028;
         #isom0028#0 = enEmpresa;
         #isom0028#1 = enAnyo;
         #isom0028#4 = "1721";
         |LEE 000#isom0028.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0028;  |FINSI;
         |CIERRA #isom0028;

         |SI #isom0028#5 = 0;
             |ABRE #isom0006;
             |SELECT #3#isom0006;
             #isom0006#0 = enEmpresa;
             #isom0006#1 = enAnyo;
             #isom0006#6 = 505;
             |LEE 000#isom0006.=;
             |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
             |CIERRA #isom0006;

             |SI #isom0028#5 = 0;  |Y #isom0006#7 ! 0;
                 enAviso = 1;
                 eaError = "0000Hay contenido en la casilla (505) y no hay contenido en la casilla (1721) Punto 1040";

                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaAviso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo = 2018;
         |ABRE #isom0028;
         |SELECT #2#isom0028;
         #isom0028#0 = enEmpresa;
         #isom0028#1 = enAnyo;
         #isom0028#4 = "1953";
         |LEE 000#isom0028.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0028;  |FINSI;
         |CIERRA #isom0028;

         |SI #isom0028#5 = 0;
             |ABRE #isom0006;
             |SELECT #3#isom0006;
             #isom0006#0 = enEmpresa;
             #isom0006#1 = enAnyo;
             #isom0006#6 = 505;
             |LEE 000#isom0006.=;
             |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
             |CIERRA #isom0006;

             |SI #isom0028#5 = 0;  |Y #isom0006#7 ! 0;
                 enAviso = 1;
                 eaError = "0000Hay contenido en la casilla (505) y no hay contenido en la casilla (1953) Punto 1040";

                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaAviso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo = 2019;
         |ABRE #isom0028;
         |SELECT #2#isom0028;
         #isom0028#0 = enEmpresa;
         #isom0028#1 = enAnyo;
         #isom0028#4 = "2230";
         |LEE 000#isom0028.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0028;  |FINSI;
         |CIERRA #isom0028;

         |SI #isom0028#5 = 0;
             |ABRE #isom0006;
             |SELECT #3#isom0006;
             #isom0006#0 = enEmpresa;
             #isom0006#1 = enAnyo;
             #isom0006#6 = 505;
             |LEE 000#isom0006.=;
             |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;
             |CIERRA #isom0006;

             |SI #isom0028#5 = 0;  |Y #isom0006#7 ! 0;
                 enAviso = 1;
                 eaError = "0000Hay contenido en la casilla (505) y no hay contenido en la casilla (2230) Punto 1040";

                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
                 |HAZ GrabaAviso;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI enAnyo ] 2015;
         |ABRE #isom0002;
         |SELECT #2#isom0002;
         aCasilla = "1001"; |HAZ LeeCas102;
         |CIERRA #isom0002;

         |ABRE #isom0026;
         |SELECT #2#isom0026;

         #isom0026#0 = enEmpresa;
         #isom0026#1 = enAnyo;
         #isom0026#4 = "1140";
         |LEE 000#isom0026.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0026;  |FINSI;
         |CIERRA #isom0026;

         |SELECT #1#isom0026;
         |SELECT #1#isom0002;

         nImpor1 = #isom0002#5;
         nImpor2 = #isom0026#5;

         |SI nImpor1 ! 0;  |Y nImpor2 = 0;
             enAviso = 1;
             eaError = "0000Revise la dotaci¢n de la reserva de capitalizaci¢n. ";
             eaError = eaError + "de la casilla 1140. Casilla 1001 del pasivo con contenido ";
             eaError = eaError + "y casilla 1140 sin contenido.";

             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;

             |HAZ GrabaAviso;
        |FINSI;

        |SI nImpor2 ! 0;  |Y nImpor1 = 0;
             enAviso = 1;
             eaError = "0000Revise la dotaci¢n de la reserva de capitalizaci¢n. ";
             eaError = eaError + "de la casilla 1140. Casilla 1001 del pasivo sin contenido ";
             eaError = eaError + "y casilla 1140 con contenido.";

             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;

             |HAZ GrabaAviso;
         |FINSI;

         |ABRE #isom0006;
         |SELECT #2#isom0006;
         #isom0006#0 = enEmpresa;
         #isom0006#1 = enAnyo;
         #isom0006#4 = "416";
         |LEE 000#isom0006.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0006;  |FINSI;

         aCasilla = "550"; |HAZ LeeCas101;
         nValor   = (#isom0001#5 + #isom0006#7) % nPorce;
         |SI #isom0006#7 > nValor;  |Y nValor > 0;
             enError = 1;
             eaError = "0000Superado el limite de la casilla 543: " +  nValor + " euros";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
         |CIERRA #isom0006;
     |FINSI;

     |SI enAnyo ] 2016;
         |SI #isom0000#120 ! "1";
             nVal1 = 0;
             nVal2 = 0;
             aCasilla = "570";  |HAZ LeeCas101; nVal1 = #isom0001#5;
             aCasilla = "1344"; |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;
             aCasilla = "1280"; |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;
             aCasilla = "572";  |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;
             aCasilla = "571";  |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;
             aCasilla = "573";  |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;
             aCasilla = "575";  |HAZ LeeCas101; nVal1 = nVal1 + #isom0001#5;

             aCasilla = "562";  |HAZ LeeCas101; nVal2 = #isom0001#5 * .50;

             |SI nVal1 > nVal2;
                 enAviso = 1;
                 eaError = "0000La suma de las casillas 570 + 1344 + 1280 + 572 + 571 + 573 + 575 ";
                 eaError = eaError + " no puede ser superior a la casilla 562 / 2";
                 |SI nGraba = 0;
                     |MENAV eaError;
                 |FINSI;
             |FINSI;
             |HAZ GrabaAviso;
         |FINSI;
     |FINSI;

     |SI enAnyo ] 2017;
         nVal1 = 0;
         nVal2 = 0;

         aCasilla = "375";  |HAZ LeeCas106; nVal1 = #isom0006#5 + #isom0006#7;
         aCasilla = "1018"; |HAZ LeeCas106; nVal1 = nVal1 + #isom0006#5 + #isom0006#7;

         aCasilla = "1786"; |HAZ LeeCas101; nVal2 = #isom0001#5;
         aCasilla = "1788"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1790"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1792"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1794"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1796"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1797"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;
         aCasilla = "1799"; |HAZ LeeCas101; nVal2 = nVal2 + #isom0001#5;

         |SI nVal2 ! 0;  |Y nVal1 = 0;
             enAviso = 1;
             eaError = "0000Hay importes en retenciones por AIEs o UTEs. ";
             eaError = eaError + "Revise si debe introducir correcciones en las ";
             eaError = eaError + "casillas 375, 376, 1018 o 1019";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaAviso;
         |FINSI;

         |ABRE #isom0002;
         |SELECT #2#isom0002;
         aCasilla = "1002"; |HAZ LeeCas102;
         |CIERRA #isom0002;

         |ABRE #isom0027;
         |SELECT #2#isom0027;

         #isom0027#0 = enEmpresa;
         #isom0027#1 = enAnyo;
         #isom0027#4 = "1158";
         |LEE 000#isom0027.=;
         |SI FSalida ! 0;  |DDEFECTO #isom0027;  |FINSI;
         |CIERRA #isom0027;

         |SELECT #1#isom0027;
         |SELECT #1#isom0002;

         nImpor1 = #isom0002#5;
         nImpor2 = #isom0027#7;

         |SI nImpor1 < nImpor2;
             enAviso = 1;
             eaError = "0000Revise la dotaci¢n de la reserva. ";
             eaError = eaError + "Casilla 1002 del pasivo menor de la casilla 1159.";

             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;

             |HAZ GrabaAviso;
        |FINSI;
     |FINSI;

     |HAZ ChequeoInforAdional;

     |HAZ PonColorBandeja;

     |CIERRA #zregdocu;
     |CIERRA #isom0000;
     |SELECT #1#isom0023; |CIERRA #isom0023;
     |SELECT #1#isom0022; |CIERRA #isom0022;
     |SELECT #1#isom0005; |CIERRA #isom0005;
     |SELECT #1#isom0004; |CIERRA #isom0004;
     |SELECT #1#isom0003; |CIERRA #isom0003;
     |SELECT #1#isom0001; |CIERRA #isom0001;
     |SELECT #1#isom0002; |CIERRA #isom0002;
|FPRC;

|PROCESO ChequeoEmision;
     |HAZ Chequeo;

     |SI enAnyo [ 2009;  |ACABA;  |FINSI;

     |SI nHayAdicional = 1;
         |ABRE #isom0016;
         #isom0016#0 = enEmpresa;
         #isom0016#1 = enAnyo;
         #isom0016#2 = 1;
         |LEE 000#isom0016.];
         |SI FSalida ! 0;  |O  #isom0016#0 ! enEmpresa;  |O #isom0016#1 ! enAnyo;
             enError = 1;
             eaError = "0000Hay informaci¢n adicional de ajustes y deducciones ";
             eaError = eaError + "y no se ha introducido el c¢digo electr¢nico ";
             eaError = eaError + "que se pide en la p gina 18";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
         |CIERRA #isom0016;
     |FINSI;

     |SI enAnyo ] 2012;
         |ABRE #isom0205;
         #isom0205#0 = enEmpresa;
         #isom0205#1 = enAnyo;
         |LEE 000#isom0205.=;
         |SI FSalida = 0;  |Y #isom0205#42 = "N";
             enError = 1;
             eaError = "0000Hay creado un modelo 208 y no est  emitido, ";
             eaError = eaError + "por favor em¡talo o borre los activos antes de emitir el impuesto ";
             eaError = eaError + "para poder marcar o desmarcar autom ticamente ";
             eaError = eaError + "la casilla 059.";
             |SI nGraba = 0;
                 |MENAV eaError;
             |FINSI;
             |HAZ GrabaError;
         |FINSI;
         |CIERRA #isom0205;
     |FINSI;

     |HAZ PonColorBandeja;
|FPRC;

|PROCESO ChequeoFormulario;
     |HAZ ChequeoInforAdional;

     |SI nHayAdicional = 0;
         enError = 1;
         eaError = "0000No hay informaci¢n adicional de ajustes y deducciones ";
         eaError = eaError + "introducidas ";
         |SI nGraba = 0;
             |MENAV eaError;
         |FINSI;
         |HAZ GrabaError;
     |FINSI;
|FPRC;

|PROCESO LeeErrores;
    |SI enSwLinea = 0;
        eaSwLinea = #isozw001#2;
    |FINSI;
    |SI eaSwLinea ! #isozw001#2;
        enSwLinea = 2; |PRINT;
        enSwLinea = 1;
    |FINSI;
    |PRINT;
    enSwLinea = 1;
    eaSwLinea = #isozw001#2;
|FPRC;

|DEFBUCLE LeeErrores;
    #isozw001#1;
    ;
    enAnyo, enEmpresa, " ", 0001;
    enAnyo, enEmpresa, "z", 9999;
    ;
    NULL, LeeErrores;
|FIN;

|PROCESO PrintChequeo;

     |SI enAviso ! 0; |O enError ! 0;
         |CONFI "0000NDesea imprimir la Relacion de Errores y Avisos";
         |SI FSalida ! 0;
             |ACABA;
         |FINSI;

         |IMPRE 0;
         |SI FSalida ! 0;
             |MENAV "    Proceso Interrumpido";
             |ACABA;
         |FINSI;

         |INFOR "isozw001";
         |SI FSalida ! 0;
             |MENAV "    No existe Informe";
             |FINIMP;
             |ACABA;
         |FINSI;

         enSwLinea = 0;
         eaSwLinea = "";
         |BUCLE LeeErrores;
         enSwLinea = 2; |PRINT;

         |PIEINF;
         |FININF;
         |FINIMP;
     |FINSI;
|FPRC;

|PROCESO GrabaError;
   nCError = nCError + 1;
   #isozw001#0 = enAnyo;
   #isozw001#1 = enEmpresa;
   #isozw001#2 = "E";
   #isozw001#3 = nCError;
   aAlfa = eaError - "0000";
   #isozw001#4 = aAlfa;
   |GRABA 020#isozw001.n;
   |LIBERA #isozw001;
|FPRC;

|PROCESO GrabaAviso;
   nCAviso = nCAviso + 1;
   #isozw001#0 = enAnyo;
   #isozw001#1 = enEmpresa;
   #isozw001#2 = "V";
   #isozw001#3 = nCAviso;
   aAlfa = eaError - "0000";
   #isozw001#4 = aAlfa;
   |GRABA 020#isozw001.n;
   |LIBERA #isozw001;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     FSalida = 3499;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     aFichero = ("2z" + Usuario) % 108;
     |NOME_DAT #isozw001#aFichero#;

     nGraba = 1;
     |SI PARAMETRO ! "INFORME";
         nGraba = 0;
         |DELINDEX #isozw001;
     |FINSI;

     |HAZ LeeEmpresa;

     |ABRE #isozw001;
     |SI PARAMETRO = "PANTALLA";           |HAZ Pantalla;            |FINSI;
     |SI PARAMETRO = "CHEQUEO";            |HAZ Chequeo;             |FINSI;
     |SI PARAMETRO = "CHEQUEOEMISION";     |HAZ ChequeoEmision;      |FINSI;
     |SI PARAMETRO = "CHEQUEOFORMULARIO";  |HAZ ChequeoFormulario;   |FINSI;
     |SI PARAMETRO = "INFORME";            |HAZ Chequeo;             |FINSI;
     |SI PARAMETRO ! "INFORME";            |HAZ PrintChequeo;        |FINSI;
     |CIERRA #isozw001;

     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;
     |PULSATECLA;

     |SI PARAMETRO ! "INFORME"; |DELINDEX #isozw001; |FINSI;
|FPRO;
