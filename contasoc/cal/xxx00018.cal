|FICHEROS;
    xxx00014  #00;
    xxx00005  #01;
|FIN;

|VARIABLES;
    FEstado  = 0;
    campos   = 0;
    var_ant  = 0;
    var_pen  = 0;
    borrando = "Pasando Saldo ...";

    &empresa = 0;
    &anyo    = 0;
|FIN;

|PROGRAMA;
|ATRI P; |ATRI I;
|PINTA 2433,borrando;
|ATRI 0;

|ABRE #0;
|ABRE #1;
#1#0   = empresa;
#1#116 = anyo - 1;
|LEE 040#1=;
|SI FSalida = 0;
   #0#0 = empresa;
   #0#1 = anyo;
   |LIBERA #0;
   |LEE 140#0=;
   FEstado = FSalida;
   |SI FSalida ! 0;
      |DDEFECTO #0;
      #0#0 = empresa;
      #0#1 = anyo;
   |FINSI;
   #0#2 = #1#10;
   #0#3 = #1#13;
   #0#5 = #1#19;
   #0#6 = #1#22;
   #0#7 = #1#25 + #1#28 + #1#31 + #1#34 + #1#37;
   #0#8 = #1#40;
   #0#10 = #1#49;
   #0#11 = #1#52;
   #0#12 = #1#55;
   #0#13 = #1#58;
   #0#14 = #1#61;
   #0#15 = #1#64;
   #0#25 = #1#70;
   #0#26 = #1#73;
   #0#27 = #1#76;
   #0#30 = #1#82;
   #0#31 = #1#85;
   #0#32 = #1#88;
   #0#35 = #1#94;
   #0#38 = #1#103;
   #0#39 = #1#106;
   #0#40 = #1#109;
   #0#41 = #1#112;
   |HAZ calcula;
   |SI FEstado = 0; |GRABA 141#0a; |SINO; |GRABA 141#0n; |FINSI;
|FINSI;
|BLIN 24;
|CIERRA #0;
|CIERRA #1;
|FPRO;

|PROCESO calcula;
|PARA campos = 44; |SI campos [ 85; |HACIENDO campos = campos + 1;
   var_ant = campos - 42;
   var_pen = campos + 42;
   #0var_pen = #0var_ant - #0campos;
|SIGUE;

#0#4  = #0#2  + #0#3;
#0#9  = #0#5  + #0#6  + #0#7  + #0#8;
#0#16 = #0#10 + #0#11 + #0#12 + #0#13 + #0#14 + #0#15;
#0#17 = #0#4  + #0#9  + #0#16;
#0#24 = #0#18 + #0#19 + #0#20 + #0#21 + #0#22 + #0#23;
#0#29 = #0#25 + #0#26 + #0#27 + #0#28;
#0#34 = #0#30 + #0#31 + #0#32 + #0#33;
#0#37 = #0#35 + #0#36;
#0#43 = #0#38 + #0#39 + #0#40 + #0#41 + #0#42;

#0#46 = #0#44 + #0#45;
#0#51 = #0#47 + #0#48 + #0#49 + #0#50;
#0#58 = #0#52 + #0#53 + #0#54 + #0#55 + #0#56 + #0#57;
#0#59 = #0#46 + #0#51 + #0#58;
#0#66 = #0#60 + #0#61 + #0#62 + #0#63 + #0#64 + #0#65;
#0#71 = #0#67 + #0#68 + #0#69 + #0#70;
#0#76 = #0#72 + #0#73 + #0#74 + #0#75;
#0#79 = #0#77 + #0#78;
#0#85 = #0#80 + #0#81 + #0#82 + #0#83 + #0#84;

#0#88  = #0#86 + #0#87;
#0#93  = #0#89 + #0#90 + #0#91 + #0#92;
#0#100 = #0#94 + #0#95 + #0#96 + #0#97 + #0#98 + #0#99;
#0#101 = #0#88 + #0#93 + #0#100;
#0#108 = #0#102 + #0#103 + #0#104 + #0#105 + #0#106 + #0#107;
#0#113 = #0#109 + #0#110 + #0#111 + #0#112;
#0#118 = #0#114 + #0#115 + #0#116 + #0#117;
#0#121 = #0#119 + #0#120;
#0#127 = #0#122 + #0#123 + #0#124 + #0#125 + #0#126;
|FPRC;
