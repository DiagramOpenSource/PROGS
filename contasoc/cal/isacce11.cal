|FICHEROS;
     isacce11 #0;
     maempr10 #200;
     isom0001 #101;

     isow9002 #904,MANTE;

     maacceso #100;

     :/integral/def/dsam0009 #509;
     :/integral/def/dsam0116 #516;
     :/basica/def/agitab99 #99;

     &clientes@ #715;
|FIN;

|VARIABLES;
   nVentana    = 0;
   nVent       = 0;
   nError      = 0;
   nValor      = 0;
   nHandle     = 0;
   nLabel      = 0;

   aPathSociedad = "";
   aDef          = "";
   aAlfa         = "";
   aTecla        = "";
   aError        = "";
   aF2           = "";
   aOrigen       = "";
   aDestino      = "";
   aIPRemoto     = "";
   aDocRemoto    = "";
   aDocServidor  = "";
   aAbre         = "";
   aBase         = "";
   aContenido    = "";
   aTexto        = "";

   nBoton1       = 0;
   nBoton2       = 0;
   nBoton3       = 0;
   nBoton4       = 0;
   nBoton509_1   = 0;
   nBoton509_2   = 0;
   nBoton509_3   = 0;
   nEBoton2      = 0;
   nEBoton4      = 0;
   nGrid         = 0;
   nGrid509      = 0;
   nPanta        = 0;
   nRango        = 0;
   nHandleTgz    = 0;
   nTree         = 0;
   nIdSalir      = 0;
   nBotonSal     = -1;

   aEsc1         = "";
   aEsc2         = "";
   aRetu         = "";

     {-1}sTree      = 0;
     sT_nID         = 0;
     sT_nOper       = 0;
     sT_aData       = "";

     {-1}aVent      = "";
         aVent1     = 0;
         aVent2     = 0;
         aVent3     = 0;
         aVent4     = 0;
         aVent5     = "";

     {2}nNivel      = 0;

     &empresa     = 0;
     &anyo        = 0;
     &nombre      = "";
     &nif         = "";
     &tipo        = "";
     &modo        = 0;
     &sw_mod      = 0;
     &SwAdic      = 0;
     &eParametro  = "FUERA09";
     &enCodCli    = 0;
     &enSwDeDonde = 0;
     &eaEntidad   = "";
     &eaOficina   = "";
     &eaDC        = "";
     &eaCuenta    = "";
     &enModelo    = 0;
     &enBanco     = 0;
     &enForzar    = 0;
     &eaPathAcrobat = "";
     &eaModelo      = "";
     &enAnyo        = 0;
     &enEmpresa     = 0;
     &fFechaChequeo = @;
     &enError       = 0;
     &fFechaDisol   = @;
     &eaDirTrabajo   = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaPathExplorador = "";
     &eaForzExplorador = "";
     &eaImpre          = "";
     &eaJusti          = "";
     &eaUnidadBasico   = "";
     &enEjercicio      = 0;
     &enModoConsulta   = 0;
|FIN;

|PROCESO BotonSalir;
     |FOCOTECLADO nBotonSal;

     |PTEC 806;
|FPRC;

|PROCESO PonBotonSalir;
     |SI nBotonSal ! -1;  |FIN_CONTROL_WINDOWS nBotonSal;  |FINSI;

     |CONTROL_SIMPLE 0, "BOTON,{{197}} sa&Lir", 3485, 3498, BotonSalir;
     nBotonSal = FSalida;
|FPRC;

|PROCESO QuitaBotonSalir;
     |SI nIdSalir  = -1;  |ACABA;  |FINSI;

     nIdSalir  = 0;
     InNivel   = nNivel1<-;
     nNivel1   = 0;
     |ESPECIFICA "IDBOTONTECLA", nNivel;

     nIdSalir = nNivel2;
     |FIN_CONTROL_WINDOWS nIdSalir;
     nIdSalir  = 1;

     |HAZ PonBotonSalir;
|FPRC;

|PROCESO EventoGrid;
     |SI FSalida = 1;  |O FSalida = 2;
         |HAZ QuitaBotonSalir;

         |ESTADO_CONTROL nTree, "ENABLE";
         |ESTADO_CONTROL nBoton2, "DISABLE";  nEBoton2 = 0;
         |ESTADO_CONTROL nBoton4, "DISABLE";  nEBoton4 = 0;
         |LEE 000#0=;
         |SI FSalida = 0;
             enEmpresa = #0#0;
             enAnyo    = #0#1;
             |ESTADO_CONTROL nBoton2, "ENABLE";  nEBoton2 = 1;
             |ESTADO_CONTROL nBoton4, "ENABLE";  nEBoton4 = 1;
         |FINSI;

         |SI nLabel ! -1;
              |FIN_CONTROL_WINDOWS nLabel;
         |FINSI;

         aAlfa = "LABEL,{{2}}" + (("00000" + #0#0) % -105) + " - " + #0#2;  |QBF aAlfa;
         |SI #0#6 = "N";
             aAlfa = aAlfa + " - NO IMPRESA";
         |SINO;
             aAlfa = aAlfa + " - IMPRESA";
         |FINSI;

         |CONTROL_SIMPLE nPanta, aAlfa, 2702, 2765, NULL;
         nLabel = FSalida;
     |FINSI;
|FPRC;

|PROCESO Boton2;
     |SI nEBoton2 = 0;  |ACABA;  |FINSI;

     |CONFI "0000NSeguro que quiere borrar el registro del impuesto de sociedades";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     empresa = #0#0;
     anyo    = #0#1;

     |LEE 101#0=;
     |SI FSalida = 0;
         |SUB_EJECUTA "z0000001;IMPUESTO";

         |BORRA 020#0a;
         |LIBERA #0;
     |FINSI;

     |LEE 000#0];

     |ESTADO_CONTROL nTree, "DISABLE";

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO BancoGnrl;
     aAlfa =  "Formas de pago general: (" + (("00000" + #0#0) % -105) + " / " + #0#1 + " " + #0#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";

     |VENTANA 0501, 1899, -1, 17, aAlfa;
     nVent  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     enCodCli = enEmpresa;
     |HAZ LeePersona;

     #904#0  = #715#88;
     #904#1  = #715#89;
     #904#2  = #715#90;
     #904#3  = #715#91;
     #904#4  = #715#92;
     #904#5  = #715#93;
     #904#6  = #715#104;
     #904#8  = #715#115;
     #904#9  = #715#116;

     |ABRE #516;
     #516#0 = #904#0;
     |LEE 000#516=;
     |SI FSalida ! 0;  |DDEFECTO #516;  |FINSI;
     |CIERRA #516;

     #904#7 = #516#5;

     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida = 0;
         |ABRE #715;
         #715#0 =  enEmpresa;
         |LEE 101#715=;
         |SI FSalida = 0;
             #715#88  = #904#0;
             #715#89  = #904#1;
             #715#90  = #904#2;
             #715#91  = #904#3;
             #715#92  = #904#4;
             #715#93  = #904#5;
             #715#104 = #904#6;
             #715#115 = #904#8;
             #715#116 = #904#9;
             |GRABA 020#715a;
             |LIBERA #715;
         |FINSI;
         |CIERRA #715;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;

|PROCESO Baja509;
     #509#0 = enEmpresa;
     #509#1 = 001;
|FPRC;

|PROCESO Alta509;
     #509#0 = enEmpresa;
     #509#1 = 999;
|FPRC;

|PROCESO Evento509;
     |SI FSalida = 1;   |O FSalida = 2;
         |LEE 000#509=;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |ESTADO_CONTROL nBoton509_2, "ENABLE";
         |ESTADO_CONTROL nBoton509_3, "ENABLE";
     |FINSI;

     |SI FSalida = 4;
         |HAZ ModificarBanco;
     |FINSI;
|FPRC;

|PROCESO AltaBanco;
     |ABRE #99;
     #99#0 = 200;
     |LEE 000#99=;
     |CONSULTA_CLAVE #1#99;
     |SI FSalida ! 0;  |CIERRA #99;  |ACABA;  |FINSI;
     |CIERRA #99;

     #509#0 = enEmpresa;
     #509#1 = #99#0;
     |LEE 000#509=;
     |SI FSalida = 0;
         |MENAV "0000Ya existe el banco con este modelo en la empresa.";
         |ACABA;
     |FINSI;

     |DDEFECTO #509;
     #509#0 = enEmpresa;
     #509#1 = #99#0;
     #509#2 = #99#1;
     |GRABA 020#509b;

     aAlfa =  "Formas de pago modelo: " + #509#1;  |QBF aAlfa;

     |VENTANA 0501, 1899, -1, 17, aAlfa;
     nVent  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #904#0  = #509#3;
     #904#1  = #509#4;
     #904#2  = #509#5;
     #904#3  = #509#6;
     #904#4  = #509#7;
     #904#5  = #509#8;
     #904#6  = #509#9;
     #904#7  = #509#10;
     #904#8  = #509#18;
     #904#9  = #509#12;

     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida = 0;
         #509#3  = #904#0;
         #509#4  = #904#1;
         #509#5  = #904#2;
         #509#6  = #904#3;
         #509#7  = #904#4;
         #509#8  = #904#5;
         #509#9  = #904#6;
         #509#10 = #904#7;
         #509#18 = #904#8;
         #509#12 = #904#9;
         |GRABA 020#509a;
     |SINO;
         |BORRA 020#509a;
     |FINSI;
     |LIBERA #509;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;

     |REFRESCACONTROL nGrid509;
     |FOCOTECLADO nGrid509;
|FPRC;

|PROCESO ModificarBanco;
     |LEE 101#509=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa =  "Formas de pago modelo: " + #509#1;  |QBF aAlfa;

     |VENTANA 0501, 1899, -1, 17, aAlfa;
     nVent  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     #904#0  = #509#3;
     #904#1  = #509#4;
     #904#2  = #509#5;
     #904#3  = #509#6;
     #904#4  = #509#7;
     #904#5  = #509#8;
     #904#6  = #509#9;
     #904#7  = #509#10;
     #904#8  = #509#18;
     #904#9  = #509#12;

     |PINPA #0#904;
     |PINDA #0#904;
     |ENDATOS #1#904;
     |SI FSalida = 0;
         #509#3  = #904#0;
         #509#4  = #904#1;
         #509#5  = #904#2;
         #509#6  = #904#3;
         #509#7  = #904#4;
         #509#8  = #904#5;
         #509#9  = #904#6;
         #509#10 = #904#7;
         #509#18 = #904#8;
         #509#12 = #904#9;

         |GRABA 020#509a;
     |FINSI;
     |LIBERA #509;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;

     |REFRESCACONTROL nGrid509;
     |FOCOTECLADO nGrid509;
|FPRC;

|PROCESO BajaBanco;
     |LEE 101#509=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aAlfa = "0000NSeguro que quiere borrar el banco del modelo " + #509#1;
     |CONFI aAlfa;
     |SI FSalida ! 0;  |LIBERA #509;  |ACABA;  |FINSI;

     |BORRA 020#509a;
     |LIBERA #509;

     |REFRESCACONTROL nGrid509;
     |FOCOTECLADO nGrid509;
|FPRC;

|PROCESO Banco200;
     aAlfa = "Formas de pago por modelos: (" + (("00000" + #0#0) % -105) + " / " + #0#1 + " " + #0#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";

     |VENTANA 0501, 3499, -1, 17, aAlfa;
     nVent  = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |ABRE #509;
     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#509, nRango, 0502, 3198, Baja509, Alta509, Evento509;
     nGrid509 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}Alta ", 3264, 3274, AltaBanco;
     nBoton509_1 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}Borrar", 3288, 3298, BajaBanco;
     nBoton509_2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}Modificar", 3276, 3286, ModificarBanco;
     nBoton509_3 = FSalida;

     |ESTADO_CONTROL nBoton509_2, "DISABLE";
     |ESTADO_CONTROL nBoton509_3, "DISABLE";

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nGrid509;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |CIERRA #509;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA nVent;
|FPRC;


|PROCESO EmisionImpuesto;
     |SI nEBoton4 = 0;  |ACABA;  |FINSI;

     |SI #0#6 = "S";
         |CONFI "0000NEl impuesto est  impreso. Quiere dejarlo como no impreso y volverlo a emitir";
         |SI FSalida ! 0; |ACABA;  |FINSI;
     |FINSI;

     eaImpre   = "N";
     eaJusti   = "";
     enEmpresa = #0#0;
     enAnyo    = #0#1;
     |SUB_EJECUTA "isoy2011";

     |LEE 101#0=;
     |SI FSalida = 0;
         #0#6 = eaImpre;
         #0#7 = eaJusti;
         |GRABA 020#0a;
         |LIBERA #0;

         |REFRESCACONTROL nGrid;
     |FINSI;
|FPRC;

|PROCESO Justificante;
     |SI #0#6 ! "S";
         |MENAV "0000No est  emitido el modelo 200";
         |ACABA;
     |FINSI;

     |LEE 101#0=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1350, -1, 16, "N£mero de justificante obtenido";
     nVent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aAlfa = "LABEL,{{2}}N£mero de justificante ";
     |CONTROL_SIMPLE 0, aAlfa, 0902, 0920, NULL;

     eaJusti = #0#7;
     E_inf   = "";
     E_sup   = "16";

     |PARA;  |SI;  |HACIENDO;
          eaJusti = 0922 ? 1;
          |CONFI "0000SEl n£mero introducido es correcto";
          |SI FSalida = 0;  |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
     |FINVENTANA nVent;

     |PULSATECLA;

     #0#7 = eaJusti;
     |GRABA 020#0a;
     |LIBERA #0;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO DsArchi;
     aAlfa = (("00000" + #0#0) % -105) + #0#1 + "99" + "200" + "00";
     aAlfa = aAlfa + #0#2;

     aAlfa = "|:dsarchi/dsarz017;" + aAlfa;
     |SUB_EJECUTA aAlfa;
|FPRC;

|PROCESO Boton3;
     eaForzExplorador = "S";
     enEjercicio      = #0#1;
     |HAZ Explorador;
|FPRC;

|PROCESO Baja100;
     #100#0 = 1;
     #100#1 = 2011;
|FPRC;

|PROCESO Alta100;
     #100#0 = 99999;
     #100#1 = 2011;
|FPRC;

|PROCESO Boton1;
     |ABRE #100;
     #100#0 = #0#0;
     #100#1 = #0#1;
     |LEE 000#100=;
     |CONSULTA_F_CLAVE #5#100, Baja100, Alta100;
     |SI FSalida ! 0;  |CIERRA #100; |ACABA;  |FINSI;
     |CIERRA #100;

     #0#0   = #100#0;
     #0#1   = #100#1;
     |LEE 000#0=;
     |SI FSalida = 0;
         |MENAV  "0000La empresa ya ha sido abierta.";
         |ACABA;
     |FINSI;

     enEmpresa = #0#0;
     aAlfa         = "01.01." + #0#1;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;
     |SI enError = 2;
         aAlfa = "0000NEmpresa con fecha disolucion " + fFechaDisol + ". Continuar.";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |ERROR;
             |ACABA;
         |FINSI;
      |FINSI;


     |DDEFECTO #0;
     #0#0 = #100#0;
     #0#1 = #100#1;
     #0#2 = #100#2;
     #0#3 = #100#3;
     |GRABA 020#0n;
     |LIBERA #0;

     enEmpresa = #0#0;
     enAnyo    = #0#1;

     |SUB_EJECUTA "isoz0001";

     |LEE 000#0=;

     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO isom0001;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa =  aAlfa + "Liquidaci¢n (" + (("00000" + #0#0) % -105) + " / " + #0#1 + " " + #0#2;
     |QBF aAlfa;
     aAlfa = aAlfa + ")";

     |VENTANA 0501, 3399, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |SUB_EJECUTA "isom0001";

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;

     |HAZ PonBotonSalir;
|FPRC;

|PROCESO Ejecucion;
     enEmpresa = #0#0;
     enAnyo    = #0#1;

     |ESTADO_CONTROL nGrid, "DISABLE";
     |ESTADO_CONTROL nTree, "DISABLE";

     |SI aContenido = "isoy0001";  |SUB_EJECUTA "isoy0001";           aContenido = "";  |FINSI;
     |SI aContenido = "isoy0002";  |SUB_EJECUTA "isoy0002";           aContenido = "";  |FINSI;
     |SI aContenido = "borrador";  |SUB_EJECUTA "isoy2011;BORRADOR";  aContenido = "";  |FINSI;
     |SI aContenido = "BancoGnr";  |HAZ BancoGnrl;                    aContenido = "";  |FINSI;
     |SI aContenido = "Banco200";  |HAZ Banco200;                     aContenido = "";  |FINSI;
     |SI aContenido = "isoy2011";  |HAZ EmisionImpuesto;              aContenido = "";  |FINSI;
     |SI aContenido = "justific";  |HAZ Justificante;                 aContenido = "";  |FINSI;
     |SI aContenido = "dsarchi";   |HAZ DsArchi;                      aContenido = "";  |FINSI;

     |SI #0#6 = "S";  |Y aContenido ! "";
         |MENAV "0000El impuesto est  impreso. Se entrar  en MODO CONSULTA";

         enModoConsulta = 1;
     |FINSI;

     |SI aContenido = "isom0001";  |HAZ isom0001;            |FINSI;

     |SI aContenido = "isom0016";  |SUB_EJECUTA "isom0016";  |FINSI;
     |SI aContenido = "isow0013";  |SUB_EJECUTA "isow0013";  |FINSI;
     |SI aContenido = "isow0006";  |SUB_EJECUTA "isow0006";  |FINSI;
     |SI aContenido = "isow0007";  |SUB_EJECUTA "isow0007";  |FINSI;
     |SI aContenido = "isow0008";  |SUB_EJECUTA "isow0008";  |FINSI;
     |SI aContenido = "isow0009";  |SUB_EJECUTA "isow0009";  |FINSI;
     |SI aContenido = "isoz0001";  |SUB_EJECUTA "isoz0001";  |FINSI;
     |SI aContenido = "isoz0002";  |SUB_EJECUTA "isoz0002;PANTALLA";  |FINSI;

     |SI aContenido = "isom0017";  |SUB_EJECUTA "isom0017";  |FINSI;
     |SI aContenido = "isom0018";  |SUB_EJECUTA "isom0018";  |FINSI;
     |SI aContenido = "isom0019";  |SUB_EJECUTA "isom0019";  |FINSI;
     |SI aContenido = "isom0020";  |SUB_EJECUTA "isom0020";  |FINSI;

     |ESTADO_CONTROL nGrid, "ENABLE";
     |ESTADO_CONTROL nTree, "ENABLE";

     |LEE 000#isacce11.=;
|FPRC;

|PROCESO EventoTree;
     aContenido = Contenido % -108;

     |SI FEntrada = 0;
         aTexto  = Contenido;
         |ACABA;
     |FINSI;

     enModoConsulta = 0;

     |LEE 000#isacce11.=;

     |HAZ Ejecucion;

     |REFRESCACONTROL nGrid;  |PULSATECLA;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO CargaArbol;
     eaAlfa = eaAlfa + &13 + &10;
     |XGRABA nHandle, eaAlfa;
|FPRC;

|PROCESO MontaArbol;
     |PTEC 802;  |PAUSA;

     |HAZ LeeUnidadBasico;

     |DBASE aBase;  |QBF aBase;
     aAlfa = aBase + "tmp";      |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "tmp/";
     eaRutaDestino = eaUnidadBasico + "\MODELOS";            |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP";        |RMKDIR eaRutaDestino;
     eaRutaDestino = eaUnidadBasico + "\MODELOS\TMP\";
     eaFicheroTxt  = "isacce11" + Usuario + ".txt";
     eaFicheroTgz  = "isacce11" + Usuario + ".tgz";
     eaFicheroTar  = "isacce11" + Usuario + ".tar";

     sT_nID   = nTree;
     sT_nOper = 0;

     aAbre = eaRutaOrigen + eaFicheroTxt;
     |XABRE "WB", aAbre, nHandle;

     eaAlfa = "1:Liquidaci¢n {{isom0001}}";
     |HAZ CargaArbol;

     eaAlfa = "2:Apartados no contemplados en la liquidaci¢n {{}}";
     |HAZ CargaArbol;

     eaAlfa = "2,1:Presentaci¢n de documentaci¢n previa por Registro electr¢nico {{isom0016}}";
     |HAZ CargaArbol;

     eaAlfa = "2,2:R‚gimen especial de la reserva para inversiones en Canarias {{isow0013}}";
     |HAZ CargaArbol;

     eaAlfa = "2,3:Comunicaci¢n del importe neto de la cifra de negocio {{}}";
     |HAZ CargaArbol;

     eaAlfa = "2,3,1:Grupos de sociedades {{isow0006}}";
     |HAZ CargaArbol;

     eaAlfa = "2,3,2:No residentes de un establecimiento permanente {{isow0007}}";
     |HAZ CargaArbol;

     eaAlfa = "2,3,3:Entidades de cr‚dito, aseguradoras e instituciones inversi¢n colectiva {{isow0008}}";
     |HAZ CargaArbol;

     eaAlfa = "2,4:Operaciones de fusi¢n, escisi¢n y canje de valores {{isow0009}}";
     |HAZ CargaArbol;

     eaAlfa = "3:Informaci¢n adicional de ajustes y deducciones {{}}";
     |HAZ CargaArbol;

     eaAlfa = "3,1:Otras correcciones a la cuenta de PyG {{isom0017}}";
     |HAZ CargaArbol;

     eaAlfa = "3,2:Deducci¢n art¡culo 42 LIS {{isom0018}}";
     |HAZ CargaArbol;

     eaAlfa = "3,3:Deducci¢n por inversiones para protecci¢n medio ambiente {{isom0019}}";
     |HAZ CargaArbol;

     eaAlfa = "3,4:Deducci¢n por gastos en investigaci¢n y desarrollo e innovaci¢n tecnol¢gica {{isom0020}}";
     |HAZ CargaArbol;

     eaAlfa = "4:Utilidades {{}}";
     |HAZ CargaArbol;

     eaAlfa = "4,1:Carga de datos de contabilidad y del impuesto del ejercicio anterior {{isoz0001}}";
     |HAZ CargaArbol;

     eaAlfa = "4,2:Chequeo de totales {{isoz0002}}";
     |HAZ CargaArbol;

     eaAlfa = "5:Informes y emisiones {{}}";
     |HAZ CargaArbol;

     eaAlfa = "5,1:Informe de comprobaci¢n  {{isoy0001}}";
     |HAZ CargaArbol;

     eaAlfa = "5,2:Emisi¢n del formulario de la Informaci¢n adicional de ajustes y deducciones {{isoy0002}}";
     |HAZ CargaArbol;

     eaAlfa = "5,3:Borrador del modelo 200 sin validaci¢n {{borrador}}";
     |HAZ CargaArbol;

     eaAlfa = "5,4:Datos banco general {{BancoGnr}}";
     |HAZ CargaArbol;

     eaAlfa = "5,5:Datos banco por modelos {{Banco200}}";
     |HAZ CargaArbol;

     eaAlfa = "5,6:Emisi¢n modelo 200 {{isoy2011}}";
     |HAZ CargaArbol;

     eaAlfa = "5,7:Justificante de la declaraci¢n {{justific}}";
     |HAZ CargaArbol;

     |DBASS aBase;  |QBF aBase;
     aAlfa = aBase + "dsarchi/def/dsarz017.mas";
     |XABRE "E", aAlfa, nHandle;
     |SI FSalida ] 0;
         eaAlfa = "5,8:Consultar documentos en la gesti¢n documental (GAD) {{dsarchi}}";
         |HAZ CargaArbol;
     |FINSI;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aAlfa = eaRutaDestino + eaFicheroTxt;

     eaAlfa = "TREECTRL, Tabla de contenidos de la empresa seleccionada {{" + aAlfa + "}}";
     |CONTROL_SIMPLE nPanta, eaAlfa, 2802, 3598, EventoTree;
     nTree = FSalida;

     |ESTADO_CONTROL nTree, "DISABLE";

     eaFicheroTxt  = "isacce11" + Usuario + ".txt";
     aAlfa         = eaRutaDestino + eaFicheroTxt;
     |RFBORRA aAlfa;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO Baja0;
     #0#0 = 1;
     #0#1 = 2011;
|FPRC;

|PROCESO Alta0;
     #0#0 = 99999;
     #0#1 = 2011;
|FPRC;

|PROCESO Tipo80;   |TIPO 80;
     |ABRET #0;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90;   |TIPO 90;
     |CIERRAT #0;
|FPRC;

|PROGRAMA;
     |PINPA #0#0;
     nPanta = FSalida;

     |HAZ MontaArbol;

     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}nuevo &Registro", 2667, 2681, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{207}}&Borrar registro", 2684, 2698, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}explorador &Predeterminado", 3455, 3480, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{205}}&Emisi¢n modelo 200", 3402, 3425, EmisionImpuesto;
     nBoton4 = FSalida;

     |ESTADO_CONTROL nBoton2, "DISABLE";  nEBoton2 = 0;
     |ESTADO_CONTROL nBoton4, "DISABLE";  nEBoton4 = 0;

     nRango = 4 + 8 + 16 + 32 + 128;

     |LINEAL_SIMPLE #1#0, nRango, 0602, 2598, Baja0, Alta0, EventoGrid;
     nGrid = FSalida;

     aTecla = "";
     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         nIdSalir  = 0;

         FSalida = "::{{001}}sa&Lir," + nGrid;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
|FPRO;
