|FICHEROS;
    cubala13 #0;
|FIN;

|VARIABLES;
    repito = 0;
    sw_repito = 0;
    la_hoja = "";
    &ptas = "";
    &mile = "";
|FIN;

|INCLUYE impcuent;

|PROCESO abreviado;
|HAZ detalle;
    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        informe = "cubblai1";          || hoja empresa
    |HAZ aviso2;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "BA1";
        informe = "cubblaa1";          || hoja BA1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "BA2";
        informe = "cubblaa2";          || hoja BA2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "PA1";
        informe = "cubblaa3";          || hoja PA1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "PA2";
        informe = "cubblaa4";          || hoja PA2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;
|FPRC;

|PROCESO extenso;
|HAZ detalle;
    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        informe = "cubblai1";          || hoja empresa
    |HAZ aviso2;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B1 ";
        informe = "cubblae1";           || hoja B1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B2 ";
        informe = "cubblae2";           || hoja B2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B3 ";
        informe = "cubblae3";           || hoja B3
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B4 ";
        informe = "cubblae4";           || hoja B4
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B5 ";
        informe = "cubblae5";           || hoja B5
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P1 ";
        informe = "cubblae6";           || hoja P1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P2 ";
        informe = "cubblae7";           || hoja P2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P3 ";
        informe = "cubblae8";           || hoja P3
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P4 ";
        informe = "cubblae9";           || hoja P4
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;
|FPRC;

|PROCESO tipo_b;
#3#45 = #3#45 - #3#50;
#3#6  = #3#6  - #3#12;

#3#46 = #3#46 + #3#47 - #3#50;
#3#7  = #3#7  + #3#8  - #3#12;

|HAZ detalle;
    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        informe = "cubblai1";          || hoja empresa
    |HAZ aviso2;
    |HAZ impresion1;
|SIGUE;

                                       || Balance Abreviado

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "BA1";
        informe = "cubblaa1";          || hoja BA1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "BA2";
        informe = "cubblaa2";          || hoja BA2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;
                                       || Cuentas Extensas

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P1 ";
        informe = "cubblae6";           || hoja P1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P2 ";
        informe = "cubblae7";           || hoja P2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P3 ";
        informe = "cubblae8";           || hoja P3
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "P4 ";
        informe = "cubblae9";           || hoja P4
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;
|FPRC;

|PROCESO tipo_p;
#4#44 = #4#44 - #4#50;
#4#6  = #4#6  - #4#12;
#4#52 = #4#52 + #4#51;
#4#14 = #4#14 + #4#13;
#4#45 = #4#46 + #4#52;
#4#7  = #4#8  + #4#14;

#4#57 = #4#58 + #4#62 + #4#66;
#4#59 = #4#59 + #4#63 + #4#67;
#4#60 = #4#60 + #4#64 + #4#68;
#4#69 = #4#69 + #4#61 + #4#65;

#4#19 = #4#20 + #4#24 + #4#28;
#4#21 = #4#21 + #4#25 + #4#29;
#4#22 = #4#22 + #4#26 + #4#30;
#4#31 = #4#31 + #4#23 + #4#27;

|HAZ detalle;
    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        informe = "cubblai1";          || hoja empresa
    |HAZ aviso2;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B1 ";
        informe = "cubblae1";           || hoja B1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B2 ";
        informe = "cubblae2";           || hoja B2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B3 ";
        informe = "cubblae3";           || hoja B3
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B4 ";
        informe = "cubblae4";           || hoja B4
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "B5 ";
        informe = "cubblae5";           || hoja B5
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "PA1";
        informe = "cubblaa3";          || hoja PA1
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;

    repito = 0;
    sw_repito = 0;
|PARA; |SI repito = 0; |HACIENDO;
        la_hoja = "PA2";
        informe = "cubblaa4";          || hoja PA2
    |HAZ aviso1;
    |HAZ impresion1;
|SIGUE;
|FPRC;

|CALCULO detalle;
|SI #6#93 = 1;   ptas = "X";  mile = " ";  |FINSI;
|SI #6#93 = 2;   ptas = " ";  mile = "X";  |FINSI;
efFecha = #0#28;
|FCAL;

|PROCESO aviso1;
||           1234567890123456789012345678901234567890
    alfa1 = "        -- Coloque Hoja <" + la_hoja + "> --        ";
|HAZ avisos;
|FPRC;

|PROCESO aviso2;
||           1234567890123456789012345678901234567890
    alfa1 = "   -- Coloque Hoja Datos Generales --   ";
|HAZ avisos;
|FPRC;

|PROCESO avisos;
|PUSHV 05012380;
|ATRI P;
|CUADRO 21 30 23 71;
|ATRI 0;
|ATRI R;
|PINTA 2231, alfa1;
|ATRI 0;
|FPRC;

|CALCULO impresion1;
|SI sw_repito = 0;
    |CONFI "0000S¨Desea imprimir esta hoja?: ";
        repito = FSalida;
    |SI FSalida = 0;
        |HAZ informe;
        |HAZ impresion2;
    |FINSI;
|SINO;
    |HAZ informe;
    |HAZ impresion2;
|FINSI;
|FCAL;

|CALCULO impresion2;
|CONFI "0000N¨Desea repetir el impreso?: ";
    repito = FSalida;
    sw_repito = 1;
|POPV;
|FCAL;
