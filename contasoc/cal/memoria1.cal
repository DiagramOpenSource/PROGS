|FICHEROS;
     memoria1 #0;            || Fichero emision
     meempmem #1;            || Fichero empresas memoria
     metextos #3;            || Fichero de Textos
     meestrca #4;            || Cabecera de Estructuras
     meestrli #5;            || Lineas de Estructuras
     medescri #10;           || Descripciones claves

     mem5inma #11;
     mem5mate #12;
     mem5fina #13;
     mem8cabe #14;
     mem8line #15;
     mem9gtos #16;
     mem8ltmp #17;
     mem10amb #110;          || Medio Ambiente
     sodacoli #6;            || Lineas Entrada de Contabilidad
     soplanli #7;            || Lineas Planillas
     sodacuen #8;

     isw00016 #100;

     :/basica/def/agicen14 #45;  || Censo
     :/basica/def/agim0028 #28;  || Ficha de Sociedades Cabeceras
     :/basica/def/agim0019 #19;  || Ficha de Sociedades Lineas
     :/basica/def/agim0024 #24;  || Representantes/Administradores
     :/basica/def/agim0025 #25;  || Socios
     :/basica/def/agim0026 #26;  || Cargos

     &clientes@ #715;
|FIN;

|VARIABLES;
     PathCliente    = "";
     PathSociedad   = "";
     PathFichbasica = "";
     &enPlan        = 0;
     &eaPlanillaS   = "";
     &enEjerS       = 0;
     aAlfa    = "";
     regi     = 0;
     fichita  = 0;
     x        = 0;
     sw_pan   = 0;
     sw_emp   = 0;
     empresa  = 0;
     sw       = 0;
     pepe     = 0;
     y        = 0;
     swmovi   = 0;
     swcuenta = 0;
     mas      = 0;
     menos    = 0;
     ini      = 0;
     total    = 0;
     swimpre  = 0;
     leng     = 0;
     z        = 0;
     descri   = "";
     direct     = "";
     vari1      = "";
     vari2      = "";
     cuenta     = "";
     importe    = "";
     importe1   = "";
     importe2   = "";
     importe3   = "";
     importe4   = "";
     impor1     = "";
     impor2     = "";
     impor3     = "";
     impor4     = "";
     len        = "";
     vari       = "";
     desde      = "";
     hasta      = "";
     numero     = "";
     asiento    = "";
     aste       = "";
     pantalla   = "";
     pantalla1  = "";
     sw_final   = 0;

     XPara      = 0;
     XPara1     = 0;
     XPara2     = 0;
     Base       = "";
     NombreFich = "";
     Handle     = "";
     Field      = "";
     Valfa      = "";
     Valfa1     = "";
     Valfa2     = "";
     Nume1      = 0;
     Nume2      = 0;
     Nume3      = 0;
     XCampos    = 0;
     Contador   = 0;
     Origen     = "";
     Destino    = "";
     nSuma      = 0;

     &blanco40 = "                                        ";
     &blanco30 = "                              ";
     &variable = "";
     &variabl1 = "";
     &variabl2 = "";
     &alfa     = "";
     &alfa1    = "";
     &hoja     = 0;
     &sw_print = 0;
     &acabalo  = 0;
     &eImpresora = "";
     &enEmpresa  = 0;
     &eaSalto    = "";
     &enHoja     = 0;
     &eaHoja     = "";
     &eaMoneda    = "";
     &enCanti     = 0;
     &enSwTrata   = 0;
     &eaImporte   = "";
     &eaUnidadBasico = "";

     &enCodCli    = 0;
     &enSwDeDonde = 0;
     &EURODB      = 0;
     nSwMedAmb    = 0;
     &eaMemSoc    = "";

     linea        = 0;
     campo        = 0;
     tip1         = "";
     fichero      = "";
     ultlin       = 0;
     informe      = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     aAlfa4       = "";
     aAlfa5       = "";
     aAlfa6       = "";
     nNume4       = 0;
     &enMem8      = 0;

     &enBasImp  = 0;
     &eaNomImp  = "";
     &efFecLeg  = @;
     &eaDatLeg  = "";
     aParam     = "";
|FIN;

|PROCESO nomodi; |TIPO 7;
  |C_M #0#11, 1, "S";
  |SI #0#10 = "N"; |C_M #0#11, 1, "N";  |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 7;
     |HAZ PintaMoneda;
     #0#17 = eaMoneda;

     |PINTA #0#17;
|FPRC;

|| *************************************************************************
||                         IMPRESION FICHA DE SOCIEDADES
|| *************************************************************************

|PROCESO Actividades;
  Contador = Contador + 1;
  |SI Contador = 1;
      #100#9  = #45#5;                                   || Fecha  Actividad
      #100#10 = #45#4;                                   || Nombre Actividad
      #100#11 = #45#2 + " " + #45#3;                     || Epigrafe
  |FINSI;

  |SI Contador = 2;
      #100#12 = #45#5;                                   || Fecha  Actividad
      #100#13 = #45#4;                                   || Nombre Actividad
      #100#14 = #45#2 + " " + #45#3;                     || Epigrafe
  |FINSI;
|FPRC;

|DEFBUCLE agicen14;
  #45#1;
  ;
  #19#0, 00;
  #19#0, 99;
  ;
  NULL, Actividades;
|FIN;

|PROCESO Socios;
  Contador = Contador + 1;  #100Contador = #25#4;        || Nombre
  Contador = Contador + 1;  #100Contador = #25#3;        || NIF
  Contador = Contador + 1;  #100Contador = #25#14;       || Numero
  Contador = Contador + 1;  #100Contador = #25#13;       || % Participacion

  |SI Contador = 59;  |ERROR10;  |FINSI;
|FPRC;

|DEFBUCLE agim0025;
  #25#1;
  ;
  #19#0, #19#1, 000;
  #19#0, #19#1, 999;
  ;
  NULL, Socios;
|FIN;

|PROCESO Cargos;
  |SI #26#16 = 1;
      #100#87 = #26#4;
      #100#88 = (#26#7 * 1000) + #26#8;
      #100#89 = #26#6;
      #100#90 = #26#5;
      #100#91 = #26#3;
      #100#92 = #26#12;
      #100#93 = #26#14;
      #100#94 = #26#15
  |FINSI;

  |SI #26#16 = 2;
      #100#95  = #26#4;
      #100#96  = #26#3;
      #100#97  = #26#12;
      #100#98  = #26#5;
      #100#99  = #26#6;
      #100#100 = (#26#7 * 1000) + #26#8;
      #100#101 = #26#14;
      #100#102 = #26#15
  |FINSI;

  |SI #26#16 = 3;
      #100#103 = #26#4;
      #100#104 = #26#3;
      #100#105 = #26#12;
      #100#106 = #26#5;
      #100#107 = #26#6;
      #100#108 = (#26#7 * 1000) + #26#8;
      #100#109 = #26#14;
      #100#110 = #26#15
  |FINSI;

  |SI #26#16 = 4;
      #100#111 = #26#4;
      #100#112 = #26#3;
      #100#113 = #26#12;
      #100#114 = #26#5;
      #100#115 = #26#6;
      #100#116 = (#26#7 * 1000) + #26#8;
      #100#117 = #26#14;
      #100#118 = #26#15
  |FINSI;

  |SI #26#16 = 5;
      #100#119 = #26#4;
      #100#120 = #26#3;
      #100#121 = #26#12;
      #100#122 = #26#5;
      #100#123 = #26#6;
      #100#124 = (#26#7 * 1000) + #26#8;
      #100#125 = #26#14;
      #100#126 = #26#15
  |FINSI;

  |SI #26#16 = 6;
      #100#127 = #26#4;
      #100#128 = #26#3;
      #100#129 = #26#12;
      #100#130 = #26#5;
      #100#131 = #26#6;
      #100#132 = (#26#7 * 1000) + #26#8;
      #100#133 = #26#14;
      #100#134 = #26#15
  |FINSI;

  |SI #26#16 = 7;
      Valfa = #100#60;  |QBT Valfa;
      |SI Valfa = "";
          #100#60 = #26#4;
          #100#61 = #26#13;
          #100#62 = #26#14;
          #100#63 = #26#15;
          |ACABA;
      |FINSI;

      Valfa = #100#64;  |QBT Valfa;
      |SI Valfa = "";
          #100#64 = #26#4;
          #100#65 = #26#13;
          #100#66 = #26#14;
          #100#67 = #26#15;
          |ACABA;
      |FINSI;

      Valfa = #100#68;  |QBT Valfa;
      |SI Valfa = "";
          #100#68 = #26#4;
          #100#69 = #26#13;
          #100#70 = #26#14;
          #100#71 = #26#15;
          |ACABA;
      |FINSI;
  |FINSI;

  |SI #26#16 = 8;
      #100#72 = #26#4;
      #100#73 = #26#14;
      #100#74 = #26#15;
      |ACABA;
  |FINSI;

  |SI #26#16 = 9;
      Valfa = #100#75;  |QBT Valfa;
      |SI Valfa = "";
          #100#75 = #26#4;
          #100#76 = #26#13;
          #100#77 = #26#14;
          #100#78 = #26#15;
          |ACABA;
      |FINSI;

      Valfa = #100#79;  |QBT Valfa;
      |SI Valfa = "";
          #100#79 = #26#4;
          #100#80 = #26#13;
          #100#81 = #26#14;
          #100#82 = #26#15;
          |ACABA;
      |FINSI;

      Valfa = #100#83;  |QBT Valfa;
      |SI Valfa = "";
          #100#83 = #26#4;
          #100#84 = #26#13;
          #100#85 = #26#14;
          #100#86 = #26#15;
          |ACABA;
      |FINSI;
  |FINSI;
|FPRC;

|DEFBUCLE agim0026;
  #26#1;
  ;
  #19#0, #19#1, 00;
  #19#0, #19#1, 99;
  ;
  NULL, Cargos;
|FIN;

|PROCESO CargaFicha;
  enCodCli = #0x;
  |HAZ LeePersona;

  |ABRE #28;
  #28#0 = #0x;
  |LEE 040#28=;
  |SI FSalida ! 0;  |DDEFECTO #28;  |FINSI;
  |CIERRA #28;

  |ABRE #19;
  #19#0 = #0x;
  #19#1 = 99;
  |LEE 040#19];
  |SI FSalida = 0;
      |LEE 040#19a;
  |SINO;
      |LEE 040#19u;
  |FINSI;
  |SI FSalida ! 0;  |O #19#0 ! #0x;
      |DDEFECTO #19;
  |FINSI;
  |CIERRA #19;

  |SI enSwDeDonde = 1;
      aAlfa  = #715#19;  |QBF aAlfa;
      |SI aAlfa ! "";
          aAlfa  = aAlfa + " " + #715#20;
      |SINO;
          aAlfa  = #715#20;
      |FINSI;
      |QBF aAlfa;

      |SI #715#21 ! "    ";
          aAlfa = aAlfa + " Num: " + #715#21;
      |FINSI;
      |QBF aAlfa;

      |SI #715#22 ! "   ";
          aAlfa = aAlfa + " Esc: " + #715#22;
      |FINSI;
      |QBF aAlfa;

      |SI #715#23 ! "  ";
          aAlfa = aAlfa + " Piso: " + #715#23;
      |FINSI;
      |QBF aAlfa;

      |SI #715#24 ! "  ";
          aAlfa = aAlfa + " Pta: " + #715#24;
      |FINSI;
      |QBF aAlfa;

      #100#4   = aAlfa;                                     || Domicilio
      #100#5   = #715#27;                                   || Poblacion
      #100#153 = (#715#25 * 1000) + #715#26;                || Codigo Postal
      #100#154 = (#715#15 * 1000) + #715#16;                || Codigo Hacienda
  |SINO;
      aAlfa  = #715#3;  |QBF aAlfa;
      |SI aAlfa ! "";
          aAlfa  = aAlfa + " " + #715#4;
      |SINO;
          aAlfa  = #715#4;
      |FINSI;
      |QBF aAlfa;

      |SI #715#5 ! "    ";
          aAlfa = aAlfa + " Num: " + #715#5;
      |FINSI;
      |QBF aAlfa;

      |SI #715#6 ! "   ";
          aAlfa = aAlfa + " Esc: " + #715#6;
      |FINSI;
      |QBF aAlfa;

      |SI #715#7 ! "  ";
          aAlfa = aAlfa + " Piso: " + #715#7;
      |FINSI;
      |QBF aAlfa;

      |SI #715#8 ! "  ";
          aAlfa = aAlfa + " Pta: " + #715#8;
      |FINSI;
      |QBF aAlfa;

      #100#4   = aAlfa;                                     || Domicilio

      #100#5   = #715#11;                                   || Poblacion
      #100#153 = (#715#9  * 1000) + #715#10;                || Codigo Postal
      #100#154 = (#715#63 * 1000) + #715#64;                || Codigo Hacienda
  |FINSI;

  #100#0   = #19#0;                                     || Empresa
  #100#1   = #19#1;                                     || Registro
  #100#2   = #28#2;                                     || Nombre Empresa
  #100#3   = #28#3;                                     || CIF
  #100#6   = #28#5;                                     || Telefono
  #100#7   = #19#11;                                    || Constitucion
  #100#8   = #19#8;                                     || Notaria
  #100#15  = #19#29;                                    || Tomo
  #100#16  = #19#30;                                    || Libro
  #100#17  = #19#31;                                    || Seccion
  #100#18  = #19#32;                                    || Folio
  #100#19  = #19#33;                                    || Hoja
  #100#20  = #19#34;                                    || Inscripcion

  #100#21  = #19#14;                                    || Capital Social
  #100#23  = #19#16;
  #100#27  = #19#20;
  #100#31  = #19#24;

  |SI EURODB = 0;  |Y #19#51 = "E";
      #100#21  = (#19#14 * 166.386) ! EURODB;           || Capital Social
      #100#23  = (#19#16 * 166.386) ! EURODB;
      #100#27  = (#19#20 * 166.386) ! EURODB;
      #100#31  = (#19#24 * 166.386) ! EURODB;
  |FINSI;

  |SI EURODB ! 0;  |Y #19#51 = "P";
      #100#21  = (#19#14 / 166.386) ! EURODB;           || Capital Social
      #100#23  = (#19#16 / 166.386) ! EURODB;
      #100#27  = (#19#20 / 166.386) ! EURODB;
      #100#31  = (#19#24 / 166.386) ! EURODB;
  |FINSI;

  #100#22  = #19#15;                                    || Acciones Nominativas
  #100#24  = #19#17;                                    || Desde N§
  #100#25  = #19#18;                                    || Hasta N§
  #100#26  = #19#19;                                    || Acciones al portador
  #100#28  = #19#21;                                    || Hasta N§
  #100#29  = #19#22;                                    || Acciones
  #100#30  = #19#23;                                    || Participaciones socios
  #100#159 = #19#28;                                    || Fecha Inscrip.
  #100#160 = #19#27;                                    || Localidad Registr.


  Contador = 0;  |BUCLE agicen14;
  |SI Contador = 0;
      #100#9  = #19#7;                                   || Fecha  Actividad
      #100#10 = #19#48;                                  || Nombre Actividad
      #100#11 = #19#46 + " " + #19#47;                   || Epigrafe
      #100#12 = "";                                      || Fecha  Actividad
      #100#13 = "";                                      || Nombre Actividad
      #100#14 = "";                                      || Epigrafe
  |FINSI;

  Contador = 31; |BUCLE agim0025;
  Contador = 0;  |BUCLE agim0026;
|FPRC;

|PROCESO impreficha;
  |HAZ CargaFicha;

  |SI acabalo = 3;  |O acabalo = 4;
      #0#12 = "N";
      #0#13 = "S";
      #0#14 = "N";

      |SI acabalo = 3;  |INFOR "memoripo";  |FINSI;
      |SI acabalo = 4;  |INFOR "memorips";  |FINSI;
  |SINO;
      |SI acabalo = 2;  |ACABA;  |FINSI;

      |SI #0#13 = "S";  |INFOR "memori01";  |FINSI;
      |SI #0#13 = "N";  |INFOR "memori81";  |FINSI;
  |FINSI;

  |SI FSalida = 0;
      |PRINT;
      |PIEINF;
      |FININF;

      |SI acabalo = 3;  |O acabalo = 4;
          hoja = hoja + 1;
      |FINSI;
  |FINSI;
|FPRC;

|| *************************************************************************
||                         IMPRESION DE CUENTAS
|| *************************************************************************

|PROCESO Print;
  Valfa    = variable + (" " * 100)
  variabl1 = Valfa % 150;
  variabl2 = Valfa % 5150;

  |PRINT;
|FPRC;

|PROCESO Print2;
  enMem8 = 1;
  |PRINT;
  enMem8 = 0;
|FPRC;

|PROCESO impremovi;
  |SI swcuenta = 0;
      |SI sw_final = 1;
          |ABRE #8;
          #8#2 = enPlan;
          #8#0 = numero;
          |LEE 040#8=;
          |SI FSalida ! 0; |DDEFECTO #8; |FINSI;
          |CIERRA #8;
          cuenta   = numero;
          descri   = #8#1;
      |SINO;
          cuenta   = #6#3;
          descri   = #6#4;
      |FINSI;

      swimpre  = 1;
      swcuenta = 1;
      |SI swmovi = 0;
              variable = ""; |HAZ Print; |HAZ Print;
              variable = "                         SITUACIONES DE LAS CUENTAS ";
              |HAZ Print;
              variable = "                         -------------------------- ";
              |HAZ Print;
              variable = ""; |HAZ Print;
              swmovi   = 1;
      |FINSI;
  |FINSI;

  |SI cuenta ! #6#3; |Y sw_final = 0;
          variable = "       " + cuenta + "  " + descri;
          |HAZ Print;
          variable = "              S.Inicial       Aumentos  Disminuciones        S.Final";
          |HAZ Print;
          variable = "           --------------------------------------------------------";
          |HAZ Print;
          importe = mas;   |HAZ importe; importe1 = importe;
          importe = menos; |HAZ importe; importe2 = importe;
          importe = ini;   |HAZ importe; importe3 = importe;
          total = (mas + ini) - menos;
          importe = total; |HAZ importe; importe4 = importe;
          variable = "          " + importe3 + "  " + importe1 + "  " + importe2 + "  " + importe4;
          |HAZ Print;
          mas = 0;  menos = 0;  ini = 0;  total = 0;
          variable = ""; |HAZ Print; |HAZ Print;
          cuenta   = #6#3;
          descri   = #6#4;
  |FINSI;

  |SI #7#8 = "D";
      mas   = mas   + #6#6;
      menos = menos + #6#7;
      ini   = ini   + #6#5;
  |SINO;
      mas   = mas   + #6#7;
      menos = menos + #6#6;
      ini   = ini   + -#6#5;
  |FINSI;
|FPRC;

|DEFBUCLE cuentas;
  #6#2;                    || Bucle de lineas de movimientos
  ;
  #1#0, #1#5, desde;
  #1#0, #1#5, hasta;
  be;
  NULL,impremovi;
|FIN;

|PROCESO cuenlin;
  swcuenta = 0;
  vari   = #7#2; |QBF vari;
  aste   = vari % -101;
  len    = vari % 0;
  leng   = len - 1;
  leng   = 100 + leng;
  numero = vari % leng;
  sw_final = 0;

  |SI aste = "*"; |O aste = ".";
      |SI aste = "."; sw_final = 1; |FINSI;
      desde = numero + "            ";
      desde = desde % 112;
      hasta = numero + "zzzzzzzzzzzz";
      hasta = hasta % 112;
      |BUCLE cuentas ;
  |SINO;
      desde = #7#2;
      hasta = #7#2;
      |BUCLE cuentas;
  |FINSI;

   |SI swimpre = 1;
          variable = "       " + cuenta + "  " + descri;
          |HAZ Print;
          variable = "              S.Inicial       Aumentos  Disminuciones        S.Final";
          |HAZ Print;
          variable = "           --------------------------------------------------------";
          |HAZ Print;
          importe = mas;   |HAZ importe; importe1 = importe;
          importe = menos; |HAZ importe; importe2 = importe;
          importe = ini;   |HAZ importe; importe3 = importe;
          total = (mas + ini) - menos;
          importe = total; |HAZ importe; importe4 = importe;
          variable = "          " + importe3 + "  " + importe1 + "  " + importe2 + "  " + importe4;
          |HAZ Print;
          mas = 0;  menos = 0;  ini = 0;  total = 0;
          swimpre = 0;
          variable = ""; |HAZ Print; |HAZ Print;
  |FINSI;
|FPRC;

|DEFBUCLE planilla;
  #7#2;
  ;
  #1#4, pepe;
  #1#4, pepe;
  e;
  NULL, cuenlin;
|FIN;

|PROCESO movimi;
  |BUCLE planilla;
  swmovi = 0;
|FPRC;

|| *************************************************************************
||                         IMPRESION DE TEXTOS
|| *************************************************************************

|PROCESO print1;
  |SI sw_pan = 0;
      sw_pan = 1;
      pantalla = #3#0 + #3#1;
  |FINSI;

  |ABRE #10;
  #10#0 = #3#0;
  |LEE 040#10=;
  |SI FSalida ! 0; |DDEFECTO #10; |FINSI;

  pantalla1 = #3#0 + #3#1;
  |SI pantalla ! pantalla1;
      sw_emp = 0;
      pantalla = pantalla1;
  |FINSI;

  |SI #3#17 = empresa; sw_emp = 1; |VETE impresio; |FINSI;
  |SI #3#17 = 0;                   |VETE impresio; |FINSI;

  |SI #3#17 = 99998; |Y sw_emp = 0;
      |VETE impresio;
  |SINO;
      |ACABA;
  |FINSI;

  |ET impresio;

  |SI nSwMedAmb = 0; |Y #3#0 = 100100; |ACABA; |FINSI;
  |SI nSwMedAmb = 1; |Y #3#0 = 100000; |ACABA; |FINSI;

  |SI acabalo = 2;  |O acabalo = 3;  |O acabalo = 4;
      |INFOR "memodepo";
  |SINO;
      |INFOR "memori02";
   |FINSI;

  |SI sw = 0;
     alfa     = #3#0;             || Recoge los dos primeros digitos del primer
     alfa     = "000000" + #3#0;  || registro para compararlos con sucesivos
     alfa     = alfa % -502;      || registros
     sw       = 1;
     pepe     =  #3#0;

     variable = "                    " + #10#1; |QBF variable;

     |SI variable ! "";
         sw_print = 1;  |HAZ Print;
         sw_print = 0;
     |FINSI;
  |FINSI;

  alfa1 = #3#0;            || Recoge los dos primeros digitos de la clave;
  alfa1 = "000000" + #3#0; || de la clave actual
  alfa1 = alfa1 % -502;

  aAlfa3 = #3#0; aAlfa3 = ("000000" + aAlfa3) % -106; aAlfa3 = aAlfa3 % 102;
  aAlfa4 = #3#0; aAlfa4 = ("000000" + aAlfa4) % -106; aAlfa4 = aAlfa4 % 302;
  |SI #3#33 = "aumeydis";  |Y #1#4 = 10;
      alfa = alfa1;
      alfa1 = "";
  |FINSI;
  |SI aAlfa3 = "05";
      |SI aAlfa4 = "02"; |O aAlfa4 = "03"; |O aAlfa4 = "04";
          aAlfa3 = "memori";
          |SI aAlfa4 = "02"; |Y #11#20 ! -1; alfa = alfa1; alfa1 = ""; |FINSI;
          |SI aAlfa4 = "03"; |Y #12#16 ! -1; alfa = alfa1; alfa1 = ""; |FINSI;
          |SI aAlfa4 = "04"; |Y #13#16 ! -1; alfa = alfa1; alfa1 = ""; |FINSI;
      |FINSI;
  |SINO;
      |SI aAlfa3 = "09";
          aAlfa3 = "memori";
          aAlfa4 = "09";
          |SI #16#22 ! -1; alfa = alfa1; alfa1 = ""; |FINSI;
      |FINSI;
  |FINSI;

  |SI alfa ! alfa1;
     |HAZ movimi;          || Rutina para comprobar si hay o no movimientos

     FSalida = "PAGINA";      || salto de pagina
     pepe = #3#0;

     variable = "                    " + #10#1; |QBF variable;

     |SI variable ! "";
         sw_print = 1;  |HAZ Print;
         sw_print = 0;
     |FINSI;
  |SINO;
      |SI pepe ! #3#0;
          |HAZ movimi;          || Rutina para comprobar si hay o no movimientos
          variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;
          pepe = #3#0;

          variable = "                    " + #10#1; |QBF variable;

          |SI variable ! "";
              sw_print = 1;  |HAZ Print;
              sw_print = 0;
          |FINSI;
      |FINSI;
  |FINSI;

  |PARA y = 2; |SI y [ 16; |HACIENDO y = y + 1;
        variable = #3y;
        XCampos  = y + 16;
        |QBF variable;
        |SI variable ! "";
            |SI variable = "."; variable = ""; |FINSI;

            |HAZ Print;
        |FINSI;
        alfa = alfa1;            || Si los registros son diferentes
  |SIGUE;

  |SI #3#0  = 030000;  |Y #3#1 = 0;  |HAZ cero3;     |FINSI;
  |SI #3#0  = 060000;  |Y #3#1 = 0;  |HAZ cero6;     |FINSI;
  |SI #3#0  = 080000;  |Y #3#1 = 0;  |HAZ empregrup; |FINSI;
  |SI #3#33 = "aumeydis";            |HAZ aumeydis;  |FINSI;
  |SI #3#33 = "otrainfo";            |HAZ otrainfo;  |FINSI;
  |SI aAlfa3 = "memori";             |HAZ c3memoria; |FINSI;
  |SI #3#0  = 100100;  |Y #3#1 = 0;  |HAZ MedioAmb;  |FINSI;
|FPRC;

|DEFBUCLE pantatext;
  #3#1;
  ;
  #5#2, #5#3, 00000;               ||  Bucle de pantalla de textos
  #5#4, #5#5, 99999;
  be;
  NULL,print1;
|FIN;

|PROCESO texto;
  |BUCLE pantatext;                  || Bucle de pantallas de textos
|FPRC;

|PROCESO impretexto;
  |ABRE #1;
  |ABRE #4;

  #1#0 = #0x;
  |LEE 040#1=;           || Lee empresa memoria para saber la estructura

  enPlan = 2008;
  |SI #1#5 < 2008; enPlan = 1990; |FINSI;

  |HAZ lee_memabr;
  #4#0 = #1#2;
  |LEE 040#4=;           || Lee la cabecera de estructuras

  |BUCLELIN 0texto#4;    || Bucle de lineas de estructuras
  |PIEINF;
  |FININF;
  |CIERRA #1;
  |CIERRA #4;
|FPRC;

|PROCESO lee_memabr;
  nSwMedAmb = 0;

  |ABRE #110;
  #110#0 = #1#0;
  #110#1 = #1#5; || Ejercicio
  |LEE 001#110=;
  |SI FSalida = 0;
      nSwMedAmb = 1;
  |FINSI;
  |CIERRA #110;

  |ABRE #11;
  #11#0 = #1#0;
  #11#1 = #1#5;
  |LEE 040#11=;
  |SI FSalida ! 0;
      |DDEFECTO #11;
      #11#0 = #1#0;
      #11#1 = #1#5;
      #11#20 = -1;
  |FINSI;
  |CIERRA #11;

  |ABRE #12;
  #12#0 = #1#0;
  #12#1 = #1#5;
  |LEE 040#12=;
  |SI FSalida ! 0;
      |DDEFECTO #12;
      #12#0 = #1#0;
      #12#1 = #1#5;
      #12#16 = -1;
  |FINSI;
  |CIERRA #12;

  |ABRE #13;
  #13#0 = #1#0;
  #13#1 = #1#5;
  |LEE 040#13=;
  |SI FSalida ! 0;
      |DDEFECTO #13;
      #13#0 = #1#0;
      #13#1 = #1#5;
      #13#16 = -1;
  |FINSI;
  |CIERRA #13;

  |ABRE #14;
  #14#0 = #1#0;
  #14#1 = #1#5;
  |LEE 040#14=;
  |SI FSalida ! 0;
      |DDEFECTO #14;
      #14#0 = #1#0;
      #14#1 = #1#5;
      #14#4  = -1;
  |FINSI;
  |CIERRA #14;

  |ABRE #16;
  #16#0 = #1#0;
  #16#1 = #1#5;
  |LEE 040#16=;
  |SI FSalida ! 0;
      |DDEFECTO #16;
      #16#0  = #1#0;
      #16#1  = #1#5;
      #16#22 = -1;
  |FINSI;
  |CIERRA #16;
|FPRC;

|| *************************************************************************
||                         IMPRESION PANTALLA DE MEMORIA
|| *************************************************************************
|PROCESO c3memoria;
  aAlfa5 = #1#5;
  nNume4 = #1#5 - 1;
  aAlfa6 = nNume4;
  nNume4 = aAlfa4;
  |SI nNume4 = 2; |HAZ cuainmaterial; |FINSI;
  |SI nNume4 = 3; |HAZ cuamaterial;   |FINSI;
  |SI nNume4 = 4; |HAZ cuafinanciera; |FINSI;
  |SI nNume4 = 9; |HAZ cuagastos; |FINSI;
|FPRC;

|PROCESO cuainmaterial;

  |SI #11#20 = -1; |ACABA; |FINSI;  ||no hay datos

  variable = "                                                                                              IMPORTE ";|HAZ Print2;
  variable = "                                                                                          ------------";|HAZ Print2;

  |PARA Nume1 = 4; |SI Nume1 [ 19; |HACIENDO Nume1 = Nume1 + 1;
        variable = "";
        importe  = #11Nume1; |HAZ importe;
        |SI Nume1 = 4;
            variable = "    b) Estado mov. inmovilizaciones inmateriales                                        "; |HAZ Print2;
            variable = "       -----------------------------------------                                        "; |HAZ Print2;
            variable = "      A) IMPORTE (BRUTO) AL INICIO DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 5;
            variable = ""; |HAZ Print2;
            variable = "      (+) Entradas .....................................................................";
        |FINSI;
        |SI Nume1 = 6;
            variable = "      (-) Salidas ......................................................................";
        |FINSI;
        |SI Nume1 = 7;
            variable = ""; |HAZ Print2;
            variable = "      B) IMPORTE (BRUTO) AL CIERRE DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 8;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "      C) AMORTIZACION ACUM. INICIO DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 9;
            variable = ""; |HAZ Print2;
            variable = "      (+) Dotaciones y aumentos ........................................................";
        |FINSI;
        |SI Nume1 = 10;
            variable = "      (-) Reducciones por bajas ........................................................";
        |FINSI;
        |SI Nume1 = 11;
            variable = ""; |HAZ Print2;
            variable = "      D) AMORTIZACION ACUM. CIERRE DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 12;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "      E) PROVISIONES AL INICIO DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;
        |SI Nume1 = 13;
            variable = ""; |HAZ Print2;
            variable = "      (+) Dotacion de provisiones ......................................................";
        |FINSI;
        |SI Nume1 = 14;
            variable = "      (-) Aplicacion y baja de provisiones .............................................";
        |FINSI;
        |SI Nume1 = 15;
            variable = ""; |HAZ Print2;
            variable = "      F) PROVISIONES AL CIERRE DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;
        |SI Nume1 = 16;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "    a) Estado de mov. de los gastos de establecimiento                                  "; |HAZ Print2;
            variable = "       -----------------------------------------------                                  "; |HAZ Print2;
            variable = "      A) SALDO AL INICIO DEL EJERCICIO " + aAlfa5 + " ............................................";
        |FINSI;
        |SI Nume1 = 17;
            variable = ""; |HAZ Print2;
            variable = "      (+) Entradas .....................................................................";
        |FINSI;
        |SI Nume1 = 18;
            variable = "      (-) Salidas ......................................................................";
        |FINSI;
        |SI Nume1 = 19;
            variable = ""; |HAZ Print2;
            variable = "      B) SALDO AL CIERRE DEL EJERCICIO " + aAlfa5 + ".............................................";
        |FINSI;

        variable = variable + importe;  |HAZ Print2;
  |SIGUE;
|FPRC;

|PROCESO cuamaterial;

  |SI #12#16 = -1; |ACABA; |FINSI;  ||no hay datos

  variable = "                                                                                              IMPORTE ";|HAZ Print2;
  variable = "                                                                                          ------------";|HAZ Print2;

  |PARA Nume1 = 4; |SI Nume1 [ 15; |HACIENDO Nume1 = Nume1 + 1;
        variable = "";
        importe  = #12Nume1; |HAZ importe;
        |SI Nume1 = 4;
            variable = "    c) Estado de movimientos de las inmovilizaciones materiales                         "; |HAZ Print2;
            variable = "       --------------------------------------------------------                         "; |HAZ Print2;
            variable = "      A) IMPORTE (BRUTO) AL INICIO DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 5;
            variable = ""; |HAZ Print2;
            variable = "      (+) Entradas .....................................................................";
        |FINSI;
        |SI Nume1 = 6;
            variable = "      (-) Salidas ......................................................................";
        |FINSI;
        |SI Nume1 = 7;
            variable = ""; |HAZ Print2;
            variable = "      B) IMPORTE (BRUTO) AL CIERRE DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 8;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "      C) AMORTIZACION ACUM. INICIO DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 9;
            variable = ""; |HAZ Print2;
            variable = "      (+) Dotaciones y aumentos ........................................................";
        |FINSI;
        |SI Nume1 = 10;
            variable = "      (-) Reducciones por bajas ........................................................";
        |FINSI;
        |SI Nume1 = 11;
            variable = ""; |HAZ Print2;
            variable = "      D) AMORTIZACION ACUM. CIERRE DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 12;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "      E) PROVISIONES AL INICIO DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;
        |SI Nume1 = 13;
            variable = ""; |HAZ Print2;
            variable = "      (+) Dotacion de provisiones ......................................................";
        |FINSI;
        |SI Nume1 = 14;
            variable = "      (-) Aplicacion y baja de provisiones .............................................";
        |FINSI;
        |SI Nume1 = 15;
            variable = ""; |HAZ Print2;
            variable = "      F) PROVISIONES AL CIERRE DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;

        variable = variable + importe;  |HAZ Print2;
  |SIGUE;
|FPRC;

|PROCESO cuafinanciera;
  |SI #13#16 = -1; |ACABA; |FINSI;  ||no hay datos

  variable = "                                                                                              IMPORTE ";|HAZ Print2;
  variable = "                                                                                          ------------";|HAZ Print2;

  |PARA Nume1 = 4; |SI Nume1 [ 15; |HACIENDO Nume1 = Nume1 + 1;
        variable = "";
        importe  = #13Nume1; |HAZ importe;
        |SI Nume1 = 4;
            variable = "    d) Estado de movimientos de las inmovilizaciones financieras                        "; |HAZ Print2;
            variable = "       ---------------------------------------------------------                        "; |HAZ Print2;
            variable = "      A) IMPORTE (BRUTO) AL INICIO DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 5;
            variable = ""; |HAZ Print2;
            variable = "      (+) Entradas .....................................................................";
        |FINSI;
        |SI Nume1 = 6;
            variable = "      (-) Salidas ......................................................................";
        |FINSI;
        |SI Nume1 = 7;
            variable = ""; |HAZ Print2;
            variable = "      B) IMPORTE (BRUTO) AL CIERRE DEL EJERCICIO " + aAlfa5 + " ..................................";
        |FINSI;
        |SI Nume1 = 8;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "      C) PROVISIONES AL INICIO DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;
        |SI Nume1 = 9;
            variable = ""; |HAZ Print2;
            variable = "      (+) Dotacion de provisiones ......................................................";
        |FINSI;
        |SI Nume1 = 10;
            variable = "      (-) Aplicacion y baja de provisiones .............................................";
        |FINSI;
        |SI Nume1 = 11;
            variable = ""; |HAZ Print2;
            variable = "      D) PROVISIONES AL CIERRE DEL EJERCICIO " + aAlfa5 + " ......................................";
        |FINSI;
        |SI Nume1 = 12;
            variable = "     -----------------------------------------------------------------------------------"; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "    e) Estado de movimientos de las acciones propias                                    "; |HAZ Print2;
            variable = "       ---------------------------------------------                                    "; |HAZ Print2;
            variable = "      A) SALDO AL INICIO DEL EJERCICIO " + aAlfa5 + " ............................................";
        |FINSI;
        |SI Nume1 = 13;
            variable = ""; |HAZ Print2;
            variable = "      (+) Entradas .....................................................................";
        |FINSI;
        |SI Nume1 = 14;
            variable = "      (-) Salidas ......................................................................";
        |FINSI;
        |SI Nume1 = 15;
            variable = ""; |HAZ Print2;
            variable = "      B) SALDO AL CIERRE DEL EJERCICIO " + aAlfa5 + ".............................................";
        |FINSI;

        variable = variable + importe;  |HAZ Print2;
  |SIGUE;
|FPRC;

|PROCESO cuagastos;

  |SI #16#22 = -1; |ACABA; |FINSI;  ||no hay datos

  variable = "                                                                                                      ";|HAZ Print2;
  variable = "                                                                                                      ";|HAZ Print2;

  |PARA Nume1 = 4; |SI Nume1 [ 20; |HACIENDO Nume1 = Nume1 + 2;
        variable = "";
        Nume2 = Nume1 + 1;
        importe  = #16Nume1; |HAZ importe; importe2 = importe;
        importe  = #16Nume2; |HAZ importe; importe1 = importe;
        |SI Nume1 = 4;
            variable = "   Detalle de perdidas y ganancias                                            Ejercicio " + aAlfa5 + "  Ejercicio " + aAlfa6;  |HAZ Print2;
            variable = "  -----------------------------------------------------------------------------------------------------------"; |HAZ Print2;
            variable = "  1. Cargas Sociales  .........................................................";
        |FINSI;
        |SI Nume1 = 6;
            variable = ""; |HAZ Print2;
            variable = "      a) Seguridad Social .....................................................";
        |FINSI;
        |SI Nume1 = 8;
            variable = "      b) Aportaciones y dotaciones para pensiones .............................";
        |FINSI;
        |SI Nume1 = 10;
            variable = "      c) Otras cargas sociales ................................................";
        |FINSI;
        |SI Nume1 = 12;
            variable = ""; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "  2. Variacion de provisiones de trafico y perdidas de creditos incobrables ...";
        |FINSI;
        |SI Nume1 = 14;
            variable = ""; |HAZ Print2;
            variable = "       a) Fallidos ............................................................";
        |FINSI;
        |SI Nume1 = 16;
            variable = "       b) Variacion de la provision de existencias ............................";
        |FINSI;
        |SI Nume1 = 18;
            variable = "       c) Variacion de la provision para insolvencias de trafico ..............";
        |FINSI;
        |SI Nume1 = 20;
            variable = "       d) Variacion de la provision para otras operaciones de trafico .........";
        |FINSI;

        variable = variable + importe1 + "   " + importe2;  |HAZ Print2;
  |SIGUE;
|FPRC;


|PROCESO cero3;
  nSuma = 0;
  |PARA XPara = 6;  |SI XPara [ 19;  |HACIENDO XPara = XPara + 1;
        nSuma = nSuma + #1XPara;
  |SIGUE;

  |SI nSuma = 0;  |ACABA;  |FINSI;

      variable = "     ";  |HAZ Print;

      variable = "                          BASE DE REPARTO                      DEBE ";
      |HAZ Print;
      importe = #1#6;   |HAZ importe;
      variable = "     P‚rdidas y Ganacias ..................................: " + importe;
      |HAZ Print;

      importe = #1#7;   |HAZ importe;
      variable = "     Remanentes ...........................................: " + importe;
      |HAZ Print;

      importe = #1#8;   |HAZ importe;
      variable = "     Reservas Voluntarias .................................: " + importe;
      |HAZ Print;

      importe = #1#9;   |HAZ importe;
      variable = "     Otras reservas .......................................: " + importe;
      |HAZ Print;

      importe = #1#10;   |HAZ importe;
      variable = "     TOTAL ................................................: " + importe;
      |HAZ Print;

      variable = ""; |HAZ Print; |HAZ Print;

      variable = "                           DISTRIBUCION                        HABER ";
      |HAZ Print;

      importe = #1#11;   |HAZ importe;
      variable = "     A reserva legal ......................................: " + importe;
      |HAZ Print;

      importe = #1#12;   |HAZ importe;
      variable = "     A reservas especiales ................................: " + importe;
      |HAZ Print;

      importe = #1#13;   |HAZ importe;
      variable = "     A reservas voluntarias ...............................: " + importe;
      |HAZ Print;

      importe = #1#14;   |HAZ importe;
      variable = "     A otras reservas .....................................: " + importe;
      |HAZ Print;

      importe = #1#15;   |HAZ importe;
      variable = "     A dividendos .........................................: " + importe;
      |HAZ Print;

      importe = #1#16;   |HAZ importe;
      variable = "     A compensaci¢n de p‚rdidas de ejercicios anteriores ..: " + importe;
      |HAZ Print;

      importe = #1#17;   |HAZ importe;
      variable = "     A remanentes .........................................: " + importe;
      |HAZ Print;

      importe = #1#18;   |HAZ importe;
      variable = "     A otras aplicaciones .................................: " + importe;
      |HAZ Print;

      importe = #1#19;   |HAZ importe;
      variable = "     TOTAL DISTRIBUIDO ....................................: " + importe;
      |HAZ Print;

       variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;
|FPRC;

|PROCESO cero6;
      |PARA z = 20; |SI z [ 34; |HACIENDO z = z + 1;
           variable = #1z; |QBF variable;
           |SI variable ! "";
              |HAZ Print;
           |FINSI;
      |SIGUE;
      variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;
|FPRC;

|PROCESO aumeydis;
  nSuma    = 0;
  Contador = 0;
  |PARA XPara = 35; |SI XPara [ 59; |HACIENDO XPara = XPara + 1;
        |SI #1XPara ! "                                     ";
            XPara1   = XPara  + 25 + Contador;
            XPara2   = XPara1 + 1;
            nSuma    = nSuma + #1XPara1 + #1XPara2;
        |FINSI;
        Contador = Contador + 1;
  |SIGUE;

  Contador = 0;
  |PARA XPara = 153; |SI XPara [ 167; |HACIENDO XPara = XPara + 1;
        |SI #1XPara ! "                                     ";
            XPara1   = XPara  + 15 + Contador;
            XPara2   = XPara1 + 1;
            nSuma    = nSuma + #1XPara1 + #1XPara2;
        |FINSI;
        Contador = Contador + 1;
  |SIGUE;

  |SI nSuma = 0;  |ACABA;  |FINSI;

      variable = "";
      |HAZ Print;

      variable = "                                                       AUMENTOS  DISMINUCIONES";
      |HAZ Print;

      variable = "                                                 -------------- --------------";
      |HAZ Print;

      variable = "";
      |HAZ Print;

      Contador = 0;
      |PARA XPara = 35; |SI XPara [ 59; |HACIENDO XPara = XPara + 1;
            |SI #1XPara ! "                                     ";
                XPara1   = XPara  + 25 + Contador;
                XPara2   = XPara1 + 1;
                importe  = #1XPara1; |HAZ importe; importe1 = importe;
                importe  = #1XPara2; |HAZ importe; importe2 = importe;
                |SI #1XPara1 = 0; importe1 = "             ";  |FINSI;
                |SI #1XPara2 = 0; importe2 = "             ";  |FINSI;
                variable = #1XPara + "             " + importe1 + "  " + importe2;
                |HAZ Print;
            |FINSI;
            Contador = Contador + 1;
      |SIGUE;

      Contador = 0;
      |PARA XPara = 153; |SI XPara [ 167; |HACIENDO XPara = XPara + 1;
            |SI #1XPara ! "                                     ";
                XPara1   = XPara  + 15 + Contador;
                XPara2   = XPara1 + 1;
                importe  = #1XPara1; |HAZ importe; importe1 = importe;
                importe  = #1XPara2; |HAZ importe; importe2 = importe;
                |SI #1XPara1 = 0; importe1 = "             ";  |FINSI;
                |SI #1XPara2 = 0; importe2 = "             ";  |FINSI;
                variable = #1XPara + "             " + importe1 + "  " + importe2;
                |HAZ Print;
            |FINSI;
            Contador = Contador + 1;
      |SIGUE;

      variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;
|FPRC;

|PROCESO otrainfo;
  variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;

  |PARA z = 110; |SI z [ 115; |HACIENDO z = z + 1;
        variable = #1z; |QBF variable;
        |SI variable ! "";
           |HAZ Print;
        |FINSI;
  |SIGUE;

      variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;

      variable = "                      CONCEPTOS RETRIBUTIVOS     IMPORTE BRUTO";
      |HAZ Print;
      variable = "                      ----------------------------------------";
      |HAZ Print;

      importe  = #1#119; |HAZ importe;
      variable = "                      " + #1#116 + "  " + importe;  |HAZ Print;
      variable = "";                      |HAZ Print;

      importe  = #1#120; |HAZ importe;
      variable = "                      " + #1#117 + "  " + importe;  |HAZ Print;
      variable = "";                      |HAZ Print;

      importe  = #1#121; |HAZ importe;
      variable = "                      " + #1#118 + "  " + importe;  |HAZ Print;
      variable = "";                      |HAZ Print;

      importe  = #1#122; |HAZ importe;
      variable = "                      TOTAL .................... " + importe;  |HAZ Print;
      variable = "";                      |HAZ Print;

      variable = ""; |HAZ Print; |HAZ Print; |HAZ Print;
|FPRC;

|| ... Proceso para imprimir el capitulo 8.

|PROCESO imprelin;

  |PARA campo = 0; |SI campo < 12; |HACIENDO campo = campo + 1;
        #15campo = #17campo;
  |SIGUE;

  |SI #17#3 = "X"; #15#3 = " "; |FINSI;

  |SI informe = "memori07";
      aAlfa1 = " " + #15#5 % 130;
      aAlfa2 = " " + #15#6 % 130;
      importe  = #15#7; |HAZ importe; importe1 = importe; |QBT importe1; importe1 = ("       " + importe1) % -106;
      importe  = #15#8; |HAZ importe; importe2 = importe; |QBT importe2; importe2 = ("       " + importe2) % -106;
      variable = "    " + #15#3 + " " + #15#4 + aAlfa1 + aAlfa2 + " " + importe1 + "   " + importe2;  |HAZ Print2;
  |SINO;
      |SI #17#3 = "M"; |DDEFECTO #15; |FINSI;
      importe  = #15#9;  |HAZ importe; importe1 = importe;
      importe  = #15#10; |HAZ importe; importe2 = importe;
      importe  = #15#11; |HAZ importe; importe3 = importe;
      variable = "      " + #15#4 + "  " + importe1 + "    " + importe2 + "    " + importe3;  |HAZ Print2;
  |FINSI;
|FPRC;

|DEFBUCLE temporal;
  #17#1;
  ;
  #14#0, #14#1, "A",   0;
  #14#0, #14#1, "X", 999;
  e;
  NULL,imprelin;
|FIN;

|PROCESO inforgrup;
  informe  = "memori07";
  variable = ""; |HAZ Print2; |HAZ Print2;

  variable = "                                                                                 % Participacion"; |HAZ Print2;
  variable = "      NIF          DENOMINACION                   DOMICILIO                     Directa Indirecta";|HAZ Print2;
  variable = "    ---------------------------------------------------------------------------------------------";|HAZ Print2;

  |BUCLE temporal;

  variable = ""; |HAZ Print2;

  |SI tip1 = "M"; |ACABA; |FINSI;

  informe = "memori08";
  variable = ""; |HAZ Print2; |HAZ Print2;

  variable = "      NIF                 Capital         Reservas       Resultados"; |HAZ Print2;
  variable = "    ---------------------------------------------------------------"; |HAZ Print2;
  |BUCLE temporal;
  linea = 0;
  |DELINDEX #17;
|FPRC;

|PROCESO crea_tmp;
  |DDEFECTO #17;
  |PARA campo = 0; |SI campo < 12; |HACIENDO campo = campo + 1;
        #17campo = #15campo;
  |SIGUE;
  |GRABA 020#17n;
  ultlin = #17#2;
  linea = linea + 1;
  |SI linea = 1; tip1 = #17#3; |FINSI;
||  |SI linea = 14; |HAZ inforgrup; |FINSI;
|FPRC;

|DEFBUCLE emprgras;
  #15#2;
  ;
  #14#0, #14#1, "A",   1;
  #14#0, #14#1, "M", 999;
  e;
  NULL,crea_tmp;
|FIN;


|PROCESO empregrup;

  |ABRE #14;
  #14#0 = #1#0;
  #14#1 = #1#5;
  |LEE 040#14=;
  |SI FSalida ! 0;
      |CIERRA #14;
      |ACABA;
  |FINSI;
  |CIERRA #14;

  linea = 0;
  |ABRE #17;
  |BUCLE emprgras;
  |SI linea = 0; |CIERRA #17; |ACABA; |FINSI;

  |CIERRA #17;

  |HAZ inforgrup;
|FPRC;

|| ... Proceso para imprimir el capitulo 10.
|PROCESO MedioAmb;

  |SI nSwMedAmb = 0; |ACABA; |FINSI;  ||no existen actuaciones

  variable = "                                                                                              IMPORTE ";|HAZ Print2;
  variable = "                                                                                          ------------";|HAZ Print2;


  |PARA Nume1 = 4; |SI Nume1 [ 27; |HACIENDO Nume1 = Nume1 + 1;
        variable = "";
        importe  = #110Nume1; |HAZ importe;
        |SI Nume1 = 4;
            variable = "    A) ACTIVOS DE NATURALEZA MEDIOAMBIENTAL                                             "; |HAZ Print2;
            variable = "       ------------------------------------                                             "; |HAZ Print2;
            variable = "      1. Activos materiales                                                             "; |HAZ Print2;
            variable = "      1.1. Valor contable ..............................................................";
        |FINSI;
        |SI Nume1 = 5;
            variable = "      1.2. Amortizacion acumulada ......................................................";
        |FINSI;
        |SI Nume1 = 6;
            variable = ""; |HAZ Print2;
            variable = "      2. Compensacioneas a recibir de un tercero .......................................";
        |FINSI;
        |SI Nume1 = 7;
            variable = ""; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "    B) PASIVOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                                "; |HAZ Print2;
            variable = "       -------------------------------------------------                                "; |HAZ Print2;
            variable = "      1. Subvenciones de capital que financian activos de naturaleza medioambiental ....";
        |FINSI;
        |SI Nume1 = 8;
            variable = ""; |HAZ Print2;
            variable = "      2. Provision para act. medioamb., incluidas  en  provisiones para riesgos y gastos"; |HAZ Print2;
            variable = "      2.1. Saldo al inicio del ejercicio " + #1#5 + " ..........................................";
        |FINSI;
        |SI Nume1 = 9;
            variable = "      2.2. Dotaciones ..................................................................";
        |FINSI;
        |SI Nume1 = 10;
            variable = "      2.3. Aplicaciones ................................................................";
        |FINSI;
        |SI Nume1 = 11;
            variable = "      2.4. Excesos .....................................................................";
        |FINSI;
        |SI Nume1 = 12;
            variable = "      2.5. Saldo al Cierre del ejercicio " + #1#5 + " ..........................................";
        |FINSI;
        |SI Nume1 = 13;
            variable = ""; |HAZ Print2;
            variable = "      3. Otra Informacion ..............................................................";
        |FINSI;
        |SI Nume1 = 14;
            variable = "      3.1. Importe integro de las responsabilidades de naturaleza medioambiental .......";
        |FINSI;
        |SI Nume1 = 15;
            variable = "      3.2. Responsabilidades cubiertas con compensaciones a recibir ....................";
        |FINSI;
        |SI Nume1 = 16;
            variable = ""; |HAZ Print2;
            variable = "      4. Contingencias                                                                  "; |HAZ Print2;
            variable = "      4.1. Importe de las contingencias relacionadas con el medio ambiente .............";
        |FINSI;
        |SI Nume1 = 17;
            variable = "      4.1.1. Efectos sobre el patrimonio ...............................................";
        |FINSI;
        |SI Nume1 = 18;
            variable = "      4.1.2. Efectos sobre el resultado ................................................";
        |FINSI;
        |SI Nume1 = 19;
            variable = "      4.2. Riesgos transferidos a otras Entidades ......................................";
        |FINSI;
        |SI Nume1 = 20;
            variable = "      4.3. Riesgos maximos .............................................................";
        |FINSI;
        |SI Nume1 = 21;
            variable = "      4.4. Riesgos minimos .............................................................";
        |FINSI;
        |SI Nume1 = 22;
            variable = ""; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "    C) GASTOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                                 "; |HAZ Print2;
            variable = "       ------------------------------------------------                                 "; |HAZ Print2;
            variable = "      1. Gastos medioambientales incluidos en otros gastos de explotacion ..............";
        |FINSI;
        |SI Nume1 = 23;
            variable = "      2. Gastos extraordinarios derivados de actuaciones medioambientales ..............";
        |FINSI;
        |SI Nume1 = 24;
            variable = ""; |HAZ Print2;
            variable = ""; |HAZ Print2;
            variable = "    D) INGRESOS DERIVADOS DE ACTUACIONES MEDIOAMBIENTALES                               "; |HAZ Print2;
            variable = "      ---------------------------------------------------                               "; |HAZ Print2;
            variable = "      1. Ingresos derivados de subvenciones ............................................";
        |FINSI;
        |SI Nume1 = 25;
            variable = "      1.1. Subvenciones de naturaleza medioambiental ...................................";
        |FINSI;
        |SI Nume1 = 26;
            variable = "      1.2. Imputacion   al  resultado  extraordinario  de  subvenciones  de  capital que"; |HAZ Print2;
            variable = "      financian activos de naturaleza medioambiental ...................................";
        |FINSI;
        |SI Nume1 = 27;
            variable = "      2. Ingresos de actividades relacionadas con el medio ambiente ....................";
        |FINSI;

        variable = variable + importe;  |HAZ Print2;
  |SIGUE;
|FPRC;

|| ////////////////////////////////////////////////
|PROCESO importe;    || Calculo para poner las comas en el importe

     eaMoneda  = #0#17;
     enCanti   = importe;
     enSwTrata = 1;
     |HAZ SeparaImporte;
     importe   = eaImporte;
|FPRC;

|| *************************************************************************
||                         EMPIEZA EL PROGRAMA
|| *************************************************************************

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;

  |SI Campo = 14;
      |SI #0Campo = "N";
          |C_M #0#15, 1, "N";  #0#15 = "";  |PINTA #0#15;
          |C_M #0#16, 1, "N";  #0#16 = "";  |PINTA #0#16;
      |SINO;
          |C_M #0#15, 1, "S";
          |C_M #0#16, 1, "S";
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO MiraImpre;
  Pos = -1;
  |DBASS Base;  |QBT Base;
  NombreFich = "rt  " + Base + "dev/imp/" + Valfa;  |QBF NombreFich;
  |FABRE NombreFich;
  Handle = FSalida;
  |SI FSalida ] 0;
      Contador = 0;
      Valfa    = "";
      |PARA;  |SI Contador [ 2;  |HACIENDO;
           Contador = Contador + 1;
           Field = Handle + " 255";
           |FLEE Field;
           |SI FSalida [ 0;  |SAL;  |FINSI;
           |SI Contador = 2;  Valfa = Field % 101;  |FINSI;
      |SIGUE;
  |FINSI;
  |FCIERRA Handle;
|FPRC;

|PROCESO impre;|TIPO 3;
  enEjerS = 2008; eaPlanillaS = "sodacuen";  |HAZ PlanDePlanillasS;

  |ABRE #3;
  #3#0 = 030000; #3#1 = 00; #3#17 = 99998;
  |LEE 040#3=;
  |SI FSalida ! 0; |GRABA 040#3n; |FINSI;

  |DDEFECTO #3;
  #3#0 = 060000; #3#1 = 00; #3#17 = 99998;
  |LEE 040#3=;
  |SI FSalida ! 0; |GRABA 040#3n; |FINSI;

  |DDEFECTO #3;
  #3#0 = 070000; #3#1 = 00; #3#17 = 99998;
  |LEE 040#3=;
  |SI FSalida ! 0; |GRABA 040#3n; |FINSI;
  |CIERRA #3;

  |SI acabalo = 1;
      Impresora = eImpresora;
      |IMPRE -1;
  |FINSI;

  |SI acabalo = 2;  |O acabalo = 3;  |O acabalo = 4;
      Impresora = eImpresora;
      |IMPRE -77;
  |FINSI;

  |SI acabalo = 0;
      |SI aParam ! "";
          |HAZ LeeUnidadBasico;

          Impresora = eaNomImp + "?" + eaUnidadBasico + "\tmp1,,,?Memoria";
          |SI enBasImp ! 0;
              |IMPRE -1;
          |SINO;
              |IMPRE 0;
          |FINSI;

      |SINO;

          |IMPRE 0;

      |FINSI;
  |FINSI;

  |SI FSalida ! 0;  |ACABA;  |FINSI;

  fichero = Usuario; |QBT fichero;
  fichero = (fichero + "zzzzzzzz") % 106;
  fichero = "me" + fichero;
  |NOME_DAT #17 fichero;
  |ABRE #17; |CIERRA #17; |DELINDEX #17;

  |PARA x = 0; |SI x [ 9; |HACIENDO x = x + 1;
        |SI #0x ! 0;
            empresa = #0x;
            sw_pan  = 0;
            sw_emp  = 0;
            hoja    = #0#11;
            |DDEFECTO #100;
            |HAZ impreficha;             || Rutina para imprimir la ficha
            |HAZ impretexto;             || Rutina para imprimir texto
       |FINSI;
  |SIGUE;

  |FINIMP;
|FPRC;

|PROGRAMA;
   aParam = PARAMETRO; |QBF aParam;
   |SI aParam = "";
     |SI acabalo = 2;  |O acabalo = 3;  |O acabalo = 4;
         eaSalto = &12;
         #0#0    = enEmpresa
         #0#10   = eaHoja;
         #0#11   = enHoja;
         #0#13   = "N";
         #0#17   = eaMoneda;
         |HAZ impre;
         enHoja = hoja;
         |ACABA;
     |FINSI;

     eaSalto = "";
     |PINPA #0#0;
     |PINDA #0#0;
     |ENDATOS #1#0;
     |SI FSalida = 0;
        |HAZ impre;
     |FINSI;
  |SINO;

     |DDEFECTO #0;
     #0#0  = aParam;
     #0#17 = eaMoneda;
     |SI eaMemSoc = ""; eaMemSoc = "N"; |FINSI;
     #0#13 = eaMemSoc;
     |HAZ impre;

  |FINSI;
|FPRO;
