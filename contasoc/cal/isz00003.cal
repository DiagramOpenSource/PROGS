|FICHEROS;
     isz00003 #0;
     isocie29 #1;
     isacceso #3;
     isocie59 #6;
     isocie91 #91;
     isom0001 #101;

     isw00901 #901,MANTE;
|FIN;

|VARIABLES;
     fecha           = @;
     alfa            = "";
     aFichero        = "";
     aAlfa           = "";

     &enEmpresa      = 0;
     &fFechaChequeo  = @;
     &enError        = 0;
     &fFechaDisol    = @;
|FIN;

|PROCESO cuadro; |TIPO 7;
     |PUSHV 0501 2380;
     |CUADRO 0850 1677;
     |ATRI R;
     |PINTA 0951, " Deberan estar creadas las";
     |PINTA 1051, "empresas al a¤o que vamos ";
     |PINTA 1151, "introducir ahora.         ";
     |PINTA 1251, " Si no las tenemos creadas";
     |PINTA 1351, "existe un programa en el  ";
     |PINTA 1451, "menu de Maestros que las  ";
     |PINTA 1551, "duplica.                  ";
     |ATRI 0;
|FPRC;

|PROCESO PintaAnyo; |TIPO 7;
     fecha = ~;
     alfa  = fecha % - 104;
     #0#3  = alfa;  |PINTA #0#3;
     |HAZ cuadro;
|FPRC;

|PROCESO AnyoMas; |TIPO 0;
     #0#5 = #0#3 - 1;

     |SI #0#3 < 1996; #0#4 = 20; |FINSI;
     |SI #0#3 ] 1996; |Y #0#3 < 1999; #0#4 = 15; |FINSI;
     |SI #0#3 ] 1999; #0#4 = 18; |FINSI;

     |POPV;

     |PINTA #0#3;
     |PINTA #0#4;
     |PINTA #0#5;
|FPRC;

|PROCESO isocie59;
     #1#0 = #6#0;
     #1#1 = #0#3;
     |LEE 000#1=;
     |SI FSalida ! 0;
         #1#0 = #6#0;
         #1#1 = #0#3 - 1;
         |LEE 040#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |FINSI;

     |SI #1#30 ! 1;  |ACABA;  |FINSI;

     |DDEFECTO #901;
     #901#0 = #6#0;
     #901#1 = #3#2;
     #901#2 = #6#83;
     |SI #901#2 < 0; #901#2 = 0; |FINSI;

     #901#3 = #901#2 % #0#4;

     enEmpresa     = #901#0;
     |SI #0#2 = 1;  aAlfa = "21.04." + #0#3;  |FINSI;
     |SI #0#2 = 2;  aAlfa = "20.10." + #0#3;  |FINSI;
     |SI #0#2 = 3;  aAlfa = "22.12." + #0#3;  |FINSI;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;

     #901#4 = "ACTIVA";

     |SI enError = 0;
         |SI #0#6 = "S";  #901#5 = "*";  |FINSI;
     |SINO;
         |SI enError = 1;
             #901#4 = "INACTIVA";
         |FINSI;

         |SI enError = 2;
             #901#4 = "DISUELTA";
         |FINSI;
     |FINSI;

     |GRABA 020#901n;
     |LIBERA #901;
|FPRC;

|PROCESO isocie91;
     #1#0 = #91#0;
     #1#1 = #0#3;
     |LEE 040#1=;
     |SI FSalida ! 0;
          #1#0 = #91#0;
          #1#1 = #0#3 - 1;
          |LEE 040#1=;
          |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |FINSI;

     |SI #1#30 ! 1;  |ACABA;  |FINSI;

     #901#0 = #91#0;
     #901#1 = #3#2;
     #901#2 = #91#103;
     |SI #901#2 < 0; #901#2 = 0; |FINSI;

     #901#3 = #901#2 % #0#4;

     enEmpresa     = #901#0;
     |SI #0#2 = 1;  aAlfa = "21.04." + #0#3;  |FINSI;
     |SI #0#2 = 2;  aAlfa = "20.10." + #0#3;  |FINSI;
     |SI #0#2 = 3;  aAlfa = "22.12." + #0#3;  |FINSI;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;

     #901#4 = "ACTIVA";

     |SI enError = 0;
         |SI #0#6 = "S";  #901#5 = "*";  |FINSI;
     |SINO;
         |SI enError = 1;
             #901#4 = "INACTIVA";
         |FINSI;

         |SI enError = 2;
             #901#4 = "DISUELTA";
         |FINSI;
     |FINSI;

     |GRABA 020#901n;
     |LIBERA #901;
|FPRC;

|PROCESO isom0001;
     #1#0 = #3#0;
     #1#1 = #0#3;
     |LEE 000#1=;
     |SI FSalida ! 0;
         #1#0 = #3#0;
         #1#1 = #0#3 - 1;
         |LEE 040#1=;
         |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |FINSI;

     |SI #1#30 ! 1;  |ACABA;  |FINSI;

     |DDEFECTO #901;
     #901#0 = #3#0;
     #901#1 = #3#2;
     #901#2 = #101#5;
     |SI #901#2 < 0; #901#2 = 0; |FINSI;

     #901#3 = #901#2 % #0#4;

     enEmpresa     = #901#0;
     |SI #0#2 = 1;  aAlfa = "21.04." + #0#3;  |FINSI;
     |SI #0#2 = 2;  aAlfa = "20.10." + #0#3;  |FINSI;
     |SI #0#2 = 3;  aAlfa = "22.12." + #0#3;  |FINSI;
     fFechaChequeo = aAlfa;
     |HAZ ChequeaEmpresa;

     #901#4 = "ACTIVA";

     |SI enError = 0;
         |SI #0#6 = "S";  #901#5 = "*";  |FINSI;
     |SINO;
         |SI enError = 1;
             #901#4 = "INACTIVA";
         |FINSI;

         |SI enError = 2;
             #901#4 = "DISUELTA";
         |FINSI;
     |FINSI;

     |GRABA 020#901n;
     |LIBERA #901;
|FPRC;

|PROCESO isacceso;
     |SI #3#1 [ 2007;
         |SI #3#5 ! "225";
             |ABRE #6;
             #6#0 = #3#0;
             #6#1 = #3#1;
             |LEE 000#6=;
             |SI FSalida = 0;
                 |HAZ isocie59;
             |FINSI;
             |CIERRA #6;
         |SINO;
             |ABRE #91;
             #91#0 = #3#0;
             #91#1 = #3#1;
             |LEE 000#91=;
             |SI FSalida = 0;
                 |HAZ isocie91;
             |FINSI;
             |CIERRA #91;
         |FINSI;
     |FINSI;

     |SI #3#1 ] 2008;
         |ABRE #101;
         |SELECT #2#101;
         #101#0 = #3#0;
         #101#1 = #3#1;
         #101#3 = "599";
         |LEE 000#101=;
         |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
         |CIERRA #101;

         |HAZ isom0001;
     |FINSI;
|FPRC;

|DEFBUCLE isacceso;
     #3#1;
     ;
     #0#5, #0#0;
     #0#5, #0#1;
     ;
     NULL, isacceso;
|FIN;

|PROCESO isw00901;
      #1#0 = #901#0;
      #1#1 = #0#3;
      |LEE 101#1=;
      |SI FSalida ! 0;
          |DDEFECTO #1;
          #1#0 = #901#0;
          #1#1 = #0#3;
          |GRABA 020#1b;
     |FINSI;

     #1#2  = #901#1;
     #1#30 = 1;

     |SI #0#2 = 1; #1#3 = #901#2;  #1#6 = #901#3;  #1#32 = #0#4; |FINSI;
     |SI #0#2 = 2; #1#4 = #901#2;  #1#7 = #901#3;  #1#33 = #0#4; |FINSI;
     |SI #0#2 = 3; #1#5 = #901#2;  #1#8 = #901#3;  #1#34 = #0#4; |FINSI;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|DEFBUCLE isw00901;
     #901#1;
     5;
     00001, "*";
     99999, "*";
     ;
     NULL, isw00901;
|FIN;


|PROCESO Baja901;
     #901#0 = 1;
|FPRC;

|PROCESO Alta901;
     #901#0 = 99999;
|FPRC;

|PROCESO pase; |TIPO 3;
     |C_M #0#0, 1, "N";
     |C_M #0#1, 1, "N";
     |C_M #0#2, 1, "N";
     |C_M #0#3, 1, "N";
     |C_M #0#4, 1, "N";
     |C_M #0#5, 1, "N";
     |C_M #0#6, 1, "S";

     aFichero = ("a1" + Usuario + "zzzzzzzz") % 108; |NOME_DAT #901 aFichero;
     |ABRE #901;  |CIERRA #901;  |DELINDEX #901;

     |ABRE #1;
     |ABRE #901;
     |BUCLE isacceso;

     |LEE 000#901p;
     |SI FSalida ! 0;
         |MENAV "0000 Seleccion vacia";
         |CIERRA #901;
         |ACABA;
     |FINSI;
     |CIERRA #901;

     |ENTLINEAL #1#901, -1, 4, 22, 1, Baja901, Alta901;

     |CONFI "0000SConforme con la seleccion ";
     |SI FSalida = 0;
         |BUCLE isw00901;
     |FINSI;

     |DELINDEX #901;
|FPRC;
