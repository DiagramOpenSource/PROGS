|FICHEROS;
     zemigraf #0;
     cuacceso #100;
     cubala02 #1;
     cubala03 #2;
     cubala04 #3;
     cubala05 #4;
     cubaw001 #99;
|FIN;

|VARIABLES;
     nNume       = 0;
     nCampo      = 0;
     nFila       = 0;
     nFichero    = 0;
     nHandle     = 0;
     nAnyoDesde  = 0;
     nCoopera    = 0;

     aAlfa       = "";
     aBase       = "";

     aIPRemoto   = "";

     &eaOrigen   = "";
     &eaDestino  = "";
     &eaMoneda   = "";
     &enCanti    = 0;
     &enSwTrata  = 0;
     &eaUnidadBasico = "";
|FIN;

|PROCESO CargaTemporal;
     |SI nFichero = 1;
         |SI nFila = 2;
             nCampo = nCampo + 1;  #99nCampo = #1#70;
             nCampo = nCampo + 1;  #99nCampo = #1#71;
             nCampo = nCampo + 1;  #99nCampo = #1#72;
             nCampo = nCampo + 1;  #99nCampo = #1#73;
             nCampo = nCampo + 1;  #99nCampo = #1#83;
             nCampo = nCampo + 1;  #99nCampo = #1#91;
             nCampo = nCampo + 1;  #99nCampo = #1#100;
             nCampo = nCampo + 1;  #99nCampo = #1#101;
             nCampo = nCampo + 1;  #99nCampo = #1#102;
             nCampo = nCampo + 1;  #99nCampo = #1#103;
             nCampo = nCampo + 1;  #99nCampo = #1#104;
             nCampo = nCampo + 1;  #99nCampo = #1#105;
             nCampo = nCampo + 1;  #99nCampo = #1#113;
             nCampo = nCampo + 1;  #99nCampo = #1#121;
             nCampo = nCampo + 1;  #99nCampo = #1#130;
             nCampo = nCampo + 1;  #99nCampo = #1#131;
             nCampo = nCampo + 1;  #99nCampo = #1#132;
             nCampo = nCampo + 1;  #99nCampo = #1#133;
         |FINSI;

         |SI nFila = 1;
             nCampo = nCampo + 1;  #99nCampo = #1#6;
             nCampo = nCampo + 1;  #99nCampo = #1#7;
             nCampo = nCampo + 1;  #99nCampo = #1#8;
             nCampo = nCampo + 1;  #99nCampo = #1#9;
             nCampo = nCampo + 1;  #99nCampo = #1#19;
             nCampo = nCampo + 1;  #99nCampo = #1#27;
             nCampo = nCampo + 1;  #99nCampo = #1#36;
             nCampo = nCampo + 1;  #99nCampo = #1#37;
             nCampo = nCampo + 1;  #99nCampo = #1#38;
             nCampo = nCampo + 1;  #99nCampo = #1#39;
             nCampo = nCampo + 1;  #99nCampo = #1#40;
             nCampo = nCampo + 1;  #99nCampo = #1#41;
             nCampo = nCampo + 1;  #99nCampo = #1#49;
             nCampo = nCampo + 1;  #99nCampo = #1#57;
             nCampo = nCampo + 1;  #99nCampo = #1#66;
             nCampo = nCampo + 1;  #99nCampo = #1#67;
             nCampo = nCampo + 1;  #99nCampo = #1#68;
             nCampo = nCampo + 1;  #99nCampo = #1#69;
         |FINSI;
     |FINSI;

     |SI nFichero = 2;
         |SI nFila = 2;
             nCampo = nCampo + 1;  #99nCampo = #2#79;
             nCampo = nCampo + 1;  #99nCampo = #2#80;
             nCampo = nCampo + 1;  #99nCampo = #2#81;
             nCampo = nCampo + 1;  #99nCampo = #2#82;
             nCampo = nCampo + 1;  #99nCampo = #2#83;
             nCampo = nCampo + 1;  #99nCampo = #2#156;
             nCampo = nCampo + 1;  #99nCampo = #2#88;
             nCampo = nCampo + 1;  #99nCampo = #2#89;
             nCampo = nCampo + 1;  #99nCampo = #2#93;
             nCampo = nCampo + 1;  #99nCampo = #2#94;
             nCampo = nCampo + 1;  #99nCampo = #2#95;
             nCampo = nCampo + 1;  #99nCampo = #2#96;
             nCampo = nCampo + 1;  #99nCampo = #2#100;
             nCampo = nCampo + 1;  #99nCampo = #2#105;
             nCampo = nCampo + 1;  #99nCampo = #2#125;
             nCampo = nCampo + 1;  #99nCampo = #2#150;
             nCampo = nCampo + 1;  #99nCampo = #2#151;
         |FINSI;

         |SI nFila = 1;
             nCampo = nCampo + 1;  #99nCampo = #2#6;
             nCampo = nCampo + 1;  #99nCampo = #2#7;
             nCampo = nCampo + 1;  #99nCampo = #2#8;
             nCampo = nCampo + 1;  #99nCampo = #2#9;
             nCampo = nCampo + 1;  #99nCampo = #2#10;
             nCampo = nCampo + 1;  #99nCampo = #2#157;
             nCampo = nCampo + 1;  #99nCampo = #2#15;
             nCampo = nCampo + 1;  #99nCampo = #2#16;
             nCampo = nCampo + 1;  #99nCampo = #2#20;
             nCampo = nCampo + 1;  #99nCampo = #2#21;
             nCampo = nCampo + 1;  #99nCampo = #2#22;
             nCampo = nCampo + 1;  #99nCampo = #2#23;
             nCampo = nCampo + 1;  #99nCampo = #2#27;
             nCampo = nCampo + 1;  #99nCampo = #2#32;
             nCampo = nCampo + 1;  #99nCampo = #2#52;
             nCampo = nCampo + 1;  #99nCampo = #2#77;
             nCampo = nCampo + 1;  #99nCampo = #2#78;
         |FINSI;
     |FINSI;

     |SI nFichero = 3;
         |SI nFila = 2;
             nCampo = nCampo + 1;  #99nCampo = #3#45;
             nCampo = nCampo + 1;  #99nCampo = #3#46;
             nCampo = nCampo + 1;  #99nCampo = #3#51;
             nCampo = nCampo + 1;  #99nCampo = #3#52;
             nCampo = nCampo + 1;  #99nCampo = #3#53;
             nCampo = nCampo + 1;  #99nCampo = #3#54;
             nCampo = nCampo + 1;  #99nCampo = #3#55;
             nCampo = nCampo + 1;  #99nCampo = #3#59;
             nCampo = nCampo + 1;  #99nCampo = #3#64;
             nCampo = nCampo + 1;  #99nCampo = #3#65;
             nCampo = nCampo + 1;  #99nCampo = #3#66;
             nCampo = nCampo + 1;  #99nCampo = #3#67;
             nCampo = nCampo + 1;  #99nCampo = #3#68;
             nCampo = nCampo + 1;  #99nCampo = #3#69;
             nCampo = nCampo + 1;  #99nCampo = #3#70;
             nCampo = nCampo + 1;  #99nCampo = #3#71;
             nCampo = nCampo + 1;  #99nCampo = #3#72;
             nCampo = nCampo + 1;  #99nCampo = #3#73;
             nCampo = nCampo + 1;  #99nCampo = #3#74;
             nCampo = nCampo + 1;  #99nCampo = #3#75;
             nCampo = nCampo + 1;  #99nCampo = #3#76;
             nCampo = nCampo + 1;  #99nCampo = #3#77;
             nCampo = nCampo + 1;  #99nCampo = #3#78;
             nCampo = nCampo + 1;  #99nCampo = #3#79;
             nCampo = nCampo + 1;  #99nCampo = #3#80;
             nCampo = nCampo + 1;  #99nCampo = #3#81;
             nCampo = nCampo + 1;  #99nCampo = #3#82;
             nCampo = nCampo + 1;  #99nCampo = #3#83;
         |FINSI;

         |SI nFila = 1;
             nCampo = nCampo + 1;  #99nCampo = #3#6;
             nCampo = nCampo + 1;  #99nCampo = #3#7;
             nCampo = nCampo + 1;  #99nCampo = #3#12;
             nCampo = nCampo + 1;  #99nCampo = #3#13;
             nCampo = nCampo + 1;  #99nCampo = #3#14;
             nCampo = nCampo + 1;  #99nCampo = #3#15;
             nCampo = nCampo + 1;  #99nCampo = #3#16;
             nCampo = nCampo + 1;  #99nCampo = #3#20;
             nCampo = nCampo + 1;  #99nCampo = #3#25;
             nCampo = nCampo + 1;  #99nCampo = #3#26;
             nCampo = nCampo + 1;  #99nCampo = #3#27;
             nCampo = nCampo + 1;  #99nCampo = #3#28;
             nCampo = nCampo + 1;  #99nCampo = #3#29;
             nCampo = nCampo + 1;  #99nCampo = #3#30;
             nCampo = nCampo + 1;  #99nCampo = #3#31;
             nCampo = nCampo + 1;  #99nCampo = #3#32;
             nCampo = nCampo + 1;  #99nCampo = #3#33;
             nCampo = nCampo + 1;  #99nCampo = #3#34;
             nCampo = nCampo + 1;  #99nCampo = #3#35;
             nCampo = nCampo + 1;  #99nCampo = #3#36;
             nCampo = nCampo + 1;  #99nCampo = #3#37;
             nCampo = nCampo + 1;  #99nCampo = #3#38;
             nCampo = nCampo + 1;  #99nCampo = #3#39;
             nCampo = nCampo + 1;  #99nCampo = #3#40;
             nCampo = nCampo + 1;  #99nCampo = #3#41;
             nCampo = nCampo + 1;  #99nCampo = #3#42;
             nCampo = nCampo + 1;  #99nCampo = #3#43;
             nCampo = nCampo + 1;  #99nCampo = #3#44;
         |FINSI;
     |FINSI;

     |SI nFichero = 4;
         |SI nFila = 2;
             nCampo = nCampo + 1;  #99nCampo = #4#44;
             nCampo = nCampo + 1;  #99nCampo = #4#45;
             nCampo = nCampo + 1;  #99nCampo = #4#46;
             nCampo = nCampo + 1;  #99nCampo = #4#52;
             nCampo = nCampo + 1;  #99nCampo = #4#56;
             nCampo = nCampo + 1;  #99nCampo = #4#57;
             nCampo = nCampo + 1;  #99nCampo = #4#59;
             nCampo = nCampo + 1;  #99nCampo = #4#60;
             nCampo = nCampo + 1;  #99nCampo = #4#69;
             nCampo = nCampo + 1;  #99nCampo = #4#70;
             nCampo = nCampo + 1;  #99nCampo = #4#71;
             nCampo = nCampo + 1;  #99nCampo = #4#72;
             nCampo = nCampo + 1;  #99nCampo = #4#73;
             nCampo = nCampo + 1;  #99nCampo = #4#74;
             nCampo = nCampo + 1;  #99nCampo = #4#75;
             nCampo = nCampo + 1;  #99nCampo = #4#76;
             nCampo = nCampo + 1;  #99nCampo = #4#77;
             nCampo = nCampo + 1;  #99nCampo = #4#78;
             nCampo = nCampo + 1;  #99nCampo = #4#79;
             nCampo = nCampo + 1;  #99nCampo = #4#80;
             nCampo = nCampo + 1;  #99nCampo = #4#81;
         |FINSI;

         |SI nFila = 1;
             nCampo = nCampo + 1;  #99nCampo = #4#6;
             nCampo = nCampo + 1;  #99nCampo = #4#7;
             nCampo = nCampo + 1;  #99nCampo = #4#8;
             nCampo = nCampo + 1;  #99nCampo = #4#14;
             nCampo = nCampo + 1;  #99nCampo = #4#18;
             nCampo = nCampo + 1;  #99nCampo = #4#19;
             nCampo = nCampo + 1;  #99nCampo = #4#21;
             nCampo = nCampo + 1;  #99nCampo = #4#22;
             nCampo = nCampo + 1;  #99nCampo = #4#31;
             nCampo = nCampo + 1;  #99nCampo = #4#32;
             nCampo = nCampo + 1;  #99nCampo = #4#33;
             nCampo = nCampo + 1;  #99nCampo = #4#34;
             nCampo = nCampo + 1;  #99nCampo = #4#35;
             nCampo = nCampo + 1;  #99nCampo = #4#36;
             nCampo = nCampo + 1;  #99nCampo = #4#37;
             nCampo = nCampo + 1;  #99nCampo = #4#38;
             nCampo = nCampo + 1;  #99nCampo = #4#39;
             nCampo = nCampo + 1;  #99nCampo = #4#40;
             nCampo = nCampo + 1;  #99nCampo = #4#41;
             nCampo = nCampo + 1;  #99nCampo = #4#42;
             nCampo = nCampo + 1;  #99nCampo = #4#43;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO TrataActivo;
     |DDEFECTO #99;

     #1#0 = #0#0;
     #1#1 = #0#1 + 1;
     |LEE 040#1=;
     |SI FSalida = 0;
         nCampo    = 116;
         #99nCampo = #1#1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #1#0 = #0#0;
     #1#1 = #0#1;
     |LEE 040#1=;
     |SI FSalida = 0;
         |SI #99#116 ! 0;
             nCampo    = 87;
             #99nCampo = #1#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |SINO;
             nCampo    = 116;
             #99nCampo = #1#1;
             nFila     = 2;
             |HAZ CargaTemporal;

             nCampo    = 87;
             #99nCampo = #1#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #1#0 = #0#0;
     #1#1 = #0#1 - 1;
     |LEE 040#1=;
     |SI FSalida = 0;
         |SI #99#87 = 0;
             nCampo    = 87;
             #99nCampo = #1#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 58;
         #99nCampo = #1#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #1#0 = #0#0;
     #1#1 = #0#1 - 2;
     |LEE 040#1=;
     |SI FSalida = 0;
         |SI #99#58 = 0;
             nCampo    = 58;
             #99nCampo = #1#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 29;
         #99nCampo = #1#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #1#0 = #0#0;
     #1#1 = #0#1 - 3;
     |LEE 040#1=;
     |SI FSalida = 0;
         |SI #99#29 = 0;
             nCampo    = 29;
             #99nCampo = #1#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 0;
         #99nCampo = #1#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #1#0 = #0#0;
     #1#1 = #0#1 - 4;
     |LEE 040#1=;
     |SI FSalida = 0;
         |SI #99#0 = 0;
             nCampo    = 0;
             #99nCampo = #1#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #99#116 = #0#1;
     #99#87  = #0#1 - 1;
     #99#58  = #0#1 - 2;
     #99#29  = #0#1 - 3;
     #99#0   = #0#1 - 4;

     aAlfa = "A7," + #1#0;    |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "B7," + #1#2;    |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "A9," + #99#0;   |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "B9," + #99#29;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "C9," + #99#58;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "D9," + #99#87;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "E9," + #99#116; |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |PARA nCampo = 1;  |SI nCampo [ 18;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 10;
           aAlfa = "A" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 30;  |SI nCampo [ 47;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 19;
           aAlfa = "B" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 59;  |SI nCampo [ 76;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 48;
           aAlfa = "C" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 88;  |SI nCampo [ 105;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 77;
           aAlfa = "D" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 117;  |SI nCampo [ 134;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 106;
           aAlfa = "E" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;
|FPRC;

|PROCESO TrataPasivo;
     |DDEFECTO #99;

     #2#0 = #0#0;
     #2#1 = #0#1 + 1;
     |LEE 040#2=;
     |SI FSalida = 0;
         nCampo    = 116;
         #99nCampo = #2#1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #2#0 = #0#0;
     #2#1 = #0#1;
     |LEE 040#2=;
     |SI FSalida = 0;
         |SI #99#116 ! 0;
             nCampo    = 87;
             #99nCampo = #2#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |SINO;
             nCampo    = 116;
             #99nCampo = #2#1;
             nFila     = 2;
             |HAZ CargaTemporal;

             nCampo    = 87;
             #99nCampo = #2#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #2#0 = #0#0;
     #2#1 = #0#1 - 1;
     |LEE 040#2=;
     |SI FSalida = 0;
         |SI #99#87 = 0;
             nCampo    = 87;
             #99nCampo = #2#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 58;
         #99nCampo = #2#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #2#0 = #0#0;
     #2#1 = #0#1 - 2;
     |LEE 040#2=;
     |SI FSalida = 0;
         |SI #99#58 = 0;
             nCampo    = 58;
             #99nCampo = #2#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 29;
         #99nCampo = #2#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #2#0 = #0#0;
     #2#1 = #0#1 - 3;
     |LEE 040#2=;
     |SI FSalida = 0;
         |SI #99#29 = 0;
             nCampo    = 29;
             #99nCampo = #2#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 0;
         #99nCampo = #2#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #2#0 = #0#0;
     #2#1 = #0#1 - 4;
     |LEE 040#2=;
     |SI FSalida = 0;
         |SI #99#0 = 0;
             nCampo    = 0;
             #99nCampo = #2#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #99#116 = #0#1;
     #99#87  = #0#1 - 1;
     #99#58  = #0#1 - 2;
     #99#29  = #0#1 - 3;
     #99#0   = #0#1 - 4;

     aAlfa = "A42," + #99#0;   |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "B42," + #99#29;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "C42," + #99#58;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "D42," + #99#87;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "E42," + #99#116; |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |PARA nCampo = 1;  |SI nCampo [ 17;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 43;
           aAlfa = "A" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 30;  |SI nCampo [ 46;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 14;
           aAlfa = "B" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 59;  |SI nCampo [ 75;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 15;
           aAlfa = "C" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 88;  |SI nCampo [ 104;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 44;
           aAlfa = "D" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 117;  |SI nCampo [ 133;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 73;
           aAlfa = "E" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;
|FPRC;

|PROCESO TrataDebe;
     |DDEFECTO #99;

     #3#0 = #0#0;
     #3#1 = #0#1 + 1;
     |LEE 040#3=;
     |SI FSalida = 0;
         nCampo    = 116;
         #99nCampo = #3#1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1;
     |LEE 040#3=;
     |SI FSalida = 0;
         |SI #99#116 ! 0;
             nCampo    = 87;
             #99nCampo = #3#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |SINO;
             nCampo    = 116;
             #99nCampo = #3#1;
             nFila     = 2;
             |HAZ CargaTemporal;

             nCampo    = 87;
             #99nCampo = #3#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1 - 1;
     |LEE 040#3=;
     |SI FSalida = 0;
         |SI #99#87 = 0;
             nCampo    = 87;
             #99nCampo = #3#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 58;
         #99nCampo = #3#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1 - 2;
     |LEE 040#3=;
     |SI FSalida = 0;
         |SI #99#58 = 0;
             nCampo    = 58;
             #99nCampo = #3#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 29;
         #99nCampo = #3#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1 - 3;
     |LEE 040#3=;
     |SI FSalida = 0;
         |SI #99#29 = 0;
             nCampo    = 29;
             #99nCampo = #3#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 0;
         #99nCampo = #3#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #3#0 = #0#0;
     #3#1 = #0#1 - 4;
     |LEE 040#3=;
     |SI FSalida = 0;
         |SI #99#0 = 0;
             nCampo    = 0;
             #99nCampo = #3#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #99#116 = #0#1;
     #99#87  = #0#1 - 1;
     #99#58  = #0#1 - 2;
     #99#29  = #0#1 - 3;
     #99#0   = #0#1 - 4;

     aAlfa = "A77," + #99#0;   |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "B77," + #99#29;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "C77," + #99#58;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "D77," + #99#87;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "E77," + #99#116; |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |PARA nCampo = 1;  |SI nCampo [ 28;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 78;
           aAlfa = "A" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 30;  |SI nCampo [ 57;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 49;
           aAlfa = "B" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 59;  |SI nCampo [ 86;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 20;
           aAlfa = "C" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 88;  |SI nCampo [ 115;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 9;
           aAlfa = "D" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 117;  |SI nCampo [ 144;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 38;
           aAlfa = "E" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;
|FPRC;

|PROCESO TrataHaber;
     |DDEFECTO #99;

     #4#0 = #0#0;
     #4#1 = #0#1 + 1;
     |LEE 040#4=;
     |SI FSalida = 0;
         nCampo    = 116;
         #99nCampo = #4#1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #4#0 = #0#0;
     #4#1 = #0#1;
     |LEE 040#4=;
     |SI FSalida = 0;
         |SI #99#116 ! 0;
             nCampo    = 87;
             #99nCampo = #4#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |SINO;
             nCampo    = 116;
             #99nCampo = #4#1;
             nFila     = 2;
             |HAZ CargaTemporal;

             nCampo    = 87;
             #99nCampo = #4#1 - 1;
             nFila     = 1;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #4#0 = #0#0;
     #4#1 = #0#1 - 1;
     |LEE 040#4=;
     |SI FSalida = 0;
         |SI #99#87 = 0;
             nCampo    = 87;
             #99nCampo = #4#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 58;
         #99nCampo = #4#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #4#0 = #0#0;
     #4#1 = #0#1 - 2;
     |LEE 040#4=;
     |SI FSalida = 0;
         |SI #99#58 = 0;
             nCampo    = 58;
             #99nCampo = #4#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 29;
         #99nCampo = #4#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #4#0 = #0#0;
     #4#1 = #0#1 - 3;
     |LEE 040#4=;
     |SI FSalida = 0;
         |SI #99#29 = 0;
             nCampo    = 29;
             #99nCampo = #4#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;

         nCampo    = 0;
         #99nCampo = #4#1 - 1;
         nFila     = 1;
         |HAZ CargaTemporal;
     |FINSI;

     #4#0 = #0#0;
     #4#1 = #0#1 - 4;
     |LEE 040#4=;
     |SI FSalida = 0;
         |SI #99#0 = 0;
             nCampo    = 0;
             #99nCampo = #4#1;
             nFila     = 2;
             |HAZ CargaTemporal;
         |FINSI;
     |FINSI;

     #99#116 = #0#1;
     #99#87  = #0#1 - 1;
     #99#58  = #0#1 - 2;
     #99#29  = #0#1 - 3;
     #99#0   = #0#1 - 4;

     aAlfa = "A112," + #99#0;   |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "B112," + #99#29;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "C112," + #99#58;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "D112," + #99#87;  |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     aAlfa = "E112," + #99#116; |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;

     |PARA nCampo = 1;  |SI nCampo [ 21;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 113;
           aAlfa = "A" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 30;  |SI nCampo [ 50;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 84;
           aAlfa = "B" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 59;  |SI nCampo [ 79;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 55;
           aAlfa = "C" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 88;  |SI nCampo [ 108;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo + 26;
           aAlfa = "D" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;

     |PARA nCampo = 117;  |SI nCampo [ 137;  |HACIENDO nCampo = nCampo + 1;
           enCanti = #99nCampo;  |HAZ ConverMoneda;  #99nCampo = enCanti;
           nNume = nCampo - 3;
           aAlfa = "E" + nNume + "," + #99nCampo;
           |ALFACALLDLL "agixl97.dll","poke_dato",aAlfa;
     |SIGUE;
|FPRC;

|PROCESO TrataTempo;
     nFichero = 1;  |HAZ TrataActivo;
     nFichero = 2;  |HAZ TrataPasivo;
     nFichero = 3;  |HAZ TrataDebe;
     nFichero = 4;  |HAZ TrataHaber;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |HAZ LeeUnidadBasico;

     |ABRE #100;
     nAnyoDesde = #0#1 - 5;
     nCoopera   = 0;
     |PARA nCampo = nAnyoDesde;  |SI nCampo [ #0#1;  |HACIENDO nCampo = nCampo + 1;
           #100#0 = #0#0;
           #100#1 = nCampo;
           |LEE 000#100=;
           |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

           |SI #100#13 = "S";
               nCoopera = 1;
               |SAL;
           |FINSI;
     |SIGUE;

     |SI nCoopera = 1;
         |MENAV "0000 Hay Cuentas Anuales de Cooperativas, no esta preparado el informe.";
         |ACABA;
     |FINSI;

     enSwTrata = 1;
     eaMoneda  = #0#2;

     |DBASE aBase;   |QBF aBase;

     aAlfa      = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa      = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;
     |SI #0#2 = "PESETAS";
         eaDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/dsges.xls";
         eaOrigen   = aBase + "word/graficos/dsges.xls";
     |SINO;
         eaDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/dsgese.xls";
         eaOrigen   = aBase + "word/graficos/dsgese.xls";
         |XABRE "E", eaOrigen, nHandle;
         |SI FSalida < 0;
             |MENAV "      No existe el fichero dsgese.xls, pongase en contacto con su distribuidor";
             |ACABA;
         |FINSI;
         |XCIERRA nHandle;
     |FINSI;

     |HAZ EnviaFichero;

     |CARGADLL "agixl97.dll";
     |SI FSalida < 0;
         |MENAV "0000No se puede usar agixl97.dll";
         |ACABA;
     |FINSI;

     |SI #0#2 = "PESETAS";
         aAlfa = eaUnidadBasico + "\MODELOS\MEMORIAS\DSGES.XLS";
     |SINO;
         aAlfa = eaUnidadBasico + "\MODELOS\MEMORIAS\DSGESE.XLS";
     |FINSI;
     |ALFACALLDLL "agixl97.dll", "carga_book", aAlfa;

     |ALFACALLDLL "agixl97.dll","selecciona_hoja", "Intro";

     |ABRE #1;
     |ABRE #2;
     |ABRE #3;
     |ABRE #4;
     |HAZ TrataTempo;
     |CIERRA #1;
     |CIERRA #2;
     |CIERRA #3;
     |CIERRA #4;

     |ALFACALLDLL "agixl97.dll","fin_book", "imprime";

     |DESCARGADLL "agixl97.dll";

     |RFBORRA eaDestino;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 7;
     |HAZ PintaMoneda;
     #0#2 = eaMoneda;

     |PINTA #0#2;
|FPRC;
