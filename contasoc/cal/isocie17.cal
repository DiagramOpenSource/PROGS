|FICHEROS;
   isocie17 #0;
   isocie22 #1;
   isocie36 #2;
   isocie46 #3;
|FIN;

|VARIABLES;
   &empresa   = 0;
   &anyo      = 0;
   &modo      = 0;
   &modelito  = 0;

   FEstado    = 0;
|FIN;

|RUTINA inferior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 1;
|FRUT;

|RUTINA superior;
  #0#0 = empresa;
  #0#1 = anyo;
  #0#2 = 99;
|FRUT;

|PROGRAMA;
|PINPA #0#0;
|SI modo = 1;
    |ENTLINEAL #1#0,3,1,16,0,inferior,superior;
    |HAZ liquidacio;
|FINSI;
|SI modo = 2;
    |ENTLINEAL #1#0,3,2,16,0,inferior,superior;
    |HAZ liquidacio;
|FINSI;
|SI modo = 4;
    |ENTLINEAL #1#0,3,4,16,0,inferior,superior;
|FINSI;
|FPRO;

|PROCESO calculo;
|SI anyo [ 1995;
    #0#7 = #0#5 - #0#6;
|SINO;
    #0#7 = #0#5;
|FINSI;

|SI #0#7 < 0; #0#7 = 0; |FINSI;
|PINTA #0#7;
|FPRC;

|PROCESO calcular;
|SI anyo = 1992;
    |SI #0#3 = 1; #1#20 = #1#20 + #0#7; |FINSI;
    |SI #0#3 = 2; #1#20 = #1#20 + #0#7; |FINSI;
    |SI #0#3 = 3; #1#21 = #1#21 + #0#7; |FINSI;
    |SI #0#3 = 4; #1#22 = #1#22 + #0#7; |FINSI;
|FINSI;

|SI anyo = 1993;
    |SI #0#3 = 1; #2#20 = #2#20 + #0#7; |FINSI;
    |SI #0#3 = 2; #2#20 = #2#20 + #0#7; |FINSI;
    |SI #0#3 = 3; #2#21 = #2#21 + #0#7; |FINSI;
    |SI #0#3 = 4; #2#22 = #2#22 + #0#7; |FINSI;
|FINSI;

|SI anyo ] 1994; |Y anyo < 1996;
    |SI #0#3 = 1; #3#21 = #3#21 + #0#7; |FINSI;
    |SI #0#3 = 2; #3#21 = #3#21 + #0#7; |FINSI;
    |SI #0#3 = 3; #3#22 = #3#22 + #0#7; |FINSI;
    |SI #0#3 = 4; #3#23 = #3#23 + #0#7; |FINSI;
|FINSI;
|FPRC;

|DEFBUCLE isocie17;
#0#1;
;
empresa, anyo, 01;
empresa, anyo, 99;
e;
NULL, calcular;
|FIN;

|PROCESO liquidacio;
|SI anyo = 1992;
    |ABRE #1;
    #1#0 = empresa;
    #1#1 = anyo;
    |LIBERA #1;
    |LEE 110#1=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #1; #1#0 = empresa; #1#1 = anyo; |FINSI;

    #1#20 = 0;
    #1#21 = 0;
    #1#22 = 0;
    |BUCLE isocie17;

    |SI FEstado = 0; |GRABA 020#1a; |SINO; |GRABA 020#1n; |FINSI;
    |CIERRA #1;
    |SUB_EJECUTA "ispant31.run";
|FINSI;

|SI anyo = 1993;
    |ABRE #2;
    #2#0 = empresa;
    #2#1 = anyo;
    |LIBERA #2;
    |LEE 110#2=;
    FEstado = FSalida;
    |SI FEstado ! 0; |DDEFECTO #2; #2#0 = empresa; #2#1 = anyo; |FINSI;

    #2#20 = 0;
    #2#21 = 0;
    #2#22 = 0;
    |BUCLE isocie17;

    |SI FEstado = 0; |GRABA 020#2a; |SINO; |GRABA 020#2n; |FINSI;
    |CIERRA #2;
    |SUB_EJECUTA "ispant31.run";
|FINSI;

|SI anyo ] 1994; |Y anyo < 1996; |SUB_EJECUTA "isz00005"; |FINSI;
|FPRC;
