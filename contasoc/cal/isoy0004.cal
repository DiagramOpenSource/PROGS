|FICHEROS;
      isoy0004 #0;

      isacceso #201;   ||Acceso a Impuesto
      isozw001 #999;
|FIN;

|VARIABLES;
     &empresa   = 0;
     &anyo      = 0;
     nSw        = 0;
     nSwAlgun   = 0;
     informe    = "isozw001";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &enError        = 0;
     &enAviso        = 0;
     &eaError        = "";
     &enSwLinea      = 0;
     &eaSwLinea      = "";

     aFichero        = "";
     fFecha          = @;
     aAlfa           = "";
|FIN;

|PROCESO defecto; |TIPO 7;
    fFecha = ~;
    aAlfa  = fFecha;
    aAlfa  = aAlfa % -104;
    #0#2   = aAlfa;
    #0#2   = #0#2 - 1;
    |PINTA #0#2;
|FPRC;

|PROCESO LeeErrores;
    |SI enSwLinea = 0;
        eaSwLinea = #isozw001#2;
    |FINSI;
    |SI eaSwLinea ! #isozw001#2;
        enSwLinea = 2; |PRINT;
        enSwLinea = 1;
    |FINSI;
    |PRINT;
    enSwLinea = 1;
    eaSwLinea = #isozw001#2;
|FPRC;

|DEFBUCLE LeeErrores;
    #isozw001#1;
    ;
    enAnyo, enEmpresa, " ", 0001;
    enAnyo, enEmpresa, "z", 9999;
    ;
    NULL, LeeErrores;
|FIN;

|PROCESO LeoEmpresas;

  enEmpresa = #201#0;
  enAnyo    = #201#1;

  |SUB_EJECUTA "isoz0002;INFORME";

  |SI enAviso ! 0; |O enError ! 0;

      enSwLinea = 0;
      eaSwLinea = "";
      |BUCLE LeeErrores;
      enSwLinea = 2; |PRINT;
      nSw      = 1;
      nSwAlgun = 1;
  |SINO;
      eaSwLinea = "";
      enSwLinea = 0; |PRINT;
      enSwLinea = 3; |PRINT;
      nSw = 1;
  |FINSI;

|FPRC;

|DEFBUCLE LeoEmpresas;
   #201#1
   ;
   #0#2, #0#0;
   #0#2, #0#1;
   e;
   NULL, LeoEmpresas;
|FIN;


|PROCESO Tipo12; |TIPO 3;
         aFichero = ("2z" + Usuario) % 108;
         |NOME_DAT #isozw001#aFichero#;
         |DELINDEX #isozw001;

         |IMPRE 0;
         |SI FSalida ! 0;
             |MENAV "    Proceso Interrumpido";
             |ACABA;
         |FINSI;

         |INFOR informe;
         |SI FSalida ! 0;
             |MENAV "    No existe Informe";
             |FINIMP;
             |ACABA;
         |FINSI;

         nSw      = 0;
         nSwAlgun = 0;
         |BUCLE LeoEmpresas;
         |SI nSwAlgun = 0;
             |MENAV "    No hay Errores ni Avisos ";
         |FINSI;
         |SI nSw = 1;
             |PIEINF;
         |FINSI;

         |FININF;
         |FINIMP;
|FPRC;
