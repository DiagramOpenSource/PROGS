|FICHEROS;
    isocie23 #0;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &modo      = 0;

    sw      = 0;
    campo1  = 0;
    campo2  = 0;
    campo3  = 0;
    FEstado = 0;
    varcamp = 0;
    x       = 0;
    tecla   = "";
    avance  = "815";
    atras   = "814";
    suma    = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta;
  avance = &255 + avance;
  atras = &255 + atras;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
  |PINPA #0#0;
  |PINDA #0#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
  |PINPA #1#0;
  |PINDA #1#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
  |PINPA #2#0;
  |PINDA #2#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
  |PINPA #3#0;
  |PINDA #3#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO panta1; |TIPO 0;
|CAMPO_MODIFICA #0#02, 1, "S";
|CAMPO_MODIFICA #0#03, 1, "S";
|CAMPO_MODIFICA #0#04, 1, "S";
|CAMPO_MODIFICA #0#05, 1, "S";
|CAMPO_MODIFICA #0#13, 1, "S";
|CAMPO_MODIFICA #0#14, 1, "S";
|CAMPO_MODIFICA #0#15, 1, "S";
|CAMPO_MODIFICA #0#06, 1, "N";
|CAMPO_MODIFICA #0#07, 1, "N";
|CAMPO_MODIFICA #0#08, 1, "N";
|CAMPO_MODIFICA #0#09, 1, "N";
|CAMPO_MODIFICA #0#10, 1, "N";
|CAMPO_MODIFICA #0#11, 1, "N";
|CAMPO_MODIFICA #0#12, 1, "N";
|SI #0#2 = "X";
    |CAMPO_MODIFICA #0#08, 1, "S";
    |CAMPO_MODIFICA #0#09, 1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#3 = "X";
    |CAMPO_MODIFICA #0#06, 1, "S";
    |CAMPO_MODIFICA #0#08, 1, "S";
    |CAMPO_MODIFICA #0#09, 1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#4 = "X";
    |CAMPO_MODIFICA #0#07, 1, "S";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#08, 1, "N"; #0#08 = 0;  |PINTA #0#08;
    |CAMPO_MODIFICA #0#09, 1, "N"; #0#09 = 0;  |PINTA #0#09;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#5 = "X";
    |CAMPO_MODIFICA #0#10, 1, "S";
    |CAMPO_MODIFICA #0#11, 1, "S";
    |CAMPO_MODIFICA #0#12, 1, "S";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#08, 1, "N"; #0#08 = 0;  |PINTA #0#08;
    |CAMPO_MODIFICA #0#09, 1, "N"; #0#09 = 0;  |PINTA #0#09;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#13 = "X";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#08, 1, "N"; #0#08 = 0;  |PINTA #0#08;
    |CAMPO_MODIFICA #0#09, 1, "N"; #0#09 = 0;  |PINTA #0#09;
    |CAMPO_MODIFICA #0#10, 1, "N"; #0#10 = 0;  |PINTA #0#10;
    |CAMPO_MODIFICA #0#11, 1, "N"; #0#11 = 0;  |PINTA #0#11;
    |CAMPO_MODIFICA #0#12, 1, "N"; #0#12 = 0;  |PINTA #0#12;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#14 = "X";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#08, 1, "N"; #0#08 = 0;  |PINTA #0#08;
    |CAMPO_MODIFICA #0#09, 1, "N"; #0#09 = 0;  |PINTA #0#09;
    |CAMPO_MODIFICA #0#10, 1, "N"; #0#10 = 0;  |PINTA #0#10;
    |CAMPO_MODIFICA #0#11, 1, "N"; #0#11 = 0;  |PINTA #0#11;
    |CAMPO_MODIFICA #0#12, 1, "N"; #0#12 = 0;  |PINTA #0#12;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#15, 1, "N"; #0#15 = ""; |PINTA #0#15;
|FINSI;

|SI #0#15 = "X";
    |CAMPO_MODIFICA #0#02, 1, "N"; #0#02 = ""; |PINTA #0#02;
    |CAMPO_MODIFICA #0#03, 1, "N"; #0#03 = ""; |PINTA #0#03;
    |CAMPO_MODIFICA #0#04, 1, "N"; #0#04 = ""; |PINTA #0#04;
    |CAMPO_MODIFICA #0#05, 1, "N"; #0#05 = ""; |PINTA #0#05;
    |CAMPO_MODIFICA #0#06, 1, "N"; #0#06 = 0;  |PINTA #0#06;
    |CAMPO_MODIFICA #0#07, 1, "N"; #0#07 = 0;  |PINTA #0#07;
    |CAMPO_MODIFICA #0#08, 1, "N"; #0#08 = 0;  |PINTA #0#08;
    |CAMPO_MODIFICA #0#09, 1, "N"; #0#09 = 0;  |PINTA #0#09;
    |CAMPO_MODIFICA #0#10, 1, "N"; #0#10 = 0;  |PINTA #0#10;
    |CAMPO_MODIFICA #0#11, 1, "N"; #0#11 = 0;  |PINTA #0#11;
    |CAMPO_MODIFICA #0#12, 1, "N"; #0#12 = 0;  |PINTA #0#12;
    |CAMPO_MODIFICA #0#13, 1, "N"; #0#13 = ""; |PINTA #0#13;
    |CAMPO_MODIFICA #0#14, 1, "N"; #0#14 = ""; |PINTA #0#14;
|FINSI;
|FPRC;

|PROCESO porcent;
|SI #0#2 = "X"; |O #0#3 = "X"; |O #0#4 = "X"; |O #0#5 = "X";
    suma = #0#10 + #0#11 + #0#12;
    |SI suma ! 100;
       |MENAV "     La suma debe ser igual a cien";
       |ERROR;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO panta2; |TIPO 0;
#0#22 = #0#20 + #0#21; |PINTA #0#22;
#0#23 = (#0#17 + #0#18) - (#0#19 + #0#22); |PINTA #0#23;
#0#24 = #0#16 + #0#23; |PINTA #0#24;
|FPRC;

|PROCESO panta3; |TIPO 0;
#0#28 = #0#25 - #0#26 - #0#27; |PINTA #0#28;
|SI #0#13 = "X"; |O #0#14 = "X"; |O #0#15 = "X";
    #0#29 = #0#28; |PINTA #0#29;
    #0#30 = 0;     |PINTA #0#30;
    #0#31 = 0;     |PINTA #0#31;
    #0#32 = 0;     |PINTA #0#32;
    #0#33 = 0;     |PINTA #0#33;
|SINO;
    #0#30 = #0#28 % #0#10; |PINTA #0#30;
    #0#31 = #0#28 % #0#11; |PINTA #0#31;
    #0#32 = #0#28 % #0#12; |PINTA #0#32;
    #0#33 = (#0#31 * 0.35) + (#0#32 * 0.56); |PINTA #0#33;
    #0#29 = 0;             |PINTA #0#29;
|FINSI;
|FPRC;

|PROCESO panta4; |TIPO 0;
#0#39 = #0#44 - #0#49; |PINTA #0#39;
#0#40 = #0#45 - #0#50; |PINTA #0#40;
#0#41 = #0#46 - #0#51; |PINTA #0#41;
#0#42 = #0#47 - #0#52; |PINTA #0#42;
#0#43 = #0#48 - #0#53; |PINTA #0#43;
|FPRC;
