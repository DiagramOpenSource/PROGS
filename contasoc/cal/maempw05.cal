|FICHEROS;
     maempw05 #0;

     :/basica/def/agim0135;
|FIN;

|VARIABLES;
     nDias      = 0;

     aAlfa1     = "";
     aAlfa2     = "";
     aAlfa3     = "";

     &enEmpresa = 0;
     &enAnyo    = 0;
     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|INCLUYE incca8m0;
|INCLUYE verifech;

|PROCESO Tipo12Fw5;  |TIPO 12;
|FPRC;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #maempw05#Campo#;
         |HAZ CalculoDNI;
         #maempw05#Campo# = eaVarDni;
         |PINTA #maempw05#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #maempw05#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #maempw05#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #maempw05#Campo# = eaVarDni;  |PINTA #maempw05#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C8Fw5;
     |C_M #maempw05#9,  1, "S";
     |C_M #maempw05#10, 1, "S";
     |SI #maempw05#8  = "N";
         #maempw05#9  = "";
         #maempw05#10 = "";
         |C_M #maempw05#9,  1, "N";
         |C_M #maempw05#10, 1, "N";
     |FINSI;

     |PINTA #maempw05#9;
     |PINTA #maempw05#10;
|FPRC;

|PROCESO LeeBal; |TIPO 6;
     |ABRE #ca8m0000;
     #ca8m0000#0 = #maempw05#Campo#;
     |LEE 001#ca8m0000.=;
     |SI FSalida ! 0;
         |CIERRA #ca8m0000;
         |MENAV  "    No existe Estructura de Balance";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #ca8m0000;
|FPRC;

|PROCESO LeeRes; |TIPO 6;
     |ABRE #ca8m0000;
     #ca8m0000#0 = #maempw05#Campo#;
     |LEE 000#ca8m0000.=;
     |SI FSalida ! 0;
         |CIERRA #ca8m0000;
         |MENAV  "    No existe Estructura de Cuenta de Resultados";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #ca8m0000;
|FPRC;

|PROCESO Tipo66C1Fw5;  |TIPO 66;
     |ABRE #agim0135;
     #agim0135#0 = #maempw05#1;
     |LEE 000#agim0135.=;

     |CONSULTA_CLAVE #1#agim0135;
     |SI FSalida = 0;
         #maempw05#1 = #agim0135#0;
     |FINSI;

     |CIERRA #agim0135;

     |PINTA #maempw05#1;
|FPRC;

|PROCESO Tipo0C3Fw5;  |TIPO 0;
     aAlfa1 = #maempw05#2 % 105;
     aAlfa2 = #maempw05#3 % 105;
     aAlfa3 = enAnyo;  aAlfa3 = aAlfa3 % -102;
     |SI aAlfa1 = "01.01";  |Y aAlfa2 = "31.12";
         #maempw05#0 = aAlfa3 + "1";
         |PINTA #maempw05#0;
         |ACABA;
     |FINSI;

     nDias = (#maempw05#3 - #maempw05#2) + 1;
     |SI nDias ] 365;
         #maempw05#0 = aAlfa3 + "2";
         |PINTA #maempw05#0;
         |ACABA;
     |FINSI;

     #maempw05#0 = aAlfa3 + "3";
     |PINTA #maempw05#0;
|FPRC;
