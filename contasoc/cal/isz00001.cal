|FICHEROS;
   isz00001 #0;
   sodacoca #1;
   sodacoli #2;

   :/basica/def/agiconpa   #4;
   :/contagen/def/canempre #5;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &tipo    = 0;
     &enNoPanta = 0;

     &empAlta    = 0;
     &empre      = 0;
     &perio      = 0;
     &plani      = 0;
     &cuent      = ""
     &siono      = "";

     nNumer1     = 0;
     nNumer2     = 0;
|FIN;

|PROCESO canempre1;
     nNumer1 = anyo $ 100;
     |SI nNumer1 = #5#26;
         perio = #5#3;
         |ERROR10;
     |FINSI;
|FPRC;

|DEFBUCLE canempre;
     #5#1;
     ;
     nNumer2, 0;
     nNumer2, 9;
     ;
     NULL, canempre1;
|FIN;

|PROCESO BuscaPeriodo;
     perio = -1;
     nNumer2 = #4#5;
     |BUCLE canempre;
|FPRC;

|PROCESO agiconpa1;
     |SI #4#2 ! "I1";  |ACABA;  |FINSI;

     |HAZ BuscaPeriodo;
     |SI perio = -1;  |ACABA;  |FINSI;

     empAlta = empresa;
     empre   = #4#5;
     plani   = #4#17;
     cuent   = #4#18;
     siono   = "SI";
     |PTEC 802;
     |SUB_EJECUTA "soagico1";
|FPRC;

|DEFBUCLE agiconpa;
     #4#1;
     ;
     empresa,  1;
     empresa, 99;
     ;
     NULL, agiconpa1;
|FIN;

|PROCESO MiraEstructura;
     |ABRE #sodacoca;
     #sodacoca#0 = empresa;
     #sodacoca#1 = anyo;
     |LEE 040#sodacoca.=;
     |SI FSalida ! 0;
         |BUCLE agiconpa;
     |FINSI;
     |CIERRA #sodacoca;
|FPRC;

|PROGRAMA;
|SI enNoPanta = 0;
    |PINPA #0#0;
|FINSI;
|DDEFECTO #0;
#0#3 = anyo;
|SI #0#3 = 1996; #0#0 = 8;  |FINSI;
|SI #0#3 ] 1997; #0#0 = 9;  |FINSI;

|SI enNoPanta = 0;
    |PINDA #0#0;
    |ENDATOS #1#0;
    |SI FSalida = 0;
        |SI #0#2 = "SI";
            |HAZ MiraEstructura;
            |SI anyo = 1992; |HAZ pasa_92; |FINSI;
            |SI anyo = 1993; |HAZ pasa_93; |FINSI;
            |SI anyo = 1994; |HAZ pasa_94; |FINSI;
            |SI anyo = 1995; |HAZ pasa_94; |FINSI;
            |SI anyo = 1996; |HAZ Pasa96;  |FINSI;
            |SI anyo = 1997; |HAZ Pasa97;  |FINSI;
            |SI anyo = 1998; |HAZ Pasa97;  |FINSI;
            |SI anyo ] 1999; |HAZ Pasa99;  |FINSI;
        |FINSI;
    |FINSI;
|SINO;
    |SI anyo = 1992; |HAZ pasa_92; |FINSI;
    |SI anyo = 1993; |HAZ pasa_93; |FINSI;
    |SI anyo = 1994; |HAZ pasa_94; |FINSI;
    |SI anyo = 1995; |HAZ pasa_94; |FINSI;
    |SI anyo = 1996; |HAZ Pasa96;  |FINSI;
    |SI anyo = 1997; |HAZ Pasa97;  |FINSI;
    |SI anyo = 1998; |HAZ Pasa97;  |FINSI;
    |SI anyo ] 1999; |HAZ Pasa99;  |FINSI;
|FINSI;
|FPRO;
