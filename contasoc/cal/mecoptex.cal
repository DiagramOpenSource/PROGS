|FICHEROS;
     mecoptex #0;
     metextos #1;
|FIN;

|VARIABLES;
     XPara    = 0;
     Capitulo = 0;
     Empresa  = 0;
     Sw       = 0;
|FIN;

|PROCESO Seleccion;
  |SI #0#6 = "S";
      |C_M #0#5, 1, "N";  #0#5 = 0;  |PINTA #0#5;
      |PARA XPara = 7; |SI XPara [ 46; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "S";
      |SIGUE;
  |SINO;
      |C_M #0#5, 1, "S";
      |PARA XPara = 7; |SI XPara [ 46; |HACIENDO XPara = XPara + 1;
            |C_M #0XPara, 1, "N";  #0XPara = 0;  |PINTA #0XPara;
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO Opera;
  |SI Sw = 1;
      |BORRA 140#1a;
      |LIBERA #1;
      |ACABA;
  |FINSI;

  |PARA XPara = 7;  |SI XPara [ 46;  |HACIENDO XPara = XPara + 1;
        |SI #0XPara ! 0;
            #1#0  = #0#2;
            #1#17 = #0XPara;
            |GRABA 140#1n;
        |FINSI;
  |SIGUE;

  #1#0  = #0#0;
  #1#17 = #0#4;
  |LIBERA #1;
  |LEE 140#1=;
|FPRC;

|DEFBUCLE metextos;
  #1#1;
  ;
  Capitulo, 00, Empresa;
  Capitulo, 99, Empresa;
  be;
  NULL, Opera;
|FIN;

|PROCESO Tipo3;|TIPO 3;
  |SI #0#6 = "N";
      #0#7 = #0#5;
  |FINSI;

  Sw       = 1;
  Capitulo = #0#2;
  |PARA XPara = 7;  |SI XPara [ 46;  |HACIENDO XPara = XPara + 1;
        |SI #0XPara ! 0;
            Empresa = #0XPara;
            |BUCLE metextos;
        |FINSI;
  |SIGUE;

  Sw       = 2;
  Capitulo = #0#0;
  Empresa  = #0#4;
  |BUCLE metextos;
|FPRC;
