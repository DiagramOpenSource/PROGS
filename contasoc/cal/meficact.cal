|FICHEROS;
    meficact #0;            || Fichero emision
    meempmem #1;            || Fichero empresas memoria
    maempr01 #3;

    :/basica/def/agim0019 #19;
    :/basica/def/agim0026 #26;
|FIN;

|VARIABLES;
     PathFich = "";
     Modulo   = "";
     Contador = 0;
     Nombre1  = "";
     Nombre2  = "";
     empre    = 0;
     registro = 0;
     empresa  = 0;
     x        = 0;
     opcion   = 0;
     direct   = "";
     informe  = "";
     pepe1    = "";
     pepe2    = "";
     cont     = 0;
     Empresa  = 0;
     Ejercic  = 0;

     &acabalo = 0;
|FIN;

|PROCESO cuadro; |TIPO 7;
  |PUSHV 0501 2380
  |CUADRO 0742 2078;
  |ATRI R;
  |PINTA 0843, "Acta 1: S.A., S.L., Junta Universal";
  |PINTA 0943, "        Sin informe de Auditorias  ";
  |PINTA 1043, "Acta 2: S.A., S.L., Junta Universal";
  |PINTA 1143, "        Con informe de Auditorias  ";
  |PINTA 1243, "Acta 3: S.A., Junta Convocada      ";
  |PINTA 1343, "        Sin informe de Auditorias  ";
  |PINTA 1443, "Acta 4: S.A., Junta Convocada      ";
  |PINTA 1543, "        Con informe de Auditorias  ";
  |PINTA 1643, "Acta 5: S.L., Junta Convocada      ";
  |PINTA 1743, "        Sin informe de Auditorias  ";
  |PINTA 1843, "Acta 6: S.L., Junta Convocada      ";
  |PINTA 1943, "        Con informe de Auditorias  ";
  |ATRI 0;
|FPRC;

|PROCESO modifica; |TIPO 0;
|POPV;
|PINTA #0#2;
|CAMPO_MODIFICA #0#10, 1, "N";
|CAMPO_MODIFICA #0#11, 1, "N";
|CAMPO_MODIFICA #0#12, 1, "N";
|CAMPO_MODIFICA #0#13, 1, "N";
|CAMPO_MODIFICA #0#14, 1, "N";
|CAMPO_MODIFICA #0#15, 1, "N";
|CAMPO_MODIFICA #0#18, 1, "N";
|CAMPO_MODIFICA #0#19, 1, "N";
|CAMPO_MODIFICA #0#21, 1, "N";
|CAMPO_MODIFICA #0#22, 1, "N";
|CAMPO_MODIFICA #0#23, 1, "N";
|CAMPO_MODIFICA #0#27, 1, "N";

|SI #0#2 = 2;
   |CAMPO_MODIFICA #0#21, 1, "S";
|FINSI;

|SI #0#2 = 3;
   |CAMPO_MODIFICA #0#10, 1, "S";
   |CAMPO_MODIFICA #0#11, 1, "S";
   |CAMPO_MODIFICA #0#12, 1, "S";
   |CAMPO_MODIFICA #0#13, 1, "S";
   |CAMPO_MODIFICA #0#14, 1, "S";
   |CAMPO_MODIFICA #0#15, 1, "S";
   |CAMPO_MODIFICA #0#18, 1, "S";
   |CAMPO_MODIFICA #0#19, 1, "S";
   |CAMPO_MODIFICA #0#22, 1, "S";
   |CAMPO_MODIFICA #0#23, 1, "S";
|FINSI;

|SI #0#2 = 4;
   |CAMPO_MODIFICA #0#10, 1, "S";
   |CAMPO_MODIFICA #0#11, 1, "S";
   |CAMPO_MODIFICA #0#12, 1, "S";
   |CAMPO_MODIFICA #0#13, 1, "S";
   |CAMPO_MODIFICA #0#14, 1, "S";
   |CAMPO_MODIFICA #0#15, 1, "S";
   |CAMPO_MODIFICA #0#18, 1, "S";
   |CAMPO_MODIFICA #0#19, 1, "S";
   |CAMPO_MODIFICA #0#21, 1, "S";
   |CAMPO_MODIFICA #0#22, 1, "S";
   |CAMPO_MODIFICA #0#23, 1, "S";
|FINSI;

|SI #0#2 = 5;
   |CAMPO_MODIFICA #0#14, 1, "S";
   |CAMPO_MODIFICA #0#15, 1, "S";
   |CAMPO_MODIFICA #0#18, 1, "S";
   |CAMPO_MODIFICA #0#19, 1, "S";
   |CAMPO_MODIFICA #0#27, 1, "S";
|FINSI;

|SI #0#2 = 6;
   |CAMPO_MODIFICA #0#14, 1, "S";
   |CAMPO_MODIFICA #0#15, 1, "S";
   |CAMPO_MODIFICA #0#18, 1, "S";
   |CAMPO_MODIFICA #0#19, 1, "S";
   |CAMPO_MODIFICA #0#21, 1, "S";
   |CAMPO_MODIFICA #0#27, 1, "S";
|FINSI;

|FPRC;

|PROCESO BuscaAdminis;
  Contador = Contador + 1;

  |SI #26#13 = "U"; |O #26#13 = "S";
      Nombre1 = #26#4;
      |ERROR10;
      |ACABA;
  |FINSI;

  |SI Contador = 1;
       Nombre1 = #26#4;
  |SINO;
       Nombre2 = #26#4;
       |ERROR10;
  |FINSI;
|FPRC;

|DEFBUCLE agim0026;
  #26#1;
  16;
  #19#0, #19#1, 01, 7;
  #19#0, #19#1, 99, 7;
  ;
  NULL, BuscaAdminis;
|FIN;

|PROCESO cargacam;|TIPO 0;
  cont = (FEntrada / 100) ! 0;
  |SI cont ! 1; |ACABA; |FINSI;

  empresa = #0#0;
  empre   = empresa;
  |ABRE #1;
  |ABRE #3;

  #1#0 = #0#0;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;

  #3#0 = #0#0; #3#1 = #1#5; |LEE 040#3];
  |SI FSalida ! 0;  |O #3#0 ! #0#0; |O #3#1 ! #1#5;
      |DDEFECTO #3;
  |FINSI;

  |ABRE #19;
  #19#0 = #0#0;
  #19#1 = 99;
  |LEE 040#19];
  |SI FSalida = 0;
      |LEE 040#19a;
  |SINO;
      |LEE 040#19u;
  |FINSI;

  |SI FSalida ! 0;  |O #19#0 ! #0#0;
      |DDEFECTO #19;
  |FINSI;
  |CIERRA #19;

  Contador = 0;
  Nombre1  = "";
  Nombre2  = "";

  |BUCLE agim0026;

  #0#7  = #3#2;
  #0#8  = #3#33;
  #0#9  = #3#13;
  #0#16 = Nombre1;
  #0#17 = #3#77;
  #0#24 = #3#13;

  |SI Contador = 0;
      #0#4  = "DON. " +  #3#77;
      #0#5  = "";
      #0#6  = "SECRETARIO";
      #0#26 = "V.PRESIDENTE";
  |SINO;
      |SI Contador = 1;
          #0#4  = "DON.  " + Nombre1;
          #0#5  = "";
          #0#6  = "ADMINISTRADOR";
      |SINO;
          #0#4 = "SRES.  " + Nombre1;
          #0#5 = Nombre2;
          #0#6 = "ADMINISTRADORES";
      |FINSI;
  |FINSI;

  |PINDA #0#0;
  |CIERRA #1;
  |CIERRA #3;
|FPRC;

|PROCESO impre; |TIPO 4;
Empresa = #0#0;
Ejercic = #0#1;

E_inf = 1;
E_sup = 99999;
Empresa = 613 ? 1;

E_inf = 1900;
E_sup = 2999;
Ejercic = 625 ? 1;

#0#0 = Empresa;
#0#1 = Ejercic;
|LEE 040#0=;
|SI FSalida ! 0; |ACABA; |FINSI;

|ABRE #1;
#1#0 = #0#0;
|LEE 040#1=;
|SI FSalida ! 0; |DDEFECTO #1; |FINSI;
|CIERRA #1;

|IMPRE 0;
|SI FSalida = 0;
    |SI #0#2 = 1; |Y #0#3 = "G"; |INFOR "modelo1g"; |FINSI;
    |SI #0#2 = 1; |Y #0#3 = "P"; |INFOR "modelo1p"; |FINSI;
    |SI #0#2 = 1; |Y #0#3 = "0"; |INFOR "modelo10"; |FINSI;
    |SI #0#2 = 2; |Y #0#3 = "G"; |INFOR "modelo2g"; |FINSI;
    |SI #0#2 = 2; |Y #0#3 = "P"; |INFOR "modelo2p"; |FINSI;
    |SI #0#2 = 2; |Y #0#3 = "0"; |INFOR "modelo20"; |FINSI;
    |SI #0#2 = 3; |Y #0#3 = "G"; |INFOR "modelo3g"; |FINSI;
    |SI #0#2 = 3; |Y #0#3 = "P"; |INFOR "modelo3p"; |FINSI;
    |SI #0#2 = 3; |Y #0#3 = "0"; |INFOR "modelo30"; |FINSI;
    |SI #0#2 = 4; |Y #0#3 = "G"; |INFOR "modelo4g"; |FINSI;
    |SI #0#2 = 4; |Y #0#3 = "P"; |INFOR "modelo4p"; |FINSI;
    |SI #0#2 = 4; |Y #0#3 = "0"; |INFOR "modelo40"; |FINSI;
    |SI #0#2 = 5; |Y #0#3 = "G"; |INFOR "modelo5g"; |FINSI;
    |SI #0#2 = 5; |Y #0#3 = "P"; |INFOR "modelo5p"; |FINSI;
    |SI #0#2 = 5; |Y #0#3 = "0"; |INFOR "modelo50"; |FINSI;
    |SI #0#2 = 6; |Y #0#3 = "G"; |INFOR "modelo6g"; |FINSI;
    |SI #0#2 = 6; |Y #0#3 = "P"; |INFOR "modelo6p"; |FINSI;
    |SI #0#2 = 6; |Y #0#3 = "0"; |INFOR "modelo60"; |FINSI;

    |SI FSalida = 0;
        |PRINT;
        |PIEINF;
        |FININF;
    |FINSI;
    |FINIMP;
|FINSI;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |SI acabalo = 0;  |ACABA;  |FINSI;

     |PTEC  807;
     |PTEC  807;
|FPRC;
