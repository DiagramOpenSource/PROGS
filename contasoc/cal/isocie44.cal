|FICHEROS;
    isocie44 #0;
    isocie46 #1;
    isocie45 #2;
    isocie48 #3;
|FIN;

|VARIABLES;
    &empresa    = 0;
    &anyo       = 0;
    &tipo       = "";
    &modo       = 0;

    &numerica1  = 0; &numerica2  = 0; &numerica3  = 0;
    &numerica4  = 0; &numerica5  = 0; &numerica6  = 0;
    &numerica7  = 0; &numerica8  = 0; &numerica9  = 0;
    &numerica10 = 0; &numerica11 = 0; &numerica12 = 0;
    &numerica13 = 0; &numerica14 = 0; &numerica15 = 0;
    &numerica16 = 0; &numerica17 = 0; &numerica18 = 0;
    &numerica19 = 0;

    FEstado     = 0;
    varcamp     = 0;
    x           = 0;
    tecla       = "";
    avance      = "815";
    atras       = "814";
    benper      = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    #0#2 = tipo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
    |CIERRA #0;
    |HAZ liquidacio;
|FINSI;
|FPRC;

|PROCESO consulta;
  avance = &255 + avance;
  atras = &255 + atras;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROCESO pantalla1;
  |PINPA #0#0;
  |PINDA #0#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
  |PINPA #1#0;
  |PINDA #1#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
  |PINPA #2#0;
  |PINDA #2#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
  |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
  |PINPA #3#0;
  |PINDA #3#0;
  |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
  |LEETECLA tecla;
  |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pinta_mensa; |TIPO 7;
|SI Campo = 13;  |HAZ pinta_men; |FINSI;
|SI Campo = 31;  |HAZ pinta_men; |FINSI;
|SI Campo = 49;  |HAZ pinta_men; |FINSI;
|SI Campo = 56;  |HAZ pinta_men; |FINSI;
|SI Campo = 67;  |HAZ pinta_men; |FINSI;
|SI Campo = 74;  |HAZ pinta_men; |FINSI;
|SI Campo = 78;  |HAZ pinta_men; |FINSI;

|SI Campo = 97;  |HAZ pinta_men; |FINSI;
|SI Campo = 102; |HAZ pinta_men; |FINSI;
|SI Campo = 110; |HAZ pinta_men; |FINSI;
|SI Campo = 130; |HAZ pinta_men; |FINSI;

|SI Campo = 137; |HAZ pinta_men; |FINSI;
|SI Campo = 143; |HAZ pinta_men; |FINSI;
|SI Campo = 147; |HAZ pinta_men; |FINSI;
|SI Campo = 151; |HAZ pinta_men; |FINSI;
|SI Campo = 156; |HAZ pinta_men; |FINSI;
|SI Campo = 161; |HAZ pinta_men; |FINSI;

|SI Campo = 177; |HAZ pinta_men; |FINSI;
|SI Campo = 183; |HAZ pinta_men; |FINSI;
|FPRC;

|PROCESO pinta_men;
|PUSHV  1859 2272;
|CUADRO 1859 2272;
|ATRI R;
|PINTA 1960, "    <F1>    ";
|PINTA 2060, "  PANTALLA  ";
|PINTA 2160, " DESGLOSADA "
|ATRI r;
|FPRC;

|PROCESO extenso; |TIPO 0;
tecla = FSalida;
varcamp = Campo;

|SI Campo = 13;  |POPV; |HAZ campo311; |FINSI;
|SI Campo = 31;  |POPV; |HAZ campo329; |FINSI;
|SI Campo = 49;  |POPV; |HAZ campo347; |FINSI;
|SI Campo = 56;  |POPV; |HAZ campo354; |FINSI;
|SI Campo = 67;  |POPV; |HAZ campo366; |FINSI;
|SI Campo = 74;  |POPV; |HAZ campo373; |FINSI;
|SI Campo = 78;  |POPV; |HAZ campo377; |FINSI;

|SI Campo = 97;  |POPV; |HAZ campo419; |FINSI;
|SI Campo = 102; |POPV; |HAZ campo424; |FINSI;
|SI Campo = 110; |POPV; |HAZ campo432; |FINSI;
|SI Campo = 130; |POPV; |HAZ campo454; |FINSI;

|SI Campo = 137; |POPV; |HAZ campo505; |FINSI;
|SI Campo = 143; |POPV; |HAZ campo512; |FINSI;
|SI Campo = 147; |POPV; |HAZ campo516; |FINSI;
|SI Campo = 151; |POPV; |HAZ campo520; |FINSI;
|SI Campo = 156; |POPV; |HAZ campo525; |FINSI;
|SI Campo = 161; |POPV; |HAZ campo530; |FINSI;

|SI Campo = 177; |POPV; |HAZ campo605; |FINSI;
|SI Campo = 183; |POPV; |HAZ campo611; |FINSI;

|HAZ calculo;
|FPRC;

|PROCESO campo311;
numerica1 = #0#5;  numerica2 = #0#6;  numerica3 = #0#7;
numerica4 = #0#8;  numerica5 = #0#9;  numerica6 = #0#10;
numerica7 = #0#11; numerica8 = #0#12;

|SI tecla = 9; |SUB_EJECUTA "ispant01.run"; |FINSI;

#0#5  = numerica1;  #0#6  = numerica2;  #0#7  = numerica3;
#0#8  = numerica4;  #0#9  = numerica5;  #0#10 = numerica6;
#0#11 = numerica7;  #0#12 = numerica8;

Campo = varcamp;
#0Campo = #0#11 - #0#12;
|PINTA #0Campo;
|FPRC;

|PROCESO campo329;
numerica1  = #0#14;  numerica2  = #0#15;  numerica3  = #0#16;
numerica4  = #0#17;  numerica5  = #0#18;  numerica6  = #0#19;
numerica7  = #0#20;  numerica8  = #0#21;  numerica9  = #0#22;
numerica10 = #0#23;  numerica11 = #0#24;  numerica12 = #0#25;
numerica13 = #0#26;  numerica14 = #0#27;  numerica15 = #0#28;
numerica16 = #0#29;  numerica17 = #0#30;

|SI tecla = 9; |SUB_EJECUTA "ispant02.run"; |FINSI;

#0#14 = numerica1;   #0#15 = numerica2;   #0#16 = numerica3;
#0#17 = numerica4;   #0#18 = numerica5;   #0#19 = numerica6;
#0#20 = numerica7;   #0#21 = numerica8;   #0#22 = numerica9;
#0#23 = numerica10;  #0#24 = numerica11;  #0#25 = numerica12;
#0#26 = numerica13;  #0#27 = numerica14;  #0#28 = numerica15;
#0#29 = numerica16;  #0#30 = numerica17;

Campo = varcamp;
#0Campo = #0#29 - #0#30;
|PINTA #0Campo;
|FPRC;

|PROCESO campo347;
numerica1  = #0#32;  numerica2  = #0#33;  numerica3  = #0#34;
numerica4  = #0#35;  numerica5  = #0#36;  numerica6  = #0#37;
numerica7  = #0#38;  numerica8  = #0#39;  numerica9  = #0#40;
numerica10 = #0#41;  numerica11 = #0#42;  numerica12 = #0#43;
numerica13 = #0#44;  numerica14 = #0#45;  numerica15 = #0#46;
numerica16 = #0#47;  numerica17 = #0#48;

|SI tecla = 9; |SUB_EJECUTA "ispant03.run"; |FINSI;

#0#32 = numerica1;  #0#33 = numerica2;  #0#34 = numerica3;
#0#35 = numerica4;  #0#36 = numerica5;  #0#37 = numerica6;
#0#38 = numerica7;  #0#39 = numerica8;  #0#40 = numerica9;
#0#41 = numerica10; #0#42 = numerica11; #0#43 = numerica12;
#0#44 = numerica13; #0#45 = numerica14; #0#46 = numerica15;
#0#47 = numerica16; #0#48 = numerica17;

Campo = varcamp;
#0Campo = #0#47 - #0#48;
|PINTA #0Campo;
|FPRC;

|PROCESO campo354;
numerica1 = #0#54;  numerica2 = #0#55;

|SI tecla = 9; |SUB_EJECUTA "ispant04.run"; |FINSI;

#0#54 = numerica1;  #0#55 = numerica2;

Campo = varcamp;
#0Campo = #0#54 - #0#55;
|PINTA #0Campo;
|FPRC;

|PROCESO campo366;
numerica1  = #0#57;  numerica2  = #0#58;  numerica3  = #0#59;
numerica4  = #0#60;  numerica5  = #0#61;  numerica6  = #0#62;
numerica7  = #0#63;  numerica8  = #0#64;  numerica9  = #0#65;
numerica10 = #0#66;

|SI tecla = 9; |SUB_EJECUTA "ispant33.run"; |FINSI;

#0#57 = numerica1;  #0#58 = numerica2;  #0#59 = numerica3;
#0#60 = numerica4;  #0#61 = numerica5;  #0#62 = numerica6;
#0#63 = numerica7;  #0#64 = numerica8;  #0#65 = numerica9;
#0#66 = numerica10;

Campo = varcamp;
#0Campo = #0#65 - #0#66;
|PINTA #0Campo;
|FPRC;

|PROCESO campo373;
numerica1 = #0#68;  numerica2 = #0#69;  numerica3 = #0#70;
numerica4 = #0#71;  numerica5 = #0#72;  numerica6 = #0#73;

|SI tecla = 9; |SUB_EJECUTA "ispant34.run"; |FINSI;

#0#68 = numerica1;  #0#69 = numerica2;  #0#70 = numerica3;
#0#71 = numerica4;  #0#72 = numerica5;  #0#73 = numerica6;

Campo = varcamp;
#0Campo = #0#72 - #0#73;
|PINTA #0Campo;
|FPRC;

|PROCESO campo377;
numerica1 = #0#76;  numerica2 = #0#77;

|SI tecla = 9; |SUB_EJECUTA "ispant35.run"; |FINSI;

#0#76 = numerica1;  #0#77 = numerica2;

Campo = varcamp;
#0Campo = #0#76 + #0#77;
|PINTA #0Campo;
|FPRC;

|PROCESO campo419;
numerica1  = #0#81;  numerica2  = #0#82;  numerica3  = #0#83;
numerica4  = #0#84;  numerica5  = #0#85;  numerica6  = #0#86;
numerica7  = #0#87;  numerica8  = #0#88;  numerica9  = #0#89;
numerica10 = #0#90;  numerica11 = #0#91;  numerica12 = #0#92;
numerica13 = #0#93;  numerica14 = #0#94;  numerica15 = #0#95;
numerica16 = #0#96;

|SI tecla = 9; |SUB_EJECUTA "ispant40.run"; |FINSI;

#0#81 = numerica1;   #0#82 = numerica2;   #0#83 = numerica3;
#0#84 = numerica4;   #0#85 = numerica5;   #0#86 = numerica6;
#0#87 = numerica7;   #0#88 = numerica8;   #0#89 = numerica9;
#0#90 = numerica10;  #0#91 = numerica11;  #0#92 = numerica12;
#0#93 = numerica13;  #0#94 = numerica14;  #0#95 = numerica15;
#0#96 = numerica16;

Campo = varcamp;
#0Campo = #0#95 - #0#96;
|PINTA #0Campo;
|FPRC;

|PROCESO campo424;
numerica1 = #0#98;   numerica2 = #0#99;  numerica3 = #0#100;
numerica4 = #0#101;

|SI tecla = 9; |SUB_EJECUTA "ispant41.run"; |FINSI;

#0#98  = numerica1;  #0#99  = numerica2;  #0#100 = numerica3;
#0#101 = numerica4;

Campo = varcamp;
#0Campo = #0#98 + #0#99 + #0#100 + #0#101;
|PINTA #0Campo;
|FPRC;

|PROCESO campo432;
numerica1 = #0#104;  numerica2 = #0#105;  numerica3 = #0#106;
numerica4 = #0#107;  numerica5 = #0#108;  numerica6 = #0#109;

|SI tecla = 9; |SUB_EJECUTA "ispant36.run"; |FINSI;

#0#104 = numerica1;  #0#105 = numerica2;  #0#106 = numerica3;
#0#107 = numerica4;  #0#108 = numerica5;  #0#109 = numerica6;

Campo = varcamp;
#0Campo = #0#104 + #0#105 + #0#106 + #0#107 + #0#108 + #0#109;
|PINTA #0Campo;
|FPRC;

|PROCESO campo454;
numerica1  = #0#111;  numerica2  = #0#112;  numerica3  = #0#113;
numerica4  = #0#114;  numerica5  = #0#115;  numerica6  = #0#116;
numerica7  = #0#117;  numerica8  = #0#118;  numerica9  = #0#119;
numerica10 = #0#120;  numerica11 = #0#121;  numerica12 = #0#122;
numerica13 = #0#123;  numerica14 = #0#124;  numerica15 = #0#125;
numerica16 = #0#126;  numerica17 = #0#127;  numerica18 = #0#128;
numerica19 = #0#129;

|SI tecla = 9; |SUB_EJECUTA "ispant42.run"; |FINSI;

#0#111 = numerica1;  #0#112 = numerica2;  #0#113 = numerica3;
#0#114 = numerica4;  #0#115 = numerica5;  #0#116 = numerica6;
#0#117 = numerica7;  #0#118 = numerica8;  #0#119 = numerica9;
#0#120 = numerica10; #0#121 = numerica11; #0#122 = numerica12;
#0#123 = numerica13; #0#124 = numerica14; #0#125 = numerica15;
#0#126 = numerica16; #0#127 = numerica17; #0#128 = numerica18;
#0#129 = numerica19;

Campo = varcamp;
#0Campo = 0;
|PARA x = 111; |SI x [ 129; |HACIENDO x = x + 1;
    #0Campo = #0Campo + #0x;
|SIGUE;
|PINTA #0Campo;
|FPRC;

|PROCESO campo505;
numerica1 = #0#134;  numerica2 = #0#135;  numerica3 = #0#136;

|SI tecla = 9; |SUB_EJECUTA "ispant12.run"; |FINSI;

#0#134 = numerica1;  #0#135 = numerica2;  #0#136 = numerica3;

Campo = varcamp;
#0Campo = #0#134 + #0#135 + #0#136;
|PINTA #0Campo;
|FPRC;

|PROCESO campo512;
numerica1 = #0#138;  numerica2 = #0#139;  numerica3 = #0#140;
numerica4 = #0#141;  numerica5 = #0#142;

|SI tecla = 9; |SUB_EJECUTA "ispant13.run"; |FINSI;

#0#138 = numerica1;  #0#139 = numerica2;  #0#140 = numerica3;
#0#141 = numerica4;  #0#142 = numerica5;

Campo = varcamp;
#0Campo = #0#138 + #0#139 + #0#140 + #0#141 + #0#142;
|PINTA #0Campo;
|FPRC;

|PROCESO campo516;
numerica1 = #0#144;  numerica2 = #0#145;  numerica3 = #0#146;

|SI tecla = 9; |SUB_EJECUTA "ispant14.run"; |FINSI;

#0#144 = numerica1;  #0#145 = numerica2;  #0#146 = numerica3;

Campo = varcamp;
#0Campo = #0#144 + #0#145 + #0#146;
|PINTA #0Campo;
|FPRC;

|PROCESO campo520;
numerica1 = #0#148;  numerica2 = #0#149;  numerica3 = #0#150;

|SI tecla = 9; |SUB_EJECUTA "ispant15.run"; |FINSI;

#0#148 = numerica1;  #0#149 = numerica2;  #0#150 = numerica3;

Campo = varcamp;
#0Campo = #0#148 + #0#149 + #0#150;
|PINTA #0Campo;
|FPRC;

|PROCESO campo525;
numerica1 = #0#152;  numerica2 = #0#153;  numerica3 = #0#154;
numerica4 = #0#155;

|SI tecla = 9; |SUB_EJECUTA "ispant16.run"; |FINSI;

#0#152 = numerica1;  #0#153 = numerica2;  #0#154 = numerica3;
#0#155 = numerica4;

Campo = varcamp;
#0Campo = #0#152 + #0#153 + #0#154 + #0#155;
|PINTA #0Campo;
|FPRC;

|PROCESO campo530;
numerica1 = #0#157;  numerica2 = #0#158;  numerica3 = #0#159;
numerica4 = #0#160;

|SI tecla = 9; |SUB_EJECUTA "ispant43.run"; |FINSI;

#0#157 = numerica1;  #0#158 = numerica2;  #0#159 = numerica3;
#0#160 = numerica4;

Campo = varcamp;
#0Campo = #0#157 + #0#158 + #0#159 + #0#160;
|PINTA #0Campo;
|FPRC;

|PROCESO campo605;
numerica1 = #0#173;  numerica2 = #0#174;  numerica3 = #0#175;
numerica4 = #0#176;

|SI tecla = 9; |SUB_EJECUTA "ispant18.run"; |FINSI;

#0#173 = numerica1;  #0#174 = numerica2;  #0#175 = numerica3;
#0#176 = numerica4;

Campo = varcamp;
#0Campo = #0#173 + #0#174 + #0#175 + #0#176;
|PINTA #0Campo;
|FPRC;

|PROCESO campo611;
numerica1 = #0#180;  numerica2 = #0#181;  numerica3 = #0#182;

|SI tecla = 9; |SUB_EJECUTA "ispant19.run"; |FINSI;

#0#180 = numerica1;  #0#181 = numerica2;  #0#182 = numerica3;

Campo = varcamp;
#0Campo = #0#180 + #0#181 + #0#182;
|PINTA #0Campo;
|FPRC;

|PROCESO calculo;
#0#80 = #0#3  + #0#4  + #0#13 + #0#31 + #0#49 + #0#50 + #0#51 + #0#52 + #0#53;
#0#80 = #0#80 + #0#56 + #0#67 + #0#74 + #0#75 + #0#78 + #0#79;
|PINTA #0#80;

#0#132 = #0#97 + #0#102 + #0#103 + #0#110 + #0#130 + #0#131;
|PINTA #0#132;

#0#172 = #0#133 + #0#137 + #0#143 + #0#147 + #0#151 + #0#156;
#0#172 = #0#172 + #0#161 + #0#162 + #0#163 + #0#164 + #0#165 + #0#166;
#0#172 = #0#172 + #0#167 + #0#168 + #0#169 + #0#170;

#0#194 = #0#177 + #0#178 + #0#179 + #0#183 + #0#184 + #0#185;
#0#194 = #0#194 + #0#186 + #0#187 + #0#188 + #0#189 + #0#190;
#0#194 = #0#194 + #0#191 + #0#192;

benper = #0#194 - #0#172;
|SI benper > 0;
    #0#171 = benper;
    #0#172 = #0#172 + #0#171;
    #0#193 = 0;
|SINO;
    #0#193 = -benper;
    #0#194 = #0#194 + #0#193;
    #0#171 = 0;
|FINSI;
|PINTA #0#171;
|PINTA #0#172;
|PINTA #0#193;
|PINTA #0#194;
|FPRC;

|PROCESO liquidacio;
|SUB_EJECUTA "isz00005.run";

|SI anyo [ 1994; |HAZ ajuste_1994; |FINSI;
|SI anyo ] 1995; |HAZ ajuste_1995; |FINSI;
|FPRC;

|PROCESO ajuste_1994;
|ABRE #2;
#2#0 = #0#0;
#2#1 = #0#1;
|LIBERA #2;
|LEE 110#2=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #2; #2#0 = #0#0; #2#1 = #0#1; |FINSI;

#2#3 = #0#92;
#2#7 = #2#3 + #2#4 + #2#5 + #2#6;
|SI FEstado = 0; |GRABA 020#2a; |SINO; |GRABA 020#2n; |FINSI;
|CIERRA #2;
|FPRC;

|PROCESO ajuste_1995;
|ABRE #3;
#3#0 = #0#0;
#3#1 = #0#1;
|LIBERA #3;
|LEE 110#3=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #3; #3#0 = #0#0; #3#1 = #0#1; |FINSI;

#3#3 = #0#92;
#3#7 = #3#3 + #3#4 + #3#5 + #3#6;
|SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;
|CIERRA #3;
|FPRC;
