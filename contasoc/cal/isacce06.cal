|FICHEROS;
     isacce06 #0;
     maempr10 #1;
     reflejo@ #200;
     iswacc00 #900;
     isocie59 #59;
     isocie91 #91;
     isocie65 #65;
     maempr11 #11;

     :/basica/def/agitab99 #99;

     &clientes@ #715;
|FIN;

|VARIABLES;
   &empresa     = 0;
   &anyo        = 0;
   &nombre      = "";
   &nif         = "";
   &tipo        = "";
   &modo        = 0;
   &sw_mod      = 0;
   &SwAdic      = 0;
   &enError     = 0;
   &eParametro  = "FUERA06";
   &enCodCli    = 0;
   &enSwDeDonde = 0;
   &eaEntidad   = "";
   &eaOficina   = "";
   &eaDC        = "";
   &eaCuenta    = "";
   &enModelo    = 0;
   &enBanco     = 0;
   &enForzar    = 0;

   nError    = 0;
   nValor    = 0;

   Punto     = 0;
   Punto1    = 0;
   SwOpcion  = 0;
   SwOpcion1 = 0;
   aPathSociedad = "";
   aDef          = "";
   aAlfa         = "";
   aTecla        = "";
   aError        = "";

{-1} Menu   = "";
   Menu1    = "1315";
   Menu2    = "1";
   Menu3    = "5";
   Menu4    = "Deducciones                             ";
   Menu5    = "Liquidaci¢n                             ";
   Menu6    = "Canarias, Art.48.1/48.3 e Importe neto cifra de negocio";
   Menu7    = "Informaci¢n Adicional Balance           ";
   Menu8    = "Utilidades                              ";

{-1}MenuUtil  = "";
    MenuUtil1 = "1735";
    MenuUtil2 = "1";
    MenuUtil3 = "5";
    MenuUtil4 = "Pase deducciones a¤o anterior   ";
    MenuUtil5 = "Pase desde datos contabilidad   ";
    MenuUtil6 = "Pase B.Imponibles a¤o anterior  ";
    MenuUtil7 = "Pantalla de resultados          ";
    MenuUtil8 = "Borrado y Creaci¢n R.Deducciones";

{-1}MenuDedu   = "";
    MenuDedu1  = "1525";
    MenuDedu2  = "1";
    MenuDedu3  = "3";
    MenuDedu4  = "Por doble imposici¢n                ";
    MenuDedu5  = "Entrada de Deducciones              ";
    MenuDedu6  = "Resumen                             ";

{-1}MenuCan    = "";
    MenuCan1   = "1835";
    MenuCan2   = "1";
    MenuCan3   = "4";
    MenuCan4   = "Inversiones Canarias y Manisfestaciones ";
    MenuCan5   = "Opcion Articulo 48.1 y 48.3 R.I.S.";
    MenuCan6   = "Grupos de Sociedades, Art.42 Codigo de Comercio";
    MenuCan7   = "No Residentes con mas de un Establecimiento Permanente";

{-1}MenuAdic  = "";
    MenuAdic1 = "1835";
    MenuAdic2 = "1";
    MenuAdic3 = "4";
    MenuAdic4 = "Partidas del Activo ";
    MenuAdic5 = "Partidas del Pasivo ";
    MenuAdic6 = "Partidas del Debe   ";
    MenuAdic7 = "Partidas del Haber  ";
|FIN;

|PROCESO Chequeo200;
     |ABRE #59;
     #59#0 = #0#0;
     #59#1 = #0#1;
     |LEE 040#59=;
     |SI FSalida ! 0;  |DDEFECTO #59;  |FINSI;
     |CIERRA #59;

     nValor = #65#161 - #65#192;
     |SI nValor ! #59#2;
         nError = 2;
         aError = "Casilla (350 - 440) distinta a la Casilla 500";
     |FINSI;

     |SI #59#105 < 0;  |Y nError = 0;
         |SI modo = 1;  |O modo = 2;
             |ABRE #1;
             #1#0 = #0#0;
             #1#1 = #0#1;
             |LEE 101#1=;
             |SI FSalida = 0;
                 |SI #1#34 = "S";
                     |CONFI "0000SLiquidacion Negativa. Renuncia a la Devolucion ";
                 |SINO;
                     |CONFI "0000NLiquidacion Negativa. Renuncia a la Devolucion ";
                 |FINSI;
                 |SI FSalida ! 0;  #1#34 = "N";  |FINSI;
                 |SI FSalida = 0;  #1#34 = "S";  |FINSI;
                 |GRABA 020#1a;
                 |LIBERA #1;

                 |SI #1#34 = "N";
                     enCodCli = #1#0;
                     |HAZ LeePersona;

                     |SI enSwDeDonde = 1;
                         enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;

                         aAlfa   = eaEntidad;          |QBF aAlfa;
                         aAlfa   = aAlfa + eaOficina;  |QBF aAlfa;
                         aAlfa   = aAlfa + eaDC;       |QBF aAlfa;
                         aAlfa   = aAlfa + eaCuenta;   |QBF aAlfa;

                         |SI aAlfa = ""
                             |MENAV "0000 En el Mantenimiento de Clientes, no esta informada la Cuenta Bancaria.";
                         |FINSI;
                     |SINO;
                         aAlfa    = #715#81 + #715#82 + #715#83 + #715#84;  |QBF aAlfa;

                         |SI aAlfa = ""
                             |MENAV "0000 En el Cliente del Modulo Integrador, no esta informada la Cuenta Bancaria.";
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
             |CIERRA #1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Chequeo225;
     |ABRE #91;
     #91#0 = #0#0;
     #91#1 = #0#1;
     |LEE 040#91=;
     |SI FSalida ! 0;  |DDEFECTO #91;  |FINSI;
     |CIERRA #91;

     |SI #91#123 < 0;  |Y nError = 0;
         |SI modo = 1;  |O modo = 2;
             |ABRE #1;
             #1#0 = #0#0;
             #1#1 = #0#1;
             |LEE 101#1=;
             |SI FSalida = 0;
                 |SI #1#34 = "S";
                     |CONFI "0000SLiquidacion Negativa. Renuncia a la Devolucion ";
                 |SINO;
                     |CONFI "0000NLiquidacion Negativa. Renuncia a la Devolucion ";
                 |FINSI;
                 |SI FSalida ! 0;  #1#34 = "N";  |FINSI;
                 |SI FSalida = 0;  #1#34 = "S";  |FINSI;
                 |GRABA 020#1a;
                 |LIBERA #1;

                 |SI #1#34 = "N";
                     enCodCli = #1#0;
                     |HAZ LeePersona;

                     |SI enSwDeDonde = 1;
                         enModelo = 200;  enForzar = 1;  |HAZ CogeDatosBancos;

                         aAlfa   = eaEntidad;          |QBF aAlfa;
                         aAlfa   = aAlfa + eaOficina;  |QBF aAlfa;
                         aAlfa   = aAlfa + eaDC;       |QBF aAlfa;
                         aAlfa   = aAlfa + eaCuenta;   |QBF aAlfa;

                         |SI aAlfa = ""
                             |MENAV "0000 En el Mantenimiento de Clientes, no esta informada la Cuenta Bancaria.";
                         |FINSI;
                     |SINO;
                         aAlfa    = #715#81 + #715#82 + #715#83 + #715#84;  |QBF aAlfa;

                         |SI aAlfa = ""
                             |MENAV "0000 En el Cliente del Modulo Integrador, no esta informada la Cuenta Bancaria.";
                         |FINSI;
                     |FINSI;
                 |FINSI;
             |FINSI;
             |CIERRA #1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Chequeo;
     nError = 0;
     aError = "";

     |ABRE #65;
     #65#0 = #0#0;
     #65#1 = #0#1;
     |LEE 040#65=;
     |SI FSalida ! 0;  |DDEFECTO #65;  |FINSI;
     |CIERRA #65;

     |SI #65#65 ! #65#128;
         nError = 2;
         aError = "Casilla 190 distinta a la Casilla 273";
     |FINSI;

     |SI #65#162 ! #65#193;
         nError = 2;
         aError = "Casilla 351 distinta a la Casilla 441";
     |FINSI;

     |SI #0#5 ! "225";  |HAZ Chequeo200;  |FINSI;
     |SI #0#5 = "225";  |HAZ Chequeo225;  |FINSI;

     |SI #0#5 = "200";  |ACABA;  |FINSI;
     |SI #0#5 = "225";  |ACABA;  |FINSI;

     |SI #59#31  ! 0;  nError = 1;  aError = "Casilla 529 con importe";  |FINSI;
     |SI #59#32  ! 0;  nError = 1;  aError = "Casilla 530 con importe";  |FINSI;
     |SI #59#132 ! 0;  nError = 1;  aError = "Casilla 537 con importe";  |FINSI;
     |SI #59#133 ! 0;  nError = 1;  aError = "Casilla 538 con importe";  |FINSI;
     |SI #59#136 ! 0;  nError = 1;  aError = "Casilla 593 con importe";  |FINSI;
     |SI #59#137 ! 0;  nError = 1;  aError = "Casilla 594 con importe";  |FINSI;
     |SI #59#65  ! 0;  nError = 1;  aError = "Casilla 578 con importe";  |FINSI;
     |SI #59#66  ! 0;  nError = 1;  aError = "Casilla 579 con importe";  |FINSI;
     |SI #59#140 ! 0;  nError = 1;  aError = "Casilla 541 con importe";  |FINSI;
     |SI #59#141 ! 0;  nError = 1;  aError = "Casilla 542 con importe";  |FINSI;
     |SI #59#142 ! 0;  nError = 1;  aError = "Casilla 517 con importe";  |FINSI;
     |SI #59#143 ! 0;  nError = 1;  aError = "Casilla 557 con importe";  |FINSI;

     |ABRE #11;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 07; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 07";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 08; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 08";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 09; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 09";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 10; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 10";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 22; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 22";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 23; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 23";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 24; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 24";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 25; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 25";
         nError = 1;
     |FINSI;

     #11#0 = #0#0; #11#1 = #0#1; #11#2 = 47; |LEE 040#11=;
     |SI FSalida = 0;
         aError = "Marcado caracter 47";
         nError = 1;
     |FINSI;
     |CIERRA #11;

     |SI nError = 1;  |ACABA;  |FINSI;

|FPRC;

|PROCESO Empresa; |TIPO 0;
  |ABRE #1;
  #1#0 = #0#0;
  #1#1 = #0#1;
  |LEE 040#1=;
  |SI FSalida = 0;
      #0#2 = #1#2;
      #0#3 = #1#3;
      #0#4 = #1#18;
      |SI #0#4 = "A";  #0#5 = "201";  |FINSI;
      |SI #0#4 = "N";  #0#5 = "200";  |FINSI;
      |SI #0#4 = "P";
          #0#5 = "225";
          |ABRE #99;
          #99#0 = 225;
          |LEE 101#99=;
          |SI FSalida ! 0;
              |DDEFECTO #99;
              #99#0 = 225;
              #99#1 = "MODELO 225 - SOCIEDADES";
              #99#2 = "DECLARACION DEL IMPUESTO DE SOCIEDADES. SOCIEDADES PATRIMONIALES";
              #99#3 = "";
              #99#4 = "N";
              #99#5 = "A";
              #99#6 = "M";
              #99#7 = "N";
              #99#8 = "N";
              |GRABA 020#99n;
          |FINSI;
          |LIBERA #99;
          |CIERRA #99;
      |FINSI;
  |FINSI;
  |CIERRA #1;

  |PINTA #0#2;
  |PINTA #0#3;
  |PINTA #0#4;
  |PINTA #0#5;
|FPRC;

|PROCESO EntraAcceso;
  |PUSHV 0501 2380;
  #900#0 = #0#0;
  #900#1 = #0#1;
  #900#2 = #0#2;
  #900#3 = #0#3;
  |PINPA #0#900;
  |PINDA #0#900;

  |SI modo = 1; |O modo = 2;
      |HAZ Pantalla;
  |FINSI;
  sw_mod = 0;

  |POPV;

  |HAZ Chequeo;
  |SI nError = 1;
      aAlfa = "0000 Configurar Modelo 200. " + aError;
      |MENAV aAlfa;
  |FINSI;
  |SI nError = 2;
      aAlfa = "0000 " + aError;
      |MENAV aAlfa;
  |FINSI;
|FPRC;

|PROCESO Acceso;  |TIPO 3;
  |SI #0#1 < 1996; |ACABA; |FINSI;

  |SI #0#6 = "S";
      |CONFI "0000NRegistro ya impreso, LO DEJAMOS NO IMPRESO ";
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      #0#6 = "N";
  |FINSI;

  modo = (FEntrada / 100) ! 0;
  |HAZ EntraAcceso;
|FPRC;

|PROCESO Pantalla;
  Punto    = 1;
  SwOpcion = 0;
  empresa  = #0#0;
  anyo     = #0#1;
  nombre   = #0#2;
  nif      = #0#3;
  tipo     = #0#4;

  |PARA; |SI SwOpcion = 0; |HACIENDO;
         Menu2  = Punto;
         |MENUG Menu;
         Punto = FSalida;
         |SI Punto ] 1; |Y Punto [ 5;
             |SI Punto = 1;  |HAZ Deduccion;              |FINSI;
             |SI Punto = 2;
                 |SI #0#4 ! "P";  |SUB_EJECUTA_NP "isocie59";  |FINSI;
                 |SI #0#4 = "P";  |SUB_EJECUTA_NP "isocie90";  |FINSI;
             |FINSI;
             |SI Punto = 3;  |HAZ MenuCan;                |FINSI;
             |SI Punto = 4;  |HAZ Adicional;              |FINSI;
             |SI Punto = 5;  |HAZ Utilidad;               |FINSI;
         |SINO;
             SwOpcion = 1;
         |FINSI;
  |SIGUE;
  |PINPA #0#900;
  |PINDA #0#900;
|FPRC;

|PROCESO Utilidad;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuUtil2 = Punto1;
         |MENUG MenuUtil;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 5;
             |SI Punto1 = 1;  |Y modo ! 4;  |SUB_EJECUTA_NP "isz00004";  |FINSI;
             |SI Punto1 = 2;  |Y modo ! 4;  |SUB_EJECUTA_NP "isz00001";  |FINSI;
             |SI Punto1 = 3;  |Y modo ! 4;  |SUB_EJECUTA_NP "z0000012";  |FINSI;
             |SI Punto1 = 4;  |SUB_EJECUTA_NP "isz00002";  |FINSI;
             |SI Punto1 = 5;  |SUB_EJECUTA_NP "isz00006";  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Deduccion;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuDedu2 = Punto1;
         |MENUG MenuDedu;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 3;
             |SI Punto1 = 1;  |SUB_EJECUTA_NP "isocie75";  |FINSI;
             |SI Punto1 = 2;  |SUB_EJECUTA_NP "isocie70";  |FINSI;
             |SI Punto1 = 3;
                 /*
                 |MENAV "0000 No disponible en esta version";
                 |POPV;
                 |ACABA;
                 */
                 |SUB_EJECUTA_NP "isocie84";
             |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO MenuCan;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuCan2 = Punto1;
         |MENUG MenuCan;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 4;
             |SI Punto1 = 1;  |SUB_EJECUTA_NP "isocie72";  |FINSI;
             |SI Punto1 = 2;  |SUB_EJECUTA_NP "isocie78";  |FINSI;
             |SI Punto1 = 3;  |SUB_EJECUTA_NP "isocie79";  |FINSI;
             |SI Punto1 = 4;  |SUB_EJECUTA_NP "isocie80";  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Adicional;
  |PUSHV 0501 2380;
  Punto1    = 1;
  SwOpcion1 = 0;

  |PARA; |SI SwOpcion1 = 0; |HACIENDO;
         MenuAdic2 = Punto1;
         |MENUG MenuAdic;
         Punto1 = FSalida;
         |SI Punto1 ] 1; |Y Punto1 [ 4;
             |SI Punto1 = 1;  SwAdic = 1;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 2;  SwAdic = 2;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 3;  SwAdic = 3;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
             |SI Punto1 = 4;  SwAdic = 4;  |SUB_EJECUTA_NP "isocie67";  |FINSI;
         |SINO;
             SwOpcion1 = 1;
         |FINSI;
  |SIGUE;
  |POPV;
|FPRC;

|PROCESO Borrado; |TIPO 2;
  empresa = #0#0;
  anyo    = #0#1;
  modo    = (FEntrada / 100) ! 0;
  |SI modo  ! 3;  |ACABA;  |FINSI;

  |PINTA 2430, "Borrando Registros ....";

  |SUB_EJECUTA "z0000001;IMPUESTO";

  |PINTA 2430, "                       ";
|FPRC;

|RUTINA ClaveBaja0N;
     #200#1 = 2006;
     #200#2 = "";
|FRUT;

|RUTINA ClaveAlta0N;
     #200#1 = 2006;
     #200#2 = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";
|FRUT;

|RUTINA ClaveBaja0D;
     #200#1 = 2006;
     #200#3 = "";
|FRUT;

|RUTINA ClaveAlta0D;
     #200#1 = 2006;
     #200#3 = "zzzzzzzzzzzz";
|FRUT;

|PROCESO Tipo11;  |TIPO 11;
     |SI FSalida = 10;
         |DBASE aPathSociedad;  |QBT aPathSociedad;
         aDef = aPathSociedad + "def/isacce06.mas";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def isacce06.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |PUSHV 0501 2380;
         |ATRI P;
         |PINTA 0542, "MODO CONSULTA";
         |PINTA 0556, "ORDENADO POR NOMBRE      ";
         |MENSA "      Elija un Impuesto y pulse Esc";
         |ATRI p;
         |C_M #200#2, 1, "S";
         |C_M #200#1, 1, "N";
         |ENTLINEAL #2#200, -2, 4, 20, 0, ClaveBaja0N, ClaveAlta0N;
         |C_M #200#2, 1, "N";
         |C_M #200#1, 1, "S";
         |POPV;

         #0#0 = #200#0;
         #0#1 = #200#1;
         |PONCONTROL 23, "SI";
         |PTEC 809;

         |DESCARGA_DEF #reflejo@;

         |ERROR;
     |FINSI;

     |SI FSalida = 11;
         |DBASE aPathSociedad;  |QBT aPathSociedad;
         aDef = aPathSociedad + "def/isacce00.mas";
         |CARGA_DEF aDef, reflejo@;
         |SI FSalida ! 0;
             aAlfa = "     Error en cargar el Def isacce00.mas";
             |MENAV aAlfa;
             |ERROR;
         |FINSI;

         |PUSHV 0501 2380;
         |ATRI P;
         |PINTA 0542, "MODO CONSULTA";
         |PINTA 0556, "ORDENADO POR CIF         ";
         |MENSA "      Elija un Impuesto y pulse Esc";
         |ATRI p;
         |C_M #200#3, 1, "S";
         |C_M #200#1, 1, "N";
         |ENTLINEAL #3#200, -2, 4, 20, 0, ClaveBaja0D, ClaveAlta0D;
         |C_M #200#3, 1, "N";
         |C_M #200#1, 1, "S";
         |POPV;

         #0#0 = #200#0;
         #0#1 = #200#1;
         |PONCONTROL 23, "SI";
         |PTEC 809;

         |DESCARGA_DEF #reflejo@;

         |ERROR;
     |FINSI;

     |SI FSalida = 12;
        modo = 4;

        |PUSHV 0501 2380;
        #900#0 = #0#0;
        #900#1 = #0#1;
        #900#2 = #0#2;
        #900#3 = #0#3;
        |PINPA #0#900;
        |PINDA #0#900;

        |HAZ Pantalla;

        |POPV;
        |ERROR;
     |FINSI;

     |SI FSalida = 13;
         empresa  = #0#0;
         anyo     = #0#1;
         |SI #0#5 = "201";
             modo = 4;
             |HAZ Chequeo;

             |SI nError = 1;
                 aAlfa = "0000 Configurar Modelo 200. " + aError;
                 |MENAV aAlfa;
             |FINSI;

             |SI nError = 2;
                 aAlfa = "0000 " + aError;
                 |MENAV aAlfa;
             |FINSI;

             |SI nError = 0;
                 |SUB_EJECUTA_NP "isy06201";
             |FINSI;
         |FINSI;

         |SI #0#5 = "200";
             |HAZ Chequeo;

             |SI nError = 2;
                 aAlfa = "0000 " + aError;
                 |MENAV aAlfa;
             |FINSI;

             |SI nError = 0;
                 |SUB_EJECUTA_NP "isy06200";
             |FINSI;
         |FINSI;

         |SI #0#5 = "225";
             |HAZ Chequeo;

             |SI nError = 2;
                 aAlfa = "0000 " + aError;
                 |MENAV aAlfa;
             |FINSI;

             |SI nError = 0;
                 |SUB_EJECUTA_NP "isy06225";
             |FINSI;
         |FINSI;

         |PONCONTROL 23, "SI";
         |ERROR;
     |FINSI;

     |SI FSalida = 14;
         |SI #0#6 ! "S";  |ERROR;  |ACABA;  |FINSI;

         |PUSHV 0501 2380;
         |BLANCO 0614 1355;
         |CUADRO 0614 1355;
         |ATRI I;
         |PINTA 0715, "LA ENTRADA EN ESTE PROCESO ES SOLO PARA ";
         |PINTA 0815, "PODER CONSULTAR LAS CASILLA INTERIORES  ";
         |PINTA 0915, "DE LA LIQUIDACION, CUALQUIER CAMBIO     ";
         |PINTA 1015, "REALIZADO DURANTE LA CONSULTA CAMBIARA  ";
         |PINTA 1115, "AUTOMATICANTE EL RESULTADO DEL MODELO Y ";
         |PINTA 1215, "SE TENDRA DE EMITIR DE NUEVO.           ";
         |ATRI i;
         |LEETECLA aTecla;
         |POPV;

         |CONFI "0000NDesea Continuar.";
         |SI FSalida ! 0;  |ERROR;  |ACABA;  |FINSI;

         modo = 2;
         |HAZ EntraAcceso;

         |ERROR;
     |FINSI;

     |SI FSalida = 15;
         anyo     = #0#1;
         |SUB_EJECUTA_NP "isy00001";

         |ERROR;
     |FINSI;

     |SI FSalida = 16;
         empresa  = #0#0;
         anyo     = #0#1;
         |SUB_EJECUTA_NP "isy00002";

         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Result200;
    |ABRE #59;
    |DDEFECTO #59;
    #59#0 = #0#0;
    #59#1 = #0#1;
    |LEE 040#59=;
    |SI FSalida ! 0;
        |PINTA 0558, "                       ";
    |SINO;
        |ATRI P; |PINTA 0558, "Resultado: "; |ATRI 0;
        |ATRI R; |PINTA 0569, #59#105;       |ATRI 0;
    |FINSI;
   |CIERRA #59;
|FPRC;

|PROCESO Result225;
    |ABRE #91;
    |DDEFECTO #91;
    #91#0 = #0#0;
    #91#1 = #0#1;
    |LEE 040#91=;
    |SI FSalida ! 0;
        |PINTA 0558, "                       ";
    |SINO;
        |ATRI P; |PINTA 0558, "Resultado: "; |ATRI 0;
        |ATRI R; |PINTA 0569, #91#123;       |ATRI 0;
    |FINSI;
    |CIERRA #91;
|FPRC;

|CALCULO  VerResultado; |TIPO 7;
   |SI #0#0 = 0;
       |PINTA 0558, "                       ";
   |SINO;
       |SI #0#5 ! "225";  |HAZ Result200;  |FINSI;
       |SI #0#5 = "225";  |HAZ Result225;  |FINSI;
   |FINSI;
|FCAL;

|RUTINA ClaveBaja0;
     #0#0 = 1;
     #0#1 = 2006;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99999;
     #0#1 = 2006;
|FRUT;

|PROGRAMA;
     eParametro = "FUERA06";

     |HAZ Convertir06;
     |SI enError ! 0;
         |MENAV "     No se han instalado bien los ficheros patrones.";
         |ACABA;
     |FINSI;

     |CLS;
     |CABEZA "Impuesto Sociedades 2006";
     |ENTLINEAL #1#0, -1, 2, 20, 1, ClaveBaja0, ClaveAlta0;
|FPRO;
