|FICHEROS;
     cubala12 #0;

     cuacceso #100;

     cubala02 #1;
     cubala03 #2;
     cubala04 #3;
     cubala05 #4;

     cubala22 #22;
     cubala23 #23;
     cubala24 #24;
     cubala25 #25;

     imagen@  #99;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &acabalo = 0;
     x        = 0;
     y        = 0;
     aBase    = "";
     aTipo1   = "";
     aTipo2   = "";
|FIN;

|PROCESO Normal;
     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala02.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #1;               || Pasa el Activo;
     |ABRE #99;              || Pasa el Activo;
     #1#0 = empresa;
     #1#1 = anyo;
     |LEE 101#1=;
     |SI FSalida ! 0;
         #1#0 = empresa;
         #1#1 = anyo;
         |GRABA 020#1b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 69; |HACIENDO x = x + 1;
               y = x + 64;
               #1x = #99y;
         |SIGUE;
         #1#134 = #1#135;
         |GRABA 020#1a;
         |LIBERA #1;
     |FINSI;
     |CIERRA #1;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala03.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #2;               || Pasa el Pasivo;
     |ABRE #99;              || Pasa el Pasivo;
     #2#0 = empresa;
     #2#1 = anyo;
     |LEE 101#2=;
     |SI FSalida ! 0;
         #2#0 = empresa;
         #2#1 = anyo;
         |GRABA 020#2b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 78; |HACIENDO x = x + 1;
              y = x + 73;
              #2x = #99y;
         |SIGUE;
         #2#157 = #2#156;
         #2#153 = #2#152;
         #2#155 = #2#154;

         |GRABA 020#2a;
         |LIBERA #2;
     |FINSI;
     |CIERRA #2;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala04.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #3;               || Pasa el Debe;
     |ABRE #99;              || Pasa el Debe;
     #3#0 = empresa;
     #3#1 = anyo;
     |LEE 101#3=;
     |SI FSalida ! 0;
         #3#0 = empresa;
         #3#1 = anyo;
         |GRABA 020#3b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 44; |HACIENDO x = x + 1;
               y = x + 39;
               #3x = #99y;
         |SIGUE;

         |GRABA 020#3a;
         |LIBERA #3;
     |FINSI;
     |CIERRA #3;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala05.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #4;               || Pasa el Haber;
     |ABRE #99;              || Pasa el Haber;
     #4#0 = empresa;
     #4#1 = anyo;
     |LEE 101#4=;
     |SI FSalida ! 0;
         #4#0 = empresa;
         #4#1 = anyo;
         |GRABA 020#4b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 43; |HACIENDO x = x + 1;
               y = x + 38;
               #4x = #99y;
         |SIGUE;
         |GRABA 020#4a;
         |LIBERA #4;
     |FINSI;
     |CIERRA #4;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;
|FPRC;

|PROCESO Cooperativa;
     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala22.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #22;              || Pasa el Activo;
     |ABRE #99;              || Pasa el Activo;
     #22#0 = empresa;
     #22#1 = anyo;
     |LEE 101#22=;
     |SI FSalida ! 0;
         #22#0 = empresa;
         #22#1 = anyo;
         |GRABA 020#22b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 71; |HACIENDO x = x + 1;
               y    = x + 66;
               #22x = #99y;
         |SIGUE;
         |GRABA 020#22a;
         |LIBERA #22;
     |FINSI;
     |CIERRA #22;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala23.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #23;              || Pasa el Pasivo;
     |ABRE #99;              || Pasa el Pasivo;
     #23#0 = empresa;
     #23#1 = anyo;
     |LEE 101#23=;
     |SI FSalida ! 0;
         #23#0 = empresa;
         #23#1 = anyo;
         |GRABA 020#23b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 78; |HACIENDO x = x + 1;
              y    = x + 73;
              #23x = #99y;
         |SIGUE;

         |GRABA 020#23a;
         |LIBERA #23;
     |FINSI;
     |CIERRA #23;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala24.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #24;              || Pasa el Debe;
     |ABRE #99;              || Pasa el Debe;
     #24#0 = empresa;
     #24#1 = anyo;
     |LEE 101#24=;
     |SI FSalida ! 0;
         #24#0 = empresa;
         #24#1 = anyo;
         |GRABA 020#24b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 50; |HACIENDO x = x + 1;
               y    = x + 45;
               #24x = #99y;
         |SIGUE;

         |GRABA 020#24a;
         |LIBERA #24;
     |FINSI;
     |CIERRA #24;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;

     |DBASE aBase;   |QBF aBase;
     aBase = aBase + "def/cubala25.mas";
     |CARGA_DEF aBase, imagen@;
     |SI FSalida ! 0;
         |MENAV "    No puedo cargar el Def.";
         |ACABA;
     |FINSI;

     |ABRE #25;              || Pasa el Haber;
     |ABRE #99;              || Pasa el Haber;
     #25#0 = empresa;
     #25#1 = anyo;
     |LEE 101#25=;
     |SI FSalida ! 0;
         #25#0 = empresa;
         #25#1 = anyo;
         |GRABA 020#25b;
     |FINSI;

     #99#0 = empresa;
     #99#1 = anyo - 1;
     |LEE 040#99=;
     |SI FSalida = 0;
         |PARA x = 6; |SI x [ 47; |HACIENDO x = x + 1;
               y    = x + 42;
               #25x = #99y;
         |SIGUE;
         |GRABA 040#25a;
         |LIBERA #25;
     |FINSI;
     |CIERRA #25;
     |CIERRA #99;

     |DESCARGA_DEF #imagen@;
|FPRC;

|PROCESO pase;
     |ABRE #100;
     #100#0 = empresa;
     #100#1 = anyo - 1;
     |LEE 000#100=;
     |SI FSalida ! 0;  |CIERRA #100;  |ACABA;  |FINSI;

     aTipo1 = #100#13;

     #100#0 = empresa;
     #100#1 = anyo;
     |LEE 000#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;
     |CIERRA #100;

     aTipo2 = #100#13;

     |SI aTipo1 ! aTipo2;  |ACABA;  |FINSI;

     |SI #100#13 = "N";  |HAZ Normal;       |FINSI;
     |SI #100#13 = "S";  |HAZ Cooperativa;  |FINSI;

|FPRC;

|PROGRAMA;
     |PINPA #0#0;
     |SI acabalo = 0;
         |ENDATOS #1#0;
         |SI FSalida = 0;
             |SI #0#0 = "SI"; |HAZ pase; |FINSI;
         |FINSI;
     |SINO;
         |HAZ pase;
     |FINSI;
|FPRO;
