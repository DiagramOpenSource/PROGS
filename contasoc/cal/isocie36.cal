|FICHEROS;
    isocie36 #0;
|FIN;

|VARIABLES;
    &empresa   = 0;
    &anyo      = 0;
    &modo      = 0;

    &numerica1  = 0; &numerica2  = 0; &numerica3  = 0;
    &numerica4  = 0; &numerica5  = 0; &numerica6  = 0;
    &numerica7  = 0; &numerica8  = 0; &numerica9  = 0;
    &numerica10 = 0; &numerica11 = 0; &numerica12 = 0;
    &numerica13 = 0; &numerica14 = 0; &numerica15 = 0;
    &numerica16 = 0; &numerica17 = 0; &numerica18 = 0;
    &numerica19 = 0;

    &alfanume1  = "";

    FEstado = 0;
    varcamp = 0;
|FIN;

|PROGRAMA;
|ABRE #0;
|PINPA #0#0;
|SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
|SI modo = 4; |HAZ consulta; |FINSI;
|CIERRA #0;
|FPRO;

|PROCESO pidedato;
#0#0 = empresa;
#0#1 = anyo;
|LEE 110#0=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #0; #0#0 = empresa; #0#1 = anyo; |FINSI;
|PINDA #0#0;
|SI modo = 1; |ENDATOS #1#0;  |FINSI;
|SI modo = 2; |ENDATOS #2#0;  |FINSI;
|SI FSalida = 0;
    #0#0 = empresa;
    #0#1 = anyo;
    |SI FEstado = 0; |GRABA 020#0a; |SINO; |GRABA 020#0n; |FINSI;
    |LIBERA #0;
|FINSI;
|FPRC;

|PROCESO consulta;
  #0#0 = empresa;
  #0#1 = anyo;
  |LEE 040#0=;
  |SI FSalida = 0;
     |PINPA #0#0;
     |PINDA #0#0;
     |PAUSA;
  |FINSI;
|FPRC;

|PROCESO pantallas; |TIPO 0;
|SI FSalida = 0;
    varcamp = Campo;
    |SI Campo = 5;  |HAZ campo5;  |FINSI;
    |SI Campo = 8;  |HAZ campo8;  |FINSI;
    |SI Campo = 17; |HAZ campo17; |FINSI;
    |SI Campo = 19; |HAZ campo19; |FINSI;
    |SI Campo = 26; |HAZ campo26; |FINSI;
    |SI Campo = 30; |HAZ campo30; |FINSI;
    |SI Campo = 40; |HAZ campo40; |FINSI;
    |SI Campo = 43; |HAZ campo43; |FINSI;
    |SI Campo = 44; |HAZ campo44; |FINSI;
    |SI Campo = 59; |HAZ campo59; |FINSI;
    |SI Campo = 60; |HAZ campo59; |FINSI;
    Campo = varcamp;
    |HAZ calculo;
|FINSI;
|FPRC;

|PROCESO campo5;
numerica1 = #0#3;
numerica2 = #0#4;
numerica3 = #0#2;
numerica4 = #0#5;
|SUB_EJECUTA "ispant21.run";
#0#3 = numerica1;
#0#4 = numerica2;
#0#5 = numerica4;
|PINTA #0#5;
|FPRC;

|PROCESO campo8;
numerica1 = #0#6;
numerica2 = #0#7;
numerica3 = #0#8;
|SUB_EJECUTA "ispant22.run";
#0#6 = numerica1;
#0#7 = numerica2;
#0#8 = numerica3;
|FPRC;

|PROCESO campo17;
numerica1 = #0#8;
numerica2 = #0#9;
numerica3 = #0#10;
numerica4 = #0#11;
numerica5 = #0#12;
numerica6 = #0#13;
numerica7 = #0#14;
numerica8 = #0#15;
alfanume1 = #0#16;
|SUB_EJECUTA "ispant23.run";
#0#8  = numerica1;
#0#9  = numerica2;
#0#10 = numerica3;
#0#11 = numerica4;
#0#12 = numerica5;
#0#13 = numerica6;
#0#14 = numerica7;
#0#15 = numerica8;
#0#16 = alfanume1;
|FPRC;

|PROCESO campo19;
numerica1 = #0#18;
numerica2 = #0#17;
numerica3 = #0#19;
|SUB_EJECUTA "ispant24.run";
#0#18 = numerica1;
#0#19 = numerica3;
|FPRC;

|PROCESO campo26;
numerica1 = #0#20;
numerica2 = #0#21;
numerica3 = #0#22;
numerica4 = #0#23;
numerica5 = #0#24;
numerica6 = #0#25;
numerica7 = #0#19;
numerica8 = #0#26;
|SUB_EJECUTA "ispant25.run";
#0#20 = numerica1;
#0#21 = numerica2;
#0#22 = numerica3;
#0#23 = numerica4;
#0#24 = numerica5;
#0#25 = numerica6;
#0#26 = numerica8;
|FPRC;

|PROCESO campo30;
numerica1 = #0#27;
numerica2 = #0#28;
numerica3 = #0#26;
numerica4 = #0#30;
|SUB_EJECUTA "ispant38.run";
#0#27 = numerica1;
#0#28 = numerica2;
#0#26 = numerica3;
#0#30 = numerica4;
|FPRC;

|PROCESO campo40;
numerica1  = #0#30;
numerica2  = #0#31;
numerica3  = #0#32;
numerica4  = #0#33;
numerica5  = #0#34;
numerica6  = #0#29;
numerica7  = #0#35;
numerica8  = #0#36;
numerica9  = #0#37;
numerica10 = #0#38;
numerica11 = #0#39;
numerica12 = #0#40;
|SUB_EJECUTA "ispant39.run";
#0#31 = numerica2;
#0#32 = numerica3;
#0#33 = numerica4;
#0#34 = numerica5;
#0#29 = numerica6;
#0#35 = numerica7;
#0#36 = numerica8;
#0#37 = numerica9;
#0#38 = numerica10;
#0#39 = numerica11;
#0#40 = numerica12;
|FPRC;

|PROCESO campo43;
numerica1 = #0#40;
numerica2 = #0#41;
numerica3 = #0#61;
numerica4 = #0#43;
alfanume1 = #0#42;
|SUB_EJECUTA "ispant28.run";
#0#40 = numerica1;
#0#41 = numerica2;
#0#61 = numerica3;
#0#43 = numerica4;
#0#42 = alfanume1;
|PINTA #0#61;
|FPRC;

|PROCESO campo44;
numerica1 = #0#40;
numerica2 = #0#41;
numerica3 = #0#62;
numerica4 = #0#63;
numerica5 = #0#64;
numerica6 = #0#65;
numerica7 = #0#44;
|SUB_EJECUTA "ispant29.run";
#0#40 = numerica1;
#0#41 = numerica2;
#0#62 = numerica3;
#0#63 = numerica4;
#0#64 = numerica5;
#0#65 = numerica6;
#0#44 = numerica7;
|PINTA #0#62;
|PINTA #0#63;
|PINTA #0#64;
|PINTA #0#65;
|FPRC;

|PROCESO campo59;
numerica1  = #0#43;
numerica2  = #0#44;
numerica3  = #0#45;
numerica4  = #0#46;
numerica5  = #0#47;
numerica6  = #0#48;
numerica7  = #0#49;
numerica8  = #0#50;
numerica9  = #0#51;
numerica10 = #0#52;
numerica11 = #0#53;
numerica12 = #0#54;
numerica13 = #0#55;
numerica14 = #0#56;
numerica15 = #0#57;
numerica16 = #0#58;
numerica17 = #0#59;
numerica18 = #0#60;
numerica19 = #0#66;
|SUB_EJECUTA "ispant30.run";
#0#43 = numerica1;
#0#44 = numerica2;
#0#45 = numerica3;
#0#46 = numerica4;
#0#47 = numerica5;
#0#48 = numerica6;
#0#49 = numerica7;
#0#50 = numerica8;
#0#51 = numerica9;
#0#52 = numerica10;
#0#53 = numerica11;
#0#54 = numerica12;
#0#55 = numerica13;
#0#56 = numerica14;
#0#57 = numerica15;
#0#58 = numerica16;
#0#59 = numerica17;
#0#60 = numerica18;
#0#66 = numerica19;
|FPRC;

|PROCESO calculo;
#0#6  = #0#2 + #0#5;
#0#8  = #0#6 - #0#7;   |PINTA #0#8;
#0#17 = #0#14 + #0#15; |PINTA #0#17;
#0#19 = #0#17 - #0#18; |PINTA #0#19;
#0#26 = #0#19 - #0#20 - #0#21 - #0#22 - #0#23 - #0#24 - #0#25;
|SI #0#26 < 0; #0#26 = 0; |FINSI;
|PINTA #0#26;

#0#30 = #0#26 - #0#27 - #0#28;
|SI #0#30 < 0; #0#30 = 0; |FINSI;
|PINTA #0#30;

#0#40 = #0#30 - #0#31 - #0#32 - #0#33 - #0#34 - #0#29 - #0#35 - #0#36;
#0#40 = #0#40 - #0#37 - #0#38 - #0#39;
|SI #0#40 < 0; #0#40 = 0; |FINSI;
|PINTA #0#40;

#0#43 = (#0#61 / 100) * (#0#40 - #0#41); |PINTA #0#43;
#0#44 = ((#0#62 + #0#63 + #0#64 + #0#65) / 100) * (#0#40 - #0#41); |PINTA #0#44;
#0#51 = #0#43 - #0#45 - #0#47 - #0#49;
#0#52 = #0#44 - #0#46 - #0#48 - #0#50;
#0#59 = #0#51 + #0#53 + #0#55 + #0#57; |PINTA #0#59;
#0#60 = #0#52 + #0#54 + #0#56 + #0#58; |PINTA #0#60;
|FPRC;
