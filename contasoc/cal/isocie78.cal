|FICHEROS;
     isocie78 #0;
     maempr11 #1;
|FIN;

|VARIABLES;
     nOpcion    = 0;

     &empresa   = 0;
     &anyo      = 0;
     &modo      = 0;
     &enCalcCif = 0;
     &eaVarDni  = "";
|FIN;

|PROCESO LetraNif;  |TIPO 6;
     |SI FSalida = 10;
         enCalcCif = 1;
         eaVarDni  =  #0Campo;
         |HAZ CalculoDNI;
         #0Campo = eaVarDni;
         |PINTA #0Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #0Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #0Campo = eaVarDni;  |PINTA #0Campo;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;
|FPRC;

|RUTINA inferior;
     #0#0 = empresa;
     #0#1 = anyo;
     #0#2 = 1;
|FRUT;

|RUTINA superior;
    #0#0 = empresa;
    #0#1 = anyo;
    #0#2 = 99;
|FRUT;

|PROGRAMA;
     nOpcion = 1;

     |ABRE #1;

     #1#0 = empresa;
     #1#1 = anyo;
     #1#2 = 35;
     |LEE 040#1=;
     |SI FSalida = 0;  nOpcion = 0;  |FINSI;

     #1#0 = empresa;
     #1#1 = anyo;
     #1#2 = 37;
     |LEE 040#1=;
     |SI FSalida = 0;  nOpcion = 0;  |FINSI;

     |CIERRA #1;

     |SI nOpcion = 1;
         |MENAV "     La Empresa no tiene activada el Caracter de la declaracion 35 o 37";
         |ACABA;
     |FINSI;

     |ENTLINEAL #1#0, -3, modo, 22, 1, inferior, superior;
|FPRO;
