|FICHEROS;
     isom9000;
     maempr01;

     :basica/agim0019;

     isow9001;

     &clientes@;
|FIN;

|INCLUYE 9001vari;

|PROCESO FormaPago2010;
     |SI enSwDeDonde = 1;
         enModelo = 202;  enForzar = 1;  |HAZ CogeDatosBancos;

         #isow9001#36 = enFormaPag;
         |SI enFormaPag = 6;  #isow9001#36 = "2";  |FINSI;
         |SI #isow9001#36 ! "1";  |Y #isow9001#36 ! "2";  |Y #isow9001#36 ! "3";
             #isow9001#36 = "0";
         |FINSI;

         |SI #isow9001#36 = "2";  |O #isow9001#36 = "3";
              #isow9001#37 = eaEntidad;
              #isow9001#38 = eaOficina;
              #isow9001#39 = eaDC;
              #isow9001#40 = eaCuenta;
         |FINSI;
     |SINO;
         #isow9001#36 = "1";
         |SI #clientes@#84 ! "                    ";
             #isow9001#36 = "2";
             #isow9001#37 = #clientes@#81;
             #isow9001#38 = #clientes@#82;
             #isow9001#39 = #clientes@#83;
             #isow9001#40 = #clientes@#84 % 110;
         |FINSI;
    |FINSI;

                         #isow9001#6 = "I";
    |SI enFormaPag = 3;  #isow9001#6 = "U";  |FINSI;
    |SI enFormaPag = 6;  #isow9001#6 = "G";  |FINSI;
|FPRC;

|PROCESO P90012010;
     |ABRE #agim0019;
     #agim0019#0 = #isom9000#0;
     #agim0019#1 = 99;
     |LEE 000#agim0019.];
     |SI FSalida = 0;
         |LEE 000#agim0019.a;
     |SINO;
         |LEE 000#agim0019.u;
     |FINSI;

     nFicha = 0;
     |SI FSalida ! 0;  |O #agim0019#0 ! #isom9000#0;
         |DDEFECTO #agim0019;
     |FINSI;
     |CIERRA #agim0019;

     |DDEFECTO #isow9001;

     |SI #agim0019#89 = "S";  #isow9001#12 = "X";  |FINSI;

     #isow9001#7  = #isom9000#4;
     #isow9001#8  = #isom9000#5;
     #isow9001#9  = #isom9000#1;
     #isow9001#10 = #isom9000#2;
     #isow9001#11 = (#isom9000#7 % 102) + (#isom9000#7 % 402) + (#isom9000#7 % 704);

     enCanti = #isom9000#10;  |HAZ Calcula17D;  #isow9001#13 = eaAlfa;
     enCanti = #isom9000#13;  |HAZ Calcula17D;  #isow9001#14 = eaAlfa;
     enCanti = #isom9000#14;  |HAZ Calcula17D;  #isow9001#15 = eaAlfa;
     enCanti = #isom9000#15;  |HAZ Calcula17D;  #isow9001#16 = eaAlfa;
     enCanti = #isom9000#16;  |HAZ Calcula17D;  #isow9001#17 = eaAlfa;
     enCanti = #isom9000#17;  |HAZ Calcula17D;  #isow9001#18 = eaAlfa;
     enCanti = #isom9000#18;  |HAZ Calcula17D;  #isow9001#19 = eaAlfa;
     enCanti = #isom9000#19 * 100;              #isow9001#20 = ("00000" + enCanti) % -105;
     enCanti = #isom9000#20;  |HAZ Calcula17D;  #isow9001#21 = eaAlfa;
     enCanti = #isom9000#21;  |HAZ Calcula17D;  #isow9001#22 = eaAlfa;
     enCanti = #isom9000#22;  |HAZ Calcula17D;  #isow9001#23 = eaAlfa;
     enCanti = #isom9000#23 * 100;              #isow9001#24 = ("00000" + enCanti) % -105;
     enCanti = #isom9000#24;  |HAZ Calcula17D;  #isow9001#25 = eaAlfa;
     enCanti = #isom9000#25;  |HAZ Calcula17D;  #isow9001#26 = eaAlfa;
     enCanti = #isom9000#26 * 100;              #isow9001#27 = ("00000" + enCanti) % -105;
     enCanti = #isom9000#27;  |HAZ Calcula17D;  #isow9001#28 = eaAlfa;
     enCanti = #isom9000#28;  |HAZ Calcula17D;  #isow9001#29 = eaAlfa;
     enCanti = #isom9000#29;  |HAZ Calcula17D;  #isow9001#30 = eaAlfa;
     enCanti = #isom9000#30;  |HAZ Calcula17D;  #isow9001#31 = eaAlfa;
                                           #isow9001#32 = "00000";
     |SI #isom9000#6 ! "A ";
         enCanti = #isom9000#31 * 100;              #isow9001#32 = ("00000" + enCanti) % -105;
     |FINSI;
     enCanti = #isom9000#32;  |HAZ Calcula17D;  #isow9001#33 = eaAlfa;
     enCanti = #isom9000#33;  |HAZ Calcula17D;  #isow9001#34 = eaAlfa;
     enCanti = #isom9000#34;  |HAZ Calcula17D;  #isow9001#35 = eaAlfa;

     enCodCli = #isom9000#0;
     |HAZ LeePersona;

     nTotal  = #isom9000#14 + #isom9000#34;
     #isow9001#6  = "N";
     #isow9001#36 = "0";
     |SI nTotal > 0;
         |HAZ FormaPago2010;
     |FINSI;

     #isow9001#41 = "0";
     |SI #isom9000#3 > 0;
         #isow9001#41 = "1";
         #isow9001#42 = #isom9000#35;
     |FINSI;

     |SI enSwDeDonde = 1;
         #isow9001#44 = #clientes@#53;
         #isow9001#45 = #clientes@#54;
         aAlfa   = #clientes@#55;  |QBF aAlfa;
         |SI aAlfa ! "";
             #isow9001#45 = #clientes@#55;
         |FINSI;
         #isow9001#47 = #clientes@#71;
     |SINO;
         |ABRE #maempr01;
         #maempr01#0 = #isom9000#0;
         #maempr01#1 = #isom9000#1;
         |LEE 000#maempr01.=;
         |SI FSalida ! 0;  |DDEFECTO #maempr01;  |FINSI;
         |CIERRA #maempr01;

         #isow9001#44 = #maempr01#77;
         #isow9001#45 = #maempr01#15;
    |FINSI;

    #isow9001#49 = #isom9000#38;

    |PARA nCampo = 1;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
          eaAlfa = #isow9001#nCampo#;  |HAZ GrabaSecuencial;
    |SIGUE;
|FPRC;
