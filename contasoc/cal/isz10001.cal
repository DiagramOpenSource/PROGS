|FICHEROS;
   isz00001 #0;
   soplanli #1;
   sodacoli #2;
   isocie01 #3;
   isocie22 #4;
   isocie02 #5;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &tipo    = 0;
     &enNoPanta = 0;

     FEstado  = 0;

     cantidad = 0;
     benper   = 0;

     cuentad  = "";
     cuentah  = "";
     vari     = "";
     aste     = "";
     long     = "";
     numero   = "";
     longi    = 0;
     x        = 0;
|FIN;

|PROCESO casillas_92;
|SI #1#3 = 301; #3#003 = #3#003 + cantidad; |FINSI;
|SI #1#3 = 302; #3#004 = #3#004 + cantidad; |FINSI;
|SI #1#3 = 303; #3#005 = #3#005 + cantidad; |FINSI;
|SI #1#3 = 304; #3#006 = #3#006 + cantidad; |FINSI;
|SI #1#3 = 305; #3#007 = #3#007 + cantidad; |FINSI;
|SI #1#3 = 306; #3#008 = #3#008 + cantidad; |FINSI;
|SI #1#3 = 307; #3#009 = #3#009 + cantidad; |FINSI;
|SI #1#3 = 308; #3#010 = #3#010 + cantidad; |FINSI;
|SI #1#3 = 312; #3#014 = #3#014 + cantidad; |FINSI;
|SI #1#3 = 313; #3#015 = #3#015 + cantidad; |FINSI;
|SI #1#3 = 314; #3#016 = #3#016 + cantidad; |FINSI;
|SI #1#3 = 315; #3#017 = #3#017 + cantidad; |FINSI;
|SI #1#3 = 316; #3#018 = #3#018 + cantidad; |FINSI;
|SI #1#3 = 317; #3#019 = #3#019 + cantidad; |FINSI;
|SI #1#3 = 318; #3#020 = #3#020 + cantidad; |FINSI;
|SI #1#3 = 319; #3#021 = #3#021 + cantidad; |FINSI;
|SI #1#3 = 320; #3#022 = #3#022 + cantidad; |FINSI;
|SI #1#3 = 321; #3#023 = #3#023 + cantidad; |FINSI;
|SI #1#3 = 322; #3#024 = #3#024 + cantidad; |FINSI;
|SI #1#3 = 323; #3#025 = #3#025 + cantidad; |FINSI;
|SI #1#3 = 324; #3#026 = #3#026 + cantidad; |FINSI;
|SI #1#3 = 325; #3#027 = #3#027 + cantidad; |FINSI;
|SI #1#3 = 326; #3#028 = #3#028 + cantidad; |FINSI;
|SI #1#3 = 330; #3#032 = #3#032 + cantidad; |FINSI;
|SI #1#3 = 331; #3#033 = #3#033 + cantidad; |FINSI;
|SI #1#3 = 332; #3#034 = #3#034 + cantidad; |FINSI;
|SI #1#3 = 333; #3#035 = #3#035 + cantidad; |FINSI;
|SI #1#3 = 334; #3#036 = #3#036 + cantidad; |FINSI;
|SI #1#3 = 335; #3#037 = #3#037 + cantidad; |FINSI;
|SI #1#3 = 336; #3#038 = #3#038 + cantidad; |FINSI;
|SI #1#3 = 337; #3#039 = #3#039 + cantidad; |FINSI;
|SI #1#3 = 338; #3#040 = #3#040 + cantidad; |FINSI;
|SI #1#3 = 339; #3#041 = #3#041 + cantidad; |FINSI;
|SI #1#3 = 340; #3#042 = #3#042 + cantidad; |FINSI;
|SI #1#3 = 341; #3#043 = #3#043 + cantidad; |FINSI;
|SI #1#3 = 342; #3#044 = #3#044 + cantidad; |FINSI;
|SI #1#3 = 343; #3#045 = #3#045 + cantidad; |FINSI;
|SI #1#3 = 344; #3#046 = #3#046 + cantidad; |FINSI;
|SI #1#3 = 348; #3#050 = #3#050 + cantidad; |FINSI;
|SI #1#3 = 349; #3#051 = #3#051 + cantidad; |FINSI;
|SI #1#3 = 350; #3#052 = #3#052 + cantidad; |FINSI;
|SI #1#3 = 351; #3#053 = #3#053 + cantidad; |FINSI;
|SI #1#3 = 352; #3#054 = #3#054 + cantidad; |FINSI;
|SI #1#3 = 353; #3#055 = #3#055 + cantidad; |FINSI;
|SI #1#3 = 355; #3#057 = #3#057 + cantidad; |FINSI;
|SI #1#3 = 356; #3#058 = #3#058 + cantidad; |FINSI;
|SI #1#3 = 357; #3#059 = #3#059 + cantidad; |FINSI;
|SI #1#3 = 359; #3#060 = #3#060 + cantidad; |FINSI;
|SI #1#3 = 360; #3#061 = #3#061 + cantidad; |FINSI;
|SI #1#3 = 361; #3#062 = #3#062 + cantidad; |FINSI;
|SI #1#3 = 362; #3#063 = #3#063 + cantidad; |FINSI;
|SI #1#3 = 364; #3#065 = #3#065 + cantidad; |FINSI;
|SI #1#3 = 366; #3#067 = #3#067 + cantidad; |FINSI;
|SI #1#3 = 367; #3#068 = #3#068 + cantidad; |FINSI;
|SI #1#3 = 368; #3#069 = #3#069 + cantidad; |FINSI;
|SI #1#3 = 369; #3#070 = #3#070 + cantidad; |FINSI;
|SI #1#3 = 373; #3#074 = #3#074 + cantidad; |FINSI;
|SI #1#3 = 374; #3#075 = #3#075 + cantidad; |FINSI;
|SI #1#3 = 375; #3#076 = #3#076 + cantidad; |FINSI;
|SI #1#3 = 377; #3#078 = #3#078 + cantidad; |FINSI;

|SI #1#3 = 401; #3#080 = #3#080 + cantidad; |FINSI;
|SI #1#3 = 402; #3#081 = #3#081 + cantidad; |FINSI;
|SI #1#3 = 403; #3#082 = #3#082 + cantidad; |FINSI;
|SI #1#3 = 404; #3#083 = #3#083 + cantidad; |FINSI;
|SI #1#3 = 405; #3#084 = #3#084 + cantidad; |FINSI;
|SI #1#3 = 406; #3#085 = #3#085 + cantidad; |FINSI;
|SI #1#3 = 408; #3#086 = #3#086 + cantidad; |FINSI;
|SI #1#3 = 409; #3#087 = #3#087 + cantidad; |FINSI;
|SI #1#3 = 410; #3#088 = #3#088 + cantidad; |FINSI;
|SI #1#3 = 411; #3#089 = #3#089 + cantidad; |FINSI;
|SI #1#3 = 412; #3#090 = #3#090 + cantidad; |FINSI;
|SI #1#3 = 416; #3#094 = #3#094 + cantidad; |FINSI;
|SI #1#3 = 417; #3#095 = #3#095 + cantidad; |FINSI;
|SI #1#3 = 418; #3#096 = #3#096 + cantidad; |FINSI;
|SI #1#3 = 420; #3#098 = #3#098 + cantidad; |FINSI;
|SI #1#3 = 421; #3#099 = #3#099 + cantidad; |FINSI;
|SI #1#3 = 422; #3#100 = #3#100 + cantidad; |FINSI;
|SI #1#3 = 423; #3#101 = #3#101 + cantidad; |FINSI;
|SI #1#3 = 424; #3#102 = #3#102 + cantidad; |FINSI;
|SI #1#3 = 425; #3#103 = #3#103 + cantidad; |FINSI;
|SI #1#3 = 426; #3#104 = #3#104 + cantidad; |FINSI;
|SI #1#3 = 428; #3#106 = #3#106 + cantidad; |FINSI;
|SI #1#3 = 429; #3#107 = #3#107 + cantidad; |FINSI;
|SI #1#3 = 430; #3#108 = #3#108 + cantidad; |FINSI;
|SI #1#3 = 431; #3#109 = #3#109 + cantidad; |FINSI;
|SI #1#3 = 432; #3#110 = #3#110 + cantidad; |FINSI;
|SI #1#3 = 433; #3#111 = #3#111 + cantidad; |FINSI;
|SI #1#3 = 434; #3#112 = #3#112 + cantidad; |FINSI;
|SI #1#3 = 435; #3#113 = #3#113 + cantidad; |FINSI;
|SI #1#3 = 436; #3#114 = #3#114 + cantidad; |FINSI;
|SI #1#3 = 438; #3#115 = #3#115 + cantidad; |FINSI;
|SI #1#3 = 439; #3#116 = #3#116 + cantidad; |FINSI;
|SI #1#3 = 440; #3#117 = #3#117 + cantidad; |FINSI;
|SI #1#3 = 441; #3#118 = #3#118 + cantidad; |FINSI;
|SI #1#3 = 442; #3#119 = #3#119 + cantidad; |FINSI;
|SI #1#3 = 445; #3#121 = #3#121 + cantidad; |FINSI;
|SI #1#3 = 446; #3#122 = #3#122 + cantidad; |FINSI;

|SI #1#3 = 502; #3#125 = #3#125 + cantidad; |FINSI;
|SI #1#3 = 503; #3#126 = #3#126 + cantidad; |FINSI;
|SI #1#3 = 504; #3#127 = #3#127 + cantidad; |FINSI;
|SI #1#3 = 506; #3#129 = #3#129 + cantidad; |FINSI;
|SI #1#3 = 507; #3#130 = #3#130 + cantidad; |FINSI;
|SI #1#3 = 508; #3#131 = #3#131 + cantidad; |FINSI;
|SI #1#3 = 509; #3#132 = #3#132 + cantidad; |FINSI;
|SI #1#3 = 510; #3#133 = #3#133 + cantidad; |FINSI;
|SI #1#3 = 512; #3#135 = #3#135 + cantidad; |FINSI;
|SI #1#3 = 513; #3#136 = #3#136 + cantidad; |FINSI;
|SI #1#3 = 514; #3#137 = #3#137 + cantidad; |FINSI;
|SI #1#3 = 516; #3#139 = #3#139 + cantidad; |FINSI;
|SI #1#3 = 517; #3#140 = #3#140 + cantidad; |FINSI;
|SI #1#3 = 518; #3#141 = #3#141 + cantidad; |FINSI;
|SI #1#3 = 520; #3#143 = #3#143 + cantidad; |FINSI;
|SI #1#3 = 521; #3#144 = #3#144 + cantidad; |FINSI;
|SI #1#3 = 522; #3#145 = #3#145 + cantidad; |FINSI;
|SI #1#3 = 523; #3#146 = #3#146 + cantidad; |FINSI;
|SI #1#3 = 525; #3#148 = #3#148 + cantidad; |FINSI;
|SI #1#3 = 528; #3#151 = #3#151 + cantidad; |FINSI;
|SI #1#3 = 529; #3#152 = #3#152 + cantidad; |FINSI;
|SI #1#3 = 530; #3#153 = #3#153 + cantidad; |FINSI;
|SI #1#3 = 531; #3#154 = #3#154 + cantidad; |FINSI;
|SI #1#3 = 532; #3#155 = #3#155 + cantidad; |FINSI;
|SI #1#3 = 533; #3#156 = #3#156 + cantidad; |FINSI;
|SI #1#3 = 534; #3#157 = #3#157 + cantidad; |FINSI;
|SI #1#3 = 535; #3#158 = #3#158 + cantidad; |FINSI;
|SI #1#3 = 536; #3#159 = #3#159 + cantidad; |FINSI;
|SI #1#3 = 537; #3#160 = #3#160 + cantidad; |FINSI;

|SI #1#3 = 601; #3#162 = #3#162 + cantidad; |FINSI;
|SI #1#3 = 602; #3#163 = #3#163 + cantidad; |FINSI;
|SI #1#3 = 603; #3#164 = #3#164 + cantidad; |FINSI;
|SI #1#3 = 604; #3#165 = #3#165 + cantidad; |FINSI;
|SI #1#3 = 607; #3#168 = #3#168 + cantidad; |FINSI;
|SI #1#3 = 608; #3#169 = #3#169 + cantidad; |FINSI;
|SI #1#3 = 609; #3#170 = #3#170 + cantidad; |FINSI;
|SI #1#3 = 610; #3#171 = #3#171 + cantidad; |FINSI;
|SI #1#3 = 612; #3#173 = #3#173 + cantidad; |FINSI;
|SI #1#3 = 613; #3#174 = #3#174 + cantidad; |FINSI;
|SI #1#3 = 614; #3#175 = #3#175 + cantidad; |FINSI;
|SI #1#3 = 616; #3#177 = #3#177 + cantidad; |FINSI;
|SI #1#3 = 617; #3#178 = #3#178 + cantidad; |FINSI;
|SI #1#3 = 618; #3#179 = #3#179 + cantidad; |FINSI;
|SI #1#3 = 619; #3#180 = #3#180 + cantidad; |FINSI;
|SI #1#3 = 620; #3#181 = #3#181 + cantidad; |FINSI;
|SI #1#3 = 621; #3#182 = #3#182 + cantidad; |FINSI;
|SI #1#3 = 622; #3#183 = #3#183 + cantidad; |FINSI;

|SI #1#3 = 501;
    |SI cantidad > 0;
        #3#124 = #3#124 + cantidad;
    |SINO;
        #3#167 = #3#167 + cantidad;
    |FINSI;
|FINSI;
|FPRC;

|PROCESO cantidad_92;
     |SI enNoPanta = 0;
         #0#3 = #2#1; |PINTA #0#3;
         #0#4 = #2#3; |PINTA #0#4;
     |FINSI;

cantidad = #2#8;
|SI #1#9 = "-"; cantidad = -#2#8; |FINSI;
|HAZ casillas_92;
|FPRC;

|DEFBUCLE liapunte;
#2#2;
;
empresa, anyo, cuentad;
empresa, anyo, cuentah;
e;
NULL, cantidad_92;
|FIN;

|PROCESO montacuen_92;
vari   = #1#2;
|QBF vari;
aste   = vari % -101;
long   = vari % 0;
longi  = long - 1;
longi  = 100 + longi;
numero = vari % longi;
|SI aste = "*";
    cuentad = numero + "            ";
    cuentad = cuentad % 112;
    cuentah = numero + "zzzzzzzzzzzz";
    cuentah = cuentah % 112;
|SINO;
    cuentad = #1#2;
    cuentah = #1#2;
|FINSI;
|FPRC;

|PROCESO bulineas_92;
|HAZ montacuen_92;
|BUCLE liapunte;        || Lee las lineas apuntes
|FPRC;

|DEFBUCLE planconta;
#1#1;
3;
#0#0, 001, 001;
#0#0, 999, 999;
e;
NULL, bulineas_92;
|FIN;

|PROCESO pasa_92;
|ABRE #3;

|LIBERA #3; #3#0 = empresa; #3#1 = anyo; |LEE 110#3=; FEstado = FSalida;
|DDEFECTO #3;

#3#0 = empresa; #3#1 = anyo; #3#2 = tipo;

|BUCLE planconta;     || Lee las lineas

|HAZ totales_92;

|SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;

|CIERRA #3;
|HAZ liquid_92;
|FPRC;

|PROCESO totales_92;
#3#11  = #3#05 + #3#07 + #3#09;
#3#12  = #3#06 + #3#08 + #3#10;
#3#13  = #3#11 - #3#12;
#3#29  = #3#14 + #3#16 + #3#18 + #3#20 + #3#22 + #3#24 + #3#26 + #3#27;
#3#30  = #3#15 + #3#17 + #3#19 + #3#21 + #3#23 + #3#25 + #3#28;
#3#31  = #3#29 - #3#30;
#3#47  = #3#32 + #3#34 + #3#36 + #3#38 + #3#40 + #3#42 + #3#44 + #3#46;
#3#48  = #3#33 + #3#35 + #3#37 + #3#39 + #3#41 + #3#43 + #3#45;
#3#49  = #3#47 - #3#48;
#3#56  = #3#54 - #3#55;
#3#64  = #3#57 + #3#58 + #3#59 + #3#60 + #3#61 + #3#62 + #3#63;
#3#66  = #3#64 - #3#65;
#3#71  = #3#67 + #3#69;
#3#72  = #3#68 + #3#70;
#3#73  = #3#71 - #3#72;
#3#77  = #3#75 + #3#76;
#3#91  = #3#80 + #3#81 + #3#82 + #3#83 + #3#84 + #3#85 + #3#87 + #3#88;
#3#92  = #3#86 + #3#89 + #3#90;
#3#93  = #3#91 - #3#92;
#3#97  = #3#94 + #3#95 + #3#96;
#3#105 = #3#100 + #3#101 + #3#102 + #3#103 + #3#104;
#3#120 = 0;
|PARA x = 106; |SI x [ 119; |HACIENDO x = x + 1;
    #3#120 = #3#120 + #3x;
|SIGUE;
#3#128 = #3#125 + #3#126 + #3#127;
#3#134 = #3#129 + #3#130 + #3#131 + #3#132 + #3#133;
#3#138 = #3#135 + #3#136 + #3#137;
#3#142 = #3#139 + #3#140 + #3#141;
#3#147 = #3#143 + #3#144 + #3#145 + #3#146;
#3#150 = #3#148 + #3#149;
#3#166 = #3#162 + #3#163 + #3#164 + #3#165;
#3#172 = #3#169 + #3#170 + #3#171;
#3#176 = #3#173 + #3#174 + #3#175;
#3#79  = #3#3  + #3#4  + #3#13 + #3#31 + #3#49 + #3#50 + #3#51 + #3#52 + #3#53;
#3#79  = #3#79 + #3#56 + #3#66 + #3#73 + #3#74 + #3#77 + #3#78;
#3#123 = #3#93 + #3#97 + #3#98 + #3#99 + #3#105 + #3#120 + #3#121 + #3#122;

#3#161 = #3#124 + #3#128 + #3#134 + #3#138 + #3#142 + #3#147 + #3#150;
#3#161 = #3#161 + #3#151 + #3#152 + #3#153 + #3#154 + #3#155 + #3#156;
#3#161 = #3#161 + #3#157 + #3#158 + #3#159;

#3#184 = #3#166 + #3#167 + #3#168 + #3#172 + #3#176 + #3#177;
#3#184 = #3#184 + #3#178 + #3#179 + #3#180 + #3#181 + #3#182;
benper = #3#184 - #3#161;
|SI benper > 0;
    #3#160 = benper;
    #3#161 = #3#161 + #3#160;
    #3#183 = 0;
|SINO;
    #3#183 = -benper;
    #3#184 = #3#184 + #3#183;
    #3#160 = 0;
|FINSI;
|FPRC;

|PROCESO liquid_92;
|ABRE #4;
#4#0 = #3#0;
#4#1 = #3#1;
|LIBERA #4;
|LEE 110#4=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #4; #4#0 = #3#0; #4#1 = #3#1; |FINSI;

#4#2 = #3#88;
|SI FEstado = 0; |GRABA 020#4a; |SINO; |GRABA 020#4n; |FINSI;
|CIERRA #4;

|SUB_EJECUTA "ispant31.run";

|ABRE #5;
#5#0 = #3#0;
#5#1 = #3#1;
|LIBERA #5;
|LEE 110#5=;
FEstado = FSalida;
|SI FEstado ! 0; |DDEFECTO #5; #5#0 = #3#0; #5#1 = #3#1; |FINSI;

#5#3 = #3#88;
#5#7 = #5#3 + #5#4 + #5#5 + #5#6;
|SI FEstado = 0; |GRABA 020#5a; |SINO; |GRABA 020#5n; |FINSI;
|CIERRA #5;
|FPRC;
