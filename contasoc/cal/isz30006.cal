|FICHEROS;
    isocie30 #05;
    isocie06 #06;
    isocie09 #09;
    isocie10 #10;
    isocie38 #38;
    isocie55 #52;
|FIN;

|VARIABLES;
    &empresa = 0;
    &anyo    = 0;

    casilla_p = 0;
    casilla_a = 0;
    total     = 0;
    xxx       = 0;
|FIN;

|PROCESO resumen_96;
casilla_p    = casilla_a + 2;
#52casilla_a = #52casilla_a + total;
#52casilla_p = #52casilla_p + total;
|FPRC;

|PROCESO el96_05;
total = #5#7;
|SI #5#3 = 91; casilla_a = 2;  |FINSI;
|SI #5#3 = 92; casilla_a = 8;  |FINSI;
|SI #5#3 = 93; casilla_a = 14; |FINSI;

|SI #5#3 = 94;
    |SI #5#9 = 1; casilla_a = 20; |FINSI;
    |SI #5#9 = 2; casilla_a = 23; |FINSI;
    |SI #5#9 = 3; casilla_a = 26; |FINSI;
|FINSI;

|SI #5#3 = 95;
    |SI #5#9 = 1; casilla_a = 32; |FINSI;
    |SI #5#9 = 2; casilla_a = 35; |FINSI;
    |SI #5#9 = 3; casilla_a = 38; |FINSI;
|FINSI;

|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie30_96;
#5#1;
;
empresa, anyo, 001;
empresa, anyo, 999;
;
NULL, el96_05;
|FIN;

|PROCESO el96_06;
total = #6#8;

|SI #6#3 = "AF"; casilla_a = 47; |FINSI;
|SI #6#3 = "EL"; casilla_a = 50; |FINSI;
|SI #6#3 = "GI"; casilla_a = 53; |FINSI;
|SI #6#3 = "GA"; casilla_a = 53; |FINSI;
|SI #6#3 = "AE"; casilla_a = 59; |FINSI;
|SI #6#3 = "BI"; casilla_a = 62; |FINSI;
|SI #6#3 = "PC"; casilla_a = 56; |FINSI;
|SI #6#3 = "FP"; casilla_a = 65; |FINSI;
|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie06_96;
#6#1;
;
empresa, anyo, 001;
empresa, anyo, 999;
;
NULL, el96_06;
|FIN;

|PROCESO el96_38;
total = #38#9;

|SI #38#3 = "E";
    |SI #38#4 = 91; casilla_a = 74; |FINSI;
    |SI #38#4 = 92; casilla_a = 77; |FINSI;
|FINSI;

|SI #38#3 = "J";
    |SI #38#4 = 91; casilla_a = 80; |FINSI;
    |SI #38#4 = 92; casilla_a = 83; |FINSI;
|FINSI;

|SI #38#3 = "M";
    |SI #38#4 = 91; casilla_a = 86; |FINSI;
    |SI #38#4 = 92; casilla_a = 89; |FINSI;
|FINSI;

|SI #38#3 = "1";
    |SI #38#4 = 92; casilla_a = 119; |FINSI;
    |SI #38#4 = 93; casilla_a = 122; |FINSI;
    |SI #38#4 = 94; casilla_a = 125; |FINSI;
    |SI #38#4 = 95; casilla_a = 128; |FINSI;
    |SI #38#4 = 96; casilla_a = 131; |FINSI;
|FINSI;

|SI #38#3 = "2";
    |SI #38#4 = 92; casilla_a = 137; |FINSI;
    |SI #38#4 = 93; casilla_a = 140; |FINSI;
    |SI #38#4 = 94; casilla_a = 143; |FINSI;
    |SI #38#4 = 95; casilla_a = 146; |FINSI;
    |SI #38#4 = 96; casilla_a = 149; |FINSI;
|FINSI;

|SI #38#3 = "3";
    |SI #38#4 = 93; casilla_a = 91; |FINSI;
|FINSI;

|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie38_96;
#38#1;
;
empresa, anyo, 000;
empresa, anyo, 999;
;
NULL, el96_38;
|FIN;

|PROCESO el96_09;
total = #9#6;

|SI #9#3 = 91; casilla_a = 98;  |FINSI;
|SI #9#3 = 92; casilla_a = 101; |FINSI;
|SI #9#3 = 93; casilla_a = 104; |FINSI;
|SI #9#3 = 94; casilla_a = 107; |FINSI;
|SI #9#3 = 95; casilla_a = 110; |FINSI;

|HAZ resumen_96;
|FPRC;

|DEFBUCLE isocie09_96;
#9#1;
;
empresa, anyo, 001;
empresa, anyo, 999;
be;
NULL, el96_09;
|FIN;

|PROCESO ficher96_10;
|ABRE #10;
#10#0 = empresa;
#10#1 = anyo;
|LEE 040#10=;
|SI FSalida = 0;
    total     = #10#17;
    casilla_a = 113;
    |HAZ resumen_96;
|FINSI;
|CIERRA #10;
|FPRC;

|PROCESO calcula_96;
|ABRE #52; #52#0 = empresa; #52#1 = anyo; |BORRA 140#52c; |LIBERA #52; |CIERRA #52;

|ABRE #52;
|DDEFECTO #52;
#52#0 = empresa;
#52#1 = anyo;

|BUCLE isocie30_96;
|BUCLE isocie06_96;
|BUCLE isocie38_96;
|BUCLE isocie09_96;
|HAZ ficher96_10;

|HAZ totales_96;
|GRABA 140#52n;
|CIERRA #52;

|SUB_EJECUTA "isz00005";
|FPRC;

|PROCESO totales_96;
#52#44 = 0;
#52#45 = 0;
#52#46 = 0;
|PARA xxx = 2; |SI xxx [ 41; |HACIENDO xxx = xxx + 1;
                     #52#44 = #52#44 + #52xxx;
      xxx = xxx + 1; #52#45 = #52#45 + #52xxx;
      xxx = xxx + 1; #52#46 = #52#46 + #52xxx;
|SIGUE;

#52#71 = 0;
#52#72 = 0;
#52#73 = 0;
|PARA xxx = 50; |SI xxx [ 68; |HACIENDO xxx = xxx + 1;
                     #52#71 = #52#71 + #52xxx;
      xxx = xxx + 1; #52#72 = #52#72 + #52xxx;
      xxx = xxx + 1; #52#73 = #52#73 + #52xxx;
|SIGUE;

#52#95 = 0;
#52#96 = 0;
#52#97 = 0;
|PARA xxx = 74; |SI xxx [ 92; |HACIENDO xxx = xxx + 1;
                     #52#95 = #52#95 + #52xxx;
      xxx = xxx + 1; #52#96 = #52#96 + #52xxx;
      xxx = xxx + 1; #52#97 = #52#97 + #52xxx;
|SIGUE;

#52#116 = 0;
#52#117 = 0;
#52#118 = 0;
|PARA xxx = 98; |SI xxx [ 110; |HACIENDO xxx = xxx + 1;
                     #52#116 = #52#116 + #52xxx;
      xxx = xxx + 1; #52#117 = #52#117 + #52xxx;
      xxx = xxx + 1; #52#118 = #52#118 + #52xxx;
|SIGUE;

#52#134 = 0;
#52#135 = 0;
#52#136 = 0;
|PARA xxx = 119; |SI xxx [ 131; |HACIENDO xxx = xxx + 1;
                     #52#134 = #52#134 + #52xxx;
      xxx = xxx + 1; #52#135 = #52#135 + #52xxx;
      xxx = xxx + 1; #52#136 = #52#136 + #52xxx;
|SIGUE;

#52#152 = 0;
#52#153 = 0;
#52#154 = 0;
|PARA xxx = 137; |SI xxx [ 149; |HACIENDO xxx = xxx + 1;
                     #52#152 = #52#152 + #52xxx;
      xxx = xxx + 1; #52#153 = #52#153 + #52xxx;
      xxx = xxx + 1; #52#154 = #52#154 + #52xxx;
|SIGUE;
|FPRC;
