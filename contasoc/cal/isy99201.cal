|FICHEROS;
     isy99201 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto

     maempr10 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     maempr05 #12;              || Socios Transparencia Fiscal

     isocie64 #11;              || Transparencia Fiscal
     isocie65 #13;              || Balances
     isocie59 #14;              || Liquidacion
     isocie58 #15;              || Distribucion de Resultados
     isocie69 #16;              || Resumen de Deducciones
     isocie60 #17;              || Cooperativas
     isocie63 #18;              || Por Doble imposicion
     isocie62 #19;              || Compensaciones
     isocie67 #22;              || Informacion adicional
     isocie71 #71;              || Materializacion y Manifestacion
     isyycasi #23;

     isw00007 #90;
     isw00008 #99,MANTE;
     isw00024 #100;             || Hoja  1
     isw00025 #101;             || Hoja  2
     isw00026 #102;             || Hoja  3
     isw00020 #104;             || Hoja 10
     isw00012 #103;             || Hoja 13
     isw00021 #105;             || Hoja 4 y 5
     isw00023 #999;             || Carga Casillas Abreviadas Balance

     &haciend@  #706;
     &clientes@ #715;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aCadena       = "";
     aCaracter     = "";
     aLong         = "";
     aGuiri        = "";

     nLong         = 0;
     nPos          = 0;
     nCampo        = 0;

     CantiNum      = 0;
     PosiU         = 0;
     VarAlfa       = "";
     VarAlfa0      = "";
     VarAlfa1      = "";
     VarAlfa2      = "";
     SwPunto       = 0;
     XPara         = 0;
     ParteEntera   = "";
     ParteDecimal  = "";
     ParteDecimal4 = "";
     CantiAlfa     = "";
     Handle        = "";
     Variable      = "";
     Raiz          = "";
     Directorio    = "";
     nAnyo         = 0;
     nSwCoopera    = 0;

     Suma         = 0;
     ZPara        = 0;
     ZPara1       = 0;
     YPara        = 0;
     Dia          = "";
     Mes          = "";
     Ejerc        = "";
     SwHay        = 0;
     DEmpre       = 0;
     HEmpre       = 0;
     Fichero      = "";
     Valfa        = "";
     Valfa1       = "";
     Valfa2       = "";
     NombreInf    = "";
     NombreImpre  = "";
     ContaBucle   = 0;
     ContaBucleL  = 0;
     Puntero      = 0;
     Puntar1      = 0;
     Puntar2      = 0;
     CFBase       = "";
     CFAbre       = "";
     NCopia       = 0;
     Tempo        = "";
     DesdeClav    = 0;
     HastaClav    = 0;

     &enCodProv   = 0;
     &enCodPobl   = 0;
     &enCodCli    = 0;
     &enSwDeDonde = 0;
     &eaEfectivo  = "";
     &eaAdeudo    = "";
     &eaEntidad   = "";
     &eaOficina   = "";
     &eaDC        = "";
     &eaCuenta    = "";
     &enModelo    = 0;
     &enBanco     = 0;
     &enFormaPag  = 0;
     &enForzar    = 0;

 {-1} Hojas      = "";
      Hojas1     = "1230";
      Hojas2     = "1";
      Hojas3     = "3";
      Hojas4     = "Papel Laser                ";
      Hojas5     = "Papel oficial Continuo     ";
      Hojas6     = "Papel oficial Hoja a Hoja  ";

       &eaMoneda    = "";
       &enCanti     = 0;
       &enAnyo      = 0;
 {800} &NEmpresas   = "";
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
     |SI #0#0 = "S";
         |CAMPO_MODIFICA #0#01, 1, "S";
         |CAMPO_MODIFICA #0#02, 1, "S";

         |PARA YPara = 3; |SI YPara [ 32; |HACIENDO YPara = YPara + 1;
               #0YPara = 0; |PINTA #0YPara;
               |CAMPO_MODIFICA #0YPara, 1, "N";
         |SIGUE;
     |SINO;
         #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
         #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

         |PARA YPara = 3; |SI YPara [ 32; |HACIENDO YPara = YPara + 1;
               |CAMPO_MODIFICA #0YPara, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO MiraVarMoneda;  |TIPO 7;
     |HAZ PintaMoneda;
     #0#58 = eaMoneda;

     |PINTA #0#58;
|FPRC;

|| **************************************************************************
|| UTILIDADES
|| **************************************************************************

|PROCESO Decima7E2D;
  VarAlfa   = (CantiNum + "          ") % 110;
  PosiU   = 0;
  VarAlfa0  = "";
  VarAlfa1  = "";
  VarAlfa2  = "";
  SwPunto = 0;
  |PARA XPara = 1;  |SI XPara [ 10;  |HACIENDO XPara = XPara + 1;
        PosiU  = (100 * XPara) + 1;
        VarAlfa0 = VarAlfa % PosiU;
        |SI VarAlfa0 = "."; SwPunto = 1;  |FINSI;
        |SI SwPunto = 0;
            |SI VarAlfa0 ! " "; |Y VarAlfa0 ! ".";
                VarAlfa1 = VarAlfa1 + VarAlfa0;
            |FINSI;
        |FINSI;

        |SI SwPunto = 1;
            |SI VarAlfa0 ! " "; |Y VarAlfa0 ! ".";
                VarAlfa2 = VarAlfa2 + VarAlfa0;
            |FINSI;
        |FINSI;
  |SIGUE;

  ParteEntera   = ("0000000" + VarAlfa1) % -107;
  ParteDecimal  = (VarAlfa2 + "00") % 102;
|FPRC;

|PROCESO Decima3E2D;
  VarAlfa   = (CantiNum + "          ") % 110;
  PosiU   = 0;
  VarAlfa0  = "";
  VarAlfa1  = "";
  VarAlfa2  = "";
  SwPunto = 0;
  |PARA XPara = 1;  |SI XPara [ 10;  |HACIENDO XPara = XPara + 1;
        PosiU  = (100 * XPara) + 1;
        VarAlfa0 = VarAlfa % PosiU;
        |SI VarAlfa0 = "."; SwPunto = 1;  |FINSI;
        |SI SwPunto = 0;
            |SI VarAlfa0 ! " "; |Y VarAlfa0 ! ".";
                VarAlfa1 = VarAlfa1 + VarAlfa0;
            |FINSI;
        |FINSI;

        |SI SwPunto = 1;
            |SI VarAlfa0 ! " "; |Y VarAlfa0 ! ".";
                VarAlfa2 = VarAlfa2 + VarAlfa0;
            |FINSI;
        |FINSI;
  |SIGUE;

  ParteEntera   = ("000" + VarAlfa1) % -103;
  ParteDecimal  = (VarAlfa2 + "00") % 102;
  ParteDecimal4 = (VarAlfa2 + "0000") % 104;
|FPRC;

|PROCESO CambiCantiD12;
    eaMoneda = #0#58;
    enCanti  = CantiNum;
    |HAZ ConverMoneda;
    CantiNum = enCanti;

    |SI CantiNum ] 0;
        CantiAlfa = CantiNum;
        CantiAlfa = ("000000000000" + CantiAlfa) % -112;
    |SINO;
        CantiNum  = -CantiNum;
        CantiAlfa = CantiNum;
        CantiAlfa = "N" + (("00000000000" + CantiAlfa) % -111);
    |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

|PROCESO CargaExplo;
     #999#0 = #23#0;
     #999#1 = "A";
     |LEE 040#999=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     Puntar1 = #999#2;

     |PARA ZPara = 1; |SI ZPara [ 16; |HACIENDO ZPara = ZPara + 1;
           |SI #23ZPara ! 0;
                ZPara1  = ZPara + 16;
                #999#0 = #23ZPara;
                #999#1 = "N";
                |LEE 040#999=;
                |SI FSalida = 0;
                    Puntar2 = #999#2;
                    |SI #23ZPara1 = "+";
                        #105Puntar1 = #105Puntar1 + #13Puntar2;
                    |SINO;
                        #105Puntar1 = #105Puntar1 - #13Puntar2;
                    |FINSI;
               |FINSI;
          |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE isyycasi;
     #23#1;
     ;
     #0#56, 000;
     #0#56, 999;
     ;
     NULL, CargaExplo;
|FIN;

|PROCESO LeeFich;
     |ABRE #1;
     #1#0 = #99#0;
     #1#1 = #0#56;
     |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #2;
     #2#0 = #1#0;
     #2#1 = #1#1;
     |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |CIERRA #2;

     enCodProv = #2#29;
     enCodPobl = #2#30;
     |HAZ LeeHacienda;

     |ABRE #13;
     #13#0 = #1#0;
     #13#1 = #1#1;
     |LEE 040#13=;
     |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
     |CIERRA #13;

     |ABRE #22;
     #22#0 = #1#0;
     #22#1 = #1#1;
     |LEE 040#22=;
     |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |CIERRA #22;

     |ABRE #11;
     #11#0 = #1#0;
     #11#1 = #1#1;
     |LEE 040#11=;
     |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
     |CIERRA #11;

     |ABRE #14;
     #14#0 = #1#0;
     #14#1 = #1#1;
     |LEE 040#14=;
     |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
     |CIERRA #14;

     |ABRE #15;
     #15#0 = #1#0;
     #15#1 = #1#1;
     |LEE 040#15=;
     |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
     |CIERRA #15;

     |ABRE #16;
     #16#0 = #1#0;
     #16#1 = #1#1;
     |LEE 040#16=;
     |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
     |CIERRA #16;

     |ABRE #17;
     #17#0 = #1#0;
     #17#1 = #1#1;
     |LEE 040#17=;
     |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
     |CIERRA #17;

     |ABRE #18;
     #18#0 = #1#0;
     #18#1 = #1#1;
     |LEE 040#18=;
     |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
     |CIERRA #18;

     |ABRE #71;
     #71#0 = #1#0;
     #71#1 = #1#1;
     |LEE 040#71=;
     |SI FSalida ! 0; |DDEFECTO #71; |FINSI;
     |CIERRA #71;

     |ABRE #999;
     |BUCLE isyycasi;
     |CIERRA #999;

     aGuiri = "N";
     |ABRE #4;
     #4#0 = #1#0;
     #4#1 = #1#1;
     #4#2 = 21;
     |LEE 040#4=;
     |SI FSalida = 0;
         aGuiri = "S";
     |FINSI;
     |CIERRA #4;

     #105#32 = #22#29;
     #105#52 = #22#33;
     #105#53 = #22#34;
     #105#54 = #22#35;
     #105#55 = #22#36;
     #105#56 = #22#37;
|FPRC;

|PROCESO Defectos;
     |DDEFECTO #100;
     |DDEFECTO #101;
     |DDEFECTO #102;
     |DDEFECTO #103;
     |DDEFECTO #104;
     |DDEFECTO #105;
|FPRC;

|PROCESO Representante;
     ContaBucle = ContaBucle + 1;
     |SI ContaBucle = 1;
         #100#67 = #5#3 %  118;
         #100#68 = #5#3 %  1918;
         #100#69 = #5#4;
         #100#70 = #5#5;
         #100#71 = #5#6;
     |FINSI;

     |SI ContaBucle = 2;
         #100#72 = #5#3 %  118;
         #100#73 = #5#3 %  1918;
         #100#74 = #5#4;
         #100#75 = #5#5;
         #100#76 = #5#6;
     |FINSI;

     |SI ContaBucle = 3;
         #100#77 = #5#3 %  118;
         #100#78 = #5#3 %  1918;
         #100#79 = #5#4;
         #100#80 = #5#5;
         #100#81 = #5#6;
     |FINSI;
|FPRC;

|DEFBUCLE maempr04;
     #5#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, Representante;
|FIN;

|PROCESO PuntoA;
     ContaBucle  = ContaBucle + 1;
     #101#0      = ((ContaBucle / 6) + .49) ! 0;
     ContaBucleL = (ContaBucle + 5) - (6 * #101#0);

     |LIBERA #101;
     |LEE 140#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((ContaBucle / 6) + .49) ! 0;
         |GRABA 140#101b;
     |FINSI;

     Puntero = (ContaBucleL * 6) + 4;  #101Puntero = #6#3;
     Puntero = Puntero + 1;            #101Puntero = #6#4;
     Puntero = Puntero + 1;            #101Puntero = #6#8;
     Puntero = Puntero + 1;            #101Puntero = #6#5;
     Puntero = Puntero + 1;            #101Puntero = #6#6;
     Puntero = Puntero + 1;            #101Puntero = #6#7;

     |GRABA 140#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr03;
     #6#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, PuntoA;
|FIN;

|PROCESO PuntoB1;
     ContaBucle  = ContaBucle + 1;
     #101#0      = ((ContaBucle / 6) + .49) ! 0;
     ContaBucleL = (ContaBucle + 5) - (6 * #101#0);

     |LIBERA #101;
     |LEE 140#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((ContaBucle / 6) + .49) ! 0;
         |GRABA 140#101b;
     |FINSI;

     Puntero = (ContaBucleL * 5) + 40; #101Puntero = #7#3;
     Puntero = Puntero + 1;            #101Puntero = #7#4;
     Puntero = Puntero + 1;            #101Puntero = #7#5;
     Puntero = Puntero + 1;            #101Puntero = #7#6;
     Puntero = Puntero + 1;            #101Puntero = #7#7;

     |GRABA 140#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr06;
     #7#1;
     ;
     #1#0, #1#1, 00;
     #1#0, #1#1, 99;
     ;
     NULL, PuntoB1;
|FIN;

|PROCESO PuntoB2;
     ContaBucle  = ContaBucle + 1;
     #101#0      = ((ContaBucle / 6) + .49) ! 0;
     ContaBucleL = (ContaBucle + 5) - (6 * #101#0);

     |LIBERA #101;
     |LEE 140#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((ContaBucle / 6) + .49) ! 0;
         |GRABA 140#101b;
     |FINSI;

     Puntero = (ContaBucleL * 7) + 70; #101Puntero = #8#3;
     Puntero = Puntero + 1;            #101Puntero = #8#9;
     Puntero = Puntero + 1;            #101Puntero = #8#4;
     Puntero = Puntero + 1;            #101Puntero = #8#5;
     Puntero = Puntero + 1;            #101Puntero = #8#6;
     Puntero = Puntero + 1;            #101Puntero = #8#7;
     Puntero = Puntero + 1;            #101Puntero = #8#8;

     |GRABA 140#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr02;
     #8#1;
     ;
     #1#0, #1#1, 000;
     #1#0, #1#1, 999;
     ;
     NULL, PuntoB2;
|FIN;

|PROCESO PuntoC1;
     ContaBucle  = ContaBucle + 1;
     #101#0      = ((ContaBucle / 6) + .49) ! 0;
     ContaBucleL = (ContaBucle + 5) - (6 * #101#0);

     |LIBERA #101;
     |LEE 140#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((ContaBucle / 6) + .49) ! 0;
         |GRABA 140#101b;
     |FINSI;

     Puntero = (ContaBucleL * 6) + 112;  #101Puntero = #9#3;
     Puntero = Puntero + 1;              #101Puntero = #9#4;
     Puntero = Puntero + 1;              #101Puntero = #9#5;
     Puntero = Puntero + 1;              #101Puntero = #9#6;
     Puntero = Puntero + 1;              #101Puntero = #9#7;
     Puntero = Puntero + 1;              #101Puntero = #9#8;

     |GRABA 140#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr14;
     #9#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, PuntoC1;
|FIN;

|PROCESO PuntoC2;
     ContaBucle  = ContaBucle + 1;
     #101#0      = ((ContaBucle / 6) + .49) ! 0;
     ContaBucleL = (ContaBucle + 5) - (6 * #101#0);

     |LIBERA #101;
     |LEE 140#101=;
     |SI FSalida ! 0;
         |DDEFECTO #101;
         #101#0     = ((ContaBucle / 6) + .49) ! 0;
         |GRABA 140#101b;
     |FINSI;

     Puntero = (ContaBucleL * 6) + 148;  #101Puntero = #10#3;
     Puntero = Puntero + 1;              #101Puntero = #10#4;
     Puntero = Puntero + 1;              #101Puntero = #10#6;
     Puntero = Puntero + 1;              #101Puntero = #10#5;
     Puntero = Puntero + 1;              #101Puntero = #10#7;
     Puntero = Puntero + 1;              #101Puntero = #10#8;

     |GRABA 140#101a;
     |LIBERA #101;
|FPRC;

|DEFBUCLE maempr15;
     #10#1;
     ;
     #1#0, #1#1, 00, 00;
     #1#0, #1#1, 00, 99;
     ;
     NULL, PuntoC2;
|FIN;

|PROCESO PuntoE;
     ContaBucle  = ContaBucle + 1;
     #102#0      = ((ContaBucle / 11) + .49) ! 0;
     ContaBucleL = (ContaBucle + 10) - (11 * #102#0);

     |LIBERA #102;
     |LEE 140#102=;
     |SI FSalida ! 0;
         |DDEFECTO #102;
         #102#0     = ((ContaBucle / 11) + .49) ! 0;
         |GRABA 140#102b;
     |FINSI;

     Puntero = (ContaBucleL * 8) + 38;  #102Puntero = #12#3;
     Puntero = Puntero + 1;             #102Puntero = #12#10;
     Puntero = Puntero + 1;             #102Puntero = #12#4;
     Puntero = Puntero + 1;             #102Puntero = #12#5;
     Puntero = Puntero + 1;             #102Puntero = #12#6;
     Puntero = Puntero + 1;             #102Puntero = #12#7;
     Puntero = Puntero + 1;             #102Puntero = #12#8;
     Puntero = Puntero + 1;             #102Puntero = #12#9;

     |GRABA 140#102a;
     |LIBERA #102;
|FPRC;

|DEFBUCLE maempr05;
     #12#2;
     ;
     #1#0, #1#1, 999.99, 00;
     #1#0, #1#1,      0, 99;
     ;
     NULL, PuntoE;
|FIN;

|| **************************************************************************
||                           PROCESOS DE LA CARGA DEL SECUENCIAL
|| **************************************************************************

|PROCESO AbreSecuencial;
     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NCopia;

     Pos = -1;
     Valfa = "r+b " + NEmpresas;
     |FABRE Valfa;
     |SI FSalida < 0;
         Valfa = "wb  " + NEmpresas;
         |FABRE Valfa;
     |FINSI;

     Handle = FSalida;
     |SI FSalida ] 0;
         |PARA; |SI; |HACIENDO;
              Valfa = Handle + " 255";
              |FLEE Valfa;
              |SI FSalida [ 0;  |SAL;  |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
     |QBF aAlfa;
     aCadena = "";
     aLong   = Valfa % 0;
     nLong   = aLong;
     |PARA nCampo = 1;  |SI nCampo [ aLong;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = Valfa % nPos;
           |SI aCaracter = ",";  aCaracter = " ";  |FINSI;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &209; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     Valfa = aCadena;
     Valfa = Valfa > Valfa;

     Variable = Handle + " " + Valfa;
     |FGRABA Variable;
|FPRC;

|PROCESO CierraSecuencial;
     |FCIERRA Handle;
|FPRC;

|PROCESO Entero;
     |HAZ CambiCantiD12;
     Valfa    = CantiAlfa;
     |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Decimal;
     |HAZ Decima3E2D;
     Valfa    = ParteEntera + ParteDecimal;
     |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Decimal2;
     |HAZ Decima3E2D;
     Valfa    = ParteEntera + ParteDecimal4;
     |HAZ GrabaSecuencial;
|FPRC;

|PROCESO Secuencial01;
     |HAZ AbreSecuencial;

     Valfa = "201";   |HAZ GrabaSecuencial;
     Valfa = "01";    |HAZ GrabaSecuencial;
     Valfa = " ";     |HAZ GrabaSecuencial;
     Valfa = "P";     |HAZ GrabaSecuencial;
     Valfa = #100#4;  |HAZ GrabaSecuencial;
     Valfa = #100#5;  |HAZ GrabaSecuencial;
     Valfa = #100#6;  |HAZ GrabaSecuencial;
     Valfa = "1999";  |HAZ GrabaSecuencial;

     |PARA ZPara = 7;  |SI ZPara [ 32;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA ZPara = 37;  |SI ZPara [ 48;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA ZPara = 52;  |SI ZPara [ 55;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA ZPara = 57;  |SI ZPara [ 58;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #100ZPara;
           |HAZ Decima7E2D;
           Valfa = ParteEntera + ParteDecimal;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA ZPara = 59;  |SI ZPara [ 61;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |SI aGuiri = "N";
         Valfa = "          ";   |HAZ GrabaSecuencial;
     |SINO;
         Valfa = #0#33;          |HAZ GrabaSecuencial;
     |FINSI;

     |PARA ZPara = 63;  |SI ZPara [ 81;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial02;
     |HAZ AbreSecuencial;

     Valfa = "201";
     |HAZ GrabaSecuencial;

     Valfa = "02";
     |HAZ GrabaSecuencial;

     |SI #101#0 = 1;  Valfa = " ";  |FINSI;
     |SI #101#0 > 1;  Valfa = "C";  |FINSI;
     |HAZ GrabaSecuencial;

     |PARA ZPara = 4;  |SI ZPara [ 34;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;  |QBT Valfa;
           Valfa = ("00" + Valfa) % -102;
           |HAZ GrabaSecuencial;
     |SIGUE;

     |PARA ZPara = 40;  |SI ZPara [ 65;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;  |QBT Valfa;
           Valfa = ("00" + Valfa) % -102;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Entero;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Decimal;
     |SIGUE;

     |PARA ZPara = 70;  |SI ZPara [ 105;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;  |QBT Valfa;
           Valfa = ("00" + Valfa) % -102;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Entero;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Decimal;
     |SIGUE;

     |PARA ZPara = 112;  |SI ZPara [ 142;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #101ZPara;  |QBT Valfa;
           Valfa = ("000" + Valfa) % -103;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 2;
           CantiNum = #101ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 148;  |SI ZPara [ 178;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;   Valfa = #101ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 2;
           Valfa = #101ZPara;  |QBT Valfa;
           Valfa = ("000" + Valfa) % -103;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Entero;

           ZPara    = ZPara + 1;
           CantiNum = #101ZPara;
           |HAZ Decimal;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial03;
     Suma = #102#7 + #102#8  + #102#9  + #102#10 + #102#13 + #102#16;
     Suma = Suma   + #102#19 + #102#22 + #102#24 + #102#26 + #102#28;
     Suma = Suma   + #102#30 + #102#31 + #102#32 + #102#33 + #102#34;
     Suma = Suma   + #102#35 + #102#36 + #102#37 + #102#41;

     |SI Suma   = 0;    |Y #102#38 = "         "; |Y #102#4 = " ";
      |Y #102#5 = " ";  |Y #102#6  = " ";
         |ACABA;
     |FINSI;

     |HAZ AbreSecuencial;

     Valfa = "201";
     |HAZ GrabaSecuencial;

     Valfa = "03";
     |HAZ GrabaSecuencial;

     |SI #102#0 = 1;  Valfa = " ";  |FINSI;
     |SI #102#0 > 1;  Valfa = "C";  |FINSI;
     |HAZ GrabaSecuencial;

     |PARA ZPara = 4;  |SI ZPara [ 6;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     CantiNum = #102#7;
     |HAZ Decimal2;

     CantiNum = #102#8;
     |HAZ Entero;

     CantiNum = #102#9;
     |HAZ Entero;

     |PARA ZPara = 10;  |SI ZPara [ 19;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Entero;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Decimal2;
     |SIGUE;

     |PARA ZPara = 22;  |SI ZPara [ 28;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Entero;

           ZPara    = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Decimal2;
     |SIGUE;

     |PARA ZPara = 30;  |SI ZPara [ 37;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 38;  |SI ZPara [ 118;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           Valfa = #102ZPara;  |QBT Valfa;
           Valfa = ("00" + Valfa) % -102;
           |HAZ GrabaSecuencial;

           ZPara    = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Entero;

           ZPara    = ZPara + 1;
           CantiNum = #102ZPara;
           |HAZ Decimal2;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial04;
     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "04";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     |PARA ZPara = 1;  |SI ZPara [ 19;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #105ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 69;  |SI ZPara [ 70;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #105ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 20;  |SI ZPara [ 32;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #105ZPara;
           |HAZ Entero;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial05;
     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "05";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     |PARA ZPara = 33;  |SI ZPara [ 68;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #105ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 3;  |SI ZPara [ 16;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #15ZPara;
           |HAZ Entero;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial06;
     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "06";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     |PARA ZPara = 2;  |SI ZPara [ 16;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 18;  |SI ZPara [ 30;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     CantiNum = #14#33;   |HAZ Entero;
     CantiNum = #14#34;   |HAZ Entero;
     CantiNum = #14#124;  |HAZ Entero;
     CantiNum = #14#35;   |HAZ Entero;
     CantiNum = #14#36;   |HAZ Entero;
     CantiNum = #14#39;   |HAZ Entero;
     CantiNum = #14#125;  |HAZ Entero;
     CantiNum = #14#38;   |HAZ Entero;
     CantiNum = #14#126;  |HAZ Entero;
     CantiNum = #14#40;   |HAZ Entero;
     CantiNum = #14#127;  |HAZ Entero;
     CantiNum = #14#37;   |HAZ Entero;

     |PARA ZPara = 41;  |SI ZPara [ 46;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     ZPara = #14#47 ! 0;
     Valfa = ("00" + ZPara) % -102;
     |HAZ GrabaSecuencial;

||     ZPara = #14#116 ! 0;
||     Valfa = ("00" + ZPara) % -102;
||     |HAZ GrabaSecuencial;

     |PARA ZPara = 48;  |SI ZPara [ 50;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial07;
     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "07";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;


     |PARA ZPara = 50;  |SI ZPara [ 56;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     CantiNum = #14#67;    |HAZ Entero;

     |PARA ZPara = 58;  |SI ZPara [ 66;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 68;  |SI ZPara [ 71;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     CantiNum = #14#73;    |HAZ Entero;

     |PARA ZPara = 75;  |SI ZPara [ 80;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     CantiNum = #14#74;  |HAZ Entero;

     |PARA ZPara = 81;  |SI ZPara [ 106;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 107;  |SI ZPara [ 111;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #14ZPara;
           |HAZ Decimal;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial08;
     Suma = #104#29 + #104#30  + #104#31  + #104#60 + #104#61 + #104#62;
     Suma = Suma    + #018#12  + #018#14  + #018#16;
     Suma = Suma    + #016#155 + #016#156 + #016#157;

     |SI Suma = 0;  |ACABA;  |FINSI;

     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "08";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     |PARA ZPara = 1;  |SI ZPara [ 25;  |HACIENDO ZPara = ZPara + 1;
           |SI #104ZPara ! "  ";
               aAlfa = #104ZPara;  |QBF aAlfa;
               Valfa = "19" + (("00" + aAlfa) % -102);
           |SINO;
               Valfa = "0000";
           |FINSI;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 29;  |SI ZPara [ 31;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 32;  |SI ZPara [ 56;  |HACIENDO ZPara = ZPara + 1;
           |SI #104ZPara ! "  ";
               aAlfa = #104ZPara;  |QBF aAlfa;
               Valfa = "19" + (("00" + aAlfa) % -102);
           |SINO;
               Valfa = "0000";
           |FINSI;
           |HAZ GrabaSecuencial;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;

           ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;
     |SIGUE;

     |PARA ZPara = 60;  |SI ZPara [ 62;  |HACIENDO ZPara = ZPara + 1;
           CantiNum = #104ZPara;
           |HAZ Entero;
     |SIGUE;

     CantiNum = #18#2;   |HAZ Entero;
     CantiNum = #18#5;   |HAZ Entero;
     CantiNum = #18#8;   |HAZ Entero;
     CantiNum = #18#3;   |HAZ Entero;
     CantiNum = #18#6;   |HAZ Entero;
     CantiNum = #18#9;   |HAZ Entero;
     CantiNum = #18#17;  |HAZ Entero;
     CantiNum = #18#18;  |HAZ Entero;
     CantiNum = #18#19;  |HAZ Entero;
     CantiNum = #18#20;  |HAZ Entero;
     CantiNum = #18#21;  |HAZ Entero;
     CantiNum = #18#22;  |HAZ Entero;
     CantiNum = #18#4;   |HAZ Entero;
     CantiNum = #18#7;   |HAZ Entero;
     CantiNum = #18#10;  |HAZ Entero;
     CantiNum = #18#11;  |HAZ Entero;
     CantiNum = #18#13;  |HAZ Entero;
     CantiNum = #18#15;  |HAZ Entero;
     CantiNum = #18#12;  |HAZ Entero;
     CantiNum = #18#14;  |HAZ Entero;
     CantiNum = #18#16;  |HAZ Entero;

     |PARA ZPara = 149;  |SI ZPara [ 157;  |HACIENDO ZPara = ZPara + 1;
           |SI ZPara ! 151;
               CantiNum = #16ZPara;
               |HAZ Entero;
           |FINSI;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial09;
     |PARA ZPara = 2;  |SI ZPara [ 148;  |HACIENDO ZPara = ZPara + 1;
           |SI #16ZPara ! 0;  Suma = 1;  |SAL;  |FINSI;
     |SIGUE;

     |SI Suma = 0;  |ACABA;  |FINSI;

     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "09";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     |PARA ZPara = 2;  |SI ZPara [ 148;  |HACIENDO ZPara = ZPara + 1;
           |SI ZPara ! 4;  |Y ZPara ! 7;  |Y ZPara ! 10;  |Y ZPara ! 13;
            |Y ZPara ! 97; |Y ZPara ! 118;
                CantiNum = #16ZPara;
                |HAZ Entero;
           |FINSI;
     |SIGUE;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial10;
     Suma = 0;
     Suma = Suma + #17#9;
     Suma = Suma + #17#19;
     Suma = Suma + #17#10;
     Suma = Suma + #17#20;
     Suma = Suma + #17#11;
     Suma = Suma + #17#21;
     Suma = Suma + #17#22;
     Suma = Suma + #17#12;
     Suma = Suma + #17#23;
     Suma = Suma + #17#13;
     Suma = Suma + #17#24;
     Suma = Suma + #17#14;
     Suma = Suma + #17#25;
     Suma = Suma + #17#15;
     Suma = Suma + #17#26;
     Suma = Suma + #17#16;
     Suma = Suma + #17#17;
     Suma = Suma + #17#27;
     Suma = Suma + #17#18;
     Suma = Suma + #17#28;

     Suma = Suma + #71#2;
     Suma = Suma + #71#3;
     Suma = Suma + #71#5;
     Suma = Suma + #71#6;
     Suma = Suma + #71#8;
     Suma = Suma + #71#9;
     Suma = Suma + #71#11;
     Suma = Suma + #71#13;

     Suma = Suma + #14#117;
     Suma = Suma + #14#118;
     Suma = Suma + #14#119;
     Suma = Suma + #14#120;
     Suma = Suma + #14#121;
     Suma = Suma + #14#122;
     Suma = Suma + #14#108;
     Suma = Suma + #14#109;
     Suma = Suma + #14#110;
     Suma = Suma + #14#111;

     nSwCoopera = 0;

     |ABRE #4;
     #4#0 = #17#0;
     #4#1 = #17#1;
     #4#2 = 17;
     |LEE 040#4=;
     |SI FSalida = 0; nSwCoopera = 1; |FINSI;

     #4#0 = #17#0;
     #4#1 = #17#1;
     #4#2 = 18;
     |LEE 040#4=;
     |SI FSalida = 0; nSwCoopera = 1; |FINSI;

     #4#0 = #17#0;
     #4#1 = #17#1;
     #4#2 = 19;
     |LEE 040#4=;
     |SI FSalida = 0; nSwCoopera = 1; |FINSI;
     |CIERRA #4;

     |SI Suma = 0;  |Y nSwCoopera = 0;  |ACABA;  |FINSI;

     |HAZ AbreSecuencial;

     Valfa = "201";                                        |HAZ GrabaSecuencial;
     Valfa = "10";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     CantiNum = #17#9;   |HAZ Entero;
     CantiNum = #17#19;  |HAZ Entero;
     CantiNum = #17#10;  |HAZ Entero;
     CantiNum = #17#20;  |HAZ Entero;
     CantiNum = #17#11;  |HAZ Entero;
     CantiNum = #17#21;  |HAZ Entero;
     CantiNum = #17#22;  |HAZ Entero;
     CantiNum = #17#12;  |HAZ Entero;
     CantiNum = #17#23;  |HAZ Entero;
     CantiNum = #17#13;  |HAZ Entero;
     CantiNum = #17#24;  |HAZ Entero;
     CantiNum = #17#14;  |HAZ Entero;
     CantiNum = #17#25;  |HAZ Entero;
     CantiNum = #17#15;  |HAZ Entero;
     CantiNum = #17#26;  |HAZ Entero;
     CantiNum = #17#16;  |HAZ Entero;
     CantiNum = #17#17;  |HAZ Entero;
     CantiNum = #17#27;  |HAZ Entero;
     CantiNum = #17#18;  |HAZ Entero;
     CantiNum = #17#28;  |HAZ Entero;

     CantiNum = #71#2;   |HAZ Entero;
     CantiNum = #71#3;   |HAZ Entero;
     |SI #71#4 = " ";  #71#4 = "0";  |FINSI;
     Valfa    = #71#4;   |HAZ GrabaSecuencial;
     CantiNum = #71#5;   |HAZ Entero;
     CantiNum = #71#6;   |HAZ Entero;
     |SI #71#7 = " ";  #71#7 = "0";  |FINSI;
     Valfa    = #71#7;   |HAZ GrabaSecuencial;
     CantiNum = #71#8;   |HAZ Entero;
     CantiNum = #71#9;   |HAZ Entero;
     Valfa    = #71#10;  |HAZ GrabaSecuencial;
     CantiNum = #71#11;  |HAZ Entero;
     Valfa    = #71#12;  |HAZ GrabaSecuencial;
     CantiNum = #71#13;  |HAZ Entero;

     CantiNum = #14#117; |HAZ Entero;
     CantiNum = #14#118; |HAZ Entero;
     CantiNum = #14#119; |HAZ Entero;
     CantiNum = #14#120; |HAZ Entero;
     CantiNum = #14#121; |HAZ Entero;
     CantiNum = #14#122; |HAZ Entero;

     CantiNum = #14#108; |HAZ Decimal;
     CantiNum = #14#109; |HAZ Decimal;
     CantiNum = #14#110; |HAZ Decimal;
     CantiNum = #14#111; |HAZ Decimal;
     CantiNum = #14#107; |HAZ Decimal;

     Valfa = &13 + &10;
     |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial11;
     |HAZ AbreSecuencial;

     |SI aGuiri = "N";
         Valfa = "201";                                        |HAZ GrabaSecuencial;
     |SINO;
         Valfa = "206";                                        |HAZ GrabaSecuencial;
     |FINSI;

     Valfa = "11";                                         |HAZ GrabaSecuencial;
     Valfa = " ";                                          |HAZ GrabaSecuencial;

     Valfa = #100#10;              |HAZ GrabaSecuencial;
     Valfa = #100#5;               |HAZ GrabaSecuencial;
     Valfa = #100#6;               |HAZ GrabaSecuencial;
     Valfa = "99";                 |HAZ GrabaSecuencial;
     Valfa = #100#7;               |HAZ GrabaSecuencial;
     Valfa = #100#8;               |HAZ GrabaSecuencial;
     Valfa = #100#9  % -102;       |HAZ GrabaSecuencial;

     |PARA ZPara = 14;  |SI ZPara [ 21;  |HACIENDO ZPara = ZPara + 1;
           Valfa = #100ZPara;
           |HAZ GrabaSecuencial;
     |SIGUE;

     Valfa = #100#23;               |HAZ GrabaSecuencial;
     Valfa = #100#24;               |HAZ GrabaSecuencial;

     CantiNum = #14#41;  |HAZ Entero;
     CantiNum = #14#50;  |HAZ Entero;
     CantiNum = #14#105; |HAZ Entero;
     CantiNum = #14#106; |HAZ Entero;

     CantiNum = #14#105;
     |SI CantiNum > 0;
         CantiNum = 0;
     |SINO;
         CantiNum = -CantiNum;
     |FINSI;
     |HAZ Entero;

     Valfa = #100#82;     |HAZ GrabaSecuencial;
     Valfa = #100#83;     |HAZ GrabaSecuencial;
     Valfa = #100#84;     |HAZ GrabaSecuencial;
     Valfa = #100#85;     |HAZ GrabaSecuencial;
     Valfa = #100#86;     |HAZ GrabaSecuencial;
     Valfa = #100#87;     |HAZ GrabaSecuencial;
     Valfa = #100#88;     |HAZ GrabaSecuencial;
     Valfa = #100#89;     |HAZ GrabaSecuencial;

     CantiNum = #14#105;
     |SI CantiNum < 0; CantiNum = 0;  |FINSI;
     |HAZ Entero;

     Valfa = #100#90;        |HAZ GrabaSecuencial;
     Valfa = #100#91;        |HAZ GrabaSecuencial;
     Valfa = #100#92;        |HAZ GrabaSecuencial;
     Valfa = #100#93;        |HAZ GrabaSecuencial;
     Valfa = #100#63 % 125;  |HAZ GrabaSecuencial;
     Valfa = #100#64;        |HAZ GrabaSecuencial;
     Valfa = #100#65;        |HAZ GrabaSecuencial;
     Valfa = #100#66;        |HAZ GrabaSecuencial;
     Valfa = &13 + &10;      |HAZ GrabaSecuencial;

     |HAZ CierraSecuencial;
|FPRC;

|PROCESO Secuencial;
     |SI NombreInf = "9920101";  |HAZ Secuencial01;  |ACABA;  |FINSI;
     |SI NombreInf = "9920102";  |HAZ Secuencial02;  |ACABA;  |FINSI;
     |SI NombreInf = "9920103";  |HAZ Secuencial03;  |ACABA;  |FINSI;
     |SI NombreInf = "9920104";  |HAZ Secuencial04;  |ACABA;  |FINSI;
     |SI NombreInf = "9920105";  |HAZ Secuencial05;  |ACABA;  |FINSI;
     |SI NombreInf = "9920106";  |HAZ Secuencial06;  |ACABA;  |FINSI;
     |SI NombreInf = "9920107";  |HAZ Secuencial07;  |ACABA;  |FINSI;
     |SI NombreInf = "9920108";  |HAZ Secuencial08;  |ACABA;  |FINSI;
     |SI NombreInf = "9920109";  |HAZ Secuencial09;  |ACABA;  |FINSI;
     |SI NombreInf = "9920110";  |HAZ Secuencial10;  |ACABA;  |FINSI;
     |SI NombreInf = "9920111";  |HAZ Secuencial11;  |ACABA;  |FINSI;
|FPRC;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|PROCESO Impresion;
     |SI Hojas2 = "1";  |HAZ Secuencial;  |ACABA;  |FINSI;

     |SI Hojas2 = "2";
         NombreInf = "h" + NombreInf;
         |INFOR NombreInf;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |PRINT;   |PIEINF;   |FININF;
         |ACABA;
     |FINSI;

     |ET Comienzo;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         NombreInf = "m" + NombreInf;
         Valfa     = NombreInf % -102;

         |SI Valfa ! "11";
             #90#2 = "COLOQUE HOJA " + Valfa + " DEL MODELO 201, <INTRO PARA IMPRIMIR>";
         |SINO;
             |SI aGuiri = "N";
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 201, <INTRO PARA IMPRIMIR>";
             |SINO;
                 #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 206, <INTRO PARA IMPRIMIR>";
             |FINSI;
         |FINSI;

         |ATRI P; |PINTA #90#2; |ATRI 0;
         |PAUSA;

         |INFOR NombreInf;
         |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

         |PRINT; |PIEINF; |FININF;  |FINIMP;

         |CONFI "2400NDesea repetir la hoja : ";
         |SI FSalida = 0;  |VETE Comienzo;  |FINSI;
|FPRC;

|DEFBUCLE isw00025;
     #101#1;
     ;
     DesdeClav;
     HastaClav;
     ;
     NULL, Impresion;
|FIN;

|DEFBUCLE isw00019;
     #102#1;
     ;
     DesdeClav;
     HastaClav;
     ;
     NULL, Impresion;
|FIN;

|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO Hoja1;
     #100#2  = #706#2;                   || Delegacion
     #100#3  = #706#3;                   || Administracion
     #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
     #100#5  = #2#31 % 102;            || Del Dia
     #100#6  = #2#31 % 402;            || Del Mes
     #100#7  = #2#32 % 102;            || Al Dia
     #100#8  = #2#32 % 402;            || Al Mes
     #100#9  = #2#32 % -104;           || Al A¤o
     #100#10 = #2#16 % -101;           || Ejercicio
     |SI #0#55 = 1;
         #100#11 = #2#17 % 102;            || CNAE
     |SINO;
         #100#11 = #2#17 % -102;           || CNAE
     |FINSI;
     #100#12 = #2#3;                   || NIF
     #100#13 = #2#2;                   || Nombre
     #100#14 = #2#4;                   || SG
     #100#15 = #2#5;                   || Domicilio
     #100#16 = #2#6;                   || Numero
     #100#17 = #2#7;                   || Escalera
     #100#18 = #2#8;                   || Piso
     #100#19 = #2#9;                   || Puerta
     #100#20 = #2#15;                  || Telefono
     #100#21 = #2#13;                  || Municipio
     #100#22 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
     #100#24 = #100#23 + #100#22;      || Codigo Postal Entero
     |SI #2#98 = "S";  #100#25 = "X";  |FINSI;   || Es Complementaria
     Valfa1  = #2#99;  |QBT Valfa1;
     Valfa2  = #2#100; |QBT Valfa2;
     #100#26 = ("0000000000000" + Valfa1 + Valfa2) % -113;  || N§ Justificante

     |ABRE #4;
     |PARA ZPara = 27;  |SI ZPara [ 55;  |HACIENDO ZPara = ZPara + 1;
           ZPara1 = ZPara - 26;
           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = ZPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #100ZPara = "X";
               |SI ZPara1 = 9;  |O ZPara1 = 10;
                   |SI #100#56 = 0;  #100#56 = #4#4;  |FINSI;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     #100#57 = #2#75;                         || Empleados no fijos
     #100#58 = #2#76;                         || Empleados si fijos
     #100#59 = " ";
     |SI #2#34 = "S";  #100#59 = "X";  |FINSI;   || Renuncia
     #100#60 = #2#77;                            || Nombre Secretario
     #100#61 = #2#78;                            || NIF    Secretario
     #100#62 = #2#77;                            || Nombre Secretario
     #100#63 = #2#13;                            || Poblacion firma
     #100#64 = Dia;                              || Dia
     #100#65 = Mes;                              || Mes
     #100#66 = Ejerc;                            || A¤o

     ContaBucle = 0;    |BUCLE maempr04;

     NombreInf = "9920101";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja2;
     |ABRE #101;

     |DDEFECTO #101;
     #101#0 = 1;

     #101#1 = #1#3;
     #101#2 = #1#2;

     |GRABA 140#101b;

     ContaBucle = 0;    |BUCLE maempr03;
     ContaBucle = 0;    |BUCLE maempr06;
     ContaBucle = 0;    |BUCLE maempr02;
     ContaBucle = 0;    |BUCLE maempr14;
     ContaBucle = 0;    |BUCLE maempr15;

     |CIERRA #101;

     NombreInf = "9920102";

     |SI Hojas2 = "1";  DesdeClav = 01;  HastaClav = 99;  |FINSI;
     |SI Hojas2 ! "1";  DesdeClav = 01;  HastaClav = 01;  |FINSI;

     |BUCLE isw00025;

     |ABRE #101;  |CIERRA #101;  |DELINDEX #101;
|FPRC;

|PROCESO Hoja3;
     |ABRE #102;

     |DDEFECTO #102;
     #102#0 = 1;

     #102#1 = #1#3;
     #102#2 = #1#2;

     |ABRE #4;
     |PARA ZPara = 4;  |SI ZPara [ 6;  |HACIENDO ZPara = ZPara + 1;
           ZPara1 = ZPara + 63;
           #4#0 = #1#0;
           #4#1 = #1#1;
           #4#2 = ZPara1;
           |LEE 040#4=;
           |SI FSalida = 0;
               #102ZPara = "X";
           |FINSI;
     |SIGUE;
     |CIERRA #4;

     |PARA ZPara = 7;  |SI ZPara [ 37;  |HACIENDO ZPara = ZPara + 1;
           ZPara1    = ZPara - 5;
           #102ZPara = #11ZPara1;
     |SIGUE;

     |GRABA 140#102b;
     |LIBERA #102;

     ContaBucle = 0;    |BUCLE maempr05;

     |CIERRA #102;

     NombreInf = "9920103";

     |SI Hojas2 = "1";  DesdeClav = 01;  HastaClav = 99;  |FINSI;
     |SI Hojas2 ! "1";  DesdeClav = 01;  HastaClav = 01;  |FINSI;

     |BUCLE isw00019;

     |ABRE #102;  |CIERRA #102;  |DELINDEX #102;
|FPRC;

|PROCESO Hoja4;
     NombreInf = "9920104";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5;
     NombreInf = "9920105";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja6;
     NombreInf = "9920106";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja7;
     NombreInf = "9920107";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja8;
     |ABRE #19;
     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 547;
     |LEE 040#19=;
     |SI FSalida = 0;
         #104#01 = #19#4;   #104#02 = #19#9;   #104#03 = #19#15;  #104#04 = #19#21;
         #104#05 = #19#5;   #104#06 = #19#10;  #104#07 = #19#16;  #104#08 = #19#22;
         #104#09 = #19#6;   #104#10 = #19#11;  #104#11 = #19#17;  #104#12 = #19#23;
         #104#13 = #19#7;   #104#14 = #19#12;  #104#15 = #19#18;  #104#16 = #19#24;
         #104#17 = #19#8;   #104#18 = #19#13;  #104#19 = #19#19;  #104#20 = #19#25;
         #104#21 = #19#27;  #104#22 = #19#28;  #104#23 = #19#29;  #104#24 = #19#30;
         #104#25 = #19#31;  #104#26 = #19#32;  #104#27 = #19#33;  #104#28 = #19#34;
                            #104#29 = #19#14;  #104#30 = #19#20;  #104#31 = #19#26;
     |FINSI;

     #19#0 = #1#0;
     #19#1 = #1#1;
     #19#2 = 561;
     |LEE 040#19=;
     |SI FSalida = 0;
         #104#32 = #19#4;   #104#33 = #19#9;   #104#34 = #19#15;  #104#35 = #19#21;
         #104#36 = #19#5;   #104#37 = #19#10;  #104#38 = #19#16;  #104#39 = #19#22;
         #104#40 = #19#6;   #104#41 = #19#11;  #104#42 = #19#17;  #104#43 = #19#23;
         #104#44 = #19#7;   #104#45 = #19#12;  #104#46 = #19#18;  #104#47 = #19#24;
         #104#48 = #19#8;   #104#49 = #19#13;  #104#50 = #19#19;  #104#51 = #19#25;
         #104#52 = #19#27;  #104#53 = #19#28;  #104#54 = #19#29;  #104#55 = #19#30;
         #104#56 = #19#31;  #104#57 = #19#32;  #104#58 = #19#33;  #104#59 = #19#34;
                            #104#60 = #19#14;  #104#61 = #19#20;  #104#62 = #19#26;
     |FINSI;
     |CIERRA #19;

     NombreInf = "9920108";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja9;
     NombreInf = "9920109";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja10;
     NombreInf = "9920110";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja11;
     #100#2  = #706#2;                   || Delegacion
     #100#3  = #706#3;                   || Administracion
     #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
     #100#5  = #2#31 % 102;            || Del Dia
     #100#6  = #2#31 % 402;            || Del Mes
     #100#7  = #2#32 % 102;            || Al Dia
     #100#8  = #2#32 % 402;            || Al Mes
     #100#9  = #2#32 % -104;           || Al A¤o
     #100#10 = #2#16 % -101;           || Ejercicio
     |SI #0#55 = 1;
         #100#11 = #2#17 % 102;            || CNAE
     |SINO;
         #100#11 = #2#17 % -102;           || CNAE
     |FINSI;

     #100#12 = #2#3;                   || NIF
     #100#13 = #2#2;                   || Nombre
     #100#14 = #2#4;                   || SG
     #100#15 = #2#5;                   || Domicilio
     #100#16 = #2#6;                   || Numero
     #100#17 = #2#7;                   || Escalera
     #100#18 = #2#8;                   || Piso
     #100#19 = #2#9;                   || Puerta
     #100#20 = #2#15;                  || Telefono
     #100#21 = #2#13;                  || Municipio
     #100#22 = ("000" + #2#11) % -103; || Codigo Municipio
     #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
     #100#24 = #100#23 + #100#22;      || Codigo Postal Entero
     #100#63 = #2#13;                  || Poblacion firma
     #100#64 = Dia;                    || Dia
     #100#65 = Mes;                    || Mes
     #100#66 = Ejerc;                  || A¤o

     |SI #14#105 < 0;
         |SI #2#34 = "S";
             #100#82 = "X";
         |SINO;
             #100#83 = "X";
         |FINSI;
     |FINSI;

     enCodCli = #1#0;
     |HAZ LeePersona;
     |SI enSwDeDonde = 1;
         |SI #2#34 = "N"; |Y #14#105 < 0; |Y  #0#57 ! "N";
             enModelo = 201;  enForzar = 1;  |HAZ CogeDatosBancos;

             #100#84 = eaEntidad;
             #100#85 = eaOficina;
             #100#86 = eaDC;
             #100#87 = eaCuenta;
         |SINO;
             #100#84 = #715#81;
             #100#85 = #715#82;
             #100#86 = #715#83;
             #100#87 = #715#84 % 110;
         |FINSI;
     |FINSI;

     |SI #14#105 > 0;
         |SI #0#57 = "T";
             #100#89 = "X";
         |SINO;
             #100#88 = "X";
         |FINSI;
     |FINSI;

     |SI #14#105 > 0;
         |SI #0#57 = "T";
             |SI enSwDeDonde = 1;
                 enModelo = 201;  enForzar = 1;  |HAZ CogeDatosBancos;

                 #100#90 = eaEntidad;
                 #100#91 = eaOficina;
                 #100#92 = eaDC;
                 #100#93 = eaCuenta;
             |SINO;
                 #100#90 = #715#81;
                 #100#91 = #715#82;
                 #100#92 = #715#83;
                 #100#93 = #715#84 % 110;
             |FINSI;
         |FINSI;
     |FINSI;

     NombreInf = "9920111";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja12;
     |SI Hojas2 ! "2";  |ACABA;  |FINSI;
     NombreInf = "9620099";  |HAZ Impresion;
|FPRC;

|PROCESO NombreSecuencial;
     Directorio = "";
     |DBASE Directorio;
     Directorio = Directorio + "hacienda";
     |MKDIR Directorio;
     Directorio = Directorio + "/";
     Valfa = Raiz + "bin/agichmod 777 " + Directorio;  |SYSTEM Valfa;

     Fichero = "201" + (("00000" + #99#0) % -105);

     INEmpresas = NEmpresas1 <-;
     INEmpresas = INEmpresas + NCopia;
     NEmpresas  = Directorio + Fichero;
     Tempo      = NEmpresas;
     |FBORRA Tempo;
|FPRC;

|PROCESO ImprimeLos;
     |PINPA #0#90;
     #90#0 = #99#0;  |PINTA #90#0;
     #90#1 = #99#3;  |PINTA #90#1;

     |PARA YPara = 1; |SI YPara [ #99#4; |HACIENDO YPara = YPara + 1;
           |SI NCopia > 800; |SAL;  |FINSI;

           |HAZ Defectos;
           #90#3 = YPara;  |PINTA #90#3;
           |HAZ LeeFich;

           |SI Hojas2 = "1";  |HAZ NombreSecuencial;  |FINSI;

           |SI #0#38 = "S"; |HAZ Hoja1;  |FINSI;   || h9920101
           |SI #0#39 = "S"; |HAZ Hoja2;  |FINSI;   || h9920102
           |SI #0#40 = "S"; |HAZ Hoja3;  |FINSI;   || h9920103
           |SI #0#41 = "S"; |HAZ Hoja4;  |FINSI;   || h9920104
           |SI #0#42 = "S"; |HAZ Hoja5;  |FINSI;   || h9920105
           |SI #0#43 = "S"; |HAZ Hoja6;  |FINSI;   || h9920106
           |SI #0#44 = "S"; |HAZ Hoja7;  |FINSI;   || h9920107
           |SI #0#45 = "S"; |HAZ Hoja8;  |FINSI;   || h9920108
           |SI #0#46 = "S"; |HAZ Hoja9;  |FINSI;   || h9920109
           |SI #0#47 = "S"; |HAZ Hoja10; |FINSI;   || h9920110
           |SI aGuiri = "N";
                |SI #0#48 = "S"; |HAZ Hoja11; |FINSI;   || h9920111
                |SI #0#49 = "S"; |HAZ Hoja12; |FINSI;   || h9620099  Hoja en Blanco
           |SINO;
                |SI #0#48 = "S"; |HAZ Hoja12; |FINSI;   || h9620099  Hoja en Blanco
                |SI #0#49 = "S"; |HAZ Hoja11; |FINSI;   || h9920111
           |FINSI;

           |SI #0#54 = "S"; |HAZ Hoja12; |FINSI;   || h9620099  Hoja en Blanco

           NCopia = NCopia + 1;
     |SIGUE;
|FPRC;

|DEFBUCLE rew00001;
     #99#1;
     5;
     00000, "S";
     99999, "S";
     ;
     NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
     |MENUG Hojas;
     Hojas2 = FSalida;
     |SI Hojas2 ! "1"; |Y Hojas2 ! "2";  |Y Hojas2 ! "3";  |ACABA; |FINSI;
     |SI Hojas2 = "1";
         #0#58 = "PESETAS";
         |PINTA #0#58;
     |FINSI;

     Dia   = #0#33 % 102;
     Mes   = #0#33 % 402;
     Ejerc = #0#33 % -104;

     |SI Mes = "01"; Mes = "ENERO     "; |FINSI;
     |SI Mes = "02"; Mes = "FEBRERO   "; |FINSI;
     |SI Mes = "03"; Mes = "MARZO     "; |FINSI;
     |SI Mes = "04"; Mes = "ABRIL     "; |FINSI;
     |SI Mes = "05"; Mes = "MAYO      "; |FINSI;
     |SI Mes = "06"; Mes = "JUNIO     "; |FINSI;
     |SI Mes = "07"; Mes = "JULIO     "; |FINSI;
     |SI Mes = "08"; Mes = "AGOSTO    "; |FINSI;
     |SI Mes = "09"; Mes = "SEPTIEMPRE"; |FINSI;
     |SI Mes = "10"; Mes = "OCTUBRE   "; |FINSI;
     |SI Mes = "11"; Mes = "NOVIEMBRE "; |FINSI;
     |SI Mes = "12"; Mes = "DICIEMBRE "; |FINSI;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
     #99#0 = #1#0;
     #99#1 = "";
     #99#2 = "";
     #99#3 = #1#2;
     #99#4 = #0#37;
     #99#5 = "S";
     #99#6 = 1;
     #99#7 = #1#3;
     |GRABA 040#99n;

     SwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
     #1#1;
     4;
     #0#56, DEmpre, "A";
     #0#56, HEmpre, "A";
     ;
     NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
     #99#0 = 1;
|FRUT;

|RUTINA superior;
     #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
     Fichero = ("01" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #99 Fichero;
     |ABRE #99; |CIERRA #99; |DELINDEX #99;

     |ABRE #99;
     SwHay = 0;
     |SI #0#0 = "S";
         DEmpre = #0#1;
         HEmpre = #0#2;
         |BUCLE isacceso;
     |SINO;
         |PARA YPara = 3; |SI YPara [ 32; |HACIENDO YPara = YPara + 1;
               |SI #0YPara ! 0;
                   DEmpre = #0YPara;
                   HEmpre = #0YPara;
                   |BUCLE isacceso;
               |FINSI;
         |SIGUE;
     |FINSI;
     |CIERRA #99;

     |SI SwHay = 0; |ACABA; |FINSI;

     |SI #0#35 = "N"; |ACABA; |FINSI;

     |ENTLINEAL #1#99, 1, 4, 22, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
     |SI FSalida ! 10; |ACABA; |FINSI;

     |LIBERA #99;
     |LEE 140#99=;

     |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
     |PINTA #99#5;
     |GRABA 140#99a;
|FPRC;

|PROCESO CargaTabla;
     Fichero = ("02" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #999 Fichero;

     |ABRE #999;  |CIERRA #999;  |DELINDEX #999;
     |ABRE #999;

     |PARA ZPara = 101; |SI ZPara [ 190; |HACIENDO ZPara = ZPara + 1;
           #999#0 = ZPara;  #999#1 = "N";  #999#2 = 0;

           |SI ZPara [ 111;                 ZPara1  = ZPara - 98;   |FINSI;
           |SI ZPara = 114;                 ZPara1  = 14;           |FINSI;
           |SI ZPara ] 120; |Y ZPara [ 126; ZPara1  = ZPara - 105;  |FINSI;
           |SI ZPara ] 134; |Y ZPara [ 143; ZPara1  = ZPara - 112;  |FINSI;
           |SI ZPara ] 154; |Y ZPara [ 173; ZPara1  = ZPara - 122;  |FINSI;
           |SI ZPara ] 175; |Y ZPara [ 183; ZPara1  = ZPara - 123;  |FINSI;
           |SI ZPara ] 185; |Y ZPara [ 186; ZPara1  = ZPara - 124;  |FINSI;
           |SI ZPara ] 188; |Y ZPara [ 190; ZPara1  = ZPara - 125;  |FINSI;

           #999#2 = ZPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA ZPara = 201; |SI ZPara [ 273; |HACIENDO ZPara = ZPara + 1;
           #999#0 = ZPara;  #999#1 = "N";  #999#2 = 0;

           |SI ZPara [ 202;                 ZPara1  = ZPara - 135;  |FINSI;
           |SI ZPara = 203;                 ZPara1  = 194;          |FINSI;
           |SI ZPara ] 204; |Y ZPara [ 209; ZPara1  = ZPara - 136;  |FINSI;
           |SI ZPara ] 211; |Y ZPara [ 213; ZPara1  = ZPara - 137;  |FINSI;
           |SI ZPara ] 215; |Y ZPara [ 217; ZPara1  = ZPara - 138;  |FINSI;
           |SI ZPara = 218;                 ZPara1  = 195;          |FINSI;
           |SI ZPara ] 220; |Y ZPara [ 225; ZPara1  = ZPara - 140;  |FINSI;
           |SI ZPara ] 227; |Y ZPara [ 246; ZPara1  = ZPara - 141;  |FINSI;
           |SI ZPara ] 248; |Y ZPara [ 248; ZPara1  = ZPara - 142;  |FINSI;
           |SI ZPara ] 251; |Y ZPara [ 256; ZPara1  = ZPara - 144;  |FINSI;
           |SI ZPara ] 258; |Y ZPara [ 273; ZPara1  = ZPara - 145;  |FINSI;

           #999#2 = ZPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA ZPara = 301; |SI ZPara [ 351; |HACIENDO ZPara = ZPara + 1;
           #999#0 = ZPara;  #999#1 = "N";  #999#2 = 0;

           |SI ZPara ] 301; |Y ZPara [ 315; ZPara1  = ZPara - 172;   |FINSI;
           |SI ZPara ] 312; |Y ZPara [ 314; ZPara1  = ZPara - 178;   |FINSI;
           |SI ZPara ] 320; |Y ZPara [ 323; ZPara1  = ZPara - 183;   |FINSI;
           |SI ZPara ] 326; |Y ZPara [ 330; ZPara1  = ZPara - 185;   |FINSI;
           |SI ZPara ] 333; |Y ZPara [ 337; ZPara1  = ZPara - 187;   |FINSI;
           |SI ZPara ] 340; |Y ZPara [ 351; ZPara1  = ZPara - 189;   |FINSI;

           #999#2 = ZPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     |PARA ZPara = 401; |SI ZPara [ 441; |HACIENDO ZPara = ZPara + 1;
           #999#0 = ZPara;  #999#1 = "N";  #999#2 = 0;

           |SI ZPara = 408;                 ZPara1  = 163;          |FINSI;
           |SI ZPara ] 403; |Y ZPara [ 407; ZPara1  = ZPara - 239;  |FINSI;
           |SI ZPara ] 410; |Y ZPara [ 413; ZPara1  = ZPara - 241;  |FINSI;
           |SI ZPara ] 416; |Y ZPara [ 419; ZPara1  = ZPara - 243;  |FINSI;
           |SI ZPara ] 422; |Y ZPara [ 425; ZPara1  = ZPara - 245;  |FINSI;
           |SI ZPara ] 428; |Y ZPara [ 432; ZPara1  = ZPara - 247;  |FINSI;
           |SI ZPara ] 434; |Y ZPara [ 441; ZPara1  = ZPara - 248;  |FINSI;

           #999#2 = ZPara1;  |GRABA 140#999n;  |LIBERA #999;
     |SIGUE;

     #999#0 = 101;  #999#1 = "A";  #999#2 = 1;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 102;  #999#1 = "A";  #999#2 = 2;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 114;  #999#1 = "A";  #999#2 = 3;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 134;  #999#1 = "A";  #999#2 = 4;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 154;  #999#1 = "A";  #999#2 = 5;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 155;  #999#1 = "A";  #999#2 = 6;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 156;  #999#1 = "A";  #999#2 = 7;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 157;  #999#1 = "A";  #999#2 = 8;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 158;  #999#1 = "A";  #999#2 = 9;  |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 166;  #999#1 = "A";  #999#2 = 10; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 175;  #999#1 = "A";  #999#2 = 11; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 185;  #999#1 = "A";  #999#2 = 12; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 186;  #999#1 = "A";  #999#2 = 13; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 188;  #999#1 = "A";  #999#2 = 14; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 189;  #999#1 = "A";  #999#2 = 15; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 190;  #999#1 = "A";  #999#2 = 16; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 201;  #999#1 = "A";  #999#2 = 17; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 202;  #999#1 = "A";  #999#2 = 18; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 203;  #999#1 = "A";  #999#2 = 69; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 204;  #999#1 = "A";  #999#2 = 19; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 210;  #999#1 = "A";  #999#2 = 20; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 214;  #999#1 = "A";  #999#2 = 21; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 215;  #999#1 = "A";  #999#2 = 22; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 216;  #999#1 = "A";  #999#2 = 23; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 217;  #999#1 = "A";  #999#2 = 24; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 218;  #999#1 = "A";  #999#2 = 70; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 220;  #999#1 = "A";  #999#2 = 25; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 225;  #999#1 = "A";  #999#2 = 26; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 231;  #999#1 = "A";  #999#2 = 27; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 248;  #999#1 = "A";  #999#2 = 28; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 271;  #999#1 = "A";  #999#2 = 29; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 272;  #999#1 = "A";  #999#2 = 30; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 273;  #999#1 = "A";  #999#2 = 31; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 306;  #999#1 = "A";  #999#2 = 33; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 312;  #999#1 = "A";  #999#2 = 34; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 313;  #999#1 = "A";  #999#2 = 35; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 314;  #999#1 = "A";  #999#2 = 36; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 320;  #999#1 = "A";  #999#2 = 37; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 326;  #999#1 = "A";  #999#2 = 38; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 333;  #999#1 = "A";  #999#2 = 39; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 340;  #999#1 = "A";  #999#2 = 40; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 341;  #999#1 = "A";  #999#2 = 41; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 342;  #999#1 = "A";  #999#2 = 42; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 343;  #999#1 = "A";  #999#2 = 43; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 344;  #999#1 = "A";  #999#2 = 44; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 345;  #999#1 = "A";  #999#2 = 45; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 346;  #999#1 = "A";  #999#2 = 46; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 347;  #999#1 = "A";  #999#2 = 47; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 348;  #999#1 = "A";  #999#2 = 48; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 349;  #999#1 = "A";  #999#2 = 49; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 350;  #999#1 = "A";  #999#2 = 50; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 351;  #999#1 = "A";  #999#2 = 51; |GRABA 140#999n;  |LIBERA #999;

     #999#0 = 405;  #999#1 = "A";  #999#2 = 57; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 414;  #999#1 = "A";  #999#2 = 58; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 415;  #999#1 = "A";  #999#2 = 59; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 433;  #999#1 = "A";  #999#2 = 60; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 434;  #999#1 = "A";  #999#2 = 61; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 435;  #999#1 = "A";  #999#2 = 62; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 436;  #999#1 = "A";  #999#2 = 63; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 437;  #999#1 = "A";  #999#2 = 64; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 438;  #999#1 = "A";  #999#2 = 65; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 439;  #999#1 = "A";  #999#2 = 66; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 440;  #999#1 = "A";  #999#2 = 67; |GRABA 140#999n;  |LIBERA #999;
     #999#0 = 441;  #999#1 = "A";  #999#2 = 68; |GRABA 140#999n;  |LIBERA #999;

     |CIERRA #999;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
     |HAZ PreparaInformes;

     enAnyo  = #0#56;
     nAnyo   = #0#56;

     Fichero = ("03" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #101 Fichero;

     Fichero = ("04" + Usuario + "zzzzzzzz") % 108;
     |NOME_DAT #102 Fichero;

     |HAZ TipoImpre;

     |SI Hojas2 ! "1"; |Y Hojas2 ! "2";  |Y Hojas2 ! "3";  |ACABA; |FINSI;

     |SI Hojas2 = "2";
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
     |FINSI;

     |HAZ CargaTabla;
     |HAZ CargaTempo;

     |SI SwHay = 0; |ACABA; |FINSI;

     |BUCLE rew00001;

     |SI Hojas2 = "1";  |HAZ CopiaDisco;  |FINSI;
     |SI Hojas2 = "2";  |FINIMP;  |FINSI;

     |ABRE #99;  |CIERRA #99;  |DELINDEX #99;
     |ABRE #999; |CIERRA #999; |DELINDEX #999;
|FPRC;
