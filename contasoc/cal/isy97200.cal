|FICHEROS;
     isy97200 #0;               || Este DEf
     isacceso #1;               || Acceso al impuesto

     maempr01 #2;               || Datos Empresas
     maempr11 #4;               || Caracteres de la Declaracion
     maempr04 #5;               || Representantes
     maempr03 #6;               || Administradores
     maempr06 #7;               || Otras Empresas
     maempr02 #8;               || Relacion de Socios
     maempr14 #9;               || Operaciones Paraisos Fiscales
     maempr15 #10;              || Tenencias   Paraisos Fiscales
     maempr05 #12;              || Socios Transparencia Fiscal
     maempr12 #20;              || Transparancia Fiscal
     maempr13 #21;              || Transparancia Fiscal

     isocie64 #11;              || Transparencia Fiscal
     isocie65 #13;              || Balances
     isocie59 #14;              || Liquidacion
     isocie58 #15;              || Distribucion de Resultados
     isocie66 #16;              || Resumen de Deducciones
     isocie60 #17;              || Cooperativas
     isocie63 #18;              || Por Doble imposicion
     isocie62 #19;              || Compensaciones
     isocie67 #22;              || Informacion adicional

     isw00007 #90;
     isw00008 #99,MANTE;
     isw00017 #100;             || Hoja  1
     isw00018 #101;             || Hoja  2
     isw00019 #102;             || Hoja  3
     isw00020 #104;             || Hoja 10
     isw00012 #103;             || Hoja 13

     &haciend@ #706;
|FIN;

|VARIABLES;
     ZPara       = 0;
     ZPara1      = 0;
     XPara       = 0;
     Dia         = "";
     Mes         = "";
     Ejerc       = "";
     SwHay       = 0;
     DEmpre      = 0;
     HEmpre      = 0;
     Fichero     = "";
     Valfa       = "";
     Valfa1      = "";
     Valfa2      = "";
     NombreInf   = "";
     NombreImpre = "";
     ContaBucle  = 0;
     ContaBucleL = 0;
     Puntero     = 0;
     CFBase      = "";
     CFAbre      = "";

     &enCodProv = 0;
     &enCodPobl = 0;

 {-1} Hojas      = "";
      Hojas1     = "2400";
      Hojas2     = "1";
      Hojas3     = "Elija impresion : ";
      Hojas4     = "CH";
      Hojas5     = "  papel Continuo  ";
      Hojas6     = "  papel Hoja a Hoja  ";
|FIN;

|| **************************************************************************
||                           PROCESOS DEL PROGRAMA
|| **************************************************************************

|PROCESO Seleccion; |TIPO 0;
  |SI #0#0 = "S";
      |CAMPO_MODIFICA #0#01, 1, "S";
      |CAMPO_MODIFICA #0#02, 1, "S";

      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            #0XPara = 0; |PINTA #0XPara;
            |CAMPO_MODIFICA #0XPara, 1, "N";
      |SIGUE;
  |SINO;
      #0#1 = 00001; |PINTA #0#1;    |CAMPO_MODIFICA #0#01, 1, "N";
      #0#2 = 99999; |PINTA #0#2;    |CAMPO_MODIFICA #0#02, 1, "N";

      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            |CAMPO_MODIFICA #0XPara, 1, "S";
      |SIGUE;
  |FINSI;
|FPRC;

|PROCESO Mayus;
  #0Campo = #0Campo > #0Campo;  |PINTA #0Campo;
|FPRC;

|| **************************************************************************
||                           PROCESOS LECTURAS DE FICHEROS
|| **************************************************************************

|PROCESO LeeFich;
  |ABRE #1;
  #1#0 = #99#0;
  #1#1 = #0#55;
  |LEE 040#1=;
  |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
  |CIERRA #1;

  |ABRE #2;
  #2#0 = #1#0;
  #2#1 = #1#1;
  |LEE 040#2=;
  |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
  |CIERRA #2;

  enCodProv = #2#29;
  enCodPobl = #2#30;
  |HAZ LeeHacienda;

  |ABRE #13;
  #13#0 = #1#0;
  #13#1 = #1#1;
  |LEE 040#13=;
  |SI FSalida ! 0; |DDEFECTO #13; |FINSI;
  |CIERRA #13;

  |ABRE #22;
  #22#0 = #1#0;
  #22#1 = #1#1;
  |LEE 040#22=;
  |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
  |CIERRA #22;

  |ABRE #11;
  #11#0 = #1#0;
  #11#1 = #1#1;
  |LEE 040#11=;
  |SI FSalida ! 0; |DDEFECTO #11; |FINSI;
  |CIERRA #11;

  |ABRE #14;
  #14#0 = #1#0;
  #14#1 = #1#1;
  |LEE 040#14=;
  |SI FSalida ! 0; |DDEFECTO #14; |FINSI;
  |CIERRA #14;

  |ABRE #15;
  #15#0 = #1#0;
  #15#1 = #1#1;
  |LEE 040#15=;
  |SI FSalida ! 0; |DDEFECTO #15; |FINSI;
  |CIERRA #15;

  |ABRE #16;
  #16#0 = #1#0;
  #16#1 = #1#1;
  |LEE 040#16=;
  |SI FSalida ! 0; |DDEFECTO #16; |FINSI;
  |CIERRA #16;

  |ABRE #17;
  #17#0 = #1#0;
  #17#1 = #1#1;
  |LEE 040#17=;
  |SI FSalida ! 0; |DDEFECTO #17; |FINSI;
  |CIERRA #17;

  |ABRE #18;
  #18#0 = #1#0;
  #18#1 = #1#1;
  |LEE 040#18=;
  |SI FSalida ! 0; |DDEFECTO #18; |FINSI;
  |CIERRA #18;
|FPRC;

|PROCESO Defectos;
  |DDEFECTO #100;
  |DDEFECTO #101;
  |DDEFECTO #102;
  |DDEFECTO #103;
  |DDEFECTO #104;
|FPRC;

|PROCESO Representante;
  ContaBucle = ContaBucle + 1;
  |SI ContaBucle = 1;
      #100#67 = #5#3 %  118;
      #100#68 = #5#3 %  1918;
      #100#69 = #5#4;
      #100#70 = #5#5;
      #100#71 = #5#6;
  |FINSI;

  |SI ContaBucle = 2;
      #100#72 = #5#3 %  118;
      #100#73 = #5#3 %  1918;
      #100#74 = #5#4;
      #100#75 = #5#5;
      #100#76 = #5#6;
  |FINSI;

  |SI ContaBucle = 3;
      #100#77 = #5#3 %  118;
      #100#78 = #5#3 %  1918;
      #100#79 = #5#4;
      #100#80 = #5#5;
      #100#81 = #5#6;
  |FINSI;
|FPRC;

|DEFBUCLE maempr04;
  #5#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, Representante;
|FIN;

|PROCESO PuntoA;
  |SI ContaBucle ] 6;
      #101#29 = "";
      #101#30 = "";
      #101#31 = "HOJA COMPLEMENTARIA";
      #101#32 = "";
      #101#33 = "";
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 5) + 4;  #101Puntero = #6#3;
  Puntero = Puntero + 1;           #101Puntero = #6#4;
  Puntero = Puntero + 1;           #101Puntero = #6#5;
  Puntero = Puntero + 1;           #101Puntero = #6#6;
  Puntero = Puntero + 1;           #101Puntero = #6#7;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr03;
  #6#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, PuntoA;
|FIN;

|PROCESO PuntoB1;
  |SI ContaBucle ] 6;
      #101#59 = "";
      #101#60 = "HOJA COMPLEMENTARIA";
      #101#61 = "";
      #101#62 = 0;
      #101#63 = "";
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 5) + 34; #101Puntero = #7#3;
  Puntero = Puntero + 1;           #101Puntero = #7#4;
  Puntero = Puntero + 1;           #101Puntero = #7#5;
  Puntero = Puntero + 1;           #101Puntero = #7#6;
  Puntero = Puntero + 1;           #101Puntero = #7#7;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr06;
  #7#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, PuntoB1;
|FIN;

|PROCESO PuntoB2;
  |SI ContaBucle ] 6;
      #101#99  = "";
      #101#100 = "";
      #101#101 = "";
      #101#102 = "HOJA COMPLEMENTARIA";
      #101#103 = "";
      #101#104 = 0;
      #101#105 = "";
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 7) + 64; #101Puntero = #8#3;
  Puntero = Puntero + 1;           #101Puntero = #8#9;
  Puntero = Puntero + 1;           #101Puntero = #8#4;
  Puntero = Puntero + 1;           #101Puntero = #8#5;
  Puntero = Puntero + 1;           #101Puntero = #8#6;
  Puntero = Puntero + 1;           #101Puntero = #8#7;
  Puntero = Puntero + 1;           #101Puntero = #8#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr02;
  #8#1;
  ;
  #1#0, #1#1, 000;
  #1#0, #1#1, 999;
  ;
  NULL, PuntoB2;
|FIN;

|PROCESO PuntoC1;
  |SI ContaBucle ] 6;
      #101#136 = "";
      #101#137 = "HOJA COMPLEMENTARIA";
      #101#138 = "";
      #101#139 = "";
      #101#140 = "";
      #101#141 = 0;
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 6) + 106; #101Puntero = #9#3;
  Puntero = Puntero + 1;            #101Puntero = #9#4;
  Puntero = Puntero + 1;            #101Puntero = #9#5;
  Puntero = Puntero + 1;            #101Puntero = #9#6;
  Puntero = Puntero + 1;            #101Puntero = #9#7;
  Puntero = Puntero + 1;            #101Puntero = #9#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr14;
  #9#1;
  ;
  #1#0, #1#1, 00, 00;
  #1#0, #1#1, 00, 99;
  ;
  NULL, PuntoC1;
|FIN;

|PROCESO PuntoC2;
  |SI ContaBucle ] 6;
      #101#178 = "";
      #101#179 = "HOJA COMPLEMENTARIA";
      #101#180 = "";
      #101#181 = "";
      #101#182 = 0;
      #101#183 = "";
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 6) + 148; #101Puntero = #10#3;
  Puntero = Puntero + 1;            #101Puntero = #10#4;
  Puntero = Puntero + 1;            #101Puntero = #10#6;
  Puntero = Puntero + 1;            #101Puntero = #10#5;
  Puntero = Puntero + 1;            #101Puntero = #10#7;
  Puntero = Puntero + 1;            #101Puntero = #10#8;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr15;
  #10#1;
  ;
  #1#0, #1#1, 00, 00;
  #1#0, #1#1, 00, 99;
  ;
  NULL, PuntoC2;
|FIN;

|PROCESO PuntoE;
  |SI ContaBucle ] 11;
      #102#115 = "";
      #102#116 = "";
      #102#117 = "";
      #102#118 = "";
      #102#119 = "HOJA COMPLEMENTARIA";
      #102#120 = "";
      #102#121 = 0;
      #102#122 = "";
      |ERROR10;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 8) + 35;  #102Puntero = #12#3;
  Puntero = Puntero + 1;            #102Puntero = #12#10;
  Puntero = Puntero + 1;            #102Puntero = #12#4;
  Puntero = Puntero + 1;            #102Puntero = #12#5;
  Puntero = Puntero + 1;            #102Puntero = #12#6;
  Puntero = Puntero + 1;            #102Puntero = #12#7;
  Puntero = Puntero + 1;            #102Puntero = #12#8;
  Puntero = Puntero + 1;            #102Puntero = #12#9;

  ContaBucle = ContaBucle + 1;
|FPRC;

|DEFBUCLE maempr05;
  #12#2;
  ;
  #1#0, #1#1, 999.99, 00;
  #1#0, #1#1,      0, 99;
  ;
  NULL, PuntoE;
|FIN;

|PROCESO El21;
  |SI ContaBucleL ] 5;
      Puntero = (ContaBucle * 24) - 2;  #103Puntero = "HOJA COMPLEMENTARIA";
      Puntero = Puntero + 1;            #103Puntero = "";
      Puntero = Puntero + 1;            #103Puntero = "";
      Puntero = Puntero + 1;            #103Puntero = #103Puntero + #21#7;
      |ACABA;
  |FINSI;

  Puntero = (((ContaBucle * 24) - 2) - 16) + (ContaBucleL * 4);
                                    #103Puntero = #21#4;
  Puntero = Puntero + 1;            #103Puntero = #21#5;
  Puntero = Puntero + 1;            #103Puntero = #21#6;
  Puntero = Puntero + 1;            #103Puntero = #21#7;

  ContaBucleL = ContaBucleL + 1;
|FPRC;

|DEFBUCLE maempr13;
  #21#1;
  ;
  #20#0, #20#1, #20#2, 00;
  #20#0, #20#1, #20#2, 99;
  ;
  NULL, El21;
|FIN;

|PROCESO El20;
  #103#146 = #103#146 + #20#6;
  |SI ContaBucle ] 6;
      #103#122 = "HOJA COMPLEMENTARIA";
      #103#123 = "";
      #103#124 = "";
      #103#125 = #103#125 + #20#6;

      |PARA ZPara = 125; |SI ZPara [ 142; |HACIENDO;
            ZPara = ZPara + 1;  #103ZPara = "";
            ZPara = ZPara + 1;  #103ZPara = "";
            ZPara = ZPara + 1;  #103ZPara = "";
            ZPara = ZPara + 1;  #103ZPara = 0;
      |SIGUE;
      |ACABA;
  |FINSI;

  Puntero = (ContaBucle * 24) + 2;  #103Puntero = #20#3;
  Puntero = Puntero + 1;            #103Puntero = #20#4;
  Puntero = Puntero + 1;            #103Puntero = #20#5;
  Puntero = Puntero + 1;            #103Puntero = #20#6;

  ContaBucle = ContaBucle + 1;

  ContaBucleL = 0;  |BUCLE maempr13;
|FPRC;

|DEFBUCLE maempr12;
  #20#1;
  ;
  #1#0, #1#1, 00;
  #1#0, #1#1, 99;
  ;
  NULL, El20;
|FIN;

|| **************************************************************************
||                           PROCESOS DE IMPRESION
|| **************************************************************************

|PROCESO Impresion;
  |SI Hojas2 = 1;
      NombreInf = "h" + NombreInf;
      |INFOR NombreInf;
      |SI FSalida ! 0;  |ACABA;  |FINSI;

      |PRINT;   |PIEINF;   |FININF;
      |ACABA;
  |FINSI;

  NombreInf = "m" + NombreInf;

  |ET Comienzo;
      CFBase    = "";
      |DIRECTORIO CFBase;

      Impresora = NombreImpre;
      CFAbre = Usuario % 810;
      CFAbre = CFBase + "/spool/" + CFAbre + ".spo";
      |FBORRA CFAbre;

      |PTEC 802;
      |PTEC 802;

      |IMPRE 0;
      |SI FSalida ! 0;
          |MENAV "      Problemas con impresora";
          |FINIMP;
          |VETE Comienzo;
      |FINSI;

      Valfa1 = NombreInf % -102;

      |SI Valfa1 ! "16";
          #90#2 = "COLOQUE HOJA " + Valfa1 + " DEL MODELO 200, <INTRO PARA IMPRIMIR>";
      |SINO;
          #90#2 = "COLOQUE HOJA INGRESO O DEVOLUCION DEL MODELO 200, <INTRO PARA IMPRIMIR>";
      |FINSI;

      |ATRI P; |PINTA #90#2; |ATRI 0;
      |PAUSA;

      |INFOR NombreInf;
      |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

      |PRINT; |PIEINF; |FININF;  |FINIMP;

      |CONFI "2400NDesea repetir la hoja : ";
      |SI FSalida = 0;  |VETE Comienzo;  |FINSI;
|FPRC;


|| **************************************************************************
||                           PROCESOS CARGA DE HOJAS
|| **************************************************************************

|PROCESO Hoja1;
  #100#2  = #706#2;                   || Delegacion
  #100#3  = #706#3;                   || Administracion
  #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
  #100#5  = #2#31 % 102;            || Del Dia
  #100#6  = #2#31 % 402;            || Del Mes
  #100#7  = #2#31 % -101;           || Del A¤o
  #100#8  = #2#32 % 102;            || Al Dia
  #100#9  = #2#32 % 402;            || Al Mes
  #100#10 = #2#32 % -101;           || Al A¤o
  #100#11 = #2#16 % -101;           || Ejercicio
  Valfa   = #2#17;  |QBF Valfa;
  #100#12 = Valfa % -102;           || CNAE
  #100#13 = #2#3;                   || NIF
  #100#14 = #2#2;                   || Nombre
  #100#15 = #2#4;                   || SG
  #100#16 = #2#5;                   || Domicilio
  #100#17 = #2#6;                   || Numero
  #100#18 = #2#7;                   || Escalera
  #100#19 = #2#8;                   || Piso
  #100#20 = #2#9;                   || Puerta
  #100#21 = #2#15;                  || Telefono
  #100#22 = #2#13;                  || Municipio
  #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
  #100#24 = #2#14;                  || Provincia
  #100#25 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);  || Codigo
  |SI #2#98 = "S";  #100#26 = "X";  |FINSI;   || Es Complementaria
  #100#27 = #2#99 + #2#100;         || N§ Justificante

  |ABRE #4;
  |PARA ZPara = 28;  |SI ZPara [ 55;  |HACIENDO ZPara = ZPara + 1;
        ZPara1 = ZPara - 27;
        #4#0 = #1#0;
        #4#1 = #1#1;
        #4#2 = ZPara1;
        |LEE 040#4=;
        |SI FSalida = 0;
            #100ZPara = "X";
            |SI ZPara1 = 9;  |O ZPara1 = 10;
                |SI #100#34 = 0;  #100#56 = #4#4;  |FINSI;
            |FINSI;
        |FINSI;
  |SIGUE;
  |CIERRA #4;

  #100#57 = #2#75;                         || Empleados no fijos
  #100#58 = #2#76;                         || Empleados si fijos
  #100#59 = " ";
  |SI #2#34 = "S";  #100#59 = "X";  |FINSI;   || Renuncia
  #100#60 = #2#77;                            || Nombre Secretario
  #100#61 = #2#78;                            || NIF    Secretario
  #100#62 = #2#77;                            || Nombre Secretario
  #100#63 = #2#13;                            || Poblacion firma
  #100#64 = Dia;                              || Dia
  #100#65 = Mes;                              || Mes
  #100#66 = Ejerc;                            || A¤o

  ContaBucle = 0;    |BUCLE maempr04;

  NombreInf = "9720001";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja2;
  #101#1 = #1#3;
  #101#2 = #1#2;

  ContaBucle = 0;    |BUCLE maempr03;
  ContaBucle = 0;    |BUCLE maempr06;
  ContaBucle = 0;    |BUCLE maempr02;
  ContaBucle = 0;    |BUCLE maempr14;
  ContaBucle = 0;    |BUCLE maempr15;

  NombreInf = "9720002";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja3;
  #102#1 = #1#3;
  #102#2 = #1#2;

  |PARA ZPara = 4;  |SI ZPara [ 34;  |HACIENDO ZPara = ZPara + 1;
        ZPara1    = ZPara - 2;
        #102ZPara = #11ZPara1;
  |SIGUE;

  ContaBucle = 0;    |BUCLE maempr05;

  NombreInf = "9720003";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja4;
  NombreInf = "972004a";  |HAZ Impresion;
  NombreInf = "972004b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja5;
  NombreInf = "972005a";  |HAZ Impresion;
  NombreInf = "972005b";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja6;
  NombreInf = "9720006";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja7;
  NombreInf = "9720007";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja8;
  NombreInf = "9720008";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja9;
  NombreInf = "9720009";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja10;
  |ABRE #19;
  #19#0 = #1#0;
  #19#1 = #1#1;
  #19#2 = 547;
  |LEE 040#19=;
  |SI FSalida = 0;
      #104#01 = #19#4;   #104#02 = #19#9;   #104#03 = #19#15;  #104#04 = #19#21;
      #104#05 = #19#5;   #104#06 = #19#10;  #104#07 = #19#16;  #104#08 = #19#22;
      #104#09 = #19#6;   #104#10 = #19#11;  #104#11 = #19#17;  #104#12 = #19#23;
      #104#13 = #19#7;   #104#14 = #19#12;  #104#15 = #19#18;  #104#16 = #19#24;
      #104#17 = #19#8;   #104#18 = #19#13;  #104#19 = #19#19;  #104#20 = #19#25;
      #104#21 = #19#27;  #104#22 = #19#28;  #104#23 = #19#29;  #104#24 = #19#30;
                         #104#29 = #19#14;  #104#30 = #19#20;  #104#31 = #19#26;
  |FINSI;

  #19#0 = #1#0;
  #19#1 = #1#1;
  #19#2 = 561;
  |LEE 040#19=;
  |SI FSalida = 0;
      #104#32 = #19#4;   #104#33 = #19#9;   #104#34 = #19#15;  #104#35 = #19#21;
      #104#36 = #19#5;   #104#37 = #19#10;  #104#38 = #19#16;  #104#39 = #19#22;
      #104#40 = #19#6;   #104#41 = #19#11;  #104#42 = #19#17;  #104#43 = #19#23;
      #104#44 = #19#7;   #104#45 = #19#12;  #104#46 = #19#18;  #104#47 = #19#24;
      #104#48 = #19#8;   #104#49 = #19#13;  #104#50 = #19#19;  #104#51 = #19#25;
      #104#52 = #19#27;  #104#53 = #19#28;  #104#54 = #19#29;  #104#55 = #19#30;
                         #104#60 = #19#14;  #104#61 = #19#20;  #104#62 = #19#26;
  |FINSI;
  |CIERRA #19;

  NombreInf = "9720010";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja11;
  NombreInf = "9720011";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja12;
  NombreInf = "9720012";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja13;
  #103#0 = #1#3;
  #103#1 = #1#2;
  ContaBucle = 0;  |BUCLE maempr12;
  NombreInf = "9720013";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja14;
  NombreInf = "9720014";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja15;
  NombreInf = "9720015";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja16;
  #100#2  = #706#2;                   || Delegacion
  #100#3  = #706#3;                   || Administracion
  #100#4  = (("00" + #706#0) % -102) + (("000" + #706#1) % -103);  || Codigo
  #100#5  = #2#31 % 102;            || Del Dia
  #100#6  = #2#31 % 402;            || Del Mes
  #100#7  = #2#31 % -101;           || Del A¤o
  #100#8  = #2#32 % 102;            || Al Dia
  #100#9  = #2#32 % 402;            || Al Mes
  #100#10 = #2#32 % -101;           || Al A¤o
  #100#11 = #2#16 % -101;           || Ejercicio
  #100#12 = #2#17;                  || CNAE
  #100#13 = #2#3;                   || NIF
  #100#14 = #2#2;                   || Nombre
  #100#15 = #2#4;                   || SG
  #100#16 = #2#5;                   || Domicilio
  #100#17 = #2#6;                   || Numero
  #100#18 = #2#7;                   || Escalera
  #100#19 = #2#8;                   || Piso
  #100#20 = #2#9;                   || Puerta
  #100#21 = #2#15;                  || Telefono
  #100#22 = #2#13;                  || Municipio
  #100#23 = ("00" + #2#10) % -102;  || Codigo Provincia
  #100#24 = #2#14;                  || Provincia
  #100#25 = (("00" + #2#10) % -102) + (("000" + #2#11) % -103);  || Codigo
  #100#63 = #2#13;                            || Poblacion firma
  #100#64 = Dia;                              || Dia
  #100#65 = Mes;                              || Mes
  #100#66 = Ejerc;                            || A¤o

  NombreInf = "9720016";  |HAZ Impresion;
|FPRC;

|PROCESO Hoja17;
  |SI Hojas2 ! 1;  |ACABA;  |FINSI;
  NombreInf = "9620099";  |HAZ Impresion;
|FPRC;

|PROCESO ImprimeLos;
  |PINPA #0#90;
  #90#0 = #99#0;  |PINTA #90#0;
  #90#1 = #99#3;  |PINTA #90#1;

  |PARA XPara = 1; |SI XPara [ #99#4; |HACIENDO XPara = XPara + 1;
        |HAZ Defectos;
        #90#3 = XPara;  |PINTA #90#3;
        |HAZ LeeFich;
        |SI #0#38 = "S"; |HAZ Hoja1;  |FINSI;   || h9720001
        |SI #0#39 = "S"; |HAZ Hoja2;  |FINSI;   || h9720002
        |SI #0#40 = "S"; |HAZ Hoja3;  |FINSI;   || h9720003
        |SI #0#41 = "S"; |HAZ Hoja4;  |FINSI;   || h9720004
        |SI #0#42 = "S"; |HAZ Hoja5;  |FINSI;   || h9720005
        |SI #0#43 = "S"; |HAZ Hoja6;  |FINSI;   || h9720006
        |SI #0#44 = "S"; |HAZ Hoja7;  |FINSI;   || h9720007
        |SI #0#45 = "S"; |HAZ Hoja8;  |FINSI;   || h9720008
        |SI #0#46 = "S"; |HAZ Hoja9;  |FINSI;   || h9720009
        |SI #0#47 = "S"; |HAZ Hoja10; |FINSI;   || h9720010
        |SI #0#48 = "S"; |HAZ Hoja11; |FINSI;   || h9720011
        |SI #0#49 = "S"; |HAZ Hoja12; |FINSI;   || h9720012
        |SI #0#50 = "S"; |HAZ Hoja13; |FINSI;   || h9720013
        |SI #0#51 = "S"; |HAZ Hoja14; |FINSI;   || h9720014
        |SI #0#52 = "S"; |HAZ Hoja15; |FINSI;   || h9720015
        |SI #0#53 = "S"; |HAZ Hoja16; |FINSI;   || h9720016
        |SI #0#54 = "S"; |HAZ Hoja17; |FINSI;   || h9620099  Hoja en Blanco
  |SIGUE;
|FPRC;

|DEFBUCLE rew00001;
  #99#1;
  5;
  00000, "S";
  99999, "S";
  ;
  NULL, ImprimeLos;
|FIN;

******************** Tipo de Impresion

|PROCESO TipoImpre;
  |MENU Hojas;
  Hojas2 = FSalida;
  |SI Hojas2 ! 1; |Y Hojas2 ! 2; |ACABA; |FINSI;

  Dia   = #0#33 % 102;
  Mes   = #0#33 % 402;
  Ejerc = #0#33 % -101;

  |SI Mes = "01"; Mes = "Enero     "; |FINSI;
  |SI Mes = "02"; Mes = "Febrero   "; |FINSI;
  |SI Mes = "03"; Mes = "Marzo     "; |FINSI;
  |SI Mes = "04"; Mes = "Abril     "; |FINSI;
  |SI Mes = "05"; Mes = "Mayo      "; |FINSI;
  |SI Mes = "06"; Mes = "Junio     "; |FINSI;
  |SI Mes = "07"; Mes = "Julio     "; |FINSI;
  |SI Mes = "08"; Mes = "Agosto    "; |FINSI;
  |SI Mes = "09"; Mes = "Septiembre"; |FINSI;
  |SI Mes = "10"; Mes = "Octubre   "; |FINSI;
  |SI Mes = "11"; Mes = "Noviembre "; |FINSI;
  |SI Mes = "12"; Mes = "Diciembre "; |FINSI;
|FPRC;

******************** Grabacion del Indexado a Imprimir

|PROCESO GrabaTempo;
  #99#0 = #1#0;
  #99#1 = "";
  #99#2 = "";
  #99#3 = #1#2;
  #99#4 = #0#37;
  #99#5 = "S";
  #99#6 = 1;
  #99#7 = #1#3;
  |GRABA 040#99n;

  SwHay = 1;
|FPRC;

|DEFBUCLE isacceso;
  #1#1;
  4;
  #0#55, DEmpre, "N";
  #0#55, HEmpre, "N";
  ;
  NULL, GrabaTempo;
|FIN;

|RUTINA inferior;
  #99#0 = 1;
|FRUT;

|RUTINA superior;
  #99#0 = 99999;
|FRUT;

|PROCESO CargaTempo;
  Fichero = ("01" + Usuario + "zzzzzzzz") % 108;
  |NOME_DAT #99 Fichero;
  |ABRE #99; |CIERRA #99; |DELINDEX #99;

  |ABRE #99;
  SwHay = 0;
  |SI #0#0 = "S";
      DEmpre = #0#1;
      HEmpre = #0#2;
      |BUCLE isacceso;
  |SINO;
      |PARA XPara = 3; |SI XPara [ 32; |HACIENDO XPara = XPara + 1;
            |SI #0XPara ! 0;
                DEmpre = #0XPara;
                HEmpre = #0XPara;
                |BUCLE isacceso;
            |FINSI;
      |SIGUE;
  |FINSI;
  |CIERRA #99;

  |SI SwHay = 0; |ACABA; |FINSI;

  |SI #0#35 = "N"; |ACABA; |FINSI;

  |ENTLINEAL #1#99, 1, 4, 19, 1, inferior, superior;
|FPRC;

******************** Proceso Marcar y Desmarcar el Entlineal

|PROCESO funcion1; |TIPO 11;
  |SI FSalida ! 9; |ACABA; |FINSI;

  |LIBERA #99;
  |LEE 140#99=;

  |SI #99#5 = "S"; #99#5 = "N"; |SINO; #99#5 = "S"; |FINSI;
  |PINTA #99#5;
  |GRABA 140#99a;
|FPRC;

|PROCESO Tipo3; |TIPO 3;
  |HAZ TipoImpre;     |SI Hojas2 ! 1; |Y Hojas2 ! 2; |ACABA; |FINSI;

  |HAZ PreparaInformes;

  |IMPRE 0;
  |SI FSalida ! 0; |ACABA; |FINSI;
  |SI Hojas2 = 2;
      NombreImpre = Impresora;
      |FINIMP;
  |FINSI;

  |HAZ CargaTempo;

  |SI SwHay = 0; |ACABA; |FINSI;

  |BUCLE rew00001;

  |SI Hojas2 = 1;  |FINIMP;  |FINSI;

  |ABRE #99; |CIERRA #99; |DELINDEX #99;
|FPRC;
