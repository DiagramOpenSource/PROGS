|FICHEROS;
     cubala22 #0;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &nombre  = "";
     &nif     = "";
     &tipo    = "";
     &unid    = "";
     &modo    = 0;
     &sw_mod  = 0;

     anyo1    = 0;
     anyo2    = 0;
     x        = 0;
     tecla    = "";
     ntecla   = 0;
     avance   = "815";
     atras    = "814";
     FEstado  = 0;
     nCampo   = 0;
|FIN;

|| **************************************************************************
||                      PROCESOS PROPIOS DEL PROGRAMA
|| **************************************************************************

|PROCESO pintaany; |TIPO 13;
     anyo2 = anyo - 1;
     anyo1 = anyo;
     |PINTA 963, anyo1;
     |PINTA 975, anyo2;
|FPRC;

|PROCESO totales; |TIPO 0;
     |SI tipo = "E";
         #0#9   = #0#10  + #0#11  + #0#12  + #0#13  + #0#14  + #0#15  + #0#16  + #0#17;
         #0#18  = #0#19  + #0#20  + #0#21  + #0#22  + #0#23  + #0#24  + #0#25;
         #0#30  = #0#31  + #0#32  + #0#33;
         #0#26  = #0#27  + #0#28  + #0#29  + #0#30  + #0#34  + #0#35  + #0#36;
         #0#40  = #0#41  + #0#42  + #0#43  + #0#44  + #0#45  + #0#46  + #0#47;
         #0#50  = #0#51  + #0#52  + #0#53;
         #0#48  = #0#49  + #0#50  + #0#54  + #0#55  + #0#56  + #0#57;
         #0#62  = #0#63  + #0#64  + #0#65;
         #0#58  = #0#59  + #0#60  + #0#61  + #0#62  + #0#66  + #0#67  + #0#68;

         #0#75  = #0#76  + #0#77  + #0#78  + #0#79  + #0#80  + #0#81  + #0#82  + #0#83;
         #0#84  = #0#85  + #0#86  + #0#87  + #0#88  + #0#89  + #0#90  + #0#91;
         #0#96  = #0#97  + #0#98  + #0#99;
         #0#92  = #0#93  + #0#94  + #0#95  + #0#96  + #0#100 + #0#101 + #0#102;
         #0#106 = #0#107 + #0#108 + #0#109 + #0#110 + #0#111 + #0#112 + #0#113;
         #0#116 = #0#117 + #0#118 + #0#119;
         #0#114 = #0#115 + #0#116 + #0#120 + #0#121 + #0#122 + #0#123;
         #0#128 = #0#129 + #0#130 + #0#131;
         #0#124 = #0#125 + #0#126 + #0#127 + #0#128 + #0#132 + #0#133 + #0#134;
     |SINO;
         #0#26  = #0#29  + #0#34;
         #0#48  = #0#53  + #0#54;
         #0#58  = #0#61  + #0#66;

         #0#92  = #0#95  + #0#100;
         #0#114 = #0#119 + #0#120;
         #0#124 = #0#127 + #0#132;
     |FINSI;

     #0#7   = #0#8   + #0#9   + #0#18  + #0#26;
     #0#38  = #0#39  + #0#40  + #0#48  + #0#58  + #0#69  + #0#70;
     #0#71  = #0#6   + #0#7   + #0#37  + #0#38;

     #0#73  = #0#74  + #0#75  + #0#84  + #0#92;
     #0#104 = #0#105 + #0#106 + #0#114 + #0#124 + #0#135 + #0#136;
     #0#137 = #0#72  + #0#73  + #0#103 + #0#104;

     |PINTA #0#007;
     |PINTA #0#009;
     |PINTA #0#018;
     |PINTA #0#026;
     |PINTA #0#030;
     |PINTA #0#037;
     |PINTA #0#038;
     |PINTA #0#040;
     |PINTA #0#048;
     |PINTA #0#058;
     |PINTA #0#062;
     |PINTA #0#071;

     |PINTA #0#073;
     |PINTA #0#075;
     |PINTA #0#084;
     |PINTA #0#092;
     |PINTA #0#096;
     |PINTA #0#104;
     |PINTA #0#106;
     |PINTA #0#114;
     |PINTA #0#116;
     |PINTA #0#124;
     |PINTA #0#128;
     |PINTA #0#137;
|FPRC;

|PROCESO nomoaant;
     |PARA nCampo = 6;  |SI nCampo [ 71;  |HACIENDO nCampo = nCampo + 1;
           |C_M #0nCampo,1, "N";
     |SIGUE;
|FPRC;

|PROCESO nomoabre;
     |SI sw_mod = 0;
         |C_M #0#007,  1, "N";
         |C_M #0#010,  1, "N";
         |C_M #0#011,  1, "N";
         |C_M #0#012,  1, "N";
         |C_M #0#013,  1, "N";
         |C_M #0#014,  1, "N";
         |C_M #0#015,  1, "N";
         |C_M #0#016,  1, "N";
         |C_M #0#017,  1, "N";
         |C_M #0#019,  1, "N";
         |C_M #0#020,  1, "N";
         |C_M #0#021,  1, "N";
         |C_M #0#022,  1, "N";
         |C_M #0#023,  1, "N";
         |C_M #0#024,  1, "N";
         |C_M #0#025,  1, "N";
         |C_M #0#026,  1, "N";
         |C_M #0#027,  1, "N";
         |C_M #0#028,  1, "N";
         |C_M #0#030,  1, "N";
         |C_M #0#031,  1, "N";
         |C_M #0#032,  1, "N";
         |C_M #0#033,  1, "N";
         |C_M #0#035,  1, "N";
         |C_M #0#036,  1, "N";
         |C_M #0#038,  1, "N";
         |C_M #0#041,  1, "N";
         |C_M #0#042,  1, "N";
         |C_M #0#043,  1, "N";
         |C_M #0#044,  1, "N";
         |C_M #0#045,  1, "N";
         |C_M #0#046,  1, "N";
         |C_M #0#047,  1, "N";
         |C_M #0#048,  1, "N";
         |C_M #0#049,  1, "N";
         |C_M #0#051,  1, "N";
         |C_M #0#052,  1, "N";
         |C_M #0#055,  1, "N";
         |C_M #0#056,  1, "N";
         |C_M #0#057,  1, "N";
         |C_M #0#058,  1, "N";
         |C_M #0#059,  1, "N";
         |C_M #0#060,  1, "N";
         |C_M #0#062,  1, "N";
         |C_M #0#063,  1, "N";
         |C_M #0#064,  1, "N";
         |C_M #0#065,  1, "N";
         |C_M #0#067,  1, "N";
         |C_M #0#068,  1, "N";
         |C_M #0#071,  1, "N";
     |FINSI;

     |C_M #0#073,  1, "N";
     |C_M #0#076,  1, "N";
     |C_M #0#077,  1, "N";
     |C_M #0#078,  1, "N";
     |C_M #0#079,  1, "N";
     |C_M #0#080,  1, "N";
     |C_M #0#081,  1, "N";
     |C_M #0#082,  1, "N";
     |C_M #0#083,  1, "N";
     |C_M #0#085,  1, "N";
     |C_M #0#086,  1, "N";
     |C_M #0#087,  1, "N";
     |C_M #0#088,  1, "N";
     |C_M #0#089,  1, "N";
     |C_M #0#090,  1, "N";
     |C_M #0#091,  1, "N";
     |C_M #0#092,  1, "N";
     |C_M #0#093,  1, "N";
     |C_M #0#094,  1, "N";
     |C_M #0#096,  1, "N";
     |C_M #0#097,  1, "N";
     |C_M #0#098,  1, "N";
     |C_M #0#099,  1, "N";
     |C_M #0#101,  1, "N";
     |C_M #0#102,  1, "N";
     |C_M #0#104,  1, "N";
     |C_M #0#107,  1, "N";
     |C_M #0#108,  1, "N";
     |C_M #0#109,  1, "N";
     |C_M #0#110,  1, "N";
     |C_M #0#111,  1, "N";
     |C_M #0#112,  1, "N";
     |C_M #0#113,  1, "N";
     |C_M #0#114,  1, "N";
     |C_M #0#115,  1, "N";
     |C_M #0#117,  1, "N";
     |C_M #0#118,  1, "N";
     |C_M #0#121,  1, "N";
     |C_M #0#122,  1, "N";
     |C_M #0#123,  1, "N";
     |C_M #0#124,  1, "N";
     |C_M #0#125,  1, "N";
     |C_M #0#126,  1, "N";
     |C_M #0#128,  1, "N";
     |C_M #0#129,  1, "N";
     |C_M #0#130,  1, "N";
     |C_M #0#131,  1, "N";
     |C_M #0#133,  1, "N";
     |C_M #0#134,  1, "N";
     |C_M #0#137,  1, "N";
|FPRC;

|PROCESO nomoexte;
     |SI sw_mod = 0;
         |C_M #0#007,1,"N";
         |C_M #0#009,1,"N";
         |C_M #0#018,1,"N";
         |C_M #0#026,1,"N";
         |C_M #0#030,1,"N";
         |C_M #0#038,1,"N";
         |C_M #0#040,1,"N";
         |C_M #0#048,1,"N";
         |C_M #0#050,1,"N";
         |C_M #0#058,1,"N";
         |C_M #0#062,1,"N";
     |FINSI;

     |C_M #0#073,1,"N";
     |C_M #0#075,1,"N";
     |C_M #0#084,1,"N";
     |C_M #0#092,1,"N";
     |C_M #0#096,1,"N";
     |C_M #0#104,1,"N";
     |C_M #0#106,1,"N";
     |C_M #0#114,1,"N";
     |C_M #0#116,1,"N";
     |C_M #0#124,1,"N";
     |C_M #0#128,1,"N";
|FPRC;

|PROCESO nomodi;
     |SI sw_mod = 1;    |HAZ nomoaant; |FINSI;
     |SI tipo   = "A";  |HAZ nomoabre; |FINSI;
     |SI tipo   = "E";  |HAZ nomoexte; |FINSI;
|FPRC;

|PROCESO pidedato;
     #0#0 = empresa;
     #0#1 = anyo;
     |LEE 101#0=;
     FEstado = FSalida;
     |SI FEstado ! 0;
         |DDEFECTO #0;
         #0#0 = empresa;
         #0#1 = anyo;
     |FINSI;

     |PINDA #0#0;
     |SI modo = 1; |HAZ nomodi; |ENDATOS #1#0; |FINSI;
     |SI modo = 2; |HAZ nomodi; |ENDATOS #2#0;  |FINSI;

     |SI FSalida = 0;
         #0#0 = empresa;
         #0#1 = anyo;
         #0#2 = nombre;
         #0#3 = nif;
         #0#4 = unid;
         #0#5 = tipo;
         |SI FEstado = 0;
             |GRABA 020#0a;
         |SINO;
             |GRABA 020#0n;
         |FINSI;
         |LIBERA #0;
     |FINSI;
|FPRC;

|PROCESO pantalla1;
     |PINPA #0#0;
     |PINDA #0#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = avance; |HAZ pantalla2; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla2;
     |PINPA #1#0;
     |PINDA #1#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla1; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla3; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla3;
     |PINPA #2#0;
     |PINDA #2#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla2; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla4; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla4;
     |PINPA #3#0;
     |PINDA #3#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla3; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla5;
     |PINPA #4#0;
     |PINDA #4#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras;  |HAZ pantalla4; |ACABA; |FINSI;
     |SI tecla = avance; |HAZ pantalla6; |ACABA; |FINSI;
|FPRC;

|PROCESO pantalla6;
     |PINPA #5#0;
     |PINDA #5#0;
     |MENSA "0411  Av.Pag.= Siguiente Pantalla  Re.Pag. = Pantalla Anterior";
     |LEETECLA tecla;
     |SI tecla = atras; |HAZ pantalla5; |ACABA; |FINSI;
|FPRC;

|PROCESO consulta; |TIPO 0;
     avance = &255 + avance;
     atras  = &255 + atras;
     #0#0   = empresa;
     #0#1   = anyo;
     |LEE 040#0=;
     |SI FSalida = 0; |HAZ pantalla1; |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #0;
     |PINPA #0#0;
     |SI modo = 1; |O modo = 2; |HAZ pidedato; |FINSI;
     |SI modo = 4; |HAZ consulta; |FINSI;
     |CIERRA #0;
|FPRO;
