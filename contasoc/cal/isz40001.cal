|FICHEROS;
   isz00001 #0;
   soplanli #1;
   sodacoli #2;
   isocie57 #3;
   isocie45 #5;
   isocie58 #6;
|FIN;

|VARIABLES;
     &empresa = 0;
     &anyo    = 0;
     &tipo    = 0;
     &enNoPanta = 0;

     FEstado  = 0;

     cantidad = 0;
     BenPer   = 0;
     XPara    = 0;

     cuentad  = "";
     cuentah  = "";
     vari     = "";
     aste     = "";
     long     = "";
     numero   = "";
     longi    = 0;
     x        = 0;
|FIN;

|PROCESO Casilla96;
  |SI #1#3 = 101; #3#003 = #3#003 + cantidad; |FINSI;
  |SI #1#3 = 102; #3#004 = #3#004 + cantidad; |FINSI;
  |SI #1#3 = 103; #3#005 = #3#005 + cantidad; |FINSI;
  |SI #1#3 = 104; #3#006 = #3#006 + cantidad; |FINSI;
  |SI #1#3 = 105; #3#007 = #3#007 + cantidad; |FINSI;
  |SI #1#3 = 106; #3#008 = #3#008 + cantidad; |FINSI;
  |SI #1#3 = 107; #3#009 = #3#009 + cantidad; |FINSI;
  |SI #1#3 = 108; #3#010 = #3#010 + cantidad; |FINSI;
  |SI #1#3 = 109; #3#011 = #3#011 + cantidad; |FINSI;
  |SI #1#3 = 110; #3#012 = #3#012 + cantidad; |FINSI;
  |SI #1#3 = 115; #3#016 = #3#016 + cantidad; |FINSI;
  |SI #1#3 = 116; #3#017 = #3#017 + cantidad; |FINSI;
  |SI #1#3 = 117; #3#018 = #3#018 + cantidad; |FINSI;
  |SI #1#3 = 118; #3#019 = #3#019 + cantidad; |FINSI;
  |SI #1#3 = 119; #3#020 = #3#020 + cantidad; |FINSI;
  |SI #1#3 = 120; #3#021 = #3#021 + cantidad; |FINSI;
  |SI #1#3 = 121; #3#022 = #3#022 + cantidad; |FINSI;
  |SI #1#3 = 122; #3#023 = #3#023 + cantidad; |FINSI;
  |SI #1#3 = 123; #3#024 = #3#024 + cantidad; |FINSI;
  |SI #1#3 = 124; #3#025 = #3#025 + cantidad; |FINSI;
  |SI #1#3 = 125; #3#026 = #3#026 + cantidad; |FINSI;
  |SI #1#3 = 126; #3#027 = #3#027 + cantidad; |FINSI;
  |SI #1#3 = 127; #3#028 = #3#028 + cantidad; |FINSI;
  |SI #1#3 = 128; #3#029 = #3#029 + cantidad; |FINSI;
  |SI #1#3 = 129; #3#030 = #3#030 + cantidad; |FINSI;
  |SI #1#3 = 135; #3#034 = #3#034 + cantidad; |FINSI;
  |SI #1#3 = 136; #3#035 = #3#035 + cantidad; |FINSI;
  |SI #1#3 = 137; #3#036 = #3#036 + cantidad; |FINSI;
  |SI #1#3 = 138; #3#037 = #3#037 + cantidad; |FINSI;
  |SI #1#3 = 139; #3#038 = #3#038 + cantidad; |FINSI;
  |SI #1#3 = 140; #3#039 = #3#039 + cantidad; |FINSI;
  |SI #1#3 = 141; #3#040 = #3#040 + cantidad; |FINSI;
  |SI #1#3 = 142; #3#041 = #3#041 + cantidad; |FINSI;
  |SI #1#3 = 143; #3#042 = #3#042 + cantidad; |FINSI;
  |SI #1#3 = 144; #3#043 = #3#043 + cantidad; |FINSI;
  |SI #1#3 = 145; #3#044 = #3#044 + cantidad; |FINSI;
  |SI #1#3 = 146; #3#045 = #3#045 + cantidad; |FINSI;
  |SI #1#3 = 147; #3#046 = #3#046 + cantidad; |FINSI;
  |SI #1#3 = 148; #3#047 = #3#047 + cantidad; |FINSI;
  |SI #1#3 = 149; #3#048 = #3#048 + cantidad; |FINSI;
  |SI #1#3 = 155; #3#052 = #3#052 + cantidad; |FINSI;
  |SI #1#3 = 156; #3#053 = #3#053 + cantidad; |FINSI;
  |SI #1#3 = 157; #3#054 = #3#054 + cantidad; |FINSI;
  |SI #1#3 = 158; #3#055 = #3#055 + cantidad; |FINSI;
  |SI #1#3 = 161; #3#056 = #3#056 + cantidad; |FINSI;
  |SI #1#3 = 162; #3#057 = #3#057 + cantidad; |FINSI;
  |SI #1#3 = 164; #3#059 = #3#059 + cantidad; |FINSI;
  |SI #1#3 = 165; #3#060 = #3#060 + cantidad; |FINSI;
  |SI #1#3 = 166; #3#061 = #3#061 + cantidad; |FINSI;
  |SI #1#3 = 167; #3#062 = #3#062 + cantidad; |FINSI;
  |SI #1#3 = 168; #3#063 = #3#063 + cantidad; |FINSI;
  |SI #1#3 = 169; #3#064 = #3#064 + cantidad; |FINSI;
  |SI #1#3 = 173; #3#066 = #3#066 + cantidad; |FINSI;
  |SI #1#3 = 174; #3#067 = #3#067 + cantidad; |FINSI;
  |SI #1#3 = 175; #3#068 = #3#068 + cantidad; |FINSI;
  |SI #1#3 = 176; #3#069 = #3#069 + cantidad; |FINSI;
  |SI #1#3 = 177; #3#070 = #3#070 + cantidad; |FINSI;
  |SI #1#3 = 178; #3#071 = #3#071 + cantidad; |FINSI;
  |SI #1#3 = 179; #3#072 = #3#072 + cantidad; |FINSI;
  |SI #1#3 = 180; #3#073 = #3#073 + cantidad; |FINSI;
  |SI #1#3 = 181; #3#074 = #3#074 + cantidad; |FINSI;
  |SI #1#3 = 182; #3#075 = #3#075 + cantidad; |FINSI;
  |SI #1#3 = 186; #3#079 = #3#079 + cantidad; |FINSI;
  |SI #1#3 = 188; #3#080 = #3#080 + cantidad; |FINSI;
  |SI #1#3 = 189; #3#081 = #3#081 + cantidad; |FINSI;

  |SI #1#3 = 201; #3#083 = #3#083 + cantidad; |FINSI;
  |SI #1#3 = 202; #3#084 = #3#084 + cantidad; |FINSI;
  |SI #1#3 = 203; #3#085 = #3#085 + cantidad; |FINSI;
  |SI #1#3 = 204; #3#086 = #3#086 + cantidad; |FINSI;
  |SI #1#3 = 205; #3#087 = #3#087 + cantidad; |FINSI;
  |SI #1#3 = 206; #3#088 = #3#088 + cantidad; |FINSI;
  |SI #1#3 = 207; #3#089 = #3#089 + cantidad; |FINSI;
  |SI #1#3 = 208; #3#090 = #3#090 + cantidad; |FINSI;
  |SI #1#3 = 209; #3#091 = #3#091 + cantidad; |FINSI;
  |SI #1#3 = 211; #3#092 = #3#092 + cantidad; |FINSI;
  |SI #1#3 = 212; #3#093 = #3#093 + cantidad; |FINSI;
  |SI #1#3 = 213; #3#094 = #3#094 + cantidad; |FINSI;
  |SI #1#3 = 215; #3#095 = #3#095 + cantidad; |FINSI;
  |SI #1#3 = 216; #3#096 = #3#096 + cantidad; |FINSI;
  |SI #1#3 = 217; #3#097 = #3#097 + cantidad; |FINSI;
  |SI #1#3 = 221; #3#101 = #3#101 + cantidad; |FINSI;
  |SI #1#3 = 222; #3#102 = #3#102 + cantidad; |FINSI;
  |SI #1#3 = 223; #3#103 = #3#103 + cantidad; |FINSI;
  |SI #1#3 = 224; #3#104 = #3#104 + cantidad; |FINSI;
  |SI #1#3 = 227; #3#106 = #3#106 + cantidad; |FINSI;
  |SI #1#3 = 228; #3#107 = #3#107 + cantidad; |FINSI;
  |SI #1#3 = 229; #3#108 = #3#108 + cantidad; |FINSI;
  |SI #1#3 = 230; #3#109 = #3#109 + cantidad; |FINSI;
  |SI #1#3 = 234; #3#111 = #3#111 + cantidad; |FINSI;
  |SI #1#3 = 235; #3#112 = #3#112 + cantidad; |FINSI;
  |SI #1#3 = 236; #3#113 = #3#113 + cantidad; |FINSI;
  |SI #1#3 = 237; #3#114 = #3#114 + cantidad; |FINSI;
  |SI #1#3 = 238; #3#115 = #3#115 + cantidad; |FINSI;
  |SI #1#3 = 239; #3#116 = #3#116 + cantidad; |FINSI;
  |SI #1#3 = 242; #3#118 = #3#118 + cantidad; |FINSI;
  |SI #1#3 = 243; #3#119 = #3#119 + cantidad; |FINSI;
  |SI #1#3 = 244; #3#120 = #3#120 + cantidad; |FINSI;
  |SI #1#3 = 245; #3#121 = #3#121 + cantidad; |FINSI;
  |SI #1#3 = 246; #3#122 = #3#122 + cantidad; |FINSI;
  |SI #1#3 = 247; #3#123 = #3#123 + cantidad; |FINSI;
  |SI #1#3 = 248; #3#124 = #3#124 + cantidad; |FINSI;
  |SI #1#3 = 249; #3#125 = #3#125 + cantidad; |FINSI;
  |SI #1#3 = 250; #3#126 = #3#126 + cantidad; |FINSI;
  |SI #1#3 = 251; #3#127 = #3#127 + cantidad; |FINSI;
  |SI #1#3 = 252; #3#128 = #3#128 + cantidad; |FINSI;
  |SI #1#3 = 253; #3#129 = #3#129 + cantidad; |FINSI;
  |SI #1#3 = 254; #3#130 = #3#130 + cantidad; |FINSI;
  |SI #1#3 = 255; #3#131 = #3#131 + cantidad; |FINSI;
  |SI #1#3 = 256; #3#132 = #3#132 + cantidad; |FINSI;
  |SI #1#3 = 261; #3#134 = #3#134 + cantidad; |FINSI;

  |SI #1#3 = 302; #3#137 = #3#137 + cantidad; |FINSI;
  |SI #1#3 = 303; #3#138 = #3#138 + cantidad; |FINSI;
  |SI #1#3 = 304; #3#139 = #3#139 + cantidad; |FINSI;
  |SI #1#3 = 307; #3#141 = #3#141 + cantidad; |FINSI;
  |SI #1#3 = 308; #3#142 = #3#142 + cantidad; |FINSI;
  |SI #1#3 = 309; #3#143 = #3#143 + cantidad; |FINSI;
  |SI #1#3 = 310; #3#144 = #3#144 + cantidad; |FINSI;
  |SI #1#3 = 311; #3#145 = #3#145 + cantidad; |FINSI;
  |SI #1#3 = 315; #3#147 = #3#147 + cantidad; |FINSI;
  |SI #1#3 = 316; #3#148 = #3#148 + cantidad; |FINSI;
  |SI #1#3 = 317; #3#149 = #3#149 + cantidad; |FINSI;
  |SI #1#3 = 321; #3#151 = #3#151 + cantidad; |FINSI;
  |SI #1#3 = 322; #3#152 = #3#152 + cantidad; |FINSI;
  |SI #1#3 = 323; #3#153 = #3#153 + cantidad; |FINSI;
  |SI #1#3 = 327; #3#155 = #3#155 + cantidad; |FINSI;
  |SI #1#3 = 328; #3#156 = #3#156 + cantidad; |FINSI;
  |SI #1#3 = 329; #3#157 = #3#157 + cantidad; |FINSI;
  |SI #1#3 = 330; #3#158 = #3#158 + cantidad; |FINSI;
  |SI #1#3 = 334; #3#160 = #3#160 + cantidad; |FINSI;
  |SI #1#3 = 335; #3#161 = #3#161 + cantidad; |FINSI;
  |SI #1#3 = 336; #3#162 = #3#162 + cantidad; |FINSI;
  |SI #1#3 = 337; #3#163 = #3#163 + cantidad; |FINSI;
  |SI #1#3 = 341; #3#165 = #3#165 + cantidad; |FINSI;
  |SI #1#3 = 342; #3#166 = #3#166 + cantidad; |FINSI;
  |SI #1#3 = 343; #3#167 = #3#167 + cantidad; |FINSI;
  |SI #1#3 = 344; #3#168 = #3#168 + cantidad; |FINSI;
  |SI #1#3 = 345; #3#169 = #3#169 + cantidad; |FINSI;
  |SI #1#3 = 346; #3#170 = #3#170 + cantidad; |FINSI;
  |SI #1#3 = 347; #3#171 = #3#171 + cantidad; |FINSI;
  |SI #1#3 = 348; #3#172 = #3#172 + cantidad; |FINSI;
  |SI #1#3 = 349; #3#173 = #3#173 + cantidad; |FINSI;
  |SI #1#3 = 350; #3#174 = #3#174 + cantidad; |FINSI;

  |SI #1#3 = 401; #3#176 = #3#176 + cantidad; |FINSI;
  |SI #1#3 = 402; #3#177 = #3#177 + cantidad; |FINSI;
  |SI #1#3 = 403; #3#178 = #3#178 + cantidad; |FINSI;
  |SI #1#3 = 404; #3#179 = #3#179 + cantidad; |FINSI;
  |SI #1#3 = 407; #3#182 = #3#182 + cantidad; |FINSI;
  |SI #1#3 = 410; #3#183 = #3#183 + cantidad; |FINSI;
  |SI #1#3 = 411; #3#184 = #3#184 + cantidad; |FINSI;
  |SI #1#3 = 412; #3#185 = #3#185 + cantidad; |FINSI;
  |SI #1#3 = 416; #3#187 = #3#187 + cantidad; |FINSI;
  |SI #1#3 = 417; #3#188 = #3#188 + cantidad; |FINSI;
  |SI #1#3 = 418; #3#189 = #3#189 + cantidad; |FINSI;
  |SI #1#3 = 422; #3#191 = #3#191 + cantidad; |FINSI;
  |SI #1#3 = 423; #3#192 = #3#192 + cantidad; |FINSI;
  |SI #1#3 = 424; #3#193 = #3#193 + cantidad; |FINSI;
  |SI #1#3 = 428; #3#195 = #3#195 + cantidad; |FINSI;
  |SI #1#3 = 429; #3#196 = #3#196 + cantidad; |FINSI;
  |SI #1#3 = 430; #3#197 = #3#197 + cantidad; |FINSI;
  |SI #1#3 = 431; #3#198 = #3#198 + cantidad; |FINSI;
  |SI #1#3 = 434; #3#200 = #3#200 + cantidad; |FINSI;
  |SI #1#3 = 435; #3#201 = #3#201 + cantidad; |FINSI;
  |SI #1#3 = 436; #3#202 = #3#202 + cantidad; |FINSI;
  |SI #1#3 = 437; #3#203 = #3#203 + cantidad; |FINSI;
  |SI #1#3 = 438; #3#204 = #3#204 + cantidad; |FINSI;
  |SI #1#3 = 439; #3#205 = #3#205 + cantidad; |FINSI;
  |SI #1#3 = 440; #3#206 = #3#206 + cantidad; |FINSI;

  |SI #1#3 = 301;
      |SI cantidad > 0;
          #3#136 = #3#136 + cantidad;
      |SINO;
          #3#181 = #3#181 + (-cantidad);
      |FINSI;
  |FINSI;
|FPRC;

|PROCESO Cantidad96;
     |SI enNoPanta = 0;
         #0#3 = #2#1; |PINTA #0#3;
         #0#4 = #2#3; |PINTA #0#4;
     |FINSI;

     cantidad = #2#8;
     |SI #1#9 = "-"; cantidad = -#2#8; |FINSI;
     |HAZ Casilla96;
|FPRC;

|DEFBUCLE liapunte;
  #2#2;
  ;
  empresa, anyo, cuentad;
  empresa, anyo, cuentah;
  e;
  NULL, Cantidad96;
|FIN;

|PROCESO MontaCuenta96;
  vari   = #1#2;
  |QBF vari;
  aste   = vari % -101;
  long   = vari % 0;
  longi  = long - 1;
  longi  = 100 + longi;
  numero = vari % longi;
  |SI aste = "*";
      cuentad = numero + "            ";
      cuentad = cuentad % 112;
      cuentah = numero + "zzzzzzzzzzzz";
      cuentah = cuentah % 112;
  |SINO;
      cuentad = #1#2;
      cuentah = #1#2;
  |FINSI;
|FPRC;

|PROCESO Bulineas96;
  |HAZ MontaCuenta96;
  |BUCLE liapunte;        || Lee las lineas apuntes
|FPRC;

|DEFBUCLE planconta;
  #1#1;
  3;
  #0#0, 001, 001;
  #0#0, 999, 999;
  e;
  NULL, Bulineas96;
|FIN;

|PROCESO Pasa96;
  |ABRE #3;

  |LIBERA #3; #3#0 = empresa; #3#1 = anyo; |LEE 110#3=; FEstado = FSalida;
  |DDEFECTO #3;

  #3#0 = empresa; #3#1 = anyo; #3#2 = tipo;

  |BUCLE planconta;     || Lee las lineas

  |HAZ Totales96;

  |SI FEstado = 0; |GRABA 020#3a; |SINO; |GRABA 020#3n; |FINSI;

  |CIERRA #3;
  |HAZ Liquid96;
|FPRC;

|PROCESO Totales96;
  #3#13  = 0;
  |PARA XPara = 5; |SI XPara [ 11; |HACIENDO XPara = XPara + 2;
        #3#13 = #3#13 + #3XPara;
  |SIGUE;

  #3#14  = 0;
  |PARA XPara = 6; |SI XPara [ 12; |HACIENDO XPara = XPara + 2;
        #3#14 = #3#14 + #3XPara;
  |SIGUE;

  #3#15  = #3#13  - #3#14;

  #3#31  = 0;
  |PARA XPara = 16; |SI XPara [ 28; |HACIENDO XPara = XPara + 2;
        #3#31 = #3#31 + #3XPara;
  |SIGUE;
  #3#31 = #3#31 + #3#29;

  #3#32  = 0;
  |PARA XPara = 17; |SI XPara [ 27; |HACIENDO XPara = XPara + 2;
        #3#32 = #3#32 + #3XPara;
  |SIGUE;
  #3#32 = #3#32 + #3#30;

  #3#33  = #3#31  - #3#32;

  #3#49  = 0;
  |PARA XPara = 34; |SI XPara [ 48; |HACIENDO XPara = XPara + 2;
        #3#49 = #3#49 + #3XPara;
  |SIGUE;

  #3#50  = 0;
  |PARA XPara = 35; |SI XPara [ 47; |HACIENDO XPara = XPara + 2;
        #3#50 = #3#50 + #3XPara;
  |SIGUE;

  #3#51  = #3#49  - #3#50;
  #3#58  = #3#56  - #3#57;
  #3#65  = #3#59  + #3#60 + #3#61 + #3#62 + #3#63 - #3#64;

  #3#76  = 0;
  |PARA XPara = 66; |SI XPara [ 74; |HACIENDO XPara = XPara + 2;
        #3#76 = #3#76 + #3XPara;
  |SIGUE;

  #3#77  = 0;
  |PARA XPara = 67; |SI XPara [ 75; |HACIENDO XPara = XPara + 2;
        #3#77 = #3#77 + #3XPara;
  |SIGUE;

  #3#78  = #3#76  - #3#77;

  #3#98  = 0;
  |PARA XPara = 83; |SI XPara [ 92; |HACIENDO XPara = XPara + 1;
        #3#98 = #3#98 + #3XPara;
  |SIGUE;
  #3#98  = #3#98 + #3#94 + #3#95;

  #3#99  = #3#93 + #3#96 + #3#97;
  #3#100 = #3#98  - #3#99;
  #3#105 = #3#101 + #3#102 + #3#103 + #3#104;
  #3#110 = #3#106 + #3#107 + #3#108 + #3#109;
  #3#117 = #3#111 + #3#112 + #3#113 + #3#114 + #3#115 + #3#116;

  #3#133 = 0;
  |PARA XPara = 118; |SI XPara [ 132; |HACIENDO XPara = XPara + 1;
        #3#133 = #3#133 + #3XPara;
  |SIGUE;

  #3#82  = #3#3   + #3#4   + #3#15  + #3#33  + #3#51  + #3#52 + #3#53 + #3#54;
  #3#82  = #3#82  + #3#55  + #3#58  + #3#65  + #3#78  + #3#80 + #3#81;
  #3#135 = #3#100 + #3#105 + #3#110 + #3#117 + #3#133 + #3#134;

  #3#140 = #3#137 + #3#138 + #3#139;
  #3#146 = #3#141 + #3#142 + #3#143 + #3#144 + #3#145;
  #3#150 = #3#147 + #3#148 + #3#149;
  #3#154 = #3#151 + #3#152 + #3#153;
  #3#159 = #3#155 + #3#156 + #3#157 + #3#158;
  #3#164 = #3#160 + #3#161 + #3#162 + #3#163;
  #3#175 = #3#136 + #3#140 + #3#146 + #3#150 + #3#154 + #3#159 + #3#164;
  #3#175 = #3#175 + #3#165 + #3#166 + #3#167 + #3#168 + #3#169 + #3#170;
  #3#175 = #3#175 + #3#171 + #3#172 + #3#173;
  #3#180 = #3#176 + #3#177 + #3#178 + #3#179;
  #3#186 = #3#183 + #3#184 + #3#185;
  #3#190 = #3#187 + #3#188 + #3#189;
  #3#194 = #3#191 + #3#192 + #3#193;
  #3#199 = #3#195 + #3#196 + #3#197 + #3#198;
  #3#207 = #3#180 + #3#181 + #3#182 + #3#186 + #3#190 + #3#194 + #3#199;
  #3#207 = #3#207 + #3#200 + #3#201 + #3#202 + #3#203 + #3#204 + #3#205;

  BenPer = #3#207 - #3#175;
  |SI BenPer > 0;
      #3#174 = BenPer;
      #3#175 = #3#175 + #3#174;
      #3#206 = 0;
  |SINO;
      #3#206 = -BenPer;
      #3#207 = #3#207 + #3#206;
      #3#174 = 0;
  |FINSI;
|FPRC;

|PROCESO Liquid96;
   |ABRE #6;
   #6#0 = #3#0;
   #6#1 = #3#1;
   |LIBERA #6;
   |LEE 110#6=;
   FEstado = FSalida;
   |SI FEstado ! 0; |DDEFECTO #6; #6#0 = #3#0; #6#1 = #3#1; |FINSI;

   #6#3 = #3#95;
   #6#7 = #6#3 + #6#4 + #6#5 + #6#6;
   |SI FEstado = 0; |GRABA 020#6a; |SINO; |GRABA 020#6n; |FINSI;
   |CIERRA #6;
|FPRC;
