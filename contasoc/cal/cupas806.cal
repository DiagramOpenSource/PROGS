||      Pases desde contabilidad especiales

|FICHEROS;
     cubal800 #0;

     isom0000 #100;
     zregdocu #600;

     :contagen/catw0015 #315;  || Distribucion Resultados
     :contagen/canempre #408;  || Empresas contables
|FIN;

|VARIABLES;
     &empresa  = 0;
     &anyo     = 0;
     &perio    = 0;

     &nombre  = "";
     &nif     = "";
     &unid    = "";
     &tipo    = "";
     &acabalo = 0;

     nPara1     = 0;
     nCampo     = 0;
     nHay       = 0;

     aAlfa1     = "";
     aAlfa2     = "";
     &eaPathContagen = "";
     aPath       = "";
|FIN;

|| //////////////////////////////////////////////////////////////////
|PROCESO LeeCatw0015;
     |PARA nPara1 = 0; |SI nPara1 [ 21; |HACIENDO nPara1 = nPara1 + 1;
           nCampo = nPara1 + 84;
           #100nCampo = #100nCampo + #315nPara1;
           |SI #315nPara1 ! 0; nHay = 1; |FINSI;
     |SIGUE;
     #100#125 = #100#125 + #315#26;
     #100#126 = #100#126 + #315#27;
     |SI #315#26 ! 0; nHay = 1; |FINSI;
     |SI #315#27 ! 0; nHay = 1; |FINSI;
|FPRC;

|DEFBUCLE LeeCatw0015;
    #315#1;
    ;
    "               ";
    "zzzzzzzzzzzzzzz";
    e;
    NULL, LeeCatw0015;
|FIN;

|PROCESO ImporteDistribuir;
     |SI PARAMETRO = "";
         |ATRI I; |PINTA 1847, "Distribucion Resultados "; |ATRI 0;
     |FINSI;

     perio = -1;
     |HAZ BusquedaApli;
     |SI eaPathContagen ! "";
         aAlfa1 = anyo;
         aAlfa1 = aAlfa1 % -102;

         |ABRE #408;
         |SELECT #4#408;
         #408#2  = empresa;
         #408#26 = aAlfa1;
         |LEE 040#408=;
         |SI FSalida = 0;
             perio = #408#3;
         |FINSI;
         |SELECT #1#408;
         |CIERRA #408;
     |FINSI;
     |SI perio = -1; |ACABA; |FINSI;

     aAlfa1 = empresa; aAlfa1 = ("00000" + aAlfa1) % -105;
     aAlfa2 = perio;   aAlfa2 = ("0"     + aAlfa2) % -101;
     aPath = eaPathContagen + "fich/" + aAlfa1 + aAlfa2 +  "/";

     |PATH_DAT #315 aPath;

     |ABRE #100;
     #100#0 = empresa;
     #100#1 = anyo;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |DDEFECTO #100;
         #100#0 = empresa;
         #100#1 = anyo;
         |GRABA 020#100b;
     |FINSI;

     |PDEFECTO #100, 84, 106;
     #100#125 = 0;
     #100#126 = 0;

     nHay = 0;
     |BUCLE LeeCatw0015;

     |SI nHay = 1;
         |GRABA 020#100a;

         |ABRE #600;
         #600#0 = empresa;
         #600#1 = anyo;
         |LEE 101#600=;
         |SI FSalida ! 0;
             |DDEFECTO #600;
             #600#0  = empresa;
             #600#1  = anyo;
             #600#2  = nombre;
             |GRABA 020#600b;
         |FINSI;
         #600#16 = #100#84;
         #600#17 = #100#85;
         #600#18 = #100#86;
         #600#19 = #100#87;
         #600#20 = #100#88;

         #600#21 = #100#89;
         #600#22 = #100#90;
         #600#23 = #100#91;
         #600#24 = #100#92;
         #600#25 = #100#94 + #100#95;
         #600#26 = #100#104;
         #600#27 = #100#102;
         #600#28 = #100#93 + #100#96  + #100#97  + #100#98  + #100#99;
         #600#28 = #600#28 + #100#100 + #100#101 + #100#103;
         #600#28 = #600#28 + #100#125 + #100#126;
         #600#29 = #100#105;

         |GRABA 020#600a;
         |LIBERA #600;
         |CIERRA #600;
    |FINSI;
    |LIBERA #100;
    |CIERRA #100;
|FPRC;
