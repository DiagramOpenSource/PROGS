|FICHEROS;
     maempr10 #200;

     isom0001 #101;
     isom0007 #107;
     isom0009 #109;
     isom0010 #110;
     isom0011 #111;
     isom0012 #112;

     :/integral/def/dsam0009 #509;
     :/integral/def/dsam0116 #516;

     &clientes@ #715;
|FIN;

|VARIABLES;
     aAlfa          = "";
     aAlfa0         = "";
     aAlfa1         = "";
     aAlfa2         = "";
     aIPRemoto      = "";
     aCadena        = "";
     aLen           = "";
     aCaracter      = "";

     nLen           = 0;
     nNume          = 0;
     nPos           = 0;
     nCampo         = 0;
     nSwPunto       = 0;
     nCaracter      = 0;
     nComple        = 0;
     nPuntero       = 0;
     nDesde         = 0;
     nHasta         = 0;
     nHay           = 0;

     &enCanti       = 0;
     &enHandle      = 0;
     &eaAlfa         = "";
     &eaEfectivo     = "";
     &eaAdeudo       = "";
     &eaEntidad      = "";
     &eaOficina      = "";
     &eaDC           = "";
     &eaCuenta       = "";
     &eaNomEnt       = "";
     &eaNomOfi       = "";
     &enModelo       = 0;
     &enAnyo         = 0;
     &enBanco        = 0;
     &enFormaPag     = 0;
     &enForzar       = 0;
     &enError        = 0;
     &eaCasilla      = "";
|FIN;

|PROCESO QuitaRaros;
     aCadena = "";
     aLen    = eaAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = eaAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     eaAlfa = aCadena;
|FPRC;

|PROCESO Calcula3E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula2E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00" + aAlfa1) % -102) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula5E2D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("00000" + aAlfa1) % -105) + ((aAlfa2 + "00") % 102);
|FPRC;

|PROCESO Calcula3E4D;
     aAlfa     = (enCanti + "          ") % 110;
     nPos      = 0;
     aAlfa0    = "";
     aAlfa1    = "";
     aAlfa2    = "";
     nSwPunto  = 0;

     |PARA nCaracter = 1;  |SI nCaracter [ 10;  |HACIENDO nCaracter = nCaracter + 1;
           nPos   = (100 * nCaracter) + 1;
           aAlfa0 = aAlfa % nPos;
           |SI aAlfa0 = "."; nSwPunto = 1;  |FINSI;
           |SI nSwPunto = 0;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                  aAlfa1 = aAlfa1 + aAlfa0;
               |FINSI;
           |FINSI;

           |SI nSwPunto = 1;
               |SI aAlfa0 ! " "; |Y aAlfa0 ! ".";
                   aAlfa2 = aAlfa2 + aAlfa0;
               |FINSI;
           |FINSI;
     |SIGUE;

     eaAlfa = (("000" + aAlfa1) % -103) + ((aAlfa2 + "0000") % 104);
|FPRC;

|PROCESO Calcula17D;
     enCanti = enCanti * 100;
     enCanti = enCanti ! 0;

     |SI enCanti ] 0;
         aAlfa = enCanti;
         eaAlfa = ("00000000000000000" + aAlfa) % -117;
     |SINO;
         enCanti  = -enCanti;
         aAlfa   = enCanti;
         eaAlfa   = "N" + (("0000000000000000" + aAlfa) % -116);
     |FINSI;
|FPRC;

|PROCESO GrabaSecuencial;
     |HAZ QuitaRaros;

     |XGRABA enHandle, eaAlfa;
|FPRC;

|PROCESO CogeDatosBancos;
     enBanco    = 0;
     enFormaPag = 0;
     eaEfectivo = "";
     eaAdeudo   = "";
     eaEntidad  = "";
     eaOficina  = "";
     eaDC       = "";
     eaCuenta   = "";
     eaNomEnt   = "";
     eaNomOfi   = "";

     |ABRE #509;

     #509#0 = #715#0;
     #509#1 = enModelo;
     |LEE 040#509=;
     |SI FSalida = 0;
         |CIERRA #509;

         |SI #509#9 = 1;  |O #509#8 = "          ";
             eaEfectivo = "X";
         |SINO;
             eaAdeudo  = "X";
             eaEntidad = #509#5;
             eaOficina = #509#6;
             eaDC      = #509#7;
             eaCuenta  = #509#8;
             eaNomEnt  = #509#4;
             eaNomOfi  = #509#10;

             |SI #509#9 = 3;  eaAdeudo = "3";  |FINSI;
         |FINSI;

         |SI enForzar = 1;
             enBanco    = #509#3;
             enFormaPag = #509#9;
             eaEntidad  = #509#5;
             eaOficina  = #509#6;
             eaDC       = #509#7;
             eaCuenta   = #509#8;
             eaNomEnt   = #509#4;
             eaNomOfi   = #509#10;
         |FINSI;

         |ACABA;
     |FINSI;

     #509#0 = #715#0;
     #509#1 = 999;
     |LEE 040#509=;
     |SI FSalida = 0;
         |CIERRA #509;

         |SI #509#9 = 1;  |O #509#8 = "          ";
             eaEfectivo = "X";
         |SINO;
             eaAdeudo  = "X";
             eaEntidad = #509#5;
             eaOficina = #509#6;
             eaDC      = #509#7;
             eaCuenta  = #509#8;
             eaNomEnt  = #509#4;
             eaNomOfi  = #509#10;

             |SI #509#9 = 3;  eaAdeudo = "3";  |FINSI;
         |FINSI;

         |SI enForzar = 1;
             enBanco    = #509#3;
             enFormaPag = #509#9;
             eaEntidad  = #509#5;
             eaOficina  = #509#6;
             eaDC       = #509#7;
             eaCuenta   = #509#8;
             eaNomEnt   = #509#4;
             eaNomOfi   = #509#10;
         |FINSI;

         |ACABA;
     |FINSI;
     |CIERRA #509;

     |SI #715#104 = 1;  |O #715#93 = "          ";
         eaEfectivo = "X";
         enFormaPag = #715#104;
     |SINO;
         enFormaPag = #715#104;
         eaAdeudo   = "X";
         eaEntidad  = #715#90;
         eaOficina  = #715#91;
         eaDC       = #715#92;
         eaCuenta   = #715#93;
         eaNomEnt   = #715#89;

         |ABRE #516;
         #516#0 = #715#88;
         |LEE 000#516=;
         |SI FSalida ! 0;  |DDEFECTO #516;  |FINSI;
         |CIERRA #516;

         eaNomOfi  = #516#5;

         |SI #715#104 = 3;   eaAdeudo = "3";   |FINSI;
     |FINSI;

     |SI enForzar = 1;
         enBanco    = #715#88;
         enFormaPag = #715#104;
         eaEntidad  = #715#90;
         eaOficina  = #715#91;
         eaDC       = #715#92;
         eaCuenta   = #715#93;
         eaNomEnt   = #715#89;

         |ABRE #516;
         #516#0 = #715#88;
         |LEE 000#516=;
         |SI FSalida ! 0;  |DDEFECTO #516;  |FINSI;
         |CIERRA #516;

         eaNomOfi  = #516#5;
     |FINSI;
|FPRC;

|PROCESO LeeFich101;
     |ABRE #101;
     |SELECT #2#101;
     #101#0 = #200#0;
     #101#1 = #200#1;
     #101#3 = eaCasilla;
     |LEE 000#101=;
     |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;
     |CIERRA #101;
|FPRC;

|PROCESO LeeFich107;
     |ABRE #107;
     |SELECT #2#107;
     #107#0 = #200#0;
     #107#1 = #200#1;
     #107#4 = eaCasilla;
     |LEE 000#107=;
     |SI FSalida ! 0;  |DDEFECTO #107;  |FINSI;
     |CIERRA #107;
|FPRC;

|PROCESO LeeFich109;
     |ABRE #109;
     |SELECT #2#109;
     #109#0 = #200#0;
     #109#1 = #200#1;
     #109#5 = eaCasilla;
     |LEE 000#109=;
     |SI FSalida ! 0;  |DDEFECTO #109;  |FINSI;
     |CIERRA #109;
|FPRC;

|PROCESO LeeFich110;
     |ABRE #110;
     |SELECT #2#110;
     #110#0 = #200#0;
     #110#1 = #200#1;
     #110#5 = eaCasilla;
     |LEE 000#110=;
     |SI FSalida ! 0;  |DDEFECTO #110;  |FINSI;
     |CIERRA #110;
|FPRC;

|PROCESO LeeFich111;
     |ABRE #111;
     |SELECT #2#111;
     #111#0 = #200#0;
     #111#1 = #200#1;
     #111#4 = eaCasilla;
     |LEE 000#111=;
     |SI FSalida ! 0;  |DDEFECTO #111;  |FINSI;
     |CIERRA #111;
|FPRC;

|PROCESO LeeFich112;
     |ABRE #112;
     |SELECT #2#112;
     #112#0 = #200#0;
     #112#1 = #200#1;
     #112#4 = eaCasilla;
     |LEE 000#112=;
     |SI FSalida ! 0;  |DDEFECTO #112;  |FINSI;
     |CIERRA #112;
|FPRC;
