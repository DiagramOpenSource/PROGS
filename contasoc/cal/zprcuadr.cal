|FICHEROS;
     zhazdocu;
     zhazcrea;
     zpcuadro;
     zocuadro;
     zqcuadro;

     zregcu01;
     zregcu02;
     zregcu03;
     zregcu04;
     zregcu05;
     zregcu06;
     zregcu07;
     zregcu08;
     zregcu09;
     zregcu10;
     zregcu11;
     zregcu12;
     zregcu13;
     zregcu14;
     zregcu15;
     zregcu16;
     zregcu17;
     zregcu18;
     zregcu19;
     zregcu20;
     zregcu21;
     zregcu22;
     zregcu23;
     zregcu24;
     zregcu25;
     zregcu26;
     zregcu27;
     zregcu28;
     zregcu29;
     zregcu30;
     zregcu31;
     zregcu32;
     zregcu33;

     sodacoli;
     soda8m11;       || Reparto 8 y 9 cabecera
     soda8m12;       || Reparto 8 y 9 lineas
     soda8w02;

     imagen@;
|FIN;

|VARIABLES;
     aBase            = "";
     aAbre            = "";
     aAbreTxt         = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAlfa2           = "";
     aAlfa3           = "";
     aIPRemoto        = "";
     aCuenta          = "";
     aAste            = "";
     aLong            = "";
     aCuentaD         = "";
     aCuentaH         = "";
     aHora            = "";
     aPag             = "";
     aPag1            = "";
     aPag2            = "";
     aTipoMemoria     = "";
     aTipo            = "";

     aCarac10         = "";
     aCarac13         = "";
     aQueQuiero       = "";
     &aCNAE           = "";
     &nSwPaseAnt      = 0;

     nLong            = 0;
     nSubPanta        = 0;
     nVentana         = 0;
     nNume            = 0;
     nNume1           = 0;
     nNume2           = 0;
     nNume3           = 0;
     nNume4           = 0;
     nRango           = 0;
     nBotonSal        = 0;
     nImporte         = 0;
     nCta40I          = 0;
     nCta41I          = 0;
     nCta407I         = 0;
     nCta4I           = 0;
     nCta40F          = 0;
     nCta41F          = 0;
     nCta407F         = 0;
     nCta4F           = 0;
     nCta4            = 0;
     nCta6            = 0;
     nEjer            = 0;
     nEjerCuadro      = 0;
     nCampo1          = 0;
     nCampo2          = 0;
     nCampo3          = 0;
     nCampo4          = 0;

     nHandle          = 0;
     nVar             = 0;
     nCampo           = 0;
     nNumCampo        = 0;
     nSwContar        = 0;
     nContador1       = 0;
     nContador2       = 0;
     nConta           = 0;
     nTributa         = 0;
     nCasilla         = 0;
     nCuadro          = 0;
     nHay             = 0;

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaDirPlantilla  = "";
     &eaDirTrabajo    = "";
     &eaDirTrabServi  = "";
     &eaDirSerPlan    = "";
     &eaDirSerDoc     = "";
     &eaDirGuarda     = "";
     &eaOrigen        = "";
     &eaDestino       = "";
     &eaFicheroTra    = "";
     &eaFicheroTxt    = "";
     &eaFicheroPla    = "";
     &eaPlanillaTra   = "";
     &eaModoPresenta  = "";
     &enHandleTxt     = 0;
     &eaAsigna        = "";
     &eaConten        = "";
     &enCanti         = 0;
     &eaImporte       = "";
     &enSwTrata       = 0;
     &eaAlfa          = "";
     &enPersonaliza   = 0;
     &eaUnidadBasico  = "";
     &enCuadros       = 0;
     &enMensa         = 0;
     &enTBal          = 0;
     &eaPag1          = "";
     &eaPag2          = "";
     &enUltMemA       = 0;
     &enUltMemP       = 0;
     &enUltMemC       = 0;

     &EURODB          = 0;
     any              = 0;
     aCondi           = "";
     aSigno           = "";
     aFichero         = "";
     aMas             = "";
     aDef             = "";
     nEstado900       = 0;
     nSw              = 0;

     &enEmpresa       = 0;
     &enEjerCuadro    = 0;
|FIN;

|PROCESO VerificaCuadros;
     enCuadros = 1;

     |ABRE #zregcu01;
     #zregcu01#0 = #zhazcrea#0;
     #zregcu01#1 = #zhazcrea#1;
     |LEE 000#zregcu01.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu01;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu02;
     #zregcu02#0 = #zhazcrea#0;
     #zregcu02#1 = #zhazcrea#1;
     |LEE 000#zregcu02.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu02;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu03;
     #zregcu03#0 = #zhazcrea#0;
     #zregcu03#1 = #zhazcrea#1;
     |LEE 000#zregcu03.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu03;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu04;
     #zregcu04#0 = #zhazcrea#0;
     #zregcu04#1 = #zhazcrea#1;
     #zregcu04#2 = 1;
     |LEE 000#zregcu04.];
     |SI FSalida = 0;  |Y #zregcu04#0 = #zhazcrea#0;  |Y #zregcu04#1 = #zhazcrea#1;
         enCuadros = 0;
         |CIERRA #zregcu04;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu04;

     |ABRE #zregcu05;
     #zregcu05#0 = #zhazcrea#0;
     #zregcu05#1 = #zhazcrea#1;
     #zregcu05#2 = 1;
     |LEE 000#zregcu05.];
     |SI FSalida = 0;  |Y #zregcu05#0 = #zhazcrea#0;  |Y #zregcu05#1 = #zhazcrea#1;
         |CIERRA #zregcu05;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu05;

     |ABRE #zregcu06;
     #zregcu06#0 = #zhazcrea#0;
     #zregcu06#1 = #zhazcrea#1;
     |LEE 000#zregcu06.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu06;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu07;
     #zregcu07#0 = #zhazcrea#0;
     #zregcu07#1 = #zhazcrea#1;
     |LEE 000#zregcu07.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu07;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu08;
     #zregcu08#0 = #zhazcrea#0;
     #zregcu08#1 = #zhazcrea#1;
     |LEE 000#zregcu08.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu08;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu09;
     #zregcu09#0 = #zhazcrea#0;
     #zregcu09#1 = #zhazcrea#1;
     |LEE 000#zregcu09.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu09;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu10;
     #zregcu10#0 = #zhazcrea#0;
     #zregcu10#1 = #zhazcrea#1;
     |LEE 000#zregcu10.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu10;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu11;
     #zregcu11#0 = #zhazcrea#0;
     #zregcu11#1 = #zhazcrea#1;
     |LEE 000#zregcu11.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu11;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu12;
     #zregcu12#0 = #zhazcrea#0;
     #zregcu12#1 = #zhazcrea#1;
     |LEE 000#zregcu12.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu12;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu13;
     #zregcu13#0 = #zhazcrea#0;
     #zregcu13#1 = #zhazcrea#1;
     |LEE 000#zregcu13.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu13;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu14;
     #zregcu14#0 = #zhazcrea#0;
     #zregcu14#1 = #zhazcrea#1;
     |LEE 000#zregcu14.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu14;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu15;
     #zregcu15#0 = #zhazcrea#0;
     #zregcu15#1 = #zhazcrea#1;
     |LEE 000#zregcu15.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu15;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu16;
     #zregcu16#0 = #zhazcrea#0;
     #zregcu16#1 = #zhazcrea#1;
     #zregcu16#2 = 1;
     |LEE 000#zregcu16.];
     |SI FSalida = 0;  |Y #zregcu16#0 = #zhazcrea#0;  |Y #zregcu16#1 = #zhazcrea#1;
         enCuadros = 0;
         |CIERRA #zregcu16;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu16;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu17;
     #zregcu17#0 = #zhazcrea#0;
     #zregcu17#1 = #zhazcrea#1;
     |LEE 000#zregcu17.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu17;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu18;
     #zregcu18#0 = #zhazcrea#0;
     #zregcu18#1 = #zhazcrea#1;
     #zregcu18#2 = 1;
     |LEE 000#zregcu18.];
     |SI FSalida = 0;  |Y #zregcu18#0 = #zhazcrea#0;  |Y #zregcu18#1 = #zhazcrea#1;
         enCuadros = 0;
         |CIERRA #zregcu18;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu18;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu19;
     #zregcu19#0 = #zhazcrea#0;
     #zregcu19#1 = #zhazcrea#1;
     |LEE 000#zregcu19.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu19;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu20;
     #zregcu20#0 = #zhazcrea#0;
     #zregcu20#1 = #zhazcrea#1;
     |LEE 000#zregcu20.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu20;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu21;
     #zregcu21#0 = #zhazcrea#0;
     #zregcu21#1 = #zhazcrea#1;
     |LEE 000#zregcu21.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu21;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu22;
     #zregcu22#0 = #zhazcrea#0;
     #zregcu22#1 = #zhazcrea#1;
     #zregcu22#2 = 1;
     |LEE 000#zregcu22.];
     |SI FSalida = 0;  |Y #zregcu22#0 = #zhazcrea#0;  |Y #zregcu22#1 = #zhazcrea#1;
         enCuadros = 0;
         |CIERRA #zregcu22;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu22;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu23;
     #zregcu23#0 = #zhazcrea#0;
     #zregcu23#1 = #zhazcrea#1;
     |LEE 000#zregcu23.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu23;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu24;
     #zregcu24#0 = #zhazcrea#0;
     #zregcu24#1 = #zhazcrea#1;
     |LEE 000#zregcu24.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu24;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu25;
     #zregcu25#0 = #zhazcrea#0;
     #zregcu25#1 = #zhazcrea#1;
     |LEE 000#zregcu25.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu25;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu26;
     #zregcu26#0 = #zhazcrea#0;
     #zregcu26#1 = #zhazcrea#1;
     |LEE 000#zregcu26.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu26;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu27;
     #zregcu27#0 = #zhazcrea#0;
     #zregcu27#1 = #zhazcrea#1;
     |LEE 000#zregcu27.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu27;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu28;
     #zregcu28#0 = #zhazcrea#0;
     #zregcu28#1 = #zhazcrea#1;
     |LEE 000#zregcu28.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu28;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu29;
     #zregcu29#0 = #zhazcrea#0;
     #zregcu29#1 = #zhazcrea#1;
     |LEE 000#zregcu29.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu29;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu32;
     #zregcu32#0 = #zhazcrea#0;
     #zregcu32#1 = #zhazcrea#1;
     |LEE 000#zregcu32.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu32;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu33;
     #zregcu33#0 = #zhazcrea#0;
     #zregcu33#1 = #zhazcrea#1;
     |LEE 000#zregcu33.=;
     |SI FSalida = 0;  enCuadros = 0;  |FINSI;
     |CIERRA #zregcu33;

     |SI enCuadros = 0;  |ACABA;  |FINSI;

     |ABRE #zregcu30;
     #zregcu30#0 = #zhazcrea#0;
     #zregcu30#1 = #zhazcrea#1;
     #zregcu30#2 = 1;
     |LEE 000#zregcu30.];
     |SI FSalida = 0;  |Y #zregcu30#0 = #zhazcrea#0;  |Y #zregcu30#1 = #zhazcrea#1;
         enCuadros = 0;
         |CIERRA #zregcu30;
         |ACABA;
     |FINSI;
     |CIERRA #zregcu30;
|FPRC;

|PROCESO Carga_zregcu01;
     |ABRE #zregcu01;
     #zregcu01#0 = #zhazcrea#0;
     #zregcu01#1 = #zhazcrea#1;
     |LEE 000#zregcu01.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu01;  |FINSI;
     |CIERRA #zregcu01;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu01#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu01#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu01#nCampo# ! 0;
               enCanti  = #zregcu01#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;

     |ABRE #zregcu01;
     #zregcu01#0 = #zhazcrea#0;
     #zregcu01#1 = #zhazcrea#1 - 1;
     |LEE 000#zregcu01.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu01;  |FINSI;
     |CIERRA #zregcu01;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu01#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + "#C1B" + (#zregcu01#aQueQuiero# % 420);  |QBF eaAsigna;
           |SI #zregcu01#nCampo# ! 0;
               enCanti  = #zregcu01#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu02;
     |ABRE #zregcu02;
     #zregcu02#0 = #zhazcrea#0;
     #zregcu02#1 = #zhazcrea#1;
     |LEE 000#zregcu02.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu02;  |FINSI;
     |CIERRA #zregcu02;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu02#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu02#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu02#nCampo# ! 0;
               enCanti  = #zregcu02#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu03;
     |ABRE #zregcu03;
     #zregcu03#0 = #zhazcrea#0;
     #zregcu03#1 = #zhazcrea#1;
     |LEE 000#zregcu03.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu03;  |FINSI;
     |CIERRA #zregcu03;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu03#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu03#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu03#nCampo# ! 0;
               enCanti  = #zregcu03#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu04;
     |SI nConta > 2;
         eaAsigna = "T}1}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}1}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}2}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}2}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;
     |FINSI;

     nConta = nConta + 1;

     eaAsigna = "T}1}" + nConta + "}1}";
     eaConten = #zregcu04#4;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu04#5;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}1}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu04#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}1}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}1}" + nConta + "}4}";
     eaConten = #zregcu04#7;
     |HAZ GrabaContenido;

     eaAsigna = "T}1}" + nConta + "}5}";
     eaConten = #zregcu04#8;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}1}";
     eaConten = #zregcu04#4;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}2}";
     enCanti  = #zregcu04#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}3}";
     enCanti  = #zregcu04#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}2}" + nConta + "}4}";
     enCanti  = #zregcu04#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;
|FPRC;

|DEFBUCLE zregcu04;
     #zregcu04#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu04;
|FIN;

|PROCESO Carga_zregcu04;
     nConta = 2;
     |BUCLE zregcu04;
|FPRC;

|PROCESO Carga_zregcu05;
     |ABRE #zregcu05;
     #zregcu05#0 = #zhazcrea#0;
     #zregcu05#1 = #zhazcrea#1;
     |LEE 000#zregcu05.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu05;  |FINSI;
     |CIERRA #zregcu05;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu05#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu05#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu05#nCampo# ! 0;
               enCanti  = #zregcu05#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu06;
     |ABRE #zregcu06;
     #zregcu06#0 = #zhazcrea#0;
     #zregcu06#1 = #zhazcrea#1;
     |LEE 000#zregcu06.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu06;  |FINSI;
     |CIERRA #zregcu06;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu06#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu06#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu06#nCampo# ! 0;
               enCanti  = #zregcu06#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu07;
     |ABRE #zregcu07;
     #zregcu07#0 = #zhazcrea#0;
     #zregcu07#1 = #zhazcrea#1;
     |LEE 000#zregcu07.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu07;  |FINSI;
     |CIERRA #zregcu07;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu07#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu07#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu07#nCampo# ! 0;
               enCanti  = #zregcu07#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu08;
     |ABRE #zregcu08;
     #zregcu08#0 = #zhazcrea#0;
     #zregcu08#1 = #zhazcrea#1;
     |LEE 000#zregcu08.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu08;  |FINSI;
     |CIERRA #zregcu08;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu08#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu08#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu08#nCampo# ! 0;
               enCanti  = #zregcu08#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu09;
     |ABRE #zregcu09;
     #zregcu09#0 = #zhazcrea#0;
     #zregcu09#1 = #zhazcrea#1;
     |LEE 000#zregcu09.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu09;  |FINSI;
     |CIERRA #zregcu09;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu09#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu09#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu09#nCampo# ! 0;
               enCanti  = #zregcu09#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu10;
     |ABRE #zregcu10;
     #zregcu10#0 = #zhazcrea#0;
     #zregcu10#1 = #zhazcrea#1;
     |LEE 000#zregcu10.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu10;  |FINSI;
     |CIERRA #zregcu10;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu10#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu10#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu10#nCampo# ! 0;
               enCanti  = #zregcu10#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu11;
     |ABRE #zregcu11;
     #zregcu11#0 = #zhazcrea#0;
     #zregcu11#1 = #zhazcrea#1;
     |LEE 000#zregcu11.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu11;  |FINSI;
     |CIERRA #zregcu11;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu11#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu11#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu11#nCampo# ! 0;
               enCanti  = #zregcu11#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu31;
     |ABRE #zregcu31;
     #zregcu31#0 = #zhazcrea#0;
     #zregcu31#1 = #zhazcrea#1;
     |LEE 000#zregcu31.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu31;  |FINSI;
     |CIERRA #zregcu31;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu31#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu31#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu31#nCampo# ! 0;
               enCanti  = #zregcu31#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu12;
     |ABRE #zregcu12;
     #zregcu12#0 = #zhazcrea#0;
     #zregcu12#1 = #zhazcrea#1;
     |LEE 000#zregcu12.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu12;  |FINSI;
     |CIERRA #zregcu12;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu12#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu12#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu12#nCampo# ! 0;
               enCanti  = #zregcu12#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu13;
     |ABRE #zregcu13;
     #zregcu13#0 = #zhazcrea#0;
     #zregcu13#1 = #zhazcrea#1;
     |LEE 000#zregcu13.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu13;  |FINSI;
     |CIERRA #zregcu13;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu13#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu13#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu13#nCampo# ! 0;
               enCanti  = #zregcu13#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu14;
     |ABRE #zregcu14;
     #zregcu14#0 = #zhazcrea#0;
     #zregcu14#1 = #zhazcrea#1;
     |LEE 000#zregcu14.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu14;  |FINSI;
     |CIERRA #zregcu14;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu14#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu14#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu14#nCampo# ! 0;
               enCanti  = #zregcu14#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu15;
     |ABRE #zregcu15;
     #zregcu15#0 = #zhazcrea#0;
     #zregcu15#1 = #zhazcrea#1;
     |LEE 000#zregcu15.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu15;  |FINSI;
     |CIERRA #zregcu15;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu15#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu15#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu15#nCampo# ! 0;
               enCanti  = #zregcu15#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu16;
     |SI nConta > 2;
         eaAsigna = "T}6}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}6}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}6}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 2;

         ||Combinar columnas

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "6," + nConta + ",3,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "6," + nConta + ",3,3" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;
     |FINSI;

     eaAsigna = "T}6}" + nConta + "}2}";
     eaConten = #zregcu16#2;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu16#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}6}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu16#4;
     eaAsigna = "T}6}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}5}";
     enCanti  = #zregcu16#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu16#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}6}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu16#7;
     eaAsigna = "T}6}" + nConta + "}7}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 2;

     eaAsigna = "T}6}" + nConta + "}4}";
     enCanti  = #zregcu16#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}5}";
     enCanti  = #zregcu16#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}6}";
     enCanti  = #zregcu16#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}6}" + nConta + "}7}";
     enCanti  = #zregcu16#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu16;
     #zregcu16#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu16;
|FIN;

|PROCESO Carga_zregcu16;
     nConta = 2;
     |BUCLE zregcu16;
|FPRC;

|PROCESO Carga_zregcu17;
     |ABRE #zregcu17;
     #zregcu17#0 = #zhazcrea#0;
     #zregcu17#1 = #zhazcrea#1;
     |LEE 000#zregcu17.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu17;  |FINSI;
     |CIERRA #zregcu17;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu17#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu17#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu17#nCampo# ! 0;
               enCanti  = #zregcu17#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu32;
     |ABRE #zregcu32;
     #zregcu32#0 = #zhazcrea#0;
     #zregcu32#1 = #zhazcrea#1;
     |LEE 000#zregcu32.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu32;  |FINSI;
     |CIERRA #zregcu32;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu32#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu32#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu32#nCampo# ! 0;
               enCanti  = #zregcu32#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu33;
     |ABRE #zregcu33;
     #zregcu33#0 = #zhazcrea#0;
     #zregcu33#1 = #zhazcrea#1;
     |LEE 000#zregcu33.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu33;  |FINSI;
     |CIERRA #zregcu33;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu33#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu33#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu33#nCampo# ! 0;
               enCanti  = #zregcu33#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu18;
     |SI nConta > 2;
         eaAsigna = "T}7}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}6}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}7}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}8}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}9}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}7}10}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}7}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 1;

         ||Combinar columnas

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "7," + nConta + ",9,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;

         nConta   = nConta + 1;
     |FINSI;

     eaAsigna = "T}7}" + nConta + "}3}";
     eaConten = #zregcu18#3;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu18#4;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu18#5;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}5}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |SI #zregcu18#6 = "G";  eaAlfa = "Grupo";       |FINSI;
     |SI #zregcu18#6 = "M";  eaAlfa = "Multigrupo";  |FINSI;
     |SI #zregcu18#6 = "A";  eaAlfa = "Asociada";    |FINSI;

     eaAsigna = "T}7}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 4;

     eaAsigna = "T}7}" + nConta + "}3}";
     enCanti  = #zregcu18#7;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}4}";
     enCanti  = #zregcu18#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}5}";
     enCanti  = #zregcu18#9;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}6}";
     enCanti  = #zregcu18#10;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}7}";
     enCanti  = #zregcu18#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}8}";
     enCanti  = #zregcu18#12;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}9}";
     enCanti  = #zregcu18#13;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}10}";
     enCanti  = #zregcu18#14;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}11}";
     enCanti  = #zregcu18#15;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 3;

     eaAlfa   = #zregcu18#16;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}7}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}4}";
     enCanti  = #zregcu18#17;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}5}";
     enCanti  = #zregcu18#18;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}6}";
     enCanti  = #zregcu18#19;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}7}" + nConta + "}7}";
     enCanti  = #zregcu18#20;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu18;
     #zregcu18#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu18;
|FIN;

|PROCESO Carga_zregcu18;
     nConta = 2;
     |BUCLE zregcu18;
|FPRC;

|PROCESO Carga_zregcu19;
     |ABRE #zregcu19;
     #zregcu19#0 = #zhazcrea#0;
     #zregcu19#1 = #zhazcrea#1;
     |LEE 000#zregcu19.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu19;  |FINSI;
     |CIERRA #zregcu19;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu19#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu19#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu19#nCampo# ! 0;
               enCanti  = #zregcu19#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu20;
     |ABRE #zregcu20;
     #zregcu20#0 = #zhazcrea#0;
     #zregcu20#1 = #zhazcrea#1;
     |LEE 000#zregcu20.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu20;  |FINSI;
     |CIERRA #zregcu20;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu20#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu20#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu20#nCampo# ! 0;
               enCanti  = #zregcu20#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu21;
     |ABRE #zregcu21;
     #zregcu21#0 = #zhazcrea#0;
     #zregcu21#1 = #zhazcrea#1;
     |LEE 000#zregcu21.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu21;  |FINSI;
     |CIERRA #zregcu21;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu21#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu21#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu21#nCampo# ! 0;
               enCanti  = #zregcu21#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu22;
     |SI nConta > 2;
         eaAsigna = "T}8}1}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}3}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}4}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}5}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}6}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         eaAsigna = "T}8}7}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}8}1}1}+P";  eaConten = "";  |HAZ GrabaContenido;

         nConta   = nConta + 2;

         eaAlfa   = "J" + &13 + &10;                     |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "8," + nConta + ",5,2" + &13 + &10;  |XGRABA enHandleTxt, eaAlfa;
         eaAlfa   = "" + &13 + &10;                      |XGRABA enHandleTxt, eaAlfa;
     |FINSI;

     eaAlfa   = #zregcu22#2;
     eaAsigna = "T}8}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu22#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu22#4;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}5}";
     enCanti  = #zregcu22#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta   = nConta + 2;

     eaAlfa   = #zregcu22#6;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}4}";
     enCanti  = #zregcu22#7;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}5}";
     enCanti  = #zregcu22#8;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAlfa   = #zregcu22#9;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}6}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     nConta = nConta + 2;

     eaAlfa   = #zregcu22#10;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}8}" + nConta + "}3}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}4}";
     enCanti  = #zregcu22#11;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     aAlfa  = #zregcu22#10;  |QBF aAlfa;
     eaAlfa = " ";

     |SI aAlfa ! "";
         |SI #zregcu22#12 = "1";  eaAlfa = "Otorgada";  |FINSI;
         |SI #zregcu22#12 = "2";  eaAlfa = "Recibida";  |FINSI;
     |FINSI;

     eaAsigna = "T}8}" + nConta + "}5}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}6}";
     enCanti  = #zregcu22#13;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     eaAsigna = "T}8}" + nConta + "}7}";
     enCanti  = #zregcu22#14;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     nConta = nConta + 1;
|FPRC;

|DEFBUCLE zregcu22;
     #zregcu22#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu22;
|FIN;

|PROCESO Carga_zregcu22;
     nConta = 2;
     |BUCLE zregcu22;
|FPRC;

|PROCESO Carga_zregcu23;
     |ABRE #zregcu23;
     #zregcu23#0 = #zhazcrea#0;
     #zregcu23#1 = #zhazcrea#1;
     |LEE 000#zregcu23.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu23;  |FINSI;
     |CIERRA #zregcu23;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu23#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu23#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu23#nCampo# ! 0;
               enCanti  = #zregcu23#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu24;
     |ABRE #zregcu24;
     #zregcu24#0 = #zhazcrea#0;
     #zregcu24#1 = #zhazcrea#1;
     |LEE 000#zregcu24.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu24;  |FINSI;
     |CIERRA #zregcu24;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu24#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu24#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu24#nCampo# ! 0;
               enCanti  = #zregcu24#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu25;
     |ABRE #zregcu25;
     #zregcu25#0 = #zhazcrea#0;
     #zregcu25#1 = #zhazcrea#1;
     |LEE 000#zregcu25.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu25;  |FINSI;
     |CIERRA #zregcu25;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu25#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu25#aQueQuiero#;  |QBF eaAsigna;
           |SI nCampo ! 15
               |SI #zregcu25#nCampo# ! 0;
                   enCanti  = #zregcu25#nCampo#;
                   |HAZ SeparaImporte;
                   eaConten = eaImporte;  |QBT eaConten;
               |SINO;
                   eaConten = "";
               |FINSI;
           |SINO;
               eaAlfa   = #zregcu25#15;  |HAZ QuitaRarosDSXML;
               eaConten = eaAlfa;
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu26;
     |ABRE #zregcu26;
     #zregcu26#0 = #zhazcrea#0;
     #zregcu26#1 = #zhazcrea#1;
     |LEE 000#zregcu26.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu26;  |FINSI;
     |CIERRA #zregcu26;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu26#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu26#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu26#nCampo# ! 0;
               enCanti  = #zregcu26#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu27;
     |ABRE #zregcu27;
     #zregcu27#0 = #zhazcrea#0;
     #zregcu27#1 = #zhazcrea#1;
     |LEE 000#zregcu27.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu27;  |FINSI;
     |CIERRA #zregcu27;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu27#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu27#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu27#nCampo# ! 0;
               enCanti  = #zregcu27#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu28;
     |ABRE #zregcu28;
     #zregcu28#0 = #zhazcrea#0;
     #zregcu28#1 = #zhazcrea#1;
     |LEE 000#zregcu28.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu28;  |FINSI;
     |CIERRA #zregcu28;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu28#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu28#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu28#nCampo# ! 0;
               enCanti  = #zregcu28#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO Carga_zregcu29;
     |ABRE #zregcu29;
     #zregcu29#0 = #zhazcrea#0;
     #zregcu29#1 = #zhazcrea#1;
     |LEE 000#zregcu29.=;
     |SI FSalida ! 0;  |DDEFECTO #zregcu29;  |FINSI;
     |CIERRA #zregcu29;

     aQueQuiero = "|NC";
     aAlfa      = #zregcu29#aQueQuiero#;
     nNumCampo  = aAlfa;
     nNumCampo  = nNumCampo - 1;

     |PARA nCampo = 2;  |SI nCampo [ nNumCampo;  |HACIENDO nCampo = nCampo + 1;
           aQueQuiero = "|C" + (("000" + nCampo) % -103) + "NOMBRE";
           eaAsigna   = "V" + #zregcu29#aQueQuiero#;  |QBF eaAsigna;
           |SI #zregcu29#nCampo# ! 0;
               enCanti  = #zregcu29#nCampo#;
               |HAZ SeparaImporte;
               eaConten = eaImporte;  |QBT eaConten;
           |SINO;
               eaConten = "";
           |FINSI;
           |HAZ GrabaContenido;
     |SIGUE;
|FPRC;

|PROCESO zregcu30;
     nConta = nConta + 1;
     |SI nConta > 3;
         eaAsigna = "T}9}2}1}+G";  eaConten = "";  |HAZ GrabaContenido;
         eaAsigna = "T}9}2}1}+P";  eaConten = "";  |HAZ GrabaContenido;
     |FINSI;

     eaAlfa   = #zregcu30#3;          |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}1}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     |SI #zregcu30#4 = "1";  eaAlfa = "Administracin local";         |FINSI;
     |SI #zregcu30#4 = "2";  eaAlfa = "Administracin autonmica";    |FINSI;
     |SI #zregcu30#4 = "3";  eaAlfa = "Administracin estatal";       |FINSI;
     |SI #zregcu30#4 = "4";  eaAlfa = "Administracin internacional"; |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}2}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;

     eaAsigna = "T}9}" + nConta + "}3}";
     enCanti  = #zregcu30#5;
     |HAZ SeparaImporte;
     eaConten = eaImporte;  |QBT eaConten;
     |HAZ GrabaContenido;

     |SI #zregcu30#6 = "1";  eaAlfa = "Subvencin";         |FINSI;
     |SI #zregcu30#6 = "2";  eaAlfa = "Donacin o legado";  |FINSI;

     |HAZ QuitaRarosDSXML;
     eaAsigna = "T}9}" + nConta + "}4}";
     eaConten = eaAlfa;
     |HAZ GrabaContenido;
|FPRC;

|DEFBUCLE zregcu30;
     #zregcu30#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu30;
|FIN;

|PROCESO Carga_zregcu30;
     nConta = 1;
     |BUCLE zregcu30;
|FPRC;

|PROCESO DesImagen_Cuadr;
    |SI aDef = "";  |ACABA;  |FINSI;

    |CIERRA #imagen@;
    |DESCARGA_DEF #imagen@; aDef = "";
|FPRC;

|PROCESO CarImagen_Cuadr;
     |HAZ DesImagen_Cuadr;

     |DBASE aMas;
     aDef = aMas + "def/" + aFichero;
     |CARGA_DEF aDef, imagen@;
     |SI FSalida ! 0;
         aDef = "";
         |ACABA;
     |FINSI;

     |SI aFichero = "zregcu04";   |ACABA;   |FINSI;

     |ABRE #imagen@;
     #imagen@#0 = #zhazcrea#0;
     #imagen@#1 = nEjer;
     |LEE 000#imagen@.=;
     nEstado900 = FSalida;
|FPRC;

|PROCESO Quadre01;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu01;
     #zregcu01#0 = #zhazcrea#0;
     #zregcu01#1 = #zhazcrea#1;
     |LEE 101#zregcu01.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu01;
         #zregcu01#0  = #zhazcrea#0;
         #zregcu01#1  = #zhazcrea#1;
         |GRABA 020#zregcu01.b;
     |FINSI;

     #zregcu01#2  = #imagen@#5;  #zregcu01#15 = #imagen@#18;  #zregcu01#28 = #imagen@#31;
     #zregcu01#6  = #imagen@#9;  #zregcu01#19 = #imagen@#22;  #zregcu01#32 = #imagen@#35;
     #zregcu01#10 = #imagen@#14; #zregcu01#23 = #imagen@#27;  #zregcu01#36 = #imagen@#40;

     |GRABA 020#zregcu01.a;
     |LIBERA #zregcu01;
     |CIERRA #zregcu01;
|FPRC;

|PROCESO Quadre02;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #zregcu02;
     #zregcu02#0 = #zhazcrea#0;
     #zregcu02#1 = #zhazcrea#1;
     |LEE 101#zregcu02.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu02;
         #zregcu02#0  = #zhazcrea#0;
         #zregcu02#1  = #zhazcrea#1;
         |GRABA 020#zregcu02.b;
     |FINSI;

     #zregcu02#3  = #imagen@#2;  #zregcu02#11 = #imagen@#10;  #zregcu02#19 = #imagen@#18; #zregcu02#27 = #imagen@#26;
     #zregcu02#5  = #imagen@#4;  #zregcu02#13 = #imagen@#12;  #zregcu02#21 = #imagen@#20; #zregcu02#29 = #imagen@#28;
     #zregcu02#7  = #imagen@#6;  #zregcu02#15 = #imagen@#14;  #zregcu02#23 = #imagen@#22; #zregcu02#31 = #imagen@#30;
     #zregcu02#9  = #imagen@#8;  #zregcu02#17 = #imagen@#16;  #zregcu02#25 = #imagen@#24; #zregcu02#33 = #imagen@#32;

     #zregcu02#35  = #imagen@#34;  #zregcu02#43 = #imagen@#42;  #zregcu02#51 = #imagen@#50; #zregcu02#59 = #imagen@#58;
     #zregcu02#37  = #imagen@#36;  #zregcu02#45 = #imagen@#44;  #zregcu02#53 = #imagen@#52; #zregcu02#61 = #imagen@#60;
     #zregcu02#39  = #imagen@#38;  #zregcu02#47 = #imagen@#46;  #zregcu02#55 = #imagen@#54; #zregcu02#63 = #imagen@#62;
     #zregcu02#41  = #imagen@#40;  #zregcu02#49 = #imagen@#48;  #zregcu02#57 = #imagen@#56; #zregcu02#65 = #imagen@#64;

     |GRABA 020#zregcu02.a;
     |LIBERA #zregcu02;
     |CIERRA #zregcu02;
|FPRC;

|PROCESO Quadre03;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu03;
     #zregcu03#0 = #zhazcrea#0;
     #zregcu03#1 = #zhazcrea#1;
     |LEE 101#zregcu03.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu03;
         #zregcu03#0  = #zhazcrea#0;
         #zregcu03#1  = #zhazcrea#1;
         |GRABA 020#zregcu03.b;
     |FINSI;

     #zregcu03#2 = #imagen@#7;   #zregcu03#13 = #imagen@#18;
     #zregcu03#3 = #imagen@#8;   #zregcu03#14 = #imagen@#19;
     #zregcu03#4 = #imagen@#9;   #zregcu03#15 = #imagen@#20;
     #zregcu03#5 = #imagen@#10;  #zregcu03#16 = #imagen@#21;
     #zregcu03#6 = #imagen@#11;  #zregcu03#17 = #imagen@#22;
     #zregcu03#7 = #imagen@#12;  #zregcu03#18 = #imagen@#23;

     |PARA nCampo3 = 24;  |SI nCampo3 [ 34;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #zregcu03#nCampo3# = #zregcu03#nCampo1# + #zregcu03#nCampo2#;
     |SIGUE;

     #zregcu03#35 = #imagen@#40;   #zregcu03#46 = #imagen@#51;
     #zregcu03#36 = #imagen@#41;   #zregcu03#47 = #imagen@#52;
     #zregcu03#37 = #imagen@#42;   #zregcu03#48 = #imagen@#53;
     #zregcu03#38 = #imagen@#43;   #zregcu03#49 = #imagen@#54;
     #zregcu03#39 = #imagen@#44;   #zregcu03#50 = #imagen@#55;
     #zregcu03#40 = #imagen@#45;   #zregcu03#51 = #imagen@#56;

     |PARA nCampo3 = 57;  |SI nCampo3 [ 67;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #zregcu03#nCampo3# = #zregcu03#nCampo1# + #zregcu03#nCampo2#;
     |SIGUE;

     |GRABA 020#zregcu03.a;
     |LIBERA #zregcu03;
     |CIERRA #zregcu03;
|FPRC;

|PROCESO zregcu04I;
     |SI #zhazcrea#15 ! "A";
         #zregcu04#0 = #zhazcrea#0;
         #zregcu04#1 = #zhazcrea#1;
         #zregcu04#2 = #imagen@#2;
         |LEE 101#zregcu04.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu04;
             #zregcu04#0 = #zhazcrea#0;
             #zregcu04#1 = #zhazcrea#1;
             #zregcu04#2 = #imagen@#2;
             |GRABA 020#zregcu04.b;
         |FINSI;
         |PARA nCampo = 3;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
               #zregcu04#nCampo# = #imagen@#nCampo#;
         |SIGUE;
         |GRABA 020#zregcu04.a;
         |LIBERA #zregcu04;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         #zregcu18#0 = #zhazcrea#0;
         #zregcu18#1 = #zhazcrea#1;
         #zregcu18#2 = #imagen@#2;
         |LEE 101#zregcu18.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu18;
             #zregcu18#0 = #zhazcrea#0;
             #zregcu18#1 = #zhazcrea#1;
             #zregcu18#2 = #imagen@#2;
             |GRABA 020#zregcu18.b;
         |FINSI;

         #zregcu18#3  = #imagen@#4;
         #zregcu18#4  = #imagen@#5;
         #zregcu18#5  = #imagen@#6;
         #zregcu18#6  = #imagen@#3;
         #zregcu18#7  = #imagen@#7;
         #zregcu18#8  = #imagen@#8;
         #zregcu18#9  = #imagen@#9;

         |GRABA 020#zregcu18.a;
         |LIBERA #zregcu18;
     |FINSI;
|FPRC;

|DEFBUCLE zregcu04I;
     #imagen@#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu04I;
|FIN;

|PROCESO Quadre04;

    |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

    |HAZ CarImagen_Cuadr;

    |SI aDef ! "";
        |ABRE #zregcu04;
        |ABRE #zregcu18;
        |BUCLE zregcu04I;
        |CIERRA #zregcu04;
        |CIERRA #zregcu18;

        |ABRE #imagen@;
    |FINSI;
|FPRC;

|PROCESO zregcu18I;
     |SI #zhazcrea#15 ! "A";
         #zregcu04#0 = #zhazcrea#0;
         #zregcu04#1 = #zhazcrea#1;
         #zregcu04#2 = #imagen@#2;
         |LEE 101#zregcu04.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu04;
             #zregcu04#0 = #zhazcrea#0;
             #zregcu04#1 = #zhazcrea#1;
             #zregcu04#2 = #imagen@#2;
             |GRABA 020#zregcu04.b;
         |FINSI;

         #zregcu04#3  = #imagen@#6;
         #zregcu04#4  = #imagen@#3;
         #zregcu04#5  = #imagen@#4;
         #zregcu04#6  = #imagen@#5;
         #zregcu04#7  = #imagen@#7;
         #zregcu04#8  = #imagen@#8;
         #zregcu04#9  = #imagen@#9;

         |GRABA 020#zregcu04.a;
         |LIBERA #zregcu04;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         #zregcu18#0 = #zhazcrea#0;
         #zregcu18#1 = #zhazcrea#1;
         #zregcu18#2 = #imagen@#2;
         |LEE 101#zregcu18.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu18;
             #zregcu18#0 = #zhazcrea#0;
             #zregcu18#1 = #zhazcrea#1;
             #zregcu18#2 = #imagen@#2;
             |GRABA 020#zregcu18.b;
         |FINSI;

         #zregcu18#3  = #imagen@#3;
         #zregcu18#4  = #imagen@#4;
         #zregcu18#5  = #imagen@#5;
         #zregcu18#6  = #imagen@#6;
         #zregcu18#7  = #imagen@#7;
         #zregcu18#8  = #imagen@#8;
         #zregcu18#9  = #imagen@#9;

         |GRABA 020#zregcu18.a;
         |LIBERA #zregcu18;
     |FINSI;
|FPRC;

|DEFBUCLE zregcu18I;
     #imagen@#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu18I;
|FIN;

|PROCESO Quadre18;

    |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

    |HAZ CarImagen_Cuadr;

    |SI aDef ! "";
        |ABRE #zregcu04;
        |ABRE #zregcu18;
        |BUCLE zregcu18I;
        |CIERRA #zregcu04;
        |CIERRA #zregcu18;

        |ABRE #imagen@;
    |FINSI;
|FPRC;

|PROCESO zregcu16I;
     #zregcu16#0 = #zhazcrea#0;
     #zregcu16#1 = #zhazcrea#1;
     #zregcu16#2 = #imagen@#2;
     |LEE 101#zregcu16.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu16;
         #zregcu16#0 = #zhazcrea#0;
         #zregcu16#1 = #zhazcrea#1;
         #zregcu16#2 = #imagen@#2;
         |GRABA 020#zregcu16.b;
     |FINSI;

     #zregcu16#3  = #imagen@#3;
     #zregcu16#4  = #imagen@#4;
     #zregcu16#5  = #imagen@#5;
     #zregcu16#6  = #imagen@#6;
     #zregcu16#7  = #imagen@#7 + 1;
     #zregcu16#8  = #imagen@#9;
     #zregcu16#9  = 0;
     #zregcu16#10 = #imagen@#10;
     #zregcu16#11 = #imagen@#11;

     |GRABA 020#zregcu16.a;
     |LIBERA #zregcu16;
|FPRC;

|DEFBUCLE zregcu16I;
     #imagen@#1003;
     ;
     #zhazcrea#0, nEjer, 001;
     #zhazcrea#0, nEjer, 999;
     be;
     NULL, zregcu16I;
|FIN;

|PROCESO Quadre16;
    |HAZ CarImagen_Cuadr;

    |SI aDef ! "";
        |ABRE #zregcu16;
        |BUCLE zregcu16I;
        |CIERRA #zregcu16;

        |ABRE #imagen@;
    |FINSI;
|FPRC;

|PROCESO Quadre05;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #zregcu05;
     #zregcu05#0 = #zhazcrea#0;
     #zregcu05#1 = #zhazcrea#1;
     |LEE 101#zregcu05.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu05;
         #zregcu05#0  = #zhazcrea#0;
         #zregcu05#1  = #zhazcrea#1;
         |GRABA 020#zregcu05.b;
     |FINSI;

     #zregcu05#3  = #imagen@#2; #zregcu05#11 = #imagen@#10; #zregcu05#19 = #imagen@#18;
     #zregcu05#5  = #imagen@#4; #zregcu05#13 = #imagen@#12; #zregcu05#21 = #imagen@#20;
     #zregcu05#7  = #imagen@#6; #zregcu05#15 = #imagen@#14; #zregcu05#23 = #imagen@#22;
     #zregcu05#9  = #imagen@#8; #zregcu05#17 = #imagen@#16; #zregcu05#25 = #imagen@#24;

     #zregcu05#27 = #imagen@#26; #zregcu05#35 = #imagen@#34; #zregcu05#43 = #imagen@#42;
     #zregcu05#29 = #imagen@#28; #zregcu05#37 = #imagen@#36; #zregcu05#45 = #imagen@#44;
     #zregcu05#31 = #imagen@#30; #zregcu05#39 = #imagen@#38; #zregcu05#47 = #imagen@#46;
     #zregcu05#33 = #imagen@#32; #zregcu05#41 = #imagen@#40; #zregcu05#49 = #imagen@#48;

     |GRABA 020#zregcu05.a;
     |LIBERA #zregcu05;
     |CIERRA #zregcu05;
|FPRC;

|PROCESO Quadre08;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#15 ! "A";
         |ABRE #zregcu08;
         #zregcu08#0 = #zhazcrea#0;
         #zregcu08#1 = #zhazcrea#1;
         |LEE 101#zregcu08.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu08;
             #zregcu08#0  = #zhazcrea#0;
             #zregcu08#1  = #zhazcrea#1;
             |GRABA 020#zregcu08.b;
         |FINSI;

         #zregcu08#18 = #imagen@#4;  #zregcu08#19 = #imagen@#5;
         #zregcu08#20 = #imagen@#6;  #zregcu08#21 = #imagen@#7;
         #zregcu08#22 = #imagen@#8;  #zregcu08#23 = #imagen@#9;
         #zregcu08#24 = #imagen@#10; #zregcu08#25 = #imagen@#11;
         #zregcu08#26 = #imagen@#12; #zregcu08#27 = #imagen@#13;
         #zregcu08#28 = #imagen@#14; #zregcu08#29 = #imagen@#15;

         #zregcu08#02 = #zregcu08#03 + #zregcu08#04 + #zregcu08#05;
         #zregcu08#07 = #zregcu08#08 + #zregcu08#09 + #zregcu08#10;
         #zregcu08#16 = #zregcu08#17 + #zregcu08#18 + #zregcu08#19;
         #zregcu08#21 = #zregcu08#22 + #zregcu08#23 + #zregcu08#24;

         #zregcu08#34 = #zregcu08#02 + #zregcu08#06;
         #zregcu08#35 = #zregcu08#07 + #zregcu08#11;
         #zregcu08#36 = #zregcu08#30 + #zregcu08#31;
         #zregcu08#37 = #zregcu08#12 + #zregcu08#13;
         #zregcu08#38 = #zregcu08#16 + #zregcu08#20;
         #zregcu08#39 = #zregcu08#21 + #zregcu08#25;
         #zregcu08#40 = #zregcu08#32 + #zregcu08#33;
         #zregcu08#41 = #zregcu08#26 + #zregcu08#27;

         |GRABA 020#zregcu08.a;
         |LIBERA #zregcu08;
         |CIERRA #zregcu08;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #zregcu20;
         #zregcu20#0 = #zhazcrea#0;
         #zregcu20#1 = #zhazcrea#1;
         |LEE 101#zregcu20.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu20;
             #zregcu20#0  = #zhazcrea#0;
             #zregcu20#1  = #zhazcrea#1;
             |GRABA 020#zregcu20.b;
         |FINSI;

         #zregcu20#24 = #imagen@#2;
         #zregcu20#26 = #imagen@#4;
         #zregcu20#27 = #imagen@#5;
         #zregcu20#28 = #imagen@#6;
         #zregcu20#30 = #imagen@#7;
         #zregcu20#31 = #imagen@#8;
         #zregcu20#32 = #imagen@#9;
         #zregcu20#33 = #imagen@#10;
         #zregcu20#34 = #imagen@#11;
         #zregcu20#40 = #imagen@#12;
         #zregcu20#41 = #imagen@#13;
         #zregcu20#42 = #imagen@#14;
         #zregcu20#43 = #imagen@#15;

         #zregcu20#03 = #zregcu20#04 + #zregcu20#05 + #zregcu20#06;
         #zregcu20#02 = #zregcu20#03 + #zregcu20#07;
         #zregcu20#24 = #zregcu20#25 + #zregcu20#26 + #zregcu20#27;
         #zregcu20#23 = #zregcu20#24 + #zregcu20#28;

         #zregcu20#09 = #zregcu20#10 + #zregcu20#11 + #zregcu20#12;
         #zregcu20#08 = #zregcu20#09 + #zregcu20#13;
         #zregcu20#30 = #zregcu20#31 + #zregcu20#32 + #zregcu20#33;
         #zregcu20#29 = #zregcu20#30 + #zregcu20#34;

         #zregcu20#14 = #zregcu20#15 + #zregcu20#16 + #zregcu20#17;
         #zregcu20#35 = #zregcu20#36 + #zregcu20#37 + #zregcu20#38;

         #zregcu20#18 = #zregcu20#19 + #zregcu20#20;
         #zregcu20#39 = #zregcu20#40 + #zregcu20#41;

         |GRABA 020#zregcu20.a;
         |LIBERA #zregcu20;
         |CIERRA #zregcu20;
    |FINSI;
|FPRC;

|PROCESO Quadre09;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "A";  |ACABA;  |FINSI;

     |ABRE #zregcu09;
     #zregcu09#0 = #zhazcrea#0;
     #zregcu09#1 = #zhazcrea#1;
     |LEE 101#zregcu09.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu09;
         #zregcu09#0  = #zhazcrea#0;
         #zregcu09#1  = #zhazcrea#1;
         |GRABA 020#zregcu09.b;
     |FINSI;

     #zregcu09#8  = #imagen@#2; #zregcu09#9  = #imagen@#3;
     #zregcu09#10 = #imagen@#4; #zregcu09#11 = #imagen@#5;
     #zregcu09#12 = #imagen@#6; #zregcu09#13 = #imagen@#7;

     |GRABA 020#zregcu09.a;
     |LIBERA #zregcu09;
     |CIERRA #zregcu09;
|FPRC;

|PROCESO Quadre11;
     |SI #zhazcrea#1 > 2017; aFichero = "zregcu31"; |FINSI;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#1 [ 2016;

         |SI #zhazcrea#15 ! "A";
             |ABRE #zregcu11;
             #zregcu11#0 = #zhazcrea#0;
             #zregcu11#1 = #zhazcrea#1;
             |LEE 101#zregcu11.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu11;
                 #zregcu11#0  = #zhazcrea#0;
                 #zregcu11#1  = #zhazcrea#1;
                 |GRABA 020#zregcu11.b;
             |FINSI;

             #zregcu11#8  = #imagen@#2; #zregcu11#20 = #imagen@#14;
             #zregcu11#9  = #imagen@#3; #zregcu11#21 = #imagen@#15;
             #zregcu11#10 = #imagen@#4; #zregcu11#22 = #imagen@#16;
             #zregcu11#11 = #imagen@#5; #zregcu11#23 = #imagen@#17;
             #zregcu11#12 = #imagen@#6; #zregcu11#24 = #imagen@#18;
             #zregcu11#13 = #imagen@#7; #zregcu11#25 = #imagen@#19;

             |GRABA 020#zregcu11.a;
             |LIBERA #zregcu11;
             |CIERRA #zregcu11;
         |FINSI;

         |SI #zhazcrea#15 = "A";
             |ABRE #zregcu23;
             #zregcu23#0 = #zhazcrea#0;
             #zregcu23#1 = #zhazcrea#1;
             |LEE 101#zregcu23.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu23;
                 #zregcu23#0  = #zhazcrea#0;
                 #zregcu23#1  = #zhazcrea#1;
                 |GRABA 020#zregcu23.b;
             |FINSI;

             #zregcu23#14  = #imagen@#2;
             #zregcu23#19  = #imagen@#3;
             #zregcu23#20  = #imagen@#4;
             #zregcu23#21  = #imagen@#5;
             #zregcu23#24  = #imagen@#6;
             #zregcu23#25  = #imagen@#7;

             #zregcu23#38  = #imagen@#14;
             #zregcu23#43  = #imagen@#15;
             #zregcu23#44  = #imagen@#16;
             #zregcu23#45  = #imagen@#17;
             #zregcu23#48  = #imagen@#18;
             #zregcu23#49  = #imagen@#19;

             #zregcu23#03 = #zregcu23#04 + #zregcu23#05;   |PINTA #zregcu23#03;
             #zregcu23#06 = #zregcu23#07 + #zregcu23#08;   |PINTA #zregcu23#06;
             #zregcu23#11 = #zregcu23#12 + #zregcu23#13;   |PINTA #zregcu23#11;

             #zregcu23#15 = #zregcu23#16 + #zregcu23#17;   |PINTA #zregcu23#15;
             #zregcu23#18 = #zregcu23#19 + #zregcu23#20;   |PINTA #zregcu23#18;
             #zregcu23#23 = #zregcu23#24 + #zregcu23#25;   |PINTA #zregcu23#23;

             #zregcu23#27 = #zregcu23#28 + #zregcu23#29;   |PINTA #zregcu23#27;
             #zregcu23#30 = #zregcu23#31 + #zregcu23#32;   |PINTA #zregcu23#38;
             #zregcu23#35 = #zregcu23#36 + #zregcu23#37;   |PINTA #zregcu23#35;

             #zregcu23#39 = #zregcu23#40 + #zregcu23#41;   |PINTA #zregcu23#39;
             #zregcu23#42 = #zregcu23#43 + #zregcu23#44;   |PINTA #zregcu23#42;
             #zregcu23#47 = #zregcu23#48 + #zregcu23#49;   |PINTA #zregcu23#47;

             |GRABA 020#zregcu23.a;
             |LIBERA #zregcu23;
             |CIERRA #zregcu23;
         |FINSI;
     |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |ABRE #zregcu31;
         #zregcu31#0 = #zhazcrea#0;
         #zregcu31#1 = #zhazcrea#1;
         |LEE 101#zregcu31.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu31;
             #zregcu31#0  = #zhazcrea#0;
             #zregcu31#1  = #zhazcrea#1;
             |GRABA 020#zregcu31.b;
         |FINSI;

         |SI #zhazcrea#1 = 2017;
             #zregcu31#4  = #imagen@#6; #zregcu31#8 = #imagen@#18;
             #zregcu31#5  = #imagen@#7; #zregcu31#9 = #imagen@#19;
         |SINO;
             #zregcu31#4  = #imagen@#2; #zregcu31#8 = #imagen@#6;
             #zregcu31#5  = #imagen@#3; #zregcu31#9 = #imagen@#7;
         |FINSI;
         #zregcu31#10 = #zregcu31#2 + #zregcu31#3;
         #zregcu31#11 = #zregcu31#4 + #zregcu31#5;
         #zregcu31#12 = #zregcu31#6 + #zregcu31#7;
         #zregcu31#13 = #zregcu31#8 + #zregcu31#9;

         |GRABA 020#zregcu31.a;
         |LIBERA #zregcu31;
         |CIERRA #zregcu31;
     |FINSI;
|FPRC;

|PROCESO Quadre12;

     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu12;
     #zregcu12#0 = #zhazcrea#0;
     #zregcu12#1 = #zhazcrea#1;
     |LEE 101#zregcu12.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu12;
         #zregcu12#0  = #zhazcrea#0;
         #zregcu12#1  = #zhazcrea#1;
         |GRABA 020#zregcu12.b;
     |FINSI;

     #zregcu12#18 = #imagen@#2;
     #zregcu12#19 = #imagen@#3;
     #zregcu12#20 = #imagen@#4;
     #zregcu12#21 = #imagen@#5;
     #zregcu12#22 = #imagen@#6;
     #zregcu12#23 = #imagen@#7;
     #zregcu12#24 = #imagen@#8;
     #zregcu12#25 = #imagen@#9;
     #zregcu12#26 = #imagen@#10;
     #zregcu12#27 = #imagen@#11;
     #zregcu12#28 = #imagen@#12;
     #zregcu12#29 = #imagen@#13;
     #zregcu12#30 = #imagen@#14;
     #zregcu12#31 = #imagen@#15;
     #zregcu12#32 = #imagen@#16;
     #zregcu12#33 = #imagen@#17;

     |GRABA 020#zregcu12.a;
     |LIBERA #zregcu12;
     |CIERRA #zregcu12;
|FPRC;

|PROCESO Quadre13;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu13;
     #zregcu13#0 = #zhazcrea#0;
     #zregcu13#1 = #zhazcrea#1;
     |LEE 101#zregcu13.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu13;
         #zregcu13#0  = #zhazcrea#0;
         #zregcu13#1  = #zhazcrea#1;
         |GRABA 020#zregcu13.b;
     |FINSI;

     #zregcu13#13 = #imagen@#2;  #zregcu13#35 = #imagen@#24; #zregcu13#57 = #imagen@#46;
     #zregcu13#14 = #imagen@#3;  #zregcu13#36 = #imagen@#25; #zregcu13#58 = #imagen@#47;
     #zregcu13#15 = #imagen@#4;  #zregcu13#37 = #imagen@#26; #zregcu13#59 = #imagen@#48;
     #zregcu13#16 = #imagen@#5;  #zregcu13#38 = #imagen@#27; #zregcu13#60 = #imagen@#49;
     #zregcu13#17 = #imagen@#6;  #zregcu13#39 = #imagen@#28; #zregcu13#61 = #imagen@#50;
     #zregcu13#18 = #imagen@#7;  #zregcu13#40 = #imagen@#29; #zregcu13#62 = #imagen@#51;
     #zregcu13#19 = #imagen@#8;  #zregcu13#41 = #imagen@#30; #zregcu13#63 = #imagen@#52;
     #zregcu13#20 = #imagen@#9;  #zregcu13#42 = #imagen@#31; #zregcu13#64 = #imagen@#53;
     #zregcu13#21 = #imagen@#10; #zregcu13#43 = #imagen@#32; #zregcu13#65 = #imagen@#54;
     #zregcu13#22 = #imagen@#11; #zregcu13#44 = #imagen@#33; #zregcu13#66 = #imagen@#55;
     #zregcu13#23 = #imagen@#12; #zregcu13#45 = #imagen@#34; #zregcu13#67 = #imagen@#56;

     |GRABA 020#zregcu13.a;
     |LIBERA #zregcu13;
     |CIERRA #zregcu13;
|FPRC;

|PROCESO Quadre15;
     |SI #zhazcrea#1 ] 2015; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu15;
     #zregcu15#0 = #zhazcrea#0;
     #zregcu15#1 = #zhazcrea#1;
     |LEE 101#zregcu15.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu15;
         #zregcu15#0  = #zhazcrea#0;
         #zregcu15#1  = #zhazcrea#1;
         |GRABA 020#zregcu15.b;
     |FINSI;

     #zregcu15#09 = #imagen@#2;
     #zregcu15#13 = #imagen@#6;
     #zregcu15#10 = #imagen@#3;
     #zregcu15#14 = #imagen@#7;
     #zregcu15#11 = #imagen@#4;
     #zregcu15#15 = #imagen@#8;
     #zregcu15#12 = #imagen@#5;

     |GRABA 020#zregcu15.a;
     |LIBERA #zregcu15;
     |CIERRA #zregcu15;
|FPRC;

|PROCESO Quadre17;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "P";  |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu17;
     #zregcu17#0 = #zhazcrea#0;
     #zregcu17#1 = #zhazcrea#1;
     |LEE 101#zregcu17.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu17;
         #zregcu17#0  = #zhazcrea#0;
         #zregcu17#1  = #zhazcrea#1;
         |GRABA 020#zregcu17.b;
     |FINSI;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 97;  |HACIENDO nCampo1 = nCampo1 + 2;
           nCampo2      = nCampo1 - 1;
           #zregcu17#nCampo1# = #imagen@#nCampo2#;
     |SIGUE;

     |GRABA 020#zregcu17.a;
     |LIBERA #zregcu17;
     |CIERRA #zregcu17;
|FPRC;

|PROCESO Quadre19;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "P";  |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu19;
     #zregcu19#0 = #zhazcrea#0;
     #zregcu19#1 = #zhazcrea#1;
     |LEE 101#zregcu19.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu19;
         #zregcu19#0  = #zhazcrea#0;
         #zregcu19#1  = #zhazcrea#1;
         |GRABA 020#zregcu19.b;
     |FINSI;

     |PARA nCampo1 = 3;  |SI nCampo1 [ 65;  |HACIENDO nCampo1 = nCampo1 + 2;
           nCampo2      = nCampo1 - 1;
           #zregcu19#nCampo1# = #imagen@#nCampo2#;
     |SIGUE;

     |GRABA 020#zregcu19.a;
     |LIBERA #zregcu19;
     |CIERRA #zregcu19;
|FPRC;

|PROCESO Quadre20;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#15 ! "A";
         |ABRE #zregcu08;
         #zregcu08#0 = #zhazcrea#0;
         #zregcu08#1 = #zhazcrea#1;
         |LEE 101#zregcu08.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu08;
             #zregcu08#0  = #zhazcrea#0;
             #zregcu08#1  = #zhazcrea#1;
             |GRABA 020#zregcu08.b;
         |FINSI;

         #zregcu08#17 = #imagen@#4;
         #zregcu08#18 = #imagen@#5;
         #zregcu08#19 = #imagen@#6;
         #zregcu08#20 = #imagen@#7;
         #zregcu08#21 = #imagen@#9;
         #zregcu08#22 = #imagen@#10;
         #zregcu08#23 = #imagen@#11;
         #zregcu08#24 = #imagen@#12;
         #zregcu08#25 = #imagen@#13;
         #zregcu08#26 = #imagen@#19;
         #zregcu08#27 = #imagen@#20;
         #zregcu08#28 = #imagen@#21;
         #zregcu08#29 = #imagen@#22;

         #zregcu08#02 = #zregcu08#03 + #zregcu08#04 + #zregcu08#05;
         #zregcu08#07 = #zregcu08#08 + #zregcu08#09 + #zregcu08#10;
         #zregcu08#16 = #zregcu08#17 + #zregcu08#18 + #zregcu08#19;
         #zregcu08#21 = #zregcu08#22 + #zregcu08#23 + #zregcu08#24;

         #zregcu08#34 = #zregcu08#02 + #zregcu08#06;
         #zregcu08#35 = #zregcu08#07 + #zregcu08#11;
         #zregcu08#36 = #zregcu08#30 + #zregcu08#31;
         #zregcu08#37 = #zregcu08#12 + #zregcu08#13;
         #zregcu08#38 = #zregcu08#16 + #zregcu08#20;
         #zregcu08#39 = #zregcu08#21 + #zregcu08#25;
         #zregcu08#40 = #zregcu08#32 + #zregcu08#33;
         #zregcu08#41 = #zregcu08#26 + #zregcu08#27;

         |GRABA 020#zregcu08.a;
         |LIBERA #zregcu08;
         |CIERRA #zregcu08;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #zregcu20;
         #zregcu20#0 = #zhazcrea#0;
         #zregcu20#1 = #zhazcrea#1;
         |LEE 101#zregcu20.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu20;
             #zregcu20#0  = #zhazcrea#0;
             #zregcu20#1  = #zhazcrea#1;
             |GRABA 020#zregcu20.b;
         |FINSI;

         #zregcu20#25 = #imagen@#4;
         #zregcu20#26 = #imagen@#5;
         #zregcu20#27 = #imagen@#6;
         #zregcu20#28 = #imagen@#7;
         #zregcu20#31 = #imagen@#10;
         #zregcu20#32 = #imagen@#11;
         #zregcu20#33 = #imagen@#12;
         #zregcu20#34 = #imagen@#13;
         #zregcu20#36 = #imagen@#15;
         #zregcu20#37 = #imagen@#16;
         #zregcu20#38 = #imagen@#17;
         #zregcu20#40 = #imagen@#19;
         #zregcu20#41 = #imagen@#20;
         #zregcu20#42 = #imagen@#21;
         #zregcu20#43 = #imagen@#22;

         #zregcu20#03 = #zregcu20#04 + #zregcu20#05 + #zregcu20#06;
         #zregcu20#02 = #zregcu20#03 + #zregcu20#07;
         #zregcu20#24 = #zregcu20#25 + #zregcu20#26 + #zregcu20#27;
         #zregcu20#23 = #zregcu20#24 + #zregcu20#28;

         #zregcu20#09 = #zregcu20#10 + #zregcu20#11 + #zregcu20#12;
         #zregcu20#08 = #zregcu20#09 + #zregcu20#13;
         #zregcu20#30 = #zregcu20#31 + #zregcu20#32 + #zregcu20#33;
         #zregcu20#29 = #zregcu20#30 + #zregcu20#34;

         #zregcu20#14 = #zregcu20#15 + #zregcu20#16 + #zregcu20#17;
         #zregcu20#35 = #zregcu20#36 + #zregcu20#37 + #zregcu20#38;

         #zregcu20#18 = #zregcu20#19 + #zregcu20#20;
         #zregcu20#39 = #zregcu20#40 + #zregcu20#41;

         |GRABA 020#zregcu20.a;
         |LIBERA #zregcu20;
         |CIERRA #zregcu20;
    |FINSI;
|FPRC;

|PROCESO Quadre21;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "P";  |ACABA;  |FINSI;
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu21;
     #zregcu21#0 = #zhazcrea#0;
     #zregcu21#1 = #zhazcrea#1;
     |LEE 101#zregcu21.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu21;
         #zregcu21#0  = #zhazcrea#0;
         #zregcu21#1  = #zhazcrea#1;
         |GRABA 020#zregcu21.b;
     |FINSI;

     #zregcu21#12 = #imagen@#2;
     #zregcu21#13 = #imagen@#3;
     #zregcu21#14 = #imagen@#4;
     #zregcu21#15 = #imagen@#5;
     #zregcu21#16 = #imagen@#6;
     #zregcu21#17 = #imagen@#7;
     #zregcu21#18 = #imagen@#8;
     #zregcu21#19 = #imagen@#9;
     #zregcu21#20 = #imagen@#10;
     #zregcu21#21 = #imagen@#11;

     |GRABA 020#zregcu21.a;
     |LIBERA #zregcu21;
     |CIERRA #zregcu21;
|FPRC;

|PROCESO Quadre23;
     |SI #zhazcrea#1 > 2017; aFichero = "zregcu31"; |FINSI;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |SI #zhazcrea#1 [ 2016;
         |SI #zhazcrea#15 ! "A";
             |ABRE #zregcu11;
             #zregcu11#0 = #zhazcrea#0;
             #zregcu11#1 = #zhazcrea#1;
             |LEE 101#zregcu11.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu11;
                 #zregcu11#0  = #zhazcrea#0;
                 #zregcu11#1  = #zhazcrea#1;
                 |GRABA 020#zregcu11.b;
             |FINSI;

             #zregcu11#8  = #imagen@#2;
             #zregcu11#9  = #imagen@#7;
             #zregcu11#10 = #imagen@#8;
             #zregcu11#11 = #imagen@#9;
             #zregcu11#12 = #imagen@#12;
             #zregcu11#13 = #imagen@#13;

             #zregcu11#20 = #imagen@#26;
             #zregcu11#21 = #imagen@#31;
             #zregcu11#22 = #imagen@#32;
             #zregcu11#23 = #imagen@#33;
             #zregcu11#24 = #imagen@#36;
             #zregcu11#25 = #imagen@#37;

             |GRABA 020#zregcu11.a;
             |LIBERA #zregcu11;
             |CIERRA #zregcu11;
         |FINSI;

         |SI #zhazcrea#15 = "A";
             |ABRE #zregcu23;
             #zregcu23#0 = #zhazcrea#0;
             #zregcu23#1 = #zhazcrea#1;
             |LEE 101#zregcu23.=;
             |SI FSalida ! 0;
                 |DDEFECTO #zregcu23;
                 #zregcu23#0  = #zhazcrea#0;
                 #zregcu23#1  = #zhazcrea#1;
                 |GRABA 020#zregcu23.b;
             |FINSI;

             #zregcu23#14 = #imagen@#2;
             #zregcu23#15 = #imagen@#3;
             #zregcu23#16 = #imagen@#4;
             #zregcu23#17 = #imagen@#5;
             #zregcu23#18 = #imagen@#6;
             #zregcu23#19 = #imagen@#7;
             #zregcu23#20 = #imagen@#8;
             #zregcu23#21 = #imagen@#9;
             #zregcu23#22 = #imagen@#10;
             #zregcu23#23 = #imagen@#11;
             #zregcu23#24 = #imagen@#12;
             #zregcu23#25 = #imagen@#13;

             #zregcu23#38 = #imagen@#26;
             #zregcu23#39 = #imagen@#27;
             #zregcu23#40 = #imagen@#28;
             #zregcu23#41 = #imagen@#29;
             #zregcu23#42 = #imagen@#30;
             #zregcu23#43 = #imagen@#31;
             #zregcu23#44 = #imagen@#32;
             #zregcu23#45 = #imagen@#33;
             #zregcu23#46 = #imagen@#34;
             #zregcu23#47 = #imagen@#35;
             #zregcu23#48 = #imagen@#36;
             #zregcu23#49 = #imagen@#37;

             #zregcu23#03 = #zregcu23#04 + #zregcu23#05;   |PINTA #zregcu23#03;
             #zregcu23#06 = #zregcu23#07 + #zregcu23#08;   |PINTA #zregcu23#06;
             #zregcu23#11 = #zregcu23#12 + #zregcu23#13;   |PINTA #zregcu23#11;

             #zregcu23#15 = #zregcu23#16 + #zregcu23#17;   |PINTA #zregcu23#15;
             #zregcu23#18 = #zregcu23#19 + #zregcu23#20;   |PINTA #zregcu23#18;
             #zregcu23#23 = #zregcu23#24 + #zregcu23#25;   |PINTA #zregcu23#23;

             #zregcu23#27 = #zregcu23#28 + #zregcu23#29;   |PINTA #zregcu23#27;
             #zregcu23#30 = #zregcu23#31 + #zregcu23#32;   |PINTA #zregcu23#38;
             #zregcu23#35 = #zregcu23#36 + #zregcu23#37;   |PINTA #zregcu23#35;

             #zregcu23#39 = #zregcu23#40 + #zregcu23#41;   |PINTA #zregcu23#39;
             #zregcu23#42 = #zregcu23#43 + #zregcu23#44;   |PINTA #zregcu23#42;
             #zregcu23#47 = #zregcu23#48 + #zregcu23#49;   |PINTA #zregcu23#47;

             |GRABA 020#zregcu23.a;
             |LIBERA #zregcu23;
             |CIERRA #zregcu23;
         |FINSI;
    |FINSI;

     |SI #zhazcrea#1 ] 2017;
         |ABRE #zregcu31;
         #zregcu31#0 = #zhazcrea#0;
         #zregcu31#1 = #zhazcrea#1;
         |LEE 101#zregcu31.=;
         |SI FSalida ! 0;
             |DDEFECTO #zregcu31;
             #zregcu31#0  = #zhazcrea#0;
             #zregcu31#1  = #zhazcrea#1;
             |GRABA 020#zregcu31.b;
         |FINSI;

         |SI #zhazcrea#1 = 2017;
             #zregcu31#4  = #imagen@#12; #zregcu31#8 = #imagen@#36;
             #zregcu31#5  = #imagen@#13; #zregcu31#9 = #imagen@#37;
         |SINO;
             #zregcu31#4  = #imagen@#2; #zregcu31#8 = #imagen@#6;
             #zregcu31#5  = #imagen@#3; #zregcu31#9 = #imagen@#7;
         |FINSI;
         #zregcu31#10 = #zregcu31#2 + #zregcu31#3;
         #zregcu31#11 = #zregcu31#4 + #zregcu31#5;
         #zregcu31#12 = #zregcu31#6 + #zregcu31#7;
         #zregcu31#13 = #zregcu31#8 + #zregcu31#9;

         |GRABA 020#zregcu31.a;
         |LIBERA #zregcu31;
         |CIERRA #zregcu31;
     |FINSI;
|FPRC;

|PROCESO Quadre24;
     |SI #zhazcrea#1 ] 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";    |ACABA;  |FINSI;
     |SI nEstado900 ! 0;     |ACABA;  |FINSI;
     |SI #zhazdocu#0       [ 2010;  |ACABA;  |FINSI;

     |ABRE #zregcu24;
     #zregcu24#0 = #zhazcrea#0;
     #zregcu24#1 = #zhazcrea#1;
     |LEE 101#zregcu24.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu24;
         #zregcu24#0  = #zhazcrea#0;
         #zregcu24#1  = #zhazcrea#1;
         |GRABA 020#zregcu24.b;
     |FINSI;

     #zregcu24#11 = #imagen@#2;
     #zregcu24#12 = #imagen@#3;
     #zregcu24#13 = #imagen@#4;
     #zregcu24#14 = #imagen@#5;
     #zregcu24#15 = #imagen@#6;
     #zregcu24#16 = #imagen@#7;
     #zregcu24#17 = #imagen@#8;
     #zregcu24#18 = #imagen@#9;
     #zregcu24#19 = #imagen@#10;

     |GRABA 020#zregcu24.a;
     |LIBERA #zregcu24;
     |CIERRA #zregcu24;
|FPRC;

|PROCESO Quadre28;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";    |ACABA;  |FINSI;
     |SI nEstado900 ! 0;     |ACABA;  |FINSI;
     |SI #zhazdocu#0       [ 2010;  |ACABA;  |FINSI;

     |ABRE #zregcu28;
     #zregcu28#0 = #zhazcrea#0;
     #zregcu28#1 = #zhazcrea#1;
     |LEE 101#zregcu28.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu28;
         #zregcu28#0  = #zhazcrea#0;
         #zregcu28#1  = #zhazcrea#1;
         |GRABA 020#zregcu28.b;
     |FINSI;

     #zregcu28#6 = #imagen@#2;
     #zregcu28#7 = #imagen@#3;
     #zregcu28#8 = #imagen@#4;
     #zregcu28#9 = #imagen@#5;

     |GRABA 020#zregcu28.a;
     |LIBERA #zregcu28;
     |CIERRA #zregcu28;
|FPRC;

|PROCESO Quadre29;

     |SI #zhazcrea#1 [ 2015; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;

     |ABRE #zregcu29;
     #zregcu29#0 = #zhazcrea#0;
     #zregcu29#1 = #zhazcrea#1;
     |LEE 101#zregcu29.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu29;
         #zregcu29#0  = #zhazcrea#0;
         #zregcu29#1  = #zhazcrea#1;
         |GRABA 020#zregcu29.b;
     |FINSI;

     #zregcu29#03 = #imagen@#2;
     |GRABA 020#zregcu29.a;
     |LIBERA #zregcu29;
     |CIERRA #zregcu29;
|FPRC;

|PROCESO Quadre32;

     |SI #zhazcrea#1 < 2018; |ACABA; |FINSI;
     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
                                       ||ver zhazcrea15 = P
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu32;
     #zregcu32#0 = #zhazcrea#0;
     #zregcu32#1 = #zhazcrea#1;
     |LEE 101#zregcu32.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu32;
         #zregcu32#0  = #zhazcrea#0;
         #zregcu32#1  = #zhazcrea#1;
         |GRABA 020#zregcu32.b;
     |FINSI;

     #zregcu32#2 = #imagen@#5; #zregcu32#9  = #imagen@#12; #zregcu32#16 = #imagen@#19;
     #zregcu32#3 = #imagen@#6; #zregcu32#10 = #imagen@#13; #zregcu32#17 = #imagen@#20;
     #zregcu32#4 = #imagen@#7; #zregcu32#11 = #imagen@#14; #zregcu32#18 = #imagen@#21;
     #zregcu32#5 = #imagen@#8; #zregcu32#12 = #imagen@#15; #zregcu32#19 = #imagen@#22;

     #zregcu32#23 = #zregcu32#2 + #zregcu32#9  + #zregcu32#16;
     #zregcu32#24 = #zregcu32#3 + #zregcu32#10 + #zregcu32#17;
     #zregcu32#25 = #zregcu32#4 + #zregcu32#11 + #zregcu32#18;
     #zregcu32#26 = #zregcu32#5 + #zregcu32#12 + #zregcu32#19;

     |GRABA 020#zregcu32.a;
     |LIBERA #zregcu32;
     |CIERRA #zregcu32;
|FPRC;

|PROCESO Quadre33;
     |SI #zhazcrea#1 < 2018; |ACABA; |FINSI;

     |HAZ CarImagen_Cuadr;

     |SI aDef       = "";   |ACABA;  |FINSI;
     |SI nEstado900 ! 0;    |ACABA;  |FINSI;
                                       ||ver zhazcrea15 = P
     |SI #zhazcrea#15      = "C";  |ACABA;  |FINSI;

     |ABRE #zregcu33;
     #zregcu33#0 = #zhazcrea#0;
     #zregcu33#1 = #zhazcrea#1;
     |LEE 101#zregcu33.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu33;
         #zregcu33#0  = #zhazcrea#0;
         #zregcu33#1  = #zhazcrea#1;
         |GRABA 020#zregcu33.b;
     |FINSI;

     #zregcu33#2 = #imagen@#7;
     #zregcu33#8 = #imagen@#13;
     #zregcu33#14 = #imagen@#19;
     #zregcu33#20 = #imagen@#25;

     |GRABA 020#zregcu33.a;
     |LIBERA #zregcu33;
     |CIERRA #zregcu33;
|FPRC;

|PROCESO PaseAnterior;
    nEjer = #zhazcrea#1 - 1;
    aDef  = "";
    |SI #zhazdocu#0 < 2009;  |ACABA;  |FINSI;

    aFichero = "zregdocu";
    |HAZ CarImagen_Cuadr;
    aTipoMemoria = #imagen@#69;

    |SI nSwPaseAnt = 1;
        |SI aTipoMemoria = "P";
            aFichero = "zregcu04"; |HAZ Quadre04;
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu02"; |HAZ Quadre02;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu05"; |HAZ Quadre05;
            aFichero = "zregcu08"; |HAZ Quadre08;
            aFichero = "zregcu09"; |HAZ Quadre09;
            aFichero = "zregcu11"; |HAZ Quadre11;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu24"; |HAZ Quadre24;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;
        |FINSI;

        |SI aTipoMemoria = "A";
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu17"; |HAZ Quadre17;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu19"; |HAZ Quadre19;
            aFichero = "zregcu20"; |HAZ Quadre20;
            aFichero = "zregcu21"; |HAZ Quadre21;
            aFichero = "zregcu23"; |HAZ Quadre23;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu18"; |HAZ Quadre18;
            aFichero = "zregcu24"; |HAZ Quadre24;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;

            |SI #zhazcrea#15 = "A";
                aFichero = "zregcu16"; |HAZ Quadre16;
            |FINSI;
        |FINSI;

        |SI aTipoMemoria = "C";
            aFichero = "zregcu04"; |HAZ Quadre04;
            aFichero = "zregcu01"; |HAZ Quadre01;
            aFichero = "zregcu02"; |HAZ Quadre02;
            aFichero = "zregcu03"; |HAZ Quadre03;
            aFichero = "zregcu05"; |HAZ Quadre05;
            aFichero = "zregcu08"; |HAZ Quadre08;
            aFichero = "zregcu09"; |HAZ Quadre09;
            aFichero = "zregcu11"; |HAZ Quadre11;
            aFichero = "zregcu12"; |HAZ Quadre12;
            aFichero = "zregcu13"; |HAZ Quadre13;
            aFichero = "zregcu15"; |HAZ Quadre15;
            aFichero = "zregcu24"; |HAZ Quadre24;
            aFichero = "zregcu28"; |HAZ Quadre28;
            aFichero = "zregcu29"; |HAZ Quadre29;
            aFichero = "zregcu32"; |HAZ Quadre32;
            aFichero = "zregcu33"; |HAZ Quadre33;
        |FINSI;
    |SINO;
        |SI aTipoMemoria = "P";  |O aTipoMemoria = "C";
            nHay = 1;

            |ABRE #zregcu04;
            #zregcu04#0 = #zhazcrea#0;
            #zregcu04#1 = #zhazcrea#1;
            #zregcu04#2 = 1;
            |LEE 101#zregcu04.];
            |SI FSalida = 0;  |Y #zregcu04#0 = #zhazcrea#0;  |Y  #zregcu04#1 = #zhazcrea#1;
                nHay = 0;
            |FINSI;
            |CIERRA #zregcu04;

            |SI nHay = 1;  aFichero = "zregcu04"; |HAZ Quadre04;  |FINSI;
        |FINSI;

        |SI aTipoMemoria = "A";
            nHay = 1;

            |ABRE #zregcu18;
            #zregcu18#0 = #zhazcrea#0;
            #zregcu18#1 = #zhazcrea#1;
            #zregcu18#2 = 1;
            |LEE 101#zregcu18.];
            |SI FSalida = 0;  |Y #zregcu18#0 = #zhazcrea#0;  |Y  #zregcu18#1 = #zhazcrea#1;
                nHay = 0;
            |FINSI;
            |CIERRA #zregcu18;

            |SI nHay = 1;  aFichero = "zregcu18"; |HAZ Quadre18;  |FINSI;

            |SI #zhazcrea#15 = "A";
                nHay = 1;

                |ABRE #zregcu16;
                #zregcu16#0 = #zhazcrea#0;
                #zregcu16#1 = #zhazcrea#1;
                #zregcu16#2 = 1;
                |LEE 101#zregcu16.];
                |SI FSalida = 0;  |Y #zregcu16#0 = #zhazcrea#0;  |Y  #zregcu16#1 = #zhazcrea#1;
                    nHay = 0;
                |FINSI;
                |CIERRA #zregcu16;

                |SI nHay = 1;  aFichero = "zregcu16"; |HAZ Quadre16;  |FINSI;
            |FINSI;
        |FINSI;
    |FINSI;

    |HAZ DesImagen_Cuadr;
|FPRC;

|PROCESO Graba_zregcu01;
     #zregcu01#0 = #zhazcrea#0;
     #zregcu01#1 = #zhazcrea#1;
     |LEE 101#zregcu01.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu01;
         #zregcu01#0 = #zhazcrea#0;
         #zregcu01#1 = #zhazcrea#1;
         |GRABA 020#zregcu01.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu01; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu01; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu01#nCampo# = #zregcu01#nCampo# + nImporte;
     |SINO;
         #zregcu01#nCampo# = #zregcu01#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu01.a;
     |LIBERA #zregcu01;
|FPRC;

|PROCESO Graba_zregcu02;
     #zregcu02#0 = #zhazcrea#0;
     #zregcu02#1 = #zhazcrea#1;
     |LEE 101#zregcu02.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu02;
         #zregcu02#0 = #zhazcrea#0;
         #zregcu02#1 = #zhazcrea#1;
         |GRABA 020#zregcu02.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu02; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu02; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu02#nCampo# = #zregcu02#nCampo# + nImporte;
     |SINO;
         #zregcu02#nCampo# = #zregcu02#nCampo# - nImporte;
     |FINSI;

     #zregcu02#8  = #zregcu02#2  + #zregcu02#4  + #zregcu02#6;
     #zregcu02#9  = #zregcu02#3  + #zregcu02#5  + #zregcu02#7;
     #zregcu02#16 = #zregcu02#10 + #zregcu02#12 + #zregcu02#14;
     #zregcu02#17 = #zregcu02#11 + #zregcu02#13 + #zregcu02#15;
     #zregcu02#24 = #zregcu02#18 + #zregcu02#20 + #zregcu02#22;
     #zregcu02#25 = #zregcu02#19 + #zregcu02#21 + #zregcu02#23;

     #zregcu02#40 = #zregcu02#34 + #zregcu02#36 + #zregcu02#38;
     #zregcu02#41 = #zregcu02#35 + #zregcu02#37 + #zregcu02#39;
     #zregcu02#48 = #zregcu02#42 + #zregcu02#44 + #zregcu02#46;
     #zregcu02#49 = #zregcu02#43 + #zregcu02#45 + #zregcu02#47;
     #zregcu02#56 = #zregcu02#50 + #zregcu02#52 + #zregcu02#54;
     #zregcu02#57 = #zregcu02#51 + #zregcu02#53 + #zregcu02#55;

     |PARA nCampo4 = 26;  |SI nCampo4 [ 33;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 24;
           nCampo2   = nCampo4 - 16;
           nCampo3   = nCampo4 - 8;
           #zregcu02#nCampo4# = #zregcu02#nCampo1# + #zregcu02#nCampo2# + #zregcu02#nCampo3#;
     |SIGUE;

     |PARA nCampo4 = 58;  |SI nCampo4 [ 65;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 24;
           nCampo2   = nCampo4 - 16;
           nCampo3   = nCampo4 - 8;
           #zregcu02#nCampo4# = #zregcu02#nCampo1# + #zregcu02#nCampo2# + #zregcu02#nCampo3#;
     |SIGUE;

     |GRABA 020#zregcu02.a;
     |LIBERA #zregcu02;
|FPRC;

|PROCESO Graba_zregcu03;
     #zregcu03#0 = #zhazcrea#0;
     #zregcu03#1 = #zhazcrea#1;
     |LEE 101#zregcu03.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu03;
         #zregcu03#0 = #zhazcrea#0;
         #zregcu03#1 = #zhazcrea#1;
         |GRABA 020#zregcu03.b;
     |FINSI;


     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu03; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu03; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu03#nCampo# = #zregcu03#nCampo# + nImporte;
     |SINO;
         #zregcu03#nCampo# = #zregcu03#nCampo# - nImporte;
     |FINSI;

     |PARA nCampo3 = 24;  |SI nCampo3 [ 34;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #zregcu03#nCampo3# = #zregcu03#nCampo1# + #zregcu03#nCampo2#;
     |SIGUE;

     |PARA nCampo3 = 57;  |SI nCampo3 [ 67;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1   = nCampo3 - 22;
           nCampo2   = nCampo3 - 11;
           #zregcu03#nCampo3# = #zregcu03#nCampo1# + #zregcu03#nCampo2#;
     |SIGUE;

     |GRABA 020#zregcu03.a;
     |LIBERA #zregcu03;
|FPRC;

|PROCESO Graba_zregcu05;
     #zregcu05#0 = #zhazcrea#0;
     #zregcu05#1 = #zhazcrea#1;
     |LEE 101#zregcu05.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu05;
         #zregcu05#0 = #zhazcrea#0;
         #zregcu05#1 = #zhazcrea#1;
         |GRABA 020#zregcu05.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu05; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu05; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu05#nCampo# = #zregcu05#nCampo# + nImporte;
     |SINO;
         #zregcu05#nCampo# = #zregcu05#nCampo# - nImporte;
     |FINSI;

     #zregcu05#8  = #zregcu05#2  + #zregcu05#4  + #zregcu05#6;
     #zregcu05#9  = #zregcu05#3  + #zregcu05#5  + #zregcu05#7;
     #zregcu05#16 = #zregcu05#10 + #zregcu05#12 + #zregcu05#14;
     #zregcu05#17 = #zregcu05#11 + #zregcu05#13 + #zregcu05#15;
     #zregcu05#32 = #zregcu05#26 + #zregcu05#28 + #zregcu05#30;
     #zregcu05#33 = #zregcu05#27 + #zregcu05#29 + #zregcu05#31;
     #zregcu05#40 = #zregcu05#34 + #zregcu05#36 + #zregcu05#38;
     #zregcu05#41 = #zregcu05#35 + #zregcu05#37 + #zregcu05#39;

     |PARA nCampo3 = 18;  |SI nCampo3 [ 25;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1    = nCampo3 - 16;
           nCampo2    = nCampo3 - 8;
           #zregcu05#nCampo3# = #zregcu05#nCampo1# + #zregcu05#nCampo2#;
     |SIGUE;

     |PARA nCampo3 = 42;  |SI nCampo3 [ 49;  |HACIENDO nCampo3 = nCampo3 + 1;
           nCampo1    = nCampo3 - 16;
           nCampo2    = nCampo3 - 8;
           #zregcu05#nCampo3# = #zregcu05#nCampo1# + #zregcu05#nCampo2#;
     |SIGUE;

     |GRABA 020#zregcu05.a;
     |LIBERA #zregcu05;
|FPRC;

|PROCESO Graba_zregcu07;
     #zregcu07#0 = #zhazcrea#0;
     #zregcu07#1 = #zhazcrea#1;
     |LEE 101#zregcu07.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu07;
         #zregcu07#0 = #zhazcrea#0;
         #zregcu07#1 = #zhazcrea#1;
         |GRABA 020#zregcu07.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu07; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu07; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu07#nCampo# = #zregcu07#nCampo# + nImporte;
     |SINO;
         #zregcu07#nCampo# = #zregcu07#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu07.a;
     |LIBERA #zregcu07;
|FPRC;

|PROCESO Graba_zregcu08;
     #zregcu08#0 = #zhazcrea#0;
     #zregcu08#1 = #zhazcrea#1;
     |LEE 101#zregcu08.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu08;
         #zregcu08#0 = #zhazcrea#0;
         #zregcu08#1 = #zhazcrea#1;
         |GRABA 020#zregcu08.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu08; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu08; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu08#nCampo# = #zregcu08#nCampo# + nImporte;
     |SINO;
         #zregcu08#nCampo# = #zregcu08#nCampo# - nImporte;
     |FINSI;

     #zregcu08#02 = #zregcu08#03 + #zregcu08#04 + #zregcu08#05;
     #zregcu08#07 = #zregcu08#08 + #zregcu08#09 + #zregcu08#10;
     #zregcu08#16 = #zregcu08#17 + #zregcu08#18 + #zregcu08#19;
     #zregcu08#21 = #zregcu08#22 + #zregcu08#23 + #zregcu08#24;

     #zregcu08#34 = #zregcu08#02 + #zregcu08#06;
     #zregcu08#35 = #zregcu08#07 + #zregcu08#11;
     #zregcu08#36 = #zregcu08#30 + #zregcu08#31;
     #zregcu08#37 = #zregcu08#12 + #zregcu08#13;
     #zregcu08#38 = #zregcu08#16 + #zregcu08#20;
     #zregcu08#39 = #zregcu08#21 + #zregcu08#25;
     #zregcu08#40 = #zregcu08#32 + #zregcu08#33;
     #zregcu08#41 = #zregcu08#26 + #zregcu08#27;

     |GRABA 020#zregcu08.a;
     |LIBERA #zregcu08;
|FPRC;

|PROCESO Graba_zregcu09;
     #zregcu09#0 = #zhazcrea#0;
     #zregcu09#1 = #zhazcrea#1;
     |LEE 101#zregcu09.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu09;
         #zregcu09#0 = #zhazcrea#0;
         #zregcu09#1 = #zhazcrea#1;
         |GRABA 020#zregcu09.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu09; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu09; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu09#nCampo# = #zregcu09#nCampo# + nImporte;
     |SINO;
         #zregcu09#nCampo# = #zregcu09#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu09.a;
     |LIBERA #zregcu09;
|FPRC;

|PROCESO Graba_zregcu15;
     #zregcu15#0 = #zhazcrea#0;
     #zregcu15#1 = #zhazcrea#1;
     |LEE 101#zregcu15.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu15;
         #zregcu15#0 = #zhazcrea#0;
         #zregcu15#1 = #zhazcrea#1;
         |GRABA 020#zregcu15.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu15; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu15; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu15#nCampo# = #zregcu15#nCampo# + nImporte;
     |SINO;
         #zregcu15#nCampo# = #zregcu15#nCampo# - nImporte;
     |FINSI;

     #zregcu15#4  = #zregcu15#02 + #zregcu15#03;
     #zregcu15#6  = (#zregcu15#02 * 100) / #zregcu15#4;
     #zregcu15#7  = 0;
     |SI #zregcu15#3 ! 0;
         #zregcu15#7  = 100 - #zregcu15#6;
     |FINSI;
     #zregcu15#8  = #zregcu15#6 + #zregcu15#7;

     #zregcu15#11 = #zregcu15#09 + #zregcu15#10;
     #zregcu15#13 = (#zregcu15#09 * 100) / #zregcu15#11;
     #zregcu15#14 = 0;
     |SI #zregcu15#10 ! 0;
         #zregcu15#14 = 100 - #zregcu15#13;
     |FINSI;
     #zregcu15#15 = #zregcu15#13 + #zregcu15#14;

     |GRABA 020#zregcu15.a;
     |LIBERA #zregcu15;
|FPRC;

|PROCESO Graba_zregcu17;
     #zregcu17#0 = #zhazcrea#0;
     #zregcu17#1 = #zhazcrea#1;
     |LEE 101#zregcu17.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu17;
         #zregcu17#0 = #zhazcrea#0;
         #zregcu17#1 = #zhazcrea#1;
         |GRABA 020#zregcu17.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu17; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu17; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu17#nCampo# = #zregcu17#nCampo# + nImporte;
     |SINO;
         #zregcu17#nCampo# = #zregcu17#nCampo# - nImporte;
     |FINSI;

     #zregcu17#12 = #zregcu17#2  + #zregcu17#4  + #zregcu17#6  + #zregcu17#8  + #zregcu17#10;
     #zregcu17#13 = #zregcu17#3  + #zregcu17#5  + #zregcu17#7  + #zregcu17#9  + #zregcu17#11;
     #zregcu17#24 = #zregcu17#14 + #zregcu17#16 + #zregcu17#18 + #zregcu17#20 + #zregcu17#22;
     #zregcu17#25 = #zregcu17#15 + #zregcu17#17 + #zregcu17#19 + #zregcu17#21 + #zregcu17#23;
     #zregcu17#36 = #zregcu17#26 + #zregcu17#28 + #zregcu17#30 + #zregcu17#32 + #zregcu17#34;
     #zregcu17#37 = #zregcu17#27 + #zregcu17#29 + #zregcu17#31 + #zregcu17#33 + #zregcu17#35;

     #zregcu17#60 = #zregcu17#50 + #zregcu17#52 + #zregcu17#54 + #zregcu17#56 + #zregcu17#58;
     #zregcu17#61 = #zregcu17#51 + #zregcu17#53 + #zregcu17#55 + #zregcu17#57 + #zregcu17#59;
     #zregcu17#72 = #zregcu17#62 + #zregcu17#64 + #zregcu17#66 + #zregcu17#68 + #zregcu17#70;
     #zregcu17#73 = #zregcu17#63 + #zregcu17#65 + #zregcu17#67 + #zregcu17#69 + #zregcu17#71;
     #zregcu17#84 = #zregcu17#74 + #zregcu17#76 + #zregcu17#78 + #zregcu17#80 + #zregcu17#82;
     #zregcu17#85 = #zregcu17#75 + #zregcu17#77 + #zregcu17#79 + #zregcu17#81 + #zregcu17#83;

     |PARA nCampo4 = 38;  |SI nCampo4 [ 49;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 36;
           nCampo2   = nCampo4 - 24;
           nCampo3   = nCampo4 - 12;
           #zregcu17#nCampo4# = #zregcu17#nCampo1# + #zregcu17#nCampo2# + #zregcu17#nCampo3#;
     |SIGUE;

     |PARA nCampo4 = 86;  |SI nCampo4 [ 97;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1   = nCampo4 - 36;
           nCampo2   = nCampo4 - 24;
           nCampo3   = nCampo4 - 12;
           #zregcu17#nCampo4# = #zregcu17#nCampo1# + #zregcu17#nCampo2# + #zregcu17#nCampo3#;
     |SIGUE;

     |GRABA 020#zregcu17.a;
     |LIBERA #zregcu17;
|FPRC;

|PROCESO Graba_zregcu19;
     #zregcu19#0 = #zhazcrea#0;
     #zregcu19#1 = #zhazcrea#1;
     |LEE 101#zregcu19.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu19;
         #zregcu19#0 = #zhazcrea#0;
         #zregcu19#1 = #zhazcrea#1;
         |GRABA 020#zregcu19.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu19; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu19; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu19#nCampo# = #zregcu19#nCampo# + nImporte;
     |SINO;
         #zregcu19#nCampo# = #zregcu19#nCampo# - nImporte;
     |FINSI;

     #zregcu19#8  = #zregcu19#2  + #zregcu19#4  + #zregcu19#6;
     #zregcu19#9  = #zregcu19#3  + #zregcu19#5  + #zregcu19#7;
     #zregcu19#16 = #zregcu19#10 + #zregcu19#12 + #zregcu19#14;
     #zregcu19#17 = #zregcu19#11 + #zregcu19#13 + #zregcu19#15;
     #zregcu19#24 = #zregcu19#18 + #zregcu19#20 + #zregcu19#22;
     #zregcu19#25 = #zregcu19#19 + #zregcu19#21 + #zregcu19#23;

     #zregcu19#40 = #zregcu19#34 + #zregcu19#36 + #zregcu19#38;
     #zregcu19#41 = #zregcu19#35 + #zregcu19#37 + #zregcu19#39;
     #zregcu19#48 = #zregcu19#42 + #zregcu19#44 + #zregcu19#46;
     #zregcu19#49 = #zregcu19#43 + #zregcu19#45 + #zregcu19#47;
     #zregcu19#56 = #zregcu19#50 + #zregcu19#52 + #zregcu19#54;
     #zregcu19#57 = #zregcu19#51 + #zregcu19#53 + #zregcu19#55;

     |PARA nCampo4 = 26;  |SI nCampo4 [ 33;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1    = nCampo4 - 24;
           nCampo2    = nCampo4 - 16;
           nCampo3    = nCampo4 - 8;
           #zregcu19#nCampo4# = #zregcu19#nCampo1# + #zregcu19#nCampo2# + #zregcu19#nCampo3#;
     |SIGUE;

     |PARA nCampo4 = 58;  |SI nCampo4 [ 65;  |HACIENDO nCampo4 = nCampo4 + 1;
           nCampo1    = nCampo4 - 24;
           nCampo2    = nCampo4 - 16;
           nCampo3    = nCampo4 - 8;
           #zregcu19#nCampo4# = #zregcu19#nCampo1# + #zregcu19#nCampo2# + #zregcu19#nCampo3#;
     |SIGUE;

     |GRABA 020#zregcu19.a;
     |LIBERA #zregcu19;
|FPRC;

|PROCESO Graba_zregcu20;
     #zregcu20#0 = #zhazcrea#0;
     #zregcu20#1 = #zhazcrea#1;
     |LEE 101#zregcu20.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu20;
         #zregcu20#0 = #zhazcrea#0;
         #zregcu20#1 = #zhazcrea#1;
         |GRABA 020#zregcu20.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu20; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu20; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu20#nCampo# = #zregcu20#nCampo# + nImporte;
     |SINO;
         #zregcu20#nCampo# = #zregcu20#nCampo# - nImporte;
     |FINSI;

     #zregcu20#03 = #zregcu20#04 + #zregcu20#05 + #zregcu20#06;
     #zregcu20#02 = #zregcu20#03 + #zregcu20#07;
     #zregcu20#24 = #zregcu20#25 + #zregcu20#26 + #zregcu20#27;
     #zregcu20#23 = #zregcu20#24 + #zregcu20#28;

     #zregcu20#09 = #zregcu20#10 + #zregcu20#11 + #zregcu20#12;
     #zregcu20#08 = #zregcu20#09 + #zregcu20#13;
     #zregcu20#30 = #zregcu20#31 + #zregcu20#32 + #zregcu20#33;
     #zregcu20#29 = #zregcu20#30 + #zregcu20#34;

     #zregcu20#14 = #zregcu20#15 + #zregcu20#16 + #zregcu20#17;
     #zregcu20#35 = #zregcu20#36 + #zregcu20#37 + #zregcu20#38;

     #zregcu20#18 = #zregcu20#19 + #zregcu20#20;
     #zregcu20#39 = #zregcu20#40 + #zregcu20#41;

     |GRABA 020#zregcu20.a;
     |LIBERA #zregcu20;
|FPRC;

|PROCESO Graba_zregcu21;
     #zregcu21#0 = #zhazcrea#0;
     #zregcu21#1 = #zhazcrea#1;
     |LEE 101#zregcu21.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu21;
         #zregcu21#0 = #zhazcrea#0;
         #zregcu21#1 = #zhazcrea#1;
         |GRABA 020#zregcu21.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu21; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu21; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu21#nCampo# = #zregcu21#nCampo# + nImporte;
     |SINO;
         #zregcu21#nCampo# = #zregcu21#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu21.a;
     |LIBERA #zregcu21;
|FPRC;

|PROCESO Graba_zregcu24;
     #zregcu24#0 = #zhazcrea#0;
     #zregcu24#1 = #zhazcrea#1;
     |LEE 101#zregcu24.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu24;
         #zregcu24#0 = #zhazcrea#0;
         #zregcu24#1 = #zhazcrea#1;
         |GRABA 020#zregcu24.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu24; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu24; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu24#nCampo# = #zregcu24#nCampo# + nImporte;
     |SINO;
         #zregcu24#nCampo# = #zregcu24#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu24.a;
     |LIBERA #zregcu24;
|FPRC;

|PROCESO Graba_zregcu25;
     #zregcu25#0 = #zhazcrea#0;
     #zregcu25#1 = #zhazcrea#1;
     |LEE 101#zregcu25.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu25;
         #zregcu25#0 = #zhazcrea#0;
         #zregcu25#1 = #zhazcrea#1;
         |GRABA 020#zregcu25.b;
     |FINSI;


     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu25; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu25; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu25#nCampo# = #zregcu25#nCampo# + nImporte;
     |SINO;
         #zregcu25#nCampo# = #zregcu25#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu25.a;
     |LIBERA #zregcu25;
|FPRC;

|PROCESO Graba_zregcu26;
     #zregcu26#0 = #zhazcrea#0;
     #zregcu26#1 = #zhazcrea#1;
     |LEE 101#zregcu26.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu26;
         #zregcu26#0 = #zhazcrea#0;
         #zregcu26#1 = #zhazcrea#1;
         |GRABA 020#zregcu26.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu26; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu26; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu26#nCampo# = #zregcu26#nCampo# + nImporte;
     |SINO;
         #zregcu26#nCampo# = #zregcu26#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu26.a;
     |LIBERA #zregcu26;
|FPRC;

|PROCESO Graba_zregcu28;
     #zregcu28#0 = #zhazcrea#0;
     #zregcu28#1 = #zhazcrea#1;
     |LEE 101#zregcu28.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu28;
         #zregcu28#0 = #zhazcrea#0;
         #zregcu28#1 = #zhazcrea#1;
         |GRABA 020#zregcu28.b;
     |FINSI;

     |SI aCondi ! " ";
        |SI aCondi = "P"; |Y nImporte < 0; |LIBERA #zregcu28; |ACABA; |FINSI;
        |SI aCondi = "N"; |Y nImporte > 0; |LIBERA #zregcu28; |ACABA; |FINSI;
     |FINSI;

     nCampo = nCasilla;

     |SI aSigno = "+";
         #zregcu28#nCampo# = #zregcu28#nCampo# + nImporte;
     |SINO;
         #zregcu28#nCampo# = #zregcu28#nCampo# - nImporte;
     |FINSI;

     |GRABA 020#zregcu28.a;
     |LIBERA #zregcu28;
|FPRC;

|PROCESO sodacoli;
                       nImporte = 0;
     |SI aTipo = "I";  nImporte = #sodacoli#5;  |FINSI;
     |SI aTipo = "F";  nImporte = #sodacoli#8;  |FINSI;
     |SI aTipo = "D";  nImporte = #sodacoli#6;  |FINSI;
     |SI aTipo = "H";  nImporte = #sodacoli#7;  |FINSI;

     |SI nImporte = 0;  |ACABA;  |FINSI;

     |SI nCuadro = 1;   |HAZ Graba_zregcu01;   |FINSI;
     |SI nCuadro = 2;   |HAZ Graba_zregcu02;   |FINSI;
     |SI nCuadro = 3;   |HAZ Graba_zregcu02;   |FINSI;
     |SI nCuadro = 4;   |HAZ Graba_zregcu03;   |FINSI;
     |SI nCuadro = 5;   |HAZ Graba_zregcu03;   |FINSI;
     |SI nCuadro = 8;   |HAZ Graba_zregcu05;   |FINSI;
     |SI nCuadro = 9;   |HAZ Graba_zregcu05;   |FINSI;
     |SI nCuadro = 11;  |HAZ Graba_zregcu07;   |FINSI;
     |SI nCuadro = 12;  |HAZ Graba_zregcu08;   |FINSI;
     |SI nCuadro = 13;  |HAZ Graba_zregcu09;   |FINSI;
     |SI nCuadro = 19;  |HAZ Graba_zregcu15;   |FINSI;
     |SI nCuadro = 20;  |HAZ Graba_zregcu17;   |FINSI;
     |SI nCuadro = 21;  |HAZ Graba_zregcu17;   |FINSI;
     |SI nCuadro = 22;  |HAZ Graba_zregcu19;   |FINSI;
     |SI nCuadro = 23;  |HAZ Graba_zregcu19;   |FINSI;
     |SI nCuadro = 26;  |HAZ Graba_zregcu20;   |FINSI;
     |SI nCuadro = 27;  |HAZ Graba_zregcu21;   |FINSI;
     |SI nCuadro = 28;  |HAZ Graba_zregcu24;   |FINSI;
     |SI nCuadro = 29;  |HAZ Graba_zregcu25;   |FINSI;
     |SI nCuadro = 30;  |HAZ Graba_zregcu26;   |FINSI;
     |SI nCuadro = 32;  |HAZ Graba_zregcu28;   |FINSI;

     |SI nCuadro = 33;
         |SI aSigno = "+";
             nNume1 = nNume1 + nImporte;
         |SINO;
             nNume1 = nNume1 - nImporte;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE sodacoli;
     #sodacoli#2;
     ;
     #zhazcrea#0, nEjer, aCuentaD;
     #zhazcrea#0, nEjer, aCuentaH;
     ;
     NULL, sodacoli;
|FIN;

|PROCESO CalculosCuadro29;
     nCta40I  = 0;
     nCta41I  = 0;
     nCta407I = 0;
     nCta4I   = 0;
     nCta40F  = 0;
     nCta41F  = 0;
     nCta407F = 0;
     nCta4F   = 0;
     nCta4    = 0;
     nCta6    = 0;
     aCondi   = " ";

     aCuentaD = "40          ";
     aCuentaH = "40zzzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta40I = nNume1;

     aCuentaD = "41          ";
     aCuentaH = "41zzzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta41I = nNume1;

     aCuentaD = "407         ";
     aCuentaH = "407zzzzzzzzz";
     aTipo    = "I";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta407I = nNume1;

     aCuentaD = "40          ";
     aCuentaH = "40zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta40F = nNume1;

     aCuentaD = "41          ";
     aCuentaH = "41zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta41F = nNume1;

     aCuentaD = "407         ";
     aCuentaH = "407zzzzzzzzz";
     aTipo    = "F";
     aSigno   = "-";
     nNume1   = 0;  |BUCLE sodacoli; nCta407F = nNume1;

     nCta4I   = (nCta40I + nCta41I - nCta407I) ! 2;
     nCta4F   = (nCta40F + nCta41F - nCta407F) ! 2;
     nCta4    = ((nCta4I + nCta4F) / 2) ! 2;

     aCuentaD = "60          ";
     aCuentaH = "60zzzzzzzzzz";
     aTipo    = "F";
     aSigno   = "+";
     nNume1   = 0;  |BUCLE sodacoli; nCta6 = nNume1;
     aCuentaD = "62          ";
     aCuentaH = "62zzzzzzzzzz";
     nNume1   = 0;  |BUCLE sodacoli; nCta6 = nCta6 + nNume1;

     nImporte = 0;
     |SI nCta4 > 0; |Y nCta6 > 0;
         nImporte = ((nCta4 / nCta6) * 365) ! 2;
     |FINSI;
     #zregcu29#nCampo# = nImporte;
|FPRC;

|PROCESO PaseZregcu29;
     |ABRE #zregcu29;
     #zregcu29#0 = #zhazcrea#0;
     #zregcu29#1 = #zhazcrea#1;
     |LEE 101#zregcu29.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregcu29;
         #zregcu29#0 = #zhazcrea#0;
         #zregcu29#1 = #zhazcrea#1;
         |GRABA 020#zregcu29.b;
     |FINSI;

     nCuadro  = 33;
     nCampo   = 2;
     nEjer    = #zhazcrea#1;
     |HAZ CalculosCuadro29;

     |SI nSwPaseAnt = 0; |Y #zhazcrea#1 ! 2015;
         nCampo = 3;
         nEjer  = #zhazcrea#1 - 1;
         |HAZ CalculosCuadro29;
     |FINSI;

     |GRABA 020#zregcu29.a;
     |LIBERA #zregcu29;
     |CIERRA #zregcu29;
|FPRC;

|PROCESO elAuxiliar;
    #sodacoli#9 = 0;
    #sodacoli#5 = 0;
    #sodacoli#6 = #soda8w02#1;
    #sodacoli#7 = #soda8w02#2;
    #sodacoli#8 = #sodacoli#6 - #sodacoli#7;

    |SI nCuadro = 13;  |HAZ Graba_zregcu09;  |FINSI;
    |SI nCuadro = 27;  |HAZ Graba_zregcu21;  |FINSI;
|FPRC;

|DEFBUCLE elAuxiliar;
     #soda8w02#1;
     ;
     nEjer, aCuentaD;
     nEjer, aCuentaH;
     ;
     NULL, elAuxiliar;
|FIN;

|PROCESO zpcuadro;
     aCuenta = #zpcuadro#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #zpcuadro#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #zpcuadro#2;
     nCasilla = #zpcuadro#3;
     aTipo    = #zpcuadro#5;
     aSigno   = #zpcuadro#6;
     aCondi   = #zpcuadro#8;

     |SI nCuadro = 19; |Y #zhazdocu#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI nCuadro = 13;  |O nCuadro = 27;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zpcuadro;
     #zpcuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zpcuadro;
|FIN;

|PROCESO zocuadro;
     aCuenta = #zocuadro#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #zocuadro#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #zocuadro#2;
     nCasilla = #zocuadro#3;
     aTipo    = #zocuadro#5;
     aSigno   = #zocuadro#6;
     aCondi   = #zocuadro#8;

     |SI nCuadro = 19; |Y #zhazdocu#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI #zocuadro#2 = 13;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zocuadro;
     #zocuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zocuadro;
|FIN;

|PROCESO zqcuadro;
     aCuenta = #zqcuadro#4;  |QBF aCuenta;
     aAste   = aCuenta % -101;
     aLong   = aCuenta % 0;
     nLong   = aLong;
     nLong   = nLong - 1;
     nLong   = nLong + 100;
     aAlfa   = aCuenta % nLong;
     |SI aAste = "*";
         aCuentaD = (aAlfa + "            ") % 112;
         aCuentaH = (aAlfa + "zzzzzzzzzzzz") % 112;
     |SINO;
         aCuentaD = aCuenta;
         aCuentaH = aCuenta;
     |FINSI;

     nEjer = #zhazcrea#1;
     |SI #zqcuadro#7 = "A";  nEjer = #zhazcrea#1 - 1;  |FINSI;

     nCuadro  = #zqcuadro#2;
     nCasilla = #zqcuadro#3;
     aTipo    = #zqcuadro#5;
     aSigno   = #zqcuadro#6;
     aCondi   = #zqcuadro#8;

     |SI nCuadro = 19; |Y #zhazdocu#0 ] 2015;
         || ... Ya no se pasa
     |SINO;
         |BUCLE sodacoli;
     |FINSI;

     |SI nCuadro = 13;  |O nCuadro = 27;
         |BUCLE elAuxiliar;
     |FINSI;
|FPRC;

|DEFBUCLE zqcuadro;
     #zqcuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, zqcuadro;
|FIN;

|PROCESO cuadros_c;
     nSw = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE zqcuadro_c;
     #zqcuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|DEFBUCLE zocuadro_c;
     #zocuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|DEFBUCLE zpcuadro_c;
     #zpcuadro#1;
     ;
     nEjerCuadro,    1;
     nEjerCuadro, 9999;
     ;
     NULL, cuadros_c;
|FIN;

|PROCESO Grabaw3;
     |DDEFECTO #soda8w02;
     #soda8w02#0 = aCuenta;
     #soda8w02#5 = any;
     |LEE 101#soda8w02.=;
     |SI FSalida ! 0;
         #soda8w02#0 = aCuenta;
         #soda8w02#5 = any;
         |GRABA 020#soda8w02.b;
     |FINSI;

     |SI aSigno = "D";
         #soda8w02#1 = #soda8w02#1 + nImporte;
     |SINO;
         #soda8w02#2 = #soda8w02#2 + nImporte;
     |FINSI;
     |GRABA 020#soda8w02.a;
     |LIBERA #soda8w02;
|FPRC;

|PROCESO reparto_lin;
    aAlfa1 = #soda8m12#2; |QBF aAlfa1;
    |SI aAlfa1 ! "";
        aCuenta  = #soda8m12#2;
        aSigno   = #soda8m11#8;
        nImporte = #soda8m12#4;
        |HAZ Grabaw3;
    |FINSI;
|FPRC;

|DEFBUCLE reparto_lin;
     #soda8m12#1;
     ;
     #soda8m11#9, #soda8m11#10, #soda8m11#0, 01;
     #soda8m11#9, #soda8m11#10, #soda8m11#0, 99;
     e;
     NULL, reparto_lin;
|FIN;

|PROCESO reparto;
    aAlfa1 = #soda8m11#2; |QBF aAlfa1;
    |SI aAlfa1 ! "";
        aCuenta  = #soda8m11#2;
        nImporte = #soda8m11#4;
        aSigno   = #soda8m11#8;
        |HAZ Grabaw3;
    |SINO;
        |BUCLE reparto_lin;
    |FINSI;
|FPRC;

|DEFBUCLE reparto;
     #soda8m11#1;
     ;
     #zhazcrea#0, any, "            ";
     #zhazcrea#0, any, "zzzzzzzzzzzz";
     e;
     NULL, reparto;
|FIN;

|PROCESO zregcu04P;
     |BORRA 020#zregcu04.a;
     |LIBERA #zregcu04;
|FPRC;

|DEFBUCLE zregcu04P;
     #zregcu04#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu04P;
|FIN;

|PROCESO zregcu16P;
     |BORRA 020#zregcu16.a;
     |LIBERA #zregcu16;
|FPRC;

|DEFBUCLE zregcu16P;
     #zregcu16#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu16P;
|FIN;

|PROCESO zregcu18P;
     |BORRA 020#zregcu18.a;
     |LIBERA #zregcu18;
|FPRC;

|DEFBUCLE zregcu18P;
     #zregcu18#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu18P;
|FIN;

|PROCESO zregcu22P;
     |BORRA 020#zregcu22.a;
     |LIBERA #zregcu22;
|FPRC;

|DEFBUCLE zregcu22P;
     #zregcu22#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu22P;
|FIN;

|PROCESO zregcu30P;
     |BORRA 020#zregcu30.a;
     |LIBERA #zregcu30;
|FPRC;

|DEFBUCLE zregcu30P;
     #zregcu30#1;
     ;
     #zhazcrea#0, #zhazcrea#1, 001;
     #zhazcrea#0, #zhazcrea#1, 999;
     ;
     NULL, zregcu30P;
|FIN;

|PROCESO PaseCuadros;
    nSw = 0;
    nEjerCuadro = #zhazcrea#1;
    |SI #zhazcrea#15 = "P"; |Y nEjerCuadro > enUltMemP; nSw = 1; nEjerCuadro = enUltMemP; |FINSI;
    |SI #zhazcrea#15 = "A"; |Y nEjerCuadro > enUltMemA; nSw = 1; nEjerCuadro = enUltMemA; |FINSI;
    |SI #zhazcrea#15 = "C"; |Y nEjerCuadro > enUltMemC; nSw = 1; nEjerCuadro = enUltMemC; |FINSI;

    |SI enMensa = 0;
         aAlfa = "0000SEsta seguro de pasar los datos a los cuadros automaticos.";
         |SI nSw = 1;
             aAlfa = "0000NEsta seguro de pasar los datos a los cuadros con la configuracion del ao anterior.";
         |FINSI;
         |CONFI aAlfa;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         nSw = 0;
         |SI #zhazcrea#15 = "P"; |BUCLE zpcuadro_c; |FINSI;
         |SI #zhazcrea#15 = "A"; |BUCLE zocuadro_c; |FINSI;
         |SI #zhazcrea#15 = "C"; |BUCLE zqcuadro_c; |FINSI;
         |SI nSw = 0;
             |MENAV "0000No Existe Planilla para pasar los datos a Cuadros";
             |ACABA;
         |FINSI;

         nSwPaseAnt = 0;
         |SI #zhazdocu#0 ] 2009;
             nNume1 = #zhazdocu#0 - 1;
             aAlfa1 = nNume1;
             aAlfa1 = "0000SQuiere recoger los datos Ao Anterior de las CCAA del Ejercicio " + aAlfa1 + " ?";
             |CONFI aAlfa1;
             |SI FSalida = 0; nSwPaseAnt = 1; |FINSI;
         |FINSI;
     |SINO;
         nSwPaseAnt = 1;
     |FINSI;

     |HAZ VentanaTrabajo;

     |ABRE #zregcu01;  #zregcu01#0  = #zhazcrea#0;  #zregcu01#1  = #zhazcrea#1;  |BORRA 000#zregcu01.c;   |LIBERA #zregcu01;   |CIERRA #zregcu01;
     |ABRE #zregcu02;  #zregcu02#0  = #zhazcrea#0;  #zregcu02#1  = #zhazcrea#1;  |BORRA 000#zregcu02.c;   |LIBERA #zregcu02;   |CIERRA #zregcu02;
     |ABRE #zregcu03;  #zregcu03#0  = #zhazcrea#0;  #zregcu03#1  = #zhazcrea#1;  |BORRA 000#zregcu03.c;   |LIBERA #zregcu03;   |CIERRA #zregcu03;
     |ABRE #zregcu05;  #zregcu05#0  = #zhazcrea#0;  #zregcu05#1  = #zhazcrea#1;  |BORRA 000#zregcu05.c;   |LIBERA #zregcu05;   |CIERRA #zregcu05;
     |ABRE #zregcu07;  #zregcu07#0  = #zhazcrea#0;  #zregcu07#1  = #zhazcrea#1;  |BORRA 000#zregcu07.c;   |LIBERA #zregcu07;   |CIERRA #zregcu07;
     |ABRE #zregcu08;  #zregcu08#0  = #zhazcrea#0;  #zregcu08#1  = #zhazcrea#1;  |BORRA 000#zregcu08.c;   |LIBERA #zregcu08;   |CIERRA #zregcu08;
     |ABRE #zregcu09;  #zregcu09#0  = #zhazcrea#0;  #zregcu09#1  = #zhazcrea#1;  |BORRA 000#zregcu09.c;   |LIBERA #zregcu09;   |CIERRA #zregcu09;
     |ABRE #zregcu15;  #zregcu15#0  = #zhazcrea#0;  #zregcu15#1  = #zhazcrea#1;  |BORRA 000#zregcu15.c;   |LIBERA #zregcu15;   |CIERRA #zregcu15;
     |ABRE #zregcu17;  #zregcu17#0  = #zhazcrea#0;  #zregcu17#1  = #zhazcrea#1;  |BORRA 000#zregcu17.c;   |LIBERA #zregcu17;   |CIERRA #zregcu17;
     |ABRE #zregcu19;  #zregcu19#0  = #zhazcrea#0;  #zregcu19#1  = #zhazcrea#1;  |BORRA 000#zregcu19.c;   |LIBERA #zregcu19;   |CIERRA #zregcu19;
     |ABRE #zregcu20;  #zregcu20#0  = #zhazcrea#0;  #zregcu20#1  = #zhazcrea#1;  |BORRA 000#zregcu20.c;   |LIBERA #zregcu20;   |CIERRA #zregcu20;
     |ABRE #zregcu21;  #zregcu21#0  = #zhazcrea#0;  #zregcu21#1  = #zhazcrea#1;  |BORRA 000#zregcu21.c;   |LIBERA #zregcu21;   |CIERRA #zregcu21;
     |ABRE #zregcu24;  #zregcu24#0  = #zhazcrea#0;  #zregcu24#1  = #zhazcrea#1;  |BORRA 000#zregcu24.c;   |LIBERA #zregcu24;   |CIERRA #zregcu24;
     |ABRE #zregcu25;  #zregcu25#0  = #zhazcrea#0;  #zregcu25#1  = #zhazcrea#1;  |BORRA 000#zregcu25.c;   |LIBERA #zregcu25;   |CIERRA #zregcu25;
     |ABRE #zregcu26;  #zregcu26#0  = #zhazcrea#0;  #zregcu26#1  = #zhazcrea#1;  |BORRA 000#zregcu26.c;   |LIBERA #zregcu26;   |CIERRA #zregcu26;
     |ABRE #zregcu28;  #zregcu28#0  = #zhazcrea#0;  #zregcu28#1  = #zhazcrea#1;  |BORRA 000#zregcu28.c;   |LIBERA #zregcu28;   |CIERRA #zregcu28;
     |ABRE #zregcu29;  #zregcu29#0  = #zhazcrea#0;  #zregcu29#1  = #zhazcrea#1;  |BORRA 000#zregcu29.c;   |LIBERA #zregcu29;   |CIERRA #zregcu29;
     |ABRE #zregcu31;  #zregcu31#0  = #zhazcrea#0;  #zregcu31#1  = #zhazcrea#1;  |BORRA 000#zregcu31.c;   |LIBERA #zregcu31;   |CIERRA #zregcu31;
     |ABRE #zregcu32;  #zregcu32#0  = #zhazcrea#0;  #zregcu32#1  = #zhazcrea#1;  |BORRA 000#zregcu32.c;   |LIBERA #zregcu32;   |CIERRA #zregcu32;
     |ABRE #zregcu33;  #zregcu33#0  = #zhazcrea#0;  #zregcu33#1  = #zhazcrea#1;  |BORRA 000#zregcu32.c;   |LIBERA #zregcu33;   |CIERRA #zregcu33;

     |SI nSwPaseAnt = 1;
         |BUCLE zregcu04P;
         |BUCLE zregcu16P;
         |BUCLE zregcu18P;
         |BUCLE zregcu22P;
         |BUCLE zregcu30P;
     |FINSI;

     aFichero = "8m" + Usuario;
     |NOME_DAT #soda8w02#aFichero#;
     |DELINDEX #soda8w02;
     |ABRE #soda8w02;
     any = #zhazcrea#1;     |BUCLE reparto;
     any = #zhazcrea#1 - 1; |BUCLE reparto;
     |CIERRA #soda8w02;

     |SI #zhazcrea#15 = "P";
         |ABRE #zregcu01;
         |ABRE #zregcu02;
         |ABRE #zregcu03;
         |ABRE #zregcu05;
         |ABRE #zregcu07;
         |ABRE #zregcu08;
         |ABRE #zregcu09;
         |ABRE #zregcu15;
         |ABRE #zregcu24;
         |ABRE #zregcu28;

         |BUCLE zpcuadro;

         |CIERRA #zregcu01;
         |CIERRA #zregcu02;
         |CIERRA #zregcu03;
         |CIERRA #zregcu05;
         |CIERRA #zregcu07;
         |CIERRA #zregcu08;
         |CIERRA #zregcu09;
         |CIERRA #zregcu15;
         |CIERRA #zregcu24;
         |CIERRA #zregcu28;
     |FINSI;

     |SI #zhazcrea#15 = "A";
         |ABRE #zregcu01;
         |ABRE #zregcu17;
         |ABRE #zregcu03;
         |ABRE #zregcu19;
         |ABRE #zregcu07;
         |ABRE #zregcu20;
         |ABRE #zregcu21;
         |ABRE #zregcu15;
         |ABRE #zregcu24;
         |ABRE #zregcu28;

         |BUCLE zocuadro;

         |CIERRA #zregcu01;
         |CIERRA #zregcu17;
         |CIERRA #zregcu03;
         |CIERRA #zregcu19;
         |CIERRA #zregcu07;
         |CIERRA #zregcu20;
         |CIERRA #zregcu21;
         |CIERRA #zregcu15;
         |CIERRA #zregcu24;
         |CIERRA #zregcu28;
     |FINSI;

     |SI #zhazcrea#15 = "C";
         |ABRE #zregcu01;
         |ABRE #zregcu02;
         |ABRE #zregcu03;
         |ABRE #zregcu05;
         |ABRE #zregcu07;
         |ABRE #zregcu08;
         |ABRE #zregcu09;
         |ABRE #zregcu15;
         |ABRE #zregcu24;
         |ABRE #zregcu25;
         |ABRE #zregcu26;
         |ABRE #zregcu28;

         |BUCLE zqcuadro;

         |CIERRA #zregcu01;
         |CIERRA #zregcu02;
         |CIERRA #zregcu03;
         |CIERRA #zregcu05;
         |CIERRA #zregcu07;
         |CIERRA #zregcu08;
         |CIERRA #zregcu09;
         |CIERRA #zregcu15;
         |CIERRA #zregcu24;
         |CIERRA #zregcu25;
         |CIERRA #zregcu26;
         |CIERRA #zregcu28;
     |FINSI;

     |DELINDEX #soda8w02;

     |HAZ PaseAnterior;

     |SI #zhazdocu#0 ] 2013;
         |SUB_EJECUTA "mez00009";
         ||  ....  Pase Cuadro Laboral
     |FINSI;

     |SI #zhazdocu#0 ] 2015;
         |HAZ PaseZregcu29;
         ||  ....  Pase Cuadro Nuevo
     |FINSI;

     |HAZ FinVentanaTrabajo;

     |SI enMensa = 0;
         |MENAV "0000Pase a cuadro realizado.";
     |FINSI;

     |PULSATECLA;
|FPRC;
