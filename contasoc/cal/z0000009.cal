|FICHEROS;
     z0000009 #0;
     metextos #1;
|FIN;

|VARIABLES;
     SwHay     = 0;
     XCampos1  = 0;
     XCampos2  = 0;
     Fichero   = "";
     Valfa     = "";
     Tecla     = 0;
     DesdeText = "                                                                              ";
     HastaText = "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz";

     &DesdeCap = 0;
     &HastaCap = 0;
     &DesdeEmp = 0;
     &HastaEmp = 0;
|FIN;

|PROCESO CargaTempo;
  |PARA XCampos1 = 2;  |SI XCampos1 [ 16;  |HACIENDO XCampos1 = XCampos1 + 1;
        Valfa = #1XCampos1;  |QBT Valfa;
        |SI Valfa ! "";
            XCampos2 = XCampos1 + 16;

            #0#0  = #1#0;
            #0#1  = #1#1;
            #0#2  = #1#17;
            #0#3  = XCampos1 - 1;
            #0#4  = #1XCampos1;
            #0#5  = #1XCampos2;
            |SI #0#5 = "     ";  #0#5 = "[004]";  |FINSI;

            |GRABA 140#0n;
            |LIBERA #0;

            SwHay = 1;
        |FINSI;
  |SIGUE;
|FPRC;

|DEFBUCLE metextos;
  #1#1;
  ;
  DesdeCap, 00, DesdeEmp;
  HastaCap, 99, HastaEmp;
  ;
  NULL, CargaTempo;
|FIN;

|RUTINA ClaveBaja;
  #0#0  = 0;
  #0#1  = 0;
  #0#2  = 0;
  #0#3  = 1;
  #0#4  = DesdeText;
|FRUT;

|RUTINA ClaveAlta;
  #0#0  = 999999;
  #0#1  = 99;
  #0#2  = 99999;
  #0#3  = 15;
  #0#4  = HastaText;
|FRUT;

|PROCESO Regraba;
  #1#0  = #0#0;
  #1#1  = #0#1;
  #1#17 = #0#2;
  |LIBERA #1;
  |LEE 140#1=;
  |SI FSalida = 0;
     XCampos1   = #0#3 + 17;
     #1XCampos1 = #0#5;
     |GRABA 140#1a;
  |FINSI;
|FPRC;

|DEFBUCLE z0000009;
  #0#1;
  ;
  000000, 00, 00000, 00, DesdeText;
  999999, 99, 99999, 99, HastaText;
  ;
  NULL, Regraba;
|FIN;

|PROGRAMA;
  Fichero = ("09" + Usuario + "zzzzzzzz") % 108;
  |NOME_DAT #0 Fichero;
  |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

  |SI DesdeCap = 0;
      DesdeCap = 0;
      HastaCap = 999999;
      DesdeEmp = 0;
      HastaEmp = 99999;
  |FINSI;

  SwHay  = 0;
  |ABRE #0;
  |BUCLE metextos;
  |CIERRA #0;

  |SI SwHay  = 0;
      |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
      |ACABA;
  |FINSI;

  |CLS;
  |CABEZA "Carga Caracetres Word.";

  |ENTLINEAL #1#0, 5, 4, 22, 1, ClaveBaja, ClaveAlta;

  |ABRE #1;
  |BUCLE z0000009;
  |CIERRA #1;

  |ABRE #0;  |CIERRA #0;  |DELINDEX #0;
|FPRO;

|PROCESO Tipo11;  |TIPO 11;
  Tecla = FSalida;

  |SI Tecla ! 9;  |Y Tecla ! 10;  |ACABA;  |FINSI;

  |LIBERA #0;
  |LEE 140#0=;

  |SI Tecla = 9;   #0#5 = "[004]";  |FINSI;
  |SI Tecla = 10;  #0#5 = "[003]";  |FINSI;

  |PINTA #0#5;
  |GRABA 140#0a;

  |ERROR;
|FPRC;
