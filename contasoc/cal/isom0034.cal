|FICHEROS;
     isom0001;
     isom0034;

     isom0505;
     isom0521;
|FIN;

|VARIABLES;
      nRango         = 0;
      nBotonSal      = 0;
      nBotonAnota    = -1;
      nTree          = 0;
      nHandle        = 0;
      nPanta         = 0;
      nBotonLabel    = 0;
      nVentana       = 0;
      nVent          = 0;
      nGrid          = 0;
      nModo          = 0;
      nLinea         = 0;
      nBase          = 0;
      nBase1         = 0;
      nCasilla560    = 0;
      nSal           = 0;
      nBotonDat      = 0;
      nHija          = 0;
      nImp1          = 0;
      nImp2          = 0;

      aCm            = "";
      aContenido     = "";
      aTexto         = "";
      aBase          = "";
      aAlfa          = "";
      aAbre          = "";
      aEsc1          = "";
      aEsc2          = "";
      aRetu          = "";
      aTecla         = "";
      aCasilla       = "";

     {-1}sTree       = 0;
     sT_nID          = 0;
     sT_nOper        = 0;
     sT_aData        = "";

     {-1}aVent       = "";
         aVent1      = 0;
         aVent2      = 0;
         aVent3      = 0;
         aVent4      = 0;
         aVent5      = "";

     &enEmpresa      = 0;
     &enAnyo         = 0;
     &eaCasilla      = "";
     &eaTitCasilla   = "";
     &eaRutaOrigen   = "";
     &eaRutaDestino  = "";
     &eaFicheroTra   = "";
     &eaFicheroTxt   = "";
     &eaFicheroTgz   = "";
     &eaFicheroTar   = "";
     &eaOrigen       = "";
     &eaDestino      = "";
     &eaAlfa         = "";
     &eaTipoColor    = "";
     &eaColor        = "";
     &enModoConsulta = 0;
     &enImporte      = 0;
|FIN;

|PROCESO Tipo1;  |TIPO 1;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo = 1;  |O nModo = 3;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo2;  |TIPO 2;
     |HAZ Tipo1;
|FPRC;

|PROCESO isom0034Tot;
     |SI #isom0034#3 ] 15;  |Y #isom0034#3 [ 35;
         nImp1 = nImp1 + #isom0034#5;
     |FINSI;

     |SI #isom0034#3 ] 45;  |Y #isom0034#3 [ 65;
         nImp2 = nImp2 + #isom0034#5;
     |FINSI;
|FPRC;

|DEFBUCLE isom0034Tot;
     #isom0034#1;
     ;
     enEmpresa, enAnyo, eaCasilla, 00;
     enEmpresa, enAnyo, eaCasilla, 99;
     ;
     NULL, isom0034Tot;
|FIN;

|PROCESO TotalFich;
     nImp1 = 0;
     nImp2 = 0;
     |BUCLE isom0034Tot;

     #isom0034#0 = enEmpresa;
     #isom0034#1 = enAnyo;
     #isom0034#2 = eaCasilla;
     #isom0034#3 = 10;
     |LEE 101#isom0034.=;
     |SI FSalida = 0;
         #isom0034#5  = nImp1;
         |GRABA 020#isom0034.a;
         |LIBERA #isom0034;
     |FINSI;

     #isom0034#0 = enEmpresa;
     #isom0034#1 = enAnyo;
     #isom0034#2 = eaCasilla;
     #isom0034#3 = 40;
     |LEE 101#isom0034.=;
     |SI FSalida = 0;
         #isom0034#5  = nImp2;
         |GRABA 020#isom0034.a;
         |LIBERA #isom0034;
     |FINSI;
|FPRC;

|PROCESO T3;  |TIPO 3;
     |SI enAnyo ] 2019;
         |ACABA;
     |FINSI;

     nLinea = #isom0034#3;

     |GRABA 020#isom0034.a;
     |LIBERA #isom0034;

     |HAZ TotalFich;

     #isom0034#0 = enEmpresa;
     #isom0034#1 = enAnyo;
     #isom0034#2 = eaCasilla;
     #isom0034#3 = nLinea;
     |LEE 101#isom0034.=;

     aAlfa = "|IDGRID";
     aAlfa = #isom0034#aAlfa#;
     nGrid = aAlfa;
     |REFRESCACONTROL nGrid;
|FPRC;

|PROCESO Entra2019;
     |ABRE #isom0505;
     |SELECT #2#isom0505;
     #isom0505#0 = enAnyo;
     #isom0505#2 = eaCasilla
     |LEE 000#isom0505.=;
     |SI FSalida ! 0;
         |SELECT #3#isom0505;
         #isom0505#0 = enAnyo;
         #isom0505#3 = eaCasilla
         |LEE 000#isom0505.=;
         |SI FSalida ! 0;|DDEFECTO #isom0505;  |FINSI;
     |FINSI;
     |CIERRA #isom0505;

     |SI #isom0034#3 = 5;  aCm  = #isom0505#8;  |FINSI;
     |SI #isom0034#3 = 10; aCm  = #isom0505#9;  |FINSI;
     |SI #isom0034#3 = 15; aCm  = #isom0505#10; |FINSI;
     |SI #isom0034#3 = 20; aCm  = #isom0505#11; |FINSI;
     |SI #isom0034#3 = 25; aCm  = #isom0505#12; |FINSI;

     |QBF aCm;
     |SI aCm = "";  aCm = "S";  |FINSI;

     |C_M #isom0034#5, 1, aCm;
|FPRC;

|PROCESO T0;  |TIPO 0;
     |SI enAnyo ] 2019;
         |HAZ Entra2019;
         |ACABA;
     |FINSI;

     |C_M #isom0034#5,  1, "S";

     |SI #isom0034#3 = 10;
      |O #isom0034#3 = 40;
         |C_M #isom0034#5,  1, "N";
     |FINSI;
|FPRC;

|PROCESO Evento134;
|FPRC;

|PROCESO isom0521;
     #isom0034#0  = enEmpresa;
     #isom0034#1  = #isom0521#0;
     #isom0034#2  = eaCasilla;
     #isom0034#3  = #isom0521#1;
     |LEE 101#isom0034.=;
     |SI FSalida ! 0;
         |DDEFECTO #isom0034;
         #isom0034#0  = enEmpresa;
         #isom0034#1  = #isom0521#0;
         #isom0034#2  = eaCasilla;
         #isom0034#3  = #isom0521#1;
         |GRABA 020#isom0034.b;
     |FINSI;

     #isom0034#4  = #isom0521#2;

     |GRABA 020#isom0034.a;
     |LIBERA #isom0034;
|FPRC;

|DEFBUCLE isom0521;
     #isom0521#1;
     ;
     enAnyo, 00;
     enAnyo, 99;
     ;
     NULL, isom0521;
|FIN;

|PROCESO MontaEstructura521;
     |BUCLE isom0521;
|FPRC;

|PROCESO isom0034;
     |SI enAnyo = 2018;
         |SI #isom0034#3 = 5;
          |O #isom0034#3 = 10;
          |O #isom0034#3 = 40;
             enImporte = enImporte + #isom0034#5;
          |FINSI;
     |FINSI;

     |SI enAnyo ] 2019;
         |SI #isom0034#3 [ 15;
             enImporte = enImporte + #isom0034#5;
         |FINSI;
     |FINSI;
|FPRC;

|DEFBUCLE isom0034;
     #isom0034#1;
     ;
     enEmpresa, enAnyo, eaCasilla, 00;
     enEmpresa, enAnyo, eaCasilla, 99;
     be;
     NULL, isom0034;
|FIN;

|PROCESO isom0034B;
     |SI #isom0034#5 ! 0;  |ACABA;  |FINSI;

     |BORRA 020#isom0034.a;
     |LIBERA #isom0034;
|FPRC;

|DEFBUCLE isom0034B;
     #isom0034#1;
     ;
     enEmpresa, enAnyo, eaCasilla, 00;
     enEmpresa, enAnyo, eaCasilla, 99;
     be;
     NULL, isom0034B;
|FIN;

|PROCESO BotonSalir;
     |PTEC 807;
|FPRC;

|PROCESO Baja134;
     #isom0034#0  = enEmpresa;
     #isom0034#1  = enAnyo;
     #isom0034#2  = eaCasilla;
     #isom0034#3  = 1;
|FPRC;

|PROCESO Alta134;
     #isom0034#0  = enEmpresa;
     #isom0034#1  = enAnyo;
     #isom0034#2  = eaCasilla;
     #isom0034#3  = 99;
|FPRC;

|PROGRAMA;
     aAlfa = "";
     |SI enModoConsulta = 1;
         aAlfa = "(MODO CONSULTA)   ";
     |FINSI;

     aAlfa = aAlfa + "Detalle de la casilla " + eaCasilla;
     |VENTANA 0501, 3599, -1, 16, aAlfa;
     nVentana = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |HAZ MontaEstructura521;

     #isom0034#0 = enEmpresa;
     #isom0034#1 = enAnyo;
     #isom0034#2 = eaCasilla;
     #isom0034#3 = 5;
     |LEE 000#isom0034.];

     |PINPA #0#isom0034;
     nPanta = FSalida;

     |PARA;  |SI;  |HACIENDO;
          |CONTROL_SIMPLE 0, "BOTON,{{197}}Sa&Lir", 3485, 3498, BotonSalir;
          nBotonSal = FSalida;

          #isom0034#0 = enEmpresa;
          #isom0034#1 = enAnyo;
          #isom0034#2 = eaCasilla;
          #isom0034#3 = nLinea;
          |LEE 000#isom0034.=;

          |SI enModoConsulta = 0;
              nRango = 1 + 2 + 4 + 8 + 16 + 128 + 256;
          |SINO;
              nRango = 2 + 4 + 8 + 16 + 128 + 256;
          |FINSI;

          |LINEAL_SIMPLE #1#isom0034, nRango, 0602, 3495, Baja134, Alta134, Evento134;

          |FIN_CONTROL_WINDOWS nBotonSal;

          |SI nSal = 0;  |SAL;  |FINSI;

          |SI nBotonDat ! -1;
              |FIN_CONTROL_WINDOWS nBotonDat;
          |FINSI;
     |SIGUE;

     |SI enModoConsulta = 0;
         enImporte = 0;
         |BUCLE isom0034;
     |FINSI;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = nVentana;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PULSATECLA;

     |FINVENTANA nVentana;
     |PULSATECLA;
|FPRO;

|PROCESO Tipo80m34;  |TIPO 80;
     |ABRET #isom0034;

     FSalida = 3499;
|FPRC;

|PROCESO Tipo90m34;  |TIPO 90;
     |BUCLE isom0034B;

     |CIERRAT #isom0034;
|FPRC;
