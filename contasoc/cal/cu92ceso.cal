|FICHEROS;
   cu92ceso #0;
   cubala02 #2;
   cubala03 #3;
   cubala04 #4;
   cubala05 #5;

   :/basica/def/agim0019 #6;
|FIN;

|VARIABLES;
   sw       = 0;
   &empresa = 0;
   &anyo    = 0;
   &nombre  = "";
   &nif     = "";
   &tipo    = "";
   &unid    = "";
   &opcion  = 0;
   &modo    = 0;
   &sw_mod  = 0;

   fich     = "";
   provi    = "";
   fondo    = "°";
   x        = 0;
   posici   = 0;
   horizo   = "";
   SwIntegrador = 0;
   Modulo       = "";

{-1} menu   = "";
   menu1    = "1220";
   menu2    = "1";
   menu3    = "9";
   menu4    = "Pase Ejercicio Anterior            ";
   menu5    = "Pase desde Entrada General de Datos";
   menu6    = "Entrada del Activo                 ";
   menu7    = "Entrada del Pasivo                 ";
   menu8    = "Entrada del Debe                   ";
   menu9    = "Entrada del Haber                  ";
   menu10   = "Calculo Debe - Haber               ";
   menu11   = "Pantalla de Totales                ";
   menu12   = "Impresion Registro                 ";
|FIN;


|PROCESO forzar;
|SI #0#5 = "A";
    #0#12 = "A";
    |CAMPO_MODIFICA #0#12, 1, "N";
|SINO;
    #0#12 = "E";
    |CAMPO_MODIFICA #0#12, 1, "S";
|FINSI;
|PINTA #0#12;
|FPRC;

|PROCESO Registro;
|ABRE #6;
#6#0 = #0#0;
#6#1 = 99;
|LEE 040#6];
|SI FSalida = 0;
    |LEE 040#6a;
|SINO;
    |LEE 040#6u;
|FINSI;
|SI FSalida ! 0;  |O #6#0 ! #0#0;
    |DDEFECTO #6;
|FINSI;
|CIERRA #6;

#0#3  = #6#27;
#0#6  = #6#29;
#0#7  = #6#30;
#0#8  = #6#31;
#0#9  = #6#32;
#0#10 = #6#33;
#0#11 = #6#59;
|SI #0#11 = "           ";
    #0#11 = #6#34;
|FINSI;
|FPRC;

|PROCESO leeregi; |TIPO 0;
modo = (FEntrada / 100) ! 0;
|SI modo = 1;
    |HAZ Registro;
    |PINTA #0#3;
    |PINTA #0#6;
    |PINTA #0#7;
    |PINTA #0#8;
    |PINTA #0#9;
    |PINTA #0#10;
    |PINTA #0#11;
|FINSI;
|FPRC;

|PROCESO cambioti; |TIPO 0;
modo = (FEntrada / 100) ! 0;
|SI modo ! 1;
    |CAMPO_MODIFICA #0#5, 1, "N";
|SINO;
    |CAMPO_MODIFICA #0#5, 1, "S";
|FINSI;
|FPRC;

|PROCESO borrado; |TIPO 2;
modo = (FEntrada / 100) ! 0;
|SI modo = 3;
    |PINTA 2430,"Borrando Registro ...";
    |ABRE #2; #2#0 = #0#0; #2#1 = #0#1; |BORRA 101#2c; |LIBERA #2; |CIERRA #2;
    |ABRE #3; #3#0 = #0#0; #3#1 = #0#1; |BORRA 101#3c; |LIBERA #3; |CIERRA #3;
    |ABRE #4; #4#0 = #0#0; #4#1 = #0#1; |BORRA 101#4c; |LIBERA #4; |CIERRA #4;
    |ABRE #5; #5#0 = #0#0; #5#1 = #0#1; |BORRA 101#5c; |LIBERA #5; |CIERRA #5;
    |PINTA 2430,"                     ";
|FINSI;
|FPRC;

|PROCESO acceso;|TIPO 30;
modo = (FEntrada / 100) ! 0;
|SI modo = 1; |O modo = 2;
    |CONFI "2400SAlta / Modificacion de los 2 Periodos : ";
    |SI FSalida = 0; sw_mod = 0; |SINO; sw_mod = 1; |FINSI;
    |CIERRAT #0;
    |HAZ pantalla;
    |ABRET #0;
|FINSI;
sw_mod = 0;
|FPRC;

|PROCESO consulta; |TIPO 13;
modo = FEntrada / 100;
modo = modo ! 0;
|SI modo = 4;
    |CAMPO_MODIFICA #0#2, 1, "S";
    |CAMPO_MODIFICA #0#4, 1, "S";
    |PINTA #0#0;
    |PINTA #0#1;
    |PINTA #0#2;
    |PINTA #0#3;
    |PINTA #0#4;
    |PINTA #0#5;
    |PINTA #0#6;
    |PINTA #0#7;
    |PINTA #0#8;
    |PINTA #0#9;
    |PINTA #0#10;
    |PINTA #0#11;
    |PINTA #0#12;
    |HAZ pantalla;
|SINO;
    |CAMPO_MODIFICA #0#2, 1, "N";
    |CAMPO_MODIFICA #0#4, 1, "N";
|FINSI;
|FPRC;

|PROCESO pantalla;
opcion = 1;
sw = 0;
empresa = #0#0;
anyo    = #0#1;
nombre  = #0#2;
unid    = #0#3;
nif     = #0#4;
tipo    = #0#5;
|PARA; |SI sw = 0; |HACIENDO;
   |PARA x = 11; |SI x [ 22; |HACIENDO x = x + 1;
       posici = (x * 100) + 61;
       |PINTA posici,fondo;
   |SIGUE;
   horizo = "";
   |PARA x = 13; |SI x [ 61; |HACIENDO x = x + 1;
       horizo = horizo + fondo;
   |SIGUE;
   |PINTA 2313,horizo;
   menu2  = opcion;
   |MENUG menu;
   opcion = FSalida;
   |SI opcion ] 1; |Y opcion [ 9;
       |SI opcion = 1; |Y modo ! 4; |SUB_EJECUTA "cubala12.run"; |FINSI;
       |SI opcion = 2; |Y modo ! 4; |SUB_EJECUTA "cu92la01.run"; |FINSI;
       |SI opcion = 3;  |SUB_EJECUTA "cubala02.run"; |FINSI;
       |SI opcion = 4;  |SUB_EJECUTA "cubala03.run"; |FINSI;
       |SI opcion = 5;  |SUB_EJECUTA "cubala04.run"; |FINSI;
       |SI opcion = 6;  |SUB_EJECUTA "cubala05.run"; |FINSI;
       |SI opcion = 7; |Y modo ! 4; |SUB_EJECUTA "cubala06.run"; |FINSI;
       |SI opcion = 8;  |SUB_EJECUTA "cubala07.run"; |FINSI;
       |SI opcion = 9; |Y modo ! 4; |SUB_EJECUTA "cubala08.run"; |FINSI;
   |SINO;
       sw = 1;
   |FINSI;
|SIGUE;
|PINPA #0#0;
|FPRC;
