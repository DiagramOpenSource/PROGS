|FICHEROS;
     zmenumem #99;

     cubala02 #1;
     cubala03 #2;
     cubala04 #3;
     cubala05 #4;

     cubala22 #22;
     cubala23 #23;
     cubala24 #24;
     cubala25 #25;

     cuacceso #5;
     maempr01 #6;
     cubala08 #7;
     maempr03 #8;
     megwordc #500;
     megwordl #501;
|FIN;

|VARIABLES;
     &ptas       = "";
     &mile       = "";
     &ejer1      = "";
     &ejer2      = "";
     &eaMoneda   = "";

     aCapitulo   = "";
     aPrograma   = "";
     aParametro  = "";
     aEmpresa    = "";
     aTipo       = "";
     aOpcion     = "";
     aExiste     = "";
     aIPRemoto   = "";
     aBase       = "";
     aOrigen     = "";
     aDestino    = "";
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aAlfa3      = "";
     aAlfa4      = "";
     aManolo     = "";
     aLong       = "";
     aVersion    = "";
     aCaracter   = "";
     aCampos     = "";
     aAnyo       = "";
     aHora       = "";
     aAsigna     = "";
     aIdenti     = "";

     nVersion    = 0;
     nLong       = 0;
     nCampo      = 0;
     nCampoT     = 0;
     nPosi       = 0;
     nNumero     = 0;
     nCampos     = 0;
     nTCampos    = 0;
     nWord       = 0;
     nEmpresa    = 0;
     nAnyo       = 0;
     nHandle     = 0;
     nRepite     = 0;
     nFichero    = 0;

     &eaImporte  = "";
     &eaOrigen   = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &eaUnidadBasico = "";

     {600}apExterna = "";
|FIN;

|PROCESO Abreviado;
     |SI #6#93 = 1;   ptas = "X";  mile = " ";  |FINSI;
     |SI #6#93 = 2;   ptas = " ";  mile = "X";  |FINSI;

     IapExterna = apExterna1 <-;     apExterna  = "220";
     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 1
     IapExterna = IapExterna + 1;    apExterna = #6#2;               || 2
     IapExterna = IapExterna + 1;    apExterna = #6#4;               || 3
     IapExterna = IapExterna + 1;    apExterna = #6#5;               || 4
     IapExterna = IapExterna + 1;    apExterna = #6#6;               || 5
     IapExterna = IapExterna + 1;    apExterna = #6#7;               || 6
     IapExterna = IapExterna + 1;    apExterna = #6#8;               || 7
     IapExterna = IapExterna + 1;    apExterna = #6#9;               || 8
     IapExterna = IapExterna + 1;    apExterna = #6#13;              || 9
     IapExterna = IapExterna + 1;    apExterna = #6#14;              || 10
     IapExterna = IapExterna + 1;    apExterna = #6#12;              || 11
     IapExterna = IapExterna + 1;    apExterna = #6#15;              || 12
     IapExterna = IapExterna + 1;    apExterna = #6#19;              || 13
     IapExterna = IapExterna + 1;    apExterna = #6#17;              || 14
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 15
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 16
     IapExterna = IapExterna + 1;    apExterna = #6#86;              || 17
     IapExterna = IapExterna + 1;    apExterna = #6#87;              || 18
     IapExterna = IapExterna + 1;    apExterna = #6#88;              || 19
     IapExterna = IapExterna + 1;    apExterna = #6#89;              || 20
     IapExterna = IapExterna + 1;    apExterna = #6#32 % -104;       || 21
     IapExterna = IapExterna + 1;    apExterna = #6#32 %  402;       || 22
     IapExterna = IapExterna + 1;    apExterna = #6#32 %  102;       || 23
     IapExterna = IapExterna + 1;    apExterna = #6#90;              || 24
     IapExterna = IapExterna + 1;    apExterna = #6#91;              || 25
     IapExterna = IapExterna + 1;    apExterna = #6#92;              || 26
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 27
     IapExterna = IapExterna + 1;    apExterna = mile;               || 28

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 29
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 30
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 31
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 32
     IapExterna = IapExterna + 1;    apExterna = mile;               || 33
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 34
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 35
     IapExterna = IapExterna + 1;    apExterna = #1#70;              || 36
     IapExterna = IapExterna + 1;    apExterna = #1#6;               || 37
     IapExterna = IapExterna + 1;    apExterna = #1#71;              || 38
     IapExterna = IapExterna + 1;    apExterna = #1#7;               || 39
     IapExterna = IapExterna + 1;    apExterna = #1#72;              || 40
     IapExterna = IapExterna + 1;    apExterna = #1#8;               || 41
     IapExterna = IapExterna + 1;    apExterna = #1#73;              || 42
     IapExterna = IapExterna + 1;    apExterna = #1#9;               || 43
     IapExterna = IapExterna + 1;    apExterna = #1#83;              || 44
     IapExterna = IapExterna + 1;    apExterna = #1#19;              || 45
     IapExterna = IapExterna + 1;    apExterna = #1#91;              || 46
     IapExterna = IapExterna + 1;    apExterna = #1#27;              || 47
     IapExterna = IapExterna + 1;    apExterna = #1#100;             || 48
     IapExterna = IapExterna + 1;    apExterna = #1#36;              || 49
     IapExterna = IapExterna + 1;    apExterna = #1#101;             || 50
     IapExterna = IapExterna + 1;    apExterna = #1#37;              || 51
     IapExterna = IapExterna + 1;    apExterna = #1#102;             || 52
     IapExterna = IapExterna + 1;    apExterna = #1#38;              || 53
     IapExterna = IapExterna + 1;    apExterna = #1#103;             || 54
     IapExterna = IapExterna + 1;    apExterna = #1#39;              || 55
     IapExterna = IapExterna + 1;    apExterna = #1#104;             || 56
     IapExterna = IapExterna + 1;    apExterna = #1#40;              || 57
     IapExterna = IapExterna + 1;    apExterna = #1#105;             || 58
     IapExterna = IapExterna + 1;    apExterna = #1#41;              || 59
     IapExterna = IapExterna + 1;    apExterna = #1#113;             || 60
     IapExterna = IapExterna + 1;    apExterna = #1#49;              || 61
     IapExterna = IapExterna + 1;    apExterna = #1#121;             || 62
     IapExterna = IapExterna + 1;    apExterna = #1#57;              || 63
     IapExterna = IapExterna + 1;    apExterna = #1#130;             || 64
     IapExterna = IapExterna + 1;    apExterna = #1#66;              || 65
     IapExterna = IapExterna + 1;    apExterna = #1#131;             || 66
     IapExterna = IapExterna + 1;    apExterna = #1#67;              || 67
     IapExterna = IapExterna + 1;    apExterna = #1#132;             || 68
     IapExterna = IapExterna + 1;    apExterna = #1#68;              || 69
     IapExterna = IapExterna + 1;    apExterna = #1#133;             || 70
     IapExterna = IapExterna + 1;    apExterna = #1#69;              || 71

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 72
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 73
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 74
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 75
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 76
     IapExterna = IapExterna + 1;    apExterna = #2#79;              || 77
     IapExterna = IapExterna + 1;    apExterna = #2#6;               || 78
     IapExterna = IapExterna + 1;    apExterna = #2#80;              || 79
     IapExterna = IapExterna + 1;    apExterna = #2#7;               || 80
     IapExterna = IapExterna + 1;    apExterna = #2#81;              || 81
     IapExterna = IapExterna + 1;    apExterna = #2#8;               || 82
     IapExterna = IapExterna + 1;    apExterna = #2#82;              || 83
     IapExterna = IapExterna + 1;    apExterna = #2#9;               || 84
     IapExterna = IapExterna + 1;    apExterna = #2#83;              || 85
     IapExterna = IapExterna + 1;    apExterna = #2#10;              || 86
     IapExterna = IapExterna + 1;    apExterna = #2#156;             || 87
     IapExterna = IapExterna + 1;    apExterna = #2#157;             || 88
     IapExterna = IapExterna + 1;    apExterna = #2#88;              || 89
     IapExterna = IapExterna + 1;    apExterna = #2#15;              || 90
     IapExterna = IapExterna + 1;    apExterna = #2#89;              || 91
     IapExterna = IapExterna + 1;    apExterna = #2#16;              || 92
     IapExterna = IapExterna + 1;    apExterna = #2#93;              || 93
     IapExterna = IapExterna + 1;    apExterna = #2#20;              || 94
     IapExterna = IapExterna + 1;    apExterna = #2#94;              || 95
     IapExterna = IapExterna + 1;    apExterna = #2#21;              || 96
     IapExterna = IapExterna + 1;    apExterna = #2#95;              || 97
     IapExterna = IapExterna + 1;    apExterna = #2#22;              || 98
     IapExterna = IapExterna + 1;    apExterna = #2#96;              || 99
     IapExterna = IapExterna + 1;    apExterna = #2#23;              || 100
     IapExterna = IapExterna + 1;    apExterna = #2#100;             || 101
     IapExterna = IapExterna + 1;    apExterna = #2#27;              || 102
     IapExterna = IapExterna + 1;    apExterna = #2#105;             || 103
     IapExterna = IapExterna + 1;    apExterna = #2#32;              || 104
     IapExterna = IapExterna + 1;    apExterna = #2#125;             || 105
     IapExterna = IapExterna + 1;    apExterna = #2#52;              || 106
     IapExterna = IapExterna + 1;    apExterna = #2#150;             || 107
     IapExterna = IapExterna + 1;    apExterna = #2#77;              || 108
     IapExterna = IapExterna + 1;    apExterna = #2#151;             || 109
     IapExterna = IapExterna + 1;    apExterna = #2#78;              || 110

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 111
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 112
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 113
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 114
     IapExterna = IapExterna + 1;    apExterna = mile;               || 115
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 116
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 117
     IapExterna = IapExterna + 1;    apExterna = #3#45;              || 118
     IapExterna = IapExterna + 1;    apExterna = #3#6;               || 119
     IapExterna = IapExterna + 1;    apExterna = #3#46;              || 120
     IapExterna = IapExterna + 1;    apExterna = #3#7;               || 121
     IapExterna = IapExterna + 1;    apExterna = #3#51;              || 122
     IapExterna = IapExterna + 1;    apExterna = #3#12;              || 123
     IapExterna = IapExterna + 1;    apExterna = #3#52;              || 124
     IapExterna = IapExterna + 1;    apExterna = #3#13;              || 125
     IapExterna = IapExterna + 1;    apExterna = #3#53;              || 126
     IapExterna = IapExterna + 1;    apExterna = #3#14;              || 127
     IapExterna = IapExterna + 1;    apExterna = #3#54;              || 128
     IapExterna = IapExterna + 1;    apExterna = #3#15;              || 129
     IapExterna = IapExterna + 1;    apExterna = #3#55;              || 130
     IapExterna = IapExterna + 1;    apExterna = #3#16;              || 131
     IapExterna = IapExterna + 1;    apExterna = #3#59;              || 132
     IapExterna = IapExterna + 1;    apExterna = #3#20;              || 133
     IapExterna = IapExterna + 1;    apExterna = #3#64;              || 134
     IapExterna = IapExterna + 1;    apExterna = #3#25;              || 135
     IapExterna = IapExterna + 1;    apExterna = #3#65;              || 136
     IapExterna = IapExterna + 1;    apExterna = #3#26;              || 137
     IapExterna = IapExterna + 1;    apExterna = #3#66;              || 138
     IapExterna = IapExterna + 1;    apExterna = #3#27;              || 139
     IapExterna = IapExterna + 1;    apExterna = #3#67;              || 140
     IapExterna = IapExterna + 1;    apExterna = #3#28;              || 141
     IapExterna = IapExterna + 1;    apExterna = #3#68;              || 142
     IapExterna = IapExterna + 1;    apExterna = #3#29;              || 143
     IapExterna = IapExterna + 1;    apExterna = #3#69;              || 144
     IapExterna = IapExterna + 1;    apExterna = #3#30;              || 145
     IapExterna = IapExterna + 1;    apExterna = #3#70;              || 146
     IapExterna = IapExterna + 1;    apExterna = #3#31;              || 147
     IapExterna = IapExterna + 1;    apExterna = #3#71;              || 148
     IapExterna = IapExterna + 1;    apExterna = #3#32;              || 149
     IapExterna = IapExterna + 1;    apExterna = #3#72;              || 150
     IapExterna = IapExterna + 1;    apExterna = #3#33;              || 151
     IapExterna = IapExterna + 1;    apExterna = #3#73;              || 152
     IapExterna = IapExterna + 1;    apExterna = #3#34;              || 153
     IapExterna = IapExterna + 1;    apExterna = #3#74;              || 154
     IapExterna = IapExterna + 1;    apExterna = #3#35;              || 155
     IapExterna = IapExterna + 1;    apExterna = #3#75;              || 156
     IapExterna = IapExterna + 1;    apExterna = #3#36;              || 157
     IapExterna = IapExterna + 1;    apExterna = #3#76;              || 158
     IapExterna = IapExterna + 1;    apExterna = #3#37;              || 159
     IapExterna = IapExterna + 1;    apExterna = #3#77;              || 160
     IapExterna = IapExterna + 1;    apExterna = #3#38;              || 161
     IapExterna = IapExterna + 1;    apExterna = #3#78;              || 162
     IapExterna = IapExterna + 1;    apExterna = #3#39;              || 163
     IapExterna = IapExterna + 1;    apExterna = #3#79;              || 164
     IapExterna = IapExterna + 1;    apExterna = #3#40;              || 165
     IapExterna = IapExterna + 1;    apExterna = #3#80;              || 166
     IapExterna = IapExterna + 1;    apExterna = #3#41;              || 167
     IapExterna = IapExterna + 1;    apExterna = #3#81;              || 168
     IapExterna = IapExterna + 1;    apExterna = #3#42;              || 169
     IapExterna = IapExterna + 1;    apExterna = #3#82;              || 170
     IapExterna = IapExterna + 1;    apExterna = #3#43;              || 171
     IapExterna = IapExterna + 1;    apExterna = #3#83;              || 172
     IapExterna = IapExterna + 1;    apExterna = #3#44;              || 173

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 174
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 175
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 176
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 177
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 178
     IapExterna = IapExterna + 1;    apExterna = #4#44;              || 179
     IapExterna = IapExterna + 1;    apExterna = #4#6;               || 180
     IapExterna = IapExterna + 1;    apExterna = #4#45;              || 181
     IapExterna = IapExterna + 1;    apExterna = #4#7;               || 182
     IapExterna = IapExterna + 1;    apExterna = #4#46;              || 183
     IapExterna = IapExterna + 1;    apExterna = #4#8;               || 184
     IapExterna = IapExterna + 1;    apExterna = #4#52;              || 185
     IapExterna = IapExterna + 1;    apExterna = #4#14;              || 186
     IapExterna = IapExterna + 1;    apExterna = #4#56;              || 187
     IapExterna = IapExterna + 1;    apExterna = #4#18;              || 188
     IapExterna = IapExterna + 1;    apExterna = #4#57;              || 189
     IapExterna = IapExterna + 1;    apExterna = #4#19;              || 190
     IapExterna = IapExterna + 1;    apExterna = #4#59;              || 191
     IapExterna = IapExterna + 1;    apExterna = #4#21;              || 192
     IapExterna = IapExterna + 1;    apExterna = #4#60;              || 193
     IapExterna = IapExterna + 1;    apExterna = #4#22;              || 194
     IapExterna = IapExterna + 1;    apExterna = #4#69;              || 195
     IapExterna = IapExterna + 1;    apExterna = #4#31;              || 196
     IapExterna = IapExterna + 1;    apExterna = #4#70;              || 197
     IapExterna = IapExterna + 1;    apExterna = #4#32;              || 198
     IapExterna = IapExterna + 1;    apExterna = #4#71;              || 199
     IapExterna = IapExterna + 1;    apExterna = #4#33;              || 200
     IapExterna = IapExterna + 1;    apExterna = #4#72;              || 201
     IapExterna = IapExterna + 1;    apExterna = #4#34;              || 202
     IapExterna = IapExterna + 1;    apExterna = #4#73;              || 203
     IapExterna = IapExterna + 1;    apExterna = #4#35;              || 204
     IapExterna = IapExterna + 1;    apExterna = #4#74;              || 205
     IapExterna = IapExterna + 1;    apExterna = #4#36;              || 206
     IapExterna = IapExterna + 1;    apExterna = #4#75;              || 207
     IapExterna = IapExterna + 1;    apExterna = #4#37;              || 208
     IapExterna = IapExterna + 1;    apExterna = #4#76;              || 209
     IapExterna = IapExterna + 1;    apExterna = #4#38;              || 210
     IapExterna = IapExterna + 1;    apExterna = #4#77;              || 211
     IapExterna = IapExterna + 1;    apExterna = #4#39;              || 212
     IapExterna = IapExterna + 1;    apExterna = #4#78;              || 213
     IapExterna = IapExterna + 1;    apExterna = #4#40;              || 214
     IapExterna = IapExterna + 1;    apExterna = #4#79;              || 215
     IapExterna = IapExterna + 1;    apExterna = #4#41;              || 216
     IapExterna = IapExterna + 1;    apExterna = #4#80;              || 217
     IapExterna = IapExterna + 1;    apExterna = #4#42;              || 218
     IapExterna = IapExterna + 1;    apExterna = #4#81;              || 219
     IapExterna = IapExterna + 1;    apExterna = #4#43;              || 220
|FPRC;

|PROCESO Extenso;
     |SI #6#93 = 1;   ptas = "X";  mile = " ";  |FINSI;
     |SI #6#93 = 2;   ptas = " ";  mile = "X";  |FINSI;

     IapExterna = apExterna1 <-;     apExterna = "509";
     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 1
     IapExterna = IapExterna + 1;    apExterna = #6#2;               || 2
     IapExterna = IapExterna + 1;    apExterna = #6#4;               || 3
     IapExterna = IapExterna + 1;    apExterna = #6#5;               || 4
     IapExterna = IapExterna + 1;    apExterna = #6#6;               || 5
     IapExterna = IapExterna + 1;    apExterna = #6#7;               || 6
     IapExterna = IapExterna + 1;    apExterna = #6#8;               || 7
     IapExterna = IapExterna + 1;    apExterna = #6#9;               || 8
     IapExterna = IapExterna + 1;    apExterna = #6#13;              || 9
     IapExterna = IapExterna + 1;    apExterna = #6#14;              || 10
     IapExterna = IapExterna + 1;    apExterna = #6#12;              || 11
     IapExterna = IapExterna + 1;    apExterna = #6#15;              || 12
     IapExterna = IapExterna + 1;    apExterna = #6#19;              || 13
     IapExterna = IapExterna + 1;    apExterna = #6#17;              || 14
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 15
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 16
     IapExterna = IapExterna + 1;    apExterna = #6#86;              || 17
     IapExterna = IapExterna + 1;    apExterna = #6#87;              || 18
     IapExterna = IapExterna + 1;    apExterna = #6#88;              || 19
     IapExterna = IapExterna + 1;    apExterna = #6#89;              || 20
     IapExterna = IapExterna + 1;    apExterna = #6#32 % -104;       || 21
     IapExterna = IapExterna + 1;    apExterna = #6#32 %  402;       || 22
     IapExterna = IapExterna + 1;    apExterna = #6#32 %  102;       || 23
     IapExterna = IapExterna + 1;    apExterna = #6#90;              || 24
     IapExterna = IapExterna + 1;    apExterna = #6#91;              || 25
     IapExterna = IapExterna + 1;    apExterna = #6#92;              || 26
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 27
     IapExterna = IapExterna + 1;    apExterna = mile;               || 28

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 29
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 30
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 31
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 32
     IapExterna = IapExterna + 1;    apExterna = mile;               || 33
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 34
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 35
     IapExterna = IapExterna + 1;    apExterna = #1#70;              || 36
     IapExterna = IapExterna + 1;    apExterna = #1#6;               || 37
     IapExterna = IapExterna + 1;    apExterna = #1#71;              || 38
     IapExterna = IapExterna + 1;    apExterna = #1#7;               || 39
     IapExterna = IapExterna + 1;    apExterna = #1#72;              || 40
     IapExterna = IapExterna + 1;    apExterna = #1#8;               || 41
     IapExterna = IapExterna + 1;    apExterna = #1#73;              || 42
     IapExterna = IapExterna + 1;    apExterna = #1#9;               || 43
     IapExterna = IapExterna + 1;    apExterna = #1#74;              || 44
     IapExterna = IapExterna + 1;    apExterna = #1#10;              || 45
     IapExterna = IapExterna + 1;    apExterna = #1#75;              || 46
     IapExterna = IapExterna + 1;    apExterna = #1#11;              || 47
     IapExterna = IapExterna + 1;    apExterna = #1#76;              || 48
     IapExterna = IapExterna + 1;    apExterna = #1#12;              || 49
     IapExterna = IapExterna + 1;    apExterna = #1#77;              || 50
     IapExterna = IapExterna + 1;    apExterna = #1#13;              || 51
     IapExterna = IapExterna + 1;    apExterna = #1#78;              || 52
     IapExterna = IapExterna + 1;    apExterna = #1#14;              || 53
     IapExterna = IapExterna + 1;    apExterna = #1#79;              || 54
     IapExterna = IapExterna + 1;    apExterna = #1#15;              || 55
     IapExterna = IapExterna + 1;    apExterna = #1#80;              || 56
     IapExterna = IapExterna + 1;    apExterna = #1#16;              || 57
     IapExterna = IapExterna + 1;    apExterna = #1#81;              || 58
     IapExterna = IapExterna + 1;    apExterna = #1#17;              || 59
     IapExterna = IapExterna + 1;    apExterna = #1#82;              || 60
     IapExterna = IapExterna + 1;    apExterna = #1#18;              || 61
     IapExterna = IapExterna + 1;    apExterna = #1#83;              || 62
     IapExterna = IapExterna + 1;    apExterna = #1#19;              || 63
     IapExterna = IapExterna + 1;    apExterna = #1#84;              || 64
     IapExterna = IapExterna + 1;    apExterna = #1#20;              || 65
     IapExterna = IapExterna + 1;    apExterna = #1#85;              || 66
     IapExterna = IapExterna + 1;    apExterna = #1#21;              || 67
     IapExterna = IapExterna + 1;    apExterna = #1#86;              || 68
     IapExterna = IapExterna + 1;    apExterna = #1#22;              || 69
     IapExterna = IapExterna + 1;    apExterna = #1#87;              || 70
     IapExterna = IapExterna + 1;    apExterna = #1#23;              || 71
     IapExterna = IapExterna + 1;    apExterna = #1#88;              || 72
     IapExterna = IapExterna + 1;    apExterna = #1#24;              || 73
     IapExterna = IapExterna + 1;    apExterna = #1#89;              || 74
     IapExterna = IapExterna + 1;    apExterna = #1#25;              || 75
     IapExterna = IapExterna + 1;    apExterna = #1#90;              || 76
     IapExterna = IapExterna + 1;    apExterna = #1#26;              || 77
     IapExterna = IapExterna + 1;    apExterna = #1#91;              || 78
     IapExterna = IapExterna + 1;    apExterna = #1#27;              || 79
     IapExterna = IapExterna + 1;    apExterna = #1#92;              || 80
     IapExterna = IapExterna + 1;    apExterna = #1#28;              || 81
     IapExterna = IapExterna + 1;    apExterna = #1#93;              || 82
     IapExterna = IapExterna + 1;    apExterna = #1#29;              || 83
     IapExterna = IapExterna + 1;    apExterna = #1#94;              || 84
     IapExterna = IapExterna + 1;    apExterna = #1#30;              || 85
     IapExterna = IapExterna + 1;    apExterna = #1#95;              || 86
     IapExterna = IapExterna + 1;    apExterna = #1#31;              || 87
     IapExterna = IapExterna + 1;    apExterna = #1#96;              || 88
     IapExterna = IapExterna + 1;    apExterna = #1#32;              || 89
     IapExterna = IapExterna + 1;    apExterna = #1#97;              || 90
     IapExterna = IapExterna + 1;    apExterna = #1#33;              || 91
     IapExterna = IapExterna + 1;    apExterna = #1#98;              || 92
     IapExterna = IapExterna + 1;    apExterna = #1#34;              || 93
     IapExterna = IapExterna + 1;    apExterna = #1#99;              || 94
     IapExterna = IapExterna + 1;    apExterna = #1#35;              || 95
     IapExterna = IapExterna + 1;    apExterna = #1#135;             || 96
     IapExterna = IapExterna + 1;    apExterna = #1#134;             || 97
     IapExterna = IapExterna + 1;    apExterna = #1#100;             || 98
     IapExterna = IapExterna + 1;    apExterna = #1#36;              || 99
     IapExterna = IapExterna + 1;    apExterna = #1#101;             || 100
     IapExterna = IapExterna + 1;    apExterna = #1#37;              || 101

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 102
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 103
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 104
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 105
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 106
     IapExterna = IapExterna + 1;    apExterna = #1#102;             || 107
     IapExterna = IapExterna + 1;    apExterna = #1#38;              || 108
     IapExterna = IapExterna + 1;    apExterna = #1#103;             || 109
     IapExterna = IapExterna + 1;    apExterna = #1#39;              || 110
     IapExterna = IapExterna + 1;    apExterna = #1#104;             || 111
     IapExterna = IapExterna + 1;    apExterna = #1#40;              || 112
     IapExterna = IapExterna + 1;    apExterna = #1#105;             || 113
     IapExterna = IapExterna + 1;    apExterna = #1#41;              || 114
     IapExterna = IapExterna + 1;    apExterna = #1#106;             || 115
     IapExterna = IapExterna + 1;    apExterna = #1#42;              || 116
     IapExterna = IapExterna + 1;    apExterna = #1#107;             || 117
     IapExterna = IapExterna + 1;    apExterna = #1#43;              || 118
     IapExterna = IapExterna + 1;    apExterna = #1#108;             || 119
     IapExterna = IapExterna + 1;    apExterna = #1#44;              || 120
     IapExterna = IapExterna + 1;    apExterna = #1#109;             || 121
     IapExterna = IapExterna + 1;    apExterna = #1#45;              || 122
     IapExterna = IapExterna + 1;    apExterna = #1#110;             || 123
     IapExterna = IapExterna + 1;    apExterna = #1#46;              || 124
     IapExterna = IapExterna + 1;    apExterna = #1#111;             || 125
     IapExterna = IapExterna + 1;    apExterna = #1#47;              || 126
     IapExterna = IapExterna + 1;    apExterna = #1#112;             || 127
     IapExterna = IapExterna + 1;    apExterna = #1#48;              || 128
     IapExterna = IapExterna + 1;    apExterna = #1#113;             || 129
     IapExterna = IapExterna + 1;    apExterna = #1#49;              || 130
     IapExterna = IapExterna + 1;    apExterna = #1#114;             || 131
     IapExterna = IapExterna + 1;    apExterna = #1#50;              || 132
     IapExterna = IapExterna + 1;    apExterna = #1#115;             || 133
     IapExterna = IapExterna + 1;    apExterna = #1#51;              || 134
     IapExterna = IapExterna + 1;    apExterna = #1#116;             || 135
     IapExterna = IapExterna + 1;    apExterna = #1#52;              || 136
     IapExterna = IapExterna + 1;    apExterna = #1#117;             || 137
     IapExterna = IapExterna + 1;    apExterna = #1#53;              || 138
     IapExterna = IapExterna + 1;    apExterna = #1#118;             || 139
     IapExterna = IapExterna + 1;    apExterna = #1#54;              || 140
     IapExterna = IapExterna + 1;    apExterna = #1#119;             || 141
     IapExterna = IapExterna + 1;    apExterna = #1#55;              || 142
     IapExterna = IapExterna + 1;    apExterna = #1#120;             || 143
     IapExterna = IapExterna + 1;    apExterna = #1#56;              || 144
     IapExterna = IapExterna + 1;    apExterna = #1#121;             || 145
     IapExterna = IapExterna + 1;    apExterna = #1#57;              || 146
     IapExterna = IapExterna + 1;    apExterna = #1#122;             || 147
     IapExterna = IapExterna + 1;    apExterna = #1#58;              || 148
     IapExterna = IapExterna + 1;    apExterna = #1#123;             || 149
     IapExterna = IapExterna + 1;    apExterna = #1#59;              || 150
     IapExterna = IapExterna + 1;    apExterna = #1#124;             || 151
     IapExterna = IapExterna + 1;    apExterna = #1#60;              || 152
     IapExterna = IapExterna + 1;    apExterna = #1#125;             || 153
     IapExterna = IapExterna + 1;    apExterna = #1#61;              || 154
     IapExterna = IapExterna + 1;    apExterna = #1#126;             || 155
     IapExterna = IapExterna + 1;    apExterna = #1#62;              || 156
     IapExterna = IapExterna + 1;    apExterna = #1#127;             || 157
     IapExterna = IapExterna + 1;    apExterna = #1#63;              || 158
     IapExterna = IapExterna + 1;    apExterna = #1#128;             || 159
     IapExterna = IapExterna + 1;    apExterna = #1#64;              || 160
     IapExterna = IapExterna + 1;    apExterna = #1#129;             || 161
     IapExterna = IapExterna + 1;    apExterna = #1#65;              || 162
     IapExterna = IapExterna + 1;    apExterna = #1#130;             || 163
     IapExterna = IapExterna + 1;    apExterna = #1#66;              || 164
     IapExterna = IapExterna + 1;    apExterna = #1#131;             || 165
     IapExterna = IapExterna + 1;    apExterna = #1#67;              || 166
     IapExterna = IapExterna + 1;    apExterna = #1#132;             || 167
     IapExterna = IapExterna + 1;    apExterna = #1#68;              || 168
     IapExterna = IapExterna + 1;    apExterna = #1#133;             || 169
     IapExterna = IapExterna + 1;    apExterna = #1#69;              || 170

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 171
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 172
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 173
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 174
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 175
     IapExterna = IapExterna + 1;    apExterna = #2#79;              || 176
     IapExterna = IapExterna + 1;    apExterna = #2#6;               || 177
     IapExterna = IapExterna + 1;    apExterna = #2#80;              || 178
     IapExterna = IapExterna + 1;    apExterna = #2#7;               || 179
     IapExterna = IapExterna + 1;    apExterna = #2#81;              || 180
     IapExterna = IapExterna + 1;    apExterna = #2#8;               || 181
     IapExterna = IapExterna + 1;    apExterna = #2#82;              || 182
     IapExterna = IapExterna + 1;    apExterna = #2#9;               || 183
     IapExterna = IapExterna + 1;    apExterna = #2#83;              || 184
     IapExterna = IapExterna + 1;    apExterna = #2#10;              || 185
     IapExterna = IapExterna + 1;    apExterna = #2#84;              || 186
     IapExterna = IapExterna + 1;    apExterna = #2#11;              || 187
     IapExterna = IapExterna + 1;    apExterna = #2#85;              || 188
     IapExterna = IapExterna + 1;    apExterna = #2#12;              || 189
     IapExterna = IapExterna + 1;    apExterna = #2#86;              || 190
     IapExterna = IapExterna + 1;    apExterna = #2#13;              || 191
     IapExterna = IapExterna + 1;    apExterna = #2#87;              || 192
     IapExterna = IapExterna + 1;    apExterna = #2#14;              || 193
     IapExterna = IapExterna + 1;    apExterna = #2#156;             || 194
     IapExterna = IapExterna + 1;    apExterna = #2#157;             || 195
     IapExterna = IapExterna + 1;    apExterna = #2#88;              || 196
     IapExterna = IapExterna + 1;    apExterna = #2#15;              || 197
     IapExterna = IapExterna + 1;    apExterna = #2#89;              || 198
     IapExterna = IapExterna + 1;    apExterna = #2#16;              || 199
     IapExterna = IapExterna + 1;    apExterna = #2#90;              || 200
     IapExterna = IapExterna + 1;    apExterna = #2#17;              || 201
     IapExterna = IapExterna + 1;    apExterna = #2#91;              || 202
     IapExterna = IapExterna + 1;    apExterna = #2#18;              || 203
     IapExterna = IapExterna + 1;    apExterna = #2#92;              || 204
     IapExterna = IapExterna + 1;    apExterna = #2#19;              || 205
     IapExterna = IapExterna + 1;    apExterna = #2#93;              || 206
     IapExterna = IapExterna + 1;    apExterna = #2#20;              || 207
     IapExterna = IapExterna + 1;    apExterna = #2#94;              || 208
     IapExterna = IapExterna + 1;    apExterna = #2#21;              || 209
     IapExterna = IapExterna + 1;    apExterna = #2#95;              || 210
     IapExterna = IapExterna + 1;    apExterna = #2#22;              || 211
     IapExterna = IapExterna + 1;    apExterna = #2#96;              || 212
     IapExterna = IapExterna + 1;    apExterna = #2#23;              || 213
     IapExterna = IapExterna + 1;    apExterna = #2#97;              || 214
     IapExterna = IapExterna + 1;    apExterna = #2#24;              || 215
     IapExterna = IapExterna + 1;    apExterna = #2#98;              || 216
     IapExterna = IapExterna + 1;    apExterna = #2#25;              || 217
     IapExterna = IapExterna + 1;    apExterna = #2#99;              || 218
     IapExterna = IapExterna + 1;    apExterna = #2#26;              || 219
     IapExterna = IapExterna + 1;    apExterna = #2#152;             || 220
     IapExterna = IapExterna + 1;    apExterna = #2#153;             || 221
     IapExterna = IapExterna + 1;    apExterna = #2#100;             || 222
     IapExterna = IapExterna + 1;    apExterna = #2#27;              || 223
     IapExterna = IapExterna + 1;    apExterna = #2#101;             || 224
     IapExterna = IapExterna + 1;    apExterna = #2#28;              || 225
     IapExterna = IapExterna + 1;    apExterna = #2#102;             || 226
     IapExterna = IapExterna + 1;    apExterna = #2#29;              || 227
     IapExterna = IapExterna + 1;    apExterna = #2#103;             || 228
     IapExterna = IapExterna + 1;    apExterna = #2#30;              || 229
     IapExterna = IapExterna + 1;    apExterna = #2#104;             || 230
     IapExterna = IapExterna + 1;    apExterna = #2#31;              || 231
     IapExterna = IapExterna + 1;    apExterna = #2#105;             || 232
     IapExterna = IapExterna + 1;    apExterna = #2#32;              || 233
     IapExterna = IapExterna + 1;    apExterna = #2#106;             || 234
     IapExterna = IapExterna + 1;    apExterna = #2#33;              || 235
     IapExterna = IapExterna + 1;    apExterna = #2#107;             || 236
     IapExterna = IapExterna + 1;    apExterna = #2#34;              || 237
     IapExterna = IapExterna + 1;    apExterna = #2#108;             || 238
     IapExterna = IapExterna + 1;    apExterna = #2#35;              || 239
     IapExterna = IapExterna + 1;    apExterna = #2#109;             || 240
     IapExterna = IapExterna + 1;    apExterna = #2#36;              || 241

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 242
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 243
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 244
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 245
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 246
     IapExterna = IapExterna + 1;    apExterna = #2#110;             || 247
     IapExterna = IapExterna + 1;    apExterna = #2#37;              || 248
     IapExterna = IapExterna + 1;    apExterna = #2#111;             || 249
     IapExterna = IapExterna + 1;    apExterna = #2#38;              || 250
     IapExterna = IapExterna + 1;    apExterna = #2#112;             || 251
     IapExterna = IapExterna + 1;    apExterna = #2#39;              || 252
     IapExterna = IapExterna + 1;    apExterna = #2#113;             || 253
     IapExterna = IapExterna + 1;    apExterna = #2#40;              || 254
     IapExterna = IapExterna + 1;    apExterna = #2#114;             || 255
     IapExterna = IapExterna + 1;    apExterna = #2#41;              || 256
     IapExterna = IapExterna + 1;    apExterna = #2#115;             || 257
     IapExterna = IapExterna + 1;    apExterna = #2#42;              || 258
     IapExterna = IapExterna + 1;    apExterna = #2#116;             || 259
     IapExterna = IapExterna + 1;    apExterna = #2#43;              || 260
     IapExterna = IapExterna + 1;    apExterna = #2#117;             || 261
     IapExterna = IapExterna + 1;    apExterna = #2#44;              || 262
     IapExterna = IapExterna + 1;    apExterna = #2#118;             || 263
     IapExterna = IapExterna + 1;    apExterna = #2#45;              || 264
     IapExterna = IapExterna + 1;    apExterna = #2#119;             || 265
     IapExterna = IapExterna + 1;    apExterna = #2#46;              || 266
     IapExterna = IapExterna + 1;    apExterna = #2#154;             || 267
     IapExterna = IapExterna + 1;    apExterna = #2#155;             || 268
     IapExterna = IapExterna + 1;    apExterna = #2#120;             || 269
     IapExterna = IapExterna + 1;    apExterna = #2#47;              || 270
     IapExterna = IapExterna + 1;    apExterna = #2#121;             || 271
     IapExterna = IapExterna + 1;    apExterna = #2#48;              || 272
     IapExterna = IapExterna + 1;    apExterna = #2#122;             || 273
     IapExterna = IapExterna + 1;    apExterna = #2#49;              || 274
     IapExterna = IapExterna + 1;    apExterna = #2#123;             || 275
     IapExterna = IapExterna + 1;    apExterna = #2#50;              || 276
     IapExterna = IapExterna + 1;    apExterna = #2#124;             || 277
     IapExterna = IapExterna + 1;    apExterna = #2#51;              || 278
     IapExterna = IapExterna + 1;    apExterna = #2#125;             || 279
     IapExterna = IapExterna + 1;    apExterna = #2#52;              || 280
     IapExterna = IapExterna + 1;    apExterna = #2#126;             || 281
     IapExterna = IapExterna + 1;    apExterna = #2#53;              || 282
     IapExterna = IapExterna + 1;    apExterna = #2#127;             || 283
     IapExterna = IapExterna + 1;    apExterna = #2#54;              || 284
     IapExterna = IapExterna + 1;    apExterna = #2#128;             || 285
     IapExterna = IapExterna + 1;    apExterna = #2#55;              || 286
     IapExterna = IapExterna + 1;    apExterna = #2#129;             || 287
     IapExterna = IapExterna + 1;    apExterna = #2#56;              || 288
     IapExterna = IapExterna + 1;    apExterna = #2#130;             || 289
     IapExterna = IapExterna + 1;    apExterna = #2#57;              || 290
     IapExterna = IapExterna + 1;    apExterna = #2#131;             || 291
     IapExterna = IapExterna + 1;    apExterna = #2#58;              || 292
     IapExterna = IapExterna + 1;    apExterna = #2#132;             || 293
     IapExterna = IapExterna + 1;    apExterna = #2#59;              || 294
     IapExterna = IapExterna + 1;    apExterna = #2#133;             || 295
     IapExterna = IapExterna + 1;    apExterna = #2#60;              || 296
     IapExterna = IapExterna + 1;    apExterna = #2#134;             || 297
     IapExterna = IapExterna + 1;    apExterna = #2#61;              || 298
     IapExterna = IapExterna + 1;    apExterna = #2#135;             || 299
     IapExterna = IapExterna + 1;    apExterna = #2#62;              || 300
     IapExterna = IapExterna + 1;    apExterna = #2#136;             || 301
     IapExterna = IapExterna + 1;    apExterna = #2#63;              || 302
     IapExterna = IapExterna + 1;    apExterna = #2#137;             || 303
     IapExterna = IapExterna + 1;    apExterna = #2#64;              || 304

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 305
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 306
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 307
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 308
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 309
     IapExterna = IapExterna + 1;    apExterna = #2#138;             || 310
     IapExterna = IapExterna + 1;    apExterna = #2#65;              || 311
     IapExterna = IapExterna + 1;    apExterna = #2#139;             || 312
     IapExterna = IapExterna + 1;    apExterna = #2#66;              || 313
     IapExterna = IapExterna + 1;    apExterna = #2#140;             || 314
     IapExterna = IapExterna + 1;    apExterna = #2#67;              || 315
     IapExterna = IapExterna + 1;    apExterna = #2#141;             || 316
     IapExterna = IapExterna + 1;    apExterna = #2#68;              || 317
     IapExterna = IapExterna + 1;    apExterna = #2#142;             || 318
     IapExterna = IapExterna + 1;    apExterna = #2#69;              || 319
     IapExterna = IapExterna + 1;    apExterna = #2#143;             || 320
     IapExterna = IapExterna + 1;    apExterna = #2#70;              || 321
     IapExterna = IapExterna + 1;    apExterna = #2#144;             || 322
     IapExterna = IapExterna + 1;    apExterna = #2#71;              || 323
     IapExterna = IapExterna + 1;    apExterna = #2#145;             || 324
     IapExterna = IapExterna + 1;    apExterna = #2#72;              || 325
     IapExterna = IapExterna + 1;    apExterna = #2#146;             || 326
     IapExterna = IapExterna + 1;    apExterna = #2#73;              || 327
     IapExterna = IapExterna + 1;    apExterna = #2#147;             || 328
     IapExterna = IapExterna + 1;    apExterna = #2#74;              || 329
     IapExterna = IapExterna + 1;    apExterna = #2#148;             || 330
     IapExterna = IapExterna + 1;    apExterna = #2#75;              || 331
     IapExterna = IapExterna + 1;    apExterna = #2#149;             || 332
     IapExterna = IapExterna + 1;    apExterna = #2#76;              || 333
     IapExterna = IapExterna + 1;    apExterna = #2#150;             || 334
     IapExterna = IapExterna + 1;    apExterna = #2#77;              || 335
     IapExterna = IapExterna + 1;    apExterna = #2#151;             || 336
     IapExterna = IapExterna + 1;    apExterna = #2#78;              || 337

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 338
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 339
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 340
     IapExterna = IapExterna + 1;    apExterna = ptas;               || 341
     IapExterna = IapExterna + 1;    apExterna = mile;               || 342
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 343
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 344
     IapExterna = IapExterna + 1;    apExterna = #3#45;              || 345
     IapExterna = IapExterna + 1;    apExterna = #3#6;               || 346
     IapExterna = IapExterna + 1;    apExterna = #3#46;              || 347
     IapExterna = IapExterna + 1;    apExterna = #3#7;               || 348
     IapExterna = IapExterna + 1;    apExterna = #3#47;              || 349
     IapExterna = IapExterna + 1;    apExterna = #3#8;               || 350
     IapExterna = IapExterna + 1;    apExterna = #3#48;              || 351
     IapExterna = IapExterna + 1;    apExterna = #3#9;               || 352
     IapExterna = IapExterna + 1;    apExterna = #3#49;              || 353
     IapExterna = IapExterna + 1;    apExterna = #3#10;              || 354
     IapExterna = IapExterna + 1;    apExterna = #3#50;              || 355
     IapExterna = IapExterna + 1;    apExterna = #3#11;              || 356
     IapExterna = IapExterna + 1;    apExterna = #3#51;              || 357
     IapExterna = IapExterna + 1;    apExterna = #3#12;              || 358
     IapExterna = IapExterna + 1;    apExterna = #3#52;              || 359
     IapExterna = IapExterna + 1;    apExterna = #3#13;              || 360
     IapExterna = IapExterna + 1;    apExterna = #3#53;              || 361
     IapExterna = IapExterna + 1;    apExterna = #3#14;              || 362
     IapExterna = IapExterna + 1;    apExterna = #3#54;              || 363
     IapExterna = IapExterna + 1;    apExterna = #3#15;              || 364
     IapExterna = IapExterna + 1;    apExterna = #3#55;              || 365
     IapExterna = IapExterna + 1;    apExterna = #3#16;              || 366
     IapExterna = IapExterna + 1;    apExterna = #3#56;              || 367
     IapExterna = IapExterna + 1;    apExterna = #3#17;              || 368
     IapExterna = IapExterna + 1;    apExterna = #3#57;              || 369
     IapExterna = IapExterna + 1;    apExterna = #3#18;              || 370
     IapExterna = IapExterna + 1;    apExterna = #3#58;              || 371
     IapExterna = IapExterna + 1;    apExterna = #3#19;              || 372
     IapExterna = IapExterna + 1;    apExterna = #3#59;              || 373
     IapExterna = IapExterna + 1;    apExterna = #3#20;              || 374
     IapExterna = IapExterna + 1;    apExterna = #3#60;              || 375
     IapExterna = IapExterna + 1;    apExterna = #3#21;              || 376
     IapExterna = IapExterna + 1;    apExterna = #3#61;              || 377
     IapExterna = IapExterna + 1;    apExterna = #3#22;              || 378
     IapExterna = IapExterna + 1;    apExterna = #3#62;              || 379
     IapExterna = IapExterna + 1;    apExterna = #3#23;              || 380
     IapExterna = IapExterna + 1;    apExterna = #3#63;              || 381
     IapExterna = IapExterna + 1;    apExterna = #3#24;              || 382
     IapExterna = IapExterna + 1;    apExterna = #3#64;              || 383
     IapExterna = IapExterna + 1;    apExterna = #3#25;              || 384
     IapExterna = IapExterna + 1;    apExterna = #3#65;              || 385
     IapExterna = IapExterna + 1;    apExterna = #3#26;              || 386
     IapExterna = IapExterna + 1;    apExterna = #3#66;              || 387
     IapExterna = IapExterna + 1;    apExterna = #3#27;              || 388
     IapExterna = IapExterna + 1;    apExterna = #3#67;              || 389
     IapExterna = IapExterna + 1;    apExterna = #3#28;              || 390
     IapExterna = IapExterna + 1;    apExterna = #3#68;              || 391
     IapExterna = IapExterna + 1;    apExterna = #3#29;              || 392
     IapExterna = IapExterna + 1;    apExterna = #3#69;              || 393
     IapExterna = IapExterna + 1;    apExterna = #3#30;              || 394
     IapExterna = IapExterna + 1;    apExterna = #3#70;              || 395
     IapExterna = IapExterna + 1;    apExterna = #3#31;              || 396
     IapExterna = IapExterna + 1;    apExterna = #3#71;              || 397
     IapExterna = IapExterna + 1;    apExterna = #3#32;              || 398
     IapExterna = IapExterna + 1;    apExterna = #3#72;              || 399
     IapExterna = IapExterna + 1;    apExterna = #3#33;              || 400

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 401
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 402
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 403
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 404
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 405
     IapExterna = IapExterna + 1;    apExterna = #3#73;              || 406
     IapExterna = IapExterna + 1;    apExterna = #3#34;              || 407
     IapExterna = IapExterna + 1;    apExterna = #3#74;              || 408
     IapExterna = IapExterna + 1;    apExterna = #3#35;              || 409
     IapExterna = IapExterna + 1;    apExterna = #3#75;              || 410
     IapExterna = IapExterna + 1;    apExterna = #3#36;              || 411
     IapExterna = IapExterna + 1;    apExterna = #3#76;              || 412
     IapExterna = IapExterna + 1;    apExterna = #3#37;              || 413
     IapExterna = IapExterna + 1;    apExterna = #3#77;              || 414
     IapExterna = IapExterna + 1;    apExterna = #3#38;              || 415
     IapExterna = IapExterna + 1;    apExterna = #3#78;              || 416
     IapExterna = IapExterna + 1;    apExterna = #3#39;              || 417
     IapExterna = IapExterna + 1;    apExterna = #3#79;              || 418
     IapExterna = IapExterna + 1;    apExterna = #3#40;              || 419
     IapExterna = IapExterna + 1;    apExterna = #3#80;              || 420
     IapExterna = IapExterna + 1;    apExterna = #3#41;              || 421
     IapExterna = IapExterna + 1;    apExterna = #3#81;              || 422
     IapExterna = IapExterna + 1;    apExterna = #3#42;              || 423
     IapExterna = IapExterna + 1;    apExterna = #3#82;              || 424
     IapExterna = IapExterna + 1;    apExterna = #3#43;              || 425
     IapExterna = IapExterna + 1;    apExterna = #3#83;              || 426
     IapExterna = IapExterna + 1;    apExterna = #3#44;              || 427

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 428
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 429
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 430
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 431
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 432
     IapExterna = IapExterna + 1;    apExterna = #4#44;              || 433
     IapExterna = IapExterna + 1;    apExterna = #4#6;               || 434
     IapExterna = IapExterna + 1;    apExterna = #4#46;              || 435
     IapExterna = IapExterna + 1;    apExterna = #4#8;               || 436
     IapExterna = IapExterna + 1;    apExterna = #4#47;              || 437
     IapExterna = IapExterna + 1;    apExterna = #4#9;               || 438
     IapExterna = IapExterna + 1;    apExterna = #4#48;              || 439
     IapExterna = IapExterna + 1;    apExterna = #4#10;              || 440
     IapExterna = IapExterna + 1;    apExterna = #4#49;              || 441
     IapExterna = IapExterna + 1;    apExterna = #4#11;              || 442
     IapExterna = IapExterna + 1;    apExterna = #4#50;              || 443
     IapExterna = IapExterna + 1;    apExterna = #4#12;              || 444
     IapExterna = IapExterna + 1;    apExterna = #4#51;              || 445
     IapExterna = IapExterna + 1;    apExterna = #4#13;              || 446
     IapExterna = IapExterna + 1;    apExterna = #4#52;              || 447
     IapExterna = IapExterna + 1;    apExterna = #4#14;              || 448
     IapExterna = IapExterna + 1;    apExterna = #4#53;              || 449
     IapExterna = IapExterna + 1;    apExterna = #4#15;              || 450
     IapExterna = IapExterna + 1;    apExterna = #4#54;              || 451
     IapExterna = IapExterna + 1;    apExterna = #4#16;              || 452
     IapExterna = IapExterna + 1;    apExterna = #4#55;              || 453
     IapExterna = IapExterna + 1;    apExterna = #4#17;              || 454
     IapExterna = IapExterna + 1;    apExterna = #4#56;              || 455
     IapExterna = IapExterna + 1;    apExterna = #4#18;              || 456
     IapExterna = IapExterna + 1;    apExterna = #4#58;              || 457
     IapExterna = IapExterna + 1;    apExterna = #4#20;              || 458
     IapExterna = IapExterna + 1;    apExterna = #4#59;              || 459
     IapExterna = IapExterna + 1;    apExterna = #4#21;              || 460
     IapExterna = IapExterna + 1;    apExterna = #4#60;              || 461
     IapExterna = IapExterna + 1;    apExterna = #4#22;              || 462
     IapExterna = IapExterna + 1;    apExterna = #4#61;              || 463
     IapExterna = IapExterna + 1;    apExterna = #4#23;              || 464
     IapExterna = IapExterna + 1;    apExterna = #4#62;              || 465
     IapExterna = IapExterna + 1;    apExterna = #4#24;              || 466
     IapExterna = IapExterna + 1;    apExterna = #4#63;              || 467
     IapExterna = IapExterna + 1;    apExterna = #4#25;              || 468
     IapExterna = IapExterna + 1;    apExterna = #4#64;              || 469
     IapExterna = IapExterna + 1;    apExterna = #4#26;              || 470
     IapExterna = IapExterna + 1;    apExterna = #4#65;              || 471
     IapExterna = IapExterna + 1;    apExterna = #4#27;              || 472
     IapExterna = IapExterna + 1;    apExterna = #4#66;              || 473
     IapExterna = IapExterna + 1;    apExterna = #4#28;              || 474
     IapExterna = IapExterna + 1;    apExterna = #4#67;              || 475
     IapExterna = IapExterna + 1;    apExterna = #4#29;              || 476
     IapExterna = IapExterna + 1;    apExterna = #4#68;              || 477
     IapExterna = IapExterna + 1;    apExterna = #4#30;              || 478
     IapExterna = IapExterna + 1;    apExterna = #4#69;              || 479
     IapExterna = IapExterna + 1;    apExterna = #4#31;              || 480
     IapExterna = IapExterna + 1;    apExterna = #4#70;              || 481
     IapExterna = IapExterna + 1;    apExterna = #4#32;              || 482
     IapExterna = IapExterna + 1;    apExterna = #4#71;              || 483
     IapExterna = IapExterna + 1;    apExterna = #4#33;              || 484
     IapExterna = IapExterna + 1;    apExterna = #4#72;              || 485
     IapExterna = IapExterna + 1;    apExterna = #4#34;              || 486

     IapExterna = IapExterna + 1;    apExterna = #6#3;               || 487
     IapExterna = IapExterna + 1;    apExterna = #1#2 % 120;         || 488
     IapExterna = IapExterna + 1;    apExterna = #1#2 % -120;        || 489
     IapExterna = IapExterna + 1;    apExterna = ejer1;              || 490
     IapExterna = IapExterna + 1;    apExterna = ejer2;              || 491
     IapExterna = IapExterna + 1;    apExterna = #4#73;              || 492
     IapExterna = IapExterna + 1;    apExterna = #4#35;              || 493
     IapExterna = IapExterna + 1;    apExterna = #4#74;              || 494
     IapExterna = IapExterna + 1;    apExterna = #4#36;              || 495
     IapExterna = IapExterna + 1;    apExterna = #4#75;              || 496
     IapExterna = IapExterna + 1;    apExterna = #4#37;              || 497
     IapExterna = IapExterna + 1;    apExterna = #4#76;              || 498
     IapExterna = IapExterna + 1;    apExterna = #4#38;              || 499
     IapExterna = IapExterna + 1;    apExterna = #4#77;              || 500
     IapExterna = IapExterna + 1;    apExterna = #4#39;              || 501
     IapExterna = IapExterna + 1;    apExterna = #4#78;              || 502
     IapExterna = IapExterna + 1;    apExterna = #4#40;              || 503
     IapExterna = IapExterna + 1;    apExterna = #4#79;              || 504
     IapExterna = IapExterna + 1;    apExterna = #4#41;              || 505
     IapExterna = IapExterna + 1;    apExterna = #4#80;              || 506
     IapExterna = IapExterna + 1;    apExterna = #4#42;              || 507
     IapExterna = IapExterna + 1;    apExterna = #4#81;              || 508
     IapExterna = IapExterna + 1;    apExterna = #4#43;              || 509
|FPRC;

|PROCESO AsignaAbreviado;
     IapExterna = apExterna1 <-;
     nTCampos   = apExterna;
     |ATRI S;

     |PARA nCampos = 1; |SI nCampos [ nTCampos;  |HACIENDO nCampos = nCampos + 1;
           IapExterna = IapExterna + 1;
           aCampos    = "#" + nCampos;
           aAlfa      = apExterna;
           |SI aAlfa  = "0";  aAlfa = " ";  |FINSI;

           |SI nCampos ] 36;  |Y nCampos [ 71;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 77;  |Y nCampos [ 110;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 118;  |Y nCampos [ 173;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 179;  |Y nCampos [ 220;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;

           |WORD_ASIGNA_CAMPO nWord, aCampos, aAlfa;

           aAlfa      = "           Campo : " + aCampos;
           |PINTA 1420, aAlfa;
     |SIGUE;
     |ATRI s;
|FPRC;

|PROCESO AsignaExtenso;
     IapExterna = apExterna1 <-;
     nTCampos   = apExterna;
     |ATRI S;

     |PARA nCampos = 1; |SI nCampos [ nTCampos;  |HACIENDO nCampos = nCampos + 1;
           IapExterna = IapExterna + 1;
           aCampos    = "#" + nCampos;
           aAlfa      = apExterna;
           |SI aAlfa  = "0";  aAlfa = " ";  |FINSI;

           |SI nCampos ] 36;  |Y nCampos [ 101;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 107;  |Y nCampos [ 170;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 176;  |Y nCampos [ 241;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 247;  |Y nCampos [ 304;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 310;  |Y nCampos [ 337;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 345;  |Y nCampos [ 400;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 406;  |Y nCampos [ 427;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 433;  |Y nCampos [ 486;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;
           |SI nCampos ] 492;  |Y nCampos [ 509;
               eaImporte = aAlfa; |HAZ Importe; aAlfa = eaImporte;
           |FINSI;

           |WORD_ASIGNA_CAMPO nWord, aCampos, aAlfa;

           aAlfa      = "           Campo : " + aCampos;
           |PINTA 1420, aAlfa;
     |SIGUE;
     |ATRI s;
|FPRC;

|PROCESO AsignaCuentas;
     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;
     nWord = 1;

     |SI #5#5 = "A";
         |SI eaMoneda = "PESETAS";
             aOrigen   = aBase + "word/cuentas/ccuenta.doc";
         |SINO;
             aOrigen   = aBase + "word/cuentas/ccuenea.doc";
         |FINSI;
     |SINO;
         |SI eaMoneda = "PESETAS";
             aOrigen   = aBase + "word/cuentas/ccuente.doc";
         |SINO;
             aOrigen   = aBase + "word/cuentas/ccuenee.doc";
         |FINSI;
     |FINSI;

     aDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/wcuenta.doc";

     eaOrigen  = aOrigen;
     eaDestino = aDestino;
     |HAZ EnviaFichero;

     |PUSHV 0501 2380;

     |ATRI S;  |PINTA 1220, "ASIGNANDO CAMPOS AL DOCUMENTO WCUENTA.DOC"; |ATRI s;

     eaAlfa = "Abro el documento " + aDestino;
     |HAZ GeneraLog;

     |WORD_ABRE nWord, aDestino;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     eaAlfa = "Asigno variables en el documento";
     |HAZ GeneraLog;

     |SI #5#5 = "A";
         |HAZ AsignaAbreviado;
     |SINO;
         |HAZ AsignaExtenso;
     |FINSI;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;

     eaOrigen   = eaUnidadBasico + "/MODELOS/MEMORIAS/wcuenta.doc";
     eaDestino  = aBase + "emisiones/" + aEmpresa + "/" + aAnyo;  |MKDIR eaDestino;
     eaDestino  = eaDestino + "/" + "wcuenta.doc"
     |HAZ RecibeFichero;

     |RFBORRA eaOrigen;

     eaAlfa = "Borro el documento " + eaOrigen;
     |HAZ GeneraLog;

     |ABRE #500;
     #500#0 = nEmpresa;
     #500#1 = nAnyo;
     |LEE 101#500=;
     |SI FSalida ! 0;
         #500#0 = nEmpresa;
         #500#1 = nAnyo;
         #500#2 = #6#2;
         |GRABA 020#500n;
     |FINSI;
     |LIBERA #500;
     |CIERRA #500;

     |ABRE #501;
     #501#0 = nEmpresa;
     #501#1 = nAnyo;
     #501#2 = "wcuenta.doc";
     |LEE 101#501=;
     |SI FSalida ! 0;
         #501#0 = nEmpresa;
         #501#1 = nAnyo;
         #501#2 = "wcuenta.doc";
         |GRABA 020#501b;
     |FINSI;
     #501#3 = "CUENTAS ANUALES";
     #501#4 = ~;
     |HORA aHora;
     #501#5 = aHora % 102;
     #501#6 = aHora % 402;
     |GRABA 020#501a;
     |LIBERA #501;
     |CIERRA #501;

     |POPV;
|FPRC;

|PROCESO LecturaNormal;
     |ABRE #6;
     #6#0 = #5#0;
     #6#1 = #5#1;
     |LEE 040#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
     |CIERRA #6;

     |PINPA #0#99;
     aAlfa = "Empresa : " + #6#2;  |QBF aAlfa;
     aAlfa = aAlfa + " Ejercicio : " + #6#1;

     |ATRI S;  |PINTA 0812, aAlfa;                       |ATRI s;
     |ATRI P;  |PINTA 1926, "GENERANDOSE LAS CUENTAS ANUALES";    |ATRI p;

     nNumero   = #5#1 - 1;
     ejer1     = #5#1;
     ejer2     = nNumero;

     |ABRE #1; #1#0 = #5#0; #1#1 = #5#1; |LEE 040#1=;
     |SI FSalida ! 0; |DDEFECTO #1; |FINSI;
     |CIERRA #1;

     |ABRE #2; #2#0 = #5#0; #2#1 = #5#1; |LEE 040#2=;
     |SI FSalida ! 0; |DDEFECTO #2; |FINSI;
     |CIERRA #2;

     |ABRE #3; #3#0 = #5#0; #3#1 = #5#1; |LEE 040#3=;
     |SI FSalida ! 0; |DDEFECTO #3; |FINSI;
     |CIERRA #3;

     |ABRE #4; #4#0 = #5#0; #4#1 = #5#1; |LEE 040#4=;
     |SI FSalida ! 0; |DDEFECTO #4; |FINSI;
     |CIERRA #4;

     |SI #6#93 = 2;
         |PARA nCampo = 6; |SI nCampo [ 135; |HACIENDO nCampo = nCampo + 1;
               #1nCampo = #1nCampo / 1000;
         |SIGUE;
         |PARA nCampo = 6; |SI nCampo [ 157; |HACIENDO nCampo = nCampo + 1;
               #2nCampo = #2nCampo / 1000;
         |SIGUE;
         |PARA nCampo = 6; |SI nCampo [ 83; |HACIENDO nCampo = nCampo + 1;
               #3nCampo = #3nCampo / 1000;
         |SIGUE;
         |PARA nCampo = 6; |SI nCampo [ 81; |HACIENDO nCampo = nCampo + 1;
               #4nCampo = #4nCampo / 1000;
        |SIGUE;
     |FINSI;

     |SI #5#5 = "A";
         |HAZ Abreviado;
     |SINO;
         |HAZ Extenso;
     |FINSI;

     |HAZ AsignaCuentas;
|FPRC;

|PROCESO AsignaTexto;
     |SI nRepite = 0;
         |PARA;  |SI;  |HACIENDO;
              |WORD_ASIGNA_TEXTO nWord, aIdenti, eaAlfa;
              |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |SINO;
         |WORD_ASIGNA_TEXTO nWord, aIdenti, eaAlfa;
     |FINSI;

     nCampoT    = nCampoT + 1;
     aAlfa      = "           Campo : " + nCampoT;
     |PINTA 1420, aAlfa;
|FPRC;

|PROCESO DatosPortada;
     nRepite = 0;

     eaAlfa = #6#3;  |HAZ QuitaRaros;
     aIdenti = "!#NIF#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#2 % 120;  |HAZ QuitaRaros;
     aIdenti = "!#DENO1#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#2 % 2120;  |HAZ QuitaRaros;
     aIdenti = "!#DENO2#";
     |HAZ AsignaTexto;

     eaAlfa  = ejer1;
     aIdenti = "!#EJER1#";
     |HAZ AsignaTexto;

     eaAlfa  = ejer2;
     aIdenti = "!#EJER2#";
     |HAZ AsignaTexto;

     |SI #6#93 = 1;
         eaAlfa  = "X";   aIdenti = "!#E1#";   |HAZ AsignaTexto;
         eaAlfa  = " ";   aIdenti = "!#E2#";   |HAZ AsignaTexto;
     |FINSI;

     |SI #6#93 = 2;
         eaAlfa  = "X";   aIdenti = "!#E2#";   |HAZ AsignaTexto;
         eaAlfa  = " ";   aIdenti = "!#E1#";   |HAZ AsignaTexto;
     |FINSI;

     nRepite = 1;

     eaAlfa  = #6#2;  |HAZ QuitaRaros;
     aIdenti = "!#DENOMINACION#";
     |HAZ AsignaTexto;

     eaAlfa  = #5#11;        |HAZ QuitaRaros;
     aIdenti = "!#INSCRIPCION#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#4;  |QBF eaAlfa;
     |SI eaAlfa ! "";  eaAlfa = eaAlfa + " ";  |FINSI;

     eaAlfa  = eaAlfa + #6#5;  |QBF eaAlfa;

     |SI #6#6 ! "    ";  eaAlfa = eaAlfa + ", " + #6#6;  |FINSI;
     |QBF eaAlfa;

     |SI #6#7 ! "   ";  eaAlfa = eaAlfa + " " + #6#7;  |FINSI;
     |QBF eaAlfa;

     |SI #6#8 ! "  ";  eaAlfa = eaAlfa + " " + #6#8;  |FINSI;
     |QBF eaAlfa;

     |SI #6#9 ! "  ";  eaAlfa = eaAlfa + " " + #6#9;  |FINSI;
     |QBF eaAlfa;

     |HAZ QuitaRaros;
     aIdenti = "!#DOMICILIO#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#13;        |HAZ QuitaRaros;
     aIdenti = "!#MUNICIPIO#";
     |HAZ AsignaTexto;

     eaAlfa  = (("00" + #6#10) % -102) + (("000" + #6#11) % -103);
     aIdenti = "!#CODPOS#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#14;        |HAZ QuitaRaros;
     aIdenti = "!#PROVINCIA#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#15;
     aIdenti = "!#TELEFONO#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#19;        |HAZ QuitaRaros;
     aIdenti = "!#ACTIVIDAD#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#17;        |HAZ QuitaRaros;
     aIdenti = "!#CNAE#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#86;
     aIdenti = "!#FIJO1#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#87;
     aIdenti = "!#FIJO2#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#88;
     aIdenti = "!#NOFIJO1#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#89;
     aIdenti = "!#NOFIJO2#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#32 % -104;
     aIdenti = "!#ANYO#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#32 % 402;
     aIdenti = "!#MES#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#32 % 102;
     aIdenti = "!#DIA#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#90;
     aIdenti = "!#PG#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#91;        |HAZ QuitaRaros;
     aIdenti = "!#CAUSA1#";
     |HAZ AsignaTexto;

     eaAlfa  = #6#92;        |HAZ QuitaRaros;
     aIdenti = "!#CAUSA2#";
     |HAZ AsignaTexto;

|FPRC;

|PROCESO AsignaCuenta;
     |SI nFichero = 22;  eaImporte = #22nCampo;   |FINSI;
     |SI nFichero = 23;  eaImporte = #23nCampo;   |FINSI;
     |SI nFichero = 24;  eaImporte = #24nCampo;   |FINSI;
     |SI nFichero = 25;  eaImporte = #25nCampo;   |FINSI;

     nRepite = 1;

     |HAZ Importe;
     eaAlfa  = eaImporte;
     aIdenti = "!#" + aTipo + nCampo + "#";
     |HAZ AsignaTexto;
|FPRC;

|PROCESO AbreviadoCooperativa;
     |HAZ DatosPortada;

     aTipo    = "A";
     nFichero = 22;

     nCampo   = 6;      |HAZ AsignaCuenta;
     nCampo   = 7;      |HAZ AsignaCuenta;
     nCampo   = 8;      |HAZ AsignaCuenta;
     nCampo   = 9;      |HAZ AsignaCuenta;
     nCampo   = 18;     |HAZ AsignaCuenta;
     nCampo   = 26;     |HAZ AsignaCuenta;
     nCampo   = 29;     |HAZ AsignaCuenta;
     nCampo   = 34;     |HAZ AsignaCuenta;
     nCampo   = 37;     |HAZ AsignaCuenta;
     nCampo   = 38;     |HAZ AsignaCuenta;
     nCampo   = 39;     |HAZ AsignaCuenta;
     nCampo   = 40;     |HAZ AsignaCuenta;
     nCampo   = 48;     |HAZ AsignaCuenta;
     nCampo   = 53;     |HAZ AsignaCuenta;
     nCampo   = 54;     |HAZ AsignaCuenta;
     nCampo   = 58;     |HAZ AsignaCuenta;
     nCampo   = 61;     |HAZ AsignaCuenta;
     nCampo   = 66;     |HAZ AsignaCuenta;
     nCampo   = 69;     |HAZ AsignaCuenta;
     nCampo   = 70;     |HAZ AsignaCuenta;
     nCampo   = 71;     |HAZ AsignaCuenta;

     nCampo   = 72;     |HAZ AsignaCuenta;
     nCampo   = 73;     |HAZ AsignaCuenta;
     nCampo   = 74;     |HAZ AsignaCuenta;
     nCampo   = 75;     |HAZ AsignaCuenta;
     nCampo   = 84;     |HAZ AsignaCuenta;
     nCampo   = 92;     |HAZ AsignaCuenta;
     nCampo   = 95;     |HAZ AsignaCuenta;
     nCampo   = 100;    |HAZ AsignaCuenta;
     nCampo   = 103;    |HAZ AsignaCuenta;
     nCampo   = 104;    |HAZ AsignaCuenta;
     nCampo   = 105;    |HAZ AsignaCuenta;
     nCampo   = 106;    |HAZ AsignaCuenta;
     nCampo   = 114;    |HAZ AsignaCuenta;
     nCampo   = 119;    |HAZ AsignaCuenta;
     nCampo   = 120;    |HAZ AsignaCuenta;
     nCampo   = 124;    |HAZ AsignaCuenta;
     nCampo   = 127;    |HAZ AsignaCuenta;
     nCampo   = 132;    |HAZ AsignaCuenta;
     nCampo   = 135;    |HAZ AsignaCuenta;
     nCampo   = 136;    |HAZ AsignaCuenta;
     nCampo   = 137;    |HAZ AsignaCuenta;

     aTipo    = "P";
     nFichero = 23;

     nCampo   = 6;      |HAZ AsignaCuenta;
     nCampo   = 7;      |HAZ AsignaCuenta;
     nCampo   = 8;      |HAZ AsignaCuenta;
     nCampo   = 9;      |HAZ AsignaCuenta;
     nCampo   = 10;     |HAZ AsignaCuenta;
     nCampo   = 11;     |HAZ AsignaCuenta;
     nCampo   = 13;     |HAZ AsignaCuenta;
     nCampo   = 14;     |HAZ AsignaCuenta;
     nCampo   = 18;     |HAZ AsignaCuenta;
     nCampo   = 19;     |HAZ AsignaCuenta;
     nCampo   = 20;     |HAZ AsignaCuenta;
     nCampo   = 21;     |HAZ AsignaCuenta;
     nCampo   = 25;     |HAZ AsignaCuenta;
     nCampo   = 26;     |HAZ AsignaCuenta;
     nCampo   = 31;     |HAZ AsignaCuenta;
     nCampo   = 32;     |HAZ AsignaCuenta;
     nCampo   = 42;     |HAZ AsignaCuenta;
     nCampo   = 45;     |HAZ AsignaCuenta;
     nCampo   = 51;     |HAZ AsignaCuenta;
     nCampo   = 52;     |HAZ AsignaCuenta;
     nCampo   = 65;     |HAZ AsignaCuenta;
     nCampo   = 73;     |HAZ AsignaCuenta;
     nCampo   = 78;     |HAZ AsignaCuenta;

     nCampo   = 79;     |HAZ AsignaCuenta;
     nCampo   = 80;     |HAZ AsignaCuenta;
     nCampo   = 81;     |HAZ AsignaCuenta;
     nCampo   = 82;     |HAZ AsignaCuenta;
     nCampo   = 83;     |HAZ AsignaCuenta;
     nCampo   = 84;     |HAZ AsignaCuenta;
     nCampo   = 86;     |HAZ AsignaCuenta;
     nCampo   = 87;     |HAZ AsignaCuenta;
     nCampo   = 91;     |HAZ AsignaCuenta;
     nCampo   = 92;     |HAZ AsignaCuenta;
     nCampo   = 93;     |HAZ AsignaCuenta;
     nCampo   = 94;     |HAZ AsignaCuenta;
     nCampo   = 98;     |HAZ AsignaCuenta;
     nCampo   = 99;     |HAZ AsignaCuenta;
     nCampo   = 104;    |HAZ AsignaCuenta;
     nCampo   = 105;    |HAZ AsignaCuenta;
     nCampo   = 115;    |HAZ AsignaCuenta;
     nCampo   = 118;    |HAZ AsignaCuenta;
     nCampo   = 124;    |HAZ AsignaCuenta;
     nCampo   = 125;    |HAZ AsignaCuenta;
     nCampo   = 138;    |HAZ AsignaCuenta;
     nCampo   = 146;    |HAZ AsignaCuenta;
     nCampo   = 151;    |HAZ AsignaCuenta;

     aTipo    = "D";
     nFichero = 24;

     nCampo   = 6;      |HAZ AsignaCuenta;
     nCampo   = 7;      |HAZ AsignaCuenta;
     nCampo   = 12;     |HAZ AsignaCuenta;
     nCampo   = 13;     |HAZ AsignaCuenta;
     nCampo   = 14;     |HAZ AsignaCuenta;
     nCampo   = 15;     |HAZ AsignaCuenta;
     nCampo   = 18;     |HAZ AsignaCuenta;
     nCampo   = 19;     |HAZ AsignaCuenta;
     nCampo   = 23;     |HAZ AsignaCuenta;
     nCampo   = 28;     |HAZ AsignaCuenta;
     nCampo   = 29;     |HAZ AsignaCuenta;
     nCampo   = 30;     |HAZ AsignaCuenta;
     nCampo   = 31;     |HAZ AsignaCuenta;
     nCampo   = 32;     |HAZ AsignaCuenta;
     nCampo   = 33;     |HAZ AsignaCuenta;
     nCampo   = 34;     |HAZ AsignaCuenta;
     nCampo   = 35;     |HAZ AsignaCuenta;
     nCampo   = 36;     |HAZ AsignaCuenta;
     nCampo   = 37;     |HAZ AsignaCuenta;
     nCampo   = 38;     |HAZ AsignaCuenta;
     nCampo   = 39;     |HAZ AsignaCuenta;
     nCampo   = 40;     |HAZ AsignaCuenta;
     nCampo   = 41;     |HAZ AsignaCuenta;
     nCampo   = 42;     |HAZ AsignaCuenta;
     nCampo   = 43;     |HAZ AsignaCuenta;
     nCampo   = 44;     |HAZ AsignaCuenta;
     nCampo   = 45;     |HAZ AsignaCuenta;
     nCampo   = 46;     |HAZ AsignaCuenta;
     nCampo   = 47;     |HAZ AsignaCuenta;
     nCampo   = 48;     |HAZ AsignaCuenta;
     nCampo   = 49;     |HAZ AsignaCuenta;
     nCampo   = 50;     |HAZ AsignaCuenta;

     nCampo   = 51;     |HAZ AsignaCuenta;
     nCampo   = 52;     |HAZ AsignaCuenta;
     nCampo   = 57;     |HAZ AsignaCuenta;
     nCampo   = 58;     |HAZ AsignaCuenta;
     nCampo   = 59;     |HAZ AsignaCuenta;
     nCampo   = 60;     |HAZ AsignaCuenta;
     nCampo   = 63;     |HAZ AsignaCuenta;
     nCampo   = 64;     |HAZ AsignaCuenta;
     nCampo   = 68;     |HAZ AsignaCuenta;
     nCampo   = 73;     |HAZ AsignaCuenta;
     nCampo   = 74;     |HAZ AsignaCuenta;
     nCampo   = 75;     |HAZ AsignaCuenta;
     nCampo   = 76;     |HAZ AsignaCuenta;
     nCampo   = 77;     |HAZ AsignaCuenta;
     nCampo   = 78;     |HAZ AsignaCuenta;
     nCampo   = 79;     |HAZ AsignaCuenta;
     nCampo   = 80;     |HAZ AsignaCuenta;
     nCampo   = 81;     |HAZ AsignaCuenta;
     nCampo   = 82;     |HAZ AsignaCuenta;
     nCampo   = 83;     |HAZ AsignaCuenta;
     nCampo   = 84;     |HAZ AsignaCuenta;
     nCampo   = 85;     |HAZ AsignaCuenta;
     nCampo   = 86;     |HAZ AsignaCuenta;
     nCampo   = 87;     |HAZ AsignaCuenta;
     nCampo   = 88;     |HAZ AsignaCuenta;
     nCampo   = 89;     |HAZ AsignaCuenta;
     nCampo   = 90;     |HAZ AsignaCuenta;
     nCampo   = 91;     |HAZ AsignaCuenta;
     nCampo   = 92;     |HAZ AsignaCuenta;
     nCampo   = 93;     |HAZ AsignaCuenta;
     nCampo   = 94;     |HAZ AsignaCuenta;
     nCampo   = 95;     |HAZ AsignaCuenta;

     aTipo    = "H";
     nFichero = 25;

     nCampo   = 6;      |HAZ AsignaCuenta;
     nCampo   = 7;      |HAZ AsignaCuenta;
     nCampo   = 8;      |HAZ AsignaCuenta;
     nCampo   = 14;     |HAZ AsignaCuenta;
     nCampo   = 18;     |HAZ AsignaCuenta;
     nCampo   = 19;     |HAZ AsignaCuenta;
     nCampo   = 20;     |HAZ AsignaCuenta;
     nCampo   = 22;     |HAZ AsignaCuenta;
     nCampo   = 23;     |HAZ AsignaCuenta;
     nCampo   = 32;     |HAZ AsignaCuenta;
     nCampo   = 33;     |HAZ AsignaCuenta;
     nCampo   = 34;     |HAZ AsignaCuenta;
     nCampo   = 35;     |HAZ AsignaCuenta;
     nCampo   = 36;     |HAZ AsignaCuenta;
     nCampo   = 37;     |HAZ AsignaCuenta;
     nCampo   = 38;     |HAZ AsignaCuenta;
     nCampo   = 39;     |HAZ AsignaCuenta;
     nCampo   = 40;     |HAZ AsignaCuenta;
     nCampo   = 41;     |HAZ AsignaCuenta;
     nCampo   = 42;     |HAZ AsignaCuenta;
     nCampo   = 43;     |HAZ AsignaCuenta;
     nCampo   = 44;     |HAZ AsignaCuenta;
     nCampo   = 45;     |HAZ AsignaCuenta;
     nCampo   = 46;     |HAZ AsignaCuenta;
     nCampo   = 47;     |HAZ AsignaCuenta;

     nCampo   = 48;     |HAZ AsignaCuenta;
     nCampo   = 49;     |HAZ AsignaCuenta;
     nCampo   = 50;     |HAZ AsignaCuenta;
     nCampo   = 56;     |HAZ AsignaCuenta;
     nCampo   = 60;     |HAZ AsignaCuenta;
     nCampo   = 61;     |HAZ AsignaCuenta;
     nCampo   = 62;     |HAZ AsignaCuenta;
     nCampo   = 64;     |HAZ AsignaCuenta;
     nCampo   = 65;     |HAZ AsignaCuenta;
     nCampo   = 74;     |HAZ AsignaCuenta;
     nCampo   = 75;     |HAZ AsignaCuenta;
     nCampo   = 76;     |HAZ AsignaCuenta;
     nCampo   = 77;     |HAZ AsignaCuenta;
     nCampo   = 78;     |HAZ AsignaCuenta;
     nCampo   = 79;     |HAZ AsignaCuenta;
     nCampo   = 80;     |HAZ AsignaCuenta;
     nCampo   = 81;     |HAZ AsignaCuenta;
     nCampo   = 82;     |HAZ AsignaCuenta;
     nCampo   = 83;     |HAZ AsignaCuenta;
     nCampo   = 84;     |HAZ AsignaCuenta;
     nCampo   = 85;     |HAZ AsignaCuenta;
     nCampo   = 86;     |HAZ AsignaCuenta;
     nCampo   = 87;     |HAZ AsignaCuenta;
     nCampo   = 88;     |HAZ AsignaCuenta;
     nCampo   = 89;     |HAZ AsignaCuenta;
|FPRC;

|PROCESO ExtensoCooperativa;
     |HAZ DatosPortada;

     aTipo    = "A";
     nFichero = 22;

     |PARA nCampo = 6;  |SI nCampo [ 137;  |HACIENDO nCampo = nCampo + 1;
           |HAZ AsignaCuenta;
     |SIGUE;

     aTipo    = "P";
     nFichero = 23;

     |PARA nCampo = 6;  |SI nCampo [ 151;  |HACIENDO nCampo = nCampo + 1;
           |HAZ AsignaCuenta;
     |SIGUE;

     aTipo    = "D";
     nFichero = 24;

     |PARA nCampo = 6;  |SI nCampo [ 95;  |HACIENDO nCampo = nCampo + 1;
           |HAZ AsignaCuenta;
     |SIGUE;

     aTipo    = "H";
     nFichero = 25;

     |PARA nCampo = 6;  |SI nCampo [ 89;  |HACIENDO nCampo = nCampo + 1;
           |SI nCampo ! 7;  |Y nCampo ! 49;  |Y nCampo ! 20;  |Y nCampo ! 62;
               |HAZ AsignaCuenta;
           |FINSI;
     |SIGUE;
|FPRC;


|PROCESO AsignaCooperativa;
     aAlfa = eaUnidadBasico + "/MODELOS";                   |RMKDIR aAlfa;
     aAlfa = eaUnidadBasico + "/MODELOS/MEMORIAS";          |RMKDIR aAlfa;
     nWord = 1;

     |SI #5#5 = "A";
         aOrigen   = aBase + "word/cuentas/ccuecea.doc";
     |SINO;
         aOrigen   = aBase + "word/cuentas/ccuecee.doc";
     |FINSI;

     |XABRE "E", aOrigen, nHandle;
     |SI FSalida < 0;
         |MENAV "0000 No tiene instalado el documento de word de las cuentas anuales de cooperativas.";
         |ACABA;
     |FINSI;

     aDestino  = eaUnidadBasico + "/MODELOS/MEMORIAS/wcuenta.doc";

     eaOrigen  = aOrigen;
     eaDestino = aDestino;
     |HAZ EnviaFichero;

     |PUSHV 0501 2380;

     |ATRI S;  |PINTA 1220, "ASIGNANDO CAMPOS AL DOCUMENTO WCUENTA.DOC"; |ATRI s;

     eaAlfa = "Abro el documento " + aDestino;
     |HAZ GeneraLog;

     |WORD_ABRE nWord, aDestino;
     |WORD_PROPIEDADES nWord, "Visible", "NO";

     |SI #5#5 = "A";
         |HAZ AbreviadoCooperativa;
     |SINO;
         |HAZ ExtensoCooperativa;
     |FINSI;

     |WORD_SALVA nWord, "";

     eaAlfa = "Salvo el documento " + aDestino;
     |HAZ GeneraLog;

     eaOrigen   = eaUnidadBasico + "/MODELOS/MEMORIAS/wcuenta.doc";
     eaDestino  = aBase + "emisiones/" + aEmpresa + "/" + aAnyo;  |MKDIR eaDestino;
     eaDestino  = eaDestino + "/" + "wcuenta.doc"
     |HAZ RecibeFichero;

     |RFBORRA eaOrigen;

     eaAlfa = "Borro el documento " + eaOrigen;
     |HAZ GeneraLog;

     |ABRE #500;
     #500#0 = nEmpresa;
     #500#1 = nAnyo;
     |LEE 101#500=;
     |SI FSalida ! 0;
         #500#0 = nEmpresa;
         #500#1 = nAnyo;
         #500#2 = #6#2;
         |GRABA 020#500n;
     |FINSI;
     |LIBERA #500;
     |CIERRA #500;

     |ABRE #501;
     #501#0 = nEmpresa;
     #501#1 = nAnyo;
     #501#2 = "wcuenta.doc";
     |LEE 101#501=;
     |SI FSalida ! 0;
         #501#0 = nEmpresa;
         #501#1 = nAnyo;
         #501#2 = "wcuenta.doc";
         |GRABA 020#501b;
     |FINSI;
     #501#3 = "CUENTAS ANUALES";
     #501#4 = ~;
     |HORA aHora;
     #501#5 = aHora % 102;
     #501#6 = aHora % 402;
     |GRABA 020#501a;
     |LIBERA #501;
     |CIERRA #501;

     |POPV;
|FPRC;

|PROCESO LecturaCooperativa;
     |ABRE #6;
     #6#0 = #5#0;
     #6#1 = #5#1;
     |LEE 040#6=;
     |SI FSalida ! 0; |DDEFECTO #6; |FINSI;
     |CIERRA #6;

     |PINPA #0#99;
     aAlfa = "Empresa : " + #6#2;  |QBF aAlfa;
     aAlfa = aAlfa + " Ejercicio : " + #6#1;

     |ATRI S;  |PINTA 0812, aAlfa;                       |ATRI s;
     |ATRI P;  |PINTA 1926, "GENERANDOSE LAS CUENTAS ANUALES";    |ATRI p;

     nNumero   = #5#1 - 1;
     ejer1     = #5#1;
     ejer2     = nNumero;

     |ABRE #22;
     #22#0 = #5#0;
     #22#1 = #5#1;
     |LEE 040#22=;
     |SI FSalida ! 0; |DDEFECTO #22; |FINSI;
     |CIERRA #22;

     |ABRE #23;
     #23#0 = #5#0;
     #23#1 = #5#1;
     |LEE 040#23=;
     |SI FSalida ! 0; |DDEFECTO #23; |FINSI;
     |CIERRA #23;

     |ABRE #24;
     #24#0 = #5#0;
     #24#1 = #5#1;
     |LEE 040#24=;
     |SI FSalida! 0; |DDEFECTO #24; |FINSI;
     |CIERRA #24;

     |ABRE #25;
     #25#0 = #5#0;
     #25#1 = #5#1;
     |LEE 040#25=;
     |SI FSalida! 0; |DDEFECTO #25; |FINSI;
     |CIERRA #25;

     |SI #6#93 = 2;
         |PARA nCampo = 6; |SI nCampo [ 137; |HACIENDO nCampo = nCampo + 1;
               #22nCampo = #22nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 151; |HACIENDO nCampo = nCampo + 1;
               #23nCampo = #23nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 95; |HACIENDO nCampo = nCampo + 1;
               #24nCampo = #24nCampo / 1000;
         |SIGUE;

         |PARA nCampo = 6; |SI nCampo [ 89; |HACIENDO nCampo = nCampo + 1;
               #25nCampo = #25nCampo / 1000;
         |SIGUE;
     |FINSI;

     |HAZ AsignaCooperativa;
|FPRC;

|PROCESO Lectura;
     |SI #5#13 = "N";  |HAZ LecturaNormal;       |FINSI;
     |SI #5#13 = "S";  |HAZ LecturaCooperativa;  |FINSI;
|FPRC;

|DEFBUCLE cuacceso;
     #5#1;
     5;
     nEmpresa, nAnyo, " ";
     nEmpresa, nAnyo, "z";
     ;
     NULL, Lectura;
|FIN;

|PROCESO CreaCuentas;
     aParametro = PARAMETRO;
     aCapitulo  = aParametro % 106;     || Nombre Texto
     aEmpresa   = aParametro % 705;     || Codigo de Empresa
     aTipo      = aParametro % 1201;    || Memoria o Informe de Gestion
     aOpcion    = aParametro % 1301;    || Que se hace
     aExiste    = aParametro % 1401;    || Existe el Documento (1 si) (0 no)
     aAnyo      = aParametro % 1504;    || Ao del Documento
     nEmpresa   = aEmpresa;
     nAnyo      = aAnyo;

     |DBASE aBase;   |QBF aBase;

     |ATRI S;  |PINTA 1320, "ABRIENDO EL DOCUMENTO, ESPERE UN MOMENTO "; |ATRI s;

     |BUCLE cuacceso;
|FPRC;
