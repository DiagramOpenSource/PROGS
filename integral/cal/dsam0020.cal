|FICHEROS;
     dsam0020;
     dsam0000;
|FIN;

|VARIABLES;
     nBoton              = 0;
     nSalida             = 0;
     nCampo1             = 0;
     nCampo2             = 0;
     nCampo3             = 0;

     aEjecuta            = "";
     aClienteFacE        = "";
     aMensaje            = "";

     &enEmpresa          = 0;
     &enSwWebServiceFace = 0;
     &enAprobacion       = 0;
     &eaPrograma         = "";
     &enCodProv          = 0;
     &enCodPobl          = 0;
     &eaPoblacion        = "";
     &enModoPob          = 0;
     &enModo             = 0;
|FIN;

|PROCESO webFace;
     aEjecuta = "start https://face.gob.es/es/directorio";
     |RSYSTEM aEjecuta;
|FPRC;

|PROCESO ControWSFace;
     |SI enSwWebServiceFace = 1;
          |ATRI 0;
          |PINTA 2305, "Enviar facturaE al WebService de FACE: ";
          |ATRI I;

          |C_V #dsam0020#44, 1, "S";
          |C_M #dsam0020#44, 1, "S";
     |SINO;
          |C_V #dsam0020#44, 1, "N";
          |C_M #dsam0020#44, 1, "N";
     |FINSI;
|FPRC;

|PROCESO PonDatosAAPP;
     |SI #dsam0000#0 = 0;
          aMensaje = "0000Debe seleccionar un Cliente para introducir los datos AAPP";
          |MENAV aMensaje;
          |ACABA;
     |FINSI;

     |CLS;
     |ABRE #dsam0020;

     |SI enModo = 4;
         |ABRE #dsam0020;
         #dsam0020#0 = #dsam0000#0;
         |LEE 000#dsam0020.=;
         |SI FSalida ! 0;  |DDEFECTO #dsam0020;  |FINSI;

         |PINPA #0#dsam0020;
         |PINDA #0#dsam0020;
         |PAUSA;

         |CIERRA #dsam0020;

         |ACABA;
     |FINSI;

     |ABRE #dsam0020;
     |DDEFECTO #dsam0020;
     #dsam0020#0 = #dsam0000#0;
     |LEE 101#dsam0020.=;
     nSalida = FSalida;

     |SI nSalida ! 0;
          #dsam0020#1 = #dsam0000#1;

          |PINPA #0#dsam0020;
          |HAZ ControWSFace;
          |PINDA #0#dsam0020;

          aMensaje = "0000SDesea copiar las direcciones de la ficha del cliente?";
          |CONFI aMensaje;
          |SI FSalida = 0;
               #dsam0020#5 = #dsam0000#20;
               #dsam0020#6 = #dsam0000#25;
               #dsam0020#7 = #dsam0000#26;
               #dsam0020#8 = (("00" + #dsam0020#6) % -102) + (("000" + #dsam0020#7) % -103);
               #dsam0020#9 = #dsam0000#27;
               #dsam0020#10 = #dsam0000#28;

               #dsam0020#15 = #dsam0020#5;
               #dsam0020#16 = #dsam0020#6;
               #dsam0020#17 = #dsam0020#7;
               #dsam0020#18 = #dsam0020#8;
               #dsam0020#19 = #dsam0020#9;
               #dsam0020#20 = #dsam0020#10;

               #dsam0020#25 = #dsam0020#5;
               #dsam0020#26 = #dsam0020#6;
               #dsam0020#27 = #dsam0020#7;
               #dsam0020#28 = #dsam0020#8;
               #dsam0020#29 = #dsam0020#9;
               #dsam0020#30 = #dsam0020#10;

               #dsam0020#35 = #dsam0020#5;
               #dsam0020#36 = #dsam0020#6;
               #dsam0020#37 = #dsam0020#7;
               #dsam0020#38 = #dsam0020#8;
               #dsam0020#39 = #dsam0020#9;
               #dsam0020#40 = #dsam0020#10;
          |FINSI;
     |FINSI;

     |PINPA #0#dsam0020;
     |HAZ ControWSFace;
     |PINDA #0#dsam0020;

     |CONTROL_SIMPLE 0, "BOTON,Web FACe", 0770, 0780, webFace;
     nBoton = FSalida;

     |ENDATOS #2#dsam0020;
     |SI FSalida = 0;
          |SI nSalida = 0;
               |GRABA 020#dsam0020.a;
          |SINO;
               |GRABA 020#dsam0020.n;
          |FINSI;
     |FINSI;
     |LIBERA #dsam0020;

     |FIN_CONTROL_WINDOWS nBoton;

     |CIERRA #dsam0020;
|FPRC;

|PROCESO cp1FacE;
     #dsam0020#8 = (("00" + #dsam0020#6) % -102) + (("000" + #dsam0020#7) % -103);
|FPRC;

|PROCESO cp2FacE;
     #dsam0020#18 = (("00" + #dsam0020#16) % -102) + (("000" + #dsam0020#17) % -103);
|FPRC;

|PROCESO cp3FacE;
     #dsam0020#28 = (("00" + #dsam0020#26) % -102) + (("000" + #dsam0020#27) % -103);
|FPRC;

|PROCESO cp4FacE;
     #dsam0020#38 = (("00" + #dsam0020#36) % -102) + (("000" + #dsam0020#37) % -103);
|FPRC;

|PROCESO LeeLocalidad;
     nCampo1 = Campo - 1;
     nCampo2 = Campo + 2;
     nCampo3 = Campo + 3;

     enCodProv   = #dsam0020#nCampo1#;
     enCodPobl   = #dsam0020#Campo#;
     eaPoblacion = #dsam0020#nCampo2#;
     enModoPob   = 1;
     |SUB_EJECUTA_NP ":integral/dsaw9996";
     #dsam0020#nCampo2# = eaPoblacion;

     |PINTA #dsam0020#nCampo2#;
|FPRC;

|PROGRAMA;
     enAprobacion = 0;
     eaPrograma = "WEBSERVICEFACE";
     |HAZ DSARCHI_INI;
     enSwWebServiceFace = enAprobacion;

     |ABRE #dsam0000;
     #dsam0000#0 = enEmpresa;
     |LEE 101#dsam0000.=;
     |SI FSalida = 0;
         |HAZ PonDatosAAPP;
     |FINSI;
     |CIERRA #dsam0000;
|FPRO;
