|FICHEROS;
     dsxz0001;

     dsam0000;
     dsam9998;
|FIN;

|VARIABLES;
     nRango            = 0;
     nLong             = 0;
     nCaracter         = 0;
     nPos              = 0;
     nPincho           = 0;
     nImaLogo          = 0;
     nConta1           = 0;
     nConta2           = 0;
     nConta3           = 0;
     nHandle           = 0;
     n0Vent            = 0;
     n1Vent            = 0;
     nGrid             = 0;
     nBtnAlta          = -1;
     nBtnModi          = -1;
     nBtnCons          = -1;
     nBtnBorr          = -1;
     nBtnSali          = -1;
     nEBtnAlta         = 0;
     nEBtnModi         = 0;
     nEBtnCons         = 0;
     nEBtnBorr         = 0;
     nEBtnSali         = 0;
     nOkGes            = 0;
     nOkSeg            = 0;
     nOkCol            = 0;

     aAlfa             = "";
     aEsc1             = "";
     aEsc2             = "";
     aRetu             = "";
     aTecla            = "";
     aBase             = "";
     aPathLogo         = "";
     aLogoOrigen       = "";
     aLogoDestino      = "";
     aLong             = "";
     aLogo             = "";
     aCaracter         = "";
     aDirLocal         = "";
     aDocRemoto        = "";
     aDocServidor      = "";
     aIPRemoto         = "";
     aRuta             = "";
     aAlfa1            = "";
     aAlfa2            = "";
     aAlfa3            = "";
     aAbre             = "";
     aFicArbol         = "";
     aOpcion1          = "";
     aOpcion2          = "";
     aOpcion3          = "";
     aOpcion4          = "";
     aOpcion5          = "";
     aOpcion6          = "";
     aOpcion7          = "";
     aContenido        = "";
     aPassword         = "";

     {1}aContiene      = "";

     {-1}sTree         = 0;
     sT_nID            = 0;
     sT_nOper          = 0;
     sT_aData          = "";

     {-1}aVent         = "";
         aVent1        = 0;
         aVent2        = 0;
         aVent3        = 0;
         aVent4        = 0;
         aVent5        = "";

     &enEmpresa        = 0;
     &enPnt0           = 0;
     &enPnt1           = 0;
     &enTree           = 0;
     &enModo           = 0;
     &enBajaCli        = 0;
     &enDesdeX         = 1;
     &eaUnidadBasico   = "";
     &eaRutaOrigen     = "";
     &eaRutaDestino    = "";
     &eaFicheroTxt     = "";
     &eaFicheroTgz     = "";
     &eaFicheroTar     = "";
     &enErrorMac       = 0;
     &eaModoMac        = "";
     &eaNombre         = "";
     &eaNif            = "";
|FIN;

|PROCESO CambiaLogo;
     nPincho = nPincho + 1;
     |SI nPincho = 1;  |ACABA;  |FINSI;

     nPincho = 0;
     |CONFI "0000NSeguro que quiere cambiar el logo";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aRuta = "F*.jpg";
     |BROWSE aRuta;
     |QBF aRuta;

     |SI aRuta = "";  |ACABA;  |FINSI;

     aAlfa = (aRuta % -103) < "";
     |SI aAlfa ! "jpg";  |Y aAlfa ! "bmp";
         |ACABA;
     |FINSI;

     aLogoOrigen  = aRuta % 299;
     aLogoDestino = aPathLogo + "logoacceso.jpg";

     aIPRemoto = "";
     |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

     |SI aIPRemoto ! "";
         |RECIBE_FICHERO aLogoOrigen, aLogoDestino;
     |SINO;
         |COPIA_FICHERO aLogoOrigen, aLogoDestino;
     |FINSI;

     |XABRE "E", aLogoDestino, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |FIN_CONTROL_WINDOWS nImaLogo;

     |HAZ ImagenLogo;
|FPRC;

|PROCESO PintaLogo;
     |QBF aLogoOrigen;

     |PULSATECLA;
     |XABRE "E", aLogoOrigen, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aLong  = aLogoOrigen % 0;
     nLong  = aLong;
     aLogo  = "";
     |PARA nCaracter = 1;  |SI nCaracter [ nLong;  |HACIENDO nCaracter = nCaracter + 1;
           nPos      = (100 * nCaracter) + 1;
           aCaracter = aLogoOrigen % nPos;
           |SI aCaracter = "/";  |O aCaracter = "\";
               aLogo = "";
           |SINO;
               aLogo = aLogo + aCaracter;
           |FINSI;
     |SIGUE;

     aDirLocal    = eaUnidadBasico + "\DOCUMENTOS";     |RMKDIR aDirLocal;
     aDirLocal    = aDirLocal + "\PI";                  |RMKDIR aDirLocal;
     aDirLocal    = aDirLocal + "\LOGOS";               |RMKDIR aDirLocal;
     aLogoDestino = aDirLocal + "\logo.jpg";

     aContiene1 = aLogoDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aLogoOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aLogoOrigen, aLogoDestino;
         |SINO;
             |COPIA_FICHERO aLogoOrigen, aLogoDestino;
         |FINSI;
     |FINSI;

     aLogo = "IMAGEN,"  + aLogoDestino;
     |CONTROL_SIMPLE enPnt0, aLogo, 0501, 0923, CambiaLogo;
     nImaLogo = FSalida;

     |PULSATECLA;
|FPRC;

|PROCESO ImagenLogo;
     aPathLogo   = aBase + "logos/";
     aLogoOrigen = aPathLogo + "logoacceso.jpg";
     |XABRE "E", aLogoOrigen, 0;
     |SI FSalida < 0;
         aLogoOrigen = aPathLogo + "insertarlogo.jpg";
     |FINSI;

     |HAZ PintaLogo;
|FPRC;

|PROCESO PonDatosCabecera;
     nPincho = 0;

     #dsxz0001#0  = #dsam0000#0;
     #dsxz0001#1  = #dsam0000#1;
     #dsxz0001#2  = #dsam0000#2;
     #dsxz0001#3  = #dsam0000#3;
     #dsxz0001#4  = #dsam0000#5;
     #dsxz0001#5  = #dsam0000#6;
     #dsxz0001#6  = #dsam0000#7;
     #dsxz0001#7  = #dsam0000#8;
     #dsxz0001#8  = #dsam0000#9;
     #dsxz0001#9  = #dsam0000#10;
     #dsxz0001#10 = #dsam0000#50;
     #dsxz0001#11 = #dsam0000#51;
     #dsxz0001#12 = #dsam0000#53;
     #dsxz0001#13 = #dsam0000#54;
     #dsxz0001#14 = #dsam0000#55;
     #dsxz0001#15 = #dsam0000#65;
     #dsxz0001#16 = #dsam0000#66;
     #dsxz0001#17 = #dsam0000#67;
     #dsxz0001#18 = #dsam0000#68;
     #dsxz0001#19 = #dsam0000#69;
     #dsxz0001#20 = #dsam0000#120;
     #dsxz0001#21 = #dsam0000#54;
     #dsxz0001#22 = #dsam0000#71;

     |PINDA #0#dsxz0001;
|FPRC;

|PROCESO AbreVentana1;
     |VENTANA 0501, 0502, -1, 1, "";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
|FPRC;

|PROCESO CierraVentana1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO A0100;
     |HAZ AbreVentana1;

     |SUB_EJECUTA ":integral/dsxw0001";

     |HAZ CierraVentana1;
|FPRC;

|PROCESO A1201;
     |HAZ AbreVentana1;

     aAlfa = ":basica/tadz0001;" + #dsam0000#0; |QBF aAlfa;
     aAlfa = aAlfa + "," + #dsam0000#3; |QBF aAlfa;
     aAlfa = aAlfa + "," + #dsam0000#1; |QBF aAlfa;
     |SUB_EJECUTA aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO A1300;
     |HAZ AbreVentana1;

     aAlfa = "dsam0021;" + ("00000" + #dsam0000#0) % -105;
     aAlfa = aAlfa + "ENTRADA";
     |SUB_EJECUTA aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO B0700;
     |HAZ AbreVentana1;

     aAlfa     = "|:basica/socm0001;" + (("00000" + #dsam0000#0) % -105) + enModo;
     |SUB_EJECUTA aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO B0800;
     |HAZ AbreVentana1;

     aAlfa     = "|:basica/socm0003;" + (("00000" + #dsam0000#0) % -105) + enModo;
     |SUB_EJECUTA aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO F0300;
     |HAZ AbreVentana1;

     aAlfa = "|:dsparcli/dstelz36.tab;" + #dsam0000#0;
     |SUB_EJECUTA aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO G0100;
     |HAZ AbreVentana1;

     aAlfa     = "|:dsarchi/dsarm005;" + (("00000" + #dsam0000#0) % -105);
     |SUB_EJECUTA_NP aAlfa;

     |HAZ CierraVentana1;
|FPRC;

|PROCESO ProcesosTree;
     aContenido = Contenido % 110;

     |SI FEntrada = 0;  |ACABA;  |FINSI;

     |SI aContenido = "_Salir";
         |PTEC 807;
         |ACABA;
     |FINSI;

     aOpcion1 = aContenido % 101;                || En modo 9 o X
     aOpcion2 = aContenido % 205;                || Proceso a ejecutar
     aOpcion3 = ("00000" + #dsam0000#0) % -105;  || Codigo empresa
     aOpcion4 = enModo;                          || Modo Modificion o consulta
     aOpcion6 = aContenido % 701;                || Mensaje de no esta Activa para el cliente
     aOpcion7 = aContenido % 801;                || Proceso aun no realizado

     |SI aOpcion7 = "X";
         |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";
         |ACABA;
     |FINSI;

     |SI aOpcion6 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     aAlfa    = Contenido;
     sT_nID   = enTree;
     sT_nOper = 4;
     sT_aData = "[" + aAlfa;
     |ESPECIFICA "COMMANDCONTROL", sTree;
     aOpcion5 = Contenido % 179;   |QBF aOpcion5;

     |SI aOpcion1 = "9";
         aAlfa = "*:integral/dsxz0002;" + aOpcion2 + aOpcion3 + aOpcion4 + aOpcion5;
         |SUB_EJECUTA aAlfa;
     |FINSI;

     |SI aOpcion1 = "X";
         |SI aOpcion2 = "A0100";  |HAZ A0100;  |FINSI;
         |SI aOpcion2 = "A1201";  |HAZ A1201;  |FINSI;
         |SI aOpcion2 = "A1300";  |HAZ A1300;  |FINSI;
         |SI aOpcion2 = "B0700";  |HAZ B0700;  |FINSI;
         |SI aOpcion2 = "B0800";  |HAZ B0800;  |FINSI;
         |SI aOpcion2 = "F0300";  |HAZ F0300;  |FINSI;
         |SI aOpcion2 = "G0100";  |HAZ G0100;  |FINSI;
     |FINSI;

     #dsam0000#0 = aOpcion3;
     |LEE 000#dsam0000.=;

     |HAZ PonDatosCabecera;

     |FOCOTECLADO enTree;
|FPRC;

|PROCESO DestruyeBotones;
     |SI nBtnAlta ! -1;  |FIN_CONTROL_WINDOWS nBtnAlta;  |FINSI;
     |SI nBtnModi ! -1;  |FIN_CONTROL_WINDOWS nBtnModi;  |FINSI;
     |SI nBtnCons ! -1;  |FIN_CONTROL_WINDOWS nBtnCons;  |FINSI;
     |SI nBtnBorr ! -1;  |FIN_CONTROL_WINDOWS nBtnBorr;  |FINSI;
     |SI nBtnSali ! -1;  |FIN_CONTROL_WINDOWS nBtnSali;  |FINSI;

     nBtnAlta = -1;
     nBtnModi = -1;
     nBtnCons = -1;
     nBtnBorr = -1;
     nBtnSali = -1;
|FPRC;

|PROCESO Botones;
     nEBtnAlta = 1;
     nEBtnModi = 1;
     nEBtnCons = 1;
     nEBtnBorr = 1;
     ||nEBtnSali = 1;

     |HAZ DestruyeBotones;

     |CONTROL_SIMPLE 0, "BOTON,{{193}}&Alta ", 3450, 3460, BtnAlta;
     nBtnAlta = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}&Modificar", 3462, 3472, BtnModi;
     nBtnModi = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{197}}&Consultar", 3474, 3486, BtnCons;
     nBtnCons = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{199}}&Borrar", 3488, 3498, BtnBorr;
     nBtnBorr = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3688, 3698, Ptec806;
     nBtnSali = FSalida;

     |SI #dsam9998#1 = "A";
          |CONTROL_SIMPLE 0, "BOTON,{{197}}Cambiar a modo 9", 3602, 3620, Modo9;
     |FINSI;
|FPRC;

|PROCESO CreaVntTree;
     |ESTADO_CONTROL nGrid, "HIDE";

     |HAZ DestruyeBotones;

     |SI PARAMETRO = "MODORENTA";
         aAlfa = (("00000" + #dsam0000#0) % -105) + "-" + #dsam0000#1;  |QBF aAlfa;
         |VENTANA 501, 3699, -1, 16, aAlfa;
     |SINO;
         |VENTANA 1501, 3699, -1, 1, "";
     |FINSI;
     n0Vent = FSalida;

     |PTEC 802;  |PAUSA;

     |PULSATECLA;

     nEBtnAlta = 0;
     nEBtnModi = 0;
     nEBtnCons = 0;
     nEBtnBorr = 0;
     nEBtnSali = 0;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}Salir", 3688, 3698, Ptec806;
|FPRC;

|PROCESO DestruyeVntTree;
     |FINVENTANA n0Vent;

     |HAZ Botones;

     |ESTADO_CONTROL nGrid, "SHOW";

     |PULSATECLA;
|FPRC;

|PROCESO PresentaArbol;
     |HAZ CreaVntTree;

     |SI PARAMETRO = "MODORENTA";
         aAlfa = "TREECTRL, Opciones (MODO MODIFICACION) {{" + aFicArbol + "}}";

         |CONTROL_SIMPLE 0, aAlfa, 602, 3398, ProcesosTree;
     |SINO;
         |SI enModo = 1;
             aAlfa = "TREECTRL, Opciones (MODO ALTA) {{" + aFicArbol + "}}";
         |FINSI;

         |SI enModo = 2;
             aAlfa = "TREECTRL, Opciones (MODO MODIFICACION) {{" + aFicArbol + "}}";
         |FINSI;

         |SI enModo = 4;
             aAlfa = "TREECTRL, Opciones (MODO CONSULTA) {{" + aFicArbol + "}}";
         |FINSI;

         |CONTROL_SIMPLE 0, aAlfa, 1502, 3398, ProcesosTree;
     |FINSI;
     enTree = FSalida;

     sT_nID   = enTree;
     sT_nOper = 2;
     sT_aData = "1:";

     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::," + enTree;

         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aTecla = "";
     |SI enModo ! 4;
         |HAZ AbreVentana1;
         |SUB_EJECUTA ":integral/dsxw0001;ACTUALIZAAPLI";
         |HAZ CierraVentana1;
     |FINSI;

     |HAZ DestruyeVntTree;

     |SI PARAMETRO = "MODORENTA";
         |ACABA;
     |FINSI;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO  nGrid;

     |PULSATECLA;
     |PULSATECLA;
|FPRC;

|PROCESO BtnCons;
     |SI nEBtnCons = 0;  |ACABA;  |FINSI;

     enModo    = 4;
     enEmpresa = #dsam0000#0;
     |HAZ MiraBloqueo;

     |HAZ PresentaArbol;
|FPRC;

|PROCESO BtnModi;
     |SI nEBtnModi = 0;  |ACABA;  |FINSI;

     enModo    = 2;
     enEmpresa = #dsam0000#0;
     |HAZ MiraBloqueo;

     |HAZ PresentaArbol;
|FPRC;

|PROCESO BtnAlta;
     |SI nEBtnAlta = 0;  |ACABA;  |FINSI;

     enModo    = 1;
     enEmpresa = 0;
     |HAZ A0100;

     |SI enEmpresa = 0;
         |FOCOTECLADO  nGrid;
         |ACABA;
     |FINSI;

     #dsam0000#0 = enEmpresa;
     |LEE 000#dsam0000.=;

     enModo    = 2;
     |HAZ PonDatosCabecera;
     |HAZ PresentaArbol;
|FPRC;

|PROCESO BtnBorr;
     |SI nEBtnBorr = 0;  |ACABA;  |FINSI;

     |SELECT #1#dsam0000;
     |LEE 101#dsam0000.=;

     aAlfa = "0000NSeguro que quiere borrar la ficha de cliente ";
     aAlfa = aAlfa + (("00000" + #dsam0000#0) % -105);
     aAlfa = aAlfa + "/" +  #dsam0000#1;
     |CONFI aAlfa;
     |SI FSalida ! 0;
         |LIBERA #dsam0000;

         |FOCOTECLADO  nGrid;
         |ACABA;
     |FINSI;

     |VENTANA 0501, 0523, -1, 16, "Introduzca password";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     aPassword = "";
     E_inf = "";
     E_sup = "20";
     aPassword = 0502 ? -1;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;

     |SI aPassword ! "<MYPASWD>           ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     enEmpresa = #dsam0000#0;
     enBajaCli = 1;
     aAlfa = "*:basica/dsborrad;" + #dsam0000#0;
     |SUB_EJECUTA aAlfa;

     |BORRA 020#dsam0000.a;
     |LIBERA #dsam0000;

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO  nGrid;
|FPRC;

|PROCESO Modo9;
     |SUB_EJECUTA "dsaz9997;MODO9";
     |PTEC 807;
|FPRC;

|PROCESO EvntGrid1;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#dsam0000.c;

         |HAZ PonDatosCabecera;
     |FINSI;

     |SI FSalida = 4;
         |HAZ BtnModi;

         FSalida = "SKIPDEFAULT";
     |FINSI;
|FPRC;

|PROCESO GrabaTree;
     aAlfa = aAlfa1 + aAlfa2 + aAlfa3 +  &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Mantenimientos;
     nConta1 = nConta1 + 1;
     nConta2 = 0;

     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Mantenimientos";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Datos generales";
     aAlfa3  = "{{XA0100}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de direcciones y centros de trabajos";
     aAlfa3  = "{{9A0200}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de n£meros de tel‚fonos";
     aAlfa3  = "{{9A0300}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de datos familiares"
     aAlfa3  = "{{9A0400}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de datos bancos clientes, facturaci¢n y otros";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento de datos bancos clientes, facturaci¢n y otros";
     aAlfa3  = "{{9A0501}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Bancos cliente por modelo";
     aAlfa3  = "{{9A0502}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Bancos cliente por empresas de facturaci¢n";
     aAlfa3  = "{{9A0503}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento de agentes por  reas";
     aAlfa3  = "{{9A0504}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento Organismo AA.PP. facturaci¢n electr¢nica";
     aAlfa3  = "{{9A0505}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de actividades y censo fiscal";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento del Impuesto Actividades Econ¢micas";
     aAlfa3  = "{{9A0601}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento del censo fiscal (Modelo 036-037)";
     aAlfa3  = "{{9A0602}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Representante y obligado tributario";
     aAlfa3  = "{{9A0603}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento del censo fiscal (Modelo 036-037 Version anterior)";
     aAlfa3  = "{{9A0604}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de planing y modelos oficiales periodicos";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Modelos y libros oficiales por empresas";
     aAlfa3  = "{{9A0701}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Grupos de empresas para los modelos 110/111 y 190";
     aAlfa3  = "{{9A0702}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "C lculo planing de modelos y libros oficiales";
     aAlfa3  = "{{9A0703}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Planing de modelos y libros oficiales";
     aAlfa3  = "{{9A0704}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Consulta resumen hist¢rico de tributacion";
     aAlfa3  = "{{9A0705}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de datos facturaci¢n";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento de conceptos facturables";
     aAlfa3  = "{{9A0801}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento de servicios personalizados por empresas";
     aAlfa3  = "{{9A0802}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Mantenimiento de productos personalizados por empresas";
     aAlfa3  = "{{9A0803}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     nConta3 = 0;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de fechas se¤aladas";
     aAlfa3  = "{{9A0900}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de comentarios y notas";
     aAlfa3  = "{{9A1000}}";
     |HAZ GrabaTree;


     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de empresas contables";
     aAlfa3  = "{{9A1100}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Gesti¢n de procesos varios";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Gesti¢n de certificados de contratistas y subcontratistas";
     aAlfa3  = "{{XA1201}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Gesti¢n de embargos";
     aAlfa3  = "{{9A1202}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento aviso o bloqueo del cliente";
     aAlfa3  = "{{XA1300}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Sociedades;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Sociedades";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Ficha de sociedades";
     aAlfa3  = "{{9B0100}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Datos empresa del impuesto de sociedades por a¤os";
     aAlfa3  = "{{9B0200}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Cuentas anuales por a¤os";
     aAlfa3  = "{{9B0300}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Certificados socios de valoraci¢n de acciones";
     aAlfa3  = "{{9B0400}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Configuracion memorias, informe de gesti¢n y actas por a¤os";
     aAlfa3  = "{{9B0500}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta tipo empresa por ejercicio";
     aAlfa3  = "{{9B0600}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Retribuciones a administradores";
     aAlfa3  = "{{XB0700}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Pr‚stamos a socios";
     aAlfa3  = "{{XB0800}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Laboral;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Laboral";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de datos laborales";
     aAlfa3  = "{{9C0100}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de centros de trabajos";
     aAlfa3  = "{{9C0200}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de centros especiales";
     aAlfa3  = "{{9C0300}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de horarios";
     aAlfa3  = "{{9C0400}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de explotaciones agr¡colas";
     aAlfa3  = "{{9C0500}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de trabajadores";
     aAlfa3  = "{{9C0600}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de importes por trabajadores";
     aAlfa3  = "{{9C0700}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de horas semanas trabajadores a tiempo parcial";
     aAlfa3  = "{{9C0800}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de bases cotizadas a la Seguridad Social";
     aAlfa3  = "{{9C0900}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de ep¡grafes/trabajador";
     aAlfa3  = "{{9C1000}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Mantenimiento de prorrateo por  reas y secciones";
     aAlfa3  = "{{9C1100}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Consultas;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Consultas";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de facturaci¢n por periodos";
     aAlfa3  = "{{9D0100}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de recibos emitidos por a¤os";
     aAlfa3  = "{{9D0200}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de rendimientos de actividades";
     aAlfa3  = "{{9D0300}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de llamadas emitidas y recibidas";
     aAlfa3  = "{{9D0400}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de visitas realizadas al despacho";
     aAlfa3  = "{{9D0500}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de entrevistas mantenidas";
     aAlfa3  = "{{9D0600}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de subvenciones oficiales tramitadas";
     aAlfa3  = "{{9D0700}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consulta de documentos archivados";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Ordenado por documento-a¤o-trimestre";
     aAlfa3  = "{{9D0801}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Ordenado por a¤o-trimestre-documento";
     aAlfa3  = "{{9D0802}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Ordenado por fecha-archivo-documento";
     aAlfa3  = "{{9D0803}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Ordenado por usuario-documento";
     aAlfa3  = "{{9D0804}}";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Consultas por fecha de los datos del despacho";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta3 = 0;
     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "General";
     aAlfa3  = "{{9D0901}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Solo Archivos";
     aAlfa3  = "{{9D0902}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Solo llamada";
     aAlfa3  = "{{9D0903}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Solo visitas";
     aAlfa3  = "{{9D0904}}";
     |HAZ GrabaTree;

     nConta3 = nConta3 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + "," + nConta3 + ":";
     aAlfa2  = "Solo entrevistas";
     aAlfa3  = "{{9D0905}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Agenda;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Agenda";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Visualizaci¢n e introducci¢n de la agenda ";
     aAlfa3  = "{{9E0100}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Documentos;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Documentos";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Visualizaci¢n e introducci¢n de los documentos";
     aAlfa3  = "{{9F0100}}";
     |HAZ GrabaTree;

     |DBASS aAlfa;  |QBF aAlfa;
     aAlfa = aAlfa + "dsparcli/def/dstelz36.mas";
     |XABRE "E", aAlfa, 0;
     |SI FSalida ] 0;
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Visualizacion de tiquets";
         aAlfa3  = "{{XF0300}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO GAD;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "GAD (Gesti¢n Archivo Documental)";
     aAlfa3  = "";
     |HAZ GrabaTree;

     nConta2 = nConta2 + 1;
     aAlfa1  = nConta1 + "," + nConta2 + ":";
     aAlfa2  = "Visualizaci¢n e introducci¢n de los documentos en GAD";
     aAlfa3  = "{{XG0100}}";
     |HAZ GrabaTree;
|FPRC;

|PROCESO Gestoria;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Gestoria";
     aAlfa3  = "";
     |HAZ GrabaTree;

     |SI #dsam9998#2 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Transportes";
         aAlfa3  = "{{9H0100" + #dsam9998#2 + "}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#3 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Trafico";
         aAlfa3  = "{{9H0200" + #dsam9998#3 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#4 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Agricultura";
         aAlfa3  = "{{XH0300" + #dsam9998#4 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#5 ! "X";
         nConta2 = nConta2 + 2;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Gasóleo Profesional";
         aAlfa3  = "{{XH0400" + #dsam9998#5 + "X}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Seguros;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Seguros";
     aAlfa3  = "";
     |HAZ GrabaTree;

     |SI #dsam9998#6 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Convenios";
         aAlfa3  = "{{9I0100" + #dsam9998#6 + "}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#7 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Viviendas";
         aAlfa3  = "{{XI0200" + #dsam9998#7 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#8 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Vehiculos";
         aAlfa3  = "{{XI0300" + #dsam9998#8 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#9 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Hogar";
         aAlfa3  = "{{XI0400" + #dsam9998#9 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#10 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Vida riesgo";
         aAlfa3  = "{{XI0500" + #dsam9998#10 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#11 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Decesos";
         aAlfa3  = "{{XI0600" + #dsam9998#11 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#12 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Accidentes";
         aAlfa3  = "{{XI0700" + #dsam9998#12 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#13 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Comunidad";
         aAlfa3  = "{{XI0800" + #dsam9998#13 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#14 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Salud";
         aAlfa3  = "{{XI0900" + #dsam9998#14 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#15 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Vida ahorro";
         aAlfa3  = "{{XI1000" + #dsam9998#15 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#16 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Comercio";
         aAlfa3  = "{{XI1100" + #dsam9998#16 + "X}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO Colaboraciones;
     nConta1 = nConta1 + 1;
     nConta2 = 0;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Colaboraciones";
     aAlfa3  = "";
     |HAZ GrabaTree;

     |SI #dsam9998#17 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Protecci¢n de datos";
         aAlfa3  = "{{9J0100" + #dsam9998#17 + "}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#18 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Prevenci¢n de riesgos laborales";
         aAlfa3  = "{{9J0200" + #dsam9998#18 + "}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#19 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Blanqueo de capitales";
         aAlfa3  = "{{9J0300" + #dsam9998#19 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#20 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Compliance";
         aAlfa3  = "{{9J0400" + #dsam9998#20 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#21 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Auditorias";
         aAlfa3  = "{{9J0500" + #dsam9998#21 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#22 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Formaci¢n";
         aAlfa3  = "{{9J0600" + #dsam9998#22 + "X}}";
         |HAZ GrabaTree;
     |FINSI;

     |SI #dsam9998#23 ! "X";
         nConta2 = nConta2 + 1;
         aAlfa1  = nConta1 + "," + nConta2 + ":";
         aAlfa2  = "Jurídico";
         aAlfa3  = "{{9J0700" + #dsam9998#23 + "X}}";
         |HAZ GrabaTree;
     |FINSI;
|FPRC;

|PROCESO CreaFicArbol;
     nOkGes = 0;
     |SI #dsam9998#2  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#3  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#4  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#5  ! "X";  nOkGes = 1;  |FINSI;

     nOkSeg = 0;
     |SI #dsam9998#6  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#7  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#8  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#9  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#10 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#11 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#12 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#13 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#14 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#15 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#16 ! "X";  nOkSeg = 1;  |FINSI;

     nOkCol = 0;
     |SI #dsam9998#17 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#18 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#19 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#20 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#21 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#22 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#23 ! "X";  nOkCol = 1;  |FINSI;

     aAlfa = aBase + "documentos";      |MKDIR aAlfa;
     aAlfa = aBase + "integral/tmp";     |MKDIR aAlfa;

     eaRutaOrigen  = aBase + "integral/tmp/";
     eaRutaDestino = eaUnidadBasico + "\modelos\tmp\";

     eaFicheroTxt  = "dsaxz0011" + Usuario + ".txt";
     eaFicheroTgz  = "dsaxz0011" + Usuario + ".tgz";
     eaFicheroTar  = "dsaxz0011" + Usuario + ".tar";

     aAbre = eaRutaOrigen + eaFicheroTxt;

     |XABRE "WB", aAbre, nHandle;

     nConta1 = 0;

     |HAZ Mantenimientos;
     |HAZ Sociedades;
     |HAZ Laboral;
     |HAZ Consultas;
     |HAZ Agenda;
     |HAZ Documentos;
     |HAZ GAD;

     |SI nOkGes = 1;
         |HAZ Gestoria;
     |FINSI;

     |SI nOkSeg = 1;
         |HAZ Seguros;
     |FINSI;

     |SI nOkCol = 1;
         |HAZ Colaboraciones;
     |FINSI;

     nConta1 = nConta1 + 1;
     aAlfa1  = nConta1 + ":";
     aAlfa2  = "Salir ";
     aAlfa3  = "{{_Salir}}";
     |HAZ GrabaTree;

     |XCIERRA nHandle;

     |HAZ TraeTxtComprimido;
     aFicArbol = eaRutaDestino + eaFicheroTxt;

     |FBORRA aAbre;
|FPRC;

|PROCESO Ptec806;
     |PTEC 806;
|FPRC;

|PROGRAMA;
     |SI enErrorMac = 1;  |ACABA;  |FINSI;

     |SI PARAMETRO = "MIRAMODO";
         |ACABA;   || Viene de Renta
     |FINSI;

     |PINPA #0#dsxz0001;  enPnt0 = FSalida;
     |PINPA #1#dsxz0001;  enPnt1 = FSalida;

     |HAZ ImagenLogo;

     |SI PARAMETRO = "MODORENTA";
         #dsam0000#0 = enEmpresa;
         |LEE 000#dsam0000.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsam0000;
             #dsam0000#0  =  enEmpresa;
             #dsam0000#1  = eaNombre;
             #dsam0000#2  = eaNombre;
             #dsam0000#3  = eaNif;
             #dsam0000#68 = "S";
             |GRABA 020#dsam0000.n;
             |LIBERA #dsam0000;
         |FINSI;

         nEBtnModi = 1;
         |HAZ BtnModi;

         |ACABA;
     |FINSI;

     |HAZ Botones;

     nRango = 4 + 8 + 16 + 32 + 128;
     |LINEAL_SIMPLE #1#dsam0000, nRango, 0502, 2698, NULL, NULL, EvntGrid1;
     nGrid = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::," + nGrid;

         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;

         |SI aTecla = aRetu;
             |HAZ BtnModi;
         |FINSI;
     |SIGUE;
|FPRO;

|PROCESO Tipo80xz1; |TIPO 80;
||     |SUB_EJECUTA "dsaz9997";
||     |SI enErrorMac = 1;  |ACABA;  |FINSI;

     |SI PARAMETRO = "MIRAMODO";
         |ACABA;   || Viene de Renta
     |FINSI;

     |ABRE #dsam9998;
     |LEE 000#dsam9998.p;
     |SI FSalida ! 0;  |DDEFECTO #dsam9998;  |FINSI;
     |CIERRA #dsam9998;

     |ABRET #dsam0000;

     |HAZ LeeUnidadBasico;
     |DBASE aBase;
     |HAZ CreaFicArbol;

     FSalida = 3699;
|FPRC;

|PROCESO Tipo90xz1; |TIPO 90;
     |CIERRAT #dsam0000;

     |RFBORRA aFicArbol;

     |SUB_EJECUTA "dsaz9997;SINOPCION";
|FPRC;
