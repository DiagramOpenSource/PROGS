|FICHEROS;
     dsam0000 #0;
     dsam0003 #100;
     dsam0004 #4;

     dsam0101 #101;
     dsam0103 #103;
     dsam0114 #7;

     dsaw0200 #200;
     dsaw0201 #201,MANTE;
     dsaw0202 #202,MANTE;
     dsaw0203 #203,MANTE;
     dsaw0204 #204,MANTE;

     dsaw0027 #939,MANTE;
|FIN;

|VARIABLES;
     aF2            = "";
     aF3            = "";
     aF4            = "";
     aF5            = "";
     aF6            = "";
     aF7            = "";
     aEsc           = "";
     aTecla         = "";
     aNombre        = "";
     aAlfa          = "";

     nBotonF2       = 0;
     nBotonF3       = 0;
     nBotonF4       = 0;
     nBotonF5       = 0;
     nBotonF6       = 0;
     nBotonF7       = 0;
     nBotonEsc      = 0;
     nBotonDom      = 0;
     nBotonCta1     = 0;
     nBotonCta2     = 0;
     nBotonCta3     = 0;
     nError         = 0;
     nCampo1        = 0;
     nCampo2        = 0;
     nContribuyente = 0;
     nSw            = 0;

     &enEmpresa     = 0;
     &eaPrograma    = "";
     &eaPunto       = "";
     &eaNombre      = "";
     &eaNif         = "";
     &enModo        = 0;
     &eaCadena      = "";
     &eaCadena1     = "";
     &eaCadena2     = "";
     &eaCadena3     = "";
|FIN;

|PROCESO QuitaBotones;
     |ESTADO_CONTROL nBotonF2,  "HIDE";
     |ESTADO_CONTROL nBotonF3,  "HIDE";
     |ESTADO_CONTROL nBotonF4,  "HIDE";
     |ESTADO_CONTROL nBotonF5,  "HIDE";
     |ESTADO_CONTROL nBotonEsc, "HIDE";
     |PULSATECLA;
|FPRC;

|PROCESO PonBotones;
     |ESTADO_CONTROL nBotonF2,  "SHOW";
     |ESTADO_CONTROL nBotonF3,  "SHOW";
     |ESTADO_CONTROL nBotonF4,  "SHOW";
     |ESTADO_CONTROL nBotonF5,  "SHOW";
     |ESTADO_CONTROL nBotonEsc, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO BotonEsc;
     |PTEC 806;
|FPRC;

|PROCESO CargaDatosFam;
     |DDEFECTO #100;
     #100#0  = #0#0;
     #100#1  = #0#3;
     #100#2  = #0#100;
     #100#3  = #0#101;
     #100#4  = #0#102;
     #100#5  = #0#1;
     #100#11 = #0#86;
     #100#12 = #0#54;
     #100#13 = #0#55;
     #100#14 = #0#29;
     #100#15 = #0#30;
     #100#16 = #0#31;
     #100#17 = #0#32;
     #100#18 = #0#33;
     #100#19 = #0#34;
     #100#20 = #0#35;
     #100#21 = #0#36;
     #100#22 = #0#37;
     #100#23 = (("00" + #100#20) % -102) + (("000" + #100#21) % -103);
     #100#24 = #0#39;
     #100#25 = #0#40;
     #100#26 = #0#41;
     #100#27 = #0#42;
     #100#28 = #0#43;
     #100#29 = #0#44;
     #100#30 = #0#45;
     #100#31 = #0#46;
     #100#32 = #0#47;
     #100#33 = (("00" + #100#30) % -102) + (("000" + #100#31) % -103);
     #100#34 = #0#49;
     #100#53 = #0#90 + #0#91 + #0#92 + #0#93;
     #100#55 = #0#90 + #0#91 + #0#92 + #0#93;

     eaCadena = #100#2 + #100#3 + #100#4;  |QBT eaCadena;
     |SI eaCadena = "";
         eaCadena = #100#5;
         |HAZ SeparaNombreDer;
         #100#2 = eaCadena1;
         #100#3 = eaCadena2;
         #100#4 = eaCadena3;
     |FINSI;

     |ESTADO_CONTROL nBotonCta1, "SHOW";
     |ESTADO_CONTROL nBotonCta2, "SHOW";
     |ESTADO_CONTROL nBotonCta3, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO CtasCtesF2;
     |ESTADO_CONTROL nBotonCta1, "HIDE";
     |ESTADO_CONTROL nBotonCta2, "HIDE";
     |ESTADO_CONTROL nBotonCta3, "HIDE";

     #939#0 = #204#11 % 104;
     #939#1 = #204#11 % 504;
     #939#2 = #204#11 % 902;
     #939#3 = #204#11 % 1110;

     |PUSHV 0501 2380;
     |PINPA #0#939;

     |ATRI R;
     |PINTA 1116, "            CUENTA DECLARANTE               ";
     |ATRI r;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;
         aAlfa   = #939#0 + #939#1 + #939#2 + #939#3;
         #204#11 = aAlfa;
     |FINSI;
     |POPV;
     |PINTA #204#11;

     aAlfa = #204#12;  |QBF aAlfa;
     |SI aAlfa = "";  |Y #100#6 = "C";
         #204#12 = #204#11;
         |PINTA #204#12;
     |FINSI;

     aAlfa = #204#13;  |QBF aAlfa;
     |SI aAlfa = "";
         #204#13 = #204#11;
         |PINTA #204#13;
     |FINSI;

     |ESTADO_CONTROL nBotonCta1, "SHOW";
     |ESTADO_CONTROL nBotonCta2, "SHOW";
     |ESTADO_CONTROL nBotonCta3, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO CtasCtesF3;
     |SI #100#6 ! "C";  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonCta1, "HIDE";
     |ESTADO_CONTROL nBotonCta2, "HIDE";
     |ESTADO_CONTROL nBotonCta3, "HIDE";

     #939#0 = #204#12 % 104;
     #939#1 = #204#12 % 504;
     #939#2 = #204#12 % 902;
     #939#3 = #204#12 % 1110;

     |PUSHV 0501 2380;
     |PINPA #0#939;

     |ATRI R;
     |PINTA 1116, "            CUENTA CONYUGE                  ";
     |ATRI r;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;
         aAlfa   = #939#0 + #939#1 + #939#2 + #939#3;
         #204#12 = aAlfa;
     |FINSI;
     |POPV;
     |PINTA #204#12;

     |ESTADO_CONTROL nBotonCta1, "SHOW";
     |ESTADO_CONTROL nBotonCta2, "SHOW";
     |ESTADO_CONTROL nBotonCta3, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO CtasCtesF4;
     |ESTADO_CONTROL nBotonCta1, "HIDE";
     |ESTADO_CONTROL nBotonCta2, "HIDE";
     |ESTADO_CONTROL nBotonCta3, "HIDE";

     #939#0 = #204#13 % 104;
     #939#1 = #204#13 % 504;
     #939#2 = #204#13 % 902;
     #939#3 = #204#13 % 1110;

     |PUSHV 0501 2380;
     |PINPA #0#939;

     |ATRI R;
     |PINTA 1116, "            CUENTA CONJUNTA                 ";
     |ATRI r;

     |PINDA #0#939;
     |ENDATOS #1#939;
     |SI FSalida = 0;
         aAlfa   = #939#0 + #939#1 + #939#2 + #939#3;
         #204#13 = aAlfa;
     |FINSI;
     |POPV;
     |PINTA #204#13;

     |ESTADO_CONTROL nBotonCta1, "SHOW";
     |ESTADO_CONTROL nBotonCta2, "SHOW";
     |ESTADO_CONTROL nBotonCta3, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO Tipo6Fw204; |TIPO 6;
     |SI FSalida = 10;  |HAZ CtasCtesF2;  |ERROR;  |FINSI;
     |SI FSalida = 11;  |HAZ CtasCtesF3;  |ERROR;  |FINSI;
     |SI FSalida = 12;  |HAZ CtasCtesF4;  |ERROR;  |FINSI;
|FPRC;

|PROCESO DomiciliosF3;
     |ESTADO_CONTROL nBotonDom, "HIDE";

     |BLIN 04;

     |SI nContribuyente = 1;
         |PARA nCampo1 = 18;  |SI nCampo1 [ 45;  |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 - 18;

               #203nCampo2 = #201nCampo1;
         |SIGUE;
     |FINSI;

     |SI nContribuyente = 2;
         |PARA nCampo1 = 14;  |SI nCampo1 [ 41;  |HACIENDO nCampo1 = nCampo1 + 1;
               nCampo2 = nCampo1 - 14;

               #203nCampo2 = #202nCampo1;
         |SIGUE;
     |FINSI;

     |PUSHV 0501 2380;
     |PINPA #0#203;

     |PINDA #0#203;
     |SI enModo ! 4;
         |ENDATOS #1#203;
         |SI FSalida = 0;
             |SI nContribuyente = 1;
                 |PARA nCampo1 = 18;  |SI nCampo1 [ 45;  |HACIENDO nCampo1 = nCampo1 + 1;
                       nCampo2 = nCampo1 - 18;

                       #201nCampo1 = #203nCampo2;
                 |SIGUE;
             |FINSI;

             |SI nContribuyente = 2;
                 |PARA nCampo1 = 14;  |SI nCampo1 [ 41;  |HACIENDO nCampo1 = nCampo1 + 1;
                       nCampo2 = nCampo1 - 14;

                       #202nCampo1 = #203nCampo2;
                 |SIGUE;
             |FINSI;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     |POPV;

     |ESTADO_CONTROL nBotonDom, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO Tipo6Fw201; |TIPO 6;
     |SI FSalida = 11;  |HAZ DomiciliosF3;  |ERROR;  |FINSI;
|FPRC;

|PROCESO Tipo6Fw202; |TIPO 6;
     |SI FSalida = 11;  |HAZ DomiciliosF3;  |ERROR;  |FINSI;
|FPRC;

|PROCESO ChequeoConyuge;
     nSw = 0;
     |SI #100#75  ! #100#92;    nSw = 1;  |FINSI;
     |SI #100#14  ! #100#44;    nSw = 1;  |FINSI;
     |SI #100#15  ! #100#45;    nSw = 1;  |FINSI;
     |SI #100#76  ! #100#93;    nSw = 1;  |FINSI;
     |SI #100#16  ! #100#46;    nSw = 1;  |FINSI;
     |SI #100#77  ! #100#94;    nSw = 1;  |FINSI;
     |SI #100#78  ! #100#95;    nSw = 1;  |FINSI;
     |SI #100#79  ! #100#96;    nSw = 1;  |FINSI;
     |SI #100#17  ! #100#47;    nSw = 1;  |FINSI;
     |SI #100#18  ! #100#48;    nSw = 1;  |FINSI;
     |SI #100#19  ! #100#49;    nSw = 1;  |FINSI;
     |SI #100#80  ! #100#97;    nSw = 1;  |FINSI;
     |SI #100#81  ! #100#98;    nSw = 1;  |FINSI;
     |SI #100#20  ! #100#50;    nSw = 1;  |FINSI;
     |SI #100#21  ! #100#51;    nSw = 1;  |FINSI;
     |SI #100#22  ! #100#52;    nSw = 1;  |FINSI;
     |SI #100#82  ! #100#99;    nSw = 1;  |FINSI;
     |SI #100#83  ! #100#100;   nSw = 1;  |FINSI;
     |SI #100#84  ! #100#101;   nSw = 1;  |FINSI;
     |SI #100#85  ! #100#102;   nSw = 1;  |FINSI;
     |SI #100#86  ! #100#103;   nSw = 1;  |FINSI;
     |SI #100#87  ! #100#104;   nSw = 1;  |FINSI;
     |SI #100#88  ! #100#105;   nSw = 1;  |FINSI;
     |SI #100#89  ! #100#106;   nSw = 1;  |FINSI;
     |SI #100#11  ! #100#43;    nSw = 1;  |FINSI;

     |SI nSw = 0;  |ACABA;  |FINSI;

     |SI #100#92 = "N";
         aAlfa = #100#45;
     |SINO;
         aAlfa = #100#99;
     |FINSI;

     |QBF aAlfa;

     |SI aAlfa ! "";
         |CONFI "0000 Los datos del domicilio habitual difiere entre los declarantes, quiere igualarlos";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #100#92  = #100#75;
     #100#44  = #100#14;
     #100#45  = #100#15;
     #100#93  = #100#76;
     #100#46  = #100#16;
     #100#94  = #100#77;
     #100#95  = #100#78;
     #100#96  = #100#79;
     #100#47  = #100#17;
     #100#48  = #100#18;
     #100#49  = #100#19;
     #100#97  = #100#80;
     #100#98  = #100#81;
     #100#50  = #100#20;
     #100#51  = #100#21;
     #100#52  = #100#22;
     #100#99  = #100#82;
     #100#100 = #100#83;
     #100#101 = #100#84;
     #100#102 = #100#85;
     #100#103 = #100#86;
     #100#104 = #100#87;
     #100#105 = #100#88;
     #100#106 = #100#89;
     #100#43  = #100#11;
|FPRC;

|PROCESO ChequeoEnvio;
     nSw = 0;
     |SI #100#14  ! #100#24;    nSw = 1;  |FINSI;
     |SI #100#15  ! #100#25;    nSw = 1;  |FINSI;
     |SI #100#16  ! #100#26;    nSw = 1;  |FINSI;
     |SI #100#17  ! #100#27;    nSw = 1;  |FINSI;
     |SI #100#18  ! #100#28;    nSw = 1;  |FINSI;
     |SI #100#19  ! #100#29;    nSw = 1;  |FINSI;
     |SI #100#20  ! #100#30;    nSw = 1;  |FINSI;
     |SI #100#21  ! #100#31;    nSw = 1;  |FINSI;
     |SI #100#22  ! #100#32;    nSw = 1;  |FINSI;

     |SI nSw = 0;  |ACABA;  |FINSI;

     aAlfa = #100#25;  |QBF aAlfa;

     |SI aAlfa ! "";
         |CONFI "0000 Los datos del domicilio de envio difiere a los del declarante, quiere igualarlos";
         |SI FSalida ! 0;  |ACABA;  |FINSI;
     |FINSI;

     #100#24  = #100#14;
     #100#25  = #100#15;
     #100#26  = #100#16;
     #100#27  = #100#17;
     #100#28  = #100#18;
     #100#29  = #100#19;
     #100#30  = #100#20;
     #100#31  = #100#21;
     #100#32  = #100#22;
|FPRC;

|PROCESO ProcesoF2;
     |BLIN 04;
     nContribuyente = 1;

     |ABRE #101;
     #101#0    = #100#20;
     #101#1    = #100#21;
     |LEE 000#101=;
     |SI FSalida ! 0;   |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     #201#0  = #100#1;
     #201#1  = #100#5;
     #201#2  = #100#2;
     #201#3  = #100#3;
     #201#4  = #100#4;
     #201#5  = #100#69;
     #201#6  = #100#6;
     #201#7  = #100#67;
     #201#8  = #100#8;
     #201#9  = #100#9;
     #201#10 = #100#65;
     #201#11 = #100#10;
     #201#12 = #100#64;
     #201#14 = #100#12;
     #201#15 = #100#71;
     #201#16 = #100#74;
     #201#17 = #100#73;
     #201#18 = #100#75;
     #201#19 = #100#14;
     #201#20 = #100#15;
     #201#21 = #100#76;
     #201#22 = #100#16;
     #201#23 = #100#77;
     #201#24 = #100#78;
     #201#25 = #100#79;
     #201#26 = #100#17;
     #201#27 = #100#18;
     #201#28 = #100#19;
     #201#29 = #100#80;
     #201#30 = #100#81;
     #201#31 = #100#20;
     #201#32 = #100#21;
     #201#33 = #100#22;
     #201#34 = #101#2;
     #201#35 = #100#82;
     #201#36 = #100#83;
     #201#37 = #100#84;
     #201#38 = #100#85;
     #201#39 = #100#86;
     #201#40 = #100#87;
     #201#41 = #100#88;
     #201#42 = #100#89;
     #201#43 = #100#11;
     #201#45 = #100#61;

     |SI #201#18 = "S";
         |ABRE #7;
         #7#0 = #201#43;
         |LEE 000#7=;
         |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
         |CIERRA #7;

         #201#44 = #7#1;
     |SINO;
         |SI #201#45 ! " ";
             #201#43 = 20;
             #201#44 = "";
         |SINO;
             #201#43 = #101#4;
             #201#44 = #101#5;
         |FINSI;
     |FINSI;

     |HAZ QuitaBotones;

     |PUSHV 0501 2380;
     |PINPA #0#201;

     |CONTROL_SIMPLE 0, "BOTON, <F3> DOMICILIO HABITUAL", 1956, 2178, DomiciliosF3;
     nBotonDom = FSalida;

     |PINDA #0#201;
     |SI enModo ! 4;
         |ENDATOS #1#201;
         |SI FSalida = 0;
             #100#1   = #201#0;
             #100#5   = #201#1;
             #100#2   = #201#2;
             #100#3   = #201#3;
             #100#4   = #201#4;
             #100#69  = #201#5;
             #100#6   = #201#6;
             #100#67  = #201#7;
             #100#8   = #201#8;
             #100#9   = #201#9;
             #100#65  = #201#10;
             #100#10  = #201#11;
             #100#64  = #201#12;
             #100#12  = #201#14;
             #100#71  = #201#15;
             #100#74  = #201#16;
             #100#73  = #201#17;
             #100#75  = #201#18;
             #100#14  = #201#19;
             #100#15  = #201#20;
             #100#76  = #201#21;
             #100#16  = #201#22;
             #100#77  = #201#23;
             #100#78  = #201#24;
             #100#79  = #201#25;
             #100#17  = #201#26;
             #100#18  = #201#27;
             #100#19  = #201#28;
             #100#80  = #201#29;
             #100#81  = #201#30;
             #100#20  = #201#31;
             #100#21  = #201#32;
             #100#22  = #201#33;
             #100#23  = (("00" + #100#20) % -102) + (("000" + #100#21) % -103);
             #100#82  = #201#35;
             #100#83  = #201#36;
             #100#84  = #201#37;
             #100#85  = #201#38;
             #100#86  = #201#39;
             #100#87  = #201#40;
             #100#88  = #201#41;
             #100#89  = #201#42;
             #100#11  = #201#43;
             #100#61  = #201#45;
             #100#7   = #100#67 % -104;

             |SI #100#6 ! "C";
                 #100#35  = "";
                 #100#39  = "";
                 #100#36  = "";
                 #100#37  = "";
                 #100#38  = "";
                 #100#70  = "";
                 #100#68  = "01.01.0000";
                 #100#41  = 0;
                 #100#42  = "";
                 #100#13  = "";
                 #100#72  = "";
                 #100#91  = "";
                 #100#90  = "";
                 #100#92  = "";
                 #100#44  = "";
                 #100#45  = "";
                 #100#93  = "";
                 #100#46  = "";
                 #100#94  = "";
                 #100#95  = "";
                 #100#96  = "";
                 #100#47  = "";
                 #100#48  = "";
                 #100#49  = "";
                 #100#97  = "";
                 #100#98  = "";
                 #100#50  = 0;
                 #100#51  = 0;
                 #100#52  = "";
                 #100#99  = "";
                 #100#100 = "";
                 #100#101 = "";
                 #100#102 = "";
                 #100#103 = "";
                 #100#104 = "";
                 #100#105 = 0;
                 #100#106 = "";
                 #100#43  = 0;
                 #100#62  = "";
                 #100#54  = "";
                 #100#60  = "";
                 #100#40  = "0000";
             |FINSI;
         |FINSI;

         |HAZ ChequeoEnvio;

         |SI #100#6 = "C";
             |SI #100#70 = " ";
                 |SI #100#69  = "V";  #100#70  = "M";  |FINSI;
                 |SI #100#69  = "M";  #100#70  = "V";  |FINSI;
             |FINSI;

             |HAZ ChequeoConyuge;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     |FIN_CONTROL_WINDOWS nBotonDom;
     |POPV;
     |HAZ PonBotones;

     #200#0 = #100#5;    |PINTA #200#0;
     #200#1 = #100#39;   |PINTA #200#1;

     |SI #100#6 ! "C";
         |ESTADO_CONTROL nBotonF3, "DISABLE";
     |SINO;
         |ESTADO_CONTROL nBotonF3, "ENABLE";
     |FINSI;
|FPRC;

|PROCESO ProcesoF3;
     |SI #100#6 ! "C";   |ACABA;  |FINSI;

     |BLIN 04;
     nContribuyente = 2;

     |ABRE #101;
     #101#0    = #100#50;
     #101#1    = #100#51;
     |LEE 000#101=;
     |SI FSalida ! 0;   |DDEFECTO #101;  |FINSI;
     |CIERRA #101;

     #202#0  = #100#35;
     #202#1  = #100#39;
     #202#2  = #100#36;
     #202#3  = #100#37;
     #202#4  = #100#38;
     #202#5  = #100#70;
     #202#6  = #100#68;
     #202#7  = #100#41;
     #202#8  = #100#42;
     #202#10 = #100#13;
     #202#11 = #100#72;
     #202#12 = #100#91;
     #202#13 = #100#90;
     #202#14 = #100#92;
     #202#15 = #100#44;
     #202#16 = #100#45;
     #202#17 = #100#93;
     #202#18 = #100#46;
     #202#19 = #100#94;
     #202#20 = #100#95;
     #202#21 = #100#96;
     #202#22 = #100#47;
     #202#23 = #100#48;
     #202#24 = #100#49;
     #202#25 = #100#97;
     #202#26 = #100#98;
     #202#27 = #100#50;
     #202#28 = #100#51;
     #202#29 = #100#52;
     #202#30 = #101#2;
     #202#31 = #100#99;
     #202#32 = #100#100;
     #202#33 = #100#101;
     #202#34 = #100#102;
     #202#35 = #100#103;
     #202#36 = #100#104;
     #202#37 = #100#105;
     #202#38 = #100#106;
     #202#39 = #100#43;
     #202#41 = #100#62;

     |SI #202#14 = "S";
         |ABRE #7;
         #7#0 = #202#39;
         |LEE 000#7=;
         |SI FSalida ! 0;  |DDEFECTO #7;  |FINSI;
         |CIERRA #7;

         #202#40 = #7#1;
     |SINO;
         |SI #202#41 ! " ";
             #202#39 = 20;
             #202#40 = "";
         |SINO;
             #202#39 = #101#4;
             #202#40 = #101#5;
         |FINSI;
     |FINSI;

     |HAZ QuitaBotones;

     |PUSHV 0501 2380;
     |PINPA #0#202;

     |CONTROL_SIMPLE 0, "BOTON, <F3> DOMICILIO HABITUAL", 1956, 2178, DomiciliosF3;
     nBotonDom = FSalida;

     |PINDA #0#202;
     |SI enModo ! 4;
         |ENDATOS #1#202;
         |SI FSalida = 0;
             #100#35  = #202#0;
             #100#39  = #202#1;
             #100#36  = #202#2;
             #100#37  = #202#3;
             #100#38  = #202#4;
             #100#70  = #202#5;
             #100#68  = #202#6;
             #100#41  = #202#7;
             #100#42  = #202#8;
             #100#13  = #202#10;
             #100#72  = #202#11;
             #100#91  = #202#12;
             #100#90  = #202#13;
             #100#92  = #202#14;
             #100#44  = #202#15;
             #100#45  = #202#16;
             #100#93  = #202#17;
             #100#46  = #202#18;
             #100#94  = #202#19;
             #100#95  = #202#20;
             #100#96  = #202#21;
             #100#47  = #202#22;
             #100#48  = #202#23;
             #100#49  = #202#24;
             #100#97  = #202#25;
             #100#98  = #202#26;
             #100#50  = #202#27;
             #100#51  = #202#28;
             #100#52  = #202#29;
             #100#99  = #202#31;
             #100#100 = #202#32;
             #100#101 = #202#33;
             #100#102 = #202#34;
             #100#103 = #202#35;
             #100#104 = #202#36;
             #100#105 = #202#37;
             #100#106 = #202#38;
             #100#43  = #202#39;
             #100#62  = #202#41;
             #100#40  = #100#68 % -104;
         |FINSI;
     |SINO;
         |PAUSA;
     |FINSI;

     |FIN_CONTROL_WINDOWS nBotonDom;
     |POPV;

     |HAZ PonBotones;
|FPRC;

|PROCESO ProcesoF4;
     |HAZ QuitaBotones;

     enEmpresa = #100#0;
     |SUB_EJECUTA_NP "dsam0004";

     |HAZ PonBotones;
|FPRC;

|PROCESO ProcesoF5;
     |BLIN 04;

     |HAZ QuitaBotones;

     #204#0  = #100#58;
     #204#1  = #100#57;
     #204#2  = #100#56;
     #204#3  = #100#59;
     #204#4  = #100#60;
     #204#5  = #100#63;
     #204#11 = #100#53;
     #204#12 = #100#54;
     #204#13 = #100#55;
     #204#18 = #100#34;
     #204#19 = #100#24;
     #204#20 = #100#25;
     #204#21 = #100#26;
     #204#22 = #100#27;
     #204#23 = #100#28;
     #204#24 = #100#29;
     #204#25 = #100#30;
     #204#26 = #100#31;
     #204#27 = #100#32;

     |PUSHV 0501 2380;
     |PINPA #0#204;
     |PINDA #0#204;

     |SI enModo ! 4;
         |CONTROL_SIMPLE 0, "BOTON, F2", 1544, 1550, CtasCtesF2;
         nBotonCta1 = FSalida;

         |CONTROL_SIMPLE 0, "BOTON, F3", 1644, 1650, CtasCtesF3;
         nBotonCta2 = FSalida;

         |CONTROL_SIMPLE 0, "BOTON, F4", 1744, 1750, CtasCtesF4;
         nBotonCta3 = FSalida;

         |SI #100#6 ! "C";
             |ESTADO_CONTROL nBotonCta2, "DISABLE";
         |FINSI;

         |ENDATOS #1#204;
         |SI FSalida = 0;
             #100#58  = #204#0;
             #100#57  = #204#1;
             #100#56  = #204#2;
             #100#59  = #204#3;
             #100#60  = #204#4;
             #100#63  = #204#5;
             #100#53  = #204#11;
             #100#54  = #204#12;
             #100#55  = #204#13;
             #100#34  = #204#18;
             #100#24  = #204#19;
             #100#25  = #204#20;
             #100#26  = #204#21;
             #100#27  = #204#22;
             #100#28  = #204#23;
             #100#29  = #204#24;
             #100#30  = #204#25;
             #100#31  = #204#26;
             #100#32  = #204#27;
         |FINSI;

         |FIN_CONTROL_WINDOWS nBotonCta1;
         |FIN_CONTROL_WINDOWS nBotonCta2;
         |FIN_CONTROL_WINDOWS nBotonCta3;
     |SINO;
         |PAUSA;
     |FINSI;

     |POPV;

     |HAZ PonBotones;
|FPRC;

|PROCESO ComparaSiglas2;
    |QBF aAlfa;
    |SI aAlfa = "ALAM";  aAlfa = "AL";    |FINSI;
    |SI aAlfa = "ALDEA"; aAlfa = "AD";    |FINSI;
    |SI aAlfa = "APTOS"; aAlfa = "AP";    |FINSI;
    |SI aAlfa = "ARRAL"; aAlfa = "AR";    |FINSI;
    |SI aAlfa = "ARRY";  aAlfa = "AY";    |FINSI;
    |SI aAlfa = "AVDA";  aAlfa = "AV";    |FINSI;
    |SI aAlfa = "BJADA"; aAlfa = "BJ";    |FINSI;
    |SI aAlfa = "BRANC"; aAlfa = "BR";    |FINSI;
    |SI aAlfa = "BARRO"; aAlfa = "BO";    |FINSI;
    |SI aAlfa = "BLQUE"; aAlfa = "BL";    |FINSI;
    |SI aAlfa = "CALLE"; aAlfa = "CL";    |FINSI;
    |SI aAlfa = "CLLJA"; aAlfa = "CJ";    |FINSI;
    |SI aAlfa = "CMNO";  aAlfa = "CM";    |FINSI;
    |SI aAlfa = "CTRA";  aAlfa = "CR";    |FINSI;
    |SI aAlfa = "CSRIO"; aAlfa = "CS";    |FINSI;
    |SI aAlfa = "COL";   aAlfa = "CO";    |FINSI;
    |SI aAlfa = "CJTO";  aAlfa = "CN";    |FINSI;
    |SI aAlfa = "CUSTA"; aAlfa = "CT";    |FINSI;
    |SI aAlfa = "CHLET"; aAlfa = "CH";    |FINSI;
    |SI aAlfa = "EDIFC"; aAlfa = "ED";    |FINSI;
    |SI aAlfa = "ENTD";  aAlfa = "EN";    |FINSI;
    |SI aAlfa = "ESCAL"; aAlfa = "ES";    |FINSI;
    |SI aAlfa = "EXPLA"; aAlfa = "EX";    |FINSI;
    |SI aAlfa = "EXTRM"; aAlfa = "EM";    |FINSI;
    |SI aAlfa = "EXTRR"; aAlfa = "ER";    |FINSI;
    |SI aAlfa = "GTA";   aAlfa = "GL";    |FINSI;
    |SI aAlfa = "G.V.";  aAlfa = "GV";    |FINSI;
    |SI aAlfa = "GRUPO"; aAlfa = "GR";    |FINSI;
    |SI aAlfa = "JDIN";  aAlfa = "JR";    |FINSI;
    |SI aAlfa = "LUGAR"; aAlfa = "LG";    |FINSI;
    |SI aAlfa = "MASIA"; aAlfa = "MS";    |FINSI;
    |SI aAlfa = "MERC";  aAlfa = "MC";    |FINSI;
    |SI aAlfa = "MONTE"; aAlfa = "MT";    |FINSI;
    |SI aAlfa = "MUELL"; aAlfa = "ML";    |FINSI;
    |SI aAlfa = "PQUE";  aAlfa = "PQ";    |FINSI;
    |SI aAlfa = "PQUE";  aAlfa = "PQ";    |FINSI;
    |SI aAlfa = "PTDA";  aAlfa = "PD";    |FINSI;
    |SI aAlfa = "PSAJE"; aAlfa = "PJ";    |FINSI;
    |SI aAlfa = "PASEO"; aAlfa = "PS";    |FINSI;
    |SI aAlfa = "PLAZA"; aAlfa = "PZ";    |FINSI;
    |SI aAlfa = "PBDO";  aAlfa = "PB";    |FINSI;
    |SI aAlfa = "POLIG"; aAlfa = "PG";    |FINSI;
    |SI aAlfa = "PROL";  aAlfa = "PR";    |FINSI;
    |SI aAlfa = "PNTE";  aAlfa = "PT";    |FINSI;
    |SI aAlfa = "PTA";   aAlfa = "PU";    |FINSI;
    |SI aAlfa = "RAMAL"; aAlfa = "RM";    |FINSI;
    |SI aAlfa = "RBLA";  aAlfa = "RB";    |FINSI;
    |SI aAlfa = "RAMPA"; aAlfa = "RP";    |FINSI;
    |SI aAlfa = "RIERA"; aAlfa = "RR";    |FINSI;
    |SI aAlfa = "RCON";  aAlfa = "RC";    |FINSI;
    |SI aAlfa = "RONDA"; aAlfa = "RD";    |FINSI;
    |SI aAlfa = "RUA";   aAlfa = "RU";    |FINSI;
    |SI aAlfa = "SECT";  aAlfa = "SC";    |FINSI;
    |SI aAlfa = "SENDA"; aAlfa = "SD";    |FINSI;
    |SI aAlfa = "SBIDA"; aAlfa = "SB";    |FINSI;
    |SI aAlfa = "TRRNT"; aAlfa = "TO";    |FINSI;
    |SI aAlfa = "TRVA";  aAlfa = "TR";    |FINSI;
    |SI aAlfa = "URB";   aAlfa = "UR";    |FINSI;
    |SI aAlfa = "VIA";   aAlfa = "VI";    |FINSI;
    |SI aAlfa = "VIA";   aAlfa = "VP";    |FINSI;
|FPRC;

|PROCESO dsam0004;
     |SI #4#2 = "            ";  |ACABA;  |FINSI;

     #103#0 = #4#2;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0  = #4#2;
         #103#1  = #4#3;
         #103#2  = #100#15;
         #103#3  = #100#16;
         #103#4  = #100#20;
         #103#5  = #100#21;

         #101#0 = #103#4;
         #101#1 = #103#5;
         |LEE 000#101=;
         |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

         #103#6  = #101#3;
         #103#7  = #101#2;
         #103#8  = #100#12;
         aAlfa   = #100#14;  |HAZ ComparaSiglas2;
         #103#9  = aAlfa;
         #103#10 = #100#18;
         #103#11 = #100#19;
         #103#12 = #101#6;
         #103#13 = #101#7;
         #103#14 = #101#4;
         #103#15 = #101#5;
         #103#16 = #100#17;
         |GRABA 020#103n;
         |LIBERA #103;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0004;
     #4#1;
     ;
     #100#0,  1;
     #100#0, 99;
     ;
     NULL, dsam0004;
|FIN;

|PROCESO ChequeoNifs;
     |ABRE #103;
     |ABRE #101;
     |SI #100#1 ! "            ";
         #103#0 = #100#1;
         |LEE 101#103=;
         |SI FSalida ! 0;
             |DDEFECTO #103;
             #103#0  = #100#1;
             #103#1  = #100#5;
             #103#2  = #100#15;
             #103#3  = #100#16;
             #103#4  = #100#20;
             #103#5  = #100#21;

             #101#0 = #103#4;
             #101#1 = #103#5;
             |LEE 000#101=;
             |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

             #103#6  = #101#3;
             #103#7  = #101#2;
             #103#8  = #100#12;
             aAlfa   = #100#14;  |HAZ ComparaSiglas2;
             #103#9  = aAlfa;
             #103#10 = #100#18;
             #103#11 = #100#19;
             #103#12 = #101#6;
             #103#13 = #101#7;
             #103#14 = #101#4;
             #103#15 = #101#5;
             #103#16 = #100#17;
             |GRABA 020#103n;
             |LIBERA #103;
         |FINSI;
     |FINSI;

     |SI #100#35 ! "            ";
         #103#0 = #100#35;
         |LEE 101#103=;
         |SI FSalida ! 0;
             |DDEFECTO #103;
             #103#0  = #100#35;
             #103#1  = #100#39;
             #103#2  = #100#45;
             #103#3  = #100#46;
             #103#4  = #100#50;
             #103#5  = #100#51;

             #101#0 = #103#4;
             #101#1 = #103#5;
             |LEE 000#101=;
             |SI FSalida ! 0;  |DDEFECTO #101;  |FINSI;

             #103#6  = #101#3;
             #103#7  = #101#2;
             #103#8  = #100#13;
             aAlfa   = #100#44;  |HAZ ComparaSiglas2;
             #103#9  = aAlfa;
             #103#10 = #100#48;
             #103#11 = #100#49;
             #103#12 = #101#6;
             #103#13 = #101#7;
             #103#14 = #101#4;
             #103#15 = #101#5;
             #103#16 = #100#47;
             |GRABA 020#103n;
             |LIBERA #103;
         |FINSI;
     |FINSI;

     |BUCLE dsam0004;

     |CIERRA #101;
     |CIERRA #103;
|FPRC;

|PROCESO ComparaSiglas;
    |QBF aAlfa;
    |SI aAlfa = "AL";  aAlfa = "ALAM ";  |FINSI;
    |SI aAlfa = "AD";  aAlfa = "ALDEA";  |FINSI;
    |SI aAlfa = "AP";  aAlfa = "APTOS";  |FINSI;
    |SI aAlfa = "AR";  aAlfa = "ARRAL";  |FINSI;
    |SI aAlfa = "AY";  aAlfa = "ARRY ";  |FINSI;
    |SI aAlfa = "AV";  aAlfa = "AVDA ";  |FINSI;
    |SI aAlfa = "BJ";  aAlfa = "BJADA";  |FINSI;
    |SI aAlfa = "BR";  aAlfa = "BRANC";  |FINSI;
    |SI aAlfa = "BO";  aAlfa = "BARRO";  |FINSI;
    |SI aAlfa = "BL";  aAlfa = "BLQUE";  |FINSI;
    |SI aAlfa = "CL";  aAlfa = "CALLE";  |FINSI;
    |SI aAlfa = "CJ";  aAlfa = "CLLJA";  |FINSI;
    |SI aAlfa = "CM";  aAlfa = "CMNO ";  |FINSI;
    |SI aAlfa = "CR";  aAlfa = "CTRA ";  |FINSI;
    |SI aAlfa = "CS";  aAlfa = "CSRIO";  |FINSI;
    |SI aAlfa = "CO";  aAlfa = "COL  ";  |FINSI;
    |SI aAlfa = "CN";  aAlfa = "CJTO ";  |FINSI;
    |SI aAlfa = "CT";  aAlfa = "CUSTA";  |FINSI;
    |SI aAlfa = "CH";  aAlfa = "CHLET";  |FINSI;
    |SI aAlfa = "ED";  aAlfa = "EDIFC";  |FINSI;
    |SI aAlfa = "EN";  aAlfa = "ENTD ";  |FINSI;
    |SI aAlfa = "ES";  aAlfa = "ESCAL";  |FINSI;
    |SI aAlfa = "EX";  aAlfa = "EXPLA";  |FINSI;
    |SI aAlfa = "EM";  aAlfa = "EXTRM";  |FINSI;
    |SI aAlfa = "ER";  aAlfa = "EXTRR";  |FINSI;
    |SI aAlfa = "GL";  aAlfa = "GTA  ";  |FINSI;
    |SI aAlfa = "GV";  aAlfa = "G.V. ";  |FINSI;
    |SI aAlfa = "GR";  aAlfa = "GRUPO";  |FINSI;
    |SI aAlfa = "JR";  aAlfa = "JDIN ";  |FINSI;
    |SI aAlfa = "LG";  aAlfa = "LUGAR";  |FINSI;
    |SI aAlfa = "MS";  aAlfa = "MASIA";  |FINSI;
    |SI aAlfa = "MC";  aAlfa = "MERC ";  |FINSI;
    |SI aAlfa = "MT";  aAlfa = "MONTE";  |FINSI;
    |SI aAlfa = "ML";  aAlfa = "MUELL";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PQ";  aAlfa = "PQUE ";  |FINSI;
    |SI aAlfa = "PD";  aAlfa = "PTDA ";  |FINSI;
    |SI aAlfa = "PJ";  aAlfa = "PSAJE";  |FINSI;
    |SI aAlfa = "PS";  aAlfa = "PASEO";  |FINSI;
    |SI aAlfa = "PZ";  aAlfa = "PLAZA";  |FINSI;
    |SI aAlfa = "PB";  aAlfa = "PBDO ";  |FINSI;
    |SI aAlfa = "PG";  aAlfa = "POLIG";  |FINSI;
    |SI aAlfa = "PR";  aAlfa = "PROL ";  |FINSI;
    |SI aAlfa = "PT";  aAlfa = "PNTE ";  |FINSI;
    |SI aAlfa = "PU";  aAlfa = "PTA  ";  |FINSI;
    |SI aAlfa = "RM";  aAlfa = "RAMAL";  |FINSI;
    |SI aAlfa = "RB";  aAlfa = "RBLA ";  |FINSI;
    |SI aAlfa = "RP";  aAlfa = "RAMPA";  |FINSI;
    |SI aAlfa = "RR";  aAlfa = "RIERA";  |FINSI;
    |SI aAlfa = "RC";  aAlfa = "RCON ";  |FINSI;
    |SI aAlfa = "RD";  aAlfa = "RONDA";  |FINSI;
    |SI aAlfa = "RU";  aAlfa = "RUA  ";  |FINSI;
    |SI aAlfa = "SC";  aAlfa = "SECT ";  |FINSI;
    |SI aAlfa = "SD";  aAlfa = "SENDA";  |FINSI;
    |SI aAlfa = "SB";  aAlfa = "SBIDA";  |FINSI;
    |SI aAlfa = "TO";  aAlfa = "TRRNT";  |FINSI;
    |SI aAlfa = "TR";  aAlfa = "TRVA ";  |FINSI;
    |SI aAlfa = "UR";  aAlfa = "URB  ";  |FINSI;
    |SI aAlfa = "VI";  aAlfa = "VIA  ";  |FINSI;
    |SI aAlfa = "VP";  aAlfa = "VIA  ";  |FINSI;
|FPRC;

|PROCESO MiraSiglas;
     aAlfa = #100#14;  |HAZ ComparaSiglas;  #100#14 = aAlfa;
     aAlfa = #100#24;  |HAZ ComparaSiglas;  #100#24 = aAlfa;
     aAlfa = #100#44;  |HAZ ComparaSiglas;  #100#44 = aAlfa;
|FPRC;

|PROGRAMA;
     |BLIN 04;

     |ABRE #0;
     #0#0 = enEmpresa;
     |LEE 040#0=;
     |SI FSalida ! 0;  |DDEFECTO #0;  |FINSI;
     |CIERRA #0;

     |ABRE #100;
     #100#0 = enEmpresa;
     |LEE 101#100=;
     |SI FSalida ! 0;
         |HAZ CargaDatosFam;

         |GRABA 020#100b;
     |FINSI;

     |HAZ MiraSiglas;

     |SI #100#1 ! #0#3; |Y #100#1 ! "            "; |Y #0#3 ! "            ";
         |HAZ CargaDatosFam;
     |FINSI;

     |PINPA #0#200;
     |PINDA #0#200;

     |CONTROL_SIMPLE 0, "BOTON, <F2> DATOS DECLARANTE", 0820, 0960, ProcesoF2;
     nBotonF2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, <F3> DATOS CONYUGE", 1120, 1260, ProcesoF3;
     nBotonF3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, <F4> DATOS FAMILIARES", 1420, 1560, ProcesoF4;
     nBotonF4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, <F5> MODALIDAD SOLICITUD, ASIGNACIONES, DATOS BANCARIOS, DOMICILIO DE ENVIO", 1720, 1860, ProcesoF5;
     nBotonF5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON, <ESC> SALIR", 2265, 2279, BotonEsc;
     nBotonEsc = FSalida;

     aEsc     = &255 + "806";
     aF2      = &255 + "824";
     aF3      = &255 + "825";
     aF4      = &255 + "826";
     aF5      = &255 + "827";
     aF6      = &255 + "828";
     aF7      = &255 + "829";

     |PARA; |SI;  |HACIENDO;
         #200#0 = #100#5;    |PINTA #200#0;
         #200#1 = #100#39;   |PINTA #200#1;

         |SI #100#6 ! "C";
             |ESTADO_CONTROL nBotonF3, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonF3, "ENABLE";
         |FINSI;

         |LEETECLA aTecla;
         |SI aTecla = aEsc;
            nError = 0;
            |SI nError = 0;  |SAL;  |FINSI;
         |FINSI;

         |SI aTecla = aF2; |HAZ ProcesoF2;  |FINSI;
         |SI aTecla = aF3; |HAZ ProcesoF3;  |FINSI;
         |SI aTecla = aF4; |HAZ ProcesoF4;  |FINSI;
         |SI aTecla = aF5; |HAZ ProcesoF5;  |FINSI;
     |SIGUE;

     |SI enModo ! 4;
         |GRABA 020#100a;
     |FINSI;

     |LIBERA #100;
     |CIERRA #100;

     |HAZ ChequeoNifs;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBotonF2;
     |FIN_CONTROL_WINDOWS nBotonF3;
     |FIN_CONTROL_WINDOWS nBotonF4;
     |FIN_CONTROL_WINDOWS nBotonF5;
     |FIN_CONTROL_WINDOWS nBotonF6;
     |FIN_CONTROL_WINDOWS nBotonF7;
     |FIN_CONTROL_WINDOWS nBotonEsc;

     |PULSATECLA;
|FPRO;
