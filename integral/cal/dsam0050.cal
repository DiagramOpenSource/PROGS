|FICHEROS;
     dsam0050 #50;
     dsam0051 #51,MANTE;
     dsam0052 #52;
|FIN;

|VARIABLES;
     &eaVarDni   = "";
     &enCalcCif  = 0;

     aAlfa      = "";

     nModo      = 0;

     {-1} aMenu = "";
     aMenu1     = "2400";
     aMenu2     = "1";
     aMenu3     = "Elija Opcion : ";
     aMenu4     = "ACF";
     aMenu5     = "  Actividades  ";
     aMenu6     = "  Conceptos contratados ";
     aMenu7     = "  datos Ficha ";
|FIN;

|PROCESO LetraDnim50;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni  = #50Campo;
         enCalcCif = 1;
         |HAZ CalculoDNI;
         #50Campo = eaVarDni;
         |PINTA #50Campo;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #50Campo;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "             ") % 112;
     |SI #50Campo ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #50Campo = eaVarDni;  |PINTA #50Campo;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo;
     |SI #50#28 = 1; #50#29 = "CONTRATO"; |FINSI;
     |SI #50#28 = 2; #50#29 = "SERVICIO"; |FINSI;
     |PINTA #50#29;
|FPRC;

|RUTINA ClaveBaja51;
     #51#0 = #50#0;
     #51#1 = 01;
|FRUT;

|RUTINA ClaveAlta51;
      #51#0 = #50#0;
      #51#1 = 99;
|FRUT;

|PROCESO Actividades;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#51, -2, 4, 22, 1, ClaveBaja51, ClaveAlta51;
     |POPV;
|FPRC;

|RUTINA ClaveBaja52;
     #52#0 = #50#0;
     #52#1 = 01;
|FRUT;

|RUTINA ClaveAlta52;
      #52#0 = #50#0;
      #52#1 = 99;
|FRUT;

|PROCESO Conceptos;
     |PUSHV 0501 2380;
     |ENTLINEAL #1#52, -2, 4, 22, 1, ClaveBaja52, ClaveAlta52;
     |POPV;
|FPRC;

|PROCESO DFicha;
     |PUSHV 0501 2380;
     |BLANCO 1009 1964;
     |CUADRO 1009 1964;

     |ATRI R;
     |PINTA 1110, "Fecha, hora y usuario que se dio de baja al cliente. ";
     |PINTA 1210, "Esta informacion estara disponible en aquellas fichas";
     |PINTA 1310, "borradas a partir de la version 02.03.108            ";
     |ATRI r;

     |PINTA 1410, "----------------------------------------------------";

     |PINTA 1520, "Fecha ..: ";
     |PINTA 1620, "Hora ...: ";
     |PINTA 1720, "Usuario : ";

     |PINTA 1529, #50#38;
     |PINTA 1629, #50#39;
     |PINTA 1729, #50#37;

     |PAUSA;

     |POPV;
|FPRC;

|PROCESO Tipo20;  |TIPO 20;
     nModo = (FEntrada / 100) ! 0;

     aAlfa = FSalida;

     |SI aAlfa = "OPCION";
         FSalida = "Mas Datos";
         |ACABA;
     |FINSI;

     |PARA;  |SI;  |HACIENDO;
          |MENU aMenu;
          aMenu2 = FSalida;
          |SI aMenu2 = "1";  |HAZ Actividades;  |FINSI;
          |SI aMenu2 = "2";  |HAZ Conceptos;    |FINSI;
          |SI aMenu2 = "3";  |HAZ DFicha;       |FINSI;
          |SI aMenu2 ! "1";  |Y aMenu2 ! "2";  |SAL;  |FINSI;
     |SIGUE;
|FPRC;
