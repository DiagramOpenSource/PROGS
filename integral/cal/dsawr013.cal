|FICHEROS;
    dsam0000;
    dsam0025;

    dsaw0013,MANTE;
    dsat0006;
    dsat0007;
|FIN;

|VARIABLES;
     aAlfa       = "";
     aAlfa1      = "";
     nPara1      = 0;
     nBoton1     = 0;
     nBoton2     = 0;
     nBoton3     = 0;
     nBoton4     = 0;
     nBoton5     = 0;
     nBoton6     = 0;
     nBoton8     = 0;
     nTecla      = 0;
     nAlgun      = 0;
     nOp         = 0;
     nNoPregunta = 0;
     aDMarca     = "";
     aHMarca     = "";
     informe     = "";
     inform1     = "dsat0006";
     inform2     = "dsat1006";
     nSw         = 0;
     nSw03       = 0;
     aFichero    = "";
     nPrint      = 0;
     nGraba      = 0;

     nCamImp = 0;
     nCamCom = 0;
     &enImporte = 0;
     &enCuota   = 0;

     &eaTipoImp  = "";
     &eaFichero  = "";
     &eaFicher1  = "";
     &enEjer = 0;
     &enEmpresa = 0;
     &enEmpPD = 0;
     &aFuncion = "";
     &enNoPregunta = 0;
     &eaDLiqu    = "";
     &eaHLiqu    = "";
     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDAgente  = 0;
     &enHAgente  = 0;
     &enDConve   = 0;
     &enHConve   = 0;
     &enTotal1   = 0;
     &enTotal2   = 0;
     &eaTitul1  = "";
     &eaTitul2  = "";
|FIN;

|| ////////////////////////////////////
|PROCESO Boton1;
     |PTEC 824;
|FPRC;

|PROCESO Boton2;
     |PTEC 825;
|FPRC;

|PROCESO Boton3;
     |PTEC 826;
|FPRC;

|PROCESO Boton4;
     |PTEC 827;
|FPRC;

|PROCESO Boton5;
     |PTEC 828;
|FPRC;

|PROCESO Boton6;
     |PTEC 829;
|FPRC;

|PROCESO Boton8;
     |PTEC 830;
|FPRC;

|PROCESO Tipo0;  |TIPO 0;
     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton8;
     |PULSATECLA;
|FPRC;

|| **********************************************************************
|RUTINA ClaveBaja001;
     #dsat0006#0  = enDEmpresa;
     #dsat0006#1  = #dsaw0013#1;
     #dsat0006#2  = enDConve;
     #dsat0006#3  = #dsaw0013#2;
|FRUT;

|RUTINA ClaveAlta001;
     #dsat0006#0  = enHEmpresa;
     #dsat0006#1  = #dsaw0013#1;
     #dsat0006#2  = enHConve;
     #dsat0006#3  = #dsaw0013#2;
|FRUT;

|PROCESO Tipo7;  |TIPO 7;

     |PINTA 0715, #dsaw0013#2;

     |ENTLINEAL #1#dsat0006, -4, 7, 22, 0, ClaveBaja001, ClaveAlta001;

     |BLIN 04;

     |CONTROL_SIMPLE 0, "LBOTON,F2 Entrada al Lineal", 1009, 1025, Boton1;
     nBoton1 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3 Inf.Clientes CON Importe", 1027, 1045, Boton2;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F4 Inf.Clientes SIN Importe", 1127, 1145, Boton3;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F5 Marcar Todos", 1046, 1061, Boton4;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F6 Desmarcar Todos", 1146, 1161, Boton5;
     nBoton5 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F7 Borrar Emp. Colab.", 1063, 1078, Boton6;
     nBoton6 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F8 Actualizar datos ", 1163, 1178, Boton8;
     nBoton8 = FSalida;

|FPRC;

|| //////////////////////////////////////////////////////////////
|PROCESO Infordsat0006;
   nPrint = 0;
   |SI nTecla = 12;
       |SI #dsat0006#8 = 0; |Y eaTipoImp ! "R";
           nPrint = 1;
       |FINSI;
       |SI #dsat0006#9 = 0; |Y eaTipoImp ! "P";
           nPrint = 1;
       |FINSI;
   |FINSI;
   |SI nTecla = 11;
       |SI #dsat0006#8 ! 0; |Y eaTipoImp ! "R";
           nPrint = 1;
       |FINSI;
       |SI #dsat0006#9 ! 0; |Y eaTipoImp ! "P";
           nPrint = 1;
       |FINSI;
   |FINSI;

   |SI nPrint = 1;
       |SI eaTipoImp ! "A";
           enImporte = #dsat0006#nCamImp#;
           enCuota   = #dsat0006#nCamCom#;
       |FINSI;
       |PRINT;
       nAlgun = 1;
   |FINSI;
|FPRC;

|PROCESO Marcadsat0006;
   #dsat0006#32 = aAlfa;
   |GRABA 020#dsat0006.a;
|FPRC;

|PROCESO Leedsat0006;
   |SI nOp = 0;
       |HAZ Marcadsat0006;
   |FINSI;

   |SI nOp = 1;
       |HAZ Infordsat0006;
   |FINSI;
   |LIBERA #dsat0006;
|FPRC;

|DEFBUCLE Leedsat0006;
   #dsat0006#1;
   ;
   #dsaw0013#1, #dsaw0013#2, enDEmpresa, enDConve;
   #dsaw0013#1, #dsaw0013#2, enHEmpresa, enHConve;
   e;
   NULL, Leedsat0006;
|FIN;
|| //////////////////////////////////////////////////////////////
|PROCESO LosInformes;
   nAlgun  = 0;
   |IMPRE 0;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;
   |SI nTecla = 11; informe = inform1; |FINSI;
   |SI nTecla = 12; informe = inform2; |FINSI;

   nCamImp = 8;
   nCamCom = 15;
   eaTitul1 = "IMPORTE POLIZA ";
   eaTitul2 = "Importe Poliza";
   |SI eaTipoImp = "R";
       eaTitul1 = "IMPORTE REGULARIZACION";
       eaTitul2 = "Importe Regul.";
       nCamImp = 9;
       nCamCom = 21;
   |FINSI;
   |SI eaTipoImp = "A";
       eaTitul1 = "IMPORTE POLIZA Y/O REGULARIZACION";
   |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;
       |MENAV "0000No existe informe";
       |FINIMP;
       |ACABA;
   |FINSI;

   nOp = 1; |BUCLE Leedsat0006;
   |SI nAlgun = 1;
       |PIEINF;
   |SINO;
       |SI nTecla = 11;
           aAlfa = "0000No existen Clientes con Comision calculada";
       |SINO;
           aAlfa = "0000No existen Clientes SIN Importes";
       |FINSI;
       |MENAV aAlfa;
   |FINSI;
   |FININF;
   |FINIMP;
|FPRC;

|PROCESO ActualM0025;

       #dsam0025#0 = #dsat0006#0;
       #dsam0025#1 = #dsat0006#1;
       #dsam0025#2 = #dsat0006#2;
       |LEE 141#dsam0025.=;
       |SI FSalida ! 0;
           |DDEFECTO #dsam0025;
           #dsam0025#0 = #dsat0006#0;
           #dsam0025#1 = #dsat0006#1;
           #dsam0025#2 = #dsat0006#2;
           |PARA nPara1 = 3; |SI nPara1 [ 27; |HACIENDO nPara1 = nPara1 + 1;
                 #dsam0025#nPara1#  = #dsat0006#nPara1#;
           |SIGUE;
           |GRABA 020#dsam0025.b;
       |FINSI;
       #dsam0025#12 = #dsat0006#12;
       |SI eaTipoImp ! "R";
           #dsam0025#8   = #dsat0006#8;
           #dsam0025#15  = #dsat0006#15;
       |FINSI;
       |SI eaTipoImp ! "P";
           #dsam0025#9   = #dsat0006#9;
           #dsam0025#21  = #dsat0006#21;
       |FINSI;

       |GRABA 020#dsam0025.a;
       |LIBERA  #dsam0025;
|FPRC;

|PROCESO GrabaDsat0007;
       #dsat0007#0  = aFuncion;
       #dsat0007#1  = #dsat0006#3;
       #dsat0007#2  = #dsat0006#1;
       #dsat0007#3  = #dsat0006#2;
       #dsat0007#4  = #dsat0006#0;
       #dsat0007#5  = #dsat0006#4;
       #dsat0007#6  = #dsat0006#28;
       #dsat0007#7  = #dsat0006#8;
       #dsat0007#8  = #dsat0006#12;
       #dsat0007#9  = #dsat0006#13;
       #dsat0007#10 = #dsat0006#15;
       #dsat0007#11 = #dsat0006#30;
       #dsat0007#12 = #dsat0006#31;
       #dsat0007#13 = #dsat0006#9;
       #dsat0007#14 = #dsat0006#21;
       #dsat0007#15 = #dsat0006#19;
       #dsat0007#16 = #dsat0006#25;

       nGraba = 0;
       |SI #dsat0006#13 ! "S"; |Y eaTipoImp ! "R"; |Y #dsat0006#15 ! 0;
           nGraba = 1;
       |FINSI;
       |SI #dsat0006#19 ! "S"; |Y eaTipoImp ! "P"; |Y #dsat0006#21 ! 0;
           nGraba = 1;
       |FINSI;
       #dsat0007#17 = #dsat0006#13;
       #dsat0007#18 = #dsat0006#19;

       |SI nGraba = 1;
           |SI #dsat0007#17 ! "S"; enTotal1 = enTotal1 + #dsat0007#10; |FINSI;
           |SI #dsat0007#18 ! "S"; enTotal2 = enTotal2 + #dsat0007#14; |FINSI;
           |GRABA 020#dsat0007.n;
           nSw03 = 1;
       |FINSI;
|FPRC;

|PROCESO Actualiza;
   |SI nOp = 0;
       #dsam0000#0 = #dsat0006#4;
       |LEE 141#dsam0000.=;
       |SI FSalida = 0;
           #dsam0000#123 = "S";
           |GRABA 020#dsam0000.a;
       |FINSI;
       |LIBERA #dsam0000;

       |HAZ ActualM0025;

       |HAZ GrabaDsat0007;

   |FINSI;

   |SI nOp ! 2;
      |BORRA 020#dsat0006.a;
   |FINSI;

   |SI nOp = 2;  nSw = 1;  |FINSI;

   |LIBERA #dsat0006;
|FPRC;

|DEFBUCLE Actualiza;
   #dsat0006#1;
   32;
   #dsaw0013#1, #dsaw0013#2, enDEmpresa, enDConve, aDMarca;
   #dsaw0013#1, #dsaw0013#2, enHEmpresa, enHConve, aHMarca;
   be;
   NULL, Actualiza;
|FIN;

|PROCESO Tipo11;  |TIPO 11;
     nTecla = FSalida;
     |FIN_CONTROL_WINDOWS nBoton1;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |FIN_CONTROL_WINDOWS nBoton6;
     |FIN_CONTROL_WINDOWS nBoton8;
     |PULSATECLA;

     enEjer  = #dsaw0013#1;
     enEmpPD = #dsaw0013#2;
     nNoPregunta = 0;

     |SI nTecla =  10;
         |ENTLINEAL #1#dsat0006, -4, 4, 22, 0, ClaveBaja001, ClaveAlta001;
         |SI FSalida = 0;
             |SI enNoPregunta = 0;
                 |CONFI "0000SDesea actualizar los datos Introducidos";
                 |SI FSalida = 0;
                     nTecla = 16;
                     nNoPregunta = 1;
                 |FINSI;
             |SINO;
                 |ERROR;
             |FINSI;
         |FINSI;
         enNoPregunta = 0;
     |FINSI;

     |SI nTecla = 16;

         |LEE 041#dsaw0013.=;

         |SI nNoPregunta = 0;
             |CONFI "    NEsta Seguro de Actualizar los Datos introducidos ";
             |SI FSalida ! 0;  |ACABA;  |FINSI;
         |FINSI;

         nSw03    = 0;
         aFichero = ("4x" + Usuario) % 108;
         |NOME_DAT #dsat0007#aFichero#
         |DELINDEX #dsat0007;

         enTotal1 = 0;
         enTotal2 = 0;
         aDMarca = "*";
         aHMarca = "*";
         |ABRE #dsat0007;
         |ABRE #dsam0000;
         |ABRE #dsam0025;
         nOp = 0; |BUCLE Actualiza;
         |CIERRA #dsam0025;
         |CIERRA #dsam0000;
         |CIERRA #dsat0007;

         nSw     = 0;
         aDMarca = " ";
         aHMarca = " ";
         nOp = 2; |BUCLE Actualiza;
         |SI nSw = 0;
             |BORRA 020#dsaw0013.a;
         |FINSI;

         |SI nSw03 = 1;
             |CONFI "0000SLiquidar comisiones";
             |SI FSalida = 0;
                 eaFicher1 = eaFichero;
                 |SUB_EJECUTA_NP ":integral/dsaz0036;Auto";
                 eaFichero = eaFicher1;
             |FINSI;
         |FINSI;
         |DELINDEX #dsat0007;

         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";

     |FINSI;

     |SI nTecla = 11; |O nTecla = 12;
         |HAZ LosInformes;
     |FINSI;

     |SI nTecla = 13; |O nTecla = 14;
         aAlfa = "*";
         |SI nTecla = 14; aAlfa = " "; |FINSI;

         nOp = 0; |BUCLE Leedsat0006;

         |ENTLINEAL #1#dsat0006, -4, 7, 22, 0, ClaveBaja001, ClaveAlta001;

         |PONCONTROL  23, "SI";
     |FINSI;

     |SI nTecla = 15;

         |LEE 041#dsaw0013.=;

         |CONFI "    NEsta Seguro de borrar las modificaciones introducidas de esta Empresa";
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         aDMarca = " ";
         aHMarca = "*";
         nOp = 1; |BUCLE Actualiza;

         |BORRA 020#dsaw0013.a;
         |PTEC 809;
         |PTEC 808;
         |PONCONTROL  23, "SI";
     |FINSI;
|FPRC;
