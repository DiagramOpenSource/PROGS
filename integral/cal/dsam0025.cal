|FICHEROS;
     :/integral/def/dsam0025,MANTE;
     :/integral/def/dsam0000;
     :/integral/def/dsam0125;
     :/integral/def/dsam0126;

     :laboral/nomconve;
     :laboral/nomconca;

     dsam025@;
|FIN;

|VARIABLES;
     nModo       = 0;
     nInkey      = 0;
     aAlfa       = "";
     nNume1      = 0;
     aDef        = "";
     aBase       = "";
     nDConve     = 0;
     nHConve     = 0;
     nHEjer      = 0;
     aPath       = "";
     nCanal      = 0;
     nOpe        = 0;
     nPara1      = 0;
     nSw         = 0;

     &enEmpresa      = 0;
     &eaPathLaboral  = "";
|FIN;

|PROCESO Tipo7m0025; |TIPO 7;
   |PINTA 1471, "        ";
   |PINTA 1575,     "    ";
|FPRC;

|PROCESO DConvenio;
    eaPathLaboral = "";
    |DBASS aBase;
    aAlfa = aBase + "laboral/def/labempre.mas";

    |XABRE "E", aAlfa, nCanal;
     |SI FSalida ] 0;
         eaPathLaboral   = aBase + "laboral/";
     |SINO;
         |MENAV "0000No existe laboral";
         |ACABA;
     |FINSI;

    aPath = eaPathLaboral + "fich/";
    |PATH_DAT #nomconca#aPath#;

    |ABRE #nomconca;
    #nomconca#0 = #dsam0025#2;
    |SI nOpe = 1;
        |CONSULTA_CLAVE #1#nomconca;
        #dsam0025#2  = #nomconca#0;
        #dsam0025#25 = #nomconca#1;
        |PINTA #dsam0025#2;
    |SINO;
        |LEE 041#nomconca.=;
        |SI FSalida ! 0;
            |MENAV "0000No existe Convenio";
            |ERROR;
        |SINO;
             #dsam0025#25 = #nomconca#1;
        |FINSI;
    |FINSI;
    |CIERRA #nomconca;
    |PINTA #dsam0025#25;
|FPRC;

|PROCESO Tipo11m0025; |TIPO 11;
   nInkey = FSalida;

   aAlfa = "N";
   |SI nInkey = 10;
       nOpe = 1;
       |HAZ DConvenio;
       |ACABA;
   |FINSI;

   |SI nInkey = 13;
       |ATRI R;
       |PINTA 1471, "Modifica";
       |PINTA 1575,     "TODO";
       |ATRI 0;
       aAlfa = "S";
       |ERROR;
       |PTEC 802;
       |PTEC 802;
   |FINSI;

   |PARA nPara1 = 13; |SI nPara1 [ 24; |HACIENDO nPara1 = nPara1 + 1;
         |C_M #dsam0025#nPara1#,1,aAlfa;
   |SIGUE;
|FPRC;

|PROCESO LeoEspejo25;
   #dsam0025#3 = #dsam025@#3;
   #dsam0025#4 = #dsam025@#4;
   #dsam0025#5 = #dsam025@#5;
   #dsam0025#6 = #dsam025@#6;
   #dsam0025#7 = #dsam025@#7;
   |SI #dsam0025#2  = #dsam025@#3; |Y #dsam025@#1 = nHEjer;
       #dsam0025#8  = #dsam025@#8 + #dsam0025#9;
       #dsam0025#9  = 0;
       #dsam0025#10 = #dsam025@#11;
       #dsam0025#11 = #dsam025@#11;
   |FINSI;
   #dsam0025#12 = #dsam025@#12;
   #dsam0025#26 = #dsam025@#26;
   #dsam0025#27 = #dsam025@#27;
   nSw = 1;
|FPRC;

|DEFBUCLE LeoEspejo25;
  #dsam025@#1003;
  ;
  enEmpresa, 2000,   nDConve;
  enEmpresa, nHEjer, nHConve;
  e;
  NULL, LeoEspejo25;
|FIN;

|PROCESO IgualCampos25;

   |DBASE aBase;
   aDef = aBase + "def/dsam0025";
   |CARGA_DEF aDef, dsam025@;
   |SI FSalida = 0;
       nSw     = 0;
       nDConve = #dsam0025#2;
       nHConve = #dsam0025#2;
       nHEjer  = #dsam0025#1 - 1;
       |BUCLE LeoEspejo25;
       |SI nSw = 0;
           nDConve = 001;
           nHConve = 999;
           nHEjer  = #dsam0025#1;
           |BUCLE LeoEspejo25;
       |FINSI;

       |DESCARGA_DEF #dsam025@;
       |PINDA #0#dsam0025;
   |FINSI;
|FPRC;

|PROCESO LeeEmpSeguro; |TIPO 0;

   aAlfa = Contenido;
   nNume1 = aAlfa;

   |ABRE #dsam0125;
   #dsam0125#0 = #dsam0025#3;
   |LEE 041#dsam0125.=;
   |SI FSalida ! 0;
       |MENAV "0000No existe Empresa de Proteccion de Datos";
       |ERROR;
   |SINO;
       #dsam0025#4 = #dsam0125#2; |PINTA #dsam0025#4;
       |SI nModo = 1; |O nNume1 ! #dsam0025#3;
           #dsam0025#12 = #dsam0125#8; |PINTA #dsam0025#12;
       |FINSI;
   |FINSI;
   |CIERRA #dsam0125;
|FPRC;

|PROCESO Tipo0m0025; |TIPO 0;
   nModo = (FEntrada / 100) ! 0;
   nOpe = 0;
   |HAZ DConvenio;
   |SI nModo = 1;
       |HAZ IgualCampos25;
   |FINSI;
|FPRC;
