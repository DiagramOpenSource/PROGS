|FICHEROS;
     dsay0005 #0;
     dsam0000 #1;
     :/basica/def/agitab04 #2;
     :/basica/def/agicen14 #114;
|FIN;

|VARIABLES;
     nCampo   = 0;
     nSwHay   = 0;

     aDFecha  = "";
     aHFecha  = "";

     &enLinea = 0;
|FIN;

|PROCESO Actividad;
     |C_M #0#18, 1, "S";
     |SI #0#17 = "N";
         |C_M #0#18, 1, "N";  #0#18 = 0;  |PINTA #0#18;
     |FINSI;
|FPRC;

|PROCESO Seleccion;
     |SI #0#2 = "D";
         |C_M #0#3, 1, "S";
         |C_M #0#4, 1, "S";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#3, 1, "N";  #0#3 = 0;      |PINTA #0#3;
         |C_M #0#4, 1, "N";  #0#4 = 99;     |PINTA #0#4;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";  |PINTA #0Campo;
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S"; |PINTA #0Campo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO agicen14;
     |SI #0#18 ! 0;
          |SI #114#5 > "01.01.0000";
              |SI #114#5 > aHFecha;  |ACABA;  |FINSI;
          |FINSI;

          |SI #114#6 > "01.01.0000";
              |SI #114#6 < aDFecha;  |ACABA; |FINSI;
          |FINSI;
     |FINSI;

     enLinea = 2;  |PRINT;
|FPRC;

|DEFBUCLE agicen14;
     #114#1;
     ;
     #1#0, 01;
     #1#0, 99;
     ;
     NULL, agicen14;
|FIN;

|PROCESO Imprimelos;
     enLinea = 1;  |PRINT;

     |SI #0#17 = "S";
         |BUCLE agicen14;
     |FINSI;

     nSwHay = 1;
|FPRC;

|DEFBUCLE dsam0000;
     #1#1;
     9;
     #0#0, #2#0;
     #0#1, #2#0;
     ;
     NULL, Imprimelos;
|FIN;

|PROCESO MiraClientes;
     nSwHay = 0;
     |BUCLE dsam0000;
     |SI nSwHay = 1;  |PIEINF;  |FINSI;
|FPRC;

|DEFBUCLE agitab04;
     #2#1;
     ;
     #0#3;
     #0#4;
     ;
     NULL, MiraClientes;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #0#18 ! 0;
         aDFecha = "01.01." + #0#18;
         aHFecha = "31.12." + #0#18;
     |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dsay0005";
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI #0#2 = "D";
         |BUCLE agitab04;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   #0#3 = #0nCampo;
                   #0#4 = #0nCampo;
                   |BUCLE agitab04;
               |FINSI;
         |SIGUE;
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
