|FICHEROS;
     :integral/dsam0000;
     :integral/dsam0002;
     :integral/dsam0003;
     :integral/dsam0005;
     :integral/dsam0007;
     :integral/dsam0008;
     :integral/dsam0009;
     :integral/dsam0010;
     :integral/dsam0012;
     :integral/dsam0107;
     :integral/dsam0116;

     :integral/dsaw0003;
     :integral/dsaw0007;
|FIN;

|VARIABLES;
  &eaCliNif = "";
|FIN;

|INCLUYE dsxz002v;

|PROCESO A0200;
     enActividad  = 0;

     |SUB_EJECUTA_NP ":integral/dsam0005";

     #dsam0000#0 = eaOpcion2;
     |LEE 101#dsam0000.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dsam0005;
     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#19  = #dsam0005#3;   #dsam0000#20  = #dsam0005#4;
         #dsam0000#21  = #dsam0005#5;   #dsam0000#22  = #dsam0005#6;
         #dsam0000#23  = #dsam0005#7;   #dsam0000#24  = #dsam0005#8;
         #dsam0000#25  = #dsam0005#9;   #dsam0000#26  = #dsam0005#10;
         #dsam0000#27  = #dsam0005#11;  #dsam0000#28  = #dsam0005#12;
         #dsam0000#98  = #dsam0005#17;  #dsam0000#99  = #dsam0005#18;
         #dsam0000#86  = #dsam0005#15;  #dsam0000#87  = #dsam0005#16;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 98;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#29 = #dsam0005#3;    #dsam0000#30 = #dsam0005#4;
         #dsam0000#31 = #dsam0005#5;    #dsam0000#32 = #dsam0005#6;
         #dsam0000#33 = #dsam0005#7;    #dsam0000#34 = #dsam0005#8;
         #dsam0000#35 = #dsam0005#9;    #dsam0000#36 = #dsam0005#10;
         #dsam0000#37 = #dsam0005#11;   #dsam0000#38 = #dsam0005#12;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 99;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#39 = #dsam0005#3;   #dsam0000#40 = #dsam0005#4;
         #dsam0000#41 = #dsam0005#5;   #dsam0000#42 = #dsam0005#6;
         #dsam0000#43 = #dsam0005#7;   #dsam0000#44 = #dsam0005#8;
         #dsam0000#45 = #dsam0005#9;   #dsam0000#46 = #dsam0005#10;
         #dsam0000#47 = #dsam0005#11;  #dsam0000#48 = #dsam0005#12;

         |ABRE #dsam0003;
         #dsam0003#0 = #dsam0000#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             #dsam0003#24 = #dsam0000#39;
             #dsam0003#25 = #dsam0000#40;
             #dsam0003#26 = #dsam0000#41;
             #dsam0003#27 = #dsam0000#42;
             #dsam0003#28 = #dsam0000#43;
             #dsam0003#29 = #dsam0000#44;
             #dsam0003#30 = #dsam0000#45;
             #dsam0003#31 = #dsam0000#46;
             #dsam0003#32 = #dsam0000#47;
             #dsam0003#33 = (("00" + #dsam0003#30) % -102) + (("000" + #dsam0003#31) % -103);
             |GRABA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;
     |CIERRA #dsam0005;

     |GRABA 020#dsam0000.a;
     |LIBERA #dsam0000;
|FPRC;

|PROCESO Baja107;
     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 01;
|FPRC;

|PROCESO Alta107;
     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 99;
|FPRC;

|PROCESO A0300;
     |ENTLINEAL #1#dsam0107, -2, enModo, 22, 1, Baja107, Alta107;

     #dsam0000#0 = eaOpcion2;
     |LEE 101#dsam0000.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ABRE #dsam0107;

     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 1;
     |LEE 000#dsam0107.=;
     |SI FSalida = 0;
         #dsam0000#54 = #dsam0107#4;
     |FINSI;

     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 2;
     |LEE 040#dsam0107.=;
     |SI FSalida = 0;
         #dsam0000#55 = #dsam0107#4;
     |FINSI;

     |CIERRA #dsam0107;

     |GRABA 020#dsam0000.a;
     |LIBERA #dsam0000;
|FPRC;

|PROCESO A0400;
     |SUB_EJECUTA_NP ":integral/dsaw0200";

     #dsam0000#0 = eaOpcion2;
     |LEE 101#dsam0000.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsam0000#100 = eaNombre1;
     #dsam0000#101 = eaNombre2;
     #dsam0000#102 = eaNombre3;

     |GRABA 020#dsam0000.a;
     |LIBERA #dsam0000;
|FPRC;

|PROCESO A0501;
     #dsam0000#0 = eaOpcion2;
     |LEE 101#dsam0000.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     #dsaw0003#0  = #dsam0000#88;
     #dsaw0003#1  = #dsam0000#89;
     #dsaw0003#2  = #dsam0000#90;
     #dsaw0003#3  = #dsam0000#91;
     #dsaw0003#4  = #dsam0000#92;
     #dsaw0003#5  = #dsam0000#93;
     #dsaw0003#6  = #dsam0000#104;
     #dsaw0003#7  = #dsam0000#94;
     #dsaw0003#8  = #dsam0000#73;
     #dsaw0003#9  = #dsam0000#74;
     #dsaw0003#10 = #dsam0000#95;
     #dsaw0003#11 = #dsam0000#96;
     #dsaw0003#12 = #dsam0000#97;
     #dsaw0003#13 = #dsam0000#103;
     #dsaw0003#14 = #dsam0000#4;
     #dsaw0003#15 = #dsam0000#70;
     #dsaw0003#16 = #dsam0000#71;

     |ABRE #dsam0116;
     #dsam0116#0 = #dsaw0003#0;
     |LEE 000#dsam0116.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0116;  |FINSI;
     |CIERRA #dsam0116;

     #dsaw0003#17 = #dsam0116#5;
     #dsaw0003#18 = #dsam0000#111;
     #dsaw0003#19 = #dsam0000#112;
     #dsaw0003#20 = #dsam0000#114;
     #dsaw0003#21 = #dsam0000#115;
     #dsaw0003#22 = #dsam0000#116;
     #dsaw0003#23 = #dsam0000#118;
     #dsaw0003#24 = #dsam0000#117;
     #dsaw0003#25 = #dsam0000#119;

     |PINPA #0#dsaw0003;
     |PINDA #0#dsaw0003;

     |ATRI I;
     |SI #dsaw0003#25 = "R";
        |PINTA 1769, "Recurrente";
     |SINO;
        |PINTA 1769, "Unico";
     |FINSI;
     |ATRI N;

     |SI enSwDSArchi = 1;
          |C_M #dsaw0003#18, 1, "S";
     |SINO;
          |C_M #dsaw0003#18, 1, "N";
          #dsaw0003#19 = "N"; |PINTA #dsaw0003#19;
     |FINSI;

     |SI enModo ! 4;
         |SI enModo = 2;
             |ENDATOS #2#dsaw0003;
         |SINO;
             |ENDATOS #1#dsaw0003;
         |FINSI;
         |SI FSalida = 0;
             #dsam0000#88  = #dsaw0003#0;
             #dsam0000#89  = #dsaw0003#1;
             #dsam0000#90  = #dsaw0003#2;
             #dsam0000#91  = #dsaw0003#3;
             #dsam0000#92  = #dsaw0003#4;
             #dsam0000#93  = #dsaw0003#5;
             #dsam0000#104 = #dsaw0003#6;
             #dsam0000#94  = #dsaw0003#7;
             #dsam0000#73  = #dsaw0003#8;
             #dsam0000#74  = #dsaw0003#9;
             #dsam0000#95  = #dsaw0003#10;
             #dsam0000#96  = #dsaw0003#11;
             #dsam0000#97  = #dsaw0003#12;
             #dsam0000#103 = #dsaw0003#13;
             #dsam0000#4   = #dsaw0003#14;
             #dsam0000#70  = #dsaw0003#15;
             #dsam0000#71  = #dsaw0003#16;
             #dsam0000#111 = #dsaw0003#18;
             #dsam0000#112 = #dsaw0003#19;
             #dsam0000#114 = #dsaw0003#20;
             #dsam0000#115 = #dsaw0003#21;
             #dsam0000#116 = #dsaw0003#22;
             #dsam0000#117 = #dsaw0003#24;
             #dsam0000#118 = #dsaw0003#23;
             #dsam0000#119 = #dsaw0003#25;

             |GRABA 020#dsam0000.a;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;
     |LIBERA #dsam0000;
|FPRC;

|PROCESO Baja9;
     #dsam0009#0 = #dsam0000#0;
     #dsam0009#1 = 001;
|FPRC;

|PROCESO Alta9;
     #dsam0009#0 = #dsam0000#0;
     #dsam0009#1 = 999;
|FPRC;

|PROCESO A0502;
     |MENAV "0000 Si no introducimos Bancos por modelo, al emitir el modelo el Banco sera el del punto primero";

     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0009, -2, 2, 22, 1, Baja9, Alta9;
     |SINO;
         |ENTLINEAL #1#dsam0009, -2, 4, 22, 1, Baja9, Alta9;
     |FINSI;
|FPRC;

|PROCESO Baja10;
     #dsam0010#0 = #dsam0000#0;
     #dsam0010#1 = 01;
|FPRC;

|PROCESO Alta10;
     #dsam0010#0 = #dsam0000#0;
     #dsam0010#1 = 99;
|FPRC;

|PROCESO A0503;
     |MENAV "0000 Si no introducimos bancos por facturacion, tomara en todas las empresas el Banco del punto primero";

     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0010, -2, 2, 14, 1, Baja10, Alta10;
     |SINO;
         |ENTLINEAL #1#dsam0010, -2, 4, 14, 1, Baja10, Alta10;
     |FINSI;
|FPRC;

|PROCESO dsam0012;
     nNume1 = #dsam0012#1 * 2;
     nNume2 = nNume1 + 1;
     nNume3 = #dsam0012#1 + 64;
     |SI #dsam0000#nNume3# = "S";
         #dsaw0007#nNume1# = #dsam0012#2;
         #dsaw0007#nNume2# = #dsam0012#3;
     |FINSI;

     |SI #dsam0012#1 = 2; nEstado12 = 1; |FINSI;
|FPRC;

|DEFBUCLE dsam0012;
     #dsam0012#1;
     ;
     #dsam0000#0, 1;
     #dsam0000#0, 5;
     ;
     NULL, dsam0012;
|FIN;

|PROCESO AltaAgenteArea;
     #dsam0012#0 = #dsam0000#0;
     #dsam0012#1 = nNume1;
     |LEE 141#dsam0012.=;
     nEstado12 = FSalida;
     nNume3 = 64 + nNume1;
     |SI #dsam0000#nNume3# = "N";
         |SI nEstado12 = 0;
             |BORRA 020#dsam0012.a;
         |FINSI;
     |SINO;
         #dsam0012#4 = "Fiscal";
         |SI #dsam0012#1 = 1; #dsam0012#4 = "Contabilidad"; |FINSI;
         |SI #dsam0012#1 = 3; #dsam0012#4 = "Sociedades  "; |FINSI;
         |SI #dsam0012#1 = 4; #dsam0012#4 = "Renta       "; |FINSI;
         |SI #dsam0012#1 = 5; #dsam0012#4 = "Laboral     "; |FINSI;

         nNume2 = nNume1 * 2; #dsam0012#2 = #dsaw0007#nNume2#;
         nNume2 = nNume2 + 1; #dsam0012#3 = #dsaw0007#nNume2#;

         |SI nEstado12 = 0; |GRABA 020#dsam0012.a; |FINSI;
         |SI nEstado12 ! 0; |GRABA 020#dsam0012.n; |FINSI;
     |FINSI;
     |LIBERA #dsam0012;
|FPRC;

|PROCESO A0504;
     aPassword = "";
     |CUADRO 0801 2380;
     |BLANCO 0902 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>     ";
         |MENAV "     Permiso denegado.";
         |ACABA;
     |FINSI;

     #dsam0000#0 = eaOpcion2;
     |LEE 101#dsam0000.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |DDEFECTO #dsaw0007;
     #dsaw0007#0  = #dsam0000#72;
     #dsaw0007#1  = #dsam0000#52;

     nEstado12 = 0;
     |BUCLE dsam0012;

     aAlfa1 = #dsam0000#65; |C_M #dsaw0007#2,  1, aAlfa1; #dsaw0007#12 = #dsam0000#65;
     aAlfa1 = #dsam0000#66; |C_M #dsaw0007#4,  1, aAlfa1; #dsaw0007#13 = #dsam0000#66;
     aAlfa1 = #dsam0000#67; |C_M #dsaw0007#6,  1, aAlfa1; #dsaw0007#14 = #dsam0000#67;
     aAlfa1 = #dsam0000#68; |C_M #dsaw0007#8,  1, aAlfa1; #dsaw0007#15 = #dsam0000#68;
     aAlfa1 = #dsam0000#69; |C_M #dsaw0007#10, 1, aAlfa1; #dsaw0007#16 = #dsam0000#69;

     |SI nEstado12 = 0; |Y #dsaw0007#13 = "S";
         #dsaw0007#4 = #dsaw0007#0; #dsaw0007#5 = #dsaw0007#1;
     |FINSI;

     |PINPA #0#dsaw0007;
     |PINDA #0#dsaw0007;

     |SI enModo ! 4;
         |SI enModo = 2;
             |ENDATOS #2#dsaw0007;
         |SINO;
             |ENDATOS #1#dsaw0007;
         |FINSI;
         |SI FSalida = 0;
             #dsam0000#72  = #dsaw0007#0;
             #dsam0000#52  = #dsaw0007#1;

             |ABRE #dsam0012;
             |PARA nNume1 = 1; |SI nNume1 [ 5; |HACIENDO nNume1 = nNume1 + 1;
                   |HAZ AltaAgenteArea;
             |SIGUE;
             |CIERRA #dsam0012;
             |GRABA 020#dsam0000.a;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;

     |LIBERA #dsam0000;
|FPRC;

|PROCESO A0505;
     |SUB_EJECUTA_NP ":integral/dsam0020";
|FPRC;

|PROCESO A0601;
     |SUB_EJECUTA_NP ":basica/agicen14";
|FPRC;

|PROCESO A0602;
     |SUB_EJECUTA_NP ":basica/agicen20";
|FPRC;

|PROCESO A0603;
     |SUB_EJECUTA_NP ":basica/agicen15";
|FPRC;

|PROCESO A0604;
     |SUB_EJECUTA_NP ":basica/agicen16";
|FPRC;

|PROCESO A0701;
     eaCliNif = #dsam0000#3;
     |SUB_EJECUTA_NP ":modelos/dsmom006";
|FPRC;

|PROCESO A0702;
     |SUB_EJECUTA_NP ":modelos/dsmom026";
|FPRC;

|PROCESO A0703;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";
|FPRC;

|PROCESO A0704;
     |SUB_EJECUTA_NP ":modelos/dsmom003";
|FPRC;

|PROCESO A0705;
     |SUB_EJECUTA_NP ":modelos/dsmom023";
|FPRC;

|PROCESO Baja8;
     #dsam0008#0 = #dsam0000#0;
     #dsam0008#1 = 01;
|FPRC;

|PROCESO Alta8;
     #dsam0008#0 = #dsam0000#0;
     #dsam0008#1 = 99;
|FPRC;

|PROCESO A0801;
     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0008, -2, 2, 22, 1, Baja8, Alta8;
     |SINO;
         |ENTLINEAL #1#dsam0008, -2, 4, 22, 1, Baja8, Alta8;
     |FINSI;

     |HAZ PasaFacturacion;
|FPRC;

|PROCESO A0802;
     enTipoFac  = 1;
     |SUB_EJECUTA_NP ":facturar/facemp2";
|FPRC;

|PROCESO A0803;
     enTipoFac  = 2;
     |SUB_EJECUTA_NP ":facturar/facemp2";
|FPRC;

|PROCESO Baja7;
     #dsam0007#0 = #dsam0000#0;
     #dsam0007#1 = 01;
|FPRC;

|PROCESO Alta7;
     #dsam0007#0 = #dsam0000#0;
     #dsam0007#1 = 99;
|FPRC;

|PROCESO A0900;
     |ENTLINEAL #1#dsam0007, -2, enModo, 22, 1, Baja7, Alta7;
|FPRC;

|PROCESO A1000;
     |SI enModo = 4;
         aAlfa =  "MODO CONSULTA (No grabara si se escribe)";
         |ATRI R;  |PINTA 0840, aAlfa;  |ATRI i;
     |FINSI;

     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0902;
     enCuadroFin   = 2279;
     enCampoAncho  = 76;
     enModoEdita   = 1100;

     |ABRE #dsam0002;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 101#dsam0002.=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #dsam0002#2;
               |SI enModo ! 4;  |BORRA 020#dsam0002.a;  |FINSI;
           |FINSI;
           |LIBERA #dsam0002;
     |SIGUE;

     |HAZ Edita;

     |SI enModo = 4;  |ACABA;  |FINSI;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #dsam0002;
           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 101#dsam0002.=;
           |SI FSalida ! 0;  |GRABA 020#dsam0002.b;  |FINSI;
           #dsam0002#2 = epPuntEdita;
           |GRABA 020#dsam0002.a;
           |LIBERA #dsam0002;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 101#dsam0002.=;
           aAlfa = #dsam0002#2;  |QBF aAlfa;

           |SI aAlfa ! "";  |LIBERA #dsam0002;  |SAL;  |FINSI;

           |BORRA 020#dsam0002.a;
           |LIBERA #dsam0002;
     |SIGUE;
     |CIERRA #dsam0002;
|FPRC;

|PROCESO A1100;
     |SI #dsam0000#65 = "N";
         |MENAV "      El Cliente no tiene Contabilidad";
         |ACABA;
     |FINSI;

     |SUB_EJECUTA_NP ":contagen/canempr2";
|FPRC;

|PROCESO A1202;
     |SUB_EJECUTA_NP ":integral/dsaz0023";
|FPRC;

|PROGRAMA;
     |ABRET #dsam0000;
     #dsam0000#0 = eaOpcion2;
     |LEE 000#dsam0000.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;

     |SI eaOpcion1 = "A0200";  |HAZ A0200;  |FINSI;
     |SI eaOpcion1 = "A0300";  |HAZ A0300;  |FINSI;
     |SI eaOpcion1 = "A0400";  |HAZ A0400;  |FINSI;
     |SI eaOpcion1 = "A0501";  |HAZ A0501;  |FINSI;
     |SI eaOpcion1 = "A0502";  |HAZ A0502;  |FINSI;
     |SI eaOpcion1 = "A0503";  |HAZ A0503;  |FINSI;
     |SI eaOpcion1 = "A0504";  |HAZ A0504;  |FINSI;
     |SI eaOpcion1 = "A0505";  |HAZ A0505;  |FINSI;
     |SI eaOpcion1 = "A0601";  |HAZ A0601;  |FINSI;
     |SI eaOpcion1 = "A0602";  |HAZ A0602;  |FINSI;
     |SI eaOpcion1 = "A0603";  |HAZ A0603;  |FINSI;
     |SI eaOpcion1 = "A0604";  |HAZ A0604;  |FINSI;
     |SI eaOpcion1 = "A0701";  |HAZ A0701;  |FINSI;
     |SI eaOpcion1 = "A0702";  |HAZ A0702;  |FINSI;
     |SI eaOpcion1 = "A0703";  |HAZ A0703;  |FINSI;
     |SI eaOpcion1 = "A0704";  |HAZ A0704;  |FINSI;
     |SI eaOpcion1 = "A0705";  |HAZ A0705;  |FINSI;
     |SI eaOpcion1 = "A0801";  |HAZ A0801;  |FINSI;
     |SI eaOpcion1 = "A0802";  |HAZ A0802;  |FINSI;
     |SI eaOpcion1 = "A0803";  |HAZ A0803;  |FINSI;
     |SI eaOpcion1 = "A0900";  |HAZ A0900;  |FINSI;
     |SI eaOpcion1 = "A1000";  |HAZ A1000;  |FINSI;
     |SI eaOpcion1 = "A1100";  |HAZ A1100;  |FINSI;
     |SI eaOpcion1 = "A1202";  |HAZ A1202;  |FINSI;

     |CIERRAT #dsam0000;
|FPRO;
