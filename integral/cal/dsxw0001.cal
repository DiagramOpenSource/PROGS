|FICHEROS;
     dsxw0001;

     dsam0000;
     dsam0003;
     dsam0004;
     dsam0005;
     dsam0011;
     dsam0103;
     dsam0106;
     dsam0107;
     dsam0123;
     dsam0124;

     :basica/agifigen;
     :basica/agitab04;
     :modelos/dsmom001;
|FIN;

|VARIABLES;
     nSwComunero        = 0;
     n1Vent             = 0;
     nIDE               = 0;
     nCampo             = 0;
     nSalida            = 0;

     aAlfa              = "";
     aAlfa1             = "";
     aContenido         = "";
     aContenNom         = "";
     aContenNo2         = "";

     {-1}aGet           = 0;
         aGet1          = 0;
         aGet2          = 0;

     {-1}aVent          = "";
         aVent1         = 0;
         aVent2         = 0;
         aVent3         = 0;
         aVent4         = 0;
         aVent5         = "";

     &enEmpresa         = 0;
     &enDesdeFuera      = 0;
     &enModo            = 0;
     &eaCliNif          = "";
     &eaVarDni          = "";
     &enCalcCif         = 0;
     &eaNifRep          = "";
     &enCodRep          = 0;
     &enSwMal           = 0;
     &eaNuevo1          = "";
     &eaNuevo2          = "";
     &eaPrograma        = "";
     &enAprobacion      = 0;
|FIN;

|PROCESO AbreVentana1;
     |VENTANA 0501, 2699, -1, 16, "Datos generales";
     n1Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;
|FPRC;

|PROCESO CierraVentana1;
     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n1Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n1Vent;
|FPRC;

|PROCESO GrabaTelef;
     |ABRE #dsam0106;
     #dsam0106#0 = #dsxw0001#1;
     |LEE 101#dsam0106.=;
     |SI FSalida ! 0;
         #dsam0106#0 = #dsxw0001#1;
         #dsam0106#1 = #dsxw0001#27;
         #dsam0106#2 = #dsxw0001#28;
         |GRABA 020#dsam0106.n;
     |SINO;
         #dsam0106#1 = #dsxw0001#27;
         #dsam0106#2 = #dsxw0001#28;
         |GRABA 020#dsam0106.a;
     |FINSI;
     |LIBERA #dsam0106;
     |CIERRA #dsam0106;

     |ABRE #dsam0107;
     #dsam0107#0 = #dsam0106#0;
     #dsam0107#1 = 1;
     |LEE 001#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsxw0001#1;
         #dsam0107#1 = 1; #dsam0107#2 = "TELEFONO PRINCIPAL  ";
         #dsam0107#4 = #dsxw0001#54;
         |GRABA 040#dsam0107.n;
         |LIBERA #dsam0107;
     |FINSI;

     #dsam0107#0 = #dsxw0001#1;
     #dsam0107#1 = 2;
     |LEE 040#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsxw0001#1;
         #dsam0107#1 = 2;
         #dsam0107#2 = "TELEFONO DE CONTACTO";
         |GRABA 020#dsam0107.n;
         |LIBERA #dsam0107;
     |FINSI;
     |CIERRA #dsam0107;
|FPRC;

|PROCESO dsam0004;
     |BORRA 020#dsam0004.a;
     |LIBERA #dsam0004;
|FPRC;

|DEFBUCLE dsam0004;
     #dsam0004#1;
     ;
     #dsxw0001#0, 00;
     #dsxw0001#0, 99;
     be;
     NULL, dsam0004;
|FIN;

|PROCESO ActualizaApli;
     enDesdeFuera = 0;
     |HAZ GrabaTelef;
     |HAZ GrabaCorreo;
     |HAZ GrabaOtrasApli;

     |SI #dsxw0001#68 = "N";
         |ABRE #dsam0003;
         #dsam0003#0 = #dsxw0001#0;
         |LEE 101#dsam0003.=;
         |SI FSalida = 0;
             |BORRA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;

         |BUCLE dsam0004;
     |FINSI;
|FPRC;

|PROCESO Tipo12;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     |SI FSalida ! 1;
         nSalida = 1;
         |ERROR;
         |POSICIONATE #dsxw0001#5;
         |ACABA;
     |FINSI;

     nSalida = 0;
     |REFERENCIA_DEF aGet1, #dsxw0001;
     |PARA nCampo = 0;  |SI nCampo [ 120;  |HACIENDO nCampo = nCampo + 1;
           |C_V #dsxw0001#nCampo#, 0, aAlfa;
           |SI aAlfa = "S";
               aGet2 = nCampo;
               IaGet = aGet1<-;
               |ESPECIFICA "GETDATACONTROL", aGet;
               #dsxw0001#nCampo# = FSalida;
           |FINSI;
     |SIGUE;

     |PARA nCampo = 0;  |SI nCampo [ 120;  |HACIENDO nCampo = nCampo + 1;
          #dsam0000#nCampo# = #dsxw0001#nCampo#;
     |SIGUE;

     |GRABA 020#dsam0000.a;
     |LIBERA #dsam0000;

     enEmpresa = #dsam0000#0;
     eaCliNif  = #dsam0000#3;

     |ABRE #dsam0005;
     #dsam0005#0 = #dsxw0001#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;
         #dsam0005#0  = #dsxw0001#0;
         #dsam0005#1  = 97;
         #dsam0005#2  = "DOMICILIO SOCIAL ";
         #dsam0005#3  = #dsxw0001#19;
         #dsam0005#4  = #dsxw0001#20;
         #dsam0005#5  = #dsxw0001#21;
         #dsam0005#6  = #dsxw0001#22;
         #dsam0005#7  = #dsxw0001#23;
         #dsam0005#8  = #dsxw0001#24;
         #dsam0005#9  = #dsxw0001#25;
         #dsam0005#10 = #dsxw0001#26;
         #dsam0005#11 = #dsxw0001#27;
         #dsam0005#12 = #dsxw0001#28;
         #dsam0005#17 = #dsxw0001#98;
         #dsam0005#18 = #dsxw0001#99;
         #dsam0005#15 = #dsxw0001#86;
         #dsam0005#16 = #dsxw0001#87;
         |GRABA 020#dsam0005.n;

         #dsam0005#0 = #dsxw0001#0;
         #dsam0005#1 = 98;
         #dsam0005#2 = "DOMICILIO FISCAL ";
         |GRABA 020#dsam0005.n;

         #dsam0005#0 = #dsxw0001#0;
         #dsam0005#1 = 99;
         #dsam0005#2 = "DOMICILIO ENVIO  ";
         |GRABA 020#dsam0005.n;
     |FINSI;

     #dsam0005#0 = #dsxw0001#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsxw0001#19  = #dsam0005#3;
         #dsxw0001#20  = #dsam0005#4;
         #dsxw0001#21  = #dsam0005#5;
         #dsxw0001#22  = #dsam0005#6;
         #dsxw0001#23  = #dsam0005#7;
         #dsxw0001#24  = #dsam0005#8;
         #dsxw0001#25  = #dsam0005#9;
         #dsxw0001#26  = #dsam0005#10;
         #dsxw0001#27  = #dsam0005#11;
         #dsxw0001#28  = #dsam0005#12;
         #dsxw0001#98  = #dsam0005#17;
         #dsxw0001#99  = #dsam0005#18;
         #dsxw0001#86  = #dsam0005#15;
         #dsxw0001#87  = #dsam0005#16;
     |FINSI;

     #dsam0005#0 = #dsxw0001#0;
     #dsam0005#1 = 98;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsxw0001#29 = #dsam0005#3;
         #dsxw0001#30 = #dsam0005#4;
         #dsxw0001#31 = #dsam0005#5;
         #dsxw0001#32 = #dsam0005#6;
         #dsxw0001#33 = #dsam0005#7;
         #dsxw0001#34 = #dsam0005#8;
         #dsxw0001#35 = #dsam0005#9;
         #dsxw0001#36 = #dsam0005#10;
         #dsxw0001#37 = #dsam0005#11;
         #dsxw0001#38 = #dsam0005#12;
     |FINSI;

     #dsam0005#0 = #dsxw0001#0;
     #dsam0005#1 = 99;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsxw0001#39 = #dsam0005#3;
         #dsxw0001#40 = #dsam0005#4;
         #dsxw0001#41 = #dsam0005#5;
         #dsxw0001#42 = #dsam0005#6;
         #dsxw0001#43 = #dsam0005#7;
         #dsxw0001#44 = #dsam0005#8;
         #dsxw0001#45 = #dsam0005#9;
         #dsxw0001#46 = #dsam0005#10;
         #dsxw0001#47 = #dsam0005#11;
         #dsxw0001#48 = #dsam0005#12;

         |ABRE #dsam0003;
         #dsam0003#0 = #dsxw0001#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             #dsam0003#24 = #dsxw0001#39;
             #dsam0003#25 = #dsxw0001#40;
             #dsam0003#26 = #dsxw0001#41;
             #dsam0003#27 = #dsxw0001#42;
             #dsam0003#28 = #dsxw0001#43;
             #dsam0003#29 = #dsxw0001#44;
             #dsam0003#30 = #dsxw0001#45;
             #dsam0003#31 = #dsxw0001#46;
             #dsam0003#32 = #dsxw0001#47;
             #dsam0003#33 = (("00" + #dsam0003#30) % -102) + (("000" + #dsam0003#31) % -103);
             |GRABA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;
     |CIERRA #dsam0005;

     |HAZ ActualizaApli;
|FPRC;

|PROCESO Tipo6C110; |TIPO 6;
     aAlfa = #dsxw0001#110; |QBF aAlfa;
     |SI aAlfa = "";
         |ABRE #dsam0011;
         #dsam0011#0 = "   ";
         |LEE 001#dsam0011.=;
         |SI FSalida ! 0;
             #dsam0011#0 = "   ";
             #dsam0011#1 = "";
             |GRABA 020#dsam0011.n;
         |FINSI;
         |CIERRA #dsam0011;
     |FINSI;
|FPRC;

|PROCESO Tipo0C110; |TIPO 0;
     aAlfa = Contenido;
     |ABRE #dsam0011;
     |DDEFECTO #dsam0011;
     #dsam0011#0 = #dsxw0001#110;
     |LEE 001#dsam0011.=;
     |CIERRA #dsam0011;

     |SI aAlfa ! #dsxw0001#110;
         #dsxw0001#8 = #dsam0011#1; |PINTA #dsxw0001#8;
     |FINSI;
|FPRC;

|PROCESO Tipo0C85;
     |SI #dsxw0001#85 = "A"; #dsxw0001#5 = "ACTIVA  "; |FINSI;
     |SI #dsxw0001#85 = "I"; #dsxw0001#5 = "INACTIVA"; |FINSI;

     |PINTA #dsxw0001#5;
|FPRC;

|PROCESO Tipo0C50;
     |SI #dsxw0001#50 = 1; #dsxw0001#51 = "CONTRATO"; |FINSI;
     |SI #dsxw0001#50 = 2; #dsxw0001#51 = "SERVICIO"; |FINSI;
     |PINTA #dsxw0001#51;
|FPRC;

|PROCESO Tipo0C13; |TIPO 0;
     |SI #dsxw0001#13 = 0;  |ACABA;  |FINSI;

     #dsam0000#0 = #dsxw0001#13;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0; |DDEFECTO #dsam0000; |FINSI;

     aAlfa1 = #dsam0000#1;

     #dsam0000#0 = #dsxw0001#0;
     |LEE 000#dsam0000.=;

     #dsxw0001#14 = aAlfa1;  |PINTA #dsxw0001#14;
|FPRC;

|PROCESO Tipo0C9;
     |SI nSalida = 1;  |ACABA;  |FINSI;
     |SI enModo  ! 1;  |ACABA;  |FINSI;

     |ABRE #agitab04;
     #agitab04#0 = #dsxw0001#9;
     |LEE 000#agitab04.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab04;  |FINSI;
     |CIERRA #agitab04;

     #dsxw0001#65 = #agitab04#2;  |PINTA #dsxw0001#65;
     #dsxw0001#66 = #agitab04#3;  |PINTA #dsxw0001#66;
     #dsxw0001#67 = #agitab04#4;  |PINTA #dsxw0001#67;
     #dsxw0001#68 = #agitab04#5;  |PINTA #dsxw0001#68;
     #dsxw0001#69 = #agitab04#6;  |PINTA #dsxw0001#69;
|FPRC;

|PROCESO dsmom001;
     |SI #dsmom001#9 ! "01.01.0000";  |ACABA;  |FINSI;

     nSwComunero = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#2;
     ;
     #dsxw0001#0, 01;
     #dsxw0001#0, 99;
     ;
     NULL, dsmom001;
|FIN;

|PROCESO Comunero;  |TIPO 7;
     #dsxw0001#11   = 0;
     #dsxw0001#13   = 0;
     #dsxw0001#14   = "";

     nSwComunero = 0;
     |BUCLE dsmom001;

     |SI nSwComunero = 0;  |ACABA;  |FINSI;

     |ABRE #agifigen;
     #agifigen#0 = #dsmom001#0;
     |LEE 040#agifigen.=;
     |SI FSalida ! 0;  |DDEFECTO #agifigen;  |FINSI;
     |CIERRA #agifigen;

     #dsxw0001#11   = #dsmom001#7;   |PINTA #dsxw0001#11;
     #dsxw0001#13   = #agifigen#0;   |PINTA #dsxw0001#13;
     #dsxw0001#14   = #agifigen#2;   |PINTA #dsxw0001#14;
|FPRC;

|PROCESO Tipo7C3;  |TIPO 7;
     aContenido  = Contenido;
     |HAZ Comunero;

     aContenNom = #dsxw0001#1;
     aContenNo2 = #dsxw0001#2;
|FPRC;

|PROCESO Rellena103;
     #dsxw0001#1  = #dsam0103#1;
     #dsxw0001#19 = #dsam0103#9;
     #dsxw0001#20 = #dsam0103#2;
     #dsxw0001#21 = #dsam0103#3;
     #dsxw0001#22 = #dsam0103#16;
     #dsxw0001#23 = #dsam0103#10;
     #dsxw0001#24 = #dsam0103#11;
     #dsxw0001#25 = #dsam0103#4;
     #dsxw0001#26 = #dsam0103#5;
     #dsxw0001#27 = #dsam0103#6;
     #dsxw0001#28 = #dsam0103#7;
     #dsxw0001#86 = #dsam0103#14;
     #dsxw0001#87 = #dsam0103#15;
     #dsxw0001#98 = #dsam0103#12;

     |PINTA #dsxw0001#1;
|FPRC;

|PROCESO Tipo6C3;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni   = #dsxw0001#Campo#;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #dsxw0001#Campo# = eaVarDni;
         |PINTA #dsxw0001#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #dsxw0001#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #dsxw0001#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsxw0001#Campo# = eaVarDni;  |PINTA #dsxw0001#Campo#;
             |ERROR;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI enModo = 1;
         eaNifRep = #dsxw0001#3;|QBF eaNifRep;
         |SI eaNifRep ! "";
             enCodRep = #dsxw0001#0;
             |SUB_EJECUTA_NP ":integral/dsaz0009";
             |SI enSwMal = 1;
                 |PTEC 807;
                 |ACABA;
             |FINSI;
         |FINSI;

         |HAZ Rellena103;
     |FINSI;

     |SI enModo ! 2;  |ACABA;  |FINSI;

     |SI aContenido ! #dsxw0001#3;
         |CONFI "    NEstas cambiando en NIF del Cliente, desea continuar.";
         |SI FSalida ! 0;
             #dsxw0001#3 = aContenido; |PINTA #dsxw0001#3;
             |ERROR;
             |ACABA;
         |SINO;
             eaNifRep = #dsxw0001#3;|QBF eaNifRep;
             |SI eaNifRep ! "";
                 enCodRep = #dsxw0001#0;
                 |SUB_EJECUTA_NP ":integral/dsaz0009";
                 |SI enSwMal = 1;
                     |PTEC 807;
                     |ACABA;
                 |FINSI;

                 |HAZ Rellena103;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C3;  |TIPO 0;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     |ABRE #dsam0103;
     #dsam0103#0 = #dsxw0001#3;
     |LEE 000#dsam0103.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0103;  |FINSI;
     |CIERRA #dsam0103;

     |HAZ Rellena103;
|FPRC;

|PROCESO Tipo0C2; |TIPO 0;
     aAlfa = " " * 40;
     |SI enModo = 2;
         |SI aContenNo2 ! #dsxw0001#Campo#; |Y aContenNo2 ! aAlfa;
             |CONFI "    NEstas cambiando el Nombre Comercial del Cliente, desea continuar.";
             |SI FSalida ! 0;
                 #dsxw0001#Campo# = aContenNo2; |PINTA #dsxw0001#2;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
         aContenNo2 = #dsxw0001#Campo#;
     |FINSI;
|FPRC;

|PROCESO dsam0107;
     #dsam0107#0 = #dsxw0001#1;
     |GRABA 020#dsam0107.n;
     |LIBERA #dsam0107;

     #dsam0107#0 = Contenido;
     |LEE 101#dsam0107.=;
     |SI FSalida = 0;
         |BORRA 020#dsam0107.a;
         |LIBERA #dsam0107;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0107;
     #dsam0107#1;
     ;
     Contenido, 00;
     Contenido, 99;
     be;
     NULL, dsam0107;
|FIN;

|PROCESO GrabaDirec;
     #dsam0124#0 = eaNuevo1;
     |GRABA 020#dsam0124.n;
     |LIBERA #dsam0124;

     #dsam0124#0 = eaNuevo2;
     |LEE 101#dsam0124.=;
     |SI FSalida = 0;
         |BORRA 020#dsam0124.a;
         |LIBERA #dsam0124;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0124;
     #dsam0124#1;
     ;
     eaNuevo2, 00;
     eaNuevo2, 99;
     be;
     NULL, GrabaDirec;
|FIN;

|PROCESO GrabaDirecCorreo;
     |ABRE #dsam0123;
     #dsam0123#0 = eaNuevo1;
     |LEE 101#dsam0123.=;
     |SI FSalida ! 0;
         #dsam0123#0 = #dsxw0001#1;
         #dsam0123#1 = #dsxw0001#27;
         #dsam0123#2 = #dsxw0001#28;
         |GRABA 020#dsam0123.n;
         |LIBERA #dsam0123;

         #dsam0123#0 = eaNuevo2;
         |LEE 101#dsam0123.=;
         |SI FSalida = 0;
             |BORRA 020#dsam0123.a;
             |LIBERA #dsam0123;
         |FINSI;

         |BUCLE dsam0124;
     |FINSI;
     |CIERRA #dsam0123;
|FPRC;

|PROCESO Tipo0C1; |TIPO 0;
     aAlfa = " " * 40;
     |SI enModo = 2;
         |SI aContenNom ! #dsxw0001#Campo#; |Y aContenNom ! aAlfa;
             |CONFI "    NEstas cambiando el Nombre del Cliente, desea continuar.";
             |SI FSalida ! 0;
                 #dsxw0001#Campo# = aContenNom; |PINTA #dsxw0001#1;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
         aContenNom = #dsxw0001#Campo#;
     |FINSI;

     |SI Contenido ! aAlfa;  |Y #dsxw0001#Campo# ! Contenido;
         |ABRE #dsam0106;
         #dsam0106#0 = #dsxw0001#1;
         |LEE 101#dsam0106.=;
         |SI FSalida ! 0;
             #dsam0106#0 = #dsxw0001#1;
             #dsam0106#1 = #dsxw0001#27;
             #dsam0106#2 = #dsxw0001#28;
             |GRABA 020#dsam0106.n;
             |LIBERA #dsam0106;

             #dsam0106#0 = Contenido;
             |LEE 101#dsam0106.=;
             |SI FSalida = 0;
                 |BORRA 020#dsam0106.a;
                 |LIBERA #dsam0106;
             |FINSI;

             |BUCLE dsam0107;
         |FINSI;
         |CIERRA #dsam0106;

         eaNuevo1 = #dsxw0001#1;
         eaNuevo2 = Contenido;
         |HAZ GrabaDirecCorreo;
     |FINSI;

     |SI enModo = 1;
         aAlfa1 = #dsxw0001#2; |QBF aAlfa1;
         |SI aAlfa1 = "";
             #dsxw0001#2  = #dsxw0001#1;
             |PINTA #dsxw0001#2;
         |FINSI;

         aAlfa1 = #dsxw0001#53; |QBF aAlfa1;
         |SI aAlfa1 = "";
             #dsxw0001#53 = #dsxw0001#1;
             |PINTA #dsxw0001#53;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Tipo0C0; |TIPO 0;
     |C_M #dsxw0001#0, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #dsam0000#0 = #dsxw0001#0;
     |LEE 000#dsam0000.=;
     |SI FSalida = 0;
         |MENAV "0000El cliente ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #dsxw0001#0, 1, "N";

     |DDEFECTO #dsam0000;
     #dsam0000#0 = #dsxw0001#0;
     |GRABA 020#dsam0000.b;
|FPRC;

|PROCESO EntraDatos;
     |PINDA #0#dsxw0001;
     |SI enModo = 1;  |ENDATOS #1#dsxw0001;  |FINSI;
     |SI enModo = 2;  |ENDATOS #2#dsxw0001;  |FINSI;
     |SI FSalida ! 0;
         |SI enModo = 1;
             |BORRA 020#dsam0000.a;
             |LIBERA #dsam0000;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Alta;
     #dsam0000#0 = 99000;
     |LEE 000#dsam0000.];
     |SI FSalida = 0;
         |LEE 000#dsam0000.a;
     |SINO;
         |LEE 000#dsam0000.u;
     |FINSI;

     nIDE = #dsam0000#0 + 1;

     |SI nIDE ] 99000;
         nIDE = 98999;
         |PARA;  |SI FSalida = 0;  |HACIENDO;
              nIDE = nIDE - 1;
              #dsam0000#0 = nIDE;
              |LEE 000#dsam0000.=;
              |SI FSalida ! 0;  |SAL;  |FINSI;
         |SIGUE;
     |FINSI;

     |DDEFECTO #dsxw0001;
     #dsxw0001#0 = nIDE;

     |C_M #dsxw0001#0, 1, "S";

     |HAZ EntraDatos;
|FPRC;

|PROCESO Modificar;
     #dsam0000#0 = enEmpresa;
     |LEE 101#dsam0000.=;

     |C_M #dsxw0001#0, 1, "N";

     |PARA nCampo = 0;  |SI nCampo [ 120;  |HACIENDO nCampo = nCampo + 1;
          #dsxw0001#nCampo# = #dsam0000#nCampo#;
     |SIGUE;

     |HAZ EntraDatos;
|FPRC;

|PROCESO Consultar;
     #dsam0000#0 = enEmpresa;
     |LEE 101#dsam0000.=;

     |C_M #dsxw0001#0, 1, "N";

     |PARA nCampo = 0;  |SI nCampo [ 120;  |HACIENDO nCampo = nCampo + 1;
          #dsxw0001#nCampo# = #dsam0000#nCampo#;
     |SIGUE;

     |PINDA #0#dsxw0001;
     |PAUSA;
|FPRC;

|PROGRAMA;
    |SI PARAMETRO = "ACTUALIZAAPLI";
        |ABRE #dsam0000;
        #dsam0000#0 = enEmpresa;
        |LEE 000#dsam0000.=;
        |SI FSalida = 0;
            |HAZ ActualizaApli;
        |FINSI;
        |CIERRA #dsam0000;
        |ACABA;
    |FINSI;

     |ABRE #dsam0000;
     |HAZ AbreVentana1;
     |PINPA #0#dsxw0001;

     nSalida = 0;

     |C_M #dsxw0001#120, 1, "N";

     eaPrograma = "PORTAL";
     |HAZ INTEGRAL_INI;
     |SI enAprobacion = 1;
         |C_M #dsxw0001#120, 1, "S";
     |FINSI;

     |SI enModo = 1;  |HAZ Alta;       |FINSI;
     |SI enModo = 2;  |HAZ Modificar;  |FINSI;
     |SI enModo = 4;  |HAZ Consultar;  |FINSI;

     |CIERRA #dsam0000;

     |HAZ CierraVentana1;
|FPRO;
