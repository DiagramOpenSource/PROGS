|FICHEROS;
     ayge0004 #0;   || Partes de Trabajo Entrada Global.
     ayge0000 #1;   || Contador / Path.
     dsam0000 #2;   || Fichero de Clientes de la Ficha General de Clientes.
     ayge0002 #3;   || Partes de Trabajo. Fichero real.
|FIN;

|VARIABLES;
     nCampo   = 0;
     aHora    = "";
     aMensaje = "";
|FIN;

||---------------------------------------------------------------------------
|| COGE LA HORA DEL SISTEMA.
||---------------------------------------------------------------------------

|PROCESO Hora; |TIPO 7;
     |HORA aHora;
     #0#22 = aHora;
     |PINTA #0#22;
|FPRC;

||---------------------------------------------------------------------------
|| PINTA EL NOMBRE COMPLETO DEL SERVICIO Y DEL TIPO DE SERVICIO.
||---------------------------------------------------------------------------

|PROCESO Servi; |TIPO 0;
     |SI #0#14 = "E";  |PINTA 1024,"Envio";     |FINSI;
     |SI #0#14 = "R";  |PINTA 1024,"Recogida";  |FINSI;
|FPRC;

|PROCESO TipServi; |TIPO 0;
     |SI #0#15 = "U";  |PINTA 1065,"URGENTE";    |FINSI;
     |SI #0#15 = "O";  |PINTA 1065,"Ordinario";  |FINSI;
     |SI #0#15 = "X";  |PINTA 1065,"Otros";     |FINSI;
|FPRC;

||---------------------------------------------------------------------------
|| CONTADOR AUTOMATICO PARA EL NUMERO DE PARTE.
||---------------------------------------------------------------------------
|PROCESO Numero;
     |ABRE #1;
     |LEE 121#1p;

     #3#0 = #1#1;
     #1#1 = #1#1 + 1;

     |GRABA 121#1a;
     |CIERRA #1;
|FPRC;

||---------------------------------------------------------------------------
|| Rutina de creacion de partes de trabajo.
||---------------------------------------------------------------------------

|PROCESO GrabaParte;
     aMensaje = "Generando el Parte " + #3#0 + " del Cliente " + #2#0;
     |ATRI R;
     |MENSA aMensaje;
     |ATRI r;

     |HAZ Numero;

     #3#1  = #2#0;
     #3#2  = #2#2;
     #3#3  = #2#1;
     #3#4  = #2#19;
     #3#5  = #2#20;
     #3#6  = #2#21;
     #3#7  = #2#22;
     #3#8  = #2#23;
     #3#9  = #2#24;
     #3#10 = #2#25;
     #3#11 = #2#26;
     #3#12 = #2#27;
     #3#13 = #2#28;
     #3#14 = #0#14;
     #3#15 = #0#15;
     #3#16 = #0#16;
     #3#17 = #0#17;
     #3#18 = #0#18;
     #3#19 = #0#19;
     #3#20 = #0#20;
     #3#21 = #0#21;
     #3#22 = #0#22;
     #3#23 = #0#23;
     #3#24 = #0#24;
     #3#25 = #0#25;
     #3#26 = #0#26;
     #3#27 = #0#27;
     #3#28 = #0#28;
     #3#29 = #0#29;
     #3#30 = #0#30;
     #3#31 = #0#31;
     #3#32 = "N";
     |GRABA 020#3n;
     |LIBERA #3;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |ABRE #2;
     |ABRE #3;
     |PARA nCampo = 33;  |SI nCampo [ 64;  |HACIENDO nCampo = nCampo + 1;
           |SI #0nCampo ! 0;
               #2#0 = #0nCampo;
               |LEE 000#2=;
               |SI FSalida = 0;
                   |HAZ GrabaParte;
               |FINSI;
           |FINSI;
     |SIGUE;
     |CIERRA #2;
     |CIERRA #3;
|FPRC;
