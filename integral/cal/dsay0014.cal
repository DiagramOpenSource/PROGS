|FICHEROS;
     dsay0014 #0;

     dsam0000 #1;
     :/basica/def/agitab10 #110;
     :/basica/def/agitab12 #112;
     :/basica/def/agicen14 #114;
|FIN;

|VARIABLES;
     nCampo   = 0;
     nSwHay   = 0;

     aDFecha  = "";
     aHFecha  = "";

     &enLinea = 0;
     &eaTex1  = "";
     &enIva   = 0;
     &eaIva   = "";
     &enTri   = 0;
     &eaTri   = "";
     informe  = "";
     inform1  = "dsay0014";
     inform2  = "dsaya014";
     nDIva    = 0;
     nHIva    = 0;
     nDTri    = 0;
     nHTri    = 0;
     nSwOpe   = 0;
     nSwSele  = 0;
|FIN;

|PROCESO Actividad;
     |C_M #0#18, 1, "S";
     |SI #0#17 = "N";
         |C_M #0#18, 1, "N";  #0#18 = 0;  |PINTA #0#18;
     |FINSI;
|FPRC;

|PROCESO Seleccion;
     |SI #0#2 = "D";
         |C_M #0#3, 1, "S";
         |C_M #0#4, 1, "S";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#3, 1, "N";  #0#3 = 0;      |PINTA #0#3;
         |C_M #0#4, 1, "N";  #0#4 = 99;     |PINTA #0#4;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";  |PINTA #0Campo;
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S"; |PINTA #0Campo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Seleccion1;
     |SI #0#19 = "D";
         |C_M #0#20, 1, "S";
         |C_M #0#21, 1, "S";
         |PARA nCampo = 22;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#20, 1, "N";  #0#20 = 0;      |PINTA #0#20;
         |C_M #0#21, 1, "N";  #0#21 = 99;     |PINTA #0#21;
         |PARA nCampo = 22;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas1;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";  |PINTA #0Campo;
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S"; |PINTA #0Campo;
         |SIGUE;
     |FINSI;
|FPRC;
|| ************************************************************************

|PROCESO Elegir;
   nSwSele = 0;
   |SI #0#2 = "D";
       |SI #114#7 ] #0#3; |Y #114#7 [ #0#4;
           nSwSele = 1;
       |FINSI;
   |SINO;
       |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
             |SI #0nCampo ! 0; |Y #114#7 = #0nCampo;
                 nSwSele = 1;
                 |SAL;
             |FINSI;
        |SIGUE;
   |FINSI;

   |SI nSwSele = 0; |ACABA; |FINSI;

   nSwSele = 0;
   |SI #0#19 = "D";
       |SI #114#9 ] #0#20; |Y #114#9 [ #0#21;
           nSwSele = 1;
       |FINSI;
   |SINO;
       |PARA nCampo = 22;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
             |SI #0nCampo ! 0; |Y #114#9 = #0nCampo;
                 nSwSele = 1;
                 |SAL;
             |FINSI;
        |SIGUE;
   |FINSI;

   |SI nSwSele = 1;
       enIva   = #114#7;
       eaIva   = #114#8;
       enTri   = #114#9;
       eaTri   = #114#10;
       |SI #0#35 = "I";
           nSwSele = 0;
           |SI #114#7 = #110#0;
               enIva   = #114#9;
               eaIva   = #114#10;
               nSwSele = 1;
          |FINSI;
       |FINSI;
       |SI #0#35 = "T";
           nSwSele = 0;
           |SI #114#9 = #112#0;
               nSwSele = 1;
          |FINSI;
       |FINSI;
   |FINSI;
|FPRC;

|| ************************************************************************
|PROCESO agicen14;
     |SI #0#18 ! 0;
          |SI #114#5 > "01.01.0000";
              |SI #114#5 > aHFecha;  |ACABA;  |FINSI;
          |FINSI;

          |SI #114#6 > "01.01.0000";
              |SI #114#6 < aDFecha;  |ACABA; |FINSI;
          |FINSI;
     |FINSI;

     |SI nSwOpe = 0;
         |HAZ Elegir;
         |SI nSwSele = 1;
             |ERROR10;
         |FINSI;
     |SINO;
         enLinea = 2;  |PRINT;
     |FINSI;
|FPRC;

|DEFBUCLE agicen14;
     #114#1;
     7,9;
     #1#0, 01, nDIva,nDTri;
     #1#0, 99, nHIva,nHTri;
     ;
     NULL, agicen14;
|FIN;

|PROCESO Imprimelos;

     enIva   = 0; eaIva   = "";
     enTri   = 0; eaTri   = "";
     nSwOpe  = 0;
     nSwSele = 0;
     |BUCLE agicen14;
     |SI nSwSele = 1;
         enLinea = 1;  |PRINT;
         |SI #0#17 = "S";
             nSwOpe = 1;
             |BUCLE agicen14;
         |FINSI;
         nSwHay = 1;
     |FINSI;
|FPRC;

|DEFBUCLE LeePorNombre;
     #1#2;
     0;
     "                                        ", #0#0;
     "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz", #0#1;
     ;
     NULL, Imprimelos;
|FIN;

|DEFBUCLE LeePorCodigo;
     #1#1;
     ;
     #0#0;
     #0#1;
     ;
     NULL, Imprimelos;
|FIN;


|PROCESO Relacion1;
     nSwHay = 0;
     |SI #0#36 = "C";
         |BUCLE LeePorCodigo;
     |SINO;
         |BUCLE LeePorNombre;
     |FINSI;
     |SI nSwHay = 1; |PIEINF; |FINSI;
|FPRC;

|DEFBUCLE agitab10;
     #110#1;
     ;
     nDIva;
     nHIva;
     ;
     NULL, Relacion1;
|FIN;

|PROCESO Relacion2;
     nDTri = 0;  nHTri = 99;
     |SI #0#2 = "D";
         nDIva = #0#3;
         nHIva = #0#4;
         |BUCLE agitab10;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   nDIva = #0nCampo;
                   nHIva = #0nCampo;
                   |BUCLE agitab10;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|DEFBUCLE agitab12;
     #112#1;
     ;
     nDTri;
     nHTri;
     ;
     NULL, Relacion1;
|FIN;

|PROCESO Relacion3;
     nDIva = 0;  nHIva = 99;
     |SI #0#19 = "D";
         nDTri = #0#20;
         nHTri = #0#21;
         |BUCLE agitab12;
     |SINO;
         |PARA nCampo = 22;  |SI nCampo [ 33;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0;
                   nDTri = #0nCampo;
                   nHTri = #0nCampo;
                   |BUCLE agitab12;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|| ------------------------------------------------------------------------
|PROCESO Tipo3;  |TIPO 3;
     |SI #0#18 ! 0;
         aDFecha = "01.01." + #0#18;
         aHFecha = "31.12." + #0#18;
     |FINSI;

     |SI #0#35 = "N";
         |MENAV "0000 Recuerde seleccionar el papel de la impresora en Horizontal";
     |FINSI;

     eaTex1 = "";
     informe = inform1;
     |SI #0#35 ! "N";
         informe = inform2;
         |SI #0#35 = "T"; eaTex1 = "Tipo de IVA"; |FINSI;
         |SI #0#35 = "I"; eaTex1 = "Tipo de Tributacion"; |FINSI;
     |FINSI;

     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR informe;
     |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

     |SI #0#35 = "N";
         nDIva = 0;  nHIva = 99;
         nDTri = 0;  nHTri = 99;
         |HAZ Relacion1;
     |SINO;
         |SI #0#35 = "I";
             |HAZ Relacion2;
         |SINO;
             |HAZ Relacion3;
         |FINSI;
     |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
