|FICHEROS;
     dsay0017 #0;
     dsam0000 #1;
     dsam0116 #2;
     dsam0009 #9;
     :/basica/def/agitab99 #99;
|FIN;

|VARIABLES;
     nCampo      = 0;
     nCampo1     = 0;
     nSwHay      = 0;
     nSigue      = 0;
     aAlfa       = "";
     aID         = "";
     nID         = 0;
     {10} aPopup = "";

     nSwSi       = 0;
     nPara1      = 0;
     aDSit       = "";
     aHSit       = "";
     nDTEm       = 0;
     nHTEm       = 0;
     nDBanco     = 0;
     nHBanco     = 0;
     nDModelo    = 0;
     nHModelo    = 0;
     nForma      = 0;
     nBanco      = 0;
     nSwBan      = 0;
     nSwFor      = 0;
     &enSwLinea  = 0;
     &enSwMod    = 0;
     &eaForma    = "";
|FIN;


|| *******************************************************

|PROCESO Seleccion;
     |SI #0#2 = "D";
         |C_M #0#3, 1, "S";
         |C_M #0#4, 1, "S";
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#3, 1, "N";  #0#3 = 0;        |PINTA #0#3;
         |C_M #0#4, 1, "N";  #0#4 = 99999;    |PINTA #0#4;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasBancos;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = 0;  |C_M #0nCampo, 1, "N";  |PINTA #0Campo;
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S"; |PINTA #0Campo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Seleccion_Mod;
     |SI #0#18 = "D";
         |C_M #0#19, 1, "S";
         |C_M #0#20, 1, "S";
         |PARA nCampo = 21;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#19, 1, "N";  #0#19 = 000;    |PINTA #0#19;
         |C_M #0#20, 1, "N";  #0#20 = 999;    |PINTA #0#20;
         |PARA nCampo = 21;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasModelos;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 32;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ConsuModelo;
     |SI Campo = 19; |O Campo = 20;  |ACABA;  |FINSI;

     |SI #0Campo = 0; |ACABA; |FINSI;
     |ABRE #99;
     #99#0 = #0Campo;
     |LEE 040#99=;
     |SI FSalida ! 0;
         |MENAV "     No Existe Modelo.";
         |ERROR;
     |FINSI;
     |CIERRA #99;
|FPRC;

|PROCESO Seleccion_FP;
     |SI #0#33 = "T";
         |PARA nCampo = 34;  |SI nCampo [ 37;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = 0;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |PARA nCampo = 34;  |SI nCampo [ 37;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasFP;
     |SI #0Campo = 0;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 37;  |HACIENDO nCampo = nCampo + 1;
               #0nCampo = 0;  |C_M #0nCampo, 1, "N";
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 37;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Seleccion_TE;
     |SI #0#38 = "D";
         |C_M #0#39, 1, "S";
         |C_M #0#40, 1, "S";
         |PARA nCampo = 41;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "N";  #0nCampo = -1;  |PINTA #0nCampo;
         |SIGUE;
     |SINO;
         |C_M #0#39, 1, "N";  #0#39 = 0;      |PINTA #0#3;
         |C_M #0#40, 1, "N";  #0#40 = 99;     |PINTA #0#4;
         |PARA nCampo = 41;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S";
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO NoMasEmpresas;
     |SI #0Campo = -1;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
               #0Campo = -1;  |C_M #0nCampo, 1, "N";  |PINTA #0Campo;
         |SIGUE;
     |SINO;
         |PARA nCampo = Campo + 1;  |SI nCampo [ 52;  |HACIENDO nCampo = nCampo + 1;
               |C_M #0nCampo, 1, "S"; |PINTA #0Campo;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO Tipo66CFP;  |TIPO 66;
     aAlfa = Campo; aAlfa = ("000" + aAlfa) % -103;
     aAlfa = "|C"+aAlfa+"009WID";
     aID   = #0#aAlfa#;
     nID   = aID;

     aPopup1  = nID;  || Si fuera -1 en la posicion
     aPopup2  = 6;
     aPopup3  = "1.- Efectivo";
     aPopup4  = "2.- Adeudo en cuenta";
     aPopup5  = "3.- Domiciliacion";
     aPopup6  = "4.- Aplazamiento";
     aPopup7  = "5.- Aplazamiento + Ingreso";
     aPopup8  = "6.- Cuenta corriente tributaria (Ingreso y Devolucion)";

     IaPopup  = aPopup1  <-;
     |ESPECIFICA "TRACKPOPUP", aPopup;
     |SI FSalida ! 0;
         IaPopup  = aPopup3  <-;
         IaPopup  = IaPopup + (FSalida - 1);

         aAlfa = aPopup % 101;  #0Campo = aAlfa;
     |FINSI;
     |PINTA #0Campo;
|FPRC;

|| *******************************************************************
|PROCESO SelForma;
     eaForma = "";
     nSwFor  = 0;
     |SI #0#33 = "T";
         nSwFor = 1;
     |SINO;
         |SI #0#34 ! 0; |Y #0#34 = nForma; nSwFor = 1; |FINSI;
         |SI #0#35 ! 0; |Y #0#35 = nForma; nSwFor = 1; |FINSI;
         |SI #0#36 ! 0; |Y #0#36 = nForma; nSwFor = 1; |FINSI;
         |SI #0#37 ! 0; |Y #0#37 = nForma; nSwFor = 1; |FINSI;
     |FINSI;
     |SI nSwFor = 1;
         |SI nForma = 1; eaForma = "Efectivo               "; |FINSI;
         |SI nForma = 2; eaForma = "Adeudo en Cuenta       "; |FINSI;
         |SI nForma = 3; eaForma = "Domiciliacion          "; |FINSI;
         |SI nForma = 4; eaForma = "Aplazamiento           "; |FINSI;
         |SI nForma = 5; eaForma = "Aplazamiento + Ingreso "; |FINSI;
         |SI nForma = 6; eaForma = "Cta Cte Trib. (Ing/Dev)"; |FINSI;
    |FINSI;
|FPRC;

|PROCESO SelBanco;
     nSwBan = 0;
     |SI #0#2 = "D";
         |SI nBanco ] #0#3; |Y nBanco [ #0#4;
             nSwBan = 1;
         |FINSI;
     |SINO;
         |PARA nCampo = 5;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |SI #0nCampo ! 0; |Y nBanco = #0nCampo;
                   nSwBan = 1;
                   |SAL;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|PROCESO ImpModelo;
    nBanco = #9#3; |HAZ SelBanco;
    nForma = #9#9; |HAZ SelForma;
    |SI nSwFor = 1; |Y nSwBan = 1;
        enSwMod   = 1;
        |PRINT;  nSwHay = 1;
        enSwLinea = 2;
    |FINSI;
|FPRC;

|DEFBUCLE dsam0009;
     #9#1;
     ;
     #1#0, nDModelo;
     #1#0, nHModelo;
     ;
     NULL, ImpModelo;
|FIN;

|PROCESO ModeloGral;
     nForma = #1#104; |HAZ SelForma;
     nBanco = #1#88;  |HAZ SelBanco;
     |SI nSwBan = 1; |Y nSwFor = 1;
         enSwMod   = 0;
         |PRINT; nSwHay = 1;
         enSwLinea = 1;
     |FINSI;
|FPRC;

|PROCESO Imprimelos;

     |SI #0#38 = "P";
         nSwSi = 0;
         |PARA nPara1 = 41; |SI nPara1 [ 52; |HACIENDO nPara1 = nPara1 + 1;
               |SI #1#9 = #0nPara1;
                   nSwSi = 1;
                   |SAL;
               |FINSI;
         |SIGUE;

         |SI nSwSi = 0; |ACABA; |FINSI;
     |FINSI;

     enSwMod   = 0;
     enSwLinea = 0;

     |SI #0#18 = "D";
         nDModelo = #0#19;
         nHModelo = #0#20;
         |SI nDModelo = 0; |HAZ ModeloGral; |FINSI;
         |BUCLE dsam0009;
     |SINO;
         |PARA nCampo1 = 21;  |SI nCampo1 [ 32;  |HACIENDO nCampo1 = nCampo1 + 1;
               |SI #0nCampo1 ! 0
                   nDModelo= #0nCampo1;
                   nHModelo= #0nCampo1;
                   |BUCLE dsam0009;
               |SINO;
                   |SI nCampo1 = 21;
                       |HAZ ModeloGral;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0000T;
     #1#1;
     9, 85;
     #0#0, nDTEm, aDSit;
     #0#1, nHTEm, aHSit;
     ;
     NULL, Imprimelos;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |IMPRE 0;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |INFOR "dsay0017";
     |SI FSalida ! 0;
         |MENAV "    No existe Informe";
         |FINIMP;
         |ACABA;
     |FINSI;

 || ...  Situacion Activa/Inactiva
     |SI #0#53 = "X";
         aDSit = "A"; aHSit = "Z";
     |SINO;
         aDSit = #0#53; aHSit = #0#53;
     |FINSI;

 || ... Tipo Empresa
      |SI #0#38 = "D";
          nDTEm = #0#39; nHTEm = #0#40;
      |SINO;
          nDTEm = 0; nHTEm = 99;
      |FINSI;

     nSwHay    = 0;
     |BUCLE dsam0000T;
     |SI nSwHay = 1;  |PIEINF;  |FINSI;

     |FININF;
     |FINIMP;
|FPRC;
