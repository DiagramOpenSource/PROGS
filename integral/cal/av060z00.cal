|FICHEROS;
|FIN;

|VARIABLES;
     nModo            = -1;
     n0Vent           = -1;
     n1Vent           = -1;
     nTree            = 0;
     nHandle          = 0;

     aEsc1            = "";
     aEsc2            = "";
     aRetu            = "";
     aTecla           = "";
     aAlfa            = "";
     aAlfa1           = "";
     aAbre            = "";
     aPathLocal       = "";
     aFicTree         = "";
     aBuscar          = "";
     aRefresca        = "";
     aBase            = "";

     {-1}sTree        = 0;
         sT_nID       = 0;
         sT_nOper     = 0;
         sT_aData     = "";

     {-1}aVent        = "";
         aVent1       = 0;
         aVent2       = 0;
         aVent3       = 0;
         aVent4       = 0;
         aVent5       = "";

     &eaUnidadBasico  = "";
     &eaCer           = "";
     &eaBuz           = "";
|FIN;

|PROCESO Configuracion;
     |VENTANA 0501, 3599, -1, 0, "";
     n1Vent = FSalida;
     |PTEC 802;  |PAUSA;

     |SUB_EJECUTA "av060m01";

     |FINVENTANA n1Vent;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO MisNotificas;
     |VENTANA 0501, 3599, -1, 0, "";
     n1Vent = FSalida;
     |PTEC 802;  |PAUSA;

     eaCer = "";
     eaBuz = "";
     |SUB_EJECUTA "av060m03";

     |FINVENTANA n1Vent;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO EjecutaCron;
     |VENTANA 0501, 3599, -1, 0, "";
     n1Vent = FSalida;
     |PTEC 802;  |PAUSA;

     |SUB_EJECUTA "av060z02;MANUAL";

     |FINVENTANA n1Vent;

     |FOCOTECLADO nTree;
|FPRC;

|PROCESO EventoTree;
     |SI FEntrada = 0;  |ACABA;  |FINSI;

     aAlfa1 = Contenido;  |QBF aAlfa1;
     aAlfa1 = aAlfa1 % -101;
     |SI aAlfa1 = ":";
         |ACABA;
     |FINSI;

     aAlfa = Contenido % -105;

     |SI aAlfa = "     ";  |O aAlfa = "";
         |ACABA;
     |FINSI;

     |SI aAlfa = "GRID0";  |HAZ MisNotificas;    |FINSI;
     |SI aAlfa = "GRID1";  |HAZ Configuracion;   |FINSI;
     |SI aAlfa = "ECRON";  |HAZ EjecutaCron;     |FINSI;
     |SI aAlfa = "SALIR";  |PTEC 807;            |FINSI;
|FPRC;

|PROGRAMA;
     |CLS;

     |VENTANA 0501, 2380, -1, 16, "Elija opci¢n";
     n0Vent = FSalida;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODAL";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |PTEC 802;  |PAUSA;

     aAbre = aPathLocal + aFicTree;
     aAlfa = "TREECTRL,DEH {{" + aAbre + "}}";
     |CONTROL_SIMPLE 0, aAlfa, 0602, 2178, EventoTree;
     nTree = FSalida;

     sT_nID   = nTree;
     sT_nOper = 2;
     sT_aData = "1:";
     |ESPECIFICA "COMMANDCONTROL", sTree;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
         FSalida = "::{{001}}Salir," + nTree;
         |LEETECLA aTecla;
         |SI aTecla = aEsc1; |SAL;  |FINSI;
         |SI aTecla = aEsc2; |SAL;  |FINSI;
         |SI aTecla = aRetu; |SAL;  |FINSI;
     |SIGUE;

     aVent1 = -1;
     aVent2 = -1;
     aVent3 = 0;
     aVent4 = n0Vent;
     aVent5 = "MODELESS";
     |ESPECIFICA "ESTADO_VENTANA", aVent;

     |FINVENTANA n0Vent;
|FPRO;

|PROCESO CargaArbol;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO GrabaArbol;
     |HAZ LeeUnidadBasico;

     |DBASE aBase;  |QBF aBase;
     aPathLocal = eaUnidadBasico + "\documentos";   |RMKDIR aPathLocal;
     aPathLocal = aPathLocal + "\tmp";              |RMKDIR aPathLocal;
     aPathLocal = aPathLocal + "\";

     aFicTree = "av060m0101" + Usuario + ".txt";

     aAbre = aPathLocal + aFicTree;
     |XABRE "WBC", aAbre, nHandle;

     aAlfa   = "1:Consultar mis avisos {{GRID0}}";                       |HAZ CargaArbol;
     aAlfa   = "2:Ejecutar manualmente recepci¢n de correos {{ECRON}}";  |HAZ CargaArbol;
     aAlfa   = "3:Configuraci¢n DEH {{GRID1}}";                          |HAZ CargaArbol;
     aAlfa   = "4:---------------------------------------------------";                       |HAZ CargaArbol;
     aAlfa   = "5:Salir {{SALIR}}";                                      |HAZ CargaArbol;

     |XCIERRA nHandle;
|FPRC;

|PROCESO Tipo80;  |TIPO 80;
     |HAZ GrabaArbol;
|FPRC;

|PROCESO Tipo90;  |TIPO 90;
     aAbre = aPathLocal + aFicTree;  |RFBORRA aAbre;
|FPRC;
