|FICHEROS;
    dsam0000;
    dsam0025;
    dsam0105;
    dsam0125;

    dsat0005,MANTE;

    dsat005@;
|FIN;

|VARIABLES;
     nBoton2    = -1;
     nBoton3    = -1;
     nBoton4    = -1;
     nBoton5    = -1;
     nNoGraba   = 0;
     nPara1     = 0;
     nTecla     = 0;
     aBase      = "";
     aDef       = "";
     informe    = "";
     inform1    = "dsat0005";
     inform2    = "dsat1005";
     nAlgun     = 0;
     nSwError   = 0;
     nHay       = 0;

     &enEmpresa = 0;
     &enEmpPD   = 0;
     &enEjer    = 0;
     &aFuncion  = "";

     &eaFichero  = "";
     &eaDLiqu    = "";
     &eaHLiqu    = "";
     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDAgente  = 0;
     &enHAgente  = 0;
     &enDMes     = 0;
     &enHMes     = 0;
     &enDConve   = 0;
     &enHConve   = 0;

     &eSwLinea = 0;
     &enAgente = 0;
     &eaAgent1 = "";
     &eaAgente = "";
     &eaEmpPD  = "";
     &eaEmpPD1 = "";
     &eaTfnPD  = "";
|FIN;

|| ///////////////////////////////
|PROCESO Tipo0C32t005; |TIPO 0;
    |SI #dsat0005#Campo# ! "S"; |Y #dsat0005#Campo# ! "N";
        |ERROR;
    |FINSI;
|FPRC;

|PROCESO MTipo5;  |TIPO 5;
     |LEE 040#dsat0005.p;
     #dsat0005#32 = "N";
     |LINEAS_BI_ATRI #dsat0005#32, D, S, -1;
|FPRC;

|PROCESO Tipo12; |TIPO 12;
  ||
|FPRC;

|PROCESO EntraDatos;

   |LEE 141#dsat0005.=;
   |SI #dsat0005#13 = "S"; |O #dsat0005#19 = "S";
       |CONFI "0000NComision ya Liquidada, continuar";
       |SI FSalida ! 0;
           |LIBERA #dsat0005;
           |ACABA;
       |FINSI;
   |FINSI;

   nNoGraba = 0;

|ET Campo8;
   |ENCAMPO #8#dsat0005;
   |SI FSalida = 7; nNoGraba = 1; |VETE Fin; |FINSI;
   |SI FSalida = 1; |VETE Fin; |FINSI;

|ET Campo9;
   |ENCAMPO #9#dsat0005;
   |SI FSalida = 7; nNoGraba = 1; |VETE Fin; |FINSI;
   |SI FSalida = 1; |VETE Fin; |FINSI;
   |SI FSalida = 2; |VETE Campo8; |FINSI;

|ET Campo10;
   |ENCAMPO #10#dsat0005;
   |SI FSalida = 7; nNoGraba = 1; |VETE Fin; |FINSI;
   |SI FSalida = 1; |VETE Fin; |FINSI;
   |SI FSalida = 2; |VETE Campo9; |FINSI;

|ET Campo11;
   |ENCAMPO #11#dsat0005;
   |SI FSalida = 7; nNoGraba = 1; |VETE Fin; |FINSI;
   |SI FSalida = 1; |VETE Fin; |FINSI;
   |SI FSalida = 2; |VETE Campo10; |FINSI;

|ET Campo32;
   |ENCAMPO #32#dsat0005;
   |SI FSalida = 7; nNoGraba = 1; |VETE Fin; |FINSI;
   |SI FSalida = 1; |VETE Fin; |FINSI;
   |SI FSalida = 2; |VETE Campo11; |FINSI;

|ET Fin;
   |SI nNoGraba = 0;
       |GRABA 020#dsat0005.a;
   |FINSI;
   |LIBERA #dsat0005;
|FPRC;

|PROCESO MarcaDatos;
   |LEE 141#dsat0005.=;
   |SI #dsat0005#32 = "S";
       #dsat0005#32 = "N";
   |SINO;
       #dsat0005#32 = "S";
   |FINSI;
   |PINTA #dsat0005#32;

   |GRABA 020#dsat0005.a;
   |LIBERA #dsat0005;
|FPRC;

|| //////////////////////////////////////////////////////////////
|PROCESO InforDsat0005;
   |PARA nPara1 = 0; |SI nPara1 [ 34; |HACIENDO nPara1 = nPara1 + 1;
         #dsat0005#nPara1# = #dsat005@#nPara1#;
   |SIGUE;

   |SI nTecla = 13;
       |SI enEmpPD ! #dsat0005#3;
           |SI nHay = 1;
               eSwLinea = 2;
           |FINSI;
           enEmpPD  = #dsat0005#3;
           eaEmpPD  = #dsat0005#4;
           eaEmpPD1 = ("000" + #dsat0005#3) % -103;
           eaTfnPD  = #dsat0005#33;
           eSwLinea  = 0;
           nHay = 0;
       |FINSI;
   |FINSI;
   |PRINT;
   eSwLinea = 1;
   nAlgun = 1;
   nHay = 1;
|FPRC;

|DEFBUCLE LeeDsat0005_2;
   #dsat005@#2004;
   ;
   001, enDEmpresa, 2000, 000;
   999, enHEmpresa, 2099, 999;
   ;
   NULL, InforDsat0005;
|FIN;

|DEFBUCLE LeeDsat0005_1;
   #dsat005@#1003;
   ;
   enDEmpresa, 2000, 000;
   enHEmpresa, 2099, 999;
   ;
   NULL, InforDsat0005;
|FIN;
|| //////////////////////////////////////////////////////////////
|PROCESO LosInformes;
   |HAZ CargaFichero;
   |SI nSwError = 1;  |ACABA;  |FINSI;

   informe = inform1;
   |SI nTecla = 13; informe = inform2; |FINSI;

   nAlgun  = 0;
   |IMPRE 0;
   |SI FSalida ! 0;
       |ACABA;
   |FINSI;

   |INFOR informe;
   |SI FSalida ! 0;
       |MENAV "0000No existe informe";
       |FINIMP;
       |ACABA;
   |FINSI;

   |SALVA_DATOS #dsat0005;
   |SI nTecla = 12; |BUCLE LeeDsat0005_1; |FINSI;
   |SI nTecla = 13; |BUCLE LeeDsat0005_2; |FINSI;
   |SI nAlgun = 1;
       |PIEINF;
   |FINSI;
   |FININF;
   |FINIMP;

   |HAZ DesCargaFichero;
   |REPON_DATOS #dsat0005;
|FPRC;

|PROCESO CargaFichero;
   nSwError = 0;
   |DBASE aBase;
   aDef = aBase + "def/dsat0005";
   |CARGA_DEF aDef, dsat005@;
   |SI FSalida ! 0;
       |MENAV "0000Error cargado def, proceso interrumpido";
       nSwError = 1;
   |SINO;
       |NOME_DAT #dsat005@#eaFichero#;
   |FINSI;
|FPRC;

|PROCESO DesCargaFichero;
   |DESCARGA_DEF #dsat005@;
|FPRC;

|PROCESO Boton2m001;
     |PTEC 824;
|FPRC;

|PROCESO Boton3m001;
     |PTEC 825;
|FPRC;

|PROCESO Boton4m001;
     |PTEC 826;
|FPRC;

|PROCESO Boton5m001;
     |PTEC 827;
|FPRC;

|PROCESO FinBotont005;
     |FIN_CONTROL_WINDOWS nBoton2;
     |FIN_CONTROL_WINDOWS nBoton3;
     |FIN_CONTROL_WINDOWS nBoton4;
     |FIN_CONTROL_WINDOWS nBoton5;
     |PULSATECLA;
|FPRC;

|PROCESO Tipo0t005;  |TIPO 0;
     |HAZ FinBotont005;
|FPRC;

|PROCESO Tipo7t005;  |TIPO 7;
     |BLIN 04;

     |CONTROL_SIMPLE 0, "LBOTON,F2 Modificar Datos ", 0517, 0529, Boton2m001;
     nBoton2 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F3 Abrir ejer.siguiente S/N ", 0531, 0547, Boton3m001;
     nBoton3 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F4 Informe Clientes", 0549, 0562, Boton4m001;
     nBoton4 = FSalida;

     |CONTROL_SIMPLE 0, "LBOTON,F5 Inf.Emp.Aseguradora", 0564, 0579, Boton5m001;
     nBoton5 = FSalida;
|FPRC;

|PROCESO Tipo11t005;  |TIPO 11;
     nTecla = FSalida;

     |HAZ FinBotont005;

     enEmpresa     = #dsat0005#0;
     enEjer        = #dsat0005#1;

     |SI nTecla = 10;
         |HAZ EntraDatos;
         |PONCONTROL  23, "SI";
     |FINSI;

     |SI nTecla = 11;
         |HAZ MarcaDatos;
         |PONCONTROL  23, "SI";
         |ACABA;
     |FINSI;

     |SI nTecla = 12; |O nTecla = 13;
         |HAZ LosInformes;
         |ACABA;
     |FINSI;
|FPRC;
