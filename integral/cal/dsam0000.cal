|FICHEROS;
     :integral/dsam0000;                 || Datos Generales
     :integral/dsam0002;                 || Comentarios
     :integral/dsam0003;                 || Datos Rentas
     :integral/dsam0004;                 || Datos Familiares
     :integral/dsam0005;                 || Datos Direcciones
     :integral/dsam0007;                 || Fechas Se¤aladas
     :integral/dsam0008;                 || Conceptos Contratados
     :integral/dsam0009;                 || Datos Bancos Modelos
     :integral/dsam0010;                 || Datos Bancos Facturacion
     :integral/dsam0011;                 || Causas de la Baja
     :integral/dsam0012;                 || Agentes por Areas

     :integral/dsam0026,MANTE;                 || Vehiculos con tarjeta transportes

     :integral/dsam0106;                 || Datos Telefonos Cabecera
     :integral/dsam0107;                 || Datos Telefonos Lineas
     :integral/dsam0116;                 || Bancos Clientes
     :integral/dsam9998;                 || Parametros menu

     :integral/dsaw0000;                 || Pantalla Datos Fiscales
     :integral/dsaw0003;                 || Pantalla Datos Fiscales
     :integral/dsaw0004;                 || Pantalla Datos Subvenciones
     :integral/dsaw0006;                 || Pantalla Datos Certificados
     :integral/dsaw0007;                 || Pantalla Datos Agentes por areas
     :integral/dsaw0008;                 || Pantalla Datos Facturacion
     :integral/dsaw0009;                 || Pantalla Datos Empresas Sociedades
     :integral/dsaw0030;
     :integral/dsaw0033;                 || Pantalla Cuentas Anuales
     :integral/dsaw0002,MANTE;           || Empresas Obligadas

     :/basica/def/agifigen;              || Empresas basica
     :/basica/def/agim0033;              || Certificado de Socios
     :/basica/def/agim0009;              || LLamadas
     :/basica/def/agim0008;              || Visitas
     :/basica/def/agim0012;              || Archivos
     :/basica/def/agim0031;              || Subvenciones
     :/basica/def/agim0013;              || Entrevistas
     :/basica/def/agitab04;              || Tipos de Empresas
     :/basica/def/agicen14;              || Actividades

     :modelos/dsmom001;

     :facturar/facemp1;                  || Empresa facturar
     :facturar/asclient;                 || Clientes facturar

     :contasoc/maacceso;
     :contasoc/cuaccecl;

     Ref0001@;
|FIN;

|VARIABLES;
     aMensaje = "";

     &enSwDSArchi = 0;
     &codigo          = 0;
     &Ejercicio       = 0;
     &nombre          = "";
     &enMenuTribut    = 0;

     &enOperar        = 0;
     &eaVarDni        = "";
     &enCalcCif       = 0;
     &eaCliNif        = "";
     &enDentro        = 0;
     &eaNombreList    = "";
     &enCuadroIni     = 0;
     &enCuadroFin     = 0;
     &enCampoAncho    = 0;
     &enModoEdita     = 0;
     &enTotalVaria    = 0;
     &enVale          = 0;
     &enCliente       = 0;           || Variables Externa de un cal a otro.
     &enModo          = 0;
     &eaNombreEmp     = "";
     &eaNombreCli     = "";
     &enEmpresa       = 0;
     &eaEmpresa       = "";
     &enEmpSoc        = 0;
     &eaNombre1       = "";
     &eaNombre2       = "";
     &eaNombre3       = "";
     &enBanco         = 0;
     &eaBanco         = "";
     &enTipoFac       = 0;
     &enErrorMac      = 0;

     &enCodUbica      = 0;
     &eaRutaDocumento = "";
     &enBajaCli       = 0;
     &enEmpreFac      = 0;
     &enDesdeFuera    = 0;

     &enSwMal         = 0;
     &enCodRep        = 0;
     &eaNifRep        = "";
     &enDesdeRenta    = 0;
     &enActividad     = 0;
     &eaNombre        = "";
     &eaNif           = "";
     &eaPrograma      = "";
     &enAprobacion    = 0;
     &enCamF10        = 0;
     &enCamF9         = 0;

{500}&epPuntEdita   = "";


     aPrograma    = "";

     nBtnF2      = 0;
     nBtnF3      = 0;
     nBtnF4      = 0;
     nBtnF5      = 0;
     nBtnF6      = 0;
     nBtnF7      = 0;
     nBtnF8      = 0;
     nBtnF9      = 0;
     nBtnF10     = 0;

     nBotonMen1   = 0;
     nBotonMen2   = 0;
     nBotonMen3   = 0;
     nBotonMen4   = 0;
     nBotonMen5   = 0;
     nBotonMen6   = 0;
     nBotonMen7   = 0;
     nBotonMen8   = 0;
     nBotonMen9   = 0;
     nBotonMen10  = 0;
     nBotonMen11  = 0;

     nBtnCapa1_1  = 0;
     nBtnCapa1_2  = 0;
     nBtnCapa1_3  = 0;
     nBtnCapa1_4  = 0;
     nBtnCapa1_5  = 0;
     nBtnCapa1_6  = 0;
     nBtnCapa1_7  = 0;
     nBtnCapa1_8  = 0;
     nBtnCapa1_9  = 0;
     nBtnCapa1_10 = 0;

     nBtnCapa2_1 = 0;
     nBtnCapa2_2 = 0;
     nBtnCapa2_3 = 0;
     nBtnCapa2_4 = 0;
     nBtnCapa2_5 = 0;
     nBtnCapa2_6 = 0;

     aEsc         = "";
     aF2          = "";
     aF3          = "";
     aF4          = "";
     aF5          = "";
     aF6          = "";
     aF7          = "";
     aF8          = "";
     aF9          = "";
     aF10         = "";

     aLen         = "";
     aCaracter    = "";

     nLen         = 0;
     nPos         = 0;
     nNume        = 0;
     nEstoyCampo  = 0;
     nDSArchi     = 0;
     nDSParCli    = 0;
     nHandle      = 0;
     nSwHayasm22  = 0;
     nOkGes       = 0;
     nOkSeg       = 0;
     nOkCol       = 0;

     nOpcion      = 0;

     nSwDentro    = 0;
     nLinea       = 0;
     nVariable    = 0;
     nCodigo      = 0;
     nLong        = 0;
     nCaracter    = 0;
     nPosi        = 0;
     nPtec        = 0;
     nSwPasa      = 0;
     nModo        = 0;
     nValorEmpre  = 0;
     nValorRegis  = 0;
     nSwHayRepre  = 0;
     nGrabaTempo  = 0;
     nSwHistorico1 = 0;
     nSwHistorico2 = 0;
     nSwHistorico3 = 0;
     nSwHistorico4 = 0;
     nSwComunero   = 0;
     nEmpresaGuarda = 0;

     aOpcion      = "1";
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     nNume1       = 0;
     nNume2       = 0;
     nNume3       = 0;
     aNombreMenu  = "";
     aBase        = "";
     aCadena      = "";
     aFicheroActu = "";
     aContenido   = "";
     aContenNom   = "";
     aContenNo2   = "";
     aBarraMenu   =  "";

     aAvance      = "";
     aAtras       = "";
     aTecla       = "";
     aPulso       = "";

     fFecha       = @;

     nCampoD        = 0;
     nCampoO        = 0;
     nCampo         = 0;
     nCampo1        = 0;
     &enEjerBaja    = 0;
     nEstado12      = 0;

     aMenuF3_1   = "LBOTON,A.- Mantenimiento de Direcciones y Centros de Trabajos";
     aMenuF3_2   = "LBOTON,B.- Mantenimiento de Numeros de Telefonos";
     aMenuF3_3   = "LBOTON,C.- Mantenimiento de Datos Familiares"
     aMenuF3_4   = "LBOTON,D.- Mantenimiento de Datos Bancos Clientes, Facturacion y Otros";
     aMenuF3_5   = "LBOTON,E.- Mantenimiento de Actividades y Censo Fiscal";
     aMenuF3_6   = "LBOTON,F.- Mantenimiento de Planing y Modelos Oficiales Periodicos";
     aMenuF3_7   = "LBOTON,G.- Mantenimiento de Datos Facturacion";
     aMenuF3_8   = "LBOTON,H.- Mantenimiento de Fechas Se¤aladas";
     aMenuF3_9   = "LBOTON,I.- Mantenimiento de Comentarios, notas y avisos o bloqueos";
     aMenuF3_10  = "LBOTON,J.- Mantenimiento de Empresas Contables";
     aMenuF3_11  = "LBOTON,K.- Gestion de Procesos Varios";

     MenuDatBan1   = "LBOTON,A.- Mantenimiento de Datos Bancos Clientes, Facturacion y Otros";
     MenuDatBan2   = "LBOTON,B.- Bancos Cliente por Modelo";
     MenuDatBan3   = "LBOTON,C.- Bancos Cliente por Empresas de Facturacion";
     MenuDatBan4   = "LBOTON,D.- Mantenimiento de Agentes por Areas";
     MenuDatBan5   = "LBOTON,E.- Mantenimiento Organismos AA.PP. Facturacion Electronica";
     MenuDatBan6   = "LBOTON,F.- Menu Anterior";

     MenuCenso1    = "LBOTON,A.- Mantenimiento del Impuesto Actividades Economicas";
     MenuCenso2    = "LBOTON,B.- Mantenimiento del Censo Fiscal (Modelo 036-037)";
     MenuCenso3    = "LBOTON,C.- Representante y Obligado Tributario";
     MenuCenso4    = "LBOTON,D.- Mantenimiento del Censo Fiscal (Modelo 036-037 Version Anterior)";
     MenuCenso5    = "LBOTON,E.- Menu Anterior";

     MenuFactu1    = "LBOTON,A.- Mantenimiento de Conceptos Facturables";
     MenuFactu2    = "LBOTON,B.- Mantenimiento de Servicios Personalizados por Empresas";
     MenuFactu3    = "LBOTON,C.- Mantenimiento de Productos Personalizados por Empresas";
     MenuFactu4    = "LBOTON,D.- Menu Anterior";

     MenuModel1    = "LBOTON,A.- Modelos y Libros Oficiales por Empresas";
     MenuModel2    = "LBOTON,B.- Grupos de Empresas para los Modelos 110/111 y 190";
     MenuModel3    = "LBOTON,C.- Calculo Planing de Modelos y Libros Oficiales";
     MenuModel4    = "LBOTON,D.- Planing de Modelos y Libros Oficiales";
     MenuModel5    = "LBOTON,E.- Consulta Resumen Historico de Tributacion";
     MenuModel6    = "LBOTON,F.- Menu Anterior";

     MenuTexto1    = "LBOTON,A.- Mantenimiento de Comentarios y notas";
     MenuTexto2    = "LBOTON,B.- Mantenimiento aviso o bloqueo del cliente";
     MenuTexto3    = "LBOTON,C.- Menu Anterior";

     MenuVarios1   = "LBOTON,A.- Gestion de Certificados de contratistas y subcontratistas";
     MenuVarios2   = "LBOTON,B.- Gestion de Embargos";
     MenuVarios3   = "LBOTON,C.- Menu Anterior";

     aMenuF4_1   = "LBOTON,A.- Ficha de Sociedades";
     aMenuF4_2   = "LBOTON,B.- Datos Empresa del Impuesto de Sociedades por A¤os";
     aMenuF4_3   = "LBOTON,C.- Cuentas Anuales por A¤os";
     aMenuF4_4   = "LBOTON,D.- Certificados Socios de Valoracion de Acciones";
     aMenuF4_5   = "LBOTON,E.- Configuracion Memorias, I.Gestion y Actas por A¤os";
     aMenuF4_6   = "LBOTON,F.- Consulta Tipo Empresa por Ejercicio";
     aMenuF4_7   = "LBOTON,G.- Retribuciones a administradores";
     aMenuF4_8   = "LBOTON,H.- Prestamos a socios";

     aMenuF5_1  = "LBOTON,A.- Mantenimiento de Datos Laborales";
     aMenuF5_2  = "LBOTON,B.- Mantenimiento de Centros de Trabajos";
     aMenuF5_3  = "LBOTON,C.- Mantenimiento de Centros Especiales";
     aMenuF5_4  = "LBOTON,D.- Mantenimiento de Horarios";
     aMenuF5_5  = "LBOTON,E.- Mantenimiento de Explotaciones Agricolas";
     aMenuF5_6  = "LBOTON,F.- Mantenimiento de Trabajadores";
     aMenuF5_7  = "LBOTON,G.- Mantenimiento de Importes por Trabajadores";
     aMenuF5_8  = "LBOTON,H.- Mantenimiento de Horas Semanas Trabajadores Tiempo Parcial";
     aMenuF5_9  = "LBOTON,I.- Mantenimiento de Bases Cotizadas a la Seguridad Social";
     aMenuF5_10 = "LBOTON,J.- Mantenimiento de Epigrafes/Trabajador";
     aMenuF5_11 = "LBOTON,K.- Mantenimiento de Prorrateo por Areas y Secciones";

     aMenuF6_1  = "LBOTON,A.- Consultas";
     aMenuF6_2  = "LBOTON,B.- Agenda";
     aMenuF6_3  = "LBOTON,C.- Documentos";
     aMenuF6_4  = "LBOTON,D.- Visualizacion de tiquets";

     MenuConsul1  = "LBOTON,A.- Consulta de Facturacion por Periodos";
     MenuConsul2  = "LBOTON,B.- Consulta de Recibos Emitidos por A¤os";
     MenuConsul3  = "LBOTON,C.- Consulta de Rendimientos de Actividades";
     MenuConsul4  = "LBOTON,D.- Consulta de LLamadas Emitidas y Recibidas";
     MenuConsul5  = "LBOTON,E.- Consulta de Visitas Realizadas al Despacho";
     MenuConsul6  = "LBOTON,F.- Consulta de Entrevistas Mantenidas";
     MenuConsul7  = "LBOTON,G.- Consulta de Subvenciones Oficiales Tramitadas";
     MenuConsul8  = "LBOTON,H.- Consulta de Documentos Archivados";
     MenuConsul9  = "LBOTON,I.- Consultas por Fecha de los Datos del Despacho";
     MenuConsul10 = "LBOTON,J.- Menu Anterior";

     MenuArchivo1 = "LBOTON,A.- Ordenado por Documento-A¤o-Trimestre";
     MenuArchivo2 = "LBOTON,B.- Ordenado por A¤o-Trimestre-Documento";
     MenuArchivo3 = "LBOTON,C.- Ordenado por Fecha Archivo-Documento";
     MenuArchivo4 = "LBOTON,D.- Ordenado por Usuario-Documento      ";
     MenuArchivo5 = "LBOTON,E.- Menu Anterior";

     MenuHis1     = "LBOTON,A.- General                 ";
     MenuHis2     = "LBOTON,B.- Solo Archivos           ";
     MenuHis3     = "LBOTON,C.- Solo LLamadas           ";
     MenuHis4     = "LBOTON,D.- Solo Visitas            ";
     MenuHis5     = "LBOTON,E.- Solo Entrevistas        ";
     MenuHis6     = "LBOTON,F.- Menu Anterior";

     aMenuF7_1  = "LBOTON,A.- Transportes";
     aMenuF7_2  = "LBOTON,B.- Trafico";
     aMenuF7_3  = "LBOTON,C.- Agricultura";
     aMenuF7_4  = "LBOTON,D.- Gasoleo Profesional";

     aMenuF9_1  = "LBOTON,A.- Convenios";
     aMenuF9_2  = "LBOTON,B.- Viviendas";
     aMenuF9_3  = "LBOTON,C.- Vehiculos";
     aMenuF9_4  = "LBOTON,D.- Hogar";
     aMenuF9_5  = "LBOTON,E.- Vida riesgo";
     aMenuF9_6  = "LBOTON,F.- Decesos";
     aMenuF9_7  = "LBOTON,G.- Accidentes";
     aMenuF9_8  = "LBOTON,H.- Comunidad";
     aMenuF9_9  = "LBOTON,I.- Salud";
     aMenuF9_10 = "LBOTON,J.- Vida ahorro";
     aMenuF9_11 = "LBOTON,K.- Comercio";

     aMenuF10_1 = "LBOTON,A.- Proteccion de datos";
     aMenuF10_2 = "LBOTON,B.- Prevencion de riesgos laborales";
     aMenuF10_3 = "LBOTON,C.- Blanqueo de capitales";
     aMenuF10_4 = "LBOTON,D.- Compliance";
     aMenuF10_5 = "LBOTON,E.- Auditorias";
     aMenuF10_6 = "LBOTON,F.- Formacion";
     aMenuF10_7 = "LBOTON,G.- Juridico";

     aPassword    = "";

     &eaNuevo1    = "";
     &eaNuevo2    = "";
     &eaM22Prog   = "";
     &enM22Clie   = 0;
     &enM22MoFa   = 0;
     &eaM22MoFa   = "";
     &enM22Modo   = 0;
|FIN;

|PROCESO CambiaAplica;
     |SI enModo ! 1;  |ACABA;  |FINSI;

     |ABRE #agitab04;
     #agitab04#0 = #dsam0000#9;
     |LEE 000#agitab04.=;
     |SI FSalida ! 0;  |DDEFECTO #agitab04;  |FINSI;
     |CIERRA #agitab04;

     #dsam0000#65 = #agitab04#2;  |PINTA #dsam0000#65;
     #dsam0000#66 = #agitab04#3;  |PINTA #dsam0000#66;
     #dsam0000#67 = #agitab04#4;  |PINTA #dsam0000#67;
     #dsam0000#68 = #agitab04#5;  |PINTA #dsam0000#68;
     #dsam0000#69 = #agitab04#6;  |PINTA #dsam0000#69;
|FPRC;


        ********************** CONTROL DE LAS PESTA¥AS *********************

|PROCESO QuitaRaros;
     |QBF aAlfa;
     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|| Botones Generales -----------------------------------------------------

|PROCESO Aparece;
     |ESTADO_CONTROL nBtnF2,  "SHOW";
     |ESTADO_CONTROL nBtnF3,  "SHOW";
     |ESTADO_CONTROL nBtnF4,  "SHOW";
     |ESTADO_CONTROL nBtnF5,  "SHOW";
     |ESTADO_CONTROL nBtnF6,  "SHOW";
     |ESTADO_CONTROL nBtnF7,  "SHOW";
     |ESTADO_CONTROL nBtnF8,  "SHOW";
     |ESTADO_CONTROL nBtnF9,  "SHOW";
     |ESTADO_CONTROL nBtnF10, "SHOW";
|FPRC;

|PROCESO Desaparece;
     |ESTADO_CONTROL nBtnF2,  "HIDE";
     |ESTADO_CONTROL nBtnF3,  "HIDE";
     |ESTADO_CONTROL nBtnF4,  "HIDE";
     |ESTADO_CONTROL nBtnF5,  "HIDE";
     |ESTADO_CONTROL nBtnF6,  "HIDE";
     |ESTADO_CONTROL nBtnF7,  "HIDE";
     |ESTADO_CONTROL nBtnF8,  "HIDE";
     |ESTADO_CONTROL nBtnF9,  "HIDE";
     |ESTADO_CONTROL nBtnF10, "HIDE";
|FPRC;

|| Opcion F3 -----------------------------------------------------

|PROCESO ApareceOpcionF3;
     |POPV;

     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
     |ESTADO_CONTROL nBotonMen9,  "SHOW";
     |ESTADO_CONTROL nBotonMen10, "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF3;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;

     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
     |ESTADO_CONTROL nBotonMen9,  "HIDE";
     |ESTADO_CONTROL nBotonMen10, "HIDE";
|FPRC;

|PROCESO FinOpcionF3;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;
     |FIN_CONTROL_WINDOWS nBotonMen9;
     |FIN_CONTROL_WINDOWS nBotonMen10;
     |FIN_CONTROL_WINDOWS nBotonMen11;
     |PULSATECLA;
|FPRC;

|| Opcion F4 -----------------------------------------------------

|PROCESO ApareceOpcionF4;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF4;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
|FPRC;

|PROCESO FinOpcionF4;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;
     |PULSATECLA;
|FPRC;

|| Opcion F5 -----------------------------------------------------

|PROCESO ApareceOpcionF5;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
     |ESTADO_CONTROL nBotonMen9,  "SHOW";
     |ESTADO_CONTROL nBotonMen10, "SHOW";
     |ESTADO_CONTROL nBotonMen11, "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF5;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
     |ESTADO_CONTROL nBotonMen9,  "HIDE";
     |ESTADO_CONTROL nBotonMen10, "HIDE";
     |ESTADO_CONTROL nBotonMen11, "HIDE";
|FPRC;

|PROCESO FinOpcionF5;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;
     |FIN_CONTROL_WINDOWS nBotonMen9;
     |FIN_CONTROL_WINDOWS nBotonMen10;
     |FIN_CONTROL_WINDOWS nBotonMen11;
     |PULSATECLA;
|FPRC;

|| Opcion F6 -----------------------------------------------------

|PROCESO ApareceOpcionF6;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF6;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
|FPRC;

|PROCESO FinOpcionF6;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;

     |PULSATECLA;
|FPRC;

|| Opcion F7 -----------------------------------------------------

|PROCESO ApareceOpcionF7;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF7;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
|FPRC;

|PROCESO FinOpcionF7;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;

     |PULSATECLA;
|FPRC;

|| Opcion F9 -----------------------------------------------------

|PROCESO ApareceOpcionF9;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
     |ESTADO_CONTROL nBotonMen9,  "SHOW";
     |ESTADO_CONTROL nBotonMen10, "SHOW";
     |ESTADO_CONTROL nBotonMen11, "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF9;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
     |ESTADO_CONTROL nBotonMen9,  "HIDE";
     |ESTADO_CONTROL nBotonMen10, "HIDE";
     |ESTADO_CONTROL nBotonMen11, "HIDE";
|FPRC;

|PROCESO FinOpcionF9;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;
     |FIN_CONTROL_WINDOWS nBotonMen9;
     |FIN_CONTROL_WINDOWS nBotonMen10;
     |FIN_CONTROL_WINDOWS nBotonMen11;

     |PULSATECLA;
|FPRC;

|| Opcion F10 -----------------------------------------------------

|PROCESO ApareceOpcionF10;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF10;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
|FPRC;

|PROCESO FinOpcionF10;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;

     |PULSATECLA;
|FPRC;

|| --------------------------------------------------------------------

|PROCESO BuscaUnComunero;
     |SI #dsmom001#9 ! "01.01.0000";  |ACABA;  |FINSI;

     nSwComunero = 1;
     |ERROR10;
|FPRC;

|DEFBUCLE dsmom001;
     #dsmom001#2;
     ;
     #dsam0000#0, 01;
     #dsam0000#0, 99;
     ;
     NULL, BuscaUnComunero;
|FIN;

|PROCESO ImprimeDiferencias;
     aAlfa = #dsam0000#103 % -105;
     nNume = aAlfa;
     |SI nNume ! #dsam0000#0;  |Y nNume ! 0;
         aAlfa = "Codigo Contable : " + #dsam0000#103 + " distinto al Codigo del Cliente " + #dsam0000#0;
         |IMPRIME aAlfa;
     |FINSI;

     |SI nNume = 0;
         aAlfa = "Codigo Contable vacio en el Codigo de Cliente " + #dsam0000#0;
         |IMPRIME aAlfa;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0000;
     #dsam0000#1;
     ;
     00000;
     99999;
     ;
     NULL, ImprimeDiferencias;
|FIN;

|PROCESO RecogeCod;
     nEstoyCampo = 0;
     nCodigo     = #dsam0000#0;

     |SI FSalida = 17;
         |IMPRE 0;
         |SI FSalida ! 0;  |ACABA;  |FINSI;

         |BUCLE dsam0000;

         |FINIMP;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Comunero;  |TIPO 7;
     #dsam0000#11   = 0;
     #dsam0000#13   = 0;
     #dsam0000#14   = "";

     nSwComunero = 0;
     |BUCLE dsmom001;

     |SI nSwComunero = 0;  |ACABA;  |FINSI;

     |ABRE #agifigen;
     #agifigen#0 = #dsmom001#0;
     |LEE 040#agifigen.=;
     |SI FSalida ! 0;  |DDEFECTO #agifigen;  |FINSI;
     |CIERRA #agifigen;

     #dsam0000#11   = #dsmom001#7;   |PINTA #dsam0000#11;
     #dsam0000#13   = #agifigen#0;   |PINTA #dsam0000#13;
     #dsam0000#14   = #agifigen#2;   |PINTA #dsam0000#14;
|FPRC;

        ********************** PANTALLA PRINCIPAL *********************

|PROCESO GrabaTelef;
     |ABRE #dsam0106;
     #dsam0106#0 = #dsam0000#1;
     |LEE 101#dsam0106.=;
     |SI FSalida ! 0;
         #dsam0106#0 = #dsam0000#1;
         #dsam0106#1 = #dsam0000#27;
         #dsam0106#2 = #dsam0000#28;
         |GRABA 020#dsam0106.n;
     |SINO;
         #dsam0106#1 = #dsam0000#27;
         #dsam0106#2 = #dsam0000#28;
         |GRABA 020#dsam0106.a;
     |FINSI;
     |LIBERA #dsam0106;
     |CIERRA #dsam0106;

     |ABRE #dsam0107;
     #dsam0107#0 = #dsam0106#0;
     #dsam0107#1 = 1;
     |LEE 001#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsam0000#1;
         #dsam0107#1 = 1;
         #dsam0107#2 = "TELEFONO PRINCIPAL  ";
         #dsam0107#4 = #dsam0000#54;
         |GRABA 040#dsam0107.n;
     |FINSI;

     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 2;
     |LEE 040#dsam0107.=;
     |SI FSalida ! 0;
         |DDEFECTO #dsam0107;
         #dsam0107#0 = #dsam0000#1;
         #dsam0107#1 = 2;
         #dsam0107#2 = "TELEFONO DE CONTACTO";
         |GRABA 020#dsam0107.n;
     |FINSI;
     |CIERRA #dsam0107;
|FPRC;

|PROCESO PintaTitulo;
     aAlfa = aAlfa % 0880;
     aAlfa = (aAlfa + (" " * 79)) % 179;
     |ATRI I;  |PINTA 0702, aAlfa;  |ATRI i;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F3 -----------------------

        ********************** DIRECCIONES *********************

|PROCESO Direcciones;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     aAlfa          = aMenuF3_1;  |HAZ PintaTitulo;
     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;
     enActividad    = 0;

     |SUB_EJECUTA_NP ":integral/dsam0005";

     |LIBERA #dsam0000;

     |ABRE #dsam0005;
     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#19  = #dsam0005#3;
         #dsam0000#20  = #dsam0005#4;
         #dsam0000#21  = #dsam0005#5;
         #dsam0000#22  = #dsam0005#6;
         #dsam0000#23  = #dsam0005#7;
         #dsam0000#24  = #dsam0005#8;
         #dsam0000#25  = #dsam0005#9;
         #dsam0000#26  = #dsam0005#10;
         #dsam0000#27  = #dsam0005#11;
         #dsam0000#28  = #dsam0005#12;
         #dsam0000#98  = #dsam0005#17;
         #dsam0000#99  = #dsam0005#18;
         #dsam0000#86  = #dsam0005#15;
         #dsam0000#87  = #dsam0005#16;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 98;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#29 = #dsam0005#3;
         #dsam0000#30 = #dsam0005#4;
         #dsam0000#31 = #dsam0005#5;
         #dsam0000#32 = #dsam0005#6;
         #dsam0000#33 = #dsam0005#7;
         #dsam0000#34 = #dsam0005#8;
         #dsam0000#35 = #dsam0005#9;
         #dsam0000#36 = #dsam0005#10;
         #dsam0000#37 = #dsam0005#11;
         #dsam0000#38 = #dsam0005#12;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 99;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#39 = #dsam0005#3;
         #dsam0000#40 = #dsam0005#4;
         #dsam0000#41 = #dsam0005#5;
         #dsam0000#42 = #dsam0005#6;
         #dsam0000#43 = #dsam0005#7;
         #dsam0000#44 = #dsam0005#8;
         #dsam0000#45 = #dsam0005#9;
         #dsam0000#46 = #dsam0005#10;
         #dsam0000#47 = #dsam0005#11;
         #dsam0000#48 = #dsam0005#12;

         |ABRE #dsam0003;
         #dsam0003#0 = #dsam0000#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             #dsam0003#24 = #dsam0000#39;
             #dsam0003#25 = #dsam0000#40;
             #dsam0003#26 = #dsam0000#41;
             #dsam0003#27 = #dsam0000#42;
             #dsam0003#28 = #dsam0000#43;
             #dsam0003#29 = #dsam0000#44;
             #dsam0003#30 = #dsam0000#45;
             #dsam0003#31 = #dsam0000#46;
             #dsam0003#32 = #dsam0000#47;
             #dsam0003#33 = (("00" + #dsam0003#30) % -102) + (("000" + #dsam0003#31) % -103);
             |GRABA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;
     |CIERRA #dsam0005;

     |GRABA 020#dsam0000.a;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** TELEFONOS *********************

|RUTINA ClaveBaja107;
     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 01;
|FRUT;

|RUTINA ClaveAlta107;
     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 99;
|FRUT;

|PROCESO Telefonos;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     |PUSHV 0501 2380;
     aAlfa          = aMenuF3_2;  |HAZ PintaTitulo;
     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;

     |ENTLINEAL #1#dsam0107, -2, enModo, 22, 1, ClaveBaja107, ClaveAlta107;
     |POPV;

     |LIBERA #dsam0000;
     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     |ABRE #dsam0107;

     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 1;
     |LEE 040#dsam0107.=;
     |SI FSalida = 0;
         #dsam0000#54 = #dsam0107#4;
     |FINSI;

     #dsam0107#0 = #dsam0000#1;
     #dsam0107#1 = 2;
     |LEE 040#dsam0107.=;
     |SI FSalida = 0;
         #dsam0000#55 = #dsam0107#4;
     |FINSI;

     |CIERRA #dsam0107;

     |GRABA 020#dsam0000.a;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

|PROCESO DFamiliares;
     |SI #dsam0000#68 = "N";
         |MENAV "     El Cliente no hace Rentas.";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;
     aAlfa = aMenuF3_3;  |HAZ PintaTitulo;

     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;

     |SUB_EJECUTA_NP ":integral/dsaw0200";

     |LIBERA #dsam0000;
     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     #dsam0000#100     = eaNombre1;
     #dsam0000#101     = eaNombre2;
     #dsam0000#102     = eaNombre3;

     |GRABA 020#dsam0000.a;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** OTROS DATOS ***********************************

|PROCESO MenuDatBan1;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     eaM22Prog = "dsam0000";
     enM22Clie = enEmpresa;
     enM22MoFa = 0;
     eaM22MoFa = "";
     enM22Modo = enModo;

     #dsaw0003#0  = #dsam0000#88;
     #dsaw0003#1  = #dsam0000#89;
     #dsaw0003#2  = #dsam0000#90;
     #dsaw0003#3  = #dsam0000#91;
     #dsaw0003#4  = #dsam0000#92;
     #dsaw0003#5  = #dsam0000#93;
     #dsaw0003#6  = #dsam0000#104;
     #dsaw0003#7  = #dsam0000#94;
     #dsaw0003#8  = #dsam0000#73;
     #dsaw0003#9  = #dsam0000#74;
     #dsaw0003#10 = #dsam0000#95;
     #dsaw0003#11 = #dsam0000#96;
     #dsaw0003#12 = #dsam0000#97;
     #dsaw0003#13 = #dsam0000#103;
     #dsaw0003#14 = #dsam0000#4;
     #dsaw0003#15 = #dsam0000#70;
     #dsaw0003#16 = #dsam0000#71;

     |ABRE #dsam0116;
     #dsam0116#0 = #dsaw0003#0;
     |LEE 000#dsam0116.=;
     |SI FSalida ! 0;  |DDEFECTO #dsam0116;  |FINSI;
     |CIERRA #dsam0116;

     #dsaw0003#17 = #dsam0116#5;
     #dsaw0003#18 = #dsam0000#111;
     #dsaw0003#19 = #dsam0000#112;
     #dsaw0003#20 = #dsam0000#114;
     #dsaw0003#21 = #dsam0000#115;
     #dsaw0003#22 = #dsam0000#116;
     #dsaw0003#23 = #dsam0000#118;
     #dsaw0003#24 = #dsam0000#117;
     #dsaw0003#25 = #dsam0000#119;

     |PUSHV 0501 2380;

     nEmpresaGuarda = #dsam0000#0;
     enEmpresa      = #dsam0000#0;

     |PINPA #0#dsaw0003;
     |PINDA #0#dsaw0003;

     |ATRI I;
     |SI #dsaw0003#25 = "R";
        |PINTA 1769, "Recurrente";
     |SINO;
        |PINTA 1769, "Unico";
     |FINSI;
     |ATRI N;

     aAlfa = MenuDatBan1;  |HAZ PintaTitulo;

     |SI enSwDSArchi = 1;
          |C_M #dsaw0003#18, 1, "S";
     |SINO;
          |C_M #dsaw0003#18, 1, "N";
          #dsaw0003#19 = "N"; |PINTA #dsaw0003#19;
     |FINSI;

     |SI enModo ! 4;
         |HAZ GrabaAntesM22;
         |SI enModo = 2;
             |ENDATOS #2#dsaw0003;
         |SINO;
             |ENDATOS #1#dsaw0003;
         |FINSI;
         |SI FSalida = 0;
             |LIBERA #dsam0000;

             #dsam0000#0 = nEmpresaGuarda;
             |LEE 101#dsam0000.=;

             #dsam0000#88  = #dsaw0003#0;
             #dsam0000#89  = #dsaw0003#1;
             #dsam0000#90  = #dsaw0003#2;
             #dsam0000#91  = #dsaw0003#3;
             #dsam0000#92  = #dsaw0003#4;
             #dsam0000#93  = #dsaw0003#5;
             #dsam0000#104 = #dsaw0003#6;
             #dsam0000#94  = #dsaw0003#7;
             #dsam0000#73  = #dsaw0003#8;
             #dsam0000#74  = #dsaw0003#9;
             #dsam0000#95  = #dsaw0003#10;
             #dsam0000#96  = #dsaw0003#11;
             #dsam0000#97  = #dsaw0003#12;
             #dsam0000#103 = #dsaw0003#13;
             #dsam0000#4   = #dsaw0003#14;
             #dsam0000#70  = #dsaw0003#15;
             #dsam0000#71  = #dsaw0003#16;
             #dsam0000#111 = #dsaw0003#18;
             #dsam0000#112 = #dsaw0003#19;
             #dsam0000#114 = #dsaw0003#20;
             #dsam0000#115 = #dsaw0003#21;
             #dsam0000#116 = #dsaw0003#22;
             #dsam0000#117 = #dsaw0003#24;
             #dsam0000#118 = #dsaw0003#23;
             #dsam0000#119 = #dsaw0003#25;

             |GRABA 020#dsam0000.a;
             |LIBERA #dsam0000;
             |HAZ GrabaDespuesM22;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|RUTINA ClaveBaja9;
     #dsam0009#0 = #dsam0000#0;
     #dsam0009#1 = 001;
|FRUT;

|RUTINA ClaveAlta9;
     #dsam0009#0 = #dsam0000#0;
     #dsam0009#1 = 999;
|FRUT;

|PROCESO MenuDatBan2;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     |MENAV "0000 Si no introducimos Bancos por Modelo, al Emitir el Modelo el Banco sera el del Punto A";

     |PUSHV 0501 2380;

     aAlfa = MenuDatBan2;  |HAZ PintaTitulo;

     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0009, -2, 2, 22, 1, ClaveBaja9, ClaveAlta9;
     |SINO;
         |ENTLINEAL #1#dsam0009, -2, 4, 22, 1, ClaveBaja9, ClaveAlta9;
     |FINSI;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|RUTINA ClaveBaja10;
     #dsam0010#0 = #dsam0000#0;
     #dsam0010#1 = 01;
|FRUT;

|RUTINA ClaveAlta10;
     #dsam0010#0 = #dsam0000#0;
     #dsam0010#1 = 99;
|FRUT;

|PROCESO MenuDatBan3;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     |MENAV "0000 Si no introducimos Bancos por Facturacion, tomara en todas las Empresas el Banco del Punto A";

     |PUSHV 0501 2380;

     aAlfa = MenuDatBan3;  |HAZ PintaTitulo;

     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0010, -2, 2, 14, 1, ClaveBaja10, ClaveAlta10;
     |SINO;
         |ENTLINEAL #1#dsam0010, -2, 4, 14, 1, ClaveBaja10, ClaveAlta10;
     |FINSI;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO AltaAgenteArea;
     #dsam0012#0 = #dsam0000#0;
     #dsam0012#1 = nNume1;
     |LEE 141#dsam0012.=;
     nEstado12 = FSalida;
     nNume3 = 64 + nNume1;
     |SI #dsam0000#nNume3# = "N";
         |SI nEstado12 = 0;
             |BORRA 020#dsam0012.a;
         |FINSI;
     |SINO;
         #dsam0012#4 = "Fiscal";
         |SI #dsam0012#1 = 1; #dsam0012#4 = "Contabilidad"; |FINSI;
         |SI #dsam0012#1 = 3; #dsam0012#4 = "Sociedades  "; |FINSI;
         |SI #dsam0012#1 = 4; #dsam0012#4 = "Renta       "; |FINSI;
         |SI #dsam0012#1 = 5; #dsam0012#4 = "Laboral     "; |FINSI;
         nNume2 = nNume1 * 2; #dsam0012#2 = #dsaw0007#nNume2#;
         nNume2 = nNume2 + 1; #dsam0012#3 = #dsaw0007#nNume2#;
         |SI nEstado12 = 0; |GRABA 020#dsam0012.a; |FINSI;
         |SI nEstado12 ! 0; |GRABA 020#dsam0012.n; |FINSI;
     |FINSI;
     |LIBERA #dsam0012;
|FPRC;

|PROCESO LeeAgentesAreas;
     nNume1 = #dsam0012#1 * 2;
     nNume2 = nNume1 + 1;
     nNume3 = #dsam0012#1 + 64;
     |SI #dsam0000#nNume3# = "S";
         #dsaw0007#nNume1# = #dsam0012#2;
         #dsaw0007#nNume2# = #dsam0012#3;
     |FINSI;
     |SI #dsam0012#1 = 2; nEstado12 = 1; |FINSI;
|FPRC;

|DEFBUCLE LeeAgentesAreas;
     #dsam0012#1;
     ;
     #dsam0000#0, 1;
     #dsam0000#0, 5;
     ;
     NULL, LeeAgentesAreas;
|FIN;

|PROCESO MenuDatBan4;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

      |PUSHV 0501 2380;
      aAlfa = MenuDatBan4;  |HAZ PintaTitulo;

      aPassword = "";
      |CUADRO 0801 2380;
      |BLANCO 0902 2279;
      |PINTA 1320, "Introduzca Password : ";
      E_inf = "";
      E_sup = "20";
      aPassword = 1342 ? -1;
      |SI aPassword ! "<MYPASWD>     ";
          |MENAV "     Permiso denegado.";
          |VETE AcabanSub4;
      |FINSI;

     |DDEFECTO #dsaw0007;
     #dsaw0007#0  = #dsam0000#72;
     #dsaw0007#1  = #dsam0000#52;

     nEstado12 = 0;
     |BUCLE LeeAgentesAreas;

     aAlfa1 = #dsam0000#65; |C_M #dsaw0007#2,  1, aAlfa1; #dsaw0007#12 = #dsam0000#65;
     aAlfa1 = #dsam0000#66; |C_M #dsaw0007#4,  1, aAlfa1; #dsaw0007#13 = #dsam0000#66;
     aAlfa1 = #dsam0000#67; |C_M #dsaw0007#6,  1, aAlfa1; #dsaw0007#14 = #dsam0000#67;
     aAlfa1 = #dsam0000#68; |C_M #dsaw0007#8,  1, aAlfa1; #dsaw0007#15 = #dsam0000#68;
     aAlfa1 = #dsam0000#69; |C_M #dsaw0007#10, 1, aAlfa1; #dsaw0007#16 = #dsam0000#69;

     |SI nEstado12 = 0; |Y #dsaw0007#13 = "S";
         #dsaw0007#4 = #dsaw0007#0; #dsaw0007#5 = #dsaw0007#1;
     |FINSI;

     nEmpresaGuarda = #dsam0000#0;
     enEmpresa      = #dsam0000#0;

     |PINPA #0#dsaw0007;
     |PINDA #0#dsaw0007;

     aAlfa = MenuDatBan4;  |HAZ PintaTitulo;

     |SI enModo ! 4;
         |SI enModo = 2;
             |ENDATOS #2#dsaw0007;
         |SINO;
             |ENDATOS #1#dsaw0007;
         |FINSI;
         |SI FSalida = 0;
             |LIBERA #dsam0000;

             #dsam0000#0 = nEmpresaGuarda;
             |LEE 101#dsam0000.=;

             #dsam0000#72  = #dsaw0007#0;
             #dsam0000#52  = #dsaw0007#1;
             |ABRE #dsam0012;
             |PARA nNume1 = 1; |SI nNume1 [ 5; |HACIENDO nNume1 = nNume1 + 1;
                   |HAZ AltaAgenteArea;
             |SIGUE;
             |CIERRA #dsam0012;
             |GRABA 020#dsam0000.a;
         |FINSI;
     |SINO;
         |LEETECLA aTecla;
     |FINSI;

|ET AcabanSub4;
     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuDatBan5;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     aAlfa = MenuCenso1;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP "dsam0020";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuDatBan6;
     |PTEC 806;
|FPRC;

|PROCESO DOtros;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_4;  |HAZ PintaTitulo;

     aAlfa = MenuDatBan1;  |HAZ QuitaRaros;  MenuDatBan1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan1, 1110, 1173, MenuDatBan1;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuDatBan2;  |HAZ QuitaRaros;  MenuDatBan2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan2, 1210, 1273, MenuDatBan2;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuDatBan3;  |HAZ QuitaRaros;  MenuDatBan3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan3, 1310, 1373, MenuDatBan3;
     nBtnCapa1_3 = FSalida;

     aAlfa = MenuDatBan4;  |HAZ QuitaRaros;  MenuDatBan4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan4, 1410, 1473, MenuDatBan4;
     nBtnCapa1_4 = FSalida;

     aAlfa = MenuDatBan5;  |HAZ QuitaRaros;  MenuDatBan5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan5, 1510, 1573, MenuDatBan5;
     nBtnCapa1_5 = FSalida;

     aAlfa = MenuDatBan6;  |HAZ QuitaRaros;  MenuDatBan6 = aAlfa;
     |CONTROL_SIMPLE 0, MenuDatBan6, 1610, 1673, MenuDatBan6;
     nBtnCapa1_6 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuDatBan1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuDatBan2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuDatBan3;  |FINSI;
         |SI aTecla = "D";  |HAZ MenuDatBan4;  |FINSI;
         |SI aTecla = "E";  |HAZ MenuDatBan5;  |FINSI;
         |SI aTecla = "F";  |SAL;              |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |FIN_CONTROL_WINDOWS nBtnCapa1_4;
     |FIN_CONTROL_WINDOWS nBtnCapa1_5;
     |FIN_CONTROL_WINDOWS nBtnCapa1_6;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** ACTIVIDADES  *****************************

|PROCESO MenuCenso1;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";

     aAlfa = MenuCenso1;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":basica/agicen14";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
|FPRC;

|PROCESO MenuCenso2;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";

     aAlfa = MenuCenso2;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":basica/agicen20";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
|FPRC;

|PROCESO MenuCenso3;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";

     eaNombreEmp = #dsam0000#1;
     aAlfa = MenuCenso3;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":basica/agicen15";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
|FPRC;

|PROCESO MenuCenso4;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";

     aAlfa = MenuCenso4;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":basica/agicen16";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
|FPRC;

|PROCESO MenuCenso5;
     |PTEC 806;
|FPRC;

|PROCESO DActividad;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_5;  |HAZ PintaTitulo;

     aAlfa = MenuCenso1;  |HAZ QuitaRaros;  MenuCenso1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuCenso1, 1110, 1173, MenuCenso1;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuCenso2;  |HAZ QuitaRaros;  MenuCenso2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuCenso2, 1210, 1273, MenuCenso2;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuCenso3;  |HAZ QuitaRaros;  MenuCenso3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuCenso3, 1310, 1373, MenuCenso3;
     nBtnCapa1_3 = FSalida;

     aAlfa = MenuCenso4;  |HAZ QuitaRaros;  MenuCenso4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuCenso4, 1410, 1473, MenuCenso4;
     nBtnCapa1_4 = FSalida;

     aAlfa = MenuCenso5;  |HAZ QuitaRaros;  MenuCenso5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuCenso5, 1510, 1573, MenuCenso5;
     nBtnCapa1_5 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuCenso1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuCenso2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuCenso3;  |FINSI;
         |SI aTecla = "D";  |HAZ MenuCenso4;  |FINSI;
         |SI aTecla = "E";  |SAL;             |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |FIN_CONTROL_WINDOWS nBtnCapa1_4;
     |FIN_CONTROL_WINDOWS nBtnCapa1_5;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** MODELOS OFICALES  *****************************

|PROCESO MenuModel1;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     eaCliNif = #dsam0000#3;
     aAlfa = MenuModel1;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":modelos/dsmom006";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuModel2;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     aAlfa = MenuModel2;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":modelos/dsmom026";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuModel3;
     |SI enModo = 4;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     aAlfa = MenuModel3;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":modelos/dsmoz001";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuModel4;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     aAlfa = MenuModel4;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":modelos/dsmom003";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuModel5;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";

     aAlfa = MenuModel5;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":modelos/dsmom023";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
|FPRC;

|PROCESO MenuModel6;
     |PTEC 806;
|FPRC;

|PROCESO DModelos;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_6;  |HAZ PintaTitulo;

     aAlfa = MenuModel1;  |HAZ QuitaRaros;  MenuModel1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel1, 1110, 1173, MenuModel1;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuModel2;  |HAZ QuitaRaros;  MenuModel2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel2, 1210, 1273, MenuModel2;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuModel3;  |HAZ QuitaRaros;  MenuModel3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel3, 1310, 1373, MenuModel3;
     nBtnCapa1_3 = FSalida;

     aAlfa = MenuModel4;  |HAZ QuitaRaros;  MenuModel4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel4, 1410, 1473, MenuModel4;
     nBtnCapa1_4 = FSalida;

     aAlfa = MenuModel5;  |HAZ QuitaRaros;  MenuModel5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel5, 1510, 1573, MenuModel5;
     nBtnCapa1_5 = FSalida;

     aAlfa = MenuModel6;  |HAZ QuitaRaros;  MenuModel6 = aAlfa;
     |CONTROL_SIMPLE 0, MenuModel6, 1610, 1673, MenuModel6;
     nBtnCapa1_6 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuModel1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuModel2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuModel3;  |FINSI;
         |SI aTecla = "D";  |HAZ MenuModel4;  |FINSI;
         |SI aTecla = "E";  |HAZ MenuModel5;  |FINSI;
         |SI aTecla = "F";  |SAL;             |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |FIN_CONTROL_WINDOWS nBtnCapa1_4;
     |FIN_CONTROL_WINDOWS nBtnCapa1_5;
     |FIN_CONTROL_WINDOWS nBtnCapa1_6;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;
        ********************** DATOS FACTURACION ***************************

|RUTINA ClaveBaja8;
     #dsam0008#0 = #dsam0000#0;
     #dsam0008#1 = 01;
|FRUT;

|RUTINA ClaveAlta8;
     #dsam0008#0 = #dsam0000#0;
     #dsam0008#1 = 99;
|FRUT;

|PROCESO MenuFactu1;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";

     |PUSHV 0501 2380;

     aAlfa = aMenuF3_7;  |HAZ PintaTitulo;

     |SI enModo ! 4;
         |ENTLINEAL #1#dsam0008, -2, 2, 22, 1, ClaveBaja8, ClaveAlta8;
     |SINO;
         |ENTLINEAL #1#dsam0008, -2, 4, 22, 1, ClaveBaja8, ClaveAlta8;
     |FINSI;

     |HAZ PasaFacturacion;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
|FPRC;

|PROCESO MenuFactu2;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";

     enEmpresa  = #dsam0000#0;
     enTipoFac  = 1;

     aAlfa = MenuFactu2;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":facturar/facemp2";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
|FPRC;

|PROCESO MenuFactu3;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";

     enEmpresa  = #dsam0000#0;
     enTipoFac  = 2;

     aAlfa = MenuFactu3;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":facturar/facemp2";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
|FPRC;

|PROCESO MenuFactu4;
     |PTEC 806;
|FPRC;

|PROCESO DDatosFact;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_7;  |HAZ PintaTitulo;

     aAlfa = MenuFactu1;  |HAZ QuitaRaros;  MenuFactu1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuFactu1, 1110, 1173, MenuFactu1;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuFactu2;  |HAZ QuitaRaros;  MenuFactu2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuFactu2, 1210, 1273, MenuFactu2;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuFactu3;  |HAZ QuitaRaros;  MenuFactu3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuFactu3, 1310, 1373, MenuFactu3;
     nBtnCapa1_3 = FSalida;

     aAlfa = MenuFactu4;  |HAZ QuitaRaros;  MenuFactu4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuFactu4, 1410, 1473, MenuFactu4;
     nBtnCapa1_4 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuFactu1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuFactu2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuFactu3;  |FINSI;
         |SI aTecla = "D";  |SAL;             |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |FIN_CONTROL_WINDOWS nBtnCapa1_4;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** FECHAS SE¥ALADAS *********************

|RUTINA ClaveBaja7;
     #dsam0007#0 = #dsam0000#0;
     #dsam0007#1 = 01;
|FRUT;

|RUTINA ClaveAlta7;
     #dsam0007#0 = #dsam0000#0;
     #dsam0007#1 = 99;
|FRUT;

|PROCESO FechasSenal;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     |PUSHV 0501 2380;
     aAlfa = aMenuF3_8;  |HAZ PintaTitulo;
     |ENTLINEAL #1#dsam0007, -2, enModo, 22, 1, ClaveBaja7, ClaveAlta7;
     |POPV;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** COMENTARIOS Y BLOQUEOS *********************************

|PROCESO MenuTexto1;  |FINSI;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";

     |PUSHV 0501 2380;

     aAlfa = MenuTexto1;  |HAZ PintaTitulo;

     |SI enModo = 4;
         aAlfa =  "MODO CONSULTA (No grabara si se escribe)";
         |ATRI R;  |PINTA 0840, aAlfa;  |ATRI i;
     |FINSI;

     enTotalVaria  = 100;
     eaNombreList  = "";
     enCuadroIni   = 0902;
     enCuadroFin   = 2279;
     enCampoAncho  = 76;
     enModoEdita   = 1100;

     |ABRE #dsam0002;
     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita  = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 101#dsam0002.=;
           |SI FSalida ! 0;
               epPuntEdita  = "";
           |SINO;
               epPuntEdita  = #dsam0002#2;
               |SI enModo ! 4;  |BORRA 020#dsam0002.a;  |FINSI;
           |FINSI;
           |LIBERA #dsam0002;
     |SIGUE;

     |HAZ Edita;
     |SI enModo = 4;
         |POPV;

         |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
         |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
         |ESTADO_CONTROL nBtnCapa1_3, "SHOW";

         |PULSATECLA;
         |ACABA;
     |FINSI;

     |PARA nVariable = 1;  |SI nVariable [ 100;  |HACIENDO nVariable = nVariable + 1;
           IepPuntEdita = epPuntEdita1 <-;
           IepPuntEdita = IepPuntEdita + (nVariable - 1);

           |DDEFECTO #dsam0002;
           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 1010#dsam0002.=;
           |SI FSalida ! 0;  |GRABA 020#dsam0002.b;  |FINSI;
           #dsam0002#2 = epPuntEdita;
           |GRABA 020#dsam0002.a;
           |LIBERA #dsam0002;
     |SIGUE;

     |PARA nVariable = 100;  |SI nVariable ] 1;  |HACIENDO nVariable = nVariable - 1;
           #dsam0002#0 = #dsam0000#0;
           #dsam0002#1 = nVariable;
           |LEE 101#dsam0002.=;
           aAlfa = #dsam0002#2;  |QBF aAlfa;

           |SI aAlfa ! "";  |LIBERA #dsam0002;  |SAL;  |FINSI;

           |BORRA 020#dsam0002.a;
           |LIBERA #dsam0002;
     |SIGUE;
     |CIERRA #dsam0002;

     |POPV;
     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |PULSATECLA;
|FPRC;

|PROCESO MenuTexto2;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";

     |PUSHV 0501 2380;
     enEmpresa = #dsam0000#0;

     aAlfa = MenuTexto2;  |HAZ PintaTitulo;

     aAlfa = "|dsam0021;" + ("00000" + #dsam0000#0) % -105;
     aAlfa = aAlfa + "ENTRADA";
     |SUB_EJECUTA aAlfa;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
|FPRC;

|PROCESO MenuTexto3;
     |PTEC 806;
|FPRC;

|PROCESO Comentarios;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_9;  |HAZ PintaTitulo;

     aAlfa = MenuTexto1;  |HAZ QuitaRaros;  MenuTexto1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuTexto1, 1110, 1173, MenuTexto1;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuTexto2;  |HAZ QuitaRaros;  MenuTexto2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuTexto2, 1210, 1273, MenuTexto2;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuTexto3;  |HAZ QuitaRaros;  MenuTexto3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuTexto3, 1310, 1373, MenuTexto3;
     nBtnCapa1_3 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuTexto1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuTexto2;  |FINSI;
         |SI aTecla = "C";  |SAL;             |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        ********************** EMPRESAS CONTABLES **********************************

|PROCESO EmpresasCont;
     |ATRI 0;
     |BLIN 04;
     |SI #dsam0000#65 = "N";
         |MENAV "      El Cliente no tiene Contabilidad";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa = #dsam0000#0;

     aAlfa = aMenuF3_10;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":contagen/canempr2";

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

        *********** GESTION DE PROCESOS VARIOS ******************************

|PROCESO CertifContrat; || CERTIFICADOS DE CONTRATISTAS Y SUBCONTRATISTAS
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";

     |PUSHV 0501 2380;
     enEmpresa = #dsam0000#0;

     aAlfa = MenuVarios1;  |HAZ PintaTitulo;
     aAlfa = "|:basica/tadz0001.tab;" + #dsam0000#0; |QBF aAlfa;
     aAlfa = aAlfa + "," + #dsam0000#3; |QBF aAlfa;
     aAlfa = aAlfa + "," + #dsam0000#1; |QBF aAlfa;
     |SUB_EJECUTA aAlfa;

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
|FPRC;

|PROCESO Embargos;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";

     |PUSHV 0501 2380;
     enEmpresa = #dsam0000#0;
     aAlfa = MenuVarios2;  |HAZ PintaTitulo;

     |SUB_EJECUTA_NP ":integral/dsaz0023";

     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
|FPRC;

|PROCESO MenuVarios3;
     |PTEC 806;
|FPRC;

|PROCESO GestionVarios;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF3;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF3_11;  |HAZ PintaTitulo;

     aAlfa = MenuVarios1;  |HAZ QuitaRaros;  MenuVarios1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuVarios1, 1110, 1173, CertifContrat;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuVarios2;  |HAZ QuitaRaros;  MenuVarios2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuVarios2, 1210, 1273, Embargos;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuVarios3;  |HAZ QuitaRaros;  MenuVarios3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuVarios3, 1310, 1373, MenuVarios3;
     nBtnCapa1_3 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ CertifContrat;  |FINSI;
         |SI aTecla = "B";  |HAZ Embargos;       |FINSI;
         |SI aTecla = "C";  |SAL;                |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF3;
|FPRC;

|PROCESO OpcionF3;
     |ESTADO_CONTROL nBtnF3, "DISABLE";

     |ATRI N;
     aAlfa = aMenuF3_1;  |HAZ QuitaRaros;  aMenuF3_1 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_1, 1110, 1173, Direcciones;
     nBotonMen1 = FSalida;

     aAlfa = aMenuF3_2;  |HAZ QuitaRaros;  aMenuF3_2 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_2, 1210, 1273, Telefonos;
     nBotonMen2 = FSalida;

     aAlfa = aMenuF3_3;  |HAZ QuitaRaros;  aMenuF3_3 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_3, 1310, 1373, DFamiliares;
     nBotonMen3 = FSalida;

     aAlfa = aMenuF3_4;  |HAZ QuitaRaros;  aMenuF3_4 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_4, 1410, 1473, DOtros;
     nBotonMen4 = FSalida;

     aAlfa = aMenuF3_5;  |HAZ QuitaRaros;  aMenuF3_5 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_5, 1510, 1573, DActividad;
     nBotonMen5 = FSalida;

     aAlfa = aMenuF3_6;  |HAZ QuitaRaros;  aMenuF3_6 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_6, 1610, 1673, DModelos;
     nBotonMen6 = FSalida;

     aAlfa = aMenuF3_7;  |HAZ QuitaRaros;  aMenuF3_7 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_7, 1710, 1773, DDatosFact;
     nBotonMen7 = FSalida;

     aAlfa = aMenuF3_8;  |HAZ QuitaRaros;  aMenuF3_8 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_8, 1810, 1873, FechasSenal;
     nBotonMen8 = FSalida;

     aAlfa = aMenuF3_9;  |HAZ QuitaRaros;  aMenuF3_9 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_9, 1910, 1973, Comentarios;
     nBotonMen9 = FSalida;

     aAlfa = aMenuF3_10;  |HAZ QuitaRaros;  aMenuF3_10 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_10, 2010, 2073, EmpresasCont;
     nBotonMen10 = FSalida;

     aAlfa = aMenuF3_11;  |HAZ QuitaRaros;  aMenuF3_11 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF3_11, 2110, 2173, GestionVarios;
     nBotonMen11 = FSalida;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ Direcciones;    |FINSI;
         |SI aTecla = "B";  |HAZ Telefonos;      |FINSI;
         |SI aTecla = "C";  |HAZ DFamiliares;    |FINSI;
         |SI aTecla = "D";  |HAZ DOtros;         |FINSI;
         |SI aTecla = "E";  |HAZ DActividad;     |FINSI;
         |SI aTecla = "F";  |HAZ DModelos;       |FINSI;
         |SI aTecla = "G";  |HAZ DDatosFact;     |FINSI;
         |SI aTecla = "H";  |HAZ FechasSenal;    |FINSI;
         |SI aTecla = "I";  |HAZ Comentarios;    |FINSI;
         |SI aTecla = "J";  |HAZ EmpresasCont;   |FINSI;
         |SI aTecla = "K";  |HAZ GestionVarios;  |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF3, "ENABLE";
     |HAZ FinOpcionF3;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F4 -----------------------

        ********************** FICHA DE SOCIEDADES  *************************

|PROCESO DFichaSocie;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     aAlfa = aMenuF4_1;  |HAZ PintaTitulo;
     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;

     enEmpSoc = enEmpresa;
     |HAZ BFDisolucion;

||  esta fecha no es la que Paco quiere Controlar, sino la de disolucion de
||   la Empresa, en Datos Notaria
||     enEjerBaja = -1;
||     |SI #dsam0000#7 > "01.01.1900";
||         aAlfa3 = #dsam0000#7; aAlfa3 = aAlfa3 % -104; enEjerBaja = aAlfa3;
||     |FINSI;


     |LIBERA #dsam0000;
     |SUB_EJECUTA_NP ":basica/agim0028";

     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     |POPV;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** EMPRESAS DE SOCIEDADES  ***********************

|RUTINA ClaveBaja909;
     #dsaw0009#0 = 1900;
     |SI FSalida = "POSICION";
         #dsaw0009#0 = 2018;
     |FINSI;
|FRUT;

|RUTINA ClaveAlta909;
     #dsaw0009#0 = 2999;
|FRUT;

|PROCESO GrabaImpuesto;
     #dsaw0009#0 = #maacceso#1;
     |GRABA 020#dsaw0009.n;
     |LIBERA #dsaw0009;
|FPRC;

|DEFBUCLE maacceso;
    #maacceso#1;
    ;
    #dsam0000#0, 0000;
    #dsam0000#0, 9999;
    be;
    NULL, GrabaImpuesto;
|FIN;

|PROCESO DEmpSociedad;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     |PUSHV 0501 2380;
     aAlfa = aMenuF4_2;  |HAZ PintaTitulo;

     aAlfa = ("09" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0009#aAlfa#;
     |ABRE #dsaw0009;  |CIERRA #dsaw0009;  |DELINDEX #dsaw0009;

     |ABRE #dsaw0009;
     |BUCLE maacceso;
     |CIERRA #dsaw0009;

     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;
     |LIBERA #dsam0000;

     |ENTLINEAL #1#dsaw0009, -1, enModo, 22, 1, ClaveBaja909, ClaveAlta909;

     |DELINDEX #dsaw0009;

     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     |POPV;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** CUENTAS ANUALES ***********************

|RUTINA ClaveBaja933;
     #dsaw0033#0 = 1900;
     |SI FSalida = "POSICION";
         #dsaw0033#0 = 2018;
     |FINSI;
|FRUT;

|RUTINA ClaveAlta933;
     #dsaw0033#0 = 2999;
|FRUT;

|PROCESO GrabaCuentas;
     #dsaw0033#0 = #cuaccecl#1;
     |GRABA 020#dsaw0033.n;
     |LIBERA #dsaw0033;
|FPRC;

|DEFBUCLE cuaccecl;
    #cuaccecl#1;
    ;
    #dsam0000#0, 0000;
    #dsam0000#0, 9999;
    be;
    NULL, GrabaCuentas;
|FIN;

|PROCESO DCuentasAnua;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     |PUSHV 0501 2380;

     aAlfa = aMenuF4_3;  |HAZ PintaTitulo;

     aAlfa = ("33" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0033#aAlfa#;
     |ABRE #dsaw0033;  |CIERRA #dsaw0033;  |DELINDEX #dsaw0033;

     |ABRE #dsaw0033;
     |BUCLE cuaccecl;
     |CIERRA #dsaw0033;

     |ENTLINEAL #1#dsaw0033, -1, enModo, 22, 1, ClaveBaja933, ClaveAlta933;

     |DELINDEX #dsaw0033;

     |POPV;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;


        ********************** CERTIFICADOS DE SOCIOS *************************

|PROCESO Pasa906;
     #dsaw0006#0 = #agim0033#1;
     #dsaw0006#1 = #agim0033#3;
     #dsaw0006#2 = #agim0033#4;
     #dsaw0006#3 = #agim0033#5;
     |GRABA 020#dsaw0006.n;
     |LIBERA #dsaw0006;
|FPRC;

|DEFBUCLE agim0033;
     #agim0033#1;
     ;
     #dsam0000#0, 1900;
     #dsam0000#0, 2999;
     ;
     NULL, Pasa906;
|FIN;

|RUTINA ClaveBaja906;
     #dsaw0006#0 = 1900;
|FRUT;

|RUTINA ClaveAlta906;
     #dsaw0006#0 = 2999;
|FRUT;

|PROCESO DCertSocios;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     |PUSHV 0501 2380;

     aAlfa = aMenuF4_4;  |HAZ PintaTitulo;

     enEmpSoc = #dsam0000#0;
     |HAZ BFDisolucion;

||     enEjerBaja = -1;
||     |SI #dsam0000#7 > "01.01.1900";
||         aAlfa3 = #dsam0000#7; aAlfa3 = aAlfa3 % -104;
||         enEjerBaja = aAlfa3;
||     |FINSI;


     aAlfa = ("06" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0006#aAlfa#;
     |ABRE #dsaw0006;  |CIERRA #dsaw0006;  |DELINDEX #dsaw0006;

     |ABRE #dsaw0006;
     |BUCLE agim0033;
     |CIERRA #dsaw0006;

     |ENTLINEAL #1#dsaw0006, -1, enModo, 20, 1, ClaveBaja906, ClaveAlta906;

     |DELINDEX #dsaw0006;

     |POPV;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** EMPRESA MEMORIAS *****************************

|PROCESO DEmpMemoria;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     aAlfa = aMenuF4_5;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":contasoc/mew00010";

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** EMPRESA PYME/NO PYME/GRAN EMPRESA ***********

|PROCESO DEmpPyme;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     aAlfa = aMenuF4_6;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     enOperar  = 100 + enModo;
     |SUB_EJECUTA_NP ":basica/agim0051";

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** RETRIBUCIONES A ADMINISTRADORES ***********

|PROCESO Retribuciones;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     enEmpresa = #dsam0000#0;
     eaEmpresa = #dsam0000#1;
     aAlfa     = aMenuF4_7;  |HAZ PintaTitulo;
     aAlfa     = "|:basica/socm0001;" + (("00000" + enEmpresa) % -105) + enModo;
     |SUB_EJECUTA_NP aAlfa;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

        ********************** PRESTAMOS ***********

|PROCESO Prestamos;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF4;

     enEmpresa = #dsam0000#0;
     aAlfa     = aMenuF4_8;  |HAZ PintaTitulo;
     aAlfa     = "|:basica/socm0003;" + (("00000" + enEmpresa) % -105) + enModo;
     |SUB_EJECUTA_NP aAlfa;

     |HAZ Aparece;
     |HAZ ApareceOpcionF4;
|FPRC;

|PROCESO OpcionF4;
     |ATRI 0;
     |BLIN 04;
     |SI #dsam0000#67 = "N";
         |MENAV "      El Cliente no tiene Configurada la Gestion de Sociedades.";
         nOpcion = 1;
         |ACABA;
     |FINSI;

     |ABRE #agicen14;
     #agicen14#0 = #dsam0000#0;
     #agicen14#1 = 1;
     |LEE 000#agicen14.];
     |SI FSalida ! 0;  |O  #agicen14#0 ! #dsam0000#0;
         |MENAV "0000 Por favor cree el Registros de Actividades en la Opcion F3 - E - A";
         nOpcion = 1;
         |CIERRA #agicen14;
         |ACABA;
     |FINSI;
     |CIERRA #agicen14;

     |ESTADO_CONTROL nBtnF4, "DISABLE";

     |ATRI N;
     aAlfa = aMenuF4_1;  |HAZ QuitaRaros;  aMenuF4_1 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_1, 1110, 1173, DFichaSocie;
     nBotonMen1 = FSalida;

     aAlfa = aMenuF4_2;  |HAZ QuitaRaros;  aMenuF4_2 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_2, 1210, 1273, DEmpSociedad;
     nBotonMen2 = FSalida;

     aAlfa = aMenuF4_3;  |HAZ QuitaRaros;  aMenuF4_3 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_3, 1310, 1373, DCuentasAnua;
     nBotonMen3 = FSalida;

     aAlfa = aMenuF4_4;  |HAZ QuitaRaros;  aMenuF4_4 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_4, 1410, 1473, DCertSocios;
     nBotonMen4 = FSalida;

     aAlfa = aMenuF4_5;  |HAZ QuitaRaros;  aMenuF4_5 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_5, 1510, 1573, DEmpMemoria;
     nBotonMen5 = FSalida;

     aAlfa = aMenuF4_6;  |HAZ QuitaRaros;  aMenuF4_6 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_6, 1610, 1673, DEmpPyme;
     nBotonMen6 = FSalida;

     aAlfa = aMenuF4_7;  |HAZ QuitaRaros;  aMenuF4_7 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_7, 1710, 1773, Retribuciones;
     nBotonMen7 = FSalida;

     aAlfa = aMenuF4_8;  |HAZ QuitaRaros;  aMenuF4_8 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF4_8, 1810, 1873, Prestamos;
     nBotonMen8 = FSalida;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;


         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ DFichaSocie;    |FINSI;
         |SI aTecla = "B";  |HAZ DEmpSociedad;   |FINSI;
         |SI aTecla = "C";  |HAZ DCuentasAnua;   |FINSI;
         |SI aTecla = "D";  |HAZ DCertSocios;    |FINSI;
         |SI aTecla = "E";  |HAZ DEmpMemoria;    |FINSI;
         |SI aTecla = "F";  |HAZ DEmpPyme;       |FINSI;
         |SI aTecla = "G";  |HAZ Retribuciones;  |FINSI;
         |SI aTecla = "H";  |HAZ Prestamos;      |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF4, "ENABLE";

     |HAZ FinOpcionF4;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F5 -----------------------

|PROCESO nomw0002;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_1;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0002";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0007;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_2;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0007";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0008;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_3;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0008";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0009;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_4;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0009";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0003;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_6;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0003";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0005;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_7;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0005";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0010;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_8;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0010";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0011;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_10;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0011";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0012;
     aAlfa = "    ATENCION. Esta opción está deshabilitada desde este menú";
     |MENAV aAlfa;
     aAlfa = "    Debe usarse desde Procesos de Gestión Laboral / Procesos ";
     aAlfa = aAlfa + "Lab. Diversos / Mant. Lab. Diversos";
     |MENAV aAlfa;
     |ACABA;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_11;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0012";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0014;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_5;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0014";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO nomw0015;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF5;

     aAlfa = aMenuF5_9;  |HAZ PintaTitulo;
     enEmpresa = #dsam0000#0;
     |SUB_EJECUTA_NP ":laboral/nomw0015";

     |HAZ Aparece;
     |HAZ ApareceOpcionF5;
|FPRC;

|PROCESO OpcionF5;
     |ATRI 0;
     |BLIN 04;
     |SI #dsam0000#69 = "N";
         |MENAV "      El Cliente no tiene Configurada la Gestion de Laboral.";
         nOpcion = 1;
         |ACABA;
     |FINSI;

     |ESTADO_CONTROL nBtnF5, "DISABLE";

     |ATRI N;
     aAlfa = aMenuF5_1;  |HAZ QuitaRaros;  aMenuF5_1 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_1, 1110, 1173, nomw0002;
     nBotonMen1 = FSalida;

     aAlfa = aMenuF5_2;  |HAZ QuitaRaros;  aMenuF5_2 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_2, 1210, 1273, nomw0007;
     nBotonMen2 = FSalida;

     aAlfa = aMenuF5_3;  |HAZ QuitaRaros;  aMenuF5_3 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_3, 1310, 1373, nomw0008;
     nBotonMen3 = FSalida;

     aAlfa = aMenuF5_4;  |HAZ QuitaRaros;  aMenuF5_4 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_4, 1410, 1473, nomw0009;
     nBotonMen4 = FSalida;

     aAlfa = aMenuF5_5;  |HAZ QuitaRaros;  aMenuF5_5 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_5, 1510, 1573, nomw0014;
     nBotonMen5 = FSalida;

     aAlfa = aMenuF5_6;  |HAZ QuitaRaros;  aMenuF5_6 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_6, 1610, 1673, nomw0003;
     nBotonMen6 = FSalida;

     aAlfa = aMenuF5_7;  |HAZ QuitaRaros;  aMenuF5_7 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_7, 1710, 1773, nomw0005;
     nBotonMen7 = FSalida;

     aAlfa = aMenuF5_8;  |HAZ QuitaRaros;  aMenuF5_8 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_8, 1810, 1873, nomw0010;
     nBotonMen8 = FSalida;

     aAlfa = aMenuF5_9;  |HAZ QuitaRaros;  aMenuF5_9 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_9, 1910, 1973, nomw0015;
     nBotonMen9 = FSalida;

     aAlfa = aMenuF5_10;  |HAZ QuitaRaros;  aMenuF5_10 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_10, 2010, 2073, nomw0011;
     nBotonMen10 = FSalida;

     aAlfa = aMenuF5_11;  |HAZ QuitaRaros;  aMenuF5_11 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF5_11, 2110, 2173, nomw0012;
     nBotonMen11 = FSalida;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ nomw0002;       |FINSI;
         |SI aTecla = "B";  |HAZ nomw0007;       |FINSI;
         |SI aTecla = "C";  |HAZ nomw0008;       |FINSI;
         |SI aTecla = "D";  |HAZ nomw0009;       |FINSI;
         |SI aTecla = "E";  |HAZ nomw0014;       |FINSI;
         |SI aTecla = "F";  |HAZ nomw0003;       |FINSI;
         |SI aTecla = "G";  |HAZ nomw0005;       |FINSI;
         |SI aTecla = "H";  |HAZ nomw0010;       |FINSI;
         |SI aTecla = "I";  |HAZ nomw0015;       |FINSI;
         |SI aTecla = "J";  |HAZ nomw0011;       |FINSI;
         |SI aTecla = "K";  |HAZ nomw0012;       |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF5, "ENABLE";

     |HAZ FinOpcionF5;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F6 -----------------------

   ********************** CLIENTES FACTURACION**************************

|PROCESO Pasa908;
     aAlfa = aBase + (("00" + #facemp1#0) % -102) + "/";  |QBT aAlfa;
     |PATH_DAT #asclient#aAlfa#;

     |ABRE #asclient;
     #asclient#0 = #dsam0000#0;
     |LEE 040#asclient.=;
     |SI FSalida = 0;
         #dsaw0008#0 = #facemp1#0;
         |PARA nCampoO = 1;  |SI nCampoO [ 12;  |HACIENDO nCampoO = nCampoO + 1;
               nCampoD = nCampoO + 24;
               #dsaw0008#nCampoO# = #asclient#nCampoD#;
         |SIGUE;
         |PARA nCampoO = 16;  |SI nCampoO [ 27;  |HACIENDO nCampoO = nCampoO + 1;
               nCampoD = nCampoO + 21;
               #dsaw0008#nCampoO# = #asclient#nCampoD#;
         |SIGUE;
         #dsaw0008#13 = #asclient#18;
         #dsaw0008#14 = #asclient#20;
         #dsaw0008#15 = #asclient#49;
         #dsaw0008#28 = #asclient#19;
         #dsaw0008#29 = #asclient#21;
         #dsaw0008#30 = #asclient#50;
         #dsaw0008#31 = #asclient#24;

         |GRABA 020#dsaw0008.n;
         |LIBERA #dsaw0008;
     |FINSI;
     |CIERRA #asclient;
|FPRC;

        ********************** DATOS FACTURACION ****************************

|RUTINA ClaveBaja908;
     #dsaw0008#0 = 1;
|FRUT;

|RUTINA ClaveAlta908;
     #dsaw0008#0 = 99;
|FRUT;

|PROCESO DFacturacion;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     aBase = "";
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "facturar/fich/";

     aAlfa = ("08" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0008#aAlfa#;
     |ABRE #dsaw0008;  |CIERRA #dsaw0008;  |DELINDEX #dsaw0008;

     |PATH_DAT #facemp1#aBase#;

     |ABRE #dsaw0008;
     |ABRE #facemp1;

     |LEE 020#facemp1.p;
     |PARA; |SI FSalida = 0;  |HACIENDO;
            |SI #facemp1#3 = "S";   |HAZ Pasa908;  |FINSI;
            |LEE 040#facemp1.s;
     |SIGUE;

     |CIERRA #dsaw0008;
     |CIERRA #facemp1;

     |PUSHV 0501 2380;
     aAlfa = MenuConsul1;  |HAZ PintaTitulo;
     |ENTLINEAL #1#dsaw0008, -1, 4, 20, 1, ClaveBaja908, ClaveAlta908;
     |POPV;

     |DELINDEX #dsaw0008;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS RECIBOS A¤OS ***************************

|PROCESO DRecibos;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     enEmpresa  = #dsam0000#0;
     enTipoFac  = 3;
     aAlfa = MenuConsul2;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":facturar/facemp2";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** CONSULTA DE RENDIMIENTOS *********************

|PROCESO DConsRendim;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     enEmpresa = #dsam0000#0;
     aAlfa = MenuConsul3;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":integral/dsaw0005";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS LLAMADAS *******************************

|RUTINA ClaveBaja604;
     #agim0009#0 = "01.01.1900";
     #agim0009#1 = 0;
     #agim0009#2 = 0;
     #agim0009#5 = #dsam0000#0;
|FRUT;

|RUTINA ClaveAlta604;
     #agim0009#0 = "31.12.2999";
     #agim0009#1 = 23;
     #agim0009#2 = 59;
     #agim0009#5 = #dsam0000#0;
|FRUT;

|PROCESO DLLamadas;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     aAlfa = MenuConsul4;  |HAZ PintaTitulo;
     |PINPA #0#agim0009;
     |ENTLINEAL #2#agim0009, -4, 4, 22, 0, ClaveBaja604, ClaveAlta604;
     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS VISITAS ********************************

|RUTINA ClaveBaja605;
     #agim0008#0 = "01.01.1900";
     #agim0008#1 = "          ";
     #agim0008#2 = 0;
     #agim0008#3 = 0;
     #agim0008#5 = #dsam0000#0;
|FRUT;

|RUTINA ClaveAlta605;
     #agim0008#0 = "31.12.2999";
     #agim0008#1 = "zzzzzzzzzz";
     #agim0008#2 = 23;
     #agim0008#3 = 59;
     #agim0008#5 = #dsam0000#0;
|FRUT;

|PROCESO DVisitas;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |PINPA #0#agim0008;
     aAlfa = MenuConsul5;  |HAZ PintaTitulo;
     |C_M #agim0008#2, 1, "N";
     |C_M #agim0008#3, 1, "N";
     |ENTLINEAL #3#agim0008, -5, 4, 22, 0, ClaveBaja605, ClaveAlta605;
     |POPV;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS ENTREVISTAS ********************************

|PROCESO DEntrevistas;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     enEmpresa = #dsam0000#0;
     aAlfa = MenuConsul6;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":basica/agiz0011";

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS ARCHIVOS ********************************

|RUTINA ClaveBaja606;
     #agim0012#0  = #dsam0000#0;
     #agim0012#2  = "     ";
     #agim0012#4  = 0000;
     #agim0012#11 = 00;
     #agim0012#7  = "01.01.0000";
     #agim0012#8  = "        ";
|FRUT;

|RUTINA ClaveAlta606;
     #agim0012#0  = #dsam0000#0;
     #agim0012#2  = "zzzzz";
     #agim0012#4  = 9999;
     #agim0012#11 = 99;
     #agim0012#7  = "31.12.2999";
     #agim0012#8  = "zzzzzzzz";
|FRUT;

|PROCESO MenuArchivo1;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |PINPA #0#agim0012;
     aAlfa = MenuArchivo1;  |HAZ PintaTitulo;
     |ENTLINEAL #2#agim0012, -4, 4, 22, 0, ClaveBaja606, ClaveAlta606;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
|FPRC;

|PROCESO MenuArchivo2;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |PINPA #0#agim0012;
     aAlfa = MenuArchivo2;  |HAZ PintaTitulo;
     |ENTLINEAL #3#agim0012, -4, 4, 22, 0, ClaveBaja606, ClaveAlta606;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
|FPRC;

|PROCESO MenuArchivo3;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |PINPA #0#agim0012;
     aAlfa = MenuArchivo3;  |HAZ PintaTitulo;
     |ENTLINEAL #4#agim0012, -3, 4, 22, 0, ClaveBaja606, ClaveAlta606;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
|FPRC;

|PROCESO MenuArchivo4;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";

     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |PINPA #0#agim0012;
     aAlfa = MenuArchivo4;  |HAZ PintaTitulo;
     |ENTLINEAL #5#agim0012, -3, 4, 22, 0, ClaveBaja606, ClaveAlta606;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
|FPRC;

|PROCESO MenuArchivo5;
     |PTEC 806;
|FPRC;

|PROCESO DMenuArchivo;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = MenuConsul8;  |HAZ PintaTitulo;

     aAlfa = MenuArchivo1;  |HAZ QuitaRaros;  MenuArchivo1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuArchivo1, 1110, 1173, MenuArchivo1;
     nBtnCapa2_1 = FSalida;

     aAlfa = MenuArchivo2;  |HAZ QuitaRaros;  MenuArchivo2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuArchivo2, 1210, 1273, MenuArchivo2;
     nBtnCapa2_2 = FSalida;

     aAlfa = MenuArchivo3;  |HAZ QuitaRaros;  MenuArchivo3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuArchivo3, 1310, 1373, MenuArchivo3;
     nBtnCapa2_3 = FSalida;

     aAlfa = MenuArchivo4;  |HAZ QuitaRaros;  MenuArchivo4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuArchivo4, 1410, 1473, MenuArchivo4;
     nBtnCapa2_4 = FSalida;

     aAlfa = MenuArchivo5;  |HAZ QuitaRaros;  MenuArchivo5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuArchivo5, 1510, 1573, MenuArchivo5;
     nBtnCapa2_5 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuArchivo1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuArchivo2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuArchivo3;  |FINSI;
         |SI aTecla = "D";  |HAZ MenuArchivo4;  |FINSI;
         |SI aTecla = "E";  |SAL;               |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa2_1;
     |FIN_CONTROL_WINDOWS nBtnCapa2_2;
     |FIN_CONTROL_WINDOWS nBtnCapa2_3;
     |FIN_CONTROL_WINDOWS nBtnCapa2_4;
     |FIN_CONTROL_WINDOWS nBtnCapa2_5;

     |PULSATECLA;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** DATOS SUBVENCIONES ***************************

|RUTINA ClaveBaja904;
     #dsaw0004#0 = 1;
|FRUT;

|RUTINA ClaveAlta904;
     #dsaw0004#0 = 999;
|FRUT;

|PROCESO Pasa904;
     #dsaw0004#0 = #agim0031#0;
     #dsaw0004#1 = #agim0031#3;
     #dsaw0004#2 = #agim0031#4;

     |GRABA 020#dsaw0004.n;
     |LIBERA #dsaw0004;

     nSwPasa = 1;
|FPRC;

|DEFBUCLE agim0031;
     #agim0031#3;
     ;
     #dsam0000#0;
     #dsam0000#0;
     ;
     NULL, Pasa904;
|FIN;

|PROCESO DSubvencion;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     aAlfa = ("04" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0004#aAlfa#;
     |ABRE #dsaw0004;  |CIERRA #dsaw0004;  |DELINDEX #dsaw0004;

     nSwPasa = 0;
     |ABRE #dsaw0004;
     |BUCLE agim0031;
     |CIERRA #dsaw0004;

     |SI nSwPasa = 1;
         |PUSHV 0501 2380;
         aAlfa = MenuConsul7;  |HAZ PintaTitulo;
         |ENTLINEAL #1#dsaw0004, -1, 4, 22, 1, ClaveBaja904, ClaveAlta904;
         |POPV;
     |FINSI;

     |DELINDEX #dsaw0004;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

        ********************** HISTORICO DEL DESPACHO *******************************


|| ****************************************** Visitas

|PROCESO Visitas;
     |DDEFECTO #dsaw0030;
     #dsaw0030#0 = 01;              || Programa;
     #dsaw0030#1 = #agim0008#0;            || Fecha
     #dsaw0030#2 = #agim0008#2;            || Hora
     #dsaw0030#3 = #agim0008#3;            || Minuto
     #dsaw0030#4 = 0;               || Referencia
     #dsaw0030#5 = "Visita. " + #agim0008#7;
     #dsaw0030#6 = #agim0008#1;            || Usuario
     #dsaw0030#7 = #agim0008#4;
     |GRABA 140#dsaw0030.n;
     |LIBERA #dsaw0030;
     nGrabaTempo = 1;
|FPRC;

|DEFBUCLE agim0008;
     #agim0008#3;
     ;
     #dsam0000#0, "01.01.1900", "          ", 00, 00;
     #dsam0000#0, "31.12.2999", "zzzzzzzzzz", 99, 99;
     ;
     NULL, Visitas;
|FIN;

|| ****************************************** Llamadas

|PROCESO Llamadas;
     |DDEFECTO #dsaw0030;
     #dsaw0030#0 = 02;                    || Programa;
     #dsaw0030#1 = #agim0009#0;                || Fecha
     #dsaw0030#2 = #agim0009#1;                || Hora
     #dsaw0030#3 = #agim0009#2;                || Minuto
     #dsaw0030#4 = 0;                     || Referencia
     #dsaw0030#5 = "Llamada. " + #agim0009#7;
     #dsaw0030#6 = #agim0009#3;            || Usuario
     #dsaw0030#7 = #agim0009#4;
     |GRABA 140#dsaw0030.n;
     |LIBERA #dsaw0030;
     nGrabaTempo = 1;
|FPRC;

|DEFBUCLE agim0009;
     #agim0009#2;
     ;
     #dsam0000#0, "01.01.0000", 00, 00;
     #dsam0000#0, "31.12.2999", 99, 99;
     ;
     NULL, Llamadas;
|FIN;

|| ****************************************** Entrevistas

|PROCESO Entrevista;
     |DDEFECTO #dsaw0030;
     #dsaw0030#0 = 03;              || Programa;
     #dsaw0030#1 = #agim0013#0;            || Fecha
     #dsaw0030#2 = #agim0013#3;            || Hora
     #dsaw0030#3 = #agim0013#4;            || Minuto
     #dsaw0030#4 = 0;               || Referencia
     #dsaw0030#5 = "Entrevista con el cliente ";
     #dsaw0030#6 = #agim0013#5;            || Usuario
     #dsaw0030#7 = #agim0013#6;            || Nombre del Usuario
     |GRABA 140#dsaw0030.n;
     |LIBERA #dsaw0030;
     nGrabaTempo = 1;
|FPRC;

|DEFBUCLE agim0013;
     #agim0013#1;
     ;
     "00.00.0000", #dsam0000#0;
     "31.12.2999", #dsam0000#0;
     ;
     NULL, Entrevista;
|FIN;

|| ****************************************** Archivos

|PROCESO Archivos;
     |DDEFECTO #dsaw0030;
     #dsaw0030#0 = 04;              || Programa;
     #dsaw0030#1 = #agim0012#7;            || Fecha
     #dsaw0030#2 = 00;              || Hora
     #dsaw0030#3 = 00;              || Minuto
     #dsaw0030#4 = #agim0012#1;            || Referencia
     #dsaw0030#5 = "Archivo " + #agim0012#6 + " " + #agim0012#3;
     #dsaw0030#6 = #agim0012#8;            || Usuario
     #dsaw0030#7 = #agim0012#9;            || Nombre del Usuario
     |GRABA 140#dsaw0030.n;
     |LIBERA #dsaw0030;
     nGrabaTempo = 1;
|FPRC;

|DEFBUCLE agim0012;
     #agim0012#1;
     ;
     #dsam0000#0, 0000;
     #dsam0000#0, 9999;
     ;
     NULL, Archivos;
|FIN;

|RUTINA ClaveBaja99;
     #dsaw0030#0 = 00;
     #dsaw0030#1 = "00.00.0000";
     #dsaw0030#2 = 00;
     #dsaw0030#3 = 00;
     #dsaw0030#4 = 0;
|FRUT;

|RUTINA ClaveAlta99;
     #dsaw0030#0 = 99;
     #dsaw0030#1 = "31.12.9999";
     #dsaw0030#2 = 99;
     #dsaw0030#3 = 99;
     #dsaw0030#4 = 9999;
|FRUT;

|PROCESO TrataHistorico;
     aAlfa = ("30" + Usuario + "zzzzzzzz") % 108;  |QBF aAlfa;
     |NOME_DAT #dsaw0030#aAlfa#;
     |ABRE #dsaw0030;  |CIERRA #dsaw0030;  |DELINDEX #dsaw0030;

     nGrabaTempo = 0;

     |ABRE #dsaw0030;
     |SI nSwHistorico1 = 1;  |BUCLE agim0012;  |FINSI;
     |SI nSwHistorico2 = 1;  |BUCLE agim0009;  |FINSI;
     |SI nSwHistorico3 = 1;  |BUCLE agim0008;  |FINSI;
     |SI nSwHistorico4 = 1;  |BUCLE agim0013;  |FINSI;
     |CIERRA #dsaw0030;

     |SI nGrabaTempo = 0;  |ACABA;  |FINSI;

     |PINPA #0#dsaw0030;
     |ENTLINEAL #1#dsaw0030, -3, 4, 22, 1, ClaveBaja99, ClaveAlta99;

     |DELINDEX #dsaw0030;
|FPRC;

|PROCESO MenuHis1;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_6, "HIDE";

     nSwHistorico1 = 1;
     nSwHistorico2 = 1;
     nSwHistorico3 = 1;
     nSwHistorico4 = 1;
     |PUSHV 0501 2380;
     aAlfa = MenuHis1;  |HAZ PintaTitulo;
     |HAZ TrataHistorico;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_6, "SHOW";
|FPRC;

|PROCESO MenuHis2;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_6, "HIDE";

     nSwHistorico1 = 1;
     nSwHistorico2 = 0;
     nSwHistorico3 = 0;
     nSwHistorico4 = 0;

     |PUSHV 0501 2380;
     aAlfa = MenuHis2;  |HAZ PintaTitulo;
     |HAZ TrataHistorico;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_6, "SHOW";
|FPRC;

|PROCESO MenuHis3;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_6, "HIDE";

     nSwHistorico1 = 0;
     nSwHistorico2 = 1;
     nSwHistorico3 = 0;
     nSwHistorico4 = 0;

     |PUSHV 0501 2380;
     aAlfa = MenuHis3;  |HAZ PintaTitulo;
     |HAZ TrataHistorico;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_6, "SHOW";
|FPRC;

|PROCESO MenuHis4;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_6, "HIDE";

     nSwHistorico1 = 0;
     nSwHistorico2 = 0;
     nSwHistorico3 = 1;
     nSwHistorico4 = 0;

     |PUSHV 0501 2380;
     aAlfa = MenuHis4;  |HAZ PintaTitulo;
     |HAZ TrataHistorico;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_6, "SHOW";
|FPRC;

|PROCESO MenuHis5;
     |ESTADO_CONTROL nBtnCapa2_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa2_6, "HIDE";

     nSwHistorico1 = 0;
     nSwHistorico2 = 0;
     nSwHistorico3 = 0;
     nSwHistorico4 = 1;

     |PUSHV 0501 2380;
     aAlfa = MenuHis5;  |HAZ PintaTitulo;
     |HAZ TrataHistorico;
     |POPV;

     |ESTADO_CONTROL nBtnCapa2_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa2_6, "SHOW";
|FPRC;

|PROCESO MenuHis6;
     |PTEC 806;
|FPRC;

|PROCESO DMenuHis;
     |ESTADO_CONTROL nBtnCapa1_1, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_2, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_3, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_4, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_5, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_6, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_7, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_8, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_9, "HIDE";
     |ESTADO_CONTROL nBtnCapa1_10, "HIDE";

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;

     aAlfa = MenuConsul9;  |HAZ PintaTitulo;

     aAlfa = MenuHis1;  |HAZ QuitaRaros;  MenuHis1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis1, 1110, 1173, MenuHis1;
     nBtnCapa2_1 = FSalida;

     aAlfa = MenuHis2;  |HAZ QuitaRaros;  MenuHis2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis2, 1210, 1273, MenuHis2;
     nBtnCapa2_2 = FSalida;

     aAlfa = MenuHis3;  |HAZ QuitaRaros;  MenuHis3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis3, 1310, 1373, MenuHis3;
     nBtnCapa2_3 = FSalida;

     aAlfa = MenuHis4;  |HAZ QuitaRaros;  MenuHis4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis4, 1410, 1473, MenuHis4;
     nBtnCapa2_4 = FSalida;

     aAlfa = MenuHis5;  |HAZ QuitaRaros;  MenuHis5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis5, 1510, 1573, MenuHis5;
     nBtnCapa2_5 = FSalida;

     aAlfa = MenuHis6;  |HAZ QuitaRaros;  MenuHis6 = aAlfa;
     |CONTROL_SIMPLE 0, MenuHis6, 1610, 1673, MenuHis6;
     nBtnCapa2_6 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuHis1;  |FINSI;
         |SI aTecla = "B";  |HAZ MenuHis2;  |FINSI;
         |SI aTecla = "C";  |HAZ MenuHis3;  |FINSI;
         |SI aTecla = "D";  |HAZ MenuHis4;  |FINSI;
         |SI aTecla = "E";  |HAZ MenuHis5;  |FINSI;
         |SI aTecla = "F";  |SAL;           |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa2_1;
     |FIN_CONTROL_WINDOWS nBtnCapa2_2;
     |FIN_CONTROL_WINDOWS nBtnCapa2_3;
     |FIN_CONTROL_WINDOWS nBtnCapa2_4;
     |FIN_CONTROL_WINDOWS nBtnCapa2_5;
     |FIN_CONTROL_WINDOWS nBtnCapa2_6;
     |PULSATECLA;

     |ESTADO_CONTROL nBtnCapa1_1, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_2, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_3, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_4, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_5, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_6, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_7, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_8, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_9, "SHOW";
     |ESTADO_CONTROL nBtnCapa1_10, "SHOW";
|FPRC;

|PROCESO MenuCon10;
     |PTEC 806;
|FPRC;

|PROCESO Consultas;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF6;

     enEmpresa  = #dsam0000#0;

     |ATRI N;
     |PINPA #0#dsaw0000;
     aAlfa = aMenuF6_1;  |HAZ PintaTitulo;

     |ATRI N;
     aAlfa = MenuConsul1;  |HAZ QuitaRaros;  MenuConsul1 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul1, 1110, 1173, DFacturacion;
     nBtnCapa1_1 = FSalida;

     aAlfa = MenuConsul2;  |HAZ QuitaRaros;  MenuConsul2 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul2, 1210, 1273, DRecibos;
     nBtnCapa1_2 = FSalida;

     aAlfa = MenuConsul3;  |HAZ QuitaRaros;  MenuConsul3 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul3, 1310, 1373, DConsRendim;
     nBtnCapa1_3 = FSalida;

     aAlfa = MenuConsul4;  |HAZ QuitaRaros;  MenuConsul4 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul4, 1410, 1473, DLLamadas;
     nBtnCapa1_4 = FSalida;

     aAlfa = MenuConsul5;  |HAZ QuitaRaros;  MenuConsul5 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul5, 1510, 1573, DVisitas;
     nBtnCapa1_5 = FSalida;

     aAlfa = MenuConsul6;  |HAZ QuitaRaros;  MenuConsul6 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul6, 1610, 1673, DEntrevistas;
     nBtnCapa1_6 = FSalida;

     aAlfa = MenuConsul7;  |HAZ QuitaRaros;  MenuConsul7 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul7, 1710, 1773, DSubvencion;
     nBtnCapa1_7 = FSalida;

     aAlfa = MenuConsul8;  |HAZ QuitaRaros;  MenuConsul8 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul8, 1810, 1873, DMenuArchivo;
     nBtnCapa1_8 = FSalida;

     aAlfa = MenuConsul9;  |HAZ QuitaRaros;  MenuConsul9 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul9, 1910, 1973, DMenuHis;
     nBtnCapa1_9 = FSalida;

     aAlfa = MenuConsul10;  |HAZ QuitaRaros;  MenuConsul10 = aAlfa;
     |CONTROL_SIMPLE 0, MenuConsul10, 2010, 2073, MenuCon10;
     nBtnCapa1_10 = FSalida;

     aEsc   = &255 + "806";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ DFacturacion;    |FINSI;
         |SI aTecla = "B";  |HAZ DRecibos;        |FINSI;
         |SI aTecla = "C";  |HAZ DConsRendim;     |FINSI;
         |SI aTecla = "D";  |HAZ DLLamadas;       |FINSI;
         |SI aTecla = "E";  |HAZ DVisitas;        |FINSI;
         |SI aTecla = "F";  |HAZ DEntrevistas;    |FINSI;
         |SI aTecla = "G";  |HAZ DSubvencion;     |FINSI;
         |SI aTecla = "H";  |HAZ DMenuArchivo;    |FINSI;
         |SI aTecla = "I";  |HAZ DMenuHis;        |FINSI;
         |SI aTecla = "J";  |SAL;                 |FINSI;
     |SIGUE;

     aTecla = "";

     |FIN_CONTROL_WINDOWS nBtnCapa1_1;
     |FIN_CONTROL_WINDOWS nBtnCapa1_2;
     |FIN_CONTROL_WINDOWS nBtnCapa1_3;
     |FIN_CONTROL_WINDOWS nBtnCapa1_4;
     |FIN_CONTROL_WINDOWS nBtnCapa1_5;
     |FIN_CONTROL_WINDOWS nBtnCapa1_6;
     |FIN_CONTROL_WINDOWS nBtnCapa1_7;
     |FIN_CONTROL_WINDOWS nBtnCapa1_8;
     |FIN_CONTROL_WINDOWS nBtnCapa1_9;
     |FIN_CONTROL_WINDOWS nBtnCapa1_10;
     |PULSATECLA;

     |HAZ Aparece;
     |HAZ ApareceOpcionF6;
|FPRC;

|PROCESO Agenda;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF6;

     enEmpresa = #dsam0000#0;
     aAlfa = aMenuF6_2;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":integral/dsam0053";

     |HAZ Aparece;
     |HAZ ApareceOpcionF6;
|FPRC;

|PROCESO Documentos;
     |HAZ Desaparece;
     |HAZ DesapareceOpcionF6;

     enEmpresa = #dsam0000#0;
     aAlfa = aMenuF6_3;  |HAZ PintaTitulo;
     |SUB_EJECUTA_NP ":integral/dsam0054";

     |HAZ Aparece;
     |HAZ ApareceOpcionF6;
|FPRC;

|PROCESO Tiquets;
     || Visualizacion de tiquets

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF6;

     aAlfa = "|:dsparcli/dstelz36.tab;" + #dsam0000#0;
     |SUB_EJECUTA aAlfa;

     |HAZ Aparece;
     |HAZ ApareceOpcionF6;
|FPRC;

|PROCESO OpcionF6;
     |ATRI 0;
     |BLIN 04;

     |ESTADO_CONTROL nBtnF6, "DISABLE";

     |ATRI N;
     aAlfa = aMenuF6_1;  |HAZ QuitaRaros;  aMenuF6_1 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF6_1, 1110, 1173, Consultas;
     nBotonMen1 = FSalida;

     aAlfa = aMenuF6_2;  |HAZ QuitaRaros;  aMenuF6_2 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF6_2, 1210, 1273, Agenda;
     nBotonMen2 = FSalida;

     aAlfa = aMenuF6_3;  |HAZ QuitaRaros;  aMenuF6_3 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF6_3, 1310, 1373, Documentos;
     nBotonMen3 = FSalida;

     aBase     = "";
     nDSParCli = 0;
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "dsparcli/def/dstelm02.mas";
     |XABRE "E", aBase, nHandle;
     |SI FSalida ] 0;
         nDSParCli = 1;
         aAlfa    = aMenuF6_4;  |HAZ QuitaRaros;  aMenuF6_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF6_4, 1410, 1473, Tiquets;
         nBotonMen4 = FSalida;
     |FINSI;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ Consultas;      |FINSI;
         |SI aTecla = "B";  |HAZ Agenda;         |FINSI;
         |SI aTecla = "C";  |HAZ Documentos;     |FINSI;
         |SI aTecla = "D";  |HAZ Tiquets;        |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF6, "ENABLE";

     |HAZ FinOpcionF6;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F7 -----------------------

|RUTINA ClaveBaja026;
     #dsam0026#0 = #dsam0000#0;
     #dsam0026#8 = "A";
     #dsam0026#1 = "          ";
|FRUT;

|RUTINA ClaveAlta026;
     #dsam0026#0 = #dsam0000#0;
     #dsam0026#8 = "A";
     #dsam0026#1 = "zzzzzzzzzz";
|FRUT;

|PROCESO MenuF7_1;
     |SI #dsam9998#2 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#2 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF7;

     |PUSHV 0501 2380;
     aAlfa          = aMenuF7_1;  |HAZ PintaTitulo;
     enEmpresa      = #dsam0000#0;
     nEmpresaGuarda = #dsam0000#0;

     |SI enModo = 4;
         |ENTLINEAL #2#dsam0026, -3, enModo, 22, 1, ClaveBaja026, ClaveAlta026;
     |SINO;
         |ENTLINEAL #1#dsam0026, -2, enModo, 22, 1, ClaveBaja026, ClaveAlta026;
     |FINSI;
     |POPV;

     |LIBERA #dsam0000;
     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     |HAZ Aparece;
     |HAZ ApareceOpcionF7;
|FPRC;

|PROCESO MenuF7_2;
     |SI #dsam9998#3 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#3 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF7;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF7;
|FPRC;

|PROCESO MenuF7_3;
     |SI #dsam9998#4 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#4 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF7;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF7;
|FPRC;

|PROCESO MenuF7_4;
     |SI #dsam9998#5 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#5 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF7;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF7;
|FPRC;

|PROCESO OpcionF7;
     |SI nOkGes = 0;
         nOpcion = 0;
         |ACABA;
     |FINSI;

     |ATRI 0;
     |BLIN 04;

     |ESTADO_CONTROL nBtnF7, "DISABLE";

     |ATRI N;

     |SI #dsam9998#2 ! "X";
         aAlfa = aMenuF7_1;  |HAZ QuitaRaros;  aMenuF7_1 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF7_1, 1110, 1173, MenuF7_1;
         nBotonMen1 = FSalida;
     |FINSI;

     |SI #dsam9998#3 ! "X";
         aAlfa = aMenuF7_2;  |HAZ QuitaRaros;  aMenuF7_2 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF7_2, 1210, 1273, MenuF7_2;
         nBotonMen2 = FSalida;
     |FINSI;

     |SI #dsam9998#4 ! "X";
         aAlfa = aMenuF7_3;  |HAZ QuitaRaros;  aMenuF7_3 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF7_3, 1310, 1373, MenuF7_3;
         nBotonMen3 = FSalida;
     |FINSI;

     |SI #dsam9998#5 ! "X";
         aAlfa = aMenuF7_4;  |HAZ QuitaRaros;  aMenuF7_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF7_4, 1410, 1473, MenuF7_4;
         nBotonMen4 = FSalida;
     |FINSI;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuF7_1;       |FINSI;
         |SI aTecla = "B";  |HAZ MenuF7_2;       |FINSI;
         |SI aTecla = "C";  |HAZ MenuF7_3;       |FINSI;
         |SI aTecla = "D";  |HAZ MenuF7_4;       |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF7, "ENABLE";

     |HAZ FinOpcionF7;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION 8 -----------------------

|PROCESO OpcionF8;
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "dsarchi/def/dsarm005.mas";
     |XABRE "E", aBase, nHandle;
     |SI FSalida < 0;
         nOpcion = 1;
         |ACABA;
     |FINSI;

     |ATRI 0;
     |BLIN 04;

     |ESTADO_CONTROL nBtnF8, "DISABLE";

     |HAZ Desaparece;

     enEmpresa = #dsam0000#0;
     aAlfa     = "|:dsarchi/dsarm005;" + (("00000" + enEmpresa) % -105);
     |SUB_EJECUTA_NP aAlfa;

     |HAZ Aparece;

     nOpcion = 1;
     |ESTADO_CONTROL nBtnF8, "ENABLE";
     |ESTADO_CONTROL nBtnF2, "DISABLE";
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F9 -----------------------
|PROCESO TrataSeguros;
     |PUSHV 0501 2380;
     |PINPA #0#dsaw0002;
     |HAZ PintaTitulo;

     #dsaw0002#0 = #dsam0000#enCamF9#;
     |PINDA #0#dsaw0002;
     |ENDATOS #1#dsaw0002;

     #dsam0000#enCamF9# = #dsaw0002#0;

     |POPV;
|FPRC;

|PROCESO MenuF9_1;
     |SI #dsam9998#6 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#6 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     aAlfa = aMenuF9_1;
     enCamF9 = 123; |HAZ TrataSeguros; enCamF9 = 0;

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_2;
     |SI #dsam9998#7 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#7 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_3;
     |SI #dsam9998#8 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#8 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_4;
     |SI #dsam9998#9 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#9 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_5;
     |SI #dsam9998#10 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#10 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_6;
     |SI #dsam9998#11 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#11 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_7;
     |SI #dsam9998#12 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#12 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_8;
     |SI #dsam9998#13 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#13 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_9;
     |SI #dsam9998#14 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#14 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_10;
     |SI #dsam9998#15 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#15 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_11;
     |SI #dsam9998#16 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#16 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF9;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO OpcionF9;
     |SI nOkSeg = 0;
         nOpcion = 0;
         |ACABA;
     |FINSI;

     |ATRI 0;
     |BLIN 04;

     |ESTADO_CONTROL nBtnF9, "DISABLE";

     |ATRI N;

     |SI #dsam9998#6 ! "X";
         aAlfa = aMenuF9_1;  |HAZ QuitaRaros;  aMenuF9_1 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_1, 1110, 1173, MenuF9_1;
         nBotonMen1 = FSalida;
     |FINSI;

     |SI #dsam9998#7 ! "X";
         aAlfa = aMenuF9_2;  |HAZ QuitaRaros;  aMenuF9_2 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_2, 1210, 1273, MenuF9_2;
         nBotonMen2 = FSalida;
     |FINSI;

     |SI #dsam9998#8 ! "X";
         aAlfa = aMenuF9_3;  |HAZ QuitaRaros;  aMenuF9_3 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_3, 1310, 1373, MenuF9_3;
         nBotonMen3 = FSalida;
     |FINSI;

     |SI #dsam9998#9 ! "X";
         aAlfa = aMenuF9_4;  |HAZ QuitaRaros;  aMenuF9_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_4, 1410, 1473, MenuF9_4;
         nBotonMen4 = FSalida;
     |FINSI;

     |SI #dsam9998#10 ! "X";
         aAlfa = aMenuF9_5;  |HAZ QuitaRaros;  aMenuF9_5 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_5, 1510, 1573, MenuF9_5;
         nBotonMen5 = FSalida;
     |FINSI;

     |SI #dsam9998#11 ! "X";
         aAlfa = aMenuF9_6;  |HAZ QuitaRaros;  aMenuF9_6 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_6, 1610, 1673, MenuF9_7;
         nBotonMen6 = FSalida;
     |FINSI;

     |SI #dsam9998#12 ! "X";
         aAlfa = aMenuF9_7;  |HAZ QuitaRaros;  aMenuF9_7 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_7, 1710, 1773, MenuF9_7;
         nBotonMen7 = FSalida;
     |FINSI;

     |SI #dsam9998#13 ! "X";
         aAlfa = aMenuF9_8;  |HAZ QuitaRaros;  aMenuF9_8 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_8, 1810, 1873, MenuF9_8;
         nBotonMen8 = FSalida;
     |FINSI;

     |SI #dsam9998#14 ! "X";
         aAlfa = aMenuF9_9;  |HAZ QuitaRaros;  aMenuF9_9 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_9, 1910, 1973, MenuF9_9;
         nBotonMen9 = FSalida;
     |FINSI;

     |SI #dsam9998#15 ! "X";
         aAlfa = aMenuF9_10; |HAZ QuitaRaros;  aMenuF9_10 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_10, 2010, 2073, MenuF9_10;
         nBotonMen10 = FSalida;
     |FINSI;

     |SI #dsam9998#16 ! "X";
         aAlfa = aMenuF9_11; |HAZ QuitaRaros;  aMenuF9_11 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_11, 2110, 2173, MenuF9_11;
         nBotonMen11 = FSalida;
     |FINSI;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuF9_1;       |FINSI;
         |SI aTecla = "B";  |HAZ MenuF9_2;       |FINSI;
         |SI aTecla = "C";  |HAZ MenuF9_3;       |FINSI;
         |SI aTecla = "D";  |HAZ MenuF9_4;       |FINSI;
         |SI aTecla = "E";  |HAZ MenuF9_5;       |FINSI;
         |SI aTecla = "F";  |HAZ MenuF9_6;       |FINSI;
         |SI aTecla = "G";  |HAZ MenuF9_7;       |FINSI;
         |SI aTecla = "H";  |HAZ MenuF9_8;       |FINSI;
         |SI aTecla = "I";  |HAZ MenuF9_9;       |FINSI;
         |SI aTecla = "J";  |HAZ MenuF9_10;      |FINSI;
         |SI aTecla = "K";  |HAZ MenuF9_11;      |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF9, "ENABLE";

     |HAZ FinOpcionF9;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F10 -----------------------
|PROCESO TrataColaboraciones;
     |PUSHV 0501 2380;
     |PINPA #0#dsaw0002;
     |HAZ PintaTitulo;

     #dsaw0002#0 = #dsam0000#enCamF10#;
     |PINDA #0#dsaw0002;
     |ENDATOS #1#dsaw0002;

     #dsam0000#enCamF10# = #dsaw0002#0;

     |POPV;
|FPRC;

|PROCESO MenuF10_1;
     |SI #dsam9998#17 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#17 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     aAlfa = aMenuF10_1;
     enCamF10 = 121; |HAZ TrataColaboraciones; enCamF10 = 0;

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_2;
     |SI #dsam9998#18 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#18 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     aAlfa = aMenuF10_2;
     enCamF10 = 122; |HAZ TrataColaboraciones; enCamF10 = 0;

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_3;
     |SI #dsam9998#19 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#19 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_4;
     |SI #dsam9998#20 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#20 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_5;
     |SI #dsam9998#21 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#21 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_6;
     |SI #dsam9998#22 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#22 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_7;
     |SI #dsam9998#23 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#23 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ Desaparece;
     |HAZ DesapareceOpcionF10;

     |MENAV "0000La opcion esta en CONSTRUCCION, consulte con su administrador";

     |HAZ Aparece;
     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO OpcionF10;
     |SI nOkCol = 0;
         nOpcion = 0;
         |ACABA;
     |FINSI;

     |ATRI 0;
     |BLIN 04;

     |ESTADO_CONTROL nBtnF10, "DISABLE";

     |ATRI N;

     |SI #dsam9998#17 ! "X";
         aAlfa = aMenuF10_1;  |HAZ QuitaRaros;  aMenuF10_1 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_1, 1110, 1173, MenuF10_1;
         nBotonMen1 = FSalida;
     |FINSI;

     |SI #dsam9998#18 ! "X";
         aAlfa = aMenuF10_2;  |HAZ QuitaRaros;  aMenuF10_2 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_2, 1210, 1273, MenuF10_2;
         nBotonMen2 = FSalida;
     |FINSI;

     |SI #dsam9998#19 ! "X";
         aAlfa = aMenuF10_3;  |HAZ QuitaRaros;  aMenuF10_3 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_3, 1310, 1373, MenuF10_3;
         nBotonMen3 = FSalida;
     |FINSI;

     |SI #dsam9998#20 ! "X";
         aAlfa = aMenuF10_4;  |HAZ QuitaRaros;  aMenuF10_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_4, 1410, 1473, MenuF10_4;
         nBotonMen4 = FSalida;
     |FINSI;

     |SI #dsam9998#21 ! "X";
         aAlfa = aMenuF10_5;  |HAZ QuitaRaros;  aMenuF10_5 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_5, 1510, 1573, MenuF10_5;
         nBotonMen5 = FSalida;
     |FINSI;

     |SI #dsam9998#22 ! "X";
         aAlfa = aMenuF10_6;  |HAZ QuitaRaros;  aMenuF10_6 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_6, 1610, 1673, MenuF10_6;
         nBotonMen6 = FSalida;
     |FINSI;

     |SI #dsam9998#23 ! "X";
         aAlfa = aMenuF10_7;  |HAZ QuitaRaros;  aMenuF10_7 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_7, 1710, 1773, MenuF10_7;
         nBotonMen7 = FSalida;
     |FINSI;

     |HAZ Aparece;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuF10_1;      |FINSI;
         |SI aTecla = "B";  |HAZ MenuF10_2;      |FINSI;
         |SI aTecla = "C";  |HAZ MenuF10_3;      |FINSI;
         |SI aTecla = "D";  |HAZ MenuF10_4;      |FINSI;
         |SI aTecla = "E";  |HAZ MenuF10_5;      |FINSI;
         |SI aTecla = "F";  |HAZ MenuF10_6;      |FINSI;
         |SI aTecla = "G";  |HAZ MenuF10_7;      |FINSI;
     |SIGUE;

     |ESTADO_CONTROL nBtnF10, "ENABLE";

     |HAZ FinOpcionF10;
|FPRC;

|| PROCESOS DE LOS CAMPOS DE ESTE DEF ....

|PROCESO GrabaTelefono;
     #dsam0107#0 = #dsam0000#1;
     |GRABA 020#dsam0107.n;
     |LIBERA #dsam0107;

     #dsam0107#0 = Contenido;
     |LEE 101#dsam0107.=;
     |SI FSalida = 0;
         |BORRA 020#dsam0107.a;
         |LIBERA #dsam0107;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0107;
     #dsam0107#1;
     ;
     Contenido, 00;
     Contenido, 99;
     be;
     NULL, GrabaTelefono;
|FIN;

|PROCESO CambiaNombre; |TIPO 0;
     enModo   = (FEntrada / 100) ! 0;
     |SI FEntrada < 10;  enModo = FEntrada;  |FINSI;
     |SI enModo = 4;  |ACABA;  |FINSI;

     aAlfa = " " * 40;
     |SI enModo = 2;
         |SI aContenNom ! #dsam0000#Campo#; |Y aContenNom ! aAlfa;
             |CONFI "    NEstas cambiando el Nombre del Cliente, desea continuar.";
             |SI FSalida ! 0;
                 #dsam0000#Campo# = aContenNom; |PINTA #dsam0000#1;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
         aContenNom = #dsam0000#Campo#;
     |FINSI;

     |SI Contenido ! aAlfa;  |Y #dsam0000#Campo# ! Contenido;
         |ABRE #dsam0106;
         #dsam0106#0 = #dsam0000#1;
         |LEE 101#dsam0106.=;
         |SI FSalida ! 0;
             #dsam0106#0 = #dsam0000#1;
             #dsam0106#1 = #dsam0000#27;
             #dsam0106#2 = #dsam0000#28;
             |GRABA 020#dsam0106.n;
             |LIBERA #dsam0106;

             #dsam0106#0 = Contenido;
             |LEE 101#dsam0106.=;
             |SI FSalida = 0;
                 |BORRA 020#dsam0106.a;
                 |LIBERA #dsam0106;
             |FINSI;

             |BUCLE dsam0107;
         |FINSI;
         |CIERRA #dsam0106;

         eaNuevo1 = #dsam0000#1;
         eaNuevo2 = Contenido;
         |HAZ GrabaDirecCorreo;
     |FINSI;
     |SI enModo = 1;
         aAlfa1 = #dsam0000#2; |QBF aAlfa1;
         |SI aAlfa1 = ""; #dsam0000#2  = #dsam0000#1;  |PINTA #dsam0000#2; |FINSI;
         aAlfa1 = #dsam0000#53; |QBF aAlfa1;
         |SI aAlfa1 = ""; #dsam0000#53 = #dsam0000#1; |PINTA #dsam0000#53; |FINSI;
     |FINSI;
|FPRC;

|PROCESO CambiaNomCom; |TIPO 0;
     enModo   = (FEntrada / 100) ! 0;
     |SI FEntrada < 10;  enModo = FEntrada;  |FINSI;
     |SI enModo = 4;  |ACABA;  |FINSI;

     aAlfa = " " * 40;
     |SI enModo = 2;
         |SI aContenNo2 ! #dsam0000#Campo#; |Y aContenNo2 ! aAlfa;
             |CONFI "    NEstas cambiando el Nombre Comercial del Cliente, desea continuar.";
             |SI FSalida ! 0;
                 #dsam0000#Campo# = aContenNo2; |PINTA #dsam0000#2;
                 |ERROR;
                 |ACABA;
             |FINSI;
         |FINSI;
         aContenNo2 = #dsam0000#Campo#;
     |FINSI;
|FPRC;

|PROCESO ModoEntrada;  |TIPO 7;
     aContenido  = Contenido;
     |HAZ Comunero;

     enModo   = (FEntrada / 100) ! 0;
     |SI FEntrada < 10;  enModo = FEntrada;  |FINSI;
     aContenNom = #dsam0000#1;
     aContenNo2 = #dsam0000#2;
|FPRC;

|PROCESO CompruebaNif;  |TIPO 6;
     |SI enModo = 1;
         eaNifRep = #dsam0000#3;|QBF eaNifRep;
         |SI eaNifRep ! "";
             enCodRep = #dsam0000#0;
             |SUB_EJECUTA_NP ":integral/dsaz0009";
             |SI enSwMal = 1;
                 |PTEC 807;
             |FINSI;
         |FINSI;
     |FINSI;


     |SI enModo ! 2;  |ACABA;  |FINSI;

     |SI aContenido ! #dsam0000#3;
         |CONFI "    NEstas cambiando en NIF del Cliente, desea continuar.";
         |SI FSalida ! 0;
             #dsam0000#3 = aContenido; |PINTA #dsam0000#3;
             |ERROR;
         |SINO;
             eaNifRep = #dsam0000#3;|QBF eaNifRep;
             |SI eaNifRep ! "";
                 enCodRep = #dsam0000#0;
                 |SUB_EJECUTA_NP ":integral/dsaz0009";
                 |SI enSwMal = 1;
                     |PTEC 807;
                 |FINSI;
             |FINSI;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Situacion;
     |SI #dsam0000#85 = "A"; #dsam0000#5 = "ACTIVA  "; |FINSI;
     |SI #dsam0000#85 = "I"; #dsam0000#5 = "INACTIVA"; |FINSI;
     |PINTA #dsam0000#5;
|FPRC;

|PROCESO Tipo;
     |SI #dsam0000#50 = 1; #dsam0000#51 = "CONTRATO"; |FINSI;
     |SI #dsam0000#50 = 2; #dsam0000#51 = "SERVICIO"; |FINSI;
     |PINTA #dsam0000#51;
|FPRC;

|PROCESO CauBaja6; |TIPO 6;
     aAlfa = #dsam0000#110; |QBF aAlfa;
     |SI aAlfa = "";
         |ABRE #dsam0011;
         #dsam0011#0 = "   ";
         |LEE 001#dsam0011.=;
         |SI FSalida ! 0;
             #dsam0011#0 = "   ";
             #dsam0011#1 = "";
             |GRABA 020#dsam0011.n;
         |FINSI;
         |CIERRA #dsam0011;
     |FINSI;
|FPRC;

|PROCESO CauBaja0; |TIPO 0;
  aAlfa = Contenido;
  |ABRE #dsam0011;
  |DDEFECTO #dsam0011;
  #dsam0011#0 = #dsam0000#110;
  |LEE 001#dsam0011.=;
  |CIERRA #dsam0011;

  |SI aAlfa ! #dsam0000#110;
      #dsam0000#8 = #dsam0011#1; |PINTA #dsam0000#8;
  |FINSI;
|FPRC;

|PROCESO LetraDnim00;  |TIPO 6;
     |SI FSalida = 10;
         eaVarDni   = #dsam0000#Campo#;
         enCalcCif  = 1;
         |HAZ CalculoDNI;
         #dsam0000#Campo# = eaVarDni;
         |PINTA #dsam0000#Campo#;
         |ERROR;
         |ACABA;
     |FINSI;

     eaVarDni  = #dsam0000#Campo#;
     enCalcCif = 0;
     |HAZ CalculoDNI;
     eaVarDni = (eaVarDni + "            ") % 112;
     |SI #dsam0000#Campo# ! eaVarDni;
         |CONFI "0000SEl Nif puede ser Erroneo. Desea Calcularlo.";
         |SI FSalida = 0;
             #dsam0000#Campo# = eaVarDni;  |PINTA #dsam0000#Campo#;
             |ERROR;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO RecogeNom; |TIPO 0;
     |SI #dsam0000#13 = 0;  |ACABA;  |FINSI;

     |PUSHV 0501 2380;

     nEmpresaGuarda = #dsam0000#0;

     |SALVA_DATOS #dsam0000;

     #dsam0000#0 = #dsam0000#13;
     |LEE 040#dsam0000.=;
     |SI FSalida ! 0; |DDEFECTO #dsam0000; |FINSI;

     aAlfa1= #dsam0000#1;

     |LIBERA #dsam0000;

     #dsam0000#0 = nEmpresaGuarda;
     |LEE 101#dsam0000.=;

     |REPON_DATOS #dsam0000;

     |POPV;

     #dsam0000#14 = aAlfa1;  |PINTA #dsam0000#14;
|FPRC;

|PROCESO PonPtecs;
    aAlfa  = aCadena % 0;
    nLong  = aAlfa;
    |PARA nCaracter = nLong;  |SI nCaracter ] 1;  |HACIENDO nCaracter = nCaracter - 1;
          nPosi  = (100 * nCaracter) + 1;
          aAlfa  = aCadena % nPosi;
          nPtec  = &aAlfa;
          |PTEC nPtec;
    |SIGUE;
|FPRC;

|PROCESO Tipo1;  |TIPO 1;
     enModo   = (FEntrada / 100) ! 0;
     |SI enModo ! 3;  |ACABA;  |FINSI;

     aPassword = "";
     |PUSHV 0501 2380;
     |CUADRO 0501 2380;
     |BLANCO 0602 2279;
     |PINTA 1320, "Introduzca Password : ";
     E_inf = "";
     E_sup = "20";
     aPassword = 1342 ? -1;
     |SI aPassword ! "<MYPASWD>           ";
         |MENAV "     Permiso denegado.";
         |ERROR;
         |POPV;
         |ACABA;
     |FINSI;
     |POPV;

     enEmpresa = #dsam0000#0;
     enBajaCli = 1;
     |SUB_EJECUTA ":basica/dsborrad";
     |SI enBajaCli = 1;
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO BorraFamiliar;
     |BORRA 020#dsam0004.a;
     |LIBERA #dsam0004;
|FPRC;

|DEFBUCLE dsam0004;
     #dsam0004#1;
     ;
     #dsam0000#0, 00;
     #dsam0000#0, 99;
     be;
     NULL, BorraFamiliar;
|FIN;

|PROCESO Tipo12m00;  |TIPO 12;
     || Este proceso sirve para que el endatos que se hace en el
     || calculo dsam0000 no pregunte Correcto S/N
     || POR LO TANTO NO LO QUITEIS !!!!!!


     |SI enDesdeRenta ! 0;
         |GRABA 020#dsam0000.a;
         |LIBERA #dsam0000;

         enEmpresa = #dsam0000#0;
         |SUB_EJECUTA_NP ":integral/dsam0005;CHEQUEA";

         |LEE 101#dsam0000.=;
     |FINSI;

     |ABRE #dsam0005;
     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida ! 0;
         #dsam0005#0  = #dsam0000#0;
         #dsam0005#1  = 97;
         #dsam0005#2  = "DOMICILIO SOCIAL ";
         #dsam0005#3  = #dsam0000#19;
         #dsam0005#4  = #dsam0000#20;
         #dsam0005#5  = #dsam0000#21;
         #dsam0005#6  = #dsam0000#22;
         #dsam0005#7  = #dsam0000#23;
         #dsam0005#8  = #dsam0000#24;
         #dsam0005#9  = #dsam0000#25;
         #dsam0005#10 = #dsam0000#26;
         #dsam0005#11 = #dsam0000#27;
         #dsam0005#12 = #dsam0000#28;
         #dsam0005#17 = #dsam0000#98;
         #dsam0005#18 = #dsam0000#99;
         #dsam0005#15 = #dsam0000#86;
         #dsam0005#16 = #dsam0000#87;
         |GRABA 020#dsam0005.n;

         #dsam0005#0 = #dsam0000#0;
         #dsam0005#1 = 98;
         #dsam0005#2 = "DOMICILIO FISCAL ";
         |GRABA 020#dsam0005.n;

         #dsam0005#0 = #dsam0000#0;
         #dsam0005#1 = 99;
         #dsam0005#2 = "DOMICILIO ENVIO  ";
         |GRABA 020#dsam0005.n;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 97;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#19  = #dsam0005#3;
         #dsam0000#20  = #dsam0005#4;
         #dsam0000#21  = #dsam0005#5;
         #dsam0000#22  = #dsam0005#6;
         #dsam0000#23  = #dsam0005#7;
         #dsam0000#24  = #dsam0005#8;
         #dsam0000#25  = #dsam0005#9;
         #dsam0000#26  = #dsam0005#10;
         #dsam0000#27  = #dsam0005#11;
         #dsam0000#28  = #dsam0005#12;
         #dsam0000#98  = #dsam0005#17;
         #dsam0000#99  = #dsam0005#18;
         #dsam0000#86  = #dsam0005#15;
         #dsam0000#87  = #dsam0005#16;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 98;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#29 = #dsam0005#3;
         #dsam0000#30 = #dsam0005#4;
         #dsam0000#31 = #dsam0005#5;
         #dsam0000#32 = #dsam0005#6;
         #dsam0000#33 = #dsam0005#7;
         #dsam0000#34 = #dsam0005#8;
         #dsam0000#35 = #dsam0005#9;
         #dsam0000#36 = #dsam0005#10;
         #dsam0000#37 = #dsam0005#11;
         #dsam0000#38 = #dsam0005#12;
     |FINSI;

     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 99;
     |LEE 040#dsam0005.=;
     |SI FSalida = 0;
         #dsam0000#39 = #dsam0005#3;
         #dsam0000#40 = #dsam0005#4;
         #dsam0000#41 = #dsam0005#5;
         #dsam0000#42 = #dsam0005#6;
         #dsam0000#43 = #dsam0005#7;
         #dsam0000#44 = #dsam0005#8;
         #dsam0000#45 = #dsam0005#9;
         #dsam0000#46 = #dsam0005#10;
         #dsam0000#47 = #dsam0005#11;
         #dsam0000#48 = #dsam0005#12;

         |ABRE #dsam0003;
         #dsam0003#0 = #dsam0000#0;
         |LEE 040#dsam0003.=;
         |SI FSalida = 0;
             #dsam0003#24 = #dsam0000#39;
             #dsam0003#25 = #dsam0000#40;
             #dsam0003#26 = #dsam0000#41;
             #dsam0003#27 = #dsam0000#42;
             #dsam0003#28 = #dsam0000#43;
             #dsam0003#29 = #dsam0000#44;
             #dsam0003#30 = #dsam0000#45;
             #dsam0003#31 = #dsam0000#46;
             #dsam0003#32 = #dsam0000#47;
             #dsam0003#33 = (("00" + #dsam0003#30) % -102) + (("000" + #dsam0003#31) % -103);
             |GRABA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;
     |FINSI;
     |CIERRA #dsam0005;

     |SI enDesdeRenta ! 0;
         |GRABA 020#dsam0000.a;
         |LIBERA #dsam0000;
     |FINSI;

     |SI enModo = 1;  |Y enDesdeRenta = 0;
         |PTEC 802;
         aCadena = ("00000" + nCodigo)  % -105;  |HAZ PonPtecs;  || Pone Hasta Empresa
         |PTEC 802;
         |PTEC 811;
         |PTEC 811;
         |PTEC 807;
         |ACABA;
     |FINSI;

     enDesdeFuera = 0;

     |HAZ GrabaTelef;
     |HAZ GrabaCorreo;
     |HAZ GrabaOtrasApli;

     |SI #dsam0000#68 = "N";
         |ABRE #dsam0003;
         #dsam0003#0 = #dsam0000#0;
         |LEE 101#dsam0003.=;
         |SI FSalida = 0;
             |BORRA 020#dsam0003.a;
             |LIBERA #dsam0003;
         |FINSI;
         |CIERRA #dsam0003;

         |BUCLE dsam0004;
     |FINSI;
|FPRC;

|PROCESO T7_0;  |TIPO 7;
     nEstoyCampo = 1;
|FPRC;

|PROCESO ControlProg;  |TIPO 0;
     |SI Campo = 0; |Y nOpcion [ 1;
         |SI FSalida ! 0;
             |LEE 000#dsam0000.=;
             |PINDA #0#dsam0000;
             |ACABA;
         |FINSI;
     |FINSI;

     |SI Campo = 0;
         |SI nEstoyCampo = 1;
              nOpcion = 1;
              |ACABA;
         |SINO;
              enModo = 4;
         |FINSI;
     |FINSI;

     |PUSHV 0501 2380;

     |SI FSalida = 10;  nOpcion = 1;  |FINSI;
     |SI FSalida = 11;  nOpcion = 2;  |FINSI;
     |SI FSalida = 12;  nOpcion = 3;  |FINSI;
     |SI FSalida = 13;  nOpcion = 4;  |FINSI;
     |SI FSalida = 14;  nOpcion = 5;  |FINSI;
     |SI FSalida = 15;  nOpcion = 6;  |FINSI;
     |SI FSalida = 16;  nOpcion = 7;  |FINSI;
     |SI FSalida = 17;  nOpcion = 8;  |FINSI;
     |SI FSalida = 18;  nOpcion = 9;  |FINSI;

     |SI nOpcion ] 2;
         |SALVA_DATOS #dsam0000;
         |LIBERA #dsam0000;
         |LEE 101#dsam0000.=;
         |SI FSalida ! 0;
             |REPON_DATOS #dsam0000;
             |GRABA 020#dsam0000.n;
         |SINO;
             |REPON_DATOS #dsam0000;
             |GRABA 020#dsam0000.a;
         |FINSI;
         |LIBERA #dsam0000;

         |ESTADO_CONTROL nBtnF2, "ENABLE";

         |SI enModo ! 4;
             enDesdeFuera = 0;
             |HAZ GrabaTelef;
             |HAZ GrabaCorreo;
             |HAZ GrabaOtrasApli;
         |FINSI;
     |SINO;
         |ESTADO_CONTROL nBtnF2, "DISABLE";
     |FINSI;

     |SI nOpcion = 0;  nOpcion = 1;  |FINSI;

     nSwDentro = 0;
     |SI nOpcion ] 2;
        nSwDentro = 1;
        |PUSHV 0501 2380;
        |BLANCO 0701 2380;
        |PINPA #0#dsaw0000;
     |FINSI;

     |PARA;  |SI nOpcion ] 2;  |HACIENDO;
          |SI nOpcion = 2;  |HAZ OpcionF3;  |FINSI;
          |SI nOpcion = 3;  |HAZ OpcionF4;  |FINSI;
          |SI nOpcion = 4;  |HAZ OpcionF5;  |FINSI;
          |SI nOpcion = 5;  |HAZ OpcionF6;  |FINSI;
          |SI nOpcion = 6;  |HAZ OpcionF7;  |FINSI;
          |SI nOpcion = 7;  |HAZ OpcionF8;  |FINSI;
          |SI nOpcion = 8;  |HAZ OpcionF9;  |FINSI;
          |SI nOpcion = 9;  |HAZ OpcionF10; |FINSI;
     |SIGUE;

     |SI nSwDentro = 1;
         |POPV;
         |PINPA #0#dsam0000;
         |SI enModo ! 4;  |PTEC 808; |FINSI;
     |FINSI;

     |ESTADO_CONTROL nBtnF2, "DISABLE";

     |POPV;
|FPRC;

|PROCESO Tipo13;  |TIPO 13;
     |SI #dsam0000#0 = 0;  |ACABA;  |FINSI;
     |SI FSalida < 0; |ACABA; |FINSI;

     enEmpresa = #dsam0000#0;
     |HAZ MiraBloqueo;

     enModo    = 4;
     enCliente = #dsam0000#0;
|FPRC;

|PROCESO PulsoBtnF2;
     aAlfa = #dsam0000#3 + #dsam0000#1;  |QBT aAlfa;
     |SI aAlfa = "";  |ACABA;  |FINSI;

     nOpcion = 1;
     |PTEC 824;
|FPRC;

|PROCESO PulsoBtnF3;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 2;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 2;
     |PTEC 825;
|FPRC;

|PROCESO PulsoBtnF4;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 3;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 3;
     |PTEC 826;
|FPRC;

|PROCESO PulsoBtnF5;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 4;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 4;
     |PTEC 827;
|FPRC;

|PROCESO PulsoBtnF6;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 5;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 5;
     |PTEC 828;
|FPRC;

|PROCESO PulsoBtnF7;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 6;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 6;
     |PTEC 829;
|FPRC;

|PROCESO PulsoBtnF8;
     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "dsarchi/def/dsarm005.mas";
     |XABRE "E", aBase, nHandle;
     |SI FSalida < 0;
         nOpcion = 1;
         |ACABA;
     |FINSI;

     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 7;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 7;
     |PTEC 830;
|FPRC;

|PROCESO PulsoBtnF9;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 8;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 8;
     |PTEC 831;
|FPRC;

|PROCESO PulsoBtnF10;
     |SI enModo = 4;  |Y nOpcion = 1;
         nOpcion = 9;
         |HAZ ControlProg;
         |ACABA;
     |FINSI;

     nOpcion = 9;
     |PTEC 832;
|FPRC;

|PROCESO MiraDsArchi;
   |DBASS aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dsarchi/def/dsarm001.mas";
   |XABRE "E", aAlfa, nHandle;
   |SI FSalida ] 0;
      |CARGA_DEF aAlfa, Ref0001@;
      |SI FSalida = 0;
         |DBASS aAlfa; |QBF aAlfa;
         aAlfa = aAlfa + "dsarchi/fich/";
         |PATH_DAT #Ref0001@#aAlfa#;

         |ABRE #Ref0001@;
         |DDEFECTO #Ref0001@;
         |LEE 000#Ref0001@.p;
         |SI FSalida ! 0; |DDEFECTO #Ref0001@; |FINSI;

         |SI #Ref0001@#3 = "S";
            enSwDSArchi = 1;
         |FINSI;

         |DESCARGA_DEF #Ref0001@;
      |FINSI;
   |FINSI;
|FPRC;

|PROGRAMA;
     |ABRE #dsam0000;
     |SELECT #6#dsam0000;
     |LEE 000#dsam0000.u;
     |SI FSalida ! 0;  |DDEFECTO #dsam0000;  |FINSI;
     |CIERRA #dsam0000;

     |C_M #dsam0000#120, 1, "N";

     eaPrograma = "PORTAL";
     |HAZ INTEGRAL_INI;
     |SI enAprobacion = 1;
         |C_M #dsam0000#120, 1, "S";
     |FINSI;

     aAlfa = #dsam0000#116;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000Se va a proceder a calcular el codigo IBAN en toda la aplicacion. Espere por favor";

         |SUB_EJECUTA_NP ":basica/dspase33;AUTO";
     |FINSI;

     enSwDSArchi = 0;
     |HAZ MiraDsArchi;

     |SI PARAMETRO ! "";
         enDesdeRenta = PARAMETRO;
     |FINSI;

     |SI enDesdeRenta = 0;
         |MANTE #dsam0000;
     |SINO;
         nModo = 2;

         |ABRET #dsam0000;
         #dsam0000#0 = enDesdeRenta;
         |LEE 101#dsam0000.=;
         |SI FSalida ! 0;
             nModo = 1;
             |DDEFECTO #dsam0000;
             #dsam0000#0  = enDesdeRenta;
             #dsam0000#1  = eaNombre;
             #dsam0000#2  = eaNombre;
             #dsam0000#3  = eaNif;
             #dsam0000#68 = "S";
             |GRABA 020#dsam0000.b;
         |FINSI;

         |PINPA #0#dsam0000;
         |PINDA #0#dsam0000;

         |HAZ Tipo8;
         |HAZ Tipo13;
         |HAZ T7_0;
         |HAZ ControlProg;

         |SI nModo = 1;   |ENDATOS #1#dsam0000;  |FINSI;
         |SI nModo = 2;   |ENDATOS #2#dsam0000;  |FINSI;

         |SI FSalida ! 0;  |Y nModo = 1;
             |BORRA 020#dsam0000.a;
         |FINSI;

         |HAZ Tipo9;
         |CIERRAT #dsam0000;
     |FINSI;
|FPRO;

|PROCESO Tipo20;  |TIPO 20;
     |SI #dsam9998#1 ! "A";
         |ERROR;
         |ACABA;
     |FINSI;

     aAlfa = FSalida;

     |SI aAlfa = "OPCION";
         FSalida = "Modo X";
         |ACABA;
     |FINSI;

     nModo   = (FEntrada / 100) ! 0;
     |SI nModo ! 4;
         |ACABA;
     |FINSI;

     |SUB_EJECUTA "dsaz9997;MODOX";
     |PTEC 807;
|FPRC;

|PROCESO Tipo8; |TIPO 8;
     |ABRE #dsam9998;
     |LEE 000#dsam9998.p;
     |SI FSalida ! 0;  |DDEFECTO #dsam9998;  |FINSI;
     |CIERRA #dsam9998;

     nOkGes = 0;
     |SI #dsam9998#2  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#3  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#4  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#5  ! "X";  nOkGes = 1;  |FINSI;

     nOkSeg = 0;
     |SI #dsam9998#6  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#7  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#8  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#9  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#10 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#11 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#12 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#13 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#14 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#15 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#16 ! "X";  nOkSeg = 1;  |FINSI;

     nOkCol = 0;
     |SI #dsam9998#17 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#18 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#19 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#20 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#21 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#22 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#23 ! "X";  nOkCol = 1;  |FINSI;

     |CONTROL_SIMPLE 0, "BOTON,F2 D.Generales", 0563, 0579, PulsoBtnF2;
     nBtnF2 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F3 Mantenimientos", 0709, 0723, PulsoBtnF3;
     nBtnF3 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F4 Sociedades", 0725, 0739, PulsoBtnF4;
     nBtnF4 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F5 Laboral", 0741, 0755, PulsoBtnF5;
     nBtnF5 = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,F6 Consultas", 0757, 0771, PulsoBtnF6;
     nBtnF6 = FSalida;

     |SI nOkGes = 1;
         |CONTROL_SIMPLE 0, "BOTON,F7 Gestoria", 0809, 0823, PulsoBtnF7;
         nBtnF7 = FSalida;
     |FINSI;

     |CONTROL_SIMPLE 0, "BOTON,F8 GAD", 0825, 0839, PulsoBtnF8;
     nBtnF8 = FSalida;

     |SI nOkSeg = 1;
         |CONTROL_SIMPLE 0, "BOTON,F9 Seguros", 0841, 0855, PulsoBtnF9;
         nBtnF9 = FSalida;
     |FINSI;

     |SI nOkCol = 1;
         |CONTROL_SIMPLE 0, "BOTON,F10 Colaboraciones", 0857, 0871, PulsoBtnF10;
         nBtnF10 = FSalida;
     |FINSI;

     |DBASS aBase;  |QBT aBase;
     aBase = aBase + "dsarchi/def/dsarm005.mas";
     |XABRE "E", aBase, nHandle;
     |SI FSalida < 0;
         |ESTADO_CONTROL nBtnF8, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Tipo9;  |TIPO 9;
       |FIN_CONTROL_WINDOWS nBtnF2;
       |FIN_CONTROL_WINDOWS nBtnF3;
       |FIN_CONTROL_WINDOWS nBtnF4;
       |FIN_CONTROL_WINDOWS nBtnF5;
       |FIN_CONTROL_WINDOWS nBtnF6;
       |FIN_CONTROL_WINDOWS nBtnF7;
       |FIN_CONTROL_WINDOWS nBtnF8;
       |FIN_CONTROL_WINDOWS nBtnF9;
       |FIN_CONTROL_WINDOWS nBtnF10;

       |PULSATECLA;

       |SUB_EJECUTA "dsaz9997;SINOPCION";
|FPRC;
