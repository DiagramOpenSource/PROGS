|FICHEROS;
     :/basica/def/agiw0021 #95;
     :/basica/def/agim0002 #97,MANTE;
     :/basica/def/agim0015 #94;
|FIN;

|VARIABLES;
     &enEmpresa = 0;

     NMovi = 0;
|FIN;

|| ************************************************************************
||                     PROCESO DEL AGIM0002
|| ************************************************************************

|PROCESO Totales97;
     #95#0 = #95#0 + #97#13;
     #95#1 = #95#1 + #97#15;
     #95#2 = #95#2 + #97#16;
     #95#3 = #95#3 + #97#14;
     NMovi = NMovi + 1;
|FPRC;

|DEFBUCLE agim0002;
     #97#1;
     ;
     enEmpresa, 00, 1900;
     enEmpresa, 99, 2999;
     ;
     NULL, Totales97;
|FIN;

|RUTINA ClaveBaja97;
     #97#0  = enEmpresa;
     #97#1  = 0;
     #97#2  = 1900;
|FRUT;

|RUTINA ClaveAlta97;
     #97#0  = enEmpresa;
     #97#1  = 99;
     #97#2  = 2999;
|FRUT;

|PROCESO Tipo11; |TIPO 11;
     |SI FSalida ! 9; |ACABA; |FINSI;

     |ABRE #94;
     #94#0 = #97#2;
     |LEE 040#94=;
     |SI FSalida ! 0; |DDEFECTO #94; |FINSI;
     |CIERRA #94;

     |PUSHV 0501 2380;
     |PINPA #0#95;

     #95#8  = #97#14;
     #95#9  = #97#12;
     |SI #95#9 = 0; #95#9 = 1; |FINSI;
     #95#10 = #95#8 / #95#9;
     #95#11 = #97#25;
     #95#12 = #95#10 / #95#11;
     #95#13 = #94#1;
     #95#14 = #95#12 - #95#13;

     |PINDA #0#95;
     |PAUSA;  |POPV;  |ERROR;
|FPRC;

|PROCESO Tipo2;
|FPRC;

|PROCESO Defectos;
|FPRC;

|PROCESO Totales;
|FPRC;

|PROGRAMA;
     |PDEFECTO #95, 0, 8;
     NMovi = 0;

     |BUCLE agim0002;

     #95#4 = #95#0 / NMovi;
     #95#5 = #95#1 / NMovi;
     #95#6 = #95#2 / NMovi;
     #95#7 = #95#3 / NMovi;

     |PUSHV 0501 2380;

     |PINPA #0#97;

     |ATRI I;
     |PINTA 2107, #95#0;
     |PINTA 2118, #95#1;
     |PINTA 2129, #95#2;
     |PINTA 2140, #95#3;

     |PINTA 2207, #95#4;
     |PINTA 2218, #95#5;
     |PINTA 2229, #95#6;
     |PINTA 2240, #95#7;

     |ENTLINEAL #1#97, -3, 4, 19, 0, ClaveBaja97, ClaveAlta97;
     |POPV;
|FPRO;
