|FICHEROS;
     :/integral/def/dsaw0016,MANTE;
     :/integral/def/dsam0000;
     :/integral/def/dsam0110;

     dsat0001;
     dsaw0013;
     dsam0024;
|FIN;

|VARIABLES;
     nModo       = 0;
     nInkey      = 0;
     aAlfa       = "";
     nNume1      = 0;
     nHMes       = 0;
     nHEjer      = 0;
     nBueno      = 0;

     &enEmpresa  = 0;
     &aFuncion   = 0;
     &enEmpPD    = 0;
     &enEjer     = 0;
     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDAgente  = 0;
     &enHAgente  = 0;
|FIN;

|PROCESO Tipo6C0w16; |TIPO 6;

   |SI #dsaw0016#0 < enDEmpresa; |O #dsaw0016#0 > enHEmpresa;
       |MENAV "0000Error. Cliente fuera de la seleccion";
       |ERROR;
       |ACABA;
   |FINSI;

   nBueno = 0;
   |ABRE #dsam0000;
   #dsam0000#0 = #dsaw0016#0;
   |LEE 041#dsam0000.=;
   |SI FSalida ! 0;
       |MENAV "0000Error no existe Cliente";
       nBueno = 1;
       |ERROR;
   |SINO;
       |SI #dsam0000#72 < enDAgente; |O #dsam0000#72 > enHAgente;
           |MENAV "0000El agente de este cliente fuera de la seleccion";
           nBueno = 1;
           |ERROR;
       |SINO;
           |SI #dsam0000#122 = "N";
               |CONFI "0000NEmpresa NO obligada. Continuar";
               |SI FSalida ! 0;
                   nBueno = 1;
                   |ERROR;
               |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;
   |CIERRA #dsam0000;
   #dsaw0016#21 = "";
   |SI nBueno = 0;
       #dsaw0016#21 = #dsam0000#3;
   |FINSI;
   |PINTA #dsaw0016#21;
|FPRC;

|PROCESO Tipo0C0w16; |TIPO 0;

||   |ABRE #dsat0001;
   #dsat0001#0 = aFuncion;
   #dsat0001#1 = enEmpPD;
   #dsat0001#2 = enEjer;
   #dsat0001#3 = #dsaw0016#2;
   #dsat0001#4 = #dsaw0016#0;
   |LEE 041#dsat0001.=;
   |SI FSalida = 0;
       |MENAV "0000Registro YA informado";
       |CIERRA #dsat0001;
       |ERROR;
       |ACABA;
   |FINSI;
||  |CIERRA #dsat0001;

   |ABRE #dsam0024;
   #dsam0024#0 = #dsaw0016#0;
   #dsam0024#1 = #dsaw0016#1;
   #dsam0024#2 = #dsaw0016#2;
   |LEE 041#dsam0024.=;
   |SI FSalida = 0;
       |MENAV "0000Registro YA informado";
       |CIERRA #dsam0024;
       |ERROR;
       |ACABA;
   |FINSI;

   #dsam0024#0 = #dsaw0016#0;
   #dsam0024#1 = #dsaw0016#1;
   #dsam0024#2 = #dsaw0016#2;
   |LEE 041#dsam0024.];
   |SI FSalida = 0;
       |LEE 041#dsam0024.a;
   |SINO;
       |LEE 041#dsam0024.u;
   |FINSI;
   |SI FSalida = 0; |Y #dsam0024#0 = #dsaw0016#0;
       |SI #dsam0024#3 ! #dsaw0016#3;
           |MENAV "0000Esta Empresa tenia asignada otra Emp. de Proteccion Datos";
           |CONFI "0000NContinuar";
           |SI FSalida ! 0;
               |CIERRA #dsam0024;
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;
       #dsaw0016#5 = #dsam0024#5;
       #dsaw0016#6 = #dsam0024#6;
       #dsaw0016#7 = #dsam0024#7;
       #dsaw0016#8 = #dsam0024#8;
       #dsaw0016#9 = #dsam0024#9;
       |PINDA #0#dsaw0016;
   |FINSI;

   |CIERRA #dsam0024;
|FPRC;

|PROCESO LaComision16;
   #dsaw0016#15 = ( #dsaw0016#10 % #dsaw0016#11) ! 2;
   #dsaw0016#16 = ( #dsaw0016#10 % #dsaw0016#12) ! 2;
|FPRC;
