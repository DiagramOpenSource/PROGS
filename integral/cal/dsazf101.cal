|FICHEROS;
     dsazf101;
     dsatf101,MANTE;
     dsaw0002,MANTE;

     dsam9998;
     :integral/dsam0000;
|FIN;

|VARIABLES;
     nBotonMen1   = 0;
     nBotonMen2   = 0;
     nBotonMen3   = 0;
     nBotonMen4   = 0;
     nBotonMen5   = 0;
     nBotonMen6   = 0;
     nBotonMen7   = 0;
     nBotonMen8   = 0;
     nBotonMen9   = 0;
     nBotonMen10  = 0;
     nBotonMen11  = 0;
     nBotonMen12  = 0;

     aEsc         = "";
     aF2          = "";
     aF3          = "";
     aF4          = "";
     aF5          = "";
     aF6          = "";
     aF7          = "";
     aF8          = "";
     aF9          = "";
     aF10         = "";
     aF11         = "";

     nOkGes = 0;
     nOkSeg = 0;
     nOkCol = 0;

     aMenuF10_1 = "LBOTON,A.- Proteccion de datos";
     aMenuF10_2 = "LBOTON,B.- Prevencion de riesgos laborales";
     aMenuF10_3 = "LBOTON,C.- Blanqueo de capitales";
     aMenuF10_4 = "LBOTON,D.- Compliance";
     aMenuF10_5 = "LBOTON,E.- Auditorias";
     aMenuF10_6 = "LBOTON,F.- Formacion";
     aMenuF10_7 = "LBOTON,G.- Juridico";
     aMenuF10_8 = "LBOTON,H.- Salir";

     aMenuF9_1  = "LBOTON,A.- Convenios";
     aMenuF9_2  = "LBOTON,B.- Viviendas";
     aMenuF9_3  = "LBOTON,C.- Vehiculos";
     aMenuF9_4  = "LBOTON,D.- Hogar";
     aMenuF9_5  = "LBOTON,E.- Vida riesgo";
     aMenuF9_6  = "LBOTON,F.- Decesos";
     aMenuF9_7  = "LBOTON,G.- Accidentes";
     aMenuF9_8  = "LBOTON,H.- Comunidad";
     aMenuF9_9  = "LBOTON,I.- Salud";
     aMenuF9_10 = "LBOTON,J.- Vida ahorro";
     aMenuF9_11 = "LBOTON,K.- Comercio";
     aMenuF9_12 = "LBOTON,L.- Salir";

     aLen         = "";
     aCaracter    = "";
     nLen         = 0;
     nPos         = 0;
     nOpcion      = 0;
     aAlfa        = "";
     nCampo       = 0;
     aTecla       = "";
     aCadena      = "";
     aFichero     = "";

     aTitul       = "";
     nAlgun       = 0;
     nTecla       = 0;
     nGraba       = 0;
     aParam       = "";
     nCamFun      = 0;

     &enCamF10   = 0;
     &enCamF9    = 0;
     &enEjer     = 0;
     &enEmpresa  = 0;
     &enDCliente = 0;
     &enHCliente = 0;
     &enDAgente  = 0;
     &enHAgente  = 0;
     &enModo     = 0;
     &enAlguno   = 0;
|FIN;

|CALCULO Tipo7; |TIPO 7;
     aParam = PARAMETRO; |QBF aParam;

     aAlfa = "Consulta Colaboraciones";
     |SI aParam = "F9";
         aAlfa = "Consulta Seguros";
     |FINSI;

     |ATRI R;
     |PINTA 0503, aAlfa;
     |ATRI 0;

     |SI aParam = "F10"; |Y nOkCol = 0;
         |MENAV "0000No Contratado colaboraciones";
         |PTEC 807;
     |FINSI;
     |SI aParam = "F9"; |Y nOkSeg = 0;
         |MENAV "0000No Contratado Seguros";
         |PTEC 807;
     |FINSI;
|FCAL;

|PROCESO QuitaRaros;
     |QBF aAlfa;
     aCadena = "";
     aLen    = aAlfa % 0;
     nLen    = aLen;
     |PARA nCampo = 1;  |SI nCampo [ nLen;  |HACIENDO nCampo = nCampo + 1;
           nPos = (100 * nCampo) + 1;
           aCaracter = aAlfa % nPos;
           |SI aCaracter = "¥";  aCaracter = &209; |FINSI;
           |SI aCaracter = "¤";  aCaracter = &241; |FINSI;
           |SI aCaracter = " ";  aCaracter = &225; |FINSI;
           |SI aCaracter = "‚";  aCaracter = &233; |FINSI;
           |SI aCaracter = "¡";  aCaracter = &237; |FINSI;
           |SI aCaracter = "¢";  aCaracter = &243; |FINSI;
           |SI aCaracter = "£";  aCaracter = &250; |FINSI;
           |SI aCaracter = "§";  aCaracter = &176; |FINSI;
           |SI aCaracter = "¦";  aCaracter = &170; |FINSI;
           aCadena = aCadena + aCaracter;
     |SIGUE;
     aAlfa = aCadena;
|FPRC;

|PROCESO PintaTitulo;
     |ATRI I;  |PINTA 0934, aTitul;  |ATRI i;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F9 -----------------------
|PROCESO ApareceOpcionF9;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
     |ESTADO_CONTROL nBotonMen9,  "SHOW";
     |ESTADO_CONTROL nBotonMen10, "SHOW";
     |ESTADO_CONTROL nBotonMen11, "SHOW";
     |ESTADO_CONTROL nBotonMen12, "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF9;
     |PUSHV 0501 2380;
     |BLANCO 0701 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
     |ESTADO_CONTROL nBotonMen9,  "HIDE";
     |ESTADO_CONTROL nBotonMen10, "HIDE";
     |ESTADO_CONTROL nBotonMen11, "HIDE";
     |ESTADO_CONTROL nBotonMen12, "HIDE";
|FPRC;

|PROCESO FinOpcionF9;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;
     |FIN_CONTROL_WINDOWS nBotonMen9;
     |FIN_CONTROL_WINDOWS nBotonMen10;
     |FIN_CONTROL_WINDOWS nBotonMen11;
     |FIN_CONTROL_WINDOWS nBotonMen12;

     |PULSATECLA;
|FPRC;

|| -------------------------- RUTINAS DE LA OPCION F10 -----------------------
|| Opcion F10 -----------------------------------------------------

|PROCESO ApareceOpcionF10;
     |POPV;
     |ESTADO_CONTROL nBotonMen1,  "SHOW";
     |ESTADO_CONTROL nBotonMen2,  "SHOW";
     |ESTADO_CONTROL nBotonMen3,  "SHOW";
     |ESTADO_CONTROL nBotonMen4,  "SHOW";
     |ESTADO_CONTROL nBotonMen5,  "SHOW";
     |ESTADO_CONTROL nBotonMen6,  "SHOW";
     |ESTADO_CONTROL nBotonMen7,  "SHOW";
     |ESTADO_CONTROL nBotonMen8,  "SHOW";
|FPRC;

|PROCESO DesapareceOpcionF10;
     |PUSHV 0501 2380;
     |BLANCO 0901 2380;
     |ESTADO_CONTROL nBotonMen1,  "HIDE";
     |ESTADO_CONTROL nBotonMen2,  "HIDE";
     |ESTADO_CONTROL nBotonMen3,  "HIDE";
     |ESTADO_CONTROL nBotonMen4,  "HIDE";
     |ESTADO_CONTROL nBotonMen5,  "HIDE";
     |ESTADO_CONTROL nBotonMen6,  "HIDE";
     |ESTADO_CONTROL nBotonMen7,  "HIDE";
     |ESTADO_CONTROL nBotonMen8,  "HIDE";
|FPRC;

|PROCESO FinOpcionF10;
     |FIN_CONTROL_WINDOWS nBotonMen1;
     |FIN_CONTROL_WINDOWS nBotonMen2;
     |FIN_CONTROL_WINDOWS nBotonMen3;
     |FIN_CONTROL_WINDOWS nBotonMen4;
     |FIN_CONTROL_WINDOWS nBotonMen5;
     |FIN_CONTROL_WINDOWS nBotonMen6;
     |FIN_CONTROL_WINDOWS nBotonMen7;
     |FIN_CONTROL_WINDOWS nBotonMen8;

     |PULSATECLA;
|FPRC;

|| --------------------------------------------------------------------
|PROCESO TrataColaboraciones;
     enModo = 2;
     |HAZ LeeCliente;

     |PUSHV 0501 0880;
     |BLANCO 0501 0880;
     |PINTA 0502, #dsam0000#0;
     |PINTA 0509, #dsam0000#3;
     |PINTA 0522, #dsam0000#1;
     |PINTA 0563, #dsam0000#54;
     |ATRI I;  |PINTA 0702, aTitul;  |ATRI i;

     |PINTA 0920,#dsaw0002#0;
     |ENCAMPO #0#dsaw0002;

     |SI #dsam0000#enCamF10# ! #dsaw0002#0;
         |HAZ GrabaCliente;
     |FINSI;

     |POPV;
|FPRC;

|PROCESO TrataSeguros;
     enModo = 2;
     |HAZ LeeCliente;

     |PUSHV 0501 0880;
     |BLANCO 0501 0880;
     |PINTA 0502, #dsam0000#0;
     |PINTA 0509, #dsam0000#3;
     |PINTA 0522, #dsam0000#1;
     |PINTA 0563, #dsam0000#54;
     |ATRI I;  |PINTA 0702, aTitul;  |ATRI i;

     |PINTA 0920,#dsaw0002#0;
     |ENCAMPO #0#dsaw0002;

     |SI #dsam0000#enCamF9# ! #dsaw0002#0;
         |HAZ GrabaCliente;
     |FINSI;

     |POPV;
|FPRC;


|| /////////////////////////////////////////////////////////////////////
|PROCESO LeeCliente;
    |ABRE #dsam0000;
    |DDEFECTO #dsam0000;
    #dsam0000#0 = enEmpresa;
    |LEE 041#dsam0000.=;
    |CIERRA #dsam0000;
|FPRC;

|PROCESO GrabaCliente;
    |ABRE #dsam0000;
    |DDEFECTO #dsam0000;
    #dsam0000#0 = enEmpresa;
    |LEE 141#dsam0000.=;
    |SI FSalida = 0;
        #dsam0000#nCamFun# = #dsaw0002#0;
        |GRABA 020#dsam0000.a;
    |FINSI;
    |LIBERA #dsam0000;
    |CIERRA #dsam0000;
|FPRC;

|PROCESO Tipo7tf101; |TIPO 7;
     enEmpresa   = #dsatf101#0;
     #dsaw0002#0 = #dsatf101#7;
     |HAZ LeeCliente;
     |PINPA #0#dsaw0002;
     |PINDA #0#dsaw0002;

     |HAZ Tipo7w0002;
     |BLIN 4;

     aAlfa= "0000Pulse <F2> para modificar datos";
     |MENSA aAlfa;
     |HAZ PintaTitulo;
|FPRC;

|PROCESO Tipo11tf101; |TIPO 11;
     nTecla = FSalida;

     |SI nTecla = 10;
         |LEE 141#dsatf101.=;

         enEmpresa   = #dsatf101#0;
         #dsaw0002#0 = #dsatf101#7;
         |SI aParam = "F9";  |HAZ TrataSeguros;        |FINSI;
         |SI aParam = "F10"; |HAZ TrataColaboraciones; |FINSI;

         #dsatf101#7 = #dsaw0002#0;
         |GRABA 020#dsatf101.a;
         |LIBERA #dsatf101;
     |FINSI;
|FPRC;
|| /////////////////////////////////////////////////////////////////////

|PROCESO GrabaAuxiliar;
  #dsatf101#0 = #dsam0000#0;
  #dsatf101#1 = #dsam0000#1;
  #dsatf101#2 = #dsam0000#3;
  #dsatf101#3 = #dsam0000#54;
  #dsatf101#4 = #dsam0000#52;
  #dsatf101#5 = #dsam0000#72;
  #dsatf101#6 = nCamFun;
  #dsatf101#7 = #dsam0000#nCamFun#;
  |GRABA 020#dsatf101.n;
  nAlgun = 1;
|FPRC;

|PROCESO LeoDsam0000;
   nGraba = 0;
   |SI #dsam0000#nCamFun# = "S";
       nGraba = 1;
   |SINO;
       |HAZ MiraSiHay;
       |SI enAlguno = 1; nGraba = 1; |FINSI;
   |FINSI;

   |SI nGraba = 1; |HAZ GrabaAuxiliar;  |FINSI;
|FPRC;

|DEFBUCLE dsam0000;
   #dsam0000#1;
   72;
   enDCliente, enDAgente;
   enHCliente, enHAgente;
   e;
   NULL, LeoDsam0000;
|FIN;

|PROCESO ClaveBajaf101;
   #dsatf101#0 = enDCliente;
|FPRC;

|PROCESO ClaveAltaf101;
   #dsatf101#0 = enHCliente;
|FPRC;

|PROCESO ConstruyeFichero;
     aFichero = ("1z" + Usuario) % 108;
     |NOME_DAT #dsatf101#aFichero#;
     |DELINDEX #dsatf101;

     aAlfa  = aAlfa % 0880;
     aTitul = (aAlfa + (" " * 79)) % 135;

     |SI aParam = "F9";  nCamFun = enCamF9;  |FINSI;
     |SI aParam = "F10"; nCamFun = enCamF10; |FINSI;

     nAlgun = 0;
     |ABRE #dsatf101;
     |BUCLE dsam0000;
     |CIERRA #dsatf101;

     |SI nAlgun ! 0;
         |PINPA #0#dsatf101;
         |ENTLINEAL #1#dsatf101, -1, 4, 8, 0, ClaveBajaf101, ClaveAltaf101;
     |FINSI;
     |DELINDEX #dsatf101;
|FPRC;

|PROCESO MenuF10_1;
     |SI #dsam9998#17 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#17 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     aAlfa = aMenuF10_1;
     enCamF10 = 121; |HAZ ConstruyeFichero; enCamF10 = 0;

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_2;
     |SI #dsam9998#18 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#18 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     aAlfa = aMenuF10_2;
     enCamF10 = 122; |HAZ ConstruyeFichero; enCamF10 = 0;

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_3;
     |SI #dsam9998#19 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#19 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_4;
     |SI #dsam9998#20 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#20 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_5;
     |SI #dsam9998#21 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#21 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_6;
     |SI #dsam9998#22 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#22 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuF10_7;
     |SI #dsam9998#23 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#23 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF10;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF10;
|FPRC;

|PROCESO MenuSalir;
     |PTEC 806;
|FPRC;

|PROCESO OpcionF10;

     |ATRI N;
     |SI #dsam9998#17 ! "X";
         aAlfa = aMenuF10_1;  |HAZ QuitaRaros;  aMenuF10_1 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_1, 1110, 1173, MenuF10_1;
         nBotonMen1 = FSalida;
     |FINSI;

     |SI #dsam9998#18 ! "X";
         aAlfa = aMenuF10_2;  |HAZ QuitaRaros;  aMenuF10_2 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_2, 1210, 1273, MenuF10_2;
         nBotonMen2 = FSalida;
     |FINSI;

     |SI #dsam9998#19 ! "X";
         aAlfa = aMenuF10_3;  |HAZ QuitaRaros;  aMenuF10_3 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_3, 1310, 1373, MenuF10_3;
         nBotonMen3 = FSalida;
     |FINSI;

     |SI #dsam9998#20 ! "X";
         aAlfa = aMenuF10_4;  |HAZ QuitaRaros;  aMenuF10_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_4, 1410, 1473, MenuF10_4;
         nBotonMen4 = FSalida;
     |FINSI;

     |SI #dsam9998#21 ! "X";
         aAlfa = aMenuF10_5;  |HAZ QuitaRaros;  aMenuF10_5 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_5, 1510, 1573, MenuF10_5;
         nBotonMen5 = FSalida;
     |FINSI;

     |SI #dsam9998#22 ! "X";
         aAlfa = aMenuF10_6;  |HAZ QuitaRaros;  aMenuF10_6 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_6, 1610, 1673, MenuF10_6;
         nBotonMen6 = FSalida;
     |FINSI;

     |SI #dsam9998#23 ! "X";
         aAlfa = aMenuF10_7;  |HAZ QuitaRaros;  aMenuF10_7 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF10_7, 1710, 1773, MenuF10_7;
         nBotonMen7 = FSalida;
     |FINSI;

     aAlfa = aMenuF10_8;  |HAZ QuitaRaros;  aMenuF10_8 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF10_8, 1810, 1873, MenuSalir;
     nBotonMen8 = FSalida;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     aEsc   = &255 + "806";

     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuF10_1;      |FINSI;
         |SI aTecla = "B";  |HAZ MenuF10_2;      |FINSI;
         |SI aTecla = "C";  |HAZ MenuF10_3;      |FINSI;
         |SI aTecla = "D";  |HAZ MenuF10_4;      |FINSI;
         |SI aTecla = "E";  |HAZ MenuF10_5;      |FINSI;
         |SI aTecla = "F";  |HAZ MenuF10_6;      |FINSI;
         |SI aTecla = "G";  |HAZ MenuF10_7;      |FINSI;
         |SI aTecla = "H";  |SAL;                |FINSI;
     |SIGUE;

     |HAZ FinOpcionF10;
|FPRC;

|| ///////////////////// F9 - SEGUROS
|PROCESO MenuF9_1;

     |SI #dsam9998#6 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#6 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     aAlfa = aMenuF9_1;
     enCamF9 = 123; |HAZ ConstruyeFichero; enCamF9 = 0;

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_2;
     |SI #dsam9998#7 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#7 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_3;
     |SI #dsam9998#8 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#8 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_4;
     |SI #dsam9998#9 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#9 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_5;
     |SI #dsam9998#10 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#10 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_6;
     |SI #dsam9998#11 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#11 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_7;
     |SI #dsam9998#12 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#12 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_8;
     |SI #dsam9998#13 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#13 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_9;
     |SI #dsam9998#14 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#14 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_10;
     |SI #dsam9998#15 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#15 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO MenuF9_11;
     |SI #dsam9998#16 = "X";
         |ACABA;
     |FINSI;

     |SI #dsam9998#16 = "N";
         |MENAV "0000La opcion no esta ACTIVA, consulte con su administrador";
         |ACABA;
     |FINSI;

     |HAZ DesapareceOpcionF9;

     |MENAV "0000En construccion";

     |HAZ ApareceOpcionF9;
|FPRC;

|PROCESO OpcionF9;
     |ATRI N;

     |SI #dsam9998#6 ! "X";
         aAlfa = aMenuF9_1;  |HAZ QuitaRaros;  aMenuF9_1 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_1, 1010, 1073, MenuF9_1;
         nBotonMen1 = FSalida;
     |FINSI;

     |SI #dsam9998#7 ! "X";
         aAlfa = aMenuF9_2;  |HAZ QuitaRaros;  aMenuF9_2 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_2, 1110, 1173, MenuF9_2;
         nBotonMen2 = FSalida;
     |FINSI;

     |SI #dsam9998#8 ! "X";
         aAlfa = aMenuF9_3;  |HAZ QuitaRaros;  aMenuF9_3 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_3, 1210, 1273, MenuF9_3;
         nBotonMen3 = FSalida;
     |FINSI;

     |SI #dsam9998#9 ! "X";
         aAlfa = aMenuF9_4;  |HAZ QuitaRaros;  aMenuF9_4 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_4, 1310, 1373, MenuF9_4;
         nBotonMen4 = FSalida;
     |FINSI;

     |SI #dsam9998#10 ! "X";
         aAlfa = aMenuF9_5;  |HAZ QuitaRaros;  aMenuF9_5 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_5, 1410, 1473, MenuF9_5;
         nBotonMen5 = FSalida;
     |FINSI;

     |SI #dsam9998#11 ! "X";
         aAlfa = aMenuF9_6;  |HAZ QuitaRaros;  aMenuF9_6 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_6, 1510, 1573, MenuF9_7;
         nBotonMen6 = FSalida;
     |FINSI;

     |SI #dsam9998#12 ! "X";
         aAlfa = aMenuF9_7;  |HAZ QuitaRaros;  aMenuF9_7 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_7, 1610, 1673, MenuF9_7;
         nBotonMen7 = FSalida;
     |FINSI;

     |SI #dsam9998#13 ! "X";
         aAlfa = aMenuF9_8;  |HAZ QuitaRaros;  aMenuF9_8 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_8, 1710, 1773, MenuF9_8;
         nBotonMen8 = FSalida;
     |FINSI;

     |SI #dsam9998#14 ! "X";
         aAlfa = aMenuF9_9;  |HAZ QuitaRaros;  aMenuF9_9 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_9, 1810, 1873, MenuF9_9;
         nBotonMen9 = FSalida;
     |FINSI;

     |SI #dsam9998#15 ! "X";
         aAlfa = aMenuF9_10; |HAZ QuitaRaros;  aMenuF9_10 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_10, 1910, 1973, MenuF9_10;
         nBotonMen10 = FSalida;
     |FINSI;

     |SI #dsam9998#16 ! "X";
         aAlfa = aMenuF9_11; |HAZ QuitaRaros;  aMenuF9_11 = aAlfa;
         |CONTROL_SIMPLE 0, aMenuF9_11, 2010, 2073, MenuF9_11;
         nBotonMen11 = FSalida;
     |FINSI;

     aAlfa = aMenuF9_12;  |HAZ QuitaRaros;  aMenuF9_12 = aAlfa;
     |CONTROL_SIMPLE 0, aMenuF9_12, 2110, 2173, MenuSalir;
     nBotonMen12 = FSalida;

     aF2    = &255 + "824";
     aF3    = &255 + "825";
     aF4    = &255 + "826";
     aF5    = &255 + "827";
     aF6    = &255 + "828";
     aF7    = &255 + "829";
     aF8    = &255 + "830";
     aF9    = &255 + "831";
     aF10   = &255 + "832";
     aEsc   = &255 + "806";

     |PARA; |SI;  |HACIENDO;
         |LEETECLA aTecla;
         |SI aTecla = aEsc; |SAL;  |FINSI;
         |SI aTecla = aF2;  nOpcion = 1;  |SAL;  |FINSI;
         |SI aTecla = aF3;  nOpcion = 2;  |SAL;  |FINSI;
         |SI aTecla = aF4;  nOpcion = 3;  |SAL;  |FINSI;
         |SI aTecla = aF5;  nOpcion = 4;  |SAL;  |FINSI;
         |SI aTecla = aF6;  nOpcion = 5;  |SAL;  |FINSI;
         |SI aTecla = aF7;  nOpcion = 6;  |SAL;  |FINSI;
         |SI aTecla = aF8;  nOpcion = 7;  |SAL;  |FINSI;
         |SI aTecla = aF9;  nOpcion = 8;  |SAL;  |FINSI;
         |SI aTecla = aF10; nOpcion = 9;  |SAL;  |FINSI;

         aTecla = aTecla > aTecla;
         |SI aTecla = "A";  |HAZ MenuF9_1;       |FINSI;
         |SI aTecla = "B";  |HAZ MenuF9_2;       |FINSI;
         |SI aTecla = "C";  |HAZ MenuF9_3;       |FINSI;
         |SI aTecla = "D";  |HAZ MenuF9_4;       |FINSI;
         |SI aTecla = "E";  |HAZ MenuF9_5;       |FINSI;
         |SI aTecla = "F";  |HAZ MenuF9_6;       |FINSI;
         |SI aTecla = "G";  |HAZ MenuF9_7;       |FINSI;
         |SI aTecla = "H";  |HAZ MenuF9_8;       |FINSI;
         |SI aTecla = "I";  |HAZ MenuF9_9;       |FINSI;
         |SI aTecla = "J";  |HAZ MenuF9_10;      |FINSI;
         |SI aTecla = "K";  |HAZ MenuF9_11;      |FINSI;
         |SI aTecla = "L";  |SAL;                |FINSI;
     |SIGUE;
     |HAZ FinOpcionF9;
|FPRC;

|PROCESO Tipo12; |TIPO 3;
     |SI FSalida = 1; |O FSalida = 7; |ACABA; |FINSI;

     enDCliente = #dsazf101#0;
     enHCliente = #dsazf101#1;
     enDAgente  = #dsazf101#2;
     enHAgente  = #dsazf101#3;

     aParam = PARAMETRO; |QBF aParam;
     |SI aParam = ""; aParam = "F10"; |FINSI;

     |SI aParam = "F9";  |HAZ OpcionF9;  |FINSI;
     |SI aParam = "F10"; |HAZ OpcionF10; |FINSI;
|FPRC;

|PROCESO Tipo8; |TIPO 8;
     |ABRE #dsam9998;
     |LEE 000#dsam9998.p;
     |SI FSalida ! 0;  |DDEFECTO #dsam9998;  |FINSI;
     |CIERRA #dsam9998;

     nOkGes = 0;
     |SI #dsam9998#2  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#3  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#4  ! "X";  nOkGes = 1;  |FINSI;
     |SI #dsam9998#5  ! "X";  nOkGes = 1;  |FINSI;

     nOkSeg = 0;
     |SI #dsam9998#6  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#7  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#8  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#9  ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#10 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#11 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#12 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#13 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#14 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#15 ! "X";  nOkSeg = 1;  |FINSI;
     |SI #dsam9998#16 ! "X";  nOkSeg = 1;  |FINSI;

     nOkCol = 0;
     |SI #dsam9998#17 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#18 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#19 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#20 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#21 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#22 ! "X";  nOkCol = 1;  |FINSI;
     |SI #dsam9998#23 ! "X";  nOkCol = 1;  |FINSI;
|FPRC;
