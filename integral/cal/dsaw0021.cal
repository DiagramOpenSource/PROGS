|FICHEROS;
     dsam0054 #54;
     dsaw0021 #99,MANTE;
|FIN;

|VARIABLES;
     aExtension        = "";

     &enFSalida        = 0;
     &enCodUbica       = 0;
     &enTipoDocumento  = 0;
     &eaRutaDocumento  = "";
     &eaNombrePrograma = "";
     &eaNombreRuta     = "";
     &eaRutaPlanilla   = "";
     &eaExtension      = "";
     &eaFicheroEdita   = "";
|FIN;

|PROCESO EsImagen;
     enCodUbica = #99#0;   |HAZ LeeUbicaciones;
     |ATRI R;
     |SI enTipoDocumento = 4;
         |PINTA 1627, "-1- Escanear una Imagen nueva                        ";
     |SINO;
         |PINTA 1627, "-1- Desde una Planilla                               ";
     |FINSI;
     |ATRI r;
|FPRC;

|PROCESO NoEntres;
     enCodUbica = #99#0;   |HAZ LeeUbicaciones;

     |C_M #99#3, 1, "S";
     |C_M #99#4, 1, "S";
     |SI #99#2 = 1;
         |C_M #99#3, 1, "N";
         #99#4 = 0;                 |PINTA #99#4;
         #99#5 = "PLANILLAS";       |PINTA #99#5;
         #99#6 = eaRutaPlanilla;   |PINTA #99#6;
     |FINSI;

     |SI #99#2 = 2;
         #99#4 = #99#0;   |PINTA #99#4;
         #99#5 = #99#1;   |PINTA #99#5;
     |FINSI;

     |SI enTipoDocumento = 4;  |Y #99#2 = 1;
         |C_M #99#3, 1, "N";
         |C_M #99#4, 1, "N";
         #99#4 = 0;  |PINTA #99#4;
         #99#5 = ""; |PINTA #99#5;
     |FINSI;

     |SI #54#0 = 0;  |Y #99#2 = 3;
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #99#2 = 3;
         |C_M #99#4, 1, "N";
     |FINSI;
|FPRC;

|PROCESO ChequeaTipo;
     |SI #99#4 = 0;  |ACABA;  |FINSI;

     enCodUbica   = #99#0;   |HAZ LeeUbicaciones;
     aExtension   = eaExtension;

     enCodUbica = #99#4;   |HAZ LeeUbicaciones;

     |SI aExtension ! eaExtension;
         |MENAV "     El tipo del documento a buscar no coincide con el seleccionado.";
         |ERROR;
         |ACABA;
     |FINSI;

     |SI #99#4 ! 0;
         #99#5 = eaNombreRuta;     |PINTA #99#5;
         #99#6 = eaRutaDocumento;  |PINTA #99#6;
     |FINSI;
|FPRC;
