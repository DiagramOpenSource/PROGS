|FICHEROS;
   dsam0000;
   dsaw0002,MANTE;
   dsam0023,MANTE;
   dsam0024,MANTE;
   dsam0025,MANTE;
|FIN;

|VARIABLES;
   nInkey     = 0;
   aAlfa      = "";
   aAlfa1     = "";
   fFecha     = @;
   nAny       = 0;
   nModo      = 0;

   &enEmpresa = 0;
   &enCamF10  = 0;
   &enCamF9   = 0;
   &enModo    = 0;
   &eaObCalcul = "";
   &eaNomEmpresa = "";
   &enAgeEmpresa = 0;
   &eaAgeEmpresa = "";
   &eaTelEmpresa = "";
   &enAlguno   = 0;
|FIN;

|PROCESO ClaveBaja25;
   #dsam0025#0 = #dsam0000#0;
   #dsam0025#1 = 2000;
   #dsam0025#2 = 001;
|FPRC;

|PROCESO ClaveAlta25;
   #dsam0025#0 = #dsam0000#0;
   #dsam0025#1 = 2099;
   #dsam0025#2 = 999;
|FPRC;

|PROCESO ClaveBaja24;
   #dsam0024#0 = #dsam0000#0;
   #dsam0024#1 = 2000;
   #dsam0024#2 = 01;
|FPRC;

|PROCESO ClaveAlta24;
   #dsam0024#0 = #dsam0000#0;
   #dsam0024#1 = 2099;
   #dsam0024#2 = 12;
|FPRC;

|PROCESO ClaveBaja23;
   #dsam0023#0 = #dsam0000#0;
   #dsam0023#1 = 2000;
   #dsam0023#2 = 01;
|FPRC;

|PROCESO ClaveAlta23;
   #dsam0023#0 = #dsam0000#0;
   #dsam0023#1 = 2099;
   #dsam0023#2 = 12;
|FPRC;

|PROCESO Borrarm0025;
   |BORRA 020#dsam0025.a;
   |LIBERA #dsam0025;
|FPRC;

|DEFBUCLE Borrarm0025;
   #dsam0025#1;
   ;
   #dsam0000#0, 2000, 001;
   #dsam0000#0, 2099, 999;
   be;
   NULL, Borrarm0025;
|FIN;

|PROCESO Borrarm0024;
   |BORRA 020#dsam0024.a;
   |LIBERA #dsam0024;
|FPRC;

|DEFBUCLE Borrarm0024;
   #dsam0024#1;
   ;
   #dsam0000#0, 2000, 01;
   #dsam0000#0, 2099, 12;
   be;
   NULL, Borrarm0024;
|FIN;

|PROCESO Borrarm0023;
   |BORRA 020#dsam0023.a;
   |LIBERA #dsam0023;
|FPRC;

|DEFBUCLE Borrarm0023;
   #dsam0023#1;
   ;
   #dsam0000#0, 2000, 01;
   #dsam0000#0, 2099, 12;
   be;
   NULL, Borrarm0023;
|FIN;

|PROCESO BorroColaboracion;
  |SI enCamF10 = 121;  |BUCLE Borrarm0023;  |FINSI;
  |SI enCamF10 = 122;  |BUCLE Borrarm0024;  |FINSI;
  |SI enCamF9  = 123;  |BUCLE Borrarm0025;  |FINSI;
|FPRC;

|PROCESO MiraSiHay;
     enAlguno = 0;
     |SI enCamF10 = 121;
        |ABRE #dsam0023;
        #dsam0023#0 = #dsam0000#0;
        #dsam0023#1 = 2000;
        #dsam0023#2 = 01;
        |LEE 041#dsam0023.];
        |SI FSalida = 0; |Y #dsam0023#0 = #dsam0000#0;
            enAlguno = 1;
        |FINSI;
        |CIERRA #dsam0023;
     |FINSI;

     |SI enCamF10 = 122;
        |ABRE #dsam0024;
        #dsam0024#0 = #dsam0000#0;
        #dsam0024#1 = 2000;
        #dsam0024#2 = 01;
        |LEE 041#dsam0024.];
        |SI FSalida = 0; |Y #dsam0024#0 = #dsam0000#0;
            enAlguno = 1;
        |FINSI;
        |CIERRA #dsam0024;
     |FINSI;

     |SI enCamF9 = 123;
        |ABRE #dsam0025;
        #dsam0025#0 = #dsam0000#0;
        #dsam0025#1 = 2000;
        #dsam0025#2 = 001;
        |LEE 041#dsam0025.];
        |SI FSalida = 0; |Y #dsam0025#0 = #dsam0000#0;
            enAlguno = 1;
        |FINSI;
        |CIERRA #dsam0025;
     |FINSI;
|FPRC;

|PROCESO Tipo7w0002; |TIPO 7;
    |SI enCamF10 = 121;
        |PINPA #0#dsam0023;
        |PINTA #dsaw0002#0;
        |ENTLINEAL #1#dsam0023, -3, 7, 22, 0, ClaveBaja23, ClaveAlta23;
    |FINSI;

    |SI enCamF10 = 122;
        |PINPA #0#dsam0024;
        |PINTA #dsaw0002#0;
        |ENTLINEAL #1#dsam0024, -3, 7, 22, 0, ClaveBaja24, ClaveAlta24;
    |FINSI;

    |SI enCamF9  = 123;
        |PINPA #0#dsam0025;
        |PINTA #dsaw0002#0;
        |ENTLINEAL #1#dsam0025, -3, 7, 22, 0, ClaveBaja25, ClaveAlta25;
    |FINSI;

    |HAZ MiraSiHay;
    |SI enAlguno = 1;
        |SI enCamF10 = 121;  |PINDA #0#dsam0023; |FINSI;
        |SI enCamF10 = 122;  |PINDA #0#dsam0024; |FINSI;
        |SI enCamF9  = 123;  |PINDA #0#dsam0025; |FINSI;
    |FINSI;

    aAlfa = "0000Pulse <F8> para Borrar los datos introducidos y Obligado igual a <N>";
    |SI enCamF10 = 122; |O enCamF9 = 123;
        aAlfa = "0000<F8> Borrar datos y Obligado = N; <F9> Calcular Obligado automatico";
    |FINSI;
    |SI enModo ! 4;
        |MENSA aAlfa;
    |FINSI;
|FPRC;

|PROCESO Tipo0w0002; |TIPO 0;
   |BLIN 4;
   aAlfa = Contenido;
   nInkey = FSalida;

   |SI enModo = 4;
       #dsaw0002#0 = aAlfa;
       |PINTA #dsaw0002#0;
       nInkey = 0;
   |FINSI;

   |SI nInkey = 17;
      |SI enCamF10 = 122; |O enCamF9  = 123;
          |CONFI "0000NDesea calcular la obligacion segun datos de nominas";
          |SI FSalida = 0;
              eaNomEmpresa = #dsam0000#1;
              enAgeEmpresa = #dsam0000#72;
              eaAgeEmpresa = #dsam0000#52;
              eaTelEmpresa = #dsam0000#54;

              |SI enCamF10 = 122;  aAlfa = ":integral/dsaz0032;Auto";  |FINSI;
              |SI enCamF9  = 123;  aAlfa = ":integral/dsaz0033;Auto";  |FINSI;
              |SUB_EJECUTA aAlfa;

              |SI eaObCalcul ! "";
                  aAlfa = ""; aAlfa1 = eaObCalcul % 101;
                  |SI eaObCalcul = "NO"; aAlfa = "NO "; |FINSI;
                  aAlfa = "0000"+ aAlfa1+ "Esta empresa " + aAlfa + "esta obligada. Actualizamos el campo";
                  FSalida = 0;
                  |SI eaObCalcul = "NO"; |O enCamF9 ! 123;
                      |CONFI aAlfa;
                  |FINSI;
                  |SI FSalida = 0;
                      #dsaw0002#0 = eaObCalcul; |PINTA #dsaw0002#0;
                  |FINSI;
              |FINSI;
          |FINSI;
      |FINSI;
      |SI enCamF9 ! 123;
          |ERROR;
          |ACABA;
      |FINSI;
   |FINSI;

   |SI nInkey = 16;
       |CONFI "0000NDesea poner No obligado y borrar todos los Datos";
       |SI FSalida = 0;
           #dsaw0002#0 = "N"; |PINTA #dsaw0002#0;
           |CONFI "0000NEsta seguro de continuar con el borrado";
           |SI FSalida = 0;
               |HAZ BorroColaboracion;
               |ACABA;
           |FINSI;
       |FINSI;
   |FINSI;

   |SI #dsaw0002#0 = "S";
       nModo = enModo;
   |SINO;
       nModo = 4;
   |FINSI;

   |SI nModo = 4;
       |HAZ MiraSiHay;
       |SI enAlguno = 0;   |ACABA;  |FINSI;
   |FINSI;

   |SI enCamF10 = 121;
       |PINTA #dsaw0002#0;
       |ENTLINEAL #1#dsam0023, -2, nModo, 22, 0, ClaveBaja23, ClaveAlta23;
   |FINSI;
   |SI enCamF10 = 122;
       |PINTA #dsaw0002#0;
       |ENTLINEAL #1#dsam0024, -2, nModo, 22, 0, ClaveBaja24, ClaveAlta24;
   |FINSI;
   |SI enCamF9  = 123;
       |PINTA #dsaw0002#0;
       |ENTLINEAL #1#dsam0025, -2, nModo, 22, 0, ClaveBaja25, ClaveAlta25;
   |FINSI;
|FPRC;

|PROCESO Tipo12w0002; |TIPO 12;
    || No pregunta
|FPRC;
