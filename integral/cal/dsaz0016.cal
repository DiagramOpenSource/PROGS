|FICHEROS;
     dsaz0016 #0;
     dsam0000 #1;
     dsam0012 #12,MANTE;
     dsam0105 #105;
|FIN;

|VARIABLES;
     aFichero   = "";
     aAlfa      = "";
     aAlfa1     = "";
     nSw        = 0;
     aPassword  = "";
|FIN;

|PROCESO Graba0;
 #0#0 = #1#0;
 #0#1 = #1#1;
 #0#2 = #1#72;
 #0#3 = #1#52;

 #0#4 = #1#65;
 #0#5 = #1#66;
 #0#6 = #1#67;
 #0#7 = #1#68;
 #0#8 = #1#69;
 |GRABA 040#0n;
|FPRC;

|DEFBUCLE dsam0000;
     #1#1;
     ;
     00001;
     99999;
     ;
     NULL, Graba0;
|FIN;


|PROCESO LeoAgente; |TIPO 6;
 |ABRE #105;
 #105#0 = #12Campo;
 |LEE 041#105=;
 |SI FSalida = 0;
     #12#3 = #105#2; |PINTA #12#3;
 |FINSI;
 |CIERRA #105;
|FPRC;

|PROCESO ElCampo4; |TIPO 0;
  #12#4 = "Fiscal";
  |SI #12#1 = 1; #12#4 = "Contabilidad"; |FINSI;
  |SI #12#1 = 3; #12#4 = "Sociedades  "; |FINSI;
  |SI #12#1 = 4; #12#4 = "Renta       "; |FINSI;
  |SI #12#1 = 5; #12#4 = "Laboral     "; |FINSI;
  |PINTA #12#4;
|FPRC;

|PROCESO ElArea; |TIPO 0;

  |HAZ ElCampo4;

  nSw = 0;
  |SI #12#1 = 1; |Y #0#4 = "N"; nSw = 1; |FINSI;
  |SI #12#1 = 2; |Y #0#5 = "N"; nSw = 1; |FINSI;
  |SI #12#1 = 3; |Y #0#6 = "N"; nSw = 1; |FINSI;
  |SI #12#1 = 4; |Y #0#7 = "N"; nSw = 1; |FINSI;
  |SI #12#1 = 5; |Y #0#8 = "N"; nSw = 1; |FINSI;
  |SI nSw = 1;
      |MENAV "    Error. Area No Contratada";
      |ERROR;
  |FINSI;
|FPRC;


|PROCESO ClaveBaja12;
 #12#0 = #0#0;
 #12#1 = 1;
|FPRC;

|PROCESO ClaveAlta12;
 #12#0 = #0#0;
 #12#1 = 5;
|FPRC;

|PROCESO Tipo7_0;  |TIPO 7;
     |ENTLINEAL #1#12, -2, 7, 20, 0, ClaveBaja12, ClaveAlta12;
|FPRC;

|PROCESO Tipo11_0;  |TIPO 11;
     |SI FSalida ! 10;  |ACABA;  |FINSI;

     |ENTLINEAL #1#12, -2, 2, 20, 0, ClaveBaja12, ClaveAlta12;
|FPRC;

|RUTINA ClaveBaja0;
     #0#0 = 00001;
|FRUT;

|RUTINA ClaveAlta0;
     #0#0 = 99999;
|FRUT;

|PROGRAMA;
      |CUADRO 0501 2380;
      |BLANCO 0602 2279;
      |PINTA 1320, "Introduzca Password : ";
      E_inf = "";
      E_sup = "20";
      aPassword = 1342 ? -1;
      |SI aPassword ! "<MYPASWD>     ";
          |MENAV "     Permiso denegado.";
          |ACABA;
      |FINSI;


      aFichero = ("16" + Usuario + "zzzzzzzz") % 108;
      |NOME_DAT #0 aFichero;

      |ABRE #0;  |CIERRA #0;  |DELINDEX #0;

      |PINPA #0#0;
      |MENSA "0000 Configurando Datos, Espere un Momento";

      |ABRE #0;
      |BUCLE dsam0000;
      |CIERRA #0;

      |BLIN 4;
      |ENTLINEAL #1#0, -1, 4, 21, 0, ClaveBaja0, ClaveAlta0;

      |DELINDEX #0;
|FPRO;
