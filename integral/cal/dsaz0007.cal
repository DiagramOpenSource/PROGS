|FICHEROS;
     dsaz0007               #0;
     dsam0000               #1;
     dsam0003               #3;
     dsam0004               #4;
     dsam0005               #5;
     dsam0009               #9;
     dsam0100               #100;
     dsam0103               #103;
     dsam0106               #106;
     dsam0107               #107;
     dsam0116               #116;

     :/basica/def/dspase00 #200;
     :/basica/def/dspase15 #215;
     :/basica/def/agidanif #216;
     :/basica/def/agitab10 #1110;
     :/basica/def/agitab14 #1111;
     :/basica/def/agitab12 #1112;
     :/basica/def/agiepim2 #1113;
     :/basica/def/agicen14 #1114;
     :/basica/def/agicen15 #1115;

     :/laboral/def/nomatcon #300;

    redatcon@ #902;
    rem00100@ #900;
    rem00101@ #901;
    labempre@ #903;
    nomatco1@ #904;
    nomatco2@ #905;
    eosdaban@ #906;
    eosm0029@ #907;
    canempre@ #908;
    caportad@ #909;
|FIN;

|VARIABLES;
     aBase        = "";
     aPassword    = "";
     aAlfa        = "";
     aAlfa1       = "";
     aAlfa2       = "";
     aAlfa3       = "";
     aAlfa4       = "";
     aRenta       = "";
     aRenFi       = "";
     aTPpal       = "";
     aTCont       = "";
     aTFax        = "";
     aTOtros      = "";
     aPathRenta   = "";
     aMasRenta    = "";
     aDef         = "";
     aFich        = "";
     aMas         = "";
     aPathLaboral = "";
     aParaQuitar  = "";
     aCaracter    = "";
     aCadena      = "";
     aCadena1     = "";
     aCadena2     = "";
     aCadena3     = "";
     aLongAlfa    = "";

     aPathAnterior    = "";
     aPathDefLaboral  = "";
     aPathFichLaboral = "";
     aPathDefFiscal   = "";
     aPathFichFiscal  = "";
     aPathDefAgicont  = "";
     aPathFichAgicont = "";
     aPath            = "";

     nHay         = 0;
     nLineaTel    = 0;
     nRenta       = 0;
     nCampo       = 0;
     nCampo1      = 0;
     nLinea       = 0;
     nContinua    = 0;
     nCodigoNue   = 0;
     nCodigoNom   = 0;
     nCodigoReo   = 0;
     nCodigoCon   = 0;
     nEstaCambio  = 0;
     nBorrar      = 0;
     nCampoD      = 0;
     nCampoH      = 0;
     nDEmpresa    = 0;
     nHEmpresa    = 0;
     nBlanco1     = 0;
     nBlanco2     = 0;
     nComa        = 0;
     nPara        = 0;
     nPosi        = 0;
     nLongNume    = 0;
     nPasaDatosCli = 0;

     fFecha       = @;
     &enAny       = 0;
     nAnyC        = 0;
     nActividad   = 0;
     nPara1       = 0;
     nNume1       = 0;
|FIN;

|PROCESO Tipo0C13;  |TIPO 0;
     |C_M #0#14, 1, "S";
     |SI #0#13 = "NO";
         #0#14 = 0;  |C_M #0#14, 1, "N";
     |FINSI;
     |PINTA #0#14;
|FPRC;

|PROCESO Defecto; |TIPO 7;
 fFecha = ~;
 aAlfa1 = fFecha;
 aAlfa1 = aAlfa1 % -104;
 #0#5 = aAlfa1; |PINTA #0#5;
|FPRC;

|PROCESO ElProc00; |TIPO 0;
     |SI #0#0 = "SI"; |C_M #0#11, 1, "S"; |FINSI;
     |SI #0#0 = "NO"; |C_M #0#11, 1, "N"; |FINSI;
|FPRC;

|PROCESO ElProc05; |TIPO 0;
 |SI #0#4 = "SI"; |C_M #0#5,1,"S"; |FINSI;
 |SI #0#4 = "NO"; |C_M #0#5,1,"N"; |FINSI;
|FPRC;

|PROCESO ElProc07; |TIPO 0;
 |SI #0#7 = "SI"; |C_M #0#8,1,"S"; |C_M #0#9, 1, "S";  |FINSI;
 |SI #0#7 = "NO"; |C_M #0#8,1,"N"; |C_M #0#9, 1, "N";  |FINSI;
|FPRC;

|PROCESO ElProc15; |TIPO 0;
 |SI #0#15 = "SI"; |C_M #0#16,1,"S"; |C_M #0#17, 1, "S"; |C_M #0#18, 1, "S"; |FINSI;
 |SI #0#15 = "NO"; |C_M #0#16,1,"N"; |C_M #0#17, 1, "N"; |C_M #0#18, 1, "N"; |FINSI;
|FPRC;

|PROCESO rem00101;
     #4#0 = #901#0;
     #4#1 = #901#1;
     |LEE 101#4=;
     |SI FSalida ! 0;
         |DDEFECTO #4;
         #4#0 = #901#0;
         #4#1 = #901#1;
         |GRABA 020#4b;
     |FINSI;

     #4#2  = #901#2;
     #4#3  = #901#3;
     #4#4  = #901#4;
     #4#5  = #901#5;
     #4#6  = #901#6;
     #4#7  = #901#7;
     #4#8  = #901#8;
     #4#9  = #901#9;
     #4#10 = #901#10;
     #4#11 = #901#11;
     #4#12 = #901#12;
     #4#13 = #901#13;
     #4#14 = #901#14;
     #4#15 = #901#15;
     #4#16 = #901#17;
     #4#17 = #901#18;
     #4#18 = #901#19;
     #4#19 = #901#20;
     #4#20 = #901#21;
     #4#21 = #901#22;
     |GRABA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE rem00101;
     #901#1002;
     ;
     #900#0, 01;
     #900#0, 99;
     ;
     NULL, rem00101;
|FIN;

|PROCESO dsam0004A;
     |BORRA 020#4a;
     |LIBERA #4;
|FPRC;

|DEFBUCLE dsam0004A;
     #4#1;
     ;
     #3#0, 01;
     #3#0, 99;
     be;
     NULL, dsam0004A;
|FIN;

|PROCESO rem00100;
     nPasaDatosCli = 0;

     #1#0 = #900#0;
     |LEE 000#1=;
     |SI FSalida ! 0;
         |DDEFECTO #1;
     |FINSI;

     aAlfa = #1#3 + #1#1;  |QBF aAlfa;
     |SI aAlfa = "";
         nPasaDatosCli = 1;
     |FINSI;

     #3#0 = #900#0;
     |LEE 101#3=;
     |SI FSalida = 0;
         |BORRA 020#3a;
     |FINSI;

     |DDEFECTO #3;
     |PARA nCampo = 0;  |SI nCampo [ 60;  |HACIENDO nCampo = nCampo + 1;
           #3nCampo = #900nCampo;
     |SIGUE;

     #3#61 = #900#88;
     #3#62 = #900#89;
     #3#63 = #900#93;
     #3#64 = #900#94;
     #3#65 = #900#95;
     #3#67 = #900#103;
     #3#68 = #900#104;
     #3#69 = #900#105;
     #3#70 = #900#106;

     |SI #0#11 ] 2006;  |O #0#11 = 0;
         |PARA nCampoD = 71;  |SI nCampoD [ 106;  |HACIENDO nCampoD = nCampoD + 1;
               nCampoH   = nCampoD + 38;
               #3nCampoD = #900nCampoH;
         |SIGUE;
     |FINSI;

     |GRABA 020#3n;
     |LIBERA #3;

     |BUCLE dsam0004A;
     |BUCLE rem00101;

     |SI nPasaDatosCli = 1;
         #1#0 = #900#0;
         |LEE 101#1=;
         |SI FSalida ! 0;
             |DDEFECTO #1;
             #1#0 = #900#0;
             |GRABA 020#1b;
         |FINSI;

         #1#1   = #900#5;
         #1#2   = #900#5;
         #1#3   = #900#1;
         #1#54  = #900#12;
         #1#55  = #900#13;
         #1#19  = #900#14;
         #1#20  = #900#15;
         #1#21  = #900#16;
         #1#22  = #900#17;
         #1#23  = #900#18;
         #1#24  = #900#19;
         #1#25  = #900#20;
         #1#26  = #900#21;
         #1#27  = #900#22;
         #1#29  = #900#14;
         #1#30  = #900#15;
         #1#31  = #900#16;
         #1#32  = #900#17;
         #1#33  = #900#18;
         #1#34  = #900#19;
         #1#35  = #900#20;
         #1#36  = #900#21;
         #1#37  = #900#22;
         #1#39  = #900#24;
         #1#40  = #900#25;
         #1#41  = #900#26;
         #1#42  = #900#27;
         #1#43  = #900#28;
         #1#44  = #900#29;
         #1#45  = #900#30;
         #1#46  = #900#31;
         #1#47  = #900#32;
         #1#49  = #900#34;
         #1#15  = #900#69;
         #1#16  = #900#70;
         #1#17  = #900#71;
         #1#18  = #900#72;
         #1#53  = #1#1;
         #1#100 = #900#2;
         #1#101 = #900#3;
         #1#102 = #900#4;
         #1#86  = #900#11;
         |SI #1#90 = "    ";
             aAlfa = #900#53 % 104;   #1#90  = aAlfa;
             aAlfa = #900#53 % 504;   #1#91  = aAlfa;
             aAlfa = #900#53 % 902;   #1#92  = aAlfa;
             aAlfa = #900#53 % 1110;  #1#93  = aAlfa;
         |FINSI;
         #1#68  = "S";

         aTPpal  = #1#54;   |QBT aTPpal;
         aTOtros = #1#55;   |QBT aTOtros;
         aTFax   = "";        |QBT aTFax;
         aTCont  = "";
         |HAZ GrabaTelefonos;
         |HAZ GrabaDirecciones;

         |GRABA 020#1a;
         |LIBERA #1;
    |FINSI;
|FPRC;

|DEFBUCLE rem00100;
     #900#1001;
     ;
     00000;
     99999;
     ;
     NULL, rem00100;
|FIN;

|PROCESO dsam0004;
     |SI #4#2 = "            ";  |ACABA;  |FINSI;

     #103#0 = #4#2;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0  = #4#2;
         #103#1  = #4#3;
         #103#2  = #3#15;
         #103#3  = #3#16;
         #103#4  = #3#20;
         #103#5  = #3#21;
         #103#6  = #3#22;
         #103#8  = #3#12;
         #103#9  = #3#14;
         #103#10 = #3#18;
         #103#11 = #3#19;
         #103#16 = #3#17;
         |GRABA 020#103n;
         |LIBERA #103;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0004;
     #4#1;
     ;
     #3#0, 01;
     #3#0, 99;
     ;
     NULL, dsam0004;
|FIN;

|PROCESO dsam0003;
     |SI #3#1 ! "            ";
         #103#0 = #3#1;
         |LEE 101#103=;
         |SI FSalida ! 0;
             |DDEFECTO #103;
             #103#0  = #3#1;
             #103#1  = #3#5;
             #103#2  = #3#15;
             #103#3  = #3#16;
             #103#4  = #3#20;
             #103#5  = #3#21;
             #103#6  = #3#22;
             #103#8  = #3#12;
             #103#9  = #3#14;
             #103#10 = #3#18;
             #103#11 = #3#19;
             #103#16 = #3#17;
             |GRABA 020#103n;
             |LIBERA #103;
         |FINSI;
     |FINSI;

     |SI #3#35 ! "            ";
         #103#0 = #3#35;
         |LEE 101#103=;
         |SI FSalida ! 0;
             |DDEFECTO #103;
             #103#0  = #3#35;
             #103#1  = #3#39;
             #103#2  = #3#45;
             #103#3  = #3#46;
             #103#4  = #3#50;
             #103#5  = #3#51;
             #103#6  = #3#52;
             #103#8  = #3#12;
             #103#9  = #3#44;
             #103#10 = #3#48;
             #103#11 = #3#49;
             #103#16 = #3#47;
             |GRABA 020#103n;
             |LIBERA #103;
         |FINSI;
     |FINSI;

     |BUCLE dsam0004;
|FPRC;

|DEFBUCLE dsam0003;
     #3#1;
     ;
     00000;
     99999;
     ;
     NULL, dsam0003;
|FIN;

|PROCESO GrabaLineaTelefono;
     |ABRE #107;

     #107#0 = #106#0;
     #107#1 = nLineaTel;
     |LEE 101#107=;
     |SI FSalida ! 0;
         |DDEFECTO #107;
          #107#0 = #106#0;
          #107#1 = nLineaTel;
          |GRABA 020#107b;
     |FINSI;

     #107#2 = aAlfa2;
     #107#4 = aAlfa4;
     |GRABA 020#107a;
     |LIBERA #107;

     |CIERRA #107;
|FPRC;

|PROCESO GrabaTelefonos;
     |ABRE #106;
     #106#0 = #1#1;
     |LEE 101#106=;
     |SI FSalida ! 0;
         #106#0 = #1#1;
         #106#1 = #1#27;
         #106#2 = #1#28;
         |GRABA 020#106n;
         |LIBERA #106;
     |FINSI;

     |SI aTPpal ! "";
         nLineaTel = 1;
         aAlfa2    = "TELEFONO PRINCIPAL";
         aAlfa4    = aTPpal;
         |HAZ GrabaLineaTelefono;

         nLineaTel = 1;
         aAlfa2    = "TELEFONO DE CONTACTO";
         aAlfa4    = aTPpal;
         |HAZ GrabaLineaTelefono;
     |FINSI;

     |SI aTCont ! "";
         nLineaTel = 2;
         aAlfa2    = "TELEFONO DE CONTACTO";
         aAlfa4    = aTCont;
         |HAZ GrabaLineaTelefono;
     |FINSI;

     |SI aTFax ! "";
         nLineaTel = 3;
         aAlfa2    = "TELEFONO FAX";
         aAlfa4    = aTFax;
         |HAZ GrabaLineaTelefono;
     |FINSI;

     |SI aTOtros ! "";
         nLineaTel = 4;
         aAlfa2    = "OTROS TELEFONOS " + aTOtros;
         aAlfa4    = "";
         |HAZ GrabaLineaTelefono;
     |FINSI;
     |CIERRA #106;
|FPRC;

\\__________ Creacion de Ficheros de Domicilios

|PROCESO GrabaDirecciones;
     |ABRE #5;

     #5#0  = #1#0;
     #5#1  = 98;
     |LEE 101#5=;
     |SI FSalida ! 0;
         |DDEFECTO #5;
         #5#0  = #1#0;
         #5#1  = 98;
         |GRABA 020#5b;
     |FINSI;

     #5#2  = "DOMICILIO FISCAL ";
     #5#3  = #1#29;
     #5#4  = #1#30;
     #5#5  = #1#31;
     #5#6  = #1#32;
     #5#7  = #1#33;
     #5#8  = #1#34;
     #5#9  = #1#35;
     #5#10 = #1#36;
     #5#11 = #1#37;
     #5#12 = #1#38;
     #5#15 = #1#86;
     #5#16 = #1#87;
     #5#17 = #1#98;
     #5#18 = #1#99;
     |GRABA 020#5a;
     |LIBERA #5;

     #5#0  = #1#0;
     #5#1  = 97;
     |LEE 101#5=;
     |SI FSalida ! 0;
         |DDEFECTO #5;
         #5#0  = #1#0;
         #5#1  = 97;
         |GRABA 020#5b;
     |FINSI;

     #5#2  = "DOMICILIO SOCIAL ";
     #5#3  = #1#19;
     #5#4  = #1#20;
     #5#5  = #1#21;
     #5#6  = #1#22;
     #5#7  = #1#23;
     #5#8  = #1#24;
     #5#9  = #1#25;
     #5#10 = #1#26;
     #5#11 = #1#27;
     #5#12 = #1#28;
     #5#15 = #1#86;
     #5#16 = #1#87;
     #5#17 = #1#98;
     #5#18 = #1#99;
     |GRABA 020#5a;
     |LIBERA #5;

     #5#0  = #1#0;
     #5#1  = 99;
     |LEE 101#5=;
     |SI FSalida ! 0;
         |DDEFECTO #5;
         #5#0  = #1#0;
         #5#1  = 99;
         |GRABA 020#5b;
     |FINSI;

     #5#2  = "DOMICILIO ENVIO ";
     #5#3  = #1#39;
     #5#4  = #1#40;
     #5#5  = #1#41;
     #5#6  = #1#42;
     #5#7  = #1#43;
     #5#8  = #1#44;
     #5#9  = #1#45;
     #5#10 = #1#46;
     #5#11 = #1#47;
     #5#12 = #1#48;
     #5#15 = #1#86;
     #5#16 = #1#87;
     #5#17 = #1#98;
     #5#18 = #1#99;
     |GRABA 020#5a;
     |LIBERA #5;

     |CIERRA #5;
|FPRC;

|PROCESO CargaDatosRenta;
     |ABRE #100;

     #1#19  = #902#6;
     #1#20  = #902#7;
     #1#21  = #902#8;
     #1#22  = #902#9;
     #1#23  = #902#10;
     #1#24  = #902#11;
     #1#25  = #902#12;
     #1#26  = #902#13;
     #1#27  = #902#14;

     #100#0 = #1#25;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     #1#28  = #100#1;

     #1#29  = #1#19;
     #1#30  = #1#20;
     #1#31  = #1#21;
     #1#32  = #1#22;
     #1#33  = #1#23;
     #1#34  = #1#24;
     #1#35  = #1#25;
     #1#36  = #1#26;
     #1#37  = #1#27;
     #1#38  = #1#28;

     #1#39  = #902#17;
     #1#40  = #902#18;
     #1#41  = #902#19;
     #1#42  = #902#20;
     #1#43  = #902#21;
     #1#44  = #902#22;
     #1#45  = #902#23;
     #1#46  = #902#24;
     #1#47  = #902#25;

     #100#0 = #1#45;
     |LEE 040#100=;
     |SI FSalida ! 0;  |DDEFECTO #100;  |FINSI;

     #1#48  = #100#1;

     #1#15  = #902#40;
     #1#16  = #902#41;
     #1#17  = #902#17;
     #1#18  = #902#18;
     #1#53  = #1#1;
     #1#54  = #902#15;
     #1#55  = #902#15;

     |SI nRenta ! 1994;
         #1#49  = #902#208;
         #1#100 = #902#210;
         #1#101 = #902#211;
         #1#102 = #902#212;
     |FINSI;

     aAlfa = #902#174 % 104;   #1#90  = aAlfa;
     aAlfa = #902#174 % 504;   #1#91  = aAlfa;
     aAlfa = #902#174 % 902;   #1#92  = aAlfa;
     aAlfa = #902#174 % 1110;  #1#93  = aAlfa;

     aTPpal  = #1#54;   |QBT aTPpal;
     aTOtros = #1#55;   |QBT aTOtros;
     aTFax   = "";        |QBT aTFax;
     aTCont  = "";
     |HAZ GrabaTelefonos;
     |HAZ GrabaDirecciones;

     |GRABA 020#1a;
     |LIBERA #1;
|FPRC;

|PROCESO dsam0000;
     aAlfa1 = #1#20;  |QBF aAlfa1;
     aAlfa2 = #1#30;  |QBF aAlfa2;
     aAlfa3 = #1#40;  |QBF aAlfa3;

     |SI aAlfa1 ! "";  |O aAlfa2 ! "";  |O aAlfa3 ! "";  |O #1#68 = "N";
         |ACABA;
     |FINSI;

     |DBASS aAlfa;  |QBF aAlfa;
     nHay   = 0;
     nRenta = 1998;
     aRenta = aAlfa + "ren1998/def/redatcon.mas";
     aRenFi = aAlfa + "ren1998/fich/";
     |CARGA_DEF aRenta, redatcon@;
     |SI FSalida = 0;
         |PATH_DAT #902 aRenFi;
         |ABRE #902;
         #902#0 = #1#0;
         |LEE 040#902=;
         |SI FSalida = 0;
             nHay = 1;
             |HAZ CargaDatosRenta;
         |FINSI;
         |CIERRA #902;
         |DESCARGA_DEF #redatcon@;
     |FINSI;

     |SI nHay = 1;  |ACABA;  |FINSI;

     |DBASS aAlfa;  |QBF aAlfa;
     nHay   = 0;
     nRenta = 1997;
     aRenta = aAlfa + "ren1997/def/redatcon.mas";
     aRenFi = aAlfa + "ren1997/fich/";
     |CARGA_DEF aRenta, redatcon@;
     |SI FSalida = 0;
         |PATH_DAT #902 aRenFi;
         |ABRE #902;
         #902#0 = #1#0;
         |LEE 040#902=;
         |SI FSalida = 0;
             nHay = 1;
             |HAZ CargaDatosRenta;
         |FINSI;
         |CIERRA #902;
         |DESCARGA_DEF #redatcon@;
     |FINSI;

     |SI nHay = 1;  |ACABA;  |FINSI;

     |DBASS aAlfa;  |QBF aAlfa;
     nHay   = 0;
     nRenta = 1996;
     aRenta = aAlfa + "ren1996/def/redatcon.mas";
     aRenFi = aAlfa + "ren1996/fich/";
     |CARGA_DEF aRenta, redatcon@;
     |SI FSalida = 0;
         |PATH_DAT #902 aRenFi;
         |ABRE #902;
         #902#0 = #1#0;
         |LEE 040#902=;
         |SI FSalida = 0;
             nHay = 1;
             |HAZ CargaDatosRenta;
         |FINSI;
         |CIERRA #902;
         |DESCARGA_DEF #redatcon@;
     |FINSI;

     |SI nHay = 1;  |ACABA;  |FINSI;

     |DBASS aAlfa;  |QBF aAlfa;
     nHay   = 0;
     nRenta = 1995;
     aRenta = aAlfa + "ren1995/def/redatcon.mas";
     aRenFi = aAlfa + "ren1995/fich/";
     |CARGA_DEF aRenta, redatcon@;
     |SI FSalida = 0;
         |PATH_DAT #902 aRenFi;
         |ABRE #902;
         #902#0 = #1#0;
         |LEE 040#902=;
         |SI FSalida = 0;
             nHay = 1;
             |HAZ CargaDatosRenta;
         |FINSI;
         |CIERRA #902;
         |DESCARGA_DEF #redatcon@;
     |FINSI;

     |SI nHay = 1;  |ACABA;  |FINSI;

     |DBASS aAlfa;  |QBF aAlfa;
     nHay   = 0;
     nRenta = 1994;
     aRenta = aAlfa + "ren1994/def/redatcon.mas";
     aRenFi = aAlfa + "ren1994/fich/";
     |CARGA_DEF aRenta, redatcon@;
     |SI FSalida = 0;
         |PATH_DAT #902 aRenFi;
         |ABRE #902;
         #902#0 = #1#0;
         |LEE 040#902=;
         |SI FSalida = 0;
             nHay = 1;
             |HAZ CargaDatosRenta;
         |FINSI;
         |CIERRA #902;
         |DESCARGA_DEF #redatcon@;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0000;
     #1#1;
     ;
     00001;
     99999;
     be;
     NULL, dsam0000;
|FIN;

|PROCESO CogeCodigo;
     nBorrar = 0;
     |SI #215#22 = "S";  nBorrar = 1;  |ACABA;  |FINSI;

     nCodigoNue = #215#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15;
     #215#6;
     ;
     nCodigoNom, "            ", 00;
     nCodigoNom, "zzzzzzzzzzzz", 99;
     ;
     NULL, CogeCodigo;
|FIN;

|PROCESO labempre;
     aAlfa1 = #903#113 % 104;   |QBF aAlfa1;
     aAlfa2 = #903#113 % 504;   |QBF aAlfa2;
     aAlfa3 = #903#113 % 902;   |QBF aAlfa3;
     aAlfa4 = #903#113 % 1110;  |QBF aAlfa4;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     |SI nEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoNom = #903#0;
         |BUCLE dspase15;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #903#0;
     |FINSI;

     #116#2 = aAlfa1;
     #116#3 = aAlfa2;
     #116#4 = "";
     |LEE 040#116];
     |SI FSalida ! 0;  |O #116#2 ! aAlfa1;  |O #116#3 ! aAlfa2;
         |DDEFECTO #116;
     |FINSI;

     #9#0 = nCodigoNue;
     #9#1 = 998;
     |LEE 101#9=;
     |SI FSalida = 0;  |LIBERA #9;  |ACABA;  |FINSI;

     |DDEFECTO #9;
     #9#0 = nCodigoNue;
     #9#1 = 998;
     #9#2  = "BANCO PARA GESTION LABORAL";
     #9#3  = #116#0;
     #9#4  = #116#1;
     #9#5  = aAlfa1;
     #9#6  = aAlfa2;
     #9#7  = aAlfa3;
     #9#8  = aAlfa4;
     |GRABA 020#9n;
     |LIBERA #9;
|FPRC;

|DEFBUCLE labempre;
     #903#1001;
     ;
     00000;
     99999;
     ;
     NULL, labempre;
|FIN;

|PROCESO BancosLaboral;
     |DBASS aBase;  |QBF aBase;
     aFich = aBase + "basica/fich/";
     |PATH_DAT #200 aFich;

     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     |ABRE #215;
     |LEE 040#215p;
     |SI FSalida ! 0;
         nEstaCambio = 0;
         |DDEFECTO #215;
     |SINO;
         nEstaCambio = 1;
         |SI #215#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #215;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #215;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;
     aPathDefLaboral  = aPathAnterior + "aginom/def/";
     aPathFichLaboral = aPathAnterior + "aginom/fich/";

     aDef = aPathDefLaboral + "labempre.mas";
     |CARGA_DEF aDef, labempre@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero de Empresas de Laboral";
         |MENAV aAlfa1;
         |ACABA;
     |SINO;
         |PATH_DAT #903 aPathFichLaboral;
     |FINSI;

     |ABRE #9;
     |ABRE #116;
     |SELECT #3#116;
     |BUCLE labempre;
     |CIERRA #9;
     |CIERRA #116;

     |DESCARGA_DEF #labempre@;
|FPRC;

|DEFBUCLE dspase15Reo;
     #215#4
     ;
     nCodigoReo, "            ", 00;
     nCodigoReo, "zzzzzzzzzzzz", 99;
     ;
     NULL, CogeCodigo;
|FIN;

|PROCESO eosdaban;
     aAlfa1 = #906#02; |QBF aAlfa1;
     aAlfa2 = #906#03; |QBF aAlfa2;
     aAlfa3 = #906#04;
     aAlfa4 = #906#05;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     |SI nEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoReo = #906#0;
         |BUCLE dspase15Reo;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #906#0;
     |FINSI;

     #116#2 = aAlfa1;
     #116#3 = aAlfa2;
     #116#4 = "";
     |LEE 040#116];
     |SI FSalida ! 0;  |O #116#2 ! aAlfa1;  |O #116#3 ! aAlfa2;
         |DDEFECTO #116;
     |FINSI;

     #9#0 = nCodigoNue;
     #9#1 = 999;
     |LEE 101#9=;
     |SI FSalida = 0;  |LIBERA #9;  |ACABA;  |FINSI;

     |DDEFECTO #9;
     #9#0 = nCodigoNue;
     #9#1 = 999;
     #9#2  = "BANCO PARA GESTION MODELOS";
     #9#3  = #116#0;
     #9#4  = #116#1;
     #9#5  = aAlfa1;
     #9#6  = aAlfa2;
     #9#7  = aAlfa3;
     #9#8  = aAlfa4;
     |GRABA 020#9n;
     |LIBERA #9;
|FPRC;

|DEFBUCLE eosdaban;
     #906#1001;
     ;
     00000;
     99999;
     ;
     NULL, eosdaban;
|FIN;

|PROCESO BancosEos;
     |DBASS aBase;  |QBF aBase;
     aFich = aBase + "basica/fich/";
     |PATH_DAT #200 aFich;

     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     |ABRE #215;
     |LEE 040#215p;
     |SI FSalida ! 0;
         nEstaCambio = 0;
         |DDEFECTO #215;
     |SINO;
         nEstaCambio = 1;
         |SI #215#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #215;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #215;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;
     aPathDefFiscal   = aPathAnterior + "agieos/def/";
     aPathFichFiscal  = aPathAnterior + "agieos/fich/";

     aDef = aPathDefFiscal + "eosdaban.mas";
     |CARGA_DEF aDef, eosdaban@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero de Bancos de REO";
         |MENAV aAlfa1;
         |ACABA;
     |SINO;
         |PATH_DAT #906 aPathFichFiscal;
     |FINSI;

     |ABRE #9;
     |ABRE #116;
     |SELECT #3#116;
     |BUCLE eosdaban;
     |CIERRA #9;
     |CIERRA #116;

     |DESCARGA_DEF #eosdaban@;
|FPRC;

|PROCESO nomatco2;
     |SI #905#80 = #0#8;  |Y #905#79 > #0#9;  |ACABA;  |FINSI;
     |SI #905#80 > #0#8;                      |ACABA;  |FINSI;

     nCodigoNom = #905#77;
     nCodigoNue = 0;
     |BUCLE dspase15;

     |SI nBorrar = 1;  |ACABA;  |FINSI;

     |SI nCodigoNue = #905#77;  |O nCodigoNue = 0;
         |PARA nCampo = 0;  |SI nCampo [ 80;  |HACIENDO nCampo = nCampo + 1;
               #904nCampo = #905nCampo;
         |SIGUE;
         |GRABA 020#904n;
         |LIBERA #904;
         |ACABA;
     |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 80;  |HACIENDO nCampo = nCampo + 1;
           #904nCampo = #905nCampo;
     |SIGUE;

     #904#77 = nCodigoNue;
     |GRABA 020#904n;
     |LIBERA #904;
|FPRC;

|DEFBUCLE nomatco2;
     #905#1004;
     ;
     00001, 00001, "    ", 01;
     99999, 99999, "zzzz", 12;
     ;
     NULL, nomatco2;
|FIN;

|PROCESO nomatcon;
     |SI #300#80 = #0#8;  |Y #300#79 [ #0#9;  |ACABA;  |FINSI;
     |SI #300#80 < #0#8;                      |ACABA;  |FINSI;

     |PARA nCampo = 0;  |SI nCampo [ 80;  |HACIENDO nCampo = nCampo + 1;
           #904nCampo = #300nCampo;
     |SIGUE;
     |GRABA 020#904n;
     |LIBERA #904;
|FPRC;

|DEFBUCLE nomatcon;
     #300#1;
     ;
     00001, 00001,  #0#8 , 01;
     99999, 99999, "zzzz", 12;
     ;
     NULL, nomatcon;
|FIN;

|PROCESO nomatcon904;
     |PARA nCampo = 0;  |SI nCampo [ 80;  |HACIENDO nCampo = nCampo + 1;
           #300nCampo = #904nCampo;
     |SIGUE;
     |GRABA 020#300n;
     |LIBERA #300;
|FPRC;

|DEFBUCLE nomatcon904;
     #904#1004;
     ;
     00001, 00001, "    ", 01;
     99999, 99999, "zzzz", 12;
     ;
     NULL, nomatcon904;
|FIN;

|PROCESO HistoricoConstantes;
     |ABRE #215;
     |LEE 040#215p;
     |SI FSalida ! 0;
         |MENAV "      Unificacion de Codigos no Realizada.";
         |CIERRA #215;
         |ACABA;
     |SINO;
         nEstaCambio = 1;
         |SI #215#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #215;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #215;

     |DBASS aBase;  |QBF aBase;
     aFich = aBase + "basica/fich/";
     |PATH_DAT #200 aFich;

     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;
     aPathDefLaboral  = aPathAnterior + "aginom/def/";
     aPathFichLaboral = aPathAnterior + "aginom/fich/";

     aDef = aPathDefLaboral + "nomatcon.mas";
     |CARGA_DEF aDef, nomatco2@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero NOMATCON desde Aplicion Anterior";
         |MENAV aAlfa1;
         |ACABA;
     |FINSI;

     aMas = aBase + "laboral/def/nomatcon.mas";
     |CARGA_DEF aMas, nomatco1@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |NOME_DAT #904 "histoatr";

     aPathLaboral = aBase + "laboral/fich/";

     |PATH_DAT #300 aPathLaboral;
     |PATH_DAT #904 aPathLaboral;
     |PATH_DAT #905 aPathFichLaboral;

     |ABRE #904;
     |BUCLE nomatco2;
     |BUCLE nomatcon;
     |CIERRA #904;

     |DELINDEX #300;

     |ABRE #300;
     |BUCLE nomatcon904;
     |CIERRA #300;

     |DELINDEX #904;
     |DESCARGA_DEF #nomatco2@;
     |DESCARGA_DEF #nomatco1@;
|FPRC;

|PROCESO QuitaBlanco;
     |ET aCadena;
         |QBF aParaQuitar;
         |SI aParaQuitar ! "";
             aCaracter = aParaQuitar % 101;
             |SI aCaracter = " ";
                 aParaQuitar = aParaQuitar % 240;
                 |VETE aCadena;
             |FINSI;
         |FINSI;
|FPRC;

|PROCESO SeparaNombre;
     || Busca una coma en la aCadena

     aCadena1 = "";
     aCadena2 = "";
     aCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nPara = 1; |SI nPara [ 40; |HACIENDO nPara = nPara + 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena % nPosi;

           |SI aCaracter = ","; nComa = nPara; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay coma busca el primer blanco empezando por detras

         aLongAlfa = aCadena % 0;
         nLongNume = aLongAlfa;

         |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
               nPosi = nPara * 100 + 1;
               aCaracter = aCadena % nPosi;
               |SI aCaracter = " "; nComa = nPara; |SAL; |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros aCaracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     aCadena2  = aCadena % nPosi;
     aLongAlfa = aCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nPara = nLongNume; |SI nPara ] 1; |HACIENDO nPara = nPara - 1;
           nPosi = nPara * 100 + 1;
           aCaracter = aCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nPara; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     aCadena2 = aCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     aCadena1 = aCadena % nPosi;

     || Recoge los dos primero aCaracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     aCadena3 = aCadena % nPosi;

     aParaQuitar = aCadena1; |HAZ QuitaBlanco; aCadena1 = aParaQuitar;
     aParaQuitar = aCadena2; |HAZ QuitaBlanco; aCadena2 = aParaQuitar;
     aParaQuitar = aCadena3; |HAZ QuitaBlanco; aCadena3 = aParaQuitar;

     |QBF aCadena1;
     |QBF aCadena2;
     |QBF aCadena3;
|FPRC;

|PROCESO GrabaConyuge;
     #216#0 = #907#1;
     #216#1 = 2;
     |LEE 101#216=;
     |SI FSalida ! 0;
         |DDEFECTO #216;
         #216#0 = #907#1;
         #216#1 = 2;
         |GRABA 020#216b;
     |FINSI;

     #216#2  = "CONYUGE";
     #216#3  = "";
     #216#4  = "";
     #216#5  = "";
     #216#6  = "";
     #216#7  = "";
     #216#8  = #907#7;
     #216#14 = "C";
     #216#15 = 0;
     #216#16 = "";
     #216#17 = 0;
     #216#18 = "N";
     #216#36 = 1;
     #216#38 = "N";
     #216#39 = "N";
     #216#41 = "";

     #216#19 = #103#14;
     #216#24 = #103#9;
     #216#25 = #103#2;
     #216#26 = #103#3;
     #216#27 = #103#16;
     #216#28 = #103#10;
     #216#29 = #103#11;
     #216#30 = #103#4;
     #216#31 = #103#5;
     #216#32 = #103#6;
     #216#33 = #103#7;
     #216#34 = #103#8;

     aCadena = #216#12;
     |HAZ SeparaNombre;
     #216#9    = aCadena1;
     #216#10   = aCadena2;
     #216#11   = aCadena3;

     |GRABA 020#216a;
     |LIBERA #216;

     #103#0 = #907#7;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0 = #907#7;
         |GRABA 020#103b;
     |FINSI;

     #103#14 = #216#19;
     #103#9  = #216#24;
     #103#2  = #216#25;
     #103#3  = #216#26;
     #103#16 = #216#27;
     #103#10 = #216#28;
     #103#11 = #216#29;
     #103#4  = #216#30;
     #103#5  = #216#31;
     #103#6  = #216#32;
     #103#7  = #216#33;
     #103#8  = #216#34;
     |GRABA 020#103a;
     |LIBERA #103;
|FPRC;

|PROCESO GrabaDescendiente;
     nLinea = nLinea + 1;

     #216#0 = #907#1;
     #216#1 = nLinea;
     |LEE 101#216=;
     |SI FSalida ! 0;
         |DDEFECTO #216;
         #216#0 = #907#1;
         #216#1 = nLinea;
         |GRABA 020#216b;
     |FINSI;

     #216#2  = "DESCENDIENTE";
     aAlfa   = "01.01." + #907nCampo;
     #216#13 = aAlfa;
     #216#3  = "";
     #216#4  = "";
     #216#5  = "";
     #216#6  = "";
     #216#7  = "";
     #216#14 = "";
     #216#15 = 0;
     #216#16 = "";
     #216#17 = 0;
     #216#18 = "N";
     #216#36 = 1;
     #216#38 = "N";
     #216#39 = "N";
     #216#41 = "";

     nCampo1 = nCampo + 1;
     #216#17 = #907nCampo1;

     |SI nCampo = 8;  nCampo1 = 31;  |FINSI;
     |SI nCampo = 10; nCampo1 = 32;  |FINSI;
     |SI nCampo = 12; nCampo1 = 33;  |FINSI;
     |SI nCampo = 14; nCampo1 = 34;  |FINSI;
     |SI nCampo = 16; nCampo1 = 35;  |FINSI;
     |SI nCampo = 18; nCampo1 = 36;  |FINSI;
     |SI nCampo = 20; nCampo1 = 37;  |FINSI;
     |SI nCampo = 22; nCampo1 = 38;  |FINSI;
     |SI nCampo = 24; nCampo1 = 39;  |FINSI;
     |SI nCampo = 26; nCampo1 = 40;  |FINSI;

     #216#7 = 100;
     |SI #907nCampo1 = "N";
         #216#7 = 50;
     |FINSI;

     |SI nCampo = 8;  nCampo1 = 63;  |FINSI;
     |SI nCampo = 10; nCampo1 = 64;  |FINSI;
     |SI nCampo = 12; nCampo1 = 65;  |FINSI;
     |SI nCampo = 14; nCampo1 = 66;  |FINSI;
     |SI nCampo = 16; nCampo1 = 67;  |FINSI;
     |SI nCampo = 18; nCampo1 = 68;  |FINSI;
     |SI nCampo = 20; nCampo1 = 69;  |FINSI;
     |SI nCampo = 22; nCampo1 = 70;  |FINSI;
     |SI nCampo = 24; nCampo1 = 71;  |FINSI;
     |SI nCampo = 26; nCampo1 = 72;  |FINSI;

     #216#18 = #907nCampo1;

     #216#19 = #103#14;
     #216#24 = #103#9;
     #216#25 = #103#2;
     #216#26 = #103#3;
     #216#27 = #103#16;
     #216#28 = #103#10;
     #216#29 = #103#11;
     #216#30 = #103#4;
     #216#31 = #103#5;
     #216#32 = #103#6;
     #216#33 = #103#7;
     #216#34 = #103#8;

     aCadena = #216#12;
     |HAZ SeparaNombre;
     #216#9    = aCadena1;
     #216#10   = aCadena2;
     #216#11   = aCadena3;

     |GRABA 020#216a;
     |LIBERA #216;
|FPRC;

|PROCESO GrabaAscendiente;
     nLinea = nLinea + 1;

     #216#0 = #907#1;
     #216#1 = nLinea;
     |LEE 101#216=;
     |SI FSalida ! 0;
         |DDEFECTO #216;
         #216#0 = #907#1;
         #216#1 = nLinea;
         |GRABA 020#216b;
     |FINSI;

     #216#2  = "ASCENDIENTE";
     aAlfa   = "01.01." + #907nCampo;
     #216#13 = aAlfa;
     #216#3  = "";
     #216#4  = "";
     #216#5  = "";
     #216#6  = "";
     #216#7  = "";
     #216#14 = "";
     #216#15 = 0;
     #216#16 = "";
     #216#17 = 0;
     #216#18 = "N";
     #216#36 = 1;
     #216#38 = "N";
     #216#39 = "N";
     #216#41 = "";

     nCampo1 = nCampo - 22;
     |SI #907nCampo1 = "1";  #216#17 = 33;  |FINSI;
     |SI #907nCampo1 = "2";  #216#17 = 65;  |FINSI;

     nCampo1 = nCampo + 10;
     #216#18 = #907nCampo1;
     #216#3  = "1";

     nCampo1 = nCampo - 32;
     #216#6  = "N";
     #216#5  = #907nCampo1;
     |SI #216#5 ! 0;  #216#6  = "S";  |FINSI;

     #216#19 = #103#14;
     #216#24 = #103#9;
     #216#25 = #103#2;
     #216#26 = #103#3;
     #216#27 = #103#16;
     #216#28 = #103#10;
     #216#29 = #103#11;
     #216#30 = #103#4;
     #216#31 = #103#5;
     #216#32 = #103#6;
     #216#33 = #103#7;
     #216#34 = #103#8;

     aCadena = #216#12;
     |HAZ SeparaNombre;
     #216#9    = aCadena1;
     #216#10   = aCadena2;
     #216#11   = aCadena3;

     |GRABA 020#216a;
     |LIBERA #216;
|FPRC;

|PROCESO eosm0029;
     #103#0 = #907#1;
     |LEE 101#103=;
     |SI FSalida ! 0;
         |DDEFECTO #103;
         #103#0 = #907#1;
         |GRABA 020#103b;
     |FINSI;

     #103#1 = #907#2;
     |GRABA 020#103a;
     |LIBERA #103;

     #216#0 = #907#1;
     #216#1 = 1;
     |LEE 101#216=;
     |SI FSalida ! 0;
         |DDEFECTO #216;
         #216#0 = #907#1;
         #216#1 = 1;
         |GRABA 020#216b;
     |FINSI;

     #216#2  = "TITULAR";
     #216#3  = "";
     #216#4  = "";
     #216#5  = "";
     #216#6  = "";
     #216#7  = "";
     #216#8  = #907#1;
     #216#12 = #907#2;

     aAlfa   = "01.01." + #907#3;
     #216#13 = aAlfa;

     |SI #907#5 = 1;  #216#14 = "S";  |FINSI;
     |SI #907#5 = 2;  #216#14 = "C";  |FINSI;
     |SI #907#5 = 3;  #216#14 = "L";  |FINSI;

     aAlfa = #907#7;  |QBF aAlfa;
     |SI aAlfa ! "";  #216#14 = "C";  |FINSI;

     #216#15 = #907#5;
     #216#16 = "A";
     #216#17 = #907#4;
     #216#18 = #907#30;
     #216#36 = #907#6;
     #216#38 = #907#61;
     #216#39 = #907#62;
     #216#41 = "";

     #216#12 = #103#1;
     #216#19 = #103#14;
     #216#24 = #103#9;
     #216#25 = #103#2;
     #216#26 = #103#3;
     #216#27 = #103#16;
     #216#28 = #103#10;
     #216#29 = #103#11;
     #216#30 = #103#4;
     #216#31 = #103#5;
     #216#32 = #103#6;
     #216#33 = #103#7;
     #216#34 = #103#8;

     aCadena = #216#12;
     |HAZ SeparaNombre;
     #216#9    = aCadena1;
     #216#10   = aCadena2;
     #216#11   = aCadena3;

     |GRABA 020#216a;
     |LIBERA #216;

     aAlfa = #907#7;  |QBF aAlfa;
     |SI aAlfa ! "";
         |HAZ GrabaConyuge;
     |FINSI;

     nLinea = 2;
     |PARA nCampo = 8;  |SI nCampo [ 26;  |HACIENDO nCampo = nCampo + 2;
           |SI #907nCampo ! 0;
               |HAZ GrabaDescendiente;
           |FINSI;
     |SIGUE;

     |PARA nCampo = 73;  |SI nCampo [ 82;  |HACIENDO nCampo = nCampo + 1;
           |SI #907nCampo ! 0;
               |HAZ GrabaAscendiente;
           |FINSI;
     |SIGUE;
|FPRC;

|DEFBUCLE eosm0029;
     #907#1002;
     ;
     nDEmpresa, "            ";
     nHEmpresa, "zzzzzzzzzzzz";
     ;
     NULL, eosm0029;
|FIN;

|PROCESO DatosPersonalesREO;
     |DBASS aBase;  |QBF aBase;
     aFich = aBase + "basica/fich/";
     |PATH_DAT #200 aFich;

     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     |ABRE #215;
     |LEE 040#215p;
     |SI FSalida ! 0;
         nEstaCambio = 0;
         |DDEFECTO #215;
     |SINO;
         nEstaCambio = 1;
         |SI #215#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #215;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #215;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;
     aPathDefFiscal   = aPathAnterior + "agieos/def/";
     aPathFichFiscal  = aPathAnterior + "agieos/fich/";

     aDef = aPathDefFiscal + "eosm0029.mas";
     |CARGA_DEF aDef, eosm0029@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero de Ficha Trabajadores de REO";
         |MENAV aAlfa1;
         |ACABA;
     |SINO;
         |PATH_DAT #907 aPathFichFiscal;
     |FINSI;

     nDEmpresa = 1;
     nHEmpresa = 99999;
     |SI #0#14 ! 0;
         nDEmpresa = #0#14;
         nHEmpresa = #0#14;
     |FINSI;

     |ABRE #103;
     |ABRE #216;
     |BUCLE eosm0029;
     |CIERRA #103;
     |CIERRA #216;

     |DESCARGA_DEF #eosm0029@;
|FPRC;


|PROCESO CogeCodigoConta;
     |SI #215#22 = "S";  |ACABA;  |FINSI;
     nCodigoNue = #215#3;
     |ERROR10;
|FPRC;

|DEFBUCLE dspase15Conta;
     #215#5;
     ;
     nCodigoCon, "            ", 000;
     nCodigoCon, "zzzzzzzzzzzz", 999;
     ;
     NULL, CogeCodigoConta;
|FIN;

|PROCESO BancoConta;
     aAlfa1 = #909#66; |QBF aAlfa1;
     aAlfa2 = #909#67; |QBF aAlfa2;
     aAlfa3 = #909#68;
     aAlfa4 = #909#69;

     |SI aAlfa1 = "";  |Y aAlfa2 = "";  |ACABA;  |FINSI;

     #116#2 = aAlfa1;
     #116#3 = aAlfa2;
     #116#4 = "";
     |LEE 040#116];
     |SI FSalida ! 0;  |O #116#2 ! aAlfa1;  |O #116#3 ! aAlfa2;
         |DDEFECTO #116;
     |FINSI;

     #9#0 = nCodigoNue;
     #9#1 = 999;
     |LEE 101#9=;
     |SI FSalida = 0;  |LIBERA #9;  |ACABA;  |FINSI;

     |DDEFECTO #9;
     #9#0 = nCodigoNue;
     #9#1 = 999;
     #9#2  = "BANCO PARA GESTION MODELOS";
     #9#3  = #116#0;
     #9#4  = #116#1;
     #9#5  = aAlfa1;
     #9#6  = aAlfa2;
     #9#7  = aAlfa3;
     #9#8  = aAlfa4;
     |GRABA 020#9n;
     |LIBERA #9;
|FPRC;

|PROCESO GrabaRep;
     |ABRE #1115;
     #1115#0 = nCodigoNue;
     |LEE 101#1115=;
     |SI FSalida ! 0;
         #1115#0 = nCodigoNue;
         |GRABA 020#1115b;
     |FINSI;

     #1115#2 = #909#2;
     #1115#3 = #909#20;
     #1115#4 = #909#38;
     #1115#5 = #909#39;
     #1115#7 = "REPRESENTANTE";
     #1115#8 = #909#40;
     #1115#9 = #909#41;
     #1115#10 = #909#42;
     #1115#11 = #909#43;
     #1115#12 = #909#44;
     #1115#13 = #909#45;
     #1115#14 = #909#46;
     #1115#15 = #909#47;
     #1115#16 = #909#48;
     #1115#17 = #909#49;
     #1115#18 = #909#50;
     #1115#19 = "REPRESENTANTE";

     |GRABA 020#1115a;
     |LIBERA #1115;
     |CIERRA #1115;
|FPRC;

|PROCESO PonTiposActiv;
     #1114#7  = 1;
     |SI #909#73 = 0;  #1114#7 = 1;  |FINSI;
     |SI #909#73 = 1;  #1114#7 = 2;  |FINSI;
     |SI #909#73 = 2;  #1114#7 = 5;  |FINSI;
     |SI #909#73 = 3;  #1114#7 = 5;  |FINSI;
     |SI #909#73 = 4;  #1114#7 = 7;  |FINSI;
     |SI #909#73 = 5;  #1114#7 = 4;  |FINSI;
     |SI #909#73 = 6;  #1114#7 = 10; |FINSI;
     |SI #909#73 = 7;  #1114#7 = 2;  |FINSI;
     |SI #909#73 = 8;  #1114#7 = 3;  |FINSI;
     |SI #909#73 = 9;  #1114#7 = 3;  |FINSI;

     #1114#9 = 1;
     |SI #909#81 = "A";   #1114#9 = 5;  |FINSI;
     |SI #909#81 = "B";   #1114#9 = 4;  |FINSI;
     |SI #909#81 = "C";   #1114#9 = 3;  |FINSI;

     |SI #909#81 = "A";   |Y #909#83 = "S";
         #1114#9 = 6;
     |FINSI;

     |SI #1114#9 = 1;   |Y #909#83 = "S";
         #1114#9 = 7;
     |FINSI;

     #1110#0 = #1114#7;
     |LEE 040#1110=;
     |SI FSalida ! 0;  |DDEFECTO #1110;  |FINSI;

     #1112#0 = #1114#9;
     |LEE 040#1112=;
     |SI FSalida ! 0;  |DDEFECTO #1112;  |FINSI;

     #1114#8  = #1110#5;
     #1114#10 = #1112#5;


     aAlfa1 = #1114#3 % 101;
     aAlfa1 = aAlfa1 + "00";
     aAlfa2 = #1114#3; |QBF aAlfa2;
     aAlfa3 = aAlfa2 % 0;
     |SI aAlfa3 = 4;
         aAlfa2 = (#1114#3 % 103) + "." + (#1114#3 % 401);
     |FINSI;
     #1113#0 = #1114#2;
     #1113#1 = aAlfa1;
     #1113#2 = aAlfa2;
     |LEE 041#1113=;
     |SI FSalida = 0;
         #1114#11 = #1113#5;
         #1111#0  = #1114#11;
         |LEE 041#1111=;
         |SI FSalida = 0;
             #1114#12 = #1111#1;
         |FINSI;
         #1114#20 = #1113#6;
         #1114#21 = #1113#4;
     |FINSI;
|FPRC;

|PROCESO PasaActCon;
     |ABRE #1110;
     |ABRE #1111;
     |ABRE #1112;
     |ABRE #1113;
     |ABRE #1114;

     #1114#0 = nCodigoNue;
     #1114#1 = nActividad;
     |LEE 141#1114=;
     |SI FSalida ! 0;

         |DDEFECTO #1114;
         #1114#0 = nCodigoNue;
         #1114#1 = nActividad;
         #1114#2 = #909#82;
         nNume1  = nPara1 + 12;
         aAlfa1  = #909nNume1 % 101;
         |SI aAlfa1 = "E";
             #909nNume1 = #909nNume1 - ".";
             #1114#3 = #909nNume1 % 204;
         |SINO;
             #909nNume1 = #909nNume1 - ".";
             #1114#3 = #909nNume1;
          |FINSI;
          #1114#4 = #909nPara1;

          |HAZ PonTiposActiv;

          |GRABA 020#1114n;

     |SINO;

         #1114#2 = #909#82;
         nNume1  = nPara1 + 12;
         aAlfa1  = #909nNume1 % 101;
         |SI aAlfa1 = "E";
             #909nNume1 = #909nNume1 - ".";
             #1114#3 = #909nNume1 % 204;
         |SINO;
             #909nNume1 = #909nNume1 - ".";
             #1114#3 = #909nNume1;
          |FINSI;
          #1114#4 = #909nPara1;

          |HAZ PonTiposActiv;

          |GRABA 020#1114a;
     |FINSI;
     |LIBERA #1114;
     |CIERRA #1114;
     |CIERRA #1113;
     |CIERRA #1112;
     |CIERRA #1111;
     |CIERRA #1110;
|FPRC;

|PROCESO PasoDatos;
     #1#0 = nCodigoNue;
     |LEE 141#1=;
     |SI FSalida = 0;

         #1#15 = #909#16; #1#16 = #909#17;  || Hacienda
         #1#17 = #909#18; #1#18 = #909#19;
         #1#57 = #909#102;                  || Letra Etiqueta
         #1#53 = #909#89;                   || Persona de Contacto

         aAlfa1 = #909#38; aAlfa2 = #909#39;
         |QBF aAlfa1;      |QBF aAlfa2;
         |SI aAlfa1 ! ""; |O aAlfa2 ! "";
             |HAZ GrabaRep;
         |FINSI;

         |HAZ BancoConta;

         aAlfa2 = #909#90; |QBF aAlfa2;
         aAlfa1 = #909#91; |QBF aAlfa1;
         |SI aAlfa1 ! "";
             aTCont = aAlfa2 + aAlfa1;
             aTPpal  = "";
             aTOtros = "";
             aTFax   = "";
             |HAZ GrabaTelefonos;
         |FINSI;

         nActividad = 0;
         |PARA nPara1 = 20; |SI nPara1 [ 25; |HACIENDO nPara1 = nPara1 + 1;
               aAlfa1 = #909nPara1; |QBF aAlfa1;
               |SI aAlfa1 ! "";
                   nActividad = nActividad + 1;
                   |HAZ PasaActCon;
               |FINSI;
         |SIGUE;
         |GRABA 020#1a;
     |FINSI;
     |LIBERA #1;
|FPRC;

|PROCESO DatosPortadas;

     |SI nEstaCambio = 1;
         nCodigoNue = 0;
         nCodigoCon = #908#2;
         |BUCLE dspase15Conta;
         |SI nCodigoNue = 0;  |ACABA;  |FINSI;
     |SINO;
         nCodigoNue = #908#2;
     |FINSI;

     |SI nCodigoNue ] #0#16; |Y nCodigoNue [ #0#17;

         aPath = aPathFichAgicont + (("00000" + #908#2) % -105) + #908#3 + "/";
         |PATH_DAT #909 aPath;

         |ABRE #909;
         #909#0 = #908#2;
         #909#1 = #908#26;
         |LEE 001#909=;
         |SI FSalida = 0;
             |HAZ PasoDatos;
         |FINSI;
         |CIERRA #909;
    |FINSI;
|FPRC;

|DEFBUCLE canempre;
     #908#1002;
     26;
     00001, 0, nAnyC;
     99999, 9, nAnyC;
     e;
     NULL, DatosPortadas;
|FIN;

|PROCESO DatosStar;
     |DBASS aBase;  |QBF aBase;
     aFich = aBase + "basica/fich/";
     |PATH_DAT #200 aFich;

     |ABRE #200;
     |LEE 040#200p;
     |SI FSalida ! 0;
         |MENAV "     Pase de Ficheros Generales no Realizado";
         |CIERRA #200;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     |ABRE #215;
     |LEE 040#215p;
     |SI FSalida ! 0;
         nEstaCambio = 0;
         |DDEFECTO #215;
     |SINO;
         nEstaCambio = 1;
         |SI #215#15 ! "S";
             |MENAV "      Unificacion de Codigos no Realizada.";
             |CIERRA #215;
             |ACABA;
         |FINSI;
     |FINSI;
     |CIERRA #215;

     aPathAnterior    = #200#0;  |QBT aPathAnterior;
     aPathDefAgicont  = aPathAnterior + "agicont/def/";
     aPathFichAgicont = aPathAnterior + "agicont/fich/";

     aDef = aPathDefAgicont + "canempre.mas";
     |CARGA_DEF aDef, canempre@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero de Empresas Contable de Agicont";
         |MENAV aAlfa1;
         |ACABA;
     |FINSI;

     aDef = aPathDefAgicont + "caportad.mas";
     |CARGA_DEF aDef, caportad@;
     |SI FSalida ! 0;
         aAlfa1   = "     Error en Cargar el Def fichero de Portadas de Empresas Contable de Agicont";
         |MENAV aAlfa1;
         |DESCARGA_DEF #canempre@;
         |ACABA;
     |FINSI;

     |PATH_DAT #908 aPathFichAgicont;

     enAny = #0#18;
     aAlfa = #0#18; aAlfa = aAlfa % -102;
     nAnyC = aAlfa;

     |ABRE #1;
     |ABRE #9;
     |ABRE #116;
     |BUCLE canempre;
     |CIERRA #116;
     |CIERRA #9;
     |CIERRA #1;

     |DESCARGA_DEF #caportad@;
     |DESCARGA_DEF #canempre@;
|FPRC;

|PROCESO Tipo3;  |TIPO 3;
     |SI #0#0 = "SI";
         |ABRE #3;
         |ABRE #4;

         |DBASS aBase;  |QBF aBase;

         |SI #0#11 = 2002;  |O #0#11 = 0;
             nContinua   = 0;

             aMasRenta   = aBase + "ren2002/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2002/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2002/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2003;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2003/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2003/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2003/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2004;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2004/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2004/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2004/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2005;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2005/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2005/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2005/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2006;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2006/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2006/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2006/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2007;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2007/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2007/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2007/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2008;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2008/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2008/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2008/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2009;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2009/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2009/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2009/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2010;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2010/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2010/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2010/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2011;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2011/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2011/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2011/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2012;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2012/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2012/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2012/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2013;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2013/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2013/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2013/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2014;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2014/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2014/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2014/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2015;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2015/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2015/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2015/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2016;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2016/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2016/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2016/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |SI #0#11 = 2017;  |O #0#11 = 0;
             nContinua   = 0;
             aMasRenta   = aBase + "ren2017/def/rem00100.mas";
             |CARGA_DEF aMasRenta, rem00100@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             aMasRenta   = aBase + "ren2017/def/rem00101.mas";
             |CARGA_DEF aMasRenta, rem00101@;
             |SI FSalida ! 0;  nContinua = 1;  |FINSI;

             |SI nContinua = 0;
                 aPathRenta  = aBase + "ren2017/fich/";
                 |PATH_DAT #900 aPathRenta;
                 |PATH_DAT #901 aPathRenta;
                 |ABRE #1;
                 |BUCLE rem00100;
                 |CIERRA #1;

                 |DESCARGA_DEF #rem00101@;
                 |DESCARGA_DEF #rem00100@;
             |FINSI;
         |FINSI;

         |CIERRA #3;
         |CIERRA #4;
     |FINSI;

     |SI #0#1 = "SI";
         |ABRE #103;
         |BUCLE dsam0003;
         |CIERRA #103;
     |FINSI;

     |SI #0#3 = "SI";
         |BUCLE dsam0000;
         |SUB_EJECUTA_NP "dsaz0003;AUTO";
         |ACABA;
     |FINSI;

     |SI #0#10 = "SI";
         |SUB_EJECUTA_NP "dsaz0003;ABOGADOS";
     |FINSI;

     |SI #0#2 = "SI";
         |SUB_EJECUTA_NP "dsaz0003;AUTO";
     |FINSI;

     |SI #0#4 = "SI";
         enAny = #0#5;
         |SUB_EJECUTA_NP "dsaz0008";
     |FINSI;

     |SI #0#6 = "SI";
         |HAZ BancosLaboral;
         |SUB_EJECUTA_NP "dsaz0003;AUTO";
     |FINSI;

     |SI #0#12 = "SI";
         |HAZ BancosEos;
         |SUB_EJECUTA_NP "dsaz0003;AUTO";
     |FINSI;

     |SI #0#7 = "SI";
         |HAZ HistoricoConstantes;
     |FINSI;

     |SI #0#13 = "SI";
         |HAZ DatosPersonalesREO;
     |FINSI;

     |SI #0#15 = "SI";
         |HAZ DatosStar;
         |SUB_EJECUTA_NP "dsaz0003;AUTO";
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI PARAMETRO = "";
         |CUADRO 0501 2380;
         |BLANCO 0602 2279;
         |PINTA 1320, "Introduzca Password : ";
         E_inf = "";
         E_sup = "20";
         aPassword = 1342 ? -1;
         |SI aPassword ! "<MYPASWD>     ";
             |MENAV "     Permiso denegado.";
             |ACABA;
         |FINSI;

         |MANTE #0;
     |SINO;
         #0#0  = "NO";
         #0#1  = "SI";
         #0#2  = "NO";
         #0#3  = "NO";
         #0#4  = "NO";
         #0#6  = "NO";
         #0#7  = "NO";
         #0#13 = "NO";
         #0#15 = "NO";
         |HAZ Tipo3;
     |FINSI;
|FPRO;
