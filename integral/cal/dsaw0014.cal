|FICHEROS;
     :/integral/def/dsaw0014,MANTE;
     :/integral/def/dsam0000;
     :/integral/def/dsam0109;

     dsat0001;
     dsaw0013;
     dsam0023;
|FIN;

|VARIABLES;
     nModo       = 0;
     nInkey      = 0;
     aAlfa       = "";
     nNume1      = 0;
     nHMes       = 0;
     nHEjer      = 0;
     nBueno      = 0;
     &enEmpresa  = 0;
     &aFuncion   = 0;
     &enEmpPD    = 0;
     &enEjer     = 0;

     &enDEmpresa = 0;
     &enHEmpresa = 0;
     &enDAgente  = 0;
     &enHAgente  = 0;
|FIN;

|PROCESO Tipo6C0w14; |TIPO 6;
   |SI #dsaw0014#0 < enDEmpresa; |O #dsaw0014#0 > enHEmpresa;
       |MENAV "0000Error. Cliente fuera de la seleccion";
       |ERROR;
       |ACABA;
   |FINSI;
   nBueno = 0;
   |ABRE #dsam0000;
   #dsam0000#0 = #dsaw0014#0;
   |LEE 041#dsam0000.=;
   |SI FSalida ! 0;
       |MENAV "0000Error no existe Cliente";
       nBueno = 1;
       |ERROR;
   |SINO;
       |SI #dsam0000#72 < enDAgente; |O #dsam0000#72 > enHAgente;
           |MENAV "0000El agente de este cliente fuera de la seleccion";
           nBueno = 1;
           |ERROR;
       |SINO;
           |SI #dsam0000#121 = "N";
               |CONFI "0000NEmpresa NO obligada. Continuar";
               |SI FSalida ! 0;
                   nBueno = 1;
                   |ERROR;
               |FINSI;
           |FINSI;
       |FINSI;
   |FINSI;
   |CIERRA #dsam0000;

   #dsaw0014#20 = "";
   |SI nBueno = 0;  #dsaw0014#20 = #dsam0000#3;  |FINSI;
   |PINTA #dsaw0014#20;
|FPRC;

|PROCESO Tipo0C0w14; |TIPO 0;

||   |ABRE #dsat0001;
   #dsat0001#0 = aFuncion;
   #dsat0001#1 = enEmpPD;
   #dsat0001#2 = enEjer;
   #dsat0001#3 = #dsaw0014#2;
   #dsat0001#4 = #dsaw0014#0;
   |LEE 041#dsat0001.=;
   |SI FSalida = 0;
       |MENAV "0000Registro YA informado";
       |CIERRA #dsat0001;
       |ERROR;
       |ACABA;
   |FINSI;
||   |CIERRA #dsat0001;

   |ABRE #dsam0023;
   #dsam0023#0 = #dsaw0014#0;
   #dsam0023#1 = #dsaw0014#1;
   #dsam0023#2 = #dsaw0014#2;
   |LEE 041#dsam0023.=;
   |SI FSalida = 0;
       |MENAV "0000Registro YA informado";
       |CIERRA #dsam0023;
       |ERROR;
       |ACABA;
   |FINSI;

   #dsam0023#0 = #dsaw0014#0;
   #dsam0023#1 = #dsaw0014#1;
   #dsam0023#2 = #dsaw0014#2;
   |LEE 041#dsam0023.];
   |SI FSalida = 0;
       |LEE 041#dsam0023.a;
   |SINO;
       |LEE 041#dsam0023.u;
   |FINSI;
   |SI FSalida = 0; |Y #dsam0023#0 = #dsaw0014#0;
       |SI #dsam0023#3 ! #dsaw0014#3;
           |MENAV "0000Esta Empresa tenia asignada otra Emp. de Proteccion Datos";
           |CONFI "0000NContinuar";
           |SI FSalida ! 0;
               |CIERRA #dsam0023;
               |ERROR;
               |ACABA;
           |FINSI;
       |FINSI;
       #dsaw0014#5 = #dsam0023#5;
       #dsaw0014#6 = #dsam0023#6;
       #dsaw0014#7 = #dsam0023#7;
       #dsaw0014#8 = #dsam0023#8;
       #dsaw0014#9 = #dsam0023#9;
       #dsaw0014#10 = #dsam0023#10;
       |PINDA #0#dsaw0014;
   |FINSI;

   |CIERRA #dsam0023;
|FPRC;

|PROCESO LaComision;
   #dsaw0014#15 = ( #dsaw0014#11 % #dsaw0014#12) ! 2;
|FPRC;
