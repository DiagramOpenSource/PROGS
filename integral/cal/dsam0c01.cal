|FICHEROS;
     :integral/dsam0000;
     :integral/dsam0123;
     :integral/dsam0124;
|FIN;

|VARIABLES;
     &eaNuevo1 = "";
     &eaNuevo2 = "";
|FIN;

|PROCESO GrabaDirec;
     #dsam0124#0 = eaNuevo1;
     |GRABA 020#dsam0124.n;
     |LIBERA #dsam0124;

     #dsam0124#0 = eaNuevo2;
     |LEE 101#dsam0124.=;
     |SI FSalida = 0;
         |BORRA 020#dsam0124.a;
         |LIBERA #dsam0124;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0124;
     #dsam0124#1;
     ;
     eaNuevo2, 00;
     eaNuevo2, 99;
     be;
     NULL, GrabaDirec;
|FIN;

|PROCESO GrabaDirecCorreo;
     |ABRE #dsam0123;
     #dsam0123#0 = eaNuevo1;
     |LEE 101#dsam0123.=;
     |SI FSalida ! 0;
         #dsam0123#0 = #dsam0000#1;
         #dsam0123#1 = #dsam0000#27;
         #dsam0123#2 = #dsam0000#28;
         |GRABA 020#dsam0123.n;
         |LIBERA #dsam0123;

         #dsam0123#0 = eaNuevo2;
         |LEE 101#dsam0123.=;
         |SI FSalida = 0;
             |BORRA 020#dsam0123.a;
             |LIBERA #dsam0123;
         |FINSI;

         |BUCLE dsam0124;
     |FINSI;
     |CIERRA #dsam0123;
|FPRC;
