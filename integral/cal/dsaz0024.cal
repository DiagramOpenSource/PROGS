|FICHEROS;
     dsaz0024 #24;

     :/integral/def/dsam0000  #0;                        || Datos Generales
     :/integral/def/dsam0010  #10;                       || Bancos Facturacion
     :/facturar/def/asclient  #701;                      || Clientes facturar

     :/facturar/def/facemp1   #200;
|FIN;

|VARIABLES;
     aBase = "";
     aAlfa = "";
     nExiste = 0;
     aMensaje = "";
     aRespuesta = "";
|FIN;

|PROCESO dsam0000;
     |DDEFECTO #dsam0010;
     #dsam0010#0 = #dsam0000#0;
     #dsam0010#1 = #dsaz0024#3;
     |LEE 101#dsam0010.=;
     |SI FSalida = 0;
          #dsam0010#19 = #dsam0000#71;
          #dsam0010#20 = #dsam0000#111;
          #dsam0010#21 = #dsam0000#112;
          |GRABA 020#dsam0010.a;
          |LIBERA #dsam0010;

          aBase = "";
          |DBASS aBase;  |QBT aBase;
          aBase = aBase + "facturar/fich/";
          aAlfa = aBase + (("00" + #dsaz0024#3) % -102) + "/";
          |QBT aAlfa;

          |PATH_DAT #701 aAlfa;

          |ABRE #701;
          #701#0 = #dsam0000#0;
          |LEE 101#701=;
          |SI FSalida = 0;
              #701#57 = #10#19;
              #701#74 = #10#20;
              #701#75 = #10#21;
              |GRABA 020#701a;
              |LIBERA #701;
          |FINSI;
          |CIERRA #701;
     |FINSI;
|FPRC;

|DEFBUCLE dsam0000;
 #dsam0000#1;
 ;
 #dsaz0024#1;
 #dsaz0024#2;
 ;
 NULL, dsam0000;
|FIN;


|PROCESO Principal;
     |ABRE #dsam0010;
     |BUCLE dsam0000;
     |CIERRA #dsam0010;
|FPRC;

|PROCESO Tipo0C3;
     |ABRE #200;
     #200#0 = #dsaz0024#3;
     |LEE 040#200=;
     |SI FSalida ! 0;
         |CIERRA #200;
         |MENAV "     No existe Empresa de Facturacion";
         |ERROR;
         |ACABA;
     |FINSI;
     |CIERRA #200;

     |SI #200#3 ! "S";
         |MENAV "     La Empresa no esta activada en la PI";
         |ERROR;
         |ACABA;
     |FINSI;

     #dsaz0024#5 = #200#1;
     |PINTA #dsaz0024#5;
|FPRC;


|PROGRAMA;
     |CLS;
     |ABRE #24;
     |DDEFECTO #24;
     |LEE 101#24p;
     nExiste = FSalida;
     |PINPA #0#24;
     |PINDA #0#24;
     |ENDATOS #1#24;
     |SI FSalida = 0;
          aRespuesta = #dsaz0024#4;
          #dsaz0024#4 = "NO";
          |SI nExiste = 0;
               |GRABA 020#24.a;
          |SINO;
               |GRABA 020#24.n;
          |FINSI;
          |SI aRespuesta = "SI";
               |HAZ Principal;
          |FINSI;
     |FINSI;
     |LIBERA #24;
     |CIERRA #24;
|FPRO;
