|FICHEROS;
     dsaz0012;
     dsam0000;
     dsam0003;
     dsam0004;
     dsam0005;
     dsam0103;
     dsam0105;
     dsam0106;
     dsam0107;

     :/laboral/def/labtraba;

     :/contagen/def/canempre;
     :/contagen/def/camandia;
     :/contagen/def/cacuenta;
     :/contagen/def/caclipro;
     :/contagen/def/caivaasi;

     :/basica/def/agicen15;
     :/basica/def/agicen17;
     :/basica/def/agidanif;
     :/basica/def/agim0004;
     :/basica/def/agim0021;
     :/basica/def/agim0024;
     :/basica/def/agim0025;
     :/basica/def/agim0026;
     :/basica/def/agim0027;

     :/modelos/def/dsm180li;
     :/modelos/def/dsm18404;
     :/modelos/def/dsm18407;
     :/modelos/def/dsm190li;
     :/modelos/def/dsm193ga;
     :/modelos/def/dsm193li;
     :/modelos/def/dsmo2347;
     :/modelos/def/dsmo3347;
     :/modelos/def/dsmoc110;
     :/modelos/def/dsmoc115;
     :/modelos/def/dsmoc123;
     :/modelos/def/dsmoc349;
     :/modelos/def/dsmom004;

     :/modelos/def/dsmoc111;
     :/modelos/def/dsm11101;
     :/modelos/def/dsm19001;

     Ref0001@;
     Ref0002@;
|FIN;

|VARIABLES;
     nCampo1            = 0;
     nCampo2            = 0;
     nCampo3            = 0;
     nFiscal            = 0;
     nEnvio             = 0;
     nCanal             = 0;
     nPer               = 0;

     aBase              = "";
     aAlfa              = "";
     aAlfa1             = "";
     aPath              = "";
     aMas               = "";
     aPathFich          = "";

     &eaNif             = "";
     &eaCadena          = "";
     &eaCadena1         = "";
     &eaCadena2         = "";
     &eaCadena3         = "";
     &eaPathContagen    = "";
     &eaPathBasica      = "";
     &eaPathLaboral     = "";
     &eaPathModelo      = "";
|FIN;

|PROCESO BusApli;
     eaPathContagen  = "";
     eaPathBasica    = "";
     eaPathLaboral   = "";
     eaPathModelo    = "";

     |DBASS aBase;   |QBF aBase;

     aAlfa1 = aBase + "basica/def/agifigen.mas";
     |XABRE "E", aAlfa1, nCanal;
     |SI FSalida ] 0;
         eaPathBasica = aBase + "basica/";
     |FINSI;

     aAlfa1 = aBase + "contagen/def/canempre.mas";
     |XABRE "E", aAlfa1, nCanal;
     |SI FSalida ] 0;
         eaPathContagen = aBase + "contagen/";
     |FINSI;

     aAlfa1 = aBase + "laboral/def/labempre.mas";
     |XABRE "E", aAlfa1, nCanal;
     |SI FSalida ] 0;
         eaPathLaboral = aBase + "laboral/";
     |FINSI;

     aAlfa1 = aBase + "modelos/def/dsmoc115.mas";
     |XABRE "E", aAlfa1, nCanal;
     |SI FSalida ] 0;
         eaPathModelo  = aBase + "modelos/";
     |FINSI;
|FPRC;

|PROCESO dsam0004;
     #dsam0004#3 = #dsam0103#1;
     |GRABA 020#dsam0004.a;
     |LIBERA #dsam0004;
|FPRC;

|DEFBUCLE dsam0004;
     #dsam0004#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsam0004;
|FIN;

|PROCESO dsam0105;
     #dsam0105#2  = #dsam0103#1;
     #dsam0105#3  = #dsam0103#9;
     #dsam0105#4  = #dsam0103#2;
     #dsam0105#5  = #dsam0103#3;
     #dsam0105#6  = #dsam0103#10;
     #dsam0105#7  = #dsam0103#11;
     #dsam0105#8  = #dsam0103#4;
     #dsam0105#9  = #dsam0103#5;
     #dsam0105#10 = #dsam0103#6;
     #dsam0105#11 = #dsam0103#7;
     #dsam0105#12 = #dsam0103#8;
     |GRABA 020#dsam0105.a;
     |LIBERA #dsam0105;
|FPRC;

|DEFBUCLE dsam0105;
     #dsam0105#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsam0105;
|FIN;

|PROCESO dsam0003;
     eaCadena = #dsam0103#1;  |HAZ SeparaNombreDer;
     #dsam0003#36 = eaCadena1;
     #dsam0003#37 = eaCadena2;
     #dsam0003#38 = eaCadena3;
     #dsam0003#39 = #dsam0103#1;
     #dsam0003#44 = #dsam0103#9;
     #dsam0003#45 = #dsam0103#2;
     #dsam0003#46 = #dsam0103#3;
     #dsam0003#47 = #dsam0103#16;
     #dsam0003#48 = #dsam0103#10;
     #dsam0003#49 = #dsam0103#11;
     #dsam0003#50 = #dsam0103#4;
     #dsam0003#51 = #dsam0103#5;
     #dsam0003#52 = #dsam0103#6;
     |GRABA 020#dsam0003.a;
     |LIBERA #dsam0003;
|FPRC;

|DEFBUCLE dsam0003;
     #dsam0003#3;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsam0003;
|FIN;

|PROCESO dsam0107;
     #dsam0107#0 = #dsam0103#1;
     |GRABA 000#dsam0107.n;
     |LIBERA #dsam0107;
|FPRC;

|DEFBUCLE dsam0107;
     #dsam0107#1;
     ;
     #dsam0000#1, 00;
     #dsam0000#1, 99;
     be;
     NULL, dsam0107;
|FIN;

|PROCESO dsam0000;
     nFiscal = 1;
     nEnvio  = 1;
     |PARA nCampo1 = 19;  |SI nCampo1 [ 28;  |HACIENDO nCampo1 = nCampo 1 + 1;
           nCampo2 = nCampo1 + 10;
           nCampo3 = nCampo1 + 20;
           |SI #dsam0000#nCampo1# ! #dsam0000#nCampo2#;  nFiscal = 0;  |FINSI;
           |SI #dsam0000#nCampo1# ! #dsam0000#nCampo3#;  nEnvio  = 0;  |FINSI;
     |SIGUE;

     |ABRE #dsam0005;
     #dsam0005#0 = #dsam0000#0;
     #dsam0005#1 = 97;
     |LEE 101#dsam0005.=;
     |SI FSalida = 0;
         #dsam0005#3  = #dsam0103#9;
         #dsam0005#4  = #dsam0103#2;
         #dsam0005#5  = #dsam0103#3;
         #dsam0005#6  = #dsam0103#16;
         #dsam0005#7  = #dsam0103#10;
         #dsam0005#8  = #dsam0103#11;
         #dsam0005#9  = #dsam0103#4;
         #dsam0005#10 = #dsam0103#5;
         #dsam0005#11 = #dsam0103#6;
         #dsam0005#12 = #dsam0103#7;
         #dsam0005#15 = #dsam0103#14;
         #dsam0005#16 = #dsam0103#15;
         #dsam0005#17 = #dsam0103#12;
         #dsam0005#18 = #dsam0103#13;
         |GRABA 020#dsam0005.a;
         |LIBERA #dsam0005;

         #dsam0000#19  = #dsam0005#3;    #dsam0000#20  = #dsam0005#4;   #dsam0000#21  = #dsam0005#5;   #dsam0000#22  = #dsam0005#6;
         #dsam0000#23  = #dsam0005#7;    #dsam0000#24  = #dsam0005#8;   #dsam0000#25  = #dsam0005#9;   #dsam0000#26  = #dsam0005#10;
         #dsam0000#27  = #dsam0005#11;   #dsam0000#28  = #dsam0005#12;  #dsam0000#98  = #dsam0005#17;  #dsam0000#99  = #dsam0005#18;
         #dsam0000#86  = #dsam0005#15;   #dsam0000#87  = #dsam0005#16;
     |FINSI;

     |SI nFiscal = 1;
         #dsam0005#0 = #dsam0000#0;
         #dsam0005#1 = 98;
         |LEE 101#dsam0005.=;
         |SI FSalida = 0;
             #dsam0005#3  = #dsam0103#9;
             #dsam0005#4  = #dsam0103#2;
             #dsam0005#5  = #dsam0103#3;
             #dsam0005#6  = #dsam0103#16;
             #dsam0005#7  = #dsam0103#10;
             #dsam0005#8  = #dsam0103#11;
             #dsam0005#9  = #dsam0103#4;
             #dsam0005#10 = #dsam0103#5;
             #dsam0005#11 = #dsam0103#6;
             #dsam0005#12 = #dsam0103#7;
             #dsam0005#15 = #dsam0103#14;
             #dsam0005#16 = #dsam0103#15;
             #dsam0005#17 = #dsam0103#12;
             #dsam0005#18 = #dsam0103#13;
             |GRABA 020#dsam0005.a;
             |LIBERA #dsam0005;

             #dsam0000#29 = #dsam0005#3;    #dsam0000#30 = #dsam0005#4;    #dsam0000#31 = #dsam0005#5;    #dsam0000#32 = #dsam0005#6;
             #dsam0000#33 = #dsam0005#7;    #dsam0000#34 = #dsam0005#8;    #dsam0000#35 = #dsam0005#9;    #dsam0000#36 = #dsam0005#10;
             #dsam0000#37 = #dsam0005#11;   #dsam0000#38 = #dsam0005#12;
         |FINSI;
     |FINSI;

     |SI nEnvio = 1;
         #dsam0005#0 = #dsam0000#0;
         #dsam0005#1 = 99;
         |LEE 101#dsam0005.=;
         |SI FSalida = 0;
             #dsam0005#3  = #dsam0103#9;
             #dsam0005#4  = #dsam0103#2;
             #dsam0005#5  = #dsam0103#3;
             #dsam0005#6  = #dsam0103#16;
             #dsam0005#7  = #dsam0103#10;
             #dsam0005#8  = #dsam0103#11;
             #dsam0005#9  = #dsam0103#4;
             #dsam0005#10 = #dsam0103#5;
             #dsam0005#11 = #dsam0103#6;
             #dsam0005#12 = #dsam0103#7;
             #dsam0005#15 = #dsam0103#14;
             #dsam0005#16 = #dsam0103#15;
             #dsam0005#17 = #dsam0103#12;
             #dsam0005#18 = #dsam0103#13;
             |GRABA 020#dsam0005.a;
             |LIBERA #dsam0005;

             #dsam0000#39 = #dsam0005#3;   #dsam0000#40 = #dsam0005#4;   #dsam0000#41 = #dsam0005#5;   #dsam0000#42 = #dsam0005#6;
             #dsam0000#43 = #dsam0005#7;   #dsam0000#44 = #dsam0005#8;   #dsam0000#45 = #dsam0005#9;   #dsam0000#46 = #dsam0005#10;
             #dsam0000#47 = #dsam0005#11;  #dsam0000#48 = #dsam0005#12;
         |FINSI;
     |FINSI;
     |CIERRA #dsam0005;

     |SI #dsam0000#1 ! #dsam0103#1;
         |BUCLE dsam0107;

         |ABRE #dsam0106;
         #dsam0106#0 = #dsam0103#0;
         |LEE 101#dsam0106.=;
         |SI FSalida ! 0;
             |DDEFECTO #dsam0106;
             #dsam0106#0 = #dsam0103#0;
             |GRABA 020#dsam0106.n;
         |FINSI;
         |LIBERA #dsam0106;
         |CIERRA #dsam0106;

         #dsam0000#1 = #dsam0103#1;
     |FINSI;

     |GRABA 020#dsam0000.a;
     |LIBERA #dsam0000;

     |HAZ GrabaOtrasApli;

     |ABRE #dsam0003;
     #dsam0003#0 = #dsam0000#0;
     |LEE 101#dsam0003.=;
     |SI FSalida = 0;
         eaCadena = #dsam0103#1;  |HAZ SeparaNombreDer;
         #dsam0003#2  = eaCadena1;
         #dsam0003#3  = eaCadena2;
         #dsam0003#4  = eaCadena3;
         #dsam0003#5  = #dsam0103#1;
         #dsam0003#14 = #dsam0103#9;
         #dsam0003#15 = #dsam0103#2;
         #dsam0003#16 = #dsam0103#3;
         #dsam0003#17 = #dsam0103#16;
         #dsam0003#18 = #dsam0103#10;
         #dsam0003#19 = #dsam0103#11;
         #dsam0003#20 = #dsam0103#4;
         #dsam0003#21 = #dsam0103#5;
         #dsam0003#22 = #dsam0103#6;
         #dsam0003#23 = (("00" + #dsam0003#20) % -102) + (("000" + #dsam0003#21) % -103);

         #dsam0003#24 = #dsam0000#39;
         #dsam0003#25 = #dsam0000#40;
         #dsam0003#26 = #dsam0000#41;
         #dsam0003#27 = #dsam0000#42;
         #dsam0003#28 = #dsam0000#43;
         #dsam0003#29 = #dsam0000#44;
         #dsam0003#30 = #dsam0000#45;
         #dsam0003#31 = #dsam0000#46;
         #dsam0003#32 = #dsam0000#47;
         #dsam0003#33 = (("00" + #dsam0003#30) % -102) + (("000" + #dsam0003#31) % -103);
         |GRABA 020#dsam0003.a;
         |LIBERA #dsam0003;
     |FINSI;
     |CIERRA #dsam0003;
|FPRC;

|DEFBUCLE dsam0000;
     #dsam0000#3;
     ;
     eaNif;
     eaNif;
     ;
     NULL, dsam0000;
|FIN;

|PROCESO Integral;
     |BUCLE dsam0000;
     |BUCLE dsam0003;
     |BUCLE dsam0004;
     |BUCLE dsam0105;
|FPRC;

|PROCESO labtraba;
     #labtraba#2   = #dsam0103#1;
     |SI #dsam0103#9  ! "  ";
         #labtraba#3   = #dsam0103#9 + " " + #dsam0103#2;
     |SINO;
         #labtraba#3   = #dsam0103#2;
     |FINSI;
     #labtraba#4   = #dsam0103#3;
     #labtraba#5   = #dsam0103#10;
     #labtraba#6   = #dsam0103#6;
     #labtraba#8   = #dsam0103#4;
     #labtraba#9   = #dsam0103#5;
     #labtraba#10  = #dsam0103#7;
     |GRABA 020#labtraba.a;
     |LIBERA #labtraba;
|FPRC;

|DEFBUCLE labtraba;
     #labtraba#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, labtraba;
|FIN;

|PROCESO Laboral;
     |BUCLE labtraba;
|FPRC;

|PROCESO caclipro;
     #caclipro#1 = #dsam0103#1;

     aAlfa = #dsam0103#9;  |QBF aAlfa;
     |SI aAlfa = "";
         #caclipro#2 = #dsam0103#2;
     |SINO;
         #caclipro#2 = aAlfa + " " + #dsam0103#2;
     |FINSI;
     aAlfa = #caclipro#2; |QBF aAlfa;
     #caclipro#2 = aAlfa + ", " + #dsam0103#3;

     aAlfa = #caclipro#2; |QBF aAlfa;
     #caclipro#2 = aAlfa + " " + #dsam0103#10;

     aAlfa = #caclipro#2; |QBF aAlfa;
     #caclipro#2 = aAlfa + " " + #dsam0103#11;

     #caclipro#3  = #dsam0103#4;
     #caclipro#4  = #dsam0103#5;
     #caclipro#5  = #dsam0103#7;
     #caclipro#6  = #dsam0103#6;
     #caclipro#7  = #dsam0103#8;
     #caclipro#24 = #dsam0103#12;
     #caclipro#25 = (("00" + #caclipro#4) % -102) + (("000" + #caclipro#5) % -103);

     |GRABA 020#caclipro.a;
     |LIBERA #caclipro;

     #cacuenta#0 = #caclipro#10;
     |LEE 101#cacuenta.=;
     |SI FSalida = 0;
         #cacuenta#2 = #dsam0103#1;
         |GRABA 020#cacuenta.a;
     |FINSI;
     |LIBERA #cacuenta;
|FPRC;

|DEFBUCLE caclipro;
     #caclipro#4;
     ;
     eaNif;
     eaNif;
     be;
     NULL, caclipro;
|FIN;

|PROCESO agifa024;
     aAlfa = #dsam0103#9;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = aAlfa + " ";
     |FINSI;

     aAlfa = aAlfa + #dsam0103#2;  |QBF aAlfa;
     |SI #dsam0103#3 ! "    ";
         aAlfa = aAlfa + ", " + #dsam0103#3;  |QBF aAlfa;
     |FINSI;

     |SI #dsam0103#10 ! "   ";
         aAlfa = aAlfa + " " + #dsam0103#10;  |QBF aAlfa;
     |FINSI;

     |SI #dsam0103#11 ! "  ";
         aAlfa = aAlfa + " " + #dsam0103#11;
     |FINSI;

     #Ref0001@#1   = #dsam0103#1;
     #Ref0001@#2   = #dsam0103#1;

     #Ref0001@#17  = #dsam0103#8;
     #Ref0001@#18  = #dsam0103#17;
     #Ref0001@#205 = #dsam0103#12;
     #Ref0001@#14  = #dsam0103#13;

     |SI #Ref0001@#8   = #Ref0001@#5;
         #Ref0001@#5   = aAlfa;
     |FINSI;

     |SI #Ref0001@#8   = #Ref0001@#11;
         #Ref0001@#11  = aAlfa;
     |FINSI;

     #Ref0001@#8   = aAlfa;

     |SI #Ref0001@#181 = #Ref0001@#178;
         #Ref0001@#178 = #dsam0103#4;
     |FINSI;

     |SI #Ref0001@#181 = #Ref0001@#184;
         #Ref0001@#184 = #dsam0103#4;
     |FINSI;

     #Ref0001@#181 = #dsam0103#4;

     |SI #Ref0001@#182 = #Ref0001@#179;
         #Ref0001@#179 = #dsam0103#5;
     |FINSI;

     |SI #Ref0001@#182 = #Ref0001@#185;
         #Ref0001@#185 = #dsam0103#5;
     |FINSI;

     #Ref0001@#182 = #dsam0103#5;

     |SI #Ref0001@#10  = #Ref0001@#7;
         #Ref0001@#7   = #dsam0103#7;
     |FINSI;

     |SI #Ref0001@#10  = #Ref0001@#13;
         #Ref0001@#13  = #dsam0103#7;
     |FINSI;

     #Ref0001@#10  = #dsam0103#7;

     |SI #Ref0001@#9   = #Ref0001@#6;
         #Ref0001@#6   = #dsam0103#6;
     |FINSI;

     |SI #Ref0001@#9   = #Ref0001@#12;
         #Ref0001@#12  = #dsam0103#6;
     |FINSI;

     #Ref0001@#9   = #dsam0103#6;

     aAlfa = (("00" + #Ref0001@#178) % -102);
     aAlfa = aAlfa + (("000" + #Ref0001@#179) % -103);
     #Ref0001@#180 = aAlfa;

     aAlfa = (("00" + #Ref0001@#181) % -102);
     aAlfa = aAlfa + (("000" + #Ref0001@#182) % -103);
     #Ref0001@#183 = aAlfa;

     aAlfa = (("00" + #Ref0001@#184) % -102);
     aAlfa = aAlfa + (("000" + #Ref0001@#185) % -103);
     #Ref0001@#186 = aAlfa;

     |GRABA 020#Ref0001@.a;
     |LIBERA #Ref0001@;

     |ABRE #Ref0002@;
     #Ref0002@#0  = #Ref0001@#0;
     #Ref0002@#1  = 1;
     |LEE 101#Ref0002@.=;
     |SI FSalida ! 0;
         |DDEFECTO #Ref0002@;
         #Ref0002@#0  = #Ref0001@#0;
         #Ref0002@#1  = 1;
         |GRABA 020#Ref0002@.b;
     |FINSI;

     #Ref0002@#2  = #Ref0001@#5;
     #Ref0002@#3  = #Ref0001@#6;
     #Ref0002@#4  = #Ref0001@#178;
     #Ref0002@#5  = #Ref0001@#179;
     #Ref0002@#6  = #Ref0001@#180;
     #Ref0002@#7  = #Ref0001@#7;
     #Ref0002@#8  = #Ref0001@#14;
     #Ref0002@#10 = #Ref0001@#2;
     #Ref0002@#11 = #Ref0001@#3;
     #Ref0002@#13 = #Ref0001@#17;
     #Ref0002@#14 = #Ref0001@#25;
     #Ref0002@#16 = #Ref0001@#189;
     #Ref0002@#19 = #Ref0001@#205;
     #Ref0002@#20 = #Ref0001@#196;
     #Ref0002@#21 = #Ref0001@#18;
     #Ref0002@#22 = #Ref0001@#36;
     #Ref0002@#23 = #Ref0001@#211;
     #Ref0002@#24 = #Ref0001@#197;

     |GRABA 020#Ref0002@.a;
     |CIERRA #Ref0002@;
|FPRC;

|DEFBUCLE agifa024;
     #Ref0001@#4001;
     ;
     eaNif;
     eaNif;
     be;
     NULL, agifa024;
|FIN;

|PROCESO agifa112;
     aAlfa = #dsam0103#9;  |QBF aAlfa;
     |SI aAlfa ! "";
         aAlfa = aAlfa + " ";
     |FINSI;

     aAlfa = aAlfa + #dsam0103#2;  |QBF aAlfa;
     |SI #dsam0103#3 ! "    ";
         aAlfa = aAlfa + ", " + #dsam0103#3;  |QBF aAlfa;
     |FINSI;

     |SI #dsam0103#10 ! "   ";
         aAlfa = aAlfa + " " + #dsam0103#10;  |QBF aAlfa;
     |FINSI;

     |SI #dsam0103#11 ! "  ";
         aAlfa = aAlfa + " " + #dsam0103#11;
     |FINSI;

     #Ref0001@#1   = #dsam0103#1;
     #Ref0001@#2   = #dsam0103#1;
     #Ref0001@#3   = aAlfa;
     #Ref0001@#74  = #dsam0103#4;
     #Ref0001@#75  = #dsam0103#5;
     #Ref0001@#89  = #dsam0103#12;
     #Ref0001@#5   = #dsam0103#7;
     #Ref0001@#4   = #dsam0103#6;
     #Ref0001@#6   = #dsam0103#8;
     #Ref0001@#7   = #dsam0103#17;

     |GRABA 020#Ref0001@.a;
     |LIBERA #Ref0001@;
|FPRC;

|DEFBUCLE agifa112;
     #Ref0001@#6001;
     ;
     eaNif;
     eaNif;
     be;
     NULL, agifa112;
|FIN;

|PROCESO dscomer9;
     aMas = aBase + "dscomer9/def/agifa024.mas";
     |XABRE "E", aMas, 0;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     |CARGA_DEF aMas, Ref0001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aMas = aBase + "dscomer9/def/dsm00003.mas";
     |CARGA_DEF aMas, Ref0002@;

     aPath     = eaPathContagen;
     aPathFich = aBase + "dscomer9/fich/" + (("00000" + #canempre#2) % -105) + "/";
     |PATH_DAT #Ref0001@#aPathFich#;
     |PATH_DAT #Ref0002@#aPathFich#;
     |BUCLE agifa024;
     |DESCARGA_DEF #Ref0002@;
     |DESCARGA_DEF #Ref0001@;

     aMas = aBase + "dscomer9/def/agifa112.mas";
     |CARGA_DEF aMas, Ref0001@;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     aPath     = eaPathContagen;
     aPathFich = aBase + "dscomer9/fich/" + (("00000" + #canempre#2) % -105) + "/";
     |PATH_DAT #Ref0001@#aPathFich#;
     |BUCLE agifa112;
     |DESCARGA_DEF #Ref0001@;
|FPRC;

|PROCESO canempre;
     aPath     = eaPathContagen;
     aPathFich = aPath + "fich/" + (("00000" + #canempre#2) % -105) + #canempre#3 + "/";

     |PATH_DAT #camandia#aPathFich#;

     |ABRE #camandia;
     #camandia#0 = 99;
     |LEE 040#camandia.=;
     |SI FSalida = 0;  |Y #camandia#2 ! 0;  |Y #camandia#3 ! 0;
         |CIERRA #camandia;
         |ACABA;
     |FINSI;
     |CIERRA #camandia;

     |PATH_DAT #cacuenta#aPathFich#;
     |ABRE #cacuenta;
     |LEE 000#cacuenta.p;
     |SI FSalida ! 0;
         |CIERRA #cacuenta;
         |ACABA;
     |FINSI;
     |CIERRA #cacuenta;

     |PATH_DAT #caclipro#aPathFich#;

     |ABRE #cacuenta;
     |BUCLE caclipro;
     |CIERRA #cacuenta;

     |PATH_DAT #caivaasi#aPathFich#;
     |ABRE #caivaasi;
     |LEE 000#caivaasi.p;
     |SI FSalida ! 0;  |DDEFECTO #caivaasi;  |FINSI;
     |CIERRA #caivaasi;

     |SI #caivaasi#191 = "S";
         |HAZ dscomer9;
     |FINSI;
|FPRC;

|DEFBUCLE canempre;
     #canempre#1;
     ;
     00001, 0;
     99999, 9;
     ;
     NULL, canempre;
|FIN

|PROCESO Contabilidad;
     |BUCLE canempre;
|FPRC;

|PROCESO agicen15;
     #agicen15#5  = #dsam0103#1;
     #agicen15#8  = #dsam0103#9;
     #agicen15#9  = #dsam0103#2;
     #agicen15#10 = #dsam0103#3;
     #agicen15#11 = #dsam0103#16;
     #agicen15#12 = #dsam0103#10;
     #agicen15#13 = #dsam0103#11;
     #agicen15#14 = #dsam0103#8;
     #agicen15#15 = #dsam0103#4;
     #agicen15#16 = #dsam0103#5;

     |GRABA 020#agicen15.a;
     |LIBERA #agicen15;
|FPRC;

|DEFBUCLE agicen15;
     #agicen15#2;
     ;
     eaNif, 00001;
     eaNif, 99999;
     be;
     NULL, agicen15;
|FIN;

|PROCESO agicen17;
     #agicen17#5  = #dsam0103#1;
     |GRABA 020#agicen17.a;
     |LIBERA #agicen17;
|FPRC;

|DEFBUCLE agicen17;
     #agicen17#2;
     ;
     eaNif, 00000, 00;
     eaNif, 99999, 99;
     be;
     NULL, agicen17;
|FIN;

|PROCESO agidanif;
     #agidanif#12 = #dsam0103#1;
     #agidanif#19 = #dsam0103#14;
     #agidanif#24 = #dsam0103#9;
     #agidanif#25 = #dsam0103#2;
     #agidanif#26 = #dsam0103#3;
     #agidanif#27 = #dsam0103#16;
     #agidanif#28 = #dsam0103#10;
     #agidanif#29 = #dsam0103#11;
     #agidanif#30 = #dsam0103#4;
     #agidanif#31 = #dsam0103#5;
     #agidanif#32 = #dsam0103#6;
     #agidanif#33 = #dsam0103#7;
     #agidanif#34 = #dsam0103#8;

     eaCadena = #agidanif#12;
     |HAZ SeparaNombreDer;
     #agidanif#9    = eaCadena1;
     #agidanif#10   = eaCadena2;
     #agidanif#11   = eaCadena3;

     |GRABA 020#agidanif.a;
     |LIBERA #agidanif;
|FPRC;

|DEFBUCLE agidanif;
     #agidanif#3;
     ;
     eaNif;
     eaNif;
     be;
     NULL, agidanif;
|FIN;

|PROCESO agim0004;
     #agim0004#3  = #dsam0103#1;
     #agim0004#6  = #dsam0103#2;
     #agim0004#7  = #dsam0103#3;
     #agim0004#8  = #dsam0103#4;
     #agim0004#9  = #dsam0103#5;
     #agim0004#10 = #dsam0103#6;
     #agim0004#11 = #dsam0103#7;
     #agim0004#12 = #dsam0103#8;

     |GRABA 020#agim0004.a;
     |LIBERA #agim0004;
|FPRC;

|DEFBUCLE agim0004;
     #agim0004#2;
     ;
     eaNif, 00001;
     eaNif, 99999;
     be;
     NULL, agim0004;
|FIN;

|PROCESO agim0021;
     #agim0021#6  = #dsam0103#1;

     |GRABA 020#agim0021.a;
     |LIBERA #agim0021;
|FPRC;

|DEFBUCLE agim0021;
     #agim0021#2;
     ;
     eaNif, 00001;
     eaNif, 99999;
     be;
     NULL, agim0021;
|FIN;

|PROCESO agim0024;
     #agim0024#4  = #dsam0103#1;
     #agim0024#7  = #dsam0103#2;
     #agim0024#8  = #dsam0103#3;
     #agim0024#9  = #dsam0103#4;
     #agim0024#10 = #dsam0103#5;
     #agim0024#11 = #dsam0103#6;
     #agim0024#12 = #dsam0103#7;
     #agim0024#13 = #dsam0103#8;

     |GRABA 020#agim0024.a;
     |LIBERA #agim0024;
|FPRC;

|DEFBUCLE agim0024;
     #agim0024#3;
     ;
     eaNif, 00000;
     eaNif, 99999;
     be;
     NULL, agim0024;
|FIN;

|PROCESO agim0025;
     #agim0025#4  = #dsam0103#1;
     #agim0025#5  = #dsam0103#2;
     #agim0025#6  = #dsam0103#3;
     #agim0025#7  = #dsam0103#4;
     #agim0025#8  = #dsam0103#5;
     #agim0025#9  = #dsam0103#6;
     #agim0025#10 = #dsam0103#7;
     #agim0025#11 = #dsam0103#8;

     |GRABA 020#agim0025.a;
     |LIBERA #agim0025;
|FPRC;

|DEFBUCLE agim0025;
     #agim0025#3;
     ;
     eaNif, 00000;
     eaNif, 99999;
     be;
     NULL, agim0025;
|FIN;

|PROCESO agim0026;
     #agim0026#4  = #dsam0103#1;
     #agim0026#5  = #dsam0103#2;
     #agim0026#6  = #dsam0103#3;
     #agim0026#7  = #dsam0103#4;
     #agim0026#8  = #dsam0103#5;
     #agim0026#9  = #dsam0103#6;
     #agim0026#10 = #dsam0103#7;
     #agim0026#11 = #dsam0103#8;

     |GRABA 020#agim0026.a;
     |LIBERA #agim0026;
|FPRC;

|DEFBUCLE agim0026;
     #agim0026#3;
     ;
     eaNif, 00000;
     eaNif, 99999;
     be;
     NULL, agim0026;
|FIN;

|PROCESO agim0027;
     #agim0027#4  = #dsam0103#1;

     |GRABA 020#agim0027.a;
     |LIBERA #agim0027;
|FPRC;

|DEFBUCLE agim0027;
     #agim0027#2;
     ;
     eaNif, 00000;
     eaNif, 99999;
     be;
     NULL, agim0027;
|FIN;

|PROCESO Basica;
     |BUCLE agicen15;
     |BUCLE agicen17;
     |BUCLE agidanif;
     |BUCLE agim0004;
     |BUCLE agim0021;
     |BUCLE agim0024;
     |BUCLE agim0025;
     |BUCLE agim0026;
     |BUCLE agim0027;
|FPRC;

|PROCESO dsm180li;
     #dsmom004#0 = #dsm180li#0;
     #dsmom004#1 = #dsm180li#1;
     #dsmom004#2 = #dsm180li#2;
     #dsmom004#3 = #dsm180li#3;
     #dsmom004#4 = #dsm180li#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm180li#10 = #dsam0103#1;
     #dsm180li#14 = #dsam0103#4;

     |GRABA 020#dsm180li.a;
     |LIBERA #dsm180li;
|FPRC;

|DEFBUCLE dsm180li;
     #dsm180li#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm180li;
|FIN;

|PROCESO dsm18404;
     #dsmom004#0 = #dsm18404#0;
     #dsmom004#1 = #dsm18404#1;
     #dsmom004#2 = 99;
     #dsmom004#3 = 184;
     #dsmom004#4 = #dsm18404#2;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm18404#5 = #dsam0103#1;

     |GRABA 020#dsm18404.a;
     |LIBERA #dsm18404;
|FPRC;

|DEFBUCLE dsm18404;
     #dsm18404#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm18404;
|FIN;

|PROCESO dsm18407;
     #dsmom004#0 = #dsm18407#0;
     #dsmom004#1 = #dsm18407#1;
     #dsmom004#2 = 99;
     #dsmom004#3 = 184;
     #dsmom004#4 = #dsm18407#2;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm18407#5 = #dsam0103#1;

     |GRABA 020#dsm18407.a;
     |LIBERA #dsm18407;
|FPRC;

|DEFBUCLE dsm18407;
     #dsm18407#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm18407;
|FIN;

|PROCESO dsm190li;
     #dsmom004#0 = #dsm190li#0;
     #dsmom004#1 = #dsm190li#1;
     #dsmom004#2 = #dsm190li#2;
     #dsmom004#3 = #dsm190li#3;
     #dsmom004#4 = #dsm190li#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm190li#12 = #dsam0103#1;
     #dsm190li#13 = #dsam0103#4;

     |GRABA 020#dsm190li.a;
     |LIBERA #dsm190li;
|FPRC;

|DEFBUCLE dsm190li;
     #dsm190li#4;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm190li;
|FIN;

|PROCESO dsm19001;
     #dsmom004#0 = #dsm19001#0;
     #dsmom004#1 = #dsm19001#1;
     #dsmom004#2 = #dsm19001#2;
     #dsmom004#3 = #dsm19001#3;
     #dsmom004#4 = #dsm19001#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm19001#12 = #dsam0103#1;
     #dsm19001#13 = #dsam0103#4;

     |GRABA 020#dsm19001.a;
     |LIBERA #dsm19001;
|FPRC;

|DEFBUCLE dsm19001;
     #dsm19001#4;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm19001;
|FIN;

|PROCESO dsm193ga;
     #dsmom004#0 = #dsm193ga#0;
     #dsmom004#1 = #dsm193ga#1;
     #dsmom004#2 = #dsm193ga#2;
     #dsmom004#3 = #dsm193ga#3;
     #dsmom004#4 = #dsm193ga#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm193ga#8  = #dsam0103#1;

     |GRABA 020#dsm193ga.a;
     |LIBERA #dsm193ga;
|FPRC;

|DEFBUCLE dsm193ga;
     #dsm193ga#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm193ga;
|FIN;

|PROCESO dsm193li;
     #dsmom004#0 = #dsm193li#0;
     #dsmom004#1 = #dsm193li#1;
     #dsmom004#2 = #dsm193li#2;
     #dsmom004#3 = #dsm193li#3;
     #dsmom004#4 = #dsm193li#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsm193li#12 = #dsam0103#1;
     #dsm193li#14 = #dsam0103#4;

     |GRABA 020#dsm193li.a;
     |LIBERA #dsm193li;
|FPRC;

|DEFBUCLE dsm193li;
     #dsm193li#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm193li;
|FIN;

|PROCESO dsmo2347;
     #dsmom004#0 = #dsmo2347#0;
     #dsmom004#1 = #dsmo2347#1;
     #dsmom004#2 = #dsmo2347#2;
     #dsmom004#3 = #dsmo2347#3;
     #dsmom004#4 = #dsmo2347#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsmo2347#11 = #dsam0103#1;

     |GRABA 020#dsmo2347.a;
     |LIBERA #dsmo2347;
|FPRC;

|DEFBUCLE dsmo2347;
     #dsmo2347#4;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmo2347;
|FIN;

|PROCESO dsmo3347;
     #dsmom004#0 = #dsmo3347#0;
     #dsmom004#1 = #dsmo3347#1;
     #dsmom004#2 = #dsmo3347#2;
     #dsmom004#3 = #dsmo3347#3;
     #dsmom004#4 = #dsmo3347#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsmo3347#8 = #dsam0103#1;

     |GRABA 020#dsmo3347.a;
     |LIBERA #dsmo3347;
|FPRC;

|DEFBUCLE dsmo3347;
     #dsmo3347#4;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmo3347;
|FIN;

|PROCESO dsmoc110;
     #dsmom004#0 = #dsmoc110#0;
     #dsmom004#1 = #dsmoc110#1;
     #dsmom004#2 = #dsmoc110#2;
     #dsmom004#3 = #dsmoc110#3;
     #dsmom004#4 = #dsmoc110#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsmoc110#29 = #dsam0103#1;

     |GRABA 020#dsmoc110.a;
     |LIBERA #dsmoc110;
|FPRC;

|DEFBUCLE dsmoc110;
     #dsmoc110#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmoc110;
|FIN;

|PROCESO dsmoc111;
     #dsmom004#0 = #dsmoc111#0;
     #dsmom004#1 = #dsmoc111#1;
     #dsmom004#2 = #dsmoc111#2;
     #dsmom004#3 = #dsmoc111#3;
     #dsmom004#4 = #dsmoc111#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     |GRABA 020#dsmoc111.a;
     |LIBERA #dsmoc111;
|FPRC;

|DEFBUCLE dsmoc111;
     #dsmoc111#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmoc111;
|FIN;

|PROCESO dsm11101;
     #dsmom004#0 = #dsm11101#0;
     #dsmom004#1 = #dsm11101#1;
     #dsmom004#2 = #dsm11101#2;
     #dsmom004#3 = #dsm11101#3;
     #dsmom004#4 = #dsm11101#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     |GRABA 020#dsm11101.a;
     |LIBERA #dsm11101;
|FPRC;

|DEFBUCLE dsm11101;
     #dsm11101#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsm11101;
|FIN;

|PROCESO dsmoc115;
     #dsmom004#0 = #dsmoc115#0;
     #dsmom004#1 = #dsmoc115#1;
     #dsmom004#2 = #dsmoc115#2;
     #dsmom004#3 = #dsmoc115#3;
     #dsmom004#4 = #dsmoc115#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsmoc115#26 = #dsam0103#1;

     |GRABA 020#dsmoc115.a;
     |LIBERA #dsmoc115;
|FPRC;

|DEFBUCLE dsmoc115;
     #dsmoc115#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmoc115;
|FIN;

|PROCESO dsmoc123;
     #dsmom004#0 = #dsmoc123#0;
     #dsmom004#1 = #dsmoc123#1;
     #dsmom004#2 = #dsmoc123#2;
     #dsmom004#3 = #dsmoc123#3;
     #dsmom004#4 = #dsmoc123#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     #dsmoc123#21 = #dsam0103#1;

     |GRABA 020#dsmoc123.a;
     |LIBERA #dsmoc123;
|FPRC;

|DEFBUCLE dsmoc123;
     #dsmoc123#2;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmoc123;
|FIN;

|PROCESO dsmoc349;
     |SI #dsmoc349#2 ] 1;  |Y #dsmoc349#2 [ 3;  nPer = 3;  |FINSI;
     |SI #dsmoc349#2 ] 4;  |Y #dsmoc349#2 [ 6;  nPer = 6;  |FINSI;
     |SI #dsmoc349#2 ] 7;  |Y #dsmoc349#2 [ 9;  nPer = 9;  |FINSI;
     |SI #dsmoc349#2 ] 10; |Y #dsmoc349#2 [ 12; nPer = 12; |FINSI;

     #dsmom004#0 = #dsmoc349#0;
     #dsmom004#1 = #dsmoc349#1;
     #dsmom004#2 = nPer;
     #dsmom004#3 = #dsmoc349#3;
     #dsmom004#4 = #dsmoc349#4;
     |LEE 000#dsmom004.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #dsmom004#9 = "X";  |ACABA;  |FINSI;

     |SI #dsam0103#12 !  "   ";
         #dsmoc349#8  = #dsam0103#12;
     |FINSI;

     #dsmoc349#9  = #dsam0103#1;

     |GRABA 020#dsmoc349.a;
     |LIBERA #dsmoc349;
|FPRC;

|DEFBUCLE dsmoc349;
     #dsmoc349#3;
     ;
     eaNif;
     eaNif;
     be;
     NULL, dsmoc349;
|FIN;

|PROCESO Modelos;
     aPath     = eaPathModelo;
     aPathFich = aPath + "fich/";

     |PATH_DAT #dsm180li#aPathFich#;
     |PATH_DAT #dsm18404#aPathFich#;
     |PATH_DAT #dsm18407#aPathFich#;
     |PATH_DAT #dsm190li#aPathFich#;
     |PATH_DAT #dsm193ga#aPathFich#;
     |PATH_DAT #dsm193li#aPathFich#;
     |PATH_DAT #dsmo2347#aPathFich#;
     |PATH_DAT #dsmoc110#aPathFich#;
     |PATH_DAT #dsmoc115#aPathFich#;
     |PATH_DAT #dsmoc123#aPathFich#;
     |PATH_DAT #dsmoc349#aPathFich#;
     |PATH_DAT #dsmom004#aPathFich#;

     |PATH_DAT #dsm19001#aPathFich#;
     |PATH_DAT #dsm11101#aPathFich#;
     |PATH_DAT #dsmoc111#aPathFich#;

     |ABRE #dsmom004;

     |BUCLE dsm180li;
     |BUCLE dsm18404;
     |BUCLE dsm18407;
     |BUCLE dsm190li;
     |BUCLE dsm193ga;
     |BUCLE dsm193li;
     |BUCLE dsmo2347;
     |BUCLE dsmo3347;
     |BUCLE dsmoc110;
     |BUCLE dsmoc115;
     |BUCLE dsmoc123;
     |BUCLE dsmoc349;

     |BUCLE dsm19001;
     |BUCLE dsmoc111;
     |BUCLE dsm11101;

     |CIERRA #dsmom004;
|FPRC;

|PROGRAMA;
     |ABRE #dsam0103;
     #dsam0103#0 = eaNif;
     |LEE 000#dsam0103.=;
     |SI FSalida ! 0;  |CIERRA #dsam0103;  |ACABA;  |FINSI;
     |CIERRA #dsam0103;

     |SI PARAMETRO = "";
         |PINPA #0#dsaz0012;
     |FINSI;

     |HAZ Integral;
     |HAZ BusApli;

     |SI eaPathLaboral  ! "";  |HAZ Laboral;       |FINSI;
     |SI eaPathContagen ! "";  |HAZ Contabilidad;  |FINSI;
     |SI eaPathBasica   ! "";  |HAZ Basica;        |FINSI;
     |SI eaPathModelo   ! "";  |HAZ Modelos;       |FINSI;
|FPRO;
