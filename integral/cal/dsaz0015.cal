|FICHEROS;
     dsaz0015 #15;
     :/integral/def/dsam0000 #0;         || Datos Generales
     :/integral/def/dsam0107 #107;       || Listin telefonico

     :/basica/def/agifigen    #600;      || Datos Contribuyente basica
     :/contagen/def/canempre  #800;      || Empresa Contabilidad
|FIN;


|VARIABLES;
     aAlfa1       = "";
     aTelefL      = "";
     aTelefI      = "";
     nSwGraba     = 0;
|FIN;


|CALCULO HastaC; |TIPO 0;
  |SI #15#1 < #15#0;
      |MENAV "    Error en Seleccion Clientes";
      |ERROR;
  |FINSI;
|FCAL;

|CALCULO HastaP; |TIPO 0;
  |C_M #15#5,0,aAlfa1;
  |SI aAlfa1 = "N"; |ACABA; |FINSI;

  |SI #15#5 < #15#4;
      |MENAV "    Error en Seleccion Periodos";
      |ERROR;
  |FINSI;
|FCAL;

|CALCULO Proc02; |TIPO 0;
    aAlfa1 = #15#2;
    |C_M #15#4, 1, aAlfa1;
    |C_M #15#5, 1, aAlfa1;
|FCAL;
|| ------------------------------------------------------------------

|PROCESO GrabaConta;
     #800#9  = aTelefI;
     |GRABA 020#800a;
     |LIBERA #800;
|FPRC;

|DEFBUCLE canempreG;
     #800#1;
     ;
     #0#0, #15#4;
     #0#0, #15#5;
     be;
     NULL, GrabaConta;
|FIN;

|PROCESO dsam0000;

     |ATRI S; |PINTA 2203, "Cliente: "; |ATRI 0;
     |PINTA 2212, #0#0;
     |PINTA 2218, #0#1;
     |PINTA 2259, #0#54;
     nSwGraba = 0;
     aTelefL = "";
     aTelefI = #0#54;|QBF aTelefI;

     #107#0 = #0#1;
     #107#1 = 1;
     |LEE 040#107=;
     |SI FSalida = 0;
         aTelefL = #107#4; |QBF aTelefL;
     |FINSI;
     |SI aTelefL ! ""; |Y aTelefL ! aTelefI;
         aTelefI  = aTelefL;
         nSwGraba = 1;
     |FINSI;

     |SI #15#3 = "S";
         #600#0 = #0#0;
         |LEE 101#600=;
         |SI FSalida = 0;
             #600#95 = #0#104;  || Forma de pago Cliente
             #600#14 = aTelefI; || Telefono de Integrada
             |GRABA 020#600a;
         |FINSI;
         |LIBERA #600;
     |FINSI;

     |SI #15#2 = "S";
         |BUCLE canempreG;
     |FINSI;

     |SI nSwGraba = 1;
         #0#54 = aTelefI;
         |GRABA 020#0a;
     |FINSI;
     |LIBERA #0;
|FPRC;

|DEFBUCLE dsam0000;
     #0#1;
     ;
     #15#0;
     #15#1;
     be;
     NULL, dsam0000;
|FIN;

|PROCESO Tipo3;  |TIPO 3;
     |SI #15#6 = "SI";
         |SI #15#2 = "S"; |O #15#3 = "S";
             |ABRE #600;
             |ABRE #107;
             |BUCLE dsam0000;
             |CIERRA #107;
             |CIERRA #600;
         |FINSI;
     |FINSI;
|FPRC;
