|FICHEROS;
     dsat0009,MANTE;

     :/integral/def/dsam0026;
     :/integral/def/dsam0000;

     :/integral/def/dsam0127;

     dsaw0043,MANTE;
     dsaw0044,MANTE;

     dsat009@;
|FIN;

|VARIABLES;
     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     nNume1      = 0;
     nNume2      = 0;
     nPara1      = 0;
     aBase       = "";
     aDef        = "";
     fFecha      = @;
     aTAny       = "";
     aEstado     = "";
     nOpcion     = 0;
     nError      = 0;
     nOpera      = 0;
     nAlguno     = 0;
     nSw         = 0;
     nInkey      = 0;
     nTecla      = 0;
     nModo       = 0;
     nModoL      = 0;
     nEstado     = 0;
     nGraba      = 0;
     nMensa      = 0;

     &eaFichero = "";
     &eaFicher1 = "";
|FIN;

|INCLUYE i_varfun;

|| ///////////////////////////////////////////////////////////////////

|PROCESO dsaw0043;

   #dsaw0043#0 = #dsam0026#8;
   #dsaw0043#1 = #dsam0026#9;
   #dsaw0043#2 = #dsam0026#10;
   #dsaw0043#3 = #dsam0026#11;
   #dsaw0043#4 = #dsam0026#1;
   #dsaw0043#5 = "BAJA";
   aAlfa1 = "S";
   |SI #dsaw0043#0 = "A";
       #dsaw0043#5 = "ALTA";
       aAlfa1 = "N";
   |FINSI;

   |C_M #dsaw0043#0,1, "S";
   |C_V #dsaw0043#2,1, "N";
   |C_M #dsaw0043#3,1, aAlfa1;

   |PUSHV 0836 1480;
   |PINPA #0#dsaw0043;
   |PINDA #0#dsaw0043;

   |ENDATOS #1#dsaw0043;
   |SI FSalida = 0;
       #dsam0026#8  = #dsaw0043#0;
       |SI #dsam0026#8 = "A";
           #dsam0026#9  = #dsaw0043#1;
           #dsam0026#10 = "01.01.0000";
           #dsam0026#11 = "";
       |SINO;
           #dsam0026#9  = #dsaw0043#1;
           #dsam0026#10 = #dsaw0043#2;
           #dsam0026#11 = #dsaw0043#3;
       |FINSI;
       |GRABA 020#dsam0026.a;
       |LIBERA #dsam0026;

       #dsat0009#8  = #dsam0026#8;
       #dsat0009#9  = #dsam0026#9;
       #dsat0009#10 = #dsam0026#10;
       #dsat0009#11 = #dsam0026#11;
       nGraba = 1;
   |FINSI;
   |POPV;
|FPRC;

|PROCESO LeeTransporte;
   |DDEFECTO #dsam0026;
   #dsam0026#0 = enEmpresa;
   #dsam0026#1 = eaMatricula;
   |LEE 041#dsam0026.=;
   nEstado = FSalida;
|FPRC;

|PROCESO Tipo7t009; |TIPO 7;
   enEmpresa  = #dsat0009#0;
   eaMatricula = #dsat0009#1;
|FPRC;

|PROCESO AltaLinea;
   eaFun07     = "A";
   enEmpresa   = #dsat0009#0;
   eaMatricula = #dsat0009#1;
   enEjer      = enEjeRen;
   enHMes      = enMesRen;

   |PUSHV 1319 2380;
   |DDEFECTO #dsaw0044;

   enSalida = 1;
   #dsaw0044#0 = enEmpresa;
   #dsaw0044#5 = enMesRen;
   #dsaw0044#6 = enEjeRen;
   |PINPA #0#dsaw0044;
   |PINDA #0#dsaw0044;
   nGraba = 0;
   |ENDATOS #1#dsaw0044;
   |POPV;
   |SI enSalida = 0;
       |DBASE aBase;
       aDef = aBase + "def/dsat0009";
       |CARGA_DEF aDef, dsat009@;
       |SI FSalida = 0;
           |ABRE #dsat009@;
           #dsat009@#5 = enMesRen;
           #dsat009@#6 = enEjeRen;
           #dsat009@#0 = enEmpresa;
           #dsat009@#1 = eaMatricula;
           |LEE 041#dsat009@.=;
           |SI FSalida ! 0;
               |DDEFECTO #dsat009@;
               #dsat009@#0  = enEmpresa;
               #dsat009@#1  = eaMatricula;
               #dsat009@#2  = #dsam0026#2;
               #dsat009@#3  = #dsam0026#3;
               #dsat009@#4  = #dsam0026#4;
               #dsat009@#5  = enMesRen;
               #dsat009@#6  = enEjeRen;
               #dsat009@#7  = #dsam0026#7;
               #dsat009@#8  = #dsam0026#8;
               #dsat009@#9  = #dsam0026#9;
               #dsat009@#10 = #dsam0026#10;
               #dsat009@#11 = #dsam0026#11;
               |GRABA 020#dsat009@.b;
           |FINSI;
           |CIERRA #dsat009@;
       |FINSI;
       |DESCARGA_DEF #dsat009@;
   |FINSI;

   #dsat0009#1 = eaMatricula;
   |LEE 041#dsat0009.=;
|FPRC;

|PROCESO BajaLinea;
   |LEE 141#dsat0009.=;

   |CONFI "0000NBorrar la Linea del Expediente";
   |SI FSalida = 0;
       |BORRA 040#dsat0009.a;
   |FINSI;
   |LIBERA #dsat0009;
|FPRC;

|PROCESO EstadoLinea;
   |LEE 141#dsat0009.=;

   enEmpresa  = #dsat0009#0;
   eaMatricula = #dsat0009#1;

   |ABRE #dsam0026;
   |HAZ LeeTransporte;
   nGraba = 0;
   |SI nEstado ! 0;
       |MENAV "0000Atencion este transporte ya no existe en el Cliente";
       #dsat0009#8 = "B";
       fFecha = ~; #dsat0009#10 = fFecha;
       #dsat0009#11 = "No existe en el cliente";
       nGraba = 1;
   |SINO;
       |HAZ dsaw0043;
   |FINSI;
   |SI nGraba = 1;
       |PINTA #dsat0009#8;
       |GRABA 020#dsat0009.a;
   |FINSI;
   |LIBERA #dsat0009;
   |CIERRA #dsam0026;
|FPRC;

|PROCESO Consulta;
   enEmpresa   = #dsat0009#0;
   eaMatricula = #dsat0009#1;
   aEstado     = #dsat0009#8;
   enTecla = 11;
   |HAZ AltasBajas_26;
|FPRC;

|PROCESO Tipo11t009; |TIPO 11;
   nInkey = FSalida;

   |SI nInkey = 10;
       |HAZ AltaLinea;
       |PONCONTROL 23, "si";
   |FINSI;

   |SI nInkey = 11;
       |HAZ BajaLinea;
       |PONCONTROL 23, "SI";
       |ERROR;
   |FINSI;

   |SI nInkey = 12;
       |HAZ EstadoLinea;
       |PONCONTROL 23, "SI";
       |ERROR;
   |FINSI;

   |SI nInkey = 13;
       |HAZ Consulta;
       |ERROR;
   |FINSI;
|FPRC;
