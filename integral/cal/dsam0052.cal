|FICHEROS;
     dsam0000 #0;
     dsam0052 #52,MANTE;
|FIN;

|VARIABLES;
     nTope = 0;
     nModo = 0;
|FIN;

|PROCESO CalcuTotal; |TIPO 0;
     |SI #52Campo = Contenido; |ACABA; |FINSI;

     #52#10 = #52#5 + (#52#5 % #52#9);
     |PINTA #52#10;
|FPRC;

|PROCESO Filtros;
     nTope = 31;

     |SI #52#6 = 2;  nTope = 29; |FINSI;
     |SI #52#6 = 4;  nTope = 30; |FINSI;
     |SI #52#6 = 6;  nTope = 30; |FINSI;
     |SI #52#6 = 9;  nTope = 30; |FINSI;
     |SI #52#6 = 11; nTope = 30; |FINSI;

     |SI nTope < #52#7;
         |MENAV "      El dia no coincide con los dias del mes introducido.";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Pantalla;
     |SI FSalida ! 9; |ACABA; |FINSI;

     |PUSHV 0501 2380;
     |CUADRO 0856 1577;

     |ATRI R;
     |PINTA 0957, " 01 al 12 Meses     ";
     |PINTA 1057, " 13.- Mensual       ";
     |PINTA 1157, " 14.- Bimensual     ";
     |PINTA 1257, " 15.- Trimestral    ";
     |PINTA 1357, " 16.- Cuatrimestral ";
     |PINTA 1457, " 17.- Semestral     ";
     |ATRI r;

     |PAUSA;
     |POPV;

     |ERROR;
|FPRC;

|PROCESO SNIva; |TIPO 0;
     |SI #52#8 = "S";
         |C_M #52#9, 1, "S";
     |SINO;
         |C_M #52#9, 1, "N";
         #52#9 = 0; |PINTA #52#9;
     |FINSI;
|FPRC;

|PROCESO Agente;  |TIPO 7;
     nModo = (FEntrada / 100) ! 0;
     |SI nModo ! 1;  |Y #52#16 ! 0;  |ACABA;  |FINSI;

     #52#16 = #0#36;  |PINTA #52#16;
|FPRC;
