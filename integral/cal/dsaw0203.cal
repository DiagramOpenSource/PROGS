|FICHEROS;
     dsaw0203 #203;
     dsam0101 #1;

     dsam0104 #104;
     dsam0115 #115;

     reauxpai@ #900;
|FIN;

|VARIABLES;
     nCampo      = 0;
     nLCod       = 0;
     nLDes       = 0;
     nCalc       = 0;
     nError      = 0;

     aAlfa       = "";
     aAlfa1      = "";
     aAlfa2      = "";
     aBase       = "";
     aMas        = "";
     aFic        = "";

     &eaTabla    = "";
     &eaDestino  = "";
     &eaAlfa     = "";
     &enPosicion = 0;
     &enComp     = 0;
     &enError    = 0;
     &eaRenta    = "";
|FIN;

|PROCESO Tipo12Fw203;  |TIPO 12;
|FPRC;

|PROCESO CampoObligatorio; |TIPO 6;
     |C_M #203Campo, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     aAlfa = #203Campo;  |QBF aAlfa;

     |SI aAlfa = "";
         |MENAV "0000Contenido obligatorio. ";
         |ERROR;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO Tipo0C3Fw203; |TIPO 0;
     |C_M #203#3, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     |SI #203#3 ! "NUM";  |Y #203#3 ! "KM.";  |Y #203#3 ! "S/N";
      |Y #203#3 ! "OTR";  |Y #203#3 ! "   ";
         |MENAV "0000Contenido incorrecto.";
         |ERROR;
         |ACABA;
     |FINSI;

     |C_M #203#4, 1, "S";
     |SI #203#3 = "S/N";
         |C_M #203#4, 1, "N";   #203#4 = "0000";  |PINTA #203#4;
     |FINSI;
|FPRC;

|PROCESO Tipo7C1Fw203; |TIPO 7;
     |C_M #203#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

/*
     eaTabla = "zsiglas.txt";
     nLCod   = 5;
     nLDes   = 15;
     |HAZ CargaTabla;
*/
|FPRC;


|PROCESO inf115;
  #115#2 = "     ";
|FPRC;

|PROCESO sup115;
  #115#2 = "zzzzz";
|FPRC;

|PROCESO Tipo0C1Fw203;
     |C_M #203#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     nCampo   = Campo + 1;

/*
     |SI FSalida = 10;
         enPosicion = 20;
         |HAZ SacaTabla;
         nCalc = 100 + nLCod;
         aAlfa1   = eaDestino % nCalc;
         #203Campo  = aAlfa1; |PINTA #203Campo;
     |FINSI;
*/

     |SI FSalida = 10;
         |ABRE #115;
         |CONSULTA_F_CLAVE #3#115, inf115, sup115;
         |CIERRA #115;
         #203Campo = #115#2; |PINTA #203Campo;
     |FINSI;

     |SI #203Campo = "     ";
         |MENAV "0000 Contenido Incorrecto. Consulta el Fichero de Siglas con F2";
         |ERROR; |ACABA;
     |FINSI;

     enComp = nLCod;
     aAlfa  = "|C" + (("000" + Campo) % -103) + "TIPO";
     aAlfa1 = #203#aAlfa#;
     aAlfa  = #203Campo;   |QBF aAlfa;

     |SI aAlfa1 = "N";
         nCalc = - (100 + nLCod);
         aAlfa = (("0" * enComp) + aAlfa) % nCalc;
     |FINSI;

     |SI aAlfa1 ! "N";
         nCalc = 100 + nLCod;
         aAlfa = (aAlfa + (" " * enComp)) % nCalc;
     |FINSI;
     eaAlfa = aAlfa;
||     |HAZ CompruebaTabla;

     enError = 0;
     |ABRE #115;
     |SELECT #3#115;
     #115#2 = #203Campo;
     |LEE 040#115=
     |SI FSalida ! 0;
         enError = 1;
     |FINSI;
     |SELECT #1#115;
     |CIERRA #115;

     |SI enError = 1;
         |MENAV "0000 Contenido Incorrecto. Consulta el Fichero de Siglas con F2";
         |ERROR; |ACABA;
     |FINSI;

/*
     nCalc      = 100 + nLCod;
     aAlfa1     = eaDestino % nCalc;
     nCalc      = ((nLCod + 2) * 100) + nLDes;
     aAlfa2     = eaDestino % nCalc;
     #203Campo  = aAlfa1;

     |PINTA #203Campo;

     |HAZ FinTabla;
*/
|FPRC;

|PROCESO Tipo0C0Fw203;  |TIPO 0;
     |PARA nCampo = 1;  |SI nCampo [ 27;  |HACIENDO nCampo = nCampo + 1;
           |C_M #203nCampo, 1, "S";
     |SIGUE;
     |C_M #203#16, 1, "N";
     |C_M #203#26, 1, "N";

     |SI #203#0 = "N";
         |PARA nCampo = 17;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
               |C_M #203nCampo, 1, "N";  #203nCampo = "";  |PINTA #203nCampo;
         |SIGUE;
     |SINO;
         aAlfa1 = #203#2;   |QBF aAlfa1;
         aAlfa2 = #203#17;  |QBF aAlfa2;

         |SI aAlfa2 = "";
             |SI aAlfa1 ! "";
                 aAlfa = #203#1;  |QBF aAlfa;
                 |SI aAlfa ! "";  aAlfa = aAlfa + " ";  |FINSI;
                 aAlfa = aAlfa + #203#2;   |QBF aAlfa;
                 |SI #203#4  ! "    ";  aAlfa = aAlfa + " " + #203#4;   |FINSI;
                 |SI #203#8  ! "   ";   aAlfa = aAlfa + " " + #203#8;   |FINSI;
                 |SI #203#9  ! "  ";    aAlfa = aAlfa + " " + #203#9;   |FINSI;
                 |SI #203#10 ! "  ";    aAlfa = aAlfa + " " + #203#10;  |FINSI;

                 #203#17 = aAlfa;    |PINTA #203#17;
                 #203#18 = #203#11;  |PINTA #203#18;
                 #203#19 = #203#15;  |PINTA #203#19;
                 #203#21 = (("00" + #203#13) % -102) + (("000" + #203#14) % -103);  |PINTA #203#21;
                 #203#22 = #203#16;  |PINTA #203#22;
             |FINSI;
         |FINSI;

         |PARA nCampo = 1;  |SI nCampo [ 16;  |HACIENDO nCampo = nCampo + 1;
               |C_M #203nCampo, 1, "N";  #203nCampo = "";  |PINTA #203nCampo;
         |SIGUE;
         |C_M #203#27, 1, "N";  #203#27 = "";  |PINTA #203#27;
     |FINSI;
|FPRC;

|PROCESO Tipo0C13Fw203;
                        |C_M #203#25, 1, "N";
     |SI #203#0 = "S";  |C_M #203#25, 1, "S";  |ACABA;  |FINSI;

     |ABRE #1;
     #1#0 = #203#13;
     #1#1 = #203#14;
     |LEE 040#1=;
     |SI FSalida ! 0;  |DDEFECTO #1;  |FINSI;
     |CIERRA #1;

     |SI #203#27 = "S";
         #203#25 = 20;
         #203#26 = "";
     |SINO;
         #203#25 = #1#4;
         #203#26 = #1#5;
     |FINSI;

     |PINTA #203#25;
     |PINTA #203#26;
|FPRC;

|PROCESO inf104;
  #104#4 = 0;
|FPRC;

|PROCESO sup104;
  #104#4 = 999;
|FPRC;


|PROCESO Tipo66C23Fw203;  |TIPO 66;
     |ABRE #104;
     |SELECT #3#104;
     #104#4 = #203#23;
     |LEE 000#104=;
     |CONSULTA_F_CLAVE #3#104, inf104, sup104;
     |SI FSalida = 0;
         #203#23 = #104#4;  |PINTA #203#23;
         #203#24 = #104#1;  |PINTA #203#24;
     |FINSI;
     |SELECT #1#104;
     |CIERRA #104;
|FPRC;

|PROCESO Tipo0C23Fw203;  |TIPO 0;
     |SI #203#0 = "N";  |ACABA;  |FINSI;

     |ABRE #104;
     |SELECT #3#104;
     #104#4 = #203#23;
     |LEE 000#104=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe el Pais.";
     |SINO;
         #203#23 = #104#4;  |PINTA #203#23;
         #203#24 = #104#1;  |PINTA #203#24;
     |FINSI;
     |SELECT #1#104;
     |CIERRA #104;
|FPRC;

/*
|PROCESO CargaRenta;
     nError = 0;
     |HAZ BuscaRenta;
     |SI eaRenta = "";  nError = 1;  |ACABA;  |FINSI;

     aMas = eaRenta + "def/" + "reauxpai.mas";
     |CARGA_DEF aMas, reauxpai@;
     |SI FSalida ! 0;  nError = 1;  |ACABA;  |FINSI;

     aFic = eaRenta + "fich/";
     |PATH_DAT #900 aFic;
|FPRC;

|PROCESO DescargaRenta;
     |DESCARGA_DEF #reauxpai@;
|FPRC;

|PROCESO Tipo66C23Fw203;  |TIPO 66;
     |HAZ CargaRenta;
     |SI nError = 1;  |ACABA;  |FINSI;

     |ABRE #900;
     #900#0 = #203#23;
     |LEE 000#900=;
     |CONSULTA_CLAVE #1#900;
     |SI FSalida = 0;
         #203#23 = #900#0;  |PINTA #203#23;
         #203#24 = #900#1;  |PINTA #203#24;
     |FINSI;
     |CIERRA #900;

     |HAZ DescargaRenta;
|FPRC;

|PROCESO Tipo0C23Fw203;  |TIPO 0;
     |SI #203#0 = "N";  |ACABA;  |FINSI;

     |HAZ CargaRenta;
     |SI nError = 1;  |ACABA;  |FINSI;

     |ABRE #900;
     #900#0 = #203#23;
     |LEE 000#900=;
     |SI FSalida ! 0;
         |MENAV "0000 No existe el Pais.";
     |SINO;
         #203#23 = #900#0;  |PINTA #203#23;
         #203#24 = #900#1;  |PINTA #203#24;
     |FINSI;
     |CIERRA #900;

     |HAZ DescargaRenta;
|FPRC;
*/
