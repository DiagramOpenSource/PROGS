|VARIABLES;
     &eaCadena  = "";
     &eaCadena1 = "";
     &eaCadena2 = "";
     &eaCadena3 = "";

     nBlanco1  = 0;
     nBlanco2  = 0;
     nComa     = 0;
     nCaracter = 0;
     nPosi     = 0;
     nEspa     = 0;
     aCaracter = "";
     aLongAlfa = "";
     nLongNume = 0;
     aParaQuitar = "";
|FIN;

|PROCESO QuitaBlanco;
     |ET eaCadena;
         |QBF aParaQuitar;
         |SI aParaQuitar ! "";
             aCaracter = aParaQuitar % 101;
             |SI aCaracter = " ";
                 aParaQuitar = aParaQuitar % 240;
                 |VETE eaCadena;
             |FINSI;
         |FINSI;
|FPRC;

|PROCESO SeparaNombreIzq;
     eaCadena1 = "";
     eaCadena2 = "";
     eaCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nCaracter = 1; |SI nCaracter [ 40; |HACIENDO nCaracter = nCaracter + 1;
           nPosi = nCaracter * 100 + 1;
           aCaracter = eaCadena % nPosi;

           |SI aCaracter = ","; nComa = nCaracter; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay nComa busca el segundo blanco por delante

         aLongAlfa = eaCadena % 0;
         nLongNume = aLongAlfa;
         nEspa     = 0;

         |PARA nCaracter = 1; |SI nCaracter [ nLongNume; |HACIENDO nCaracter = nCaracter + 1;
               nPosi = nCaracter * 100 + 1;
               aCaracter = eaCadena % nPosi;
               |SI aCaracter = " ";
                   nEspa = nEspa + 1;
                   nComa = nCaracter;
                   |SI nEspa = 2;
                       |SAL;
                   |FINSI;
               |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros caracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     eaCadena2 = eaCadena % nPosi;
     aLongAlfa = eaCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nCaracter = nLongNume; |SI nCaracter ] 1; |HACIENDO nCaracter = nCaracter - 1;
           nPosi = nCaracter * 100 + 1;
           aCaracter = eaCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nCaracter; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     eaCadena2 = eaCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     eaCadena1 = eaCadena % nPosi;

     || Recoge los dos primero caracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     eaCadena3 = eaCadena % nPosi;

     aParaQuitar = eaCadena1; |HAZ QuitaBlanco; eaCadena1 = aParaQuitar;
     aParaQuitar = eaCadena2; |HAZ QuitaBlanco; eaCadena2 = aParaQuitar;
     aParaQuitar = eaCadena3; |HAZ QuitaBlanco; eaCadena3 = aParaQuitar;

     |QBF eaCadena1;
     |QBF eaCadena2;
     |QBF eaCadena3;
|FPRC;

|PROCESO SeparaNombreDer;
     eaCadena1 = "";
     eaCadena2 = "";
     eaCadena3 = "";

     nBlanco1 = 0;
     nBlanco2 = 0;
     nComa    = 0;

     |PARA nCaracter = 1; |SI nCaracter [ 40; |HACIENDO nCaracter = nCaracter + 1;
           nPosi = nCaracter * 100 + 1;
           aCaracter = eaCadena % nPosi;

           |SI aCaracter = ","; nComa = nCaracter; |SAL; |FINSI;
     |SIGUE;

     |SI nComa = 0;
         || Si no hay nComa busca el primer blanco empezando por detras

         aLongAlfa = eaCadena % 0;
         nLongNume = aLongAlfa;

         |PARA nCaracter = nLongNume; |SI nCaracter ] 1; |HACIENDO nCaracter = nCaracter - 1;
               nPosi = nCaracter * 100 + 1;
               aCaracter = eaCadena % nPosi;
               |SI aCaracter = " "; nComa = nCaracter; |SAL; |FINSI;
         |SIGUE;
     |FINSI;

     || Coge los dos primeros caracteres del segundo apellido

     nBlanco1  = nComa - 1;
     nPosi     = nBlanco1 + 100;
     eaCadena2 = eaCadena % nPosi;
     aLongAlfa = eaCadena2 % 0;
     nLongNume = aLongAlfa;

     |PARA nCaracter = nLongNume; |SI nCaracter ] 1; |HACIENDO nCaracter = nCaracter - 1;
           nPosi = nCaracter * 100 + 1;
           aCaracter = eaCadena2 % nPosi;
           |SI aCaracter = " "; nBlanco1 = nCaracter; |SAL; |FINSI;
     |SIGUE;

     nBlanco1 = nBlanco1 + 1;
     nPosi    = nBlanco1 * 100 + nLongNume;
     eaCadena2 = eaCadena2 % nPosi;

     || Coge las dos primeros caracteres del primer apellido

     nBlanco1 = nBlanco1 - 1;
     nPosi    = 100 + nBlanco1;
     eaCadena1 = eaCadena % nPosi;

     || Recoge los dos primero caracteres de Nombre

     nPosi    = ((nComa + 1) * 100) + 40;
     eaCadena3 = eaCadena % nPosi;

     aParaQuitar = eaCadena1; |HAZ QuitaBlanco; eaCadena1 = aParaQuitar;
     aParaQuitar = eaCadena2; |HAZ QuitaBlanco; eaCadena2 = aParaQuitar;
     aParaQuitar = eaCadena3; |HAZ QuitaBlanco; eaCadena3 = aParaQuitar;

     |QBF eaCadena1;
     |QBF eaCadena2;
     |QBF eaCadena3;
|FPRC;
