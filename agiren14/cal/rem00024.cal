|FICHEROS;
     rem00024 #20;

     rem00050 #50;

     rew00624 #624,MANTE;
     rew00650 #650,MANTE;

     rew00003;

     rew99999 #999;
|FIN;

|VARIABLES;
     aAlfa         = "";
     aAlfa1        = "";
     aAlfa2        = "";
     aAlfa3        = "";
     aLong         = "";
     aQueQuiero    = "";
     aNumCampos    = "";
     aNumPanta     = "";
     aPathRenta    = "";
     aDef          = "";
     aDescri       = "";

     aEsc1         = "";
     aEsc2         = "";
     aRetu         = "";
     aTecla        = "";
     aID           = "";

     nVentana       = 0;
     nCampo         = 0;
     nRango         = 0;
     nGrid          = -1;
     nGrid50        = -1;
     nBotonAlta     = 0;
     nBotonModi     = 0;
     nBotonBaja     = 0;
     nBotonCntr     = 0;
     nBotonRdto     = 0;
     nPanta         = 0;
     nPanta650      = 0;
     nID            = 0;
     nEntrar        = 0;

     nContenido    = 0;
     nEjercicio    = 0;
     nEjer         = 0;
     nSw           = 0;
     nLong         = 0;
     nCaracter     = 0;
     nPosi         = 0;
     nNumCampos    = 0;
     nNumPanta     = 0;
     nModo         = 0;
     nEntrada      = 0;
     nPtas         = 0;
     nRetencion    = 0;
     nCampo15      = 0;
     nCampo16      = 0;
     nCampo17      = 0;
     nCampo20      = 0;
     nCampo27      = 0;
     nValor        = 0;
     nValor1       = 0;
     nValorPat     = 0;
     nAnyo         = 0;
     nAnyo1        = 0;
     nSwHay        = 0;
     nCampo1       = 0;
     nCampo2       = 0;
     nCampo3       = 0;
     nCampo4       = 0;
     nCampo5       = 0;
     nFallecido    = 0;

     nTodosDias    = 0;
     nParciDias    = 0;

     fFechaLim     = @;

     fFechaAdq     = @;
     fFechaTra     = @;
     fFecha1       = @;
     fFecha2       = @;

     &enEmpresa    = 0;
     &enModo       = 0;
     &enModoReg    = 0;
     &eaDeclarante = "";
     &enComunes    = 0;
     &enChequeo    = 0;
     &enMinusvalia = 0;
     &eaMinuAyuda  = "";
     &eaFallece    = "";
     &eaSwVarios   = "";
     &eaVarDni     = "";
     &enSwLiquida  = 0;
     &enSwRetorno  = 0;
     &eaPrograma   = "";
     &eaPunto      = "";

     &eaLetra      = "";
     &eaDeDonde    = "";
     &eaLinDonde   = "";
     &eaAnyoUsu    = "";
     &eaEdadDec    = "";
     &eaPatr06     = "";
     &eaPatr07     = "";
     &eaPatr08     = "";
     &eaPatr09     = "";
     &eaPatr10     = "";
     &eaPatr11     = "";
     &eaPatr12     = "";
     &eaPatr13     = "";
     &eaPatr14     = "";
     &eaPatr15     = "";
     &eaPatr16     = "";
     &eaPatr17     = "";
     &eaPatr18     = "";
     &eaPatr19     = "";
     &eaPatr20     = "";
     &eaPatr21     = "";

     &eaAzul       = "";
     &eaVerde      = "";
     &eaRojo       = "";
     &eaRosa       = "";
     &enBtnSalir   = 0;
|FIN;

|| ---- PROCESOS GRABACIONES EXTERIORES

|PROCESO rem00050B;
     |BORRA 020#50a;
     |LIBERA #50;
|FPRC;

|DEFBUCLE rem00050B;
     #50#1;
     ;
     #20#0, #20#1, 0000;
     #20#0, #20#1, 9999;
     be;
     NULL, rem00050B;
|FIN;

|PROCESO Patrimonio;
     |SI #20#3  = "R";           |ACABA;  |FINSI;
     |SI #20#3  = "X";           |ACABA;  |FINSI;
     |SI #20#2  = "1 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "2 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "3 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#2  = "4 FAMILIAR";  |ACABA;  |FINSI;
     |SI #20#25 = 0;             |ACABA;  |FINSI;

     |HAZ LimpiaPatrim;

     eaDeclarante = #20#2;

     eaLetra    = "I1";
     eaDeDonde  = "C2";
     eaLinDonde = #20#1;
     eaAnyoUsu  = #20#27;
     eaPatr06   = #20#15;
     eaPatr16   = #20#26;
     eaPatr10   = #20#25;
     eaPatr20   = #20#5;
     eaPatr21   = #20#6;

     |HAZ GrabaPatrimonio;
|FPRC;

|| ---- PROCESOS DEL REM00050

|PROCESO Tipo12Fw650;  |TIPO 12;
|FPRC;

|PROCESO Totalm050;
     #650#5 = #650#4 - #650#3;
     |PINTA #650#5;

     |SI #20#13 = "N";
         #650#8 = 0;  |PINTA #650#8;
         #650#9 = 0;  |PINTA #650#9;
     |FINSI;
|FPRC;

|PROCESO nContenido50;
     nContenido = Contenido;
     |SI #650Campo ! nContenido;
         #650#5  = #650#4 - #650#3;                    |PINTA #650#5;
         #650#7  = 0;
         #650#9  = (#650#5 - #650#7)  % #650#8;         |PINTA #650#9;
     |FINSI;
|FPRC;

|PROCESO Reduccion150;
     nContenido = Contenido;
     |SI #650Campo = nContenido;  |Y #650#7 ! 0;  |ACABA;  |FINSI;

     #650#7 = 0;

     |PINTA #650#7;
|FPRC;

|PROCESO Reduccion250;
     nContenido = Contenido;
     |SI #650Campo = nContenido;  |Y #650#9 ! 0;  |ACABA;  |FINSI;

     #650#9 = (#650#5 - #650#7) % #650#8;

     |PINTA #650#9;
|FPRC;

|PROCESO CargaFantasma650;
     |PARA nCampo = 0;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
           #650nCampo = #50nCampo;
     |SIGUE;
|FPRC;

|PROCESO DescargaFantasma650;
     |PARA nCampo = 0;  |SI nCampo [ 9;  |HACIENDO nCampo = nCampo + 1;
           #50nCampo = #650nCampo;
     |SIGUE;
|FPRC;

|PROCESO Modificar50;
     |SI enModoReg = 4;  |ACABA;  |FINSI;

     |LEE 101#50=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |VENTANA 0501, 1380, -1, 0, "";
     nVentana = FSalida;

     |PTEC 802;  |PAUSA;

     |PINPA #0#650;  nPanta650 = FSalida;

     |HAZ CargaFantasma650;
     |PINDA #0#650;

     |ENDATOS #1#650;
     |SI FSalida = 0;
         |HAZ DescargaFantasma650;

         |GRABA 020#50a;
         |LIBERA #50;
         enSwRetorno = 1;
     |FINSI;

     |FINVENTANA nVentana;

     nEjercicio = #50#2;

     |HAZ Totalm020;

     #50#0 = #624#0;
     #50#1 = #624#1;
     #50#2 = nEjercicio;
     |LEE 000#50=;

     |REFRESCACONTROL nGrid50;

     |PULSATECLA;
|FPRC;

|| ---- PROCESOS DEL REW00624

|PROCESO Tipo12Fw624;  |TIPO 12;
     |SI FSalida = 7;  |ACABA;  |FINSI;

     aAlfa = #624#2;  |QBF aAlfa;
     |SI aAlfa = "";
         |MENAV "0000No se puede validar la ficha, no hay contribuyente introducido";
         |ERROR;
     |FINSI;
|FPRC;

|PROCESO Tipo0C1Fw624;  |TIPO 0;
     |C_M #624#1, 0, aAlfa;
     |SI aAlfa = "N";  |ACABA;  |FINSI;

     #20#0 = #624#0;
     #20#1 = #624#1;
     |LEE 000#20=;
     |SI FSalida = 0;
         |MENAV "0000El registro ya existe.";
         |ERROR;
         |ACABA;
     |FINSI;

     |HAZ CreaLineal50;
|FPRC;

|PROCESO Usufructuario;
     |C_M #624#27, 1, "S";
     |SI #624#26 ! "N";
         |C_M #624#27, 1, "N";  #624#27 = 0;  |PINTA #624#27;
     |FINSI;
|FPRC;

|PROCESO rem00050;
     #624#16 = #624#16 + #50#3;
     #624#17 = #624#17 + #50#4;
     #624#18 = #624#18 + #50#5;
     #624#24 = #624#24 + #50#9;
|FPRC;

|DEFBUCLE rem00050;
     #50#1;
     ;
     #624#0, #624#1, 1900;
     #624#0, #624#1, 2999;
     ;
     NULL, rem00050;
|FIN;

|PROCESO Graba50;
     nAnyo  = 2014 - nEjer;
     nAnyo1 = 2014 - #624#12;

     #50#0 = #624#0;
     #50#1 = #624#1;
     #50#2 = nAnyo;
     |LEE 101#50=;
     |SI FSalida = 0;
         |SI nAnyo < nAnyo1;
             |BORRA 020#50a;
         |FINSI;
         |LIBERA #50;

         |ACABA;
     |FINSI;

     |SI nAnyo < nAnyo1;  |ACABA;  |FINSI;

     |DDEFECTO #50;
     #50#0 = #624#0;
     #50#1 = #624#1;
     #50#2 = nAnyo;

     |SI #50#2 = 1997;  #50#6 = 30;  |FINSI;
     |SI #50#2 = 1996;  #50#6 = 30;  |FINSI;
     |SI #50#2 = 1995;  #50#6 = 30;  |FINSI;
     |SI #50#2 = 1994;  #50#6 = 60;  |FINSI;
     |SI #50#2 = 1993;  #50#6 = 60;  |FINSI;
     |SI #50#2 = 1992;  #50#6 = 60;  |FINSI;
     |SI #50#2 < 1992;  #50#6 = 70;  |FINSI;
     |SI #50#2 = 1997;  #50#6 = 30;  |FINSI;

     |SI #624#13 = "S";
         |SI #50#2 [ 1988;  #50#8 = 100;    |FINSI;
         |SI #50#2 = 1989;  #50#8 = 85.68;  |FINSI;
         |SI #50#2 = 1990;  #50#8 = 71.40;  |FINSI;
         |SI #50#2 = 1991;  #50#8 = 57.12;  |FINSI;
         |SI #50#2 = 1992;  #50#8 = 42.84;  |FINSI;
         |SI #50#2 = 1993;  #50#8 = 28.56;  |FINSI;
         |SI #50#2 = 1994;  #50#8 = 14.28;  |FINSI;
     |FINSI;

     |GRABA 020#50n;
     |LIBERA #50;
|FPRC;

|PROCESO Totalm020;
     |C_M #624#12, 1, "S";
     |C_M #624#13, 1, "S";
     |SI #624#11 = "S";
         #624#12 = 0;
         #624#13 = "N";
         |C_M #624#12, 1, "N";
         |C_M #624#13, 1, "N";
     |FINSI;

     |C_M #624#16, 1, "S";
     |C_M #624#17, 1, "S";
     |C_M #624#23, 1, "S";
     |C_M #624#24, 1, "S";
     |SI #624#12 ] 1;  |Y #624#12 [ 12;
         |C_M #624#16, 1, "N";
         |C_M #624#17, 1, "N";
         |C_M #624#23, 1, "N";
         |C_M #624#24, 1, "N";
     |SINO;
         |SI #624#12 ] 13;
             #624#13 = "N";
             |C_M #624#13, 1, "N";
         |FINSI;

         |SI #624#13 = "N";
             |C_M #624#23, 1, "N";  #624#23 = 0;
             |C_M #624#24, 1, "N";  #624#24 = 0;
         |FINSI;
     |FINSI;

     #624#18 = #624#17 - #624#16;

     |PINTA #624#12;
     |PINTA #624#13;

     |SI #624#12 ] 1;  |Y #624#12 [ 12;
         |PARA nEjer = 1;  |SI nEjer [ 12;  |HACIENDO nEjer = nEjer + 1;
               |HAZ Graba50;
         |SIGUE;

         #624#16 = 0;
         #624#17 = 0;
         #624#18 = 0;
         #624#23 = 0;
         #624#24 = 0;
         nSw    = 1;
         |BUCLE rem00050;
     |SINO;
         |BUCLE rem00050B;
     |FINSI;

     |REFRESCACONTROL nGrid50;

     |PINTA #624#16;
     |PINTA #624#17;
     |PINTA #624#18;
     |PINTA #624#19;
     |PINTA #624#20;
     |PINTA #624#23;
     |PINTA #624#24;
|FPRC;

|PROCESO nContenido;
     nContenido = Contenido;
     |SI #20Campo ! nContenido;
         #624#18 = #624#17 - #624#16;                      |PINTA #624#18;
         #624#24 = #624#18 % #624#23;                      |PINTA #624#24;
         #624#20 = (#624#18 - #624#24) % #624#19;           |PINTA #624#20;
     |FINSI;
|FPRC;

|PROCESO Retencion;
     nContenido = Contenido;
     |SI #20Campo = nContenido;  |Y #624#20 ! 0;  |ACABA;  |FINSI;

     #624#20 = (#624#18 - #624#24) % #624#19;  |PINTA #624#20;
|FPRC;

|PROCESO Reduccion1;
     nContenido = Contenido;
     |SI #20Campo = nContenido;  |ACABA;  |FINSI;
|FPRC;

|PROCESO Reduccion2;
     nContenido = Contenido;
     |SI #20Campo = nContenido;  |Y #624#24 ! 0;  |ACABA;  |FINSI;

     #624#24 = #624#18 % #624#23;
|FPRC;

|PROCESO Baja50;
     #50#0 = #20#0;
     #50#1 = #20#1;
     #50#2 = 0000;
|FPRC;

|PROCESO Alta50;
     #50#0 = #20#0;
     #50#1 = #20#1;
     #50#2 = 2014;
|FPRC;

|PROCESO Evento50;
     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#50=;

         |PULSATECLA;
     |FINSI;

     |SI FSalida = 4;
         |HAZ Modificar50;
     |FINSI;
|FPRC;

|PROCESO CreaLineal50;
     |SI nGrid50 ! -1;
         |DESTRUYECONTROL nGrid50;
     |FINSI;

     |LINEAL_SIMPLE #1#50, nRango, 2902, 3598, Baja50, Alta50, Evento50;
     nGrid50 = FSalida;
|FPRC;

|PROCESO CargaFantasma;
     |C_M #624#11, 1, "S";
     |C_M #624#12, 1, "S";
     |C_M #624#13, 1, "S";
     |C_M #624#14, 1, "S";
     |C_M #624#15, 1, "S";
     |C_M #624#16, 1, "S";
     |C_M #624#17, 1, "S";
     |C_M #624#19, 1, "S";
     |C_M #624#20, 1, "S";
     |C_M #624#23, 1, "S";
     |C_M #624#24, 1, "S";
     |C_M #624#25, 1, "S";
     |C_M #624#26, 1, "S";

     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #624nCampo = #20nCampo;

           |C_V #624nCampo, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #624nCampo;  |FINSI;
     |SIGUE;

     eaDeDonde  = "C2";
     eaLinDonde = #20#1;
     eaLetra    = "I1";
     |HAZ BorraPatrimonio;

     |HAZ CreaLineal50;
|FPRC;

|PROCESO DescargaFantasma;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           |SI enSwLiquida = 1;
               |SI #20nCampo = #624nCampo;
                   enSwRetorno = 1;
               |FINSI;
           |FINSI;

           #20nCampo = #624nCampo;
     |SIGUE;

                        #20#28 = "";
     |SI #20#3  = "X";  #20#28 = eaRojo;  |FINSI;

     |HAZ PintaDatosPantalla;
|FPRC;

|PROCESO Alta;
     |ESTADO_CONTROL nBotonAlta,   "DISABLE";
     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";
     |ESTADO_CONTROL nBotonRdto,   "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     |PULSATECLA;

     #20#0 = enEmpresa;
     #20#1 = 99;
     |LEE 000#20];
     |SI FSalida = 0;
         |LEE 000#20a;
     |SINO;
         |LEE 000#20u;
     |FINSI;

     |DDEFECTO #624;
     #624#0 = enEmpresa;
     #624#1 = 1;
     |SI FSalida = 0;  |Y  #20#0 = enEmpresa;
         #624#1 = #20#1 + 1;
     |FINSI;

     |DDEFECTO #20;

     #20#0 = #624#0;
     #20#1 = #624#1;

     enModoReg = 1;
     |HAZ CargaFantasma;

     |C_M #624#1, 1, "S";
     |ENDATOS #1#624;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#20n;
         |LIBERA #20;

         |HAZ Patrimonio;
     |FINSI;

     |SI enModo ! 4;
         |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |FINSI;

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;

     |SI #20#0 ! enEmpresa;
         |DDEFECTO #20;
         #20#0 = enEmpresa;
     |FINSI;

     FSalida = 1;  |HAZ Evento20;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Modificar;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |LEE 101#20=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |ESTADO_CONTROL nBotonAlta,  "DISABLE";
     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";
     |ESTADO_CONTROL nBotonRdto,  "DISABLE";

     |HAZ QuitaBtnSalir;

     |ESTADO_CONTROL nGrid, "DISABLE";

     enModoReg = 2;
     |C_M #624#1, 1, "N";

     |HAZ CargaFantasma;
     |ENDATOS #2#624;
     |SI FSalida = 0;
         |HAZ DescargaFantasma;

         |GRABA 020#20a;
     |FINSI;
     |LIBERA #20;

     |HAZ Patrimonio;

     |ESTADO_CONTROL nBotonAlta, "ENABLE";
     |ESTADO_CONTROL nBotonModi, "ENABLE";
     |ESTADO_CONTROL nBotonBaja, "ENABLE";
     |ESTADO_CONTROL nBotonRdto, "ENABLE";

     |HAZ PonBtnSalir;

     enModoReg = 4;
     |ESTADO_CONTROL nGrid, "ENABLE";
     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO Baja;
     |SI nEntrar = 0;  |ACABA;  |FINSI;

     |CONFI "0000 Confirma la baja del registro seleccionado";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |LEE 101#20=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |BORRA 020#20a;
     |LIBERA #20;

     |BUCLE rem00050B;

     eaDeDonde  = "C2";
     eaLinDonde = #20#1;
     eaLetra    = "I1";
     |HAZ BorraPatrimonio;

     enSwRetorno = 1;
     nEntrar     = 0;

     |ESTADO_CONTROL nBotonModi,  "DISABLE";
     |ESTADO_CONTROL nBotonBaja,  "DISABLE";

     |REFRESCACONTROL nGrid;
     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO BotonCntr;
     enComunes   = 1;
     enChequeo   = 0;

     #rew00003#0 = #624#2;
     #rew00003#1 = #624#3;
     #rew00003#2 = #624#4;
     #rew00003#3 = #624#5;
     #rew00003#4 = #624#6;
     #rew00003#5 = #624#7;
     #rew00003#6 = #624#8;
     #rew00003#7 = #624#9;
     #rew00003#8 = #624#10;

     |HAZ PantaREW00003;

     #624#2  = #rew00003#0;    |PINTA #624#2;
     #624#3  = #rew00003#1;
     #624#4  = #rew00003#2;
     #624#5  = #rew00003#3;
     #624#6  = #rew00003#4;
     #624#7  = #rew00003#5;
     #624#8  = #rew00003#6;
     #624#9  = #rew00003#7;
     #624#10 = #rew00003#8;

     aAlfa = "|C026WID";
     aID   = #624aAlfa;
     nID   = aID;
     |FOCOTECLADO nID;

     |SI #624#3 = "X";  |Y enModoReg ! 4;
         |PTEC 806;
     |FINSI;
|FPRC;

|PROCESO Tipo7C2Fw624;  |TIPO 7;
     aAlfa = #624#2;  |QBF aAlfa;
     |SI aAlfa ! "";  |Y #624#3 ! "X";
         |ACABA;
     |FINSI;

     |HAZ BotonCntr;
|FPRC;

|PROCESO Rendimientos;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |HAZ QuitaBtnSalir;

     |SUB_EJECUTA_NP "rew00551";

     |HAZ PonBtnSalir;

     |FOCOTECLADO nGrid;
|FPRC;

|PROCESO PintaDatosPantalla;
     |DDEFECTO #624;
     |PARA nCampo = 0;  |SI nCampo [ nNumCampos;  |HACIENDO nCampo = nCampo + 1;
           #624nCampo = #20nCampo;

           |C_V #624nCampo, 0, aAlfa;
           |SI aAlfa = "S";  |PINTA #624nCampo;  |FINSI;

           |C_M #624nCampo, 1, "N";
     |SIGUE;

     |HAZ CreaLineal50;
|FPRC;

|PROCESO Evento20;
     |SI enModoReg ! 4;  |ACABA;  |FINSI;

     |SI FSalida = 1;  |O FSalida = 2;
         |LEE 000#20=;

         |SI enModo = 4;
             |ESTADO_CONTROL nBotonAlta, "DISABLE";
             |ESTADO_CONTROL nBotonModi, "DISABLE";
             |ESTADO_CONTROL nBotonBaja, "DISABLE";
         |SINO;
             |ESTADO_CONTROL nBotonModi, "ENABLE";
             |ESTADO_CONTROL nBotonBaja, "ENABLE";
         |FINSI;

         |PULSATECLA;

         nEntrar   = 1;
         enModoReg = 4;
         |HAZ PintaDatosPantalla;
     |FINSI;

     |SI FSalida = 4;
         |SI enModo = 4;  |ACABA;  |FINSI;

         |HAZ Modificar;
     |FINSI;
|FPRC;

|PROCESO BotonesPanta;
     |CONTROL_SIMPLE nPanta, "BOTON,{{193}}&Alta ", 1564, 1574, Alta;
     nBotonAlta = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Modificar ", 1576, 1586, Modificar;
     nBotonModi = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{199}}&Borrar", 1588, 1598, Baja;
     nBotonBaja = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}}&Rendimientos", 0580, 0598, Rendimientos;
     nBotonRdto  = FSalida;

     |CONTROL_SIMPLE nPanta, "BOTON,{{197}} &Y", 1540, 1544, BotonCntr;
     nBotonCntr = FSalida;

     nEntrar = 0;

     |ESTADO_CONTROL nBotonModi,   "DISABLE";
     |ESTADO_CONTROL nBotonBaja,   "DISABLE";

     |SI enModo = 4;
         |ESTADO_CONTROL nBotonAlta, "DISABLE";
     |FINSI;
|FPRC;

|PROCESO Baja20;
     #20#0 = enEmpresa;
     #20#1 = 1;
|FPRC;

|PROCESO Alta20;
     #20#0 = enEmpresa;
     #20#1 = 99;
|FPRC;

|PROGRAMA;
     |HAZ CargaColores;

     enSwRetorno = 0;
     aQueQuiero  = "|NC";
     aNumCampos  = #20#aQueQuiero#;
     nNumCampos  = aNumCampos;
     nNumCampos  = nNumCampos - 1;
     nRango      = 4 + 8 + 16 + 32 + 128;
     enModoReg   = 4;

     |PINPA #0#624;  nPanta = FSalida;

     |HAZ BotonesPanta;

     |DDEFECTO #20;
     |HAZ PintaDatosPantalla;

     |ABRET #20;
     |ABRET #50;

     |LINEAL_SIMPLE #1#20, nRango, 0602, 1498, Baja20, Alta20, Evento20;
     nGrid = FSalida;

     |CONTROL_SIMPLE 0, "BOTON,{{001}}sa&Lir", 3488, 3498, Ptec806;
     enBtnSalir = FSalida;

     aEsc1  = &255 + "806";
     aEsc2  = &255 + "807";
     aRetu  = &255 + "802";
     |PARA; |SI;  |HACIENDO;
          FSalida = "::," + nGrid;
          |LEETECLA aTecla;
          |SI aTecla = aEsc1; |SAL;  |FINSI;
          |SI aTecla = aEsc2; |SAL;  |FINSI;

          |SI aTecla = aRetu;
              |HAZ Modificar;
          |FINSI;
     |SIGUE;

     |CIERRAT #20;
     |CIERRAT #50;

     eaPrograma   = "rem00024";
     eaPunto      = "  ";
     |HAZ ProgramaActivo;
|FPRO;
