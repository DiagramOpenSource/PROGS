|FICHEROS;
     reemi100;
     reacceso;

     rem00016;
     rem00017;
     rem00100;
     rem00101;
     rem00102;
     rem01001;
     rem01002;

     rerenpre;
     reauxpai;

     rem01010;
     rem01011;
     rem01012;
     rem01013;
     rem01014;
     rem01015;
     rem01018;
     rem01019;
     rem01021;
     rem01022;
     rem01023;
     rem01024;
     rem01025;
     rem01026;
     rem01027;
     rem01030;
     rem01031;
     rem01032;
     rem01033;
     rem01034;
     rem01035;
     rem01037;
     rem01039;
     rem01041;
     rem01042;
     rem01043;
     rem01045;
     rem01046;
     rem01047;
     rem01048;
     rem01049;
     rem01050;

     m100h001;

     &poblaci@;
     Referen@;
|FIN;

|VARIABLES;
     &eaModelo   = "";
     &enEmpresa  = 0;
     &enEmpr     = 0;
     &eaTipo     = "";
     &eaTipoBor  = "";
     &eaNif      = "";
     &eaCRLF     = "";
     &eaAlfa     = "";
     &enPagina   = 0;
     &enConDatos = 0;
     &enNumPags  = 0;
     &enHandle   = 0;
     &enSwFalle  = 0;

     &DiaInf    = "";
     MesNum     = "";
     &MesInf    = "";
     &EjerInf   = "";
     &enCodProv = 0;
     &enCodPobl = 0;
     &eaIP      = "";

     VEmpresa  = 0;
     Long      = 0;
     LongDec   = 0;
     nSwDatos  = 0;
     SwDatos   = 0;
     nSwPasa   = 0;
     nCharGrabados = 0;
     nTitul    = 0;
     nCampo1   = 0;
     nCampo2   = 0;
     nCampo3   = 0;
     nEmpr     = 0;
     nCont10   = 0;
     nCont     = 0;
     nCont1    = 0;
     nContC    = 0;
     nContCs   = 0;
     nConta    = 0;
     nContCas  = 0;
     nContRegs = 0;
     nCalc     = 0;
     nCalc1    = 0;
     nCalc2    = 0;
     Calc1     = 0;
     Calc2     = 0;
     nConCta   = 0;
     Bloque    = 0;
     SwError   = 0;
     nPYG      = 0;
     nApartados= 0;
     nDCampo   = 0;
     nHCampo   = 0;
     nVuelta   = 0;
     nTotal    = 0;
     nSusp     = 0;
     nNumFam   = 0;
     nNumPag   = 0;
     nNumPag1  = 0;
     nPagAct   = 0;
     nHijosTit = 0;
     nHijosCon = 0;
     nLong     = 0;
     nPos      = 0;
     SwSalir   = 0;
     nETAct    = 0;
     nEnAct    = 0;
     nNoHay1   = 0;
     nPag      = 0;
     nNumLin   = 0;
     nNumLin1  = 0;
     nNumLin2  = 0;
     nNumLin3  = 0;
     nNumLin4  = 0;
     nNumLinAnt= 0;
     nSwFiltraBarra = 0;

     aNifArrend   = "";
     aNifArrendEx = "";
     aNifOtroProg  = "";
     aNifOtroProg1 = "";
     aNifOtroProg2 = "";
     aNifOtroProg3 = "";
     aNifOtroProg4 = "";
     aNomOtroProg  = "";
     aNomOtroProg1 = "";
     aNomOtroProg2 = "";
     aNomOtroProg3 = "";
     aNomOtroProg4 = "";

     aLong     = "";
     Casilla   = "";
     VTipo     = "";
     aTipo     = "";
     aTipo2    = "";
     aNif      = "";
     Nombre    = "";
     Comodin   = "";
     Cadena    = "";
     Cadena1   = "";
     Cadena2   = "";
     Cadena3   = "";
     Cadena4   = "";
     aFicheros = "";
     aCasillas = "";
     aDCasilla = "";
     aHCasilla = "";
     aCampos   = "";
     Vacio1    = "";
     Vacio2    = "";

     aAlfa     = "";
     aAlfa1    = "";
     aAlfa2    = "";
     aAlfa3    = "";
     aAlfa4    = "";
     aAlfaC1   = "";
     aAlfaC2   = "";
     aCDoc     = "";
     aPDec     = "";

     TipoDato  = "";

     aNif1      = ""; aNif2      = "";
     aNombre1  = "";  aNombre2   = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aLocalB1   = ""; aLocalB2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aSexo1     = ""; aSexo2     = "";
     aMovil1    = ""; aMovil2    = "";
     aNivRe     = "";
     aSMS1      = ""; aSMS2      = "";
     aFAdoH     = ""; aFNacH     = "";
     aFNac1     = ""; aFNac2     = "";
     aCodPais1  = ""; aCodPais2  = "";
     aMinusval1 = ""; aMinusval2 = "";
     aTelef1    = ""; aTelef2    = "";
     aIglesia1  = ""; aIglesia2  = "";
     aEntidad1  = ""; aEntidad2  = "";
     aSucursal1 = ""; aSucursal2 = "";
     aDC1       = ""; aDC2       = "";
     &eaCuenta1 = ""; &eaCuenta2 = "";
     &eaBIC1    = ""; &eaBIC2    = "";
     aDom2P     = ""; aFra2P     = "";
     aRen2P     = ""; &aSeparada = "";

     aFax1      = ""; aFax2      = "";
     aTipNum1   = ""; aTipNum2   = "";
     aCalNum1   = ""; aCalNum2   = "";
     aDatComp1  = ""; aDatComp2  = "";
     aBloque1   = ""; aBloque2   = "";
     aPortal1   = ""; aPortal2   = "";
     aDomExtr1  = ""; aDomExtr2  = "";
     aDtCmpEx1  = ""; aDtCmpEx2  = "";
     aPoblExt1  = ""; aPoblExt2  = "";
     aEmailExt1 = ""; aEmailExt2 = "";
     aCPExt1    = ""; aCPExt2    = "";
     aEstExt1   = ""; aEstExt2   = "";
     aPaisExt1  = ""; aPaisExt2  = "";
     aCdPaisEx1 = ""; aCdPaisEx2 = "";
     aNacExtr1  = ""; aNacExtr2  = "";
     aRUEExtr1  = ""; aRUEExtr2  = "";

     aTlfExtr1  = ""; aTlfExtr2  = "";
     aFaxExtr1  = ""; aFaxExtr2  = "";
     aMovExtr1  = ""; aMovExtr2  = "";
     aNifDc1    = ""; aNifDc2    = "";
     aNifDc3    = ""; aNifDc4    = "";
     aCambioDom1 = ""; aCambioDom2 = "";

     aNifH  = ""; aNombH = "";
     aAnyoH = ""; aMinuH = "";
     aVincH = ""; aOtroH = "";

     nOrdDMuerto1 = 0;
     nOrdDMuerto2 = 0;
     aFecDMuerto1 = "";
     aFecDMuerto2 = "";
     aFecAMuerto1 = "";
     aFecAMuerto2 = "";
     aNifAMuerto1 = "";
     aNifAMuerto2 = "";

     aFamil  = "";

     aNom   = "";
     aApel1 = "";
     aApel2 = "";
     aTipoContrB = "";
     nInd   = 0;
     nNegativo = 0;
     nCambia   = 0;

     aDes      = "";
     aHas      = "";
     nDat      = 0;
     aRfC      = "";
     aTit      = "";
     aSit      = "";
     nPc1      = 0;
     nPc2      = 0;
     nCampo    = 0;
     nLinea    = 0;
     nOrden    = 0;
     nPasada   = 0;
     nReg1     = 0;
     nReg2     = 0;
     nNume     = 0;
     nGrabo    = 0;

     {12}nDescend = 0;
     {4}nAscend   = 0;
|FIN;

|PROCESO TipoContrB;
     |QBF aAlfa;
     |SI aAlfa = ""; aTipoContrB = "0"; |ACABA; |FINSI;
     |SI aSeparada = "S";
       aTipoContrB = "2";
     |SINO;
        aTipoContrB = "0";
        |SI aAlfa = "TITULAR";   aTipoContrB = "2"; |FINSI;
        |SI aAlfa = "CONYUGE";
           |SI enSwFalle = 1;
              aTipoContrB = "2";
           |SINO;
              |SI VTipo = "CONYUGE      ";aTipoContrB = "2"; |SINO;aTipoContrB = "3"; |FINSI;
           |FINSI;
        |FINSI;
        |SI aAlfa = "COMUNES";   aTipoContrB = "1"; |FINSI;
        |SI aAlfa = "CONJUNTA";  aTipoContrB = "1"; |FINSI;
        |SI aAlfa = "CONJUNTAE"; aTipoContrB = "1"; |FINSI;
        |SI aAlfa = "GANANCIAL"; aTipoContrB = "1"; |FINSI;
        |SI aAlfa = "1 FAMILIAR";aTipoContrB = "4"; |FINSI;
        |SI aAlfa = "2 FAMILIAR";aTipoContrB = "5"; |FINSI;
        |SI aAlfa = "3 FAMILIAR";aTipoContrB = "6"; |FINSI;
        |SI aAlfa = "4 FAMILIAR";aTipoContrB = "7"; |FINSI;
        |SI aAlfa = "VARIOS";    aTipoContrB = "2"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Epigrafe;
     |QBF aAlfa;
     |SI aAlfa = "9999"; aAlfa = ""; |FINSI;
     aLong = aAlfa % 0; nLong = aLong;

     |SI nLong = 4;
        aAlfa = (aAlfa % 0103) + "." + (aAlfa % 0401);
     |FINSI;
|FPRC;

|PROCESO CargaFecha;
     DiaInf   = #reemi100#33 % 102;
     MesNum   = #reemi100#33 % 402;
     MesInf   = #reemi100#33 % 402;
     EjerInf  = #reemi100#33 % -104;

     |SI MesNum = "01"; MesInf = "Enero     "; |FINSI;
     |SI MesNum = "02"; MesInf = "Febrero   "; |FINSI;
     |SI MesNum = "03"; MesInf = "Marzo     "; |FINSI;
     |SI MesNum = "04"; MesInf = "Abril     "; |FINSI;
     |SI MesNum = "05"; MesInf = "Mayo      "; |FINSI;
     |SI MesNum = "06"; MesInf = "Junio     "; |FINSI;
     |SI MesNum = "07"; MesInf = "Julio     "; |FINSI;
     |SI MesNum = "08"; MesInf = "Agosto    "; |FINSI;
     |SI MesNum = "09"; MesInf = "Septiembre"; |FINSI;
     |SI MesNum = "10"; MesInf = "Octubre   "; |FINSI;
     |SI MesNum = "11"; MesInf = "Noviembre "; |FINSI;
     |SI MesNum = "12"; MesInf = "Diciembre "; |FINSI;

     MesInf = MesInf > MesInf;
|FPRC;

|PROCESO FormateoB;
     |QBF aAlfa;
     |SI TipoDato = "F";
        aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";
        |QBF aAlfa;
        |SI aAlfa = "";         aAlfa = "0" * 8; |FINSI;
        |SI aAlfa = "01010000"; aAlfa = "0" * 8; |FINSI;
        |ACABA;
     |FINSI;
     |SI TipoDato = "N";
        Vacio1 = "0" * Long;
        Vacio2 = "0" * LongDec;
        aAlfa = aAlfa - "-";
        |SI FSalida ! 0;
           nNegativo = 1;
        |SINO;
           nNegativo = 0;
        |FINSI;
     |SINO;
        Vacio1 = " " * Long;
     |FINSI;

     |SI TipoDato ! "N";
        Calc1 = 100 + Long; aAlfa = (aAlfa + Vacio1) % Calc1;
     |SINO;
        |SI LongDec = 0;
           Calc1 = 0 - (100 + Long);
           aAlfa = (Vacio1 + aAlfa) % Calc1;
        |SINO;
           aAlfa = aAlfa - ".";
           |SI FSalida = 0;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa) % Calc1;
              aAlfa1 = "0" * LongDec;
           |SINO;
              Calc1 = (((FSalida / 100) ! 0) - 1) + 100;
              Calc2 = (((FSalida / 100) ! 0) * 100) + 99;
              aAlfa1 = aAlfa % Calc2;
              aAlfa = aAlfa % Calc1;
              Calc1 = 0 - (100 + Long);
              aAlfa = (Vacio1 + aAlfa)  % Calc1;
              Calc1 = 100 + LongDec;
              aAlfa1 = (aAlfa1 + Vacio2) % Calc1;
           |FINSI;
           aAlfa = aAlfa + aAlfa1;
        |FINSI;
        |SI nNegativo = 1;
           Calc1 = 0 - (100 + (Long + LongDec)); Calc1 = Calc1 + 1;
           aAlfa = aAlfa % Calc1;
           aAlfa = "N" + aAlfa;
        |FINSI;
     |FINSI;

     aAlfa2 = "";

     |SI TipoDato = "A"; |O TipoDato = "An";
        aLong = aAlfa % 0; nLong = aLong;
        |PARA nCont1 = 1; |SI nCont1 [ nLong; |HACIENDO nCont1 = nCont1 + 1;
           Calc1 = (nCont1 * 100) + 1; aAlfa1  = aAlfa % Calc1;
           aAlfa1 = aAlfa1 > aAlfa1;
           |SI aAlfa1 = " ";                  |VETE Sigue1; |FINSI;
           |SI aAlfa1 ] "A"; |Y aAlfa1 [ "Z"; |VETE Sigue1; |FINSI;
           |SI aAlfa1 ] "0"; |Y aAlfa1 [ "9"; |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "¥"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "¤"; aAlfa1 = &209;   |VETE Sigue1; |FINSI;
           ||SI aAlfa1 = "ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
           ||SI aAlfa1 = "Ç"; aAlfa1 = &199;   |VETE Sigue1; |FINSI;
           |SI nSwFiltraBarra = 1;
              |SI aAlfa1 = "/"; aAlfa1 = ".";    |VETE Sigue1; |FINSI;
           |FINSI;
           aAlfa4 = &128;
           |SI aAlfa1 = aAlfa4; aAlfa1 = "Ç";   |VETE Sigue1; |FINSI;
           aAlfa4 = &135;
           |SI aAlfa1 = aAlfa4; aAlfa1 = "ç";   |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "-"; aAlfa1 = &45;    |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "'"; aAlfa1 = &49;    |VETE Sigue1; |FINSI;
           |SI aAlfa1 = "/";                  |VETE Sigue1; |FINSI;
           |SI TipoDato = "An";
              |SI aAlfa1 = "&"; aAlfa1 = &38;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ","; aAlfa1 = &44;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "."; aAlfa1 = &46;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ":"; aAlfa1 = &58;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = ";"; aAlfa1 = &59;    |VETE Sigue1; |FINSI;
              |SI aAlfa1 = "_"; aAlfa1 = &95;    |VETE Sigue1; |FINSI;
           |FINSI;
           aAlfa1 = " ";
  |ET Sigue1;
           aAlfa2 = aAlfa2 + aAlfa1;
        |SIGUE;
        aAlfa = aAlfa2;
     |FINSI;
     Calc1 = aAlfa;
     |SI nSwDatos = 0; |Y Calc1 ! 0; nSwDatos = 1; |FINSI;
|FPRC;

|PROCESO BuscaPais;
     |ABRE #reauxpai;
     #reauxpai#0 = aAlfa;
     |LEE 000#reauxpai.=;
     |SI FSalida = 0;
        aAlfa = #reauxpai#2;
     |SINO;
        aAlfa = "   ";
     |FINSI;
     |CIERRA #reauxpai;
|FPRC;

|PROCESO SeparaNombre;
     aNom = ""; aApel1 = ""; aApel2 = "";
     nInd = 1;
     aLong = aAlfa % 0; nLong = aLong;
     aAlfa1 = "";
     |PARA nCalc = 1; |SI nCalc [ nLong; |HACIENDO nCalc = nCalc + 1;
        nPos = (nCalc * 100) + 1;
        aAlfa2 = aAlfa % nPos;
        |SI aAlfa2 = " "; |O aAlfa2 = ",";
           |SI aAlfa1 ! "DE";  |Y aAlfa1 ! "de";
            |Y aAlfa1 ! "LA";  |Y aAlfa1 ! "la";
            |Y aAlfa1 ! "LAS"; |Y aAlfa1 ! "las";
            |Y aAlfa1 ! "LOS"; |Y aAlfa1 ! "los";
            |Y aAlfa1 ! "DEL"; |Y aAlfa1 ! "del";
              |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
              |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
              |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
               nInd = nInd + 1;
           |SINO;
              |SI nInd > 1; nInd = nInd - 1; |FINSI;
              |SI nInd = 1; |Y aAlfa1 ! ""; aApel1 = aApel1 + aAlfa1 + " "; |FINSI;
              |SI nInd = 2; |Y aAlfa1 ! ""; aApel2 = aApel2 + aAlfa1 + " "; |FINSI;
              |SI nInd ] 3; |Y aAlfa1 ! ""; aNom   = aNom   + aAlfa1 + " "; |FINSI;
           |FINSI;
           aAlfa1 = "";
        |SINO;
           aAlfa1 = aAlfa1 + aAlfa2;
        |FINSI;
     |SIGUE;

     |PARA; |SI SwSalir = 0; |HACIENDO;
        SwSalir = 1;
        aAlfa1 = aApel1 % 0101;
        |SI aAlfa1 = " "; aApel1 = aApel1 % 0299; SwSalir = 0; |FINSI;
        aAlfa1 = aApel2 % 0101;
        |SI aAlfa1 = " "; aApel2 = aApel2 % 0299; SwSalir = 0; |FINSI;
        aAlfa1 = aNom   % 0101;
        |SI aAlfa1 = " "; aNom   = aNom   % 0299; SwSalir = 0; |FINSI;
     |SIGUE;
|FPRC;

|PROCESO BuscaCasillaB;
     |SELECT #2#rem01002;
     #rem01002#0 = VEmpresa;
     #rem01002#1 = 0;
     #rem01002#2 = VTipo;
     #rem01002#3 = Bloque;
     #rem01002#5 = Casilla;
     |LEE 010#rem01002.=;
     |SI FSalida = 0;
         Casilla = #rem01002#7;
         SwError = 0;
     |SINO;
         Casilla = 0; SwError = 1;
     |FINSI;
|FPRC;

|PROCESO GrabaCadB;
     |XGRABA enHandle, Cadena; Cadena = "";
|FPRC;

|PROCESO RecogeFam;
     |SI #rem00101#4 = "DESCENDIENTE";
        nDescend = #rem00101#1; InDescend = InDescend + 1;
        |SI #rem00101#16 = "X"; |O #rem00101#16 = "Z";
           aCDoc = "1";
        |FINSI;
        |SI #rem00101#16 = "D"; |O #rem00101#16 = "Z";
           aPDec = "1";
        |FINSI;
     |SINO;
        nAscend = #rem00101#1;  InAscend = InAscend + 1;
     |FINSI;
|FPRC;

|DEFBUCLE RecogeFam;
     #rem00101#1;
     ;
     #rem00100#0, 01;
     #rem00100#0, 99;
     ;
     NULL, RecogeFam;
|FIN;

|PROCESO CargaDatos;
     aAlfa = VTipo; |QBF aAlfa;

     aSMS1      = ""; aSMS2      = "";
     aNif1      = ""; aNif2      = "";
     aApell11   = ""; aApell12   = "";
     aApell21   = ""; aApell22   = "";
     aC1        = ""; aC2        = "";
     aSg1       = ""; aSg2       = "";
     aCalle1    = ""; aCalle2    = "";
     aNumero1   = ""; aNumero2   = "";
     aEscalera1 = ""; aEscalera2 = "";
     aPiso1     = ""; aPiso2     = "";
     aPuerta1   = ""; aPuerta2   = "";
     aLocali1   = ""; aLocali2   = "";
     aLocalB1   = ""; aLocalB2   = "";
     aCP1       = ""; aCP2       = "";
     aProvin1   = ""; aProvin2   = "";
     aEC1       = ""; aEC2       = "";
     aAnyoN1    = ""; aAnyoN2    = "";
     aFNac1     = ""; aFNac2     = "";
     aSexo1     = ""; aSexo2     = "";
     aCodPais1  = "";  aCodPais2  = "";
     aMinusval1 = "0"; aMinusval2 = "";
     aTelef1    = "";  aTelef2    = "";
     aIglesia1  = "";  aIglesia2  = "";
     aMovil1    = "";  aMovil2    = "";

     aFax1      = "";  aFax2      = "";
     aTipNum1   = "";  aTipNum2   = "";
     aCalNum1   = "";  aCalNum2   = "";
     aDatComp1  = "";  aDatComp2  = "";
     aBloque1   = "";  aBloque2   = "";
     aPortal1   = "";  aPortal2   = "";
     aDomExtr1  = "";  aDomExtr2  = "";
     aDtCmpEx1  = "";  aDtCmpEx2  = "";
     aPoblExt1  = "";  aPoblExt2  = "";
     aEmailExt1 = "";  aEmailExt2 = "";
     aCPExt1    = "";  aCPExt2    = "";
     aEstExt1   = "";  aEstExt2   = "";
     aPaisExt1  = "";  aPaisExt2  = "";
     aCdPaisEx1 = "";  aCdPaisEx2 = "";
     aTlfExtr1  = "";  aTlfExtr2  = "";
     aFaxExtr1  = "";  aFaxExtr2  = "";
     aMovExtr1  = "";  aMovExtr2  = "";
     aNacExtr1  = "0"; aNacExtr2  = "0";
     aRUEExtr1  = "";  aRUEExtr2  = "";

     aCambioDom1 = ""; aCambioDom2 = "";

     aAlfa1 = aAlfa - " FAMILIAR";
     |SI FSalida ! 0;
        aFamil = "S";
        |QBF aAlfa1; nCalc = aAlfa1;
        #rem00101#0 = #rem00100#0;
        #rem00101#1 = 1;
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0; |HACIENDO;
           |SI #rem00101#13 = "S";
              nCalc = nCalc - 1;
              |SI nCalc = 0;
                 |SI #rem00101#6 < 33; aMinusval1 = 0; |FINSI;
                 |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "N"; aMinusval1 = 1; |FINSI;
                 |SI #rem00101#6 ] 33; |Y #rem00101#6 < 65; |Y #rem00101#14 = "S"; aMinusval1 = 2; |FINSI;
                 |SI #rem00101#6 ] 65; aMinusval1 = 3; |FINSI;
                 enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
                 aNif1 = #rem00101#2;
                 aAlfa = #rem00101#3; |HAZ SeparaNombre;
                 aApell11 = aApel1;   aApell12 = aApel2;   aNombre1  = aNom;
                 aC1        = #rem00101#16;   aSg1     = #rem00100#14;
                 aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
                 aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
                 aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
                 aLocalB1   = #rem00100#119;
                 aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
                 aProvin1   = #poblaci@#2;
                 aEC1       = "S";            aAnyoN1    = #rem00101#5;
                 aFNac1     = #rem00101#17;   aSexo1     = #rem00101#20;
                 aCodPais1  = #rem00100#107;  aTelef1    = #rem00100#12;
                 aIglesia1  = #rem00100#59;
                 eaCuenta1  = #rem00101#25;   eaBIC1     = #rem00101#26;
                 aMovil1    = #rem00100#109;  aSMS1      = #rem00100#111;
                 aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
                 aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
                 aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
                 aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
                 aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
                 aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
                 aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
                 aPaisExt1  = #rem00100#127;
                 |SI #rem00101#16 = "X";
                    aCambioDom1 = "S";
                 |SINO;
                    aCambioDom1 = "N";
                 |FINSI;
                 |ABRE #reauxpai;
                 #reauxpai#0 = #rem00100#126;
                 |LEE 000#reauxpai.=;
                 |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
                 |CIERRA #reauxpai;
                 aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
                 aMovExtr1  = #rem00100#109;
              |SINO;
                 |LEE 000#rem00101.s;
              |FINSI;
           |SINO;
              |LEE 000#rem00101.s;
           |FINSI;
        |SIGUE;

        aAlfa = eaCuenta1; |QBF aAlfa;
        |SI aAlfa = ""; eaCuenta1 = " " * 34;  |FINSI;

        aAlfa = eaBIC1; |QBF aAlfa;
        |SI aAlfa = ""; eaBIC1 = " " * 11;  |FINSI;

        aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;

        |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
        |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
        |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
        |SI aSexo2 = "";  aSexo2 = " "; |FINSI;
        |ACABA;
     |SINO;
        aFamil = "N";
     |FINSI;

     |SI aAlfa = "TITULAR"; |O aAlfa = "CONJUNTA";
        |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
        |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
        enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
        aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
        aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
        aC1        = #rem00100#100;  aSg1     = #rem00100#14;
        aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
        aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
        aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
        aLocalB1   = #rem00100#119;
        aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103)
        aProvin1   = #poblaci@#2;
        aEC1       = #rem00100#6;    aAnyoN1  = #rem00100#7;
        aFNac1     = #rem00100#103;  aSexo1   = #rem00100#105;
        aCodPais1  = #rem00100#107;  aTelef1  = #rem00100#12;
        aIglesia1  = #rem00100#59;   aMovil1  = #rem00100#109;
        aSMS1      = #rem00100#111;
        aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
        aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
        aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
        aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
        aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
        aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
        aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
        aPaisExt1  = #rem00100#127;
        aCambioDom1 = #rem00100#145;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#126;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
        aMovExtr1  = #rem00100#109;
        |SI aAlfa = "TITULAR";
            eaCuenta1  = #rem00100#147;
            eaBIC1     = #rem00100#154;
        |FINSI;

        |SI aAlfa = "CONJUNTA";
            eaCuenta1  = #rem00100#149;
            eaBIC1     = #rem00100#156;
        |FINSI;

        |SI #rem00100#41 < 33; aMinusval2 = 0; |FINSI;
        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval2 = 1; |FINSI;
        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval2 = 2; |FINSI;
        |SI #rem00100#41 ] 65; aMinusval2 = 3; |FINSI;
        enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
        aNif2      = #rem00100#35;   aNombre2 = #rem00100#38;
        aApell21   = #rem00100#36;   aApell22 = #rem00100#37;
        aC2        = #rem00100#101;  aSg2     = #rem00100#44;
        aCalle2    = #rem00100#45;   aNumero2 = #rem00100#46;
        aEscalera2 = #rem00100#47;   aPiso2   = #rem00100#48;
        aPuerta2   = #rem00100#49;   aLocali2 = #rem00100#52;
        aLocalB2   = #rem00100#136;
        aCP2       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
        aProvin2   = #poblaci@#2;         aAnyoN2   = #rem00100#40;
        aFNac2     = #rem00100#104;  aCodPais2 = #rem00100#108;
        aTelef2    = #rem00100#13;   aSexo2 = #rem00100#106;
        aIglesia2  = #rem00100#60;   aMovil2  = #rem00100#110;
        aSMS2      = #rem00100#128;
        aFax2      = #rem00100#129;  aTipNum2   = #rem00100#131;
        aCalNum2   = #rem00100#132;  aDatComp2  = #rem00100#135;
        aBloque2   = #rem00100#133;  aPortal2   = #rem00100#134;
        aDomExtr2  = #rem00100#137;  aDtCmpEx2  = #rem00100#138;
        aPoblExt2  = #rem00100#139;  aEmailExt2 = #rem00100#140;
        aCPExt2    = #rem00100#141;  aEstExt2   = #rem00100#142;
        aPaisExt2  = #rem00100#144;  aCambioDom2 = #rem00100#146;
        aNacExtr2  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#143;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr2  = #rem00100#13;   aFaxExtr2  = #rem00100#129;
        aMovExtr2  = #rem00100#110;

        |SI aAlfa = "TITULAR";
            eaCuenta2  = #rem00100#148;
            eaBIC2     = #rem00100#155;
        |FINSI;

        |SI aAlfa = "CONJUNTA";
            eaCuenta2  = #rem00100#149;
            eaBIC2     = #rem00100#156;
        |FINSI;

        |SI #rem00100#91 = "C";
           aEC1 = "V";
           aNif2      = "";   aNombre2 = "";
           aApell21   = "";   aApell22 = "";
           aC2        = "";   aSg2     = "";
           aCalle2    = "";   aNumero2 = "";
           aEscalera2 = "";   aPiso2   = "";
           aPuerta2   = "";   aLocali2 = "";
           aCP2       = "";   aSexo2   = "";
           aProvin2   = "";   aAnyoN2   = "";
           aFNac2     = "";   aCodPais2 = "";
           aMinusval2 = "0";  aTelef2   = "";
           aMovil2    = "";   aFax2 = "";
           aTipNum2   = "";   aCalNum2   = "";
           aDatComp2  = "";   aBloque2   = "";
           aPortal2   = "";   aDomExtr2  = "";
           aDtCmpEx2  = "";   aPoblExt2  = "";
           aEmailExt2 = "";   aCPExt2    = "";
           aEstExt2   = "";   aPaisExt2  = "";
           aCdPaisEx2 = "";   aTlfExtr2  = "";
           aFaxExtr2  = "";   aMovExtr2  = "";
           aNacExtr2  = "0";  aRUEExtr2  = "0";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;

     |SI aAlfa = "CONYUGE";
        |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
        |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
        |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
        enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
        aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
        aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
        aC1        = #rem00100#101;  aSg1     = #rem00100#44;
        aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
        aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
        aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
        aLocalB1   = #rem00100#136;
        aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
        aEC1       = #rem00100#6;
        aProvin1   = #poblaci@#2;         aAnyoN1  = #rem00100#40;
        aFNac1     = #rem00100#104;  aSexo1   = #rem00100#106;
        aCodPais1  = #rem00100#108;  aTelef1  = #rem00100#13;
        aIglesia1  = #rem00100#60;
        eaCuenta1  = #rem00100#148;  eaBIC2     = #rem00100#155;
        aMovil1    = #rem00100#110;  aSMS1      = #rem00100#128;
        aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
        aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#135;
        aBloque1   = #rem00100#133;  aPortal1   = #rem00100#134;
        aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
        aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#140;
        aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
        aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
        aNacExtr1  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#143;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
        aMovExtr1  = #rem00100#110;
        |SI #rem00100#8 < 33; aMinusval2 = 0; |FINSI;
        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval2 = 1; |FINSI;
        |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval2 = 2; |FINSI;
        |SI #rem00100#8 ] 65; aMinusval2 = 3; |FINSI;
        enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
        aNif2      = #rem00100#1;    aNombre2 = #rem00100#4;
        aApell21   = #rem00100#2;    aApell22 = #rem00100#3;
        aC2        = #rem00100#100;  aSg2     = #rem00100#14;
        aCalle2    = #rem00100#15;   aNumero2 = #rem00100#16;
        aEscalera2 = #rem00100#17;   aPiso2   = #rem00100#18;
        aPuerta2   = #rem00100#19;   aLocali2 = #rem00100#22;
        aLocalB2   = #rem00100#119;
        aCP2       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
        aProvin2   = #poblaci@#2;    aAnyoN2    = #rem00100#7;
        aFNac2     = #rem00100#103;  aCodPais2  = #rem00100#107;
        aTelef2    = #rem00100#12;   aSexo2     = #rem00100#105;
        aIglesia2  = #rem00100#59;
        eaCuenta2  = #rem00100#147;  eaBIC2     = #rem00100#154;
        aMovil2    = #rem00100#109;  aSMS2      = #rem00100#111;
        aFax2      = #rem00100#112;  aTipNum2   = #rem00100#114;
        aCalNum2   = #rem00100#115;  aDatComp2  = #rem00100#118;
        aBloque2   = #rem00100#116;  aPortal2   = #rem00100#117;
        aDomExtr2  = #rem00100#120;  aDtCmpEx2  = #rem00100#121;
        aPoblExt2  = #rem00100#122;  aEmailExt2 = #rem00100#123;
        aCPExt2    = #rem00100#124;  aEstExt2   = #rem00100#125;
        aPaisExt2  = #rem00100#127;  aCambioDom2 = #rem00100#145;
        aNacExtr2  = #rem00100#150;  aRUEExtr2  = #rem00100#157;
        |ABRE #reauxpai;
        #reauxpai#0 = #rem00100#126;
        |LEE 000#reauxpai.=;
        |SI FSalida = 0; aCdPaisEx2 = #reauxpai#2; |SINO; aCdPaisEx2 = ""; |FINSI;
        |CIERRA #reauxpai;
        aTlfExtr2  = #rem00100#12;   aFaxExtr2  = #rem00100#112;
        aMovExtr2  = #rem00100#109;
        |SI #rem00100#91 = "T";
           aEC1 = "V";

           aNif2      = "";   aNombre2 = "";
           aApell21   = "";   aApell22 = "";
           aC2        = "";   aSg2     = "";
           aCalle2    = "";   aNumero2 = "";
           aEscalera2 = "";   aPiso2   = "";
           aPuerta2   = "";   aLocali2 = "";
           aCP2       = "";   aSexo2   = "";
           aProvin2   = "";   aAnyoN2   = "";
           aFNac2     = "";   aCodPais2 = "";
           aMinusval2 = "0";  aTelef2   = "";
           aMovil2    = ""; aFax2 = "";
           aTipNum2   = "";   aCalNum2   = "";
           aDatComp2  = "";   aBloque2   = "";
           aPortal2   = "";   aDomExtr2  = "";
           aDtCmpEx2  = "";   aPoblExt2  = "";
           aEmailExt2 = "";   aCPExt2    = "";
           aEstExt2   = "";   aPaisExt2  = "";
           aCdPaisEx2 = "";   aTlfExtr2  = "";
           aFaxExtr2  = "";   aMovExtr2  = "";
           aNacExtr2  = "0";  aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;

     |SI aAlfa = "CONJUNTAE";
        |SI #rem00100#91 = "T";
           |SI #rem00100#41 < 33; aMinusval1 = 0; |FINSI;
           |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "N"; aMinusval1 = 1; |FINSI;
           |SI #rem00100#41 ] 33; |Y #rem00100#41 < 65; |Y #rem00100#42 = "S"; aMinusval1 = 2; |FINSI;
           |SI #rem00100#41 ] 65; aMinusval1 = 3; |FINSI;
           enCodProv = #rem00100#50; enCodPobl = #rem00100#51; |HAZ LeePoblacion;
           aNif1      = #rem00100#35;   aNombre1 = #rem00100#38;
           aApell11   = #rem00100#36;   aApell12 = #rem00100#37;
           aC1        = #rem00100#101;  aSg1     = #rem00100#44;
           aCalle1    = #rem00100#45;   aNumero1 = #rem00100#46;
           aEscalera1 = #rem00100#47;   aPiso1   = #rem00100#48;
           aPuerta1   = #rem00100#49;   aLocali1 = #rem00100#52;
           aLocalB1   = #rem00100#136;
           aCP1       = (("00" + #rem00100#50) % -102) + (("000" + #rem00100#51) % -103);
           aEC1       = "V";            aSexo1     = #rem00100#106;
           aProvin1   = #poblaci@#2;    aAnyoN1    = #rem00100#40;
           aFNac1     = #rem00100#104;  aCodPais1  = #rem00100#108;
           aTelef1    = #rem00100#13;   aMovil1    = #rem00100#110;
           aIglesia1  = #rem00100#60;
           eaCuenta1  = #rem00100#148;  eaBIC1     = #rem00100#155;
           aSMS1      = #rem00100#128;
           aFax1      = #rem00100#129;  aTipNum1   = #rem00100#131;
           aCalNum1   = #rem00100#132;  aDatComp1  = #rem00100#135;
           aBloque1   = #rem00100#133;  aPortal1   = #rem00100#134;
           aDomExtr1  = #rem00100#137;  aDtCmpEx1  = #rem00100#138;
           aPoblExt1  = #rem00100#139;  aEmailExt1 = #rem00100#140;
           aCPExt1    = #rem00100#141;  aEstExt1   = #rem00100#142;
           aPaisExt1  = #rem00100#144;  aCambioDom1 = #rem00100#146;
           aNacExtr1  = #rem00100#152;  aRUEExtr1  = #rem00100#158;
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#143;
           |LEE 000#reauxpai.=;
           |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
           |CIERRA #reauxpai;

           aTlfExtr1  = #rem00100#13;   aFaxExtr1  = #rem00100#129;
           aMovExtr1  = #rem00100#110;
        |SINO;
           |SI #rem00100#8 < 33; aMinusval1 = 0; |FINSI;
           |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "N"; aMinusval1 = 1; |FINSI;
           |SI #rem00100#8 ] 33; |Y #rem00100#8 < 65; |Y #rem00100#9 = "S"; aMinusval1 = 2; |FINSI;
           |SI #rem00100#8 ] 65; aMinusval1 = 3; |FINSI;
           enCodProv = #rem00100#20; enCodPobl = #rem00100#21; |HAZ LeePoblacion;
           aNif1      = #rem00100#1;    aNombre1 = #rem00100#4;
           aApell11   = #rem00100#2;    aApell12 = #rem00100#3;
           aC1        = #rem00100#100;  aSg1     = #rem00100#14;
           aCalle1    = #rem00100#15;   aNumero1 = #rem00100#16;
           aEscalera1 = #rem00100#17;   aPiso1   = #rem00100#18;
           aPuerta1   = #rem00100#19;   aLocali1 = #rem00100#22;
           aLocalB1   = #rem00100#119;
           aCP1       = (("00" + #rem00100#20) % -102) + (("000" + #rem00100#21) % -103);
           aProvin1   = #poblaci@#2;
           aEC1       = "V";            aAnyoN1   = #rem00100#7;
           aFNac1     = #rem00100#103;  aSexo1     = #rem00100#105;
           aCodPais1  = #rem00100#107;  aTelef1    = #rem00100#12;
           aIglesia1  = #rem00100#60;
           eaCuenta1  = #rem00100#147;  eaBIC1     = #rem00100#154;
           aMovil1    = #rem00100#109;  aSMS1      = #rem00100#111;
           aFax1      = #rem00100#112;  aTipNum1   = #rem00100#114;
           aCalNum1   = #rem00100#115;  aDatComp1  = #rem00100#118;
           aBloque1   = #rem00100#116;  aPortal1   = #rem00100#117;
           aDomExtr1  = #rem00100#120;  aDtCmpEx1  = #rem00100#121;
           aPoblExt1  = #rem00100#122;  aEmailExt1 = #rem00100#123;
           aCPExt1    = #rem00100#124;  aEstExt1   = #rem00100#125;
           aPaisExt1  = #rem00100#127;  aCdPaisEx1 = #rem00100#126;
           aNacExtr1  = #rem00100#150;  aRUEExtr1  = #rem00100#157;
           aCambioDom1 = #rem00100#145;
           |ABRE #reauxpai;
           #reauxpai#0 = #rem00100#126;
           |LEE 000#reauxpai.=;
           |SI FSalida = 0; aCdPaisEx1 = #reauxpai#2; |SINO; aCdPaisEx1 = ""; |FINSI;
           |CIERRA #reauxpai;
           aTlfExtr1  = #rem00100#12;   aFaxExtr1  = #rem00100#112;
           aMovExtr1  = #rem00100#109;
        |FINSI;
        aNif2      = "";   aNombre2 = "";
        aApell21   = "";   aApell22 = "";
        aC2        = "";   aSg2     = "";
        aCalle2    = "";   aNumero2 = "";
        aEscalera2 = "";   aPiso2   = "";
        aPuerta2   = "";   aLocali2 = "";
        aLocalB2   = "";
        aCP2       = "";   aSMS2    = "";
        aProvin2   = "";   aAnyoN2  = "";
        aMinusval2 = "0";  aTelef2  = "";
        aIglesia2  = "";
        eaCuenta2  = "";   eaBIC2     = "";
        aMovil2    = "";   aSexo2     = "";
        aFax2      = "";
        aTipNum2   = "";   aCalNum2   = "";
        aDatComp2  = "";   aBloque2   = "";
        aPortal2   = "";   aDomExtr2  = "";
        aDtCmpEx2  = "";   aPoblExt2  = "";
        aEmailExt2 = "";   aCPExt2    = "";
        aEstExt2   = "";   aPaisExt2  = "";
        aCdPaisEx2 = "";   aTlfExtr2  = "";
        aFaxExtr2  = "";   aMovExtr2  = "";
        aNacExtr2  = "0";  aRUEExtr2  = "";
        aCambioDom2 = "";
     |FINSI;

     aAlfa = eaCuenta1; |QBF aAlfa;
     |SI aAlfa = "";  eaCuenta1 = " " * 34;  |FINSI;

     aAlfa = eaCuenta2; |QBF aAlfa;
     |SI aAlfa = ""; eaCuenta2 = " " * 34; |FINSI;

     aAlfa = eaBIC1; |QBF aAlfa;
     |SI aAlfa = "";  eaBIC1 = " " * 11;  |FINSI;

     aAlfa = eaBIC2; |QBF aAlfa;
     |SI aAlfa = ""; eaBIC2 = " " * 11; |FINSI;

     |QBF aTelef1; |QBF aTelef2;

     |SI aC1 = "X"; |O aC1 = "Z";
        |SI aTelef1 = ""; aTelef1 = aTelef2; |FINSI;
     |FINSI;
     |SI aC2 = "X"; |O aC2 = "Z";
        |SI aTelef2 = ""; aTelef2 = aTelef1; |FINSI;
     |FINSI;

     |SI #reemi100#34 = "F";
        |SI aC1 = "X";  |O aC1 = "Z";
           aSg1     = ""; aCalle1  = ""; aNumero1 = ""; aEscalera1 = "";
           aPiso1   = ""; aPuerta1 = ""; aLocali1 = ""; aCP1       = "";
           aProvin1 = "";                aFNac1   = ""; aSexo1     = "";
           aCodPais1  = ""; aMovil1 = "";
        |FINSI;
        |SI aC2 = "X"; |O aC2 = "Z";
           aSg2     = ""; aCalle2  = ""; aNumero2 = ""; aEscalera2 = "";
           aPiso2   = ""; aPuerta2 = ""; aLocali2 = ""; aCP2       = "";
           aProvin2 = ""; aSexo2   = ""; aFNac2   = ""; aCodPais2  = "";
           aMovil2  = "";
        |FINSI;
     |FINSI;

     aAlfa = aCodPais1; |HAZ BuscaPais; aCodPais1 = aAlfa;
     aAlfa = aCodPais2; |HAZ BuscaPais; aCodPais2 = aAlfa;

     TipoDato = "F"; aAlfa = aFNac1; |HAZ FormateoB; aFNac1 = aAlfa;
     TipoDato = "F"; aAlfa = aFNac2; |HAZ FormateoB; aFNac2 = aAlfa;
     TipoDato = "F"; aAlfa = aFNacH; |HAZ FormateoB; aFNacH = aAlfa;
     TipoDato = "F"; aAlfa = aFAdoH; |HAZ FormateoB; aFAdoH = aAlfa;
     |SI aFNac1 = "          "; aFNac1 = "00000000"; |FINSI;
     |SI aFNac2 = "          "; aFNac2 = "00000000"; |FINSI;
     |SI aFNacH = "          "; aFNacH = "00000000"; |FINSI;
     |SI aFAdoH = "          "; aFAdoH = "00000000"; |FINSI;

     |SI aSexo1 = "V"; aSexo1 = "H"; |FINSI;
     |SI aSexo1 = "";  aSexo1 = " "; |FINSI;
     |SI aSexo2 = "V"; aSexo2 = "H"; |FINSI;
     |SI aSexo2 = "";  aSexo2 = " "; |FINSI;

     nCambia = 0;
     |SI aSg1 ! aSg2; |O aCalle1 ! aCalle2; |O aNumero1 ! aNumero2;
      |O aEscalera1 ! aEscalera2; |O aPiso1 ! aPiso2; |O aPuerta1 ! aPuerta2;
      |O aLocali1 ! aLocali2;
        nCambia = 1;
     |FINSI;

     aAlfa = VTipo; |QBF aAlfa;
     |SI aAlfa = "CONJUNTA"; |O aAlfa = "CONJUNTAE";
        |SI nCambia = 0;
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
           aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
           aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
           aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
           aCPExt2    = ""; aEstExt2   = "";
           aPaisExt2  = ""; aCdPaisEx2 = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
        |FINSI;
     |FINSI;

     |SI aAlfa ! "CONJUNTA"; |Y aAlfa ! "CONJUNTAE";
        aSg2       = ""; aCalle2    = "";
        aNumero2   = ""; aEscalera2 = "";
        aPiso2     = ""; aPuerta2   = ""; aLocali2   = "";
        aLocalB2   = ""; aCP2       = ""; aProvin2   = "";
        aCodPais2  = ""; aTipNum2   = ""; aCalNum2   = "";
        aDatComp2  = ""; aBloque2   = ""; aPortal2   = "";
        aDomExtr2  = ""; aDtCmpEx2  = ""; aPoblExt2  = "";
        aCPExt2    = ""; aEstExt2   = "";
        aPaisExt2  = ""; aCdPaisEx2 = "";
        aNacExtr2  = "0";aRUEExtr2  = "";
     |FINSI;

     |QBF aApell11;  |QBF aApell12;  |QBF aNombre1;
     |QBF aApell21;  |QBF aApell22;  |QBF aNombre2;

     |QBF aCP1;
     |SI aCP1 = ""; aCP1 = "00000"; |FINSI;

     |QBF aCP2;
     |SI aCP2 = ""; aCP2 = "00000"; |FINSI;
|FPRC;

|PROCESO Inicializa;
     VTipo = eaTipo;
     aTipo = VTipo % 0110;

     |SI #rem00100#91 = "C"; |Y #m100h001#12 = "2";
        |SI aTipo = "TITULAR   "; |O aTipo = "CONJUNTA  "; |O aTipo = "CONJUNTAE ";
           #m100h001#12 = "3";

           aNif2      = ""; aApell21   = "";
           aApell22   = ""; aC2        = "";
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = "";
           aLocali2   = ""; aCP2       = "";
           aProvin2   = ""; aEC2       = "";
           aAnyoN2    = ""; aFNac2     = "";
           aCodPais2  = ""; aMinusval2 = "";
           aTelef2    = ""; aIglesia2  = "";
           aNombre2   = ""; aSexo2     = " ";
           aMovil2    = ""; aFax2      = "";
           aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = "";
           aPortal2   = ""; aDomExtr2  = "";
           aDtCmpEx2  = ""; aPoblExt2  = "";
           aEmailExt2 = ""; aCPExt2    = "";
           aEstExt2   = ""; aPaisExt2  = "";
           aCdPaisEx2 = ""; aTlfExtr2  = "";
           aFaxExtr2  = ""; aMovExtr2  = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;

     |SI #rem00100#91 = "T"; |Y #m100h001#12 = "2";
        |SI aTipo = "CONYUGE   "; |O aTipo = "CONJUNTAE ";
           #m100h001#12 = "3";

           aNif2      = ""; aApell21   = "";
           aApell22   = ""; aC2        = "";
           aSg2       = ""; aCalle2    = "";
           aNumero2   = ""; aEscalera2 = "";
           aPiso2     = ""; aPuerta2   = "";
           aLocali2   = ""; aCP2       = "";
           aProvin2   = ""; aEC2       = "";
           aAnyoN2    = ""; aFNac2     = "";
           aCodPais2  = ""; aMinusval2 = "";
           aTelef2    = ""; aIglesia2  = "";
           aNombre2   = ""; aSexo2     = " ";
           aMovil2    = ""; aFax2      = "";
           aTipNum2   = ""; aCalNum2   = "";
           aDatComp2  = ""; aBloque2   = "";
           aPortal2   = ""; aDomExtr2  = "";
           aDtCmpEx2  = ""; aPoblExt2  = "";
           aEmailExt2 = ""; aCPExt2    = "";
           aEstExt2   = ""; aPaisExt2  = "";
           aCdPaisEx2 = ""; aTlfExtr2  = "";
           aFaxExtr2  = ""; aMovExtr2  = "";
           aNacExtr2  = "0";aRUEExtr2  = "";
           aCambioDom2 = "";
        |FINSI;
     |FINSI;
|FPRC;

|PROCESO MiraViv;
     nDat   = 0;
     aRfC   = "";
     aTit   = "";
     nPc1   = "";
     nPc2   = "";
     aSit   = "";

     aAlfa1 = aTipo;       |QBF aAlfa1;
     aAlfa2 = #rem00102#2; |QBF aAlfa2;
     |SI aAlfa1 = aAlfa2;
         aTit = #rem00102#9;
         nPc1 = 0;
         nPc2 = 0;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             nPc1 = 100;
             nDat = 1;
         |FINSI;

         |ACABA;
     |FINSI;

     aAlfa = #rem00102#2; |QBF aAlfa;
     aAlfa = aAlfa - "FAMILIAR";
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI aTipo = "TITULAR";  |O aTipo = "CONJUNTA";
         aTit = #rem00102#9;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI #rem00100#91 = " ";
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#3;
                 nPc2 = #rem00102#4;
             |FINSI;
         |SINO;
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100;             |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;              |FINSI;
             |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#3;     |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONYUGE";
         aTit = #rem00102#9;
         aRfC = #rem00102#11;
         aSit = #rem00102#14;

         |SI #rem00100#91 = " ";
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#4;
                 nPc2 = #rem00102#3;
             |FINSI;
         |SINO;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100;             |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;              |FINSI;
             |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#4;     |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONJUNTAE";
         aTit = #rem00102#9;
         aRfC  = #rem00102#11;
         aSit = #rem00102#14;
         |SI #rem00100#91 = " ";
             aTit = #rem00102#9;
             |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0;   |FINSI;
             |SI #rem00102#2 = "CONYUGE   "; nPc1 = 0;   nPc2 = 100; |FINSI;
             |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;  nPc2 = 50;  |FINSI;
             |SI #rem00102#2 = "VARIOS    ";
                 nPc1 = #rem00102#3;
                 nPc2 = #rem00102#4;
             |FINSI;
          |SINO;
             |SI #rem00100#91 = "C";
                 |SI #rem00102#2 = "TITULAR   "; nPc1 = 100; nPc2 = 0; |FINSI;
                 |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;            |FINSI;
                 |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#3;   |FINSI;
             |FINSI;

             |SI #rem00100#91 = "T";
                 |SI #rem00102#2 = "CONYUGE   "; nPc1 = 100; nPc2 = 0; |FINSI;
                 |SI #rem00102#2 = "GANANCIAL "; nPc1 = 50;            |FINSI;
                 |SI #rem00102#2 = "VARIOS    "; nPc1 = #rem00102#4;   |FINSI;
             |FINSI;
         |FINSI;

         |SI aTit = "3";  |O aTit = "4";
             nDat = 1;
         |FINSI;

         |SI aTit = "1";  |O aTit = "2";
             |SI nPc1 ! 0;  |O nPc2 ! 0;
                 nDat = 1;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI aTit = "3";  |O aTit = "4";
         nPc1 = 0;
         nPc2 = 0;
     |FINSI;
|FPRC;

|PROCESO rem00102;
     |HAZ MiraViv;
     |SI nDat = 0;  |ACABA;  |FINSI;

     nLinea = nLinea + 1;
     |SI nLinea > 8;
         |ERROR10;
         |ACABA;
     |FINSI;

     |SI aTit = "3";
         |SI aNifArrend = "";  |Y aNifArrendEx = "";
             |SI #rem00102#16 = "S";
                 aNifArrend = #rem00102#15 % 109; |QBF aNifArrend;
             |SINO;
                 aNifArrendEx = #rem00102#15; |QBF aNifArrendEx;
             |FINSI;
         |FINSI;
     |FINSI;

     nCampo = 44 + ((nLinea - 1) * 5);  #m100h001#nCampo# = aTit;

     LongDec = 2; TipoDato = "N"; Long = 3;  aAlfa = nPc1;  |HAZ FormateoB;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = aAlfa;

     LongDec = 2; TipoDato = "N"; Long = 3;  aAlfa = nPc2;  |HAZ FormateoB;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = aAlfa;

     LongDec = 0; TipoDato = "N"; Long = 1;  aAlfa = aSit;  |HAZ FormateoB;
     nCampo  = nCampo + 1;  #m100h001#nCampo# = aAlfa;

     nCampo  = nCampo + 1;  #m100h001#nCampo# = aRfC;
|FPRC;

|DEFBUCLE rem00102;
     #rem00102#1;
     ;
     VEmpresa, 01;
     VEmpresa, 99;
     ;
     NULL, rem00102;
|FIN;

|PROCESO TDeclaracion;
     nTotal = 0;
     Bloque = 50;  Casilla = "621"; |HAZ BuscaCasillaB;
     nTotal = Casilla;
     |SI SwError = 1; |O nTotal = 0;
         Bloque = 51;  Casilla = "622"; |HAZ BuscaCasillaB;
         nTotal = Casilla;
     |FINSI;

     |SI SwError = 1; |O nTotal = 0;
         Bloque = 46;  Casilla = "600"; |HAZ BuscaCasillaB;
         nTotal = Casilla;
     |SINO;
         nTotal = #rem01001#16;
     |FINSI;

     Bloque = 48;  Casilla = "610"; |HAZ BuscaCasillaB;
     |SI #rem01001#14 = "4"; Casilla = 0; |FINSI;

     nCalc = Casilla;
     |SI nCalc ! 0; nTotal = nCalc; |FINSI;

     #m100h001#6 = "N";
     |SI nTotal > 0;
                                #m100h001#6 = "I";
         |SI #rem01001#9 = "D"; #m100h001#6 = "U"; |FINSI;
     |FINSI;

     |SI nTotal < 0;
                                 #m100h001#6 = "D";
         |SI #rem01001#11 = "X"; #m100h001#6 = "R"; |FINSI;
     |FINSI;
|FPRC;

|PROCESO Hoja01;
     |ABRE #rem00100;
     #rem00100#0 = VEmpresa;
     |LEE 000#rem00100.=;
     |SI FSalida = 0;
        |HAZ CargaDatos;
     |FINSI;
     |CIERRA #rem00100;

     |QBF aCP1;
     |SI aCP1 = ""; aCP1 = "00000"; |FINSI;

     |QBF aCP2;
     |SI aCP2 = ""; aCP2 = "00000"; |FINSI;

     |DDEFECTO #m100h001;

     |HAZ TDeclaracion;
     #m100h001#7  = aNif1;
     #m100h001#8  = aApell11 + " " + aApell12 + ", " + aNombre1;
     #m100h001#11 = aSexo1;

     |SI aEC1 = "S"; #m100h001#12 = "1"; aSexo2 = " "; |FINSI;
     |SI aEC1 = "C"; #m100h001#12 = "2";               |FINSI;
     |SI aEC1 = "V"; #m100h001#12 = "3"; aSexo2 = " "; |FINSI;
     |SI aEC1 = "L"; #m100h001#12 = "4"; aSexo2 = " "; |FINSI;

     |HAZ Inicializa;

     TipoDato = "F";  Long = 8;  aAlfa = aFNac1;  |HAZ FormateoB;
     #m100h001#13 = aAlfa;

     TipoDato = "N";  Long = 1;  aAlfa = aMinusval1;  |HAZ FormateoB;
     #m100h001#14 = aAlfa;

     |SI aCambioDom1 = "S";
         #m100h001#15 = "1";
     |FINSI;

     #m100h001#16 = aSg1;
     #m100h001#18 = aCalle1;
     #m100h001#19 = aTipNum1;

     TipoDato = "N"; Long = 5;  aAlfa = aNumero1;   |HAZ FormateoB;
     #m100h001#20 = aAlfa;

     #m100h001#21 = aCalNum1;
     #m100h001#22 = aBloque1;
     #m100h001#23 = aPortal1;
     #m100h001#24 = aEscalera1;
     #m100h001#25 = aPiso1;
     #m100h001#26 = aPuerta1;
     #m100h001#27 = aDatComp1;
     #m100h001#28 = aLocalB1;
     #m100h001#29 = aCP1;
     #m100h001#31 = aLocali1;
     #m100h001#32 = aCP1 % 102;
     #m100h001#33 = aProvin1;
     #m100h001#34 = aDomExtr1;
     #m100h001#35 = aDtCmpEx1;
     #m100h001#36 = aPoblExt1;
     #m100h001#37 = aCPExt1;
     #m100h001#38 = aEstExt1;
     #m100h001#39 = aPaisExt1;
     #m100h001#40 = aCdPaisEx1;
     #m100h001#41 = aRUEExtr1;
     #m100h001#43 = aNacExtr1;

     aNifArrend   = "";
     aNifArrendEx = "";
     nLinea       = 0;

     aTipo = VTipo % 0110; |QBF aTipo;
     |BUCLE rem00102;

     #m100h001#84 = aNifArrend;
     #m100h001#85 = aNifArrendEx;

     #m100h001#86 = aNif2;

     aAlfa = aApell21 + aApell22 + aNombre2;  |QBF aAlfa;
     |SI aAlfa ! "";
         #m100h001#87 = aApell21 + " " + aApell22 + ", " + aNombre2;
     |FINSI;

     #m100h001#88 = aSexo2;

     TipoDato = "F";  Long = 8;  aAlfa = aFNac2;  |HAZ FormateoB;
     #m100h001#89 = aAlfa;

     TipoDato = "N";  Long = 1;  aAlfa = aMinusval2;  |HAZ FormateoB;
     #m100h001#90 = aAlfa;

     |SI #rem00100#102 = "X";
         #m100h001#91 = "1";
     |FINSI;

     |SI aCambioDom2 = "S";
         #m100h001#92 = "1";
     |FINSI;

     #m100h001#93 = aSg2;
     #m100h001#95 = aCalle2;
     #m100h001#96 = aTipNum2;

     TipoDato = "N"; Long = 5;  aAlfa = aNumero2;   |HAZ FormateoB;
     #m100h001#97 = aAlfa;

     #m100h001#98  = aCalNum2;
     #m100h001#99  = aBloque2;
     #m100h001#100  = aPortal2;
     #m100h001#101 = aEscalera2;
     #m100h001#102 = aPiso2;
     #m100h001#103 = aPuerta2;
     #m100h001#104 = aDatComp2;
     #m100h001#105 = aLocalB2;
     #m100h001#106 = aCP2;
     #m100h001#108 = aLocali2;
     #m100h001#109 = aCP2 % 102;
     #m100h001#110 = aProvin2;
     #m100h001#111 = aDomExtr2;
     #m100h001#112 = aDtCmpEx2;
     #m100h001#113 = aPoblExt2;
     #m100h001#114 = aCPExt2;
     #m100h001#115 = aEstExt2;
     #m100h001#116 = aPaisExt2;
     #m100h001#117 = aCdPaisEx2;
     #m100h001#118 = aRUEExtr2;
     #m100h001#120 = aNacExtr2;

     |ABRE #rerenpre;
     #rerenpre#0 = #rem00100#65;
     |LEE 000#rerenpre.=;
     |SI FSalida ! 0;  |DDEFECTO #rerenpre;  |FINSI;
     |CIERRA #rerenpre;

     #m100h001#122 = #rerenpre#2;
     #m100h001#123 = #rerenpre#1;

     |SI #rem00100#91 = "T"; |Y aTipo = "TITULAR";
        aAlfa = #rem00100#92;
        |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
        aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";

        #m100h001#124 = aAlfa;
     |FINSI;

     |SI #rem00100#91 = "C"; |Y aTipo = "CONYUGE";
        aAlfa = #rem00100#92;
        |SI aAlfa = "01.01.0000"; aAlfa = "00.00.0000"; |FINSI;
        aAlfa = aAlfa - "."; aAlfa = aAlfa - ".";

        #m100h001#124 = aAlfa;
     |FINSI;

     |SI eaTipoBor ! "";
         aTipo = VTipo; |QBF aTipo;
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
              #rem00100#57 = "X";
         |FINSI;
     |FINSI;

     aTipo = VTipo; |QBF aTipo;
     |SI #rem00100#57 = "X";
         aSeparada = "N";
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
             #m100h001#125 = "2";
         |SINO;
             #m100h001#125 = "1";
         |FINSI;
     |SINO;
         aSeparada = "S";
         #m100h001#125 = "1";
     |FINSI;

     aAlfa = VTipo; |QBF aAlfa;
     |SI aAlfa = "CONYUGE";
        TipoDato = "N";  Long = 2;  aAlfa = #rem00100#43;  |HAZ FormateoB;
        #m100h001#126 = aAlfa;
     |SINO;
        TipoDato = "N";  Long = 2;  aAlfa = #rem00100#11;  |HAZ FormateoB;
        #m100h001#126 = aAlfa;
     |FINSI;

     |PARA nCampo = 1;  |SI nCampo [ 133;  |HACIENDO nCampo = nCampo + 1;
           eaAlfa = #m100h001#nCampo#; |HAZ QuitaRaros;
           #m100h001#nCampo# = eaAlfa;

           eaAlfa = #m100h001#nCampo#;
           |XGRABA enHandle, eaAlfa;
     |SIGUE;

     aAlfa = eaCRLF;  |XGRABA enHandle, aAlfa;
|FPRC;

|PROCESO PonNifHijos;
     |SI aNifDc1 = "";  aNifDc1 = aAlfa;  |ACABA;  |FINSI;
     |SI aNifDc2 = "";  aNifDc2 = aAlfa;  |ACABA;  |FINSI;
     |SI aNifDc3 = "";  aNifDc3 = aAlfa;  |ACABA;  |FINSI;
     |SI aNifDc4 = "";  aNifDc4 = aAlfa;  |ACABA;  |FINSI;
|FPRC;

|PROCESO OtroProg;
     |QBF aNifOtroProg;
     |QBF aNomOtroProg;

     |SI aNifOtroProg = aNifOtroProg1;  |Y aNomOtroProg = aNomOtroProg1;
         nOrden = 1;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg2;  |Y aNomOtroProg = aNomOtroProg2;
         nOrden = 2;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg3;  |Y aNomOtroProg = aNomOtroProg3;
         nOrden = 3;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg = aNifOtroProg4;  |Y aNomOtroProg = aNomOtroProg4;
         nOrden = 4;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg1 = "";  |Y aNomOtroProg1 = "";
         aNifOtroProg1 = aNifOtroProg;
         aNomOtroProg1 = aNomOtroProg;
         nOrden = 1;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg2 = "";  |Y aNomOtroProg2 = "";
         aNifOtroProg2 = aNifOtroProg;
         aNomOtroProg2 = aNomOtroProg;
         nOrden = 2;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg3 = "";  |Y aNomOtroProg3 = "";
         aNifOtroProg3 = aNifOtroProg;
         aNomOtroProg3 = aNomOtroProg;
         nOrden = 3;
         |ACABA;
     |FINSI;

     |SI aNifOtroProg4 = "";  |Y aNomOtroProg4 = "";
         aNifOtroProg4 = aNifOtroProg;
         aNomOtroProg4 = aNomOtroProg;
         nOrden = 4;
         |ACABA;
     |FINSI;
|FPRC;

|PROCESO HijosIndividual;
     aNifOtroProg  = "";
     aNomOtroProg  = "";

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nCont;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#11 < 0;  |ACABA;  |FINSI;

     nOrden = 0;
     aAlfa  = #rem00101#2; |QBF aAlfa;
     |SI aAlfa ! ""; |Y #rem00101#7 = " ";
         |HAZ PonNifHijos;
     |FINSI;

     |SI #rem00101#7 = " ";
         nHijosTit = nHijosTit + 1;
         nHijosCon = nHijosCon + 1;
     |FINSI;

     |SI #rem00101#7 = "1"; |O #rem00101#7 = "3";
         nHijosTit = nHijosTit + 1;
     |FINSI;

     |SI #rem00101#7 = "2"; |O #rem00101#7 = "4";
         nHijosCon = nHijosCon + 1;
     |FINSI;

     |SI #rem00101#7 = "3"; |O #rem00101#7 = "4";
         |SI aTipo = "TITULAR"; |Y #rem00101#7 = "3";
             aNifOtroProg = #rem00101#23;
             aNomOtroProg = #rem00101#24;
             |HAZ OtroProg;
         |FINSI;

         |SI aTipo = "CONYUGE"; |Y #rem00101#7 = "4";
             aNifOtroProg = #rem00101#23;
             aNomOtroProg = #rem00101#24;
             |HAZ OtroProg;
         |FINSI;
    |FINSI;

    |SI #rem00101#21 ! "01.01.0000";
        |SI aTipo = "TITULAR";
            |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
                |SI nOrdDMuerto1 = 0;
                    aFecDMuerto1 = #rem00101#21;
                    nOrdDMuerto1 = nHijosTit
                |SINO;
                    |SI nOrdDMuerto2 = 0;
                        aFecDMuerto2 = #rem00101#21;
                        nOrdDMuerto2 = nHijosTit
                    |FINSI;
                |FINSI;
           |FINSI;
        |FINSI;

        |SI aTipo = "CONYUGE";
            |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
                |SI nOrdDMuerto1 = 0;
                    aFecDMuerto1 = #rem00101#21;
                    nOrdDMuerto1 = nHijosCon;
                |SINO;
                    |SI nOrdDMuerto2 = 0;
                        aFecDMuerto2 = #rem00101#21;
                        nOrdDMuerto2 = nHijosCon;
                    |FINSI;
                |FINSI;
            |FINSI;
        |FINSI;
     |FINSI;

     |SI aTipo = "TITULAR";
         |SI #rem00101#7 = "1"; |O #rem00101#7 = "3"; |O #rem00101#7 = " ";
             |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
             |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
             |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
             |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;

             aNifH  = #rem00101#2;  aNombH = #rem00101#3;
             aAnyoH = #rem00101#5; |QBF aAnyoH;
             aVincH = #rem00101#7;  aOtroH = #rem00101#8;
             aFNacH = #rem00101#17; aFAdoH = #rem00101#18;

             TipoDato = "F";
             aAlfa = aFNacH; |HAZ FormateoB; |SI aAlfa = "        "; aFNacH = "00000000"; |SINO; aFNacH = aAlfa; |FINSI;
             aAlfa = aFAdoH; |HAZ FormateoB; |SI aAlfa = "        "; aFAdoH = "00000000"; |SINO; aFAdoH = aAlfa; |FINSI;

             |SI #m100h001#12 = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

             |SI #rem00100#91 = "C";
                 |SI aVincH = " ";
                     aVincH = "3";

                     aNifOtroProg = #rem00100#35;   |QBF aNifOtroProg;
                     aNomOtroProg = #rem00100#36;   |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + " "  + #rem00100#37; |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + ", " + #rem00100#38; |QBF aNomOtroProg;
                     |HAZ OtroProg;
                 |FINSI;
             |FINSI;

             |SI aVincH = "4"; aVincH = "3"; |FINSI;

             TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 2;  aAlfa = nOrden;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             |HAZ GrabaCadB;

             nCont10 = nCont10 + 1;
         |FINSI;
     |FINSI;

     |SI aTipo = "CONYUGE";
         |SI #rem00101#7 = "2"; |O #rem00101#7 = "4"; |O #rem00101#7 = " ";
             |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
             |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
             |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
             |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;

             aNifH  = #rem00101#2;  aNombH = #rem00101#3;
             aAnyoH = #rem00101#5; |QBF aAnyoH;
             aVincH = #rem00101#7;
             |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;

             aOtroH = #rem00101#8;
             aFNacH = #rem00101#17; aFAdoH = #rem00101#18;

             TipoDato = "F";
             aAlfa = aFNacH; |HAZ FormateoB;
             aFNacH = "00000000";
             |SI aAlfa ! "        ";
                 aFNacH = aAlfa;
             |FINSI;

             aAlfa  = aFAdoH; |HAZ FormateoB;
             aFAdoH = "00000000";
             |SI aAlfa ! "        ";
                 aFAdoH = aAlfa;
             |FINSI;

             |SI #m100h001#12 = "3"; |Y aEC1 = "C"; aVincH = ""; |FINSI;

             |SI #rem00100#91 = "T";
                 |SI aVincH = " ";
                     aVincH = "3";

                     aNifOtroProg = #rem00100#1;        |QBF aNomOtroProg;
                     aNomOtroProg = #rem00100#2;        |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + " "  + #rem00100#3; |QBF aNomOtroProg;
                     aNomOtroProg = aNomOtroProg + ", " + #rem00100#4; |QBF aNomOtroProg;
                     |HAZ OtroProg;
                 |FINSI;
             |FINSI;

             |SI aVincH = "4"; aVincH = "3"; |FINSI;

             TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "N";  Long = 2;  aAlfa = nOrden;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
             |HAZ GrabaCadB;

             nCont10 = nCont10 + 1;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO HijosConjunta;
     aNifOtroProg  = "";
     aNomOtroProg  = "";

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nCont;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#11 < 0;  |ACABA;  |FINSI;

     nOrden = 0;

     |SI #rem00101#7 = "3"; |O #rem00101#7 = "4";
         |SI aNifOtroProg = "";
             aNifOtroProg = #rem00101#23;  |QBF aNifOtroProg;
             aNomOtroProg = #rem00101#24;  |QBF aNomOtroProg;
             |HAZ OtroProg;
         |FINSI;
     |FINSI;

     |SI #rem00101#21 ! "01.01.0000";
         |SI nOrdDMuerto1 = 0;
             aFecDMuerto1 = #rem00101#21;
             nOrdDMuerto1 = nCont;
         |SINO;
             |SI nOrdDMuerto2 = 0;
                 aFecDMuerto2 = #rem00101#21;
                 nOrdDMuerto2 = nCont;
             |FINSI;
         |FINSI;
     |FINSI;

     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;

     aNifH  = #rem00101#2;  aNombH = #rem00101#3;
     aAnyoH = #rem00101#5; |QBF aAnyoH;
     aVincH = #rem00101#7;  aOtroH = #rem00101#8;
     |SI #rem00100#91 ! " ";
         |SI #rem00100#91 = "T";
             |SI aVincH = "2";
                 aVincH = "1";
             |FINSI;
         |FINSI;

         |SI aVincH = " ";
             aVincH = "3";
             |SI #rem00100#91 = "T";
                 aNifOtroProg = #rem00100#1;        |QBF aNifOtroProg;
                 aNomOtroProg =        #rem00100#2; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + " "  + #rem00100#3; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + ", " + #rem00100#4; |QBF aNomOtroProg;
                 |HAZ OtroProg;
             |SINO;
                 aNifOtroProg = #rem00100#35;        |QBF aNifOtroProg;
                 aNomOtroProg =        #rem00100#36; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + " "  + #rem00100#37; |QBF aNomOtroProg;
                 aNomOtroProg = aNomOtroProg + ", " + #rem00100#38; |QBF aNomOtroProg;
                 |HAZ OtroProg;
             |FINSI;
             |HAZ OtroProg;
         |FINSI;
     |FINSI;

     aFNacH = #rem00101#17;
     aFAdoH = #rem00101#18;
     TipoDato = "F";
     aAlfa = aFNacH; |HAZ FormateoB;
     aFNacH = "00000000";
     |SI aAlfa ! "        ";
         aFNacH = aAlfa;
     |FINSI;

     aAlfa  = aFAdoH; |HAZ FormateoB;
     aFAdoH = "00000000";
     |SI aAlfa ! "        ";
         aFAdoH = aAlfa;
     |FINSI;

     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 2;  aAlfa = nOrden;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;

     nCont10 = nCont10 + 1;
|FPRC;

|PROCESO PonDescendientes;
     |DDEF aAlfa; |QBF aAlfa;
     aAlfa = aAlfa + "rem00101.mas";
     |CARGA_DEF aAlfa, Referen@;
     |SI FSalida = 0;
        nNumFam = 1;
        aAlfa = "tu" + Usuario; |NOME_DAT #Referen@#aAlfa#;
        |DELINDEX #Referen@; |ABRE #Referen@;
        |SELECT #4#rem00101;

        |DDEFECTO #rem00101;
        #rem00101#0  = #rem00100#0;
        #rem00101#8  = "2";
        #rem00101#17 = "31.12.9999";
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0;
                                |Y #rem00101#8 = "2";  |HACIENDO;
           |SI #rem00101#4 = "DESCENDIENTE";
              aAlfa = "|NC"; aAlfa = #rem00101#aAlfa#; nCalc = aAlfa;
              |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
                 #Referen@#nCont# = #rem00101#nCont#;
              |SIGUE;
              #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
              |GRABA 020#Referen@.n;
           |FINSI;

           |LEE 000#rem00101.s;
        |SIGUE;

        |DDEFECTO #rem00101;
        #rem00101#0  = #rem00100#0;
        #rem00101#8  = "";
        #rem00101#17 = "31.12.9999";
        |LEE 000#rem00101.];
        |PARA; |SI FSalida = 0; |Y #rem00101#0 = #rem00100#0;
                                |Y #rem00101#8 ! "2";  |HACIENDO;
           |SI #rem00101#4 = "DESCENDIENTE";
              aAlfa = "|NC"; aAlfa = #rem00101#aAlfa#; nCalc = aAlfa;
              |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
                 #Referen@#nCont# = #rem00101#nCont#;
              |SIGUE;
              #Referen@#1 = nNumFam; nNumFam = nNumFam + 1;
              |GRABA 020#Referen@.n;
           |FINSI;

           |LEE 000#rem00101.s;
        |SIGUE;
        |SELECT #1#rem00101;
        |CIERRA #Referen@; |DESCARGA_DEF #Referen@;

        |CIERRA #rem00101;
        aAlfa = "tu" + Usuario; |NOME_DAT #rem00101#aAlfa#;
        |ABRE #rem00101;
     |FINSI;

     aNifOtroProg  = "";
     aNomOtroProg  = "";
     aNifOtroProg1 = "";
     aNifOtroProg2 = "";
     aNifOtroProg3 = "";
     aNifOtroProg4 = "";
     aNomOtroProg1 = "";
     aNomOtroProg2 = "";
     aNomOtroProg3 = "";
     aNomOtroProg4 = "";
     nOrdDMuerto1  = 0;
     aFecDMuerto1  = "00.00.0000";
     nOrdDMuerto2  = 0;
     aFecDMuerto2  = "00.00.0000";
     nCont10       = 1;

     aTipo = VTipo; |QBF aTipo;
     |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
         nHijosTit = 0;
         nHijosCon = 0;

         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
               InDescend = nDescend1<-;
               InDescend = InDescend + (nCont - 1);

               |HAZ HijosIndividual;
         |SIGUE;
     |FINSI;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
               InDescend = nDescend1<-;
               InDescend = InDescend + (nCont - 1);

               |HAZ HijosConjunta;
         |SIGUE;
     |FINSI;

     |PARA nCont = nCont10; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
           aNifH    = "";
           aNombH   = "";
           aAnyoH   = "";
           aMinuH   = "0";
           aVincH   = "";
           aOtroH   = "";
           nOrden   = 0;
           aFNacH   = "00000000";
           aFAdoH   = "00000000";

           TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 8;  aAlfa = aFAdoH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 2;  aAlfa = nOrden;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;
     |SIGUE;

     |CIERRA #rem00101;
     aAlfa = "rem00101"; |NOME_DAT #rem00101#aAlfa#;
     |ABRE #rem00101;

     || Hijos y otros descendientes : Fallecido 2016 - N§ orden
     TipoDato = "N"; Long = 2;  aAlfa = nOrdDMuerto1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     || Hijos y otros descendientes : Fecha fallecimiento
     TipoDato = "F"; Long = 8;  aAlfa = aFecDMuerto1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     || Hijos y otros descendientes : Fallecido 2016 - N§ orden
     TipoDato = "N"; Long = 2;  aAlfa = nOrdDMuerto2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     || Hijos y otros descendientes : Fecha fallecimiento
     TipoDato = "F"; Long = 8;  aAlfa = aFecDMuerto2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

     TipoDato = "A"; Long = 9;  aAlfa = aNifDc1;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A"; Long = 9;  aAlfa = aNifDc2;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A"; Long = 9;  aAlfa = aNifDc3;      |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A"; Long = 9;  aAlfa = aNifDc4;      |HAZ FormateoB; Cadena = Cadena + aAlfa;

     || Hijos y otros descendientes : Nif de otro progenitor
     || Hijos y otros descendientes : Nombre de otro progenitor

     TipoDato = "An"; Long = 9;  aAlfa = aNifOtroProg1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNomOtroProg1; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     aAlfa = "0";
     |SI aNifOtroProg1 = "";  |Y aNomOtroProg1 ! "";
         aAlfa = "1";
     |FINSI;
     TipoDato = "N"; Long = 1; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     TipoDato = "An"; Long = 9;  aAlfa = aNifOtroProg2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNomOtroProg2; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     aAlfa = "0";
     |SI aNifOtroProg2 = "";  |Y aNomOtroProg2 ! "";
         aAlfa = "1";
     |FINSI;
     TipoDato = "N"; Long = 1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;

     Cadena  = "";
     TipoDato = "An"; Long = 9;  aAlfa = aNifOtroProg3; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNomOtroProg3; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     aAlfa = "0";
     |SI aNifOtroProg3 = "";  |Y aNomOtroProg3 ! "";
         aAlfa = "1";
     |FINSI;
     TipoDato = "N"; Long = 1; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     TipoDato = "An"; Long = 9;  aAlfa = aNifOtroProg4; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNomOtroProg4; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     aAlfa = "0";
     |SI aNifOtroProg4 = "";  |Y aNomOtroProg4 ! "";
         aAlfa = "1";
     |FINSI;
     TipoDato = "N"; Long = 1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;

     || RESERVADO AEAT
     Cadena = "";
     TipoDato = "A"; Long = 24;  aAlfa = ""; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;  Cadena = "";
|FPRC;

|PROCESO CargaMuertoA;
     |SI #rem00101#21 = "01.01.0000";
         |ACABA;
     |FINSI;

     |SI aNifAMuerto1 = "";
         aNifAMuerto1 = #rem00101#2;
         aFecAMuerto1 = #rem00101#21;
     |SINO;
         |SI aNifAMuerto2 = "";
             aNifAMuerto2 = #rem00101#2;
             aFecAMuerto2 = #rem00101#21;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO AbuelosIndividual;
     |SI aFamil ! "N"; |ACABA;  |FINSI;

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nAscend;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#13 = "S";  |ACABA;  |FINSI;

     |SI aTipo = "TITULAR";
         |SI #rem00101#7 = "2";  |ACABA;  |FINSI;

         |HAZ CargaMuertoA;

         |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
         |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
         |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
         |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;

         aNifH  = #rem00101#2;
         aNombH = #rem00101#3;
         aAnyoH = #rem00101#5;
         aVincH = #rem00101#7;
         aOtroH = #rem00101#9;
         aNivRe = #rem00101#19;
         aFNacH = #rem00101#17;

         TipoDato = "F";
         aAlfa = aFNacH; |HAZ FormateoB;
         aFNacH = "00000000";
         |SI aAlfa ! "        ";
             aFNacH = aAlfa;
         |FINSI;

         |SI #m100h001#12 = "3"; |Y aEC1 = "C";
             aVincH = "";
         |FINSI;

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         nCont10 = nCont10 + 1;
     |FINSI;

     |SI aTipo = "CONYUGE";
         |SI #rem00101#7 = "1";  |ACABA;  |FINSI;

         |HAZ CargaMuertoA;

         |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
         |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
         |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
         |SI #rem00101#6 ] 65;  aMinuH = 3; |FINSI;

         aNifH  = #rem00101#2;
         aNombH = #rem00101#3;
         aAnyoH = #rem00101#5;
         aVincH = #rem00101#7;

         |SI #rem00101#7 = "2"; aVincH = "1"; |FINSI;

         aOtroH = #rem00101#9;
         aNivRe = #rem00101#19;
         aFNacH = #rem00101#17;

         TipoDato = "F";
         aAlfa = aFNacH; |HAZ FormateoB;
         aFNacH = "00000000";
         |SI aAlfa ! "        ";
             aFNacH = aAlfa;
         |FINSI;

         |SI #m100h001#12 = "3"; |Y aEC1 = "C";
             aVincH = "";
         |FINSI;

         TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB;

         nCont10 = nCont10 + 1;
     |FINSI;
|FPRC;

|PROCESO AbuelosConjunta;
     |SI aFamil ! "N"; |ACABA;  |FINSI;

     #rem00101#0 = #rem00100#0;
     #rem00101#1 = nAscend;
     |LEE 000#rem00101.=;
     |SI FSalida ! 0;  |ACABA;  |FINSI;

     |SI #rem00101#13 = "S";  |ACABA;  |FINSI;

     |HAZ CargaMuertoA;

     |SI #rem00101#6 < 33; aMinuH = 0; |FINSI;
     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "N"; aMinuH = 1; |FINSI;
     |SI #rem00101#6 ] 33; |Y #rem00100#6 < 65; |Y #rem00101#14 = "S"; aMinuH = 2; |FINSI;
     |SI #rem00101#6 ] 65; aMinuH = 3; |FINSI;

     aNifH  = #rem00101#2; aNombH = #rem00101#3;
     aAnyoH = #rem00101#5;
     aVincH = #rem00101#7;
     aOtroH = #rem00101#9;
     aNivRe = #rem00101#19;
     aFNacH = #rem00101#17;

     |SI #rem00100#91 = "T";
         |SI aVincH = "2";
             aVincH = "1";
         |FINSI;
     |FINSI;

     TipoDato = "F";
     aAlfa = aFNacH; |HAZ FormateoB;
     aFNacH = "00000000";
     |SI aAlfa ! "        ";
         aFNacH = aAlfa;
     |FINSI;

     TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;

     nCont10 = nCont10 + 1;
     aTipo = VTipo; |QBF aTipo;
|FPRC;

|PROCESO PonAscendientes;
     aNifAMuerto1 = "";
     aNifAMuerto2 = "";
     aFecAMuerto1 = "00.00.0000";
     aFecAMuerto2 = "00.00.0000";
     nCont10      = 1;

     || Bucle para la declaracion de ascendientes
     |SI aTipo = "TITULAR"; |O aTipo = "CONYUGE";
        |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
              InAscend = nAscend1<-;
              InAscend = InAscend + (nCont - 1);
              |HAZ AbuelosIndividual;
        |SIGUE;
     |FINSI;

     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
        |PARA nCont = 1; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
              InAscend = nAscend1<-;
              InAscend = InAscend + (nCont - 1);
              |HAZ AbuelosConjunta;
        |SIGUE;
     |FINSI;

     |PARA nCont = nCont10; |SI nCont [ 4; |HACIENDO nCont = nCont + 1;
           aNifH  = ""; aNombH = "";
           aAnyoH = ""; aMinuH = "0";
           aVincH = ""; aOtroH = "";
           aNivRe = ""; aFNacH = "00000000";

           TipoDato = "An"; Long = 9;  aAlfa = aNifH;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "A";  Long = 60; aAlfa = aNombH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 8;  aAlfa = aFNacH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "N";  Long = 1;  aAlfa = aMinuH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "An"; Long = 1;  aAlfa = aVincH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           TipoDato = "An"; Long = 1;  aAlfa = aOtroH;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;
     |SIGUE;

     TipoDato = "A"; Long = 9;  aAlfa = aNifAMuerto1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "F"; Long = 8;  aAlfa = aFecAMuerto1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "A"; Long = 9;  aAlfa = aNifAMuerto2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     TipoDato = "F"; Long = 8;  aAlfa = aFecAMuerto2;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
|FPRC;

|PROCESO Hoja02;
     Cadena = ""; LongDec = 0;
     VTipo = eaTipo; aTipo = VTipo % 0110;

     Cadena = "<T10002000> ";

     aNifDc1 = ""; aNifDc2 = "";  aNifDc3 = ""; aNifDc4 = "";

     InAscend = nAscend1<-; InDescend = nDescend1<-;
     |PARA nCont = 1; |SI nCont [ 12; |HACIENDO nCont = nCont + 1;
        nDescend = 0;
        InDescend = InDescend + 1;

        |SI nCont [ 4;
            nAscend = 0; InAscend = InAscend + 1;
        |FINSI;
     |SIGUE;

     InAscend  = nAscend1<-;
     InDescend = nDescend1<-;
     aCDoc     = "0";
     aPDec     = "0";
     |BUCLE RecogeFam;

     |HAZ PonDescendientes;
     |HAZ PonAscendientes;

     |CIERRA #rem00101;

     || Sostenimiento de la iglesia catolica
     |SI aIglesia1 = "I"; |O aIglesia1 = "D";
        aAlfa = "X";
     |SINO;
        |SI aIglesia1 = "O"; |O aIglesia1 = " "; |O aIglesia1 = "N";
            aAlfa = "";
        |FINSI;
     |FINSI;
     TipoDato = "A";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;

     || Colaboracion en fines sociales
     |SI aIglesia1 = "O"; |O aIglesia1 = "D";
        aAlfa = "X";
     |SINO;
        |SI aIglesia1 = "I"; |O aIglesia1 = " ";  |O aIglesia1 = "N";
            aAlfa = "";
        |FINSI;
     |FINSI;
     TipoDato = "A";  Long = 1;                        |HAZ FormateoB; Cadena = Cadena + aAlfa;

     #rem01001#0 = VEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = VTipo;
     |LEE 000#rem01001.=;
     |SI FSalida ! 0; |DDEFECTO #rem01001; |FINSI;

     || Decl.Complementaria a otra del mismo ejercicio o por atrasos de rend.trabajo o complementaria a devolver
     aAlfa = "00000000";
     |SI #rem01001#14 = "2"; aAlfa = "10000000"; |FINSI;
     |SI #rem01001#14 = "3"; aAlfa = "01000000"; |FINSI;
     |SI #rem01001#14 = "4"; aAlfa = "00100000"; |FINSI;
     |SI #rem01001#14 = "5"; aAlfa = "00010000"; |FINSI;
     |SI #rem01001#14 = "6"; aAlfa = "00001000"; |FINSI;
     |SI #rem01001#14 = "7"; aAlfa = "00000100"; |FINSI;
     |SI #rem01001#14 = "1"; aAlfa = "00000010"; |FINSI;
     |SI #rem01001#14 = "8"; aAlfa = "00000001"; |FINSI;

     Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;

     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 200;  |HAZ GrabaCadB;

     Cadena = "</T10002000>";
     Cadena = Cadena + eaCRLF; |HAZ GrabaCadB;
|FPRC;

|PROCESO rem00016;
     |SI #rem00016#4 = 0;
         |ACABA;
     |FINSI;

     nConta  = nConta + 1;

     |SI nPasada = 0;
         |ACABA;
     |FINSI;

     nReg2 = nPagAct * 2
     nReg1 = nReg2 - 1;
     |SI nConta < nReg1;  |ACABA;  |FINSI;
     |SI nConta > nReg2;  |ACABA;  |FINSI;

     nGrabo = nGrabo + 1;

     aAlfa  = #rem00016#1; |HAZ TipoContrB;
     Cadena = Cadena + aTipoContrB;

     TipoDato = "N";  Long = 11;  LongDec = 2;
     aAlfa = #rem00016#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem00016#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

     |HAZ GrabaCadB;  Cadena = "";
|FPRC;

|DEFBUCLE rem00016;
     #rem00016#1;
     ;
     VEmpresa, aDes;
     VEmpresa, aHas;
     ;
     NULL, rem00016;
|FIN;

|PROCESO MeteDT4;
     nNume = nNumPag - 1;
     aAlfa = nNume;
     |SI nPagAct > 1;
         aAlfa = "0";
     |FINSI;
     TipoDato = "N";  Long = 1;  LongDec = 0;
     |HAZ FormateoB; Cadena = Cadena + aAlfa;

     |HAZ GrabaCadB;  Cadena = "";

     TipoDato = "N";  Long = 11;  LongDec = 2;
     nConta  = 0;
     nGrabo  = 0;
     nPasada = 1;  |BUCLE rem00016;

     |SI nGrabo = 0;
         Cadena = "000000000000000000000000000";
         Cadena = Cadena + "000000000000000000000000000";
         |HAZ GrabaCadB;  Cadena = "";
     |FINSI;

     |SI nGrabo = 1;
         Cadena = "000000000000000000000000000";
         |HAZ GrabaCadB;  Cadena = "";
     |FINSI;
|FPRC;

|PROCESO Hoja03;
     nConta = 0;
     aDes   = aTipo;
     aHas   = aTipo;
     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         aDes = "";
         aHas = "zzzzzzzzzz";
     |FINSI;

     nPasada = 0;  |BUCLE rem00016;

     enPagina = 3;
     |SI nConta = 0;
         |HAZ MiraObligatoria;
         |SI enConDatos = 0; |ACABA; |FINSI;
         nConta = 1;
     |FINSI;

     VTipo = eaTipo; aTipo = VTipo % 0110;

     |ABRE #rem01010;
     #rem01010#0 = VEmpresa;
     #rem01010#1 = 0;
     #rem01010#2 = aTipo;
     |LEE 000#rem01010.=;
     |SI FSalida ! 0; |DDEFECTO #rem01010; |FINSI;
     |CIERRA #rem01010;

     |ABRE #rem01012;
     #rem01012#0 = VEmpresa;
     #rem01012#1 = 0;
     #rem01012#2 = aTipo;
     |LEE 000#rem01012.=;
     |SI FSalida ! 0; |DDEFECTO #rem01012; |FINSI;
     |CIERRA #rem01012;

     nNumPag = ((nConta / 2) + 0.49) ! 0;

     |PARA nPagAct = 1; |SI nPagAct [ nNumPag; |HACIENDO nPagAct = nPagAct + 1;
           Cadena = "<T10003000> ";
           |SI nPagAct > 1;
               Cadena = "<T10003000>C";
               |DDEFECTO #rem01010;
               |DDEFECTO #rem01012;
           |FINSI;

           TipoDato = "N";  Long = 11;  LongDec = 2;
           aAlfa = #rem01010#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;  Cadena = "";

           aAlfa = #rem01010#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01010#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;  Cadena = "";

           aAlfa = #rem01012#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;  Cadena = "";

           aAlfa = #rem01012#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ MeteDT4;

           aAlfa = #rem01012#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01012#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;  Cadena = "";

           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;

           Cadena = Cadena + "</T10003000>" + eaCRLF;
           |HAZ GrabaCadB;  Cadena = "";
     |SIGUE;
|FPRC;

|PROCESO Mete1011;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
          |SI #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
              |DDEFECTO #rem01011;
          |FINSI;

          aAlfa = #rem01011#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

          TipoDato = "N";  Long = 3;  LongDec = 2;
          aAlfa = #rem01011#5; |HAZ FormateoB; Cadena = Cadena + aAlfa;

          TipoDato = "N";  Long = 3;  LongDec = 2;
          aAlfa = #rem01011#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;

          Long = 1; LongDec = 0;
          aAlfa = #rem01011#6; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#7; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#8; |HAZ FormateoB; Cadena = Cadena + aAlfa;

          TipoDato = "A";  Long = 20;  LongDec = 0;
          aAlfa = #rem01011#9; |HAZ FormateoB; Cadena = Cadena + aAlfa;

          TipoDato = "N";  Long = 3;  LongDec = 2;
          |SI #rem01011#7 = 1; #rem01011#10 = 0; |FINSI;
          aAlfa = #rem01011#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          LongDec = 0;

          aAlfa = #rem01011#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;

          Long = 11;  LongDec = 2;
          aAlfa = #rem01011#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          |HAZ GrabaCadB; Cadena = "";

          aAlfa = #rem01011#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          |HAZ GrabaCadB; Cadena = "";

          aAlfa = #rem01011#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          aAlfa = #rem01011#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
          |HAZ GrabaCadB; Cadena = "";

          |LEE 000#rem01011.s;
          |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
              |DDEFECTO #rem01011;
          |FINSI;
     |SIGUE;

     |SI nPagAct = 1;
         Bloque = 4; Casilla = "075"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

         Bloque = 4; Casilla = "076"; |HAZ BuscaCasillaB;
         aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         Cadena = Cadena + ("0" * 26);
     |FINSI;
     Cadena = Cadena + "000";
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1015;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01015#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "A";  Long = 20;
           aAlfa = #rem01015#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N";  Long = 3;  LongDec = 2;
           aAlfa = #rem01015#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N";  Long = 1;  LongDec = 0;
           aAlfa = #rem01015#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           aAlfa = #rem01015#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A";  Long = 20;
           aAlfa = #rem01015#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

                                    aAlfa = "0";
           |SI #rem01015#10 = "S";  aAlfa = "1";  |FINSI;
           TipoDato = "A";  Long = 1;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           |LEE 000#rem01015.s;
           |SI FSalida ! 0; |O #rem01015#0 ! VEmpresa; |O #rem01015#1 ! 0; |O #rem01015#2 ! aTipo2;
              |DDEFECTO #rem01015;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Mete1013;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01013#4; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "N";  Long = 3;  LongDec = 2;
           aAlfa = #rem01013#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N";  Long = 3;  LongDec = 2;
           aAlfa = #rem01013#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           aAlfa = #rem01013#8;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01013#9;  Cadena = Cadena + aAlfa;

           TipoDato = "A";  Long = 20;  LongDec = 0;
           aAlfa = #rem01013#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           |LEE 000#rem01013.s;
           |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
              |DDEFECTO #rem01013; #rem01013#8 = 0;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja04;
     enPagina = 4; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10004000> ";

     |ABRE #rem01013;
     |ABRE #rem01011;
     |ABRE #rem01015;

     aTipo2      = (aTipo + "          ") % 110;

     #rem01011#0 = VEmpresa;
     #rem01011#1 = 0;
     #rem01011#2 = aTipo;
     #rem01011#3 = 0;
     |LEE 000#rem01011.];
     |SI FSalida ! 0; |O #rem01011#0 ! VEmpresa; |O #rem01011#1 ! 0; |O #rem01011#2 ! aTipo2;
        |DDEFECTO #rem01011;
     |FINSI;

     #rem01015#0 = VEmpresa;
     #rem01015#1 = 0;
     #rem01015#2 = aTipo;
     #rem01015#3 = 0;
     |LEE 000#rem01015.];
     |SI FSalida ! 0; |O #rem01015#0 ! VEmpresa; |O #rem01015#1 ! 0; |O #rem01015#2 ! aTipo2;
        |DDEFECTO #rem01015;
     |FINSI;

     #rem01013#0 = VEmpresa;
     #rem01013#1 = 0;
     #rem01013#2 = aTipo;
     #rem01013#3 = 0;
     |LEE 000#rem01013.];
     |SI FSalida ! 0; |O #rem01013#0 ! VEmpresa; |O #rem01013#1 ! 0; |O #rem01013#2 ! aTipo2;
        |DDEFECTO #rem01013; #rem01013#8 = 0;
     |FINSI;

     || N§ hojas adicionales de inmuebles
     LongDec = 0; TipoDato = "N";
     aAlfa = nNumPag; Long = 2; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     LongDec = 2; nNumPag = nNumPag + 1;

     |PARA nPagAct = 1; |SI nPagAct [ nNumPag; |HACIENDO nPagAct = nPagAct + 1;
         |HAZ Mete1011;
         |HAZ Mete1015;
         |HAZ Mete1013;

         Cadena = " " * 200;  |HAZ GrabaCadB;
         Cadena = " " * 200;  |HAZ GrabaCadB;
         Cadena = " " * 200;  |HAZ GrabaCadB;

         Cadena = "</T10004000>" + eaCRLF; |HAZ GrabaCadB;
         |SI nPagAct < nNumPag;
             Cadena = "<T10004000>C00"; |HAZ GrabaCadB; FSalida = 0;
         |FINSI;
     |SIGUE;

     |CIERRA #rem01013; |CIERRA #rem01011;
|FPRC;

|PROCESO Mete1014;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01014#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 1;   LongDec = 0;
           aAlfa = #rem01014#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 5; aAlfa = #rem01014#7; |HAZ Epigrafe;
           |HAZ FormateoB; Cadena = Cadena + aAlfa;

           aAlfa = "0";
           |SI #rem01014#8 = "X"; aAlfa = "1"; |FINSI;
           |SI #rem01014#9 = "X"; aAlfa = "2"; |FINSI;
           Cadena = Cadena + aAlfa;

           |SI #rem01014#6 = " "; aAlfa = "0"; |SINO; aAlfa = "1"; |FINSI;
           TipoDato = "A"; Long = 1;    LongDec = 0;
                                 |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01014#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#38; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           aAlfa = #rem01014#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           aAlfa = #rem01014#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#35; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#36; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01014#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           nEnAct = nEnAct + 1;
           |LEE 000#rem01014.s;
           |SI FSalida ! 0; |O #rem01014#0 ! VEmpresa; |O #rem01014#1 ! 0;
            |O #rem01014#2 ! aTipo2;
              |DDEFECTO #rem01014;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja05;
     enPagina = 5; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110; nEnAct = 0;
     Cadena = "<T10005000> ";

     aTipo2      = (aTipo + "          ") % 110;

     || N§ de hojas adicionales
     TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;
     TipoDato = "N";  Long = 11;  LongDec = 2;

     nNumPag = 1;

     |ABRE #rem01014;
     #rem01014#0 = VEmpresa;
     #rem01014#1 = 0;
     #rem01014#2 = aTipo;
     #rem01014#3 = 1;
     |LEE 000#rem01014.];
     |PARA; |SI FSalida = 0; |Y #rem01014#0 = VEmpresa; |Y #rem01014#1 = 0;
                             |Y #rem01014#2 = aTipo2; |HACIENDO;
            |HAZ Mete1014;

            Casilla = 0;
            |SI nEnAct = 3;
                Bloque = 5; Casilla = "126"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 3;
                Bloque = 5; Casilla = "127"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 3;
                Bloque = 5; Casilla = "128"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 3;
                Bloque = 5; Casilla = "129"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 3;
                Bloque = 5; Casilla = "130"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa;
            |HAZ GrabaCadB;

            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;

            Cadena = "</T10005000>" + eaCRLF; |HAZ GrabaCadB;
            |SI nNumPag < enNumPags;
                Cadena = "<T10005000>C0";

                |HAZ GrabaCadB; FSalida = 0;

                nNumPag = nNumPag + 1;
            |FINSI;
     |SIGUE;

     |CIERRA #rem01014;
|FPRC;

|PROCESO Mete1019;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           |SI #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0; |O #rem01019#2 ! aTipo2; |O nNoHay1 ! 0;
               |DDEFECTO #rem01019;
           |FINSI;

           TipoDato = "An"; LongDec = 0;

           aAlfa = #rem01019#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           Long = 5; aAlfa = #rem01019#4; |HAZ Epigrafe;
           |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |SI #rem01019#44 = " ";
              Cadena = Cadena + "0";
           |SINO;
              Cadena = Cadena + "1";
           |FINSI;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#15;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#21;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 24;   LongDec = 0;
           aAlfa = #rem01019#24;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 7;   LongDec = 2;
           aAlfa = #rem01019#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 9;
           aAlfa = #rem01019#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 11;
           aAlfa = #rem01019#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 2; LongDec = 2;
           aAlfa = #rem01019#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#35; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 11;
           aAlfa = #rem01019#36; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           aAlfa = #rem01019#38; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#39; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#40; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#41; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#42; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01019#43; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB;

           nEnAct = nEnAct + 1;
           |LEE 000#rem01019.s;
           |SI FSalida ! 0; |O #rem01019#0 ! VEmpresa; |O #rem01019#1 ! 0;
            |O #rem01019#2 ! aTipo2;
              |DDEFECTO #rem01019;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja06;
     enPagina = 6; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;  nEnAct = 0;
     Cadena = "<T10006000> ";

     nSwFiltraBarra = 1;
     || N§ de hojas adicionales
     TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     nNumPag = 1;

     |ABRE #rem01019;
     #rem01019#0 = VEmpresa;
     #rem01019#1 = 0;
     #rem01019#2 = aTipo; aTipo2 = #rem01019#2;
     #rem01019#3 = 1;
     |LEE 000#rem01019.];
     |PARA; |SI FSalida = 0; |Y #rem01019#0 = VEmpresa; |Y #rem01019#1 = 0;
                             |Y #rem01019#2 = aTipo2; |HACIENDO;
            |HAZ Mete1019;

            TipoDato = "N"; Long = 11;   LongDec = 2;
            Casilla = 0;
            |SI nEnAct = 2;
                Bloque = 6; Casilla = "153"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 2;
                Bloque = 6; Casilla = "154"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            Casilla = 0;
            |SI nEnAct = 2;
                Bloque = 6; Casilla = "155"; |HAZ BuscaCasillaB;
            |FINSI;
            aAlfa = Casilla; |HAZ FormateoB; Cadena = aAlfa;
            |HAZ GrabaCadB;

            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;

            Cadena = "</T10006000>" + eaCRLF; |HAZ GrabaCadB;
            |SI nNumPag < enNumPags;
                Cadena = "<T10006000>C0";

                |HAZ GrabaCadB; FSalida = 0;

                nNumPag = nNumPag + 1;
            |FINSI;
            Cadena = "";
     |SIGUE;
     nSwFiltraBarra = 0;

     |CIERRA #rem01019;
|FPRC;

|PROCESO MeteProducto;
     nCampo2 = nCampo1 + 1;
     nCampo3 = nCampo1 + 2;

     TipoDato = "N"; Long = 9;   LongDec = 2;
     aAlfa = #rem01021#nCampo1#;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

     TipoDato = "An"; Long = 6;   LongDec = 0;
     aAlfa = "      ";
     |SI #rem01021#nCampo2# > 0;
         aAlfa = #rem01021#nCampo2#;
         |HAZ FormateoB;
     |FINSI;
     Cadena = Cadena + aAlfa;

     TipoDato = "N"; Long = 9;   LongDec = 2;
     aAlfa = #rem01021#nCampo3#;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1021;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           TipoDato = "N"; Long = 1;   LongDec = 0;
           aAlfa = #rem01021#6;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
           aAlfa = #rem01021#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#4;
           |SI aAlfa = "X"; aAlfa = "1"; |SINO; aAlfa = "0"; |FINSI;
           Cadena = Cadena + aAlfa;

           nCampo1 = 7;  |HAZ MeteProducto;
           nCampo1 = 10; |HAZ MeteProducto;
           nCampo1 = 13; |HAZ MeteProducto;
           nCampo1 = 16; |HAZ MeteProducto;
           nCampo1 = 19; |HAZ MeteProducto;
           nCampo1 = 22; |HAZ MeteProducto;
           nCampo1 = 25; |HAZ MeteProducto;
           nCampo1 = 28; |HAZ MeteProducto;
           nCampo1 = 31; |HAZ MeteProducto;
           nCampo1 = 34; |HAZ MeteProducto;
           nCampo1 = 37; |HAZ MeteProducto;
           nCampo1 = 40; |HAZ MeteProducto;
           nCampo1 = 43; |HAZ MeteProducto;
           nCampo1 = 68; |HAZ MeteProducto;
           nCampo1 = 71; |HAZ MeteProducto;
           nCampo1 = 74; |HAZ MeteProducto;

           Cadena = " " * 28;  |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01021#46; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#47; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           nCalc = #rem01021#58 + #rem01021#60;
           aAlfa = nCalc; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           aAlfa = #rem01021#48; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#49; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 2;   LongDec = 2;
           aAlfa = #rem01021#50; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#51; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#52; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#53; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = "0.0";        |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#54; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#67; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#55; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#56; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01021#57; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#61; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#66; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#62; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#59; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#63; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#64; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01021#65; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           nEnAct = nEnAct + 1;
           |LEE 000#rem01021.s;
           |SI FSalida ! 0; |O #rem01021#0 ! VEmpresa; |O #rem01021#1 ! 0;
            |O #rem01021#2 ! aTipo2;
              |DDEFECTO #rem01021;
           |FINSI;
     |SIGUE;
|FPRC;

|PROCESO Hoja07;
     enPagina = 7; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;  nEnAct = 0;
     Cadena = "<T10007000> ";

     || N§ de hojas adicionales
     TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     || Hecho esto, procedemos a leer registro a registro
     nNumPag = 1;

     |ABRE #rem01021;
     #rem01021#0 = VEmpresa;
     #rem01021#1 = 0;
     #rem01021#2 = aTipo; aTipo2 = #rem01021#2;
     #rem01021#3 = 1;
     |LEE 000#rem01021.];
     |PARA; |SI FSalida = 0; |Y #rem01021#0 = VEmpresa; |Y #rem01021#1 = 0;
                             |Y #rem01021#2 = aTipo2; |HACIENDO;
            |HAZ Mete1021;

            TipoDato = "N"; Long = 11;   LongDec = 2;
            aAlfa = "0";
            |SI nEnAct = 2;
                Bloque = 7; Casilla = "183"; |HAZ BuscaCasillaB;
                aAlfa = Casilla;
            |FINSI;
            |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            aAlfa = "0";
            |SI nEnAct = 2;
                Bloque = 7; Casilla = "184"; |HAZ BuscaCasillaB;
                aAlfa = Casilla;
            |FINSI;
            |HAZ FormateoB; Cadena = aAlfa; |HAZ GrabaCadB;

            aAlfa = "0";
            |SI nEnAct = 2;
                Bloque = 7; Casilla = "185"; |HAZ BuscaCasillaB;
                aAlfa = Casilla;
            |FINSI;
            |HAZ FormateoB; Cadena = aAlfa;
            |HAZ GrabaCadB;

            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;
            Cadena = " " * 200;  |HAZ GrabaCadB;

            Cadena = "</T10007000>" + eaCRLF; |HAZ GrabaCadB;
            |SI nNumPag < enNumPags;
                Cadena = "<T10007000>C0";

                |HAZ GrabaCadB; FSalida = 0;

                nNumPag = nNumPag + 1;
            |FINSI;
            Cadena = "";
     |SIGUE;

     |CIERRA #rem01021;
|FPRC;

|PROCESO Mete1022;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01022#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "A"; Long = 20;   LongDec = 0;  aAlfa = "";
           aAlfa = #rem01022#5; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 1;   LongDec = 0;  aAlfa = "";
           aAlfa = #rem01022#6;
           |SI aAlfa = " ";
               aAlfa = "0";
           |SINO;
               aAlfa = "1";
           |FINSI;
           |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 2;   LongDec = 2;
           aAlfa = #rem01022#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01022#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           aAlfa = "0";
           |SI #rem01022#42 = "S";  aAlfa = "1";  |FINSI;
           Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01022#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#37; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#38; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#39; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#40; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01022#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#25; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#41; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01022#34; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01022#0 = VEmpresa; |Y #rem01022#1 = 0; |Y #rem01022#2 = aTipo2;
              |LEE 000#rem01022.s;
              |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
                 |DDEFECTO #rem01022;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N"; Long = 11;   LongDec = 2;

         aAlfa = #rem01026#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 130; Cadena = Cadena + aAlfa;
     |FINSI;
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1023;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01023#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "A"; Long = 9;   LongDec = 0;
           aAlfa = #rem01023#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           Long = 1;
           aAlfa = #rem01023#19;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01023#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01023#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01023#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01023#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01023#10;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01023#13;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01023#0 = VEmpresa; |Y #rem01023#1 = 0; |Y #rem01023#2 = aTipo2;
              |LEE 000#rem01023.s;
              |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
                 |DDEFECTO #rem01023;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         aAlfa = #rem01026#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
     |FINSI;
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Hoja08;
     enPagina = 8; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10008000> ";

     || N§ de hojas adicionales
     TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     nCalc1 = 0; nCalc2 = 0;

     |ABRE #rem01022;
     |ABRE #rem01023;
     |ABRE #rem01026;

     aTipo2      = (aTipo + "          ") % 110;

     #rem01022#0 = VEmpresa;
     #rem01022#1 = 0;
     #rem01022#2 = aTipo;
     #rem01022#3 = 1;
     |LEE 000#rem01022.];
     |SI FSalida ! 0; |O #rem01022#0 ! VEmpresa; |O #rem01022#1 ! 0; |O #rem01022#2 ! aTipo2;
        |DDEFECTO #rem01022;
     |FINSI;

     #rem01023#0 = VEmpresa;
     #rem01023#1 = 0;
     #rem01023#2 = aTipo;
     #rem01023#3 = 1;
     |LEE 000#rem01023.];
     |SI FSalida ! 0; |O #rem01023#0 ! VEmpresa; |O #rem01023#1 ! 0; |O #rem01023#2 ! aTipo2;
        |DDEFECTO #rem01023;
     |FINSI;

     #rem01026#0 = VEmpresa;
     #rem01026#1 = 0;
     #rem01026#2 = aTipo;
     |LEE 000#rem01026.=;
     |SI FSalida ! 0; |DDEFECTO #rem01026; |FINSI;

     |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
           |HAZ Mete1022;
           |HAZ Mete1023;

           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;

           Cadena = "</T10008000>" + eaCRLF; |HAZ GrabaCadB;
           |SI nPag < enNumPags;
               Cadena = "<T10008000>C0";

               |HAZ GrabaCadB;
           |FINSI;
           Cadena = "";
     |SIGUE;

     |CIERRA #rem01022;
     |CIERRA #rem01023;
     |CIERRA #rem01026;
|FPRC;

|PROCESO Mete1024;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01024#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 24;   LongDec = 0;
           aAlfa = #rem01024#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01024#10;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01024#0 = VEmpresa; |Y #rem01024#1 = 0; |Y #rem01024#2 = aTipo2;
              |LEE 000#rem01024.s;
              |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
                 |DDEFECTO #rem01024;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         aAlfa = #rem01026#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#18; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

         TipoDato = "An"; Long = 25; LongDec = 0;
         aAlfa = #rem01026#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01026#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         TipoDato = "N"; Long = 11; LongDec = 2;
         aAlfa = #rem01026#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 14; Cadena = Cadena + aAlfa;
         aAlfa = " " * 50; Cadena = Cadena + aAlfa;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
     |FINSI;

     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1025;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01025#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 24;   LongDec = 0;
           aAlfa = #rem01025#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;   LongDec = 2;
           aAlfa = #rem01025#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01025#0 = VEmpresa; |Y #rem01025#1 = 0; |Y #rem01025#2 = aTipo2;
              |LEE 000#rem01025.s;
              |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
                 |DDEFECTO #rem01025;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         aAlfa = #rem01026#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
     |FINSI;
     |HAZ GrabaCadB; Cadena = "";

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#3;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#4;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#5;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#6;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#7;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#135; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#136; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#137; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#138; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#139; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";

         aAlfa = #rem01033#140; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#141; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#8;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#121; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#9;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#120; |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#10;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#11;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
     |SINO;
         aAlfa = "0" * 234; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
     |FINSI;
|FPRC;

|PROCESO Mete1027;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01027#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 9;   LongDec = 0;
           aAlfa = #rem01027#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N";  Long = 11;  LongDec = 2;
           aAlfa = #rem01027#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01027#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01027#0 = VEmpresa; |Y #rem01027#1 = 0; |Y #rem01027#2 = aTipo2;
              |LEE 000#rem01027.s;
              |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
                 |DDEFECTO #rem01027;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#124;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#125;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
     |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
         |HAZ GrabaCadB; Cadena = "";
     |FINSI;
|FPRC;

|PROCESO rem00017;
     |SI #rem00017#4 = 0;
         |ACABA;
     |FINSI;

     nConta  = nConta + 1;

     |SI nPasada = 0;
         |ACABA;
     |FINSI;

     nReg2 = nPag * 2
     nReg1 = nReg2 - 1;
     |SI nConta < nReg1;  |ACABA;  |FINSI;
     |SI nConta > nReg2;  |ACABA;  |FINSI;

     nGrabo = nGrabo + 1;

     aAlfa  = #rem00017#1; |HAZ TipoContrB;
     Cadena = Cadena + aTipoContrB;

     TipoDato = "N";  Long = 11;  LongDec = 2;
     aAlfa = #rem00017#3;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

     |HAZ GrabaCadB;  Cadena = "";
|FPRC;

|DEFBUCLE rem00017;
     #rem00017#1;
     ;
     VEmpresa, aDes;
     VEmpresa, aHas;
     ;
     NULL, rem00017;
|FIN;

|PROCESO MeteDT9;
     TipoDato = "N";  Long = 11;  LongDec = 2;
     nConta   = 0;
     nGrabo   = 0;
     nPasada  = 1;  |BUCLE rem00017;

     |SI nGrabo = 0;
         Cadena = "00000000000000";
         Cadena = Cadena + "00000000000000";
         |HAZ GrabaCadB;  Cadena = "";
     |FINSI;

     |SI nGrabo = 1;
         Cadena = "00000000000000";
         |HAZ GrabaCadB;  Cadena = "";
     |FINSI;
|FPRC;

|PROCESO Hoja09;
     nConta = 0;
     aDes   = aTipo;
     aHas   = aTipo;
     |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
         aDes = "";
         aHas = "zzzzzzzzzz";
     |FINSI;

     nPasada = 0;  |BUCLE rem00017;

     enPagina = 9;
     |HAZ MiraObligatoria;
     |SI enConDatos = 0;  |Y nConta = 0;
         |ACABA;
     |FINSI;

     nNumPag1 = ((nConta / 2) + 0.49) ! 0;
     nNumPag  = enNumPags;
     |SI nNumPag1 > nNumPag;
         nNumPag = nNumPag1;
     |FINSI;
     nPag = nNumPag - 1;

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10009000> ";

     || N§ de hojas adicionales
     TipoDato = "N";  Long = 2;   LongDec = 0; aAlfa = nPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     |ABRE #rem01024;
     |ABRE #rem01025;
     |ABRE #rem01027;
     |ABRE #rem01033;

     aTipo2      = (aTipo + "          ") % 110;

     #rem01033#0 = VEmpresa;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

     #rem01024#0 = VEmpresa;
     #rem01024#1 = 0;
     #rem01024#2 = aTipo;
     #rem01024#3 = 1;
     |LEE 000#rem01024.];
     |SI FSalida ! 0; |O #rem01024#0 ! VEmpresa; |O #rem01024#1 ! 0; |O #rem01024#2 ! aTipo2;
        |DDEFECTO #rem01024;
     |FINSI;

     nCalc1 = 0; nCalc2 = 0;
     #rem01025#0 = VEmpresa;
     #rem01025#1 = 0;
     #rem01025#2 = aTipo;
     #rem01025#3 = 1;
     |LEE 000#rem01025.];
     |SI FSalida ! 0; |O #rem01025#0 ! VEmpresa; |O #rem01025#1 ! 0; |O #rem01025#2 ! aTipo2;
        |DDEFECTO #rem01025;
     |FINSI;

     #rem01027#0 = VEmpresa;
     #rem01027#1 = 0;
     #rem01027#2 = aTipo;
     #rem01027#3 = 1;
     |LEE 000#rem01027.];
     |SI FSalida ! 0; |O #rem01027#0 ! VEmpresa; |O #rem01027#1 ! 0; |O #rem01027#2 ! aTipo2;
        |DDEFECTO #rem01027;
     |FINSI;

     |PARA nPag = 1; |SI nPag [ nNumPag; |HACIENDO nPag = nPag + 1;
           |HAZ Mete1024;
           |HAZ Mete1025;
           |HAZ MeteDT9;
           |HAZ Mete1027;

           Cadena = "000";      |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;

           Cadena = "</T10009000>" + eaCRLF; |HAZ GrabaCadB;
           |SI nPag < enNumPags;
               Cadena = "<T10009000>C00";

               |HAZ GrabaCadB;
           |FINSI;
           Cadena = "";
     |SIGUE;

     |CIERRA #rem01024;
     |CIERRA #rem01025;
     |CIERRA #rem01027;
     |CIERRA #rem01033;
|FPRC;

|PROCESO Mete1039;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01039#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 20;  LongDec = 0;
           aAlfa = #rem01039#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01039#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01039#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01039#0 = VEmpresa; |Y #rem01039#1 = 0; |Y #rem01039#2 = aTipo2;
               |LEE 000#rem01039.s;
               |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
                   |DDEFECTO #rem01039;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#126;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#127;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 26; Cadena = Cadena + aAlfa;
     |FINSI;
     Cadena = Cadena + "000";

     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1031;
     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01031#5; |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "N"; Long = 1;  LongDec = 0;
           aAlfa = #rem01031#7; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#8; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "A"; Long = 20;  LongDec = 0;
           aAlfa = #rem01031#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "F";  Long = 8;
           aAlfa = #rem01031#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01031#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#14; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#15; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#16; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#17; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#18; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01031#19; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#20; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#21; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#22; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#33; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#23; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01031#24; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 4;  LongDec = 0;
           nCalc = #rem01031#25;
           |SI nCalc < 0; nCalc = 0; |FINSI;
           aAlfa = nCalc; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01031#26; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#27; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#28; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01031#29; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#30; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#31; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01031#32; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |SI #rem01031#6 = "S";
              Cadena = Cadena + "1";
           |SINO;
              Cadena = Cadena + "0";
           |FINSI;
           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01031#0 = VEmpresa; |Y #rem01031#1 = 0; |Y #rem01031#2 = aTipo2;
              |LEE 000#rem01031.s;
              |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
                 |DDEFECTO #rem01031;
              |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#128;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#129;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
         aAlfa = #rem01033#130;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 39; Cadena = Cadena + aAlfa;
     |FINSI;

     Cadena = Cadena + "000";

     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1032;
     #rem01032#0 = VEmpresa;
     #rem01032#1 = 0;
     #rem01032#2 = aTipo;
     #rem01032#2 = aTipo;
     #rem01032#3 = nNumLin1;
     |LEE 000#rem01032.];
     |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 ! aTipo2; |HACIENDO;
          |SI #rem01032#6 ! 0; nNumLin1 = #rem01032#3 + 1; |SAL; |FINSI;
          |LEE 000#rem01032.s;
     |SIGUE;

     |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
     |SINO;
         |SI #rem01032#5 = 0; |DDEFECTO #rem01032; |FINSI;
     |FINSI;

     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01032#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "N";  Long = 11;   LongDec = 2;
           aAlfa = #rem01032#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           nNumLinAnt = #rem01032#3;
           |LEE 000#rem01032.s;
           |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
              |SI #rem01032#6 ! 0; nNumLin1 = #rem01032#3; |SAL; |FINSI;
              |LEE 000#rem01032.s;
           |SIGUE;
           |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
              |DDEFECTO #rem01032;
              |SI nNumLinAnt = nNumLin1; nNumLin1 = 999; |FINSI;
           |SINO;
              |SI #rem01032#5 = 0; |DDEFECTO #rem01032; |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#19;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
     |FINSI;
     |HAZ GrabaCadB; Cadena = "";

     #rem01032#0 = VEmpresa;
     #rem01032#1 = 0;
     #rem01032#2 = aTipo; aTipo2 = #rem01032#2;
     #rem01032#3 = nNumLin2;
     |LEE 000#rem01032.];
     |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
            |SI #rem01032#6 ! 0;
                nNumLin2 = #rem01032#3 + 1; |SAL;
            |FINSI;

            |LEE 000#rem01032.s;
     |SIGUE;

     |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
         |DDEFECTO #rem01032;
     |SINO;
         |SI #rem01032#6 = 0;  |DDEFECTO #rem01032;  |FINSI;
     |FINSI;

     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01032#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "N";  Long = 11;   LongDec = 2;
           aAlfa = #rem01032#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           nNumLinAnt = #rem01032#3;
           |LEE 000#rem01032.s;
           |PARA; |SI FSalida = 0; |Y #rem01032#0 = VEmpresa; |Y #rem01032#1 = 0; |Y #rem01032#2 = aTipo2; |HACIENDO;
              |SI #rem01032#6 ! 0;
                  nNumLin2 = #rem01032#3; |SAL;
              |FINSI;
              |LEE 000#rem01032.s;
           |SIGUE;
           |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
              |DDEFECTO #rem01032;
              |SI nNumLinAnt = nNumLin2; nNumLin2 = 999; |FINSI;
           |SINO;
              |SI #rem01032#6 = 0;  |DDEFECTO #rem01032;  |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag = 1;
         TipoDato = "N";  Long = 11;  LongDec = 2;
         aAlfa = #rem01033#20;   |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         aAlfa = "0" * 13; Cadena = Cadena + aAlfa;
     |FINSI;
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Hoja10;
     enPagina = 10; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10010000> ";
     |HAZ GrabaCadB; Cadena = "";

     |ABRE #rem01033;
     |ABRE #rem01039;
     |ABRE #rem01031;
     |ABRE #rem01032;

     aTipo2      = (aTipo + "          ") % 110;

     #rem01033#0 = VEmpresa;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

     #rem01039#0 = VEmpresa;
     #rem01039#1 = 0;
     #rem01039#2 = aTipo;
     #rem01039#3 = 1;
     |LEE 000#rem01039.];
     |SI FSalida ! 0; |O #rem01039#0 ! VEmpresa; |O #rem01039#1 ! 0; |O #rem01039#2 ! aTipo2;
        |DDEFECTO #rem01039;
     |FINSI;

     #rem01031#0 = VEmpresa;
     #rem01031#1 = 0;
     #rem01031#2 = aTipo;
     #rem01031#3 = 1;
     |LEE 000#rem01031.];
     |SI FSalida ! 0; |O #rem01031#0 ! VEmpresa; |O #rem01031#1 ! 0; |O #rem01031#2 ! aTipo2;
        |DDEFECTO #rem01031;
     |FINSI;

     #rem01032#0 = VEmpresa;
     #rem01032#1 = 0;
     #rem01032#2 = aTipo;
     #rem01032#3 = 1;
     |LEE 000#rem01032.];
     |SI FSalida ! 0; |O #rem01032#0 ! VEmpresa; |O #rem01032#1 ! 0; |O #rem01032#2 ! aTipo2;
        |DDEFECTO #rem01032;
     |FINSI;

     || N§ de hojas adicionales
     TipoDato = "N";  Long = 2;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     nNumLin1 = 1;
     nNumLin2 = 1;
     |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
           |HAZ Mete1039;
           |HAZ Mete1031;

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = "0";
           |SI nPag = 1;
               Bloque = 19;  Casilla = "335"; |HAZ BuscaCasillaB;
               aAlfa = Casilla;
           |FINSI;
           |HAZ FormateoB; Cadena = aAlfa;
           |HAZ GrabaCadB;

           |HAZ Mete1032;

           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;

           Cadena = Cadena + "</T10010000>" + eaCRLF; |HAZ GrabaCadB;

           |SI nPag < enNumPags;
               Cadena = "<T10010000>C00"; |HAZ GrabaCadB;
           |FINSI;
           Cadena = "";
     |SIGUE;

     |CIERRA #rem01039;
     |CIERRA #rem01031;
     |CIERRA #rem01032;
     |CIERRA #rem01033;
|FPRC;

|PROCESO Mete1030;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01030#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "N";  Long = 11;  LongDec = 2;
           aAlfa = #rem01030#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |SI #rem01030#0 = VEmpresa; |Y #rem01030#1 = 0; |Y #rem01030#2 = aTipo2;
               |LEE 000#rem01030.s;
               |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
                   |DDEFECTO #rem01030;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag ! 1; |DDEFECTO #rem01033; |FINSI;

     TipoDato = "N";  Long = 11;  LongDec = 2;
     aAlfa = #rem01033#21;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Mete1034;
     |PARA nCont = 1; |SI nCont [ 3; |HACIENDO nCont = nCont + 1;
           aAlfa = "0";
           |SI #rem01034#15 = "S"; aAlfa = "1";  |FINSI;
           Cadena = Cadena + aAlfa;

           aAlfa = #rem01034#5;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "A"; Long = 9;  LongDec = 0;
           aAlfa = #rem01034#4;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N";  Long = 11;  LongDec = 2;
           aAlfa = #rem01034#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#9;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#10; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#11; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#12; |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01034#13; |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |HAZ GrabaCadB; Cadena = "";

           |SI #rem01034#0 = VEmpresa; |Y #rem01034#1 = 0; |Y #rem01034#2 = aTipo2;
               |LEE 000#rem01034.s;
               |SI FSalida ! 0; |O #rem01034#0 ! VEmpresa; |O #rem01034#1 ! 0; |O #rem01034#2 ! aTipo2;
                   |DDEFECTO #rem01034;
               |FINSI;
           |FINSI;
     |SIGUE;

     |SI nPag ! 1; |DDEFECTO #rem01033; |FINSI;

     TipoDato = "N";  Long = 11;  LongDec = 2;
     aAlfa = #rem01033#48;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";
|FPRC;

|PROCESO Hoja11;
     enPagina = 11; |HAZ MiraObligatoria;
     |SI enConDatos = 0; |ACABA; |FINSI;

     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10011000> ";

     |ABRE #rem01033;
     |ABRE #rem01030;
     |ABRE #rem01034;

     #rem01033#0 = VEmpresa;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

     #rem01030#0 = VEmpresa;
     #rem01030#1 = 0;
     #rem01030#2 = aTipo; aTipo2 = #rem01030#2;
     #rem01030#3 = 1;
     |LEE 000#rem01030.];
     |SI FSalida ! 0; |O #rem01030#0 ! VEmpresa; |O #rem01030#1 ! 0; |O #rem01030#2 ! aTipo2;
        |DDEFECTO #rem01030;
     |FINSI;

     #rem01034#0 = VEmpresa;
     #rem01034#1 = 0;
     #rem01034#2 = aTipo;
     #rem01034#3 = 1;
     |LEE 000#rem01034.];
     |SI FSalida ! 0; |O #rem01034#0 ! VEmpresa; |O #rem01034#1 ! 0; |O #rem01034#2 ! aTipo2;
        |DDEFECTO #rem01034;
     |FINSI;

     TipoDato = "N";  Long = 1;   LongDec = 0; aAlfa = nNumPag; |HAZ FormateoB;
     Cadena = Cadena + aAlfa;

     |PARA nPag = 1; |SI nPag [ enNumPags; |HACIENDO nPag = nPag + 1;
           |HAZ Mete1030;
           |HAZ Mete1034;

           aAlfa = #rem01033#22;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#23;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#24;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#25;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#26;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01033#164;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#165;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#166;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#167;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#168;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           aAlfa = #rem01033#12;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#13;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#14;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#15;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#16;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#17;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           TipoDato = "N";  Long = 2;  LongDec = 0;
           aAlfa = #rem01033#27;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
           aAlfa = #rem01033#28;  |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#29;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
           aAlfa = #rem01033#30;  |HAZ FormateoB;  Cadena = Cadena + aAlfa;

           aAlfa = "0";
           |SI #rem01033#18 = "S";  aAlfa = "1";  |FINSI;
           Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           TipoDato = "N";  Long = 11;  LongDec = 2;
           aAlfa = #rem01033#31;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#32;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#33;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#34;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#35;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#36;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#37;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#38;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;
           Cadena = " " * 200;  |HAZ GrabaCadB;

           Cadena = "</T10011000>" + eaCRLF; |HAZ GrabaCadB;

           |SI nPag < enNumPags;
               Cadena = "<T10011000>C0"; |HAZ GrabaCadB;
           |FINSI;
           Cadena = "";
     |SIGUE;

     |CIERRA #rem01030;
     |CIERRA #rem01034;
     |CIERRA #rem01033;
|FPRC;

|PROCESO Hoja12;
     enPagina = 12; |HAZ MiraObligatoria;

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10012000> ";

     |ABRE #rem01033;
     #rem01033#0 = VEmpresa;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;
     |CIERRA #rem01033;

     TipoDato = "N";  Long = 11;  LongDec = 2;

     aAlfa = #rem01033#148; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#149; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#39;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#40;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#41;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#155; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#42;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#44;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";

     aAlfa = #rem01033#46;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#150; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#47;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#156; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#142; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#157; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#143; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#49;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";

     aAlfa = #rem01033#151; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#111; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#159; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#144; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#160; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#145; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#50;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";

     aAlfa = #rem01033#45;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#162; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#163; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#51;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";

     |ABRE #rem01037;
     aTipo2      = (aTipo + "          ") % 110;
     #rem01037#0 = VEmpresa;
     #rem01037#1 = 0;
     #rem01037#2 = aTipo;
     #rem01037#3 = 1;
     |LEE 000#rem01037.];
     |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
        |DDEFECTO #rem01037;
     |FINSI;

     |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01037#4;  |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
           aAlfa = #rem01037#5;  |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01037#10; |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01037#6;  |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01037#12; |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01037#7;  |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           |HAZ GrabaCadB; Cadena = "";

           |LEE 000#rem01037.s;
           |SI FSalida ! 0; |O #rem01037#0 ! VEmpresa; |O #rem01037#1 ! 0; |O #rem01037#2 ! aTipo2;
              |DDEFECTO #rem01037;
           |FINSI;
     |SIGUE;

     aAlfa = #rem01033#52;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     aAlfa = #rem01033#55;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB; Cadena = "";

     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 200;  |HAZ GrabaCadB;

     Cadena = Cadena + "</T10012000>" + eaCRLF; |HAZ GrabaCadB;
|FPRC;

|PROCESO Hoja13;
     enPagina = 13; |HAZ MiraObligatoria;
     nNumPag = enNumPags - 1; || En las hojas adicionales no entra la principal

     VTipo = eaTipo; aTipo = VTipo % 0110;
     Cadena = "<T10013000> 00";

     |ABRE #rem01033;
     |ABRE #rem01045;
     |ABRE #rem01035;
     |ABRE #rem01046;
     |ABRE #rem01047;

     aTipo2      = (aTipo + "          ") % 110;
     #rem01045#0 = VEmpresa;
     #rem01045#1 = 0;
     #rem01045#2 = aTipo;
     #rem01045#3 = 1;
     |LEE 000#rem01045.];
     |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 ! aTipo2;
        |DDEFECTO #rem01045;
     |FINSI;

     #rem01035#0 = VEmpresa;
     #rem01035#1 = 0;
     #rem01035#2 = aTipo;
     #rem01035#3 = 1;
     |LEE 000#rem01035.];
     |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
         |DDEFECTO #rem01035;
     |FINSI;

     #rem01046#0 = VEmpresa;
     #rem01046#1 = 0;
     #rem01046#2 = aTipo;
     #rem01046#3 = 1;
     |LEE 000#rem01046.];
     |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
         |DDEFECTO #rem01046;
     |FINSI;

     #rem01047#0 = VEmpresa;
     #rem01047#1 = 0;
     #rem01047#2 = aTipo;
     #rem01047#3 = 1;
     |LEE 000#rem01047.];
     |SI FSalida ! 0; |O #rem01047#0 ! VEmpresa; |O #rem01047#1 ! 0; |O #rem01047#2 ! aTipo2;
        |DDEFECTO #rem01047;
     |FINSI;

     #rem01033#0 = VEmpresa;
     #rem01033#1 = 0;
     #rem01033#2 = aTipo;
     |LEE 000#rem01033.=;
     |SI FSalida ! 0; |DDEFECTO #rem01033; |FINSI;

     |PARA nPagAct = 1; |SI nPagAct [ enNumPags; |HACIENDO nPagAct = nPagAct + 1;
        |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01045#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 9;  LongDec = 0;
           aAlfa = #rem01045#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01045#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01045#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01045#8;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |LEE 000#rem01045.s;
           |SI FSalida ! 0; |O #rem01045#0 ! VEmpresa; |O #rem01045#1 ! 0; |O #rem01045#2 ! aTipo2;
              |DDEFECTO #rem01045;
           |FINSI;
        |SIGUE;

        |SI nPagAct = 1;
           aAlfa = #rem01033#56;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + ("0" * 13);
        |FINSI;
        |HAZ GrabaCadB; Cadena = "";

        |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01035#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 9;  LongDec = 0;
           aAlfa = #rem01035#5;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01035#7;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01035#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |LEE 000#rem01035.s;
           |SI FSalida ! 0; |O #rem01035#0 ! VEmpresa; |O #rem01035#1 ! 0; |O #rem01035#2 ! aTipo2;
              |DDEFECTO #rem01035;
           |FINSI;
        |SIGUE;

        |SI nPagAct = 1;
           aAlfa = #rem01033#59;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + ("0" * 13);
        |FINSI;
        |HAZ GrabaCadB; Cadena = "";

        |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01046#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;

           TipoDato = "An"; Long = 20;  LongDec = 0;
           aAlfa = #rem01046#5;  |QBF aAlfa;
           |SI aAlfa ! "";
               |HAZ FormateoB; Cadena = Cadena + aAlfa + "0";
           |SINO;
               aAlfa = #rem01046#7;  |QBF aAlfa;
               |SI aAlfa ! "";
                   |HAZ FormateoB; Cadena = Cadena + aAlfa + "1";
               |SINO;
                   |HAZ FormateoB; Cadena = Cadena + aAlfa + "0";
               |FINSI;
           |FINSI;

           TipoDato = "N"; Long = 11;  LongDec = 2;
           aAlfa = #rem01046#6;  |HAZ FormateoB; Cadena = Cadena + aAlfa;

           |LEE 000#rem01046.s;
           |SI FSalida ! 0; |O #rem01046#0 ! VEmpresa; |O #rem01046#1 ! 0; |O #rem01046#2 ! aTipo2;
              |DDEFECTO #rem01046;
           |FINSI;
        |SIGUE;

        |SI nPagAct = 1;
           aAlfa = #rem01033#62;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + ("0" * 13);
        |FINSI;
        |HAZ GrabaCadB; Cadena = "";

        |PARA nCont = 1; |SI nCont [ 2; |HACIENDO nCont = nCont + 1;
           aAlfa = #rem01047#4;   |HAZ TipoContrB; Cadena = Cadena + aTipoContrB;
           aAlfa = #rem01047#5;   |HAZ FormateoB;  Cadena = Cadena + aAlfa;
           aAlfa = #rem01047#6;   |HAZ FormateoB;  Cadena = Cadena + aAlfa;

           |LEE 000#rem01047.s;
           |SI FSalida ! 0; |O #rem01047#0 ! VEmpresa; |O #rem01047#1 ! 0; |O #rem01047#2 ! aTipo2;
              |DDEFECTO #rem01047;
           |FINSI;
        |SIGUE;
        |HAZ GrabaCadB; Cadena = "";

        |SI nPagAct = 1;
           aAlfa = #rem01033#63;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#66;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#67;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#68;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#69;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#70;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#71;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#72;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#73;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#75;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#76;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#77;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#78;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#79;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#80;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
           aAlfa = #rem01033#81;  |HAZ FormateoB; Cadena = Cadena + aAlfa;
        |SINO;
           Cadena = Cadena + ("0" * 208);
        |FINSI;
        |HAZ GrabaCadB; Cadena = "";

        Cadena = " " * 200;  |HAZ GrabaCadB;
        Cadena = " " * 200;  |HAZ GrabaCadB;
        Cadena = " " * 200;  |HAZ GrabaCadB;

        Cadena = Cadena + "</T10013000>" + eaCRLF; |HAZ GrabaCadB;
        |SI nPagAct < enNumPags;
           Cadena = Cadena + "<T10013000>C"; |HAZ GrabaCadB;
        |FINSI;
     |SIGUE;

     |CIERRA #rem01033;
     |CIERRA #rem01045;
     |CIERRA #rem01035;
     |CIERRA #rem01046;
     |CIERRA #rem01047;
|FPRC;

|PROCESO Hoja27;
     nSwDatos = 0; nCalc1 = 0; nConCta = 0;
     VTipo = eaTipo; aTipo = VTipo % 0110;

     Cadena = "<T10027000> ";

     TipoDato = "N"; Long = 11; LongDec = 2;
     #rem01001#0 = VEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = VTipo;
     |LEE 000#rem01001.=;
     |SI FSalida ! 0;  |DDEFECTO #rem01001;  |FINSI;

     Bloque = 38;  Casilla = "450"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     Bloque = 39;  Casilla = "455"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     Bloque = 42;  Casilla = "499"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     Bloque = 43;  Casilla = "500"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     Bloque = 42;  Casilla = "520"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     Bloque = 43;  Casilla = "521"; |HAZ BuscaCasillaB;
     aAlfa = Casilla; |HAZ FormateoB; Cadena = Cadena + aAlfa;

     nTotal = 0; nSusp = 0;
     Bloque = 50;  Casilla = "621"; |HAZ BuscaCasillaB; nTotal = Casilla;
     |SI SwError = 1; |O nTotal = 0;
         Bloque = 51;  Casilla = "622"; |HAZ BuscaCasillaB; nTotal = Casilla;
     |FINSI;

     |SI SwError = 1; |O nTotal = 0;
         Bloque = 46;  Casilla = "600"; |HAZ BuscaCasillaB; nTotal = Casilla;
         nSusp = 0;
     |SINO;
         nSusp = 1;
         nTotal = #rem01001#16;
     |FINSI;

     nConCta = 0;
     aAlfa = nTotal; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |HAZ GrabaCadB;  Cadena = "";

     |SI eaTipoBor ! "";
         aTipo = VTipo; |QBF aTipo;
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
              #rem00100#57 = "X";
         |FINSI;
     |FINSI;

     aTipo = VTipo; |QBF aTipo;
     |SI #rem00100#57 = "X";
         aSeparada = "N";
         |SI aTipo = "CONJUNTA"; |O aTipo = "CONJUNTAE";
             Cadena = Cadena + "2";
         |SINO;
             Cadena = Cadena + "1";
         |FINSI;
     |SINO;
         aSeparada = "S";
         Cadena = Cadena + "1";
     |FINSI;

     aAlfa = nSusp; Cadena = Cadena + aAlfa;

     Bloque = 48;  Casilla = "610"; |HAZ BuscaCasillaB;

     |SI #rem01001#14 = "4"; Casilla = 0; |FINSI;

     nCalc = Casilla;
     aAlfa = Casilla; |HAZ FormateoB;  Cadena = Cadena + aAlfa;
     |SI nCalc ! 0; nTotal = nCalc; |FINSI;

     nConCta = 0;
     |SI nTotal > 0;
         |SI #rem01001#8 = "S";
             aAlfa = "01";
         |SINO;
             aAlfa = "10";
         |FINSI;
         Cadena = Cadena + aAlfa;

         nCalc1 = #rem01001#16;
         |SI #rem01001#8 = "S";
             nCalc1 = (nCalc1 % 60) ! 2;
         |FINSI;
         aAlfa = nCalc1; |HAZ FormateoB; Cadena = Cadena + aAlfa;

         |SI #rem01001#9 = "E"; aAlfa = "1";              |FINSI;
         |SI #rem01001#9 = "A"; aAlfa = "2"; nConCta = 1; |FINSI;
         |SI #rem01001#9 = "D"; aAlfa = "3"; nConCta = 1; |FINSI;
         Cadena = Cadena + aAlfa;

         |SI #rem01001#8 = "S";
             |SI #rem01001#10 = "S";
                 aAlfa = "01"; nConCta = 1;
             |SINO;
                 aAlfa = "10";
             |FINSI;
         |SINO;
             aAlfa = "00";
         |FINSI;
         Cadena = Cadena + aAlfa;

         nCalc1 = 0;
         |SI #rem01001#8 = "S"; |Y #rem01001#10 = "S";
             nCalc1 = (#rem01001#16 % 40) ! 2;
         |FINSI;
         aAlfa = nCalc1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         Cadena = Cadena + "00";
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;

         Cadena = Cadena + "0";
         Cadena = Cadena + "00";
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |FINSI;

     |SI nTotal < 0;
         nTotal = 0 - nTotal; aAlfa = "";
         |SI #rem01001#11 = "X";
             Cadena = Cadena + "2";
         |SINO;
             |SI #rem01001#12 = "X";
                 Cadena = Cadena + "1";
                 nConCta = 1;
             |SINO;
                 Cadena = Cadena + "0";
             |FINSI;
         |FINSI;

         aAlfa = nTotal; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         Cadena = Cadena + "0";
         aAlfa = 0; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |FINSI;

     |SI nConCta = 1;
         TipoDato = "A"; Long = 34;   LongDec = 0;
         aAlfa = eaCuenta1; |HAZ FormateoB; Cadena = Cadena + aAlfa;

         TipoDato = "A"; Long = 11;   LongDec = 0;
         aAlfa = eaBIC1; |HAZ FormateoB; Cadena = Cadena + aAlfa;
     |SINO;
         Cadena = Cadena + (" " * 45);
     |FINSI;
     |HAZ GrabaCadB;  Cadena = "";

     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 200;  |HAZ GrabaCadB;
     Cadena = " " * 189;  |HAZ GrabaCadB;

     Cadena = Cadena + "</T10027000>" + eaCRLF; |HAZ GrabaCadB;
|FPRC;

|PROCESO GrabaSecuencial100;
     eaIP = ""; |IP_REMOTO eaIP;

     VEmpresa = enEmpresa; VTipo    = eaTipo;
     aNif = eaNif; |QBF aNif; aNif = aNif % 0108;

     Nombre = ("00000" + VEmpresa) % -105;
     Nombre = "or" + Nombre;
     |QBF Nombre;
     Comodin = VTipo; |QBF Comodin;
     |SI Comodin = "CONJUNTA";  Comodin = "A"; |FINSI;
     |SI Comodin = "CONJUNTAE"; Comodin = "A"; |FINSI;
     Nombre = Nombre + (Comodin % 0101);
     |QBF Nombre;
     Nombre = Nombre + ".txt";

     |DBASE Comodin; |QBF Comodin;
     Comodin = Comodin + "tmp/"; |MKDIR Comodin;
     Comodin = Comodin + Nombre;
     |XABRE "WB", Comodin, enHandle;
     enHandle = FSalida;
     |SI FSalida < 0; |MENAV "    Problemas al abrir el fichero ascii"; |ACABA; |FINSI;

     |ABRE #rem00101; |ABRE #rem01001; |ABRE #rem01002;
     |SELECT #2#rem01002;

     #rem01001#0 = VEmpresa;
     #rem01001#1 = 0;
     #rem01001#2 = VTipo;
     |LEE 000#rem01001.=;

     eaCRLF = &13 + &10;  ||quitar
     eaCRLF = "";

     LongDec = 0;
     Cadena = "<T100020160A0000><AUX>";
     Cadena = Cadena + (" " * 30);
     |HAZ GrabaCadB;

     Cadena = #reemi100#35;
     Cadena = Cadena + (" " * 47);
     |HAZ GrabaCadB;

     Cadena = "B53179768"; |HAZ GrabaCadB; Cadena = "";

     Cadena = Cadena + (" " * 100);
     |HAZ GrabaCadB; Cadena = "";
     Cadena = Cadena + (" " * 113);
     |HAZ GrabaCadB; Cadena = "";

     Cadena = "</AUX>";
     Cadena = Cadena + eaCRLF;
     |HAZ GrabaCadB;

     enEmpr = VEmpresa;

     |HAZ Hoja01;
     |HAZ Hoja02;
     |HAZ Hoja03;
     |HAZ Hoja04;
     |HAZ Hoja05;
     |HAZ Hoja06;
     |HAZ Hoja07;
     |HAZ Hoja08;
     |HAZ Hoja09;
     |HAZ Hoja10;
     |HAZ Hoja11;
     |HAZ Hoja12;
     |HAZ Hoja13;
     |HAZ Hoja14;
     |HAZ Hoja15;
     |HAZ Hoja16;
     |HAZ Hoja17;
     |HAZ Hoja18;
     |HAZ Hoja19;
     |HAZ Hoja20;
     |HAZ Hoja21;
     |HAZ Hoja22;
     |HAZ Hoja23;
     |HAZ Hoja24;
     |HAZ Hoja25;
     |HAZ Hoja26;
     |HAZ Hoja27;

     Cadena = "</T100020160A0000>" + eaCRLF;
     |HAZ GrabaCadB; Cadena = "";

     |CIERRA #rem01002; |CIERRA #rem00101; |CIERRA #rem01001;

     |XCIERRA enHandle; SwDatos = 1;
|FPRC;
