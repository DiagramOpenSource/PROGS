||DESCARGAS

|FICHEROS;
     rem05000;
     rem05001;
     rem05002;
     rem05003;
     rem05004;
     rem05005;
     rem05006;
     rem05007;
     rem05008;
     rem05009;
     rem05010;
     rem05011;
     rem05012;
     rem05013;
     rem05014;
     rem05015;
     rem05016;
     rem05017;
     rem05018;
     rem05019;
     rem05020;
     rem05021;
     rem05022;
     rem05023;
     rem05024;
     rem05025;
     rem05026;
     rem05027;
     rem05028;
     rem05029;
     rem05030;
     rem05031;
     rem05032;
     rem05033;
     rem05034;
     rem05035;
     rem05036;
     rem05037;
     rem05038;
     rem05039;
     rem05040;
     rem05041;

     zregubic;

     tempora0@;
|FIN;

|INCLUYE m05000c9;
|INCLUYE i_sepnom;

|PROCESO CtrlImporte;
     aNeg = aAlfa1 % 101;
     |SI aNeg = "N";
         aAlfa1 = "-" + aAlfa1 % 240;
     |FINSI;
|FPRC;

|PROCESO ClaveDOM;
     |ABRE #rem05031;
     #rem05031#0  = #rem05000#0;
     #rem05031#1  = nContri;
     #rem05031#2  = nContri;
     |LEE 101#rem05031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem05031;
         #rem05031#0  = #rem05000#0;
         #rem05031#1  = nContri;
         #rem05031#2  = nContri;
         |GRABA 020#rem05031.b;
     |FINSI;

     #rem05031#3  = aNegro;
     #rem05031#4  = "Pendiente";
     #rem05031#5  = "rem00100";
     #rem05031#6  = 0;
     #rem05031#19 = aCadena1 % 1002;
     #rem05031#20 = aCadena1 % 1205;
     #rem05031#21 = aCadena1 % 2275;
     #rem05031#22 = aCadena1 % 9703;
     #rem05031#23 = aCadena1 % 10104;
     #rem05031#24 = aCadena1 % 10503;
     #rem05031#25 = aCadena1 % 10803;
     #rem05031#26 = aCadena1 % 11103;
     #rem05031#27 = aCadena1 % 11403;
     #rem05031#28 = aCadena1 % 11703;
     #rem05031#29 = aCadena1 % 12003;
     #rem05031#30 = aCadena1 % 12340;
     #rem05031#31 = aCadena1 % 20330;
     #rem05031#32 = aCadena1 % 19305;
     #rem05031#33 = aCadena1 % 23302;
     #rem05031#34 = aCadena1 % 23520;

     |GRABA 020#rem05031.a;
     |LIBERA #rem05031;
     |CIERRA #rem05031;
|FPRC;

|PROCESO ClaveVHR;
     |ABRE #rem05037;
     #rem05037#0  = #rem05000#0;
     #rem05037#1  = nContri;
     #rem05037#2  = nContri;
     |LEE 101#rem05037.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem05037;
         #rem05037#0  = #rem05000#0;
         #rem05037#1  = nContri;
         #rem05037#2  = nContri;
         |GRABA 020#rem05037.b;
     |FINSI;

     #rem05037#3  = aNegro;
     #rem05037#4  = "Pendiente";
     #rem05037#5  = "rem00102";
     #rem05037#6  = 0;
     #rem05037#7  = aCadena1 % 0901;
     #rem05037#8  = aCadena1 % 1001;
     #rem05037#9  = aCadena1 % 1120;
     #rem05037#10 = aCadena1 % 3109;
     #rem05037#11 = aCadena1 % 4020;
     #rem05037#12 = aCadena1 % 6001;

     |GRABA 020#rem05037.a;
     |LIBERA #rem05037;
     |CIERRA #rem05037;
|FPRC;

|PROCESO ClaveDE;
     |SI nContri ! 1;  |ACABA;  |FINSI;

     nLinea = 1;

     |ABRE #rem05032;
     #rem05032#0 = #rem05000#0;
     #rem05032#1 = nContri;
     #rem05032#2 = 999;
     |LEE 000#rem05032.];
     |SI FSalida = 0;
         |LEE 000#rem05032.a;
     |SINO;
         |LEE 000#rem05032.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05032#0 = #rem05000#0; |Y #rem05032#1 = nContri;
         nLinea = #rem05032#2 + 1;
     |FINSI;

     |DDEFECTO #rem05032;
     #rem05032#0   = #rem05000#0;
     #rem05032#1   = nContri;
     #rem05032#2   = nLinea;
     #rem05032#3   = aNegro;
     #rem05032#4   = "Pendiente";
     #rem05032#5   = "rem00101";
     #rem05032#6   = 0;
     #rem05032#7   = aCadena1 % 2309;
     #rem05032#8   = aCadena1 % 3240;
     #rem05032#9   = aCadena1 % 7301;
     #rem05032#10  = (aCadena1 % 8102) + "." + (aCadena1 % 7902) + "." + (aCadena1 % 7504);
     #rem05032#11  = (aCadena1 % 8902) + "." + (aCadena1 % 8702) + "." + (aCadena1 % 8304);
     #rem05032#12  = aCadena1 % 9101;
     #rem05032#13  = aCadena1 % 9201;
     #rem05032#14  = aCadena1 % 9501;
     #rem05032#15  = (aCadena1 % 10202) + "." + (aCadena1 % 10002) + "." + (aCadena1 % 9604);

     aAlfa1 = aCadena1 % 10413;  |HAZ CtrlImporte;  #rem05032#16 = aAlfa1;  #rem05032#16 = #rem05032#16 / 100;

     |GRABA 020#rem05032.n;
     |LIBERA #rem05032;
     |CIERRA #rem05032;
|FPRC;

|PROCESO ClaveAS;
     |SI nContri ! 1;  |ACABA;  |FINSI;

     nLinea = 1;

     |ABRE #rem05041;
     #rem05041#0 = #rem05000#0;
     #rem05041#1 = nContri;
     #rem05041#2 = 999;
     |LEE 000#rem05041.];
     |SI FSalida = 0;
         |LEE 000#rem05041.a;
     |SINO;
         |LEE 000#rem05041.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05041#0 = #rem05000#0; |Y #rem05041#1 = nContri;
         nLinea = #rem05041#2 + 1;
     |FINSI;

     |DDEFECTO #rem05041;
     #rem05041#0   = #rem05000#0;
     #rem05041#1   = nContri;
     #rem05041#2   = nLinea;
     #rem05041#3   = aNegro;
     #rem05041#4   = "Pendiente";
     #rem05041#5   = "rem00101";
     #rem05041#6   = 0;
     #rem05041#7   = aCadena1 % 2309;
     #rem05041#8   = aCadena1 % 3240;
     #rem05041#9   = aCadena1 % 7203;
     #rem05041#10  = (aCadena1 % 8102) + "." + (aCadena1 % 7902) + "." + (aCadena1 % 7504);
     #rem05041#11  = aCadena1 % 8301;
     #rem05041#12  = aCadena1 % 8401;
     #rem05041#13  = (aCadena1 % 9102) + "." + (aCadena1 % 8902) + "." + (aCadena1 % 8504);

     |GRABA 020#rem05041.n;
     |LIBERA #rem05041;
     |CIERRA #rem05041;
|FPRC;

|PROCESO ClaveTI;
     aAlfa1 = aCadena1 % 903;

     nLinea = 1;

     |SI nContri = 1;
         |SI aAlfa1 = "T02";  nLinea = 2;  |FINSI;
     |FINSI;

     |SI nContri = 2;
         nLinea = 2;

         |SI aAlfa1 = "T02";  |ACABA;  |FINSI;
     |FINSI;

     |ABRE #rem05031;
     #rem05031#0  = #rem05000#0;
     #rem05031#1  = nContri;
     #rem05031#2  = nLinea;
     |LEE 101#rem05031.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem05031;
         #rem05031#0  = #rem05000#0;
         #rem05031#1  = nContri;
         #rem05031#2  = nLinea;
         |GRABA 020#rem05031.b;
     |FINSI;

     #rem05031#3  = aNegro;
     #rem05031#4  = "Pendiente";
     #rem05031#5  = "rem00100";
     #rem05031#6  = 0;
     #rem05031#8  = aCadena1 % 2309;

     Cadena       = aCadena1 % 3240;  |HAZ SeparaNombre;
     #rem05031#9  = Cadena1 + " " + Cadena2 + ", " + Cadena3;

     aAlfa        = aCadena1 % 7203;
     nNume        = aAlfa;
     #rem05031#10 = nNume;
     |SI #rem05031#10 = "0";
         #rem05031#10 = "";
     |FINSI;

     #rem05031#11 = (aCadena1 % 8102) + "." + (aCadena1 % 7902) + "." + (aCadena1 % 7504);

     aAlfa1 = aCadena1 % 8301;
     |SI aAlfa1 = "1";  #rem05031#12 = "HOMBRE";  |FINSI;
     |SI aAlfa1 = "2";  #rem05031#12 = "MUJER";   |FINSI;

     #rem05031#13 = (aCadena1 % 9002) + "." + (aCadena1 % 8802) + "." + (aCadena1 % 8404);
     #rem05031#14 = aCadena1 % 9202;
     #rem05031#18 = aCadena1 % 9820;

     |GRABA 020#rem05031.a;
     |LIBERA #rem05031;
     |CIERRA #rem05031;
|FPRC;

|PROCESO DatosPersonales;
     |SI nContri > 2;  |ACABA;  |FINSI;

     aAlfa1 = aCadena1 % 203;
     |SI aAlfa1 = "DOM";  |HAZ ClaveDOM;  |ACABA;  |FINSI;
     |SI aAlfa1 = "VHR";  |HAZ ClaveVHR;  |ACABA;  |FINSI;

     aAlfa1 = aCadena1 % 202;
     |SI aAlfa1 = "TI";  |HAZ ClaveTI;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DE";  |HAZ ClaveDE;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AS";  |HAZ ClaveAS;  |ACABA;  |FINSI;
|FPRC;

|PROCESO ClaveRT;
     nLinea = 1;

     |ABRE #rem05001;
     #rem05001#0 = #rem05000#0;
     #rem05001#1 = nContri;
     #rem05001#2 = 999;
     |LEE 000#rem05001.];
     |SI FSalida = 0;
         |LEE 000#rem05001.a;
     |SINO;
         |LEE 000#rem05001.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05001#0 = #rem05000#0; |Y #rem05001#1 = nContri;
         nLinea = #rem05001#2 + 1;
     |FINSI;

     |DDEFECTO #rem05001;
     #rem05001#0   = #rem05000#0;
     #rem05001#1   = nContri;
     #rem05001#2   = nLinea;
     #rem05001#3   = aNegro;
     #rem05001#4   = "Pendiente";
     #rem05001#5   = "rem00020";
     #rem05001#6   = 0;
     #rem05001#7   = aCadena1 % 0909;
     #rem05001#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5802;
     |SI aAlfa1 = "A ";  #rem05001#9 = "Empleados";             |FINSI;
     |SI aAlfa1 = "B1";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI aAlfa1 = "B2";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI aAlfa1 = "B3";  #rem05001#9 = "Pensionistas";          |FINSI;
     |SI aAlfa1 = "C ";  #rem05001#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI aAlfa1 = "D ";  #rem05001#9 = "Prestaci¢n desempleo";  |FINSI;
     |SI aAlfa1 = "E1";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI aAlfa1 = "E2";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI aAlfa1 = "E3";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI aAlfa1 = "E4";  #rem05001#9 = "Consej.y adminstrad.";  |FINSI;
     |SI aAlfa1 = "F1";  #rem05001#9 = "Premios             ";  |FINSI;
     |SI aAlfa1 = "F2";  #rem05001#9 = "Premios             ";  |FINSI;
     |SI aAlfa1 = "L ";  #rem05001#9 = "Rentas exentas";        |FINSI;

     aAlfa1 = aCadena1 % 6013;  |HAZ CtrlImporte;  #rem05001#10 = aAlfa1;  #rem05001#10 = #rem05001#10 / 100;
     aAlfa1 = aCadena1 % 7313;  |HAZ CtrlImporte;  #rem05001#11 = aAlfa1;  #rem05001#11 = #rem05001#11 / 100;
     aAlfa1 = aCadena1 % 8613;  |HAZ CtrlImporte;  #rem05001#12 = aAlfa1;  #rem05001#12 = #rem05001#12 / 100;
     aAlfa1 = aCadena1 % 9913;  |HAZ CtrlImporte;  #rem05001#13 = aAlfa1;  #rem05001#13 = #rem05001#13 / 100;
     aAlfa1 = aCadena1 % 11213; |HAZ CtrlImporte;  #rem05001#14 = aAlfa1;  #rem05001#14 = #rem05001#14 / 100;
     aAlfa1 = aCadena1 % 12513; |HAZ CtrlImporte;  #rem05001#15 = aAlfa1;  #rem05001#15 = #rem05001#15 / 100;
     aAlfa1 = aCadena1 % 13813; |HAZ CtrlImporte;  #rem05001#16 = aAlfa1;  #rem05001#16 = #rem05001#16 / 100;
     aAlfa1 = aCadena1 % 15113; |HAZ CtrlImporte;  #rem05001#17 = aAlfa1;  #rem05001#17 = #rem05001#17 / 100;
     aAlfa1 = aCadena1 % 16413; |HAZ CtrlImporte;  #rem05001#18 = aAlfa1;  #rem05001#18 = #rem05001#18 / 100;
     aAlfa1 = aCadena1 % 17713; |HAZ CtrlImporte;  #rem05001#19 = aAlfa1;  #rem05001#19 = #rem05001#19 / 100;

     aAlfa1 = aCadena1 % 19001;
     |SI aAlfa1 = "0";  #rem05001#20 = "N";   |FINSI;
     |SI aAlfa1 = "1";  #rem05001#20 = "S";   |FINSI;

     aAlfa1 = aCadena1 % 19101;
     |SI aAlfa1 = "0";  #rem05001#21 = "N";   |FINSI;
     |SI aAlfa1 ! "0";  #rem05001#21 = "S";   |FINSI;

     #rem05001#22 = aCadena1 % 19201;

     |GRABA 020#rem05001.n;
     |LIBERA #rem05001;
     |CIERRA #rem05001;
|FPRC;

|PROCESO ClaveRB;
     nLinea = 1;

     |ABRE #rem05030;
     #rem05030#0 = #rem05000#0;
     #rem05030#1 = nContri;
     #rem05030#2 = 999;
     |LEE 000#rem05030.];
     |SI FSalida = 0;
         |LEE 000#rem05030.a;
     |SINO;
         |LEE 000#rem05030.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05030#0 = #rem05000#0; |Y #rem05030#1 = nContri;
         nLinea = #rem05030#2 + 1;
     |FINSI;

     |DDEFECTO #rem05030;
     #rem05030#0   = #rem05000#0;
     #rem05030#1   = nContri;
     #rem05030#2   = nLinea;
     #rem05030#3   = aNegro;
     #rem05030#4   = "Pendiente";
     #rem05030#6   = 0;
     #rem05030#7   = aCadena1 % 0909;
     #rem05030#8   = aCadena1 % 1840;
     #rem05030#15  = aCadena1 % 5802;

     |SI #rem05030#15 = "K1";
         #rem05030#5   = "rem00037";
         #rem05030#9 = "Premios sin fines publicitarios";
     |FINSI;

     |SI #rem05030#15 = "K2";
         #rem05030#5   = "rem00030";
         #rem05030#9 = "Aprovechamientos forestales";
     |FINSI;

     |SI #rem05030#15 = "K3";
         #rem05030#5   = "rem00037";
         #rem05030#9 = "Premios con fines publicitarios";
     |FINSI;

     aAlfa1 = aCadena1 % 6013;   |HAZ CtrlImporte;  #rem05030#10 = aAlfa1;  #rem05030#10 = #rem05030#10 / 100;
     aAlfa1 = aCadena1 % 7313;   |HAZ CtrlImporte;  #rem05030#11 = aAlfa1;  #rem05030#11 = #rem05030#11 / 100;
     aAlfa1 = aCadena1 % 8613;   |HAZ CtrlImporte;  #rem05030#12 = aAlfa1;  #rem05030#12 = #rem05030#12 / 100;
     aAlfa1 = aCadena1 % 9913;   |HAZ CtrlImporte;  #rem05030#13 = aAlfa1;  #rem05030#13 = #rem05030#13 / 100;
     aAlfa1 = aCadena1 % 11213;  |HAZ CtrlImporte;  #rem05030#14 = aAlfa1;  #rem05030#14 = #rem05030#14 / 100;

     |GRABA 020#rem05030.n;
     |LIBERA #rem05030;
     |CIERRA #rem05030;
|FPRC;

|PROCESO ClaveRC;
     nLinea = 1;

     |ABRE #rem05008;
     #rem05008#0 = #rem05000#0;
     #rem05008#1 = nContri;
     #rem05008#2 = 999;
     |LEE 000#rem05008.];
     |SI FSalida = 0;
         |LEE 000#rem05008.a;
     |SINO;
         |LEE 000#rem05008.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05008#0 = #rem05000#0; |Y #rem05008#1 = nContri;
         nLinea = #rem05008#2 + 1;
     |FINSI;

     |DDEFECTO #rem05008;
     #rem05008#0   = #rem05000#0;
     #rem05008#1   = nContri;
     #rem05008#2   = nLinea;
     #rem05008#3   = aNegro;
     #rem05008#4   = "Pendiente";
     #rem05008#5   = "rem00031";
     #rem05008#6   = 0;
     #rem05008#7   = aCadena1 % 0909;
     #rem05008#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5801;
     |SI aAlfa1 = "G";  #rem05008#9 = "Profesionales";         |FINSI;
     |SI aAlfa1 = "H";  #rem05008#9 = "Agr¡colas";             |FINSI;
     |SI aAlfa1 = "I";  #rem05008#9 = "Art¡culo 70.2";         |FINSI;
     |SI aAlfa1 = "J";  #rem05008#9 = "Derechos imagen";       |FINSI;

     aAlfa1 = aCadena1 % 6013;   |HAZ CtrlImporte;  #rem05008#10 = aAlfa1;  #rem05008#10 = #rem05008#10 / 100;
     aAlfa1 = aCadena1 % 7313;   |HAZ CtrlImporte;  #rem05008#11 = aAlfa1;  #rem05008#11 = #rem05008#11 / 100;
     aAlfa1 = aCadena1 % 8613;   |HAZ CtrlImporte;  #rem05008#12 = aAlfa1;  #rem05008#12 = #rem05008#12 / 100;
     aAlfa1 = aCadena1 % 9913;   |HAZ CtrlImporte;  #rem05008#13 = aAlfa1;  #rem05008#13 = #rem05008#13 / 100;
     aAlfa1 = aCadena1 % 11213;  |HAZ CtrlImporte;  #rem05008#14 = aAlfa1;  #rem05008#14 = #rem05008#14 / 100;

     |GRABA 020#rem05008.n;
     |LIBERA #rem05008;
     |CIERRA #rem05008;
|FPRC;

|PROCESO ClaveCB;
     nLinea = 1;

     |ABRE #rem05002;
     #rem05002#0 = #rem05000#0;
     #rem05002#1 = nContri;
     #rem05002#2 = 999;
     |LEE 000#rem05002.];
     |SI FSalida = 0;
         |LEE 000#rem05002.a;
     |SINO;
         |LEE 000#rem05002.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05002#0 = #rem05000#0; |Y #rem05002#1 = nContri;
         nLinea = #rem05002#2 + 1;
     |FINSI;

     |DDEFECTO #rem05002;
     #rem05002#0   = #rem05000#0;
     #rem05002#1   = nContri;
     #rem05002#2   = nLinea;
     #rem05002#3   = aNegro;
     #rem05002#4   = "Pendiente";
     #rem05002#5   = "rem00023";
     #rem05002#6   = 0;
     #rem05002#7   = aCadena1 % 0909;
     #rem05002#8   = aCadena1 % 1840;
     #rem05002#9   = aCadena1 % 5810;

     aAlfa1 = aCadena1 % 6801;
     |SI aAlfa1 = "1";  #rem05002#10 = "Cuenta corriente";     |FINSI;
     |SI aAlfa1 = "2";  #rem05002#10 = "Cuenta ahorro";        |FINSI;
     |SI aAlfa1 = "3";  #rem05002#10 = "Imposici¢n a plazo";   |FINSI;
     |SI aAlfa1 = "4";  #rem05002#10 = "Cuentas financieras";  |FINSI;
     |SI aAlfa1 = "5";  #rem05002#10 = "Cuentas de cr‚dito";   |FINSI;
     |SI aAlfa1 = "6";  #rem05002#10 = "Cuentas soportadas";   |FINSI;

     aAlfa1 = aCadena1 % 6903;   #rem05002#11 = aAlfa1;
     aAlfa1 = aCadena1 % 7213;   |HAZ CtrlImporte;  #rem05002#12 = aAlfa1;  #rem05002#12 = #rem05002#12 / 100;
     aAlfa1 = aCadena1 % 8513;   |HAZ CtrlImporte;  #rem05002#13 = aAlfa1;  #rem05002#13 = #rem05002#13 / 100;
     aAlfa1 = aCadena1 % 9813;   |HAZ CtrlImporte;  #rem05002#14 = aAlfa1;  #rem05002#14 = #rem05002#14 / 100;
     aAlfa1 = aCadena1 % 11113;  |HAZ CtrlImporte;  #rem05002#15 = aAlfa1;  #rem05002#15 = #rem05002#15 / 100;

     |GRABA 020#rem05002.n;
     |LIBERA #rem05002;
     |CIERRA #rem05002;
|FPRC;

|PROCESO ClaveRE;
     nLinea = 1;

     |ABRE #rem05003;
     #rem05003#0 = #rem05000#0;
     #rem05003#1 = nContri;
     #rem05003#2 = 999;
     |LEE 000#rem05003.];
     |SI FSalida = 0;
         |LEE 000#rem05003.a;
     |SINO;
         |LEE 000#rem05003.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05003#0 = #rem05000#0; |Y #rem05003#1 = nContri;
         nLinea = #rem05003#2 + 1;
     |FINSI;

     |DDEFECTO #rem05003;
     #rem05003#0   = #rem05000#0;
     #rem05003#1   = nContri;
     #rem05003#2   = nLinea;
     #rem05003#3   = aNegro;
     #rem05003#4   = "Pendiente";
     #rem05003#6   = 0;
     #rem05003#7   = aCadena1 % 0909;
     #rem05003#8   = aCadena1 % 1840;
     #rem05003#9   = aCadena1 % 5809;
     #rem05003#10  = aCadena1 % 6740;
     #rem05003#11  = "";

     aAlfa1 = aCadena1 % 10703;
     |SI aAlfa1 = "A01";  #rem05003#11 = "Base imponible ahorro: primas asistencia";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A02";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A03";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A04";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A05";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A07";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;
     |SI aAlfa1 = "A08";  #rem05003#11 = "Base imponible ahorro: dividendos       ";  #rem05003#5 = "rem00022";   |FINSI;

     |SI aAlfa1 = "B01";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B02";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B03";  #rem05003#11 = "Base imponible ahorro: intereses        ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B04";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B05";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B06";  #rem05003#11 = "Base imponible ahorro: rendimientos     ";  #rem05003#5 = "rem00023";   |FINSI;

     |SI aAlfa1 = "C05";  #rem05003#11 = "Rentas vitalicias o temporales          ";  #rem05003#5 = "rem00051";   |FINSI;
     |SI aAlfa1 = "GAS";  #rem05003#11 = "Base imponible ahorro: gastos deducibles";  #rem05003#5 = "rem00022";   |FINSI;

     |SI aAlfa1 = "C01";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C02";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C03";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C04";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C06";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C07";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C12";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;

     |SI aAlfa1 = "D01";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D02";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D03";  #rem05003#11 = "Base imponible general: intereses       ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D04";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D05";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D06";  #rem05003#11 = "Base imponible general: rendimientos    ";  #rem05003#5 = "rem00023";   |FINSI;

     #rem05003#16 = aAlfa1;

     aAlfa1 = #rem05003#11;  |QBF aAlfa1;
     |SI aAlfa1  = "";  |ACABA;  |FINSI;

     aAlfa1 = aCadena1 % 11001;
     |SI aAlfa1 = "1";  #rem05003#12 = "Dineraria";   |FINSI;
     |SI aAlfa1 = "2";  #rem05003#12 = "En especie";  |FINSI;

     aAlfa1 = aCadena1 % 11313;  |HAZ CtrlImporte;  #rem05003#13 = aAlfa1;  #rem05003#13 = #rem05003#13 / 100;
     aAlfa1 = aCadena1 % 12613;  |HAZ CtrlImporte;  #rem05003#14 = aAlfa1;  #rem05003#14 = #rem05003#14 / 100;
     aAlfa1 = aCadena1 % 13913;  |HAZ CtrlImporte;  #rem05003#15 = aAlfa1;  #rem05003#15 = #rem05003#15 / 100;

     |GRABA 020#rem05003.n;
     |LIBERA #rem05003;
     |CIERRA #rem05003;
|FPRC;

|PROCESO ClaveRI;
     nLinea = 1;

     |ABRE #rem05029;
     #rem05029#0 = #rem05000#0;
     #rem05029#1 = nContri;
     #rem05029#2 = 999;
     |LEE 000#rem05029.];
     |SI FSalida = 0;
         |LEE 000#rem05029.a;
     |SINO;
         |LEE 000#rem05029.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05029#0 = #rem05000#0; |Y #rem05029#1 = nContri;
         nLinea = #rem05029#2 + 1;
     |FINSI;

     |DDEFECTO #rem05029;
     #rem05029#0   = #rem05000#0;
     #rem05029#1   = nContri;
     #rem05029#2   = nLinea;
     #rem05029#3   = aNegro;
     #rem05029#4   = "Pendiente";
     #rem05029#6   = 0;
     #rem05029#7   = aCadena1 % 0909;
     #rem05029#8   = aCadena1 % 1840;
     #rem05029#9   = aCadena1 % 5809;
     #rem05029#10  = aCadena1 % 6740;
     #rem05029#11  = "";

     aAlfa1 = aCadena1 % 10701;
     |SI aAlfa1 = "A";  #rem05029#11 = "Transmisi¢n                             ";  #rem05029#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "B";  #rem05029#11 = "Amortizaci¢n o reembolso                ";  #rem05029#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "C";  #rem05029#11 = "Canje o conversi¢n                      ";  #rem05029#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "D";  #rem05029#11 = "Transmisi¢n de activos financieros      ";  #rem05029#5 = "rem00023";   |FINSI;
     |SI aAlfa1 = "E";  #rem05029#11 = "Operaciones de cesi¢n temporal          ";  #rem05029#5 = "rem00023";   |FINSI;

     #rem05029#15 = aAlfa1;

     aAlfa1 = aCadena1 % 10813;  |HAZ CtrlImporte;  #rem05029#12 = aAlfa1;  #rem05029#12 = #rem05029#12 / 100;
     aAlfa1 = aCadena1 % 12113;  |HAZ CtrlImporte;  #rem05029#13 = aAlfa1;  #rem05029#13 = #rem05029#13 / 100;

     #rem05029#14  = aCadena1 % 13401;

     |GRABA 020#rem05029.n;
     |LIBERA #rem05029;
     |CIERRA #rem05029;
|FPRC;

|PROCESO ClaveAE;
     nLinea = 1;

     |ABRE #rem05024;
     #rem05024#0 = #rem05000#0;
     #rem05024#1 = nContri;
     #rem05024#2 = 999;
     |LEE 000#rem05024.];
     |SI FSalida = 0;
         |LEE 000#rem05024.a;
     |SINO;
         |LEE 000#rem05024.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05024#0 = #rem05000#0; |Y #rem05024#1 = nContri;
         nLinea = #rem05024#2 + 1;
     |FINSI;

     |DDEFECTO #rem05024;
     #rem05024#0   = #rem05000#0;
     #rem05024#1   = nContri;
     #rem05024#2   = nLinea;
     #rem05024#3   = aNegro;
     #rem05024#4   = "No trasladable";
     #rem05024#5   = "";
     #rem05024#6   = 0;
     #rem05024#7   = aCadena1 % 0903;
     #rem05024#8   = aCadena1 % 1205;

     |GRABA 020#rem05024.n;
     |LIBERA #rem05024;
     |CIERRA #rem05024;
|FPRC;

|PROCESO ClaveTV;
     nLinea = 1;

     |ABRE #rem05004;
     #rem05004#0 = #rem05000#0;
     #rem05004#1 = nContri;
     #rem05004#2 = 999;
     |LEE 000#rem05004.];
     |SI FSalida = 0;
         |LEE 000#rem05004.a;
     |SINO;
         |LEE 000#rem05004.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05004#0 = #rem05000#0; |Y #rem05004#1 = nContri;
         nLinea = #rem05004#2 + 1;
     |FINSI;

     |DDEFECTO #rem05004;
     #rem05004#0   = #rem05000#0;
     #rem05004#1   = nContri;
     #rem05004#2   = nLinea;
     #rem05004#3   = aNegro;
     #rem05004#4   = "No trasladable";
     #rem05004#5   = "";
     #rem05004#6   = 0;
     #rem05004#7   = aCadena1 % 0909;
     #rem05004#8   = aCadena1 % 1840;
     #rem05004#9   = aCadena1 % 5809;
     #rem05004#10  = aCadena1 % 6740;
     aAlfa1 = (aCadena1 % 11302) + "." + (aCadena1 % 11102) + "." + (aCadena1 % 10704);
     #rem05004#11  = aAlfa1;

     aAlfa1 = aCadena1 % 11501;
     |SI aAlfa1 = "A";  #rem05004#17 = "Mercado secundario oficial de valores espa¤ol";     |FINSI;
     |SI aAlfa1 = "B";  #rem05004#17 = "Mercado secundario oficial de valores extranjeros"; |FINSI;
     |SI aAlfa1 = "C";  #rem05004#17 = "Otros mercados nacionales";                         |FINSI;
     |SI aAlfa1 = "D";  #rem05004#17 = "Otros mercados extranjeros";                        |FINSI;
     |SI aAlfa1 = "F";  #rem05004#17 = "Operaciones intervenidas por fedatarios p£blicos";  |FINSI;
     |SI aAlfa1 = "F";  #rem05004#17 = "Operaciones realizadas fuera de mercado (OTC)";     |FINSI;

     aAlfa1 = aCadena1 % 11601;
     |SI aAlfa1 = "A";  #rem05004#12 = "Acciones en sociedades resp.limitada    ";  |FINSI;
     |SI aAlfa1 = "B";  #rem05004#12 = "Activos con rdtos explicitos            ";  |FINSI;
     |SI aAlfa1 = "C";  #rem05004#12 = "Activos con rdtos implicitos            ";  |FINSI;
     |SI aAlfa1 = "D";  #rem05004#12 = "Principales segregados                  ";  |FINSI;
     |SI aAlfa1 = "E";  #rem05004#12 = "Cupones segregados                      ";  |FINSI;
     |SI aAlfa1 = "F";  #rem05004#12 = "Derechos de Garant¡a                    ";  |FINSI;
     |SI aAlfa1 = "G";  #rem05004#12 = "Derechos de Disfrute                    ";  |FINSI;
     |SI aAlfa1 = "H";  #rem05004#12 = "Derechos de suscripci¢n                 ";  |FINSI;
     |SI aAlfa1 = "I";  #rem05004#12 = "Otros                                   ";  |FINSI;
     |SI aAlfa1 = "K";  #rem05004#12 = "Participaciones preferentes             ";  |FINSI;
     |SI aAlfa1 = "M";  #rem05004#12 = "Acciones Instit.Inversion Colectivas    ";  |FINSI;

     aAlfa1 = aCadena1 % 11703;  #rem05004#13 = aAlfa1;
     aAlfa1 = aCadena1 % 12015;  |HAZ CtrlImporte;  #rem05004#14 = aAlfa1;  #rem05004#14 = #rem05004#14 / 100;
     aAlfa1 = aCadena1 % 13512;  |HAZ CtrlImporte;  #rem05004#15 = aAlfa1;  #rem05004#15 = #rem05004#15 / 100;

     aAlfa1 = aCadena1 % 14701;
     |SI aAlfa1 = "B";  #rem05004#16 = "Perceptor de los rendimientos";  |FINSI;
     |SI aAlfa1 = "C";  #rem05004#16 = "Tercero por cuenta           ";  |FINSI;
     |SI aAlfa1 = "N";  #rem05004#16 = "Nudo propietario             ";  |FINSI;
     |SI aAlfa1 = "P";  #rem05004#16 = "Prestamista                  ";  |FINSI;
     |SI aAlfa1 = "Q";  #rem05004#16 = "Prestatario                  ";  |FINSI;
     |SI aAlfa1 = "T";  #rem05004#16 = "Titular                      ";  |FINSI;
     |SI aAlfa1 = "U";  #rem05004#16 = "Usufructuario                ";  |FINSI;

     |GRABA 020#rem05004.n;
     |LIBERA #rem05004;
     |CIERRA #rem05004;
|FPRC;

|PROCESO ClaveSG;
     nLinea = 1;

     |ABRE #rem05005;
     #rem05005#0 = #rem05000#0;
     #rem05005#1 = nContri;
     #rem05005#2 = 999;
     |LEE 000#rem05005.];
     |SI FSalida = 0;
         |LEE 000#rem05005.a;
     |SINO;
         |LEE 000#rem05005.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05005#0 = #rem05000#0; |Y #rem05005#1 = nContri;
         nLinea = #rem05005#2 + 1;
     |FINSI;

     |DDEFECTO #rem05005;
     #rem05005#0   = #rem05000#0;
     #rem05005#1   = nContri;
     #rem05005#2   = nLinea;
     #rem05005#3   = aNegro;
     #rem05005#4   = "Pendiente";
     #rem05005#5   = "rem00024"
     #rem05005#6   = 0;
     #rem05005#7   = aCadena1 % 0909;
     #rem05005#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5801;
     |SI aAlfa1 = "1";  #rem05005#9 = "Dineraria";   |FINSI;
     |SI aAlfa1 = "2";  #rem05005#9 = "En especie";  |FINSI;

     aAlfa1 = aCadena1 % 5913;  |HAZ CtrlImporte;  #rem05005#10 = aAlfa1;  #rem05005#10 = #rem05005#10 / 100;
     aAlfa1 = aCadena1 % 7213;  |HAZ CtrlImporte;  #rem05005#11 = aAlfa1;  #rem05005#11 = #rem05005#11 / 100;
     aAlfa1 = aCadena1 % 8513;  |HAZ CtrlImporte;  #rem05005#12 = aAlfa1;  #rem05005#12 = #rem05005#12 / 100;

     |GRABA 020#rem05005.n;
     |LIBERA #rem05005;
     |CIERRA #rem05005;
|FPRC;

|PROCESO ClaveCD;
     nLinea = 1;

     |ABRE #rem05039;
     #rem05039#0 = #rem05000#0;
     #rem05039#1 = nContri;
     #rem05039#2 = 999;
     |LEE 000#rem05039.];
     |SI FSalida = 0;
         |LEE 000#rem05039.a;
     |SINO;
         |LEE 000#rem05039.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05039#0 = #rem05000#0; |Y #rem05039#1 = nContri;
         nLinea = #rem05039#2 + 1;
     |FINSI;

     |DDEFECTO #rem05039;
     #rem05039#0   = #rem05000#0;
     #rem05039#1   = nContri;
     #rem05039#2   = nLinea;
     #rem05039#3   = aNegro;
     #rem05039#4   = "No trasladable";
     #rem05039#5   = "";
     #rem05039#6   = 0;

     aAlfa1 = aCadena1 % 0913;  |HAZ CtrlImporte;  #rem05039#7  = aAlfa1;  #rem05039#7  = #rem05039#7 / 100;

     aAlfa1 = aCadena1 % 2201;
     #rem05039#8   = "INDIVIDUAL";
     |SI aAlfa1 = "C";
         #rem05039#8   = "CONJUNTA";
     |FINSI;

     |GRABA 020#rem05039.n;
     |LIBERA #rem05039;
     |CIERRA #rem05039;
|FPRC;

|PROCESO ClaveCT;
     nLinea = 1;

     |ABRE #rem05006;
     #rem05006#0 = #rem05000#0;
     #rem05006#1 = nContri;
     #rem05006#2 = 999;
     |LEE 000#rem05006.];
     |SI FSalida = 0;
         |LEE 000#rem05006.a;
     |SINO;
         |LEE 000#rem05006.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05006#0 = #rem05000#0; |Y #rem05006#1 = nContri;
         nLinea = #rem05006#2 + 1;
     |FINSI;

     |DDEFECTO #rem05006;
     #rem05006#0   = #rem05000#0;
     #rem05006#1   = nContri;
     #rem05006#2   = nLinea;
     #rem05006#3   = aNegro;
     #rem05006#4   = "No trasladable";
     #rem05006#5   = "";
     #rem05006#6   = 0;
     #rem05006#7   = aCadena1 % 0912;
     aAlfa1 = aCadena1 % 2104;

     |SI aAlfa1 = "0138";   #rem05006#8 = "R‚gimen General de Empleados Hogar   ";  |FINSI;
     |SI aAlfa1 = "0140";   #rem05006#8 = "R‚gimen General (Conv.Esp.)          ";  |FINSI;
     |SI aAlfa1 = "0161";   #rem05006#8 = "R‚gimen General Agrario              ";  |FINSI;
     |SI aAlfa1 = "0521";   #rem05006#8 = "Reg. Esp. Trabajadores Aut¢nomos     ";  |FINSI;
     |SI aAlfa1 = "0540";   #rem05006#8 = "Reg. Esp. Aut¢nomos (Conv.Esp.)      ";  |FINSI;
     |SI aAlfa1 = "0825";   #rem05006#8 = "Reg. Esp. Del Mar (Aut¢nomos)        ";  |FINSI;
     |SI aAlfa1 = "0840";   #rem05006#8 = "Reg. Esp. Del Mar (Conv.Esp.)        ";  |FINSI;
     |SI aAlfa1 = "0940";   #rem05006#8 = "Reg. Esp. Miner¡a Carb¢n (Conv.Esp.) ";  |FINSI;
     |SI aAlfa1 = "1211";   #rem05006#8 = "Reg. Esp. Empleados Hogar (Fijos)    ";  |FINSI;

     aAlfa1 = aCadena1 % 2517;  |HAZ CtrlImporte;  #rem05006#9 = aAlfa1;  #rem05006#9 = #rem05006#9 / 100;

     |GRABA 020#rem05006.n;
     |LIBERA #rem05006;
     |CIERRA #rem05006;
|FPRC;

|PROCESO ClaveUR;
     nLinea = 1;

     |ABRE #rem05007;
     #rem05007#0 = #rem05000#0;
     #rem05007#1 = nContri;
     #rem05007#2 = 999;
     |LEE 000#rem05007.];
     |SI FSalida = 0;
         |LEE 000#rem05007.a;
     |SINO;
         |LEE 000#rem05007.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05007#0 = #rem05000#0; |Y #rem05007#1 = nContri;
         nLinea = #rem05007#2 + 1;
     |FINSI;

     |DDEFECTO #rem05007;
     #rem05007#0   = #rem05000#0;
     #rem05007#1   = nContri;
     #rem05007#2   = nLinea;
     #rem05007#3   = aNegro;
     #rem05007#4   = "Pendiente";
     #rem05007#5   = "rem00021"
     #rem05007#6   = 0;
     #rem05007#7   = aCadena1 % 0920;
     aAlfa1 = aCadena1 % 2902;  |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena1 % 3125);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena1 % 5604);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena1 % 6002);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena1 % 6203);   |QBF aAlfa1;
     aAlfa1 = aAlfa1 + " " + (aCadena1 % 6503);   |QBF aAlfa1;
     #rem05007#8   = aAlfa1;
     #rem05007#9   = aCadena1 % 6805;
     #rem05007#10  = aCadena1 % 7414;

     #rem05007#11  = aCadena1 % 8802;
     |SI #rem05007#11 = "UR";  #rem05007#12 = "Urbana";   |FINSI;
     |SI #rem05007#11 = "RU";  #rem05007#12 = "R£stica";  |FINSI;

     #rem05007#13  = aCadena1 % 9001;
                              #rem05007#14 = "Sin definir                                       ";
     |SI #rem05007#13 = "A";  #rem05007#14 = "Almac‚n y aparcamiento                            ";  |FINSI;
     |SI #rem05007#13 = "V";  #rem05007#14 = "Residencial                                       ";  |FINSI;
     |SI #rem05007#13 = "I";  #rem05007#14 = "Industrial                                        ";  |FINSI;
     |SI #rem05007#13 = "O";  #rem05007#14 = "Oficinas                                          ";  |FINSI;
     |SI #rem05007#13 = "C";  #rem05007#14 = "Comercial                                         ";  |FINSI;
     |SI #rem05007#13 = "M";  #rem05007#14 = "Solares                                           ";  |FINSI;
     |SI #rem05007#13 = "K";  #rem05007#14 = "Deportivo                                         ";  |FINSI;
     |SI #rem05007#13 = "T";  #rem05007#14 = "Espect culos                                      ";  |FINSI;
     |SI #rem05007#13 = "G";  #rem05007#14 = "Ocio y Hosteler¡a                                 ";  |FINSI;
     |SI #rem05007#13 = "Y";  #rem05007#14 = "Sanidad y Beneficiencia                           ";  |FINSI;
     |SI #rem05007#13 = "E";  #rem05007#14 = "Cultural                                          ";  |FINSI;
     |SI #rem05007#13 = "R";  #rem05007#14 = "Religioso                                         ";  |FINSI;
     |SI #rem05007#13 = "M";  #rem05007#14 = "Obras de urbanizaci¢n, suelos sin edificar        ";  |FINSI;
     |SI #rem05007#13 = "P";  #rem05007#14 = "Edificio singular                                 ";  |FINSI;
     |SI #rem05007#13 = "B";  #rem05007#14 = "Almac‚n agrario                                   ";  |FINSI;
     |SI #rem05007#13 = "J";  #rem05007#14 = "Industrial agrario                                ";  |FINSI;
     |SI #rem05007#13 = "Z";  #rem05007#14 = "Agrario                                           ";  |FINSI;

     #rem05007#15  = aCadena1 % 9101;
     |SI #rem05007#15 = "1";  #rem05007#16 = "Residencial garaje";    |FINSI;
     |SI #rem05007#15 = "2";  #rem05007#16 = "Industrial";            |FINSI;
     |SI #rem05007#15 = "3";  #rem05007#16 = "Residencial trastero";  |FINSI;

     aAlfa1 = aCadena1 % 9213;   |HAZ CtrlImporte;  #rem05007#17 = aAlfa1;  #rem05007#17 = #rem05007#17 / 100;
     aAlfa1 = aCadena1 % 10513;  |HAZ CtrlImporte;  #rem05007#27 = aAlfa1;  #rem05007#27 = #rem05007#27 / 100;

     #rem05007#18  = aCadena1 % 11801;

     #rem05007#19 = aCadena1 % 11902;
     |SI #rem05007#19 = "PR";  #rem05007#20 = "Propietario";               |FINSI;
     |SI #rem05007#19 = "US";  #rem05007#20 = "Usufructuario";             |FINSI;
     |SI #rem05007#19 = "CA";  #rem05007#20 = "Concesi¢n administrativa";  |FINSI;
     |SI #rem05007#19 = "DS";  #rem05007#20 = "Derecho de superficie   ";  |FINSI;
     |SI #rem05007#19 = "NP";  #rem05007#20 = "Nuda propiedad          ";  |FINSI;
     |SI #rem05007#19 = "DF";  #rem05007#20 = "Disfrutador             ";  |FINSI;

     aAlfa1 = aCadena1 % 12105;   |HAZ CtrlImporte;  #rem05007#21 = aAlfa1;  #rem05007#21 = #rem05007#21 / 100;
     aAlfa1 = aCadena1 % 12603;   #rem05007#22 = aAlfa1;

     #rem05007#23 = aCadena1 % 12901;
     |SI #rem05007#23 = "H";  #rem05007#24 = "Vivienda habitual";      |FINSI;
     |SI #rem05007#23 = "A";  #rem05007#24 = "Arrendada";              |FINSI;
     |SI #rem05007#23 = "C";  #rem05007#24 = "Habitual y arrendada";   |FINSI;
     |SI #rem05007#23 = "O";  #rem05007#24 = "";                       |FINSI;

     #rem05007#25 = aCadena1 % 13001;
     |SI #rem05007#25 = "1";  #rem05007#26 = "Inmuebles en territorio com£n";  |FINSI;
     |SI #rem05007#25 = "2";  #rem05007#26 = "Inmuebles en territorio foral";  |FINSI;

     |GRABA 020#rem05007.n;
     |LIBERA #rem05007;
     |CIERRA #rem05007;
|FPRC;

|PROCESO ClavePF;
     nLinea = 1;

     |ABRE #rem05009;
     #rem05009#0 = #rem05000#0;
     #rem05009#1 = nContri;
     #rem05009#2 = 999;
     |LEE 000#rem05009.];
     |SI FSalida = 0;
         |LEE 000#rem05009.a;
     |SINO;
         |LEE 000#rem05009.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05009#0 = #rem05000#0; |Y #rem05009#1 = nContri;
         nLinea = #rem05009#2 + 1;
     |FINSI;

     |DDEFECTO #rem05009;
     #rem05009#0   = #rem05000#0;
     #rem05009#1   = nContri;
     #rem05009#2   = nLinea;
     #rem05009#3   = aNegro;
     #rem05009#4   = "Pendiente";
     #rem05009#5   = "rem00031";
     #rem05009#6   = 0;
     #rem05009#7   = aCadena1 % 0903;

     aAlfa1 = aCadena1 % 1201;
     |SI aAlfa1 = "I";  #rem05009#8 = "Ingreso";                      |FINSI;
     |SI aAlfa1 = "N";  #rem05009#8 = "Negativa";                     |FINSI;
     |SI aAlfa1 = "C";  #rem05009#8 = "Compensaci¢n";                 |FINSI;
     |SI aAlfa1 = "D";  #rem05009#8 = "Devoluci¢n";                   |FINSI;
     |SI aAlfa1 = "F";  #rem05009#8 = "Formalizaci¢n";                |FINSI;
     |SI aAlfa1 = "A";  #rem05009#8 = "Aplazamiento";                 |FINSI;
     |SI aAlfa1 = "M";  #rem05009#8 = "Imposibilidad de pago";        |FINSI;
     |SI aAlfa1 = "S";  #rem05009#8 = "Solicitud de compensaci¢n";    |FINSI;
     |SI aAlfa1 = "E";  #rem05009#8 = "Devoluci¢n ingreso excesivo";  |FINSI;
     |SI aAlfa1 = "G";  #rem05009#8 = "Ingreso CCT";                  |FINSI;
     |SI aAlfa1 = "V";  #rem05009#8 = "Devoluci¢n CCT";               |FINSI;

     #rem05009#9   = aCadena1 % 1302;
     #rem05009#10  = aCadena1 % 1502;
     #rem05009#11  = aCadena1 % 1713;

     aAlfa1 = aCadena1 % 3013;  |HAZ CtrlImporte;  #rem05009#12 = aAlfa1;  #rem05009#12 = #rem05009#12 / 100;

     |SI #rem05009#12 = 0;
         #rem05009#4 = "No trasladable";
     |FINSI;

     |GRABA 020#rem05009.n;
     |LIBERA #rem05009;
     |CIERRA #rem05009;
|FPRC;

|PROCESO ClaveDN;
     nLinea = 1;

     |ABRE #rem05010;
     #rem05010#0 = #rem05000#0;
     #rem05010#1 = nContri;
     #rem05010#2 = 999;
     |LEE 000#rem05010.];
     |SI FSalida = 0;
         |LEE 000#rem05010.a;
     |SINO;
         |LEE 000#rem05010.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05010#0 = #rem05000#0; |Y #rem05010#1 = nContri;
         nLinea = #rem05010#2 + 1;
     |FINSI;

     |DDEFECTO #rem05010;
     #rem05010#0   = #rem05000#0;
     #rem05010#1   = nContri;
     #rem05010#2   = nLinea;
     #rem05010#3   = aNegro;
     #rem05010#4   = "Pendiente";
     #rem05010#5   = "rem00046";
     #rem05010#6   = 0;
     #rem05010#7   = aCadena1 % 0909;
     #rem05010#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5801;
     |SI aAlfa1 = " ";  #rem05010#9  = "Dinerarias";   |FINSI;
     |SI aAlfa1 = "X";  #rem05010#9  = "En especie";   |FINSI;

     #rem05010#16 = aCadena1 % 5901;
     #rem05010#17 = aCadena1 % 8501;

     |SI #rem05010#16 = " ";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "A";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "B";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "G";  #rem05010#10 = "Donativos";     |FINSI;
     |SI #rem05010#16 = "C";  #rem05010#10 = "Aportaciones";  |FINSI;
     |SI #rem05010#16 = "F";  #rem05010#10 = "Cuota";         |FINSI;

     aAlfa1 = aCadena1 % 6005;  |HAZ CtrlImporte;  #rem05010#11 = aAlfa1;  #rem05010#11 = #rem05010#11 / 100;

     #rem05010#12 = aCadena1 % 6502;

     aAlfa1 = aCadena1 % 6713;  |HAZ CtrlImporte;  #rem05010#13 = aAlfa1;  #rem05010#13 = #rem05010#13 / 100;
     aAlfa1 = aCadena1 % 8005;  |HAZ CtrlImporte;  #rem05010#15 = aAlfa1;  #rem05010#15 = #rem05010#15 / 100;

     |GRABA 020#rem05010.n;
     |LIBERA #rem05010;
     |CIERRA #rem05010;
|FPRC;

|PROCESO ClaveAR;
     nLinea = 1;

     |ABRE #rem05011;
     #rem05011#0 = #rem05000#0;
     #rem05011#1 = nContri;
     #rem05011#2 = 999;
     |LEE 000#rem05011.];
     |SI FSalida = 0;
         |LEE 000#rem05011.a;
     |SINO;
         |LEE 000#rem05011.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05011#0 = #rem05000#0; |Y #rem05011#1 = nContri;
         nLinea = #rem05011#2 + 1;
     |FINSI;

     |DDEFECTO #rem05011;
     #rem05011#0   = #rem05000#0;
     #rem05011#1   = nContri;
     #rem05011#2   = nLinea;
     #rem05011#3   = aNegro;
     #rem05011#4   = "No trasladable";
     #rem05011#5   = "";
     #rem05011#6   = 0;
     #rem05011#7   = aCadena1 % 0909;
     #rem05011#8   = aCadena1 % 1840;
     #rem05011#12  = aCadena1 % 5820;

     aAlfa1  = aCadena1 % 7801;
     |SI aAlfa1 = "1";  #rem05011#9 = "Dinerarias";  |FINSI;
     |SI aAlfa1 = "2";  #rem05011#9 = "En especie"; |FINSI;

     aAlfa1 = aCadena1 % 7913;   |HAZ CtrlImporte;  #rem05011#10 = aAlfa1;  #rem05011#10 = #rem05011#10 / 100;
     aAlfa1 = aCadena1 % 9213;   |HAZ CtrlImporte;  #rem05011#11 = aAlfa1;  #rem05011#11 = #rem05011#11 / 100;

     |GRABA 020#rem05011.n;
     |LIBERA #rem05011;
     |CIERRA #rem05011;
|FPRC;

|PROCESO ClavePHD;
     nLinea = 1;

     |ABRE #rem05012;
     #rem05012#0 = #rem05000#0;
     #rem05012#1 = nContri;
     #rem05012#2 = 999;
     |LEE 000#rem05012.];
     |SI FSalida = 0;
         |LEE 000#rem05012.a;
     |SINO;
         |LEE 000#rem05012.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05012#0 = #rem05000#0; |Y #rem05012#1 = nContri;
         nLinea = #rem05012#2 + 1;
     |FINSI;

     |DDEFECTO #rem05012;
     #rem05012#0   = #rem05000#0;
     #rem05012#1   = nContri;
     #rem05012#2   = nLinea;
     #rem05012#3   = aNegro;
     #rem05012#4   = "No trasladable";
     #rem05012#5   = "";
     #rem05012#6   = 0;
     #rem05012#7   = aCadena1 % 0909;
     #rem05012#8   = aCadena1 % 1840;
     #rem05012#13  = aCadena1 % 5820;

     aAlfa1 = aCadena1 % 7805;  |HAZ CtrlImporte;  #rem05012#09 = aAlfa1;  #rem05012#09 = #rem05012#09 / 100;
     aAlfa1 = aCadena1 % 8813;  |HAZ CtrlImporte;  #rem05012#10 = aAlfa1;  #rem05012#10 = #rem05012#10 / 100;
     aAlfa1 = aCadena1 % 10113; |HAZ CtrlImporte;  #rem05012#11 = aAlfa1;  #rem05012#11 = #rem05012#11 / 100;
     aAlfa1 = aCadena1 % 11413; |HAZ CtrlImporte;  #rem05012#12 = aAlfa1;  #rem05012#12 = #rem05012#12 / 100;

     |GRABA 020#rem05012.n;
     |LIBERA #rem05012;
     |CIERRA #rem05012;
|FPRC;

|PROCESO ClaveDM;
     nLinea = 1;

     |ABRE #rem05013;
     #rem05013#0 = #rem05000#0;
     #rem05013#1 = nContri;
     #rem05013#2 = 999;
     |LEE 000#rem05013.];
     |SI FSalida = 0;
         |LEE 000#rem05013.a;
     |SINO;
         |LEE 000#rem05013.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05013#0 = #rem05000#0; |Y #rem05013#1 = nContri;
         nLinea = #rem05013#2 + 1;
     |FINSI;

     |DDEFECTO #rem05013;
     #rem05013#0   = #rem05000#0;
     #rem05013#1   = nContri;
     #rem05013#2   = nLinea;
     #rem05013#3   = aNegro;
     #rem05013#4   = "Pendiente";
     #rem05013#5   = "rem00065";
     #rem05013#6   = 0;
     #rem05013#7   = "12";

     aAlfa1 = aCadena1 % 0909;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 2609;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 4309;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 6009;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 7709;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 9409;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 11109; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 12809; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 14509; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 16209; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 17909; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 19609; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#8 = #rem05013#8 + (nNume / 100);

     aAlfa1 = aCadena1 % 1808;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 3508;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 5208;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 6908;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 8608;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 10308; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 12008; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 13708; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 15408; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 17108; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 18808; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 20508; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 21308; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05013#9 = #rem05013#9 - (nNume / 100);

     |SI #rem05013#9 = 0;
         #rem05013#4   = "No trasladable";
     |FINSI;

     |GRABA 020#rem05013.n;
     |LIBERA #rem05013;
     |CIERRA #rem05013;
|FPRC;

|PROCESO ClavePP;
     nLinea = 1;

     |ABRE #rem05014;
     #rem05014#0 = #rem05000#0;
     #rem05014#1 = nContri;
     #rem05014#2 = 999;
     |LEE 000#rem05014.];
     |SI FSalida = 0;
         |LEE 000#rem05014.a;
     |SINO;
         |LEE 000#rem05014.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05014#0 = #rem05000#0; |Y #rem05014#1 = nContri;
         nLinea = #rem05014#2 + 1;
     |FINSI;

     |DDEFECTO #rem05014;
     #rem05014#0   = #rem05000#0;
     #rem05014#1   = nContri;
     #rem05014#2   = nLinea;
     #rem05014#3   = aNegro;
     #rem05014#4   = "Pendiente";
     #rem05014#5   = "rem00053";
     #rem05014#6   = 0;
     #rem05014#7   = aCadena1 % 0909;
     #rem05014#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5801;
     |SI aAlfa1 = "A";  #rem05014#9 = "Aportaciones personales a Fondo de Pensiones      ";  |FINSI;
     |SI aAlfa1 = "C";  #rem05014#9 = "Contribuciones deducibles del promotor            ";  |FINSI;
     |SI aAlfa1 = "E";  #rem05014#9 = "Mutualidades. Cantidades abonadas prof. o empres. ";  |FINSI;
     |SI aAlfa1 = "F";  #rem05014#9 = "Mutualidades. Cantidades abonadas trabajadores    ";  |FINSI;
     |SI aAlfa1 = "G";  #rem05014#9 = "Mutualidades. Cantidades abonadas promotor        ";  |FINSI;
     |SI aAlfa1 = "H";  #rem05014#9 = "Primas satisfechas a Planes de Previsi¢n Asegurado";  |FINSI;
     |SI aAlfa1 = "J";  #rem05014#9 = "Primas a planes de previsi¢n social empresarial   ";  |FINSI;
     |SI aAlfa1 = "K";  #rem05014#9 = "Primas a seguros de dependencia                   ";  |FINSI;
     |SI aAlfa1 = "L";  #rem05014#9 = "Primas a seguros colectivo de dependencia         ";  |FINSI;

     aAlfa1 = aCadena1 % 5803;
     |SI aAlfa1 = "C01";  #rem05014#10 = "Contribuciones de los promotores                 ";  |FINSI;
     |SI aAlfa1 = "J08";  #rem05014#10 = "Aportaciones satisfechas por los asegurados      ";  |FINSI;
     |SI aAlfa1 = "J09";  #rem05014#10 = "Contribuciones satisfechas por los tomadores     ";  |FINSI;

     aAlfa1 = aCadena1 % 6113;  |HAZ CtrlImporte;  #rem05014#11 = aAlfa1;  #rem05014#11 = #rem05014#11 / 100;
     aAlfa1 = aCadena1 % 7413;  |HAZ CtrlImporte;  #rem05014#12 = aAlfa1;  #rem05014#12 = #rem05014#12 / 100;

     #rem05014#13  = aCadena1 % 8709;

     |GRABA 020#rem05014.n;
     |LIBERA #rem05014;
     |CIERRA #rem05014;
|FPRC;

|PROCESO ClaveIP;
     nLinea = 1;

     |ABRE #rem05015;
     #rem05015#0 = #rem05000#0;
     #rem05015#1 = nContri;
     #rem05015#2 = 999;
     |LEE 000#rem05015.];
     |SI FSalida = 0;
         |LEE 000#rem05015.a;
     |SINO;
         |LEE 000#rem05015.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05015#0 = #rem05000#0; |Y #rem05015#1 = nContri;
         nLinea = #rem05015#2 + 1;
     |FINSI;

     |DDEFECTO #rem05015;
     #rem05015#0   = #rem05000#0;
     #rem05015#1   = nContri;
     #rem05015#2   = nLinea;
     #rem05015#3   = aNegro;
     #rem05015#4   = "No trasladable";
     #rem05015#5   = "";
     #rem05015#6   = 0;
     #rem05015#7   = aCadena1 % 0909;
     #rem05015#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5813;   |HAZ CtrlImporte;  #rem05015#9  = aAlfa1;  #rem05015#9  = #rem05015#9  / 100;

     |GRABA 020#rem05015.n;
     |LIBERA #rem05015;
     |CIERRA #rem05015;
|FPRC;

|PROCESO ClaveAG;
     nLinea = 1;

     |ABRE #rem05016;
     #rem05016#0 = #rem05000#0;
     #rem05016#1 = nContri;
     #rem05016#2 = 999;
     |LEE 000#rem05016.];
     |SI FSalida = 0;
         |LEE 000#rem05016.a;
     |SINO;
         |LEE 000#rem05016.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05016#0 = #rem05000#0; |Y #rem05016#1 = nContri;
         nLinea = #rem05016#2 + 1;
     |FINSI;

     |DDEFECTO #rem05016;
     #rem05016#0   = #rem05000#0;
     #rem05016#1   = nContri;
     #rem05016#2   = nLinea;
     #rem05016#3   = aNegro;
     #rem05016#4   = "No trasladable";
     #rem05016#5   = "";
     #rem05016#6   = 0;
     #rem05016#7   = aCadena1 % 0909;
     #rem05016#8   = aCadena1 % 1840;
     #rem05016#10  = aCadena1 % 6049;

     aAlfa1 = aCadena1 % 5801;
     |SI aAlfa1 = "1";  #rem05016#9 = "Subvenciones corrientes";  |FINSI;
     |SI aAlfa1 = "2";  #rem05016#9 = "Subvenciones capital";     |FINSI;
     |SI aAlfa1 = "3";  #rem05016#9 = "Indemnizaciones al circulante";    |FINSI;
     |SI aAlfa1 = "4";  #rem05016#9 = "Indemnizaciones al inmovilizado";  |FINSI;
     |SI aAlfa1 = "5";  #rem05016#9 = "Indemnizaciones por cese";  |FINSI;
     |SI aAlfa1 = "6";  #rem05016#9 = "Otras";  |FINSI;

     aAlfa1 = aCadena1 % 10915;   |HAZ CtrlImporte;  #rem05016#11 = aAlfa1;  #rem05016#11 = #rem05016#11 / 100;

     |GRABA 020#rem05016.n;
     |LIBERA #rem05016;
     |CIERRA #rem05016;
|FPRC;

|PROCESO ClaveFIE;
     nLinea = 1;

     |ABRE #rem05017;
     #rem05017#0 = #rem05000#0;
     #rem05017#1 = nContri;
     #rem05017#2 = 999;
     |LEE 000#rem05017.];
     |SI FSalida = 0;
         |LEE 000#rem05017.a;
     |SINO;
         |LEE 000#rem05017.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05017#0 = #rem05000#0; |Y #rem05017#1 = nContri;
         nLinea = #rem05017#2 + 1;
     |FINSI;

     |DDEFECTO #rem05017;
     #rem05017#0   = #rem05000#0;
     #rem05017#1   = nContri;
     #rem05017#2   = nLinea;
     #rem05017#3   = aNegro;
     #rem05017#4   = "No trasladable";
     #rem05017#5   = "";
     #rem05017#6   = 0;
     #rem05017#7   = aCadena1 % 0909;
     #rem05017#8   = aCadena1 % 1840;
     #rem05017#9   = aCadena1 % 5809;
     #rem05017#10  = aCadena1 % 6740;
     #rem05017#11  = (aCadena1 % 11302) + "." + (aCadena1 % 11102) + "." + (aCadena1 % 10704);

     aAlfa1 = aCadena1 % 12415;  |HAZ CtrlImporte;  #rem05017#12 = aAlfa1;  #rem05017#12 = #rem05017#12 / 100;
     aAlfa1 = aCadena1 % 13915;  |HAZ CtrlImporte;  #rem05017#13 = aAlfa1;  #rem05017#13 = #rem05017#13 / 100;
     aAlfa1 = aCadena1 % 15413;  |HAZ CtrlImporte;  #rem05017#14 = aAlfa1;  #rem05017#14 = #rem05017#14 / 100;

     |GRABA 020#rem05017.n;
     |LIBERA #rem05017;
     |CIERRA #rem05017;
|FPRC;

|PROCESO ClaveFIC;
     nLinea = 1;

     |ABRE #rem05017;
     #rem05017#0 = #rem05000#0;
     #rem05017#1 = nContri;
     #rem05017#2 = 999;
     |LEE 000#rem05017.];
     |SI FSalida = 0;
         |LEE 000#rem05017.a;
     |SINO;
         |LEE 000#rem05017.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05017#0 = #rem05000#0; |Y #rem05017#1 = nContri;
         nLinea = #rem05017#2 + 1;
     |FINSI;

     |DDEFECTO #rem05017;
     #rem05017#0   = #rem05000#0;
     #rem05017#1   = nContri;
     #rem05017#2   = nLinea;
     #rem05017#3   = aNegro;
     #rem05017#4   = "No trasladable";
     #rem05017#5   = "";
     #rem05017#6   = 0;
     #rem05017#7   = aCadena1 % 0909;
     #rem05017#8   = aCadena1 % 1840;
     #rem05017#9   = aCadena1 % 5809;
     #rem05017#10  = aCadena1 % 6740;
     #rem05017#11  = (aCadena1 % 11302) + "." + (aCadena1 % 11102) + "." + (aCadena1 % 10704);

     aAlfa1 = aCadena1 % 14115;  |HAZ CtrlImporte;  #rem05017#12 = aAlfa1;  #rem05017#12 = #rem05017#12 / 100;
     aAlfa1 = aCadena1 % 15615;  |HAZ CtrlImporte;  #rem05017#13 = aAlfa1;  #rem05017#13 = #rem05017#13 / 100;

     #rem05017#14  = 0;

     |GRABA 020#rem05017.n;
     |LIBERA #rem05017;
     |CIERRA #rem05017;
|FPRC;

|PROCESO ClaveSC;
     nLinea = 1;

     |ABRE #rem05018;
     #rem05018#0 = #rem05000#0;
     #rem05018#1 = nContri;
     #rem05018#2 = 999;
     |LEE 000#rem05018.];
     |SI FSalida = 0;
         |LEE 000#rem05018.a;
     |SINO;
         |LEE 000#rem05018.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05018#0 = #rem05000#0; |Y #rem05018#1 = nContri;
         nLinea = #rem05018#2 + 1;
     |FINSI;

     |DDEFECTO #rem05018;
     #rem05018#0   = #rem05000#0;
     #rem05018#1   = nContri;
     #rem05018#2   = nLinea;
     #rem05018#3   = aNegro;
     #rem05018#4   = "No trasladable";
     #rem05018#5   = "";
     #rem05018#6   = 0;
     #rem05018#7   = aCadena1 % 0909;
     #rem05018#8   = aCadena1 % 1850;

     aAlfa1 = aCadena1 % 6805;  |HAZ CtrlImporte;  #rem05018#09 = aAlfa1;  #rem05018#09 = #rem05018#09 / 100;

     |GRABA 020#rem05018.n;
     |LIBERA #rem05018;
     |CIERRA #rem05018;
|FPRC;

|PROCESO ClaveCU;
     nLinea = 1;

     |ABRE #rem05019;
     #rem05019#0 = #rem05000#0;
     #rem05019#1 = nContri;
     #rem05019#2 = 999;
     |LEE 000#rem05019.];
     |SI FSalida = 0;
         |LEE 000#rem05019.a;
     |SINO;
         |LEE 000#rem05019.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05019#0 = #rem05000#0; |Y #rem05019#1 = nContri;
         nLinea = #rem05019#2 + 1;
     |FINSI;

     |DDEFECTO #rem05019;
     #rem05019#0   = #rem05000#0;
     #rem05019#1   = nContri;
     #rem05019#2   = nLinea;
     #rem05019#3   = aNegro;
     #rem05019#4   = "Pendiente";
     #rem05019#5   = "rem00056";
     #rem05019#6   = 0;
     aAlfa1 = aCadena1 % 0908;  |HAZ CtrlImporte;  #rem05019#7 = aAlfa1;  #rem05019#7 = #rem05019#7 / 100;

     |SI #rem05019#7 = 0;
         #rem05019#4   = "No trasladable";
     |FINSI;

     |GRABA 020#rem05019.n;
     |LIBERA #rem05019;
     |CIERRA #rem05019;
|FPRC;

|PROCESO ClaveNO;
     nLinea = 1;

     |ABRE #rem05020;
     #rem05020#0 = #rem05000#0;
     #rem05020#1 = nContri;
     #rem05020#2 = 999;
     |LEE 000#rem05020.];
     |SI FSalida = 0;
         |LEE 000#rem05020.a;
     |SINO;
         |LEE 000#rem05020.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05020#0 = #rem05000#0; |Y #rem05020#1 = nContri;
         nLinea = #rem05020#2 + 1;
     |FINSI;

     |DDEFECTO #rem05020;
     #rem05020#0   = #rem05000#0;
     #rem05020#1   = nContri;
     #rem05020#2   = nLinea;
     #rem05020#3   = aNegro;
     #rem05020#4   = "No trasladable";
     #rem05020#5   = "";
     #rem05020#6   = 0;
     aAlfa1  = (aCadena1 % 1502) + "." + (aCadena1 % 1302) + "." + (aCadena1 % 904);
     #rem05020#7   = aAlfa1;
     #rem05020#8   = aCadena1 % 1720;
     #rem05020#9   = aCadena1 % 3702;
     #rem05020#10  = aCadena1 % 3925;
     #rem05020#11  = aCadena1 % 6404;
     #rem05020#12  = aCadena1 % 6802;
     #rem05020#13  = aCadena1 % 7002;
     #rem05020#14  = aCadena1 % 7201;
     #rem05020#15  = aCadena1 % 7303;
     #rem05020#16  = aCadena1 % 7605;
     #rem05020#17  = aCadena1 % 8224;
     #rem05020#18  = aCadena1 % 10602;

     |SI #rem05020#18 = "PR";  #rem05020#19 = "Propietario";               |FINSI;
     |SI #rem05020#18 = "US";  #rem05020#19 = "Usufructuario";             |FINSI;
     |SI #rem05020#18 = "CA";  #rem05020#19 = "Concesi¢n administrativa";  |FINSI;
     |SI #rem05020#18 = "DS";  #rem05020#19 = "Derecho de superficie   ";  |FINSI;
     |SI #rem05020#18 = "NP";  #rem05020#19 = "Nuda propiedad          ";  |FINSI;
     |SI #rem05020#18 = "DF";  #rem05020#19 = "Disfrutador             ";  |FINSI;

     #rem05020#20  = aCadena1 % 10809;
     #rem05020#21  = aCadena1 % 11710;
     #rem05020#22  = aCadena1 % 12705;

     |GRABA 020#rem05020.n;
     |LIBERA #rem05020;
     |CIERRA #rem05020;
|FPRC;

|PROCESO ClaveLT;
     nLinea = 1;

     |ABRE #rem05021;
     #rem05021#0 = #rem05000#0;
     #rem05021#1 = nContri;
     #rem05021#2 = 999;
     |LEE 000#rem05021.];
     |SI FSalida = 0;
         |LEE 000#rem05021.a;
     |SINO;
         |LEE 000#rem05021.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05021#0 = #rem05000#0; |Y #rem05021#1 = nContri;
         nLinea = #rem05021#2 + 1;
     |FINSI;

     |DDEFECTO #rem05021;
     #rem05021#0   = #rem05000#0;
     #rem05021#1   = nContri;
     #rem05021#2   = nLinea;
     #rem05021#3   = aNegro;
     #rem05021#4   = "Pendiente";
     #rem05021#5   = "rem00052"
     #rem05021#6   = 0;
     #rem05021#7   = aCadena1 % 0909;
     #rem05021#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5815;  |HAZ CtrlImporte;  #rem05021#09 = aAlfa1;  #rem05021#09 = #rem05021#09 / 100;
     aAlfa1 = (aCadena1 % 7902) + "." + (aCadena1 % 7702) + "." + (aCadena1 % 7304);
     #rem05021#10  = aAlfa1;

     aAlfa1 = aCadena1 % 8115;  |HAZ CtrlImporte;  #rem05021#11 = aAlfa1;  #rem05021#11 = #rem05021#11 / 100;
     aAlfa1 = (aCadena1 % 10202) + "." + (aCadena1 % 10002) + "." + (aCadena1 % 9604);
     #rem05021#12  = aAlfa1;

     aAlfa1 = aCadena1 % 10403;  #rem05021#13 = aAlfa1;
     aAlfa1 = aCadena1 % 10715;  |HAZ CtrlImporte;  #rem05021#14 = aAlfa1;  #rem05021#14 = #rem05021#14 / 100;

     |GRABA 020#rem05021.n;
     |LIBERA #rem05021;
     |CIERRA #rem05021;
|FPRC;

|PROCESO ClaveCC;
     nLinea = 1;

     |ABRE #rem05022;
     #rem05022#0 = #rem05000#0;
     #rem05022#1 = nContri;
     #rem05022#2 = 999;
     |LEE 000#rem05022.];
     |SI FSalida = 0;
         |LEE 000#rem05022.a;
     |SINO;
         |LEE 000#rem05022.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05022#0 = #rem05000#0; |Y #rem05022#1 = nContri;
         nLinea = #rem05022#2 + 1;
     |FINSI;

     |DDEFECTO #rem05022;
     #rem05022#0   = #rem05000#0;
     #rem05022#1   = nContri;
     #rem05022#2   = nLinea;
     #rem05022#3   = aNegro;
     #rem05022#4   = "No trasladable";
     #rem05022#5   = "";
     #rem05022#6   = 0;
     #rem05022#7   = aCadena1 % 909;
     #rem05022#8   = aCadena1 % 1850;
     #rem05022#9   = aCadena1 % 6803;
     aAlfa1 = aCadena1 % 7110;  |HAZ CtrlImporte;  #rem05022#10 = aAlfa1;  #rem05022#10 = #rem05022#10 / 100;
     aAlfa1 = aCadena1 % 8109;  |HAZ CtrlImporte;  #rem05022#11 = aAlfa1;  #rem05022#11 = #rem05022#11 / 100;

     |GRABA 020#rem05022.n;
     |LIBERA #rem05022;
     |CIERRA #rem05022;
|FPRC;

|PROCESO ClaveEV;
     nLinea = 1;

     |ABRE #rem05023;
     #rem05023#0 = #rem05000#0;
     #rem05023#1 = nContri;
     #rem05023#2 = 999;
     |LEE 000#rem05023.];
     |SI FSalida = 0;
         |LEE 000#rem05023.a;
     |SINO;
         |LEE 000#rem05023.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05023#0 = #rem05000#0; |Y #rem05023#1 = nContri;
         nLinea = #rem05023#2 + 1;
     |FINSI;

     |DDEFECTO #rem05023;
     #rem05023#0   = #rem05000#0;
     #rem05023#1   = nContri;
     #rem05023#2   = nLinea;
     #rem05023#3   = aNegro;
     #rem05023#4   = "Pendiente";
     #rem05023#5   = "rem00030"
     #rem05023#6   = 0;
     #rem05023#7   = aCadena1 % 0909;
     #rem05023#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5810;  |HAZ CtrlImporte;  #rem05023#09 = aAlfa1;  #rem05023#09 = #rem05023#09 / 100;

     |GRABA 020#rem05023.n;
     |LIBERA #rem05023;
     |CIERRA #rem05023;
|FPRC;

|PROCESO ClaveEA;
     nLinea = 1;

     |ABRE #rem05025;
     #rem05025#0 = #rem05000#0;
     #rem05025#1 = nContri;
     #rem05025#2 = 999;
     |LEE 000#rem05025.];
     |SI FSalida = 0;
         |LEE 000#rem05025.a;
     |SINO;
         |LEE 000#rem05025.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05025#0 = #rem05000#0; |Y #rem05025#1 = nContri;
         nLinea = #rem05025#2 + 1;
     |FINSI;

     |DDEFECTO #rem05025;
     #rem05025#0   = #rem05000#0;
     #rem05025#1   = nContri;
     #rem05025#2   = nLinea;
     #rem05025#3   = aNegro;
     #rem05025#4   = "Pendiente";
     #rem05025#5   = "rem00058"
     #rem05025#6   = 0;
     #rem05025#7   = aCadena1 % 0909;
     #rem05025#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5807;  |HAZ CtrlImporte;  #rem05025#14 = aAlfa1;  #rem05025#14 = #rem05025#14 / 10000;

     #rem05025#9   = aCadena1 % 6502;

     |SI #rem05025#9 = "01";
         aAlfa1 = aCadena1 % 6713;  |HAZ CtrlImporte;  #rem05025#12 = aAlfa1;  #rem05025#12 = #rem05025#12 / 100;
     |SINO;
         aAlfa1 = aCadena1 % 6713;  |HAZ CtrlImporte;  #rem05025#10 = aAlfa1;  #rem05025#10 = #rem05025#10 / 100;
         aAlfa1 = aCadena1 % 8011;  |HAZ CtrlImporte;  #rem05025#11 = aAlfa1;  #rem05025#11 = #rem05025#11 / 100;
     |FINSI;

     |GRABA 020#rem05025.n;
     |LIBERA #rem05025;
     |CIERRA #rem05025;
|FPRC;

|PROCESO ClaveEB;
     nLinea = 1;

     |ABRE #rem05026;
     #rem05026#0 = #rem05000#0;
     #rem05026#1 = nContri;
     #rem05026#2 = 999;
     |LEE 000#rem05026.];
     |SI FSalida = 0;
         |LEE 000#rem05026.a;
     |SINO;
         |LEE 000#rem05026.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05026#0 = #rem05000#0; |Y #rem05026#1 = nContri;
         nLinea = #rem05026#2 + 1;
     |FINSI;

     |DDEFECTO #rem05026;
     #rem05026#0   = #rem05000#0;
     #rem05026#1   = nContri;
     #rem05026#2   = nLinea;
     #rem05026#3   = aNegro;
     #rem05026#4   = "Pendiente";
     #rem05026#5   = "rem00058"
     #rem05026#6   = 0;
     #rem05026#7   = aCadena1 % 0909;
     #rem05026#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5807;  |HAZ CtrlImporte;  #rem05026#12 = aAlfa1;  #rem05026#12 = #rem05026#12 / 10000;
     aAlfa1 = aCadena1 % 6513;  |HAZ CtrlImporte;  #rem05026#9  = aAlfa1;  #rem05026#9  = #rem05026#9  / 100;
     aAlfa1 = aCadena1 % 7811;  |HAZ CtrlImporte;  #rem05026#10 = aAlfa1;  #rem05026#10 = #rem05026#10 / 100;

     |GRABA 020#rem05026.n;
     |LIBERA #rem05026;
     |CIERRA #rem05026;
|FPRC;

|PROCESO ClaveEC;
     nLinea = 1;

     |ABRE #rem05027;
     #rem05027#0 = #rem05000#0;
     #rem05027#1 = nContri;
     #rem05027#2 = 999;
     |LEE 000#rem05027.];
     |SI FSalida = 0;
         |LEE 000#rem05027.a;
     |SINO;
         |LEE 000#rem05027.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05027#0 = #rem05000#0; |Y #rem05027#1 = nContri;
         nLinea = #rem05027#2 + 1;
     |FINSI;

     |DDEFECTO #rem05027;
     #rem05027#0   = #rem05000#0;
     #rem05027#1   = nContri;
     #rem05027#2   = nLinea;
     #rem05027#3   = aNegro;
     #rem05027#4   = "Pendiente";
     #rem05027#5   = "rem00058"
     #rem05027#6   = 0;
     #rem05027#7   = aCadena1 % 0909;
     #rem05027#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5807;  |HAZ CtrlImporte;  #rem05027#12 = aAlfa1;  #rem05027#12 = #rem05027#12 / 10000;
     aAlfa1 = aCadena1 % 6513;  |HAZ CtrlImporte;  #rem05027#9  = aAlfa1;  #rem05027#9  = #rem05027#9  / 100;
     aAlfa1 = aCadena1 % 7811;  |HAZ CtrlImporte;  #rem05027#10 = aAlfa1;  #rem05027#10 = #rem05027#10 / 100;
     aAlfa1 = aCadena1 % 8912;  |HAZ CtrlImporte;  #rem05027#13 = aAlfa1;  #rem05027#13 = #rem05027#13 / 100;

     |GRABA 020#rem05027.n;
     |LIBERA #rem05027;
     |CIERRA #rem05027;
|FPRC;

|PROCESO ClaveED;
     nLinea = 1;

     |ABRE #rem05028;
     #rem05028#0 = #rem05000#0;
     #rem05028#1 = nContri;
     #rem05028#2 = 999;
     |LEE 000#rem05028.];
     |SI FSalida = 0;
         |LEE 000#rem05028.a;
     |SINO;
         |LEE 000#rem05028.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05028#0 = #rem05000#0; |Y #rem05028#1 = nContri;
         nLinea = #rem05028#2 + 1;
     |FINSI;

     |DDEFECTO #rem05028;
     #rem05028#0   = #rem05000#0;
     #rem05028#1   = nContri;
     #rem05028#2   = nLinea;
     #rem05028#3   = aNegro;
     #rem05028#4   = "Pendiente";
     #rem05028#5   = "rem00058"
     #rem05028#6   = 0;
     #rem05028#7   = aCadena1 % 0909;
     #rem05028#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 5807;  |HAZ CtrlImporte;  #rem05028#14 = aAlfa1;  #rem05028#14 = #rem05028#14 / 10000;

     #rem05028#9   = aCadena1 % 6501;
     #rem05028#10  = aCadena1 % 6602;

     |SI #rem05028#9 = "F";  |Y #rem05028#10 = "01";
         #rem05028#11 = "Ganancias no derivadas de transmisiones";
     |FINSI;

     |SI #rem05028#9 = "F";  |Y #rem05028#10 = "02";
         #rem05028#11 = "Perdidas no derivadas de transmisiones";
     |FINSI;

     |SI #rem05028#9 = "G";  |Y #rem05028#10 = "01";
         #rem05028#11 = "Ganancias derivadas de transmisiones";
     |FINSI;

     |SI #rem05028#9 = "G";  |Y #rem05028#10 = "02";
         #rem05028#11 = "Perdidas derivadas de transmisiones";
     |FINSI;

     aAlfa1 = aCadena1 % 6812;  |HAZ CtrlImporte;  #rem05028#12 = aAlfa1;  #rem05028#12 = #rem05028#12 / 100;

     |GRABA 020#rem05028.n;
     |LIBERA #rem05028;
     |CIERRA #rem05028;
|FPRC;

|PROCESO ClaveEE;
     aNif   = aCadena1 % 0909;
     aTipo  = aCadena1 % 6502;
     aAlfa1 = aCadena1 % 5807;  |HAZ CtrlImporte;  nPorc = aAlfa1;  nPorc = nPorc / 10000;
     aAlfa1 = aCadena1 % 6712;  |HAZ CtrlImporte;  nImpo = aAlfa1;  nImpo = nImpo / 100;

     |SI aTipo = "01";
         |ABRE #rem05025;
         #rem05025#0 = #rem05000#0;
         #rem05025#1 = nContri;
         |PARA nLinea = 1;  |SI nLinea [ 999;  |HACIENDO nLinea = nLinea + 1;
               #rem05025#2 = nLinea;
               |LEE 101#rem05025.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;

               |SI #rem05025#7 = aNif;
                   #rem05025#14 = nPorc;
                   #rem05025#13 = #rem05025#13 + nImpo;
                   |GRABA 020#rem05025.a;
                   |LIBERA #rem05025;

                   |SAL;
               |FINSI;

               |LIBERA #rem05025;
         |SIGUE;
         |CIERRA #rem05025;
     |FINSI;

     |SI aTipo = "02";
         |ABRE #rem05026;
         #rem05026#0 = #rem05000#0;
         #rem05026#1 = nContri;
         |PARA nLinea = 1;  |SI nLinea [ 999;  |HACIENDO nLinea = nLinea + 1;
               #rem05026#2 = nLinea;
               |LEE 101#rem05026.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;

               |SI #rem05026#7 = aNif;
                   #rem05026#12 = nPorc;
                   #rem05026#11 = #rem05026#11 + nImpo;
                   |GRABA 020#rem05026.a;
                   |LIBERA #rem05026;

                   |SAL;
               |FINSI;

               |LIBERA #rem05026;
         |SIGUE;
         |CIERRA #rem05026;
     |FINSI;

     |SI aTipo = "03";
         |ABRE #rem05027;
         #rem05027#0 = #rem05000#0;
         #rem05027#1 = nContri;
         |PARA nLinea = 1;  |SI nLinea [ 999;  |HACIENDO nLinea = nLinea + 1;
               #rem05027#2 = nLinea;
               |LEE 101#rem05027.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;

               |SI #rem05027#7 = aNif;
                   #rem05027#12 = nPorc;
                   #rem05027#11 = #rem05027#11 + nImpo;
                   |GRABA 020#rem05027.a;
                   |LIBERA #rem05027;

                   |SAL;
               |FINSI;

               |LIBERA #rem05027;
         |SIGUE;
         |CIERRA #rem05027;
     |FINSI;

     |SI aTipo = "04";  |O aTipo = "05";
         |ABRE #rem05028;
         #rem05028#0 = #rem05000#0;
         #rem05028#1 = nContri;
         |PARA nLinea = 1;  |SI nLinea [ 999;  |HACIENDO nLinea = nLinea + 1;
               #rem05028#2 = nLinea;
               |LEE 101#rem05028.=;
               |SI FSalida ! 0;  |SAL;  |FINSI;

               |SI #rem05028#7 = aNif;
                   #rem05028#14 = nPorc;
                   #rem05028#13 = #rem05028#13 + nImpo;
                   |GRABA 020#rem05028.a;
                   |LIBERA #rem05028;

                   |SAL;
               |FINSI;

               |LIBERA #rem05028;
         |SIGUE;
         |CIERRA #rem05028;
     |FINSI;
|FPRC;

|PROCESO ClaveEF;
     nLinea = 1;

     |ABRE #rem05033;
     #rem05033#0 = #rem05000#0;
     #rem05033#1 = nContri;
     #rem05033#2 = 999;
     |LEE 000#rem05033.];
     |SI FSalida = 0;
         |LEE 000#rem05033.a;
     |SINO;
         |LEE 000#rem05033.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05033#0 = #rem05000#0; |Y #rem05033#1 = nContri;
         nLinea = #rem05033#2 + 1;
     |FINSI;

     |DDEFECTO #rem05033;
     #rem05033#0   = #rem05000#0;
     #rem05033#1   = nContri;
     #rem05033#2   = nLinea;
     #rem05033#3   = aNegro;
     #rem05033#4   = "No trasladable";
     #rem05033#5   = "";
     #rem05033#6   = 0;
     #rem05033#7   = aCadena1 % 0909;
     #rem05033#8   = aCadena1 % 1840;

     aAlfa1 = aCadena1 % 6712;  |HAZ CtrlImporte;  #rem05033#9  = aAlfa1;  #rem05033#9  = #rem05033#9 / 100;

     |GRABA 020#rem05033.n;
     |LIBERA #rem05033;
     |CIERRA #rem05033;
|FPRC;

|PROCESO ClaveSB;
     nLinea = 1;

     |ABRE #rem05034;
     #rem05034#0 = #rem05000#0;
     #rem05034#1 = nContri;
     #rem05034#2 = 999;
     |LEE 000#rem05034.];
     |SI FSalida = 0;
         |LEE 000#rem05034.a;
     |SINO;
         |LEE 000#rem05034.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05034#0 = #rem05000#0; |Y #rem05034#1 = nContri;
         nLinea = #rem05034#2 + 1;
     |FINSI;

     |DDEFECTO #rem05034;
     #rem05034#0   = #rem05000#0;
     #rem05034#1   = nContri;
     #rem05034#2   = nLinea;
     #rem05034#3   = aNegro;
     #rem05034#4   = "Pendiente";
     #rem05034#5   = "rem00030"
     #rem05034#6   = 0;
     #rem05034#7   = aCadena1 % 0945;
     #rem05034#8   = aCadena1 % 5402;
     #rem05034#9   = aCadena1 % 6946;

     aAlfa1 = aCadena1 % 5613;  |HAZ CtrlImporte;  #rem05034#10 = aAlfa1;  #rem05034#10 = #rem05034#10 / 100;

     |GRABA 020#rem05034.n;
     |LIBERA #rem05034;
     |CIERRA #rem05034;
|FPRC;

|PROCESO ClaveFA;
     nLinea = 1;

     |ABRE #rem05035;
     #rem05035#0 = #rem05000#0;
     #rem05035#1 = nContri;
     #rem05035#2 = 999;
     |LEE 000#rem05035.];
     |SI FSalida = 0;
         |LEE 000#rem05035.a;
     |SINO;
         |LEE 000#rem05035.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05035#0 = #rem05000#0; |Y #rem05035#1 = nContri;
         nLinea = #rem05035#2 + 1;
     |FINSI;

     |DDEFECTO #rem05035;
     #rem05035#0   = #rem05000#0;
     #rem05035#1   = nContri;
     #rem05035#2   = nLinea;
     #rem05035#3   = aNegro;
     #rem05035#4   = "Pendiente";
     #rem05035#5   = "rem00065"
     #rem05035#6   = 0;
     #rem05035#7   = aCadena1 % 0909;
     #rem05035#8   = aCadena1 % 1840;
     #rem05035#9   = aCadena1 % 5801;
     #rem05035#10  = aCadena1 % 5930;

     aAlfa1 = aCadena1 % 8902;
     #rem05035#11  = aAlfa1;

     |GRABA 020#rem05035.n;
     |LIBERA #rem05035;
     |CIERRA #rem05035;
|FPRC;

|PROCESO ClaveFN;
     || Este es un proceso especial no usar para copiar otra clave

     |ABRE #rem05035;

     nLinea  = 0;
     nLinea1 = 0;
     #rem05035#0 = #rem05000#0;
     #rem05035#1 = nContri;
     #rem05035#2 = 1;
     |LEE 000#rem05035.=;
     |PARA;  |SI FSalida = 0;  |HACIENDO;
          |SI #rem05035#0 = #rem05000#0; |Y #rem05035#1 = nContri;
              nLinea = #rem05035#2;
              |SI #rem05035#14 = 0;  |Y #rem05035#15 = 0;
                  nLinea1 = #rem05035#2;

                  |SAL;
              |FINSI;
          |SINO;
              |SAL;
          |FINSI;
          |LEE 000#rem05035.s;
     |SIGUE;

     |SI nLinea1 ! 0;
         nLinea = nLinea1;
     |SINO;
         nLinea = nLinea + 1;
     |FINSI;

     #rem05035#0   = #rem05000#0;
     #rem05035#1   = nContri;
     #rem05035#2   = nLinea;
     |LEE 101#rem05035.=;
     |SI FSalida ! 0;
         |DDEFECTO #rem05035;
         #rem05035#0   = #rem05000#0;
         #rem05035#1   = nContri;
         #rem05035#2   = nLinea;
         #rem05035#3   = aNegro;
         #rem05035#4   = "Pendiente";
         #rem05035#5   = "rem00065";
         #rem05035#6   = 0;
         |GRABA 020#rem05035.b;
     |FINSI;

     #rem05035#40  = aCadena1 % 0901;
     #rem05035#41  = aCadena1 % 1009;
     #rem05035#42  = aCadena1 % 3730;
     #rem05035#43  = aCadena1 % 6809;

     aAlfa1 = (aCadena1 % 8302) + "." + (aCadena1 % 8102) + "." + (aCadena1 % 7704);
     #rem05035#12 = aAlfa1;

     aAlfa1 = (aCadena1 % 9102) + "." + (aCadena1 % 8902) + "." + (aCadena1 % 8504);
     #rem05035#13 = aAlfa1;

     aAlfa1 = aCadena1 % 9409;  |HAZ CtrlImporte;  #rem05035#16 = aAlfa1;  #rem05035#16 = #rem05035#16 / 100;
     aAlfa1 = aCadena1 % 10408; |HAZ CtrlImporte;  #rem05035#28 = aAlfa1;  #rem05035#28 = #rem05035#28 / 100;
     aAlfa1 = aCadena1 % 13209; |HAZ CtrlImporte;  #rem05035#17 = aAlfa1;  #rem05035#17 = #rem05035#17 / 100;
     aAlfa1 = aCadena1 % 14208; |HAZ CtrlImporte;  #rem05035#29 = aAlfa1;  #rem05035#29 = #rem05035#29 / 100;
     aAlfa1 = aCadena1 % 17009; |HAZ CtrlImporte;  #rem05035#18 = aAlfa1;  #rem05035#18 = #rem05035#18 / 100;
     aAlfa1 = aCadena1 % 18008; |HAZ CtrlImporte;  #rem05035#30 = aAlfa1;  #rem05035#30 = #rem05035#30 / 100;
     aAlfa1 = aCadena1 % 20809; |HAZ CtrlImporte;  #rem05035#19 = aAlfa1;  #rem05035#19 = #rem05035#19 / 100;
     aAlfa1 = aCadena1 % 21808; |HAZ CtrlImporte;  #rem05035#31 = aAlfa1;  #rem05035#31 = #rem05035#31 / 100;
     aAlfa1 = aCadena1 % 24609; |HAZ CtrlImporte;  #rem05035#20 = aAlfa1;  #rem05035#20 = #rem05035#20 / 100;

     aAlfa1 = aCadena2 % 0208;  |HAZ CtrlImporte;  #rem05035#32 = aAlfa1;  #rem05035#32 = #rem05035#32 / 100;
     aAlfa1 = aCadena2 % 3009;  |HAZ CtrlImporte;  #rem05035#21 = aAlfa1;  #rem05035#21 = #rem05035#21 / 100;
     aAlfa1 = aCadena2 % 4008;  |HAZ CtrlImporte;  #rem05035#33 = aAlfa1;  #rem05035#33 = #rem05035#33 / 100;
     aAlfa1 = aCadena2 % 6809;  |HAZ CtrlImporte;  #rem05035#22 = aAlfa1;  #rem05035#22 = #rem05035#22 / 100;
     aAlfa1 = aCadena2 % 7808;  |HAZ CtrlImporte;  #rem05035#34 = aAlfa1;  #rem05035#34 = #rem05035#34 / 100;
     aAlfa1 = aCadena2 % 10609; |HAZ CtrlImporte;  #rem05035#23 = aAlfa1;  #rem05035#23 = #rem05035#23 / 100;
     aAlfa1 = aCadena2 % 11608; |HAZ CtrlImporte;  #rem05035#35 = aAlfa1;  #rem05035#35 = #rem05035#35 / 100;
     aAlfa1 = aCadena2 % 14409; |HAZ CtrlImporte;  #rem05035#24 = aAlfa1;  #rem05035#24 = #rem05035#24 / 100;
     aAlfa1 = aCadena2 % 15408; |HAZ CtrlImporte;  #rem05035#36 = aAlfa1;  #rem05035#36 = #rem05035#36 / 100;
     aAlfa1 = aCadena2 % 18209; |HAZ CtrlImporte;  #rem05035#25 = aAlfa1;  #rem05035#25 = #rem05035#25 / 100;
     aAlfa1 = aCadena2 % 19208; |HAZ CtrlImporte;  #rem05035#37 = aAlfa1;  #rem05035#37 = #rem05035#37 / 100;
     aAlfa1 = aCadena2 % 22009; |HAZ CtrlImporte;  #rem05035#26 = aAlfa1;  #rem05035#26 = #rem05035#26 / 100;
     aAlfa1 = aCadena2 % 23008; |HAZ CtrlImporte;  #rem05035#38 = aAlfa1;  #rem05035#38 = #rem05035#38 / 100;

     aAlfa1 = aCadena3 % 0409;  |HAZ CtrlImporte;  #rem05035#27 = aAlfa1;  #rem05035#27 = #rem05035#27 / 100;
     aAlfa1 = aCadena3 % 1408;  |HAZ CtrlImporte;  #rem05035#39 = aAlfa1;  #rem05035#39 = #rem05035#39 / 100;

     #rem05035#14 = 0;
     |PARA nCampo = 16;  |SI nCampo [ 27;  |HACIENDO nCampo = nCampo + 1;
           #rem05035#14 = #rem05035#14 + #rem05035#nCampo#;
     |SIGUE;

     #rem05035#15 = 0;
     |PARA nCampo = 28;  |SI nCampo [ 39;  |HACIENDO nCampo = nCampo + 1;
           #rem05035#15 = #rem05035#15 + #rem05035#nCampo#;
     |SIGUE;

     |GRABA 020#rem05035.a;
     |LIBERA #rem05035;
     |CIERRA #rem05035;
|FPRC;

|PROCESO ClaveDD;
     nLinea = 1;

     |ABRE #rem05036;
     #rem05036#0 = #rem05000#0;
     #rem05036#1 = nContri;
     #rem05036#2 = 999;
     |LEE 000#rem05036.];
     |SI FSalida = 0;
         |LEE 000#rem05036.a;
     |SINO;
         |LEE 000#rem05036.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05036#0 = #rem05000#0; |Y #rem05036#1 = nContri;
         nLinea = #rem05036#2 + 1;
     |FINSI;

     |DDEFECTO #rem05036;
     #rem05036#0   = #rem05000#0;
     #rem05036#1   = nContri;
     #rem05036#2   = nLinea;
     #rem05036#3   = aNegro;
     #rem05036#4   = "Pendiente";
     #rem05036#5   = "rem00065";
     #rem05036#6   = 0;
     #rem05036#7   = aCadena1 % 0909;
     #rem05036#8   = aCadena1 % 1840;
     #rem05036#37  = aCadena1 % 5801;
     #rem05036#38  = aCadena1 % 5909;

     aAlfa1 = (aCadena1 % 7502) + "." + (aCadena1 % 7302) + "." + (aCadena1 % 6904);
     #rem05036#9  = aAlfa1;

     aAlfa1 = (aCadena1 % 8302) + "." + (aCadena1 % 8102) + "." + (aCadena1 % 7704);
     #rem05036#10 = aAlfa1;

     aAlfa1 = aCadena1 % 8509;  |HAZ CtrlImporte;  #rem05036#13 = aAlfa1;  #rem05036#13 = #rem05036#13 / 100;
     aAlfa1 = aCadena1 % 9508;  |HAZ CtrlImporte;  #rem05036#25 = aAlfa1;  #rem05036#25 = #rem05036#25 / 100;
     aAlfa1 = aCadena1 % 11909; |HAZ CtrlImporte;  #rem05036#14 = aAlfa1;  #rem05036#14 = #rem05036#14 / 100;
     aAlfa1 = aCadena1 % 12908; |HAZ CtrlImporte;  #rem05036#26 = aAlfa1;  #rem05036#26 = #rem05036#26 / 100;
     aAlfa1 = aCadena1 % 15309; |HAZ CtrlImporte;  #rem05036#15 = aAlfa1;  #rem05036#15 = #rem05036#15 / 100;
     aAlfa1 = aCadena1 % 16308; |HAZ CtrlImporte;  #rem05036#27 = aAlfa1;  #rem05036#27 = #rem05036#27 / 100;
     aAlfa1 = aCadena1 % 18709; |HAZ CtrlImporte;  #rem05036#16 = aAlfa1;  #rem05036#16 = #rem05036#16 / 100;
     aAlfa1 = aCadena1 % 19708; |HAZ CtrlImporte;  #rem05036#28 = aAlfa1;  #rem05036#28 = #rem05036#28 / 100;
     aAlfa1 = aCadena1 % 22109; |HAZ CtrlImporte;  #rem05036#17 = aAlfa1;  #rem05036#17 = #rem05036#17 / 100;
     aAlfa1 = aCadena1 % 23108; |HAZ CtrlImporte;  #rem05036#29 = aAlfa1;  #rem05036#29 = #rem05036#29 / 100;

     aAlfa1 = aCadena2 % 0109;  |HAZ CtrlImporte;  #rem05036#18 = aAlfa1;  #rem05036#18 = #rem05036#18 / 100;
     aAlfa1 = aCadena2 % 1108;  |HAZ CtrlImporte;  #rem05036#30 = aAlfa1;  #rem05036#30 = #rem05036#30 / 100;
     aAlfa1 = aCadena2 % 3509;  |HAZ CtrlImporte;  #rem05036#19 = aAlfa1;  #rem05036#19 = #rem05036#19 / 100;
     aAlfa1 = aCadena2 % 4508;  |HAZ CtrlImporte;  #rem05036#31 = aAlfa1;  #rem05036#31 = #rem05036#31 / 100;
     aAlfa1 = aCadena2 % 6909;  |HAZ CtrlImporte;  #rem05036#20 = aAlfa1;  #rem05036#20 = #rem05036#20 / 100;
     aAlfa1 = aCadena2 % 7908;  |HAZ CtrlImporte;  #rem05036#32 = aAlfa1;  #rem05036#32 = #rem05036#32 / 100;
     aAlfa1 = aCadena2 % 10309; |HAZ CtrlImporte;  #rem05036#21 = aAlfa1;  #rem05036#21 = #rem05036#21 / 100;
     aAlfa1 = aCadena2 % 11308; |HAZ CtrlImporte;  #rem05036#33 = aAlfa1;  #rem05036#33 = #rem05036#33 / 100;
     aAlfa1 = aCadena2 % 13709; |HAZ CtrlImporte;  #rem05036#22 = aAlfa1;  #rem05036#22 = #rem05036#22 / 100;
     aAlfa1 = aCadena2 % 14708; |HAZ CtrlImporte;  #rem05036#34 = aAlfa1;  #rem05036#34 = #rem05036#34 / 100;
     aAlfa1 = aCadena2 % 17109; |HAZ CtrlImporte;  #rem05036#23 = aAlfa1;  #rem05036#23 = #rem05036#23 / 100;
     aAlfa1 = aCadena2 % 18108; |HAZ CtrlImporte;  #rem05036#35 = aAlfa1;  #rem05036#35 = #rem05036#35 / 100;
     aAlfa1 = aCadena2 % 20509; |HAZ CtrlImporte;  #rem05036#24 = aAlfa1;  #rem05036#24 = #rem05036#24 / 100;
     aAlfa1 = aCadena2 % 21508; |HAZ CtrlImporte;  #rem05036#36 = aAlfa1;  #rem05036#36 = #rem05036#36 / 100;

     #rem05036#11 = 0;
     |PARA nCampo = 13;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
           #rem05036#11 = #rem05036#11 + #rem05036#nCampo#;
     |SIGUE;

     #rem05036#12 = 0;
     |PARA nCampo = 25;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           #rem05036#12 = #rem05036#12 + #rem05036#nCampo#;
     |SIGUE;

     |GRABA 020#rem05036.n;
     |LIBERA #rem05036;
     |CIERRA #rem05036;
|FPRC;

|PROCESO ClaveAD;
     nLinea = 1;

     |ABRE #rem05038;
     #rem05038#0 = #rem05000#0;
     #rem05038#1 = nContri;
     #rem05038#2 = 999;
     |LEE 000#rem05038.];
     |SI FSalida = 0;
         |LEE 000#rem05038.a;
     |SINO;
         |LEE 000#rem05038.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05038#0 = #rem05000#0; |Y #rem05038#1 = nContri;
         nLinea = #rem05038#2 + 1;
     |FINSI;

     |DDEFECTO #rem05038;
     #rem05038#0   = #rem05000#0;
     #rem05038#1   = nContri;
     #rem05038#2   = nLinea;
     #rem05038#3   = aNegro;
     #rem05038#4   = "Pendiente";
     #rem05038#5   = "rem00065";
     #rem05038#6   = 0;
     #rem05038#7   = aCadena1 % 0909;
     #rem05038#8   = aCadena1 % 1840;
     #rem05038#37  = aCadena1 % 5801;
     #rem05038#38  = aCadena1 % 5909;
     #rem05038#39  = aCadena1 % 6809;
     #rem05038#40  = aCadena1 % 7709;

     aAlfa1 = (aCadena1 % 9302) + "." + (aCadena1 % 9102) + "." + (aCadena1 % 8704);
     #rem05038#9  = aAlfa1;

     aAlfa1 = (aCadena1 % 10102) + "." + (aCadena1 % 9902) + "." + (aCadena1 % 9504);
     #rem05038#10 = aAlfa1;

     aAlfa1 = aCadena1 % 10309; |HAZ CtrlImporte;  #rem05038#13 = aAlfa1;  #rem05038#13 = #rem05038#13 / 100;
     aAlfa1 = aCadena1 % 11308; |HAZ CtrlImporte;  #rem05038#25 = aAlfa1;  #rem05038#25 = #rem05038#25 / 100;
     aAlfa1 = aCadena1 % 13709; |HAZ CtrlImporte;  #rem05038#14 = aAlfa1;  #rem05038#14 = #rem05038#14 / 100;
     aAlfa1 = aCadena1 % 14708; |HAZ CtrlImporte;  #rem05038#26 = aAlfa1;  #rem05038#26 = #rem05038#26 / 100;
     aAlfa1 = aCadena1 % 17109; |HAZ CtrlImporte;  #rem05038#15 = aAlfa1;  #rem05038#15 = #rem05038#15 / 100;
     aAlfa1 = aCadena1 % 18108; |HAZ CtrlImporte;  #rem05038#27 = aAlfa1;  #rem05038#27 = #rem05038#27 / 100;
     aAlfa1 = aCadena1 % 20509; |HAZ CtrlImporte;  #rem05038#16 = aAlfa1;  #rem05038#16 = #rem05038#16 / 100;
     aAlfa1 = aCadena1 % 21508; |HAZ CtrlImporte;  #rem05038#28 = aAlfa1;  #rem05038#28 = #rem05038#28 / 100;
     aAlfa1 = aCadena1 % 23909; |HAZ CtrlImporte;  #rem05038#17 = aAlfa1;  #rem05038#17 = #rem05038#17 / 100;
     aAlfa1 = (aCadena1 % 24906) + (aCadena2 % 102);  |HAZ CtrlImporte;
                                                   #rem05038#29 = aAlfa1;

     aAlfa1 = aCadena2 % 0309;  |HAZ CtrlImporte;  #rem05038#18 = aAlfa1;  #rem05038#18 = #rem05038#18 / 100;
     aAlfa1 = aCadena2 % 1308;  |HAZ CtrlImporte;  #rem05038#30 = aAlfa1;  #rem05038#30 = #rem05038#30 / 100;
     aAlfa1 = aCadena2 % 3709;  |HAZ CtrlImporte;  #rem05038#19 = aAlfa1;  #rem05038#19 = #rem05038#19 / 100;
     aAlfa1 = aCadena2 % 5708;  |HAZ CtrlImporte;  #rem05038#31 = aAlfa1;  #rem05038#31 = #rem05038#31 / 100;
     aAlfa1 = aCadena2 % 8109;  |HAZ CtrlImporte;  #rem05038#20 = aAlfa1;  #rem05038#20 = #rem05038#20 / 100;
     aAlfa1 = aCadena2 % 9108;  |HAZ CtrlImporte;  #rem05038#32 = aAlfa1;  #rem05038#32 = #rem05038#32 / 100;
     aAlfa1 = aCadena2 % 11509; |HAZ CtrlImporte;  #rem05038#21 = aAlfa1;  #rem05038#21 = #rem05038#21 / 100;
     aAlfa1 = aCadena2 % 12508; |HAZ CtrlImporte;  #rem05038#33 = aAlfa1;  #rem05038#33 = #rem05038#33 / 100;
     aAlfa1 = aCadena2 % 14909; |HAZ CtrlImporte;  #rem05038#22 = aAlfa1;  #rem05038#22 = #rem05038#22 / 100;
     aAlfa1 = aCadena2 % 15908; |HAZ CtrlImporte;  #rem05038#34 = aAlfa1;  #rem05038#34 = #rem05038#34 / 100;
     aAlfa1 = aCadena2 % 18309; |HAZ CtrlImporte;  #rem05038#23 = aAlfa1;  #rem05038#23 = #rem05038#23 / 100;
     aAlfa1 = aCadena2 % 19308; |HAZ CtrlImporte;  #rem05038#35 = aAlfa1;  #rem05038#35 = #rem05038#35 / 100;
     aAlfa1 = aCadena2 % 21709; |HAZ CtrlImporte;  #rem05038#24 = aAlfa1;  #rem05038#24 = #rem05038#24 / 100;
     aAlfa1 = aCadena2 % 22708; |HAZ CtrlImporte;  #rem05038#36 = aAlfa1;  #rem05038#36 = #rem05038#36 / 100;

     #rem05038#11 = 0;
     |PARA nCampo = 13;  |SI nCampo [ 24;  |HACIENDO nCampo = nCampo + 1;
           #rem05038#11 = #rem05038#11 + #rem05038#nCampo#;
     |SIGUE;

     #rem05038#12 = 0;
     |PARA nCampo = 25;  |SI nCampo [ 36;  |HACIENDO nCampo = nCampo + 1;
           #rem05038#12 = #rem05038#12 + #rem05038#nCampo#;
     |SIGUE;

     |GRABA 020#rem05038.n;
     |LIBERA #rem05038;
     |CIERRA #rem05038;
|FPRC;

|PROCESO ClaveFM;
     nLinea = 1;

     |ABRE #rem05040;
     #rem05040#0 = #rem05000#0;
     #rem05040#1 = nContri;
     #rem05040#2 = 999;
     |LEE 000#rem05040.];
     |SI FSalida = 0;
         |LEE 000#rem05040.a;
     |SINO;
         |LEE 000#rem05040.u;
     |FINSI;

     |SI FSalida = 0;  |Y #rem05040#0 = #rem05000#0; |Y #rem05040#1 = nContri;
         nLinea = #rem05040#2 + 1;
     |FINSI;

     |DDEFECTO #rem05040;
     #rem05040#0   = #rem05000#0;
     #rem05040#1   = nContri;
     #rem05040#2   = nLinea;
     #rem05040#3   = aNegro;
     #rem05040#4   = "Pendiente";
     #rem05040#5   = "rem00065";
     #rem05040#6   = 0;
     #rem05040#7   = "12";

     aAlfa1 = aCadena1 % 1009;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 2809;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 4609;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 6409;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 8209;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 10009; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 11809; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 13609; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 15409; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 17209; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 19009; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);
     aAlfa1 = aCadena1 % 20809; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#8 = #rem05040#8 + (nNume / 100);

     aAlfa1 = aCadena1 % 2008;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 3808;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 5608;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 7408;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 9208;  |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 11008; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 12808; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 14608; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 16408; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 18208; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 20008; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 21808; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 + (nNume / 100);
     aAlfa1 = aCadena1 % 22608; |HAZ CtrlImporte;  nNume = aAlfa1;  #rem05040#9 = #rem05040#9 - (nNume / 100);

     |SI #rem05040#9 = 0;
         #rem05040#4   = "No trasladable";
     |FINSI;

     |GRABA 020#rem05040.n;
     |LIBERA #rem05040;
     |CIERRA #rem05040;
|FPRC;

|| Aqui insertar

|PROCESO TrataCadena;
     aAlfa1 = aCadena1 % 101;
     |SI aAlfa1 = "0";  |ACABA;  |FINSI;
     |SI aAlfa1 = "1";  |ACABA;  |FINSI;

     |SI aAlfa1 = "3";  |HAZ DatosPersonales;  |ACABA;  |FINSI;

     aAlfa1 = aCadena1 % 203;
     |SI aAlfa1 = "DOM";  |HAZ DatosPersonales;  |ACABA;  |FINSI;
     |SI aAlfa1 = "VHR";  |HAZ DatosPersonales;  |ACABA;  |FINSI;

     |SI aAlfa1 = "RTA";  |HAZ ClaveRT;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RTB";  |HAZ ClaveRB;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RTC";  |HAZ ClaveRC;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAA";  |HAZ ClaveEA;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAB";  |HAZ ClaveEB;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAC";  |HAZ ClaveEC;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAD";  |HAZ ClaveED;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAE";  |HAZ ClaveEE;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EAF";  |HAZ ClaveEF;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PHD";  |HAZ ClavePHD; |ACABA;  |FINSI;
     |SI aAlfa1 = "FIE";  |HAZ ClaveFIE; |ACABA;  |FINSI;
     |SI aAlfa1 = "FIC";  |HAZ ClaveFIC; |ACABA;  |FINSI;

     aAlfa1 = aCadena1 % 202;
     |SI aAlfa1 = "DO";                  |ACABA;  |FINSI;
     |SI aAlfa1 = "CB";   |HAZ ClaveCB;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RE";   |HAZ ClaveRE;  |ACABA;  |FINSI;
     |SI aAlfa1 = "RI";   |HAZ ClaveRI;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AE";   |HAZ ClaveAE;  |ACABA;  |FINSI;
     |SI aAlfa1 = "TV";   |HAZ ClaveTV;  |ACABA;  |FINSI;
     |SI aAlfa1 = "SG";   |HAZ ClaveSG;  |ACABA;  |FINSI;
     |SI aAlfa1 = "CD";   |HAZ ClaveCD;  |ACABA;  |FINSI;
     |SI aAlfa1 = "CT";   |HAZ ClaveCT;  |ACABA;  |FINSI;
     |SI aAlfa1 = "UR";   |HAZ ClaveUR;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PF";   |HAZ ClavePF;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DN";   |HAZ ClaveDN;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AR";   |HAZ ClaveAR;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DM";   |HAZ ClaveDM;  |ACABA;  |FINSI;
     |SI aAlfa1 = "PP";   |HAZ ClavePP;  |ACABA;  |FINSI;
     |SI aAlfa1 = "IP";   |HAZ ClaveIP;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AG";   |HAZ ClaveAG;  |ACABA;  |FINSI;
     |SI aAlfa1 = "SC";   |HAZ ClaveSC;  |ACABA;  |FINSI;
     |SI aAlfa1 = "CU";   |HAZ ClaveCU;  |ACABA;  |FINSI;
     |SI aAlfa1 = "NO";   |HAZ ClaveNO;  |ACABA;  |FINSI;
     |SI aAlfa1 = "LT";   |HAZ ClaveLT;  |ACABA;  |FINSI;
     |SI aAlfa1 = "CC";   |HAZ ClaveCC;  |ACABA;  |FINSI;
     |SI aAlfa1 = "EV";   |HAZ ClaveEV;  |ACABA;  |FINSI;
     |SI aAlfa1 = "SB";   |HAZ ClaveSB;  |ACABA;  |FINSI;
     |SI aAlfa1 = "FA";   |HAZ ClaveFA;  |ACABA;  |FINSI;
     |SI aAlfa1 = "FN";   |HAZ ClaveFN;  |ACABA;  |FINSI;
     |SI aAlfa1 = "DD";   |HAZ ClaveDD;  |ACABA;  |FINSI;
     |SI aAlfa1 = "AD";   |HAZ ClaveAD;  |ACABA;  |FINSI;
     |SI aAlfa1 = "FM";   |HAZ ClaveFM;  |ACABA;  |FINSI;

     || Aqui insertar

     |SI aClave ! aAlfa1;
         aAlfa2 = aCadena1 % 401;
         |SI aAlfa2 ] "0";  |Y aAlfa2 [ "9";
             aAlfa3 = aCadena1 % 202;
         |SINO;
             aAlfa3 = aCadena1 % 203;
         |FINSI;

         |SI aAlfa3 = "AA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "DA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "DI";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "EH";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PC";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VH";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VA";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VXG";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VE";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "VN";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "OT";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PX";   aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "RTD";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "PHI";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "FID";  aAlfa3 = "";  |FINSI;
         |SI aAlfa3 = "99";   aAlfa3 = "";  |FINSI;

         |SI aAlfa3 ! "";
             aAlfa = "0000Clave " + aAlfa3 + " no reconocida en esta versi¢n, ";
             aAlfa = aAlfa + "contacte con nuestro departamento de soporte para ";
             aAlfa = aAlfa + "incluirlo en una pr¢xima versi¢n";
             |MENAV aAlfa;
         |FINSI;
     |FINSI;

     aClave = aAlfa1;
|FPRC;

|PROCESO tempora0;
     |BORRA 020#tempora0@.a;
     |LIBERA #tempora0@;
|FPRC;

|DEFBUCLE tempora0;
     #tempora0@#1003;
     ;
     #rem05000#0, nContri, 001;
     #rem05000#0, nContri, 999;
     be;
     NULL, tempora0;
|FIN;

|PROCESO ElBorrado;
     aDef = aBase + "def/" + aMas;

     |CARGA_DEF aDef, tempora0@;

     |BUCLE tempora0;

     |DESCARGA_DEF #tempora0@;
|FPRC;

|PROCESO BorraDatos;
     aMas = "rem05001.mas";  |HAZ ElBorrado;
     aMas = "rem05002.mas";  |HAZ ElBorrado;
     aMas = "rem05003.mas";  |HAZ ElBorrado;
     aMas = "rem05004.mas";  |HAZ ElBorrado;
     aMas = "rem05005.mas";  |HAZ ElBorrado;
     aMas = "rem05006.mas";  |HAZ ElBorrado;
     aMas = "rem05007.mas";  |HAZ ElBorrado;
     aMas = "rem05008.mas";  |HAZ ElBorrado;
     aMas = "rem05009.mas";  |HAZ ElBorrado;
     aMas = "rem05010.mas";  |HAZ ElBorrado;
     aMas = "rem05011.mas";  |HAZ ElBorrado;
     aMas = "rem05012.mas";  |HAZ ElBorrado;
     aMas = "rem05013.mas";  |HAZ ElBorrado;
     aMas = "rem05014.mas";  |HAZ ElBorrado;
     aMas = "rem05015.mas";  |HAZ ElBorrado;
     aMas = "rem05016.mas";  |HAZ ElBorrado;
     aMas = "rem05017.mas";  |HAZ ElBorrado;
     aMas = "rem05018.mas";  |HAZ ElBorrado;
     aMas = "rem05019.mas";  |HAZ ElBorrado;
     aMas = "rem05020.mas";  |HAZ ElBorrado;
     aMas = "rem05021.mas";  |HAZ ElBorrado;
     aMas = "rem05022.mas";  |HAZ ElBorrado;
     aMas = "rem05023.mas";  |HAZ ElBorrado;
     aMas = "rem05024.mas";  |HAZ ElBorrado;
     aMas = "rem05025.mas";  |HAZ ElBorrado;
     aMas = "rem05026.mas";  |HAZ ElBorrado;
     aMas = "rem05027.mas";  |HAZ ElBorrado;
     aMas = "rem05028.mas";  |HAZ ElBorrado;
     aMas = "rem05029.mas";  |HAZ ElBorrado;
     aMas = "rem05030.mas";  |HAZ ElBorrado;
     aMas = "rem05031.mas";  |HAZ ElBorrado;
     aMas = "rem05032.mas";  |HAZ ElBorrado;
     aMas = "rem05033.mas";  |HAZ ElBorrado;
     aMas = "rem05034.mas";  |HAZ ElBorrado;
     aMas = "rem05035.mas";  |HAZ ElBorrado;
     aMas = "rem05036.mas";  |HAZ ElBorrado;
     aMas = "rem05037.mas";  |HAZ ElBorrado;
     aMas = "rem05038.mas";  |HAZ ElBorrado;
     aMas = "rem05039.mas";  |HAZ ElBorrado;
     aMas = "rem05040.mas";  |HAZ ElBorrado;
     aMas = "rem05041.mas";  |HAZ ElBorrado;
|FPRC;

|PROCESO CargaDatos;
     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |XABRE "AB", aAbre, nHandle;

     aCR        = &10;
     aLF        = &13;
     nSalir     = 0;
     aClave     = "";
     aCadena1   = "";
     aCadena2   = "";
     aCadena3   = "";
     nFiCad1    = 254;
     nFiCad2    = 508;

     |XLEE nHandle, 1, aAlfa;
     |PARA; |SI FSalida > 0; |HACIENDO;
            nCaracter = nCaracter + 1;

            |SI aAlfa = aCR;
                |HAZ TrataCadena;
                aCadena1  = "";
                aCadena2  = "";
                aCadena3  = "";
                nCaracter = 0;
            |SINO;
                |SI aAlfa ! aLF;
                    |SI nCaracter [ nFiCad1;
                        aCadena1 = aCadena1 + aAlfa;
                    |SINO;
                        |SI nCaracter [ nFiCad2;
                            aCadena2 = aCadena2 + aAlfa;
                        |SINO;
                            aCadena3 = aCadena3 + aAlfa;
                        |FINSI;
                    |FINSI;
                |FINSI;
            |FINSI;

            |SI nSalir = 1;  |SAL;  |FINSI;

            |XLEE nHandle, 1, aAlfa;
     |SIGUE;
     |XCIERRA nHandle;

     |SI nContri = 1;
         |ABRE #rem05031;
         #rem05031#0  = #rem05000#0;
         #rem05031#1  = nContri;
         #rem05031#2  = 2;
         |LEE 101#rem05031.=;
         |SI FSalida = 0;
             aDef = aBase + "def/rem05031.mas";
             |CARGA_DEF aDef, tempora0@;
             |ABRE #tempora0@;
             #tempora0@#0 = #rem05000#0;
             #tempora0@#1 = nContri;
             #tempora0@#2 = 1;
             |LEE 000#tempora0@.=;
             |SI FSalida = 0;
                 |PARA nCampoGet = 19;  |SI nCampoGet [ 37;  |HACIENDO nCampoGet = nCampoGet + 1;
                       #rem05031#nCampoGet# = #tempora0@#nCampoGet#;
                 |SIGUE;
                 |GRABA 020#rem05031.a;
                 |LIBERA #rem05031;
             |FINSI;
             |CIERRA #tempora0@;
             |DESCARGA_DEF #tempora0@;
         |FINSI;
         |CIERRA #rem05031;
     |FINSI;
|FPRC;

|PROCESO EnciendeBotones;
     |ESTADO_CONTROL nBoton1_1, "DISABLE";
     |ESTADO_CONTROL nBoton1_2, "DISABLE";
     |ESTADO_CONTROL nBoton1_3, "DISABLE";
     |ESTADO_CONTROL nBoton2_1, "DISABLE";
     |ESTADO_CONTROL nBoton2_2, "DISABLE";
     |ESTADO_CONTROL nBoton2_3, "DISABLE";
     |ESTADO_CONTROL nBoton3_1, "DISABLE";
     |ESTADO_CONTROL nBoton3_2, "DISABLE";
     |ESTADO_CONTROL nBoton3_3, "DISABLE";
     |ESTADO_CONTROL nBoton4_1, "DISABLE";
     |ESTADO_CONTROL nBoton4_2, "DISABLE";
     |ESTADO_CONTROL nBoton4_3, "DISABLE";
     |ESTADO_CONTROL nBoton5_1, "DISABLE";
     |ESTADO_CONTROL nBoton5_2, "DISABLE";
     |ESTADO_CONTROL nBoton5_3, "DISABLE";
     |ESTADO_CONTROL nBoton6_1, "DISABLE";
     |ESTADO_CONTROL nBoton6_2, "DISABLE";
     |ESTADO_CONTROL nBoton6_3, "DISABLE";

     aAlfa = #rem05000#2;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton1_1, "ENABLE";
             |ESTADO_CONTROL nBoton1_2, "ENABLE";
         |FINSI;

         aAlfa = #rem05000#4;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton1_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#6;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton2_1, "ENABLE";
             |ESTADO_CONTROL nBoton2_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton2_3, "DISABLE";
         aAlfa = #rem05000#8;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton2_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#10;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton3_1, "ENABLE";
             |ESTADO_CONTROL nBoton3_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton3_3, "DISABLE";
         aAlfa = #rem05000#12;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton3_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#14;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton4_1, "ENABLE";
             |ESTADO_CONTROL nBoton4_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton4_3, "DISABLE";
         aAlfa = #rem05000#16;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton4_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#18;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton5_1, "ENABLE";
             |ESTADO_CONTROL nBoton5_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton5_3, "DISABLE";
         aAlfa = #rem05000#20;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton5_3, "ENABLE";
         |FINSI;
     |FINSI;

     aAlfa = #rem05000#22;  |QBF aAlfa;
     |SI aAlfa ! "";
         |SI nModo ! 4;
             |ESTADO_CONTROL nBoton6_1, "ENABLE";
             |ESTADO_CONTROL nBoton6_2, "ENABLE";
         |FINSI;

         |ESTADO_CONTROL nBoton6_3, "DISABLE";
         aAlfa = #rem05000#24;  |QBF aAlfa;
         |SI aAlfa = "Procesado";
             |ESTADO_CONTROL nBoton6_3, "ENABLE";
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO GrabaPortal;
     aAlfa = aAlfa + &13 + &10;
     |XGRABA nHandle, aAlfa;
|FPRC;

|PROCESO Explorador;
     |HAZ CogeMac;

     |ABRE #zregubic;
     #zregubic#0 = 2016;
     #zregubic#1 = eaDSMAC;
     |LEE 101#zregubic.=;
     |SI FSalida ! 0;
         |DDEFECTO #zregubic;
         #zregubic#0 = 2016;
         #zregubic#1 = eaDSMAC;
         |GRABA 020#zregubic.b;
     |FINSI;

     aPathExplorador = #zregubic#4;  |QBF aPathExplorador;

     |SI aPathExplorador = "";  |O aForzExplorador = "S";
         |MENAV "0000Busque y pinche en el explorador con el que quiera trabajar";

         aPathExplorador = "F" + aPathExplorador;
         |BROWSE aPathExplorador;
         aPathExplorador = aPathExplorador % 290;  |QBF aPathExplorador;
     |FINSI;

     |SI aPathExplorador ! "";
         #zregubic#4 = aPathExplorador;
     |FINSI;

     |GRABA 020#zregubic.a;
     |LIBERA #zregubic;
     |CIERRA #zregubic;
|FPRC;

|PROCESO BotonExplora;
     aForzExplorador = "S";  |HAZ Explorador;
|FPRC;

|PROCESO QuitaEnyes;
     aLong   = aAlfa1 % 0;
     nLong   = aLong;
     aCadena1 = "";
     |PARA nCarac = 1;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos       = (nCarac * 100) + 1;
           aCaracter  = aAlfa1 % nPos;

           |SI aCaracter = "¥";
               aCaracter = &0209;
           |FINSI;

           aCadena1 = aCadena1 + aCaracter;
     |SIGUE;

     aAlfa1 = aCadena1;
|FPRC;

|PROCESO PaginaConsulta;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     aFichero = "pet" + (("00000" + #rem05000#0) % -105) + ".htm";
     aAbre    = eaDirServidor + aFichero;
     |XABRE "WB", aAbre, nHandle;

     aAlfa = "<?xml version=" + &34 + "1.0" + &34 + " encoding=" + &34 + "ISO-8859-1" + &34 + " ?>";
     |HAZ GrabaPortal;

     aAlfa = "<!DOCTYPE html PUBLIC " + &34 + "-//W3C//DTD XHTML 1.0 Transitional//EN " + &34;
     aAlfa = aAlfa + &34 + "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html xmlns=" + &34 + "http://www.w3.org/1999/xhtml"  + &34;
     aAlfa = aAlfa + " xml:lang=" + &34 + "es" + &34 + " lang=" + &34 + "es" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Consulta de datos fiscales, ejercicio 2016</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Script-Type" + &34;
     aAlfa = aAlfa + " content=" + &34 + "text/javascript" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "<script type=" + &34 + "text/javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "//<![CDATA[";
     |HAZ GrabaPortal;

     aAlfa = "//INTERNET SIN CERTIFICADO (con referencia)";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "window.onload = function() {";
     |HAZ GrabaPortal;

     aAlfa = "        document.frm.submit();";
     |HAZ GrabaPortal;

     aAlfa = "}";
     |HAZ GrabaPortal;

     aAlfa = "//]]>";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "<body>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "      <form action="+ &34 + "https://www2.agenciatributaria.gob.es/es13/l/PT6HPTLINK6H" + &34;
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "MIC" + &34;
     aAlfa = aAlfa + " id=" + &34 + "MIC" + &34;
     aAlfa = aAlfa + " value=" + &34 + "IIS" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "IDI" + &34;
     aAlfa = aAlfa + " id=" + &34 + "IDI" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "PDP" + &34;
     aAlfa = aAlfa + " id=" + &34 + "PDP" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "EJF" + &34;
     aAlfa = aAlfa + " id=" + &34 + "EJF" + &34;
     aAlfa = aAlfa + " value= " + &34 + "2016" + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa1  = #rem05000#nCampo#;  |QBF aAlfa1;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "NIF" + &34;
     aAlfa = aAlfa + " id=" + &34 + "NIF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;


     nCampo1 = nCampo + 1;
     aAlfa1  = #rem05000#nCampo1#;  |QBF aAlfa1;
     |HAZ QuitaEnyes;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "APE" + &34;
     aAlfa = aAlfa + " id=" + &34 + "APE" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;

     nCampo1 = nCampo + 2;
     aAlfa1  = #rem05000#nCampo1#;  |QBF aAlfa1;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "REF" + &34;
     aAlfa = aAlfa + " id=" + &34 + "REF" + &34;
     aAlfa = aAlfa + " value= " + &34 + aAlfa1 + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "DIR" + &34;
     aAlfa = aAlfa + " id=" + &34 + "DIR" + &34 + " />";
     |HAZ GrabaPortal;

     aAlfa = "         <input type=" + &34 + "hidden" + &34;
     aAlfa = aAlfa + " name=" + &34 + "FIN" + &34;
     aAlfa = aAlfa + " id=" + &34 + "FIN" + &34 + "/>";
     |HAZ GrabaPortal;

     aAlfa = "     </form>";
     |HAZ GrabaPortal;

     aAlfa = "</body>";
     |HAZ GrabaPortal;

     aAlfa = "</html>";
     |HAZ GrabaPortal;

     |XCIERRA nHandle;

     aForzExplorador = "N";  |HAZ Explorador;

     eaOrigen  = eaDirServidor + aFichero;
     eaDestino = eaDirLocal   + aFichero;
     |HAZ CopiaFichero;

     |FBORRA eaOrigen;

     |SI aPathExplorador ! "";
         aAlfa = aPathExplorador + " " + eaDestino;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
         aAlfa  = "cmd " + &34 + "/c START /WAIT " + eaDestino + &34;
     |FINSI;

     |RSYSTEM aAlfa;

||     |RFBORRA eaDestino;

     |PULSATECLA;
|FPRC;

|PROCESO BuscaError;
     aMensa = "0000Clave de Referencia incorrecta";

     |SI aAlfa = "2";   aMensa = "0000NIF err¢neo";      |FINSI;
     |SI aAlfa = "3";   aMensa = "0000NIF err¢neo";      |FINSI;
     |SI aAlfa = "4";   aMensa = "0000Usuario de baja";  |FINSI;
     |SI aAlfa = "6";   aMensa = "0000Usuario bloqueado por superar accesos err¢neos en el d¡a";  |FINSI;
     |SI aAlfa = "7";   aMensa = "0000Usuario inhabilitado para pedir referencia con casilla";    |FINSI;
     |SI aAlfa = "8";   aMensa = "0000Exceso de peticiones de referencias satisfechas en el d¡a"; |FINSI;
     |SI aAlfa = "30";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "31";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "32";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "35";  aMensa = "0000Faltan datos";  |FINSI;
     |SI aAlfa = "36";  aMensa = "0000Faltan datos";  |FINSI;
     |SI aAlfa = "37";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "38";  aMensa = "0000Contribuyente dice que es no declarante, pero tiene alguna declaraci¢n activa";  |FINSI;
     |SI aAlfa = "52";  aMensa = "0000Dato  incorrecto";  |FINSI;
     |SI aAlfa = "53";  aMensa = "0000Faltan datos por completar";  |FINSI;
     |SI aAlfa = "54";  aMensa = "0000Dato incorrecto";  |FINSI;
     |SI aAlfa = "55";  aMensa = "0000Dato incorrecto";  |FINSI;
     |SI aAlfa = "61";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "67";  aMensa = "0000Dato err¢neo";  |FINSI;
     |SI aAlfa = "90";  aMensa = "0000IP bloqueada por superar accesos err¢neos en el d¡a";  |FINSI;
     |SI aAlfa = "97";  aMensa = "0000NIF en blanco";  |FINSI;
     |SI aAlfa = "98";  aMensa = "0000Clave de Referencia en blanco";  |FINSI;
     |SI aAlfa = "99";  aMensa = "0000Clave de Referencia incorrecta";  |FINSI;
     |SI aAlfa = "160"; aMensa = "0000Error en el servicio de identificaci¢n";  |FINSI;
     |SI aAlfa = "170"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "171"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "172"; aMensa = "0000Error en el servicio de env¡o";  |FINSI;
     |SI aAlfa = "180"; aMensa = "0000Error en el servicio de validaci¢n";  |FINSI;
     |SI aAlfa = "181"; aMensa = "0000Error en el servicio de validaci¢n";  |FINSI;
     |SI aAlfa = "210"; aMensa = "0000Error estad¡sticas";  |FINSI;
     |SI aAlfa = "220"; aMensa = "0000Error log";  |FINSI;
     |SI aAlfa = "221"; aMensa = "0000Error de transformaci¢n";  |FINSI;

     |MENAV aMensa;
     nError = 1;
|FPRC;

|PROCESO LeeRespuesta;
     nError = 0;

     aAbre = eaDirResp + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |XABRE "C", aAbre, nHandle;

     nConta = 0;
     |PARA; |SI;  |HACIENDO;
          |XLEE nHandle, 250, aAlfa;
          |SI FSalida < 0; |SAL;  |FINSI;

          |QBT aAlfa;
          aAlfa = aAlfa - "<status>";
          |SI FSalida ! 0;
              aAlfa = aAlfa - "</status>";
              |SI aAlfa = "0";  |SAL;  |FINSI;
          |FINSI;

          aAlfa = aAlfa - "<codigo>";
          |SI FSalida ! 0;
              aAlfa = aAlfa - "</codigo>";
              |HAZ BuscaError;
          |FINSI;
     |SIGUE;
     |XCIERRA nHandle;
|FPRC;

|PROCESO PaginaDescarga;
     nCampo1 = nCampo + 2;

     aAbre = eaDirResp + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |RFBORRA aAbre;

     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     aEnlace = eaDirLocal + "dsrentadatfisc ";
     aEnlace = aEnlace + #rem05000#nCampo#;  |QBF aEnlace;
     aEnlace = aEnlace + " " + #rem05000#nCampo1#;  |QBF aEnlace;
     aEnlace = aEnlace + " S ";
     aEnlace = aEnlace + eaDirResp + #rem05000#nCampo#;  |QBF aEnlace;
     aEnlace = aEnlace + ".dfp";

     aAlfa  = "cmd " + &34 + "/c START /WAIT " + aEnlace + &34;
     |RSYSTEM aAlfa;

     aAbre = eaDirResp + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |XABRE "EC", aAbre, 0;
     |SI FSalida ] 0;
         |HAZ LeeRespuesta;
         |SI nError = 1;
             |ACABA;
         |FINSI;
     |SINO;
         |MENAV "0000El fichero no se ha descargado.";
         |ACABA;
     |FINSI;

     eaOrigen  = eaDirResp + #rem05000#nCampo# + ".dfp";  |QBT eaOrigen;
     eaDestino = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT eaDestino;
     |HAZ RecibeFichero;

     |HAZ BorraDatos;

     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |XABRE "E", aAbre, 0;
     |SI FSalida ] 0;
         nCampo1   = nCampo + 3;
         #rem05000#nCampo1# = "Procesado";   |PINTA #rem05000#nCampo1#;

         |HAZ CargaDatos;
         |HAZ EnciendeBotones;
     |SINO;
         |MENAV "0000Ha habido algun error en la descarga del borrador. Por favor intentelo de nuevo";
     |FINSI;
|FPRC;

|PROCESO Descarga;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = nCampo + 3;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |SI aAlfa = "Procesado";
          |CONFI "0000NEl borrador ya ha sido procesado. Lo descargamos de nuevo";
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #rem05000#nCampo1# = "Sin descargar";   |PINTA #rem05000#nCampo1#;

          |HAZ EnciendeBotones;
     |FINSI;

     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     nCampo1 = nCampo + 2;
     |HAZ PaginaDescarga;

     |PULSATECLA;
|FPRC;

|PROCESO PaginaVisualiza;
     aEnlace  = "https://www9.agenciatributaria.gob.es/wlpl/DFPA-D162/SvVisDF16Net";

     aAbre = eaDirLocal + "Presenta.html";
     |XABRE "WBC", aAbre, nHandle;

     aAlfa = "<!DOCTYPE HTML PUBLIC " + &34 + "-//W3C//DTD HTML 4.01 Transitional//EN" + &34;
     |HAZ GrabaPortal;

     aAlfa = &34 + "http://www.w3.org/TR/html4/loose.dtd" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "<html>";
     |HAZ GrabaPortal;

     aAlfa = "<head>";
     |HAZ GrabaPortal;

     aAlfa = "<title>Documento sin t&iacute;tulo</title>";
     |HAZ GrabaPortal;

     aAlfa = "<meta http-equiv=" + &34 + "Content-Type" + &34 + " content=" + &34 + "text/html; charset=iso-8859-1" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "</head>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "<script language=" + &34 + "javascript" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "     function carga()";
     |HAZ GrabaPortal;

     aAlfa = "     {";
     |HAZ GrabaPortal;

     aAlfa = "          document.location = ";
     aAlfa = aAlfa + &34 + aEnlace + &34 + ";";
     |HAZ GrabaPortal;

     aAlfa = "     }";
     |HAZ GrabaPortal;

     aAlfa = "</script>";
     |HAZ GrabaPortal;

     aAlfa = "";
     |HAZ GrabaPortal;

     aAlfa = "<body onload=" + &34 + "javascript:carga();" + &34 + ">";
     |HAZ GrabaPortal;

     aAlfa = "";  |HAZ GrabaPortal;
     aAlfa = "";  |HAZ GrabaPortal;

     aAlfa = "</form>";   |HAZ GrabaPortal;
     aAlfa = "</body>";   |HAZ GrabaPortal;
     aAlfa = "</html>";   |HAZ GrabaPortal;

     |XCIERRA nHandle;

     aForzExplorador = "N";
     aPathExplorador = "";
     |HAZ Explorador; |QBF aPathExplorador;
     |SI aPathExplorador = "";
         aForzExplorador = "S"; aPathExplorador = "";
         |HAZ Explorador;
     |FINSI;

     |SI aPathExplorador ! "";
         aAlfa = aPathExplorador + " " + aAbre;
         aAlfa = "cmd " + &34 + "/c START /WAIT " + aAlfa + &34;
     |SINO;
        aAlfa  = "cmd " + &34 + "/c START /WAIT " + aAbre + &34;
     |FINSI;

     |RSYSTEM aAlfa;

     |PULSATECLA;
|FPRC;

|PROCESO Visualiza;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = nCampo + 2;
     |HAZ PaginaVisualiza;

     |PULSATECLA;
|FPRC;

|PROCESO Pondsselect;
     |HAZ LeeUnidadBasico;

     |DBASE aBase;  |QBF aBase;
     aFicOrigen = aBase + "plugins/dsselect.exe";
     |XABRE "E", aFicOrigen, nHandle;
     |SI FSalida < 0;  |ACABA;  |FINSI;

     aFicDestino  = eaDirLocal + "dsselect.exe";

     aContiene1 = aFicDestino;
     |ESPECIFICA "REMOTOMD5", aContiene;
     aDocRemoto = FSalida;  |QBF aDocRemoto;

     aContiene1 = aFicOrigen;
     |ESPECIFICA "MD5", aContiene;
     aDocServidor = FSalida;  |QBF aDocServidor;

     |SI aDocRemoto ! aDocServidor;  |O aDocRemoto = "";
         aIPRemoto = "";
         |IP_REMOTO aIPRemoto;  |QBT aIPRemoto;

         |SI aIPRemoto ! "";
             |ENVIA_FICHERO aFicOrigen, aFicDestino;
         |SINO;
             |COPIA_FICHERO aFicOrigen, aFicDestino;
         |FINSI;
     |FINSI;
|FPRC;

|PROCESO Browse;
     |HAZ Pondsselect;
     aPrograma = eaDirLocal + "dsselect.exe " + eaDirLocal + "dsselect.ini";

     aBorra = eaDirLocal + "dsselect.txt";  |RFBORRA aBorra;
     aBorra = eaDirLocal + "dsselect.ini";  |RFBORRA aBorra;

     aAbre = eaDirLocal + "dsselect.ini";
     |XABRE "CW", aAbre, nHandle;
     |SI FSalida ] 0;
          aLinea = &34 + eaUnidadBasico + "\AEAT\" + &34 + " " + &34 + eaDirLocal + "dsselect.txt" + &34;
          |XGRABA nHandle, aLinea;
     |FINSI;
     |XCIERRA nHandle;

     |RSYSTEM aPrograma;
     |PULSATECLA;

     aRuta = "";
     aAbre = eaDirLocal + "dsselect.txt";
     |XABRE "CU", aAbre, nHandle;
     |SI FSalida ] 0;
         |XLEE nHandle, 250, aRuta;
     |FINSI;
     |XCIERRA nHandle;

     aBorra = eaDirLocal + "dsselect.txt";
     |RFBORRA aBorra;

     |PULSATECLA;

     aAlfa = aRuta;
     aRuta = "";
     aLong = aAlfa % 0;
     nLong = aLong;
     |PARA nCarac = 1;  |SI nCarac [ nLong;  |HACIENDO nCarac = nCarac + 1;
           nPos       = (nCarac * 100) + 1;
           aCaracter  = aAlfa % nPos;
           aRuta      = aRuta      + aCaracter;
           aNombreFic = aNombreFic + aCaracter;

           |SI aCaracter = "/";  |O aCaracter = "\";
               aNombreFic = "";
           |FINSI;
     |SIGUE;

     aNombreRea = aNombreFic < "";

     aAlfa1 = (#rem05000#nCampo# + ".dfp") < "";   |QBT aAlfa1;
     aAlfa2 = aNombreRea;

     |SI aAlfa1 ! aAlfa2;
         |ACABA;
     |FINSI;

     eaOrigen = aRuta;
     eaDestino = eaDirServidor + aNombreFic;
     |HAZ RecibeFichero;
|FPRC;

|PROCESO LeeFichero;
     |PARA nCampoGet = 3;  |SI nCampoGet [ 23;  |HACIENDO nCampoGet = nCampoGet + 4;
           aGet2 = nCampoGet;
           IaGet = aGet1<-;
           |ESPECIFICA "GETDATACONTROL", aGet;
           #rem05000#nCampoGet# = FSalida;
     |SIGUE;

     nCampo1 = nCampo + 3;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |SI aAlfa = "Procesado";
          aAlfa = "0000El borrador ya ha sido procesado.";
          aAlfa = aAlfa + " Si se vuelve a leer se perder n todas las conexiones posibles con los datos de la renta";
          |MENAV aAlfa;
          |CONFI "0000NQuiere leerlo de nuevo";
          |SI FSalida ! 0;  |ACABA;  |FINSI;

          #rem05000#nCampo1# = "Sin leer";   |PINTA #rem05000#nCampo1#;

          |HAZ EnciendeBotones;
     |FINSI;

     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |FBORRA aAbre;

     nCampo1 = nCampo + 2;
     aAlfa   = #rem05000#nCampo1#;  |QBF aAlfa;
     |HAZ Browse;
     |HAZ BorraDatos;

     aAbre = eaDirServidor + #rem05000#nCampo# + ".dfp";  |QBT aAbre;
     |XABRE "E", aAbre, nHandle;
     |SI FSalida ] 0;
         nCampo1   = nCampo + 3;
         #rem05000#nCampo1# = "Procesado";   |PINTA #rem05000#nCampo1#;

         |HAZ CargaDatos;
         |HAZ EnciendeBotones;
     |SINO;
         |MENAV "0000Ha habido algun error en la descarga del borrador. Por favor intentelo de nuevo";
     |FINSI;

     |PULSATECLA;
|FPRC;
