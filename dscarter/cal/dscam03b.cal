|FICHEROS;
     dscam067;
     dscam004,MANTE;
     dscam013;
|FIN;

|VARIABLES;
     &enSwErr = 0;
     &enHayAsto = 0;
     aAlfa = "";
     aMovOrig = "";
     aClv1 = "";
     aClv2 = "";
     aClv3 = "";
     aClv4 = "";
     nCalc5 = 0;
|FINSI;


|PROCESO CheqConta;
      enHayAsto = 0;
      |ABRE #dscam067; |DDEFECTO #dscam067;
      aClv1 = "CB";
      aClv2 = #dscam004#17; aClv2 = (aClv2 + (" " * 50))% 0150;
      aClv3 = #dscam004#3;  aClv3 = (aClv3 + (" " * 50))% 0150;
      aClv4 = "";           aClv4 = (aClv4 + (" " * 50))% 0150;
      |SI #dscam004#5 = "REM";
         |ABRE #dscam013; |SELECT #2#dscam013;
         #dscam013#16 = #dscam004#17;
         #dscam013#17 = #dscam004#3;
         |LEE 000#dscam013.=;
         |SI FSalida ! 0;
            ||MENAV "    No puedo encontrar el vinculo a la linea de remesa";
            |CIERRA #dscam013; |CIERRA #dscam067; |ACABA;
         |FINSI;
         |CIERRA #dscam013;
         aClv1 = "RM";
         aClv2 = #dscam013#0; aClv2 = (aClv2 + (" " * 50))% 0150;
         aClv3 = #dscam013#1; aClv3 = (aClv3 + (" " * 50))% 0150;
         aClv4 = "E"; aClv4 = (aClv4 + (" " * 50))% 0150;
         #dscam067#0 = aClv1;
         #dscam067#1 = aClv2;
         #dscam067#2 = aClv3;
         #dscam067#3 = aClv4;
         |LEE 000#dscam067.];
         |SI FSalida ! 0; |O #dscam067#0 ! aClv1;  |O #dscam067#1 ! aClv2;
          |O #dscam067#2 ! aClv3;  |O #dscam067#3 ! aClv4;
            aClv1 = "RM";
            aClv2 = #dscam013#0; aClv2 = (aClv2 + (" " * 50))% 0150;
            aClv3 = #dscam013#1; aClv3 = (aClv3 + (" " * 50))% 0150;
            aClv4 = "V"; aClv4 = (aClv4 + (" " * 50))% 0150;
         |FINSI;
      |FINSI;
      |SI #dscam004#5 = "EMR";
         |ABRE #dscam013; |SELECT #4#dscam013;
         #dscam013#16 = #dscam004#17;
         #dscam013#24 = #dscam004#3;
         |LEE 000#dscam013.=;
         |SI FSalida ! 0;
            ||MENAV "    No puedo encontrar el vinculo a la linea de remesa";
            |CIERRA #dscam013; |CIERRA #dscam067; |ACABA;
         |FINSI;
         |CIERRA #dscam013;
         aClv1 = "RM";
         aClv2 = #dscam013#0; aClv2 = (aClv2 + (" " * 50))% 0150;
         aClv3 = #dscam013#1; aClv3 = (aClv3 + (" " * 50))% 0150;
         aClv4 = "I"; aClv4 = (aClv4 + (" " * 50))% 0150;
      |FINSI;
      |SI #dscam004#5 = "REC";
         aClv1 = "CB";
         aClv2 = #dscam004#16; |QBF aClv2; aClv2 = aClv2 % -109;
         aMovOrig = ("000000000" + #dscam004#17) % -109;
         |SALVA_FICHA #dscam004;
         #dscam004#17 = aClv2; aClv2 = #dscam004#17;
         #dscam004#3  = 1;
         |LEE 000#dscam004.];
         |PARA; |SI FSalida = 0; |Y #dscam004#17 = aClv2; |HACIENDO;
            |SI #dscam004#5 = "CAC";
               aAlfa = #dscam004#16; |QBF aAlfa;
               aAlfa = aAlfa - aMovOrig;
               |SI FSalida ! 0;
                  aClv3 = #dscam004#3; |SAL;
               |FINSI;
            |FINSI;
            |LEE 000#dscam004.s;
         |SIGUE;
         |REPON_FICHA #dscam004;
         aClv4 = " " * 50;
      |FINSI;
      nCalc5 = aClv2; aClv2 = nCalc5;
      aClv2 = (aClv2 + (" " * 50)) % 0150;
      aClv3 = (aClv3 + (" " * 50)) % 0150;
      #dscam067#0 = aClv1;
      #dscam067#1 = aClv2;
      #dscam067#2 = aClv3;
      #dscam067#3 = aClv4;
      |LEE 000#dscam067.];
      |SI FSalida ! 0; |O #dscam067#0 ! aClv1;  |O #dscam067#1 ! aClv2;
       |O #dscam067#2 ! aClv3;  |O #dscam067#3 ! aClv4;
         |HAZ EsViuda;
         |SI FSalida ! 0;
            ||MENAV "    No se refleja que el movimiento haya sido enlazado a contabilidad";
            |CIERRA #dscam067; |ACABA;
         |SINO;
            |SI #dscam004#5 = "COB"; |O #dscam004#5 = "PAG"; |Y #dscam004#57 = 1;
               |HAZ ConsAstoViuda;
               |SI enSwErr < 0;
                  ||MENAV "    No se refleja que el movimiento haya sido enlazado a contabilidad";
                  |CIERRA #dscam067; |ACABA;
               |FINSI;
            |SINO;
               ||MENAV "    No se refleja que el movimiento haya sido enlazado a contabilidad";
               |CIERRA #dscam067;   |ACABA;
            |FINSI;
         |FINSI;
      |FINSI;
      |CIERRA #dscam067;
      enHayAsto = 1;
|FPRC;
