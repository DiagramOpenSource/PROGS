|FICHEROS;
   dscaz013 #0;
   dscam012 #1;     || remesas cabs.
   dscam013 #2;     || remesas lins.
   dscam003 #3;     || Recibos Venta.
|FIN;

|VARIABLES;
    &nDeci_Base = 0; &nDeci_Div = 0; &Divisa = "";
    &entrada = 1;
    &sw  = 0;
    &swlin = 1;
    &aInforme = "";
    informe = "";
    inform1 = "dsca0131";
    inform2 = "dsca0132";
    &tot1 = 0;
    &tot2 = 0;
|FIN;

|PROCESO mayus;
  #0Campo = #0Campo > " ";
  |PINTA #0Campo;
|FPRC;

|PROCESO lineaspri;
  #dscam003#40 = #dscam013#16;
  |LEE 000#dscam003.=;

  swlin = 1; |PRINT;
|FPRC;

|DEFBUCLE lineas;
 #2#1;
 ;
 #1#0,   1;
 #1#0, 999;
 e;
 NULL, NULL, NULL, NULL, NULL, lineaspri;
 #2#0, #2#6, #2#2, #2#3, #2#4, #2#1;
|FIN;

|PROCESO cabecera;
  |SI #0#8 ! "A";
      |SI #0#8 = "N"; |Y #1#8 ! "N"; |ACABA; |FINSI;
      |SI #0#8 = "S"; |Y #1#8 = "N"; |ACABA; |FINSI; || impresa
  |FINSI;
  |SI #0#9 ! "A";
      |SI #0#9 ! #1#9;  |ACABA;  |FINSI;  || contabilizada
  |FINSI;
  swlin = 0;
  |PRINT;
  |SI #0#10 = "D";
      |BUCLE lineas;
      |SI swlin = 1;
          swlin = 2;
          |PRINT;
      |FINSI;
  |FINSI;
  tot1 = tot1 + #1#10;
  tot2 = tot2 + #1#13;
  sw = 1;
|FPRC;

|DEFBUCLE dscaz013;
 #1#1;
 1, 2, 7;
 #0#0, #0#2, #0#4, #0#6;
 #0#1, #0#3, #0#5, #0#7;
 be;
 NULL, cabecera;
|FIN;

|PROCESO impre; |TIPO 3;
  |IMPRE 0;
  |SI FSalida ! 0;  |ACABA;  |FINSI;
  |SI #0#10 = "D";
      aInforme = "Comprobacion remesas (detalle)"; |HAZ ObtenInforme;
      informe = aInforme;
  |SINO;
      aInforme = "Comprobacion remesas (resumen)"; |HAZ ObtenInforme;
      informe = aInforme;
  |FINSI;

  |INFOR informe
  |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;

  |ABRE #dscam003;
  Divisa = "EUR"; |HAZ TomaDecim; |BUCLE dscaz013;
  |SI sw = 1; |PIEINF; |FINSI;
  |CIERRA #dscam003;

  |FININF; |FINIMP;
|FPRC;
