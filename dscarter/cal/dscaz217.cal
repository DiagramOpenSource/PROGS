|FICHEROS;
     dscaz217 #0;
     dscam040 #40;
     dscam052 #52;
     dscam073 #73;
|FIN;

|VARIABLES;
     aC6 = "";
     aC7 = "";
     aC8 = "";
     aC11 = "";
     &eaInfDefecto = "";
     &aInforme = "";
     &eaImpre = "";
     &eaCliente = "";
     &enCodigo = 0;
     &efFecha = @;

     aAlfa = "";
     &eaCta = "";
     nHay = 0;
|FIN;

|PROCESO Pinta; |TIPO 7;
     |HAZ PintaFormato;
|FPRC;

|PROCESO PintaFormato;
     |ATRI I;
     |SI #0#7 = "1"; |PINTA 1729, "Formato B2B   "; |FINSI;
     |SI #0#7 = "2"; |PINTA 1729, "Formato Basico"; |FINSI;
     |SI #0#7 = "3"; |PINTA 1729, "Formato Nuevo "; |FINSI;
     |ATRI N;
     |PINTA 1811, "컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴";
|FPRC;

|PROCESO Clientes;
     eaCta = (#52#32 % 104) + (#52#33 % 104) + #52#31 + (#52#30 % 110);

     aAlfa = #52#15; |QBF aAlfa;
     aAlfa = aAlfa + "CLI" + #52#0;

     #0#9 = aAlfa;
     #0#10 = #52#217;

     |PRINT;
     |PIEINF;
|FPRC;

|DEFBUCLE Clientes;
     #52#1;
     45, 110, 15;
     #0#0, #0#12, #0#14, #0#16;
     #0#1, #0#13, #0#15, #0#17;
     ;
     NULL, Clientes;
|FIN;

|PROCESO Tipo3; |TIPO 3;
     |SI eaCliente = "";
          Impresora = "CrystalReport";
     |SINO;
          Impresora = eaImpre;
     |FINSI;
     |IMPRE -1;
     |SI FSalida = 0;
          eaInfDefecto = "dscaz217";
          aInforme = "Carta autoriza. domiciliacion"; |HAZ ObtenInforme;

          |SI #0#7 = 3;
               aInforme = "dscnz217";
          |FINSI;

          |INFOR aInforme;
          |SI FSalida = 0;

               |ABRE #73;
               #73#0 = #0#8;
               |LEE 020#73=;
               |CIERRA #73;

               |DDEFECTO #40;
               |ABRE #40;
               #40#0 = #73#8;
               |LEE 000#40=;
               |CIERRA #40;

               |BUCLE Clientes;
               |FININF;
          |FINSI;
          |FINIMP;
     |SINO;
         |MENAV "    Error en Impresora Crystal Report";
     |FINSI;
|FPRC;

|PROGRAMA;
     |SI eaCliente = "";
          |ABRE #0;
          |LEE 101#0p;
          |SI FSalida ! 0; |GRABA 020#0b; |FINSI;
          aC6 = #0#6;
          aC7 = #0#7;
          aC8 = #0#8;
          aC11 = #0#11;
          |DDEFECTO #0;
          #0#6 = aC6;
          #0#7 = aC7;
          #0#8 = aC8;
          #0#11 = aC11;
          |PINPA #0#0;
          |PINDA #0#0;
          |ENDATOS #1#0;
          |SI FSalida = 0; |GRABA 020#0a; |FINSI;
          |CIERRA #0;
     |SINO;
          #0#0 = eaCliente;
          #0#1 = eaCliente;
          #0#2 = efFecha;
          #0#6 = "S";
          #0#7 = 2;
          #0#8 = enCodigo;
          |HAZ Tipo3;
     |FINSI;
|FPRO;
