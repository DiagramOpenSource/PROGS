|FICHEROS;
   dscam021 #0;
   dscam022 #1;
   dscam014 #2;
   dscam008 #3;
   dscaw001 #4,MANTE;
   dscam009 #5;
   dscam051 #6;
   dscam067 #7;
   dscaw013 #13;
   dscam042 #14;

   dscaw102 #15,MANTE;

   camasic@ #100;
|FINSI;

|VARIABLES;
   &TotalSel = 0;
   &eaFichClas = ""; &eaTipoClas = ""; &enSwClas = 0;
   &eaResult   = "";
   &enTipoRec  = 0;
   &enSwLineal = 0;  &enClave = 0;
   &HayGestion = 0;  &HayConta = 0;

   &eaCodigo   = ""; &eaCuenta   = ""; &enSwErr = 0;
   &enNumDocumento = 0;
   &enEmpGestion = 0; &enSwVisado = 0;

   &Divisa = "";   &NombreDiv = ""; &eaMBase = ""; &eaNombreMBase = "";
   &nDeci_Div = 0; &nDeci_Base = 0;
   &CmpDivisa = 0; &CambioDivCm = 0;
   &PosLibro = 0; &PosSerie = 0; &PosFactu = 0; &PosRecib = 0; &enDocum = 0;
   &eaTipoRecibo = ""; &enNumDocum = 0; &eaMensRet = ""; &enSwError = 0; &eaTOperacion = "";

   &eaUsuario = ""; &enImpAnt = 0;  &enImpAct = 0;  &eaDescr = "";
   &eaTipoReg = ""; &eaNumero = ""; &eaTipoOp = ""; &eaLlamada = "";
   &eaFicher = "";  &eaClave = "";

   &eaCliente = ""; &efFechaVto = @; &enDocumento = 0;

   &efFecha      = @;
   &eaEmpContab  = "";
   &eaDirConta   = "";

   aDCodProv = "";
   aHCodProv = "";
   aDCtaProv = "";
   aHCtaProv = "";

   nModo  = 0; nFlag  = 0; nCalc = 0;
   nSwErr = 0;
   aResp = "";
   aCuenta = "";
   nSwErr1 = 0;
   nAutom = 0; SwClave = 0;
   Clave1    = 0;
   Clave2    = 0;
   Clave3    = "";
   aAlfa     = "";
   aAlfa1    = "";
   aAlfa2    = "";
   aAlfa3    = "";
   aAlfa4    = "";
   aAlfa5    = "";
   aAlfa6    = "";
   VtoEnlace = "";
   FechaVto = "";
   VtoAsto = 0;
   Modo1 = "";
   Modo2 = "";

   Codigo = 0;
   Linea  = 0;
   FEstado = 0;
   Flag    = 0;

   &CodProv = "";
   &CtaProv = "";

   ModoEntrada = 0;

   NumDias  = 0;
   nPorcInt = 0;
   nInteres = 0;
   Calc     = 0;
   Calc1    = 0;
   Calc2    = 0;

   LinCob   = 0;
   Comodin  = "";
   Comodin1 = "";

   fFechaVtoAnt = @;

   SwError = 0;
|FIN;

|PROCESO EntregasPdtes;
   nSwErr1 = 1; |ERROR10;
|FPRC;

|DEFBUCLE EntregasPdtes;
#dscam008#5;
14;
aCuenta, 000000001, "e";
aCuenta, 999999999, "e";
;
NULL, EntregasPdtes;
|FIN;

|PROCESO MiraDivisa;
   Divisa = #dscam021#18; |HAZ TomaDecim;
   |SI NombreDiv = "ERROR";
      |MENAV "    Divisa inexistente";
      |ERROR;
      |ACABA;
   |FINSI;
   #dscam021#19 = NombreDiv;   |PINTA #dscam021#19;
   #dscam021#20 = CambioDivCm;
|FPRC;

|PROCESO Contador; |TIPO 7;

   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada ! 1; |ACABA; |FINSI;

   |ABRE #dscam021;
   |LEE 000#dscam021.u;
   |SI FSalida = 0;
      Codigo = #dscam021#0;
      |DDEFECTO #dscam021;
      #dscam021#0 = Codigo + 1;
      |PINTA #dscam021#0;
   |FINSI;
   |CIERRA #dscam021;
|FPRC;

|PROCESO RecogeRec;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI nAutom = 0;
      |SI #dscam051#121 = "N";
         eaCodigo = #dscam008#32; eaCuenta = #dscam008#5; |HAZ MiraSiBloq;
         |SI enSwErr ! 0; |MENAV "    Proveedor bloqueado"; |ERROR; |ACABA; |FINSI;
      |FINSI;

      enNumDocumento = #dscam008#40; |HAZ MiraSiVisado;
      |SI enSwVisado < 0;
         |MENAV "    Factura proveedor no visada, no se permite el pago";
         |ERROR;  SwError = 1; |ACABA;
      |FINSI;

      enSwError = 0;
      eaTOperacion = "C"; eaTipoRecibo = "C"; enNumDocum = #dscam022#13; |HAZ ProcesaTempo;
      |SI enSwError = 1; |ERROR; |ACABA; |FINSI;
   |FINSI;

   |ABRE #dscam008;
   #dscam008#40 = #dscam022#13;
   |LEE 000#dscam008.=;
   |SI FSalida = 0;
      enSwClas   = 1; eaFichClas = "dscam021"; eaTipoClas = #dscam008#12;
      |HAZ CompruebaClas;
      |SI eaFichClas = "ERROR";
         |MENAV "    Documento inoperable en el perfil actual ";
         |CIERRA #dscam008; |ERROR; |ACABA;
      |FINSI;
      |SI eaFichClas = "INFOR";
         |CONFI "    Documento inoperable en el perfil actual. Cambiar Tipo recibo ?";
         |SI FSalida = 0;
            |CIERRA #dscam008;
            eaFichClas = "dscam021";
            enNumDocum = #dscam008#40; enTipoRec = #dscam008#12; |HAZ CambiaTR;
            |ABRE #dscam008; |LEE 000#dscam008.=;
         |SINO;
            |CIERRA #dscam008;
            eaTOperacion = "B"; eaTipoRecibo = "V"; enNumDocum = #dscam008#40; |HAZ ProcesaTempo;
            |ERROR; |ACABA;
         |FINSI;
      |FINSI;

      aCuenta = #dscam008#5;
      nSwErr1 = 0;
      |SALVA_FICHA #dscam008;
      |BUCLE EntregasPdtes;
      |REPON_FICHA #dscam008;
      |SI nSwErr1 = 1;
         aAlfa = "    NEste proveedor tiene entregas a cuenta pendientes de saldar. " + &191 + " Continuar ?";
         |CONFI aAlfa;
         |SI FSalida ! 0;
             |CIERRA #dscam008; |ERROR; |ACABA;
         |FINSI;
      |FINSI;

      |SI CodProv ! ""; |O CtaProv ! "";
         |SI #dscam008#32 ! "      "; |Y CodProv ! "      "; |Y #dscam008#32 ! CodProv;
            |MENAV "    El proveedor del documento marcado no coincide con el de los anteriores";
            |CIERRA #dscam008; |ERROR; |ACABA;
         |FINSI;
         |SI #dscam008#5 ! "            "; |Y CtaProv ! "            "; |Y #dscam008#5 ! CtaProv;
            |MENAV "    El proveedor del documento marcado no coincide con el de los anteriores";
            |CIERRA #dscam008; |ERROR; |ACABA;
         |FINSI;
      |FINSI;

      |SI #dscam051#121 ! "N"; |Y CodProv = "";  || Certificados de contratistas
         eaCliente = #dscam008#32; eaCuenta = #dscam008#5;
         efFechaVto = #dscam021#2;
         enDocumento = #dscam008#40; |HAZ MiraCertContr;
         |SI enSwErr ! 0; |ERROR; |ACABA; |FINSI;
      |FINSI;

      |SI #dscam008#16 ! #dscam021#3; |Y #dscam021#24 = "S";
         |MENAV "    El banco asociado al pago no coincide con el seleccionado";
         |CIERRA #dscam008; |ERROR; |ACABA;
      |FINSI;
      |SI #dscam008#59 ! #dscam021#18;
         |MENAV "    La divisa del efecto no es correcta";
         |CIERRA #dscam008; |ERROR; |ACABA;
      |FINSI;

      |SI #dscam008#14 = "A"; |O #dscam008#14 = "D";
         |SI #dscam008#14 = "A"; |MENAV "    El recibo está agrupado"; |FINSI;
         |SI #dscam008#14 = "D"; |MENAV "    El recibo está dividido"; |FINSI;
         |CIERRA #dscam008; |ERROR; |ACABA;
      |FINSI;

      Divisa = #dscam008#59; |HAZ TomaDecim;
      #dscam022#21 = NombreDiv;
      |SI #dscam008#31 = 0;
         |MENAV "    Recibo liquidado";
         |CIERRA #dscam008; |ERROR; |ACABA;
      |SINO;
         |SI #dscam008#14 = "E"; |Y ModoEntrada = 1;
            |MENAV "    Recibo en cartera";
            |CIERRA #dscam008; |ERROR; |ACABA;
         |SINO;
            #dscam022#2 = #dscam008#27;
            #dscam022#3 = #dscam008#1;
            #dscam022#4 = #dscam008#0;
            #dscam022#5 = #dscam008#2;
            |SI #dscam051#108 = "S";
               #dscam022#6 = #dscam021#2;
            |SINO;
               #dscam022#6 = #dscam008#3;
            |FINSI;
            #dscam022#7 = #dscam008#31;
            #dscam022#8 = #dscam008#5;
            #dscam022#10 = #dscam008#6;
            #dscam022#12 = "N";
            #dscam022#18 = #dscam008#12;
            #dscam022#19 = #dscam008#58;
            #dscam022#20 = #dscam008#59;
            #dscam022#22 = #dscam008#61;
            #dscam022#22 = CambioDivCm;
            #dscam022#37 = #dscam008#63;
         |FINSI;
      |FINSI;
   |SINO;
      |MENAV "    Recibo inexistente";
      |ERROR;
   |FINSI;
   |CIERRA #dscam008;
|FPRC;

|PROCESO EliminaLineas;
   |ABRE #dscam067;
   #dscam067#0 = "PG";
   #dscam067#1 = #dscam009#14;
   #dscam067#2 = #dscam009#3;
   #dscam067#3 = "";
   #dscam067#11 = 1;
   |LEE 000#dscam067.];
   FEstado = FSalida;
   Clave1 = #dscam067#1; Clave2 = #dscam067#2;
   Clave3 = #dscam067#3; |QBF Clave3;
   |SI FEstado = 0; |Y #dscam067#0 = "PG"; |Y Clave1 = #dscam009#14;
   |Y Clave2 = #dscam009#3;
      Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
      |NOME_DAT #13 Comodin;
      |DELINDEX #dscaw013; |ABRE #dscaw013;
      |DDEFECTO #dscaw013;
      #dscaw013#15 = #dscam067#10; #dscaw013#0 = 1;
      #dscaw013#13 = "dscam009";   #dscaw013#14 = 14;
      #dscaw013#11 = "N";          #dscaw013#12 = 9;
      #dscaw013#5  = #dscam009#14;  #dscaw013#6 = #dscam009#14;
      |GRABA 020#dscaw013.n;

      #dscaw013#15 = #dscam067#10; #dscaw013#0 = 2;
      #dscaw013#13 = "dscam009";   #dscaw013#14 = 3;
      #dscaw013#11 = "N";          #dscaw013#12 = 2;
      #dscaw013#5  = #dscam009#3;  #dscaw013#6 = #dscam009#3;
      |GRABA 020#dscaw013.n;

      Comodin = #dscam067#10;
      Comodin = "dscam033.tab;" + Comodin + ",B";
      |LIBERA #dscam008; |CIERRAT #dscam008;
      |LIBERA #dscam009; |CIERRAT #dscam009;
      |LIBERA #dscam021; |CIERRAT #dscam021;
      |LIBERA #dscam022; |CIERRAT #dscam022;
      |SUB_EJECUTA_NP Comodin;
      |ABRET #dscam008; |LEE 101#dscam008.=;
      |ABRET #dscam009; |LEE 101#dscam009.=;
      |ABRET #dscam022; |LEE 101#dscam022.=;
      |ABRET #dscam021; |LEE 101#dscam021.=;
      |CIERRA #dscaw013;

      |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".dat"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ddx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ixx"; |FBORRA aAlfa;
   |FINSI;
   |CIERRA #dscam067;

   |BORRA 020#dscam009.a;
|FPRC;

|DEFBUCLE EliminaLineas;
#dscam009#1;
;
#dscam008#40, 01;
#dscam008#40, 99;
be;
NULL, EliminaLineas;
|FIN;

|PROCESO BorraLin;
   |SI #dscam021#7 ! "N";
     |ABRE #dscam051;
     |LEE 000#dscam051.p;
     |SI FSalida ! 0;
        |DDEFECTO #dscam051;
        |GRABA 000#dscam051.c;
     |FINSI;
     |CIERRA #dscam051;
     |SI #dscam051#1 = "S";
        |ABRE #dscam067;
        #dscam067#8 = 0;
        #dscam067#9 = 0;
        #dscam067#0  = "PA";
        #dscam067#1  = #dscam021#0;
        #dscam067#2  = 1;
        #dscam067#3  = "E";
        #dscam067#11 = 1;
        |LEE 000#dscam067.];
        FEstado = FSalida;
        Clave1 = #dscam067#1;
        Clave2 = #dscam067#2;
        Clave3 = #dscam067#3; |QBF Clave3;
        |PARA; |SI FEstado = 0; |Y #dscam067#0 = "PA"; |Y Clave1 = #dscam021#0; |HACIENDO;
           |SI FEstado = 0; |Y Clave1 = #dscam021#0; |Y Clave3  = "E"; |Y #dscam067#0 = "PA";
              |SAL;
           |FINSI;
           |LEE 000#dscam067.s;
           FEstado = FSalida;
           Clave1 = #dscam067#1; Clave2 = #dscam067#2;
           Clave3 = #dscam067#3; |QBF Clave3;
        |SIGUE;

        |SI FEstado = 0; |Y Clave1 = #dscam021#0; |Y Clave3  = "E"; |Y #dscam067#0 = "PA";
           Comodin1 = Usuario; |QBF Comodin1; Comodin1 = "ac" + Comodin1;
           |NOME_DAT #13 Comodin1;
           |DELINDEX #dscaw013; |ABRE #dscaw013;
           |DDEFECTO #dscaw013;
           #dscaw013#15 = #dscam067#10;  #dscaw013#0 = 1;
           #dscaw013#13 = "dscam022"; #dscaw013#14 = 0;
           #dscaw013#11 = "N";        #dscaw013#12 = 5;
           #dscaw013#5  = #dscam021#0;#dscaw013#6 = #dscam021#0;
           |GRABA 020#dscaw013.n;
           Comodin = #dscam067#10;
           Comodin = "dscam033.tab;" + Comodin + ",B,E";
           |LIBERA #dscam067; |CIERRAT #dscam067;
           |LIBERA #dscam021; |CIERRAT #dscam021;
           |LIBERA #dscam022; |CIERRAT #dscam022;
           |SUB_EJECUTA_NP Comodin;
           |ABRET #dscam021; |LEE 101#dscam021.=;
           |ABRET #dscam022; |LEE 101#dscam022.=;

           |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".dat"; |FBORRA aAlfa;
           |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ddx"; |FBORRA aAlfa;
           |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ixx"; |FBORRA aAlfa;

           |ABRET #dscam067; |LEE 000#dscam067.=;
        |SINO;
           |LEE 000#dscam067.s;
        |FINSI;
        |PARA; |SI FSalida = 0; |HACIENDO;
           aAlfa  = #dscam067#0; |QBF aAlfa;
           Clave1 = #dscam067#1;
           Clave3 = #dscam067#3; |QBF Clave3;
           |SI aAlfa = "PA"; |Y Clave1 = #dscam021#0; |Y Clave3  = "E";
              |BORRA 020#dscam067.a;
           |SINO;
              |SAL;
           |FINSI;
           |LEE 000#dscam067.s;
        |SIGUE;
        |CIERRA #dscam067;
     |SINO;
        |MENAV "    Ha modificado un efecto contabilizado. Debera volver a ejecutar el enlace ";
     |FINSI;
   |FINSI;

   |SI #dscam021#8 = "S";
      |ABRE #dscam009;
      #dscam009#14 = #dscam022#13;
      #dscam009#3  = #dscam022#14;
      |LEE 101#dscam009.=;
      |SI FSalida = 0;
         |ABRE #dscam051;
         |LEE 000#dscam051.p;
         |SI FSalida ! 0;
            |DDEFECTO #dscam051;
            |GRABA 000#dscam051.c;
         |FINSI;
         |CIERRA #dscam051;
         |SI #dscam051#1 = "S";
            |ABRE #dscam067;
            #dscam067#8 = 0;
            #dscam067#9 = 0;
            #dscam067#0 = "PA";
            #dscam067#1 = #dscam021#0;
            #dscam067#2 = 1;
            #dscam067#3 = "V";
            #dscam067#11 = 1;
            |LEE 000#dscam067.];
            FEstado = FSalida;
            Clave1 = #dscam067#1; Clave2 = #dscam067#2;
            Clave3 = #dscam067#3; |QBF Clave3;
            |PARA; |SI FEstado = 0; |Y #dscam067#0 = "PA"; |Y Clave1 = #dscam021#0; |HACIENDO;
               |SI FEstado = 0; |Y Clave1 = #dscam021#0; |Y Clave3  = "V"; |Y #dscam067#0 = "PA";
                  |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
               FEstado = FSalida;
               Clave1 = #dscam067#1; Clave2 = #dscam067#2;
               Clave3 = #dscam067#3; |QBF Clave3;
            |SIGUE;

            |SI FEstado = 0; |Y Clave1 = #dscam021#0; |Y Clave3  = "V"; |Y #dscam067#0 = "PA";
               Comodin = Usuario; |QBF Comodin; Comodin = "ac" + Comodin;
               |NOME_DAT #13 Comodin;
               |DELINDEX #dscaw013; |ABRE #dscaw013;
               VtoEnlace = #dscam067#10; VtoAsto   = #dscam067#6;
               FechaVto  = #dscam067#5;

               |DDEFECTO #dscaw013;
               #dscaw013#15 = VtoEnlace;  #dscaw013#0  = 1;
               #dscaw013#13 = "dscam022";    #dscaw013#14 = 0;
               #dscaw013#11 = "N";           #dscaw013#12 = 5;
               #dscaw013#5 = #dscam021#0;    #dscaw013#6 = #dscam021#0;
               |GRABA 020#dscaw013.n;
               Comodin = VtoEnlace;
               Comodin = "dscam033.tab;" + Comodin + ",B,V" + FechaVto;
               |LIBERA #dscam021; |CIERRAT #dscam021;
               |LIBERA #dscam022; |CIERRAT #dscam022;
               |SUB_EJECUTA_NP Comodin;
               |ABRET #dscam021; |LEE 101#dscam021.=;
               |ABRET #dscam022; |LEE 101#dscam022.=;

               |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".dat"; |FBORRA aAlfa;
               |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ddx"; |FBORRA aAlfa;
               |DFICE aAlfa; |QBF aAlfa; aAlfa = "ac" + Usuario + ".ixx"; |FBORRA aAlfa;
            |FINSI;
            |LEE 000#dscam067.s;
            |PARA; |SI FSalida = 0; |HACIENDO;
               aAlfa = #dscam067#0; |QBF aAlfa;
               Clave1 = #dscam067#1;
               Clave3 = #dscam067#3; |QBF Clave3;
               |SI aAlfa = "PA"; |Y Clave1 = #dscam021#0; |Y Clave3  = "V";
                  |BORRA 020#dscam067.a;
               |SINO;
                  |SAL;
               |FINSI;
               |LEE 000#dscam067.s;
            |SIGUE;
            |CIERRA #dscam067;
         |SINO;
            |MENAV "    Ha modificado un efecto contabilizado. Debera volver a ejecutar el enlace ";
         |FINSI;
         |BORRA 020#dscam009.a;
      |FINSI;
      |LIBERA #dscam009; |CIERRA #dscam009;
      #dscam022#12 = "N"; |GRABA 020#dscam022.a;
   |FINSI;

   #dscam008#40 = #dscam022#13;
   |LEE 101#dscam008.=;
   |SI FSalida = 0;
      |SI ModoEntrada = 3;
         #dscam008#17 = "00000"; #dscam008#37 = 0; #dscam008#39 = ""; #dscam008#47 = "";
         #dscam008#73 = "01.01.0000";
      |FINSI;
      #dscam008#26 = "";
      |SI #dscam021#8 = "S";
         #dscam008#23 = #dscam008#23 - #dscam022#7;  #dscam008#57 = #dscam008#57 - #dscam022#19;
         |SI #dscam008#74 = "N";
            #dscam008#31 = #dscam008#25 - #dscam008#23; #dscam008#58 = #dscam008#56 - #dscam008#57;
         |FINSI;
      |FINSI;
      |SI #dscam008#23 = 0;
         |SI #dscam008#74 = "N";
            #dscam008#14 = "P";
            #dscam008#15 = "Pendiente de pago";
         |SINO;
            #dscam008#14 = "p";
            #dscam008#15 = "Entrega pendiente de pago";
         |FINSI;
      |SINO;
         |SI #dscam008#31 = 0;
            |SI #dscam008#74 = "N";
               #dscam008#14 = "L";
               #dscam008#15 = "Recibo liquidado";
            |SINO;
               #dscam008#14 = "L";
               #dscam008#15 = "Entrega compensada";
            |FINSI;
         |SINO;
            |SI #dscam008#74 = "N";
               #dscam008#14 = "C";
               #dscam008#15 = "Parcialmente pagado";
            |SINO;
               #dscam008#14 = "C";
               #dscam008#15 = "Entrega parcialmente compensada";
            |FINSI;
         |FINSI;
      |FINSI;
      |SI #dscam008#17 ! 0; |Y ModoEntrada ! 3;
         #dscam008#14 = "E";
         |SI #dscam008#39 = "P"; #dscam008#15 = "Englobado en pagare  "; |FINSI;
         |SI #dscam008#39 = "C"; #dscam008#15 = "Englobado en confirme"; |FINSI;
         |SI #dscam008#39 = "T"; #dscam008#15 = "Englobado en talon   "; |FINSI;
      |FINSI;
      |GRABA 020#dscam008.a;
   |FINSI;
   |LIBERA #dscam008;

   |SI ModoEntrada = 3;
      || Doy de baja las entregas a cuenta en caso de que haya en las lineas
      #dscam008#40 = #dscam022#13;
      |LEE 101#dscam008.=;
      |SI FSalida = 0; |Y #dscam008#74 = "S";
         |BUCLE EliminaLineas;
         |BORRA 020#dscam008.a;
      |FINSI;
      |LIBERA #dscam008;

      |BORRA 020#dscam022.a;
      |ABRE #dscam067;
      #dscam067#8 = 0;
      #dscam067#9 = 0;
      #dscam067#0 = "PA";
      #dscam067#1 = #dscam022#0;
      #dscam067#2 = #dscam022#1;
      |LEE 101#dscam067.];
      FEstado = FSalida;
      aAlfa3 = #dscam067#1; |QBF aAlfa3;
      aAlfa4 = #dscam022#0; |QBF aAlfa4;
      aAlfa5 = #dscam067#2; |QBF aAlfa5;
      aAlfa6 = #dscam022#1; |QBF aAlfa6;
      |SI FEstado = 0; |Y #dscam067#0 = "PA"; |Y aAlfa3 = aAlfa4;
       |Y aAlfa5 = aAlfa6;
          |PARA; |SI FEstado = 0; |Y #dscam067#0 = "PA"; |Y aAlfa3 = aAlfa4;
           |Y aAlfa5 = aAlfa6; |HACIENDO;
              |BORRA 020#dscam067.a; |LIBERA #dscam067;
              |LEE 101#dscam067.s;
              FEstado = FSalida;
              aAlfa3 = #dscam067#1; |QBF aAlfa3;
              aAlfa4 = #dscam022#0; |QBF aAlfa4;
              aAlfa5 = #dscam067#2; |QBF aAlfa5;
              aAlfa6 = #dscam022#1; |QBF aAlfa6;
          |SIGUE;
      |FINSI;
      |LIBERA #dscam067;
      |CIERRA #dscam067;
   |FINSI;
/*
   |SI #dscam022#12 = "N";
      |ABRE #dscam014;
      #dscam014#0 = #dscam021#2;
      |LEE 101#dscam014.=;
      |SI FSalida = 0;
         #dscam014#13 = #dscam014#13 - #dscam022#7;
         |GRABA 020#dscam014.a; |LIBERA #dscam014;
      |FINSI;
      |CIERRA #dscam014;
   |FINSI;
*/
|FPRC;

|DEFBUCLE BorraLin;
#dscam022#1;
;
#dscam021#0,001;
#dscam021#0,999;
be;
NULL,BorraLin;
|FIN;

|PROCESO BuscaLin;
   |SI #dscam022#12 = "S";
      SwError = 1;
      |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE BuscaLin;
#dscam022#1;
;
#dscam021#0,001;
#dscam021#0,999;
;
NULL,BuscaLin;
|FIN;

|PROCESO Baja; |TIPO 1;
   ModoEntrada = (FEntrada / 100) ! 0;
   Flag = 0 +. 1;

   |SI ModoEntrada = 2;
      |SI #dscam021#7 ! "N"; |O #dscam021#8 = "S";
         |ABRE #dscam051;
         |LEE 000#dscam051.p;
         |SI FSalida ! 0;
            |DDEFECTO #dscam051;
            |GRABA 000#dscam051.c;
         |FINSI;
         |CIERRA #dscam051;
         |SI #dscam051#1 = "N";
            |CONFI "    NVa a modificar un pagare ya emitido/contabilizado. ¨ Continuar ?";
         |SINO;
            |PUSHV 0820 1460;
            |BLANCO 0820 1460;
            |CUADRO 0921 1359;
            |ATRI R; |PINTA 1022, "Pagare ya emitido o contabilizado. Si"; |ATRI N;
            |ATRI R; |PINTA 1122, "continua se modificaran los asientos "; |ATRI N;
            |ATRI R; |PINTA 1222, "en contabilidad. ¨ Continuar ?       "; |ATRI N;
            E_sup = 1;
            E_inf = "";
            aResp = 1253 ? 1; aResp = aResp > aResp;
            |POPV;
            |SI aResp = "S";
               FSalida = 0;
            |SINO;
               FSalida = 1;
            |FINSI;
         |FINSI;
         |SI FSalida ! 0; |ERROR; |ACABA; |FINSI;

         |HAZ BuscaCierre;
         |SI nSwErr ! 0;
            |MENAV "    La empresa contable esta cerrada. No se puede modificar";
            |ERROR; |ACABA;
         |FINSI;

         eaUsuario = Usuario % 0810;
         eaDescr   = "MODIFICACION PAGARE (" + (("00000" + #dscam021#0) % -105) + ")";
         eaTipoReg = "PA";  eaNumero = ("00000" + #dscam021#0) % -105;
         eaTipoOp  = "M";   enImpAnt = #dscam021#9; enImpAct = 0;
         eaFicher = "dscam021"; eaClave = #dscam021#0;
         |HAZ GrabaAudit;
         |ABRE #dscam008; |ABRE #dscam022;
         eaLlamada = "A"; |BUCLE BorraLin;
         |CIERRA #dscam008; |CIERRA #dscam022;
         #dscam021#7 = "N"; |PINTA #dscam021#7;
         #dscam021#8 = "N"; |PINTA #dscam021#8;
         |GRABA 020#dscam021.a;
      |FINSI;
      eaUsuario = Usuario % 0810;
      eaTipoReg = "PA";  eaNumero = ("00000" + #dscam021#0) % -105;
      eaTipoOp  = "M";   enImpAnt = #dscam021#9;
      eaDescr   = "MODIFICACION PAGARE (" + (("00000" + #dscam021#0) % -105) + ")";
      eaFicher = "dscam021"; eaClave = #dscam021#0;
      |HAZ GrabaAudit;
   |FINSI;

   |SI ModoEntrada = 3;
      eaUsuario = Usuario % 0810;
      eaDescr   = "BAJA PAGARE (" + (("00000" + #dscam021#0) % -105) + ")";
      eaTipoReg = "PA";  eaNumero = ("00000" + #dscam021#0) % -105;
      eaTipoOp  = "B";   enImpAnt = #dscam021#9; enImpAct = 0;
      eaFicher = "dscam021"; eaClave = #dscam021#0;
      |HAZ GrabaAudit;

      |ABRE #dscam008;
      |ABRE #dscam022;
      SwError = 0; |BUCLE BuscaLin;
      |SI SwError = 0;
         eaLlamada = "A"; |BUCLE BorraLin;
      |FINSI;
      |CIERRA #dscam022;
      |CIERRA #dscam008;

      |SI SwError = 1;
         |MENAV "    Hay vencimientos ya contabilizados. No se dara de baja la ficha";
         |ERROR;
         |ACABA;
      |FINSI;

   |FINSI;
|FPRC;

|PROCESO Total; |TIPO 2;

   ModoEntrada = (FEntrada /100) ! 0; nFlag = 0 +. 1;
   |SI ModoEntrada = 1;
      eaUsuario = Usuario % 0810;
      eaTipoReg = "PA";  eaNumero = ("00000" + #dscam021#0) % -105;
      eaTipoOp  = "A";   enImpAnt = #dscam021#9; enImpAct = #dscam021#9 + #dscam022#7;
      eaDescr   = "ALTA LINEA PAGARE (" + (("00000" + #dscam021#0) % -105) + "/" + (("000" + #dscam022#1)% -103) + ")";
      eaFicher = "dscam022"; eaClave = #dscam022#0 + "/" + #dscam022#1;
      |HAZ GrabaAudit;
   |FINSI;

   |ABRE #dscam008;
   |ABRE #dscam009;
   #dscam008#40 = #dscam022#13;
   |LEE 110#dscam008.=;
   |SI FSalida = 0;
      |SI ModoEntrada = 1; nModo = 1; |FINSI;
      |SI ModoEntrada = 3; nModo = 3; |FINSI;
      |SI ModoEntrada = 2; |Y nFlag < 0; nModo = 3; |FINSI;
      |SI ModoEntrada = 2; |Y nFlag > 0; nModo = 1; |FINSI;
      |SI nModo = 3;
         #dscam009#14 = #dscam022#13;
         #dscam009#3  = #dscam022#14;
         |LEE 101#dscam009.=;
         |SI FSalida = 0;
            |BORRA 020#dscam009.a;
         |FINSI;
         |LIBERA #dscam009;

         #dscam008#17 = "00000";
         #dscam008#37 = 0;
         #dscam008#39 = "";
         #dscam008#47 = "";
         #dscam008#26 = "";
         #dscam008#73 = "01.01.0000";
         |SI #dscam021#7 ! "N";
            #dscam008#23 = #dscam008#23 - #dscam022#7;
            #dscam008#57 = #dscam008#57 - #dscam022#19;
            #dscam008#31 = #dscam008#22 - #dscam008#23;
            #dscam008#58 = #dscam008#53 - #dscam008#57;
         |FINSI;
         |SI #dscam008#23 = 0;
            #dscam008#14 = "P";
            #dscam008#15 = "Pendiente de pago";
         |SINO;
            |SI #dscam008#31 = 0;
               #dscam008#14 = "L";
               #dscam008#15 = "Recibo liquidado";
            |SINO;
               #dscam008#14 = "C";
               #dscam008#15 = "Parcialmente pagado";
            |FINSI;
         |FINSI;
         |GRABA 020#dscam008.a;
      |SINO;
         |SI #dscam051#108 = "S"; #dscam008#73 = #dscam021#2; |FINSI;
         #dscam008#17 = #dscam022#0;
         #dscam008#37 = #dscam022#1;
         #dscam008#39 = "P";
         #dscam008#47 = "Pagare";
         |SI #dscam051#71 = "C";
             |SI #dscam051#72 = "E"; #dscam008#26 = #dscam021#1; |FINSI;
             |SI #dscam051#72 = "V"; #dscam008#26 = #dscam021#2; |FINSI;
             |SI #dscam051#72 = " "; #dscam008#26 = ~;           |FINSI;
         |FINSI;
         #dscam008#14 = "E";
         #dscam008#15 = "Englobado en pagare";
         |SI #dscam051#108 = "S"; #dscam008#73 = #dscam021#2; |FINSI;
         |SI #dscam051#110 = "S";
            #dscam008#16 = #dscam021#3; #dscam008#52 = #dscam021#4;
         |FINSI;
         |GRABA 020#dscam008.a;
      |FINSI;
   |FINSI;
   |LIBERA #dscam009;
   |CIERRA #dscam009;
   |LIBERA #dscam008;
   |CIERRA #dscam008;

   #dscam021#5  = #dscam021#5 +. 1;
   #dscam021#9  = #dscam021#9 +. #dscam022#7;
   #dscam021#17 = #dscam021#9 * #dscam021#20;
   |SI #dscam022#6 < #dscam021#1;
      #dscam021#13 = #dscam021#13 +. #dscam022#7;
   |FINSI;
   |PINTA #dscam021#5;
   |PINTA #dscam021#9;
   |PINTA #dscam021#13;
   |SI #dscam021#9 = 0;
      CodProv = ""; CtaProv = "";
   |SINO;
      |SI CodProv = ""; |Y CtaProv = "";
         CodProv = #dscam008#32; CtaProv = #dscam008#5;
      |FINSI;
   |FINSI;

|FPRC;

|PROCESO RellenaTempo;
   |SI #dscam008#14 ! "P"; |Y #dscam008#14 ! "C"; |ACABA; |FINSI;
   |SI #dscam008#16 ! #dscam021#3; |Y #dscam021#24 = "S"; |ACABA; |FINSI;

   enNumDocumento = #dscam008#40;
   enEmpGestion = #dscam008#46; |HAZ MiraSiVisado;
   |SI enSwVisado < 0; |ERROR; |ACABA; |FINSI;

   enSwClas   = 1; eaFichClas = "dscam021"; eaTipoClas = #dscam008#12;
   |HAZ CompruebaClas;
   |SI eaFichClas = "ERROR"; |ACABA; |FINSI;

   |DDEFECTO #dscaw001;
   Divisa = #dscam008#59; |HAZ TomaDecim;

   #dscaw001#0 = Linea;
   Linea = Linea + 1;
   #dscaw001#1 = #dscam008#27;
   #dscaw001#2 = #dscam008#0;
   #dscaw001#3 = #dscam008#1;
   #dscaw001#4 = #dscam008#2;
   #dscaw001#5 = #dscam008#3;
   #dscaw001#6 = #dscam008#31;
   #dscaw001#7 = " ";
   #dscaw001#8 = #dscam008#40;
   #dscaw001#9 = #dscam008#59;
   #dscaw001#10 = #dscam008#5;
   #dscaw001#11 = #dscam008#32;
   #dscaw001#12 = #dscam008#6;
   #dscaw001#14 = #dscam008#35;
   #dscaw001#15 = #dscam008#36;
   |GRABA 010#dscaw001.n;
|FPRC;

|DEFBUCLE RellenaTempo;
#dscam008#2;
59, 32, 5;
00,"     ",000000,000,#dscam021#18, aDCodProv, aDCtaProv;
99,"zzzzz",999999,999,#dscam021#18, aHCodProv, aHCtaProv;
;
NULL,RellenaTempo;
|FIN;

|RUTINA inf;
   #dscaw001#0 = 1;
   #dscaw001#10 = "";
   #dscaw001#11 = "";
|FRUT;

|RUTINA sup;
   #dscaw001#0 = 99999;
   #dscaw001#10 = "zzzzzzzzzzzz";
   #dscaw001#11 = "zzzzzz";
|FRUT;

|PROCESO VuelcaRecibos;
   |ABRE #dscam008;
   #dscam008#40 = #dscaw001#8;
   |LEE 000#dscam008.=;
   |CIERRA #dscam008;

   |DDEFECTO #dscam022;
   #dscam022#0 = #dscam021#0;
   #dscam022#1 = Linea;         Linea = Linea + 1;
   #dscam022#2 = #dscaw001#1;
   #dscam022#4 = #dscaw001#2;
   #dscam022#3 = #dscaw001#3;
   #dscam022#5 = #dscaw001#4;
   #dscam022#6 = #dscaw001#5;
   #dscam022#13 = #dscaw001#8;

   |SI #dscam051#121 = "N";
      eaCodigo = #dscam008#32; eaCuenta = #dscam008#5; |HAZ MiraSiBloq;
      |SI enSwErr ! 0; |MENAV "    Proveedor bloqueado"; |ERROR; |ACABA; |FINSI;
   |SINO;
      eaCliente = #dscam008#32; eaCuenta = #dscam008#5;
      efFechaVto = #dscam021#2;
      enDocumento = #dscam008#40; |HAZ MiraCertContr;
      |SI enSwErr ! 0; |ERROR; |ACABA; |FINSI;
   |FINSI;

   |HAZ RecogeRec;
   |GRABA 020#dscam022.n;
   |LEE 000#dscam022.=;
   |HAZ Total;

   eaTOperacion = "B"; eaTipoRecibo = "C"; enNumDocum = #dscam022#13; |HAZ ProcesaTempo;
|FPRC;

|DEFBUCLE VuelcaRecibos;
#dscaw001#1;
7;
00001,"*";
99999,"*";
;
NULL,VuelcaRecibos;
|FIN;

|RUTINA inf01a;
   #dscaw001#0 = 1;
   #dscaw001#10 = "";
   #dscaw001#11 = "";
|FRUT;

|RUTINA sup01a;
   #dscaw001#0 = 99999;
   #dscaw001#10 = "zzzzzzzzzzzz";
   #dscaw001#11 = "zzzzzz";
|FRUT;

|RUTINA inf01b;
   #dscaw001#0 = 1;
   #dscaw001#5 = "01.01.0000";
|FRUT;

|RUTINA sup01b;
   #dscaw001#0 = 99999;
   #dscaw001#5 = "31.12.9999";
|FRUT;

|PROCESO PagAut;
   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   nAutom = 0;
   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 1;
      Linea = 1;
      TotalSel = 0;
      |CONFI "0400N Seleccion automatica ?";
      |SI FSalida = 0;
         #dscaw102#0 = #dscam051#100;
         |PUSHV 0501 2380;
         |DDEFECTO #dscaw102;
         |PINPA #0#dscaw102; |PINDA #0#dscaw102;
         |ENDATOS #1#dscaw102;
         FEstado = FSalida;
         |POPV;
         |SI FEstado = 0;
            |SI #dscaw102#0 = "G";
               aDCodProv = #dscaw102#1;    aHCodProv = #dscaw102#1;
               aDCtaProv = "            "; aHCtaProv = "zzzzzzzzzzzz";
            |SINO;
               aDCodProv = "      ";       aHCodProv = "zzzzzz";
               aDCtaProv = #dscaw102#2;    aHCtaProv = #dscaw102#2;

               aCuenta = #dscaw102#2;
               nSwErr1 = 0;
               |SALVA_FICHA #dscam008;
               |BUCLE EntregasPdtes;
               |REPON_FICHA #dscam008;
               |SI nSwErr1 = 1;
                  aAlfa = "    NEste proveedor tiene entregas a cuenta pendientes de saldar. " + &191 + " Continuar ?";
                  |CONFI aAlfa;
                  |SI FSalida ! 0; |PTEC 807; |ACABA; |FINSI;
               |FINSI;
            |FINSI;
            nAutom = 1;
            Comodin = "pg" + Usuario; |NOME_DAT #4 Comodin;
            |DELINDEX #dscaw001;
            |ABRE #dscaw001;
            |ABRE #dscam022;
            Linea = 1; CmpDivisa = 9;
            eaTipoRecibo = "C";
            |BUCLE RellenaTempo;
            |PUSHV 05012380;
            |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809;
            |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809; |PTEC 809;
            |PTEC 814;
            enSwLineal = 1; enClave = 1; CodProv = ""; CtaProv = "";
            |PARA; |SI enSwLineal ! 0; |HACIENDO;
               |SI enClave = 1; enSwLineal = 0; |ENTLINEAL #2#dscaw001,-3,4,17,1,inf01a,sup01a; |FINSI;
               |SI enClave = 2; enSwLineal = 0; |ENTLINEAL #3#dscaw001,-2,4,17,1,inf01b,sup01b; |FINSI;
            |SIGUE;
            FEstado = FSalida;
            |POPV;
            CmpDivisa = 20;
            |SI FEstado = 0;
               Linea = 1;
               |BUCLE VuelcaRecibos;
            |FINSI;
            |CIERRA #dscam022;
            |CIERRA #dscaw001;
            nAutom = 0;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Decimales; |TIPO 13;
   Divisa = #dscaw001#9; |HAZ Tipo13;
|FPRC;

|PROCESO Decim1; |TIPO 13;
   |ABRE #dscam022;
   #dscam022#0 = #dscam021#0;
   #dscam022#1 = 1;
   |LEE 000#dscam022.];
   |SI FSalida = 0; |Y #dscam022#0 = #dscam021#0;
      |PINDA #0#dscam022;
   |FINSI;
   |CIERRA #dscam022;

   fFechaVtoAnt = #dscam021#2;

   Divisa = #dscam021#18; |HAZ Tipo13;
|FPRC;

|PROCESO Busca;
   |SI FSalida = 10;
      PosLibro = 1416; PosSerie = 1419; PosFactu = 1425; PosRecib = 1432;
      |HAZ ConsultaCompras;
      |SI enDocum ! -1;
         #dscam022#13 = enDocum; |PINTA #dscam022#13;
      |SINO;
         |MENAV "    Ficha inexistente"; |ERROR;
      |FINSI;
      SwClave = 1;
   |FINSI;
|FPRC;

|PROCESO CambiaVtoLins;
   #dscam008#40 = #dscam022#13;
   |LEE 101#dscam008.=;
   |SI FSalida = 0;
      #dscam008#73 = #dscam021#2;
      |GRABA 020#dscam008.a;
   |FINSI;
   #dscam022#6 = #dscam021#2;
   |GRABA 020#dscam022.a;
|FPRC;

|DEFBUCLE CambiaVtoLins;
#dscam022#1;
;
#dscam021#0, 001;
#dscam021#0, 999;
be;
NULL, CambiaVtoLins;
|FIN;

|PROCESO InitVars; |TIPO 3;
   CodProv = ""; CtaProv = "";
   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscam051;
      |GRABA 000#dscam051.c;
   |FINSI;
   |CIERRA #dscam051;
   #dscam021#24 = #dscam051#63;

   |SI #dscam021#2 ! fFechaVtoAnt; |Y #dscam051#108 = "S";
      |ABRE #dscam008;
      |BUCLE CambiaVtoLins;
      |CIERRA #dscam008;
   |FINSI;
|FPRC;

|PROCESO TomaMBase;
   |HAZ TomaDecim;
   #dscam021#18 = eaMBase;       |PINTA #dscam021#18;
   #dscam021#19 = eaNombreMBase; |PINTA #dscam021#19;

   ModoEntrada = (FEntrada / 100) ! 0;
   |SI ModoEntrada = 2; |Y #dscam021#5 = 1;
      #dscam022#0 = #dscam021#0;
      #dscam022#1 = 1;
      |LEE 000#dscam022.=;
      |SI FSalida = 0;
         #dscam008#40 = #dscam022#13;
         |LEE 000#dscam008.=;
         |SI FSalida = 0;
            |SI #dscam008#74 = "S";
               |MENAV "    Imposible retocar un pagare de una entrega a cuenta. Proceso cancelado.";
               |ERROR;
            |FINSI;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO BuscaCierre;
   |DFICB aAlfa; |QBF aAlfa;
   |PATH_DAT #14 aAlfa;
   aAlfa = "";

   |ABRE #dscam067; |ABRE #dscam042;
   #dscam067#0  = "PA";
   #dscam067#1  = #dscam021#0;
   #dscam067#2  = 1;
   #dscam067#3  = "E";
   #dscam067#11 = 1;
   |LEE 000#dscam067.];
   aAlfa2 = #dscam067#3; |QBF aAlfa2;
   |SI FSalida = 0; |Y #dscam067#0  = "PA"; |Y #dscam067#1  = #dscam021#0;
    |Y #dscam067#2  = 1; |Y aAlfa2 = "E"; |Y #dscam067#11 = 1;
      #dscam042#0 = #dscam067#8;
      #dscam042#1 = #dscam067#9;
      |LEE 000#dscam042.=;
      |SI FSalida = 0;
         aAlfa = #dscam042#2; |QBF aAlfa;
      |FINSI;
   |SINO;
      #dscam067#0  = "PA";
      #dscam067#1  = #dscam021#0;
      #dscam067#2  = 1;
      #dscam067#3  = "V";
      #dscam067#11 = 1;
      |LEE 000#dscam067.];
      aAlfa2 = #dscam067#3; |QBF aAlfa2;
      |SI FSalida = 0; |Y #dscam067#0  = "PA"; |Y #dscam067#1  = #dscam021#0;
       |Y #dscam067#2  = 1; |Y aAlfa2 = "V"; |Y #dscam067#11 = 1;
         #dscam042#0 = #dscam067#8;
         #dscam042#1 = #dscam067#9;
         |LEE 000#dscam042.=;
         |SI FSalida = 0;
            aAlfa = #dscam042#2; |QBF aAlfa;
         |FINSI;
      |FINSI;
   |FINSI;
   |CIERRA #dscam067; |CIERRA #dscam042;

   |SI aAlfa = "";
      |MENAV "    El pagare debia tener movimientos contables, pero no se han encontrado";
      |ACABA;
   |FINSI;

   enSwError   = 0;
   eaDirConta  = aAlfa; |QBF eaDirConta;
   eaEmpContab = (("00000" + #dscam042#0) % -105) + #dscam042#1;
   |HAZ CompruebaEmpContable;
   |SI enSwError < 0; |Y enSwError > -3;
      nSwErr = -1;
   |SINO;
      nSwErr = 0;
   |FINSI;
|FPRC;

|PROCESO MiraCertif;
   nCalc = (FEntrada / 100) ! 0;

   |SI nCalc = 2;
      #dscam022#0 = #dscam021#0;
      #dscam022#1 = 1;
      |LEE 000#dscam022.];
      |SI FSalida = 0; |Y #dscam022#0 = #dscam021#0;
         |ABRE #dscam008;
         #dscam008#40 = #dscam022#13;
         |LEE 000#dscam008.=;
         |SI FSalida = 0;
            eaCliente = #dscam008#32; efFechaVto = #dscam021#2;
            enDocumento = #dscam008#40;
            |HAZ MiraCertContr;
         |FINSI;
         |CIERRA #dscam008;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO MiraFecha;
   |SI Campo = 2;
      |SI #dscam021#2 < #dscam021#1; |Y FSalida ! 2;
         |MENAV "    La fecha de vencimiento no puede ser menor a la fecha del pagare";
         |ERROR;
      |FINSI;
   |SINO;
      |SI #dscam021#2 < #dscam021#1; |Y FSalida ! 0;
         |MENAV "    La fecha de vencimiento no puede ser menor a la fecha del pagare";
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO RecibosPag;
   #dscam008#40 = #dscam022#13;
   |LEE 101#dscam008.=;
   |SI FSalida = 0;
      |SI #dscam051#110 = "S"; |Y #dscam008#16 ! #dscam021#3;
         #dscam008#16 = #dscam021#3; #dscam008#52 = #dscam021#4;
         |GRABA 020#dscam008.a;
      |FINSI;
      |LIBERA #dscam008;
   |FINSI;
|FPRC;

|DEFBUCLE RecibosPag;
#dscam022#1;
;
#dscam021#0, 001;
#dscam021#0, 999;
;
NULL, RecibosPag;
|FIN;

|PROCESO CambioBanco;
   |ABRE #dscam008;
   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscam051;
      |GRABA 000#dscam051.c;
   |FINSI;
   |CIERRA #dscam051;
   |BUCLE RecibosPag;
   |CIERRA #dscam008;

   |ABRE #dscam014;
   #dscam014#0 = #dscam021#3;
   |LEE 000#dscam014.=;
   |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;
   |CIERRA #dscam014;
   #dscam021#4 = #dscam014#1; |PINTA #dscam021#4;
|FPRC;
