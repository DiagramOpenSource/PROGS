|FICHEROS;
   dscaz029 #0;
   dscam003 #1;

   dscam058 #2;
   dscam051 #3;
   dscam052 #52;
   Referen@ #100;

   &agif024@ #7;
   &caclipr@ #11;
   &canempr@ #12;

   dscaw180 #100;

   RefBucle@ #1000;
|FIN;

|VARIABLES;
   &eaFichClas = "";  &eaTipoClas = ""; &enSwClas = 0;
   &HayGestion = 0;

   &Fichero = ""; &Tipo = ""; &Cmp = ""; &CmpNum = 0;
   &DirCliente = ""; &Cp = ""; &PobCliente = ""; &ProvCliente = "";
   &TelCliente = "";
   &enEmpCartera = 0; &enEmpGestion = 0;

   &eaCodBLZ   = "";
   &eaCodSwift = "";
  || &eaCodIBAN  = "";
   &eaCodBIC   = "";

   &eaUsuario = ""; &enImpAnt = 0;  &enImpAct = 0;  &eaDescr = "";
   &eaTipoReg = ""; &eaNumero = ""; &eaTipoOp = "";
   &EURO = 0; &EURODB = 0; &EURODV = 0;
   &eaCodigo    = "";
   &eaTipoCod   = "";
   &aCuenta     = "";
   &eaNif       = "";
   &eaNombre    = "";
   &eaDireccion = "";
   &eaPoblacion = "";
   &eaProvincia = "";
   &eaCP        = "";
   &eaCP1       = "";
   &eaCP2       = "";
   &eaTelefono  = "";
   &enNume1     = "";
   &eaDirCobro  = "";

   nHandle  = 0;
   nSwOp    = 0;

   Comodin = ""; Comodin1 = "";
   aAlfa = "";
   aAlfa1 = "";
   aInfor = "";
   nContador = 0;

   aLong = ""; nLong = 0;
   nCalc   = 0; nCont   = 0;
   FEstado = 0;
   Calc    = 0;
   Cuenta = ""; Nivel = 0;
   aNombre = ""; aPath  = "";
   nDocumto = 0;

   &nDeci_Base = 0; &nDeci_Div = 0; &Divisa = "";
|FIN;

|PROCESO AjusteHoja;
     |VARIABLES;
                    || R.PRIEGO: IMPRESION ESPECIAL EN LASER
                    || Ajusta a numero de recibos por pagina.
          nAjuste = 0;   || nro.recibos p/pagina, viene de tipos de recibo
          nCuenta = 0;   || contador de los recibos ya impresos
          nPara1  = 0;
          nNume1  = 0;
     |FINSI;

     |SI nCuenta = 0;    |ACABA;   |FINSI;

     nAjuste = #dscam058#3;        || se queda con el ultimo TIPO utilizado
     |SI nAjuste = 0;    |ACABA;   |FINSI;

     |SALVA_FICHA #dscam003;

     |DDEFECTO #dscam003;
     DirCliente = "";
     Cp = "";
     PobCliente = "";
     ProvCliente = "";
     TelCliente = "";

     nNume1 = nCuenta $ nAjuste;
     |SI nNume1 ! 0;
          nNume1 = nNume1 + 1;
          |PARA nPara1 = nNume1; |SI nPara1 [ nAjuste; |HACIENDO nPara1 = nPara1 + 1;
               Comodin = #dscam058#2; |QBF Comodin;    || con el ultimo
               |INFOR Comodin;
               |PRINT;
               |PIEINF; |FININF;
          |SIGUE;
     |FINSI;

     |REPON_FICHA #dscam003;
|FPRC;

|PROCESO SacaNivel1;
   Comodin = Cuenta; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 1"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 1; |FINSI;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 2"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 2; |FINSI;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 3"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 3; |FINSI;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 4"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 4; |FINSI;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 5"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 5; |FINSI;
   Fichero = "Empresas"; Tipo = "C"; Cmp = "Digitos Nivel 6"; |HAZ ObtenDato;
   |SI #canempr@#CmpNum# = nLong; Nivel = 6; |FINSI;
|FPRC;

|PROCESO Recibos;
   #dscam003#40 = #Referen@#40;
   |LEE 000#dscam003.=;

   eaFichClas = "dscaz029"; eaTipoClas = #dscam003#12;
   enSwClas = 1; |HAZ CompruebaClas;
   |SI eaFichClas = "ERROR"; |ACABA; |FINSI;

   |SI #dscam003#17 < #0#28; |O #dscam003#17 > #0#29; |ACABA; |FINSI;
   |SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;

   |SI #dscam003#48 ! #dscaz029#26; |ACABA; |FINSI;

   |SI #dscam003#57 = "EUR"; EURODB = 2; |SINO; EURODB = 0; |FINSI;
   |SI EURODB = 2;
      EURO = 166.386;     EURODV = 0;
   |SINO;
      EURO = 1 / 166.386; EURODV = 2;
   |FINSI;

   Divisa = #dscam003#57; |HAZ TomaDecim;
   #dscam003#86 = #dscam003#30;

   |SI nSwOp = 1;
      |ABRE #dscam058;
      Comodin = ("00" + #dscam003#12) % -102;
      #dscam058#0 = Comodin;
      |LEE 000#dscam058.=;
      FEstado = FSalida;
      |CIERRA #dscam058;
      |SI FEstado ! 0;
         #dscam058#2 = #dscam051#64;
      |SINO;
        |DBASE Comodin; |QBF Comodin;
        Comodin = Comodin + "def/" + #dscam058#2 + ".inf";
        |XABRE "E", Comodin, FEstado;
        |SI FSalida < 0;
           #dscam058#2 = #dscam051#64;
        |FINSI;
      |FINSI;

      Comodin = #dscam058#2; |QBF Comodin;
      |INFOR Comodin;
      |SI FSalida = 0;
         eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;
         DirCliente  = eaDireccion;
         Cp          = eaCP;
         PobCliente  = eaPoblacion;
         ProvCliente = eaProvincia;
         TelCliente  = eaTelefono;
         |SI HayGestion ! 0;
            enNume1     = #agif024@#167;
         |SINO;
            enNume1     = 0;
         |FINSI;

         |PRINT;
         eaUsuario = Usuario % 0810;
         eaTipoReg = "CB";  eaNumero = ("000000000" + #dscam003#40) % -109;
         eaDescr   = "EMISION RECIBO (" + (("000000000" + #dscam003#40) % -109);
         eaDescr   = eaDescr + ") DESDE EMISION MASIVA DE RECIBOS";
         eaTipoOp  = "E"; enImpAnt = #dscam003#30; enImpAct = #dscam003#30;
         |HAZ GrabaAudit;
         #dscam003#48 = "S"; |GRABA 020#dscam003.a;
         |PIEINF;
         |FININF;
         nCuenta = nCuenta + 1;
      |SINO;
         aAlfa = ("00" + #dscam003#12) % -102;
         aAlfa = "    No se encuentra el cuadre " + #dscam058#2 + " para el tipo recibo " + aAlfa + " y no existe el cuadre defecto";
         |MENAV aAlfa;
         |ACABA;
      |FINSI;
   |FINSI;

   |SI nSwOp = 2;
      |ABRE #dscam058;
      Comodin = ("00" + #Referen@#12) % -102;
      #dscam058#0 = Comodin;
      |LEE 000#dscam058.=;
      FEstado = FSalida;
      |CIERRA #dscam058;
      |SI FEstado ! 0;
         #dscam058#2 = #dscam051#64;
      |SINO;
        |DBASE Comodin; |QBF Comodin;
        Comodin = Comodin + "def/" + #dscam058#2 + ".inf";
        |XABRE "E", Comodin, FEstado;
        |SI FSalida < 0;
           #dscam058#2 = #dscam051#64;
        |FINSI;
      |FINSI;

      #dscaw180#0 = #dscam058#2;
      #dscaw180#1 = #Referen@#40;
      |LEE 000#dscaw180.=;
      |SI FSalida ! 0;
         |DDEFECTO #dscaw180;
         #dscaw180#0 = #dscam058#2;
         #dscaw180#1 = #Referen@#40;
         |GRABA 020#dscaw180.c;
      |FINSI;
      #dscaw180#2 = nContador; nContador = nContador + 1;
      |GRABA 020#dscaw180.a;
   |FINSI;
|FPRC;

|DEFBUCLE Recibos01;
#Referen@#1001;
;
000000001;
999999999;
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibos02;
#Referen@#9005;
;
00, "     ", 000000, 000, 000000001;
99, "zzzzz", 999999, 999, 999999999;
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibos03;
#Referen@#15003;
;
"      ", "            ", " ";
"zzzzzz", "zzzzzzzzzzzz", "z";
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibos04;
#Referen@#3002;
;
"01.01.0000", 000000001;
"31.12.9999", 999999999;
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibos05;
#Referen@#2002;
;
"01.01.0000", 000000001;
"31.12.9999", 999999999;
;
NULL,Recibos;
|FIN;

|PROCESO RecibosOrd;
   #Referen@#40 = #dscam003#40;
   |LEE 000#Referen@.=;
   |SI FSalida = 0; |HAZ Recibos; |FINSI;
|FPRC;

|DEFBUCLE Recibos06;
#dscam003#1;
;
000000001;
999999999;
;
NULL,NULL,NULL,NULL,NULL, RecibosOrd;
#dscam003#33;
|FIN;

|DEFBUCLE Recibos07;
#dscam003#1;
;
000000001;
999999999;
;
NULL,NULL,NULL,NULL,NULL, RecibosOrd;
#dscam003#51;
|FIN;

|DEFBUCLE Recibos08;
#dscam003#1;
;
000000001;
999999999;
;
NULL,NULL,NULL,NULL,NULL, RecibosOrd;
#dscam003#0, #dscam003#80, #dscam003#1;
|FIN;

|PROCESO BucleRef;
   nDocumto = 0;
   |SELECT #12#dscam003;
   #dscam003#0 = #RefBucle@#0;
   #dscam003#1 = #RefBucle@#1;
   #dscam003#2 = 1;
   #dscam003#4 = "01.01.0000";
   #dscam003#5 = "";
   #dscam003#32 = "";
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#0 = #RefBucle@#0; |Y #dscam003#1 = #RefBucle@#1; |HACIENDO;
      |SI #dscam003#32 = #RefBucle@#2;
         nDocumto = #dscam003#40;
      |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;
   |SELECT #1#dscam003;

   #dscam003#40 = nDocumto;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

   aAlfa = "|NC"; aAlfa = #dscam003#aAlfa#; nCalc = aAlfa;
   |PARA nCont = 0; |SI nCont < nCalc; |HACIENDO nCont = nCont + 1;
       #Referen@#nCont# = #dscam003#nCont#;
   |SIGUE;
   |GRABA 020#Referen@.n;

   |SI nSwOp = 2;
      |ABRE #dscam058;
      Comodin = ("00" + #dscam003#12) % -102;
      #dscam058#0 = Comodin;
      |LEE 000#dscam058.=;
      FEstado = FSalida;
      |CIERRA #dscam058;
      |SI FEstado ! 0;
         #dscam058#2 = #dscam051#64;
      |SINO;
        |DBASE Comodin; |QBF Comodin;
        Comodin = Comodin + "def/" + #dscam058#2 + ".inf";
        |XABRE "E", Comodin, FEstado;
        |SI FSalida < 0;
           #dscam058#2 = #dscam051#64;
        |FINSI;
      |FINSI;

      |DDEFECTO #dscaw180;
      #dscaw180#0 = #dscam058#2;
      #dscaw180#1 = #dscam003#40;
      |GRABA 020#dscaw180.n;
   |FINSI;
|FPRC;

|DEFBUCLE BucleRef;
#RefBucle@#1002;
;
"     ", 000000;
"zzzzz", 999999;
;
NULL, BucleRef;
|FIN;

|PROCESO ImprimeRecibos;
   |SI aInfor ! #dscaw180#0;
      |SI aInfor ! "ZZZZZZZZZ";
         |PIEINF; |FININF;
||         |FINIMP;

||         Impresora = "CrystalReport";
||         |IMPRE -1;
      |FINSI;

      aAlfa = #dscaw180#0; |QBF aAlfa;
      |INFOR aAlfa;
      |SI FSalida ! 0;
         aAlfa = ("00" + #dscam003#12) % -102;
         aAlfa = "    No se encuentra el cuadre " + #dscaw180#0 + " para el tipo recibo " + aAlfa + " y no existe el cuadre defecto";
         |MENAV aAlfa;
         aInfor = "ZZZZZZZZZ";
         |ACABA;
      |FINSI;
      aInfor = #dscaw180#0;
   |FINSI;

   #dscam003#40 = #dscaw180#1;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

   eaCodigo = #dscam003#32; eaTipoCod = "C"; aCuenta = #dscam003#5; |HAZ LeeDatos;
   DirCliente  = eaDireccion;
   Cp          = eaCP;
   PobCliente  = eaPoblacion;
   ProvCliente = eaProvincia;
   TelCliente  = eaTelefono;

   #dscam052#0 = #dscam003#32;
   |LEE 000#dscam052.=;
   |SI FSalida ! 0; |DDEFECTO #dscam052; |FINSI;

   Divisa = #dscam003#57; |HAZ TomaDecim;
   #dscam003#86 = #dscam003#30;
   #dscam003#48 = "S"; |GRABA 020#dscam003.a;

   |PRINT;
|FPRC;

|DEFBUCLE ImprimeRecibos;
#dscaw180#2;
;
INICIO;
FINAL;
;
NULL, ImprimeRecibos;
|FIN;

|PROGRAMA;
   |CLS;

   |HAZ Tipo8;

   |SI PARAMETRO = "";
      |ABRE #dscam051;
      |LEE 000#dscam051.p;
      |SI FSalida ! 0; |DDEFECTO #dscam051;|FINSI;
      |CIERRA #dscam051;

      |CABEZA "Emision de recibos";
      |PINPA #0#0; |PINDA #0#0;
      |ENDATOS #1#0;
   |SINO;
      |DFICB aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + (("00000" + enEmpCartera) % -105) + "/";
      |PATH_DAT #dscam051#aAlfa#;

      |ABRE #dscam051;
      |LEE 000#dscam051.p;
      |SI FSalida ! 0; |DDEFECTO #dscam051;|FINSI;
      |CIERRA #dscam051;

      aAlfa = PARAMETRO; |QBF aAlfa;
      aAlfa = aAlfa - ".dat";
      |SI FSalida = 0;
         aAlfa = PARAMETRO; aAlfa = aAlfa % 0105;
         #dscaz029#1 = aAlfa; #dscaz029#14 = aAlfa;
         aAlfa = PARAMETRO; aAlfa = aAlfa % 0606;
         #dscaz029#2 = aAlfa; #dscaz029#15 = aAlfa;
      |FINSI;
      FSalida = 0;
   |FINSI;
   |SI FSalida = 0;
      |IMPRE 0;
      |SI FSalida = 0;
         |SI Impresora ! "CrystalReport";
            nSwOp = 1;
         |SINO;
            nSwOp = 2;
            aAlfa = "trc" + Usuario; |NOME_DAT #dscaw180#aAlfa#;
            |DELINDEX #dscaw180; |ABRE #dscaw180;
            nContador = 1;
         |FINSI;

         |SI PARAMETRO = "";
            |DFICE aAlfa; |QBF aAlfa;
            aAlfa = "wb  " + aAlfa + "Qu" + Usuario + ".txt";
            |FABRE aAlfa;
            |SI FSalida < 0; |FINIMP; |ACABA; |FINSI;
            nHandle = FSalida;

            aAlfa = "* FROM dscam003 INTO re" + Usuario + ".def WHERE"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 40 BETWEEN " + #0#0  + "," + #0#13 + " AND";  aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 0  BETWEEN " + #0#1  + "," + #0#14 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 1  BETWEEN " + #0#2  + "," + #0#15 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 32 BETWEEN " + #0#3  + "," + #0#16 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 5  BETWEEN " + #0#4  + "," + #0#17 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 4  BETWEEN " + #0#5  + "," + #0#18 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 3  BETWEEN " + #0#6  + "," + #0#19 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 12 BETWEEN " + #0#7  + "," + #0#20 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 33 BETWEEN " + #0#8  + "," + #0#21 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 39 BETWEEN " + #0#9  + "," + #0#22 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 51 BETWEEN " + #0#10 + "," + #0#23 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 35 BETWEEN " + #0#11 + "," + #0#24 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 30 BETWEEN " + #0#12 + "," + #0#25 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            aAlfa = " 17 BETWEEN " + #0#28 + "," + #0#29;          aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
            FSalida = nHandle; |FCIERRA FSalida;

            |PUSHV 2301 2380; |BLANCO 2301 2380;
            |ATRI I; |PINTA 2310, " Seleccionando registros .... "; |ATRI N;

            |DFICE aAlfa; |QBF aAlfa;
            aAlfa = "SELECT @" + aAlfa + "Qu" + Usuario + ".txt";
            |SQL aAlfa;
         |SINO;
            |DFICB aAlfa; |QBF aAlfa;
            aAlfa = aAlfa + (("00000" + enEmpCartera) % -105) + "/";
            |PATH_DAT #dscam003#aAlfa#; |PATH_DAT #dscam058#aAlfa#;

            aAlfa = PARAMETRO; |QBF aAlfa; aAlfa = aAlfa - ".dat";
            |SI FSalida = 0;
               |DFICB aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + (("00000" + enEmpCartera) % -105) + "/";

               aAlfa = "wb  " + aAlfa + "Qu" + Usuario + ".txt";
               |FABRE aAlfa;
               |SI FSalida < 0; |FINIMP; |ACABA; |FINSI;
               nHandle = FSalida;

               aAlfa = "* FROM dscam003 INTO re" + Usuario + ".def WHERE"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
               aAlfa = " 0 == " + #0#1 + " AND"; aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
               aAlfa = " 1 == " + #0#2;          aAlfa = nHandle + " " + aAlfa; |FGRABA aAlfa;
               FSalida = nHandle; |FCIERRA FSalida;

               |PUSHV 2301 2380; |BLANCO 2301 2380;
               |ATRI I; |PINTA 2310, " Seleccionando registros .... "; |ATRI N;

               |DFICB aAlfa; |QBF aAlfa;
               aAlfa = aAlfa + (("00000" + enEmpCartera) % -105) + "/";
               aAlfa = "SELECT @" + aAlfa + "Qu" + Usuario + ".txt";
               |SQL aAlfa;
            |SINO;
               aPath = PARAMETRO; |QBF aPath;
               aAlfa1 = aPath % -101;
               |PARA; |SI aAlfa1 ! "/"; |Y aAlfa1 ! "\"; |HACIENDO;
                  aPath = aPath % -299; aAlfa1 = aPath % -101;
               |SIGUE;

               aNombre = PARAMETRO; |QBF aNombre;
               aNombre = aNombre - aPath;

               aAlfa = aPath; |QBF aAlfa;
               aAlfa = aAlfa - "fich/";
               |SI FSalida ! 0;
                  nCalc = ((FSalida / 100) ! 0) + 99;
                  aAlfa = aPath % nCalc;
                  aAlfa = aAlfa + "def/tempo134.mas";
                  |CARGA_DEF aAlfa, RefBucle@;
                  |SI FSalida = 0;
                     |PATH_DAT #RefBucle@#aPath#; |NOME_DAT #RefBucle@#aNombre#;

                     |DDEF aAlfa; |QBF aAlfa; aAlfa = aAlfa + "dscam003.mas";
                     |DDEF aAlfa1; |QBF aAlfa1; aAlfa1 = aAlfa1 + "re" + Usuario + ".mas";
                     |COPIA_FICHERO aAlfa, aAlfa1;

                     |CARGA_DEF aAlfa1, Referen@;
                     |SI FSalida = 0;
                        ||aAlfa1 = "re" + Usuario + ".mas"; |NOME_DAT #Referen@#aAlfa1#;
                        |ABRE #dscam003;
                        |DELINDEX #Referen@; |ABRE #Referen@;
                        |BUCLE BucleRef;
                        |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
                        |CIERRA #dscam003;
                     |FINSI;
                  |FINSI;
               |FINSI;
            |FINSI;
         |FINSI;
         |SI FSalida = 0;
            |DDEF aAlfa; |QBF aAlfa; aAlfa = aAlfa + "re" + Usuario + ".mas";
            |CARGA_DEF aAlfa, Referen@;
            |SI FSalida = 0;
               |ABRE #dscam003; |ABRE #Referen@;
               |SI #0#27 = 1; |BUCLE Recibos01; |FINSI;
               |SI #0#27 = 2; |BUCLE Recibos02; |FINSI;
               |SI #0#27 = 3; |BUCLE Recibos03; |FINSI;
               |SI #0#27 = 4; |BUCLE Recibos04; |FINSI;
               |SI #0#27 = 5; |BUCLE Recibos05; |FINSI;
               |SI #0#27 = 6; |BUCLE Recibos06; |FINSI;
               |SI #0#27 = 7; |BUCLE Recibos07; |FINSI;
               |SI #0#27 = 8; |BUCLE Recibos08; |FINSI;
               |SI Impresora ! "CrystalReport";
                  |HAZ AjusteHoja;
               |SINO;
                  |ABRE #dscam052;
                  aInfor = "ZZZZZZZZZ";
                  |BUCLE ImprimeRecibos;
                  |SI aInfor ! "ZZZZZZZZZ";
                     |PIEINF; |FININF;
                  |FINSI;
                  |CIERRA #dscaw180; |DELINDEX #dscaw180;
                  |CIERRA #dscam052;
               |FINSI;
               |CIERRA #dscam003;
               |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
            |FINSI;
            |DDEF aAlfa; |QBF aAlfa; aAlfa = aAlfa + "re" + Usuario + ".mas";
            |FBORRA aAlfa;
         |FINSI;
         |POPV;
      |FINSI;
      |FINIMP;
   |FINSI;

   |HAZ Tipo9;

|FPRO;
