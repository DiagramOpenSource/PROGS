|FICHEROS;
   dscaz135 #0;

   dscam003 #10;
   dscaw100 #11;
   dscam023 #12,MANTE;
   dscam024 #13;

   dscam081 #20;
   dscam082 #21;
   dscaw099 #22;

   dscam051 #99;
|FIN;

|VARIABLES;
   &TipoCliente = ""; &CodCliente = "";
   &DCampoG = 0;      &HCampoG = 0;
   &DCampoC = 0;      &HCampoC = 0;
   &eaTitOrden = "";
   &enSw       = 0;
   &enContLin  = 0;
   &eaCodEmp   = "";
   &eaNomEmp   = "";

   nSwMalpesa = 0;
   nNumLins = 0;
   nLin     = 0;
   aAlfa    = "";
   fFecVto  = @;
   fFecEmi  = @;
   aCodCli  = "";
   nTipoRec = 0;
   nCalc    = 0;
   nAntSw   = 0;

   nPrimCli  = 1;
   nPrimTR   = 1;
   nPrimFEm  = 1;
   nPrimFVt  = 1;
|FIN;

|PROCESO Comprueba;
   |SI Campo = 10;
      |SI #dscaz135#10 = "N";
         |C_M #dscaz135#11,1,"N"; #dscaz135#11 = "N"; |PINTA #dscaz135#11;
         |C_M #dscaz135#12,1,"N"; #dscaz135#12 = "N"; |PINTA #dscaz135#12;
      |SINO;
         #dscaz135#11 = "S"; |PINTA #dscaz135#11; |C_M #dscaz135#11,1,"S";
         #dscaz135#12 = "S"; |PINTA #dscaz135#12; |C_M #dscaz135#12,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 13;
      |SI #dscaz135#13 = "N";
         |C_M #dscaz135#14,1,"N"; #dscaz135#14 = "N"; |PINTA #dscaz135#14;
         |C_M #dscaz135#15,1,"N"; #dscaz135#15 = "N"; |PINTA #dscaz135#15;
      |SINO;
         #dscaz135#14 = "S"; |PINTA #dscaz135#14; |C_M #dscaz135#14,1,"S";
         #dscaz135#15 = "S"; |PINTA #dscaz135#15; |C_M #dscaz135#15,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 16;
      |SI #dscaz135#16 = "N";
         |C_M #dscaz135#17,1,"N"; #dscaz135#17 = "N"; |PINTA #dscaz135#17;
         |C_M #dscaz135#18,1,"N"; #dscaz135#18 = "N"; |PINTA #dscaz135#18;
         |C_M #dscaz135#19,1,"N"; #dscaz135#19 = "N"; |PINTA #dscaz135#19;
      |SINO;
         #dscaz135#17 = "S"; |PINTA #dscaz135#17; |C_M #dscaz135#17,1,"S";
         #dscaz135#18 = "S"; |PINTA #dscaz135#18; |C_M #dscaz135#18,1,"S";
         #dscaz135#19 = "S"; |PINTA #dscaz135#19; |C_M #dscaz135#19,1,"S";
      |FINSI;
   |FINSI;
   |SI Campo = 20;
      |SI #dscaz135#20 = "N";
         |C_M #dscaz135#21,1,"N"; #dscaz135#21 = "N"; |PINTA #dscaz135#21;
         |C_M #dscaz135#22,1,"N"; #dscaz135#22 = "N"; |PINTA #dscaz135#22;
      |SINO;
         #dscaz135#21 = "S"; |PINTA #dscaz135#21; |C_M #dscaz135#21,1,"S";
         #dscaz135#22 = "S"; |PINTA #dscaz135#22; |C_M #dscaz135#22,1,"S";
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO PintaAyuda; |TIPO 7;
   |PUSHV 1515 2380;
   |BLANCO 1515 2355;
   |CUADRO 1515 2354;
   |ATRI R;
   |PINTA 1616, " <1> Por cliente+tipo documento       ";
   |PINTA 1716, " <2> Por fecha emision+tipo documento ";
   |PINTA 1816, " <3> Por fecha vto+tipo documento     ";
   |PINTA 1916, " <4> Por tipo documento+cliente       ";
   |PINTA 2016, " <5> Por tipo documento+fecha emision ";
   |PINTA 2116, " <6> Por tipo documento+fecha vto     ";
   |ATRI N;
|FPRC;

|PROCESO BorraAyuda;
   |POPV;
   |SI #dscaz135#6 = 1;
      eaTitOrden = "cliente/tipo documento       ";
   |FINSI;
   |SI #dscaz135#6 = 2;
      eaTitOrden = "fecha emision/tipo documento ";
   |FINSI;
   |SI #dscaz135#6 = 3;
      eaTitOrden = "fecha vto/tipo documento     ";
   |FINSI;
   |SI #dscaz135#6 = 4;
      eaTitOrden = "tipo documento/cliente       ";
   |FINSI;
   |SI #dscaz135#6 = 5;
      eaTitOrden = "tipo documento/fecha emision ";
   |FINSI;
   |SI #dscaz135#6 = 6;
      eaTitOrden = "tipo documento/fecha vto     ";
   |FINSI;
   |ATRI I; |PINTA 1616, eaTitOrden; |ATRI N;
|FPRC;

|PROCESO AcumulaRiesgo;
   #dscaw100#25 = #dscaw100#25 + #dscam024#3;
   #dscaw100#26 = #dscaw100#26 + #dscam024#4;
   #dscaw100#27 = #dscaw100#27 + #dscam024#6;
   #dscaw100#28 = #dscaw100#28 + #dscam024#7;
   #dscaw100#30 = #dscam024#9;
|FPRC;

|DEFBUCLE AcumulaRiesgo;
#dscam024#1;
;
#dscam003#32, 01;
#dscam003#32, 99;
;
NULL, AcumulaRiesgo;
|FIN;

|PROCESO Recibos;
   |SI #dscam003#14 = "L";                        |ACABA; |FINSI;
   |SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;
   |SI #dscam003#69 ! " "; |O #dscam003#47 = "S"; |ACABA; |FINSI;

   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         |SI #dscam003#71 < #dscaz135#4; |O #dscam003#71 > #dscaz135#5; |ACABA; |FINSI;
      |SINO;
         |SI #dscam003#3 < #dscaz135#4; |O #dscam003#3 > #dscaz135#5; |ACABA; |FINSI;
      |FINSI;
   |FINSI;

   #dscam082#1 = #dscam003#12;
   |LEE 000#dscam082.=;
   |SI FSalida ! 0; |DDEFECTO #dscam082; |FINSI;

   #dscam081#0 = #dscam082#0;
   |LEE 000#dscam081.=;
   |SI FSalida ! 0; |DDEFECTO #dscam081; |FINSI;

   |SI #dscam081#2 = " "; |ACABA; |FINSI;

   |SI #dscam081#2 = "C";
      |SI #dscaz135#9 = "S";
         |SI #dscaz135#23 = "S";
            |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |Y #dscam003#14 ! "M"; |ACABA; |FINSI;
         |SINO;
            |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "R";
      |SI #dscaz135#10 = "S";
         |SI #dscaz135#11 = "N";
            |SI #dscam003#90 = "N"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz135#12 = "N";
            |SI #dscam003#90 = "S"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "P";
      |SI #dscaz135#13 = "S";
         |SI #dscaz135#14 = "N";
            |SI #dscam003#14 = "P"; |O #dscam003#14 = "I"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz135#15 = "N";
            |SI #dscam003#14 = "T"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "A";
      |SI #dscaz135#16 = "S";
         |SI #dscaz135#17 = "N";
            |SI #dscam003#28 = "S"; |Y #dscam003#29 = "N";
               |SI #dscam003#14 = "P"; |O #dscam003#14 = "I"; |ACABA; |FINSI;
            |FINSI;
         |FINSI;
         |SI #dscaz135#18 = "N";
            |SI #dscam003#14 = "V"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz135#19 = "N";
            |SI #dscam003#28 = "S"; |Y #dscam003#29 = "S"; |Y #dscam003#90 = "S"; |Y #dscam003#14 = "P"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;
   |SI #dscam081#2 = "O";
      |SI #dscaz135#20 = "S";
         |SI #dscaz135#21 = "N";
            |SI #dscam003#14 = "P"; |Y #dscam003#90 = "N"; |ACABA; |FINSI;
         |FINSI;
         |SI #dscaz135#16 = "N";
            |SI #dscam003#14 = "P"; |Y #dscam003#90 = "S"; |ACABA; |FINSI;
         |FINSI;
      |SINO;
         |ACABA;
      |FINSI;
      |SI #dscam003#14 = "R"; |ACABA; |FINSI;
   |FINSI;

   |DDEFECTO #dscaw100;
   #dscaw100#0  = #dscam003#40;
   #dscaw100#1  = #dscam003#0;
   #dscaw100#2  = #dscam003#1;
   #dscaw100#3  = #dscam003#4;
   |SI #dscam051#104 = "S";
      |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
         #dscaw100#4  = #dscam003#71;
      |SINO;
         #dscaw100#4  = #dscam003#3;
      |FINSI;
   |SINO;
      #dscaw100#4  = #dscam003#3;
   |FINSI;
   #dscaw100#5  = #dscam003#31;
   #dscaw100#6  = #dscam003#12;
   #dscaw100#7  = #dscam082#2;
   #dscaw100#8  = #dscam003#14;
   #dscaw100#9  = #dscam003#72;
   #dscaw100#10 = #dscam003#70;
   #dscaw100#11 = #dscam081#2;
   #dscaw100#12 = #dscam081#0;
   #dscaw100#13 = #dscam081#1;
   #dscaw100#14 = #dscam003#32;
   #dscaw100#15 = #dscam003#6;
   #dscaw100#16 = #dscam003#15;
   #dscaw100#17 = #dscam003#90;
   #dscaw100#18 = #dscaw099#0;
   #dscaw100#19 = #dscaw099#1;
   #dscaw100#20 = #dscam003#91;
   #dscaw100#21 = #dscam003#92;
   #dscaw100#22 = #dscam003#75;
   #dscaw100#23 = #dscam003#76;
   #dscaw100#24 = #dscam003#77;

   |SI nSwMalpesa = 1;
      #dscam023#0 = #dscam003#32;
      |LEE 000#dscam023.=;
      |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

      |BUCLE AcumulaRiesgo;
      #dscaw100#29 = #dscam023#19;
   |FINSI;

   |GRABA 020#dscaw100.n;
|FPRC;

|DEFBUCLE Recibos;
#dscam003#15;
4,3;
#dscaz135#0, #dscaz135#7, " ", #dscaz135#2, #dscaz135#4;
#dscaz135#1, #dscaz135#8, " ", #dscaz135#3, #dscaz135#5;
;
NULL,Recibos;
|FIN;

|DEFBUCLE Recibosb;
#dscam003#15;
4,3;
#dscaz135#0, #dscaz135#7, " ", #dscaz135#2, "01.01.0000";
#dscaz135#1, #dscaz135#8, " ", #dscaz135#3, "31.12.9999";
;
NULL,Recibos;
|FIN;

|PROCESO Listado;
   |PRINT;
|FPRC;

|DEFBUCLE Listado;
#dscaw100#1;
;
INICIO;
FINAL;
;
NULL,Listado;
|FIN;

|PROCESO Empresas;
   eaCodEmp = #dscaw099#0; eaNomEmp = #dscaw099#1;

   |DFICB aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + (("00000" + #dscaw099#0) % -105) + "/";
   |PATH_DAT #dscam003#aAlfa#; |PATH_DAT #dscam081#aAlfa#;
   |PATH_DAT #dscam082#aAlfa#; |PATH_DAT #dscam051#aAlfa#;
   |PATH_DAT #dscam023#aAlfa#; |PATH_DAT #dscam024#aAlfa#;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |ABRE #dscam081; |ABRE #dscam082; |SELECT #2#dscam082;
   |ABRE #dscam023;
   |SI #dscam051#104 = "S";
      |BUCLE Recibosb;
   |SINO;
      |BUCLE Recibos;
   |FINSI;
   |CIERRA #dscam023;
   |CIERRA #dscam082;   |CIERRA #dscam081;
|FPRC;

|DEFBUCLE Empresas;
   #dscaw099#1;
   ;
   INICIO;
   FINAL;
   ;
   NULL,Empresas;
|FIN;

|PROCESO MiraCuentas;
   |SI FSalida = 10;
      TipoCliente = "C"; DCampoC = 7; HCampoC = 8;
      |HAZ ExisteCliente;
      #dscaz135#Campo# = CodCliente; |PINTA #dscaz135#Campo#;
   |FINSI;
|FPRC;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G"; DCampoG = 0; HCampoG = 1;
      |HAZ ExisteCliente;
      #dscaz135#Campo# = CodCliente; |PINTA #dscaz135#Campo#;
   |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ Tipo8;

   |ABRE #dscam081; |ABRE #dscam082;
   |LEE 000#dscam081.p;
   |SI FSalida = 0;
      |LEE 000#dscam082.p;
      |SI FSalida ! 0;
         |MENAV "    Este listado solo se obtendra en caso de usar clasificaciones de tipos de recibo. Proceso cancelado.";
         |CIERRA #dscam081; |CIERRA #dscam082;
         |ACABA;
      |FINSI;
   |SINO;
      |MENAV "    Este listado solo se obtendra en caso de usar clasificaciones de tipos de recibo. Proceso cancelado.";
      |CIERRA #dscam081; |CIERRA #dscam082;
      |ACABA;
   |FINSI;
   |CIERRA #dscam081; |CIERRA #dscam082;

   |ABRE #0;
   |LEE 101#0p;
   |SI FSalida ! 0; |GRABA 020#0b; |FINSI;

   #0#0 = "";
   |PDEFECTO #0, 1, 9;
   |PDEFECTO #0, 24, 26;

   |CLS;
   |CABEZA "Informe pendientes de cobro";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#0a; |LIBERA #0;

      Impresora = "CrystalReport";
      |IMPRE -1;
      |SI FSalida ! 0; |ACABA; |FINSI;

      |HAZ EsMalpesa;

      |SI FSalida = 0;
         nSwMalpesa = 1;
         |INFOR "dsca135a";
      |SINO;
         nSwMalpesa = 0;
         |INFOR "dscaz135";
      |FINSI;
      |SI FSalida ! 0; |ACABA; |FINSI;

      |SUB_EJECUTA "dscaz134.tab";

      aAlfa = "se" + Usuario; |NOME_DAT #dscaw099#aAlfa#;
      aAlfa = "i1" + Usuario; |NOME_DAT #11 aAlfa;
      |DELINDEX #dscaw100; |ABRE #dscaw100;
      |BUCLE Empresas;

      |BUCLE Listado;

      |PIEINF; |FININF;
      |FINIMP;
      |CIERRA #dscaw100;   |DELINDEX #dscaw100;
   |FINSI;
   |CIERRA #0;

   |HAZ Tipo9;
|FPRO;
