|FICHEROS;
   dscaz051 #0;
   dscaw037 #1;

   dscam003 #2;
   dscam004 #3;

   dscam008 #4;
   dscam009 #5;

   &camasic@ #6;
   &camasil@ #7;
   &cacuent@ #8;
   &caclipr@ #9;

   &agif024@ #10;
   &agif134@ #11;
   &agif084@ #12;
   &agif079@ #13;

   dscam067 #14;
|FIN;

|VARIABLES;
   aAlfa  = "";
   aAlfa1 = "";

   Linea = 1;
|FIN;

|PROCESO Asientos;
|FPRC;

|DEFBUCLE Asientos;
#camasil@#1004;
;
00,"01.01.1900",000000,0000;
99,"31.12.2999",999999,9999;
be;
NULL,Asientos;
|FIN;

|PROCESO FactVenta;
   |SELECT #3#dscaw037;
   #dscaw037#9 = #agif134@#49;
   #dscaw037#10 = #agif134@#0;
   #dscaw037#29 = "V";
   |LEE 101#dscaw037.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw037;
      #dscaw037#28 = Linea; Linea = Linea + 1;
      #dscaw037#29 = "V";
      |GRABA 020#dscaw037.b;
   |FINSI;
   #dscaw037#11 = #agif134@#1;
   #dscaw037#12 = #agif134@#2;
   #dscaw037#13 = #agif134@#3;
   #dscaw037#14 = #agif134@#11;
   #dscaw037#16 = #agif134@#21 + #agif134@#24 + #agif134@#27 + #agif134@#33;
   #dscaw037#16 = #dscaw037@#16 + #agif134@#36;
   #dscaw037#17 = #agif134@#22 + #agif134@#25 + #agif134@#28 + #agif134@#34;
   #dscaw037#17 = #dscaw037@#17 + #agif134@#37;
   #dscaw037#18 = #agif134@#31;
   |GRABA 020#dscaw037.a; |LIBERA #dscaw037;
   |SELECT #1#dscaw037;
|FPRC;

|DEFBUCLE FactVenta;
#agif134@#1002;
;
"     ",000000;
"zzzzz",999999;
be;
NULL,FactVenta;
|FIN;

|PROCESO FactCompra;
   |SELECT #3#dscaw037;
   #dscaw037#9 = #agif079@#66;
   #dscaw037#10 = #agif079@#0;
   #dscaw037#29 = "C";
   |LEE 101#dscaw037.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw037;
      #dscaw037#28 = Linea; Linea = Linea + 1;
      #dscaw037#29 = "C";
      |GRABA 020#dscaw037.b;
   |FINSI;
   #dscaw037#11 = #agif079@#1;
   #dscaw037#12 = #agif079@#2;
   #dscaw037#13 = #agif079@#3;
   #dscaw037#14 = #agif079@#11;
   #dscaw037#16 = #agif079@#21 + #agif079@#24 + #agif079@#27 + #agif079@#49;
   #dscaw037#16 = #dscaw037@#16 + #agif079@#52;
   #dscaw037#17 = #agif079@#22 + #agif079@#25 + #agif079@#28 + #agif079@#50;
   #dscaw037#17 = #dscaw037@#17 + #agif079@#53;
   #dscaw037#18 = #agif079@#31;
   |GRABA 020#dscaw037.a; |LIBERA #dscaw037;
   |SELECT #1#dscaw037;
|FPRC;

|DEFBUCLE FactCompra;
#agif079@#1002;
;
"     ",000000;
"zzzzz",999999;
be;
NULL,FactCompra;
|FIN;

|PROCESO FactDirectas;
   |SELECT #3#dscaw037;
   #dscaw037#9 = #agif084@#48;
   #dscaw037#10 = #agif084@#0;
   #dscaw037#29 = "V";
   |LEE 101#dscaw037.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw037;
      #dscaw037#28 = Linea; Linea = Linea + 1;
      #dscaw037#29 = "V";
      |GRABA 020#dscaw037.b;
   |FINSI;
   #dscaw037#11 = #agif084@#1;
   #dscaw037#12 = #agif084@#3;
   #dscaw037#13 = #agif084@#4;
   #dscaw037#14 = #agif084@#8;
   #dscaw037#16 = #agif084@#16 + #agif084@#19 + #agif084@#22 + #agif084@#42;
   #dscaw037#16 = #dscaw037@#16 + #agif084@#45;
   #dscaw037#17 = #agif084@#17 + #agif084@#20 + #agif084@#23 + #agif084@#43;
   #dscaw037#17 = #dscaw037@#17 + #agif084@#46;
   #dscaw037#18 = #agif084@#41;
   |GRABA 020#dscaw037.a; |LIBERA #dscaw037;
   |SELECT #1#dscaw037;
|FPRC;

|DEFBUCLE FactDirectas;
#agif084@#1002;
;
"     ",000000;
"zzzzz",999999;
be;
NULL,FactDirectas;
|FIN;

|PROCESO RecsVenta;
   |SELECT #4#dscaw037;
   #dscaw037#19 = #dscam003#0;
   #dscaw037#20 = #dscam003#1;
   #dscaw037#21 = #dscam003#2;
   #dscaw037#29 = "V";
   |LEE 101#dscaw037.=;
   |SI FSalida ! 0;
      #dscaw037#28 = Linea; Linea = Linea + 1;
      #dscaw037#29 = "V";
      |GRABA 020#dscaw037.b;
   |FINSI;

   #dscaw037#19 = #dscam003#0;
   #dscaw037#20 = #dscam003#1;
   #dscaw037#21 = #dscam003#2;
   #dscaw037#22 = #dscam003#40;
   #dscaw037#23 = #dscam003#32;
   #dscaw037#24 = #dscam003#5;
   #dscaw037#25 = #dscam003#6;
   #dscaw037#26 = #dscam003#64;
   #dscaw037#27 = #dscam003#60 - #dscam003#64;
   #dscaw037#29 = "V";
   |GRABA 020#dscaw037.a; |LIBERA #dscaw037;
   |SELECT #1#dscaw037;
|FPRC;

|DEFBUCLE RecsVenta;
#dscam003#1;
;
000000001;
999999999;
be;
NULL,RecsVenta;
|FIN;

|PROCESO RecsCompra;
   |SELECT #4#dscaw037;
   #dscaw037#19 = #dscam008#0;
   #dscaw037#20 = #dscam008#1;
   #dscaw037#21 = #dscam008#2;
   #dscaw037#29 = "C";
   |LEE 101#dscaw037.=;
   |SI FSalida ! 0;
      #dscaw037#28 = Linea; Linea = Linea + 1;
      #dscaw037#29 = "C";
      |GRABA 020#dscaw037.b;
   |FINSI;

   #dscaw037#19 = #dscam008#0;
   #dscaw037#20 = #dscam008#1;
   #dscaw037#21 = #dscam008#2;
   #dscaw037#22 = #dscam008#40;
   #dscaw037#23 = #dscam008#32;
   #dscaw037#24 = #dscam008#5;
   #dscaw037#25 = #dscam008#6;
   #dscaw037#26 = #dscam008#56;
   #dscaw037#27 = #dscam008#53 - #dscam008#56;
   #dscaw037#29 = "C";
   |GRABA 020#dscaw037.a; |LIBERA #dscaw037;

   |SELECT #1#dscaw037;
|FPRC;

|DEFBUCLE RecsCompra;
#dscam008#1;
;
000000001;
999999999;
be;
NULL,RecsCompra;
|FIN;

|PROCESO Impresion;
|FPRC;

|DEFBUCLE Impresion;
#dscaw037#1;
;
INICIO;
FINAL;
;
NULL,Impresion;
|FIN;

|PROGRAMA;
   |HAZ Tipo8;
   |CLS;
   |CABEZA "Informe comprobacion";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      aAlfa = #48#17; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/agifa134.mas"; |CARGA_DEF aAlfa1, agif134@;
      |SI FSalida ! 0;
         |MENAV "    Problemas al cargar la referencia (Gestion)";
         |ACABA;
      |FINSI;
      aAlfa1 = aAlfa + "def/agifa084.mas"; |CARGA_DEF aAlfa1, agif084@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #agif134@;
         |MENAV "    Problemas al cargar la referencia (Gestion)";
         |ACABA;
      |FINSI;
      aAlfa1 = aAlfa + "def/agifa079.mas"; |CARGA_DEF aAlfa1, agif079@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #agif134@;
         |DESCARGA_DEF #agif084@;
         |MENAV "    Problemas al cargar la referencia (Gestion)";
         |ACABA;
      |FINSI;
      aAlfa = aAlfa + "fich/" + (("00000" + #48#15) % -105) + "/";
      |PATH_DAT #6 aAlfa; |PATH_DAT #7 aAlfa;
      |PATH_DAT #8 aAlfa; |PATH_DAT #9 aAlfa;

      aAlfa = #48#16; |QBF aAlfa;
      aAlfa1 = aAlfa + "def/camaasic.mas"; |CARGA_DEF aAlfa1, camasic@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #agif079@; |DESCARGA_DEF #agif084@; |DESCARGA_DEF #agif134@;
         |MENAV "    Problemas al cargar la referencia (Contabilidad)";
         |ACABA;
      |FINSI;
      aAlfa1 = aAlfa + "def/camaasil.mas"; |CARGA_DEF aAlfa1, camasil@;
      |SI FSalida ! 0;
         |DESCARGA_DEF #agif079@; |DESCARGA_DEF #agif084@; |DESCARGA_DEF #agif134@;
         |DESCARGA_DEF #camasic@;
         |MENAV "    Problemas al cargar la referencia (Contabilidad)";
         |ACABA;
      |FINSI;
      aAlfa = aAlfa + "fich/" + (("00000" + #48#14) % -105) + #48#19 + "/";
      |PATH_DAT #10 aAlfa; |PATH_DAT #11 aAlfa;
      |PATH_DAT #12 aAlfa; |PATH_DAT #13 aAlfa;

      |ABRE #dscaw037; |ABRE #dscam067;

      |BUCLE RecsVenta; |BUCLE RecsCompra;
      |BUCLE FactVenta; |BUCLE FactDirectas; |BUCLE FactCompra;
      |BUCLE Asientos;
      |BUCLE Impresion;

      |CIERRA #dscam067; |CIERRA #dscaw037;

      |DESCARGA_DEF #agif079@;
      |DESCARGA_DEF #agif084@;
      |DESCARGA_DEF #agif134@;
      |DESCARGA_DEF #camasic@;
      |DESCARGA_DEF #camasil@;
   |FINSI;
   |HAZ Tipo9;
|FPRO;
