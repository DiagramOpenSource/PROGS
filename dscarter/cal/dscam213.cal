|FICHEROS;
   dscam213 #0;
   dscam214 #2,MANTE;
   dscaw056 #3;
   dscaw057 #4;
   dscaw184 #5;
   dscam215 #6,MANTE;
   dscam045 #7;
   dscam044 #8;

   dscam051 #10;
   dscam003 #11;

   agif024@ #100;
   Referen@ #101;
   agif134@ #102;
   agif084@ #103;
|FIN;

|VARIABLES;
   &Divisa = ""; &nDeci_Base = 0; &nDeci_Div = 0;
   &HayGestion = 0;
   &eaPoblacion = "";
   &eaPobCobro  = "";
   &eaProvincia = "";
   &eaProvCobro = "";
   &eaCPCobro  = "";
   &eaCP       = "";
   &eaCodigo   = "";
   &eaTipoCod  = "";

   aAlfa  = "";
   aAlfa1 = "";

   fDFecha = @;
   fHFecha = @;

   fFecha1 = @;
   fFecha2 = @;

   nCalc1  = 0;
   nCalc2  = 0;

   FEstado = 0;

   nAviso = 0;
   nModo  = 0;
   nCalc  = 0;
   nCont  = 0;
   nNumDoc = 0;
   nTecla = 0;
   nFlag  = 0;
   nSw    = 0;
   nSwOk  = 0;
   nRef   = 0;
   nModoEntrada = 0;

   nLib    = 0;
   aSer    = "";
   nDocDiv = 0;
|FIN;

|PROCESO MiraPeriodo;
   |SI #dscam213#1 = 01; aAlfa = "ENERO     "; |FINSI;
   |SI #dscam213#1 = 02; aAlfa = "FEBRERO   "; |FINSI;
   |SI #dscam213#1 = 03; aAlfa = "MARZO     "; |FINSI;
   |SI #dscam213#1 = 04; aAlfa = "ABRIL     "; |FINSI;
   |SI #dscam213#1 = 05; aAlfa = "MAYO      "; |FINSI;
   |SI #dscam213#1 = 06; aAlfa = "JUNIO     "; |FINSI;
   |SI #dscam213#1 = 07; aAlfa = "JULIO     "; |FINSI;
   |SI #dscam213#1 = 08; aAlfa = "AGOSTO    "; |FINSI;
   |SI #dscam213#1 = 09; aAlfa = "SEPTIEMBRE"; |FINSI;
   |SI #dscam213#1 = 10; aAlfa = "OCTUBRE   "; |FINSI;
   |SI #dscam213#1 = 11; aAlfa = "NOVIEMBRE "; |FINSI;
   |SI #dscam213#1 = 12; aAlfa = "DICIEMBRE "; |FINSI;
   |PINTA 0816, aAlfa;
|FPRC;

|RUTINA infm78;
   #dscam214#0 = #dscam213#0;
   #dscam214#1 = #dscam213#1;
   #dscam214#2 = #dscam213#2;
   #dscam214#3 = 1;
|FRUT;

|RUTINA supm78;
   #dscam214#0 = #dscam213#0;
   #dscam214#1 = #dscam213#1;
   #dscam214#2 = #dscam213#2;
   #dscam214#3 = 999;
|FRUT;

|PROCESO Reparte;
   nCalc = #dscam214#9 - #dscam214#8;
   #dscaw056#0 = nCalc;
   |LEE 000#dscaw056.];
   #dscaw056#1 = #dscaw056#1 + #dscam214#10;
   |GRABA 020#dscaw056.a;
|FPRC;

|DEFBUCLE Reparte;
#dscam214#1;
;
#dscam213#0, #dscam213#1, #dscam213#2,   1;
#dscam213#0, #dscam213#1, #dscam213#2, 999;
;
NULL,Reparte;
|FIN;

|RUTINA infw56;
   #dscaw056#0 = 1;
|FRUT;

|RUTINA supw56;
   #dscaw056#0 = 999;
|FRUT;

|PROCESO CogeDatos;
   nTecla = FSalida;
   nModoEntrada = (FEntrada / 100) ! 0;
   |SI nModoEntrada = 1;
      |SI HayGestion ! 0;
         aAlfa = #48#17; |QBF aAlfa;
         aAlfa = aAlfa + "def/agifa024.mas";
         |CARGA_DEF aAlfa, agif024@;
         |SI FSalida = 0;
            aAlfa = #48#17; |QBF aAlfa;
            aAlfa = aAlfa + "fich/" + (("00000" + #48#15) % -105) + "/";
            |PATH_DAT #100 aAlfa;
            |ABRE #agif024@;
            #agif024@#0 = #dscam214#3;
            |SI nTecla = 10;
               |LEE 000#agif024@.];
               |CONSULTA_CLAVE #1#agif024@;
               |SI FSalida = 0; #dscam214#3  = #agif024@#0; |FINSI;
            |FINSI;
            |LEE 000#agif024@.=;
            |SI FSalida = 0;
               #dscam214#4  = #agif024@#2;
               #dscam214#11 = #agif024@#6;
               #dscam214#12 = #agif024@#178;
               #dscam214#13 = #agif024@#179;
               #dscam214#14 = #agif024@#7;
            |SINO;
               |MENAV "    Cliente inexistente"; |ERROR;
            |FINSI;
            |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
         |FINSI;
      |SINO;
         |MENAV "   No hay empresa de gestion comercial";
         |ERROR;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO ActCliente; |TIPO 3;
   |PUSHV 0501 2380;
   |ENTLINEAL #1#dscam214,-5,2,21,1,infm78,supm78;
   |POPV;

   |HAZ Tipo13m76;
|FPRC;
/*
|PROCESO Detalle; |TIPO 11;
   nTecla = FSalida;
   nModoEntrada = (FEntrada / 100) ! 0;
   |SI nTecla = 10; |Y nModoEntrada = 1;
      aAlfa = #48#17; |QBF aAlfa;
      aAlfa = aAlfa + "def/agifa024.mas";
      |CARGA_DEF aAlfa, agif024@;
      |SI FSalida = 0;
         aAlfa = #48#17; |QBF aAlfa;
         aAlfa = aAlfa + "fich/" + (("00000" + #48#15) % -105) + "/";
         |PATH_DAT #100 aAlfa;
         |ABRE #agif024@;
         #agif024@#0 = #dscam213#3;
         |LEE 000#agif024@.];
         |CONSULTA_CLAVE #1#agif024@;
         |SI FSalida = 0;
            #dscam077#3  = #agif024@#0;
            #dscam077#4  = #agif024@#2;
            #dscam077#11 = #agif024@#6;
            #dscam077#12 = #agif024@#178;
            #dscam077#13 = #agif024@#179;
            #dscam077#14 = #agif024@#7;
         |FINSI;
         |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
      |FINSI;
   |FINSI;
   |SI nTecla = 11;
      |PUSHV 0501 2380;
      |BLANCO 1001 2363;
      |PINTA 1002, "ษ";
      |ATRI R; |PINTA 1003, " DETALLE CLIENTE "; |ATRI N;
      |PINTA 1020, "อออัออออออออออัออออออออออัออออัอออออออออออป";
      aAlfa = #dscam077#3 + " " + #dscam077#4; |QBF aAlfa; aAlfa = aAlfa + " ";
      |ATRI R; |PINTA 1020, aAlfa; |ATRI N;
      |ENTLINEAL #1#dscam214,-5,4,21,1,infm78,supm78;
      |POPV;
      |ERROR;
   |FINSI;
   |SI nTecla = 12;
      |PUSHV 0501 2380;
      |ABRE #dscam051;
      |LEE 000#dscam051.=;
      |SI FSalida ! 0;
         |MENAV "    No hay ficha de parametros generales. Proceso abortado";
         |CIERRA #dscam051; |ACABA;
      |FINSI;
      |SI #dscam051#45 = 0; |O #dscam051#46 = 0;
         |MENAV "    No hay datos indicados en los parametros generales. Proceso abortado";
         |CIERRA #dscam051; |ACABA;
      |FINSI;

      |CIERRA #dscam051;

      aAlfa = "di" + Usuario; |NOME_DAT #3 aAlfa;
      |DELINDEX #dscaw056; |ABRE #dscaw056;
      |PARA nCont = 1; |SI nCont [ #dscam051#46; |HACIENDO nCont = nCont + 1;
         nCalc = nCont * #dscam051#45;
         |DDEFECTO #dscaw056;
         #dscaw056#0 = nCalc;
         |GRABA 020#dscaw056.n;
      |SIGUE;

      |DDEFECTO #dscaw056; #dscaw056#0 = 999; |GRABA 020#dscaw056.n;
      |BUCLE Reparte;
      |ENTLINEAL #1#dscaw056,-1,4,22,1,infw56,supw56;
      |CIERRA #dscaw056;
      |POPV;
      |ERROR;
   |FINSI;
|FPRC;
*/

|PROCESO LinCab;
   |SI nSw = 1; |Y #dscam214#4 = nRef; |ACABA; |FINSI;
   nCalc = #dscam214#9 - #dscam214#8;
   #dscaw057#0 = nCalc;
   |LEE 000#dscaw057.];
   #dscaw057#1 = #dscaw057#1 + #dscam214#10;
   |GRABA 020#dscaw057.a;
|FPRC;

|DEFBUCLE LinCab;
#dscam214#1;
;
#dscam213#0, #dscam213#1, #dscam213#2,   1;
#dscam213#0, #dscam213#1, #dscam213#2, 999;
;
NULL,LinCab;
|FIN;

|RUTINA infw57;
   #dscaw057#0 = 1;
|FRUT;

|RUTINA supw57;
   #dscaw057#0 = 999;
|FRUT;

|PROCESO TotalizaLineas;
   #dscam213#3 = #dscam213#3 + #dscam214#7;
|FPRC;

|DEFBUCLE TotalizaLineas;
#dscam214#1;
;
#dscam213#0, #dscam213#1, #dscam213#2,   1;
#dscam213#0, #dscam213#1, #dscam213#2, 999;
;
NULL,TotalizaLineas;
|FIN;

|PROCESO Totaliza;
   #dscam213#3 = 0;
   |SALVA_FICHA #dscam214;
   |BUCLE TotalizaLineas;
   |REPON_FICHA #dscam214;
   |GRABA 020#dscam213.a;
   |PINTA #dscam213#3;
|FPRC;

|PROCESO Tipo13m76; |TIPO 13;
   aAlfa = "di" + Usuario; |NOME_DAT #4 aAlfa;
   |DELINDEX #dscaw057; |ABRE #dscaw057;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |PARA nCont = 1; |SI nCont [ #dscam051#46; |HACIENDO nCont = nCont + 1;
      nCalc = nCont * #dscam051#45;
      |DDEFECTO #dscaw057;
      #dscaw057#0 = nCalc;
      |GRABA 020#dscaw057.n;
   |SIGUE;


   |LEE 000#dscam213.c;
   |SI FSalida = 0;
      |HAZ Totaliza;
   |FINSI;

/*
   |DDEFECTO #dscaw057; #dscaw057#0 = 999; |GRABA 020#dscaw057.n;
   |BUCLE LinCab;
   |ENTLINEAL #1#dscaw057,-1,7,16,1,infw57,supw57;
   |CIERRA #dscaw057;
*/
   |HAZ MiraPeriodo;
|FPRC;

|PROCESO CalcDias;
   #dscam214#16 = #dscam214#9 - #dscam214#8;
|FPRC;

|PROCESO MarcaRecs;
   |SI nFlag < 0;
      #dscam003#89 = "N";
      #dscam003#105 = 0;
   |SINO;
      #dscam003#89 = "S";
      #dscam003#105 = #dscam214#8;
   |FINSI;
   |GRABA 020#dscam003.a;
|FPRC;

|DEFBUCLE MarcaRecs;
#dscam003#9;
4;
00, #dscam214#4, #dscam214#5, 000, 000000001, fDFecha;
00, #dscam214#4, #dscam214#5, 999, 999999999, fHFecha;
be;
NULL, MarcaRecs;
|FIN;

|PROCESO LineasVtos; |TIPO 2;
   nFlag = 0 +. 1;
   nModo = (FEntrada / 100) ! 0;

   || Marca/Desmarca el/los recibos
   aAlfa = #dscam214#18; |QBF aAlfa; aAlfa = aAlfa % -104;
   aAlfa1 = "01.01." + aAlfa; fDFecha = aAlfa1;
   aAlfa1 = "31.12." + aAlfa; fHFecha = aAlfa1;
   |BUCLE MarcaRecs;

   |SI #dscam214#9 > #dscam214#8;
      #dscam214#15 = "S";
   |SINO;
      #dscam214#15 = "N";
   |FINSI;
   ||GRABA 020#dscam214.a;

   |SI nFlag < 0;
      nSw = 1; nRef = #dscam214#4;
      |HAZ Tipo13m76; nSw = 0;
      #dscam213#3 = #dscam213#3 - #dscam214#7; |PINTA #dscam213#3;
   |SINO;
      |HAZ Tipo13m76;
      |SI nModo = 1;
         #dscam213#3 = #dscam213#3 + #dscam214#7; |PINTA #dscam213#3;
      |FINSI;
   |FINSI;
|FPRC;

|PROCESO Tipo5; |TIPO 5;
   |LINEAS_BI_ATRI #dscam214#15,D,S,-1;
|FPRC;

|PROCESO PasaFrasVta;
   #agif024@#0 = #agif134@#2;
   |LEE 000#agif024@.];
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   #dscaw184#0 = #agif134@#49;
   #dscaw184#1 = #agif134@#0;
   |LEE 000#dscaw184.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw184;
   #dscaw184#0 = #agif134@#49;
   #dscaw184#1 = #agif134@#0;
   #dscaw184#2 = #agif134@#2;
   #dscaw184#3 = #agif134@#3;
   #dscaw184#4 = #agif134@#1;
   #dscaw184#5 = #agif134@#101;

   #dscaw184#7 = #dscam215#21;
   #dscaw184#9 = #dscam215#2;

   #dscaw184#11 = #agif024@#9;
   aAlfa = (("00" + #agif024@#181) % -102) + (("000" + #agif024@#182) % -103)
   #dscaw184#12 = aAlfa;
   #dscaw184#13 = #agif024@#10;
   #dscaw184#14 = #agif134@#1;

   |SELECT #9#dscam003;
   #dscam003#27 = 0;
   #dscam003#0 = #agif134@#49;
   #dscam003#1 = #agif134@#0;
   #dscam003#2 = 1;
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#27 = 0; |Y #dscam003#0 = #agif134@#49;
                           |Y #dscam003#1 = #agif134@#0; |HACIENDO;
      |SI #dscam003#4 = #agif134@#1; nNumDoc = #dscam003#40; |FINSI;
       |SI #dscam003#14 = "F"; |O #dscam003#14 = "T";
           |SI #dscaw184#4 < #dscam003#71; #dscaw184#4 = #dscam003#71; |FINSI;
       |SINO;
          |SI #dscaw184#4 < #dscam003#3; #dscaw184#4 = #dscam003#3; |FINSI;
      |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;

   |SELECT #1#dscam003;
   #dscam003#40 = nNumDoc;
   |LEE 000#dscam003.=;
   |SI FSalida = 0;
      fFecha1 = #dscam003#3; fFecha2 = #dscam003#4;
      nCalc1 = fFecha1;      nCalc2 = fFecha2;
      nCalc = nCalc2 - nCalc1;
      #dscaw184#8 = nCalc;
      #dscaw184#10 = nNumDoc;
   |FINSI;
   |GRABA 020#dscaw184.n;
|FPRC;

|DEFBUCLE PasaFrasVta;
#agif134@#3004;
;
#dscam215#4, fDFecha, "     ", 000000;
#dscam215#4, fHFecha, "zzzzz", 999999;
;
NULL, PasaFrasVta;
|FIN;

|PROCESO PasaFrasDir;

   #agif024@#0 = #agif084@#3;
   |LEE 000#agif024@.];
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   #dscaw184#0 = #agif084@#48;
   #dscaw184#1 = #agif084@#0;
   |LEE 000#dscaw184.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw184;
   #dscaw184#0  = #agif084@#48;
   #dscaw184#1  = #agif084@#0;
   #dscaw184#2  = #agif084@#3;
   #dscaw184#3  = #agif084@#4;
   #dscaw184#4  = #agif084@#1;
   #dscaw184#5  = #agif084@#73;
   #dscaw184#11 = #agif084@#73;
   #dscaw184#12 = #agif084@#73;
   #dscaw184#13 = #agif084@#73;

   #dscaw184#7  = #dscam215#21;
   #dscaw184#9  = #dscam215#2;
   #dscaw184#11 = #agif024@#9;
   aAlfa = (("00" + #agif024@#181) % -102) + (("000" + #agif024@#182) % -103)
   #dscaw184#12 = aAlfa;
   #dscaw184#13 = #agif024@#10;

   |SELECT #9#dscam003;
   #dscam003#27 = 0;
   #dscam003#0 = #agif084@#48;
   #dscam003#1 = #agif084@#0;
   #dscam003#2 = 1;
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#27 = 0; |Y #dscam003#0 = #agif084@#48;
                           |Y #dscam003#1 = #agif084@#0; |HACIENDO;
      |SI #dscam003#4 = #agif084@#1; nNumDoc = #dscam003#40; |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;

   |SELECT #1#dscam003;
   #dscam003#40 = nNumDoc;
   |LEE 000#dscam003.=;
   |SI FSalida = 0;
      fFecha1 = #dscam003#3; fFecha2 = #dscam003#4;
      nCalc1 = fFecha1;      nCalc2 = fFecha2;
      nCalc = nCalc2 - nCalc1;
      #dscaw184#8 = nCalc;
      #dscaw184#10 = nNumDoc;
   |FINSI;
   |GRABA 020#dscaw184.n;
|FPRC;

|DEFBUCLE PasaFrasDir;
#agif084@#3004;
;
#dscam215#4, fDFecha, "     ", 000000;
#dscam215#4, fHFecha, "zzzzz", 999999;
;
NULL, PasaFrasDir;
|FIN;

|PROCESO SelecFacturas;
   |SELECT #2#dscam045;
   #dscam045#6 = #48#0;
   |LEE 000#dscam045.];
   |PARA; |SI FSalida = 0; |Y #dscam045#6 = #48#0; |HACIENDO;
      #dscam044#0 = #dscam045#0;
      |LEE 000#dscam044.=;
      |SI FSalida = 0;
         aAlfa = #dscam044#1; |QBF aAlfa;
         aAlfa1 = aAlfa + "def/agifa024.mas";
         |CARGA_DEF aAlfa1, agif024@;
         |SI FSalida = 0;
            aAlfa1 = aAlfa + "fich/" + (("00000" + #dscam044#0) % -105) + "/";
            |PATH_DAT #agif024@#aAlfa#; |ABRE #agif024@;

            aAlfa = #dscam044#1; |QBF aAlfa;
            aAlfa1 = aAlfa + "def/agifa134.mas";
            |CARGA_DEF aAlfa1, agif134@;
            |SI FSalida = 0;
               aAlfa1 = aAlfa + "fich/" + (("00000" + #dscam044#0) % -105) + "/";
               |PATH_DAT #agif134@#aAlfa1#;
               |BUCLE PasaFrasVta;
               |DESCARGA_DEF #agif134@;
            |FINSI;

            aAlfa = #dscam044#1; |QBF aAlfa;
            aAlfa1 = aAlfa + "def/agifa084.mas";
            |CARGA_DEF aAlfa1, agif084@;
            |SI FSalida = 0;
               aAlfa1 = aAlfa + "fich/" + (("00000" + #dscam044#0) % -105) + "/";
               |PATH_DAT #agif084@#aAlfa1#;
               |BUCLE PasaFrasDir;
               |DESCARGA_DEF #agif084@;
            |FINSI;

            |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
         |FINSI;
      |FINSI;
      |LEE 000#dscam045.s;
   |SIGUE;
|FPRC;

|PROCESO Expedientes;
   |HAZ SelecFacturas;
|FPRC;

|DEFBUCLE Expedientes;
#dscam215#1;
;
#dscam213#0, "                    ";
#dscam213#0, "zzzzzzzzzzzzzzzzzzzz";
;
NULL, Expedientes;
|FIN;

|PROCESO MiraSiExiste;
   FEstado = -1;
   |DDEF aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "dscam214.mas";
   |CARGA_DEF aAlfa, Referen@;
   |SI FSalida = 0;
      |ABRE #Referen@; |SELECT #3#Referen@;
      #Referen@#0 = #dscam213#0;
      #Referen@#1 = #dscam213#1;
      #Referen@#2 = #dscam213#2;
      #Referen@#4 = #dscam003#0;
      #Referen@#5 = #dscam003#1;
      |LEE 000#Referen@.=;
      FEstado = FSalida;
      |SELECT #1#Referen@;
      |CIERRA #Referen@; |DESCARGA_DEF #Referen@;
   |FINSI;
|FPRC;

|PROCESO CogeRecs;
   nTecla = FSalida;
   |ABRE #dscam003;
   |SI nTecla = 10;

      aAlfa = "tr" + Usuario; |NOME_DAT #dscaw184#aAlfa#;
      |DELINDEX #dscaw184; |ABRE #dscaw184;
      aAlfa1 = "01." + (("00" + #dscam213#1) % -102) + "." + #dscam213#2; fDFecha = aAlfa1;
      |SI #dscam213#1 = 12;
         aAlfa1 = "01." + (("00" + #dscam213#1) % -102) + "." + (#dscam213#2 + 1); fHFecha = aAlfa1;
      |SINO;
         aAlfa1 = "01." + (("00" + (#dscam213#1 + 1)) % -102) + "." + #dscam213#2; fHFecha = aAlfa1;
      |FINSI;
      nCalc = fHFecha; nCalc = nCalc - 1; fHFecha = nCalc;

      |DFICB aAlfa; |QBF aAlfa;
      |PATH_DAT #dscam044#aAlfa#; |PATH_DAT #dscam045#aAlfa#;
      |ABRE #dscam044;   |ABRE #dscam045;
      |LEE 000#dscam045.p;
      |BUCLE Expedientes;
      |CIERRA #dscam045; |CIERRA #dscam044;

      |CONSULTA_CLAVE #1#dscaw184;
      |SI FSalida = 0;
         #dscam214#4  = #dscaw184#0;  |PINTA #dscam214#4;
         #dscam214#5  = #dscaw184#1;  |PINTA #dscam214#5;
         #dscam214#6  = #dscaw184#4;  |PINTA #dscam214#6;
         #dscam214#7  = #dscaw184#5;  |PINTA #dscam214#7;
         #dscam214#8  = #dscaw184#7;  |PINTA #dscam214#8;
         #dscam214#9  = #dscaw184#8;  |PINTA #dscam214#9;
         #dscam214#10 = #dscaw184#2;  |PINTA #dscam214#10;
         #dscam214#11 = #dscaw184#3;  |PINTA #dscam214#11;
         #dscam214#12 = #dscaw184#11; |PINTA #dscam214#12;
         #dscam214#13 = #dscaw184#12; |PINTA #dscam214#13;
         #dscam214#14 = #dscaw184#13; |PINTA #dscam214#14;
         |SI #dscam214#9 > #dscam214#8;
            #dscam214#15 = "S";
         |SINO;
            #dscam214#15 = "N";
         |FINSI;
         #dscam214#17 = #dscaw184#10;
         #dscam214#18 = #dscaw184#14;
      |FINSI;
      |ERROR;
   |SINO;
      |SI Campo = 5;
         aAlfa = #dscam214#18; |QBF aAlfa; aAlfa = aAlfa % -104;
         |SI aAlfa = "0000"; aAlfa = #dscam213#2; |FINSI;
         nSwOk = 0;
         aAlfa1 = "01.01." + aAlfa; fDFecha = aAlfa1;
         aAlfa1 = "31.12." + aAlfa; fHFecha = aAlfa1;
         |SELECT #6#dscam003;
         #dscam003#27 = 0;
         #dscam003#0  = #dscam214#4;
         #dscam003#1  = #dscam214#5;
         #dscam003#2  = 1;
         #dscam003#69 = " ";
         #dscam003#40 = 1;
         |LEE 000#dscam003.];
         |PARA; |SI FSalida = 0; |Y #dscam003#27 = 0; |Y #dscam003#0  = #dscam214#4;
          |Y #dscam003#1  = #dscam214#5; |Y #dscam003#69 = " "; |HACIENDO;
             |SI #dscam003#4 ] fDFecha; |Y #dscam003#4 [ fHFecha;
                nSwOk = 1; nNumDoc = #dscam003#40;
             |FINSI;
             |LEE 000#dscam003.s;
         |SIGUE;
         |SELECT #1#dscam003;
         |SI nSwOk = 1;
            #dscam003#40 = nNumDoc;
            |LEE 000#dscam003.=;
            |SI FSalida = 0;
               |SI #dscam003#89 ! "N";
                  |MENAV "    El recibo ya esta declarado"; |ERROR;
               |SINO;
                  Divisa = #dscam003#57; |HAZ TomaDecim;
                  |HAZ MiraSiExiste;
                  |SI FEstado ! 0;
                     eaCodigo = #dscam003#32; eaTipoCod = "C"; |HAZ LeeDatos;

                          |SI #dscam003#14 = "F"; |O #dscam003#14 = "T";
                              #dscam214#6  = #dscam003#71;  |PINTA #dscam214#6;
                          |SINO;
                         #dscam214#6  = #dscam003#3;  |PINTA #dscam214#6;
                           |FINSI;
                     #dscam214#7  = #dscam003#30; |PINTA #dscam214#7;
                     ||#dscam214#8  = #dscam003#4;  |PINTA #dscam214#8;
                     ||#dscam214#9  = #dscam003#3;  |PINTA #dscam214#9;
                     #dscam214#10 = #dscam003#32; |PINTA #dscam214#10;
                     #dscam214#11 = #dscam003#6; |PINTA #dscam214#11;
                     #dscam214#12 = eaPoblacion; |PINTA #dscam214#12;
                     #dscam214#13 = eaCP;        |PINTA #dscam214#13;
                     #dscam214#14 = eaProvincia; |PINTA #dscam214#14;
                     |SI #dscam214#9 > #dscam214#8;
                        #dscam214#15 = "S";
                     |SINO;
                        #dscam214#15 = "N";
                     |FINSI;
                     #dscam214#17 = #dscam003#40;
                     #dscam214#18 = #dscam003#4;
                  |SINO;
                         |SI #dscam003#14 = "F"; |O #dscam003#14 = "T";
                         |SI #dscam214#6 < #dscam003#71; #dscam214#6 = #dscam003#71; |FINSI;
                         |SINO;
                         |SI #dscam214#6 < #dscam003#3; #dscam214#6 = #dscam003#3; |FINSI;
                          |FINSI;
                     |PINTA #dscam214#6;
                  |FINSI;
               |FINSI;
            |FINSI;
         |SINO;
            |MENAV "    Recibo inexistente"; |ERROR;
         |FINSI;
         |SELECT #1#dscam003;
      |FINSI;
   |FINSI;
   |CIERRA #dscam003;
|FPRC;

|PROCESO DesmarcaDiv;
   #dscam003#89 = "N";
   #dscam003#105 = 0;
   |GRABA 020#dscam003.a;
|FPRC;

|DEFBUCLE DesmarcaDiv;
#dscam003#9;
83;
nLib, aSer, 000000, 000, 000000001, nDocDiv;
nLib, aSer, 999999, 999, 999999999, nDocDiv;
;
NULL, DesmarcaDiv;
|FIN;

|PROCESO BajaRecibosFra;
   |SI #dscam003#14 = "D";
      |SALVA_FICHA #dscam003;
      nLib = #dscam003#27;
      aSer = #dscam003#0;
      nDocDiv = #dscam003#40;
      |BUCLE DesmarcaDiv;
      |REPON_FICHA #dscam003;
   |FINSI;

   #dscam003#89 = "N";
   #dscam003#105 = 0;
   |GRABA 020#dscam003.a;
|FPRC;

|DEFBUCLE BajaRecibosFra;
#dscam003#9;
4;
00, #dscam214#4, #dscam214#5, 001, 000000001, fDFecha;
00, #dscam214#4, #dscam214#5, 999, 999999999, fHFecha;
be;
NULL, BajaRecibosFra;
|FIN;

|PROCESO BajaRecibos;
   aAlfa = #dscam214#18; |QBF aAlfa;
   aAlfa = aAlfa % -104;
   aAlfa1 = "01.01." + aAlfa; fDFecha = aAlfa1;
   aAlfa1 = "31.12." + aAlfa; fHFecha = aAlfa1;
   |BUCLE BajaRecibosFra;
   |BORRA 020#dscam214.a;
|FPRC;

|DEFBUCLE BajaRecibos;
#dscam214#1;
;
#dscam213#0, #dscam213#1, #dscam213#2, 001;
#dscam213#0, #dscam213#1, #dscam213#2, 999;
;
NULL,BajaRecibos;
|FIN;

|PROCESO Tipo1m076; |TIPO 1;
   nModo = (FEntrada / 100) ! 0;
   |ABRE #dscam003;
   |SI nModo = 3; |BUCLE BajaRecibos; |FINSI;
   |CIERRA #dscam003;
|FPRC;

|PROCESO Tipo07m076; |TIPO 7;
   nModo = (FEntrada / 100) ! 0;
   |SI nModo ! 4;
      |ABRE #dscam051;
      |LEE 000#dscam051.p;
      |SI FSalida = 0;
         |SI #dscam051#3 = "N"; |Y nAviso = 0;
            |MENAV "    No tiene activado el control de riesgo en parametros generales";
            nAviso = 1;
         |FINSI;
      |FINSI;
      |CIERRA #dscam051;
   |FINSI;
|FPRC;
