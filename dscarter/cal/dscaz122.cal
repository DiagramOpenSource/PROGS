|FICHEROS;
   dscaz122 #0;
   canempr@ #10;
   cacuent@ #11;

   dscaw092 #100;
   dscaw093 #101;
|FIN;

|VARIABLES;
   &enSaldo1 = 0;
   &enSaldo2 = 0;
   &enSaldo3 = 0;
   &enSaldo4 = 0;

   aAlfa     = "";
   aAlfa1    = "";
   aDir      = "";

   nCalc     = 0;
   nTecla    = 0;
   nMaxDigit = 0;
|FIN;

|PROCESO MiraEmpresa;
   nTecla = FSalida;
   |SI FSalida = 2; |ACABA; |FINSI;

   aAlfa = #48#16; |QBF aAlfa;
   aAlfa = aAlfa - "contagen";
   |SI FSalida ! 0;
      |DBASS aDir; |QBF aDir; aDir = aDir + "contagen/";
   |SINO;
      |DBASS aDir; |QBF aDir; aDir = aDir + "agicont/";
   |FINSI;
   aAlfa = aDir + "def/canempre.mas";
   |CARGA_DEF aAlfa, canempr@;
   |SI FSalida = 0;
      aAlfa = aDir + "fich/"; |PATH_DAT #canempr@#aAlfa#;
      |ABRE #canempr@;
      |SI nTecla = 10;
         #canempr@#2 = #dscaz122#0;
         #canempr@#3 = #dscaz122#1;
         |LEE 000#canempr@.];
         |CONSULTA_CLAVE #1#canempr@;
         |SI FSalida = 0;
            #dscaz122#0 = #canempr@#2; |PINTA #dscaz122#0;
            #dscaz122#1 = #canempr@#3; |PINTA #dscaz122#1;
            #dscaz122#2 = #canempr@#1; |PINTA #dscaz122#2;
         |FINSI;
      |FINSI;

      #canempr@#2 = #dscaz122#0;
      #canempr@#3 = #dscaz122#1;
      |LEE 000#canempr@.=;
      |SI FSalida = 0;
         #dscaz122#2 = #canempr@#1; |PINTA #dscaz122#2;
         nMaxDigit = 0;
         |SI #canempr@#14 > nMaxDigit; nMaxDigit = #canempr@#14; |FINSI;
         |SI #canempr@#15 > nMaxDigit; nMaxDigit = #canempr@#15; |FINSI;
         |SI #canempr@#16 > nMaxDigit; nMaxDigit = #canempr@#16; |FINSI;
         |SI #canempr@#17 > nMaxDigit; nMaxDigit = #canempr@#17; |FINSI;
         |SI #canempr@#18 > nMaxDigit; nMaxDigit = #canempr@#18; |FINSI;
         |SI #canempr@#19 > nMaxDigit; nMaxDigit = #canempr@#19; |FINSI;
      |SINO;
         |SI Campo = 1;
            |MENAV "    Empresa inaccesible";
            |ERROR;
         |FINSI;
      |FINSI;
      |CIERRA #canempr@; |DESCARGA_DEF #canempr@;
   |FINSI;
|FPRC;

|PROCESO SaldosCli;
   enSaldo1 = 0; enSaldo2 = 0; enSaldo3 = 0; enSaldo4 = 0;

   nCalc = nMaxDigit - 4; aAlfa1 = "0" * nCalc;
   nCalc = 0 - (100 + nCalc);
   aAlfa = #dscaw092#0;
   aAlfa = aAlfa1 + aAlfa
   aAlfa = aAlfa % nCalc;
   aAlfa = "4300" + aAlfa;
   #cacuent@#0 = aAlfa;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   enSaldo1 = #cacuent@#53;

   nCalc = nMaxDigit - 4; aAlfa1 = "0" * nCalc;
   nCalc = 0 - (100 + nCalc);
   aAlfa = #dscaw092#0;
   aAlfa = aAlfa1 + aAlfa
   aAlfa = aAlfa % nCalc;
   aAlfa = "4310" + aAlfa;
   #cacuent@#0 = aAlfa;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   enSaldo2 = #cacuent@#53;

   nCalc = nMaxDigit - 4; aAlfa1 = "0" * nCalc;
   nCalc = 0 - (100 + nCalc);
   aAlfa = #dscaw092#0;
   aAlfa = aAlfa1 + aAlfa
   aAlfa = aAlfa % nCalc;
   aAlfa = "4311" + aAlfa;
   #cacuent@#0 = aAlfa;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   enSaldo3 = #cacuent@#53;

   nCalc = nMaxDigit - 4; aAlfa1 = "0" * nCalc;
   nCalc = 0 - (100 + nCalc);
   aAlfa = #dscaw092#0;
   aAlfa = aAlfa1 + aAlfa
   aAlfa = aAlfa % nCalc;
   aAlfa = "4312" + aAlfa;
   #cacuent@#0 = aAlfa;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   enSaldo4 = #cacuent@#53;

   |SI enSaldo1 ! #dscaw092#7; |O enSaldo2 ! #dscaw092#2;
    |O enSaldo3 ! #dscaw092#3; |O enSaldo4 ! #dscaw092#4;
      |PRINT;
   |FINSI;
|FPRC;

|DEFBUCLE SaldosCli;
#dscaw092#1;
;
INICIO;
FINAL;
;
NULL,SaldosCli;
|FIN;

|PROCESO SaldosBnc;
   enSaldo1 = 0;

   nCalc = nMaxDigit - 4; aAlfa1 = "0" * nCalc;
   nCalc = 0 - (100 + nCalc);
   aAlfa = #dscaw093#0;
   aAlfa = aAlfa1 + aAlfa
   aAlfa = aAlfa % nCalc;
   aAlfa = "5208" + aAlfa;
   #cacuent@#0 = aAlfa;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
   enSaldo1 = #cacuent@#53;

   |SI enSaldo1 ! #dscaw093#2; |PRINT; |FINSI;
|FPRC;

|DEFBUCLE SaldosBnc;
#dscaw093#1;
;
INICIO;
FINAL;
;
NULL,SaldosBnc;
|FIN;

|PROCESO Tipo03; |TIPO 03;
   |ABRE #dscaw092;   |ABRE #dscaw093;

   aAlfa = #48#16; |QBF aAlfa;
   aAlfa = aAlfa - "contagen";
   |SI FSalida ! 0;
      |DBASS aDir; |QBF aDir; aDir = aDir + "contagen/";
   |SINO;
      |DBASS aDir; |QBF aDir; aDir = aDir + "agicont/";
   |FINSI;
   aAlfa = aDir + "def/cacuenta.mas";
   |CARGA_DEF aAlfa, cacuent@;
   |SI FSalida = 0;
      aAlfa = aDir + "fich/" + (("00000" + #dscaz122#0) % -105) + #dscaz122#1 + "/"; |PATH_DAT #cacuent@#aAlfa#;
      |ABRE #cacuent@;
      |IMPRE 0;
      |SI FSalida = 0;
         |INFOR "dsca122a";
         |SI FSalida = 0;
            |BUCLE SaldosCli;
            |PIEINF; |FININF;
         |FINSI;

         |INFOR "dsca122b";
         |SI FSalida = 0;
            |BUCLE SaldosBnc;
            |PIEINF; |FININF;
         |FINSI;

         |INFOR "dsca122c";
         |SI FSalida = 0;
            #cacuent@#0 = "4311";
            |LEE 000#cacuent@.=;
            |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
            enSaldo1 = #cacuent@#53;

            #cacuent@#0 = "4312";
            |LEE 000#cacuent@.=;
            |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
            enSaldo2 = #cacuent@#53;

            #cacuent@#0 = "5208";
            |LEE 000#cacuent@.=;
            |SI FSalida ! 0; |DDEFECTO #cacuent@; |FINSI;
            enSaldo3 = #cacuent@#53;
            |PRINT;
            |PIEINF; |FININF;
         |FINSI;
         |FINIMP;
      |FINSI;
      |CIERRA #cacuent@; |DESCARGA_DEF #cacuent@;
   |FINSI;
   |CIERRA #dscaw092; |CIERRA #dscaw093;
|FPRC;
