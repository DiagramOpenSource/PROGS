|FICHEROS;
   dscaz121 #0;

   dscam012 #10;
   dscam013 #11;
   dscam003 #12;
   dscam004 #13;

   dscaw094 #100;
|FIN;

|VARIABLES;
   &eaMarca = "";

   nSwPrim  = 0;
   nSwPrint = 0;
   nSw      = 0;
|FIN;

|PROCESO Imprime;
   |PRINT;
|FPRC;

|PROCESO LinRecibo;
   |SI nSw = 0;
      |SI #dscam004#5 = "IMP"; nSwPrint = 1; |ERROR10; |FINSI;
   |FINSI;

   |SI nSw = 1;
      |SI nSwPrim = 1;
         nSwPrim = 0;
         |SI nSwPrint = 1; |HAZ Imprime; |FINSI;
         |SI #dscam004#5 ! "RPT"; |BORRA 020#dscam004.a; |FINSI;
      |SINO;
         |SI nSwPrint = 1; |HAZ Imprime; |FINSI;
         |BORRA 020#dscam004.a;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LinRecibo;
#dscam004#1;
;
#dscam003#40, 01;
#dscam003#40, 99;
be;
NULL,LinRecibo;
|FIN;

|PROCESO Recibos;
   #dscam003#40 = #dscaw094#0;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;

      |SI #dscam003#70 = "          "; |Y #dscam003#72 = "    ";
         #dscam003#72 = #dscaw094#1;
         #dscam003#70 = #dscaw094#2;
         eaMarca = "******";
      |SINO;
         eaMarca = "      ";
      |FINSI;
      nSwPrint = 0; nSw = 0; |BUCLE LinRecibo;
      nSwPrim  = 1; nSw = 1; |BUCLE LinRecibo;

      #dscam004#17 = #dscam003#40;
      #dscam004#3  = 1;
      |LEE 000#dscam004.];
      |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40;
         |SI #dscam004#51 ! "    "; |O #dscam004#52 ! "          ";
            #dscam003#14 = "T";
            #dscam003#15 = "Talon/Pagare de cliente";
            #dscam003#72 = #dscam004#51;
            #dscam003#70 = #dscam004#52;
         |FINSI;
      |FINSI;

      #dscam003#31 = #dscam003#30; #dscam003#65 = #dscam003#64;
      #dscam003#23 = 0;            #dscam003#61 = 0;
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE Recibos;
#dscaw094#2;
;
INICIO;
FINAL;
;
NULL, Recibos;
|FIN;

|PROCESO LinRemesas;
   #dscaw094#0 = #dscam013#16;
   |LEE 000#dscaw094.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw094;
      #dscaw094#0 = #dscam013#16;
      #dscaw094#1 = #dscam013#37;
      #dscaw094#2 = #dscam013#38;
      |GRABA 020#dscaw094.n;
   |FINSI;

   #dscam012#10 = #dscam012#10 - #dscam013#7;
   #dscam012#12 = #dscam012#12 - #dscam013#10;
   |BORRA 020#dscam013.a;
|FPRC;

|DEFBUCLE LinRemesas;
#dscam013#1;
;
#dscam012#0, 001;
#dscam012#0, 999;
;
NULL,LinRemesas;
|FIN;

|PROCESO Remesas;
   |BUCLE LinRemesas;
   |SI #dscam012#10 = 0;
      |BORRA 020#dscam012.a;
   |SINO;
      |GRABA 020#dscam012.a;
   |FINSI;
   |LIBERA #dscam012;
|FPRC;

|DEFBUCLE Remesas;
#dscam012#1;
22;
00001,3;
99999,4;
be;
NULL,Remesas;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA " Recalculo arimesa ";
   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0; |Y #0#0 = "S";
      |IMPRE 0;
      |SI FSalida = 0;
         |INFOR "dscaz121";
         |SI FSalida = 0;
            |ABRE #dscaw094;
            |BUCLE Remesas;
            |ABRE #dscam012;
            |ABRE #dscam013; |SELECT #4#dscam013;
            |ABRE #dscam003;
            |BUCLE Recibos;
            |CIERRA #dscam003;
            |CIERRA #dscam013; |CIERRA #dscam012;
            |CIERRA #dscaw094;
            |PIEINF; |FININF;
         |FINSI;
         |FINIMP;
      |FINSI;
   |FINSI;
|FPRO;
