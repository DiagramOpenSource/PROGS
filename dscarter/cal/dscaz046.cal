|FICHEROS;
   dscaz046 #0;

   dscam003 #1;
   dscam004 #2;
   dscaw034 #3;
   dscam014 #4;

   dscam051 #5;

   dscam038 #50;

   agif010@ #100;
|FIN;

|VARIABLES;
   &Divisa = "";
   &aInforme = "";

   &TipoCliente = ""; &CodCliente = "";
   &DCampoG = 0;      &HCampoG = 0;

   Campo1 = 0;
   nCalc  = 0;
   nCalc1 = 0;
   Tecla  = 0;

   nEmpGestion = 0;
   nEmpCartera = 0;
   DBanco   = 0;
   HBanco   = 0;
   Primero  = 1;
   SwError  = 1;
   SwFind   = 0;
   SwOk     = 1;

   nCont    = 0;
   CambiaBanco = 0;
   Guarda   = 0;
   NumLins  = 66;
   &ContLin = 0;

   aCodCliente = "";
   aCtaCliente = "";
   fFechaVto   = @;
   aTipoAnt    = "";
   nBancoAnt   = -1;
   aAlfa       = "";

   &eaTitulo    = "";
   &eaFinal     = "";
   &eaTitOrd    = "";
   &eaFinOrd    = "";
   &enTotalTipo = 0;
   &enTotalGen  = 0;
   &enTotalOrd  = 0;
   &enTotalBan  = 0;
   &nDeci_Base  = 0;
   &enSwSalto   = 0;
   &enSwMov     = 0;
   &enSwMovC    = 0;
   &enSwMovP    = 0;
   &enSwCabBan  = 0;
   &enSwPieBan  = 0;
   &enSwCabOrd  = 0;
   &enSwPieOrd  = 0;
   &enSwCabTipo = 0;
   &enSwPieTipo = 0;
   &enSwDetalle = 0;
   &enSwBlanco  = 0;
|FIN;

|PROCESO MiraCliente;
   |SI FSalida = 10;
      TipoCliente = "G";
      DCampoG = 0; HCampoG = 1;
      |HAZ ExisteCliente;
      #dscaz046#Campo# = CodCliente; |PINTA #dscaz046#Campo#;
   |FINSI;
|FPRC;

|PROCESO MiraMovtos;
   |SI #dscaz046#7 = "R";
      #dscaz046#28 = "N"; |PINTA #dscaz046#28;
      |C_M #dscaz046#28,1,"N";
   |SINO;
      |C_M #dscaz046#28,1,"S";
   |FINSI;
|FPRC;

|PROCESO InfBancos;
   |SI #dscaz046#8 = "S";
      |C_M #dscaz046#9,1,"S";
   |SINO;
      |C_M #dscaz046#9,1,"N";
      |C_M #dscaz046#10,1,"N"; #dscaz046#10 = 0;   |PINTA #dscaz046#10;
      |C_M #dscaz046#11,1,"N"; #dscaz046#11 = 999; |PINTA #dscaz046#11;
      #dscaz046#22 = "";
      |PARA nCalc = 12; |SI nCalc [ 21; |HACIENDO nCalc = nCalc + 1;
         |C_M #dscaz046#nCalc#,1,"N"; #dscaz046#nCalc# = 0; |PINTA #dscaz046#nCalc#;
         nCalc1 = ((nCalc + 1) * 100) + 58; |PINTA nCalc1, #dscaz046#22;
      |SIGUE;
   |FINSI;
|FPRC;

|PROCESO SelBancos;
   |SI #dscaz046#8 = "N"; |ACABA; |FINSI;
   |SI #dscaz046#9 = "N";
      |C_M #dscaz046#10,1,"S"; |PINTA #dscaz046#10;
      |C_M #dscaz046#11,1,"S"; |PINTA #dscaz046#11;
      #dscaz046#22 = "";
      |PARA nCalc = 12; |SI nCalc [ 21; |HACIENDO nCalc = nCalc + 1;
         |C_M #dscaz046#nCalc#,1,"N"; #dscaz046#nCalc# = 0; |PINTA #dscaz046#nCalc#;
         nCalc1 = ((nCalc + 1) * 100) + 58; |PINTA nCalc1, #dscaz046#22;
      |SIGUE;
   |SINO;
      |C_M #dscaz046#10,1,"N"; #dscaz046#10 = 0;   |PINTA #dscaz046#10;
      |C_M #dscaz046#11,1,"N"; #dscaz046#11 = 999; |PINTA #dscaz046#11;
      |C_M #dscaz046#12,1,"S"; |PINTA #dscaz046#12;
      |C_M #dscaz046#13,1,"S"; |PINTA #dscaz046#13;
      |C_M #dscaz046#14,1,"S"; |PINTA #dscaz046#14;
      |C_M #dscaz046#15,1,"S"; |PINTA #dscaz046#15;
      |C_M #dscaz046#16,1,"S"; |PINTA #dscaz046#16;
      |C_M #dscaz046#17,1,"S"; |PINTA #dscaz046#17;
      |C_M #dscaz046#18,1,"S"; |PINTA #dscaz046#18;
      |C_M #dscaz046#19,1,"S"; |PINTA #dscaz046#19;
      |C_M #dscaz046#20,1,"S"; |PINTA #dscaz046#20;
      |C_M #dscaz046#21,1,"S"; |PINTA #dscaz046#21;
   |FINSI;
|FPRC;

|PROCESO MiraNombre;
   Tecla = FSalida;
   |SI Tecla = 2; |ACABA; |FINSI;
   |ABRE #dscam014;
   |SI Tecla = 10;
      #dscam014#0 = #dscaz046#Campo#;
      |LEE 000#dscam014.];
      |CONSULTA_CLAVE #1#dscam014;
      |SI FSalida = 0;
         #dscaz046#Campo# = #dscam014#0;
         nCalc = ((Campo + 1) * 100) + 58;
         #dscaz046#22 = #dscam014#1;
         |PINTA nCalc, #dscaz046#22;
      |SINO;
         |ERROR;
      |FINSI;
   |SINO;
      #dscam014#0 = #dscaz046#Campo#;
      |LEE 000#dscam014.=;
      |SI FSalida = 0;
         #dscaz046#Campo# = #dscam014#0;
         nCalc = ((Campo + 1) * 100) + 58;
         #dscaz046#22 = #dscam014#1;
         |PINTA nCalc, #dscaz046#22;
      |SINO;
         |SI #dscaz046#Campo# ! 0;
            |MENAV "    Banco inexistente";
            |ERROR;
         |SINO;
            nCalc = ((Campo + 1) * 100) + 58;
            #dscaz046#22 = ""; |PINTA nCalc, #dscaz046#22;
         |FINSI;
      |FINSI;
   |FINSI;
   |CIERRA #dscam014;
|FPRC;

|PROCESO Movtos;
   nCalc = ContLin + 2; |SI nCalc ] NumLins; |HAZ Salta; |FINSI;
   |SI enSwSalto = 1;
      |SI #dscaz046#8 = "S";
         ContLin = ContLin + 1; enSwCabBan  = 1; |PRINT; enSwCabBan  = 0;
      |FINSI;
      ContLin = ContLin + 2; enSwCabOrd  = 1; |PRINT; enSwCabOrd  = 0;
      ContLin = ContLin + 1; enSwCabTipo = 1; |PRINT; enSwCabTipo = 0;
      |SI #dscaz046#7 = "D";  ContLin = ContLin + 3; |FINSI;
      enSwSalto = 0;
      enSwMov   = 0;
   |FINSI;

   |SI enSwMovC = 0;
      |SI enSwMov = 0;
         ContLin = ContLin + 3;
         enSwMovC = 1; enSwMov = 1;
      |SINO;
         ContLin = ContLin + 1;
      |FINSI;
   |FINSI;
   |PRINT;
   |SI enSwMovC = 1;
      enSwMovC = 0;
   |FINSI;
|FPRC;

|DEFBUCLE Movtos;
#dscam004#1;
;
#dscam003#40,001;
#dscam003#40,999;
be;
NULL,Movtos;
|FIN;

|PROCESO PintaRec;

   |SI #dscaw034#1 = "2"; |Y #dscaz046#29 = "N"; |ACABA; |FINSI;
   |SI #dscaw034#2 = "2"; |Y #dscaz046#4  = "N"; |ACABA; |FINSI;
   |SI #dscaw034#2 = "3"; |Y #dscaz046#5  = "N"; |ACABA; |FINSI;
   |SI #dscaw034#2 = "4"; |Y #dscaz046#6  = "N"; |ACABA; |FINSI;
   |SI #dscaw034#2 = "5"; |Y #dscaz046#32 = "N"; |ACABA; |FINSI;

   #dscam003#40 = #dscaw034#0;
   |LEE 000#dscam003.=;
   Divisa = #dscam003#57; |HAZ TomaDecim;

   |SI #dscaz046#8 = "S";
      SwOk = 0;
      |SI #dscaz046#9 = "S";
         |PARA nCont = 12; |SI nCont [ 21; |HACIENDO nCont = nCont + 1;
            |SI #dscaz046#nCont# = #dscam003#51;
               SwOk = 1;
               |SAL;
            |FINSI;
         |SIGUE;
      |SINO;
         |SI #dscaz046#10 [ #dscam003#51; |Y #dscam003#51 [ #dscaz046#11;
            SwOk = 1;
         |SINO;
            SwOk = 0;
         |FINSI;
      |FINSI;
      |SI SwOk = 0; |ACABA; |FINSI;
   |FINSI;

   |SI #dscaz046#8 = "S";
      |SI nBancoAnt ! #dscaw034#7;
         |SI Primero = 0;
            |SI #dscaz046#27 = 1; fFechaVto = "01.01.0000"; |FINSI;
            |SI #dscaz046#27 = 2; aCodCliente = ""; aCtaCliente = ""; |FINSI;
         |FINSI;
         CambiaBanco = 1;
      |SINO;
         CambiaBanco = 0;
      |FINSI;
   |FINSI;

   SwError = 0;
   |SI #dscaz046#27 = 1;
      |SI #dscaw034#8 ! fFechaVto;
         SwError = 1;
      |FINSI;
   |FINSI;
   |SI #dscaz046#27 = 2;
      |SI #dscaw034#9 ! "      ";
         |SI #dscaw034#9 ! aCodCliente;
            SwError = 1;
         |FINSI;
      |SINO;
         |SI #dscaw034#10 ! aCtaCliente;
            SwError = 1;
         |FINSI;
      |FINSI;
   |FINSI;

   |SI SwError = 1;
      |SI Primero = 1;
         Primero = 0;
      |SINO;
         enSwPieOrd  = 1; |PRINT; enSwPieOrd  = 0;
         ContLin = ContLin + 2; enSwPieTipo = 1; |PRINT; enSwPieTipo = 0;
         |SI nBancoAnt ! #dscaw034#7; |Y #dscaz046#8 = "S";
            ContLin = ContLin + 2; enSwPieBan  = 1; |PRINT; enSwPieBan  = 0;
            enTotalBan = 0;
         |FINSI;
      |FINSI;
      nBancoAnt = #dscaw034#7;    aCodCliente = #dscaw034#9;
      aCtaCliente = #dscaw034#10; fFechaVto   = #dscaw034#8;
      aTipoAnt = #dscaw034#1 + #dscaw034#2;
      enTotalOrd  = 0; enTotalTipo = 0;
      |SI #dscaz046#27 = 1;
         eaTitOrd = " FECHA VTO. " + #dscaw034#8; |QBF eaTitOrd;
      |FINSI;
      |SI #dscaz046#27 = 2;
         eaTitOrd = " CLIENTE " + #dscaw034#9; |QBF eaTitOrd;
         eaTitOrd = eaTitOrd + " " + #dscam003#6; |QBF eaTitOrd;
      |FINSI;
      eaFinOrd = "TOTAL" + eaTitOrd + " ...... ";
      |SI #dscaw034#1 = "2";
         eaTitulo = "RIESGO RECIBOS EN RIESGO DE BANCOS ";
         eaFinal = "TOTAL RIESGO EN BANCOS ...........";
      |FINSI;
      |SI #dscaw034#2 = "1";
         eaTitulo = "RIESGO RECIBOS PENDIENTES DE COBRO ";
         eaFinal = "TOTAL PENDIENTE DE COBRO .........";
      |FINSI;
      |SI #dscaw034#2 = "2";
         eaTitulo = "RIESGO RECIBOS EN PAGARES/TALONES DE CLIENTES ";
         eaFinal = "TOTAL PAGARES/TALONES DE CLIENTES ";
      |FINSI;
      |SI #dscaw034#2 = "3";
         eaTitulo = "RIESGO RECIBOS REMESADOS PENDIENTES ";
         eaFinal = "TOTAL REMESADO PENDIENTE .........";
      |FINSI;
      |SI #dscaw034#2 = "4";
         eaTitulo = "RIESGO RECIBOS IMPAGADOS ";
         eaFinal = "TOTAL IMPAGADO ...................";
      |FINSI;
      |SI #dscaw034#2 = "5";
         eaTitulo = "RIESGO ACEPTADOS PENDIENTES DE RECIBIR";
         eaFinal = "TOTAL ACEPTADOS PDTS.RECIBIR .....";
      |FINSI;
      nCalc = ContLin + 7;
      |SI #dscaz046#7 = "D"; nCalc = nCalc + 3; |FINSI;
      |SI nCalc ] NumLins;
         enSwSalto = 1;  |HAZ Salta; enSwSalto = 0;
      |FINSI;
      |SI #dscaz046#8 = "S"; |Y CambiaBanco = 1;
         ContLin = ContLin + 1; enSwCabBan  = 1; |PRINT; enSwCabBan  = 0;
      |FINSI;
      ContLin = ContLin + 2; enSwCabOrd  = 1; |PRINT; enSwCabOrd  = 0;
      ContLin = ContLin + 1;
      |SI #dscaz046#7 = "D";  ContLin = ContLin + 3; |FINSI;
      enSwCabTipo = 1; |PRINT; enSwCabTipo = 0;
   |SINO;
      aAlfa = #dscaw034#1 + #dscaw034#2;
      |SI aTipoAnt ! aAlfa;
         |SI Primero = 1;
            Primero = 0;
         |SINO;
            ContLin = ContLin + 2; enSwPieTipo = 1; |PRINT; enSwPieTipo = 0;
         |FINSI;
         aTipoAnt = #dscaw034#1 + #dscaw034#2;
         enTotalTipo = 0;
         |SI #dscaw034#1 = "2";
            eaTitulo = "RIESGO RECIBOS EN RIESGO DE BANCOS ";
            eaFinal = "TOTAL RIESGO EN BANCOS ...........";
         |FINSI;
         |SI #dscaw034#2 = "1";
            eaTitulo = "RIESGO RECIBOS PENDIENTES DE COBRO ";
            eaFinal = "TOTAL PENDIENTE DE COBRO .........";
         |FINSI;
         |SI #dscaw034#2 = "2";
            eaTitulo = "RIESGO RECIBOS EN PAGARES/TALONES DE CLIENTES ";
            eaFinal = "TOTAL PAGARES/TALONES DE CLIENTES ";
         |FINSI;
         |SI #dscaw034#2 = "3";
            eaTitulo = "RIESGO RECIBOS REMESADOS PENDIENTES ";
            eaFinal = "TOTAL REMESADO PENDIENTE .........";
         |FINSI;
         |SI #dscaw034#2 = "4";
            eaTitulo = "RIESGO RECIBOS IMPAGADOS ";
            eaFinal = "TOTAL IMPAGADO ...................";
         |FINSI;
         nCalc = ContLin + 2;
         |SI #dscaz046#7 = "D"; nCalc = nCalc + 3; |FINSI;
         |SI nCalc ] NumLins;
            enSwSalto = 1; |HAZ Salta; enSwSalto = 0;
         |FINSI;
         ContLin = ContLin + 1;
         |SI #dscaz046#7 = "D";  ContLin = ContLin + 3; |FINSI;
         enSwCabTipo = 1; |PRINT; enSwCabTipo = 0;
      |SINO;
         |SI enSwCabTipo = 1; enSwCabTipo = 0; |FINSI;
      |FINSI;
   |FINSI;

   enTotalOrd  = enTotalOrd  + #dscam003#65;
   enTotalBan  = enTotalBan  + #dscam003#65;

   |SI aTipoAnt = "29";
      enTotalTipo = enTotalTipo + #dscam003#61;
      enTotalGen  = enTotalGen  + #dscam003#61;
   |SINO;
      enTotalGen  = enTotalGen  + #dscam003#65;
      enTotalTipo = enTotalTipo + #dscam003#65;
   |FINSI;
   |SI #dscaz046#7 = "D";
      ContLin = ContLin + 1; enSwDetalle = 1; |PRINT; enSwDetalle = 0;
      |SI #dscaz046#28 = "S";
         nCalc = ContLin + 3;
         |SI nCalc ] NumLins;
            enSwSalto = 1; |HAZ Salta;
            |SI #dscaz046#8 = "S";
               ContLin = ContLin + 1; enSwCabBan  = 1; |PRINT; enSwCabBan  = 0;
            |FINSI;
            ContLin = ContLin + 2; enSwCabOrd  = 1; |PRINT; enSwCabOrd  = 0;
            enSwSalto = 0;
         |FINSI;
         |BUCLE Movtos;
         |SI enSwMov = 1; Guarda = 1; enSwMov = 0; |FINSI;
         nCalc = ContLin + 2;
         |SI nCalc ] NumLins;
            enSwSalto = 1;
            |HAZ Salta;
            |SI #dscaz046#8 = "S";
               ContLin = ContLin + 1; enSwCabBan  = 1; |PRINT; enSwCabBan  = 0;
            |FINSI;
            ContLin = ContLin + 2; enSwCabOrd  = 1; |PRINT; enSwCabOrd  = 0;
            ContLin = ContLin + 1;
            |SI #dscaz046#7 = "D";  ContLin = ContLin + 3; |FINSI;
            enSwCabTipo = 1; |PRINT; enSwCabTipo = 0;
            enSwSalto = 0;
         |FINSI;
         |SI Guarda = 1;
            ContLin = ContLin + 1;
            Guarda = 0; enSwMovP = 1; |PRINT; enSwMovP = 0;
         |FINSI;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Bucle1;
#dscaw034#1;
;
"01.01.1900"," ","1","      ","            ",000000001;
"31.12.2999","z","9","zzzzzz","zzzzzzzzzzzz",999999999;
;
NULL,PintaRec;
|FIN;

|DEFBUCLE Bucle2;
#dscaw034#2;
;
"      ","            "," ","1","01.01.1900",000000001;
"zzzzzz","zzzzzzzzzzzz","z","9","31.12.2999",999999999;
;
NULL,PintaRec;
|FIN;

|DEFBUCLE Bucle3;
#dscaw034#3;
;
000,"01.01.1900"," ","1","      ","            ",000000001;
999,"31.12.2999","z","9","zzzzzz","zzzzzzzzzzzz",999999999;
;
NULL,PintaRec;
|FIN;

|DEFBUCLE Bucle4;
#dscaw034#4;
;
000,"      ","            "," ","1","01.01.1900",000000001;
999,"zzzzzz","zzzzzzzzzzzz","z","9","31.12.2999",999999999;
;
NULL,PintaRec;
|FIN;

|PROCESO Salta;
   |PARA nCalc = ContLin; |SI nCalc < NumLins; |HACIENDO nCalc = nCalc + 1;
      ContLin = ContLin + 1;
      enSwBlanco = 1; |PRINT; enSwBlanco = 0;
   |SIGUE;
   |PIEINF;
   ContLin = 6;
|FPRC;

|PROCESO Imprime1;
   ContLin = 6; Primero = 1;
   aInforme = "Informe riesgos"; |HAZ ObtenInforme;
   |INFOR aInforme;
   |SI FSalida = 0;
      |SI #dscaz046#8 = "N";
         |SI #dscaz046#27 = 1; |BUCLE Bucle1; |FINSI;
         |SI #dscaz046#27 = 2; |BUCLE Bucle2; |FINSI;
      |SINO;
         |SI #dscaz046#27 = 1; |BUCLE Bucle3; |FINSI;
         |SI #dscaz046#27 = 2; |BUCLE Bucle4; |FINSI;
      |FINSI;
   |SINO;
      |ACABA;
   |FINSI;

   ContLin = ContLin + 2; enSwPieTipo = 1; |PRINT; enSwPieTipo = 0;
   |SI #dscaz046#8 = "S";
      ContLin = ContLin + 2; enSwPieBan  = 1; |PRINT; enSwPieBan  = 0;
   |FINSI;
   ContLin = ContLin + 2;
   |HAZ Salta;
   |FININF;
|FPRC;

|PROCESO MiraSerie;
   |SI #dscam038#3 [ #dscam003#0; |Y #dscam003#0 [ #dscam038#4;
      SwFind = 1; |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE MiraSerie;
#dscam038#1;
2,5,8;
nEmpGestion,001,"F",nEmpCartera,"R";
nEmpGestion,999,"F",nEmpCartera,"R";
;
NULL,MiraSerie;
|FIN;

|PROCESO RellTempo;
|SI #dscam051#104 = "S";
   |SI #dscam003#70 ! "          "; |O #dscam003#72 ! "    ";
      |SI #dscam003#71 < #dscaz046#2; |O #dscam003#71 > #dscaz046#3; |ACABA; |FINSI;
   |SINO;
      |SI #dscam003#3 < #dscaz046#2; |O #dscam003#3 > #dscaz046#3; |ACABA; |FINSI;
   |FINSI;
|FINSI;

|SI #dscaz046#31 = "C";
   SwFind = 0; |BUCLE MiraSerie;
   |SI SwFind = 0; |ACABA; |FINSI;
|SINO;
   |SI #dscaz046#25 > #dscam003#0; |O #dscam003#0 > #dscaz046#26;
       |ACABA;
   |FINSI;
|FINSI;

|DDEFECTO #dscaw034;
#dscaw034#0 = #dscam003#40;
|SI #dscam003#14 = "A"; |O #dscam003#14 = "D"; |ACABA; |FINSI;
|SI #dscam003#60 = 0; |ACABA; |FINSI;

|SI #dscam003#14 = "L"; |Y #dscam003#17 ! 0; |Y #dscam003#84 = "N";
   #dscaw034#1 = "2";
   #dscaw034#2 = "9";
|SINO;
   #dscaw034#1 = "1";
   |SI #dscam003#14 = "P"; |O #dscam003#14 = "C";
      #dscaw034#2 = "1";
   |FINSI;
   |SI #dscam003#14 = "T";
      #dscaw034#2 = "2";
   |FINSI;
   |SI #dscam003#14 = "R";
      #dscaw034#2 = "3";
   |FINSI;
   |SI #dscam003#14 = "I";
      #dscaw034#2 = "4";
   |FINSI;
   |SI #dscam003#14 = "V";
      #dscaw034#2 = "5";
   |FINSI;
|FINSI;
#dscaw034#3  = #dscam003#30;
#dscaw034#4  = #dscam003#31;
#dscaw034#5  = #dscam003#60;
#dscaw034#6  = #dscam003#65;
#dscaw034#7  = #dscam003#51;
#dscaw034#8  = #dscam003#3;
#dscaw034#9  = #dscam003#32;
#dscaw034#10 = #dscam003#5;
|GRABA 020#dscaw034.n;
|FPRC;

|DEFBUCLE RellTempo;
#dscam003#1;
32,3,4;
000000001,#dscaz046#0,#dscaz046#2,#dscaz046#23;
999999999,#dscaz046#1,#dscaz046#3,#dscaz046#24;
be;
NULL,RellTempo;
|FIN;

|DEFBUCLE RellTempo1;
#dscam003#1;
32,4;
000000001,#dscaz046#0,#dscaz046#23;
999999999,#dscaz046#1,#dscaz046#24;
be;
NULL,RellTempo;
|FIN;

|PROCESO MiraResp;
   |SI #dscaz046#31 = "C";
      #dscaz046#25 = "     "; |PINTA #dscaz046#25;
      #dscaz046#26 = "zzzzz"; |PINTA #dscaz046#26;
      |C_M #dscaz046#25,1,"N"; |C_M #dscaz046#26,1,"N";
   |SINO;
      |C_M #dscaz046#25,1,"S"; |C_M #dscaz046#26,1,"S";
   |FINSI;
|FPRC;

|PROGRAMA;
   |HAZ Tipo8;
   |CLS;

   |CABEZA "Informe Riesgos";

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   |ABRE #dscaz046;
   |LEE 000#dscaz046.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscaz046;
      |GRABA 020#dscaz046.c;
   |FINSI;

   |PINPA #0#0; |PINDA #0#0;
   |PARA nCalc = 12; |SI nCalc [ 21; |HACIENDO nCalc = nCalc + 1;
      nCalc1 = ((nCalc + 1) * 100) + 58; |PINTA nCalc1, #dscaz046#22;
   |SIGUE;
   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dscaz046.a;
      |IMPRE 0;
      |SI FSalida ! 0; |ACABA; |FINSI;
      |DELINDEX #dscaw034; |ABRE #dscaw034;
      |ABRE #dscam003;
      nEmpGestion = #48#15; nEmpCartera = #48#0;
      |DFICB aAlfa; |QBF aAlfa;
      |PATH_DAT #50 aAlfa; |ABRE #dscam038;

      |SI #dscam051#104 = "S";
         |BUCLE RellTempo1;
      |SINO;
         |BUCLE RellTempo;
      |FINSI;
      |HAZ Imprime1;
      |CIERRA #dscam038; |CIERRA #dscam003; |CIERRA #dscaw034;
      |FINIMP;
   |FINSI;

   |CIERRA #dscaz046;

   |HAZ Tipo9;
|FPRO;
