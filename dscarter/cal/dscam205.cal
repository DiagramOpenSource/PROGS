|FICHEROS;
   dscam205 #0;

   &canempr@ #100;
   &cacuent@ #101;
|FIN;

|VARIABLES;
   &MaxDigit = 0;

   nTecla = 0;
   nCalc  = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
|FIN;

|PROCESO MiraEmpresaC;
   nTecla = FSalida;

   |SI nTecla = 10;
      #canempr@#2 = #dscam205#0;
      #canempr@#3 = 0;
      |LEE 000#canempr@.];
      |CONSULTA_CLAVE #1#canempr@;
      |SI FSalida = 0;
         #dscam205#0 = #canempr@#2; |PINTA #dscam205#0;
         aAlfa = #canempr@#1; |QBF aAlfa; |PINTA 1027, aAlfa;
         |ERROR; |ACABA;
      |FINSI;
   |FINSI;

   #canempr@#2 = #dscam205#0;
   #canempr@#3 = 0;
   |LEE 000#canempr@.];
   |SI FSalida = 0; |Y #canempr@#2 = #dscam205#0;
      aAlfa = #canempr@#1; |QBF aAlfa; |PINTA 1027, aAlfa;
   |SINO;
      |MENAV "    Empresa contable inexistente ";
      |ERROR;
   |FINSI;
|FPRC;

|PROCESO MiraCuenta;
   nTecla = FSalida;

   || Convierto los puntos de la cuenta contable ...
   aAlfa = #dscam205#1; |QBF aAlfa;
   aAlfa = aAlfa - ".";
   |SI FSalida ! 0;
      |PARA; |SI FSalida ! 0; |HACIENDO;
         nCalc = ((FSalida / 100) ! 0) + 99; aAlfa1 = aAlfa % nCalc;
         nCalc = FSalida + 98;               aAlfa2 = aAlfa % nCalc;
         aAlfa = aAlfa1 + aAlfa2; aAlfa = aAlfa % 0; nCalc = aAlfa;
         nCalc = MaxDigit - nCalc;
         aAlfa = aAlfa1 + ("0" * nCalc) + aAlfa2;

         aAlfa = aAlfa - ".";
      |SIGUE;
      #dscam205#1 = aAlfa; |PINTA #dscam205#1;
   |FINSI;

   |SI nTecla = 10;
      #cacuent@#0 = #dscam205#1;
      |LEE 000#cacuent@.];
      |CONSULTA_CLAVE #1#cacuent@;
      |SI FSalida = 0;
         #dscam205#1 = #cacuent@#0; |PINTA #dscam205#1;
         #dscam205#2 = #cacuent@#2; |PINTA #dscam205#2;
      |FINSI;
      |ERROR; |ACABA;
   |FINSI;

   #cacuent@#0 = #dscam205#1;
   |LEE 000#cacuent@.=;
   |SI FSalida ! 0;
      |MENAV "    No existe la cuenta contable indicada";
      |ERROR; |ACABA;
   |SINO;
      #dscam205#2 = #cacuent@#2; |PINTA #dscam205#2;
   |FINSI;
|FPRC;
