|FICHEROS;
   dscaz024;

   &canempr@;

   camanco@ #2;
   camanpa@ #3;
   caremec@ #4;
   caremel@ #5;
   camanta@ #6;
   capagca@ #7;
   capagli@ #8;
   caminca@ #9;
   caminli@ #10;
   caclipr@ #11;
   camanba@ #12;
   camoned@ #13;
   camanpc@ #14;
   camanpl@ #15;

   dscam003 #20;
   dscam224;

   dscam008 #21;
   dscam048 #22;
   dscam014 #23;

   dscam012 #24;
   dscam013 #25;
   dscam021 #26;
   dscam022 #27;
   dscam046 #28;
   dscam047 #29;
   dscam049 #30;
   dscam050 #31;
   dscam095 #32;
   dscam096 #33;

   dscam004 #35;
   dscam009 #36;

   dscam067 #37;

   cacambi@;
|FIN;

|VARIABLES;

   nInkey        = 0;
   nSwError      = 0;
   aParam        = "";
   aAlfa        = "";
   aAlfa1        = "";
   aAlfa2        = "";
   aAlfa3        = "";
   aAlfa4        = "";
   nNume1        = 0;
   nNume2        = 0;
   nNume3        = 0;
   nNume4        = 0;
   nLongi        = 0;

   nDEmp         = 0;
   nHEmp         = 0;
   aMensa        = "";
   aDef330       = "";
   aDirBase      = "";
   aPathDef      = "";
   aPathOrigen   = "";
   aPathFich     = "";
   aPath         = "";

   nExiste       = 0;
   aDef          = "";
   aDef2         = "";
   aDef3         = "";
   aDef4         = "";
   aDef5         = "";
   aDef6         = "";
   aDef7         = "";
   aDef8         = "";
   aDef9         = "";
   aDef10        = "";
   aDef11        = "";
   aDef12        = "";
   aDef13        = "";
   aDef14        = "";
   aDef15        = "";
   aDef99        = "";

   aCuenta       = "";

   &enEmpCartera = 0;
   &enEmpGestion = 0;
   &enBanco = 0;
   &eaSerie = "";
   &eaCliGest = "";
   &nImporte = 0;
   &eaTipoOper = "";
   &nDeci_Div = 0;
   &nDeci_Base = 0;
   &EURO   = 0;
   &EURODB = 0;
   &EURODV = 0;

   nSwC        = 0;
   &eaEntidad  = "";
   &eaSucursal = "";
   &eaCuenta   = "";
   &eaDC       = "";
   &eaPais     = "";
   &eaCta      = "";
   &eaIBAN     = "";
   &eaIBANant  = "";

   Comodin = "";
   Comodin1 = "";
   Comodin2 = "";
   SwAbiertos = 0;

   nSwEmit = 0;

   fFechaCob = @;

   UltRecibo   = 0;
   UltRemesa   = 0;
   UltPagare   = 0;
   UltTalon    = 0;
   UltConfirme = 0;
   UltPagoDom  = 0;

   NumRecs = 0;
   nCalc = 0;
   LinCob = 0;
   UltOp = "";

   nEmpresa = 0;
   Mensaje = 0;
   aLong = "";
   nLong = 0;
   LinPag = 0;

   Version = "";

   &eaDirAgicont = "";
   &enEmpAgicont = 0;
   &enPerAgicont = 0;

   dig3 = 0;
   dig4 = 0;
   dig5 = 0;
   dig6 = 0;
   dig7 = 0;
   dig8 = 0;
   dig9 = 0;
   MaximoDigitos = 0;
   {-1}punt1 = 0;
   &MaxDigit = 0;
|FIN;

|CALCULO PonBarra; |TIPO 0;
     nInkey = FSalida;
     |C_M #dscaz024#0,0, aAlfa1;
     |SI aAlfa1 = "N"; |ACABA; |FINSI;

     |SI nInkey = 10;
        |DBASS Comodin; |QBF Comodin;
        Comodin = Comodin + "agicont/";
        #dscaz024#0 = Comodin;
        |ERROR;
        |ACABA;
     |FINSI;

     |SI nInkey = 11;
         aAlfa1 = "D c:\";
         |BROWSE aAlfa1;
         aAlfa1 = aAlfa1 % 280;
         #dscaz024#Campo# = aAlfa1;
         |PINTA #dscaz024#Campo#
     |FINSI;

     aAlfa1 = #dscaz024#Campo#;
     |QBF aAlfa1;
     aAlfa2 = aAlfa1 % -101;
     |SI aAlfa2 ! "/";|Y aAlfa2 ! "\";
         #dscaz024#Campo# = aAlfa1 + "/";
         |PINTA #dscaz024#Campo#;
     |FINSI;

     nSwError = 0;
     |HAZ CargaEmpAgicont;
     |SI nSwError ! 0;
         |MENAV aMensa;
         |ERROR;
     |FINSI;
|FCAL;

|PROCESO DesCargaDef;
   |SI aDef13 ! ""; |DESCARGA_DEF #camoned@; aDef13 = ""; |FINSI;
   |SI aDef15 ! ""; |DESCARGA_DEF #camanpl@; aDef15 = ""; |FINSI;
   |SI aDef14 ! ""; |DESCARGA_DEF #camanpc@; aDef14 = ""; |FINSI;
   |SI aDef12 ! ""; |DESCARGA_DEF #camanba@; aDef12 = ""; |FINSI;
   |SI aDef11 ! ""; |DESCARGA_DEF #caclipr@; aDef11 = ""; |FINSI;
   |SI aDef10 ! ""; |DESCARGA_DEF #caminli@; aDef10 = ""; |FINSI;
   |SI aDef9  ! ""; |DESCARGA_DEF #caminca@; aDef9  = ""; |FINSI;
   |SI aDef8  ! ""; |DESCARGA_DEF #capagli@; aDef8  = ""; |FINSI;
   |SI aDef7  ! ""; |DESCARGA_DEF #capagca@; aDef7  = ""; |FINSI;
   |SI aDef6  ! ""; |DESCARGA_DEF #camanta@; aDef6  = ""; |FINSI;
   |SI aDef5  ! ""; |DESCARGA_DEF #caremel@; aDef5  = ""; |FINSI;
   |SI aDef4  ! ""; |DESCARGA_DEF #caremec@; aDef4  = ""; |FINSI;
   |SI aDef3  ! ""; |DESCARGA_DEF #camanpa@; aDef3  = ""; |FINSI;
   |SI aDef2  ! ""; |DESCARGA_DEF #camanco@; aDef2  = ""; |FINSI;

   |SI aDef330 ! ""; |DESCARGA_DEF #canempr@; aDef330 = ""; |FINSI;
|FPRC;

|PROCESO CargaEmpAgicont;
     nSwError = 0;
     aMensa   = "";

     |HAZ DesCargaDef;
     aDirBase = #dscaz024#0; |QBF aDirBase;

     aPathDef = aDirBase + "def/";

     aDef330 = aPathDef + "canempre";
     |CARGA_DEF aDef330, canempr@;
     |SI FSalida ! 0;
         aMensa   = "    Error en:" + aDef330;
         aDef330  = "";
         nSwError = 1;
     |FINSI;
|FPRC;

|PROCESO Variables;
     dig3 = #canempr@#13;       || nro. niveles
     dig4 = #canempr@#14;       || 1 nivel
     dig5 = #canempr@#15;       || 2 nivel
     dig6 = #canempr@#16;       || 3 nivel
     dig7 = #canempr@#17;       || 4 nivel
     dig8 = #canempr@#18;       || 5 nivel
     dig9 = #canempr@#19;       || 6 nivel
  || Recoger informacion sobre los niveles ...
     Ipunt1 = dig3<-;
     Ipunt1 = Ipunt1 + dig3;
     MaximoDigitos = punt1;
|FPRC;

|RUTINA infA2;
   #canempr@#2 = nDEmp;
   #canempr@#3 = 0;
|FRUT;

|RUTINA supA2;
   #canempr@#2 = nHEmp;
   #canempr@#3 = 9;
|FRUT;

|CALCULO LeeEmpresa; |TIPO 0;
  nInkey = FSalida;

  |SI nInkey = 2; |ACABA; |FINSI;

  aPathOrigen = #dscaz024#0;  |QBF aPathOrigen;
  aPathOrigen = aPathOrigen + "fich/";
  |PATH_DAT #canempr@#aPathOrigen#;

  |SI nInkey = 10;
      nDEmp = 0;
      nHEmp = 99999;
      |ABRE #canempr@;
      |CONSULTA_F_CLAVE #1#canempr@,infA2,supA2;
      #dscaz024#1 = #canempr@#2; |PINTA #dscaz024#1;
      #dscaz024#2 = #canempr@#3; |PINTA #dscaz024#2;
      #dscaz024#3 = #canempr@#1; |PINTA #dscaz024#3;
      |CIERRA #canempr@;
      |PTEC 802;
      |ACABA;
  |FINSI;

  |ABRE #canempr@;
  #canempr@#2 = #dscaz024#1;
  #canempr@#3 = 0;
  |LEE 011#canempr@.];
  |SI FSalida ! 0;  |O #canempr@#2 ! #dscaz024#1;
      |MENAV "     NO Existe la empresa Contable";
      |ERROR;
  |SINO;
      #dscaz024#3  = #canempr@#1;  |PINTA #dscaz024#3;
      #dscaz024#12 = #canempr@#26; |PINTA #dscaz024#12;
      |HAZ Variables;
  |FINSI;
  |CIERRA #canempr@;
|FCAL;

|CALCULO ConsultaEmpresa; |TIPO 0;
  nInkey = FSalida;
  |SI nInkey = 2; |ACABA; |FINSI;

  aPathOrigen = #dscaz024#0;  |QBF aPathOrigen;
  aPathOrigen = aPathOrigen + "fich/";
  |PATH_DAT #canempr@#aPathOrigen#;

  |SI nInkey = 10;
      nDEmp = #dscaz024#1;
      nHEmp = #dscaz024#1;
      |ABRE #canempr@;
      |CONSULTA_F_CLAVE #1#canempr@,infA2,supA2;
      #dscaz024#2 = #canempr@#3; |PINTA #dscaz024#2;
      #dscaz024#3 = #canempr@#1; |PINTA #dscaz024#3;
      |CIERRA #canempr@;
  |FINSI;

  |ABRE #canempr@;
  #canempr@#2 = #dscaz024#1;
  #canempr@#3 = #dscaz024#2;
  |LEE 011#canempr@.=;
  |SI FSalida ! 0;
      |SI aParam = "";
          |MENAV "     NO Existe Periodo en la Empresa Contable";
          |ERROR;
      |FINSI;
  |SINO;
      #dscaz024#3   = #canempr@#1;  |PINTA #dscaz024#3;
      #dscaz024#12  = #canempr@#26; |PINTA #dscaz024#12;
      |HAZ Variables;
  |FINSI;
  |CIERRA #canempr@;
|FCAL;

|| ////////////////////////////////////////////////////////////////////
|PROCESO CambioManual;
   aAlfa1 = aCuenta;  |QBF aAlfa1;
   aAlfa2 = aAlfa1 % 0;
   nLongi = aAlfa2;
   |SI nLongi = MaxDigit; |O nLongi [ 4; |ACABA; |FINSI;

   nNume2 = MaxDigit - nLongi;
   aAlfa1 = "0" * nNume2; ||digitos que hacen falta para rellenar
   aAlfa2 = aCuenta;    |QBF aAlfa2;

   aAlfa3 = "104";
   nNume4 = nLongi - 4;   ||Diferencia entre anterior y este
   nNume4 = 0 - (100 + nNume4);   || parte posterior
   aAlfa4 = nNume4;
   aCuenta = (aAlfa2 % aAlfa3) + aAlfa1 + (aAlfa2 % aAlfa4);
|FPRC;

|PROCESO CambioCuentas;
   |SI MaxDigit ! 0; |Y MaximoDigitos < MaxDigit;
       |SI nExiste = 1;
           #cacambi@#0 = aCuenta;
           #cacambi@#1 = 0;
           |LEE 040#cacambi@.];
           |SI FSalida = 0; |Y #cacambi@#0 = aCuenta;
               aCuenta = #cacambi@#2;
           |FINSI;
       |SINO;
           |HAZ CambioManual;
       |FINSI;
   |FINSI;
|FPRC;
|| ////////////////////////////////////////////////////////////////////

|PROCESO AbreFichs;

   nSwError = 0;
   aDirBase = #dscaz024#0; |QBF aDirBase;
   aPathDef = aDirBase + "def/";
   aPathOrigen = #dscaz024#0;  |QBF aPathOrigen;
   aPathOrigen = aPathOrigen + "fich/";
   aPathFich   = aPathOrigen + ("00000" + #dscaz024#1) % -105 + #dscaz024#2 + "/";

   aDef2 = aPathDef + "camancob.mas";
   |CARGA_DEF aDef2, camanco@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef2;
       aDef2    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef3 = aPathDef + "camanpag.mas";
   |CARGA_DEF aDef3, camanpa@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef3;
       aDef3    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef4 = aPathDef + "caremesc.mas";
   |CARGA_DEF aDef4, caremec@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef4;
       aDef4    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef5 = aPathDef + "caremesl.mas";
   |CARGA_DEF aDef5, caremel@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef5;
       aDef5    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef6 = aPathDef + "camantal.mas";
   |CARGA_DEF aDef6, camanta@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef6;
       aDef6    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef7 = aPathDef + "capagcab.mas";
   |CARGA_DEF aDef7, capagca@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef7;
       aDef7    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef8 = aPathDef + "capaglin.mas";
   |CARGA_DEF aDef8, capagli@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef8;
       aDef8    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef9 = aPathDef + "camingca.mas";
   |CARGA_DEF aDef9, caminca@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef9;
       aDef9    = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef10 = aPathDef + "camingli.mas";
   |CARGA_DEF aDef10, caminli@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef10;
       aDef10   = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef11 = aPathDef + "caclipro.mas";
   |CARGA_DEF aDef11, caclipr@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef11;
       aDef11   = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef12 = aPathDef + "camanban.mas";
   |CARGA_DEF aDef12, camanba@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef12;
       aDef12   = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef14 = aPathDef + "camanpdc.mas";
   |CARGA_DEF aDef14, camanpc@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef14;
       aDef14   = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   aDef15 = aPathDef + "camanpdl.mas";
   |CARGA_DEF aDef15, camanpl@;
   |SI FSalida ! 0;
       aMensa   = "    Error en:" + aDef15;
       aDef15   = "";
       nSwError = 1;
       |ACABA;
   |FINSI;

   Comodin1 = "|NC"; nCalc = #canempr@#Comodin1#; |SI nCalc = 27; Version = "5.30"; |FINSI;
   Comodin1 = "|NC"; nCalc = #caremel@#Comodin1#; |SI nCalc = 15; Version = "5.50"; |FINSI;

   Comodin1 = "|NC"; nCalc = #camanco@#Comodin1#; |SI nCalc = 32; Version = "6.00"; |FINSI;
                                                  |SI nCalc = 30; Version = "6.60"; |FINSI;
   |SI Version = "5.30"; |O Version = "6.60";
       aDef13 = aPathDef + "camoneda.mas";
       |CARGA_DEF aDef13, camoned@;
       |SI FSalida ! 0;
           aMensa   = "    Error en:" + aDef13;
           aDef13   = "";
           nSwError = 1;
           |ACABA;
       |FINSI;
   |FINSI;
   SwAbiertos = 1;
|FPRC;

|| ////////////////////////////////////////////////
|PROCESO RecibosVenta;

   |DDEFECTO #caclipr@;
   #caclipr@#23 = "C";
   #caclipr@#10 = #camanco@#4;
   #caclipr@#11 = #camanco@#5;
   |LEE 010#caclipr@.=;

   |SI Version = "5.30"; |O Version = "5.50";
       #dscam048#0 = #camanco@#28;
       |LEE 010#dscam048.=;
       |SI FSalida ! 0;  |DDEFECTO #dscam048; |FINSI;
   |FINSI;

   |DDEFECTO #dscam003;
   #dscam003#27 = #camanco@#0;  || Libro
   #dscam003#0  = #camanco@#2;  || Serie
   #dscam003#1  = #camanco@#1;  || Factura
   #dscam003#2  = #camanco@#3;  || N§ recibo
   #dscam003#3  = #camanco@#7;  || Fecha de vencimiento
   #dscam003#4  = #camanco@#6;  || Fecha de emision
   #dscam003#5  = #camanco@#4;  || Cuenta de cliente
   #dscam003#6  = #caclipr@#1;  || Nombre de cliente
   #dscam003#7  = #camanco@#15; || Nombre del banco

   Comodin = #camanco@#20; |QBF Comodin;

   Comodin1 = Comodin % 0104;
   Comodin1 = ("0000" + Comodin1) % -104;
   #dscam003#8  = Comodin1;     || Entidad

   Comodin1 = Comodin % 0504;
   Comodin1 = ("0000" + Comodin1) % -104;
   #dscam003#9  = Comodin1;     || Sucursal

   Comodin1 = Comodin % 0902;
   Comodin1 = ("00" + Comodin1) % -102;
   #dscam003#10 = Comodin1;     || DC

   Comodin = #camanco@#19; |QBF Comodin;
   Comodin = ("0000000000" + Comodin) % -110;
   #dscam003#11 = Comodin; || Cuenta

   #dscam003#12 = #camanco@#11; || Tipo de recibo
   #dscam003#16 = #camanco@#27; || N§ de impagos
   #dscam003#17 = #camanco@#12; || N§ de remesa
   #dscam003#52 = #camanco@#12; || Fecha de remesa
   #dscam003#22 = #camanco@#26 - #camanco@#9; || Importe recibo DIVISA
   #dscam003#60 = #camanco@#26 - #camanco@#9; || Importe recibo BASE
   #dscam003#23 = #camanco@#24; || Importe liquidado DIVISA
   #dscam003#61 = #camanco@#24; || Importe liquidado BASE
   #dscam003#24 = #camanco@#9;  || Gastos de negociacion DIVISA
   #dscam003#62 = #camanco@#9;  || Gastos de negociacion BASE
   #dscam003#25 = #camanco@#10; || Gastos de devolucion DIVISA
   #dscam003#63 = #camanco@#10; || Gastos de devolucion BASE
   #dscam003#30 = #dscam003#22 + #dscam003#24 + #dscam003#25; || Total recibo DIVISA
   #dscam003#30 = #dscam003#30 - (#dscam003#54 + #dscam003#55);
   #dscam003#64 = #dscam003#30; || Total Recibo BASE

   |SI Version = "5.30"; |O Version = "5.50";
       #dscam003#33 = #camanco@#28; || Representante
       #dscam003#34 = #dscam048#1;  || Nombre del representante
   |FINSI;
   #dscam003#44 = #dscaz024#1;  || Empresa contable
   #dscam003#45 = #dscaz024#2;  || Periodo contable
   #dscam003#40 = UltRecibo;

   |SI #camanco@#23 = "S"; |Y #dscam003#23 < #dscam003#30;
       #dscam003#23 = #dscam003#30;
       #dscam003#61 = #dscam003#64;
   |FINSI;
   #dscam003#31 = #dscam003#30 - #dscam003#23; || Total pendiente DIVISA
   #dscam003#65 = #dscam003#64 - #dscam003#61; || Total pendiente BASE

   |SI #dscam003#23 = 0;
      |SI #dscam003#16 = 0;
          #dscam003#14 = "P";
          #dscam003#15 = "Pendiente de cobro";
      |SINO;
          #dscam003#14 = "I";
          #dscam003#15 = "Impagado";
      |FINSI;
   |SINO;
      |SI #dscam003#31 = 0;
          #dscam003#14 = "L";
          #dscam003#15 = "Recibo liquidado";
      |SINO;
          #dscam003#14 = "C";
          #dscam003#15 = "Parcialmente cobrado";
      |FINSI;
   |FINSI;
   UltRecibo = UltRecibo + 1;
   |SI EURODB = 0;
      #dscam003#57 = "ESP";
      #dscam003#58 = "PESETA ESPA¥OLA";
   |SINO;
      #dscam003#57 = "EUR";
      #dscam003#58 = "EURO";
   |FINSI;
   #dscam003#59 = 1;
   |SI Version = "6.60";
       #dscam003#85 = #camanco@#28;  || Referencia
   |FINSI;

   aCuenta = #dscam003#5;
   |HAZ CambioCuentas;
   #dscam003#5 = aCuenta;

   aCuenta = #dscam003#50;
   |HAZ CambioCuentas;
   #dscam003#50 = aCuenta;

   |GRABA 020#dscam003.n;

   eaIBANant = "";
   eaCta     = #dscam003#8 + #dscam003#9 + #dscam003#10 + #dscam003#11;
   eaPais    = #caclipr@#39;
   |HAZ CalcuIBAN;

   #dscam224#0 = #dscam003#0;
   #dscam224#1 = eaIBAN;
   #dscam224#2 = #caclipr@#29;
   #dscam224#3 = #caclipr@#37;
   #dscam224#4 = #caclipr@#36;
   |GRABA 040#dscam224.n;

   |SI #dscam003#17 ! 0; |O #dscam003#23 = 0; |ACABA; |FINSI;

   #dscam004#17 = #dscam003#40;
   #dscam004#3 = 99;
   |LEE 010#dscam004.];
   |SI FSalida ! 0;
      |LEE 010#dscam004.u;
      |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40;
         LinCob = #dscam004#3 + 1;
         UltOp = #dscam004#5;
      |SINO;
         LinCob = 1;
      |FINSI;
   |SINO;
      |SI #dscam004#17 = #dscam003#40;
         LinCob = #dscam004#3 + 1;
         UltOp = #dscam004#5;
      |SINO;
         |LEE 010#dscam004.a;
         |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40;
            LinCob = #dscam004#3 + 1;
            UltOp = #dscam004#5;
         |SINO;
            LinCob = 1;
         |FINSI;
      |FINSI;
   |FINSI;

   #dscam004#17 = #dscam003#40;
   #dscam004#15 = #dscam003#27; || Libro
   #dscam004#0  = #dscam003#0;  || Serie
   #dscam004#1  = #dscam003#1;  || Factura
   #dscam004#2  = #dscam003#2;  || Recibo
   #dscam004#3  = LinCob;       || N§ cobro
   Comodin = #dscam003#5; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong; nLong = nLong + 100;
   Comodin = "570000000000";
   Comodin = Comodin % nLong;
   #dscam004#4  = Comodin;      || Cuenta de cobro
   |SI #dscam003#14 = "L"; #dscam004#5  = "COB"; |FINSI;
   |SI #dscam003#14 = "C"; #dscam004#5  = "COP"; |FINSI;
   #dscam004#6  = #dscam003#3;  || Fecha de cobro
   #dscam004#7  = 0;            || Total Liquidado
   #dscam004#8  = #dscam003#23; || Total a cobrar
   #dscam004#9  = 0;
   #dscam004#10 = 0;
   #dscam004#11 = #dscam003#13; || Departamento
   #dscam004#12 = #dscam003#24; || Gastos de negociacion
   #dscam004#13 = #dscam003#25; || Gastos de devolucion
   #dscam004#25 = #dscam004#7;  || Importe liquidado BASE
   #dscam004#26 = #dscam004#8;  || Importe Cobrado BASE
   #dscam004#27 = #dscam004#9;  || Importe impagado BASE
   #dscam004#29 = #dscam004#12; || Gastos de negoiciacion BASE
   #dscam004#30 = #dscam004#13; || Gastos de devolucion BASE
   #dscam004#31 = #dscam004#14; || Otros Gastos BASE
   #dscam004#33 = 1;            || Cambio en el momento del cobro
   |GRABA 020#dscam004.c;

   |SI #dscam003#14 = "L";
      |DDEFECTO #dscam067;
      #dscam067#0 = "CB";
      #dscam067#1 = #dscam004#17;
      #dscam067#2 = #dscam004#3;
      #dscam067#3 = "";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;
   |FINSI;
|FPRC;

|DEFBUCLE RecibosVenta1;
   #camanco@#1004;
   ;
   01,"  ",000001,001;
   99,"zz",999999,999;
   ;
   NULL,RecibosVenta;
|FIN;

|DEFBUCLE RecibosVenta2;
    #camanco@#1004;
    ;
    01,000001,"  ",001;
    99,999999,"zz",999;
    ;
    NULL, RecibosVenta;
|FIN;
|| /////////////////////////////////////////

|PROCESO RecibosCompra;

   #dscam014#0 = #camanpa@#26;
   |LEE 010#dscam014.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam014;
   |FINSI;

   #caclipr@#23 = "P";
   #caclipr@#10 = #camanpa@#4;
   #caclipr@#11 = #camanpa@#5;
   |LEE 010#caclipr@.=;
   |SI FSalida ! 0;
      |DDEFECTO #caclipr@;
   |FINSI;

   |DDEFECTO #dscam008;
   #dscam008#27 = #camanpa@#0;  || Libro
   #dscam008#0  = #camanpa@#2;  || Serie
   #dscam008#1  = #camanpa@#1;  || Factura
   #dscam008#2  = #camanpa@#3;  || N§ recibo
   #dscam008#3  = #camanpa@#7;  || Fecha de vencimiento
   #dscam008#4  = #camanpa@#6;  || Fecha de emision
   #dscam008#5  = #camanpa@#4;  || Cuenta de proveedor
   #dscam008#6  = #caclipr@#1;  || Nombre de proveedor
   #dscam008#7  = #dscam014#2;  || Nombre del banco
   Comodin = #camanpa@#19; |QBF Comodin;
   Comodin1 = Comodin % 0104;
   Comodin1 = ("0000" + Comodin1) % -104;
   #dscam008#8  = Comodin1;     || Entidad
   Comodin1 = Comodin % 0504;
   Comodin1 = ("0000" + Comodin1) % -104;
   #dscam008#9  = Comodin1;     || Sucursal
   Comodin1 = Comodin % 0902;
   Comodin1 = ("00" + Comodin1) % -102;
   #dscam008#10 = Comodin1;     || DC
   Comodin = #camanpa@#18; |QBF Comodin;
   Comodin = ("0000000000" + Comodin) % -110;
   #dscam008#11 = Comodin; || Cuenta
   #dscam008#12 = #camanpa@#11; || Tipo de recibo
   |SI #camanpa@#12 ! 0; #dscam008#17 = #camanpa@#12; |FINSI;
   |SI #camanpa@#25 ! 0; |Y Version = "5.30"; #dscam008#17 = #camanpa@#25; |FINSI;
   |SI Version = "5.30"; |O Version = "5.50";
      #dscam008#16 = #camanpa@#26; || Codigo banco
   |SINO;
      #dscam008#16 = #camanpa@#28; || Codigo banco
   |FINSI;
   #dscam008#22 = #camanpa@#8;  || Importe recibo
   #dscam008#23 = #camanpa@#23; || Importe liquidado
   #dscam008#24 = #camanpa@#9;  || Gastos de negociacion
   #dscam008#25 = #dscam008#22 + #dscam008#24 + #dscam008#38;  || Total Recibo
   #dscam008#31 = #dscam008#25 - #dscam008#23; || Total pendiente
   #dscam008#44 = #dscaz024#1;  || Empresa contable
   #dscam008#45 = #dscaz024#2;  || Periodo contable
   #dscam008#40 = UltRecibo;
   |SI #dscam008#23 = 0;
      #dscam008#14 = "P";
      #dscam008#15 = "Pendiente de pago";
   |SINO;
      |SI #dscam008#31 = 0;
         #dscam008#14 = "L";
         #dscam008#15 = "Recibo liquidado";
      |SINO;
         #dscam008#14 = "C";
         #dscam008#15 = "Parcialmente pagado";
      |FINSI;
      #dscam008#26 = #dscam008#3;
   |FINSI;
   UltRecibo = UltRecibo + 1;
   #dscam008#53 = #dscam008#22; || Total original BASE
   #dscam008#54 = #dscam008#24; || Gastos de negociacion BASE
   #dscam008#55 = #dscam008#38; || Otros gastos BASE
   #dscam008#56 = #dscam008#25; || Total recibo BASE
   #dscam008#57 = #dscam008#23; || Total pagado BASE
   #dscam008#58 = #dscam008#31; || Total pendiente BASE
   |SI EURODB = 0;
      #dscam008#59 = "ESP";
      #dscam008#60 = "PESETA ESPA¥OLA";
   |SINO;
      #dscam008#59 = "EUR";
      #dscam008#60 = "EURO";
   |FINSI;
   #dscam008#61 = 1;
   |SI Version = "6.60";
      #dscam008#63 = #camanpa@#25;  || Referencia
   |FINSI;

   aCuenta = #dscam008#5;
   |HAZ CambioCuentas;
   #dscam008#5 = aCuenta;
   aCuenta = #dscam008#50;
   |HAZ CambioCuentas;
   #dscam008#50 = aCuenta;

   |GRABA 020#dscam008.n;
   |LEE 010#dscam008.=;

   |SI #dscam008#17 ! 0; |O #dscam008#23 = 0; |ACABA; |FINSI;

   #dscam009#14 = #dscam008#40;
   #dscam009#3 = 99;
   |LEE 010#dscam009.];
   |SI FSalida ! 0;
      |LEE 010#dscam009.u;
      |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
         LinPag = #dscam009#3 + 1;
      |SINO;
         LinPag = 1;
      |FINSI;
   |SINO;
      |SI #dscam009#14 = #dscam008#40;
         LinPag = #dscam009#3 + 1;
      |SINO;
         |LEE 010#dscam009.a;
         |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
            LinPag = #dscam009#3 + 1;
         |SINO;
            LinPag = 1;
         |FINSI;
      |FINSI;
   |FINSI;

   |DDEFECTO #dscam009;
   #dscam009#14 = #dscam008#40;        || N§ documento
   #dscam009#13 = #dscam008#27;        || Libro
   #dscam009#0  = #dscam008#0;         || Serie
   #dscam009#1  = #dscam008#1;         || Factura
   #dscam009#2  = #dscam008#2;         || Recibo
   #dscam009#3  = LinPag;              || N§ de pago
   Comodin = #dscam008#5; |QBF Comodin;
   aLong = Comodin % 0; nLong = aLong; nLong = nLong + 100;
   Comodin = "570000000000" % nLong;
   #dscam009#4  = Comodin;             || Cuenta de pago
   |SI #dscam008#14 = "L"; #dscam009#5  = "PAG"; |FINSI;
   |SI #dscam008#14 = "C"; #dscam009#5  = "PAP"; |FINSI;
   #dscam009#6  = #dscam008#3;         || Fecha de vencimiento
   #dscam009#7  = 0;                   || Total liquidado
   #dscam009#8  = #dscam008#23;        || Importe efecto
   #dscam009#9  = 0;

   #dscam009#20 = #dscam009#7;  || Importe liquidado BASE
   #dscam009#21 = #dscam009#8;  || Importe Pagado BASE
   #dscam009#23 = #dscam009#11; || Gastos de negociacion BASE
   #dscam009#24 = #dscam009#12; || Otros gastos BASE
   #dscam009#25 = 1;            || Cambio Actual

   |GRABA 020#dscam009.c;

   |SI #dscam008#14 = "L";
      |DDEFECTO #dscam067;
      #dscam067#0 = "PG";
      #dscam067#1 = #dscam009#14;
      #dscam067#2 = #dscam009#3;
      #dscam067#3 = "";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;
   |FINSI;
|FPRC;

|DEFBUCLE RecibosCompra1;
#camanpa@#1004;
;
01,"  ",000001,001;
99,"zz",999999,999;
;
NULL,RecibosCompra;
|FIN;

|DEFBUCLE RecibosCompra2;
#camanpa@#1004;
;
01,000001,"  ",001;
99,999999,"zz",999;
;
NULL,RecibosCompra;
|FIN;

|PROCESO LinConfirmes;
   |DDEFECTO #dscam050;
   #dscam050#0  = UltConfirme - 1;   || Codigo de Confirme
   #dscam050#1  = #caminli@#1;     || Linea de confirme
   #dscam050#2  = #caminli@#2;     || Libro
   #dscam050#3  = #caminli@#3;     || N§ factura
   #dscam050#4  = #caminli@#4;     || Serie
   #dscam050#5  = #caminli@#5;     || N§ Recibo
   #dscam050#7  = #caminli@#8;     || Importe

   |SELECT #2#dscam008;
   #dscam008#27 = #dscam050#2;  || Libro
   #dscam008#0  = #dscam050#4;  || Serie
   #dscam008#1  = #dscam050#3;  || Factura
   #dscam008#2  = #dscam050#5;  || Recibo
   |LEE 010#dscam008.=;
   |SI FSalida = 0;

      #dscam050#13 = #dscam008#40;    || N§ de documento

      #dscam008#17 = #dscam050#0;
      #dscam008#37 = #dscam050#1;
      #dscam008#39 = "C";
      #dscam008#47 = "Confirme";
      |GRABA 020#dscam008.a;

      #dscam009#14 = #dscam008#40;
      #dscam009#3 = 99;
      |LEE 010#dscam009.];
      |SI FSalida ! 0;
         |LEE 010#dscam009.u;
         |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
            LinPag = #dscam009#3 + 1;
         |SINO;
            LinPag = 1;
         |FINSI;
      |SINO;
         |SI #dscam009#14 = #dscam008#40;
            LinPag = #dscam009#3 + 1;
         |SINO;
            |LEE 010#dscam009.a;
            |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
               LinPag = #dscam009#3 + 1;
            |SINO;
               LinPag = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      |DDEFECTO #dscam009;
      #dscam009#14 = #dscam008#40;        || N§ documento
      #dscam009#13 = #dscam008#27;        || Libro
      #dscam009#0  = #dscam008#0;         || Serie
      #dscam009#1  = #dscam008#1;         || Factura
      #dscam009#2  = #dscam008#2;         || Recibo
      #dscam009#3  = LinPag;              || N§ de pago
      Comodin = #dscam008#4; |QBF Comodin;
      aLong = Comodin % 0; nLong = aLong; nLong = 100 + nLong;
      Comodin = "570000000000" % nLong;
      #dscam009#4  = Comodin;             || Cuenta de pago
      #dscam009#5  = "PCF";
      #dscam009#6  = #dscam008#3;         || Fecha de vencimiento
      #dscam009#7  = 0;                   || Total liquidado
      #dscam009#8  = #dscam008#23;        || Importe efecto
      #dscam009#9  = 0;
      |GRABA 020#dscam009.n;
      #dscam050#14 = LinPag;              || Linea de pago
   |FINSI;
   |SELECT #1#dscam008;

   #dscam050#6  = #caminli@#7;     || Fecha de Vencimiento
   #dscam050#8  = #caminli@#9;     || Cuenta de proveedor

   |SI #dscam050#6 < #dscam049#1;
      #dscam050#9  = "S";             || Recibo vencido
   |SINO;
      #dscam050#9  = "N";             || Recibo vencido
   |FINSI;

   #dscam050#10 = #caminli@#13;     || Nombre del proveedor
   |SI Version = "5.50";
      #dscam050#12 = #caminli@#14;     || Contabilizado Vto.
   |FINSI;
   aCuenta = #dscam050#8;
   |HAZ CambioCuentas;
   #dscam050#8 = aCuenta;

   |GRABA 020#dscam050.n;

   |SI #dscam049#8 = "S";
      |DDEFECTO #dscam067;
      #dscam067#0 = "CF";
      #dscam067#1 = #dscam050#0;
      #dscam067#2 = #dscam050#1;
      #dscam067#3 = "E";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;

      #dscam067#3 = "V";
      |GRABA 020#dscam067.n;
   |FINSI;
|FPRC;

|DEFBUCLE LinConfirmes;
#caminli@#1002;
;
#caminca@#0,001;
#caminca@#0,999;
;
NULL,LinConfirmes;
|FIN;

|PROCESO Confirmes;
   #dscam014#0 = #caminca@#3;
   |LEE 010#dscam014.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam014;
   |FINSI;

   |DDEFECTO #dscam049;
   #dscam049#0  = UltConfirme;  || Numero de pagare
   UltConfirme  = UltConfirme + 1;
   #dscam049#1  = #caminca@#1;  || Fecha de Confirme
   #dscam049#2  = #caminca@#2;  || Fecha de vencimiento
   #dscam049#3  = #caminca@#3;  || Codigo de banco
   #dscam049#4  = #dscam014#1;  || Nombre de banco
   #dscam049#5  = #caminca@#8;  || Numero de efectos
   #dscam049#6  = #caminca@#7;  || Tipo de recibo
   #dscam049#7  = #caminca@#10; || Emitido
   #dscam049#8  = #caminca@#11; || Contabilizado
   #dscam049#9  = #caminca@#9;  || Total pagare
   #dscam049#10 = #caminca@#4;  || Cuenta contable
   #dscam049#11 = #caminca@#5;  || Digito contable
   #dscam049#12 = #dscam014#34; || Entidad
   #dscam049#13 = #dscam014#35; || Sucursal
   #dscam049#14 = #dscam014#37; || Cuenta
   #dscam049#15 = #dscam014#36; || DC
   aCuenta = #dscam049#10;
   |HAZ CambioCuentas;
   #dscam049#10 = aCuenta;

   |GRABA 020#dscam049.n;
   |LEE 010#dscam049.=;

   |BUCLE LinConfirmes;

|FPRC;

|DEFBUCLE Confirmes;
#caminca@#1001;
;
00001;
99999;
;
NULL,Confirmes;
|FIN;

|PROCESO Talones;
   |SELECT #3#dscam014;
   #dscam014#10 = #camanta@#2;
   |LEE 010#dscam014.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam014;
   |FINSI;
   |SELECT #1#dscam014;

   |DDEFECTO #dscam046;
   #dscam046#0  = UltTalon;     || Codigo talon
   UltTalon = UltTalon + 1;
   #dscam046#1  = #camanta@#5;  || Fecha talon
   #dscam046#3  = #dscam014#0;  || Codigo banco
   #dscam046#4  = #dscam014#1;  || Nombre banco
   #dscam046#5  = 1;            || Numero de efectos
   #dscam046#6  = #camanta@#16; || Tipo de recibo
   #dscam046#7  = #camanta@#12; || Talon emitido
   #dscam046#8  = #camanta@#8;  || Talon Contabilizado
   #dscam046#9  = #camanta@#9;  || Importe Talon
   #dscam046#10 = #camanta@#1;  || Cuenta cargo
   #dscam046#11 = #camanta@#2;  || Digito cuenta cargo
   #dscam046#12 = #dscam014#34; || Entidad
   #dscam046#13 = #dscam014#35; || Sucursal
   #dscam046#14 = #dscam014#37; || Cuenta
   #dscam046#15 = #dscam014#36; || DC
   aCuenta = #dscam046#10;
   |HAZ CambioCuentas;
   #dscam046#10 = aCuenta;

   |GRABA 020#dscam046.n;

   |DDEFECTO #dscam047;
   #dscam047#0 = #dscam046#0;
   #dscam047#1 = 1;
   |GRABA 020#dscam047.n;

   |SI #dscam046#8 = "S";
      |DDEFECTO #dscam067;
      #dscam067#0 = "TA";
      #dscam067#1 = #dscam047#0;
      #dscam067#2 = #dscam047#1;
      #dscam067#3 = "E";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;
   |FINSI;
|FPRC;

|DEFBUCLE Talones;
#camanta@#1001;
;
000001;
999999;
;
NULL,Talones;
|FIN;

|PROCESO LinPagares;
   |DDEFECTO #dscam022;
   #dscam022#0  = UltPagare - 1;   || Codigo de pagare
   #dscam022#1  = #capagli@#1;     || Linea de pagare
   #dscam022#2  = #capagli@#2;     || Libro
   #dscam022#3  = #capagli@#3;     || N§ factura
   #dscam022#4  = #capagli@#9;     || Serie
   #dscam022#5  = #capagli@#4;     || N§ Cobro
   #dscam022#7  = #capagli@#7;     || Importe

   |SELECT #2#dscam008;
   #dscam008#27 = #dscam022#2;  || Libro
   #dscam008#0  = #dscam022#4;  || Serie
   #dscam008#1  = #dscam022#3;  || Factura
   #dscam008#2  = #dscam022#5;  || Recibo
   |LEE 010#dscam008.=;
   |SI FSalida = 0;
      #dscam008#17 = #dscam022#0;
      #dscam008#37 = #dscam022#1;
      #dscam008#39 = "P";
      #dscam008#47 = "Pagare";
      |GRABA 020#dscam008.a;
      |LEE 010#dscam008.=;

      #dscam009#14 = #dscam008#40;
      #dscam009#3 = 99;
      |LEE 010#dscam009.];
      |SI FSalida ! 0;
         |LEE 010#dscam009.u;
         |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
            LinPag = #dscam009#3 + 1;
         |SINO;
            LinPag = 1;
         |FINSI;
      |SINO;
         |SI #dscam009#14 = #dscam008#40;
            LinPag = #dscam009#3 + 1;
         |SINO;
            |LEE 010#dscam009.a;
            |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
               LinPag = #dscam009#3 + 1;
            |SINO;
               LinPag = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      |DDEFECTO #dscam009;
      #dscam009#14 = #dscam008#40;        || N§ documento
      #dscam009#13 = #dscam008#27;        || Libro
      #dscam009#0  = #dscam008#0;         || Serie
      #dscam009#1  = #dscam008#1;         || Factura
      #dscam009#2  = #dscam008#2;         || Recibo
      #dscam009#3  = LinPag;              || N§ de pago
      Comodin = #dscam008#4; |QBF Comodin;
      aLong = Comodin % 0; nLong = aLong; nLong = 100 + nLong;
      Comodin = "570000000000" % nLong;
      #dscam009#4  = Comodin;             || Cuenta de pago
      #dscam009#5  = "PPA";
      #dscam009#6  = #dscam008#3;         || Fecha de vencimiento
      #dscam009#7  = 0;                   || Total liquidado
      #dscam009#8  = #dscam008#23;        || Importe efecto
      #dscam009#9  = 0;
      |GRABA 020#dscam009.n;
      #dscam022#14 = LinPag;              || Linea de pago

   |FINSI;
   |SELECT #1#dscam008;

   #dscam022#6  = #dscam008#3;     || Fecha de Vencimiento
   #dscam022#8  = #dscam008#5;     || Cuenta de proveedor
   |SI #dscam022#6 < #dscam021#1;
      #dscam022#9  = "S";             || Recibo vencido
   |SINO;
      #dscam022#9  = "N";             || Recibo vencido
   |FINSI;

   #dscam022#10 = #dscam008#6;     || Nombre del proveedor
   #dscam022#12 = #capagca@#8;     || Contabilizado Vto.
   #dscam022#13 = #dscam008#40;    || N§ de documento

   aCuenta = #dscam022#8;
   |HAZ CambioCuentas;
   #dscam022#8 = aCuenta;

   |GRABA 020#dscam022.n;

   NumRecs = NumRecs + 1;

   |SI #dscam021#8 = "S";
      |DDEFECTO #dscam067;
      #dscam067#0 = "PA";
      #dscam067#1 = #dscam022#0;
      #dscam067#2 = #dscam022#1;
      #dscam067#3 = "E";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;

      #dscam067#3 = "V";
      |GRABA 020#dscam067.n;
   |FINSI;
|FPRC;

|DEFBUCLE LinPagares;
#capagli@#1002;
;
#capagca@#0,001;
#capagca@#0,999;
;
NULL,LinPagares;
|FIN;

|PROCESO Pagares;
   |SELECT #3#dscam014;
   #dscam014#10 = #capagca@#3;
   |LEE 010#dscam014.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam014;
   |FINSI;
   |SELECT #1#dscam014;

   |DDEFECTO #dscam021;
   #dscam021#0  = UltPagare;    || Numero de pagare
   UltPagare = UltPagare + 1;
   #dscam021#1  = #capagca@#5;  || Fecha de pagare
   #dscam021#2  = #capagca@#6;  || Fecha de vencimiento
   #dscam021#3  = #dscam014#0;  || Codigo de banco
   #dscam021#4  = #dscam014#1;  || Nombre de banco
   |SI Version = "5.50";
      #dscam021#6  = #capagca@#14; || Tipo de recibo
   |FINSI;
   |SI #capagca@#12 = "S";
      #dscam021#7  = "A";       || Emitido pagare
   |SINO;
      #dscam021#7  = "N";
   |FINSI;
   #dscam021#8  = #capagca@#7;  || Contabilizada
   #dscam021#9  = #capagca@#9;  || Total pagare
   #dscam021#10 = #capagca@#3;  || Cuenta contable
   #dscam021#11 = #capagca@#4;  || Digito contable
   #dscam021#12 = #dscam014#34; || Entidad
   #dscam021#13 = #dscam014#35; || Sucursal
   #dscam021#14 = #dscam014#37; || Cuenta
   #dscam021#15 = #dscam014#36; || DC
   aCuenta = #dscam021#10;
   |HAZ CambioCuentas;
   #dscam021#10 = aCuenta;

   |GRABA 020#dscam021.n;
   |LEE 010#dscam021.=;

   NumRecs = 0;
   |BUCLE LinPagares;

   #dscam021#5  = NumRecs;      || Numero de efectos
   |GRABA 020#dscam021.a;

|FPRC;

|DEFBUCLE Pagares;
#capagca@#1001;
;
00001;
99999;
;
NULL,Pagares;
|FIN;

|PROCESO LinRemesas;
   |DDEFECTO #dscam013;
   #dscam013#0  = UltRemesa - 1;   || Codigo de remesa
   #dscam013#1  = #caremel@#1;     || Linea de remesa
   #dscam013#2  = #caremel@#2;     || Libro
   #dscam013#3  = #caremel@#3;     || N§ factura
   #dscam013#4  = #caremel@#4;     || Serie
   #dscam013#5  = #caremel@#5;     || N§ Cobro
   #dscam013#6  = #caremel@#6;     || Fecha Vto.
   #dscam013#7  = #caremel@#7;     || Importe
   #dscam013#8  = #caremel@#8;     || Dias
   #dscam013#9  = #caremel@#9;     || % Interes
   #dscam013#10 = #caremel@#10;    || Interes
   #dscam013#11 = #caremel@#11;    || Cuenta Cliente
   #dscam013#12 = "N";             || Recibo vencido
   #dscam013#13 = #caremel@#13;    || Nombre Cliente
   #dscam013#14 = #caremel@#14;    || Poblacion
   |SI Version = "5.30"; |O Version = "6.60";
      #dscam013#15 = #caremel@#15;    || Contabilizado Vto.
   |SINO;
      #dscam013#15 = "N";             || Contabilizado Vto.
   |FINSI;
   aCuenta = #dscam013#11;
   |HAZ CambioCuentas;
   #dscam013#11 = aCuenta;

   |GRABA 020#dscam013.c;

   |SELECT #6#dscam003;
   #dscam003#27 = #dscam013#2;  || Libro
   #dscam003#0  = #dscam013#4;  || Serie
   #dscam003#1  = #dscam013#3;  || Factura
   #dscam003#2  = #dscam013#5;  || Recibo
   #dscam003#69 = " ";          || Documento a cuenta
   #dscam003#40 = 1;            || N§ documento
   |LEE 000#dscam003.];
   |SI FSalida = 0; |Y #dscam003#27 = #dscam013#2; |Y #dscam003#0  = #dscam013#4;
    |Y #dscam003#1  = #dscam013#3; |Y #dscam003#2  = #dscam013#5;
      #dscam013#16 = #dscam003#40;
      |GRABA 020#dscam013.a;

      |SI #dscam013#15 = "N";
         #dscam003#14 = "R";
         #dscam003#15 = "Remesado";
         #dscam003#23 = #dscam003#23 - (#dscam013#7 + #dscam012#6);
         #dscam003#31 = #dscam003#30 - #dscam003#23;
      |FINSI;
      #dscam003#17 = #dscam013#0;
      #dscam003#37 = #dscam013#1;
      #dscam003#52 = #dscam012#1;
      #dscam003#53 = #dscam012#3;
      #dscam003#84 = #dscam013#15;
      |GRABA 020#dscam003.a;
   |FINSI;
   |SELECT #1#dscam003;

   |SI #dscam012#23 = "S";
      || Actualizo  el historico de cobros
      #dscam004#17 = #dscam013#16;
      #dscam004#3 = 99;
      |LEE 010#dscam004.];
      |SI FSalida ! 0;
         |LEE 010#dscam004.u;
         |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
            LinCob = #dscam004#3 + 1;
            UltOp = #dscam004#5;
         |SINO;
            LinCob = 1;
         |FINSI;
      |SINO;
         |SI #dscam004#17 = #dscam013#16;
            LinCob = #dscam004#3 + 1;
            UltOp = #dscam004#5;
         |SINO;
            |LEE 010#dscam004.a;
            |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
               UltOp = #dscam004#5;
            |SINO;
               LinCob = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      #dscam004#17 = #dscam013#16;
      #dscam004#15 = #dscam013#2;
      #dscam004#0  = #dscam013#4;
      #dscam004#1  = #dscam013#3;
      #dscam004#2  = #dscam013#5;
      #dscam004#3  = LinCob;
      #dscam004#4  = #dscam012#14;
      #dscam004#5  = "EMR";
      #dscam004#6  = #dscam013#6;
      #dscam003#40 = #dscam013#16;
      |LEE 010#dscam003.=;
      |SI FSalida = 0; #dscam004#7  = #dscam003#23; |FINSI;
      #dscam004#8  = 0;
      #dscam004#9  = 0;
      #dscam004#10 = 0;
      |GRABA 020#dscam004.n;

      #dscam013#24 = LinCob; |GRABA 020#dscam013.a;
   |FINSI;

   |SI #dscam013#15 = "S";
      || Actualizo  el historico de cobros
      #dscam004#17 = #dscam013#16;
      #dscam004#3 = 99;
      |LEE 010#dscam004.];
      |SI FSalida ! 0;
         |LEE 010#dscam004.u;
         |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
            LinCob = #dscam004#3 + 1;
            UltOp = #dscam004#5;
         |SINO;
            LinCob = 1;
         |FINSI;
      |SINO;
         |SI #dscam004#17 = #dscam013#16;
            LinCob = #dscam004#3 + 1;
            UltOp = #dscam004#5;
         |SINO;
            |LEE 010#dscam004.a;
            |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
               UltOp = #dscam004#5;
            |SINO;
               LinCob = 1;
            |FINSI;
         |FINSI;
      |FINSI;

      #dscam004#17 = #dscam013#16;
      #dscam004#15 = #dscam013#2;
      #dscam004#0  = #dscam013#4;
      #dscam004#1  = #dscam013#3;
      #dscam004#2  = #dscam013#5;
      #dscam004#3  = LinCob;
      #dscam004#4  = #dscam012#14;
      #dscam004#5  = "REM";
      #dscam004#6  = #dscam013#6;
      #dscam003#40 = #dscam013#16;
      |LEE 010#dscam003.=;
      |SI FSalida = 0;
         #dscam004#7  = #dscam003#23;
      |FINSI;
      #dscam004#8  = #dscam013#7 + #dscam012#6;
      #dscam004#9  = 0;
      #dscam004#10 = 0;
      |GRABA 020#dscam004.n;

      #dscam013#17 = LinCob; |GRABA 020#dscam013.a;
   |FINSI;
   NumRecs = NumRecs + 1;

   |SI #dscam012#23 = "S";
      |DDEFECTO #dscam067;
      #dscam067#0 = "RM";
      #dscam067#1 = #dscam013#0;
      #dscam067#2 = #dscam013#1;
      #dscam067#3 = "E";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;

      #dscam067#3 = "V";
      |GRABA 020#dscam067.n;
   |FINSI;

   |SI #dscam013#15 = "S";
      #dscam003#40 = #dscam013#16;
      |LEE 000#dscam003.=;
      |SI FSalida = 0; |Y #dscam003#16 > 0;
         || Grabo el impagado en el historico de cobros
         fFechaCob = "01.01.0000";
         #dscam004#17 = #dscam013#16;
         #dscam004#3 = 99;
         |LEE 010#dscam004.];
         |SI FSalida ! 0;
            |LEE 010#dscam004.u;
            |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
               fFechaCob = #dscam004#6;
            |SINO;
               LinCob = 1;
            |FINSI;
         |SINO;
            |SI #dscam004#17 = #dscam013#16;
               LinCob = #dscam004#3 + 1;
               fFechaCob = #dscam004#6;
            |SINO;
               |LEE 010#dscam004.a;
               |SI FSalida = 0; |Y #dscam004#17 = #dscam013#16;
                  LinCob = #dscam004#3 + 1;
                  fFechaCob = #dscam004#6;
               |SINO;
                  LinCob = 1;
               |FINSI;
            |FINSI;
         |FINSI;
         #dscam004#17 = #dscam003#40;
         #dscam004#15 = #dscam003#27;
         #dscam004#0  = #dscam003#0;
         #dscam004#1  = #dscam003#1;
         #dscam004#2  = #dscam003#2;
         #dscam004#3  = LinCob;
         #dscam004#4  = #dscam012#14;
         #dscam004#5  = "IMP";
         #dscam004#6  = fFechaCob;
         #dscam004#7  = #dscam003#23;
         #dscam004#8  = 0;            #dscam004#26 = 0;
         #dscam004#9  = #dscam003#22; #dscam004#27 = #dscam003#22;
         #dscam004#13 = #dscam003#25; #dscam004#30 = #dscam003#25;
         |GRABA 020#dscam004.n;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LinRemesas;
#caremel@#1002;
;
#caremec@#0,001;
#caremec@#0,999;
;
NULL,LinRemesas;
|FIN;

|PROCESO LinRem;
   |SI #caremel@#15 = "S"; nSwEmit = 1; |ERROR10; |FINSI;
|FPRC;

|DEFBUCLE LinRem;
#caremel@#1002;
;
#caremec@#0,001;
#caremec@#0,999;
;
NULL,LinRem;
|FIN;

|PROCESO Remesas;
   enBanco = #caremec@#2;
   nSwEmit = 0;
   |BUCLE LinRem; || Compruebo si hay recibos vencidos .... si es asi, la doy
                  ||     por emitida forzosamente

   |DDEFECTO #dscam012;
   #dscam012#0  = UltRemesa;    || Numero de remesa
   UltRemesa = UltRemesa + 1;
   #dscam012#1  = #caremec@#1;  || Fecha de remesa
   #dscam012#2  = #caremec@#2;  || Codigo de banco
   #dscam012#3  = #caremec@#3;  || Nombre del banco
   #dscam012#4  = #caremec@#5;  || Numero de efectos
   #dscam012#4  = #dscam014#7;  || Cta.Cte.
   #dscam012#6  = #caremec@#6;  || Comision por efecto
   #dscam012#7  = #caremec@#7;  || Tipo de recibo
   |SI nSwEmit = 0;
      #dscam012#23 = #caremec@#8;  || Emitida
      #dscam012#8  = "N";          || Abonada
   |SINO;
      #dscam012#23 = "S";          || Emitida
      #dscam012#8  = "S";          || Abonada
   |FINSI;
   #dscam012#9  = #caremec@#9;  || Contabilizada
   #dscam012#10 = #caremec@#10; || Total remesa
   #dscam012#11 = #caremec@#11; || Total Comision
   #dscam012#12 = #caremec@#12; || Total Interes
   #dscam012#13 = #caremec@#13; || Total Vencidos
   #dscam012#14 = #caremec@#14; || Cuenta contable
   #dscam012#15 = #caremec@#15; || Digito contable
   #dscam012#16 = #dscam014#34; || Entidad
   #dscam012#17 = #dscam014#35; || Sucursal
   #dscam012#18 = #dscam014#36; || Cuenta
   #dscam012#19 = #dscam014#37; || DC
   #dscam012#22 = 2;            || Tipo de remesa. Todas de tipo 2

   aCuenta = #dscam012#14;
   |HAZ CambioCuentas;
   #dscam012#14 = aCuenta;

   |GRABA 020#dscam012.n;
   |LEE 010#dscam012.=;

   NumRecs = 0;
   |BUCLE LinRemesas;

   #dscam012#5  = NumRecs;      || Numero de efectos
   |GRABA 020#dscam012.a;

|FPRC;

|DEFBUCLE Remesas;
#caremec@#1001;
;
00001;
99999;
;
NULL,Remesas;
|FIN;

|PROCESO LinPagosDoms;
   |DDEFECTO #dscam096;
   #dscam096#0  = UltPagoDom - 1;  || Codigo de Confirme
   #dscam096#1  = #camanpl@#1;     || Linea de confirme
   #dscam096#2  = #camanpl@#2;     || Libro
   #dscam096#3  = #camanpl@#3;     || N§ factura
   #dscam096#4  = #camanpl@#4;     || Serie
   #dscam096#5  = #camanpl@#5;     || N§ Recibo
   #dscam096#7  = #camanpl@#7;     || Importe BASE
   #dscam096#22 = #camanpl@#7;     || Importe DIV
   #dscam096#11 = #camanpl@#8;     || Cuenta de proveedor
   #dscam096#13 = #camanpl@#9;     || Nombre de proveedor
   #dscam096#14 = #camanpl@#10;    || Poblacion
   #dscam096#15 = #camanpl@#11;    || Contabilizado Vto.

   |SELECT #2#dscam008;
   #dscam008#27 = #dscam096#2;  || Libro
   #dscam008#0  = #dscam096#4;  || Serie
   #dscam008#1  = #dscam096#3;  || Factura
   #dscam008#2  = #dscam096#5;  || Recibo
   |LEE 000#dscam008.=;
   |SI FSalida = 0;
      #dscam096#16 = #dscam008#40;    || N§ de documento
      |SI #dscam096#15 = "N";
         #dscam008#14 = "E";
         #dscam008#15 = "Englobado Rel.Pagos Domic";
         #dscam008#23 = 0; #dscam008#57 = 0;
         #dscam008#25 = #dscam008#22 + #dscam008#24 + #dscam008#38; #dscam008#56 = #dscam008#53 + #dscam008#54 + #dscam008#55;
         #dscam008#31 = #dscam008#25 - #dscam008#23;  #dscam008#58 = #dscam008#56 - #dscam008#57;
      |FINSI;
      #dscam008#17 = #dscam096#0;
      #dscam008#37 = #dscam096#1;
      #dscam008#39 = "D";
      #dscam008#47 = "Pagos Dom.";
      |GRABA 020#dscam008.a;

      |SI #dscam096#15 = "S";
         #dscam009#14 = #dscam008#40;
         #dscam009#3 = 99;
         |LEE 010#dscam009.];
         |SI FSalida ! 0;
            |LEE 010#dscam009.u;
            |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
               LinPag = #dscam009#3 + 1;
            |SINO;
               LinPag = 1;
            |FINSI;
         |SINO;
            |SI #dscam009#14 = #dscam008#40;
               LinPag = #dscam009#3 + 1;
            |SINO;
               |LEE 010#dscam009.a;
               |SI FSalida = 0; |Y #dscam009#14 = #dscam008#40;
                  LinPag = #dscam009#3 + 1;
               |SINO;
                  LinPag = 1;
               |FINSI;
            |FINSI;
         |FINSI;

         |DDEFECTO #dscam009;
         #dscam009#14 = #dscam008#40;        || N§ documento
         #dscam009#13 = #dscam008#27;        || Libro
         #dscam009#0  = #dscam008#0;         || Serie
         #dscam009#1  = #dscam008#1;         || Factura
         #dscam009#2  = #dscam008#2;         || Recibo
         #dscam009#3  = LinPag;              || N§ de pago
         Comodin = #dscam008#4; |QBF Comodin;
         aLong = Comodin % 0; nLong = aLong; nLong = 100 + nLong;
         Comodin = "570000000000" % nLong;
         #dscam009#4  = Comodin;             || Cuenta de pago
         #dscam009#5  = "PDM";
         #dscam009#6  = #dscam008#3;         || Fecha de vencimiento
         #dscam009#7  = 0;                   || Total liquidado
         #dscam009#8  = #dscam008#23;        || Importe efecto
         #dscam009#9  = 0;
         |GRABA 020#dscam009.n;
         #dscam096#17 = LinPag;              || Linea de pago
      |FINSI;
   |FINSI;
   |SELECT #1#dscam008;

   |SI #dscam096#6 < #dscam095#1;
      #dscam096#12  = "S";             || Recibo vencido
   |SINO;
      #dscam096#12  = "N";             || Recibo vencido
   |FINSI;

   |SI Version = "5.50";
      #dscam096#15 = #camanpl@#11;     || Contabilizado Vto.
   |FINSI;

   aCuenta = #dscam096#11;
   |HAZ CambioCuentas;
   #dscam096#11 = aCuenta;

   |GRABA 020#dscam096.n;

   |SI #dscam049#8 = "S";
      |DDEFECTO #dscam067;
      #dscam067#0 = "PD";
      #dscam067#1 = #dscam096#0;
      #dscam067#2 = #dscam096#1;
      #dscam067#3 = "E";
      #dscam067#4 = 0;
      #dscam067#5 = "00.00.0000";
      #dscam067#6 = 0;
      |GRABA 020#dscam067.n; |LEE 000#dscam067.=;

      #dscam067#3 = "V";
      |GRABA 020#dscam067.n;
   |FINSI;
|FPRC;

|DEFBUCLE LinPagosDoms;
#camanpl@#1002;
;
#camanpc@#0,001;
#camanpc@#0,999;
;
NULL,LinPagosDoms;
|FIN;

|PROCESO PagosDomics;
   #dscam014#0 = #camanpc@#2;
   |LEE 010#dscam014.=;
   |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;

   |DDEFECTO #dscam095;
   #dscam095#0  = UltPagoDom;  || Numero de relacion
   UltPagoDom  = UltPagoDom + 1;
   #dscam095#1  = #camanpc@#1;   || Fecha de relacion
   #dscam095#2  = #camanpc@#2;   || Codigo de banco
   #dscam095#3  = #camanpc@#3;   || Nombre de banco
   #dscam095#4  = #camanpc@#4;
   #dscam095#5  = #camanpc@#5;   || Numero de efectos
   #dscam095#6  = #camanpc@#6;
   #dscam095#7  = #camanpc@#7;   || Tipo de recibo
   #dscam095#8  = #camanpc@#8;   || Emitido
   #dscam095#9  = #camanpc@#9;   || Contabilizado
   #dscam095#10 = #camanpc@#10;  || Total relacion
   #dscam095#11 = #camanpc@#11;  || Emision contabilizado
   #dscam095#12 = #camanpc@#12;  || Vto.contabilizado
   #dscam095#13 = #camanpc@#13;  || Cuenta contable
   #dscam095#14 = #camanpc@#14;  || Digito contable
   #dscam095#15 = #camanpc@#15;  || Entidad
   #dscam095#16 = #camanpc@#16;  || Sucursal
   #dscam095#17 = #camanpc@#17;  || Cuenta
   #dscam095#18 = #camanpc@#18;  || Digito control
   #dscam095#19 = #camanpc@#19;  || Empresa contable
   #dscam095#20 = #camanpc@#20;  || Periodo contable
   #dscam095#21 = #camanpc@#21;  || Periodo contable
   #dscam095#22 = #camanpc@#22;
   aCuenta = #dscam095#14;
   |HAZ CambioCuentas;
   #dscam095#14 = aCuenta;

   |GRABA 020#dscam095.c;

   |BUCLE LinPagosDoms;
|FPRC;

|DEFBUCLE PagosDomics;
#camanpc@#1001;
;
00001;
99999;
;
NULL,PagosDomics;
|FIN;

|| ///////////////////////////
|PROCESO Bancos;
   |DDEFECTO #dscam014;
   #dscam014#0  = #camanba@#0;  || Codigo de banco
   #dscam014#1  = #camanba@#1;  || Nombre de banco
   #dscam014#2  = #camanba@#2;  || Direccion de banco
   #dscam014#3  = #camanba@#3;  || Codigo postal 1
   #dscam014#4  = #camanba@#4;  || Codigo postal 2
   #dscam014#5  = #camanba@#5;  || Provincia
   #dscam014#6  = #camanba@#6;  || Poblacion
   #dscam014#7  = #camanba@#7;  || Telefono
   #dscam014#8  = #camanba@#8;  || Cta.Cte.
   #dscam014#9  = #camanba@#9;  || C.C.C.
   #dscam014#10 = #camanba@#10; || Cta.Contable
   #dscam014#11 = #camanba@#11; || Digito Contable
   #dscam014#12 = #camanba@#12; || Riesgo concedido
   #dscam014#13 = #camanba@#13; || Riesgo Actual
   #dscam014#14 = #camanba@#14; || CIF
   #dscam014#15 = #camanba@#15; || Fax
   #dscam014#16 = #camanba@#16; || Comision por efecto
   #dscam014#17 = #camanba@#17; || Interes anual
   #dscam014#18 = #camanba@#18; || Persona de contacto
   #dscam014#19 = #camanba@#19; || Observaciones
   #dscam014#20 = #camanba@#20; || Interes desde 1
   #dscam014#21 = #camanba@#21; || Interes desde 2
   #dscam014#22 = #camanba@#22; || Interes desde 3
   #dscam014#23 = #camanba@#23; || Interes desde 4
   #dscam014#24 = #camanba@#24; || Interes hasta 1
   #dscam014#25 = #camanba@#25; || Interes hasta 2
   #dscam014#26 = #camanba@#26; || Interes hasta 3
   #dscam014#27 = #camanba@#27; || Interes hasta 4
   #dscam014#28 = #camanba@#28; || % Interes 1
   #dscam014#29 = #camanba@#29; || % Interes 2
   #dscam014#30 = #camanba@#30; || % Interes 3
   #dscam014#31 = #camanba@#31; || % Interes 4

   Comodin  = #camanba@#9; |QBF Comodin;
   Comodin1 = Comodin % 0104;
   #dscam014#34 = Comodin1;     || Entidad
   Comodin1 = Comodin % 0504;
   #dscam014#35 = Comodin1;     || Sucursal
   #dscam014#37 = #camanba@#8;  || Cuenta

   eaEntidad  = #dscam014#34;
   eaSucursal = #dscam014#35;
   eaCuenta   = #dscam014#37;
   |HAZ CalculoDC;
   #dscam014#36 = eaDC;         || DC

   eaIBANant = "";
   eaCta     = #dscam014#34 + #dscam014#35 + #dscam014#36 + #dscam014#37;
   eaPais    = #dscam014#76;
   |HAZ CalcuIBAN;
   #dscam014#42 = eaIBAN;

   aCuenta = #dscam014#10;
   |HAZ CambioCuentas;
   #dscam014#10 = aCuenta;

   |GRABA 020#dscam014.n;
|FPRC;

|DEFBUCLE Bancos;
   #camanba@#1001;
   ;
   001;
   999;
   ;
   NULL,Bancos;
|FIN;

|PROCESO ElProceso;

      |HAZ AbreFichs;
      |SI nSwError ! 0;
          |MENAV aMensa;
          |HAZ DesCargaDef;
          |ACABA;
      |FINSI;

      |PATH_DAT #camanco@#aPathFich#;
      |PATH_DAT #camanpa@#aPathFich#;
      |PATH_DAT #caremec@#aPathFich#;
      |PATH_DAT #caremel@#aPathFich#;
      |PATH_DAT #camanta@#aPathFich#;
      |PATH_DAT #capagca@#aPathFich#;
      |PATH_DAT #capagli@#aPathFich#;
      |PATH_DAT #caminca@#aPathFich#;
      |PATH_DAT #caminli@#aPathFich#;
      |PATH_DAT #caclipr@#aPathFich#;
      |PATH_DAT #camanba@#aPathFich#;
      |PATH_DAT #camanpc@#aPathFich#;
      |PATH_DAT #camanpl@#aPathFich#;

      |SI Version = "5.30"; |O Version = "6.60";
          Comodin = aPathOrigen + "000000/";
          |PATH_DAT #camoned@#Comodin#;
      |FINSI;

      EURO = 166.386;
      EURODB = 2;
      EURODV = 0;
      |SI Version = "5.30"; |O Version = "6.60";
          |ABRE #camoned@;
          #camoned@#0 = #dscaz024#1;
          #camoned@#1 = #dscaz024#2;
          |LEE 000#camoned@.=;
          |SI FSalida = 0;
              |SI #camoned@#2 ! "E";
                  EURO = 1 / 166.386;
                  EURODB = 0;
                  EURODV = 2;
              |FINSI;
           |FINSI;
           |CIERRA #camoned@;
      |FINSI;

      |ABRE #camanco@;
      |ABRE #camanpa@;
      |ABRE #caremec@;
      |ABRE #caremel@;
      |ABRE #capagca@;
      |ABRE #capagli@;
      |ABRE #camanta@;
      |ABRE #caminca@;
      |ABRE #caminli@;
      |ABRE #camanpc@;
      |ABRE #camanpl@;
      |ABRE #camanpl@;
      |ABRE #caclipr@;
      |ABRE #camanba@;
      |SI aDef99 ! "";  |ABRE #cacambi@; |FINSI;

      |DELINDEX #dscam014;
      |SI aParam = "basica";
          |DELINDEX #dscam012;
          |DELINDEX #dscam013;
          |DELINDEX #dscam021;
          |DELINDEX #dscam022;
          |DELINDEX #dscam046;
          |DELINDEX #dscam047;
          |DELINDEX #dscam049;
          |DELINDEX #dscam050;
          |DELINDEX #dscam095;
          |DELINDEX #dscam096;
          |DELINDEX #dscam003;
          |DELINDEX #dscam224;
          |DELINDEX #dscam004;
          |DELINDEX #dscam008;
          |DELINDEX #dscam009;
          |DELINDEX #dscam067;
      |FINSI;

      |ABRE #dscam012;
      |ABRE #dscam013;
      |ABRE #dscam014;
      |ABRE #dscam021;
      |ABRE #dscam022;
      |ABRE #dscam046;
      |ABRE #dscam047;
      |ABRE #dscam049;
      |ABRE #dscam050;
      |ABRE #dscam095;
      |ABRE #dscam096;
      |ABRE #dscam003;
      |ABRE #dscam224;
      |ABRE #dscam004;
      |ABRE #dscam008;
      |ABRE #dscam009;
      |ABRE #dscam014;
      |ABRE #dscam048;
      |ABRE #dscam067;

      |BUCLE Bancos;

      |LEE 000#dscam003.u;
      |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;
      UltRecibo = #dscam003#40 + 1;
      |SI #dscaz024#4 = "S";
          |SI Version = "5.50"; |O Version = "6.60";
              |BUCLE RecibosVenta2;
          |SINO;
              |BUCLE RecibosVenta1;
          |FINSI;
      |FINSI;

      |LEE 000#dscam008.u;
      |SI FSalida ! 0; |DDEFECTO #dscam008; |FINSI;
      UltRecibo = #dscam008#40 + 1;
      |SI #dscaz024#5 = "S";
         |SI Version = "5.50"; |O Version = "6.60";
            |BUCLE RecibosCompra2;
         |SINO;
            |BUCLE RecibosCompra1;
         |FINSI;
      |FINSI;

      |LEE 000#dscam012.u;
      |SI FSalida ! 0;
         |DDEFECTO #dscam012;
         UltRemesa = 1;
      |SINO;
         UltRemesa = #dscam012#0 + 1;
      |FINSI;
      |SI #dscaz024#6 = "S"; |BUCLE Remesas; |FINSI;

      |LEE 000#dscam021.u;
      |SI FSalida ! 0;
         |DDEFECTO #dscam021;
         UltPagare = 1;
      |SINO;
         UltPagare = #dscam021#0 + 1;
      |FINSI;
      |SI #dscaz024#7 = "S"; |BUCLE Pagares; |FINSI;

      |LEE 010#dscam046.u;
      |SI FSalida ! 0;
         |DDEFECTO #dscam046;
         UltTalon = 1;
      |SINO;
         UltTalon = #dscam046#0 + 1;
      |FINSI;
      |SI #dscaz024#8 = "S"; |BUCLE Talones; |FINSI;

      |LEE 010#dscam049.u;
      |SI FSalida ! 0;
         |DDEFECTO #dscam049;
         UltConfirme = 1;
      |SINO;
         UltConfirme = #dscam049#0 + 1;
      |FINSI;
      |SI #dscaz024#9 = "S"; |BUCLE Confirmes; |FINSI;

      |LEE 010#dscam095.u;
      |SI FSalida ! 0;
         |DDEFECTO #dscam095;
         UltPagoDom = 1;
      |SINO;
         UltPagoDom = #dscam095#0 + 1;
      |FINSI;
      |SI #dscaz024#11 = "S"; |BUCLE PagosDomics; |FINSI;

      |CIERRA #dscam067;
      |CIERRA #dscam012;
      |CIERRA #dscam013;
      |CIERRA #dscam014;
      |CIERRA #dscam021;
      |CIERRA #dscam022;
      |CIERRA #dscam047;
      |CIERRA #dscam046;
      |CIERRA #dscam049;
      |CIERRA #dscam050;
      |CIERRA #dscam095;
      |CIERRA #dscam096;
      |CIERRA #dscam048;
      |CIERRA #dscam014;
      |CIERRA #dscam009;
      |CIERRA #dscam008;
      |CIERRA #dscam004;
      |CIERRA #dscam224;
      |CIERRA #dscam003;

      |SI aDef99 ! "";  |CIERRA #cacambi@; |FINSI;
      |CIERRA #camanba@;
      |CIERRA #caclipr@;
      |CIERRA #camanpl@;
      |CIERRA #camanpc@;
      |CIERRA #caminli@;
      |CIERRA #caminca@;
      |CIERRA #camanta@;
      |CIERRA #capagli@;
      |CIERRA #capagca@;
      |CIERRA #caremel@;
      |CIERRA #caremec@;
      |CIERRA #camanpa@;
      |CIERRA #camanco@;
|FPRC;

|PROCESO MiraContagen;
   nExiste  = 0;
   MaxDigit = 0;
   Comodin = #48#16; |QBF Comodin;
   |SI Comodin = ""; |ACABA; |FINSI;

   aDef = Comodin + "def/canempre.mas";
   |CARGA_DEF aDef, canempr@;
   |SI FSalida = 0;
       aPath = Comodin + "fich/";
       |PATH_DAT #canempr@#aPath#
       |ABRE #canempr@;
       #canempr@#2 = #48#14;
       #canempr@#3 = #48#19;
       |LEE 040#canempr@.=;
       |SI FSalida = 0;
           |HAZ Variables;
           MaxDigit = MaximoDigitos;

           aDef99 = Comodin + "def/cacambix.mas";
           |CARGA_DEF aDef99, cacambi@;
           |SI FSalida = 0;
               aAlfa = (("00000" + #48#14) % -105) + #48#19;
               aPath = Comodin + "fich/" + aAlfa + "/";
               |PATH_DAT #cacambi@#aPath#
               |ABRE #cacambi@;
               |LEE 040#cacambi@.p;
               |SI FSalida = 0;
                   nExiste = 1;
               |FINSI;
               |CIERRA #cacambi@;
            |SINO;
               aDef99 = "";
            |FINSI;
        |FINSI;
        |DESCARGA_DEF #canempr@;
     |FINSI;
|FPRC;

|PROGRAMA;

   aParam = PARAMETRO; |QBF aParam;

   |CLS;
   |CABEZA "Importacion desde contabilidad";

   |ABRE #dscaz024;
   |LEE 010#dscaz024.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscaz024;
      #dscaz024#14 = #48#0;
      #dscaz024#15 = #48#1;
      |GRABA 020#dscaz024.n;
      |LEE 010#dscaz024.p;
   |FINSI;

   |HAZ MiraContagen;
   |SI aParam = "basica"; |O aParam = "basica1";
       |PDEFECTO #dscaz024, 0, 14;
       #dscaz024#0 = eaDirAgicont;
       nSwError = 0;
       |HAZ CargaEmpAgicont;
       |SI nSwError ! 0;
           |MENAV "0000No se ha podido pasar Cartera";
           |CIERRA #dscaz024;
           |ACABA;
       |FINSI;
       #dscaz024#1 = enEmpAgicont;
       #dscaz024#2 = enPerAgicont;
       FSalida = 0;
       |HAZ ConsultaEmpresa;
   |FINSI;

   SwAbiertos = 0;
   #dscaz024#14 = #48#0;
   #dscaz024#15 = #48#1;
   |PINPA #0#dscaz024;
   |PINDA #0#dscaz024;

   |SI aParam = "";
       |ENDATOS #1#dscaz024;
   |SINO;
        FSalida = 0;
   |FINSI;
   |SI FSalida = 0;
       nDeci_Div = 6;
       nDeci_Base = 6;
       |GRABA 020#dscaz024.a;
       |HAZ ElProceso;
   |FINSI;

   |SI SwAbiertos = 1;
       |HAZ DesCargaDef;
   |FINSI;

   |CIERRA #dscaz024;
   |SI aDef99 ! ""; |DESCARGA_DEF #cacambi@; |FINSI;
|FPRO;
