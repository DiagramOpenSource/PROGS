|FICHEROS;
   dscaz072 #0;
   dscaw052 #1,MANTE;
   dscaw053 #2;

   dscam076 #3;
   dscam077 #4;
   dscam078 #5;
   dscam091 #6;
   dscaw174 #7,MANTE;

   dscam003 #10;
   agif134@ #11;
   agif133@ #14;
   dscam044 #12;
   dscam045 #13;
   dscam058 #15;
   agif091@ #16;
   dscam023 #17,MANTE;
   agif024@ #18;
   dscam018 #19;
   agif084@ #20;
   dscam020 #200,MANTE;
|FIN;

|VARIABLES;
   &enContLin = 0; &enCab = 0; &enLin = 0;
   &nDeci_Base = 0; &HayGestion = 0;

   &Divisa = "";

   nSwHay = 0;
   aMarca = "";
   nLimFec = 0;
   HayVtos = 0;
   fFecha  = @;
   aSerie  = ""; nFactura = 0;

   aDirFic = "";
   aDirDef = "";
   aAlfa   = "";

   nSwMarca = 0;
   nEmpre   = 0;
   nNumLin  = 0;
   nCont    = 0;
   nCalc    = 0;
   nCalc1   = 0;
   nCalc2   = 0;
   nLinea   = 0;
|FIN;

|PROCESO SinExpe;
     |SI #0#20 = "S";
          FSalida = 0;
     |SINO;
          #200#0 = #0#0;
          #200#4 = #10#32;
          |LEE 000#200=;       ||clave2
     |FINSI;
|FPRC;

|PROCESO infw53;
   #dscaw053#0 = #dscaw052#0;
   #dscaw053#1 = #dscaw052#1;
   #dscaw053#2 = 001;
|FPRC;

|PROCESO supw53;
   #dscaw053#0 = #dscaw052#0;
   #dscaw053#1 = #dscaw052#1;
   #dscaw053#2 = 999;
|FPRC;

|PROCESO MiraComp;
   |SI PARAMETRO = "";
      |ABRE #dscam018;
      #dscam018#0 = #dscaz072#0;
      |LEE 000#dscam018.=;
      |SI FSalida = 0;
         |PINTA 0833, #dscam018#1;
      |FINSI;
      |CIERRA #dscam018;
   |FINSI;
|FPRC;

|PROCESO MiraMarca; |TIPO 11;
   |SI FSalida = 10;
      |SI #dscaw052#8 = " ";
         #dscaw052#8 = "*";
         nSwMarca = nSwMarca + 1;
      |SINO;
         #dscaw052#8 = " ";
         nSwMarca = nSwMarca - 1;
         |SI nSwMarca < 0; nSwMarca = 0; |FINSI;
      |FINSI;
      |GRABA 020#dscaw052.a;
      |ERROR; |PTEC 808;
      |PONCONTROL 23, "si";
   |FINSI;
   |SI FSalida = 11;
      Divisa = #dscaw052#13; |HAZ CargaNDeci;
      |PUSHV 0501 2380;
      |ENTLINEAL #1#dscaw053,-3,4,17,1,infw53,supw53;
      |POPV;
      |ERROR; |PTEC 808;
      |PONCONTROL 23, "si";
   |FINSI;
|FPRC;

|PROCESO MiraCodigo;
   |SI #dscaz072#14 = "G";
      #dscaz072#7  = ""; #dscaz072#12 = "zzzzzzzzzzzz";
      |C_M #dscaz072#7,1,"N"; |C_M #dscaz072#12,1,"N";
      |C_V #dscaz072#7,1,"N"; |C_V #dscaz072#12,1,"N";
      |C_M #dscaz072#6,1,"S"; |C_M #dscaz072#11,1,"S";
      |C_V #dscaz072#6,1,"S"; |C_V #dscaz072#11,1,"S";
      |PINTA #dscaz072#6; |PINTA #dscaz072#11;
   |SINO;
      #dscaz072#6  = ""; #dscaz072#11 = "zzzzzz";
      |C_M #dscaz072#6,1,"N"; |C_M #dscaz072#11,1,"N";
      |C_V #dscaz072#6,1,"N"; |C_V #dscaz072#11,1,"N";
      |C_M #dscaz072#7,1,"S"; |C_M #dscaz072#12,1,"S";
      |C_V #dscaz072#7,1,"S"; |C_V #dscaz072#12,1,"S";
      |PINTA #dscaz072#7; |PINTA #dscaz072#12;
   |FINSI;
|FPRC;

|PROCESO MiraCodigow174;
   |SI #dscaw174#14 = "G";
      #dscaw174#7  = ""; #dscaw174#12 = "zzzzzzzzzzzz";
      |C_M #dscaw174#7,1,"N"; |C_M #dscaw174#12,1,"N";
      |C_V #dscaw174#7,1,"N"; |C_V #dscaw174#12,1,"N";
      |C_M #dscaw174#6,1,"S"; |C_M #dscaw174#11,1,"S";
      |C_V #dscaw174#6,1,"S"; |C_V #dscaw174#11,1,"S";
      |PINTA #dscaw174#6; |PINTA #dscaw174#11;
   |SINO;
      #dscaw174#6  = ""; #dscaw174#11 = "zzzzzz";
      |C_M #dscaw174#6,1,"N"; |C_M #dscaw174#11,1,"N";
      |C_V #dscaw174#6,1,"N"; |C_V #dscaw174#11,1,"N";
      |C_M #dscaw174#7,1,"S"; |C_M #dscaw174#12,1,"S";
      |C_V #dscaw174#7,1,"S"; |C_V #dscaw174#12,1,"S";
      |PINTA #dscaw174#7; |PINTA #dscaw174#12;
   |FINSI;
|FPRC;

|PROCESO MiraPeriodo;
   |SI #dscaz072#1 = 01; #dscaz072#2 = "ENERO     "; |FINSI;
   |SI #dscaz072#1 = 02; #dscaz072#2 = "FEBRERO   "; |FINSI;
   |SI #dscaz072#1 = 03; #dscaz072#2 = "MARZO     "; |FINSI;
   |SI #dscaz072#1 = 04; #dscaz072#2 = "ABRIL     "; |FINSI;
   |SI #dscaz072#1 = 05; #dscaz072#2 = "MAYO      "; |FINSI;
   |SI #dscaz072#1 = 06; #dscaz072#2 = "JUNIO     "; |FINSI;
   |SI #dscaz072#1 = 07; #dscaz072#2 = "JULIO     "; |FINSI;
   |SI #dscaz072#1 = 08; #dscaz072#2 = "AGOSTO    "; |FINSI;
   |SI #dscaz072#1 = 09; #dscaz072#2 = "SEPTIEMBRE"; |FINSI;
   |SI #dscaz072#1 = 10; #dscaz072#2 = "OCTUBRE   "; |FINSI;
   |SI #dscaz072#1 = 11; #dscaz072#2 = "NOVIEMBRE "; |FINSI;
   |SI #dscaz072#1 = 12; #dscaz072#2 = "DICIEMBRE "; |FINSI;
   |PINTA #dscaz072#2;
|FPRC;

|PROCESO Limites;
   nLimFec = 1;
   |SI #dscam091#3 [ #dscam003#4; |Y #dscam091#4 ] #dscam003#4;
      nLimFec = 2; |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE Limites;
#dscam091#1;
;
#dscam023#0, #dscam023#2, 01;
#dscam023#0, #dscam023#2, 99;
;
NULL,Limites;
|FIN;

|PROCESO Vtos;
   |SI #dscam003#4 ! fFecha; |ACABA; |FINSI;

   nLimFec = 0;
   |BUCLE Limites;
   |SI nLimFec = 1; |ACABA; |FINSI;

   |HAZ SinExpe;
   |SI FSalida ! 0; |ACABA; |FINSI;

   HayVtos = 1;

   #dscam058#0 = #dscam003#12;
   |LEE 000#dscam058.=;
   |SI FSalida ! 0; |DDEFECTO #dscam058; |FINSI;

   Divisa = #dscam003#57; |HAZ TomaDecim;

   |DDEFECTO #dscaw053;
   #dscaw053#0 = #dscam003#0;
   #dscaw053#1 = #dscam003#1;
   #dscaw053#2 = #dscam003#2;
   #dscaw053#3 = #dscam003#3;
   #dscaw053#4 = #dscaw053#3 - #dscaw052#5;
   #dscaw053#5 = #dscam003#12;
   #dscaw053#6 = #dscam058#1;
   #dscaw053#7 = #dscam003#60;
   #dscaw053#8 = #dscaw052#5;
   #dscaw053#9 = #dscam003#40;
   |GRABA 020#dscaw053.n;
|FPRC;

|DEFBUCLE Vtos;
#dscam003#6;
89;
00, aSerie, nFactura, 001, " ", 000000001, "N";
00, aSerie, nFactura, 999, " ", 999999999, "N";
;
NULL,Vtos;
|FIN;

|PROCESO TmpVentas;
   #agif024@#0 = #agif134@#2;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   |SI #agif024@#205 < #dscaz072#18; |O #agif024@#205 > #dscaz072#19; |ACABA; |FINSI;

   #dscaw052#0 = #agif134@#49;
   #dscaw052#1 = #agif134@#0;
   |LEE 000#dscaw052.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   Divisa = #agif134@#58; |HAZ CargaNDeci;

   #agif091@#0 = #agif134@#11;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif134@#2;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam023#2 ! #dscaz072#0; |ACABA; |FINSI;
   |SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw052;
   #dscaw052#0 = #agif134@#49;
   #dscaw052#1 = #agif134@#0;
   #dscaw052#2 = #agif134@#2;
   #dscaw052#3 = #agif134@#3;
   #dscaw052#4 = 0;
   #dscaw052#5 = #agif134@#1;
   #dscaw052#7 = #agif134@#101;
   #dscaw052#8 = aMarca;

   #dscaw052#9  = #dscam023#19;
   #dscaw052#10 = #dscam023#20;

   #dscaw052#11 = #agif134@#11;
   #dscaw052#12 = #agif091@#1;
   #dscaw052#13 = #agif134@#58;

   #dscaw052#14 = #agif024@#6;
   #dscaw052#15 = #agif024@#178;
   #dscaw052#16 = #agif024@#179;
   #dscaw052#17 = #agif024@#7;

   aSerie = #agif134@#49; nFactura = #agif134@#0; fFecha = #agif134@#1;
   HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |GRABA 020#dscaw052.n;
      |SI aMarca = "*"; nSwMarca = nSwMarca + 1; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE TmpVentas;
#agif134@#1002;
1,2,12;
#0#4, #0#5,  #0#8,  #0#6,  #0#7;
#0#9, #0#10, #0#13, #0#11, #0#12;
;
NULL,TmpVentas;
|FIN;

|PROCESO TmpDirectas;
   #agif024@#0 = #agif084@#3;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   |SI #agif024@#205 < #dscaz072#18; |O #agif024@#205 > #dscaz072#19; |ACABA; |FINSI;

   #dscaw052#0 = #agif134@#49;
   #dscaw052#1 = #agif134@#0;
   |LEE 000#dscaw052.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   Divisa = #agif084@#65; |HAZ CargaNDeci;

   #agif091@#0 = #agif084@#8;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif084@#3;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam023#2 ! #dscaz072#0; |ACABA; |FINSI;
   |SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw052;
   #dscaw052#0 = #agif084@#48;
   #dscaw052#1 = #agif084@#0;
   #dscaw052#2 = #agif084@#3;
   #dscaw052#3 = #agif084@#4;
   #dscaw052#4 = 0;
   #dscaw052#5 = #agif084@#1;
   #dscaw052#7 = #agif084@#73;
   #dscaw052#8 = aMarca;

   #dscaw052#9  = #dscam023#20;
   #dscaw052#10 = #dscam023#19;

   #dscaw052#11 = #agif084@#8;
   #dscaw052#12 = #agif091@#1;
   #dscaw052#13 = #agif084@#65;

   #dscaw052#14 = #agif024@#6;
   #dscaw052#15 = #agif024@#178;
   #dscaw052#16 = #agif024@#179;
   #dscaw052#17 = #agif024@#7;

   aSerie = #agif084@#48; nFactura = #agif084@#0; fFecha = #agif084@#1;

   HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |GRABA 020#dscaw052.n;
      |SI aMarca = "*"; nSwMarca = nSwMarca + 1; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE TmpDirectas;
#agif084@#1002;
1,3,40;
#0#4, #0#5,  #0#8,  #0#6,  #0#7;
#0#9, #0#10, #0#13, #0#11, #0#12;
;
NULL,TmpDirectas;
|FIN;

|PROCESO Empresas;
   nSwHay = 1;
   #dscam044#0 = #dscam045#0;
   |LEE 000#dscam044.=;

   aDirFic = #dscam044#1; |QBF aDirFic;
   aDirDef = aDirFic + "def/";
   aDirFic = aDirFic + "fich/" + (("00000" + #dscam045#0) % -105) + "/";

   aAlfa = aDirDef + "agifa134.mas";
   |CARGA_DEF aAlfa, agif134@;
   |SI FSalida = 0;
      aAlfa = aDirDef + "agifa133.mas"; |CARGA_DEF aAlfa, agif133@;
      aAlfa = aDirDef + "agifa091.mas"; |CARGA_DEF aAlfa, agif091@;
      aAlfa = aDirDef + "agifa024.mas"; |CARGA_DEF aAlfa, agif024@;
      aAlfa = aDirDef + "agifa084.mas"; |CARGA_DEF aAlfa, agif084@;
      |PATH_DAT #11 aDirFic; |ABRE #agif134@;
      |PATH_DAT #14 aDirFic; |ABRE #agif133@;
      |PATH_DAT #16 aDirFic; |ABRE #agif091@;
      |PATH_DAT #18 aDirFic; |ABRE #agif024@;
      |PATH_DAT #20 aDirFic; |ABRE #agif084@;
      |BUCLE TmpVentas;
      |BUCLE TmpDirectas;
      |CIERRA #agif084@; |DESCARGA_DEF #agif084@;
      |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
      |CIERRA #agif091@; |DESCARGA_DEF #agif091@;
      |CIERRA #agif133@; |DESCARGA_DEF #agif133@;
      |CIERRA #agif134@; |DESCARGA_DEF #agif134@;
   |FINSI;
|FPRC;

|DEFBUCLE Empresas;
#dscam045#2;
2;
nEmpre,"V";
nEmpre,"V";
;
NULL,Empresas;
|FIN;

|RUTINA infw52;
   #dscaw052#0 = "     ";
   #dscaw052#1 = 000000;
   #dscaw052#2 = 000;
|FRUT;

|RUTINA supw52;
   #dscaw052#0 = "zzzzz";
   #dscaw052#1 = 999999;
   #dscaw052#2 = 999;
|FRUT;

|PROCESO ImprimeVtos;
   |SI enCab = 0;
      enContLin = enContLin + 1;
   |SINO;
      enContLin = enContLin + 4;
   |FINSI;
   |SI enContLin ] nNumLin; |HAZ PieInfor; |FINSI;
   enLin = 2; |PRINT;
   |SI enCab ! 0; enCab = 0; |FINSI;
|FPRC;

|DEFBUCLE ImprimeVtos;
#dscaw053#1;
;
#dscaw052#0,#dscaw052#1,001;
#dscaw052#0,#dscaw052#1,999;
;
NULL,ImprimeVtos;
|FIN;

|PROCESO Imprime;
   |SI enCab = 0;
      enContLin = enContLin + 1;
   |SINO;
      enContLin = enContLin + 3;
   |FINSI;
   nCalc = enContLin;

   #dscaw053#0 = #dscaw052#0;
   #dscaw053#1 = #dscaw052#1;
   |LEE 000#dscaw053.];
   |SI FSalida = 0; |Y #dscaw053#0 = #dscaw052#0; |Y #dscaw053#1 = #dscaw052#1;
      nCalc = nCalc + 5;
   |FINSI;

   |SI nCalc ] nNumLin; |HAZ PieInfor; |FINSI;
   enLin = 1; |PRINT;
   enCab = 2; |BUCLE ImprimeVtos;
   enLin = 3; |PRINT; enContLin = enContLin + 1;
   |SI enContLin ] nNumLin; |HAZ PieInfor; |FINSI;
   |SI enCab ! 0; enCab = 0; |FINSI;
   enLin = 1;
|FPRC;

|DEFBUCLE Imprime;
#dscaw052#1;
;
INICIO;
FINAL;
;
NULL,Imprime;
|FIN;

|PROCESO PieInfor;
   |PARA nCont = enContLin; |SI nCont < nNumLin; |HACIENDO nCont = nCont + 1;
      enLin = 3; |PRINT;
   |SIGUE;
   |PIEINF;
   enCab = enLin; enLin = 0; |PRINT; enCab = 0;
   enContLin = 7;
|FPRC;

|PROCESO PasaVtos;
   #dscam076#4 = #dscam076#4 + #dscaw053#7;
   #dscam077#6 = #dscam077#6 + #dscaw053#7;

   |DDEFECTO #dscam078;
   #dscam078#0  = #dscam077#0;
   #dscam078#1  = #dscam077#1;
   #dscam078#2  = #dscam077#2;
   #dscam078#3  = #dscam077#3;
   #dscam078#4  = nLinea; nLinea = nLinea + 1;
   #dscam078#5  = #dscaw053#0;
   #dscam078#6  = #dscaw053#1;
   #dscam078#7  = #dscaw053#2;
   #dscam078#8  = #dscaw053#8;
   #dscam078#9  = #dscaw053#3;
   #dscam078#10 = #dscaw053#7;
   #dscam078#13 = #dscam078#9 - #dscam078#8;
   #dscam078#14 = #dscaw053#9;
   |GRABA 020#dscam078.c;

   #dscam003#40 = #dscam078#14;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      #dscam003#89 = "S";
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE PasaVtos;
#dscaw053#1;
;
#dscaw052#0, #dscaw052#1, 000;
#dscaw052#0, #dscaw052#1, 999;
;
NULL,PasaVtos;
|FIN;

|PROCESO PasaAImp;
   #dscam077#0 = #dscam076#0;
   #dscam077#1 = #dscam076#1;
   #dscam077#2 = #dscam076#2;
   #dscam077#3 = #dscaw052#2;
   |LEE 101#dscam077.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam077;
      #dscam077#0  = #dscam076#0;
      #dscam077#1  = #dscam076#1;
      #dscam077#2  = #dscam076#2;
      #dscam077#3  = #dscaw052#2;
      #dscam077#4  = #dscaw052#3;
      #dscam077#5  = #dscaz072#15;
      #dscam077#7  = #dscaz072#16;
      #dscam077#9  = #dscaz072#17;
      #dscam077#11 = #dscaw052#14;
      #dscam077#12 = #dscaw052#15;
      #dscam077#13 = #dscaw052#16;
      #dscam077#14 = #dscaw052#17;
      |SI #dscaz072#15 ! 0; #dscam077#15 = #dscaz072#15; |FINSI;
      |SI #dscaz072#16 ! 0; #dscam077#15 = #dscaz072#16; |FINSI;
      |SI #dscaz072#17 ! 0; #dscam077#15 = #dscaz072#17; |FINSI;
      |GRABA 020#dscam077.b;
   |FINSI;

   nLinea = 1;
   #dscam078#0  = #dscam077#0;
   #dscam078#1  = #dscam077#1;
   #dscam078#2  = #dscam077#2;
   #dscam078#3  = #dscam077#3;
   #dscam078#4  = 0;
   |LEE 000#dscam078.];
   |PARA; |SI FSalida = 0; |Y #dscam078#0  = #dscam077#0; |Y #dscam078#1  = #dscam077#1;
    |Y #dscam078#2  = #dscam077#2; |Y #dscam078#3  = #dscam077#3; |HACIENDO;
      nLinea = #dscam078#4 + 1;
      |LEE 000#dscam078.s;
   |SIGUE;

   |BUCLE PasaVtos;
   |GRABA 020#dscam077.a; |LIBERA #dscam077;
|FPRC;

|DEFBUCLE PasaAImp;
#dscaw052#1;
8;
"     ",000000, "*";
"zzzzz",999999, "*";
;
NULL,PasaAImp;
|FIN;

|PROCESO BorraRecs;
   #dscam003#40 = #dscam078#14;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      #dscam003#89 = "N";
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
   |BORRA 020#dscam078.a;
|FPRC;

|DEFBUCLE BorraRecs;
#dscam078#1;
;
#dscam077#0 , #dscam077#1 , #dscam077#2 , #dscam077#3 , 000;
#dscam077#0 , #dscam077#1 , #dscam077#2 , #dscam077#3 , 999;
;
NULL,BorraRecs;
|FIN;

|PROCESO BorraLin;
   |BUCLE BorraRecs; |BORRA 020#dscam077.a;
|FPRC;

|DEFBUCLE BorraLin;
#dscam077#1;
;
#dscam076#0, #dscam076#1, #dscam076#2, "      ";
#dscam076#0, #dscam076#1, #dscam076#2, "zzzzzz";
be;
NULL,BorraLin;
|FIN;

|PROCESO Comprueba;
   |ABRE #dscam003; |ABRE #dscam076;
   |ABRE #dscam077; |ABRE #dscam078;
   #dscam076#0 = #dscaz072#0;
   #dscam076#1 = #dscaz072#1;
   #dscam076#2 = #dscaz072#3;
   |LEE 101#dscam076.=;
   |SI FSalida = 0;
      |CONFI "    NSe borraran los datos existentes del mto.de importes Continuar ?";
      |SI FSalida = 0;
         |BUCLE BorraLin; |BORRA 020#dscam076.a;
      |SINO;
         |ERROR;
      |FINSI;
      |LIBERA #dscam076;
   |FINSI;
   |CIERRA #dscam003; |CIERRA #dscam076;
   |CIERRA #dscam077; |CIERRA #dscam078;
|FPRC;

|PROGRAMA;
   |CLS;
   |CABEZA " Adjudicacion recibos Credito y Caucion ";

   |SI PARAMETRO ! "";
      |PINPA #0#dscaw174; |PINDA #0#dscaw174;
      ||BLANCO 0501 1180; ||BLANCO 2001 2380;
      ||ATRI S; |PINTA 0606, " INFORME ADJUDICACION "; |ATRI N;
      |ENDATOS #1#dscaw174;
      |SI FSalida = 0;
         #dscaz072#4  = #dscaw174#4;  #dscaz072#5  = #dscaw174#5;
         #dscaz072#6  = #dscaw174#6;  #dscaz072#7  = #dscaw174#7;
         #dscaz072#8  = #dscaw174#8;  #dscaz072#9  = #dscaw174#9;
         #dscaz072#10 = #dscaw174#10; #dscaz072#11 = #dscaw174#11;
         #dscaz072#12 = #dscaw174#12; #dscaz072#13 = #dscaw174#13;
         #dscaz072#14 = #dscaw174#14; #dscaz072#18 = #dscaw174#18;
         #dscaz072#19 = #dscaw174#19;
         FSalida = 0;
      |FINSI;
   |SINO;
      |PINPA #0#0; |PINDA #0#0; |HAZ MiraComp;
      |ENDATOS #1#0;
   |FINSI;

   |SI FSalida = 0;
      |SI PARAMETRO = "";
         |CONFI "    NMarcar todos los registros ?";
         |SI FSalida = 0;
            aMarca = "*";
         |SINO;
            aMarca = " ";
         |FINSI;
      |SINO;
         aMarca = " ";
      |FINSI;
      |HAZ Tipo8;
      aAlfa = "tc" + Usuario; |NOME_DAT #1 aAlfa;
      aAlfa = "tl" + Usuario; |NOME_DAT #2 aAlfa;
      |DELINDEX #dscaw052; |ABRE #dscaw052;
      |DELINDEX #dscaw053; |ABRE #dscaw053;
      |DFICB aAlfa; |QBF aAlfa;
      |PATH_DAT #12 aAlfa; |PATH_DAT #13 aAlfa;
      |ABRE #dscam044; |ABRE #dscam003; |ABRE #dscam058; |ABRE #dscam023;
      |ABRE #200; |SELECT #2#200;

      nSwHay = 0; nSwMarca = 0;
      nEmpre = #48#0;
      |BUCLE Empresas;
      |SI nSwHay = 0; |Y nSwMarca > 0; nSwMarca = 0; |FINSI;

      |CIERRA #200;
      |CIERRA #dscam023; |CIERRA #dscaw052; |CIERRA #dscaw053;
      |CIERRA #dscam058; |CIERRA #dscam003; |CIERRA #dscam044;
      |SI PARAMETRO ! "";
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
         |CIMPR 11; nNumLin = FSalida;
         |INFOR "dscaz072";
         |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
         enContLin = 4; enCab = 1; |BUCLE Imprime;
         |PIEINF; |FININF;
         |FINIMP;
         |HAZ Tipo9;
         |ACABA;
      |FINSI;
      |ENTLINEAL #1#dscaw052,-2,1,17,1,infw52,supw52;
      |SI nSwMarca ! 0;
         |CONFI "    NActualizar mantenimiento importes ?";
         |SI FSalida = 0;
            |ABRE #dscam076; |ABRE #dscam077; |ABRE #dscam078;
            #dscam076#0 = #dscaz072#0;
            #dscam076#1 = #dscaz072#1;
            #dscam076#2 = #dscaz072#3;
            |LEE 101#dscam076.=;
            |SI FSalida = 0;
               |CONFI "    NSe borraran los datos existentes del mto.de importes Continuar ?";
               |SI FSalida = 0;
                  |BUCLE BorraLin;
                  #dscam076#4  = 0; #dscam076#6  = 0;
                  #dscam076#8  = 0; #dscam076#10 = 0;
                  #dscam076#3 = #dscaz072#15; #dscam076#5 = #dscaz072#16;
                  #dscam076#7 = #dscaz072#17;
                  |SI #dscaz072#15 ! 0; #dscam076#9 = #dscaz072#15; |FINSI;
                  |SI #dscaz072#16 ! 0; #dscam076#9 = #dscaz072#16; |FINSI;
                  |SI #dscaz072#17 ! 0; #dscam076#9 = #dscaz072#17; |FINSI;
                  |ABRE #dscam003;
                  |BUCLE PasaAImp;
                  |GRABA 020#dscam076.a; |LIBERA #dscam076;
                  |CIERRA #dscam003;
               |FINSI;
            |SINO;
               |DDEFECTO #dscam076;
               #dscam076#0 = #dscaz072#0;
               #dscam076#1 = #dscaz072#1;
               #dscam076#2 = #dscaz072#3;
               #dscam076#3 = #dscaz072#15;
               #dscam076#5 = #dscaz072#16;
               #dscam076#7 = #dscaz072#17;
               |SI #dscaz072#15 ! 0; #dscam076#9 = #dscaz072#15; |FINSI;
               |SI #dscaz072#16 ! 0; #dscam076#9 = #dscaz072#16; |FINSI;
               |SI #dscaz072#17 ! 0; #dscam076#9 = #dscaz072#17; |FINSI;
               |GRABA 020#dscam076.b;
               |ABRE #dscam003;
               |BUCLE PasaAImp;
               |GRABA 020#dscam076.a; |LIBERA #dscam076;
               |CIERRA #dscam003;
            |FINSI;
            |CIERRA #dscam076; |CIERRA #dscam077; |CIERRA #dscam078;
         |FINSI;
      |FINSI;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".dat"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ddx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ixx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".dat"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ixx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ddx"; |FBORRA aAlfa;

      |HAZ Tipo9;
   |FINSI;
|FPRO;
