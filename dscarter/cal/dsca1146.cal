               PROCESO BorraCartera
|FICHEROS;
     dscaz146 #0;

     dscam003 #10;
     dscam004 #11;
     dscam008 #12;
     dscam009 #13;
     dscam067 #14;
     dscam013 #15;
     dscam050 #16;
     dscam047 #17;
     dscam022 #18;
|FIN;

|VARIABLES;
     aD = "";
     aH = "";
     aTipo = "";
     aAlfarec = "";

     swSi      = 0;
     aParam    = "";
     aNume1    = "";
     aNume2    = "";

     nCont     = 0;
     aSerie    = "";
     aAlfa     = "";
     aAlfa1    = "";
     &aCPath    = "";
     &aCNome    = "";
     aConta     = "agicont";

     nEmpresa = 0;
     nPeriodo = 0;
|FIN;

|PROCESO dscam067;
     |BORRA 020#dscam067.a;
|FPRC;

|DEFBUCLE dscam067;
     #dscam067#1;
     ;
     aTipo, aNume1, aNume2, aD, 000000, 00000, 0;
     aTipo, aNume1, aNume2, aH, 999999, 99999, 9;
     be;
     NULL, dscam067;
|FIN;

|PROCESO Remesas;
     aTipo = "RM";
     aNume1 = #dscam013#0; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam013#1; |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam013.a;
|FPRC;

|DEFBUCLE Remesas;
     #dscam013#3;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Remesas;
|FIN;

|PROCESO Pagares;
     aTipo = "PA";
     aNume1 = #dscam022#0; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam022#1; |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam022.a;
|FPRC;

|DEFBUCLE Pagares;
     #dscam022#3005;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Pagares;
|FIN;

|PROCESO Talones;
     aTipo = "TA";
     aNume1 = #dscam047#0; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam047#1; |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam047.a;
|FPRC;

|DEFBUCLE Talones;
     #dscam047#3;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Talones;
|FIN;

|PROCESO Confirmes;
     aTipo = "CF";
     aNume1 = #dscam050#0; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam050#1; |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam050.a;
|FPRC;

|DEFBUCLE Confirmes;
     #dscam050#3;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, Confirmes;
|FIN;

|PROCESO HistorPagos;
     aTipo = "PG";
     aNume1 = #dscam009#14; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam009#3;  |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam009.a;
|FPRC;

|DEFBUCLE HistorPagos;
     #dscam009#1;
     ;
     #dscam008#40, 001;
     #dscam008#40, 999;
     be;
     NULL,HistorPagos;
|FIN;

|PROCESO RecibosCompra;
     |BUCLE HistorPagos;
     |BORRA 020#dscam008.a;
|FPRC;

|DEFBUCLE RecibosCompra;
     #dscam008#2;
     ;
     00, aSerie, 000000, 000;
     99, aSerie, 999999, 999;
     ;
     NULL,RecibosCompra;
|FIN;

|PROCESO HistorCobros;
     aTipo = "CB";
     aNume1 = #dscam004#17; |QBF aNume1; aNume1 = (aNume1 + (" " * 50)) % 0150;
     aNume2 = #dscam004#3;  |QBF aNume2; aNume2 = (aNume2 + (" " * 50)) % 0150;
     |BUCLE dscam067;

     |BORRA 020#dscam004.a;
|FPRC;

|DEFBUCLE HistorCobros;
     #dscam004#1;
     ;
     #dscam003#40, 001;
     #dscam003#40, 999;
     be;
     NULL,HistorCobros;
|FIN;

|PROCESO RecibosVenta;
     |BUCLE HistorCobros;
     |BORRA 020#dscam003.a;
|FPRC;

|DEFBUCLE RecibosVenta;
     #dscam003#9;
     ;
     00, aSerie, 000000, 000, 000000001;
     99, aSerie, 999999, 999, 999999999;
     be;
     NULL, RecibosVenta;
|FIN;

|PROCESO Cartera;
  aD = " " * 50; aH = "z" * 50;

  |BUCLE RecibosVenta;
  |BUCLE Remesas;
  |BUCLE RecibosCompra;
  |BUCLE Pagares;
  |BUCLE Talones;
  |BUCLE Confirmes;
  |BUCLE Cobradores;

|FPRC;
