|FICHEROS;
   dscaz040 #0;

   dscam067 #5;
   dscam030 #6;
   dscam031 #7;

   dscam004 #10;       || Historico de cobros
   dscam009 #11;       || Historico de pagos
   dscam013 #12;       || Lineas de remesas
   dscam022 #13;       || Lineas de pagares
   dscam047 #14;       || Lineas de talones
   dscam050 #15;       || Lineas de confirmes
|FIN;

|VARIABLES;
   Diario    = 0;
   Documento = 0;
   Linea     = 0;
   Empresa   = 0;
   Periodo   = 0;
   Calc      = 0;

   Fecha     = "";
   Enlace    = "";
   Clave1    = "";
   Clave2    = "";
   Clave3    = "";
|FIN;

|PROCESO LineasAsiento;
   Calc = #dscam031#2 - 1;

   |DDEFECTO #dscam067;
   #dscam067#0  = #dscam030#2;
   #dscam067#1  = Clave1;
   #dscam067#2  = Clave2;
   #dscam067#3  = Clave3;
   #dscam067#4  = Diario;
   #dscam067#5  = Fecha;
   #dscam067#6  = Documento + Calc;
   #dscam067#7  = Linea;
   #dscam067#8  = Empresa;
   #dscam067#9  = Periodo;
   #dscam067#10 = Enlace;
   #dscam067#11 = #dscam031#2;
   |GRABA 020#dscam067.n;
|FPRC;

|DEFBUCLE LineasAsiento;
#dscam031#1;
;
#dscam030#0,000001;
#dscam030#0,999999;
;
NULL,LineasAsiento;
|FIN;

|PROCESO Cobros;
   Diario = #dscam004#34; Fecha   = #dscam004#35; Documento = #dscam004#36;
   Linea  = #dscam004#37; Empresa = #dscam004#38; Periodo   = #dscam004#39;
   Enlace = #dscam004#20; Clave1  = #dscam004#17; Clave2    = #dscam004#3;
   Clave3 = "";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Cobros;
#dscam004#1;
;
INICIO;
FINAL;
;
NULL,Cobros;
|FIN;

|PROCESO Pagos;
   Diario = #dscam009#27; Fecha   = #dscam009#28; Documento = #dscam009#29;
   Linea  = #dscam009#30; Empresa = #dscam009#31; Periodo   = #dscam009#32;
   Enlace = #dscam009#18; Clave1  = #dscam009#14; Clave2    = #dscam009#3;
   Clave3 = "";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Pagos;
#dscam009#1;
;
INICIO;
FINAL;
;
NULL,Pagos;
|FIN;

|PROCESO Remesas;
   Diario = #dscam013#24; Fecha   = #dscam013#25; Documento = #dscam013#26;
   Linea  = #dscam013#27; Empresa = #dscam013#28; Periodo   = #dscam013#29;
   Enlace = #dscam013#19; Clave1  = #dscam013#0;  Clave2    = #dscam013#1;
   Clave3 = "E";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;

   Diario = #dscam013#31; Fecha   = #dscam013#32; Documento = #dscam013#33;
   Linea  = #dscam013#34; Empresa = #dscam013#35; Periodo   = #dscam013#36;
   Enlace = #dscam013#30; Clave1  = #dscam013#0;  Clave2    = #dscam013#1;
   Clave3 = "V";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Remesas;
#dscam013#1;
;
INICIO;
FINAL;
;
NULL,Remesas;
|FIN;

|PROCESO Pagares;
   Diario = #dscam022#24; Fecha   = #dscam022#25; Documento = #dscam022#26;
   Linea  = #dscam022#27; Empresa = #dscam022#28; Periodo   = #dscam022#29;
   Enlace = #dscam022#16; Clave1  = #dscam022#0;  Clave2    = #dscam022#1;
   Clave3 = "E";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;

   Diario = #dscam022#30; Fecha   = #dscam022#31; Documento = #dscam022#32;
   Linea  = #dscam022#33; Empresa = #dscam022#34; Periodo   = #dscam022#35;
   Enlace = #dscam022#36; Clave1  = #dscam022#0;  Clave2    = #dscam022#1;
   Clave3 = "V";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Pagares;
#dscam022#1;
;
INICIO;
FINAL;
;
NULL,Pagares;
|FIN;

|PROCESO Talones;
   Diario = #dscam047#19; Fecha   = #dscam047#20; Documento = #dscam047#21;
   Linea  = #dscam047#22; Empresa = #dscam047#23; Periodo   = #dscam047#24;
   Enlace = #dscam047#16; Clave1  = #dscam047#0;  Clave2    = #dscam047#1;
   Clave3 = "";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Talones;
#dscam022#1;
;
INICIO;
FINAL;
;
NULL,Talones;
|FIN;

|PROCESO Confirmes;
   Diario = #dscam050#21; Fecha   = #dscam050#22; Documento = #dscam050#23;
   Linea  = #dscam050#24; Empresa = #dscam050#25; Periodo   = #dscam050#26;
   Enlace = #dscam050#18; Clave1  = #dscam050#0;  Clave2    = #dscam050#1;
   Clave3 = "E";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;

   Diario = #dscam050#27; Fecha   = #dscam050#28; Documento = #dscam050#29;
   Linea  = #dscam050#30; Empresa = #dscam050#31; Periodo   = #dscam050#32;
   Enlace = #dscam050#33; Clave1  = #dscam050#0;  Clave2    = #dscam050#1;
   Clave3 = "V";

   |SI Documento = 0; |ACABA; |FINSI;
   #dscam030#0 = Enlace; |LEE 000#dscam030.=; |BUCLE LineasAsiento;
|FPRC;

|DEFBUCLE Confirmes;
#dscam050#1;
;
INICIO;
FINAL;
;
NULL,Confirmes;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA "Recalculo historico enlaces";

   |PINPA #0#0; |PINDA #0#0;
   |ENDATOS #1#0;
   |SI FSalida = 0; |Y #0#0 = "S";
      |DELINDEX #dscam067;
      |ABRE #dscam030; |ABRE #dscam067;

      |BUCLE Cobros;
      |BUCLE Pagos;
      |BUCLE Remesas;
      |BUCLE Pagares;
      |BUCLE Talones;
      |BUCLE Confirmes;

      |CIERRA #dscam067; |CIERRA #dscam030;
   |FINSI;
|FPRO;
