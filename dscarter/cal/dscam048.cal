|FICHEROS;
   dscam048 #0;
   dscam040 #1;
|FIN;

|VARIABLES;
   ModoEntrada = 0;
   &HayGestion = 0; &HayConta = 0; &MaxDigit = 0;
   &TipoProveedor = ""; &CodProveedor = "";
   &DCampoC = 0; &HCampoC = 0;

   Parte1 = ""; Parte2 = ""; nLong = 0; aLong = ""; Calc = 0;

   Comodin = ""; Comodin1 = "";
     aNifQbf1   = "";
     aNifQbf2   = "";
     aAlfa      = "";

     &eaVarDni  = "";
     &enCalcCif = 0;
|FIN;

|PROCESO Prefijo;
   ModoEntrada = (FEntrada / 100) ! 0;

   |SI ModoEntrada = 1;
      Comodin = #dscam040#2; |QBF Comodin;
      Comodin1 = Comodin + #dscam048#7; |QBF Comodin1;
      #dscam048#7 = Comodin; |PINTA #dscam048#7;
      Comodin1 = Comodin + #dscam048#8; |QBF Comodin1;
      #dscam048#8 = Comodin; |PINTA #dscam048#8;
   |FINSI;

|FPRC;

|PROCESO FinalTelef; |TIPO 7;
   ModoEntrada = FEntrada $ 100;
   |SI ModoEntrada = 1;
      |PTEC 816;
   |FINSI;
|FPRC;

|PROCESO CalculaDNI;
     |SI FSalida = 10;
          eaVarDni  = #0Campo;
          |HAZ CalculoDNI;
          #0Campo = eaVarDni;
          |PINTA #0Campo;
          |ERROR; |ACABA;
     |FINSI;

     eaVarDni  = #0Campo;
     |HAZ CalculoDNI;

     aNifQbf1 = #0Campo;   |QBF aNifQbf1;
     aNifQbf2 = eaVarDni;  |QBF aNifQbf2;

     |SI aNifQbf1 ! aNifQbf2; |Y aNifQbf1 ! "";
          aAlfa = "0000NEl NIF puede ser erróneo."+&13+"¿Desea calcularlo?";
          |CONFI aAlfa;
          |SI FSalida = 0;
               #0Campo = eaVarDni; |PINTA #0Campo;
          |FINSI;
     |FINSI;
|FPRC;

|PROCESO MontaCuenta1;
   |SI HayConta = 1;
      |SI FSalida = 10;
         TipoProveedor = "C"; DCampoC = 14; HCampoC = 14
         |HAZ ExisteProveedor;
         #dscam048#Campo# = CodProveedor; |PINTA #dscam048#Campo#;
      |FINSI;

      Comodin = #dscam048#14; |QBF Comodin;
      Comodin = Comodin - ".";
      |SI FSalida ! 0;
         aLong = Comodin % 0; nLong = aLong;
         Calc = ((FSalida / 100) ! 0) + 99;
         Parte1 = Comodin % Calc;
         Parte2 = Comodin - Parte1;
         Calc = MaxDigit - nLong;
         Comodin = "0" * Calc;
         #dscam048#14 = Parte1 + Comodin + Parte2;
         |PINTA #dscam048#14;
      |FINSI;
   |FINSI;
|FPRC;
