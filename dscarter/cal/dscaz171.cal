|FICHEROS;
     dscaz171 #0;
     dscam008 #1;
     dscam058 #4;

     dscaw139 #10;
     dscam051 #11;
|FIN;

|VARIABLES;
     informe = "";
     inform1 = "dscaz171";
     sw = 0;
     &enfor = 0;
     &ult_cta = "";
     &total = 0;
     &total1 = 0;
     &total2 = 0;
     &sw_inf = 0;
     &empres = "";
     &cp = "";
     &ult_dia = @;
     &ult_mes = "";
     &mes = "";
     &impor = 0;
     alfa1 = "";
     novale = 0;
     Parte1 = "";
     Parte2 = "";
     Posic1 = 0;
     Posic2 = 0;
     Comodin = "";
     Long = "";
     LongNum = 0;
     FEstado = 0;
     &MaxDigit = 0;
     &nDeci_Div = 0;
     &nDeci_Base = 0;
     &EURO_DB = 0;
     &EURO_DV = 0;

     &efFechaVto = @;

     &eaDescr = "";

     aAlfa = "";
|FIN;

|PROCESO mayor;
   alfa1 = #0Campo > " ";
   #0Campo = alfa1;
   |PINTA #0Campo;
|FPRC;

|PROCESO el_mes;
   |SI ult_mes = "01";      mes = "ENERO";       |FINSI;
   |SI ult_mes = "02";      mes = "FEBRERO";     |FINSI;
   |SI ult_mes = "03";      mes = "MARZO";       |FINSI;
   |SI ult_mes = "04";      mes = "ABRIL";       |FINSI;
   |SI ult_mes = "05";      mes = "MAYO";        |FINSI;
   |SI ult_mes = "06";      mes = "JUNIO";       |FINSI;
   |SI ult_mes = "07";      mes = "JULIO";       |FINSI;
   |SI ult_mes = "08";      mes = "AGOSTO";      |FINSI;
   |SI ult_mes = "09";      mes = "SEPTIEMBRE";  |FINSI;
   |SI ult_mes = "10";      mes = "OCTUBRE";     |FINSI;
   |SI ult_mes = "11";      mes = "NOVIEMBRE";   |FINSI;
   |SI ult_mes = "12";      mes = "DICIEMBRE";   |FINSI;
|FPRC;

|PROCESO imprim;
   |PRINT;
|FPRC;

|DEFBUCLE Imprime;
#dscaw139#1;
;
INICIO;
FINAL;
;
NULL, imprim;
|FIN;

|PROCESO Grabaw139;
     |SI #0#12 = "N";
        |SI #dscam008#14 = "P"; |O #dscam008#14 = "C"; |O #dscam008#14 = "E";
           impor = #dscam008#31;
        |SINO;
           |ACABA;
        |FINSI;
     |FINSI;
     |SI #0#12 = "S";
        |SI #dscam008#14 ! "P"; |Y #dscam008#14 ! "C"; |Y #dscam008#14 ! "E";
           impor = #dscam008#23;
        |SINO;
           |ACABA;
        |FINSI;
     |FINSI;
     |SI #0#12 = "T"; impor = #dscam008#25; |FINSI;

     #dscaw139#0 = #dscam008#32;
     #dscaw139#1 = #dscam008#5;
     |LEE 101#dscaw139.=;
     |SI FSalida ! 0;
        |DDEFECTO #dscaw139;
        #dscaw139#0 = #dscam008#32;
        #dscaw139#1 = #dscam008#5;
        #dscaw139#2 = #dscam008#6;
        |GRABA 020#dscaw139.b;
     |FINSI;

     |SI #dscam008#73 ! "01.01.0000";
        |SI #dscam008#73 [ #dscaz171#15;
           #dscaw139#3 = #dscaw139#3 + impor;
        |SINO;
           |SI #dscam008#73 [ #dscaz171#16;
              #dscaw139#4 = #dscaw139#4 + impor;
           |SINO;
              |SI #dscam008#73 [ #dscaz171#17;
                 #dscaw139#5 = #dscaw139#5 + impor;
              |SINO;
                 |SI #dscam008#73 [ #dscaz171#18;
                    #dscaw139#6 = #dscaw139#6 + impor;
                 |SINO;
                    #dscaw139#7 = #dscaw139#7 + impor;
                 |FINSI;
              |FINSI;
           |FINSI;
        |FINSI;
     |SINO;
        |SI #dscam008#3 [ #dscaz171#15;
           #dscaw139#3 = #dscaw139#3 + impor;
        |SINO;
           |SI #dscam008#3 [ #dscaz171#16;
              #dscaw139#4 = #dscaw139#4 + impor;
           |SINO;
              |SI #dscam008#3 [ #dscaz171#17;
                 #dscaw139#5 = #dscaw139#5 + impor;
              |SINO;
                 |SI #dscam008#3 [ #dscaz171#18;
                    #dscaw139#6 = #dscaw139#6 + impor;
                 |SINO;
                    #dscaw139#7 = #dscaw139#7 + impor;
                 |FINSI;
              |FINSI;
           |FINSI;
        |FINSI;
     |FINSI;

     |GRABA 020#dscaw139.a; |LIBERA #dscaw139;
|FPRC;

|DEFBUCLE lee_cobro;
   #1#2;
   5, 16;
   #0#0, #0#6, #0#2, 000, #0#4, #0#13;
   #0#1, #0#7, #0#3, 999, #0#5, #0#14;
   e;
   NULL, Grabaw139;
|FIN;

|PROCESO inicia;
   |GRABA 020#dscaz171.a;

   EURO_DB = nDeci_Base;
   EURO_DV = nDeci_Div;

   |IMPRE 0;
   |SI FSalida ! 0;  |ACABA;  |FINSI;
   |INFOR "dscaz171";
   |SI FSalida ! 0;  |FINIMP;  |ACABA;  |FINSI;
   empres = #48#1;
   |ABRE #4;

   |ABRE #dscam051;
   |LEE 000#dscam051.p;
   |SI FSalida ! 0; |DDEFECTO #dscam051; |FINSI;
   |CIERRA #dscam051;

   aAlfa = "tm" + Usuario; |NOME_DAT #dscaw139#aAlfa#;
   |DELINDEX #dscaw139; |ABRE #dscaw139;

   |BUCLE lee_cobro;
   |ABRE #dscam008; |BUCLE Imprime; |CIERRA #dscam008;

   |CIERRA #4;
   |CIERRA #dscaw139; |DELINDEX #dscaw139;

   |PIEINF; |FININF;
   |FINIMP;
|FPRC;

|PROCESO Cuenta; |TIPO 6;
   Comodin = #dscaz171#Campo#;
   Comodin = Comodin - ".";
   |SI FSalida ! 0;
      FEstado = FSalida;
      Posic1 = (FEstado / 100) ! 0;
      Posic1 = Posic1 + 99;
      Posic2 = FEstado + 98;
      Parte1 = Comodin % Posic1;
      Parte2 = Comodin % Posic2;
      |QBF Comodin;
      Long = Comodin % 0;
      LongNum = MaxDigit - Long;
      Comodin = "0" * LongNum;
      Comodin = Parte1 + Comodin + Parte2;
      #dscaz171#Campo# = Comodin;
      |PINTA #dscaz171#Campo#;
   |FINSI;
|FPRC;                                                                              |PINTA #capredcb#Campo#;

|PROGRAMA;
   |HAZ Tipo8;

   |CLS;
   |CABEZA "Informe pagos por proveedor resumido";

   |ABRE #dscaz171;
   |LEE 000#dscaz171.p;
   |SI FSalida ! 0;
      |DDEFECTO #dscaz171;
      |GRABA 020#dscaz171.c;
   |FINSI;

   |PINPA #0#0; |PINDA #0#0;

   |ENDATOS #1#0;
   |SI FSalida = 0;
      |GRABA 020#dscaz171.a;

      |HAZ inicia;
   |FINSI;

   |CIERRA #dscaz171;

   |HAZ Tipo9;
|FPRO;
