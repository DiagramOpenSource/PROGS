|FICHEROS;
   dscaz063 #0;

   RefPatr@ #100;
   RefFich@ #101;
|FIN;

|VARIABLES;

{-1}menu  = "";
    menu1 = "2400";
    menu2 = "1";
    menu3 = "Tiene recalculos pendientes. Proceder : ";
    menu4 = "AM";
    menu5 = " Ahora ";
    menu6 = " Mas tarde ";

   nSw     = 0;
   nNumRec = 0;
   nCalc   = 0;
   nCalc1  = 0;
   nOpcion = 0;
   nLong1  = 0;
   nLong2  = 0;
   nCont   = 0;
   nTecla  = 0;
   nSalir  = 0;
   SwAlta  = 0;

   aFich  = "";
   aClaveBuena = "8576";
   aClave = "";
   aPath  = "";
   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aChar  = "";
|FIN;

|RUTINA inf;
   #dscaz063#0 = 1;
|FRUT;

|RUTINA sup;
   #dscaz063#0 = 9999999;
|FRUT;

|PROCESO MiraSiRec;
   |SI nSw = 1; nNumRec = nNumRec + 1; |FINSI;
   |SI nSw = 2;
      aAlfa =         #dscaz063#5; |QBF aAlfa;
      aAlfa = aAlfa + #dscaz063#6; |QBF aAlfa;
      |HAZ Ejecuta;
      #dscaz063#3 = "R"; #dscaz063#4 = ~;
      |GRABA 020#dscaz063.a;
   |FINSI;
|FPRC;

|DEFBUCLE MiraSiRec;
#dscaz063#2;
;
0000001,"P";
9999999,"P";
be;
NULL,MiraSiRec;
|FIN;

|PROCESO Actualiza;
   |DBASE aAlfa1; |QBF aAlfa1; aAlfa = aAlfa1;
   aAlfa1 = aAlfa1 + "def/"+ aFich + ".mas";

   aAlfa = aAlfa + "fich/";
   |SI aFich = "dscaz063"; |O aFich = "dscam065";
      aAlfa = aAlfa + (("00000" + #48#0) % -105) + "/"; |PATH_DAT #0 aAlfa;
   |FINSI;
   aPath = aAlfa;
   |LEEDEDEF aAlfa1,aAlfa;
   aAlfa2 = FSalida % 1815; nLong1 = aAlfa2;
   |DBASE aAlfa; |QBF aAlfa;
   aAlfa = aAlfa + "fich/patrones/";
   |LEEDEDEF aAlfa1,aAlfa;
   aAlfa2 = FSalida % 1815; nLong2 = aAlfa2;

   |SI nLong1 = nLong2; |ACABA; |FINSI;

   |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/" + aFich + ".mas";
   |CARGA_DEF aAlfa, RefPatr@;
   |SI FSalida = 0;
      |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "def/" + aFich + ".mas";
      |CARGA_DEF aAlfa, RefFich@;
      |DBASE aAlfa; |QBF aAlfa; aAlfa = aAlfa + "fich/patrones/"; |PATH_DAT #RefPatr@#aAlfa#;
      |DFICB aAlfa; |QBF aAlfa;
      aAlfa = aAlfa + (("00000" + #48#0) % -105) + "/"; |PATH_DAT #RefFich@#aAlfa#;
      |ABRE #RefFich@; |ABRE #RefPatr@;
      |LEE 000#RefPatr@.p;
      |SI FSalida = 0;
         |PARA; |SI FSalida = 0; |HACIENDO;
            |DDEFECTO #RefFich@;
            aAlfa = "|K000"; aAlfa = #RefPatr@#aAlfa#;
            aAlfa1 = aAlfa % 0103; nCalc1 = aAlfa1; aAlfa = aAlfa % 0499;
            |PARA nCont = 1; |SI nCont [ nCalc1; |HACIENDO nCont = nCont + 1;
               aAlfa1 = aAlfa % 0103; nCalc = aAlfa1; aAlfa = aAlfa % 0499;
               #RefFich@#nCalc# = #RefPatr@#nCalc#;
            |SIGUE;
            |LEE 000#RefFich@.=;
            |SI FSalida ! 0;
               |DDEFECTO #RefFich@;
               aAlfa = "|NC"; nCalc1 = #RefFich@#aAlfa#; nCalc1 = nCalc1 - 1;
               |PARA nCont = 0; |SI nCont [ nCalc1; |HACIENDO nCont = nCont + 1;
                  #RefFich@#nCont# = #RefPatr@#nCont#;
               |SIGUE;
               |GRABA 020#RefFich@.n;
            |FINSI;
            |LEE 000#RefPatr@.s;
         |SIGUE;
      |FINSI;
      |CIERRA #RefFich@; |DESCARGA_DEF #RefFich@;
      |CIERRA #RefPatr@; |DESCARGA_DEF #RefPatr@;
   |FINSI;
|FPRC;

|PROCESO Ejecuta;
   aAlfa1 = aAlfa; aAlfa2 = "";
   |PARA; |SI aAlfa1 ! ""; |HACIENDO;
      aChar = aAlfa1 % 0101;
      |SI aChar = "|";
         aAlfa1 = aAlfa1 % 0299;
         aChar = aAlfa1 % 0101;
         aAlfa1 = aAlfa1 % 0299;
         |SI aChar = "|";
            |QBF aAlfa2; aAlfa2 = aAlfa2 + ";" + aPath;
            |SUB_EJECUTA_NP aAlfa2; aAlfa2 = "";
         |FINSI;
      |SINO;
         aAlfa2 = aAlfa2 + aChar;
         aAlfa1 = aAlfa1 % 0299;
      |FINSI;
   |SIGUE;
   |SI aAlfa2 ! "";
      |QBF aAlfa2; aAlfa2 = aAlfa2 + ";" + aPath;
      |SUB_EJECUTA_NP aAlfa2; aAlfa2 = "";
   |FINSI;
|FPRC;

|PROCESO Tipo11; |TIPO 11;
   nTecla = FSalida;
   |SI nTecla ] 13; |Y nTecla [ 20;
      nTecla = nTecla + 40;
      aClave = aClave + &nTecla;
      |SI aClave = aClaveBuena;
         SwAlta = 1; |PTEC 807; |ACABA;
      |SINO;
         |ERROR; |ACABA;
      |FINSI;
   |SINO;
      |SI aClave ! aClaveBuena; aClave = ""; |FINSI;
   |FINSI;
|FPRC;

|PROGRAMA;

   aFich = "dscam065"; |HAZ Actualiza;
   aFich = "dscam063"; |HAZ Actualiza;
   aFich = "dscam064"; |HAZ Actualiza;
   aFich = "dscaz063"; |HAZ Actualiza;

   |SI PARAMETRO = "";
      |CLS;
      |CABEZA "Control chequeo versiones";
      |PINPA #0#0; |PINDA #0#0;
      |PARA; |SI nSalir = 0; |HACIENDO;
         |SI SwAlta = 0;
            |BLANCO 2008 2371;
            |C_M #dscaz063#5,1,"N"; |C_M #dscaz063#6,1,"N";
            |C_V #dscaz063#5,1,"N"; |C_V #dscaz063#6,1,"N";
            |PINTA 2008, "ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ";
            |ENTLINEAL #1#dscaz063,-1,4,16,1,inf,sup;
            |SI aClave ! aClaveBuena; nSalir = 1; |FINSI;
         |SINO;
            |PINPA #0#0; |PINDA #0#0;
            |PINTA 2008, "ฬ"; |PINTA 2071, "น";
            |PINTA 2108, "บ"; |PINTA 2171, "บ";
            |PINTA 2208, "บ"; |PINTA 2271, "บ";
            |ATRI R; |PINTA 2009, " Ordenes de ejecucion                                        "; |ATRI N;
            |C_M #dscaz063#5,1,"S"; |C_M #dscaz063#6,1,"S";
            |C_V #dscaz063#5,1,"S"; |C_V #dscaz063#6,1,"S";
            |PINTA 2308, "ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ";
            |ENTLINEAL #1#dscaz063,-1,1,16,1,inf,sup;
            nSalir = 1;
         |FINSI;
      |SIGUE;
   |SINO;
      nNumRec = 0;
      nSw = 1; |BUCLE MiraSiRec;     || Comprueba si hay recalculos pdtes
      |SI nNumRec > 0;
         nOpcion = 0;
         |PARA; |SI nOpcion < 1; |O nOpcion > 2; |HACIENDO;
            |MENU menu;
            nOpcion = FSalida;
         |SIGUE;
         |SI nOpcion = 1;
            aAlfa = "";
            nSw = 2; |BUCLE MiraSiRec;
         |FINSI;
         |SI nOpcion = 2; |ACABA; |FINSI;
      |FINSI;
   |FINSI;
|FPRO;
