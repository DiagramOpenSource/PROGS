|FICHEROS;
   dscaw102 #0;

   Referen@ #100;
|FIN;

|VARIABLES;
   &MaxDigit = 0;
   &TipoProveedor = ""; &CodProveedor = ""; &Nombre = "";
   &DCampoG = 0;      &HCampoG = 0;
   &DCampoC = 0;      &HCampoC = 0;

   aAlfa  = "";
   aAlfa1 = "";
   aAlfa2 = "";
   aAlfa3 = "";

   nCalc  = 0;
   nCalc1 = 0;
   nTecla = 0;
|FIN;

|PROCESO Selec;
   |BLANCO 1238 1251;
   |SI #dscaw102#0 = "G";
      #dscaw102#2 = ""; |C_M #dscaw102#2, 1, "N"; |C_V #dscaw102#2, 1, "N";
      |C_M #dscaw102#1, 1, "S"; |C_V #dscaw102#1, 1, "S";
   |SINO;
      #dscaw102#1 = ""; |C_M #dscaw102#1, 1, "N"; |C_V #dscaw102#1, 1, "N";
      |C_M #dscaw102#2, 1, "S"; |C_V #dscaw102#2, 1, "S";
   |FINSI;
|FPRC;

|PROCESO MiraCodProv;
   nTecla = FSalida;
   |SI #dscaw102#0 = "C"; |ACABA; |FINSI;
   |SI nTecla = 2; |ACABA; |FINSI;

   CodProveedor = #dscaw102#1;
   TipoProveedor = "G"; DCampoG = 1; HCampoG = 1; FSalida = nTecla;
   |HAZ ExisteProveedor;
   |SI TipoProveedor ! "ERROR";
      #dscaw102#1 = CodProveedor; |PINTA #dscaw102#1;
      #dscaw102#3 = Nombre;       |PINTA #dscaw102#3;
   |SINO;
      |ERROR;
   |FINSI;
   |SI nTecla = 10; |ERROR; |FINSI;
|FPRC;

|PROCESO MiraCtaProv;
   nTecla = FSalida;
   |SI #dscaw102#0 = "G"; |ACABA; |FINSI;
   |SI nTecla = 2; |ACABA; |FINSI;

   aAlfa = #dscaw102#2; |QBF aAlfa;
   aAlfa = aAlfa - ".";
   |PARA; |SI FSalida ! 0; |HACIENDO;
      nCalc = ((FSalida / 100) ! 0) + 99; aAlfa1 = aAlfa % nCalc;
      nCalc = FSalida + 98;               aAlfa2 = aAlfa % nCalc;
      aAlfa3 = aAlfa1 % 0; nCalc1 = aAlfa3;
      aAlfa3 = aAlfa2 % 0; nCalc  = aAlfa3;
      nCalc = nCalc + nCalc1; nCalc = MaxDigit - nCalc;
      |SI nCalc < 0; nCalc = 0; |FINSI;
      aAlfa = aAlfa1 + ("0" * nCalc) + aAlfa2;
      aAlfa = aAlfa - ".";
   |SIGUE;
   #dscaw102#2 = aAlfa; |PINTA #dscaw102#2;

   CodProveedor = #dscaw102#2;
   TipoProveedor = "C"; DCampoC = 2; HCampoC = 2; FSalida = nTecla;
   |HAZ ExisteProveedor;
   |SI TipoProveedor ! "ERROR";
      #dscaw102#2 = CodProveedor; |PINTA #dscaw102#2;
      #dscaw102#3 = Nombre;       |PINTA #dscaw102#3;
   |SINO;
      |ERROR;
   |FINSI;
   |SI nTecla = 10; |ERROR; |FINSI;
|FPRC;
