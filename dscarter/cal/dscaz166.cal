|FICHEROS;
   dscaz166 #0;

   dscam003 #10;
   dscam004 #11;

   agif010@ #100;
   agif104@ #101;
   agif324@ #102;
|FIN;

|VARIABLES;
   &nDeci_Div  = 0;
   &nDeci_Base = 0;

   aAlfa   = "";

   nCambio = 0;
|FIN;

|PROCESO Entregas;
   |SI #dscaz166#0 ! " ";
      aAlfa = #48#17; |QBF aAlfa;
      aAlfa = aAlfa + "fich/" + (("00000" + #dscam003#46)% -105) + "/";
      |PATH_DAT #agif010@#aAlfa#; |ABRE #agif010@;
      |PATH_DAT #agif104@#aAlfa#; |ABRE #agif104@;
      |PATH_DAT #agif324@#aAlfa#; |ABRE #agif324@;

      |SI #dscaz166#0 = "A";
         #agif010@#52 = #dscam003#0;
         #agif010@#0  = #dscam003#1;
         |LEE 000#agif010@.=;
         |SI FSalida = 0;
            #agif324@#0 = #agif010@#68;
            |LEE 000#agif324@.=;
            |SI FSalida ! 0; |DDEFECTO #agif324@; |FINSI;
            nDeci_Div = #agif324@#7; nDeci_Base = 2;

            nCambio = #agif010@#69 / #agif010@#74;
            #dscam003#57 = #agif010@#68;
            #dscam003#58 = #agif324@#1;
            #dscam003#59 = nCambio;
         |FINSI;
      |FINSI;
      |SI #dscaz166#0 = "P";
         #agif104@#25 = #dscam003#0;
         #agif104@#0  = #dscam003#1;
         |LEE 000#agif104@.=;
         |SI FSalida = 0;
            #agif324@#0 = #agif104@#35;
            |LEE 000#agif324@.=;
            |SI FSalida ! 0; |DDEFECTO #agif324@; |FINSI;
            nDeci_Div = #agif324@#7; nDeci_Base = 2;

            nCambio = #agif104@#36 / #agif104@#41;
            #dscam003#57 = #agif104@#35;
            #dscam003#58 = #agif324@#1;
            #dscam003#59 = nCambio;
         |FINSI;
      |FINSI;

      #dscam003#22 = #dscam003#60 * #dscam003#59;
      |SI #dscam003#65 ! 0; #dscam003#31 = #dscam003#65 * #dscam003#59; |FINSI;
      |SI #dscam003#61 ! 0; #dscam003#23 = #dscam003#61 * #dscam003#59; |FINSI;
      #dscam003#30 = #dscam003#64 * #dscam003#59;
      |GRABA 020#dscam003.a;

      #dscam004#17 = #dscam003#40;
      #dscam004#3  = 1;
      |LEE 101#dscam004.];
      |PARA; |SI FSalida = 0; |Y #dscam004#17 = #dscam003#40; |HACIENDO;
         |SI #dscam004#5 = "RAC"; |Y #dscam004#33 = 0;
            #dscam004#33 = #dscam003#59;
            #dscam004#8  = #dscam004#26 * #dscam003#59;
            |GRABA 020#dscam004.a;
         |FINSI;
         |LIBERA #dscam004; |LEE 101#dscam004.s;
      |SIGUE;
      |LIBERA #dscam004;
      |CIERRA #agif324@; |CIERRA #agif104@; |CIERRA #agif010@;
   |FINSI;
|FPRC;

|DEFBUCLE Entregas;
#dscam003#6;
;
00, #dscaz166#1, #dscaz166#2, 000, #dscaz166#0, 0000000001;
99, #dscaz166#3, #dscaz166#4, 999, #dscaz166#0, 9999999999;
be;
NULL, Entregas;
|FIN;

|PROGRAMA;
   |CLS;

   |CABEZA "Proceso recalculo entregas a cuenta";
   |PINPA #0#dscaz166; |PINDA #0#dscaz166;
   |ENDATOS #1#dscaz166;
   |SI FSalida = 0;
      aAlfa = #48#17; |QBF aAlfa; aAlfa = aAlfa + "def/agifa010.mas";
      |CARGA_DEF aAlfa, agif010@;
      |SI FSalida = 0;
         aAlfa = #48#17; |QBF aAlfa; aAlfa = aAlfa + "def/agifa104.mas";
         |CARGA_DEF aAlfa, agif104@;

         aAlfa = #48#17; |QBF aAlfa; aAlfa = aAlfa + "def/agifa324.mas";
         |CARGA_DEF aAlfa, agif324@;
         |ABRE #dscam004;
         |BUCLE Entregas;
         |CIERRA #dscam004;
         |DESCARGA_DEF #agif324@; |DESCARGA_DEF #agif104@; |DESCARGA_DEF #agif010@;
      |FINSI;
   |FINSI;
|FPRO;
