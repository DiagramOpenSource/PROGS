|FICHEROS;
   dscaz186 #0;

   dscaw169 #10,MANTE;

   dscam003 #20;
   dscam004 #21;
   dscam067 #22;
   dscam030 #23;

   caenlac@ #100;
|FIN;

|VARIABLES;
   aAlfa  = "";
   aAlfa1 = "";
   aPathConta = "";
   aClave = "";

   nCalc1 = 0;
   nCalc2 = 0;

   &PRMNT_enError = 0;
|FIN;

|PROCESO Tipo11w169; |TIPO 11;
   |SI FSalida = 10;
      aAlfa = "    N" + &191 + " Esta seguro de eliminar el asiento de la recepcion de esta entrega a cuenta ?";
      |CONFI aAlfa;
      |SI FSalida = 0;
         aClave = "";
         |PUSHV 0501 2380;
         |PINTA 2328, "Entre clave : ";
         E_sup  = 10; E_inf  = "";
         aClave = 2342 ? -1;
         |SI FSalida = 0;
            |SI aClave ! "<MYPASWD> ";
               |MENAV "    Clave incorrecta";
               |POPV;
               |ACABA;
            |FINSI;

            |ABRE #dscam030;
            #dscam030#0 = #dscaw169#5;
            |LEE 000#dscam030.=;
            |SI FSalida = 0;
               aPathConta = #dscam030#6; |QBF aPathConta;

               aAlfa = aPathConta + "def/caenlace.mas";
               |CARGA_DEF aAlfa, caenlac@;
               |SI FSalida = 0;
                  aAlfa = "pu" + Usuario; |NOME_DAT #caenlac@#aAlfa#;
                  aAlfa = aPathConta + "fich/" + (("00000" + #dscaw169#9) % -105) + #dscaw169#10 + "/";
                  |PATH_DAT #caenlac@#aAlfa#;

                  |DELINDEX #caenlac@; |ABRE #caenlac@;
                  |DDEFECTO #caenlac@;
                  #caenlac@#0 = #dscaw169#6;
                  #caenlac@#1 = #dscaw169#7;
                  #caenlac@#2 = #dscaw169#8;
                  #caenlac@#3 = 1;
                  #caenlac@#25 = "S";
                  #caenlac@#37 = #dscaw169#9;
                  #caenlac@#38 = #dscaw169#10;
                  |GRABA 020#caenlac@.n;
                  |CIERRA #caenlac@;

                  PRMNT_enError = 0;
                  aAlfa1 = aAlfa - "agicont";
                  |SI FSalida = 0;
                     aAlfa = ":contagen/dsapunte.tab;" + aAlfa + ",pu" + Usuario;
                  |SINO;
                     aAlfa = ":agicont/dsapunte.tab;" + aAlfa + ",pu" + Usuario;
                  |FINSI;
                  |SUB_EJECUTA aAlfa;
                  |SI PRMNT_enError = 0;
                     #dscam067#0 = #dscaw169#11;
                     #dscam067#1 = #dscaw169#12;
                     #dscam067#2 = #dscaw169#13;
                     #dscam067#3 = #dscaw169#14;
                     #dscam067#11 = #dscaw169#15;
                     #dscam067#8 = #dscaw169#9;
                     #dscam067#9 = #dscaw169#10;
                     |LEE 101#dscam067.=;
                     |SI FSalida = 0;
                        |BORRA 020#dscam067.a; |LIBERA #dscam067;
                     |FINSI;

                     |BORRA 020#dscaw169.a;
                  |SINO;
                     |MENAV "    Proceso cancelado desde contabilidad. No se elimina el asiento.";
                  |FINSI;

                  |DELINDEX #caenlac@;
               |FINSI;
            |FINSI;
            |CIERRA #dscam030;
         |FINSI;
         |POPV;
      |FINSI;
      |PONCONTROL 23, "SI";
   |FINSI;
|FPRC;

|PROCESO RecogeEntregas;
   #dscam003#40 = #dscam004#17;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

   |SI #dscam003#14 ! "e"; |ACABA; |FINSI;

   |DDEFECTO #dscam067;
   #dscam067#0 = "CB";
   #dscam067#1 = #dscam004#17;
   #dscam067#2 = #dscam004#3;
   |LEE 000#dscam067.];
   |SI FSalida = 0;
      nCalc1 = #dscam067#1; nCalc2 = #dscam067#2;
      |SI #dscam067#0 = "CB"; |Y nCalc1 = #dscam004#17; |Y nCalc2 = #dscam004#3;
         |DDEFECTO #dscaw169;
         #dscaw169#0 = #dscam003#40;
         #dscaw169#1 = #dscam003#32;
         #dscaw169#2 = #dscam003#5;
         #dscaw169#3 = #dscam003#6;
         #dscaw169#4 = #dscam003#30;
         #dscaw169#5 = #dscam067#10;
         #dscaw169#6 = #dscam067#4;
         #dscaw169#7 = #dscam067#5;
         #dscaw169#8 = #dscam067#6;
         #dscaw169#9 = #dscam067#8;
         #dscaw169#10 = #dscam067#9;
         #dscaw169#11 = #dscam067#0;
         #dscaw169#12 = #dscam067#1;
         #dscaw169#13 = #dscam067#2;
         #dscaw169#14 = #dscam067#3;
         #dscaw169#15 = #dscam067#11;
         |GRABA 020#dscaw169.n;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE RecogeEntregas;
#dscam004#4;
;
"RAC", 000000001;
"RAC", 999999999;
;
NULL, RecogeEntregas;
|FIN;

|RUTINA inf;
   #dscaw169#0 = 1;
|FRUT;

|RUTINA sup;
   #dscaw169#0 = 999999999;
|FRUT;

|PROGRAMA;
   |CLS;
   |CABEZA " Anulacion contabilizacion recepcion entregas a cuenta";

   |PINPA #0#dscaz186;

   aAlfa = "69" + Usuario; |NOME_DAT #dscaw169#aAlfa#;
   |DELINDEX #dscaw169; |ABRE #dscaw169;

   |ABRE #dscam003;   |ABRE #dscam067;
   |BUCLE RecogeEntregas;
   |CIERRA #dscam003;

   |ENTLINEAL #1#dscaw169, -1, 4, 21, 1, inf, sup;

   |CIERRA #dscam067;
   |CIERRA #dscaw169; |DELINDEX #dscaw169;
|FPRO;
