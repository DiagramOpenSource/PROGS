|FICHEROS;
   dscaz196 #0;
   dscaw212 #1,MANTE;
   dscaw053 #2;
   dscaw217 #3;

   dscam076 #3;
   dscam077 #4;
   dscam078 #5;
   dscam091 #6;
   dscaw174 #7,MANTE;

   dscam213 #8;
   dscam214 #9;
   dscam215 #29,MANTE;

   dscam003 #10;
   agif134@ #11;
   agif133@ #14;
   dscam044 #12;
   dscam045 #13;
   dscam058 #15;
   agif091@ #16;
   dscam023 #17,MANTE;
   agif024@ #18;
   dscam018 #19;
   agif084@ #20;
|FIN;

|VARIABLES;
   &enContLin = 0; &enCab = 0; &enLin = 0;
   &nDeci_Base = 0; &HayGestion = 0;

   &Divisa = "";

   nTotalAcum = 0;

   nSwHay = 0;
   aMarca = "";
   nLimFec = 0;
   HayVtos = 0;
   fFecha  = @;
   fFecha1 = @;
   fVtoMayor = @;
   aSerie  = ""; nFactura = 0;

   aDirFic = "";
   aDirDef = "";
   aAlfa   = "";
   aAlfa1  = "";

   nSwMarca = 0;
   nEmpre   = 0;
   nNumLin  = 0;
   nCont    = 0;
   nCalc    = 0;
   nCalc1   = 0;
   nCalc2   = 0;
   nLinea   = 0;
   nLinTmp  = 0;

   nSwPdte  = 0;

   nSw0c0160 = 0;

   nLibro = 0;
   nLib = 0;
   aSer = "";
   nFac = 0;
   nDocDiv = 0;
   aEstado = "";
   nDiv    = 0;
   nAgrupa = 0;
|FIN;

|PROCESO infw53;
   #dscaw053#0 = #dscaw212#0;
   #dscaw053#1 = #dscaw212#1;
   #dscaw053#2 = 001;
|FPRC;

|PROCESO supw53;
   #dscaw053#0 = #dscaw212#0;
   #dscaw053#1 = #dscaw212#1;
   #dscaw053#2 = 999;
|FPRC;

|PROCESO MiraComp;
   |SI PARAMETRO = ""; |O nSw0c0160 = 1;
      |ABRE #dscam018;
      #dscam018#0 = #dscaz196#0;
      |LEE 000#dscam018.=;
      |SI FSalida = 0;
         |PINTA 0833, #dscam018#1;
      |FINSI;
      |CIERRA #dscam018;
   |FINSI;
|FPRC;

|PROCESO PintaTotal; |TIPO 13;
   #dscaw212#23 = nTotalAcum ! 2; |PINTA 2151, #dscaw212#23;
|FPRC;

|PROCESO MiraMarca; |TIPO 11;
   |SI FSalida = 10;
      |SI #dscaw212#8 = " ";
         #dscaw212#8 = "*";
         nSwMarca = nSwMarca + 1;
         nTotalAcum = nTotalAcum + #dscaw212#7;
      |SINO;
         #dscaw212#8 = " ";
         nSwMarca = nSwMarca - 1;
         nTotalAcum = nTotalAcum - #dscaw212#7;
         |SI nSwMarca < 0; nSwMarca = 0; |FINSI;
      |FINSI;
      |GRABA 020#dscaw212.a;

      #dscaw212#23 = nTotalAcum ! 2; |PINTA 2151, #dscaw212#23;

      |ERROR; |PTEC 809; |PTEC 808;
      |PONCONTROL 23, "si";
   |FINSI;
   |SI FSalida = 11;
      Divisa = #dscaw212#13; |HAZ CargaNDeci;
      |PUSHV 0501 2380;
      |ENTLINEAL #1#dscaw053,-3,4,17,1,infw53,supw53;
      |POPV;
      |ERROR; |PTEC 808;
      |PONCONTROL 23, "si";
   |FINSI;
|FPRC;

|PROCESO MiraCodigo;
   |SI #dscaz196#14 = "G";
      #dscaz196#7  = ""; #dscaz196#12 = "zzzzzzzzzzzz";
      |C_M #dscaz196#7,1,"N"; |C_M #dscaz196#12,1,"N";
      |C_V #dscaz196#7,1,"N"; |C_V #dscaz196#12,1,"N";
      |C_M #dscaz196#6,1,"S"; |C_M #dscaz196#11,1,"S";
      |C_V #dscaz196#6,1,"S"; |C_V #dscaz196#11,1,"S";
      |PINTA #dscaz196#6; |PINTA #dscaz196#11;
   |SINO;
      #dscaz196#6  = ""; #dscaz196#11 = "zzzzzz";
      |C_M #dscaz196#6,1,"N"; |C_M #dscaz196#11,1,"N";
      |C_V #dscaz196#6,1,"N"; |C_V #dscaz196#11,1,"N";
      |C_M #dscaz196#7,1,"S"; |C_M #dscaz196#12,1,"S";
      |C_V #dscaz196#7,1,"S"; |C_V #dscaz196#12,1,"S";
      |PINTA #dscaz196#7; |PINTA #dscaz196#12;
   |FINSI;
|FPRC;

|PROCESO MiraCodigow174;
   |SI #dscaw174#14 = "G";
      #dscaw174#7  = ""; #dscaw174#12 = "zzzzzzzzzzzz";
      |C_M #dscaw174#7,1,"N"; |C_M #dscaw174#12,1,"N";
      |C_V #dscaw174#7,1,"N"; |C_V #dscaw174#12,1,"N";
      |C_M #dscaw174#6,1,"S"; |C_M #dscaw174#11,1,"S";
      |C_V #dscaw174#6,1,"S"; |C_V #dscaw174#11,1,"S";
      |PINTA #dscaw174#6; |PINTA #dscaw174#11;
   |SINO;
      #dscaw174#6  = ""; #dscaw174#11 = "zzzzzz";
      |C_M #dscaw174#6,1,"N"; |C_M #dscaw174#11,1,"N";
      |C_V #dscaw174#6,1,"N"; |C_V #dscaw174#11,1,"N";
      |C_M #dscaw174#7,1,"S"; |C_M #dscaw174#12,1,"S";
      |C_V #dscaw174#7,1,"S"; |C_V #dscaw174#12,1,"S";
      |PINTA #dscaw174#7; |PINTA #dscaw174#12;
   |FINSI;
|FPRC;

|PROCESO PonFechas;
   aAlfa = "01." + (("00" + #dscaz196#1) % -102) + "." + #dscaz196#3;
   #dscaz196#8 = aAlfa; |PINTA #dscaz196#8;
   nCalc = #dscaz196#1; nCalc = nCalc + 1;
   aAlfa = "01." + (("00" + nCalc) % -102) + "." + #dscaz196#3;
   fFecha = aAlfa;
   nCalc = fFecha; nCalc = nCalc - 1; fFecha = nCalc;
   #dscaz196#13 = fFecha; |PINTA #dscaz196#13;
|FPRC;

|PROCESO MiraPeriodo;
   |SI #dscaz196#1 = 01; #dscaz196#2 = "ENERO     "; |FINSI;
   |SI #dscaz196#1 = 02; #dscaz196#2 = "FEBRERO   "; |FINSI;
   |SI #dscaz196#1 = 03; #dscaz196#2 = "MARZO     "; |FINSI;
   |SI #dscaz196#1 = 04; #dscaz196#2 = "ABRIL     "; |FINSI;
   |SI #dscaz196#1 = 05; #dscaz196#2 = "MAYO      "; |FINSI;
   |SI #dscaz196#1 = 06; #dscaz196#2 = "JUNIO     "; |FINSI;
   |SI #dscaz196#1 = 07; #dscaz196#2 = "JULIO     "; |FINSI;
   |SI #dscaz196#1 = 08; #dscaz196#2 = "AGOSTO    "; |FINSI;
   |SI #dscaz196#1 = 09; #dscaz196#2 = "SEPTIEMBRE"; |FINSI;
   |SI #dscaz196#1 = 10; #dscaz196#2 = "OCTUBRE   "; |FINSI;
   |SI #dscaz196#1 = 11; #dscaz196#2 = "NOVIEMBRE "; |FINSI;
   |SI #dscaz196#1 = 12; #dscaz196#2 = "DICIEMBRE "; |FINSI;
   |PINTA #dscaz196#2;

   |HAZ PonFechas;
|FPRC;

|PROCESO BuscaDivididos;
   |SI #dscam003#83 = nDiv;
      |SALVA_FICHA #dscam003;
      |HAZ MiraEstadoFra;
      |REPON_FICHA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE BuscaDivididos;
#dscam003#9;
;
nLib, aSer, 000000, 000, 000000001;
nLib, aSer, 000000, 000, 999999999;
;
NULL, BuscaDivididos;
|FIN;

|PROCESO MiraEstadoFra;
    |SI #dscam003#14 ! "A"; |Y #dscam003#14 ! "D";
         |SI #dscam003#14 = "N"; #dscam003#14 = "L"; |FINSI;
        |SI #dscam003#14 = "L"; |Y aEstado = "";           aEstado = "L";      |FINSI;
        |SI aEstado = "L"; |Y #dscam003#14 ! "L";          aEstado = "P";      |FINSI;
        |SI aEstado = "";  |Y #dscam003#14 ! "L";          aEstado = "P";      |FINSI;
    |FINSI;

    |SI #dscam003#14 = "A";
        nAgrupa = #dscam003#41;
        |SALVA_FICHA #dscam003;
        |SELECT #1#dscam003;
        #dscam003#40 = nAgrupa;
        |LEE 000#dscam003.=;
        |SI FSalida ! 0;
            #dscam003#0 = "zzzzz";
            #dscam003#1 = -1;
        |FINSI;
        |SELECT #9#dscam003;
        |LEE 000#dscam003.=;
        |SI FSalida = 0;
            |HAZ MiraEstadoFra;
        |FINSI;
        |REPON_FICHA #dscam003;
    |FINSI;

    |SI #dscam003#14 = "D";
        nDiv = #dscam003#40;
        nLib = #dscam003#27;
        aSer = #dscam003#0;
        nFac = #dscam003#1;
        |SALVA_FICHA #dscam003;
        |BUCLE BuscaDivididos;
        |REPON_FICHA #dscam003;
    |FINSI;
|FPRC;

|DEFBUCLE MiraEstadoFra;
#dscam003#9;
;
nLibro, aSerie, nFactura, 000, 000000001;
nLibro, aSerie, nFactura, 999, 999999999;
;
NULL, MiraEstadoFra;
|FIN;

|PROCESO Limites;
   nLimFec = 1;
   |SI #dscam091#3 [ #dscam003#4; |Y #dscam091#4 ] #dscam003#4;
      nLimFec = 2; |ERROR10;
   |FINSI;
|FPRC;

|DEFBUCLE Limites;
#dscam091#1;
;
#dscam023#0, #dscam023#2, 01;
#dscam023#0, #dscam023#2, 99;
;
NULL,Limites;
|FIN;

|PROCESO Vtos;
   |SI #dscam003#4 ! fFecha; |ACABA; |FINSI;

   nLimFec = 0;
   |BUCLE Limites;
   |SI nLimFec = 1; |ACABA; |FINSI;

   HayVtos = 1;

   #dscam058#0 = #dscam003#12;
   |LEE 000#dscam058.=;
   |SI FSalida ! 0; |DDEFECTO #dscam058; |FINSI;

   Divisa = #dscam003#57; |HAZ TomaDecim;

   |DDEFECTO #dscaw053;
   #dscaw053#0 = #dscam003#0;
   #dscaw053#1 = #dscam003#1;
   #dscaw053#2 = #dscam003#2;
   #dscaw053#3 = #dscam003#3;
   #dscaw053#4 = #dscaw053#3 - #dscaw212#5;
   #dscaw053#5 = #dscam003#12;
   #dscaw053#6 = #dscam058#1;
   #dscaw053#7 = #dscam003#60;
   #dscaw053#8 = #dscaw212#5;
   #dscaw053#9 = #dscam003#40;
   |GRABA 000#dscaw053.n;
   |SI FSalida ! 0;
      |SI FSalida = 100;
         aAlfa1 = #dscam003#4; |QBF aAlfa1; aAlfa1 = aAlfa1 % -104;
         aAlfa = "    ATENCION !!! Recibo " + #dscam003#0 + "/" + (("000000" + #dscam003#1) % -106) + "/"
         aAlfa = aAlfa + "/" + (("000" + #dscam003#2) % -103) + " duplicado en " + aAlfa1;
         |MENAV aAlfa;
      |SINO;
         aAlfa = "    ATENCION !!! Problemas en la creacion del temporal. Documento " + #dscam003#40 + " FSalida " + FSalida;
         |MENAV aAlfa;
      |FINSI;
   |FINSI;

   |SI #dscam003#14 ! "A"; |Y #dscam003#14 ! "D";
      |SI nSwPdte = 0;
         |SI #dscam003#14 ! "L"; nSwPdte = 1; |FINSI;
         |SI #dscam003#14 = "N"; nSwPdte = 0; |FINSI;
      |FINSI;
   |SINO;
      |SALVA_FICHA #dscam003;
      |SELECT #1#dscam003;
      nLibro = #dscam003#27;
      aEstado = ""; |BUCLE MiraEstadoFra;
      |SELECT #6#dscam003;
      |REPON_FICHA #dscam003;
      nSwPdte = 1;
      |SI aEstado = "L"; nSwPdte = 0; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE Vtos;
#dscam003#6;
89;
00, aSerie, nFactura, 001, " ", 000000001, "N";
00, aSerie, nFactura, 999, " ", 999999999, "N";
;
NULL,Vtos;
|FIN;

|PROCESO MiraDivididos;
   |SI #dscam003#83 = nDocDiv;
      |SI fVtoMayor < #dscam003#3; fVtoMayor = #dscam003#3; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE MiraDivididos;
#dscam003#9;
;
nLib, aSer, 000000, 000, 000000001;
nLib, aSer, 000000, 999, 999999999;
;
NULL, MiraDivididos;
|FIN;

|PROCESO TmpVentas;
   #agif024@#0 = #agif134@#2;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   |SI #agif024@#205 < #dscaz196#18; |O #agif024@#205 > #dscaz196#19; |ACABA; |FINSI;

   |SELECT #3#dscaw217;
   #dscaw217#1 = #agif134@#49;
   #dscaw217#2 = #agif134@#0;
   |LEE 000#dscaw217.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   |SI #agif134@#101 < 0; |ACABA; |FINSI;

   Divisa = #agif134@#58; |HAZ CargaNDeci;

   |SELECT #9#dscam003;
   fVtoMayor = #agif134@#1;
   #dscam003#0 = #agif134@#49;
   #dscam003#1 = #agif134@#0;
   #dscam003#2 = 1;
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#0 = #agif134@#49; |Y #dscam003#1 = #agif134@#0; |HACIENDO;
      |SI #dscam003#4 = #agif134@#1;
         |SI fVtoMayor < #dscam003#3; fVtoMayor = #dscam003#3; |FINSI;
         |SI #dscam003#14 = "D";
            nLib = #dscam003#27;
            aSer = #dscam003#0;
            nDocDiv = #dscam003#40;
            |BUCLE MiraDivididos;
         |FINSI;
      |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;
   |SELECT #1#dscam003;

   #agif091@#0 = #agif134@#11;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif134@#2;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   ||SI #dscam023#2 ! #dscaz196#0; |ACABA; |FINSI;
   ||SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw217;
   #dscaw217#0  = nLinTmp; nLinTmp = nLinTmp + 1;
   #dscaw217#1  = #agif134@#49;
   #dscaw217#2  = #agif134@#0;
   #dscaw217#3  = #agif134@#2;
   #dscaw217#4  = #agif134@#3;
   |SI #dscam003#14 = "F"; |O #dscam003#14 = "T";
      #dscaw217#5  = #dscam003#71;
   |SINO;
      #dscaw217#5  = fVtoMayor;
   |FINSI;
   #dscaw217#6  = #agif134@#101;
   #dscaw217#7  = #dscam023#19;
   #dscaw217#8  = #dscam023#20;
   #dscaw217#9  = #agif134@#11;
   #dscaw217#10 = #agif091@#1;
   #dscaw217#11 = #agif134@#58;
   #dscaw217#12 = #agif024@#6;
   #dscaw217#13 = #agif024@#178;
   #dscaw217#14 = #agif024@#179;
   #dscaw217#15 = #agif024@#7;
   aSerie = #agif134@#49; nFactura = #agif134@#0; fFecha = #agif134@#1;
   nSwPdte = 0; HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |SI nSwPdte = 0;
         #dscaw217#16 = "L"; #dscaw217#17 = "Liquidado";
      |SINO;
         #dscaw217#16 = "P"; #dscaw217#17 = "Pendiente";
      |FINSI;
      #dscaw217#18 = #dscam023#13;
      #dscaw217#19 = #agif134@#1;
/*
      aAlfa = #dscam023#5; |QBF aAlfa;
      |SI aAlfa = ""; |O #dscam023#13 = 0;
         #dscaw217#20 = "2";
      |SINO;
         #dscaw217#20 = "1";
      |FINSI;
*/
      #dscam215#0 = #dscaz196#0;
      #dscam215#4 = #dscaw217#3;
      |LEE 000#dscam215.=;
      |SI FSalida = 0;
         #dscaw217#20 = "1"; || Clasificado
      |SINO;
         #dscaw217#20 = "2"; || No clasificado
      |FINSI;

      |SI #dscam023#2 ! 0; |Y #dscam023#13 > 0;
         |SI #dscaw217#16 = "L"; #dscaw217#21 = "1"; |FINSI;
         |SI #dscaw217#16 ! "L"; #dscaw217#21 = "2"; |FINSI;
      |SINO;
         |SI #dscaw217#16 = "L"; #dscaw217#21 = "3"; |FINSI;
         |SI #dscaw217#16 ! "L"; #dscaw217#21 = "4"; |FINSI;
      |FINSI;

/*
      |SI #dscaw217#16 = "L"; |Y #dscam023#2 ! 0; #dscaw217#21 = "1"; |FINSI;
      |SI #dscaw217#16 = "L"; |Y #dscam023#2 = 0; #dscaw217#21 = "2"; |FINSI;
      |SI #dscaw217#16 = "P"; |Y #dscam023#2 ! 0; #dscaw217#21 = "3"; |FINSI;
      |SI #dscaw217#16 = "P"; |Y #dscam023#2 = 0; #dscaw217#21 = "4"; |FINSI;
*/
      |GRABA 020#dscaw217.n;
   |FINSI;

/*
   #dscaw212#0 = #agif134@#49;
   #dscaw212#1 = #agif134@#0;
   |LEE 000#dscaw212.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   Divisa = #agif134@#58; |HAZ CargaNDeci;

   |SELECT #9#dscam003;
   fVtoMayor = #agif134@#1;
   #dscam003#0 = #agif134@#49;
   #dscam003#1 = #agif134@#0;
   #dscam003#2 = 1;
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#0 = #agif134@#49; |Y #dscam003#1 = #agif134@#0; |HACIENDO;
      |SI #dscam003#4 = #agif134@#1;
         |SI fVtoMayor < #dscam003#3; fVtoMayor = #dscam003#3; |FINSI;
      |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;
   |SELECT #1#dscam003;

   #agif091@#0 = #agif134@#11;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif134@#2;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam023#2 ! #dscaz196#0; |ACABA; |FINSI;
   |SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw212;
   #dscaw212#0 = #agif134@#49;
   #dscaw212#1 = #agif134@#0;
   #dscaw212#2 = #agif134@#2;
   #dscaw212#3 = #agif134@#3;
   #dscaw212#4 = 0;
   ||#dscaw212#5 = #agif134@#1;
   #dscaw212#5 = fVtoMayor;
   #dscaw212#7 = #agif134@#101;
   #dscaw212#8 = aMarca;

   #dscaw212#9  = #dscam023#19;
   #dscaw212#10 = #dscam023#20;

   #dscaw212#11 = #agif134@#11;
   #dscaw212#12 = #agif091@#1;
   #dscaw212#13 = #agif134@#58;

   #dscaw212#14 = #agif024@#6;
   #dscaw212#15 = #agif024@#178;
   #dscaw212#16 = #agif024@#179;
   #dscaw212#17 = #agif024@#7;

   aSerie = #agif134@#49; nFactura = #agif134@#0; fFecha = #agif134@#1;
   nSwPdte = 0; HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |SI nSwPdte = 0;
         #dscaw212#18 = "L"; #dscaw212#19 = "Liquidado";
      |SINO;
         #dscaw212#18 = "P"; #dscaw212#19 = "Pendiente";
      |FINSI;
      #dscaw212#20 = #dscam023#13;
      #dscaw212#21 = #agif134@#1;
      |GRABA 020#dscaw212.n;
      |SI aMarca = "*"; nSwMarca = nSwMarca + 1; |FINSI;
   |FINSI;
*/
|FPRC;

|DEFBUCLE TmpVentas;
#agif134@#1002;
1,2,12;
#0#4, #0#5,  #0#8,  #0#6,  #0#7;
#0#9, #0#10, #0#13, #0#11, #0#12;
;
NULL,TmpVentas;
|FIN;

|PROCESO TmpDirectas;
   #agif024@#0 = #agif084@#3;
   |LEE 000#agif024@.=;
   |SI FSalida ! 0; |DDEFECTO #agif024@; |FINSI;

   |SI #agif024@#205 < #dscaz196#18; |O #agif024@#205 > #dscaz196#19; |ACABA; |FINSI;

   |SELECT #3#dscaw217;
   #dscaw217#1 = #agif084@#48;
   #dscaw217#2 = #agif084@#0;
   |LEE 000#dscaw217.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   |SI #agif084@#73 < 0; |ACABA; |FINSI;

   Divisa = #agif084@#65; |HAZ CargaNDeci;

   |SELECT #9#dscam003;
   fVtoMayor = #agif084@#1;
   #dscam003#0 = #agif084@#48;
   #dscam003#1 = #agif084@#0;
   #dscam003#2 = 1;
   |LEE 000#dscam003.];
   |PARA; |SI FSalida = 0; |Y #dscam003#0 = #agif084@#48; |Y #dscam003#1 = #agif084@#0; |HACIENDO;
      |SI #dscam003#4 = #agif084@#1;
         |SI fVtoMayor < #dscam003#3; fVtoMayor = #dscam003#3; |FINSI;
      |FINSI;
      |LEE 000#dscam003.s;
   |SIGUE;
   |SELECT #1#dscam003;

   #agif091@#0 = #agif084@#8;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif084@#3;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam023#2 ! #dscaz196#0; |ACABA; |FINSI;
   |SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw217;
   #dscaw217#0  = nLinTmp; nLinTmp = nLinTmp + 1;
   #dscaw217#1  = #agif084@#48;
   #dscaw217#2  = #agif084@#0;
   #dscaw217#3  = #agif084@#3;
   #dscaw217#4  = #agif084@#4;
   #dscaw217#5  = fVtoMayor;
   #dscaw217#6  = #agif084@#73;
   #dscaw217#7  = #dscam023#20;
   #dscaw217#8  = #dscam023#19;
   #dscaw212#9  = #agif084@#8;
   #dscaw212#10 = #agif091@#1;
   #dscaw212#11 = #agif084@#65;
   #dscaw212#12 = #agif024@#6;
   #dscaw212#13 = #agif024@#178;
   #dscaw212#14 = #agif024@#179;
   #dscaw212#15 = #agif024@#7;

   aSerie = #agif084@#48; nFactura = #agif084@#0; fFecha = #agif084@#1;

   nSwPdte = 0; HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |SI nSwPdte = 0;
         #dscaw217#16 = "L"; #dscaw217#17 = "Liquidado";
      |SINO;
         #dscaw217#16 = "P"; #dscaw217#17 = "Pendiente";
      |FINSI;
      #dscaw217#18 = #dscam023#13;
      #dscaw217#17 = #agif084@#1;
/*
      aAlfa = #dscam023#5; |QBF aAlfa;
      |SI aAlfa = ""; |O #dscam023#13 = 0;
         #dscaw217#20 = "2";
      |SINO;
         #dscaw217#20 = "1";
      |FINSI;
*/
      #dscam215#0 = #dscaz196#0;
      #dscam215#4 = #dscaw217#3;
      |LEE 000#dscam215.=;
      |SI FSalida = 0;
         #dscaw217#20 = "1"; || Clasificado
      |SINO;
         #dscaw217#20 = "2"; || No clasificado
      |FINSI;

      |SI #dscam023#2 ! 0; |Y #dscam023#13 > 0;
         |SI #dscaw217#16 = "L"; #dscaw217#21 = "1"; |FINSI;
         |SI #dscaw217#16 ! "L"; #dscaw217#21 = "2"; |FINSI;
      |SINO;
         |SI #dscaw217#16 = "L"; #dscaw217#21 = "3"; |FINSI;
         |SI #dscaw217#16 ! "L"; #dscaw217#21 = "4"; |FINSI;
      |FINSI;

/*
      |SI #dscaw217#16 = "L"; |Y #dscam023#2 ! 0; #dscaw217#21 = "1"; |FINSI;
      |SI #dscaw217#16 = "L"; |Y #dscam023#2 = 0; #dscaw217#21 = "2"; |FINSI;
      |SI #dscaw217#16 = "P"; |Y #dscam023#2 ! 0; #dscaw217#21 = "3"; |FINSI;
      |SI #dscaw217#16 = "P"; |Y #dscam023#2 = 0; #dscaw217#21 = "4"; |FINSI;
*/
      |GRABA 020#dscaw217.n;
   |FINSI;
/*
   #dscaw212#0 = #agif084@#48;
   #dscaw212#1 = #agif084@#0;
   |LEE 000#dscaw212.=;
   |SI FSalida = 0; |ACABA; |FINSI;

   Divisa = #agif084@#65; |HAZ CargaNDeci;

   #agif091@#0 = #agif084@#8;
   |LEE 000#agif091@.=;
   |SI FSalida ! 0; |DDEFECTO #agif091@; |FINSI;

   #dscam023#0 = #agif084@#3;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   |SI #dscam023#2 ! #dscaz196#0; |ACABA; |FINSI;
   |SI #dscam023#2 = 0; |ACABA; |FINSI;

   |DDEFECTO #dscaw212;
   #dscaw212#0 = #agif084@#48;
   #dscaw212#1 = #agif084@#0;
   #dscaw212#2 = #agif084@#3;
   #dscaw212#3 = #agif084@#4;
   #dscaw212#4 = 0;
   #dscaw212#5 = #agif084@#1;
   #dscaw212#7 = #agif084@#73;
   #dscaw212#8 = aMarca;

   #dscaw212#9  = #dscam023#20;
   #dscaw212#10 = #dscam023#19;

   #dscaw212#11 = #agif084@#8;
   #dscaw212#12 = #agif091@#1;
   #dscaw212#13 = #agif084@#65;

   #dscaw212#14 = #agif024@#6;
   #dscaw212#15 = #agif024@#178;
   #dscaw212#16 = #agif024@#179;
   #dscaw212#17 = #agif024@#7;

   aSerie = #agif084@#48; nFactura = #agif084@#0; fFecha = #agif084@#1;

   nSwPdte = 0; HayVtos = 0; |BUCLE Vtos;
   |SI HayVtos = 1;
      |SI nSwPdte = 0;
         #dscaw212#18 = "L"; #dscaw212#19 = "Liquidado";
      |SINO;
         #dscaw212#18 = "P"; #dscaw212#19 = "Pendiente";
      |FINSI;
      #dscaw212#20 = #dscam023#13;
      #dscaw212#22 = nLinTmp; nLinTmp = nLinTmp + 1;
      |GRABA 020#dscaw212.n;
      |SI aMarca = "*"; nSwMarca = nSwMarca + 1; |FINSI;
   |FINSI;
*/
|FPRC;

|DEFBUCLE TmpDirectas;
#agif084@#1002;
1,3,40;
#0#4, #0#5,  #0#8,  #0#6,  #0#7;
#0#9, #0#10, #0#13, #0#11, #0#12;
;
NULL,TmpDirectas;
|FIN;

|PROCESO Empresas;
   nSwHay = 1;
   #dscam044#0 = #dscam045#0;
   |LEE 000#dscam044.=;

   aDirFic = #dscam044#1; |QBF aDirFic;
   aDirDef = aDirFic + "def/";
   aDirFic = aDirFic + "fich/" + (("00000" + #dscam045#0) % -105) + "/";

   aAlfa = aDirDef + "agifa134.mas";
   |CARGA_DEF aAlfa, agif134@;
   |SI FSalida = 0;
      aAlfa = aDirDef + "agifa133.mas"; |CARGA_DEF aAlfa, agif133@;
      aAlfa = aDirDef + "agifa091.mas"; |CARGA_DEF aAlfa, agif091@;
      aAlfa = aDirDef + "agifa024.mas"; |CARGA_DEF aAlfa, agif024@;
      aAlfa = aDirDef + "agifa084.mas"; |CARGA_DEF aAlfa, agif084@;
      |PATH_DAT #11 aDirFic; |ABRE #agif134@;
      |PATH_DAT #14 aDirFic; |ABRE #agif133@;
      |PATH_DAT #16 aDirFic; |ABRE #agif091@;
      |PATH_DAT #18 aDirFic; |ABRE #agif024@;
      |PATH_DAT #20 aDirFic; |ABRE #agif084@;
      |BUCLE TmpVentas; |BUCLE TmpDirectas;
      |CIERRA #agif084@; |DESCARGA_DEF #agif084@;
      |CIERRA #agif024@; |DESCARGA_DEF #agif024@;
      |CIERRA #agif091@; |DESCARGA_DEF #agif091@;
      |CIERRA #agif133@; |DESCARGA_DEF #agif133@;
      |CIERRA #agif134@; |DESCARGA_DEF #agif134@;
   |FINSI;
|FPRC;

|DEFBUCLE Empresas;
#dscam045#2;
2;
nEmpre,"V";
nEmpre,"V";
;
NULL,Empresas;
|FIN;

|RUTINA infw52;
   #dscaw212#22 = 1;
|FRUT;

|RUTINA supw52;
   #dscaw212#22 = 9999999;
|FRUT;

|PROCESO ImprimeVtos;
   |SI enCab = 0;
      enContLin = enContLin + 1;
   |SINO;
      enContLin = enContLin + 4;
   |FINSI;
   |SI enContLin ] nNumLin; |HAZ PieInfor; |FINSI;
   enLin = 2; |PRINT;
   |SI enCab ! 0; enCab = 0; |FINSI;
|FPRC;

|DEFBUCLE ImprimeVtos;
#dscaw053#1;
;
#dscaw212#0,#dscaw212#1,001;
#dscaw212#0,#dscaw212#1,999;
;
NULL,ImprimeVtos;
|FIN;

|PROCESO Imprime;
   |SI enCab = 0;
      enContLin = enContLin + 1;
   |SINO;
      enContLin = enContLin + 3;
   |FINSI;
   nCalc = enContLin;

   #dscaw053#0 = #dscaw212#0;
   #dscaw053#1 = #dscaw212#1;
   |LEE 000#dscaw053.];
   |SI FSalida = 0; |Y #dscaw053#0 = #dscaw212#0; |Y #dscaw053#1 = #dscaw212#1;
      nCalc = nCalc + 5;
   |FINSI;

   |SI nCalc ] nNumLin; |HAZ PieInfor; |FINSI;
   enLin = 1; |PRINT;
   enCab = 2; |BUCLE ImprimeVtos;
   enLin = 3; |PRINT; enContLin = enContLin + 1;
   |SI enContLin ] nNumLin; |HAZ PieInfor; |FINSI;
   |SI enCab ! 0; enCab = 0; |FINSI;
   enLin = 1;
|FPRC;

|DEFBUCLE Imprime;
#dscaw212#1;
;
INICIO;
FINAL;
;
NULL,Imprime;
|FIN;

|PROCESO PieInfor;
   |PARA nCont = enContLin; |SI nCont < nNumLin; |HACIENDO nCont = nCont + 1;
      enLin = 3; |PRINT;
   |SIGUE;
   |PIEINF;
   enCab = enLin; enLin = 0; |PRINT; enCab = 0;
   enContLin = 7;
|FPRC;

|PROCESO PasaVtos;
   #dscam076#4 = #dscam076#4 + #dscaw053#7;
   #dscam077#6 = #dscam077#6 + #dscaw053#7;

   |DDEFECTO #dscam078;
   #dscam078#0  = #dscam077#0;
   #dscam078#1  = #dscam077#1;
   #dscam078#2  = #dscam077#2;
   #dscam078#3  = #dscam077#3;
   #dscam078#4  = nLinea; nLinea = nLinea + 1;
   #dscam078#5  = #dscaw053#0;
   #dscam078#6  = #dscaw053#1;
   #dscam078#7  = #dscaw053#2;
   #dscam078#8  = #dscaw053#8;
   #dscam078#9  = #dscaw053#3;
   #dscam078#10 = #dscaw053#7;
   #dscam078#13 = #dscam078#9 - #dscam078#8;
   #dscam078#14 = #dscaw053#9;
   |GRABA 020#dscam078.c;

   #dscam003#40 = #dscam078#14;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      #dscam003#89  = "S";
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE PasaVtos;
#dscaw053#1;
;
#dscaw212#0, #dscaw212#1, 000;
#dscaw212#0, #dscaw212#1, 999;
;
NULL,PasaVtos;
|FIN;

|PROCESO PasaAImp;
   #dscam077#0 = #dscam076#0;
   #dscam077#1 = #dscam076#1;
   #dscam077#2 = #dscam076#2;
   #dscam077#3 = #dscaw212#2;
   |LEE 101#dscam077.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscam077;
      #dscam077#0  = #dscam076#0;
      #dscam077#1  = #dscam076#1;
      #dscam077#2  = #dscam076#2;
      #dscam077#3  = #dscaw212#2;
      #dscam077#4  = #dscaw212#3;
      #dscam077#5  = #dscaz196#15;
      #dscam077#7  = #dscaz196#16;
      #dscam077#9  = #dscaz196#17;
      #dscam077#11 = #dscaw212#14;
      #dscam077#12 = #dscaw212#15;
      #dscam077#13 = #dscaw212#16;
      #dscam077#14 = #dscaw212#17;
      |SI #dscaz196#15 ! 0; #dscam077#15 = #dscaz196#15; |FINSI;
      |SI #dscaz196#16 ! 0; #dscam077#15 = #dscaz196#16; |FINSI;
      |SI #dscaz196#17 ! 0; #dscam077#15 = #dscaz196#17; |FINSI;
      |GRABA 020#dscam077.b;
   |FINSI;

   nLinea = 1;
   #dscam078#0  = #dscam077#0;
   #dscam078#1  = #dscam077#1;
   #dscam078#2  = #dscam077#2;
   #dscam078#3  = #dscam077#3;
   #dscam078#4  = 0;
   |LEE 000#dscam078.];
   |PARA; |SI FSalida = 0; |Y #dscam078#0  = #dscam077#0; |Y #dscam078#1  = #dscam077#1;
    |Y #dscam078#2  = #dscam077#2; |Y #dscam078#3  = #dscam077#3; |HACIENDO;
      nLinea = #dscam078#4 + 1;
      |LEE 000#dscam078.s;
   |SIGUE;

   |BUCLE PasaVtos;
   |GRABA 020#dscam077.a; |LIBERA #dscam077;
|FPRC;

|DEFBUCLE PasaAImp;
#dscaw212#3;
8;
"      ", "     ", 000000, "*";
"zzzzzz", "zzzzz", 999999, "*";
;
NULL,PasaAImp;
|FIN;

|PROCESO RecsDivid;
   |SI #dscam003#14 ! "A"; |Y #dscam003#14 ! "D";
      #dscam003#89  = "S";
      #dscam003#105 = #dscam215#21;
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE RecsDivid;
#dscam003#9;
83;
nLib, aSer, 000000, 000, 000000001, nDocDiv;
nLib, aSer, 999999, 999, 999999999, nDocDiv;
;
NULL, RecsDivid;
|FIN;

|PROCESO PasaVtos0c0160;
   fFecha1 = "01.01.0000";
   #dscam003#40 = #dscaw053#9;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      |SI #dscam003#14 = "D";
         nLib = #dscam003#27;
         aSer = #dscam003#0;
         nDocDiv = #dscam003#40;
         |SALVA_FICHA #dscam003;
         |BUCLE RecsDivid;
         |REPON_FICHA #dscam003;
      |FINSI;
      #dscam003#89  = "S";
      #dscam003#105 = #dscam215#21;
      |GRABA 020#dscam003.a; |LIBERA #dscam003;

      |SI #dscam003#14 = "F"; |O #dscam003#14 = "T";
         fFecha1 = #dscam003#71; nCalc1 = fFecha1;
      |SINO;
         fVtoMayor = #dscam003#3;
         |SI #dscam003#14 = "D";
            |SALVA_FICHA #dscam003;
            nLib = #dscam003#27;
            aSer = #dscam003#0;
            nDocDiv = #dscam003#40;
            |BUCLE MiraDivididos;
            |REPON_FICHA #dscam003;
         |FINSI;
         fFecha1 = fVtoMayor; nCalc1 = fFecha1;
      |FINSI;
      fFecha = #dscam003#4; nCalc2 = fFecha;
      nCalc1 = nCalc1 - nCalc2;
      |SI nCalc1 ] nCalc; nCalc = nCalc1; |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE PasaVtos0c0160;
#dscaw053#1;
;
#dscaw212#0, #dscaw212#1, 000;
#dscaw212#0, #dscaw212#1, 999;
;
NULL,PasaVtos0c0160;
|FIN;

|PROCESO PasaAImp0c0160;
   #dscam023#0 = #dscaw212#2;
   |LEE 000#dscam023.=;
   |SI FSalida ! 0; |DDEFECTO #dscam023; |FINSI;

   #dscam215#0 = #dscam023#2;
   #dscam215#2 = #dscam023#5;
   |LEE 000#dscam215.=;
   |SI FSalida ! 0; |DDEFECTO #dscam215; |FINSI;

   nLinea = 1;
   #dscam214#0  = #dscam213#0;
   #dscam214#1  = #dscam213#1;
   #dscam214#2  = #dscam213#2;
   #dscam214#3  = 0;
   |LEE 000#dscam214.];
   |PARA; |SI FSalida = 0; |Y #dscam214#0  = #dscam213#0; |Y #dscam214#1  = #dscam213#1;
   |Y #dscam214#2  = #dscam213#2; |HACIENDO;
      nLinea = #dscam214#3 + 1;
      |LEE 000#dscam214.s;
   |SIGUE;

   |DDEFECTO #dscam214;
   #dscam214#0  = #dscam213#0;
   #dscam214#1  = #dscam213#1;
   #dscam214#2  = #dscam213#2;
   #dscam214#3  = nLinea; nLinea = nLinea + 1;
   |GRABA 020#dscam214.b;

   #dscam214#4  = #dscaw212#0;
   #dscam214#5  = #dscaw212#1;
   #dscam214#6  = #dscaw212#5;
   #dscam214#7  = #dscaw212#7;
   #dscam214#8  = #dscam215#21;
   #dscam214#10 = #dscaw212#2;
   #dscam214#11 = #dscaw212#3;
   #dscam214#12 = #dscaw212#14;
   aAlfa = (("00" + #dscaw212#15) % -102) + (("000" + #dscaw212#16) % -103);
   #dscam214#13 = aAlfa;
   #dscam214#14 = #dscaw212#17;

   nCalc = 0; |BUCLE PasaVtos0c0160;

   |SI fFecha1 ! "01.01.0000"; #dscam214#6 = fFecha1; |FINSI;
   #dscam214#9 = nCalc;
   |SI #dscam214#9 > #dscam214#8;
      #dscam214#15 = "S";
   |SINO;
      #dscam214#15 = "N";
   |FINSI;
   #dscam214#18  = #dscaw212#21;
   |GRABA 020#dscam214.a; |LIBERA #dscam214;
|FPRC;

|DEFBUCLE PasaAImp0c0160;
#dscaw212#3;
8;
"      ", "     ", 000000, "*";
"zzzzzz", "zzzzz", 999999, "*";
;
NULL,PasaAImp0c0160;
|FIN;

|PROCESO RecsDiv;
   |SI #dscam003#14 ! "A"; |Y #dscam003#14 ! "D";
      #dscam003#89  = "N";
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
|FPRC;

|DEFBUCLE RecsDiv;
#dscam003#9;
83;
nLib, aSer, 000000, 000, 000000001, nDocDiv;
nLib, aSer, 999999, 999, 999999999, nDocDiv;
;
NULL, RecsDiv;
|FIN;

|PROCESO BorraRecs;
   #dscam003#40 = #dscam078#14;
   |LEE 101#dscam003.=;
   |SI FSalida = 0;
      |SI #dscam003#14 = "D";
         |SALVA_FICHA #dscam003;
         nLib = #dscam003#27;
         aSer = #dscam003#27;
         nDocDiv = #dscam003#40;
         |BUCLE RecsDiv;
         |REPON_FICHA #dscam003;
      |FINSI;
      #dscam003#89 = "N";
      |GRABA 020#dscam003.a; |LIBERA #dscam003;
   |FINSI;
   |BORRA 020#dscam078.a;
|FPRC;

|DEFBUCLE BorraRecs;
#dscam078#1;
;
#dscam077#0 , #dscam077#1 , #dscam077#2 , #dscam077#3 , 000;
#dscam077#0 , #dscam077#1 , #dscam077#2 , #dscam077#3 , 999;
;
NULL,BorraRecs;
|FIN;

|PROCESO BorraLin;
   |BUCLE BorraRecs; |BORRA 020#dscam077.a;
|FPRC;

|DEFBUCLE BorraLin;
#dscam077#1;
;
#dscam076#0, #dscam076#1, #dscam076#2, "      ";
#dscam076#0, #dscam076#1, #dscam076#2, "zzzzzz";
be;
NULL,BorraLin;
|FIN;

|PROCESO BorraRecs0c0160;
   #dscam003#89  = "N";
   #dscam003#105 = 0;
   |GRABA 020#dscam003.a; |LIBERA #dscam003;
|FPRC;

|DEFBUCLE BorraRecs0c0160;
#dscam003#9;
4;
00, #dscam214#4, #dscam214#5, 001, 000000001, #dscam214#18;
00, #dscam214#4, #dscam214#5, 999, 999999999, #dscam214#18;
be;
NULL, BorraRecs0c0160;
|FIN;

|PROCESO BorraLin0c0160;
   |BUCLE BorraRecs0c0160;

   |BORRA 020#dscam214.a;
|FPRC;

|DEFBUCLE BorraLin0c0160;
#dscam214#1;
;
#dscam213#0, #dscam213#1, #dscam213#2, 001;
#dscam213#0, #dscam213#1, #dscam213#2, 999;
be;
NULL,BorraLin0c0160;
|FIN;

|PROCESO Comprueba;

   |HAZ PonFechas;

   |ABRE #dscam003; |ABRE #dscam076;
   |ABRE #dscam077; |ABRE #dscam078;
   #dscam076#0 = #dscaz196#0;
   #dscam076#1 = #dscaz196#1;
   #dscam076#2 = #dscaz196#3;
   |LEE 101#dscam076.=;
   |SI FSalida = 0;
/*
      |CONFI "    NSe borraran los datos existentes del mto.de importes Continuar ?";
      |SI FSalida = 0;
         |BUCLE BorraLin; |BORRA 020#dscam076.a;
      |SINO;
         |ERROR;
      |FINSI;
      |LIBERA #dscam076;
*/
      |ERROR; |LIBERA #dscam076;
   |FINSI;
   |CIERRA #dscam003; |CIERRA #dscam076;
   |CIERRA #dscam077; |CIERRA #dscam078;
|FPRC;

|PROCESO PasaTemporal;
   |DDEFECTO #dscaw212;
   #dscaw212#22 = nLinTmp; nLinTmp = nLinTmp + 1;
   #dscaw212#0  = #dscaw217#1;
   #dscaw212#1  = #dscaw217#2;
   #dscaw212#2  = #dscaw217#3;
   #dscaw212#3  = #dscaw217#4;
   #dscaw212#5  = #dscaw217#5;
   |SI #dscaw217#21 = "1"; |O #dscaw217#21 = "3";
      #dscaw212#24 = "0";
   |SINO;
      #dscaw212#24 = "1";
   |FINSI;
   #dscaw212#7  = #dscaw217#6;
   #dscaw212#8  = aMarca;
   #dscaw212#9  = #dscaw217#7;
   #dscaw212#10 = #dscaw217#8;
   #dscaw212#11 = #dscaw217#9;
   #dscaw212#12 = #dscaw217#10;
   #dscaw212#13 = #dscaw217#11;
   #dscaw212#14 = #dscaw217#12;
   #dscaw212#15 = #dscaw217#13;
   #dscaw212#16 = #dscaw217#14;
   #dscaw212#17 = #dscaw217#15;
   #dscaw212#18 = #dscaw217#16;
   #dscaw212#19 = #dscaw217#17;
   #dscaw212#20 = #dscaw217#18;
   #dscaw212#21 = #dscaw217#19;
   |GRABA 020#dscaw212.n;

   |SI aMarca = "*"; nSwMarca = nSwMarca + 1; |FINSI;
|FPRC;

/*
|DEFBUCLE PasaTemporal;
#dscaw217#2;
;
INICIO;
FINAL;
;
NULL, PasaTemporal;
|FIN;
*/
|DEFBUCLE PasaTemporal;
#dscaw217#4;
;
INICIO;
FINAL;
;
NULL, PasaTemporal;
|FIN;

|PROCESO Tipo5; |TIPO 5;
   |LINEAS_BI_ATRI #dscaw212#24,S,D,-1;
|FPRC;

|PROGRAMA;
   |CLS;
   |CABEZA " Adjudicacion recibos Credito y Caucion ";

   nSw0c0160 = 1;

   |SI PARAMETRO ! "";
      |SI nSw0c0160 = 0;
         |PINPA #0#dscaw174; |PINDA #0#dscaw174;
         ||BLANCO 0501 1180; ||BLANCO 2001 2380;
         ||ATRI S; |PINTA 0606, " INFORME ADJUDICACION "; |ATRI N;
         |ENDATOS #1#dscaw174;
         |SI FSalida = 0;
            #dscaz196#4  = #dscaw174#4;  #dscaz196#5  = #dscaw174#5;
            #dscaz196#6  = #dscaw174#6;  #dscaz196#7  = #dscaw174#7;
            #dscaz196#8  = #dscaw174#8;  #dscaz196#9  = #dscaw174#9;
            #dscaz196#10 = #dscaw174#10; #dscaz196#11 = #dscaw174#11;
            #dscaz196#12 = #dscaw174#12; #dscaz196#13 = #dscaw174#13;
            #dscaz196#14 = #dscaw174#14; #dscaz196#18 = #dscaw174#18;
            #dscaz196#19 = #dscaw174#19;
            FSalida = 0;
         |FINSI;
      |SINO;    || Adjudicacion modulo Artenvas (0c0160)
         |PINPA #0#0; |PINDA #0#0; |HAZ MiraComp;
         |ENDATOS #1#0;
      |FINSI;
   |SINO;
      |PINPA #0#0; |PINDA #0#0; |HAZ MiraComp;
      |ENDATOS #1#0;
   |FINSI;

   |SI FSalida = 0;
      |SI PARAMETRO = ""; |Y nSw0c0160 = 0;
         |CONFI "    NMarcar todos los registros ?";
         |SI FSalida = 0;
            aMarca = "*";
         |SINO;
            aMarca = " ";
         |FINSI;
      |SINO;
         aMarca = " ";
      |FINSI;

      |HAZ Tipo8;
      aAlfa = "tc" + Usuario; |NOME_DAT #1 aAlfa;
      aAlfa = "tl" + Usuario; |NOME_DAT #2 aAlfa;
      aAlfa = "t7" + Usuario; |NOME_DAT #3 aAlfa;
      |DELINDEX #dscaw212; |ABRE #dscaw212;
      |DELINDEX #dscaw217; |ABRE #dscaw217;
      |DELINDEX #dscaw053; |ABRE #dscaw053;
      |DFICB aAlfa; |QBF aAlfa;
      |PATH_DAT #12 aAlfa; |PATH_DAT #13 aAlfa;
      |ABRE #dscam044; |ABRE #dscam003; |ABRE #dscam058; |ABRE #dscam023;
      |ABRE #dscam215; |SELECT #2#dscam215;

      nSwHay = 0; nSwMarca = 0; nLinTmp = 1;
      nEmpre = #48#0; |BUCLE Empresas;
      nLinTmp = 1; |BUCLE PasaTemporal;
      |SI nSwHay = 0; |Y nSwMarca > 0; nSwMarca = 0; |FINSI;

      |SELECT #1#dscam215; |CIERRA #dscam215;
      |CIERRA #dscaw217;
      |CIERRA #dscam023; |CIERRA #dscaw212; |CIERRA #dscaw053;
      |CIERRA #dscam058; |CIERRA #dscam003; |CIERRA #dscam044;

      |SI PARAMETRO ! "";
         |IMPRE 0;
         |SI FSalida ! 0; |ACABA; |FINSI;
         |CIMPR 11; nNumLin = FSalida;
         |INFOR "dscaz196";
         |SI FSalida ! 0; |FINIMP; |ACABA; |FINSI;
         enContLin = 4; enCab = 1; |BUCLE Imprime;
         |PIEINF; |FININF;
         |FINIMP;
         |HAZ Tipo9;
         |ACABA;
      |FINSI;

      |ENTLINEAL #1#dscaw212,-1,4,17,1,infw52,supw52;
      |SI nSwMarca ! 0;
         aAlfa = "    SLos registros marcados se añadiran a la adjudicacion actual. " + &191 + " Continuar ?";
         |CONFI aAlfa;
         |SI FSalida = 0;
            |SI nSw0c0160 = 0;
               |ABRE #dscam076; |ABRE #dscam077; |ABRE #dscam078;
               #dscam076#0 = #dscaz196#0;
               #dscam076#1 = #dscaz196#1;
               #dscam076#2 = #dscaz196#3;
               |LEE 101#dscam076.=;
               |SI FSalida = 0;
/*
                  |CONFI "    NSe borraran los datos existentes del mto.de importes Continuar ?";
                  |SI FSalida = 0;
                     |BUCLE BorraLin;
                     #dscam076#4  = 0; #dscam076#6  = 0;
                     #dscam076#8  = 0; #dscam076#10 = 0;
                     #dscam076#3 = #dscaz196#15; #dscam076#5 = #dscaz196#16;
                     #dscam076#7 = #dscaz196#17;
                     |SI #dscaz196#15 ! 0; #dscam076#9 = #dscaz196#15; |FINSI;
                     |SI #dscaz196#16 ! 0; #dscam076#9 = #dscaz196#16; |FINSI;
                     |SI #dscaz196#17 ! 0; #dscam076#9 = #dscaz196#17; |FINSI;
                     |ABRE #dscam003;
                     |BUCLE PasaAImp;
                     |GRABA 020#dscam076.a; |LIBERA #dscam076;
                     |CIERRA #dscam003;
                  |FINSI;
*/
               |SINO;
                  |DDEFECTO #dscam076;
                  #dscam076#0 = #dscaz196#0;
                  #dscam076#1 = #dscaz196#1;
                  #dscam076#2 = #dscaz196#3;
                  #dscam076#3 = #dscaz196#15;
                  #dscam076#5 = #dscaz196#16;
                  #dscam076#7 = #dscaz196#17;
                  |SI #dscaz196#15 ! 0; #dscam076#9 = #dscaz196#15; |FINSI;
                  |SI #dscaz196#16 ! 0; #dscam076#9 = #dscaz196#16; |FINSI;
                  |SI #dscaz196#17 ! 0; #dscam076#9 = #dscaz196#17; |FINSI;
                  |GRABA 020#dscam076.b;
                  |ABRE #dscam003;
                  |BUCLE PasaAImp;
                  |GRABA 020#dscam076.a; |LIBERA #dscam076;
                  |CIERRA #dscam003;
               |FINSI;
               |CIERRA #dscam076; |CIERRA #dscam077; |CIERRA #dscam078;
            |SINO;
               |ABRE #dscam213; |ABRE #dscam214;
               #dscam213#0 = #dscaz196#0;
               #dscam213#1 = #dscaz196#1;
               #dscam213#2 = #dscaz196#3;
               |LEE 101#dscam213.=;
               |SI FSalida = 0;
/*
                  |CONFI "    NSe borraran los datos existentes del mto.de importes Continuar ?";
                  |SI FSalida = 0;
                     |BUCLE BorraLin0c0160;
                  |FINSI;
*/
               |SINO;
                  |DDEFECTO #dscam213;
                  #dscam213#0 = #dscaz196#0;
                  #dscam213#1 = #dscaz196#1;
                  #dscam213#2 = #dscaz196#3;
                  |GRABA 020#dscam213.c;
               |FINSI;

               |ABRE #dscam003;
               |ABRE #dscam023; |ABRE #dscam215;
               |BUCLE PasaAImp0c0160;
               ||GRABA 020#dscam213.a; |LIBERA #dscam213;
               |CIERRA #dscam023; |CIERRA #dscam215;
               |CIERRA #dscam003;

               |CIERRA #dscam213; |CIERRA #dscam214;
            |FINSI;
         |SINO;
            |MENAV "    Proceso cancelado";
         |FINSI;
      |FINSI;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".dat"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ddx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tl" + Usuario + ".ixx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".dat"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ixx"; |FBORRA aAlfa;
      |DFICE aAlfa; |QBF aAlfa; aAlfa = "tc" + Usuario + ".ddx"; |FBORRA aAlfa;

      |HAZ Tipo9;
   |FINSI;
|FPRO;
