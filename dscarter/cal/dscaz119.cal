|FICHEROS;
   dscaz119 #0;

   dscam003 #10;
   dscam012 #11;
   dscam013 #12;
   dscam014 #13;

   dscaw092 #100;
   dscaw093 #101;
|FIN;

|VARIABLES;
   nCont = 0;
|FIN;

|PROCESO Recibos;
   |SI #dscam003#14 ! "P"; |Y #dscam003#14 ! "C"; |Y #dscam003#14 ! "T"; |ACABA; |FINSI;

   |PARA nCont = 2; |SI nCont [ 16; |HACIENDO nCont = nCont + 1;
      |SI #dscaz119#nCont# = #dscam003#0; |ACABA; |FINSI;
   |SIGUE;

   #dscaw092#0 = #dscam003#32;
   #dscaw092#1 = #dscam003#5;
   |LEE 101#dscaw092.=;
   |SI FSalida ! 0;
      |DDEFECTO #dscaw092;
      #dscaw092#0 = #dscam003#32;
      #dscaw092#1 = #dscam003#5;
      #dscaw092#6 = #dscam003#6;
      |GRABA 020#dscaw092.b;
   |FINSI;

   |SI #dscam003#90 = "S";
      #dscaw092#2 = #dscaw092#2 + #dscam003#31;
   |SINO;
      |SI #dscam003#14 = "P"; |O #dscam003#14 = "C";
         #dscaw092#7 = #dscaw092#7 + #dscam003#31;
      |FINSI;
   |FINSI;
   |GRABA 020#dscaw092.a; |LIBERA #dscaw092;
|FPRC;

|DEFBUCLE Recibos;
#dscam003#1;
;
INICIO;
FINAL;
be;
NULL,Recibos;
|FIN;

|PROCESO LineasRem;
   #dscam003#40 = #dscam013#16;
   |LEE 000#dscam003.=;
   |SI FSalida ! 0; |DDEFECTO #dscam003; |FINSI;

   #dscam014#0 = #dscam012#2;
   |LEE 000#dscam014.=;
   |SI FSalida ! 0; |DDEFECTO #dscam014; |FINSI;

   |SI #dscam012#22 = 2; |O #dscam012#22 = 4; |O #dscam012#22 = 5;
      |SI #dscam013#15 = "N";
         #dscaw092#0 = #dscam003#32;
         #dscaw092#1 = #dscam013#11;
         |LEE 101#dscaw092.=;
         |SI FSalida ! 0;
            |DDEFECTO #dscaw092;
            #dscaw092#0 = #dscam003#32;
            #dscaw092#1 = #dscam013#11;
            #dscaw092#6 = #dscam003#6;
            |GRABA 020#dscaw092.b;
         |FINSI;
         #dscaw092#3 = #dscaw092#3 + #dscam013#7;
         #dscaw092#5 = #dscaw092#5 + #dscam013#7;
         |GRABA 020#dscaw092.a; |LIBERA #dscaw092;

         #dscaw093#0 = #dscam012#2;
         |LEE 101#dscaw093.=;
         |SI FSalida ! 0;
            |DDEFECTO #dscaw093;
            #dscaw093#0 = #dscam012#2;
            #dscaw093#1 = #dscam014#10;
            #dscaw093#3 = #dscam014#1;
            |GRABA 020#dscaw093.b;
         |FINSI;
         #dscaw093#2 = #dscaw093#2 + #dscam013#7;
         |GRABA 020#dscaw093.a; |LIBERA #dscaw093;
      |FINSI;
   |FINSI;
   |SI #dscam012#22 = 1; |O #dscam012#22 = 3;
      |SI #dscam013#15 = "N";
         #dscaw092#0 = #dscam003#32;
         #dscaw092#1 = #dscam013#11;
         |LEE 101#dscaw092.=;
         |SI FSalida ! 0;
            |DDEFECTO #dscaw092;
            #dscaw092#0 = #dscam003#32;
            #dscaw092#1 = #dscam013#11;
            #dscaw092#6 = #dscam003#6;
            |GRABA 020#dscaw092.b;
         |FINSI;
         #dscaw092#4 = #dscaw092#4 + #dscam013#7;
         #dscaw092#5 = #dscaw092#5 + #dscam013#7;
         |GRABA 020#dscaw092.a; |LIBERA #dscaw092;

         #dscaw093#0 = #dscam012#2;
         |LEE 101#dscaw093.=;
         |SI FSalida ! 0;
            |DDEFECTO #dscaw093;
            #dscaw093#0 = #dscam012#2;
            #dscaw093#1 = #dscam014#10;
            #dscaw093#3 = #dscam014#1;
            |GRABA 020#dscaw093.b;
         |FINSI;
         #dscaw093#2 = #dscaw093#2 + #dscam013#7;
         |GRABA 020#dscaw093.a; |LIBERA #dscaw093;
      |FINSI;
   |FINSI;
|FPRC;

|DEFBUCLE LineasRem;
#dscam013#1;
;
#dscam012#0, 001;
#dscam012#0, 999;
be;
NULL,LineasRem;
|FIN;

|PROCESO Remesas;
   |BUCLE LineasRem;
|FPRC;

|DEFBUCLE Remesas;
#dscam012#1;
;
INICIO;
FINAL;
be;
NULL,Remesas;
|FIN;

|PROGRAMA;
   |CLS;
   |CABEZA " Preparacion para la regularizacion de cuentas de cartera";
   |PINPA #0#0; |PINDA #0#0;

   |ENDATOS #1#0;
   |SI FSalida = 0;
      |DELINDEX #dscaw092; |DELINDEX #dscaw093;
      |ABRE #dscaw092; |ABRE #dscaw093;
      |BUCLE Recibos;

      |ABRE #dscam003; |ABRE #dscam014;
      |BUCLE Remesas;
      |CIERRA #dscam003; |CIERRA #dscam014;

      |CIERRA #dscaw092; |CIERRA #dscaw093;
   |FINSI;
|FPRO;
